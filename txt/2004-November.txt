From mmokrejs at ribosome.natur.cuni.cz  Mon Nov  1 18:17:50 2004
From: mmokrejs at ribosome.natur.cuni.cz (mmokrejs@ribosome.natur.cuni.cz)
Date: Mon Nov  1 18:17:53 2004
Subject: [Rd] R-2.0.0/lib/R/bin/INSTALL (PR#7329)
Message-ID: <20041101171750.C906E11020@slim.kubism.ku.dk>

Hi,
  the install script should make sure user has set R_HOME variable.
I don't have it as root, and get stupid messages. Anyway, should it be set
to $blah/R-2.0.0/lib/R/ or $blah/R-2.0.0 ?
Thanks for help
Martin

From p.dalgaard at biostat.ku.dk  Mon Nov  1 18:48:20 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Nov  1 18:48:53 2004
Subject: [Rd] R-2.0.0/lib/R/bin/INSTALL (PR#7329)
In-Reply-To: <20041101171750.C906E11020@slim.kubism.ku.dk>
References: <20041101171750.C906E11020@slim.kubism.ku.dk>
Message-ID: <x2oeihv4t7.fsf@biostat.ku.dk>

mmokrejs@ribosome.natur.cuni.cz writes:

> Hi,
>   the install script should make sure user has set R_HOME variable.
> I don't have it as root, and get stupid messages. Anyway, should it be set
> to $blah/R-2.0.0/lib/R/ or $blah/R-2.0.0 ?
> Thanks for help
> Martin

Please read the R-admin manual. The correct way of calling the INSTALL
script is via

   R CMD INSTALL ...

And that will set automatically set R_HOME appropriately.

And please try to avoid reporting your own errors as bugs in R...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Mon Nov  1 18:49:00 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Nov  1 18:49:05 2004
Subject: [Rd] R-2.0.0/lib/R/bin/INSTALL (PR#7329)
In-Reply-To: <20041101171750.C906E11020@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0411011739560.17086-100000@gannet.stats>

On Mon, 1 Nov 2004 mmokrejs@ribosome.natur.cuni.cz wrote:

>   the install script should make sure user has set R_HOME variable.

If you mean, R_HOME/bin/INSTALL, that is not an `install script'. It is
documented to be run as R CMD INSTALL, and R (a shell script) sets R_HOME.  
Please see, e.g. `An Introduction to R', ?INSTALL, the `R Installation and
Administration Manual'.  Or even look at the file, which says

usage="Usage: R CMD INSTALL [options] pkgs


> I don't have it as root, and get stupid messages. Anyway, should it be set
> to $blah/R-2.0.0/lib/R/ or $blah/R-2.0.0 ?
> Thanks for help

Please do as we ask and help us by

- reading the posting guide
- reading the relevant documentation
- reading the FAQ on BUGS

before submitting a report.  The second is likely to help you too.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From luke at stat.uiowa.edu  Mon Nov  1 19:31:14 2004
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon Nov  1 19:32:19 2004
Subject: [Rd] Destructive str(...)?
In-Reply-To: <Pine.LNX.4.44.0410311003570.11787-100000@gannet.stats>
References: <Pine.LNX.4.44.0410311003570.11787-100000@gannet.stats>
Message-ID: <Pine.LNX.4.58.0411011227110.2370@nokomis.stat.uiowa.edu>

On Sun, 31 Oct 2004, Prof Brian Ripley wrote:

> Just to be 100% clear, the finalizer is called *at most* once if (as in
> tcltk) R_RegisterCFinalizer is called.  If you want it to be called
> exactly once, you need to use R_RegisterCFinalizerEx.
> 
> The issue is that there may not be a final gc().
> 
> BTW, str(x) is destructive here too, so we do need to improve str().
> I have code written, but access to svn.r-project.org is down (yet again).
> 
> > x <- as.tclObj(pi)
> > str(x)
> Class 'tclObj' length 1 <pointer: 0x860c3f8>
> > str(x)
> length 1 <pointer: 0x860c3f8>
> 

Improving str is a good idea, but as there are other uses of unclass
out there it would probably be best to change the implementation to
wrap the pointers rather than use them directly.

In hindsight it would probably have been better to use an
implementation that internally wraps esxernal pointers as well as
environments so only the bits that really do need reference behavior
get it, and maybe at some point we should consider doing that.  Name
objects should probably just disallow changing attributes as null
currently does.

luke


> 
> On 31 Oct 2004, Peter Dalgaard wrote:
> 
> > Simon Urbanek <simon.urbanek@math.uni-augsburg.de> writes:
> > 
> > > Now, hold on a second - I thought the main point of EXTPTR is that the
> > > finalizer is called only once, that is when the last instance of the
> > > reference is disposed of by the gc (no matter how many copies existed
> > > meanwhile). Am I wrong and/or did I miss something? I did some tests
> > > which support my view, but one never knows ...
> > 
> > How do you ensure that the finalizer is called once? By *not* copying
> > the reference object! You can have as many references to it as you
> > like (i.e. assign it to multiple variables), and the object itself is
> > not removed until the last reference is gone, but if you modify the
> > object (most likely by setting attributes, but you might also change
> > the C pointer payload in a C routine), all "copies" are changed:
> > 
> > > x <- as.tclObj(pi)
> > > x
> > <Tcl> 3.14159265359
> > > y <- x
> > > y
> > <Tcl> 3.14159265359
> > > mode(x)
> > [1] "externalptr"
> > > attr(x, "Simon") <- "Urbanek"
> > > attributes(y)
> > $class
> > [1] "tclObj"
> > 
> > $Simon
> > [1] "Urbanek"
> 
> 

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From ripley at stats.ox.ac.uk  Mon Nov  1 19:50:11 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Nov  1 19:50:19 2004
Subject: [Rd] (PR#7326)(inappropriate) manipulation of expression objects
	causes segfault (PR#7326)
In-Reply-To: <x24qkdi42p.fsf@biostat.ku.dk>
Message-ID: <Pine.LNX.4.44.0411011838380.17397-100000@gannet.stats>


On 29 Oct 2004, Peter Dalgaard wrote:

> deepayan@stat.wisc.edu writes:
> 
> > > foo <- expression(alpha, beta, gamma)
> > > foo[2]
> > expression(beta)
> > > foo[2] <- NA
> > > foo ## or str(foo)
> > Segmentation fault
> > 
> > (Same behaviour in R 1.9.1)
> > 
> > 'foo[[2]] <- NA' works fine, though.
> 
> Right. The NA is not important; foo[2] <- 1 crashes R just as
> effectively. We should likely either give an error or demote [ to [[.
> The latter is what happens with lists, and expressions are basically
> just list of call objects (or names or constants). To wit:
> 
> > x <- list(1,2,3)
> > x[2] <- 1
> > x
> [[1]]
> [1] 1
> 
> [[2]]
> [1] 1
> 
> [[3]]
> [1] 3

That's not the issue: VectorAssign has identical code for the vector list 
and expression cases.  The issue is in SubassignTypeFix which says

    case 2010:	/* expression <- logical    */
	/* Note : No coercion is needed here. */
	/* We just insert the RHS into the LHS. */
	/* FIXME: is this true or should it be just like the "vector" case? */

and at level=1 the FIXME is correct.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Nov  1 19:50:25 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon Nov  1 19:50:32 2004
Subject: [Rd] (PR#7326)(inappropriate) manipulation of expression objects
Message-ID: <20041101185025.B262511007@slim.kubism.ku.dk>


On 29 Oct 2004, Peter Dalgaard wrote:

> deepayan@stat.wisc.edu writes:
> 
> > > foo <- expression(alpha, beta, gamma)
> > > foo[2]
> > expression(beta)
> > > foo[2] <- NA
> > > foo ## or str(foo)
> > Segmentation fault
> > 
> > (Same behaviour in R 1.9.1)
> > 
> > 'foo[[2]] <- NA' works fine, though.
> 
> Right. The NA is not important; foo[2] <- 1 crashes R just as
> effectively. We should likely either give an error or demote [ to [[.
> The latter is what happens with lists, and expressions are basically
> just list of call objects (or names or constants). To wit:
> 
> > x <- list(1,2,3)
> > x[2] <- 1
> > x
> [[1]]
> [1] 1
> 
> [[2]]
> [1] 1
> 
> [[3]]
> [1] 3

That's not the issue: VectorAssign has identical code for the vector list 
and expression cases.  The issue is in SubassignTypeFix which says

    case 2010:	/* expression <- logical    */
	/* Note : No coercion is needed here. */
	/* We just insert the RHS into the LHS. */
	/* FIXME: is this true or should it be just like the "vector" case? */

and at level=1 the FIXME is correct.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From mmokrejs at ribosome.natur.cuni.cz  Mon Nov  1 19:54:28 2004
From: mmokrejs at ribosome.natur.cuni.cz (=?windows-1252?Q?Martin_MOKREJ=8A?=)
Date: Mon Nov  1 19:54:35 2004
Subject: [Rd] R-2.0.0/lib/R/bin/INSTALL (PR#7329)
In-Reply-To: <x2oeihv4t7.fsf@biostat.ku.dk>
References: <20041101171750.C906E11020@slim.kubism.ku.dk>
	<x2oeihv4t7.fsf@biostat.ku.dk>
Message-ID: <41868664.60803@ribosome.natur.cuni.cz>

Dear all,
 I tried to follow http://www.bioconductor.org/faq.html#getBioC to install it,
and that's why I got to the problem.


Using getBioC to obtain Bioconductor packages

         1. From your R session, type:
            source("http://www.bioconductor.org/getBioC.R")
            this will download the getBioC functionality into your R session.
         2. To install Bioconductor packages, use the function "getBioC" as follows. To download and install the default packages, type:
            getBioC()
            For a different subset of packages, use the following  values for the libName argument (or "all" for all packages)
                o "all" - gets all packages (warning: This is a very large set)
                o "affy" - gets packages affy, affycomp, affydata, affyPLM, annaffy, gcrma, makecdfenv, matchprobes, plus "exprs".
                o "cdna" - gets packages marray, vsn, plus "exprs".
                o "default" - gets all packages from "affy", "cdna" and "exprs"
                o "exprs" - gets packages Biobase, annotate, edd, genefilter, geneploter, globaltest,ROC, MAGEML, multtest, limma, pamr, siggenes and vsn.
                o "graph" - gets packages graph, Rgraphviz and RBGL
                o "prog" - gets packages externalVector, graph, hexbin and Ruuid.
                o "widgets" - gets packages tkWidgets, widgetTools and DynDoc.
                o "database"- gets packages AnnBuilder, SAGElyzer, Rdbi, and RdbiPgSQL.
                o "design" - gets packages daMA and factDesign.
                o "annotation" - gets packages annotate, AnnBuilder, humanLLMappings, KEGG, GO, SNPtools, makecdfenv, and ontoTools.
                o "analyses" - gets packages Biobase, ctc, daMA, edd, factDesign, genefilter, geneplotter, globaltest, gpls, limma, RMAGEML, multtest, pamr, ROC, siggenes, and splicegear.
                o "externalData" - gets packages externalVector and rhdf5.
                o "arrayCGH" - gets packages DNAcopy and aCGH.
                o "proteomics" - gets packages gpls, PROcess and apComplex.
              You may also call "getBioC "with other arguments, including
                o "destdir": the directory where the downloaded packages will be stored. The default is the current working directory.
                o "develOK": Can be either TRUE or FALSE. The default value is , which means that only release level software will be installed. If instead it is set to TRUE, developmental software will be preferentially installed.
                o "verbose": TRUE or FALSE, to have any error related to the downloading process printed (TRUE) or not (FALSE). Error messages will still be returned but invisible if verbose is set to FALSE.
                o "bundle": a boolean indicating whether packages will be downloaded as bundles (TRUE) or individual packages (FALSE). Valid bundle (e. g. "all", "exprs") or package ("tkWidgets", "annotate") names have to be used in each case. If "bundle" is FALSE, any packages listed in the "libName" argument will be assumed to be proper package names.
         6. The script will try to install the downloaded packages and print "Installation complete" and TRUE on the screen when the installation was successful. Contact Jeff Gentry (jgentry@jimmy.harvard.edu) if the installation fails.


Maybe, there are items 3-5 lost. The document doesnt even say how to close R.
I doubt thise section is NOT for newbies, this describes how to get the things installed,
right? ;-)

So, typing "quit" at the ">" prompt doesn't help, btw. ^d is better, the only problem
is I've no idea if I should say y or n tot he question if I want to save my temporary image ....




To the INSTALL script actually I got via this problem:

Loading required package: tools 
Welcome to Bioconductor 
         Vignettes contain introductory material.  To view, 
         simply type: openVignette() 
         For details on reading vignettes, see
         the openVignette help page.
[1] TRUE
[1] TRUE
Loading required package: reposTools 

Attaching package 'reposTools':


        The following object(s) are masked from package:base :

         getRversion 

Loading required package: tkWidgets 
Loading required package: widgetTools 
Loading required package: tcltk 
X Error of failed request:  BadAtom (invalid Atom parameter)
  Major opcode of failed request:  18 (X_ChangeProperty)
  Atom id in failed request:  0x26a
  Serial number of failed request:  11
  Current serial number in output stream:  14
/afs/.biomed.cas.cz/i386_linux24/usr/bio/R-2.0.0/lib/R/bin/INSTALL: line 1: 12432 Broken pipe             cat "/afs/.biomed.cas.cz/i386_linux24/usr/bio/R-2.0.0/lib/R/library/AnnBuilder/R/AnnBuilder"
ERROR: execution of package source for 'AnnBuilder' failed



So  I tried to lookup the file and execute it. As is breaks around dcf.sh,
I thought it would help you to make the code die more clearly and more earlier.



Here is another case:

Loading required package: Biobase 
Loading required package: tools 
Welcome to Bioconductor 
         Vignettes contain introductory material.  To view, 
         simply type: openVignette() 
         For details on reading vignettes, see
         the openVignette help page.
[1] TRUE
Loading required package: GO 
Loading required package: annotate 
Loading required package: reposTools 

Attaching package 'reposTools':


        The following object(s) are masked from package:base :

         getRversion 

Loading required package: tkWidgets 
Loading required package: widgetTools 
Loading required package: tcltk 
X Error of failed request:  BadAtom (invalid Atom parameter)
  Major opcode of failed request:  18 (X_ChangeProperty)
  Atom id in failed request:  0x26a
  Serial number of failed request:  11
  Current serial number in output stream:  14
/afs/.biomed.cas.cz/i386_linux24/usr/bio/R-2.0.0/lib/R/bin/INSTALL: line 1: 13475 Broken pipe             cat "/afs/.biomed.cas.cz/i386_linux24/usr/bio/R-2.0.0/lib/R/library/GOstats/R/GOstats"
ERROR: execution of package source for 'GOstats' failed



Actually, as I saw the xauth check in configure, didn't bioconductor screw up my
X-forwarding? It seems so, as I cannot start any X-app right now. It works in a fresh session.
If this is the case, your appas should check first for env variable SSH_TTY, and if not set,
it could run xauth. Otherwise it should rather leave user do take care of X11 output.


Hope this helps
Martin


Peter Dalgaard wrote:
> mmokrejs@ribosome.natur.cuni.cz writes:
> 
> 
>>Hi,
>>  the install script should make sure user has set R_HOME variable.
>>I don't have it as root, and get stupid messages. Anyway, should it be set
>>to $blah/R-2.0.0/lib/R/ or $blah/R-2.0.0 ?
>>Thanks for help
>>Martin
> 
> 
> Please read the R-admin manual. The correct way of calling the INSTALL
> script is via
> 
>    R CMD INSTALL ...
> 
> And that will set automatically set R_HOME appropriately.
> 
> And please try to avoid reporting your own errors as bugs in R...
>

From jmacdon at med.umich.edu  Mon Nov  1 20:15:14 2004
From: jmacdon at med.umich.edu (James W. MacDonald)
Date: Mon Nov  1 20:15:35 2004
Subject: [Rd] R-2.0.0/lib/R/bin/INSTALL (PR#7329)
In-Reply-To: <41868664.60803@ribosome.natur.cuni.cz>
References: <20041101171750.C906E11020@slim.kubism.ku.dk>	<x2oeihv4t7.fsf@biostat.ku.dk>
	<41868664.60803@ribosome.natur.cuni.cz>
Message-ID: <41868B42.5040007@med.umich.edu>

Martin MOKREJ? wrote:
> Dear all,
> I tried to follow http://www.bioconductor.org/faq.html#getBioC to 
> install it,
> and that's why I got to the problem.
  You got into a problem because you missed the part where it explains 
that R-2.0.0 currently requires you to install the development versions 
of Bioconductor. Simply replace getBioC() with getBioC(develOK=TRUE).

In addition, questions about BioC packages should really be directed to 
the BioC listserv rather than an R-specific list like R-devel.

HTH,

Jim


-- 
James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109

From ligges at statistik.uni-dortmund.de  Mon Nov  1 20:19:56 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Nov  1 20:19:44 2004
Subject: [Rd] R-2.0.0/lib/R/bin/INSTALL (PR#7329)
In-Reply-To: <41868664.60803@ribosome.natur.cuni.cz>
References: <20041101171750.C906E11020@slim.kubism.ku.dk>	<x2oeihv4t7.fsf@biostat.ku.dk>
	<41868664.60803@ribosome.natur.cuni.cz>
Message-ID: <41868C5C.4010209@statistik.uni-dortmund.de>

Martin MOKREJ? wrote:

> Dear all,
> I tried to follow http://www.bioconductor.org/faq.html#getBioC to 
> install it,
> and that's why I got to the problem.
> 
> 
> Using getBioC to obtain Bioconductor packages
> 
>         1. From your R session, type:
>            source("http://www.bioconductor.org/getBioC.R")

[SNIP]


> Maybe, there are items 3-5 lost. The document doesnt even say how to 
> close R.
> I doubt thise section is NOT for newbies, this describes how to get the 
> things installed,
> right? ;-)
> 
> So, typing "quit" at the ">" prompt doesn't help, btw. ^d is better, the 
> only problem
> is I've no idea if I should say y or n tot he question if I want to save 
> my temporary image ....
> 
> 
> 
> 
> To the INSTALL script actually I got via this problem:
> 
> Loading required package: tools Welcome to Bioconductor         

[SNIP]

Two points:

a) Please read the manual "An Introduction to R", among many other 
things, it tells you how to close R and how to answer the question 
whether to save the workspace or not - it also tells you what the 
workspace is.

b) Please ask questions related to the Bioconductor project on its own 
mailing list. At the moment, package management of Bioconductor is a bit 
different from R's "native" package management.

Uwe Ligges

From tavery at mun.ca  Mon Nov  1 21:46:53 2004
From: tavery at mun.ca (tavery@mun.ca)
Date: Mon Nov  1 21:46:56 2004
Subject: [Rd] ks.test calculations incorrect (PR#7330)
Message-ID: <20041101204653.C006B11020@slim.kubism.ku.dk>

Full_Name: t. avery
Version: 2.0.0
OS: windows xp / Linux
Submission from: (NULL) (131.162.134.159)


ks.test does not produce the correct output.
If given the script:

d1 <- c(53.63984674,0.383141762,1.915708812,0.383141762,10.72796935,6.896551724,20.30651341,5.747126437,0)
d1

d2 <- c(76.43312102,15.2866242,3.821656051,1.27388535,0,0.636942675,1.27388535,0.636942675,0.636942675)
d2

ks.test(d1,d2,alternative="two.sided",exact)

The output generates:
        Two-sample Kolmogorov-Smirnov test

data:  dd and ddd 
D = 0.3333, p-value = 0.6994
alternative hypothesis: two.sided 

Warning message: 
cannot compute correct p-values with ties in: ks.test(dd, ddd, alternative =
"two.sided", exact)

Which is far from the correct D value of:

D = 0.404934475 with a p-value < 0.01

I recommend that noone use this test. I have tested it with various datasets
from publications and texts using by-hand calculations.

From p.dalgaard at biostat.ku.dk  Mon Nov  1 22:33:40 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Nov  1 22:34:14 2004
Subject: [Rd] ks.test calculations incorrect (PR#7330)
In-Reply-To: <20041101204653.C006B11020@slim.kubism.ku.dk>
References: <20041101204653.C006B11020@slim.kubism.ku.dk>
Message-ID: <x2acu12r0r.fsf@biostat.ku.dk>

tavery@mun.ca writes:
 
> Full_Name: t. avery
> Version: 2.0.0
> OS: windows xp / Linux
> Submission from: (NULL) (131.162.134.159)
> 
> 
> ks.test does not produce the correct output.
> If given the script:
> 
> d1 <- c(53.63984674,0.383141762,1.915708812,0.383141762,10.72796935,6.896551724,20.30651341,5.747126437,0)
> d1
> 
> d2 <- c(76.43312102,15.2866242,3.821656051,1.27388535,0,0.636942675,1.27388535,0.636942675,0.636942675)
> d2
> 
> ks.test(d1,d2,alternative="two.sided",exact)
> 
> The output generates:
>         Two-sample Kolmogorov-Smirnov test
> 
> data:  dd and ddd 
> D = 0.3333, p-value = 0.6994
> alternative hypothesis: two.sided 
> 
> Warning message: 
> cannot compute correct p-values with ties in: ks.test(dd, ddd, alternative =
> "two.sided", exact)
> 
> Which is far from the correct D value of:
> 
> D = 0.404934475 with a p-value < 0.01

According to what definition? Referring to what distribution?
Reference?

Considering that D is the distance between two CDFs, both of which
take values in (0:9)/9, I do find it a bit unconvincing that you claim
that D should be something that is not a whole number of ninths...
 
> I recommend that noone use this test. I have tested it with various datasets
> from publications and texts using by-hand calculations.

Well, I'm no fan of the KS test either, but you have to work harder to
convince us that there's a problem in R's implementation!

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From dan at bolser.co.uk  Tue Nov  2 01:12:19 2004
From: dan at bolser.co.uk (dan@bolser.co.uk)
Date: Tue Nov  2 01:12:22 2004
Subject: [Rd] barplot manpage (PR#7331)
Message-ID: <20041102001219.C67FD11011@slim.kubism.ku.dk>

Full_Name: Dan B
Version: R 2.0.0 (2004-10-04).
OS: Fedora 2
Submission from: (NULL) (80.6.127.185)


The man page for barplot (?barplot) is confusing...

<quote>
cex.axis: expansion factor for numeric axis labels.
cex.names: expansion factor for axis names (bar labels).
</quote>

What is an 'expansion factor', and what does it do in this context?


<quote>
axis.lty: the graphics parameter 'lty' applied to the axis and tick
          marks of the categorical (default horizontal) axis.  Note
          that by default the axis is suppressed.
</quote>

This makes no sense unless you know what it does already (which I don't). So
this is more of a programmers cleft note in a 'common language' than a function
documentation page.

<quote>
say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
</quote>

Say what?

From tplate at acm.org  Tue Nov  2 02:15:48 2004
From: tplate at acm.org (Tony Plate)
Date: Tue Nov  2 02:16:01 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <20041102001219.C67FD11011@slim.kubism.ku.dk>
References: <20041102001219.C67FD11011@slim.kubism.ku.dk>
Message-ID: <6.1.0.6.2.20041101181057.0ba851f8@mailhost.blackmesacapital.com>

Look at the help page for "par" for explanations of "cex" and "lty".

The use of 'mp' is as a variable, as in

 > mp <- barplot(....)

The next paragraph refers to this variable.

-- Tony Plate

At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
>Full_Name: Dan B
>Version: R 2.0.0 (2004-10-04).
>OS: Fedora 2
>Submission from: (NULL) (80.6.127.185)
>
>
>The man page for barplot (?barplot) is confusing...
>
><quote>
>cex.axis: expansion factor for numeric axis labels.
>cex.names: expansion factor for axis names (bar labels).
></quote>
>
>What is an 'expansion factor', and what does it do in this context?
>
>
><quote>
>axis.lty: the graphics parameter 'lty' applied to the axis and tick
>           marks of the categorical (default horizontal) axis.  Note
>           that by default the axis is suppressed.
></quote>
>
>This makes no sense unless you know what it does already (which I don't). So
>this is more of a programmers cleft note in a 'common language' than a 
>function
>documentation page.
>
><quote>
>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
></quote>
>
>Say what?
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From dmb at mrc-dunn.cam.ac.uk  Tue Nov  2 08:52:38 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Tue Nov  2 08:53:09 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <6.1.0.6.2.20041101181057.0ba851f8@mailhost.blackmesacapital.com>
Message-ID: <Pine.LNX.4.21.0411020751190.853-100000@mail.mrc-dunn.cam.ac.uk>


Should these be in the (see also section)?

Like I said, the pages read fine if you understand the content already. I
think some less formal man pages would drastically reduce the traffic on
the R mailing list. 

Just a hunch,
Dan.

On Mon, 1 Nov 2004, Tony Plate wrote:

>Look at the help page for "par" for explanations of "cex" and "lty".
>
>The use of 'mp' is as a variable, as in
>
> > mp <- barplot(....)
>
>The next paragraph refers to this variable.
>
>-- Tony Plate
>
>At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
>>Full_Name: Dan B
>>Version: R 2.0.0 (2004-10-04).
>>OS: Fedora 2
>>Submission from: (NULL) (80.6.127.185)
>>
>>
>>The man page for barplot (?barplot) is confusing...
>>
>><quote>
>>cex.axis: expansion factor for numeric axis labels.
>>cex.names: expansion factor for axis names (bar labels).
>></quote>
>>
>>What is an 'expansion factor', and what does it do in this context?
>>
>>
>><quote>
>>axis.lty: the graphics parameter 'lty' applied to the axis and tick
>>           marks of the categorical (default horizontal) axis.  Note
>>           that by default the axis is suppressed.
>></quote>
>>
>>This makes no sense unless you know what it does already (which I don't). So
>>this is more of a programmers cleft note in a 'common language' than a 
>>function
>>documentation page.
>>
>><quote>
>>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
>></quote>
>>
>>Say what?
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ligges at statistik.uni-dortmund.de  Tue Nov  2 09:14:29 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue Nov  2 09:14:15 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <46E679AFC0427C4B90CF3342E02A538E04985E@NYWEXMB31.msad.ms.com>
References: <46E679AFC0427C4B90CF3342E02A538E04985E@NYWEXMB31.msad.ms.com>
Message-ID: <418741E5.4090705@statistik.uni-dortmund.de>

Primer, Jeremy (FID) wrote:

> A development note:
> 
> In the function "install.packages", it would be helpful to those of us
> who have atypical installations and install manually from ZIP files to
> have
> 
> 	pkgnames <- sub("\\.zip$", "", pkgnames)
> 
> replaced with
> 
> 	pkgnames <- sub("\\.zip$", "", pkgnames, ignore.case = TRUE)
> 
> because the contributed zipfiles are ZIPfiles. The routine did not work
> for me out of the box.

[moved to R-devel]

Hmmm. Recent versions of R require correctly installed versions (using R 
CMD INSTALL) of the packages. It is hard work to get a file called *.ZIP 
(rather than *.zip) that contains a valid binary package for Windows.
I'd vote against such a change, since the recent behaviour suggests 
perfectly well that the file probably won't work.

Uwe Ligges


> 
> Jeremy Primer 
> --------------------------------------------------------
>  
> This is not an offer (or solicitation of an offer) to buy/sell the securities/instruments mentioned or an official confirmation.  Morgan Stanley may deal as principal in or own or act as market maker for securities/instruments mentioned or may advise the issuers.  This is not research and is not from MS Research but it may refer to a research analyst/research report.  Unless indicated, these views are the author's and may differ from those of Morgan Stanley research or others in the Firm.  We do not represent this is accurate or complete and we may not update this.  Past performance is not indicative of future returns.  For additional information, research reports and important disclosures, contact me or see https://secure.ms.com/servlet/cls.  You should not use e-mail to request, authorize or effect the purchase or sale of any security or instrument, to send transfer instructions, or to effect any other transactions.  We cannot guarantee that any such requests received vi
a !
>  e-mail will be processed in a timely manner.  This communication is solely for the addressee(s) and may contain confidential information.  We do not waive confidentiality by mistransmission.  Contact me if you do not wish to receive these communications.  In the UK, this communication is directed in the UK to those persons who are market counterparties or intermediate customers (as defined in the UK Financial Services Authority's rules).
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html

From ripley at stats.ox.ac.uk  Tue Nov  2 09:45:12 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov  2 09:45:17 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <418741E5.4090705@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.44.0411020833340.28169-100000@gannet.stats>

On Tue, 2 Nov 2004, Uwe Ligges wrote:

> Primer, Jeremy (FID) wrote:
> 
> > A development note:
> > 
> > In the function "install.packages", it would be helpful to those of us
> > who have atypical installations and install manually from ZIP files to

Perhaps you could tell us why you do this?  Where do you get `contributed 
zipfiles' that are actually `ZIPfiles', especially as CRAN has .zip files 
you could get instead?  Or is the problem in the way you get them?

> > have
> > 
> > 	pkgnames <- sub("\\.zip$", "", pkgnames)
> > 
> > replaced with
> > 
> > 	pkgnames <- sub("\\.zip$", "", pkgnames, ignore.case = TRUE)
> > 
> > because the contributed zipfiles are ZIPfiles. The routine did not work
> > for me out of the box.
> 
> [moved to R-devel]
> 
> Hmmm. Recent versions of R require correctly installed versions (using R 
> CMD INSTALL) of the packages. It is hard work to get a file called *.ZIP 
> (rather than *.zip) that contains a valid binary package for Windows.
> I'd vote against such a change, since the recent behaviour suggests 
> perfectly well that the file probably won't work.

Nothing stops people with `atypical installations' amending functions to 
suit their atypicality, but it is usually better to fix your local 
problems that expect your tools to workaround them.

[Analogously, R CMD INSTALL will not install .tgz files on Unix, even 
though some people distribute them: they are (equally) not a supported 
format.]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Ted.Harding at nessie.mcc.ac.uk  Tue Nov  2 10:03:26 2004
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Tue Nov  2 11:46:48 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <Pine.LNX.4.44.0411020833340.28169-100000@gannet.stats>
Message-ID: <XFMail.041102100326.Ted.Harding@nessie.mcc.ac.uk>

On 02-Nov-04 Prof Brian Ripley wrote:
> [...]
> [Analogously, R CMD INSTALL will not install .tgz files on Unix,
> even though some people distribute them: they are (equally) not
> a supported format.]

Hmmm.
Maybe I'm out of date (R 1.8.0) but my Linux /usr/lib/R/bin/INSTALL
has:

      if test -f "${1}"; then
        pkgname=`basename "${1}"`
        ## Also allow for 'package.tgz' ...
        pkgname=`basename "${pkgname}" .tgz`
        pkgname=`echo "${pkgname}" | sed 's/_.*//'`
        ## ...
        gzip -dc "${1}" | (cd "${tmpdir}" && ${TAR} -mxf -)

which looks to me as though it should cope fine with *.tgz as well
as with *.tar.gz, since the 'gzip -dc' doesn't care what the name
"${1}" is, and the ${TAR} is getting the unzipped output on stdin.

And in any case it looks as though 'pkgname' will come out right
whatever follows the first "_." in the tar file name (so long as
the file name is of the form pkgname_.*).

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861  [NB: New number!]
Date: 02-Nov-04                                       Time: 10:03:26
------------------------------ XFMail ------------------------------

From ripley at stats.ox.ac.uk  Tue Nov  2 12:12:55 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov  2 12:13:02 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <XFMail.041102100326.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <Pine.LNX.4.44.0411021058140.11989-100000@gannet.stats>

On Tue, 2 Nov 2004 Ted.Harding@nessie.mcc.ac.uk wrote:

> On 02-Nov-04 Prof Brian Ripley wrote:
> > [...]
> > [Analogously, R CMD INSTALL will not install .tgz files on Unix,
> > even though some people distribute them: they are (equally) not
> > a supported format.]
> 
> Hmmm.
> Maybe I'm out of date (R 1.8.0) but my Linux /usr/lib/R/bin/INSTALL

You are, four and shortly to be five releases out of date.  But in this 
case R's documentation is even more out of date.

> has:
> 
>       if test -f "${1}"; then
>         pkgname=`basename "${1}"`
>         ## Also allow for 'package.tgz' ...
>         pkgname=`basename "${pkgname}" .tgz`
>         pkgname=`echo "${pkgname}" | sed 's/_.*//'`
>         ## ...
>         gzip -dc "${1}" | (cd "${tmpdir}" && ${TAR} -mxf -)
> 
> which looks to me as though it should cope fine with *.tgz as well
> as with *.tar.gz, since the 'gzip -dc' doesn't care what the name
> "${1}" is, and the ${TAR} is getting the unzipped output on stdin.
> 
> And in any case it looks as though 'pkgname' will come out right
> whatever follows the first "_." in the tar file name (so long as
> the file name is of the form pkgname_.*).

However, that's not what ?INSTALL says is supported so it is an 
unsupported feature, that used not to work and it seems has not been 
announced in NEWS.  

It looks like it was an unannounced change in 2002.  After some digging 
I found that the relevant cvs entry appears to be

  r21427 | hornik | 2002-10-05 19:30:34 +0100 (Sat, 05 Oct 2002) | 3 lines

  Make installing 'foo.tgz' source packages work.
  Do not preserve modification times when unpacking sources.

on R-1-6-patches (that is, a new feature on a patches branch).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From filter at ipbs.fr  Tue Nov  2 12:30:54 2004
From: filter at ipbs.fr (filter@ipbs.fr)
Date: Tue Nov  2 12:30:56 2004
Subject: [Rd] WARNING (PR#7334)
Message-ID: <20041102113054.467CF10ED7@slim.kubism.ku.dk>

IPBS Postmaster refuse some attachement: 
*.hta, *.cmd, *.zip, *.rar, *.chm, *.scr, *.dll, *.exe, *.pif, *.bat, *.com, *.vbs, *.vba, *.cpl, *.HTA, *.RAR, *.CHM, *.SCR, *.DLL, *.EXE, *.PIF, *.BAT, *.COM, *.VBS, *.VBA, *.ZIP, *.CMD, *.CPL, 
 IPBS Postmaster has refused "document.ZIP in the mail 
From: r-bugs@r-project.org 
To: laurent.bardi@ipbs.fr 
Subject: Re: my word document 
 
Your mail has not been delivered
Try to rename the file attached and send it again

From p.dalgaard at biostat.ku.dk  Tue Nov  2 12:31:04 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Nov  2 12:31:36 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <XFMail.041102100326.Ted.Harding@nessie.mcc.ac.uk>
References: <XFMail.041102100326.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <x27jp4h4hz.fsf@biostat.ku.dk>

(Ted Harding) <Ted.Harding@nessie.mcc.ac.uk> writes:

> On 02-Nov-04 Prof Brian Ripley wrote:
> > [...]
> > [Analogously, R CMD INSTALL will not install .tgz files on Unix,
> > even though some people distribute them: they are (equally) not
> > a supported format.]
> 
> Maybe I'm out of date (R 1.8.0) but my Linux /usr/lib/R/bin/INSTALL
> has:

You are, but it still has...
 
>       if test -f "${1}"; then
>         pkgname=`basename "${1}"`
>         ## Also allow for 'package.tgz' ...
>         pkgname=`basename "${pkgname}" .tgz`

I don't think an unversioned .tar.gz file survives that treatment
though. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From daemon at bravo.kis.keele.ac.uk  Tue Nov  2 13:41:45 2004
From: daemon at bravo.kis.keele.ac.uk (daemon@bravo.kis.keele.ac.uk)
Date: Tue Nov  2 13:44:52 2004
Subject: [Rd] MESSAGE RETURNED - blocked zip attachment
In-Reply-To: <E1COxyq-0003Qw-00@bravo.kis.keele.ac.uk>
Message-ID: <E1COxyr-0003Qz-00@bravo.kis.keele.ac.uk>



     **** IMPORTANT NOTICE ****

The mail system at Keele University has received a message (possibly) from you
which appears to contain a zipfile attachment.

We are currently blocking all such messages due to high
levels of virus activity involving zip files.

We apologize if this is affecting the delivery of bona fide material.

Please try to deliver such material using another method.

From abumami at kaluach.net  Tue Nov  2 14:10:04 2004
From: abumami at kaluach.net (Kaluach.net)
Date: Tue Nov  2 14:10:21 2004
Subject: [Rd] email closed because of spam
Message-ID: <E1COyQG-0001FI-Ma@badboy.abumami.com>

Shalom,

Due to spam, this email has been closed. For more information, use the contact page at http://www.kaluach.org/contact.

Thank you,

Abu Mami

From Jeremy.Primer at morganstanley.com  Tue Nov  2 16:17:21 2004
From: Jeremy.Primer at morganstanley.com (Primer, Jeremy (FID))
Date: Tue Nov  2 16:17:37 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
Message-ID: <46E679AFC0427C4B90CF3342E02A538E049860@NYWEXMB31.msad.ms.com>

Uwe and Brian,

Thanks for your attention to this one.

We currently have the following array of atypical situations in our
corporate installation:

(1) Central install directory, where I neither have nor can reasonably
want Administrator priviledges;
(2) IT staff willing to maintain R officially but wants to leave
*contributed* packages to user groups if at all possible;
(3) Direct access from R to the CRAN not working through any of the
methods owing to the proxy server.

So I downloaded some 40 contributed package *.ZIP files directly from
CRAN using Internet Explorer, then ran install.packages() in R on these
local zipfiles with parameter CRAN=NULL. Except for the case-sensitivity
of the "*.zip" extension in install.packages(), which I amended myself,
this appears to have worked fine, passed checksums, etc.  Since I
installed the packages with install.packages() and they passed checksum,
I don't see why they would not work. Some simple tests worked, and
setting libPaths() and running installed.packages() suggests that R
knows what it has. 

I can continue on fine as is, so the remaining question is whether
install.packages() should be amended for other users. I felt it did not
fulfill its contract in a basic way. However, I did enjoy learning about
R debug facilities, something I'll need to know ....

Regards,
Jeremy Primer
 
-----Original Message-----
From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
Sent: Tuesday, November 02, 2004 3:45 AM
To: Uwe Ligges
Cc: Primer, Jeremy (FID); R-devel
Subject: Re: [Rd] Re: [R] case-insensitive ZIP

On Tue, 2 Nov 2004, Uwe Ligges wrote:

> Primer, Jeremy (FID) wrote:
> 
> > A development note:
> > 
> > In the function "install.packages", it would be helpful to those of 
> > us who have atypical installations and install manually from ZIP 
> > files to

Perhaps you could tell us why you do this?  Where do you get
`contributed zipfiles' that are actually `ZIPfiles', especially as CRAN
has .zip files you could get instead?  Or is the problem in the way you
get them?

> > have
> > 
> > 	pkgnames <- sub("\\.zip$", "", pkgnames)
> > 
> > replaced with
> > 
> > 	pkgnames <- sub("\\.zip$", "", pkgnames, ignore.case = TRUE)
> > 
> > because the contributed zipfiles are ZIPfiles. The routine did not 
> > work for me out of the box.
> 
> [moved to R-devel]
> 
> Hmmm. Recent versions of R require correctly installed versions (using

> R CMD INSTALL) of the packages. It is hard work to get a file called 
> *.ZIP (rather than *.zip) that contains a valid binary package for
Windows.
> I'd vote against such a change, since the recent behaviour suggests 
> perfectly well that the file probably won't work.

Nothing stops people with `atypical installations' amending functions to
suit their atypicality, but it is usually better to fix your local
problems that expect your tools to workaround them.

[Analogously, R CMD INSTALL will not install .tgz files on Unix, even
though some people distribute them: they are (equally) not a supported
format.]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595 
--------------------------------------------------------
 
This is not an offer (or solicitation of an offer) to buy/se...{{dropped}}

From ligges at statistik.uni-dortmund.de  Tue Nov  2 16:22:30 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue Nov  2 16:22:13 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <46E679AFC0427C4B90CF3342E02A538E049860@NYWEXMB31.msad.ms.com>
References: <46E679AFC0427C4B90CF3342E02A538E049860@NYWEXMB31.msad.ms.com>
Message-ID: <4187A636.6030808@statistik.uni-dortmund.de>

Primer, Jeremy (FID) wrote:

> Uwe and Brian,
> 
> Thanks for your attention to this one.
> 
> We currently have the following array of atypical situations in our
> corporate installation:
> 
> (1) Central install directory, where I neither have nor can reasonably
> want Administrator priviledges;
> (2) IT staff willing to maintain R officially but wants to leave
> *contributed* packages to user groups if at all possible;
> (3) Direct access from R to the CRAN not working through any of the
> methods owing to the proxy server.
> 
> So I downloaded some 40 contributed package *.ZIP files directly from
> CRAN using Internet Explorer, then ran install.packages() in R on these
> local zipfiles with parameter CRAN=NULL. Except for the case-sensitivity
> of the "*.zip" extension in install.packages(), which I amended myself,
> this appears to have worked fine, passed checksums, etc.  Since I
> installed the packages with install.packages() and they passed checksum,
> I don't see why they would not work. Some simple tests worked, and
> setting libPaths() and running installed.packages() suggests that R
> knows what it has. 

No, I mean that some self zipped .ZIP files won't work generally. Those 
on CRAN are build with R CMD INSTALL --build, and they do have the 
extension .zip rather than .ZIP.

So it looks like your web browser does strange things with the extension.

Uwe Ligges



> I can continue on fine as is, so the remaining question is whether
> install.packages() should be amended for other users. I felt it did not
> fulfill its contract in a basic way. However, I did enjoy learning about
> R debug facilities, something I'll need to know ....
> 
> Regards,
> Jeremy Primer
>  
> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> Sent: Tuesday, November 02, 2004 3:45 AM
> To: Uwe Ligges
> Cc: Primer, Jeremy (FID); R-devel
> Subject: Re: [Rd] Re: [R] case-insensitive ZIP
> 
> On Tue, 2 Nov 2004, Uwe Ligges wrote:
> 
> 
>>Primer, Jeremy (FID) wrote:
>>
>>
>>>A development note:
>>>
>>>In the function "install.packages", it would be helpful to those of 
>>>us who have atypical installations and install manually from ZIP 
>>>files to
> 
> 
> Perhaps you could tell us why you do this?  Where do you get
> `contributed zipfiles' that are actually `ZIPfiles', especially as CRAN
> has .zip files you could get instead?  Or is the problem in the way you
> get them?
> 
> 
>>>have
>>>
>>>	pkgnames <- sub("\\.zip$", "", pkgnames)
>>>
>>>replaced with
>>>
>>>	pkgnames <- sub("\\.zip$", "", pkgnames, ignore.case = TRUE)
>>>
>>>because the contributed zipfiles are ZIPfiles. The routine did not 
>>>work for me out of the box.
>>
>>[moved to R-devel]
>>
>>Hmmm. Recent versions of R require correctly installed versions (using
> 
> 
>>R CMD INSTALL) of the packages. It is hard work to get a file called 
>>*.ZIP (rather than *.zip) that contains a valid binary package for
> 
> Windows.
> 
>>I'd vote against such a change, since the recent behaviour suggests 
>>perfectly well that the file probably won't work.
> 
> 
> Nothing stops people with `atypical installations' amending functions to
> suit their atypicality, but it is usually better to fix your local
> problems that expect your tools to workaround them.
> 
> [Analogously, R CMD INSTALL will not install .tgz files on Unix, even
> though some people distribute them: they are (equally) not a supported
> format.]
>

From ripley at stats.ox.ac.uk  Tue Nov  2 16:28:21 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov  2 16:28:25 2004
Subject: [Rd] Re: [R] case-insensitive ZIP
In-Reply-To: <4187A636.6030808@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.44.0411021523340.25459-100000@gannet.stats>

On Tue, 2 Nov 2004, Uwe Ligges wrote:

> Primer, Jeremy (FID) wrote:
> 
> > Uwe and Brian,
> > 
> > Thanks for your attention to this one.
> > 
> > We currently have the following array of atypical situations in our
> > corporate installation:
> > 
> > (1) Central install directory, where I neither have nor can reasonably
> > want Administrator priviledges;
> > (2) IT staff willing to maintain R officially but wants to leave
> > *contributed* packages to user groups if at all possible;
> > (3) Direct access from R to the CRAN not working through any of the
> > methods owing to the proxy server.
> > 
> > So I downloaded some 40 contributed package *.ZIP files directly from
> > CRAN using Internet Explorer, then ran install.packages() in R on these
> > local zipfiles with parameter CRAN=NULL. Except for the case-sensitivity
> > of the "*.zip" extension in install.packages(), which I amended myself,
> > this appears to have worked fine, passed checksums, etc.  Since I
> > installed the packages with install.packages() and they passed checksum,
> > I don't see why they would not work. Some simple tests worked, and
> > setting libPaths() and running installed.packages() suggests that R
> > knows what it has. 
> 
> No, I mean that some self zipped .ZIP files won't work generally. Those 
> on CRAN are build with R CMD INSTALL --build, and they do have the 
> extension .zip rather than .ZIP.
> 
> So it looks like your web browser does strange things with the extension.

And the solution is to fix that.  I've just tested it, and the latest IE6 
does not do it for me, so I suggest you ask your IT staff to repair
the problem on your installation.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tplate at acm.org  Tue Nov  2 16:57:05 2004
From: tplate at acm.org (Tony Plate)
Date: Tue Nov  2 16:57:16 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <Pine.LNX.4.21.0411020751190.853-100000@mail.mrc-dunn.cam.a c.uk>
References: <6.1.0.6.2.20041101181057.0ba851f8@mailhost.blackmesacapital.com>
	<Pine.LNX.4.21.0411020751190.853-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <6.1.0.6.2.20041102083711.0bad8810@pop.1and1.com>

Yup, I think you're right.  R is a volunteer project, so what needs to 
happen to improve the documentation is that some capable volunteers (or 
just one volunteer) step forward.   It is the prerogative of the members of 
R-core to decide whether to spend their time on improving documentation or 
improving the functionality (or merely having a life).

However it is worth noting that R does have really quite good documentation 
for a piece of software of its kind, compared to both other open source and 
commercial software.

What would need to be improved in the document "An Introduction to R", 
specifically, the subsubsection on "Graphical Elements" (under "Graphics 
Parameters List" in "Graphical Procedures", p 77 in my copy) in order that 
it would meet the criterion of being "less formal man pages"?  There's a 
lot to be said for having the "less formal" documentation being organized 
around concepts rather than specific functions (as the man pages are), 
because the conceptual organization allows more organized discussion of how 
functions work together and which are the appropriate functions to 
accomplish certain types of tasks.

Maybe inserting automatically generated "see also" references to "An 
Introduction to R" into the man pages would help beginners (and those who 
have to deal with cleaning up bug reports that aren't really bugs)?

-- Tony Plate

At Tuesday 12:52 AM 11/2/2004, Dan Bolser wrote:

>Should these be in the (see also section)?
>
>Like I said, the pages read fine if you understand the content already. I
>think some less formal man pages would drastically reduce the traffic on
>the R mailing list.
>
>Just a hunch,
>Dan.
>
>On Mon, 1 Nov 2004, Tony Plate wrote:
>
> >Look at the help page for "par" for explanations of "cex" and "lty".
> >
> >The use of 'mp' is as a variable, as in
> >
> > > mp <- barplot(....)
> >
> >The next paragraph refers to this variable.
> >
> >-- Tony Plate
> >
> >At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
> >>Full_Name: Dan B
> >>Version: R 2.0.0 (2004-10-04).
> >>OS: Fedora 2
> >>Submission from: (NULL) (80.6.127.185)
> >>
> >>
> >>The man page for barplot (?barplot) is confusing...
> >>
> >><quote>
> >>cex.axis: expansion factor for numeric axis labels.
> >>cex.names: expansion factor for axis names (bar labels).
> >></quote>
> >>
> >>What is an 'expansion factor', and what does it do in this context?
> >>
> >>
> >><quote>
> >>axis.lty: the graphics parameter 'lty' applied to the axis and tick
> >>           marks of the categorical (default horizontal) axis.  Note
> >>           that by default the axis is suppressed.
> >></quote>
> >>
> >>This makes no sense unless you know what it does already (which I 
> don't). So
> >>this is more of a programmers cleft note in a 'common language' than a
> >>function
> >>documentation page.
> >>
> >><quote>
> >>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
> >></quote>
> >>
> >>Say what?
> >>
> >>______________________________________________
> >>R-devel@stat.math.ethz.ch mailing list
> >>https://stat.ethz.ch/mailman/listinfo/r-devel
> >

From dmb at mrc-dunn.cam.ac.uk  Tue Nov  2 17:25:54 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Tue Nov  2 17:26:31 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <6.1.0.6.2.20041102083711.0bad8810@pop.1and1.com>
Message-ID: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>

On Tue, 2 Nov 2004, Tony Plate wrote:

>Yup, I think you're right.  R is a volunteer project, so what needs to 
>happen to improve the documentation is that some capable volunteers (or 
>just one volunteer) step forward.   It is the prerogative of the members of 
>R-core to decide whether to spend their time on improving documentation or 
>improving the functionality (or merely having a life).

I could try making better pages for the functions I use.


>However it is worth noting that R does have really quite good documentation 
>for a piece of software of its kind, compared to both other open source and 
>commercial software.

That is very true. However, I still maintain that the emphasis is on
developers and not learners.


>What would need to be improved in the document "An Introduction to R", 
>specifically, the subsubsection on "Graphical Elements" (under "Graphics 
>Parameters List" in "Graphical Procedures", p 77 in my copy) in order that 
>it would meet the criterion of being "less formal man pages"?  There's a 

Having it to hand when you need it (i.e. at the command line) like other
man style documentation systems. Also having reference to all the related
functions. 

My problem is this, my barplot has decided to use SI for big numbers. I
would rather it use the number in full... How do I do it? I don't know...
Some of my column labels are going missing... how do I fix it... I don't
know... My legend is in the top right when the top left would be much
better, how do I fix it... 

I read ?barplot, but I didn't *see* what I needed - I don't doubt that
someone who already knew how to do these things could look at ?barplot and
say that its fine. I can't say that.



>lot to be said for having the "less formal" documentation being organized 
>around concepts rather than specific functions (as the man pages are), 
>because the conceptual organization allows more organized discussion of how 
>functions work together and which are the appropriate functions to 
>accomplish certain types of tasks.

True, but that is a different task. A 'guide to use' is different from a
'user guide'. I find time and time again tiny problems (conceptually
trivial) which are very frustrating in R, I don't want to ask a question
on the list, I don't want to trawl the archives for the answer, I want a
clearer explanation of how the darn function works!

I think having a concept based approach is essential (as you say), but the
'nuggets' should be posted around to the different functions, so each
concept for each function is indexed under that function for easy
retrieval (if that makes sense).


>Maybe inserting automatically generated "see also" references to "An 
>Introduction to R" into the man pages would help beginners (and those who 

I think so. 

>have to deal with cleaning up bug reports that aren't really bugs)?

Sorry, I made some comment about 'constantly wanted to improve the info
pages' on the mailing list, (with regards to a Wiki dump of the said pages
into the user domain). One reply said that instead I should request that
the documents be changed via a bug report from the R web site. 

I honestly want to give my time and energy to help users like me use R. I
very often find the man pages totally cryptic and often frustrating.

Sometimes the examples read like entries from a Perl obfustication
competition - people taking delight in doing things as tersely as possible
to 'get kudos' from their 'knowledgeable' peers. 

The Perl documentation system is a joy to use. However, we shouldn't
compare apples and oranges...

Thanks for your help, and sorry for the inconvenience. I am (still) only
trying to help :)

All the best
Dan.

>-- Tony Plate
>
>At Tuesday 12:52 AM 11/2/2004, Dan Bolser wrote:
>
>>Should these be in the (see also section)?
>>
>>Like I said, the pages read fine if you understand the content already. I
>>think some less formal man pages would drastically reduce the traffic on
>>the R mailing list.
>>
>>Just a hunch,
>>Dan.
>>
>>On Mon, 1 Nov 2004, Tony Plate wrote:
>>
>> >Look at the help page for "par" for explanations of "cex" and "lty".
>> >
>> >The use of 'mp' is as a variable, as in
>> >
>> > > mp <- barplot(....)
>> >
>> >The next paragraph refers to this variable.
>> >
>> >-- Tony Plate
>> >
>> >At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
>> >>Full_Name: Dan B
>> >>Version: R 2.0.0 (2004-10-04).
>> >>OS: Fedora 2
>> >>Submission from: (NULL) (80.6.127.185)
>> >>
>> >>
>> >>The man page for barplot (?barplot) is confusing...
>> >>
>> >><quote>
>> >>cex.axis: expansion factor for numeric axis labels.
>> >>cex.names: expansion factor for axis names (bar labels).
>> >></quote>
>> >>
>> >>What is an 'expansion factor', and what does it do in this context?
>> >>
>> >>
>> >><quote>
>> >>axis.lty: the graphics parameter 'lty' applied to the axis and tick
>> >>           marks of the categorical (default horizontal) axis.  Note
>> >>           that by default the axis is suppressed.
>> >></quote>
>> >>
>> >>This makes no sense unless you know what it does already (which I 
>> don't). So
>> >>this is more of a programmers cleft note in a 'common language' than a
>> >>function
>> >>documentation page.
>> >>
>> >><quote>
>> >>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
>> >></quote>
>> >>
>> >>Say what?
>> >>
>> >>______________________________________________
>> >>R-devel@stat.math.ethz.ch mailing list
>> >>https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>

From tplate at acm.org  Tue Nov  2 17:46:40 2004
From: tplate at acm.org (Tony Plate)
Date: Tue Nov  2 17:46:53 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam. ac.uk>
References: <6.1.0.6.2.20041102083711.0bad8810@pop.1and1.com>
	<Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <6.1.0.6.2.20041102093945.0badf5b8@pop.1and1.com>

I suspect that part of the reason for having terse documentation is that it 
is easier to maintain when changes are made to the code.  Now that R is 
more stable and mature maybe documentation could get a bit more expansive?

I also suspect that you will have a better chance of getting improvements 
into the documentation if you make specific suggestions about changes to 
the source code of the documentation, i.e., including the exact proposed 
wording and markup.  This will make it easy for someone with the necessary 
permissions (a member of R-core, I guess) to make the changes.

Tony Plate

At Tuesday 09:25 AM 11/2/2004, Dan Bolser wrote:
>On Tue, 2 Nov 2004, Tony Plate wrote:
>
> >Yup, I think you're right.  R is a volunteer project, so what needs to
> >happen to improve the documentation is that some capable volunteers (or
> >just one volunteer) step forward.   It is the prerogative of the members of
> >R-core to decide whether to spend their time on improving documentation or
> >improving the functionality (or merely having a life).
>
>I could try making better pages for the functions I use.
>
>
> >However it is worth noting that R does have really quite good documentation
> >for a piece of software of its kind, compared to both other open source and
> >commercial software.
>
>That is very true. However, I still maintain that the emphasis is on
>developers and not learners.
>
>
> >What would need to be improved in the document "An Introduction to R",
> >specifically, the subsubsection on "Graphical Elements" (under "Graphics
> >Parameters List" in "Graphical Procedures", p 77 in my copy) in order that
> >it would meet the criterion of being "less formal man pages"?  There's a
>
>Having it to hand when you need it (i.e. at the command line) like other
>man style documentation systems. Also having reference to all the related
>functions.
>
>My problem is this, my barplot has decided to use SI for big numbers. I
>would rather it use the number in full... How do I do it? I don't know...
>Some of my column labels are going missing... how do I fix it... I don't
>know... My legend is in the top right when the top left would be much
>better, how do I fix it...
>
>I read ?barplot, but I didn't *see* what I needed - I don't doubt that
>someone who already knew how to do these things could look at ?barplot and
>say that its fine. I can't say that.
>
>
>
> >lot to be said for having the "less formal" documentation being organized
> >around concepts rather than specific functions (as the man pages are),
> >because the conceptual organization allows more organized discussion of how
> >functions work together and which are the appropriate functions to
> >accomplish certain types of tasks.
>
>True, but that is a different task. A 'guide to use' is different from a
>'user guide'. I find time and time again tiny problems (conceptually
>trivial) which are very frustrating in R, I don't want to ask a question
>on the list, I don't want to trawl the archives for the answer, I want a
>clearer explanation of how the darn function works!
>
>I think having a concept based approach is essential (as you say), but the
>'nuggets' should be posted around to the different functions, so each
>concept for each function is indexed under that function for easy
>retrieval (if that makes sense).
>
>
> >Maybe inserting automatically generated "see also" references to "An
> >Introduction to R" into the man pages would help beginners (and those who
>
>I think so.
>
> >have to deal with cleaning up bug reports that aren't really bugs)?
>
>Sorry, I made some comment about 'constantly wanted to improve the info
>pages' on the mailing list, (with regards to a Wiki dump of the said pages
>into the user domain). One reply said that instead I should request that
>the documents be changed via a bug report from the R web site.
>
>I honestly want to give my time and energy to help users like me use R. I
>very often find the man pages totally cryptic and often frustrating.
>
>Sometimes the examples read like entries from a Perl obfustication
>competition - people taking delight in doing things as tersely as possible
>to 'get kudos' from their 'knowledgeable' peers.
>
>The Perl documentation system is a joy to use. However, we shouldn't
>compare apples and oranges...
>
>Thanks for your help, and sorry for the inconvenience. I am (still) only
>trying to help :)
>
>All the best
>Dan.
>
> >-- Tony Plate
> >
> >At Tuesday 12:52 AM 11/2/2004, Dan Bolser wrote:
> >
> >>Should these be in the (see also section)?
> >>
> >>Like I said, the pages read fine if you understand the content already. I
> >>think some less formal man pages would drastically reduce the traffic on
> >>the R mailing list.
> >>
> >>Just a hunch,
> >>Dan.
> >>
> >>On Mon, 1 Nov 2004, Tony Plate wrote:
> >>
> >> >Look at the help page for "par" for explanations of "cex" and "lty".
> >> >
> >> >The use of 'mp' is as a variable, as in
> >> >
> >> > > mp <- barplot(....)
> >> >
> >> >The next paragraph refers to this variable.
> >> >
> >> >-- Tony Plate
> >> >
> >> >At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
> >> >>Full_Name: Dan B
> >> >>Version: R 2.0.0 (2004-10-04).
> >> >>OS: Fedora 2
> >> >>Submission from: (NULL) (80.6.127.185)
> >> >>
> >> >>
> >> >>The man page for barplot (?barplot) is confusing...
> >> >>
> >> >><quote>
> >> >>cex.axis: expansion factor for numeric axis labels.
> >> >>cex.names: expansion factor for axis names (bar labels).
> >> >></quote>
> >> >>
> >> >>What is an 'expansion factor', and what does it do in this context?
> >> >>
> >> >>
> >> >><quote>
> >> >>axis.lty: the graphics parameter 'lty' applied to the axis and tick
> >> >>           marks of the categorical (default horizontal) axis.  Note
> >> >>           that by default the axis is suppressed.
> >> >></quote>
> >> >>
> >> >>This makes no sense unless you know what it does already (which I
> >> don't). So
> >> >>this is more of a programmers cleft note in a 'common language' than a
> >> >>function
> >> >>documentation page.
> >> >>
> >> >><quote>
> >> >>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
> >> >></quote>
> >> >>
> >> >>Say what?
> >> >>
> >> >>______________________________________________
> >> >>R-devel@stat.math.ethz.ch mailing list
> >> >>https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >
> >

From dmb at mrc-dunn.cam.ac.uk  Tue Nov  2 18:00:50 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Tue Nov  2 18:00:58 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <6.1.0.6.2.20041102093945.0badf5b8@pop.1and1.com>
Message-ID: <Pine.LNX.4.21.0411021659090.6111-100000@mail.mrc-dunn.cam.ac.uk>


Would you mind telling me how to get at the documentation source code?

Is there a - how to change the documentation document? ( I will make one
if you give me some instructions....

I guess I can just edit a copy of the source and diff the original and
send the diff ?

Cheers,
Dan.


On Tue, 2 Nov 2004, Tony Plate wrote:

>I suspect that part of the reason for having terse documentation is that it 
>is easier to maintain when changes are made to the code.  Now that R is 
>more stable and mature maybe documentation could get a bit more expansive?
>
>I also suspect that you will have a better chance of getting improvements 
>into the documentation if you make specific suggestions about changes to 
>the source code of the documentation, i.e., including the exact proposed 
>wording and markup.  This will make it easy for someone with the necessary 
>permissions (a member of R-core, I guess) to make the changes.
>
>Tony Plate
>
>At Tuesday 09:25 AM 11/2/2004, Dan Bolser wrote:
>>On Tue, 2 Nov 2004, Tony Plate wrote:
>>
>> >Yup, I think you're right.  R is a volunteer project, so what needs to
>> >happen to improve the documentation is that some capable volunteers (or
>> >just one volunteer) step forward.   It is the prerogative of the members of
>> >R-core to decide whether to spend their time on improving documentation or
>> >improving the functionality (or merely having a life).
>>
>>I could try making better pages for the functions I use.
>>
>>
>> >However it is worth noting that R does have really quite good documentation
>> >for a piece of software of its kind, compared to both other open source and
>> >commercial software.
>>
>>That is very true. However, I still maintain that the emphasis is on
>>developers and not learners.
>>
>>
>> >What would need to be improved in the document "An Introduction to R",
>> >specifically, the subsubsection on "Graphical Elements" (under "Graphics
>> >Parameters List" in "Graphical Procedures", p 77 in my copy) in order that
>> >it would meet the criterion of being "less formal man pages"?  There's a
>>
>>Having it to hand when you need it (i.e. at the command line) like other
>>man style documentation systems. Also having reference to all the related
>>functions.
>>
>>My problem is this, my barplot has decided to use SI for big numbers. I
>>would rather it use the number in full... How do I do it? I don't know...
>>Some of my column labels are going missing... how do I fix it... I don't
>>know... My legend is in the top right when the top left would be much
>>better, how do I fix it...
>>
>>I read ?barplot, but I didn't *see* what I needed - I don't doubt that
>>someone who already knew how to do these things could look at ?barplot and
>>say that its fine. I can't say that.
>>
>>
>>
>> >lot to be said for having the "less formal" documentation being organized
>> >around concepts rather than specific functions (as the man pages are),
>> >because the conceptual organization allows more organized discussion of how
>> >functions work together and which are the appropriate functions to
>> >accomplish certain types of tasks.
>>
>>True, but that is a different task. A 'guide to use' is different from a
>>'user guide'. I find time and time again tiny problems (conceptually
>>trivial) which are very frustrating in R, I don't want to ask a question
>>on the list, I don't want to trawl the archives for the answer, I want a
>>clearer explanation of how the darn function works!
>>
>>I think having a concept based approach is essential (as you say), but the
>>'nuggets' should be posted around to the different functions, so each
>>concept for each function is indexed under that function for easy
>>retrieval (if that makes sense).
>>
>>
>> >Maybe inserting automatically generated "see also" references to "An
>> >Introduction to R" into the man pages would help beginners (and those who
>>
>>I think so.
>>
>> >have to deal with cleaning up bug reports that aren't really bugs)?
>>
>>Sorry, I made some comment about 'constantly wanted to improve the info
>>pages' on the mailing list, (with regards to a Wiki dump of the said pages
>>into the user domain). One reply said that instead I should request that
>>the documents be changed via a bug report from the R web site.
>>
>>I honestly want to give my time and energy to help users like me use R. I
>>very often find the man pages totally cryptic and often frustrating.
>>
>>Sometimes the examples read like entries from a Perl obfustication
>>competition - people taking delight in doing things as tersely as possible
>>to 'get kudos' from their 'knowledgeable' peers.
>>
>>The Perl documentation system is a joy to use. However, we shouldn't
>>compare apples and oranges...
>>
>>Thanks for your help, and sorry for the inconvenience. I am (still) only
>>trying to help :)
>>
>>All the best
>>Dan.
>>
>> >-- Tony Plate
>> >
>> >At Tuesday 12:52 AM 11/2/2004, Dan Bolser wrote:
>> >
>> >>Should these be in the (see also section)?
>> >>
>> >>Like I said, the pages read fine if you understand the content already. I
>> >>think some less formal man pages would drastically reduce the traffic on
>> >>the R mailing list.
>> >>
>> >>Just a hunch,
>> >>Dan.
>> >>
>> >>On Mon, 1 Nov 2004, Tony Plate wrote:
>> >>
>> >> >Look at the help page for "par" for explanations of "cex" and "lty".
>> >> >
>> >> >The use of 'mp' is as a variable, as in
>> >> >
>> >> > > mp <- barplot(....)
>> >> >
>> >> >The next paragraph refers to this variable.
>> >> >
>> >> >-- Tony Plate
>> >> >
>> >> >At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
>> >> >>Full_Name: Dan B
>> >> >>Version: R 2.0.0 (2004-10-04).
>> >> >>OS: Fedora 2
>> >> >>Submission from: (NULL) (80.6.127.185)
>> >> >>
>> >> >>
>> >> >>The man page for barplot (?barplot) is confusing...
>> >> >>
>> >> >><quote>
>> >> >>cex.axis: expansion factor for numeric axis labels.
>> >> >>cex.names: expansion factor for axis names (bar labels).
>> >> >></quote>
>> >> >>
>> >> >>What is an 'expansion factor', and what does it do in this context?
>> >> >>
>> >> >>
>> >> >><quote>
>> >> >>axis.lty: the graphics parameter 'lty' applied to the axis and tick
>> >> >>           marks of the categorical (default horizontal) axis.  Note
>> >> >>           that by default the axis is suppressed.
>> >> >></quote>
>> >> >>
>> >> >>This makes no sense unless you know what it does already (which I
>> >> don't). So
>> >> >>this is more of a programmers cleft note in a 'common language' than a
>> >> >>function
>> >> >>documentation page.
>> >> >>
>> >> >><quote>
>> >> >>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
>> >> >></quote>
>> >> >>
>> >> >>Say what?
>> >> >>
>> >> >>______________________________________________
>> >> >>R-devel@stat.math.ethz.ch mailing list
>> >> >>https://stat.ethz.ch/mailman/listinfo/r-devel
>> >> >
>> >
>

From tplate at acm.org  Tue Nov  2 18:42:56 2004
From: tplate at acm.org (Tony Plate)
Date: Tue Nov  2 18:43:32 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <Pine.LNX.4.21.0411021659090.6111-100000@mail.mrc-dunn.cam. ac.uk>
References: <6.1.0.6.2.20041102093945.0badf5b8@pop.1and1.com>
	<Pine.LNX.4.21.0411021659090.6111-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <6.1.0.6.2.20041102102954.0bb025c0@pop.1and1.com>

At Tuesday 10:00 AM 11/2/2004, Dan Bolser wrote:

>Would you mind telling me how to get at the documentation source code?

Download and unpack the source, then look for the appropriate .Rd 
file.  For example, in my copy of the source for R-1.9.1 (old, don't work 
with this!), I find C:\R\R-1.9.1\src\library\graphics\man\barplot.Rd  (If 
this is not the appropriate source file, someone please say so!)

>Is there a - how to change the documentation document? ( I will make one
>if you give me some instructions....

I don't think such a document exists, but I'm not the person to help with this.

>I guess I can just edit a copy of the source and diff the original and
>send the diff ?

Again, a member of R-core who might actually vet the changes and put them 
into the repository would be the appropriate one to comment on this.

Previous topics with the subject "Help Documentation" (which got filed with 
bug report numbers 6713, 6716, and 6717) also address this issue. (these 
appeared in March 2004).

-- Tony Plate

From ripley at stats.ox.ac.uk  Tue Nov  2 18:39:40 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov  2 18:43:43 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <Pine.LNX.4.44.0411021725420.31139-100000@gannet.stats>

There are books about R: have you tried reading a couple (or more)?
And what training have you had in technical communication (which includes 
honing your reading skills)?

In contrast, I find the Perl documentation very hard to use and
insufficiently precise, and would be surprised if many learners used it
before reading one of the Perl books.

Precision is a great virtue in written technical communication. Far more 
common a problem on R-help is a far too vague statement of the problem, or 
a user failing to read the documentation.

On Tue, 2 Nov 2004, Dan Bolser wrote:

> On Tue, 2 Nov 2004, Tony Plate wrote:
> 
> >Yup, I think you're right.  R is a volunteer project, so what needs to 
> >happen to improve the documentation is that some capable volunteers (or 
> >just one volunteer) step forward.   It is the prerogative of the members of 
> >R-core to decide whether to spend their time on improving documentation or 
> >improving the functionality (or merely having a life).
> 
> I could try making better pages for the functions I use.
> 
> 
> >However it is worth noting that R does have really quite good documentation 
> >for a piece of software of its kind, compared to both other open source and 
> >commercial software.
> 
> That is very true. However, I still maintain that the emphasis is on
> developers and not learners.
> 
> 
> >What would need to be improved in the document "An Introduction to R", 
> >specifically, the subsubsection on "Graphical Elements" (under "Graphics 
> >Parameters List" in "Graphical Procedures", p 77 in my copy) in order that 
> >it would meet the criterion of being "less formal man pages"?  There's a 
> 
> Having it to hand when you need it (i.e. at the command line) like other
> man style documentation systems. Also having reference to all the related
> functions. 
> 
> My problem is this, my barplot has decided to use SI for big numbers. I
> would rather it use the number in full... How do I do it? I don't know...
> Some of my column labels are going missing... how do I fix it... I don't
> know... My legend is in the top right when the top left would be much
> better, how do I fix it... 
> 
> I read ?barplot, but I didn't *see* what I needed - I don't doubt that
> someone who already knew how to do these things could look at ?barplot and
> say that its fine. I can't say that.
> 
> 
> 
> >lot to be said for having the "less formal" documentation being organized 
> >around concepts rather than specific functions (as the man pages are), 
> >because the conceptual organization allows more organized discussion of how 
> >functions work together and which are the appropriate functions to 
> >accomplish certain types of tasks.
> 
> True, but that is a different task. A 'guide to use' is different from a
> 'user guide'. I find time and time again tiny problems (conceptually
> trivial) which are very frustrating in R, I don't want to ask a question
> on the list, I don't want to trawl the archives for the answer, I want a
> clearer explanation of how the darn function works!
> 
> I think having a concept based approach is essential (as you say), but the
> 'nuggets' should be posted around to the different functions, so each
> concept for each function is indexed under that function for easy
> retrieval (if that makes sense).
> 
> 
> >Maybe inserting automatically generated "see also" references to "An 
> >Introduction to R" into the man pages would help beginners (and those who 
> 
> I think so. 
> 
> >have to deal with cleaning up bug reports that aren't really bugs)?
> 
> Sorry, I made some comment about 'constantly wanted to improve the info
> pages' on the mailing list, (with regards to a Wiki dump of the said pages
> into the user domain). One reply said that instead I should request that
> the documents be changed via a bug report from the R web site. 
> 
> I honestly want to give my time and energy to help users like me use R. I
> very often find the man pages totally cryptic and often frustrating.
> 
> Sometimes the examples read like entries from a Perl obfustication
> competition - people taking delight in doing things as tersely as possible
> to 'get kudos' from their 'knowledgeable' peers. 
> 
> The Perl documentation system is a joy to use. However, we shouldn't
> compare apples and oranges...
> 
> Thanks for your help, and sorry for the inconvenience. I am (still) only
> trying to help :)
> 
> All the best
> Dan.
> 
> >-- Tony Plate
> >
> >At Tuesday 12:52 AM 11/2/2004, Dan Bolser wrote:
> >
> >>Should these be in the (see also section)?
> >>
> >>Like I said, the pages read fine if you understand the content already. I
> >>think some less formal man pages would drastically reduce the traffic on
> >>the R mailing list.
> >>
> >>Just a hunch,
> >>Dan.
> >>
> >>On Mon, 1 Nov 2004, Tony Plate wrote:
> >>
> >> >Look at the help page for "par" for explanations of "cex" and "lty".
> >> >
> >> >The use of 'mp' is as a variable, as in
> >> >
> >> > > mp <- barplot(....)
> >> >
> >> >The next paragraph refers to this variable.
> >> >
> >> >-- Tony Plate
> >> >
> >> >At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
> >> >>Full_Name: Dan B
> >> >>Version: R 2.0.0 (2004-10-04).
> >> >>OS: Fedora 2
> >> >>Submission from: (NULL) (80.6.127.185)
> >> >>
> >> >>
> >> >>The man page for barplot (?barplot) is confusing...
> >> >>
> >> >><quote>
> >> >>cex.axis: expansion factor for numeric axis labels.
> >> >>cex.names: expansion factor for axis names (bar labels).
> >> >></quote>
> >> >>
> >> >>What is an 'expansion factor', and what does it do in this context?
> >> >>
> >> >>
> >> >><quote>
> >> >>axis.lty: the graphics parameter 'lty' applied to the axis and tick
> >> >>           marks of the categorical (default horizontal) axis.  Note
> >> >>           that by default the axis is suppressed.
> >> >></quote>
> >> >>
> >> >>This makes no sense unless you know what it does already (which I 
> >> don't). So
> >> >>this is more of a programmers cleft note in a 'common language' than a
> >> >>function
> >> >>documentation page.
> >> >>
> >> >><quote>
> >> >>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
> >> >></quote>
> >> >>
> >> >>Say what?
> >> >>
> >> >>______________________________________________
> >> >>R-devel@stat.math.ethz.ch mailing list
> >> >>https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >
> >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dmb at mrc-dunn.cam.ac.uk  Tue Nov  2 19:07:29 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Tue Nov  2 19:07:38 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <Pine.LNX.4.44.0411021725420.31139-100000@gannet.stats>
Message-ID: <Pine.LNX.4.21.0411021753050.6111-100000@mail.mrc-dunn.cam.ac.uk>

On Tue, 2 Nov 2004, Prof Brian Ripley wrote:

>There are books about R: have you tried reading a couple (or more)?

Not from cover to cover. 

I turn to use a function, I find a problem using that function, I look at
the online information for that function and I can't understand it ...
somthing is wrong.


>And what training have you had in technical communication (which includes 
>honing your reading skills)?

You should put that in a document called 'What you should know before
using R'...

I am a bad reader - sorry to admit that.


>In contrast, I find the Perl documentation very hard to use and
>insufficiently precise, and would be surprised if many learners used it
>before reading one of the Perl books.

Apples and oranges... Actually much of the perl books are dumped from the
online documentation system.


>Precision is a great virtue in written technical communication. Far more 
>common a problem on R-help is a far too vague statement of the problem, or 
>a user failing to read the documentation.

Why do so many people appear not to have read the docs? Just lazy people I
guess... Why not advertise courses in technical communication from the R
site?

I am sorry for going over the top. Your comments are quite reasonable,
however, I just think they are a little unreasonable. The vast majority of
the people just want to get going. They want to read about science, not
technical documents. They want to quickly test their ideas with
visualizations they can drop into papers and presentations (without
spending half a day on trying to work out how to format the graph or
manipulate the data).

R is very very very nice, I wouldn't be using it (and I certainly wouldn't
be 'wasting my time' complaining about it) if it wasn't. I just wish it
were easier learn how to use while actually using it.

>On Tue, 2 Nov 2004, Dan Bolser wrote:
>
>> On Tue, 2 Nov 2004, Tony Plate wrote:
>> 
>> >Yup, I think you're right.  R is a volunteer project, so what needs to 
>> >happen to improve the documentation is that some capable volunteers (or 
>> >just one volunteer) step forward.   It is the prerogative of the members of 
>> >R-core to decide whether to spend their time on improving documentation or 
>> >improving the functionality (or merely having a life).
>> 
>> I could try making better pages for the functions I use.
>> 
>> 
>> >However it is worth noting that R does have really quite good documentation 
>> >for a piece of software of its kind, compared to both other open source and 
>> >commercial software.
>> 
>> That is very true. However, I still maintain that the emphasis is on
>> developers and not learners.
>> 
>> 
>> >What would need to be improved in the document "An Introduction to R", 
>> >specifically, the subsubsection on "Graphical Elements" (under "Graphics 
>> >Parameters List" in "Graphical Procedures", p 77 in my copy) in order that 
>> >it would meet the criterion of being "less formal man pages"?  There's a 
>> 
>> Having it to hand when you need it (i.e. at the command line) like other
>> man style documentation systems. Also having reference to all the related
>> functions. 
>> 
>> My problem is this, my barplot has decided to use SI for big numbers. I
>> would rather it use the number in full... How do I do it? I don't know...
>> Some of my column labels are going missing... how do I fix it... I don't
>> know... My legend is in the top right when the top left would be much
>> better, how do I fix it... 
>> 
>> I read ?barplot, but I didn't *see* what I needed - I don't doubt that
>> someone who already knew how to do these things could look at ?barplot and
>> say that its fine. I can't say that.
>> 
>> 
>> 
>> >lot to be said for having the "less formal" documentation being organized 
>> >around concepts rather than specific functions (as the man pages are), 
>> >because the conceptual organization allows more organized discussion of how 
>> >functions work together and which are the appropriate functions to 
>> >accomplish certain types of tasks.
>> 
>> True, but that is a different task. A 'guide to use' is different from a
>> 'user guide'. I find time and time again tiny problems (conceptually
>> trivial) which are very frustrating in R, I don't want to ask a question
>> on the list, I don't want to trawl the archives for the answer, I want a
>> clearer explanation of how the darn function works!
>> 
>> I think having a concept based approach is essential (as you say), but the
>> 'nuggets' should be posted around to the different functions, so each
>> concept for each function is indexed under that function for easy
>> retrieval (if that makes sense).
>> 
>> 
>> >Maybe inserting automatically generated "see also" references to "An 
>> >Introduction to R" into the man pages would help beginners (and those who 
>> 
>> I think so. 
>> 
>> >have to deal with cleaning up bug reports that aren't really bugs)?
>> 
>> Sorry, I made some comment about 'constantly wanted to improve the info
>> pages' on the mailing list, (with regards to a Wiki dump of the said pages
>> into the user domain). One reply said that instead I should request that
>> the documents be changed via a bug report from the R web site. 
>> 
>> I honestly want to give my time and energy to help users like me use R. I
>> very often find the man pages totally cryptic and often frustrating.
>> 
>> Sometimes the examples read like entries from a Perl obfustication
>> competition - people taking delight in doing things as tersely as possible
>> to 'get kudos' from their 'knowledgeable' peers. 
>> 
>> The Perl documentation system is a joy to use. However, we shouldn't
>> compare apples and oranges...
>> 
>> Thanks for your help, and sorry for the inconvenience. I am (still) only
>> trying to help :)
>> 
>> All the best
>> Dan.
>> 
>> >-- Tony Plate
>> >
>> >At Tuesday 12:52 AM 11/2/2004, Dan Bolser wrote:
>> >
>> >>Should these be in the (see also section)?
>> >>
>> >>Like I said, the pages read fine if you understand the content already. I
>> >>think some less formal man pages would drastically reduce the traffic on
>> >>the R mailing list.
>> >>
>> >>Just a hunch,
>> >>Dan.
>> >>
>> >>On Mon, 1 Nov 2004, Tony Plate wrote:
>> >>
>> >> >Look at the help page for "par" for explanations of "cex" and "lty".
>> >> >
>> >> >The use of 'mp' is as a variable, as in
>> >> >
>> >> > > mp <- barplot(....)
>> >> >
>> >> >The next paragraph refers to this variable.
>> >> >
>> >> >-- Tony Plate
>> >> >
>> >> >At Monday 05:12 PM 11/1/2004, dan@bolser.co.uk wrote:
>> >> >>Full_Name: Dan B
>> >> >>Version: R 2.0.0 (2004-10-04).
>> >> >>OS: Fedora 2
>> >> >>Submission from: (NULL) (80.6.127.185)
>> >> >>
>> >> >>
>> >> >>The man page for barplot (?barplot) is confusing...
>> >> >>
>> >> >><quote>
>> >> >>cex.axis: expansion factor for numeric axis labels.
>> >> >>cex.names: expansion factor for axis names (bar labels).
>> >> >></quote>
>> >> >>
>> >> >>What is an 'expansion factor', and what does it do in this context?
>> >> >>
>> >> >>
>> >> >><quote>
>> >> >>axis.lty: the graphics parameter 'lty' applied to the axis and tick
>> >> >>           marks of the categorical (default horizontal) axis.  Note
>> >> >>           that by default the axis is suppressed.
>> >> >></quote>
>> >> >>
>> >> >>This makes no sense unless you know what it does already (which I 
>> >> don't). So
>> >> >>this is more of a programmers cleft note in a 'common language' than a
>> >> >>function
>> >> >>documentation page.
>> >> >>
>> >> >><quote>
>> >> >>say 'mp', giving the coordinates of _all_ the bar midpoints drawn,
>> >> >></quote>
>> >> >>
>> >> >>Say what?
>> >> >>
>> >> >>______________________________________________
>> >> >>R-devel@stat.math.ethz.ch mailing list
>> >> >>https://stat.ethz.ch/mailman/listinfo/r-devel
>> >> >
>> >
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>
>

From pburns at pburns.seanet.com  Tue Nov  2 20:05:19 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Tue Nov  2 20:08:58 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
References: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <4187DA6F.9020602@pburns.seanet.com>


Dan Bolser wrote:

>On Tue, 2 Nov 2004, Tony Plate wrote:
>
>  
>
>>Yup, I think you're right.  R is a volunteer project, so what needs to 
>>happen to improve the documentation is that some capable volunteers (or 
>>just one volunteer) step forward.   It is the prerogative of the members of 
>>R-core to decide whether to spend their time on improving documentation or 
>>improving the functionality (or merely having a life).
>>

I thought we had agreed that members of R-core are not allowed lives.

>>    
>>
>
>I could try making better pages for the functions I use.
>
>
>  
>
>>However it is worth noting that R does have really quite good documentation 
>>for a piece of software of its kind, compared to both other open source and 
>>commercial software.
>>    
>>
>
>That is very true. However, I still maintain that the emphasis is on
>developers and not learners.
>

[ ...]

As someone who has spent an inordinate amount of time writing and
revising help files, I can assure you that writing help files is about as
difficult of genre as exists.  There are numerous constraints which, taken
together,  yield  no  feasible  solution.

As you rightly maintain,  the  help file  should be  written  for people who
may not even know what the purpose of the function is, and for people
who are not native speakers of the language -- rather than just a mnemonic
for the author of the code.  On the other hand help files need to be short
because no one reads documentation, and no one squared reads long
documentation.

Things get even worse for graphics functions -- partly because they are so
complex, and partly because we subconsciously think they should be easy
because we are well tuned to interpreting the graphics themselves.

At heart it seems to me that you are asking for a new form of help file --
taking them from 2 dimensions to 3. For example, the "axis.lty" item in the
barplot help file would look similar "on the surface" to what it 
currently is
(though perhaps phrased better).  But there would be the ability to 
drill into
the item to learn about axes, line types and possibly other things.

To implement this vague idea, all that needs to be done is for someone to
come up with a workable system, and people to fill in the text.

The big problem that I see with documentation, which you also allude to, is
that the (confused and frustrated) user needs to seek out the appropriate
documentation when trouble happens.  Said confused and frustrated user
would rather the documentation came along by itself to say what went wrong.
I'm much more at a loss for this.

Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

>
>  
>

From dmb at mrc-dunn.cam.ac.uk  Tue Nov  2 20:48:33 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Tue Nov  2 20:49:36 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <4187DA6F.9020602@pburns.seanet.com>
Message-ID: <Pine.LNX.4.21.0411021933530.12340-100000@mail.mrc-dunn.cam.ac.uk>


Hey, 

Thanks very much for this information.

On Tue, 2 Nov 2004, Patrick Burns wrote:

>
>Dan Bolser wrote:
>
>>On Tue, 2 Nov 2004, Tony Plate wrote:
>>
>>  
>>
>>>Yup, I think you're right.  R is a volunteer project, so what needs to 
>>>happen to improve the documentation is that some capable volunteers (or 
>>>just one volunteer) step forward.   It is the prerogative of the members of 
>>>R-core to decide whether to spend their time on improving documentation or 
>>>improving the functionality (or merely having a life).
>>>
>
>I thought we had agreed that members of R-core are not allowed lives.

oops!

>>>    
>>>
>>
>>I could try making better pages for the functions I use.
>>
>>
>>  
>>
>>>However it is worth noting that R does have really quite good documentation 
>>>for a piece of software of its kind, compared to both other open source and 
>>>commercial software.
>>>    
>>>
>>
>>That is very true. However, I still maintain that the emphasis is on
>>developers and not learners.
>>
>
>[ ...]
>
>As someone who has spent an inordinate amount of time writing and
>revising help files, I can assure you that writing help files is about as
>difficult of genre as exists.  There are numerous constraints which, taken
>together,  yield  no  feasible  solution.

I can imagine its tough. I really like the perl model (sorry for brining
this up again) but there is a man page for each function, starting with an
overview (for quick reference) then simple description with some examples,
then a prolonged discussion.

There are several 'overviews' and tutorials in man page style with a
simple organization...

       Overview
           perl                Perl overview (this section)
           perlintro           Perl introduction for beginners

       Tutorials
           perlreftut          Perl references short introduction
           perldsc             Perl data structures intro
 
           perlrequick         Perl regular expressions quick start
 
           perlboot            Perl OO tutorial for beginners
           perlbot             Perl OO tricks and examples
           ...

And finally the package ships with the FAQ (which again has a man page
style serchable interface).


>As you rightly maintain,  the  help file  should be  written  for people who
>may not even know what the purpose of the function is, and for people
>who are not native speakers of the language -- rather than just a mnemonic
>for the author of the code.  On the other hand help files need to be short
>because no one reads documentation, and no one squared reads long
>documentation.

Yup, they should be as short as is necessary.


>Things get even worse for graphics functions -- partly because they are so
>complex, and partly because we subconsciously think they should be easy
>because we are well tuned to interpreting the graphics themselves.

I see what you mean.


>At heart it seems to me that you are asking for a new form of help file --
>taking them from 2 dimensions to 3. For example, the "axis.lty" item in the
>barplot help file would look similar "on the surface" to what it 
>currently is
>(though perhaps phrased better).  But there would be the ability to 
>drill into
>the item to learn about axes, line types and possibly other things.
>
>To implement this vague idea, all that needs to be done is for someone to
>come up with a workable system, and people to fill in the text.

Sounds good.


>The big problem that I see with documentation, which you also allude to, is
>that the (confused and frustrated) user needs to seek out the appropriate
>documentation when trouble happens.  Said confused and frustrated user
>would rather the documentation came along by itself to say what went wrong.
>I'm much more at a loss for this.

:) I is tough I agree. The user should at least know where to start
looking.. Perhaps the R startup text could include a 'where to look' link?


>Patrick Burns

Thanks very much for your insight. Should I try to change docs, or should
I do something different?


>Burns Statistics
>patrick@burns-stat.com
>+44 (0)20 8525 0696
>http://www.burns-stat.com
>(home of S Poetry and "A Guide for the Unwilling S User")
>
>>
>>  
>>
>
>

From andy_liaw at merck.com  Tue Nov  2 20:53:35 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue Nov  2 20:54:17 2004
Subject: [Rd] barplot manpage (PR#7331)
Message-ID: <3A822319EB35174CA3714066D590DCD50994E26F@usrymx25.merck.com>

> From: Tony Plate
> 
> At Tuesday 10:00 AM 11/2/2004, Dan Bolser wrote:
> 
> >Would you mind telling me how to get at the documentation 
> source code?
> 
> Download and unpack the source, then look for the appropriate .Rd 
> file.  For example, in my copy of the source for R-1.9.1 
> (old, don't work 
> with this!), I find 
> C:\R\R-1.9.1\src\library\graphics\man\barplot.Rd  (If 
> this is not the appropriate source file, someone please say so!)

Starting with R-2.0.0, the Windows binary installer has an option for
installing the Rd files for at least R itself (not sure about recommended
packages), I believe exactly for the purpose that users can submit suggested
patches.
 
> >Is there a - how to change the documentation document? ( I 
> will make one
> >if you give me some instructions....
> 
> I don't think such a document exists, but I'm not the person 
> to help with this.

The `Writing R Extensions' manual has a section on how to write the Rd file.
I'm not sure how one would write a document that describes how to change a
Rd file...
 
> >I guess I can just edit a copy of the source and diff the 
> original and
> >send the diff ?
> 
> Again, a member of R-core who might actually vet the changes 
> and put them 
> into the repository would be the appropriate one to comment on this.
> 
> Previous topics with the subject "Help Documentation" (which 
> got filed with 
> bug report numbers 6713, 6716, and 6717) also address this 
> issue. (these 
> appeared in March 2004).

When I find typos in the documentation, I just post them to R-devel.  R Core
has been very responsive to such posts.

Best,
Andy

 
> -- Tony Plate
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From andy_liaw at merck.com  Wed Nov  3 02:30:20 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Wed Nov  3 02:31:08 2004
Subject: [Rd] need help debugging on Windows
Message-ID: <3A822319EB35174CA3714066D590DCD50994E277@usrymx25.merck.com>

Thanks to Duncan and Brian for the pointers.  I was able to run gdb under
XP, but it didn't help much.  What eventually helped is valgrind (on Linux
on ia32)!  It indicated memory leaks, and here's how the leaks occurred:

The main C function called from R has a loop over trees, and calls a
function that grows regression trees.  That function, in turns, calls a
function that loop over variables and find the best one to split on.  I
Calloc()'ed arrays in the beginning of those functions and Free() them at
the end.  What I forgot is that there were conditional return in the middle
of those functions, bypassing the Free().

Best,
Andy

> From: Duncan Murdoch
> 
> On Mon, 25 Oct 2004 22:26:35 -0400, "Liaw, Andy" <andy_liaw@merck.com>
> wrote :
> 
> >Dear R-devel,
> >
> >Apologies for bothering y'all with this seemingly perennial 
> question.  A
> >user reported problem with my most recent version of 
> randomForest (4.4-1),
> >and I was able to reproduce it with his data with R-2.0.0 patched
> >(2004-10-24) on WinXP Pro.  The problem is that it crashes R 
> on Windows.
> >However, it does not happen on Linux (tried SUSE ES8 on our 
> Opterons and
> >Quantian on my laptop).  On Linux, the memory usage for the 
> R process goes
> >up to about 130MB and stays there.  On Windows, the memory 
> usage would
> >increase as the number of trees are grown (which already 
> seem strange, as no
> >more memory allocation is being done as the trees are 
> grown), reaches about
> >130MB, then starts to decline, and eventually crashes the 
> Rgui (or Rterm)
> >process.  
> >
> >My biggest problem is that I have not been able to get gdb 
> to work under
> >WinXPPro, thus I've been relying on Linux for debugging.  
> This time I'm
> >really baffled, as the problem does not appear on Linux.  
> Can anyone provide
> >any hint/pointer?  I (and my hair) will be very, very grateful!
> 
> No idea what's going wrong in randomForest, but I've got some hints
> for debugging on
> 
 http://www.stats.uwo.ca/faculty/murdoch/software/debuggingR

I've found both the MinGW and Cygwin versions of gdb work, and use it
under insight.  It's rather painful compared to other Windows
debuggers, but it does the job.  I've never been able to get ddd
going.

Duncan Murdoch

From dmb at mrc-dunn.cam.ac.uk  Wed Nov  3 15:55:55 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Wed Nov  3 15:56:02 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E26F@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.21.0411031454220.18231-100000@mail.mrc-dunn.cam.ac.uk>


Here is a change I made to the matrix.Rd file...

<     \code{list} of length 2 giving the row and column names
respectivly.}
---
>     \code{list} of length 2.}
65,75d64
<
< # Example of setting row and column names
< data <- matrix(c(16522,34057,40949,
<                  19924,46032,55185),
<                nrow=2, ncol=3,
<                byrow=TRUE,
<                dimnames = list(
<                  c('PDB','MSD'),
<                  c('Entry','Chain','Domain')
<                  )
<                )


I also tried to create some instructions here...

http://fawn.unibw-hamburg.de/cgi-bin/Rwiki.pl?HowTo

(which you must feel free to edit (you can delete it entirly if you
like!)).

All the best,
Dan.


On Tue, 2 Nov 2004, Liaw, Andy wrote:

>> From: Tony Plate
>> 
>> At Tuesday 10:00 AM 11/2/2004, Dan Bolser wrote:
>> 
>> >Would you mind telling me how to get at the documentation 
>> source code?
>> 
>> Download and unpack the source, then look for the appropriate .Rd 
>> file.  For example, in my copy of the source for R-1.9.1 
>> (old, don't work 
>> with this!), I find 
>> C:\R\R-1.9.1\src\library\graphics\man\barplot.Rd  (If 
>> this is not the appropriate source file, someone please say so!)
>
>Starting with R-2.0.0, the Windows binary installer has an option for
>installing the Rd files for at least R itself (not sure about recommended
>packages), I believe exactly for the purpose that users can submit suggested
>patches.
> 
>> >Is there a - how to change the documentation document? ( I 
>> will make one
>> >if you give me some instructions....
>> 
>> I don't think such a document exists, but I'm not the person 
>> to help with this.
>
>The `Writing R Extensions' manual has a section on how to write the Rd file.
>I'm not sure how one would write a document that describes how to change a
>Rd file...
> 
>> >I guess I can just edit a copy of the source and diff the 
>> original and
>> >send the diff ?
>> 
>> Again, a member of R-core who might actually vet the changes 
>> and put them 
>> into the repository would be the appropriate one to comment on this.
>> 
>> Previous topics with the subject "Help Documentation" (which 
>> got filed with 
>> bug report numbers 6713, 6716, and 6717) also address this 
>> issue. (these 
>> appeared in March 2004).
>
>When I find typos in the documentation, I just post them to R-devel.  R Core
>has been very responsive to such posts.
>
>Best,
>Andy
>
> 
>> -- Tony Plate
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>
>
>------------------------------------------------------------------------------
>Notice:  This e-mail message, together with any attachments, contains information of Merck & Co., Inc. (One Merck Drive, Whitehouse Station, New Jersey, USA 08889), and/or its affiliates (which may be known outside the United States as Merck Frosst, Merck Sharp & Dohme or MSD and in Japan, as Banyu) that may be confidential, proprietary copyrighted and/or legally privileged. It is intended solely for the use of the individual or entity named on this message.  If you are not the intended recipient, and have received this message in error, please notify us immediately by reply e-mail and then delete it from your system.
>------------------------------------------------------------------------------
>

From bnewquist at constellagroup.com  Wed Nov  3 16:16:50 2004
From: bnewquist at constellagroup.com (bnewquist@constellagroup.com)
Date: Wed Nov  3 16:16:53 2004
Subject: [Rd] Windows XP crashed upon use of "em" function in library
	"mclust" (PR#7337)
Message-ID: <20041103151650.0A16E10FA9@slim.kubism.ku.dk>

Full_Name: Brian Newquist
Version: 2.0.0
OS: Windows XP
Submission from: (NULL) (63.165.234.2)


Whenever I run the following statement using package "mclust" Windows XP
crashes.

> result <- em("E", m1, c(25,50), 10, c(0.49,0.51))

m1 is just an ordinary data vector (i.e. m1 <- c(24, 27, 51, 48, ...))

A dialogue box appears saying "R for Windows GUI front-end has encountered a
problem and needs to close.  We are sorry for the inconvenience."  This dialogue
box says Please tell Microsoft about this problem.  and asks if I would like to
send error report. 

Is there a reason for this?  Is there another function I could use to implement
the EM algorithm?

Thanks.

From ripley at stats.ox.ac.uk  Wed Nov  3 16:38:44 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed Nov  3 16:38:50 2004
Subject: [Rd] Windows XP crashed upon use of "em" function in library
	(PR#7338)
Message-ID: <20041103153844.EE15110FAC@slim.kubism.ku.dk>

Please do read the R FAQ, and report the bug to the package maintainer as
it asks.  It also asks you to send a reproducible example (to the
maintainer).

On Wed, 3 Nov 2004 bnewquist@constellagroup.com wrote:

> Full_Name: Brian Newquist
> Version: 2.0.0
> OS: Windows XP
> Submission from: (NULL) (63.165.234.2)
> 
> Whenever I run the following statement using package "mclust" Windows XP
> crashes.
> 
> > result <- em("E", m1, c(25,50), 10, c(0.49,0.51))
> 
> m1 is just an ordinary data vector (i.e. m1 <- c(24, 27, 51, 48, ...))
> 
> A dialogue box appears saying "R for Windows GUI front-end has encountered a
> problem and needs to close.  We are sorry for the inconvenience."  This dialogue
> box says Please tell Microsoft about this problem.  and asks if I would like to
> send error report. 
> 
> Is there a reason for this?  Is there another function I could use to implement
> the EM algorithm?
> 
> Thanks.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tplate at acm.org  Wed Nov  3 18:41:48 2004
From: tplate at acm.org (Tony Plate)
Date: Wed Nov  3 18:41:59 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <4187DA6F.9020602@pburns.seanet.com>
References: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
	<4187DA6F.9020602@pburns.seanet.com>
Message-ID: <6.1.0.6.2.20041102124129.0bb1de70@mailhost.blackmesacapital.com>

Patrick Burns' and Brian Ripley's general comments about the difficulty of 
writing good documentation are on the mark, but the specific case of the 
man page for "barplot" does seem amenable to at least some slight 
improvements, e.g.:

(1) Change "expansion factor" to "character scaling factor" or "character 
magnification" in the descriptions of 'cex.axis' and 'cex.names'

(The documentation for 'barplot' uses 'expansion factor', while the 
documentation for 'par' itself uses two other different terms 
'magnification' and 'scaling' to describe various 'cex' related 
arguments.  Both common sense (my own, at least) and guidelines I could 
find on the net suggest that it is better to consistently use a single term 
to refer to a single concept.)

(2) add "par" to the "see also" section

I looked in the "Writing R Extensions" manual, but could find no guidelines 
for the style of documentation.  I also looked on the web, and I was 
surprised at the difficultly of finding any guidelines for software user 
documentation or software requirements specification (the documentation for 
R function is like a combination of the two, as far as I can make out.)
Can anyone point to some guidelines that people who wish to improve R 
documentation might find useful?

-- Tony Plate

From pburns at pburns.seanet.com  Wed Nov  3 19:13:05 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Wed Nov  3 19:20:46 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <6.1.0.6.2.20041102124129.0bb1de70@mailhost.blackmesacapital.com>
References: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
	<4187DA6F.9020602@pburns.seanet.com>
	<6.1.0.6.2.20041102124129.0bb1de70@mailhost.blackmesacapital.com>
Message-ID: <41891FB1.2000305@pburns.seanet.com>


Tony Plate wrote:

> [...]
> Can anyone point to some guidelines that people who wish to improve R 
> documentation might find useful? 


There is a little bit in S Poetry starting on page 34. 

Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

From p.dalgaard at biostat.ku.dk  Wed Nov  3 20:06:27 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Nov  3 20:07:07 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <6.1.0.6.2.20041102124129.0bb1de70@mailhost.blackmesacapital.com>
References: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
	<4187DA6F.9020602@pburns.seanet.com>
	<6.1.0.6.2.20041102124129.0bb1de70@mailhost.blackmesacapital.com>
Message-ID: <x2lldi21n0.fsf@biostat.ku.dk>

Tony Plate <tplate@acm.org> writes:

> (1) Change "expansion factor" to "character scaling factor" or
> "character magnification" in the descriptions of 'cex.axis' and
> 'cex.names'

Now that's a really bad idea in my book... The "ex" in "cex" is
*ex*actly for *ex*pansion, also note the consistency with "mex". 
 
> (The documentation for 'barplot' uses 'expansion factor', while the
> documentation for 'par' itself uses two other different terms
> 'magnification' and 'scaling' to describe various 'cex' related
> arguments.  Both common sense (my own, at least) and guidelines I
> could find on the net suggest that it is better to consistently use a
> single term to refer to a single concept.)

Yup, but I think it is ?par that could use fixing. (The description of
"mex" in there is a bit iffy as well. Why mix character sizes into
something that really deals in interline distances?)

> (2) add "par" to the "see also" section

Obvious. In a bunch of other places too, I guess.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From tplate at acm.org  Wed Nov  3 20:52:30 2004
From: tplate at acm.org (Tony Plate)
Date: Wed Nov  3 20:52:45 2004
Subject: [Rd] barplot manpage (PR#7331)
In-Reply-To: <x2lldi21n0.fsf@biostat.ku.dk>
References: <Pine.LNX.4.21.0411021602000.6111-100000@mail.mrc-dunn.cam.ac.uk>
	<4187DA6F.9020602@pburns.seanet.com>
	<6.1.0.6.2.20041102124129.0bb1de70@mailhost.blackmesacapital.com>
	<x2lldi21n0.fsf@biostat.ku.dk>
Message-ID: <6.1.0.6.2.20041103122719.0bb8eb58@mailhost.blackmesacapital.com>

You're right: it's ?par that could use fixing (wrt to definitions of 
"cex"-related arguments).

This is also a good example of why making even small changes to 
documentation is fraught with difficulty.  I suspect that such discussions 
could be had about many "minor improvements".

-- Tony Plate


At Wednesday 12:06 PM 11/3/2004, Peter Dalgaard wrote:
>Tony Plate <tplate@acm.org> writes:
>
> > (1) Change "expansion factor" to "character scaling factor" or
> > "character magnification" in the descriptions of 'cex.axis' and
> > 'cex.names'
>
>Now that's a really bad idea in my book... The "ex" in "cex" is
>*ex*actly for *ex*pansion, also note the consistency with "mex".
>
> > (The documentation for 'barplot' uses 'expansion factor', while the
> > documentation for 'par' itself uses two other different terms
> > 'magnification' and 'scaling' to describe various 'cex' related
> > arguments.  Both common sense (my own, at least) and guidelines I
> > could find on the net suggest that it is better to consistently use a
> > single term to refer to a single concept.)
>
>Yup, but I think it is ?par that could use fixing. (The description of
>"mex" in there is a bit iffy as well. Why mix character sizes into
>something that really deals in interline distances?)
>
> > (2) add "par" to the "see also" section
>
>Obvious. In a bunch of other places too, I guess.
>
>--
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
>~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From techsupport.norway at pandasoftware.com  Wed Nov  3 22:49:55 2004
From: techsupport.norway at pandasoftware.com (techsupport.norway@pandasoftware.com)
Date: Wed Nov  3 22:50:01 2004
Subject: [Rd] [ #ISX-31608-443]: Re: website (PR#7339)
Message-ID: <20041103214955.945B710FAC@slim.kubism.ku.dk>

Dette er en automatisk svar-epost i fra Panda Software Norge - Support.

Din sak har f?tt nr: ISX-31608-443

Du vil motta svar p? denne epost adressen n?r vi har f?tt behandlet saken.

Henvis til nummeret ovenfor ved telefonhenvendelser.
Ved videre henvendelser om denne saken svarer du p? denne e-posten
eller sender en ny mail til help@pandasupport.no med: [ISX-31608-443] i subjekt/emne feltet.

----

This is an automatic response from Panda Software Norway.

Your case has been assigned the following number: ISX-31608-443

You will receive a reply to your question as soon as possible.

Further contact regarding this matter should be done by replying to the email(s) received from us, without changing the subject field.



-----------------------------------
Panda Software Norge - Support
-----------------------------------


help@pandasupport.no
tlf: 93 40 93 00

http://www.pandasoftware.no
http://www.pandasoftware.com

From p.dalgaard at biostat.ku.dk  Thu Nov  4 00:24:03 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Nov  4 00:24:40 2004
Subject: [Rd] 2.0.1 countdown
Message-ID: <x2hdo67bzg.fsf@biostat.ku.dk>


We plan to a patch release on Nov.15 to fix up various problems that
cropped up after the release of R 2.0.0. Daily beta snapshots will be
made available until the day of release. 

Please check if your favourite bugs have been fixed (but notice that
since we try hard to keep the patch versions stable, some items may
have to wait for the 2.1 release.)

Also, please help us with platform testing. The core team only has
access to a limited number of machines and our usage patterns tend to
differ from the ordinary. As a result, we often find issues reported
immediately after release, even on quite common platforms.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Chris.Walsh at sci.monash.edu.au  Thu Nov  4 01:17:40 2004
From: Chris.Walsh at sci.monash.edu.au (Chris Walsh)
Date: Thu Nov  4 01:21:00 2004
Subject: [Rd] requirements for a GPL
Message-ID: <41897524.5080506@sci.monash.edu.au>

Can I get some advice on what is required to claim a GPL for a package?

A package I maintain (pcurve) uses some S code from statlib.  I have an 
email from the author of the S code saying that he would be happy to 
issue a GPL for the code.  Is the email from the author enough, or do I 
need something more formal?

Chris

-- 
Chris Walsh
CRC for Freshwater Ecology
Water Studies Centre
PO Box 23 
Monash University 
Clayton 3800
AUSTRALIA

Ph  +61 3 9905 4091
Fax +61 3 9905 4196

e-mail Chris.Walsh@sci.monash.edu.au

From tlumley at u.washington.edu  Thu Nov  4 01:36:44 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Nov  4 01:36:53 2004
Subject: [Rd] requirements for a GPL
In-Reply-To: <41897524.5080506@sci.monash.edu.au>
References: <41897524.5080506@sci.monash.edu.au>
Message-ID: <Pine.A41.4.61b.0411031624400.364448@homer10.u.washington.edu>

On Thu, 4 Nov 2004, Chris Walsh wrote:

> Can I get some advice on what is required to claim a GPL for a package?
>
> A package I maintain (pcurve) uses some S code from statlib.  I have an email 
> from the author of the S code saying that he would be happy to issue a GPL 
> for the code.  Is the email from the author enough, or do I need something 
> more formal?

r-devel is not an ideal place to ask for this sort of advice, especially 
as the correct answer may be country-specific.  It's unlikely that many 
people on this list are experts in Australian IP law.

Formally, you almost certainly need the permission of the copyright 
holder, who may or may not be the author.  Assuming goodwill and no large 
sums of money at stake, permission from the author is probably pretty 
safe.  For example, the survival package was initially circulated with 
permission from the author, but now is GPL with permission from the Mayo 
Foundation for Medical Education and Research, who are the real copyright 
owners of Dr Therneau's code.


 	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From juan_sr at uol.com.br  Wed Nov  3 23:11:00 2004
From: juan_sr at uol.com.br (juan_sr@uol.com.br)
Date: Thu Nov  4 02:10:48 2004
Subject: [Rd] error in chron object library
Message-ID: <1099519859.2847.35.camel@localhost.localdomain>



Times series of rain and discharge in hydrologic - stations has above 95
years of daily records.
In the temporal series over "serie" dataframe, using chron's object:

> library(chron)                          # load chron library 

> length(serie$data)
[1] 27182

> serie$data[length(serie$data)]
[1] (85-12-31 00:00:00)                   # 1985-dez-31 00:00:00hs

> serie$data[1]
[1] (11-08-01 00:00:00)                   # 1911-aug-01 00:00:00hs

> serie$data[length(serie$data)] -serie$data[1]  # error, correct value
is: 27181

which are the solution?

Juan S. Ramseyer

From ligges at statistik.uni-dortmund.de  Thu Nov  4 11:43:31 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Nov  4 11:43:14 2004
Subject: [Rd] error in chron object library
In-Reply-To: <1099519859.2847.35.camel@localhost.localdomain>
References: <1099519859.2847.35.camel@localhost.localdomain>
Message-ID: <418A07D3.7090709@statistik.uni-dortmund.de>

juan_sr@uol.com.br wrote:

> 
> Times series of rain and discharge in hydrologic - stations has above 95
> years of daily records.
> In the temporal series over "serie" dataframe, using chron's object:
> 
> 
>>library(chron)                          # load chron library 
> 
> 
>>length(serie$data)
> 
> [1] 27182
> 
> 
>>serie$data[length(serie$data)]
> 
> [1] (85-12-31 00:00:00)                   # 1985-dez-31 00:00:00hs
> 
> 
>>serie$data[1]
> 
> [1] (11-08-01 00:00:00)                   # 1911-aug-01 00:00:00hs
> 
> 
>>serie$data[length(serie$data)] -serie$data[1]  # error, correct value
> 
> is: 27181

I guess you get something negative,because the year you have coded is 
2011 rather than 1911!
But I cannot be sure because you have not specified any reproducible 
example. Also, you have not said what the error message is. Which 
version of R, chron and the OS? Please read the posting guide!

Uwe Ligges



> 
> which are the solution?
> 
> Juan S. Ramseyer
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From juan_sr at uol.com.br  Thu Nov  4 09:14:30 2004
From: juan_sr at uol.com.br (juan_sr@uol.com.br)
Date: Thu Nov  4 12:14:23 2004
Subject: [Rd] error in chron object library
In-Reply-To: <418A07D3.7090709@statistik.uni-dortmund.de>
References: <1099519859.2847.35.camel@localhost.localdomain>
	<418A07D3.7090709@statistik.uni-dortmund.de>
Message-ID: <1099556070.2758.13.camel@localhost.localdomain>

> > I guess you get something negative,because the year you have coded is 
> > 2011 rather than 1911!
yes, you are correct!

I'm using a routine for file format transform

> output_file <- leSRHchron(input_file)

and other routine for save output_file, but, in the output_file, 
year is save in short format. 


thank you,

Juan.

Em Qui, 2004-11-04 ?s 10:43, Uwe Ligges escreveu:
> juan_sr@uol.com.br wrote:
> 
> > 
> > Times series of rain and discharge in hydrologic - stations has above 95
> > years of daily records.
> > In the temporal series over "serie" dataframe, using chron's object:
> > 
> > 
> >>library(chron)                          # load chron library 
> > 
> > 
> >>length(serie$data)
> > 
> > [1] 27182
> > 
> > 
> >>serie$data[length(serie$data)]
> > 
> > [1] (85-12-31 00:00:00)                   # 1985-dez-31 00:00:00hs
> > 
> > 
> >>serie$data[1]
> > 
> > [1] (11-08-01 00:00:00)                   # 1911-aug-01 00:00:00hs
> > 
> > 
> >>serie$data[length(serie$data)] -serie$data[1]  # error, correct value
> > 
> > is: 27181
> 
> I guess you get something negative,because the year you have coded is 
> 2011 rather than 1911!
> But I cannot be sure because you have not specified any reproducible 
> example. Also, you have not said what the error message is. Which 
> version of R, chron and the OS? Please read the posting guide!
> 
> Uwe Ligges
> 
> 
> 
> > 
> > which are the solution?
> > 
> > Juan S. Ramseyer
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ligges at statistik.uni-dortmund.de  Thu Nov  4 13:20:35 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Nov  4 13:20:19 2004
Subject: [Rd] error in chron object library
In-Reply-To: <1099556070.2758.13.camel@localhost.localdomain>
References: <1099519859.2847.35.camel@localhost.localdomain>	<418A07D3.7090709@statistik.uni-dortmund.de>
	<1099556070.2758.13.camel@localhost.localdomain>
Message-ID: <418A1E93.7060407@statistik.uni-dortmund.de>

juan_sr@uol.com.br wrote:

>>>I guess you get something negative,because the year you have coded is 
>>>2011 rather than 1911!
> 
> yes, you are correct!
> 
> I'm using a routine for file format transform
> 
> 
>>output_file <- leSRHchron(input_file)

So you know how to solve it now? If not, what is leSRHchron()???

Uwe Ligges



> 
> and other routine for save output_file, but, in the output_file, 
> year is save in short format. 
> 
> 
> thank you,
> 
> Juan.
> 
> Em Qui, 2004-11-04 ?s 10:43, Uwe Ligges escreveu:
> 
>>juan_sr@uol.com.br wrote:
>>
>>
>>>Times series of rain and discharge in hydrologic - stations has above 95
>>>years of daily records.
>>>In the temporal series over "serie" dataframe, using chron's object:
>>>
>>>
>>>
>>>>library(chron)                          # load chron library 
>>>
>>>
>>>>length(serie$data)
>>>
>>>[1] 27182
>>>
>>>
>>>
>>>>serie$data[length(serie$data)]
>>>
>>>[1] (85-12-31 00:00:00)                   # 1985-dez-31 00:00:00hs
>>>
>>>
>>>
>>>>serie$data[1]
>>>
>>>[1] (11-08-01 00:00:00)                   # 1911-aug-01 00:00:00hs
>>>
>>>
>>>
>>>>serie$data[length(serie$data)] -serie$data[1]  # error, correct value
>>>
>>>is: 27181
>>
>>I guess you get something negative,because the year you have coded is 
>>2011 rather than 1911!
>>But I cannot be sure because you have not specified any reproducible 
>>example. Also, you have not said what the error message is. Which 
>>version of R, chron and the OS? Please read the posting guide!
>>
>>Uwe Ligges
>>
>>
>>
>>
>>>which are the solution?
>>>
>>>Juan S. Ramseyer
>>>
>>>______________________________________________
>>>R-devel@stat.math.ethz.ch mailing list
>>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From thomas.ruf at vu-wien.ac.at  Thu Nov  4 14:37:33 2004
From: thomas.ruf at vu-wien.ac.at (Thomas Ruf)
Date: Thu Nov  4 14:38:00 2004
Subject: problem with tcltk under Windows (was [Rd] RE: [R] one
	more	Rcmdrproblem)
Message-ID: <418A309D.6020900@vu-wien.ac.at>

Dear all,
I'd like to use Rcmdr for teaching purposes but still have problems
trying to use it under Windows XP. Everything works fine up to several
minutes but then Rcmdr and R completely crash the second I hit a button
or key. This indeed looks like a problem with tcltk. It is not any
particular button or key that causes the crash, but using Ctrl+C to copy
something to the clipboard seem the most 'reliable' cause. I tried this
on 4 different PCs all under Windows XP (home or prof.), SP1. I did
download and reinstall R 2.0.0, RCmdr and required packages on Nov. 1,
2004, but that didn't help either. Are there any new insights into these 
problems?

Best regards,
Thomas

-- 
Thomas Ruf
Institute of Wildlife Ecology
University of Veterinary Medicine
Vienna, Austria
Tel.: *43 1 4890915 150
Fax:  *43 1 4890915 550
http://www.fiwi.at/

From ripley at stats.ox.ac.uk  Thu Nov  4 15:56:20 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Nov  4 15:56:23 2004
Subject: problem with tcltk under Windows (was [Rd] RE: [R] one more
	Rcmdrproblem)
In-Reply-To: <418A309D.6020900@vu-wien.ac.at>
Message-ID: <Pine.LNX.4.44.0411041453590.31970-100000@gannet.stats>

This is known and we believe already fixed, so please try a beta of 2.0.1, 
from

http://cran.r-project.org/bin/windows/base/rpatched.html

[BTW, the header is wrong, this is R-2.0.1 beta, not patch.]

Or just don't use Ctrl-C ....

On Thu, 4 Nov 2004, Thomas Ruf wrote:

> Dear all,
> I'd like to use Rcmdr for teaching purposes but still have problems
> trying to use it under Windows XP. Everything works fine up to several
> minutes but then Rcmdr and R completely crash the second I hit a button
> or key. This indeed looks like a problem with tcltk. It is not any
> particular button or key that causes the crash, but using Ctrl+C to copy
> something to the clipboard seem the most 'reliable' cause. I tried this
> on 4 different PCs all under Windows XP (home or prof.), SP1. I did
> download and reinstall R 2.0.0, RCmdr and required packages on Nov. 1,
> 2004, but that didn't help either. Are there any new insights into these 
> problems?
> 
> Best regards,
> Thomas
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dimitris.rizopoulos at med.kuleuven.ac.be  Thu Nov  4 16:36:29 2004
From: dimitris.rizopoulos at med.kuleuven.ac.be (dimitris.rizopoulos@med.kuleuven.ac.be)
Date: Thu Nov  4 16:36:36 2004
Subject: [Rd] "dlogis()" for large negative numbers (PR#7340)
Message-ID: <20041104153629.8C7E710FAA@slim.kubism.ku.dk>

Full_Name: Dimitris Rizopoulos
Version: 2.0.0
OS: Windows XP Pro.
Submission from: (NULL) (134.58.253.113)


> dlogis(-1e15)
[1] NaN
Warning message: 
NaNs produced in: dlogis(x, location, scale, log)

From p.dalgaard at biostat.ku.dk  Thu Nov  4 16:47:05 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Nov  4 16:47:50 2004
Subject: [Rd] 2.0.1 countdown
In-Reply-To: <1099582123.18254.7.camel@6-allhosts>
References: <x2hdo67bzg.fsf@biostat.ku.dk>
	<1099582123.18254.7.camel@6-allhosts>
Message-ID: <x2actx62h2.fsf@biostat.ku.dk>

"M. Edward Borasky" <znmeb@cesmail.net> writes:

[Cc-ing r-devel, hope you won't mind]

> 1. Should we download the "devel" or the "patched" tarballs?

The beta tarballs. Follow the link from the front page on CRAN. It
wasn't in place when I wrote the note, but now points to

http://cran.r-project.org/src/base-prerelease

The snapshot directory at

ftp://ftp.stat.math.ethz.ch/Software/R/

should also have them once a minor configuration wrinkle has been
ironed out. At that point we might want to get rid of the
base-prerelease directory.

> 2. Is there a Windows build of the "devel" or "patched" release
> available?

There might be, but Duncan Murdoch is master of that domain.

> 3. The only two "unusual" platforms I have access to are Athlon T-Bird
> and Athlon XP. I have a P3 as well, but that seems vanilla. All are
> running Gentoo Linux and the XP is also running Windows. On the Linux
> side, I run with Atlas 3.6.0.
> 
> I also have a P4 at work, running Windows XP and Gentoo Linux. And if I
> beg the right folks, I can get a Tru64 4.0f system, although that will
> need to be done off-hours, since there aren't any "living" projects tied
> to it.

"Usual" platforms break too, but of course there's a limit to how
often you want to exercise basically equivalent features of
essentially the same systems.

        -pd

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Thu Nov  4 18:55:43 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov  4 18:55:57 2004
Subject: [Rd] 2.0.1 countdown
References: <x2hdo67bzg.fsf@biostat.ku.dk>
Message-ID: <loom.20041104T184310-147@post.gmane.org>

Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:

: We plan to a patch release on Nov.15 to fix up various problems that
: cropped up after the release of R 2.0.0. Daily beta snapshots will be
: made available until the day of release. 
: 
: Please check if your favourite bugs have been fixed (but notice that

How does one easily find out if one's favorite bugs have been fixed?
Does the CHANGES file list them all or is there a more authoritative 
source?  I was specifically interested in the bug report and posting
I submitted regarding NextMethod.

From dan at bolser.co.uk  Thu Nov  4 19:08:08 2004
From: dan at bolser.co.uk (dan@bolser.co.uk)
Date: Thu Nov  4 19:08:13 2004
Subject: [Rd] Bug report (PR#7341)
Message-ID: <20041104180808.174B110F56@slim.kubism.ku.dk>

Full_Name: Dan B
Version: na
OS: na
Submission from: (NULL) (80.6.127.185)


I can't log into the bug tracker (I can't find where to register / login).


In this way I can't add the following context diff (hopefully in the right
order) for my changes to the matrix.Rd...

Hmm... I guess this should be a separate report anyway...

The first diff explains how the dimnames list should work, and the second diff
gives an example of using the dimnames list. (no equivelent example exists, and
where better than the matrix man page to show this off).

*** ./matrix.Rd 2004-11-03 14:44:13.000000000 +0000
--- Original/matrix.Rd  2004-11-03 14:48:40.000000000 +0000
***************
*** 28,32 ****
      filled by rows.}
    \item{dimnames}{A \code{\link{dimnames}} attribute for the matrix: a
!     \code{list} of length 2.}
    \item{x}{an \R object.}
  }
--- 28,32 ----
      filled by rows.}
    \item{dimnames}{A \code{\link{dimnames}} attribute for the matrix: a
!     \code{list} of length 2 giving the row and column names respectivly.}
    \item{x}{an \R object.}
  }
***************
*** 63,66 ****
--- 63,77 ----
  warpbreaks[1:10,]
  as.matrix(warpbreaks[1:10,]) #using as.matrix.data.frame(.) method
+
+ # Example of setting row and column names
+ data <- matrix(c(16522,34057,40949,
+                  19924,46032,55185),
+                nrow=2, ncol=3,
+                byrow=TRUE,
+                dimnames = list(
+                  c('PDB','MSD'),
+                  c('Entry','Chain','Domain')
+                  )
+                )
  }
  \keyword{array}

From ligges at statistik.uni-dortmund.de  Thu Nov  4 19:08:35 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Nov  4 19:08:15 2004
Subject: [Rd] 2.0.1 countdown
In-Reply-To: <loom.20041104T184310-147@post.gmane.org>
References: <x2hdo67bzg.fsf@biostat.ku.dk>
	<loom.20041104T184310-147@post.gmane.org>
Message-ID: <418A7023.7020902@statistik.uni-dortmund.de>

Gabor Grothendieck wrote:

> Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:
> 
> : We plan to a patch release on Nov.15 to fix up various problems that
> : cropped up after the release of R 2.0.0. Daily beta snapshots will be
> : made available until the day of release. 
> : 
> : Please check if your favourite bugs have been fixed (but notice that
> 
> How does one easily find out if one's favorite bugs have been fixed?
> Does the CHANGES file list them all or is there a more authoritative 
> source?  I was specifically interested in the bug report and posting
> I submitted regarding NextMethod.

Beside the CAHANGES file, there are the svn logs, but what you (all) 
really should do is to try out R-patched!

Uwe Ligges


> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From mpiktas at gmail.com  Thu Nov  4 19:10:55 2004
From: mpiktas at gmail.com (Vaidotas Zemlys)
Date: Thu Nov  4 19:11:05 2004
Subject: [Rd] mime type for R scripts
Message-ID: <e47808320411041010541930c8@mail.gmail.com>

Hi,

I use Gnome on my computer and sometimes I use its default text editor
gedit. It uses gtksourceview library for syntax highlighting. I
decided that it would be nice if gedit supported R syntax. So I
created apropriate .lang file:
http://bugzilla.gnome.org/show_bug.cgi?id=157370

Gedit picks apropriate lang file according to file mimetype, so I
created apropriate mime type for files with extension .R. I filed a bug
report at freedesktop.org:
https://freedesktop.org/bugzilla/show_bug.cgi?id=1782

There Christophe Fergeau suggested that maybe R could take care of
installing this mime type by itself. So my question would be could R
do this?

Feel free to make any suggestions concerning mime type, or syntax
highlighting file.

Vaidotas Zemlys

From tlumley at u.washington.edu  Thu Nov  4 19:35:27 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Nov  4 19:35:33 2004
Subject: [Rd] 2.0.1 countdown
In-Reply-To: <loom.20041104T184310-147@post.gmane.org>
References: <x2hdo67bzg.fsf@biostat.ku.dk>
	<loom.20041104T184310-147@post.gmane.org>
Message-ID: <Pine.A41.4.61b.0411041032580.18438@homer03.u.washington.edu>

On Thu, 4 Nov 2004, Gabor Grothendieck wrote:
>
> How does one easily find out if one's favorite bugs have been fixed?
> Does the CHANGES file list them all or is there a more authoritative
> source?

A bug that was fixed because it was reported should be listed with its PR# 
in the NEWS file.

If a change made to fix some other bug also fixed your bug there may not 
be an explicit note in the file. (or if someone forgot to put in a NEWS 
entry, which does happen from time to time).

 	-thomas

From pgilbert at bank-banque-canada.ca  Thu Nov  4 21:46:10 2004
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu Nov  4 21:48:02 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <Pine.A41.4.61b.0411041032580.18438@homer03.u.washington.edu>
References: <x2hdo67bzg.fsf@biostat.ku.dk>	<loom.20041104T184310-147@post.gmane.org>
	<Pine.A41.4.61b.0411041032580.18438@homer03.u.washington.edu>
Message-ID: <418A9512.7050102@bank-banque-canada.ca>

With R-2.0.1 (patched)  on Linux rhlinux 2.4.21-4.ELsmp

when I configure get
...
checking whether C runtime needs -D__NO_MATH_INLINES... no
checking for xmkmf... /usr/bin/X11/xmkmf
Usage: which [options] [--] programname [...]
Options: --version, -[vV] Print version and exit successfully.
         --help,          Print this help and exit successfully.
         --skip-dot       Skip directories in PATH that start with a dot.
...

but everything seems to configure and make ok. Should this message be 
expect or is this a bug?

 Also, I think "R CMD config --version" still has a bug, or a least it 
does not report what I would expect:

~/toolchain/R/src/R-beta:bin/R CMD config --version
R configuration information retrieval script 1.3

Copyright (C) 2002 The R Core Development Team.
This is free software; see the GNU General Public Licence version 2
or later for copying conditions.  There is NO warranty.


Paul Gilbert

From jfox at mcmaster.ca  Thu Nov  4 22:12:30 2004
From: jfox at mcmaster.ca (John Fox)
Date: Thu Nov  4 22:12:45 2004
Subject: problem with tcltk under Windows (was [Rd] RE: [R]
	onemore	Rcmdrproblem)
In-Reply-To: <418A309D.6020900@vu-wien.ac.at>
Message-ID: <20041104211229.NBPU29162.tomts5-srv.bellnexxia.net@JohnDesktop8300>

Dear Thomas,

Brian Ripley has already mentioned that Windows/tcltk problems have been
fixed in R 2.0.1 beta. I'll provide some background.

In addition to the control-key problems with R 2.0.0, I and my students have
been experiencing a number of Windows instability problems running the Rcmdr
this fall. The version of R that my students have is 1.9.1 patched, and the
same version is installed in the university computer labs. I found that with
this version and R 2.0.0 (under Windows 2000 and XP), running the Rcmdr
under rterm.exe rather than under rgui.exe seems to provide much better
stability. This is a reasonable solution for me since my intro stats
students interact with R only through the Rcmdr GUI. 

I'm hopeful that tcltk will run more stably on Windows under R 2.0.1 with
the console provided by rgui.exe.

Regards,
 John

--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario
Canada L8S 4M4
905-525-9140x23604
http://socserv.mcmaster.ca/jfox 
-------------------------------- 

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Thomas Ruf
> Sent: Thursday, November 04, 2004 8:38 AM
> To: r-devel@stat.math.ethz.ch
> Subject: problem with tcltk under Windows (was [Rd] RE: [R] 
> onemore Rcmdrproblem)
> 
> Dear all,
> I'd like to use Rcmdr for teaching purposes but still have 
> problems trying to use it under Windows XP. Everything works 
> fine up to several minutes but then Rcmdr and R completely 
> crash the second I hit a button or key. This indeed looks 
> like a problem with tcltk. It is not any particular button or 
> key that causes the crash, but using Ctrl+C to copy something 
> to the clipboard seem the most 'reliable' cause. I tried this 
> on 4 different PCs all under Windows XP (home or prof.), SP1. 
> I did download and reinstall R 2.0.0, RCmdr and required 
> packages on Nov. 1, 2004, but that didn't help either. Are 
> there any new insights into these problems?
> 
> Best regards,
> Thomas
> 
> --
> Thomas Ruf
> Institute of Wildlife Ecology
> University of Veterinary Medicine
> Vienna, Austria
> Tel.: *43 1 4890915 150
> Fax:  *43 1 4890915 550
> http://www.fiwi.at/
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Thu Nov  4 22:20:02 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Nov  4 22:20:10 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <418A9512.7050102@bank-banque-canada.ca>
Message-ID: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>

On Thu, 4 Nov 2004, Paul Gilbert wrote:

> With R-2.0.1 (patched)  on Linux rhlinux 2.4.21-4.ELsmp
> 
> when I configure get
> ...
> checking whether C runtime needs -D__NO_MATH_INLINES... no
> checking for xmkmf... /usr/bin/X11/xmkmf
> Usage: which [options] [--] programname [...]
> Options: --version, -[vV] Print version and exit successfully.
>          --help,          Print this help and exit successfully.
>          --skip-dot       Skip directories in PATH that start with a dot.
> ...
> 
> but everything seems to configure and make ok. Should this message be 
> expect or is this a bug?

It is unexpected.  Is it new in 2.0.1 beta?  You have told us your kernel,
not your distro.  This looks like a bug, but not in R.

>  Also, I think "R CMD config --version" still has a bug, or a least it 
> does not report what I would expect:
> 
> ~/toolchain/R/src/R-beta:bin/R CMD config --version
> R configuration information retrieval script 1.3
> 
> Copyright (C) 2002 The R Core Development Team.
> This is free software; see the GNU General Public Licence version 2
> or later for copying conditions.  There is NO warranty.

It's what it is documented to do:

gannet% R CMD config --help
Usage: R CMD config [options] [VAR]

Get the value of a basic R configure variable VAR which must be among
those listed in the 'Variables' section below, or the header and
library flags necessary for linking against R.

Options:
  -h, --help            print short help message and exit
  -v, --version         print version info and exit
...

All the 'R CMD foo' tools do that.

If you want the R version, that is 'R --version'.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Thu Nov  4 23:17:45 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Nov  4 23:18:30 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
References: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
Message-ID: <x28y9h5kdy.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> On Thu, 4 Nov 2004, Paul Gilbert wrote:
> 
> > With R-2.0.1 (patched)  on Linux rhlinux 2.4.21-4.ELsmp
> > 
> > when I configure get
> > ...
> > checking whether C runtime needs -D__NO_MATH_INLINES... no
> > checking for xmkmf... /usr/bin/X11/xmkmf
> > Usage: which [options] [--] programname [...]
> > Options: --version, -[vV] Print version and exit successfully.
> >          --help,          Print this help and exit successfully.
> >          --skip-dot       Skip directories in PATH that start with a dot.
> > ...
> > 
> > but everything seems to configure and make ok. Should this message be 
> > expect or is this a bug?
> 
> It is unexpected.  Is it new in 2.0.1 beta?  You have told us your kernel,
> not your distro.  This looks like a bug, but not in R.

I've seen it whizz by occasionally but never got around to
investigate. As said, it doesn't actually affect the result of
configure.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Thu Nov  4 23:34:52 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Nov  4 23:35:35 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <x28y9h5kdy.fsf@biostat.ku.dk>
References: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
	<x28y9h5kdy.fsf@biostat.ku.dk>
Message-ID: <x24qk55jlf.fsf@biostat.ku.dk>

Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:

> > > but everything seems to configure and make ok. Should this message be 
> > > expect or is this a bug?
> > 
> > It is unexpected.  Is it new in 2.0.1 beta?  You have told us your kernel,
> > not your distro.  This looks like a bug, but not in R.
> 
> I've seen it whizz by occasionally but never got around to
> investigate. As said, it doesn't actually affect the result of
> configure.

I can't seem to reproduce this exactly, but on Solaris I have

checking for xmkmf... /usr/X/bin/xmkmf
/home/bs/sfesys/sysadm/export/common.alias: No such file or directory
/home/bs/sfesys/sysadm/export/common.alias: No such file or directory
/home/bs/sfesys/sysadm/export/common.alias: No such file or directory
/home/bs/sfesys/sysadm/export/common.alias: No such file or directory

This was with the 2.0.0 sources, so it isn't new. The culprit appears
to be constructions like

  if test "`which ${cc}`" = "`which ${CC}`"; then
    shlib_ldflags=`${srcdir}/tools/GETMAKEVAL SHLIBLDFLAGS`
    cpicflags=`${srcdir}/tools/GETMAKEVAL PICFLAGS`
  fi

in configure.ac.  I guess we shouldn't really use "which" at all...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From kjetil at acelerate.com  Fri Nov  5 00:33:20 2004
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Fri Nov  5 01:00:12 2004
Subject: problem with tcltk under Windows (was [Rd] RE: [R] one
	more	Rcmdrproblem)
In-Reply-To: <Pine.LNX.4.44.0411041453590.31970-100000@gannet.stats>
References: <Pine.LNX.4.44.0411041453590.31970-100000@gannet.stats>
Message-ID: <418ABC40.6050800@acelerate.com>

Prof Brian Ripley wrote:

>This is known and we believe already fixed, so please try a beta of 2.0.1, 
>from
>
>http://cran.r-project.org/bin/windows/base/rpatched.html
>
>[BTW, the header is wrong, this is R-2.0.1 beta, not patch.]
>
>Or just don't use Ctrl-C ....
>  
>
That's not likely to succeed in classes ....

Kjetil

>On Thu, 4 Nov 2004, Thomas Ruf wrote:
>
>  
>
>>Dear all,
>>I'd like to use Rcmdr for teaching purposes but still have problems
>>trying to use it under Windows XP. Everything works fine up to several
>>minutes but then Rcmdr and R completely crash the second I hit a button
>>or key. This indeed looks like a problem with tcltk. It is not any
>>particular button or key that causes the crash, but using Ctrl+C to copy
>>something to the clipboard seem the most 'reliable' cause. I tried this
>>on 4 different PCs all under Windows XP (home or prof.), SP1. I did
>>download and reinstall R 2.0.0, RCmdr and required packages on Nov. 1,
>>2004, but that didn't help either. Are there any new insights into these 
>>problems?
>>
>>Best regards,
>>Thomas
>>
>>
>>    
>>
>
>  
>


-- 

Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra

From pgilbert at bank-banque-canada.ca  Fri Nov  5 02:26:04 2004
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Nov  5 02:27:15 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
References: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
Message-ID: <418AD6AC.5040701@bankofcanada.ca>

Prof Brian Ripley wrote:

>On Thu, 4 Nov 2004, Paul Gilbert wrote:
>
>  
>
>>With R-2.0.1 (patched)  on Linux rhlinux 2.4.21-4.ELsmp
>>
>>when I configure get
>>...
>>checking whether C runtime needs -D__NO_MATH_INLINES... no
>>checking for xmkmf... /usr/bin/X11/xmkmf
>>Usage: which [options] [--] programname [...]
>>Options: --version, -[vV] Print version and exit successfully.
>>         --help,          Print this help and exit successfully.
>>         --skip-dot       Skip directories in PATH that start with a dot.
>>...
>>
>>but everything seems to configure and make ok. Should this message be 
>>expect or is this a bug?
>>    
>>
>
>It is unexpected.  Is it new in 2.0.1 beta?  You have told us your kernel,
>not your distro.  This looks like a bug, but not in R.
>  
>
The distro was
Red Hat Enterprise Linux ES release 3 (Taroon)
Kernel 2.4.21-4.ELsmp on an i686

It also happens in
 SuSE SLES 8 (powered by UnitedLinux 1.0) (i586)\nKernel 2.4.19-64GB-SMP 
(6).

It is not new, it also happened in 2.0.0

>> Also, I think "R CMD config --version" still has a bug, or a least it 
>>does not report what I would expect:
>>    
>>
...

>It's what it is documented to do:
>...
>  -v, --version         print version info and exit
>  
>
Ok, it could be clearer (at least to me) that this means version of the 
script.

>If you want the R version, that is 'R --version'.
>  
>
I've been using this, but to make it into a file name I need to do some 
stripping out of the extra stuff. (And tail and head on Solaris do not 
use -n whereas Linux wants this, so it becomes difficult to be 
portable.) Is there a way to get just "R-2.0.1"  from R or R CMD something?

Thanks,
Paul

From christianlederer at t-online.de  Fri Nov  5 04:55:24 2004
From: christianlederer at t-online.de (christianlederer@t-online.de)
Date: Fri Nov  5 04:55:28 2004
Subject: [Rd] covariance bug (PR#7342)
Message-ID: <20041105035524.BD85210FA8@slim.kubism.ku.dk>

Full_Name: Christian Lederer
Version: 1.8.0
OS: Linux
Submission from: (NULL) (217.229.7.13)


R-1.8.0 seems to calculate wrong covariances, when the argument of cov() 
is a matrix or a data frame.
The following should produce a matrix of zeroes and NaNs:

x <- matrix(c(NA ,NA ,0.9068995 ,NA ,-0.3116229,
              -0.06011117 ,0.7310134 ,NA ,1.738362 ,0.6276125,
              0.6615581 ,NA ,NA ,-2.646011 ,-2.126105,
              NA ,1.081825 ,NA ,1.253795 ,1.520708,
              0.2822814 ,NA ,NA ,NA ,NA,
              0.03291028 ,NA ,NA ,NA ,NA,
              NA ,NA ,NA ,-0.5462126 ,-0.1997394,
              NA ,-0.3419413 ,-0.2675226 ,-1.000133 ,-0.1346234,
              NA ,NA ,-0.411743 ,1.301612 ,NA,
              0.922197 ,NA ,0.9513522 ,0.2357021 ,NA),
            nrow=10, ncol=5)

c1 <- cov(x, use="pairwise.complete")

c2 <- matrix(nrow=5, ncol=5)
for (i in 1:5) 
{
    for (j in 1:5) 
    {
        c2[i,j] <- cov(x[,i], x[,j], use="pairwise.complete")
    }
}

c2-c1

Instead, R-1.8.0 produces this result:

            [,1]        [,2]       [,3]          [,4]        [,5]
[1,]  0.00000000 -0.03053828         NA -0.0144996353 -0.03485883
[2,] -0.03053828 -0.01649857         NA  0.0137259383 -0.02960707
[3,]          NA          NA -0.1296134            NA          NA
[4,] -0.01449964  0.01372594         NA -0.0003152629  0.08717648
[5,] -0.03485883 -0.02960707         NA  0.0871764791  0.04961190

This happens as well under Linux (Suse 9.1) as well as under Windows NT.

Under 1.9.1 (Linux) and 1.9.0 (Windows) i get the expected matrix of
zeroes and NaNs.

This example is not very special. Under R-1.8.0 cov produced wrong result
for any random matrix i tried.

Doesn't this mean, that *any* result obtained under R 1.8.0 is unreliable?

By the way, i just recompiled R-1.8.0 from source under Linux and tried
'make check'. All tests were ok.
Does there exist a more detailed set of tests, which could insure that
at least the most basic R functions work correctly?

Christian

From ripley at stats.ox.ac.uk  Fri Nov  5 06:57:56 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Nov  5 06:58:02 2004
Subject: [Rd] covariance bug (PR#7342)
In-Reply-To: <20041105035524.BD85210FA8@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0411050549130.10397-100000@gannet.stats>

Please do read the posting guide and the FAQ.  E.g. the posting guide says

  Common posting mistakes:
  ...
  Finding a bug in an old version of R that has been fixed in the most 
  recent version.

This was a bug in 1.8.0, but the current version of R is 2.0.0 with 2.0.1 
in beta test.  We can't fix bugs retrospectively.

If you take a look at the `bugs fixed' lists since 1.8.0 you will think
you were remiss not to have upgrade a long time ago.

On Fri, 5 Nov 2004 christianlederer@t-online.de wrote:

> Full_Name: Christian Lederer
> Version: 1.8.0
> OS: Linux
> Submission from: (NULL) (217.229.7.13)
> 
> 
> R-1.8.0 seems to calculate wrong covariances, when the argument of cov() 
> is a matrix or a data frame.
> The following should produce a matrix of zeroes and NaNs:

Actually of zeroes and NAs, and it does in current R.

> x <- matrix(c(NA ,NA ,0.9068995 ,NA ,-0.3116229,
>               -0.06011117 ,0.7310134 ,NA ,1.738362 ,0.6276125,
>               0.6615581 ,NA ,NA ,-2.646011 ,-2.126105,
>               NA ,1.081825 ,NA ,1.253795 ,1.520708,
>               0.2822814 ,NA ,NA ,NA ,NA,
>               0.03291028 ,NA ,NA ,NA ,NA,
>               NA ,NA ,NA ,-0.5462126 ,-0.1997394,
>               NA ,-0.3419413 ,-0.2675226 ,-1.000133 ,-0.1346234,
>               NA ,NA ,-0.411743 ,1.301612 ,NA,
>               0.922197 ,NA ,0.9513522 ,0.2357021 ,NA),
>             nrow=10, ncol=5)
> 
> c1 <- cov(x, use="pairwise.complete")
> 
> c2 <- matrix(nrow=5, ncol=5)
> for (i in 1:5) 
> {
>     for (j in 1:5) 
>     {
>         c2[i,j] <- cov(x[,i], x[,j], use="pairwise.complete")
>     }
> }
> 
> c2-c1
> 
> Instead, R-1.8.0 produces this result:
> 
>             [,1]        [,2]       [,3]          [,4]        [,5]
> [1,]  0.00000000 -0.03053828         NA -0.0144996353 -0.03485883
> [2,] -0.03053828 -0.01649857         NA  0.0137259383 -0.02960707
> [3,]          NA          NA -0.1296134            NA          NA
> [4,] -0.01449964  0.01372594         NA -0.0003152629  0.08717648
> [5,] -0.03485883 -0.02960707         NA  0.0871764791  0.04961190
> 
> This happens as well under Linux (Suse 9.1) as well as under Windows NT.
> 
> Under 1.9.1 (Linux) and 1.9.0 (Windows) i get the expected matrix of
> zeroes and NaNs.
> 
> This example is not very special. Under R-1.8.0 cov produced wrong result
> for any random matrix i tried.
> 
> Doesn't this mean, that *any* result obtained under R 1.8.0 is unreliable?

>From cov(x, use="pairwise.complete"), yes.  But that is a very unusual 
usage.

> By the way, i just recompiled R-1.8.0 from source under Linux and tried
> 'make check'. All tests were ok.
> Does there exist a more detailed set of tests, which could insure that
> at least the most basic R functions work correctly?

This is not a `most basic R function'.  Look in the test directory in the 
sources to see that we do have an extensive series of tests.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Kurt.Hornik at wu-wien.ac.at  Fri Nov  5 08:53:59 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Nov  5 08:54:17 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <x24qk55jlf.fsf@biostat.ku.dk>
References: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
	<x28y9h5kdy.fsf@biostat.ku.dk> <x24qk55jlf.fsf@biostat.ku.dk>
Message-ID: <16779.12695.207382.732792@mithrandir.hornik.net>

>>>>> Peter Dalgaard writes:

> Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:
>> > > but everything seems to configure and make ok. Should this message be 
>> > > expect or is this a bug?
>> > 
>> > It is unexpected.  Is it new in 2.0.1 beta?  You have told us your kernel,
>> > not your distro.  This looks like a bug, but not in R.
>> 
>> I've seen it whizz by occasionally but never got around to
>> investigate. As said, it doesn't actually affect the result of
>> configure.

> I can't seem to reproduce this exactly, but on Solaris I have

> checking for xmkmf... /usr/X/bin/xmkmf
> /home/bs/sfesys/sysadm/export/common.alias: No such file or directory
> /home/bs/sfesys/sysadm/export/common.alias: No such file or directory
> /home/bs/sfesys/sysadm/export/common.alias: No such file or directory
> /home/bs/sfesys/sysadm/export/common.alias: No such file or directory

> This was with the 2.0.0 sources, so it isn't new. The culprit appears
> to be constructions like

>   if test "`which ${cc}`" = "`which ${CC}`"; then
>     shlib_ldflags=`${srcdir}/tools/GETMAKEVAL SHLIBLDFLAGS`
>     cpicflags=`${srcdir}/tools/GETMAKEVAL PICFLAGS`
>   fi

> in configure.ac.  I guess we shouldn't really use "which" at all...

In which case we need other means to figure out whether ${cc} and ${CC}
are the same.  (In the sense that they have the same pathname.)

Shell scripts for doing so will be appreciated.

(Actually, I would think that the above points to an incorrect imake
configuration.)

-k

From maechler at stat.math.ethz.ch  Fri Nov  5 09:54:03 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Nov  5 09:54:47 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <x28y9h5kdy.fsf@biostat.ku.dk>
References: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
	<x28y9h5kdy.fsf@biostat.ku.dk>
Message-ID: <16779.16299.785450.267590@gargle.gargle.HOWL>

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 04 Nov 2004 23:17:45 +0100 writes:

    PD> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
    >> On Thu, 4 Nov 2004, Paul Gilbert wrote:
    >> 
    >> > With R-2.0.1 (patched) on Linux rhlinux 2.4.21-4.ELsmp
    >> > 
    >> > when I configure get > ...  > checking whether C
    >> runtime needs -D__NO_MATH_INLINES... no > checking for
    >> xmkmf... /usr/bin/X11/xmkmf > Usage: which [options] [--]
    >> programname [...]  > Options: --version, -[vV] Print
    >> version and exit successfully.  > --help, Print this help
    >> and exit successfully.  > --skip-dot Skip directories in
    >> PATH that start with a dot.  > ...
    >> > 
    >> > but everything seems to configure and make ok. Should
    >> this message be > expect or is this a bug?
    >> 
    >> It is unexpected.  Is it new in 2.0.1 beta?  You have
    >> told us your kernel, not your distro.  This looks like a
    >> bug, but not in R.

    PD> I've seen it whizz by occasionally but never got around
    PD> to investigate.

me too. IIRC, also in some of my current Linux setups.
I think it's showing unfortunate behavior of configure ..
(ie. a "buglet" in the configure tools used to produce 'configure',
 and not in our 'configure.ac' source).

    PD>  As said, it doesn't actually affect the result of configure.

my experience as well.
Martin

From maechler at stat.math.ethz.ch  Fri Nov  5 09:58:48 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Nov  5 09:58:51 2004
Subject: [Rd] Getting the bare R version number {was "2.0.1 buglets"}
In-Reply-To: <418AD6AC.5040701@bankofcanada.ca>
References: <Pine.LNX.4.44.0411042113220.22863-100000@gannet.stats>
	<418AD6AC.5040701@bankofcanada.ca>
Message-ID: <16779.16584.999197.157199@gargle.gargle.HOWL>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca>
>>>>>     on Thu, 04 Nov 2004 20:26:04 -0500 writes:


    >> If you want the R version, that is 'R --version'.
    >> 
    >> 
    PaulG> I've been using this, but to make it into a file name
    PaulG> I need to do some stripping out of the extra
    PaulG> stuff. (And tail and head on Solaris do not use -n
    PaulG> whereas Linux wants this, so it becomes difficult to
    PaulG> be portable.) Is there a way to get just "R-2.0.1"
    PaulG> from R or R CMD something?

yes, by applying Brian's advice and good ol' "sed" :

  R --version | sed -n '1s/ /-/; 1s/ .*//p'

Martin

From maechler at stat.math.ethz.ch  Fri Nov  5 12:32:50 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Nov  5 12:32:54 2004
Subject: [Rd] Bug report (PR#7341)
In-Reply-To: <20041104180808.174B110F56@slim.kubism.ku.dk>
References: <20041104180808.174B110F56@slim.kubism.ku.dk>
Message-ID: <16779.25826.488530.297612@gargle.gargle.HOWL>

>>>>> "dan" == dan  <dan@bolser.co.uk>
>>>>>     on Thu,  4 Nov 2004 19:08:08 +0100 (CET) writes:

    dan> Full_Name: Dan B Version: na OS: na Submission from:
    dan> (NULL) (80.6.127.185)


    dan> I can't log into the bug tracker (I can't find where to
    dan> register / login).

[that's not what you should do. 
 Have you read on this in the FAQ or  help(bug.report) ?
 Please, please, do.
]

    dan> In this way I can't add the following context diff
    dan> (hopefully in the right order) for my changes to the
    dan> matrix.Rd...

    dan> Hmm... I guess this should be a separate report
    dan> anyway...

No, this is really not a bug report __AT ALL__

You had all this long discussion about how the documentation 
can/could/should/{is_hard_to} be improved  and end up sending
a *bug report* ?
Really!

Whereas I value your contribution for improving the matrix help
page -- and I do think both changes are worthwhile ---
there is no bug, and hence a bug report is *WRONG*!

Sending this to R-devel [instead! - not automagically via the
bug report] would have been perfectly fine and helpful...

    dan> The first diff explains how the dimnames list should
    dan> work, and the second diff gives an example of using the
    dan> dimnames list. (no equivelent example exists, and where
    dan> better than the matrix man page to show this off).

agreed.

I'll put in a version of your proposed improvement,
but please do try more to understand what's appropriate for bug
reports.

Regards,
Martin Maechler, ETH Zurich

From dan at bolser.co.uk  Fri Nov  5 13:13:23 2004
From: dan at bolser.co.uk (dan@bolser.co.uk)
Date: Fri Nov  5 13:13:28 2004
Subject: [Rd] barplot (PR#7344)
Message-ID: <20041105121323.9DC5A10FD4@slim.kubism.ku.dk>

Full_Name: Dan B
Version: 2
OS: Fedora 2
Submission from: (NULL) (80.6.127.185)




The barplot 'legend' option produces a nice legend for the current image at its
current scale. Rescaling the image dosn't rescale the legend properly.

Also, the option ylog=TRUE / log='y' does not work with barplot.

(as if you didn't know) the barplot legend isn't placeable.

From dan at bolser.co.uk  Fri Nov  5 13:18:05 2004
From: dan at bolser.co.uk (dan@bolser.co.uk)
Date: Fri Nov  5 13:18:07 2004
Subject: [Rd] idea (PR#7345)
Message-ID: <20041105121805.3989110FA2@slim.kubism.ku.dk>

Full_Name: Dan B
Version: 2
OS: Fedora 2
Submission from: (NULL) (80.6.127.185)




It would be great if something like

currentPlot <- edit(par)

allowed dynamic changes to the 'currentPlot', which I am using as some kind of
'magic' keyword in the above context. i.e. the value of 'currentPlot' is
actually an alias for whatever the current graphical object is. 

calling the above command would open the edit pannel for the par options
relevant to whatever the currentPlot object was. 

The changes made to par would trigger an automatic redraw of the plot, to allow
dynamic editing. After the changes were made and edit closed, a copy of the
edited par could be taken to allow the settings to be automatically applied in
the future.

Dynamic editing of all object variables could be supported through this
mechanism to allow a very flexible overall control of graphical objects.

From dmb at mrc-dunn.cam.ac.uk  Fri Nov  5 13:32:39 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Fri Nov  5 13:32:53 2004
Subject: [Rd] Bug report (PR#7341)
In-Reply-To: <16779.25826.488530.297612@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.21.0411051226200.10126-100000@mail.mrc-dunn.cam.ac.uk>

On Fri, 5 Nov 2004, Martin Maechler wrote:

>>>>>> "dan" == dan  <dan@bolser.co.uk>
>>>>>>     on Thu,  4 Nov 2004 19:08:08 +0100 (CET) writes:
>
>    dan> Full_Name: Dan B Version: na OS: na Submission from:
>    dan> (NULL) (80.6.127.185)
>
>
>    dan> I can't log into the bug tracker (I can't find where to
>    dan> register / login).
>
>[that's not what you should do. 

OK, I just wanted to post a 'follow up' to the original 'bug'.


> Have you read on this in the FAQ or  help(bug.report) ?
> Please, please, do.
>]

Sorry. This is probably the cause of all the problems.

I know this isn't a 'bug' in the strict sense, but nither are the
'wishlist' entries on the bugs pages. I thought a bug report was a good
place to log these requests, so that they didn't get 'dropped' in the
system (i.e. "I thought you were catching that" - "Oh I thought *you* were
catching that") 

The bug report could be debated / altered as any bug is.

What classifies as a 'documentation bug'? A piece of documentation that
crashes my OS? (or my brain? ;)

Anyway, I know better now.

Thanks very much for the information,
All the best,
Dan.


>
>    dan> In this way I can't add the following context diff
>    dan> (hopefully in the right order) for my changes to the
>    dan> matrix.Rd...
>
>    dan> Hmm... I guess this should be a separate report
>    dan> anyway...
>
>No, this is really not a bug report __AT ALL__
>
>You had all this long discussion about how the documentation 
>can/could/should/{is_hard_to} be improved  and end up sending
>a *bug report* ?
>Really!
>
>Whereas I value your contribution for improving the matrix help
>page -- and I do think both changes are worthwhile ---
>there is no bug, and hence a bug report is *WRONG*!
>
>Sending this to R-devel [instead! - not automagically via the
>bug report] would have been perfectly fine and helpful...
>
>    dan> The first diff explains how the dimnames list should
>    dan> work, and the second diff gives an example of using the
>    dan> dimnames list. (no equivelent example exists, and where
>    dan> better than the matrix man page to show this off).
>
>agreed.
>
>I'll put in a version of your proposed improvement,
>but please do try more to understand what's appropriate for bug
>reports.
>
>Regards,
>Martin Maechler, ETH Zurich
>

From ligges at statistik.uni-dortmund.de  Fri Nov  5 13:59:46 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri Nov  5 13:59:49 2004
Subject: [Rd] Code/doc inconsistancy in constrOptim (PR#7346)
Message-ID: <20041105125946.CAC8910FAA@slim.kubism.ku.dk>

Code in constrOptim() (R-2.0.0, package stats):

     if (any(ui %*% theta - ci <= 0))
         stop("initial value not feasible")

but the help page tells us in Section "Details":

"The feasible region is defined by ui %*% theta - ci >= 0."


Uwe Ligges





--please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = i386
  os = mingw32
  system = i386, mingw32
  status =
  major = 2
  minor = 0.0
  year = 2004
  month = 10
  day = 04
  language = R

Windows NT 4.0 (build 1381) Service Pack 6

Search Path:
  .GlobalEnv, package:methods, package:stats, package:graphics, 
package:grDevices, package:datasets, package:utils, package:fortunes, 
Autoloads, package:base

From ripley at stats.ox.ac.uk  Fri Nov  5 14:01:29 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Nov  5 14:01:33 2004
Subject: [Rd] Ways to catch segfaults before they happen
Message-ID: <Pine.LNX.4.44.0411051223050.21169-100000@gannet.stats>

Those of you who monitor the daily package checks will know that some 
packages generate ERROR reports spasmodically.  This is normally due to 
segfaults, and in almost all cases has been traced (eventually) to memory 
access errors using the tool valgrind (http://valgrind.kde.org).
Current examples include RCurl, RandomFields, geoR, kza and pcurve.

This week I have run all the examples in all the CRAN packages under
valgrind (which took about 120 hours, not all running to completion), and
have sent reports to quite a few package maintainers.  A good selection of
the reports will be available at

http://www.stats.ox.ac.uk/pub/bdr/Rvg

for the next week or so.  Valgrind is not infallible and sometimes gets
confused by highly optimized code (and these tests were run with -O2): I
reckon this is the case for the loess_raw reports.

`Writing R Extensions' in 2.0.1 will have a section on `writing portable 
packages' covering this, and R-devel has a R CMD check --use-valgrind 
option to run all the examples/tests/vignettes under valgrind -- beware 
that is typically 20x slower.

Another problem area is running packages on 64-bit platforms, and quite a 
few package maintainers have received reports about that (and many have 
updated their packages already, thank you).  I am aware of problems 
currently in

    AnalyzeFMRI CoCo PBSmapping assist dblcens gap haplo.stats odesolve
    sampfling subselect

some of which result in infinite loops and others in segfaults.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Fri Nov  5 14:06:15 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Nov  5 14:05:56 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <20041105121805.3989110FA2@slim.kubism.ku.dk>
References: <20041105121805.3989110FA2@slim.kubism.ku.dk>
Message-ID: <418B7AC7.8000103@statistik.uni-dortmund.de>

dan@bolser.co.uk wrote:

> Full_Name: Dan B
> Version: 2
> OS: Fedora 2
> Submission from: (NULL) (80.6.127.185)
> 
> 
> 
> 
> It would be great if something like
> 
> currentPlot <- edit(par)
> 
> allowed dynamic changes to the 'currentPlot', which I am using as some kind of
> 'magic' keyword in the above context. i.e. the value of 'currentPlot' is
> actually an alias for whatever the current graphical object is. 
> 
> calling the above command would open the edit pannel for the par options
> relevant to whatever the currentPlot object was. 
> 
> The changes made to par would trigger an automatic redraw of the plot, to allow
> dynamic editing. After the changes were made and edit closed, a copy of the
> edited par could be taken to allow the settings to be automatically applied in
> the future.
> 
> Dynamic editing of all object variables could be supported through this
> mechanism to allow a very flexible overall control of graphical objects.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

Nice idea. Do you have any schedule for which R release R-core can 
include your contribution? Do you get it ready for R-2.1.0?
In particlular, I'm very interested in the way you are going to include 
this feature for non-screen devices such as postscript()...

Uwe Ligges

From ligges at statistik.uni-dortmund.de  Fri Nov  5 14:09:42 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri Nov  5 14:09:47 2004
Subject: [Rd] Code/doc inconsistancy in constrOptim (PR#7346)
Message-ID: <20041105130942.D97D010FA8@slim.kubism.ku.dk>

ligges@statistik.uni-dortmund.de wrote:

> Code in constrOptim() (R-2.0.0, package stats):
> 
>      if (any(ui %*% theta - ci <= 0))
>          stop("initial value not feasible")
> 
> but the help page tells us in Section "Details":
> 
> "The feasible region is defined by ui %*% theta - ci >= 0."

Damn, I'm sorry, apologies!!!

Someone told me of an error and I did not check carefully enough, in 
particluar not the following help pages sentence "The starting value 
must be in the interior of the feasible region, but the minimum may be 
on the boundary."

Uwe Ligges





> 
> Uwe Ligges
> 
> 
> 
> 
> 
> --please do not edit the information below--
> 
> Version:
>   platform = i386-pc-mingw32
>   arch = i386
>   os = mingw32
>   system = i386, mingw32
>   status =
>   major = 2
>   minor = 0.0
>   year = 2004
>   month = 10
>   day = 04
>   language = R
> 
> Windows NT 4.0 (build 1381) Service Pack 6
> 
> Search Path:
>   .GlobalEnv, package:methods, package:stats, package:graphics, 
> package:grDevices, package:datasets, package:utils, package:fortunes, 
> Autoloads, package:base
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Fri Nov  5 14:31:43 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Nov  5 14:31:52 2004
Subject: [Rd] 2.0.1 buglets
In-Reply-To: <418AD6AC.5040701@bankofcanada.ca>
Message-ID: <Pine.LNX.4.44.0411051330540.21334-100000@gannet.stats>

On Thu, 4 Nov 2004, Paul Gilbert wrote:

> Prof Brian Ripley wrote:
> 
> >> Also, I think "R CMD config --version" still has a bug, or a least it 
> >>does not report what I would expect:
> >>    
> >>
> ...
> 
> >It's what it is documented to do:
> >...
> >  -v, --version         print version info and exit
> >  
> >
> Ok, it could be clearer (at least to me) that this means version of the 
> script.

It's now been altered to say so.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dmb at mrc-dunn.cam.ac.uk  Fri Nov  5 14:51:07 2004
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Fri Nov  5 14:51:38 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <418B7AC7.8000103@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>

On Fri, 5 Nov 2004, Uwe Ligges wrote:

>dan@bolser.co.uk wrote:
>
>> Full_Name: Dan B
>> Version: 2
>> OS: Fedora 2
>> Submission from: (NULL) (80.6.127.185)
>> 
>> 
>> 
>> 
>> It would be great if something like
>> 
>> currentPlot <- edit(par)
>> 
>> allowed dynamic changes to the 'currentPlot', which I am using as some kind of
>> 'magic' keyword in the above context. i.e. the value of 'currentPlot' is
>> actually an alias for whatever the current graphical object is. 
>> 
>> calling the above command would open the edit pannel for the par options
>> relevant to whatever the currentPlot object was. 
>> 
>> The changes made to par would trigger an automatic redraw of the plot, to allow
>> dynamic editing. After the changes were made and edit closed, a copy of the
>> edited par could be taken to allow the settings to be automatically applied in
>> the future.
>> 
>> Dynamic editing of all object variables could be supported through this
>> mechanism to allow a very flexible overall control of graphical objects.
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>Nice idea. Do you have any schedule for which R release R-core can 
>include your contribution? Do you get it ready for R-2.1.0?
>In particlular, I'm very interested in the way you are going to include 
>this feature for non-screen devices such as postscript()...

Please point me at the release schedule ;)



I am fairly sure you were attacking my comments with a snide email - if
that isn't the case - I am very sorry. Please note that I am not currently 
able to make a significant contribution to R, and please ignore the rest
of this email.

If you are being snide, however, ...


Naturally doing this is totally beyond me, but as an end user it is my
prerogative to suggest such things. In fact any good software product
should be bombarded with suggestions on how it could be improved. 

Hopefully my 'idea' isn't too far removed from the practicalities of
software development (given the underlying design of R). For example I
could say something like 'make R read my mind and do what I want...'.
If my idea is of the same magnitude of impossibility, I apologise,
however, the request still stands because, as an end user, I can imagine
this style of working fitting in with the way I experience using R.

I see the developer idea to make 'dynamic graphics for the computer game
generation'. I think my idea is easier to implement, but has the same
overall outcome.

I really don't understand the negative and condescending culture that seems
to pervade R-dev. OK, so I am running round like a headless chicken,
complaining all over the place, doing thing in an inappropriate way and
generally annoying people all over, but I am not a troll. I genuinely like
R and I genuinely wish it could be better in certain ways, and (perhaps
vainly) I believe I can help by making my opinion known. I just don't get
the 'shut-up and f*** off' attitude. 

Ah well .. perhaps I am just being over sensitive. Again, apologies all
round if that is the case. 



>
>Uwe Ligges
>

From murdoch at stats.uwo.ca  Fri Nov  5 15:44:10 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Nov  5 15:44:39 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
References: <418B7AC7.8000103@statistik.uni-dortmund.de>
	<Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <hi3no0lbo7laslgl7f1tjqcf5c9j5f1v3g@4ax.com>

On Fri, 5 Nov 2004 13:51:07 +0000 (GMT), Dan Bolser
<dmb@mrc-dunn.cam.ac.uk> wrote :

>If you are being snide, however, ...
>
>
>Naturally doing this is totally beyond me, but as an end user it is my
>prerogative to suggest such things. In fact any good software product
>should be bombarded with suggestions on how it could be improved. 

I think you misunderstood the comment.  You're right that making good
suggestions is valuable.  However, R is an open source project:
nothing gets done unless someone volunteers to do it (or contributes
lots of money to pay someone to do it; that hasn't happened much yet,
though it has happened).

This means that big things only get done by their proponents.  Nobody
has time to devote to someone else's idea that will take weeks to
develop, unless it looks like a really interesting problem to solve.
A number of us happily implement small suggestions, but we just don't
have time to work on everything that would be good in R.  Luckily R
has a very active development community (see the hundreds of packages
on CRAN), so an amazing number of things get done.

>I really don't understand the negative and condescending culture that seems
>to pervade R-dev. OK, so I am running round like a headless chicken,
>complaining all over the place, doing thing in an inappropriate way and
>generally annoying people all over, but I am not a troll. I genuinely like
>R and I genuinely wish it could be better in certain ways, and (perhaps
>vainly) I believe I can help by making my opinion known. I just don't get
>the 'shut-up and f*** off' attitude. 

Email is no good for sending or receiving nuances of meaning.  It's
very easy for someone to read a suggested improvement as a demand for
service, and that would be totally inappropriate in an open source
project.  It's also very easy for someone to read a "do it yourself"
response as negative and condescending.   Both of these may be correct
readings in some cases, but not in all:  and you'll save a lot of
energy by just ignoring the bits you don't like.

>Ah well .. perhaps I am just being over sensitive. Again, apologies all
>round if that is the case. 

Duncan Murdoch

From maechler at stat.math.ethz.ch  Fri Nov  5 15:58:01 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri Nov  5 15:58:05 2004
Subject: [Rd] Bug report (PR#7341)
Message-ID: <20041105145801.9F35610452@slim.kubism.ku.dk>

>>>>> "Dan" == Dan Bolser <dmb@mrc-dunn.cam.ac.uk>
>>>>>     on Fri, 5 Nov 2004 12:32:39 +0000 (GMT) writes:

    Dan> On Fri, 5 Nov 2004, Martin Maechler wrote:
    >>>>>>> "dan" == dan <dan@bolser.co.uk> on Thu, 4 Nov 2004
    >>>>>>> 19:08:08 +0100 (CET) writes:
    >>
    dan> Full_Name: Dan B Version: na OS: na Submission from:
    dan> (NULL) (80.6.127.185)
    >>
    dan> I can't log into the bug tracker (I can't find where to
    dan> register / login).
    >>  [that's not what you should do.

    Dan> OK, I just wanted to post a 'follow up' to the original
    Dan> 'bug'.

I see:  In this case, just use e-mail and make sure to keep
the *original* 'PR#<...>' in the 'Subject:' line of the mail.
As Brian Ripley has once remarked, it may make sense to move the
'PR#<nnnn>' to the beginning of the subject line since that is
often wrapped when it becomes somewhat long.

Martin

From maechler at stat.math.ethz.ch  Fri Nov  5 16:19:53 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Nov  5 16:19:55 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
References: <418B7AC7.8000103@statistik.uni-dortmund.de>
	<Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <16779.39449.192581.855856@gargle.gargle.HOWL>


DanB> I really don't understand the negative and condescending
DanB> culture that seems to pervade R-dev.

It's pervading in replies to *Bug reports* about non-bugs!!
I thought you had read in the mean time what R bug reports
should be and that the things you have been posting as bug
reports were posted **WRONGLY**.

PLEASE:  
  1) All these suggestions were perfectly fit to be posted to R-devel
  2) All of them were completely NOT fit to be sent as bug reports

Martin

From ggrothendieck at myway.com  Fri Nov  5 17:26:47 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Fri Nov  5 17:26:54 2004
Subject: [Rd] wishlist: \& or \0 in sub/gsub
Message-ID: <loom.20041105T172526-988@post.gmane.org>


This is a wish list item.

It would be nice if one could use \0 or \& in sub and 
gsub as in vi:

	gsub("an", ":\\&:", "banana")

One can, of course, write the following right now:

	gsub("(an)", ":\\1:", "banana")

But often the this is within a function and the "an"
is passed which means that one must use paste to
construct the "(an)" argument.  

Thus:

	f <- function(x,y) { 
		x <- paste("(", x, ")", sep = "")
		gsub(x, ":\\1:", y)
	}

simplifies to:

	f <- function(x,y) gsub(x, ":\\&:", y)

I have seen at least one post on r-help where this could have been
used to good effect to simplify the answer.

It would be neater if \& or \0 could be used instead.
Obviously this is not a huge issue but it would be nice.

From h.wickham at gmail.com  Fri Nov  5 19:45:55 2004
From: h.wickham at gmail.com (hadley wickham)
Date: Fri Nov  5 19:46:07 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <16779.39449.192581.855856@gargle.gargle.HOWL>
References: <418B7AC7.8000103@statistik.uni-dortmund.de>
	<Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
	<16779.39449.192581.855856@gargle.gargle.HOWL>
Message-ID: <f8e6ff0504110510453c3f5244@mail.gmail.com>

I really think that a few simple changes to the bug reporting form
could reduce a lot of these problems - I did email a suggestion
(http://hadley.textdriven.com/report-bug.html) to the list a few weeks
ago but no-one replied.  Is there really no interest in improving the
current form?

Hadley

From p.dalgaard at biostat.ku.dk  Fri Nov  5 20:15:21 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Nov  5 20:16:13 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <f8e6ff0504110510453c3f5244@mail.gmail.com>
References: <418B7AC7.8000103@statistik.uni-dortmund.de>
	<Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
	<16779.39449.192581.855856@gargle.gargle.HOWL>
	<f8e6ff0504110510453c3f5244@mail.gmail.com>
Message-ID: <x2is8kt8dy.fsf@biostat.ku.dk>

hadley wickham <h.wickham@gmail.com> writes:

> I really think that a few simple changes to the bug reporting form
> could reduce a lot of these problems - I did email a suggestion
> (http://hadley.textdriven.com/report-bug.html) to the list a few weeks
> ago but no-one replied.  Is there really no interest in improving the
> current form?

There is (or maybe the whole b***ing mechanism), but some of us have
other things to attend to too, so things tend to sink into the mud... 

I had a look at the time, but it was unclear to me whether the
modified forms would entail messing with the Jitterbug sources. We're
already using a locally hacked version of a system that is no longer
supported by its author, and I'm unhappy about adding further hacks to
it. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From h.wickham at gmail.com  Fri Nov  5 20:27:59 2004
From: h.wickham at gmail.com (hadley wickham)
Date: Fri Nov  5 20:28:05 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <x2is8kt8dy.fsf@biostat.ku.dk>
References: <418B7AC7.8000103@statistik.uni-dortmund.de>
	<Pine.LNX.4.21.0411051330100.10126-100000@mail.mrc-dunn.cam.ac.uk>
	<16779.39449.192581.855856@gargle.gargle.HOWL>
	<f8e6ff0504110510453c3f5244@mail.gmail.com>
	<x2is8kt8dy.fsf@biostat.ku.dk>
Message-ID: <f8e6ff050411051127263f1564@mail.gmail.com>

Some parts would probably require modifications to jitterbug, but the
majority of changes are cosmetic.  I'd be happy help out making the
changes, but I suspect it would take you just as long to explain the
system to me as it would to do it.

Hadley

From ellis at stat.harvard.edu  Fri Nov  5 23:01:01 2004
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Fri Nov  5 23:01:27 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <418B7AC7.8000103@statistik.uni-dortmund.de>
References: <20041105121805.3989110FA2@slim.kubism.ku.dk>
	<418B7AC7.8000103@statistik.uni-dortmund.de>
Message-ID: <2E19048A-2F76-11D9-A082-000D93C24D64@stat.harvard.edu>


On Nov 5, 2004, at 5:06 AM, Uwe Ligges wrote:

> dan@bolser.co.uk wrote:
>
>> Full_Name: Dan B
>> Version: 2
>> OS: Fedora 2
>> Submission from: (NULL) (80.6.127.185)
>> It would be great if something like
>> currentPlot <- edit(par)
>

*snip*

> Nice idea. Do you have any schedule for which R release R-core can 
> include your contribution? Do you get it ready for R-2.1.0?
> In particlular, I'm very interested in the way you are going to 
> include this feature for non-screen devices such as postscript()...
>
> Uwe Ligges

The most obvious, and by far most difficult route, would be to make 
graphics devices first class citizens (IIRC Duncan TL has brought this 
up elsewhere) wherein you would aDev <- edit(aDev). That brings things 
to the device level (what you want) and a static device could act 
accordingly (i.e. not invoke a redraw). Obviously the most difficult as 
it would be a massive upheaval of base graphics (I suppose all of this 
could all be grouped under a category of "event-based streams," 
graphics events, XML SAX events, file events--aka connections, etc. 
Doesn't CL or Scheme have something along those lines?). But, as 
mentioned in the thread, pretty speculative but you never can tell what 
someone might hunker down and implement :-)

>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
---
Byron Ellis (ellis@stat.harvard.edu)
"Oook" -- The Librarian

From ripley at stats.ox.ac.uk  Fri Nov  5 23:10:19 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Nov  5 23:10:24 2004
Subject: [Rd] Re: [R] fast partial spectral decompositions.
In-Reply-To: <2C0E69E5-2F6A-11D9-AC45-000A95DA144C@mcauliffe.com>
Message-ID: <Pine.LNX.4.44.0411052110270.25202-100000@gannet.stats>

[This really is a programming question which the posting guide says should
have been sent to R-devel, so I have diverted it there.]

dseyv is not an interface to dsyevr, but a separate routine.

R does use dsyevr these days, but before R required IEC60559 arithmetic, 
it also provided the choice of dsyev, as the latter does not require 
IEC60559.

I am not sure what R_exts/Lapack.h is intended to be.  If you include
$(LAPACK_LIBS) $(BLAS_LIBS) in the building of your package, you will get
access to a full double-precision LAPACK library including dsyevr.
However, that header file is _not_ part of the R API and is _not_ a list
of exports.

There is another complication.  R imports LAPACK subroutines from either
an external LAPACK library or from an LAPACK library it creates.  Because
some external LAPACK libraries have a broken dsyev(r) but might be in use
as a BLAS library, under some circumstances R uses a renamed dsyev(r) as
rsyev(r).  So it is potentially dangerous to make use of dsyev(r) (and, 
let me say again, they are not part of the R API).  (AFAIR we did this to 
avoid getting incorrect results on some version of libsunperf.)

I suggest you use your own LAPACK routines of known provenance.

On Fri, 5 Nov 2004, Jon McAuliffe [malfunctioning@shift.key] wrote:

> i want to compute the top k eigenvalues+eigenvectors of a (large)
> real symmetric matrix. since it doesn't look like any top-level R
> function does this, i'll call LAPACK from a C shlib and then
> use .Call. the only LAPACK function i see to do this in
> R_ext/Lapack.h is dsyevx. however, i know that in LAPACK dsyevr
> can also return a partial eigendecomposition. why is dsyevr not
> exported in R_ext/Lapack.h? my superficial understanding is that
> dsyevr is "better" (faster? stabler?) for both complete and
> partial eigenproblems than dsyevd/dsyevx, but only the complete
> eigenproblem interface to dsyevr appears to be exported in
> Lapack.h (as dsyev).
> 
> corrections to misunderstandings in the above are welcome. advice
> on whether using dsyevr rather than dsyevx is (very) important
> for partial decompositions is also gratefully accepted.

I am baffled by the problem with your shift key: it does work some of the
time but your text is very hard to read when it does not work.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Sat Nov  6 02:00:15 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat Nov  6 02:00:22 2004
Subject: [Rd] idea (PR#7345)
In-Reply-To: <2E19048A-2F76-11D9-A082-000D93C24D64@stat.harvard.edu>
References: <20041105121805.3989110FA2@slim.kubism.ku.dk>
	<418B7AC7.8000103@statistik.uni-dortmund.de>
	<2E19048A-2F76-11D9-A082-000D93C24D64@stat.harvard.edu>
Message-ID: <md8oo0dmfd6hlnr3a89jd2osagevs192ln@4ax.com>

On Fri, 5 Nov 2004 14:01:01 -0800, Byron Ellis
<ellis@stat.harvard.edu> wrote:

>The most obvious, and by far most difficult route, would be to make 
>graphics devices first class citizens (IIRC Duncan TL has brought this 
>up elsewhere) wherein you would aDev <- edit(aDev). That brings things 
>to the device level (what you want) and a static device could act 
>accordingly (i.e. not invoke a redraw). Obviously the most difficult as 
>it would be a massive upheaval of base graphics (I suppose all of this 
>could all be grouped under a category of "event-based streams," 
>graphics events, XML SAX events, file events--aka connections, etc. 
>Doesn't CL or Scheme have something along those lines?). But, as 
>mentioned in the thread, pretty speculative but you never can tell what 
>someone might hunker down and implement :-)

Take a look at grid.  I think it's more likely something like this
would be built on top of grid than on top of base graphics.

Or, if you want to try it:

Take a look at grid.  I think you'll find it a lot easier starting
there than starting with base graphics.

Duncan Murdoch

From ggrothendieck at myway.com  Sat Nov  6 08:52:14 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov  6 08:52:25 2004
Subject: [Rd] wishlist: better error message in R CMD check
Message-ID: <loom.20041106T084821-432@post.gmane.org>

I was running R CMD check on Windows XP 2.0.1beta and 
got this:

Error in parse(file, n, text, prompt) : syntax error on 602

After a lot of aggravation I finally discovered that if I did
this:

copy *.R allofthem.R

and checked line 602 in allofthem.R that I could find the error.
I noticed that there are repeated references in the help archives
to this sort of error and how hard it is to locate it.  It 
certainly would be nice to tell the user which file the error
is in and to point to the original files, not some intermediate
file or if one must do it in terms of intermediate files to keep
the file around and tell the user which and where it is.

From andy_liaw at merck.com  Sat Nov  6 14:01:25 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Sat Nov  6 14:01:54 2004
Subject: [Rd] wishlist: better error message in R CMD check
Message-ID: <3A822319EB35174CA3714066D590DCD50994E28E@usrymx25.merck.com>

Gabor,

I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
CMD check will try to install the package first (in pkg.Rcheck), and only if
that's successful would checks be done.

The installation process will concatenate all R files in R/ to a single file
and essentially source() that in upon package loading.  That's where you
would see the syntax error.  I believe the recommended way is to install the
package and play with that a bit first, before doing R CMD check.  You'd
find some problems are much easier to find that way (e.g., errors in
NAMESPACE).

Cheers,
Andy

> From: Gabor Grothendieck
> 
> I was running R CMD check on Windows XP 2.0.1beta and 
> got this:
> 
> Error in parse(file, n, text, prompt) : syntax error on 602
> 
> After a lot of aggravation I finally discovered that if I did
> this:
> 
> copy *.R allofthem.R
> 
> and checked line 602 in allofthem.R that I could find the error.
> I noticed that there are repeated references in the help archives
> to this sort of error and how hard it is to locate it.  It 
> certainly would be nice to tell the user which file the error
> is in and to point to the original files, not some intermediate
> file or if one must do it in terms of intermediate files to keep
> the file around and tell the user which and where it is.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From ligges at statistik.uni-dortmund.de  Sat Nov  6 14:16:55 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Nov  6 14:16:35 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E28E@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD50994E28E@usrymx25.merck.com>
Message-ID: <418CCEC7.2090802@statistik.uni-dortmund.de>

Liaw, Andy wrote:

> Gabor,
> 
> I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
> CMD check will try to install the package first (in pkg.Rcheck), and only if
> that's successful would checks be done.
> 
> The installation process will concatenate all R files in R/ to a single file
> and essentially source() that in upon package loading.  That's where you
> would see the syntax error.  I believe the recommended way is to install the
> package and play with that a bit first, before doing R CMD check.  You'd
> find some problems are much easier to find that way (e.g., errors in
> NAMESPACE).
> 
> Cheers,
> Andy
> 
> 
>>From: Gabor Grothendieck
>>
>>I was running R CMD check on Windows XP 2.0.1beta and 
>>got this:
>>
>>Error in parse(file, n, text, prompt) : syntax error on 602
>

I found that syntax errors quite frequently are caused by missing 
newlines at the end of files.
What about changing the build scipts so that a newline is inserted after 
each of those files?

Uwe Ligges


>>After a lot of aggravation I finally discovered that if I did
>>this:
>>
>>copy *.R allofthem.R
>>
>>and checked line 602 in allofthem.R that I could find the error.
>>I noticed that there are repeated references in the help archives
>>to this sort of error and how hard it is to locate it.  It 
>>certainly would be nice to tell the user which file the error
>>is in and to point to the original files, not some intermediate
>>file or if one must do it in terms of intermediate files to keep
>>the file around and tell the user which and where it is.
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From kjetil at acelerate.com  Sat Nov  6 15:44:43 2004
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Sat Nov  6 15:48:25 2004
Subject: [Rd] foreign(read.spss) in rw2000 and re2001beta
Message-ID: <418CE35B.1000502@acelerate.com>

I encountered something strange with read.spss (package foreign, version 
0.7 with R2.0.0 and
version 0.8 with R2.0.1 beta, windows XP)

I made a test file test.sav with SPSS version 11.5.1
containing only one numeric variable, with a value label
for one value not occuring in the file. According to ?read.spss
this should result in a factor, but it results in all NA. Using the 
argument
use.value.labels=FALSE, everything is read as expected.

test <- read.spss("test.sav", to.=TRUE)
test > only NA's

Kjetil

-- 

Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra


From ripley at stats.ox.ac.uk  Sat Nov  6 15:53:52 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Nov  6 15:53:57 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <418CCEC7.2090802@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.44.0411061427080.26999-100000@gannet.stats>

On Sat, 6 Nov 2004, Uwe Ligges wrote:

> Liaw, Andy wrote:
> 
> > Gabor,
> > 
> > I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
> > CMD check will try to install the package first (in pkg.Rcheck), and only if
> > that's successful would checks be done.
> > 
> > The installation process will concatenate all R files in R/ to a single file
> > and essentially source() that in upon package loading.  That's where you
> > would see the syntax error.  I believe the recommended way is to install the
> > package and play with that a bit first, before doing R CMD check.  You'd
> > find some problems are much easier to find that way (e.g., errors in
> > NAMESPACE).

Indeed, that is the advice: you often get much more informative error 
messages that R CMD check hides.  To be explicit, install and then load 
the package and check its basic functionality before R CMD check.

However, if you get a syntax error it is either in the NAMESPACE file or 
one of the *.R files, and sourcing all of them will rapidly find which.

> >>From: Gabor Grothendieck
> >>
> >>I was running R CMD check on Windows XP 2.0.1beta and 
> >>got this:
> >>
> >>Error in parse(file, n, text, prompt) : syntax error on 602
> >
> 
> I found that syntax errors quite frequently are caused by missing 
> newlines at the end of files.
> What about changing the build scipts so that a newline is inserted after 
> each of those files?

Time to get a better editor, Uwe!  Those I use do not allow you to
save a .R file without a final NL.  (I would have thought you would have 
learned not to leave an incomplete last line after being bitten a few 
times.  In Emacs, set `Require Final Newline', and it's the default in 
vi.)

However, this is not done by the `build scipts' (or even scripts) but
by tools:::.install_package_code_files() at

    if(!all(file.append(outFile, codeFiles)))
        stop("unable to write code files")

So that is the place to alter this.  There would be a small overhead both
at INSTALL time and load time (but the latter only for packages which are
not save-imaged or lazy-loaded), I suspect a negligible one.  In any case
file.append could be written more efficiently for this case (outFile is
opened for each of the codeFiles) with making sure each file ended in LF
made an option.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat Nov  6 15:55:47 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Nov  6 15:55:51 2004
Subject: [Rd] foreign(read.spss) in rw2000 and re2001beta
In-Reply-To: <418CE35B.1000502@acelerate.com>
Message-ID: <Pine.LNX.4.44.0411061454300.26999-100000@gannet.stats>

On Sat, 6 Nov 2004, Kjetil Brinchmann Halvorsen wrote:

> I encountered something strange with read.spss (package foreign, version 
> 0.7 with R2.0.0 and
> version 0.8 with R2.0.1 beta, windows XP)

Please clarify: the same thing in both versions (read.spss has not changed 
between them)?

> I made a test file test.sav with SPSS version 11.5.1
> containing only one numeric variable, with a value label
> for one value not occuring in the file. According to ?read.spss
> this should result in a factor, but it results in all NA. Using the 
> argument
> use.value.labels=FALSE, everything is read as expected.

Can you make that file available please?

> test <- read.spss("test.sav", to.=TRUE)
> test > only NA's
> 
> Kjetil
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Sat Nov  6 16:07:09 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov  6 16:07:15 2004
Subject: [Rd] wishlist: better error message in R CMD check
References: <3A822319EB35174CA3714066D590DCD50994E28E@usrymx25.merck.com>
Message-ID: <loom.20041106T154428-996@post.gmane.org>

Liaw, Andy <andy_liaw <at> merck.com> writes:

> 
> Gabor,
> 
> I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
> CMD check will try to install the package first (in pkg.Rcheck), and only if
> that's successful would checks be done.
> 
> The installation process will concatenate all R files in R/ to a single file
> and essentially source() that in upon package loading.  That's where you
> would see the syntax error.  I believe the recommended way is to install the
> package and play with that a bit first, before doing R CMD check.  You'd
> find some problems are much easier to find that way (e.g., errors in
> NAMESPACE).

Thanks. Unfortunately if I run R CMD INSTALL
I get this:

[...]
  preparing package zoo for lazy loading
Error in tools:::.read_description(file) :
        file '/DESCRIPTION' does not exist
Execution halted
make: *** [lazyload] Error 1
*** Installation of zoo failed ***

Removing 'C:/PROGRA~1/R/RW2001~1/library/zoo'

I get a similar message if I run R CMD build --binary .

The DESCRIPTION file definitely exists so I assume it to
be something else.  

If I run run R CMD check then it crashes (that is,
I get a popup asking me if I want to send a bug report to 
Microsoft) at various points depending on which example
code in the .Rd files I comment out).  If I comment out
enough to let it run past them all then I get the following
(where I have added the dots at the beginning of each
line in this post to circumvent's gmane's top posting filter):

.> ### * runmean
.>
.> flush(stderr()); flush(stdout())
.>
.> ### Name: runmean
.> ### Title: Running Means/Maximums/Medians
.> ### Aliases: runmean runmax runmed
.> ### Keywords: ts
.>
.> ### ** Examples
.>
.> # x.date <- as.POSIXct(paste("2003-", rep(1:4, 4:1), "-", sample(1:28, 10, 
replace = TRUE), sep =
""))
.> # x <- zoo(rnorm(12), x.date)
.>
.> # runmean(x, 5)
.> # runmax(x, 5)
.> # runmed(x, 5)
.>
.>
.>
.> cleanEx(); ..nameEx <- "value"

I assume its the cleanEx line that is the problem but that is
not one my lines.  I would have tried it with an earlier
version of R but I don't want to overwrite the version
of the package I have installed on R 2.0.0 since then I will
be unable to proceed at all.

I am using Windows XP and R 2.0.1beta .

From jeff.horner at vanderbilt.edu  Sat Nov  6 16:35:30 2004
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Sat Nov  6 16:35:50 2004
Subject: [Rd] is.vector() gives error (PR#7288)
In-Reply-To: <x21xg19raa.fsf@biostat.ku.dk>
References: <20041014162543.92EC710452@slim.kubism.ku.dk>
	<x21xg19raa.fsf@biostat.ku.dk>
Message-ID: <418CEF42.70003@vanderbilt.edu>

Peter Dalgaard wrote:
[...]
> The other possibility is that you're tickling a low-level, system
> dependent bug in the evaluator. Can anyone reproduce this?
> 

I'm running up against this when embedding libR.so into apache2. 
Whenever I call Rf_initEmbeddedR(), I get the following message:

Error in lazyLoadDBfetch(key, datafile, compressed, envhook) :
         recursive default argument reference a

and then apache2 segfaults when it tries to run R_tryEval(). It happens 
with R-2.0.0 and R-patched_2004-11-05, but not with R-1.9.1.

Here's the code that I'm running in apache2:
-------------
/* initialization code for apache process */
static void mod_R_register_hooks (apr_pool_t *p)
{
     char *argv[] = {"mod_R", "--gui=none", "--slave", "--silent", 
"--vanilla","--no-readline"};
     int argc = sizeof(argv)/sizeof(argv[0]);

     ap_hook_handler(mod_R_method_handler, NULL, NULL, APR_HOOK_MIDDLE);

     Rf_initEmbeddedR(argc, argv);

     R_Outputfile = NULL;       /* stdout */
     /* R_Consolefile = NULL; */ /* stderr */

     ptr_R_WriteConsole = Rscript_WriteConsole; /* stdout goes to browser */

}
-----------------------
And then for every http request...
-----------------------
static SEXP R_source_fun;
static SEXP R_source_arg;

static int mod_R_method_handler (request_rec *r)
{

     SEXP val, expr;
     int errorOccurred;

     // Only handle if correct handler
     if (strcmp(r->handler,"application/x-httpd-r")){
         return DECLINED;
     }

     // Setup CGI
     ap_add_common_vars(r);
     ap_add_cgi_vars(r);

     ap_set_content_type(r,"text/html");
     rapache_current_req = r;

     /* Call source(r->filename) */
     /* Setup source() function call */

     /* function */
     R_source_fun = Rf_findFun(Rf_install("source"), R_GlobalEnv);
     PROTECT(R_source_fun);

     /* argument */
     PROTECT(R_source_arg = NEW_CHARACTER(1));
     SET_STRING_ELT(R_source_arg, 0, COPY_TO_USER_STRING(r->filename));

     /* expression */
     PROTECT(expr = allocVector(LANGSXP,2));
     SETCAR(expr,R_source_fun);
     SETCAR(CDR(expr),R_source_arg);

     errorOccurred=1;
     val = R_tryEval(expr,NULL,&errorOccurred);
     if (errorOccurred){

         // Send a message to stderr (apache redirects this to the error 
log)
         fprintf(stderr,"apache2_mod_R: source(%s) failed: 
%x!\n",r->filename,val);
     }
     UNPROTECT(3);

     return OK;
}

The above code works fine with R-2.0.0, R-patched_2004-11-05, and 
R-1.9.1 when I run it as a standalone command-line app in the following 
code and link against appropriate libR.so:

--------------------
int main(int ac, char **av){
     FILE *fd;
     ParseStatus status;
     SEXP expr, R_source_fun, R_source_arg, val;
     Rboolean ok;
     int errorOccurred;

     char *argv[] = {"mod_R", "--gui=none", "--slave", "--silent", 
"--vanilla","--no-readline"};
     int argc = sizeof(argv)/sizeof(argv[0]);

     if (ac != 2){
         printf("Usage: %s filename\n",av[0]);
         exit(1);
     }

     Rf_initEmbeddedR(argc, argv);

     /* function */
     R_source_fun = Rf_findFun(Rf_install("source"), R_GlobalEnv);
     PROTECT(R_source_fun);

     /* argument */
     PROTECT(R_source_arg = NEW_CHARACTER(1));
     SET_STRING_ELT(R_source_arg, 0, COPY_TO_USER_STRING(av[1]));

     /* expression */
     PROTECT(expr = allocVector(LANGSXP,2));
     SETCAR(expr,R_source_fun);
     SETCAR(CDR(expr),R_source_arg);

     errorOccurred=1;
     val = R_tryEval(expr,NULL,&errorOccurred);
     if (errorOccurred){

         // Send a message to stderr (apache redirects this to the error 
log)
         fprintf(stderr,"source(%s) failed: %x!\n",av[1],val);
         //fprintf(stderr,"apache2_mod_R: handler is %s\n",r->handler);
         //fprintf(stderr,"apache2_mod_R: filename is %s\n",r->filename);
     }
     UNPROTECT(3);

}
----------------------

When I run apache2 inside gdb until it segfaults:
----------------------
$ gdb apache2/bin/httpd
GNU gdb 6.1-debian
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain 
conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-linux"...Using host libthread_db 
library "/lib/libthread_db.so.1".

(gdb) run -X
Starting program: /home/hornerjr/R_MODULE/apache2/bin/httpd -X
[Thread debugging using libthread_db enabled]
[New Thread 16384 (LWP 15333)]
Detaching after fork from child process 15336.
httpd: Could not determine the server's fully qualified domain name, 
using 160.129.129.111 for ServerName

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 15333)]
0x403dc607 in Rf_applyClosure (call=0x83eab20, op=0x8ef8b74, 
arglist=0x8ea8168, rho=0x8ef8ca8, suppliedenv=0x8a9b814) at eval.c:561
warning: Source file is more recent than executable.

561             if (R_ReturnedValue == R_RestartToken) {
(gdb) where
#0  0x403dc607 in Rf_applyClosure (call=0x83eab20, op=0x8ef8b74, 
arglist=0x8ea8168, rho=0x8ef8ca8, suppliedenv=0x8a9b814) at eval.c:561
#1  0x08ef8b74 in ?? ()
#2  0x083eab20 in ?? ()
#3  0x08ef8b74 in ?? ()
#4  0x08ea8168 in ?? ()
#5  0x08ef8ca8 in ?? ()
#6  0x08a9b814 in ?? ()
#7  0x40403ea1 in Rf_protect (s=0x86aa094) at memory.c:2068
Previous frame inner to this frame (corrupt stack?)
------------------------------

I'm not exactly sure if it's a threading issue (I compiled apache2 
--without-threads), and httpd -X runs exactly one process, but I'll post 
as soon as I have more information...


-- 
Jeffrey Horner       Computer Systems Analyst         School of Medicine
615-322-8606         Department of Biostatistics   Vanderbilt University

From p.dalgaard at biostat.ku.dk  Sat Nov  6 17:13:10 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat Nov  6 17:14:06 2004
Subject: [Rd] foreign(read.spss) in rw2000 and re2001beta
In-Reply-To: <418CE35B.1000502@acelerate.com>
References: <418CE35B.1000502@acelerate.com>
Message-ID: <x24qk3dkh5.fsf@biostat.ku.dk>

Kjetil Brinchmann Halvorsen <kjetil@acelerate.com> writes:

> I made a test file test.sav with SPSS version 11.5.1
> containing only one numeric variable, with a value label
> for one value not occuring in the file. According to ?read.spss
> this should result in a factor, but it results in all NA. 

Er, what do you mean "all NA"? If the only factor level corresponds to
a value that isn't present, wouldn't you expect to get a factor with
one level and all values missing? What does str() say about the
resulting object?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Sat Nov  6 17:20:27 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov  6 17:20:38 2004
Subject: [Rd] install/build/build --binary
Message-ID: <loom.20041106T171129-156@post.gmane.org>

I have question regarding package installation.

What is the difference between check, INSTALL, build and 
build --binary, which imply which and what order does one
normally perform them?  I have been trying:

R CMD build /mypackage
R CMD check /mypackage
R CMD build --binary /mypackage

in that order but wanted to check that this is right. 

Also, what portion of the check process can be run right from R rather
than from a script and assuming my package is in /mypackage and its
subdirectories what R command(s) from tools do I issue?  It occurs to
me that if I do it from R rather than from scripts I could turn on
debugging on the relevant tools command and more easily find out
what they are checking when things go bad to help me track down
my problems.

I am using Windows XP and R 2.0.1beta .

Thanks.

From tlumley at u.washington.edu  Sat Nov  6 17:56:14 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Sat Nov  6 17:56:20 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <loom.20041106T084821-432@post.gmane.org>
References: <loom.20041106T084821-432@post.gmane.org>
Message-ID: <Pine.A41.4.61b.0411060852370.264288@homer07.u.washington.edu>

On Sat, 6 Nov 2004, Gabor Grothendieck wrote:

> I was running R CMD check on Windows XP 2.0.1beta and
> got this:
>
> Error in parse(file, n, text, prompt) : syntax error on 602
>
> After a lot of aggravation I finally discovered that if I did
> this:
>
> copy *.R allofthem.R
>
> and checked line 602 in allofthem.R that I could find the error.
> I noticed that there are repeated references in the help archives
> to this sort of error and how hard it is to locate it.  It
> certainly would be nice to tell the user which file the error
> is in and to point to the original files, not some intermediate
> file or if one must do it in terms of intermediate files to keep
> the file around and tell the user which and where it is.

The intermediate file *is* kept around (at least for CMD check on a 
directory -- I haven't tried it on a tarball).  It is
  package.Rcheck/package/R/package

Telling the user where it is would be helpful, as you say.

 	-thomas

From wolski at molgen.mpg.de  Sat Nov  6 18:04:51 2004
From: wolski at molgen.mpg.de (Witold Eryk Wolski)
Date: Sat Nov  6 18:04:58 2004
Subject: [Rd] install/build/build --binary
In-Reply-To: <loom.20041106T171129-156@post.gmane.org>
References: <loom.20041106T171129-156@post.gmane.org>
Message-ID: <418D0433.9060607@molgen.mpg.de>

Hi,

You do not need R CMD build before you carry out an R CMD check.

/E

Ps.
R CMD --force is a important switch.


Gabor Grothendieck wrote:

>I have question regarding package installation.
>
>What is the difference between check, INSTALL, build and 
>build --binary, which imply which and what order does one
>normally perform them?  I have been trying:
>
>R CMD build /mypackage
>R CMD check /mypackage
>R CMD build --binary /mypackage
>
>in that order but wanted to check that this is right. 
>
>Also, what portion of the check process can be run right from R rather
>than from a script and assuming my package is in /mypackage and its
>subdirectories what R command(s) from tools do I issue?  It occurs to
>me that if I do it from R rather than from scripts I could turn on
>debugging on the relevant tools command and more easily find out
>what they are checking when things go bad to help me track down
>my problems.
>
>I am using Windows XP and R 2.0.1beta .
>
>Thanks.
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel
>
>  
>


-- 
Dipl. bio-chem. Witold Eryk Wolski
MPI-Moleculare Genetic
Ihnestrasse 63-73 14195 Berlin
tel: 0049-30-83875219                 __("<    _
http://www.molgen.mpg.de/~wolski      \__/    'v'
http://r4proteomics.sourceforge.net    ||    /   \
mail: witek96@users.sourceforge.net    ^^     m m
      wolski@molgen.mpg.de

From tlumley at u.washington.edu  Sat Nov  6 18:04:45 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Sat Nov  6 18:05:01 2004
Subject: [Rd] foreign(read.spss) in rw2000 and re2001beta
In-Reply-To: <x24qk3dkh5.fsf@biostat.ku.dk>
References: <418CE35B.1000502@acelerate.com> <x24qk3dkh5.fsf@biostat.ku.dk>
Message-ID: <Pine.A41.4.61b.0411060900180.264288@homer07.u.washington.edu>

On Sat, 6 Nov 2004, Peter Dalgaard wrote:

> Kjetil Brinchmann Halvorsen <kjetil@acelerate.com> writes:
>
>> I made a test file test.sav with SPSS version 11.5.1
>> containing only one numeric variable, with a value label
>> for one value not occuring in the file. According to ?read.spss
>> this should result in a factor, but it results in all NA.
>

It should result in a factor all of whose values are missing. And it does.

I have modified read.spss (but not committed the changes yet)  so that it 
does not create a factor when there are missing levels.

The problem is that SPSS uses value labels for two different things: for 
factors and for labelling a subset of values (eg different types of 
missing). It is hard for R to guess which the user intends.

You can always set use.value.labels=FALSE.  You still get the value labels 
read in and then you can decide what to do with them.

 	-thomas

From andy_liaw at merck.com  Sat Nov  6 18:38:09 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Sat Nov  6 18:46:22 2004
Subject: [Rd] install/build/build --binary
Message-ID: <3A822319EB35174CA3714066D590DCD50994E290@usrymx25.merck.com>

> From: Gabor Grothendieck
> 
> I have question regarding package installation.
> 
> What is the difference between check, INSTALL, build and 
> build --binary, which imply which and what order does one
> normally perform them?  I have been trying:
> 
> R CMD build /mypackage
> R CMD check /mypackage
> R CMD build --binary /mypackage
> 
> in that order but wanted to check that this is right. 

Here's my understanding:

R CMD build and R CMD check are nearly orthogonal.  R CMD build simply
create the .tar.gz using the version info in the DESCRIPTION file.  The only
part that's not orthogonal between the two (at least on Windows) is that R
CMD build --binary first install the package in a temporary directory and
then zip it up.

I would do:

1. R CMD INSTALL -l testdir mypkg, and start R, load the package and try it
out a bit.

2. R CMD check mypkg.  Make corrections as needed.

3. R CMD build mypkg (or add the --binary flag) for distribution.

I believe R-exts has some explanations.

HTH,
Andy
 
> Also, what portion of the check process can be run right from R rather
> than from a script and assuming my package is in /mypackage and its
> subdirectories what R command(s) from tools do I issue?  It occurs to
> me that if I do it from R rather than from scripts I could turn on
> debugging on the relevant tools command and more easily find out
> what they are checking when things go bad to help me track down
> my problems.
> 
> I am using Windows XP and R 2.0.1beta .
> 
> Thanks.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From p.dalgaard at biostat.ku.dk  Sat Nov  6 19:03:27 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat Nov  6 19:04:16 2004
Subject: [Rd] foreign(read.spss) in rw2000 and re2001beta
In-Reply-To: <Pine.A41.4.61b.0411060900180.264288@homer07.u.washington.edu>
References: <418CE35B.1000502@acelerate.com> <x24qk3dkh5.fsf@biostat.ku.dk>
	<Pine.A41.4.61b.0411060900180.264288@homer07.u.washington.edu>
Message-ID: <x2zn1udfdc.fsf@biostat.ku.dk>

Thomas Lumley <tlumley@u.washington.edu> writes:

> I have modified read.spss (but not committed the changes yet)  so that
> it does not create a factor when there are missing levels.

Hmm, could we handle this more elegantly? At the very least, we should
probably try to keep the labels as an attribute, so that you have the
option of doing something constructive with them afterwards. Perhaps
we need an entire new data class (say "labeled") and an as.factor()
method doing basically what happens now.

BTW, I take it that you mean "when there are values with no labels",
not "labels for values that are not present in data", right?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From tlumley at u.washington.edu  Sat Nov  6 20:14:55 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Sat Nov  6 20:15:11 2004
Subject: [Rd] foreign(read.spss) in rw2000 and re2001beta
In-Reply-To: <x2zn1udfdc.fsf@biostat.ku.dk>
References: <418CE35B.1000502@acelerate.com> <x24qk3dkh5.fsf@biostat.ku.dk>
	<Pine.A41.4.61b.0411060900180.264288@homer07.u.washington.edu>
	<x2zn1udfdc.fsf@biostat.ku.dk>
Message-ID: <Pine.A41.4.61b.0411061107570.196336@homer08.u.washington.edu>

On Sat, 6 Nov 2004, Peter Dalgaard wrote:

> Thomas Lumley <tlumley@u.washington.edu> writes:
>
>> I have modified read.spss (but not committed the changes yet)  so that
>> it does not create a factor when there are missing levels.
>
> Hmm, could we handle this more elegantly? At the very least, we should
> probably try to keep the labels as an attribute, so that you have the
> option of doing something constructive with them afterwards.

They are kept as an attribute if use.value.labels=TRUE, whether or not a 
factor is created. I had thought they were always kept as an attribute 
even if use.value.labels=FALSE (as happens with read.dta), but this turns 
out not to be the case. This is easily fixed, and I will do so.


I have thought about a class that would make sense for data with some 
values labelled but not all. This is related to some other data 
representation issues that a colleague is asking about, and we may come up 
with a reasonably elegant and general solution.

 	-thomas

From ggrothendieck at myway.com  Sat Nov  6 20:22:33 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov  6 20:22:39 2004
Subject: [Rd] install/build/build --binary
References: <3A822319EB35174CA3714066D590DCD50994E290@usrymx25.merck.com>
Message-ID: <loom.20041106T201859-68@post.gmane.org>

Liaw, Andy <andy_liaw <at> merck.com> writes:

: 
: > From: Gabor Grothendieck
: > 
: > I have question regarding package installation.
: > 
: > What is the difference between check, INSTALL, build and 
: > build --binary, which imply which and what order does one
: > normally perform them?  I have been trying:
: > 
: > R CMD build /mypackage
: > R CMD check /mypackage
: > R CMD build --binary /mypackage
: > 
: > in that order but wanted to check that this is right. 
: 
: Here's my understanding:
: 
: R CMD build and R CMD check are nearly orthogonal.  R CMD build simply
: create the .tar.gz using the version info in the DESCRIPTION file.  The only
: part that's not orthogonal between the two (at least on Windows) is that R
: CMD build --binary first install the package in a temporary directory and
: then zip it up.
: 
: I would do:
: 
: 1. R CMD INSTALL -l testdir mypkg, and start R, load the package and try it
: out a bit.

Thanks.  This was quite useful.  I used the above line with the --no-lazy
switch and this allowed me to install it without crashing.  I still
have not figured out why it crashes otherwise but now that I can run
it I am on my way.

: 
: 2. R CMD check mypkg.  Make corrections as needed.
: 
: 3. R CMD build mypkg (or add the --binary flag) for distribution.
: 
: I believe R-exts has some explanations.

From ggrothendieck at myway.com  Sun Nov  7 05:06:59 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov  7 05:07:07 2004
Subject: [Rd] creating a package without lazy loading
Message-ID: <loom.20041107T044056-206@post.gmane.org>



When I do a   

  R CMD build --binary   

then I get the messages at the end of this post unless I specify 

  LazyLoad: no 

in the DESCRIPRION file.  If I do that then everything 
proceeds smoothly.  R CMD check proceeds smoothly in
either case. Is there something I should be aware 
of that is causing this message when I do not turn off
lazy loading?

I am using Windows XP and R 2.0.1 beta dated 2004-11-04.


Error in tools:::.read_description(file) :
        file '/DESCRIPTION' does not exist
Execution halted
make: *** [lazyload] Error 1
*** Installation of zoo failed ***

Removing 'C:/PROGRA~1/R/RW2001~1/library/zoo'
Restoring previous 'C:/PROGRA~1/R/RW2001~1/library/zoo'

From ligges at statistik.uni-dortmund.de  Sun Nov  7 13:06:23 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Nov  7 13:06:07 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <Pine.LNX.4.44.0411061427080.26999-100000@gannet.stats>
References: <Pine.LNX.4.44.0411061427080.26999-100000@gannet.stats>
Message-ID: <418E0FBF.5000504@statistik.uni-dortmund.de>

Prof Brian Ripley wrote:

> On Sat, 6 Nov 2004, Uwe Ligges wrote:
> 
> 
>>Liaw, Andy wrote:
>>
>>
>>>Gabor,
>>>
>>>I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
>>>CMD check will try to install the package first (in pkg.Rcheck), and only if
>>>that's successful would checks be done.
>>>
>>>The installation process will concatenate all R files in R/ to a single file
>>>and essentially source() that in upon package loading.  That's where you
>>>would see the syntax error.  I believe the recommended way is to install the
>>>package and play with that a bit first, before doing R CMD check.  You'd
>>>find some problems are much easier to find that way (e.g., errors in
>>>NAMESPACE).
> 
> 
> Indeed, that is the advice: you often get much more informative error 
> messages that R CMD check hides.  To be explicit, install and then load 
> the package and check its basic functionality before R CMD check.
> 
> However, if you get a syntax error it is either in the NAMESPACE file or 
> one of the *.R files, and sourcing all of them will rapidly find which.
> 
> 
>>>>From: Gabor Grothendieck
>>>>
>>>>I was running R CMD check on Windows XP 2.0.1beta and 
>>>>got this:
>>>>
>>>>Error in parse(file, n, text, prompt) : syntax error on 602
>>>
>>I found that syntax errors quite frequently are caused by missing 
>>newlines at the end of files.
>>What about changing the build scipts so that a newline is inserted after 
>>each of those files?
> 
> 
> Time to get a better editor, Uwe!  Those I use do not allow you to
> save a .R file without a final NL.  (I would have thought you would have 
> learned not to leave an incomplete last line after being bitten a few 
> times.  In Emacs, set `Require Final Newline', and it's the default in 
> vi.)

Well, you already know I'm using WinEdt which also saves .R files 
without final newline, but, e.g., Windows' native notepad.exe leaves the 
final line as is ...


> However, this is not done by the `build scipts' (or even scripts) but
> by tools:::.install_package_code_files() at
> 
>     if(!all(file.append(outFile, codeFiles)))
>         stop("unable to write code files")
> 
> So that is the place to alter this.  There would be a small overhead both
> at INSTALL time and load time (but the latter only for packages which are
> not save-imaged or lazy-loaded), I suspect a negligible one.  In any case
> file.append could be written more efficiently for this case (outFile is
> opened for each of the codeFiles) with making sure each file ended in LF
> made an option.

Have not looked that closely - I will put it on my ToDo list, but with a 
minor priority, i.e. it won't be done this year, if nobody else (like 
those bitten by the problem) is going to contribute.

Uwe

From ligges at statistik.uni-dortmund.de  Sun Nov  7 13:21:39 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Nov  7 13:21:25 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <loom.20041106T154428-996@post.gmane.org>
References: <3A822319EB35174CA3714066D590DCD50994E28E@usrymx25.merck.com>
	<loom.20041106T154428-996@post.gmane.org>
Message-ID: <418E1353.40004@statistik.uni-dortmund.de>

Gabor Grothendieck wrote:

> Liaw, Andy <andy_liaw <at> merck.com> writes:
> 
> 
>>Gabor,
>>
>>I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
>>CMD check will try to install the package first (in pkg.Rcheck), and only if
>>that's successful would checks be done.
>>
>>The installation process will concatenate all R files in R/ to a single file
>>and essentially source() that in upon package loading.  That's where you
>>would see the syntax error.  I believe the recommended way is to install the
>>package and play with that a bit first, before doing R CMD check.  You'd
>>find some problems are much easier to find that way (e.g., errors in
>>NAMESPACE).
> 
> 
> Thanks. Unfortunately if I run R CMD INSTALL
> I get this:
> 
> [...]
>   preparing package zoo for lazy loading
> Error in tools:::.read_description(file) :
>         file '/DESCRIPTION' does not exist
> Execution halted
> make: *** [lazyload] Error 1
> *** Installation of zoo failed ***
> 
> Removing 'C:/PROGRA~1/R/RW2001~1/library/zoo'
> 
> I get a similar message if I run R CMD build --binary .
> 
> The DESCRIPTION file definitely exists so I assume it to
> be something else.  

In a few minutes, I'll comment to the "/DESCRIPTION" error in the other 
R-devel thread "[Rd] creating a package without lazy loading" you have 
opened.


The next error below is unrelated, AFAICS. You been bitten by a bug in 
some function, but we cannot say without a reproducible example, e.g. a 
minimal (!!!) version of the non-working package sources.

Uwe Ligges



> If I run run R CMD check then it crashes (that is,
> I get a popup asking me if I want to send a bug report to 
> Microsoft) at various points depending on which example
> code in the .Rd files I comment out).  If I comment out
> enough to let it run past them all then I get the following
> (where I have added the dots at the beginning of each
> line in this post to circumvent's gmane's top posting filter):
> 
> .> ### * runmean
> .>
> .> flush(stderr()); flush(stdout())
> .>
> .> ### Name: runmean
> .> ### Title: Running Means/Maximums/Medians
> .> ### Aliases: runmean runmax runmed
> .> ### Keywords: ts
> .>
> .> ### ** Examples
> .>
> .> # x.date <- as.POSIXct(paste("2003-", rep(1:4, 4:1), "-", sample(1:28, 10, 
> replace = TRUE), sep =
> ""))
> .> # x <- zoo(rnorm(12), x.date)
> .>
> .> # runmean(x, 5)
> .> # runmax(x, 5)
> .> # runmed(x, 5)
> .>
> .>
> .>
> .> cleanEx(); ..nameEx <- "value"
> 
> I assume its the cleanEx line that is the problem but that is
> not one my lines.  I would have tried it with an earlier
> version of R but I don't want to overwrite the version
> of the package I have installed on R 2.0.0 since then I will
> be unable to proceed at all.
> 
> I am using Windows XP and R 2.0.1beta .
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Sun Nov  7 13:27:52 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Nov  7 13:28:00 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <418E0FBF.5000504@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.44.0411071225180.14299-100000@gannet.stats>

On Sun, 7 Nov 2004, Uwe Ligges wrote:

> Prof Brian Ripley wrote:
> 
> > On Sat, 6 Nov 2004, Uwe Ligges wrote:
> > 
> > 
> >>Liaw, Andy wrote:
> >>
> >>
> >>>Gabor,
> >>>
> >>>I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
> >>>CMD check will try to install the package first (in pkg.Rcheck), and only if
> >>>that's successful would checks be done.
> >>>
> >>>The installation process will concatenate all R files in R/ to a single file
> >>>and essentially source() that in upon package loading.  That's where you
> >>>would see the syntax error.  I believe the recommended way is to install the
> >>>package and play with that a bit first, before doing R CMD check.  You'd
> >>>find some problems are much easier to find that way (e.g., errors in
> >>>NAMESPACE).
> > 
> > 
> > Indeed, that is the advice: you often get much more informative error 
> > messages that R CMD check hides.  To be explicit, install and then load 
> > the package and check its basic functionality before R CMD check.
> > 
> > However, if you get a syntax error it is either in the NAMESPACE file or 
> > one of the *.R files, and sourcing all of them will rapidly find which.
> > 
> > 
> >>>>From: Gabor Grothendieck
> >>>>
> >>>>I was running R CMD check on Windows XP 2.0.1beta and 
> >>>>got this:
> >>>>
> >>>>Error in parse(file, n, text, prompt) : syntax error on 602
> >>>
> >>I found that syntax errors quite frequently are caused by missing 
> >>newlines at the end of files.
> >>What about changing the build scipts so that a newline is inserted after 
> >>each of those files?
> > 
> > 
> > Time to get a better editor, Uwe!  Those I use do not allow you to
> > save a .R file without a final NL.  (I would have thought you would have 
> > learned not to leave an incomplete last line after being bitten a few 
> > times.  In Emacs, set `Require Final Newline', and it's the default in 
> > vi.)
> 
> Well, you already know I'm using WinEdt which also saves .R files 
> without final newline, but, e.g., Windows' native notepad.exe leaves the 
> final line as is ...

Yes, well, notepad.exe is most programmer's idea of the worst possible 
editor.

Is it not possible to get WinEdt to make sure the final line is complete?

> > However, this is not done by the `build scipts' (or even scripts) but
> > by tools:::.install_package_code_files() at
> > 
> >     if(!all(file.append(outFile, codeFiles)))
> >         stop("unable to write code files")
> > 
> > So that is the place to alter this.  There would be a small overhead both
> > at INSTALL time and load time (but the latter only for packages which are
> > not save-imaged or lazy-loaded), I suspect a negligible one.  In any case
> > file.append could be written more efficiently for this case (outFile is
> > opened for each of the codeFiles) with making sure each file ended in LF
> > made an option.
> 
> Have not looked that closely - I will put it on my ToDo list, but with a 
> minor priority, i.e. it won't be done this year, if nobody else (like 
> those bitten by the problem) is going to contribute.

It is already done in R-devel, but I had to work quite hard to make a test 
example (I used WordPad, in the end).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Sun Nov  7 13:39:58 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Nov  7 13:39:41 2004
Subject: [Rd] wishlist: better error message in R CMD check
In-Reply-To: <Pine.LNX.4.44.0411071225180.14299-100000@gannet.stats>
References: <Pine.LNX.4.44.0411071225180.14299-100000@gannet.stats>
Message-ID: <418E179E.70101@statistik.uni-dortmund.de>

Prof Brian Ripley wrote:
> On Sun, 7 Nov 2004, Uwe Ligges wrote:
> 
> 
>>Prof Brian Ripley wrote:
>>
>>
>>>On Sat, 6 Nov 2004, Uwe Ligges wrote:
>>>
>>>
>>>
>>>>Liaw, Andy wrote:
>>>>
>>>>
>>>>
>>>>>Gabor,
>>>>>
>>>>>I guess is that you did not try to run R CMD INSTALL before R CMD check.  R
>>>>>CMD check will try to install the package first (in pkg.Rcheck), and only if
>>>>>that's successful would checks be done.
>>>>>
>>>>>The installation process will concatenate all R files in R/ to a single file
>>>>>and essentially source() that in upon package loading.  That's where you
>>>>>would see the syntax error.  I believe the recommended way is to install the
>>>>>package and play with that a bit first, before doing R CMD check.  You'd
>>>>>find some problems are much easier to find that way (e.g., errors in
>>>>>NAMESPACE).
>>>
>>>
>>>Indeed, that is the advice: you often get much more informative error 
>>>messages that R CMD check hides.  To be explicit, install and then load 
>>>the package and check its basic functionality before R CMD check.
>>>
>>>However, if you get a syntax error it is either in the NAMESPACE file or 
>>>one of the *.R files, and sourcing all of them will rapidly find which.
>>>
>>>
>>>
>>>>>>From: Gabor Grothendieck
>>>>>>
>>>>>>I was running R CMD check on Windows XP 2.0.1beta and 
>>>>>>got this:
>>>>>>
>>>>>>Error in parse(file, n, text, prompt) : syntax error on 602
>>>>>
>>>>I found that syntax errors quite frequently are caused by missing 
>>>>newlines at the end of files.
>>>>What about changing the build scipts so that a newline is inserted after 
>>>>each of those files?
>>>
>>>
>>>Time to get a better editor, Uwe!  Those I use do not allow you to
>>>save a .R file without a final NL.  (I would have thought you would have 
>>>learned not to leave an incomplete last line after being bitten a few 
>>>times.  In Emacs, set `Require Final Newline', and it's the default in 
>>>vi.)
>>
>>Well, you already know I'm using WinEdt which also saves .R files 
>>without final newline,  but, e.g., Windows' native notepad.exe leaves the
>>final line as is ...
> 
> 
> Yes, well, notepad.exe is most programmer's idea of the worst possible 
> editor.
> 
> Is it not possible to get WinEdt to make sure the final line is complete?

Arrgh, sorry, I meant  "which also saves .R files *with* final newline"!!!


> 
>>>However, this is not done by the `build scipts' (or even scripts) but
>>>by tools:::.install_package_code_files() at
>>>
>>>    if(!all(file.append(outFile, codeFiles)))
>>>        stop("unable to write code files")
>>>
>>>So that is the place to alter this.  There would be a small overhead both
>>>at INSTALL time and load time (but the latter only for packages which are
>>>not save-imaged or lazy-loaded), I suspect a negligible one.  In any case
>>>file.append could be written more efficiently for this case (outFile is
>>>opened for each of the codeFiles) with making sure each file ended in LF
>>>made an option.
>>
>>Have not looked that closely - I will put it on my ToDo list, but with a 
>>minor priority, i.e. it won't be done this year, if nobody else (like 
>>those bitten by the problem) is going to contribute.
> 
> 
> It is already done in R-devel, but I had to work quite hard to make a test 
> example (I used WordPad, in the end).

Great, thanks!

Uwe

From ligges at statistik.uni-dortmund.de  Sun Nov  7 13:42:08 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Nov  7 13:41:53 2004
Subject: [Rd] creating a package without lazy loading
In-Reply-To: <loom.20041107T044056-206@post.gmane.org>
References: <loom.20041107T044056-206@post.gmane.org>
Message-ID: <418E1820.8020602@statistik.uni-dortmund.de>

Gabor Grothendieck wrote:
> 
> When I do a   
> 
>   R CMD build --binary   
> 
> then I get the messages at the end of this post unless I specify 
> 
>   LazyLoad: no 
> 
> in the DESCRIPRION file.  If I do that then everything 
> proceeds smoothly.  R CMD check proceeds smoothly in
> either case. Is there something I should be aware 
> of that is causing this message when I do not turn off
> lazy loading?
> 
> I am using Windows XP and R 2.0.1 beta dated 2004-11-04.
> 
> 
> Error in tools:::.read_description(file) :
>         file '/DESCRIPTION' does not exist
> Execution halted
> make: *** [lazyload] Error 1
> *** Installation of zoo failed ***
> 
> Removing 'C:/PROGRA~1/R/RW2001~1/library/zoo'
> Restoring previous 'C:/PROGRA~1/R/RW2001~1/library/zoo'


My guess is that you used backslashes to specify the path to the 
package, which seems to be handled incorretly. Try forward slashes instead!

I'll try to debug and comment on the  results in yet another thread
"Building a package under WIN2000 / rw2.0".

Uwe Ligges

From ligges at statistik.uni-dortmund.de  Sun Nov  7 13:42:20 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Nov  7 13:42:06 2004
Subject: [Rd] Re: [R] Building a package under WIN2000 / rw2.0
In-Reply-To: <0ABD88905D18E347874E0FB71C0B29E90237CFA2@exdkba022.novo.dk>
References: <0ABD88905D18E347874E0FB71C0B29E90237CFA2@exdkba022.novo.dk>
Message-ID: <418E182C.9070405@statistik.uni-dortmund.de>

BXC (Bendix Carstensen) wrote:
> I have an odd problem in building a package with only R-code in it.
> I have a package mainly used by myself which I last  build under R
> 1.9.0.
> The operation system is Win2000 5.00.2195, Service Pack 3
> 
> When I do:
> 
> c:\stat\r\rw2000\bin\Rcmd install --docs=normal --build
> --library=c:\stat\R\bxc\library c:\stat\R\bxc\library.sources\xx

[moved to R-devel]

Works with forward slashes as follows:

  c:\stat\r\rw2000\bin\Rcmd install --docs=normal --build
  --library=c:\stat\R\bxc\library c:/stat/R/bxc/library.sources/xx

The seems to be related with the more recent threads
"Re: [Rd] wishlist: better error message in R CMD check"
"[Rd] creating a package without lazy loading"
on R-devel.

I'll try to debug.

Uwe Ligges



> then after updating help pages I get:
> 
>   preparing package xx for lazy loading
>   Error in tools:::.read_description(file) :
>           file '/DESCRIPTION' does not exist
>   Execution halted
>   make: *** [lazyload] Error 1
>   *** Installation of xx failed ***
> 
> (Yes, I have a DESCRIPTION file).
> Having made a few changes here and there in some of the functions I
> transferred
> them one at a time to a new folder and tried to build it there.
> 
> The probelm seems to be that once I exceed 5 functions in the package
> the above
> error appears, with 5 or fewer functions it works OK.
> 
> Any ideas?
> 
> Bendix Carstensen
> ----------------------
> Bendix Carstensen
> Senior Statistician
> Steno Diabetes Center
> Niels Steensens Vej 2
> DK-2820 Gentofte
> Denmark
> tel: +45 44 43 87 38
> mob: +45 30 75 87 38
> fax: +45 44 43 07 06
> bxc@steno.dk
> www.biostat.ku.dk/~bxc
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html

From ggrothendieck at myway.com  Sun Nov  7 13:50:24 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov  7 13:50:42 2004
Subject: [Rd] creating a package without lazy loading
References: <loom.20041107T044056-206@post.gmane.org>
	<418E1820.8020602@statistik.uni-dortmund.de>
Message-ID: <loom.20041107T134846-138@post.gmane.org>

Uwe Ligges <ligges <at> statistik.uni-dortmund.de> writes:

: 
: Gabor Grothendieck wrote:
: > 
: > When I do a   
: > 
: >   R CMD build --binary   
: > 
: > then I get the messages at the end of this post unless I specify 
: > 
: >   LazyLoad: no 
: > 
: > in the DESCRIPRION file.  If I do that then everything 
: > proceeds smoothly.  R CMD check proceeds smoothly in
: > either case. Is there something I should be aware 
: > of that is causing this message when I do not turn off
: > lazy loading?
: > 
: > I am using Windows XP and R 2.0.1 beta dated 2004-11-04.
: > 
: > 
: > Error in tools:::.read_description(file) :
: >         file '/DESCRIPTION' does not exist
: > Execution halted
: > make: *** [lazyload] Error 1
: > *** Installation of zoo failed ***
: > 
: > Removing 'C:/PROGRA~1/R/RW2001~1/library/zoo'
: > Restoring previous 'C:/PROGRA~1/R/RW2001~1/library/zoo'
: 
: My guess is that you used backslashes to specify the path to the 
: package, which seems to be handled incorretly. Try forward slashes instead!
: 
: I'll try to debug and comment on the  results in yet another thread
: "Building a package under WIN2000 / rw2.0".
: 
: Uwe Ligges

Thanks!!!  The backslashes were indeed the problem.

From ggrothendieck at myway.com  Sun Nov  7 14:50:51 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov  7 14:51:06 2004
Subject: [Rd] wishlist: building packages
Message-ID: <loom.20041107T142548-233@post.gmane.org>


I have collected together some wishlist items from my
recent experience in package building.  Some of these
are also in other posts but I thought I would put them
in one place.  This all refers to Windows XP R 2.0.1 beta.

1. Would it be possible to put the whole package building 
process into R, at least for packages that do not use C,
so (a) one could leverage R's debugging facilities?  (b) The other
problem that this would address is that there are UNIX-like 
commands used by the scripts on Windows including find which conflicts 
with a Windows command.  Without scripts there would be no conflict.  
I had to change my PATH to put the UNIX-like tools ahead of the
Windows commands which I was really loathe to do.
(c) Also, it would presumably make the process more similar on 
different platforms.  It seems that like a significant portion of the 
package building process is already in R anyways.

2. The idea of R CMD check is nice.  One QA sort of feature
that would be nice would be to add some metrics to the output:
- number of top level functions, number of documented functions
- number of lines of code for suitable definition of lines
Since one normally runs check anyways it would be nice if 
getting this were just a side effect of running check so that
one does not need to issue additional commands.

3. On windows there can be problems when one uses backslashes
in path names, as noted in several recent posts.  Perhaps this 
could be addressed by either a warning, error or changing the 
process to accept backslashes.

4. In a recent post it was discussed that sometimes one gets
error messages referring to an intermediate R file but no 
message regarding where to find the file or what its name is.

5. It seems like there is quite a bit of information to digest
to build a package.  I found it quite overwhelming.  I guess
with 400+ packages enough people were able to overcome this but
it would still be nice if the prerequisites could be simplified
as much as possible.  I had successfullly built some small toy packages
before to convince myself I could do it but once faced with a
larger package (50-100 functions) I came up against problems that 
I had not previously seen and found I had to know more.

6. This is not an R problem, per se, but I probably spent about
an hour on trying to configure MikTeX to get it to work with
the build process.  There is probably nothing that can be done
as its already documented how to get around them but I hope
that MiKTeX gets some improvements here.

From dmb at mrc-dunn.cam.ac.uk  Sun Nov  7 15:14:27 2004
From: dmb at mrc-dunn.cam.ac.uk (dmb@mrc-dunn.cam.ac.uk)
Date: Sun Nov  7 15:14:34 2004
Subject: [Rd] Wishlist: Bug reporting (PR#7349)
Message-ID: <20041107141427.124B6EAC0@slim.kubism.ku.dk>


Hello, me again. 

This is a bug regarding R website / documentation. 

On the bug site http://r-bugs.biostat.ku.dk/cgi-bin/R it would be nice to
have a description of what each bug category is, what constitutes a bug in
that category etc. You could then have the user decide which category
their bug belongs in, and save yourself a job by having to decide. Also,
knowing what each category is (and what constitutes a bug in that
category) would be generally useful.

If there is a document I should have read to answer this question, please
add a link to that document to the bugs page...
http://r-bugs.biostat.ku.dk/cgi-bin/R.


In the Bugs section of the FAQ it suggests that "If you are not sure what
the command is supposed to do after a careful reading of the manual this
indicates a bug in the manual", so I see why a slight 'could be improved'
comment is is labeled *NOT A BUG*. Not being familiar with R culture right
away this is a bit confusing, as many open source projects include this
kind of thing in the bug tracking system (even though they are not
strictly bugs). For example, suggestions on improvements to the website
can be logged in the tracker. Also I think it should be made explicit that
their is a difference between knowing what a command should do and being
able to do it.

Perhaps a line or two about how to deal with such requests in the FAQ
would be good (or on the bug site).

Personally I feel that these things are most conveniently handled by
a bug tracker. Here I think giving the user the ability to choose category
could improve the system, so people could easily ignore 'trivial' bugs,
such as bugs submitted in a new 'documentation request' category or an
'examples request' category. I firmly believe that users (under a guiding
hand) are the best people to write the documentation. 

I would be interested to weigh the number of bug requests in these areas
(improvements to documentation) against the number of emails sent to r-help.

One thing about the FAQ is the phrase "a command's intended definition may
not be best for statistical analysis" - It isn't clear what that means (or
the rest of the paragraph).

One thing I thing is really strange is that after clicking Help Pages
under the Documentation section of the R website menu (probably the first
place a new user would look), you are immediately told (in rather confusing
terms) to look elsewhere.

Just finding http://stat.ethz.ch/R-manual/R-patched/doc/html/ is quite a
challenge (and perhaps the wrong place to look too). By that stage I have
already been asked twice (in large bold letters, to contact the r-help
list). It is vital to help people navigate to the help material.

The first useful help material I found when I first turned to R was here
http://cran.r-project.org/doc/manuals/R-intro.html#A%20sample%20session

I think the website should make guiding people to their 'first steps' with
R much easier. As it is there is a confusion of help materials (is that
the correct collective noun?). NB: this isn't a 'bug report' about the
quality of the introductory material, which I think is very good, but
rather a feature request about the website and how people are guided to
that material.


Please kindly receive these suggestion in the spirit of their honest
intent which is to openly and scientifically promote thought and
discussion about the potential usability of R, its online resources and
its feedback mechanisms.

All the best,
Dan.

From ripley at stats.ox.ac.uk  Sun Nov  7 15:18:05 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Nov  7 15:18:14 2004
Subject: [Rd] Re: [R] Building a package under WIN2000 / rw2.0
In-Reply-To: <418E182C.9070405@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.44.0411071412290.14381-100000@gannet.stats>

On Sun, 7 Nov 2004, Uwe Ligges wrote:

> BXC (Bendix Carstensen) wrote:
> > I have an odd problem in building a package with only R-code in it.
> > I have a package mainly used by myself which I last  build under R
> > 1.9.0.
> > The operation system is Win2000 5.00.2195, Service Pack 3
> > 
> > When I do:
> > 
> > c:\stat\r\rw2000\bin\Rcmd install --docs=normal --build
> > --library=c:\stat\R\bxc\library c:\stat\R\bxc\library.sources\xx
> 
> [moved to R-devel]
> 
> Works with forward slashes as follows:
> 
>   c:\stat\r\rw2000\bin\Rcmd install --docs=normal --build
>   --library=c:\stat\R\bxc\library c:/stat/R/bxc/library.sources/xx
> 
> The seems to be related with the more recent threads
> "Re: [Rd] wishlist: better error message in R CMD check"
> "[Rd] creating a package without lazy loading"
> on R-devel.
> 
> I'll try to debug.

I have a fix in R-patched for this: it seems highly dependent on the
version of the tools in use.

For rw2000, do avoid

- spaces in the path to the package sources
- backslashes in the path to the package sources

Both were warned against, of course.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sun Nov  7 19:22:47 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Nov  7 19:22:55 2004
Subject: [Rd] RFC install.packages() changes
Message-ID: <Pine.LNX.4.44.0411071800100.27394-100000@gannet.stats>

install/update.packages() in R-devel has been enhanced in a few ways,
notably to handle multiple repositories, and to allow packages to be 
reinstalled under the current version of R.

1) Currently they will ask if you want to delete the downloaded files (if 
any) *provided* destdir was not specified.  In that case it uses a 
subdirectory of the per-session temporary directory, so the files will be 
deleted at the end of the R session anyway.

We had a request to make the questioning optional.  I propose to remove it 
altogether, and either

a) delete the downloaded files at the end of install.packages or
b) leave them in the per-session directory to be deleted at the end of the 
session.

that is to force answer 'y' or 'n' respectively.  Does anyone see any 
problems with a)?


2) ?packageStatus says

     Summarize information about installed packages and packages
     available at various repositories, and automatically upgrade
     outdated packages. These tools will replace 'update.packages' and
     friends in the future and are currently work in progress.

but `progress' seems to have been at a halt for a long time.  The one
feature I use it for is finding non-installed packages, and we could
easily add a function non_installed.packages() and an option to
install.packages() to add (selectively) uninstalled packages (and a stop
list might be useful, so you do not get repeatedly asked about packages
which fail).

Do people use it, and if so for what purposes and what improvements would 
they like?  (I am thinking of, e.g, ways to extract parts of the output.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Sun Nov  7 19:56:36 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov  7 19:56:47 2004
Subject: [Rd] RFC install.packages() changes
References: <Pine.LNX.4.44.0411071800100.27394-100000@gannet.stats>
Message-ID: <loom.20041107T195337-37@post.gmane.org>

Prof Brian Ripley <ripley <at> stats.ox.ac.uk> writes:

: install/update.packages() in R-devel has been enhanced in a few ways,
: notably to handle multiple repositories, and to allow packages to be 
: reinstalled under the current version of R.

The change to updating that I would like would be to check before 
downloading whether the package is open.  Right now using the 
update menu item in Windows it checks afterwards 
and if its open fails which means that one has to do the download all
over again.  If it failed before downloading it would save some
wasted downloads.

From ggrothendieck at myway.com  Sun Nov  7 20:03:44 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov  7 20:03:59 2004
Subject: [Rd] RFC install.packages() changes
References: <Pine.LNX.4.44.0411071800100.27394-100000@gannet.stats>
	<loom.20041107T195337-37@post.gmane.org>
Message-ID: <loom.20041107T200139-22@post.gmane.org>

Gabor Grothendieck <ggrothendieck <at> myway.com> writes:

: 
: Prof Brian Ripley <ripley <at> stats.ox.ac.uk> writes:
: 
: : install/update.packages() in R-devel has been enhanced in a few ways,
: : notably to handle multiple repositories, and to allow packages to be 
: : reinstalled under the current version of R.
: 
: The change to updating that I would like would be to check before 
: downloading whether the package is open.  Right now using the 
: update menu item in Windows it checks afterwards 
: and if its open fails which means that one has to do the download all
: over again.  If it failed before downloading it would save some
: wasted downloads.

While we are on this topic, when I choose Update from the Windows menu recently
on R 2.0.0 on XP I get the following which I have never seen before.
I am just ignoring these warning messages but am not sure if I should
take notice.

R> update.packages()
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 22605 bytes
opened URL
downloaded 22Kb

Warning messages: 
1: DESCRIPTION file of package  'file2540'  missing or broken
 in: packageDescription(p, lib = lib, fields = pkgFlds) 
2: number of columns of result
        not a multiple of vector length (arg 2) in: rbind(retval, c(p, lib, 
desc))

From p.murrell at auckland.ac.nz  Sun Nov  7 20:48:29 2004
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Sun Nov  7 20:48:27 2004
Subject: [Rd] idea (PR#7345)
References: <20041105121805.3989110FA2@slim.kubism.ku.dk>	<418B7AC7.8000103@statistik.uni-dortmund.de>	<2E19048A-2F76-11D9-A082-000D93C24D64@stat.harvard.edu>
	<md8oo0dmfd6hlnr3a89jd2osagevs192ln@4ax.com>
Message-ID: <418E7C0D.3080009@stat.auckland.ac.nz>

Hi


Duncan Murdoch wrote:
> On Fri, 5 Nov 2004 14:01:01 -0800, Byron Ellis
> <ellis@stat.harvard.edu> wrote:
> 
> 
>>The most obvious, and by far most difficult route, would be to make 
>>graphics devices first class citizens (IIRC Duncan TL has brought this 
>>up elsewhere) wherein you would aDev <- edit(aDev). That brings things 
>>to the device level (what you want) and a static device could act 
>>accordingly (i.e. not invoke a redraw). Obviously the most difficult as 
>>it would be a massive upheaval of base graphics (I suppose all of this 
>>could all be grouped under a category of "event-based streams," 
>>graphics events, XML SAX events, file events--aka connections, etc. 
>>Doesn't CL or Scheme have something along those lines?). But, as 
>>mentioned in the thread, pretty speculative but you never can tell what 
>>someone might hunker down and implement :-)
> 
> 
> Take a look at grid.  I think it's more likely something like this
> would be built on top of grid than on top of base graphics.
> 
> Or, if you want to try it:
> 
> Take a look at grid.  I think you'll find it a lot easier starting
> there than starting with base graphics.


Grid provides graphical objects to work with and there are a couple of 
ways to create a GUI front-end.

See, for example, RGrace (http://www.hppi.troitsk.ru/Kondrin/rgrace.htm)

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From kjetil at acelerate.com  Sun Nov  7 19:52:59 2004
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Sun Nov  7 20:59:18 2004
Subject: [Rd] RFC install.packages() changes
In-Reply-To: <Pine.LNX.4.44.0411071800100.27394-100000@gannet.stats>
References: <Pine.LNX.4.44.0411071800100.27394-100000@gannet.stats>
Message-ID: <418E6F0B.8060000@acelerate.com>

Prof Brian Ripley wrote:

>install/update.packages() in R-devel has been enhanced in a few ways,
>notably to handle multiple repositories, and to allow packages to be 
>reinstalled under the current version of R.
>
>1) Currently they will ask if you want to delete the downloaded files (if 
>any) *provided* destdir was not specified.  In that case it uses a 
>subdirectory of the per-session temporary directory, so the files will be 
>deleted at the end of the R session anyway.
>
>We had a request to make the questioning optional.  I propose to remove it 
>altogether, and either
>
>a) delete the downloaded files at the end of install.packages or
>b) leave them in the per-session directory to be deleted at the end of the 
>session.
>
>that is to force answer 'y' or 'n' respectively.  Does anyone see any 
>problems with a)?
>
>  
>
I would prefer b), as I am downloading from the Rgui menu and then moves 
downloaded packages
to a c:\download... area which I use to burn CD-roms I distribute to 
many people. If  a) is choosen I guess
I could learn to use it from the command line, though. What is the 
problem with b)?

Kjetil

>2) ?packageStatus says
>
>     Summarize information about installed packages and packages
>     available at various repositories, and automatically upgrade
>     outdated packages. These tools will replace 'update.packages' and
>     friends in the future and are currently work in progress.
>
>but `progress' seems to have been at a halt for a long time.  The one
>feature I use it for is finding non-installed packages, and we could
>easily add a function non_installed.packages() and an option to
>install.packages() to add (selectively) uninstalled packages (and a stop
>list might be useful, so you do not get repeatedly asked about packages
>which fail).
>
>Do people use it, and if so for what purposes and what improvements would 
>they like?  (I am thinking of, e.g, ways to extract parts of the output.)
>
>  
>


-- 

Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra

From ripley at stats.ox.ac.uk  Sun Nov  7 21:02:14 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Nov  7 21:02:25 2004
Subject: [Rd] RFC install.packages() changes
In-Reply-To: <418E6F0B.8060000@acelerate.com>
Message-ID: <Pine.LNX.4.44.0411072000220.27802-100000@gannet.stats>

On Sun, 7 Nov 2004, Kjetil Brinchmann Halvorsen wrote:

> Prof Brian Ripley wrote:
> 
> >install/update.packages() in R-devel has been enhanced in a few ways,
> >notably to handle multiple repositories, and to allow packages to be 
> >reinstalled under the current version of R.
> >
> >1) Currently they will ask if you want to delete the downloaded files (if 
> >any) *provided* destdir was not specified.  In that case it uses a 
> >subdirectory of the per-session temporary directory, so the files will be 
> >deleted at the end of the R session anyway.
> >
> >We had a request to make the questioning optional.  I propose to remove it 
> >altogether, and either
> >
> >a) delete the downloaded files at the end of install.packages or
> >b) leave them in the per-session directory to be deleted at the end of the 
> >session.
> >
> >that is to force answer 'y' or 'n' respectively.  Does anyone see any 
> >problems with a)?
> >
> >  
> >
> I would prefer b), as I am downloading from the Rgui menu and then moves 
> downloaded packages
> to a c:\download... area which I use to burn CD-roms I distribute to 
> many people. If  a) is choosen I guess
> I could learn to use it from the command line, though. What is the 
> problem with b)?

Potentially leaving 1Gb or so of files in a temporary directory. So 
probably no big deal.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From andy_liaw at merck.com  Sun Nov  7 21:27:57 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Sun Nov  7 21:28:32 2004
Subject: [Rd] RFC install.packages() changes
Message-ID: <3A822319EB35174CA3714066D590DCD50994E296@usrymx25.merck.com>

> From: Prof Brian Ripley
> 
> On Sun, 7 Nov 2004, Kjetil Brinchmann Halvorsen wrote:
> 
> > Prof Brian Ripley wrote:
> > 
> > >install/update.packages() in R-devel has been enhanced in 
> a few ways,
> > >notably to handle multiple repositories, and to allow 
> packages to be 
> > >reinstalled under the current version of R.
> > >
> > >1) Currently they will ask if you want to delete the 
> downloaded files (if 
> > >any) *provided* destdir was not specified.  In that case it uses a 
> > >subdirectory of the per-session temporary directory, so 
> the files will be 
> > >deleted at the end of the R session anyway.
> > >
> > >We had a request to make the questioning optional.  I 
> propose to remove it 
> > >altogether, and either
> > >
> > >a) delete the downloaded files at the end of install.packages or
> > >b) leave them in the per-session directory to be deleted 
> at the end of the 
> > >session.
> > >
> > >that is to force answer 'y' or 'n' respectively.  Does 
> anyone see any 
> > >problems with a)?
> > >
> > >  
> > >
> > I would prefer b), as I am downloading from the Rgui menu 
> and then moves 
> > downloaded packages
> > to a c:\download... area which I use to burn CD-roms I 
> distribute to 
> > many people. If  a) is choosen I guess
> > I could learn to use it from the command line, though. What is the 
> > problem with b)?
> 
> Potentially leaving 1Gb or so of files in a temporary directory. So 
> probably no big deal.

My personal preference would be a).  Kjetil's usage seems like a bit of an
abuse, and one should be able to write something that does that specific
task (e.g., modify update.packages() to something called
download.packages()), rather than relying on a function in R that's meant
for something else.  

One thing that concerns me a bit (I haven't check whether the concern is
warranted) is package dependency:  If the new version of a package on CRAN
requires, e.g., a newer version of R than what the user has, what happens
then?

Andy

 
> Brian
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From mase at is.titech.ac.jp  Mon Nov  8 08:05:18 2004
From: mase at is.titech.ac.jp (mase@is.titech.ac.jp)
Date: Mon Nov  8 08:05:26 2004
Subject: [Rd] Possible bug in read.fwf (PR#7350)
Message-ID: <20041108070518.69947EAC3@slim.kubism.ku.dk>

Full_Name: Shigeru Mase
Version: R 1.9.1 and 2.0.0
OS: Debian Linux
Submission from: (NULL) (219.35.150.115)


I tried to read the following text file "test.txt" with 5 lines using 
read.fwf() function:

# comment 1
1234567   # comment 2
1 234567  # comment 3
12345  67 # comment 4
# comment 5

In R 1.9.1, I got the following result (since I have R 2.0.0 installed now 
I cannot reproduce it now but, at least, my former record says so):

> (x <- read.fwf("test.txt", width=c(2,2,3), skip=1, n=4))
   V1 V2  V3
 1 12 34 567
 2  1 23 456
 3 12 34   5

But, in R 2.0.0, the above command seems to run into endless loop, giving no
response. On the other hand, 

> (x <- read.fwf("test.txt", width=c(2,2,3), skip=1))
  V1 V2  V3
1  1 23 456   # skipped first 2 lines
2 12 34   5   # skipped the last comment line

By the way, the following gave the intended result, but skip the last
comment line:

> (x <- read.fwf("test.txt", width=c(2,2,3), skip=0))
  V1 V2  V3
1 12 34 567
2  1 23 456
3 12 34   5

I have been puzzled and, seemingly, I could not find particular indications
of relevent changes in the help document. I searched relevent bug reports on
this site but seems there are none. I got the same behaviour report from a user
of R 2.0.0 under MS Windows XP.

From ripley at stats.ox.ac.uk  Mon Nov  8 08:08:56 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Nov  8 08:09:05 2004
Subject: [Rd] RFC install.packages() changes
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E296@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.44.0411080706370.28532-100000@gannet.stats>

On Sun, 7 Nov 2004, Liaw, Andy wrote:

> One thing that concerns me a bit (I haven't check whether the concern is
> warranted) is package dependency:  If the new version of a package on CRAN
> requires, e.g., a newer version of R than what the user has, what happens
> then?

You are not offered a choice of updating.  That needs documenting.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Nov  8 09:20:24 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon Nov  8 09:20:37 2004
Subject: [Rd] Possible bug in read.fwf (PR#7350)
Message-ID: <20041108082024.EB67BEAC3@slim.kubism.ku.dk>

There are two bugs, due to problems in this change (a version of which is
in NEWS).

r30192 2004-07-08 04:05:38 +0100 (Thu, 08 Jul 2004)

multiline records, skipped columns in read.fwf.  Added read.fortran for
fixed format specifications like 3F4.2.

1) If left with 0 lines to read, read.fwf loops away.  
2) 'skip' is passed on to read.table, but the skipped lines have been 
removed.

Fixed for 2.0.1.

On Mon, 8 Nov 2004 mase@is.titech.ac.jp wrote:

> Full_Name: Shigeru Mase
> Version: R 1.9.1 and 2.0.0
> OS: Debian Linux
> Submission from: (NULL) (219.35.150.115)
> 
> 
> I tried to read the following text file "test.txt" with 5 lines using 
> read.fwf() function:
> 
> # comment 1
> 1234567   # comment 2
> 1 234567  # comment 3
> 12345  67 # comment 4
> # comment 5
> 
> In R 1.9.1, I got the following result (since I have R 2.0.0 installed now 
> I cannot reproduce it now but, at least, my former record says so):
> 
> > (x <- read.fwf("test.txt", width=c(2,2,3), skip=1, n=4))
>    V1 V2  V3
>  1 12 34 567
>  2  1 23 456
>  3 12 34   5
> 
> But, in R 2.0.0, the above command seems to run into endless loop, giving no
> response. On the other hand, 
> 
> > (x <- read.fwf("test.txt", width=c(2,2,3), skip=1))
>   V1 V2  V3
> 1  1 23 456   # skipped first 2 lines
> 2 12 34   5   # skipped the last comment line
> 
> By the way, the following gave the intended result, but skip the last
> comment line:
> 
> > (x <- read.fwf("test.txt", width=c(2,2,3), skip=0))
>   V1 V2  V3
> 1 12 34 567
> 2  1 23 456
> 3 12 34   5

That's correct: comment lines are skipped, and that is what 1.9.1 did.

> I have been puzzled and, seemingly, I could not find particular indications
> of relevent changes in the help document. I searched relevent bug reports on
> this site but seems there are none. I got the same behaviour report from a user
> of R 2.0.0 under MS Windows XP.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Mon Nov  8 10:36:42 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Nov  8 10:36:50 2004
Subject: [Rd] boxplot() defaults {was "boxplot in extreme cases"}
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E29C@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD50994E29C@usrymx25.merck.com>
Message-ID: <16783.15914.413329.766502@gargle.gargle.HOWL>


    AndyL> Try:

    AndyL> x <- list(x1=rep(c(0,1,2),c(10,20,40)), x2=rep(c(0,1,2),c(10,40,20)))
    AndyL> boxplot(x, pars=list(medpch=20, medcex=3))

    AndyL> (Cf ?bxp, pointed to from ?boxplot.)

Good! Thank you, Andy.

However,
this is not the first time it had crossed my mind that R's
default settings of drawing boxplot()s are not quite ok -- and
that's why I've diverted to R-devel.

Keeping Tufte's considerations in mind, (and me not really wanting
to follow S-plus), shouldn't we consider to slightly change R's
boxplot()ing such that

   boxplot(list(x1=rep(c(0,1,2),c(10,20,40)), x2=rep(c(0,1,2),c(10,40,20))))

will *not* give too identically looking boxplots?
Also, the median should be emphasized more by default anyway.
{The lattice function  bwplot() does it by only drawing a large
 black ball as in Andy's example (and not drawing a line at all)}

One possibility I'd see is to use a default 'medlwd = 3'
either in boxplot() or in bxp(.) and hence, what you currently get by

   boxplot(list(x1=rep(c(0,1,2),c(10,20,40)), x2=rep(c(0,1,2),c(10,40,20))),
           medlwd=3)

would become the default plotting in boxplot().
Of course a smaller value "medlwd=2" would work too, but I'd
prefer a bit more (3).

Martin


> From: Erich Neuwirth
> 
> I noticed the following:
> the 2 datasets
> rep(c(0,1,2),c(10,20,40)) and
> rep(c(0,1,2),c(10,40,20))
> produce identical boxplots despite the fact that the medians are 
> different. The reason is that the median in one case 
> coincides with the
> first quartile, and in the second case with the third quartile.
> Is there a recommended way of displaying the median visibly in these 
> cases? Setting notch=TRUE displays the median, but does look strange.

From beebe at math.utah.edu  Mon Nov  8 19:41:11 2004
From: beebe at math.utah.edu (beebe@math.utah.edu)
Date: Mon Nov  8 19:41:21 2004
Subject: [Rd] Comments on the R-2.0.0 release (PR#7351)
Message-ID: <20041108184111.C3456F18D@slim.kubism.ku.dk>

Builds of the R-2.0.0 release have been considerably more successful
at my site than previous releases.  I now have it installed on these
platforms:

	Apple PowerPC G3 267MHz	GNU/Linux 2.4.19-4a (Yellow Dog Linux release 2.3 (Dayton))
	Compaq Alpha Sierra	OSF/1 5.1
	Compaq/DEC Alpha	OSF/1 4.0F
	Intel Itanium-2		GNU/Linux Red Hat Linux Advanced Server release 2.1AS (Derry)
	Intel Pentium II	FreeBSD 4.4-RELEASE #0
	Intel Pentium III	FreeBSD 5.0
	Intel Pentium III	GNU/Linux 2.4.18-26.8.0smp (Red Hat 8.0 (Psyche))
	Intel Pentium III	GNU/Linux 2.4.21-20.ELsmp (Red Hat Enterprise Linux WS release 3 (Taroon Update 3))
	Intel Pentium III	NetBSD 1.6
	Intel Pentium III	OpenBSD 3.2
	Intel Pentium III	Solaris 9 x86
	SGI Origin 200		IRIX 6.5
	Sun SPARC		GNU/Linux 2.2.19-6.2.1 (Red Hat 6.2)
	Sun SPARC		Solaris 2.7
	Sun SPARC		Solaris 2.8
	Sun SPARC		Solaris 2.9

However, builds initially failed on several of these systems because
of errors like this:

	/usr/bin/ld: cannot find -lX11

On these systems, I was able to restart the build with

	make LDFLAGS=-L/usr/X11R6/lib

and have it complete successfully.  I've recently seen some other
packages that failed to compile for the same reason: the list of
standard locations that is searched at configure time for X11
libraries is out-of-date.  The R-2.0.0 configure.ac script has this
snippet:

	for dir in /usr/bin/X11 /usr/X11R6/bin /usr/openwin/bin; do
	  r_xtra_path="${r_xtra_path}${PATH_SEPARATOR}${dir}"
	done

However, it does not seem to have an analogue for the corresponding
lib directory.

Also, on some systems, I had to switch from using the native C/C++
compilers to GNU gcc/g++.

R-2.0.0 has failed to build on these systems:

	Apple PowerPC G4 1.4GHz	Darwin 7.3.0 (MacOS 10.3.2 (7D26))
	SGI Indy-200		GNU/Linux Gentoo 1.4.16
	IBM PowerPC		AIX 4.2

On the MacOS 10 system, builds with the native cc (== gcc 3.3
20030304) and with the latest gcc-3.4.3 fail like this:

	gcc -dynamiclib -L/usr/local/lib -dynamiclib -install_name libR.dylib \
		-compatibility_version 2.0.0 -current_version 2.0.0 \
		-headerpad_max_install_names -framework Carbon -o libR.dylib \
		Rembedded.lo CConverters.lo CommandLineArgs.lo Rdynload.lo Renviron.lo \
		RNG.lo apply.lo arithmetic.lo apse.lo array.lo attrib.lo base.lo \
		bind.lo builtin.lo character.lo coerce.lo colors.lo complex.lo \
		connections.lo context.lo cov.lo cum.lo dcf.lo datetime.lo debug.lo \
		devPS.lo devPicTeX.lo deparse.lo deriv.lo devices.lo dotcode.lo \
		dounzip.lo dstruct.lo duplicate.lo engine.lo envir.lo errors.lo \
		eval.lo format.lo fourier.lo gram.lo gram-ex.lo graphics.lo \
		identical.lo internet.lo iosupport.lo lapack.lo list.lo logic.lo \
		main.lo mapply.lo match.lo memory.lo model.lo names.lo objects.lo \
		optim.lo optimize.lo options.lo par.lo paste.lo pcre.lo platform.lo \
		plot.lo plot3d.lo plotmath.lo print.lo printarray.lo printvector.lo \
		printutils.lo qsort.lo random.lo regex.lo registration.lo relop.lo \
		saveload.lo scan.lo seq.lo serialize.lo size.lo sort.lo source.lo \
		split.lo sprintf.lo startup.lo subassign.lo subscript.lo subset.lo \
		summary.lo sysutils.lo unique.lo util.lo version.lo vfonts.lo xxxpr.lo \
		`ls ../appl/*.lo ../nmath/*.lo ../unix/*.lo 2>/dev/null` -lblas \
		-L/usr/local/lib \
		-L/export/local/powerpc-macosx/bin/../lib/gcc/powerpc-apple-darwin7.5.0/3.4.2 \
		-L/export/local/powerpc-macosx/bin/../lib/gcc \
		-L/usr/local/lib/gcc/powerpc-apple-darwin7.5.0/3.4.2 \
		-L/export/local/powerpc-macosx/bin/../lib/gcc/powerpc-apple-darwin7.5.0/3.4.2/../../..  \
		-L/usr/local/lib/gcc/powerpc-apple-darwin7.5.0/3.4.2/../../.. -lfrtbegin \
		-lg2c -lgcc_s -lSystem ../extra/zlib/libz.a ../extra/bzip2/libbz2.a \
		../extra/pcre/libpcre.a -lreadline -lcc_dynamic -lncurses -lm \
		-lcc_dynamic \
	gcc: Carbon: No such file or directory

On the GNU/Linux MIPS system, there is as yet no working Fortran
compiler, and f2c fails to build there, so R cannot be expected to
run.

On the IBM AIX system, I get this failure:

	gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall \
		-Wl,-bI:../../../etc/R.exp -Wl,-L/usr/local/lib \
		-Wl,-bE:../../../etc/Rlapack.exp -o libRlapack.so dlamc.lo \
		dlapack0.lo dlapack1.lo dlapack2.lo dlapack3.lo cmplx.lo \
		cmplxblas.lo \
		-L/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3 \
		-L/usr/local/powerpc-ibm-aix4.2.1.0/lib -L/usr/local/lib -lg2c \
		-lm \
		/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3/libgcc.a \
		-lg
	ld: 0711-224 WARNING: Duplicate symbol: .lsame_
	ld: 0711-224 WARNING: Duplicate symbol: lsame_
	ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information.
	make[4]: Leaving directory `/local/build/R-2.0.0/src/modules/lapack'

	...

	gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall \
		-Wl,-bI:../../../etc/R.exp -Wl,-L/usr/local/lib -o lapack.so \
		-Wl,-bI:../../../etc/Rlapack.exp Lapack.lo rgeev.lo rsyev.lo \
		-L../../../lib -lRlapack \
		-L/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3 \
		-L/usr/local/powerpc-ibm-aix4.2.1.0/lib -L/usr/local/lib -lg2c -lm \
		/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3/libgcc.a -lg \
		-lreadline -ldl -lncurses -lm -lc \
		ld: 0706-006 Cannot find or open library file: -l Rlapack \
		ld:open(): No such file or directory
		collect2: ld returned 255 exit status
		make[4]: Leaving directory `/local/build/R-2.0.0/src/modules/lapack'

Shared libraries (*.so) are uncommon on AIX 4.2; there are none at all
in /usr/lib or /lib or /usr/lpp/X11/lib/, and only a few locally-added
ones in /usr/local/lib.

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- University of Utah                    FAX: +1 801 581 4148                  -
- Department of Mathematics, 110 LCB    Internet e-mail: beebe@math.utah.edu  -
- 155 S 1400 E RM 233                       beebe@acm.org  beebe@computer.org -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -

From edd at debian.org  Mon Nov  8 20:29:48 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon Nov  8 20:30:02 2004
Subject: [Rd] Comments on the R-2.0.0 release (PR#7351)
In-Reply-To: <20041108184111.C3456F18D@slim.kubism.ku.dk>
References: <20041108184111.C3456F18D@slim.kubism.ku.dk>
Message-ID: <20041108192948.GA13273@sonny.eddelbuettel.com>

Nelson,

That is an impressive list of successes.

On Mon, Nov 08, 2004 at 07:41:11PM +0100, beebe@math.utah.edu wrote:
[...]
> 	SGI Indy-200		GNU/Linux Gentoo 1.4.16
[...]
> On the GNU/Linux MIPS system, there is as yet no working Fortran
> compiler, and f2c fails to build there, so R cannot be expected to
> run.

We have that working under Debian using our standard g77 builds. Logs for
mips (and mipsel) since R 1.4.0:

   http://buildd.debian.org/build.php?pkg=r-base&arch=mips
   http://buildd.debian.org/build.php?pkg=r-base&arch=mipsel

I could of course be off-base here if that particular Indy model uses a
different cpu -- apologies if that is the case.

Without the trailing &arch=mips(el), it will list logs for all arches.

Dirk


-- 
If your hair is standing up, then you are in extreme danger.
      -- http://www.usafa.af.mil/dfp/cockpit-phys/fp1ex3.htm

From stefano.iacus at unimi.it  Mon Nov  8 20:43:52 2004
From: stefano.iacus at unimi.it (stefano iacus)
Date: Mon Nov  8 20:44:06 2004
Subject: [Rd] Comments on the R-2.0.0 release (PR#7351)
In-Reply-To: <20041108184111.C3456F18D@slim.kubism.ku.dk>
References: <20041108184111.C3456F18D@slim.kubism.ku.dk>
Message-ID: <84816256-31BE-11D9-BC45-000A95C87F66@unimi.it>


On Nov 8, 2004, at 7:41 PM, beebe@math.utah.edu wrote:

> Builds of the R-2.0.0 release have been considerably more successful
> at my site than previous releases.  I now have it installed on these
> platforms:
>
> 	Apple PowerPC G3 267MHz	GNU/Linux 2.4.19-4a (Yellow Dog Linux release  
> 2.3 (Dayton))
> 	Compaq Alpha Sierra	OSF/1 5.1
> 	Compaq/DEC Alpha	OSF/1 4.0F
> 	Intel Itanium-2		GNU/Linux Red Hat Linux Advanced Server release  
> 2.1AS (Derry)
> 	Intel Pentium II	FreeBSD 4.4-RELEASE #0
> 	Intel Pentium III	FreeBSD 5.0
> 	Intel Pentium III	GNU/Linux 2.4.18-26.8.0smp (Red Hat 8.0 (Psyche))
> 	Intel Pentium III	GNU/Linux 2.4.21-20.ELsmp (Red Hat Enterprise Linux  
> WS release 3 (Taroon Update 3))
> 	Intel Pentium III	NetBSD 1.6
> 	Intel Pentium III	OpenBSD 3.2
> 	Intel Pentium III	Solaris 9 x86
> 	SGI Origin 200		IRIX 6.5
> 	Sun SPARC		GNU/Linux 2.2.19-6.2.1 (Red Hat 6.2)
> 	Sun SPARC		Solaris 2.7
> 	Sun SPARC		Solaris 2.8
> 	Sun SPARC		Solaris 2.9
>
> However, builds initially failed on several of these systems because
> of errors like this:
>
> 	/usr/bin/ld: cannot find -lX11
>
> On these systems, I was able to restart the build with
>
> 	make LDFLAGS=-L/usr/X11R6/lib
>
> and have it complete successfully.  I've recently seen some other
> packages that failed to compile for the same reason: the list of
> standard locations that is searched at configure time for X11
> libraries is out-of-date.  The R-2.0.0 configure.ac script has this
> snippet:
>
> 	for dir in /usr/bin/X11 /usr/X11R6/bin /usr/openwin/bin; do
> 	  r_xtra_path="${r_xtra_path}${PATH_SEPARATOR}${dir}"
> 	done
>
> However, it does not seem to have an analogue for the corresponding
> lib directory.
>
> Also, on some systems, I had to switch from using the native C/C++
> compilers to GNU gcc/g++.
>
> R-2.0.0 has failed to build on these systems:
>
> 	Apple PowerPC G4 1.4GHz	Darwin 7.3.0 (MacOS 10.3.2 (7D26))
> 	SGI Indy-200		GNU/Linux Gentoo 1.4.16
> 	IBM PowerPC		AIX 4.2
>
> On the MacOS 10 system, builds with the native cc (== gcc 3.3
> 20030304) and with the latest gcc-3.4.3 fail like this:
>

can you please tell us if you gcc-3.4.3 comes from? -framework Carbon,  
which causes the error apparently, should work (and it works for  
gcc-3.5).

gcc --v  ?

would be nice to know.
stefano


> 	gcc -dynamiclib -L/usr/local/lib -dynamiclib -install_name libR.dylib  
> \
> 		-compatibility_version 2.0.0 -current_version 2.0.0 \
> 		-headerpad_max_install_names -framework Carbon -o libR.dylib \
> 		Rembedded.lo CConverters.lo CommandLineArgs.lo Rdynload.lo  
> Renviron.lo \
> 		RNG.lo apply.lo arithmetic.lo apse.lo array.lo attrib.lo base.lo \
> 		bind.lo builtin.lo character.lo coerce.lo colors.lo complex.lo \
> 		connections.lo context.lo cov.lo cum.lo dcf.lo datetime.lo debug.lo \
> 		devPS.lo devPicTeX.lo deparse.lo deriv.lo devices.lo dotcode.lo \
> 		dounzip.lo dstruct.lo duplicate.lo engine.lo envir.lo errors.lo \
> 		eval.lo format.lo fourier.lo gram.lo gram-ex.lo graphics.lo \
> 		identical.lo internet.lo iosupport.lo lapack.lo list.lo logic.lo \
> 		main.lo mapply.lo match.lo memory.lo model.lo names.lo objects.lo \
> 		optim.lo optimize.lo options.lo par.lo paste.lo pcre.lo platform.lo \
> 		plot.lo plot3d.lo plotmath.lo print.lo printarray.lo printvector.lo \
> 		printutils.lo qsort.lo random.lo regex.lo registration.lo relop.lo \
> 		saveload.lo scan.lo seq.lo serialize.lo size.lo sort.lo source.lo \
> 		split.lo sprintf.lo startup.lo subassign.lo subscript.lo subset.lo \
> 		summary.lo sysutils.lo unique.lo util.lo version.lo vfonts.lo  
> xxxpr.lo \
> 		`ls ../appl/*.lo ../nmath/*.lo ../unix/*.lo 2>/dev/null` -lblas \
> 		-L/usr/local/lib \
> 		-L/export/local/powerpc-macosx/bin/../lib/gcc/powerpc-apple- 
> darwin7.5.0/3.4.2 \
> 		-L/export/local/powerpc-macosx/bin/../lib/gcc \
> 		-L/usr/local/lib/gcc/powerpc-apple-darwin7.5.0/3.4.2 \
> 		-L/export/local/powerpc-macosx/bin/../lib/gcc/powerpc-apple- 
> darwin7.5.0/3.4.2/../../..  \
> 		-L/usr/local/lib/gcc/powerpc-apple-darwin7.5.0/3.4.2/../../..  
> -lfrtbegin \
> 		-lg2c -lgcc_s -lSystem ../extra/zlib/libz.a ../extra/bzip2/libbz2.a \
> 		../extra/pcre/libpcre.a -lreadline -lcc_dynamic -lncurses -lm \
> 		-lcc_dynamic \
> 	gcc: Carbon: No such file or directory
>
> On the GNU/Linux MIPS system, there is as yet no working Fortran
> compiler, and f2c fails to build there, so R cannot be expected to
> run.
>
> On the IBM AIX system, I get this failure:
>
> 	gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall \
> 		-Wl,-bI:../../../etc/R.exp -Wl,-L/usr/local/lib \
> 		-Wl,-bE:../../../etc/Rlapack.exp -o libRlapack.so dlamc.lo \
> 		dlapack0.lo dlapack1.lo dlapack2.lo dlapack3.lo cmplx.lo \
> 		cmplxblas.lo \
> 		-L/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3 \
> 		-L/usr/local/powerpc-ibm-aix4.2.1.0/lib -L/usr/local/lib -lg2c \
> 		-lm \
> 		/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3/libgcc.a \
> 		-lg
> 	ld: 0711-224 WARNING: Duplicate symbol: .lsame_
> 	ld: 0711-224 WARNING: Duplicate symbol: lsame_
> 	ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more  
> information.
> 	make[4]: Leaving directory `/local/build/R-2.0.0/src/modules/lapack'
>
> 	...
>
> 	gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall \
> 		-Wl,-bI:../../../etc/R.exp -Wl,-L/usr/local/lib -o lapack.so \
> 		-Wl,-bI:../../../etc/Rlapack.exp Lapack.lo rgeev.lo rsyev.lo \
> 		-L../../../lib -lRlapack \
> 		-L/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3 \
> 		-L/usr/local/powerpc-ibm-aix4.2.1.0/lib -L/usr/local/lib -lg2c -lm \
> 		/usr/local/lib/gcc-lib/powerpc-ibm-aix4.2.1.0/2.95.3/libgcc.a -lg \
> 		-lreadline -ldl -lncurses -lm -lc \
> 		ld: 0706-006 Cannot find or open library file: -l Rlapack \
> 		ld:open(): No such file or directory
> 		collect2: ld returned 255 exit status
> 		make[4]: Leaving directory `/local/build/R-2.0.0/src/modules/lapack'
>
> Shared libraries (*.so) are uncommon on AIX 4.2; there are none at all
> in /usr/lib or /lib or /usr/lpp/X11/lib/, and only a few locally-added
> ones in /usr/local/lib.
>
> ----------------------------------------------------------------------- 
> --------
> - Nelson H. F. Beebe                    Tel: +1 801 581 5254            
>        -
> - University of Utah                    FAX: +1 801 581 4148            
>        -
> - Department of Mathematics, 110 LCB    Internet e-mail:  
> beebe@math.utah.edu  -
> - 155 S 1400 E RM 233                       beebe@acm.org   
> beebe@computer.org -
> - Salt Lake City, UT 84112-0090, USA    URL:  
> http://www.math.utah.edu/~beebe  -
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From wolski at molgen.mpg.de  Mon Nov  8 21:07:15 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Mon Nov  8 21:07:26 2004
Subject: [Rd] whishlist: legend - changing color of the boxes-border
Message-ID: <200411082107150807.11DBEB31@mail.math.fu-berlin.de>

Hi,

Drawing a legend I would like to be able to specify the color of boxes which are drawn if fill or density is specified.
eg.
legend(0,40000,c("raw","LR/PR-TPS"),fill=c(1,2),col=c(1,2),density=c(20,20),angle=c(-20,45),bty="n")

Currently the color of the boxes -- border is always black and can *not* be changed. To get this option only a *minimal* change is required.
Please consider the following code snipped copied from the function legend (package graphics).

The sensible line is marked by ###<-

 if (mfill) {
        if (plot) {
            fill <- rep(fill, length.out = n.leg)
            rect2(left = xt, top = yt + ybox/2, dx = xbox, dy = ybox, 
                col = fill, density = density, angle = angle, 
                border = "black")                                                          ####<--
        }
        xt <- xt + dx.fill
    }

Changing this line from 

border="black"
to 

border=col.

Will enable to specify the color of the boxes borders.

If specifying the colors by param _fill_ the parameter _col_ is not used anyway but still available and set already to black in the parameter declaration. Therefore why not use it to specify colors to borders of boxes?


Yours
/E





Dipl. bio-chem. Eryk Witold Wolski             @    MPI-Moleculare Genetic   
Ihnestrasse 63-73 14195 Berlin                'v'                            
tel: 0049-30-83875219                        /   \                           
mail: witek96@users.sourceforge.net        ---W-W----                        
http://r4proteomics.sourceforg.net

From gunter.berton at gene.com  Mon Nov  8 23:18:13 2004
From: gunter.berton at gene.com (gunter.berton@gene.com)
Date: Mon Nov  8 23:18:27 2004
Subject: [Rd] Teeny weeny bug (PR#7352)
Message-ID: <20041108221813.48EDAF0CA@slim.kubism.ku.dk>

 

R2.0.0 patched for Windows on Windows 2000, Rgui in SDI mode.
 
The "preselect" argument in select.list() is ignored.
 
Example: select.list(letters[1:3], preselect = 'a')
 
Cheers,
 
-- Bert Gunter
Genentech Non-Clinical Statistics
South San Francisco, CA
 
"The business of the statistician is to catalyze the scientific learning
process."  - George E. P. Box

From dethlef at math.aau.dk  Tue Nov  9 08:39:22 2004
From: dethlef at math.aau.dk (dethlef@math.aau.dk)
Date: Tue Nov  9 08:39:30 2004
Subject: [Rd] StructTS (PR#7353)
Message-ID: <20041109073922.F28E4EAC0@slim.kubism.ku.dk>

Dear R-bugs

I have been studying the StructTS function (in package 'stats') and
functions supplied with it. I think I have found a few minor bugs in the
documentation.

I am referring to the version of StructTS supplied with the release R 2.0.0.
Output from 'version'

platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    2              
minor    0.0            
year     2004           
month    10             
day      04             
language R              

1) In the help page under "fixed" it is explained (file:
R-2.0.0/src/library/stats/man/StructTS.Rd): 
  "If supplied, only non-\code{NA} entries in \code{fixed} will be varied."
  Either I misunderstand this or there may be a bug in the documentation. As
I understand it, setting fixed to the value, eg. c(NA,0,NA,NA) sets the
variance of the slope component to 0 and varies the other variances to find
the maximum likelihood estimates. If I am right, I suggest the docs changed
to:
  "If supplied, only \code{NA} entries in \code{fixed} will be varied."
  ("non-" has been deleted).

E.g. try the following after invoking R:

R> StructTS(log10(UKgas), type = "BSM", fixed=c(0,NA,NA,NA))

Observe, that the first variance is fixed to zero, while the remaining three
are varied to obtain the maximum likelihood estimates.

2) There is a minor typo in the explanation of 'fitted' - a parenthesis is
missing. I suggest changing
"(that is at time \eqn{t} and not at the end of the series."
to
"(that is at time \eqn{t} and not at the end of the series)."

3) In the documentation, one of the values returned in the list is called
"convergence", while in the code, it is called "code". I suggest either to
change the documentation from
"\item{convergence}{the value returned by \code{\link{optim}}.}"
to
"\item{code}{the value returned by \code{\link{optim}}.}"

or to change the code.


Thank you for supplying a great set of functions.

Best regards,
Claus
---------------------------------------------------------------------------
Assistant Prof. Claus Dethlefsen, PhD
Department of Mathematical Sciences, Aalborg University 
Fredrik Bajers Vej 7G, DK-9220 Aalborg, Denmark
dethlef@math.aau.dk; www.math.aau.dk/~dethlef
Ph: +45 9635 8878; Fax: +45 9815 8129



---

From maechler at stat.math.ethz.ch  Tue Nov  9 12:33:44 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue Nov  9 12:33:53 2004
Subject: [Rd] StructTS (PR#7353)
Message-ID: <20041109113344.7931FEABB@slim.kubism.ku.dk>

>>>>> "Claus" == Claus Dethlefsen <dethlef@math.aau.dk>
>>>>>     on Tue,  9 Nov 2004 08:39:22 +0100 (CET) writes:

    Claus> Dear R-bugs

(whom did you mean? :-)

    Claus> I have been studying the StructTS function (in
    Claus> package 'stats') and functions supplied with it. I
    Claus> think I have found a few minor bugs in the
    Claus> documentation.

    Claus> I am referring to the version of StructTS supplied with the release R 2.0.0.

    ....

    Claus> 1) In the help page under "fixed" it is explained (file:
    Claus> R-2.0.0/src/library/stats/man/StructTS.Rd): 

    Claus> "If supplied, only non-\code{NA} entries in
    Claus> \code{fixed} will be varied."

    Claus> Either I misunderstand this or there may be a bug in
    Claus> the documentation. As I understand it, setting fixed
    Claus> to the value, eg. c(NA,0,NA,NA) sets the variance of
    Claus> the slope component to 0 and varies the other
    Claus> variances to find the maximum likelihood
    Claus> estimates. If I am right, I suggest the docs changed
    Claus> to: "If supplied, only \code{NA} entries in
    Claus> \code{fixed} will be varied."  ("non-" has been
    Claus> deleted).

yes. thank you.  You are entirely correct.

    Claus> E.g. try the following after invoking R:

    R> StructTS(log10(UKgas), type = "BSM", fixed=c(0,NA,NA,NA))

    Claus> Observe, that the first variance is fixed to zero,
    Claus> while the remaining three are varied to obtain the
    Claus> maximum likelihood estimates.


    Claus> 2) There is a minor typo in the explanation of 'fitted' - a parenthesis is
    Claus> missing. I suggest changing
    Claus> "(that is at time \eqn{t} and not at the end of the series."
    Claus> to
    Claus> "(that is at time \eqn{t} and not at the end of the series)."

indeed, thank you.


    Claus> 3) In the documentation, one of the values returned in the list is called
    Claus> "convergence", while in the code, it is called "code". I suggest either to
    Claus> change the documentation from
    Claus> "\item{convergence}{the value returned by \code{\link{optim}}.}"
    Claus> to
    Claus> "\item{code}{the value returned by \code{\link{optim}}.}"

    Claus> or to change the code.

Changing the code has the potential to break other code relying on
StrucTS()   {and we are in deep-freeze for R 2.0.1}
--> I'm changing the documentation.


    Claus> Thank you for supplying a great set of functions.

and thank you for the bug report!
Martin Maechler, ETH Zurich

From ripley at stats.ox.ac.uk  Tue Nov  9 12:38:25 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov  9 12:38:34 2004
Subject: [Rd] Re: [R] Package Documentation, cryptic
In-Reply-To: <41909E87.2050509@wsl.ch>
Message-ID: <Pine.LNX.4.44.0411091129001.15723-100000@gannet.stats>

[Moved to R-devel: please check the posting guide.]

On Tue, 9 Nov 2004, Christian Hoffmann wrote:

Asking why things that are not documented do not work is unproductive, I 
believe.  Instead please tell us why you are not using the standard 
procedures.

> ------- Question:
> B) In which sections of *.Rd is LaTeX notation allowed, where *not*?

Only where documented, namely inside the first argument of \eqn{} and
\deqn{}, AFAIR.

> The relevant code snippets:
> /CWHstat/man/my.table.margin.Rd:
> \name{my.table}
> \alias{my.table.margin}
> \usage{
> my.table.margin(v,w)
> my.table.margin(m)
> }
> \arguments{
>    \item{v, w}{Factors.}
>    \item{m}{Matrix.}
> }
> 
> /CWHstat/man/my.table.margin.r:
> my.table.margin <- function(v, w) {
>        if (missing(w)) tab <- v else tab <- table(v, w)
> 
> C) ------- Question:
> How can I document this type of behaviour of polyvalent parameters 
> without "check" baulking at me?

The argument is `v': documenting it as `m' is incorrect.  You need

  \item{v}{factor or matrix.}
  \item{w}{factor.}

or better make `my.table.margin' generic with factor and matrix methods
(but still agreeing on their first argument).

> hoffmacw@fluke:~/R/Sources >cd CWHstat.Rcheck
> hoffmacw@fluke:~/R/Sources/CWHstat.Rcheck >cp ../Rd.sty .
> 
> E) *comment* copy is necessary, because each run of check destroys old 
> directory *.Rcheck, Is there a way around this? I cannot write to 
> $R_HOME/share.

Why do you need Rd.sty in there?  It works for 416 packages on CRAN with 
no such copy.  That's the cause of F), as you are trying to overwrite R's 
Rd.sty -- why?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Nov  9 13:10:47 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue Nov  9 13:11:00 2004
Subject: [Rd] Comments on the R-2.0.0 release (PR#7351)
Message-ID: <20041109121047.A1967FB8F@slim.kubism.ku.dk>

I don't see the bug report in here.  What is the bug you wished to report?
(That R requires some flags set on some platforms is documented in the 
R-admin manual, and not a bug.)

Comments are better sent to the mailing list, not the bug repository, as 
someone now has to decide what to do with this.

On Mon, 8 Nov 2004 beebe@math.utah.edu wrote:

> Builds of the R-2.0.0 release have been considerably more successful
> at my site than previous releases.  I now have it installed on these
> platforms:
> 
> 	Apple PowerPC G3 267MHz	GNU/Linux 2.4.19-4a (Yellow Dog Linux release 2.3 (Dayton))
> 	Compaq Alpha Sierra	OSF/1 5.1
> 	Compaq/DEC Alpha	OSF/1 4.0F
> 	Intel Itanium-2		GNU/Linux Red Hat Linux Advanced Server release 2.1AS (Derry)
> 	Intel Pentium II	FreeBSD 4.4-RELEASE #0
> 	Intel Pentium III	FreeBSD 5.0
> 	Intel Pentium III	GNU/Linux 2.4.18-26.8.0smp (Red Hat 8.0 (Psyche))
> 	Intel Pentium III	GNU/Linux 2.4.21-20.ELsmp (Red Hat Enterprise Linux WS release 3 (Taroon Update 3))
> 	Intel Pentium III	NetBSD 1.6
> 	Intel Pentium III	OpenBSD 3.2
> 	Intel Pentium III	Solaris 9 x86
> 	SGI Origin 200		IRIX 6.5
> 	Sun SPARC		GNU/Linux 2.2.19-6.2.1 (Red Hat 6.2)
> 	Sun SPARC		Solaris 2.7
> 	Sun SPARC		Solaris 2.8
> 	Sun SPARC		Solaris 2.9
> 
> However, builds initially failed on several of these systems because
> of errors like this:
> 
> 	/usr/bin/ld: cannot find -lX11
> 
> On these systems, I was able to restart the build with
> 
> 	make LDFLAGS=-L/usr/X11R6/lib
> 
> and have it complete successfully.  I've recently seen some other
> packages that failed to compile for the same reason: the list of
> standard locations that is searched at configure time for X11
> libraries is out-of-date.  The R-2.0.0 configure.ac script has this
> snippet:
> 
> 	for dir in /usr/bin/X11 /usr/X11R6/bin /usr/openwin/bin; do
> 	  r_xtra_path="${r_xtra_path}${PATH_SEPARATOR}${dir}"
> 	done
> 
> However, it does not seem to have an analogue for the corresponding
> lib directory.

That's because configure --help says

X features:
  --x-includes=DIR    X include files are in DIR
  --x-libraries=DIR   X library files are in DIR

so I think you omitted --x-libraries=/usr/X11R6/lib.
This is also documented in the R-admin manual.  


Note that including /usr/X11R6/lib would be rather dangerous, as on 64-bit
Linux systems the correct directory is (at least on ours)  
/usr/X11R6/lib64.  I believe all properly configured systems will have the
appropriate one of /usr/X11R6/lib64, /usr/X11R6/lib in the default library
path, but if not it will not be a good idea for R to start guessing.

[...]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From gunter.berton at gene.com  Tue Nov  9 19:23:49 2004
From: gunter.berton at gene.com (gunter.berton@gene.com)
Date: Tue Nov  9 19:24:04 2004
Subject: [Rd] RODBC bug or doc error in sqlFetch on xls files (PR#7354)
Message-ID: <20041109182349.3E493EABF@slim.kubism.ku.dk>

R 2.0.0 patched under win2000. MS Office Excel 2003. ODBC Drivers? 

This may not come as a surprise -- sqlFetch() (and perhaps other ?) appear
not to handle table/worksheet names with spaces in them in Excel tables. I
was not able to find documentation that specifically mentioned this,
although the Help pages vaguely hinted that there might be difficulty with
Excel's "peculiar handling" of table names. Anyway, here is a sequence of
actions that illustrate the issue.

> library(RODBC)

## connect to Excel file using dialog box
> z<-odbcConnectExcel()

## List the tables: "Success Rates" is the only worksheet there, of course
> sqlTables(z)
                                                      TABLE_CAT TABLE_SCHEM
1 C:\\Documents and Settings\\bgunter\\My Documents\\LRPdatacln        <NA>
2 C:\\Documents and Settings\\bgunter\\My Documents\\LRPdatacln        <NA>
3 C:\\Documents and Settings\\bgunter\\My Documents\\LRPdatacln        <NA>
                    TABLE_NAME TABLE_TYPE REMARKS
1             'Success Rates$'      TABLE    <NA>
2   'Success Rates$'Print_Area      TABLE    <NA>
3 'Success Rates$'Print_Titles      TABLE    <NA>


## The following give errors, although
## according to p.16 of manual, this should work:
> dat<-sqlFetch(z,"Success Rates")
Error in odbcTableExists(channel, sqtable) : 
        Success Rates : table not found on channel

## This only seemed to work ...
> dat<-sqlFetch(z,"'Success Rates$'")

## But
> dat
[1] "[RODBC] ERROR: Could not SQLExecDirect"

[2] "37000 -1002 [Microsoft][ODBC Excel Driver] ''Success Rates$'$' is not a
valid name. .. blah blah

 
When I removed the space from the sheet name -- "SuccessRates" -- all worked
smoothly as documented.

Cheers,
Bert

-- Bert Gunter
Genentech Non-Clinical Statistics
South San Francisco, CA
 
"The business of the statistician is to catalyze the scientific learning
process."  - George E. P. Box

From bgunter at gene.com  Tue Nov  9 22:09:10 2004
From: bgunter at gene.com (bgunter@gene.com)
Date: Tue Nov  9 22:09:18 2004
Subject: [Rd] colnames argument in sqlFetch backwards? (PR#7355)
Message-ID: <20041109210910.BE302EDE9@slim.kubism.ku.dk>

Full_Name: Bert Gunter
Version: 2.0.0 patched
OS: Win2000
Submission from: (NULL) (192.12.78.250)


The TRUE/FALSE options of the colnames argument in sqlFetch (RODBC) seem to be
reversed, at least for .xls files.

## z is a connection to an xls workbook opened by odbcConnectExcel()

> dat<-sqlFetch(z,'SuccessRates',colnames=FALSE)
> dat[1:5,]
  RecID     Name Run  Grams Lost Run (80L)
1    NA Activase 117 839.91              0
2    NA Activase 118 860.52              0
3    NA Activase 119 921.23              0
4    NA Activase  NA     NA              1
5    NA Activase 120 722.62              0

> dat2<-sqlFetch(z,'SuccessRates',colnames=TRUE)
> dat2[1:5,]
  NA Activase 117 839.91 0
2 NA Activase 118 860.52 0
3 NA Activase 119 921.23 0
4 NA Activase  NA     NA 1
5 NA Activase 120 722.62 0
6 NA Activase 121 762.48 0

I note also that the last column, "Lost Run (80L)," was actually TRUE/FALSE and
some blanks in the Excel sheet and was silently coerced to numeric. This is no
problem, of course, but I wonder if it's the intended behavior and, if so, is it
documented?

From ripley at stats.ox.ac.uk  Tue Nov  9 22:14:45 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue Nov  9 22:14:53 2004
Subject: [Rd] colnames argument in sqlFetch backwards? (PR#7355)
Message-ID: <20041109211445.13A01EB64@slim.kubism.ku.dk>

Do read the FAQ and stop abusing R-bugs in this way.
I did ask privately, but you have continued to ignore my request.

BDR

On Tue, 9 Nov 2004 bgunter@gene.com wrote:

> Full_Name: Bert Gunter
> Version: 2.0.0 patched
> OS: Win2000
> Submission from: (NULL) (192.12.78.250)
> 
> 
> The TRUE/FALSE options of the colnames argument in sqlFetch (RODBC) seem to be
> reversed, at least for .xls files.
> 
> ## z is a connection to an xls workbook opened by odbcConnectExcel()
> 
> > dat<-sqlFetch(z,'SuccessRates',colnames=FALSE)
> > dat[1:5,]
>   RecID     Name Run  Grams Lost Run (80L)
> 1    NA Activase 117 839.91              0
> 2    NA Activase 118 860.52              0
> 3    NA Activase 119 921.23              0
> 4    NA Activase  NA     NA              1
> 5    NA Activase 120 722.62              0
> 
> > dat2<-sqlFetch(z,'SuccessRates',colnames=TRUE)
> > dat2[1:5,]
>   NA Activase 117 839.91 0
> 2 NA Activase 118 860.52 0
> 3 NA Activase 119 921.23 0
> 4 NA Activase  NA     NA 1
> 5 NA Activase 120 722.62 0
> 6 NA Activase 121 762.48 0
> 
> I note also that the last column, "Lost Run (80L)," was actually TRUE/FALSE and
> some blanks in the Excel sheet and was silently coerced to numeric. This is no
> problem, of course, but I wonder if it's the intended behavior and, if so, is it
> documented?
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From vograno at evafunds.com  Wed Nov 10 02:36:32 2004
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed Nov 10 02:36:34 2004
Subject: [Rd] recursive default argument reference
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A5750FE8@phost015.EVAFUNDS.intermedia.net>

Hi,

It seems that a formal function argument can not default to an "outer"
variable of the same name:

> x <- "foo"
> ff <- function(x=x) x
> ff()
Error in ff() : recursive default argument reference
> 

Is this intentional? Why?

I use R-1.9.1.

Thanks,
Vadim

From andy_liaw at merck.com  Wed Nov 10 02:43:52 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Wed Nov 10 02:44:17 2004
Subject: [Rd] recursive default argument reference
Message-ID: <3A822319EB35174CA3714066D590DCD50994E2BF@usrymx25.merck.com>

> From: Vadim Ogranovich
> 
> Hi,
> 
> It seems that a formal function argument can not default to an "outer"
> variable of the same name:
> 
> > x <- "foo"

This is just a red herring...  Even w/o this you get the same thing:

> ff <- function(x=x) x
> ff()
Error in ff() : recursive default argument reference
> ff(x)
Error in ff(x) : Object "x" not found

Note how the two errors are different.

> > ff <- function(x=x) x
> > ff()
> Error in ff() : recursive default argument reference
> > 
> 
> Is this intentional? Why?

It should be, because R doesn't know what to make of it (and neither do I).
 
Cheers,
Andy

> I use R-1.9.1.
> 
> Thanks,
> Vadim
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From ggrothendieck at myway.com  Wed Nov 10 02:53:18 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Nov 10 02:53:29 2004
Subject: [Rd] recursive default argument reference
References: <C698D707214E6F4AB39AB7096C3DE5A5750FE8@phost015.EVAFUNDS.intermedia.net>
Message-ID: <loom.20041110T024809-978@post.gmane.org>

Vadim Ogranovich <vograno <at> evafunds.com> writes:

: 
: Hi,
: 
: It seems that a formal function argument can not default to an "outer"
: variable of the same name:
: 
: > x <- "foo"
: > ff <- function(x=x) x
: > ff()
: Error in ff() : recursive default argument reference
: > 
: 
: Is this intentional? Why?
: 

Because then one arg could not safely refer to another. Here
x has y as its default value:

   x <- 10
   y <- 7
   f <- function(x = y, y = 3) print(x)
   f() # prints 3

Note that you could do this:

   x <- "foo"
   ff <- function(x.=x) x.
   ff() # returns "foo"
   ff(x=44) # returns 44
   ff(55) # returns 55

For a real example look at merge.data.frame.

From vograno at evafunds.com  Wed Nov 10 03:07:04 2004
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed Nov 10 03:07:05 2004
Subject: [Rd] recursive default argument reference
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A5750FED@phost015.EVAFUNDS.intermedia.net>

Got it! Thanks to everyone for the help! Vadim 

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Gabor 
> Grothendieck
> Sent: Tuesday, November 09, 2004 5:53 PM
> To: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] recursive default argument reference
> 
> Vadim Ogranovich <vograno <at> evafunds.com> writes:
> 
> : 
> : Hi,
> : 
> : It seems that a formal function argument can not default to 
> an "outer"
> : variable of the same name:
> : 
> : > x <- "foo"
> : > ff <- function(x=x) x
> : > ff()
> : Error in ff() : recursive default argument reference
> : >
> : 
> : Is this intentional? Why?
> : 
> 
> Because then one arg could not safely refer to another. Here 
> x has y as its default value:
> 
>    x <- 10
>    y <- 7
>    f <- function(x = y, y = 3) print(x)
>    f() # prints 3
> 
> Note that you could do this:
> 
>    x <- "foo"
>    ff <- function(x.=x) x.
>    ff() # returns "foo"
>    ff(x=44) # returns 44
>    ff(55) # returns 55
> 
> For a real example look at merge.data.frame.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From znmeb at cesmail.net  Wed Nov 10 04:52:23 2004
From: znmeb at cesmail.net (M. Edward Borasky)
Date: Wed Nov 10 04:53:07 2004
Subject: [Rd] RODBC bug or doc error in sqlFetch on xls files (PR#7354)
In-Reply-To: <20041109182349.3E493EABF@slim.kubism.ku.dk>
References: <20041109182349.3E493EABF@slim.kubism.ku.dk>
Message-ID: <1100058743.7625.6.camel@6-allhosts>

On Tue, 2004-11-09 at 10:23, gunter.berton@gene.com wrote:
> R 2.0.0 patched under win2000. MS Office Excel 2003. ODBC Drivers? 
> 
> This may not come as a surprise -- sqlFetch() (and perhaps other ?) appear
> not to handle table/worksheet names with spaces in them in Excel tables. I
> was not able to find documentation that specifically mentioned this,
> although the Help pages vaguely hinted that there might be difficulty with
> Excel's "peculiar handling" of table names. Anyway, here is a sequence of
> actions that illustrate the issue.

IIRC the SQL Language standard specifically requires table and database names to 

a. start with a letter, 
b. contain nothing except letters and digits and the "underscore", and
c. be at most 31 characters long.

In other words, Excel is doing something that many other tools don't
support.

(and don't get me started on case (in)sensitivity.)

From ripley at stats.ox.ac.uk  Wed Nov 10 09:05:26 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 10 09:05:36 2004
Subject: [Rd] Re: [R] R works on Fedora Core 3
In-Reply-To: <20041109174442.GA27104@psych>
Message-ID: <Pine.LNX.4.44.0411100751480.14648-100000@gannet.stats>

[Moved to R-devel.]

On Tue, 9 Nov 2004, Jonathan Baron wrote:

> The RPM for Fedora Core 2 seems to work just fine on Core 3.

That's not what the subject line says, and is it really true? The RPM for
FC2 (I built one on x86_64, but I think it will be the same on your
unstated architecture) has gcc 3.3.3 hardwired, and FC3 does not have gcc
3.3.3 (but 3.4.2).  So does installing packages containing Fortran code
work `just fine'?  (I am not sure if an update to FC3 would have 3.3.3 
as well.)

Second problem: gcc 3.4.2 does not work `just fine': it has a pesky bug
that causes several CRAN packages to fail/give incorrect answers.  Now
Linux distros have a very nasty habit of distributing bug-enhanced
versions of major software, so this may be fixed in FC3 but in any case
gcc-3.4.3 is now out and a worthwhile upgrade.  (Apparently Mandrake
backported the bug to `3.4.1' ....)

I would recommend either installing from the sources or building from the
SRPM.  Hopefully by the end of the week we will have some i686 machines on
FC3 (only x86_64 so far) and so be able to make RPMs available.


> (The graphics window got smaller, but I'm sure there is a setting
> for that.)

If you mean the x11() device window, it should by default have a 7" square 
canvas.  If it does not, there is a bug in your X11 configuration (which 
would not at all surprise me, as so far none of my systems reports the ppi 
of the screen accurately, and some have been way off).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From john.maindonald at anu.edu.au  Wed Nov 10 10:08:32 2004
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Wed Nov 10 10:08:46 2004
Subject: [Rd] Formatting of times in time series objects
Message-ID: <1829981A-32F8-11D9-9B01-000A95CDA0F2@anu.edu.au>

Although print.ts() formats times pleasantly when it prints
regular multivariate time series (at least for suitable series)
(try e.g.
 > xy <- cbind(window(AirPassengers, end =1950), 1:11)
 > window(xy, end=1949)
           xy seqno
Jan 1949 112     1
)
I can find no immediate way to extract the pleasantly
formatted date.  I am wondering what plans there may be
to modify format() to provide a choice of formats for the times
in ts objects [presumably via as.Date(), rather than by code
such as in print.ts()], or if some other solution is in view.

John Maindonald             email: john.maindonald@anu.edu.au
phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
Centre for Bioinformation Science, Room 1194,
John Dedman Mathematical Sciences Building (Building 27)
Australian National University, Canberra ACT 0200.

From BRmultiaccess at rsinet.com.br  Wed Nov 10 11:14:03 2004
From: BRmultiaccess at rsinet.com.br (BRmultiaccess@rsinet.com.br)
Date: Wed Nov 10 10:13:14 2004
Subject: [Rd] =?iso-8859-1?q?=28BRMA=29_=5BSupTec_RSI=5D_Email_n=E3o_envi?=
	=?iso-8859-1?q?ado?=
Message-ID: <200411101014.iAAAE3a12768@rsinet.com.br>


[SupTec RSI] Email n?o enviado
----------------------------------------
Sua mensagem apresenta arquivo(s) anexo(s) que pela sua natureza podem conter programas potencialmente portadores de v?rus e, por este motivo tais arquivos n?o foram encaminhados ao destinat?rio. Infelizmente tal procedimento tornou-se necess?rio devido a atual onda de propaga??o de v?rus anexados a e-mails e distribu?dos de forma autom?tica e involunt?ria.
----------------------------------------
Para:  rh@rsinet.com.br
Assunto:  Re: message

From john.maindonald at anu.edu.au  Wed Nov 10 10:57:58 2004
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Wed Nov 10 10:58:11 2004
Subject: [Rd] Additions to the datasets package?
Message-ID: <004C3254-32FF-11D9-9B01-000A95CDA0F2@anu.edu.au>

I have posted, at http://wwwmaths.anu.edu.au/~john/r/newsets/
image (.rda) files, and first stabs at .Rd files for various data on
deaths in London from 1629 to 1939.  (There are of course gaps.)
The sources (Guy 1882 & Stocks 1942) are documented in the
.Rd files:
(1) poxetc: measles, smallpox & total deaths: 1629-1881
[I have deliberately left several inconsistencies that were
in Guy's published data.]
(2) measles: 1629-1939 [This includes the measles data from (1)]
(3) whooping cough; 1740-1881.

I had been planning to add these data to the DAAG package.
I wonder however there is interest in adding them to the
datasets package, as they seem to me data that may be of wide
interest.  Is that package now seen as closed to further additions,
or will additions continue from time to time?

There are a few other datasets in the same directory that anyone
interested is welcome to check out.
John Maindonald.

John Maindonald             email: john.maindonald@anu.edu.au
phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
Centre for Bioinformation Science, Room 1194,
John Dedman Mathematical Sciences Building (Building 27)
Australian National University, Canberra ACT 0200.

From ecnuxb at admin.ecnu.edu.cn  Wed Nov 10 11:03:18 2004
From: ecnuxb at admin.ecnu.edu.cn (ecnuxb)
Date: Wed Nov 10 11:03:31 2004
Subject: [Rd] Re: Mail System (ecnuxb@admin.ecnu.edu.cn)
Message-ID: <300082378.03419@webmail.ecnu.edu.cn>


????????????????

From ripley at stats.ox.ac.uk  Wed Nov 10 12:04:35 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 10 12:04:54 2004
Subject: [Rd] Additions to the datasets package?
In-Reply-To: <004C3254-32FF-11D9-9B01-000A95CDA0F2@anu.edu.au>
Message-ID: <Pine.LNX.4.44.0411101101260.14915-100000@gannet.stats>

On Wed, 10 Nov 2004, John Maindonald wrote:

> I have posted, at http://wwwmaths.anu.edu.au/~john/r/newsets/
> image (.rda) files, and first stabs at .Rd files for various data on
> deaths in London from 1629 to 1939.  (There are of course gaps.)
> The sources (Guy 1882 & Stocks 1942) are documented in the
> .Rd files:
> (1) poxetc: measles, smallpox & total deaths: 1629-1881
> [I have deliberately left several inconsistencies that were
> in Guy's published data.]
> (2) measles: 1629-1939 [This includes the measles data from (1)]
> (3) whooping cough; 1740-1881.
> 
> I had been planning to add these data to the DAAG package.
> I wonder however there is interest in adding them to the
> datasets package, as they seem to me data that may be of wide
> interest.  Is that package now seen as closed to further additions,
> or will additions continue from time to time?

I think only if examples are needed for methods in one of the standard 
packages (most likely stats).  The last time we added a substantial number 
of datasets was with the ts package.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Nov 10 12:08:59 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 10 12:09:10 2004
Subject: [Rd] Formatting of times in time series objects
In-Reply-To: <1829981A-32F8-11D9-9B01-000A95CDA0F2@anu.edu.au>
Message-ID: <Pine.LNX.4.44.0411101104420.14915-100000@gannet.stats>

On Wed, 10 Nov 2004, John Maindonald wrote:

> Although print.ts() formats times pleasantly when it prints
> regular multivariate time series (at least for suitable series)
> (try e.g.
>  > xy <- cbind(window(AirPassengers, end =1950), 1:11)

I get an error here, as I should.

>  > window(xy, end=1949)
>            xy seqno
> Jan 1949 112     1
> )
> I can find no immediate way to extract the pleasantly
> formatted date.  I am wondering what plans there may be
> to modify format() to provide a choice of formats for the times
> in ts objects [presumably via as.Date(), rather than by code
> such as in print.ts()], or if some other solution is in view.

No plans.  ts() objects do not in fact contain the times, just a tsp 
attribute, but it is easy enough to write code to get what you want.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From listproc at cornell.edu  Wed Nov 10 16:51:56 2004
From: listproc at cornell.edu (listproc@cornell.edu)
Date: Wed Nov 10 16:52:06 2004
Subject: [Rd] list COLA-L: List Message Rejected
Message-ID: <LPS0411101051.9712.1@cornell.edu>

Dear r-devel@r-project.org:

Your recent message to the COLA-L list has been
rejected for the following reason:

Only list subscribers may send messages to this list.

If you need assistance, please contact the list owner at 
COLA-L-request@cornell.edu

The text of your message follows:
----------------------------------------------------------------------
Received: from hermes30.mail.cornell.edu (hermes30.mail.cornell.edu [132.236.56.55])
	by elist02.mail.cornell.edu (8.12.10/8.12.9) with ESMTP id iAAFpm4Y009694
	for <COLA-L@elist02.mail.cornell.edu>; Wed, 10 Nov 2004 10:51:48 -0500 (EST)
Received: from filter02.mail.cornell.edu (filter02.mail.cornell.edu [132.236.56.28])
	by hermes30.mail.cornell.edu (8.12.10/8.12.6) with ESMTP id iAAFpnvv019070
	for <COLA-L@elist02.mail.cornell.edu>; Wed, 10 Nov 2004 10:51:49 -0500 (EST)
Received: (from daemon@localhost)
	by filter02.mail.cornell.edu (8.12.10/8.12.6) id iAAFpm6E016374
	for COLA-L@elist02.mail.cornell.edu; Wed, 10 Nov 2004 10:51:48 -0500 (EST)
Received: from r-project.org (ilrgrad2.ilr.cornell.edu [128.253.216.252])
	by filter02.mail.cornell.edu (8.12.10/8.12.6) with ESMTP id iAAFpkAH016275
	for <cola-l@cornell.edu>; Wed, 10 Nov 2004 10:51:47 -0500 (EST)
Received: from LIBKIOSK06.ilr.cornell.edu (LIBKIOSK06.ilr.cornell.edu [128.253.216.252]) 
	by cornell.edu (8.12.8p1/8.12.8) with ESMTP id i29N7Ert030278
	for <cola-l@cornell.edu>; Wed, 10 Nov 2004 10:51:46 -0500
	(envelope-from r-devel@r-project.org)
Message-Id: <000a01c4c713$45d01f70$fcd8fd80@LIBKIOSK06>
X-AntiVirus: scanned for viruses by AMaViS 0.2.1 (http://amavis.org/)
X-PH: V4.1@filter02
From: r-devel@r-project.org
To: cola-l@cornell.edu
Subject: Hey!
Date: Wed, 10 Nov 2004 10:51:46 -0500
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0007_01C4C713.45D01F70"
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2600.0000
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000
X-PMX-Version: 4.6.1.107272, Antispam-Core: 4.6.1.106808, Antispam-Data: 2004.11.10.0

This is a multi-part message in MIME format.

------=_NextPart_000_0007_01C4C713.45D01F70
Content-Type: text/html;
	charset="iso-8859-"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title></title>

</head>
<body text="#000000" bgcolor="#ffffcc" link="#000099"
 vlink="#990099"
 alink="#000099">

<i>Hi! I am looking for new friends.</i>
<p><i>My name is Jane, I am from Miami, FL. </i></p>
<p><i>See my <a href=3D"http://128.253.216.252:1639/index.htm">homepage</a>  with my weblog and last webcam
photos!</i></p>
<i>See you!</i>
<p><i><br>
<br>
</i></p>
<br>
</body>
</html>





------=_NextPart_000_0007_01C4C713.45D01F70--

From MSchwartz at MedAnalytics.com  Wed Nov 10 19:41:00 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Wed Nov 10 19:41:17 2004
Subject: [Rd] Re: [R] R works on Fedora Core 3
In-Reply-To: <Pine.LNX.4.44.0411100751480.14648-100000@gannet.stats>
References: <Pine.LNX.4.44.0411100751480.14648-100000@gannet.stats>
Message-ID: <1100112061.4793.14.camel@horizons.localdomain>

On Wed, 2004-11-10 at 08:05 +0000, Prof Brian Ripley wrote:
> [Moved to R-devel.]

> Second problem: gcc 3.4.2 does not work `just fine': it has a pesky bug
> that causes several CRAN packages to fail/give incorrect answers.  Now
> Linux distros have a very nasty habit of distributing bug-enhanced
> versions of major software, so this may be fixed in FC3 but in any case
> gcc-3.4.3 is now out and a worthwhile upgrade.  (Apparently Mandrake
> backported the bug to `3.4.1' ....)
> 
> I would recommend either installing from the sources or building from the
> SRPM.  Hopefully by the end of the week we will have some i686 machines on
> FC3 (only x86_64 so far) and so be able to make RPMs available.

I am finally up and running on FC3 this morning. Took a while to
download the DVD ISO via Bittorrent...

Using:

# gcc --version
gcc (GCC) 3.4.2 20041017 (Red Hat 3.4.2-6.fc3)

I installed:

Version 2.0.1 beta (2004-11-10)

from source this morning.

It passes make check-all without problems.

Prof. Ripley, is there a particular CRAN package upon which I can test
the bug issues that you refer to above to confirm their presence or
absence on FC3?

> > (The graphics window got smaller, but I'm sure there is a setting
> > for that.)
> 
> If you mean the x11() device window, it should by default have a 7" square 
> canvas.  If it does not, there is a bug in your X11 configuration (which 
> would not at all surprise me, as so far none of my systems reports the ppi 
> of the screen accurately, and some have been way off).

On my system (a Dell 5150 laptop, nVidia GeForce FX Go 5200 with the
nVidia 6629 driver, an internal 15" 1600x1200 panel and an external 20"
Dell 2001FP 1600x1200 panel in non-xinerama dual-display mode), the
X11() device comes up at 7" x 7" on both displays.

HTH,

Marc Schwartz

From baron at psych.upenn.edu  Wed Nov 10 19:53:27 2004
From: baron at psych.upenn.edu (Jonathan Baron)
Date: Wed Nov 10 19:53:47 2004
Subject: [Rd] Re: [R] R works on Fedora Core 3
In-Reply-To: <1100112061.4793.14.camel@horizons.localdomain>
References: <Pine.LNX.4.44.0411100751480.14648-100000@gannet.stats>
	<1100112061.4793.14.camel@horizons.localdomain>
Message-ID: <20041110185327.GE28738@psych>

On 11/10/04 12:41, Marc Schwartz wrote:
>On my system (a Dell 5150 laptop, nVidia GeForce FX Go 5200 with the
>nVidia 6629 driver, an internal 15" 1600x1200 panel and an external 20"
>Dell 2001FP 1600x1200 panel in non-xinerama dual-display mode), the
>X11() device comes up at 7" x 7" on both displays.

Mine works now too.  I think the thing that made it suddenly
start working was that I added 

DisplaySize 336 222

to the Monitor section of xorg.conf.  (This is the screen size in
mm.)  I had a custom xorg.conf, which the installer left alone,
but the xorg.conf.rpmsave did not have this line either.

For more than you want to know about my system see
http://www.sas.upenn.edu/~baron/delli.html

Jon
-- 
Jonathan Baron, Professor of Psychology, University of Pennsylvania
Home page: http://www.sas.upenn.edu/~baron
R search page: http://finzi.psych.upenn.edu/

From ripley at stats.ox.ac.uk  Wed Nov 10 20:01:12 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 10 20:01:24 2004
Subject: [Rd] Re: [R] R works on Fedora Core 3
In-Reply-To: <1100112061.4793.14.camel@horizons.localdomain>
Message-ID: <Pine.LNX.4.44.0411101842410.30809-100000@gannet.stats>

On Wed, 10 Nov 2004, Marc Schwartz wrote:

> On Wed, 2004-11-10 at 08:05 +0000, Prof Brian Ripley wrote:
> > [Moved to R-devel.]
> 
> > Second problem: gcc 3.4.2 does not work `just fine': it has a pesky bug
> > that causes several CRAN packages to fail/give incorrect answers.  Now
> > Linux distros have a very nasty habit of distributing bug-enhanced
> > versions of major software, so this may be fixed in FC3 but in any case
> > gcc-3.4.3 is now out and a worthwhile upgrade.  (Apparently Mandrake
> > backported the bug to `3.4.1' ....)
> > 
> > I would recommend either installing from the sources or building from the
> > SRPM.  Hopefully by the end of the week we will have some i686 machines on
> > FC3 (only x86_64 so far) and so be able to make RPMs available.
> 
> I am finally up and running on FC3 this morning. Took a while to
> download the DVD ISO via Bittorrent...
> 
> Using:
> 
> # gcc --version
> gcc (GCC) 3.4.2 20041017 (Red Hat 3.4.2-6.fc3)
> 
> I installed:
> 
> Version 2.0.1 beta (2004-11-10)
> 
> from source this morning.
> 
> It passes make check-all without problems.
> 
> Prof. Ripley, is there a particular CRAN package upon which I can test
> the bug issues that you refer to above to confirm their presence or
> absence on FC3?

I know minpack.lm and nlmeODE used to fail R CMD check in the examples on
the real gcc 3.4.2. I've just tested they on an AMD machine under FC3, and
they seem OK -- what I am not sure is if they ever failed there (they did
on i686).

At a quick glance the embedded reference in etc/Makeconf to gcc 3.3.3 when
compiling packages with Fortran is not causing problems as 3.4.2 has
reorganized where things are.

My tests are on a server in a server room, and at present Xvfb won't run
on it (I think it needs cleaning up after the upgrade), which limits the
testing I can do tonight.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MSchwartz at MedAnalytics.com  Wed Nov 10 20:36:03 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Wed Nov 10 20:36:13 2004
Subject: [Rd] Re: [R] R works on Fedora Core 3
In-Reply-To: <Pine.LNX.4.44.0411101842410.30809-100000@gannet.stats>
References: <Pine.LNX.4.44.0411101842410.30809-100000@gannet.stats>
Message-ID: <1100115363.4793.32.camel@horizons.localdomain>

On Wed, 2004-11-10 at 19:01 +0000, Prof Brian Ripley wrote:
> On Wed, 10 Nov 2004, Marc Schwartz wrote:

snip

> > Prof. Ripley, is there a particular CRAN package upon which I can test
> > the bug issues that you refer to above to confirm their presence or
> > absence on FC3?
> 
> I know minpack.lm and nlmeODE used to fail R CMD check in the examples on
> the real gcc 3.4.2. I've just tested they on an AMD machine under FC3, and
> they seem OK -- what I am not sure is if they ever failed there (they did
> on i686).
> 
> At a quick glance the embedded reference in etc/Makeconf to gcc 3.3.3 when
> compiling packages with Fortran is not causing problems as 3.4.2 has
> reorganized where things are.
> 
> My tests are on a server in a server room, and at present Xvfb won't run
> on it (I think it needs cleaning up after the upgrade), which limits the
> testing I can do tonight.

Both packages seem to be OK here:

minpack.lm_1.0-3.tar.gz:

...
* creating minpack.lm-Ex.R ... OK
* checking examples ... OK
...

nlmeODE_0.2-8.tar.gz:

...
* creating nlmeODE-Ex.R ... OK
* checking examples ... OK
...

I did not mention this earlier, but this was a clean install of FC3, as
opposed to an upgrade. I usually preserve the /home partition and re-
format the others for the new versions each time.

HTH,

Marc

From roebuck at odin.mdacc.tmc.edu  Wed Nov 10 21:14:40 2004
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Wed Nov 10 21:14:50 2004
Subject: [Rd] Methods package documentation typo
Message-ID: <Pine.OSF.4.58.0411101413260.121105@odin.mdacc.tmc.edu>

?methods

     'removeGeneric', 'removeMethods': Remove the all the methods for
          the generic function of this name.

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From RichardP at DFO-MPO.GC.CA  Wed Nov 10 22:19:40 2004
From: RichardP at DFO-MPO.GC.CA (RichardP@DFO-MPO.GC.CA)
Date: Wed Nov 10 22:19:50 2004
Subject: [Rd] Solution to problem running R 1.8.1 on Windows XP (PR#7357)
Message-ID: <20041110211940.9F582EABA@slim.kubism.ku.dk>

This is a bug apparently caused by Windows XP's interaction with R.

I was getting an error message when running C:\Program
Files\R\rw1081\bin\Rgui.exe.  Odly enough, his problem was happening only
when I was not connected to the network using my ethernet connection.

Using Google, I found the same error described on a thread (see attached)
as:

> The R installation is fine on Windows XP, but when I started to open the R
> program, then it pops out this message:
> 
> "R for Windows GUI front-end has encountered a problem and needs to close.
We
> are sorry for the inconvenience....."
> 
> The error signature is:
> 
> AppName: rgui.exe	 AppVer: 1.71.30616.0	 ModName: r.dll
> ModVer: 1.71.30616.0	 Offset: 0002966e
> 

There was a hint in that message that screen resolution might be the culprit
so I checked my Display settings and changed the setting of my second
(external) monitor (which was not attached) 's resolution from 32 bit to 8
bit.   I have not had a problem since.  Weird but it works!?   

P.S.: The primary display device is still set at 32 bits.

Cheers,

Pierre Richard
RichardP@dfo-mpo.gc.ca

From jhallman at frb.gov  Wed Nov 10 22:28:37 2004
From: jhallman at frb.gov (jhallman@frb.gov)
Date: Wed Nov 10 22:29:46 2004
Subject: [Rd] Can I write methods for ":"?
Message-ID: <20041110212837.560CEAEA05@mail.rsma.frb.gov>

Is there a way to overload the ":" operator?  I have a class called
"ti", but I found that 

firstTi:secondTi

does not dispatch to either Ops.ti nor to ":.ti" if I define that.  Am I
just out of luck?

Jeff

From ripley at stats.ox.ac.uk  Wed Nov 10 22:37:44 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 10 22:37:59 2004
Subject: [Rd] Solution to problem running R 1.8.1 on Windows XP (PR#7357)
In-Reply-To: <20041110211940.9F582EABA@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0411102134001.31721-100000@gannet.stats>

Please do not send reports on year-old versions of R: see the R posting 
guide.

Please try the latest version of 2.0.1 beta, and if you can reproduce 
this, send full instructions on how to reproduce it.  However, check the 
rw-FAQ first, for this looks like an error in your display drivers, not in 
R.

On Wed, 10 Nov 2004 RichardP@DFO-MPO.GC.CA wrote:

> This is a bug apparently caused by Windows XP's interaction with R.
> 
> I was getting an error message when running C:\Program
> Files\R\rw1081\bin\Rgui.exe.  Odly enough, his problem was happening only
> when I was not connected to the network using my ethernet connection.
> 
> Using Google, I found the same error described on a thread (see attached)
> as:

Nothing was attached - see the posting guide.

> > The R installation is fine on Windows XP, but when I started to open the R
> > program, then it pops out this message:
> > 
> > "R for Windows GUI front-end has encountered a problem and needs to close.
> We
> > are sorry for the inconvenience....."
> > 
> > The error signature is:
> > 
> > AppName: rgui.exe	 AppVer: 1.71.30616.0	 ModName: r.dll
> > ModVer: 1.71.30616.0	 Offset: 0002966e
> > 
> 
> There was a hint in that message that screen resolution might be the culprit
> so I checked my Display settings and changed the setting of my second
> (external) monitor (which was not attached) 's resolution from 32 bit to 8
> bit.   I have not had a problem since.  Weird but it works!?   
> 
> P.S.: The primary display device is still set at 32 bits.
> 
> Cheers,
> 
> Pierre Richard
> RichardP@dfo-mpo.gc.ca
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Nov 10 22:41:50 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 10 22:42:00 2004
Subject: [Rd] Can I write methods for ":"?
In-Reply-To: <20041110212837.560CEAEA05@mail.rsma.frb.gov>
Message-ID: <Pine.LNX.4.44.0411102138220.31721-100000@gannet.stats>

On Wed, 10 Nov 2004 jhallman@frb.gov wrote:

> Is there a way to overload the ":" operator?  I have a class called
> "ti", but I found that 
> 
> firstTi:secondTi
> 
> does not dispatch to either Ops.ti nor to ":.ti" if I define that.  Am I
> just out of luck?

Well, it is not in the Ops group, so what made you think it would work?

If you mean S3 methods, then ":" is not an S3 generic.  If it were, it 
would be documented.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Thu Nov 11 06:45:33 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 11 06:45:44 2004
Subject: [Rd] Questions on package creation
Message-ID: <loom.20041111T064049-272@post.gmane.org>


I have some questions about 

   1. nomenclature, 
   2. recommended file locations and 
   3. overall procedure related to creating packages.

To the extent that it matters, examples here relate to Windows XP
R 2.0.1 beta.  

The questions are interspersed and prefaced with ***.

My understanding is that there are actually 6 forms of a package
that one should use in package development:

1. original package.  This refers to the original source files, 
   documentation and other files that the author develops.  
   If source control, e.g. svn, is used then these are the files 
   that are under source control.  They are kept in some arbitrary 
   location on one's disk.  Let us say \usr\mypackage, for example.

*** Is there some standard name for this form of the package?

2. source archive.  This is created from the original package
   like this:

     cd \Program Files\rw2001beta
     bin\R CMD build /usr/mypackage

   which creates, say

     \Program Files\rw2001beta\mypackage_1.0-1.tar.gz

   The source archive is distinct from the original archive since it
   is specific to a version of R and excludes the files referenced
   in \usr\mypackage\.Rbuildignore

*** Is \Program Files\rw2001beta the correct place to put this
   .tar.gz file?

3. source tree.  This is created from the gzipped tar archive in #2
   like this:

     cd \Program Files\rw2001beta
     gzip -d mypackage_1.0-1.tar.gz
     cd src\library
     tar xvf ..\..\mypackage_1.0-1.tar

   and is checked like this:

     cd \Program Files\rw2001beta
     bin\R CMD check mypackage

4. binary archive.  This is created from the source archive in #2
   or the source tree in #3:

      cd \Program Files\rw2001beta
      bin\R CMD build mypackage --binary
    
   which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip

*** Is \Program Files\rw2001beta the correct place to put this?

5. installed package.  This installed by:

     cd \Program Files\rw2001beta
     bin\R CMD install mypackage

  which results in the source package being installed in:
  
     \Program Files\rw2001beta\library\mypackage

  This can alternately be done with the R GUI menu: 

    Packages | Install package(s) from local zip files

6. loaded package.  In R using the command:

     library(mypackage)

   loads the package into R.  This can alternately be done
   using the R GUI menu:

      Packages | Load package

One might initially skip #3 and #4 and just test the package out
in R after #6 and once one is satisfied that it is in good shape
repeat the sequence.

*** Is all the above the correct and recommended sequence?

*** Someone mentioned that --force is important.  How does that 
    fit into all this?  I still have not used it and am not sure
    about it.

From wolski at molgen.mpg.de  Thu Nov 11 09:31:01 2004
From: wolski at molgen.mpg.de (Witold Eryk Wolski)
Date: Thu Nov 11 09:31:14 2004
Subject: [Rd] Questions on package creation
In-Reply-To: <loom.20041111T064049-272@post.gmane.org>
References: <loom.20041111T064049-272@post.gmane.org>
Message-ID: <41932345.502@molgen.mpg.de>

Hi,
I mentioned --force
R CMD build --force
is creating the INDEX file automatically. I use it normally.

And in my view in your sequence the point 2. is superfluous in your 
sequence.
You do not need a build neither before check nor INSTALL.

/E


Gabor Grothendieck wrote:

>I have some questions about 
>
>   1. nomenclature, 
>   2. recommended file locations and 
>   3. overall procedure related to creating packages.
>
>To the extent that it matters, examples here relate to Windows XP
>R 2.0.1 beta.  
>
>The questions are interspersed and prefaced with ***.
>
>My understanding is that there are actually 6 forms of a package
>that one should use in package development:
>
>1. original package.  This refers to the original source files, 
>   documentation and other files that the author develops.  
>   If source control, e.g. svn, is used then these are the files 
>   that are under source control.  They are kept in some arbitrary 
>   location on one's disk.  Let us say \usr\mypackage, for example.
>
>*** Is there some standard name for this form of the package?
>
>2. source archive.  This is created from the original package
>   like this:
>
>     cd \Program Files\rw2001beta
>     bin\R CMD build /usr/mypackage
>
>   which creates, say
>
>     \Program Files\rw2001beta\mypackage_1.0-1.tar.gz
>
>   The source archive is distinct from the original archive since it
>   is specific to a version of R and excludes the files referenced
>   in \usr\mypackage\.Rbuildignore
>
>*** Is \Program Files\rw2001beta the correct place to put this
>   .tar.gz file?
>
>3. source tree.  This is created from the gzipped tar archive in #2
>   like this:
>
>     cd \Program Files\rw2001beta
>     gzip -d mypackage_1.0-1.tar.gz
>     cd src\library
>     tar xvf ..\..\mypackage_1.0-1.tar
>
>   and is checked like this:
>
>     cd \Program Files\rw2001beta
>     bin\R CMD check mypackage
>
>4. binary archive.  This is created from the source archive in #2
>   or the source tree in #3:
>
>      cd \Program Files\rw2001beta
>      bin\R CMD build mypackage --binary
>    
>   which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip
>
>*** Is \Program Files\rw2001beta the correct place to put this?
>
>5. installed package.  This installed by:
>
>     cd \Program Files\rw2001beta
>     bin\R CMD install mypackage
>
>  which results in the source package being installed in:
>  
>     \Program Files\rw2001beta\library\mypackage
>
>  This can alternately be done with the R GUI menu: 
>
>    Packages | Install package(s) from local zip files
>
>6. loaded package.  In R using the command:
>
>     library(mypackage)
>
>   loads the package into R.  This can alternately be done
>   using the R GUI menu:
>
>      Packages | Load package
>
>One might initially skip #3 and #4 and just test the package out
>in R after #6 and once one is satisfied that it is in good shape
>repeat the sequence.
>
>*** Is all the above the correct and recommended sequence?
>
>*** Someone mentioned that --force is important.  How does that 
>    fit into all this?  I still have not used it and am not sure
>    about it.
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel
>
>  
>


-- 
Dipl. bio-chem. Witold Eryk Wolski
MPI-Moleculare Genetic
Ihnestrasse 63-73 14195 Berlin
tel: 0049-30-83875219                 __("<    _
http://www.molgen.mpg.de/~wolski      \__/    'v'
http://r4proteomics.sourceforge.net    ||    /   \
mail: witek96@users.sourceforge.net    ^^     m m
      wolski@molgen.mpg.de

From ligges at statistik.uni-dortmund.de  Thu Nov 11 09:39:50 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Nov 11 09:39:30 2004
Subject: [Rd] Questions on package creation
In-Reply-To: <loom.20041111T064049-272@post.gmane.org>
References: <loom.20041111T064049-272@post.gmane.org>
Message-ID: <41932556.1070409@statistik.uni-dortmund.de>

Gabor Grothendieck wrote:

> I have some questions about 
> 
>    1. nomenclature, 
>    2. recommended file locations and 
>    3. overall procedure related to creating packages.
> 
> To the extent that it matters, examples here relate to Windows XP
> R 2.0.1 beta.  
> 
> The questions are interspersed and prefaced with ***.
> 
> My understanding is that there are actually 6 forms of a package
> that one should use in package development:
> 
> 1. original package.  This refers to the original source files, 
>    documentation and other files that the author develops.  
>    If source control, e.g. svn, is used then these are the files 
>    that are under source control.  They are kept in some arbitrary 
>    location on one's disk.  Let us say \usr\mypackage, for example.
> 
> *** Is there some standard name for this form of the package?
> 
> 2. source archive.  This is created from the original package
>    like this:
> 
>      cd \Program Files\rw2001beta
>      bin\R CMD build /usr/mypackage

You won't need to cd to anything.


>    which creates, say
> 
>      \Program Files\rw2001beta\mypackage_1.0-1.tar.gz
> 
>    The source archive is distinct from the original archive since it
>    is specific to a version of R and excludes the files referenced
>    in \usr\mypackage\.Rbuildignore

and others, e.g., .cvs files.


> *** Is \Program Files\rw2001beta the correct place to put this
>    .tar.gz file?


It's arbitrary where to save it, I would not save it in the R directory, 
though.


> 3. source tree.  This is created from the gzipped tar archive in #2
>    like this:
> 
>      cd \Program Files\rw2001beta
>      gzip -d mypackage_1.0-1.tar.gz
>      cd src\library
>      tar xvf ..\..\mypackage_1.0-1.tar
> 
>    and is checked like this:
> 
>      cd \Program Files\rw2001beta
>      bin\R CMD check mypackage
> 
> 4. binary archive.  This is created from the source archive in #2
>    or the source tree in #3:
> 
>       cd \Program Files\rw2001beta
>       bin\R CMD build mypackage --binary
>

or join this with step 5 using
R CMD INSTALL --build mypackage

>    which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip
> 
> *** Is \Program Files\rw2001beta the correct place to put this?


... also arbitrary (as above) ...


> 5. installed package.  This installed by:
> 
>      cd \Program Files\rw2001beta
>      bin\R CMD install mypackage
> 
>   which results in the source package being installed in:
>   
>      \Program Files\rw2001beta\library\mypackage
> 
>   This can alternately be done with the R GUI menu: 
> 
>     Packages | Install package(s) from local zip files
> 
> 6. loaded package.  In R using the command:
> 
>      library(mypackage)
> 
>    loads the package into R.  This can alternately be done
>    using the R GUI menu:
> 
>       Packages | Load package
> 
> One might initially skip #3 and #4 and just test the package out
> in R after #6 and once one is satisfied that it is in good shape
> repeat the sequence.
> 
> *** Is all the above the correct and recommended sequence?

As always: It depends. Nothing of the above is completely wrong.



> *** Someone mentioned that --force is important.  How does that 
>     fit into all this?  I still have not used it and am not sure
>     about it.

It is used to overwrite the INDEX file.

Uwe Ligges

> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ligges at statistik.uni-dortmund.de  Thu Nov 11 09:41:33 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Nov 11 09:41:14 2004
Subject: [Rd] Questions on package creation
In-Reply-To: <41932345.502@molgen.mpg.de>
References: <loom.20041111T064049-272@post.gmane.org>
	<41932345.502@molgen.mpg.de>
Message-ID: <419325BD.8020303@statistik.uni-dortmund.de>

Witold Eryk Wolski wrote:

> Hi,
> I mentioned --force
> R CMD build --force
> is creating the INDEX file automatically. I use it normally.
> 
> And in my view in your sequence the point 2. is superfluous in your 
> sequence.
> You do not need a build neither before check nor INSTALL.

No. It might be a good idea to build before (at least when you want to 
do the final checks before publishing the package), because some files 
might be excluded from the package during the build process!

Uwe Ligges



> /E
> 
> 
> Gabor Grothendieck wrote:
> 
>> I have some questions about
>>   1. nomenclature,   2. recommended file locations and   3. overall 
>> procedure related to creating packages.
>>
>> To the extent that it matters, examples here relate to Windows XP
>> R 2.0.1 beta. 
>> The questions are interspersed and prefaced with ***.
>>
>> My understanding is that there are actually 6 forms of a package
>> that one should use in package development:
>>
>> 1. original package.  This refers to the original source files,   
>> documentation and other files that the author develops.    If source 
>> control, e.g. svn, is used then these are the files   that are under 
>> source control.  They are kept in some arbitrary   location on one's 
>> disk.  Let us say \usr\mypackage, for example.
>>
>> *** Is there some standard name for this form of the package?
>>
>> 2. source archive.  This is created from the original package
>>   like this:
>>
>>     cd \Program Files\rw2001beta
>>     bin\R CMD build /usr/mypackage
>>
>>   which creates, say
>>
>>     \Program Files\rw2001beta\mypackage_1.0-1.tar.gz
>>
>>   The source archive is distinct from the original archive since it
>>   is specific to a version of R and excludes the files referenced
>>   in \usr\mypackage\.Rbuildignore
>>
>> *** Is \Program Files\rw2001beta the correct place to put this
>>   .tar.gz file?
>>
>> 3. source tree.  This is created from the gzipped tar archive in #2
>>   like this:
>>
>>     cd \Program Files\rw2001beta
>>     gzip -d mypackage_1.0-1.tar.gz
>>     cd src\library
>>     tar xvf ..\..\mypackage_1.0-1.tar
>>
>>   and is checked like this:
>>
>>     cd \Program Files\rw2001beta
>>     bin\R CMD check mypackage
>>
>> 4. binary archive.  This is created from the source archive in #2
>>   or the source tree in #3:
>>
>>      cd \Program Files\rw2001beta
>>      bin\R CMD build mypackage --binary
>>      which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip
>>
>> *** Is \Program Files\rw2001beta the correct place to put this?
>>
>> 5. installed package.  This installed by:
>>
>>     cd \Program Files\rw2001beta
>>     bin\R CMD install mypackage
>>
>>  which results in the source package being installed in:
>>  
>>     \Program Files\rw2001beta\library\mypackage
>>
>>  This can alternately be done with the R GUI menu:
>>    Packages | Install package(s) from local zip files
>>
>> 6. loaded package.  In R using the command:
>>
>>     library(mypackage)
>>
>>   loads the package into R.  This can alternately be done
>>   using the R GUI menu:
>>
>>      Packages | Load package
>>
>> One might initially skip #3 and #4 and just test the package out
>> in R after #6 and once one is satisfied that it is in good shape
>> repeat the sequence.
>>
>> *** Is all the above the correct and recommended sequence?
>>
>> *** Someone mentioned that --force is important.  How does that    fit 
>> into all this?  I still have not used it and am not sure
>>    about it.
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>  
>>
> 
>

From pfh at cbs.dtu.dk  Thu Nov 11 14:01:23 2004
From: pfh at cbs.dtu.dk (pfh@cbs.dtu.dk)
Date: Thu Nov 11 14:01:31 2004
Subject: [Rd] Row labels are skewed in 'heatmap' (PR#7358)
Message-ID: <20041111130123.A2F5BF6DA@slim.kubism.ku.dk>

Full_Name: Peter Fischer Hallin
Version: Version 1.8.1
OS: Irix64
Submission from: (NULL) (130.225.67.236)


I've made a script look like this:
 exp <- read.table("graph/1933672048.cluster.data")
 exp <- as.matrix(exp) 
 postscript("graph/1933672048.cluster.data.ps") 
 heatmap(exp,scale="none",cexCol=0.4,cexRow=0.2,col=custom,margins=c(5,5))

The row labels on the output PostScript file are skewed vertically downwards -
in fact more than the height of 2 rows! I have roughly 200 rows and 4 columns in
my dataset. It is therefor very difficult to see which label goes to which row

From andy_liaw at merck.com  Thu Nov 11 14:18:52 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Nov 11 14:19:44 2004
Subject: [Rd] Questions on package creation
Message-ID: <3A822319EB35174CA3714066D590DCD50994E2D1@usrymx25.merck.com>

Gabor,

Here are my takes on these:

1: Not that I know of.  Only the package developer(s) see the code this way,
and is really not different from 3.  (A developer would not need 3, as R CMD
check can be done with 1.)

2 & 4: As Uwe said, the location is `whereever you like'.  You would create
them only for distribution (i.e., installation on other machines), so it
doesn't matter where it put them.  They only exist temporarily on the
developer's machine (assuming the source is version controlled via other
means), as only a user wanting to install the package would need the archive
forms.

Here's the sequence I use:

Start with a source tree for the package somewhere.

Testing/checking:

Run R CMD INSTALL -l mytest mypkg (making sure you create the `mytest'
directory first).  This installs the package in the `mytest' directory.  If
the install is not successful, make necessary changes.  If successful, start
up R (from the command line) and do library(mypkg, lib.loc="mytest") and run
some tests (e.g., example() for functions in the package).

After making sure the installed package looks good, run R CMD check mypkg.
Make changes to correct errors and warnings.

After successful check, run R CMD build --force mypkg to generate the source
tarball and update the INDEX file.  (The --force is only needed if you
add/remove/change help page topics since the last build.)

Run R CMD build --binary mypkg if you need to distribute the package in
binary form.

HTH,
Andy

> From: Gabor Grothendieck
> 
> I have some questions about 
> 
>    1. nomenclature, 
>    2. recommended file locations and 
>    3. overall procedure related to creating packages.
> 
> To the extent that it matters, examples here relate to Windows XP
> R 2.0.1 beta.  
> 
> The questions are interspersed and prefaced with ***.
> 
> My understanding is that there are actually 6 forms of a package
> that one should use in package development:
> 
> 1. original package.  This refers to the original source files, 
>    documentation and other files that the author develops.  
>    If source control, e.g. svn, is used then these are the files 
>    that are under source control.  They are kept in some arbitrary 
>    location on one's disk.  Let us say \usr\mypackage, for example.
> 
> *** Is there some standard name for this form of the package?
> 
> 2. source archive.  This is created from the original package
>    like this:
> 
>      cd \Program Files\rw2001beta
>      bin\R CMD build /usr/mypackage
> 
>    which creates, say
> 
>      \Program Files\rw2001beta\mypackage_1.0-1.tar.gz
> 
>    The source archive is distinct from the original archive since it
>    is specific to a version of R and excludes the files referenced
>    in \usr\mypackage\.Rbuildignore
> 
> *** Is \Program Files\rw2001beta the correct place to put this
>    .tar.gz file?
> 
> 3. source tree.  This is created from the gzipped tar archive in #2
>    like this:
> 
>      cd \Program Files\rw2001beta
>      gzip -d mypackage_1.0-1.tar.gz
>      cd src\library
>      tar xvf ..\..\mypackage_1.0-1.tar
> 
>    and is checked like this:
> 
>      cd \Program Files\rw2001beta
>      bin\R CMD check mypackage
> 
> 4. binary archive.  This is created from the source archive in #2
>    or the source tree in #3:
> 
>       cd \Program Files\rw2001beta
>       bin\R CMD build mypackage --binary
>     
>    which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip
> 
> *** Is \Program Files\rw2001beta the correct place to put this?
> 
> 5. installed package.  This installed by:
> 
>      cd \Program Files\rw2001beta
>      bin\R CMD install mypackage
> 
>   which results in the source package being installed in:
>   
>      \Program Files\rw2001beta\library\mypackage
> 
>   This can alternately be done with the R GUI menu: 
> 
>     Packages | Install package(s) from local zip files
> 
> 6. loaded package.  In R using the command:
> 
>      library(mypackage)
> 
>    loads the package into R.  This can alternately be done
>    using the R GUI menu:
> 
>       Packages | Load package
> 
> One might initially skip #3 and #4 and just test the package out
> in R after #6 and once one is satisfied that it is in good shape
> repeat the sequence.
> 
> *** Is all the above the correct and recommended sequence?
> 
> *** Someone mentioned that --force is important.  How does that 
>     fit into all this?  I still have not used it and am not sure
>     about it.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From uukrawie at cyf-kr.edu.pl  Thu Nov 11 14:40:14 2004
From: uukrawie at cyf-kr.edu.pl (uukrawie@cyf-kr.edu.pl)
Date: Thu Nov 11 14:40:22 2004
Subject: [Rd] typo in R-intro (PR#7359)
Message-ID: <20041111134014.BB1A4EABF@slim.kubism.ku.dk>

Full_Name: Adam Krawiec
Version: 2.0.0
OS: Linux
Submission from: (NULL) (80.53.7.114)


In sections 11.7.1 and 11.7.2 of "An Introduction to R" 
there are out$estimates instead of out$estimate

From ligges at statistik.uni-dortmund.de  Thu Nov 11 14:51:18 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Thu Nov 11 14:51:26 2004
Subject: [Rd] Row labels are skewed in 'heatmap' (PR#7358)
Message-ID: <20041111135118.1823CFC02@slim.kubism.ku.dk>

pfh@cbs.dtu.dk wrote:
> Full_Name: Peter Fischer Hallin
> Version: Version 1.8.1
> OS: Irix64
> Submission from: (NULL) (130.225.67.236)
> 
> 
> I've made a script look like this:
>  exp <- read.table("graph/1933672048.cluster.data")
>  exp <- as.matrix(exp) 
>  postscript("graph/1933672048.cluster.data.ps") 
>  heatmap(exp,scale="none",cexCol=0.4,cexRow=0.2,col=custom,margins=c(5,5))
> 
> The row labels on the output PostScript file are skewed vertically downwards -
> in fact more than the height of 2 rows! I have roughly 200 rows and 4 columns in
> my dataset. It is therefor very difficult to see which label goes to which row

Please read how to report bugs. In particular, please don't report bugs 
of outdated R versions!

I guess the bug has been fixed by a couple of changes how text in 
margins is drawn. Please try R-2.0.1 beta and tell us whether the bug is 
still persistent. In that case, please provide a simple reproducible 
example (we cannot reproduce the example above!).

Uwe Ligges

From murdoch at stats.uwo.ca  Thu Nov 11 14:58:22 2004
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu Nov 11 14:58:30 2004
Subject: [Rd] typo in R-intro (PR#7359)
Message-ID: <20041111135822.404791041D@slim.kubism.ku.dk>

On Thu, 11 Nov 2004 14:40:14 +0100 (CET), uukrawie@cyf-kr.edu.pl wrote
:

>Full_Name: Adam Krawiec
>Version: 2.0.0
>OS: Linux
>Submission from: (NULL) (80.53.7.114)
>
>
>In sections 11.7.1 and 11.7.2 of "An Introduction to R" 
>there are out$estimates instead of out$estimate

Thanks, I'll fix that.

Duncan Murdoch

From murdoch at stats.uwo.ca  Thu Nov 11 15:08:10 2004
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu Nov 11 15:08:18 2004
Subject: [Rd] Memory problem in Rgui script editor? (PR#7360)
Message-ID: <20041111140810.B57B31041A@slim.kubism.ku.dk>

I've seen warnings from gdb that something is reading from memory that
has already been free'd when the script editor is closed in Rgui.  

I haven't seen any bad symptoms of this outside the debugger, so I may
not take the time to track it down and fix it before the 2.0.1
release:  but I don't want to forget about it, hence this bug report.

Duncan Murdoch

From maechler at stat.math.ethz.ch  Thu Nov 11 15:57:04 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Nov 11 15:57:12 2004
Subject: [Rd] Row labels are skewed in 'heatmap' (PR#7358)
Message-ID: <20041111145704.C188FF6DA@slim.kubism.ku.dk>

Hi Peter, thank you for trying,
but that's not yet a useful bug report:

We can't reproduce what you did!

If you put your data on a web site,
and replace
   exp <- read.table("graph/1933672048.cluster.data")
by exp <- read.table("http://<....your_adress....>/mycluster.data")

it will hopefully become reproducible and thus potentially
useful.

Though even that is doubtful since you are using an outdated
version of R, and I now that heatmap() has been improved since then!

Martin Maechler

>>>>> "pfh" == pfh  <pfh@cbs.dtu.dk>
>>>>>     on Thu, 11 Nov 2004 14:01:23 +0100 (CET) writes:


    pfh> I've made a script look like this:
    pfh> exp <- read.table("graph/1933672048.cluster.data")
    pfh> exp <- as.matrix(exp) 
    pfh> postscript("graph/1933672048.cluster.data.ps") 

    pfh> heatmap(exp,scale="none",cexCol=0.4,cexRow=0.2,col=custom,margins=c(5,5))

From Bernhard.Pfaff at drkw.com  Thu Nov 11 17:11:13 2004
From: Bernhard.Pfaff at drkw.com (Pfaff, Bernhard)
Date: Thu Nov 11 17:11:24 2004
Subject: [Rd] inst/CITATION produced error during Rcmd check <package>
Message-ID: <29E0BC0C716A584582941615CF9FFB0902585D0E@ibfftce107.de.ad.drkw.net>

Dear list member,

by running Rcmd check on a package where a customised 'CITATION' file should
be included instead of the automatically produced one, the following error
occurs:

  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  installing R files
  installing inst files
FIND: Parameter format not correct
make[2]: *** [c:/R/packages/urca/inst] Error 2
make[1]: *** [all] Error 2
make: *** [pkg-urca] Error 2
*** Installation of urca failed ***

When I exclude /inst/CITATION from the package sources, no problems/errors
are encountered. 
Incidentally, the same error occurs on 'Rcmd check VR':

H:\R\Packages>Rcmd check VR
* checking for working latex ... OK
* using log directory 'H:/R/Packages/VR.Rcheck'
* checking for file 'VR/DESCRIPTION' ... OK
* checking if this is a source package ... OK

installing R.css in H:/R/Packages/VR.Rcheck

Looks like `H:/R/Packages/VR' is a package bundle


---------- Making package MASS ------------
  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  making DLL ...
making MASS.d from MASS.c
making lqs.d from lqs.c
gcc   -Ic:/R/rw2000/include -Wall -O2   -c MASS.c -o MASS.o
gcc   -Ic:/R/rw2000/include -Wall -O2   -c lqs.c -o lqs.o
ar cr MASS.a MASS.o lqs.o
ranlib MASS.a
windres --include-dir c:/R/rw2000/include  -i MASS_res.rc -o MASS_res.o
gcc  --shared -s  -o MASS.dll MASS.def MASS.a MASS_res.o
-Lc:/R/rw2000/src/gnuw
in32  -lg2c -lR
  ... DLL made
  installing DLL
  installing R files
  installing inst files
FIND: Parameter format not correct
make[2]: *** [H:/R/Packages/VR.Rcheck/MASS/inst] Error 2
make[1]: *** [all] Error 2
make: *** [pkg-MASS] Error 2
*** Installation of MASS failed ***

 ERROR
Installation failed.

H:\R\Packages>

Am I doing something wrong? Is the error caused by my OS? Any help or
pointers are appreciated.

Best Regards,
Bernhard

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 2
 minor = 0.0
 year = 2004
 month = 10
 day = 04
 language = R

Windows 2000 Professional (build 2195) Service Pack 4.0

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics,
package:grDevices, package:utils, package:datasets, package:fortunes,
Autoloads, package:base



--------------------------------------------------------------------------------
The information contained herein is confidential and is inte...{{dropped}}

From ripley at stats.ox.ac.uk  Thu Nov 11 17:46:11 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Nov 11 17:46:21 2004
Subject: [Rd] inst/CITATION produced error during Rcmd check <package>
In-Reply-To: <29E0BC0C716A584582941615CF9FFB0902585D0E@ibfftce107.de.ad.drkw.net>
Message-ID: <Pine.GSO.4.31.0411111643220.28252-100000@toucan.stats>

That you are getting FIND not `find' suggests that you have not followed
the instructions in README.packages correctly.  Please ensure you have
followed

BEWARE: `Native' ports of make are _not_ suitable (including that at
the mingw site).  There were also problems with several earlier
versions of the cygwin tools and dll.  To avoid frustration, please
use our tool set, and make sure it is at the front of your path
(including before the Windows system directories).

and especially the last point.



On Thu, 11 Nov 2004, Pfaff, Bernhard wrote:

> Dear list member,
>
> by running Rcmd check on a package where a customised 'CITATION' file should
> be included instead of the automatically produced one, the following error
> occurs:
>
>   adding build stamp to DESCRIPTION
>   installing NAMESPACE file and metadata
>   installing R files
>   installing inst files
> FIND: Parameter format not correct
> make[2]: *** [c:/R/packages/urca/inst] Error 2
> make[1]: *** [all] Error 2
> make: *** [pkg-urca] Error 2
> *** Installation of urca failed ***
>
> When I exclude /inst/CITATION from the package sources, no problems/errors
> are encountered.
> Incidentally, the same error occurs on 'Rcmd check VR':
>
> H:\R\Packages>Rcmd check VR
> * checking for working latex ... OK
> * using log directory 'H:/R/Packages/VR.Rcheck'
> * checking for file 'VR/DESCRIPTION' ... OK
> * checking if this is a source package ... OK
>
> installing R.css in H:/R/Packages/VR.Rcheck
>
> Looks like `H:/R/Packages/VR' is a package bundle
>
>
> ---------- Making package MASS ------------
>   adding build stamp to DESCRIPTION
>   installing NAMESPACE file and metadata
>   making DLL ...
> making MASS.d from MASS.c
> making lqs.d from lqs.c
> gcc   -Ic:/R/rw2000/include -Wall -O2   -c MASS.c -o MASS.o
> gcc   -Ic:/R/rw2000/include -Wall -O2   -c lqs.c -o lqs.o
> ar cr MASS.a MASS.o lqs.o
> ranlib MASS.a
> windres --include-dir c:/R/rw2000/include  -i MASS_res.rc -o MASS_res.o
> gcc  --shared -s  -o MASS.dll MASS.def MASS.a MASS_res.o
> -Lc:/R/rw2000/src/gnuw
> in32  -lg2c -lR
>   ... DLL made
>   installing DLL
>   installing R files
>   installing inst files
> FIND: Parameter format not correct
> make[2]: *** [H:/R/Packages/VR.Rcheck/MASS/inst] Error 2
> make[1]: *** [all] Error 2
> make: *** [pkg-MASS] Error 2
> *** Installation of MASS failed ***
>
>  ERROR
> Installation failed.
>
> H:\R\Packages>
>
> Am I doing something wrong? Is the error caused by my OS? Any help or
> pointers are appreciated.
>
> Best Regards,
> Bernhard
>
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status =
>  major = 2
>  minor = 0.0
>  year = 2004
>  month = 10
>  day = 04
>  language = R
>
> Windows 2000 Professional (build 2195) Service Pack 4.0
>
> Search Path:
>  .GlobalEnv, package:methods, package:stats, package:graphics,
> package:grDevices, package:utils, package:datasets, package:fortunes,
> Autoloads, package:base
>
>
>
> --------------------------------------------------------------------------------
> The information contained herein is confidential and is inte...{{dropped}}
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Thu Nov 11 18:26:33 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 11 18:26:45 2004
Subject: [Rd] Questions on package creation
References: <3A822319EB35174CA3714066D590DCD50994E2D1@usrymx25.merck.com>
Message-ID: <loom.20041111T182242-734@post.gmane.org>

Thanks.  One thing I would like clarified is the various locations
and what is relative to where.

If you could add to the example where we are in terms of an example
absolute path and where the various directories wind up also in
terms of example absolute paths it would clear up a lot.

Liaw, Andy <andy_liaw <at> merck.com> writes:

: 
: Gabor,
: 
: Here are my takes on these:
: 
: 1: Not that I know of.  Only the package developer(s) see the code this way,
: and is really not different from 3.  (A developer would not need 3, as R CMD
: check can be done with 1.)
: 
: 2 & 4: As Uwe said, the location is `whereever you like'.  You would create
: them only for distribution (i.e., installation on other machines), so it
: doesn't matter where it put them.  They only exist temporarily on the
: developer's machine (assuming the source is version controlled via other
: means), as only a user wanting to install the package would need the archive
: forms.
: 
: Here's the sequence I use:
: 
: Start with a source tree for the package somewhere.
: 
: Testing/checking:
: 
: Run R CMD INSTALL -l mytest mypkg (making sure you create the `mytest'
: directory first).  This installs the package in the `mytest' directory.  If
: the install is not successful, make necessary changes.  If successful, start
: up R (from the command line) and do library(mypkg, lib.loc="mytest") and run
: some tests (e.g., example() for functions in the package).
: 
: After making sure the installed package looks good, run R CMD check mypkg.
: Make changes to correct errors and warnings.
: 
: After successful check, run R CMD build --force mypkg to generate the source
: tarball and update the INDEX file.  (The --force is only needed if you
: add/remove/change help page topics since the last build.)
: 
: Run R CMD build --binary mypkg if you need to distribute the package in
: binary form.
: 
: HTH,
: Andy
: 
: > From: Gabor Grothendieck
: > 
: > I have some questions about 
: > 
: >    1. nomenclature, 
: >    2. recommended file locations and 
: >    3. overall procedure related to creating packages.
: > 
: > To the extent that it matters, examples here relate to Windows XP
: > R 2.0.1 beta.  
: > 
: > The questions are interspersed and prefaced with ***.
: > 
: > My understanding is that there are actually 6 forms of a package
: > that one should use in package development:
: > 
: > 1. original package.  This refers to the original source files, 
: >    documentation and other files that the author develops.  
: >    If source control, e.g. svn, is used then these are the files 
: >    that are under source control.  They are kept in some arbitrary 
: >    location on one's disk.  Let us say \usr\mypackage, for example.
: > 
: > *** Is there some standard name for this form of the package?
: > 
: > 2. source archive.  This is created from the original package
: >    like this:
: > 
: >      cd \Program Files\rw2001beta
: >      bin\R CMD build /usr/mypackage
: > 
: >    which creates, say
: > 
: >      \Program Files\rw2001beta\mypackage_1.0-1.tar.gz
: > 
: >    The source archive is distinct from the original archive since it
: >    is specific to a version of R and excludes the files referenced
: >    in \usr\mypackage\.Rbuildignore
: > 
: > *** Is \Program Files\rw2001beta the correct place to put this
: >    .tar.gz file?
: > 
: > 3. source tree.  This is created from the gzipped tar archive in #2
: >    like this:
: > 
: >      cd \Program Files\rw2001beta
: >      gzip -d mypackage_1.0-1.tar.gz
: >      cd src\library
: >      tar xvf ..\..\mypackage_1.0-1.tar
: > 
: >    and is checked like this:
: > 
: >      cd \Program Files\rw2001beta
: >      bin\R CMD check mypackage
: > 
: > 4. binary archive.  This is created from the source archive in #2
: >    or the source tree in #3:
: > 
: >       cd \Program Files\rw2001beta
: >       bin\R CMD build mypackage --binary
: >     
: >    which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip
: > 
: > *** Is \Program Files\rw2001beta the correct place to put this?
: > 
: > 5. installed package.  This installed by:
: > 
: >      cd \Program Files\rw2001beta
: >      bin\R CMD install mypackage
: > 
: >   which results in the source package being installed in:
: >   
: >      \Program Files\rw2001beta\library\mypackage
: > 
: >   This can alternately be done with the R GUI menu: 
: > 
: >     Packages | Install package(s) from local zip files
: > 
: > 6. loaded package.  In R using the command:
: > 
: >      library(mypackage)
: > 
: >    loads the package into R.  This can alternately be done
: >    using the R GUI menu:
: > 
: >       Packages | Load package
: > 
: > One might initially skip #3 and #4 and just test the package out
: > in R after #6 and once one is satisfied that it is in good shape
: > repeat the sequence.
: > 
: > *** Is all the above the correct and recommended sequence?
: > 
: > *** Someone mentioned that --force is important.  How does that 
: >     fit into all this?  I still have not used it and am not sure
: >     about it.
: > 
: > ______________________________________________
: > R-devel <at> stat.math.ethz.ch mailing list
: > https://stat.ethz.ch/mailman/listinfo/r-devel
: > 
: >
: 
: ______________________________________________
: R-devel <at> stat.math.ethz.ch mailing list
: https://stat.ethz.ch/mailman/listinfo/r-devel
: 
:

From ggrothendieck at myway.com  Thu Nov 11 18:29:58 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 11 18:40:54 2004
Subject: [Rd] inst/CITATION produced error during Rcmd check <package>
References: <29E0BC0C716A584582941615CF9FFB0902585D0E@ibfftce107.de.ad.drkw.net>
	<Pine.GSO.4.31.0411111643220.28252-100000@toucan.stats>
Message-ID: <loom.20041111T182803-420@post.gmane.org>

Prof Brian Ripley <ripley <at> stats.ox.ac.uk> writes:

: That you are getting FIND not `find' suggests that you have not followed
: the instructions in README.packages correctly.  Please ensure you have
: followed


When I had this problem I found I had to put the path to the UNIX-like
tools ahead of everything in my PATH variable so that the UNIX-like find
was used rather than the Windows find.

From andy_liaw at merck.com  Thu Nov 11 19:31:23 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Nov 11 19:32:12 2004
Subject: [Rd] Questions on package creation
Message-ID: <3A822319EB35174CA3714066D590DCD50994E2D7@usrymx25.merck.com>

I write most of the code in randomForest in Windows, and move to Linux when
I need to debug compiled code.  On my WinXPPro laptop, I have a directory
c:/home/R-packages/RF.  That's where the randomForest source tree lives.
When I'm ready to do some test, I would do (on the command line, in
c:/home/R-packages/RF)

  mkdir test
  R CMD INSTALL -l test randomForest

If the install is OK, I then start up Rterm or Rgui from the directory and
do

  library(randomForest, lib.loc="test")

and play with the package a bit to make sure it looks OK.  Then at the
system command line,

  R CMD check randomForest

If that goes well, I'd do:

  R CMD build --force randomForest
  R CMD build --binary randomForest

and move the .tar.gz and .zip archives to whereever I want them.  Before I
use subversion for version control, I would simply stash away the .tar.gz in
c:/home/R-packages/rf-pkg, which holds the tarball of various versions of
the package.  Not particularly efficient, obviously.

HTH,
Andy
  

> From: Gabor Grothendieck
> 
> Thanks.  One thing I would like clarified is the various locations
> and what is relative to where.
> 
> If you could add to the example where we are in terms of an example
> absolute path and where the various directories wind up also in
> terms of example absolute paths it would clear up a lot.
> 
> Liaw, Andy <andy_liaw <at> merck.com> writes:
> 
> : 
> : Gabor,
> : 
> : Here are my takes on these:
> : 
> : 1: Not that I know of.  Only the package developer(s) see 
> the code this way,
> : and is really not different from 3.  (A developer would not 
> need 3, as R CMD
> : check can be done with 1.)
> : 
> : 2 & 4: As Uwe said, the location is `whereever you like'.  
> You would create
> : them only for distribution (i.e., installation on other 
> machines), so it
> : doesn't matter where it put them.  They only exist 
> temporarily on the
> : developer's machine (assuming the source is version 
> controlled via other
> : means), as only a user wanting to install the package would 
> need the archive
> : forms.
> : 
> : Here's the sequence I use:
> : 
> : Start with a source tree for the package somewhere.
> : 
> : Testing/checking:
> : 
> : Run R CMD INSTALL -l mytest mypkg (making sure you create 
> the `mytest'
> : directory first).  This installs the package in the 
> `mytest' directory.  If
> : the install is not successful, make necessary changes.  If 
> successful, start
> : up R (from the command line) and do library(mypkg, 
> lib.loc="mytest") and run
> : some tests (e.g., example() for functions in the package).
> : 
> : After making sure the installed package looks good, run R 
> CMD check mypkg.
> : Make changes to correct errors and warnings.
> : 
> : After successful check, run R CMD build --force mypkg to 
> generate the source
> : tarball and update the INDEX file.  (The --force is only 
> needed if you
> : add/remove/change help page topics since the last build.)
> : 
> : Run R CMD build --binary mypkg if you need to distribute 
> the package in
> : binary form.
> : 
> : HTH,
> : Andy
> : 
> : > From: Gabor Grothendieck
> : > 
> : > I have some questions about 
> : > 
> : >    1. nomenclature, 
> : >    2. recommended file locations and 
> : >    3. overall procedure related to creating packages.
> : > 
> : > To the extent that it matters, examples here relate to Windows XP
> : > R 2.0.1 beta.  
> : > 
> : > The questions are interspersed and prefaced with ***.
> : > 
> : > My understanding is that there are actually 6 forms of a package
> : > that one should use in package development:
> : > 
> : > 1. original package.  This refers to the original source files, 
> : >    documentation and other files that the author develops.  
> : >    If source control, e.g. svn, is used then these are the files 
> : >    that are under source control.  They are kept in some 
> arbitrary 
> : >    location on one's disk.  Let us say \usr\mypackage, 
> for example.
> : > 
> : > *** Is there some standard name for this form of the package?
> : > 
> : > 2. source archive.  This is created from the original package
> : >    like this:
> : > 
> : >      cd \Program Files\rw2001beta
> : >      bin\R CMD build /usr/mypackage
> : > 
> : >    which creates, say
> : > 
> : >      \Program Files\rw2001beta\mypackage_1.0-1.tar.gz
> : > 
> : >    The source archive is distinct from the original 
> archive since it
> : >    is specific to a version of R and excludes the files referenced
> : >    in \usr\mypackage\.Rbuildignore
> : > 
> : > *** Is \Program Files\rw2001beta the correct place to put this
> : >    .tar.gz file?
> : > 
> : > 3. source tree.  This is created from the gzipped tar 
> archive in #2
> : >    like this:
> : > 
> : >      cd \Program Files\rw2001beta
> : >      gzip -d mypackage_1.0-1.tar.gz
> : >      cd src\library
> : >      tar xvf ..\..\mypackage_1.0-1.tar
> : > 
> : >    and is checked like this:
> : > 
> : >      cd \Program Files\rw2001beta
> : >      bin\R CMD check mypackage
> : > 
> : > 4. binary archive.  This is created from the source archive in #2
> : >    or the source tree in #3:
> : > 
> : >       cd \Program Files\rw2001beta
> : >       bin\R CMD build mypackage --binary
> : >     
> : >    which creates \Program Files\rw2001beta\myhpackage_1.0-1.zip
> : > 
> : > *** Is \Program Files\rw2001beta the correct place to put this?
> : > 
> : > 5. installed package.  This installed by:
> : > 
> : >      cd \Program Files\rw2001beta
> : >      bin\R CMD install mypackage
> : > 
> : >   which results in the source package being installed in:
> : >   
> : >      \Program Files\rw2001beta\library\mypackage
> : > 
> : >   This can alternately be done with the R GUI menu: 
> : > 
> : >     Packages | Install package(s) from local zip files
> : > 
> : > 6. loaded package.  In R using the command:
> : > 
> : >      library(mypackage)
> : > 
> : >    loads the package into R.  This can alternately be done
> : >    using the R GUI menu:
> : > 
> : >       Packages | Load package
> : > 
> : > One might initially skip #3 and #4 and just test the package out
> : > in R after #6 and once one is satisfied that it is in good shape
> : > repeat the sequence.
> : > 
> : > *** Is all the above the correct and recommended sequence?
> : > 
> : > *** Someone mentioned that --force is important.  How does that 
> : >     fit into all this?  I still have not used it and am not sure
> : >     about it.
> : > 
> : > ______________________________________________
> : > R-devel <at> stat.math.ethz.ch mailing list
> : > https://stat.ethz.ch/mailman/listinfo/r-devel
> : > 
> : >
> : 
> : ______________________________________________
> : R-devel <at> stat.math.ethz.ch mailing list
> : https://stat.ethz.ch/mailman/listinfo/r-devel
> : 
> :
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From jeff.horner at vanderbilt.edu  Thu Nov 11 22:34:35 2004
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Thu Nov 11 22:34:49 2004
Subject: [Rd] is.vector() gives error (PR#7288)
In-Reply-To: <418CEF42.70003@vanderbilt.edu>
References: <20041014162543.92EC710452@slim.kubism.ku.dk>	<x21xg19raa.fsf@biostat.ku.dk>
	<418CEF42.70003@vanderbilt.edu>
Message-ID: <4193DAEB.60303@vanderbilt.edu>

Jeffrey Horner wrote:

> Peter Dalgaard wrote:
> [...]
>
>> The other possibility is that you're tickling a low-level, system
>> dependent bug in the evaluator. Can anyone reproduce this?
>>
>
> I'm running up against this when embedding libR.so into apache2. 
> Whenever I call Rf_initEmbeddedR(), I get the following message:
>
> Error in lazyLoadDBfetch(key, datafile, compressed, envhook) :
>         recursive default argument reference a
>
> [...]

This was due to Rf_initEmbeddedR() being called more than once, which 
was not supposed to happen.

-- 
Jeffrey Horner       Computer Systems Analyst         School of Medicine
615-322-8606         Department of Biostatistics   Vanderbilt University

From htang at hpl.hp.com  Fri Nov 12 01:00:05 2004
From: htang at hpl.hp.com (htang@hpl.hp.com)
Date: Fri Nov 12 01:00:14 2004
Subject: [Rd] plot.rpart ignores uniform=TRUE if graphics device is not open
	(PR#7361)
Message-ID: <20041112000005.C7E10ED90@slim.kubism.ku.dk>

Full_Name: Hsiu-Khuern Tang
Version: 2.0.0
OS: Debian GNU/Linux
Submission from: (NULL) (156.153.255.236)


Hi all,

If fit is an rpart object,
plot(fit, uniform=TRUE)
ignores uniform=TRUE if the graphics device is not already open.

To reproduce this:

library("rpart")
example(plot.rpart)
dev.off()   # <- works OK without this
plot(fit, uniform=TRUE)   # <- uniform=TRUE is ignored

Hsiu-Khuern.

From ripley at stats.ox.ac.uk  Fri Nov 12 07:38:29 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Nov 12 07:57:26 2004
Subject: [Rd] (PR#7361) plot.rpart ignores uniform=TRUE if graphics device
	is not open
In-Reply-To: <20041112000005.C7E10ED90@slim.kubism.ku.dk>
Message-ID: <Pine.GSO.4.31.0411120637060.29039-100000@toucan.stats>

Yes.  It sets it on a per-device basis.

Please do read the FAQ, and don't make non-maintainer reports of non-bugs.

On Fri, 12 Nov 2004 htang@hpl.hp.com wrote:

> Full_Name: Hsiu-Khuern Tang
> Version: 2.0.0
> OS: Debian GNU/Linux
> Submission from: (NULL) (156.153.255.236)
>
>
> Hi all,
>
> If fit is an rpart object,
> plot(fit, uniform=TRUE)
> ignores uniform=TRUE if the graphics device is not already open.
>
> To reproduce this:
>
> library("rpart")
> example(plot.rpart)
> dev.off()   # <- works OK without this
> plot(fit, uniform=TRUE)   # <- uniform=TRUE is ignored
>
> Hsiu-Khuern.
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Bernhard.Pfaff at drkw.com  Fri Nov 12 09:42:12 2004
From: Bernhard.Pfaff at drkw.com (Pfaff, Bernhard)
Date: Fri Nov 12 09:42:28 2004
Subject: [Rd] inst/CITATION produced error during Rcmd check <package>
Message-ID: <29E0BC0C716A584582941615CF9FFB0902585D10@ibfftce107.de.ad.drkw.net>

> 
> That you are getting FIND not `find' suggests that you have 
> not followed
> the instructions in README.packages correctly.  Please ensure you have
> followed
> 
Dear Prof. Ripley and Gabor,

a big thanks to both of you for your quick and concise response. 
Yes, I did have read README.packages as well as  src/gnuwin32/INSTALL, but
obviously not carefully enough; hence it is ill-tempted to set the correct
order in the environment variable section for a *user* only, as I did
erroneously, but rather in the *system variable* section (start -> Settings
-> Control Panel -> System -> Environment Variables...). Incidentally, this
error slipped my notice since 2001. It seems that I came around with this
before using an 'inst' subdirectory for the first time.

Having said this, would it be possible and sensible to alter
src/gnuwin32/INSTALL and src/gnuwin332/README.packages in the following way:

Citation (emphasized words enclosed by ***):

BEWARE: `Native' ports of make are _not_ suitable (including that at
the mingw site).  There were also problems with several earlier
versions of the cygwin tools and dll.  To avoid frustration, please
use our tool set, and make sure it is at the front of ***your path***
(including before the Windows system directories).

Proposal:
Change ***your path*** and at the other places of its occurence in the two
documents into ***your system variables path***.

Reason:
***your path*** could be misinterpreted as the ***user path*** that might
contain Windows system directories, too. Hence, it should be made clearer
that is the path in *system variables* that matters.

What is your opinion on this issue, Prof. Ripley? Would it make sense in
your eyes, too? If so, I stand up to volunteer by applying these changes and
send you the two files off-line.

Best Regards,
Bernhard
  


--------------------------------------------------------------------------------
The information contained herein is confidential and is inte...{{dropped}}

From ripley at stats.ox.ac.uk  Fri Nov 12 10:06:23 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Nov 12 10:06:33 2004
Subject: [Rd] inst/CITATION produced error during Rcmd check <package>
In-Reply-To: <29E0BC0C716A584582941615CF9FFB0902585D10@ibfftce107.de.ad.drkw.net>
Message-ID: <Pine.GSO.4.31.0411120854460.29215-100000@toucan.stats>

On Fri, 12 Nov 2004, Pfaff, Bernhard wrote:

> >
> > That you are getting FIND not `find' suggests that you have
> > not followed
> > the instructions in README.packages correctly.  Please ensure you have
> > followed
> >
> Dear Prof. Ripley and Gabor,
>
> a big thanks to both of you for your quick and concise response.
> Yes, I did have read README.packages as well as  src/gnuwin32/INSTALL, but
> obviously not carefully enough; hence it is ill-tempted to set the correct
> order in the environment variable section for a *user* only, as I did
> erroneously, but rather in the *system variable* section (start -> Settings
> -> Control Panel -> System -> Environment Variables...). Incidentally, this
> error slipped my notice since 2001. It seems that I came around with this
> before using an 'inst' subdirectory for the first time.
>
> Having said this, would it be possible and sensible to alter
> src/gnuwin32/INSTALL and src/gnuwin332/README.packages in the following way:
>
> Citation (emphasized words enclosed by ***):
>
> BEWARE: `Native' ports of make are _not_ suitable (including that at
> the mingw site).  There were also problems with several earlier
> versions of the cygwin tools and dll.  To avoid frustration, please
> use our tool set, and make sure it is at the front of ***your path***
> (including before the Windows system directories).
>
> Proposal:
> Change ***your path*** and at the other places of its occurence in the two
> documents into ***your system variables path***.
>
> Reason:
> ***your path*** could be misinterpreted as the ***user path*** that might
> contain Windows system directories, too. Hence, it should be made clearer
> that is the path in *system variables* that matters.
>
> What is your opinion on this issue, Prof. Ripley? Would it make sense in
> your eyes, too? If so, I stand up to volunteer by applying these changes and
> send you the two files off-line.

It would not.  There is only only path (aka PATH under Windows shells)
for a shell but many different ways to set it, two of which you have
discovered.  (Win 95/98/ME do not even have the concepts of system and
user environment variables, so using that terminology will definitely
confuse such users.) How to check it is shell-specific, but we do ask you
to `make sure'.  On cmd32.exe, typing `PATH' gives you the current value,
but many users (maybe even most) use other shells.

For everything we might do to make things clearer for one user we run the
risk of making them muddier for ten others.  The only way I know to avoid
that is to be precise and use the correct terminology even if the users
may be unfamiliar with it.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From gregory.r.warnes at pfizer.com  Fri Nov 12 18:55:04 2004
From: gregory.r.warnes at pfizer.com (gregory.r.warnes@pfizer.com)
Date: Fri Nov 12 18:55:12 2004
Subject: [Rd] warnings(), last.warning, and libraries (PR#7363)
Message-ID: <20041112175504.9B5BEEB64@slim.kubism.ku.dk>


1) If warnings are generated during the installation of a library, the
'last.warning' object is retained in the environment.  

2) Since the warnings() does not explictly look in the .GlobalEnv for the
object it will find 'last.warning' objects in attached namespaces.  

--> Warnings from package instalation time can be reported at other times.

Easy solution: change the definition of warnings() to look in .GlobalEnv
explicitly.

-Greg

         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    2                
minor    0.0              
year     2004             
month    10               
day      04               
language R           




LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From steve at amcboston.org  Fri Nov 12 19:56:38 2004
From: steve at amcboston.org (steve@amcboston.org)
Date: Fri Nov 12 19:56:47 2004
Subject: [Rd] Re: Hey!
In-Reply-To: <000c01c4c8bf$6dcb5f50$546ff78c@sebring>
References: <000c01c4c8bf$6dcb5f50$546ff78c@sebring>
Message-ID: <200411121856.iACIucD9000433@host25.webserver1010.com>

No such recipient at this domain.

From kwright at eskimo.com  Fri Nov 12 20:01:47 2004
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Fri Nov 12 20:01:58 2004
Subject: [Rd] Requested consideration: true, true, true in SearchObject.html
Message-ID: <51507.170.54.59.167.1100286107.squirrel@170.54.59.167>


I've just posted an email to R-help with instructions on creating a
Firefox keyword search of the R documentation:
https://www.stat.math.ethz.ch/pipermail/r-help/2004-November/059272.html

The method involves bookmarking the
RHOME/doc/html/search/SearchObject.html file.  Currently this page is set
up to only search help page titles:
line = line + document.SearchEngine.search (searchstring,true,false,false);

Note that by default the SearchEngine.html page has the Titles, Keywords
and Objects boxes all checked.

It would be useful for the keyword search to have SearchObject.html
include Title and Object name searches by default:
  line = line + document.SearchEngine.search (searchstring,true,true,true);

When I used 'grep -r SearchObject *' from RHOME, the only hits were to
  doc/html/search/Makefile.in
  share/perl/R/Rdconv.pm
The latter appears to create hyperlinks in the "See Also" section of help
pages.

A better possibility might be to create a new file (ex: SearchAll.html)
and include the requested change there.

Thanks for considering this request.

Sincerly,

Kevin Wright

From paul.louisell at pw.utc.com  Fri Nov 12 23:26:26 2004
From: paul.louisell at pw.utc.com (paul.louisell@pw.utc.com)
Date: Fri Nov 12 23:26:36 2004
Subject: [Rd] Loading libraries in 2.0.0 (PR#7364)
Message-ID: <20041112222626.9D62CEB64@slim.kubism.ku.dk>

I'm using version 2.0.0 of R on a Windows 2000 OS. Packages that I installed
in 1.9.1 are not installing properly in 2.0.0. Specifically, I can install
packages from local zip files with the following code (which I execute
through the GUI):

> install.packages(choose.files('',filters=Filters[c('zip','All'),]),
.libPaths()[1], CRAN = NULL)
updating HTML package descriptions
> install.packages(choose.files('',filters=Filters[c('zip','All'),]),
.libPaths()[1], CRAN = NULL)
updating HTML package descriptions

The packages do show up in the html help files after installing them. But
the packages won't load when I use the library command:

> library(repeated)
Error in library(repeated) : 'repeated' is not a valid package -- installed
< 2.0.0?

Moreover, the package also shows up when I use the 'help' parameter in the
library command:

> library(help=repeated)

A window with the list of functions in package repeated appears. Has anyone
else had problems with this? I couldn't find anything in the Changes file
for 2.0.0 that looked like it would be responsible for this.

Thanks for your help with this,


Paul Louisell
Statistician
Pratt & Whitney
TechNet: 435-5417
louisept@pweh.com

From ripley at stats.ox.ac.uk  Fri Nov 12 23:41:22 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri Nov 12 23:41:32 2004
Subject: [Rd] Loading libraries in 2.0.0 (PR#7364)
Message-ID: <20041112224122.E91F2EB64@slim.kubism.ku.dk>

Where do you think the bug is here?  Both the NEWS file (in the very first 
section) and the rw-FAQ tell you explicitly that packages (sic) have to be 
reinstalled for 2.0.0.  So does the error message you quote.  What do you 
think

     o   Packages must have been re-installed for this version, and
         library() will enforce this.

means?  Why do you think the major number has been changed from 1 to 2?

Since you are clearly not sure, the FAQ specifically asks you NOT to file 
a bug report but to ask someone who knows.

There are updated Windows builds for Lindsey's `libraries' on his site.

On Fri, 12 Nov 2004 paul.louisell@pw.utc.com wrote:

> I'm using version 2.0.0 of R on a Windows 2000 OS. Packages that I installed
> in 1.9.1 are not installing properly in 2.0.0. Specifically, I can install
> packages from local zip files with the following code (which I execute
> through the GUI):
>
>> install.packages(choose.files('',filters=Filters[c('zip','All'),]),
> .libPaths()[1], CRAN = NULL)
> updating HTML package descriptions
>> install.packages(choose.files('',filters=Filters[c('zip','All'),]),
> .libPaths()[1], CRAN = NULL)
> updating HTML package descriptions
>
> The packages do show up in the html help files after installing them. But
> the packages won't load when I use the library command:
>
>> library(repeated)
> Error in library(repeated) : 'repeated' is not a valid package -- installed
> < 2.0.0?
>
> Moreover, the package also shows up when I use the 'help' parameter in the
> library command:
>
>> library(help=repeated)

Yes, the package is there but it is not valid -- as the error message 
says.  Whatever DO you think the message means?

> A window with the list of functions in package repeated appears. Has anyone
> else had problems with this? I couldn't find anything in the Changes file
> for 2.0.0 that looked like it would be responsible for this.
>
> Thanks for your help with this,
>
>
> Paul Louisell
> Statistician
> Pratt & Whitney
> TechNet: 435-5417
> louisept@pweh.com
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Fri Nov 12 23:54:54 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Nov 12 23:56:19 2004
Subject: [Rd] Loading libraries in 2.0.0 (PR#7364)
In-Reply-To: <20041112222626.9D62CEB64@slim.kubism.ku.dk>
References: <20041112222626.9D62CEB64@slim.kubism.ku.dk>
Message-ID: <x2lld68ypt.fsf@biostat.ku.dk>

paul.louisell@pw.utc.com writes:

> I'm using version 2.0.0 of R on a Windows 2000 OS. Packages that I installed
> in 1.9.1 are not installing properly in 2.0.0. Specifically, I can install
> packages from local zip files with the following code (which I execute
> through the GUI):
> 
> > install.packages(choose.files('',filters=Filters[c('zip','All'),]),
> .libPaths()[1], CRAN = NULL)
> updating HTML package descriptions
> > install.packages(choose.files('',filters=Filters[c('zip','All'),]),
> .libPaths()[1], CRAN = NULL)
> updating HTML package descriptions
> 
> The packages do show up in the html help files after installing them. But
> the packages won't load when I use the library command:
> 
> > library(repeated)
> Error in library(repeated) : 'repeated' is not a valid package -- installed
> < 2.0.0?

Notice that "installed" actually means "built as binary" here, since
zip files are mostly just unpacked into place, and the install step is
done prior to packaging. So you should take the error message as a
hint to get a newer zip file (available from the same place).

This is not a bug.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From kwright at eskimo.com  Sat Nov 13 02:35:11 2004
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Sat Nov 13 02:35:21 2004
Subject: [Rd] Re: Requested consideration: true, true,
	true in SearchObject.html
Message-ID: <3068.66.185.0.207.1100309711.squirrel@66.185.0.207>


Hold off on this request.  I don't have the details quite right.  The
keyword search works, but what exactly it returns is not clear to me. 
It's not the same as searching from the SearchEngine.html page.

If anybody figures this out before me, great.  Otherwise I continue to
flounder around by trial and error through the javascript to figure this
out...

Kevin Wright

From isto.aho at kolumbus.fi  Sun Nov 14 16:43:15 2004
From: isto.aho at kolumbus.fi (isto.aho@kolumbus.fi)
Date: Sun Nov 14 16:43:26 2004
Subject: [Rd] overflow in RExcel (PR#7368)
Message-ID: <20041114154315.7F06AEAE5@slim.kubism.ku.dk>

Full_Name: Isto Aho
Version: 2.0.0
OS: Windows XP
Submission from: (NULL) (80.186.9.143)


Hi,

The bug can be reproduced as follows.  Install R 2.0.0 and RExcel.
Take an excel sheet having 65000 rows and 11 columns, integer values.

Give the 'context' command 'put R val' for the large enough selection
of rows.  (I didn't check, how many are needed, but it seems that
10000 rows will suffice.)

When trying to 'Get R val', there will be an error. (If there are too
much rows, RExcel will just hang.) 

Some of the VBA routines seemed to have integer indeces.  Could this
be the source of problems?

I would need this on next week (by wednesday 17.11.2004), but I'm
afraid that it is impossible to get this fixed in this short time.
(I don't know how to do this myself and don't have enough time
to learn.)

In any case, for future use, it would be nice to be able to use
matrices having 65000 rows with RExcel.

Best wishes, Isto

From ripley at stats.ox.ac.uk  Sun Nov 14 17:08:11 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun Nov 14 17:08:20 2004
Subject: [Rd] overflow in RExcel (PR#7368)
Message-ID: <20041114160811.050CFEAC0@slim.kubism.ku.dk>

This is a bug report on RExcel, which is not a product of the R project 
whose bug repository you have misused.

Please do read the R FAQ and the RExcel information find out where to 
report such bugs.

On Sun, 14 Nov 2004 isto.aho@kolumbus.fi wrote:

> Full_Name: Isto Aho
> Version: 2.0.0
> OS: Windows XP
> Submission from: (NULL) (80.186.9.143)
>
>
> Hi,
>
> The bug can be reproduced as follows.  Install R 2.0.0 and RExcel.
> Take an excel sheet having 65000 rows and 11 columns, integer values.
>
> Give the 'context' command 'put R val' for the large enough selection
> of rows.  (I didn't check, how many are needed, but it seems that
> 10000 rows will suffice.)
>
> When trying to 'Get R val', there will be an error. (If there are too
> much rows, RExcel will just hang.)
>
> Some of the VBA routines seemed to have integer indeces.  Could this
> be the source of problems?
>
> I would need this on next week (by wednesday 17.11.2004), but I'm
> afraid that it is impossible to get this fixed in this short time.
> (I don't know how to do this myself and don't have enough time
> to learn.)
>
> In any case, for future use, it would be nice to be able to use
> matrices having 65000 rows with RExcel.
>
> Best wishes, Isto
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From harald.weedon-fekjar at medisin.uio.no  Sun Nov 14 21:01:05 2004
From: harald.weedon-fekjar at medisin.uio.no (harald.weedon-fekjar@medisin.uio.no)
Date: Sun Nov 14 21:01:16 2004
Subject: [Rd] Rcmd check for Windows fails (PR#7369)
Message-ID: <20041114200105.15DAFEAE5@slim.kubism.ku.dk>

Full_Name: Harald Weedon-Fekj?r
Version: 2.0
OS: Windows
Submission from: (NULL) (80.202.87.143)


Dear R core

Thanks again for a superb program. This is really one of the rare instances I
find a bug. The bug is easy to bypass, but can be quite confusing;

"Rcmd check" seems to fail without any good error report if the package contains
a certain amount of R code and is run from a directory contain a space in the
name (strange, but ...very annoying as I tried to include/exclude new parts many
times).

For error report and the source that fail, see:
http://folk.uio.no/hfe/pub/slettes-dato/2005-12/addreg-check-log.txt
http://folk.uio.no/hfe/pub/slettes-dato/2005-12/addreg.zip

Feedback would be welcommed.

PS: R is really a wounder full program. S-PLUS used to be "best command line
statistical package", no it is just "best money can buy". Use R in nearly all my
work!

Best
Harald Weedon-Fekjaer, Oslo, Norway

From p.dalgaard at biostat.ku.dk  Sun Nov 14 21:20:50 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Nov 14 21:22:19 2004
Subject: [Rd] Rcmd check for Windows fails (PR#7369)
In-Reply-To: <20041114200105.15DAFEAE5@slim.kubism.ku.dk>
References: <20041114200105.15DAFEAE5@slim.kubism.ku.dk>
Message-ID: <x28y94ji71.fsf@biostat.ku.dk>

harald.weedon-fekjar@medisin.uio.no writes:

> "Rcmd check" seems to fail without any good error report if the package contains
> a certain amount of R code and is run from a directory contain a space in the
> name (strange, but ...very annoying as I tried to include/exclude new parts many
> times).
> 
> For error report and the source that fail, see:
> http://folk.uio.no/hfe/pub/slettes-dato/2005-12/addreg-check-log.txt
> http://folk.uio.no/hfe/pub/slettes-dato/2005-12/addreg.zip
> 
> Feedback would be welcommed.

If you're quick you could check and tell us whether this is fixed in
2.0.1, see

http://cran.r-project.org/bin/windows/base/rpatched.html

In particular, this stuff from the CHANGES file could be relevant:

"We have increased the chances that installing a source package from
an explicit path with spaces in will work, so e.g.

    R CMD INSTALL "/Documents and Settings/myname/Source Files/mypkg"

will probably work -- it is still not recommended.  You can also
get away with backslashes here, but forward slashes are safer."


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Sun Nov 14 22:07:21 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun Nov 14 22:07:38 2004
Subject: [Rd] Rcmd check for Windows fails (PR#7369)
Message-ID: <20041114210721.87087EAE5@slim.kubism.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--27464147-1359797818-1100466430=:26232
Content-Type: TEXT/PLAIN; charset=iso-8859-1; format=flowed
Content-Transfer-Encoding: QUOTED-PRINTABLE

On Sun, 14 Nov 2004 harald.weedon-fekjar@medisin.uio.no wrote:

> Full_Name: Harald Weedon-Fekj=E6r
> Version: 2.0
> OS: Windows
> Submission from: (NULL) (80.202.87.143)
>
>
> Dear R core
>
> Thanks again for a superb program. This is really one of the rare instanc=
es I
> find a bug. The bug is easy to bypass, but can be quite confusing;
>
> "Rcmd check" seems to fail without any good error report if the package=
=20
> contains a certain amount of R code and is run from a directory contain=
=20
> a space in the name (strange, but ...very annoying as I tried to=20
> include/exclude new parts many times).

Please *do* read README.packages, which does tell you that is not=20
supported.

It does in 2.0.1 beta, BTW, due for release tomorrow.  The CHANGES file=20
says

We have increased the chances that installing a source package from
an explicit path with spaces in will work, so e.g.

     R CMD INSTALL "/Documents and Settings/myname/Source Files/mypkg"

will probably work -- it is still not recommended.  You can also
get away with backslashes here, but forward slashes are safer.

--=20
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595
--27464147-1359797818-1100466430=:26232--

From BRmultiaccess at rsinet.com.br  Mon Nov 15 14:44:52 2004
From: BRmultiaccess at rsinet.com.br (BRmultiaccess@rsinet.com.br)
Date: Mon Nov 15 13:43:29 2004
Subject: [Rd] =?iso-8859-1?q?=28BRMA=29_=5BSupTec_RSI=5D_Email_n=E3o_envi?=
	=?iso-8859-1?q?ado?=
Message-ID: <200411151344.iAFDiq306915@rsinet.com.br>


[SupTec RSI] Email n?o enviado
----------------------------------------
Sua mensagem apresenta arquivo(s) anexo(s) que pela sua natureza podem conter programas potencialmente portadores de v?rus e, por este motivo tais arquivos n?o foram encaminhados ao destinat?rio. Infelizmente tal procedimento tornou-se necess?rio devido a atual onda de propaga??o de v?rus anexados a e-mails e distribu?dos de forma autom?tica e involunt?ria.
----------------------------------------
Para:  rh@rsinet.com.br
Assunto:  Re: important

From hb at maths.lth.se  Mon Nov 15 19:53:35 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Mon Nov 15 19:54:08 2004
Subject: [Rd] UseMethod call with no arguments
Message-ID: <005001c4cb44$697b7610$e502eb82@hblaptop>

Dear R developers,

I will ask a very straightforward question concerning UseMethod's future,
because people depending on my code wonder what will happen to it next.

In R v2.0.1 NEWS it says

    o	The undocumented use of UseMethod() with no argument is now
	formally deprecated. 

and in the R v2.0.1 help(UseMethod) it says

  'UseMethod' accepts a call with no arguments and tries to deduce
   the generic from the context.  This was undocumented on the help
   page and is now deprecated.  It is allowed but 'strongly
   discouraged' in S-PLUS.

The short question is: UseMethod() with no arguments is deprecated.
Typically, after making something deprecated it will later become defunct.
Do you have any plans for when this will happen? Are we talking months,
years or in reality never? A version number?

Second, in R v2.0.0 NEWS there was nothing on making UseMethod() without
arguments deprecated (the latest patched version I have is dated October
21st). As I believe a rather big step has been taken, I am somewhat
surprised that I haven't seen it discussed. Was there a discussion taking
place elsewhere that I missed, or is it an "obvious" update?

Finally, many thanks for making R (the software, the help, the community,
...) to what it is.

Best wishes

Henrik Bengtsson

Dept. of Mathematical Statistics @ Centre for Mathematical Sciences 
Lund Institute of Technology/Lund University, Sweden (+2h UTC)
+46 46 2229611 (off), +46 708 909208 (cell), +46 46 2224623 (fax)
h b @ m a t h s . l t h . s e, http://www.maths.lth.se/~hb/

From Richard.Beare at csiro.au  Tue Nov 16 03:32:40 2004
From: Richard.Beare at csiro.au (Richard Beare)
Date: Tue Nov 16 03:32:54 2004
Subject: [Rd] Any success with RDCOMServer and R-2.0.0?
Message-ID: <419966C8.9060007@csiro.au>

Hi Everyone,
I'm experimenting with the RDCOMServer package under R-2.0.0. I'm not 
having much success yet - the methods im registering do show up in the 
registry but I'm not able to call the using RDCOMClient from another 
package. I'm still attempting to diagnose my problem in other ways, but 
though I should check to see if there are any problems have been 
observed by others using this combination?

Thanks

-- 
Richard Beare, CSIRO Mathematical & Information Sciences
Locked Bag 17, North Ryde, NSW 1670, Australia
Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200

Richard.Beare@csiro.au

From ripley at stats.ox.ac.uk  Tue Nov 16 10:08:20 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 16 10:08:33 2004
Subject: [Rd] Any success with RDCOMServer and R-2.0.0?
In-Reply-To: <419966C8.9060007@csiro.au>
References: <419966C8.9060007@csiro.au>
Message-ID: <Pine.LNX.4.61.0411160904040.17026@gannet.stats>

RDCOMServer is part of Omegahat not R.  Were its mailing lists operational 
that would be the appropriate place, but they were down last time I 
looked.

A few of us have tried to compile RDCOMServer and been put off/stumped by 
its non-standard features (it refers to the source tree, for example). 
After a number of changes I had it working rather minimally.

I think you need to talk directly to the package maintainer, as the R FAQ 
and the posting guide advise.

On Tue, 16 Nov 2004, Richard Beare wrote:

> I'm experimenting with the RDCOMServer package under R-2.0.0. I'm not having 
> much success yet - the methods im registering do show up in the registry but 
> I'm not able to call the using RDCOMClient from another package. I'm still 
> attempting to diagnose my problem in other ways, but though I should check to 
> see if there are any problems have been observed by others using this 
> combination?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hb at maths.lth.se  Tue Nov 16 12:54:51 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Tue Nov 16 12:55:08 2004
Subject: [Rd] UseMethod call with no arguments - solved, I think
In-Reply-To: <005001c4cb44$697b7610$e502eb82@hblaptop>
Message-ID: <002301c4cbd3$15268340$e502eb82@hblaptop>

Hmmm, to follow up on my own question; it is likely that I have
misunderstood the update note. Now, I read it as

foo <- function(x, ...) UseMethod()

is deprecated and that

foo <- function(x, ...) UseMethod("foo", x)

( or foo <- function(x, ...) UseMethod("foo") )

should be used.

My concern/interpretation was that

bar <- function(...) UseMethod("bar")

is deprecated (where I saw "..." as the "arguments"). Reading ?UseMethod
more carefully (it still says) - "If it is called with just one argument,
the class of the first argument of the enclosing function is used as
'object': unlike S this is the actual argument passed and not the current
value of the object of that name." - I see that the above should still be
fine.

So, now the note makes perfectly sense and it is *not* a "big step".

Best wishes

Henrik


> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of 
> Henrik Bengtsson
> Sent: Monday, November 15, 2004 7:54 PM
> To: R-devel@r-project.org
> Subject: [Rd] UseMethod call with no arguments
> 
> 
> Dear R developers,
> 
> I will ask a very straightforward question concerning 
> UseMethod's future, because people depending on my code 
> wonder what will happen to it next.
> 
> In R v2.0.1 NEWS it says
> 
>     o	The undocumented use of UseMethod() with no argument is now
> 	formally deprecated. 
> 
> and in the R v2.0.1 help(UseMethod) it says
> 
>   'UseMethod' accepts a call with no arguments and tries to deduce
>    the generic from the context.  This was undocumented on the help
>    page and is now deprecated.  It is allowed but 'strongly
>    discouraged' in S-PLUS.
> 
> The short question is: UseMethod() with no arguments is 
> deprecated. Typically, after making something deprecated it 
> will later become defunct. Do you have any plans for when 
> this will happen? Are we talking months, years or in reality 
> never? A version number?
> 
> Second, in R v2.0.0 NEWS there was nothing on making 
> UseMethod() without arguments deprecated (the latest patched 
> version I have is dated October 21st). As I believe a rather 
> big step has been taken, I am somewhat surprised that I 
> haven't seen it discussed. Was there a discussion taking 
> place elsewhere that I missed, or is it an "obvious" update?
> 
> Finally, many thanks for making R (the software, the help, 
> the community,
> ...) to what it is.
> 
> Best wishes
> 
> Henrik Bengtsson
> 
> Dept. of Mathematical Statistics @ Centre for Mathematical Sciences 
> Lund Institute of Technology/Lund University, Sweden (+2h UTC)
> +46 46 2229611 (off), +46 708 909208 (cell), +46 46 2224623 (fax)
> h b @ m a t h s . l t h . s e, http://www.maths.lth.se/~hb/
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From ripley at stats.ox.ac.uk  Tue Nov 16 13:36:29 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 16 13:36:40 2004
Subject: [Rd] UseMethod call with no arguments - solved, I think
In-Reply-To: <002301c4cbd3$15268340$e502eb82@hblaptop>
References: <002301c4cbd3$15268340$e502eb82@hblaptop>
Message-ID: <Pine.LNX.4.61.0411161203070.19666@gannet.stats>

On Tue, 16 Nov 2004, Henrik Bengtsson wrote:

> Hmmm, to follow up on my own question; it is likely that I have
> misunderstood the update note. Now, I read it as

> foo <- function(x, ...) UseMethod()
>
> is deprecated and that

That _is_ what it said.

> foo <- function(x, ...) UseMethod("foo", x)
>
> ( or foo <- function(x, ...) UseMethod("foo") )
>
> should be used.
>
> My concern/interpretation was that
>
> bar <- function(...) UseMethod("bar")
>
> is deprecated (where I saw "..." as the "arguments"). Reading ?UseMethod

I don't read that as being supported, and it does not work in S.  `...' is 
not strictly an argument of a function, and is usually documented as 
`further arguments'.

> more carefully (it still says) - "If it is called with just one argument,
> the class of the first argument of the enclosing function is used as
> 'object': unlike S this is the actual argument passed and not the current
> value of the object of that name." - I see that the above should still be
> fine.

> So, now the note makes perfectly sense and it is *not* a "big step".

However, removing undocumented features can happen at any time.  There is 
danger in using unusual constructions that may be allowed according to 
some particular reading of some of the documentation.  In particular, 
consider the following

> bar <- function(..., x) UseMethod("bar")
> bar.foo <- function(..., x) print("foo")
> x <- structure(1, class="foo")
> bar(x) # arg is part of ...
[1] "foo"
> bar(x=x) # arg is matched to x
[1] "foo"
> bar(1, x=x)
Error in bar(1, x) : no applicable method for "bar"
> bar <- function(y, x, ...) UseMethod("bar")
> bar(x) # matches y
[1] "foo"
> bar(x=x) # matches x
[1] "foo"

and I don't think there is any intention that such behaviour will 
necessarily continue (the last one does look like an error).  The 
rules seem not to be written down clearly enough.

>
> Best wishes
>
> Henrik
>
>
>> -----Original Message-----
>> From: r-devel-bounces@stat.math.ethz.ch
>> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of
>> Henrik Bengtsson
>> Sent: Monday, November 15, 2004 7:54 PM
>> To: R-devel@r-project.org
>> Subject: [Rd] UseMethod call with no arguments
>>
>>
>> Dear R developers,
>>
>> I will ask a very straightforward question concerning
>> UseMethod's future, because people depending on my code
>> wonder what will happen to it next.
>>
>> In R v2.0.1 NEWS it says
>>
>>     o	The undocumented use of UseMethod() with no argument is now
>> 	formally deprecated.
>>
>> and in the R v2.0.1 help(UseMethod) it says
>>
>>   'UseMethod' accepts a call with no arguments and tries to deduce
>>    the generic from the context.  This was undocumented on the help
>>    page and is now deprecated.  It is allowed but 'strongly
>>    discouraged' in S-PLUS.
>>
>> The short question is: UseMethod() with no arguments is
>> deprecated. Typically, after making something deprecated it
>> will later become defunct. Do you have any plans for when
>> this will happen? Are we talking months, years or in reality
>> never? A version number?
>>
>> Second, in R v2.0.0 NEWS there was nothing on making
>> UseMethod() without arguments deprecated (the latest patched
>> version I have is dated October 21st). As I believe a rather
>> big step has been taken, I am somewhat surprised that I
>> haven't seen it discussed. Was there a discussion taking
>> place elsewhere that I missed, or is it an "obvious" update?
>>
>> Finally, many thanks for making R (the software, the help,
>> the community,
>> ...) to what it is.
>>
>> Best wishes
>>
>> Henrik Bengtsson
>>
>> Dept. of Mathematical Statistics @ Centre for Mathematical Sciences
>> Lund Institute of Technology/Lund University, Sweden (+2h UTC)
>> +46 46 2229611 (off), +46 708 909208 (cell), +46 46 2224623 (fax)
>> h b @ m a t h s . l t h . s e, http://www.maths.lth.se/~hb/
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dgrove at fhcrc.org  Tue Nov 16 23:32:15 2004
From: dgrove at fhcrc.org (Douglas Grove)
Date: Tue Nov 16 23:32:28 2004
Subject: [Rd] modification of BATCH
Message-ID: <Pine.LNX.4.58.0411161409530.7962@echidna.fhcrc.org>

Hi,

I'm having a problem (of my own creation) with BATCH.

The current problem (for me):
----------------------------
I'm sloppy.  I work on *nux systems and will type e.g. "R CMD BATCH a*R out"
to avoid typing the full name of some R script of mine.  However,
sometimes I'm overly sloppy and there are multiple files that match
"a*R", so "a*R" turns into e.g. "aa.R ab.R", and the arguments to
BATCH will be "aa.R ab.R out".  BATCH will use aa.R as the input file and
ab.R as the output file, leading to my script ab.R being overwritten.
I then have to plead to my sysadm to restore the file for me.

I've done this often enough that I need to make a modification to BATCH,
and was wondering if anything can be done about this that can be used
generally.  In other words, is there a fix to my problem that would be
usable in general and won't mess up something else?


Solutions:
-----------
A simple solution to this problem is to print a message and exit when
more than 2 arguments are found.  While I don't know why offhand, there's
probably a reason why people would like to pass extra arguments and have
them ignored by BATCH.  If so, this won't work in general.

Something more intelligent would be to examine the first two arguments
and if they both end in .R then issue a message and exit.  I would think
create fewer problems.  I don't think many people are using R scripts to
create other R scripts, and if they are they can always rename them after
they create them.

I'm just going to go for the simple solution for now, but wanted to toss
this issue out in case it might be something that could be integrated
into the official BATCH script.

Thanks,

Doug Grove
Statistical Research Associate
Fred Hutchinson Cancer Research Center
Seattle, WA

From lgautier at altern.org  Wed Nov 17 21:37:46 2004
From: lgautier at altern.org (Laurent Gautier)
Date: Wed Nov 17 08:32:09 2004
Subject: [Rd] bug in methods' 'initialize' (or the functions called in turn)
	?
Message-ID: <419BB69A.2040805@altern.org>

Hi,

I experience a very strange behaviour when trying to instanciate a S4 
class. A call like 'r <- new("MyClass", foo="bar")' returns apparently 
cleanly, but in fact a subsequent use of 'r' results in a 'r does not 
exist error message'. After a bit of hunting with 'debug', it seems that
the bug is in 'initialize' (or one of the functions it calls in turn).
All this while using R-devel from Nov. 16th (R-2.0.1-devel).

I did manage to make a simple example to reproduce the bug, but to do so 
one needs few packages from the bioconductor project. If this is not yet 
know and one shows interest, I can provide the few lines of code needed 
to reproduce it.


L.

From clock at twibright.com  Wed Nov 17 10:09:59 2004
From: clock at twibright.com (clock@twibright.com)
Date: Wed Nov 17 10:10:06 2004
Subject: [Rd] R: prcomp documentation (PR#7372)
Message-ID: <20041117090959.606B11043D@slim.kubism.ku.dk>

Hello

help(prcomp) documentation doesn't say that dimensionality of the data treated
is number of columns of the matrix. I suggest this to be added somewhere near
the description of the matrix argument 'x'.

Cl<

From ripley at stats.ox.ac.uk  Wed Nov 17 10:31:55 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 17 10:32:07 2004
Subject: [Rd] R: prcomp documentation (PR#7372)
In-Reply-To: <20041117090959.606B11043D@slim.kubism.ku.dk>
References: <20041117090959.606B11043D@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0411170929140.19945@gannet.stats>

I have no idea what you mean by this.  prcomp works on a matrix, which has 
two dimensions, and what you mean by `dimensionality of the data' in PCA 
depends on whether you are doing R mode or Q mode PCA.

Have you read the references on the help page?

On Wed, 17 Nov 2004 clock@twibright.com wrote:

> help(prcomp) documentation doesn't say that dimensionality of the data treated
> is number of columns of the matrix. I suggest this to be added somewhere near
> the description of the matrix argument 'x'.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Wed Nov 17 11:05:14 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed Nov 17 11:04:41 2004
Subject: [Rd] bug in methods' 'initialize' (or the functions called in
	turn)	?
In-Reply-To: <419BB69A.2040805@altern.org>
References: <419BB69A.2040805@altern.org>
Message-ID: <419B225A.2000408@statistik.uni-dortmund.de>

Laurent Gautier wrote:

> Hi,
> 
> I experience a very strange behaviour when trying to instanciate a S4 
> class. A call like 'r <- new("MyClass", foo="bar")' returns apparently 
> cleanly, but in fact a subsequent use of 'r' results in a 'r does not 
> exist error message'. After a bit of hunting with 'debug', it seems that
> the bug is in 'initialize' (or one of the functions it calls in turn).
> All this while using R-devel from Nov. 16th (R-2.0.1-devel).
> 
> I did manage to make a simple example to reproduce the bug, but to do so 
> one needs few packages from the bioconductor project. If this is not yet 
> know and one shows interest, I can provide the few lines of code needed 
> to reproduce it.


Two points:

a) yes, please alsways specify a simple reproducible example when 
talking about a "bug";

b) if this "bug" does not appear in R-2.0.1 but only in the current 
R-devel, it might be worth to wait a couple of days. Perhaps someone is 
including some new functionality and has not yet finished the updates.

Uwe Ligges


> 
> L.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From wolski at molgen.mpg.de  Wed Nov 17 10:09:04 2004
From: wolski at molgen.mpg.de (Witold Eryk Wolski)
Date: Wed Nov 17 11:06:08 2004
Subject: [Rd] R/S-related projects on  Sourceforge?   Trove Categorization 
Message-ID: <419B1530.1090208@molgen.mpg.de>

Hi R-Users and Developers,

Several months ago I made a request on Sourceforge to add the R/S - 
programming language to the _Trove_ categorization. ("The Trove is a 
means to convey basic metainformation about your project.")

Today I got the following response of one of the sourceforge admins.

<SNIP>

SourceForge.net will consider the inclusion of a programming
language within the Trove system when we host at least 5
projects based on that language.  Please advise: Do you know
of 5 projects hosted on SourceForge.net based on this language?
<SNIP>


If anyone of you knew about R-packages, or projects using the R/S programming language, which are hosted on sourceforge, please reply to this thread. I hope that your answers will enable me to give more then 5 examples of R projects hosted on Sourceforge.

Yours Eryk


Ps.

The ID of my original "feature request"  on Sourceforge is 967697.
https://sourceforge.net/tracker/?func=detail&atid=350001&aid=967697&group_id=1

-- 
Dipl. bio-chem. Witold Eryk Wolski
MPI-Moleculare Genetic
Ihnestrasse 63-73 14195 Berlin
tel: 0049-30-83875219                 __("<    _
http://www.molgen.mpg.de/~wolski      \__/    'v'
http://r4proteomics.sourceforge.net    ||    /   \
mail: witek96@users.sourceforge.net    ^^     m m
      wolski@molgen.mpg.de

From ernesto at ipimar.pt  Wed Nov 17 11:09:23 2004
From: ernesto at ipimar.pt (Ernesto Jardim)
Date: Wed Nov 17 11:27:56 2004
Subject: [Rd] Re: [R] R/S-related projects on  Sourceforge?   Trove
	Categorization
In-Reply-To: <419B1530.1090208@molgen.mpg.de>
References: <419B1530.1090208@molgen.mpg.de>
Message-ID: <1100686162.8471.4.camel@mordor.ipimar.pt>

Hi,

I have 2 _small_ projects hosted in sf.net that use R 

FLR :: R for fisheries science (http://flr.sf.net)
fsap: fish stock assessment for R (http://sf.net/projects/fsap)

The first one is getting some hip and the second is dying ...

Hope it helps.

Regards

EJ

On Wed, 2004-11-17 at 09:09, Witold Eryk Wolski wrote:
> Hi R-Users and Developers,
> 
> Several months ago I made a request on Sourceforge to add the R/S - 
> programming language to the _Trove_ categorization. ("The Trove is a 
> means to convey basic metainformation about your project.")
> 
> Today I got the following response of one of the sourceforge admins.
> 
> <SNIP>
> 
> SourceForge.net will consider the inclusion of a programming
> language within the Trove system when we host at least 5
> projects based on that language.  Please advise: Do you know
> of 5 projects hosted on SourceForge.net based on this language?
> <SNIP>
> 
> 
> If anyone of you knew about R-packages, or projects using the R/S programming language, which are hosted on sourceforge, please reply to this thread. I hope that your answers will enable me to give more then 5 examples of R projects hosted on Sourceforge.
> 
> Yours Eryk
> 
> 
> Ps.
> 
> The ID of my original "feature request"  on Sourceforge is 967697.
> https://sourceforge.net/tracker/?func=detail&atid=350001&aid=967697&group_id=1

From ggrothendieck at myway.com  Wed Nov 17 17:48:30 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Nov 17 17:48:43 2004
Subject: [Rd] Re: R/S-related projects on Sourceforge? Trove Categorization
References: <419B1530.1090208@molgen.mpg.de>
Message-ID: <loom.20041117T173057-901@post.gmane.org>

Witold Eryk Wolski <wolski@...> writes:

: 
: Hi R-Users and Developers,
: 
: Several months ago I made a request on Sourceforge to add the R/S - 
: programming language to the _Trove_ categorization. ("The Trove is a 
: means to convey basic metainformation about your project.")

It might be worthwhile to consider all the possible sourceforge-like
sites in case there is a particular advantage of one over the others.
For example, it might be better to choose one with svn support than
one that only has cvs support. Sites include sourceforge, savannah, 
berlios, seul and a few others, some of which are listed at
http://www.ibiblio.org/fosphost/exhost.htm .

Also some languages have started their own sourceforge-style
project repositories such as luaforge.net and rubyforge.org and one
could conceivably have an Rforge too.

I don't know enough about the above sites to say much more but I think
the key requirements are to provide support to addon packages and
projects to encourage the current explosion of such software.
The idea would be to automate the setup of an infrastructure that
includes such things as:

- X-help and X-devel email distribution lists for project X
- access to svn so developers can coordinate their efforts on a project
- wiki, forums, other groupware
- web space for a home page
- ftp space for archiving old versions and distributing beta versions
- slick package development tools to make it easier to develop packages
- ensure that there are a really good set of base classes in the core
  for projects to leverage off of

From ggrothendieck at myway.com  Wed Nov 17 19:10:20 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Nov 17 19:10:41 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore
Message-ID: <loom.20041117T190158-839@post.gmane.org>


I have some questions about building packages in Windows 
when using .Rbuildignore .  The part of the process that
is of interest here is the part that creates the source
tree from the tree that contains the .Rbuildignore file.
That is, the part of the process that does a build of
the original tree creating a .tar.gz and then extracts
this file into a source directory that can be used by
check, build --binary and install.

1. makefiles

I was developing some batch files for myself using R CMD ...
but then noticed the Windows makefiles.

- Do the makefiles take into account the situation above?

- If so, do I need to do anything special to use them this way?

2. configure.win

Also I noticed reference to configure.win in the Extensions
manual and am not sure if that can be used to address this.
I tried creating a one line configure.win which just does
an echo of a fixed string "echo XYZ" but I did not see XYZ
during my R CMD install.

- Is configure.win supposed to be written using Windows batch commands
  or UNIX-like commands?

- where does it go.  (I tried putting it in the same directory as
  my DESCRIPTION file.)

- is it a suitable device for handling the .Rbuildignore issue?

Thanks.

From htang at hpl.hp.com  Wed Nov 17 19:57:21 2004
From: htang at hpl.hp.com (htang@hpl.hp.com)
Date: Wed Nov 17 19:57:30 2004
Subject: [Rd] Wishlist: pos argument for mget (PR#7376)
Message-ID: <20041117185721.D4DDA10419@slim.kubism.ku.dk>

Full_Name: Hsiu-Khuern Tang
Version: 2.0.0
OS: Debian GNU/Linux
Submission from: (NULL) (156.153.255.243)


Why doesn't mget() have a "pos" argument like get()?  mget has an "envir"
argument, but the documentation says that this is only for backward
compatibility.

Thanks,
Hsiu-Khuern.

From murdoch at stats.uwo.ca  Wed Nov 17 20:05:16 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Nov 17 20:05:22 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore
In-Reply-To: <loom.20041117T190158-839@post.gmane.org>
References: <loom.20041117T190158-839@post.gmane.org>
Message-ID: <6r7np0lfgogaq3b352qp2knd67c1r1bup5@4ax.com>

On Wed, 17 Nov 2004 18:10:20 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote :

>
>I have some questions about building packages in Windows 
>when using .Rbuildignore .  The part of the process that
>is of interest here is the part that creates the source
>tree from the tree that contains the .Rbuildignore file.
>That is, the part of the process that does a build of
>the original tree creating a .tar.gz and then extracts
>this file into a source directory that can be used by
>check, build --binary and install.
>
>1. makefiles
>
>I was developing some batch files for myself using R CMD ...
>but then noticed the Windows makefiles.
>
>- Do the makefiles take into account the situation above?
>
>- If so, do I need to do anything special to use them this way?

I don't think I understand exactly what you're asking.  

>2. configure.win
>
>Also I noticed reference to configure.win in the Extensions
>manual and am not sure if that can be used to address this.
>I tried creating a one line configure.win which just does
>an echo of a fixed string "echo XYZ" but I did not see XYZ
>during my R CMD install.
>
>- Is configure.win supposed to be written using Windows batch commands
>  or UNIX-like commands?

It is run under "sh", not the standard Windows interpreter, so
"UNIX-like".  

I just tried it with "Rcmd install", and I did see the message echoed.
I didn't see it for "Rcmd build", because that doesn't build the
package, it just puts it in a tarball, but "Rcmd build --binary" does
run it.

>
>- where does it go.  (I tried putting it in the same directory as
>  my DESCRIPTION file.)

It should be in the same directory as DESCRIPTION.

>- is it a suitable device for handling the .Rbuildignore issue?

What's the issue exactly?

Duncan Murdoch

From ggrothendieck at myway.com  Wed Nov 17 21:44:48 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Nov 17 21:45:02 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore
References: <loom.20041117T190158-839@post.gmane.org>
	<6r7np0lfgogaq3b352qp2knd67c1r1bup5@4ax.com>
Message-ID: <loom.20041117T213214-532@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

: 
: On Wed, 17 Nov 2004 18:10:20 +0000 (UTC), Gabor Grothendieck
: <ggrothendieck <at> myway.com> wrote :
: 
: >
: >I have some questions about building packages in Windows 
: >when using .Rbuildignore .  The part of the process that
: >is of interest here is the part that creates the source
: >tree from the tree that contains the .Rbuildignore file.
: >That is, the part of the process that does a build of
: >the original tree creating a .tar.gz and then extracts
: >this file into a source directory that can be used by
: >check, build --binary and install.
: >
: >1. makefiles
: >
: >I was developing some batch files for myself using R CMD ...
: >but then noticed the Windows makefiles.
: >
: >- Do the makefiles take into account the situation above?
: >
: >- If so, do I need to do anything special to use them this way?
: 
: I don't think I understand exactly what you're asking.  

If one does not use .Rbuildignore then with a pure R package
one can run off the original source files, in this case
in /wherever/mypkg, like this:
...without .Rbuildignore ...
R CMD install /wherever/mypkg
R CMD check /wherever/mypkg
R CMD build /wherever/mypkg
R CMD build /wherever/mypkg --binary

but if one DOES use .Rbuildignore then one must first build the
package to remove the .Rbuildignore cited files and then run off
the built files which were created by unpacking the tar.gz file.
Below we build the files in /wherever/mypkg and put the resulting
.tar.gz in the current diretory and then unpack it and run the
remaining commands off the unpacked directory (unlike the previous
case where we ran everything off the original directory, viz.
/wherever/mypkg):

... with .Rbuildignore ...

R CMD build /wherever/mypkg
tar xvzf mypkg_0.9-1.tar.gz

... now that we have created a new source directory, mypkg, without
... the .Rbuildignore files we can proceed by running off of that.
... Note that mypkg is different than /wherever/mypkg as the former
... does not contain the ignored files.
R CMD install mypkg
R CMD check mypkg
R CMD build mypkg --binary

I was writing a batch file to handle this second case for me
but was wondering if I was just duplicating work that has
already been done or can easily be done with existing makefiles
or somehow using configure.win.


: 
: >2. configure.win
: >
: >Also I noticed reference to configure.win in the Extensions
: >manual and am not sure if that can be used to address this.
: >I tried creating a one line configure.win which just does
: >an echo of a fixed string "echo XYZ" but I did not see XYZ
: >during my R CMD install.
: >
: >- Is configure.win supposed to be written using Windows batch commands
: >  or UNIX-like commands?
: 
: It is run under "sh", not the standard Windows interpreter, so
: "UNIX-like".  
: 
: I just tried it with "Rcmd install", and I did see the message echoed.
: I didn't see it for "Rcmd build", because that doesn't build the
: package, it just puts it in a tarball, but "Rcmd build --binary" does
: run it.
: 
: >
: >- where does it go.  (I tried putting it in the same directory as
: >  my DESCRIPTION file.)
: 
: It should be in the same directory as DESCRIPTION.
: 
: >- is it a suitable device for handling the .Rbuildignore issue?
: 
: What's the issue exactly?
: 
: Duncan Murd

From murdoch at stats.uwo.ca  Wed Nov 17 22:19:07 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Nov 17 22:19:14 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore
In-Reply-To: <loom.20041117T213214-532@post.gmane.org>
References: <loom.20041117T190158-839@post.gmane.org>
	<6r7np0lfgogaq3b352qp2knd67c1r1bup5@4ax.com>
	<loom.20041117T213214-532@post.gmane.org>
Message-ID: <fofnp05f7gl9lqt63i5f8dtiodpoo9qnh0@4ax.com>

On Wed, 17 Nov 2004 20:44:48 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote :

>If one does not use .Rbuildignore then with a pure R package
>one can run off the original source files, in this case
>in /wherever/mypkg, like this:
>...without .Rbuildignore ...
>R CMD install /wherever/mypkg
>R CMD check /wherever/mypkg
>R CMD build /wherever/mypkg
>R CMD build /wherever/mypkg --binary
>
>but if one DOES use .Rbuildignore then one must first build the
>package to remove the .Rbuildignore cited files and then run off
>the built files which were created by unpacking the tar.gz file.

... or what happens?  I still don't know exactly what you are claiming
goes wrong.  

It might be that the behaviour should be changed, or maybe there's an
existing workaround, but I'd like to see a clear statement of the
problem first.

Duncan Murdoch

From murdoch at stats.uwo.ca  Wed Nov 17 22:34:43 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Nov 17 22:34:49 2004
Subject: [Rd] Re: [R-gui] Re: [R] The hidden costs of GPL software?
In-Reply-To: <6.1.2.0.2.20041117151226.01eb1170@hermes.nos.noaa.gov>
References: <200411170955.iAH9toV21278008@hedwig1.umh.ac.be>
	<6.1.2.0.2.20041117151226.01eb1170@hermes.nos.noaa.gov>
Message-ID: <55gnp01ns9u8eo8e68l126o7j91hil9a80@4ax.com>

I've moved this response to r-devel, as I think it's more appropriate
there than in r-help or R-sig-GUI.

On Wed, 17 Nov 2004 15:55:11 -0500, "Mike Prager"
<Mike.Prager@noaa.gov> wrote :

>This has been an interesting discussion. I make the following comment with 
>hesitation, since I have neither the time nor the ability to implement it 
>myself.
>
>Using CLI software, an infrequent user has trouble remembering the known 
>functions needed and trouble finding new ones (especially as that user gets 
>older).  What might help is an added help facility more oriented towards 
>tasks, rather than structured around functions or packages.
>
>Such a help facility might have a tree structure.
>
>Want help?  Are you looking for information on (1) data manipulation or (2) 
>analysis?  If (1), do you want to to (3) import or export data, (4) 
>transform data, (5) reshape data, or (6) select data?  If (2), do you want 
>to (7) fit a model or (8) make a graph?  And so on....

A difficulty is the "moving target" problem.  A lot of the value of R
lies in the contributed packages.  A fixed help system wouldn't know
about new features of packages.

Currently we have the so-called "keyword" categorization of help
pages; those come somewhat close to what you're asking for.  To see
them, run "help.start()" to open up the HTML help, and click on
"Search Engine and Keywords".  One problem is that this requires both
Java and Javascript to work properly in your browser; I think it's
pretty common that one or the other is uncooperative.  (For example, I
can't get Java to work in Firefox or IE.)

Another problem with this scheme is that the keyword list is fixed and
limited, and may not match the user's (or package writer's)
expectations.

There are also ways to add searchable words to the help topics (using
the \concept markup), but those are new and not widely used.  A full
text search might be nice, but it would be slow without some work in
advance.

Duncan Murdoch

From rjvbertin at hotmail.com  Thu Nov 18 01:04:45 2004
From: rjvbertin at hotmail.com (RenE J.V. Bertin)
Date: Thu Nov 18 01:05:55 2004
Subject: [Rd] Re: [R] changing (core) function argument defaults?
In-Reply-To: <20041117224310.GA2823@hortresearch.co.nz>
Message-ID: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>

&gt;From: Patrick Connolly &lt;p.connolly@hortresearch.co.nz&gt;
&gt;To: &quot;RenE J.V. Bertin&quot; &lt;rjvbertin@hotmail.com&gt;
&gt;Subject: Re: [R] changing (core) function argument defaults?
&gt;Date: Thu, 18 Nov 2004 11:43:10 +1300

&gt;
&gt;On Wed, 20-Oct-2004 at 07:48PM +0200, RenE J.V. Bertin wrote:
&gt;
&gt;|&gt; Hello,
&gt;|&gt;
&gt;
&gt;|&gt; Is it possible to change the defaults for the arguments to a
&gt;|&gt; function, without changing the function code itself?  I'm asking
&gt;|&gt; because I'd like to override the default dimensions and font 
family
&gt;|&gt; for a graphics device. Before 2.0.0, I'd just do that with a small
&gt;|&gt; edit in the appropriate .R file containing the device function
&gt;|&gt; definition. I appears to be possible no longer. So rather than
&gt;|&gt; copying the definition into my own .Rprofile, it would be nice if
&gt;|&gt; just the defaults could be modified...
&gt;
&gt;I didn't notice a response to this question.  I'd like to do something
&gt;similar and haven't been able to work out how to do it.
&gt;
&gt;
&gt;best
&gt;
&gt;--
&gt;Patrick Connolly
&gt;HortResearch
&gt;Mt Albert
&gt;Auckland
&gt;New Zealand
&gt;Ph: +64-9 815 4200 x 7188

No, I haven't noticed a reply to this question neither.

Best,
Ren Bertin

From tlumley at u.washington.edu  Thu Nov 18 01:18:11 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Nov 18 01:18:37 2004
Subject: [Rd] Re: [R] changing (core) function argument defaults?
In-Reply-To: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>
References: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>
Message-ID: <Pine.A41.4.61b.0411171613130.86544@homer12.u.washington.edu>


Restricted to r-devel (it is almost never appropriate to send the same 
message to both lists).

On Thu, 18 Nov 2004, RenE J.V. Bertin wrote:
> &gt;From: Patrick Connolly &lt;p.connolly@hortresearch.co.nz&gt;
> &gt;To: &quot;RenE J.V. Bertin&quot; &lt;rjvbertin@hotmail.com&gt;
> &gt;Subject: Re: [R] changing (core) function argument defaults?
> &gt;Date: Thu, 18 Nov 2004 11:43:10 +1300
>
> &gt;
> &gt;On Wed, 20-Oct-2004 at 07:48PM +0200, RenE J.V. Bertin wrote:
> &gt;
> &gt;|&gt; Hello,
> &gt;|&gt;
> &gt;
> &gt;|&gt; Is it possible to change the defaults for the arguments to a
> &gt;|&gt; function, without changing the function code itself?  I'm asking
> &gt;|&gt; because I'd like to override the default dimensions and font family
> &gt;|&gt; for a graphics device. Before 2.0.0, I'd just do that with a small
> &gt;|&gt; edit in the appropriate .R file containing the device function
> &gt;|&gt; definition. I appears to be possible no longer. So rather than
> &gt;|&gt; copying the definition into my own .Rprofile, it would be nice if
> &gt;|&gt; just the defaults could be modified...
> &gt;
> &gt;I didn't notice a response to this question.  I'd like to do something
> &gt;similar and haven't been able to work out how to do it.

You can write a wrapper

X11<-function(display="",width=2,height=2,...){
    grDevices::X11(display,width,height,...)
}

and put that into your Rprofile.

 	-thomas

From ggrothendieck at myway.com  Thu Nov 18 01:38:47 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 18 01:39:06 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore
References: <loom.20041117T190158-839@post.gmane.org>
	<6r7np0lfgogaq3b352qp2knd67c1r1bup5@4ax.com>
	<loom.20041117T213214-532@post.gmane.org>
	<fofnp05f7gl9lqt63i5f8dtiodpoo9qnh0@4ax.com>
Message-ID: <loom.20041118T005704-405@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

> 
> On Wed, 17 Nov 2004 20:44:48 +0000 (UTC), Gabor Grothendieck
> <ggrothendieck <at> myway.com> wrote :
> 
> >If one does not use .Rbuildignore then with a pure R package
> >one can run off the original source files, in this case
> >in /wherever/mypkg, like this:
> >...without .Rbuildignore ...
> >R CMD install /wherever/mypkg
> >R CMD check /wherever/mypkg
> >R CMD build /wherever/mypkg
> >R CMD build /wherever/mypkg --binary
> >
> >but if one DOES use .Rbuildignore then one must first build the
> >package to remove the .Rbuildignore cited files and then run off
> >the built files which were created by unpacking the tar.gz file.
> 
> ... or what happens?  I still don't know exactly what you are claiming
> goes wrong.  

QUESTION

I am not claiming anything is wrong.  I was simply describing what
processing is needed to build a package that only uses R, noting that
such processing is different if one uses .Rbuildignore.  My question
was to ask:

- are there already scripts, makefiles or some other software or hooks
  such as configure.win to streamline this

EXAMPLE

For example, in
  http://tolstoy.newcastle.edu.au/R/help/04/11/6729.html
John Fox provided a batch file that automated package creation in the
case that there is only R code and one does not use .Rbuildignore.
I do use .Rbuildignore and need to do the analogous.   Most of my
past two posts described the manual commands that must be done in
each of these two cases to make clear what the process that I want
to streamline is and how it differs in these two cases.

DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT

The reason that the processing is different according to whether one
uses .Rbuildignore or not is that 
  R CMD build 
takes the .Rbuildignore file into account but 
  R CMD install
  R CMD check
  R CMD build --binary 
do not take .Rbuildignore into account.  

> 
> It might be that the behaviour should be changed, or maybe there's an
> existing workaround, but I'd like to see a clear statement of the
> problem first.

Certainly its desirable to streamline this whole situation with a 
makefile, script or hook or perhaps one could modify the individual
commands: R CMD install, R CMD check and R CMD build --binary to 
take .Rbuildignore into account, possibly via a switch/flag.  However,
all I was asking about is what is already there.

Thanks.

From rjvbertin at hotmail.com  Thu Nov 18 01:45:53 2004
From: rjvbertin at hotmail.com (RenE J.V. Bertin)
Date: Thu Nov 18 01:46:14 2004
Subject: [Rd] Re: [R] changing (core) function argument defaults?
In-Reply-To: <Pine.A41.4.61b.0411171613130.86544@homer12.u.washington.edu>
Message-ID: <BAY22-F2261B2B4102B68448A6BD9A7C20@phx.gbl>


&gt;Restricted to r-devel (it is almost never appropriate to send the
&gt;same message to both lists).

Fine with me!

&gt;X11&lt;-function(display=&quot;&quot;,width=2,height=2,...){
&gt;    grDevices::X11(display,width,height,...)
&gt;}
&gt;
&gt;and put that into your Rprofile.


Great, thanks! Is there documentation from which to find out what to put in 
that wrapper function, for an arbitrary function?

Ren Bertin

From tplate at acm.org  Thu Nov 18 01:46:45 2004
From: tplate at acm.org (Tony Plate)
Date: Thu Nov 18 01:46:59 2004
Subject: [Rd] Re: [R] changing (core) function argument defaults?
In-Reply-To: <Pine.A41.4.61b.0411171613130.86544@homer12.u.washington.ed
 u>
References: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>
	<Pine.A41.4.61b.0411171613130.86544@homer12.u.washington.edu>
Message-ID: <6.1.0.6.2.20041117173647.05ebd910@mailhost.blackmesacapital.com>

Just to add to Thomas Lumley suggestion: it's generally a good idea to call 
a wrapper function it by a different name.  This way, when you forget that 
you have a wrapper function, you won't be puzzled by why the function 
doesn't behave according to the documentation, and you won't embarrass 
yourself by asking other people why there is a bug in R.  Also, if the 
function is called programmatically by other functions, those usages might 
be depending upon the standard defaults being in effect.  So, just do 
something like:

myX11<-function(display="",width=2,height=2,...){
    grDevices::X11(display=display,width=width,height=height,...)
}

-- Tony Plate

>At Wednesday 05:18 PM 11/17/2004, Thomas Lumley wrote:
>
>Restricted to r-devel (it is almost never appropriate to send the same 
>message to both lists).
>
>On Thu, 18 Nov 2004, RenE J.V. Bertin wrote:
> >From: Patrick Connolly &lt;p.connolly@hortresearch.co.nz>
> >To: &quot;RenE J.V. Bertin&quot; &lt;rjvbertin@hotmail.com>
> >Subject: Re: [R] changing (core) function argument defaults?
> >Date: Thu, 18 Nov 2004 11:43:10 +1300
>
> >
> >On Wed, 20-Oct-2004 at 07:48PM +0200, RenE J.V. Bertin wrote:
> >
> >|> Hello,
> >|>
> >
> >|> Is it possible to change the defaults for the arguments to a
> >|> function, without changing the function code itself?  I'm asking
> >|> because I'd like to override the default dimensions and font family
> >|> for a graphics device. Before 2.0.0, I'd just do that with a small
> >|> edit in the appropriate .R file containing the device function
> >|> definition. I appears to be possible no longer. So rather than
> >|> copying the definition into my own .Rprofile, it would be nice if
> >|> just the defaults could be modified...
> >
> >I didn't notice a response to this question.  I'd like to do something
> >similar and haven't been able to work out how to do it.
>
>You can write a wrapper
>
>X11<-function(display="",width=2,height=2,...){
>    grDevices::X11(display,width,height,...)
>}
>
>and put that into your Rprofile.
>
>         -thomas
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From spencer.graves at pdf.com  Thu Nov 18 01:47:13 2004
From: spencer.graves at pdf.com (Spencer Graves)
Date: Thu Nov 18 01:47:24 2004
Subject: [Rd] Re: [R] Changing graphics defaults [was: changing (core)
 function argument defaults?]
In-Reply-To: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>
References: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>
Message-ID: <419BF111.10507@pdf.com>

      Under the S3 standard, you could make a local copy of any function 
and change the defaults in that local copy.  That may not always work 
under the S4 standard methods dispatch going to code hidden in 
namespaces.  In any event, it should be easy (and safer) to write a 
function with a slightly different name, e.g., adding a dot "." to the 
end of the name, that would have different defaults and would do nothing 
but call the function of interest.  This might be safer

      I don't have any suggestions about changing graphics defaults 
other than to ask for that specifically -- e.g., by changing the subject 
line to this email. 

      hope this helps.  spencer graves

RenE J.V. Bertin wrote:

> &gt;From: Patrick Connolly &lt;p.connolly@hortresearch.co.nz&gt;
> &gt;To: &quot;RenE J.V. Bertin&quot; &lt;rjvbertin@hotmail.com&gt;
> &gt;Subject: Re: [R] changing (core) function argument defaults?
> &gt;Date: Thu, 18 Nov 2004 11:43:10 +1300
>
> &gt;
> &gt;On Wed, 20-Oct-2004 at 07:48PM +0200, RenE J.V. Bertin wrote:
> &gt;
> &gt;|&gt; Hello,
> &gt;|&gt;
> &gt;
> &gt;|&gt; Is it possible to change the defaults for the arguments to a
> &gt;|&gt; function, without changing the function code itself?  I'm 
> asking
> &gt;|&gt; because I'd like to override the default dimensions and font 
> family
> &gt;|&gt; for a graphics device. Before 2.0.0, I'd just do that with a 
> small
> &gt;|&gt; edit in the appropriate .R file containing the device function
> &gt;|&gt; definition. I appears to be possible no longer. So rather than
> &gt;|&gt; copying the definition into my own .Rprofile, it would be 
> nice if
> &gt;|&gt; just the defaults could be modified...
> &gt;
> &gt;I didn't notice a response to this question.  I'd like to do 
> something
> &gt;similar and haven't been able to work out how to do it.
> &gt;
> &gt;
> &gt;best
> &gt;
> &gt;--
> &gt;Patrick Connolly
> &gt;HortResearch
> &gt;Mt Albert
> &gt;Auckland
> &gt;New Zealand
> &gt;Ph: +64-9 815 4200 x 7188
>
> No, I haven't noticed a reply to this question neither.
>
> Best,
> Ren? Bertin
>
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! 
> http://www.R-project.org/posting-guide.html


-- 
Spencer Graves, PhD, Senior Development Engineer
O:  (408)938-4420;  mobile:  (408)655-4567

From tlumley at u.washington.edu  Thu Nov 18 02:01:50 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Nov 18 02:02:19 2004
Subject: [Rd] Re: [R] changing (core) function argument defaults?
In-Reply-To: <6.1.0.6.2.20041117173647.05ebd910@mailhost.blackmesacapital.com>
References: <BAY22-F8BBB2BB7E3C5D182A17A0A7C20@phx.gbl>
	<Pine.A41.4.61b.0411171613130.86544@homer12.u.washington.edu>
	<6.1.0.6.2.20041117173647.05ebd910@mailhost.blackmesacapital.com>
Message-ID: <Pine.A41.4.61b.0411171700190.271334@homer12.u.washington.edu>

On Wed, 17 Nov 2004, Tony Plate wrote:

> Just to add to Thomas Lumley suggestion: it's generally a good idea to call a 
> wrapper function it by a different name.

This is generally good advice. However, if you want your graphics device 
started automatically when you plot, it either has to have the same name 
as the usual default device or you have to also set 
options(device="myX11")

 	-thomas

>						 This way, when you forget that you 
> have a wrapper function, you won't be puzzled by why the function doesn't 
> behave according to the documentation, and you won't embarrass yourself by 
> asking other people why there is a bug in R.  Also, if the function is called 
> programmatically by other functions, those usages might be depending upon the 
> standard defaults being in effect.  So, just do something like:
>
> myX11<-function(display="",width=2,height=2,...){
>   grDevices::X11(display=display,width=width,height=height,...)
> }
>
> -- Tony Plate
>
>> At Wednesday 05:18 PM 11/17/2004, Thomas Lumley wrote:
>> 
>> Restricted to r-devel (it is almost never appropriate to send the same 
>> message to both lists).
>> 
>> On Thu, 18 Nov 2004, RenE J.V. Bertin wrote:
>> >From: Patrick Connolly &lt;p.connolly@hortresearch.co.nz>
>> >To: &quot;RenE J.V. Bertin&quot; &lt;rjvbertin@hotmail.com>
>> >Subject: Re: [R] changing (core) function argument defaults?
>> >Date: Thu, 18 Nov 2004 11:43:10 +1300
>> 
>> >
>> >On Wed, 20-Oct-2004 at 07:48PM +0200, RenE J.V. Bertin wrote:
>> >
>> >|> Hello,
>> >|>
>> >
>> >|> Is it possible to change the defaults for the arguments to a
>> >|> function, without changing the function code itself?  I'm asking
>> >|> because I'd like to override the default dimensions and font family
>> >|> for a graphics device. Before 2.0.0, I'd just do that with a small
>> >|> edit in the appropriate .R file containing the device function
>> >|> definition. I appears to be possible no longer. So rather than
>> >|> copying the definition into my own .Rprofile, it would be nice if
>> >|> just the defaults could be modified...
>> >
>> >I didn't notice a response to this question.  I'd like to do something
>> >similar and haven't been able to work out how to do it.
>> 
>> You can write a wrapper
>> 
>> X11<-function(display="",width=2,height=2,...){
>>    grDevices::X11(display,width,height,...)
>> }
>> 
>> and put that into your Rprofile.
>> 
>>         -thomas
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From ahausknecht at umassd.edu  Thu Nov 18 07:42:55 2004
From: ahausknecht at umassd.edu (ahausknecht@umassd.edu)
Date: Thu Nov 18 07:43:09 2004
Subject: [Rd] R will not start - missing library? (PR#7377)
Message-ID: <20041118064255.C7D0DF6DA@slim.kubism.ku.dk>

Full_Name: Adam Hausknecht
Version: 2.0.1
OS: Mac OS 10.3.6
Submission from: (NULL) (129.44.182.8)


The following message was reported in the console:

"dyld: /Applications/StartR.app/RAqua.app/Contents/MacOS/RAqua can't open
library: /usr/local/lib/libreadline.4.3.dylib  (No such file or directory, errno
= 2)"

1. I have tried reinstalling R 2.0.1 several times but this does not fix the
problem. I also used the disk utility
    to repair permissions but this did not solve the problem.

2.  Also, R 2.0.1 did RUN just after I first intalled it. However, it would not
run the next time I attempted to   
     lauch it (and the message above was written to the console).

Adam Hausknecht

From jago at mclink.it  Thu Nov 18 09:44:01 2004
From: jago at mclink.it (Stefano Iacus)
Date: Thu Nov 18 09:44:10 2004
Subject: [Rd] R will not start - missing library? (PR#7377)
Message-ID: <1.3.200411180943.1916@>

Hi Adam,
you should remove the old RAqua code which is apparently still on your system given the error message.
On Panther (10.3+) you should install the corresponding .pkg you find in the R-2.0.1 disk image. The readme says that you have to remove manually the old RAqua.

stefano


> Full_Name: Adam Hausknecht > Version: 2.0.1 > OS: Mac OS 10.3.6 > Submission from: (NULL) (129.44.182.8) >  >  > The following message was reported in the console: >  > "dyld: /Applications/StartR.app/RAqua.app/Contents/MacOS/RAqua  > can't open > library: /usr/local/lib/libreadline.4.3.dylib  (No such file  > or directory, errno > = 2)" >  > 1. I have tried reinstalling R 2.0.1 several times but this does  > not fix the > problem. I also used the disk utility >     to repair permissions but this did not solve the problem. >  > 2.  Also, R 2.0.1 did RUN just after I first intalled it. However,  > it would not > run the next time I attempted to >      lauch it (and the message above was written to the console). >  > Adam Hausknecht >  > ______________________________________________ > R-devel@stat.math.ethz.ch mailing list > https://stat.ethz.ch/mailman/listinfo/r-devel

From wolski at molgen.mpg.de  Thu Nov 18 10:04:20 2004
From: wolski at molgen.mpg.de (Witold Eryk Wolski)
Date: Thu Nov 18 10:04:47 2004
Subject: [Rd] Re: [R] R/S-related projects on Sourceforge? Trove
	Categorization
In-Reply-To: <419B1530.1090208@molgen.mpg.de>
References: <419B1530.1090208@molgen.mpg.de>
Message-ID: <419C6594.2020808@molgen.mpg.de>

Hi,

This are the project which I have extracted from all your mails.
  
1. http://sourceforge.net/projects/rpgsql/      R PostgreSQL Interface
2. http://sourceforge.net/projects/r-spatial/   R package for spatial 
data classes
3. http://sourceforge.net/projects/rpy/         RPy (R from Python)
4. http://sourceforge.net/projects/ep-sf/       Expression Profiler
5. http://sourceforge.net/projects/fsap         fish stock assessment for R
6. http://sourceforge.net/projects/flr/         R packages for use in 
fisheries modelling
7. https://sourceforge.net/projects/runit/      R Unit Test Framework
8. http://sourceforge.net/projects/ep-sf/       Expression Profiler
9. http://sourceforge.net/projects/r-asp/       Analysis of Spatial Data 
in R
10. http://sourceforge.net/projects/r4proteomics/  R Packages for proteomics
11. http://sourceforge.net/projects/rdbi/          R Database Interface
12. http://sourceforge.net/projects/nlmeode/       R package combining 
nlme and odesolve
13. http://sourceforge.net/projects/rarcinfo/      RArcInfo
14. http://sourceforge.net/projects/rgdal          GDAL Package for R
15. http://sourceforge.net/projects/gretl/         GNU Regression, 
Econometrics and Time-series Library
16. ...
 
Sorry if I have missed any. But it is surely more than five.

Thanks all of you for your numerous response and also for some more 
general thoughts concerning
*collaboratory* development using source code repositories:
https://stat.ethz.ch/pipermail/r-devel/2004-November/031398.html.
If I see how R is evolving I believe that this ideas will be realized soon.
Especially that there are already repositories covering some of the 
functionality and dedicated to R --  Bioconductor  with a svn archive. 
Unfortunately, as I was told by Geff Gentry the costs of administering 
the svn, cvs servers are high, hence the number of developers must be 
limited. Also CRAN has some of the functionality but the svn or cvs 
support is missing.
Luckily hosting the sources on e.g. sourceforge and the builds on CRAN 
or Bioconductor gives already some of the essential functionality.

Therefore at this place big thanks to the Bioconductor, CRAN and 
sourceforge people.

/E

From roebuck at odin.mdacc.tmc.edu  Thu Nov 18 11:04:35 2004
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Thu Nov 18 11:04:52 2004
Subject: [Rd] Re: [R] Redirect standard input and output of R
In-Reply-To: <000001c4cd1a$1a69ed90$1035ae86@kakuru>
References: <000001c4cd1a$1a69ed90$1035ae86@kakuru>
Message-ID: <Pine.OSF.4.58.0411180355470.237686@odin.mdacc.tmc.edu>

On Wed, 17 Nov 2004, Victor Robles wrote:

> I'm trying to write a C program that write to the standard input of R
> and read the standard output. I can perfectly read the R output, but
> I'm not able of writing anything to R.
> [SNIP C code]

Several years ago, I wrote some software that used S-plus as its
back-end and Java for the front-end. I found what worked best was
to add a pseudoterminal inbetween; you can use the code from
"UNIX Programming Environment" to create one. The solution was
later reused when a similar project used R for its back-end.

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From cig69410 at syd.odn.ne.jp  Thu Nov 18 15:23:49 2004
From: cig69410 at syd.odn.ne.jp (cig69410@syd.odn.ne.jp)
Date: Thu Nov 18 15:23:58 2004
Subject: [Rd] R bug ?? (PR#7378)
Message-ID: <20041118142349.EA3AA10433@slim.kubism.ku.dk>


--Apple-Mail-1-74005136
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=SHIFT_JIS;
	format=flowed

Sometime, R generates following warning message.
To restore, I must press command+.

 > edit(tolerance)
2004-11-18 11:07:27.003 R[420] *** NSTimer discarding exception=20
'NSInvalidArgumentException' (reason '*** -[NSTextView=20
replaceCharactersInRange:withString:]: nil NSString given.') that=20
raised during firing of timer with target 3bd520 and selector=20
'runRELP:'

By the way, function 'tolerance' is described in EUC-JP code and has=20
Mac line feed code(CR), and it contains Japanese character(KANJI).

When I want to see the definition of such function, R is crushed.

I=81fll attach the file contains tolerance().


--Apple-Mail-1-74005136
Content-Type: multipart/appledouble;
	boundary=Apple-Mail-2-74005136
Content-Disposition: attachment


--Apple-Mail-2-74005136
Content-Transfer-Encoding: base64
Content-Type: application/applefile;
	name="tolerance.R"
Content-Disposition: attachment;
	filename=tolerance.R

AAUWBwACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAJAAAAPgAAAAoAAAADAAAASAAAAAsAAAACAAAA
UwAADWFURVhUSkVEWAAQdG9sZXJhbmNlLlIAAAEAAAAM3QAAC90AAACEAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB
kAQLdHlwZWRzdHJlYW2BA+iEAUCEhIQTTlNNdXRhYmxlRGljdGlvbmFyeQCEhAxOU0RpY3Rpb25h
cnkAhIQITlNPYmplY3QAhYQBaQqShISECE5TU3RyaW5nAZWEASsIVmlld1NpemWGkoSEhAdOU1Zh
bHVlAJWEASqEhAx7X05TU2l6ZT1mZn2bgQMggQJYhpKEl5gRSHlwaGVuYXRpb25GYWN0b3KGkoSE
hAhOU051bWJlcgCZmoSEAWadAIaShJeYCkxlZnRNYXJnaW6GkoSdmp6dg0KQBJyGkoSXmAlQYXBl
clNpemWGkoSZmpqbgQJTgQNKhpKEl5gIUmVhZE9ubHmGkoSdmoSWlgCGkoSXmAlUb3BNYXJnaW6G
koSdmp6dg0JizM2GkoSXmAxCb3R0b21NYXJnaW6GkoSdmp6dg0JizM2GkoSXmAhWaWV3Wm9vbYaS
hJ2anp1khpKEl5gIVmlld01vZGWGkoSdmqWWAIaShJeYC1JpZ2h0TWFyZ2luhpKEnZqenYNCYszN
hoYAAApFBAt0eXBlZHN0cmVhbYED6IQBQISEhBNOU011dGFibGVEaWN0aW9uYXJ5AISEDE5TRGlj
dGlvbmFyeQCEhAhOU09iamVjdACFhAFpHpKEhIQITlNTdHJpbmcBlYQBKxFMaW5lTnVtYmVyVmlz
aWJsZYaShISECE5TTnVtYmVyAISEB05TVmFsdWUAlYQBKoSEAWOcAYaShJeYCEVuY29kaW5nhpKE
mZuElpYDhpKEl5gOVG9vbGJhclZpc2libGWGkpiShJeYE0Jvb2ttYXJrRHJhd2VyU3RhdGWGkoSZ
m5ucAIaShJeYCU1hcmtDb2xvcoaShISEDU5TTXV0YWJsZURhdGEAhIQGTlNEYXRhAJWWO4QFWzU5
Y10EC3R5cGVkc3RyZWFtgQPohAFAhISEB05TQ29sb3IAhIQITlNPYmplY3QAhYQBYwOEAmZmgz8q
qqsBhoaShJeYElRleHRTZWxlY3Rpb25Db2xvcoaShKSWfoQGWzEyNmNdBAt0eXBlZHN0cmVhbYED
6IQBQISEhAdOU0NvbG9yAISECE5TT2JqZWN0AIWEAWMGhANAQECEhIQITlNTdHJpbmcBlIQBKwZT
eXN0ZW2GhJaYG3NlbGVjdGVkVGV4dEJhY2tncm91bmRDb2xvcoaEk5UDhAJmZoM/KqqrAYaGhpKE
l5gPQmFja2dyb3VuZENvbG9yhpKEpJZyhAZbMTE0Y10EC3R5cGVkc3RyZWFtgQPohAFAhISEB05T
Q29sb3IAhIQITlNPYmplY3QAhYQBYwaEA0BAQISEhAhOU1N0cmluZwGUhAErBlN5c3RlbYaElpgT
dGV4dEJhY2tncm91bmRDb2xvcoaEk5UDhAJmZgEBhoaGkoSXmAlsaW5rTWFya3OGkoSklkOEBVs2
N2NdBAt0eXBlZHN0cmVhbYED6IQBQISEhA5OU011dGFibGVBcnJheQCEhAdOU0FycmF5AISECE5T
T2JqZWN0AIWEAWkAhoaShJeYDHJvb3RCb29rTWFya4aShKSWZ4QGWzEwM2NdBAt0eXBlZHN0cmVh
bYED6IQBQISEhApKNUJvb2tNYXJrAISECE5TT2JqZWN0AIWEASsIAAAAAAAAAACShISECE5TU3Ry
aW5nAZSVDXJvb3QgYm9va21hcmuGkoWVCAAAAAAAAAAAhoaShJeYC0xpbmVTcGFjaW5nhpKEmZuE
hAFmpACGkoSXmA5BdXRvSW5kZW50RmxhZ4aSmJKEl5gNbW9ub1N0eWxlRm9udIaShKSWZYQGWzEw
MWNdBAt0eXBlZHN0cmVhbYED6IQBQISEhAZOU0ZvbnQVhIQITlNPYmplY3QAhYQBaSCEBVszMmNd
BgAAABYAAAD+/wBPAHMAYQBrAGEALQBNAG8AbgBvAACEAWYOhAFjAJgBmACYAIaGkoSXmAxSdWxl
clZpc2libGWGkpiShJeYE0luc2VydGlvblBvaW50Q29sb3KGkoSklmiEBlsxMDRjXQQLdHlwZWRz
dHJlYW2BA+iEAUCEhIQHTlNDb2xvcgCEhAhOU09iamVjdACFhAFjBoQDQEBAhISECE5TU3RyaW5n
AZSEASsGU3lzdGVthoSWmAl0ZXh0Q29sb3KGhJOVA4QCZmYAAYaGhpKEl5gQRG9jV2lkdGhTeW5j
RmxhZ4aShJmbnpYBhpKEl5gOU2Nyb2xsUG9zaXRpb26GkoSam4SEDXtfTlNQb2ludD1mZn2nAACG
koSXmA9Gb3JlZ3JvdW5kQ29sb3KGkoSklmimBAt0eXBlZHN0cmVhbYED6IQBQISEhAdOU0NvbG9y
AISECE5TT2JqZWN0AIWEAWMGhANAQECEhIQITlNTdHJpbmcBlIQBKwZTeXN0ZW2GhJaYCXRleHRD
b2xvcoaEk5UDhAJmZgABhoaGkoSXmAhEb2NXaWR0aIaShJmbsKSBAb6GkoSXmAxXaW5kb3dPcmln
aW6GkoSam7ungQNvToaShJeYDVNlbGVjdGVkUmFuZ2WGkoSam4SEDXtfTlNSYW5nZT1JSX2ogQEd
AIaShJeYBkhlYWRlcoaShKSWgQDjhAZbMjI3Y10EC3R5cGVkc3RyZWFtgQPohAFAhISEEk5TQXR0
cmlidXRlZFN0cmluZwCEhAhOU09iamVjdACFkoSEhAhOU1N0cmluZwGUhAErBSVuYW1lhoQCaUkB
BZKEhIQMTlNEaWN0aW9uYXJ5AJSEAWkBkoSWlhBOU1BhcmFncmFwaFN0eWxlhpKEhIQXTlNNdXRh
YmxlUGFyYWdyYXBoU3R5bGUAhIQQTlNQYXJhZ3JhcGhTdHlsZQCUhARDQ0BTAACEhIQOTlNNdXRh
YmxlQXJyYXkAhIQHTlNBcnJheQCUmQCGAIaGhoaShJeYClJ1bGVkUGFwZXKGkoSkloEA2YQGWzIx
N2NdBAt0eXBlZHN0cmVhbYED6IQBQISEhAxKNVJ1bGVkUGFwZXIAhIQITlNPYmplY3QAhYQBaYIA
AQAAlYIBAAABkoSEhAZOU0ZvbnQVlJUohAVbNDBjXQYAAAAeAAAA/v8ASABpAHIAYQBLAGEAawB1
AFAAcgBvAC0AVwAzAACEAWYOhAFjAJkBmQCZAIaShISECE5TU3RyaW5nAZSEASsD44GChpgHlRSV
FJUAkoSEhAdOU0NvbG9yAJSZAYQEZmZmZoM/GZmagz7MzM2DPkzMzQGGmIM/AAAAhoaShJeYCFRh
YldpZHRohpKEmZuwpINCM0AAhpKEl5gQV29yZFdyYXBwaW5nTW9kZYaShJmbnpYAhpKEl5gJU2F2
ZWREYXRlhpKEpJY4hAVbNTZjXQQLdHlwZWRzdHJlYW2BA+iEAUCEhIQGTlNEYXRlAISECE5TT2Jq
ZWN0AIWEAWSDQZ0xCofFr0iGhpKEl5gVV3JhcHBlZExpbmVJbmRlbnRGbGFnhpKhkoSXmBZXcmFw
cGVkTGluZUluZGVudFZhbHVlhpKEmZuwpACGkoSXmA9MaW5lTnVtYmVyQ29sb3KGkoSkljufBAt0
eXBlZHN0cmVhbYED6IQBQISEhAdOU0NvbG9yAISECE5TT2JqZWN0AIWEAWMDhAJmZoM/AAAAAYaG
koSXmAZGb290ZXKGkoSkloEA8IQGWzI0MGNdBAt0eXBlZHN0cmVhbYED6IQBQISEhBJOU0F0dHJp
YnV0ZWRTdHJpbmcAhIQITlNPYmplY3QAhZKEhIQITlNTdHJpbmcBlIQBKxItICVwYWdlIC8gJXRv
dGFsIC2GhAJpSQESkoSEhAxOU0RpY3Rpb25hcnkAlIQBaQGShJaWEE5TUGFyYWdyYXBoU3R5bGWG
koSEhBdOU011dGFibGVQYXJhZ3JhcGhTdHlsZQCEhBBOU1BhcmFncmFwaFN0eWxlAJSEBENDQFMC
AISEhA5OU011dGFibGVBcnJheQCEhAdOU0FycmF5AJSZAIYAhoaGhpKEl5gPU2hvd3NJbnZpc2li
bGVzhpKEmZuelgiGhgAAAQAAAAzdAAAL3QAAAIQAXkIEAK8AAAAcAEYAAUo1QVQAAAASSjVPVAAA
AB4AgAAAAAAAAAAAAAAAgAAcAAABlAAAAAAbSmVkaXQgWCBkb2N1bWVudCBhdHRyaWJ1dGVzIUpl
ZGl0IFggZG9jdW1lbnQgb3RoZXIgYXR0cmlidXRlcw==

--Apple-Mail-2-74005136
Content-Transfer-Encoding: base64
Content-Type: application/text;
	x-mac-hide-extension=yes;
	x-mac-creator=4A454458;
	x-unix-mode=0644;
	x-mac-type=54455854;
	name="tolerance.R"
Content-Disposition: attachment;
	filename=tolerance.R

dG9sZXJhbmNlIDwtIGZ1bmN0aW9uKHgsIGRpZ2l0cz01KQp7Cgl4IDwtIHhbY29tcGxldGUuY2Fz
ZXMoeCksXQoJdG9sZXJhbmNlIDwtIDEvKHZpZiA8LSBkaWFnKHNvbHZlKGNvcih4KSkpKSAjIMHq
tNi3uL/0udTO86TOtdW51M7zpM7C0LPRwK7KrCh2aWYppM611b/0KHRyb2xlcmFuY2UpCglyZXN1
bHQgPC0gY2JpbmQodG9sZXJhbmNlLCB2aWYpCglyb3duYW1lcyhyZXN1bHQpIDwtIHBhc3RlKCJW
YXIiLCAxOm5jb2woeCksIHNlcD0iIikgIyDN18HHpMvMvsGwpPLJ1aSxpMakpKTrpMCksQoJc2ln
bmlmKHJlc3VsdCwgZGlnaXRzKSAjILTYv/SkrMrWpLnDzQp9Cg==

--Apple-Mail-2-74005136--

--Apple-Mail-1-74005136
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed



--
AOKI Shigenobu
Japan
--Apple-Mail-1-74005136--

From murdoch at stats.uwo.ca  Thu Nov 18 16:36:03 2004
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu Nov 18 16:36:13 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
Message-ID: <20041118153603.E0215F18D@slim.kubism.ku.dk>

On Thu, 18 Nov 2004 00:38:47 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote :

>DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT
>
>The reason that the processing is different according to whether one
>uses .Rbuildignore or not is that 
>  R CMD build 
>takes the .Rbuildignore file into account but 
>  R CMD install
>  R CMD check
>  R CMD build --binary 
>do not take .Rbuildignore into account.  

Okay, now I understand.  I think I'd call the last of those a bug, and
it would seem to me that the install and check scripts should also
respect this directive.   I've now copied this to the r-bugs list.
(This was reported for Windows; I don't know if it applies to other
platforms as well.)

Just for clarification:  I can see you would use this when you have
S-PLUS code in the same directory as R code, and you don't want to
include that in an R build.  Are there other files that must be
excluded?

Duncan Murdoch

From pgilbert at bank-banque-canada.ca  Thu Nov 18 18:24:54 2004
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu Nov 18 18:26:37 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
In-Reply-To: <20041118153603.E0215F18D@slim.kubism.ku.dk>
References: <20041118153603.E0215F18D@slim.kubism.ku.dk>
Message-ID: <419CDAE6.3070900@bank-banque-canada.ca>

murdoch@stats.uwo.ca wrote:

> On Thu, 18 Nov 2004 00:38:47 +0000 (UTC), Gabor Grothendieck
> <ggrothendieck@myway.com> wrote :
> 
> 
>>DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT
>>
>>The reason that the processing is different according to whether one
>>uses .Rbuildignore or not is that 
>> R CMD build 
>>takes the .Rbuildignore file into account but 
>> R CMD install
>> R CMD check
>> R CMD build --binary 
>>do not take .Rbuildignore into account.  
> 
> 
> Okay, now I understand.  I think I'd call the last of those a bug, and
> it would seem to me that the install and check scripts should also
> respect this directive.   I've now copied this to the r-bugs list.
> (This was reported for Windows; I don't know if it applies to other
> platforms as well.)
> 
> Just for clarification:  I can see you would use this when you have
> S-PLUS code in the same directory as R code, and you don't want to
> include that in an R build.  Are there other files that must be
> excluded?

I'm not sure if you meant this as a Windows question. On Unix/Linux:
CVS for sure, and if you run things in you source directly and 
occassionaly get core dumps then it is pretty import to ignore them or 
you get very large packages. (Yes it would be better to clean up.) I 
also ignore several files that get generate compiling src code, or in 
some cases files that generate things that are included (For example, I 
generate man from a mansrc directory.) My  .Rbuildignore is

^Makefile$
(^|.*/)core$
(^|.*/)run$
(^|.*/)zot$
CVS
(^|.*/)/CVS$
(^|.*/)/(^|.*/)/CVS$
TMP$
FLAGS$
mansrc$
guidesrc$
zot$
run$
inst/doc/(^|.*)\.tex$
inst/doc/(^|.*)\.R$
inst/doc/(^|.*)\.log$
inst/doc/(^|.*)\.stdout$
exec/(^|.*)\.pro
exec/getpadi
exec/putpadi
exec/objectinfo
exec/padi_simple_svc
exec/getpwuid
exec/x11arima
exec/(^|.*)server.log.(^|.*)
data/create

Paul Gilbert
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From tplate at acm.org  Thu Nov 18 18:58:07 2004
From: tplate at acm.org (Tony Plate)
Date: Thu Nov 18 18:58:22 2004
Subject: [Rd] modification of BATCH
In-Reply-To: <Pine.LNX.4.58.0411161409530.7962@echidna.fhcrc.org>
References: <Pine.LNX.4.58.0411161409530.7962@echidna.fhcrc.org>
Message-ID: <6.1.0.6.2.20041118104207.05f0c888@mailhost.blackmesacapital.com>

If you want to avoid typing, why not just use a shell that offers file-name 
completion?  Lots do.  That would seem to address the problem in the place 
where it arises.

I don't think it would be a good idea to make R try to guess whether it 
really should use the second argument after BATCH as an output file.  This 
type of complication can have unintended and unanticipated side effects -- 
"Do What I Mean" programming tools have not been a huge success because 
it's impossible to always accurately guess what a person means.  I don't 
know about other people, but I use scripts to generate scripts all the time 
(for generating commands to run experiments with different sets of parameters).

-- Tony Plate

At Tuesday 03:32 PM 11/16/2004, Douglas Grove wrote:
>Hi,
>
>I'm having a problem (of my own creation) with BATCH.
>
>The current problem (for me):
>----------------------------
>I'm sloppy.  I work on *nux systems and will type e.g. "R CMD BATCH a*R out"
>to avoid typing the full name of some R script of mine.  However,
>sometimes I'm overly sloppy and there are multiple files that match
>"a*R", so "a*R" turns into e.g. "aa.R ab.R", and the arguments to
>BATCH will be "aa.R ab.R out".  BATCH will use aa.R as the input file and
>ab.R as the output file, leading to my script ab.R being overwritten.
>I then have to plead to my sysadm to restore the file for me.
>
>I've done this often enough that I need to make a modification to BATCH,
>and was wondering if anything can be done about this that can be used
>generally.  In other words, is there a fix to my problem that would be
>usable in general and won't mess up something else?
>
>
>Solutions:
>-----------
>A simple solution to this problem is to print a message and exit when
>more than 2 arguments are found.  While I don't know why offhand, there's
>probably a reason why people would like to pass extra arguments and have
>them ignored by BATCH.  If so, this won't work in general.
>
>Something more intelligent would be to examine the first two arguments
>and if they both end in .R then issue a message and exit.  I would think
>create fewer problems.  I don't think many people are using R scripts to
>create other R scripts, and if they are they can always rename them after
>they create them.
>
>I'm just going to go for the simple solution for now, but wanted to toss
>this issue out in case it might be something that could be integrated
>into the official BATCH script.
>
>Thanks,
>
>Doug Grove
>Statistical Research Associate
>Fred Hutchinson Cancer Research Center
>Seattle, WA
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From dgrove at fhcrc.org  Thu Nov 18 19:04:21 2004
From: dgrove at fhcrc.org (Douglas Grove)
Date: Thu Nov 18 19:05:40 2004
Subject: [Rd] modification of BATCH
In-Reply-To: <6.1.0.6.2.20041118104207.05f0c888@mailhost.blackmesacapital.com>
References: <Pine.LNX.4.58.0411161409530.7962@echidna.fhcrc.org>
	<6.1.0.6.2.20041118104207.05f0c888@mailhost.blackmesacapital.com>
Message-ID: <Pine.LNX.4.58.0411181000230.13012@echidna.fhcrc.org>

No problem.  I wasn't sure if there were std. situations in which
extraneous arguments (i.e. arguments not meant to be interpretted
by R or BATCH) would be passed.  In that case it would not be a
big deal to put an error check on this. 

I've modified my version of BATCH to handle my issues, I was
just soliciting feedback about its more general usefulness.

Thanks,
Doug



On Thu, 18 Nov 2004, Tony Plate wrote:

> If you want to avoid typing, why not just use a shell that offers file-name 
> completion?  Lots do.  That would seem to address the problem in the place 
> where it arises.
> 
> I don't think it would be a good idea to make R try to guess whether it 
> really should use the second argument after BATCH as an output file.  This 
> type of complication can have unintended and unanticipated side effects -- 
> "Do What I Mean" programming tools have not been a huge success because 
> it's impossible to always accurately guess what a person means.  I don't 
> know about other people, but I use scripts to generate scripts all the time 
> (for generating commands to run experiments with different sets of parameters).
> 
> -- Tony Plate
> 
> At Tuesday 03:32 PM 11/16/2004, Douglas Grove wrote:
> >Hi,
> >
> >I'm having a problem (of my own creation) with BATCH.
> >
> >The current problem (for me):
> >----------------------------
> >I'm sloppy.  I work on *nux systems and will type e.g. "R CMD BATCH a*R out"
> >to avoid typing the full name of some R script of mine.  However,
> >sometimes I'm overly sloppy and there are multiple files that match
> >"a*R", so "a*R" turns into e.g. "aa.R ab.R", and the arguments to
> >BATCH will be "aa.R ab.R out".  BATCH will use aa.R as the input file and
> >ab.R as the output file, leading to my script ab.R being overwritten.
> >I then have to plead to my sysadm to restore the file for me.
> >
> >I've done this often enough that I need to make a modification to BATCH,
> >and was wondering if anything can be done about this that can be used
> >generally.  In other words, is there a fix to my problem that would be
> >usable in general and won't mess up something else?
> >
> >
> >Solutions:
> >-----------
> >A simple solution to this problem is to print a message and exit when
> >more than 2 arguments are found.  While I don't know why offhand, there's
> >probably a reason why people would like to pass extra arguments and have
> >them ignored by BATCH.  If so, this won't work in general.
> >
> >Something more intelligent would be to examine the first two arguments
> >and if they both end in .R then issue a message and exit.  I would think
> >create fewer problems.  I don't think many people are using R scripts to
> >create other R scripts, and if they are they can always rename them after
> >they create them.
> >
> >I'm just going to go for the simple solution for now, but wanted to toss
> >this issue out in case it might be something that could be integrated
> >into the official BATCH script.
> >
> >Thanks,
> >
> >Doug Grove
> >Statistical Research Associate
> >Fred Hutchinson Cancer Research Center
> >Seattle, WA
> >
> >______________________________________________
> >R-devel@stat.math.ethz.ch mailing list
> >https://stat.ethz.ch/mailman/listinfo/r-devel
>

From maechler at stat.math.ethz.ch  Thu Nov 18 19:32:36 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Nov 18 19:32:54 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
Message-ID: <20041118183236.0625EF6DA@slim.kubism.ku.dk>

>>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
>>>>>     on Thu, 18 Nov 2004 16:36:03 +0100 (CET) writes:

    Duncan> On Thu, 18 Nov 2004 00:38:47 +0000 (UTC), Gabor
    Duncan> Grothendieck <ggrothendieck@myway.com> wrote :

    >> DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT
    >> 
    >> The reason that the processing is different according to
    >> whether one uses .Rbuildignore or not is that R CMD build
    >> takes the .Rbuildignore file into account but R CMD
    >> install R CMD check R CMD build --binary do not take
    >> .Rbuildignore into account.

    Duncan> Okay, now I understand.  I think I'd call the last
    Duncan> of those a bug, and it would seem to me that the
    Duncan> install and check scripts should also respect this
    Duncan> directive.  I've now copied this to the r-bugs list.

    Duncan> (This was reported for Windows; I don't know if it
    Duncan> applies to other platforms as well.)

Yes it does (*), but I think it is NOT a bug but a feature,
at least for "check" and "install" (*) 
and very much desired in some cases :

For instance, the package developer may want more
regression tests in <Pkg>/tests/ :

1) Have extra *.Rout.save files that are architecture
   dependent and hence not for general distribution of the
   package, but important for the package developer in order to
   assure that functionality doesn't change when the package is
   extended, reorganized, ....

2) Have more  tests/*.R  files  that take a long time to run.
   Time that the package developer wants to spend, but doesn't
   dare to put on the daily CRAN or Bioconductor test suites.

3) similarly for vignettes

4) similar issues for experimental  R/*.R files  or man/*.Rd
   files for these.

One I thing that would be quite useful and would even solve
Gabor's problem: 
The introduction of a new command line switch, say "--build-ignore",
to the commands 'R CMD check' and 'R CMD install'

--------

(*) I do agree that  "R CMD build --binary" probably really should
    follow the ".Rbuildignore" file ``directives'' if it doesn't
    currently.

Martin

From ggrothendieck at myway.com  Thu Nov 18 21:10:53 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 18 21:11:17 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
Message-ID: <20041118201053.A906F39FA@mprdmxin.myway.com>



 <murdoch <at> stats.uwo.ca> writes:

: 
: On Thu, 18 Nov 2004 00:38:47 +0000 (UTC), Gabor Grothendieck
: <ggrothendieck <at> myway.com> wrote :
: 
: >DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT
: >
: >The reason that the processing is different according to whether one
: >uses .Rbuildignore or not is that 
: >  R CMD build 
: >takes the .Rbuildignore file into account but 
: >  R CMD install
: >  R CMD check
: >  R CMD build --binary 
: >do not take .Rbuildignore into account.  
: 
: Okay, now I understand.  I think I'd call the last of those a bug, and
: it would seem to me that the install and check scripts should also
: respect this directive.   I've now copied this to the r-bugs list.
: (This was reported for Windows; I don't know if it applies to other
: platforms as well.)
: 
: Just for clarification:  I can see you would use this when you have
: S-PLUS code in the same directory as R code, and you don't want to
: include that in an R build.  Are there other files that must be
: excluded?

My primary directory is mirrored by svn and I put everything
in there that I want other developers to be able to see,
even if its not ready or not intended for inclusion in the
build.  

The .Rbuildignore is important to distinguish what is to be
built and what is just there to be shared.

Some instances where this useful are:
- have abc.R but don't want it in build until abc.Rd is available
- have abc.Rd but don't want it in build until abc.R is written
- abc.R is available but too buggy yet it needs to be shared with
  others so they know about it
- interface code which interfaces with package X and will 
  ultimately go into package X, not this one, but needs to be
  around in the meantime
- code which depends on a package that we don't want to invoke
  for now and will probably be replaced anyways
- certain notes to be shared among the developers

Also it would really be nice to be able to turn the
.Rbuildignore on and off using a command line switch on 
R CMD ... as someone on the thread has already suggested.  It
can be useful to check and install the ignored stuff to
ensure its ready before actually removing it from
.Rbuildignore.  It might even be nice to be able to specify
alternate .Rbuildignore files although I am not sure whether
that is going too far or not.

What I am doing in the meantime is that I have a Windows
batch script that can be used like this:

   myscript install mypkg
   myscript check mypkg
   myscript binary mypkg

where each of these first does a build creating a .tar.gz
file and then detars it into another directory and invokes
install, check or build --binary on the built copy of the
source in that directory.

If I want to do an install, check or build --binary without
respecting the .Rbuildignore then I just use the original
R CMD ... commands instead of my script.

From huber at ebi.ac.uk  Thu Nov 18 21:49:46 2004
From: huber at ebi.ac.uk (huber@ebi.ac.uk)
Date: Thu Nov 18 21:49:58 2004
Subject: [Rd] Declaration of RuleThickness() in src/main/plotmath.c (PR#7380)
Message-ID: <20041118204946.AB3B4F6DA@slim.kubism.ku.dk>

Full_Name: Wolfgang Huber
Version: R-2.0.1
OS: HP-UX B.11.23 ia64
Submission from: (NULL) (81.104.215.6)


Hi, 

I hope I am not missing something basic... I am using a somewhat exotic compiler
and OS, but if I understand what I am seeing the problem is more general:

In src/main/plotmath.c, the following function is defined

/* Thickness of rules */
static double RuleThickness()
{
    return 0.015;
}

but later it is called in expressions like

  RuleThickness(gc, dd)

This leads to a compiler error:

cc +DD64 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre 
-I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H
  -O +e -c plotmath.c -o plotmath.o
Error 181: "plotmath.c", line 255 # Expected 0 argument(s) for "double
RuleThickness()"; had 2 instead.
                + 3.51 * RuleThickness(gc, dd)
 

It would appear that the function definition should include the argument
(R_GE_gcontext *gc, GEDevDesc *dd), like in the other functions that are defined
around there.

From p.dalgaard at biostat.ku.dk  Thu Nov 18 22:31:48 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Nov 18 22:33:36 2004
Subject: [Rd] Declaration of RuleThickness() in src/main/plotmath.c
	(PR#7380)
In-Reply-To: <20041118204946.AB3B4F6DA@slim.kubism.ku.dk>
References: <20041118204946.AB3B4F6DA@slim.kubism.ku.dk>
Message-ID: <x23bz6sv23.fsf@biostat.ku.dk>

huber@ebi.ac.uk writes:

> Full_Name: Wolfgang Huber
> Version: R-2.0.1
> OS: HP-UX B.11.23 ia64
> Submission from: (NULL) (81.104.215.6)
> 
> 
> Hi, 
> 
> I hope I am not missing something basic... I am using a somewhat exotic compiler
> and OS, but if I understand what I am seeing the problem is more general:
> 
> In src/main/plotmath.c, the following function is defined
> 
> /* Thickness of rules */
> static double RuleThickness()
> {
>     return 0.015;
> }
> 
> but later it is called in expressions like
> 
>   RuleThickness(gc, dd)
> 
> This leads to a compiler error:
> 
> cc +DD64 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre 
> -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H
>   -O +e -c plotmath.c -o plotmath.o
> Error 181: "plotmath.c", line 255 # Expected 0 argument(s) for "double
> RuleThickness()"; had 2 instead.
>                 + 3.51 * RuleThickness(gc, dd)
>  
> 
> It would appear that the function definition should include the argument
> (R_GE_gcontext *gc, GEDevDesc *dd), like in the other functions that are defined
> around there.

It appears like that to me too, but why, oh why, hasn't any of the
other compilers been complaining about it???? (Perhaps this is
actually legal ANSI C, and compilers are only supposed to barf if you
declare statid double RuleThickness(void)?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Roger.Bivand at nhh.no  Thu Nov 18 22:34:57 2004
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu Nov 18 22:35:08 2004
Subject: [Rd] Method dispatch S3/S4 through optimize()
Message-ID: <Pine.LNX.4.44.0411182142100.17109-100000@reclus.nhh.no>

I have been running into difficulties with dispatching on an S4 class
defined in the SparseM package, when the method calls are inside a
function passed as the f= argument to optimize() in functions in the spdep
package. The S4 methods are typically defined as:

setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)

that is within setMethod() rather than by name before the setMethod().

When called from within functions passed as the f= argument to optimize, 
the S3 generics for det() and chol() get picked up, not the S4 generics 
for the S4 SparseM classes. This looks for instance like (from 
example(boston)):

> gp2 <- lagsarlm(log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + I(RM^2)
+  +  AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + log(LSTAT),
+  data=boston.c, nb2listw(boston.soi), method="SparseM")
matrix.csr 
Error in chol(tmp1) : non-numeric argument to chol

(this is the error message in chol.R in base). tmp1 is of class
"matrix.csr", but is being sent to the S3 class (error in function 
sar.lag.mix.f.sM() in R/lag.spsarlm.R). 

sar.lag.mix.f.sM <- function(rho, W, e.a, e.b, e.c, n, quiet)
{
	SSE <- e.a - 2*rho*e.b + rho*rho*e.c
	s2 <- SSE/n
	tmp1 <- asMatrixCsrIrW(W, rho)
cat(class(tmp1), "\n")
	tmp2 <- chol(tmp1)
#	tmp2 <- .cholMatrixCsr(tmp1)
cat(class(tmp2), "\n")
	tmp3 <- (tmp2@det)^2
cat(tmp3, "\n")
	ret <- (log(tmp3)
		- ((n/2)*log(2*pi)) - (n/2)*log(s2) - (1/(2*s2))*SSE)
	if (!quiet) 
	    cat("(SparseM) rho:\t", rho, "\tfunction value:\t", ret, "\n")
	ret
}


Three further observations:

1) In a simpler case:

> library(spdep)
Loading required package: tripack 
Loading required package: maptools 
Loading required package: foreign 
Loading required package: SparseM 
[1] "SparseM library loaded"
> example(similar.listw)
...
smlr.l> log(det(asMatrixCsrIrW(asMatrixCsrListw(similar.listw(COL.W)), 0.5)))
[1] -1.627660

just works, and the appropriate det() and chol() are found; det() 
dispatches on class "matrix.csr" and finds the right chol() for that 
class - this is the same code context as found in the function passed to 
optimize(); 

2) When the R source file containing the lagsarlm() function, and the
function sent as f= through optimize is sourced(), the appropriate det()
and chol() are found; and

3) When the SparseM R code is modified, and the function defined prior to 
its setMethod (so visible as a function independently of setMethod) and 
called by name rather than as a method, everything works, as it should. 
But this isn't a solution, setMethod() defined methods should dispatch on 
class irrespective of context, I think.

SparseM does not have a namespace, spdep does, but I don't think this is
the issue. I'm pretty sure this isn't an issue with SparseM either,
because of 1).

I've put a copy of the problematic spdep on:

http://reclus.nhh.no/R/spdep/spdep_0.2-24.tar.gz

should that be of any use, the issue is present in both R-2.0.1 and 
R-devel (2004-11-16), SparseM is 0.52. 

I hope that I'm missing something fairly obvious.

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
e-mail: Roger.Bivand@nhh.no

From rkoenker at uiuc.edu  Fri Nov 19 01:41:55 2004
From: rkoenker at uiuc.edu (roger koenker)
Date: Fri Nov 19 01:42:40 2004
Subject: [Rd] Re: Method dispatch S3/S4 through optimize()
In-Reply-To: <Pine.LNX.4.44.0411182142100.17109-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0411182142100.17109-100000@reclus.nhh.no>
Message-ID: <D007130A-39C3-11D9-964C-000A95A7E3AA@uiuc.edu>

I am far from an expert on S4 method dispatch, so at the risk of 
embarrassing
myself I will just indicate how the det() function is written in 
SparseM now
in the hope that someone else will see the source of the problem:

setGeneric("det")
setMethod("det","matrix",get("det", pos=NULL, mode= "function"))
setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
setMethod("det","matrix.csr.chol", function(x, ...) x@det)

The Cholesky function  chol in SparseM  was recently extended slightly
to compute this determinant  as an additional component, so if the
argument is already of the matrix.csr.chol class det() just extracts 
this
component, otherwise it tries to do the cholesky, or defaults to the
base function.

I hope that this might expose some fly in the soup.


url:	www.econ.uiuc.edu/~roger        	Roger Koenker
email	rkoenker@uiuc.edu			Department of Economics
vox: 	217-333-4558				University of Illinois
fax:   	217-244-6678				Champaign, IL 61820

On Nov 18, 2004, at 3:34 PM, Roger Bivand wrote:

> I have been running into difficulties with dispatching on an S4 class
> defined in the SparseM package, when the method calls are inside a
> function passed as the f= argument to optimize() in functions in the 
> spdep
> package. The S4 methods are typically defined as:
>
> setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
>
> that is within setMethod() rather than by name before the setMethod().
>
> When called from within functions passed as the f= argument to 
> optimize,
> the S3 generics for det() and chol() get picked up, not the S4 generics
> for the S4 SparseM classes. This looks for instance like (from
> example(boston)):
>
>> gp2 <- lagsarlm(log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + 
>> I(RM^2)
> +  +  AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + log(LSTAT),
> +  data=boston.c, nb2listw(boston.soi), method="SparseM")
> matrix.csr
> Error in chol(tmp1) : non-numeric argument to chol
>
> (this is the error message in chol.R in base). tmp1 is of class
> "matrix.csr", but is being sent to the S3 class (error in function
> sar.lag.mix.f.sM() in R/lag.spsarlm.R).
>
> sar.lag.mix.f.sM <- function(rho, W, e.a, e.b, e.c, n, quiet)
> {
> 	SSE <- e.a - 2*rho*e.b + rho*rho*e.c
> 	s2 <- SSE/n
> 	tmp1 <- asMatrixCsrIrW(W, rho)
> cat(class(tmp1), "\n")
> 	tmp2 <- chol(tmp1)
> #	tmp2 <- .cholMatrixCsr(tmp1)
> cat(class(tmp2), "\n")
> 	tmp3 <- (tmp2@det)^2
> cat(tmp3, "\n")
> 	ret <- (log(tmp3)
> 		- ((n/2)*log(2*pi)) - (n/2)*log(s2) - (1/(2*s2))*SSE)
> 	if (!quiet)
> 	    cat("(SparseM) rho:\t", rho, "\tfunction value:\t", ret, "\n")
> 	ret
> }
>
>
> Three further observations:
>
> 1) In a simpler case:
>
>> library(spdep)
> Loading required package: tripack
> Loading required package: maptools
> Loading required package: foreign
> Loading required package: SparseM
> [1] "SparseM library loaded"
>> example(similar.listw)
> ...
> smlr.l> log(det(asMatrixCsrIrW(asMatrixCsrListw(similar.listw(COL.W)), 
> 0.5)))
> [1] -1.627660
>
> just works, and the appropriate det() and chol() are found; det()
> dispatches on class "matrix.csr" and finds the right chol() for that
> class - this is the same code context as found in the function passed 
> to
> optimize();
>
> 2) When the R source file containing the lagsarlm() function, and the
> function sent as f= through optimize is sourced(), the appropriate 
> det()
> and chol() are found; and
>
> 3) When the SparseM R code is modified, and the function defined prior 
> to
> its setMethod (so visible as a function independently of setMethod) and
> called by name rather than as a method, everything works, as it should.
> But this isn't a solution, setMethod() defined methods should dispatch 
> on
> class irrespective of context, I think.
>
> SparseM does not have a namespace, spdep does, but I don't think this 
> is
> the issue. I'm pretty sure this isn't an issue with SparseM either,
> because of 1).
>
> I've put a copy of the problematic spdep on:
>
> http://reclus.nhh.no/R/spdep/spdep_0.2-24.tar.gz
>
> should that be of any use, the issue is present in both R-2.0.1 and
> R-devel (2004-11-16), SparseM is 0.52.
>
> I hope that I'm missing something fairly obvious.
>
> Roger
>
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School 
> of
> Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
> e-mail: Roger.Bivand@nhh.no
>
>

From murdoch at stats.uwo.ca  Fri Nov 19 13:11:24 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Nov 19 13:10:58 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
In-Reply-To: <16796.60089.240349.278172@gargle.gargle.HOWL>
References: <20041118153603.E0215F18D@slim.kubism.ku.dk>
	<16796.60089.240349.278172@gargle.gargle.HOWL>
Message-ID: <jmorp01nv856ofohrfpbqqortiujihqhki@4ax.com>

On Thu, 18 Nov 2004 19:32:25 +0100, Martin Maechler
<maechler@stat.math.ethz.ch> wrote:

>>>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
>>>>>>     on Thu, 18 Nov 2004 16:36:03 +0100 (CET) writes:
>
>    Duncan> On Thu, 18 Nov 2004 00:38:47 +0000 (UTC), Gabor
>    Duncan> Grothendieck <ggrothendieck@myway.com> wrote :
>
>    >> DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT
>    >> 
>    >> The reason that the processing is different according to
>    >> whether one uses .Rbuildignore or not is that R CMD build
>    >> takes the .Rbuildignore file into account but R CMD
>    >> install R CMD check R CMD build --binary do not take
>    >> .Rbuildignore into account.
>
>    Duncan> Okay, now I understand.  I think I'd call the last
>    Duncan> of those a bug, and it would seem to me that the
>    Duncan> install and check scripts should also respect this
>    Duncan> directive.  I've now copied this to the r-bugs list.
>
>    Duncan> (This was reported for Windows; I don't know if it
>    Duncan> applies to other platforms as well.)
>
>Yes it does (*), but I think it is NOT a bug but a feature,
>at least for "check" and "install" (*) 
>and very much desired in some cases :
>
>For instance, the package developer may want more
>regression tests in <Pkg>/tests/ :
>
>1) Have extra *.Rout.save files that are architecture
>   dependent and hence not for general distribution of the
>   package, but important for the package developer in order to
>   assure that functionality doesn't change when the package is
>   extended, reorganized, ....
>
>2) Have more  tests/*.R  files  that take a long time to run.
>   Time that the package developer wants to spend, but doesn't
>   dare to put on the daily CRAN or Bioconductor test suites.
>
>3) similarly for vignettes
>
>4) similar issues for experimental  R/*.R files  or man/*.Rd
>   files for these.
>
>One I thing that would be quite useful and would even solve
>Gabor's problem: 
>The introduction of a new command line switch, say "--build-ignore",
>to the commands 'R CMD check' and 'R CMD install'

Shouldn't that option be "--ignore-build-ignore"? :-)

More seriously:  I suspect that an on/off switch for the .Rbuildignore
file wouldn't be sufficiently flexible: the same package author might
want different things at different times, e.g. building a binary for
Windows would include different files than a binary for another
platform.  We could put together some sort of system of conditionals
within the .Rbuildignore file, but I think it would be better to just
advise such package writers to maintain one or more .Rbuildignore.in
files, and manually (or by makefile) copy the appropriate one in place
first.

Duncan Murdoch

>
>--------
>
>(*) I do agree that  "R CMD build --binary" probably really should
>    follow the ".Rbuildignore" file ``directives'' if it doesn't
>    currently.

From Roger.Bivand at nhh.no  Fri Nov 19 13:56:55 2004
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri Nov 19 13:57:08 2004
Subject: [Rd] Re: Method dispatch S3/S4 through optimize()
In-Reply-To: <D007130A-39C3-11D9-964C-000A95A7E3AA@uiuc.edu>
Message-ID: <Pine.LNX.4.44.0411191335550.17908-100000@reclus.nhh.no>

On Thu, 18 Nov 2004, roger koenker wrote:

> I am far from an expert on S4 method dispatch, so at the risk of
> embarrassing myself I will just indicate how the det() function is
> written in SparseM now in the hope that someone else will see the source
> of the problem:
> 
> setGeneric("det")
> setMethod("det","matrix",get("det", pos=NULL, mode= "function"))
> setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
> setMethod("det","matrix.csr.chol", function(x, ...) x@det)
> 
> The Cholesky function chol in SparseM was recently extended slightly to
> compute this determinant as an additional component, so if the argument
> is already of the matrix.csr.chol class det() just extracts this
> component, otherwise it tries to do the cholesky, or defaults to the
> base function.

As I read the SparseM code, it is following the specification, and if
there was something wrong, the simple example 1) would not have worked
either. But it does, so something changes in the context of where a
function like det() and chol() is called from, here through optimize(),
that sends it to the wrong place based on assuming that the class is 
unknown. 

I'll try to make an example that doesn't depend on spdep, just on SparseM 
and optimize().

This is frustrating, because with Ord's trick of using matrices similar to
symmetric, the SparseM route will be very useful for most situations, 
even though it requires strictly symmetric matrices. So your provision of 
det() for "matrix.csr" is very useful, once we sort out this strange 
behaviour.

Roger

> 
> I hope that this might expose some fly in the soup.
> 
> 
> url:	www.econ.uiuc.edu/~roger        	Roger Koenker
> email	rkoenker@uiuc.edu			Department of Economics
> vox: 	217-333-4558				University of Illinois
> fax:   	217-244-6678				Champaign, IL 61820
> 
> On Nov 18, 2004, at 3:34 PM, Roger Bivand wrote:
> 
> > I have been running into difficulties with dispatching on an S4 class
> > defined in the SparseM package, when the method calls are inside a
> > function passed as the f= argument to optimize() in functions in the 
> > spdep
> > package. The S4 methods are typically defined as:
> >
> > setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
> >
> > that is within setMethod() rather than by name before the setMethod().
> >
> > When called from within functions passed as the f= argument to 
> > optimize,
> > the S3 generics for det() and chol() get picked up, not the S4 generics
> > for the S4 SparseM classes. This looks for instance like (from
> > example(boston)):
> >
> >> gp2 <- lagsarlm(log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + 
> >> I(RM^2)
> > +  +  AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + log(LSTAT),
> > +  data=boston.c, nb2listw(boston.soi), method="SparseM")
> > matrix.csr
> > Error in chol(tmp1) : non-numeric argument to chol
> >
> > (this is the error message in chol.R in base). tmp1 is of class
> > "matrix.csr", but is being sent to the S3 class (error in function
> > sar.lag.mix.f.sM() in R/lag.spsarlm.R).
> >
> > sar.lag.mix.f.sM <- function(rho, W, e.a, e.b, e.c, n, quiet)
> > {
> > 	SSE <- e.a - 2*rho*e.b + rho*rho*e.c
> > 	s2 <- SSE/n
> > 	tmp1 <- asMatrixCsrIrW(W, rho)
> > cat(class(tmp1), "\n")
> > 	tmp2 <- chol(tmp1)
> > #	tmp2 <- .cholMatrixCsr(tmp1)
> > cat(class(tmp2), "\n")
> > 	tmp3 <- (tmp2@det)^2
> > cat(tmp3, "\n")
> > 	ret <- (log(tmp3)
> > 		- ((n/2)*log(2*pi)) - (n/2)*log(s2) - (1/(2*s2))*SSE)
> > 	if (!quiet)
> > 	    cat("(SparseM) rho:\t", rho, "\tfunction value:\t", ret, "\n")
> > 	ret
> > }
> >
> >
> > Three further observations:
> >
> > 1) In a simpler case:
> >
> >> library(spdep)
> > Loading required package: tripack
> > Loading required package: maptools
> > Loading required package: foreign
> > Loading required package: SparseM
> > [1] "SparseM library loaded"
> >> example(similar.listw)
> > ...
> > smlr.l> log(det(asMatrixCsrIrW(asMatrixCsrListw(similar.listw(COL.W)), 
> > 0.5)))
> > [1] -1.627660
> >
> > just works, and the appropriate det() and chol() are found; det()
> > dispatches on class "matrix.csr" and finds the right chol() for that
> > class - this is the same code context as found in the function passed 
> > to
> > optimize();
> >
> > 2) When the R source file containing the lagsarlm() function, and the
> > function sent as f= through optimize is sourced(), the appropriate 
> > det()
> > and chol() are found; and
> >
> > 3) When the SparseM R code is modified, and the function defined prior 
> > to
> > its setMethod (so visible as a function independently of setMethod) and
> > called by name rather than as a method, everything works, as it should.
> > But this isn't a solution, setMethod() defined methods should dispatch 
> > on
> > class irrespective of context, I think.
> >
> > SparseM does not have a namespace, spdep does, but I don't think this 
> > is
> > the issue. I'm pretty sure this isn't an issue with SparseM either,
> > because of 1).
> >
> > I've put a copy of the problematic spdep on:
> >
> > http://reclus.nhh.no/R/spdep/spdep_0.2-24.tar.gz
> >
> > should that be of any use, the issue is present in both R-2.0.1 and
> > R-devel (2004-11-16), SparseM is 0.52.
> >
> > I hope that I'm missing something fairly obvious.
> >
> > Roger
> >
> > -- 
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School 
> > of
> > Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
> > e-mail: Roger.Bivand@nhh.no
> >
> >
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
e-mail: Roger.Bivand@nhh.no

From andy_liaw at merck.com  Fri Nov 19 15:23:02 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Fri Nov 19 15:23:47 2004
Subject: [Rd] RE: [R] Building package on Linux and Windows
Message-ID: <3A822319EB35174CA3714066D590DCD50994E34B@usrymx25.merck.com>

Mick,

Questions about packaging are better suited for R-devel (so I'm redirecting
there).

My understanding is that R CMD build mypkg, w/o other flags, does a bit more
than tar/gzip:  it skips junk files (e.g., .o, .a, .so, etc.).  Also, the
--force flag will update the INDEX file.

On Windows, you'll probably want R CMD build --binary mypkg for building
binary package.  What this does is install the package in a temporary
location, then zip that installed package.  The installation step is
necessary, at least because the help files need to be generated from the Rd
files.

HTH,
Andy

> From:  michael watson (IAH-C)
> 
> Hi
> 
> OK, final stretch now, thank you to everyone who has helped!
> 
> (hopefully) final question - what does R CMD build actually do that
> tar/gzip and WinZip do not?
> 
> I have successfully used R CMD build to create a .tar.gz version of my
> package, which installs well and works under Linux - hurray!  
> I naively
> thought that all I had to do now was create a .zip version (using
> something like WinZip) and it would work on Windows too - wrong!
> 
> On Windows I get:
> 
> Error in file(file, "r") : unable to open connection
> In addition: Warning messages: 
> 1: error -1 in extracting from zip file 
> 2: cannot open file `coXpress/DESCRIPTION' 
> 
> I didn't run R CMD build on Windows because I don't have "suitable
> versions of Unix tools including make, sh, rm, sed, 
> awk,mkdir, echo, cp
> and cat; we have packaged a set at
> http://www.murdoch-sutherland.com/Rtools/tools.zip.".  Do I 
> really have
> to install all of these on my Windows machine to build a package?  
> 
> Asked another way - I have a linux .tar.gz file which works, how do I
> make a windows version?
> 
> Thanks in advance!
> 
> Mick
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! 
> http://www.R-project.org/posting-guide.html
> 
>

From ggrothendieck at myway.com  Fri Nov 19 15:28:29 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Fri Nov 19 15:28:43 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
References: <20041118153603.E0215F18D@slim.kubism.ku.dk>
	<16796.60089.240349.278172@gargle.gargle.HOWL>
	<jmorp01nv856ofohrfpbqqortiujihqhki@4ax.com>
Message-ID: <loom.20041119T150415-791@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

: 
: On Thu, 18 Nov 2004 19:32:25 +0100, Martin Maechler
: <maechler <at> stat.math.ethz.ch> wrote:
: 
: >>>>>> "Duncan" == Duncan Murdoch <murdoch <at> stats.uwo.ca>
: >>>>>>     on Thu, 18 Nov 2004 16:36:03 +0100 (CET) writes:
: >
: >    Duncan> On Thu, 18 Nov 2004 00:38:47 +0000 (UTC), Gabor
: >    Duncan> Grothendieck <ggrothendieck <at> myway.com> wrote :
: >
: >    >> DIFFERENCE BETWEEN USING .RBUILDIGNORE AND NOT
: >    >> 
: >    >> The reason that the processing is different according to
: >    >> whether one uses .Rbuildignore or not is that R CMD build
: >    >> takes the .Rbuildignore file into account but R CMD
: >    >> install R CMD check R CMD build --binary do not take
: >    >> .Rbuildignore into account.
: >
: >    Duncan> Okay, now I understand.  I think I'd call the last
: >    Duncan> of those a bug, and it would seem to me that the
: >    Duncan> install and check scripts should also respect this
: >    Duncan> directive.  I've now copied this to the r-bugs list.
: >
: >    Duncan> (This was reported for Windows; I don't know if it
: >    Duncan> applies to other platforms as well.)
: >
: >Yes it does (*), but I think it is NOT a bug but a feature,
: >at least for "check" and "install" (*) 
: >and very much desired in some cases :
: >
: >For instance, the package developer may want more
: >regression tests in <Pkg>/tests/ :
: >
: >1) Have extra *.Rout.save files that are architecture
: >   dependent and hence not for general distribution of the
: >   package, but important for the package developer in order to
: >   assure that functionality doesn't change when the package is
: >   extended, reorganized, ....
: >
: >2) Have more  tests/*.R  files  that take a long time to run.
: >   Time that the package developer wants to spend, but doesn't
: >   dare to put on the daily CRAN or Bioconductor test suites.
: >
: >3) similarly for vignettes
: >
: >4) similar issues for experimental  R/*.R files  or man/*.Rd
: >   files for these.
: >
: >One I thing that would be quite useful and would even solve
: >Gabor's problem: 
: >The introduction of a new command line switch, say "--build-ignore",
: >to the commands 'R CMD check' and 'R CMD install'
: 
: Shouldn't that option be "--ignore-build-ignore"? 
: 
: More seriously:  I suspect that an on/off switch for the .Rbuildignore
: file wouldn't be sufficiently flexible: the same package author might
: want different things at different times, e.g. building a binary for
: Windows would include different files than a binary for another
: platform.  We could put together some sort of system of conditionals
: within the .Rbuildignore file, but I think it would be better to just
: advise such package writers to maintain one or more .Rbuildignore.in
: files, and manually (or by makefile) copy the appropriate one in place
: first.

That would be useful if there are several excluded files: a.R, b.R
and c.R and one wants to force inclusion of just a.R and b.R, say, but
continue to exclude c.R.   One could make a temporary copy
of .Rbuildignore, edit it to no longer exclude a.R and then use
R CMD as usual with the new switch/flag.

During development this could be quite useful as one tests out
different combinations in the presence or absence of other
files.

An even more elaborate design of this would be to have --include= and 
--exclude= switches/flags in which one can specify specific patterns
to include or exclude or @myfile to get them from a file.

Some typical examples might look like:
--exclude=@myfile     (gets file from same directory as .Rbuildignore)
--exclude=@.\myfile   (gets file from current directory
--exclude=@\myfile    (gets file from root directory)
--include="a.R|b.R"   (excludes all in .Rbuildignore except a.R and b.R)
--exclude=.Rbuildignore (this is the default)

Not sure how much work that is to implement but I can see it being
useful.

From murdoch at stats.uwo.ca  Fri Nov 19 16:16:49 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Nov 19 16:17:04 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
In-Reply-To: <jmorp01nv856ofohrfpbqqortiujihqhki@4ax.com>
References: <20041118153603.E0215F18D@slim.kubism.ku.dk>
	<16796.60089.240349.278172@gargle.gargle.HOWL>
	<jmorp01nv856ofohrfpbqqortiujihqhki@4ax.com>
Message-ID: <nb3sp05hve91d3urpthb6gi34d0tmautqd@4ax.com>

On Fri, 19 Nov 2004 07:11:24 -0500, Duncan Murdoch
<murdoch@stats.uwo.ca> wrote :

>>One I thing that would be quite useful and would even solve
>>Gabor's problem: 
>>The introduction of a new command line switch, say "--build-ignore",
>>to the commands 'R CMD check' and 'R CMD install'
>
>Shouldn't that option be "--ignore-build-ignore"? :-)
>
>More seriously:  I suspect that an on/off switch for the .Rbuildignore
>file wouldn't be sufficiently flexible: the same package author might
>want different things at different times, e.g. building a binary for
>Windows would include different files than a binary for another
>platform.  We could put together some sort of system of conditionals
>within the .Rbuildignore file, but I think it would be better to just
>advise such package writers to maintain one or more .Rbuildignore.in
>files, and manually (or by makefile) copy the appropriate one in place
>first.

A problem with my suggestion:  on CRAN, package authors don't build
Windows binary packages, Uwe does.  This means that the decision
needs to be there in the source or it won't affect the build.  What we
do in other cases (e.g. makefiles) is have a *.win version of the file
that only applies to Windows.  Should .Rbuildignore be handled
similarly?

Duncan Murdoch

From hb at maths.lth.se  Fri Nov 19 20:40:25 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Fri Nov 19 20:40:39 2004
Subject: [Rd] UseMethod call with no arguments - solved, I think
In-Reply-To: <Pine.LNX.4.61.0411161203070.19666@gannet.stats>
Message-ID: <005601c4ce6f$9e6caaf0$e502eb82@hblaptop>

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Prof 
> Brian Ripley
> Sent: Tuesday, November 16, 2004 1:36 PM
> To: Henrik Bengtsson
> Cc: R-devel@r-project.org
> Subject: RE: [Rd] UseMethod call with no arguments - solved, I think
> 

> > My concern/interpretation was that
> >
> > bar <- function(...) UseMethod("bar")
> >
> > is deprecated (where I saw "..." as the "arguments"). Reading 
> > ?UseMethod
> 
> I don't read that as being supported, and it does not work in 
> S.  `...' is 
> not strictly an argument of a function, and is usually documented as 
> `further arguments'.
> 
> > more carefully (it still says) - "If it is called with just one 
> > argument, the class of the first argument of the enclosing 
> function is 
> > used as
> > 'object': unlike S this is the actual argument passed and 
> not the current
> > value of the object of that name." - I see that the above 
> should still be
> > fine.
> 
> > So, now the note makes perfectly sense and it is *not* a "big step".
> 
> However, removing undocumented features can happen at any 
> time.  There is 
> danger in using unusual constructions that may be allowed 
> according to 
> some particular reading of some of the documentation.  In particular, 
> consider the following
> 
> > bar <- function(..., x) UseMethod("bar")
> > bar.foo <- function(..., x) print("foo")
> > x <- structure(1, class="foo")
> > bar(x) # arg is part of ...
> [1] "foo"
> > bar(x=x) # arg is matched to x
> [1] "foo"
> > bar(1, x=x)
> Error in bar(1, x) : no applicable method for "bar"

...and you wish to dispatch on 'x', which *can* be done with
UseMethod("bar", x")? In S3, where you can only dispatch on *one* object, is
there really a rational for *not* putting the object as a first argument?
Maybe...

For curiosity, I grepped the R v2.0.1 source for occurances where
UseMethod() is called with more than the one argument. Then I search for
those generic function who does not dispatch based on the first argument.
The result is:

% cd src/library/
% grep 'UseMethod(' */R/*.R | wc -l

  232   # nbr of usage of UseMethod

% grep -h -B 2 -E "^[ ]*[^#].*UseMethod[(][ ]*[\"'][^\"']*[\"'][ ]*[,]"
*/R/*.R

widthDetails <- function(x) {
  UseMethod("widthDetails", x)
--

heightDetails <- function(x) {
  UseMethod("heightDetails", x)

Recommended packages:
% for f in Recommended/*.tar.gz; do gunzip -c $f | tar -xO | grep -E "^[
]*[^#].*UseMethod[(][ ]*[\"'][^\"']*[\"'][ ]*[,]"; done

loglm1 <- function(formula, data, ...) UseMethod("loglm1", data)

So, only three generic functions in R distribution call UseMethod() with
more than one argument, and one of these are dispatching on the second
argument, not the first. The others call UseMethod() with one arguments,
maybe for the same reason as I will use below; minimize redundancy => easier
to maintain and less risk for bugs.

Continuing...

CRAN (419 packages):
The script and complete output is attached. 

I found the following packages (bundles were not checked) and generic
functions dispatching on another argument than the first (indeed, all on the
2nd):

Zeilig: sim <- function(object, x, ...) UseMethod("sim", x) 
ipred: bagging <- function(formula, data, ...) UseMethod("bagging", data) 
ipred: errorest <- function(formula, data, ...) UseMethod("errorest", data) 
ipred: inbagg <- function(formula, data, ...) UseMethod("inbagg", data) 
ipred: inclass <- function(formula, data, ...) UseMethod("inclass", data) 
maxstat: maxstat.test <- function(formula, data, ...)
UseMethod("maxstat.test", data)

Indeed, there are a few method dispatching on the 2nd argument. 

Interestingly, almost all of these seem to have a 'formula' as the first
argument and a data object as a second, which they dispatch on. This, was
actually the only case I could think of that would make sense; the 'formula'
object is somewhat more "important" than the 'data' object and is therefore
put first.

Your last call of your next example demonstrates a potential problem for the
above methods;

> > bar <- function(y, x, ...) UseMethod("bar")
> > bar(x) # matches y
> [1] "foo"
> > bar(x=x) # matches x
> [1] "foo"
> 
> and I don't think there is any intention that such behaviour will 
> necessarily continue (the last one does look like an error).  The 
> rules seem not to be written down clearly enough.'

Yes, it definitely looks like an error. 

However, of the above identified generic functions, will they be called
without the first argument? I would say, probably not. However, you can
always argue that the user may swap the order;

> y=1
> bar(x=x, y=y) # matches x

which is a *real* problem I would say. In the real world (the methods with
'formula' found above), that could be a problem, but I do not think it would
be hard to be explicit about this in the documentation/help.

There is of course a reason for why I put time on this, and it is because I
find extremely useful to write my generic function as

 generic <- function(...) UseMethod("generic")

This way I leave it open do *anyone* to use whatever arguments they want in
their 'generic.Class' methods (in case they have one of my package loaded).
Now I learned to add "...as long as they assume dispatching on the first
argument". 

Doing will minimize the risk for naming conflicts between existing packages
(that I do not know of, and of my packages that others do not know of),
between existing and future packages, between existing packages and future
added/modified core functions in R etc. 

Also, if I want to use a generic function called 'foo()', but there already
exists another function (or generic function) in another package (or in R)
identically named, then it is possible to test for this, try to redefine the
existing generic function etc, and replace it with the above construct. 

My (internal) setGenericS3() in R.oo, which is called by setMethodS3(), does
this. Since I started to use setMethodS3() for *all* (hundreds, maybe
thousands) of my method definitions including default function, that is,
since spring 2001, I *never* had to update a single method because of naming
conflicts or argument conflicts. I can use my hours for other things (as
working on Friday evening ;) ). (The only thing "issue" is that R CMD CHECK
of course complains about mismatching arguments between generic functions
and other). 

Best wishes

Henrik

> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
-------------- next part --------------
----------------------------------------------------
CRAN/RQuantLib_0.1.10.tar.gz
  #if (is.null(class(x)))
  #  class(x) <- data.class(x)
  #UseMethod("EuropeanOptionImpliedVolatility", x, ...)
--
  #if (is.null(class(x)))
  #  class(x) <- data.class(x)
  #UseMethod("AmericanOptionImpliedVolatility", x, ...)
--
  #if (is.null(class(x)))
  #  class(x) <- data.class(x)
  #UseMethod("EuropeanOption", x, ...)
--
  #if (is.null(class(x)))
  #  class(x) <- data.class(x)
  #UseMethod("AmericanOption", x, ...)
--
  #if (is.null(class(x)))
  #  class(x) <- data.class(x)
  #UseMethod("BinaryOption", x, ...)
--
  #if (is.null(class(x)))
  #  class(x) <- data.class(x)
  #UseMethod("BarrierOption", x, ...)

----------------------------------------------------
CRAN/XML_0.95-6.tar.gz
function(element, name, pos=NULL)
{
 UseMethod("dtdElementValidEntry", element) # , name, pos)
--
function(node, full = FALSE)
{
  UseMethod("xmlName", node)
--
function(node)
{
  UseMethod("xmlAttrs", node)
--
function(obj)
{
 UseMethod("xmlSize", obj)

----------------------------------------------------
CRAN/Zelig_2.0-9.tar.gz
    class(x) <- x$zelig.call$model
    if (exists(paste("plot.zelig", x$zelig.call$model, sep = ".")))
      UseMethod("plot.zelig", x)
--
sim <- function(object, x, ...) 
  UseMethod("sim", x)
--
summarize <- function(x, ...)
  UseMethod("summarize", x)

----------------------------------------------------
CRAN/car_1.0-13.tar.gz

Anova<-function(mod, ...){
    UseMethod("Anova", mod)
--
scatterplot<-function(x, ...){
    # last modified 28 Jan 2001 by J. Fox
    UseMethod("scatterplot", x)

----------------------------------------------------
CRAN/gam_0.92.tar.gz
			scales[i] <- plot.preplot.gam(x[[i]], y = NULL, 
				residuals, rugplot, se, scale, fit, ...)
		#			scales[i] <- UseMethod("plot",x[[i]])

----------------------------------------------------
CRAN/genetics_1.1.1.tar.gz

LD <- function(g1,...)
  UseMethod("LD",g1)

----------------------------------------------------
CRAN/ipred_0.8-0.tar.gz
# $Id: bagging.R,v 1.18 2003/03/31 08:44:16 peters Exp $

bagging <- function(formula, data, ...) UseMethod("bagging", data)
--
  if(is.null(class(y)))
    class(y) <- data.class(y)
  UseMethod("bootest", y)
--
  if(is.null(class(y)))
    class(y) <- data.class(y)
  UseMethod("cv", y)
--
}

errorest <- function(formula, data, ...) UseMethod("errorest", data)
--


inbagg <- function(formula, data, ...) UseMethod("inbagg", data)
--
# $Id: inclass.R,v 1.30 2003/07/22 14:56:31 peters Exp $

inclass <- function(formula, data, ...) UseMethod("inclass", data)
--
    class(y) <- data.class(y)
#  UseMethod("ipredbagg", y, ...)
  UseMethod("ipredbagg", y)

----------------------------------------------------
CRAN/leaps_2.7.tar.gz

regsubsets<-function(x,...){
  UseMethod("regsubsets",x)

----------------------------------------------------
CRAN/maxstat_0.7-7.tar.gz

maxstat.test <- function(formula, data, ...) 
  UseMethod("maxstat.test", data)

----------------------------------------------------
CRAN/mimR_1.2.2.tar.gz
}

toMIM <- function(data) UseMethod("toMIM", data)

----------------------------------------------------
CRAN/pastecs_1.2-0.tar.gz
"extract" <-
function (e, n, ...)
	UseMethod("extract", e, n, ...)
--
"specs" <-
function(x, ...)
	UseMethod("specs", x, ...)

----------------------------------------------------
CRAN/sem_0.8-0.tar.gz
sem <- function(ram, ...){
    if (is.character(ram)) class(ram) <- 'mod'
    UseMethod('sem', ram)

----------------------------------------------------
CRAN/sna_0.44-1.tar.gz

print.bbnam<-function(x,...){
   UseMethod("print",x)
--

print.summary.bbnam<-function(x,...){
   UseMethod("print",x)
--

plot.bbnam<-function(x,mode="density",intlines=TRUE,...){
   UseMethod("plot",x)

From Roger.Bivand at nhh.no  Fri Nov 19 20:51:15 2004
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri Nov 19 20:51:30 2004
Subject: [Rd] Re: Method dispatch S3/S4 through optimize()
In-Reply-To: <Pine.LNX.4.44.0411191335550.17908-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0411192045050.19844-100000@reclus.nhh.no>

The issue is not resolved, and also applies to optim() used in the same
setting - neither det() nor chol() for "matrix.csr" objects are found in
the function passed through. I have not been able to make a free-standing
example, however, so this is probably some strangeness in my own code. The
fix adopted is ugly, and involves passing a copy of the key function
through as an argument, the copy retrieved with getMethod("chol",
"matrix.csr"). Then it can be called directly, not relying on dispatch.

Roger

On Fri, 19 Nov 2004, Roger Bivand wrote:

> On Thu, 18 Nov 2004, roger koenker wrote:
> 
> > I am far from an expert on S4 method dispatch, so at the risk of
> > embarrassing myself I will just indicate how the det() function is
> > written in SparseM now in the hope that someone else will see the source
> > of the problem:
> > 
> > setGeneric("det")
> > setMethod("det","matrix",get("det", pos=NULL, mode= "function"))
> > setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
> > setMethod("det","matrix.csr.chol", function(x, ...) x@det)
> > 
> > The Cholesky function chol in SparseM was recently extended slightly to
> > compute this determinant as an additional component, so if the argument
> > is already of the matrix.csr.chol class det() just extracts this
> > component, otherwise it tries to do the cholesky, or defaults to the
> > base function.
> 
> As I read the SparseM code, it is following the specification, and if
> there was something wrong, the simple example 1) would not have worked
> either. But it does, so something changes in the context of where a
> function like det() and chol() is called from, here through optimize(),
> that sends it to the wrong place based on assuming that the class is 
> unknown. 
> 
> I'll try to make an example that doesn't depend on spdep, just on SparseM 
> and optimize().
> 
> This is frustrating, because with Ord's trick of using matrices similar to
> symmetric, the SparseM route will be very useful for most situations, 
> even though it requires strictly symmetric matrices. So your provision of 
> det() for "matrix.csr" is very useful, once we sort out this strange 
> behaviour.
> 
> Roger
> 
> > 
> > I hope that this might expose some fly in the soup.
> > 
> > 
> > url:	www.econ.uiuc.edu/~roger        	Roger Koenker
> > email	rkoenker@uiuc.edu			Department of Economics
> > vox: 	217-333-4558				University of Illinois
> > fax:   	217-244-6678				Champaign, IL 61820
> > 
> > On Nov 18, 2004, at 3:34 PM, Roger Bivand wrote:
> > 
> > > I have been running into difficulties with dispatching on an S4 class
> > > defined in the SparseM package, when the method calls are inside a
> > > function passed as the f= argument to optimize() in functions in the 
> > > spdep
> > > package. The S4 methods are typically defined as:
> > >
> > > setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
> > >
> > > that is within setMethod() rather than by name before the setMethod().
> > >
> > > When called from within functions passed as the f= argument to 
> > > optimize,
> > > the S3 generics for det() and chol() get picked up, not the S4 generics
> > > for the S4 SparseM classes. This looks for instance like (from
> > > example(boston)):
> > >
> > >> gp2 <- lagsarlm(log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + 
> > >> I(RM^2)
> > > +  +  AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + log(LSTAT),
> > > +  data=boston.c, nb2listw(boston.soi), method="SparseM")
> > > matrix.csr
> > > Error in chol(tmp1) : non-numeric argument to chol
> > >
> > > (this is the error message in chol.R in base). tmp1 is of class
> > > "matrix.csr", but is being sent to the S3 class (error in function
> > > sar.lag.mix.f.sM() in R/lag.spsarlm.R).
> > >
> > > sar.lag.mix.f.sM <- function(rho, W, e.a, e.b, e.c, n, quiet)
> > > {
> > > 	SSE <- e.a - 2*rho*e.b + rho*rho*e.c
> > > 	s2 <- SSE/n
> > > 	tmp1 <- asMatrixCsrIrW(W, rho)
> > > cat(class(tmp1), "\n")
> > > 	tmp2 <- chol(tmp1)
> > > #	tmp2 <- .cholMatrixCsr(tmp1)
> > > cat(class(tmp2), "\n")
> > > 	tmp3 <- (tmp2@det)^2
> > > cat(tmp3, "\n")
> > > 	ret <- (log(tmp3)
> > > 		- ((n/2)*log(2*pi)) - (n/2)*log(s2) - (1/(2*s2))*SSE)
> > > 	if (!quiet)
> > > 	    cat("(SparseM) rho:\t", rho, "\tfunction value:\t", ret, "\n")
> > > 	ret
> > > }
> > >
> > >
> > > Three further observations:
> > >
> > > 1) In a simpler case:
> > >
> > >> library(spdep)
> > > Loading required package: tripack
> > > Loading required package: maptools
> > > Loading required package: foreign
> > > Loading required package: SparseM
> > > [1] "SparseM library loaded"
> > >> example(similar.listw)
> > > ...
> > > smlr.l> log(det(asMatrixCsrIrW(asMatrixCsrListw(similar.listw(COL.W)), 
> > > 0.5)))
> > > [1] -1.627660
> > >
> > > just works, and the appropriate det() and chol() are found; det()
> > > dispatches on class "matrix.csr" and finds the right chol() for that
> > > class - this is the same code context as found in the function passed 
> > > to
> > > optimize();
> > >
> > > 2) When the R source file containing the lagsarlm() function, and the
> > > function sent as f= through optimize is sourced(), the appropriate 
> > > det()
> > > and chol() are found; and
> > >
> > > 3) When the SparseM R code is modified, and the function defined prior 
> > > to
> > > its setMethod (so visible as a function independently of setMethod) and
> > > called by name rather than as a method, everything works, as it should.
> > > But this isn't a solution, setMethod() defined methods should dispatch 
> > > on
> > > class irrespective of context, I think.
> > >
> > > SparseM does not have a namespace, spdep does, but I don't think this 
> > > is
> > > the issue. I'm pretty sure this isn't an issue with SparseM either,
> > > because of 1).
> > >
> > > I've put a copy of the problematic spdep on:
> > >
> > > http://reclus.nhh.no/R/spdep/spdep_0.2-24.tar.gz
> > >
> > > should that be of any use, the issue is present in both R-2.0.1 and
> > > R-devel (2004-11-16), SparseM is 0.52.
> > >
> > > I hope that I'm missing something fairly obvious.
> > >
> > > Roger
> > >
> > > -- 
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School 
> > > of
> > > Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
> > > e-mail: Roger.Bivand@nhh.no
> > >
> > >
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
e-mail: Roger.Bivand@nhh.no

From murdoch at stats.uwo.ca  Fri Nov 19 22:22:02 2004
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Fri Nov 19 22:22:12 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
Message-ID: <20041119212202.83F221043D@slim.kubism.ku.dk>

On Thu, 18 Nov 2004 16:36:03 +0100 (CET), murdoch@stats.uwo.ca wrote :

>>The reason that the processing is different according to whether one
>>uses .Rbuildignore or not is that 
>>  R CMD build 
>>takes the .Rbuildignore file into account but 
>>  R CMD install
>>  R CMD check
>>  R CMD build --binary 
>>do not take .Rbuildignore into account.  
>
>Okay, now I understand.  I think I'd call the last of those a bug, and
>it would seem to me that the install and check scripts should also
>respect this directive.   I've now copied this to the r-bugs list.
>(This was reported for Windows; I don't know if it applies to other
>platforms as well.)

I've taken a look at the source now, and it appears that the intention
is that R CMD check should respect the .Rbuildignore file, but (on my
system) it's looking for it in the wrong place:  it looks in the
parent of the package directory, not in the main package directory.
That is, if I have a package in subdirectory test, then 

Rcmd build test

looks for test/.Rbuildignore as it should, but 

Rcmd check test

looks for .Rbuildignore.  The problem is in these lines of code:

    my $exclude_file = ".Rbuildignore";
    ## This is a bit tricky for bundles where the build ignore pattern
    ## file is in the top-level bundle dir.
    $exclude_file = &file_path(dirname($pkgdir), $exclude_file);

In my test, $pkgdir was "d:/stuff/R/test", and $exclude_file ended up
as "d:/stuff/R/.Rbuildignore".

Could someone on Unix confirm this behaviour?  I think the fix should
be to change the last line to 

    $exclude_file = &file_path($pkgdir, $exclude_file);

but I don't want to mess things up on other platforms.

Even with this change, Rcmd check is still going to install the files
it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
.Rbuildignore support there.

Duncan Murdoch

From ggrothendieck at myway.com  Sat Nov 20 01:39:17 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov 20 01:39:31 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
Message-ID: <loom.20041120T012822-611@post.gmane.org>

 <murdoch <at> stats.uwo.ca> writes:

: 
: On Thu, 18 Nov 2004 16:36:03 +0100 (CET), murdoch <at> stats.uwo.ca wrote :
: 
: >>The reason that the processing is different according to whether one
: >>uses .Rbuildignore or not is that 
: >>  R CMD build 
: >>takes the .Rbuildignore file into account but 
: >>  R CMD install
: >>  R CMD check
: >>  R CMD build --binary 
: >>do not take .Rbuildignore into account.  
: >
: >Okay, now I understand.  I think I'd call the last of those a bug, and
: >it would seem to me that the install and check scripts should also
: >respect this directive.   I've now copied this to the r-bugs list.
: >(This was reported for Windows; I don't know if it applies to other
: >platforms as well.)
: 
: I've taken a look at the source now, and it appears that the intention
: is that R CMD check should respect the .Rbuildignore file, but (on my
: system) it's looking for it in the wrong place:  it looks in the
: parent of the package directory, not in the main package directory.
: That is, if I have a package in subdirectory test, then 
: 
: Rcmd build test
: 
: looks for test/.Rbuildignore as it should, but 
: 
: Rcmd check test
: 
: looks for .Rbuildignore.  The problem is in these lines of code:
: 
:     my $exclude_file = ".Rbuildignore";
:     ## This is a bit tricky for bundles where the build ignore pattern
:     ## file is in the top-level bundle dir.
:     $exclude_file = &file_path(dirname($pkgdir), $exclude_file);
: 
: In my test, $pkgdir was "d:/stuff/R/test", and $exclude_file ended up
: as "d:/stuff/R/.Rbuildignore".
: 
: Could someone on Unix confirm this behaviour?  I think the fix should
: be to change the last line to 
: 
:     $exclude_file = &file_path($pkgdir, $exclude_file);
: 
: but I don't want to mess things up on other platforms.
: 
: Even with this change, Rcmd check is still going to install the files
: it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
: .Rbuildignore support there.
: 

If the behaviour is suddenly changed then this is going to cause work
for people whose scripts depend on the current behavior.  In order to
minimize disruption I would ask that such change only be made at the
same time that a flag for turning on and off .Rbuildignore processing
is implemented on build, check, install and build --binary.  Even
with such a flag it may require revision to scripts but at least
any change with the flag will be minimal.  Even better, it may
mean some scripts can be eliminated.

From ggrothendieck at myway.com  Sat Nov 20 04:01:49 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov 20 04:02:18 2004
Subject: [Rd] Creating vignette pdf on Windows
Message-ID: <loom.20041120T035849-510@post.gmane.org>


On page 11 of the Extensions manual it says that "R CMD build will
automatically create PDF versions of the vignettes for distribution"
however, I have not been successful on Windows 2.0.1 beta.

I tried creating a simple package by entering the code in
the ?package.skeleton example then adding the Rnw file from
the utils package to AnExample\inst\doc but when I ran 
  R CMD build 
it did not seem to create a tex or pdf file.  What am I
doing wrong?


... In R
R>          f <- function(x,y) x+y
R>          g <- function(x,y) x-y
R>          d <- data.frame(a=1,b=2)
R>          e <- rnorm(1000)
R>          package.skeleton(list=c("f","g","d","e"), name="AnExample")
Creating directories ...
Creating DESCRIPTION ...
Creating READMEs ...
Saving functions and data ...
Making help files ...
Done.
Further steps are described in ./AnExample/README 


At command line:

C:\>cd \Program Files\R\rw2001beta

C:\Program Files\R\rw2001beta>md AnExample\inst\doc

C:\Program Files\R\rw2001beta>copy library\utils\Sweave\*.Rnw 
AnExample\inst\doc
library\utils\Sweave\Sweave-test-1.Rnw
        1 file(s) copied.

C:\Program Files\R\rw2001beta>bin\R CMD build AnExample
* checking for file 'AnExample/DESCRIPTION' ... OK
* preparing 'AnExample':
* cleaning src
* creating vignettes ... OK
* removing junk files
* building 'AnExample_1.0.tar.gz'
C:\Program Files\R\rw2001beta>tar tzf AnExample_1.0.tar.gz
AnExample/
AnExample/data/
AnExample/data/d.rda
AnExample/data/e.rda
AnExample/DESCRIPTION
AnExample/inst/
AnExample/inst/doc/
AnExample/inst/doc/Rplots.ps
AnExample/inst/doc/Sweave-test-1.Rnw
AnExample/man/
AnExample/man/d.Rd
AnExample/man/e.Rd
AnExample/man/f.Rd
AnExample/man/g.Rd
AnExample/man/README
AnExample/R/
AnExample/R/f.R
AnExample/R/g.R
AnExample/README
AnExample/src/
AnExample/src/README

From murdoch at stats.uwo.ca  Sat Nov 20 04:26:04 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat Nov 20 04:25:34 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
In-Reply-To: <loom.20041120T012822-611@post.gmane.org>
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
Message-ID: <dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>



On Sat, 20 Nov 2004 00:39:17 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote:

>: Even with this change, Rcmd check is still going to install the files
>: it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
>: .Rbuildignore support there.
>: 
>
>If the behaviour is suddenly changed then this is going to cause work
>for people whose scripts depend on the current behavior. 

Yes, that's normal.   If you work around a bug and the bug gets fixed,
then you will need to change your code.  That's why the NEWS file
reports bug fixes and other changes.

> In order to
>minimize disruption I would ask that such change only be made at the
>same time that a flag for turning on and off .Rbuildignore processing
>is implemented on build, check, install and build --binary.  

There's a simple workaround to turn .Rbuildignore processing off: just
rename the file.  Adding a switch is *not* a prerequisite for the
other changes.

>Even
>with such a flag it may require revision to scripts but at least
>any change with the flag will be minimal.  Even better, it may
>mean some scripts can be eliminated.

There are 3 changes that I would contemplate:

1.  Fix the bug that means "R CMD check" looks in the wrong place for
.Rbuildignore.

2.  Make "R CMD build --binary" consistent with "R CMD build" in its
handling of .Rbuildignore.

3.  Make "R CMD install" and "R CMD check" consistent with "R CMD
build" in their handling of .Rbuildignore.

Number 1 should definitely be fixed in the patches to 2.0.1.  I have a
feeling that both 2 and 3 should be done (and 2 would be an automatic
consequence of 3 unless we took action to stop it), but I'd put them
in 2.1.0, not 2.0.x.

Martin and you have also suggested 

4.  Add another flag to Rcmd build (and install and check?), to turn
.Rbuildignore processing on and off, for increased flexiblity or for
backward compatiblity.

My own feeling is that this doesn't increase flexibility enough, and
I'd like a better solution, but we've got lots of time before 2.1.0 is
released to discuss this.

Duncan Murdoch

From ggrothendieck at myway.com  Sat Nov 20 04:47:50 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov 20 04:48:04 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
	<dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>
Message-ID: <loom.20041120T043535-913@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

> 
> On Sat, 20 Nov 2004 00:39:17 +0000 (UTC), Gabor Grothendieck
> <ggrothendieck <at> myway.com> wrote:
> 
> >: Even with this change, Rcmd check is still going to install the files
> >: it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
> >: .Rbuildignore support there.
> >: 
> >
> >If the behaviour is suddenly changed then this is going to cause work
> >for people whose scripts depend on the current behavior. 
> 
> Yes, that's normal.   If you work around a bug and the bug gets fixed,
> then you will need to change your code.  That's why the NEWS file
> reports bug fixes and other changes.
> 
> > In order to
> >minimize disruption I would ask that such change only be made at the
> >same time that a flag for turning on and off .Rbuildignore processing
> >is implemented on build, check, install and build --binary.  
> 
> There's a simple workaround to turn .Rbuildignore processing off: just
> rename the file.  Adding a switch is *not* a prerequisite for the
> other changes.
> 
> >Even
> >with such a flag it may require revision to scripts but at least
> >any change with the flag will be minimal.  Even better, it may
> >mean some scripts can be eliminated.
> 
> There are 3 changes that I would contemplate:
> 
> 1.  Fix the bug that means "R CMD check" looks in the wrong place for
> .Rbuildignore.
> 
> 2.  Make "R CMD build --binary" consistent with "R CMD build" in its
> handling of .Rbuildignore.
> 
> 3.  Make "R CMD install" and "R CMD check" consistent with "R CMD
> build" in their handling of .Rbuildignore.
> 
> Number 1 should definitely be fixed in the patches to 2.0.1.  I have a
> feeling that both 2 and 3 should be done (and 2 would be an automatic
> consequence of 3 unless we took action to stop it), but I'd put them
> in 2.1.0, not 2.0.x.
> 
> Martin and you have also suggested 
> 
> 4.  Add another flag to Rcmd build (and install and check?), to turn
> .Rbuildignore processing on and off, for increased flexiblity or for
> backward compatiblity.
> 
> My own feeling is that this doesn't increase flexibility enough, and
> I'd like a better solution, but we've got lots of time before 2.1.0 is
> released to discuss this.

I did not know it was a bug and even you did not realize it until you
looked at the code.

I do have one suggestion that might be trivial for you yet be beneficial
for everyone else, as an interim step, until a better solution comes about.

After fixing the scripts, could you leave the old scripts in bin 
with new names, e.g. oldbuild, oldcheck, etc. so that one can issue
the command:

   R CMD oldbuild ...

and get the old behavior.  That provides a simple way to get either
behavior while waiting for the ultimate solution and does not interfere
with the new scripts in any way.

From murdoch at stats.uwo.ca  Sat Nov 20 05:19:10 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat Nov 20 05:18:46 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
In-Reply-To: <loom.20041120T043535-913@post.gmane.org>
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
	<dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>
	<loom.20041120T043535-913@post.gmane.org>
Message-ID: <tngtp0pqoek5891k4aq6m160jfj9i0dkb0@4ax.com>

On Sat, 20 Nov 2004 03:47:50 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote:

>Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:
>
>> 
>> On Sat, 20 Nov 2004 00:39:17 +0000 (UTC), Gabor Grothendieck
>> <ggrothendieck <at> myway.com> wrote:
>> 
>> >: Even with this change, Rcmd check is still going to install the files
>> >: it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
>> >: .Rbuildignore support there.
>> >: 
>> >
>> >If the behaviour is suddenly changed then this is going to cause work
>> >for people whose scripts depend on the current behavior. 
>> 
>> Yes, that's normal.   If you work around a bug and the bug gets fixed,
>> then you will need to change your code.  That's why the NEWS file
>> reports bug fixes and other changes.
>> 
>> > In order to
>> >minimize disruption I would ask that such change only be made at the
>> >same time that a flag for turning on and off .Rbuildignore processing
>> >is implemented on build, check, install and build --binary.  
>> 
>> There's a simple workaround to turn .Rbuildignore processing off: just
>> rename the file.  Adding a switch is *not* a prerequisite for the
>> other changes.
>> 
>> >Even
>> >with such a flag it may require revision to scripts but at least
>> >any change with the flag will be minimal.  Even better, it may
>> >mean some scripts can be eliminated.
>> 
>> There are 3 changes that I would contemplate:
>> 
>> 1.  Fix the bug that means "R CMD check" looks in the wrong place for
>> .Rbuildignore.
>> 
>> 2.  Make "R CMD build --binary" consistent with "R CMD build" in its
>> handling of .Rbuildignore.
>> 
>> 3.  Make "R CMD install" and "R CMD check" consistent with "R CMD
>> build" in their handling of .Rbuildignore.
>> 
>> Number 1 should definitely be fixed in the patches to 2.0.1.  I have a
>> feeling that both 2 and 3 should be done (and 2 would be an automatic
>> consequence of 3 unless we took action to stop it), but I'd put them
>> in 2.1.0, not 2.0.x.
>> 
>> Martin and you have also suggested 
>> 
>> 4.  Add another flag to Rcmd build (and install and check?), to turn
>> .Rbuildignore processing on and off, for increased flexiblity or for
>> backward compatiblity.
>> 
>> My own feeling is that this doesn't increase flexibility enough, and
>> I'd like a better solution, but we've got lots of time before 2.1.0 is
>> released to discuss this.
>
>I did not know it was a bug and even you did not realize it until you
>looked at the code.
>
>I do have one suggestion that might be trivial for you yet be beneficial
>for everyone else, as an interim step, until a better solution comes about.
>
>After fixing the scripts, could you leave the old scripts in bin 
>with new names, e.g. oldbuild, oldcheck, etc. so that one can issue
>the command:
>
>   R CMD oldbuild ...
>
>and get the old behavior.  That provides a simple way to get either
>behavior while waiting for the ultimate solution and does not interfere
>with the new scripts in any way.

I think you misunderstand the consequences of fixing the bug.  If I
fix #1, it should not break any scripts.  It will just stop "Rcmd
check" from giving a few false alarms about files that you didn't want
to distribute anyways.  Those files will still be installed in the
temporary directory for the checks to run.  

It is only changes #2 and #3 that would potentially break scripts,
which is why I'd save them for 2.1.0.

As to the suggestion of leaving both versions of the scripts in place:
no, I wouldn't do that.  There's nothing to stop you from copying the
script from your old version to the new one (or editing the new one to
do something completely different, for that matter).  But if I were to
add three new scripts to the collection, I'd have to document them,
and people would have to maintain them.  All in all, a big waste of
our time to save a little bit of yours?  No thanks.

Duncan Murdoch

From ggrothendieck at myway.com  Sat Nov 20 06:22:21 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov 20 06:22:47 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
	<dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>
	<loom.20041120T043535-913@post.gmane.org>
	<tngtp0pqoek5891k4aq6m160jfj9i0dkb0@4ax.com>
Message-ID: <loom.20041120T055240-88@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

: 
: On Sat, 20 Nov 2004 03:47:50 +0000 (UTC), Gabor Grothendieck
: <ggrothendieck <at> myway.com> wrote:
: 
: >Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:
: >
: >> 
: >> On Sat, 20 Nov 2004 00:39:17 +0000 (UTC), Gabor Grothendieck
: >> <ggrothendieck <at> myway.com> wrote:
: >> 
: >> >: Even with this change, Rcmd check is still going to install the files
: >> >: it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
: >> >: .Rbuildignore support there.
: >> >: 
: >> >
: >> >If the behaviour is suddenly changed then this is going to cause work
: >> >for people whose scripts depend on the current behavior. 
: >> 
: >> Yes, that's normal.   If you work around a bug and the bug gets fixed,
: >> then you will need to change your code.  That's why the NEWS file
: >> reports bug fixes and other changes.
: >> 
: >> > In order to
: >> >minimize disruption I would ask that such change only be made at the
: >> >same time that a flag for turning on and off .Rbuildignore processing
: >> >is implemented on build, check, install and build --binary.  
: >> 
: >> There's a simple workaround to turn .Rbuildignore processing off: just
: >> rename the file.  Adding a switch is *not* a prerequisite for the
: >> other changes.
: >> 
: >> >Even
: >> >with such a flag it may require revision to scripts but at least
: >> >any change with the flag will be minimal.  Even better, it may
: >> >mean some scripts can be eliminated.
: >> 
: >> There are 3 changes that I would contemplate:
: >> 
: >> 1.  Fix the bug that means "R CMD check" looks in the wrong place for
: >> .Rbuildignore.
: >> 
: >> 2.  Make "R CMD build --binary" consistent with "R CMD build" in its
: >> handling of .Rbuildignore.
: >> 
: >> 3.  Make "R CMD install" and "R CMD check" consistent with "R CMD
: >> build" in their handling of .Rbuildignore.
: >> 
: >> Number 1 should definitely be fixed in the patches to 2.0.1.  I have a
: >> feeling that both 2 and 3 should be done (and 2 would be an automatic
: >> consequence of 3 unless we took action to stop it), but I'd put them
: >> in 2.1.0, not 2.0.x.
: >> 
: >> Martin and you have also suggested 
: >> 
: >> 4.  Add another flag to Rcmd build (and install and check?), to turn
: >> .Rbuildignore processing on and off, for increased flexiblity or for
: >> backward compatiblity.
: >> 
: >> My own feeling is that this doesn't increase flexibility enough, and
: >> I'd like a better solution, but we've got lots of time before 2.1.0 is
: >> released to discuss this.
: >
: >I did not know it was a bug and even you did not realize it until you
: >looked at the code.
: >
: >I do have one suggestion that might be trivial for you yet be beneficial
: >for everyone else, as an interim step, until a better solution comes about.
: >
: >After fixing the scripts, could you leave the old scripts in bin 
: >with new names, e.g. oldbuild, oldcheck, etc. so that one can issue
: >the command:
: >
: >   R CMD oldbuild ...
: >
: >and get the old behavior.  That provides a simple way to get either
: >behavior while waiting for the ultimate solution and does not interfere
: >with the new scripts in any way.
: 
: I think you misunderstand the consequences of fixing the bug.  If I
: fix #1, it should not break any scripts.  It will just stop "Rcmd
: check" from giving a few false alarms about files that you didn't want
: to distribute anyways.  Those files will still be installed in the
: temporary directory for the checks to run.  

Perhaps I used the wrong words.  I do checks with and without 
.Rbuildignore processing so having both facilities is convenient.

: 
: It is only changes #2 and #3 that would potentially break scripts,
: which is why I'd save them for 2.1.0. 

I agree that that two stage approach would reduce the extent of the 
problem of change in behavior.

: 
: As to the suggestion of leaving both versions of the scripts in place:
: no, I wouldn't do that.  There's nothing to stop you from copying the
: script from your old version to the new one (or editing the new one to
: do something completely different, for that matter).  But if I were to
: add three new scripts to the collection, I'd have to document them,
: and people would have to maintain them.  All in all, a big waste of
: our time to save a little bit of yours?  No thanks.

You don't need to document deprecated code.  Its just there for the
convenience of the user base that has invested in it.

From ligges at statistik.uni-dortmund.de  Sat Nov 20 19:08:05 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Nov 20 19:07:36 2004
Subject: [Rd] whishlist: legend - changing color of the boxes-border
In-Reply-To: <200411082107150807.11DBEB31@mail.math.fu-berlin.de>
References: <200411082107150807.11DBEB31@mail.math.fu-berlin.de>
Message-ID: <419F8805.3090803@statistik.uni-dortmund.de>

Wolski wrote:

> Hi,
> 
> Drawing a legend I would like to be able to specify the color of boxes which are drawn if fill or density is specified.
> eg.
> legend(0,40000,c("raw","LR/PR-TPS"),fill=c(1,2),col=c(1,2),density=c(20,20),angle=c(-20,45),bty="n")
> 
> Currently the color of the boxes -- border is always black and can *not* be changed. To get this option only a *minimal* change is required.
> Please consider the following code snipped copied from the function legend (package graphics).
> 
> The sensible line is marked by ###<-
> 
>  if (mfill) {
>         if (plot) {
>             fill <- rep(fill, length.out = n.leg)
>             rect2(left = xt, top = yt + ybox/2, dx = xbox, dy = ybox, 
>                 col = fill, density = density, angle = angle, 
>                 border = "black")                                                          ####<--
>         }
>         xt <- xt + dx.fill
>     }
> 
> Changing this line from 
> 
> border="black"
> to 
> 
> border=col.
> 
> Will enable to specify the color of the boxes borders.
> 
> If specifying the colors by param _fill_ the parameter _col_ is not used anyway but still available and set already to black in the parameter declaration. Therefore why not use it to specify colors to borders of boxes?
> 

No! You want to specify "col" rather than "fill" in the following example:

   plot(1:10)
   legend(3,3, c("Hello", "World"), pch=1:2, fill=c("red", "black"))


But what you can easily do to change the box color is:

   plot(1:10)
   opar <- par(fg="blue")
   legend(3, 3, "Hello World", pch=20, col="red", text.col="green")
   par(opar)


Uwe Ligges





> Yours
> /E
> 
> 
> 
> 
> 
> Dipl. bio-chem. Eryk Witold Wolski             @    MPI-Moleculare Genetic   
> Ihnestrasse 63-73 14195 Berlin                'v'                            
> tel: 0049-30-83875219                        /   \                           
> mail: witek96@users.sourceforge.net        ---W-W----                        
> http://r4proteomics.sourceforg.net
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From pburns at pburns.seanet.com  Sat Nov 20 21:55:49 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sat Nov 20 21:56:31 2004
Subject: [Rd] sum and partial argument name matching
Message-ID: <419FAF55.4000906@pburns.seanet.com>

"sum" (and  perhaps  other functions?) allows partial argument
name matching after its three-dots argument:

 > sum(1:4, NA, n=78, na.rm=FALSE)
[1] 10
 > sum(1:4, NA, n=78, na.rm=TRUE)
[1] 11

I can see there could be a discussion about whether or not this is
a bug, but I think all will agree that it's a might peculiar.

This is done in 2.0.1 but the same behavior is in 1.8.1.

 > version
         _             
platform i386-pc-mingw32
arch     i386          
os       mingw32       
system   i386, mingw32 
status                 
major    2             
minor    0.1           
year     2004          
month    11            
day      15            
language R  



Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

From Roger.Bivand at nhh.no  Sat Nov 20 22:11:23 2004
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat Nov 20 22:11:38 2004
Subject: [Rd] Re: Method dispatch S3/S4 through optimize()
In-Reply-To: <Pine.LNX.4.44.0411191335550.17908-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0411202202090.20502-100000@reclus.nhh.no>

After looking at this with Roger Koenker off-list, the problem can be 
replicated running R CMD check tryout on:

http://reclus.nhh.no/R/Devel/tryout_0.1-1.tar.gz

With a NAMESPACE file in tryout, the S4 dispatch breaks down for det(), 
without a NAMESPACE file, it runs without error (on R-devel with SparseM 
0.52 for me). Roger pointed me to 

http://tolstoy.newcastle.edu.au/R/devel/04a/0042.html

which looks similar, but was said to be resolved. A practical but too 
invasive correction is to change the SparseM code to:

setGeneric("Det", function(x, ...) standardGeneric("Det"))
setMethod("Det","matrix",get("det", pos=NULL, mode= "function"))
setMethod("Det","matrix.csr", function(x, ...) Det(chol(x))^2)
setMethod("Det","matrix.csr.chol", function(x, ...) x@det)

rather than original below, the alternative is to drop NAMESPACE in 
spdep, which is not desirable either. 

Roger


On Fri, 19 Nov 2004, Roger Bivand wrote:

> On Thu, 18 Nov 2004, roger koenker wrote:
> 
> > I am far from an expert on S4 method dispatch, so at the risk of
> > embarrassing myself I will just indicate how the det() function is
> > written in SparseM now in the hope that someone else will see the source
> > of the problem:
> > 
> > setGeneric("det")
> > setMethod("det","matrix",get("det", pos=NULL, mode= "function"))
> > setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
> > setMethod("det","matrix.csr.chol", function(x, ...) x@det)
> > 
> > The Cholesky function chol in SparseM was recently extended slightly to
> > compute this determinant as an additional component, so if the argument
> > is already of the matrix.csr.chol class det() just extracts this
> > component, otherwise it tries to do the cholesky, or defaults to the
> > base function.
> 
> As I read the SparseM code, it is following the specification, and if
> there was something wrong, the simple example 1) would not have worked
> either. But it does, so something changes in the context of where a
> function like det() and chol() is called from, here through optimize(),
> that sends it to the wrong place based on assuming that the class is 
> unknown. 
> 
> I'll try to make an example that doesn't depend on spdep, just on SparseM 
> and optimize().
> 
> This is frustrating, because with Ord's trick of using matrices similar to
> symmetric, the SparseM route will be very useful for most situations, 
> even though it requires strictly symmetric matrices. So your provision of 
> det() for "matrix.csr" is very useful, once we sort out this strange 
> behaviour.
> 
> Roger
> 
> > 
> > I hope that this might expose some fly in the soup.
> > 
> > 
> > url:	www.econ.uiuc.edu/~roger        	Roger Koenker
> > email	rkoenker@uiuc.edu			Department of Economics
> > vox: 	217-333-4558				University of Illinois
> > fax:   	217-244-6678				Champaign, IL 61820
> > 
> > On Nov 18, 2004, at 3:34 PM, Roger Bivand wrote:
> > 
> > > I have been running into difficulties with dispatching on an S4 class
> > > defined in the SparseM package, when the method calls are inside a
> > > function passed as the f= argument to optimize() in functions in the 
> > > spdep
> > > package. The S4 methods are typically defined as:
> > >
> > > setMethod("det","matrix.csr", function(x, ...) det(chol(x))^2)
> > >
> > > that is within setMethod() rather than by name before the setMethod().
> > >
> > > When called from within functions passed as the f= argument to 
> > > optimize,
> > > the S3 generics for det() and chol() get picked up, not the S4 generics
> > > for the S4 SparseM classes. This looks for instance like (from
> > > example(boston)):
> > >
> > >> gp2 <- lagsarlm(log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + 
> > >> I(RM^2)
> > > +  +  AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + log(LSTAT),
> > > +  data=boston.c, nb2listw(boston.soi), method="SparseM")
> > > matrix.csr
> > > Error in chol(tmp1) : non-numeric argument to chol
> > >
> > > (this is the error message in chol.R in base). tmp1 is of class
> > > "matrix.csr", but is being sent to the S3 class (error in function
> > > sar.lag.mix.f.sM() in R/lag.spsarlm.R).
> > >
> > > sar.lag.mix.f.sM <- function(rho, W, e.a, e.b, e.c, n, quiet)
> > > {
> > > 	SSE <- e.a - 2*rho*e.b + rho*rho*e.c
> > > 	s2 <- SSE/n
> > > 	tmp1 <- asMatrixCsrIrW(W, rho)
> > > cat(class(tmp1), "\n")
> > > 	tmp2 <- chol(tmp1)
> > > #	tmp2 <- .cholMatrixCsr(tmp1)
> > > cat(class(tmp2), "\n")
> > > 	tmp3 <- (tmp2@det)^2
> > > cat(tmp3, "\n")
> > > 	ret <- (log(tmp3)
> > > 		- ((n/2)*log(2*pi)) - (n/2)*log(s2) - (1/(2*s2))*SSE)
> > > 	if (!quiet)
> > > 	    cat("(SparseM) rho:\t", rho, "\tfunction value:\t", ret, "\n")
> > > 	ret
> > > }
> > >
> > >
> > > Three further observations:
> > >
> > > 1) In a simpler case:
> > >
> > >> library(spdep)
> > > Loading required package: tripack
> > > Loading required package: maptools
> > > Loading required package: foreign
> > > Loading required package: SparseM
> > > [1] "SparseM library loaded"
> > >> example(similar.listw)
> > > ...
> > > smlr.l> log(det(asMatrixCsrIrW(asMatrixCsrListw(similar.listw(COL.W)), 
> > > 0.5)))
> > > [1] -1.627660
> > >
> > > just works, and the appropriate det() and chol() are found; det()
> > > dispatches on class "matrix.csr" and finds the right chol() for that
> > > class - this is the same code context as found in the function passed 
> > > to
> > > optimize();
> > >
> > > 2) When the R source file containing the lagsarlm() function, and the
> > > function sent as f= through optimize is sourced(), the appropriate 
> > > det()
> > > and chol() are found; and
> > >
> > > 3) When the SparseM R code is modified, and the function defined prior 
> > > to
> > > its setMethod (so visible as a function independently of setMethod) and
> > > called by name rather than as a method, everything works, as it should.
> > > But this isn't a solution, setMethod() defined methods should dispatch 
> > > on
> > > class irrespective of context, I think.
> > >
> > > SparseM does not have a namespace, spdep does, but I don't think this 
> > > is
> > > the issue. I'm pretty sure this isn't an issue with SparseM either,
> > > because of 1).
> > >
> > > I've put a copy of the problematic spdep on:
> > >
> > > http://reclus.nhh.no/R/spdep/spdep_0.2-24.tar.gz
> > >
> > > should that be of any use, the issue is present in both R-2.0.1 and
> > > R-devel (2004-11-16), SparseM is 0.52.
> > >
> > > I hope that I'm missing something fairly obvious.
> > >
> > > Roger
> > >
> > > -- 
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School 
> > > of
> > > Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
> > > e-mail: Roger.Bivand@nhh.no
> > >
> > >
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
e-mail: Roger.Bivand@nhh.no

From ripley at stats.ox.ac.uk  Sat Nov 20 22:27:34 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Nov 20 22:42:44 2004
Subject: [Rd] sum and partial argument name matching
In-Reply-To: <419FAF55.4000906@pburns.seanet.com>
References: <419FAF55.4000906@pburns.seanet.com>
Message-ID: <Pine.LNX.4.61.0411202120420.24592@gannet.stats>

On Sat, 20 Nov 2004, Patrick Burns wrote:

> "sum" (and  perhaps  other functions?) allows partial argument
> name matching after its three-dots argument:
>
>> sum(1:4, NA, n=78, na.rm=FALSE)
> [1] 10
>> sum(1:4, NA, n=78, na.rm=TRUE)
> [1] 11

That's not `partial argument name matching', for the exact match should 
always win.  do_summary contains

     ans = matchArg(R_NaRmSymbol, &args);

and that is defined as

/* Destructively Extract A Named List Element. */
/* Returns the first partially matching tag found. */
/* Pattern is a symbol. */

The rest of the summary set (mean, min, max, prod) and also do_logic3 
(all, any) call matchArg and so have the same problem.

> I can see there could be a discussion about whether or not this is
> a bug, but I think all will agree that it's a might peculiar.

I don't see how there can be discussion: it breaks the stated rules for 
argument matching.

> This is done in 2.0.1 but the same behavior is in 1.8.1.
>
>> version
>        _             platform i386-pc-mingw32
> arch     i386          os       mingw32       system   i386, mingw32 status 
> major    2             minor    0.1           year     2004          month 
> 11            day      15            language R 
>
>
> Patrick Burns
>
> Burns Statistics
> patrick@burns-stat.com
> +44 (0)20 8525 0696
> http://www.burns-stat.com
> (home of S Poetry and "A Guide for the Unwilling S User")
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From znmeb at cesmail.net  Sun Nov 21 20:54:54 2004
From: znmeb at cesmail.net (M. Edward Borasky)
Date: Sun Nov 21 20:55:12 2004
Subject: [Rd] TeXmacs and R 2.0.0
Message-ID: <1101066895.23405.46.camel@DreamGate>

I have encountered an issue with TeXmacs and R 2.0.0, and I've found a
somewhat unsatisfying workaround. My apologies if this is old news to
the R-Devel list.

TeXmacs has the ability to start up an R session and copy the session
input and output into a working document. The way it does this involves
starting R and executing

> library(TeXmacs,lib.loc="/usr/share/TeXmacs/plugins/r/r/")

in the R session. The library was built with R 1.7.1, and hence will not
work with R 2.0.0 or later.

The workaround is (as "root"):

1. Edit

   /usr/share/TeXmacs/plugins/r/r/TeXmacs/DESCRIPTION

and remove the line at the bottom that starts with "Built:"

2. Type

   R CMD build --force TeXmacs

3. Type

   R CMD INSTALL -l `pwd` TeXmacs_0.1.tar.gz

My question is this: do I actually need to do the INSTALL, or is the
build, followed by deleting the built package, enough? I've passed what
I know so far on to the TeXmacs team; eventually they will incorporate
some cleaner fix into their code, but I have no idea exactly how that
will work, since they need to be able to work with older versions of R
as well.

From ripley at stats.ox.ac.uk  Sun Nov 21 22:36:56 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Nov 21 22:37:10 2004
Subject: [Rd] TeXmacs and R 2.0.0
In-Reply-To: <1101066895.23405.46.camel@DreamGate>
References: <1101066895.23405.46.camel@DreamGate>
Message-ID: <Pine.LNX.4.61.0411212116340.1664@gannet.stats>

We don't know what `TeXmacs' is, but this looks like an R package.
I suspect more accurately you are talking about the R plug-in for
TeXmacs, at

http://www.texmacs.org/tmweb/plugins/statistics.en.html#r

Now, it seems that the TeXmacs team have not read `Writing R Extensions', 
for their *source* distribution contains a *binary* distribution of an 
installed R package with DESCRIPTION file containing

Built: R 1.7.1; i686-pc-linux-gnu; 2003-09-24 17:40:45

They need to ensure that they distribute the package sources.  You ought 
to be able to recreate them from what is there.

On Sun, 21 Nov 2004, M. Edward Borasky wrote:

> I have encountered an issue with TeXmacs and R 2.0.0, and I've found a
> somewhat unsatisfying workaround. My apologies if this is old news to
> the R-Devel list.
>
> TeXmacs has the ability to start up an R session and copy the session
> input and output into a working document. The way it does this involves
> starting R and executing
>
>> library(TeXmacs,lib.loc="/usr/share/TeXmacs/plugins/r/r/")
>
> in the R session. The library was built with R 1.7.1, and hence will not
> work with R 2.0.0 or later.

It also will not work on any other platform than i686-linux.

> The workaround is (as "root"):
>
> 1. Edit
>
>   /usr/share/TeXmacs/plugins/r/r/TeXmacs/DESCRIPTION
>
> and remove the line at the bottom that starts with "Built:"
>
> 2. Type
>
>   R CMD build --force TeXmacs
>
> 3. Type
>
>   R CMD INSTALL -l `pwd` TeXmacs_0.1.tar.gz

Given that there are no suitably named files in the R directory, I don't 
think that will work correctly.

> My question is this: do I actually need to do the INSTALL, or is the
> build, followed by deleting the built package, enough? I've passed what
> I know so far on to the TeXmacs team; eventually they will incorporate
> some cleaner fix into their code, but I have no idea exactly how that
> will work, since they need to be able to work with older versions of R
> as well.

If it is distributed as a source package, it should work on all recent 
versions of R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Sun Nov 21 22:39:02 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Nov 21 22:41:08 2004
Subject: [Rd] TeXmacs and R 2.0.0
In-Reply-To: <1101066895.23405.46.camel@DreamGate>
References: <1101066895.23405.46.camel@DreamGate>
Message-ID: <x2653yq3ux.fsf@biostat.ku.dk>

"M. Edward Borasky" <znmeb@cesmail.net> writes:

> I have encountered an issue with TeXmacs and R 2.0.0, and I've found a
> somewhat unsatisfying workaround. My apologies if this is old news to
> the R-Devel list.

Funny you should chime in right now. I was just thinking of TeXmacs in
connection with ODS and the SAS/R discussion over on R-help.
 
> TeXmacs has the ability to start up an R session and copy the session
> input and output into a working document. The way it does this involves
> starting R and executing
> 
> > library(TeXmacs,lib.loc="/usr/share/TeXmacs/plugins/r/r/")
> 
> in the R session. The library was built with R 1.7.1, and hence will not
> work with R 2.0.0 or later.

<pedantic>
  That's a 
    <strong>
         PACKAGE
    </strong>
  !!
</pedantic>

This is of course the Wrong Way. The Right Way (or one of them) is to
provide a source package that can be installed using R CMD INSTALL on
whatever system the user has, and fixed up to meet the changing
requirements of the R installer (which are usually backwards
compatible). Even better, maintain said package at CRAN so that it
will be automatically checked against the current patch and
development versions and get built for devtool-challenged operating
systems.

> 
> The workaround is (as "root"):
> 
> 1. Edit
> 
>    /usr/share/TeXmacs/plugins/r/r/TeXmacs/DESCRIPTION
> 
> and remove the line at the bottom that starts with "Built:"
> 
> 2. Type
> 
>    R CMD build --force TeXmacs
> 
> 3. Type
> 
>    R CMD INSTALL -l `pwd` TeXmacs_0.1.tar.gz
> 
> My question is this: do I actually need to do the INSTALL, or is the
> build, followed by deleting the built package, enough? I've passed what
> I know so far on to the TeXmacs team; eventually they will incorporate
> some cleaner fix into their code, but I have no idea exactly how that
> will work, since they need to be able to work with older versions of R
> as well.

Yup, you'll need the INSTALL. The 'R CMD build' just creates a source
package based on the source directory, which you effectively
reverse-engineered out of the (in principle) binary install. But why
not '-l /usr/share/TeXmacs/plugins/r/r/'?

BTW, last I checked, the TeXmacs plugin did have a rather peculiar
habit of opening one R session and using that for all subsequent
access, no matter where they occurred in the text. This can have some
peculiar effects with a stateful system like R (using a variable
before it was calculated, redoing a calculation but not code that
depends on it further along in the text, etc.). Is this still so? A
more Sweave-like approach would be highly desirable.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From znmeb at cesmail.net  Mon Nov 22 00:02:36 2004
From: znmeb at cesmail.net (M. Edward Borasky)
Date: Mon Nov 22 00:02:56 2004
Subject: [Rd] TeXmacs and R 2.0.0
In-Reply-To: <x2653yq3ux.fsf@biostat.ku.dk>
References: <1101066895.23405.46.camel@DreamGate>
	<x2653yq3ux.fsf@biostat.ku.dk>
Message-ID: <1101078157.22751.14.camel@DreamGate>

On Sun, 2004-11-21 at 22:39 +0100, Peter Dalgaard wrote:


> <pedantic>
>   That's a 
>     <strong>
>          PACKAGE
>     </strong>
>   !!
> </pedantic>
> 
> This is of course the Wrong Way. The Right Way (or one of them) is to
> provide a source package that can be installed using R CMD INSTALL on
> whatever system the user has, and fixed up to meet the changing
> requirements of the R installer (which are usually backwards
> compatible). Even better, maintain said package at CRAN so that it
> will be automatically checked against the current patch and
> development versions and get built for devtool-challenged operating
> systems.

In fact, I suggested to the TeXmacs team that they do just that: build a
source package and submit it to CRAN. I've clearly labelled what I did
as a workaround every place I've posted about it -- R-devel, the TeXmacs
list and the "Gentoo Science" list. 

I'm the messenger here, not a developer with any formal status either
with Gentoo, R or TeXmacs. And I wasn't willing to drop back to R 1.9.1
to get R sessions in a TeXmacs document. It turned out some anonymous
user had run into this before me and filed a bug on the TeXmacs bug
list, which saved me the trouble of doing so.

There is still the issue of sequencing between installs of R and
TeXmacs. When TeXmacs does its "configure", if it doesn't find R, it has
to inform the user somehow that if R is installed later, the user will
need to find the package and install it. It can't install the package
without R. Nor, of course, can a TeXmacs user start an R session inside
TeXmacs without R. :)


> 
> > 
> > The workaround is (as "root"):
> > 
> > 1. Edit
> > 
> >    /usr/share/TeXmacs/plugins/r/r/TeXmacs/DESCRIPTION
> > 
> > and remove the line at the bottom that starts with "Built:"
> > 
> > 2. Type
> > 
> >    R CMD build --force TeXmacs
> > 
> > 3. Type
> > 
> >    R CMD INSTALL -l `pwd` TeXmacs_0.1.tar.gz
> > 
> > My question is this: do I actually need to do the INSTALL, or is the
> > build, followed by deleting the built package, enough? I've passed what
> > I know so far on to the TeXmacs team; eventually they will incorporate
> > some cleaner fix into their code, but I have no idea exactly how that
> > will work, since they need to be able to work with older versions of R
> > as well.
> 
> Yup, you'll need the INSTALL. The 'R CMD build' just creates a source
> package based on the source directory, which you effectively
> reverse-engineered out of the (in principle) binary install. But why
> not '-l /usr/share/TeXmacs/plugins/r/r/'?
> 
> BTW, last I checked, the TeXmacs plugin did have a rather peculiar
> habit of opening one R session and using that for all subsequent
> access, no matter where they occurred in the text. This can have some
> peculiar effects with a stateful system like R (using a variable
> before it was calculated, redoing a calculation but not code that
> depends on it further along in the text, etc.). Is this still so? A
> more Sweave-like approach would be highly desirable.
>

From p.dalgaard at biostat.ku.dk  Mon Nov 22 00:32:09 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Nov 22 00:34:12 2004
Subject: [Rd] TeXmacs and R 2.0.0
In-Reply-To: <1101078157.22751.14.camel@DreamGate>
References: <1101066895.23405.46.camel@DreamGate>
	<x2653yq3ux.fsf@biostat.ku.dk> <1101078157.22751.14.camel@DreamGate>
Message-ID: <x2wtweok1y.fsf@biostat.ku.dk>

"M. Edward Borasky" <znmeb@cesmail.net> writes:

> In fact, I suggested to the TeXmacs team that they do just that: build a
> source package and submit it to CRAN. I've clearly labelled what I did
> as a workaround every place I've posted about it -- R-devel, the TeXmacs
> list and the "Gentoo Science" list. 
> 
> I'm the messenger here, not a developer with any formal status either
> with Gentoo, R or TeXmacs. And I wasn't willing to drop back to R 1.9.1
> to get R sessions in a TeXmacs document. It turned out some anonymous
> user had run into this before me and filed a bug on the TeXmacs bug
> list, which saved me the trouble of doing so.

[I knew that. In fact I had seen your note in the TeXmacs archive when
I went looking for the status of the R plugin a bit earlier. I was
just stating it a little more than usually authoritarian in style,
since I thought you might want to pass it back to the TeXmacs
developers.]
 
> There is still the issue of sequencing between installs of R and
> TeXmacs. When TeXmacs does its "configure", if it doesn't find R, it has
> to inform the user somehow that if R is installed later, the user will
> need to find the package and install it. It can't install the package
> without R. Nor, of course, can a TeXmacs user start an R session inside
> TeXmacs without R. :)

If there's a source package (and R is setup to install them, which is
pretty much a given on Unix/Linux at least), then it's really not much
of a problem since TeXmacs can just run "R CMD INSTALL" once R is
present, and rerun it as R gets upgraded too.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Mon Nov 22 02:54:53 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 22 02:55:05 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
	<dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>
	<loom.20041120T043535-913@post.gmane.org>
	<tngtp0pqoek5891k4aq6m160jfj9i0dkb0@4ax.com>
	<loom.20041120T055240-88@post.gmane.org>
Message-ID: <loom.20041122T025237-324@post.gmane.org>

Gabor Grothendieck <ggrothendieck <at> myway.com> writes:

> 
> Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:
> 
> : 
> : On Sat, 20 Nov 2004 03:47:50 +0000 (UTC), Gabor Grothendieck
> : <ggrothendieck <at> myway.com> wrote:
> : 
> : >Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:
> : >
> : >> 
> : >> On Sat, 20 Nov 2004 00:39:17 +0000 (UTC), Gabor Grothendieck
> : >> <ggrothendieck <at> myway.com> wrote:
> : >> 
> : >> >: Even with this change, Rcmd check is still going to install the files
> : >> >: it's supposed to ignore, because it uses Rcmd INSTALL, and there's no
> : >> >: .Rbuildignore support there.
> : >> >: 
> : >> >
> : >> >If the behaviour is suddenly changed then this is going to cause work
> : >> >for people whose scripts depend on the current behavior. 
> : >> 
> : >> Yes, that's normal.   If you work around a bug and the bug gets fixed,
> : >> then you will need to change your code.  That's why the NEWS file
> : >> reports bug fixes and other changes.



Assuming that the behavior of the R CMD commands is changed
so that they respect .Rbuildignore but that no flag or
switch is immediately implemented to turn on and off
.Rbuildignore processing I have the following workaround
to allow the user to implement either situation.
It is simple enough that it does not require a script.  
I have not actually tried it out yet since the changed
commands are not yet available.

It applies to Windows or UNIX but is described below relative
to Windows and to an assumed folder tree called mypkg
which is the folder that contains .Rbuildignore.

1. in Windows Explorer create a second folder called
mypkg-shortcuts

2. select all files and folders directly within mypkg except
.Rbuildignore and right-click drag them to mypkg-shortcuts
selecting Create ShortCut after letting up on the right
mouse button.  That will create a shortcut to each file and 
folder in mypkg.  (Note that the files and folders dragged
include DESCRIPTION, R, man, etc. directly in mypkg but 
not the .files another level deep such as the .R and .Rd
files within R and man.)

3. now run off mypkg if the .Rbuildignore version is wanted
and run off mypkg-shortcuts if not.  Any time a file
in mypkg is changed in mypkg it will automatically change in
mypkg-shortcuts since they are all links.  (Special care
should be taken if files are added or deleted immediately
within mypkg; however, this is relatively rare since no
source or documentation is there.)

Note that the R and man folders within mypkg-shortcuts are
themselves links to the corresponding folders in mypkg so
that any change that occurs in mypkg\R and mypkg\man will
automatically be reflected in the mypkg-shortcuts versions.

From murdoch at stats.uwo.ca  Mon Nov 22 03:08:54 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon Nov 22 03:08:36 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
In-Reply-To: <loom.20041122T025237-324@post.gmane.org>
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
	<dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>
	<loom.20041120T043535-913@post.gmane.org>
	<tngtp0pqoek5891k4aq6m160jfj9i0dkb0@4ax.com>
	<loom.20041120T055240-88@post.gmane.org>
	<loom.20041122T025237-324@post.gmane.org>
Message-ID: <r3i2q05cs6vk0pflcbauq6v06proas0js3@4ax.com>

On Mon, 22 Nov 2004 01:54:53 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote:


>Assuming that the behavior of the R CMD commands is changed
>so that they respect .Rbuildignore but that no flag or
>switch is immediately implemented to turn on and off
>.Rbuildignore processing

That's a premature assumption.  At the moment it seems there are two
other proposals on the table:

 - no change other than the bug fix.  Then if you want to use
.Rbuildignore, you use Rcmd build to make a tarball, and do everything
else (check, build binary, etc.) from the tarball

- some sort of change that allows you to turn .Rbuildignore on and
off. 

> I have the following workaround
>to allow the user to implement either situation.
>It is simple enough that it does not require a script.  
>I have not actually tried it out yet since the changed
>commands are not yet available.

>It applies to Windows or UNIX but is described below relative
>to Windows and to an assumed folder tree called mypkg
>which is the folder that contains .Rbuildignore.
>
>1. in Windows Explorer create a second folder called
>mypkg-shortcuts
>
>2. select all files and folders directly within mypkg except
>.Rbuildignore and right-click drag them to mypkg-shortcuts
>selecting Create ShortCut after letting up on the right
>mouse button.  That will create a shortcut to each file and 
>folder in mypkg.  (Note that the files and folders dragged
>include DESCRIPTION, R, man, etc. directly in mypkg but 
>not the .files another level deep such as the .R and .Rd
>files within R and man.)

I don't think it will work in Windows.  Windows shortcuts aren't soft
links, they're just files that the shell sometimes interprets that
way.  Most other programs just see them as regular files, and won't
know to use them as links.

Duncan Murdoch

From juan_sr at uol.com.br  Mon Nov 22 03:34:39 2004
From: juan_sr at uol.com.br (Juan Santiago Ramseyer)
Date: Mon Nov 22 04:36:32 2004
Subject: [Rd] strptime() bugs?
Message-ID: <1101090880.4260.12.camel@localhost.localdomain>

strptime return wrong data?, look the R session.


# datetxt: vector of date in text format
> datetxt <- c("1939-Oct-06 00:00:00", "1939-Oct-07 00:00:00", 
               "1939-Oct-08 00:00:00", "1939-Oct-09 00:00:00")

> datehour <- strptime(datetxt,format= "%Y-%b-%d %H:%M:%S")
> datehour
[1] "1939-10-06 00:00:00" "1939-10-07 00:00:00" "1939-10-08 01:00:00"
[4] "1939-10-09 00:00:00"

# look value of datehour[3] element, where hour output equal 01:00:00,
# but hour input equal 00:00:00.


Juan

From ggrothendieck at myway.com  Mon Nov 22 05:11:41 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 22 05:11:56 2004
Subject: [Rd] Building Packages on Windows using .Rbuildignore (PR#7379)
References: <20041119212202.83F221043D@slim.kubism.ku.dk>
	<loom.20041120T012822-611@post.gmane.org>
	<dpctp0ll0129kt8fpj62ev0ciir0ch4m5m@4ax.com>
	<loom.20041120T043535-913@post.gmane.org>
	<tngtp0pqoek5891k4aq6m160jfj9i0dkb0@4ax.com>
	<loom.20041120T055240-88@post.gmane.org>
	<loom.20041122T025237-324@post.gmane.org>
	<r3i2q05cs6vk0pflcbauq6v06proas0js3@4ax.com>
Message-ID: <loom.20041122T050518-223@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

: 
: On Mon, 22 Nov 2004 01:54:53 +0000 (UTC), Gabor Grothendieck
: <ggrothendieck <at> myway.com> wrote:
: 
: >Assuming that the behavior of the R CMD commands is changed
: >so that they respect .Rbuildignore but that no flag or
: >switch is immediately implemented to turn on and off
: >.Rbuildignore processing
: > I have the following workaround
: >to allow the user to implement either situation.
: >It is simple enough that it does not require a script.  
: >I have not actually tried it out yet since the changed
: >commands are not yet available.
: 
: >It applies to Windows or UNIX but is described below relative
: >to Windows and to an assumed folder tree called mypkg
: >which is the folder that contains .Rbuildignore.
: >
: >1. in Windows Explorer create a second folder called
: >mypkg-shortcuts
: >
: >2. select all files and folders directly within mypkg except
: >.Rbuildignore and right-click drag them to mypkg-shortcuts
: >selecting Create ShortCut after letting up on the right
: >mouse button.  That will create a shortcut to each file and 
: >folder in mypkg.  (Note that the files and folders dragged
: >include DESCRIPTION, R, man, etc. directly in mypkg but 
: >not the .files another level deep such as the .R and .Rd
: >files within R and man.)
: 
: I don't think it will work in Windows.  Windows shortcuts aren't soft
: links, they're just files that the shell sometimes interprets that
: way.  Most other programs just see them as regular files, and won't
: know to use them as links.


Good point although I think it could still be made to work with
Folder Shortcuts (not to be confused with Shortcuts to Folders)
which are real folders that point to other folders and are
described at the thread at:

	http://www.annoyances.org/exec/forum/winxp/1076436311

Folder Shortcuts are not the same as Shortcuts to
Folders.  For example, if you delete a Folder Shortcut it 
deletes the target folder so you have to undo it in by
reversing the creation procedure.

What one would do is to copy the files directly under mypkg,
i.e. DESCRIPTION, etc.  to a new folder mypkg2.  These
files don't normally change much anyways as they do not include
either the source or the documentation so it should be ok in
most situations that they are copied rather than linked. Then 
create folder shortcuts as described in the link in mypkg2 which 
point to the corresponding folders in mypkg.

In a small test I found that the Folder Shortcut worked with a 
small gawk program while the Shortcut to the Folder did not.

Unfortunately this all increases complexity so one might
have to go back to creating a script after all.    Thus it
would be nice if there were some built in way to turn it on
and off.

Of course the best solution would be to be able to avoid this
all in the first place and if it came to this I would probably
just make copies since I already have scripts that do that.

From ggrothendieck at myway.com  Mon Nov 22 05:18:12 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 22 05:18:23 2004
Subject: [Rd] strptime() bugs?
References: <1101090880.4260.12.camel@localhost.localdomain>
Message-ID: <loom.20041122T051551-294@post.gmane.org>

Juan Santiago Ramseyer <juan_sr <at> uol.com.br> writes:

: 
: strptime return wrong data?, look the R session.
: 
: # datetxt: vector of date in text format
: > datetxt <- c("1939-Oct-06 00:00:00", "1939-Oct-07 00:00:00", 
:                "1939-Oct-08 00:00:00", "1939-Oct-09 00:00:00")
: 
: > datehour <- strptime(datetxt,format= "%Y-%b-%d %H:%M:%S")
: > datehour
: [1] "1939-10-06 00:00:00" "1939-10-07 00:00:00" "1939-10-08 01:00:00"
: [4] "1939-10-09 00:00:00"
: 
: # look value of datehour[3] element, where hour output equal 01:00:00,
: # but hour input equal 00:00:00.
: 

On my machine it comes out like this:

R> datetxt <- c("1939-Oct-06 00:00:00", "1939-Oct-07 00:00:00", 
+ "1939-Oct-08 00:00:00", "1939-Oct-09 00:00:00")
R> datehour <- strptime(datetxt,format= "%Y-%b-%d %H:%M:%S")
R> datehour
[1] "1939-10-06" "1939-10-07" "1939-10-08" "1939-10-09"
 
R> R.version.string # Windows XP
[1] "R version 2.0.1, 2004-11-04"

From ripley at stats.ox.ac.uk  Mon Nov 22 08:31:02 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Nov 22 08:31:13 2004
Subject: [Rd] strptime() bugs?
In-Reply-To: <1101090880.4260.12.camel@localhost.localdomain>
References: <1101090880.4260.12.camel@localhost.localdomain>
Message-ID: <Pine.LNX.4.61.0411220728190.22893@gannet.stats>

The bug is in your (unstated) OS, probably in its locale handling.
Does not happen on Solaris, Linux or Windows for me.

In any case, why not use as.Date?

On Mon, 22 Nov 2004, Juan Santiago Ramseyer wrote:

> strptime return wrong data?, look the R session.
>
>
> # datetxt: vector of date in text format
>> datetxt <- c("1939-Oct-06 00:00:00", "1939-Oct-07 00:00:00",
>               "1939-Oct-08 00:00:00", "1939-Oct-09 00:00:00")
>
>> datehour <- strptime(datetxt,format= "%Y-%b-%d %H:%M:%S")
>> datehour
> [1] "1939-10-06 00:00:00" "1939-10-07 00:00:00" "1939-10-08 01:00:00"
> [4] "1939-10-09 00:00:00"
>
> # look value of datehour[3] element, where hour output equal 01:00:00,
> # but hour input equal 00:00:00.

Is there a DST issue in your unstated timezone?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From khamenya at gmail.com  Mon Nov 22 09:57:48 2004
From: khamenya at gmail.com (Valery Khamenya)
Date: Mon Nov 22 09:57:58 2004
Subject: [Rd] [BUG?] xyplot in loop does not work
Message-ID: <84fecab0411220057701e777e@mail.gmail.com>

Hi,

the following code produces no graphic output:

#####################
library(lattice)
library(car)
data(Robey)

for (i in 1:1) 
  xyplot(tfr~contraceptors, data=Robey)
#####################

However if line with "for" is out-commented then 
one gets graph output.

The following versions were tested:

-------------------------------------
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    9.1            
year     2004           
month    06             
day      21             
language R      

-------------------------------------
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    2              
minor    0.0            
year     2004           
month    10             
day      04             
language R   
-------------------------------------
(Version 2.0.1 were tested too)

best regards
--
Valery.

From ligges at statistik.uni-dortmund.de  Mon Nov 22 10:14:16 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Nov 22 10:13:49 2004
Subject: [Rd] [BUG?] xyplot in loop does not work
In-Reply-To: <84fecab0411220057701e777e@mail.gmail.com>
References: <84fecab0411220057701e777e@mail.gmail.com>
Message-ID: <41A1ADE8.9020606@statistik.uni-dortmund.de>

Valery Khamenya wrote:

> Hi,
> 
> the following code produces no graphic output:
> 
> #####################
> library(lattice)
> library(car)
> data(Robey)
> 
> for (i in 1:1) 
>   xyplot(tfr~contraceptors, data=Robey)
> #####################

Yes, because you need to print()!
See the FAQs.

Uwe Ligges


> However if line with "for" is out-commented then 
> one gets graph output.
> 
> The following versions were tested:
> 
> -------------------------------------
> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    1              
> minor    9.1            
> year     2004           
> month    06             
> day      21             
> language R      
> 
> -------------------------------------
> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    2              
> minor    0.0            
> year     2004           
> month    10             
> day      04             
> language R   
> -------------------------------------
> (Version 2.0.1 were tested too)
> 
> best regards
> --
> Valery.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Mon Nov 22 10:20:03 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Nov 22 10:20:19 2004
Subject: [Rd] user error described in the FAQ (was [BUG?] xyplot in loop
	does not work)
In-Reply-To: <84fecab0411220057701e777e@mail.gmail.com>
References: <84fecab0411220057701e777e@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0411220914300.24431@gannet.stats>

Please DO as the posting guide asks and read the FAQ before posting.
Do read Q7.22 (and its answer).

On Mon, 22 Nov 2004, Valery Khamenya wrote:

> Hi,
>
> the following code produces no graphic output:

Correct.  It should not.

> #####################
> library(lattice)
> library(car)
> data(Robey)
>
> for (i in 1:1)
>  xyplot(tfr~contraceptors, data=Robey)
> #####################
>
> However if line with "for" is out-commented then
> one gets graph output.

Correct: it should.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From khamenya at gmail.com  Mon Nov 22 10:56:57 2004
From: khamenya at gmail.com (Valery Khamenya)
Date: Mon Nov 22 10:57:06 2004
Subject: [Rd] user error described in the FAQ (was [BUG?] xyplot in loop
	does not work)
In-Reply-To: <Pine.LNX.4.61.0411220914300.24431@gannet.stats>
References: <84fecab0411220057701e777e@mail.gmail.com>
	<Pine.LNX.4.61.0411220914300.24431@gannet.stats>
Message-ID: <84fecab04112201564d2ec895@mail.gmail.com>

> Please DO as the posting guide asks and read the FAQ before posting.
> Do read Q7.22 (and its answer).

thank you for your answer.
One should NOT be so indignant.

I have read the FAQ *twice* already since I have had to deal with R.
First time about 4 years ago, second about 2 years ago.

Do you mean, Dr.Ripley, one has to carefully read this 
100-pages-FAQ-manual  one time per year or even more often?

I guess this FAQ-entry about fully intuitive behaviour of xyplot came 
last year, right?

BTW, just imagine that the problem is not me. Maybe if the FAQ is too
long then one could reconsider decisions, which have led to this situation.

Anyway I have no fun to follow this flame.

Thank you for your valuable contribution to R.

With *kind* regards,
Valery.

From juan_sr at uol.com.br  Mon Nov 22 13:01:31 2004
From: juan_sr at uol.com.br (Juan Santiago Ramseyer)
Date: Mon Nov 22 13:03:18 2004
Subject: [Rd] strptime() bugs?
In-Reply-To: <Pine.LNX.4.61.0411220728190.22893@gannet.stats>
References: <1101090880.4260.12.camel@localhost.localdomain>
	<Pine.LNX.4.61.0411220728190.22893@gannet.stats>
Message-ID: <1101124891.3419.7.camel@localhost.localdomain>

Em Seg, 2004-11-22 ?s 07:31 +0000, Prof Brian Ripley escreveu:
> The bug is in your (unstated) OS, probably in its locale handling.
> Does not happen on Solaris, Linux or Windows for me.
> 
> In any case, why not use as.Date?
> 
> On Mon, 22 Nov 2004, Juan Santiago Ramseyer wrote:
> 
> > strptime return wrong data?, look the R session.
> >
> >
> > # datetxt: vector of date in text format
> >> datetxt <- c("1939-Oct-06 00:00:00", "1939-Oct-07 00:00:00",
> >               "1939-Oct-08 00:00:00", "1939-Oct-09 00:00:00")
> >
> >> datehour <- strptime(datetxt,format= "%Y-%b-%d %H:%M:%S")
> >> datehour
> > [1] "1939-10-06 00:00:00" "1939-10-07 00:00:00" "1939-10-08 01:00:00"
> > [4] "1939-10-09 00:00:00"
> >
> > # look value of datehour[3] element, where hour output equal 01:00:00,
> > # but hour input equal 00:00:00.
> 
> Is there a DST issue in your unstated timezone?
> 
I run Fedora Core 3. In my computer, make

> julian(datehour)
Time differences of -11044.88, -11043.88, -11042.88, -11041.92 days

When de answer is not integer value 

Juan.

From deepayan at stat.wisc.edu  Mon Nov 22 15:50:32 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Mon Nov 22 15:50:04 2004
Subject: [Rd] user error described in the FAQ (was [BUG?] xyplot in loop
	does not work)
In-Reply-To: <84fecab04112201564d2ec895@mail.gmail.com>
References: <84fecab0411220057701e777e@mail.gmail.com>
	<Pine.LNX.4.61.0411220914300.24431@gannet.stats>
	<84fecab04112201564d2ec895@mail.gmail.com>
Message-ID: <200411220850.32976.deepayan@stat.wisc.edu>

On Monday 22 November 2004 03:56, Valery Khamenya wrote:
> > Please DO as the posting guide asks and read the FAQ before
> > posting. Do read Q7.22 (and its answer).
>
> thank you for your answer.
> One should NOT be so indignant.
>
> I have read the FAQ *twice* already since I have had to deal with R.
> First time about 4 years ago, second about 2 years ago.
>
> Do you mean, Dr.Ripley, one has to carefully read this
> 100-pages-FAQ-manual  one time per year or even more often?

I don't think anyone's suggesting that. However, before you post to 
r-devel, especially suggesting that you have found a BUG, you should 
have scanned the FAQ questions (not necessarily the answers) to see if 
one matches yours. Technical documentation is not a detective novel, 
meant to be read once in your lifetime, it's a reference that you 
should know how to look up when necessary.

> I guess this FAQ-entry about fully intuitive behaviour of xyplot came
> last year, right?
>
> BTW, just imagine that the problem is not me. Maybe if the FAQ is too
> long then one could reconsider decisions, which have led to this
> situation.

The answer to your question is also available in lattice documentation, 
which you also obviously have not read. What excuse do you have for 
that?

> Anyway I have no fun to follow this flame.

But surely we are entitled to flame you when you waste our time by 
relying on your 'intuition' rather than written documentation which we 
have spent a lot of effort producing?

(In any case, Prof Ripley's 'flaming' in this case was pretty mild, in 
fact practically non-existent,  compared to his usual standards :-))

Deepayan

>
> Thank you for your valuable contribution to R.
>
> With *kind* regards,
> Valery.

From tlumley at u.washington.edu  Mon Nov 22 17:01:50 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon Nov 22 17:02:02 2004
Subject: [Rd] user error described in the FAQ (was [BUG?] xyplot in loop
	does not work)
In-Reply-To: <84fecab04112201564d2ec895@mail.gmail.com>
References: <84fecab0411220057701e777e@mail.gmail.com>
	<Pine.LNX.4.61.0411220914300.24431@gannet.stats>
	<84fecab04112201564d2ec895@mail.gmail.com>
Message-ID: <Pine.A41.4.61b.0411220741230.234728@homer05.u.washington.edu>

On Mon, 22 Nov 2004, Valery Khamenya wrote:

> Do you mean, Dr.Ripley, one has to carefully read this
> 100-pages-FAQ-manual  one time per year or even more often?

I assume he means you should read it *before asking questions*, or at 
least before suggesting that something is a [BUG?]. It does 
have an index, one entry of which is
   7.22 Why do lattice/trellis graphics not work?

Reading the FAQ index is no more work than you are asking other people to 
do, and it will get you an answer even faster.  Of course, you *did* get 
an answer to your question, very quickly, so reading the FAQ may seem 
inefficient.


> I guess this FAQ-entry about fully intuitive behaviour of xyplot came
> last year, right?

Well, the behaviour predates the R implementation and is described in 
help(xyplot).  Obviously no-one except you thinks it it fully intuititve, 
or it wouldn't be in the FAQ.


 	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From kajan at icgeb.org  Tue Nov 23 10:26:49 2004
From: kajan at icgeb.org (kajan@icgeb.org)
Date: Tue Nov 23 10:26:59 2004
Subject: [Rd] Quadratic discriminant analysis/ldet value (PR#7388)
Message-ID: <20041123092649.0A4FB10EA3@slim.kubism.ku.dk>

Full_Name: Laszlo Kajan
Version: 1.8.1
OS: linux
Submission from: (NULL) (140.105.9.79)


The qda function in MASS library seems to return 'log determinants of the
dispersion matrix' in ldet, instead of 'half log determinants' - as is
documented in help(qda).

From ruskin at iba.com.hk  Tue Nov 23 11:27:21 2004
From: ruskin at iba.com.hk (ruskin@iba.com.hk)
Date: Tue Nov 23 11:27:31 2004
Subject: [Rd] Problem with read.xport() from foreigh package (PR#7389)
Message-ID: <20041123102721.D326510428@slim.kubism.ku.dk>

Full_Name: Ruskin Chow
Version: R 2.0.1
OS: Windows 2000
Submission from: (NULL) (203.169.154.66)


Data imported from SAS using read.xport() in package foreign are converted to
<NA> when the SAS data field consists of character strings that are only one
character long.

This is apparently a previously reported bug and perhaps fixed in some platform
other than Windows (rw2001).Some discussion of the bug can be found from the
following website:

https://stat.ethz.ch/pipermail/r-help/2002-April/019349.html

I've downloaded the latest foreign package (foreign_0.8-1.zip) from CRAN but it
doesn't seem to work.

Thanks in advance for throwing light if I missed something here.

From ripley at stats.ox.ac.uk  Tue Nov 23 12:02:27 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue Nov 23 12:02:41 2004
Subject: [Rd] Problem with read.xport() from foreigh package (PR#7389)
Message-ID: <20041123110227.AED09EDE9@slim.kubism.ku.dk>

On Tue, 23 Nov 2004 ruskin@iba.com.hk wrote:

> Full_Name: Ruskin Chow
> Version: R 2.0.1
> OS: Windows 2000
> Submission from: (NULL) (203.169.154.66)
>
>
> Data imported from SAS using read.xport() in package foreign are converted to
> <NA> when the SAS data field consists of character strings that are only one
> character long.
>
> This is apparently a previously reported bug and perhaps fixed in some platform
> other than Windows (rw2001).Some discussion of the bug can be found from the
> following website:
>
> https://stat.ethz.ch/pipermail/r-help/2002-April/019349.html

There is no Windows-specific version of read.xport(), so that change 
happened everywhere: but that message does not say it was fixed nor which 
change might have fixed it.  I am guessing the change is this one

2002-03-27  Douglas Bates  <bates@stat.wisc.edu>

         * src/SASxport.c (IS_SASNA_CHAR): Silly typo (0x4l, not 0x41)
         caught by Peter.

and that does not sound like the same thing.

> I've downloaded the latest foreign package (foreign_0.8-1.zip) from CRAN but it
> doesn't seem to work.
   ^^^^^^^^^^^^^^^^^^^^

What does that mean?  It `works' on its test suite: none of the changes 
since 0.8 are related to this question.  I don't believe there is an 
example in the test suite with one-char strings, and we need an example to 
reproduce what you are seeing.

So, please read the posting guide and provide us with a reproducible 
example.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pburns at pburns.seanet.com  Tue Nov 23 12:11:17 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Tue Nov 23 12:12:03 2004
Subject: [Rd] help.search('goodness of fit') is empty
Message-ID: <41A31AD5.8060403@pburns.seanet.com>

In 2.0.1 the command

help.search('goodness of fit')

comes up empty.  "ks.test" is what I was looking for,
though perhaps there could be others?

Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

From l881013 at ms39.hinet.net  Tue Nov 23 13:05:18 2004
From: l881013 at ms39.hinet.net (l881013@ms39.hinet.net)
Date: Tue Nov 23 13:05:15 2004
Subject: [Rd] Hi
Message-ID: <200411231205.iANC53iO003107@hypatia.math.ethz.ch>

Important bill!

-------------- next part --------------
Dangerous Attachment has been Removed.  The file "Bill.zip" has been removed because of a virus.  It was infected with the "W32/Netsky.Z-mm" virus.  File quarantined as: "". http://www.fortinet.com/VirusEncyclopedia/search/encyclopediaSearch.do?method=quickSearchDirectly&virusName=W32%2FNetsky.Z-mm
From ripley at stats.ox.ac.uk  Tue Nov 23 13:46:15 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 23 14:01:29 2004
Subject: [Rd] help.search('goodness of fit') is empty
In-Reply-To: <41A31AD5.8060403@pburns.seanet.com>
References: <41A31AD5.8060403@pburns.seanet.com>
Message-ID: <Pine.LNX.4.61.0411231236550.25709@gannet.stats>

On Tue, 23 Nov 2004, Patrick Burns wrote:

> In 2.0.1 the command
>
> help.search('goodness of fit')
>
> comes up empty.  "ks.test" is what I was looking for,
> though perhaps there could be others?

Isn't that rather vague?  All tests could be in that category, as well as 
all anova methods and probably all diagnostics.  At least one special case 
of chisq.test probably has a better claim.

The entry in the Encyclopedia of Statistical Sciences supports the very 
general view: it even has the Shapiro test.

Try help.search("statistics") or help.search("data analysis") ....


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rpeng at jhsph.edu  Tue Nov 23 15:14:17 2004
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Tue Nov 23 15:14:29 2004
Subject: [Rd] str() resets class for environments
Message-ID: <41A345B9.4070104@jhsph.edu>

I noticed the following today --- str() seems to remove any extra 
class information added to an environment.

 > e <- new.env()
 > class(e)
[1] "environment"
 > class(e) <- c("foo", class(e))
 > class(e)
[1] "foo"         "environment"
 > str(e)
Classes 'foo', 'environment' length 0 <environment>
 > class(e)
[1] "environment"

I'm not sure if this is related to the external pointer issue 
mentioned in the NEWS file.  Is this the intended behavior for 
environments?  (It happens in today's R-devel also.)

 > version
          _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    2
minor    0.1
year     2004
month    11
day      15
language R
 >

-roger
-- 
Roger D. Peng
http://www.biostat.jhsph.edu/~rpeng/

From lecoutre at stat.ucl.ac.be  Tue Nov 23 15:31:46 2004
From: lecoutre at stat.ucl.ac.be (Eric Lecoutre)
Date: Tue Nov 23 15:38:40 2004
Subject: [Rd] merge.list proposal
Message-ID: <6.0.1.1.2.20041123152753.039b13c8@stat4ux.stat.ucl.ac.be>


Hi R-devel,

Today I was needing a way to "merge" two different lists (see the example 
for my definition of merge). I didn't find anything relevant using 
different search methods.
So, here is my proposal to add a list method for "merge".

Best wishes,

Eric

PS: AFAIK, there still is no place for code snipplets. I am not sure this 
mail doesn't suite R-devel. If not, what place could there be for 
discussions/proposal on such code snipplets?

-- CODE

merge.list=function(x,y,only.new.y=FALSE,append=FALSE,...)
{
     out=x

      ystructure = names(c(y,recursive=TRUE))
      xstructure = names(c(x,recursive=TRUE))
      yunique = ystructure[! ystructure %in% xstructure]

      ystructure = sapply(ystructure,FUN=function(element) 
strsplit(element,"\\."))
      xstructure = sapply(xstructure,FUN=function(element) 
strsplit(element,"\\."))
      yunique = sapply(yunique,FUN=function(element) strsplit(element,"\\."))

     if (only.new.y) lapply(yunique, FUN=function(index) 
out[[index]]<<-y[[index]])
     else
     {
       if (!append){
             lapply(ystructure, FUN=function(index) out[[index]]<<-y[[index]])
       }
       else lapply(ystructure, FUN=function(index) 
out[[index]]<<-c(out[[index]],y[[index]]))
     }
     return(out)
}

-- SAMPLE
 > (l1=list(a=list(a1=1,a2=2),b=list(b1=1)))
$a
$a$a1
[1] 1

$a$a2
[1] 2


$b
$b$b1
[1] 1


 > (l2=list(a=list(a1=-1,a3=3),c=pi))
$a
$a$a1
[1] -1

$a$a3
[1] 3


$c
[1] 3.141593

 > merge(l1,l2)
$a
$a$a1
[1] -1

$a$a2
[1] 2

$a$a3
[1] 3


$b
$b$b1
[1] 1


$c
[1] 3.141593

 > merge(l1,l2,append=TRUE)
$a
$a$a1
[1]  1 -1

$a$a2
[1] 2

$a$a3
[1] 3


$b
$b$b1
[1] 1


$c
[1] 3.141593

 > merge(l1,l2,only.new.y=TRUE)
$a
$a$a1
[1] 1

$a$a2
[1] 2

$a$a3
[1] 3


$b
$b$b1
[1] 1


$c
[1] 3.141593

 >

--
Eric Lecoutre
UCL /  Institut de Statistique
Voie du Roman Pays, 20
1348 Louvain-la-Neuve
Belgium

tel: (+32)(0)10473050
lecoutre@stat.ucl.ac.be
http://www.stat.ucl.ac.be/ISpersonnel/lecoutre

If the statistics are boring, then you've got the wrong numbers. -Edward 
Tufte

From ripley at stats.ox.ac.uk  Tue Nov 23 16:22:13 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 23 16:22:34 2004
Subject: [Rd] str() resets class for environments
In-Reply-To: <41A345B9.4070104@jhsph.edu>
References: <41A345B9.4070104@jhsph.edu>
Message-ID: <Pine.LNX.4.61.0411231448350.27627@gannet.stats>

On Tue, 23 Nov 2004, Roger D. Peng wrote:

> I noticed the following today --- str() seems to remove any extra class 
> information added to an environment.
>
>> e <- new.env()
>> class(e)
> [1] "environment"
>> class(e) <- c("foo", class(e))
>> class(e)
> [1] "foo"         "environment"
>> str(e)
> Classes 'foo', 'environment' length 0 <environment>
>> class(e)
> [1] "environment"
>
> I'm not sure if this is related to the external pointer issue mentioned in 
> the NEWS file.

It is.  Needed essentially the same fix.

> Is this the intended behavior for environments?  (It happens 
> in today's R-devel also.)

I believe the intention is that you should not class environments. Luke 
suggested earlier that unclassing one be made an error, and I have now 
done that.  Note that environments are not copied, and so everything you 
do to one instance you do to all other instances of it.  Setting a class 
makes little sense for such an object.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hb at maths.lth.se  Tue Nov 23 22:17:29 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Tue Nov 23 22:17:42 2004
Subject: [Rd] str() resets class for environments
In-Reply-To: <Pine.LNX.4.61.0411231448350.27627@gannet.stats>
Message-ID: <002801c4d1a1$d7d46fa0$a20040d5@hblaptop>

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Prof 
> Brian Ripley
> Sent: Tuesday, November 23, 2004 4:22 PM
> To: Roger D. Peng
> Cc: R Devel
> Subject: Re: [Rd] str() resets class for environments
> 
> 
> On Tue, 23 Nov 2004, Roger D. Peng wrote:
> 
> > I noticed the following today --- str() seems to remove any extra 
> > class
> > information added to an environment.
> >
> >> e <- new.env()
> >> class(e)
> > [1] "environment"
> >> class(e) <- c("foo", class(e))
> >> class(e)
> > [1] "foo"         "environment"
> >> str(e)
> > Classes 'foo', 'environment' length 0 <environment>
> >> class(e)
> > [1] "environment"
> >
> > I'm not sure if this is related to the external pointer issue 
> > mentioned in
> > the NEWS file.
> 
> It is.  Needed essentially the same fix.
> 
> > Is this the intended behavior for environments?  (It happens
> > in today's R-devel also.)
> 
> I believe the intention is that you should not class 
> environments. Luke 
> suggested earlier that unclassing one be made an error, and I 
> have now 
> done that.  Note that environments are not copied, and so 
> everything you 
> do to one instance you do to all other instances of it.  
> Setting a class 
> makes little sense for such an object.

Neither should one set attributes on environment! See thread "The class
attribute on an environment seems buggy (PR#2159)" from October 14, 2002;
here https://stat.ethz.ch/pipermail/r-devel/2002-October/025197.html and
https://stat.ethz.ch/pipermail/r-devel/2002-October/025203.html. John
Chambers gave the following example and explanation:

"Any attribute of environments, not just the class, can be killed by
operating on the object "locally" in a function.

Example:

R> f <- function(x){ y <- x; attr(y, "foo") <- NULL; y}
R> ev <- new.env()
R> attr(ev, "foo") <- "bar"
R> ev
<environment: 0x8b515d4>
attr(,"foo")
[1] "bar"
R> f(ev)
<environment: 0x8b515d4>
R> ev
<environment: 0x8b515d4>

The reason is that the C routine `duplicate' does not duplicate an
environment  OR its attributes."

To extend an environment into new class, the solution is to wrap it up in an
object of another basic data type, for instance as an element in a list or
as an attribute to NA, and set the class on the latter instead. Example:

 object <- NA
 attr(object, ".env") <- new.env()
 class(object) <- "MyClass"

I do exactly this in my root class Object in the R.oo package. At the time,
I found accessing attributes to be a little bit faster than accessing
elements in list (plus NA objects are smaller than any other object).

Thus, I want to raise a warning on this, because after introducing the
"$.environment" and "$<-.environment" in R v1.9.1, the above problem is
likely to show up more frequently; it is really tempting and it may take
awhile before you detect problems. Should attr()<-, attributes()<-,
class()<- give an error when applied to an environment? I see no reason why
not.

Best wishes

Henrik

> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From Mark.Bravington at csiro.au  Wed Nov 24 01:42:36 2004
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Wed Nov 24 01:42:53 2004
Subject: [Rd] str() resets class for environments
Message-ID: <4D99275E380CA94F998977EDACE548DC062517@extas2-hba.tas.csiro.au>

Henrik Bengtsson wrote:

> Should attr()<-, attributes()<-,
> class()<- give an error when applied to an environment? I see 
> no reason why
> not.

It would break the workspace-organization code in the 'mvbutils' package, which relies on being able to set and unset attributes of environments on the search path (specifically, the 'name' and 'path' attributes).

So personally I'd much prefer not to have this happen! For the wider R community, I'm not sure how many users the 'mvbutils' package has, but I think it's a fair number judging from emails I get. 

If you do feel the extra security is vitally important, perhaps there could be 'lock.attributes' and 'unlock.attributes' functions for environments. The idea would be that each environment has an invisible (i.e. internal) mock-attribute "locked", which would be TRUE by default (on creation of the environment). While "locked" is TRUE, any attempt to muck about with the environment's attributes would cause an error. But if you really did need to change attributes of that , it would still be possible by calling 'unlock.attributes' first.

Mark

*******************************

Mark Bravington
CSIRO (CMIS)
PO Box 1538
Castray Esplanade
Hobart
TAS 7001

phone (61) 3 6232 5118
fax (61) 3 6232 5012
Mark.Bravington@csiro.au

From Richard.Beare at csiro.au  Wed Nov 24 03:54:36 2004
From: Richard.Beare at csiro.au (Richard Beare)
Date: Wed Nov 24 03:55:48 2004
Subject: [Rd] R-2.0.1 and Rggobi
Message-ID: <41A3F7EC.2000006@csiro.au>

Hi,
I've had no luck with the combination of R-2.0.1 and Rggobi/gobi (1.1-1 
  and 1.0-1 beta). I've tried a default configuration of ggobi, as well 
as one with all the plugins enabled. I'm using RedHat 9 Linux.

The problem I'm experiencing is a segmentation fault when library.dynam 
is called from .First.lib

ggobi appears to work OK from the command line. I had an earlier 
combination working under R-1.8.1

Does anyone have fixes/suggestions?

Thanks

-- 
Richard Beare, CSIRO Mathematical & Information Sciences
Locked Bag 17, North Ryde, NSW 1670, Australia
Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200

Richard.Beare@csiro.au

From edd at debian.org  Wed Nov 24 04:45:43 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed Nov 24 04:46:03 2004
Subject: [Rd] R-2.0.1 and Rggobi
In-Reply-To: <41A3F7EC.2000006@csiro.au>
References: <41A3F7EC.2000006@csiro.au>
Message-ID: <20041124034542.GA16830@sonny.eddelbuettel.com>

Richard,

On Wed, Nov 24, 2004 at 01:54:36PM +1100, Richard Beare wrote:
> Hi,
> I've had no luck with the combination of R-2.0.1 and Rggobi/gobi (1.1-1 
>  and 1.0-1 beta). I've tried a default configuration of ggobi, as well 
> as one with all the plugins enabled. I'm using RedHat 9 Linux.
> 
> The problem I'm experiencing is a segmentation fault when library.dynam 
> is called from .First.lib
> 
> ggobi appears to work OK from the command line. I had an earlier 
> combination working under R-1.8.1
> 
> Does anyone have fixes/suggestions?

It still works for me as this cut&pasted session log from ESS shows:

    R : Copyright 2004, The R Foundation for Statistical Computing
    Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
    
    R is free software and comes with ABSOLUTELY NO WARRANTY.
    You are welcome to redistribute it under certain conditions.
    Type 'license()' or 'licence()' for distribution details.
    
    R is a collaborative project with many contributors.
    Type 'contributors()' for more information and
    'citation()' on how to cite R or R packages in publications.
    
    Type 'demo()' for some demos, 'help()' for on-line help, or
    'help.start()' for a HTML browser interface to help.
    Type 'q()' to quit R.
    
    > options(STERM='iESS', editor='gnuclient -q')
    > library(Rggobi)
    > ggobi()
    [1] "ggobi reference (1)"
    >                                ## and the ggobi gtk console comes up

but I'd also be the first to tell you that I (as the maintainer of these
Debian packages) kept the versions frozen as I had difficulties building the
newer ggobi and/or Rggobi versions (and possible combinations, been a while
I since I tried last):

edd@basebud:~> COLUMNS=120 dpkg -l "*ggobi*" | cut -c -80
Desired=Unknown/Install/Remove/Purge/Hold
| Status=Not/Installed/Config-files/Unpacked/Failed-config/Half-installed
|/ Err?=(none)/Hold/Reinst-required/X=both-problems (Status,Err: uppercase=bad)
||/ Name                     Version                  Description
+++-========================-========================-========================
ii  ggobi                    0.99.10-3                Data visualization syste
ii  r-omegahat-ggobi         0.53.0-4                 GNU R package for the GG

Sources for these are on any Debian mirror and possibly also still on
ggobi.org.  Can't recall if we needed patches; if so they also be on the
Debian mirrors.

Hope this helps, Dirk

-- 
If your hair is standing up, then you are in extreme danger.
      -- http://www.usafa.af.mil/dfp/cockpit-phys/fp1ex3.htm

From Richard.Beare at csiro.au  Wed Nov 24 05:38:35 2004
From: Richard.Beare at csiro.au (Richard Beare)
Date: Wed Nov 24 05:38:47 2004
Subject: [Rd] R-2.0.1 and Rggobi
In-Reply-To: <20041124034542.GA16830@sonny.eddelbuettel.com>
References: <41A3F7EC.2000006@csiro.au>
	<20041124034542.GA16830@sonny.eddelbuettel.com>
Message-ID: <41A4104B.6020102@csiro.au>

Hi,

Thanks for that - I attempted to install the earlier versions I had been 
successful with before - Rggobi 1.0.0 and ggobi 1.0.0-beta. The R side 
of things wouldn't compile out of the box due to a change in the 
R_IsNaNorNA function. This caused a problem in RSGgobi.c, which I fixed 
by adding the following patch:

static int G_IsNaNorNA(double f)
{
   return (R_IsNaN(f) || R_IsNA(f));
}

and changed
    GGobi_setMissingValueIdentifier(R_IsNaNorNA);
to
    GGobi_setMissingValueIdentifier(G_IsNaNorNA);

I can at least load the package and start ggobi now.

Thanks

Dirk Eddelbuettel wrote:
> Richard,
> 
> On Wed, Nov 24, 2004 at 01:54:36PM +1100, Richard Beare wrote:
> 
>>Hi,
>>I've had no luck with the combination of R-2.0.1 and Rggobi/gobi (1.1-1 
>> and 1.0-1 beta). I've tried a default configuration of ggobi, as well 
>>as one with all the plugins enabled. I'm using RedHat 9 Linux.
>>
>>The problem I'm experiencing is a segmentation fault when library.dynam 
>>is called from .First.lib
>>
>>ggobi appears to work OK from the command line. I had an earlier 
>>combination working under R-1.8.1
>>
>>Does anyone have fixes/suggestions?
> 
> 
> It still works for me as this cut&pasted session log from ESS shows:
> 
>     R : Copyright 2004, The R Foundation for Statistical Computing
>     Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
>     
>     R is free software and comes with ABSOLUTELY NO WARRANTY.
>     You are welcome to redistribute it under certain conditions.
>     Type 'license()' or 'licence()' for distribution details.
>     
>     R is a collaborative project with many contributors.
>     Type 'contributors()' for more information and
>     'citation()' on how to cite R or R packages in publications.
>     
>     Type 'demo()' for some demos, 'help()' for on-line help, or
>     'help.start()' for a HTML browser interface to help.
>     Type 'q()' to quit R.
>     
>     > options(STERM='iESS', editor='gnuclient -q')
>     > library(Rggobi)
>     > ggobi()
>     [1] "ggobi reference (1)"
>     >                                ## and the ggobi gtk console comes up
> 
> but I'd also be the first to tell you that I (as the maintainer of these
> Debian packages) kept the versions frozen as I had difficulties building the
> newer ggobi and/or Rggobi versions (and possible combinations, been a while
> I since I tried last):
> 
> edd@basebud:~> COLUMNS=120 dpkg -l "*ggobi*" | cut -c -80
> Desired=Unknown/Install/Remove/Purge/Hold
> | Status=Not/Installed/Config-files/Unpacked/Failed-config/Half-installed
> |/ Err?=(none)/Hold/Reinst-required/X=both-problems (Status,Err: uppercase=bad)
> ||/ Name                     Version                  Description
> +++-========================-========================-========================
> ii  ggobi                    0.99.10-3                Data visualization syste
> ii  r-omegahat-ggobi         0.53.0-4                 GNU R package for the GG
> 
> Sources for these are on any Debian mirror and possibly also still on
> ggobi.org.  Can't recall if we needed patches; if so they also be on the
> Debian mirrors.
> 
> Hope this helps, Dirk
> 


-- 
Richard Beare, CSIRO Mathematical & Information Sciences
Locked Bag 17, North Ryde, NSW 1670, Australia
Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200

Richard.Beare@csiro.au

From ripley at stats.ox.ac.uk  Wed Nov 24 06:50:46 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 24 06:51:05 2004
Subject: [Rd] R-2.0.1 and Rggobi
In-Reply-To: <41A4104B.6020102@csiro.au>
References: <41A3F7EC.2000006@csiro.au>
	<20041124034542.GA16830@sonny.eddelbuettel.com>
	<41A4104B.6020102@csiro.au>
Message-ID: <Pine.LNX.4.61.0411240546110.4979@gannet.stats>

Please note that is not the correct fix.  From the ONEWS in 2.0.1:

     o   The undocumented C-level entry point R_IsNaNorNA has been
         removed.  It was used in a couple of packages, and should be
         replaced by a call to the documented macro ISNAN.

The ggobi list are now operational again (or at least they have had a 
burst of activity), and that would be the appropriate place to pursue 
this.

On Wed, 24 Nov 2004, Richard Beare wrote:

> Hi,
>
> Thanks for that - I attempted to install the earlier versions I had been 
> successful with before - Rggobi 1.0.0 and ggobi 1.0.0-beta. The R side of 
> things wouldn't compile out of the box due to a change in the R_IsNaNorNA 
> function. This caused a problem in RSGgobi.c, which I fixed by adding the 
> following patch:
>
> static int G_IsNaNorNA(double f)
> {
>  return (R_IsNaN(f) || R_IsNA(f));
> }
>
> and changed
>   GGobi_setMissingValueIdentifier(R_IsNaNorNA);
> to
>   GGobi_setMissingValueIdentifier(G_IsNaNorNA);
>
> I can at least load the package and start ggobi now.
>
> Thanks
>
> Dirk Eddelbuettel wrote:
>> Richard,
>> 
>> On Wed, Nov 24, 2004 at 01:54:36PM +1100, Richard Beare wrote:
>> 
>>> Hi,
>>> I've had no luck with the combination of R-2.0.1 and Rggobi/gobi (1.1-1 
>>> and 1.0-1 beta). I've tried a default configuration of ggobi, as well as 
>>> one with all the plugins enabled. I'm using RedHat 9 Linux.
>>> 
>>> The problem I'm experiencing is a segmentation fault when library.dynam is 
>>> called from .First.lib
>>> 
>>> ggobi appears to work OK from the command line. I had an earlier 
>>> combination working under R-1.8.1
>>> 
>>> Does anyone have fixes/suggestions?
>> 
>> 
>> It still works for me as this cut&pasted session log from ESS shows:
>> 
>>     R : Copyright 2004, The R Foundation for Statistical Computing
>>     Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
>>         R is free software and comes with ABSOLUTELY NO WARRANTY.
>>     You are welcome to redistribute it under certain conditions.
>>     Type 'license()' or 'licence()' for distribution details.
>>         R is a collaborative project with many contributors.
>>     Type 'contributors()' for more information and
>>     'citation()' on how to cite R or R packages in publications.
>>         Type 'demo()' for some demos, 'help()' for on-line help, or
>>     'help.start()' for a HTML browser interface to help.
>>     Type 'q()' to quit R.
>>         > options(STERM='iESS', editor='gnuclient -q')
>>     > library(Rggobi)
>>     > ggobi()
>>     [1] "ggobi reference (1)"
>>     >                                ## and the ggobi gtk console comes up
>> 
>> but I'd also be the first to tell you that I (as the maintainer of these
>> Debian packages) kept the versions frozen as I had difficulties building 
>> the
>> newer ggobi and/or Rggobi versions (and possible combinations, been a while
>> I since I tried last):
>> 
>> edd@basebud:~> COLUMNS=120 dpkg -l "*ggobi*" | cut -c -80
>> Desired=Unknown/Install/Remove/Purge/Hold
>> | Status=Not/Installed/Config-files/Unpacked/Failed-config/Half-installed
>> |/ Err?=(none)/Hold/Reinst-required/X=both-problems (Status,Err: 
>> uppercase=bad)
>> ||/ Name                     Version                  Description
>> +++-========================-========================-========================
>> ii  ggobi                    0.99.10-3                Data visualization 
>> syste
>> ii  r-omegahat-ggobi         0.53.0-4                 GNU R package for the 
>> GG
>> 
>> Sources for these are on any Debian mirror and possibly also still on
>> ggobi.org.  Can't recall if we needed patches; if so they also be on the
>> Debian mirrors.
>> 
>> Hope this helps, Dirk
>> 
>
>
> -- 
> Richard Beare, CSIRO Mathematical & Information Sciences
> Locked Bag 17, North Ryde, NSW 1670, Australia
> Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200
>
> Richard.Beare@csiro.au
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From blindglobe at gmail.com  Wed Nov 24 07:14:10 2004
From: blindglobe at gmail.com (A.J. Rossini)
Date: Wed Nov 24 07:14:19 2004
Subject: [Rd] R-2.0.1 and Rggobi
In-Reply-To: <Pine.LNX.4.61.0411240546110.4979@gannet.stats>
References: <41A3F7EC.2000006@csiro.au>
	<20041124034542.GA16830@sonny.eddelbuettel.com>
	<41A4104B.6020102@csiro.au>
	<Pine.LNX.4.61.0411240546110.4979@gannet.stats>
Message-ID: <1abe3fa90411232214fec3fd0@mail.gmail.com>

Brian is correct regarding the lists, but note that Rggobi 1.1 works
for me (Duncan T-L sent me the following link which worked for me on
an old R-H or SuSE system (sorry Dirk!  not had a chance to change it
yet...).

" Try the tar file at
    http://www.ggobi.org/Download/Rggobi_1.1-0.tar.gz
"

best,
-tony

On Wed, 24 Nov 2004 05:50:46 +0000 (GMT), Prof Brian Ripley
<ripley@stats.ox.ac.uk> wrote:
> Please note that is not the correct fix.  From the ONEWS in 2.0.1:
> 
>     o   The undocumented C-level entry point R_IsNaNorNA has been
>         removed.  It was used in a couple of packages, and should be
>         replaced by a call to the documented macro ISNAN.
> 
> The ggobi list are now operational again (or at least they have had a
> burst of activity), and that would be the appropriate place to pursue
> this.
> 
> 
> 
> On Wed, 24 Nov 2004, Richard Beare wrote:
> 
> > Hi,
> >
> > Thanks for that - I attempted to install the earlier versions I had been
> > successful with before - Rggobi 1.0.0 and ggobi 1.0.0-beta. The R side of
> > things wouldn't compile out of the box due to a change in the R_IsNaNorNA
> > function. This caused a problem in RSGgobi.c, which I fixed by adding the
> > following patch:
> >
> > static int G_IsNaNorNA(double f)
> > {
> >  return (R_IsNaN(f) || R_IsNA(f));
> > }
> >
> > and changed
> >   GGobi_setMissingValueIdentifier(R_IsNaNorNA);
> > to
> >   GGobi_setMissingValueIdentifier(G_IsNaNorNA);
> >
> > I can at least load the package and start ggobi now.
> >
> > Thanks
> >
> > Dirk Eddelbuettel wrote:
> >> Richard,
> >>
> >> On Wed, Nov 24, 2004 at 01:54:36PM +1100, Richard Beare wrote:
> >>
> >>> Hi,
> >>> I've had no luck with the combination of R-2.0.1 and Rggobi/gobi (1.1-1
> >>> and 1.0-1 beta). I've tried a default configuration of ggobi, as well as
> >>> one with all the plugins enabled. I'm using RedHat 9 Linux.
> >>>
> >>> The problem I'm experiencing is a segmentation fault when library.dynam is
> >>> called from .First.lib
> >>>
> >>> ggobi appears to work OK from the command line. I had an earlier
> >>> combination working under R-1.8.1
> >>>
> >>> Does anyone have fixes/suggestions?
> >>
> >>
> >> It still works for me as this cut&pasted session log from ESS shows:
> >>
> >>     R : Copyright 2004, The R Foundation for Statistical Computing
> >>     Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
> >>         R is free software and comes with ABSOLUTELY NO WARRANTY.
> >>     You are welcome to redistribute it under certain conditions.
> >>     Type 'license()' or 'licence()' for distribution details.
> >>         R is a collaborative project with many contributors.
> >>     Type 'contributors()' for more information and
> >>     'citation()' on how to cite R or R packages in publications.
> >>         Type 'demo()' for some demos, 'help()' for on-line help, or
> >>     'help.start()' for a HTML browser interface to help.
> >>     Type 'q()' to quit R.
> >>         > options(STERM='iESS', editor='gnuclient -q')
> >>     > library(Rggobi)
> >>     > ggobi()
> >>     [1] "ggobi reference (1)"
> >>     >                                ## and the ggobi gtk console comes up
> >>
> >> but I'd also be the first to tell you that I (as the maintainer of these
> >> Debian packages) kept the versions frozen as I had difficulties building
> >> the
> >> newer ggobi and/or Rggobi versions (and possible combinations, been a while
> >> I since I tried last):
> >>
> >> edd@basebud:~> COLUMNS=120 dpkg -l "*ggobi*" | cut -c -80
> >> Desired=Unknown/Install/Remove/Purge/Hold
> >> | Status=Not/Installed/Config-files/Unpacked/Failed-config/Half-installed
> >> |/ Err?=(none)/Hold/Reinst-required/X=both-problems (Status,Err:
> >> uppercase=bad)
> >> ||/ Name                     Version                  Description
> >> +++-========================-========================-========================
> >> ii  ggobi                    0.99.10-3                Data visualization
> >> syste
> >> ii  r-omegahat-ggobi         0.53.0-4                 GNU R package for the
> >> GG
> >>
> >> Sources for these are on any Debian mirror and possibly also still on
> >> ggobi.org.  Can't recall if we needed patches; if so they also be on the
> >> Debian mirrors.
> >>
> >> Hope this helps, Dirk
> >>
> >
> >
> > --
> > Richard Beare, CSIRO Mathematical & Information Sciences
> > Locked Bag 17, North Ryde, NSW 1670, Australia
> > Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200
> >
> > Richard.Beare@csiro.au
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


-- 

best,
-tony

---
A.J. Rossini
blindglobe@gmail.com

From hb at maths.lth.se  Wed Nov 24 07:36:05 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Wed Nov 24 07:36:17 2004
Subject: [Rd] str() resets class for environments
In-Reply-To: <4D99275E380CA94F998977EDACE548DC062517@extas2-hba.tas.csiro.au>
Message-ID: <001c01c4d1ef$e1158790$01000001@hblaptop>

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of 
> Mark.Bravington@csiro.au
> Sent: Wednesday, November 24, 2004 1:43 AM
> To: hb@maths.lth.se
> Cc: r-devel@stat.math.ethz.ch
> Subject: RE: [Rd] str() resets class for environments
> 
> 
> Henrik Bengtsson wrote:
> 
> > Should attr()<-, attributes()<-,
> > class()<- give an error when applied to an environment? I see
> > no reason why
> > not.
> 
> It would break the workspace-organization code in the 
> 'mvbutils' package, which relies on being able to set and 
> unset attributes of environments on the search path 
> (specifically, the 'name' and 'path' attributes).
> 
> So personally I'd much prefer not to have this happen! For 
> the wider R community, I'm not sure how many users the 
> 'mvbutils' package has, but I think it's a fair number 
> judging from emails I get. 
> 
> If you do feel the extra security is vitally important, 
> perhaps there could be 'lock.attributes' and 
> 'unlock.attributes' functions for environments. The idea 
> would be that each environment has an invisible (i.e. 
> internal) mock-attribute "locked", which would be TRUE by 
> default (on creation of the environment). While "locked" is 
> TRUE, any attempt to muck about with the environment's 
> attributes would cause an error. But if you really did need 
> to change attributes of that , it would still be possible by 
> calling 'unlock.attributes' first.

Then I agree with you that it should not be made defunct; in general, if
there is a rational for using a feature in R and if someone relies on it,
then I believe one should be careful and consider alternatives before
removing it. I hope I did not break your code now by bringing it up to the R
core team.

I am curious though, do you not run into problems by setting and getting
attributes on environment in 'mvbutils'? The example of John Chambers I
re-posted, which shows that attributes can (will?) get "killed by operating
on the [environment] object "locally" in a function", suggests that you
will.

Cheers

Henrik
 
> Mark
> 
> *******************************
> 
> Mark Bravington
> CSIRO (CMIS)
> PO Box 1538
> Castray Esplanade
> Hobart
> TAS 7001
> 
> phone (61) 3 6232 5118
> fax (61) 3 6232 5012
> Mark.Bravington@csiro.au
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From Richard.Beare at csiro.au  Wed Nov 24 08:27:01 2004
From: Richard.Beare at csiro.au (Richard Beare)
Date: Wed Nov 24 08:27:13 2004
Subject: [Rd] R-2.0.1 and Rggobi
In-Reply-To: <1abe3fa90411232214fec3fd0@mail.gmail.com>
References: <41A3F7EC.2000006@csiro.au>	
	<20041124034542.GA16830@sonny.eddelbuettel.com>	
	<41A4104B.6020102@csiro.au>	
	<Pine.LNX.4.61.0411240546110.4979@gannet.stats>
	<1abe3fa90411232214fec3fd0@mail.gmail.com>
Message-ID: <41A437C5.1040503@csiro.au>

OK, last posting on this thread - the combinations I have tried and the 
results are

ggobi           Rggobi   Result

1.0-1-beta      1.1-0    segfault
1.0-1-beta      1.1-1    segfault
1.0-0-beta      1.1-0    segfault
1.0-0-beta      1.1-1    segfault
1.0-0           1.1-0    segfault
1.0-0           1.1-1    segfault
1.0-0           1.0.0      OK     (with previously mentioned fix 
ammended as per BR's advice)


Obviously there are a couple of other combinations, but I'll stop there 
for now. Note that the ggobi builds are all with the default configure 
options.

A.J. Rossini wrote:
> Brian is correct regarding the lists, but note that Rggobi 1.1 works
> for me (Duncan T-L sent me the following link which worked for me on
> an old R-H or SuSE system (sorry Dirk!  not had a chance to change it
> yet...).
> 
> " Try the tar file at
>     http://www.ggobi.org/Download/Rggobi_1.1-0.tar.gz
> "
> 
> best,
> -tony
> 
> On Wed, 24 Nov 2004 05:50:46 +0000 (GMT), Prof Brian Ripley
> <ripley@stats.ox.ac.uk> wrote:
> 
>>Please note that is not the correct fix.  From the ONEWS in 2.0.1:
>>
>>    o   The undocumented C-level entry point R_IsNaNorNA has been
>>        removed.  It was used in a couple of packages, and should be
>>        replaced by a call to the documented macro ISNAN.
>>
>>The ggobi list are now operational again (or at least they have had a
>>burst of activity), and that would be the appropriate place to pursue
>>this.
>>
>>
>>
>>On Wed, 24 Nov 2004, Richard Beare wrote:
>>
>>
>>>Hi,
>>>
>>>Thanks for that - I attempted to install the earlier versions I had been
>>>successful with before - Rggobi 1.0.0 and ggobi 1.0.0-beta. The R side of
>>>things wouldn't compile out of the box due to a change in the R_IsNaNorNA
>>>function. This caused a problem in RSGgobi.c, which I fixed by adding the
>>>following patch:
>>>
>>>static int G_IsNaNorNA(double f)
>>>{
>>> return (R_IsNaN(f) || R_IsNA(f));
>>>}
>>>
>>>and changed
>>>  GGobi_setMissingValueIdentifier(R_IsNaNorNA);
>>>to
>>>  GGobi_setMissingValueIdentifier(G_IsNaNorNA);
>>>
>>>I can at least load the package and start ggobi now.
>>>
>>>Thanks
>>>
>>>Dirk Eddelbuettel wrote:
>>>
>>>>Richard,
>>>>
>>>>On Wed, Nov 24, 2004 at 01:54:36PM +1100, Richard Beare wrote:
>>>>
>>>>
>>>>>Hi,
>>>>>I've had no luck with the combination of R-2.0.1 and Rggobi/gobi (1.1-1
>>>>>and 1.0-1 beta). I've tried a default configuration of ggobi, as well as
>>>>>one with all the plugins enabled. I'm using RedHat 9 Linux.
>>>>>
>>>>>The problem I'm experiencing is a segmentation fault when library.dynam is
>>>>>called from .First.lib
>>>>>
>>>>>ggobi appears to work OK from the command line. I had an earlier
>>>>>combination working under R-1.8.1
>>>>>
>>>>>Does anyone have fixes/suggestions?
>>>>
>>>>
>>>>It still works for me as this cut&pasted session log from ESS shows:
>>>>
>>>>    R : Copyright 2004, The R Foundation for Statistical Computing
>>>>    Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
>>>>        R is free software and comes with ABSOLUTELY NO WARRANTY.
>>>>    You are welcome to redistribute it under certain conditions.
>>>>    Type 'license()' or 'licence()' for distribution details.
>>>>        R is a collaborative project with many contributors.
>>>>    Type 'contributors()' for more information and
>>>>    'citation()' on how to cite R or R packages in publications.
>>>>        Type 'demo()' for some demos, 'help()' for on-line help, or
>>>>    'help.start()' for a HTML browser interface to help.
>>>>    Type 'q()' to quit R.
>>>>        > options(STERM='iESS', editor='gnuclient -q')
>>>>    > library(Rggobi)
>>>>    > ggobi()
>>>>    [1] "ggobi reference (1)"
>>>>    >                                ## and the ggobi gtk console comes up
>>>>
>>>>but I'd also be the first to tell you that I (as the maintainer of these
>>>>Debian packages) kept the versions frozen as I had difficulties building
>>>>the
>>>>newer ggobi and/or Rggobi versions (and possible combinations, been a while
>>>>I since I tried last):
>>>>
>>>>edd@basebud:~> COLUMNS=120 dpkg -l "*ggobi*" | cut -c -80
>>>>Desired=Unknown/Install/Remove/Purge/Hold
>>>>| Status=Not/Installed/Config-files/Unpacked/Failed-config/Half-installed
>>>>|/ Err?=(none)/Hold/Reinst-required/X=both-problems (Status,Err:
>>>>uppercase=bad)
>>>>||/ Name                     Version                  Description
>>>>+++-========================-========================-========================
>>>>ii  ggobi                    0.99.10-3                Data visualization
>>>>syste
>>>>ii  r-omegahat-ggobi         0.53.0-4                 GNU R package for the
>>>>GG
>>>>
>>>>Sources for these are on any Debian mirror and possibly also still on
>>>>ggobi.org.  Can't recall if we needed patches; if so they also be on the
>>>>Debian mirrors.
>>>>
>>>>Hope this helps, Dirk
>>>>
>>>
>>>
>>>--
>>>Richard Beare, CSIRO Mathematical & Information Sciences
>>>Locked Bag 17, North Ryde, NSW 1670, Australia
>>>Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200
>>>
>>>Richard.Beare@csiro.au
>>>
>>>______________________________________________
>>>R-devel@stat.math.ethz.ch mailing list
>>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>>--
>>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>University of Oxford,             Tel:  +44 1865 272861 (self)
>>1 South Parks Road,                     +44 1865 272866 (PA)
>>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>>
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 
> 


-- 
Richard Beare, CSIRO Mathematical & Information Sciences
Locked Bag 17, North Ryde, NSW 1670, Australia
Phone: +61-2-93253221 (GMT+~10hrs)  Fax: +61-2-93253200

Richard.Beare@csiro.au

From ehlers at math.ucalgary.ca  Wed Nov 24 10:06:01 2004
From: ehlers at math.ucalgary.ca (P Ehlers)
Date: Wed Nov 24 10:06:36 2004
Subject: [Rd] text() with invalid argument type crashes RGui.exe
Message-ID: <41A44EF9.8070806@math.ucalgary.ca>

Dear Rexperts:

(R 2.0.1 on Windows XP Pro)

Is the following problem unique to my setup?
If it's a known problem, I didn't see it at
http://bugs.r-project.org/ nor find discussion in the archives.

plot(1:10)
loc <- c(5, 6)
text(loc, labels = "a")

Produces expected results according to ?xy.coords.

plot(1:10)
loc <- list(x = 5, y = 6)
text(loc, labels = "a")

No problem.

But:

plot(1:10)
loc <- list(5, 6)
text(loc, labels = "a")

crashes RGui.
("R for Windows GUI front-end has encountered a problem and ...")

R-FAQ:9.1 says:

If you call .C(), .Fortran(), .External() or .Call() (or
.Internal()) yourself (or in a function you wrote), you can
always crash R by using wrong argument types (modes). This
is not a bug.

I realize that I'm using the wrong argument type;
nevertheless, if the behaviour is general, it might be better
to generate an error.

For anyone with more know-how than I have, here are the details
of the crash:
AppName: rgui.exe     AppVer: 2.1.41115.0     ModName: r.dll
ModVer: 2.1.41115.0     Offset: 000ef1b3


Peter Ehlers
U of Calgary
ehlers@math.ucalgary.ca

From ripley at stats.ox.ac.uk  Wed Nov 24 10:21:13 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Nov 24 10:21:30 2004
Subject: [Rd] text() with invalid argument type crashes RGui.exe
In-Reply-To: <41A44EF9.8070806@math.ucalgary.ca>
References: <41A44EF9.8070806@math.ucalgary.ca>
Message-ID: <Pine.LNX.4.61.0411240918590.20234@gannet.stats>

It's general (on all platforms), and the internal code for text.default 
needs a safety check.


On Wed, 24 Nov 2004, P Ehlers wrote:

> Dear Rexperts:
>
> (R 2.0.1 on Windows XP Pro)
>
> Is the following problem unique to my setup?
> If it's a known problem, I didn't see it at
> http://bugs.r-project.org/ nor find discussion in the archives.
>
> plot(1:10)
> loc <- c(5, 6)
> text(loc, labels = "a")
>
> Produces expected results according to ?xy.coords.
>
> plot(1:10)
> loc <- list(x = 5, y = 6)
> text(loc, labels = "a")
>
> No problem.
>
> But:
>
> plot(1:10)
> loc <- list(5, 6)
> text(loc, labels = "a")
>
> crashes RGui.
> ("R for Windows GUI front-end has encountered a problem and ...")
>
> R-FAQ:9.1 says:
>
> If you call .C(), .Fortran(), .External() or .Call() (or
> .Internal()) yourself (or in a function you wrote), you can
> always crash R by using wrong argument types (modes). This
> is not a bug.
>
> I realize that I'm using the wrong argument type;
> nevertheless, if the behaviour is general, it might be better
> to generate an error.
>
> For anyone with more know-how than I have, here are the details
> of the crash:
> AppName: rgui.exe     AppVer: 2.1.41115.0     ModName: r.dll
> ModVer: 2.1.41115.0     Offset: 000ef1b3
>
>
> Peter Ehlers
> U of Calgary
> ehlers@math.ucalgary.ca
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Roger.Bivand at nhh.no  Wed Nov 24 10:22:37 2004
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Nov 24 10:22:56 2004
Subject: [Rd] text() with invalid argument type crashes RGui.exe
In-Reply-To: <41A44EF9.8070806@math.ucalgary.ca>
Message-ID: <Pine.LNX.4.44.0411241020580.2258-100000@reclus.nhh.no>

On Wed, 24 Nov 2004, P Ehlers wrote:

> Dear Rexperts:
> 
> (R 2.0.1 on Windows XP Pro)
> 
> Is the following problem unique to my setup?
> If it's a known problem, I didn't see it at
> http://bugs.r-project.org/ nor find discussion in the archives.
> 
> plot(1:10)
> loc <- c(5, 6)
> text(loc, labels = "a")
> 
> Produces expected results according to ?xy.coords.
> 
> plot(1:10)
> loc <- list(x = 5, y = 6)
> text(loc, labels = "a")
> 
> No problem.
> 
> But:
> 
> plot(1:10)
> loc <- list(5, 6)
> text(loc, labels = "a")
> 
> crashes RGui.
> ("R for Windows GUI front-end has encountered a problem and ...")
> 
> R-FAQ:9.1 says:
> 
> If you call .C(), .Fortran(), .External() or .Call() (or
> .Internal()) yourself (or in a function you wrote), you can
> always crash R by using wrong argument types (modes). This
> is not a bug.
> 
> I realize that I'm using the wrong argument type;
> nevertheless, if the behaviour is general, it might be better
> to generate an error.
> 
> For anyone with more know-how than I have, here are the details
> of the crash:
> AppName: rgui.exe     AppVer: 2.1.41115.0     ModName: r.dll
> ModVer: 2.1.41115.0     Offset: 000ef1b3
> 

Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
RHEL 3 i386

> plot(1:10)
> loc <- list(5, 6)
> text(loc, labels = "a")

Program received signal SIGFPE, Arithmetic exception.
0x080edd3b in do_text (call=0x9080c48, op=0x867d72c, args=0x8660570, 
    env=0x8a1bf90) at plot.c:2153
2153            xx = x[i % n];

> 
> Peter Ehlers
> U of Calgary
> ehlers@math.ucalgary.ca
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
e-mail: Roger.Bivand@nhh.no

From Erik.Jorgensen at agrsci.dk  Wed Nov 24 13:05:08 2004
From: Erik.Jorgensen at agrsci.dk (Erik.Jorgensen@agrsci.dk)
Date: Wed Nov 24 13:05:20 2004
Subject: [Rd] dhyper() does not allow non-integer values for input
	parameters m (PR#7393)
Message-ID: <20041124120508.881A0FC03@slim.kubism.ku.dk>


dhyper() does not allow non-integer values for input parameters m and n.

this is in contrast to the other functions in the _hyper() "family",

  # OK
  dhyper(1,10,90,10)

  # NaN
  dhyper(1,10.5,90,10)

  # OK
  phyper(1,10,90,10)
  phyper(1,10.5,90,10)

  # OK
  qhyper(0.71,10,90,10)
  qhyper(0.71,10.5,90,10)

  # OK
  rhyper(1,10,90,10)
  rhyper(1,10.5,90,10)



# this "naive" version of dhyper() works

dhyperx<-function(x,m,n,k,log=FALSE){
       lp<-lchoose(m, x) + lchoose(n, k-x) - lchoose( m+n, k)
       if (log) {lp} else {exp(lp)}
       }

  # OK
  dhyperx(1,10,90,10)
  dhyperx(1,10.5,90,10)



Erik J?rgensen
Danish Institute of Agricultural Sciences



--please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = i386
  os = mingw32
  system = i386, mingw32
  status =
  major = 2
  minor = 0.1
  year = 2004
  month = 11
  day = 15
  language = R

Windows XP Professional (build 2600) Service Pack 1.0

Search Path:
  .GlobalEnv, package:methods, package:stats, package:graphics,
package:grDevices, package:utils, package:datasets, Autoloads, package:base

From lecoutre at stat.ucl.ac.be  Wed Nov 24 13:40:24 2004
From: lecoutre at stat.ucl.ac.be (Eric Lecoutre)
Date: Wed Nov 24 13:47:19 2004
Subject: [Rd] Suggestions for packages / help / index (long mail)
Message-ID: <6.0.1.1.2.20041124134002.03108a00@stat4ux.stat.ucl.ac.be>

Hi R-users and developers,

This month may have seen one of the biggest thread never seen on R-related 
mailing lists, the one about "GPL software" and "hidden costs" (at this 
day, thread is still open - and active!).
Lot's of mails in this thread are not really relevant to the original mail, 
send by Philippe Grosjean.
Nevertheless, most of the mails are of interest and one of my conclusions 
was that there is a real need in "help/index relating" stuff.
I have spent some times thinking about it. As everybody, I end up with: 
"this is not an easy problem at all" and "what we have *is* still very 
great". Indeed!
What you will find now is a sketch of thoughts/proposals . I tend to think 
some of those proposals are "low-cost" and could improve the life of R 
beginners.

First, I have to say I will put myself in the situation of a really 
beginner (say a first classes student):
A user who has practiced for some years will find easier to crawl all the 
rich available material. His experiment will help him find easily the 
package relevant to his problem, the function, has learned to use 
help.search() and so on. And he will wisely use R-help, following the 
guideline.
On the contrary, a beginneR will have more and more difficulties entering R 
world, as this one is constantly growing (leading to the famous supposed 
"hidden costs"). Appropriate poweR is not easy, specially if your daily 
task is specialized: you will have difficulties digging into all material 
to find those nuggets that will help you (and thanks to the community, 
there are so many nuggets... it may be hard to choose between gold or platine).

What we have for now is a document listing keywords. Advanced user will 
know those keywords are to be used by package maintainer, feeding the help 
system building chain.
This keyword database is very pertinent. It's content, which has been 
inherited in part from S, has previously beeing carefuly worked out. And 
that works well (try help.search("graphs") will provide you very 
interesting stuff - provided you have some packages installed...). I think 
that this keywords list may even have more uses.

1. As R community growths, it may be time to add some terms in this 
keywords list. Think about SciViews bundle on which Philippe is working. 
Most package in it are linked to GUI-stuff. Wouldn't the keyword GUI be 
useful? It could be worth offering for one month to the community the 
ability to suggest new entries (I am also thinking about econometry stuff). 
Then, R core team would choose if candidates are eligible or not.

2. DESCRIPTION files for packages may have a new field: keywords, allowing 
the author to add keywords to it's package (minimum one).


Here are some things we could end up:

package		keyword(s)		
---------------------------------------------
abind		Basics, manip, array
accuracy	Statistics
acepack		Statistics, regression
adapt		Mathematics
ade4		multivariate
...


3. Package keywords could be used to propose "automatic" bundles and/or 
lists of package (consider for that keywords as categories). Thus, CRAN 
sites could have a listing of all packages, but also a listing of all 
packages related to Mathematics, to multivariate (statistics) and so on. 
And one could propose to install a whole bunch of packages at one time. 
Thus (and provided the existence of adequate keywords), the beginner 
interested in multivariate statistics would easily install his R with 
adequate starting package. Same for econometrics, geostatistics, and any 
other field of application.

4. What would really be useful then (I think) is a sort of PACKAGES_INDEX 
that would come with R. Explanation: one package index would be it's 
keywords (with a high weight) plus all it's functins and their associated 
keywords functions (lower weights). When downloading and installing the 
newest R, there would be an flat text file containg that (not so so ...so 
big). We could also add a function that will refresh this file.

5. Then, we could update "help.search", that would begin to list 
information on "installed packages" PLUS potentially suggest other packages 
available on CRAN.

6. Final point has already been discussed in the past. It is about misc 
packages and pieces of code. I propose the creation of 5 packages:
	- miscGraphics (keywords: misc, Graphics)
	- miscStatistics (keywords: misc, Statistics)
	- miscMathematics (keywords: misc, Mathematics)
	- miscBasics (keywords: misc, Basics)
	- miscProgramming (keywords: misc, Programming)
With what I proposed before, they would be accessible as a bunch selecting 
package for categroy "misc" and each would also be listed in it's category 
("Graphics",...).
Each of those package would have a maintainer and a new mailing list (say 
R-misc) could be set up to talk about pieces of code that could enter such 
or such package. Yes, I am volonteer to maintain one of those.



There is some work here for all 6 points, but not so much. What is great is 
that we already have most of the necessary stuff. And we only use KEYWORDS 
file...
Please let me know what you think about those suggestions. If there is 
interest, I may ask for others volonteers to set one or more of those 
suggestions.

Eric

Eric Lecoutre
UCL /  Institut de Statistique
Voie du Roman Pays, 20
1348 Louvain-la-Neuve
Belgium

tel: (+32)(0)10473050
lecoutre@stat.ucl.ac.be
http://www.stat.ucl.ac.be/ISpersonnel/lecoutre

If the statistics are boring, then you've got the wrong numbers. -Edward 
Tufte

From ggrothendieck at myway.com  Wed Nov 24 15:06:15 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Nov 24 15:06:28 2004
Subject: [Rd] Suggestions for packages / help / index (long mail)
References: <6.0.1.1.2.20041124134002.03108a00@stat4ux.stat.ucl.ac.be>
Message-ID: <loom.20041124T150203-392@post.gmane.org>

Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:

: 6. Final point has already been discussed in the past. It is about misc 
: packages and pieces of code. I propose the creation of 5 packages:
: 	- miscGraphics (keywords: misc, Graphics)
: 	- miscStatistics (keywords: misc, Statistics)
: 	- miscMathematics (keywords: misc, Mathematics)
: 	- miscBasics (keywords: misc, Basics)
: 	- miscProgramming (keywords: misc, Programming)

Rather than preset the categories perhaps evolving them would
be better, just starting out with a single Misc package and then 
decomposing it into multiple packages as the categories become
clear.

From lecoutre at stat.ucl.ac.be  Wed Nov 24 15:15:27 2004
From: lecoutre at stat.ucl.ac.be (Eric Lecoutre)
Date: Wed Nov 24 15:22:17 2004
Subject: [Rd] Suggestions for packages / help / index (long mail)
In-Reply-To: <loom.20041124T150203-392@post.gmane.org>
References: <6.0.1.1.2.20041124134002.03108a00@stat4ux.stat.ucl.ac.be>
	<loom.20041124T150203-392@post.gmane.org>
Message-ID: <6.0.1.1.2.20041124151201.03004a00@stat4ux.stat.ucl.ac.be>

At 15:06 24/11/2004, Gabor Grothendieck wrote:
>Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:
>
>: 6. Final point has already been discussed in the past. It is about misc
>: packages and pieces of code. I propose the creation of 5 packages:
>:       - miscGraphics (keywords: misc, Graphics)
>:       - miscStatistics (keywords: misc, Statistics)
>:       - miscMathematics (keywords: misc, Mathematics)
>:       - miscBasics (keywords: misc, Basics)
>:       - miscProgramming (keywords: misc, Programming)
>
>Rather than preset the categories perhaps evolving them would
>be better, just starting out with a single Misc package and then
>decomposing it into multiple packages as the categories become
>clear.


Those categories are taken from KEYWORDS (master entries). I guess it 
wouldn't be difficult to still have substancial entries for those packages, 
if some misc package maintainer would make the job to break their package 
into pieces. BTW, I have to admit this choice is not easy to make for 
several reasons, the main one beeing to keep the ability to modify one's 
own contributions.
For those packages, a collaborative plattform such as SourceForge and so 
on, with Sync-ability, could be a good choice.

Eric


Eric Lecoutre
UCL /  Institut de Statistique
Voie du Roman Pays, 20
1348 Louvain-la-Neuve
Belgium

tel: (+32)(0)10473050
lecoutre@stat.ucl.ac.be
http://www.stat.ucl.ac.be/ISpersonnel/lecoutre

If the statistics are boring, then you've got the wrong numbers. -Edward 
Tufte

From edd at debian.org  Wed Nov 24 15:32:21 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed Nov 24 15:32:34 2004
Subject: [Rd] R-2.0.1 and Rggobi
In-Reply-To: <1abe3fa90411232214fec3fd0@mail.gmail.com>
References: <41A3F7EC.2000006@csiro.au>
	<20041124034542.GA16830@sonny.eddelbuettel.com>
	<41A4104B.6020102@csiro.au>
	<Pine.LNX.4.61.0411240546110.4979@gannet.stats>
	<1abe3fa90411232214fec3fd0@mail.gmail.com>
Message-ID: <20041124143221.GA22104@sonny.eddelbuettel.com>

On Wed, Nov 24, 2004 at 07:14:10AM +0100, A.J. Rossini wrote:
> Brian is correct regarding the lists, but note that Rggobi 1.1 works
> for me (Duncan T-L sent me the following link which worked for me on
> an old R-H or SuSE system (sorry Dirk!  not had a chance to change it
> yet...).
> 
> " Try the tar file at
>     http://www.ggobi.org/Download/Rggobi_1.1-0.tar.gz
> "

Very good, so my sometimes Quixotic attempts at getting more of DTL's code
into Debian, Quantian, ... shall see another round of battling. News at 11.

Dirk

-- 
If your hair is standing up, then you are in extreme danger.
      -- http://www.usafa.af.mil/dfp/cockpit-phys/fp1ex3.htm

From tlumley at u.washington.edu  Wed Nov 24 16:11:07 2004
From: tlumley at u.washington.edu (tlumley@u.washington.edu)
Date: Wed Nov 24 16:11:15 2004
Subject: (PR#7393) Re: [Rd] dhyper() does not allow non-integer values for
Message-ID: <20041124151107.0D93510EDD@slim.kubism.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

---1936847065-1111238301-1101309010=:193006
Content-Type: TEXT/PLAIN; charset=iso-8859-1; format=flowed
Content-Transfer-Encoding: QUOTED-PRINTABLE

On Wed, 24 Nov 2004 Erik.Jorgensen@agrsci.dk wrote:

>
> dhyper() does not allow non-integer values for input parameters m and n.
>
> this is in contrast to the other functions in the _hyper() "family",

I would argue that the bug was in the other functions. If not, there is a=
=20
bug in the documentation, which gives no way to tell what the result=20
should mean for non-integer m, n, k.

 =09-thomas


>  # OK
>  dhyper(1,10,90,10)
>
>  # NaN
>  dhyper(1,10.5,90,10)
>
>  # OK
>  phyper(1,10,90,10)
>  phyper(1,10.5,90,10)
>
>  # OK
>  qhyper(0.71,10,90,10)
>  qhyper(0.71,10.5,90,10)
>
>  # OK
>  rhyper(1,10,90,10)
>  rhyper(1,10.5,90,10)
>
>
>
> # this "naive" version of dhyper() works
>
> dhyperx<-function(x,m,n,k,log=3DFALSE){
>       lp<-lchoose(m, x) + lchoose(n, k-x) - lchoose( m+n, k)
>       if (log) {lp} else {exp(lp)}
>       }
>
>  # OK
>  dhyperx(1,10,90,10)
>  dhyperx(1,10.5,90,10)
>
>
>
> Erik J=F8rgensen
> Danish Institute of Agricultural Sciences
>
>
>
> --please do not edit the information below--
>
> Version:
>  platform =3D i386-pc-mingw32
>  arch =3D i386
>  os =3D mingw32
>  system =3D i386, mingw32
>  status =3D
>  major =3D 2
>  minor =3D 0.1
>  year =3D 2004
>  month =3D 11
>  day =3D 15
>  language =3D R
>
> Windows XP Professional (build 2600) Service Pack 1.0
>
> Search Path:
>  .GlobalEnv, package:methods, package:stats, package:graphics,
> package:grDevices, package:utils, package:datasets, Autoloads, package:ba=
se
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley=09=09=09Assoc. Professor, Biostatistics
tlumley@u.washington.edu=09University of Washington, Seattle
---1936847065-1111238301-1101309010=:193006--

From ripley at stats.ox.ac.uk  Wed Nov 24 16:40:11 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed Nov 24 16:40:21 2004
Subject: [Rd] Problem with read.xport() from foreigh package (PR#7389)
Message-ID: <20041124154011.4315810EDD@slim.kubism.ku.dk>

The relevant part of the code is

 		    if(strlen(tmpchar) == 1 && IS_SASNA_CHAR(tmpchar[0]))

#define IS_SASNA_CHAR(c) ((c) == 0x5f || (c) == 0x2e || \
                           (0x41 <= (c) && (c) <= 0x5a))

which says that single-character fields containing ., _, A-Z are to be 
taken as missing values.  That is true of all single-character fields in 
this file.

Looking at the reference, it says

   Missing values are written out with the first byte (the exponent)
   indicating the proper missing values. All subsequent bytes are 0x00. The
   first byte is:

      type      byte
       ._       0x5f
       .        0x2e
       .A       0x41
       .B       0x42
          ....
       .Z       0x5a

which suggests this is intended to apply only to numeric records 
('exponent'), whereas R applies it only to character records.  Elsewhere I 
found

   SAS stores 'missing' data depending on the variables data type:
   character or numeric. A 'missing' character value is represented as a
   blank (' ') or null (''). A 'missing' numeric value is represented as a
   single dot (.). SAS allows you to differentiate between values that are
   missing for different reasons. For example, in survey research a
   question may not be answered because the respondent refuses to answer or
   because they don't know the answer. SAS has a range of missing values to
   cover this case. These special missing values are for numerics only and
   are the letters of the alphabet preceded by the single dot .A thru .Z

which seems to confirm this.

Does anyone know for sure?


On Wed, 24 Nov 2004, Ruskin Chow wrote:

> Dear Prof. Ripley,
>
> Thanks for your prompt reply. In fact when I converted one-char data fields
> in SAS to two-char fields before generating the SAS transport format file,
> the problem (that all single char fields become <NA>) disappears. The
> problem is readily reproducible and I attach two sample data files in SAS
> transport format, one with one-char data fields ("char1.xport") and the
> other data file ("char2.xport") with the same data fields except that
> one-char fields are converted to two-char fields (for example, see the
> fields named "SEX", "GB" etc.). The R output text file ("lastsave.txt") is
> also attached so that you can verify it easily at your end.
>
> Even with the above, there is no conclusive evidence whether this problem is
> actually (a) with SAS in generating the transport file, or (b) with R in the
> read.xport() function. However, with the indication in the following
> discussion thread:
>
> http://maths.newcastle.edu.au/~rking/R/help/02a/3258.html
>
> I tend to believe that R may have the answer.
>
> Hope this helps and thanks again for your quick response.
>
> Best regards,
>
> Ruskin
>
> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
> Sent: Tuesday, November 23, 2004 7:02 PM
> To: ruskin@iba.com.hk
> Cc: R-bugs@biostat.ku.dk
> Subject: Re: [Rd] Problem with read.xport() from foreigh package (PR#7389)
>
> On Tue, 23 Nov 2004 ruskin@iba.com.hk wrote:
>
>> Full_Name: Ruskin Chow
>> Version: R 2.0.1
>> OS: Windows 2000
>> Submission from: (NULL) (203.169.154.66)
>>
>>
>> Data imported from SAS using read.xport() in package foreign are converted
> to
>> <NA> when the SAS data field consists of character strings that are only
> one
>> character long.
>>
>> This is apparently a previously reported bug and perhaps fixed in some
> platform
>> other than Windows (rw2001).Some discussion of the bug can be found from
> the
>> following website:
>>
>> https://stat.ethz.ch/pipermail/r-help/2002-April/019349.html
>
> There is no Windows-specific version of read.xport(), so that change
> happened everywhere: but that message does not say it was fixed nor which
> change might have fixed it.  I am guessing the change is this one
>
> 2002-03-27  Douglas Bates  <bates@stat.wisc.edu>
>
>         * src/SASxport.c (IS_SASNA_CHAR): Silly typo (0x4l, not 0x41)
>         caught by Peter.
>
> and that does not sound like the same thing.
>
>> I've downloaded the latest foreign package (foreign_0.8-1.zip) from CRAN
> but it
>> doesn't seem to work.
>   ^^^^^^^^^^^^^^^^^^^^
>
> What does that mean?  It `works' on its test suite: none of the changes
> since 0.8 are related to this question.  I don't believe there is an
> example in the test suite with one-char strings, and we need an example to
> reproduce what you are seeing.
>
> So, please read the posting guide and provide us with a reproducible
> example.
>
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From wolski at molgen.mpg.de  Wed Nov 24 17:45:58 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Wed Nov 24 17:47:44 2004
Subject: [Rd] pixmap package and pdf Device.
Message-ID: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>

Hi,

The following code generates a invalid (?) pdf file.

pdf("test.pdf")
x <- pixmapIndexed(rep(1:8, 9), nrow=6, col=terrain.colors(8))
plot(x)
dev.off()

This pdf can be viewed but not printed 
Trying to print causes to crash gv as well as acrobat windows XP


Yours 
/E.



--please do not edit the information below--


Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status =
 major = 2
 minor = 0.1
 year = 2004
 month = 11
 day = 15
 language = R

From p.dalgaard at biostat.ku.dk  Wed Nov 24 18:32:15 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Nov 24 18:34:25 2004
Subject: (PR#7393) Re: [Rd] dhyper() does not allow non-integer values for
In-Reply-To: <20041124151107.0D93510EDD@slim.kubism.ku.dk>
References: <20041124151107.0D93510EDD@slim.kubism.ku.dk>
Message-ID: <x23byz5f1c.fsf@biostat.ku.dk>

tlumley@u.washington.edu writes:

> >
> > dhyper() does not allow non-integer values for input parameters m and n.
> >
> > this is in contrast to the other functions in the _hyper() "family",
> 
> I would argue that the bug was in the other functions. If not, there is a=
> =20
> bug in the documentation, which gives no way to tell what the result=20
> should mean for non-integer m, n, k.


My initial reaction too (and surely it is not a bug that functions
behave inconsistently in regions where they are not documented to work
at all), but on the other hand, noninteger m,n do appear to give a
well-defined distribution, and perhaps there's a way of making sense
of it? I wouldn't think it corresponds to noncentral hypergeometric
distributions.


>  =09-thomas
(who is suddenly coming across in quoted-unreadable?)


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From MSchwartz at MedAnalytics.com  Wed Nov 24 18:55:17 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Wed Nov 24 18:59:47 2004
Subject: [Rd] pixmap package and pdf Device.
In-Reply-To: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>
References: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>
Message-ID: <1101318917.18939.42.camel@horizons.localdomain>

On Wed, 2004-11-24 at 17:45 +0100, Wolski wrote:
> Hi,
> 
> The following code generates a invalid (?) pdf file.
> 
> pdf("test.pdf")
> x <- pixmapIndexed(rep(1:8, 9), nrow=6, col=terrain.colors(8))
> plot(x)
> dev.off()
> 
> This pdf can be viewed but not printed 
> Trying to print causes to crash gv as well as acrobat windows XP


Eryk,

As with the other plot on r-help, I had no problem printing this under
FC3 using acroread.

Presumably, there is something unique to Windows here.

Marc

From ehlers at math.ucalgary.ca  Wed Nov 24 21:14:21 2004
From: ehlers at math.ucalgary.ca (P Ehlers)
Date: Wed Nov 24 21:14:08 2004
Subject: [Rd] pixmap package and pdf Device.
In-Reply-To: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>
References: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>
Message-ID: <41A4EB9D.7020900@math.ucalgary.ca>

Wolski wrote:
> Hi,
> 
> The following code generates a invalid (?) pdf file.
> 
> pdf("test.pdf")
> x <- pixmapIndexed(rep(1:8, 9), nrow=6, col=terrain.colors(8))
> plot(x)
> dev.off()
> 
> This pdf can be viewed but not printed 
> Trying to print causes to crash gv as well as acrobat windows XP
> 

I have no trouble printing this on Windows XP.
(pixmap 0.4-2)

Peter Ehlers

From stillsand at earthlink.net  Thu Nov 25 03:12:06 2004
From: stillsand at earthlink.net (Sandra Stillwater)
Date: Thu Nov 25 03:09:51 2004
Subject: [Rd] Were you trying to contact priceline.com Customer Service?
Message-ID: <002901c4d294$2a7dd960$5c20e904@oemcomputer>

I have to cancel my flight to Bangkok on December 8, 2004.  I wish to get credit for a future trip, if possible.
Thank you.
Sandra Stillwater

	[[alternative HTML version deleted]]

From ggrothendieck at myway.com  Thu Nov 25 05:38:05 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 25 05:38:17 2004
Subject: [Rd] Suggestions for packages / help / index (long mail)
References: <6.0.1.1.2.20041124134002.03108a00@stat4ux.stat.ucl.ac.be>
	<loom.20041124T150203-392@post.gmane.org>
	<6.0.1.1.2.20041124151201.03004a00@stat4ux.stat.ucl.ac.be>
Message-ID: <loom.20041125T053245-634@post.gmane.org>

Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:

: 
: At 15:06 24/11/2004, Gabor Grothendieck wrote:
: >Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:
: >
: >: 6. Final point has already been discussed in the past. It is about misc
: >: packages and pieces of code. I propose the creation of 5 packages:
: >:       - miscGraphics (keywords: misc, Graphics)
: >:       - miscStatistics (keywords: misc, Statistics)
: >:       - miscMathematics (keywords: misc, Mathematics)
: >:       - miscBasics (keywords: misc, Basics)
: >:       - miscProgramming (keywords: misc, Programming)
: >
: >Rather than preset the categories perhaps evolving them would
: >be better, just starting out with a single Misc package and then
: >decomposing it into multiple packages as the categories become
: >clear.
: 
: Those categories are taken from KEYWORDS (master entries). I guess it 
: wouldn't be difficult to still have substancial entries for those packages, 
: if some misc package maintainer would make the job to break their package 
: into pieces. BTW, I have to admit this choice is not easy to make for 
: several reasons, the main one beeing to keep the ability to modify one's 
: own contributions.
: For those packages, a collaborative plattform such as SourceForge and so 
: on, with Sync-ability, could be a good choice.
: 
: Eric

Sorry, I did not understand the keyword connection you were making.
My comment was based on the 80/20 idea that if 80% of the software
gets contributed to 20%, i.e. one of the packages, then perhaps having
5 is superfluous.  If the categories are made afterwards, rather than
before, one can construct them to esnure a more even number of routines.

From maechler at stat.math.ethz.ch  Thu Nov 25 09:45:14 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Nov 25 09:45:26 2004
Subject: (PR#7393) Re: [Rd] dhyper() does not allow non-integer values for
Message-ID: <20041125084514.AC365104CF@slim.kubism.ku.dk>

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 24 Nov 2004 18:32:15 +0100 writes:

    PD> tlumley@u.washington.edu writes:
    >> > > dhyper() does not allow non-integer values for input
    >> parameters m and n.
    >> >
    >> > this is in contrast to the other functions in the
    >> _hyper() "family",
    >> 
    >> I would argue that the bug was in the other functions. If
    >> not, there is a= =20 bug in the documentation, which
    >> gives no way to tell what the result=20 should mean for
    >> non-integer m, n, k.


    PD> My initial reaction too (and surely it is not a bug that
    PD> functions behave inconsistently in regions where they
    PD> are not documented to work at all), but on the other
    PD> hand, noninteger m,n do appear to give a well-defined
    PD> distribution, and perhaps there's a way of making sense
    PD> of it? I wouldn't think it corresponds to noncentral
    PD> hypergeometric distributions.

I'd tend to pretty much agree here.

Incidentally (slightly related, but prompted by something completely different),
just these hours I've been extending
     choose(r, k)
to work not just for integer but all positive 'n'.

Martin

From Friedrich.Leisch at tuwien.ac.at  Thu Nov 25 11:47:28 2004
From: Friedrich.Leisch at tuwien.ac.at (Friedrich.Leisch@tuwien.ac.at)
Date: Thu Nov 25 11:47:37 2004
Subject: [Rd] pixmap package and pdf Device.
In-Reply-To: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>
References: <200411241745580133.638AD1AF@mail.math.fu-berlin.de>
Message-ID: <16805.47168.129831.456001@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 24 Nov 2004 17:45:58 +0100,
>>>>> Wolski  (W) wrote:

  > Hi,
  > The following code generates a invalid (?) pdf file.

  > pdf("test.pdf")
  > x <- pixmapIndexed(rep(1:8, 9), nrow=6, col=terrain.colors(8))
  > plot(x)
  > dev.off()

  > This pdf can be viewed but not printed 
  > Trying to print causes to crash gv as well as acrobat windows XP

Works fine for me on linux.

-- 
-------------------------------------------------------------------
                        Friedrich Leisch 
Institut f?r Statistik                     Tel: (+43 1) 58801 10715
Technische Universit?t Wien                Fax: (+43 1) 58801 10798
Wiedner Hauptstra?e 8-10/1071
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch

From jennifer at zeropopup.com  Thu Nov 25 12:04:01 2004
From: jennifer at zeropopup.com (jennifer@zeropopup.com)
Date: Thu Nov 25 12:04:29 2004
Subject: [Rd] Re: Here
In-Reply-To: <200411251103.iAPB3p2j006306@addr-mx02.addr.com>
References: <200411251103.iAPB3p2j006306@addr-mx02.addr.com>
Message-ID: <200411251104.iAPB415e064812@addr20.addr.com>

This is an Autoresponder - If you need to to remove our software do this:

1- Go to the View menu on top of your Internet Explorer then >> Toolbars >> and uncheck any blank line or "tiny search bar"

2- Go to www.tinybar.com , at the bottom of the page click on 'Reset your search page back to MSN' - run this file then reboot.

From ggrothendieck at myway.com  Thu Nov 25 19:55:13 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Nov 25 19:55:29 2004
Subject: [Rd] str() resets class for environments
References: <4D99275E380CA94F998977EDACE548DC062517@extas2-hba.tas.csiro.au>
	<001c01c4d1ef$e1158790$01000001@hblaptop>
Message-ID: <loom.20041125T194910-681@post.gmane.org>

Henrik Bengtsson <hb <at> maths.lth.se> writes:

: 
: > -----Original Message-----
: > From: r-devel-bounces <at> stat.math.ethz.ch 
: > [mailto:r-devel-bounces <at> stat.math.ethz.ch] On Behalf Of 
: > Mark.Bravington <at> csiro.au
: > Sent: Wednesday, November 24, 2004 1:43 AM
: > To: hb <at> maths.lth.se
: > Cc: r-devel <at> stat.math.ethz.ch
: > Subject: RE: [Rd] str() resets class for environments
: > 
: > 
: > Henrik Bengtsson wrote:
: > 
: > > Should attr()<-, attributes()<-,
: > > class()<- give an error when applied to an environment? I see
: > > no reason why
: > > not.
: > 
: > It would break the workspace-organization code in the 
: > 'mvbutils' package, which relies on being able to set and 
: > unset attributes of environments on the search path 
: > (specifically, the 'name' and 'path' attributes).
: > 
: > So personally I'd much prefer not to have this happen! For 
: > the wider R community, I'm not sure how many users the 
: > 'mvbutils' package has, but I think it's a fair number 
: > judging from emails I get. 
: > 
: > If you do feel the extra security is vitally important, 
: > perhaps there could be 'lock.attributes' and 
: > 'unlock.attributes' functions for environments. The idea 
: > would be that each environment has an invisible (i.e. 
: > internal) mock-attribute "locked", which would be TRUE by 
: > default (on creation of the environment). While "locked" is 
: > TRUE, any attempt to muck about with the environment's 
: > attributes would cause an error. But if you really did need 
: > to change attributes of that , it would still be possible by 
: > calling 'unlock.attributes' first.
: 
: Then I agree with you that it should not be made defunct; in general, if
: there is a rational for using a feature in R and if someone relies on it,
: then I believe one should be careful and consider alternatives before
: removing it. I hope I did not break your code now by bringing it up to the R
: core team.
: 
: I am curious though, do you not run into problems by setting and getting
: attributes on environment in 'mvbutils'? The example of John Chambers I
: re-posted, which shows that attributes can (will?) get "killed by operating
: on the [environment] object "locally" in a function", suggests that you
: will.
: 

The Chambers example simply shows what can happen now -- not what should
happen.  The real question is what should happen.    If all objects
can have classes and attributes and if environments are objects then
it follows that environments should be able to have classes and
attributes too.  If the language is to be made irregular in this
respect then there needs to be a very good reason and none has
been put forth, at least in this thread.

From p.dalgaard at biostat.ku.dk  Thu Nov 25 22:12:39 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Nov 25 22:14:54 2004
Subject: [Rd] str() resets class for environments
In-Reply-To: <loom.20041125T194910-681@post.gmane.org>
References: <4D99275E380CA94F998977EDACE548DC062517@extas2-hba.tas.csiro.au>
	<001c01c4d1ef$e1158790$01000001@hblaptop>
	<loom.20041125T194910-681@post.gmane.org>
Message-ID: <x2pt21ab08.fsf@biostat.ku.dk>

Gabor Grothendieck <ggrothendieck@myway.com> writes:

> : I am curious though, do you not run into problems by setting and getting
> : attributes on environment in 'mvbutils'? The example of John Chambers I
> : re-posted, which shows that attributes can (will?) get "killed by operating
> : on the [environment] object "locally" in a function", suggests that you
> : will.
> : 
> 
> The Chambers example simply shows what can happen now -- not what should
> happen.  The real question is what should happen.    If all objects
> can have classes and attributes and if environments are objects then
> it follows that environments should be able to have classes and
> attributes too.  If the language is to be made irregular in this
> respect then there needs to be a very good reason and none has
> been put forth, at least in this thread.

Environments are already irregular in that they are never duplicated
(which is what causes these issues in the first place). External
pointers have the same feature, and Luke Tierney has suggested that
they perhaps should be wrapped in an object with more normal
semantics. Perhaps we should consider doing likewise with
environments? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From vograno at evafunds.com  Fri Nov 26 00:31:07 2004
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Fri Nov 26 00:31:05 2004
Subject: [Rd] Lightweight data frame class
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A5751663@phost015.EVAFUNDS.intermedia.net>

Hi,
 
As far as I can tell data.frame class adds two features to those of
lists:
* matrix structure via [,] and [,]<- operators  (well, I know these are
actually "["(i, j, ...), not "[,]"). 
* row names attribute.
 
It seems that the overhead of the support for the row names, both
computational and RAM-wise, is rather non-trivial. I frequently
subscript from a data.frame, i.e. use [,] on data frames, and my timing
shows that the equivalent list operation is about 7 times faster, see
below.
 
On the other hand, at least in my usage pattern, I really rarely benefit
from the row names attribute, so as far as I am concerned row names is
just an overhead. (Of course the speed difference may be due to other
factors, the only thing I can tell is that subscripting is very slow in
data frames relative to in lists).
 
I thought of writing a new class, say lightweight.data.frame, that would
be polymorphic with the existing data.frame class. The class would
inherit from "list" and implement [,], [,]<- operators. It would also
implement the "rownames" function that would return seq(nrow(x)), etc.
It should also implement as.data.frame to avoid the overhead of
conversion to a full-blown data.frame in calls like lm(y ~ x,
data=myLightweightDataframe).
 
Has anyone thought of this? Can you see any potential problems?
 
Thanks,
Vadim
 
 
 
P.S. These are the timing results comparing data.frame operations to
those of lists

# make a 1e6 * 5 list
> system.time(x <- lapply(seq(5), function(x) rnorm(1e6)))
[1] 4.46 0.10 4.57 0.00 0.00
# convert it to a data.frame
> system.time(y <- as.data.frame(x))
[1] 49.17  1.25 50.61  0.00  0.00
# do an equivalent of x[-1,] on the list
> i <- seq(2, nrow(y)); system.time(x.sub <- lapply(x, function(x)
x[i]))
[1] 0.19 0.15 0.35 0.00 0.00
# do an equivalent of x[-1,] on the data.frame
> i <- seq(2, nrow(y)); system.time(y.sub <- y[i,])
[1] 2.08 0.56 2.64 0.00 0.00
> 2.64/0.35
[1] 7.542857

From ggrothendieck at myway.com  Fri Nov 26 01:45:18 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Fri Nov 26 01:45:32 2004
Subject: [Rd] str() resets class for environments
References: <4D99275E380CA94F998977EDACE548DC062517@extas2-hba.tas.csiro.au>
	<001c01c4d1ef$e1158790$01000001@hblaptop>
	<loom.20041125T194910-681@post.gmane.org>
	<x2pt21ab08.fsf@biostat.ku.dk>
Message-ID: <loom.20041126T014210-352@post.gmane.org>

Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:

: 
: Gabor Grothendieck <ggrothendieck <at> myway.com> writes:
: 
: > : I am curious though, do you not run into problems by setting and getting
: > : attributes on environment in 'mvbutils'? The example of John Chambers I
: > : re-posted, which shows that attributes can (will?) get "killed by 
operating
: > : on the [environment] object "locally" in a function", suggests that you
: > : will.
: > : 
: > 
: > The Chambers example simply shows what can happen now -- not what should
: > happen.  The real question is what should happen.    If all objects
: > can have classes and attributes and if environments are objects then
: > it follows that environments should be able to have classes and
: > attributes too.  If the language is to be made irregular in this
: > respect then there needs to be a very good reason and none has
: > been put forth, at least in this thread.
: 
: Environments are already irregular in that they are never duplicated
: (which is what causes these issues in the first place). External
: pointers have the same feature, and Luke Tierney has suggested that
: they perhaps should be wrapped in an object with more normal
: semantics. Perhaps we should consider doing likewise with
: environments? 

To me that would make sense in keeping the rules of the language
more consistent.  The mvbutils example suggests that it also has
uses in addition to regularity and additional ones may come to
light too.

From Mark.Bravington at csiro.au  Fri Nov 26 02:16:42 2004
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Fri Nov 26 02:16:55 2004
Subject: [Rd] str() resets class for environments
Message-ID: <4D99275E380CA94F998977EDACE548DC062521@extas2-hba.tas.csiro.au>

> : Henrik Bengtsson:
> : > : I am curious though, do you not run into problems by 
> setting and getting
> : > : attributes on environment in 'mvbutils'? The example of 
> John Chambers I
> : > : re-posted, which shows that attributes can (will?) get 
> "killed by 
> operating
> : > : on the [environment] object "locally" in a function", 
> suggests that you
> : > : will.
> : > : 
> : > 

In my code, I do want to permanently set the "global" attributes of an environment such as pos.to.env(1) from within a function, so the behaviour of [in effect] 'attr<-.env' is not at all problematic :)

[In old versions of R, I used to have to invoke a function called 'lib.fixup' after setting an attribute of a search path environment, to make sure it "really happened", but this has been unnecessary in recent versions.]

> :Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:
> : Environments are already irregular in that they are never duplicated
> : (which is what causes these issues in the first place). External
> : pointers have the same feature, and Luke Tierney has suggested that
> : they perhaps should be wrapped in an object with more normal
> : semantics. Perhaps we should consider doing likewise with
> : environments? 
> 
> Gabor Grothendieck <ggrothendieck <at> myway.com> writes:
> To me that would make sense in keeping the rules of the language
> more consistent.  The mvbutils example suggests that it also has
> uses in addition to regularity and additional ones may come to
> light too.
> 

If environments were wrapped, would it still be possible to change the attributes of e.g. pos.to.env (5), as opposed to the attributes of a copy? That's the feature I'm keen to retain. For example:

> e5 <- pos.to.env( 5)
> attr( e5, 'my.attr') <- 'whatever'
> # If 'e5' is a wrapper, then this will no longer change the attribute of 'pos.to.env( 5)'
> attr( pos.to.env( 5), 'my.attr')
NULL
> # So I would need to be able to do something ugly like this:
> pos.to.env( 5) <- e5  # Yuk!?

Wrapping environments does avoid the "top level" of nonduplication, but the deeper level of nonduplicating the contents is unavoidable (and that's the point, of course): 

> pos.to.env(5)$x
NULL
> e5$x <- 0
> pos.to.env(5)$x
[1] 0

So I'm not sure all this can ever be made entirely "clean", even if automatic wrapping did get used. Equally, though, I'm not sure I've correctly understood the intention.

Incidentally, 'pos.to.env(5)$x <- 0' results in "Error: Target of assignment expands to non-language object". Should I have expected that?

BTW sorry about Outlook's mangling of the lines & indents-- at least, I presume it's Outlook's fault.

Mark

> > *******************************
> > 
> > Mark Bravington
> > CSIRO (CMIS)
> > PO Box 1538
> > Castray Esplanade
> > Hobart
> > TAS 7001
> > 
> > phone (61) 3 6232 5118
> > fax (61) 3 6232 5012
> > Mark.Bravington@csiro.au
> >

From ggrothendieck at myway.com  Fri Nov 26 04:12:37 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Fri Nov 26 04:12:51 2004
Subject: [Rd] str() resets class for environments
References: <4D99275E380CA94F998977EDACE548DC062521@extas2-hba.tas.csiro.au>
Message-ID: <loom.20041126T035256-508@post.gmane.org>

 <Mark.Bravington <at> csiro.au> writes:

: 
: > : Henrik Bengtsson:
: > : > : I am curious though, do you not run into problems by 
: > setting and getting
: > : > : attributes on environment in 'mvbutils'? The example of 
: > John Chambers I
: > : > : re-posted, which shows that attributes can (will?) get 
: > "killed by 
: > operating
: > : > : on the [environment] object "locally" in a function", 
: > suggests that you
: > : > : will.
: > : > : 
: > : > 
: 
: In my code, I do want to permanently set the "global" attributes of an 
environment such as pos.to.env(1)
: from within a function, so the behaviour of [in effect] 'attr<-.env' is not 
at all problematic :)
: 
: [In old versions of R, I used to have to invoke a function 
called 'lib.fixup' after setting an attribute of a
: search path environment, to make sure it "really happened", but this has 
been unnecessary in recent versions.]
: 
: > :Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:
: > : Environments are already irregular in that they are never duplicated
: > : (which is what causes these issues in the first place). External
: > : pointers have the same feature, and Luke Tierney has suggested that
: > : they perhaps should be wrapped in an object with more normal
: > : semantics. Perhaps we should consider doing likewise with
: > : environments? 
: > 
: > Gabor Grothendieck <ggrothendieck <at> myway.com> writes:
: > To me that would make sense in keeping the rules of the language
: > more consistent.  The mvbutils example suggests that it also has
: > uses in addition to regularity and additional ones may come to
: > light too.
: > 
: 
: If environments were wrapped, would it still be possible to change the 
attributes of e.g. pos.to.env (5),
: as opposed to the attributes of a copy? That's the feature I'm keen to 
retain. For example:
: 
: > e5 <- pos.to.env( 5)
: > attr( e5, 'my.attr') <- 'whatever'
: > # If 'e5' is a wrapper, then this will no longer change the attribute 
of 'pos.to.env( 5)'
: > attr( pos.to.env( 5), 'my.attr')
: NULL
: > # So I would need to be able to do something ugly like this:
: > pos.to.env( 5) <- e5  # Yuk!?
: 
: Wrapping environments does avoid the "top level" of nonduplication, but the 
deeper level of
: nonduplicating the contents is unavoidable (and that's the point, of 
course): 
: 
: > pos.to.env(5)$x
: NULL
: > e5$x <- 0
: > pos.to.env(5)$x
: [1] 0
: 
: So I'm not sure all this can ever be made entirely "clean", even if 
automatic wrapping did get used. Equally,
: though, I'm not sure I've correctly understood the intention.


I don't know what the right answer should be but right now
if e1 == e2 for two environments then those environments are 
the same since environments are just pointers.

1. If attributes and classes were somehow stored in the 
environment itself (which is what you are looking for
I think) then the above condition would also
be sufficient to guarantee that they have the same class
and attributes.

2. If attributes and classes are associated with a wrapper
then equality requires that the underlying environments
are the same and also requires that the classes and
attributes of the two wrappers be the same.

Both these viewpoints have a certain sense to them in
that the first is more R-like but the second is
more environment-like.

3. The current situation where environments cannot
have classes and attributes does have the advantage
that one need not decide between the two approaches.

I guess I am arguing, in part, against what I said
before but in thinking about this more I realize
that all three viewpoints seem to have some merit
and its actually quite difficult to choose.

From ggrothendieck at myway.com  Fri Nov 26 04:42:10 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Fri Nov 26 04:42:23 2004
Subject: [Rd] Lightweight data frame class
References: <C698D707214E6F4AB39AB7096C3DE5A5751663@phost015.EVAFUNDS.intermedia.net>
Message-ID: <loom.20041126T042044-876@post.gmane.org>

Vadim Ogranovich <vograno <at> evafunds.com> writes:

: 
: Hi,
: 
: As far as I can tell data.frame class adds two features to those of
: lists:
: * matrix structure via [,] and [,]<- operators  (well, I know these are
: actually "["(i, j, ...), not "[,]"). 
: * row names attribute.
: 
: It seems that the overhead of the support for the row names, both
: computational and RAM-wise, is rather non-trivial. I frequently
: subscript from a data.frame, i.e. use [,] on data frames, and my timing
: shows that the equivalent list operation is about 7 times faster, see
: below.
: 
: On the other hand, at least in my usage pattern, I really rarely benefit
: from the row names attribute, so as far as I am concerned row names is
: just an overhead. (Of course the speed difference may be due to other
: factors, the only thing I can tell is that subscripting is very slow in
: data frames relative to in lists).
: 
: I thought of writing a new class, say lightweight.data.frame, that would
: be polymorphic with the existing data.frame class. The class would
: inherit from "list" and implement [,], [,]<- operators. It would also
: implement the "rownames" function that would return seq(nrow(x)), etc.
: It should also implement as.data.frame to avoid the overhead of
: conversion to a full-blown data.frame in calls like lm(y ~ x,
: data=myLightweightDataframe).

The next version of zoo (currently in 
test) supports lists in the data argument of lm
and can also merge zoo series into a list (or
to another zoo series, as it does now).
Would that be a sufficient alternative?

From edd at debian.org  Fri Nov 26 06:26:51 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri Nov 26 06:27:00 2004
Subject: Update Ggobi and Rggobi in Debian (Was: [Rd] R-2.0.1 and Rggobi)
In-Reply-To: <20041124143221.GA22104@sonny.eddelbuettel.com>
References: <41A3F7EC.2000006@csiro.au>
	<20041124034542.GA16830@sonny.eddelbuettel.com>
	<41A4104B.6020102@csiro.au>
	<Pine.LNX.4.61.0411240546110.4979@gannet.stats>
	<1abe3fa90411232214fec3fd0@mail.gmail.com>
	<20041124143221.GA22104@sonny.eddelbuettel.com>
Message-ID: <20041126052650.GA8517@sonny.eddelbuettel.com>

On Wed, Nov 24, 2004 at 08:32:21AM -0600, Dirk Eddelbuettel wrote:
> On Wed, Nov 24, 2004 at 07:14:10AM +0100, A.J. Rossini wrote:
> > Brian is correct regarding the lists, but note that Rggobi 1.1 works
> > for me (Duncan T-L sent me the following link which worked for me on
> > an old R-H or SuSE system (sorry Dirk!  not had a chance to change it
> > yet...).
> > 
> > " Try the tar file at
> >     http://www.ggobi.org/Download/Rggobi_1.1-0.tar.gz
> > "
> 
> Very good, so my sometimes Quixotic attempts at getting more of DTL's code
> into Debian, Quantian, ... shall see another round of battling. News at 11.

New packages have just been upload into Debian's master archive. These are
Ggobi 1.0-1-beta (which I renamed 0.99.99 so that a future 1.0.0 sorts
higher for dpkg) and Rggobi 1.1-1.  Both needed some minor fudging as
documented in the changelogs included below. 

Dirk


ggobi (0.99.99-1) unstable; urgency=low

  * New upstream release 
  * Upstream version 1.0-1-beta renamed 0.99.99 to permit a 1.0.0 package
  * Upstream configure files and built system are somewhat broken with 
    respect to the plugin architecture -- we have been unable to build
    this for the last few beta releases. Consquently, plugins for 
    - Postgres
    - Dataviewer
    - Fileselector
    - Ggvis
    have been disabled by brute force via a patch to configure.in.
  * Consequently, removed the enties for libmysqlclient-dev, python-dev, 
    postgresql-dev from Build-Depends 
  * debian/control: Standards-Version increased to 3.6.1.1
      
 -- Dirk Eddelbuettel <edd@debian.org>  Thu, 25 Nov 2004 21:27:38 -0600
 
 
 
rggobi (1.1.1-1) unstable; urgency=low

  * New upstream release
  
  * src/Makevars.in: As ggobi's ggobi-config would appears to be broken, 
    we added explicit statements '-I/usr/lib/ggobi/include' to PKG_CPPFLAGS 
    and '-L/usr/lib/ggobi/lib' to PKG_LIBS
  * R/GGobiHome.S: Dito, setting '/usr/lib/ggobi'
      
  * Built under R 2.0.*
  * debian/control: Updated Build-Depends: and Depends: accordingly
  * debian/post{inst,rm}: Only run build-help.pl if R is installed
  * debian/watch: Added watch file
     
 -- Dirk Eddelbuettel <edd@debian.org>  Thu, 25 Nov 2004 22:32:10 -0600

 

-- 
If your hair is standing up, then you are in extreme danger.
      -- http://www.usafa.af.mil/dfp/cockpit-phys/fp1ex3.htm

From p.dalgaard at biostat.ku.dk  Fri Nov 26 09:28:51 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Nov 26 09:31:08 2004
Subject: [Rd] str() resets class for environments
In-Reply-To: <4D99275E380CA94F998977EDACE548DC062521@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC062521@extas2-hba.tas.csiro.au>
Message-ID: <x2ekihui7w.fsf@biostat.ku.dk>

<Mark.Bravington@csiro.au> writes:

> If environments were wrapped, would it still be possible to change
> the attributes of e.g. pos.to.env (5), as opposed to the attributes
> of a copy? That's the feature I'm keen to retain. For example:

Offhand: Yes, if things are arranged so that you set attributes on the
elements of the search path rather than on the environments
"themselves". This could also be useful if we were to ever make an
effort to bring the semantics of detach() in line with its
documentation...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From gregor.gorjanc at bfro.uni-lj.si  Fri Nov 26 11:25:11 2004
From: gregor.gorjanc at bfro.uni-lj.si (Gregor GORJANC)
Date: Fri Nov 26 10:26:48 2004
Subject: [Rd] Modes again
Message-ID: <41A70487.3030502@bfro.uni-lj.si>

Hello!

I write once more. I slightly modified your code Ross and now it returns 
all modes from the distribution. I changed the name of the funtion to 
distinguish the difference. I do not like the name simpleMode, however 
mode is already taken by another function (The (Storage) Mode of an Object).

It would be nice to have some additional options for number of 
observations in modes, however this is above my current programming 
skills in R. I don't like the use of cat for returning the result. That 
is the reason I am sending this mail also to R-devel list. Maybe anybody 
there can solve the issue. Quite some users asked for mode calculation 
function and it would really nice to have it in R by default.

modus <- function (x) {

     # Returns the modes of a value set
     # Based on Ross NELSONs code from 2004-11-16 (on R-help mailling list)

     # create a table with the values sorted by frequency
     sortvar <- sort(table(x))
     # get the max frequency
     maxfreq <- max(sortvar)
     # find values with high frequency
     modeTable <- which(sortvar == maxfreq)
     # get the name (value) of the most frequent value
     themoderesult <- names(modeTable)
     # Report
     return(themoderesult)

     # data(CO2)
     # modus(CO2$uptake)
     # rm(CO2)

}

-- 
Lep pozdrav / With regards / Con respeto,
     Gregor GORJANC

---------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty       URI: http://www.bfro.uni-lj.si
Zootechnical Department    mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                  tel: +386 (0)1 72 17 861
SI-1230 Domzale            fax: +386 (0)1 72 41 005
Slovenia

From markus.helbig at student.uni-augsburg.de  Fri Nov 26 17:12:13 2004
From: markus.helbig at student.uni-augsburg.de (Markus Helbig)
Date: Fri Nov 26 17:09:31 2004
Subject: [Rd] Cross-compiling R for Windows on linux
Message-ID: <200411261712.13391.markus.helbig@student.uni-augsburg.de>

I tried to cross-compile the newest release 2.0.1 on a linux machine, but i 
always got an error at the following stage

DHAVE_CONFIG_H -DR_DLL_BUILD  -c dynload.c -o dynload.o
dynload.c: In function `R_loadLibrary':
dynload.c:94: warning: implicit declaration of function `_controlfp'
dynload.c:94: error: `_MCW_IC' undeclared (first use in this function)
dynload.c:94: error: (Each undeclared identifier is reported only once
dynload.c:94: error: for each function it appears in.)
dynload.c:95: warning: implicit declaration of function `_clearfp'
dynload.c:99: error: `_MCW_EM' undeclared (first use in this function)
dynload.c:99: error: `_MCW_RC' undeclared (first use in this function)
dynload.c:99: error: `_MCW_PC' undeclared (first use in this function)
make[4]: *** [dynload.o] Error 1
make[3]: *** [../../bin/R.dll] Error 2
make[2]: *** [rbuild] Error 2
make[1]: *** [all] Error 2
make[1]: Leaving directory `/home/markus/Development/r-project/WinR/R-2.0.1/
src/gnuwin32'

Anybody knows what do to now?

-- 
Markus Helbig
--------------------------------------------

Bahnhofstrasse 21
86492 Egling
Germany

markus.helbig@student.uni-augsburg.de
--------------------------------------------
http://www.rosuda.org/staff/helbig

From roger at ysidro.econ.uiuc.edu  Fri Nov 26 18:50:33 2004
From: roger at ysidro.econ.uiuc.edu (roger koenker)
Date: Fri Nov 26 18:50:47 2004
Subject: [Rd] Namespaces, coercion and setAs
Message-ID: <AB6CEF9E-3FD3-11D9-9DB8-000393A361A2@ysidro.econ.uiuc.edu>

I'm trying to resolve a small problem that has arisen from introducing a
NAMESPACE for the package SparseM.  Prior to the namespace I had
a class "matrix.diag.csr" that consisted of diagonal sparse matrices.  
It
was defined to have the same attributes as the matrix.csr class and 
setAs
was used to define how to coerce integers and vectors into this form:

setClass("matrix.diag.csr","matrix.csr")

setAs("numeric","matrix.diag.csr",function(from){
         if(length(from)==1){
                 n <- as.integer(from)
                 if(n>0) from  <-  rep(1,n)
                 else stop("Sparse identity matrices must have positive, 
integer dimension")
                 }
         else n <- length(from)
         return(new("matrix.diag.csr", ra = from ,ja = as.integer(1:n),
                 ia = as.integer(1:(n+1)), dimension = 
as.integer(c(n,n))))
         })

This seemed to be fine.   I could do,

	A  <- as(5,"matrix.diag.csr")

and A would be a 5x5 identity matrix in sparse form.  But post-namespace
I get:

 >A <-  as(5,"matrix.diag.csr")
Error in as(5, "matrix.diag.csr") : No method or default for coercing 
"numeric" to "matrix.diag.csr"

so apparently using exportClass(matrix.diag.csr)  isn't sufficient for 
coerce to know what to do.
Using findClass("matrix.diag.csr") indicates that the class is 
recognized to be from SparseM,
so my question is:  is there some mechanism that I'm missing in the 
NAMESPACE scheme
that would enable my old setAs() directive to work, or is there some 
other suggestion on how
to proceed?


url:	www.econ.uiuc.edu/~roger        	Roger Koenker
email	rkoenker@uiuc.edu			Department of Economics
vox: 	217-333-4558				University of Illinois
fax:   	217-244-6678				Champaign, IL 61820

From Roger.Bivand at nhh.no  Fri Nov 26 19:29:29 2004
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri Nov 26 19:29:45 2004
Subject: [Rd] Namespaces, coercion and setAs
In-Reply-To: <AB6CEF9E-3FD3-11D9-9DB8-000393A361A2@ysidro.econ.uiuc.edu>
Message-ID: <Pine.LNX.4.44.0411261922360.7240-100000@reclus.nhh.no>

On Fri, 26 Nov 2004, roger koenker wrote:

> I'm trying to resolve a small problem that has arisen from introducing a
> NAMESPACE for the package SparseM.  Prior to the namespace I had a class
> "matrix.diag.csr" that consisted of diagonal sparse matrices.  It was
> defined to have the same attributes as the matrix.csr class and setAs
> was used to define how to coerce integers and vectors into this form:
> 
> setClass("matrix.diag.csr","matrix.csr")
> 
> setAs("numeric","matrix.diag.csr",function(from){
>          if(length(from)==1){
>                  n <- as.integer(from)
>                  if(n>0) from  <-  rep(1,n)
>                  else stop("Sparse identity matrices must have positive, 
> integer dimension")
>                  }
>          else n <- length(from)
>          return(new("matrix.diag.csr", ra = from ,ja = as.integer(1:n),
>                  ia = as.integer(1:(n+1)), dimension = 
> as.integer(c(n,n))))
>          })
> 
> This seemed to be fine.   I could do,
> 
> 	A  <- as(5,"matrix.diag.csr")
> 
> and A would be a 5x5 identity matrix in sparse form.  But post-namespace
> I get:
> 
>  >A <- as(5,"matrix.diag.csr") Error in as(5, "matrix.diag.csr") : No
> method or default for coercing "numeric" to "matrix.diag.csr"
> 
> so apparently using exportClass(matrix.diag.csr)  isn't sufficient for
> coerce to know what to do. Using findClass("matrix.diag.csr") indicates
> that the class is recognized to be from SparseM, so my question is:  is
> there some mechanism that I'm missing in the NAMESPACE scheme that would
> enable my old setAs() directive to work, or is there some other
> suggestion on how to proceed?

I'm far from sure about this, but is "coerce" one of the exported methods? 
I'm having the same difficulty in retrofitting a NAMESPACE to the 
forthcoming sp package of spatial classes, for S4 classes. 

I see from src/library/methods/NAMESPACE that as and coerce are exported 
from there - should a package with a NAMESPACE and S4 classes do 

import(methods) ?

Roger

> 
> 
> url:	www.econ.uiuc.edu/~roger        	Roger Koenker
> email	rkoenker@uiuc.edu			Department of Economics
> vox: 	217-333-4558				University of Illinois
> fax:   	217-244-6678				Champaign, IL 61820
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
e-mail: Roger.Bivand@nhh.no

From roger at ysidro.econ.uiuc.edu  Fri Nov 26 19:41:59 2004
From: roger at ysidro.econ.uiuc.edu (roger koenker)
Date: Fri Nov 26 19:42:08 2004
Subject: [Rd] Namespaces, coercion and setAs
In-Reply-To: <Pine.LNX.4.44.0411261922360.7240-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0411261922360.7240-100000@reclus.nhh.no>
Message-ID: <DAFB50C4-3FDA-11D9-9DB8-000393A361A2@ysidro.econ.uiuc.edu>

Absolutely correct.  Adding coerce to the NAMESPACE list of 
exportMethods
resolves the problem.  Leaves only the mildly mysterious

Undocumented S4 methods:
   generic coerce and siglist numeric,matrix.diag.csr
All user-level objects in a package (including S4 classes and methods)
should have documentation entries.

to clean up.  Thanks very much!!

Roger

On Nov 26, 2004, at 12:29 PM, Roger Bivand wrote:

> On Fri, 26 Nov 2004, roger koenker wrote:
>
>> I'm trying to resolve a small problem that has arisen from 
>> introducing a
>> NAMESPACE for the package SparseM.  Prior to the namespace I had a 
>> class
>> "matrix.diag.csr" that consisted of diagonal sparse matrices.  It was
>> defined to have the same attributes as the matrix.csr class and setAs
>> was used to define how to coerce integers and vectors into this form:
>>
>> setClass("matrix.diag.csr","matrix.csr")
>>
>> setAs("numeric","matrix.diag.csr",function(from){
>>          if(length(from)==1){
>>                  n <- as.integer(from)
>>                  if(n>0) from  <-  rep(1,n)
>>                  else stop("Sparse identity matrices must have 
>> positive,
>> integer dimension")
>>                  }
>>          else n <- length(from)
>>          return(new("matrix.diag.csr", ra = from ,ja = 
>> as.integer(1:n),
>>                  ia = as.integer(1:(n+1)), dimension =
>> as.integer(c(n,n))))
>>          })
>>
>> This seemed to be fine.   I could do,
>>
>> 	A  <- as(5,"matrix.diag.csr")
>>
>> and A would be a 5x5 identity matrix in sparse form.  But 
>> post-namespace
>> I get:
>>
>>> A <- as(5,"matrix.diag.csr") Error in as(5, "matrix.diag.csr") : No
>> method or default for coercing "numeric" to "matrix.diag.csr"
>>
>> so apparently using exportClass(matrix.diag.csr)  isn't sufficient for
>> coerce to know what to do. Using findClass("matrix.diag.csr") 
>> indicates
>> that the class is recognized to be from SparseM, so my question is:  
>> is
>> there some mechanism that I'm missing in the NAMESPACE scheme that 
>> would
>> enable my old setAs() directive to work, or is there some other
>> suggestion on how to proceed?
>
> I'm far from sure about this, but is "coerce" one of the exported 
> methods?
> I'm having the same difficulty in retrofitting a NAMESPACE to the
> forthcoming sp package of spatial classes, for S4 classes.
>
> I see from src/library/methods/NAMESPACE that as and coerce are 
> exported
> from there - should a package with a NAMESPACE and S4 classes do
>
> import(methods) ?
>
> Roger
>
>>
>>
>> url:	www.econ.uiuc.edu/~roger        	Roger Koenker
>> email	rkoenker@uiuc.edu			Department of Economics
>> vox: 	217-333-4558				University of Illinois
>> fax:   	217-244-6678				Champaign, IL 61820
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School 
> of
> Economics and Business Administration, Breiviksveien 40, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
> e-mail: Roger.Bivand@nhh.no
>

From vograno at evafunds.com  Fri Nov 26 23:01:36 2004
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Fri Nov 26 23:01:31 2004
Subject: [Rd] Lightweight data frame class
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A575168B@phost015.EVAFUNDS.intermedia.net>

Don't know whether it will suffice. Lm() was just an example. Are you
going to re-write lm(), e.g. lm.zoo(), to accept lists?
I am more thinking of a general purpose class that would pass wherever
data.frame is expected.

Probably I need to wait until the new version of zoo comes out. At the
very least it could be a good prototype for what I have in mind.

Thanks for the info,
Vadim

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Gabor 
> Grothendieck
> Sent: Thursday, November 25, 2004 7:42 PM
> To: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] Lightweight data frame class
> 
> Vadim Ogranovich <vograno <at> evafunds.com> writes:
> 
> : 
> : Hi,
> : 
> : As far as I can tell data.frame class adds two features to those of
> : lists:
> : * matrix structure via [,] and [,]<- operators  (well, I 
> know these are
> : actually "["(i, j, ...), not "[,]"). 
> : * row names attribute.
> : 
> : It seems that the overhead of the support for the row names, both
> : computational and RAM-wise, is rather non-trivial. I frequently
> : subscript from a data.frame, i.e. use [,] on data frames, 
> and my timing
> : shows that the equivalent list operation is about 7 times 
> faster, see
> : below.
> : 
> : On the other hand, at least in my usage pattern, I really 
> rarely benefit
> : from the row names attribute, so as far as I am concerned 
> row names is
> : just an overhead. (Of course the speed difference may be 
> due to other
> : factors, the only thing I can tell is that subscripting is 
> very slow in
> : data frames relative to in lists).
> : 
> : I thought of writing a new class, say 
> lightweight.data.frame, that would
> : be polymorphic with the existing data.frame class. The class would
> : inherit from "list" and implement [,], [,]<- operators. It 
> would also
> : implement the "rownames" function that would return 
> seq(nrow(x)), etc.
> : It should also implement as.data.frame to avoid the overhead of
> : conversion to a full-blown data.frame in calls like lm(y ~ x,
> : data=myLightweightDataframe).
> 
> The next version of zoo (currently in
> test) supports lists in the data argument of lm and can also 
> merge zoo series into a list (or to another zoo series, as it 
> does now).
> Would that be a sufficient alternative?
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ggrothendieck at myway.com  Sat Nov 27 00:41:47 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Nov 27 00:42:10 2004
Subject: [Rd] Lightweight data frame class
References: <C698D707214E6F4AB39AB7096C3DE5A575168B@phost015.EVAFUNDS.intermedia.net>
Message-ID: <loom.20041127T002311-597@post.gmane.org>

Vadim Ogranovich <vograno <at> evafunds.com> writes:

: 
: Don't know whether it will suffice. Lm() was just an example. Are you
: going to re-write lm(), e.g. lm.zoo(), to accept lists?

A previous unreleased version of zoo did hack lm but the current test
version interfaces to lm without making any changes to lm at all.  

: I am more thinking of a general purpose class that would pass wherever
: data.frame is expected.

Yes, I figured so.  The lightweight data frame idea seems neat 
but thought I would mention this, in addition, in case its germane.

: 
: Probably I need to wait until the new version of zoo comes out. At the
: very least it could be a good prototype for what I have in mind.

If you want it before then contact me offlist and I can send you 
the beta test version.

: 
: Thanks for the info,
: Vadim
: 
: > -----Original Message-----
: > From: r-devel-bounces <at> stat.math.ethz.ch 
: > [mailto:r-devel-bounces <at> stat.math.ethz.ch] On Behalf Of Gabor 
: > Grothendieck
: > Sent: Thursday, November 25, 2004 7:42 PM
: > To: r-devel <at> stat.math.ethz.ch
: > Subject: Re: [Rd] Lightweight data frame class
: > 
: > Vadim Ogranovich <vograno <at> evafunds.com> writes:
: > 
: > : 
: > : Hi,
: > : 
: > : As far as I can tell data.frame class adds two features to those of
: > : lists:
: > : * matrix structure via [,] and [,]<- operators  (well, I 
: > know these are
: > : actually "["(i, j, ...), not "[,]"). 
: > : * row names attribute.
: > : 
: > : It seems that the overhead of the support for the row names, both
: > : computational and RAM-wise, is rather non-trivial. I frequently
: > : subscript from a data.frame, i.e. use [,] on data frames, 
: > and my timing
: > : shows that the equivalent list operation is about 7 times 
: > faster, see
: > : below.
: > : 
: > : On the other hand, at least in my usage pattern, I really 
: > rarely benefit
: > : from the row names attribute, so as far as I am concerned 
: > row names is
: > : just an overhead. (Of course the speed difference may be 
: > due to other
: > : factors, the only thing I can tell is that subscripting is 
: > very slow in
: > : data frames relative to in lists).
: > : 
: > : I thought of writing a new class, say 
: > lightweight.data.frame, that would
: > : be polymorphic with the existing data.frame class. The class would
: > : inherit from "list" and implement [,], [,]<- operators. It 
: > would also
: > : implement the "rownames" function that would return 
: > seq(nrow(x)), etc.
: > : It should also implement as.data.frame to avoid the overhead of
: > : conversion to a full-blown data.frame in calls like lm(y ~ x,
: > : data=myLightweightDataframe).
: > 
: > The next version of zoo (currently in
: > test) supports lists in the data argument of lm and can also 
: > merge zoo series into a list (or to another zoo series, as it 
: > does now).
: > Would that be a sufficient alternative?
: > 
: > ______________________________________________
: > R-devel <at> stat.math.ethz.ch mailing list
: > https://stat.ethz.ch/mailman/listinfo/r-devel
: >
: 
: ______________________________________________
: R-devel <at> stat.math.ethz.ch mailing list
: https://stat.ethz.ch/mailman/listinfo/r-devel
: 
:

From Matthias.Kohl at uni-bayreuth.de  Sat Nov 27 11:11:38 2004
From: Matthias.Kohl at uni-bayreuth.de (Matthias.Kohl@uni-bayreuth.de)
Date: Sat Nov 27 11:11:43 2004
Subject: [Rd] Namespaces, coercion and setAs
In-Reply-To: <DAFB50C4-3FDA-11D9-9DB8-000393A361A2@ysidro.econ.uiuc.edu>
References: <Pine.LNX.4.44.0411261922360.7240-100000@reclus.nhh.no>
	<DAFB50C4-3FDA-11D9-9DB8-000393A361A2@ysidro.econ.uiuc.edu>
Message-ID: <1059.132.180.246.92.1101550298.squirrel@mail.uni-bayreuth.de>

Hello,

does adding the line

\alias{coerce,numeric,matrix.diag.csr-method}

to the Rd-file of your "matrix.diag.csr" class solve the mysterium?

Matthias


> Absolutely correct.  Adding coerce to the NAMESPACE list of
> exportMethods
> resolves the problem.  Leaves only the mildly mysterious
>
> Undocumented S4 methods:
>    generic coerce and siglist numeric,matrix.diag.csr
> All user-level objects in a package (including S4 classes and methods)
> should have documentation entries.
>
> to clean up.  Thanks very much!!
>
> Roger
>
> On Nov 26, 2004, at 12:29 PM, Roger Bivand wrote:
>
>> On Fri, 26 Nov 2004, roger koenker wrote:
>>
>>> I'm trying to resolve a small problem that has arisen from
>>> introducing a
>>> NAMESPACE for the package SparseM.  Prior to the namespace I had a
>>> class
>>> "matrix.diag.csr" that consisted of diagonal sparse matrices.  It was
>>> defined to have the same attributes as the matrix.csr class and setAs
>>> was used to define how to coerce integers and vectors into this form:
>>>
>>> setClass("matrix.diag.csr","matrix.csr")
>>>
>>> setAs("numeric","matrix.diag.csr",function(from){
>>>          if(length(from)==1){
>>>                  n <- as.integer(from)
>>>                  if(n>0) from  <-  rep(1,n)
>>>                  else stop("Sparse identity matrices must have
>>> positive,
>>> integer dimension")
>>>                  }
>>>          else n <- length(from)
>>>          return(new("matrix.diag.csr", ra = from ,ja =
>>> as.integer(1:n),
>>>                  ia = as.integer(1:(n+1)), dimension =
>>> as.integer(c(n,n))))
>>>          })
>>>
>>> This seemed to be fine.   I could do,
>>>
>>> 	A  <- as(5,"matrix.diag.csr")
>>>
>>> and A would be a 5x5 identity matrix in sparse form.  But
>>> post-namespace
>>> I get:
>>>
>>>> A <- as(5,"matrix.diag.csr") Error in as(5, "matrix.diag.csr") : No
>>> method or default for coercing "numeric" to "matrix.diag.csr"
>>>
>>> so apparently using exportClass(matrix.diag.csr)  isn't sufficient
>>> for coerce to know what to do. Using findClass("matrix.diag.csr")
>>> indicates
>>> that the class is recognized to be from SparseM, so my question is:
>>> is
>>> there some mechanism that I'm missing in the NAMESPACE scheme that
>>> would
>>> enable my old setAs() directive to work, or is there some other
>>> suggestion on how to proceed?
>>
>> I'm far from sure about this, but is "coerce" one of the exported
>> methods?
>> I'm having the same difficulty in retrofitting a NAMESPACE to the
>> forthcoming sp package of spatial classes, for S4 classes.
>>
>> I see from src/library/methods/NAMESPACE that as and coerce are
>> exported
>> from there - should a package with a NAMESPACE and S4 classes do
>>
>> import(methods) ?
>>
>> Roger
>>
>>>
>>>
>>> url:	www.econ.uiuc.edu/~roger        	Roger Koenker
>>> email	rkoenker@uiuc.edu			Department of Economics
>>> vox: 	217-333-4558				University of Illinois
>>> fax:   	217-244-6678				Champaign, IL 61820
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School
>> of
>> Economics and Business Administration, Breiviksveien 40, N-5045
>> Bergen, Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
>> e-mail: Roger.Bivand@nhh.no
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From roger at ysidro.econ.uiuc.edu  Sat Nov 27 17:12:00 2004
From: roger at ysidro.econ.uiuc.edu (roger koenker)
Date: Sat Nov 27 17:12:00 2004
Subject: [Rd] Namespaces, coercion and setAs
In-Reply-To: <1059.132.180.246.92.1101550298.squirrel@mail.uni-bayreuth.de>
References: <Pine.LNX.4.44.0411261922360.7240-100000@reclus.nhh.no>
	<DAFB50C4-3FDA-11D9-9DB8-000393A361A2@ysidro.econ.uiuc.edu>
	<1059.132.180.246.92.1101550298.squirrel@mail.uni-bayreuth.de>
Message-ID: <11E1CB74-408F-11D9-BBD9-000393A361A2@ysidro.econ.uiuc.edu>

Yes,  precisely.  This was done yesterday and the new version of SparseM
with NAMESPACE -- thanks again to Roger Bivand for his help with this --
should now be on CRAN.


On Nov 27, 2004, at 4:11 AM, Matthias.Kohl@uni-bayreuth.de wrote:

> Hello,
>
> does adding the line
>
> \alias{coerce,numeric,matrix.diag.csr-method}
>
> to the Rd-file of your "matrix.diag.csr" class solve the mysterium?
>
> Matthias
>
>
>> Absolutely correct.  Adding coerce to the NAMESPACE list of
>> exportMethods
>> resolves the problem.  Leaves only the mildly mysterious
>>
>> Undocumented S4 methods:
>>    generic coerce and siglist numeric,matrix.diag.csr
>> All user-level objects in a package (including S4 classes and methods)
>> should have documentation entries.
>>
>> to clean up.  Thanks very much!!
>>
>> Roger
>>
>> On Nov 26, 2004, at 12:29 PM, Roger Bivand wrote:
>>
>>> On Fri, 26 Nov 2004, roger koenker wrote:
>>>
>>>> I'm trying to resolve a small problem that has arisen from
>>>> introducing a
>>>> NAMESPACE for the package SparseM.  Prior to the namespace I had a
>>>> class
>>>> "matrix.diag.csr" that consisted of diagonal sparse matrices.  It 
>>>> was
>>>> defined to have the same attributes as the matrix.csr class and 
>>>> setAs
>>>> was used to define how to coerce integers and vectors into this 
>>>> form:
>>>>
>>>> setClass("matrix.diag.csr","matrix.csr")
>>>>
>>>> setAs("numeric","matrix.diag.csr",function(from){
>>>>          if(length(from)==1){
>>>>                  n <- as.integer(from)
>>>>                  if(n>0) from  <-  rep(1,n)
>>>>                  else stop("Sparse identity matrices must have
>>>> positive,
>>>> integer dimension")
>>>>                  }
>>>>          else n <- length(from)
>>>>          return(new("matrix.diag.csr", ra = from ,ja =
>>>> as.integer(1:n),
>>>>                  ia = as.integer(1:(n+1)), dimension =
>>>> as.integer(c(n,n))))
>>>>          })
>>>>
>>>> This seemed to be fine.   I could do,
>>>>
>>>> 	A  <- as(5,"matrix.diag.csr")
>>>>
>>>> and A would be a 5x5 identity matrix in sparse form.  But
>>>> post-namespace
>>>> I get:
>>>>
>>>>> A <- as(5,"matrix.diag.csr") Error in as(5, "matrix.diag.csr") : No
>>>> method or default for coercing "numeric" to "matrix.diag.csr"
>>>>
>>>> so apparently using exportClass(matrix.diag.csr)  isn't sufficient
>>>> for coerce to know what to do. Using findClass("matrix.diag.csr")
>>>> indicates
>>>> that the class is recognized to be from SparseM, so my question is:
>>>> is
>>>> there some mechanism that I'm missing in the NAMESPACE scheme that
>>>> would
>>>> enable my old setAs() directive to work, or is there some other
>>>> suggestion on how to proceed?
>>>
>>> I'm far from sure about this, but is "coerce" one of the exported
>>> methods?
>>> I'm having the same difficulty in retrofitting a NAMESPACE to the
>>> forthcoming sp package of spatial classes, for S4 classes.
>>>
>>> I see from src/library/methods/NAMESPACE that as and coerce are
>>> exported
>>> from there - should a package with a NAMESPACE and S4 classes do
>>>
>>> import(methods) ?
>>>
>>> Roger
>>>
>>>>
>>>>
>>>> url:	www.econ.uiuc.edu/~roger        	Roger Koenker
>>>> email	rkoenker@uiuc.edu			Department of Economics
>>>> vox: 	217-333-4558				University of Illinois
>>>> fax:   	217-244-6678				Champaign, IL 61820
>>>>
>>>> ______________________________________________
>>>> R-devel@stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School
>>> of
>>> Economics and Business Administration, Breiviksveien 40, N-5045
>>> Bergen, Norway. voice: +47 55 95 93 55; fax +47 55 95 93 93
>>> e-mail: Roger.Bivand@nhh.no
>>>
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>

From rmh at temple.edu  Sun Nov 28 05:36:08 2004
From: rmh at temple.edu (rmh@temple.edu)
Date: Sun Nov 28 05:36:21 2004
Subject: [Rd] Is this a bug in the parser? (PR#7395)
Message-ID: <20041128043608.5CB7CEAC3@slim.kubism.ku.dk>

# Your mailer is set to "none" (default on Windows),
# hence we cannot send the bug report directly from R.
# Please copy the bug report (after finishing it) to
# your favorite email program and send it to
#
#       r-bugs@r-project.org
#
######################################################



<<insert bug report here>>
Is this a bug in the parser?
Specifically, the trace lines

Browse[1]> x
[[1]]
[1] "factor(-(rowpos <= 2) + (rowpos >= 6), labels = c(\"1:2\", \"3:5\", "
[2] "    ~\"6:8\"))"                                                      

suggest that a single statement was arbitrarily cut into two pieces, neither
of which makes syntactic sense, when the string was too long.

The comparable line with shorter variable names is

Browse[1]> x
[[1]]
[1] "factor(-(r <= 2) + (r >= 6), labels = c(\"1:2\", \"3:5\", \"6:8\"))"


I am using rw2001
## Code to duplicate the problem:


options()$width
library(lattice) 
data(OrchardSprays) 
OrchardSprays$r <- OrchardSprays$rowpos

xyplot(decrease ~ treatment |
       factor(-(rowpos<=2)+(rowpos>=6), labels=c("1:2","3:5","6:8")),
       data=OrchardSprays)

xyplot(decrease ~ treatment |
       factor(-(r<=2)+(r>=6), labels=c("1:2","3:5","6:8")),
       data=OrchardSprays)

trace("names<-.default", exit=browser)

xyplot(decrease ~ treatment |
       factor(-(rowpos<=2)+(rowpos>=6), labels=c("1:2","3:5","6:8")),
       data=OrchardSprays)

xyplot(decrease ~ treatment |
       factor(-(r<=2)+(r>=6), labels=c("1:2","3:5","6:8")),
       data=OrchardSprays)



## transcript that shows the problem
##
## My mailer folds lines at 100 characters, I have several "Error",
## "Tracing", and "Called" lines that run out to 142.

> options()$width
[1] 80
> library(lattice) 
> data(OrchardSprays) 
> OrchardSprays$r <- OrchardSprays$rowpos
> xyplot(decrease ~ treatment |
+        factor(-(rowpos<=2)+(rowpos>=6), labels=c("1:2","3:5","6:8")),
+        data=OrchardSprays)
Error in "names<-.default"(`*tmp*`, value = c("factor(-(rowpos <= 2) + (rowpos >= 6), labels = c
(\"1:2\", \"3:5\", ",  : 
	names attribute [2] must be the same length as the vector [1]
> xyplot(decrease ~ treatment |
+        factor(-(r<=2)+(r>=6), labels=c("1:2","3:5","6:8")),
+        data=OrchardSprays)
> trace("names<-.default", exit=browser)
Tracing function "names<-.default" in package "base" 
[1] "names<-.default"
> xyplot(decrease ~ treatment |
+        factor(-(rowpos<=2)+(rowpos>=6), labels=c("1:2","3:5","6:8")),
+        data=OrchardSprays)
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> ls()
[1] "value" "x"    
Browse[1]> value
NULL
Browse[1]> x
[[1]]
[1] "factor(-(rowpos <= 2) + (rowpos >= 6), labels = c(\"1:2\", \"3:5\", "
[2] "    ~\"6:8\"))"                                                      

Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Error in "names<-.default"(`*tmp*`, value = c("factor(-(rowpos <= 2) + (rowpos >= 6), labels = c
(\"1:2\", \"3:5\", ",  : 
	names attribute [2] must be the same length as the vector [1]
Tracing "names<-.default"(`*tmp*`, value = structure(c("factor(-(rowpos <= 2) + (rowpos >= 6), 
labels = c(\"1:2\", \"3:5\", ",  .... on exit 
Called from: "names<-.default"(`*tmp*`, value = c("factor(-(rowpos <= 2) + (rowpos >= 6), labels = 
c(\"1:2\", \"3:5\", ", 
"    ~\"6:8\"))"))
Browse[1]> c
> xyplot(decrease ~ treatment |
+        factor(-(r<=2)+(r>=6), labels=c("1:2","3:5","6:8")),
+        data=OrchardSprays)
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> ls()
[1] "value" "x"    
Browse[1]> value
NULL
Browse[1]> x
[[1]]
[1] "factor(-(r <= 2) + (r >= 6), labels = c(\"1:2\", \"3:5\", \"6:8\"))"

Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = "factor(-(r <= 2) + (r >= 6), labels = c(\"1:2\", \"3:5
\", \"6:8\"))") on exit 
Called from: "names<-.default"(`*tmp*`, value = "factor(-(r <= 2) + (r >= 6), labels = c(\"1:2\", 
\"3:5\", \"6:8\"))")
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> c
Tracing "names<-.default"(`*tmp*`, value = NULL) on exit 
Called from: "names<-.default"(`*tmp*`, value = NULL)
Browse[1]> Q
> 



--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 2
 minor = 0.1
 year = 2004
 month = 11
 day = 15
 language = R

Windows XP Home Edition (build 2600) Service Pack 2.0

Search Path:
 .GlobalEnv, package:methods, package:stats, package:utils, package:datasets, 
file:c:/HOME/rmh/hh/splus.library/HH/.RData, package:multcomp, package:mvtnorm, package:abind, 
package:graphics, package:lattice, package:grid, package:grDevices, Autoloads, package:base

From p.dalgaard at biostat.ku.dk  Sun Nov 28 12:13:15 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Nov 28 12:15:37 2004
Subject: [Rd] Is this a bug in the parser? (PR#7395)
In-Reply-To: <20041128043608.5CB7CEAC3@slim.kubism.ku.dk>
References: <20041128043608.5CB7CEAC3@slim.kubism.ku.dk>
Message-ID: <x2u0raw7jo.fsf@biostat.ku.dk>

rmh@temple.edu writes:

> # Your mailer is set to "none" (default on Windows),
> # hence we cannot send the bug report directly from R.
> # Please copy the bug report (after finishing it) to
> # your favorite email program and send it to
> #
> #       r-bugs@r-project.org
> #
> ######################################################
> 
> 
> 
> <<insert bug report here>>
> Is this a bug in the parser?

No (how could it be? If anything, this has to do with _de_parsing).
It's a bug (two, actually) in lattice, which has a maintainer....

Inside  latticeParseFormula

    parseCond <- function(model) {
        model <- eval(parse(text = paste("~", deparse(model))))[[2]]
        model.vars <- list()
        ....

and later on in the same function

    names(ans$condition) <- sapply(modelRHS.vars, deparse)

both of which whill get you in trouble if deparse needs multiple
lines. Notice that paste("~", deparse(model)) will prepend a "~" to
_every_ line, where only the first was intended, so you could have
gotten a parse error there and then.

The first bug is the sort of construct that I have been warning
people about repeatedly; computing on the language by going through
the textual representation as in parse(...deparse(...)) is almost
always wrong. In this particular case, I think the code is equivalent
to

  model <- substitute(~ m, list(m = model))

(minus the bug, of course). Bug #2 is probably just that you need to
take only the first line of deparse(), since you wouldn't want or need
the fully deparsed object for a name.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From patrick at burns-stat.com  Sun Nov 28 13:10:44 2004
From: patrick at burns-stat.com (Patrick Burns)
Date: Sun Nov 28 13:11:20 2004
Subject: [Rd] Re: [R-sig-finance] syntax for a loop
In-Reply-To: <20041128112022.63070.qmail@web81002.mail.yahoo.com>
References: <20041128112022.63070.qmail@web81002.mail.yahoo.com>
Message-ID: <41A9C044.6090603@burns-stat.com>

I don't think I understand you entirely, but here are a couple
things.

You need to shorten the loop so you don't run off the end.

You basically just write the code as you've stated it except that
"and" is && for single values and & for vectors

You don't say what should happen if the test is not true.

You can probably use "ifelse" instead of  a loop.

iseq <- 2:(length(x.dif) - 2)
test <- x.dif[iseq-1] <= 0 & x.dif[iseq] > 0 & x.dif[iseq + 2] > 0
ifelse(test, iseq + 2, NA)

I suspect that the last term in test should be i+1 and not i+2 ?

You can see S Poetry for details.

Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

ebashi wrote:

>I'll appreciate if some one can help me with the
>following loop. This is the logic of the loop,
>if we have the following data;
>  
>
>>x.df
>>    
>>
>    x.dif
> .    .
> .    .
>102  0.00
>103  0.42
>104  0.08
>105  0.00
>106  0.00
>107  0.00
>108 -0.16
>109 -0.34
>110  0.00
>111 -0.17
>112 -0.33
>113  0.00
>114  0.00
>115  0.00
>116  0.33
>117  0.17
>118  0.00 
> .    .
> .    .
>I'm trying to find i's where 
>  for (i in 2:length(x.dif))
>  if (x.dif[i-1]<=0 and x.dif[i]>0 and x.dif[i+2]>0)
>  it would return i+2 to me,
>How can I turn this to a right format as a loop.(I
>can't figure out the syntax)
>
>Cheers,
>
>Sean
>
>_______________________________________________
>R-sig-finance@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
>  
>

From murdoch at stats.uwo.ca  Sun Nov 28 16:25:24 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun Nov 28 16:24:45 2004
Subject: [Rd] RFC: Different handling of commands from clipboard in Windows
	Re: [R] how to pause between plots running scripts?
In-Reply-To: <vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
Message-ID: <2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>

(Moved from r-help to r-devel)

Terry Mu pointed out that in Windows par(ask=T) works when a script is
sourced, but not when it is run from the script editor.  I think the
reason for this is that the script editor copies the selection to the
clipboard and then pastes it to the console.  When the console stops
to ask the user to hit Enter to continue, the next pasted line
satisfies the request, and things continue on.

This is also a problem with other cut and paste mechanisms:  if you
cut from an external editor and paste to the console, often you'd want
par(ask=T) to work, and you'd want a syntax error to abort the paste,
etc.

Finally, I find that sometimes (e.g. when updating a function
definition) I'd like to be able to do a "silent paste", where the code
is processed and executed, but it doesn't show in the console or the
history list.

We already have code to source() from the clipboard, and it could
address the problems above, but:

 - Source with echo=T doesn't echo, it deparses, so some comments are
lost, formatting is changed, etc.

 - Often I want to paste just part of an expression as I'm typing, so
source'ing from the clipboard wouldn't be what I wanted.  I'd need to
choose which kind of paste.  But we already have 3 ways to paste
(Paste, Paste commands only, Copy and Paste), and I'm reluctant to add
another option which could conceivably be used on all existing
methods.

Another approach would be to make the input routines smarter:  e.g.
clear the input buffer when there's a syntax error, suspend it when
asking for confirmation before the next graph:  but this looks
potentially really messy to me.

Another that deals only with the original graphics problem is to have 
par(ask=T) wait for input to the graphics window, rather than to the
console.  This has the advantage that the graphics window probably has
the focus, so a simple Enter there could satisfy it.

Or some other approach, or some combination of approaches.  

Comments?

Duncan Murdoch


On Sat, 27 Nov 2004 22:38:34 -0500, Duncan Murdoch
<murdoch@stats.uwo.ca> wrote:

>
>>> > I used pause() from library(DAAG) to pasue between plots. This works
>>> > when I source a script, but seems don't work when I run (ctrl + R) the
>>> > script in R.
>
>This sounds like a bug to me, but I'm not sure it's going to be an
>easy one to fix.  
>
>Duncan Murdoch
>
>______________________________________________
>R-help@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html

From deepayan at stat.wisc.edu  Sun Nov 28 18:25:02 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Sun Nov 28 18:24:17 2004
Subject: [Rd] Is this a bug in the parser? (PR#7395)
In-Reply-To: <x2u0raw7jo.fsf@biostat.ku.dk>
References: <20041128043608.5CB7CEAC3@slim.kubism.ku.dk>
	<x2u0raw7jo.fsf@biostat.ku.dk>
Message-ID: <200411281125.02536.deepayan@stat.wisc.edu>

On Sunday 28 November 2004 05:13, Peter Dalgaard wrote:
> rmh@temple.edu writes:
> > # Your mailer is set to "none" (default on Windows),
> > # hence we cannot send the bug report directly from R.
> > # Please copy the bug report (after finishing it) to
> > # your favorite email program and send it to
> > #
> > #       r-bugs@r-project.org
> > #
> > ######################################################
> >
> >
> >
> > <<insert bug report here>>
> > Is this a bug in the parser?
>
> No (how could it be? If anything, this has to do with _de_parsing).
> It's a bug (two, actually) in lattice, which has a maintainer....
>
> Inside  latticeParseFormula
>
>     parseCond <- function(model) {
>         model <- eval(parse(text = paste("~", deparse(model))))[[2]]
>         model.vars <- list()
>         ....
>
> and later on in the same function
>
>     names(ans$condition) <- sapply(modelRHS.vars, deparse)
>
> both of which whill get you in trouble if deparse needs multiple
> lines. Notice that paste("~", deparse(model)) will prepend a "~" to
> _every_ line, where only the first was intended, so you could have
> gotten a parse error there and then.

Thanks for figuring that out so quickly. Would have taken me much 
longer.

> The first bug is the sort of construct that I have been warning
> people about repeatedly; computing on the language by going through
> the textual representation as in parse(...deparse(...)) is almost
> always wrong. In this particular case, I think the code is equivalent
> to
>
>   model <- substitute(~ m, list(m = model))
>
> (minus the bug, of course). 

Right.

> Bug #2 is probably just that you need to  take only the first line of
> deparse(), since you wouldn't want or need the fully deparsed object
> for a name. 

Deepayan

From ggrothendieck at myway.com  Sun Nov 28 19:09:20 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov 28 19:09:28 2004
Subject: [Rd] Version names
Message-ID: <loom.20041128T190755-473@post.gmane.org>



I have Windows XP build scripts that look for R in a variety
of folders and if multiple ones are found, takes the last
one.  For example, I currently have the following 
in \Program Files\R :

	rw1060
	rw1062
	rw1071
	rw1071beta
	rw1081
	rw1090
	rw1090dev
	rw1091
	rw1091pat
	rw2000
	rw2001beta

Note that it currently correctly gets rw2001beta but if I
add rw2001 then it will not pick it up since rw2001beta
would continue to sort after it.

I tried using dates in my scripts to pick out the right one
but realized that it was somewhat error prone and decided to
move back to ordering by the names.

I wonder if a naming convention could be adopted that ensured
that the names sort in order.  For example,

	rw2010a - alpha, i.e. development version (previously rw2010dev)
	rw2010b - beta version (previously rw2001beta)
	rw2010f - final version (previously rw2010)
	rw2010p - patched version (previously rw2010pat)

Other possibilities might include an ascending numeric or date suffix.

I also thought about executing 
	bin\R --version 
or 
	bin\Rcmd --version
in each rw folder but am not sure if this works in all versions and
if it does whether the output is always provides a comparable
format.

From murdoch at stats.uwo.ca  Sun Nov 28 19:42:58 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun Nov 28 19:42:15 2004
Subject: [Rd] Version names
In-Reply-To: <loom.20041128T190755-473@post.gmane.org>
References: <loom.20041128T190755-473@post.gmane.org>
Message-ID: <bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>

On Sun, 28 Nov 2004 18:09:20 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote:

>
>
>I have Windows XP build scripts that look for R in a variety
>of folders and if multiple ones are found, takes the last
>one.  For example, I currently have the following 
>in \Program Files\R :
>
>	rw1060
>	rw1062
>	rw1071
>	rw1071beta
>	rw1081
>	rw1090
>	rw1090dev
>	rw1091
>	rw1091pat
>	rw2000
>	rw2001beta
>
>Note that it currently correctly gets rw2001beta but if I
>add rw2001 then it will not pick it up since rw2001beta
>would continue to sort after it.
>
>I tried using dates in my scripts to pick out the right one
>but realized that it was somewhat error prone and decided to
>move back to ordering by the names.
>
>I wonder if a naming convention could be adopted that ensured
>that the names sort in order.  For example,
>
>	rw2010a - alpha, i.e. development version (previously rw2010dev)
>	rw2010b - beta version (previously rw2001beta)
>	rw2010f - final version (previously rw2010)
>	rw2010p - patched version (previously rw2010pat)

That would work.  Use the rename command, and you've got it.

Another possibility is to have your build script split up the name and
apply a custom sort order to it.

The pattern is:

"rw" + version number + suffix

The suffices appear in this order:  "dev", "alpha", "beta", "", "pat"
(where not all appear, e.g. "dev" never appears for a minor release,
and sometimes "alpha" is skipped).

Duncan Murdoch

From ggrothendieck at myway.com  Sun Nov 28 22:11:15 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov 28 22:11:33 2004
Subject: [Rd] Version names
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
Message-ID: <loom.20041128T200019-382@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

: 
: On Sun, 28 Nov 2004 18:09:20 +0000 (UTC), Gabor Grothendieck
: <ggrothendieck <at> myway.com> wrote:
: 
: >
: >
: >I have Windows XP build scripts that look for R in a variety
: >of folders and if multiple ones are found, takes the last
: >one.  For example, I currently have the following 
: >in \Program Files\R :
: >
: >	rw1060
: >	rw1062
: >	rw1071
: >	rw1071beta
: >	rw1081
: >	rw1090
: >	rw1090dev
: >	rw1091
: >	rw1091pat
: >	rw2000
: >	rw2001beta
: >
: >Note that it currently correctly gets rw2001beta but if I
: >add rw2001 then it will not pick it up since rw2001beta
: >would continue to sort after it.
: >
: >I tried using dates in my scripts to pick out the right one
: >but realized that it was somewhat error prone and decided to
: >move back to ordering by the names.
: >
: >I wonder if a naming convention could be adopted that ensured
: >that the names sort in order.  For example,
: >
: >	rw2010a - alpha, i.e. development version (previously rw2010dev)
: >	rw2010b - beta version (previously rw2001beta)
: >	rw2010f - final version (previously rw2010)
: >	rw2010p - patched version (previously rw2010pat)
: 
: That would work.  Use the rename command, and you've got it.
: 

Renaming is not really workable if you are giving your scripts to others.
They won't want build scripts that rename their folders.  

: Another possibility is to have your build script split up the name and
: apply a custom sort order to it.
: 
: The pattern is:
: 
: "rw" + version number + suffix
: 
: The suffices appear in this order:  "dev", "alpha", "beta", "", "pat"
: (where not all appear, e.g. "dev" never appears for a minor release,
: and sometimes "alpha" is skipped).

Its really desirable to keep Windows batch scripts as simple as 
possible and such a transformation is trickier than you might
think in the Windows batch language. 

I was hoping that the R team would consider a simplifying
change to make it easier to create build scripts.  The least such 
change that I can think of is to use alpha as a suffix in place of dev 
and to use final to suffix unsuffixed versions.  That would be enough to 
allow them to sort in ascending order.

This involves no coding at all for the R team.  Just a decision
to regularize the naming.

Currently I am the only user of my scripts so, as a workaround
I can delete the dev when I get the beta and delete the
beta when I get the final (or alternately just wait for the
final since the final/patch subset sort correctly) but it would 
be nice to have a simple general solution.

From p.dalgaard at biostat.ku.dk  Sun Nov 28 23:13:04 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Nov 28 23:15:28 2004
Subject: [Rd] Version names
In-Reply-To: <loom.20041128T200019-382@post.gmane.org>
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
Message-ID: <x2r7mdy64v.fsf@biostat.ku.dk>

Gabor Grothendieck <ggrothendieck@myway.com> writes:

> : >	rw2010a - alpha, i.e. development version (previously rw2010dev)
> : >	rw2010b - beta version (previously rw2001beta)
> : >	rw2010f - final version (previously rw2010)
> : >	rw2010p - patched version (previously rw2010pat)
> : 
> : That would work.  Use the rename command, and you've got it.
> : 
> 
> Renaming is not really workable if you are giving your scripts to others.
> They won't want build scripts that rename their folders.  
......
> Its really desirable to keep Windows batch scripts as simple as 
> possible and such a transformation is trickier than you might
> think in the Windows batch language. 
> 
> I was hoping that the R team would consider a simplifying
> change to make it easier to create build scripts.  The least such 
> change that I can think of is to use alpha as a suffix in place of dev 
> and to use final to suffix unsuffixed versions.  That would be enough to 
> allow them to sort in ascending order.
> 
> This involves no coding at all for the R team.  Just a decision
> to regularize the naming.

In a word, no, we won't do that. I'd certainly veto it if it came to
that. 

It is a bad idea to have scripts depending on sort order (and R core
has learned the hard way that sort order depends on locale), and it is
an even worse idea to modify development concepts to fit a specificic
alphabetical order. Case in point: A development version is _not_ the
same as an alpha version!

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Sun Nov 28 23:27:12 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun Nov 28 23:26:29 2004
Subject: [Rd] Version names
In-Reply-To: <loom.20041128T200019-382@post.gmane.org>
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
Message-ID: <eujkq0lbgdji3073ud8sjg73016upfdb1u@4ax.com>

On Sun, 28 Nov 2004 21:11:15 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote:

>Renaming is not really workable if you are giving your scripts to others.
>They won't want build scripts that rename their folders.  
>
>: Another possibility is to have your build script split up the name and
>: apply a custom sort order to it.
>: 
>: The pattern is:
>: 
>: "rw" + version number + suffix
>: 
>: The suffices appear in this order:  "dev", "alpha", "beta", "", "pat"
>: (where not all appear, e.g. "dev" never appears for a minor release,
>: and sometimes "alpha" is skipped).
>
>Its really desirable to keep Windows batch scripts as simple as 
>possible and such a transformation is trickier than you might
>think in the Windows batch language. 

You need a better scripting language!  

Duncan Murdoch

From ggrothendieck at myway.com  Sun Nov 28 23:51:10 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov 28 23:51:22 2004
Subject: [Rd] Version names
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
	<x2r7mdy64v.fsf@biostat.ku.dk>
Message-ID: <loom.20041128T234646-896@post.gmane.org>

Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:

: 
: Gabor Grothendieck <ggrothendieck <at> myway.com> writes:
: 
: > : >	rw2010a - alpha, i.e. development version (previously rw2010dev)
: > : >	rw2010b - beta version (previously rw2001beta)
: > : >	rw2010f - final version (previously rw2010)
: > : >	rw2010p - patched version (previously rw2010pat)
: > : 
: > : That would work.  Use the rename command, and you've got it.
: > : 
: > 
: > Renaming is not really workable if you are giving your scripts to others.
: > They won't want build scripts that rename their folders.  
: ......
: > Its really desirable to keep Windows batch scripts as simple as 
: > possible and such a transformation is trickier than you might
: > think in the Windows batch language. 
: > 
: > I was hoping that the R team would consider a simplifying
: > change to make it easier to create build scripts.  The least such 
: > change that I can think of is to use alpha as a suffix in place of dev 
: > and to use final to suffix unsuffixed versions.  That would be enough to 
: > allow them to sort in ascending order.
: > 
: > This involves no coding at all for the R team.  Just a decision
: > to regularize the naming.
: 
: In a word, no, we won't do that. I'd certainly veto it if it came to
: that. 
: 
: It is a bad idea to have scripts depending on sort order (and R core
: has learned the hard way that sort order depends on locale), and it is
: an even worse idea to modify development concepts to fit a specificic
: alphabetical order. Case in point: A development version is _not_ the
: same as an alpha version!

I am pretty sure one could come up with a naming scheme that would
work in every locale.  If we used a, b, f and p then I doubt there
are any locales in which those are not increasing.  If that's not
true we could use numbers.  I really doubt that there are locales
in which digits are mot increasing.



:

From ggrothendieck at myway.com  Sun Nov 28 23:58:53 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Nov 28 23:58:58 2004
Subject: [Rd] Version names
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
	<eujkq0lbgdji3073ud8sjg73016upfdb1u@4ax.com>
Message-ID: <loom.20041128T235131-532@post.gmane.org>

Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:

: 
: On Sun, 28 Nov 2004 21:11:15 +0000 (UTC), Gabor Grothendieck
: <ggrothendieck <at> myway.com> wrote:
: 
: >Renaming is not really workable if you are giving your scripts to others.
: >They won't want build scripts that rename their folders.  
: >
: >: Another possibility is to have your build script split up the name and
: >: apply a custom sort order to it.
: >: 
: >: The pattern is:
: >: 
: >: "rw" + version number + suffix
: >: 
: >: The suffices appear in this order:  "dev", "alpha", "beta", "", "pat"
: >: (where not all appear, e.g. "dev" never appears for a minor release,
: >: and sometimes "alpha" is skipped).
: >
: >Its really desirable to keep Windows batch scripts as simple as 
: >possible and such a transformation is trickier than you might
: >think in the Windows batch language. 
: 
: You need a better scripting language!  

Quite so but unfortunately if I want to produce a script
that has no dependencies then I need to use what is provided 
in Windows and Windows batch commands seem to be the best
way to do that.

From simon.urbanek at math.uni-augsburg.de  Mon Nov 29 00:51:15 2004
From: simon.urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Mon Nov 29 00:51:24 2004
Subject: [Rd] Version names
In-Reply-To: <loom.20041128T235131-532@post.gmane.org>
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
	<eujkq0lbgdji3073ud8sjg73016upfdb1u@4ax.com>
	<loom.20041128T235131-532@post.gmane.org>
Message-ID: <6463A9E0-4198-11D9-9579-0003938AF008@math.uni-augsburg.de>

On Nov 28, 2004, at 11:58 PM, Gabor Grothendieck wrote:

> Quite so but unfortunately if I want to produce a script
> that has no dependencies then I need to use what is provided
> in Windows and Windows batch commands seem to be the best
> way to do that.

Batch scripts are also quite dependent on the system and settings used. 
Moreover what are you trying to do? The rwXXX scheme is just a 
suggestion, every user is free to change the name during the 
installation, so there is no way to know by folder name which version 
you're dealing with... The only half-way sensible solution I can think 
of is looking for Rterm.exe and running each one to get the 
corresponding R version - I suppose you can do that with a batch script 
;).

If all you want to do is to determine the current (most recently 
installed) R version, then all it takes is two lines of C code [just 
read one registry entry] - and it's at least as portable across Windows 
systems as a batch script, but far more flexible. (There may even be a 
way to get that info w/o coding at all - I'm not sure whether regedit 
has any batch mode or something ...).

Cheers,
Simon

From ramasamy at cancer.org.uk  Mon Nov 29 01:18:59 2004
From: ramasamy at cancer.org.uk (Adaikalavan Ramasamy)
Date: Mon Nov 29 01:17:39 2004
Subject: [Rd] Suggestions for packages / help / index (long mail)
In-Reply-To: <6.0.1.1.2.20041124151201.03004a00@stat4ux.stat.ucl.ac.be>
References: <6.0.1.1.2.20041124134002.03108a00@stat4ux.stat.ucl.ac.be>
	<loom.20041124T150203-392@post.gmane.org>
	<6.0.1.1.2.20041124151201.03004a00@stat4ux.stat.ucl.ac.be>
Message-ID: <1101687539.3250.8.camel@localhost.localdomain>

I am coming a bit late to the thread, so apologies if I am missing
something. I believe that it would be more useful to index functions to
particular keywords than a package itself. 

I think we may have over-looked Prof. Harrell's suggestion  
(https://stat.ethz.ch/pipermail/r-sig-gui/2004-November/000410.html)
during the "Hidden costs of GPL software" thread.

His site (http://biostat.mc.vanderbilt.edu/s/finder/finder.html) is
quite useful. If this was turned into a wiki or something similar,
perhaps it could have much more benefit.

Regards, Adai



On Wed, 2004-11-24 at 14:15, Eric Lecoutre wrote: 
> At 15:06 24/11/2004, Gabor Grothendieck wrote:
> >Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:
> >
> >: 6. Final point has already been discussed in the past. It is about misc
> >: packages and pieces of code. I propose the creation of 5 packages:
> >:       - miscGraphics (keywords: misc, Graphics)
> >:       - miscStatistics (keywords: misc, Statistics)
> >:       - miscMathematics (keywords: misc, Mathematics)
> >:       - miscBasics (keywords: misc, Basics)
> >:       - miscProgramming (keywords: misc, Programming)
> >
> >Rather than preset the categories perhaps evolving them would
> >be better, just starting out with a single Misc package and then
> >decomposing it into multiple packages as the categories become
> >clear.
> 
> 
> Those categories are taken from KEYWORDS (master entries). I guess it 
> wouldn't be difficult to still have substancial entries for those packages, 
> if some misc package maintainer would make the job to break their package 
> into pieces. BTW, I have to admit this choice is not easy to make for 
> several reasons, the main one beeing to keep the ability to modify one's 
> own contributions.
> For those packages, a collaborative plattform such as SourceForge and so 
> on, with Sync-ability, could be a good choice.
> 
> Eric
> 
> 
> Eric Lecoutre
> UCL /  Institut de Statistique
> Voie du Roman Pays, 20
> 1348 Louvain-la-Neuve
> Belgium
> 
> tel: (+32)(0)10473050
> lecoutre@stat.ucl.ac.be
> http://www.stat.ucl.ac.be/ISpersonnel/lecoutre
> 
> If the statistics are boring, then you've got the wrong numbers. -Edward 
> Tufte
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ggrothendieck at myway.com  Mon Nov 29 01:59:25 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 29 01:59:33 2004
Subject: [Rd] Version names
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
	<eujkq0lbgdji3073ud8sjg73016upfdb1u@4ax.com>
	<loom.20041128T235131-532@post.gmane.org>
	<6463A9E0-4198-11D9-9579-0003938AF008@math.uni-augsburg.de>
Message-ID: <loom.20041129T011607-744@post.gmane.org>

Simon Urbanek <simon.urbanek <at> math.uni-augsburg.de> writes:

: 
: On Nov 28, 2004, at 11:58 PM, Gabor Grothendieck wrote:
: 
: > Quite so but unfortunately if I want to produce a script
: > that has no dependencies then I need to use what is provided
: > in Windows and Windows batch commands seem to be the best
: > way to do that.
: 
: Batch scripts are also quite dependent on the system and settings used. 
: Moreover what are you trying to do? The rwXXX scheme is just a 
: suggestion, every user is free to change the name during the 
: installation, so there is no way to know by folder name which version 
: you're dealing with... The only half-way sensible solution I can think 
: of is looking for Rterm.exe and running each one to get the 
: corresponding R version - I suppose you can do that with a batch script 
: ;).

While what you say is true in the strict sense, batch scripts are usually
small simple scripts that get the job done quickly.  

In most cases I think its good enought that they work in 
non-pathalogical cases and that means searching for R 
in ., \Program Files\R\rw* and \R\rw* .  This would be easy
to do if the naming scheme were regular.

: 
: If all you want to do is to determine the current (most recently 
: installed) R version, then all it takes is two lines of C code [just 
: read one registry entry] - and it's at least as portable across Windows 

This just puts the problem one level off.  Now we need to know where 
the C file is.  The objective is to have a simple self contained script.
It would be possible to do it all in C but then its not a script
and its certainly not simple.

: systems as a batch script, but far more flexible. (There may even be a 
: way to get that info w/o coding at all - I'm not sure whether regedit 
: has any batch mode or something ...).

I don't think regedit has a batch mode.  e.g. regedit /? does not give help.
It would likely be possible to do it in vbscript and I may try that 
although I do think that that is leaving the realm of simplicity
and it think it shoulnd be easier to write a simple batch script 
that finds R.  I was putting off learning vbscript since I have
never needed it and Microsoft is moving to Monad/MSH for scripting
in Longhorn so I think vbscript may soon be orphaned.  Also I 
was hoping that at some point the entire package building 
process will migrate to R and scripts including perl, batch, UNIX-like
commands etc. will become unnecessary.

I quickly looked for the file where R sets the registry after reading
your post but could not quickly find it.  If anyone can provide the 
url to it in the svn repository or elsewhere that would helpful.

For the moment I have a viable workaround which is not to install
any R version that would be out of sequence (e.g. don't install
any beta or dev versions or if you do install a beta or dev version
don't install another version until the pat or next version number
comes out or delete the beta or dev version if you do).  This allows 
me to work with simple scripts.  These scripts do allow one to 
alternately specify the location of R explicitly through an
environment variable or to simply cd to the rw folder so its always 
possible to force a certain version even in the absence of such a protool.

From ggrothendieck at myway.com  Mon Nov 29 03:11:31 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 29 03:11:44 2004
Subject: [Rd] Version names
References: <loom.20041128T190755-473@post.gmane.org>
	<bl6kq05o6vuscam0rrlg00ndvchi68jals@4ax.com>
	<loom.20041128T200019-382@post.gmane.org>
	<eujkq0lbgdji3073ud8sjg73016upfdb1u@4ax.com>
	<loom.20041128T235131-532@post.gmane.org>
	<6463A9E0-4198-11D9-9579-0003938AF008@math.uni-augsburg.de>
	<loom.20041129T011607-744@post.gmane.org>
Message-ID: <loom.20041129T024007-634@post.gmane.org>

Gabor Grothendieck <ggrothendieck <at> myway.com> writes:

> 
> Simon Urbanek <simon.urbanek <at> math.uni-augsburg.de> writes:
> 

> : If all you want to do is to determine the current (most recently 
> : installed) R version, then all it takes is two lines of C code [just 
> : read one registry entry] - and it's at least as portable across Windows 
> : systems as a batch script, but far more flexible. (There may even be a 
> : way to get that info w/o coding at all - I'm not sure whether regedit 
> : has any batch mode or something ...).
> 
> I don't think regedit has a batch mode.  e.g. regedit /? does not give help.

I looked into a bit more and some of this information is actually in 
the FAQ:


	2.15 Does R use the Registry?
	Not itself. 

	The installers set some entries to allow uninstallation. In
	addition (by default, but this can be de-selected) they set
	a Registry key LOCAL_MACHINE\Software\R-core\R giving the
	version and install path. Again, this is not used by R
	itself, but it will be used by the DCOM interface
	(http://cran.r-project.org/other-software.html). Finally, a
	file association for extension .RData is set in the
	Registry. 

	You can add the Registry entries by running RSetReg.exe in
	the bin folder, and remove them by running this with
	argument /U. Note that the settings are all per machine and
	not per user, and that this neither sets up nor removes the
	file associations. 

Also it seems that one uses reg.exe rather than regedit.exe from 
batch files so putting all this together we get the following 
Windows XP batch statement to get the current path to the rw.... folder. 
It puts the path into the Rrw variable:

for /f "tokens=2*" %%a in (
	'reg query hklm\software\r-core\r /v InstallPath') do set Rrw=%%b

The bad news is that this is not 100% guaranteed to work since, as mentioned
above, the user can deselect modification of the registry during installation
but its certainly more than sufficient for my purposes and probably most 
other purposes too.

Thanks for pointing the way.

From imosqueira at suk.azti.es  Mon Nov 29 09:41:03 2004
From: imosqueira at suk.azti.es (Iago Mosqueira)
Date: Mon Nov 29 08:38:20 2004
Subject: [Rd] \link{} to help pages in Debian
Message-ID: <1101641542.9033.10.camel@xurelo.azti.local>

Hello,

In my Debian 3.0 systems, packages are installed in two different
places, namely /usr/lib/R/library and /usr/local/lib/R/site-library,
depending on whether they come from debian packages or CRAN ones. Help
pages for my own packages, installed in the second location, cannot find
help pages from, for example, the base package via \link{}. I also tried
specifying the package with \link[pkg]{page}.

Is the only solution to force the system to use a single library folder?
Can I force the help system to look in both places?

Thanks


Iago Mosqueira

From ligges at statistik.uni-dortmund.de  Mon Nov 29 09:51:37 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Nov 29 09:50:52 2004
Subject: [Rd] Suggestions for packages / help / index (long mail)
In-Reply-To: <1101687539.3250.8.camel@localhost.localdomain>
References: <6.0.1.1.2.20041124134002.03108a00@stat4ux.stat.ucl.ac.be>	<loom.20041124T150203-392@post.gmane.org>	<6.0.1.1.2.20041124151201.03004a00@stat4ux.stat.ucl.ac.be>
	<1101687539.3250.8.camel@localhost.localdomain>
Message-ID: <41AAE319.1030301@statistik.uni-dortmund.de>

Adaikalavan Ramasamy wrote:

> I am coming a bit late to the thread, so apologies if I am missing
> something. I believe that it would be more useful to index functions to
> particular keywords than a package itself. 
> 
> I think we may have over-looked Prof. Harrell's suggestion  
> (https://stat.ethz.ch/pipermail/r-sig-gui/2004-November/000410.html)
> during the "Hidden costs of GPL software" thread.
> 
> His site (http://biostat.mc.vanderbilt.edu/s/finder/finder.html) is
> quite useful. If this was turned into a wiki or something similar,
> perhaps it could have much more benefit.
> 
> Regards, Adai

I'd rather support John Fox idea to encourage the use of \concept{} 
entries much stronger.

Uwe Ligges



> 
> 
> On Wed, 2004-11-24 at 14:15, Eric Lecoutre wrote: 
> 
>>At 15:06 24/11/2004, Gabor Grothendieck wrote:
>>
>>>Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:
>>>
>>>: 6. Final point has already been discussed in the past. It is about misc
>>>: packages and pieces of code. I propose the creation of 5 packages:
>>>:       - miscGraphics (keywords: misc, Graphics)
>>>:       - miscStatistics (keywords: misc, Statistics)
>>>:       - miscMathematics (keywords: misc, Mathematics)
>>>:       - miscBasics (keywords: misc, Basics)
>>>:       - miscProgramming (keywords: misc, Programming)
>>>
>>>Rather than preset the categories perhaps evolving them would
>>>be better, just starting out with a single Misc package and then
>>>decomposing it into multiple packages as the categories become
>>>clear.
>>
>>
>>Those categories are taken from KEYWORDS (master entries). I guess it 
>>wouldn't be difficult to still have substancial entries for those packages, 
>>if some misc package maintainer would make the job to break their package 
>>into pieces. BTW, I have to admit this choice is not easy to make for 
>>several reasons, the main one beeing to keep the ability to modify one's 
>>own contributions.
>>For those packages, a collaborative plattform such as SourceForge and so 
>>on, with Sync-ability, could be a good choice.
>>
>>Eric
>>
>>
>>Eric Lecoutre
>>UCL /  Institut de Statistique
>>Voie du Roman Pays, 20
>>1348 Louvain-la-Neuve
>>Belgium
>>
>>tel: (+32)(0)10473050
>>lecoutre@stat.ucl.ac.be
>>http://www.stat.ucl.ac.be/ISpersonnel/lecoutre
>>
>>If the statistics are boring, then you've got the wrong numbers. -Edward 
>>Tufte
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From maechler at stat.math.ethz.ch  Mon Nov 29 10:20:10 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Nov 29 10:20:19 2004
Subject: [Rd] \link{} to help pages in Debian
In-Reply-To: <1101641542.9033.10.camel@xurelo.azti.local>
References: <1101641542.9033.10.camel@xurelo.azti.local>
Message-ID: <16810.59850.727242.266509@gargle.gargle.HOWL>

>>>>> "Iago" == Iago Mosqueira <imosqueira@suk.azti.es>
>>>>>     on Mon, 29 Nov 2004 08:41:03 +0000 writes:

    Iago> Hello,
    Iago> In my Debian 3.0 systems, packages are installed in two different
    Iago> places, namely /usr/lib/R/library and /usr/local/lib/R/site-library,
    Iago> depending on whether they come from debian packages or CRAN ones. Help
    Iago> pages for my own packages, installed in the second location, cannot find
    Iago> help pages from, for example, the base package via \link{}. I also tried
    Iago> specifying the package with \link[pkg]{page}.

    Iago> Is the only solution to force the system to use a single library folder?

not at all!
We have been working with several libraries "forever",
and I think I have n't seen your problem ever.

For instance, I never install extra packages into the "standard"
library (the one where "base" is in); have all CRAN packages in
one library, bioconductor in another library, etc,etc.

    Iago> Can I force the help system to look in both places?

Actually you forgot to specify which interface to the help system
you are using.  But I assume you mean the help.start()
{webbrowser-"HTML"} one (which I very rarely use, since ESS and
"C-c C-v" is faster; to  follow links in ESS help buffers, after
selection, often "h"  <Return>" is sufficient -- ah reminds me
of an ESS improvement  I've wanted to implement...)

For me, help.start() works fine including links between pages
from packages in different libraries.

Martin

From rksh at soc.soton.ac.uk  Mon Nov 29 11:34:19 2004
From: rksh at soc.soton.ac.uk (Robin Hankin)
Date: Mon Nov 29 11:35:19 2004
Subject: [Rd] data() in data/*.R files
Message-ID: <a0620070cbdccc895fa72@[139.166.242.29]>

Hi

I'm having difficulty making a package pass R CMD check.

I need to read in a dataset from another package,  modify it, and have the
modified object available in the first package. help(require) says:

      The source code for a package that requires one or more other
      packages should have a call to 'require', preferably near the
      beginning of the source, and of course before any code that uses
      functions, classes or methods from the other package.

and 200update.txt points out that the  data/*.R files must be self
sufficient, suggesting  "require(pkg, quietly=TRUE, save=FALSE)"
if needed.  My .R file  in the data subdirectory looks like this:


   require(calibrator, quietly=TRUE, save=FALSE)
   data(expert.estimates, package="calibrator")
   <paraphrase>
  expert.estimates.modified <- some.function(expert.estimates)
   </paraphrase>


  But if I do this, R CMD check says

Error in eval(expr, envir, enclos) : couldn't find function "data"
Execution halted
ERROR: installing package indices failed
  ERROR
Installation failed.

[the package passes R CMD check if I cut-and-paste a dput  and assign 
expert.estimates.modified
directly, and dispense with the data() statement].

How do I load a dataset from another package in a .R file, and use it?



-- 
Robin Hankin
Uncertainty Analyst
Southampton Oceanography Centre
SO14 3ZH
tel +44(0)23-8059-7743
initialDOTsurname@soc.soton.ac.uk (edit in obvious way; spam precaution)
	[[alternative HTML version deleted]]

From halldor at vedur.is  Mon Nov 29 11:54:18 2004
From: halldor at vedur.is (=?ISO-8859-1?Q?Halldor_Bj=F6rnsson?=)
Date: Mon Nov 29 11:46:11 2004
Subject: [Rd] problems with R-2.01 build with Mandrake 10.1
Message-ID: <41AAFFDA.3040400@vedur.is>

I  recently installed Mandrake 10.1 on my laptop, downloaded
the latest version of R, compiled it and ran it.

To my surprise I discovered that the X11() command returned
an error to the effect that X was not available.
Examining R config.log I noticed that there were several
complaints about X and tcl in there. Basic include files, such as 
X11/X.h were not found.

I have previously compiled R-2.0.1 on a RedHat8 station
and that one ran without any problems.

Does anyone know if there is an issue pertaining to
X windows system that might make harder to compile R on
mandrake than on redhat. Are there any specific rpms that
need to be included before I can compile R so it includes X

I understand that Mandrake 10.1 uses Xorg instead of XFree86,
but am  under the impression that these are compatible.

Sincerely,
Halld?r
-- 
------------------------------------------
Halldor Bjornsson   (halldor@vedur.is)
Vedurstofa Islands (Icelandic Met. Office)
Bustadavegur 9, IS-150, Reykjavik, Iceland

From imosqueira at suk.azti.es  Mon Nov 29 13:08:51 2004
From: imosqueira at suk.azti.es (Iago Mosqueira)
Date: Mon Nov 29 12:06:15 2004
Subject: [Rd] \link{} to help pages in Debian
In-Reply-To: <16810.59850.727242.266509@gargle.gargle.HOWL>
References: <1101641542.9033.10.camel@xurelo.azti.local>
	<16810.59850.727242.266509@gargle.gargle.HOWL>
Message-ID: <1101730130.9033.41.camel@xurelo.azti.local>

On Mon, 2004-11-29 at 09:20, Martin Maechler wrote:

> not at all!
> We have been working with several libraries "forever",
> and I think I have n't seen your problem ever.

I have detected it only in one package, which happens to conatin links
to base and graphics. It seems they are generated at install time simply
by assuming the root of all packages is the same.

Obviously this is not a problem in Windows, where all packages appear to
be installed, at least by default, in the same tree.

> Actually you forgot to specify which interface to the help system
> you are using.  But I assume you mean the help.start()

Yes, indeed, sorry about that.

> "C-c C-v" is faster; to  follow links in ESS help buffers, after

Umm, maybe I need R help in vimhelp format...

> For me, help.start() works fine including links between pages
> from packages in different libraries.

Do you know of any other example I could check where a help page in one
package contains a link to another package?


Cheers,


Iago

From phgrosjean at sciviews.org  Mon Nov 29 12:06:35 2004
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Mon Nov 29 12:06:50 2004
Subject: [Rd] Custom installer [was: Version names]
In-Reply-To: <loom.20041129T024007-634@post.gmane.org>
Message-ID: <200411291106.iATB6b1C021264@outmx009.isp.belgacom.be>

Hello,
The discussion about version names leads me to the following question
(sorry, I change the message title):
Is it possible to enforce the user to select an option during R
installation? For instance, I want R to be installed with the registry entry
option set up and, let's say, with tcltk files installed. How do I ensure
this?

Well, under Windows, Inno Setup that is used as the installer is plenty of
resources for that! You have lots of command line arguments, including
/SAVEINF and LOADINF/ that use a custom information file about the options.
Then, you can run the setup silently with /SP-, /SILENT or /VERYSILENT from
the command line, thus, from a batch script.

Ultimately, it is possible to write an installer that will install R with
several options, with additional packages, etc... very easily without having
to rebuid the original R installer. You need both the rwXXXX.exe installer
(about 23Mb), and your custom installer (let's say with a couple of
additional packages, weighting a few hundreds of kb) downloaded in the same
directory. You run your custom installer, which in turn installs R silently
with the right options (it even can detect if R is already installed or
not).

There is a real interest for this approach for projects like R Commander, or
SciViews-R. Indeed, it targets beginners and installation should be as
straigthforward as possible. Currently, you have to (1) install R (2) with
specific options, (3) install additional packages, and (4) switch Rgui in
SDI mode under Windows... before you can start working in R Commander or
SciViews-R. Definitely too many tasks for a beginner!

So, I will experiment a little bit with Inno Setup in this direction and
intend to propose a web page about this topic, for Windows.

Now, my two questions:
1) Does anyone has some experience using Inno Setup this way?
2) How to solve the problem of custom installation this way under
Linux/Unix? [with a batch script, I presume, but does somebody have a
skeleton for that: installing R with specific options + several additional
packages at once].

Thanks,

Philippe Grosjean

..............................................<?}))><........
 ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
 ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
 ) ) ) ) )   Mons-Hainaut University, Pentagone
( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
 ) ) ) ) )   6, av du Champ de Mars, 7000 Mons, Belgium  
( ( ( ( (       
 ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.33.12
( ( ( ( (    email: Philippe.Grosjean@umh.ac.be
 ) ) ) ) )      
( ( ( ( (    web:   http://www.umh.ac.be/~econum
 ) ) ) ) )
..............................................................


> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Gabor 
> Grothendieck
> Sent: Monday, November 29, 2004 3:12 AM
> To: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] Version names
> 
> Gabor Grothendieck <ggrothendieck <at> myway.com> writes:
> 
> > 
> > Simon Urbanek <simon.urbanek <at> math.uni-augsburg.de> writes:
> > 
> 
> > : If all you want to do is to determine the current (most recently
> > : installed) R version, then all it takes is two lines of C 
> code [just
> > : read one registry entry] - and it's at least as portable across 
> > Windows
> > : systems as a batch script, but far more flexible. (There 
> may even be 
> > a
> > : way to get that info w/o coding at all - I'm not sure whether 
> > regedit
> > : has any batch mode or something ...).
> > 
> > I don't think regedit has a batch mode.  e.g. regedit /? 
> does not give help.
> 
> I looked into a bit more and some of this information is 
> actually in the FAQ:
> 
> 
> 	2.15 Does R use the Registry?
> 	Not itself. 
> 
> 	The installers set some entries to allow uninstallation. In
> 	addition (by default, but this can be de-selected) they set
> 	a Registry key LOCAL_MACHINE\Software\R-core\R giving the
> 	version and install path. Again, this is not used by R
> 	itself, but it will be used by the DCOM interface
> 	(http://cran.r-project.org/other-software.html). Finally, a
> 	file association for extension .RData is set in the
> 	Registry. 
> 
> 	You can add the Registry entries by running RSetReg.exe in
> 	the bin folder, and remove them by running this with
> 	argument /U. Note that the settings are all per machine and
> 	not per user, and that this neither sets up nor removes the
> 	file associations. 
> 
> Also it seems that one uses reg.exe rather than regedit.exe from 
> batch files so putting all this together we get the following 
> Windows XP batch statement to get the current path to the 
> rw.... folder. 
> It puts the path into the Rrw variable:
> 
> for /f "tokens=2*" %%a in (
> 	'reg query hklm\software\r-core\r /v InstallPath') do 
> set Rrw=%%b
> 
> The bad news is that this is not 100% guaranteed to work 
> since, as mentioned
> above, the user can deselect modification of the registry 
> during installation
> but its certainly more than sufficient for my purposes and 
> probably most 
> other purposes too.
> 
> Thanks for pointing the way.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From ligges at statistik.uni-dortmund.de  Mon Nov 29 12:34:30 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Nov 29 12:52:38 2004
Subject: [Rd] data() in data/*.R files
In-Reply-To: <a0620070cbdccc895fa72@[139.166.242.29]>
References: <a0620070cbdccc895fa72@[139.166.242.29]>
Message-ID: <41AB0946.3090400@statistik.uni-dortmund.de>

Robin Hankin wrote:

> Hi
> 
> I'm having difficulty making a package pass R CMD check.
> 
> I need to read in a dataset from another package,  modify it, and have the
> modified object available in the first package. help(require) says:
> 
>       The source code for a package that requires one or more other
>       packages should have a call to 'require', preferably near the
>       beginning of the source, and of course before any code that uses
>       functions, classes or methods from the other package.
> 
> and 200update.txt points out that the  data/*.R files must be self
> sufficient, suggesting  "require(pkg, quietly=TRUE, save=FALSE)"
> if needed.  My .R file  in the data subdirectory looks like this:
> 
> 
>    require(calibrator, quietly=TRUE, save=FALSE)
>    data(expert.estimates, package="calibrator")
>    <paraphrase>
>   expert.estimates.modified <- some.function(expert.estimates)
>    </paraphrase>
> 
> 
>   But if I do this, R CMD check says
> 
> Error in eval(expr, envir, enclos) : couldn't find function "data"
> Execution halted
> ERROR: installing package indices failed
>   ERROR
> Installation failed.
> 
> [the package passes R CMD check if I cut-and-paste a dput  and assign 
> expert.estimates.modified
> directly, and dispense with the data() statement].
> 
> How do I load a dataset from another package in a .R file, and use it?

You need to require(utils) (the package data() is in),
as well as a corresponsing entry in the DESCRIPTION file.
Also, for Windows, you may need to add the line
ZipData: no
to your DESCRIPTION file, but I am not sure about the latter (and 
haven't tested yet).

Uwe




> 
>

From p.dalgaard at biostat.ku.dk  Mon Nov 29 13:32:59 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Nov 29 13:35:25 2004
Subject: [Rd] problems with R-2.01 build with Mandrake 10.1
In-Reply-To: <41AAFFDA.3040400@vedur.is>
References: <41AAFFDA.3040400@vedur.is>
Message-ID: <x2brdglts4.fsf@biostat.ku.dk>

Halldor Bj?rnsson <halldor@vedur.is> writes:

> I  recently installed Mandrake 10.1 on my laptop, downloaded
> the latest version of R, compiled it and ran it.
> 
> To my surprise I discovered that the X11() command returned
> an error to the effect that X was not available.
> Examining R config.log I noticed that there were several
> complaints about X and tcl in there. Basic include files, such as
> X11/X.h were not found.
> 
> I have previously compiled R-2.0.1 on a RedHat8 station
> and that one ran without any problems.
> 
> Does anyone know if there is an issue pertaining to
> X windows system that might make harder to compile R on
> mandrake than on redhat. Are there any specific rpms that
> need to be included before I can compile R so it includes X
> 
> I understand that Mandrake 10.1 uses Xorg instead of XFree86,
> but am  under the impression that these are compatible.

I think Mandrake (like RedHat/Fedora) has a separate X development
RPM, which you need to install. (Several other libs have the same
convention, so do check the output from configure, and see if anything
else went missing.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Mon Nov 29 15:19:18 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon Nov 29 15:19:44 2004
Subject: [Rd] Custom installer [was: Version names]
In-Reply-To: <200411291106.iATB6b1C021264@outmx009.isp.belgacom.be>
References: <loom.20041129T024007-634@post.gmane.org>
	<200411291106.iATB6b1C021264@outmx009.isp.belgacom.be>
Message-ID: <8lbmq0hbiav42r42k2f85ie5ium1ee2nf5@4ax.com>

On Mon, 29 Nov 2004 12:06:35 +0100, "Philippe Grosjean"
<phgrosjean@sciviews.org> wrote :

>Hello,
>The discussion about version names leads me to the following question
>(sorry, I change the message title):
>Is it possible to enforce the user to select an option during R
>installation? For instance, I want R to be installed with the registry entry
>option set up and, let's say, with tcltk files installed. How do I ensure
>this?
>
>Well, under Windows, Inno Setup that is used as the installer is plenty of
>resources for that! You have lots of command line arguments, including
>/SAVEINF and LOADINF/ that use a custom information file about the options.
>Then, you can run the setup silently with /SP-, /SILENT or /VERYSILENT from
>the command line, thus, from a batch script.
>
>Ultimately, it is possible to write an installer that will install R with
>several options, with additional packages, etc... very easily without having
>to rebuid the original R installer. You need both the rwXXXX.exe installer
>(about 23Mb), and your custom installer (let's say with a couple of
>additional packages, weighting a few hundreds of kb) downloaded in the same
>directory. You run your custom installer, which in turn installs R silently
>with the right options (it even can detect if R is already installed or
>not).
>
>There is a real interest for this approach for projects like R Commander, or
>SciViews-R. Indeed, it targets beginners and installation should be as
>straigthforward as possible. Currently, you have to (1) install R (2) with
>specific options, (3) install additional packages, and (4) switch Rgui in
>SDI mode under Windows... before you can start working in R Commander or
>SciViews-R. Definitely too many tasks for a beginner!
>
>So, I will experiment a little bit with Inno Setup in this direction and
>intend to propose a web page about this topic, for Windows.
>
>Now, my two questions:
>1) Does anyone has some experience using Inno Setup this way?
>2) How to solve the problem of custom installation this way under
>Linux/Unix? [with a batch script, I presume, but does somebody have a
>skeleton for that: installing R with specific options + several additional
>packages at once].

1) I don't have experience using Inno Setup like that, but there are
various newsgroups dedicated to discussion of Inno Setup (see
http://www.jrsoftware.org/newsgroups.php), and I'm reasonably sure
you'd be able to get help there.

2)  Our assumption has been that Linux/Unix users are more
sophisticated and less pampered regarding installations, so it's not
as necessary to automate so much.  There's also the issue that
different Linux/Unix systems use different conventions for
pre-packaged installs, so you would be setting yourself up for a lot
of work if you attempt to support the majority of them.

Duncan Murdoch

From lecoutre at stat.ucl.ac.be  Mon Nov 29 15:47:58 2004
From: lecoutre at stat.ucl.ac.be (Eric Lecoutre)
Date: Mon Nov 29 15:54:56 2004
Subject: [Rd] Differences between "$" and "[["
Message-ID: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>


Hi,

If I define the following list:

 > (l<-list("text-align"="right"))
$"text-align"
[1] "right"

I know that I can't use l$text-align, as the parser will find a '-' operation.
If I want (need) to use special names, as "text-align", I have to enclose 
it between "". So I can use:

l$"text-align" or l[["text-align"]]

If now I have the text "text-align" defined in a variable:
p<-"text-align"

I can use:
 > l[[p]]
[1] "right"

But I can't use l$p

where as it is said in the help page that 'x$name' is equivalent to 
'x[["name"]]'.

Anyway I will use "[[" but I dont clearly understand this behavior.

Best,

Eric
Eric Lecoutre
UCL /  Institut de Statistique
Voie du Roman Pays, 20
1348 Louvain-la-Neuve
Belgium

tel: (+32)(0)10473050
lecoutre@stat.ucl.ac.be
http://www.stat.ucl.ac.be/ISpersonnel/lecoutre

If the statistics are boring, then you've got the wrong numbers. -Edward 
Tufte

From murdoch at stats.uwo.ca  Mon Nov 29 16:09:40 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon Nov 29 16:09:40 2004
Subject: [Rd] Differences between "$" and "[["
In-Reply-To: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>
References: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>
Message-ID: <ukemq0lvmqcmbgmjma95fchj7la2q7divr@4ax.com>

On Mon, 29 Nov 2004 15:47:58 +0100, Eric Lecoutre
<lecoutre@stat.ucl.ac.be> wrote :

>
>Hi,
>
>If I define the following list:
>
> > (l<-list("text-align"="right"))
>$"text-align"
>[1] "right"
>
>I know that I can't use l$text-align, as the parser will find a '-' operation.
>If I want (need) to use special names, as "text-align", I have to enclose 
>it between "". So I can use:
>
>l$"text-align" or l[["text-align"]]
>
>If now I have the text "text-align" defined in a variable:
>p<-"text-align"
>
>I can use:
> > l[[p]]
>[1] "right"
>
>But I can't use l$p
>
>where as it is said in the help page that 'x$name' is equivalent to 
>'x[["name"]]'.
>
>Anyway I will use "[[" but I dont clearly understand this behavior.

I think you do understand it.  From the line above, l$p would be
equivalent to l[["p"]], which is clearly different from l[[p]].

But since l$"text-align" is harder to construct than l[["text-align"]]
when "text-align" is stored in p, why bother?

Duncan Murdoch

From p.dalgaard at biostat.ku.dk  Mon Nov 29 16:19:24 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Nov 29 16:21:50 2004
Subject: [Rd] Differences between "$" and "[["
In-Reply-To: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>
References: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>
Message-ID: <x2u0r8k7ib.fsf@biostat.ku.dk>

Eric Lecoutre <lecoutre@stat.ucl.ac.be> writes:

> Hi,
> 
> If I define the following list:
> 
>  > (l<-list("text-align"="right"))
> $"text-align"
> [1] "right"
> 
> I know that I can't use l$text-align, as the parser will find a '-' operation.
> If I want (need) to use special names, as "text-align", I have to
> enclose it between "". So I can use:
> 
> l$"text-align" or l[["text-align"]]
> 
> If now I have the text "text-align" defined in a variable:
> p<-"text-align"
> 
> I can use:
>  > l[[p]]
> [1] "right"
> 
> But I can't use l$p
> 
> where as it is said in the help page that 'x$name' is equivalent to
> 'x[["name"]]'.
> 
> Anyway I will use "[[" but I dont clearly understand this behavior.

It also says

     The operators '$' and '$<-' do not evaluate their second argument.
      It is translated to a string and that string is used to locate
     the correct component of the first argument.

so l$p looks for l[["p"]] since the p is treated as a symbol. The fact
that there is an object called p and that it contains a special name
is immaterial (the opposite would be truly scary...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Mon Nov 29 16:43:25 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 29 16:43:34 2004
Subject: [Rd] Differences between "$" and "[["
References: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>
Message-ID: <loom.20041129T164131-973@post.gmane.org>

Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:

: 
: Hi,
: 
: If I define the following list:
: 
:  > (l<-list("text-align"="right"))
: $"text-align"
: [1] "right"
: 
: I know that I can't use l$text-align, as the parser will find a '-' 
operation.
: If I want (need) to use special names, as "text-align", I have to enclose 
: it between "". So I can use:
: 
: l$"text-align" or l[["text-align"]]
: 
: If now I have the text "text-align" defined in a variable:
: p<-"text-align"
: 
: I can use:
:  > l[[p]]
: [1] "right"
: 
: But I can't use l$p
: 
: where as it is said in the help page that 'x$name' is equivalent to 
: 'x[["name"]]'.
: 
: Anyway I will use "[[" but I dont clearly understand this behavior.

[[ evaluates its right argument and $ does not.  The "..." notation is
just to allow one to specify non-syntactic arguments.  One could
alternately use l$`text-align` .  I think the "..." notation
is a holdover from before `...` was implemented.

Its also possible to define your own class and have $ operate any
way you like on it (although its probably best to stick with
standard behavior and the following is not really recommended):

	l<-list("text-align"="right", a=2)
	class(l) <- c("mylist", "list")
	"$.mylist" <- function(x, idx) { 
	     y <- x[[idx]]
	     if (is.null(y)) x[[eval.parent(parse(text=idx))]] else y
	}
	p <- "text-align"
	l$p # "right"
	l$"text-align" # same
	l$`text-align` # same
	a <- 99
	l$a # 2
	l$"a" # same
	l$`a` # same
	l[["a"]] # same
	l[[a]] # 99

From ggrothendieck at myway.com  Mon Nov 29 16:48:16 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Nov 29 16:50:55 2004
Subject: [Rd] Differences between "$" and "[["
References: <6.0.1.1.2.20041129153016.0393fec0@stat4ux.stat.ucl.ac.be>
	<loom.20041129T164131-973@post.gmane.org>
Message-ID: <loom.20041129T164621-138@post.gmane.org>

Gabor Grothendieck <ggrothendieck <at> myway.com> writes:

: 
: Eric Lecoutre <lecoutre <at> stat.ucl.ac.be> writes:
: 
: : 
: : Hi,
: : 
: : If I define the following list:
: : 
: :  > (l<-list("text-align"="right"))
: : $"text-align"
: : [1] "right"
: : 
: : I know that I can't use l$text-align, as the parser will find a '-' 
: operation.
: : If I want (need) to use special names, as "text-align", I have to enclose 
: : it between "". So I can use:
: : 
: : l$"text-align" or l[["text-align"]]
: : 
: : If now I have the text "text-align" defined in a variable:
: : p<-"text-align"
: : 
: : I can use:
: :  > l[[p]]
: : [1] "right"
: : 
: : But I can't use l$p
: : 
: : where as it is said in the help page that 'x$name' is equivalent to 
: : 'x[["name"]]'.
: : 
: : Anyway I will use "[[" but I dont clearly understand this behavior.
: 
: [[ evaluates its right argument and $ does not.  The "..." notation is
: just to allow one to specify non-syntactic arguments.  One could
: alternately use l$`text-align` .  I think the "..." notation
: is a holdover from before `...` was implemented.
: 
: Its also possible to define your own class and have $ operate any
: way you like on it (although its probably best to stick with
: standard behavior and the following is not really recommended):
: 
: 	l<-list("text-align"="right", a=2)
: 	class(l) <- c("mylist", "list")
: 	"$.mylist" <- function(x, idx) { 
: 	     y <- x[[idx]]
: 	     if (is.null(y)) x[[eval.parent(parse(text=idx))]] else y
: 	}
: 	p <- "text-align"
: 	l$p # "right"
: 	l$"text-align" # same
: 	l$`text-align` # same
: 	a <- 99
: 	l$a # 2
: 	l$"a" # same
: 	l$`a` # same
: 	l[["a"]] # same
: 	l[[a]] # 99

The comment on the last one is wrong.  It should give an error since
there is no 99th component to l.

From p.dalgaard at biostat.ku.dk  Mon Nov 29 17:30:05 2004
From: p.dalgaard at biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon Nov 29 17:30:08 2004
Subject: [Rd] Non-invisible returns from title and mtext (PR#7397)
Message-ID: <20041129163005.F072110430@slim.kubism.ku.dk>


A small cosmetic item: In current versions we have

> plot(0)
> title("Foobar")
NULL

in which the printing of NULL didn't happen in 1.9.1. Same story with
mtext(), and both pretty apparent in the output from demo(graphics).

I can't offhand see what caused the change. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From tlumley at u.washington.edu  Mon Nov 29 18:15:27 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon Nov 29 18:15:34 2004
Subject: [Rd] RFC: Different handling of commands from clipboard in
	Windows Re: [R] how to pause between plots running scripts?
In-Reply-To: <2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
Message-ID: <Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>

On Sun, 28 Nov 2004, Duncan Murdoch wrote:

>
> Another that deals only with the original graphics problem is to have
> par(ask=T) wait for input to the graphics window, rather than to the
> console.  This has the advantage that the graphics window probably has
> the focus, so a simple Enter there could satisfy it.
>

I like this one.  I have often found it irritating that I have to switch 
the focus back to the console (which means uncovering the console window) 
to get the next graph.

 	-thomas

From jeff.hamann at forestinformatics.com  Mon Nov 29 18:27:42 2004
From: jeff.hamann at forestinformatics.com (Jeff D. Hamann)
Date: Mon Nov 29 18:27:59 2004
Subject: [Rd] data is getting corrupted
Message-ID: <1131.128.193.136.240.1101749262.squirrel@www.forestinformatics.com>

I've been attempting to perform some analysis on a model that was
interfaced with R (R calls a library that takes SEXPs and converts the
data frames into the internal structures of data), and I notice that for
small data.frames the vectors don't get corrupt (n<200-ish). When I pass
in larger data.frames, the vectors will become corrupt. I've been
PROTECTING the heck out of everything (as best as I can from the examples)
to make sure that something is not overlooked. I know the code in my
library works fine becuase when I attempt to do the same thing (with much
larger data arrays) none of this behaviour occurs.

An example of the corruption is,

    1  1714   ARPA   0.00   0.0000   0.00   0.0000   3.64  0.000     1   
20.00   0.00   0.00     0
    1  1715   ARPA   0.00   0.0000   0.00   0.0000   3.14  0.000     1   
20.00   0.00   0.00     0
    1  1716   ARPA
97538806975312948000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00
  0.0000   0.00   0.0000   4.68  0.000     1    20.00   0.00   0.00   
 0
    1  1717   ARPA   0.00   0.0000   0.00   0.0000   2.50  0.000     1   
20.00   0.00   0.00     0
    1  1718   ARPA   0.00   0.0000   0.00   0.0000   4.78  0.000     1   
20.00   0.00   0.00     0
    1  1719   ARPA   0.00   0.0000   0.00   0.0000   4.04  0.000     1   
20.00   0.00   0.00     0
    1  1720   ARPA   0.00   0.0000   0.00   0.0000   2.60  0.000     1   
20.00   0.00   0.00     0
    1  1721   ARPA
1141566538356936100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00
  0.0000   0.00   0.0000   3.57  0.000     1    20.00   0.00   0.00   
 0
    1  1722   ARPA   0.00   0.0000   0.00   0.0000   2.29  0.000     1   
20.00   0.00   0.00     0


And it's the same columns that become corrupt. I wanted to make sure I'm
using PROTECT correctly (the examples in the docs don't appear very
thourough) and included a snippet below,

SEXP r_write_sample_to_file( SEXP sample_in,
			     SEXP filename )
{

   unsigned long return_code;
   struct SAMPLE_RECORD *sample_ptr;
   SEXP ans;

   PROTECT( filename = AS_CHARACTER( filename ) );
   PROTECT(ans = allocVector(INTSXP, 1));

   PROTECT( sample_in = AS_LIST( sample_in ) );
   sample_ptr = build_sample_from_sexp( sample_in );

   write_sample_to_file(
      &return_code,
      CHAR(STRING_ELT(filename, 0)),
      sample_ptr,
      N_SPECIES,
      SPECIES_PTR );

   if( return_code != CONIFERS_SUCCESS  )
   {
      Rprintf( "unable to write %s\n", CHAR(STRING_ELT(filename, 0)) );
      INTEGER(ans)[0] = -1;
      UNPROTECT(2);
      UNPROTECT( 1 );
      return ans;
   }

   INTEGER(ans)[0] = 0;
   UNPROTECT(2);
   UNPROTECT( 1 );

   return ans;

}

which calls this rather lengthy function (but I thought I should include
the entire function for completeness),


/* this function converts the sample list	*/
/* from R into the internal structure		*/
struct SAMPLE_RECORD *build_sample_from_sexp( SEXP sample )
{
   int i;

   /* plots variables */
   SEXP plot_list;
   SEXP plot_plot_sexp;
   SEXP plot_lat_sexp;
   SEXP plot_long_sexp;
   SEXP plot_elev_sexp;
   SEXP plot_slp_sexp;
   SEXP plot_asp_sexp;
   SEXP plot_h20_sexp;
   SEXP plot_map_sexp;

   /* plants variables */
   SEXP plant_list;
   SEXP plant_plot_sexp;
   SEXP plant_plant_sexp;
   SEXP plant_sp_code_sexp;
   SEXP plant_d6_sexp;
   SEXP plant_d6_area_sexp;
   SEXP plant_dbh_sexp;
   SEXP plant_basal_area_sexp;
   SEXP plant_tht_sexp;
   SEXP plant_cr_sexp;
   SEXP plant_n_stems_sexp;
   SEXP plant_expf_sexp;
   SEXP plant_crown_width_sexp;
   SEXP plant_crown_area_sexp;
   SEXP plant_user_code_sexp;

   char                    temp_sp_code[16];
   struct SAMPLE_RECORD *s_ptr;
   struct SPECIES_RECORD *sp_ptr;

   s_ptr = (struct SAMPLE_RECORD *)calloc( 1, sizeof( struct SAMPLE_RECORD
) );
/*    s_ptr = (struct SAMPLE_RECORD *)Calloc( 1,  struct SAMPLE_RECORD ); */

   /* *fill in the header info */
   strcpy( s_ptr->forest,
CHAR(STRING_ELT(get_list_element(sample,"forest"), 0)) ) ;
   strcpy( s_ptr->subunit,
CHAR(STRING_ELT(get_list_element(sample,"subunit"), 0)) );
   strcpy( s_ptr->stand_name,
CHAR(STRING_ELT(get_list_element(sample,"stand.name"), 0)) );
   strcpy( s_ptr->legal, CHAR(STRING_ELT(get_list_element(sample,"legal"),
0)) );

   s_ptr->elevation = asInteger( get_list_element( sample, "elevation" ) );
   s_ptr->acreage = asReal( get_list_element( sample, "acreage" ) );
   s_ptr->age = asInteger( get_list_element( sample, "age" ) );
   s_ptr->sampled_month = asInteger( get_list_element( sample,
"sampled.month" ) );
   s_ptr->sampled_day = asInteger( get_list_element( sample, "sampled.day"
) );
   s_ptr->sampled_year = asInteger( get_list_element( sample,
"sampled.year" ) );
   s_ptr->current_year = asInteger( get_list_element( sample,
"current.year" ) );
   s_ptr->x0 = asReal( get_list_element( sample, "x0" ) );

   if( s_ptr->age <= 0 )
   {
      s_ptr->age = 0;
   }

   if( s_ptr->sampled_month <= 0 )
   {
      s_ptr->sampled_month = 0;
   }


   /* build the plots vector */
   s_ptr->n_points = asInteger( get_list_element( sample, "n.points" ) );
  s_ptr->plots_ptr = (struct PLOT_RECORD*)calloc(
	 s_ptr->n_points, sizeof( struct PLOT_RECORD ) );

/*   s_ptr->plots_ptr = (struct PLOT_RECORD*)Calloc(  */
/* 	 s_ptr->n_points, struct PLOT_RECORD ); */

   plot_list = get_list_element( sample, "plots" );
   PROTECT( plot_list = AS_LIST( plot_list ) );
//   PROTECT( plot_list  );

   plot_plot_sexp = get_list_element( plot_list, "plot" );
   plot_lat_sexp = get_list_element( plot_list, "latitude" );
   plot_long_sexp = get_list_element( plot_list, "longitude" );
   plot_elev_sexp = get_list_element( plot_list, "elevation" );
   plot_slp_sexp = get_list_element( plot_list, "slope" );
   plot_asp_sexp = get_list_element( plot_list, "aspect" );
   plot_h20_sexp = get_list_element( plot_list, "whc" );
   plot_map_sexp = get_list_element( plot_list, "map" );

   PROTECT( plot_plot_sexp = coerceVector( plot_plot_sexp, INTSXP ) );
   PROTECT( plot_lat_sexp = coerceVector( plot_lat_sexp, REALSXP ) );
   PROTECT( plot_long_sexp = coerceVector( plot_long_sexp, REALSXP ) );
   PROTECT( plot_elev_sexp = coerceVector( plot_elev_sexp, REALSXP ) );
   PROTECT( plot_slp_sexp = coerceVector( plot_slp_sexp, REALSXP ) );
   PROTECT( plot_asp_sexp = coerceVector( plot_asp_sexp, REALSXP ) );
   PROTECT( plot_h20_sexp = coerceVector( plot_h20_sexp, REALSXP ) );
   PROTECT( plot_map_sexp = coerceVector( plot_map_sexp, REALSXP ) );

   /* assign the plot array */
   for( i = 0; i < s_ptr->n_points; i++ )
   {
      s_ptr->plots_ptr[i].plot = INTEGER( plot_plot_sexp )[i];
      s_ptr->plots_ptr[i].latitude = REAL( plot_lat_sexp )[i];
      s_ptr->plots_ptr[i].longitude = REAL( plot_long_sexp )[i];
      s_ptr->plots_ptr[i].elevation = REAL( plot_elev_sexp )[i];
      s_ptr->plots_ptr[i].slope = REAL( plot_slp_sexp )[i];
      s_ptr->plots_ptr[i].aspect = REAL( plot_asp_sexp )[i];
      s_ptr->plots_ptr[i].water_capacity = REAL( plot_h20_sexp )[i];
      s_ptr->plots_ptr[i].mean_annual_precip = REAL( plot_map_sexp )[i];
   }

//   UNPROTECT( 8 );

   /* build the plants vector */
   s_ptr->n_plants = asInteger( get_list_element( sample, "n.plants" ) );
  s_ptr->plants_ptr = (struct PLANT_RECORD*)calloc(
     s_ptr->n_plants, sizeof( struct PLANT_RECORD ) );

/*   s_ptr->plants_ptr = (struct PLANT_RECORD*)Calloc(  */
/*      s_ptr->n_plants, struct PLANT_RECORD ); */


   /* build the plots vector */
  plant_list = get_list_element( sample, "plants" );
   PROTECT( plant_list = AS_LIST( plant_list ) );
//  PROTECT( plant_list );

   plant_plot_sexp = get_list_element( plant_list, "plot" );
   plant_plant_sexp = get_list_element( plant_list, "plant" );
   plant_sp_code_sexp = get_list_element( plant_list, "sp.code" );
   plant_d6_sexp = get_list_element( plant_list, "d6" );
   plant_d6_area_sexp = get_list_element( plant_list, "d6.area" );
   plant_dbh_sexp = get_list_element( plant_list, "dbh" );
   plant_basal_area_sexp = get_list_element( plant_list, "basal.area" );
   plant_tht_sexp = get_list_element( plant_list, "tht" );
   plant_cr_sexp = get_list_element( plant_list, "cr" );
   plant_n_stems_sexp = get_list_element( plant_list, "n.stems" );
   plant_expf_sexp = get_list_element( plant_list, "expf" );
   plant_crown_width_sexp = get_list_element( plant_list, "crown.width" );
   plant_crown_area_sexp = get_list_element( plant_list, "crown.area" );
   plant_user_code_sexp = get_list_element( plant_list, "user.code" );


   /* read the plants */
   PROTECT( plant_plot_sexp = coerceVector( plant_plot_sexp, INTSXP ) );
   PROTECT( plant_plant_sexp = coerceVector( plant_plant_sexp, INTSXP ) );
   PROTECT( plant_sp_code_sexp = coerceVector( plant_sp_code_sexp, STRSXP
) );
   PROTECT( plant_d6_sexp = coerceVector( plant_d6_sexp, REALSXP ) );
   PROTECT( plant_d6_area_sexp = coerceVector( plant_d6_area_sexp, REALSXP
) );
   PROTECT( plant_dbh_sexp = coerceVector( plant_dbh_sexp, REALSXP ) );
   PROTECT( plant_basal_area_sexp = coerceVector( plant_basal_area_sexp,
REALSXP ) );
   PROTECT( plant_tht_sexp = coerceVector( plant_tht_sexp, REALSXP ) );
   PROTECT( plant_cr_sexp = coerceVector( plant_cr_sexp, REALSXP ) );
   PROTECT( plant_n_stems_sexp = coerceVector( plant_n_stems_sexp, INTSXP
) );
   PROTECT( plant_expf_sexp = coerceVector( plant_expf_sexp, REALSXP ) );
   PROTECT( plant_crown_width_sexp = coerceVector( plant_crown_width_sexp,
REALSXP ) );
   PROTECT( plant_crown_area_sexp = coerceVector( plant_crown_area_sexp,
REALSXP ) );
   PROTECT( plant_user_code_sexp = coerceVector( plant_user_code_sexp,
INTSXP ) );

    /* sort the species codes based on sp_code */
    qsort(  (void*)SPECIES_PTR,
            (size_t)(N_SPECIES),
            sizeof( struct SPECIES_RECORD ),
	        compare_species_by_sp_code );

   /* assign the plot array */
   for( i = 0; i < s_ptr->n_plants; i++ )
   {
      s_ptr->plants_ptr[i].plot = INTEGER( plant_plot_sexp )[i];
      s_ptr->plants_ptr[i].plant = INTEGER( plant_plant_sexp )[i];
      strcpy( temp_sp_code, CHAR( STRING_ELT( plant_sp_code_sexp, i ) ) );

      /* get the species code and look up the correct index */
      sp_ptr = get_species_entry_from_code(    N_SPECIES,
					       SPECIES_PTR,
					       temp_sp_code );
      if( !sp_ptr )
      {
	 Rprintf( "couldn't find the species code for %s, %s\n",
		  temp_sp_code, CHAR( STRING_ELT( plant_sp_code_sexp, i ) ) );
	 continue;
      }

      /* this is the index of the "unsorted" array */
      s_ptr->plants_ptr[i].sp_idx = sp_ptr->idx;
      s_ptr->plants_ptr[i].d6 = REAL( plant_d6_sexp )[i];
      s_ptr->plants_ptr[i].d6_area = REAL( plant_d6_area_sexp )[i];
      s_ptr->plants_ptr[i].dbh = REAL( plant_dbh_sexp )[i];
      s_ptr->plants_ptr[i].basal_area = REAL( plant_basal_area_sexp )[i];
      s_ptr->plants_ptr[i].tht = REAL( plant_tht_sexp )[i];
      s_ptr->plants_ptr[i].cr = REAL( plant_cr_sexp )[i];
      s_ptr->plants_ptr[i].n_stems = INTEGER( plant_n_stems_sexp )[i];
      s_ptr->plants_ptr[i].expf = REAL( plant_expf_sexp )[i];
      s_ptr->plants_ptr[i].crown_width = REAL( plant_crown_width_sexp )[i];
      s_ptr->plants_ptr[i].crown_area = REAL( plant_crown_area_sexp )[i];
      s_ptr->plants_ptr[i].user_code = INTEGER( plant_user_code_sexp )[i];

      /* Rprintf( "dbh = %lf\n", s_ptr->plants_ptr[i].dbh );  */
      /* perform some basic error checking here */
      /* see if you can use the ISNAN macro here */

      /* try the isnan macro */
/*       if( ISNAN( REAL( plant_d6_sexp )[i] ) || s_ptr->plants_ptr[i].d6
< 0.0 ) */
/*       { */
/* 	 s_ptr->plants_ptr[i].d6 = 0.0; */
/*       } */

      if( ISNA( REAL( plant_d6_sexp )[i] ) ||
	  ISNAN( REAL( plant_d6_sexp )[i] )  ||
	  s_ptr->plants_ptr[i].d6 < 0.0 )
      {
	 s_ptr->plants_ptr[i].d6 = 0.0;
      }

      if( ISNA( REAL( plant_dbh_sexp )[i] ) ||
	  ISNAN( REAL( plant_dbh_sexp )[i] )  ||
	  s_ptr->plants_ptr[i].dbh < 0.0 )
      {
	 s_ptr->plants_ptr[i].dbh = 0.0;
      }

      if( ISNAN( REAL( plant_tht_sexp )[i] )  || s_ptr->plants_ptr[i].expf
< 0.0 )
      {
	 s_ptr->plants_ptr[i].tht = 0.0;
      }

      if( ISNAN( REAL( plant_cr_sexp )[i] )  || s_ptr->plants_ptr[i].cr <
0.0 )
      {
	 s_ptr->plants_ptr[i].cr = 0.0;
      }

      if( ISNAN( REAL( plant_expf_sexp )[i] )  ||
s_ptr->plants_ptr[i].expf < 0.0 )
      {
	 s_ptr->plants_ptr[i].expf = 0.0;
      }

      if( ISNAN( REAL( plant_crown_width_sexp )[i] )  ||
s_ptr->plants_ptr[i].crown_width < 0.0 )
      {
	 s_ptr->plants_ptr[i].crown_width = 0.0;
      }

      if( ISNAN( REAL( plant_crown_area_sexp )[i] )  ||
s_ptr->plants_ptr[i].crown_area < 0.0 )
      {
	 s_ptr->plants_ptr[i].crown_area = 0.0;
      }

/*       s_ptr->plants_ptr[i].crown_area = REAL( plant_crown_area_sexp
)[i]; */

   }

   /* now sort the species back to the "native" order (by index) */
   qsort(  (void*)SPECIES_PTR,
	   (size_t)(N_SPECIES),
	   sizeof( struct SPECIES_RECORD ),
	   compare_species_by_idx );

   UNPROTECT( 8 );   /* plot lists */
   UNPROTECT( 14 );

   UNPROTECT( 1 ); /* plot_list */
   UNPROTECT( 1 );  /* plant list */


   return s_ptr;

}

I appolgise for the long email, but I'd rather appolgize than ask permission.

I'm sure there's something I don't understand about the PROTECT/UNPROTECT
sequence as this seems to work on smaller data.frames


Thanks,
Jeff.



-- 
Jeff D. Hamann
Forest Informatics, Inc.
PO Box 1421
Corvallis, Oregon 97339-1421
phone 541-754-1428
fax 541-752-0288
jeff.hamann@forestinformatics.com
http://www.forestinformatics.com

From murdoch at stats.uwo.ca  Tue Nov 30 03:44:32 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 03:44:06 2004
Subject: [Rd] data is getting corrupted
In-Reply-To: <1131.128.193.136.240.1101749262.squirrel@www.forestinformatics.com>
References: <1131.128.193.136.240.1101749262.squirrel@www.forestinformatics.com>
Message-ID: <38nnq0lmi3v96aqov831lln4mkn3bt11ud@4ax.com>

On Mon, 29 Nov 2004 09:27:42 -0800 (PST), "Jeff D. Hamann"
<jeff.hamann@forestinformatics.com> wrote:

>/* this function converts the sample list	*/
>/* from R into the internal structure		*/
>struct SAMPLE_RECORD *build_sample_from_sexp( SEXP sample )
>{

[ declarations deleted ]

>
>   char                    temp_sp_code[16];
>   struct SAMPLE_RECORD *s_ptr;
>   struct SPECIES_RECORD *sp_ptr;
>
>   s_ptr = (struct SAMPLE_RECORD *)calloc( 1, sizeof( struct SAMPLE_RECORD
>) );

This allocates a structure, initialized to all zeros.

>/*    s_ptr = (struct SAMPLE_RECORD *)Calloc( 1,  struct SAMPLE_RECORD ); */
>
>   /* *fill in the header info */
>   strcpy( s_ptr->forest,
>CHAR(STRING_ELT(get_list_element(sample,"forest"), 0)) ) ;

This copies the string element to the address s_ptr->forest points to,
which is address 0, since you didn't change it from the initial NULL.
I'm surprised you didn't get a bigger error than the one you saw.

[ more deletions ]

>I'm sure there's something I don't understand about the PROTECT/UNPROTECT
>sequence as this seems to work on smaller data.frames

Maybe you were just lucky that the overwriting at address 0 didn't
trash anything in those cases?

Duncan Murdoch

From ripley at stats.ox.ac.uk  Tue Nov 30 10:09:23 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 30 10:09:26 2004
Subject: [Rd] Please don't assume a display for package installation
Message-ID: <Pine.LNX.4.61.0411300902570.11575@gannet.stats>

SciViews is the latest of several packages that need an X server to 
complete package installation.

Please bear in mind that packages may get installed on a server with no 
display, yet run on client workstations with displays.  If your package is 
intended to start a window when it starts up, please test for a display 
first (e.g. via capabilities("X11")).

There are ways around this (running Xvfb, arranging a remote display) but 
they are tedious at best (and few machines come with Xvfb installed).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Tue Nov 30 12:27:03 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Nov 30 12:27:07 2004
Subject: [Rd] pausing between plots - waiting for graphics input
In-Reply-To: <Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>
Message-ID: <16812.22791.971545.79304@gargle.gargle.HOWL>

{I have changed the subject to match this interesting side thread}

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu>
>>>>>     on Mon, 29 Nov 2004 09:15:27 -0800 (PST) writes:

    TL> On Sun, 28 Nov 2004, Duncan Murdoch wrote:
    >> 
    >> Another that deals only with the original graphics problem is to have
    >> par(ask=T) wait for input to the graphics window, rather than to the
    >> console.  This has the advantage that the graphics window probably has
    >> the focus, so a simple Enter there could satisfy it.
    >> 

    TL> I like this one.  I have often found it irritating that
    TL> I have to switch the focus back to the console (which
    TL> means uncovering the console window) to get the next
    TL> graph.

I agree. 
Note that this is not windows-specific really.  Rather, this
should be applicable to all devices which support minimal mouse
interaction, i.e. at least those that support locator(),
ideally just all those listed in  dev.interactive

However, I'm not at all sure that this should be done with  
par(ask = TRUE)  which works on all devices, not just
interactive ones.
Rather, we probably should a new par() {and gpar() for grid !}
option for the new feature,
maybe something like [g]par(wait_mouseclick = TRUE)

Martin

From maechler at stat.math.ethz.ch  Tue Nov 30 12:51:12 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Nov 30 12:51:15 2004
Subject: [Rd] a better "source(echo=TRUE)"  {was "....how to pause...."}
In-Reply-To: <2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
Message-ID: <16812.24240.754731.879678@gargle.gargle.HOWL>

>>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
>>>>>     on Sun, 28 Nov 2004 10:25:24 -0500 writes:

    Duncan> <........>
    Duncan> <........>

    Duncan> We already have code to source() from the clipboard, and it could
    Duncan> address the problems above, but:

    Duncan> - Source with echo=T doesn't echo, it deparses, so some comments are
    Duncan> lost, formatting is changed, etc.

yes, and we would have liked to have an alternative "source()"
for a *very* long time...
Examples where I "hate" the non-echo (i.e. the loss of all
comments and own-intended formatting) is when you use it for
demos, etc, notably in R's own  demo() and example() functions.

But to do this might be more tricky than at first thought:
Of course you can readLines() the source file and writeLines()
them to whatever your console is. The slightly difficult thing
is to "see" which junks to ``send to R'' , i.e. to parse() and eval().
The basic problem seems to see when expressions are complete.

Maybe we should / could think about enhancing parse() {or a new
function with extended behavior} such that it would not only
return the parse()d expressions, but also indices (byte or even
line counters) to the source text, indicating where each of the
expression started and ended.

That way I could see a way to proceed.

Martin

    Duncan> <........>
    Duncan> <........>

From murdoch at stats.uwo.ca  Tue Nov 30 13:00:00 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 12:59:16 2004
Subject: [Rd] pausing between plots - waiting for graphics input
In-Reply-To: <16812.22791.971545.79304@gargle.gargle.HOWL>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>
	<16812.22791.971545.79304@gargle.gargle.HOWL>
Message-ID: <jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>

On Tue, 30 Nov 2004 12:27:03 +0100, Martin Maechler
<maechler@stat.math.ethz.ch> wrote:

>{I have changed the subject to match this interesting side thread}
>
>>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu>
>>>>>>     on Mon, 29 Nov 2004 09:15:27 -0800 (PST) writes:
>
>    TL> On Sun, 28 Nov 2004, Duncan Murdoch wrote:
>    >> 
>    >> Another that deals only with the original graphics problem is to have
>    >> par(ask=T) wait for input to the graphics window, rather than to the
>    >> console.  This has the advantage that the graphics window probably has
>    >> the focus, so a simple Enter there could satisfy it.
>    >> 
>
>    TL> I like this one.  I have often found it irritating that
>    TL> I have to switch the focus back to the console (which
>    TL> means uncovering the console window) to get the next
>    TL> graph.
>
>I agree. 
>Note that this is not windows-specific really.  Rather, this
>should be applicable to all devices which support minimal mouse
>interaction, i.e. at least those that support locator(),
>ideally just all those listed in  dev.interactive
>
>However, I'm not at all sure that this should be done with  
>par(ask = TRUE)  which works on all devices, not just
>interactive ones.
>Rather, we probably should a new par() {and gpar() for grid !}
>option for the new feature,
>maybe something like [g]par(wait_mouseclick = TRUE)

If we add a new par(), then none of the existing examples will work
with it, so we'll get inconsistent behaviour and it will be really
irritating.

I think the cleanest way to implement this would be to add a new
standard graphics driver function that stops to wait for the user, and
use the existing NewFrameConfirm or equivalent as a default.  However,
I'm going to try a more roundabout implementation just for the Windows
device first, just to see if I like it.

Duncan Murdoch

From murdoch at stats.uwo.ca  Tue Nov 30 13:10:48 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 13:10:07 2004
Subject: [Rd] Re: a better "source(echo=TRUE)" {was "....how to pause...."}
In-Reply-To: <16812.24240.754731.879678@gargle.gargle.HOWL>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<16812.24240.754731.879678@gargle.gargle.HOWL>
Message-ID: <r9ooq098cm6snh7ku5cuvjded9ltpfndrv@4ax.com>

On Tue, 30 Nov 2004 12:51:12 +0100, Martin Maechler
<maechler@stat.math.ethz.ch> wrote:

>>>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
>>>>>>     on Sun, 28 Nov 2004 10:25:24 -0500 writes:
>
>    Duncan> <........>
>    Duncan> <........>
>
>    Duncan> We already have code to source() from the clipboard, and it could
>    Duncan> address the problems above, but:
>
>    Duncan> - Source with echo=T doesn't echo, it deparses, so some comments are
>    Duncan> lost, formatting is changed, etc.
>
>yes, and we would have liked to have an alternative "source()"
>for a *very* long time...
>Examples where I "hate" the non-echo (i.e. the loss of all
>comments and own-intended formatting) is when you use it for
>demos, etc, notably in R's own  demo() and example() functions.
>
>But to do this might be more tricky than at first thought:
>Of course you can readLines() the source file and writeLines()
>them to whatever your console is. The slightly difficult thing
>is to "see" which junks to ``send to R'' , i.e. to parse() and eval().
>The basic problem seems to see when expressions are complete.
>
>Maybe we should / could think about enhancing parse() {or a new
>function with extended behavior} such that it would not only
>return the parse()d expressions, but also indices (byte or even
>line counters) to the source text, indicating where each of the
>expression started and ended.
>
>That way I could see a way to proceed.

I started trying to do that last summer, but ran out of time before I
finished, and haven't got anything new done this fall.  I think the
part you describe above was done, but what I hadn't worked out were
the details of where the source would be stored.  For example, if my
example was

# Comment 1
x <- 1
# Comment 2
y <- 2
# Comment 3

do I store the source in one place with references from each line, or
break it up into separate pieces (two or five),  or just refer to the
file these lines came from?  I was trying to do it by storing the
source or a filename reference in one place with offsets to it from
each line, but didn't get done.

Duncan Murdoch

From ggrothendieck at myway.com  Tue Nov 30 13:20:37 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Tue Nov 30 13:20:48 2004
Subject: [Rd] a better 
Message-ID: <20041130122037.4A39039C5@mprdmxin.myway.com>


> From:   Martin Maechler <maechler@stat.math.ethz.ch>
>  
> >>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
> >>>>> on Sun, 28 Nov 2004 10:25:24 -0500 writes:
> 
> Duncan> <........>
> Duncan> <........>
> 
> Duncan> We already have code to source() from the clipboard, and it could
> Duncan> address the problems above, but:
> 
> Duncan> - Source with echo=T doesn't echo, it deparses, so some comments are
> Duncan> lost, formatting is changed, etc.
> 
> yes, and we would have liked to have an alternative "source()"
> for a *very* long time...
> Examples where I "hate" the non-echo (i.e. the loss of all
> comments and own-intended formatting) is when you use it for
> demos, etc, notably in R's own demo() and example() functions.
> 
> But to do this might be more tricky than at first thought:
> Of course you can readLines() the source file and writeLines()
> them to whatever your console is. The slightly difficult thing
> is to "see" which junks to ``send to R'' , i.e. to parse() and eval().
> The basic problem seems to see when expressions are complete.
> 
> Maybe we should / could think about enhancing parse() {or a new
> function with extended behavior} such that it would not only
> return the parse()d expressions, but also indices (byte or even
> line counters) to the source text, indicating where each of the
> expression started and ended.
> 
> That way I could see a way to proceed.

The other problems with source() are (1) reading from stdin so that
one can create self contained files.  (2) Even if possible, it
would also be nice to be able to put the data at the end of
the file so the code is not broken up by potentially large
stretches of data.

Number (1) can be addressed by pasting the output of dput
into your file but its not pretty.  A workaround addressing
both (1) and (2) is in:

https://stat.ethz.ch/pipermail/r-help/2003-June/033622.html

Perhaps these two considerations could be taken into account
if source() is being revisited.






 --- On Tue 11/30, Martin Maechler < maechler@stat.math.ethz.ch > wrote:
From: Martin Maechler [mailto: maechler@stat.math.ethz.ch]
To: murdoch@stats.uwo.ca
     Cc: r-devel@stat.math.ethz.ch
Date: Tue, 30 Nov 2004 12:51:12 +0100
Subject: [Rd] a better "source(echo=TRUE)"  {was "....how to pause...."}

>>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca><br>>>>>>     on Sun, 28 Nov 2004 10:25:24 -0500 writes:<br><br>    Duncan> <........><br>    Duncan> <........><br><br>    Duncan> We already have code to source() from the clipboard, and it could<br>    Duncan> address the problems above, but:<br><br>    Duncan> - Source with echo=T doesn't echo, it deparses, so some comments are<br>    Duncan> lost, formatting is changed, etc.<br><br>yes, and we would have liked to have an alternative "source()"<br>for a *very* long time...<br>Examples where I "hate" the non-echo (i.e. the loss of all<br>comments and own-intended formatting) is when you use it for<br>demos, etc, notably in R's own  demo() and example() functions.<br><br>But to do this might be more tricky than at first thought:<br>Of course you can readLines() the source file and writeLines()<br>them to whatever your console is. The slightly difficult thing<br>is to "see" which junks to ``send to R'' , i.e. to parse() and eval().<br>The basic problem seems to see when expressions are complete.<br><br>Maybe we should / could think about enhancing parse() {or a new<br>function with extended behavior} such that it would not only<br>return the parse()d expressions, but also indices (byte or even<br>line counters) to the source text, indicating where each of the<br>expression started and ended.<br><br>That way I could see a way to proceed.<br><br>Martin<br><br>    Duncan> <........><br>    Duncan> <........><br><br>______________________________________________<br>R-devel@stat.math.ethz.ch mailing list<br>https://stat.ethz.ch/mailman/listinfo/r-devel<br>

From h.j.spohr at fz-juelich.de  Tue Nov 30 13:25:22 2004
From: h.j.spohr at fz-juelich.de (Harald-Josef Spohr)
Date: Tue Nov 30 13:25:25 2004
Subject: [Rd] Integration of Ansi-C code in R under Windows
Message-ID: <41AC66B2.6000303@fz-juelich.de>

Hello at all!

I have problems with the integration of Ansi-C code into R. Using R 
Version1.8.0 under Windows 98SE I am trying to include some  code but 
neither what is written in the "Writing R Extensions"-Manual nor the 
information in the "FAQ for R under Windows" works. Maybe I have 
overlooked something, but I am not able to do what I have to.

Is someone here who could describe step by step what I have to do. I 
think the version for stupid people may be the best one.

Greatings
Harald Spohr

From Friedrich.Leisch at tuwien.ac.at  Tue Nov 30 13:27:38 2004
From: Friedrich.Leisch at tuwien.ac.at (Friedrich.Leisch@tuwien.ac.at)
Date: Tue Nov 30 13:27:42 2004
Subject: [Rd] a better "source(echo=TRUE)"  {was "....how to pause...."}
In-Reply-To: <16812.24240.754731.879678@gargle.gargle.HOWL>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<16812.24240.754731.879678@gargle.gargle.HOWL>
Message-ID: <16812.26426.842631.422085@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 30 Nov 2004 12:51:12 +0100,
>>>>> Martin Maechler (MM) wrote:

[...]

  > But to do this might be more tricky than at first thought:
  > Of course you can readLines() the source file and writeLines()
  > them to whatever your console is. The slightly difficult thing
  > is to "see" which junks to ``send to R'' , i.e. to parse() and eval().
  > The basic problem seems to see when expressions are complete.

> Maybe we should / could think about enhancing parse() {or a new
  > function with extended behavior} such that it would not only
  > return the parse()d expressions, but also indices (byte or even
  > line counters) to the source text, indicating where each of the
  > expression started and ended.

  > That way I could see a way to proceed.

Yes, that would be also *very* handy for Sweave, where I parse/deparse
exactly for the reasons Martin describes: to get complete expressions
and to know where output should be inserted.

.f

From edd at debian.org  Tue Nov 30 14:09:29 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue Nov 30 14:09:38 2004
Subject: [Rd] Please don't assume a display for package installation
In-Reply-To: <Pine.LNX.4.61.0411300902570.11575@gannet.stats>
References: <Pine.LNX.4.61.0411300902570.11575@gannet.stats>
Message-ID: <20041130130929.GA24969@sonny.eddelbuettel.com>

On Tue, Nov 30, 2004 at 09:09:23AM +0000, Prof Brian Ripley wrote:
> SciViews is the latest of several packages that need an X server to 
> complete package installation.
>
> Please bear in mind that packages may get installed on a server with no 
> display, yet run on client workstations with displays.  If your package is 

Or are built in a chroot / batch mode setting without $DISPLAY.  I had two
or three CRAN/BioC packages fail as well when I auto-built over 500 packages
(i.e. all not yet available as Debian binaries) for the newest Quantian
(which is currently being uploaded; takes some 20 to 24 hours on my capped
domestic broadband line).

> intended to start a window when it starts up, please test for a display 
> first (e.g. via capabilities("X11")).
> 
> There are ways around this (running Xvfb, arranging a remote display) but 
> they are tedious at best (and few machines come with Xvfb installed).

Yes, would be nice to fix this.

Dirk

-- 
If your hair is standing up, then you are in extreme danger.
      -- http://www.usafa.af.mil/dfp/cockpit-phys/fp1ex3.htm

From Per.Broberg at astrazeneca.com  Tue Nov 30 15:38:43 2004
From: Per.Broberg at astrazeneca.com (Per.Broberg@astrazeneca.com)
Date: Tue Nov 30 15:39:46 2004
Subject: [Rd] Build package for R 2.0.1 under Windows
Message-ID: <283517E97112D611A94C0001FA7E5D5A04F00DB9@se-drc-mail3.selu.astrazeneca.net>


This summer I and a colleague built a package for R v 1.9.1 containing
C-code under Windows. That only worked for us when
R was installed in c:\program files\R. Now I have R v 2.0.1 and the same
package won't build. I get the following

C:\Program Files\R\rw2001\bin>rcmd check "c:\program
files\r\rw2001\src\library\
sag"
* checking for working latex ...latex: not found
 NO
* using log directory 'C:/Program Files/R/rw2001/bin/sag.Rcheck'
* checking for file 'sag/DESCRIPTION' ... OK
* checking if this is a source package ... OK

installing R.css in C:/PROGRA~1/R/rw2001/bin/SAG~1.RCH


---------- Making package sag ------------
  adding build stamp to DESCRIPTION
  making DLL ...
  ... DLL made
  installing DLL
  installing R files
  installing man source files
  installing indices
  installing help
 >>> Building/Updating help pages for package 'sag'
     Formats: text html latex example chm
  Fstat                             text    html    latex   example
 

# I delete some of the list of functions

  samrocn                           text    html    latex
  samrocnboot                       text    html    latex   example

Microsoft HTML Help Compiler 4.74.8702

Compiling c:\PROGRA~1\r\rw2001\src\library\sag\chm\sag.chm


Compile time: 0 minutes, 1 second
40      Topics
78      Local links
9       Internet links
1       Graphic


Created c:\PROGRA~1\r\rw2001\src\library\sag\chm\sag.chm, 54,723 bytes
Compression decreased file by 51,513 bytes.
  preparing package sag for lazy loading
Error in findpack(package, lib.loc) : There is no package called 'sag'
Execution halted
make: *** [lazyload] Error 1
*** Installation of sag failed ***

Removing 'C:/PROGRA~1/R/rw2001/bin/SAG~1.RCH/sag'
 ERROR
Installation failed. 

What happened?

Per Broberg

From ripley at stats.ox.ac.uk  Tue Nov 30 16:15:08 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 30 16:15:22 2004
Subject: [Rd] Build package for R 2.0.1 under Windows
In-Reply-To: <283517E97112D611A94C0001FA7E5D5A04F00DB9@se-drc-mail3.selu.astrazeneca.net>
References: <283517E97112D611A94C0001FA7E5D5A04F00DB9@se-drc-mail3.selu.astrazeneca.net>
Message-ID: <Pine.LNX.4.61.0411301510370.26457@gannet.stats>

On Tue, 30 Nov 2004 Per.Broberg@astrazeneca.com wrote:

> This summer I and a colleague built a package for R v 1.9.1 containing
> C-code under Windows. That only worked for us when
> R was installed in c:\program files\R. Now I have R v 2.0.1 and the same
> package won't build. I get the following
>
> C:\Program Files\R\rw2001\bin>rcmd check "c:\program
> files\r\rw2001\src\library\
> sag"
> * checking for working latex ...latex: not found
> NO
> * using log directory 'C:/Program Files/R/rw2001/bin/sag.Rcheck'
> * checking for file 'sag/DESCRIPTION' ... OK
> * checking if this is a source package ... OK
>
> installing R.css in C:/PROGRA~1/R/rw2001/bin/SAG~1.RCH
>
>
> ---------- Making package sag ------------
>  adding build stamp to DESCRIPTION
>  making DLL ...
>  ... DLL made
>  installing DLL
>  installing R files
>  installing man source files
>  installing indices
>  installing help
> >>> Building/Updating help pages for package 'sag'
>     Formats: text html latex example chm
>  Fstat                             text    html    latex   example
>
>
> # I delete some of the list of functions
>
>  samrocn                           text    html    latex
>  samrocnboot                       text    html    latex   example
>
> Microsoft HTML Help Compiler 4.74.8702
>
> Compiling c:\PROGRA~1\r\rw2001\src\library\sag\chm\sag.chm
>
>
> Compile time: 0 minutes, 1 second
> 40      Topics
> 78      Local links
> 9       Internet links
> 1       Graphic
>
>
> Created c:\PROGRA~1\r\rw2001\src\library\sag\chm\sag.chm, 54,723 bytes
> Compression decreased file by 51,513 bytes.
>  preparing package sag for lazy loading
> Error in findpack(package, lib.loc) : There is no package called 'sag'
> Execution halted
> make: *** [lazyload] Error 1
> *** Installation of sag failed ***
>
> Removing 'C:/PROGRA~1/R/rw2001/bin/SAG~1.RCH/sag'
> ERROR
> Installation failed.
>
> What happened?

See the advice about not installing R into a path with spaces in.  Not 
that we can reproduce this: I have tried a lot of combinations with spaces 
in and all work for me.

I suspect

cd C:\Program Files\R\rw2001\src\library
..\..\bin\rcmd check sag

will work.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Tue Nov 30 16:24:34 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 16:24:45 2004
Subject: [Rd] RFC: Different handling of commands from clipboard in
	Windows Re: [R] how to pause between plots running scripts?
In-Reply-To: <2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
Message-ID: <044pq0p90uhmrg1pu8gpjma0495i7jocjh@4ax.com>

On Sun, 28 Nov 2004 10:25:24 -0500, Duncan Murdoch
<murdoch@stats.uwo.ca> wrote :

>Another that deals only with the original graphics problem is to have 
>par(ask=T) wait for input to the graphics window, rather than to the
>console.  This has the advantage that the graphics window probably has
>the focus, so a simple Enter there could satisfy it.

I've now put this in place in R-devel, for the windows() device only.
It would be a little cleaner if every device had this capability, but
I'm not sure how much code it would break to add a new function to the
graphics device structure, and I haven't done that.  

With the new version, things like "demo(plotmath)" look a lot nicer.
I haven't done a huge amount of testing yet, so there may be examples
where this doesn't work so nicely.

A new binary build should be on CRAN and the mirrors by tomorrow.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Tue Nov 30 16:47:37 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 30 16:47:40 2004
Subject: [Rd] Cross-compiling R for Windows on linux
In-Reply-To: <200411261712.13391.markus.helbig@student.uni-augsburg.de>
References: <200411261712.13391.markus.helbig@student.uni-augsburg.de>
Message-ID: <Pine.LNX.4.61.0411301400220.26457@gannet.stats>

On Fri, 26 Nov 2004, Markus Helbig wrote:

> I tried to cross-compile the newest release 2.0.1 on a linux machine, but i
> always got an error at the following stage
>
> DHAVE_CONFIG_H -DR_DLL_BUILD  -c dynload.c -o dynload.o
> dynload.c: In function `R_loadLibrary':
> dynload.c:94: warning: implicit declaration of function `_controlfp'
> dynload.c:94: error: `_MCW_IC' undeclared (first use in this function)
> dynload.c:94: error: (Each undeclared identifier is reported only once
> dynload.c:94: error: for each function it appears in.)
> dynload.c:95: warning: implicit declaration of function `_clearfp'
> dynload.c:99: error: `_MCW_EM' undeclared (first use in this function)
> dynload.c:99: error: `_MCW_RC' undeclared (first use in this function)
> dynload.c:99: error: `_MCW_PC' undeclared (first use in this function)
> make[4]: *** [dynload.o] Error 1
> make[3]: *** [../../bin/R.dll] Error 2
> make[2]: *** [rbuild] Error 2
> make[1]: *** [all] Error 2
> make[1]: Leaving directory `/home/markus/Development/r-project/WinR/R-2.0.1/
> src/gnuwin32'
>
> Anybody knows what do to now?

Check up that your cross--build setup is complete and MkRules was set 
correctly.  These declaration are in .../i586-mingw32/include/float.h and 
I guess you probably haven't set HEADER in MkRules.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jeff.hamann at forestinformatics.com  Tue Nov 30 17:01:14 2004
From: jeff.hamann at forestinformatics.com (Jeff D. Hamann)
Date: Tue Nov 30 17:01:37 2004
Subject: [Rd] data is getting corrupted
In-Reply-To: <38nnq0lmi3v96aqov831lln4mkn3bt11ud@4ax.com>
References: <1131.128.193.136.240.1101749262.squirrel@www.forestinformatics.com> 
	<38nnq0lmi3v96aqov831lln4mkn3bt11ud@4ax.com>
Message-ID: <1083.128.193.136.240.1101830474.squirrel@www.forestinformatics.com>

I'm not sure I described the problem correctly with my last post.

The structure that is being allocated contains fixed length arrays and
thus, the location of the strings aren't NULL (the contents are however).

struct SAMPLE_RECORD
{
char            forest[HEADER_CHAR_STR];       /*  forest identifier    */
char            subunit[HEADER_CHAR_STR];      /*  subunit              */
char            stand_name[HEADER_CHAR_STR];   /*  stand name           */
char            legal[HEADER_CHAR_STR];        /*  legal description    */
long            elevation;                     /*  elevation (ft)       */
double          acreage;                       /*  number of acres      */
unsigned long   age;                           /*  stand age            */

unsigned long   sampled_month;     /*  month of the year    */
unsigned long   sampled_day;       /*  day of the month     */
unsigned long   sampled_year;      /*  year measured        */
unsigned long   current_year;      /*  year of forecast     */

double x0;

unsigned long           n_points;
struct PLOT_RECORD      *plots_ptr;

unsigned long           n_plants;
struct PLANT_RECORD     *plants_ptr;
};

The plots_ptr and plants_ptr are set to NULL because they're not static
arrays and are allocated.

Since the problem didn't manifest itself within the strings, but rather in
the arrays that are allocated (plants_ptr) and specifically a single
column (variable) that occurs within the plants_ptr, I still think I have
a problem with the PROTECT/UNPROTECT operations because with small
data.frames (200 rows x 10 cols) the code works fine. With larger
data.frames (2000 rows x 10 cols), then the corruption begins. COuld this
be a problem with the sequencing of the allocate
plants_ptr->PROTECT->assign values to variables->UNPROTECT? Is it possible
to find out when R is performing garbage collection or moving data around?

Thanks,
Jeff.


Duncan Murdoch said:
> On Mon, 29 Nov 2004 09:27:42 -0800 (PST), "Jeff D. Hamann"
> <jeff.hamann@forestinformatics.com> wrote:
>
>>/* this function converts the sample list	*/
>>/* from R into the internal structure		*/
>>struct SAMPLE_RECORD *build_sample_from_sexp( SEXP sample )
>>{
>
> [ declarations deleted ]
>
>>
>>   char                    temp_sp_code[16];
>>   struct SAMPLE_RECORD *s_ptr;
>>   struct SPECIES_RECORD *sp_ptr;
>>
>>   s_ptr = (struct SAMPLE_RECORD *)calloc( 1, sizeof( struct
>> SAMPLE_RECORD
>>) );
>
> This allocates a structure, initialized to all zeros.
>
>>/*    s_ptr = (struct SAMPLE_RECORD *)Calloc( 1,  struct SAMPLE_RECORD );
>> */
>>
>>   /* *fill in the header info */
>>   strcpy( s_ptr->forest,
>>CHAR(STRING_ELT(get_list_element(sample,"forest"), 0)) ) ;
>
> This copies the string element to the address s_ptr->forest points to,
> which is address 0, since you didn't change it from the initial NULL.
> I'm surprised you didn't get a bigger error than the one you saw.
>
> [ more deletions ]
>
>>I'm sure there's something I don't understand about the PROTECT/UNPROTECT
>>sequence as this seems to work on smaller data.frames
>
> Maybe you were just lucky that the overwriting at address 0 didn't
> trash anything in those cases?
>
> Duncan Murdoch
>


-- 
Jeff D. Hamann
Forest Informatics, Inc.
PO Box 1421
Corvallis, Oregon 97339-1421
phone 541-754-1428
fax 541-752-0288
jeff.hamann@forestinformatics.com
http://www.forestinformatics.com

From murdoch at stats.uwo.ca  Tue Nov 30 17:50:43 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 17:51:00 2004
Subject: [Rd] data is getting corrupted
In-Reply-To: <1083.128.193.136.240.1101830474.squirrel@www.forestinformatics.com>
References: <1131.128.193.136.240.1101749262.squirrel@www.forestinformatics.com>
	<38nnq0lmi3v96aqov831lln4mkn3bt11ud@4ax.com>
	<1083.128.193.136.240.1101830474.squirrel@www.forestinformatics.com>
Message-ID: <k29pq05jeoru98m9et85pqf16mo812rhql@4ax.com>

On Tue, 30 Nov 2004 08:01:14 -0800 (PST), "Jeff D. Hamann"
<jeff.hamann@forestinformatics.com> wrote :

>I'm not sure I described the problem correctly with my last post.

Or maybe I missed that.  Sorry!

>The structure that is being allocated contains fixed length arrays and
>thus, the location of the strings aren't NULL (the contents are however).

I'd suggest using strncpy instead of strcpy; it might be that one of
your strings is longer than expected, and is overwriting something it
shouldn't.

Duncan Murdoch
>
>struct SAMPLE_RECORD
>{
>char            forest[HEADER_CHAR_STR];       /*  forest identifier    */
>char            subunit[HEADER_CHAR_STR];      /*  subunit              */
>char            stand_name[HEADER_CHAR_STR];   /*  stand name           */
>char            legal[HEADER_CHAR_STR];        /*  legal description    */
>long            elevation;                     /*  elevation (ft)       */
>double          acreage;                       /*  number of acres      */
>unsigned long   age;                           /*  stand age            */
>
>unsigned long   sampled_month;     /*  month of the year    */
>unsigned long   sampled_day;       /*  day of the month     */
>unsigned long   sampled_year;      /*  year measured        */
>unsigned long   current_year;      /*  year of forecast     */
>
>double x0;
>
>unsigned long           n_points;
>struct PLOT_RECORD      *plots_ptr;
>
>unsigned long           n_plants;
>struct PLANT_RECORD     *plants_ptr;
>};
>
>The plots_ptr and plants_ptr are set to NULL because they're not static
>arrays and are allocated.
>
>Since the problem didn't manifest itself within the strings, but rather in
>the arrays that are allocated (plants_ptr) and specifically a single
>column (variable) that occurs within the plants_ptr, I still think I have
>a problem with the PROTECT/UNPROTECT operations because with small
>data.frames (200 rows x 10 cols) the code works fine. With larger
>data.frames (2000 rows x 10 cols), then the corruption begins. COuld this
>be a problem with the sequencing of the allocate
>plants_ptr->PROTECT->assign values to variables->UNPROTECT? Is it possible
>to find out when R is performing garbage collection or moving data around?
>
>Thanks,
>Jeff.
>
>
>Duncan Murdoch said:
>> On Mon, 29 Nov 2004 09:27:42 -0800 (PST), "Jeff D. Hamann"
>> <jeff.hamann@forestinformatics.com> wrote:
>>
>>>/* this function converts the sample list	*/
>>>/* from R into the internal structure		*/
>>>struct SAMPLE_RECORD *build_sample_from_sexp( SEXP sample )
>>>{
>>
>> [ declarations deleted ]
>>
>>>
>>>   char                    temp_sp_code[16];
>>>   struct SAMPLE_RECORD *s_ptr;
>>>   struct SPECIES_RECORD *sp_ptr;
>>>
>>>   s_ptr = (struct SAMPLE_RECORD *)calloc( 1, sizeof( struct
>>> SAMPLE_RECORD
>>>) );
>>
>> This allocates a structure, initialized to all zeros.
>>
>>>/*    s_ptr = (struct SAMPLE_RECORD *)Calloc( 1,  struct SAMPLE_RECORD );
>>> */
>>>
>>>   /* *fill in the header info */
>>>   strcpy( s_ptr->forest,
>>>CHAR(STRING_ELT(get_list_element(sample,"forest"), 0)) ) ;
>>
>> This copies the string element to the address s_ptr->forest points to,
>> which is address 0, since you didn't change it from the initial NULL.
>> I'm surprised you didn't get a bigger error than the one you saw.
>>
>> [ more deletions ]
>>
>>>I'm sure there's something I don't understand about the PROTECT/UNPROTECT
>>>sequence as this seems to work on smaller data.frames
>>
>> Maybe you were just lucky that the overwriting at address 0 didn't
>> trash anything in those cases?
>>
>> Duncan Murdoch
>>

From ripley at stats.ox.ac.uk  Tue Nov 30 18:56:08 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Nov 30 18:56:12 2004
Subject: [Rd] \link{} to help pages in Debian
In-Reply-To: <1101730130.9033.41.camel@xurelo.azti.local>
References: <1101641542.9033.10.camel@xurelo.azti.local>
	<16810.59850.727242.266509@gargle.gargle.HOWL>
	<1101730130.9033.41.camel@xurelo.azti.local>
Message-ID: <Pine.LNX.4.61.0411301751100.11452@gannet.stats>

On Mon, 29 Nov 2004, Iago Mosqueira wrote:

> On Mon, 2004-11-29 at 09:20, Martin Maechler wrote:
>
>> not at all!
>> We have been working with several libraries "forever",
>> and I think I have n't seen your problem ever.
>
> I have detected it only in one package, which happens to conatin links
> to base and graphics. It seems they are generated at install time simply
> by assuming the root of all packages is the same.

Yes, and it is true as they are all linked to the same tree when 
help.start is run.  You do need the alternative trees to be in your 
.libPath() at that time.

> Obviously this is not a problem in Windows, where all packages appear to
> be installed, at least by default, in the same tree.

Only by default, just as by default they are under Linux, so `obviously' 
you don't know what happens under either.  Is Windows relevant here (the 
picture is a lot more complicated there)?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.murrell at auckland.ac.nz  Tue Nov 30 20:55:27 2004
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Nov 30 20:54:57 2004
Subject: [Rd] pausing between plots - waiting for graphics input
References: <b68812e704112708422b5228a4@mail.gmail.com>	<1101582479.13352.37.camel@horizons.localdomain>	<b68812e704112718032d3cf7d8@mail.gmail.com>	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>	<16812.22791.971545.79304@gargle.gargle.HOWL>
	<jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>
Message-ID: <41ACD02F.4000105@stat.auckland.ac.nz>

Hi


Duncan Murdoch wrote:
> On Tue, 30 Nov 2004 12:27:03 +0100, Martin Maechler
> <maechler@stat.math.ethz.ch> wrote:
> 
> 
>>{I have changed the subject to match this interesting side thread}
>>
>>
>>>>>>>"TL" == Thomas Lumley <tlumley@u.washington.edu>
>>>>>>>    on Mon, 29 Nov 2004 09:15:27 -0800 (PST) writes:
>>>>>>
>>   TL> On Sun, 28 Nov 2004, Duncan Murdoch wrote:
>>   >> 
>>   >> Another that deals only with the original graphics problem is to have
>>   >> par(ask=T) wait for input to the graphics window, rather than to the
>>   >> console.  This has the advantage that the graphics window probably has
>>   >> the focus, so a simple Enter there could satisfy it.
>>   >> 
>>
>>   TL> I like this one.  I have often found it irritating that
>>   TL> I have to switch the focus back to the console (which
>>   TL> means uncovering the console window) to get the next
>>   TL> graph.
>>
>>I agree. 
>>Note that this is not windows-specific really.  Rather, this
>>should be applicable to all devices which support minimal mouse
>>interaction, i.e. at least those that support locator(),
>>ideally just all those listed in  dev.interactive
>>
>>However, I'm not at all sure that this should be done with  
>>par(ask = TRUE)  which works on all devices, not just
>>interactive ones.
>>Rather, we probably should a new par() {and gpar() for grid !}
>>option for the new feature,
>>maybe something like [g]par(wait_mouseclick = TRUE)
> 
> 
> If we add a new par(), then none of the existing examples will work
> with it, so we'll get inconsistent behaviour and it will be really
> irritating.
> 
> I think the cleanest way to implement this would be to add a new
> standard graphics driver function that stops to wait for the user, and
> use the existing NewFrameConfirm or equivalent as a default.  However,
> I'm going to try a more roundabout implementation just for the Windows
> device first, just to see if I like it.


This sounds like the general problem of being able to capture keyboard 
input on a graphics device (a key-stroke equivalent of dev_locator). 
Robert has been keen on this for a while too.

It would presumably be not too difficult to implement something modal 
(like dev_locator) - in effect, a dev_eventloop, which blocks the 
command line and processes events (both mouse clicks and key strokes) in 
a particular graphics window until a prearranged event to quit.  Nasty 
modal behaviour, but doable and obviously useful in some ways.  Any 
interest in that?

A much nicer solution of course would be asynchronous event handling in 
the graphics window (i.e., you don't block the command line), but that 
depends on the event loop integration problem being solved and that does 
not look like happening soon.

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From p.dalgaard at biostat.ku.dk  Tue Nov 30 21:45:27 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Nov 30 21:48:03 2004
Subject: [Rd] pausing between plots - waiting for graphics input
In-Reply-To: <41ACD02F.4000105@stat.auckland.ac.nz>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>
	<16812.22791.971545.79304@gargle.gargle.HOWL>
	<jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>
	<41ACD02F.4000105@stat.auckland.ac.nz>
Message-ID: <x2653n2hi0.fsf@biostat.ku.dk>

Paul Murrell <p.murrell@auckland.ac.nz> writes:

> > use the existing NewFrameConfirm or equivalent as a default.  However,
> > I'm going to try a more roundabout implementation just for the Windows
> > device first, just to see if I like it.
> 
> 
> This sounds like the general problem of being able to capture keyboard
> input on a graphics device (a key-stroke equivalent of dev_locator).
> Robert has been keen on this for a while too.

We might want to think a bit more carefully about the ergonomics. It
is actually not very obvious for users to send keypresses to a
graphics window, unlesse there's a "Press any key" style instruction
somewhere, and preferably not in a partially obscured console. A
"Continue" button would be a much more obvious GUI design. 
 
> It would presumably be not too difficult to implement something modal
> (like dev_locator) - in effect, a dev_eventloop, which blocks the
> command line and processes events (both mouse clicks and key strokes)
> in a particular graphics window until a prearranged event to quit.
> Nasty modal behaviour, but doable and obviously useful in some ways.
> Any interest in that?

Sure, but the general structure probably needs a bit of attention.
There could be different preferred methods for different devices,
possibly with the current method as a fallback.

> A much nicer solution of course would be asynchronous event handling
> in the graphics window (i.e., you don't block the command line), but
> that depends on the event loop integration problem being solved and
> that does not look like happening soon.

Not sure we really want that actually. What if someone issues a plot
command from the command line? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Tue Nov 30 22:00:36 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 22:00:41 2004
Subject: [Rd] pausing between plots - waiting for graphics input
In-Reply-To: <41ACD02F.4000105@stat.auckland.ac.nz>
References: <b68812e704112708422b5228a4@mail.gmail.com>	<1101582479.13352.37.camel@horizons.localdomain>	<b68812e704112718032d3cf7d8@mail.gmail.com>	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>	<16812.22791.971545.79304@gargle.gargle.HOWL>
	<jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>
	<41ACD02F.4000105@stat.auckland.ac.nz>
Message-ID: <rdmpq0p3b38fk1vupird057t7bnha2kf5f@4ax.com>

On Wed, 01 Dec 2004 08:55:27 +1300, Paul Murrell
<p.murrell@auckland.ac.nz> wrote :

>This sounds like the general problem of being able to capture keyboard 
>input on a graphics device (a key-stroke equivalent of dev_locator). 
>Robert has been keen on this for a while too.
>
>It would presumably be not too difficult to implement something modal 
>(like dev_locator) - in effect, a dev_eventloop, which blocks the 
>command line and processes events (both mouse clicks and key strokes) in 
>a particular graphics window until a prearranged event to quit.  Nasty 
>modal behaviour, but doable and obviously useful in some ways.  Any 
>interest in that?

You mean something like this?

The user sees a function 

 graphevents <- function(handler, events = c('mousedown', 'mouseup',
'mousemove', 'keydown', 'keyup') , prompt = 'Please do something')

which calls the handler function with a standard set of args
indicating what event just happened and keeps going until the handler
returns some non-NULL value.  So locating a single point could be
implemented as

 onmousedown <- function(event, button, x, y) {
      c(x,y)
 }

 graphevents(onmousedown, events='mousedown', prompt='Click on the
graph')

and waiting for the user to hit a key could be implemented as

 onkeyup <- function(event, key) {
   TRUE
 }

 graphevents(onkeyup, events='keyup', prompt='Hit any key')

If we wanted both, maybe we could have

 graphevents( list(onmousedown, onkeyup), c('mousedown', 'keyup'))

That would be fairly easy to implement in the windows() device, but I
have no idea if it would make sense in other interactive devices.
Issues would be defining what sort of values "key" would take, what
events to allow handlers for, what the event handler arg lists would
look like, and so on.  A test of whether it was good enough might be
whether locator() could be rewritten in R.

>A much nicer solution of course would be asynchronous event handling in 
>the graphics window (i.e., you don't block the command line), but that 
>depends on the event loop integration problem being solved and that does 
>not look like happening soon.

Yes, definitely harder.

Duncan

From murdoch at stats.uwo.ca  Tue Nov 30 22:22:31 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Nov 30 22:22:38 2004
Subject: [Rd] pausing between plots - waiting for graphics input
In-Reply-To: <x2653n2hi0.fsf@biostat.ku.dk>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>
	<16812.22791.971545.79304@gargle.gargle.HOWL>
	<jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>
	<41ACD02F.4000105@stat.auckland.ac.nz>
	<x2653n2hi0.fsf@biostat.ku.dk>
Message-ID: <m0opq0l8p61kfvi5kosj1gt4438ofls8um@4ax.com>

On 30 Nov 2004 21:45:27 +0100, Peter Dalgaard
<p.dalgaard@biostat.ku.dk> wrote :

>Paul Murrell <p.murrell@auckland.ac.nz> writes:
>
>> > use the existing NewFrameConfirm or equivalent as a default.  However,
>> > I'm going to try a more roundabout implementation just for the Windows
>> > device first, just to see if I like it.
>> 
>> 
>> This sounds like the general problem of being able to capture keyboard
>> input on a graphics device (a key-stroke equivalent of dev_locator).
>> Robert has been keen on this for a while too.
>
>We might want to think a bit more carefully about the ergonomics. It
>is actually not very obvious for users to send keypresses to a
>graphics window, unlesse there's a "Press any key" style instruction
>somewhere, and preferably not in a partially obscured console. A
>"Continue" button would be a much more obvious GUI design. 

I agree, you need to worry that the user knows you're asking for
input.  In today's Windows R-devel build, I worked pretty hard to make
sure this wouldn't be a problem:

- The graphics window moves to the front
- The graphics menu bar switches to a menu saying "Next"
- The console status line (shown only in MDI mode, I think) says that
the graph is waiting for input
- The graphics window title prompts the user for input.

This was just to handle par(ask = TRUE).  For the general problem of
asking for input from the graph window, I'd say in Windows the 1st and
3rd items above should always happen, the second item is optional (but
the regular menu bar should definitely disappear or be disabled), the
last should be specified by whoever calls this function to ask for
input.  However, the conventions on X are different enough that other
cues should presumably be used there.
 
>> It would presumably be not too difficult to implement something modal
>> (like dev_locator) - in effect, a dev_eventloop, which blocks the
>> command line and processes events (both mouse clicks and key strokes)
>> in a particular graphics window until a prearranged event to quit.
>> Nasty modal behaviour, but doable and obviously useful in some ways.
>> Any interest in that?
>
>Sure, but the general structure probably needs a bit of attention.
>There could be different preferred methods for different devices,
>possibly with the current method as a fallback.

Current method?  Do you just mean the par(ask = TRUE) behaviour, or is
there something more already there?

>> A much nicer solution of course would be asynchronous event handling
>> in the graphics window (i.e., you don't block the command line), but
>> that depends on the event loop integration problem being solved and
>> that does not look like happening soon.
>
>Not sure we really want that actually. What if someone issues a plot
>command from the command line? 

There are definitely lots of issues.  In Windows it would be sensible
for most event handling to be shut down during function evaluation
unless specifically reactivated (but not all; low level stuff like
redraws still need to be done).  But I understood from discussions
last year that X uses a very different event model, so this wouldn't
make sense.

Duncan

From p.murrell at auckland.ac.nz  Tue Nov 30 22:32:57 2004
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Nov 30 22:32:30 2004
Subject: [Rd] pausing between plots - waiting for graphics input
References: <b68812e704112708422b5228a4@mail.gmail.com>	<1101582479.13352.37.camel@horizons.localdomain>	<b68812e704112718032d3cf7d8@mail.gmail.com>	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>	<16812.22791.971545.79304@gargle.gargle.HOWL>
	<jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>
	<41ACD02F.4000105@stat.auckland.ac.nz>
	<rdmpq0p3b38fk1vupird057t7bnha2kf5f@4ax.com>
Message-ID: <41ACE709.1090205@stat.auckland.ac.nz>

Hi


Duncan Murdoch wrote:
> On Wed, 01 Dec 2004 08:55:27 +1300, Paul Murrell
> <p.murrell@auckland.ac.nz> wrote :
> 
> 
>>This sounds like the general problem of being able to capture keyboard 
>>input on a graphics device (a key-stroke equivalent of dev_locator). 
>>Robert has been keen on this for a while too.
>>
>>It would presumably be not too difficult to implement something modal 
>>(like dev_locator) - in effect, a dev_eventloop, which blocks the 
>>command line and processes events (both mouse clicks and key strokes) in 
>>a particular graphics window until a prearranged event to quit.  Nasty 
>>modal behaviour, but doable and obviously useful in some ways.  Any 
>>interest in that?
> 
> 
> You mean something like this?


Yes.


> The user sees a function 
> 
>  graphevents <- function(handler, events = c('mousedown', 'mouseup',
> 'mousemove', 'keydown', 'keyup') , prompt = 'Please do something')
> 
> which calls the handler function with a standard set of args
> indicating what event just happened and keeps going until the handler
> returns some non-NULL value.  So locating a single point could be
> implemented as
> 
>  onmousedown <- function(event, button, x, y) {
>       c(x,y)
>  }
> 
>  graphevents(onmousedown, events='mousedown', prompt='Click on the
> graph')
> 
> and waiting for the user to hit a key could be implemented as
> 
>  onkeyup <- function(event, key) {
>    TRUE
>  }
> 
>  graphevents(onkeyup, events='keyup', prompt='Hit any key')
> 
> If we wanted both, maybe we could have
> 
>  graphevents( list(onmousedown, onkeyup), c('mousedown', 'keyup'))
> 
> That would be fairly easy to implement in the windows() device, but I
> have no idea if it would make sense in other interactive devices.
> Issues would be defining what sort of values "key" would take, what
> events to allow handlers for, what the event handler arg lists would
> look like, and so on.  A test of whether it was good enough might be
> whether locator() could be rewritten in R.


We could aim for a pretty conservative subset to ensure 
cross-platformedness and still gain a LOT more compared to the current 
capture-mouse-click-only.  Things like Java's KeyEvent could provide 
some nice templates to follow.

Paul


>>A much nicer solution of course would be asynchronous event handling in 
>>the graphics window (i.e., you don't block the command line), but that 
>>depends on the event loop integration problem being solved and that does 
>>not look like happening soon.
> 
> 
> Yes, definitely harder.
> 
> Duncan


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From p.dalgaard at biostat.ku.dk  Tue Nov 30 23:10:58 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Nov 30 23:13:39 2004
Subject: [Rd] pausing between plots - waiting for graphics input
In-Reply-To: <m0opq0l8p61kfvi5kosj1gt4438ofls8um@4ax.com>
References: <b68812e704112708422b5228a4@mail.gmail.com>
	<1101582479.13352.37.camel@horizons.localdomain>
	<b68812e704112718032d3cf7d8@mail.gmail.com>
	<vuhiq095lke0trblge8161b3dakaubg776@4ax.com>
	<2kpjq0p9bq1i8b2258rl71bds4k9bg83fq@4ax.com>
	<Pine.A41.4.61b.0411290912110.88302@homer09.u.washington.edu>
	<16812.22791.971545.79304@gargle.gargle.HOWL>
	<jrnoq05l7bk577i9agfjctgh8k2jq8ls7m@4ax.com>
	<41ACD02F.4000105@stat.auckland.ac.nz> <x2653n2hi0.fsf@biostat.ku.dk>
	<m0opq0l8p61kfvi5kosj1gt4438ofls8um@4ax.com>
Message-ID: <x2wtw30yz1.fsf@biostat.ku.dk>


> >Sure, but the general structure probably needs a bit of attention.
> >There could be different preferred methods for different devices,
> >possibly with the current method as a fallback.
> 
> Current method?  Do you just mean the par(ask = TRUE) behaviour, or is
> there something more already there?

No that was it. (Just speculating diffusely: We might find ourselves
with a graphics gadget - say, an SVG viewer - which can't do any
interactive stuff but still needs to be pausable.)
 
> >> A much nicer solution of course would be asynchronous event handling
> >> in the graphics window (i.e., you don't block the command line), but
> >> that depends on the event loop integration problem being solved and
> >> that does not look like happening soon.
> >
> >Not sure we really want that actually. What if someone issues a plot
> >command from the command line? 
> 
> There are definitely lots of issues.  In Windows it would be sensible
> for most event handling to be shut down during function evaluation
> unless specifically reactivated (but not all; low level stuff like
> redraws still need to be done).  But I understood from discussions
> last year that X uses a very different event model, so this wouldn't
> make sense.

Not necessarily the relevant distinction here. I was thinking more of
the intrinsic logic of the matter: If you were in the middle of
viewing demo(graphics), and did plot(rnorm(100)) on the command line,
where would the plot go? How would you resume the demo afterwards?

(Interactive SAS, by the way, separates the viewer from the plotting
so that you'd plot the entire demo and _then_ view it one frame at a
time. Subsequent plots are just added onto the end of the graph list
- causing no end of confusion to students when they haven't realized
that the viewer wasn't positioned at the end and they can't understand
why their plot commands don't seem to have any effect...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

