From Friedrich.Leisch@ci.tuwien.ac.at  Mon Sep  1 14:12:51 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 1 Sep 1997 15:12:51 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
Message-ID: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>


--xk+LtGr+JJ
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Attached is a conversion script for converting current R doc files to
the proposed new format ... I'm not sure if it handles everything
correctly, as I made just some random checks. The main purpose for
posting the thing to the list is such that those interested can get a
look at the new format.

Of course there is no proper indentation ... so the generated files
look really ugly ...

The script can't handle nested math environments with 2 arguments
(like sub, sup, ...), but in the whole base library (580+ files) there
are only 6 containing those, so I thought it's easier to convert these
manually.


--xk+LtGr+JJ
Content-Type: text/enriched
Content-Disposition: inline;
	filename="convert.pl"
Content-Transfer-Encoding: 7bit

#!/usr/bin/perl

use Getopt::Long;

@knownoptions = ("debug|d");
GetOptions (@knownoptions) || die("Unknown Option!\n");

$max_parent = 0;
$NP = "normal_parent";
$PN = "parent_normal";
$EOP = "escaped_opening_parent";
$ECP = "escaped_closing_parent";
$ID = "$NP\\d+$PN";

undef $/;

$complete_text = <>;

print stderr "Marking Parantheses ... " if $opt_debug;

$text = mark_parents($complete_text);

print stderr "done\n" if $opt_debug;

print stderr "Searching logical blocks ... " if $opt_debug;

$text =~ /TITLE($ID)/;
$id = $1;
@args = get_two_args($id);
$text =~ s/TITLE$id(.*)$id/\\title\{$args[0]\}\{$args[1]\}/s;
$title = $args[0];

replace_command("USAGE", "usage");
replace_command("ARGUMENTS", "arguments");
replace_command("DESCRIPTION", "description");

if(($text =~ /VALUE$ID/) && ($text =~ /VALUES$ID/)){
    print stderr "Warning: Both VALUE and VALUES environment found!\n";
}
replace_command("VALUE", "value");
replace_command("VALUES", "value");

replace_command("REFERENCES", "references");
replace_command("SEEALSO", "seealso");
replace_command("EXAMPLES", "examples");
replace_command("NOTES", "notes");

replace_command_all("ALIAS", "alias");
replace_command_all("KEYWORD", "keyword");

while($text =~ /SECTION($ID)/){
    $id = $1;
    @args = get_two_args($id);
    if($args[0] =~ /author/i){
	$text =~ s/SECTION$id(.*)$id/\\author\{$args[1]\}/s;
    }
    else {
	$text =~ s/SECTION$id(.*)$id/\\section\{$args[0]\}\{$args[1]\}/s;
    }
}

print stderr "done\n" if $opt_debug;

print stderr "Parsing text commands ... " if $opt_debug;

$text =~ s/(\s*PARA\s*)+/\n\n/sg;
$text =~ s/(\s*BLANK\s*)+/\n\\blank\n/sg;


while($text =~ /ARG($ID)/){
    $id = $1;
    @args = get_two_args($id);
    $text =~ s/ARG$id(.*)$id/\\item\{$args[0]\}\{$args[1]\}/s;
}

replace_command_all("LANG", "code");
replace_command_all("BOLD", "textbf");
replace_command_all("EQBOLD", "mathbf");
replace_command_all("ITALIC", "emph");

replace_command_all("LINK", "link");

$text =~ s/LDOTS/\\ldots/g;
$text =~ s/DOTS/\\dots/g;


$text =~ s/%/\\%/sg;
$text =~ s/\$/\\\$/sg;

while($text =~ /COMMENT($ID)/){
    $id = $1;
    $text =~ s/COMMENT$id(.*)$id(\n?\s*)/I_FOUND_A_COMMENT/s;
    $comment = " % $1";
    $comment =~ s/\n/\n% /g;
    $comment = "$comment\n" unless ($comment =~ /\n\s*$/s);
    $text =~ s/I_FOUND_A_COMMENT/$comment/;
}

print stderr "done\n" if $opt_debug;
print stderr "Parsing math commands ... " if $opt_debug;



# Now for the math stuff ...

print stderr "args: 0 " if $opt_debug;

$text =~ s/(\s+)EQUALS(\s+)/$1=$2/sg;
$text =~ s/(\s+)LT(\s+)/$1<$2/sg;
$text =~ s/(\s+)GT(\s+)/$1>$2/sg;
$text =~ s/(\s+)LE(\s+)/$1\\le$2/sg;
$text =~ s/(\s+)GE(\s+)/$1\\ge$2/sg;
$text =~ s/(\s+)LOG(\s+)/$1\\log$2/sg;
$text =~ s/(\s+)EXP(\s+)/$1\\exp$2/sg;
$text =~ s/(\s+)SP(\s+)/$1~$2/sg;

$text =~ s/greekGamma/\\gamma/sg;
$text =~ s/greekalpha/\\alpha/sg;
$text =~ s/greekpi/\\pi/sg;
$text =~ s/greekmu/\\mu/sg;
$text =~ s/greeksigma/\\sigma/sg;
$text =~ s/greeklambda/\\lambda/sg;
$text =~ s/boldgreekbeta/\\mathbf\{\\beta\}/sg;
$text =~ s/boldgreekepsilon/\\mathbf\{\\epsilon\}/sg;

print stderr "1 " if $opt_debug;

replace_command_all("SQRT", "sqrt");
replace_command_all("DISPLAYSTYLE", "displaystyle");

while($text =~ /PAREN($ID)/){
    $id = $1;
    $text =~ s/PAREN$id(.*)$id/\\left($1\\right)/s;
}

print stderr "2 ... " if $opt_debug;

while(($text =~ /(SUP)($ID)/) ||
      ($text =~ /(SUB)($ID)/) ||
      ($text =~ /(OVER)($ID)/) ||
      ($text =~ /(CHOOSE)($ID)/)){
    
    my $cmd = $1;
    my $id = $2;
    
    if($text =~ /$id(.*@@.*@@.*)$id/s){
	die("\n$title: Nested math structures - convert equations manually!\n");
    }
    else{
	
	if($cmd =~ /OVER/){
	    @args = get_two_args($id);
	    $text =~ s/OVER$id(.*)$id/\\frac\{$args[0]\}\{$args[1]\}/s;
	}
	
	if($cmd =~ /SUP/){
	    @args = get_two_args($id);
	    $text =~ s/SUP$id(.*)$id/\{$args[0]\}^\{$args[1]\}/s;
	}
	
	if($cmd =~ /SUB/){
	    @args = get_two_args($id);
	    $text =~ s/SUB$id(.*)$id/\{$args[0]\}_\{$args[1]\}/s;
	}
	
	if($cmd =~ /CHOOSE/){
	    @args = get_two_args($id);
	    $text =~ s/CHOOSE$id(.*)$id/\{$args[0] \\choose $args[1]\}/s;
	    }
    }
}


print stderr "deqn ... " if $opt_debug;

while(($text =~ /DEQN($ID)/)){
    $id = $1;
    @args = get_two_args($id);
    $text =~ s/DEQN$id(.*)$id/\\deqn\{$args[0]\}\{$args[1]\}/s;
}

print stderr "eqn ... " if $opt_debug;

replace_command_all("EQN", "eqn");

print stderr "done\n" if $opt_debug;

print stderr "Unmarking parantheses ... " if $opt_debug;

$text = unmark_parents($text);

print stderr "done\n" if $opt_debug;

print $text;





# Mark each matching opening and closing parenthesis with a unique id.
# Idea and original code from latex2html
sub mark_parents {
    my $text = $_[0];
    $text =~ s/([^\\])\\\(/$1$EOP/gso;
    $text =~ s/([^\\])\\\)/$1$ECP/gso;
    
    while($text =~ /\(([^\(\)]*)\)/s){
	my $id = $NP . ++$max_parent . $PN;
	$text =~ s/\(([^\(\)]*)\)/$id$1$id/s;
    }
    $text =~ s/$EOP/\\(/gso;
    $text =~ s/$ECP/\\(/gso;
    
    $text;
}

sub unmark_parents {
    my $text = $_[0];

    while($text =~ /($NP\d+$PN)/s){
	$id = $1;
	$text =~ s/$id(.*)$id/($1)/s;
    }
    $text;
}


sub get_two_args {

    my $id = $_[0];
    
    $text =~ /$id(.*)$id/s;
    my $x = $1;
    $x =~ /\s*([^@]*)\s*@@\s*(.*)\s*/s;

    $arg1 = $1;
    $arg2 = $2;
    
    $arg1 =~ s/^\s*//s;
    $arg1 =~ s/\s*$//s;
    $arg2 =~ s/^\s*//s;
    $arg2 =~ s/\s*$//s;

    ($arg1, $arg2);
}
	

sub replace_command {

    my $cmd = $_[0];
    my $newcmd = $_[1];

    if($text =~ /$cmd($ID)/s){
	my $id = $1;
	$text =~ s/$cmd$id(.*)$id/\\$newcmd\{$1\}/s;
    }
}

sub replace_command_all {

    my $cmd = $_[0];
    my $newcmd = $_[1];

    while(($text =~ /$cmd$ID/)){
	replace_command($cmd, $newcmd);
    }
	
}


    

--xk+LtGr+JJ
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Best,
Fritz



--xk+LtGr+JJ--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep  1 16:28:08 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1997 17:28:08 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
In-Reply-To: Friedrich Leisch's message of Mon, 1 Sep 1997 15:12:51 +0200
References: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>
Message-ID: <x2oh6df3zr.fsf@bush.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> Attached is a conversion script for converting current R doc files to
> the proposed new format ... I'm not sure if it handles everything

Speaking of the docs, we really need to make sure that our HTML pages
pass weblint or similar checkers. I just tried it and found several
pieces of strangeness. Basically, what you get out is stuff like

$ weblint /home/sfe/pd/R/html/funs/density.html
/home/sfe/pd/R/html/funs/density.html(1): <HEAD> must immediately follow <HTML>
/home/sfe/pd/R/html/funs/density.html(1): outer tags should be <HTML> .. </HTML>.
/home/sfe/pd/R/html/funs/density.html(2): empty container element <A>.
/home/sfe/pd/R/html/funs/density.html(90): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(93): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(96): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(99): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(102): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(126): <XMP> is obsolete.
/home/sfe/pd/R/html/funs/density.html(133): unknown element <->.
/home/sfe/pd/R/html/funs/density.html(134): no closing </XMP> seen for <XMP> on line 126.

Here's what I found of obvious pieces of "fluff":

The whole page needs to be inside <HTML>..</HTML>
"<" symbols make trouble, even within <PRE> (use "&lt;")
<XMP> should not be used ("use <PRE>" seems to be the idea)
<TR>'s need to be surrounded by a <TABLE> environment

"<" within <PRE> gets formatted correctly by Netscape, but not by
lynx, so it isn't all just formalities.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep  1 21:01:45 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 1 Sep 1997 13:01:45 -0700 (PDT)
Subject: R-alpha: NCOL, NROW bug
In-Reply-To: <Pine.SUN.3.95.970901120907.10535B-100000@troi>
Message-ID: <Pine.SUN.3.95.970901125854.10535E-100000@troi>


NCOL and NROW don't work correctly on data frames or on arrays of
dimension greater than 2. They treat them as 1-dim vectors.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep  2 08:48:05 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 2 Sep 1997 09:48:05 +0200
Subject: R-alpha: Re: What are objects?
In-Reply-To: <199709011632.SAA18044@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 1 Sep 1997 18:32:33 +0200)
Message-ID: <199709020748.JAA00458@sophie.ethz.ch>

[I do think
  this discussion belongs to  R-devel  rather than anywhere else .. MM]


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Peter Dalgaard BSA writes:

    >> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
    KH>>>  While trying to write documentation for data.class(), I came
    KH>>> across the following in the help for class():
    KH>>> 
    KH>>> An R ``object'' is a data object which has a `class' attribute.
    KH>>> ...  LANG(is.object) returns LANG(TRUE) if its argument has a class
    KH>>> attribute and LANG(FALSE) otherwise.
    KH>>> 
    KH>>> Hmm ... I thought everything was an ``object''.  What is the right
    KH>>> way to refer to ``everything'' then?

    PD>> I agree, this is silly. Did we pick that one up from S, or can we
    PD>> fix it?

    Kurt> I'd say that this is an R&R decision, but I don't think we picked
    Kurt> it up from S.  In S, everything is an object.  Also, S does not
    Kurt> have the R is.object() which in fact is only used once ...

    PD>> Obviously, it makes much more sense to let an entity with no class
    PD>> attribute be an object of the default class. And having to
    PD>> distinguish between "data objects" that are objects and those that
    PD>> aren't is - um - confusing.

    Kurt> Right.

    Kurt> What we might do is distinguish (in terminology) between objects
    Kurt> and ``proper objects'' which are the ones with a class.
or ``class objects''.
Yes I think it's good idea to agree on terminology here.

    Kurt> As (correct me if I am wrong) eventually everything will have a
    Kurt> class (as in S4) everything will eventually be a proper object,
    Kurt> and data.class will be unnecessary.
[I do correct ..]
Hmm, I think that Ross recently said
that  R is NOT moving into the  S4 direction (of fully OO), really,
but rather emphasizes speed and compilation possibilities
	[[unfortunately, I can't find that email in my archives, now...]]

Ross?

    Kurt> Btw, would there be any problems in attaching corresponding class
    Kurt> attributes to at least

    Kurt> 	array matrix list

    Kurt> ???  (Martin, I need your strong YES PLEASE once more ...)  Would
    Kurt> this break anything?  The creator functions could simply attach
    Kurt> the attribs.

I actually have only voted for 'matrix' to be class
 (and 'Matrix' to be another class, inheriting from 'matrix' with just a
  different method for "[").
'array' would be ok, too (and one could think of 'Array' with the analogous
			  "[.Array" method as "[.Matrix")

I'm not so sure about the usefulness of a 'list' class.
Many objects are lists, internally anyway, and I want to access them as
lists sometimes, even if they have an(other) class.

Apropos 'matrix'  (an S / S-plus story) :
-------  ~~~~~~~
In the mean time, I've stumbled about this (again!) in S-plus:

There, 
	as.matrix.dataframe
returns a matrix with a class attribute 'matrix'
but
	as.matrix.default
does NOT
which is really ugly.

I think the 'deep' reason for this is the following:
Current S3 based S-plus still contains code with
	.S(...)
which I think is also known as "old S code".
Anyway, I know that functions using "old S code" are NOT allowed
to get arguments with class (or other "non-standard") attributes.

Therefore, in current S-plus, quite a few (more) things would break if all 
matrices were of class 'matrix'.
And this is probably the only reason why they don't have the class 'matrix'
everywhere.


    Kurt> (Does anyone know exactly what S4 does?)
			    -------
	how do you mean this?
         probably only John Chambers could say 'yes' to this....

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Sep  2 13:19:40 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 2 Sep 1997 14:19:40 +0200
Subject: R-alpha: Re: What are objects?
In-Reply-To: <199709020748.JAA00458@sophie.ethz.ch>
References: <199709011632.SAA18044@aragorn.ci.tuwien.ac.at>
 <199709020748.JAA00458@sophie.ethz.ch>
Message-ID: <199709021219.OAA27859@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> [I do think
>   this discussion belongs to  R-devel  rather than anywhere else .. MM]


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Peter Dalgaard BSA writes:

>>> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
KH> While trying to write documentation for data.class(), I came
KH> across the following in the help for class():
KH> 
KH> An R ``object'' is a data object which has a `class' attribute.
KH> ...  LANG(is.object) returns LANG(TRUE) if its argument has a class
KH> attribute and LANG(FALSE) otherwise.
KH> 
KH> Hmm ... I thought everything was an ``object''.  What is the right
KH> way to refer to ``everything'' then?

PD> I agree, this is silly. Did we pick that one up from S, or can we
PD> fix it?

Kurt> I'd say that this is an R&R decision, but I don't think we picked
Kurt> it up from S.  In S, everything is an object.  Also, S does not
Kurt> have the R is.object() which in fact is only used once ...

PD> Obviously, it makes much more sense to let an entity with no class
PD> attribute be an object of the default class. And having to
PD> distinguish between "data objects" that are objects and those that
PD> aren't is - um - confusing.

Kurt> Right.

Kurt> What we might do is distinguish (in terminology) between objects
Kurt> and ``proper objects'' which are the ones with a class.

> or ``class objects''.
> Yes I think it's good idea to agree on terminology here.

R&R?

Kurt> As (correct me if I am wrong) eventually everything will have a
Kurt> class (as in S4) everything will eventually be a proper object,
Kurt> and data.class will be unnecessary.

> [I do correct ..]
> Hmm, I think that Ross recently said
> that  R is NOT moving into the  S4 direction (of fully OO), really,
> but rather emphasizes speed and compilation possibilities
> 	[[unfortunately, I can't find that email in my archives, now...]]

> Ross?

Yes, that would be good to know ...

Kurt> Btw, would there be any problems in attaching corresponding class
Kurt> attributes to at least

Kurt> array matrix list

Kurt> ???  (Martin, I need your strong YES PLEASE once more ...)  Would
Kurt> this break anything?  The creator functions could simply attach
Kurt> the attribs.

> I actually have only voted for 'matrix' to be class
>  (and 'Matrix' to be another class, inheriting from 'matrix' with just a
>   different method for "[").
> 'array' would be ok, too (and one could think of 'Array' with the analogous
> 			  "[.Array" method as "[.Matrix")

> I'm not so sure about the usefulness of a 'list' class.  Many objects
> are lists, internally anyway, and I want to access them as lists
> sometimes, even if they have an(other) class.

O.k., forget about list.  Let us stay with matrix and array, then.

Kurt> (Does anyone know exactly what S4 does?)
> 			    -------
> 	how do you mean this?
>          probably only John Chambers could say 'yes' to this....

What about the happy pretesters, such as Doug?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Tue Sep  2 19:11:13 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 02 Sep 1997 13:11:13 -0500
Subject: R-alpha: R interaction within ESS-4.9-b11: two small issues
In-Reply-To: Anthony Rossini's message of 02 Sep 1997 10:53:11 -0400
References: <wncwwkzaht4.fsf@fhat.stat.sc.edu>
Message-ID: <6rrab760xq.fsf@franz.stat.wisc.edu>

1) I installed the latest ESS (Emacs Speaks Statistics) beta release
on a machine running Linux.  Since there is no S-PLUS product for
Linux, I set the ess-site.el file for R, xlisp-stat, and S version 4.
I.e.,
 ;; (1.5) Require the needed dialects for your setup.

 ;;(require 'essd-s+3)
 (require 'essd-r)
 (require 'essd-xls)
 ;;(require 'essd-sas)
 ;;(require 'essd-s3)  ;; You might not have this
 (require 'essd-s4)  ;; or this one...

That does not seem to work.  I believe that under the present
structure you must require essd-s+3 to get definitions of some
functions used by the other dialects.  Perhaps that dependency could
be removed at some time.

2) I think the current definitions
essd-r.el:61:    (ess-retr-lastvalue-command    . ".Last.value <- get(\"smode.lvsave\",envir=1)\n")
essd-r.el:62:    (ess-save-lastvalue-command    . "assign(\"smode.lvsave\",.Last.value,envir=1)\n")
may be misusing the "envir" argument.  I am getting messages in the
interaction window like
 > Error in get(x, envir, mode, inherits) : variable "smode.lvsave" was not found
If I try to use assign with envir = 1 at the top level I get an error message
 > assign("smode.lvsave", 12, envir = 1)
 Error: invalid envir argument

I haven't gone into debugging of the ESS code to find out if this what
is causing the problem.

Should the assign and get use "inherits = TRUE" instead of "envir=1"?
The R documentation is a bit vague about the use of the envir argument.

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Tue Sep  2 20:39:10 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 02 Sep 1997 15:39:10 -0400
Subject: R-alpha: R interaction within ESS-4.9-b11: two small issues
In-Reply-To: Douglas Bates's message of "02 Sep 1997 13:11:13 -0500"
References: <wncwwkzaht4.fsf@fhat.stat.sc.edu> <6rrab760xq.fsf@franz.stat.wisc.edu>
Message-ID: <wncrab7a4kh.fsf@fhat.stat.sc.edu>


>>>>> "Douglas" == Douglas Bates <bates@stat.wisc.edu> writes:

    Douglas> 1) I installed the latest ESS (Emacs Speaks Statistics)
    Douglas>    beta release
    Douglas> on a machine running Linux.  Since there is no S-PLUS product for
    Douglas> Linux, I set the ess-site.el file for R, xlisp-stat, and S version 4.
    Douglas> I.e.,
    Douglas>  ;; (1.5) Require the needed dialects for your setup.

    Douglas>  ;;(require 'essd-s+3)
    Douglas>  (require 'essd-r)
    Douglas>  (require 'essd-xls)
    Douglas>  ;;(require 'essd-sas)
    Douglas>  ;;(require 'essd-s3)  ;; You might not have this
    Douglas>  (require 'essd-s4)  ;; or this one...

    Douglas> That does not seem to work.  I believe that under the
    Douglas> present structure you must require essd-s+3 to get
    Douglas> definitions of some functions used by the other dialects.
    Douglas> Perhaps that dependency could be removed at some time.

I just did.  Sorry (changed for beta-12, to release Friday).  I've
moved the basic formatting into essl-s.el (ESS, Languages in the S
family), which is required by essd-s3, essd-s4, essd-s+3,essd-s+3...

    Douglas> 2) I think the current definitions

    Douglas> essd-r.el:61:    (ess-retr-lastvalue-command
    Douglas> . ".Last.value <- get(\"smode.lvsave\",envir=1)\n") 
    Douglas> essd-r.el:62:    (ess-save-lastvalue-command
    Douglas> . "assign(\"smode.lvsave\",.Last.value,envir=1)\n") 

    Douglas> may be misusing the "envir" argument.  I am getting
    Douglas> messages in the interaction window like

    >> Error in get(x, envir, mode, inherits) : variable
    >> "smode.lvsave" was not found 

    Douglas> If I try to use assign with envir = 1 at the top level I
    Douglas> get an error message

    >> assign("smode.lvsave", 12, envir = 1)

    Douglas>  Error: invalid envir argument

    Douglas> I haven't gone into debugging of the ESS code to find out
    Douglas> if this what is causing the problem.

    Douglas> Should the assign and get use "inherits = TRUE" instead
    Douglas> of "envir=1"?  The R documentation is a bit vague about
    Douglas> the use of the envir argument.

This is a bit more important.  I've not yet found an acceptable work
around (well, Kurt H. said he could provide a hacked solution soon).

I'm still hunting for suggestions...

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep  3 17:13:16 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 3 Sep 1997 18:13:16 +0200
Subject: R-alpha: speed of  sort(.) and order(.)
Message-ID: <199709031613.SAA01385@sophie.ethz.ch>

sort() and order() are not quite the same, as "one knows":

 o  order allows breaking ties by more than one argument;
 o  sort  allows a 'partial' and 'na.last' argument

Still, the following timing (on a `simple' UltraSparc I)
suggest that actually two different algorithms are used

> N <- 10000
> typeof(x0 <- 1:N) # --- x0 : already sorted ---
[1] "integer"
> typeof(x  <- sample(N))
[1] "integer"
> CPU <- numeric(10)

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) sort(x0))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.070   1.080   1.080   1.137   1.217   1.240 

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) order(x0))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.900   1.000   1.035   1.012   1.047   1.070 

'order' is slightly faster for an already sorted vector
	(this seems consistent for further examples, 
	  not statistically significant for these 10..)


> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) sort(x))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.700   1.720   1.735   1.765   1.827   1.870 

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) order(x))[1]
> summary(CPU)
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  3.000   3.100   3.140   3.181   3.227   3.540 
>

which makes 'sort' almost a factor of 2  FASTER for an unsorted 'x'.

Any comments from the coders  (R & R) ?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep  3 23:26:46 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 4 Sep 1997 10:26:46 +1200 (NZST)
Subject: R-alpha: speed of  sort(.) and order(.)
In-Reply-To: <199709031613.SAA01385@sophie.ethz.ch>
References: <199709031613.SAA01385@sophie.ethz.ch>
Message-ID: <199709032226.KAA22616@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
[ stuff on sorting  which I leave out ]

 > which makes 'sort' almost a factor of 2  FASTER for an unsorted 'x'.
 > 
 > Any comments from the coders  (R & R) ?

I wasn't there, I hardly knew the woman and anyway it wasn't my dog :-).

Well, I didn't look closely at the code, but as I recall both "sort"
and "order" use a shellsort recomended by Sedgewick (he says only
true sorting gurus like him should attempt quicksort and that mortals
like me should stick with shellsort).

It does look odd.  When I get a moment I will dig deeper.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Sep  4 09:52:24 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 4 Sep 1997 10:52:24 +0200
Subject: R-alpha: inconsistency R/Splus of sample()
Message-ID: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>


The function sample has different behaviour under R and Splus when
called with zero sample size:

R> x<-rnorm(10)
R> sample(x,0)
Error in sample(length(x), size, replace) : invalid second argument

Splus> x<-rnorm(10)
Splus> sample(x,0)
numeric(0)


IMO the Splus behaviour makes more sense, because it returns the
requested `sample' of size 0.

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep  4 21:39:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 5 Sep 1997 08:39:05 +1200 (NZST)
Subject: R-alpha: Sorting Efficiency
Message-ID: <199709042039.IAA12844@stat1.stat.auckland.ac.nz>

As part of checking Martin Maechler's observations of sorting
efficiency I have been putting the code under the microscope.  Part of
this involved comparing the performance with Splus. I turns out that
the R code is much slower.  A good deal of this is due to the
interpreted front end to the R verion of sort.  It is worth taking
a look at the sort function and seeing if you can see what the
problem is.  (hint: turn on GC reporting with "gcinfo").

A good deal of the rest of the inefficiency is because the internal R
code attempts to deal with missing observations.  This is no longer
needed because this is dealt with in the interpreted front end.

An overall fix of the code should see us nearly match the performance
of Splus.  I say nearly because I think I will use heapsort instead of
quicksort because I want to avoid worst-case performance rather than
seek good average performance.

I don't yet have an explanation of the behavior which Martin uncovered.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep  4 23:44:51 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 5 Sep 1997 10:44:51 +1200 (NZST)
Subject: R-alpha: inconsistency R/Splus of sample()
In-Reply-To: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>
References: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>
Message-ID: <199709042244.KAA18311@stat1.stat.auckland.ac.nz>

Friedrich Leisch writes:
 > 
 > The function sample has different behaviour under R and Splus when
 > called with zero sample size:
 > 
 > R> x<-rnorm(10)
 > R> sample(x,0)
 > Error in sample(length(x), size, replace) : invalid second argument
 > 
 > Splus> x<-rnorm(10)
 > Splus> sample(x,0)
 > numeric(0)
 > 
 > 
 > IMO the Splus behaviour makes more sense, because it returns the
 > requested `sample' of size 0.

Done.  (A one character change).
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep  5 09:32:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Sep 1997 10:32:32 +0200
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: <199709042039.IAA12844@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 5 Sep 1997 08:39:05 +1200 (NZST))
Message-ID: <199709050832.KAA04356@sophie.ethz.ch>

Since you are delving into the code anyway....
Here is a thought that I have been having for a long time:

Wouldn't it make sense / be useful  to have a function 	is.sorted
which returns TRUE   if  all(diff(x) >= 0).	        ---------

I actually have been using the function

	is.sorted <- function(x) (length(x) <= 1) || all(diff(x) >= 0)

in my collection of S-plus enhancements for quite while now.

I can do things as

	if(!is.sorted(x)) {
		o <- order(x)
		x <- x[o]
		y <- y[o]
	}
		
which potentially saves computing time (over unconditional 'order'),
since
1.	        is.sorted  is  O(n)
    whereas	sort       is  O(n*log(n)) 
2. for sorted x, the two assignments are superfluous even when order(x) was
   very fast (for SORTED x). 

TO be CPU-efficient, is.sorted  probably should be written .Internal(.).

On the other hand,  sort(.) and order(.)  could be designed such that they
use a sorting algorithm which guarantees to be fast when things are already
sorted. [maybe this is already the case,
	 and one of your reasons against quicksort? ]
This would make the 'if(..)' in  
	if(!is.sorted(x)) x <- sort(x)
superfluous, but the situation with order(.) above
(which is NOT infrequent in statistics !!) would still profit from not
doing  'x <- x[1:length(x)]' when x is sorted.

--
Opinions?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 15:48:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 16:48:24 +0200
Subject: R-alpha: GLM (from R-core)
Message-ID: <x2bu27vmtj.fsf@bush.kubism.ku.dk>

As some of you may know, there has been formed a "core team" of
developers, who can dig directly into the R source at Auckland and fix
bugs etc., in order to speed up development. There is a mailing list
for that group. This is necessary, because some of the bugs discussed
are not publicly available (and hopefully will never be!), but one
potential risk of the structure is that we forget about R-devel. One
recent case was this:

I discovered that summary.glm was calculating "t" statistics (est./SE)
correctly in the case were the dispersion parameter of the GLM is
fixed, but referring it to a t distribution with the residual DF. This
is wrong, badly so in the case of tabular data.

This is just a bug, but then Thomas Lumley added:

"We should also allow the df to be specified as an argument to
summary.glm(). The gaussian case is the only one where there is a real
honest t-distribution and in other cases the user should be free to use
other values of the df that might improve the approximation.  This is
particularly true when the user specifies the dispersion, as then we have
no idea what df is appropriate."

That kind of topic is about "policy" as opposed to bugfixing and
codewriting, and - as Martin Maechler pointed out - there are people
on R-devel who have broad experience in GLMs and may want to
contribute to the discussion. 

Also other things with GLMs are debatable, e.g. whether it is always
correct to use the weighted RSS and not the deviance for the
dispersion estimate.

(The fixed-dispersion bug is fixed in the current sources, using the
simple logic that if the dispersion in not estimated from the RSS, we
use the normal distribution (or "infinite df" if you like))


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 16:02:10 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 17:02:10 +0200
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: Martin Maechler's message of Fri, 5 Sep 1997 10:32:32 +0200
References: <199709050832.KAA04356@sophie.ethz.ch>
Message-ID: <x2afhrvm6l.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> since
> 1.	        is.sorted  is  O(n)
>     whereas	sort       is  O(n*log(n)) 
> 2. for sorted x, the two assignments are superfluous even when order(x) was
>    very fast (for SORTED x). 

Actually, if it's a Shell sort, it's O(n^1.5) worst case and O(n^1.27)
average. For O(n log n) average you need quicksort or heapsort. The
former has the draw back of O(n^2) worst case, but heapsort has quite
a good reputation and is unconditionally n log n (that info comes from
Numerical Recipes, which was the best could dig out at the moment).
Maybe we should switch?

> superfluous, but the situation with order(.) above
> (which is NOT infrequent in statistics !!) would still profit from not
> doing  'x <- x[1:length(x)]' when x is sorted.

Yes.. Of course the case is often that you *know* that things are
sorted (because you just did it yourself), but modularity prevents you
from getting that information to the spot where it is needed.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 16:04:22 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 17:04:22 +0200
Subject: R-alpha: Sorting Efficiency -- A bit of humour...
In-Reply-To: Martin Maechler's message of Fri, 5 Sep 1997 10:32:32 +0200
References: <199709050832.KAA04356@sophie.ethz.ch>
Message-ID: <x290xbvm2x.fsf@bush.kubism.ku.dk>

Apropos sorting, I stumbled across this one a moment ago:

From: rjd4@cam.ac.uk (Bob Dowling)
Subject: Re: Sorting algorithms (was Re: Whoo hoo)
Newsgroups: alt.sysadmin.recovery
Date: 5 Sep 1997 09:19:21 GMT

This talk of sorting algorithms brings me back to one of my favourite interview
questions, designed to see if the candidate is on the ball.

"Sketch out a program that takes a random permutation of the numbers from 1 to
1000 and prints them in order."

Any mention of sorting algorithms is regarded as a "fail" on this question, of
course.
- - 
Bob Dowling:       UNIX Support, University of Cambridge Computing Service,
rjd4@cam.ac.uk     New Museums Site, Pembroke Street, Cambridge, UK.  CB2 3QG.
+44 1223 334728    http://www-uxsup.csx.cam.ac.uk/
-------- Those who do not learn from Dilbert are doomed to repeat it. --------


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Fri Sep  5 16:06:59 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 05 Sep 1997 11:06:59 -0400
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: Peter Dalgaard BSA's message of "05 Sep 1997 17:02:10 +0200"
References: <199709050832.KAA04356@sophie.ethz.ch> <x2afhrvm6l.fsf@bush.kubism.ku.dk>
Message-ID: <wnchgbzer58.fsf@fhat.stat.sc.edu>



Well, since it seems that number of algorithms have been implemented,
how about keeping them and having a:

	sort( x, algorithm="....")

call?  (I'm only quasi-serious this morning).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Fri Sep  5 16:40:42 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 5 Sep 1997 10:40:42 -0500 (CDT)
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: <x2afhrvm6l.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Sep 5, 97 05:02:10 pm
Message-ID: <9709051540.AA09189@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > since
> > 1.	        is.sorted  is  O(n)
> >     whereas	sort       is  O(n*log(n)) 
> > 2. for sorted x, the two assignments are superfluous even when order(x) was
> >    very fast (for SORTED x). 
> 
> Actually, if it's a Shell sort, it's O(n^1.5) worst case and O(n^1.27)
> average. For O(n log n) average you need quicksort or heapsort. The
> former has the draw back of O(n^2) worst case, but heapsort has quite
> a good reputation and is unconditionally n log n (that info comes from
> Numerical Recipes, which was the best could dig out at the moment).
> Maybe we should switch?
> 

Merge sort is also an option. It is O(n log(n)) worst case but with a
better constant than heapsort, as I recall, and a bit easier to
implement.  Its drawback in general is O(n) additional space needed,
which is prohibitive if you are sorting in place. But since R copies
anyway, that isn't an issue. (Don't name any internal routines
mergesort though -- there are a number of systems that include one in
their libraries and cause name conflicts).

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Sep  5 17:23:36 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 5 Sep 1997 09:23:36 -0700 (PDT)
Subject: R-alpha: sorting in plots
In-Reply-To: <x2afhrvm6l.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970905091611.14804A-100000@troi>


The sorting discussion reminds me of another feature I wanted in lines()
(and in plot.default). 
	lines(x,y,sorted=T)
equivalent to 
	lines(x[order(x)],y[order(x)])
but still giving the correct information to identify()


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Sun Sep  7 16:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 7 Sep 1997 17:23:47 +0200
Subject: R-alpha: R `make install-*'
Message-ID: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at>

Ross mentioned last week that it would be nice to eventually have a real
`make install'.  As a preparation, we should perhaps rename the current

	install-help install-latex install-html

targets to

	help latex [or dvi???] html

and perhaps

	test-Examples

to

	test

I can of course make the changes, but I thought I'd ask for a good new
name for the corresponding scripts in RHOME/etc.  Maybe

	etc/build-help

etc?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Sun Sep  7 16:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 7 Sep 1997 17:23:47 +0200
Subject: R-alpha: naming convention for index files
Message-ID: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at>

In the process of moving to the new directory structure, we might also
reconsider the naming of the various index files.

A simple idea would be to have an `INDEX' file in each directory where
this is appropriate.  E.g., we could have

	pkg/funs/INDEX		(rather than help/pkg/INDEX)
	pkg/data/INDEX		(rather than index.doc)
	pkg/help/INDEX		(rather than AnIndex)

or e.g.

	pkg/INDEX.funs
	pkg/INDEX.data

etc.

The package TITLE files would be used for building the package index of
a library tree (LibIndex?)

In any case, the `plain' indices to be displayed upon calling an
appropriate form of help() could contain MORE than simply a list of
things.  I.e., more like a README.

My idea is (assuming only RHOME is in .lib.loc):

	R> library()

	`RHOME' is the location of the default R library tree.
	Blah blah blah ...

	Packages in `RHOME':

	base		The basic package.
	eda		...
	mva		...

The last lines could be generated from the packages' TITLE files.  The
other info from some stub, perhaps LibIndex.in?

As usual, any feedback is appreciated.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Sep  7 18:25:11 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Sep 1997 19:25:11 +0200
Subject: R-alpha: R `make install-*'
In-Reply-To: Kurt Hornik's message of Sun, 7 Sep 1997 17:23:47 +0200
References: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at>
Message-ID: <x2pvqlf348.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> Ross mentioned last week that it would be nice to eventually have a real
> `make install'.

..speaking of which, we should remember to rename the INSTALL file in
$RHOME. Prevents 'make install' on case-inhibited operating systems
("install is up to date"...!).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Sep  8 14:25:08 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 8 Sep 1997 15:25:08 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
In-Reply-To: <x2oh6df3zr.fsf@bush.kubism.ku.dk>
References: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>
 <x2oh6df3zr.fsf@bush.kubism.ku.dk>
Message-ID: <199709081325.PAA04403@galadriel.ci.tuwien.ac.at>

>>>>> On 01 Sep 1997 17:28:08 +0200,
>>>>> Peter Dalgaard BSA (PDB) wrote:

PDB> Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
>> Attached is a conversion script for converting current R doc files to
>> the proposed new format ... I'm not sure if it handles everything

PDB> Speaking of the docs, we really need to make sure that our HTML pages
PDB> pass weblint or similar checkers. I just tried it and found several
PDB> pieces of strangeness. Basically, what you get out is stuff like

PDB> $ weblint /home/sfe/pd/R/html/funs/density.html
PDB> /home/sfe/pd/R/html/funs/density.html(1): <HEAD> must immediately follow <HTML>
PDB> /home/sfe/pd/R/html/funs/density.html(1): outer tags should be <HTML> .. </HTML>.
PDB> /home/sfe/pd/R/html/funs/density.html(2): empty container element <A>.
PDB> /home/sfe/pd/R/html/funs/density.html(90): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(93): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(96): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(99): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(102): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(126): <XMP> is obsolete.
PDB> /home/sfe/pd/R/html/funs/density.html(133): unknown element <->.
PDB> /home/sfe/pd/R/html/funs/density.html(134): no closing </XMP> seen for <XMP> on line 126.

PDB> Here's what I found of obvious pieces of "fluff":

PDB> The whole page needs to be inside <HTML>..</HTML>
PDB> "<" symbols make trouble, even within <PRE> (use "&lt;")
PDB> <XMP> should not be used ("use <PRE>" seems to be the idea)
PDB> <TR>'s need to be surrounded by a <TABLE> environment

PDB> "<" within <PRE> gets formatted correctly by Netscape, but not by
PDB> lynx, so it isn't all just formalities.

I agree totally that we should stick with the HTML standards.

The new conversion script is almost ready and currently in
`alpha-testing' by Martin and Kurt. I've checked its output with
weblint and on the HTML pages of the whole base library all I get are
only minor warnings:

attach.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
chisquare.test.html(36): empty container element <P>.
detach.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
ls.diag.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
ls.print.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
t.test.html(84): empty container element <P>.


which cannot be avoided without considerable effort or side effects ...
e.g., every browser that cannot handle long tiles will truncate them
anyway, so I see no purpose in doing this myself. But we can include
it as a recommendation that the title of a doc file is no longer than
64 characters (that makes sense anyway for the INDEX files etc.)



best,
fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 15:21:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 16:21:56 +0200
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: <199709042117.JAA16853@stat1.stat.auckland.ac.nz> (message from
 Robert Gentleman on Fri, 5 Sep 1997 09:17:50 +1200 (NZST))
Message-ID: <199709081421.QAA00979@sophie.ethz.ch>

[[yet another discussion brought from  R-core  to  R-devel]]

>>>>> "RG" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

    RG> Peter, there is some code for line types and widths in all the
    RG> drivers. With windows there is the well known limitation that you
    RG> can't have patterened lines with lwd larger than 1 (unless you
    RG> write your own routines ....  I just haven't had time). I do agree
    RG> that there is something very weird going on with our code though!
   
    RG>    I think that in plot(1:4,lwd=2) the lwd should have absolutely
    RG> no effect. I think it's a bug in Splus that it does. For example,
    RG> plot(1:4,col="red")

I agree, and I also have been hating this (Splus) behavior.

I do prefer R's behavior have different 'col', 'cex', 'font' for
axis, labs, and points/lines.

After reading PD's reply to this message, I agree that
"lwd" is somewhat different:
	If your device has too thin lines in general, it is nice if you can
	increase line width  GLOBALLY.
The same for "cex": 
	There are situations where ALL text and plotting characters should
	just be made bigger with the same zoom factor.

Below, you (RG) mention the use of   par(lwd=...)
{and correspondingly would be    par(cex=...)}.

Is this going to be ``the standard'':

	For global changes of  linewidth or character size,
	one must use  par(lwd=..) or  par(cex=..) 
?

    RG>     gives you everything in red; axes, labels, lines and
    RG> points. That's wrong.  In plot(1:4,type="l",lwd=2) lwd should
    RG> affect the width of the line joining the points but not the width
    RG> of the lines for the bounding box (IMHO).

I agree, but again, it might be nice if there was something like a 
"global.lwd".
    
    RG>     I think that if you want to change the line widths on the
    RG> bounding box you should use par(lwd=2) and then all lines are
    RG> changed. This seems to work (but I don't doubt there are bugs; we
    RG> simply have never had the chance to exercise everything).

    RG>     As for character expansion- par cex seems to be the only route
    RG> (which makes me like my suggestion even more).
    
    RG>     Opinions?  It would be easy enough to mimic S but I do think
    RG> it's wrong.

We should not mimic S here, sometimes.
I agree it's wrong in some places.

But if you use a different scheme, it should be
	- well documented
	- very consequently implemented   ==>  easily remembered by users

-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Sep  8 15:36:24 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 8 Sep 1997 10:36:24 -0400 (EDT)
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: <199709081421.QAA00979@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970908103318.15321A-100000@paca>


  I agree with the gist of the discussion here ("par(lwd)" to change lwd
globally, otherwise it just affects lines).  One detail worth thinking
about is that a global linewidth change in PostScript (setlinewidth) will
also affect the linewidths used, e.g., in drawing plotting characters
(which could get very ugly as a result).

  I'm glad to see folks are working on lwd; in my (alpha-2) version of R
linewidth is mostly not implemented, and I was wondering whether I should
dig in and work on it or whether I should wait 'til the prophesied Big
Changes in the graphics code happened and the dust settled ...  (For now,
I've just been hacking the postscript _post facto_.)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep  8 16:27:45 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 8 Sep 1997 11:27:45 -0400
Subject: R-alpha: not mimic S
Message-ID: <97Sep8.112911edt.26517@mailgate.bank-banque-canada.ca>

> We should not mimic S here, sometimes.
> I agree it's wrong in some places.

> But if you use a different scheme, it should be
>         - well documented
>         - very consequently implemented   ==>  easily remembered by
users

One way to deal with improvements which force incompatabilities with S
is to layer the code so that application programmers use a consistent
upper layer which in turn calls lower layers of S or R code. This does
not solve problems with existing code but does give a way for new
applications to be developed for both environments. It may not be
possible to always achieve the same results, especially when
improvements mean some capabilities are not in one system, but it can be
possible to make the application work and just not provide some features
in one environment.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep  8 16:37:20 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 08 Sep 1997 17:37:20 +0200
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: Ben Bolker's message of Mon, 8 Sep 1997 10:36:24 -0400 (EDT)
References: <Pine.SUN.3.95.970908103318.15321A-100000@paca>
Message-ID: <x27mcr24wf.fsf@bush.kubism.ku.dk>

Ben Bolker <ben@eno.Princeton.EDU> writes:

>   I agree with the gist of the discussion here ("par(lwd)" to change lwd
> globally, otherwise it just affects lines).  One detail worth thinking
> about is that a global linewidth change in PostScript (setlinewidth) will
> also affect the linewidths used, e.g., in drawing plotting characters
> (which could get very ugly as a result).

Hm. After seeing the W95 plots on a 600dpi laser, I tend to say that
the above *is* the desired behaviour. The default plotting circles
were hardly visible at all. A global lwd setting should set the
natural (i.e. neither fat nor barely visible) line width for a plot. 
Another question is whether one should set a *relative* width unit
(like SAS's 'goptions lfactor=...'), so that all lines are made
fatter - or thinner.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 16:56:15 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 17:56:15 +0200
Subject: R-alpha: naming convention for index files
In-Reply-To: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Sun, 7 Sep 1997 17:23:47 +0200)
Message-ID: <199709081556.RAA01060@sophie.ethz.ch>


    KH> In the process of moving to the new directory structure, we might also
    KH> reconsider the naming of the various index files.

    KH> A simple idea would be to have an `INDEX' file in each directory where
    KH> this is appropriate.  E.g., we could have

    KH> pkg/funs/INDEX		(rather than help/pkg/INDEX)

but  help/base/INDEX  is autogenerated
where as everything in ./funs/  (or /R/  as you propose later)  is  SOURCE

    KH> pkg/data/INDEX		(rather than index.doc)
index.doc is source

    KH> pkg/help/INDEX		(rather than AnIndex)
this is auto-generated again...

--
in summary, we could well say   INDEX  instead of different names,
but I don't think we should  autogenerate a file in a directory
where there's only source  (other than the 'Makefile'; Lib... files that
			    configure generates, and which are not needed
			    anymore after installation)

Remember: 

	The big idea is still that after

		make install + install-help + ..
			(just after all the installation)

	you should be able to
	REMOVE the full  ./src/  tree and still have a completely 
	working R (including online help, ...).


    KH> or e.g.

    KH> pkg/INDEX.funs
    KH> pkg/INDEX.data

    KH> etc.

    KH> The package TITLE files would be used for building the package index of
    KH> a library tree (LibIndex?)

very good idea

    KH> In any case, the `plain' indices to be displayed upon calling an
    KH> appropriate form of help() could contain MORE than simply a list of
    KH> things.  I.e., more like a README.

    KH> My idea is (assuming only RHOME is in .lib.loc):

    KH> library()

    KH> `RHOME' is the location of the default R library tree.
    KH> Blah blah blah ...

    KH> Packages in `RHOME':

    KH> base		The basic package.
    KH> eda		...
    KH> mva		...

    KH> The last lines could be generated from the packages' TITLE files.  The
    KH> other info from some stub, perhaps LibIndex.in?

very good idea

    KH> As usual, any feedback is appreciated.

as usual, I give you some ... ;-)

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 17:00:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 18:00:01 +0200
Subject: R-alpha: R `make install-*'
In-Reply-To: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Sun, 7 Sep 1997 17:23:47 +0200)
Message-ID: <199709081600.SAA01071@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Ross mentioned last week that it would be nice to eventually have
    Kurt> a real `make install'.  As a preparation, we should perhaps
    Kurt> rename the current

    Kurt> 	install-help install-latex install-html

    Kurt> targets to

    Kurt> 	help latex [or dvi???] html

    Kurt> and perhaps

    Kurt> 	test-Examples
    Kurt> to
    Kurt> 	test
no!
You can make it shorter, but my idea still is that there should be a whole
collection of tests where `running all the help-Examples' is just one of them.

    Kurt> I can of course make the changes, but I thought I'd ask for a good new
    Kurt> name for the corresponding scripts in RHOME/etc.  Maybe

    Kurt> etc/build-help

    Kurt> etc?

yes, this sounds better
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Sep  8 08:48:19 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 08 Sep 1997 09:48:19 +0200 (MET DST)
Subject: R-alpha: Assingment to list or vector elements
Message-ID: <XFMail.970908104926.plummer@iarc.fr>

When you assign a value to an object which exists in some database on
the search list, R creates a copy in the current environment. However,
if the object is a list or vector, and you assign a new value to one of
its elements, a copy is not made and the assignment fails (with no error
message!).  This behaviour is incompatible with S-PLUS, which will make
a copy of the object before modifying one of its elements.

Martyn

> exists("alist", 1, inherits=F)
[1] FALSE
> mydata <- list(alist = list(one=1,two=1))
> attach(mydata)
> alist
$one
[1] 1

$two
[1] 1

> alist$one <- 2
> alist[[2]] <- 3
> alist
$one
[1] 1

$two
[1] 1

> exists("alist", 1, inherits=F)
[1] FALSE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Sep  8 09:52:40 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 08 Sep 1997 10:52:40 +0200 (MET DST)
Subject: R-alpha: deparse bug
Message-ID: <XFMail.970908115419.plummer@iarc.fr>

The deparse function has an argument "width.cutoff" which allows you
to set the width at which line breaking is attempted.  However, setting
this argument _permanently_ changes the line break width.

Looking at the source code ($RHOME/src/main/deparse.c), I see that the
width.cutoff argument sets the static variable "cutoff".  Although the
function do_deparse behaves correctly - overwriting cutoff with the
default value if not given a second argument -  other R functions (such
as print and edit) call deparse1 which doesn't do this. Hence they use
the modified cutoff value.

A quick fix would be to get do_deparse to reset cutoff to the default
value after calling deparse1 but before returning.

Martyn

> #Use function trunc as an example
> #This normally prints on two lines
> trunc
function (x) 
ifelse(x < 0, ceiling(x), floor(x))
> #Now deparse with narrow cutoff
> deparse(trunc,20)
[1] "function (x) "             
[2] "ifelse(x < 0, ceiling(x), "
[3] "        floor(x))"         
> #Cutoff 20 is used next time you print anything
> trunc
function (x) 
ifelse(x < 0, ceiling(x), 
        floor(x))
> #Cutoff is reset to default when you call
> #deparse without width.cutoff argument
> deparse(trunc)
[1] "function (x) "                      
[2] "ifelse(x < 0, ceiling(x), floor(x))"
> #Default cutoff (60) is now used when you print
> trunc
function (x) 
ifelse(x < 0, ceiling(x), floor(x))
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep 10 02:00:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 10 Sep 1997 13:00:42 +1200 (NZST)
Subject: R-alpha: New Version Available
Message-ID: <199709100100.NAA08817@stat1.stat.auckland.ac.nz>

The newest version of R for Unix (version R-0.50-a4) is now (or will
soon be) available from the following sites.

    NORTH AMERICA:
	http://lib.stat.cmu.edu/R/Alpha

    EUROPE:
        ftp://ftp.stat.math.ethz.ch/R/
        ftp://statlab.uni-heidelberg.de/pub/mirrors/auckland/R/

    JAPAN:
        ftp://ftp.u-aizu.ac.jp/pub/lang/R/

    NEW ZEALAND:
        ftp://stat.auckland.ac.nz/pub/R/

Please obtain a copy from site close to you.  Note that New Zealand
is not close to anywhere other than itself :-).

This is a quick snapshot release of the current source tree which is
intended to bring users up to date with the current state of
development.  We are just about embark on some substantial changes
which may take a while to complete, so this seems like a good time to
put out a release.

This is still not the promised "R-0.50 stable", but it is getting closer.

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Sep 10 15:53:58 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 10 Sep 1997 10:53:58 -0400
Subject: R-alpha: New Version Available
In-Reply-To: Ross Ihaka's message of "Wed, 10 Sep 1997 13:00:42 +1200 (NZST)"
References: <199709100100.NAA08817@stat1.stat.auckland.ac.nz>
Message-ID: <wnc7mcpb4op.fsf@fhat.stat.sc.edu>


>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version R-0.50-a4) is now
    Ross> (or will soon be) available from the following sites.

    Ross>     NORTH AMERICA:
    Ross> 	http://lib.stat.cmu.edu/R/Alpha

It's there.

Compiled and seems to run on Solaris 2.5 (SS 20/50).  

Small problem -- in compiling hclust, it couldn't find my f2c.h files,
and bombed.  

My solution -- move f2c.h to the include directory in the unpacked
distribution directory.  (I also moved libf2c.a to the lib directory,
but I don't think it was needed there?).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Sep 10 17:40:15 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Sep 1997 18:40:15 +0200
Subject: R-alpha: hist()
Message-ID: <x2vi096s27.fsf@bush.kubism.ku.dk>


If you try hist(rnorm(100),lwd=2) with a recent snapshot, you get the
exact opposite effect of what was earlier argued to be desirable in
plots: you get fat axes and thin bar outlines. The cause is plain to
see, at the end of 'hist':

        title(main = main, xlab = xlab, ylab = ylab, ...)
        if (axes) {
                axis(1, ...)
                axis(2, ...)
        }
        rect(breaks[-length(breaks)], 0, breaks[-1], counts, 
                col = col, border = border)

The ...'s are doing it, obviously. So the fix would be to remove ...
from axis() and add it to rect().

However, this example is having me worried that it wasn't a good idea
to depart from the S rule of *always* passing graphical parameters to
lower level routines. For instance, I don't think you would want a
font change *not* passed on to title(), would you? Then what *is*
changeable matter in a plot, really?

The thing that I'm afraid of is that it will become a can of worms to
keep track of which parameters are passed on to what routines. Not to
mention the fact that the ... parameter is essentially indivisible: it
is, to say the least, difficult to pass only some of the parameters.

Cc-ed to R-devel. I think we need to discuss this more broadly.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Sep 10 22:26:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 10 Sep 1997 14:26:18 -0700 (PDT)
Subject: R-alpha: model.frame
In-Reply-To: <x2vi096s27.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970910141237.4854E-100000@troi>

model.frame(,data=foo) requires foo to be a data.frame in R-0.50-a4.
Previously, and in S, a list is sufficient.

A fix is to add
        if (!is.data.frame(data) & !is.null(data)) 
                data <- as.data.frame(data)
before the first line of terms.formula




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 10 23:03:04 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 10 Sep 1997 17:03:04 -0500
Subject: R-alpha: model.matrix misbehaves on two-sided formulas
Message-ID: <6rsovchlnr.fsf@franz.stat.wisc.edu>

I am using R for a graduate class on linear models that I teach.  I
sent the class a sample transcript of explicit construction of the
model matrix and use of the QR decomposition.  One of the members of
the class picked up on the fact that the model matrix was not what I
advertised that it should be when a two-sided formula is used.  A
one-sided formula works properly.  For example,
 > library(st849)          # loads data sets from the text
 > e1.1
       density speed
  [1,]    20.4  38.8
  [2,]    27.4  31.5
  [3,]   106.2  10.6
  [4,]    80.4  16.1
  [5,]   141.3   7.7
  [6,]   130.9   8.3
  [7,]   121.7   8.5
  [8,]   106.5  11.1
  [9,]   130.5   8.6
 [10,]   101.1  11.1
 [11,]   123.9   9.8
 [12,]   144.2   7.8
 [13,]    29.5  31.8
 [14,]    30.8  31.6
 [15,]    26.5  34.0
 [16,]    35.7  28.9
 [17,]    30.0  28.8
 [18,]   106.2  10.5
 [19,]    97.0  12.3
 [20,]    90.1  13.2
 [21,]   106.7  11.4
 [22,]    99.3  11.2
 [23,]   107.2  10.3
 [24,]   109.1  11.4
 > class(e1.1)
 [1] "data.frame"
 > model.matrix(~density, data = e1.1)  # what we would expect
       (Intercept) density
  [1,]           1    20.4
  [2,]           1    27.4
  [3,]           1   106.2
  [4,]           1    80.4
  [5,]           1   141.3
  [6,]           1   130.9
  [7,]           1   121.7
  [8,]           1   106.5
  [9,]           1   130.5
 [10,]           1   101.1
 [11,]           1   123.9
 [12,]           1   144.2
 [13,]           1    29.5
 [14,]           1    30.8
 [15,]           1    26.5
 [16,]           1    35.7
 [17,]           1    30.0
 [18,]           1   106.2
 [19,]           1    97.0
 [20,]           1    90.1
 [21,]           1   106.7
 [22,]           1    99.3
 [23,]           1   107.2
 [24,]           1   109.1
 attr(,"assign")
 [1] 0 1
 > model.matrix(sqrt(speed) ~ density, data = e1.1) # not what we want
       (Intercept) density
  [1,]           1    38.8
  [2,]           1    31.5
  [3,]           1    10.6
  [4,]           1    16.1
  [5,]           1     7.7
  [6,]           1     8.3
  [7,]           1     8.5
  [8,]           1    11.1
  [9,]           1     8.6
 [10,]           1    11.1
 [11,]           1     9.8
 [12,]           1     7.8
 [13,]           1    31.8
 [14,]           1    31.6
 [15,]           1    34.0
 [16,]           1    28.9
 [17,]           1    28.8
 [18,]           1    10.5
 [19,]           1    12.3
 [20,]           1    13.2
 [21,]           1    11.4
 [22,]           1    11.2
 [23,]           1    10.3
 [24,]           1    11.4
 attr(,"assign")
 [1] 0 1

I think that somewhere along the line an expression like
 eval(form[[2]], data)
is being used when it would be better to use
 eval(form[[length(form)]], data)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Sep 10 23:15:46 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 10 Sep 1997 15:15:46 -0700 (PDT)
Subject: R-alpha: model.matrix misbehaves on two-sided formulas
In-Reply-To: <6rsovchlnr.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.SUN.3.95.970910150548.4854J-100000@troi>

On 10 Sep 1997, Douglas Bates wrote:

> I am using R for a graduate class on linear models that I teach.  I
> sent the class a sample transcript of explicit construction of the
> model matrix and use of the QR decomposition.  One of the members of
> the class picked up on the fact that the model matrix was not what I
> advertised that it should be when a two-sided formula is used.  A
> one-sided formula works properly.  For example,
>  > library(st849)          # loads data sets from the text
>  > e1.1
>        density speed
>   [1,]    20.4  38.8
>  > model.matrix(~density, data = e1.1)  # what we would expect
>        (Intercept) density
>   [1,]           1    20.4
>   [2,]           1    27.4
>  > model.matrix(sqrt(speed) ~ density, data = e1.1) # not what we want
>        (Intercept) density
>   [1,]           1    38.8
>   [2,]           1    31.5
> 
> I think that somewhere along the line an expression like
>  eval(form[[2]], data)
> is being used when it would be better to use
>  eval(form[[length(form)]], data)

No, it's worse than that.  For versions of R up to 0.50-a4, the new alpha
release, model.matrix(formula,dataframe) assumes that its data argument
was generated by
	dataframe<-model.frame(formula,data)
It does *not* check the names or order of the columns. This means that
model.matrix(formula, some.data.frame) will usually give the wrong answer.

In R0.50-a4 this is fixed.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From paul@stat.auckland.ac.nz  Thu Sep 11 02:28:47 1997
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Thu, 11 Sep 1997 13:28:47 +1200 (NZST)
Subject: R-alpha: Mathematical Annotation in R (plots)
In-Reply-To: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
References: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
Message-ID: <199709110128.NAA17794@stat1.stat.auckland.ac.nz>

	[[ this has first bounced to me as 'list-manager', because the
	   subject said  ``Returned mail: User unknown''
	   Paul, I assume you'd approve the subject I've chosen...
	   -- Martin M 
	]]

 hi
 
 for those who are interested ...
 
 the following is a LaTeX document which describes the current state of
 mathematical expression syntax in R
 
 paul
 
 ------CUT HERE---------------------------------------------
 
 \documentstyle{article}
 \begin{document}
 
 \section*{Documentation for \\
 Mathematical Annotation in $R$}
 
 If the {\tt text} argument to one of the text-drawing functions ({\tt
 text}, {\tt mtext}, {\tt axis}) in $R$ is an expression, the argument
 is interpreted as a mathematical expression and the output will be
 formatted according to \TeX -like rules.
 
 A mathematical expression must obey the normal rules of syntax for
 any $R$ expression, but it is interpreted according to very
 different rules than for normal $R$ expressions.  
 
 \begin{description}
 \item[binary operators]  addition, subtraction, multiplication, and
 division use the standard $R$ syntax, although multiplication only
 juxtaposes the arguments.  For example, {\tt a+b}, {\tt a-b}, and {\tt
 a/b}, produce $a+b$, $a-b$, and $a/b$, but {\tt a*b} produces $ab$.
 
 \item[unary operators]  positive and negative numbers are specified
 with standard syntax.  For example, {\tt +x} produces $+x$ and {\tt
 -y} produces $-y$.
 
 \item[subscripts and superscripts]  a subscript is specified
 using the subsetting syntax and a superscript is specified using 
 the power syntax.  For example, {\tt x[i]} produces
 $x_i$ and {\tt x\^{}2} produces $x^2$. 
 
 \item[accents] accented expressions are specified using the special
 mathematical functions {\tt hat} and {\tt bar}.  For example, {\tt
 hat(x)} produces $\hat x$ and {\tt bar(x)} produces $\bar x$.
 
 \item[fractions] fractions are specified using the special
 mathematical function {\tt over}. For example, {\tt over(1,2)}
 produces $1\over2$.
 
 \item[relations]  equality or assignment of terms is specified using
 the {\tt ==} relation.  For example, {\tt x == y} produces $x=y$.
 
 \item[visible grouping]  terms are visibly grouped by placing them
 within parentheses.  For example, {\tt (x+y)} produces $(x+y)$.
 
 \item[invisible grouping]  terms are invisibly grouped by placing
 them within curly braces. For example {\tt x\^{}\{2*y\}} produces
 $x^{2y}$, whereas {\tt x\^{}2*y} produces $x^2y$.
 
 \item[big operators]  a sum, product, or integral is specified using
 the special mathematical function of the corresponding name.  Each
 of these functions takes three arguments;  the first indicates what
 is being summed/multiplied/integrated and the second and third specify
 the limits of the summation/product/integral.  For example, {\tt
 sum(x[i], i==0, n)} produces $\sum\limits_{i=0}^n x_i$.
 
 \item[radicals]  a square root expression is specified using the
 special mathematical functions {\tt root} and {\tt sqrt}.  For
 example, {\tt sqrt(x)} produces $\sqrt x$.
 
 \item[absolute values]  an absolute term is specified using the
 special mathematical function {\tt abs}.  For example, {\tt abs(x)}
 produces $\left|x\right|$.
 
 \item[juxtaposition]  multiple terms are juxtaposed using the special
 mathematical function {\tt paste}.  For example, {\tt paste(over(b,
 2), y, sum(x))} produces ${b\over2} y \sum x$.
 
 \item[typeface changes]  the default font in mathematical expressions
 is italic (except for terms which are symbols).  A new typeface is
 specified using the special mathematical functions {\tt bold}, {\tt
 italic}, {\tt plain}, and {\tt bolditalic}.  For example, {\tt
 plain(X)[i]} produces ${\rm X}_i$. These font specifications do not
 accumulate (i.e., {\tt bold(italic(x)))} produces $x$ (an italic "x"),
 whereas {\tt bolditalic(x)} produces \textit{\textbf{x}} (a bold, italic "x").
 
 \item[general expressions]  any functional expression which is not a
 special mathematical function is simply reproduced as a function
 expression.  For example, {\tt foo(x)} produces $foo(x)$.
 
 
 \end{description}
 
 \end{document}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep 11 11:22:58 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Sep 1997 12:22:58 +0200
Subject: R-alpha: Mathematical Annotation in R (plots)
In-Reply-To: <199709110128.NAA17794@stat1.stat.auckland.ac.nz>
References: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
 <199709110128.NAA17794@stat1.stat.auckland.ac.nz>
Message-ID: <199709111022.MAA24424@aragorn.ci.tuwien.ac.at>

>>>>> Paul Murrell writes:

> 	[[ this has first bounced to me as 'list-manager', because the
> 	   subject said  ``Returned mail: User unknown''
> 	   Paul, I assume you'd approve the subject I've chosen...
> 	   -- Martin M 
> 	]]

>  hi
 
>  for those who are interested ...
 
>  the following is a LaTeX document which describes the current state of
>  mathematical expression syntax in R

very nice!

Martin, can we include this in the R Base Manual?  (i.e. in Man.tex)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep 11 12:19:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Sep 1997 13:19:07 +0200
Subject: R-alpha: naming convention for index files
In-Reply-To: <199709081556.RAA01060@sophie.ethz.ch>
References: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at>
 <199709081556.RAA01060@sophie.ethz.ch>
Message-ID: <199709111119.NAA28447@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

KH> In the process of moving to the new directory structure, we might also
KH> reconsider the naming of the various index files.

KH> A simple idea would be to have an `INDEX' file in each directory where
KH> this is appropriate.  E.g., we could have

KH> pkg/funs/INDEX		(rather than help/pkg/INDEX)

> but  help/base/INDEX  is autogenerated
> where as everything in ./funs/  (or /R/  as you propose later)  is  SOURCE

KH> pkg/data/INDEX		(rather than index.doc)
> index.doc is source

KH> pkg/help/INDEX		(rather than AnIndex)
> this is auto-generated again...

> --
> in summary, we could well say   INDEX  instead of different names,
> but I don't think we should  autogenerate a file in a directory
> where there's only source  (other than the 'Makefile'; Lib... files that
> 			    configure generates, and which are not needed
> 			    anymore after installation)

> Remember: 

> 	The big idea is still that after

> 		make install + install-help + ..
> 			(just after all the installation)

> 	you should be able to
> 	REMOVE the full  ./src/  tree and still have a completely 
> 	working R (including online help, ...).


KH> or e.g.

KH> pkg/INDEX.funs
KH> pkg/INDEX.data

KH> etc.

KH> The package TITLE files would be used for building the package index of
KH> a library tree (LibIndex?)

> very good idea

KH> In any case, the `plain' indices to be displayed upon calling an
KH> appropriate form of help() could contain MORE than simply a list of
KH> things.  I.e., more like a README.

KH> My idea is (assuming only RHOME is in .lib.loc):

KH> library()

KH> `RHOME' is the location of the default R library tree.
KH> Blah blah blah ...

KH> Packages in `RHOME':

KH> base		The basic package.
KH> eda		...
KH> mva		...

KH> The last lines could be generated from the packages' TITLE files.  The
KH> other info from some stub, perhaps LibIndex.in?

> very good idea

KH> As usual, any feedback is appreciated.

> as usual, I give you some ... ;-)

Yes, Martin, what would I do without you?

You are right, of course, there should be some distinction between the
static and the dynamic (automatically generated) index files.

I think we need to distinguish two things.  On the one hand, we need
some short (a one-liner as in TITLE) and some long ``documentation'' on
a package.  The long one could be sort of like the README files which
come with certain S add-ons (and typically list the user-level objects
in the pkg).

If we ask for information about a package, the long one is what we
should get, I think.

On the other hand, it is clearly useful to have lists of R objects and
data sets a package provides.  These are the INDEX files.  But these
could also be auto-generated upon installation from the man sources.
In fact, as we also need them in HTML (and maybe in LaTeX), there is
not too much use for prebuilt ones ...

So, what shall we do about the indices?  As I already said, I think that
the documentation for data should be converted to the new Rd format and
merged with the R object documentation (same name space etc).  

Clearly, we should have a list of data somewhere, so that we can quickly
list all data sets.  Hmmm ... I guess I am not entirely sure what to do.

Library `info' should be o.k.:  we create the LibIndex from a README
like file and the TITLE files of all packages in the lib.

***

For the time being, I will not change anything.  (Unless we have a real
breakthough ...)

In the new dir structure, should the INDEX and TITLE files be installed
to $lib/$pkg or its help subdir?  They make sense outside of help ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 12 11:09:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 12 Sep 1997 12:09:08 +0200
Subject: R-alpha: bug in passing of empty  (...)
Message-ID: <199709121009.MAA01186@sophie.ethz.ch>

This is too bad (and an old bug at least since 0.49); 
it also breaks some code I have been using in S-plus:

> tst <- function(...) ls(...)

> tst()#--- should really give the same as ls() !!
character(0)

> ls()
  [1] "%in%"                   "As.integer"             "Dir"                   
  [4] "Dir0"                   "Fn12"                   "Slynx"                 
  ......
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep 12 11:46:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Sep 1997 12:46:35 +0200
Subject: R-alpha: bug in passing of empty  (...)
In-Reply-To: Martin Maechler's message of Fri, 12 Sep 1997 12:09:08 +0200
References: <199709121009.MAA01186@sophie.ethz.ch>
Message-ID: <x2wwkmstbo.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> This is too bad (and an old bug at least since 0.49); 
> it also breaks some code I have been using in S-plus:
> 
> > tst <- function(...) ls(...)
> 
> > tst()#--- should really give the same as ls() !!
> character(0)
> 
> > ls()
>   [1] "%in%"                   "As.integer"             "Dir"                   
>   [4] "Dir0"                   "Fn12"                   "Slynx"                 
>   ......

I don't know whether it's a bug or a feature, but it has nothing to do
with (...)

> tst<-function()ls()
> tst()
character(0)
> ls()
 [1] "NextMethod" "airquality" "dig"        "grid"       "l"         
 [6] "tst"        "umach"      "x"          "xmin"       "y"         
[11] "z"          ""       
> tst<-function(...){x<-5;ls(...)}  
> tst()
[1] "x"
> tst<-function(){x<-5;ls()}
> tst()
[1] "x"

I'm rather suspecting that pos=-1 in the argument list to ls should
have been pos=1. Anyone have the big picture on pos and envir?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Sep 12 18:00:17 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 12 Sep 1997 10:00:17 -0700 (PDT)
Subject: R-alpha: long term wishes
In-Reply-To: <6rsovchlnr.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.SUN.3.95.970912093350.7444C-100000@troi>


I have two difficult but not impossible suggestions for long-term
improvements to memory handling in R.

The first is in foreign function calling.  It would sometimes save a lot
of time if you could designate arguments to to .C/.Fortran as input or
output only (like Fortran 90 INTENT IN/OUT descriptions).  At the moment
every argument to foreign code is copied into a non-relocatable area, then
copied back into a new R variable.  If a variable was INTENT IN, it would
not be copied back, and that element of the return value would be NULL; if
a variable was INTENT OUT it would not be copied in and R would just
malloc() the correct amount of space in the non-relocatable area.  I've
been writing quite a bit of C code that turns huge matrices into small
ones, involving a lot of memory movement that could easily be removed.
The default would have to still be copying everything, for backwards
compatibility and idiotproofing.

The second, more difficult suggestion, is to do something other than stop
when memory is exhausted.  It doesn't matter if what you do is slow, as
the alternative is complete failure.  It should be possible for R to try
and grab a bigger chunk of memory (perhaps 50-100% bigger) and move into
it.  The relocatable part of the heap wouldn't be a big problem but the
non-relocatable part would need to be kept where it was and a new one
started.  On the other hand, this probably requires rewriting a whole
bunch of stuff and might be very painful.


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sat Sep 13 02:20:43 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 13 Sep 1997 13:20:43 +1200 (NZST)
Subject: R-alpha: bug in passing of empty  (...)
Message-ID: <199709130120.NAA21321@stat1.stat.auckland.ac.nz>

This is a "feature" of ls().  When invoked with no arguments it returns
the list of variables \emph{in the environment it is called from}.
This is to make it useful in conjunction with debug() and browser().
It allows you find out what the current local variables are.

To get the same effect as a top level ls(), you must expicitly do
	ls(pos=1)             # may fail if we allow attaching at pos=1
	ls(envir=.GlobalEnv)  # safer

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Sat Sep 13 13:55:24 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 13 Sep 1997 07:55:24 -0500
Subject: R-alpha: ${RHOME}/configure and f2c.h
Message-ID: <6r202txtj7.fsf@franz.stat.wisc.edu>

Installing R-0.50a4 on some of our systems I found that the mva
library doesn't build because the include file f2c.h is not available.

 make[3]: Entering directory `/afs/cs.wisc.edu/unsup/R-0.50alpha4/src/library/mva/src-c'
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c dblcen.c 
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c dist.c 
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c hclust.c 
 hclust.c:6: f2c.h: No such file or directory
 make[3]: *** [hclust.o] Error 1

Is it possible to search for this in the configure script?  I'm not
sure what to suggest to the installer if it is not available.  Is the
information used sufficiently well-defined that a replacement could be
generated on the fly?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Sep 13 20:04:51 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 13 Sep 1997 12:04:51 -0700 (PDT)
Subject: R-alpha: compatibility
In-Reply-To: <199709131524.RAA03703@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970913115858.557A-100000@troi>


Two compatibility issues found while trying to convert a simulation from S
to R.

1. set.seed()  We don't have this function.  According to Venables &
Ripley it just picks a seed from a list of 1000 possibilities. How about
"set.seed" <-function (i) 
{
        if (any(i > 1000) | any(i < 1)) 
                stop("argument to set.seed() must be in 1:1000")
        if (any(i != trunc(i))) 
                stop("argument to set.seed()must be an integer")
        .Random.seed <<- as.integer((200 * c(i, i^2, i^3))%%c(30269, 
                30307, 30323))
}


2. lapply() in S-PLUS works on vectors, ie
lapply(X, FUN) works like lapply(as.list(X),FUN) orsapply(X,FUN,simplify=F)


	-thomas



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 07:33:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 08:33:23 +0200
Subject: R-alpha: predict.lm -- who ..?
Message-ID: <199709150633.IAA00396@sophie.ethz.ch>

Just a short reminder / question --

We've had one posting 
>> Date: Sun, 17 Aug 1997 19:51:20 -0700
>> From: Kung-Sik Chan <kchan@stat.uiowa.edu>
>> To: r-help@stat.math.ethz.ch
>> Subject: R-beta: bug report

with a  predict.default  that would "work" with (some) lm objects, 
and I think it was said that  predict.lm  "is being" written
(Peter Dalgaard, Ross Ihaka ?)
because it was urgently needed.

We haven't seen any code posting since, and I just wondered about the
current state of the affair.

Maybe some  predict.lm(.) could be posted in order to be discussed and
polished ...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 09:29:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 10:29:37 +0200
Subject: R-alpha: is.vector(.., mode=..) bug  (old)
Message-ID: <199709150829.KAA04259@sophie.ethz.ch>

It is clear, I think, that
	is.vector(o, mode = "any")
should be  TRUE  whenever any of
	is.vector(o, mode = "<something>")
is TRUE.

This is not yet the case, however, see below.

Consider the following examples  which should be self-explaining.
Besides the above bug, they also show you that -- for S compatibility --
the  mode argument should really use strings as returned by 'mode(.)';
Currently it uses strings as returned by 'typeof(.)',
 see the definition of mode (written in R) which uses typeof(.) [among others].

[[and I've added the following useful EXAMPLE to the  man page of 'mode' 
	 src/library/base/man/mode :

     cex3 <- c("1","1:1","1i","list(1)","args","lm","formals(lm)[[2]]","y~x")
     lex3 <- sapply(cex3, function(x) eval(parse(text=x)))
     mex3 <- t(sapply(lex3, function(x) c(typeof(x), storage.mode(x), mode(x))))
     dimnames(mex3) <- list(cex3, c("typeof(.)","mode(.)","storage.mode(.)"))
     mex3

]]


## Here is my test code revealing the  is.vector(..) problems :

### Ex. 1  --- call ---
cl <- call("lm",y~x)
is.call(cl)# TRUE
mode(cl)  # "call" (S & R);	#__R:  typeof(cl) == "language"

is.vector(cl, mode = "any")      #R: FALSE, S: TRUE
is.vector(cl, mode = "call")     #R: FALSE  S: TRUE
is.vector(cl, mode = "language") #R: TRUE   S: FALSE

### Ex. 2  --- symbol ---
fo <- formula( y ~ x )
mode(fo)  # "call" (S & R)	#__R: typeof(fo) == "language"
is.call(fo)# TRUE  (S & R)
is.name(fo)# FALSE (S & R)

fo1 <- fo[1][[1]]
fo1 # `~'
mode(fo1)  # "name" (S & R)	#__R: typeof(fo1) == "symbol"
is.call(fo1)# FALSE (S & R)
is.name(fo1)# TRUE  (S & R)

is.vector(fo1, mode = "any")    #R: FALSE, S: TRUE
is.vector(fo1, mode = "name")   #R: FALSE, S: TRUE
is.vector(fo1, mode = "symbol") #R: TRUE,  S: FALSE

-----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 10:20:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 11:20:54 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Martin Maechler's message of Mon, 15 Sep 1997 08:33:23 +0200
References: <199709150633.IAA00396@sophie.ethz.ch>
Message-ID: <x2afhf0w7d.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> Just a short reminder / question --
> 
> We've had one posting 
> >> Date: Sun, 17 Aug 1997 19:51:20 -0700
> >> From: Kung-Sik Chan <kchan@stat.uiowa.edu>
> >> To: r-help@stat.math.ethz.ch
> >> Subject: R-beta: bug report
> 
> with a  predict.default  that would "work" with (some) lm objects, 
> and I think it was said that  predict.lm  "is being" written
> (Peter Dalgaard, Ross Ihaka ?)
> because it was urgently needed.
> 
> We haven't seen any code posting since, and I just wondered about the
> current state of the affair.
> 
> Maybe some  predict.lm(.) could be posted in order to be discussed and
> polished ...

I think Ross has the version that is closest to the real thing...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 15 11:16:26 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 15 Sep 1997 22:16:26 +1200 (NZST)
Subject: R-alpha: predict.lm -- who ..?
Message-ID: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>

Here is my (incomplete) version. This will work for full-rank models,
and I suspect also for singular models (the comment is just a reminder
to myself that I was thinking about this).

I set out to change the underlying structure so that case names
would be propagated through to to the fitted values.  This doesn't
happen at the moment because they are not handled within "model.matrix".
A quick fix would be to replace dimnames(x) below by row.names(mf).

There is no computation of standard errors below, but the present
version has something like the right computation.

Sorry that this is just a hint, but I'm really under pressure at
present.  Anyone got any (applied) exam questions on linear models
or glms handy?
	Ross
	

predict.lm <-
function (fit, newdata) 
{
	mf <- model.frame(formula(fit), data = newdata)
	# recreate the design matrix
	x <- model.matrix(terms(fit), mf)
	# grab the coefficients (order is correct?)
	b <- coef(fit)
	b[is.na(b)] <- 0
	# compute predictions
	p <- x %*% b
	# attach name information
	if(is.matrix(b)) {
		dimnames(p) <- list(dimnames(x)[[1]], dimnames(b)[[2]])
	}
	else {
		p <- as.vector(p)
		names(p) <- dimnames(x)[[1]]
	}
	p
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 14:48:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 15:48:09 +0200
Subject: R-alpha: set.seed(.) [was 'compatibility']
Message-ID: <199709151348.PAA04532@sophie.ethz.ch>


>>>>> Thomas Lumley writes:
    >> Two compatibility issues found while trying to convert a simulation
    >> from S to R.

    >> 1. set.seed()  We don't have this function.  According to Venables &
    >> Ripley it just picks a seed from a list of 1000 possibilities. How about
    >>
    >> "set.seed" <-function (i) 
    >> {
    >>         if (any(i > 1000) | any(i < 1)) 
    >>                 stop("argument to set.seed() must be in 1:1000")
    >>         if (any(i != trunc(i))) 
    >>                 stop("argument to set.seed()must be an integer")
    >>         .Random.seed <<- as.integer((200 * c(i, i^2, i^3))%%c(30269, 
    >>                 30307, 30323))
    >> }

Thank you Thomas,
yes I agree that we should have a  set.seed(.).

{{now follows a longish explanation about what S-plus does, etc..
  at the end a better (?) proposal for set.seed 
}}

When I first thought about implementing  set.seed(.) in R,
I tried to understand what S-plus does (and did not succeed).
In the mean time, I have re-investigated and found almost ``everything'' :

S-plus 3.4 *help* says

Sp3.4>>     DESCRIPTION:
Sp3.4>> 	   Puts the random number generator in a reproducible state.
Sp3.4>> 
Sp3.4>>     USAGE:
Sp3.4>> 	   set.seed(i)
Sp3.4>> 
Sp3.4>>     REQUIRED ARGUMENTS:
Sp3.4>>     i:     be an integer between 0 and 1000.
Sp3.4>> 
Sp3.4>>     SIDE EFFECTS:
Sp3.4>> 	   Sets the value of the .Random.seed object in  the  working
Sp3.4>> 	   directory.
Sp3.4>> 
Sp3.4>>     DETAILS:
Sp3.4>> 	   Random number generators in S-PLUS are all  based  upon  a
Sp3.4>> 	   single  uniform  random  number  generator  that generates
Sp3.4>> 	   numbers in a very long, but ultimately periodic  sequence.
Sp3.4>> 	   The   position   in   the   sequence  is  held  in  object
Sp3.4>> 	   .Random.seed.  Function set.seed sets .Random.seed so that
Sp3.4>> 	   subsequent  calls  to  random  number  generator functions
Sp3.4>> 	   (runif, rnorm, etc.)  will generate  numbers  from  a  new
Sp3.4>> 	   portion of the overall cycle.
Sp3.4>> 
Sp3.4>> 	   Random  number  generation  in  S-PLUS  is  adapted   from
Sp3.4>> 	   Marsaglia  (1973);  see  Kennedy  and  Gentle  (1980)  for
Sp3.4>> 	   background information.

So they __say__   ``i in 0:1000'', but the
problem is that set.seed(i) also ``works'' with any other integer i.

But what exactly should happen?
The crucial sentence is (as vague as)
 Sp3.4>> Function set.seed sets .Random.seed so that
 Sp3.4>> subsequent calls to random number generator functions (runif...) 
 Sp3.4>> will generate numbers from a new portion of the overall cycle.

The intent being that for ANY i,j (i!=j) set.seed(i) and set.seed(j) would
choose ``distant'' parts of the periodic cycle.

Unfortunately, we don't know what exactly happens in
the S-plus code for set.seed(i), namely,  .C("setseed", as.integer(i))
However, I have found out the following which should suffice :

 1) Only .Random.seed[4:6]  are varyied by set.seed, i.e., 
   after set.seed(i), .Random.seed always is

	   1  2  3  4  5  6  7  8  9 10 11 12	
      [1] 21 14 49  *  *  * 32 22 36 23 28  3
		   X4 X5 X6

   Which means that only the 'congrval' {Venables & Ripley, 2nd ed., p.166-167}
   is varied	

 2) X4 is always ==  16*((i+2) %% 4)
    X5 takes (all) values in 0:63  [also with some periodicity]
    X6 takes the values of 0:3

 3) set.seed(i) <==> set.seed(i + n*1024)  for all integers n, i

 4) { set.seed(i) ;  i \in {integers}} 
    results in a set of 1024 different values of 'congrval'.
    These values are EXACTLY EQUISPACED lying in {0,..,2^32}.

    If C[1:1024] are these sorted values, we have

	C[i] == 201621 + (i-1)* 2^22  , for i in 1:1024
	


So far for S-plus.

-----------------------------------------------------------------

Now, in R with a different basic RNG (with a longer period), 
		-- see ?.Random.seed --
we would want  set.seed(i)
to also guarantee that the locations in the periodic cycle are far apart.

I think (but may be wrong; I must do other things now !!)
this can be better achieved by just changing one of the 3 congruential
generators involved.
This leads to the following proposal :

set.seed <- function (i) 
{
        if(length(i) != 1  || i != (ii <- as.integer(i)))
	  stop("argument to set.seed() must be integer(1)")
	i <- ii
        if (i > 1024 || i < 1) {
	  warning("set.seed(i) has i outside 1:1024; taking  i %% 1024")
	  i <- i %% 1024; if(i <= 0) i <- i+ 1024
	}
        invisible(.Random.seed <<- as.integer(c((171*i)%%30269, 10909, 10111)))
}



Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep 15 15:51:37 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 15 Sep 1997 10:51:37 -0400
Subject: R-alpha: compatibility
References: <Pine.SUN.3.95.970913115858.557A-100000@troi>
Message-ID: <97Sep15.105405edt.26503@mailgate.bank-banque-canada.ca>

Please don't mess with the random number generator without good reason!
You will mess me up a whole lot! You can of course change the default
behavior of set.seed without affecting me. Here are my thoughts on
set.seed.

Despite the fact that the Blue Book says set.seed takes an integer
argument, and despite the fact that the Splus version of set.seed does
take an integer argument, I don't think anyone who actually does a lot
of random experiments would actual want to use set.seed like that. The
reason is that you often want to reproduce a random experiment after
you've done it, and of course, often, you don't set the seed before you
do the experiment. To get around this I save the starting .Random.seed
with my simulation experiments. Then I have my own set.seed (in Splus
and in R) which works directly with the .Random.seed, so in Splus it
takes 12 (small) integers as its argument and in R it takes 3 integers.
I also allows a single integer argument for Blue Book compatibility and
in Splus I use their set.seed (which I rename) for this case. As you may
see below, the default behavior in R is rather ad hoc. Below are my
Splus and R versions of set.seed. The R version has a minor workaround
for the problem that the R .Random.seed does not seem to exist until the
random number generator is used the first time.  I also prefer returning
the new seed as the value of the function.

Paul Gilbert
______________

in R

    set.seed <- function(seed=NULL)
      {if (is.null(seed))
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not
yet exist
          seed <-.Random.seed
         }
       else
         {if (1==length(seed))

global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }
    global.assign <- function(name, value)
                          {assign(name,value, envir=.GlobalEnv)}

in S
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
          seed <-.Random.seed
       else
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }
    global.assign <- function(name, value) {assign(name,value, where =
1)}


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Mon Sep 15 17:27:54 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Mon, 15 Sep 1997 09:27:54 -0700 (PDT)
Subject: R-alpha: compatibility
In-Reply-To: <97Sep15.105405edt.26503@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970915091422.1882B-100000@troi>

On Mon, 15 Sep 1997, Paul Gilbert wrote:

> Please don't mess with the random number generator without good reason!
> You will mess me up a whole lot! You can of course change the default
> behavior of set.seed without affecting me. Here are my thoughts on
> set.seed.

I am aware of the problems with messing with random number generators,
which is why I wasn't proposing to.  In the generator we use (unlike in
S-PLUS), any seed value gives (a different part of) the same sequence of
random numbers, so seed setting is a harmless procedure.

>> Despite the fact that the Blue Book says set.seed takes an integer
> argument, and despite the fact that the Splus version of set.seed does
> take an integer argument, I don't think anyone who actually does a lot
> of random experiments would actual want to use set.seed like that.

I don't think the issue is whether set.seed() does something useful in S. 
It does *something* in S, and people use it in writing programs. They may
well want to run these programs in R (or we may want them to, especially
if they are sharing CPU time with us). The last thing we want to do is to
have a function set.seed() in R that does something qualitatively
different from the S function. 


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Mon Sep 15 17:55:02 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Mon, 15 Sep 1997 11:55:02 -0500 (CDT)
Subject: R-alpha: compatibility
In-Reply-To: <Pine.SUN.3.95.970915091422.1882B-100000@troi> from "Thomas Lumley" at Sep 15, 97 09:27:54 am
Message-ID: <9709151655.AA13639@nokomis.stat.umn.edu>

This is one point where compatibility is not necessarily a good
thing. S, like most systems gives, you no real control over the random
number generator expect re-seeding. Usually this is probably good. But
most simulation books recommend running any simulations you care about
with two very different generators. Most people don't do this because
one generator is usually easy to use (the built-in one in your
favorite system) and anything else is impossible. Another issue that S
faces has to do with running separate bits of a simulation on separate
workstations. Unless you are careful, the separate bits will share
parts of random number streams, and being careful is not really
possible with S's generator (I think) -- it is possible but not easy
with R's. (Of course overlap can be a good thing if you know you have
it -- the point here is that lots of folks run separate simulations
thinking they have independent runs when they probably do not in any
reasonable sense).

The bottom line is that it would be nice to eventually provide "power
users" with more control over the random number generator system.  Now
is clearly not the time to think about how to do that, but it would be
unfortunate if decisions were made at this point in the name of
compatibility that might limit the freedom of doing something "right"
later on.

Just my 2c.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep 15 19:44:24 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 15 Sep 1997 14:44:24 -0400
Subject: R-alpha: set.seed compatibility
References: <Pine.SUN.3.95.970915091422.1882B-100000@troi>
Message-ID: <97Sep15.144656edt.26510@mailgate.bank-banque-canada.ca>

The modification to set.seed that I was suggesting does not change its
default behavior, so software which runs in S still runs with my change.
The change means that set.seed can also be given a value for
.Random.seed. This would fail with the usual S version of set.seed. I
don't think we need to take compatibility to the extend of failing when
S fails.

Also, I don't think set.seed can really accomplish what I think of as
the true objective of compatibility: reproduce S random experiments with
R (possibly not even if the same random number generator is used). Even
Splus has not been completely successful in this respect. There were
some changes between 3.2 and 3.3 which affected reproducibility.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 21:50:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 22:50:58 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Ross Ihaka's message of Mon, 15 Sep 1997 22:16:26 +1200 (NZST)
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
Message-ID: <x24t7mfgi5.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Here is my (incomplete) version. This will work for full-rank models,
> and I suspect also for singular models (the comment is just a reminder
> to myself that I was thinking about this).
> 
> I set out to change the underlying structure so that case names
> would be propagated through to to the fitted values.  This doesn't
> happen at the moment because they are not handled within "model.matrix".
> A quick fix would be to replace dimnames(x) below by row.names(mf).
> 
> There is no computation of standard errors below, but the present
> version has something like the right computation.
> 
> Sorry that this is just a hint, but I'm really under pressure at
> present.  Anyone got any (applied) exam questions on linear models
> or glms handy?
> 	Ross
> 	
> 
> predict.lm <-
> function (fit, newdata) 
> {
> 	mf <- model.frame(formula(fit), data = newdata)
> 	# recreate the design matrix
> 	x <- model.matrix(terms(fit), mf)
> 	# grab the coefficients (order is correct?)
> 	b <- coef(fit)
> 	b[is.na(b)] <- 0
> 	# compute predictions
> 	p <- x %*% b
> 	# attach name information
> 	if(is.matrix(b)) {
> 		dimnames(p) <- list(dimnames(x)[[1]], dimnames(b)[[2]])
> 	}
> 	else {
> 		p <- as.vector(p)
> 		names(p) <- dimnames(x)[[1]]
> 	}
> 	p
> }
> 

Hum, maybe my version was closer after all. Thing was that I tried to
be smart and have it work without having to specify the dataframe
(which gets to be a terrible pain when you need to specify factors
with the same level structure as in the original). On second thought,
I decided to abandon that idea and stick with S(-plus?) compatibility.
However I did get the SE's done and soforth. Here's my effort:


"like.frame" <-
function (frame, ...) 
{
        if (!is.data.frame(frame)) 
                stop("like.frame: first argument must be a data frame")
        f <- list(...)
        class(f) <- "data.frame"
        n <- ncol(f)
        nm.base <- names(frame)
        nm.new <- names(f)
        if (is.null(nm.new)) 
                nm.new <- rep("", n)
        for (i in 1:n) {
                if (nm.new[i] == "") {
                        #positional match 
                        nm.new[i] <- nm.base[i]
                        j <- i
                }
                else j <- match(nm.new[i], nm.base)
                if (!is.na(j)) 
                        if (is.factor(frame[[j]])) {
                                lab <- levels(frame[[j]])
                                lev <- 1:nlevels(frame[[j]])
                                f.i <- f[[i]]
                                if (is.character(f.i)) 
                                 f.i <- match(f.i, lab)
                                f[[i]] <- factor(f.i, levels = lev, 
                                 labels = lab)
                        }
        }
        names(f) <- nm.new
        f
}
"predict.lm" <-
function (object, ...) 
{
        mod.fr <- model.frame(object)
        form <- formula(object)
        # x~a+b becomes ~a+b
        form <- as.call(list(form[[1]], form[[3]]))
        class(form) <- "formula"
        pred.fr <- like.frame(mod.fr, ...)
        # the following is a kludge to work around a bug in data.frame:
        zz <- attr(terms(form), "variables")
        zz[[1]] <- as.name("list")
        pred.fr <- eval(zz, pred.fr)
        class(pred.fr) <- "data.frame"
        X <- model.matrix(form, pred.fr)
        n <- NROW(object$qr$qr)
        p <- object$rank
        p1 <- 1:p
        piv <- object$qr$pivot[p1]
        r <- resid(object)
        f <- fitted(object)
        w <- weights(object)
        if (is.null(w)) 
                rss <- sum(r^2)
        else rss <- sum(r^2 * w)
        R <- chol2inv(object$qr$qr[p1, p1, drop = FALSE])
        est <- object$coefficients[piv]
        predictor <- c(X[, piv] %*% est)
        ip <- real(NROW(X))
        resvar <- rss/(n - p)
        vcov <- resvar * R
        for (i in (1:NROW(X))) {
                xi <- X[i, piv]
                ip[i] <- xi %*% vcov %*% xi
        }
        stderr1 <- sqrt(ip)
        stderr2 <- sqrt(resvar + ip)
        tt <- qt(0.975, n - p)
        conf.l <- predictor - tt * stderr1
        conf.u <- predictor + tt * stderr1
        pred.l <- predictor - tt * stderr2
        pred.u <- predictor + tt * stderr2
        z <- list(predictor = predictor, conf.l = conf.l, conf.u = conf.u, 
                pred.l = pred.l, pred.u = pred.u)
        class(z) <- "data.frame"
        z
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 22:57:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 23:57:02 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Peter Dalgaard BSA's message of 15 Sep 1997 22:50:58 +0200
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
 <x24t7mfgi5.fsf@bush.kubism.ku.dk>
Message-ID: <x2yb4yckb5.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> Hum, maybe my version was closer after all. Thing was that I tried to
...
> However I did get the SE's done and soforth. Here's my effort:

OK. A little thought and some cleanup later, I have this one. I'm a
little reluctant to go completely Splus compatible (return a list with
components $fit $se.fit $residual.scale $df if se.fit=T, otherwise
just the predicted values) and losing the confidence/prediction
intervals. Opinions?

"predict.lm" <-
  function (object, newdata = model.frame(object)) 
{
  form<-formula(object)
  form<-as.call(list(form[[1]],form[[3]])) # x~a+b becomes ~a+b
  class(form)<-"formula"
  X <- model.matrix(form,newdata)
  n <- NROW(object$qr$qr)
  p <- object$rank
  p1 <- 1:p
  piv <- object$qr$pivot[p1]
  r <- resid(object)
  f <- fitted(object)
  w <- weights(object)
  if (is.null(w)) 
    rss <- sum(r^2)
  else 
    rss <- sum(r^2*w)
  R <- chol2inv(object$qr$qr[p1, p1, drop = FALSE])
  est <- object$coefficients[piv]
  predictor <- c(X[,piv] %*% est)
  ip <- real(NROW(X))
  resvar <- rss/(n - p)
  vcov <- resvar * R
  for (i in (1:NROW(X))) {
    xi <- X[i,piv]
    ip[i] <- xi %*% vcov %*% xi
  }
  stderr1 <- sqrt(ip)
  stderr2 <- sqrt(resvar + ip)
  tt <- qt(0.975, n - p)
  conf.l <- predictor - tt * stderr1
  conf.u <- predictor + tt * stderr1
  pred.l <- predictor - tt * stderr2
  pred.u <- predictor + tt * stderr2
  data.frame(predictor=predictor, conf.l=conf.l, conf.u=conf.u,
	pred.l=pred.l,pred.u=pred.u,row.names=rownames(newdata))
}
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 15 23:10:52 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 16 Sep 1997 10:10:52 +1200 (NZST)
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: <x2yb4yckb5.fsf@bush.kubism.ku.dk>
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
 <x24t7mfgi5.fsf@bush.kubism.ku.dk>
 <x2yb4yckb5.fsf@bush.kubism.ku.dk>
Message-ID: <199709152210.KAA24228@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:

 > "predict.lm" <- [stuff returning a data frame]

This looks just like what I had in mind (though I was thinking matrix
rather than dataframe).  This I think is more useful (at least to the
kiddies I teach) than the S one.

BUT: I have been berated by my class for preparing examples with R and
trying to pass them off as S - they notice the minor differences.
Pehaps it would be possible to make a library "smodels" which is as
close to S as we can make it. I have an lm.summary and
lm.summary.print which could go into it.

In general I don't like compatibility boxes, but this seems harmless
enough.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep 16 15:09:40 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 16 Sep 1997 16:09:40 +0200
Subject: R-alpha: bug: rbind(.) drops names for character; cbind(.) is ok.
Message-ID: <199709161409.QAA13816@sophie.ethz.ch>

R version (>) 0.50-a4:

##-- This is fine :
> rbind(graph=c(1:3), plot=c(2:4), my.glm=c(3:5))
       [,1] [,2] [,3]
graph     1    2    3
plot      2    3    4
my.glm    3    4    5

##-- This is the bug:
> rbind(graph=c("A","B"), plot=c(2:3), my.glm=c(3:4))
     [,1] [,2]
[1,] "A"  "B" 
[2,] "2"  "3" 
[3,] "3"  "4" 

##-- cbind(.) is ok:
> cbind(graph=c("A","B"), plot=c(2:3), my.glm=c(3:4))
     graph plot my.glm
[1,] "A"   "2"  "3"   
[2,] "B"   "3"  "4"   
> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Sep 17 08:30:56 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 17 Sep 1997 09:30:56 +0200 (MET DST)
Subject: R-alpha: fortran
Message-ID: <9709170730.AA19097@alpha.luc.ac.be>

I have a strange problem with calling fortran in 50a4. In longitudinal
analysis, I have a vector of times. When they are unequally spaced,
the user must supply them and things work fine when they are sent to
the fortran. If the data are balanced and equally spaced, the user
need not supply them and the function calculates them, say as
time <- 1:nt
When I feed this to the fortan, it receives it as a vector of
integers!!! I have to put
time=as.double(time)
in the call for it to work properly. I do not believe that this was a
problem before a4. I thought everything was a double in R?!
Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep 17 09:33:08 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 17 Sep 1997 20:33:08 +1200 (NZST)
Subject: R-alpha: fortran
Message-ID: <199709170833.UAA19552@stat1.stat.auckland.ac.nz>

Its been this way for a while.  We made the output from the ":" operator
be integer.  This is compatible with S and is a bit more efficient
in things like x[1:10] because the subscripts do not need to be
converted to integer.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Sep 17 10:42:32 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 17 Sep 1997 11:42:32 +0200 (MET DST)
Subject: R-alpha: nlm
Message-ID: <9709170942.AA23823@alpha.luc.ac.be>

It would be nice if nlm returned the number of iterations taken as
well as the code indicating if the limit is exceeded. For the moment,
the only way to access it is by looking at the output from
print.level=2. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Thu Sep 18 15:00:11 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 18 Sep 1997 09:00:11 -0500
Subject: R-alpha: Re: R-Mailing lists ok again. ..sorry..
In-Reply-To: Martin Maechler's message of Thu, 18 Sep 1997 08:59:00 +0200
References: <199709180659.IAA01778@sophie.ethz.ch>
Message-ID: <6ren6men84.fsf@franz.stat.wisc.edu>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> This caused 3 postings (1 to R-help, 2 to R-devel) to be aborted.
> For some reason, it also seems majordomo did not save the postings in
> a 'dead.letter' or something.

> So could you please re-submit them? 

> These are the sendmail entries:

> Sep 17 21:14:21 .. sendmail[9364]: VAA09363: from=<bates@stat.wisc.edu>, size=390, class=0, pri=30390, nrcpts=1, msgid=<6ren6nbvnt.fsf@franz.stat.wisc.edu>, proto=ESMTP, relay=root@franz.stat.wisc.edu [128.105.5.95]

> Sep 17 21:47:26 .. sendmail[9518]: VAA09517: from=<bates@stat.wisc.edu>, size=331, class=0, pri=30331, nrcpts=1, msgid=<6rd8m7bu42.fsf@franz.stat.wisc.edu>, proto=ESMTP, relay=root@franz.stat.wisc.edu [128.105.5.95]

I can't find copies of those messages so I will summarize here.  One
of them was unimportant - simply an observation that the mis-typing of
TITLE as TITLe in the documentation for the library function is
intentional.  The second was a query to Fritz with a copy to this list
on whether the data files in the bootstrap library are indeed
accessible with the data function.  It seems not.  If there was a
convention that files ending with .data in a data directory should be
read with read.table I think that would be great.  Actually I think it
would be "insanely great" if they were read with
 read.table(filename, header = TRUE)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Sep 18 15:52:31 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 18 Sep 1997 16:52:31 +0200
Subject: R-alpha: -- data files :  read.table(..., header=TRUE)  -- Yes!
In-Reply-To: <6ren6men84.fsf@franz.stat.wisc.edu> (message from Douglas Bates
 on 18 Sep 1997 09:00:11 -0500)
Message-ID: <199709181452.QAA19001@sophie.ethz.ch>

>>>>> "Doug" == Douglas Bates <bates@stat.wisc.edu> writes:

    Doug>  .....
    Doug> I can't find copies of those messages so I will summarize here.

sorry, once more.

    Doug> One of them was unimportant - simply an observation that the
    Doug> mis-typing of TITLE as TITLe in the documentation for the library
    Doug> function is intentional.  

yes! (it partly breaks the HTML version..)

But with the new Rd (man) style and its perl scripts, the problem is gone
anyway.

    Doug> The second was a query to Fritz with a
    Doug> copy to this list on whether the data files in the bootstrap
    Doug> library are indeed accessible with the data function.  It seems
    Doug> not.
This also has quite a bit changed in the current source.

As Kurt says, all the packages have to be updated though before they work
with the current directory structure.

    Doug> f there was a convention that files ending with .data in a
						          ~~~~~
    Doug> data directory should be read with read.table I think that would
    Doug> be great.
indeed!
Maybe we should have  '.dat'
in order  for the Win3.x  version to need less adaption for porting... 

    Doug> Actually I think it would be "insanely great" if they
    Doug> were read with read.table(filename, header = TRUE) 
			 -------------------  ##############
Yes again!

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Sep 18 21:59:10 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 19 Sep 1997 08:59:10 +1200 (NZST)
Subject: R-alpha: stuff
Message-ID: <199709182059.IAA23976@stat1.stat.auckland.ac.nz>

Peter,
  That's fine. I'm still not doing well on the computer front; 3 down/ 1 up;
  but things are supposed to change.....
  
  
  On Doug Bates comments about files with .data extensions; if these things
  are going to work under 3.1 I think we need to limit ourselves to 3 digit
  extensions. While I'm sure .dat is already taken I think it will be easier
  to work around that. Yes I could write perl scripts to do all the 
  transforming but it's a bit of a pain (especially since I can't even keep
  up with the other developments).
  
  
  robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From helgito@rhi.hi.is  Sun Sep 21 18:40:03 1997
From: helgito@rhi.hi.is (Helgi Tomasson)
Date: Sun, 21 Sep 1997 17:40:03 +0000 (GMT)
Subject: R-alpha: R-adventure
Message-ID: <199709211740.RAA17140@hengill.rhi.hi.is>

I am trying to port R to OS/2 and XFREE86.  I have XFREE86 for OS/2
up and running and a lot the unix utilities, sh, ksh, tcsh, awk sed etc.

I have not been able to make configure running.  I have therefore
patched the makefiles manually and gotten through most of them.
All in the src-directory except /src/main/makefile at the moment
the beginning of it looks like this:

CC=gcc
CFLAGS=-g -I../include
LDCMD=
DLLFLAGS=
PICFLAGS=
SHLIBLDFLAGS=
LIBS=-lf2c  -lm
X_CFLAGS=-I/xfree86/include
X_LIBS=-L/xfree86/lib -lX11
X_EXTRA_LIBS=
X_PRE_LIBS=
FC=g77

What should these flags be?  I have guessed in the other makefiles.
For example there is no ranlib so I use ar S, which seems to work.

I have been told by experts that I should also look out for

platform.h

How should that one be in my case.

I am using the GNU-EMX gcc compiler together with g77.

sincerely yours

Helgi Tomasson

-- 
Helgi Tomasson                                       FAX:  354-552-6806
University of Iceland                                PHONE:354-525-4571
Faculty of Economics and Business Administration     email:helgito@rhi.hi.is 
Oddi v/ Sturlugotu        
IS-101 Reykjavik
ICELAND
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Sep 22 12:37:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 22 Sep 1997 13:37:16 +0200
Subject: R-alpha: -- data files :  read.table(..., header=TRUE)  -- Yes!
In-Reply-To: <199709181452.QAA19001@sophie.ethz.ch>
References: <6ren6men84.fsf@franz.stat.wisc.edu>
 <199709181452.QAA19001@sophie.ethz.ch>
Message-ID: <199709221137.NAA18680@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Doug" == Douglas Bates <bates@stat.wisc.edu> writes:
Doug> .....
Doug> I can't find copies of those messages so I will summarize here.

> sorry, once more.

Doug> One of them was unimportant - simply an observation that the
Doug> mis-typing of TITLE as TITLe in the documentation for the library
Doug> function is intentional.  

> yes! (it partly breaks the HTML version..)

> But with the new Rd (man) style and its perl scripts, the problem is
> gone anyway.

Yes, definitely.

Doug> The second was a query to Fritz with a
Doug> copy to this list on whether the data files in the bootstrap
Doug> library are indeed accessible with the data function.  It seems
Doug> not.

> This also has quite a bit changed in the current source.

> As Kurt says, all the packages have to be updated though before they
> work with the current directory structure.

Again, this will change with the new version.  If a new-style package
has a `data' subdirectory, its contents are installed along with the R
objects, shared libraries and help files etc.  Loading the pkg makes
these data sets available as well.

FRITZ:  When you update your pkg, please make sure that the data get
into the update as well.

Doug> f there was a convention that files ending with .data in a
> 						          ~~~~~
Doug> data directory should be read with read.table I think that would
Doug> be great.
> indeed!
> Maybe we should have  '.dat'
> in order  for the Win3.x  version to need less adaption for porting... 

Doug> Actually I think it would be "insanely great" if they
Doug> were read with read.table(filename, header = TRUE) 
> 			 -------------------  ##############
> Yes again!

Simply from the extension?  Or perhaps we could have a ``magic'' first
line telling a generic `read' what to do?  (A similar logic could be
applied to e.g. reading in xbase files using a (still unwritten) pseudo
method read.dbf which would be called if the generic read figures out
that it is looking at a dbase file (and again, using the result of
file(1) may be the better idea ...)

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 22 13:04:47 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Sep 1997 14:04:47 +0200
Subject: R-alpha: x[NA]
Message-ID: <x2raahftb4.fsf@bush.kubism.ku.dk>

Just curious. Current logic in both R and Splus has

> (1:3)[c(T,F,NA)]
[1]  1 NA

Does anyone know *why*? It makes sense for integer indexing, but for
logicals it seems to have some strange consequences - if you divide a
dataframe according to some criterion, you get as many NA-filled
records as there are missing values of the criterion added to *both*
the group that satisfies the criterion and to those that do not.

One reason could be that since NA is logical by default, you would be
getting awkward consequences of the type x[NA] == real(0), but
x[c(NA,1)] == c(NA,5.3), but why is NA logical by default, then? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep 22 17:04:02 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 22 Sep 1997 09:04:02 -0700 (PDT)
Subject: R-alpha: x[NA]
In-Reply-To: <x2raahftb4.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970922085721.1161A-100000@troi>

On 22 Sep 1997, Peter Dalgaard BSA wrote:

> Just curious. Current logic in both R and Splus has
> 
> > (1:3)[c(T,F,NA)]
> [1]  1 NA
> 
<snip>
> One reason could be that since NA is logical by default, you would be
> getting awkward consequences of the type x[NA] == real(0), but
> x[c(NA,1)] == c(NA,5.3), but why is NA logical by default, then? 

The alternative would be worse.  If one element of the index is not
logical then the whole index is converted, so
R> x<-1:4 
R> x[c(F,T,F,T)]
[1] 2 4
R> x[c(F,T,F,NA)]
[1]  2 NA
but
R> x[c(F,T,F,4)]
[1] 1 4

That is, the presence of any NA would result in selecting only element
as.numeric(T)==1.

BTW, while you obviously can't mix logical and numerical references I
think it's unfortunate that you can't mix numeric and name-based
references like
R> names(x)<-letters[1:4]
R> x
a b c d 
1 2 3 4 
R> x[c("a",2)]
Error: subscript out of bounds

If you want a real example, suppose you had a model frame from which you
wanted to extract the response (in position 1) and the variables whose
names were in a vector nn
	mf[,c(1,nn)] 
appears to be the obvious solution.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ammann@utdallas.edu  Mon Sep 22 18:16:03 1997
From: ammann@utdallas.edu (Larry P Ammann)
Date: Mon, 22 Sep 1997 12:16:03 -0500 (CDT)
Subject: R-alpha: mtext
Message-ID: <199709221716.MAA13611@utdallas.edu>

Something seems to have broken mtext between the R-0.50-a1 and R-0.50-a4
releases. It prints OK when side=2 or 4, but does not print if side=1 or 3.
Try for example:

plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
for(s in 1:10) {
    mtext(paste("mtext(..,side=1, line=",-s,")"), side=1, line=-s)
    mtext(paste("mtext(..,side=2, line=",-s,")"), side=2, line=-s)
    mtext(paste("mtext(..,side=3, line=",-s,")"), side=3, line=-s)
    mtext(paste("mtext(..,side=4, line=",-s,")"), side=4, line=-s)
}

Larry P. Ammann
Professor of Statistics
University of Texas at Dallas
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 22 22:38:38 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 23 Sep 1997 09:38:38 +1200 (NZST)
Subject: R-alpha: mtext
Message-ID: <199709222138.JAA15965@stat1.stat.auckland.ac.nz>

Larry P Ammann <ammann@utdallas.edu> writes:

> Something seems to have broken mtext between the R-0.50-a1 and R-0.50-a4
> releases. It prints OK when side=2 or 4, but does not print if side=1 or 3.
> Try for example:

> plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
> for(s in 1:10) {
>     mtext(paste("mtext(..,side=1, line=",-s,")"), side=1, line=-s)
>     mtext(paste("mtext(..,side=2, line=",-s,")"), side=2, line=-s)
>     mtext(paste("mtext(..,side=3, line=",-s,")"), side=3, line=-s)
>     mtext(paste("mtext(..,side=4, line=",-s,")"), side=4, line=-s)
> }


Ahhh.  It looks like I need to change my test example from plot(1:10)
to plot(rnorm(10)) ...

Here is the fix:  In src/main/plot.c at about line 1180, you will
find the lines:

	if(!FINITE(at)) {
		switch(side % 2) {
		case 0:
			at = (1 - adjx) * GP->usr[0] + adjx * GP->usr[1];
			break;
		case 1:
			at = (1 - adjx) * GP->usr[2] + adjx * GP->usr[3];
			break;
		}
	}

the bodies of the cases need to be swapped.  I.e. it should read

	if(!FINITE(at)) {
		switch(side % 2) {
		case 0:
			at = (1 - adjx) * GP->usr[2] + adjx * GP->usr[3];
			break;
		case 1:
			at = (1 - adjx) * GP->usr[0] + adjx * GP->usr[1];
			break;
		}
	}

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 22 23:02:03 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Sep 1997 00:02:03 +0200
Subject: R-alpha: x[NA]
In-Reply-To: Thomas Lumley's message of Mon, 22 Sep 1997 09:04:02 -0700 (PDT)
References: <Pine.SUN.3.95.970922085721.1161A-100000@troi>
Message-ID: <x2wwk9j9d0.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> That is, the presence of any NA would result in selecting only element
> as.numeric(T)==1.

Aha... Of course that only applies when you enter logical vectors
using c(...), if they result from a comparison, then the type would be
logical NA anyway. So the problem is that c(...) converts to numeric
if just one element is.numeric() even if that element is NA. Hmm. I
suppose that could be handled differently by having c() explicitly
ignoring NA when deciding on type, but that probably leads to more
problems elsewhere?

> BTW, while you obviously can't mix logical and numerical references I
> think it's unfortunate that you can't mix numeric and name-based
> references like
> R> names(x)<-letters[1:4]
> R> x
> a b c d 
> 1 2 3 4 
> R> x[c("a",2)]
> Error: subscript out of bounds
> 
> If you want a real example, suppose you had a model frame from which you
> wanted to extract the response (in position 1) and the variables whose
> names were in a vector nn
> 	mf[,c(1,nn)] 
> appears to be the obvious solution.

I think that the possibility of setting names(x)<-4:1 will demonstrate
why that can't work... Besides, can you be sure that the dependent
variable is the first one in a model frame any more?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep 22 23:08:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 22 Sep 1997 15:08:54 -0700 (PDT)
Subject: R-alpha: x[NA]
In-Reply-To: <x2wwk9j9d0.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970922150648.2314B-100000@troi>

On 23 Sep 1997, Peter Dalgaard BSA wrote:

> 
> > BTW, while you obviously can't mix logical and numerical references I
> > think it's unfortunate that you can't mix numeric and name-based
> > references like
> > R> names(x)<-letters[1:4]
> > R> x
> > a b c d 
> > 1 2 3 4 
> > R> x[c("a",2)]
> > Error: subscript out of bounds
<snip> 
> I think that the possibility of setting names(x)<-4:1 will demonstrate
> why that can't work... Besides, can you be sure that the dependent
> variable is the first one in a model frame any more?
> 
Why?
R> x<-1:4
R> names(x)<-4:1
R> x[1]
4 
1 
R> x["1"]
1 
4 
So why not x[c(1,"1")] giving 1,4?


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Sep 23 10:13:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Sep 1997 11:13:23 +0200
Subject: R-alpha: x[NA]
In-Reply-To: Thomas Lumley's message of Mon, 22 Sep 1997 15:08:54 -0700 (PDT)
References: <Pine.SUN.3.95.970922150648.2314B-100000@troi>
Message-ID: <x2souwl7f0.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> On 23 Sep 1997, Peter Dalgaard BSA wrote:

> > I think that the possibility of setting names(x)<-4:1 will demonstrate
> > why that can't work... Besides, can you be sure that the dependent
> > variable is the first one in a model frame any more?
> > 
> Why?
> R> x<-1:4
> R> names(x)<-4:1
> R> x[1]
> 4 
> 1 
> R> x["1"]
> 1 
> 4 
> So why not x[c(1,"1")] giving 1,4?

Because 

> c(1,"1")
[1] "1" "1"

so we'd have to introduce mixed-type vectors first. However, I suppose
that one might make

> x[list(1,"1")]

work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Sep 23 14:33:07 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 23 Sep 1997 09:33:07 -0400
Subject: R-alpha: read.dbf
References: <6ren6men84.fsf@franz.stat.wisc.edu>
 <199709181452.QAA19001@sophie.ethz.ch> <199709221137.NAA18680@aragorn.ci.tuwien.ac.at>
Message-ID: <97Sep23.093520edt.26501@mailgate.bank-banque-canada.ca>

...
>applied to e.g. reading in xbase files using a (still unwritten) pseudo

>method read.dbf which would be called if the generic read figures out
...

If you're going to get into reading databases let me know. I've already
done a fair amount of work on this and have a working interface to Fame
time series databases (and any other database which can be made to
support a generic protocol I've been working on).

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Wed Sep 24 15:27:38 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 24 Sep 1997 10:27:38 -0400
Subject: R-alpha: Re: read.dbf
References: <6ren6men84.fsf@franz.stat.wisc.edu> <199709181452.QAA19001@sophie.ethz.ch> <199709221137.NAA18680@aragorn.ci.tuwien.ac.at> <97Sep23.093622edt.26510@mailgate.bank-banque-canada.ca> <199709241131.NAA06833@aragorn.ci.tuwien.ac.at>
Message-ID: <97Sep24.103023edt.26510@mailgate.bank-banque-canada.ca>

>> If you're going to get into reading databases let me know. I've
already
>> done a fair amount of work on this and have a working interface to
Fame
>> time series databases (and any other database which can be made to
>> support a generic protocol I've been working on).

>I probably won't have any time for this is the near future, but perhaps

>someone else will fill in ...
>Anyway, if there is more info about the `generic protocol' you
mentioned
>that you can easily make available, the please do so.

Kurt

There is a fair amount of information and example code available at
http://www.bank-banque-canada.ca/pgilbert
Follow the link to TSPADI.

There is a working server front end for the Fame time series database
software as well as a very simplistic file based "database" we made for
test purposes. There is also a client side interface for Splus and for a
"generic client" which is intended as an example and also for test
purposes. The version of the code on the web page needs a few minor
changes for R. I have done that and will soon make it available.

Please note that this is not a database protocol like SQL which allows
queries. The client must provide an identifier for an object and the
server simply returns the object.

The protocol uses RPC and has only been tested on TCP/IP  networks,
although I've been told RPC is available with some other networks. It
does work across the Internet. (It can also be run locally without a
network using loopback.)

An interesting project would be to write a wrapper (eg. in Perl) for
some of the data being provided as text formatted pages. Then a server
could be setup to provide the data with the PADI protocol so that it
could be used directly by application programs like R.  If anyone has
some bright student looking for something to do I can provide more
details.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 24 23:16:06 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 24 Sep 1997 17:16:06 -0500 (CDT)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) in 0.50a4
Message-ID: <m0xDzj4-000hrZC@franz.stat.wisc.edu>

To use Ron Ziegler's famous phrase, that argument is "no longer
operative".  The code for the bxp function, which is what is called to
actually do the plotting, has a section

  if (!is.null(width)) {
    if (length(width) != n | any(is.na(width)) | 
	any(width <= 0)) 
      stop("invalid boxplot widths")
    width <- 0.8 * width/max(width)
  }
  else if (varwidth) {
    width <- 0.8 * sqrt(z[[i]]$n/nmax)
  }
  if (n == 1) 
    width <- 0.4
  else width <- rep(0.8, n)

The effect of either an explicit "width" argument or a TRUE "varwidth"
argument is being overridden in the next statement.

Since the default value of "width" is NULL, I think this can be
repaired by replacing the last three lines shown there by

  if (is.null(width)) {
    if (n == 1)
      width <- 0.4
    else width <- rep(0.8, n)
  }

P.S. For those of you who don't know who Ron Ziegler was (which means
you are too young to remember Watergate), he was Richard Nixon's press
secretary.  When it was shown that a statement he had made to the
press the previous day was an outright lie he responded, "That
statement is no longer operative.".
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 24 23:33:07 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 24 Sep 1997 17:33:07 -0500 (CDT)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) - Take 2
Message-ID: <m0xDzzX-000hrZC@franz.stat.wisc.edu>

This piece of code may do a better job in bxp
  if (!is.null(width)) {
    if (length(width) != n | any(is.na(width)) | 
	any(width <= 0)) 
      stop("invalid boxplot widths")
    width <- 0.8 * width/max(width)
  }
  else if (varwidth) {
    width <- 0.8 * sqrt(unlist(lapply(z, "[[", "n"))/nmax)
  }
  else if (n == 1) {
      width <- 0.4
    }
  else width <- rep(0.8, n)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep 25 00:29:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 25 Sep 1997 11:29:35 +1200 (NZST)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) - Take 2
In-Reply-To: <m0xDzzX-000hrZC@franz.stat.wisc.edu>
References: <m0xDzzX-000hrZC@franz.stat.wisc.edu>
Message-ID: <199709242329.LAA21346@stat1.stat.auckland.ac.nz>

Douglas Bates writes:
 > This piece of code may do a better job in bxp

I have just committed both changes :-)
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Sep  1 14:12:51 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 1 Sep 1997 15:12:51 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
Message-ID: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>


--xk+LtGr+JJ
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Attached is a conversion script for converting current R doc files to
the proposed new format ... I'm not sure if it handles everything
correctly, as I made just some random checks. The main purpose for
posting the thing to the list is such that those interested can get a
look at the new format.

Of course there is no proper indentation ... so the generated files
look really ugly ...

The script can't handle nested math environments with 2 arguments
(like sub, sup, ...), but in the whole base library (580+ files) there
are only 6 containing those, so I thought it's easier to convert these
manually.


--xk+LtGr+JJ
Content-Type: text/enriched
Content-Disposition: inline;
	filename="convert.pl"
Content-Transfer-Encoding: 7bit

#!/usr/bin/perl

use Getopt::Long;

@knownoptions = ("debug|d");
GetOptions (@knownoptions) || die("Unknown Option!\n");

$max_parent = 0;
$NP = "normal_parent";
$PN = "parent_normal";
$EOP = "escaped_opening_parent";
$ECP = "escaped_closing_parent";
$ID = "$NP\\d+$PN";

undef $/;

$complete_text = <>;

print stderr "Marking Parantheses ... " if $opt_debug;

$text = mark_parents($complete_text);

print stderr "done\n" if $opt_debug;

print stderr "Searching logical blocks ... " if $opt_debug;

$text =~ /TITLE($ID)/;
$id = $1;
@args = get_two_args($id);
$text =~ s/TITLE$id(.*)$id/\\title\{$args[0]\}\{$args[1]\}/s;
$title = $args[0];

replace_command("USAGE", "usage");
replace_command("ARGUMENTS", "arguments");
replace_command("DESCRIPTION", "description");

if(($text =~ /VALUE$ID/) && ($text =~ /VALUES$ID/)){
    print stderr "Warning: Both VALUE and VALUES environment found!\n";
}
replace_command("VALUE", "value");
replace_command("VALUES", "value");

replace_command("REFERENCES", "references");
replace_command("SEEALSO", "seealso");
replace_command("EXAMPLES", "examples");
replace_command("NOTES", "notes");

replace_command_all("ALIAS", "alias");
replace_command_all("KEYWORD", "keyword");

while($text =~ /SECTION($ID)/){
    $id = $1;
    @args = get_two_args($id);
    if($args[0] =~ /author/i){
	$text =~ s/SECTION$id(.*)$id/\\author\{$args[1]\}/s;
    }
    else {
	$text =~ s/SECTION$id(.*)$id/\\section\{$args[0]\}\{$args[1]\}/s;
    }
}

print stderr "done\n" if $opt_debug;

print stderr "Parsing text commands ... " if $opt_debug;

$text =~ s/(\s*PARA\s*)+/\n\n/sg;
$text =~ s/(\s*BLANK\s*)+/\n\\blank\n/sg;


while($text =~ /ARG($ID)/){
    $id = $1;
    @args = get_two_args($id);
    $text =~ s/ARG$id(.*)$id/\\item\{$args[0]\}\{$args[1]\}/s;
}

replace_command_all("LANG", "code");
replace_command_all("BOLD", "textbf");
replace_command_all("EQBOLD", "mathbf");
replace_command_all("ITALIC", "emph");

replace_command_all("LINK", "link");

$text =~ s/LDOTS/\\ldots/g;
$text =~ s/DOTS/\\dots/g;


$text =~ s/%/\\%/sg;
$text =~ s/\$/\\\$/sg;

while($text =~ /COMMENT($ID)/){
    $id = $1;
    $text =~ s/COMMENT$id(.*)$id(\n?\s*)/I_FOUND_A_COMMENT/s;
    $comment = " % $1";
    $comment =~ s/\n/\n% /g;
    $comment = "$comment\n" unless ($comment =~ /\n\s*$/s);
    $text =~ s/I_FOUND_A_COMMENT/$comment/;
}

print stderr "done\n" if $opt_debug;
print stderr "Parsing math commands ... " if $opt_debug;



# Now for the math stuff ...

print stderr "args: 0 " if $opt_debug;

$text =~ s/(\s+)EQUALS(\s+)/$1=$2/sg;
$text =~ s/(\s+)LT(\s+)/$1<$2/sg;
$text =~ s/(\s+)GT(\s+)/$1>$2/sg;
$text =~ s/(\s+)LE(\s+)/$1\\le$2/sg;
$text =~ s/(\s+)GE(\s+)/$1\\ge$2/sg;
$text =~ s/(\s+)LOG(\s+)/$1\\log$2/sg;
$text =~ s/(\s+)EXP(\s+)/$1\\exp$2/sg;
$text =~ s/(\s+)SP(\s+)/$1~$2/sg;

$text =~ s/greekGamma/\\gamma/sg;
$text =~ s/greekalpha/\\alpha/sg;
$text =~ s/greekpi/\\pi/sg;
$text =~ s/greekmu/\\mu/sg;
$text =~ s/greeksigma/\\sigma/sg;
$text =~ s/greeklambda/\\lambda/sg;
$text =~ s/boldgreekbeta/\\mathbf\{\\beta\}/sg;
$text =~ s/boldgreekepsilon/\\mathbf\{\\epsilon\}/sg;

print stderr "1 " if $opt_debug;

replace_command_all("SQRT", "sqrt");
replace_command_all("DISPLAYSTYLE", "displaystyle");

while($text =~ /PAREN($ID)/){
    $id = $1;
    $text =~ s/PAREN$id(.*)$id/\\left($1\\right)/s;
}

print stderr "2 ... " if $opt_debug;

while(($text =~ /(SUP)($ID)/) ||
      ($text =~ /(SUB)($ID)/) ||
      ($text =~ /(OVER)($ID)/) ||
      ($text =~ /(CHOOSE)($ID)/)){
    
    my $cmd = $1;
    my $id = $2;
    
    if($text =~ /$id(.*@@.*@@.*)$id/s){
	die("\n$title: Nested math structures - convert equations manually!\n");
    }
    else{
	
	if($cmd =~ /OVER/){
	    @args = get_two_args($id);
	    $text =~ s/OVER$id(.*)$id/\\frac\{$args[0]\}\{$args[1]\}/s;
	}
	
	if($cmd =~ /SUP/){
	    @args = get_two_args($id);
	    $text =~ s/SUP$id(.*)$id/\{$args[0]\}^\{$args[1]\}/s;
	}
	
	if($cmd =~ /SUB/){
	    @args = get_two_args($id);
	    $text =~ s/SUB$id(.*)$id/\{$args[0]\}_\{$args[1]\}/s;
	}
	
	if($cmd =~ /CHOOSE/){
	    @args = get_two_args($id);
	    $text =~ s/CHOOSE$id(.*)$id/\{$args[0] \\choose $args[1]\}/s;
	    }
    }
}


print stderr "deqn ... " if $opt_debug;

while(($text =~ /DEQN($ID)/)){
    $id = $1;
    @args = get_two_args($id);
    $text =~ s/DEQN$id(.*)$id/\\deqn\{$args[0]\}\{$args[1]\}/s;
}

print stderr "eqn ... " if $opt_debug;

replace_command_all("EQN", "eqn");

print stderr "done\n" if $opt_debug;

print stderr "Unmarking parantheses ... " if $opt_debug;

$text = unmark_parents($text);

print stderr "done\n" if $opt_debug;

print $text;





# Mark each matching opening and closing parenthesis with a unique id.
# Idea and original code from latex2html
sub mark_parents {
    my $text = $_[0];
    $text =~ s/([^\\])\\\(/$1$EOP/gso;
    $text =~ s/([^\\])\\\)/$1$ECP/gso;
    
    while($text =~ /\(([^\(\)]*)\)/s){
	my $id = $NP . ++$max_parent . $PN;
	$text =~ s/\(([^\(\)]*)\)/$id$1$id/s;
    }
    $text =~ s/$EOP/\\(/gso;
    $text =~ s/$ECP/\\(/gso;
    
    $text;
}

sub unmark_parents {
    my $text = $_[0];

    while($text =~ /($NP\d+$PN)/s){
	$id = $1;
	$text =~ s/$id(.*)$id/($1)/s;
    }
    $text;
}


sub get_two_args {

    my $id = $_[0];
    
    $text =~ /$id(.*)$id/s;
    my $x = $1;
    $x =~ /\s*([^@]*)\s*@@\s*(.*)\s*/s;

    $arg1 = $1;
    $arg2 = $2;
    
    $arg1 =~ s/^\s*//s;
    $arg1 =~ s/\s*$//s;
    $arg2 =~ s/^\s*//s;
    $arg2 =~ s/\s*$//s;

    ($arg1, $arg2);
}
	

sub replace_command {

    my $cmd = $_[0];
    my $newcmd = $_[1];

    if($text =~ /$cmd($ID)/s){
	my $id = $1;
	$text =~ s/$cmd$id(.*)$id/\\$newcmd\{$1\}/s;
    }
}

sub replace_command_all {

    my $cmd = $_[0];
    my $newcmd = $_[1];

    while(($text =~ /$cmd$ID/)){
	replace_command($cmd, $newcmd);
    }
	
}


    

--xk+LtGr+JJ
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Best,
Fritz



--xk+LtGr+JJ--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep  1 16:28:08 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1997 17:28:08 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
In-Reply-To: Friedrich Leisch's message of Mon, 1 Sep 1997 15:12:51 +0200
References: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>
Message-ID: <x2oh6df3zr.fsf@bush.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> Attached is a conversion script for converting current R doc files to
> the proposed new format ... I'm not sure if it handles everything

Speaking of the docs, we really need to make sure that our HTML pages
pass weblint or similar checkers. I just tried it and found several
pieces of strangeness. Basically, what you get out is stuff like

$ weblint /home/sfe/pd/R/html/funs/density.html
/home/sfe/pd/R/html/funs/density.html(1): <HEAD> must immediately follow <HTML>
/home/sfe/pd/R/html/funs/density.html(1): outer tags should be <HTML> .. </HTML>.
/home/sfe/pd/R/html/funs/density.html(2): empty container element <A>.
/home/sfe/pd/R/html/funs/density.html(90): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(93): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(96): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(99): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(102): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(126): <XMP> is obsolete.
/home/sfe/pd/R/html/funs/density.html(133): unknown element <->.
/home/sfe/pd/R/html/funs/density.html(134): no closing </XMP> seen for <XMP> on line 126.

Here's what I found of obvious pieces of "fluff":

The whole page needs to be inside <HTML>..</HTML>
"<" symbols make trouble, even within <PRE> (use "&lt;")
<XMP> should not be used ("use <PRE>" seems to be the idea)
<TR>'s need to be surrounded by a <TABLE> environment

"<" within <PRE> gets formatted correctly by Netscape, but not by
lynx, so it isn't all just formalities.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep  1 21:01:45 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 1 Sep 1997 13:01:45 -0700 (PDT)
Subject: R-alpha: NCOL, NROW bug
In-Reply-To: <Pine.SUN.3.95.970901120907.10535B-100000@troi>
Message-ID: <Pine.SUN.3.95.970901125854.10535E-100000@troi>


NCOL and NROW don't work correctly on data frames or on arrays of
dimension greater than 2. They treat them as 1-dim vectors.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep  2 08:48:05 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 2 Sep 1997 09:48:05 +0200
Subject: R-alpha: Re: What are objects?
In-Reply-To: <199709011632.SAA18044@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 1 Sep 1997 18:32:33 +0200)
Message-ID: <199709020748.JAA00458@sophie.ethz.ch>

[I do think
  this discussion belongs to  R-devel  rather than anywhere else .. MM]


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Peter Dalgaard BSA writes:

    >> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
    KH>>>  While trying to write documentation for data.class(), I came
    KH>>> across the following in the help for class():
    KH>>> 
    KH>>> An R ``object'' is a data object which has a `class' attribute.
    KH>>> ...  LANG(is.object) returns LANG(TRUE) if its argument has a class
    KH>>> attribute and LANG(FALSE) otherwise.
    KH>>> 
    KH>>> Hmm ... I thought everything was an ``object''.  What is the right
    KH>>> way to refer to ``everything'' then?

    PD>> I agree, this is silly. Did we pick that one up from S, or can we
    PD>> fix it?

    Kurt> I'd say that this is an R&R decision, but I don't think we picked
    Kurt> it up from S.  In S, everything is an object.  Also, S does not
    Kurt> have the R is.object() which in fact is only used once ...

    PD>> Obviously, it makes much more sense to let an entity with no class
    PD>> attribute be an object of the default class. And having to
    PD>> distinguish between "data objects" that are objects and those that
    PD>> aren't is - um - confusing.

    Kurt> Right.

    Kurt> What we might do is distinguish (in terminology) between objects
    Kurt> and ``proper objects'' which are the ones with a class.
or ``class objects''.
Yes I think it's good idea to agree on terminology here.

    Kurt> As (correct me if I am wrong) eventually everything will have a
    Kurt> class (as in S4) everything will eventually be a proper object,
    Kurt> and data.class will be unnecessary.
[I do correct ..]
Hmm, I think that Ross recently said
that  R is NOT moving into the  S4 direction (of fully OO), really,
but rather emphasizes speed and compilation possibilities
	[[unfortunately, I can't find that email in my archives, now...]]

Ross?

    Kurt> Btw, would there be any problems in attaching corresponding class
    Kurt> attributes to at least

    Kurt> 	array matrix list

    Kurt> ???  (Martin, I need your strong YES PLEASE once more ...)  Would
    Kurt> this break anything?  The creator functions could simply attach
    Kurt> the attribs.

I actually have only voted for 'matrix' to be class
 (and 'Matrix' to be another class, inheriting from 'matrix' with just a
  different method for "[").
'array' would be ok, too (and one could think of 'Array' with the analogous
			  "[.Array" method as "[.Matrix")

I'm not so sure about the usefulness of a 'list' class.
Many objects are lists, internally anyway, and I want to access them as
lists sometimes, even if they have an(other) class.

Apropos 'matrix'  (an S / S-plus story) :
-------  ~~~~~~~
In the mean time, I've stumbled about this (again!) in S-plus:

There, 
	as.matrix.dataframe
returns a matrix with a class attribute 'matrix'
but
	as.matrix.default
does NOT
which is really ugly.

I think the 'deep' reason for this is the following:
Current S3 based S-plus still contains code with
	.S(...)
which I think is also known as "old S code".
Anyway, I know that functions using "old S code" are NOT allowed
to get arguments with class (or other "non-standard") attributes.

Therefore, in current S-plus, quite a few (more) things would break if all 
matrices were of class 'matrix'.
And this is probably the only reason why they don't have the class 'matrix'
everywhere.


    Kurt> (Does anyone know exactly what S4 does?)
			    -------
	how do you mean this?
         probably only John Chambers could say 'yes' to this....

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Sep  2 13:19:40 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 2 Sep 1997 14:19:40 +0200
Subject: R-alpha: Re: What are objects?
In-Reply-To: <199709020748.JAA00458@sophie.ethz.ch>
References: <199709011632.SAA18044@aragorn.ci.tuwien.ac.at>
 <199709020748.JAA00458@sophie.ethz.ch>
Message-ID: <199709021219.OAA27859@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> [I do think
>   this discussion belongs to  R-devel  rather than anywhere else .. MM]


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Peter Dalgaard BSA writes:

>>> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
KH> While trying to write documentation for data.class(), I came
KH> across the following in the help for class():
KH> 
KH> An R ``object'' is a data object which has a `class' attribute.
KH> ...  LANG(is.object) returns LANG(TRUE) if its argument has a class
KH> attribute and LANG(FALSE) otherwise.
KH> 
KH> Hmm ... I thought everything was an ``object''.  What is the right
KH> way to refer to ``everything'' then?

PD> I agree, this is silly. Did we pick that one up from S, or can we
PD> fix it?

Kurt> I'd say that this is an R&R decision, but I don't think we picked
Kurt> it up from S.  In S, everything is an object.  Also, S does not
Kurt> have the R is.object() which in fact is only used once ...

PD> Obviously, it makes much more sense to let an entity with no class
PD> attribute be an object of the default class. And having to
PD> distinguish between "data objects" that are objects and those that
PD> aren't is - um - confusing.

Kurt> Right.

Kurt> What we might do is distinguish (in terminology) between objects
Kurt> and ``proper objects'' which are the ones with a class.

> or ``class objects''.
> Yes I think it's good idea to agree on terminology here.

R&R?

Kurt> As (correct me if I am wrong) eventually everything will have a
Kurt> class (as in S4) everything will eventually be a proper object,
Kurt> and data.class will be unnecessary.

> [I do correct ..]
> Hmm, I think that Ross recently said
> that  R is NOT moving into the  S4 direction (of fully OO), really,
> but rather emphasizes speed and compilation possibilities
> 	[[unfortunately, I can't find that email in my archives, now...]]

> Ross?

Yes, that would be good to know ...

Kurt> Btw, would there be any problems in attaching corresponding class
Kurt> attributes to at least

Kurt> array matrix list

Kurt> ???  (Martin, I need your strong YES PLEASE once more ...)  Would
Kurt> this break anything?  The creator functions could simply attach
Kurt> the attribs.

> I actually have only voted for 'matrix' to be class
>  (and 'Matrix' to be another class, inheriting from 'matrix' with just a
>   different method for "[").
> 'array' would be ok, too (and one could think of 'Array' with the analogous
> 			  "[.Array" method as "[.Matrix")

> I'm not so sure about the usefulness of a 'list' class.  Many objects
> are lists, internally anyway, and I want to access them as lists
> sometimes, even if they have an(other) class.

O.k., forget about list.  Let us stay with matrix and array, then.

Kurt> (Does anyone know exactly what S4 does?)
> 			    -------
> 	how do you mean this?
>          probably only John Chambers could say 'yes' to this....

What about the happy pretesters, such as Doug?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Tue Sep  2 19:11:13 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 02 Sep 1997 13:11:13 -0500
Subject: R-alpha: R interaction within ESS-4.9-b11: two small issues
In-Reply-To: Anthony Rossini's message of 02 Sep 1997 10:53:11 -0400
References: <wncwwkzaht4.fsf@fhat.stat.sc.edu>
Message-ID: <6rrab760xq.fsf@franz.stat.wisc.edu>

1) I installed the latest ESS (Emacs Speaks Statistics) beta release
on a machine running Linux.  Since there is no S-PLUS product for
Linux, I set the ess-site.el file for R, xlisp-stat, and S version 4.
I.e.,
 ;; (1.5) Require the needed dialects for your setup.

 ;;(require 'essd-s+3)
 (require 'essd-r)
 (require 'essd-xls)
 ;;(require 'essd-sas)
 ;;(require 'essd-s3)  ;; You might not have this
 (require 'essd-s4)  ;; or this one...

That does not seem to work.  I believe that under the present
structure you must require essd-s+3 to get definitions of some
functions used by the other dialects.  Perhaps that dependency could
be removed at some time.

2) I think the current definitions
essd-r.el:61:    (ess-retr-lastvalue-command    . ".Last.value <- get(\"smode.lvsave\",envir=1)\n")
essd-r.el:62:    (ess-save-lastvalue-command    . "assign(\"smode.lvsave\",.Last.value,envir=1)\n")
may be misusing the "envir" argument.  I am getting messages in the
interaction window like
 > Error in get(x, envir, mode, inherits) : variable "smode.lvsave" was not found
If I try to use assign with envir = 1 at the top level I get an error message
 > assign("smode.lvsave", 12, envir = 1)
 Error: invalid envir argument

I haven't gone into debugging of the ESS code to find out if this what
is causing the problem.

Should the assign and get use "inherits = TRUE" instead of "envir=1"?
The R documentation is a bit vague about the use of the envir argument.

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Tue Sep  2 20:39:10 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 02 Sep 1997 15:39:10 -0400
Subject: R-alpha: R interaction within ESS-4.9-b11: two small issues
In-Reply-To: Douglas Bates's message of "02 Sep 1997 13:11:13 -0500"
References: <wncwwkzaht4.fsf@fhat.stat.sc.edu> <6rrab760xq.fsf@franz.stat.wisc.edu>
Message-ID: <wncrab7a4kh.fsf@fhat.stat.sc.edu>


>>>>> "Douglas" == Douglas Bates <bates@stat.wisc.edu> writes:

    Douglas> 1) I installed the latest ESS (Emacs Speaks Statistics)
    Douglas>    beta release
    Douglas> on a machine running Linux.  Since there is no S-PLUS product for
    Douglas> Linux, I set the ess-site.el file for R, xlisp-stat, and S version 4.
    Douglas> I.e.,
    Douglas>  ;; (1.5) Require the needed dialects for your setup.

    Douglas>  ;;(require 'essd-s+3)
    Douglas>  (require 'essd-r)
    Douglas>  (require 'essd-xls)
    Douglas>  ;;(require 'essd-sas)
    Douglas>  ;;(require 'essd-s3)  ;; You might not have this
    Douglas>  (require 'essd-s4)  ;; or this one...

    Douglas> That does not seem to work.  I believe that under the
    Douglas> present structure you must require essd-s+3 to get
    Douglas> definitions of some functions used by the other dialects.
    Douglas> Perhaps that dependency could be removed at some time.

I just did.  Sorry (changed for beta-12, to release Friday).  I've
moved the basic formatting into essl-s.el (ESS, Languages in the S
family), which is required by essd-s3, essd-s4, essd-s+3,essd-s+3...

    Douglas> 2) I think the current definitions

    Douglas> essd-r.el:61:    (ess-retr-lastvalue-command
    Douglas> . ".Last.value <- get(\"smode.lvsave\",envir=1)\n") 
    Douglas> essd-r.el:62:    (ess-save-lastvalue-command
    Douglas> . "assign(\"smode.lvsave\",.Last.value,envir=1)\n") 

    Douglas> may be misusing the "envir" argument.  I am getting
    Douglas> messages in the interaction window like

    >> Error in get(x, envir, mode, inherits) : variable
    >> "smode.lvsave" was not found 

    Douglas> If I try to use assign with envir = 1 at the top level I
    Douglas> get an error message

    >> assign("smode.lvsave", 12, envir = 1)

    Douglas>  Error: invalid envir argument

    Douglas> I haven't gone into debugging of the ESS code to find out
    Douglas> if this what is causing the problem.

    Douglas> Should the assign and get use "inherits = TRUE" instead
    Douglas> of "envir=1"?  The R documentation is a bit vague about
    Douglas> the use of the envir argument.

This is a bit more important.  I've not yet found an acceptable work
around (well, Kurt H. said he could provide a hacked solution soon).

I'm still hunting for suggestions...

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep  3 17:13:16 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 3 Sep 1997 18:13:16 +0200
Subject: R-alpha: speed of  sort(.) and order(.)
Message-ID: <199709031613.SAA01385@sophie.ethz.ch>

sort() and order() are not quite the same, as "one knows":

 o  order allows breaking ties by more than one argument;
 o  sort  allows a 'partial' and 'na.last' argument

Still, the following timing (on a `simple' UltraSparc I)
suggest that actually two different algorithms are used

> N <- 10000
> typeof(x0 <- 1:N) # --- x0 : already sorted ---
[1] "integer"
> typeof(x  <- sample(N))
[1] "integer"
> CPU <- numeric(10)

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) sort(x0))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.070   1.080   1.080   1.137   1.217   1.240 

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) order(x0))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.900   1.000   1.035   1.012   1.047   1.070 

'order' is slightly faster for an already sorted vector
	(this seems consistent for further examples, 
	  not statistically significant for these 10..)


> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) sort(x))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.700   1.720   1.735   1.765   1.827   1.870 

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) order(x))[1]
> summary(CPU)
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  3.000   3.100   3.140   3.181   3.227   3.540 
>

which makes 'sort' almost a factor of 2  FASTER for an unsorted 'x'.

Any comments from the coders  (R & R) ?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep  3 23:26:46 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 4 Sep 1997 10:26:46 +1200 (NZST)
Subject: R-alpha: speed of  sort(.) and order(.)
In-Reply-To: <199709031613.SAA01385@sophie.ethz.ch>
References: <199709031613.SAA01385@sophie.ethz.ch>
Message-ID: <199709032226.KAA22616@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
[ stuff on sorting  which I leave out ]

 > which makes 'sort' almost a factor of 2  FASTER for an unsorted 'x'.
 > 
 > Any comments from the coders  (R & R) ?

I wasn't there, I hardly knew the woman and anyway it wasn't my dog :-).

Well, I didn't look closely at the code, but as I recall both "sort"
and "order" use a shellsort recomended by Sedgewick (he says only
true sorting gurus like him should attempt quicksort and that mortals
like me should stick with shellsort).

It does look odd.  When I get a moment I will dig deeper.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Sep  4 09:52:24 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 4 Sep 1997 10:52:24 +0200
Subject: R-alpha: inconsistency R/Splus of sample()
Message-ID: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>


The function sample has different behaviour under R and Splus when
called with zero sample size:

R> x<-rnorm(10)
R> sample(x,0)
Error in sample(length(x), size, replace) : invalid second argument

Splus> x<-rnorm(10)
Splus> sample(x,0)
numeric(0)


IMO the Splus behaviour makes more sense, because it returns the
requested `sample' of size 0.

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep  4 21:39:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 5 Sep 1997 08:39:05 +1200 (NZST)
Subject: R-alpha: Sorting Efficiency
Message-ID: <199709042039.IAA12844@stat1.stat.auckland.ac.nz>

As part of checking Martin Maechler's observations of sorting
efficiency I have been putting the code under the microscope.  Part of
this involved comparing the performance with Splus. I turns out that
the R code is much slower.  A good deal of this is due to the
interpreted front end to the R verion of sort.  It is worth taking
a look at the sort function and seeing if you can see what the
problem is.  (hint: turn on GC reporting with "gcinfo").

A good deal of the rest of the inefficiency is because the internal R
code attempts to deal with missing observations.  This is no longer
needed because this is dealt with in the interpreted front end.

An overall fix of the code should see us nearly match the performance
of Splus.  I say nearly because I think I will use heapsort instead of
quicksort because I want to avoid worst-case performance rather than
seek good average performance.

I don't yet have an explanation of the behavior which Martin uncovered.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep  4 23:44:51 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 5 Sep 1997 10:44:51 +1200 (NZST)
Subject: R-alpha: inconsistency R/Splus of sample()
In-Reply-To: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>
References: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>
Message-ID: <199709042244.KAA18311@stat1.stat.auckland.ac.nz>

Friedrich Leisch writes:
 > 
 > The function sample has different behaviour under R and Splus when
 > called with zero sample size:
 > 
 > R> x<-rnorm(10)
 > R> sample(x,0)
 > Error in sample(length(x), size, replace) : invalid second argument
 > 
 > Splus> x<-rnorm(10)
 > Splus> sample(x,0)
 > numeric(0)
 > 
 > 
 > IMO the Splus behaviour makes more sense, because it returns the
 > requested `sample' of size 0.

Done.  (A one character change).
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep  5 09:32:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Sep 1997 10:32:32 +0200
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: <199709042039.IAA12844@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 5 Sep 1997 08:39:05 +1200 (NZST))
Message-ID: <199709050832.KAA04356@sophie.ethz.ch>

Since you are delving into the code anyway....
Here is a thought that I have been having for a long time:

Wouldn't it make sense / be useful  to have a function 	is.sorted
which returns TRUE   if  all(diff(x) >= 0).	        ---------

I actually have been using the function

	is.sorted <- function(x) (length(x) <= 1) || all(diff(x) >= 0)

in my collection of S-plus enhancements for quite while now.

I can do things as

	if(!is.sorted(x)) {
		o <- order(x)
		x <- x[o]
		y <- y[o]
	}
		
which potentially saves computing time (over unconditional 'order'),
since
1.	        is.sorted  is  O(n)
    whereas	sort       is  O(n*log(n)) 
2. for sorted x, the two assignments are superfluous even when order(x) was
   very fast (for SORTED x). 

TO be CPU-efficient, is.sorted  probably should be written .Internal(.).

On the other hand,  sort(.) and order(.)  could be designed such that they
use a sorting algorithm which guarantees to be fast when things are already
sorted. [maybe this is already the case,
	 and one of your reasons against quicksort? ]
This would make the 'if(..)' in  
	if(!is.sorted(x)) x <- sort(x)
superfluous, but the situation with order(.) above
(which is NOT infrequent in statistics !!) would still profit from not
doing  'x <- x[1:length(x)]' when x is sorted.

--
Opinions?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 15:48:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 16:48:24 +0200
Subject: R-alpha: GLM (from R-core)
Message-ID: <x2bu27vmtj.fsf@bush.kubism.ku.dk>

As some of you may know, there has been formed a "core team" of
developers, who can dig directly into the R source at Auckland and fix
bugs etc., in order to speed up development. There is a mailing list
for that group. This is necessary, because some of the bugs discussed
are not publicly available (and hopefully will never be!), but one
potential risk of the structure is that we forget about R-devel. One
recent case was this:

I discovered that summary.glm was calculating "t" statistics (est./SE)
correctly in the case were the dispersion parameter of the GLM is
fixed, but referring it to a t distribution with the residual DF. This
is wrong, badly so in the case of tabular data.

This is just a bug, but then Thomas Lumley added:

"We should also allow the df to be specified as an argument to
summary.glm(). The gaussian case is the only one where there is a real
honest t-distribution and in other cases the user should be free to use
other values of the df that might improve the approximation.  This is
particularly true when the user specifies the dispersion, as then we have
no idea what df is appropriate."

That kind of topic is about "policy" as opposed to bugfixing and
codewriting, and - as Martin Maechler pointed out - there are people
on R-devel who have broad experience in GLMs and may want to
contribute to the discussion. 

Also other things with GLMs are debatable, e.g. whether it is always
correct to use the weighted RSS and not the deviance for the
dispersion estimate.

(The fixed-dispersion bug is fixed in the current sources, using the
simple logic that if the dispersion in not estimated from the RSS, we
use the normal distribution (or "infinite df" if you like))


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 16:02:10 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 17:02:10 +0200
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: Martin Maechler's message of Fri, 5 Sep 1997 10:32:32 +0200
References: <199709050832.KAA04356@sophie.ethz.ch>
Message-ID: <x2afhrvm6l.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> since
> 1.	        is.sorted  is  O(n)
>     whereas	sort       is  O(n*log(n)) 
> 2. for sorted x, the two assignments are superfluous even when order(x) was
>    very fast (for SORTED x). 

Actually, if it's a Shell sort, it's O(n^1.5) worst case and O(n^1.27)
average. For O(n log n) average you need quicksort or heapsort. The
former has the draw back of O(n^2) worst case, but heapsort has quite
a good reputation and is unconditionally n log n (that info comes from
Numerical Recipes, which was the best could dig out at the moment).
Maybe we should switch?

> superfluous, but the situation with order(.) above
> (which is NOT infrequent in statistics !!) would still profit from not
> doing  'x <- x[1:length(x)]' when x is sorted.

Yes.. Of course the case is often that you *know* that things are
sorted (because you just did it yourself), but modularity prevents you
from getting that information to the spot where it is needed.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 16:04:22 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 17:04:22 +0200
Subject: R-alpha: Sorting Efficiency -- A bit of humour...
In-Reply-To: Martin Maechler's message of Fri, 5 Sep 1997 10:32:32 +0200
References: <199709050832.KAA04356@sophie.ethz.ch>
Message-ID: <x290xbvm2x.fsf@bush.kubism.ku.dk>

Apropos sorting, I stumbled across this one a moment ago:

From: rjd4@cam.ac.uk (Bob Dowling)
Subject: Re: Sorting algorithms (was Re: Whoo hoo)
Newsgroups: alt.sysadmin.recovery
Date: 5 Sep 1997 09:19:21 GMT

This talk of sorting algorithms brings me back to one of my favourite interview
questions, designed to see if the candidate is on the ball.

"Sketch out a program that takes a random permutation of the numbers from 1 to
1000 and prints them in order."

Any mention of sorting algorithms is regarded as a "fail" on this question, of
course.
- - 
Bob Dowling:       UNIX Support, University of Cambridge Computing Service,
rjd4@cam.ac.uk     New Museums Site, Pembroke Street, Cambridge, UK.  CB2 3QG.
+44 1223 334728    http://www-uxsup.csx.cam.ac.uk/
-------- Those who do not learn from Dilbert are doomed to repeat it. --------


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Fri Sep  5 16:06:59 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 05 Sep 1997 11:06:59 -0400
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: Peter Dalgaard BSA's message of "05 Sep 1997 17:02:10 +0200"
References: <199709050832.KAA04356@sophie.ethz.ch> <x2afhrvm6l.fsf@bush.kubism.ku.dk>
Message-ID: <wnchgbzer58.fsf@fhat.stat.sc.edu>



Well, since it seems that number of algorithms have been implemented,
how about keeping them and having a:

	sort( x, algorithm="....")

call?  (I'm only quasi-serious this morning).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Fri Sep  5 16:40:42 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 5 Sep 1997 10:40:42 -0500 (CDT)
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: <x2afhrvm6l.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Sep 5, 97 05:02:10 pm
Message-ID: <9709051540.AA09189@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > since
> > 1.	        is.sorted  is  O(n)
> >     whereas	sort       is  O(n*log(n)) 
> > 2. for sorted x, the two assignments are superfluous even when order(x) was
> >    very fast (for SORTED x). 
> 
> Actually, if it's a Shell sort, it's O(n^1.5) worst case and O(n^1.27)
> average. For O(n log n) average you need quicksort or heapsort. The
> former has the draw back of O(n^2) worst case, but heapsort has quite
> a good reputation and is unconditionally n log n (that info comes from
> Numerical Recipes, which was the best could dig out at the moment).
> Maybe we should switch?
> 

Merge sort is also an option. It is O(n log(n)) worst case but with a
better constant than heapsort, as I recall, and a bit easier to
implement.  Its drawback in general is O(n) additional space needed,
which is prohibitive if you are sorting in place. But since R copies
anyway, that isn't an issue. (Don't name any internal routines
mergesort though -- there are a number of systems that include one in
their libraries and cause name conflicts).

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Sep  5 17:23:36 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 5 Sep 1997 09:23:36 -0700 (PDT)
Subject: R-alpha: sorting in plots
In-Reply-To: <x2afhrvm6l.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970905091611.14804A-100000@troi>


The sorting discussion reminds me of another feature I wanted in lines()
(and in plot.default). 
	lines(x,y,sorted=T)
equivalent to 
	lines(x[order(x)],y[order(x)])
but still giving the correct information to identify()


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Sun Sep  7 16:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 7 Sep 1997 17:23:47 +0200
Subject: R-alpha: R `make install-*'
Message-ID: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at>

Ross mentioned last week that it would be nice to eventually have a real
`make install'.  As a preparation, we should perhaps rename the current

	install-help install-latex install-html

targets to

	help latex [or dvi???] html

and perhaps

	test-Examples

to

	test

I can of course make the changes, but I thought I'd ask for a good new
name for the corresponding scripts in RHOME/etc.  Maybe

	etc/build-help

etc?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Sun Sep  7 16:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 7 Sep 1997 17:23:47 +0200
Subject: R-alpha: naming convention for index files
Message-ID: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at>

In the process of moving to the new directory structure, we might also
reconsider the naming of the various index files.

A simple idea would be to have an `INDEX' file in each directory where
this is appropriate.  E.g., we could have

	pkg/funs/INDEX		(rather than help/pkg/INDEX)
	pkg/data/INDEX		(rather than index.doc)
	pkg/help/INDEX		(rather than AnIndex)

or e.g.

	pkg/INDEX.funs
	pkg/INDEX.data

etc.

The package TITLE files would be used for building the package index of
a library tree (LibIndex?)

In any case, the `plain' indices to be displayed upon calling an
appropriate form of help() could contain MORE than simply a list of
things.  I.e., more like a README.

My idea is (assuming only RHOME is in .lib.loc):

	R> library()

	`RHOME' is the location of the default R library tree.
	Blah blah blah ...

	Packages in `RHOME':

	base		The basic package.
	eda		...
	mva		...

The last lines could be generated from the packages' TITLE files.  The
other info from some stub, perhaps LibIndex.in?

As usual, any feedback is appreciated.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Sep  7 18:25:11 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Sep 1997 19:25:11 +0200
Subject: R-alpha: R `make install-*'
In-Reply-To: Kurt Hornik's message of Sun, 7 Sep 1997 17:23:47 +0200
References: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at>
Message-ID: <x2pvqlf348.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> Ross mentioned last week that it would be nice to eventually have a real
> `make install'.

..speaking of which, we should remember to rename the INSTALL file in
$RHOME. Prevents 'make install' on case-inhibited operating systems
("install is up to date"...!).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Sep  8 14:25:08 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 8 Sep 1997 15:25:08 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
In-Reply-To: <x2oh6df3zr.fsf@bush.kubism.ku.dk>
References: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>
 <x2oh6df3zr.fsf@bush.kubism.ku.dk>
Message-ID: <199709081325.PAA04403@galadriel.ci.tuwien.ac.at>

>>>>> On 01 Sep 1997 17:28:08 +0200,
>>>>> Peter Dalgaard BSA (PDB) wrote:

PDB> Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
>> Attached is a conversion script for converting current R doc files to
>> the proposed new format ... I'm not sure if it handles everything

PDB> Speaking of the docs, we really need to make sure that our HTML pages
PDB> pass weblint or similar checkers. I just tried it and found several
PDB> pieces of strangeness. Basically, what you get out is stuff like

PDB> $ weblint /home/sfe/pd/R/html/funs/density.html
PDB> /home/sfe/pd/R/html/funs/density.html(1): <HEAD> must immediately follow <HTML>
PDB> /home/sfe/pd/R/html/funs/density.html(1): outer tags should be <HTML> .. </HTML>.
PDB> /home/sfe/pd/R/html/funs/density.html(2): empty container element <A>.
PDB> /home/sfe/pd/R/html/funs/density.html(90): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(93): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(96): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(99): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(102): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(126): <XMP> is obsolete.
PDB> /home/sfe/pd/R/html/funs/density.html(133): unknown element <->.
PDB> /home/sfe/pd/R/html/funs/density.html(134): no closing </XMP> seen for <XMP> on line 126.

PDB> Here's what I found of obvious pieces of "fluff":

PDB> The whole page needs to be inside <HTML>..</HTML>
PDB> "<" symbols make trouble, even within <PRE> (use "&lt;")
PDB> <XMP> should not be used ("use <PRE>" seems to be the idea)
PDB> <TR>'s need to be surrounded by a <TABLE> environment

PDB> "<" within <PRE> gets formatted correctly by Netscape, but not by
PDB> lynx, so it isn't all just formalities.

I agree totally that we should stick with the HTML standards.

The new conversion script is almost ready and currently in
`alpha-testing' by Martin and Kurt. I've checked its output with
weblint and on the HTML pages of the whole base library all I get are
only minor warnings:

attach.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
chisquare.test.html(36): empty container element <P>.
detach.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
ls.diag.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
ls.print.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
t.test.html(84): empty container element <P>.


which cannot be avoided without considerable effort or side effects ...
e.g., every browser that cannot handle long tiles will truncate them
anyway, so I see no purpose in doing this myself. But we can include
it as a recommendation that the title of a doc file is no longer than
64 characters (that makes sense anyway for the INDEX files etc.)



best,
fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 15:21:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 16:21:56 +0200
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: <199709042117.JAA16853@stat1.stat.auckland.ac.nz> (message from
 Robert Gentleman on Fri, 5 Sep 1997 09:17:50 +1200 (NZST))
Message-ID: <199709081421.QAA00979@sophie.ethz.ch>

[[yet another discussion brought from  R-core  to  R-devel]]

>>>>> "RG" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

    RG> Peter, there is some code for line types and widths in all the
    RG> drivers. With windows there is the well known limitation that you
    RG> can't have patterened lines with lwd larger than 1 (unless you
    RG> write your own routines ....  I just haven't had time). I do agree
    RG> that there is something very weird going on with our code though!
   
    RG>    I think that in plot(1:4,lwd=2) the lwd should have absolutely
    RG> no effect. I think it's a bug in Splus that it does. For example,
    RG> plot(1:4,col="red")

I agree, and I also have been hating this (Splus) behavior.

I do prefer R's behavior have different 'col', 'cex', 'font' for
axis, labs, and points/lines.

After reading PD's reply to this message, I agree that
"lwd" is somewhat different:
	If your device has too thin lines in general, it is nice if you can
	increase line width  GLOBALLY.
The same for "cex": 
	There are situations where ALL text and plotting characters should
	just be made bigger with the same zoom factor.

Below, you (RG) mention the use of   par(lwd=...)
{and correspondingly would be    par(cex=...)}.

Is this going to be ``the standard'':

	For global changes of  linewidth or character size,
	one must use  par(lwd=..) or  par(cex=..) 
?

    RG>     gives you everything in red; axes, labels, lines and
    RG> points. That's wrong.  In plot(1:4,type="l",lwd=2) lwd should
    RG> affect the width of the line joining the points but not the width
    RG> of the lines for the bounding box (IMHO).

I agree, but again, it might be nice if there was something like a 
"global.lwd".
    
    RG>     I think that if you want to change the line widths on the
    RG> bounding box you should use par(lwd=2) and then all lines are
    RG> changed. This seems to work (but I don't doubt there are bugs; we
    RG> simply have never had the chance to exercise everything).

    RG>     As for character expansion- par cex seems to be the only route
    RG> (which makes me like my suggestion even more).
    
    RG>     Opinions?  It would be easy enough to mimic S but I do think
    RG> it's wrong.

We should not mimic S here, sometimes.
I agree it's wrong in some places.

But if you use a different scheme, it should be
	- well documented
	- very consequently implemented   ==>  easily remembered by users

-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Sep  8 15:36:24 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 8 Sep 1997 10:36:24 -0400 (EDT)
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: <199709081421.QAA00979@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970908103318.15321A-100000@paca>


  I agree with the gist of the discussion here ("par(lwd)" to change lwd
globally, otherwise it just affects lines).  One detail worth thinking
about is that a global linewidth change in PostScript (setlinewidth) will
also affect the linewidths used, e.g., in drawing plotting characters
(which could get very ugly as a result).

  I'm glad to see folks are working on lwd; in my (alpha-2) version of R
linewidth is mostly not implemented, and I was wondering whether I should
dig in and work on it or whether I should wait 'til the prophesied Big
Changes in the graphics code happened and the dust settled ...  (For now,
I've just been hacking the postscript _post facto_.)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep  8 16:27:45 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 8 Sep 1997 11:27:45 -0400
Subject: R-alpha: not mimic S
Message-ID: <97Sep8.112911edt.26517@mailgate.bank-banque-canada.ca>

> We should not mimic S here, sometimes.
> I agree it's wrong in some places.

> But if you use a different scheme, it should be
>         - well documented
>         - very consequently implemented   ==>  easily remembered by
users

One way to deal with improvements which force incompatabilities with S
is to layer the code so that application programmers use a consistent
upper layer which in turn calls lower layers of S or R code. This does
not solve problems with existing code but does give a way for new
applications to be developed for both environments. It may not be
possible to always achieve the same results, especially when
improvements mean some capabilities are not in one system, but it can be
possible to make the application work and just not provide some features
in one environment.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep  8 16:37:20 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 08 Sep 1997 17:37:20 +0200
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: Ben Bolker's message of Mon, 8 Sep 1997 10:36:24 -0400 (EDT)
References: <Pine.SUN.3.95.970908103318.15321A-100000@paca>
Message-ID: <x27mcr24wf.fsf@bush.kubism.ku.dk>

Ben Bolker <ben@eno.Princeton.EDU> writes:

>   I agree with the gist of the discussion here ("par(lwd)" to change lwd
> globally, otherwise it just affects lines).  One detail worth thinking
> about is that a global linewidth change in PostScript (setlinewidth) will
> also affect the linewidths used, e.g., in drawing plotting characters
> (which could get very ugly as a result).

Hm. After seeing the W95 plots on a 600dpi laser, I tend to say that
the above *is* the desired behaviour. The default plotting circles
were hardly visible at all. A global lwd setting should set the
natural (i.e. neither fat nor barely visible) line width for a plot. 
Another question is whether one should set a *relative* width unit
(like SAS's 'goptions lfactor=...'), so that all lines are made
fatter - or thinner.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 16:56:15 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 17:56:15 +0200
Subject: R-alpha: naming convention for index files
In-Reply-To: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Sun, 7 Sep 1997 17:23:47 +0200)
Message-ID: <199709081556.RAA01060@sophie.ethz.ch>


    KH> In the process of moving to the new directory structure, we might also
    KH> reconsider the naming of the various index files.

    KH> A simple idea would be to have an `INDEX' file in each directory where
    KH> this is appropriate.  E.g., we could have

    KH> pkg/funs/INDEX		(rather than help/pkg/INDEX)

but  help/base/INDEX  is autogenerated
where as everything in ./funs/  (or /R/  as you propose later)  is  SOURCE

    KH> pkg/data/INDEX		(rather than index.doc)
index.doc is source

    KH> pkg/help/INDEX		(rather than AnIndex)
this is auto-generated again...

--
in summary, we could well say   INDEX  instead of different names,
but I don't think we should  autogenerate a file in a directory
where there's only source  (other than the 'Makefile'; Lib... files that
			    configure generates, and which are not needed
			    anymore after installation)

Remember: 

	The big idea is still that after

		make install + install-help + ..
			(just after all the installation)

	you should be able to
	REMOVE the full  ./src/  tree and still have a completely 
	working R (including online help, ...).


    KH> or e.g.

    KH> pkg/INDEX.funs
    KH> pkg/INDEX.data

    KH> etc.

    KH> The package TITLE files would be used for building the package index of
    KH> a library tree (LibIndex?)

very good idea

    KH> In any case, the `plain' indices to be displayed upon calling an
    KH> appropriate form of help() could contain MORE than simply a list of
    KH> things.  I.e., more like a README.

    KH> My idea is (assuming only RHOME is in .lib.loc):

    KH> library()

    KH> `RHOME' is the location of the default R library tree.
    KH> Blah blah blah ...

    KH> Packages in `RHOME':

    KH> base		The basic package.
    KH> eda		...
    KH> mva		...

    KH> The last lines could be generated from the packages' TITLE files.  The
    KH> other info from some stub, perhaps LibIndex.in?

very good idea

    KH> As usual, any feedback is appreciated.

as usual, I give you some ... ;-)

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 17:00:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 18:00:01 +0200
Subject: R-alpha: R `make install-*'
In-Reply-To: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Sun, 7 Sep 1997 17:23:47 +0200)
Message-ID: <199709081600.SAA01071@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Ross mentioned last week that it would be nice to eventually have
    Kurt> a real `make install'.  As a preparation, we should perhaps
    Kurt> rename the current

    Kurt> 	install-help install-latex install-html

    Kurt> targets to

    Kurt> 	help latex [or dvi???] html

    Kurt> and perhaps

    Kurt> 	test-Examples
    Kurt> to
    Kurt> 	test
no!
You can make it shorter, but my idea still is that there should be a whole
collection of tests where `running all the help-Examples' is just one of them.

    Kurt> I can of course make the changes, but I thought I'd ask for a good new
    Kurt> name for the corresponding scripts in RHOME/etc.  Maybe

    Kurt> etc/build-help

    Kurt> etc?

yes, this sounds better
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Sep  8 08:48:19 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 08 Sep 1997 09:48:19 +0200 (MET DST)
Subject: R-alpha: Assingment to list or vector elements
Message-ID: <XFMail.970908104926.plummer@iarc.fr>

When you assign a value to an object which exists in some database on
the search list, R creates a copy in the current environment. However,
if the object is a list or vector, and you assign a new value to one of
its elements, a copy is not made and the assignment fails (with no error
message!).  This behaviour is incompatible with S-PLUS, which will make
a copy of the object before modifying one of its elements.

Martyn

> exists("alist", 1, inherits=F)
[1] FALSE
> mydata <- list(alist = list(one=1,two=1))
> attach(mydata)
> alist
$one
[1] 1

$two
[1] 1

> alist$one <- 2
> alist[[2]] <- 3
> alist
$one
[1] 1

$two
[1] 1

> exists("alist", 1, inherits=F)
[1] FALSE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Sep  8 09:52:40 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 08 Sep 1997 10:52:40 +0200 (MET DST)
Subject: R-alpha: deparse bug
Message-ID: <XFMail.970908115419.plummer@iarc.fr>

The deparse function has an argument "width.cutoff" which allows you
to set the width at which line breaking is attempted.  However, setting
this argument _permanently_ changes the line break width.

Looking at the source code ($RHOME/src/main/deparse.c), I see that the
width.cutoff argument sets the static variable "cutoff".  Although the
function do_deparse behaves correctly - overwriting cutoff with the
default value if not given a second argument -  other R functions (such
as print and edit) call deparse1 which doesn't do this. Hence they use
the modified cutoff value.

A quick fix would be to get do_deparse to reset cutoff to the default
value after calling deparse1 but before returning.

Martyn

> #Use function trunc as an example
> #This normally prints on two lines
> trunc
function (x) 
ifelse(x < 0, ceiling(x), floor(x))
> #Now deparse with narrow cutoff
> deparse(trunc,20)
[1] "function (x) "             
[2] "ifelse(x < 0, ceiling(x), "
[3] "        floor(x))"         
> #Cutoff 20 is used next time you print anything
> trunc
function (x) 
ifelse(x < 0, ceiling(x), 
        floor(x))
> #Cutoff is reset to default when you call
> #deparse without width.cutoff argument
> deparse(trunc)
[1] "function (x) "                      
[2] "ifelse(x < 0, ceiling(x), floor(x))"
> #Default cutoff (60) is now used when you print
> trunc
function (x) 
ifelse(x < 0, ceiling(x), floor(x))
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep 10 02:00:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 10 Sep 1997 13:00:42 +1200 (NZST)
Subject: R-alpha: New Version Available
Message-ID: <199709100100.NAA08817@stat1.stat.auckland.ac.nz>

The newest version of R for Unix (version R-0.50-a4) is now (or will
soon be) available from the following sites.

    NORTH AMERICA:
	http://lib.stat.cmu.edu/R/Alpha

    EUROPE:
        ftp://ftp.stat.math.ethz.ch/R/
        ftp://statlab.uni-heidelberg.de/pub/mirrors/auckland/R/

    JAPAN:
        ftp://ftp.u-aizu.ac.jp/pub/lang/R/

    NEW ZEALAND:
        ftp://stat.auckland.ac.nz/pub/R/

Please obtain a copy from site close to you.  Note that New Zealand
is not close to anywhere other than itself :-).

This is a quick snapshot release of the current source tree which is
intended to bring users up to date with the current state of
development.  We are just about embark on some substantial changes
which may take a while to complete, so this seems like a good time to
put out a release.

This is still not the promised "R-0.50 stable", but it is getting closer.

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Sep 10 15:53:58 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 10 Sep 1997 10:53:58 -0400
Subject: R-alpha: New Version Available
In-Reply-To: Ross Ihaka's message of "Wed, 10 Sep 1997 13:00:42 +1200 (NZST)"
References: <199709100100.NAA08817@stat1.stat.auckland.ac.nz>
Message-ID: <wnc7mcpb4op.fsf@fhat.stat.sc.edu>


>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version R-0.50-a4) is now
    Ross> (or will soon be) available from the following sites.

    Ross>     NORTH AMERICA:
    Ross> 	http://lib.stat.cmu.edu/R/Alpha

It's there.

Compiled and seems to run on Solaris 2.5 (SS 20/50).  

Small problem -- in compiling hclust, it couldn't find my f2c.h files,
and bombed.  

My solution -- move f2c.h to the include directory in the unpacked
distribution directory.  (I also moved libf2c.a to the lib directory,
but I don't think it was needed there?).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Sep 10 17:40:15 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Sep 1997 18:40:15 +0200
Subject: R-alpha: hist()
Message-ID: <x2vi096s27.fsf@bush.kubism.ku.dk>


If you try hist(rnorm(100),lwd=2) with a recent snapshot, you get the
exact opposite effect of what was earlier argued to be desirable in
plots: you get fat axes and thin bar outlines. The cause is plain to
see, at the end of 'hist':

        title(main = main, xlab = xlab, ylab = ylab, ...)
        if (axes) {
                axis(1, ...)
                axis(2, ...)
        }
        rect(breaks[-length(breaks)], 0, breaks[-1], counts, 
                col = col, border = border)

The ...'s are doing it, obviously. So the fix would be to remove ...
from axis() and add it to rect().

However, this example is having me worried that it wasn't a good idea
to depart from the S rule of *always* passing graphical parameters to
lower level routines. For instance, I don't think you would want a
font change *not* passed on to title(), would you? Then what *is*
changeable matter in a plot, really?

The thing that I'm afraid of is that it will become a can of worms to
keep track of which parameters are passed on to what routines. Not to
mention the fact that the ... parameter is essentially indivisible: it
is, to say the least, difficult to pass only some of the parameters.

Cc-ed to R-devel. I think we need to discuss this more broadly.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Sep 10 22:26:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 10 Sep 1997 14:26:18 -0700 (PDT)
Subject: R-alpha: model.frame
In-Reply-To: <x2vi096s27.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970910141237.4854E-100000@troi>

model.frame(,data=foo) requires foo to be a data.frame in R-0.50-a4.
Previously, and in S, a list is sufficient.

A fix is to add
        if (!is.data.frame(data) & !is.null(data)) 
                data <- as.data.frame(data)
before the first line of terms.formula




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 10 23:03:04 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 10 Sep 1997 17:03:04 -0500
Subject: R-alpha: model.matrix misbehaves on two-sided formulas
Message-ID: <6rsovchlnr.fsf@franz.stat.wisc.edu>

I am using R for a graduate class on linear models that I teach.  I
sent the class a sample transcript of explicit construction of the
model matrix and use of the QR decomposition.  One of the members of
the class picked up on the fact that the model matrix was not what I
advertised that it should be when a two-sided formula is used.  A
one-sided formula works properly.  For example,
 > library(st849)          # loads data sets from the text
 > e1.1
       density speed
  [1,]    20.4  38.8
  [2,]    27.4  31.5
  [3,]   106.2  10.6
  [4,]    80.4  16.1
  [5,]   141.3   7.7
  [6,]   130.9   8.3
  [7,]   121.7   8.5
  [8,]   106.5  11.1
  [9,]   130.5   8.6
 [10,]   101.1  11.1
 [11,]   123.9   9.8
 [12,]   144.2   7.8
 [13,]    29.5  31.8
 [14,]    30.8  31.6
 [15,]    26.5  34.0
 [16,]    35.7  28.9
 [17,]    30.0  28.8
 [18,]   106.2  10.5
 [19,]    97.0  12.3
 [20,]    90.1  13.2
 [21,]   106.7  11.4
 [22,]    99.3  11.2
 [23,]   107.2  10.3
 [24,]   109.1  11.4
 > class(e1.1)
 [1] "data.frame"
 > model.matrix(~density, data = e1.1)  # what we would expect
       (Intercept) density
  [1,]           1    20.4
  [2,]           1    27.4
  [3,]           1   106.2
  [4,]           1    80.4
  [5,]           1   141.3
  [6,]           1   130.9
  [7,]           1   121.7
  [8,]           1   106.5
  [9,]           1   130.5
 [10,]           1   101.1
 [11,]           1   123.9
 [12,]           1   144.2
 [13,]           1    29.5
 [14,]           1    30.8
 [15,]           1    26.5
 [16,]           1    35.7
 [17,]           1    30.0
 [18,]           1   106.2
 [19,]           1    97.0
 [20,]           1    90.1
 [21,]           1   106.7
 [22,]           1    99.3
 [23,]           1   107.2
 [24,]           1   109.1
 attr(,"assign")
 [1] 0 1
 > model.matrix(sqrt(speed) ~ density, data = e1.1) # not what we want
       (Intercept) density
  [1,]           1    38.8
  [2,]           1    31.5
  [3,]           1    10.6
  [4,]           1    16.1
  [5,]           1     7.7
  [6,]           1     8.3
  [7,]           1     8.5
  [8,]           1    11.1
  [9,]           1     8.6
 [10,]           1    11.1
 [11,]           1     9.8
 [12,]           1     7.8
 [13,]           1    31.8
 [14,]           1    31.6
 [15,]           1    34.0
 [16,]           1    28.9
 [17,]           1    28.8
 [18,]           1    10.5
 [19,]           1    12.3
 [20,]           1    13.2
 [21,]           1    11.4
 [22,]           1    11.2
 [23,]           1    10.3
 [24,]           1    11.4
 attr(,"assign")
 [1] 0 1

I think that somewhere along the line an expression like
 eval(form[[2]], data)
is being used when it would be better to use
 eval(form[[length(form)]], data)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Sep 10 23:15:46 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 10 Sep 1997 15:15:46 -0700 (PDT)
Subject: R-alpha: model.matrix misbehaves on two-sided formulas
In-Reply-To: <6rsovchlnr.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.SUN.3.95.970910150548.4854J-100000@troi>

On 10 Sep 1997, Douglas Bates wrote:

> I am using R for a graduate class on linear models that I teach.  I
> sent the class a sample transcript of explicit construction of the
> model matrix and use of the QR decomposition.  One of the members of
> the class picked up on the fact that the model matrix was not what I
> advertised that it should be when a two-sided formula is used.  A
> one-sided formula works properly.  For example,
>  > library(st849)          # loads data sets from the text
>  > e1.1
>        density speed
>   [1,]    20.4  38.8
>  > model.matrix(~density, data = e1.1)  # what we would expect
>        (Intercept) density
>   [1,]           1    20.4
>   [2,]           1    27.4
>  > model.matrix(sqrt(speed) ~ density, data = e1.1) # not what we want
>        (Intercept) density
>   [1,]           1    38.8
>   [2,]           1    31.5
> 
> I think that somewhere along the line an expression like
>  eval(form[[2]], data)
> is being used when it would be better to use
>  eval(form[[length(form)]], data)

No, it's worse than that.  For versions of R up to 0.50-a4, the new alpha
release, model.matrix(formula,dataframe) assumes that its data argument
was generated by
	dataframe<-model.frame(formula,data)
It does *not* check the names or order of the columns. This means that
model.matrix(formula, some.data.frame) will usually give the wrong answer.

In R0.50-a4 this is fixed.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From paul@stat.auckland.ac.nz  Thu Sep 11 02:28:47 1997
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Thu, 11 Sep 1997 13:28:47 +1200 (NZST)
Subject: R-alpha: Mathematical Annotation in R (plots)
In-Reply-To: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
References: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
Message-ID: <199709110128.NAA17794@stat1.stat.auckland.ac.nz>

	[[ this has first bounced to me as 'list-manager', because the
	   subject said  ``Returned mail: User unknown''
	   Paul, I assume you'd approve the subject I've chosen...
	   -- Martin M 
	]]

 hi
 
 for those who are interested ...
 
 the following is a LaTeX document which describes the current state of
 mathematical expression syntax in R
 
 paul
 
 ------CUT HERE---------------------------------------------
 
 \documentstyle{article}
 \begin{document}
 
 \section*{Documentation for \\
 Mathematical Annotation in $R$}
 
 If the {\tt text} argument to one of the text-drawing functions ({\tt
 text}, {\tt mtext}, {\tt axis}) in $R$ is an expression, the argument
 is interpreted as a mathematical expression and the output will be
 formatted according to \TeX -like rules.
 
 A mathematical expression must obey the normal rules of syntax for
 any $R$ expression, but it is interpreted according to very
 different rules than for normal $R$ expressions.  
 
 \begin{description}
 \item[binary operators]  addition, subtraction, multiplication, and
 division use the standard $R$ syntax, although multiplication only
 juxtaposes the arguments.  For example, {\tt a+b}, {\tt a-b}, and {\tt
 a/b}, produce $a+b$, $a-b$, and $a/b$, but {\tt a*b} produces $ab$.
 
 \item[unary operators]  positive and negative numbers are specified
 with standard syntax.  For example, {\tt +x} produces $+x$ and {\tt
 -y} produces $-y$.
 
 \item[subscripts and superscripts]  a subscript is specified
 using the subsetting syntax and a superscript is specified using 
 the power syntax.  For example, {\tt x[i]} produces
 $x_i$ and {\tt x\^{}2} produces $x^2$. 
 
 \item[accents] accented expressions are specified using the special
 mathematical functions {\tt hat} and {\tt bar}.  For example, {\tt
 hat(x)} produces $\hat x$ and {\tt bar(x)} produces $\bar x$.
 
 \item[fractions] fractions are specified using the special
 mathematical function {\tt over}. For example, {\tt over(1,2)}
 produces $1\over2$.
 
 \item[relations]  equality or assignment of terms is specified using
 the {\tt ==} relation.  For example, {\tt x == y} produces $x=y$.
 
 \item[visible grouping]  terms are visibly grouped by placing them
 within parentheses.  For example, {\tt (x+y)} produces $(x+y)$.
 
 \item[invisible grouping]  terms are invisibly grouped by placing
 them within curly braces. For example {\tt x\^{}\{2*y\}} produces
 $x^{2y}$, whereas {\tt x\^{}2*y} produces $x^2y$.
 
 \item[big operators]  a sum, product, or integral is specified using
 the special mathematical function of the corresponding name.  Each
 of these functions takes three arguments;  the first indicates what
 is being summed/multiplied/integrated and the second and third specify
 the limits of the summation/product/integral.  For example, {\tt
 sum(x[i], i==0, n)} produces $\sum\limits_{i=0}^n x_i$.
 
 \item[radicals]  a square root expression is specified using the
 special mathematical functions {\tt root} and {\tt sqrt}.  For
 example, {\tt sqrt(x)} produces $\sqrt x$.
 
 \item[absolute values]  an absolute term is specified using the
 special mathematical function {\tt abs}.  For example, {\tt abs(x)}
 produces $\left|x\right|$.
 
 \item[juxtaposition]  multiple terms are juxtaposed using the special
 mathematical function {\tt paste}.  For example, {\tt paste(over(b,
 2), y, sum(x))} produces ${b\over2} y \sum x$.
 
 \item[typeface changes]  the default font in mathematical expressions
 is italic (except for terms which are symbols).  A new typeface is
 specified using the special mathematical functions {\tt bold}, {\tt
 italic}, {\tt plain}, and {\tt bolditalic}.  For example, {\tt
 plain(X)[i]} produces ${\rm X}_i$. These font specifications do not
 accumulate (i.e., {\tt bold(italic(x)))} produces $x$ (an italic "x"),
 whereas {\tt bolditalic(x)} produces \textit{\textbf{x}} (a bold, italic "x").
 
 \item[general expressions]  any functional expression which is not a
 special mathematical function is simply reproduced as a function
 expression.  For example, {\tt foo(x)} produces $foo(x)$.
 
 
 \end{description}
 
 \end{document}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep 11 11:22:58 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Sep 1997 12:22:58 +0200
Subject: R-alpha: Mathematical Annotation in R (plots)
In-Reply-To: <199709110128.NAA17794@stat1.stat.auckland.ac.nz>
References: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
 <199709110128.NAA17794@stat1.stat.auckland.ac.nz>
Message-ID: <199709111022.MAA24424@aragorn.ci.tuwien.ac.at>

>>>>> Paul Murrell writes:

> 	[[ this has first bounced to me as 'list-manager', because the
> 	   subject said  ``Returned mail: User unknown''
> 	   Paul, I assume you'd approve the subject I've chosen...
> 	   -- Martin M 
> 	]]

>  hi
 
>  for those who are interested ...
 
>  the following is a LaTeX document which describes the current state of
>  mathematical expression syntax in R

very nice!

Martin, can we include this in the R Base Manual?  (i.e. in Man.tex)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep 11 12:19:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Sep 1997 13:19:07 +0200
Subject: R-alpha: naming convention for index files
In-Reply-To: <199709081556.RAA01060@sophie.ethz.ch>
References: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at>
 <199709081556.RAA01060@sophie.ethz.ch>
Message-ID: <199709111119.NAA28447@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

KH> In the process of moving to the new directory structure, we might also
KH> reconsider the naming of the various index files.

KH> A simple idea would be to have an `INDEX' file in each directory where
KH> this is appropriate.  E.g., we could have

KH> pkg/funs/INDEX		(rather than help/pkg/INDEX)

> but  help/base/INDEX  is autogenerated
> where as everything in ./funs/  (or /R/  as you propose later)  is  SOURCE

KH> pkg/data/INDEX		(rather than index.doc)
> index.doc is source

KH> pkg/help/INDEX		(rather than AnIndex)
> this is auto-generated again...

> --
> in summary, we could well say   INDEX  instead of different names,
> but I don't think we should  autogenerate a file in a directory
> where there's only source  (other than the 'Makefile'; Lib... files that
> 			    configure generates, and which are not needed
> 			    anymore after installation)

> Remember: 

> 	The big idea is still that after

> 		make install + install-help + ..
> 			(just after all the installation)

> 	you should be able to
> 	REMOVE the full  ./src/  tree and still have a completely 
> 	working R (including online help, ...).


KH> or e.g.

KH> pkg/INDEX.funs
KH> pkg/INDEX.data

KH> etc.

KH> The package TITLE files would be used for building the package index of
KH> a library tree (LibIndex?)

> very good idea

KH> In any case, the `plain' indices to be displayed upon calling an
KH> appropriate form of help() could contain MORE than simply a list of
KH> things.  I.e., more like a README.

KH> My idea is (assuming only RHOME is in .lib.loc):

KH> library()

KH> `RHOME' is the location of the default R library tree.
KH> Blah blah blah ...

KH> Packages in `RHOME':

KH> base		The basic package.
KH> eda		...
KH> mva		...

KH> The last lines could be generated from the packages' TITLE files.  The
KH> other info from some stub, perhaps LibIndex.in?

> very good idea

KH> As usual, any feedback is appreciated.

> as usual, I give you some ... ;-)

Yes, Martin, what would I do without you?

You are right, of course, there should be some distinction between the
static and the dynamic (automatically generated) index files.

I think we need to distinguish two things.  On the one hand, we need
some short (a one-liner as in TITLE) and some long ``documentation'' on
a package.  The long one could be sort of like the README files which
come with certain S add-ons (and typically list the user-level objects
in the pkg).

If we ask for information about a package, the long one is what we
should get, I think.

On the other hand, it is clearly useful to have lists of R objects and
data sets a package provides.  These are the INDEX files.  But these
could also be auto-generated upon installation from the man sources.
In fact, as we also need them in HTML (and maybe in LaTeX), there is
not too much use for prebuilt ones ...

So, what shall we do about the indices?  As I already said, I think that
the documentation for data should be converted to the new Rd format and
merged with the R object documentation (same name space etc).  

Clearly, we should have a list of data somewhere, so that we can quickly
list all data sets.  Hmmm ... I guess I am not entirely sure what to do.

Library `info' should be o.k.:  we create the LibIndex from a README
like file and the TITLE files of all packages in the lib.

***

For the time being, I will not change anything.  (Unless we have a real
breakthough ...)

In the new dir structure, should the INDEX and TITLE files be installed
to $lib/$pkg or its help subdir?  They make sense outside of help ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 12 11:09:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 12 Sep 1997 12:09:08 +0200
Subject: R-alpha: bug in passing of empty  (...)
Message-ID: <199709121009.MAA01186@sophie.ethz.ch>

This is too bad (and an old bug at least since 0.49); 
it also breaks some code I have been using in S-plus:

> tst <- function(...) ls(...)

> tst()#--- should really give the same as ls() !!
character(0)

> ls()
  [1] "%in%"                   "As.integer"             "Dir"                   
  [4] "Dir0"                   "Fn12"                   "Slynx"                 
  ......
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep 12 11:46:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Sep 1997 12:46:35 +0200
Subject: R-alpha: bug in passing of empty  (...)
In-Reply-To: Martin Maechler's message of Fri, 12 Sep 1997 12:09:08 +0200
References: <199709121009.MAA01186@sophie.ethz.ch>
Message-ID: <x2wwkmstbo.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> This is too bad (and an old bug at least since 0.49); 
> it also breaks some code I have been using in S-plus:
> 
> > tst <- function(...) ls(...)
> 
> > tst()#--- should really give the same as ls() !!
> character(0)
> 
> > ls()
>   [1] "%in%"                   "As.integer"             "Dir"                   
>   [4] "Dir0"                   "Fn12"                   "Slynx"                 
>   ......

I don't know whether it's a bug or a feature, but it has nothing to do
with (...)

> tst<-function()ls()
> tst()
character(0)
> ls()
 [1] "NextMethod" "airquality" "dig"        "grid"       "l"         
 [6] "tst"        "umach"      "x"          "xmin"       "y"         
[11] "z"          ""       
> tst<-function(...){x<-5;ls(...)}  
> tst()
[1] "x"
> tst<-function(){x<-5;ls()}
> tst()
[1] "x"

I'm rather suspecting that pos=-1 in the argument list to ls should
have been pos=1. Anyone have the big picture on pos and envir?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Sep 12 18:00:17 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 12 Sep 1997 10:00:17 -0700 (PDT)
Subject: R-alpha: long term wishes
In-Reply-To: <6rsovchlnr.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.SUN.3.95.970912093350.7444C-100000@troi>


I have two difficult but not impossible suggestions for long-term
improvements to memory handling in R.

The first is in foreign function calling.  It would sometimes save a lot
of time if you could designate arguments to to .C/.Fortran as input or
output only (like Fortran 90 INTENT IN/OUT descriptions).  At the moment
every argument to foreign code is copied into a non-relocatable area, then
copied back into a new R variable.  If a variable was INTENT IN, it would
not be copied back, and that element of the return value would be NULL; if
a variable was INTENT OUT it would not be copied in and R would just
malloc() the correct amount of space in the non-relocatable area.  I've
been writing quite a bit of C code that turns huge matrices into small
ones, involving a lot of memory movement that could easily be removed.
The default would have to still be copying everything, for backwards
compatibility and idiotproofing.

The second, more difficult suggestion, is to do something other than stop
when memory is exhausted.  It doesn't matter if what you do is slow, as
the alternative is complete failure.  It should be possible for R to try
and grab a bigger chunk of memory (perhaps 50-100% bigger) and move into
it.  The relocatable part of the heap wouldn't be a big problem but the
non-relocatable part would need to be kept where it was and a new one
started.  On the other hand, this probably requires rewriting a whole
bunch of stuff and might be very painful.


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sat Sep 13 02:20:43 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 13 Sep 1997 13:20:43 +1200 (NZST)
Subject: R-alpha: bug in passing of empty  (...)
Message-ID: <199709130120.NAA21321@stat1.stat.auckland.ac.nz>

This is a "feature" of ls().  When invoked with no arguments it returns
the list of variables \emph{in the environment it is called from}.
This is to make it useful in conjunction with debug() and browser().
It allows you find out what the current local variables are.

To get the same effect as a top level ls(), you must expicitly do
	ls(pos=1)             # may fail if we allow attaching at pos=1
	ls(envir=.GlobalEnv)  # safer

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Sat Sep 13 13:55:24 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 13 Sep 1997 07:55:24 -0500
Subject: R-alpha: ${RHOME}/configure and f2c.h
Message-ID: <6r202txtj7.fsf@franz.stat.wisc.edu>

Installing R-0.50a4 on some of our systems I found that the mva
library doesn't build because the include file f2c.h is not available.

 make[3]: Entering directory `/afs/cs.wisc.edu/unsup/R-0.50alpha4/src/library/mva/src-c'
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c dblcen.c 
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c dist.c 
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c hclust.c 
 hclust.c:6: f2c.h: No such file or directory
 make[3]: *** [hclust.o] Error 1

Is it possible to search for this in the configure script?  I'm not
sure what to suggest to the installer if it is not available.  Is the
information used sufficiently well-defined that a replacement could be
generated on the fly?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Sep 13 20:04:51 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 13 Sep 1997 12:04:51 -0700 (PDT)
Subject: R-alpha: compatibility
In-Reply-To: <199709131524.RAA03703@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970913115858.557A-100000@troi>


Two compatibility issues found while trying to convert a simulation from S
to R.

1. set.seed()  We don't have this function.  According to Venables &
Ripley it just picks a seed from a list of 1000 possibilities. How about
"set.seed" <-function (i) 
{
        if (any(i > 1000) | any(i < 1)) 
                stop("argument to set.seed() must be in 1:1000")
        if (any(i != trunc(i))) 
                stop("argument to set.seed()must be an integer")
        .Random.seed <<- as.integer((200 * c(i, i^2, i^3))%%c(30269, 
                30307, 30323))
}


2. lapply() in S-PLUS works on vectors, ie
lapply(X, FUN) works like lapply(as.list(X),FUN) orsapply(X,FUN,simplify=F)


	-thomas



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 07:33:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 08:33:23 +0200
Subject: R-alpha: predict.lm -- who ..?
Message-ID: <199709150633.IAA00396@sophie.ethz.ch>

Just a short reminder / question --

We've had one posting 
>> Date: Sun, 17 Aug 1997 19:51:20 -0700
>> From: Kung-Sik Chan <kchan@stat.uiowa.edu>
>> To: r-help@stat.math.ethz.ch
>> Subject: R-beta: bug report

with a  predict.default  that would "work" with (some) lm objects, 
and I think it was said that  predict.lm  "is being" written
(Peter Dalgaard, Ross Ihaka ?)
because it was urgently needed.

We haven't seen any code posting since, and I just wondered about the
current state of the affair.

Maybe some  predict.lm(.) could be posted in order to be discussed and
polished ...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 09:29:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 10:29:37 +0200
Subject: R-alpha: is.vector(.., mode=..) bug  (old)
Message-ID: <199709150829.KAA04259@sophie.ethz.ch>

It is clear, I think, that
	is.vector(o, mode = "any")
should be  TRUE  whenever any of
	is.vector(o, mode = "<something>")
is TRUE.

This is not yet the case, however, see below.

Consider the following examples  which should be self-explaining.
Besides the above bug, they also show you that -- for S compatibility --
the  mode argument should really use strings as returned by 'mode(.)';
Currently it uses strings as returned by 'typeof(.)',
 see the definition of mode (written in R) which uses typeof(.) [among others].

[[and I've added the following useful EXAMPLE to the  man page of 'mode' 
	 src/library/base/man/mode :

     cex3 <- c("1","1:1","1i","list(1)","args","lm","formals(lm)[[2]]","y~x")
     lex3 <- sapply(cex3, function(x) eval(parse(text=x)))
     mex3 <- t(sapply(lex3, function(x) c(typeof(x), storage.mode(x), mode(x))))
     dimnames(mex3) <- list(cex3, c("typeof(.)","mode(.)","storage.mode(.)"))
     mex3

]]


## Here is my test code revealing the  is.vector(..) problems :

### Ex. 1  --- call ---
cl <- call("lm",y~x)
is.call(cl)# TRUE
mode(cl)  # "call" (S & R);	#__R:  typeof(cl) == "language"

is.vector(cl, mode = "any")      #R: FALSE, S: TRUE
is.vector(cl, mode = "call")     #R: FALSE  S: TRUE
is.vector(cl, mode = "language") #R: TRUE   S: FALSE

### Ex. 2  --- symbol ---
fo <- formula( y ~ x )
mode(fo)  # "call" (S & R)	#__R: typeof(fo) == "language"
is.call(fo)# TRUE  (S & R)
is.name(fo)# FALSE (S & R)

fo1 <- fo[1][[1]]
fo1 # `~'
mode(fo1)  # "name" (S & R)	#__R: typeof(fo1) == "symbol"
is.call(fo1)# FALSE (S & R)
is.name(fo1)# TRUE  (S & R)

is.vector(fo1, mode = "any")    #R: FALSE, S: TRUE
is.vector(fo1, mode = "name")   #R: FALSE, S: TRUE
is.vector(fo1, mode = "symbol") #R: TRUE,  S: FALSE

-----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 10:20:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 11:20:54 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Martin Maechler's message of Mon, 15 Sep 1997 08:33:23 +0200
References: <199709150633.IAA00396@sophie.ethz.ch>
Message-ID: <x2afhf0w7d.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> Just a short reminder / question --
> 
> We've had one posting 
> >> Date: Sun, 17 Aug 1997 19:51:20 -0700
> >> From: Kung-Sik Chan <kchan@stat.uiowa.edu>
> >> To: r-help@stat.math.ethz.ch
> >> Subject: R-beta: bug report
> 
> with a  predict.default  that would "work" with (some) lm objects, 
> and I think it was said that  predict.lm  "is being" written
> (Peter Dalgaard, Ross Ihaka ?)
> because it was urgently needed.
> 
> We haven't seen any code posting since, and I just wondered about the
> current state of the affair.
> 
> Maybe some  predict.lm(.) could be posted in order to be discussed and
> polished ...

I think Ross has the version that is closest to the real thing...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 15 11:16:26 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 15 Sep 1997 22:16:26 +1200 (NZST)
Subject: R-alpha: predict.lm -- who ..?
Message-ID: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>

Here is my (incomplete) version. This will work for full-rank models,
and I suspect also for singular models (the comment is just a reminder
to myself that I was thinking about this).

I set out to change the underlying structure so that case names
would be propagated through to to the fitted values.  This doesn't
happen at the moment because they are not handled within "model.matrix".
A quick fix would be to replace dimnames(x) below by row.names(mf).

There is no computation of standard errors below, but the present
version has something like the right computation.

Sorry that this is just a hint, but I'm really under pressure at
present.  Anyone got any (applied) exam questions on linear models
or glms handy?
	Ross
	

predict.lm <-
function (fit, newdata) 
{
	mf <- model.frame(formula(fit), data = newdata)
	# recreate the design matrix
	x <- model.matrix(terms(fit), mf)
	# grab the coefficients (order is correct?)
	b <- coef(fit)
	b[is.na(b)] <- 0
	# compute predictions
	p <- x %*% b
	# attach name information
	if(is.matrix(b)) {
		dimnames(p) <- list(dimnames(x)[[1]], dimnames(b)[[2]])
	}
	else {
		p <- as.vector(p)
		names(p) <- dimnames(x)[[1]]
	}
	p
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 14:48:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 15:48:09 +0200
Subject: R-alpha: set.seed(.) [was 'compatibility']
Message-ID: <199709151348.PAA04532@sophie.ethz.ch>


>>>>> Thomas Lumley writes:
    >> Two compatibility issues found while trying to convert a simulation
    >> from S to R.

    >> 1. set.seed()  We don't have this function.  According to Venables &
    >> Ripley it just picks a seed from a list of 1000 possibilities. How about
    >>
    >> "set.seed" <-function (i) 
    >> {
    >>         if (any(i > 1000) | any(i < 1)) 
    >>                 stop("argument to set.seed() must be in 1:1000")
    >>         if (any(i != trunc(i))) 
    >>                 stop("argument to set.seed()must be an integer")
    >>         .Random.seed <<- as.integer((200 * c(i, i^2, i^3))%%c(30269, 
    >>                 30307, 30323))
    >> }

Thank you Thomas,
yes I agree that we should have a  set.seed(.).

{{now follows a longish explanation about what S-plus does, etc..
  at the end a better (?) proposal for set.seed 
}}

When I first thought about implementing  set.seed(.) in R,
I tried to understand what S-plus does (and did not succeed).
In the mean time, I have re-investigated and found almost ``everything'' :

S-plus 3.4 *help* says

Sp3.4>>     DESCRIPTION:
Sp3.4>> 	   Puts the random number generator in a reproducible state.
Sp3.4>> 
Sp3.4>>     USAGE:
Sp3.4>> 	   set.seed(i)
Sp3.4>> 
Sp3.4>>     REQUIRED ARGUMENTS:
Sp3.4>>     i:     be an integer between 0 and 1000.
Sp3.4>> 
Sp3.4>>     SIDE EFFECTS:
Sp3.4>> 	   Sets the value of the .Random.seed object in  the  working
Sp3.4>> 	   directory.
Sp3.4>> 
Sp3.4>>     DETAILS:
Sp3.4>> 	   Random number generators in S-PLUS are all  based  upon  a
Sp3.4>> 	   single  uniform  random  number  generator  that generates
Sp3.4>> 	   numbers in a very long, but ultimately periodic  sequence.
Sp3.4>> 	   The   position   in   the   sequence  is  held  in  object
Sp3.4>> 	   .Random.seed.  Function set.seed sets .Random.seed so that
Sp3.4>> 	   subsequent  calls  to  random  number  generator functions
Sp3.4>> 	   (runif, rnorm, etc.)  will generate  numbers  from  a  new
Sp3.4>> 	   portion of the overall cycle.
Sp3.4>> 
Sp3.4>> 	   Random  number  generation  in  S-PLUS  is  adapted   from
Sp3.4>> 	   Marsaglia  (1973);  see  Kennedy  and  Gentle  (1980)  for
Sp3.4>> 	   background information.

So they __say__   ``i in 0:1000'', but the
problem is that set.seed(i) also ``works'' with any other integer i.

But what exactly should happen?
The crucial sentence is (as vague as)
 Sp3.4>> Function set.seed sets .Random.seed so that
 Sp3.4>> subsequent calls to random number generator functions (runif...) 
 Sp3.4>> will generate numbers from a new portion of the overall cycle.

The intent being that for ANY i,j (i!=j) set.seed(i) and set.seed(j) would
choose ``distant'' parts of the periodic cycle.

Unfortunately, we don't know what exactly happens in
the S-plus code for set.seed(i), namely,  .C("setseed", as.integer(i))
However, I have found out the following which should suffice :

 1) Only .Random.seed[4:6]  are varyied by set.seed, i.e., 
   after set.seed(i), .Random.seed always is

	   1  2  3  4  5  6  7  8  9 10 11 12	
      [1] 21 14 49  *  *  * 32 22 36 23 28  3
		   X4 X5 X6

   Which means that only the 'congrval' {Venables & Ripley, 2nd ed., p.166-167}
   is varied	

 2) X4 is always ==  16*((i+2) %% 4)
    X5 takes (all) values in 0:63  [also with some periodicity]
    X6 takes the values of 0:3

 3) set.seed(i) <==> set.seed(i + n*1024)  for all integers n, i

 4) { set.seed(i) ;  i \in {integers}} 
    results in a set of 1024 different values of 'congrval'.
    These values are EXACTLY EQUISPACED lying in {0,..,2^32}.

    If C[1:1024] are these sorted values, we have

	C[i] == 201621 + (i-1)* 2^22  , for i in 1:1024
	


So far for S-plus.

-----------------------------------------------------------------

Now, in R with a different basic RNG (with a longer period), 
		-- see ?.Random.seed --
we would want  set.seed(i)
to also guarantee that the locations in the periodic cycle are far apart.

I think (but may be wrong; I must do other things now !!)
this can be better achieved by just changing one of the 3 congruential
generators involved.
This leads to the following proposal :

set.seed <- function (i) 
{
        if(length(i) != 1  || i != (ii <- as.integer(i)))
	  stop("argument to set.seed() must be integer(1)")
	i <- ii
        if (i > 1024 || i < 1) {
	  warning("set.seed(i) has i outside 1:1024; taking  i %% 1024")
	  i <- i %% 1024; if(i <= 0) i <- i+ 1024
	}
        invisible(.Random.seed <<- as.integer(c((171*i)%%30269, 10909, 10111)))
}



Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep 15 15:51:37 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 15 Sep 1997 10:51:37 -0400
Subject: R-alpha: compatibility
References: <Pine.SUN.3.95.970913115858.557A-100000@troi>
Message-ID: <97Sep15.105405edt.26503@mailgate.bank-banque-canada.ca>

Please don't mess with the random number generator without good reason!
You will mess me up a whole lot! You can of course change the default
behavior of set.seed without affecting me. Here are my thoughts on
set.seed.

Despite the fact that the Blue Book says set.seed takes an integer
argument, and despite the fact that the Splus version of set.seed does
take an integer argument, I don't think anyone who actually does a lot
of random experiments would actual want to use set.seed like that. The
reason is that you often want to reproduce a random experiment after
you've done it, and of course, often, you don't set the seed before you
do the experiment. To get around this I save the starting .Random.seed
with my simulation experiments. Then I have my own set.seed (in Splus
and in R) which works directly with the .Random.seed, so in Splus it
takes 12 (small) integers as its argument and in R it takes 3 integers.
I also allows a single integer argument for Blue Book compatibility and
in Splus I use their set.seed (which I rename) for this case. As you may
see below, the default behavior in R is rather ad hoc. Below are my
Splus and R versions of set.seed. The R version has a minor workaround
for the problem that the R .Random.seed does not seem to exist until the
random number generator is used the first time.  I also prefer returning
the new seed as the value of the function.

Paul Gilbert
______________

in R

    set.seed <- function(seed=NULL)
      {if (is.null(seed))
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not
yet exist
          seed <-.Random.seed
         }
       else
         {if (1==length(seed))

global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }
    global.assign <- function(name, value)
                          {assign(name,value, envir=.GlobalEnv)}

in S
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
          seed <-.Random.seed
       else
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }
    global.assign <- function(name, value) {assign(name,value, where =
1)}


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Mon Sep 15 17:27:54 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Mon, 15 Sep 1997 09:27:54 -0700 (PDT)
Subject: R-alpha: compatibility
In-Reply-To: <97Sep15.105405edt.26503@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970915091422.1882B-100000@troi>

On Mon, 15 Sep 1997, Paul Gilbert wrote:

> Please don't mess with the random number generator without good reason!
> You will mess me up a whole lot! You can of course change the default
> behavior of set.seed without affecting me. Here are my thoughts on
> set.seed.

I am aware of the problems with messing with random number generators,
which is why I wasn't proposing to.  In the generator we use (unlike in
S-PLUS), any seed value gives (a different part of) the same sequence of
random numbers, so seed setting is a harmless procedure.

>> Despite the fact that the Blue Book says set.seed takes an integer
> argument, and despite the fact that the Splus version of set.seed does
> take an integer argument, I don't think anyone who actually does a lot
> of random experiments would actual want to use set.seed like that.

I don't think the issue is whether set.seed() does something useful in S. 
It does *something* in S, and people use it in writing programs. They may
well want to run these programs in R (or we may want them to, especially
if they are sharing CPU time with us). The last thing we want to do is to
have a function set.seed() in R that does something qualitatively
different from the S function. 


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Mon Sep 15 17:55:02 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Mon, 15 Sep 1997 11:55:02 -0500 (CDT)
Subject: R-alpha: compatibility
In-Reply-To: <Pine.SUN.3.95.970915091422.1882B-100000@troi> from "Thomas Lumley" at Sep 15, 97 09:27:54 am
Message-ID: <9709151655.AA13639@nokomis.stat.umn.edu>

This is one point where compatibility is not necessarily a good
thing. S, like most systems gives, you no real control over the random
number generator expect re-seeding. Usually this is probably good. But
most simulation books recommend running any simulations you care about
with two very different generators. Most people don't do this because
one generator is usually easy to use (the built-in one in your
favorite system) and anything else is impossible. Another issue that S
faces has to do with running separate bits of a simulation on separate
workstations. Unless you are careful, the separate bits will share
parts of random number streams, and being careful is not really
possible with S's generator (I think) -- it is possible but not easy
with R's. (Of course overlap can be a good thing if you know you have
it -- the point here is that lots of folks run separate simulations
thinking they have independent runs when they probably do not in any
reasonable sense).

The bottom line is that it would be nice to eventually provide "power
users" with more control over the random number generator system.  Now
is clearly not the time to think about how to do that, but it would be
unfortunate if decisions were made at this point in the name of
compatibility that might limit the freedom of doing something "right"
later on.

Just my 2c.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep 15 19:44:24 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 15 Sep 1997 14:44:24 -0400
Subject: R-alpha: set.seed compatibility
References: <Pine.SUN.3.95.970915091422.1882B-100000@troi>
Message-ID: <97Sep15.144656edt.26510@mailgate.bank-banque-canada.ca>

The modification to set.seed that I was suggesting does not change its
default behavior, so software which runs in S still runs with my change.
The change means that set.seed can also be given a value for
.Random.seed. This would fail with the usual S version of set.seed. I
don't think we need to take compatibility to the extend of failing when
S fails.

Also, I don't think set.seed can really accomplish what I think of as
the true objective of compatibility: reproduce S random experiments with
R (possibly not even if the same random number generator is used). Even
Splus has not been completely successful in this respect. There were
some changes between 3.2 and 3.3 which affected reproducibility.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 21:50:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 22:50:58 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Ross Ihaka's message of Mon, 15 Sep 1997 22:16:26 +1200 (NZST)
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
Message-ID: <x24t7mfgi5.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Here is my (incomplete) version. This will work for full-rank models,
> and I suspect also for singular models (the comment is just a reminder
> to myself that I was thinking about this).
> 
> I set out to change the underlying structure so that case names
> would be propagated through to to the fitted values.  This doesn't
> happen at the moment because they are not handled within "model.matrix".
> A quick fix would be to replace dimnames(x) below by row.names(mf).
> 
> There is no computation of standard errors below, but the present
> version has something like the right computation.
> 
> Sorry that this is just a hint, but I'm really under pressure at
> present.  Anyone got any (applied) exam questions on linear models
> or glms handy?
> 	Ross
> 	
> 
> predict.lm <-
> function (fit, newdata) 
> {
> 	mf <- model.frame(formula(fit), data = newdata)
> 	# recreate the design matrix
> 	x <- model.matrix(terms(fit), mf)
> 	# grab the coefficients (order is correct?)
> 	b <- coef(fit)
> 	b[is.na(b)] <- 0
> 	# compute predictions
> 	p <- x %*% b
> 	# attach name information
> 	if(is.matrix(b)) {
> 		dimnames(p) <- list(dimnames(x)[[1]], dimnames(b)[[2]])
> 	}
> 	else {
> 		p <- as.vector(p)
> 		names(p) <- dimnames(x)[[1]]
> 	}
> 	p
> }
> 

Hum, maybe my version was closer after all. Thing was that I tried to
be smart and have it work without having to specify the dataframe
(which gets to be a terrible pain when you need to specify factors
with the same level structure as in the original). On second thought,
I decided to abandon that idea and stick with S(-plus?) compatibility.
However I did get the SE's done and soforth. Here's my effort:


"like.frame" <-
function (frame, ...) 
{
        if (!is.data.frame(frame)) 
                stop("like.frame: first argument must be a data frame")
        f <- list(...)
        class(f) <- "data.frame"
        n <- ncol(f)
        nm.base <- names(frame)
        nm.new <- names(f)
        if (is.null(nm.new)) 
                nm.new <- rep("", n)
        for (i in 1:n) {
                if (nm.new[i] == "") {
                        #positional match 
                        nm.new[i] <- nm.base[i]
                        j <- i
                }
                else j <- match(nm.new[i], nm.base)
                if (!is.na(j)) 
                        if (is.factor(frame[[j]])) {
                                lab <- levels(frame[[j]])
                                lev <- 1:nlevels(frame[[j]])
                                f.i <- f[[i]]
                                if (is.character(f.i)) 
                                 f.i <- match(f.i, lab)
                                f[[i]] <- factor(f.i, levels = lev, 
                                 labels = lab)
                        }
        }
        names(f) <- nm.new
        f
}
"predict.lm" <-
function (object, ...) 
{
        mod.fr <- model.frame(object)
        form <- formula(object)
        # x~a+b becomes ~a+b
        form <- as.call(list(form[[1]], form[[3]]))
        class(form) <- "formula"
        pred.fr <- like.frame(mod.fr, ...)
        # the following is a kludge to work around a bug in data.frame:
        zz <- attr(terms(form), "variables")
        zz[[1]] <- as.name("list")
        pred.fr <- eval(zz, pred.fr)
        class(pred.fr) <- "data.frame"
        X <- model.matrix(form, pred.fr)
        n <- NROW(object$qr$qr)
        p <- object$rank
        p1 <- 1:p
        piv <- object$qr$pivot[p1]
        r <- resid(object)
        f <- fitted(object)
        w <- weights(object)
        if (is.null(w)) 
                rss <- sum(r^2)
        else rss <- sum(r^2 * w)
        R <- chol2inv(object$qr$qr[p1, p1, drop = FALSE])
        est <- object$coefficients[piv]
        predictor <- c(X[, piv] %*% est)
        ip <- real(NROW(X))
        resvar <- rss/(n - p)
        vcov <- resvar * R
        for (i in (1:NROW(X))) {
                xi <- X[i, piv]
                ip[i] <- xi %*% vcov %*% xi
        }
        stderr1 <- sqrt(ip)
        stderr2 <- sqrt(resvar + ip)
        tt <- qt(0.975, n - p)
        conf.l <- predictor - tt * stderr1
        conf.u <- predictor + tt * stderr1
        pred.l <- predictor - tt * stderr2
        pred.u <- predictor + tt * stderr2
        z <- list(predictor = predictor, conf.l = conf.l, conf.u = conf.u, 
                pred.l = pred.l, pred.u = pred.u)
        class(z) <- "data.frame"
        z
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 22:57:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 23:57:02 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Peter Dalgaard BSA's message of 15 Sep 1997 22:50:58 +0200
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
 <x24t7mfgi5.fsf@bush.kubism.ku.dk>
Message-ID: <x2yb4yckb5.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> Hum, maybe my version was closer after all. Thing was that I tried to
...
> However I did get the SE's done and soforth. Here's my effort:

OK. A little thought and some cleanup later, I have this one. I'm a
little reluctant to go completely Splus compatible (return a list with
components $fit $se.fit $residual.scale $df if se.fit=T, otherwise
just the predicted values) and losing the confidence/prediction
intervals. Opinions?

"predict.lm" <-
  function (object, newdata = model.frame(object)) 
{
  form<-formula(object)
  form<-as.call(list(form[[1]],form[[3]])) # x~a+b becomes ~a+b
  class(form)<-"formula"
  X <- model.matrix(form,newdata)
  n <- NROW(object$qr$qr)
  p <- object$rank
  p1 <- 1:p
  piv <- object$qr$pivot[p1]
  r <- resid(object)
  f <- fitted(object)
  w <- weights(object)
  if (is.null(w)) 
    rss <- sum(r^2)
  else 
    rss <- sum(r^2*w)
  R <- chol2inv(object$qr$qr[p1, p1, drop = FALSE])
  est <- object$coefficients[piv]
  predictor <- c(X[,piv] %*% est)
  ip <- real(NROW(X))
  resvar <- rss/(n - p)
  vcov <- resvar * R
  for (i in (1:NROW(X))) {
    xi <- X[i,piv]
    ip[i] <- xi %*% vcov %*% xi
  }
  stderr1 <- sqrt(ip)
  stderr2 <- sqrt(resvar + ip)
  tt <- qt(0.975, n - p)
  conf.l <- predictor - tt * stderr1
  conf.u <- predictor + tt * stderr1
  pred.l <- predictor - tt * stderr2
  pred.u <- predictor + tt * stderr2
  data.frame(predictor=predictor, conf.l=conf.l, conf.u=conf.u,
	pred.l=pred.l,pred.u=pred.u,row.names=rownames(newdata))
}
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 15 23:10:52 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 16 Sep 1997 10:10:52 +1200 (NZST)
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: <x2yb4yckb5.fsf@bush.kubism.ku.dk>
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
 <x24t7mfgi5.fsf@bush.kubism.ku.dk>
 <x2yb4yckb5.fsf@bush.kubism.ku.dk>
Message-ID: <199709152210.KAA24228@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:

 > "predict.lm" <- [stuff returning a data frame]

This looks just like what I had in mind (though I was thinking matrix
rather than dataframe).  This I think is more useful (at least to the
kiddies I teach) than the S one.

BUT: I have been berated by my class for preparing examples with R and
trying to pass them off as S - they notice the minor differences.
Pehaps it would be possible to make a library "smodels" which is as
close to S as we can make it. I have an lm.summary and
lm.summary.print which could go into it.

In general I don't like compatibility boxes, but this seems harmless
enough.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep 16 15:09:40 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 16 Sep 1997 16:09:40 +0200
Subject: R-alpha: bug: rbind(.) drops names for character; cbind(.) is ok.
Message-ID: <199709161409.QAA13816@sophie.ethz.ch>

R version (>) 0.50-a4:

##-- This is fine :
> rbind(graph=c(1:3), plot=c(2:4), my.glm=c(3:5))
       [,1] [,2] [,3]
graph     1    2    3
plot      2    3    4
my.glm    3    4    5

##-- This is the bug:
> rbind(graph=c("A","B"), plot=c(2:3), my.glm=c(3:4))
     [,1] [,2]
[1,] "A"  "B" 
[2,] "2"  "3" 
[3,] "3"  "4" 

##-- cbind(.) is ok:
> cbind(graph=c("A","B"), plot=c(2:3), my.glm=c(3:4))
     graph plot my.glm
[1,] "A"   "2"  "3"   
[2,] "B"   "3"  "4"   
> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Sep 17 08:30:56 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 17 Sep 1997 09:30:56 +0200 (MET DST)
Subject: R-alpha: fortran
Message-ID: <9709170730.AA19097@alpha.luc.ac.be>

I have a strange problem with calling fortran in 50a4. In longitudinal
analysis, I have a vector of times. When they are unequally spaced,
the user must supply them and things work fine when they are sent to
the fortran. If the data are balanced and equally spaced, the user
need not supply them and the function calculates them, say as
time <- 1:nt
When I feed this to the fortan, it receives it as a vector of
integers!!! I have to put
time=as.double(time)
in the call for it to work properly. I do not believe that this was a
problem before a4. I thought everything was a double in R?!
Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep 17 09:33:08 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 17 Sep 1997 20:33:08 +1200 (NZST)
Subject: R-alpha: fortran
Message-ID: <199709170833.UAA19552@stat1.stat.auckland.ac.nz>

Its been this way for a while.  We made the output from the ":" operator
be integer.  This is compatible with S and is a bit more efficient
in things like x[1:10] because the subscripts do not need to be
converted to integer.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Sep 17 10:42:32 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 17 Sep 1997 11:42:32 +0200 (MET DST)
Subject: R-alpha: nlm
Message-ID: <9709170942.AA23823@alpha.luc.ac.be>

It would be nice if nlm returned the number of iterations taken as
well as the code indicating if the limit is exceeded. For the moment,
the only way to access it is by looking at the output from
print.level=2. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Thu Sep 18 15:00:11 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 18 Sep 1997 09:00:11 -0500
Subject: R-alpha: Re: R-Mailing lists ok again. ..sorry..
In-Reply-To: Martin Maechler's message of Thu, 18 Sep 1997 08:59:00 +0200
References: <199709180659.IAA01778@sophie.ethz.ch>
Message-ID: <6ren6men84.fsf@franz.stat.wisc.edu>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> This caused 3 postings (1 to R-help, 2 to R-devel) to be aborted.
> For some reason, it also seems majordomo did not save the postings in
> a 'dead.letter' or something.

> So could you please re-submit them? 

> These are the sendmail entries:

> Sep 17 21:14:21 .. sendmail[9364]: VAA09363: from=<bates@stat.wisc.edu>, size=390, class=0, pri=30390, nrcpts=1, msgid=<6ren6nbvnt.fsf@franz.stat.wisc.edu>, proto=ESMTP, relay=root@franz.stat.wisc.edu [128.105.5.95]

> Sep 17 21:47:26 .. sendmail[9518]: VAA09517: from=<bates@stat.wisc.edu>, size=331, class=0, pri=30331, nrcpts=1, msgid=<6rd8m7bu42.fsf@franz.stat.wisc.edu>, proto=ESMTP, relay=root@franz.stat.wisc.edu [128.105.5.95]

I can't find copies of those messages so I will summarize here.  One
of them was unimportant - simply an observation that the mis-typing of
TITLE as TITLe in the documentation for the library function is
intentional.  The second was a query to Fritz with a copy to this list
on whether the data files in the bootstrap library are indeed
accessible with the data function.  It seems not.  If there was a
convention that files ending with .data in a data directory should be
read with read.table I think that would be great.  Actually I think it
would be "insanely great" if they were read with
 read.table(filename, header = TRUE)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Sep 18 15:52:31 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 18 Sep 1997 16:52:31 +0200
Subject: R-alpha: -- data files :  read.table(..., header=TRUE)  -- Yes!
In-Reply-To: <6ren6men84.fsf@franz.stat.wisc.edu> (message from Douglas Bates
 on 18 Sep 1997 09:00:11 -0500)
Message-ID: <199709181452.QAA19001@sophie.ethz.ch>

>>>>> "Doug" == Douglas Bates <bates@stat.wisc.edu> writes:

    Doug>  .....
    Doug> I can't find copies of those messages so I will summarize here.

sorry, once more.

    Doug> One of them was unimportant - simply an observation that the
    Doug> mis-typing of TITLE as TITLe in the documentation for the library
    Doug> function is intentional.  

yes! (it partly breaks the HTML version..)

But with the new Rd (man) style and its perl scripts, the problem is gone
anyway.

    Doug> The second was a query to Fritz with a
    Doug> copy to this list on whether the data files in the bootstrap
    Doug> library are indeed accessible with the data function.  It seems
    Doug> not.
This also has quite a bit changed in the current source.

As Kurt says, all the packages have to be updated though before they work
with the current directory structure.

    Doug> f there was a convention that files ending with .data in a
						          ~~~~~
    Doug> data directory should be read with read.table I think that would
    Doug> be great.
indeed!
Maybe we should have  '.dat'
in order  for the Win3.x  version to need less adaption for porting... 

    Doug> Actually I think it would be "insanely great" if they
    Doug> were read with read.table(filename, header = TRUE) 
			 -------------------  ##############
Yes again!

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Sep 18 21:59:10 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 19 Sep 1997 08:59:10 +1200 (NZST)
Subject: R-alpha: stuff
Message-ID: <199709182059.IAA23976@stat1.stat.auckland.ac.nz>

Peter,
  That's fine. I'm still not doing well on the computer front; 3 down/ 1 up;
  but things are supposed to change.....
  
  
  On Doug Bates comments about files with .data extensions; if these things
  are going to work under 3.1 I think we need to limit ourselves to 3 digit
  extensions. While I'm sure .dat is already taken I think it will be easier
  to work around that. Yes I could write perl scripts to do all the 
  transforming but it's a bit of a pain (especially since I can't even keep
  up with the other developments).
  
  
  robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From helgito@rhi.hi.is  Sun Sep 21 18:40:03 1997
From: helgito@rhi.hi.is (Helgi Tomasson)
Date: Sun, 21 Sep 1997 17:40:03 +0000 (GMT)
Subject: R-alpha: R-adventure
Message-ID: <199709211740.RAA17140@hengill.rhi.hi.is>

I am trying to port R to OS/2 and XFREE86.  I have XFREE86 for OS/2
up and running and a lot the unix utilities, sh, ksh, tcsh, awk sed etc.

I have not been able to make configure running.  I have therefore
patched the makefiles manually and gotten through most of them.
All in the src-directory except /src/main/makefile at the moment
the beginning of it looks like this:

CC=gcc
CFLAGS=-g -I../include
LDCMD=
DLLFLAGS=
PICFLAGS=
SHLIBLDFLAGS=
LIBS=-lf2c  -lm
X_CFLAGS=-I/xfree86/include
X_LIBS=-L/xfree86/lib -lX11
X_EXTRA_LIBS=
X_PRE_LIBS=
FC=g77

What should these flags be?  I have guessed in the other makefiles.
For example there is no ranlib so I use ar S, which seems to work.

I have been told by experts that I should also look out for

platform.h

How should that one be in my case.

I am using the GNU-EMX gcc compiler together with g77.

sincerely yours

Helgi Tomasson

-- 
Helgi Tomasson                                       FAX:  354-552-6806
University of Iceland                                PHONE:354-525-4571
Faculty of Economics and Business Administration     email:helgito@rhi.hi.is 
Oddi v/ Sturlugotu        
IS-101 Reykjavik
ICELAND
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Sep 22 12:37:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 22 Sep 1997 13:37:16 +0200
Subject: R-alpha: -- data files :  read.table(..., header=TRUE)  -- Yes!
In-Reply-To: <199709181452.QAA19001@sophie.ethz.ch>
References: <6ren6men84.fsf@franz.stat.wisc.edu>
 <199709181452.QAA19001@sophie.ethz.ch>
Message-ID: <199709221137.NAA18680@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Doug" == Douglas Bates <bates@stat.wisc.edu> writes:
Doug> .....
Doug> I can't find copies of those messages so I will summarize here.

> sorry, once more.

Doug> One of them was unimportant - simply an observation that the
Doug> mis-typing of TITLE as TITLe in the documentation for the library
Doug> function is intentional.  

> yes! (it partly breaks the HTML version..)

> But with the new Rd (man) style and its perl scripts, the problem is
> gone anyway.

Yes, definitely.

Doug> The second was a query to Fritz with a
Doug> copy to this list on whether the data files in the bootstrap
Doug> library are indeed accessible with the data function.  It seems
Doug> not.

> This also has quite a bit changed in the current source.

> As Kurt says, all the packages have to be updated though before they
> work with the current directory structure.

Again, this will change with the new version.  If a new-style package
has a `data' subdirectory, its contents are installed along with the R
objects, shared libraries and help files etc.  Loading the pkg makes
these data sets available as well.

FRITZ:  When you update your pkg, please make sure that the data get
into the update as well.

Doug> f there was a convention that files ending with .data in a
> 						          ~~~~~
Doug> data directory should be read with read.table I think that would
Doug> be great.
> indeed!
> Maybe we should have  '.dat'
> in order  for the Win3.x  version to need less adaption for porting... 

Doug> Actually I think it would be "insanely great" if they
Doug> were read with read.table(filename, header = TRUE) 
> 			 -------------------  ##############
> Yes again!

Simply from the extension?  Or perhaps we could have a ``magic'' first
line telling a generic `read' what to do?  (A similar logic could be
applied to e.g. reading in xbase files using a (still unwritten) pseudo
method read.dbf which would be called if the generic read figures out
that it is looking at a dbase file (and again, using the result of
file(1) may be the better idea ...)

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 22 13:04:47 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Sep 1997 14:04:47 +0200
Subject: R-alpha: x[NA]
Message-ID: <x2raahftb4.fsf@bush.kubism.ku.dk>

Just curious. Current logic in both R and Splus has

> (1:3)[c(T,F,NA)]
[1]  1 NA

Does anyone know *why*? It makes sense for integer indexing, but for
logicals it seems to have some strange consequences - if you divide a
dataframe according to some criterion, you get as many NA-filled
records as there are missing values of the criterion added to *both*
the group that satisfies the criterion and to those that do not.

One reason could be that since NA is logical by default, you would be
getting awkward consequences of the type x[NA] == real(0), but
x[c(NA,1)] == c(NA,5.3), but why is NA logical by default, then? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep 22 17:04:02 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 22 Sep 1997 09:04:02 -0700 (PDT)
Subject: R-alpha: x[NA]
In-Reply-To: <x2raahftb4.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970922085721.1161A-100000@troi>

On 22 Sep 1997, Peter Dalgaard BSA wrote:

> Just curious. Current logic in both R and Splus has
> 
> > (1:3)[c(T,F,NA)]
> [1]  1 NA
> 
<snip>
> One reason could be that since NA is logical by default, you would be
> getting awkward consequences of the type x[NA] == real(0), but
> x[c(NA,1)] == c(NA,5.3), but why is NA logical by default, then? 

The alternative would be worse.  If one element of the index is not
logical then the whole index is converted, so
R> x<-1:4 
R> x[c(F,T,F,T)]
[1] 2 4
R> x[c(F,T,F,NA)]
[1]  2 NA
but
R> x[c(F,T,F,4)]
[1] 1 4

That is, the presence of any NA would result in selecting only element
as.numeric(T)==1.

BTW, while you obviously can't mix logical and numerical references I
think it's unfortunate that you can't mix numeric and name-based
references like
R> names(x)<-letters[1:4]
R> x
a b c d 
1 2 3 4 
R> x[c("a",2)]
Error: subscript out of bounds

If you want a real example, suppose you had a model frame from which you
wanted to extract the response (in position 1) and the variables whose
names were in a vector nn
	mf[,c(1,nn)] 
appears to be the obvious solution.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ammann@utdallas.edu  Mon Sep 22 18:16:03 1997
From: ammann@utdallas.edu (Larry P Ammann)
Date: Mon, 22 Sep 1997 12:16:03 -0500 (CDT)
Subject: R-alpha: mtext
Message-ID: <199709221716.MAA13611@utdallas.edu>

Something seems to have broken mtext between the R-0.50-a1 and R-0.50-a4
releases. It prints OK when side=2 or 4, but does not print if side=1 or 3.
Try for example:

plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
for(s in 1:10) {
    mtext(paste("mtext(..,side=1, line=",-s,")"), side=1, line=-s)
    mtext(paste("mtext(..,side=2, line=",-s,")"), side=2, line=-s)
    mtext(paste("mtext(..,side=3, line=",-s,")"), side=3, line=-s)
    mtext(paste("mtext(..,side=4, line=",-s,")"), side=4, line=-s)
}

Larry P. Ammann
Professor of Statistics
University of Texas at Dallas
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 22 22:38:38 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 23 Sep 1997 09:38:38 +1200 (NZST)
Subject: R-alpha: mtext
Message-ID: <199709222138.JAA15965@stat1.stat.auckland.ac.nz>

Larry P Ammann <ammann@utdallas.edu> writes:

> Something seems to have broken mtext between the R-0.50-a1 and R-0.50-a4
> releases. It prints OK when side=2 or 4, but does not print if side=1 or 3.
> Try for example:

> plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
> for(s in 1:10) {
>     mtext(paste("mtext(..,side=1, line=",-s,")"), side=1, line=-s)
>     mtext(paste("mtext(..,side=2, line=",-s,")"), side=2, line=-s)
>     mtext(paste("mtext(..,side=3, line=",-s,")"), side=3, line=-s)
>     mtext(paste("mtext(..,side=4, line=",-s,")"), side=4, line=-s)
> }


Ahhh.  It looks like I need to change my test example from plot(1:10)
to plot(rnorm(10)) ...

Here is the fix:  In src/main/plot.c at about line 1180, you will
find the lines:

	if(!FINITE(at)) {
		switch(side % 2) {
		case 0:
			at = (1 - adjx) * GP->usr[0] + adjx * GP->usr[1];
			break;
		case 1:
			at = (1 - adjx) * GP->usr[2] + adjx * GP->usr[3];
			break;
		}
	}

the bodies of the cases need to be swapped.  I.e. it should read

	if(!FINITE(at)) {
		switch(side % 2) {
		case 0:
			at = (1 - adjx) * GP->usr[2] + adjx * GP->usr[3];
			break;
		case 1:
			at = (1 - adjx) * GP->usr[0] + adjx * GP->usr[1];
			break;
		}
	}

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 22 23:02:03 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Sep 1997 00:02:03 +0200
Subject: R-alpha: x[NA]
In-Reply-To: Thomas Lumley's message of Mon, 22 Sep 1997 09:04:02 -0700 (PDT)
References: <Pine.SUN.3.95.970922085721.1161A-100000@troi>
Message-ID: <x2wwk9j9d0.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> That is, the presence of any NA would result in selecting only element
> as.numeric(T)==1.

Aha... Of course that only applies when you enter logical vectors
using c(...), if they result from a comparison, then the type would be
logical NA anyway. So the problem is that c(...) converts to numeric
if just one element is.numeric() even if that element is NA. Hmm. I
suppose that could be handled differently by having c() explicitly
ignoring NA when deciding on type, but that probably leads to more
problems elsewhere?

> BTW, while you obviously can't mix logical and numerical references I
> think it's unfortunate that you can't mix numeric and name-based
> references like
> R> names(x)<-letters[1:4]
> R> x
> a b c d 
> 1 2 3 4 
> R> x[c("a",2)]
> Error: subscript out of bounds
> 
> If you want a real example, suppose you had a model frame from which you
> wanted to extract the response (in position 1) and the variables whose
> names were in a vector nn
> 	mf[,c(1,nn)] 
> appears to be the obvious solution.

I think that the possibility of setting names(x)<-4:1 will demonstrate
why that can't work... Besides, can you be sure that the dependent
variable is the first one in a model frame any more?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep 22 23:08:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 22 Sep 1997 15:08:54 -0700 (PDT)
Subject: R-alpha: x[NA]
In-Reply-To: <x2wwk9j9d0.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970922150648.2314B-100000@troi>

On 23 Sep 1997, Peter Dalgaard BSA wrote:

> 
> > BTW, while you obviously can't mix logical and numerical references I
> > think it's unfortunate that you can't mix numeric and name-based
> > references like
> > R> names(x)<-letters[1:4]
> > R> x
> > a b c d 
> > 1 2 3 4 
> > R> x[c("a",2)]
> > Error: subscript out of bounds
<snip> 
> I think that the possibility of setting names(x)<-4:1 will demonstrate
> why that can't work... Besides, can you be sure that the dependent
> variable is the first one in a model frame any more?
> 
Why?
R> x<-1:4
R> names(x)<-4:1
R> x[1]
4 
1 
R> x["1"]
1 
4 
So why not x[c(1,"1")] giving 1,4?


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Sep 23 10:13:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Sep 1997 11:13:23 +0200
Subject: R-alpha: x[NA]
In-Reply-To: Thomas Lumley's message of Mon, 22 Sep 1997 15:08:54 -0700 (PDT)
References: <Pine.SUN.3.95.970922150648.2314B-100000@troi>
Message-ID: <x2souwl7f0.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> On 23 Sep 1997, Peter Dalgaard BSA wrote:

> > I think that the possibility of setting names(x)<-4:1 will demonstrate
> > why that can't work... Besides, can you be sure that the dependent
> > variable is the first one in a model frame any more?
> > 
> Why?
> R> x<-1:4
> R> names(x)<-4:1
> R> x[1]
> 4 
> 1 
> R> x["1"]
> 1 
> 4 
> So why not x[c(1,"1")] giving 1,4?

Because 

> c(1,"1")
[1] "1" "1"

so we'd have to introduce mixed-type vectors first. However, I suppose
that one might make

> x[list(1,"1")]

work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Sep 23 14:33:07 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 23 Sep 1997 09:33:07 -0400
Subject: R-alpha: read.dbf
References: <6ren6men84.fsf@franz.stat.wisc.edu>
 <199709181452.QAA19001@sophie.ethz.ch> <199709221137.NAA18680@aragorn.ci.tuwien.ac.at>
Message-ID: <97Sep23.093520edt.26501@mailgate.bank-banque-canada.ca>

...
>applied to e.g. reading in xbase files using a (still unwritten) pseudo

>method read.dbf which would be called if the generic read figures out
...

If you're going to get into reading databases let me know. I've already
done a fair amount of work on this and have a working interface to Fame
time series databases (and any other database which can be made to
support a generic protocol I've been working on).

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Wed Sep 24 15:27:38 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 24 Sep 1997 10:27:38 -0400
Subject: R-alpha: Re: read.dbf
References: <6ren6men84.fsf@franz.stat.wisc.edu> <199709181452.QAA19001@sophie.ethz.ch> <199709221137.NAA18680@aragorn.ci.tuwien.ac.at> <97Sep23.093622edt.26510@mailgate.bank-banque-canada.ca> <199709241131.NAA06833@aragorn.ci.tuwien.ac.at>
Message-ID: <97Sep24.103023edt.26510@mailgate.bank-banque-canada.ca>

>> If you're going to get into reading databases let me know. I've
already
>> done a fair amount of work on this and have a working interface to
Fame
>> time series databases (and any other database which can be made to
>> support a generic protocol I've been working on).

>I probably won't have any time for this is the near future, but perhaps

>someone else will fill in ...
>Anyway, if there is more info about the `generic protocol' you
mentioned
>that you can easily make available, the please do so.

Kurt

There is a fair amount of information and example code available at
http://www.bank-banque-canada.ca/pgilbert
Follow the link to TSPADI.

There is a working server front end for the Fame time series database
software as well as a very simplistic file based "database" we made for
test purposes. There is also a client side interface for Splus and for a
"generic client" which is intended as an example and also for test
purposes. The version of the code on the web page needs a few minor
changes for R. I have done that and will soon make it available.

Please note that this is not a database protocol like SQL which allows
queries. The client must provide an identifier for an object and the
server simply returns the object.

The protocol uses RPC and has only been tested on TCP/IP  networks,
although I've been told RPC is available with some other networks. It
does work across the Internet. (It can also be run locally without a
network using loopback.)

An interesting project would be to write a wrapper (eg. in Perl) for
some of the data being provided as text formatted pages. Then a server
could be setup to provide the data with the PADI protocol so that it
could be used directly by application programs like R.  If anyone has
some bright student looking for something to do I can provide more
details.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 24 23:16:06 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 24 Sep 1997 17:16:06 -0500 (CDT)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) in 0.50a4
Message-ID: <m0xDzj4-000hrZC@franz.stat.wisc.edu>

To use Ron Ziegler's famous phrase, that argument is "no longer
operative".  The code for the bxp function, which is what is called to
actually do the plotting, has a section

  if (!is.null(width)) {
    if (length(width) != n | any(is.na(width)) | 
	any(width <= 0)) 
      stop("invalid boxplot widths")
    width <- 0.8 * width/max(width)
  }
  else if (varwidth) {
    width <- 0.8 * sqrt(z[[i]]$n/nmax)
  }
  if (n == 1) 
    width <- 0.4
  else width <- rep(0.8, n)

The effect of either an explicit "width" argument or a TRUE "varwidth"
argument is being overridden in the next statement.

Since the default value of "width" is NULL, I think this can be
repaired by replacing the last three lines shown there by

  if (is.null(width)) {
    if (n == 1)
      width <- 0.4
    else width <- rep(0.8, n)
  }

P.S. For those of you who don't know who Ron Ziegler was (which means
you are too young to remember Watergate), he was Richard Nixon's press
secretary.  When it was shown that a statement he had made to the
press the previous day was an outright lie he responded, "That
statement is no longer operative.".
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 24 23:33:07 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 24 Sep 1997 17:33:07 -0500 (CDT)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) - Take 2
Message-ID: <m0xDzzX-000hrZC@franz.stat.wisc.edu>

This piece of code may do a better job in bxp
  if (!is.null(width)) {
    if (length(width) != n | any(is.na(width)) | 
	any(width <= 0)) 
      stop("invalid boxplot widths")
    width <- 0.8 * width/max(width)
  }
  else if (varwidth) {
    width <- 0.8 * sqrt(unlist(lapply(z, "[[", "n"))/nmax)
  }
  else if (n == 1) {
      width <- 0.4
    }
  else width <- rep(0.8, n)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep 25 00:29:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 25 Sep 1997 11:29:35 +1200 (NZST)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) - Take 2
In-Reply-To: <m0xDzzX-000hrZC@franz.stat.wisc.edu>
References: <m0xDzzX-000hrZC@franz.stat.wisc.edu>
Message-ID: <199709242329.LAA21346@stat1.stat.auckland.ac.nz>

Douglas Bates writes:
 > This piece of code may do a better job in bxp

I have just committed both changes :-)
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Sep  1 14:12:51 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 1 Sep 1997 15:12:51 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
Message-ID: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>


--xk+LtGr+JJ
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Attached is a conversion script for converting current R doc files to
the proposed new format ... I'm not sure if it handles everything
correctly, as I made just some random checks. The main purpose for
posting the thing to the list is such that those interested can get a
look at the new format.

Of course there is no proper indentation ... so the generated files
look really ugly ...

The script can't handle nested math environments with 2 arguments
(like sub, sup, ...), but in the whole base library (580+ files) there
are only 6 containing those, so I thought it's easier to convert these
manually.


--xk+LtGr+JJ
Content-Type: text/enriched
Content-Disposition: inline;
	filename="convert.pl"
Content-Transfer-Encoding: 7bit

#!/usr/bin/perl

use Getopt::Long;

@knownoptions = ("debug|d");
GetOptions (@knownoptions) || die("Unknown Option!\n");

$max_parent = 0;
$NP = "normal_parent";
$PN = "parent_normal";
$EOP = "escaped_opening_parent";
$ECP = "escaped_closing_parent";
$ID = "$NP\\d+$PN";

undef $/;

$complete_text = <>;

print stderr "Marking Parantheses ... " if $opt_debug;

$text = mark_parents($complete_text);

print stderr "done\n" if $opt_debug;

print stderr "Searching logical blocks ... " if $opt_debug;

$text =~ /TITLE($ID)/;
$id = $1;
@args = get_two_args($id);
$text =~ s/TITLE$id(.*)$id/\\title\{$args[0]\}\{$args[1]\}/s;
$title = $args[0];

replace_command("USAGE", "usage");
replace_command("ARGUMENTS", "arguments");
replace_command("DESCRIPTION", "description");

if(($text =~ /VALUE$ID/) && ($text =~ /VALUES$ID/)){
    print stderr "Warning: Both VALUE and VALUES environment found!\n";
}
replace_command("VALUE", "value");
replace_command("VALUES", "value");

replace_command("REFERENCES", "references");
replace_command("SEEALSO", "seealso");
replace_command("EXAMPLES", "examples");
replace_command("NOTES", "notes");

replace_command_all("ALIAS", "alias");
replace_command_all("KEYWORD", "keyword");

while($text =~ /SECTION($ID)/){
    $id = $1;
    @args = get_two_args($id);
    if($args[0] =~ /author/i){
	$text =~ s/SECTION$id(.*)$id/\\author\{$args[1]\}/s;
    }
    else {
	$text =~ s/SECTION$id(.*)$id/\\section\{$args[0]\}\{$args[1]\}/s;
    }
}

print stderr "done\n" if $opt_debug;

print stderr "Parsing text commands ... " if $opt_debug;

$text =~ s/(\s*PARA\s*)+/\n\n/sg;
$text =~ s/(\s*BLANK\s*)+/\n\\blank\n/sg;


while($text =~ /ARG($ID)/){
    $id = $1;
    @args = get_two_args($id);
    $text =~ s/ARG$id(.*)$id/\\item\{$args[0]\}\{$args[1]\}/s;
}

replace_command_all("LANG", "code");
replace_command_all("BOLD", "textbf");
replace_command_all("EQBOLD", "mathbf");
replace_command_all("ITALIC", "emph");

replace_command_all("LINK", "link");

$text =~ s/LDOTS/\\ldots/g;
$text =~ s/DOTS/\\dots/g;


$text =~ s/%/\\%/sg;
$text =~ s/\$/\\\$/sg;

while($text =~ /COMMENT($ID)/){
    $id = $1;
    $text =~ s/COMMENT$id(.*)$id(\n?\s*)/I_FOUND_A_COMMENT/s;
    $comment = " % $1";
    $comment =~ s/\n/\n% /g;
    $comment = "$comment\n" unless ($comment =~ /\n\s*$/s);
    $text =~ s/I_FOUND_A_COMMENT/$comment/;
}

print stderr "done\n" if $opt_debug;
print stderr "Parsing math commands ... " if $opt_debug;



# Now for the math stuff ...

print stderr "args: 0 " if $opt_debug;

$text =~ s/(\s+)EQUALS(\s+)/$1=$2/sg;
$text =~ s/(\s+)LT(\s+)/$1<$2/sg;
$text =~ s/(\s+)GT(\s+)/$1>$2/sg;
$text =~ s/(\s+)LE(\s+)/$1\\le$2/sg;
$text =~ s/(\s+)GE(\s+)/$1\\ge$2/sg;
$text =~ s/(\s+)LOG(\s+)/$1\\log$2/sg;
$text =~ s/(\s+)EXP(\s+)/$1\\exp$2/sg;
$text =~ s/(\s+)SP(\s+)/$1~$2/sg;

$text =~ s/greekGamma/\\gamma/sg;
$text =~ s/greekalpha/\\alpha/sg;
$text =~ s/greekpi/\\pi/sg;
$text =~ s/greekmu/\\mu/sg;
$text =~ s/greeksigma/\\sigma/sg;
$text =~ s/greeklambda/\\lambda/sg;
$text =~ s/boldgreekbeta/\\mathbf\{\\beta\}/sg;
$text =~ s/boldgreekepsilon/\\mathbf\{\\epsilon\}/sg;

print stderr "1 " if $opt_debug;

replace_command_all("SQRT", "sqrt");
replace_command_all("DISPLAYSTYLE", "displaystyle");

while($text =~ /PAREN($ID)/){
    $id = $1;
    $text =~ s/PAREN$id(.*)$id/\\left($1\\right)/s;
}

print stderr "2 ... " if $opt_debug;

while(($text =~ /(SUP)($ID)/) ||
      ($text =~ /(SUB)($ID)/) ||
      ($text =~ /(OVER)($ID)/) ||
      ($text =~ /(CHOOSE)($ID)/)){
    
    my $cmd = $1;
    my $id = $2;
    
    if($text =~ /$id(.*@@.*@@.*)$id/s){
	die("\n$title: Nested math structures - convert equations manually!\n");
    }
    else{
	
	if($cmd =~ /OVER/){
	    @args = get_two_args($id);
	    $text =~ s/OVER$id(.*)$id/\\frac\{$args[0]\}\{$args[1]\}/s;
	}
	
	if($cmd =~ /SUP/){
	    @args = get_two_args($id);
	    $text =~ s/SUP$id(.*)$id/\{$args[0]\}^\{$args[1]\}/s;
	}
	
	if($cmd =~ /SUB/){
	    @args = get_two_args($id);
	    $text =~ s/SUB$id(.*)$id/\{$args[0]\}_\{$args[1]\}/s;
	}
	
	if($cmd =~ /CHOOSE/){
	    @args = get_two_args($id);
	    $text =~ s/CHOOSE$id(.*)$id/\{$args[0] \\choose $args[1]\}/s;
	    }
    }
}


print stderr "deqn ... " if $opt_debug;

while(($text =~ /DEQN($ID)/)){
    $id = $1;
    @args = get_two_args($id);
    $text =~ s/DEQN$id(.*)$id/\\deqn\{$args[0]\}\{$args[1]\}/s;
}

print stderr "eqn ... " if $opt_debug;

replace_command_all("EQN", "eqn");

print stderr "done\n" if $opt_debug;

print stderr "Unmarking parantheses ... " if $opt_debug;

$text = unmark_parents($text);

print stderr "done\n" if $opt_debug;

print $text;





# Mark each matching opening and closing parenthesis with a unique id.
# Idea and original code from latex2html
sub mark_parents {
    my $text = $_[0];
    $text =~ s/([^\\])\\\(/$1$EOP/gso;
    $text =~ s/([^\\])\\\)/$1$ECP/gso;
    
    while($text =~ /\(([^\(\)]*)\)/s){
	my $id = $NP . ++$max_parent . $PN;
	$text =~ s/\(([^\(\)]*)\)/$id$1$id/s;
    }
    $text =~ s/$EOP/\\(/gso;
    $text =~ s/$ECP/\\(/gso;
    
    $text;
}

sub unmark_parents {
    my $text = $_[0];

    while($text =~ /($NP\d+$PN)/s){
	$id = $1;
	$text =~ s/$id(.*)$id/($1)/s;
    }
    $text;
}


sub get_two_args {

    my $id = $_[0];
    
    $text =~ /$id(.*)$id/s;
    my $x = $1;
    $x =~ /\s*([^@]*)\s*@@\s*(.*)\s*/s;

    $arg1 = $1;
    $arg2 = $2;
    
    $arg1 =~ s/^\s*//s;
    $arg1 =~ s/\s*$//s;
    $arg2 =~ s/^\s*//s;
    $arg2 =~ s/\s*$//s;

    ($arg1, $arg2);
}
	

sub replace_command {

    my $cmd = $_[0];
    my $newcmd = $_[1];

    if($text =~ /$cmd($ID)/s){
	my $id = $1;
	$text =~ s/$cmd$id(.*)$id/\\$newcmd\{$1\}/s;
    }
}

sub replace_command_all {

    my $cmd = $_[0];
    my $newcmd = $_[1];

    while(($text =~ /$cmd$ID/)){
	replace_command($cmd, $newcmd);
    }
	
}


    

--xk+LtGr+JJ
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Best,
Fritz



--xk+LtGr+JJ--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep  1 16:28:08 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1997 17:28:08 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
In-Reply-To: Friedrich Leisch's message of Mon, 1 Sep 1997 15:12:51 +0200
References: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>
Message-ID: <x2oh6df3zr.fsf@bush.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> Attached is a conversion script for converting current R doc files to
> the proposed new format ... I'm not sure if it handles everything

Speaking of the docs, we really need to make sure that our HTML pages
pass weblint or similar checkers. I just tried it and found several
pieces of strangeness. Basically, what you get out is stuff like

$ weblint /home/sfe/pd/R/html/funs/density.html
/home/sfe/pd/R/html/funs/density.html(1): <HEAD> must immediately follow <HTML>
/home/sfe/pd/R/html/funs/density.html(1): outer tags should be <HTML> .. </HTML>.
/home/sfe/pd/R/html/funs/density.html(2): empty container element <A>.
/home/sfe/pd/R/html/funs/density.html(90): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(93): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(96): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(99): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(102): illegal context for <TR> - must appear in <TABLE> element.
/home/sfe/pd/R/html/funs/density.html(126): <XMP> is obsolete.
/home/sfe/pd/R/html/funs/density.html(133): unknown element <->.
/home/sfe/pd/R/html/funs/density.html(134): no closing </XMP> seen for <XMP> on line 126.

Here's what I found of obvious pieces of "fluff":

The whole page needs to be inside <HTML>..</HTML>
"<" symbols make trouble, even within <PRE> (use "&lt;")
<XMP> should not be used ("use <PRE>" seems to be the idea)
<TR>'s need to be surrounded by a <TABLE> environment

"<" within <PRE> gets formatted correctly by Netscape, but not by
lynx, so it isn't all just formalities.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep  1 21:01:45 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 1 Sep 1997 13:01:45 -0700 (PDT)
Subject: R-alpha: NCOL, NROW bug
In-Reply-To: <Pine.SUN.3.95.970901120907.10535B-100000@troi>
Message-ID: <Pine.SUN.3.95.970901125854.10535E-100000@troi>


NCOL and NROW don't work correctly on data frames or on arrays of
dimension greater than 2. They treat them as 1-dim vectors.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep  2 08:48:05 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 2 Sep 1997 09:48:05 +0200
Subject: R-alpha: Re: What are objects?
In-Reply-To: <199709011632.SAA18044@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 1 Sep 1997 18:32:33 +0200)
Message-ID: <199709020748.JAA00458@sophie.ethz.ch>

[I do think
  this discussion belongs to  R-devel  rather than anywhere else .. MM]


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Peter Dalgaard BSA writes:

    >> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
    KH>>>  While trying to write documentation for data.class(), I came
    KH>>> across the following in the help for class():
    KH>>> 
    KH>>> An R ``object'' is a data object which has a `class' attribute.
    KH>>> ...  LANG(is.object) returns LANG(TRUE) if its argument has a class
    KH>>> attribute and LANG(FALSE) otherwise.
    KH>>> 
    KH>>> Hmm ... I thought everything was an ``object''.  What is the right
    KH>>> way to refer to ``everything'' then?

    PD>> I agree, this is silly. Did we pick that one up from S, or can we
    PD>> fix it?

    Kurt> I'd say that this is an R&R decision, but I don't think we picked
    Kurt> it up from S.  In S, everything is an object.  Also, S does not
    Kurt> have the R is.object() which in fact is only used once ...

    PD>> Obviously, it makes much more sense to let an entity with no class
    PD>> attribute be an object of the default class. And having to
    PD>> distinguish between "data objects" that are objects and those that
    PD>> aren't is - um - confusing.

    Kurt> Right.

    Kurt> What we might do is distinguish (in terminology) between objects
    Kurt> and ``proper objects'' which are the ones with a class.
or ``class objects''.
Yes I think it's good idea to agree on terminology here.

    Kurt> As (correct me if I am wrong) eventually everything will have a
    Kurt> class (as in S4) everything will eventually be a proper object,
    Kurt> and data.class will be unnecessary.
[I do correct ..]
Hmm, I think that Ross recently said
that  R is NOT moving into the  S4 direction (of fully OO), really,
but rather emphasizes speed and compilation possibilities
	[[unfortunately, I can't find that email in my archives, now...]]

Ross?

    Kurt> Btw, would there be any problems in attaching corresponding class
    Kurt> attributes to at least

    Kurt> 	array matrix list

    Kurt> ???  (Martin, I need your strong YES PLEASE once more ...)  Would
    Kurt> this break anything?  The creator functions could simply attach
    Kurt> the attribs.

I actually have only voted for 'matrix' to be class
 (and 'Matrix' to be another class, inheriting from 'matrix' with just a
  different method for "[").
'array' would be ok, too (and one could think of 'Array' with the analogous
			  "[.Array" method as "[.Matrix")

I'm not so sure about the usefulness of a 'list' class.
Many objects are lists, internally anyway, and I want to access them as
lists sometimes, even if they have an(other) class.

Apropos 'matrix'  (an S / S-plus story) :
-------  ~~~~~~~
In the mean time, I've stumbled about this (again!) in S-plus:

There, 
	as.matrix.dataframe
returns a matrix with a class attribute 'matrix'
but
	as.matrix.default
does NOT
which is really ugly.

I think the 'deep' reason for this is the following:
Current S3 based S-plus still contains code with
	.S(...)
which I think is also known as "old S code".
Anyway, I know that functions using "old S code" are NOT allowed
to get arguments with class (or other "non-standard") attributes.

Therefore, in current S-plus, quite a few (more) things would break if all 
matrices were of class 'matrix'.
And this is probably the only reason why they don't have the class 'matrix'
everywhere.


    Kurt> (Does anyone know exactly what S4 does?)
			    -------
	how do you mean this?
         probably only John Chambers could say 'yes' to this....

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Sep  2 13:19:40 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 2 Sep 1997 14:19:40 +0200
Subject: R-alpha: Re: What are objects?
In-Reply-To: <199709020748.JAA00458@sophie.ethz.ch>
References: <199709011632.SAA18044@aragorn.ci.tuwien.ac.at>
 <199709020748.JAA00458@sophie.ethz.ch>
Message-ID: <199709021219.OAA27859@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> [I do think
>   this discussion belongs to  R-devel  rather than anywhere else .. MM]


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Peter Dalgaard BSA writes:

>>> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
KH> While trying to write documentation for data.class(), I came
KH> across the following in the help for class():
KH> 
KH> An R ``object'' is a data object which has a `class' attribute.
KH> ...  LANG(is.object) returns LANG(TRUE) if its argument has a class
KH> attribute and LANG(FALSE) otherwise.
KH> 
KH> Hmm ... I thought everything was an ``object''.  What is the right
KH> way to refer to ``everything'' then?

PD> I agree, this is silly. Did we pick that one up from S, or can we
PD> fix it?

Kurt> I'd say that this is an R&R decision, but I don't think we picked
Kurt> it up from S.  In S, everything is an object.  Also, S does not
Kurt> have the R is.object() which in fact is only used once ...

PD> Obviously, it makes much more sense to let an entity with no class
PD> attribute be an object of the default class. And having to
PD> distinguish between "data objects" that are objects and those that
PD> aren't is - um - confusing.

Kurt> Right.

Kurt> What we might do is distinguish (in terminology) between objects
Kurt> and ``proper objects'' which are the ones with a class.

> or ``class objects''.
> Yes I think it's good idea to agree on terminology here.

R&R?

Kurt> As (correct me if I am wrong) eventually everything will have a
Kurt> class (as in S4) everything will eventually be a proper object,
Kurt> and data.class will be unnecessary.

> [I do correct ..]
> Hmm, I think that Ross recently said
> that  R is NOT moving into the  S4 direction (of fully OO), really,
> but rather emphasizes speed and compilation possibilities
> 	[[unfortunately, I can't find that email in my archives, now...]]

> Ross?

Yes, that would be good to know ...

Kurt> Btw, would there be any problems in attaching corresponding class
Kurt> attributes to at least

Kurt> array matrix list

Kurt> ???  (Martin, I need your strong YES PLEASE once more ...)  Would
Kurt> this break anything?  The creator functions could simply attach
Kurt> the attribs.

> I actually have only voted for 'matrix' to be class
>  (and 'Matrix' to be another class, inheriting from 'matrix' with just a
>   different method for "[").
> 'array' would be ok, too (and one could think of 'Array' with the analogous
> 			  "[.Array" method as "[.Matrix")

> I'm not so sure about the usefulness of a 'list' class.  Many objects
> are lists, internally anyway, and I want to access them as lists
> sometimes, even if they have an(other) class.

O.k., forget about list.  Let us stay with matrix and array, then.

Kurt> (Does anyone know exactly what S4 does?)
> 			    -------
> 	how do you mean this?
>          probably only John Chambers could say 'yes' to this....

What about the happy pretesters, such as Doug?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Tue Sep  2 19:11:13 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 02 Sep 1997 13:11:13 -0500
Subject: R-alpha: R interaction within ESS-4.9-b11: two small issues
In-Reply-To: Anthony Rossini's message of 02 Sep 1997 10:53:11 -0400
References: <wncwwkzaht4.fsf@fhat.stat.sc.edu>
Message-ID: <6rrab760xq.fsf@franz.stat.wisc.edu>

1) I installed the latest ESS (Emacs Speaks Statistics) beta release
on a machine running Linux.  Since there is no S-PLUS product for
Linux, I set the ess-site.el file for R, xlisp-stat, and S version 4.
I.e.,
 ;; (1.5) Require the needed dialects for your setup.

 ;;(require 'essd-s+3)
 (require 'essd-r)
 (require 'essd-xls)
 ;;(require 'essd-sas)
 ;;(require 'essd-s3)  ;; You might not have this
 (require 'essd-s4)  ;; or this one...

That does not seem to work.  I believe that under the present
structure you must require essd-s+3 to get definitions of some
functions used by the other dialects.  Perhaps that dependency could
be removed at some time.

2) I think the current definitions
essd-r.el:61:    (ess-retr-lastvalue-command    . ".Last.value <- get(\"smode.lvsave\",envir=1)\n")
essd-r.el:62:    (ess-save-lastvalue-command    . "assign(\"smode.lvsave\",.Last.value,envir=1)\n")
may be misusing the "envir" argument.  I am getting messages in the
interaction window like
 > Error in get(x, envir, mode, inherits) : variable "smode.lvsave" was not found
If I try to use assign with envir = 1 at the top level I get an error message
 > assign("smode.lvsave", 12, envir = 1)
 Error: invalid envir argument

I haven't gone into debugging of the ESS code to find out if this what
is causing the problem.

Should the assign and get use "inherits = TRUE" instead of "envir=1"?
The R documentation is a bit vague about the use of the envir argument.

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Tue Sep  2 20:39:10 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 02 Sep 1997 15:39:10 -0400
Subject: R-alpha: R interaction within ESS-4.9-b11: two small issues
In-Reply-To: Douglas Bates's message of "02 Sep 1997 13:11:13 -0500"
References: <wncwwkzaht4.fsf@fhat.stat.sc.edu> <6rrab760xq.fsf@franz.stat.wisc.edu>
Message-ID: <wncrab7a4kh.fsf@fhat.stat.sc.edu>


>>>>> "Douglas" == Douglas Bates <bates@stat.wisc.edu> writes:

    Douglas> 1) I installed the latest ESS (Emacs Speaks Statistics)
    Douglas>    beta release
    Douglas> on a machine running Linux.  Since there is no S-PLUS product for
    Douglas> Linux, I set the ess-site.el file for R, xlisp-stat, and S version 4.
    Douglas> I.e.,
    Douglas>  ;; (1.5) Require the needed dialects for your setup.

    Douglas>  ;;(require 'essd-s+3)
    Douglas>  (require 'essd-r)
    Douglas>  (require 'essd-xls)
    Douglas>  ;;(require 'essd-sas)
    Douglas>  ;;(require 'essd-s3)  ;; You might not have this
    Douglas>  (require 'essd-s4)  ;; or this one...

    Douglas> That does not seem to work.  I believe that under the
    Douglas> present structure you must require essd-s+3 to get
    Douglas> definitions of some functions used by the other dialects.
    Douglas> Perhaps that dependency could be removed at some time.

I just did.  Sorry (changed for beta-12, to release Friday).  I've
moved the basic formatting into essl-s.el (ESS, Languages in the S
family), which is required by essd-s3, essd-s4, essd-s+3,essd-s+3...

    Douglas> 2) I think the current definitions

    Douglas> essd-r.el:61:    (ess-retr-lastvalue-command
    Douglas> . ".Last.value <- get(\"smode.lvsave\",envir=1)\n") 
    Douglas> essd-r.el:62:    (ess-save-lastvalue-command
    Douglas> . "assign(\"smode.lvsave\",.Last.value,envir=1)\n") 

    Douglas> may be misusing the "envir" argument.  I am getting
    Douglas> messages in the interaction window like

    >> Error in get(x, envir, mode, inherits) : variable
    >> "smode.lvsave" was not found 

    Douglas> If I try to use assign with envir = 1 at the top level I
    Douglas> get an error message

    >> assign("smode.lvsave", 12, envir = 1)

    Douglas>  Error: invalid envir argument

    Douglas> I haven't gone into debugging of the ESS code to find out
    Douglas> if this what is causing the problem.

    Douglas> Should the assign and get use "inherits = TRUE" instead
    Douglas> of "envir=1"?  The R documentation is a bit vague about
    Douglas> the use of the envir argument.

This is a bit more important.  I've not yet found an acceptable work
around (well, Kurt H. said he could provide a hacked solution soon).

I'm still hunting for suggestions...

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep  3 17:13:16 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 3 Sep 1997 18:13:16 +0200
Subject: R-alpha: speed of  sort(.) and order(.)
Message-ID: <199709031613.SAA01385@sophie.ethz.ch>

sort() and order() are not quite the same, as "one knows":

 o  order allows breaking ties by more than one argument;
 o  sort  allows a 'partial' and 'na.last' argument

Still, the following timing (on a `simple' UltraSparc I)
suggest that actually two different algorithms are used

> N <- 10000
> typeof(x0 <- 1:N) # --- x0 : already sorted ---
[1] "integer"
> typeof(x  <- sample(N))
[1] "integer"
> CPU <- numeric(10)

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) sort(x0))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.070   1.080   1.080   1.137   1.217   1.240 

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) order(x0))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.900   1.000   1.035   1.012   1.047   1.070 

'order' is slightly faster for an already sorted vector
	(this seems consistent for further examples, 
	  not statistically significant for these 10..)


> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) sort(x))[1]
> summary(CPU)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.700   1.720   1.735   1.765   1.827   1.870 

> for(j in 1:10) CPU[j] <- unix.time(for(i in 1:20) order(x))[1]
> summary(CPU)
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  3.000   3.100   3.140   3.181   3.227   3.540 
>

which makes 'sort' almost a factor of 2  FASTER for an unsorted 'x'.

Any comments from the coders  (R & R) ?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep  3 23:26:46 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 4 Sep 1997 10:26:46 +1200 (NZST)
Subject: R-alpha: speed of  sort(.) and order(.)
In-Reply-To: <199709031613.SAA01385@sophie.ethz.ch>
References: <199709031613.SAA01385@sophie.ethz.ch>
Message-ID: <199709032226.KAA22616@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
[ stuff on sorting  which I leave out ]

 > which makes 'sort' almost a factor of 2  FASTER for an unsorted 'x'.
 > 
 > Any comments from the coders  (R & R) ?

I wasn't there, I hardly knew the woman and anyway it wasn't my dog :-).

Well, I didn't look closely at the code, but as I recall both "sort"
and "order" use a shellsort recomended by Sedgewick (he says only
true sorting gurus like him should attempt quicksort and that mortals
like me should stick with shellsort).

It does look odd.  When I get a moment I will dig deeper.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Sep  4 09:52:24 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 4 Sep 1997 10:52:24 +0200
Subject: R-alpha: inconsistency R/Splus of sample()
Message-ID: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>


The function sample has different behaviour under R and Splus when
called with zero sample size:

R> x<-rnorm(10)
R> sample(x,0)
Error in sample(length(x), size, replace) : invalid second argument

Splus> x<-rnorm(10)
Splus> sample(x,0)
numeric(0)


IMO the Splus behaviour makes more sense, because it returns the
requested `sample' of size 0.

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep  4 21:39:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 5 Sep 1997 08:39:05 +1200 (NZST)
Subject: R-alpha: Sorting Efficiency
Message-ID: <199709042039.IAA12844@stat1.stat.auckland.ac.nz>

As part of checking Martin Maechler's observations of sorting
efficiency I have been putting the code under the microscope.  Part of
this involved comparing the performance with Splus. I turns out that
the R code is much slower.  A good deal of this is due to the
interpreted front end to the R verion of sort.  It is worth taking
a look at the sort function and seeing if you can see what the
problem is.  (hint: turn on GC reporting with "gcinfo").

A good deal of the rest of the inefficiency is because the internal R
code attempts to deal with missing observations.  This is no longer
needed because this is dealt with in the interpreted front end.

An overall fix of the code should see us nearly match the performance
of Splus.  I say nearly because I think I will use heapsort instead of
quicksort because I want to avoid worst-case performance rather than
seek good average performance.

I don't yet have an explanation of the behavior which Martin uncovered.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep  4 23:44:51 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 5 Sep 1997 10:44:51 +1200 (NZST)
Subject: R-alpha: inconsistency R/Splus of sample()
In-Reply-To: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>
References: <199709040852.KAA01531@galadriel.ci.tuwien.ac.at>
Message-ID: <199709042244.KAA18311@stat1.stat.auckland.ac.nz>

Friedrich Leisch writes:
 > 
 > The function sample has different behaviour under R and Splus when
 > called with zero sample size:
 > 
 > R> x<-rnorm(10)
 > R> sample(x,0)
 > Error in sample(length(x), size, replace) : invalid second argument
 > 
 > Splus> x<-rnorm(10)
 > Splus> sample(x,0)
 > numeric(0)
 > 
 > 
 > IMO the Splus behaviour makes more sense, because it returns the
 > requested `sample' of size 0.

Done.  (A one character change).
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep  5 09:32:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Sep 1997 10:32:32 +0200
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: <199709042039.IAA12844@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 5 Sep 1997 08:39:05 +1200 (NZST))
Message-ID: <199709050832.KAA04356@sophie.ethz.ch>

Since you are delving into the code anyway....
Here is a thought that I have been having for a long time:

Wouldn't it make sense / be useful  to have a function 	is.sorted
which returns TRUE   if  all(diff(x) >= 0).	        ---------

I actually have been using the function

	is.sorted <- function(x) (length(x) <= 1) || all(diff(x) >= 0)

in my collection of S-plus enhancements for quite while now.

I can do things as

	if(!is.sorted(x)) {
		o <- order(x)
		x <- x[o]
		y <- y[o]
	}
		
which potentially saves computing time (over unconditional 'order'),
since
1.	        is.sorted  is  O(n)
    whereas	sort       is  O(n*log(n)) 
2. for sorted x, the two assignments are superfluous even when order(x) was
   very fast (for SORTED x). 

TO be CPU-efficient, is.sorted  probably should be written .Internal(.).

On the other hand,  sort(.) and order(.)  could be designed such that they
use a sorting algorithm which guarantees to be fast when things are already
sorted. [maybe this is already the case,
	 and one of your reasons against quicksort? ]
This would make the 'if(..)' in  
	if(!is.sorted(x)) x <- sort(x)
superfluous, but the situation with order(.) above
(which is NOT infrequent in statistics !!) would still profit from not
doing  'x <- x[1:length(x)]' when x is sorted.

--
Opinions?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 15:48:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 16:48:24 +0200
Subject: R-alpha: GLM (from R-core)
Message-ID: <x2bu27vmtj.fsf@bush.kubism.ku.dk>

As some of you may know, there has been formed a "core team" of
developers, who can dig directly into the R source at Auckland and fix
bugs etc., in order to speed up development. There is a mailing list
for that group. This is necessary, because some of the bugs discussed
are not publicly available (and hopefully will never be!), but one
potential risk of the structure is that we forget about R-devel. One
recent case was this:

I discovered that summary.glm was calculating "t" statistics (est./SE)
correctly in the case were the dispersion parameter of the GLM is
fixed, but referring it to a t distribution with the residual DF. This
is wrong, badly so in the case of tabular data.

This is just a bug, but then Thomas Lumley added:

"We should also allow the df to be specified as an argument to
summary.glm(). The gaussian case is the only one where there is a real
honest t-distribution and in other cases the user should be free to use
other values of the df that might improve the approximation.  This is
particularly true when the user specifies the dispersion, as then we have
no idea what df is appropriate."

That kind of topic is about "policy" as opposed to bugfixing and
codewriting, and - as Martin Maechler pointed out - there are people
on R-devel who have broad experience in GLMs and may want to
contribute to the discussion. 

Also other things with GLMs are debatable, e.g. whether it is always
correct to use the weighted RSS and not the deviance for the
dispersion estimate.

(The fixed-dispersion bug is fixed in the current sources, using the
simple logic that if the dispersion in not estimated from the RSS, we
use the normal distribution (or "infinite df" if you like))


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 16:02:10 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 17:02:10 +0200
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: Martin Maechler's message of Fri, 5 Sep 1997 10:32:32 +0200
References: <199709050832.KAA04356@sophie.ethz.ch>
Message-ID: <x2afhrvm6l.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> since
> 1.	        is.sorted  is  O(n)
>     whereas	sort       is  O(n*log(n)) 
> 2. for sorted x, the two assignments are superfluous even when order(x) was
>    very fast (for SORTED x). 

Actually, if it's a Shell sort, it's O(n^1.5) worst case and O(n^1.27)
average. For O(n log n) average you need quicksort or heapsort. The
former has the draw back of O(n^2) worst case, but heapsort has quite
a good reputation and is unconditionally n log n (that info comes from
Numerical Recipes, which was the best could dig out at the moment).
Maybe we should switch?

> superfluous, but the situation with order(.) above
> (which is NOT infrequent in statistics !!) would still profit from not
> doing  'x <- x[1:length(x)]' when x is sorted.

Yes.. Of course the case is often that you *know* that things are
sorted (because you just did it yourself), but modularity prevents you
from getting that information to the spot where it is needed.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep  5 16:04:22 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Sep 1997 17:04:22 +0200
Subject: R-alpha: Sorting Efficiency -- A bit of humour...
In-Reply-To: Martin Maechler's message of Fri, 5 Sep 1997 10:32:32 +0200
References: <199709050832.KAA04356@sophie.ethz.ch>
Message-ID: <x290xbvm2x.fsf@bush.kubism.ku.dk>

Apropos sorting, I stumbled across this one a moment ago:

From: rjd4@cam.ac.uk (Bob Dowling)
Subject: Re: Sorting algorithms (was Re: Whoo hoo)
Newsgroups: alt.sysadmin.recovery
Date: 5 Sep 1997 09:19:21 GMT

This talk of sorting algorithms brings me back to one of my favourite interview
questions, designed to see if the candidate is on the ball.

"Sketch out a program that takes a random permutation of the numbers from 1 to
1000 and prints them in order."

Any mention of sorting algorithms is regarded as a "fail" on this question, of
course.
- - 
Bob Dowling:       UNIX Support, University of Cambridge Computing Service,
rjd4@cam.ac.uk     New Museums Site, Pembroke Street, Cambridge, UK.  CB2 3QG.
+44 1223 334728    http://www-uxsup.csx.cam.ac.uk/
-------- Those who do not learn from Dilbert are doomed to repeat it. --------


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Fri Sep  5 16:06:59 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 05 Sep 1997 11:06:59 -0400
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: Peter Dalgaard BSA's message of "05 Sep 1997 17:02:10 +0200"
References: <199709050832.KAA04356@sophie.ethz.ch> <x2afhrvm6l.fsf@bush.kubism.ku.dk>
Message-ID: <wnchgbzer58.fsf@fhat.stat.sc.edu>



Well, since it seems that number of algorithms have been implemented,
how about keeping them and having a:

	sort( x, algorithm="....")

call?  (I'm only quasi-serious this morning).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Fri Sep  5 16:40:42 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 5 Sep 1997 10:40:42 -0500 (CDT)
Subject: R-alpha: Sorting Efficiency -- thoughts.. : if(!is.sorted(x)) x <- sort(x)
In-Reply-To: <x2afhrvm6l.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Sep 5, 97 05:02:10 pm
Message-ID: <9709051540.AA09189@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > since
> > 1.	        is.sorted  is  O(n)
> >     whereas	sort       is  O(n*log(n)) 
> > 2. for sorted x, the two assignments are superfluous even when order(x) was
> >    very fast (for SORTED x). 
> 
> Actually, if it's a Shell sort, it's O(n^1.5) worst case and O(n^1.27)
> average. For O(n log n) average you need quicksort or heapsort. The
> former has the draw back of O(n^2) worst case, but heapsort has quite
> a good reputation and is unconditionally n log n (that info comes from
> Numerical Recipes, which was the best could dig out at the moment).
> Maybe we should switch?
> 

Merge sort is also an option. It is O(n log(n)) worst case but with a
better constant than heapsort, as I recall, and a bit easier to
implement.  Its drawback in general is O(n) additional space needed,
which is prohibitive if you are sorting in place. But since R copies
anyway, that isn't an issue. (Don't name any internal routines
mergesort though -- there are a number of systems that include one in
their libraries and cause name conflicts).

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Sep  5 17:23:36 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 5 Sep 1997 09:23:36 -0700 (PDT)
Subject: R-alpha: sorting in plots
In-Reply-To: <x2afhrvm6l.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970905091611.14804A-100000@troi>


The sorting discussion reminds me of another feature I wanted in lines()
(and in plot.default). 
	lines(x,y,sorted=T)
equivalent to 
	lines(x[order(x)],y[order(x)])
but still giving the correct information to identify()


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Sun Sep  7 16:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 7 Sep 1997 17:23:47 +0200
Subject: R-alpha: R `make install-*'
Message-ID: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at>

Ross mentioned last week that it would be nice to eventually have a real
`make install'.  As a preparation, we should perhaps rename the current

	install-help install-latex install-html

targets to

	help latex [or dvi???] html

and perhaps

	test-Examples

to

	test

I can of course make the changes, but I thought I'd ask for a good new
name for the corresponding scripts in RHOME/etc.  Maybe

	etc/build-help

etc?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Sun Sep  7 16:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 7 Sep 1997 17:23:47 +0200
Subject: R-alpha: naming convention for index files
Message-ID: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at>

In the process of moving to the new directory structure, we might also
reconsider the naming of the various index files.

A simple idea would be to have an `INDEX' file in each directory where
this is appropriate.  E.g., we could have

	pkg/funs/INDEX		(rather than help/pkg/INDEX)
	pkg/data/INDEX		(rather than index.doc)
	pkg/help/INDEX		(rather than AnIndex)

or e.g.

	pkg/INDEX.funs
	pkg/INDEX.data

etc.

The package TITLE files would be used for building the package index of
a library tree (LibIndex?)

In any case, the `plain' indices to be displayed upon calling an
appropriate form of help() could contain MORE than simply a list of
things.  I.e., more like a README.

My idea is (assuming only RHOME is in .lib.loc):

	R> library()

	`RHOME' is the location of the default R library tree.
	Blah blah blah ...

	Packages in `RHOME':

	base		The basic package.
	eda		...
	mva		...

The last lines could be generated from the packages' TITLE files.  The
other info from some stub, perhaps LibIndex.in?

As usual, any feedback is appreciated.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Sep  7 18:25:11 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Sep 1997 19:25:11 +0200
Subject: R-alpha: R `make install-*'
In-Reply-To: Kurt Hornik's message of Sun, 7 Sep 1997 17:23:47 +0200
References: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at>
Message-ID: <x2pvqlf348.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> Ross mentioned last week that it would be nice to eventually have a real
> `make install'.

..speaking of which, we should remember to rename the INSTALL file in
$RHOME. Prevents 'make install' on case-inhibited operating systems
("install is up to date"...!).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Sep  8 14:25:08 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 8 Sep 1997 15:25:08 +0200
Subject: R-alpha: old Rdoc 2 new Rdoc
In-Reply-To: <x2oh6df3zr.fsf@bush.kubism.ku.dk>
References: <199709011312.PAA03979@galadriel.ci.tuwien.ac.at>
 <x2oh6df3zr.fsf@bush.kubism.ku.dk>
Message-ID: <199709081325.PAA04403@galadriel.ci.tuwien.ac.at>

>>>>> On 01 Sep 1997 17:28:08 +0200,
>>>>> Peter Dalgaard BSA (PDB) wrote:

PDB> Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
>> Attached is a conversion script for converting current R doc files to
>> the proposed new format ... I'm not sure if it handles everything

PDB> Speaking of the docs, we really need to make sure that our HTML pages
PDB> pass weblint or similar checkers. I just tried it and found several
PDB> pieces of strangeness. Basically, what you get out is stuff like

PDB> $ weblint /home/sfe/pd/R/html/funs/density.html
PDB> /home/sfe/pd/R/html/funs/density.html(1): <HEAD> must immediately follow <HTML>
PDB> /home/sfe/pd/R/html/funs/density.html(1): outer tags should be <HTML> .. </HTML>.
PDB> /home/sfe/pd/R/html/funs/density.html(2): empty container element <A>.
PDB> /home/sfe/pd/R/html/funs/density.html(90): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(93): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(96): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(99): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(102): illegal context for <TR> - must appear in <TABLE> element.
PDB> /home/sfe/pd/R/html/funs/density.html(126): <XMP> is obsolete.
PDB> /home/sfe/pd/R/html/funs/density.html(133): unknown element <->.
PDB> /home/sfe/pd/R/html/funs/density.html(134): no closing </XMP> seen for <XMP> on line 126.

PDB> Here's what I found of obvious pieces of "fluff":

PDB> The whole page needs to be inside <HTML>..</HTML>
PDB> "<" symbols make trouble, even within <PRE> (use "&lt;")
PDB> <XMP> should not be used ("use <PRE>" seems to be the idea)
PDB> <TR>'s need to be surrounded by a <TABLE> environment

PDB> "<" within <PRE> gets formatted correctly by Netscape, but not by
PDB> lynx, so it isn't all just formalities.

I agree totally that we should stick with the HTML standards.

The new conversion script is almost ready and currently in
`alpha-testing' by Martin and Kurt. I've checked its output with
weblint and on the HTML pages of the whole base library all I get are
only minor warnings:

attach.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
chisquare.test.html(36): empty container element <P>.
detach.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
ls.diag.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
ls.print.html(1): The HTML spec. recommends the TITLE be no longer than 64 characters.
t.test.html(84): empty container element <P>.


which cannot be avoided without considerable effort or side effects ...
e.g., every browser that cannot handle long tiles will truncate them
anyway, so I see no purpose in doing this myself. But we can include
it as a recommendation that the title of a doc file is no longer than
64 characters (that makes sense anyway for the INDEX files etc.)



best,
fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 15:21:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 16:21:56 +0200
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: <199709042117.JAA16853@stat1.stat.auckland.ac.nz> (message from
 Robert Gentleman on Fri, 5 Sep 1997 09:17:50 +1200 (NZST))
Message-ID: <199709081421.QAA00979@sophie.ethz.ch>

[[yet another discussion brought from  R-core  to  R-devel]]

>>>>> "RG" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

    RG> Peter, there is some code for line types and widths in all the
    RG> drivers. With windows there is the well known limitation that you
    RG> can't have patterened lines with lwd larger than 1 (unless you
    RG> write your own routines ....  I just haven't had time). I do agree
    RG> that there is something very weird going on with our code though!
   
    RG>    I think that in plot(1:4,lwd=2) the lwd should have absolutely
    RG> no effect. I think it's a bug in Splus that it does. For example,
    RG> plot(1:4,col="red")

I agree, and I also have been hating this (Splus) behavior.

I do prefer R's behavior have different 'col', 'cex', 'font' for
axis, labs, and points/lines.

After reading PD's reply to this message, I agree that
"lwd" is somewhat different:
	If your device has too thin lines in general, it is nice if you can
	increase line width  GLOBALLY.
The same for "cex": 
	There are situations where ALL text and plotting characters should
	just be made bigger with the same zoom factor.

Below, you (RG) mention the use of   par(lwd=...)
{and correspondingly would be    par(cex=...)}.

Is this going to be ``the standard'':

	For global changes of  linewidth or character size,
	one must use  par(lwd=..) or  par(cex=..) 
?

    RG>     gives you everything in red; axes, labels, lines and
    RG> points. That's wrong.  In plot(1:4,type="l",lwd=2) lwd should
    RG> affect the width of the line joining the points but not the width
    RG> of the lines for the bounding box (IMHO).

I agree, but again, it might be nice if there was something like a 
"global.lwd".
    
    RG>     I think that if you want to change the line widths on the
    RG> bounding box you should use par(lwd=2) and then all lines are
    RG> changed. This seems to work (but I don't doubt there are bugs; we
    RG> simply have never had the chance to exercise everything).

    RG>     As for character expansion- par cex seems to be the only route
    RG> (which makes me like my suggestion even more).
    
    RG>     Opinions?  It would be easy enough to mimic S but I do think
    RG> it's wrong.

We should not mimic S here, sometimes.
I agree it's wrong in some places.

But if you use a different scheme, it should be
	- well documented
	- very consequently implemented   ==>  easily remembered by users

-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Sep  8 15:36:24 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 8 Sep 1997 10:36:24 -0400 (EDT)
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: <199709081421.QAA00979@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970908103318.15321A-100000@paca>


  I agree with the gist of the discussion here ("par(lwd)" to change lwd
globally, otherwise it just affects lines).  One detail worth thinking
about is that a global linewidth change in PostScript (setlinewidth) will
also affect the linewidths used, e.g., in drawing plotting characters
(which could get very ugly as a result).

  I'm glad to see folks are working on lwd; in my (alpha-2) version of R
linewidth is mostly not implemented, and I was wondering whether I should
dig in and work on it or whether I should wait 'til the prophesied Big
Changes in the graphics code happened and the dust settled ...  (For now,
I've just been hacking the postscript _post facto_.)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep  8 16:27:45 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 8 Sep 1997 11:27:45 -0400
Subject: R-alpha: not mimic S
Message-ID: <97Sep8.112911edt.26517@mailgate.bank-banque-canada.ca>

> We should not mimic S here, sometimes.
> I agree it's wrong in some places.

> But if you use a different scheme, it should be
>         - well documented
>         - very consequently implemented   ==>  easily remembered by
users

One way to deal with improvements which force incompatabilities with S
is to layer the code so that application programmers use a consistent
upper layer which in turn calls lower layers of S or R code. This does
not solve problems with existing code but does give a way for new
applications to be developed for both environments. It may not be
possible to always achieve the same results, especially when
improvements mean some capabilities are not in one system, but it can be
possible to make the application work and just not provide some features
in one environment.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep  8 16:37:20 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 08 Sep 1997 17:37:20 +0200
Subject: R-alpha: Re: lwd, cex and par(.) issues [was "... windows quirks .."]
In-Reply-To: Ben Bolker's message of Mon, 8 Sep 1997 10:36:24 -0400 (EDT)
References: <Pine.SUN.3.95.970908103318.15321A-100000@paca>
Message-ID: <x27mcr24wf.fsf@bush.kubism.ku.dk>

Ben Bolker <ben@eno.Princeton.EDU> writes:

>   I agree with the gist of the discussion here ("par(lwd)" to change lwd
> globally, otherwise it just affects lines).  One detail worth thinking
> about is that a global linewidth change in PostScript (setlinewidth) will
> also affect the linewidths used, e.g., in drawing plotting characters
> (which could get very ugly as a result).

Hm. After seeing the W95 plots on a 600dpi laser, I tend to say that
the above *is* the desired behaviour. The default plotting circles
were hardly visible at all. A global lwd setting should set the
natural (i.e. neither fat nor barely visible) line width for a plot. 
Another question is whether one should set a *relative* width unit
(like SAS's 'goptions lfactor=...'), so that all lines are made
fatter - or thinner.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 16:56:15 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 17:56:15 +0200
Subject: R-alpha: naming convention for index files
In-Reply-To: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Sun, 7 Sep 1997 17:23:47 +0200)
Message-ID: <199709081556.RAA01060@sophie.ethz.ch>


    KH> In the process of moving to the new directory structure, we might also
    KH> reconsider the naming of the various index files.

    KH> A simple idea would be to have an `INDEX' file in each directory where
    KH> this is appropriate.  E.g., we could have

    KH> pkg/funs/INDEX		(rather than help/pkg/INDEX)

but  help/base/INDEX  is autogenerated
where as everything in ./funs/  (or /R/  as you propose later)  is  SOURCE

    KH> pkg/data/INDEX		(rather than index.doc)
index.doc is source

    KH> pkg/help/INDEX		(rather than AnIndex)
this is auto-generated again...

--
in summary, we could well say   INDEX  instead of different names,
but I don't think we should  autogenerate a file in a directory
where there's only source  (other than the 'Makefile'; Lib... files that
			    configure generates, and which are not needed
			    anymore after installation)

Remember: 

	The big idea is still that after

		make install + install-help + ..
			(just after all the installation)

	you should be able to
	REMOVE the full  ./src/  tree and still have a completely 
	working R (including online help, ...).


    KH> or e.g.

    KH> pkg/INDEX.funs
    KH> pkg/INDEX.data

    KH> etc.

    KH> The package TITLE files would be used for building the package index of
    KH> a library tree (LibIndex?)

very good idea

    KH> In any case, the `plain' indices to be displayed upon calling an
    KH> appropriate form of help() could contain MORE than simply a list of
    KH> things.  I.e., more like a README.

    KH> My idea is (assuming only RHOME is in .lib.loc):

    KH> library()

    KH> `RHOME' is the location of the default R library tree.
    KH> Blah blah blah ...

    KH> Packages in `RHOME':

    KH> base		The basic package.
    KH> eda		...
    KH> mva		...

    KH> The last lines could be generated from the packages' TITLE files.  The
    KH> other info from some stub, perhaps LibIndex.in?

very good idea

    KH> As usual, any feedback is appreciated.

as usual, I give you some ... ;-)

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  8 17:00:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 8 Sep 1997 18:00:01 +0200
Subject: R-alpha: R `make install-*'
In-Reply-To: <199709071523.RAA22173@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Sun, 7 Sep 1997 17:23:47 +0200)
Message-ID: <199709081600.SAA01071@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Ross mentioned last week that it would be nice to eventually have
    Kurt> a real `make install'.  As a preparation, we should perhaps
    Kurt> rename the current

    Kurt> 	install-help install-latex install-html

    Kurt> targets to

    Kurt> 	help latex [or dvi???] html

    Kurt> and perhaps

    Kurt> 	test-Examples
    Kurt> to
    Kurt> 	test
no!
You can make it shorter, but my idea still is that there should be a whole
collection of tests where `running all the help-Examples' is just one of them.

    Kurt> I can of course make the changes, but I thought I'd ask for a good new
    Kurt> name for the corresponding scripts in RHOME/etc.  Maybe

    Kurt> etc/build-help

    Kurt> etc?

yes, this sounds better
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Sep  8 08:48:19 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 08 Sep 1997 09:48:19 +0200 (MET DST)
Subject: R-alpha: Assingment to list or vector elements
Message-ID: <XFMail.970908104926.plummer@iarc.fr>

When you assign a value to an object which exists in some database on
the search list, R creates a copy in the current environment. However,
if the object is a list or vector, and you assign a new value to one of
its elements, a copy is not made and the assignment fails (with no error
message!).  This behaviour is incompatible with S-PLUS, which will make
a copy of the object before modifying one of its elements.

Martyn

> exists("alist", 1, inherits=F)
[1] FALSE
> mydata <- list(alist = list(one=1,two=1))
> attach(mydata)
> alist
$one
[1] 1

$two
[1] 1

> alist$one <- 2
> alist[[2]] <- 3
> alist
$one
[1] 1

$two
[1] 1

> exists("alist", 1, inherits=F)
[1] FALSE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Sep  8 09:52:40 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 08 Sep 1997 10:52:40 +0200 (MET DST)
Subject: R-alpha: deparse bug
Message-ID: <XFMail.970908115419.plummer@iarc.fr>

The deparse function has an argument "width.cutoff" which allows you
to set the width at which line breaking is attempted.  However, setting
this argument _permanently_ changes the line break width.

Looking at the source code ($RHOME/src/main/deparse.c), I see that the
width.cutoff argument sets the static variable "cutoff".  Although the
function do_deparse behaves correctly - overwriting cutoff with the
default value if not given a second argument -  other R functions (such
as print and edit) call deparse1 which doesn't do this. Hence they use
the modified cutoff value.

A quick fix would be to get do_deparse to reset cutoff to the default
value after calling deparse1 but before returning.

Martyn

> #Use function trunc as an example
> #This normally prints on two lines
> trunc
function (x) 
ifelse(x < 0, ceiling(x), floor(x))
> #Now deparse with narrow cutoff
> deparse(trunc,20)
[1] "function (x) "             
[2] "ifelse(x < 0, ceiling(x), "
[3] "        floor(x))"         
> #Cutoff 20 is used next time you print anything
> trunc
function (x) 
ifelse(x < 0, ceiling(x), 
        floor(x))
> #Cutoff is reset to default when you call
> #deparse without width.cutoff argument
> deparse(trunc)
[1] "function (x) "                      
[2] "ifelse(x < 0, ceiling(x), floor(x))"
> #Default cutoff (60) is now used when you print
> trunc
function (x) 
ifelse(x < 0, ceiling(x), floor(x))
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep 10 02:00:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 10 Sep 1997 13:00:42 +1200 (NZST)
Subject: R-alpha: New Version Available
Message-ID: <199709100100.NAA08817@stat1.stat.auckland.ac.nz>

The newest version of R for Unix (version R-0.50-a4) is now (or will
soon be) available from the following sites.

    NORTH AMERICA:
	http://lib.stat.cmu.edu/R/Alpha

    EUROPE:
        ftp://ftp.stat.math.ethz.ch/R/
        ftp://statlab.uni-heidelberg.de/pub/mirrors/auckland/R/

    JAPAN:
        ftp://ftp.u-aizu.ac.jp/pub/lang/R/

    NEW ZEALAND:
        ftp://stat.auckland.ac.nz/pub/R/

Please obtain a copy from site close to you.  Note that New Zealand
is not close to anywhere other than itself :-).

This is a quick snapshot release of the current source tree which is
intended to bring users up to date with the current state of
development.  We are just about embark on some substantial changes
which may take a while to complete, so this seems like a good time to
put out a release.

This is still not the promised "R-0.50 stable", but it is getting closer.

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Sep 10 15:53:58 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 10 Sep 1997 10:53:58 -0400
Subject: R-alpha: New Version Available
In-Reply-To: Ross Ihaka's message of "Wed, 10 Sep 1997 13:00:42 +1200 (NZST)"
References: <199709100100.NAA08817@stat1.stat.auckland.ac.nz>
Message-ID: <wnc7mcpb4op.fsf@fhat.stat.sc.edu>


>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version R-0.50-a4) is now
    Ross> (or will soon be) available from the following sites.

    Ross>     NORTH AMERICA:
    Ross> 	http://lib.stat.cmu.edu/R/Alpha

It's there.

Compiled and seems to run on Solaris 2.5 (SS 20/50).  

Small problem -- in compiling hclust, it couldn't find my f2c.h files,
and bombed.  

My solution -- move f2c.h to the include directory in the unpacked
distribution directory.  (I also moved libf2c.a to the lib directory,
but I don't think it was needed there?).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Sep 10 17:40:15 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Sep 1997 18:40:15 +0200
Subject: R-alpha: hist()
Message-ID: <x2vi096s27.fsf@bush.kubism.ku.dk>


If you try hist(rnorm(100),lwd=2) with a recent snapshot, you get the
exact opposite effect of what was earlier argued to be desirable in
plots: you get fat axes and thin bar outlines. The cause is plain to
see, at the end of 'hist':

        title(main = main, xlab = xlab, ylab = ylab, ...)
        if (axes) {
                axis(1, ...)
                axis(2, ...)
        }
        rect(breaks[-length(breaks)], 0, breaks[-1], counts, 
                col = col, border = border)

The ...'s are doing it, obviously. So the fix would be to remove ...
from axis() and add it to rect().

However, this example is having me worried that it wasn't a good idea
to depart from the S rule of *always* passing graphical parameters to
lower level routines. For instance, I don't think you would want a
font change *not* passed on to title(), would you? Then what *is*
changeable matter in a plot, really?

The thing that I'm afraid of is that it will become a can of worms to
keep track of which parameters are passed on to what routines. Not to
mention the fact that the ... parameter is essentially indivisible: it
is, to say the least, difficult to pass only some of the parameters.

Cc-ed to R-devel. I think we need to discuss this more broadly.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Sep 10 22:26:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 10 Sep 1997 14:26:18 -0700 (PDT)
Subject: R-alpha: model.frame
In-Reply-To: <x2vi096s27.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970910141237.4854E-100000@troi>

model.frame(,data=foo) requires foo to be a data.frame in R-0.50-a4.
Previously, and in S, a list is sufficient.

A fix is to add
        if (!is.data.frame(data) & !is.null(data)) 
                data <- as.data.frame(data)
before the first line of terms.formula




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 10 23:03:04 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 10 Sep 1997 17:03:04 -0500
Subject: R-alpha: model.matrix misbehaves on two-sided formulas
Message-ID: <6rsovchlnr.fsf@franz.stat.wisc.edu>

I am using R for a graduate class on linear models that I teach.  I
sent the class a sample transcript of explicit construction of the
model matrix and use of the QR decomposition.  One of the members of
the class picked up on the fact that the model matrix was not what I
advertised that it should be when a two-sided formula is used.  A
one-sided formula works properly.  For example,
 > library(st849)          # loads data sets from the text
 > e1.1
       density speed
  [1,]    20.4  38.8
  [2,]    27.4  31.5
  [3,]   106.2  10.6
  [4,]    80.4  16.1
  [5,]   141.3   7.7
  [6,]   130.9   8.3
  [7,]   121.7   8.5
  [8,]   106.5  11.1
  [9,]   130.5   8.6
 [10,]   101.1  11.1
 [11,]   123.9   9.8
 [12,]   144.2   7.8
 [13,]    29.5  31.8
 [14,]    30.8  31.6
 [15,]    26.5  34.0
 [16,]    35.7  28.9
 [17,]    30.0  28.8
 [18,]   106.2  10.5
 [19,]    97.0  12.3
 [20,]    90.1  13.2
 [21,]   106.7  11.4
 [22,]    99.3  11.2
 [23,]   107.2  10.3
 [24,]   109.1  11.4
 > class(e1.1)
 [1] "data.frame"
 > model.matrix(~density, data = e1.1)  # what we would expect
       (Intercept) density
  [1,]           1    20.4
  [2,]           1    27.4
  [3,]           1   106.2
  [4,]           1    80.4
  [5,]           1   141.3
  [6,]           1   130.9
  [7,]           1   121.7
  [8,]           1   106.5
  [9,]           1   130.5
 [10,]           1   101.1
 [11,]           1   123.9
 [12,]           1   144.2
 [13,]           1    29.5
 [14,]           1    30.8
 [15,]           1    26.5
 [16,]           1    35.7
 [17,]           1    30.0
 [18,]           1   106.2
 [19,]           1    97.0
 [20,]           1    90.1
 [21,]           1   106.7
 [22,]           1    99.3
 [23,]           1   107.2
 [24,]           1   109.1
 attr(,"assign")
 [1] 0 1
 > model.matrix(sqrt(speed) ~ density, data = e1.1) # not what we want
       (Intercept) density
  [1,]           1    38.8
  [2,]           1    31.5
  [3,]           1    10.6
  [4,]           1    16.1
  [5,]           1     7.7
  [6,]           1     8.3
  [7,]           1     8.5
  [8,]           1    11.1
  [9,]           1     8.6
 [10,]           1    11.1
 [11,]           1     9.8
 [12,]           1     7.8
 [13,]           1    31.8
 [14,]           1    31.6
 [15,]           1    34.0
 [16,]           1    28.9
 [17,]           1    28.8
 [18,]           1    10.5
 [19,]           1    12.3
 [20,]           1    13.2
 [21,]           1    11.4
 [22,]           1    11.2
 [23,]           1    10.3
 [24,]           1    11.4
 attr(,"assign")
 [1] 0 1

I think that somewhere along the line an expression like
 eval(form[[2]], data)
is being used when it would be better to use
 eval(form[[length(form)]], data)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Sep 10 23:15:46 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 10 Sep 1997 15:15:46 -0700 (PDT)
Subject: R-alpha: model.matrix misbehaves on two-sided formulas
In-Reply-To: <6rsovchlnr.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.SUN.3.95.970910150548.4854J-100000@troi>

On 10 Sep 1997, Douglas Bates wrote:

> I am using R for a graduate class on linear models that I teach.  I
> sent the class a sample transcript of explicit construction of the
> model matrix and use of the QR decomposition.  One of the members of
> the class picked up on the fact that the model matrix was not what I
> advertised that it should be when a two-sided formula is used.  A
> one-sided formula works properly.  For example,
>  > library(st849)          # loads data sets from the text
>  > e1.1
>        density speed
>   [1,]    20.4  38.8
>  > model.matrix(~density, data = e1.1)  # what we would expect
>        (Intercept) density
>   [1,]           1    20.4
>   [2,]           1    27.4
>  > model.matrix(sqrt(speed) ~ density, data = e1.1) # not what we want
>        (Intercept) density
>   [1,]           1    38.8
>   [2,]           1    31.5
> 
> I think that somewhere along the line an expression like
>  eval(form[[2]], data)
> is being used when it would be better to use
>  eval(form[[length(form)]], data)

No, it's worse than that.  For versions of R up to 0.50-a4, the new alpha
release, model.matrix(formula,dataframe) assumes that its data argument
was generated by
	dataframe<-model.frame(formula,data)
It does *not* check the names or order of the columns. This means that
model.matrix(formula, some.data.frame) will usually give the wrong answer.

In R0.50-a4 this is fixed.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From paul@stat.auckland.ac.nz  Thu Sep 11 02:28:47 1997
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Thu, 11 Sep 1997 13:28:47 +1200 (NZST)
Subject: R-alpha: Mathematical Annotation in R (plots)
In-Reply-To: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
References: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
Message-ID: <199709110128.NAA17794@stat1.stat.auckland.ac.nz>

	[[ this has first bounced to me as 'list-manager', because the
	   subject said  ``Returned mail: User unknown''
	   Paul, I assume you'd approve the subject I've chosen...
	   -- Martin M 
	]]

 hi
 
 for those who are interested ...
 
 the following is a LaTeX document which describes the current state of
 mathematical expression syntax in R
 
 paul
 
 ------CUT HERE---------------------------------------------
 
 \documentstyle{article}
 \begin{document}
 
 \section*{Documentation for \\
 Mathematical Annotation in $R$}
 
 If the {\tt text} argument to one of the text-drawing functions ({\tt
 text}, {\tt mtext}, {\tt axis}) in $R$ is an expression, the argument
 is interpreted as a mathematical expression and the output will be
 formatted according to \TeX -like rules.
 
 A mathematical expression must obey the normal rules of syntax for
 any $R$ expression, but it is interpreted according to very
 different rules than for normal $R$ expressions.  
 
 \begin{description}
 \item[binary operators]  addition, subtraction, multiplication, and
 division use the standard $R$ syntax, although multiplication only
 juxtaposes the arguments.  For example, {\tt a+b}, {\tt a-b}, and {\tt
 a/b}, produce $a+b$, $a-b$, and $a/b$, but {\tt a*b} produces $ab$.
 
 \item[unary operators]  positive and negative numbers are specified
 with standard syntax.  For example, {\tt +x} produces $+x$ and {\tt
 -y} produces $-y$.
 
 \item[subscripts and superscripts]  a subscript is specified
 using the subsetting syntax and a superscript is specified using 
 the power syntax.  For example, {\tt x[i]} produces
 $x_i$ and {\tt x\^{}2} produces $x^2$. 
 
 \item[accents] accented expressions are specified using the special
 mathematical functions {\tt hat} and {\tt bar}.  For example, {\tt
 hat(x)} produces $\hat x$ and {\tt bar(x)} produces $\bar x$.
 
 \item[fractions] fractions are specified using the special
 mathematical function {\tt over}. For example, {\tt over(1,2)}
 produces $1\over2$.
 
 \item[relations]  equality or assignment of terms is specified using
 the {\tt ==} relation.  For example, {\tt x == y} produces $x=y$.
 
 \item[visible grouping]  terms are visibly grouped by placing them
 within parentheses.  For example, {\tt (x+y)} produces $(x+y)$.
 
 \item[invisible grouping]  terms are invisibly grouped by placing
 them within curly braces. For example {\tt x\^{}\{2*y\}} produces
 $x^{2y}$, whereas {\tt x\^{}2*y} produces $x^2y$.
 
 \item[big operators]  a sum, product, or integral is specified using
 the special mathematical function of the corresponding name.  Each
 of these functions takes three arguments;  the first indicates what
 is being summed/multiplied/integrated and the second and third specify
 the limits of the summation/product/integral.  For example, {\tt
 sum(x[i], i==0, n)} produces $\sum\limits_{i=0}^n x_i$.
 
 \item[radicals]  a square root expression is specified using the
 special mathematical functions {\tt root} and {\tt sqrt}.  For
 example, {\tt sqrt(x)} produces $\sqrt x$.
 
 \item[absolute values]  an absolute term is specified using the
 special mathematical function {\tt abs}.  For example, {\tt abs(x)}
 produces $\left|x\right|$.
 
 \item[juxtaposition]  multiple terms are juxtaposed using the special
 mathematical function {\tt paste}.  For example, {\tt paste(over(b,
 2), y, sum(x))} produces ${b\over2} y \sum x$.
 
 \item[typeface changes]  the default font in mathematical expressions
 is italic (except for terms which are symbols).  A new typeface is
 specified using the special mathematical functions {\tt bold}, {\tt
 italic}, {\tt plain}, and {\tt bolditalic}.  For example, {\tt
 plain(X)[i]} produces ${\rm X}_i$. These font specifications do not
 accumulate (i.e., {\tt bold(italic(x)))} produces $x$ (an italic "x"),
 whereas {\tt bolditalic(x)} produces \textit{\textbf{x}} (a bold, italic "x").
 
 \item[general expressions]  any functional expression which is not a
 special mathematical function is simply reproduced as a function
 expression.  For example, {\tt foo(x)} produces $foo(x)$.
 
 
 \end{description}
 
 \end{document}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep 11 11:22:58 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Sep 1997 12:22:58 +0200
Subject: R-alpha: Mathematical Annotation in R (plots)
In-Reply-To: <199709110128.NAA17794@stat1.stat.auckland.ac.nz>
References: <199709110124.NAB17727@stat1.stat.auckland.ac.nz>
 <199709110128.NAA17794@stat1.stat.auckland.ac.nz>
Message-ID: <199709111022.MAA24424@aragorn.ci.tuwien.ac.at>

>>>>> Paul Murrell writes:

> 	[[ this has first bounced to me as 'list-manager', because the
> 	   subject said  ``Returned mail: User unknown''
> 	   Paul, I assume you'd approve the subject I've chosen...
> 	   -- Martin M 
> 	]]

>  hi
 
>  for those who are interested ...
 
>  the following is a LaTeX document which describes the current state of
>  mathematical expression syntax in R

very nice!

Martin, can we include this in the R Base Manual?  (i.e. in Man.tex)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep 11 12:19:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Sep 1997 13:19:07 +0200
Subject: R-alpha: naming convention for index files
In-Reply-To: <199709081556.RAA01060@sophie.ethz.ch>
References: <199709071523.RAA22168@aragorn.ci.tuwien.ac.at>
 <199709081556.RAA01060@sophie.ethz.ch>
Message-ID: <199709111119.NAA28447@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

KH> In the process of moving to the new directory structure, we might also
KH> reconsider the naming of the various index files.

KH> A simple idea would be to have an `INDEX' file in each directory where
KH> this is appropriate.  E.g., we could have

KH> pkg/funs/INDEX		(rather than help/pkg/INDEX)

> but  help/base/INDEX  is autogenerated
> where as everything in ./funs/  (or /R/  as you propose later)  is  SOURCE

KH> pkg/data/INDEX		(rather than index.doc)
> index.doc is source

KH> pkg/help/INDEX		(rather than AnIndex)
> this is auto-generated again...

> --
> in summary, we could well say   INDEX  instead of different names,
> but I don't think we should  autogenerate a file in a directory
> where there's only source  (other than the 'Makefile'; Lib... files that
> 			    configure generates, and which are not needed
> 			    anymore after installation)

> Remember: 

> 	The big idea is still that after

> 		make install + install-help + ..
> 			(just after all the installation)

> 	you should be able to
> 	REMOVE the full  ./src/  tree and still have a completely 
> 	working R (including online help, ...).


KH> or e.g.

KH> pkg/INDEX.funs
KH> pkg/INDEX.data

KH> etc.

KH> The package TITLE files would be used for building the package index of
KH> a library tree (LibIndex?)

> very good idea

KH> In any case, the `plain' indices to be displayed upon calling an
KH> appropriate form of help() could contain MORE than simply a list of
KH> things.  I.e., more like a README.

KH> My idea is (assuming only RHOME is in .lib.loc):

KH> library()

KH> `RHOME' is the location of the default R library tree.
KH> Blah blah blah ...

KH> Packages in `RHOME':

KH> base		The basic package.
KH> eda		...
KH> mva		...

KH> The last lines could be generated from the packages' TITLE files.  The
KH> other info from some stub, perhaps LibIndex.in?

> very good idea

KH> As usual, any feedback is appreciated.

> as usual, I give you some ... ;-)

Yes, Martin, what would I do without you?

You are right, of course, there should be some distinction between the
static and the dynamic (automatically generated) index files.

I think we need to distinguish two things.  On the one hand, we need
some short (a one-liner as in TITLE) and some long ``documentation'' on
a package.  The long one could be sort of like the README files which
come with certain S add-ons (and typically list the user-level objects
in the pkg).

If we ask for information about a package, the long one is what we
should get, I think.

On the other hand, it is clearly useful to have lists of R objects and
data sets a package provides.  These are the INDEX files.  But these
could also be auto-generated upon installation from the man sources.
In fact, as we also need them in HTML (and maybe in LaTeX), there is
not too much use for prebuilt ones ...

So, what shall we do about the indices?  As I already said, I think that
the documentation for data should be converted to the new Rd format and
merged with the R object documentation (same name space etc).  

Clearly, we should have a list of data somewhere, so that we can quickly
list all data sets.  Hmmm ... I guess I am not entirely sure what to do.

Library `info' should be o.k.:  we create the LibIndex from a README
like file and the TITLE files of all packages in the lib.

***

For the time being, I will not change anything.  (Unless we have a real
breakthough ...)

In the new dir structure, should the INDEX and TITLE files be installed
to $lib/$pkg or its help subdir?  They make sense outside of help ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 12 11:09:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 12 Sep 1997 12:09:08 +0200
Subject: R-alpha: bug in passing of empty  (...)
Message-ID: <199709121009.MAA01186@sophie.ethz.ch>

This is too bad (and an old bug at least since 0.49); 
it also breaks some code I have been using in S-plus:

> tst <- function(...) ls(...)

> tst()#--- should really give the same as ls() !!
character(0)

> ls()
  [1] "%in%"                   "As.integer"             "Dir"                   
  [4] "Dir0"                   "Fn12"                   "Slynx"                 
  ......
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Sep 12 11:46:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Sep 1997 12:46:35 +0200
Subject: R-alpha: bug in passing of empty  (...)
In-Reply-To: Martin Maechler's message of Fri, 12 Sep 1997 12:09:08 +0200
References: <199709121009.MAA01186@sophie.ethz.ch>
Message-ID: <x2wwkmstbo.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> This is too bad (and an old bug at least since 0.49); 
> it also breaks some code I have been using in S-plus:
> 
> > tst <- function(...) ls(...)
> 
> > tst()#--- should really give the same as ls() !!
> character(0)
> 
> > ls()
>   [1] "%in%"                   "As.integer"             "Dir"                   
>   [4] "Dir0"                   "Fn12"                   "Slynx"                 
>   ......

I don't know whether it's a bug or a feature, but it has nothing to do
with (...)

> tst<-function()ls()
> tst()
character(0)
> ls()
 [1] "NextMethod" "airquality" "dig"        "grid"       "l"         
 [6] "tst"        "umach"      "x"          "xmin"       "y"         
[11] "z"          ""       
> tst<-function(...){x<-5;ls(...)}  
> tst()
[1] "x"
> tst<-function(){x<-5;ls()}
> tst()
[1] "x"

I'm rather suspecting that pos=-1 in the argument list to ls should
have been pos=1. Anyone have the big picture on pos and envir?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Sep 12 18:00:17 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 12 Sep 1997 10:00:17 -0700 (PDT)
Subject: R-alpha: long term wishes
In-Reply-To: <6rsovchlnr.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.SUN.3.95.970912093350.7444C-100000@troi>


I have two difficult but not impossible suggestions for long-term
improvements to memory handling in R.

The first is in foreign function calling.  It would sometimes save a lot
of time if you could designate arguments to to .C/.Fortran as input or
output only (like Fortran 90 INTENT IN/OUT descriptions).  At the moment
every argument to foreign code is copied into a non-relocatable area, then
copied back into a new R variable.  If a variable was INTENT IN, it would
not be copied back, and that element of the return value would be NULL; if
a variable was INTENT OUT it would not be copied in and R would just
malloc() the correct amount of space in the non-relocatable area.  I've
been writing quite a bit of C code that turns huge matrices into small
ones, involving a lot of memory movement that could easily be removed.
The default would have to still be copying everything, for backwards
compatibility and idiotproofing.

The second, more difficult suggestion, is to do something other than stop
when memory is exhausted.  It doesn't matter if what you do is slow, as
the alternative is complete failure.  It should be possible for R to try
and grab a bigger chunk of memory (perhaps 50-100% bigger) and move into
it.  The relocatable part of the heap wouldn't be a big problem but the
non-relocatable part would need to be kept where it was and a new one
started.  On the other hand, this probably requires rewriting a whole
bunch of stuff and might be very painful.


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sat Sep 13 02:20:43 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 13 Sep 1997 13:20:43 +1200 (NZST)
Subject: R-alpha: bug in passing of empty  (...)
Message-ID: <199709130120.NAA21321@stat1.stat.auckland.ac.nz>

This is a "feature" of ls().  When invoked with no arguments it returns
the list of variables \emph{in the environment it is called from}.
This is to make it useful in conjunction with debug() and browser().
It allows you find out what the current local variables are.

To get the same effect as a top level ls(), you must expicitly do
	ls(pos=1)             # may fail if we allow attaching at pos=1
	ls(envir=.GlobalEnv)  # safer

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Sat Sep 13 13:55:24 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 13 Sep 1997 07:55:24 -0500
Subject: R-alpha: ${RHOME}/configure and f2c.h
Message-ID: <6r202txtj7.fsf@franz.stat.wisc.edu>

Installing R-0.50a4 on some of our systems I found that the mva
library doesn't build because the include file f2c.h is not available.

 make[3]: Entering directory `/afs/cs.wisc.edu/unsup/R-0.50alpha4/src/library/mva/src-c'
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c dblcen.c 
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c dist.c 
 gcc -g -fpic -I/afs/cs.wisc.edu/unsup/R-0.50alpha4/include   -c hclust.c 
 hclust.c:6: f2c.h: No such file or directory
 make[3]: *** [hclust.o] Error 1

Is it possible to search for this in the configure script?  I'm not
sure what to suggest to the installer if it is not available.  Is the
information used sufficiently well-defined that a replacement could be
generated on the fly?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Sep 13 20:04:51 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 13 Sep 1997 12:04:51 -0700 (PDT)
Subject: R-alpha: compatibility
In-Reply-To: <199709131524.RAA03703@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970913115858.557A-100000@troi>


Two compatibility issues found while trying to convert a simulation from S
to R.

1. set.seed()  We don't have this function.  According to Venables &
Ripley it just picks a seed from a list of 1000 possibilities. How about
"set.seed" <-function (i) 
{
        if (any(i > 1000) | any(i < 1)) 
                stop("argument to set.seed() must be in 1:1000")
        if (any(i != trunc(i))) 
                stop("argument to set.seed()must be an integer")
        .Random.seed <<- as.integer((200 * c(i, i^2, i^3))%%c(30269, 
                30307, 30323))
}


2. lapply() in S-PLUS works on vectors, ie
lapply(X, FUN) works like lapply(as.list(X),FUN) orsapply(X,FUN,simplify=F)


	-thomas



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 07:33:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 08:33:23 +0200
Subject: R-alpha: predict.lm -- who ..?
Message-ID: <199709150633.IAA00396@sophie.ethz.ch>

Just a short reminder / question --

We've had one posting 
>> Date: Sun, 17 Aug 1997 19:51:20 -0700
>> From: Kung-Sik Chan <kchan@stat.uiowa.edu>
>> To: r-help@stat.math.ethz.ch
>> Subject: R-beta: bug report

with a  predict.default  that would "work" with (some) lm objects, 
and I think it was said that  predict.lm  "is being" written
(Peter Dalgaard, Ross Ihaka ?)
because it was urgently needed.

We haven't seen any code posting since, and I just wondered about the
current state of the affair.

Maybe some  predict.lm(.) could be posted in order to be discussed and
polished ...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 09:29:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 10:29:37 +0200
Subject: R-alpha: is.vector(.., mode=..) bug  (old)
Message-ID: <199709150829.KAA04259@sophie.ethz.ch>

It is clear, I think, that
	is.vector(o, mode = "any")
should be  TRUE  whenever any of
	is.vector(o, mode = "<something>")
is TRUE.

This is not yet the case, however, see below.

Consider the following examples  which should be self-explaining.
Besides the above bug, they also show you that -- for S compatibility --
the  mode argument should really use strings as returned by 'mode(.)';
Currently it uses strings as returned by 'typeof(.)',
 see the definition of mode (written in R) which uses typeof(.) [among others].

[[and I've added the following useful EXAMPLE to the  man page of 'mode' 
	 src/library/base/man/mode :

     cex3 <- c("1","1:1","1i","list(1)","args","lm","formals(lm)[[2]]","y~x")
     lex3 <- sapply(cex3, function(x) eval(parse(text=x)))
     mex3 <- t(sapply(lex3, function(x) c(typeof(x), storage.mode(x), mode(x))))
     dimnames(mex3) <- list(cex3, c("typeof(.)","mode(.)","storage.mode(.)"))
     mex3

]]


## Here is my test code revealing the  is.vector(..) problems :

### Ex. 1  --- call ---
cl <- call("lm",y~x)
is.call(cl)# TRUE
mode(cl)  # "call" (S & R);	#__R:  typeof(cl) == "language"

is.vector(cl, mode = "any")      #R: FALSE, S: TRUE
is.vector(cl, mode = "call")     #R: FALSE  S: TRUE
is.vector(cl, mode = "language") #R: TRUE   S: FALSE

### Ex. 2  --- symbol ---
fo <- formula( y ~ x )
mode(fo)  # "call" (S & R)	#__R: typeof(fo) == "language"
is.call(fo)# TRUE  (S & R)
is.name(fo)# FALSE (S & R)

fo1 <- fo[1][[1]]
fo1 # `~'
mode(fo1)  # "name" (S & R)	#__R: typeof(fo1) == "symbol"
is.call(fo1)# FALSE (S & R)
is.name(fo1)# TRUE  (S & R)

is.vector(fo1, mode = "any")    #R: FALSE, S: TRUE
is.vector(fo1, mode = "name")   #R: FALSE, S: TRUE
is.vector(fo1, mode = "symbol") #R: TRUE,  S: FALSE

-----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 10:20:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 11:20:54 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Martin Maechler's message of Mon, 15 Sep 1997 08:33:23 +0200
References: <199709150633.IAA00396@sophie.ethz.ch>
Message-ID: <x2afhf0w7d.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> Just a short reminder / question --
> 
> We've had one posting 
> >> Date: Sun, 17 Aug 1997 19:51:20 -0700
> >> From: Kung-Sik Chan <kchan@stat.uiowa.edu>
> >> To: r-help@stat.math.ethz.ch
> >> Subject: R-beta: bug report
> 
> with a  predict.default  that would "work" with (some) lm objects, 
> and I think it was said that  predict.lm  "is being" written
> (Peter Dalgaard, Ross Ihaka ?)
> because it was urgently needed.
> 
> We haven't seen any code posting since, and I just wondered about the
> current state of the affair.
> 
> Maybe some  predict.lm(.) could be posted in order to be discussed and
> polished ...

I think Ross has the version that is closest to the real thing...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 15 11:16:26 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 15 Sep 1997 22:16:26 +1200 (NZST)
Subject: R-alpha: predict.lm -- who ..?
Message-ID: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>

Here is my (incomplete) version. This will work for full-rank models,
and I suspect also for singular models (the comment is just a reminder
to myself that I was thinking about this).

I set out to change the underlying structure so that case names
would be propagated through to to the fitted values.  This doesn't
happen at the moment because they are not handled within "model.matrix".
A quick fix would be to replace dimnames(x) below by row.names(mf).

There is no computation of standard errors below, but the present
version has something like the right computation.

Sorry that this is just a hint, but I'm really under pressure at
present.  Anyone got any (applied) exam questions on linear models
or glms handy?
	Ross
	

predict.lm <-
function (fit, newdata) 
{
	mf <- model.frame(formula(fit), data = newdata)
	# recreate the design matrix
	x <- model.matrix(terms(fit), mf)
	# grab the coefficients (order is correct?)
	b <- coef(fit)
	b[is.na(b)] <- 0
	# compute predictions
	p <- x %*% b
	# attach name information
	if(is.matrix(b)) {
		dimnames(p) <- list(dimnames(x)[[1]], dimnames(b)[[2]])
	}
	else {
		p <- as.vector(p)
		names(p) <- dimnames(x)[[1]]
	}
	p
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 15 14:48:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 15 Sep 1997 15:48:09 +0200
Subject: R-alpha: set.seed(.) [was 'compatibility']
Message-ID: <199709151348.PAA04532@sophie.ethz.ch>


>>>>> Thomas Lumley writes:
    >> Two compatibility issues found while trying to convert a simulation
    >> from S to R.

    >> 1. set.seed()  We don't have this function.  According to Venables &
    >> Ripley it just picks a seed from a list of 1000 possibilities. How about
    >>
    >> "set.seed" <-function (i) 
    >> {
    >>         if (any(i > 1000) | any(i < 1)) 
    >>                 stop("argument to set.seed() must be in 1:1000")
    >>         if (any(i != trunc(i))) 
    >>                 stop("argument to set.seed()must be an integer")
    >>         .Random.seed <<- as.integer((200 * c(i, i^2, i^3))%%c(30269, 
    >>                 30307, 30323))
    >> }

Thank you Thomas,
yes I agree that we should have a  set.seed(.).

{{now follows a longish explanation about what S-plus does, etc..
  at the end a better (?) proposal for set.seed 
}}

When I first thought about implementing  set.seed(.) in R,
I tried to understand what S-plus does (and did not succeed).
In the mean time, I have re-investigated and found almost ``everything'' :

S-plus 3.4 *help* says

Sp3.4>>     DESCRIPTION:
Sp3.4>> 	   Puts the random number generator in a reproducible state.
Sp3.4>> 
Sp3.4>>     USAGE:
Sp3.4>> 	   set.seed(i)
Sp3.4>> 
Sp3.4>>     REQUIRED ARGUMENTS:
Sp3.4>>     i:     be an integer between 0 and 1000.
Sp3.4>> 
Sp3.4>>     SIDE EFFECTS:
Sp3.4>> 	   Sets the value of the .Random.seed object in  the  working
Sp3.4>> 	   directory.
Sp3.4>> 
Sp3.4>>     DETAILS:
Sp3.4>> 	   Random number generators in S-PLUS are all  based  upon  a
Sp3.4>> 	   single  uniform  random  number  generator  that generates
Sp3.4>> 	   numbers in a very long, but ultimately periodic  sequence.
Sp3.4>> 	   The   position   in   the   sequence  is  held  in  object
Sp3.4>> 	   .Random.seed.  Function set.seed sets .Random.seed so that
Sp3.4>> 	   subsequent  calls  to  random  number  generator functions
Sp3.4>> 	   (runif, rnorm, etc.)  will generate  numbers  from  a  new
Sp3.4>> 	   portion of the overall cycle.
Sp3.4>> 
Sp3.4>> 	   Random  number  generation  in  S-PLUS  is  adapted   from
Sp3.4>> 	   Marsaglia  (1973);  see  Kennedy  and  Gentle  (1980)  for
Sp3.4>> 	   background information.

So they __say__   ``i in 0:1000'', but the
problem is that set.seed(i) also ``works'' with any other integer i.

But what exactly should happen?
The crucial sentence is (as vague as)
 Sp3.4>> Function set.seed sets .Random.seed so that
 Sp3.4>> subsequent calls to random number generator functions (runif...) 
 Sp3.4>> will generate numbers from a new portion of the overall cycle.

The intent being that for ANY i,j (i!=j) set.seed(i) and set.seed(j) would
choose ``distant'' parts of the periodic cycle.

Unfortunately, we don't know what exactly happens in
the S-plus code for set.seed(i), namely,  .C("setseed", as.integer(i))
However, I have found out the following which should suffice :

 1) Only .Random.seed[4:6]  are varyied by set.seed, i.e., 
   after set.seed(i), .Random.seed always is

	   1  2  3  4  5  6  7  8  9 10 11 12	
      [1] 21 14 49  *  *  * 32 22 36 23 28  3
		   X4 X5 X6

   Which means that only the 'congrval' {Venables & Ripley, 2nd ed., p.166-167}
   is varied	

 2) X4 is always ==  16*((i+2) %% 4)
    X5 takes (all) values in 0:63  [also with some periodicity]
    X6 takes the values of 0:3

 3) set.seed(i) <==> set.seed(i + n*1024)  for all integers n, i

 4) { set.seed(i) ;  i \in {integers}} 
    results in a set of 1024 different values of 'congrval'.
    These values are EXACTLY EQUISPACED lying in {0,..,2^32}.

    If C[1:1024] are these sorted values, we have

	C[i] == 201621 + (i-1)* 2^22  , for i in 1:1024
	


So far for S-plus.

-----------------------------------------------------------------

Now, in R with a different basic RNG (with a longer period), 
		-- see ?.Random.seed --
we would want  set.seed(i)
to also guarantee that the locations in the periodic cycle are far apart.

I think (but may be wrong; I must do other things now !!)
this can be better achieved by just changing one of the 3 congruential
generators involved.
This leads to the following proposal :

set.seed <- function (i) 
{
        if(length(i) != 1  || i != (ii <- as.integer(i)))
	  stop("argument to set.seed() must be integer(1)")
	i <- ii
        if (i > 1024 || i < 1) {
	  warning("set.seed(i) has i outside 1:1024; taking  i %% 1024")
	  i <- i %% 1024; if(i <= 0) i <- i+ 1024
	}
        invisible(.Random.seed <<- as.integer(c((171*i)%%30269, 10909, 10111)))
}



Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep 15 15:51:37 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 15 Sep 1997 10:51:37 -0400
Subject: R-alpha: compatibility
References: <Pine.SUN.3.95.970913115858.557A-100000@troi>
Message-ID: <97Sep15.105405edt.26503@mailgate.bank-banque-canada.ca>

Please don't mess with the random number generator without good reason!
You will mess me up a whole lot! You can of course change the default
behavior of set.seed without affecting me. Here are my thoughts on
set.seed.

Despite the fact that the Blue Book says set.seed takes an integer
argument, and despite the fact that the Splus version of set.seed does
take an integer argument, I don't think anyone who actually does a lot
of random experiments would actual want to use set.seed like that. The
reason is that you often want to reproduce a random experiment after
you've done it, and of course, often, you don't set the seed before you
do the experiment. To get around this I save the starting .Random.seed
with my simulation experiments. Then I have my own set.seed (in Splus
and in R) which works directly with the .Random.seed, so in Splus it
takes 12 (small) integers as its argument and in R it takes 3 integers.
I also allows a single integer argument for Blue Book compatibility and
in Splus I use their set.seed (which I rename) for this case. As you may
see below, the default behavior in R is rather ad hoc. Below are my
Splus and R versions of set.seed. The R version has a minor workaround
for the problem that the R .Random.seed does not seem to exist until the
random number generator is used the first time.  I also prefer returning
the new seed as the value of the function.

Paul Gilbert
______________

in R

    set.seed <- function(seed=NULL)
      {if (is.null(seed))
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not
yet exist
          seed <-.Random.seed
         }
       else
         {if (1==length(seed))

global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }
    global.assign <- function(name, value)
                          {assign(name,value, envir=.GlobalEnv)}

in S
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
          seed <-.Random.seed
       else
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }
    global.assign <- function(name, value) {assign(name,value, where =
1)}


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Mon Sep 15 17:27:54 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Mon, 15 Sep 1997 09:27:54 -0700 (PDT)
Subject: R-alpha: compatibility
In-Reply-To: <97Sep15.105405edt.26503@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970915091422.1882B-100000@troi>

On Mon, 15 Sep 1997, Paul Gilbert wrote:

> Please don't mess with the random number generator without good reason!
> You will mess me up a whole lot! You can of course change the default
> behavior of set.seed without affecting me. Here are my thoughts on
> set.seed.

I am aware of the problems with messing with random number generators,
which is why I wasn't proposing to.  In the generator we use (unlike in
S-PLUS), any seed value gives (a different part of) the same sequence of
random numbers, so seed setting is a harmless procedure.

>> Despite the fact that the Blue Book says set.seed takes an integer
> argument, and despite the fact that the Splus version of set.seed does
> take an integer argument, I don't think anyone who actually does a lot
> of random experiments would actual want to use set.seed like that.

I don't think the issue is whether set.seed() does something useful in S. 
It does *something* in S, and people use it in writing programs. They may
well want to run these programs in R (or we may want them to, especially
if they are sharing CPU time with us). The last thing we want to do is to
have a function set.seed() in R that does something qualitatively
different from the S function. 


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Mon Sep 15 17:55:02 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Mon, 15 Sep 1997 11:55:02 -0500 (CDT)
Subject: R-alpha: compatibility
In-Reply-To: <Pine.SUN.3.95.970915091422.1882B-100000@troi> from "Thomas Lumley" at Sep 15, 97 09:27:54 am
Message-ID: <9709151655.AA13639@nokomis.stat.umn.edu>

This is one point where compatibility is not necessarily a good
thing. S, like most systems gives, you no real control over the random
number generator expect re-seeding. Usually this is probably good. But
most simulation books recommend running any simulations you care about
with two very different generators. Most people don't do this because
one generator is usually easy to use (the built-in one in your
favorite system) and anything else is impossible. Another issue that S
faces has to do with running separate bits of a simulation on separate
workstations. Unless you are careful, the separate bits will share
parts of random number streams, and being careful is not really
possible with S's generator (I think) -- it is possible but not easy
with R's. (Of course overlap can be a good thing if you know you have
it -- the point here is that lots of folks run separate simulations
thinking they have independent runs when they probably do not in any
reasonable sense).

The bottom line is that it would be nice to eventually provide "power
users" with more control over the random number generator system.  Now
is clearly not the time to think about how to do that, but it would be
unfortunate if decisions were made at this point in the name of
compatibility that might limit the freedom of doing something "right"
later on.

Just my 2c.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Sep 15 19:44:24 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 15 Sep 1997 14:44:24 -0400
Subject: R-alpha: set.seed compatibility
References: <Pine.SUN.3.95.970915091422.1882B-100000@troi>
Message-ID: <97Sep15.144656edt.26510@mailgate.bank-banque-canada.ca>

The modification to set.seed that I was suggesting does not change its
default behavior, so software which runs in S still runs with my change.
The change means that set.seed can also be given a value for
.Random.seed. This would fail with the usual S version of set.seed. I
don't think we need to take compatibility to the extend of failing when
S fails.

Also, I don't think set.seed can really accomplish what I think of as
the true objective of compatibility: reproduce S random experiments with
R (possibly not even if the same random number generator is used). Even
Splus has not been completely successful in this respect. There were
some changes between 3.2 and 3.3 which affected reproducibility.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 21:50:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 22:50:58 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Ross Ihaka's message of Mon, 15 Sep 1997 22:16:26 +1200 (NZST)
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
Message-ID: <x24t7mfgi5.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Here is my (incomplete) version. This will work for full-rank models,
> and I suspect also for singular models (the comment is just a reminder
> to myself that I was thinking about this).
> 
> I set out to change the underlying structure so that case names
> would be propagated through to to the fitted values.  This doesn't
> happen at the moment because they are not handled within "model.matrix".
> A quick fix would be to replace dimnames(x) below by row.names(mf).
> 
> There is no computation of standard errors below, but the present
> version has something like the right computation.
> 
> Sorry that this is just a hint, but I'm really under pressure at
> present.  Anyone got any (applied) exam questions on linear models
> or glms handy?
> 	Ross
> 	
> 
> predict.lm <-
> function (fit, newdata) 
> {
> 	mf <- model.frame(formula(fit), data = newdata)
> 	# recreate the design matrix
> 	x <- model.matrix(terms(fit), mf)
> 	# grab the coefficients (order is correct?)
> 	b <- coef(fit)
> 	b[is.na(b)] <- 0
> 	# compute predictions
> 	p <- x %*% b
> 	# attach name information
> 	if(is.matrix(b)) {
> 		dimnames(p) <- list(dimnames(x)[[1]], dimnames(b)[[2]])
> 	}
> 	else {
> 		p <- as.vector(p)
> 		names(p) <- dimnames(x)[[1]]
> 	}
> 	p
> }
> 

Hum, maybe my version was closer after all. Thing was that I tried to
be smart and have it work without having to specify the dataframe
(which gets to be a terrible pain when you need to specify factors
with the same level structure as in the original). On second thought,
I decided to abandon that idea and stick with S(-plus?) compatibility.
However I did get the SE's done and soforth. Here's my effort:


"like.frame" <-
function (frame, ...) 
{
        if (!is.data.frame(frame)) 
                stop("like.frame: first argument must be a data frame")
        f <- list(...)
        class(f) <- "data.frame"
        n <- ncol(f)
        nm.base <- names(frame)
        nm.new <- names(f)
        if (is.null(nm.new)) 
                nm.new <- rep("", n)
        for (i in 1:n) {
                if (nm.new[i] == "") {
                        #positional match 
                        nm.new[i] <- nm.base[i]
                        j <- i
                }
                else j <- match(nm.new[i], nm.base)
                if (!is.na(j)) 
                        if (is.factor(frame[[j]])) {
                                lab <- levels(frame[[j]])
                                lev <- 1:nlevels(frame[[j]])
                                f.i <- f[[i]]
                                if (is.character(f.i)) 
                                 f.i <- match(f.i, lab)
                                f[[i]] <- factor(f.i, levels = lev, 
                                 labels = lab)
                        }
        }
        names(f) <- nm.new
        f
}
"predict.lm" <-
function (object, ...) 
{
        mod.fr <- model.frame(object)
        form <- formula(object)
        # x~a+b becomes ~a+b
        form <- as.call(list(form[[1]], form[[3]]))
        class(form) <- "formula"
        pred.fr <- like.frame(mod.fr, ...)
        # the following is a kludge to work around a bug in data.frame:
        zz <- attr(terms(form), "variables")
        zz[[1]] <- as.name("list")
        pred.fr <- eval(zz, pred.fr)
        class(pred.fr) <- "data.frame"
        X <- model.matrix(form, pred.fr)
        n <- NROW(object$qr$qr)
        p <- object$rank
        p1 <- 1:p
        piv <- object$qr$pivot[p1]
        r <- resid(object)
        f <- fitted(object)
        w <- weights(object)
        if (is.null(w)) 
                rss <- sum(r^2)
        else rss <- sum(r^2 * w)
        R <- chol2inv(object$qr$qr[p1, p1, drop = FALSE])
        est <- object$coefficients[piv]
        predictor <- c(X[, piv] %*% est)
        ip <- real(NROW(X))
        resvar <- rss/(n - p)
        vcov <- resvar * R
        for (i in (1:NROW(X))) {
                xi <- X[i, piv]
                ip[i] <- xi %*% vcov %*% xi
        }
        stderr1 <- sqrt(ip)
        stderr2 <- sqrt(resvar + ip)
        tt <- qt(0.975, n - p)
        conf.l <- predictor - tt * stderr1
        conf.u <- predictor + tt * stderr1
        pred.l <- predictor - tt * stderr2
        pred.u <- predictor + tt * stderr2
        z <- list(predictor = predictor, conf.l = conf.l, conf.u = conf.u, 
                pred.l = pred.l, pred.u = pred.u)
        class(z) <- "data.frame"
        z
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 15 22:57:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Sep 1997 23:57:02 +0200
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: Peter Dalgaard BSA's message of 15 Sep 1997 22:50:58 +0200
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
 <x24t7mfgi5.fsf@bush.kubism.ku.dk>
Message-ID: <x2yb4yckb5.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> Hum, maybe my version was closer after all. Thing was that I tried to
...
> However I did get the SE's done and soforth. Here's my effort:

OK. A little thought and some cleanup later, I have this one. I'm a
little reluctant to go completely Splus compatible (return a list with
components $fit $se.fit $residual.scale $df if se.fit=T, otherwise
just the predicted values) and losing the confidence/prediction
intervals. Opinions?

"predict.lm" <-
  function (object, newdata = model.frame(object)) 
{
  form<-formula(object)
  form<-as.call(list(form[[1]],form[[3]])) # x~a+b becomes ~a+b
  class(form)<-"formula"
  X <- model.matrix(form,newdata)
  n <- NROW(object$qr$qr)
  p <- object$rank
  p1 <- 1:p
  piv <- object$qr$pivot[p1]
  r <- resid(object)
  f <- fitted(object)
  w <- weights(object)
  if (is.null(w)) 
    rss <- sum(r^2)
  else 
    rss <- sum(r^2*w)
  R <- chol2inv(object$qr$qr[p1, p1, drop = FALSE])
  est <- object$coefficients[piv]
  predictor <- c(X[,piv] %*% est)
  ip <- real(NROW(X))
  resvar <- rss/(n - p)
  vcov <- resvar * R
  for (i in (1:NROW(X))) {
    xi <- X[i,piv]
    ip[i] <- xi %*% vcov %*% xi
  }
  stderr1 <- sqrt(ip)
  stderr2 <- sqrt(resvar + ip)
  tt <- qt(0.975, n - p)
  conf.l <- predictor - tt * stderr1
  conf.u <- predictor + tt * stderr1
  pred.l <- predictor - tt * stderr2
  pred.u <- predictor + tt * stderr2
  data.frame(predictor=predictor, conf.l=conf.l, conf.u=conf.u,
	pred.l=pred.l,pred.u=pred.u,row.names=rownames(newdata))
}
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 15 23:10:52 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 16 Sep 1997 10:10:52 +1200 (NZST)
Subject: R-alpha: predict.lm -- who ..?
In-Reply-To: <x2yb4yckb5.fsf@bush.kubism.ku.dk>
References: <199709151016.WAA19837@stat1.stat.auckland.ac.nz>
 <x24t7mfgi5.fsf@bush.kubism.ku.dk>
 <x2yb4yckb5.fsf@bush.kubism.ku.dk>
Message-ID: <199709152210.KAA24228@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:

 > "predict.lm" <- [stuff returning a data frame]

This looks just like what I had in mind (though I was thinking matrix
rather than dataframe).  This I think is more useful (at least to the
kiddies I teach) than the S one.

BUT: I have been berated by my class for preparing examples with R and
trying to pass them off as S - they notice the minor differences.
Pehaps it would be possible to make a library "smodels" which is as
close to S as we can make it. I have an lm.summary and
lm.summary.print which could go into it.

In general I don't like compatibility boxes, but this seems harmless
enough.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep 16 15:09:40 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 16 Sep 1997 16:09:40 +0200
Subject: R-alpha: bug: rbind(.) drops names for character; cbind(.) is ok.
Message-ID: <199709161409.QAA13816@sophie.ethz.ch>

R version (>) 0.50-a4:

##-- This is fine :
> rbind(graph=c(1:3), plot=c(2:4), my.glm=c(3:5))
       [,1] [,2] [,3]
graph     1    2    3
plot      2    3    4
my.glm    3    4    5

##-- This is the bug:
> rbind(graph=c("A","B"), plot=c(2:3), my.glm=c(3:4))
     [,1] [,2]
[1,] "A"  "B" 
[2,] "2"  "3" 
[3,] "3"  "4" 

##-- cbind(.) is ok:
> cbind(graph=c("A","B"), plot=c(2:3), my.glm=c(3:4))
     graph plot my.glm
[1,] "A"   "2"  "3"   
[2,] "B"   "3"  "4"   
> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Sep 17 08:30:56 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 17 Sep 1997 09:30:56 +0200 (MET DST)
Subject: R-alpha: fortran
Message-ID: <9709170730.AA19097@alpha.luc.ac.be>

I have a strange problem with calling fortran in 50a4. In longitudinal
analysis, I have a vector of times. When they are unequally spaced,
the user must supply them and things work fine when they are sent to
the fortran. If the data are balanced and equally spaced, the user
need not supply them and the function calculates them, say as
time <- 1:nt
When I feed this to the fortan, it receives it as a vector of
integers!!! I have to put
time=as.double(time)
in the call for it to work properly. I do not believe that this was a
problem before a4. I thought everything was a double in R?!
Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Sep 17 09:33:08 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 17 Sep 1997 20:33:08 +1200 (NZST)
Subject: R-alpha: fortran
Message-ID: <199709170833.UAA19552@stat1.stat.auckland.ac.nz>

Its been this way for a while.  We made the output from the ":" operator
be integer.  This is compatible with S and is a bit more efficient
in things like x[1:10] because the subscripts do not need to be
converted to integer.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Sep 17 10:42:32 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 17 Sep 1997 11:42:32 +0200 (MET DST)
Subject: R-alpha: nlm
Message-ID: <9709170942.AA23823@alpha.luc.ac.be>

It would be nice if nlm returned the number of iterations taken as
well as the code indicating if the limit is exceeded. For the moment,
the only way to access it is by looking at the output from
print.level=2. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Thu Sep 18 15:00:11 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 18 Sep 1997 09:00:11 -0500
Subject: R-alpha: Re: R-Mailing lists ok again. ..sorry..
In-Reply-To: Martin Maechler's message of Thu, 18 Sep 1997 08:59:00 +0200
References: <199709180659.IAA01778@sophie.ethz.ch>
Message-ID: <6ren6men84.fsf@franz.stat.wisc.edu>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> This caused 3 postings (1 to R-help, 2 to R-devel) to be aborted.
> For some reason, it also seems majordomo did not save the postings in
> a 'dead.letter' or something.

> So could you please re-submit them? 

> These are the sendmail entries:

> Sep 17 21:14:21 .. sendmail[9364]: VAA09363: from=<bates@stat.wisc.edu>, size=390, class=0, pri=30390, nrcpts=1, msgid=<6ren6nbvnt.fsf@franz.stat.wisc.edu>, proto=ESMTP, relay=root@franz.stat.wisc.edu [128.105.5.95]

> Sep 17 21:47:26 .. sendmail[9518]: VAA09517: from=<bates@stat.wisc.edu>, size=331, class=0, pri=30331, nrcpts=1, msgid=<6rd8m7bu42.fsf@franz.stat.wisc.edu>, proto=ESMTP, relay=root@franz.stat.wisc.edu [128.105.5.95]

I can't find copies of those messages so I will summarize here.  One
of them was unimportant - simply an observation that the mis-typing of
TITLE as TITLe in the documentation for the library function is
intentional.  The second was a query to Fritz with a copy to this list
on whether the data files in the bootstrap library are indeed
accessible with the data function.  It seems not.  If there was a
convention that files ending with .data in a data directory should be
read with read.table I think that would be great.  Actually I think it
would be "insanely great" if they were read with
 read.table(filename, header = TRUE)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Sep 18 15:52:31 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 18 Sep 1997 16:52:31 +0200
Subject: R-alpha: -- data files :  read.table(..., header=TRUE)  -- Yes!
In-Reply-To: <6ren6men84.fsf@franz.stat.wisc.edu> (message from Douglas Bates
 on 18 Sep 1997 09:00:11 -0500)
Message-ID: <199709181452.QAA19001@sophie.ethz.ch>

>>>>> "Doug" == Douglas Bates <bates@stat.wisc.edu> writes:

    Doug>  .....
    Doug> I can't find copies of those messages so I will summarize here.

sorry, once more.

    Doug> One of them was unimportant - simply an observation that the
    Doug> mis-typing of TITLE as TITLe in the documentation for the library
    Doug> function is intentional.  

yes! (it partly breaks the HTML version..)

But with the new Rd (man) style and its perl scripts, the problem is gone
anyway.

    Doug> The second was a query to Fritz with a
    Doug> copy to this list on whether the data files in the bootstrap
    Doug> library are indeed accessible with the data function.  It seems
    Doug> not.
This also has quite a bit changed in the current source.

As Kurt says, all the packages have to be updated though before they work
with the current directory structure.

    Doug> f there was a convention that files ending with .data in a
						          ~~~~~
    Doug> data directory should be read with read.table I think that would
    Doug> be great.
indeed!
Maybe we should have  '.dat'
in order  for the Win3.x  version to need less adaption for porting... 

    Doug> Actually I think it would be "insanely great" if they
    Doug> were read with read.table(filename, header = TRUE) 
			 -------------------  ##############
Yes again!

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Sep 18 21:59:10 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 19 Sep 1997 08:59:10 +1200 (NZST)
Subject: R-alpha: stuff
Message-ID: <199709182059.IAA23976@stat1.stat.auckland.ac.nz>

Peter,
  That's fine. I'm still not doing well on the computer front; 3 down/ 1 up;
  but things are supposed to change.....
  
  
  On Doug Bates comments about files with .data extensions; if these things
  are going to work under 3.1 I think we need to limit ourselves to 3 digit
  extensions. While I'm sure .dat is already taken I think it will be easier
  to work around that. Yes I could write perl scripts to do all the 
  transforming but it's a bit of a pain (especially since I can't even keep
  up with the other developments).
  
  
  robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From helgito@rhi.hi.is  Sun Sep 21 18:40:03 1997
From: helgito@rhi.hi.is (Helgi Tomasson)
Date: Sun, 21 Sep 1997 17:40:03 +0000 (GMT)
Subject: R-alpha: R-adventure
Message-ID: <199709211740.RAA17140@hengill.rhi.hi.is>

I am trying to port R to OS/2 and XFREE86.  I have XFREE86 for OS/2
up and running and a lot the unix utilities, sh, ksh, tcsh, awk sed etc.

I have not been able to make configure running.  I have therefore
patched the makefiles manually and gotten through most of them.
All in the src-directory except /src/main/makefile at the moment
the beginning of it looks like this:

CC=gcc
CFLAGS=-g -I../include
LDCMD=
DLLFLAGS=
PICFLAGS=
SHLIBLDFLAGS=
LIBS=-lf2c  -lm
X_CFLAGS=-I/xfree86/include
X_LIBS=-L/xfree86/lib -lX11
X_EXTRA_LIBS=
X_PRE_LIBS=
FC=g77

What should these flags be?  I have guessed in the other makefiles.
For example there is no ranlib so I use ar S, which seems to work.

I have been told by experts that I should also look out for

platform.h

How should that one be in my case.

I am using the GNU-EMX gcc compiler together with g77.

sincerely yours

Helgi Tomasson

-- 
Helgi Tomasson                                       FAX:  354-552-6806
University of Iceland                                PHONE:354-525-4571
Faculty of Economics and Business Administration     email:helgito@rhi.hi.is 
Oddi v/ Sturlugotu        
IS-101 Reykjavik
ICELAND
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Sep 22 12:37:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 22 Sep 1997 13:37:16 +0200
Subject: R-alpha: -- data files :  read.table(..., header=TRUE)  -- Yes!
In-Reply-To: <199709181452.QAA19001@sophie.ethz.ch>
References: <6ren6men84.fsf@franz.stat.wisc.edu>
 <199709181452.QAA19001@sophie.ethz.ch>
Message-ID: <199709221137.NAA18680@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Doug" == Douglas Bates <bates@stat.wisc.edu> writes:
Doug> .....
Doug> I can't find copies of those messages so I will summarize here.

> sorry, once more.

Doug> One of them was unimportant - simply an observation that the
Doug> mis-typing of TITLE as TITLe in the documentation for the library
Doug> function is intentional.  

> yes! (it partly breaks the HTML version..)

> But with the new Rd (man) style and its perl scripts, the problem is
> gone anyway.

Yes, definitely.

Doug> The second was a query to Fritz with a
Doug> copy to this list on whether the data files in the bootstrap
Doug> library are indeed accessible with the data function.  It seems
Doug> not.

> This also has quite a bit changed in the current source.

> As Kurt says, all the packages have to be updated though before they
> work with the current directory structure.

Again, this will change with the new version.  If a new-style package
has a `data' subdirectory, its contents are installed along with the R
objects, shared libraries and help files etc.  Loading the pkg makes
these data sets available as well.

FRITZ:  When you update your pkg, please make sure that the data get
into the update as well.

Doug> f there was a convention that files ending with .data in a
> 						          ~~~~~
Doug> data directory should be read with read.table I think that would
Doug> be great.
> indeed!
> Maybe we should have  '.dat'
> in order  for the Win3.x  version to need less adaption for porting... 

Doug> Actually I think it would be "insanely great" if they
Doug> were read with read.table(filename, header = TRUE) 
> 			 -------------------  ##############
> Yes again!

Simply from the extension?  Or perhaps we could have a ``magic'' first
line telling a generic `read' what to do?  (A similar logic could be
applied to e.g. reading in xbase files using a (still unwritten) pseudo
method read.dbf which would be called if the generic read figures out
that it is looking at a dbase file (and again, using the result of
file(1) may be the better idea ...)

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 22 13:04:47 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Sep 1997 14:04:47 +0200
Subject: R-alpha: x[NA]
Message-ID: <x2raahftb4.fsf@bush.kubism.ku.dk>

Just curious. Current logic in both R and Splus has

> (1:3)[c(T,F,NA)]
[1]  1 NA

Does anyone know *why*? It makes sense for integer indexing, but for
logicals it seems to have some strange consequences - if you divide a
dataframe according to some criterion, you get as many NA-filled
records as there are missing values of the criterion added to *both*
the group that satisfies the criterion and to those that do not.

One reason could be that since NA is logical by default, you would be
getting awkward consequences of the type x[NA] == real(0), but
x[c(NA,1)] == c(NA,5.3), but why is NA logical by default, then? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep 22 17:04:02 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 22 Sep 1997 09:04:02 -0700 (PDT)
Subject: R-alpha: x[NA]
In-Reply-To: <x2raahftb4.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970922085721.1161A-100000@troi>

On 22 Sep 1997, Peter Dalgaard BSA wrote:

> Just curious. Current logic in both R and Splus has
> 
> > (1:3)[c(T,F,NA)]
> [1]  1 NA
> 
<snip>
> One reason could be that since NA is logical by default, you would be
> getting awkward consequences of the type x[NA] == real(0), but
> x[c(NA,1)] == c(NA,5.3), but why is NA logical by default, then? 

The alternative would be worse.  If one element of the index is not
logical then the whole index is converted, so
R> x<-1:4 
R> x[c(F,T,F,T)]
[1] 2 4
R> x[c(F,T,F,NA)]
[1]  2 NA
but
R> x[c(F,T,F,4)]
[1] 1 4

That is, the presence of any NA would result in selecting only element
as.numeric(T)==1.

BTW, while you obviously can't mix logical and numerical references I
think it's unfortunate that you can't mix numeric and name-based
references like
R> names(x)<-letters[1:4]
R> x
a b c d 
1 2 3 4 
R> x[c("a",2)]
Error: subscript out of bounds

If you want a real example, suppose you had a model frame from which you
wanted to extract the response (in position 1) and the variables whose
names were in a vector nn
	mf[,c(1,nn)] 
appears to be the obvious solution.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ammann@utdallas.edu  Mon Sep 22 18:16:03 1997
From: ammann@utdallas.edu (Larry P Ammann)
Date: Mon, 22 Sep 1997 12:16:03 -0500 (CDT)
Subject: R-alpha: mtext
Message-ID: <199709221716.MAA13611@utdallas.edu>

Something seems to have broken mtext between the R-0.50-a1 and R-0.50-a4
releases. It prints OK when side=2 or 4, but does not print if side=1 or 3.
Try for example:

plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
for(s in 1:10) {
    mtext(paste("mtext(..,side=1, line=",-s,")"), side=1, line=-s)
    mtext(paste("mtext(..,side=2, line=",-s,")"), side=2, line=-s)
    mtext(paste("mtext(..,side=3, line=",-s,")"), side=3, line=-s)
    mtext(paste("mtext(..,side=4, line=",-s,")"), side=4, line=-s)
}

Larry P. Ammann
Professor of Statistics
University of Texas at Dallas
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Sep 22 22:38:38 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 23 Sep 1997 09:38:38 +1200 (NZST)
Subject: R-alpha: mtext
Message-ID: <199709222138.JAA15965@stat1.stat.auckland.ac.nz>

Larry P Ammann <ammann@utdallas.edu> writes:

> Something seems to have broken mtext between the R-0.50-a1 and R-0.50-a4
> releases. It prints OK when side=2 or 4, but does not print if side=1 or 3.
> Try for example:

> plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
> for(s in 1:10) {
>     mtext(paste("mtext(..,side=1, line=",-s,")"), side=1, line=-s)
>     mtext(paste("mtext(..,side=2, line=",-s,")"), side=2, line=-s)
>     mtext(paste("mtext(..,side=3, line=",-s,")"), side=3, line=-s)
>     mtext(paste("mtext(..,side=4, line=",-s,")"), side=4, line=-s)
> }


Ahhh.  It looks like I need to change my test example from plot(1:10)
to plot(rnorm(10)) ...

Here is the fix:  In src/main/plot.c at about line 1180, you will
find the lines:

	if(!FINITE(at)) {
		switch(side % 2) {
		case 0:
			at = (1 - adjx) * GP->usr[0] + adjx * GP->usr[1];
			break;
		case 1:
			at = (1 - adjx) * GP->usr[2] + adjx * GP->usr[3];
			break;
		}
	}

the bodies of the cases need to be swapped.  I.e. it should read

	if(!FINITE(at)) {
		switch(side % 2) {
		case 0:
			at = (1 - adjx) * GP->usr[2] + adjx * GP->usr[3];
			break;
		case 1:
			at = (1 - adjx) * GP->usr[0] + adjx * GP->usr[1];
			break;
		}
	}

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Sep 22 23:02:03 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Sep 1997 00:02:03 +0200
Subject: R-alpha: x[NA]
In-Reply-To: Thomas Lumley's message of Mon, 22 Sep 1997 09:04:02 -0700 (PDT)
References: <Pine.SUN.3.95.970922085721.1161A-100000@troi>
Message-ID: <x2wwk9j9d0.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> That is, the presence of any NA would result in selecting only element
> as.numeric(T)==1.

Aha... Of course that only applies when you enter logical vectors
using c(...), if they result from a comparison, then the type would be
logical NA anyway. So the problem is that c(...) converts to numeric
if just one element is.numeric() even if that element is NA. Hmm. I
suppose that could be handled differently by having c() explicitly
ignoring NA when deciding on type, but that probably leads to more
problems elsewhere?

> BTW, while you obviously can't mix logical and numerical references I
> think it's unfortunate that you can't mix numeric and name-based
> references like
> R> names(x)<-letters[1:4]
> R> x
> a b c d 
> 1 2 3 4 
> R> x[c("a",2)]
> Error: subscript out of bounds
> 
> If you want a real example, suppose you had a model frame from which you
> wanted to extract the response (in position 1) and the variables whose
> names were in a vector nn
> 	mf[,c(1,nn)] 
> appears to be the obvious solution.

I think that the possibility of setting names(x)<-4:1 will demonstrate
why that can't work... Besides, can you be sure that the dependent
variable is the first one in a model frame any more?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Sep 22 23:08:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 22 Sep 1997 15:08:54 -0700 (PDT)
Subject: R-alpha: x[NA]
In-Reply-To: <x2wwk9j9d0.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970922150648.2314B-100000@troi>

On 23 Sep 1997, Peter Dalgaard BSA wrote:

> 
> > BTW, while you obviously can't mix logical and numerical references I
> > think it's unfortunate that you can't mix numeric and name-based
> > references like
> > R> names(x)<-letters[1:4]
> > R> x
> > a b c d 
> > 1 2 3 4 
> > R> x[c("a",2)]
> > Error: subscript out of bounds
<snip> 
> I think that the possibility of setting names(x)<-4:1 will demonstrate
> why that can't work... Besides, can you be sure that the dependent
> variable is the first one in a model frame any more?
> 
Why?
R> x<-1:4
R> names(x)<-4:1
R> x[1]
4 
1 
R> x["1"]
1 
4 
So why not x[c(1,"1")] giving 1,4?


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Sep 23 10:13:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Sep 1997 11:13:23 +0200
Subject: R-alpha: x[NA]
In-Reply-To: Thomas Lumley's message of Mon, 22 Sep 1997 15:08:54 -0700 (PDT)
References: <Pine.SUN.3.95.970922150648.2314B-100000@troi>
Message-ID: <x2souwl7f0.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> On 23 Sep 1997, Peter Dalgaard BSA wrote:

> > I think that the possibility of setting names(x)<-4:1 will demonstrate
> > why that can't work... Besides, can you be sure that the dependent
> > variable is the first one in a model frame any more?
> > 
> Why?
> R> x<-1:4
> R> names(x)<-4:1
> R> x[1]
> 4 
> 1 
> R> x["1"]
> 1 
> 4 
> So why not x[c(1,"1")] giving 1,4?

Because 

> c(1,"1")
[1] "1" "1"

so we'd have to introduce mixed-type vectors first. However, I suppose
that one might make

> x[list(1,"1")]

work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Sep 23 14:33:07 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 23 Sep 1997 09:33:07 -0400
Subject: R-alpha: read.dbf
References: <6ren6men84.fsf@franz.stat.wisc.edu>
 <199709181452.QAA19001@sophie.ethz.ch> <199709221137.NAA18680@aragorn.ci.tuwien.ac.at>
Message-ID: <97Sep23.093520edt.26501@mailgate.bank-banque-canada.ca>

...
>applied to e.g. reading in xbase files using a (still unwritten) pseudo

>method read.dbf which would be called if the generic read figures out
...

If you're going to get into reading databases let me know. I've already
done a fair amount of work on this and have a working interface to Fame
time series databases (and any other database which can be made to
support a generic protocol I've been working on).

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Wed Sep 24 15:27:38 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 24 Sep 1997 10:27:38 -0400
Subject: R-alpha: Re: read.dbf
References: <6ren6men84.fsf@franz.stat.wisc.edu> <199709181452.QAA19001@sophie.ethz.ch> <199709221137.NAA18680@aragorn.ci.tuwien.ac.at> <97Sep23.093622edt.26510@mailgate.bank-banque-canada.ca> <199709241131.NAA06833@aragorn.ci.tuwien.ac.at>
Message-ID: <97Sep24.103023edt.26510@mailgate.bank-banque-canada.ca>

>> If you're going to get into reading databases let me know. I've
already
>> done a fair amount of work on this and have a working interface to
Fame
>> time series databases (and any other database which can be made to
>> support a generic protocol I've been working on).

>I probably won't have any time for this is the near future, but perhaps

>someone else will fill in ...
>Anyway, if there is more info about the `generic protocol' you
mentioned
>that you can easily make available, the please do so.

Kurt

There is a fair amount of information and example code available at
http://www.bank-banque-canada.ca/pgilbert
Follow the link to TSPADI.

There is a working server front end for the Fame time series database
software as well as a very simplistic file based "database" we made for
test purposes. There is also a client side interface for Splus and for a
"generic client" which is intended as an example and also for test
purposes. The version of the code on the web page needs a few minor
changes for R. I have done that and will soon make it available.

Please note that this is not a database protocol like SQL which allows
queries. The client must provide an identifier for an object and the
server simply returns the object.

The protocol uses RPC and has only been tested on TCP/IP  networks,
although I've been told RPC is available with some other networks. It
does work across the Internet. (It can also be run locally without a
network using loopback.)

An interesting project would be to write a wrapper (eg. in Perl) for
some of the data being provided as text formatted pages. Then a server
could be setup to provide the data with the PADI protocol so that it
could be used directly by application programs like R.  If anyone has
some bright student looking for something to do I can provide more
details.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 24 23:16:06 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 24 Sep 1997 17:16:06 -0500 (CDT)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) in 0.50a4
Message-ID: <m0xDzj4-000hrZC@franz.stat.wisc.edu>

To use Ron Ziegler's famous phrase, that argument is "no longer
operative".  The code for the bxp function, which is what is called to
actually do the plotting, has a section

  if (!is.null(width)) {
    if (length(width) != n | any(is.na(width)) | 
	any(width <= 0)) 
      stop("invalid boxplot widths")
    width <- 0.8 * width/max(width)
  }
  else if (varwidth) {
    width <- 0.8 * sqrt(z[[i]]$n/nmax)
  }
  if (n == 1) 
    width <- 0.4
  else width <- rep(0.8, n)

The effect of either an explicit "width" argument or a TRUE "varwidth"
argument is being overridden in the next statement.

Since the default value of "width" is NULL, I think this can be
repaired by replacing the last three lines shown there by

  if (is.null(width)) {
    if (n == 1)
      width <- 0.4
    else width <- rep(0.8, n)
  }

P.S. For those of you who don't know who Ron Ziegler was (which means
you are too young to remember Watergate), he was Richard Nixon's press
secretary.  When it was shown that a statement he had made to the
press the previous day was an outright lie he responded, "That
statement is no longer operative.".
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Sep 24 23:33:07 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 24 Sep 1997 17:33:07 -0500 (CDT)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) - Take 2
Message-ID: <m0xDzzX-000hrZC@franz.stat.wisc.edu>

This piece of code may do a better job in bxp
  if (!is.null(width)) {
    if (length(width) != n | any(is.na(width)) | 
	any(width <= 0)) 
      stop("invalid boxplot widths")
    width <- 0.8 * width/max(width)
  }
  else if (varwidth) {
    width <- 0.8 * sqrt(unlist(lapply(z, "[[", "n"))/nmax)
  }
  else if (n == 1) {
      width <- 0.4
    }
  else width <- rep(0.8, n)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Sep 25 00:29:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 25 Sep 1997 11:29:35 +1200 (NZST)
Subject: R-alpha: boxplot(..., varwidth = TRUE, ...) - Take 2
In-Reply-To: <m0xDzzX-000hrZC@franz.stat.wisc.edu>
References: <m0xDzzX-000hrZC@franz.stat.wisc.edu>
Message-ID: <199709242329.LAA21346@stat1.stat.auckland.ac.nz>

Douglas Bates writes:
 > This piece of code may do a better job in bxp

I have just committed both changes :-)
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

