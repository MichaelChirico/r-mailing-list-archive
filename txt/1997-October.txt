From thomas@biostat.washington.edu  Thu Oct  2 00:11:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 1 Oct 1997 16:11:20 -0700 (PDT)
Subject: R-alpha: R-beta: hat
In-Reply-To: <199710010207.OAA22329@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.971001160904.8966C-100000@troi>


The hat() function, returning the diagonal of the hat matrix, currently
works only on matrices and doesn't work with weights.  Could we make it
return lm.influence(x)$hat when inherits(x,"lm")?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Oct  2 12:24:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 02 Oct 1997 13:24:35 +0200
Subject: R-alpha: R-beta: hat
In-Reply-To: Thomas Lumley's message of Wed, 1 Oct 1997 16:11:20 -0700 (PDT)
References: <Pine.SUN.3.95.971001160904.8966C-100000@troi>
Message-ID: <x2hgb0z9u4.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> The hat() function, returning the diagonal of the hat matrix, currently
> works only on matrices and doesn't work with weights.  Could we make it
> return lm.influence(x)$hat when inherits(x,"lm")?

Shouldn't it be the other way around? i.e. lm.influence(x) sets $hat
to hat.lm(x)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Oct  4 16:49:15 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 4 Oct 1997 17:49:15 +0200
Subject: R-alpha: paste problem in TASKS --- yes, I do really want it
Message-ID: <199710041549.RAA01183@sophie.ethz.ch>

This is from line 104 of current TASKS:

----------------------------------------------------------------------
TASK:	"paste" problem
STATUS:	Open
FROM:	maechler@stat.math.ethz.ch
	in S,
		paste(....., collapse = string)
	always returns ONE string  (a character vector of length 1),
	according to documentation and several examples.
	in R, this is not true:
		R> paste(rep(" ",0), collapse="...") #anything for collapse
		character(0)
		S> paste(rep(" ",0), collapse="...") #anything for collapse
		[1] ""
	Again, I think	R  is more logical than S here, but it was decided
	that in minor cases, compatibility comes first...
	[ Low priority.	 Complain if you really need it. ]
			 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
			 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I hereby complain .

Yes I do want it.  The current behaviour results in  code being broken 
which would work otherwise.
{{of course I can always fix that code by an extra if(....) else .....
  but the point is that if  parse(..) behaved more reasonable,
  I did not have to fix that code..
}}

Yet another example is the  `fun()' Example in  ?tempfile
[in the latest snapshot of R-0.60]
which terminates on error for me just because of the above bug:

fun <- function() {
  FILE <- tempfile("fun")
  on.exit(unlink(FILE))
  system(paste("printenv >", FILE))
  x <- strsplit(scan(FILE, what = ""), "=")
  v <- n <- character(LEN <- length(x))
  for (i in 1:LEN) {
    n[i] <- x[[i]][1]
    v[i] <- paste(x[[i]][-1], collapse = "=")
  }
  structure(v, names = n)
}

> fun()
Read 83 items
Error in "[<-"(c("/u/sfs/adm", "/usr/local/bin", ".:/u/maechler/bib:/u/maechler/tex/styles:.:/u/sfs/bib",  : nothing to replace with

--- and the reason is:    x[[i]][-1]  is empty (some environment values are
					        just defined with no value ..)
 in which case 
		 paste(x[[i]][-1], collapse = "=")
 returns 
		 character(0)

 where it rather should return (IMHO)  
	
		 ""

 v[i] <- character(0)  then gives the error, whereas
 v[i] <- ""		would exactly produce what is wanted.

-----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rcreecy@census.gov  Tue Oct  7 15:29:54 1997
From: rcreecy@census.gov (Rob Creecy)
Date: Tue, 07 Oct 1997 10:29:54 -0400
Subject: R-alpha: Compiling R with Microsoft Visual C++
References: <199710041549.RAA01183@sophie.ethz.ch>
Message-ID: <343A4760.12EA742@census.gov>

I tried compiling R-0.50-a4 with Microsoft Visual C++ 5.0  on Windows NT
4.2
and have some problems.
I am doing this with the hope of being able to contribute to further
development of R
for Windows.

I followed the instructions in the R/src/windows directory, copying the
resulting files to my PC.
Most source files that are not  Windows dependent compile fine, others
such as
wincons.c, plotmath.c do not. I have noticed some missing header files:
<env.h>                not in my compiler distribution
<dl.h>                   is this HP specific? presumably not needed
shellapi.h

I am also not sure if all the needed symbols  and compiler options are
being
properly defined at compile time.
If a working makefile could be made available it might give me some
clues
about how to proceed.

Any suggestions?

Rob Creecy
Census Bureau



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Oct  7 16:46:17 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Oct 1997 17:46:17 +0200
Subject: R-alpha: Compiling R with Microsoft Visual C++
In-Reply-To: Rob Creecy's message of Tue, 07 Oct 1997 10:29:54 -0400
References: <199710041549.RAA01183@sophie.ethz.ch>
 <343A4760.12EA742@census.gov>
Message-ID: <x2bu118tkm.fsf@blueberry.kubism.ku.dk>

Rob Creecy <rcreecy@census.gov> writes:

> 
> I tried compiling R-0.50-a4 with Microsoft Visual C++ 5.0  on Windows NT
> 4.2
> and have some problems.

...

> If a working makefile could be made available it might give me some
> clues
> about how to proceed.
> 
> Any suggestions?

Um, "keep up the good work"? ;^)

Seriously, the current situation is that Robert Gentleman knows how to
compile the code with Watcom C, and that's about it. The rest of us
(with the possible exception of Thomas Lumley) are old Unixers,
utterly perplexed at the Microsoft Programming Universe in general,
and the so-called "user-friendly" Windows development environments in
particular. I got about as far as you when I tried, only more clueless
as to Visual C++ itself. 

So you are essentially on your own, but whatever progress you make
will be greatly appreciated, because the situation is certainly not
very desirable.

One hint, though: Try copying the include files to Unix and use grep
and gcc -E to figure out what is needed from which include files.

In the longer run, we need to set up the possibility of compiling with
several PC compilers, preferably freeware ones, too. Maybe even
crosscompiling from Unix and using a portable GUI library (dream on,
Peter...). I'm having my eyes rather strongly set on the RSXNT
compiler setup, or Gnuwin32, but the latter is a bit large. At the
moment, I'm all engaged in my course in Basic Statistics for Medical
Researchers, though, so I'm not likely to get any further until
December, unless I get a sudden strike of inspiration.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Oct  7 23:33:20 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 8 Oct 1997 11:33:20 +1300 (NZDT)
Subject: R-alpha: keep.order in formulae
Message-ID: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>

[ I'm teaching log-linear models at present, and looking at Agresti's
  book. ]

Often when producing analyis of variance or analysis of deviance
tables it is important to get effects fitted in a specific order.
At present in S / R this is done as follows:

	anova( glm( terms(formula, keep.order=T), ...) )

Can anyone think of a reason why keep.order should not become an
argument to "lm" and "glm", rather than forcing the use of "terms".
I.e., the above could be written:

	anova( glm(formula, ..., keep.order=T) )

Having to resort to the use of "terms" seems like a complication my
punters could do without.

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Oct  8 08:37:47 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 8 Oct 1997 09:37:47 +0200 (MET DST)
Subject: R-alpha: call_R in fortran
Message-ID: <9710080737.AA02034@alpha.luc.ac.be>

While the discussion is on Fortran, any chance of being able to call R
functions from Fortran? I did a hack way back when, when I was
originally working on what became nlm but would like something better.
  Thanks. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct  8 09:51:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 8 Oct 1997 10:51:35 +0200
Subject: R-alpha: dump() / dput() -- fail for "environmental" and attributed functions
Message-ID: <199710080851.KAA02610@sophie.ethz.ch>

Here is a simple example to show what I mean:

	f1 <- approxfun(1:3, 2:4)

	dump("f1", file="")

which yields (in current development snapshot; 
	      other versions are conceptually equivalent)

"f1" <-
function (v) 
.C("approx", as.double(x), as.double(y), n, xout = as.double(v), 
        length(v), as.integer(method), as.double(yleft), as.double(yright), 
        as.double(f), NAOK = T)$xout

i.e., the 'environment' part is not dumped.


Probably, we can well live without this working.
However, dump(.) or dput(.) then should produce a warning or error.
-------

But the problem is more general:
In newer versions of R  functions can have attributes,
(including a "class") -- which is very useful as already mentionend here.

However, even these are NOT dumped properly, and they SHOULD be!

fa <- function(x) x + 1
attr(fa, "class") <- "simple.fun"
dput(fa)

#-- results (wrongly) in

 function (x) 
 x + 1

i.e. `forgets' about the class attribute which you see when printing fa.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct  8 10:36:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 8 Oct 1997 11:36:37 +0200
Subject: R-alpha: wish:  segments(.) / arrows(.)  should allow an 'lwd = <num>' argument
Message-ID: <199710080936.LAA02666@sophie.ethz.ch>

(as the subject says).


Actually, I found that

	arrows
	segments
	rect

have no "..." and no "lwd"  argument
whereas

	lines.default
	polygon
	box

do all have a "..." (but no explicit 'lwd')
which they pass to .Internal( c-code )

-------

For anyone who feels like fixing this:

All the relevant code is in  src/main/plot.c,
and the function are

	do_arrows
	do_segments
	do_rect
etc.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Oct  8 10:48:04 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 8 Oct 1997 11:48:04 +0200
Subject: R-alpha: keep.order in formulae
In-Reply-To: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>
References: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>
Message-ID: <199710080948.LAA02704@UNKNOWN_7>

>>>>> Ross Ihaka writes:

> [ I'm teaching log-linear models at present, and looking at Agresti's
>   book. ]

> Often when producing analyis of variance or analysis of deviance
> tables it is important to get effects fitted in a specific order.
> At present in S / R this is done as follows:

> 	anova( glm( terms(formula, keep.order=T), ...) )

> Can anyone think of a reason why keep.order should not become an
> argument to "lm" and "glm", rather than forcing the use of "terms".
> I.e., the above could be written:

> 	anova( glm(formula, ..., keep.order=T) )

> Having to resort to the use of "terms" seems like a complication my
> punters could do without.

Right.  (Hadn't know about keep.order before ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct  9 09:41:04 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 9 Oct 1997 10:41:04 +0200
Subject: R-alpha: [sboker@calliope.psych.nd.edu: Re: S-PLUS on UNIX plans]
Message-ID: <199710090841.KAA04122@sophie.ethz.ch>

--Multipart_Thu_Oct__9_10:41:03_1997-1
Content-Type: text/plain; charset=US-ASCII

In case you did not realize how much this is related to R :


--Multipart_Thu_Oct__9_10:41:03_1997-1
Content-Type: message/rfc822

Return-Path: s-sender@utstat.toronto.edu
From: "Steven M. Boker" <sboker@calliope.psych.nd.edu>
Date: Wed,  8 Oct 97 16:37:05 -0500
To: s-news@utstat.toronto.edu
Subject: Re: S-PLUS on UNIX plans

My apologies for sending this out in non-ascii text format. (blush)
Here is the message.

On Tue, 7 Oct 1997, Gregory R. Warnes wrote:
>I applaud MathSoft's interest in porting Splus to Linux, and can
>echo "Z. Todd Taylor" comments.
>
>For those who are interested in GNU software, there is an S clone
>in development.  It is named R and can be obtained from
><http://lib.stat.cmu.edu/R.  It is already quite useful, but of
>course, does not have many of the enhancements added to Splus by
>MathSoft.
>

Another poster also was wondering about a Mac version.  I ported
R to OpenStep, the precursor to Apple's new Rhapsody OS.  Rhapsody's
core is just just BSD Unix, so the port took about 4 hours to find
the few definitions that had to be changed.  Of course, this is
just a command-line version.  But the language is, IMHO, the heart
and soul of Splus and how it differentiates itself in the marketplace.
I submit that a port to Linux and a port to Rhapsody could be an
almost identical code tree.  Seriously.  And they'd get another
market for free.

In the mean time, R will own that market as they own the Linux market.

Cheers,
Steve
---
 Steven M. Boker                                 219-631-4941 (voice)
 sboker@nd.edu                                   219-631-8883 (fax)
 <http://www.nd.edu/~sboker/                      219-257-2956 (home)
 Dept. of Psychology, University of Notre Dame, Notre Dame, IN 46556


--Multipart_Thu_Oct__9_10:41:03_1997-1--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Oct 10 09:13:02 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 10 Oct 1997 10:13:02 +0200
Subject: R-alpha: rsept31.zip
Message-ID: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>


I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
at all ... the screen went black for a second and that was it.

Any glue what I've done wrong? Should it work under 3.11 or only under
95/NT?

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 10 11:05:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 10 Oct 1997 12:05:12 +0200
Subject: R-alpha: Bug (since 0.50):  get(name.of.expression)  evaluates
Message-ID: <199710101005.MAA01480@sophie.ethz.ch>

This was not in 0.49 (when expressions where a different kind of objects).

get(..) does an extra eval(..)  when it should not :


###-*- R -*-   (cut and paste into R) ---------------------------

## rm(a) # if there is an 'a' 

 ex <- expression(a)

 ex
#> expression(a)

get("ex") #--- should really just return `expression(a)' ...
>>>>> Error: Object "a" not found

a <- pi
ex
# expression(a)

get("ex") #--- should really just return `expression(a)' ...
# [1] 3.141593

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Oct 10 11:20:12 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Oct 1997 12:20:12 +0200
Subject: R-alpha: rsept31.zip
In-Reply-To: Friedrich Leisch's message of Fri, 10 Oct 1997 10:13:02 +0200
References: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>
Message-ID: <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> 
> 
> I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
> at all ... the screen went black for a second and that was it.
> 
> Any glue what I've done wrong? Should it work under 3.11 or only under
      ^^^^ That's a sticky issue, Fritz... ;)
> 95/NT?

You need to install win32s first. Available from ftp.microsoft.com and
various other places. Latest version (1.30c, I think) is very
descriptively called pw1118.exe. It's a 2.4MB self-extracting file
(which is causing me some trouble with providing it to students on
diskette...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 10 19:24:51 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 10 Oct 1997 14:24:51 -0400
Subject: R-alpha: "[.ts" <- function (x, i, j, drop=T)
Message-ID: <97Oct10.142800edt.26501@mailgate.bank-banque-canada.ca>

This may have been fixed  as I'm working with a slightly old 0.50a
version, but I don't recall seeing it mentioned:

The arguments to "[.ts" needs to be changed to allow drop to be passed
to the NextMethod

"[.ts" <- function (x, i, j, drop=T)

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Oct 14 16:33:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 14 Oct 1997 17:33:55 +0200
Subject: R-alpha: rsept31.zip
In-Reply-To: <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>
References: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>
 <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>
Message-ID: <199710141533.RAA26871@galadriel.ci.tuwien.ac.at>

>>>>> On 10 Oct 1997 12:20:12 +0200,
>>>>> Peter Dalgaard BSA (PDB) wrote:

PDB> Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
>> 
>> 
>> I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
>> at all ... the screen went black for a second and that was it.
>> 
>> Any glue what I've done wrong? Should it work under 3.11 or only under
PDB>       ^^^^ That's a sticky issue, Fritz... ;)

probably my linux machine doesn't like it, when I write about sticky
issues like ms software and interferes with what I'm writing ...



PDB> You need to install win32s first. Available from ftp.microsoft.com and
PDB> various other places. Latest version (1.30c, I think) is very
PDB> descriptively called pw1118.exe. It's a 2.4MB self-extracting file
PDB> (which is causing me some trouble with providing it to students on
PDB> diskette...).

pw1118.exe did the job for me ... now it works including graphics
... or lets put it this way:

	x<-rnorm(100)
	y<-sin(x)
	plot(x,y)

worked :-)

finding bugs is left to students insisting on using windows

shouldn't there be something in the README?

as for the 2.4MB: the biggest file in the archive is about 350k, so
repacking it into 2 archives <= 1440k shouldn't be a problem.


fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 14 18:49:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 14 Oct 1997 19:49:48 +0200
Subject: R-alpha: extraneous ";" gives  syntax error
Message-ID: <199710141749.TAA02756@sophie.ethz.ch>

Here is what I mean

    > ;1
    ;1
    ^
    Error: syntax error
    > 1;;
    [1] 1
    1;;
      ^
    Error: syntax error
    > 1;;;3
    [1] 1
    1;;;3
      ^
    Error: syntax error

----

In S, these give no syntax errors; 
instead, NULL is returned (in some cases).

It's not a big issue,
but I don't see the advantage of  ``punishing empty statements''.

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From hoffmann@wsl.ch  Wed Oct 15 15:40:41 1997
From: hoffmann@wsl.ch (Christian Hoffmann)
Date: Wed, 15 Oct 1997 16:40:41 +0200
Subject: R-alpha: save in Rseptbeta
Message-ID: <9710151440.AA19871@lagonda>

Dear developers,

I am trying out RSeptbeta on a Win NT 3.51 machine.

Problem:

What is the default name for the Image file? Where can I choose this file?
On the command line?

After startup, in the R Console window, the lines appear:

[Previously saved workspace restored]   ------  seems OK

Error: workspace file corrupted -- no data loaded   ------- what is this???

Then the R.Rprofile File window opens, and I have the choice of two file names: 

Rprofile (which is a copy of the one in the distribution)

and

Save.rmg  (which I generated the previous time).

Choosing Rprofile is OK, the startup functions.
BUT, choosing Save.rmg will produce

[1] 1975
,^
> objects()
character(0)
>
i.e. the startup does not function.

To load the saved image I will have to execute  load("Save.rmg"). 

Questions:
How can the loading be automated? Or be made subject to a choice (window)?

The default for choosing a save file is
  <dir where Rsept resides>\Rprofile

This is misleading. It should default to my own working directory and
propose a name which would be automatically loaded.


I hope that this description is clear enough to find answers.

Thank you very much
--Christian

Christian Hoffmann
Swiss Federal Institute for Forest, Snow and Landscape Research
CH-8903 Birmensdorf, Switzerland
phone: ++41-1-739 22 77    fax  : ++41-1-739 22 15   e-mail:  hoffmann@wsl.ch

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Fri Oct 17 07:42:49 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 17 Oct 1997 16:42:49 +1000
Subject: R-alpha: bug in svd
Message-ID: <199710170642.QAA10196@forde.anu.edu.au>


I use R Version 0.60 Alpha (September 18, 1997) on a Linux Pentium
(Debian 1.3) and on a Sparc-Sun-Solaris 2.5.=20


R> svd(matrix(1:16,4,4))
=09yields on both machines
Error: error  4  in dsvdc

R> svd(matrix(1:20,4,5))
=09gives a result on the Linux computer
$d
[1]  0  0  0 NA

$u
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1

$v
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0   NA   NA
[4,]    0    0   NA   NA
[5,]    0    0   NA   NA

but causes a Segmentation Fault on the solaris machine.

=09Andreas Weingessel

***********************************************************************=
*
*                          Andreas Weingessel                          =
*
***********************************************************************=
*
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 454=
1 *
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 9=
8 *
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at =
*
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel =
*
***********************************************************************=
*



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Muriel.Comblain@ulg.ac.be  Fri Oct 17 09:34:34 1997
From: Muriel.Comblain@ulg.ac.be (Comblain muriel)
Date: Fri, 17 Oct 1997 10:34:34 +0200
Subject: R-alpha: offset in glm not working
Message-ID: <3.0.1.32.19971017103434.009007d0@pop3.mailst.ulg.ac.be>

Hello,

	With the new version of R (septembre), the function glm seems to ignore
the offset. The ouput is exactly the same with or without the offset
specification. I tried the same program in the version of april and it
worked corectly. 

Best Regards
			Muriel Comblain

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Muriel.Comblain@ulg.ac.be  Fri Oct 17 12:28:50 1997
From: Muriel.Comblain@ulg.ac.be (Comblain muriel)
Date: Fri, 17 Oct 1997 13:28:50 +0200
Subject: R-alpha: offset in glm not working
Message-ID: <3.0.1.32.19971017132850.00900530@pop3.mailst.ulg.ac.be>

>Date: Fri, 17 Oct 1997 10:34:34 +0200
>To: r-devel@stat.math.ethz.ch
>From: Comblain muriel <Muriel.Comblain@ulg.ac.be>
>Subject: offset in glm not working
>
>Hello,
>
>	With the new version of R (septembre), the function glm seems to ignore
the offset. The ouput is exactly the same with or without the offset
specification. I tried the same program in the version of april and it
worked corectly. 
>
>Best Regards
>			Muriel Comblain
>


I forgot to precise that I was speaking about the windows version of R.
Sorry for that!

			Muriel Comblain

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Oct 17 13:42:22 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Oct 1997 14:42:22 +0200
Subject: R-alpha: bug in svd
In-Reply-To: Andreas Weingessel's message of Fri, 17 Oct 1997 16:42:49 +1000
References: <199710170642.QAA10196@forde.anu.edu.au>
Message-ID: <x24t6g8ssx.fsf@blueberry.kubism.ku.dk>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> I use R Version 0.60 Alpha (September 18, 1997) on a Linux Pentium
                  ^^^^^^^^^^
> (Debian 1.3) and on a Sparc-Sun-Solaris 2.5. 

As a matter of principle, that version is not released yet, so it may
contain bugs that shouldn't be seen outside the core team. However,
I seem to get the same errors with 0.50.x (with x==2 because I was to
laz^H^H^Hbusy to upgrade it...), so I suppose it can be discussed here
anyway.

> R> svd(matrix(1:16,4,4))
> 	yields on both machines
> Error: error  4  in dsvdc
> 
> R> svd(matrix(1:20,4,5))
> 	gives a result on the Linux computer

Both examples are rank-2 matrices, the problems disappear with random
matrices, so I suspect that the code is unhappy about dealing with
matrices of less than full rank?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:18:54 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:18:54 -0400
Subject: R-alpha: system()
Message-ID: <97Oct17.112109edt.26498@mailgate.bank-banque-canada.ca>

Here is a minor difference between R and S, but the rather pecular
"numeric" result occasionally seems to cause R to crash when it is used.
I'm not sure if this has been changed in .60.

R : ...

> mode(system("date \'+%Y %m %d %H %M %S\'"))
1997 10 17 10 57 27
[1] "numeric"
>
> (system("date \'+%Y %m %d %H %M %S\'"))[1]
1997 10 17 11 13 55
[1] 0
>
> q()
Save workspace image? [y/n/c]: n
$
$ splus...
>  mode(system("date \'+%Y %m %d %H %M %S\'"))
[1] "character"
>

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 17 16:22:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 17 Oct 1997 17:22:37 +0200
Subject: R-alpha: plot(..... sub = 'sub title')  does not work.
Message-ID: <199710171522.RAA00933@sophie.ethz.ch>

The `sub'  is simply disregarded when given as argument to plot(..)
I think, we'd want it to be passed to title.

In the code of  plot.default, it seems clear how this happens.
We have

> plot.default
function (x, y = NULL, type = "p", col = par("fg"), bg = NA, 
        pch = par("pch"), xlim = NULL, ylim = NULL, log = "", 
        axes = TRUE, frame.plot = TRUE, panel.first = NULL, panel.last = NULL, 
        ann = par("ann"), main = NULL, xlab = NULL, ylab = NULL, 
        cex = par("cex"), lty = par("lty"), lwd = par("lwd"), 
        ...) 
{

	..........

        plot.new()
        plot.window(xlim, ylim, log, ...)
        panel.first
        plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, 
                lty = lty, lwd = lwd, ...)
        panel.last
        pars <- list(...)
        if (axes) {
                axis(1, pars = pars)
                axis(2, pars = pars)
                if (frame.plot) 
                        box(...)
        }
        if (ann) 
                title(main = main, xlab = xlab, ylab = ylab, 
                        pars = pars)
        invisible()
}

> title
function (main = NULL, sub = NULL, xlab = NULL, ylab = NULL, 
        ...) 
.Internal(title(as.char.or.expr(main), as.char.or.expr(sub), 
        as.char.or.expr(xlab), as.char.or.expr(ylab), ...))
	
-------

It is not clear to me which function should be fixed:

Either add 'sub=NULL' to the argument list of plot.default,

1)	 and all will work, but we have yet another arg

or

2)	change the .Internal(title(.....))  such that it also looks for a 
	'sub' arg in its "..." arguments and takes that one if it exists.


To patch plot.default is easier to implement,
but improving (internal) title would have potential
benefits to many other circumstances...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:24:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:24:59 -0400
Subject: R-alpha: system() ok
Message-ID: <97Oct17.112714edt.26498@mailgate.bank-banque-canada.ca>

It seems I just need intern=T. I'll just put this in my small list of S
and R differences:

> mode(system("date \'+%Y %m %d %H %M %S\'", intern=T))
[1] "character"
>

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 17 16:34:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 17 Oct 1997 17:34:23 +0200
Subject: R-alpha: system() ok  --  is.R() function
In-Reply-To: <97Oct17.112714edt.26498@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 17 Oct 1997 11:24:59 -0400)
Message-ID: <199710171534.RAA00952@sophie.ethz.ch>

>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> It seems I just need intern=T. I'll just put this in my small
    Paul> list of S and R differences:

    >> mode(system("date \'+%Y %m %d %H %M %S\'", intern=T))
    Paul> [1] "character"
    >>

Paul, remember that in S-plus,  system(.) does not exist at all.
When you use  system(.) in S-plus,
you use your own version
which I remember you posted as part of your
	``S--R compatibility package''
on R-help or R-devel a while ago.

So I think you should redefine your  system(..) function in S-plus.

BTW: I have been using your  S--R compatibility package for quite a while
     now, and I can assure you that you can shorten it quite a bit, once
     0.60 (this is ``sixty'', not ``six o'') will be out.

Note that I mainly use the `is.R(.)' function
originated by you, but the follow version is ``better'' because it

###--  works in  all versions of
###-- S  (including "S version 4", (beta))
###-- R
###-- S-plus

is.R <- function() { ## returns  'TRUE'  iff we are using 'R'
  exists("version") && !is.null(vl <- version$language) && vl == "R"
}

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:49:24 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:49:24 -0400
Subject: R-alpha: system() NOT ok
Message-ID: <97Oct17.115143edt.26514@mailgate.bank-banque-canada.ca>

Why does parse not work below and why does assigning it crash R?

Paul
________
$ R
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-3 (August 8, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> system("date \'+%Y %m %d %H %M %S\'", intern=T)
[1] "1997 10 17 11 43 21"
> parse(text = system("date \'+%Y %m %d %H %M %S\'", intern=T),white =
T)
1997 10 17 11 43 43
      ^
expression()
> d <- parse(text = system("date \'+%Y %m %d %H %M %S\'",
intern=T),white = T)
1997 10 17 11 44 22
      ^
>
$

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Oct 17 17:08:45 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 17 Oct 1997 09:08:45 -0700 (PDT)
Subject: R-alpha: system() NOT ok
In-Reply-To: <97Oct17.115143edt.26514@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971017090227.10996A-100000@troi>

On Fri, 17 Oct 1997, Paul Gilbert wrote:

> Why does parse not work below and why does assigning it crash R?
> 
> Paul
> ________
> $ R
> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.50 Alpha-3 (August 8, 1997)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type "license()" for details.
> 
> > system("date \'+%Y %m %d %H %M %S\'", intern=T)
> [1] "1997 10 17 11 43 21"
> > parse(text = system("date \'+%Y %m %d %H %M %S\'", intern=T),white =
> T)
> 1997 10 17 11 43 43
>       ^

It doesn't work because space-separated lists of numbers aren't valid R
syntax. You can use 
  >parse(text=strsplit( system("date \'+%Y %m %d %H %M %S\'",
intern=T)," ")[[1]])
 expression(1997, 10, 17, 9, 7, 8)

where strsplit(a,b) splits string a at character b.

	
The crash is a known bug and happens whenever you assign the result of a
syntax error in the parser.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Oct 17 17:19:17 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 17 Oct 1997 09:19:17 -0700 (PDT)
Subject: R-alpha: offset in glm not working
In-Reply-To: <3.0.1.32.19971017132850.00900530@pop3.mailst.ulg.ac.be>
Message-ID: <Pine.SUN.3.95.971017090921.10996B-100000@troi>

On Fri, 17 Oct 1997, Comblain muriel wrote:

> >
> >	With the new version of R (septembre), the function glm seems to ignore
> the offset. The ouput is exactly the same with or without the offset
> specification. I tried the same program in the version of april and it
> worked corectly. 
> >

Yes, this is a bug.  The modelling code was changing quite rapidly at
about the time rsept was built, and it ended up without support for
offsets.

There are two problems. The version of model.frame/model.matrix in
rsept doesn't allow 
	glm(y~x+offset(z))
and the model.offset() function is broken so that
	glm(y~x,offset=z) 
doesn't work. The second problem is easy to fix 

If you define
model.offset  <- function (x) 
{
        offsets <- attr(attr(x, "terms"), "offset")
        if (length(offsets) > 0) {
                ans <- 0
                for (i in offsets) ans <- ans + x[[i]]
        }
        else NULL
}

by adding it to your profile, or by editing the base library
then  glm(y~x,offset=z) will work. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 21:51:37 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 16:51:37 -0400
Subject: R-alpha: on.exit
Message-ID: <97Oct17.165401edt.26506@mailgate.bank-banque-canada.ca>

I seem to be having trouble with on.exit not executing when my code
executes a stop(). Has anyone else noticed this in 0.50alpha 3?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Oct 18 19:32:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Oct 1997 20:32:02 +0200
Subject: R-alpha: This weeks bugs and requests for enhancements
Message-ID: <x2hgaej525.fsf@blueberry.kubism.ku.dk>


Here's a number of items that came up in connection with my course for 
medical ph.d. students this week:

boxplot():
        - deals ungracefully with empty groups and factor levels not
	present in grouping variable.
        - no indication of what variable is being plotted

data.entry() (mostly W95 rseptbeta problems)
        - Entry of first variable name doesn't take before 2nd
        name is entered.
        - data.entry(BW,RMR) gives two columns named BW. Quitting
	dataeditor at that point *overwrites* BW with RMR!
        - inserting NA is only possible by switching to character
	values, entering invalid number, and switching back to numeric
        - blanking a field, then exiting dataeditor crashed one system
	(I *think*)

        Req.f.enhancem.:
        - insert/delete rows (in single column *and* range of columns)
        - undo facilities and "panic button"
        - use comma as decimal point (Nat.variant of W95 maps Keypad
	period to comma)
        - switch between vertical/horizontal cell cursor movement on
	Enter.

Misc:
	quantile() labels results as % rounded to integer, which is
	kind of confusing when 2.5% and 97.5% is one of the first
	things people want to try:
	> quantile(rnorm(1000),c(.025,.975))
	       2%       98% 
	-2.067519  1.891768 

        plot() still has inconsistency with docs in xlog/ylog vs
	log="xy". Which one do we want?

        at some point we want to be able to specify collating
	sequences for sorting character vectors. Case in point: The
	Danish alphabet ends ..uvwxyzæøå , but
        > sort(c("æ","ø","å"))
        [1] "å" "æ" "ø"
        (No such thing as a universal collating seq. E.g. Norwegian
	has the same three letters in a different order. So it should
	probably be via options(collate=..).

        The ~ notation could be used more consistently, in particular
	in t.test and friends.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Oct 18 21:07:58 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 18 Oct 1997 22:07:58 +0200
Subject: R-alpha: Re: problem vith "cmdscale" on W95
In-Reply-To: <3.0.1.32.19971018104425.0069f234@stat.unipg.it> (message from
 Andrea Rossetti on Sat, 18 Oct 1997 10:44:25 +0200)
Message-ID: <199710182007.WAA16232@jessica.ethz.ch>


    AR> I tried to do

    AR> library(mva)
    AR> data(quakes)
    AR> quakes<-quakes[sample(seq(1:1000),100),1:5]
    AR> cmd.dsq<-cmdscale(dsq)
    AR> Error in .C("dblcen", x, as.integer(n)) : C/Fortran function not in load table

    AR> how can I solve this problem?

You should ask this on the mailing list (you only e-mailed to me), 
actually probably better R-devel than R-help.

The above message indicates that the dynamic loading (which should happen
with "library(mva)") did not work in your setup.
I dont know if this is a known problem in Rseptwin or problem of your setup
only.

Good luck,	Martin.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Oct 19 01:53:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 19 Oct 1997 13:53:40 +1300 (NZDT)
Subject: R-alpha: bug in svd
In-Reply-To: <199710170642.QAA10196@forde.anu.edu.au>
References: <199710170642.QAA10196@forde.anu.edu.au>
Message-ID: <199710190053.NAA17919@stat1.stat.auckland.ac.nz>

Andreas Weingessel writes:
 > 
 > R> svd(matrix(1:16,4,4))
 > 	yields on both machines
 > Error: error  4  in dsvdc

This is a bug in the interpreted code.  It assumes that its argument
is real valued.  1:16 produces an integer value.  The fix is to change
the svd function so that the call to LINPACK is

z <- .Fortran("dsvdc", as.double(x), n, n, p, d = double(mm), double(p),
         u = u, n, v = v, p, double(n), as.integer(job),
         info = integer(1), DUP = FALSE)[c("d", "u", "v",
         "info")]

i.e. you have to wrap an "as.double" around "x".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Oct 20 15:46:52 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 20 Oct 1997 10:46:52 -0400
Subject: R-alpha: Re: R-beta: Time Series Analysis
References: <3.0.1.32.19971016182321.006863d4@stat.unipg.it> <3.0.1.32.19971018085459.006a0d04@stat.unipg.it>
Message-ID: <97Oct20.105100edt.26501@mailgate.bank-banque-canada.ca>

>>I have a version of my time series library (DSE) which works 99% in R
>>0.50 Alpha-3. I'm waiting for the soon to be beta release (I
understand
>>this will be R 0.6) before I make it public, since I think a few
things
>>may be changing ...

>I've visited your home page, what DSE file I must download to plug-in
>rseptbeta for W95?

None of the versions currently on my home page work well in R, but I do
have a version which works very well with R. I will put it on my home
page soon, probably about the end of November. If you are really in a
hurry I can make it available for you sooner, but if you wait it will be
easier (for both of us).

I have not yet done any configuration or testing under W95.  Are complex
numbers working in rseptbeta for W95? How should library installation
and compiling of fortran be approached on W95? I currently use Unix make
files.

Paul Gilbert




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Oct 20 17:57:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 20 Oct 1997 12:57:56 -0400
Subject: R-alpha: system() ok  --  is.R() function
References: <199710201331.PAA03410@sophie.ethz.ch>
Message-ID: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>

Martin

Your revisions to my S--R compatability code suggest that tempfile() is
in R after 0.49. I don't find that to be the case. It requires code from
Friedrich Leisch which still has to be added as of 0.50 alpha3.

Paul
_______
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-3 (August 8, 1997)
> exists("tempfile", mode = 'function')
[1] FALSE
>

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Oct 21 07:31:59 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 21 Oct 1997 08:31:59 +0200
Subject: R-alpha: system() ok  --  is.R() function
In-Reply-To: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>
References: <199710201331.PAA03410@sophie.ethz.ch>
 <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>
Message-ID: <199710210631.IAA06442@pc25.none>

>>>>> Paul Gilbert writes:

> Martin
> Your revisions to my S--R compatability code suggest that tempfile() is
> in R after 0.49. I don't find that to be the case. It requires code from
> Friedrich Leisch which still has to be added as of 0.50 alpha3.

> Paul
> _______
> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.50 Alpha-3 (August 8, 1997)
>> exists("tempfile", mode = 'function')
> [1] FALSE
>>

Under Unix, you can do with the following which will also be in 0.60:

tempfile <- function(pattern = "file") {
  system(paste("for p in", paste(pattern, collapse = " "), ";",
               "do echo /tmp/$p$$; done"),
         intern = TRUE)
}


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 21 07:48:57 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 21 Oct 1997 08:48:57 +0200
Subject: R-alpha:  tempfile(.) [in 0.50-a4] -- or  use .C() instead?
In-Reply-To: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Mon, 20 Oct 1997 12:57:56 -0400)
Message-ID: <199710210648.IAA06380@sophie.ethz.ch>

>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> Martin Your revisions to my S--R compatability code suggest that
    Paul> tempfile() is in R after 0.49. I don't find that to be the
    Paul> case. It requires code from Friedrich Leisch which still has to
    Paul> be added as of 0.50 alpha3.

However,  it IS there in  0.50 Alpha-4 :

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-4 (September 10, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> tempfile
function (pattern = "file") 
{
        system(paste("for p in", paste(pattern, collapse = " "), 
                "; do echo /tmp/$p$$; done"), intern = TRUE)
}

----------
(and the same version is in current 0.60 pre-alpha).

Yes, I've thought too, that it could be better to use Fritz' C-version
since that one might also work on non-Unix systems.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Oct 22 23:41:55 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Oct 1997 00:41:55 +0200
Subject: R-alpha: na.woes
Message-ID: <x2u3e9ifnw.fsf@blueberry.kubism.ku.dk>


1) hist() does not take NA's. Incompatible with Splus, probably just a
   bug?

2) I do wish we could somehow get rid of the misfeatures of indexing
with logical NA's:
> table(juul$menarche,juul$tanner)
      I II III IV   V
No  221 43  32 14   2
Yes   1  1   5 26 202
> juul$menarche=="Yes"&juul$tanner=="I",]

...and you find yourself with a listing of 477 cases, of which the 476
are NA-filled. To find the interesting case, you need to go through
the following contortions:

> menar.t1 <- juul$menarche=="Yes"&juul$tanner=="I" 
> menar.t1 <- menar.t1 & !(is.na(menar.t1))        
> juul[menar.t1,]
      age menarche sex igf1 tanner testvol
962 12.33      Yes   F   NA      I      NA

I can't think of a single case where the current behavior is useful.
Indexing with numerical NA's makes sense, e.g. when recoding, and then
there's the boundary case of indexing with a vector where all elements
are logical NA's (should they be promoted to numeric?), but situations
where they arise naturally are pretty hard to think up.

Current behavior is Splus-compatible, but its still annoying.

--------------------

BTW, re. case labels, R is *not* Splus-compatible:

R:
> menar.t1[1]<-NA
> juul[menar.t1,]
      age menarche sex igf1 tanner testvol
NA     NA       NA  NA   NA     NA      NA
962 12.33      Yes   F   NA      I      NA
> menar.t1[2]<-NA
> juul[menar.t1,]
Warning: some row names are duplicated; argument ignored
       age menarche sex igf1 tanner testvol
[1,]    NA       NA  NA   NA     NA      NA
[2,]    NA       NA  NA   NA     NA      NA
[3,] 12.33      Yes   F   NA      I      NA
 
Splus:
> data[c(T,NA,rep(F,14)),]
  x1 x2 x3 x4 migraine not.migraine 
1  0  0  0  0       25          546
  NA NA NA NA       NA           NA
>  data[c(T,NA,NA,rep(F,13)),]
    x1 x2 x3 x4 migraine not.migraine 
 X1  0  0  0  0       25          546
  X NA NA NA NA       NA           NA
X11 NA NA NA NA       NA           NA

Somehow, I don't think we should strive for compatibility on this
point... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Thu Oct 23 20:05:04 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 23 Oct 1997 15:05:04 -0400
Subject: R-alpha: OStype
Message-ID: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>

Robert

I've been looking through my "R -- S compatibility" functions which may
mostly disappear in R 0.60. In fact, it seems already that most of the
things I'm trying to do are for operating system differences rather than
R/S differences. The main problem I am having is that version$os gives
more detail then I usually need, but it is not very convenient for
determining simply if the operating system is Unix. Perhaps you could
suggest a better version of the OStype function below.

Thanks
Paul Gilbert
___________

OStype <- function()
   {if (version$os == "MS Windows") return(version$os)
    if (version$os == "Mac") return(version$os) # needs to be checked
    else return ("Unix")  # not a very satisfactory test
   }

is.MSwindows <- function(){OStype() == "MS Windows"}
is.unix      <- function(){OStype() == "Unix" }



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Kurt.Hornik@ci.tuwien.ac.at  Fri Oct 24 10:55:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 24 Oct 1997 11:55:43 +0200
Subject: R-alpha: OStype
In-Reply-To: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>
References: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>
Message-ID: <199710240955.LAA19249@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Robert
> I've been looking through my "R -- S compatibility" functions which may
> mostly disappear in R 0.60. In fact, it seems already that most of the
> things I'm trying to do are for operating system differences rather than
> R/S differences. The main problem I am having is that version$os gives
> more detail then I usually need, but it is not very convenient for
> determining simply if the operating system is Unix. Perhaps you could
> suggest a better version of the OStype function below.

> Thanks
> Paul Gilbert
> ___________

> OStype <- function()
>    {if (version$os == "MS Windows") return(version$os)
>     if (version$os == "Mac") return(version$os) # needs to be checked
>     else return ("Unix")  # not a very satisfactory test
>    }

Isn't this what machine() does?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 24 11:06:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Oct 1997 12:06:09 +0200
Subject: R-alpha: OStype
In-Reply-To: <199710240955.LAA19249@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 24 Oct 1997 11:55:43 +0200)
Message-ID: <199710241006.MAA10147@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
    >> Robert I've been looking through my "R -- S compatibility" functions
    >> which may mostly disappear in R 0.60. In fact, it seems already that
    >> most of the things I'm trying to do are for operating system
    >> differences rather than R/S differences. The main problem I am
    >> having is that version$os gives more detail then I usually need, but
    >> it is not very convenient for determining simply if the operating
    >> system is Unix. Perhaps you could suggest a better version of the
    >> OStype function below.

    >> Thanks Paul Gilbert ___________

    >> OStype <- function() {if (version$os == "MS Windows")
    >> return(version$os) if (version$os == "Mac") return(version$os) #
    >> needs to be checked else return ("Unix") # not a very satisfactory
    >> test }

    Kurt> Isn't this what machine() does?

Sure,
here is corresponding online help

  HELP> Determine the Machine R is Running On
  HELP> 
  HELP>      machine()
  HELP> 
  HELP> Description:
  HELP> 
  HELP>      This function returns a string which specifies what
  HELP>      kind of environment R is being run in.
  HELP> 
  HELP> Examples:
  HELP> 
  HELP>      if (machine() == "Macintosh")
  HELP>        cat("You are using a Macintosh computer\n")
  HELP> 

Paul's problem is that  machine()  does not exist in  S(plus)...
and the point of his  S--R package is that it is 
	- `source()able' by all versions of S / S-plus / R 
	- defines functions which work on all versions of  ....

However,
he would probably use
	
	.... if(is.R()) machine()  ...

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 28 09:26:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 28 Oct 1997 10:26:34 +0100
Subject: R-alpha: New URL for R-online manual (HTML)
In-Reply-To: <199710280003.NAA28838@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 28 Oct 1997 13:03:48 +1300 (NZDT))
Message-ID: <199710280926.KAA03131@sophie.ethz.ch>

Most important:  (Kurt, R&R,..) Update this in the FAQ and other  pages.
				~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Because of the new (0.60) way of having HTML help for all libraries (not
only "base"), the html files reside in different places.

I have changed the setup such that
from now on, you should 
use
	<A HREF="http://www.stat.math.ethz.ch/R/manual/">
instead of the older
				        ...../R-manual/

(i.e. only replace the `-' by a `/').

The old link continues to work, i.e., it now contains a link to the new
place.

BTW: You currently get the  0.60 (daily snapshot) on-line help
     when using the above URL.

	[[ I will change back to point to a released version of R, once that is
	   less out dated  ;;-) ]]
- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 28 17:37:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 28 Oct 1997 18:37:35 +0100
Subject: R-alpha: Bug[?] in axis(.) -- using format(.) for labels can give nonsense
Message-ID: <199710281737.SAA04464@sophie.ethz.ch>

To see what I mean,
try

 x11()
 par(mfrow=c(2,1))
 x <- 1:100
 plot(x, sin(pi*x/100))
 options(digits= 20)
 plot(x, sin(pi*x/100))

The problem really is in  axis(.) which uses  format(.) for the axis
labels.
I think  the result of axis(.) should NOT be influenced by

	options()$digits.

Should I change it?

--
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Oct 29 01:28:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Oct 1997 02:28:35 +0100
Subject: R-alpha: Bug[?] in axis(.) -- using format(.) for labels can give nonsense
In-Reply-To: Martin Maechler's message of Tue, 28 Oct 1997 18:37:35 +0100
References: <199710281737.SAA04464@sophie.ethz.ch>
Message-ID: <x22015pdbw.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> To see what I mean,
> try
> 
>  x11()
>  par(mfrow=c(2,1))
>  x <- 1:100
>  plot(x, sin(pi*x/100))
>  options(digits= 20)
>  plot(x, sin(pi*x/100))
> 
> The problem really is in  axis(.) which uses  format(.) for the axis
> labels.
> I think  the result of axis(.) should NOT be influenced by
> 
> 	options()$digits.
> 
> Should I change it?

Hm. The root of the problem is this:
>  options(digits= 20)
> 0:5*0.1
[1] 0.00000000000000000 0.10000000000000001 0.20000000000000001
[4] 0.30000000000000004 0.40000000000000002 0.50000000000000000

I.e. the plot labels get a large number of digits because of numerical
inaccuracy, and then there's only room for one of them on the axis.
I say you deserve what you get... 

I'm a bit more worried by

 options(digits=1)
 plot(seq(50.2,50.5,0.1))

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct 29 17:20:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Oct 1997 18:20:01 +0100
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <Pine.SUN.3.95.971029082753.7042B-100000@troi> (message from
 Thomas Lumley on Wed, 29 Oct 1997 08:42:00 -0800 (PST))
Message-ID: <199710291720.SAA01035@sophie.ethz.ch>

	[This is a "spill-over"  from the  "R-core"  mailing list,
	 since several of you may be interested and have comments ... -MM]

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> On 29 Oct 1997, Peter Dalgaard BSA wrote:
    >> Perhaps we should revise the current contents of the base library
    >> and replace some noncrucial items with autoloads? (The ts stuff for
    >> instance, glm, maybe even lm).

    Thomas> It would be interesting to experiment along these lines.
    Thomas> Clearly if something is going to be loaded it saves time and
    Thomas> space to do it immediately, but if it isn't going to be used
    Thomas> it's better to keep it on disk.  Personally, I use glm nearly
    Thomas> every time I use R, but other people may have different needs.

    Thomas> The problem clearly isn't urgent, since the only library slated
    Thomas> for inclusion is ctest, which is nice and compact. However, a
    Thomas> configurable, modular approach seems like a good idea, and
    Thomas> works for emacs.  Given the desire to run R on small machines
    Thomas> we certainly can't follow the S-PLUS path of including
    Thomas> everything useful in the default set-up. For example, survival4
    Thomas> takes up a quarter of the cons cells using the default
    Thomas> settings, and nlme() (if we ever do it) will presumably be
    Thomas> fairly large as well.

NOTE: These things (libraries) are called ``packages'' from 0.60 on ..
					    --------

    Thomas> Perhaps this is more of a r-devel type comment?

Yes ! [and you see, I took the liberty ...]


Actually, I have thought along similar lines:
I think it is a neat concept to use autoload and  more than just the  'eda'
and 'mva'  libraries. 

BTW: Is it a good idea if I include  my  
	stepfun / ecdf     functions into a new library  'stepfun' ?
     ie. a library that belongs to the distribution instead of being contrib?
	
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From rossini@math.SC.EDU  Wed Oct 29 17:50:30 1997
From: rossini@math.SC.EDU (Anthony Rossini)
Date: 29 Oct 1997 12:50:30 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: Martin Maechler's message of "Wed, 29 Oct 1997 18:20:01 +0100"
References: <199710291720.SAA01035@sophie.ethz.ch>
Message-ID: <wnc3elklaqh.fsf@neuromancer.stat.sc.edu>


>>>>> "Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> On 29 Oct 1997, Peter Dalgaard BSA wrote:
    >>> Perhaps we should revise the current contents of the base library
    >>> and replace some noncrucial items with autoloads? (The ts stuff for
    >>> instance, glm, maybe even lm).

    Thomas> It would be interesting to experiment along these lines.
    Thomas> Clearly if something is going to be loaded it saves time and
    Thomas> space to do it immediately, but if it isn't going to be used
    Thomas> it's better to keep it on disk.  Personally, I use glm nearly
    Thomas> every time I use R, but other people may have different needs.

    Martin> Actually, I have thought along similar lines: I think it
    Martin> is a neat concept to use autoload and more than just the
    Martin> 'eda' and 'mva' libraries.

    Martin> BTW: Is it a good idea if I include  my  
    Martin> 	stepfun / ecdf     functions into a new library  'stepfun' ?
    Martin>      ie. a library that belongs to the distribution
    Martin>      instead of being contrib?

Can we do like emacs, and have a means for "dumping" packages into R?
Even if it is just a matter of adding or removing comments in
appropriate places, this could be useful.  Just like emacs, this would
increase the initial size, but means that little time is wasted during
load.

[I assume that the discussion is with respect to replacing packages
with autoloads, and I for one would consider doing that with some of
the packages as a "Good Thing"(tm) (since I've got to the point that
I'd rather wait to have things grow as I need them, rather than let
them start huge and grow incrementally at a small pace).]

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulhu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Oct 29 17:48:23 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 1997 12:48:23 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
References: <199710291720.SAA01035@sophie.ethz.ch>
Message-ID: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>

Perhaps someone could bring those of us not in "core" up to date a bit.
What are advantages of autoload and the implications, especially for
memory and speed.  Currently I have to divide my package into several
pieces in order to load it (I'm not too  sure why, but it is fairly
big). This is what I do:

R  -v6 -n250000
library("dse/tframe")
library("dse/dse1")
library("dse/dse2")
library("dse/dsex1")
library("padi/padi")
library("dse/dsex2")

Some pieces are much more important and frequently used than others.
Also, within some pieces there are functions which are used a lot more
than others. Should I consider autoloading everything? Will I still need
to divide the package into pieces? Should I avoid autoloading anything
that is used really frequently?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Thomas Lumley <thomas@biostat.washington.edu>  Wed Oct 29 18:57:28 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Wed, 29 Oct 1997 10:57:28 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029103311.7363A-100000@troi>

On Wed, 29 Oct 1997, Paul Gilbert wrote:

> Perhaps someone could bring those of us not in "core" up to date a bit.
> What are advantages of autoload and the implications, especially for
> memory and speed. 

There is very little difference between explicit loading using library() 
or require() and autoload(). 

If you type 
	autoload("myfun","package") 
then typing, say,
	a<-myfun(42)
is equivalent to 
	library(package)
	a<-myfun(42)
This is accomplished by subtle magic involving the "lazy evaluation"
mechanism.

Using autoload() has a (small) additional overhead in speed and memory (12
cons cells), as the autoload information must be stored somewhere and it
must be parsed when myfun() is called. It is also possible that functions
which do creative things with sys.frame()  may not like being autoloaded,
but I don't have any examples.

The main difference in speed over putting a library() statement in
Rprofile is that the delay happens when the function is first used rather
than when R is started.

>	Should I consider autoloading everything? Will I still need
> to divide the package into pieces? Should I avoid autoloading anything
> that is used really frequently?

As autoload("myfun","package") works by arranging for 
	library("package")  
to be evaluated in the global environment the first time myfun() is called
it should work the same as library().

If you know what functions you use all the time, it may well make sense to
just use library() to load them. 

The point of autoload() is transparency.  If you want survival analysis
routines available for your or your students' occasional use, but don't
want to sacrifice 40000 cons cells and 100k of vector heap, you can put a
set of autoloads in Rprofile for all the common functions in survival4 and
have them available if they are needed. 

It also makes sense for a package containing some rarely used features to
be divided in two, so that you initially load the commonly used features
and autoloads for the other.  In the version of survival4 for R0.60 coming
very soon, the US census mortality tables that come with survival4 for S
are in a separate package with autoloads to load them only if they are
needed.  Since they occupy nearly 200k of the vector heap and I personally
have never used them this is a worthwhile saving.

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Wed Oct 29 19:05:23 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 29 Oct 1997 11:05:23 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029110137.7363D-100000@troi>


One disadvantage, probably fixable, of autoload over loading in Rprofile
that I forgot to mention is that the help for a package isn't available
until it's loaded.

So

	library(eda)
	help(smooth)
works, but
	autoload("smooth","eda")
	help(smooth)
doesn't.

If this is a big problem it should be possible to modify help().

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Oct 29 19:54:30 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 1997 14:54:30 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
References: <Pine.SUN.3.95.971029103311.7363A-100000@troi>
Message-ID: <97Oct29.151248est.26572@mailgate.bank-banque-canada.ca>

If I understand this correctly, the whole package gets autoloaded the
first time any function in the package is referenced (and then never
unloaded until q()?).  Thus there would be an advantage to reorganizing
frequently used functions and infrequently used functions in separate
packages. The current organization of the code in my packages is based
on a different logic. For example, I have a test function in the package
to test functions in the package. This function may never be used by
someone who uses the package.

Would it be possible/logical/easy  to make autoload work on a function
by function basis? (Sounds a bit like an S .Data directory.) Is there a
limit on how many packages can be autoloaded?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Wed Oct 29 20:56:15 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 29 Oct 1997 12:56:15 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package
In-Reply-To: <97Oct29.151248est.26572@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029123224.7756A-100000@troi>

On Wed, 29 Oct 1997, Paul Gilbert wrote:

> If I understand this correctly, the whole package gets autoloaded the
> first time any function in the package is referenced (and then never
> unloaded until q()?).

Yes, though you can explicitly unload a package with
	detach("package:package") 
and it will still be reloaded automatically when needed. 
 
> Would it be possible/logical/easy  to make autoload work on a function
> by function basis? (Sounds a bit like an S .Data directory.) Is there a
> limit on how many packages can be autoloaded?
> 

Possible and easy, but not logical:

There's no strict limit to the number of packages, but the overhead goes
up sharply as the packages get smaller.  For the current sorts of package
the overhead would be trivial, but for one-function packages it would be
quite large.  Increasing the number of packages loaded also slows a lot of
things down, as the search path gets longer and longer. 

There is also some overhead on opening files, so loading lots of little
packages is slower than loading one big package.

I think autoload() is only worthwhile on largish, coherent blocks,
especially in its current interpreted form. Anything more ambitious would
probably require delving into the internal C code that finds and evaluates
things, and considering horrible things like caching and buffering for
disk access. 

	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Thu Oct 30 08:10:54 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 30 Oct 1997 09:10:54 +0100 (MET)
Subject: R-alpha: nlme
Message-ID: <9710300810.AA18176@alpha.luc.ac.be>

In the discussion on packages, I noted the following phrase:

and nlme() (if we ever do it)

I am waiting impatiently for this to be done. I contacted Douglas
Bates sometime ago, who said that it would be difficult because of the
differences in internals between R and S. I have looked at the code,
but it is too much for me: I know nothing of S. Is there a volunteer???
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 09:02:29 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 10:02:29 +0100
Subject: R-alpha: Bug[let] in (internal) print [for a list with dimnames ...].
Message-ID: <199710300902.KAA00502@sophie.ethz.ch>

Try the following code.
In S-plus, it does print nicely..

 n <- 17
 fac <- factor(rep(1:3, len = n), levels = 1:5)
 tfq <- tapply(1:n, fac, quantile)
 tfq
 print.default(tfq)
 if(version$minor >= 60) str(tfq)  else  c(tfq)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:29:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:29:47 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
Message-ID: <199710301029.LAA00845@sophie.ethz.ch>

Evaluate the following example to get the behavior :

		--- anybody: patch ? ---


tst.i <- function(x)
{
  if(missing(x))
    return(invisible())
  else if(!is.numeric(x)) stop("x must be numeric")
  ## else
  invisible((x+3)^2)
}

tst.i()#-- should NOT print anything !!
print(mode(tst.i()))#--gives "NULL"   both in S-plus 3.4 and R 0.60

tst.i(1)# nothing (ok in R and S-plus)
1 + tst.i(1) #> 17
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:40:36 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:40:36 +0100
Subject: R-alpha: c(..., a) fails [in a function(x, ...)]
Message-ID: <199710301040.LAA00947@sophie.ethz.ch>

A minor inconsistency to  S  which can (I think did) break existing code
(ported from S to R):
 
In R, the  "..." arguments cannot be passed to 'c(..)' :

  ex3.. <- function(...) c(...,exp(1))
  ex3..()# 2.718282
  ##R  Error: ... used in an incorrect context
  ex3..(1:2)# 1 2  2.718282
  ##R  Error: ... used in an incorrect context

  ##--- Only this one works in R 0.60 (Oct.28) also:
  ex4.. <- function(...) c(unlist(list(...)),exp(1))
  ex4..()# 2.718282
  ex4..(1:2)# 1 2  2.718282
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:54:52 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:54:52 +0100
Subject: R-alpha: names(j) <- NULL  fails for a `call' object
Message-ID: <199710301054.LAA01011@sophie.ethz.ch>

I found this ((as part of a more severe problem which WAS fixed))
in   ``old closed tasks'' a while ago..

It still _is_ a  (minor) problem, i.e. an  R<-->S inconsistency


##- TASK:	Name Attributes on Calls
##- STATUS: Closed
##- FROM:	<p.dalgaard@kubism.ku.dk>
##- 	A call with tagged arguments is something like a list, the tags
##- 	can be used to access elements, but the names attribute is absent,
##- 	until the call is coerced to a list. (Attempting to set the names()
##- 	causes evaluation. Changing "list" to "blipblop" causes an 'Error:
##- 	couldn't find function "blipblop"' at that point.)

print(j <- substitute(list(a=1, b=2)))##	list(a = 1, b = 2)
mode(j); is.call(j)#  "call" ,  TRUE
j$b##	[1] 2
names(j)# [1] ""  "a" "b"

names(j) <- NULL ; j #-- doesn't do anything in R -- but does in S-plus
## S:   list(1, 2)
## R-0.50-a2 and  R-0.50-a4 :
##	list(a = 1, b = 2)
mode(j)#>  [1] "call"
names(j)# S: NULL;  R:  ""  "a" "b"

names(j) <- c("", "CC", "DD"); j #-- this DOES work ...
names(j) <- c("", "", ""); j #-- this DOES work ...
names(j) <- c("blipblop", "x", "y"); j# no change to 'list' [[same for R and S]]
## list(x = 1, y = 2)
names(j) #  [[same for R and S]]:
## [1] "blipblop" "x"        "y"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 12:10:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 13:10:58 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: Martin Maechler's message of Thu, 30 Oct 1997 11:29:47 +0100
References: <199710301029.LAA00845@sophie.ethz.ch>
Message-ID: <x2en53o3hp.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> Evaluate the following example to get the behavior :
> 
> 		--- anybody: patch ? ---
> 
> 
> tst.i <- function(x)
> {
>   if(missing(x))
>     return(invisible())
>   else if(!is.numeric(x)) stop("x must be numeric")
>   ## else
>   invisible((x+3)^2)
> }

Actually, 
> tst.i<-function()return(invisible(3))
> tst.i()
[1] 3

(in my snapshot of 0.60, Oct 24) So return(invisible(...)) just
doesn't work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Thu Oct 30 14:52:54 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 30 Oct 1997 08:52:54 -0600 (CST)
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: <199710301029.LAA00845@sophie.ethz.ch> from "Martin Maechler" at Oct 30, 97 11:29:47 am
Message-ID: <9710301452.AA04275@nokomis.stat.umn.edu>

Martin Maechler wrote:
> 
> Evaluate the following example to get the behavior :
> 
> 		--- anybody: patch ? ---
> 
> 
> tst.i <- function(x)
> {
>   if(missing(x))
>     return(invisible())
>   else if(!is.numeric(x)) stop("x must be numeric")
>   ## else
>   invisible((x+3)^2)
> }
> 
> tst.i()#-- should NOT print anything !!
> print(mode(tst.i()))#--gives "NULL"   both in S-plus 3.4 and R 0.60
> 
> tst.i(1)# nothing (ok in R and S-plus)
> 1 + tst.i(1) #> 17

I'm still running 0.49 and there the behavior is a bit different (if I
understand your description right):

tst.i <- function(x=0)
 {
   if(missing(x))
     return(invisible())
   else if(!is.numeric(x)) stop("x must be numeric")
   ## else
   invisible((x+3)^2)
}

gives
> tst.i()
>         # in current R this is NULL?

In any case, here are a few random remarks on this.  Both invisible
and return are somewhat peculiar entities in Splus at least.  In Splus
the official semantics of invisible are (from help)

       the function invisible reaches back 2 frames  and  sets  a
       special  flag, .Auto.print, to FALSE.  This has the effect
       of preventing automatic printing if the  function  calling
       invisible  was called from the top level since .Auto.print
       in frame 1 is set to FALSE.

which means that the argument is pretty much irrelevant;

	function() { invisible(); 1 }
and
	function() { invisible(1) }

are equivalent. I'm not sure what the official semantics of invisible
are in R; operationally these two act differently in 0.49.

Return in Splus is a keyword and doesn't have a function definition,
so it isn't quite clear how return(invisible()) should behave. In R
return seems to be just another function whose action happens to be to
execute a return from one frame back (or whatever). That means that I
would expect

	function(x) { return(invisible(x)) }
and
	function(x) { g(invisible(x)) }

with g<-function(x) { x } to produce identical results as far as
invisibility is concerned, and they do.

I think many users think that invisible() can be thought of as
attaching an invisibility property to its argument and that that
property ought to remain with the argument for a while at least
(probably an assignment should strip it?) -- this would lead to

	return(invisible())

acting as you suggest (and maybe it currently does if I misunderstood
what is happening). It would also mean that

	myprint<- function(...) { print(...) }

would act as you might expect; right now it does in R (and since I'm
not sure about the offical semantics I'm not sure if this should
suprprise me or not) but in Splus (in accord with the semantics given
above) it does not -- you get

>  myprint(1)
[1] 1
[1] 1
>

Officially adding such a property (if it sin't already there -- I'm
not sure on this) might make some things cleaner, but it's not clear
what other cans of worms this would open up.

Other languages take a different approach -- they allow a function
used for side effects to return no values, so there is nothing to
print -- this covers most though not all cases where invisible() is
used now.


-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 15:17:08 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 16:17:08 +0100
Subject: R-alpha: Minor plotting problems
In-Reply-To: Martin Maechler's message of Thu, 30 Oct 1997 11:54:52 +0100
Message-ID: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk>

1) There's a curious asymmetry between points and lines, in that you can
do
lines(...,type='p')
but not
points(...,type='l')
(and more importantly, not points(..., type='b'), which probably
*could* arise in real work)

This isn't deliberate, is it?

2) Did I remember to report the adverse effect of having plot(x,y)
coerce its argument to numeric? Several of my students managed to set
the data type to "character" in data.entry(), do a plot(bw,rmr) with
no apparent problem, and *then* become absolutely perplexed when
lm(rmr~bw) yields

Error in model.frame(formula, data, substitute(list(...)), subset,
na.action) : invalid variable type

3) The first few lines of hist() should be

        if (!is.numeric(x)) 
                stop("hist: x must be numeric")
        eval(main)
        eval(xlab)
        x <- x[!is.na(x)]
 
The two 'eval's are necessary to avoid strange side effects of
modifying x. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 15:27:51 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 16:27:51 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: Luke Tierney's message of Thu, 30 Oct 1997 08:52:54 -0600 (CST)
References: <9710301452.AA04275@nokomis.stat.umn.edu>
Message-ID: <x2hg9zuv7s.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> Other languages take a different approach -- they allow a function
> used for side effects to return no values, so there is nothing to
> print -- this covers most though not all cases where invisible() is
> used now.

If you think in terms of functionality as opposed to actually calling
invisible(), a rather notorious exception would be "<-". It's a
primitive, not a function, but it returns the evaluated right hand
side without printing it.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Thu Oct 30 16:18:44 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 30 Oct 1997 10:18:44 -0600 (CST)
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: <x2hg9zuv7s.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Oct 30, 97 04:27:51 pm
Message-ID: <9710301618.AA04456@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Luke Tierney <luke@stat.umn.edu> writes:
> 
> > Other languages take a different approach -- they allow a function
> > used for side effects to return no values, so there is nothing to
> > print -- this covers most though not all cases where invisible() is
> > used now.
> 
> If you think in terms of functionality as opposed to actually calling
> invisible(), a rather notorious exception would be "<-". It's a
> primitive, not a function, but it returns the evaluated right hand
> side without printing it.
> 

That's why I said "most" :-). Of course whether being able to write

	x<-y<-z

is a good thing or not ... :-)


-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Fri Oct 31 03:01:52 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Thu, 30 Oct 1997 21:01:52 -0600 (CST)
Subject: R-alpha: nlme in R
Message-ID: <m0xR7LM-000hruC@franz.stat.wisc.edu>

Tony Rossini sent me a copy of Jim's message to this list asking about 
nlme.  I was surprised to find that I had not subscribed to this
list.  I thought I did but apparently not.  I have now corrected that.

Development of the nlme library (the name is from "nonlinear
mixed-effects" but the library can also be used to fit general forms
of linear mixed-effects models) is a continuing research project for
Jose' Pinheiro and me.  Earlier this week Jose' spoke at the S-Users'
Conference about the design and development of the nlme 3.0 library.
The most visible change for nlme 3.0 is that it now can incorporate
nested random-effects terms.  In other words, it fits multilevel
models.  I'll check with Jose' on making the transparencies from that
talk available over the internet if people want to get more details.

Jim's question was "can it be ported to R?".  It is a lot of code.
Some of it would be easy to port.  Some of it would be extremely hard
to port.  "Extremely hard" means it would be easier to re-design and
re-write those parts from scratch.

The easy part is the linear mixed-effects code.  There is code in both 
S and in C but the C code is pretty straightforward.  The S code sets
up the model, formulates starting estimates for the parameters that
determine the variance-covariance matrices of the random effects,
calls some C code to do several EM iterations to refine the parameter
estimates then sets up the maximum likelihood estimation or REML
estimates as an ms() optimization.  I myself haven't tried to do this
in R but I think it is feasible to substitute nlm() for ms() at this
point.

There are a host of classes and methods that are defined to help with
this process and with examining the original data and the fitted
models.  *All* of these classes define their plot methods and other
graphical methods through trellis functions.  That means that either
the relevant trellis functions would have to be cloned or all the
graphical routines would have to be replaced or one would have to do
without graphics.  Some indication of the power of trellis for these
models is in the slides of Jose's presentation which should be
available soon at
     http://cm.bell-labs.com/cm/ms/departments/sia/project/nlme/

The nonlinear mixed-effects code will also be a problem.  It
alternates between two optimizations - one using ms() on a linear
mixed-effects problem and one using a special optimization routine for
a penalized nonlinear least squares problem.  The code for the second
one is intimately tied in with the S evaluation process and the frames
in S.  It would be necessary to re-write it from scratch.  Probably it
would be best to re-design it entirely.

More details available upon request.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 31 11:11:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 31 Oct 1997 12:11:23 +0100
Subject: R-alpha: Minor plotting problems //  \itemize{..} in *.Rd
In-Reply-To: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 30 Oct 1997 16:17:08 +0100)
Message-ID: <199710311111.MAA02054@sophie.ethz.ch>

>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

    Peter> 1) There's a curious asymmetry between points and lines, in that
    Peter> you can do lines(...,type='p') but not points(...,type='l') (and
    Peter> more importantly, not points(..., type='b'), which probably
    Peter> *could* arise in real work)

    Peter> This isn't deliberate, is it?

I've always thought is *WAS* deliberate...
At least it made sense to me at the time when I thought about it.

Anyway, we shouldn't be ``bossy'' on users, therefore,
I am about to change it (and its documentation)...

------------------------------

BTW, Fritz,  do we have [or will we soon ? ;-) ]

	\enumerate{
	 \item first
	 \item second
	  ....
	}

	and the same for \itemize{ ... } ....
	
  [ However, LaTeX's  ``description'' is already taken in our Rd format..... ]

-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 31 18:36:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 31 Oct 1997 19:36:48 +0100
Subject: R-alpha: Minor plotting problems  [improved hist()]
In-Reply-To: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 30 Oct 1997 16:17:08 +0100)
Message-ID: <199710311836.TAA02661@sophie.ethz.ch>

>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

    Peter> 1) There's a curious asymmetry between points and lines, in that
    Peter> you can do lines(...,type='p') but not points(...,type='l') (and
    Peter> more importantly, not points(..., type='b'), which probably
    Peter> *could* arise in real work)

Now fixed in current source.

    Peter> 2) Did I remember to report the adverse effect of having
    Peter> plot(x,y) coerce its argument to numeric? Several of my students
    Peter> managed to set the data type to "character" in data.entry(), do
    Peter> a plot(bw,rmr) with no apparent problem, and *then* become
    Peter> absolutely perplexed when lm(rmr~bw) yields

    Peter> Error in model.frame(formula, data, substitute(list(...)),
    Peter> subset, na.action) : invalid variable type

I agree that plot  shouldn't coerce character x / y to numeric.
Nothing yet done.
	[Peter,  you can do the changes if you like ..]


    Peter> 3) The first few lines of hist() should be

    Peter>         if (!is.numeric(x)) stop("hist: x must be numeric")
    Peter> eval(main) eval(xlab) x <- x[!is.na(x)]
 
    Peter> The two 'eval's are necessary to avoid strange side effects of
    Peter> modifying x.

Ok, I've done quite a bit more. 

hist is ``better'' now
	 [[the ``nclass'' discussion is not yet done ... !]]:  

	1) allows  `plot = FALSE'  [as S; but really IS useful]
	2) Default for 'freq:  TRUE only if breaks are equispaced
			(otherwise the plot is graphically *WRONG*)

The following is now in 0.60 :

"hist" <-
function (x, breaks, freq = NULL, col = NULL, border = par("fg"),
	main = paste("Histogram of" , deparse(substitute(x))),
	xlim = range(breaks), ylim = range(counts, 0),
	xlab = deparse(substitute(x)), ylab,
	axes=TRUE, plot = TRUE, ...)
{
	if (!is.numeric(x)) 
		stop("hist: x must be numeric")
	eval(main)
	eval(xlab)
	n <- length(x <- x[!is.na(x)])
	use.br <- !missing(breaks) && length(breaks) > 1
	breaks <-
	  if(use.br) sort(breaks)
	  else {
		rx <- range(x)
		pretty (rx + c(0, diff(rx)/1000), 
			n = if(missing(breaks)) 1 + log2(n)
			else { # breaks = `nclass'	
				if (is.na(breaks) | breaks < 2) 
				  stop("invalid number of breaks")
				breaks
			})
	  }
	nB <- length(breaks)
	counts <- .C("bincount", 
		as.double(x), 
		n, 
		as.double(breaks), 
		nB,
		counts = integer(nB - 1), 
		NAOK = FALSE) $counts
	if (any(counts < 0)) 
	 stop("negative `counts'. Internal Error in C-code for \"bincount\"")
	if (is.null(freq)) 
	  freq <- if(use.br) {
		##-- Do frequencies if breaks are evenly spaced ...
		h <- diff(breaks)
		diff(range(h)) < 1e-10 * h
	  } else TRUE
	if (!freq) {
		counts <- counts/(sum(x) * diff(breaks))
		if (missing(ylab)) 
			ylab <- "Relative Frequency"
	}
	else if (missing(ylab)) 
		ylab <- "Frequency"
	if(plot) {
		plot.new()
		plot.window(xlim, ylim, "")
		title(main = main, xlab = xlab, ylab = ylab, ...)
		if(axes) {
			axis(1, ...)
			axis(2, ...)
		}
		rect(breaks[-length(breaks)], 0, breaks[-1], counts,
		     col = col, border = border)
		invisible(NULL)
	} else list(breaks = breaks, counts = counts)
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Thu Oct  2 00:11:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 1 Oct 1997 16:11:20 -0700 (PDT)
Subject: R-alpha: R-beta: hat
In-Reply-To: <199710010207.OAA22329@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.971001160904.8966C-100000@troi>


The hat() function, returning the diagonal of the hat matrix, currently
works only on matrices and doesn't work with weights.  Could we make it
return lm.influence(x)$hat when inherits(x,"lm")?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Oct  2 12:24:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 02 Oct 1997 13:24:35 +0200
Subject: R-alpha: R-beta: hat
In-Reply-To: Thomas Lumley's message of Wed, 1 Oct 1997 16:11:20 -0700 (PDT)
References: <Pine.SUN.3.95.971001160904.8966C-100000@troi>
Message-ID: <x2hgb0z9u4.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> The hat() function, returning the diagonal of the hat matrix, currently
> works only on matrices and doesn't work with weights.  Could we make it
> return lm.influence(x)$hat when inherits(x,"lm")?

Shouldn't it be the other way around? i.e. lm.influence(x) sets $hat
to hat.lm(x)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Oct  4 16:49:15 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 4 Oct 1997 17:49:15 +0200
Subject: R-alpha: paste problem in TASKS --- yes, I do really want it
Message-ID: <199710041549.RAA01183@sophie.ethz.ch>

This is from line 104 of current TASKS:

----------------------------------------------------------------------
TASK:	"paste" problem
STATUS:	Open
FROM:	maechler@stat.math.ethz.ch
	in S,
		paste(....., collapse = string)
	always returns ONE string  (a character vector of length 1),
	according to documentation and several examples.
	in R, this is not true:
		R> paste(rep(" ",0), collapse="...") #anything for collapse
		character(0)
		S> paste(rep(" ",0), collapse="...") #anything for collapse
		[1] ""
	Again, I think	R  is more logical than S here, but it was decided
	that in minor cases, compatibility comes first...
	[ Low priority.	 Complain if you really need it. ]
			 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
			 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I hereby complain .

Yes I do want it.  The current behaviour results in  code being broken 
which would work otherwise.
{{of course I can always fix that code by an extra if(....) else .....
  but the point is that if  parse(..) behaved more reasonable,
  I did not have to fix that code..
}}

Yet another example is the  `fun()' Example in  ?tempfile
[in the latest snapshot of R-0.60]
which terminates on error for me just because of the above bug:

fun <- function() {
  FILE <- tempfile("fun")
  on.exit(unlink(FILE))
  system(paste("printenv >", FILE))
  x <- strsplit(scan(FILE, what = ""), "=")
  v <- n <- character(LEN <- length(x))
  for (i in 1:LEN) {
    n[i] <- x[[i]][1]
    v[i] <- paste(x[[i]][-1], collapse = "=")
  }
  structure(v, names = n)
}

> fun()
Read 83 items
Error in "[<-"(c("/u/sfs/adm", "/usr/local/bin", ".:/u/maechler/bib:/u/maechler/tex/styles:.:/u/sfs/bib",  : nothing to replace with

--- and the reason is:    x[[i]][-1]  is empty (some environment values are
					        just defined with no value ..)
 in which case 
		 paste(x[[i]][-1], collapse = "=")
 returns 
		 character(0)

 where it rather should return (IMHO)  
	
		 ""

 v[i] <- character(0)  then gives the error, whereas
 v[i] <- ""		would exactly produce what is wanted.

-----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rcreecy@census.gov  Tue Oct  7 15:29:54 1997
From: rcreecy@census.gov (Rob Creecy)
Date: Tue, 07 Oct 1997 10:29:54 -0400
Subject: R-alpha: Compiling R with Microsoft Visual C++
References: <199710041549.RAA01183@sophie.ethz.ch>
Message-ID: <343A4760.12EA742@census.gov>

I tried compiling R-0.50-a4 with Microsoft Visual C++ 5.0  on Windows NT
4.2
and have some problems.
I am doing this with the hope of being able to contribute to further
development of R
for Windows.

I followed the instructions in the R/src/windows directory, copying the
resulting files to my PC.
Most source files that are not  Windows dependent compile fine, others
such as
wincons.c, plotmath.c do not. I have noticed some missing header files:
<env.h>                not in my compiler distribution
<dl.h>                   is this HP specific? presumably not needed
shellapi.h

I am also not sure if all the needed symbols  and compiler options are
being
properly defined at compile time.
If a working makefile could be made available it might give me some
clues
about how to proceed.

Any suggestions?

Rob Creecy
Census Bureau



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Oct  7 16:46:17 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Oct 1997 17:46:17 +0200
Subject: R-alpha: Compiling R with Microsoft Visual C++
In-Reply-To: Rob Creecy's message of Tue, 07 Oct 1997 10:29:54 -0400
References: <199710041549.RAA01183@sophie.ethz.ch>
 <343A4760.12EA742@census.gov>
Message-ID: <x2bu118tkm.fsf@blueberry.kubism.ku.dk>

Rob Creecy <rcreecy@census.gov> writes:

> 
> I tried compiling R-0.50-a4 with Microsoft Visual C++ 5.0  on Windows NT
> 4.2
> and have some problems.

...

> If a working makefile could be made available it might give me some
> clues
> about how to proceed.
> 
> Any suggestions?

Um, "keep up the good work"? ;^)

Seriously, the current situation is that Robert Gentleman knows how to
compile the code with Watcom C, and that's about it. The rest of us
(with the possible exception of Thomas Lumley) are old Unixers,
utterly perplexed at the Microsoft Programming Universe in general,
and the so-called "user-friendly" Windows development environments in
particular. I got about as far as you when I tried, only more clueless
as to Visual C++ itself. 

So you are essentially on your own, but whatever progress you make
will be greatly appreciated, because the situation is certainly not
very desirable.

One hint, though: Try copying the include files to Unix and use grep
and gcc -E to figure out what is needed from which include files.

In the longer run, we need to set up the possibility of compiling with
several PC compilers, preferably freeware ones, too. Maybe even
crosscompiling from Unix and using a portable GUI library (dream on,
Peter...). I'm having my eyes rather strongly set on the RSXNT
compiler setup, or Gnuwin32, but the latter is a bit large. At the
moment, I'm all engaged in my course in Basic Statistics for Medical
Researchers, though, so I'm not likely to get any further until
December, unless I get a sudden strike of inspiration.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Oct  7 23:33:20 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 8 Oct 1997 11:33:20 +1300 (NZDT)
Subject: R-alpha: keep.order in formulae
Message-ID: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>

[ I'm teaching log-linear models at present, and looking at Agresti's
  book. ]

Often when producing analyis of variance or analysis of deviance
tables it is important to get effects fitted in a specific order.
At present in S / R this is done as follows:

	anova( glm( terms(formula, keep.order=T), ...) )

Can anyone think of a reason why keep.order should not become an
argument to "lm" and "glm", rather than forcing the use of "terms".
I.e., the above could be written:

	anova( glm(formula, ..., keep.order=T) )

Having to resort to the use of "terms" seems like a complication my
punters could do without.

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Oct  8 08:37:47 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 8 Oct 1997 09:37:47 +0200 (MET DST)
Subject: R-alpha: call_R in fortran
Message-ID: <9710080737.AA02034@alpha.luc.ac.be>

While the discussion is on Fortran, any chance of being able to call R
functions from Fortran? I did a hack way back when, when I was
originally working on what became nlm but would like something better.
  Thanks. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct  8 09:51:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 8 Oct 1997 10:51:35 +0200
Subject: R-alpha: dump() / dput() -- fail for "environmental" and attributed functions
Message-ID: <199710080851.KAA02610@sophie.ethz.ch>

Here is a simple example to show what I mean:

	f1 <- approxfun(1:3, 2:4)

	dump("f1", file="")

which yields (in current development snapshot; 
	      other versions are conceptually equivalent)

"f1" <-
function (v) 
.C("approx", as.double(x), as.double(y), n, xout = as.double(v), 
        length(v), as.integer(method), as.double(yleft), as.double(yright), 
        as.double(f), NAOK = T)$xout

i.e., the 'environment' part is not dumped.


Probably, we can well live without this working.
However, dump(.) or dput(.) then should produce a warning or error.
-------

But the problem is more general:
In newer versions of R  functions can have attributes,
(including a "class") -- which is very useful as already mentionend here.

However, even these are NOT dumped properly, and they SHOULD be!

fa <- function(x) x + 1
attr(fa, "class") <- "simple.fun"
dput(fa)

#-- results (wrongly) in

 function (x) 
 x + 1

i.e. `forgets' about the class attribute which you see when printing fa.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct  8 10:36:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 8 Oct 1997 11:36:37 +0200
Subject: R-alpha: wish:  segments(.) / arrows(.)  should allow an 'lwd = <num>' argument
Message-ID: <199710080936.LAA02666@sophie.ethz.ch>

(as the subject says).


Actually, I found that

	arrows
	segments
	rect

have no "..." and no "lwd"  argument
whereas

	lines.default
	polygon
	box

do all have a "..." (but no explicit 'lwd')
which they pass to .Internal( c-code )

-------

For anyone who feels like fixing this:

All the relevant code is in  src/main/plot.c,
and the function are

	do_arrows
	do_segments
	do_rect
etc.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Oct  8 10:48:04 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 8 Oct 1997 11:48:04 +0200
Subject: R-alpha: keep.order in formulae
In-Reply-To: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>
References: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>
Message-ID: <199710080948.LAA02704@UNKNOWN_7>

>>>>> Ross Ihaka writes:

> [ I'm teaching log-linear models at present, and looking at Agresti's
>   book. ]

> Often when producing analyis of variance or analysis of deviance
> tables it is important to get effects fitted in a specific order.
> At present in S / R this is done as follows:

> 	anova( glm( terms(formula, keep.order=T), ...) )

> Can anyone think of a reason why keep.order should not become an
> argument to "lm" and "glm", rather than forcing the use of "terms".
> I.e., the above could be written:

> 	anova( glm(formula, ..., keep.order=T) )

> Having to resort to the use of "terms" seems like a complication my
> punters could do without.

Right.  (Hadn't know about keep.order before ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct  9 09:41:04 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 9 Oct 1997 10:41:04 +0200
Subject: R-alpha: [sboker@calliope.psych.nd.edu: Re: S-PLUS on UNIX plans]
Message-ID: <199710090841.KAA04122@sophie.ethz.ch>

--Multipart_Thu_Oct__9_10:41:03_1997-1
Content-Type: text/plain; charset=US-ASCII

In case you did not realize how much this is related to R :


--Multipart_Thu_Oct__9_10:41:03_1997-1
Content-Type: message/rfc822

Return-Path: s-sender@utstat.toronto.edu
From: "Steven M. Boker" <sboker@calliope.psych.nd.edu>
Date: Wed,  8 Oct 97 16:37:05 -0500
To: s-news@utstat.toronto.edu
Subject: Re: S-PLUS on UNIX plans

My apologies for sending this out in non-ascii text format. (blush)
Here is the message.

On Tue, 7 Oct 1997, Gregory R. Warnes wrote:
>I applaud MathSoft's interest in porting Splus to Linux, and can
>echo "Z. Todd Taylor" comments.
>
>For those who are interested in GNU software, there is an S clone
>in development.  It is named R and can be obtained from
><http://lib.stat.cmu.edu/R.  It is already quite useful, but of
>course, does not have many of the enhancements added to Splus by
>MathSoft.
>

Another poster also was wondering about a Mac version.  I ported
R to OpenStep, the precursor to Apple's new Rhapsody OS.  Rhapsody's
core is just just BSD Unix, so the port took about 4 hours to find
the few definitions that had to be changed.  Of course, this is
just a command-line version.  But the language is, IMHO, the heart
and soul of Splus and how it differentiates itself in the marketplace.
I submit that a port to Linux and a port to Rhapsody could be an
almost identical code tree.  Seriously.  And they'd get another
market for free.

In the mean time, R will own that market as they own the Linux market.

Cheers,
Steve
---
 Steven M. Boker                                 219-631-4941 (voice)
 sboker@nd.edu                                   219-631-8883 (fax)
 <http://www.nd.edu/~sboker/                      219-257-2956 (home)
 Dept. of Psychology, University of Notre Dame, Notre Dame, IN 46556


--Multipart_Thu_Oct__9_10:41:03_1997-1--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Oct 10 09:13:02 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 10 Oct 1997 10:13:02 +0200
Subject: R-alpha: rsept31.zip
Message-ID: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>


I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
at all ... the screen went black for a second and that was it.

Any glue what I've done wrong? Should it work under 3.11 or only under
95/NT?

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 10 11:05:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 10 Oct 1997 12:05:12 +0200
Subject: R-alpha: Bug (since 0.50):  get(name.of.expression)  evaluates
Message-ID: <199710101005.MAA01480@sophie.ethz.ch>

This was not in 0.49 (when expressions where a different kind of objects).

get(..) does an extra eval(..)  when it should not :


###-*- R -*-   (cut and paste into R) ---------------------------

## rm(a) # if there is an 'a' 

 ex <- expression(a)

 ex
#> expression(a)

get("ex") #--- should really just return `expression(a)' ...
>>>>> Error: Object "a" not found

a <- pi
ex
# expression(a)

get("ex") #--- should really just return `expression(a)' ...
# [1] 3.141593

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Oct 10 11:20:12 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Oct 1997 12:20:12 +0200
Subject: R-alpha: rsept31.zip
In-Reply-To: Friedrich Leisch's message of Fri, 10 Oct 1997 10:13:02 +0200
References: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>
Message-ID: <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> 
> 
> I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
> at all ... the screen went black for a second and that was it.
> 
> Any glue what I've done wrong? Should it work under 3.11 or only under
      ^^^^ That's a sticky issue, Fritz... ;)
> 95/NT?

You need to install win32s first. Available from ftp.microsoft.com and
various other places. Latest version (1.30c, I think) is very
descriptively called pw1118.exe. It's a 2.4MB self-extracting file
(which is causing me some trouble with providing it to students on
diskette...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 10 19:24:51 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 10 Oct 1997 14:24:51 -0400
Subject: R-alpha: "[.ts" <- function (x, i, j, drop=T)
Message-ID: <97Oct10.142800edt.26501@mailgate.bank-banque-canada.ca>

This may have been fixed  as I'm working with a slightly old 0.50a
version, but I don't recall seeing it mentioned:

The arguments to "[.ts" needs to be changed to allow drop to be passed
to the NextMethod

"[.ts" <- function (x, i, j, drop=T)

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Oct 14 16:33:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 14 Oct 1997 17:33:55 +0200
Subject: R-alpha: rsept31.zip
In-Reply-To: <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>
References: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>
 <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>
Message-ID: <199710141533.RAA26871@galadriel.ci.tuwien.ac.at>

>>>>> On 10 Oct 1997 12:20:12 +0200,
>>>>> Peter Dalgaard BSA (PDB) wrote:

PDB> Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
>> 
>> 
>> I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
>> at all ... the screen went black for a second and that was it.
>> 
>> Any glue what I've done wrong? Should it work under 3.11 or only under
PDB>       ^^^^ That's a sticky issue, Fritz... ;)

probably my linux machine doesn't like it, when I write about sticky
issues like ms software and interferes with what I'm writing ...



PDB> You need to install win32s first. Available from ftp.microsoft.com and
PDB> various other places. Latest version (1.30c, I think) is very
PDB> descriptively called pw1118.exe. It's a 2.4MB self-extracting file
PDB> (which is causing me some trouble with providing it to students on
PDB> diskette...).

pw1118.exe did the job for me ... now it works including graphics
... or lets put it this way:

	x<-rnorm(100)
	y<-sin(x)
	plot(x,y)

worked :-)

finding bugs is left to students insisting on using windows

shouldn't there be something in the README?

as for the 2.4MB: the biggest file in the archive is about 350k, so
repacking it into 2 archives <= 1440k shouldn't be a problem.


fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 14 18:49:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 14 Oct 1997 19:49:48 +0200
Subject: R-alpha: extraneous ";" gives  syntax error
Message-ID: <199710141749.TAA02756@sophie.ethz.ch>

Here is what I mean

    > ;1
    ;1
    ^
    Error: syntax error
    > 1;;
    [1] 1
    1;;
      ^
    Error: syntax error
    > 1;;;3
    [1] 1
    1;;;3
      ^
    Error: syntax error

----

In S, these give no syntax errors; 
instead, NULL is returned (in some cases).

It's not a big issue,
but I don't see the advantage of  ``punishing empty statements''.

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From hoffmann@wsl.ch  Wed Oct 15 15:40:41 1997
From: hoffmann@wsl.ch (Christian Hoffmann)
Date: Wed, 15 Oct 1997 16:40:41 +0200
Subject: R-alpha: save in Rseptbeta
Message-ID: <9710151440.AA19871@lagonda>

Dear developers,

I am trying out RSeptbeta on a Win NT 3.51 machine.

Problem:

What is the default name for the Image file? Where can I choose this file?
On the command line?

After startup, in the R Console window, the lines appear:

[Previously saved workspace restored]   ------  seems OK

Error: workspace file corrupted -- no data loaded   ------- what is this???

Then the R.Rprofile File window opens, and I have the choice of two file names: 

Rprofile (which is a copy of the one in the distribution)

and

Save.rmg  (which I generated the previous time).

Choosing Rprofile is OK, the startup functions.
BUT, choosing Save.rmg will produce

[1] 1975
,^
> objects()
character(0)
>
i.e. the startup does not function.

To load the saved image I will have to execute  load("Save.rmg"). 

Questions:
How can the loading be automated? Or be made subject to a choice (window)?

The default for choosing a save file is
  <dir where Rsept resides>\Rprofile

This is misleading. It should default to my own working directory and
propose a name which would be automatically loaded.


I hope that this description is clear enough to find answers.

Thank you very much
--Christian

Christian Hoffmann
Swiss Federal Institute for Forest, Snow and Landscape Research
CH-8903 Birmensdorf, Switzerland
phone: ++41-1-739 22 77    fax  : ++41-1-739 22 15   e-mail:  hoffmann@wsl.ch

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Fri Oct 17 07:42:49 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 17 Oct 1997 16:42:49 +1000
Subject: R-alpha: bug in svd
Message-ID: <199710170642.QAA10196@forde.anu.edu.au>


I use R Version 0.60 Alpha (September 18, 1997) on a Linux Pentium
(Debian 1.3) and on a Sparc-Sun-Solaris 2.5.=20


R> svd(matrix(1:16,4,4))
=09yields on both machines
Error: error  4  in dsvdc

R> svd(matrix(1:20,4,5))
=09gives a result on the Linux computer
$d
[1]  0  0  0 NA

$u
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1

$v
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0   NA   NA
[4,]    0    0   NA   NA
[5,]    0    0   NA   NA

but causes a Segmentation Fault on the solaris machine.

=09Andreas Weingessel

***********************************************************************=
*
*                          Andreas Weingessel                          =
*
***********************************************************************=
*
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 454=
1 *
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 9=
8 *
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at =
*
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel =
*
***********************************************************************=
*



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Muriel.Comblain@ulg.ac.be  Fri Oct 17 09:34:34 1997
From: Muriel.Comblain@ulg.ac.be (Comblain muriel)
Date: Fri, 17 Oct 1997 10:34:34 +0200
Subject: R-alpha: offset in glm not working
Message-ID: <3.0.1.32.19971017103434.009007d0@pop3.mailst.ulg.ac.be>

Hello,

	With the new version of R (septembre), the function glm seems to ignore
the offset. The ouput is exactly the same with or without the offset
specification. I tried the same program in the version of april and it
worked corectly. 

Best Regards
			Muriel Comblain

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Muriel.Comblain@ulg.ac.be  Fri Oct 17 12:28:50 1997
From: Muriel.Comblain@ulg.ac.be (Comblain muriel)
Date: Fri, 17 Oct 1997 13:28:50 +0200
Subject: R-alpha: offset in glm not working
Message-ID: <3.0.1.32.19971017132850.00900530@pop3.mailst.ulg.ac.be>

>Date: Fri, 17 Oct 1997 10:34:34 +0200
>To: r-devel@stat.math.ethz.ch
>From: Comblain muriel <Muriel.Comblain@ulg.ac.be>
>Subject: offset in glm not working
>
>Hello,
>
>	With the new version of R (septembre), the function glm seems to ignore
the offset. The ouput is exactly the same with or without the offset
specification. I tried the same program in the version of april and it
worked corectly. 
>
>Best Regards
>			Muriel Comblain
>


I forgot to precise that I was speaking about the windows version of R.
Sorry for that!

			Muriel Comblain

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Oct 17 13:42:22 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Oct 1997 14:42:22 +0200
Subject: R-alpha: bug in svd
In-Reply-To: Andreas Weingessel's message of Fri, 17 Oct 1997 16:42:49 +1000
References: <199710170642.QAA10196@forde.anu.edu.au>
Message-ID: <x24t6g8ssx.fsf@blueberry.kubism.ku.dk>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> I use R Version 0.60 Alpha (September 18, 1997) on a Linux Pentium
                  ^^^^^^^^^^
> (Debian 1.3) and on a Sparc-Sun-Solaris 2.5. 

As a matter of principle, that version is not released yet, so it may
contain bugs that shouldn't be seen outside the core team. However,
I seem to get the same errors with 0.50.x (with x==2 because I was to
laz^H^H^Hbusy to upgrade it...), so I suppose it can be discussed here
anyway.

> R> svd(matrix(1:16,4,4))
> 	yields on both machines
> Error: error  4  in dsvdc
> 
> R> svd(matrix(1:20,4,5))
> 	gives a result on the Linux computer

Both examples are rank-2 matrices, the problems disappear with random
matrices, so I suspect that the code is unhappy about dealing with
matrices of less than full rank?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:18:54 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:18:54 -0400
Subject: R-alpha: system()
Message-ID: <97Oct17.112109edt.26498@mailgate.bank-banque-canada.ca>

Here is a minor difference between R and S, but the rather pecular
"numeric" result occasionally seems to cause R to crash when it is used.
I'm not sure if this has been changed in .60.

R : ...

> mode(system("date \'+%Y %m %d %H %M %S\'"))
1997 10 17 10 57 27
[1] "numeric"
>
> (system("date \'+%Y %m %d %H %M %S\'"))[1]
1997 10 17 11 13 55
[1] 0
>
> q()
Save workspace image? [y/n/c]: n
$
$ splus...
>  mode(system("date \'+%Y %m %d %H %M %S\'"))
[1] "character"
>

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 17 16:22:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 17 Oct 1997 17:22:37 +0200
Subject: R-alpha: plot(..... sub = 'sub title')  does not work.
Message-ID: <199710171522.RAA00933@sophie.ethz.ch>

The `sub'  is simply disregarded when given as argument to plot(..)
I think, we'd want it to be passed to title.

In the code of  plot.default, it seems clear how this happens.
We have

> plot.default
function (x, y = NULL, type = "p", col = par("fg"), bg = NA, 
        pch = par("pch"), xlim = NULL, ylim = NULL, log = "", 
        axes = TRUE, frame.plot = TRUE, panel.first = NULL, panel.last = NULL, 
        ann = par("ann"), main = NULL, xlab = NULL, ylab = NULL, 
        cex = par("cex"), lty = par("lty"), lwd = par("lwd"), 
        ...) 
{

	..........

        plot.new()
        plot.window(xlim, ylim, log, ...)
        panel.first
        plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, 
                lty = lty, lwd = lwd, ...)
        panel.last
        pars <- list(...)
        if (axes) {
                axis(1, pars = pars)
                axis(2, pars = pars)
                if (frame.plot) 
                        box(...)
        }
        if (ann) 
                title(main = main, xlab = xlab, ylab = ylab, 
                        pars = pars)
        invisible()
}

> title
function (main = NULL, sub = NULL, xlab = NULL, ylab = NULL, 
        ...) 
.Internal(title(as.char.or.expr(main), as.char.or.expr(sub), 
        as.char.or.expr(xlab), as.char.or.expr(ylab), ...))
	
-------

It is not clear to me which function should be fixed:

Either add 'sub=NULL' to the argument list of plot.default,

1)	 and all will work, but we have yet another arg

or

2)	change the .Internal(title(.....))  such that it also looks for a 
	'sub' arg in its "..." arguments and takes that one if it exists.


To patch plot.default is easier to implement,
but improving (internal) title would have potential
benefits to many other circumstances...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:24:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:24:59 -0400
Subject: R-alpha: system() ok
Message-ID: <97Oct17.112714edt.26498@mailgate.bank-banque-canada.ca>

It seems I just need intern=T. I'll just put this in my small list of S
and R differences:

> mode(system("date \'+%Y %m %d %H %M %S\'", intern=T))
[1] "character"
>

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 17 16:34:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 17 Oct 1997 17:34:23 +0200
Subject: R-alpha: system() ok  --  is.R() function
In-Reply-To: <97Oct17.112714edt.26498@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 17 Oct 1997 11:24:59 -0400)
Message-ID: <199710171534.RAA00952@sophie.ethz.ch>

>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> It seems I just need intern=T. I'll just put this in my small
    Paul> list of S and R differences:

    >> mode(system("date \'+%Y %m %d %H %M %S\'", intern=T))
    Paul> [1] "character"
    >>

Paul, remember that in S-plus,  system(.) does not exist at all.
When you use  system(.) in S-plus,
you use your own version
which I remember you posted as part of your
	``S--R compatibility package''
on R-help or R-devel a while ago.

So I think you should redefine your  system(..) function in S-plus.

BTW: I have been using your  S--R compatibility package for quite a while
     now, and I can assure you that you can shorten it quite a bit, once
     0.60 (this is ``sixty'', not ``six o'') will be out.

Note that I mainly use the `is.R(.)' function
originated by you, but the follow version is ``better'' because it

###--  works in  all versions of
###-- S  (including "S version 4", (beta))
###-- R
###-- S-plus

is.R <- function() { ## returns  'TRUE'  iff we are using 'R'
  exists("version") && !is.null(vl <- version$language) && vl == "R"
}

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:49:24 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:49:24 -0400
Subject: R-alpha: system() NOT ok
Message-ID: <97Oct17.115143edt.26514@mailgate.bank-banque-canada.ca>

Why does parse not work below and why does assigning it crash R?

Paul
________
$ R
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-3 (August 8, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> system("date \'+%Y %m %d %H %M %S\'", intern=T)
[1] "1997 10 17 11 43 21"
> parse(text = system("date \'+%Y %m %d %H %M %S\'", intern=T),white =
T)
1997 10 17 11 43 43
      ^
expression()
> d <- parse(text = system("date \'+%Y %m %d %H %M %S\'",
intern=T),white = T)
1997 10 17 11 44 22
      ^
>
$

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Oct 17 17:08:45 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 17 Oct 1997 09:08:45 -0700 (PDT)
Subject: R-alpha: system() NOT ok
In-Reply-To: <97Oct17.115143edt.26514@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971017090227.10996A-100000@troi>

On Fri, 17 Oct 1997, Paul Gilbert wrote:

> Why does parse not work below and why does assigning it crash R?
> 
> Paul
> ________
> $ R
> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.50 Alpha-3 (August 8, 1997)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type "license()" for details.
> 
> > system("date \'+%Y %m %d %H %M %S\'", intern=T)
> [1] "1997 10 17 11 43 21"
> > parse(text = system("date \'+%Y %m %d %H %M %S\'", intern=T),white =
> T)
> 1997 10 17 11 43 43
>       ^

It doesn't work because space-separated lists of numbers aren't valid R
syntax. You can use 
  >parse(text=strsplit( system("date \'+%Y %m %d %H %M %S\'",
intern=T)," ")[[1]])
 expression(1997, 10, 17, 9, 7, 8)

where strsplit(a,b) splits string a at character b.

	
The crash is a known bug and happens whenever you assign the result of a
syntax error in the parser.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Oct 17 17:19:17 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 17 Oct 1997 09:19:17 -0700 (PDT)
Subject: R-alpha: offset in glm not working
In-Reply-To: <3.0.1.32.19971017132850.00900530@pop3.mailst.ulg.ac.be>
Message-ID: <Pine.SUN.3.95.971017090921.10996B-100000@troi>

On Fri, 17 Oct 1997, Comblain muriel wrote:

> >
> >	With the new version of R (septembre), the function glm seems to ignore
> the offset. The ouput is exactly the same with or without the offset
> specification. I tried the same program in the version of april and it
> worked corectly. 
> >

Yes, this is a bug.  The modelling code was changing quite rapidly at
about the time rsept was built, and it ended up without support for
offsets.

There are two problems. The version of model.frame/model.matrix in
rsept doesn't allow 
	glm(y~x+offset(z))
and the model.offset() function is broken so that
	glm(y~x,offset=z) 
doesn't work. The second problem is easy to fix 

If you define
model.offset  <- function (x) 
{
        offsets <- attr(attr(x, "terms"), "offset")
        if (length(offsets) > 0) {
                ans <- 0
                for (i in offsets) ans <- ans + x[[i]]
        }
        else NULL
}

by adding it to your profile, or by editing the base library
then  glm(y~x,offset=z) will work. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 21:51:37 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 16:51:37 -0400
Subject: R-alpha: on.exit
Message-ID: <97Oct17.165401edt.26506@mailgate.bank-banque-canada.ca>

I seem to be having trouble with on.exit not executing when my code
executes a stop(). Has anyone else noticed this in 0.50alpha 3?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Oct 18 19:32:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Oct 1997 20:32:02 +0200
Subject: R-alpha: This weeks bugs and requests for enhancements
Message-ID: <x2hgaej525.fsf@blueberry.kubism.ku.dk>


Here's a number of items that came up in connection with my course for 
medical ph.d. students this week:

boxplot():
        - deals ungracefully with empty groups and factor levels not
	present in grouping variable.
        - no indication of what variable is being plotted

data.entry() (mostly W95 rseptbeta problems)
        - Entry of first variable name doesn't take before 2nd
        name is entered.
        - data.entry(BW,RMR) gives two columns named BW. Quitting
	dataeditor at that point *overwrites* BW with RMR!
        - inserting NA is only possible by switching to character
	values, entering invalid number, and switching back to numeric
        - blanking a field, then exiting dataeditor crashed one system
	(I *think*)

        Req.f.enhancem.:
        - insert/delete rows (in single column *and* range of columns)
        - undo facilities and "panic button"
        - use comma as decimal point (Nat.variant of W95 maps Keypad
	period to comma)
        - switch between vertical/horizontal cell cursor movement on
	Enter.

Misc:
	quantile() labels results as % rounded to integer, which is
	kind of confusing when 2.5% and 97.5% is one of the first
	things people want to try:
	> quantile(rnorm(1000),c(.025,.975))
	       2%       98% 
	-2.067519  1.891768 

        plot() still has inconsistency with docs in xlog/ylog vs
	log="xy". Which one do we want?

        at some point we want to be able to specify collating
	sequences for sorting character vectors. Case in point: The
	Danish alphabet ends ..uvwxyzæøå , but
        > sort(c("æ","ø","å"))
        [1] "å" "æ" "ø"
        (No such thing as a universal collating seq. E.g. Norwegian
	has the same three letters in a different order. So it should
	probably be via options(collate=..).

        The ~ notation could be used more consistently, in particular
	in t.test and friends.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Oct 18 21:07:58 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 18 Oct 1997 22:07:58 +0200
Subject: R-alpha: Re: problem vith "cmdscale" on W95
In-Reply-To: <3.0.1.32.19971018104425.0069f234@stat.unipg.it> (message from
 Andrea Rossetti on Sat, 18 Oct 1997 10:44:25 +0200)
Message-ID: <199710182007.WAA16232@jessica.ethz.ch>


    AR> I tried to do

    AR> library(mva)
    AR> data(quakes)
    AR> quakes<-quakes[sample(seq(1:1000),100),1:5]
    AR> cmd.dsq<-cmdscale(dsq)
    AR> Error in .C("dblcen", x, as.integer(n)) : C/Fortran function not in load table

    AR> how can I solve this problem?

You should ask this on the mailing list (you only e-mailed to me), 
actually probably better R-devel than R-help.

The above message indicates that the dynamic loading (which should happen
with "library(mva)") did not work in your setup.
I dont know if this is a known problem in Rseptwin or problem of your setup
only.

Good luck,	Martin.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Oct 19 01:53:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 19 Oct 1997 13:53:40 +1300 (NZDT)
Subject: R-alpha: bug in svd
In-Reply-To: <199710170642.QAA10196@forde.anu.edu.au>
References: <199710170642.QAA10196@forde.anu.edu.au>
Message-ID: <199710190053.NAA17919@stat1.stat.auckland.ac.nz>

Andreas Weingessel writes:
 > 
 > R> svd(matrix(1:16,4,4))
 > 	yields on both machines
 > Error: error  4  in dsvdc

This is a bug in the interpreted code.  It assumes that its argument
is real valued.  1:16 produces an integer value.  The fix is to change
the svd function so that the call to LINPACK is

z <- .Fortran("dsvdc", as.double(x), n, n, p, d = double(mm), double(p),
         u = u, n, v = v, p, double(n), as.integer(job),
         info = integer(1), DUP = FALSE)[c("d", "u", "v",
         "info")]

i.e. you have to wrap an "as.double" around "x".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Oct 20 15:46:52 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 20 Oct 1997 10:46:52 -0400
Subject: R-alpha: Re: R-beta: Time Series Analysis
References: <3.0.1.32.19971016182321.006863d4@stat.unipg.it> <3.0.1.32.19971018085459.006a0d04@stat.unipg.it>
Message-ID: <97Oct20.105100edt.26501@mailgate.bank-banque-canada.ca>

>>I have a version of my time series library (DSE) which works 99% in R
>>0.50 Alpha-3. I'm waiting for the soon to be beta release (I
understand
>>this will be R 0.6) before I make it public, since I think a few
things
>>may be changing ...

>I've visited your home page, what DSE file I must download to plug-in
>rseptbeta for W95?

None of the versions currently on my home page work well in R, but I do
have a version which works very well with R. I will put it on my home
page soon, probably about the end of November. If you are really in a
hurry I can make it available for you sooner, but if you wait it will be
easier (for both of us).

I have not yet done any configuration or testing under W95.  Are complex
numbers working in rseptbeta for W95? How should library installation
and compiling of fortran be approached on W95? I currently use Unix make
files.

Paul Gilbert




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Oct 20 17:57:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 20 Oct 1997 12:57:56 -0400
Subject: R-alpha: system() ok  --  is.R() function
References: <199710201331.PAA03410@sophie.ethz.ch>
Message-ID: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>

Martin

Your revisions to my S--R compatability code suggest that tempfile() is
in R after 0.49. I don't find that to be the case. It requires code from
Friedrich Leisch which still has to be added as of 0.50 alpha3.

Paul
_______
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-3 (August 8, 1997)
> exists("tempfile", mode = 'function')
[1] FALSE
>

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Oct 21 07:31:59 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 21 Oct 1997 08:31:59 +0200
Subject: R-alpha: system() ok  --  is.R() function
In-Reply-To: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>
References: <199710201331.PAA03410@sophie.ethz.ch>
 <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>
Message-ID: <199710210631.IAA06442@pc25.none>

>>>>> Paul Gilbert writes:

> Martin
> Your revisions to my S--R compatability code suggest that tempfile() is
> in R after 0.49. I don't find that to be the case. It requires code from
> Friedrich Leisch which still has to be added as of 0.50 alpha3.

> Paul
> _______
> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.50 Alpha-3 (August 8, 1997)
>> exists("tempfile", mode = 'function')
> [1] FALSE
>>

Under Unix, you can do with the following which will also be in 0.60:

tempfile <- function(pattern = "file") {
  system(paste("for p in", paste(pattern, collapse = " "), ";",
               "do echo /tmp/$p$$; done"),
         intern = TRUE)
}


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 21 07:48:57 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 21 Oct 1997 08:48:57 +0200
Subject: R-alpha:  tempfile(.) [in 0.50-a4] -- or  use .C() instead?
In-Reply-To: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Mon, 20 Oct 1997 12:57:56 -0400)
Message-ID: <199710210648.IAA06380@sophie.ethz.ch>

>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> Martin Your revisions to my S--R compatability code suggest that
    Paul> tempfile() is in R after 0.49. I don't find that to be the
    Paul> case. It requires code from Friedrich Leisch which still has to
    Paul> be added as of 0.50 alpha3.

However,  it IS there in  0.50 Alpha-4 :

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-4 (September 10, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> tempfile
function (pattern = "file") 
{
        system(paste("for p in", paste(pattern, collapse = " "), 
                "; do echo /tmp/$p$$; done"), intern = TRUE)
}

----------
(and the same version is in current 0.60 pre-alpha).

Yes, I've thought too, that it could be better to use Fritz' C-version
since that one might also work on non-Unix systems.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Oct 22 23:41:55 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Oct 1997 00:41:55 +0200
Subject: R-alpha: na.woes
Message-ID: <x2u3e9ifnw.fsf@blueberry.kubism.ku.dk>


1) hist() does not take NA's. Incompatible with Splus, probably just a
   bug?

2) I do wish we could somehow get rid of the misfeatures of indexing
with logical NA's:
> table(juul$menarche,juul$tanner)
      I II III IV   V
No  221 43  32 14   2
Yes   1  1   5 26 202
> juul$menarche=="Yes"&juul$tanner=="I",]

...and you find yourself with a listing of 477 cases, of which the 476
are NA-filled. To find the interesting case, you need to go through
the following contortions:

> menar.t1 <- juul$menarche=="Yes"&juul$tanner=="I" 
> menar.t1 <- menar.t1 & !(is.na(menar.t1))        
> juul[menar.t1,]
      age menarche sex igf1 tanner testvol
962 12.33      Yes   F   NA      I      NA

I can't think of a single case where the current behavior is useful.
Indexing with numerical NA's makes sense, e.g. when recoding, and then
there's the boundary case of indexing with a vector where all elements
are logical NA's (should they be promoted to numeric?), but situations
where they arise naturally are pretty hard to think up.

Current behavior is Splus-compatible, but its still annoying.

--------------------

BTW, re. case labels, R is *not* Splus-compatible:

R:
> menar.t1[1]<-NA
> juul[menar.t1,]
      age menarche sex igf1 tanner testvol
NA     NA       NA  NA   NA     NA      NA
962 12.33      Yes   F   NA      I      NA
> menar.t1[2]<-NA
> juul[menar.t1,]
Warning: some row names are duplicated; argument ignored
       age menarche sex igf1 tanner testvol
[1,]    NA       NA  NA   NA     NA      NA
[2,]    NA       NA  NA   NA     NA      NA
[3,] 12.33      Yes   F   NA      I      NA
 
Splus:
> data[c(T,NA,rep(F,14)),]
  x1 x2 x3 x4 migraine not.migraine 
1  0  0  0  0       25          546
  NA NA NA NA       NA           NA
>  data[c(T,NA,NA,rep(F,13)),]
    x1 x2 x3 x4 migraine not.migraine 
 X1  0  0  0  0       25          546
  X NA NA NA NA       NA           NA
X11 NA NA NA NA       NA           NA

Somehow, I don't think we should strive for compatibility on this
point... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Thu Oct 23 20:05:04 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 23 Oct 1997 15:05:04 -0400
Subject: R-alpha: OStype
Message-ID: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>

Robert

I've been looking through my "R -- S compatibility" functions which may
mostly disappear in R 0.60. In fact, it seems already that most of the
things I'm trying to do are for operating system differences rather than
R/S differences. The main problem I am having is that version$os gives
more detail then I usually need, but it is not very convenient for
determining simply if the operating system is Unix. Perhaps you could
suggest a better version of the OStype function below.

Thanks
Paul Gilbert
___________

OStype <- function()
   {if (version$os == "MS Windows") return(version$os)
    if (version$os == "Mac") return(version$os) # needs to be checked
    else return ("Unix")  # not a very satisfactory test
   }

is.MSwindows <- function(){OStype() == "MS Windows"}
is.unix      <- function(){OStype() == "Unix" }



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Kurt.Hornik@ci.tuwien.ac.at  Fri Oct 24 10:55:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 24 Oct 1997 11:55:43 +0200
Subject: R-alpha: OStype
In-Reply-To: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>
References: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>
Message-ID: <199710240955.LAA19249@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Robert
> I've been looking through my "R -- S compatibility" functions which may
> mostly disappear in R 0.60. In fact, it seems already that most of the
> things I'm trying to do are for operating system differences rather than
> R/S differences. The main problem I am having is that version$os gives
> more detail then I usually need, but it is not very convenient for
> determining simply if the operating system is Unix. Perhaps you could
> suggest a better version of the OStype function below.

> Thanks
> Paul Gilbert
> ___________

> OStype <- function()
>    {if (version$os == "MS Windows") return(version$os)
>     if (version$os == "Mac") return(version$os) # needs to be checked
>     else return ("Unix")  # not a very satisfactory test
>    }

Isn't this what machine() does?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 24 11:06:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Oct 1997 12:06:09 +0200
Subject: R-alpha: OStype
In-Reply-To: <199710240955.LAA19249@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 24 Oct 1997 11:55:43 +0200)
Message-ID: <199710241006.MAA10147@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
    >> Robert I've been looking through my "R -- S compatibility" functions
    >> which may mostly disappear in R 0.60. In fact, it seems already that
    >> most of the things I'm trying to do are for operating system
    >> differences rather than R/S differences. The main problem I am
    >> having is that version$os gives more detail then I usually need, but
    >> it is not very convenient for determining simply if the operating
    >> system is Unix. Perhaps you could suggest a better version of the
    >> OStype function below.

    >> Thanks Paul Gilbert ___________

    >> OStype <- function() {if (version$os == "MS Windows")
    >> return(version$os) if (version$os == "Mac") return(version$os) #
    >> needs to be checked else return ("Unix") # not a very satisfactory
    >> test }

    Kurt> Isn't this what machine() does?

Sure,
here is corresponding online help

  HELP> Determine the Machine R is Running On
  HELP> 
  HELP>      machine()
  HELP> 
  HELP> Description:
  HELP> 
  HELP>      This function returns a string which specifies what
  HELP>      kind of environment R is being run in.
  HELP> 
  HELP> Examples:
  HELP> 
  HELP>      if (machine() == "Macintosh")
  HELP>        cat("You are using a Macintosh computer\n")
  HELP> 

Paul's problem is that  machine()  does not exist in  S(plus)...
and the point of his  S--R package is that it is 
	- `source()able' by all versions of S / S-plus / R 
	- defines functions which work on all versions of  ....

However,
he would probably use
	
	.... if(is.R()) machine()  ...

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 28 09:26:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 28 Oct 1997 10:26:34 +0100
Subject: R-alpha: New URL for R-online manual (HTML)
In-Reply-To: <199710280003.NAA28838@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 28 Oct 1997 13:03:48 +1300 (NZDT))
Message-ID: <199710280926.KAA03131@sophie.ethz.ch>

Most important:  (Kurt, R&R,..) Update this in the FAQ and other  pages.
				~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Because of the new (0.60) way of having HTML help for all libraries (not
only "base"), the html files reside in different places.

I have changed the setup such that
from now on, you should 
use
	<A HREF="http://www.stat.math.ethz.ch/R/manual/">
instead of the older
				        ...../R-manual/

(i.e. only replace the `-' by a `/').

The old link continues to work, i.e., it now contains a link to the new
place.

BTW: You currently get the  0.60 (daily snapshot) on-line help
     when using the above URL.

	[[ I will change back to point to a released version of R, once that is
	   less out dated  ;;-) ]]
- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 28 17:37:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 28 Oct 1997 18:37:35 +0100
Subject: R-alpha: Bug[?] in axis(.) -- using format(.) for labels can give nonsense
Message-ID: <199710281737.SAA04464@sophie.ethz.ch>

To see what I mean,
try

 x11()
 par(mfrow=c(2,1))
 x <- 1:100
 plot(x, sin(pi*x/100))
 options(digits= 20)
 plot(x, sin(pi*x/100))

The problem really is in  axis(.) which uses  format(.) for the axis
labels.
I think  the result of axis(.) should NOT be influenced by

	options()$digits.

Should I change it?

--
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Oct 29 01:28:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Oct 1997 02:28:35 +0100
Subject: R-alpha: Bug[?] in axis(.) -- using format(.) for labels can give nonsense
In-Reply-To: Martin Maechler's message of Tue, 28 Oct 1997 18:37:35 +0100
References: <199710281737.SAA04464@sophie.ethz.ch>
Message-ID: <x22015pdbw.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> To see what I mean,
> try
> 
>  x11()
>  par(mfrow=c(2,1))
>  x <- 1:100
>  plot(x, sin(pi*x/100))
>  options(digits= 20)
>  plot(x, sin(pi*x/100))
> 
> The problem really is in  axis(.) which uses  format(.) for the axis
> labels.
> I think  the result of axis(.) should NOT be influenced by
> 
> 	options()$digits.
> 
> Should I change it?

Hm. The root of the problem is this:
>  options(digits= 20)
> 0:5*0.1
[1] 0.00000000000000000 0.10000000000000001 0.20000000000000001
[4] 0.30000000000000004 0.40000000000000002 0.50000000000000000

I.e. the plot labels get a large number of digits because of numerical
inaccuracy, and then there's only room for one of them on the axis.
I say you deserve what you get... 

I'm a bit more worried by

 options(digits=1)
 plot(seq(50.2,50.5,0.1))

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct 29 17:20:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Oct 1997 18:20:01 +0100
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <Pine.SUN.3.95.971029082753.7042B-100000@troi> (message from
 Thomas Lumley on Wed, 29 Oct 1997 08:42:00 -0800 (PST))
Message-ID: <199710291720.SAA01035@sophie.ethz.ch>

	[This is a "spill-over"  from the  "R-core"  mailing list,
	 since several of you may be interested and have comments ... -MM]

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> On 29 Oct 1997, Peter Dalgaard BSA wrote:
    >> Perhaps we should revise the current contents of the base library
    >> and replace some noncrucial items with autoloads? (The ts stuff for
    >> instance, glm, maybe even lm).

    Thomas> It would be interesting to experiment along these lines.
    Thomas> Clearly if something is going to be loaded it saves time and
    Thomas> space to do it immediately, but if it isn't going to be used
    Thomas> it's better to keep it on disk.  Personally, I use glm nearly
    Thomas> every time I use R, but other people may have different needs.

    Thomas> The problem clearly isn't urgent, since the only library slated
    Thomas> for inclusion is ctest, which is nice and compact. However, a
    Thomas> configurable, modular approach seems like a good idea, and
    Thomas> works for emacs.  Given the desire to run R on small machines
    Thomas> we certainly can't follow the S-PLUS path of including
    Thomas> everything useful in the default set-up. For example, survival4
    Thomas> takes up a quarter of the cons cells using the default
    Thomas> settings, and nlme() (if we ever do it) will presumably be
    Thomas> fairly large as well.

NOTE: These things (libraries) are called ``packages'' from 0.60 on ..
					    --------

    Thomas> Perhaps this is more of a r-devel type comment?

Yes ! [and you see, I took the liberty ...]


Actually, I have thought along similar lines:
I think it is a neat concept to use autoload and  more than just the  'eda'
and 'mva'  libraries. 

BTW: Is it a good idea if I include  my  
	stepfun / ecdf     functions into a new library  'stepfun' ?
     ie. a library that belongs to the distribution instead of being contrib?
	
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From rossini@math.SC.EDU  Wed Oct 29 17:50:30 1997
From: rossini@math.SC.EDU (Anthony Rossini)
Date: 29 Oct 1997 12:50:30 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: Martin Maechler's message of "Wed, 29 Oct 1997 18:20:01 +0100"
References: <199710291720.SAA01035@sophie.ethz.ch>
Message-ID: <wnc3elklaqh.fsf@neuromancer.stat.sc.edu>


>>>>> "Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> On 29 Oct 1997, Peter Dalgaard BSA wrote:
    >>> Perhaps we should revise the current contents of the base library
    >>> and replace some noncrucial items with autoloads? (The ts stuff for
    >>> instance, glm, maybe even lm).

    Thomas> It would be interesting to experiment along these lines.
    Thomas> Clearly if something is going to be loaded it saves time and
    Thomas> space to do it immediately, but if it isn't going to be used
    Thomas> it's better to keep it on disk.  Personally, I use glm nearly
    Thomas> every time I use R, but other people may have different needs.

    Martin> Actually, I have thought along similar lines: I think it
    Martin> is a neat concept to use autoload and more than just the
    Martin> 'eda' and 'mva' libraries.

    Martin> BTW: Is it a good idea if I include  my  
    Martin> 	stepfun / ecdf     functions into a new library  'stepfun' ?
    Martin>      ie. a library that belongs to the distribution
    Martin>      instead of being contrib?

Can we do like emacs, and have a means for "dumping" packages into R?
Even if it is just a matter of adding or removing comments in
appropriate places, this could be useful.  Just like emacs, this would
increase the initial size, but means that little time is wasted during
load.

[I assume that the discussion is with respect to replacing packages
with autoloads, and I for one would consider doing that with some of
the packages as a "Good Thing"(tm) (since I've got to the point that
I'd rather wait to have things grow as I need them, rather than let
them start huge and grow incrementally at a small pace).]

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulhu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Oct 29 17:48:23 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 1997 12:48:23 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
References: <199710291720.SAA01035@sophie.ethz.ch>
Message-ID: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>

Perhaps someone could bring those of us not in "core" up to date a bit.
What are advantages of autoload and the implications, especially for
memory and speed.  Currently I have to divide my package into several
pieces in order to load it (I'm not too  sure why, but it is fairly
big). This is what I do:

R  -v6 -n250000
library("dse/tframe")
library("dse/dse1")
library("dse/dse2")
library("dse/dsex1")
library("padi/padi")
library("dse/dsex2")

Some pieces are much more important and frequently used than others.
Also, within some pieces there are functions which are used a lot more
than others. Should I consider autoloading everything? Will I still need
to divide the package into pieces? Should I avoid autoloading anything
that is used really frequently?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Thomas Lumley <thomas@biostat.washington.edu>  Wed Oct 29 18:57:28 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Wed, 29 Oct 1997 10:57:28 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029103311.7363A-100000@troi>

On Wed, 29 Oct 1997, Paul Gilbert wrote:

> Perhaps someone could bring those of us not in "core" up to date a bit.
> What are advantages of autoload and the implications, especially for
> memory and speed. 

There is very little difference between explicit loading using library() 
or require() and autoload(). 

If you type 
	autoload("myfun","package") 
then typing, say,
	a<-myfun(42)
is equivalent to 
	library(package)
	a<-myfun(42)
This is accomplished by subtle magic involving the "lazy evaluation"
mechanism.

Using autoload() has a (small) additional overhead in speed and memory (12
cons cells), as the autoload information must be stored somewhere and it
must be parsed when myfun() is called. It is also possible that functions
which do creative things with sys.frame()  may not like being autoloaded,
but I don't have any examples.

The main difference in speed over putting a library() statement in
Rprofile is that the delay happens when the function is first used rather
than when R is started.

>	Should I consider autoloading everything? Will I still need
> to divide the package into pieces? Should I avoid autoloading anything
> that is used really frequently?

As autoload("myfun","package") works by arranging for 
	library("package")  
to be evaluated in the global environment the first time myfun() is called
it should work the same as library().

If you know what functions you use all the time, it may well make sense to
just use library() to load them. 

The point of autoload() is transparency.  If you want survival analysis
routines available for your or your students' occasional use, but don't
want to sacrifice 40000 cons cells and 100k of vector heap, you can put a
set of autoloads in Rprofile for all the common functions in survival4 and
have them available if they are needed. 

It also makes sense for a package containing some rarely used features to
be divided in two, so that you initially load the commonly used features
and autoloads for the other.  In the version of survival4 for R0.60 coming
very soon, the US census mortality tables that come with survival4 for S
are in a separate package with autoloads to load them only if they are
needed.  Since they occupy nearly 200k of the vector heap and I personally
have never used them this is a worthwhile saving.

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Wed Oct 29 19:05:23 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 29 Oct 1997 11:05:23 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029110137.7363D-100000@troi>


One disadvantage, probably fixable, of autoload over loading in Rprofile
that I forgot to mention is that the help for a package isn't available
until it's loaded.

So

	library(eda)
	help(smooth)
works, but
	autoload("smooth","eda")
	help(smooth)
doesn't.

If this is a big problem it should be possible to modify help().

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Oct 29 19:54:30 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 1997 14:54:30 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
References: <Pine.SUN.3.95.971029103311.7363A-100000@troi>
Message-ID: <97Oct29.151248est.26572@mailgate.bank-banque-canada.ca>

If I understand this correctly, the whole package gets autoloaded the
first time any function in the package is referenced (and then never
unloaded until q()?).  Thus there would be an advantage to reorganizing
frequently used functions and infrequently used functions in separate
packages. The current organization of the code in my packages is based
on a different logic. For example, I have a test function in the package
to test functions in the package. This function may never be used by
someone who uses the package.

Would it be possible/logical/easy  to make autoload work on a function
by function basis? (Sounds a bit like an S .Data directory.) Is there a
limit on how many packages can be autoloaded?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Wed Oct 29 20:56:15 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 29 Oct 1997 12:56:15 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package
In-Reply-To: <97Oct29.151248est.26572@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029123224.7756A-100000@troi>

On Wed, 29 Oct 1997, Paul Gilbert wrote:

> If I understand this correctly, the whole package gets autoloaded the
> first time any function in the package is referenced (and then never
> unloaded until q()?).

Yes, though you can explicitly unload a package with
	detach("package:package") 
and it will still be reloaded automatically when needed. 
 
> Would it be possible/logical/easy  to make autoload work on a function
> by function basis? (Sounds a bit like an S .Data directory.) Is there a
> limit on how many packages can be autoloaded?
> 

Possible and easy, but not logical:

There's no strict limit to the number of packages, but the overhead goes
up sharply as the packages get smaller.  For the current sorts of package
the overhead would be trivial, but for one-function packages it would be
quite large.  Increasing the number of packages loaded also slows a lot of
things down, as the search path gets longer and longer. 

There is also some overhead on opening files, so loading lots of little
packages is slower than loading one big package.

I think autoload() is only worthwhile on largish, coherent blocks,
especially in its current interpreted form. Anything more ambitious would
probably require delving into the internal C code that finds and evaluates
things, and considering horrible things like caching and buffering for
disk access. 

	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Thu Oct 30 08:10:54 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 30 Oct 1997 09:10:54 +0100 (MET)
Subject: R-alpha: nlme
Message-ID: <9710300810.AA18176@alpha.luc.ac.be>

In the discussion on packages, I noted the following phrase:

and nlme() (if we ever do it)

I am waiting impatiently for this to be done. I contacted Douglas
Bates sometime ago, who said that it would be difficult because of the
differences in internals between R and S. I have looked at the code,
but it is too much for me: I know nothing of S. Is there a volunteer???
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 09:02:29 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 10:02:29 +0100
Subject: R-alpha: Bug[let] in (internal) print [for a list with dimnames ...].
Message-ID: <199710300902.KAA00502@sophie.ethz.ch>

Try the following code.
In S-plus, it does print nicely..

 n <- 17
 fac <- factor(rep(1:3, len = n), levels = 1:5)
 tfq <- tapply(1:n, fac, quantile)
 tfq
 print.default(tfq)
 if(version$minor >= 60) str(tfq)  else  c(tfq)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:29:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:29:47 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
Message-ID: <199710301029.LAA00845@sophie.ethz.ch>

Evaluate the following example to get the behavior :

		--- anybody: patch ? ---


tst.i <- function(x)
{
  if(missing(x))
    return(invisible())
  else if(!is.numeric(x)) stop("x must be numeric")
  ## else
  invisible((x+3)^2)
}

tst.i()#-- should NOT print anything !!
print(mode(tst.i()))#--gives "NULL"   both in S-plus 3.4 and R 0.60

tst.i(1)# nothing (ok in R and S-plus)
1 + tst.i(1) #> 17
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:40:36 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:40:36 +0100
Subject: R-alpha: c(..., a) fails [in a function(x, ...)]
Message-ID: <199710301040.LAA00947@sophie.ethz.ch>

A minor inconsistency to  S  which can (I think did) break existing code
(ported from S to R):
 
In R, the  "..." arguments cannot be passed to 'c(..)' :

  ex3.. <- function(...) c(...,exp(1))
  ex3..()# 2.718282
  ##R  Error: ... used in an incorrect context
  ex3..(1:2)# 1 2  2.718282
  ##R  Error: ... used in an incorrect context

  ##--- Only this one works in R 0.60 (Oct.28) also:
  ex4.. <- function(...) c(unlist(list(...)),exp(1))
  ex4..()# 2.718282
  ex4..(1:2)# 1 2  2.718282
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:54:52 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:54:52 +0100
Subject: R-alpha: names(j) <- NULL  fails for a `call' object
Message-ID: <199710301054.LAA01011@sophie.ethz.ch>

I found this ((as part of a more severe problem which WAS fixed))
in   ``old closed tasks'' a while ago..

It still _is_ a  (minor) problem, i.e. an  R<-->S inconsistency


##- TASK:	Name Attributes on Calls
##- STATUS: Closed
##- FROM:	<p.dalgaard@kubism.ku.dk>
##- 	A call with tagged arguments is something like a list, the tags
##- 	can be used to access elements, but the names attribute is absent,
##- 	until the call is coerced to a list. (Attempting to set the names()
##- 	causes evaluation. Changing "list" to "blipblop" causes an 'Error:
##- 	couldn't find function "blipblop"' at that point.)

print(j <- substitute(list(a=1, b=2)))##	list(a = 1, b = 2)
mode(j); is.call(j)#  "call" ,  TRUE
j$b##	[1] 2
names(j)# [1] ""  "a" "b"

names(j) <- NULL ; j #-- doesn't do anything in R -- but does in S-plus
## S:   list(1, 2)
## R-0.50-a2 and  R-0.50-a4 :
##	list(a = 1, b = 2)
mode(j)#>  [1] "call"
names(j)# S: NULL;  R:  ""  "a" "b"

names(j) <- c("", "CC", "DD"); j #-- this DOES work ...
names(j) <- c("", "", ""); j #-- this DOES work ...
names(j) <- c("blipblop", "x", "y"); j# no change to 'list' [[same for R and S]]
## list(x = 1, y = 2)
names(j) #  [[same for R and S]]:
## [1] "blipblop" "x"        "y"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 12:10:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 13:10:58 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: Martin Maechler's message of Thu, 30 Oct 1997 11:29:47 +0100
References: <199710301029.LAA00845@sophie.ethz.ch>
Message-ID: <x2en53o3hp.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> Evaluate the following example to get the behavior :
> 
> 		--- anybody: patch ? ---
> 
> 
> tst.i <- function(x)
> {
>   if(missing(x))
>     return(invisible())
>   else if(!is.numeric(x)) stop("x must be numeric")
>   ## else
>   invisible((x+3)^2)
> }

Actually, 
> tst.i<-function()return(invisible(3))
> tst.i()
[1] 3

(in my snapshot of 0.60, Oct 24) So return(invisible(...)) just
doesn't work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Thu Oct 30 14:52:54 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 30 Oct 1997 08:52:54 -0600 (CST)
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: <199710301029.LAA00845@sophie.ethz.ch> from "Martin Maechler" at Oct 30, 97 11:29:47 am
Message-ID: <9710301452.AA04275@nokomis.stat.umn.edu>

Martin Maechler wrote:
> 
> Evaluate the following example to get the behavior :
> 
> 		--- anybody: patch ? ---
> 
> 
> tst.i <- function(x)
> {
>   if(missing(x))
>     return(invisible())
>   else if(!is.numeric(x)) stop("x must be numeric")
>   ## else
>   invisible((x+3)^2)
> }
> 
> tst.i()#-- should NOT print anything !!
> print(mode(tst.i()))#--gives "NULL"   both in S-plus 3.4 and R 0.60
> 
> tst.i(1)# nothing (ok in R and S-plus)
> 1 + tst.i(1) #> 17

I'm still running 0.49 and there the behavior is a bit different (if I
understand your description right):

tst.i <- function(x=0)
 {
   if(missing(x))
     return(invisible())
   else if(!is.numeric(x)) stop("x must be numeric")
   ## else
   invisible((x+3)^2)
}

gives
> tst.i()
>         # in current R this is NULL?

In any case, here are a few random remarks on this.  Both invisible
and return are somewhat peculiar entities in Splus at least.  In Splus
the official semantics of invisible are (from help)

       the function invisible reaches back 2 frames  and  sets  a
       special  flag, .Auto.print, to FALSE.  This has the effect
       of preventing automatic printing if the  function  calling
       invisible  was called from the top level since .Auto.print
       in frame 1 is set to FALSE.

which means that the argument is pretty much irrelevant;

	function() { invisible(); 1 }
and
	function() { invisible(1) }

are equivalent. I'm not sure what the official semantics of invisible
are in R; operationally these two act differently in 0.49.

Return in Splus is a keyword and doesn't have a function definition,
so it isn't quite clear how return(invisible()) should behave. In R
return seems to be just another function whose action happens to be to
execute a return from one frame back (or whatever). That means that I
would expect

	function(x) { return(invisible(x)) }
and
	function(x) { g(invisible(x)) }

with g<-function(x) { x } to produce identical results as far as
invisibility is concerned, and they do.

I think many users think that invisible() can be thought of as
attaching an invisibility property to its argument and that that
property ought to remain with the argument for a while at least
(probably an assignment should strip it?) -- this would lead to

	return(invisible())

acting as you suggest (and maybe it currently does if I misunderstood
what is happening). It would also mean that

	myprint<- function(...) { print(...) }

would act as you might expect; right now it does in R (and since I'm
not sure about the offical semantics I'm not sure if this should
suprprise me or not) but in Splus (in accord with the semantics given
above) it does not -- you get

>  myprint(1)
[1] 1
[1] 1
>

Officially adding such a property (if it sin't already there -- I'm
not sure on this) might make some things cleaner, but it's not clear
what other cans of worms this would open up.

Other languages take a different approach -- they allow a function
used for side effects to return no values, so there is nothing to
print -- this covers most though not all cases where invisible() is
used now.


-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 15:17:08 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 16:17:08 +0100
Subject: R-alpha: Minor plotting problems
In-Reply-To: Martin Maechler's message of Thu, 30 Oct 1997 11:54:52 +0100
Message-ID: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk>

1) There's a curious asymmetry between points and lines, in that you can
do
lines(...,type='p')
but not
points(...,type='l')
(and more importantly, not points(..., type='b'), which probably
*could* arise in real work)

This isn't deliberate, is it?

2) Did I remember to report the adverse effect of having plot(x,y)
coerce its argument to numeric? Several of my students managed to set
the data type to "character" in data.entry(), do a plot(bw,rmr) with
no apparent problem, and *then* become absolutely perplexed when
lm(rmr~bw) yields

Error in model.frame(formula, data, substitute(list(...)), subset,
na.action) : invalid variable type

3) The first few lines of hist() should be

        if (!is.numeric(x)) 
                stop("hist: x must be numeric")
        eval(main)
        eval(xlab)
        x <- x[!is.na(x)]
 
The two 'eval's are necessary to avoid strange side effects of
modifying x. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 15:27:51 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 16:27:51 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: Luke Tierney's message of Thu, 30 Oct 1997 08:52:54 -0600 (CST)
References: <9710301452.AA04275@nokomis.stat.umn.edu>
Message-ID: <x2hg9zuv7s.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> Other languages take a different approach -- they allow a function
> used for side effects to return no values, so there is nothing to
> print -- this covers most though not all cases where invisible() is
> used now.

If you think in terms of functionality as opposed to actually calling
invisible(), a rather notorious exception would be "<-". It's a
primitive, not a function, but it returns the evaluated right hand
side without printing it.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Thu Oct 30 16:18:44 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 30 Oct 1997 10:18:44 -0600 (CST)
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: <x2hg9zuv7s.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Oct 30, 97 04:27:51 pm
Message-ID: <9710301618.AA04456@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Luke Tierney <luke@stat.umn.edu> writes:
> 
> > Other languages take a different approach -- they allow a function
> > used for side effects to return no values, so there is nothing to
> > print -- this covers most though not all cases where invisible() is
> > used now.
> 
> If you think in terms of functionality as opposed to actually calling
> invisible(), a rather notorious exception would be "<-". It's a
> primitive, not a function, but it returns the evaluated right hand
> side without printing it.
> 

That's why I said "most" :-). Of course whether being able to write

	x<-y<-z

is a good thing or not ... :-)


-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Fri Oct 31 03:01:52 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Thu, 30 Oct 1997 21:01:52 -0600 (CST)
Subject: R-alpha: nlme in R
Message-ID: <m0xR7LM-000hruC@franz.stat.wisc.edu>

Tony Rossini sent me a copy of Jim's message to this list asking about 
nlme.  I was surprised to find that I had not subscribed to this
list.  I thought I did but apparently not.  I have now corrected that.

Development of the nlme library (the name is from "nonlinear
mixed-effects" but the library can also be used to fit general forms
of linear mixed-effects models) is a continuing research project for
Jose' Pinheiro and me.  Earlier this week Jose' spoke at the S-Users'
Conference about the design and development of the nlme 3.0 library.
The most visible change for nlme 3.0 is that it now can incorporate
nested random-effects terms.  In other words, it fits multilevel
models.  I'll check with Jose' on making the transparencies from that
talk available over the internet if people want to get more details.

Jim's question was "can it be ported to R?".  It is a lot of code.
Some of it would be easy to port.  Some of it would be extremely hard
to port.  "Extremely hard" means it would be easier to re-design and
re-write those parts from scratch.

The easy part is the linear mixed-effects code.  There is code in both 
S and in C but the C code is pretty straightforward.  The S code sets
up the model, formulates starting estimates for the parameters that
determine the variance-covariance matrices of the random effects,
calls some C code to do several EM iterations to refine the parameter
estimates then sets up the maximum likelihood estimation or REML
estimates as an ms() optimization.  I myself haven't tried to do this
in R but I think it is feasible to substitute nlm() for ms() at this
point.

There are a host of classes and methods that are defined to help with
this process and with examining the original data and the fitted
models.  *All* of these classes define their plot methods and other
graphical methods through trellis functions.  That means that either
the relevant trellis functions would have to be cloned or all the
graphical routines would have to be replaced or one would have to do
without graphics.  Some indication of the power of trellis for these
models is in the slides of Jose's presentation which should be
available soon at
     http://cm.bell-labs.com/cm/ms/departments/sia/project/nlme/

The nonlinear mixed-effects code will also be a problem.  It
alternates between two optimizations - one using ms() on a linear
mixed-effects problem and one using a special optimization routine for
a penalized nonlinear least squares problem.  The code for the second
one is intimately tied in with the S evaluation process and the frames
in S.  It would be necessary to re-write it from scratch.  Probably it
would be best to re-design it entirely.

More details available upon request.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 31 11:11:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 31 Oct 1997 12:11:23 +0100
Subject: R-alpha: Minor plotting problems //  \itemize{..} in *.Rd
In-Reply-To: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 30 Oct 1997 16:17:08 +0100)
Message-ID: <199710311111.MAA02054@sophie.ethz.ch>

>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

    Peter> 1) There's a curious asymmetry between points and lines, in that
    Peter> you can do lines(...,type='p') but not points(...,type='l') (and
    Peter> more importantly, not points(..., type='b'), which probably
    Peter> *could* arise in real work)

    Peter> This isn't deliberate, is it?

I've always thought is *WAS* deliberate...
At least it made sense to me at the time when I thought about it.

Anyway, we shouldn't be ``bossy'' on users, therefore,
I am about to change it (and its documentation)...

------------------------------

BTW, Fritz,  do we have [or will we soon ? ;-) ]

	\enumerate{
	 \item first
	 \item second
	  ....
	}

	and the same for \itemize{ ... } ....
	
  [ However, LaTeX's  ``description'' is already taken in our Rd format..... ]

-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 31 18:36:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 31 Oct 1997 19:36:48 +0100
Subject: R-alpha: Minor plotting problems  [improved hist()]
In-Reply-To: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 30 Oct 1997 16:17:08 +0100)
Message-ID: <199710311836.TAA02661@sophie.ethz.ch>

>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

    Peter> 1) There's a curious asymmetry between points and lines, in that
    Peter> you can do lines(...,type='p') but not points(...,type='l') (and
    Peter> more importantly, not points(..., type='b'), which probably
    Peter> *could* arise in real work)

Now fixed in current source.

    Peter> 2) Did I remember to report the adverse effect of having
    Peter> plot(x,y) coerce its argument to numeric? Several of my students
    Peter> managed to set the data type to "character" in data.entry(), do
    Peter> a plot(bw,rmr) with no apparent problem, and *then* become
    Peter> absolutely perplexed when lm(rmr~bw) yields

    Peter> Error in model.frame(formula, data, substitute(list(...)),
    Peter> subset, na.action) : invalid variable type

I agree that plot  shouldn't coerce character x / y to numeric.
Nothing yet done.
	[Peter,  you can do the changes if you like ..]


    Peter> 3) The first few lines of hist() should be

    Peter>         if (!is.numeric(x)) stop("hist: x must be numeric")
    Peter> eval(main) eval(xlab) x <- x[!is.na(x)]
 
    Peter> The two 'eval's are necessary to avoid strange side effects of
    Peter> modifying x.

Ok, I've done quite a bit more. 

hist is ``better'' now
	 [[the ``nclass'' discussion is not yet done ... !]]:  

	1) allows  `plot = FALSE'  [as S; but really IS useful]
	2) Default for 'freq:  TRUE only if breaks are equispaced
			(otherwise the plot is graphically *WRONG*)

The following is now in 0.60 :

"hist" <-
function (x, breaks, freq = NULL, col = NULL, border = par("fg"),
	main = paste("Histogram of" , deparse(substitute(x))),
	xlim = range(breaks), ylim = range(counts, 0),
	xlab = deparse(substitute(x)), ylab,
	axes=TRUE, plot = TRUE, ...)
{
	if (!is.numeric(x)) 
		stop("hist: x must be numeric")
	eval(main)
	eval(xlab)
	n <- length(x <- x[!is.na(x)])
	use.br <- !missing(breaks) && length(breaks) > 1
	breaks <-
	  if(use.br) sort(breaks)
	  else {
		rx <- range(x)
		pretty (rx + c(0, diff(rx)/1000), 
			n = if(missing(breaks)) 1 + log2(n)
			else { # breaks = `nclass'	
				if (is.na(breaks) | breaks < 2) 
				  stop("invalid number of breaks")
				breaks
			})
	  }
	nB <- length(breaks)
	counts <- .C("bincount", 
		as.double(x), 
		n, 
		as.double(breaks), 
		nB,
		counts = integer(nB - 1), 
		NAOK = FALSE) $counts
	if (any(counts < 0)) 
	 stop("negative `counts'. Internal Error in C-code for \"bincount\"")
	if (is.null(freq)) 
	  freq <- if(use.br) {
		##-- Do frequencies if breaks are evenly spaced ...
		h <- diff(breaks)
		diff(range(h)) < 1e-10 * h
	  } else TRUE
	if (!freq) {
		counts <- counts/(sum(x) * diff(breaks))
		if (missing(ylab)) 
			ylab <- "Relative Frequency"
	}
	else if (missing(ylab)) 
		ylab <- "Frequency"
	if(plot) {
		plot.new()
		plot.window(xlim, ylim, "")
		title(main = main, xlab = xlab, ylab = ylab, ...)
		if(axes) {
			axis(1, ...)
			axis(2, ...)
		}
		rect(breaks[-length(breaks)], 0, breaks[-1], counts,
		     col = col, border = border)
		invisible(NULL)
	} else list(breaks = breaks, counts = counts)
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Thu Oct  2 00:11:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 1 Oct 1997 16:11:20 -0700 (PDT)
Subject: R-alpha: R-beta: hat
In-Reply-To: <199710010207.OAA22329@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.971001160904.8966C-100000@troi>


The hat() function, returning the diagonal of the hat matrix, currently
works only on matrices and doesn't work with weights.  Could we make it
return lm.influence(x)$hat when inherits(x,"lm")?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Oct  2 12:24:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 02 Oct 1997 13:24:35 +0200
Subject: R-alpha: R-beta: hat
In-Reply-To: Thomas Lumley's message of Wed, 1 Oct 1997 16:11:20 -0700 (PDT)
References: <Pine.SUN.3.95.971001160904.8966C-100000@troi>
Message-ID: <x2hgb0z9u4.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> The hat() function, returning the diagonal of the hat matrix, currently
> works only on matrices and doesn't work with weights.  Could we make it
> return lm.influence(x)$hat when inherits(x,"lm")?

Shouldn't it be the other way around? i.e. lm.influence(x) sets $hat
to hat.lm(x)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Oct  4 16:49:15 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 4 Oct 1997 17:49:15 +0200
Subject: R-alpha: paste problem in TASKS --- yes, I do really want it
Message-ID: <199710041549.RAA01183@sophie.ethz.ch>

This is from line 104 of current TASKS:

----------------------------------------------------------------------
TASK:	"paste" problem
STATUS:	Open
FROM:	maechler@stat.math.ethz.ch
	in S,
		paste(....., collapse = string)
	always returns ONE string  (a character vector of length 1),
	according to documentation and several examples.
	in R, this is not true:
		R> paste(rep(" ",0), collapse="...") #anything for collapse
		character(0)
		S> paste(rep(" ",0), collapse="...") #anything for collapse
		[1] ""
	Again, I think	R  is more logical than S here, but it was decided
	that in minor cases, compatibility comes first...
	[ Low priority.	 Complain if you really need it. ]
			 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
			 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I hereby complain .

Yes I do want it.  The current behaviour results in  code being broken 
which would work otherwise.
{{of course I can always fix that code by an extra if(....) else .....
  but the point is that if  parse(..) behaved more reasonable,
  I did not have to fix that code..
}}

Yet another example is the  `fun()' Example in  ?tempfile
[in the latest snapshot of R-0.60]
which terminates on error for me just because of the above bug:

fun <- function() {
  FILE <- tempfile("fun")
  on.exit(unlink(FILE))
  system(paste("printenv >", FILE))
  x <- strsplit(scan(FILE, what = ""), "=")
  v <- n <- character(LEN <- length(x))
  for (i in 1:LEN) {
    n[i] <- x[[i]][1]
    v[i] <- paste(x[[i]][-1], collapse = "=")
  }
  structure(v, names = n)
}

> fun()
Read 83 items
Error in "[<-"(c("/u/sfs/adm", "/usr/local/bin", ".:/u/maechler/bib:/u/maechler/tex/styles:.:/u/sfs/bib",  : nothing to replace with

--- and the reason is:    x[[i]][-1]  is empty (some environment values are
					        just defined with no value ..)
 in which case 
		 paste(x[[i]][-1], collapse = "=")
 returns 
		 character(0)

 where it rather should return (IMHO)  
	
		 ""

 v[i] <- character(0)  then gives the error, whereas
 v[i] <- ""		would exactly produce what is wanted.

-----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rcreecy@census.gov  Tue Oct  7 15:29:54 1997
From: rcreecy@census.gov (Rob Creecy)
Date: Tue, 07 Oct 1997 10:29:54 -0400
Subject: R-alpha: Compiling R with Microsoft Visual C++
References: <199710041549.RAA01183@sophie.ethz.ch>
Message-ID: <343A4760.12EA742@census.gov>

I tried compiling R-0.50-a4 with Microsoft Visual C++ 5.0  on Windows NT
4.2
and have some problems.
I am doing this with the hope of being able to contribute to further
development of R
for Windows.

I followed the instructions in the R/src/windows directory, copying the
resulting files to my PC.
Most source files that are not  Windows dependent compile fine, others
such as
wincons.c, plotmath.c do not. I have noticed some missing header files:
<env.h>                not in my compiler distribution
<dl.h>                   is this HP specific? presumably not needed
shellapi.h

I am also not sure if all the needed symbols  and compiler options are
being
properly defined at compile time.
If a working makefile could be made available it might give me some
clues
about how to proceed.

Any suggestions?

Rob Creecy
Census Bureau



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Oct  7 16:46:17 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Oct 1997 17:46:17 +0200
Subject: R-alpha: Compiling R with Microsoft Visual C++
In-Reply-To: Rob Creecy's message of Tue, 07 Oct 1997 10:29:54 -0400
References: <199710041549.RAA01183@sophie.ethz.ch>
 <343A4760.12EA742@census.gov>
Message-ID: <x2bu118tkm.fsf@blueberry.kubism.ku.dk>

Rob Creecy <rcreecy@census.gov> writes:

> 
> I tried compiling R-0.50-a4 with Microsoft Visual C++ 5.0  on Windows NT
> 4.2
> and have some problems.

...

> If a working makefile could be made available it might give me some
> clues
> about how to proceed.
> 
> Any suggestions?

Um, "keep up the good work"? ;^)

Seriously, the current situation is that Robert Gentleman knows how to
compile the code with Watcom C, and that's about it. The rest of us
(with the possible exception of Thomas Lumley) are old Unixers,
utterly perplexed at the Microsoft Programming Universe in general,
and the so-called "user-friendly" Windows development environments in
particular. I got about as far as you when I tried, only more clueless
as to Visual C++ itself. 

So you are essentially on your own, but whatever progress you make
will be greatly appreciated, because the situation is certainly not
very desirable.

One hint, though: Try copying the include files to Unix and use grep
and gcc -E to figure out what is needed from which include files.

In the longer run, we need to set up the possibility of compiling with
several PC compilers, preferably freeware ones, too. Maybe even
crosscompiling from Unix and using a portable GUI library (dream on,
Peter...). I'm having my eyes rather strongly set on the RSXNT
compiler setup, or Gnuwin32, but the latter is a bit large. At the
moment, I'm all engaged in my course in Basic Statistics for Medical
Researchers, though, so I'm not likely to get any further until
December, unless I get a sudden strike of inspiration.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Oct  7 23:33:20 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 8 Oct 1997 11:33:20 +1300 (NZDT)
Subject: R-alpha: keep.order in formulae
Message-ID: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>

[ I'm teaching log-linear models at present, and looking at Agresti's
  book. ]

Often when producing analyis of variance or analysis of deviance
tables it is important to get effects fitted in a specific order.
At present in S / R this is done as follows:

	anova( glm( terms(formula, keep.order=T), ...) )

Can anyone think of a reason why keep.order should not become an
argument to "lm" and "glm", rather than forcing the use of "terms".
I.e., the above could be written:

	anova( glm(formula, ..., keep.order=T) )

Having to resort to the use of "terms" seems like a complication my
punters could do without.

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Oct  8 08:37:47 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 8 Oct 1997 09:37:47 +0200 (MET DST)
Subject: R-alpha: call_R in fortran
Message-ID: <9710080737.AA02034@alpha.luc.ac.be>

While the discussion is on Fortran, any chance of being able to call R
functions from Fortran? I did a hack way back when, when I was
originally working on what became nlm but would like something better.
  Thanks. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct  8 09:51:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 8 Oct 1997 10:51:35 +0200
Subject: R-alpha: dump() / dput() -- fail for "environmental" and attributed functions
Message-ID: <199710080851.KAA02610@sophie.ethz.ch>

Here is a simple example to show what I mean:

	f1 <- approxfun(1:3, 2:4)

	dump("f1", file="")

which yields (in current development snapshot; 
	      other versions are conceptually equivalent)

"f1" <-
function (v) 
.C("approx", as.double(x), as.double(y), n, xout = as.double(v), 
        length(v), as.integer(method), as.double(yleft), as.double(yright), 
        as.double(f), NAOK = T)$xout

i.e., the 'environment' part is not dumped.


Probably, we can well live without this working.
However, dump(.) or dput(.) then should produce a warning or error.
-------

But the problem is more general:
In newer versions of R  functions can have attributes,
(including a "class") -- which is very useful as already mentionend here.

However, even these are NOT dumped properly, and they SHOULD be!

fa <- function(x) x + 1
attr(fa, "class") <- "simple.fun"
dput(fa)

#-- results (wrongly) in

 function (x) 
 x + 1

i.e. `forgets' about the class attribute which you see when printing fa.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct  8 10:36:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 8 Oct 1997 11:36:37 +0200
Subject: R-alpha: wish:  segments(.) / arrows(.)  should allow an 'lwd = <num>' argument
Message-ID: <199710080936.LAA02666@sophie.ethz.ch>

(as the subject says).


Actually, I found that

	arrows
	segments
	rect

have no "..." and no "lwd"  argument
whereas

	lines.default
	polygon
	box

do all have a "..." (but no explicit 'lwd')
which they pass to .Internal( c-code )

-------

For anyone who feels like fixing this:

All the relevant code is in  src/main/plot.c,
and the function are

	do_arrows
	do_segments
	do_rect
etc.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Oct  8 10:48:04 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 8 Oct 1997 11:48:04 +0200
Subject: R-alpha: keep.order in formulae
In-Reply-To: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>
References: <199710072233.LAA29612@stat1.stat.auckland.ac.nz>
Message-ID: <199710080948.LAA02704@UNKNOWN_7>

>>>>> Ross Ihaka writes:

> [ I'm teaching log-linear models at present, and looking at Agresti's
>   book. ]

> Often when producing analyis of variance or analysis of deviance
> tables it is important to get effects fitted in a specific order.
> At present in S / R this is done as follows:

> 	anova( glm( terms(formula, keep.order=T), ...) )

> Can anyone think of a reason why keep.order should not become an
> argument to "lm" and "glm", rather than forcing the use of "terms".
> I.e., the above could be written:

> 	anova( glm(formula, ..., keep.order=T) )

> Having to resort to the use of "terms" seems like a complication my
> punters could do without.

Right.  (Hadn't know about keep.order before ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct  9 09:41:04 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 9 Oct 1997 10:41:04 +0200
Subject: R-alpha: [sboker@calliope.psych.nd.edu: Re: S-PLUS on UNIX plans]
Message-ID: <199710090841.KAA04122@sophie.ethz.ch>

--Multipart_Thu_Oct__9_10:41:03_1997-1
Content-Type: text/plain; charset=US-ASCII

In case you did not realize how much this is related to R :


--Multipart_Thu_Oct__9_10:41:03_1997-1
Content-Type: message/rfc822

Return-Path: s-sender@utstat.toronto.edu
From: "Steven M. Boker" <sboker@calliope.psych.nd.edu>
Date: Wed,  8 Oct 97 16:37:05 -0500
To: s-news@utstat.toronto.edu
Subject: Re: S-PLUS on UNIX plans

My apologies for sending this out in non-ascii text format. (blush)
Here is the message.

On Tue, 7 Oct 1997, Gregory R. Warnes wrote:
>I applaud MathSoft's interest in porting Splus to Linux, and can
>echo "Z. Todd Taylor" comments.
>
>For those who are interested in GNU software, there is an S clone
>in development.  It is named R and can be obtained from
><http://lib.stat.cmu.edu/R.  It is already quite useful, but of
>course, does not have many of the enhancements added to Splus by
>MathSoft.
>

Another poster also was wondering about a Mac version.  I ported
R to OpenStep, the precursor to Apple's new Rhapsody OS.  Rhapsody's
core is just just BSD Unix, so the port took about 4 hours to find
the few definitions that had to be changed.  Of course, this is
just a command-line version.  But the language is, IMHO, the heart
and soul of Splus and how it differentiates itself in the marketplace.
I submit that a port to Linux and a port to Rhapsody could be an
almost identical code tree.  Seriously.  And they'd get another
market for free.

In the mean time, R will own that market as they own the Linux market.

Cheers,
Steve
---
 Steven M. Boker                                 219-631-4941 (voice)
 sboker@nd.edu                                   219-631-8883 (fax)
 <http://www.nd.edu/~sboker/                      219-257-2956 (home)
 Dept. of Psychology, University of Notre Dame, Notre Dame, IN 46556


--Multipart_Thu_Oct__9_10:41:03_1997-1--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Oct 10 09:13:02 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 10 Oct 1997 10:13:02 +0200
Subject: R-alpha: rsept31.zip
Message-ID: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>


I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
at all ... the screen went black for a second and that was it.

Any glue what I've done wrong? Should it work under 3.11 or only under
95/NT?

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 10 11:05:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 10 Oct 1997 12:05:12 +0200
Subject: R-alpha: Bug (since 0.50):  get(name.of.expression)  evaluates
Message-ID: <199710101005.MAA01480@sophie.ethz.ch>

This was not in 0.49 (when expressions where a different kind of objects).

get(..) does an extra eval(..)  when it should not :


###-*- R -*-   (cut and paste into R) ---------------------------

## rm(a) # if there is an 'a' 

 ex <- expression(a)

 ex
#> expression(a)

get("ex") #--- should really just return `expression(a)' ...
>>>>> Error: Object "a" not found

a <- pi
ex
# expression(a)

get("ex") #--- should really just return `expression(a)' ...
# [1] 3.141593

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Oct 10 11:20:12 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Oct 1997 12:20:12 +0200
Subject: R-alpha: rsept31.zip
In-Reply-To: Friedrich Leisch's message of Fri, 10 Oct 1997 10:13:02 +0200
References: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>
Message-ID: <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> 
> 
> I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
> at all ... the screen went black for a second and that was it.
> 
> Any glue what I've done wrong? Should it work under 3.11 or only under
      ^^^^ That's a sticky issue, Fritz... ;)
> 95/NT?

You need to install win32s first. Available from ftp.microsoft.com and
various other places. Latest version (1.30c, I think) is very
descriptively called pw1118.exe. It's a 2.4MB self-extracting file
(which is causing me some trouble with providing it to students on
diskette...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 10 19:24:51 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 10 Oct 1997 14:24:51 -0400
Subject: R-alpha: "[.ts" <- function (x, i, j, drop=T)
Message-ID: <97Oct10.142800edt.26501@mailgate.bank-banque-canada.ca>

This may have been fixed  as I'm working with a slightly old 0.50a
version, but I don't recall seeing it mentioned:

The arguments to "[.ts" needs to be changed to allow drop to be passed
to the NextMethod

"[.ts" <- function (x, i, j, drop=T)

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Oct 14 16:33:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 14 Oct 1997 17:33:55 +0200
Subject: R-alpha: rsept31.zip
In-Reply-To: <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>
References: <199710100813.KAA20635@galadriel.ci.tuwien.ac.at>
 <x2n2khgbs3.fsf@blueberry.kubism.ku.dk>
Message-ID: <199710141533.RAA26871@galadriel.ci.tuwien.ac.at>

>>>>> On 10 Oct 1997 12:20:12 +0200,
>>>>> Peter Dalgaard BSA (PDB) wrote:

PDB> Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
>> 
>> 
>> I tried rsept31.zip under Windows 3.11 yesterday and it didn't work
>> at all ... the screen went black for a second and that was it.
>> 
>> Any glue what I've done wrong? Should it work under 3.11 or only under
PDB>       ^^^^ That's a sticky issue, Fritz... ;)

probably my linux machine doesn't like it, when I write about sticky
issues like ms software and interferes with what I'm writing ...



PDB> You need to install win32s first. Available from ftp.microsoft.com and
PDB> various other places. Latest version (1.30c, I think) is very
PDB> descriptively called pw1118.exe. It's a 2.4MB self-extracting file
PDB> (which is causing me some trouble with providing it to students on
PDB> diskette...).

pw1118.exe did the job for me ... now it works including graphics
... or lets put it this way:

	x<-rnorm(100)
	y<-sin(x)
	plot(x,y)

worked :-)

finding bugs is left to students insisting on using windows

shouldn't there be something in the README?

as for the 2.4MB: the biggest file in the archive is about 350k, so
repacking it into 2 archives <= 1440k shouldn't be a problem.


fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 14 18:49:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 14 Oct 1997 19:49:48 +0200
Subject: R-alpha: extraneous ";" gives  syntax error
Message-ID: <199710141749.TAA02756@sophie.ethz.ch>

Here is what I mean

    > ;1
    ;1
    ^
    Error: syntax error
    > 1;;
    [1] 1
    1;;
      ^
    Error: syntax error
    > 1;;;3
    [1] 1
    1;;;3
      ^
    Error: syntax error

----

In S, these give no syntax errors; 
instead, NULL is returned (in some cases).

It's not a big issue,
but I don't see the advantage of  ``punishing empty statements''.

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From hoffmann@wsl.ch  Wed Oct 15 15:40:41 1997
From: hoffmann@wsl.ch (Christian Hoffmann)
Date: Wed, 15 Oct 1997 16:40:41 +0200
Subject: R-alpha: save in Rseptbeta
Message-ID: <9710151440.AA19871@lagonda>

Dear developers,

I am trying out RSeptbeta on a Win NT 3.51 machine.

Problem:

What is the default name for the Image file? Where can I choose this file?
On the command line?

After startup, in the R Console window, the lines appear:

[Previously saved workspace restored]   ------  seems OK

Error: workspace file corrupted -- no data loaded   ------- what is this???

Then the R.Rprofile File window opens, and I have the choice of two file names: 

Rprofile (which is a copy of the one in the distribution)

and

Save.rmg  (which I generated the previous time).

Choosing Rprofile is OK, the startup functions.
BUT, choosing Save.rmg will produce

[1] 1975
,^
> objects()
character(0)
>
i.e. the startup does not function.

To load the saved image I will have to execute  load("Save.rmg"). 

Questions:
How can the loading be automated? Or be made subject to a choice (window)?

The default for choosing a save file is
  <dir where Rsept resides>\Rprofile

This is misleading. It should default to my own working directory and
propose a name which would be automatically loaded.


I hope that this description is clear enough to find answers.

Thank you very much
--Christian

Christian Hoffmann
Swiss Federal Institute for Forest, Snow and Landscape Research
CH-8903 Birmensdorf, Switzerland
phone: ++41-1-739 22 77    fax  : ++41-1-739 22 15   e-mail:  hoffmann@wsl.ch

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Fri Oct 17 07:42:49 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 17 Oct 1997 16:42:49 +1000
Subject: R-alpha: bug in svd
Message-ID: <199710170642.QAA10196@forde.anu.edu.au>


I use R Version 0.60 Alpha (September 18, 1997) on a Linux Pentium
(Debian 1.3) and on a Sparc-Sun-Solaris 2.5.=20


R> svd(matrix(1:16,4,4))
=09yields on both machines
Error: error  4  in dsvdc

R> svd(matrix(1:20,4,5))
=09gives a result on the Linux computer
$d
[1]  0  0  0 NA

$u
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1

$v
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0   NA   NA
[4,]    0    0   NA   NA
[5,]    0    0   NA   NA

but causes a Segmentation Fault on the solaris machine.

=09Andreas Weingessel

***********************************************************************=
*
*                          Andreas Weingessel                          =
*
***********************************************************************=
*
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 454=
1 *
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 9=
8 *
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at =
*
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel =
*
***********************************************************************=
*



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Muriel.Comblain@ulg.ac.be  Fri Oct 17 09:34:34 1997
From: Muriel.Comblain@ulg.ac.be (Comblain muriel)
Date: Fri, 17 Oct 1997 10:34:34 +0200
Subject: R-alpha: offset in glm not working
Message-ID: <3.0.1.32.19971017103434.009007d0@pop3.mailst.ulg.ac.be>

Hello,

	With the new version of R (septembre), the function glm seems to ignore
the offset. The ouput is exactly the same with or without the offset
specification. I tried the same program in the version of april and it
worked corectly. 

Best Regards
			Muriel Comblain

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Muriel.Comblain@ulg.ac.be  Fri Oct 17 12:28:50 1997
From: Muriel.Comblain@ulg.ac.be (Comblain muriel)
Date: Fri, 17 Oct 1997 13:28:50 +0200
Subject: R-alpha: offset in glm not working
Message-ID: <3.0.1.32.19971017132850.00900530@pop3.mailst.ulg.ac.be>

>Date: Fri, 17 Oct 1997 10:34:34 +0200
>To: r-devel@stat.math.ethz.ch
>From: Comblain muriel <Muriel.Comblain@ulg.ac.be>
>Subject: offset in glm not working
>
>Hello,
>
>	With the new version of R (septembre), the function glm seems to ignore
the offset. The ouput is exactly the same with or without the offset
specification. I tried the same program in the version of april and it
worked corectly. 
>
>Best Regards
>			Muriel Comblain
>


I forgot to precise that I was speaking about the windows version of R.
Sorry for that!

			Muriel Comblain

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Oct 17 13:42:22 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Oct 1997 14:42:22 +0200
Subject: R-alpha: bug in svd
In-Reply-To: Andreas Weingessel's message of Fri, 17 Oct 1997 16:42:49 +1000
References: <199710170642.QAA10196@forde.anu.edu.au>
Message-ID: <x24t6g8ssx.fsf@blueberry.kubism.ku.dk>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> I use R Version 0.60 Alpha (September 18, 1997) on a Linux Pentium
                  ^^^^^^^^^^
> (Debian 1.3) and on a Sparc-Sun-Solaris 2.5. 

As a matter of principle, that version is not released yet, so it may
contain bugs that shouldn't be seen outside the core team. However,
I seem to get the same errors with 0.50.x (with x==2 because I was to
laz^H^H^Hbusy to upgrade it...), so I suppose it can be discussed here
anyway.

> R> svd(matrix(1:16,4,4))
> 	yields on both machines
> Error: error  4  in dsvdc
> 
> R> svd(matrix(1:20,4,5))
> 	gives a result on the Linux computer

Both examples are rank-2 matrices, the problems disappear with random
matrices, so I suspect that the code is unhappy about dealing with
matrices of less than full rank?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:18:54 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:18:54 -0400
Subject: R-alpha: system()
Message-ID: <97Oct17.112109edt.26498@mailgate.bank-banque-canada.ca>

Here is a minor difference between R and S, but the rather pecular
"numeric" result occasionally seems to cause R to crash when it is used.
I'm not sure if this has been changed in .60.

R : ...

> mode(system("date \'+%Y %m %d %H %M %S\'"))
1997 10 17 10 57 27
[1] "numeric"
>
> (system("date \'+%Y %m %d %H %M %S\'"))[1]
1997 10 17 11 13 55
[1] 0
>
> q()
Save workspace image? [y/n/c]: n
$
$ splus...
>  mode(system("date \'+%Y %m %d %H %M %S\'"))
[1] "character"
>

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 17 16:22:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 17 Oct 1997 17:22:37 +0200
Subject: R-alpha: plot(..... sub = 'sub title')  does not work.
Message-ID: <199710171522.RAA00933@sophie.ethz.ch>

The `sub'  is simply disregarded when given as argument to plot(..)
I think, we'd want it to be passed to title.

In the code of  plot.default, it seems clear how this happens.
We have

> plot.default
function (x, y = NULL, type = "p", col = par("fg"), bg = NA, 
        pch = par("pch"), xlim = NULL, ylim = NULL, log = "", 
        axes = TRUE, frame.plot = TRUE, panel.first = NULL, panel.last = NULL, 
        ann = par("ann"), main = NULL, xlab = NULL, ylab = NULL, 
        cex = par("cex"), lty = par("lty"), lwd = par("lwd"), 
        ...) 
{

	..........

        plot.new()
        plot.window(xlim, ylim, log, ...)
        panel.first
        plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, 
                lty = lty, lwd = lwd, ...)
        panel.last
        pars <- list(...)
        if (axes) {
                axis(1, pars = pars)
                axis(2, pars = pars)
                if (frame.plot) 
                        box(...)
        }
        if (ann) 
                title(main = main, xlab = xlab, ylab = ylab, 
                        pars = pars)
        invisible()
}

> title
function (main = NULL, sub = NULL, xlab = NULL, ylab = NULL, 
        ...) 
.Internal(title(as.char.or.expr(main), as.char.or.expr(sub), 
        as.char.or.expr(xlab), as.char.or.expr(ylab), ...))
	
-------

It is not clear to me which function should be fixed:

Either add 'sub=NULL' to the argument list of plot.default,

1)	 and all will work, but we have yet another arg

or

2)	change the .Internal(title(.....))  such that it also looks for a 
	'sub' arg in its "..." arguments and takes that one if it exists.


To patch plot.default is easier to implement,
but improving (internal) title would have potential
benefits to many other circumstances...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:24:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:24:59 -0400
Subject: R-alpha: system() ok
Message-ID: <97Oct17.112714edt.26498@mailgate.bank-banque-canada.ca>

It seems I just need intern=T. I'll just put this in my small list of S
and R differences:

> mode(system("date \'+%Y %m %d %H %M %S\'", intern=T))
[1] "character"
>

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 17 16:34:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 17 Oct 1997 17:34:23 +0200
Subject: R-alpha: system() ok  --  is.R() function
In-Reply-To: <97Oct17.112714edt.26498@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 17 Oct 1997 11:24:59 -0400)
Message-ID: <199710171534.RAA00952@sophie.ethz.ch>

>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> It seems I just need intern=T. I'll just put this in my small
    Paul> list of S and R differences:

    >> mode(system("date \'+%Y %m %d %H %M %S\'", intern=T))
    Paul> [1] "character"
    >>

Paul, remember that in S-plus,  system(.) does not exist at all.
When you use  system(.) in S-plus,
you use your own version
which I remember you posted as part of your
	``S--R compatibility package''
on R-help or R-devel a while ago.

So I think you should redefine your  system(..) function in S-plus.

BTW: I have been using your  S--R compatibility package for quite a while
     now, and I can assure you that you can shorten it quite a bit, once
     0.60 (this is ``sixty'', not ``six o'') will be out.

Note that I mainly use the `is.R(.)' function
originated by you, but the follow version is ``better'' because it

###--  works in  all versions of
###-- S  (including "S version 4", (beta))
###-- R
###-- S-plus

is.R <- function() { ## returns  'TRUE'  iff we are using 'R'
  exists("version") && !is.null(vl <- version$language) && vl == "R"
}

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 16:49:24 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 11:49:24 -0400
Subject: R-alpha: system() NOT ok
Message-ID: <97Oct17.115143edt.26514@mailgate.bank-banque-canada.ca>

Why does parse not work below and why does assigning it crash R?

Paul
________
$ R
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-3 (August 8, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> system("date \'+%Y %m %d %H %M %S\'", intern=T)
[1] "1997 10 17 11 43 21"
> parse(text = system("date \'+%Y %m %d %H %M %S\'", intern=T),white =
T)
1997 10 17 11 43 43
      ^
expression()
> d <- parse(text = system("date \'+%Y %m %d %H %M %S\'",
intern=T),white = T)
1997 10 17 11 44 22
      ^
>
$

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Oct 17 17:08:45 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 17 Oct 1997 09:08:45 -0700 (PDT)
Subject: R-alpha: system() NOT ok
In-Reply-To: <97Oct17.115143edt.26514@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971017090227.10996A-100000@troi>

On Fri, 17 Oct 1997, Paul Gilbert wrote:

> Why does parse not work below and why does assigning it crash R?
> 
> Paul
> ________
> $ R
> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.50 Alpha-3 (August 8, 1997)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type "license()" for details.
> 
> > system("date \'+%Y %m %d %H %M %S\'", intern=T)
> [1] "1997 10 17 11 43 21"
> > parse(text = system("date \'+%Y %m %d %H %M %S\'", intern=T),white =
> T)
> 1997 10 17 11 43 43
>       ^

It doesn't work because space-separated lists of numbers aren't valid R
syntax. You can use 
  >parse(text=strsplit( system("date \'+%Y %m %d %H %M %S\'",
intern=T)," ")[[1]])
 expression(1997, 10, 17, 9, 7, 8)

where strsplit(a,b) splits string a at character b.

	
The crash is a known bug and happens whenever you assign the result of a
syntax error in the parser.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Oct 17 17:19:17 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 17 Oct 1997 09:19:17 -0700 (PDT)
Subject: R-alpha: offset in glm not working
In-Reply-To: <3.0.1.32.19971017132850.00900530@pop3.mailst.ulg.ac.be>
Message-ID: <Pine.SUN.3.95.971017090921.10996B-100000@troi>

On Fri, 17 Oct 1997, Comblain muriel wrote:

> >
> >	With the new version of R (septembre), the function glm seems to ignore
> the offset. The ouput is exactly the same with or without the offset
> specification. I tried the same program in the version of april and it
> worked corectly. 
> >

Yes, this is a bug.  The modelling code was changing quite rapidly at
about the time rsept was built, and it ended up without support for
offsets.

There are two problems. The version of model.frame/model.matrix in
rsept doesn't allow 
	glm(y~x+offset(z))
and the model.offset() function is broken so that
	glm(y~x,offset=z) 
doesn't work. The second problem is easy to fix 

If you define
model.offset  <- function (x) 
{
        offsets <- attr(attr(x, "terms"), "offset")
        if (length(offsets) > 0) {
                ans <- 0
                for (i in offsets) ans <- ans + x[[i]]
        }
        else NULL
}

by adding it to your profile, or by editing the base library
then  glm(y~x,offset=z) will work. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Oct 17 21:51:37 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 17 Oct 1997 16:51:37 -0400
Subject: R-alpha: on.exit
Message-ID: <97Oct17.165401edt.26506@mailgate.bank-banque-canada.ca>

I seem to be having trouble with on.exit not executing when my code
executes a stop(). Has anyone else noticed this in 0.50alpha 3?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Oct 18 19:32:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Oct 1997 20:32:02 +0200
Subject: R-alpha: This weeks bugs and requests for enhancements
Message-ID: <x2hgaej525.fsf@blueberry.kubism.ku.dk>


Here's a number of items that came up in connection with my course for 
medical ph.d. students this week:

boxplot():
        - deals ungracefully with empty groups and factor levels not
	present in grouping variable.
        - no indication of what variable is being plotted

data.entry() (mostly W95 rseptbeta problems)
        - Entry of first variable name doesn't take before 2nd
        name is entered.
        - data.entry(BW,RMR) gives two columns named BW. Quitting
	dataeditor at that point *overwrites* BW with RMR!
        - inserting NA is only possible by switching to character
	values, entering invalid number, and switching back to numeric
        - blanking a field, then exiting dataeditor crashed one system
	(I *think*)

        Req.f.enhancem.:
        - insert/delete rows (in single column *and* range of columns)
        - undo facilities and "panic button"
        - use comma as decimal point (Nat.variant of W95 maps Keypad
	period to comma)
        - switch between vertical/horizontal cell cursor movement on
	Enter.

Misc:
	quantile() labels results as % rounded to integer, which is
	kind of confusing when 2.5% and 97.5% is one of the first
	things people want to try:
	> quantile(rnorm(1000),c(.025,.975))
	       2%       98% 
	-2.067519  1.891768 

        plot() still has inconsistency with docs in xlog/ylog vs
	log="xy". Which one do we want?

        at some point we want to be able to specify collating
	sequences for sorting character vectors. Case in point: The
	Danish alphabet ends ..uvwxyzæøå , but
        > sort(c("æ","ø","å"))
        [1] "å" "æ" "ø"
        (No such thing as a universal collating seq. E.g. Norwegian
	has the same three letters in a different order. So it should
	probably be via options(collate=..).

        The ~ notation could be used more consistently, in particular
	in t.test and friends.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Oct 18 21:07:58 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 18 Oct 1997 22:07:58 +0200
Subject: R-alpha: Re: problem vith "cmdscale" on W95
In-Reply-To: <3.0.1.32.19971018104425.0069f234@stat.unipg.it> (message from
 Andrea Rossetti on Sat, 18 Oct 1997 10:44:25 +0200)
Message-ID: <199710182007.WAA16232@jessica.ethz.ch>


    AR> I tried to do

    AR> library(mva)
    AR> data(quakes)
    AR> quakes<-quakes[sample(seq(1:1000),100),1:5]
    AR> cmd.dsq<-cmdscale(dsq)
    AR> Error in .C("dblcen", x, as.integer(n)) : C/Fortran function not in load table

    AR> how can I solve this problem?

You should ask this on the mailing list (you only e-mailed to me), 
actually probably better R-devel than R-help.

The above message indicates that the dynamic loading (which should happen
with "library(mva)") did not work in your setup.
I dont know if this is a known problem in Rseptwin or problem of your setup
only.

Good luck,	Martin.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Oct 19 01:53:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 19 Oct 1997 13:53:40 +1300 (NZDT)
Subject: R-alpha: bug in svd
In-Reply-To: <199710170642.QAA10196@forde.anu.edu.au>
References: <199710170642.QAA10196@forde.anu.edu.au>
Message-ID: <199710190053.NAA17919@stat1.stat.auckland.ac.nz>

Andreas Weingessel writes:
 > 
 > R> svd(matrix(1:16,4,4))
 > 	yields on both machines
 > Error: error  4  in dsvdc

This is a bug in the interpreted code.  It assumes that its argument
is real valued.  1:16 produces an integer value.  The fix is to change
the svd function so that the call to LINPACK is

z <- .Fortran("dsvdc", as.double(x), n, n, p, d = double(mm), double(p),
         u = u, n, v = v, p, double(n), as.integer(job),
         info = integer(1), DUP = FALSE)[c("d", "u", "v",
         "info")]

i.e. you have to wrap an "as.double" around "x".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Oct 20 15:46:52 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 20 Oct 1997 10:46:52 -0400
Subject: R-alpha: Re: R-beta: Time Series Analysis
References: <3.0.1.32.19971016182321.006863d4@stat.unipg.it> <3.0.1.32.19971018085459.006a0d04@stat.unipg.it>
Message-ID: <97Oct20.105100edt.26501@mailgate.bank-banque-canada.ca>

>>I have a version of my time series library (DSE) which works 99% in R
>>0.50 Alpha-3. I'm waiting for the soon to be beta release (I
understand
>>this will be R 0.6) before I make it public, since I think a few
things
>>may be changing ...

>I've visited your home page, what DSE file I must download to plug-in
>rseptbeta for W95?

None of the versions currently on my home page work well in R, but I do
have a version which works very well with R. I will put it on my home
page soon, probably about the end of November. If you are really in a
hurry I can make it available for you sooner, but if you wait it will be
easier (for both of us).

I have not yet done any configuration or testing under W95.  Are complex
numbers working in rseptbeta for W95? How should library installation
and compiling of fortran be approached on W95? I currently use Unix make
files.

Paul Gilbert




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Oct 20 17:57:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 20 Oct 1997 12:57:56 -0400
Subject: R-alpha: system() ok  --  is.R() function
References: <199710201331.PAA03410@sophie.ethz.ch>
Message-ID: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>

Martin

Your revisions to my S--R compatability code suggest that tempfile() is
in R after 0.49. I don't find that to be the case. It requires code from
Friedrich Leisch which still has to be added as of 0.50 alpha3.

Paul
_______
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-3 (August 8, 1997)
> exists("tempfile", mode = 'function')
[1] FALSE
>

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Oct 21 07:31:59 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 21 Oct 1997 08:31:59 +0200
Subject: R-alpha: system() ok  --  is.R() function
In-Reply-To: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>
References: <199710201331.PAA03410@sophie.ethz.ch>
 <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca>
Message-ID: <199710210631.IAA06442@pc25.none>

>>>>> Paul Gilbert writes:

> Martin
> Your revisions to my S--R compatability code suggest that tempfile() is
> in R after 0.49. I don't find that to be the case. It requires code from
> Friedrich Leisch which still has to be added as of 0.50 alpha3.

> Paul
> _______
> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.50 Alpha-3 (August 8, 1997)
>> exists("tempfile", mode = 'function')
> [1] FALSE
>>

Under Unix, you can do with the following which will also be in 0.60:

tempfile <- function(pattern = "file") {
  system(paste("for p in", paste(pattern, collapse = " "), ";",
               "do echo /tmp/$p$$; done"),
         intern = TRUE)
}


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 21 07:48:57 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 21 Oct 1997 08:48:57 +0200
Subject: R-alpha:  tempfile(.) [in 0.50-a4] -- or  use .C() instead?
In-Reply-To: <97Oct20.130141edt.26506@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Mon, 20 Oct 1997 12:57:56 -0400)
Message-ID: <199710210648.IAA06380@sophie.ethz.ch>

>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> Martin Your revisions to my S--R compatability code suggest that
    Paul> tempfile() is in R after 0.49. I don't find that to be the
    Paul> case. It requires code from Friedrich Leisch which still has to
    Paul> be added as of 0.50 alpha3.

However,  it IS there in  0.50 Alpha-4 :

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-4 (September 10, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> tempfile
function (pattern = "file") 
{
        system(paste("for p in", paste(pattern, collapse = " "), 
                "; do echo /tmp/$p$$; done"), intern = TRUE)
}

----------
(and the same version is in current 0.60 pre-alpha).

Yes, I've thought too, that it could be better to use Fritz' C-version
since that one might also work on non-Unix systems.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Oct 22 23:41:55 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Oct 1997 00:41:55 +0200
Subject: R-alpha: na.woes
Message-ID: <x2u3e9ifnw.fsf@blueberry.kubism.ku.dk>


1) hist() does not take NA's. Incompatible with Splus, probably just a
   bug?

2) I do wish we could somehow get rid of the misfeatures of indexing
with logical NA's:
> table(juul$menarche,juul$tanner)
      I II III IV   V
No  221 43  32 14   2
Yes   1  1   5 26 202
> juul$menarche=="Yes"&juul$tanner=="I",]

...and you find yourself with a listing of 477 cases, of which the 476
are NA-filled. To find the interesting case, you need to go through
the following contortions:

> menar.t1 <- juul$menarche=="Yes"&juul$tanner=="I" 
> menar.t1 <- menar.t1 & !(is.na(menar.t1))        
> juul[menar.t1,]
      age menarche sex igf1 tanner testvol
962 12.33      Yes   F   NA      I      NA

I can't think of a single case where the current behavior is useful.
Indexing with numerical NA's makes sense, e.g. when recoding, and then
there's the boundary case of indexing with a vector where all elements
are logical NA's (should they be promoted to numeric?), but situations
where they arise naturally are pretty hard to think up.

Current behavior is Splus-compatible, but its still annoying.

--------------------

BTW, re. case labels, R is *not* Splus-compatible:

R:
> menar.t1[1]<-NA
> juul[menar.t1,]
      age menarche sex igf1 tanner testvol
NA     NA       NA  NA   NA     NA      NA
962 12.33      Yes   F   NA      I      NA
> menar.t1[2]<-NA
> juul[menar.t1,]
Warning: some row names are duplicated; argument ignored
       age menarche sex igf1 tanner testvol
[1,]    NA       NA  NA   NA     NA      NA
[2,]    NA       NA  NA   NA     NA      NA
[3,] 12.33      Yes   F   NA      I      NA
 
Splus:
> data[c(T,NA,rep(F,14)),]
  x1 x2 x3 x4 migraine not.migraine 
1  0  0  0  0       25          546
  NA NA NA NA       NA           NA
>  data[c(T,NA,NA,rep(F,13)),]
    x1 x2 x3 x4 migraine not.migraine 
 X1  0  0  0  0       25          546
  X NA NA NA NA       NA           NA
X11 NA NA NA NA       NA           NA

Somehow, I don't think we should strive for compatibility on this
point... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Thu Oct 23 20:05:04 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 23 Oct 1997 15:05:04 -0400
Subject: R-alpha: OStype
Message-ID: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>

Robert

I've been looking through my "R -- S compatibility" functions which may
mostly disappear in R 0.60. In fact, it seems already that most of the
things I'm trying to do are for operating system differences rather than
R/S differences. The main problem I am having is that version$os gives
more detail then I usually need, but it is not very convenient for
determining simply if the operating system is Unix. Perhaps you could
suggest a better version of the OStype function below.

Thanks
Paul Gilbert
___________

OStype <- function()
   {if (version$os == "MS Windows") return(version$os)
    if (version$os == "Mac") return(version$os) # needs to be checked
    else return ("Unix")  # not a very satisfactory test
   }

is.MSwindows <- function(){OStype() == "MS Windows"}
is.unix      <- function(){OStype() == "Unix" }



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Kurt.Hornik@ci.tuwien.ac.at  Fri Oct 24 10:55:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 24 Oct 1997 11:55:43 +0200
Subject: R-alpha: OStype
In-Reply-To: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>
References: <97Oct23.151018edt.26507@mailgate.bank-banque-canada.ca>
Message-ID: <199710240955.LAA19249@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Robert
> I've been looking through my "R -- S compatibility" functions which may
> mostly disappear in R 0.60. In fact, it seems already that most of the
> things I'm trying to do are for operating system differences rather than
> R/S differences. The main problem I am having is that version$os gives
> more detail then I usually need, but it is not very convenient for
> determining simply if the operating system is Unix. Perhaps you could
> suggest a better version of the OStype function below.

> Thanks
> Paul Gilbert
> ___________

> OStype <- function()
>    {if (version$os == "MS Windows") return(version$os)
>     if (version$os == "Mac") return(version$os) # needs to be checked
>     else return ("Unix")  # not a very satisfactory test
>    }

Isn't this what machine() does?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 24 11:06:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Oct 1997 12:06:09 +0200
Subject: R-alpha: OStype
In-Reply-To: <199710240955.LAA19249@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 24 Oct 1997 11:55:43 +0200)
Message-ID: <199710241006.MAA10147@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
    >> Robert I've been looking through my "R -- S compatibility" functions
    >> which may mostly disappear in R 0.60. In fact, it seems already that
    >> most of the things I'm trying to do are for operating system
    >> differences rather than R/S differences. The main problem I am
    >> having is that version$os gives more detail then I usually need, but
    >> it is not very convenient for determining simply if the operating
    >> system is Unix. Perhaps you could suggest a better version of the
    >> OStype function below.

    >> Thanks Paul Gilbert ___________

    >> OStype <- function() {if (version$os == "MS Windows")
    >> return(version$os) if (version$os == "Mac") return(version$os) #
    >> needs to be checked else return ("Unix") # not a very satisfactory
    >> test }

    Kurt> Isn't this what machine() does?

Sure,
here is corresponding online help

  HELP> Determine the Machine R is Running On
  HELP> 
  HELP>      machine()
  HELP> 
  HELP> Description:
  HELP> 
  HELP>      This function returns a string which specifies what
  HELP>      kind of environment R is being run in.
  HELP> 
  HELP> Examples:
  HELP> 
  HELP>      if (machine() == "Macintosh")
  HELP>        cat("You are using a Macintosh computer\n")
  HELP> 

Paul's problem is that  machine()  does not exist in  S(plus)...
and the point of his  S--R package is that it is 
	- `source()able' by all versions of S / S-plus / R 
	- defines functions which work on all versions of  ....

However,
he would probably use
	
	.... if(is.R()) machine()  ...

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 28 09:26:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 28 Oct 1997 10:26:34 +0100
Subject: R-alpha: New URL for R-online manual (HTML)
In-Reply-To: <199710280003.NAA28838@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 28 Oct 1997 13:03:48 +1300 (NZDT))
Message-ID: <199710280926.KAA03131@sophie.ethz.ch>

Most important:  (Kurt, R&R,..) Update this in the FAQ and other  pages.
				~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Because of the new (0.60) way of having HTML help for all libraries (not
only "base"), the html files reside in different places.

I have changed the setup such that
from now on, you should 
use
	<A HREF="http://www.stat.math.ethz.ch/R/manual/">
instead of the older
				        ...../R-manual/

(i.e. only replace the `-' by a `/').

The old link continues to work, i.e., it now contains a link to the new
place.

BTW: You currently get the  0.60 (daily snapshot) on-line help
     when using the above URL.

	[[ I will change back to point to a released version of R, once that is
	   less out dated  ;;-) ]]
- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Oct 28 17:37:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 28 Oct 1997 18:37:35 +0100
Subject: R-alpha: Bug[?] in axis(.) -- using format(.) for labels can give nonsense
Message-ID: <199710281737.SAA04464@sophie.ethz.ch>

To see what I mean,
try

 x11()
 par(mfrow=c(2,1))
 x <- 1:100
 plot(x, sin(pi*x/100))
 options(digits= 20)
 plot(x, sin(pi*x/100))

The problem really is in  axis(.) which uses  format(.) for the axis
labels.
I think  the result of axis(.) should NOT be influenced by

	options()$digits.

Should I change it?

--
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Oct 29 01:28:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Oct 1997 02:28:35 +0100
Subject: R-alpha: Bug[?] in axis(.) -- using format(.) for labels can give nonsense
In-Reply-To: Martin Maechler's message of Tue, 28 Oct 1997 18:37:35 +0100
References: <199710281737.SAA04464@sophie.ethz.ch>
Message-ID: <x22015pdbw.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> To see what I mean,
> try
> 
>  x11()
>  par(mfrow=c(2,1))
>  x <- 1:100
>  plot(x, sin(pi*x/100))
>  options(digits= 20)
>  plot(x, sin(pi*x/100))
> 
> The problem really is in  axis(.) which uses  format(.) for the axis
> labels.
> I think  the result of axis(.) should NOT be influenced by
> 
> 	options()$digits.
> 
> Should I change it?

Hm. The root of the problem is this:
>  options(digits= 20)
> 0:5*0.1
[1] 0.00000000000000000 0.10000000000000001 0.20000000000000001
[4] 0.30000000000000004 0.40000000000000002 0.50000000000000000

I.e. the plot labels get a large number of digits because of numerical
inaccuracy, and then there's only room for one of them on the axis.
I say you deserve what you get... 

I'm a bit more worried by

 options(digits=1)
 plot(seq(50.2,50.5,0.1))

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Oct 29 17:20:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Oct 1997 18:20:01 +0100
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <Pine.SUN.3.95.971029082753.7042B-100000@troi> (message from
 Thomas Lumley on Wed, 29 Oct 1997 08:42:00 -0800 (PST))
Message-ID: <199710291720.SAA01035@sophie.ethz.ch>

	[This is a "spill-over"  from the  "R-core"  mailing list,
	 since several of you may be interested and have comments ... -MM]

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> On 29 Oct 1997, Peter Dalgaard BSA wrote:
    >> Perhaps we should revise the current contents of the base library
    >> and replace some noncrucial items with autoloads? (The ts stuff for
    >> instance, glm, maybe even lm).

    Thomas> It would be interesting to experiment along these lines.
    Thomas> Clearly if something is going to be loaded it saves time and
    Thomas> space to do it immediately, but if it isn't going to be used
    Thomas> it's better to keep it on disk.  Personally, I use glm nearly
    Thomas> every time I use R, but other people may have different needs.

    Thomas> The problem clearly isn't urgent, since the only library slated
    Thomas> for inclusion is ctest, which is nice and compact. However, a
    Thomas> configurable, modular approach seems like a good idea, and
    Thomas> works for emacs.  Given the desire to run R on small machines
    Thomas> we certainly can't follow the S-PLUS path of including
    Thomas> everything useful in the default set-up. For example, survival4
    Thomas> takes up a quarter of the cons cells using the default
    Thomas> settings, and nlme() (if we ever do it) will presumably be
    Thomas> fairly large as well.

NOTE: These things (libraries) are called ``packages'' from 0.60 on ..
					    --------

    Thomas> Perhaps this is more of a r-devel type comment?

Yes ! [and you see, I took the liberty ...]


Actually, I have thought along similar lines:
I think it is a neat concept to use autoload and  more than just the  'eda'
and 'mva'  libraries. 

BTW: Is it a good idea if I include  my  
	stepfun / ecdf     functions into a new library  'stepfun' ?
     ie. a library that belongs to the distribution instead of being contrib?
	
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From rossini@math.SC.EDU  Wed Oct 29 17:50:30 1997
From: rossini@math.SC.EDU (Anthony Rossini)
Date: 29 Oct 1997 12:50:30 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: Martin Maechler's message of "Wed, 29 Oct 1997 18:20:01 +0100"
References: <199710291720.SAA01035@sophie.ethz.ch>
Message-ID: <wnc3elklaqh.fsf@neuromancer.stat.sc.edu>


>>>>> "Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> On 29 Oct 1997, Peter Dalgaard BSA wrote:
    >>> Perhaps we should revise the current contents of the base library
    >>> and replace some noncrucial items with autoloads? (The ts stuff for
    >>> instance, glm, maybe even lm).

    Thomas> It would be interesting to experiment along these lines.
    Thomas> Clearly if something is going to be loaded it saves time and
    Thomas> space to do it immediately, but if it isn't going to be used
    Thomas> it's better to keep it on disk.  Personally, I use glm nearly
    Thomas> every time I use R, but other people may have different needs.

    Martin> Actually, I have thought along similar lines: I think it
    Martin> is a neat concept to use autoload and more than just the
    Martin> 'eda' and 'mva' libraries.

    Martin> BTW: Is it a good idea if I include  my  
    Martin> 	stepfun / ecdf     functions into a new library  'stepfun' ?
    Martin>      ie. a library that belongs to the distribution
    Martin>      instead of being contrib?

Can we do like emacs, and have a means for "dumping" packages into R?
Even if it is just a matter of adding or removing comments in
appropriate places, this could be useful.  Just like emacs, this would
increase the initial size, but means that little time is wasted during
load.

[I assume that the discussion is with respect to replacing packages
with autoloads, and I for one would consider doing that with some of
the packages as a "Good Thing"(tm) (since I've got to the point that
I'd rather wait to have things grow as I need them, rather than let
them start huge and grow incrementally at a small pace).]

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulhu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Oct 29 17:48:23 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 1997 12:48:23 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
References: <199710291720.SAA01035@sophie.ethz.ch>
Message-ID: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>

Perhaps someone could bring those of us not in "core" up to date a bit.
What are advantages of autoload and the implications, especially for
memory and speed.  Currently I have to divide my package into several
pieces in order to load it (I'm not too  sure why, but it is fairly
big). This is what I do:

R  -v6 -n250000
library("dse/tframe")
library("dse/dse1")
library("dse/dse2")
library("dse/dsex1")
library("padi/padi")
library("dse/dsex2")

Some pieces are much more important and frequently used than others.
Also, within some pieces there are functions which are used a lot more
than others. Should I consider autoloading everything? Will I still need
to divide the package into pieces? Should I avoid autoloading anything
that is used really frequently?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Thomas Lumley <thomas@biostat.washington.edu>  Wed Oct 29 18:57:28 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Wed, 29 Oct 1997 10:57:28 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029103311.7363A-100000@troi>

On Wed, 29 Oct 1997, Paul Gilbert wrote:

> Perhaps someone could bring those of us not in "core" up to date a bit.
> What are advantages of autoload and the implications, especially for
> memory and speed. 

There is very little difference between explicit loading using library() 
or require() and autoload(). 

If you type 
	autoload("myfun","package") 
then typing, say,
	a<-myfun(42)
is equivalent to 
	library(package)
	a<-myfun(42)
This is accomplished by subtle magic involving the "lazy evaluation"
mechanism.

Using autoload() has a (small) additional overhead in speed and memory (12
cons cells), as the autoload information must be stored somewhere and it
must be parsed when myfun() is called. It is also possible that functions
which do creative things with sys.frame()  may not like being autoloaded,
but I don't have any examples.

The main difference in speed over putting a library() statement in
Rprofile is that the delay happens when the function is first used rather
than when R is started.

>	Should I consider autoloading everything? Will I still need
> to divide the package into pieces? Should I avoid autoloading anything
> that is used really frequently?

As autoload("myfun","package") works by arranging for 
	library("package")  
to be evaluated in the global environment the first time myfun() is called
it should work the same as library().

If you know what functions you use all the time, it may well make sense to
just use library() to load them. 

The point of autoload() is transparency.  If you want survival analysis
routines available for your or your students' occasional use, but don't
want to sacrifice 40000 cons cells and 100k of vector heap, you can put a
set of autoloads in Rprofile for all the common functions in survival4 and
have them available if they are needed. 

It also makes sense for a package containing some rarely used features to
be divided in two, so that you initially load the commonly used features
and autoloads for the other.  In the version of survival4 for R0.60 coming
very soon, the US census mortality tables that come with survival4 for S
are in a separate package with autoloads to load them only if they are
needed.  Since they occupy nearly 200k of the vector heap and I personally
have never used them this is a worthwhile saving.

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Wed Oct 29 19:05:23 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 29 Oct 1997 11:05:23 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
In-Reply-To: <97Oct29.125401est.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029110137.7363D-100000@troi>


One disadvantage, probably fixable, of autoload over loading in Rprofile
that I forgot to mention is that the help for a package isn't available
until it's loaded.

So

	library(eda)
	help(smooth)
works, but
	autoload("smooth","eda")
	help(smooth)
doesn't.

If this is a big problem it should be possible to modify help().

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Oct 29 19:54:30 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 1997 14:54:30 -0500
Subject: R-alpha: Using autoload and smaller 'base' package [was "Re: New Version"].
References: <Pine.SUN.3.95.971029103311.7363A-100000@troi>
Message-ID: <97Oct29.151248est.26572@mailgate.bank-banque-canada.ca>

If I understand this correctly, the whole package gets autoloaded the
first time any function in the package is referenced (and then never
unloaded until q()?).  Thus there would be an advantage to reorganizing
frequently used functions and infrequently used functions in separate
packages. The current organization of the code in my packages is based
on a different logic. For example, I have a test function in the package
to test functions in the package. This function may never be used by
someone who uses the package.

Would it be possible/logical/easy  to make autoload work on a function
by function basis? (Sounds a bit like an S .Data directory.) Is there a
limit on how many packages can be autoloaded?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Wed Oct 29 20:56:15 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 29 Oct 1997 12:56:15 -0800 (PST)
Subject: R-alpha: Using autoload and smaller 'base' package
In-Reply-To: <97Oct29.151248est.26572@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971029123224.7756A-100000@troi>

On Wed, 29 Oct 1997, Paul Gilbert wrote:

> If I understand this correctly, the whole package gets autoloaded the
> first time any function in the package is referenced (and then never
> unloaded until q()?).

Yes, though you can explicitly unload a package with
	detach("package:package") 
and it will still be reloaded automatically when needed. 
 
> Would it be possible/logical/easy  to make autoload work on a function
> by function basis? (Sounds a bit like an S .Data directory.) Is there a
> limit on how many packages can be autoloaded?
> 

Possible and easy, but not logical:

There's no strict limit to the number of packages, but the overhead goes
up sharply as the packages get smaller.  For the current sorts of package
the overhead would be trivial, but for one-function packages it would be
quite large.  Increasing the number of packages loaded also slows a lot of
things down, as the search path gets longer and longer. 

There is also some overhead on opening files, so loading lots of little
packages is slower than loading one big package.

I think autoload() is only worthwhile on largish, coherent blocks,
especially in its current interpreted form. Anything more ambitious would
probably require delving into the internal C code that finds and evaluates
things, and considering horrible things like caching and buffering for
disk access. 

	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Thu Oct 30 08:10:54 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 30 Oct 1997 09:10:54 +0100 (MET)
Subject: R-alpha: nlme
Message-ID: <9710300810.AA18176@alpha.luc.ac.be>

In the discussion on packages, I noted the following phrase:

and nlme() (if we ever do it)

I am waiting impatiently for this to be done. I contacted Douglas
Bates sometime ago, who said that it would be difficult because of the
differences in internals between R and S. I have looked at the code,
but it is too much for me: I know nothing of S. Is there a volunteer???
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 09:02:29 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 10:02:29 +0100
Subject: R-alpha: Bug[let] in (internal) print [for a list with dimnames ...].
Message-ID: <199710300902.KAA00502@sophie.ethz.ch>

Try the following code.
In S-plus, it does print nicely..

 n <- 17
 fac <- factor(rep(1:3, len = n), levels = 1:5)
 tfq <- tapply(1:n, fac, quantile)
 tfq
 print.default(tfq)
 if(version$minor >= 60) str(tfq)  else  c(tfq)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:29:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:29:47 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
Message-ID: <199710301029.LAA00845@sophie.ethz.ch>

Evaluate the following example to get the behavior :

		--- anybody: patch ? ---


tst.i <- function(x)
{
  if(missing(x))
    return(invisible())
  else if(!is.numeric(x)) stop("x must be numeric")
  ## else
  invisible((x+3)^2)
}

tst.i()#-- should NOT print anything !!
print(mode(tst.i()))#--gives "NULL"   both in S-plus 3.4 and R 0.60

tst.i(1)# nothing (ok in R and S-plus)
1 + tst.i(1) #> 17
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:40:36 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:40:36 +0100
Subject: R-alpha: c(..., a) fails [in a function(x, ...)]
Message-ID: <199710301040.LAA00947@sophie.ethz.ch>

A minor inconsistency to  S  which can (I think did) break existing code
(ported from S to R):
 
In R, the  "..." arguments cannot be passed to 'c(..)' :

  ex3.. <- function(...) c(...,exp(1))
  ex3..()# 2.718282
  ##R  Error: ... used in an incorrect context
  ex3..(1:2)# 1 2  2.718282
  ##R  Error: ... used in an incorrect context

  ##--- Only this one works in R 0.60 (Oct.28) also:
  ex4.. <- function(...) c(unlist(list(...)),exp(1))
  ex4..()# 2.718282
  ex4..(1:2)# 1 2  2.718282
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Oct 30 10:54:52 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 30 Oct 1997 11:54:52 +0100
Subject: R-alpha: names(j) <- NULL  fails for a `call' object
Message-ID: <199710301054.LAA01011@sophie.ethz.ch>

I found this ((as part of a more severe problem which WAS fixed))
in   ``old closed tasks'' a while ago..

It still _is_ a  (minor) problem, i.e. an  R<-->S inconsistency


##- TASK:	Name Attributes on Calls
##- STATUS: Closed
##- FROM:	<p.dalgaard@kubism.ku.dk>
##- 	A call with tagged arguments is something like a list, the tags
##- 	can be used to access elements, but the names attribute is absent,
##- 	until the call is coerced to a list. (Attempting to set the names()
##- 	causes evaluation. Changing "list" to "blipblop" causes an 'Error:
##- 	couldn't find function "blipblop"' at that point.)

print(j <- substitute(list(a=1, b=2)))##	list(a = 1, b = 2)
mode(j); is.call(j)#  "call" ,  TRUE
j$b##	[1] 2
names(j)# [1] ""  "a" "b"

names(j) <- NULL ; j #-- doesn't do anything in R -- but does in S-plus
## S:   list(1, 2)
## R-0.50-a2 and  R-0.50-a4 :
##	list(a = 1, b = 2)
mode(j)#>  [1] "call"
names(j)# S: NULL;  R:  ""  "a" "b"

names(j) <- c("", "CC", "DD"); j #-- this DOES work ...
names(j) <- c("", "", ""); j #-- this DOES work ...
names(j) <- c("blipblop", "x", "y"); j# no change to 'list' [[same for R and S]]
## list(x = 1, y = 2)
names(j) #  [[same for R and S]]:
## [1] "blipblop" "x"        "y"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 12:10:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 13:10:58 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: Martin Maechler's message of Thu, 30 Oct 1997 11:29:47 +0100
References: <199710301029.LAA00845@sophie.ethz.ch>
Message-ID: <x2en53o3hp.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> Evaluate the following example to get the behavior :
> 
> 		--- anybody: patch ? ---
> 
> 
> tst.i <- function(x)
> {
>   if(missing(x))
>     return(invisible())
>   else if(!is.numeric(x)) stop("x must be numeric")
>   ## else
>   invisible((x+3)^2)
> }

Actually, 
> tst.i<-function()return(invisible(3))
> tst.i()
[1] 3

(in my snapshot of 0.60, Oct 24) So return(invisible(...)) just
doesn't work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Thu Oct 30 14:52:54 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 30 Oct 1997 08:52:54 -0600 (CST)
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: <199710301029.LAA00845@sophie.ethz.ch> from "Martin Maechler" at Oct 30, 97 11:29:47 am
Message-ID: <9710301452.AA04275@nokomis.stat.umn.edu>

Martin Maechler wrote:
> 
> Evaluate the following example to get the behavior :
> 
> 		--- anybody: patch ? ---
> 
> 
> tst.i <- function(x)
> {
>   if(missing(x))
>     return(invisible())
>   else if(!is.numeric(x)) stop("x must be numeric")
>   ## else
>   invisible((x+3)^2)
> }
> 
> tst.i()#-- should NOT print anything !!
> print(mode(tst.i()))#--gives "NULL"   both in S-plus 3.4 and R 0.60
> 
> tst.i(1)# nothing (ok in R and S-plus)
> 1 + tst.i(1) #> 17

I'm still running 0.49 and there the behavior is a bit different (if I
understand your description right):

tst.i <- function(x=0)
 {
   if(missing(x))
     return(invisible())
   else if(!is.numeric(x)) stop("x must be numeric")
   ## else
   invisible((x+3)^2)
}

gives
> tst.i()
>         # in current R this is NULL?

In any case, here are a few random remarks on this.  Both invisible
and return are somewhat peculiar entities in Splus at least.  In Splus
the official semantics of invisible are (from help)

       the function invisible reaches back 2 frames  and  sets  a
       special  flag, .Auto.print, to FALSE.  This has the effect
       of preventing automatic printing if the  function  calling
       invisible  was called from the top level since .Auto.print
       in frame 1 is set to FALSE.

which means that the argument is pretty much irrelevant;

	function() { invisible(); 1 }
and
	function() { invisible(1) }

are equivalent. I'm not sure what the official semantics of invisible
are in R; operationally these two act differently in 0.49.

Return in Splus is a keyword and doesn't have a function definition,
so it isn't quite clear how return(invisible()) should behave. In R
return seems to be just another function whose action happens to be to
execute a return from one frame back (or whatever). That means that I
would expect

	function(x) { return(invisible(x)) }
and
	function(x) { g(invisible(x)) }

with g<-function(x) { x } to produce identical results as far as
invisibility is concerned, and they do.

I think many users think that invisible() can be thought of as
attaching an invisibility property to its argument and that that
property ought to remain with the argument for a while at least
(probably an assignment should strip it?) -- this would lead to

	return(invisible())

acting as you suggest (and maybe it currently does if I misunderstood
what is happening). It would also mean that

	myprint<- function(...) { print(...) }

would act as you might expect; right now it does in R (and since I'm
not sure about the offical semantics I'm not sure if this should
suprprise me or not) but in Splus (in accord with the semantics given
above) it does not -- you get

>  myprint(1)
[1] 1
[1] 1
>

Officially adding such a property (if it sin't already there -- I'm
not sure on this) might make some things cleaner, but it's not clear
what other cans of worms this would open up.

Other languages take a different approach -- they allow a function
used for side effects to return no values, so there is nothing to
print -- this covers most though not all cases where invisible() is
used now.


-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 15:17:08 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 16:17:08 +0100
Subject: R-alpha: Minor plotting problems
In-Reply-To: Martin Maechler's message of Thu, 30 Oct 1997 11:54:52 +0100
Message-ID: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk>

1) There's a curious asymmetry between points and lines, in that you can
do
lines(...,type='p')
but not
points(...,type='l')
(and more importantly, not points(..., type='b'), which probably
*could* arise in real work)

This isn't deliberate, is it?

2) Did I remember to report the adverse effect of having plot(x,y)
coerce its argument to numeric? Several of my students managed to set
the data type to "character" in data.entry(), do a plot(bw,rmr) with
no apparent problem, and *then* become absolutely perplexed when
lm(rmr~bw) yields

Error in model.frame(formula, data, substitute(list(...)), subset,
na.action) : invalid variable type

3) The first few lines of hist() should be

        if (!is.numeric(x)) 
                stop("hist: x must be numeric")
        eval(main)
        eval(xlab)
        x <- x[!is.na(x)]
 
The two 'eval's are necessary to avoid strange side effects of
modifying x. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Thu Oct 30 15:27:51 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Oct 1997 16:27:51 +0100
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: Luke Tierney's message of Thu, 30 Oct 1997 08:52:54 -0600 (CST)
References: <9710301452.AA04275@nokomis.stat.umn.edu>
Message-ID: <x2hg9zuv7s.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> Other languages take a different approach -- they allow a function
> used for side effects to return no values, so there is nothing to
> print -- this covers most though not all cases where invisible() is
> used now.

If you think in terms of functionality as opposed to actually calling
invisible(), a rather notorious exception would be "<-". It's a
primitive, not a function, but it returns the evaluated right hand
side without printing it.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Thu Oct 30 16:18:44 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 30 Oct 1997 10:18:44 -0600 (CST)
Subject: R-alpha: buglet in  return(invisible())  [R 0.50 and 0.60]
In-Reply-To: <x2hg9zuv7s.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Oct 30, 97 04:27:51 pm
Message-ID: <9710301618.AA04456@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Luke Tierney <luke@stat.umn.edu> writes:
> 
> > Other languages take a different approach -- they allow a function
> > used for side effects to return no values, so there is nothing to
> > print -- this covers most though not all cases where invisible() is
> > used now.
> 
> If you think in terms of functionality as opposed to actually calling
> invisible(), a rather notorious exception would be "<-". It's a
> primitive, not a function, but it returns the evaluated right hand
> side without printing it.
> 

That's why I said "most" :-). Of course whether being able to write

	x<-y<-z

is a good thing or not ... :-)


-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Fri Oct 31 03:01:52 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Thu, 30 Oct 1997 21:01:52 -0600 (CST)
Subject: R-alpha: nlme in R
Message-ID: <m0xR7LM-000hruC@franz.stat.wisc.edu>

Tony Rossini sent me a copy of Jim's message to this list asking about 
nlme.  I was surprised to find that I had not subscribed to this
list.  I thought I did but apparently not.  I have now corrected that.

Development of the nlme library (the name is from "nonlinear
mixed-effects" but the library can also be used to fit general forms
of linear mixed-effects models) is a continuing research project for
Jose' Pinheiro and me.  Earlier this week Jose' spoke at the S-Users'
Conference about the design and development of the nlme 3.0 library.
The most visible change for nlme 3.0 is that it now can incorporate
nested random-effects terms.  In other words, it fits multilevel
models.  I'll check with Jose' on making the transparencies from that
talk available over the internet if people want to get more details.

Jim's question was "can it be ported to R?".  It is a lot of code.
Some of it would be easy to port.  Some of it would be extremely hard
to port.  "Extremely hard" means it would be easier to re-design and
re-write those parts from scratch.

The easy part is the linear mixed-effects code.  There is code in both 
S and in C but the C code is pretty straightforward.  The S code sets
up the model, formulates starting estimates for the parameters that
determine the variance-covariance matrices of the random effects,
calls some C code to do several EM iterations to refine the parameter
estimates then sets up the maximum likelihood estimation or REML
estimates as an ms() optimization.  I myself haven't tried to do this
in R but I think it is feasible to substitute nlm() for ms() at this
point.

There are a host of classes and methods that are defined to help with
this process and with examining the original data and the fitted
models.  *All* of these classes define their plot methods and other
graphical methods through trellis functions.  That means that either
the relevant trellis functions would have to be cloned or all the
graphical routines would have to be replaced or one would have to do
without graphics.  Some indication of the power of trellis for these
models is in the slides of Jose's presentation which should be
available soon at
     http://cm.bell-labs.com/cm/ms/departments/sia/project/nlme/

The nonlinear mixed-effects code will also be a problem.  It
alternates between two optimizations - one using ms() on a linear
mixed-effects problem and one using a special optimization routine for
a penalized nonlinear least squares problem.  The code for the second
one is intimately tied in with the S evaluation process and the frames
in S.  It would be necessary to re-write it from scratch.  Probably it
would be best to re-design it entirely.

More details available upon request.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 31 11:11:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 31 Oct 1997 12:11:23 +0100
Subject: R-alpha: Minor plotting problems //  \itemize{..} in *.Rd
In-Reply-To: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 30 Oct 1997 16:17:08 +0100)
Message-ID: <199710311111.MAA02054@sophie.ethz.ch>

>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

    Peter> 1) There's a curious asymmetry between points and lines, in that
    Peter> you can do lines(...,type='p') but not points(...,type='l') (and
    Peter> more importantly, not points(..., type='b'), which probably
    Peter> *could* arise in real work)

    Peter> This isn't deliberate, is it?

I've always thought is *WAS* deliberate...
At least it made sense to me at the time when I thought about it.

Anyway, we shouldn't be ``bossy'' on users, therefore,
I am about to change it (and its documentation)...

------------------------------

BTW, Fritz,  do we have [or will we soon ? ;-) ]

	\enumerate{
	 \item first
	 \item second
	  ....
	}

	and the same for \itemize{ ... } ....
	
  [ However, LaTeX's  ``description'' is already taken in our Rd format..... ]

-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Oct 31 18:36:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 31 Oct 1997 19:36:48 +0100
Subject: R-alpha: Minor plotting problems  [improved hist()]
In-Reply-To: <x2iuufuvpn.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 30 Oct 1997 16:17:08 +0100)
Message-ID: <199710311836.TAA02661@sophie.ethz.ch>

>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

    Peter> 1) There's a curious asymmetry between points and lines, in that
    Peter> you can do lines(...,type='p') but not points(...,type='l') (and
    Peter> more importantly, not points(..., type='b'), which probably
    Peter> *could* arise in real work)

Now fixed in current source.

    Peter> 2) Did I remember to report the adverse effect of having
    Peter> plot(x,y) coerce its argument to numeric? Several of my students
    Peter> managed to set the data type to "character" in data.entry(), do
    Peter> a plot(bw,rmr) with no apparent problem, and *then* become
    Peter> absolutely perplexed when lm(rmr~bw) yields

    Peter> Error in model.frame(formula, data, substitute(list(...)),
    Peter> subset, na.action) : invalid variable type

I agree that plot  shouldn't coerce character x / y to numeric.
Nothing yet done.
	[Peter,  you can do the changes if you like ..]


    Peter> 3) The first few lines of hist() should be

    Peter>         if (!is.numeric(x)) stop("hist: x must be numeric")
    Peter> eval(main) eval(xlab) x <- x[!is.na(x)]
 
    Peter> The two 'eval's are necessary to avoid strange side effects of
    Peter> modifying x.

Ok, I've done quite a bit more. 

hist is ``better'' now
	 [[the ``nclass'' discussion is not yet done ... !]]:  

	1) allows  `plot = FALSE'  [as S; but really IS useful]
	2) Default for 'freq:  TRUE only if breaks are equispaced
			(otherwise the plot is graphically *WRONG*)

The following is now in 0.60 :

"hist" <-
function (x, breaks, freq = NULL, col = NULL, border = par("fg"),
	main = paste("Histogram of" , deparse(substitute(x))),
	xlim = range(breaks), ylim = range(counts, 0),
	xlab = deparse(substitute(x)), ylab,
	axes=TRUE, plot = TRUE, ...)
{
	if (!is.numeric(x)) 
		stop("hist: x must be numeric")
	eval(main)
	eval(xlab)
	n <- length(x <- x[!is.na(x)])
	use.br <- !missing(breaks) && length(breaks) > 1
	breaks <-
	  if(use.br) sort(breaks)
	  else {
		rx <- range(x)
		pretty (rx + c(0, diff(rx)/1000), 
			n = if(missing(breaks)) 1 + log2(n)
			else { # breaks = `nclass'	
				if (is.na(breaks) | breaks < 2) 
				  stop("invalid number of breaks")
				breaks
			})
	  }
	nB <- length(breaks)
	counts <- .C("bincount", 
		as.double(x), 
		n, 
		as.double(breaks), 
		nB,
		counts = integer(nB - 1), 
		NAOK = FALSE) $counts
	if (any(counts < 0)) 
	 stop("negative `counts'. Internal Error in C-code for \"bincount\"")
	if (is.null(freq)) 
	  freq <- if(use.br) {
		##-- Do frequencies if breaks are evenly spaced ...
		h <- diff(breaks)
		diff(range(h)) < 1e-10 * h
	  } else TRUE
	if (!freq) {
		counts <- counts/(sum(x) * diff(breaks))
		if (missing(ylab)) 
			ylab <- "Relative Frequency"
	}
	else if (missing(ylab)) 
		ylab <- "Frequency"
	if(plot) {
		plot.new()
		plot.window(xlim, ylim, "")
		title(main = main, xlab = xlab, ylab = ylab, ...)
		if(axes) {
			axis(1, ...)
			axis(2, ...)
		}
		rect(breaks[-length(breaks)], 0, breaks[-1], counts,
		     col = col, border = border)
		invisible(NULL)
	} else list(breaks = breaks, counts = counts)
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

