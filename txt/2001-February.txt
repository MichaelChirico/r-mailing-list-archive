From tov@ece.cmu.edu  Thu Feb  1 01:13:12 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Thu, 1 Feb 2001 02:13:12 +0100 (MET)
Subject: [Rd] screen can't go back to log="y" plot (PR#831)
Message-ID: <200102010113.CAA25183@pubhealth.ku.dk>


Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> [I have abbreviated the subject as jitterbug has been having probems
> with long subjects.]
> 
> The issue here is that one cannot mix log/non-log axes in the calls to
> screen(), as the appropriate par() parameter is read-only, but the
> meaning of yaxp depends on it.  But beyond that you can't set
> x/yaxp for log axes.
> 
> You should be able to do this: you can in the S original.
> 
> A simpler version:
> 
> plot (1:2, 1:2, log="y", main="1")
> zz <- par("yaxp")
> zz
> [1]  1  2 -5
> par(yaxp=zz)
> Error in par(yaxp = zz) : invalid value specified for graphics parameter
> "yaxp".
> 
> So you can't reset the yaxp parameter to what it is reported as!
[snip]

The code in main/par.c ignores the value of xlog (or ylog) when
setting xaxp (or yaxp).  Right now you have in Specify (and Specify2):

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        posIntCheck((int) (REAL(value)[2]), what);

Shouldn't that be something like:

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        if (dd->gp.xlog)
            logAxpCheck((int) (REAL(value)[2]), what);
        else
            posIntCheck((int) (REAL(value)[2]), what);

Where logAxpCheck is suitably defined as:

static void logAxpCheck(int x, char *s)
{
    if (x == NA_INTEGER || x == 0 || x > 4)
	par_error(s);
}

since only values < 0 or the values 1, 2, 3 are allowed?


> Additional bug: the meaning of x/yaxp for log axes is not defined
> in help(par).

excerpt from help(par):

    xaxp: A vector of the form `c(x1, x2, n)' giving the coordinates
          of the extreme tick marks and the number of intervals
          between tick-marks.

Could you add:

          The value of n must be positive for linear scale axes.  For
          logarithmic scale axes n must be either negative (then there
          will be (1-n) ticks at a linear distance) or one of 1, 2, or
          3 where n then indicates the number of ticks per decade.

similar for yaxp?  What am I missing?
Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Thu Feb  1 09:07:10 2001
From: adrian@olsen.ch (adrian@olsen.ch)
Date: Thu, 1 Feb 2001 10:07:10 +0100 (MET)
Subject: [Rd] inconsistent behaviour between class() and inherits() (PR#834)
Message-ID: <200102010907.KAA29138@pubhealth.ku.dk>

Example:

> x<-ts(rnorm(10))
> y<-ts(rnorm(10))
> r<-residuals(lm(y~x))
> is.ts(r)
[1] FALSE
> inherits(r,"ts")
[1] FALSE
> class(r)
[1] "ts"
> is.ts(x)
[1] TRUE
> inherits(x,"ts")
[1] TRUE
> class(x)
[1] "ts"


--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.5.1
 arch = sparc
 os = solaris2.5.1
 system = sparc, solaris2.5.1
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:olsen, package:ffnet, package:tseries, package:ts, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From james.lindsey@luc.ac.be  Thu Feb  1 09:56:07 2001
From: james.lindsey@luc.ac.be (james.lindsey@luc.ac.be)
Date: Thu, 1 Feb 2001 10:56:07 +0100 (MET)
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <200102010956.KAA29982@pubhealth.ku.dk>

The following seems to be a contradiction:

> df <- data.frame(x=gl(2,1,10))
> df[,1]
 [1] 1 2 1 2 1 2 1 2 1 2
Levels:  1 2 
> df[,1,drop=F]
   x
1  1
2  2
3  1
4  2
5  1
6  2
7  1
8  2
9  1
10 2
> is.factor(df[,1,drop=F])
[1] FALSE
> is.factor(df[,1])
[1] TRUE

with R1.2.1 both MS Windows and Intel RH5.2 versions.
 Jim

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb  1 10:15:26 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 1 Feb 2001 11:15:26 +0100 (MET)
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <200102011015.LAA00372@pubhealth.ku.dk>

> From: james.lindsey@luc.ac.be
> Date: Thu, 1 Feb 2001 10:56:07 +0100 (MET)
> 
> The following seems to be a contradiction:

What is, pray?

> class(df[, 1])
[1] "factor"
> class(df[, 1, drop = FALSE])
[1] "data.frame"

df[ , 1, drop=FALSE] is a data frame, so not a factor.
df[ , 1] is a factor.

> > df <- data.frame(x=gl(2,1,10))
> > df[,1]
>  [1] 1 2 1 2 1 2 1 2 1 2
> Levels:  1 2 
> > df[,1,drop=F]
>    x
> 1  1
> 2  2
> 3  1
> 4  2
> 5  1
> 6  2
> 7  1
> 8  2
> 9  1
> 10 2
> > is.factor(df[,1,drop=F])
> [1] FALSE
> > is.factor(df[,1])
> [1] TRUE
> 
> with R1.2.1 both MS Windows and Intel RH5.2 versions.
>  Jim

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From duncan@research.bell-labs.com  Thu Feb  1 12:45:15 2001
From: duncan@research.bell-labs.com (Duncan Temple Lang)
Date: Thu, 1 Feb 2001 07:45:15 -0500 (EST)
Subject: [Rd] Is Omegahat in R a general language function bus ?
Message-ID: <200102011245.HAA04008@jessie.research.bell-labs.com>


> Date: Tue, 30 Jan 2001 14:51:49 +0000
> From: David K Walker <dkwalker@online.no>
> Sender: owner-r-devel@stat.math.ethz.ch
> Precedence: bulk
> 
> Hi !
> 
> Can we e.g. embed Perl in R and embed R in Java, start the program counter
> in Java, call from Java to Perl via R, and then either (1) call back from
> Perl to Java via R or (2) just plain return from Perl to Java via R ?

Conceptually, Omegahat can act in this way as a broker or bus
connecting two other languages within R. However, in practice, I think
one would be less inclined to use this approach than finding a more
direct communication mechanism, in this case between Perl and Java.
And indeed there is such a mechanism -- JPL -- and it is more than
likeley available in your Perl installation (perhaps not compiled).
Code in these two languages could communicate with each other using
this mechanism and both could be running within R and communicating
with S code via the .Perl, .Java and callback mechanisms.

Using Omegahat as the broker would involve an extra layer of
conversion. Even if this were not an issue for performance in a
particular project, it certainly is a more complex setup to debug.  If
there were not already a tool for this pair of languages (Perl and
Java), it might indeed make sense to use Omegahat as a "quickly"
deployed prototype. 



> My reason for asking this is general interest in extensible programming
> languages.  My background is heavy in Forth, moderate in assembly language,
> so far very light in Scheme, R, Java, Perl, XML, Python.  Later I hope to
> implement new statistical software and port an existing large scale time
> series database/editor/tablewriter as packages under Debian
> Gnu/Linux.

And it is very much our goal in developing the collection of Omegahat
inter-system interface packages to facilitate this type of development
with the minimal amount of re-development. So it would be good to find
out what is needed and see how these interfaces can be adapted to such
needs.  Perhaps it would be good to discuss these on the omegahat
development list (omega-devel@omegahat.org) or directly with me.

> 
> David Walker
> 

 All the best,
  Duncan

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lhecking@nmrc.ie  Thu Feb  1 18:41:19 2001
From: lhecking@nmrc.ie (lhecking@nmrc.ie)
Date: Thu, 1 Feb 2001 19:41:19 +0100 (MET)
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
Message-ID: <200102011841.TAA08532@pubhealth.ku.dk>


 Unless I force the Fortran compiler through --with-g77, configure fails to
 find and use the installed g77. I would submit a patch for configure.in,
 but I can't quite follow the logic in configure.in.

$ ./configure 
creating cache ./config.cache
[...]
checking for main in -lm... yes
checking for g77... /usr/local/gnu/bin/g77
checking for fort77... (cached) /usr/local/gnu/bin/g77
checking for f77... (cached) /usr/local/gnu/bin/g77
checking for f90... (cached) /usr/local/gnu/bin/g77
checking for xlf... (cached) /usr/local/gnu/bin/g77
checking for cf77... (cached) /usr/local/gnu/bin/g77
checking for fc... (cached) /usr/local/gnu/bin/g77
checking for f2c... no
configure: error: Neither an F77 compiler nor f2c found
$ 


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Thu Feb  1 19:20:41 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Thu, 1 Feb 2001 20:20:41 +0100 (MET)
Subject: [Rd] screen doesn't handle redrawing properly (PR#837)
Message-ID: <200102011920.UAA08731@pubhealth.ku.dk>


Hi.  As far as I understand it, there is a list of graphic primitives
stored for a device.  So for example, when I iconify/deiconify an X11
window, the plot will be redrawn.  Now screen (split.screen and
friends) appear not to handle this list properly, the list is reset or
not reset at odd times.  The commands below will show clearly what I
mean.  There are two effects:

  - After splitting the device real estate into two screens, I can
    plot on these screens, alternating between them.  When I then
    touch the window to force a redraw, *all* the plots are redrawn,
    not just the last (and visible) ones.
    [This happens when the X server runs on AIX, R runs on AIX or Sun.]

  - Again, after splitting, plotting on one screen can affect the
    other screen.  I.e. plot(...); plot (...) on the left screen can
    erase the *right* screen.
    [This happens for all platforms I have access to, AIX, Linux, Sun.]

The first effect may be due to a bad interaction with the X server,
but the second effect is surely not desirable, is it?  Am I mis-using
'screen' here?

R> split.screen (c(1,2))
[1] 1 2
R> # Draw 10000 points to make the effect obvious
R> screen (1)
R> plot (1:10000, 1:10000, main="1")
R> screen (2)
R> plot (1:10000, 1:10000, main="2")
R> # Ok, go back to screen 1, draw plots 3 and 4
R> screen (1)
R> plot (1:10000, 10000:1, main="3")
R> screen (2)
R> plot (1:10000, 10000:1, main="4")
R> 
R> ########################################
R> # NOW lower/raise window, do something to force device to redraw itself.
R> # You'll see again plot 1 (!), 2 (!), 3, and 4.  Why 1 and 2?
R> ########################################
R> 
R> # Here's how to erase screen 2 from screen 1 (!)
R> screen (1)
R> plot (1:10, 1:10, main="3a")
R> ########################################
R> # The following plot will erase screen 2
R> ########################################
R> plot (1:10, 1:10, main="3b")
R> 
R> # The good news is that this resets the list of graphic ops:
R> screen (2)
R> plot (1:10, 1:10, main="4")
R> # Now if you touch the window, you'll see only plot 3b and 4.

Regards,
  -tom

R> R.version
         _                   
platform sparc-sun-solaris2.7
arch     sparc               
os       solaris2.7          
system   sparc, solaris2.7   
status   Patched             
major    1                   
minor    2.1                 
year     2001                
month    01                  
day      31                  
language R                   

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@CMIS.CSIRO.AU  Fri Feb  2 07:30:09 2001
From: Bill.Venables@CMIS.CSIRO.AU (Bill.Venables@CMIS.CSIRO.AU)
Date: Fri, 2 Feb 2001 17:30:09 +1000
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <2B7F04539DAFD311B61D009027D0DDA20C3C85@roper-cv.qld.cmis.CSIRO.AU>



| -----Original Message-----
| From: james.lindsey@luc.ac.be [mailto:james.lindsey@luc.ac.be]
| Sent: Thursday, 1 February 2001 19:56
| To: r-devel@stat.math.ethz.ch
| Cc: R-bugs@biostat.ku.dk
| Subject: [Rd] factors in data.frames (PR#835)
| 
| 
| The following seems to be a contradiction:
| 
| > df <- data.frame(x=gl(2,1,10))
| > df[,1]
|  [1] 1 2 1 2 1 2 1 2 1 2
| Levels:  1 2 
| > df[,1,drop=F]
|    x
| 1  1
| 2  2
| 3  1
| 4  2
| 5  1
| 6  2
| 7  1
| 8  2
| 9  1
| 10 2
| > is.factor(df[,1,drop=F])
| [1] FALSE
| > is.factor(df[,1])
| [1] TRUE
| 
| with R1.2.1 both MS Windows and Intel RH5.2 versions.
|  Jim

Eh?  df[,1,drop = F] is a data frame with one component and hence NOT a
factor 
 but df[,1] is one (factor) component of a fata frame and hence IS a factor.

I think it is entirely consistent with the advertised behaviour.

Bill.

| 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Feb  2 20:26:25 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 2 Feb 2001 21:26:25 +0100
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
In-Reply-To: <200102011841.TAA08532@pubhealth.ku.dk>
References: <200102011841.TAA08532@pubhealth.ku.dk>
Message-ID: <14971.6129.767816.279330@mithrandir.hornik.net>

>>>>> lhecking  writes:

>  Unless I force the Fortran compiler through --with-g77, configure fails to
>  find and use the installed g77. I would submit a patch for configure.in,
>  but I can't quite follow the logic in configure.in.

> $ ./configure 
> creating cache ./config.cache
> [...]
> checking for main in -lm... yes
> checking for g77... /usr/local/gnu/bin/g77
> checking for fort77... (cached) /usr/local/gnu/bin/g77
> checking for f77... (cached) /usr/local/gnu/bin/g77
> checking for f90... (cached) /usr/local/gnu/bin/g77
> checking for xlf... (cached) /usr/local/gnu/bin/g77
> checking for cf77... (cached) /usr/local/gnu/bin/g77
> checking for fc... (cached) /usr/local/gnu/bin/g77
> checking for f2c... no
> configure: error: Neither an F77 compiler nor f2c found
> $ 

It might have been helpful to use bug.report() ...

Which platform is this?
Apparently /usr/local/gnu/bin/g77 is the GNU C compiler?
What happens if you do

F77=/usr/local/gnu/bin/g77
file ${F77} | grep script

???

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lhecking@nmrc.ie  Sat Feb  3 16:11:13 2001
From: lhecking@nmrc.ie (Lars Hecking)
Date: Sat, 3 Feb 2001 16:11:13 +0000
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
In-Reply-To: <14971.6129.767816.279330@mithrandir.hornik.net>; from Kurt.Hornik@ci.tuwien.ac.at on Fri, Feb 02, 2001 at 09:26:25PM +0100
References: <200102011841.TAA08532@pubhealth.ku.dk> <14971.6129.767816.279330@mithrandir.hornik.net>
Message-ID: <20010203161113.B3001@nmrc.ie>


> It might have been helpful to use bug.report() ...
 
 I'm not a user of R, I just install the stuff :)

> Which platform is this?

 Solaris 7 SPARC.

> Apparently /usr/local/gnu/bin/g77 is the GNU C compiler?
> What happens if you do
> 
> F77=/usr/local/gnu/bin/g77
> file ${F77} | grep script

$ file /usr/local/gnu/bin/g77
/usr/local/gnu/bin/g77: executable shell script
$ 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Sat Feb  3 19:27:47 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 03 Feb 2001 14:27:47 -0500
Subject: [Rd] tk non-widget commands (esp. update and winfo)
Message-ID: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>


Hi,

I've been playing with the tcltk package.  It's very nice to have
access to buttons, menus etc. now.  Thank you!

Alas, I also have questions: In Tcl everything is a string [*].  This
is not the case in R, of course.  So why are return values of tk
commands still strings?  (Is there any other reason than speed or
"package is work in progress"?)

Example:

   > tt <- tktoplevel ()
   > tkwinfo ("width", tt)
  [1] "200"

Could (Should?) be:

   > tt <- tktoplevel ()
   > tkwinfo ("width", tt)
  [1] 200

with 
   > tkwidth <- function (widget) as.numeric (tkcmd ("winfo", "width", widget))

Maybe a better example is the use of logical results:

  > if (tkwinfo ("exists", tt)) cat ("exists\n")
  Error in if (tkwinfo("exists", tt)) cat("exists\n") : 
          argument of if(*) is not interpretable as logical

Huh? Here you might have expected:

  > if (tkexists (tt)) cat ("exists\n")
  exists

with
  > tkexists <- function (widget) (tkcmd ("winfo", "exists", widget) == "1")

One problem is that the number of functions just explodes, so it might
be better to wrap them into one enchillada?

  >  tkwinfo <- function (widget, what="exists", ...) 
     switch (what,
             exists=tkcmd("winfo", "exists", widget)=="1",
             ismapped=tkcmd("winfo", "ismapped", widget)=="1",
             width=as.numeric (tkcmd("winfo", "width", widget)),
             height=as.numeric (tkcmd("winfo", "height", widget)),
             tkcmd ("winfo", what, widget, ...))

(The other problem is that tkcmd("winfo",...) may fail.)

Oh, while I'm at it:  There is no tkupdate:
  >  tkupdate <- function (idletasks=FALSE)
     if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")

(which is essential to making sure that a window is mapped before its
width or height is queried.)  That's trivial if you have hacked Tcl/Tk
before -- so who is the package tlctk aimed at?

Regards,
  -tom


[*] Nowadays, they have glorified strings into objects.  Anywho...

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Feb  3 20:05:06 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 03 Feb 2001 21:05:06 +0100
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Thomas Vogels's message of "03 Feb 2001 14:27:47 -0500"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>
Message-ID: <x2n1c3353h.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@ece.cmu.edu> writes:

> Hi,
> 
> I've been playing with the tcltk package.  It's very nice to have
> access to buttons, menus etc. now.  Thank you!
> 
> Alas, I also have questions: In Tcl everything is a string [*].  This
> is not the case in R, of course.  So why are return values of tk
> commands still strings?  (Is there any other reason than speed or
> "package is work in progress"?)

The latter. Also to some extent the fact that it requires more
knowledge about the content of the return value. The argument passing
scheme is as you can see quite general and essentially ignorant of the
routines that are called. In essence the issue is that it is fairly
easy to convert whatever to strings, but harder the other way around.
So for the first iteration of the package, the idea would be to have
the user do the necessary as.xxx conversions of return values.

> One problem is that the number of functions just explodes, so it might
> be better to wrap them into one enchillada?
> 
>   >  tkwinfo <- function (widget, what="exists", ...) 
>      switch (what,
>              exists=tkcmd("winfo", "exists", widget)=="1",
>              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
>              width=as.numeric (tkcmd("winfo", "width", widget)),
>              height=as.numeric (tkcmd("winfo", "height", widget)),
>              tkcmd ("winfo", what, widget, ...))
> 
> (The other problem is that tkcmd("winfo",...) may fail.)
> 
> Oh, while I'm at it:  There is no tkupdate:
>   >  tkupdate <- function (idletasks=FALSE)
>      if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")
> 
> (which is essential to making sure that a window is mapped before its
> width or height is queried.)  That's trivial if you have hacked Tcl/Tk
> before -- so who is the package tlctk aimed at?

Tcl/Tk hackers of course, the author of the package not being one...

Basically, the plan is to add stuff as it becomes necessary to do
useful things, so feedback and suggestions from developers are always
welcome.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Feb  4 14:38:05 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 04 Feb 2001 15:38:05 +0100
Subject: [Rd] help with build on windows needed.
Message-ID: <3A7D694D.EA43CA59@univie.ac.at>

i installed r for window 1.2.1
and suddenly
rcmd build 
does not work any more.

C:\work\checked.out>rcmd build
Please set TMPDIR to a valid temporary directory

C:\work\checked.out>echo %TMPDIR%
C:\Documents and Settings\Erich Neuwirth\Local Settings\Temp

and this is a valid directory.

things worked smoothly in 1.2.0

what can i do?



--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb  4 15:48:33 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 4 Feb 2001 15:48:33 +0000 (GMT)
Subject: [Rd] help with build on windows needed.
In-Reply-To: <3A7D694D.EA43CA59@univie.ac.at>
Message-ID: <Pine.GSO.4.31.0102041542460.21221-100000@toucan.stats>

On Sun, 4 Feb 2001, Erich Neuwirth wrote:

> i installed r for window 1.2.1
> and suddenly
> rcmd build
> does not work any more.
>
> C:\work\checked.out>rcmd build
> Please set TMPDIR to a valid temporary directory
>
> C:\work\checked.out>echo %TMPDIR%
> C:\Documents and Settings\Erich Neuwirth\Local Settings\Temp
>
> and this is a valid directory.
>
> things worked smoothly in 1.2.0
>
> what can i do?

Win2k, right?  It's a Windows Perl bug, already discussed a couple
of times here or R-help.  In rw1021/bin/build replace

        unless (-d $TMPDIR);
by

        unless (-e $tmpdir);

Basically, -d is not working properly on any Windows platform, but it
is incorrectly mostly returning false on Win2K, and always true on NT4.

It's possible that you need
        unless (-e '$tmpdir');

if so, please let me know.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Feb  4 18:00:34 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 04 Feb 2001 19:00:34 +0100
Subject: [Rd] Rcsound
Message-ID: <3A7D98C2.A6D18B98@univie.ac.at>

there is a new version of my "R sings" package
no functional changes, but more stable and reliable on windows.
feedback about unix needed!

http://sunsite.univie.ac.at/~neuwirth/Rcsound/


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From daniel.egloff@dplanet.ch  Sun Feb  4 21:37:36 2001
From: daniel.egloff@dplanet.ch (daniel.egloff@dplanet.ch)
Date: Sun, 4 Feb 2001 22:37:36 +0100 (MET)
Subject: [Rd] Linux shared library problem (PR#838)
Message-ID: <200102042137.WAA28592@pubhealth.ku.dk>

Full_Name: Daniel Egloff
Version: 1.2.1
OS: Linux Redhat 7.0
Submission from: (NULL) (212.35.34.200)


Externals in the shared library libc.so.6 not found. See the 
following R session, with the abort message at the end.

> demo(graphics)
 
 
        demo(graphics)
        ---- ~~~~~~~~
 
Type  <Return>   to start :
 
> opar <- par(ask = interactive() && (.Device %in% c("X11",
    "GTK", "windows", "Macintosh")))
 
> x <- rnorm(50)
 
> opar <- c(opar, par(bg = "white"))
 
> plot(x, ann = FALSE, type = "n")
Hit <Return> to see next plot:
 
> abline(h = 0, col = gray(0.9))
 
> lines(x, col = "green4", lty = "dotted")
 
> points(x, bg = "limegreen", pch = 21)
 
> title(main = "Simple Use of Color In a Plot", xlab = "Just a Whisper of a
Label",
    col.main = "blue", col.lab = gray(0.8), cex.main = 1.2, cex.lab = 1,
    font.main = 4, font.lab = 3)
 
> par(bg = "gray")
 
> piechart(rep(1, 24), col = rainbow(24), radius = 0.9)
Hit <Return> to see next plot:
 
> title(main = "A Sample Color Wheel", cex.main = 1.4,
    font.main = 3)
 
> title(xlab = "(Use this as a test of monitor linearity)",
    cex.lab = 0.8, font.lab = 3)
 
> pie.sales <- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
 
> names(pie.sales) <- c("Blueberry", "Cherry", "Apple",
    "Boston Cream", "Other", "Vanilla Cream")
 
> piechart(pie.sales, col = c("purple", "violetred1",
    "green3", "cornsilk", "cyan", "white"))
Hit <Return> to see next plot:
/usr/lib/R/bin/R.bin: error while loading shared libraries:
/usr/lib/R/bin/R.bin: symbol __sysconf, version GLIBC_2.2 not defined in file
libc.so.6 with link time reference
[dani@PLUTO amopt_sim]$             

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb  4 22:32:41 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 Feb 2001 23:32:41 +0100
Subject: [Rd] Linux shared library problem (PR#838)
In-Reply-To: daniel.egloff@dplanet.ch's message of "Sun, 4 Feb 2001 22:37:36 +0100 (MET)"
References: <200102042137.WAA28592@pubhealth.ku.dk>
Message-ID: <x2d7cyf59y.fsf@blueberry.kubism.ku.dk>

daniel.egloff@dplanet.ch writes:

> Full_Name: Daniel Egloff
> Version: 1.2.1
> OS: Linux Redhat 7.0
> Submission from: (NULL) (212.35.34.200)
> 
> 
> Externals in the shared library libc.so.6 not found. See the 
> following R session, with the abort message at the end.
> 
....
> > piechart(pie.sales, col = c("purple", "violetred1",
>     "green3", "cornsilk", "cyan", "white"))
> Hit <Return> to see next plot:
> /usr/lib/R/bin/R.bin: error while loading shared libraries:
> /usr/lib/R/bin/R.bin: symbol __sysconf, version GLIBC_2.2 not defined in file
> libc.so.6 with link time reference
> [dani@PLUTO amopt_sim]$             

if (you.compiled.it) {
    have.you(updated.gcc)   # need 2.96-69 or better
    have.you(updated.glibc) # at -12 now. I think the orig caused trouble 
} else {
    have.you(correct.rpm)   # need the one for 7.0
    have.you(updated.glibc) # at -12 now. I think the orig caused trouble 
}
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jason@cs.rochester.edu  Mon Feb  5 01:17:21 2001
From: jason@cs.rochester.edu (jason@cs.rochester.edu)
Date: Mon, 5 Feb 2001 02:17:21 +0100 (MET)
Subject: [Rd] clipped lines have wrong slope in log plot (PR#839)
Message-ID: <200102050117.CAA29241@pubhealth.ku.dk>

Hi,

I'm using R version 1.2.0 (2000-12-15), on RedHat Linux 6.2 (kernel 2.2.14).

The following command ought to plot a straight-line on a log-log
graph but instead plots two line segments, both with the wrong
slope:

  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,20),ylim=c(1,20),log="xy")

Only clipped lines seem to have this problem.  Changing to type "b"
or enlarging the ranges fixes it:

  plot(c(1,10,100),c(100,10,1),type="b",xlim=c(1,20),ylim=c(1,20),log="xy")
  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,100),ylim=c(1,100),log="xy")

abline has the same problem.  Try following the above calls with abline(2,-1).
(This is supposed to plot a straight line in the log-log domain, and
does, but it's the wrong straight line.)

I can also get the problem where only one axis is logarithmic.  
Let's untransform the x-axis from the original command:
 
  plot(log(c(1,10,100)),c(100,10,1),type="l",xlim=log(c(1,20)),ylim=c(1,20),log="y")

Thanks! - Jason Eisner






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Feb  5 10:50:38 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 5 Feb 2001 10:50:38 +0000 (GMT)
Subject: [Rd] Change of licence for header files and import libraries
Message-ID: <200102051050.KAA22990@toucan.stats.ox.ac.uk>

The copyrights on the distributed header files and export files R.exp
have been changed to the more permissive LGPL.

It came to our attention that some projects are interpreting GPL to
mean that compiling against the header files or linking against a
Windows import library brings the compiled code under the scope of
GPL.  This would mean it would be impossible to distribute binary
versions of non-GPL packages with compiled code which called entry
points in the R executable or DLL, of which there are many on CRAN.

We encourage packages to be distributed under Open Source conditions,
but accept that this is not possible for some contributions.  Our
intention is that export files and import libraries be `accessors'
under clause 5 of the LGPL, so that in most cases no (additional)
restrictions are imposed by compiling a package using the LGPL-ed
components of R.

To avoid any anomalies, the versions of the same files in R versions
1.0.0 to 1.2.1 may also be used under LGPL or GPL.

For the R core team,

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paradis@isem.univ-montp2.fr  Mon Feb  5 11:12:29 2001
From: paradis@isem.univ-montp2.fr (Emmanuel Paradis)
Date: Mon, 05 Feb 2001 12:12:29 +0100
Subject: [Rd] clipped lines have wrong slope in log plot (PR#839)
Message-ID: <3.0.32.20010205121229.008ec380@162.38.183.200>

At 02:17 05/02/01 +0100, you wrote:
>Hi,
>
>I'm using R version 1.2.0 (2000-12-15), on RedHat Linux 6.2 (kernel 2.2.14).
>
>The following command ought to plot a straight-line on a log-log
>graph but instead plots two line segments, both with the wrong
>slope:
>
>  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,20),ylim=c(1,20),log="xy")
>
>Only clipped lines seem to have this problem.  Changing to type "b"
>or enlarging the ranges fixes it:
>
>  plot(c(1,10,100),c(100,10,1),type="b",xlim=c(1,20),ylim=c(1,20),log="xy")
>  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,100),ylim=c(1,100),log="xy")
>
>abline has the same problem.  Try following the above calls with
abline(2,-1).
>(This is supposed to plot a straight line in the log-log domain, and
>does, but it's the wrong straight line.)
>
>I can also get the problem where only one axis is logarithmic.  
>Let's untransform the x-axis from the original command:
> 
>
plot(log(c(1,10,100)),c(100,10,1),type="l",xlim=log(c(1,20)),ylim=c(1,20),lo
g="y")
>
>Thanks! - Jason Eisner

I had a similar result with R-1.2.1 on WinNT 4.0.

plot(c(1,10,100), c(100,10,1), type="l", log="xy")  ### this looks OK
plot(c(1,10,100), c(100,10,1), type="l", xlim=c(1,20), ylim=c(1,20), log="xy")

I'd expect setting xlim= and ylim= would 'zoom in' on the first plot, but
it doesn't. It seems that, in this second case, that the coordinates of the
points outside the plotting region are not computed on the log-scale but on
the normal arithmetic scale.


Emmanuel Paradis
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 10:25:39 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 11:25:39 +0100
Subject: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <Pine.GSO.4.31.0102051834530.282-100000@auk.stats>
References: <Pine.GSO.4.31.0102051834530.282-100000@auk.stats>
Message-ID: <01020611253900.00712@Centaurea>

Prof. Ripley wrote on r-help:

> Completely distinct row vectors?  Take a look at the code of
> merge.data.frame.  Something like
>
>     bx <- matrix(as.character(a), nrow(a))
>     bx <- drop(apply(bx, 1, function(x) paste(x, collapse = "\r")))
>     length(unique(bx))
>
> This turns each row into a single character string, and counts the unique
> ones.

Hmmm... couldn't one build on this in order to generalize the 
unique() function?

I'm asking because when I once tried to use unique() on a matrix (to collapse 
duplicate rows), I found that it and duplicated() work only on vectors. I 
think a generalization, at least for matrices and simple data.frames, would 
be useful.

I tried my hand at it and came up with this:

----------------------------------------------------

"unique.default" <- get("unique", pos="package:base")    # old version becomes
                                                         # default behaviour
"unique" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(unique.matrix(object, ...))
   else
       UseMethod("unique")      # doesn't seem to work for matrices, hence 
}                               # the condition
                         


"duplicated.default" <- get("duplicated", pos="package:base")	

"duplicated" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(duplicated.matrix(object, ...))
   else
       UseMethod("duplicated")  
}


"duplicated.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
  return(duplicated(strvect))
}


"unique.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  dup <- duplicated(mat, MARGIN)
  return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
}


"duplicated.data.frame" <-
  function(df, MARGIN=1)
{
  strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse 
= "\r")))
  duplicated(strvect)
}


"unique.data.frame" <-
  function(df, MARGIN=1)
{
  dup <- duplicated(df, MARGIN)
  return(if (MARGIN==1) df[!dup,] else df[,!dup])
}

----------------------------------------------------

I couldn't figure out how to generalize to more than two dimensions (more 
accurately, how to subset in the dimension given by the variable MARGIN). 

Does anybody else consider this useful?


Cheers

Kaspar Pflugshaupt
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 12:34:01 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 13:34:01 +0100
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <01C09039.6E17C100.jens.oehlschlaegel@bbdo-interone.de>
References: <01C09039.6E17C100.jens.oehlschlaegel@bbdo-interone.de>
Message-ID: <01020613340100.00877@Aconitum>

On Tuesday 06 February 2001 12:36, Dr. Jens Oehlschlägel wrote:
> I like the idea. Why don't you call duplicated.matrix() directly in
> unique.matrix() and duplicated.data.frame() in unique.data.frame() ?
>
> Jens Oehlschlägel

Good point. I guess I got carried away with using methods (having just gotten 
the hang of the concept). :-)

Anyway, here's a corrected version:

----------------------------------------------------

"unique.default" <- get("unique", pos="package:base")    # old version becomes
                                                         # default behaviour
"unique" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(unique.matrix(object, ...))
   else
       UseMethod("unique")      # doesn't seem to work for matrices, hence 
}                               # the condition
                         


"duplicated.default" <- get("duplicated", pos="package:base")    

"duplicated" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(duplicated.matrix(object, ...))
   else
       UseMethod("duplicated")  
}


"duplicated.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
  return(duplicated(strvect))
}


"unique.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  dup <- duplicated.matrix(mat, MARGIN)
  return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
}


"duplicated.data.frame" <-
  function(df, MARGIN=1)
{
  strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse 
= "\r")))
  duplicated(strvect)
}


"unique.data.frame" <-
  function(df, MARGIN=1)
{
  dup <- duplicated.data.frame(df, MARGIN)
  return(if (MARGIN==1) df[!dup,] else df[,!dup])
}

----------------------------------------------------

Cheers

Kaspar Pflugshaupt
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb  6 12:49:28 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Feb 2001 12:49:28 +0000 (GMT)
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <01020613340100.00877@Aconitum>
Message-ID: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>

Method dispatch is far from free (it is quite slow). Do we want to
encumber unique() (a fast internal function) in this way?

There are better ways to do this if one is going to use C code:
converting to character and comparing long strings are both expensive,


On Tue, 6 Feb 2001, Kaspar Pflugshaupt wrote:

> On Tuesday 06 February 2001 12:36, Dr. Jens Oehlschlägel wrote:
> > I like the idea. Why don't you call duplicated.matrix() directly in
> > unique.matrix() and duplicated.data.frame() in unique.data.frame() ?
> >
> > Jens Oehlschlägel
>
> Good point. I guess I got carried away with using methods (having just gotten
> the hang of the concept). :-)
>
> Anyway, here's a corrected version:
>
> ----------------------------------------------------
>
> "unique.default" <- get("unique", pos="package:base")    # old version becomes
>                                                          # default behaviour
> "unique" <- function(object, ...)
> {
>    if (data.class(object)=="matrix")
>        return(unique.matrix(object, ...))
>    else
>        UseMethod("unique")      # doesn't seem to work for matrices, hence
> }                               # the condition
>                          
>
>
> "duplicated.default" <- get("duplicated", pos="package:base")   
>
> "duplicated" <- function(object, ...)
> {
>    if (data.class(object)=="matrix")
>        return(duplicated.matrix(object, ...))
>    else
>        UseMethod("duplicated")  
> }
>
>
> "duplicated.matrix" <-
>   function(mat, MARGIN=1)    # defaulting to work on rows
> {
>   strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
>   return(duplicated(strvect))
> }
>
>
> "unique.matrix" <-
>   function(mat, MARGIN=1)    # defaulting to work on rows
> {
>   dup <- duplicated.matrix(mat, MARGIN)
>   return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
> }
>
>
> "duplicated.data.frame" <-
>   function(df, MARGIN=1)
> {
>   strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse
> = "\r")))
>   duplicated(strvect)
> }
>
>
> "unique.data.frame" <-
>   function(df, MARGIN=1)
> {
>   dup <- duplicated.data.frame(df, MARGIN)
>   return(if (MARGIN==1) df[!dup,] else df[,!dup])
> }
>
> ----------------------------------------------------
>
> Cheers
>
> Kaspar Pflugshaupt
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Tue Feb  6 14:50:42 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Tue, 6 Feb 2001 15:50:42 +0100 (MET)
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
Message-ID: <200102061450.PAA22765@pubhealth.ku.dk>


Hi.  This is cosmetic in nature, yet annoying as the warning points
to the wrong source:  On a screen running on an X server with 100 DPI,
I always got warnings about X11 using the wrong font size:

> x11()
Warning message: 
X11 used font size 17 when 12 was requested 

Then I looked at the code and X11 is _not_ to be blamed for this:
R resets the requested font size for 100 DPI screens!  There should be
no warning.  (At least not a warning that makes people wonder whether
they misconfigured the font server again.)

The patch below moves Peter's scaling equation up, before the font
cache check and directly writes to size.  Thus it's true that:
  variable size == (IS_100DPI ? scaled requested size : requested size)
  variable pixelsize == (font available ? size (same as above)
						: size of allocated font)

Regards,
  -tom



*** ../src/unix/X11/devX11.c	Tue Feb  6 09:27:48 2001
--- ../src/unix/X11/devX11.c~	Fri Feb  2 08:20:37 2001
***************
*** 834,855 ****
      if (size < SMALLEST) size = SMALLEST;
      face--;
  
-     /* Here's a 1st class fudge: make sure that the Adobe design sizes
-        8, 10, 11, 12, 14, 17, 18, 20, 24, 25, 34 can be obtained via
-        an integer "size" at 100 dpi, namely 6, 7, 8, 9, 10, 12, 13,
-        14, 17, 18, 24 points. It's almost y = x * 100/72, but not
-        quite. The constants were found using lm(). --pd */
-     if (IS_100DPI) size = R_rint(size * 1.43 - 0.4);
- 
      /* search fontcache */
      for ( i = nfonts ; i-- ; ) {
  	f = &fontcache[i];
  	if ( f->face == face && f->size == size ) return f->font;
      }
  
!     /* 'size' is the requested size, 'pixelsize'  the size of the
!        actually allocated font*/
!     pixelsize = size;
  
      if (face == 4)
  	sprintf(buf, symbolname,  pixelsize);
--- 834,854 ----
      if (size < SMALLEST) size = SMALLEST;
      face--;
  
      /* search fontcache */
      for ( i = nfonts ; i-- ; ) {
  	f = &fontcache[i];
  	if ( f->face == face && f->size == size ) return f->font;
      }
  
! 
! 
!     /* Here's a 1st class fudge: make sure that the Adobe design sizes
!        8, 10, 11, 12, 14, 17, 18, 20, 24, 25, 34 can be obtained via
!        an integer "size" at 100 dpi, namely 6, 7, 8, 9, 10, 12, 13,
!        14, 17, 18, 24 points. It's almost y = x * 100/72, but not
!        quite. The constants were found using lm(). --pd */
! 
!     pixelsize = IS_100DPI ? R_rint(size * 1.43 - 0.4) : size;
  
      if (face == 4)
  	sprintf(buf, symbolname,  pixelsize);


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 02
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  6 15:33:19 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Feb 2001 16:33:19 +0100
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 6 Feb 2001 15:50:42 +0100 (MET)"
References: <200102061450.PAA22765@pubhealth.ku.dk>
Message-ID: <x2zofzvnb4.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:

> Hi.  This is cosmetic in nature, yet annoying as the warning points
> to the wrong source:  On a screen running on an X server with 100 DPI,
> I always got warnings about X11 using the wrong font size:
> 
> > x11()
> Warning message: 
> X11 used font size 17 when 12 was requested 
> 
> Then I looked at the code and X11 is _not_ to be blamed for this:
> R resets the requested font size for 100 DPI screens!  There should be
> no warning.  (At least not a warning that makes people wonder whether
> they misconfigured the font server again.)
                                     ===== :-)

Thanks. (Funny... I could have sworn I zapped that 100DPI
special-casing a while back. Maybe I forgot to commit?)

> 
> The patch below moves Peter's scaling equation up, before the font
> cache check and directly writes to size.  Thus it's true that:
>   variable size == (IS_100DPI ? scaled requested size : requested size)
>   variable pixelsize == (font available ? size (same as above)
> 						: size of allocated font)
> 
> Regards,
>   -tom

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 15:51:34 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 16:51:34 +0100
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>
References: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>
Message-ID: <01020616503101.00877@Aconitum>

On Tuesday 06 February 2001 13:49, Prof Brian Ripley wrote:

> Method dispatch is far from free (it is quite slow). Do we want to
> encumber unique() (a fast internal function) in this way?

That's a good argument. I did not know dispatch was such a problem in terms 
of speed. J. Oelschlägel suggested eliminating two dispatches by calling 

  return(duplicated.default(strvect)) 

instead of

  return(duplicated(strvect))

in both duplicated.matrix() and duplicated.data.frame().
But the speed gain, following your second argument, would probably be 
marginal. And the default methods would still get dispatched.

>
> There are better ways to do this if one is going to use C code:
> converting to character and comparing long strings are both expensive,

Since I cannot write C, this is not an option for me. I guess I'll take back 
my proposal and use the functions privately. I might publish them on r-help 
(in a non-dispatched form, not overloading the original functions), so others 
can use them as well.


Thanks for the feedback (I learned a lot)

Kaspar Pflugshaupt

----

Kaspar Pflugshaupt
Geobotanical Institute
ETH Zurich, Switzerland

http://www.geobot.umnw.ethz.ch
mailto:pflugshaupt@geobot.umnw.ethz.ch

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  6 16:32:39 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Feb 2001 17:32:39 +0100
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 6 Feb 2001 15:50:42 +0100 (MET)"
References: <200102061450.PAA22765@pubhealth.ku.dk>
Message-ID: <x2d7cvvkk8.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:

> The patch below moves Peter's scaling equation up, before the font
> cache check and directly writes to size.  Thus it's true that:
>   variable size == (IS_100DPI ? scaled requested size : requested size)
>   variable pixelsize == (font available ? size (same as above)
> 						: size of allocated font)

Patch installed and committed to the release branch (1.2.2pre).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Wed Feb  7 06:15:04 2001
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed, 7 Feb 2001 07:15:04 +0100
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200102070615.HAA03109@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.r-project.org or via email to
r-bugs@r-project.org. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 751 *
Subject: BUG: polyroot()
From: "Li Dongfeng" <mavip1@inet.polyu.edu.hk>
Date: Tue, 28 Nov 2000 13:24:33 +0800
--Numerical instability. We may want a better algorithm!

Directory:  Add-ons

* PR# 824 *
Subject: trouble with netCDF 
From: jasont@indigoindustrial.co.nz
Date: Thu, 25 Jan 2001 12:00:39 +1300
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 812 *
Subject: segmentation fault in integrate
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Thu, 11 Jan 2001 22:49:59 +0100
* PR# 781 *
Subject: syskern fails Rcmd check on Windows, gives incorrect information
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 20 Dec 2000 11:12:47 +0000 (GMT)
--Partially fixed by dse_2000.12, but still uses "ls" and gives
--incorrect information

Directory:  Analyses

* PR# 653 *
Subject: bug in spline()?
From: Ian White <imsw@holyrood.ed.ac.uk>
Date: Mon, 4 Sep 2000 12:29:26 +0100 (BST)
--bug in spline: replace by interSpline in package spline?
--address problems are fixed

Directory:  Documentation

none

Directory:  Graphics

* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
* PR# 726 *
Subject: par(las=.)  gives wrong "adj" for mtext()
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 7 Nov 2000 13:03:58 +0100
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
* PR# 750 *
Subject: abline() does not obey "xpd" (clipping rules)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 27 Nov 2000 18:27:11 +0100
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix will work (and spaces for labels will be fine), but there is a
--deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--I think the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above may
--have side-effects in many other pieces of interpreted code (ii) do_mtext ignores
--
--dd->gp.cexbase unlike, for example, do_plot_xy and anything to do with cexbase
--needs extreme care.
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
* PR# 823 *
Subject: adjustment of expressions with mtext(..., las=2)
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Wed, 24 Jan 2001 20:12:43 +0100
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100

Directory:  In-Out

* PR# 814 *
Subject: Memory problem ?
From: Zoltan Barta <Z.Barta@bristol.ac.uk>
Date: Mon, 15 Jan 2001 09:54:16 +0000 (GMT Standard Time)
--scan crashes R on Linux: a memory allocation problem, probably
--Uses n= or nlines= in scan will use less memory, and read.table does.

Directory:  Installation

* PR# 806 *
Subject: configure error on alpha
From: Richard Beare <Richard.Beare@cmis.CSIRO.AU>
Date: Wed, 10 Jan 2001 16:52:58 +1100

Directory:  Language

* PR# 813 *
Subject: match.call problem
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jan 2001 17:46:15 +0100
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 822 *
Subject: Re: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:56:32 +0100 (CET)
--part of 821
* PR# 821 *
Subject: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:44:28 +0100 (CET)
--See also 822, which shows the segfault is in strftime.c.
--From other correspondence, this is on RH5.0: we can't
--reproduce it on RH6.2 or anywhere else.
* PR# 808 *
Subject: Time zone
From: Herve Morin <morin@mat.ulaval.ca>
Date: Wed, 10 Jan 2001 07:24:07 -0500
--This appears to be a complaint about a warning on a beta Mac version
--(but Macs are never mentioned!).  That version is incomplete.

Directory:  TooMuchAtOnce

* PR# 811 *
Subject: problem with strptime example (and mention of bug.report)
From: Stephen Eglen <stephen@anc.ed.ac.uk>
Date: Thu, 11 Jan 2001 19:18:39 GMT
--1) On OSF4, strptime is deficient. Nothing we can do.
--
--2) On Windows NT, the strptime problems are (i) German locale, English dates,
--(ii) Windows system errors with unknown DST (it move times to DST).
--(i) now has another warning in the help file (there already was one).
--(ii) was already worked around for 1.2.1.
--
--3) bug.report() uses a mailer option that does not exist on OSF4.

Directory:  Windows

none

Directory:  incoming

* PR# 840 *
Subject: X11 warnings about "wrong" font sizes
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 06 Feb 2001 09:50:44 -0500
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500
* PR# 830 *
Subject: Disappearing x axis in plot.factor
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:27:13 -0500
* PR# 829 *
Subject: variables in nls
From: baron@cattell.psych.upenn.edu
Date: Sun, 28 Jan 2001 15:07:27 +0100 (MET)
* PR# 835 *
Subject: factors in data.frames
From: Jim Lindsey <james.lindsey@luc.ac.be>
Date: Thu, 1 Feb 2001 10:55:59 +0100 (MET)
* PR# 834 *
Subject:  inconsistent behaviour between class() and inherits() 
From: adrian@olsen.ch
Date: Thu, 01 Feb 2001 10:07:13 +0100
* PR# 832 *
Subject: Rconsole documentation
From: david.firth@nuffield.oxford.ac.uk
Date: Tue, 30 Jan 2001 15:52:49 +0100 (MET)
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
* PR# 836 *
Subject: configure bug in R-1.2.1 and earlier
From: Lars Hecking <lhecking@nmrc.ie>
Date: Thu, 1 Feb 2001 18:41:09 +0000
* PR# 839 *
Subject: clipped lines have wrong slope in log plot
From: Jason Eisner <jason@cs.rochester.edu>
Date: Sun, 4 Feb 2001 20:17:31 -0500 (EST)
* PR# 838 *
Subject: Linux shared library problem
From: daniel.egloff@dplanet.ch
Date: Sun, 4 Feb 2001 22:37:31 +0100 (MET)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 15:45:58 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 16:45:58 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
References: <200102071105.LAA08910@achill.nmrc.ucc.ie>
 <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
Message-ID: <14977.28086.8858.910911@mithrandir.hornik.net>

>>>>> Yves Gauvreau writes:

> Try this
> sampled <- data.frame(sample(rnorm(100),2))
> colnames(sampled) <- " " # Or preferably something meaningful
> sampled

> 1 1.777068
> 2 0.937161

Ouch!

This *surely* is a bug.  How can it be possible to remove the variable
names in a data frame?

It may be time to reconsider what
	rownames
	colnames
	case.names
	variable.names
do for data frames.

But in fact, both

	names(sampled) <- " "
and
	dimnames(sampled)[[2]] <- " "

happily introduce non-unique variable names in the data frame.

Is the rule that row.names and names must be unique still on?

Argh ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley" <ripley@stats.ox.ac.uk  Mon Feb  5 10:50:38 2001
From: Prof Brian Ripley" <ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 05 Feb 2001 10:50:38 +0000 (GMT)
Subject: [Rd] Change of licence for header files and import libraries
Message-ID: <200102051050.KAA22990@toucan.stats.ox.ac.uk>

The copyrights on the distributed header files and export files R.exp
have been changed to the more permissive LGPL.

It came to our attention that some projects are interpreting GPL to
mean that compiling against the header files or linking against a
Windows import library brings the compiled code under the scope of
GPL.  This would mean it would be impossible to distribute binary
versions of non-GPL packages with compiled code which called entry
points in the R executable or DLL, of which there are many on CRAN.

We encourage packages to be distributed under Open Source conditions,
but accept that this is not possible for some contributions.  Our
intention is that export files and import libraries be `accessors'
under clause 5 of the LGPL, so that in most cases no (additional)
restrictions are imposed by compiling a package using the LGPL-ed
components of R.

To avoid any anomalies, the versions of the same files in R versions
1.0.0 to 1.2.1 may also be used under LGPL or GPL.

For the R core team,

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 15:54:16 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 07:54:16 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.28086.8858.910911@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Yves Gauvreau writes:
> 
> > Try this
> > sampled <- data.frame(sample(rnorm(100),2))
> > colnames(sampled) <- " " # Or preferably something meaningful
> > sampled
> 
> > 1 1.777068
> > 2 0.937161
> 
> Ouch!
> 
> This *surely* is a bug.  How can it be possible to remove the variable
> names in a data frame?

He hasn't removed them, just set them to " ". We allow variable names that
are not valid R names (in fact, we rely on them in model.frame).

	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 15:57:27 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 16:57:27 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>
References: <14977.28086.8858.910911@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.28775.611743.933442@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Yves Gauvreau writes:
>> 
>> > Try this
>> > sampled <- data.frame(sample(rnorm(100),2))
>> > colnames(sampled) <- " " # Or preferably something meaningful
>> > sampled
>> 
>> > 1 1.777068
>> > 2 0.937161
>> 
>> Ouch!
>> 
>> This *surely* is a bug.  How can it be possible to remove the variable
>> names in a data frame?

> He hasn't removed them, just set them to " ". We allow variable names
> that are not valid R names (in fact, we rely on them in model.frame).

Correct.  Let me rephrase the question: how can it be possible to set
the (variable) names in a data frame to something non-unique?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb  7 16:06:03 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Feb 2001 17:06:03 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: Kurt Hornik's message of "Wed, 7 Feb 2001 16:45:58 +0100"
References: <200102071105.LAA08910@achill.nmrc.ucc.ie> <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca> <14977.28086.8858.910911@mithrandir.hornik.net>
Message-ID: <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 	names(sampled) <- " "
> and
> 	dimnames(sampled)[[2]] <- " "
> 
> happily introduce non-unique variable names in the data frame.
> 
> Is the rule that row.names and names must be unique still on?
> 
> Argh ...

Splus 3.4 dispatches on dimnames<-, but not on names<- with the
following curious result:

> d <- data.frame(a=1:3,b=4:6)
> names(d)<-c(" "," ")
> d
      
1 1 4
2 2 5
3 3 6
> dimnames(d)[[1]] <- rep(" ",3)  
Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
Dumped

R dispatches similarly, but doesn't check the dimnames in
dimnames<-.data.frame. It could do so quite easily. Just add 

|| any(duplicated(d[[1]])) || any(duplicated(d[[2]]))

at the appropriate spot. 
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 16:13:29 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 17:13:29 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>
References: <200102071105.LAA08910@achill.nmrc.ucc.ie>
 <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
 <14977.28086.8858.910911@mithrandir.hornik.net>
 <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>
Message-ID: <14977.29737.623121.566627@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> names(sampled) <- " "
>> and
>> dimnames(sampled)[[2]] <- " "
>> 
>> happily introduce non-unique variable names in the data frame.
>> 
>> Is the rule that row.names and names must be unique still on?
>> 
>> Argh ...

> Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> following curious result:

>> d <- data.frame(a=1:3,b=4:6)
>> names(d)<-c(" "," ")
>> d
      
> 1 1 4
> 2 2 5
> 3 3 6
>> dimnames(d)[[1]] <- rep(" ",3)  
> Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> Dumped

> R dispatches similarly, but doesn't check the dimnames in
> dimnames<-.data.frame. It could do so quite easily. Just add 

> || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))

> at the appropriate spot.

Thomas' view about what should be permitted seems to be different.

Also note that the convenience functions for name manipulation such as
variable.names typically do their own little thing and do not go via
dimnames.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 16:00:46 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 08:00:46 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.28775.611743.933442@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> Correct.  Let me rephrase the question: how can it be possible to set
> the (variable) names in a data frame to something non-unique?

1) he didn't: there was only one column
2) we allow duplicated column names
 For example
  a<-data.frame(rnorm(10),rnorm(10)) 
 gives a data frame with two columns having the same name. What do you
think they should be called?  
We discussed this some time ago in the context of offsets in glm(), and
model.offset contains code to handle multiple "(offset)" columns.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 16:23:06 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 08:23:06 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.29737.623121.566627@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Peter Dalgaard BSA writes:
> 
> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> names(sampled) <- " "
> >> and
> >> dimnames(sampled)[[2]] <- " "
> >> 
> >> happily introduce non-unique variable names in the data frame.
> >> 
> >> Is the rule that row.names and names must be unique still on?
> >> 
> >> Argh ...
> 
> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> > following curious result:
> 
> >> d <- data.frame(a=1:3,b=4:6)
> >> names(d)<-c(" "," ")
> >> d
>       
> > 1 1 4
> > 2 2 5
> > 3 3 6
> >> dimnames(d)[[1]] <- rep(" ",3)  
> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> > Dumped
> 
> > R dispatches similarly, but doesn't check the dimnames in
> > dimnames<-.data.frame. It could do so quite easily. Just add 
> 
> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> 
> > at the appropriate spot.
> 
> Thomas' view about what should be permitted seems to be different.

I wouldn't object to making it hard to create duplicated names(), but I
think it would be a bad idea to have data.frame() make up unique names if
it's given non-unique ones.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:20:29 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:20:29 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>
References: <14977.28775.611743.933442@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.33757.452637.165825@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> Correct.  Let me rephrase the question: how can it be possible to set
>> the (variable) names in a data frame to something non-unique?

> 1) he didn't: there was only one column

Maybe I should be more careful when composing my emails :-)

I think I am also concerned about data frames with variable names which
are not syntactically valid, but one can also get that by creating the
data frame with `check.names = FALSE'.

> 2) we allow duplicated column names
>  For example
>   a<-data.frame(rnorm(10),rnorm(10)) 
>  gives a data frame with two columns having the same name. What do you
> think they should be called?  
> We discussed this some time ago in the context of offsets in glm(), and
> model.offset contains code to handle multiple "(offset)" columns.

Hmm, I must have missed that.

My understanding thus far was that I can always rely on unique case and
variable names in a data frame.  I see the potential usefulness in
allowing multiple "(offset)" columns in a model frame ... but wouldn't
that (at least in theory) call for using a different class?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:23:12 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:23:12 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>
References: <14977.29737.623121.566627@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.33920.590610.689408@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Peter Dalgaard BSA writes:
>> 
>> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> names(sampled) <- " "
>> >> and
>> >> dimnames(sampled)[[2]] <- " "
>> >> 
>> >> happily introduce non-unique variable names in the data frame.
>> >> 
>> >> Is the rule that row.names and names must be unique still on?
>> >> 
>> >> Argh ...
>> 
>> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> > following curious result:
>> 
>> >> d <- data.frame(a=1:3,b=4:6)
>> >> names(d)<-c(" "," ")
>> >> d
>> 
>> > 1 1 4
>> > 2 2 5
>> > 3 3 6
>> >> dimnames(d)[[1]] <- rep(" ",3)  
>> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> > Dumped
>> 
>> > R dispatches similarly, but doesn't check the dimnames in
>> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> 
>> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> 
>> > at the appropriate spot.
>> 
>> Thomas' view about what should be permitted seems to be different.

> I wouldn't object to making it hard to create duplicated names(), but
> I think it would be a bad idea to have data.frame() make up unique
> names if it's given non-unique ones.

Maybe `check.names' could also be used for uniqueness testing?

In any case, I think we should specify what *exactly* a data frame is.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 17:33:12 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.33920.590610.689408@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Thomas Lumley writes:
> 
> > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> >>>>> Peter Dalgaard BSA writes:
> >> 
> >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> >> names(sampled) <- " "
> >> >> and
> >> >> dimnames(sampled)[[2]] <- " "
> >> >> 
> >> >> happily introduce non-unique variable names in the data frame.
> >> >> 
> >> >> Is the rule that row.names and names must be unique still on?
> >> >> 
> >> >> Argh ...
> >> 
> >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> >> > following curious result:
> >> 
> >> >> d <- data.frame(a=1:3,b=4:6)
> >> >> names(d)<-c(" "," ")
> >> >> d
> >> 
> >> > 1 1 4
> >> > 2 2 5
> >> > 3 3 6
> >> >> dimnames(d)[[1]] <- rep(" ",3)  
> >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> >> > Dumped
> >> 
> >> > R dispatches similarly, but doesn't check the dimnames in
> >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> >> 
> >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> >> 
> >> > at the appropriate spot.
> >> 
> >> Thomas' view about what should be permitted seems to be different.
> 
> > I wouldn't object to making it hard to create duplicated names(), but
> > I think it would be a bad idea to have data.frame() make up unique
> > names if it's given non-unique ones.
> 
> Maybe `check.names' could also be used for uniqueness testing?
> 
> In any case, I think we should specify what *exactly* a data frame is.
>

I think we should specify, and check.names is a logical way to
allow/forbid non-unique columns.  

Having a new class would be messy: logically it shouldn't inherit from
data.frame, data.frame should inherit from it, but that would be a real
pain to set up.

	-thomas


	

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:36:55 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:36:55 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>
References: <14977.33920.590610.689408@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>
Message-ID: <14977.34743.548005.545365@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Thomas Lumley writes:
>> 
>> > On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >> >>>>> Peter Dalgaard BSA writes:
>> >> 
>> >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> >> names(sampled) <- " "
>> >> >> and
>> >> >> dimnames(sampled)[[2]] <- " "
>> >> >> 
>> >> >> happily introduce non-unique variable names in the data frame.
>> >> >> 
>> >> >> Is the rule that row.names and names must be unique still on?
>> >> >> 
>> >> >> Argh ...
>> >> 
>> >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> >> > following curious result:
>> >> 
>> >> >> d <- data.frame(a=1:3,b=4:6)
>> >> >> names(d)<-c(" "," ")
>> >> >> d
>> >> 
>> >> > 1 1 4
>> >> > 2 2 5
>> >> > 3 3 6
>> >> >> dimnames(d)[[1]] <- rep(" ",3)  
>> >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> >> > Dumped
>> >> 
>> >> > R dispatches similarly, but doesn't check the dimnames in
>> >> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> >> 
>> >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> >> 
>> >> > at the appropriate spot.
>> >> 
>> >> Thomas' view about what should be permitted seems to be different.
>> 
>> > I wouldn't object to making it hard to create duplicated names(), but
>> > I think it would be a bad idea to have data.frame() make up unique
>> > names if it's given non-unique ones.
>> 
>> Maybe `check.names' could also be used for uniqueness testing?
>> 
>> In any case, I think we should specify what *exactly* a data frame is.
>> 

> I think we should specify, and check.names is a logical way to
> allow/forbid non-unique columns.

O.k.  Would the assignment versions of rownames/colnames etc also have
the `check.names' argument for their data frame methods?  Personally I
have no preferences for row/colnames which are, by their naming, more
matrix style.  But I think the ``high-level'' case.names and
variable.names perhaps should ...

> Having a new class would be messy: logically it shouldn't inherit from
> data.frame, data.frame should inherit from it, but that would be a real
> pain to set up.

[Yes, unfortunately.]

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From murdoch@stats.uwo.ca  Wed Feb  7 17:51:12 2001
From: murdoch@stats.uwo.ca (Duncan Murdoch)
Date: Wed, 07 Feb 2001 12:51:12 -0500
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from contour)
Message-ID: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>

I submitted a message to r-help this morning that really belongs in
r-devel; here's its URL in the archive:
<http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.

In summary, I suggest that R graphics objects should be accessible and
modifiable, but it raises some problems if you want to do it without
pointers.

Duncan Murdoch
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Feb  7 18:45:02 2001
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 7 Feb 2001 18:45:02 +0000 (GMT)
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from
 contour)
In-Reply-To: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>
Message-ID: <Pine.GSO.4.31.0102071828220.14134-100000@auk.stats>

On Wed, 7 Feb 2001, Duncan Murdoch wrote:

> I submitted a message to r-help this morning that really belongs in
> r-devel; here's its URL in the archive:
> <http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.
>
> In summary, I suggest that R graphics objects should be accessible and
> modifiable, but it raises some problems if you want to do it without
> pointers.

Duncan,

I saw your post, and Ross's.   As I understand it, in R there is a
separation between computing and drawing, but it is at a higher level than
the original question wanted.  That's not to say I am very sure of this!

Normally, R maintains a display list, that is a list of high-level
description of graphics calls.  The idea is that list can be replayed
to refresh the display as needed (especially if it is resized), but the
idea has been taken further, for example to copy plots by replaying
on another device.  Further, individual plots can be saved and replayed,
first by menus on Guido's Windows display driver, and later from R
functions.

Now, I don't understand the display list in detail, but I know we have had
problems with statefulness.  There is also a lower-level separation, the
set of calls made to the graphics driver, more akin to Windows GDI calls.
One of my motivations for writing a PDF driver (there is one in R-devel
now) was to allow editing of graphical output at object level.
Unfortunately, this is not to be as the graphics driver interface is too
low-level, for plotmath at the level of a single character, for example.

I suspect that the ideal is somewhere in between the display list and the
graphics driver level, and that probably PDF is about right.  Someone in
Apple clearly thinks so given the fuss being made about MacOSX graphics.

I am not sure this helps you much.  It is one example of an issue that is
beginning to come up in several places:  is it better to re-design and
re-implement, or to try to maintain what we have?

On the actual issue of extracting contours, then I think if you
turn labelling off and use a device like XFig, it is quite easy to pull out
the contours as vectors.

Some background thoughts, I hope of some use.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From David James <dj@research.bell-labs.com>  Wed Feb  7 18:50:26 2001
From: David James <dj@research.bell-labs.com> (David James)
Date: Wed, 7 Feb 2001 13:50:26 -0500 (EST)
Subject: [Rd] RE: [R] Removing "row.names"
Message-ID: <200102071850.NAA22791@jessie.research.bell-labs.com>


> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
> From: Thomas Lumley <tlumley@u.washington.edu>
> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
> Subject: Re: [Rd] RE: [R] Removing "row.names"
> MIME-Version: 1.0
> 
> On Wed, 7 Feb 2001, Kurt Hornik wrote:
> 
> > >>>>> Thomas Lumley writes:
> > 
> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> > >> >>>>> Peter Dalgaard BSA writes:
> > >> 
> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> > >> >> names(sampled) <- " "
> > >> >> and
> > >> >> dimnames(sampled)[[2]] <- " "
> > >> >> 
> > >> >> happily introduce non-unique variable names in the data frame.
> > >> >> 
> > >> >> Is the rule that row.names and names must be unique still on?
> > >> >> 
> > >> >> Argh ...
> > >> 
> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> > >> > following curious result:
> > >> 
> > >> >> d <- data.frame(a=1:3,b=4:6)
> > >> >> names(d)<-c(" "," ")
> > >> >> d
> > >> 
> > >> > 1 1 4
> > >> > 2 2 5
> > >> > 3 3 6
> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> > >> > Dumped
> > >> 
> > >> > R dispatches similarly, but doesn't check the dimnames in
> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> > >> 
> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> > >> 
> > >> > at the appropriate spot.
> > >> 
> > >> Thomas' view about what should be permitted seems to be different.
> > 
> > > I wouldn't object to making it hard to create duplicated names(), but
> > > I think it would be a bad idea to have data.frame() make up unique
> > > names if it's given non-unique ones.
> > 
> > Maybe `check.names' could also be used for uniqueness testing?
> > 
> > In any case, I think we should specify what *exactly* a data frame is.
> >
> 
> I think we should specify, and check.names is a logical way to
> allow/forbid non-unique columns.  
> 
> Having a new class would be messy: logically it shouldn't inherit from
> data.frame, data.frame should inherit from it, but that would be a real
> pain to set up.
> 

Data frames were originally meant to be used in modeling functions.
The opening paragraph in Chapter 3 (Data for Models) in the White Book
says:
 
  "This chapter describes the general structure for data that
  will be used throughout the book.  In particular, it introduces the
  data frame, a class of objects to represent the data typically encounterd  
  in fitting models."

However, data.frames may not be quite appropriate for representing
other types of tabular data (certainly a data.frame does not capture
the essence of, say, a "relational" table in the SQL sense, which doesn't
have the concept of row names).  Several manifestations of this problem are 
coercing character data to factors "at the drop of a hat" (as someone wrote 
here or in s-news), the row.names issue now being discussed,  problems 
including general objets in the "cells" of the data.frame, etc.  

I think that the concept of a data.frame to represent data for fitting
models is fine, but we may (certainly I) have abused this concept.  We need 
other classes of tabular data objects in addition (not as a replacement) to 
data.frames, together with coercion methods and perhaps other utilities.


David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Wed Feb  7 20:28:57 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Thu, 8 Feb 2001 09:28:57 +1300
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from contour)
References: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>
Message-ID: <008c01c09144$9b684740$175dd882@stat.auckland.ac.nz>

Hi


----- Original Message -----
From: Duncan Murdoch <murdoch@stats.uwo.ca>
To: <r-devel@stat.math.ethz.ch>
Sent: Thursday, February 08, 2001 6:51 AM
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from
contour)


> I submitted a message to r-help this morning that really belongs in
> r-devel; here's its URL in the archive:
> <http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.
>
> In summary, I suggest that R graphics objects should be accessible and
> modifiable, but it raises some problems if you want to do it without
> pointers.


I have been doing some similar stuff to what you describe (primitives and
groups arranged in hierarchies), but for 2D graphics, and I have used Luke
Tierney's "external pointers" to provide access to graphical objects which
represent the graphical output.  See the R developer page
http://developer.r-project.org/ for Luke's stuff, but please note the
disclaimer at the top of that page.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Feb  8 08:09:54 2001
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Thu, 8 Feb 2001 09:09:54 +0100 (MET)
Subject: [Rd] RE: [R] Re: failed rpm installation of R 1.2-1 (fwd) (PR#841)
Message-ID: <200102080809.JAA13815@pubhealth.ku.dk>

I'm forwarding this to R-bugs.

In R 1.2.1 the file $R_HOME/bin/maketitle.awk is installed as an
executable. It should not be since it is just a set of awk commands,
not a script file that can be run from the shell (This is a change from
R 1.2.0 in which the file $R_HOME/bin/maketitle was a shell script).

This confuses an rpm utility called "find-requires" which scans all
executable files in an effort to determine the dependencies of 
the rpm package.
- binaries are scanned for the dynamic libraries they are linked against
- The heads of script files are scanned to see what language they
  are written in. In this case the first line of maketitle.awk is
  the awk command BEGIN, which is misinterpreted as a dependency for R.

Martyn


On 07-Feb-01 Albrecht Gebhardt wrote:
> On Wed, 7 Feb 2001, Faheem Mitha wrote:
> 
>> Dear Albrecht,
>> 
>> Just sent the following message out to r-help. Have you any idea what this
>> problem could be?
>> 
>>                          Sincerely, Faheem Mitha.
>> 
>> ---------- Forwarded message ----------
>> Date: Wed, 7 Feb 2001 00:04:35 -0500 (EST)
>> From: Faheem Mitha <faheem@email.unc.edu>
>> To: r-help@stat.math.ethz.ch
>> Subject: failed rpm installation of R 1.2-1
>> 
>> Dear People,
>> 
>> Just tried to compile an rpm for R 1.2-1 (using Albrecht Gebhardt's spec
>> file). The compile went successfully and produced a binary rpm, but when I
>> tried to install it, I got an error
>> 
>> error: failed dependencies:
>>         BEGIN is needed by R-base-1.2.1-1
>> 
>> I see this was also listed in the Requires list at the end of the rpm
>> compilation: 
>> 
>> Requires: /bin/sh /usr/bin/perl BEGIN ...
>> 
>> Of course I could force installation of the package, but I would like to
>> know what I am doing first. Albrecht does not say anything about BEGIN in
>> his spec file, so this must be somethin internal to R. Does anyone have
>> any idea what? I have no idea.
>>
> 
> I guess, there is some executable file (a snippet of some script with mode
> 755 or similar) which starts with a line "BEGIN". ....
> 
> Well, I just found it, it is an awk script:
> find -type f -exec grep -l BEGIN {} \;
> ...
> ./bin/maketitle.awk
> 
> Clearly it doesn't need the executable bits so simply add
> 
> chmod 644 $RPM_BUILD_ROOT/%{prefix}/R/bin/maketitle.awk
> 
> to the end of the %install section of my spec file.
> 
> 
> Albrecht

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rbeer@uni-goettingen.de  Thu Feb  8 12:29:07 2001
From: rbeer@uni-goettingen.de (Ragnar Beer)
Date: Thu, 8 Feb 2001 13:29:07 +0100
Subject: [Rd] hollow points bug?
Message-ID: <p04330100b6a8406244a7@[134.76.136.114]>

Howdy!

According to help(points) setting the bg parameter should set the 
background fill color for open plot symbols. But when I tried out 
(R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always 
see through the "O". Is this a bug or am getting something wrong?

Ragnar
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb  8 12:44:45 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 8 Feb 2001 12:44:45 +0000 (GMT)
Subject: [Rd] hollow points bug?
In-Reply-To: <p04330100b6a8406244a7@[134.76.136.114]>
Message-ID: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>

On Thu, 8 Feb 2001, Ragnar Beer wrote:

> Howdy!
>
> According to help(points) setting the bg parameter should set the
> background fill color for open plot symbols. But when I tried out
> (R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always
> see through the "O". Is this a bug or am getting something wrong?

I believe it refers only to pch=21:25, as described about 10 lines
further up.  Certainly pch=1 is the outline of a cicrle, not a filled
circle.  I've made this explicit in the documentation.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rbeer@uni-goettingen.de  Thu Feb  8 13:22:04 2001
From: rbeer@uni-goettingen.de (Ragnar Beer)
Date: Thu, 8 Feb 2001 14:22:04 +0100
Subject: [Rd] hollow points bug?
In-Reply-To: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>
References: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>
Message-ID: <p04330102b6a84cbe1a70@[134.76.136.114]>

Got it. Thanks a lot! Perhaps " (pch=21:25)" could be added to the 
line describing bg to add some redundancy.

Ragnar

>On Thu, 8 Feb 2001, Ragnar Beer wrote:
>
>>  Howdy!
>>
>>  According to help(points) setting the bg parameter should set the
>>  background fill color for open plot symbols. But when I tried out
>>  (R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always
>>  see through the "O". Is this a bug or am getting something wrong?
>
>I believe it refers only to pch=21:25, as described about 10 lines
>further up.  Certainly pch=1 is the outline of a cicrle, not a filled
>circle.  I've made this explicit in the documentation.
>
>--
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272860 (secr)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
>r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
>Send "info", "help", or "[un]subscribe"
>(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
>_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Feb  8 13:41:03 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 8 Feb 2001 14:41:03 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <200102071850.NAA22791@jessie.research.bell-labs.com>
References: <200102071850.NAA22791@jessie.research.bell-labs.com>
Message-ID: <14978.41455.172646.505117@mithrandir.hornik.net>

>>>>> David James writes:

>> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
>> From: Thomas Lumley <tlumley@u.washington.edu>
>> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
>> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
>> Subject: Re: [Rd] RE: [R] Removing "row.names"
>> MIME-Version: 1.0
>> 
>> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> 
>> > >>>>> Thomas Lumley writes:
>> > 
>> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> > >> >>>>> Peter Dalgaard BSA writes:
>> > >> 
>> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> > >> >> names(sampled) <- " "
>> > >> >> and
>> > >> >> dimnames(sampled)[[2]] <- " "
>> > >> >> 
>> > >> >> happily introduce non-unique variable names in the data frame.
>> > >> >> 
>> > >> >> Is the rule that row.names and names must be unique still on?
>> > >> >> 
>> > >> >> Argh ...
>> > >> 
>> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> > >> > following curious result:
>> > >> 
>> > >> >> d <- data.frame(a=1:3,b=4:6)
>> > >> >> names(d)<-c(" "," ")
>> > >> >> d
>> > >> 
>> > >> > 1 1 4
>> > >> > 2 2 5
>> > >> > 3 3 6
>> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
>> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> > >> > Dumped
>> > >> 
>> > >> > R dispatches similarly, but doesn't check the dimnames in
>> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> > >> 
>> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> > >> 
>> > >> > at the appropriate spot.
>> > >> 
>> > >> Thomas' view about what should be permitted seems to be different.
>> > 
>> > > I wouldn't object to making it hard to create duplicated names(), but
>> > > I think it would be a bad idea to have data.frame() make up unique
>> > > names if it's given non-unique ones.
>> > 
>> > Maybe `check.names' could also be used for uniqueness testing?
>> > 
>> > In any case, I think we should specify what *exactly* a data frame is.
>> >
>> 
>> I think we should specify, and check.names is a logical way to
>> allow/forbid non-unique columns.  
>> 
>> Having a new class would be messy: logically it shouldn't inherit from
>> data.frame, data.frame should inherit from it, but that would be a real
>> pain to set up.
>> 

> Data frames were originally meant to be used in modeling functions.
> The opening paragraph in Chapter 3 (Data for Models) in the White Book
> says:
 
>   "This chapter describes the general structure for data that
>   will be used throughout the book.  In particular, it introduces the
>   data frame, a class of objects to represent the data typically encounterd  
>   in fitting models."

> However, data.frames may not be quite appropriate for representing
> other types of tabular data (certainly a data.frame does not capture
> the essence of, say, a "relational" table in the SQL sense, which
> doesn't have the concept of row names).  Several manifestations of
> this problem are coercing character data to factors "at the drop of a
> hat" (as someone wrote here or in s-news), the row.names issue now
> being discussed, problems including general objets in the "cells" of
> the data.frame, etc.

> I think that the concept of a data.frame to represent data for fitting
> models is fine, but we may (certainly I) have abused this concept.  We
> need other classes of tabular data objects in addition (not as a
> replacement) to data.frames, together with coercion methods and
> perhaps other utilities.

Thomas had said that yes it would be nice to have something with less
restrictions for modeling, but that it was uneconomical at least to
introduce a new class that data.frame would then inherit from.

I interpret your comment as suggesting that we introduce a new class for
holding tabular data?  Do you have specific ideas on this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Diego@kuonen.com  Thu Feb  8 19:01:46 2001
From: Diego@kuonen.com (Diego Kuonen)
Date: Thu, 08 Feb 2001 20:01:46 +0100
Subject: [Rd] What is R?
Message-ID: <3A82ED1A.E2505E42@Kuonen.com>

Dear all

there's something. that puzzles me about what R is :-)

   "R is available as Free Software under the terms of the Free 
    Software Foundation's GNU General Public License in source 
    code form."

(Source: http://www.r-project.org/about.html)

But, looking at the second paragraph of the same site, you
see this:

   "... and R provides an Open Source route to participation in
    that activity."

As we all know the term "open source" means something close 
(but not identical) to "free software". 

So, what is R?

It clearly seems to be "free software" and not only "open source" 
software, or?


Finally, Let's have a look at the following:

   "... This article describes why using the term ``open source'' does 
    not solve any problems, and in fact creates some. These are the reasons 
    why it is better to stick with ``free software.'' ... "

(Source: http://www.gnu.org/philosophy/free-software-for-freedom.html )


I'm puzzled, are you?


Greets

  Diego


P.S.: What about "Omegahat"?


-- 
Diego Kuonen $\in$ Chairs of Statistics $\subset$ DMA \@ EPFL
http://stat.kuonen.com                  http://www.Statoo.com 
Q: How do I type "for i in *.dvi; do xdvi $i; done" in a GUI?  
/*      panic("esp: Aiee penguin on the SCSI-bus.");       */
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Thu Feb  8 19:44:20 2001
From: tlumley@u.washington.edu (tlumley@u.washington.edu)
Date: Thu, 8 Feb 2001 20:44:20 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102081944.UAA23120@pubhealth.ku.dk>


This came up on r-help but indicates a bug.

dnbinom(x,n,p) calls dbinom_raw(n-1,...)
which returns 0 for n<1.

	-thomas


---------- Forwarded message ----------
Date: Thu, 08 Feb 2001 17:10:23 +0000
From: Yudi Pawitan <yudi@stat.ucc.ie>
To: Mark Myatt <mark@myatt.demon.co.uk>
Cc: R-Help <r-help@stat.math.ethz.ch>
Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

Sorry, Mark, the program worked for Rw1011, but this is
what happened in Rw1021:

> dnbinom(0:5,.9,.4)  
[1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

while, the correct result from Rw1011 is:
>  dnbinom(0:5,.9,.4)
[1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

I have added a corrected dnbinom() below, which makes the program
works  for Rw1021.

-YP-

x_ c(70, 38, 17, 10,  9, 6) 
kk_ 0:5
n_ sum(x)

dnbinom_ function(x,n,p){
         gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
}

fn_ function(p){
    r_ p[1]
    th_ p[2]
    ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
          x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    return(ll)
}

a_ nlm(fn,p=c(.9,.5),hes=T)
est_ a$est

phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
        1-pnbinom((max(kk)-1),est[1],est[2]))
E_ n*phat
chi2_ sum((x-E)^2/E)
cat('Chi2 goodness-of-fit = ',chi2,'\n')
cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


===========================================
At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
>Yudi,
>
>Thanks for this:
>
>>x_ c(70, 38, 17, 10,  9, 6) 
>>kk_ 0:5
>>n_ sum(x)
>>
>>fn_ function(p){
>>    r_ p[1]
>>    th_ p[2]
>>    ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
>>          x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
>>    return(ll)
>>}
>>
>>a_ nlm(fn,p=c(.9,.5),hes=T)
>>est_ a$est
>>
>>phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
>>        1-pnbinom((max(kk)-1),est[1],est[2]))
>>E_ n*phat
>>chi2_ sum((x-E)^2/E)
>>cat('Chi2 goodness-of-fit = ',chi2,'\n')
>>cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
>>
>>print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
>
>It is certainly more elegant than anything I would have come up with but
>I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
>
>        Warning messages: 
>        1: NA/Inf replaced by maximum positive value 
>        2: NA/Inf replaced by maximum positive value 
>        3: NA/Inf replaced by maximum positive value 
>        4: NA/Inf replaced by maximum positive value 
>        5: NA/Inf replaced by maximum positive value 
>        6: NA/Inf replaced by maximum positive value 
>        7: NA/Inf replaced by maximum positive value 
>        8: NA/Inf replaced by maximum positive value 
>
>est holds the starting parameters:
>
>        [1] 0.9 0.5
>
>E (from n*phat) holds:
>
>        [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
>
>which gives a very big chi-square.
>
>Sorry to be a nuisance.
>
>Mark
>
>
>--
>Mark Myatt
>
>
>
Yudi Pawitan     yudi@stat.ucc.ie
Department of Statistics UCC
Cork, Ireland
Ph   353-21-490 2906
Fax 353-21-427 1040 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Thu Feb  8 19:17:20 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Thu, 8 Feb 2001 11:17:20 -0800 (PST)
Subject: [Rd] Re: [R] What is R?
In-Reply-To: <3A82ED1A.E2505E42@Kuonen.com>
Message-ID: <Pine.A41.4.21.0102081105420.191392-100000@homer40.u.washington.edu>

On Thu, 8 Feb 2001, Diego Kuonen wrote:

> Dear all
> 
> there's something. that puzzles me about what R is :-)
> 
>    "R is available as Free Software under the terms of the Free 
>     Software Foundation's GNU General Public License in source 
>     code form."
> 
> (Source: http://www.r-project.org/about.html)
> 
> But, looking at the second paragraph of the same site, you
> see this:
> 
>    "... and R provides an Open Source route to participation in
>     that activity."
> 
> As we all know the term "open source" means something close 
> (but not identical) to "free software". 
> 
> So, what is R?
> 
> It clearly seems to be "free software" and not only "open source" 
> software, or?


R is Open Source software in that it's license complies with the OSI
definition. It is "free software" by the Debian and Free Software
Foundation definitions, and is official GNU software.  No problems
here. 

As Richard Stallman and Eric Raymond (among others) have pointed out,
the difference between these concepts is one of philosophical and
marketing emphasis. The R developers, as far as I know, have no unified
view on "open source" vs "free", nor do they need one. 


	-thomas


Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Feb  9 07:59:01 2001
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 9 Feb 2001 08:59:01 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102090759.IAA25635@pubhealth.ku.dk>

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu> writes:

    TL> This came up on r-help but indicates a bug.

    TL> dnbinom(x,n,p) calls dbinom_raw(n-1,...)
    TL> which returns 0 for n<1.

Actually for all  non-integer n.

This is now fixed for "R-release" aka "R-patched" aka "R 1.2.2 to be" :

--- src/nmath/dnbinom.c.~6~	Wed Jan 24 18:02:07 2001
+++ src/nmath/dnbinom.c	Fri Feb  9 08:37:14 2001
@@ -47,6 +47,12 @@
     if (x < 0 || !R_FINITE(x)) return R_D__0;
     x = R_D_forceint(x);
 
+    if(R_D_nonint(n)) {
+	return R_D_exp(lfastchoose(x + n - 1, x)
+		       + n * log(p) + x * log(1 - p));
+    } 
+    else { /* n is integer */
     prob = dbinom_raw(n-1,n+x-1,p,1-p,give_log);
     return((give_log) ? log(p) + prob : p*prob);
+    }
 }


Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><


    TL> ---------- Forwarded message ----------
    TL> Date: Thu, 08 Feb 2001 17:10:23 +0000
    TL> From: Yudi Pawitan <yudi@stat.ucc.ie>
    TL> To: Mark Myatt <mark@myatt.demon.co.uk>
    TL> Cc: R-Help <r-help@stat.math.ethz.ch>
    TL> Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

    TL> Sorry, Mark, the program worked for Rw1011, but this is
    TL> what happened in Rw1021:

    >> dnbinom(0:5,.9,.4)  
    TL> [1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

    TL> while, the correct result from Rw1011 is:
    >> dnbinom(0:5,.9,.4)
    TL> [1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

    TL> I have added a corrected dnbinom() below, which makes the program
    TL> works  for Rw1021.

    TL> -YP-

    TL> x_ c(70, 38, 17, 10,  9, 6) 
    TL> kk_ 0:5
    TL> n_ sum(x)

    TL> dnbinom_ function(x,n,p){
    TL> gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
    TL> }

    TL> fn_ function(p){
    TL> r_ p[1]
    TL> th_ p[2]
    TL> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    TL> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    TL> return(ll)
    TL> }

    TL> a_ nlm(fn,p=c(.9,.5),hes=T)
    TL> est_ a$est

    TL> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    TL> 1-pnbinom((max(kk)-1),est[1],est[2]))
    TL> E_ n*phat
    TL> chi2_ sum((x-E)^2/E)
    TL> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    TL> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

    TL> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


    TL> ===========================================
    TL> At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
    >> Yudi,
    >> 
    >> Thanks for this:
    >> 
    >>> x_ c(70, 38, 17, 10,  9, 6) 
    >>> kk_ 0:5
    >>> n_ sum(x)
    >>> 
    >>> fn_ function(p){
    >>> r_ p[1]
    >>> th_ p[2]
    >>> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    >>> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    >>> return(ll)
    >>> }
    >>> 
    >>> a_ nlm(fn,p=c(.9,.5),hes=T)
    >>> est_ a$est
    >>> 
    >>> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    >>> 1-pnbinom((max(kk)-1),est[1],est[2]))
    >>> E_ n*phat
    >>> chi2_ sum((x-E)^2/E)
    >>> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    >>> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
    >>> 
    >>> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
    >> 
    >> It is certainly more elegant than anything I would have come up with but
    >> I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
    >> 
    >> Warning messages: 
    >> 1: NA/Inf replaced by maximum positive value 
    >> 2: NA/Inf replaced by maximum positive value 
    >> 3: NA/Inf replaced by maximum positive value 
    >> 4: NA/Inf replaced by maximum positive value 
    >> 5: NA/Inf replaced by maximum positive value 
    >> 6: NA/Inf replaced by maximum positive value 
    >> 7: NA/Inf replaced by maximum positive value 
    >> 8: NA/Inf replaced by maximum positive value 
    >> 
    >> est holds the starting parameters:
    >> 
    >> [1] 0.9 0.5
    >> 
    >> E (from n*phat) holds:
    >> 
    >> [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
    >> 
    >> which gives a very big chi-square.
    >> 
    >> Sorry to be a nuisance.
    >> 
    >> Mark
    >> 
    >> 
    >> --
    >> Mark Myatt
    >> 
    >> 
    >> 
    TL> Yudi Pawitan     yudi@stat.ucc.ie
    TL> Department of Statistics UCC
    TL> Cork, Ireland
    TL> Ph   353-21-490 2906
    TL> Fax 353-21-427 1040 
    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Feb  9 08:08:58 2001
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 9 Feb 2001 09:08:58 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102090808.JAA25876@pubhealth.ku.dk>

       
>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu> writes:
    TL> This came up on r-help but indicates a bug.

    TL> dnbinom(x,n,p) calls dbinom_raw(n-1,...)
    TL> which returns 0 for n<1.

  MM> Actually for all  non-integer n.

wrong, Martin!

Thomas was right:  
       dbinom_raw(m, *)		
       seems fine for non-negative non-integers m.

    MM> This is now fixed for "R-release" aka "R-patched" aka "R 1.2.2 to be" :

    MM> --- src/nmath/dnbinom.c.~6~	Wed Jan 24 18:02:07 2001
    MM> +++ src/nmath/dnbinom.c	Fri Feb  9 08:37:14 2001
    MM> @@ -47,6 +47,12 @@
    MM> if (x < 0 || !R_FINITE(x)) return R_D__0;
    MM> x = R_D_forceint(x);
 
    MM> +    if(R_D_nonint(n)) {
    MM> +	return R_D_exp(lfastchoose(x + n - 1, x)
    MM> +		       + n * log(p) + x * log(1 - p));
    MM> +    } 
    MM> +    else { /* n is integer */
    MM> prob = dbinom_raw(n-1,n+x-1,p,1-p,give_log);
    MM> return((give_log) ? log(p) + prob : p*prob);
    MM> +    }
    MM> }

The above fix reverts to pre R 1.2.0 behaviour 
for non-integer `n' (in C; `size' in R) which is `first order ok',
but far from optimal.

The real solution must be better,
and should be done along the code (see comments!) in dbeta.c.

I won't have time to look at this for the next time though.

    MM> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
    MM> Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
    MM> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
    MM> phone: x-41-1-632-3408		fax: ...-1228			<><


    TL> ---------- Forwarded message ----------
    TL> Date: Thu, 08 Feb 2001 17:10:23 +0000
    TL> From: Yudi Pawitan <yudi@stat.ucc.ie>
    TL> To: Mark Myatt <mark@myatt.demon.co.uk>
    TL> Cc: R-Help <r-help@stat.math.ethz.ch>
    TL> Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

    TL> Sorry, Mark, the program worked for Rw1011, but this is
    TL> what happened in Rw1021:

    >>> dnbinom(0:5,.9,.4)  
    TL> [1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

    TL> while, the correct result from Rw1011 is:
    >>> dnbinom(0:5,.9,.4)
    TL> [1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

    TL> I have added a corrected dnbinom() below, which makes the program
    TL> works  for Rw1021.

    TL> -YP-

    TL> x_ c(70, 38, 17, 10,  9, 6) 
    TL> kk_ 0:5
    TL> n_ sum(x)

    TL> dnbinom_ function(x,n,p){
    TL> gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
    TL> }

    TL> fn_ function(p){
    TL> r_ p[1]
    TL> th_ p[2]
    TL> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    TL> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    TL> return(ll)
    TL> }

    TL> a_ nlm(fn,p=c(.9,.5),hes=T)
    TL> est_ a$est

    TL> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    TL> 1-pnbinom((max(kk)-1),est[1],est[2]))
    TL> E_ n*phat
    TL> chi2_ sum((x-E)^2/E)
    TL> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    TL> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

    TL> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


    TL> ===========================================
    TL> At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
    >>> Yudi,
    >>> 
    >>> Thanks for this:
    >>> 
    >>>> x_ c(70, 38, 17, 10,  9, 6) 
    >>>> kk_ 0:5
    >>>> n_ sum(x)
    >>>> 
    >>>> fn_ function(p){
    >>>> r_ p[1]
    >>>> th_ p[2]
    >>>> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    >>>> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    >>>> return(ll)
    >>>> }
    >>>> 
    >>>> a_ nlm(fn,p=c(.9,.5),hes=T)
    >>>> est_ a$est
    >>>> 
    >>>> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    >>>> 1-pnbinom((max(kk)-1),est[1],est[2]))
    >>>> E_ n*phat
    >>>> chi2_ sum((x-E)^2/E)
    >>>> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    >>>> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
    >>>> 
    >>>> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
    >>> 
    >>> It is certainly more elegant than anything I would have come up with but
    >>> I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
    >>> 
    >>> Warning messages: 
    >>> 1: NA/Inf replaced by maximum positive value 
    >>> 2: NA/Inf replaced by maximum positive value 
    >>> 3: NA/Inf replaced by maximum positive value 
    >>> 4: NA/Inf replaced by maximum positive value 
    >>> 5: NA/Inf replaced by maximum positive value 
    >>> 6: NA/Inf replaced by maximum positive value 
    >>> 7: NA/Inf replaced by maximum positive value 
    >>> 8: NA/Inf replaced by maximum positive value 
    >>> 
    >>> est holds the starting parameters:
    >>> 
    >>> [1] 0.9 0.5
    >>> 
    >>> E (from n*phat) holds:
    >>> 
    >>> [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
    >>> 
    >>> which gives a very big chi-square.
    >>> 
    >>> Sorry to be a nuisance.
    >>> 
    >>> Mark
    >>> 
    >>> 
    >>> --
    >>> Mark Myatt
    >>> 
    >>> 
    >>> 
    TL> Yudi Pawitan     yudi@stat.ucc.ie
    TL> Department of Statistics UCC
    TL> Cork, Ireland
    TL> Ph   353-21-490 2906
    TL> Fax 353-21-427 1040 
    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

    MM> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    MM> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    MM> Send "info", "help", or "[un]subscribe"
    MM> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    MM> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Fri Feb  9 13:20:08 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Fri, 09 Feb 2001 14:20:08 +0100
Subject: [Rd] system command
Message-ID: <3A83EE88.67F639ED@univie.ac.at>

i am using
system
to call the external program csound.
csound does some output to stdout and some to stderr
system handles this differently on the different platforms.

on unix (i have solaris, but as far as i know it is the same on linux)
system("csound",intern=TRUE) redirects stdin into an R object, 
by still outputs stdout to the R window.
system("csound",intern=FALSE) (equivalent to system("csound"))
stdout and stderr go into the R window

Rterm
on win95
system("csound",intern=TRUE) redirects stdin and stderr into an R object
system("csound",intern=FALSE) (equivalent to system("csound"))
outputs everything

Rterm
on win2k
system("csound",intern=TRUE) redirects stdin and stderr into an R object
system("csound",intern=FALSE) (equivalent to system("csound"))
outputs everything
EXCEPT
once 
system("csound",intern=TRUE) has been done
and later one tries
system("csound",intern=FALSE)
stderr is lost completely.
going back to
system("csound",intern=TRUE)
redirects stderr again into the R object,
but stderr does not go to the screen any more
after intern=TRUE has been used once.


so we seem to have to problems:
1) different behavior of system on unix and win32k
2) problems with system and redirection on win32k.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Feb  9 14:28:58 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 9 Feb 2001 14:28:58 +0000 (GMT)
Subject: [Rd] system command
In-Reply-To: <3A83EE88.67F639ED@univie.ac.at>
Message-ID: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>

On Fri, 9 Feb 2001, Erich Neuwirth wrote:

> i am using
> system
> to call the external program csound.
> csound does some output to stdout and some to stderr
> system handles this differently on the different platforms.
>
> on unix (i have solaris, but as far as i know it is the same on linux)
> system("csound",intern=TRUE) redirects stdin into an R object,
> by still outputs stdout to the R window.

I *think* you mean redirect stdout, and sends stderr to the terminal
running R.

> system("csound",intern=FALSE) (equivalent to system("csound"))
> stdout and stderr go into the R window
>
> Rterm
> on win95
> system("csound",intern=TRUE) redirects stdin and stderr into an R object

Redirects stdout and stderr to the terminal running R?

> system("csound",intern=FALSE) (equivalent to system("csound"))
> outputs everything
>
> Rterm
> on win2k
> system("csound",intern=TRUE) redirects stdin and stderr into an R object
> system("csound",intern=FALSE) (equivalent to system("csound"))
> outputs everything
> EXCEPT
> once
> system("csound",intern=TRUE) has been done
> and later one tries
> system("csound",intern=FALSE)
> stderr is lost completely.
> going back to
> system("csound",intern=TRUE)
> redirects stderr again into the R object,
> but stderr does not go to the screen any more
> after intern=TRUE has been used once.
>
>
> so we seem to have to problems:
> 1) different behavior of system on unix and win32k

They are documented to be different!  Whether stdout and stderr are
different is OS-specific.  In particular, Windows consoles have no concept
of stdout.

> 2) problems with system and redirection on win32k.

A bug, almost certainly in Windows 2000 since this works as documented
under NT.   Guido?

But, the essence is that you cannot reasonably expect to use stderr from
a program run by a system() commands, and that applies to, say, Perl
as much as to R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Fri Feb  9 14:38:17 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Fri, 09 Feb 2001 15:38:17 +0100
Subject: [Rd] system command
References: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>
Message-ID: <3A8400D9.F1AB4A14@univie.ac.at>

you are right,
i was using stdin in places where i meant stdout.
stupido.
logically, just do a global replace stdin->stdout in my last message.

currently i am trying to convince the maintainer of csound to add a
command line switch
which switches of stderr output completely.

and i understand theat the unix version and the windows version are
different.
but it still makes sense that they behave as similar as possible
whenever possible.

the whole thing is caused by the fact that the current version of csound
writes to stderr in any case.

and system on unix puts the stderr output in the r console window
in any case. that is what surprises me.
alternatively, system could ignore stderr,
or have an option for ingoring stderr.



Prof Brian Ripley wrote:
> 
> On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> 
> > i am using
> > system
> > to call the external program csound.
> > csound does some output to stdout and some to stderr
> > system handles this differently on the different platforms.
> >
> > on unix (i have solaris, but as far as i know it is the same on linux)
> > system("csound",intern=TRUE) redirects stdin into an R object,
> > by still outputs stdout to the R window.
> 
> I *think* you mean redirect stdout, and sends stderr to the terminal
> running R.
> 
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > stdout and stderr go into the R window
> >
> > Rterm
> > on win95
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> 
> Redirects stdout and stderr to the terminal running R?
> 
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> >
> > Rterm
> > on win2k
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> > EXCEPT
> > once
> > system("csound",intern=TRUE) has been done
> > and later one tries
> > system("csound",intern=FALSE)
> > stderr is lost completely.
> > going back to
> > system("csound",intern=TRUE)
> > redirects stderr again into the R object,
> > but stderr does not go to the screen any more
> > after intern=TRUE has been used once.
> >
> >
> > so we seem to have to problems:
> > 1) different behavior of system on unix and win32k
> 
> They are documented to be different!  Whether stdout and stderr are
> different is OS-specific.  In particular, Windows consoles have no concept
> of stdout.
> 
> > 2) problems with system and redirection on win32k.
> 
> A bug, almost certainly in Windows 2000 since this works as documented
> under NT.   Guido?
> 
> But, the essence is that you cannot reasonably expect to use stderr from
> a program run by a system() commands, and that applies to, say, Perl
> as much as to R.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bwheeler@echip.com  Fri Feb  9 17:36:45 2001
From: bwheeler@echip.com (bwheeler@echip.com)
Date: Fri, 9 Feb 2001 18:36:45 +0100 (MET)
Subject: [Rd] Minor doc bug (PR#843)
Message-ID: <200102091736.SAA07613@pubhealth.ku.dk>

In the doc for split, the factor g is unordered,
so the illustrative code

x <- rnorm(n * nn) + sqrt(codes(g))

should be

x <- rnorm(n * nn) + sqrt(as.numeric(g))


-- 
Bob Wheeler --- (Reply to: bwheeler@echip.com)
        ECHIP, Inc. --- (302) 239-6620, voice and
FAX
           724 Yorklyn Rd., Hockessin, DE 19707
              Randomness comes in bunches

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From David James <dj@research.bell-labs.com>  Fri Feb  9 18:24:50 2001
From: David James <dj@research.bell-labs.com> (David James)
Date: Fri, 9 Feb 2001 13:24:50 -0500 (EST)
Subject: [Rd] tabular data (was RE: [R] Removing "row.names")
Message-ID: <200102091824.NAA03028@jessie.research.bell-labs.com>

Hi,

I agree that replacing data.frames for modeling functions would 
be too painful.  Also I agree with Thomas that new class(es) for 
tabular data should not inherit from data.frame, and that data.frames 
should conceptually inherit from some other base tabular data class.  

At this point I'm not suggesting anything in concrete --- I haven't 
sorted it out in my own mind --- but I want to point out that (1) we
already have several tabular data clasess (not one), including matrices,
arrays, contingency tables, data.frames, etc.;  and that (2) I feel we'll 
need to address some of the problems we get into when we use data.frames 
inappropriately due to lack of other/better data structures. But I 
don't think that one single class can truthfully and completely represent 
all "tabular data".

For instance, interfaces to XML, spreadsheets, DBMS, etc., will further 
expose some of the limitations of these existing objects.  
Tables holding data from relational DBMS are an easy case: this class 
should preserve the original data as much as possible, i.e., no coercing 
into factors, no changing column names, no row names, but otherwise 
very similar to data.frames.  (Timothy Keitt has a more interesting concept 
of "proxyTables" that presents some very interesting issues: should 
proxyTables, which "point" to remote relations in dbms, allow integer 
indexing? --- the relational database model does not support it)

Is there something common to all these objects?  Obviously they all 
support indexing x[i,j, ...] plus the methods dim() and (possibly
NULL) dimnames().  S4 defines vectors as a (virtual) class in 
terms of the indexing operation in exactly this way -- thus in S4 lists 
are vectors, and so are logicals, characters, etc.  We may be able to
group the various "tabular data" classes under such virtual class,
and provide simple coercion facilities so that users can easily
fit, say, a linear model to data coming as an XML document or
in a table stored in a dbms.

David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636
----------------------------------------------------------------------------
> From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> MIME-Version: 1.0
> Content-Transfer-Encoding: 7bit
> Date: Thu, 8 Feb 2001 14:41:03 +0100
> To: David James <dj@research.bell-labs.com>
> Cc: Kurt.Hornik@ci.tuwien.ac.at, tlumley@u.washington.edu, 
p.dalgaard@biostat.ku.dk, R-devel@r-project.org
> Subject: Re: [Rd] RE: [R] Removing "row.names"
> 
> >>>>> David James writes:
> 
> >> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
> >> From: Thomas Lumley <tlumley@u.washington.edu>
> >> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> >> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
> >> Subject: Re: [Rd] RE: [R] Removing "row.names"
> >> MIME-Version: 1.0
> >> 
> >> On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> 
> >> > >>>>> Thomas Lumley writes:
> >> > 
> >> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> > >> >>>>> Peter Dalgaard BSA writes:
> >> > >> 
> >> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> > >> >> names(sampled) <- " "
> >> > >> >> and
> >> > >> >> dimnames(sampled)[[2]] <- " "
> >> > >> >> 
> >> > >> >> happily introduce non-unique variable names in the data frame.
> >> > >> >> 
> >> > >> >> Is the rule that row.names and names must be unique still on?
> >> > >> >> 
> >> > >> >> Argh ...
> >> > >> 
> >> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> >> > >> > following curious result:
> >> > >> 
> >> > >> >> d <- data.frame(a=1:3,b=4:6)
> >> > >> >> names(d)<-c(" "," ")
> >> > >> >> d
> >> > >> 
> >> > >> > 1 1 4
> >> > >> > 2 2 5
> >> > >> > 3 3 6
> >> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
> >> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be 
unique
> >> > >> > Dumped
> >> > >> 
> >> > >> > R dispatches similarly, but doesn't check the dimnames in
> >> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> >> > >> 
> >> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> >> > >> 
> >> > >> > at the appropriate spot.
> >> > >> 
> >> > >> Thomas' view about what should be permitted seems to be different.
> >> > 
> >> > > I wouldn't object to making it hard to create duplicated names(), but
> >> > > I think it would be a bad idea to have data.frame() make up unique
> >> > > names if it's given non-unique ones.
> >> > 
> >> > Maybe `check.names' could also be used for uniqueness testing?
> >> > 
> >> > In any case, I think we should specify what *exactly* a data frame is.
> >> >
> >> 
> >> I think we should specify, and check.names is a logical way to
> >> allow/forbid non-unique columns.  
> >> 
> >> Having a new class would be messy: logically it shouldn't inherit from
> >> data.frame, data.frame should inherit from it, but that would be a real
> >> pain to set up.
> >> 
> 
> > Data frames were originally meant to be used in modeling functions.
> > The opening paragraph in Chapter 3 (Data for Models) in the White Book
> > says:
>  
> >   "This chapter describes the general structure for data that
> >   will be used throughout the book.  In particular, it introduces the
> >   data frame, a class of objects to represent the data typically encounterd  
> >   in fitting models."
> 
> > However, data.frames may not be quite appropriate for representing
> > other types of tabular data (certainly a data.frame does not capture
> > the essence of, say, a "relational" table in the SQL sense, which
> > doesn't have the concept of row names).  Several manifestations of
> > this problem are coercing character data to factors "at the drop of a
> > hat" (as someone wrote here or in s-news), the row.names issue now
> > being discussed, problems including general objets in the "cells" of
> > the data.frame, etc.
> 
> > I think that the concept of a data.frame to represent data for fitting
> > models is fine, but we may (certainly I) have abused this concept.  We
> > need other classes of tabular data objects in addition (not as a
> > replacement) to data.frames, together with coercion methods and
> > perhaps other utilities.
> 
> Thomas had said that yes it would be nice to have something with less
> restrictions for modeling, but that it was uneconomical at least to
> introduce a new class that data.frame would then inherit from.
> 
> I interpret your comment as suggesting that we introduce a new class for
> holding tabular data?  Do you have specific ideas on this?
> 
> -k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Feb  9 21:05:44 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 09 Feb 2001 16:05:44 -0500
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Peter Dalgaard BSA's message of "03 Feb 2001 21:05:06 +0100"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>
 <x2n1c3353h.fsf@blueberry.kubism.ku.dk>
Message-ID: <px1yt7efdj.fsf@infiniti.ece.cmu.edu>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Thomas Vogels <tov@ece.cmu.edu> writes:
> 
> > Hi,
> > 
> > I've been playing with the tcltk package.  It's very nice to have
> > access to buttons, menus etc. now.  Thank you!
> > 
> > Alas, I also have questions: In Tcl everything is a string [*].  This
> > is not the case in R, of course.  So why are return values of tk
> > commands still strings?  (Is there any other reason than speed or
> > "package is work in progress"?)
> 
> The latter. Also to some extent the fact that it requires more
> knowledge about the content of the return value. The argument passing
> scheme is as you can see quite general and essentially ignorant of the
> routines that are called. In essence the issue is that it is fairly
> easy to convert whatever to strings, but harder the other way around.
> So for the first iteration of the package, the idea would be to have
> the user do the necessary as.xxx conversions of return values.

Requiring the user to do the "type casting" will make the user's code
larger and will make it harder to adopt the package.  It would be nice
if the information would "flow more easily" to the programmer.  I
don't want to have to use more as.whatever than I have to in other
functions.

> > One problem is that the number of functions just explodes, so it might
> > be better to wrap them into one enchillada?
> > 
> >   >  tkwinfo <- function (widget, what="exists", ...) 
> >      switch (what,
> >              exists=tkcmd("winfo", "exists", widget)=="1",
> >              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
> >              width=as.numeric (tkcmd("winfo", "width", widget)),
> >              height=as.numeric (tkcmd("winfo", "height", widget)),
> >              tkcmd ("winfo", what, widget, ...))
> > 
> > (The other problem is that tkcmd("winfo",...) may fail.)

OK, instead of going for enchilladas, how about burritos:

For a graphics device, I would use
  > par("xaxp")  # to obtain values
  [1]  2 10  4
  > par (xaxp=c(2,10,4))  # to set values

Wouldn't something similar to this effect simplify the api and reduce
the number of commands in the package (vastly)?

1) Why not

  > tt<-tktoplevel()
  > button <- tkbutton(tt, text="Push", command=function()cat("Ouch\n"))
  > tkpar (button, c("text", "command"))
  $text
  [1]  "Push"

  $command
  [1] " R_call 0xbfeb1c "

  > tkpar (button, text="Yow!", command=function()cat("Yow\n"))

instead of:

  > tkcget (button, "-text")  # (hmm, shouldn't need '-' here!)
  [1] "b"
  > tkcget (button, "-command")  # (again, why '-command'?)
  [1] " R_call 0xbfeb1c "
  > tkconfigure (button, text="Yow!", command=function()cat("Yow\n"))
  [1] ""
  > # Doesn't return previous value...

This examples applies to a bunch of command pairs, like
cget/configure, itemcget/itemconfigure, imagecget/imageconfigure,
entrycget/entryconfigure, window.cget/window.configure, ...

2) Why not:

  > tt <- tktoplevel()
  > tkwm (tt, "minwidth")  # returns integers not strings
  [1] 1 1
  > tkwm (tt, minwidth=c(100,100))  # sets new values

instead of:

  > tkwm.minsize (tt)
  [1] "1 1"
  > tkwm.minsize (tt, "100","100")
  [1] ""

The second example would wipe out 25 or so tkwm.* commands to be
replaced by one tkwm.  (Same would apply for tkwinfo...)  Wouldn't
that also simplify maintenance and documentation?

Does this make sense?  Or does it sound like I've been smoking my corn
flakes instead of eating them?  Is anybody else using the package
tcltk and would it make sense to put some code behind those
suggestions?

Thanks,
  -tom


> > Oh, while I'm at it:  There is no tkupdate:
> >   >  tkupdate <- function (idletasks=FALSE)
> >      if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")
> > 
> > (which is essential to making sure that a window is mapped before its
> > width or height is queried.)  That's trivial if you have hacked Tcl/Tk
> > before -- so who is the package tlctk aimed at?
> 
> Tcl/Tk hackers of course, the author of the package not being one...
> 
> Basically, the plan is to add stuff as it becomes necessary to do
> useful things, so feedback and suggestions from developers are always
> welcome.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pperkins@ucsd.edu  Fri Feb  9 22:04:43 2001
From: pperkins@ucsd.edu (pperkins@ucsd.edu)
Date: Fri, 9 Feb 2001 23:04:43 +0100 (MET)
Subject: [Rd] default data= arg to glm() (PR#844)
Message-ID: <200102092204.XAA08400@pubhealth.ku.dk>

Full_Name: Peter Perkins
Version: 1.2.1
OS: LinuxPPC
Submission from: (NULL) (24.4.89.36)


the lines

   if (missing(data)) 
      data <- environment(formula)

in glm() seem to contradict the documentaton:

   data: an optional data frame containing the variables in the model.
         By default the variables are taken from the environment from
         which `glm' is called.

actually, the near lack of other references to "data" is glm() is not
clear to me, so i may have this wrong.  but a small test seems to bear
out the problem:

function () 
{
	form <- y ~ x
	fun1 <- function(f)
	{
		n <- 10
		x <- runif(n, 1, 10)
		y <- rpois(n, x)
		glm(f, family=poisson(link="log"), data=environment())
	}
	fun2 <- function(f)
	{
		n <- 10
		x <- runif(n, 1, 10)
		y <- rpois(n, x)
		glm(f, family=poisson(link="log"))
	}
	print("fit1")
	print(fun1(form)$call)
	print("fit2")
	print(fun2(form)$call)
}

> test()
[1] "fit1"
glm(formula = f, family = poisson(link = "log"), data = environment())
[1] "fit2"
Error in eval(expr, envir, enclos) : Object "y" not found


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb  9 22:57:19 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Fri, 9 Feb 2001 14:57:19 -0800 (PST)
Subject: [Rd] default data= arg to glm() (PR#844)
In-Reply-To: <200102092204.XAA08400@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0102091417100.82220-100000@homer27.u.washington.edu>

On Fri, 9 Feb 2001 pperkins@ucsd.edu wrote:
> 
> the lines
> 
>    if (missing(data)) 
>       data <- environment(formula)
> 
> in glm() seem to contradict the documentaton:
> 
>    data: an optional data frame containing the variables in the model.
>          By default the variables are taken from the environment from
>          which `glm' is called.
> 
> actually, the near lack of other references to "data" is glm() is not
> clear to me, so i may have this wrong.  but a small test seems to bear
> out the problem:

The documentation is slightly out of date.  The current behaviour is that
the variables are taken from the environment in which the model formula is
defined. This will usually, but not always, be the same thing. This
behaviour is new in 1.2.0, and is designed to give functions like
predict() and update() a fighting chance.

However, the line you quote is in fact irrelevant to this. The
variable `data' that it modifies is not used in fitting the model, it is
just returned as part of the result. So, you ask, if the `data' variable
is never used, how is it used?

This is Deep Magic, and probably worth explaining.
A copy of the call to glm() (or other modelling functions) is grabbed by
match.call() and turned into a call to model.frame(). This call is then
evaluated in the parent environment to create a model frame. The
model.matrix() function is then called to create a design matrix from the
model frame.

This is how we fake dynamic scope -- using the values of variables in the
parent environment --  in a language that really has static scope. 

The moral of this is that it pays to put the variables you want to use in
a data frame. It's much easier to find them that way than by playing
clever games with environments.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Sat Feb 10 01:50:13 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 10 Feb 2001 02:50:13 +0100
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Thomas Vogels's message of "09 Feb 2001 16:05:44 -0500"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu> <x2n1c3353h.fsf@blueberry.kubism.ku.dk> <px1yt7efdj.fsf@infiniti.ece.cmu.edu>
Message-ID: <x2ofwbl31m.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@ece.cmu.edu> writes:

> > The latter. Also to some extent the fact that it requires more
> > knowledge about the content of the return value. The argument passing
> > scheme is as you can see quite general and essentially ignorant of the
> > routines that are called. In essence the issue is that it is fairly
> > easy to convert whatever to strings, but harder the other way around.
> > So for the first iteration of the package, the idea would be to have
> > the user do the necessary as.xxx conversions of return values.
> 
> Requiring the user to do the "type casting" will make the user's code
> larger and will make it harder to adopt the package.  It would be nice
> if the information would "flow more easily" to the programmer.  I
> don't want to have to use more as.whatever than I have to in other
> functions.

Sure, but it requires more detailed study of what the query-type
functions do, and what values they return.

> > > One problem is that the number of functions just explodes, so it might
> > > be better to wrap them into one enchillada?
> > > 
> > >   >  tkwinfo <- function (widget, what="exists", ...) 
> > >      switch (what,
> > >              exists=tkcmd("winfo", "exists", widget)=="1",
> > >              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
> > >              width=as.numeric (tkcmd("winfo", "width", widget)),
> > >              height=as.numeric (tkcmd("winfo", "height", widget)),
> > >              tkcmd ("winfo", what, widget, ...))
> > > 
> > > (The other problem is that tkcmd("winfo",...) may fail.)
> 
> OK, instead of going for enchilladas, how about burritos:
> 
> For a graphics device, I would use
>   > par("xaxp")  # to obtain values
>   [1]  2 10  4
>   > par (xaxp=c(2,10,4))  # to set values
> 
> Wouldn't something similar to this effect simplify the api and reduce
> the number of commands in the package (vastly)?
> 
> 1) Why not
> 
>   > tt<-tktoplevel()
>   > button <- tkbutton(tt, text="Push", command=function()cat("Ouch\n"))
>   > tkpar (button, c("text", "command"))
>   $text
>   [1]  "Push"
> 
>   $command
>   [1] " R_call 0xbfeb1c "

>   > tkpar (button, text="Yow!", command=function()cat("Yow\n"))
> 
> instead of:
> 
>   > tkcget (button, "-text")  # (hmm, shouldn't need '-' here!)
>   [1] "b"
>   > tkcget (button, "-command")  # (again, why '-command'?)
>   [1] " R_call 0xbfeb1c "

Actually, I think tkcget(button, text=NULL) is the convention for
argument-less options. The " R_call 0xbfeb1c " is wrong in either
case: It really should return the R object sitting at the address
0xbfeb1c, reversing .Tcl.callback. 

Not sure that I would want to go the tkpar() route. If I were moving
away from the direct correspondence between the R and Tcl side of the
fence I'd probably rather overload the $ $<- [[ [[<- set of operators
and have stuff like

> button$text
[1]  "Push"
> button$command
function()cat("Ouch\n")
<environment: 0x8b4641c>
> button$text<-"Pull"

and so forth. I sort of started along a similar path with the
tktitle()/tktitle()<- mechanism, but stopped as it seemed to be
getting excessive to complete this mechanism for all commands.

>   > tkconfigure (button, text="Yow!", command=function()cat("Yow\n"))
>   [1] ""
>   > # Doesn't return previous value...
> 
> This examples applies to a bunch of command pairs, like
> cget/configure, itemcget/itemconfigure, imagecget/imageconfigure,
> entrycget/entryconfigure, window.cget/window.configure, ...
> 
> 2) Why not:
> 
>   > tt <- tktoplevel()
>   > tkwm (tt, "minwidth")  # returns integers not strings
>   [1] 1 1
>   > tkwm (tt, minwidth=c(100,100))  # sets new values
> 
> instead of:
> 
>   > tkwm.minsize (tt)
>   [1] "1 1"
>   > tkwm.minsize (tt, "100","100")
>   [1] ""
> 
> The second example would wipe out 25 or so tkwm.* commands to be
> replaced by one tkwm.  (Same would apply for tkwinfo...)  Wouldn't
> that also simplify maintenance and documentation?

Nope. I'm not necessarily saying that it might not be a good idea, but
introducing command-dependent option handling is not going to simplify
the documentation. Explaining why tkwm (tt, minsize=c(100,100))
doesn't come across as "wm .1 -minsize 100 100" but as "wm minsize .1
100 100" would be tricky to explain. In this case, the changed syntax
doesn't actually save you anything anyway.
 
> Does this make sense?  Or does it sound like I've been smoking my corn
> flakes instead of eating them?  Is anybody else using the package
> tcltk and would it make sense to put some code behind those
> suggestions?

We have the occasional report from people using the package. My guess
is that it gets used for fairly simplistic things similar to the
demos. In a slightly longer perspective, I'd like to see a more
elaborate user interface prototype emerge from it. The package
certainly needs further development, and in particular the return
value handling needs some sort of fixing up. 

I still think it is useful to keep some sort of unifying perspective
on the whole thing, and I do think it is useful - at least for now -
to try and maintain some of the transparency between the R functions
and the corresponding Tcl commands.

If you want to start writing code, it might be useful to attack the
cget-style functions first. It might be nice if they could vector to a
(say) tkquery function which could be supplied with a table of return
types by option.

One possible gotcha is that the list of options is really widget
specific, and I'm not quite sure that it cannot happen that the same
option name corresponds to different value types in different widgets.

The set of valid options is certainly widget dependent (i.e. you
cannot have tkcget(radiobutton, xscrollIncrement=NULL) for instance),
and the full set of options is reall unspecified if you start thinking
of imported megawidgets and soforth. 

Hmmm.... I think you need to store the list of options with the
widgets or their class somehow, so you'd soon be on the way to a true
object system.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Sun Feb 11 10:54:28 2001
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Sun, 11 Feb 2001 11:54:28 +0100
Subject: [Rd] system command
In-Reply-To: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>; from ripley@stats.ox.ac.uk on Fri, Feb 09, 2001 at 02:28:58PM +0000
References: <3A83EE88.67F639ED@univie.ac.at> <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>
Message-ID: <20010211115428.A20548@sirio.stat.unipd.it>

On Fri, Feb 09, 2001 at 02:28:58PM +0000, Prof Brian Ripley wrote:
> On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> > ...........................................................
> > Rterm
> > on win2k
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> > EXCEPT
> > once
> > system("csound",intern=TRUE) has been done
> > and later one tries
> > system("csound",intern=FALSE)
> > stderr is lost completely.
> > going back to
> > system("csound",intern=TRUE)
> > redirects stderr again into the R object,
> > but stderr does not go to the screen any more
> > after intern=TRUE has been used once.
> >
> > .....................................................................
> > 2) problems with system and redirection on win32k.
> 
> A bug, almost certainly in Windows 2000 since this works as documented
> under NT.   Guido?

  I can replicate the problem (under Windows 2000 but not under
  Win98 or NT) using
  > system("ls",intern=TRUE);system("ls")
  I will take a look.

  guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Sun Feb 11 11:48:54 2001
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Sun, 11 Feb 2001 12:48:54 +0100
Subject: [Rd] system command
In-Reply-To: <20010211115428.A20548@sirio.stat.unipd.it>; from guido@sirio.stat.unipd.it on Sun, Feb 11, 2001 at 11:54:28AM +0100
References: <3A83EE88.67F639ED@univie.ac.at> <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats> <20010211115428.A20548@sirio.stat.unipd.it>
Message-ID: <20010211124854.A21040@sirio.stat.unipd.it>

On Sun, Feb 11, 2001 at 11:54:28AM +0100, Guido Masarotto wrote:
> On Fri, Feb 09, 2001 at 02:28:58PM +0000, Prof Brian Ripley wrote:
> > On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> > > .....................................................................
> > > 2) problems with system and redirection on win32k.
> > 
> > A bug, almost certainly in Windows 2000 since this works as documented
> > under NT.   Guido?
> 
>   I can replicate the problem (under Windows 2000 but not under
>   Win98 or NT) using
>   > system("ls",intern=TRUE);system("ls")
>   I will take a look.
> 


  Oops. After redirection (needed by system(...,intern=TRUE), Rterm's
  stdout was marked as not inheritable. 
  I have committed a fix for 1.2.2.
  guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From patrick.lindsey@luc.ac.be  Sun Feb 11 13:53:09 2001
From: patrick.lindsey@luc.ac.be (patrick.lindsey@luc.ac.be)
Date: Sun, 11 Feb 2001 14:53:09 +0100 (MET)
Subject: [Rd] Bug in pictex output. (PR#845)
Message-ID: <200102111353.OAA12746@pubhealth.ku.dk>

Hi everyone,
  I have just received a bug from one of my students. It concerns the pictex
command to produce plots in latex format. It seems to add lines on the graph
even in the most simplest cases. For example, try the following quadratic
curve:
plot(1:11,(-5:5)^2,type="b",main="Simple Example Plot")
Now, saving the plot with the following command:
pictex("plot.tex")
plot(1:11,(-5:5)^2,type="b",main="Simple Example Plot")
dev.off()
and then latex the file using the example in the help page as
\documentclass{article}
\begin{document}
\begin{figure}[h]
\centerline{\input{plots.tex}}
\end{figure}
\end{document}
produces a plot with an additional line (a diagonal line going all the way
through the plot from bottom left to top right). The error occurs on line
78 (out of 87) produced by pictex. Removing that latex command from the file
(or commenting it out) corrects the problem in this case... but looking
closer to how the axis are setup one can rapidely see that this is not done
very efficiently and could perhaps be simplified (there are 4 lines super-
imposing one another! just keeping the longest one would be enough). Hence,
perhaps something is wrong in the driver at the axis level...
As I said this problem was found by a student, as I use postscript to produce
my graphs I was just told that all plots produced with pictex produced similar
problems... but I don't know what happens in other cases than this simple
example I got from the student.
Hope this helps in fixing the problem.
Patrick.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tsumi@leo.auric.ne.jp  Sun Feb 11 14:28:55 2001
From: tsumi@leo.auric.ne.jp (Tsumiyama Isao)
Date: Sun, 11 Feb 2001 23:28:55 +0900
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102111433.PAA13691@stat.math.ethz.ch>

 Dear R users,
 
  I want to create a C program drawing a scatter plot
  with R functions.

Is it possible to do such a thing with interfaces declared
in 'Rgraphics.h'? If so, I would like to get sample C sources.

>From a user in Japan.

 Thanks,



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 11 16:49:28 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 11 Feb 2001 16:49:28 +0000 (GMT)
Subject: [Rd] Scatter plot calling R function from C
In-Reply-To: <200102111433.PAA13691@stat.math.ethz.ch>
Message-ID: <Pine.GSO.4.31.0102111644480.29747-100000@toucan.stats>

On Sun, 11 Feb 2001, Tsumiyama Isao wrote:

>  Dear R users,
>
>   I want to create a C program drawing a scatter plot
>   with R functions.
>
> Is it possible to do such a thing with interfaces declared
> in 'Rgraphics.h'? If so, I would like to get sample C sources.

Strictly no.  You would need to open an R graphics device, and you can't
do that from the publically declared headers.  And you would need to
handle all the error conditions that call back into R.

>From C code called from R you can write to an already opened graphics
device.  Alternatives, you can embed R in your C program and then call R
graphics via R calls.

I don't think there are many examples: Rgraphics.h was included for
use by experts writing addons.  Paul Murrell may be able to help more.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Mon Feb 12 01:27:18 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Mon, 12 Feb 2001 14:27:18 +1300
Subject: [Rd] Scatter plot calling R function from C
References: <Pine.GSO.4.31.0102111644480.29747-100000@toucan.stats>
Message-ID: <021301c09492$f32ad320$175dd882@stat.auckland.ac.nz>

Hi


> On Sun, 11 Feb 2001, Tsumiyama Isao wrote:
>
> >  Dear R users,
> >
> >   I want to create a C program drawing a scatter plot
> >   with R functions.
> >
> > Is it possible to do such a thing with interfaces declared
> > in 'Rgraphics.h'? If so, I would like to get sample C sources.
>
> Strictly no.  You would need to open an R graphics device, and you can't
> do that from the publically declared headers.  And you would need to
> handle all the error conditions that call back into R.
>
> From C code called from R you can write to an already opened graphics
> device.  Alternatives, you can embed R in your C program and then call R
> graphics via R calls.
>
> I don't think there are many examples: Rgraphics.h was included for
> use by experts writing addons.  Paul Murrell may be able to help more.


As Brian says, the first big obstacle is getting a device started, which can
only be done from R.  Once you have that, then all of the necessary graphics
is there in Rgraphics.h, but its at a very low level.  Rgraphics.h gives you
access to a basic graphics engine for drawing lines and rectangles and such,
plus some more complicated things like data symbols, but it does not have
anything really high level like a plot or even an axis.  You have to compose
these things yourself.

There are examples of how R uses these functions in R/src/main/plot.c, but
it would take a considerable effort to work out what is going on.

The functions Rgraphics.h exports are useful if you want to write your own
graphics system from the ground up, but they are not very useful if you want
to produce plots like the ones that R already produces.  If you want to do
the latter then you are much better to try the route suggested by Brian and
embed R in your C program so that you can call R's high-level graphics
functions.

Hope that helps

Paul






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Feb 12 15:47:45 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Feb 2001 16:47:45 +0100
Subject: [Rd] Re: tabular data (was RE: [R] Removing "row.names")
In-Reply-To: <200102091824.NAA03028@jessie.research.bell-labs.com>
References: <200102091824.NAA03028@jessie.research.bell-labs.com>
Message-ID: <14984.1441.181293.426501@mithrandir.hornik.net>

>>>>> David James writes:

> Hi,

> For instance, interfaces to XML, spreadsheets, DBMS, etc., will
> further expose some of the limitations of these existing objects.
> Tables holding data from relational DBMS are an easy case: this class
> should preserve the original data as much as possible, i.e., no
> coercing into factors, no changing column names, no row names, but
> otherwise very similar to data.frames.  (Timothy Keitt has a more
> interesting concept of "proxyTables" that presents some very
> interesting issues: should proxyTables, which "point" to remote
> relations in dbms, allow integer indexing? --- the relational database
> model does not support it)

> Is there something common to all these objects?  Obviously they all
> support indexing x[i,j, ...] plus the methods dim() and (possibly
> NULL) dimnames().  S4 defines vectors as a (virtual) class in terms of
> the indexing operation in exactly this way -- thus in S4 lists are
> vectors, and so are logicals, characters, etc.  We may be able to
> group the various "tabular data" classes under such virtual class, and
> provide simple coercion facilities so that users can easily fit, say,
> a linear model to data coming as an XML document or in a table stored
> in a dbms.

Maybe this is something to be kicked off at the official part of DSC and
discussed in the `r-core' part.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bwheeler@echip.com  Tue Feb 13 00:38:48 2001
From: bwheeler@echip.com (bwheeler@echip.com)
Date: Tue, 13 Feb 2001 01:38:48 +0100 (MET)
Subject: [Rd] Sticky levels (PR#846)
Message-ID: <200102130038.BAA29298@pubhealth.ku.dk>

This isn't actually a bug, but what is one to do
in cast of a typo?

> citizen<-factor(c("uk","as","no","au","uk","us","us"))
> levels(citizen)
[1] "as" "au" "no" "uk" "us"
> citizen[2]<-"us"
> citizen
[1] uk us no au uk us us
Levels:  as au no uk us    ** [STICKY "as"] **
> citizen[2]<-"gs"
Warning message: 
invalid factor level, NAs generated in:
[<-.factor(*tmp*, 2, value = "gs")

-- 
Bob Wheeler --- (Reply to: bwheeler@echip.com)
        ECHIP, Inc.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Tue Feb 13 00:44:58 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Mon, 12 Feb 2001 16:44:58 -0800 (PST)
Subject: [Rd] Sticky levels (PR#846)
In-Reply-To: <200102130038.BAA29298@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0102121642400.133498-100000@homer27.u.washington.edu>

On Tue, 13 Feb 2001 bwheeler@echip.com wrote:

> This isn't actually a bug, 

True. Perhaps R-bugs wasn't the best place for it initially?

>			but what is one to do
> in cast of a typo?
> 
> > citizen<-factor(c("uk","as","no","au","uk","us","us"))
> > levels(citizen)
> [1] "as" "au" "no" "uk" "us"
> > citizen[2]<-"us"

  citizen<-as.character(citizen)
  citizen[2]<-"us"
  citizen<-factor(citizen)

would do it. Yes, certain aspects of factors are a pain at times.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From cyg@sympatico.ca  Tue Feb 13 11:06:40 2001
From: cyg@sympatico.ca (Yves Gauvreau)
Date: Tue, 13 Feb 2001 06:06:40 -0500
Subject: [Rd] Documentation suggestion!
In-Reply-To: <Pine.GSO.4.31.0102130718110.9532-100000@auk.stats>
Message-ID: <NEBBJKDJHEFCOOLFFAKKOEOACAAA.cyg@sympatico.ca>

Hi,

Could I suggest that the documentation of "locator" and "identify" be
modified so that they refer to each other and that the "graphic" keyword be
added to "identify". If you think it's a good idea of course, I would even
volunteer to do it if you can point me to the procedure. (What file(s) would
have to be modified beside Rd files if any and what do I do with them
afterward.)

I'm making this suggestion because I had a hard time locating them
especially "identify". I vaguely recalled the functionality was implemented
but I had forgotten the function names. I got to "locator" using
help.search("graphic") and as for "identify" I had to remember the name
which I finally did.

While writing this I took a look at some .Rd files, at keywords and at
keywords.db which are located in D:\R-1.2.0\doc of the main *nix source and
I wonder if there is any kind of information on how the help system works?


Thanks

Yves Gauvreau
B.E.F.P. Universite du Quebec a Montreal
cyg@sympatico.ca

PS. I hope this is the right place to send this.

         _
platform i386-pc-mingw32
arch     x86
os       Win32
system   x86, Win32
status
major    1
minor    2.1
year     2001
month    01
day      15
language R

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Feb 13 11:17:09 2001
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 13 Feb 2001 12:17:09 +0100 (MET)
Subject: [Rd] RE: [R] silly question about spec (PR#847)
Message-ID: <200102131117.MAA04218@pubhealth.ku.dk>

On 14-Feb-01 Jason Turner wrote:
> I'm using spec for multivariate time series, and have a 
> question about "coh".  
> 
> This is probably a very silly question, but I'm a bit stumped.
> From the documentation: 
> 
> Column i + (j - 1) * (j - 2)/2 of coh contains the squared coherency 
> between columns i and j of x, where i > j.
> 
> What's in column 1 of coh?

Not a silly question, but a silly typo in the help page.  In fact the
formula is valid for i < j not i > j, so column 1 gives the squared
coherency between columns 1 and 2:

1 + (2 - 1) * (2 - 2)/2 = 1

Martyn

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Feb 13 11:35:53 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 13 Feb 2001 11:35:53 +0000 (GMT)
Subject: [Rd] Documentation suggestion!
Message-ID: <200102131135.LAA09098@toucan.stats.ox.ac.uk>

> From: "Yves Gauvreau" <cyg@sympatico.ca>
> Date: Tue, 13 Feb 2001 06:06:40 -0500

> Could I suggest that the documentation of "locator" and "identify" be
> modified so that they refer to each other 

That's easy, and done now.

> and that the "graphic" keyword be
> added to "identify". If you think it's a good idea of course, I would even
> volunteer to do it if you can point me to the procedure. (What file(s) would
> have to be modified beside Rd files if any and what do I do with them
> afterward.)

There is no `graphic' keyword.  locator and identify have keyword
`iplot', `Interacting with Plots'.  See below.

> I'm making this suggestion because I had a hard time locating them
> especially "identify". I vaguely recalled the functionality was implemented
> but I had forgotten the function names. I got to "locator" using
> help.search("graphic") and as for "identify" I had to remember the name
> which I finally did.

It took `graphic' from the title for locator, not the keyword.

> While writing this I took a look at some .Rd files, at keywords and at
> keywords.db which are located in D:\R-1.2.0\doc of the main *nix source and

[Actually, there is only one set of sources: it is the Windows source too.]

> I wonder if there is any kind of information on how the help system works?

Really there is not just one help system, but several.  The `keywords'
are a misnomer carried over from S3:  they are in fact categories used
by the HTML search system, and by help.search.  On Windows the CHTML
and WinHelp help systems have full-text-search by default, and we are
looking at ways of providing FTS and approximate matching on other platforms.

I think had you done a search under HTML help, it would have been more
obvious from the categories presented to you.  I would also commend
CHTML full-text searches to you.

We are aware that the help system could be improved, and I have already
suggested real keywords for a future version.


Another issue that is just as important is the contents of the help.  I
realised recently that the documentation for many of the basic graphics
operations is incomplete (they accept many more forms of input via
xy.coords, NAs can be used to break lines, polygons are supposed to be
automatically closed, and so on).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tsumi@leo.auric.ne.jp  Tue Feb 13 14:42:36 2001
From: tsumi@leo.auric.ne.jp (Tsumiyama Isao)
Date: Tue, 13 Feb 2001 23:42:36 +0900
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102131447.PAA17346@stat.math.ethz.ch>

Hi, R users.

Thank you for kind advices.
But I have an additional question about how to emded R in
C code.
Is it like 'Embeded  SQL'? Are there any libraries or interfaces
used to embed R in C code?

>From a R beginner in Japan, 


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Feb 13 15:02:25 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 13 Feb 2001 15:02:25 +0000 (GMT)
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102131502.PAA09385@toucan.stats.ox.ac.uk>


> From: "Tsumiyama Isao" <tsumi@leo.auric.ne.jp>
> Date: Tue, 13 Feb 2001 23:42:36 +0900
> 
> Hi, R users.
> 
> Thank you for kind advices.
> But I have an additional question about how to emded R in
> C code.
> Is it like 'Embeded  SQL'? Are there any libraries or interfaces
> used to embed R in C code?

It is not like Embedded SQL.  You need to tell us whether you want to
do this on Unix or Windows.  For the latter, it is easiest to
use the DCOM interface on CRAN.  For the former, you need to build
R as shared library, and see the outline instructions on the developer site.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Tue Feb 13 22:40:37 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Tue, 13 Feb 2001 23:40:37 +0100 (MET)
Subject: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
Message-ID: <200102132240.XAA10562@pubhealth.ku.dk>


Hi, there are two problems in devX11.c.  The one is an undocumented
nuisance and the other isn't a bug until you try to embed an X11
device in another window (think tktoplevel() in tcltk package...).

Let's take a look at locator() first: Assuming you call locator() with
a current X11 device, this call is handled in X11_Locator
(src/unix/X11/devX11.c).  When you have one window open and call
locator, you have three options to quit the locator: click Button 1
(to locate), click Button 2 (to abort), or destroy the window.  The
later results in the error message: "Error in locator(1) : No graphics
device is active". That's OK, sort of.

This gets problematic when you open two windows:
> x11()  # assume that's device 2
> x11()  # assume that's device 3
> plot(1)
> locator(1)  # with device 3 == dev.cur()!

When you now destroy device 3 (where locator expects the click), you have
*no alternative but to close _all_ windows* to abort the locator.  The
locator continues to wait for mouse clicks in device 3 where of course
no further clicks can come from.  That's the nuisance part.

The second problem is that the device may try to plot() into a
non-existant window.  Assume that the window was destroyed by some
other part of the program.  The device (at some point in the future)
will receive a DestroyNotify event that handleEvent ignores.
Blissfully!  *No KillDevice is called* when the window is destroyed by
something other than the WM_DELETE_WINDOW mechanism!  This happens
when you embed the X11 device into another window/application.  For
starters, the device no longer receives WM_DELETE_WINDOW client
messages.  But it does receive a DestroyNotify event when the parent
(the container window) is destroyed.  HandleEvent should, well
_handle_ this _event_.

The patch below is a _suggestion_ how to solve both problems.  It is
against the current r-devel, 1.3, as of 2/13.  I believe this behavior
exists in version 1.2 as well and can be solved there the same way.
The patch is just meant as a convenient and concise way to describe
my suggestion.  I'd greatly appreciate feedback or other ideas!

Implementation:

-- the variable inclose is now in the device specific structure (why
   was it global?)  After the window is mapped, inclose is TRUE until
   the window is destroyed explicitly or a DestroyNotify event has been
   received.
-- the deviceSpecific pointer is set to NULL after the memory has been
   freed. This (side?) effect is used in X11_Locator to detect the
   closing of the current device  which _must_ lead to an error.
-- the if statement to handle events of type DestroyEvent is added to 
   handleEvent
-- when the user closes the device (dev.off()), the window is
   destroyed in X11_Close
-- when the user pushes the close button in the window frame, the
   window is destroyed in handleEvent and X11_Close is initiated
   (the WM_DELETE_WINDOW mechanism already in place.)
-- when the window is destroyed for another reason (e.g. the parent
   being destroyed), it is not destroyed again but X11_Close is still
   initiated.

Regards,
  -tom


--------------------------------------------------
*** devX11.c_orig	Tue Feb 13 15:32:24 2001
--- devX11.c	Tue Feb 13 17:24:04 2001
***************
*** 116,121 ****
--- 116,122 ----
      FILE *fp;				/* file for a bitmap device */
      int quality;			/* JPEG quality */
  
+     Rboolean inclose;                   /* TRUE if window is being closed */
  } x11Desc;
  
  
***************
*** 145,151 ****
  static Atom _XA_WM_PROTOCOLS, protocol;
  
  static Rboolean displayOpen = FALSE;
- static Rboolean inclose = FALSE;
  static int numX11Devices = 0;
  
  	/********************************************************/
--- 146,151 ----
***************
*** 619,632 ****
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS))
! 	if (!inclose && event.xclient.data.l[0] == protocol) {
! 	    XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    KillDevice(dd);
  	}
  }
  
  static void R_ProcessEvents(void *data)
--- 619,652 ----
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
+     else if (event.type == DestroyNotify) {
+         /* The window is being destroyed, kill the device, too. */
+         XFindContext(display, event.xdestroywindow.window,
+                      devPtrContext, &temp);
+         dd = (DevDesc *) temp;
+         xd = (x11Desc *) dd->deviceSpecific;
+         if (!xd->inclose) {
+             xd->inclose = TRUE;
+             KillDevice(dd);
+         }
+     }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS)) {
! 	if (event.xclient.data.l[0] == protocol) {
!             XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    xd = (x11Desc *) dd->deviceSpecific;
! 	    if (!xd->inclose) {
! 		/* Dispatch destroy only once */
! 		xd->inclose = TRUE;
! 		XDestroyWindow(display, xd->window);
! 		XSync (display, 0);
! 		KillDevice(dd);
! 	    }
  	}
+     }
+ 
  }
  
  static void R_ProcessEvents(void *data)
***************
*** 1208,1213 ****
--- 1228,1234 ----
  		     ExposureMask | ButtonPressMask | StructureNotifyMask);
  	XMapWindow(display, xd->window);
  	XSync(display, 0);
+         xd->inclose = FALSE;
  
  	/* Gobble expose events */
  
***************
*** 1464,1476 ****
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* process pending events */
! 	/* set block on destroy events */
! 	inclose = TRUE;
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
- 	XDestroyWindow(display, xd->window);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
--- 1485,1506 ----
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* There are three reasons to be here: */
! 	/* 1) The user clicked on a button in the window frame */
! 	/*    and we received a DELETE_WINDOW from the wm, */
! 	/* 2) Somebody destroyed our window directly, or if */
! 	/*    embedded, the parent is being destroyed, and so */
! 	/*    we got a DestroyNotify event, too, */
! 	/* 3) The user used dev.off() to get rid of us. Bye. */
! 
! 	if (!xd->inclose) {
! 	    xd->inclose = TRUE;
! 	    XDestroyWindow(display, xd->window);
! 	}
! 	/* process pending events (esp. reap events for this window) */
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
***************
*** 1517,1523 ****
      }
  
      free(xd);
!     inclose = FALSE;
  }
  
  	/********************************************************/
--- 1547,1553 ----
      }
  
      free(xd);
!     dd->deviceSpecific = NULL;
  }
  
  	/********************************************************/
***************
*** 1858,1866 ****
  		else
  		    done = 2;
  	    }
! 	}
! 	else
  	    handleEvent(event);
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--- 1888,1901 ----
  		else
  		    done = 2;
  	    }
! 	} else {
  	    handleEvent(event);
+ 	    if (!dd->deviceSpecific) {
+ 		/* Allow new active window to redraw */
+ 		R_ProcessEvents((void*)NULL);
+ 		error ("Device closed while waiting for input.\n");
+ 	    }
+         }
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--------------------------------------------------




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Feb 13 23:19:49 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 13 Feb 2001 18:19:49 -0500
Subject: [Rd] devX11.c -- questions about expose events and XBell
Message-ID: <pxy9va5fxm.fsf@infiniti.ece.cmu.edu>


Hi,  sorry for lumping this together...  Both these issues are rather
small, and I'm not sure either qualifies as a bug...

1) After a window id created in X11_Open and mapped,  you "gobble the
   expose events".  Not true, you gobble any event that comes along!
   The code below fixes this by using *XCheckTypedEvent*.  Hmm, I'm
   not sure this right already, but better...

*** devX11.c~    Tue Feb 13 17:24:40 2001
--- devX11.c    Tue Feb 13 18:07:41 2001
***************
*** 1232,1242 ****
  
        /* Gobble expose events */
  
!       XNextEvent(display, &event);
!       if (event.xany.type == Expose) {
!           while (event.xexpose.count)
!               XNextEvent(display, &event);
!       }
      } else { /* PIXMAP */
        xd->windowWidth = iw = w;
        xd->windowHeight = ih = h;
--- 1232,1241 ----
  
        /* Gobble expose events */
  
!       if (XCheckTypedEvent(display, Expose, &event)) {
!           while (event.xexpose.count)
!               XNextEvent(display, &event);
!       }
      } else { /* PIXMAP */
        xd->windowWidth = iw = w;
        xd->windowHeight = ih = h;


2) There are beeps from X11_Locator for every successful mouse click.
   The code here assumes that stderr is connected to a terminal.
   This is not always true!  When I run R within an ESS session in
   emacs, I get ^G  but no sound.  When I redirect the output, I get
   nothing...  *Question* Why don't you use *XBell*?

*** devX11.c~    Tue Feb 13 17:24:40 2001
--- devX11.c    Tue Feb 13 18:07:41 2001
***************
*** 1880,1887 ****
                if (event.xbutton.button == Button1) {
                    *x = event.xbutton.x;
                    *y = event.xbutton.y;
!                   fprintf(stderr, "\07");
!                   fflush(stderr);
                    XSync(display, 0);
                    done = 1;
                }
--- 1879,1885 ----
                if (event.xbutton.button == Button1) {
                    *x = event.xbutton.x;
                    *y = event.xbutton.y;
!                   XBell (display, 0);
                    XSync(display, 0);
                    done = 1;
                }
   

Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Wed Feb 14 00:11:56 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 14 Feb 2001 01:11:56 +0100
Subject: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 13 Feb 2001 23:40:37 +0100 (MET)"
References: <200102132240.XAA10562@pubhealth.ku.dk>
Message-ID: <x2elx2yvg3.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:


> Blissfully!  *No KillDevice is called* when the window is destroyed by
> something other than the WM_DELETE_WINDOW mechanism!  This happens
> when you embed the X11 device into another window/application.  For
> starters, the device no longer receives WM_DELETE_WINDOW client
> messages.  But it does receive a DestroyNotify event when the parent
> (the container window) is destroyed.  HandleEvent should, well
> _handle_ this _event_.

Heh. Quite probably, this is also the source of the FVWM trouble
reported earlier although that triggered an infinite loop which should
probably be guarded against by other means as well. 

Thanks for filing this (good to have as bug report so that we don't
forget - it's the sort of thing that often has to wait until someone
has a clear enough mind and sufficient stamina to try and get it
right.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Feb 15 04:38:15 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 14 Feb 2001 23:38:15 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <pxae7opnm0.fsf@infiniti.ece.cmu.edu>


Hi, I'm not sure this is a bug in the code, the comment or my
thinking.  So first try goes to r-devel...  I find the following
comment in X11_Open () (src/unix/X11/devX11.c):

/* if we have to bail out with "error", then must free(dd) and free(xd) */

A couple lines down, there is:

    if (!strncmp(dsp, "png::", 5)) {
	FILE *fp;
#ifndef HAVE_PNG
	error("No png support in this version of R");
#endif
	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
	    error("could not open PNG file `%s'", dsp+6);
    ...

So what does the comment imply?  If error jumps out to the toplevel
without giving X11DeviceDriver a chance to free dd and xd, then this
should be:

    if (!strncmp(dsp, "png::", 5)) {
	FILE *fp;
#ifndef HAVE_PNG
        free (xd);
        free (dd);
	error("No png support in this version of R");
#endif
	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w"))) {
            free (xd);
            free (dd);
	    error("could not open PNG file `%s'", dsp+6);
        }

There are a couple more error()s without free()s.  The memory leak
isn't big, I'd still appreciate it if you clarify who should do the free().
Thanks,
  -tom



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 15 08:28:30 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Feb 2001 08:28:30 +0000 (GMT)
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: <pxae7opnm0.fsf@infiniti.ece.cmu.edu>
Message-ID: <Pine.GSO.4.31.0102150824260.13108-100000@toucan.stats>

On 14 Feb 2001, Thomas Vogels wrote:

>
> Hi, I'm not sure this is a bug in the code, the comment or my
> thinking.  So first try goes to r-devel...  I find the following
> comment in X11_Open () (src/unix/X11/devX11.c):
>
> /* if we have to bail out with "error", then must free(dd) and free(xd) */
>
> A couple lines down, there is:
>
>     if (!strncmp(dsp, "png::", 5)) {
> 	FILE *fp;
> #ifndef HAVE_PNG
> 	error("No png support in this version of R");
> #endif
> 	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> 	    error("could not open PNG file `%s'", dsp+6);
>     ...
>
> So what does the comment imply?  If error jumps out to the toplevel
> without giving X11DeviceDriver a chance to free dd and xd, then this
> should be:

[...]

Well, the thinking was that people would not be trying to use facilities
on systems where they had not bothered to implement them, so what problem
was a small memory leak?  They would only do it once, ever ....

In these cases it would be better to give a warning and return FALSE, when
the normal return mechanism will free xd and then dd.  I will alter it to
that when I have tested it out.

BDR

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Feb 15 14:29:42 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 15 Feb 2001 09:29:42 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Prof Brian Ripley's message of "Thu, 15 Feb 2001 08:28:30 +0000 (GMT)"
References: <Pine.GSO.4.31.0102150824260.13108-100000@toucan.stats>
Message-ID: <pxr9106muh.fsf@infiniti.ece.cmu.edu>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> On 14 Feb 2001, Thomas Vogels wrote:
> 
> >
> > Hi, I'm not sure this is a bug in the code, the comment or my
> > thinking.  So first try goes to r-devel...  I find the following
> > comment in X11_Open () (src/unix/X11/devX11.c):
> >
> > /* if we have to bail out with "error", then must free(dd) and free(xd) */
> >
> > A couple lines down, there is:
> >
> >     if (!strncmp(dsp, "png::", 5)) {
> > 	FILE *fp;
> > #ifndef HAVE_PNG
> > 	error("No png support in this version of R");
> > #endif
> > 	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> > 	    error("could not open PNG file `%s'", dsp+6);
> >     ...
> >
> > So what does the comment imply?  If error jumps out to the toplevel
> > without giving X11DeviceDriver a chance to free dd and xd, then this
> > should be:
> 
> [...]
> 
> Well, the thinking was that people would not be trying to use facilities
> on systems where they had not bothered to implement them, so what problem
> was a small memory leak?  They would only do it once, ever ....

uh, I guess I screwed up the example.  Even more lines down, there is
no free accompanying the error ("could not open PNG file ...").  That
can happen more often and more memory would leak.  But no, I wanted to
know this for another reason: I've played around with the X11 device
driver to implement a feature that allows me to embed the device into
another window.  Opening and closing of x11()'s can happen often
during the execution of the program.  But I'm still not interested in
the memory leak issue per se.

I've seen a segfault or two (not in the regular code) and right now I
blame it on Xevents arriving after the device is shut down.  Now all
of a sudden the calls to free become very interesting.  As I said at
the beginning of the email, I wanted to simply understand the comment,
understand what should be going on, not criticize for it not being
followed.

Although I got the question wrong, I guess, I got the right answer :-)
Thanks.

Regards,
  -tom


> 
> In these cases it would be better to give a warning and return FALSE, when
> the normal return mechanism will free xd and then dd.  I will alter it to
> that when I have tested it out.

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From I.Wilson@maths.abdn.ac.uk  Thu Feb 15 17:59:12 2001
From: I.Wilson@maths.abdn.ac.uk (I.Wilson@maths.abdn.ac.uk)
Date: Thu, 15 Feb 2001 18:59:12 +0100 (MET)
Subject: [Rd] (PR#849)
Message-ID: <200102151759.SAA06837@pubhealth.ku.dk>



The symbol( circle) function does not create
circles.

See following function

ijwbug <- function()
{
   plot.new()
     plot.window(c(-1,1),c(-1,1));
   symbols(0,0,circle=1,add=T,inches=F);

   curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
     curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
lines(c(-1,1),c(1,1));
lines(c(-1,1),c(-1,-1));


}



--please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = x86
  os = Win32
  system = x86, Win32
  status =
  major = 1
  minor = 2.1
  year = 2001
  month = 01
  day = 15
  language = R

Windows NT 4.0 (build 1381) Service Pack 5

Search Path:
  .GlobalEnv, Autoloads, package:base


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 15 18:08:58 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 15 Feb 2001 13:08:58 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
Message-ID: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>

I am trying to catch a segfault from a shell in the tests directory set up by R CMD
check with

R_LIBS=~/dse/CHECKED/library:..
export R_LIBS
R -d gdb
run

but then when I try to load a library I find the setting of R_LIBS is ignored. What
am I doing wrong? The library is found ok without -d gdb. (Using Solaris 2.6, R 1.2.1
Patched (2001-02-06) )

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Thu Feb 15 19:19:13 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Fri, 16 Feb 2001 08:19:13 +1300
Subject: [Rd] (PR#849)
References: <200102151759.SAA06837@pubhealth.ku.dk>
Message-ID: <007701c09784$2e4e3b10$175dd882@stat.auckland.ac.nz>

Hi


> The symbol( circle) function does not create
> circles.
>
> See following function
>
> ijwbug <- function()
> {
>    plot.new()
>      plot.window(c(-1,1),c(-1,1));
>    symbols(0,0,circle=1,add=T,inches=F);
>
>    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
>      curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
> lines(c(-1,1),c(1,1));
> lines(c(-1,1),c(-1,-1));
>
>
> }


If I understand correctly, I think you're just seeing clipping.

Does the slight modification of your function given below behave as you
would expect ?

ijwbug <- function()
{ 
   # do not clip to figure region, clip only to device region
   par(xpd=NA) 
   plot.new()
   plot.window(c(-1,1),c(-1,1));
   symbols(0,0,circle=1,add=T,inches=F);
   # I have added colour to the curves 
   curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1, col="red")
   curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1, col="red")
   lines(c(-1,1),c(1,1));
   lines(c(-1,1),c(-1,-1));
}

Paul




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Thu Feb 15 21:22:01 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 15 Feb 2001 22:22:01 +0100
Subject: [Rd] (PR#849)
In-Reply-To: "Paul Murrell"'s message of "Fri, 16 Feb 2001 08:19:13 +1300"
References: <200102151759.SAA06837@pubhealth.ku.dk> <007701c09784$2e4e3b10$175dd882@stat.auckland.ac.nz>
Message-ID: <x2vgqb63ra.fsf@blueberry.kubism.ku.dk>

"Paul Murrell" <paul@stat.auckland.ac.nz> writes:

> Hi
> 
> 
> > The symbol( circle) function does not create
> > circles.
> >
> > See following function
> >
> > ijwbug <- function()
> > {
> >    plot.new()
> >      plot.window(c(-1,1),c(-1,1));
> >    symbols(0,0,circle=1,add=T,inches=F);
> >
> >    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
> >      curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
> > lines(c(-1,1),c(1,1));
> > lines(c(-1,1),c(-1,-1));
> >
> >
> > }
> 
> 
> If I understand correctly, I think you're just seeing clipping.
> 
> Does the slight modification of your function given below behave as you
> would expect ?
> 
> ijwbug <- function()
> { 
>    # do not clip to figure region, clip only to device region
>    par(xpd=NA) 
>    plot.new()
>    plot.window(c(-1,1),c(-1,1));
>    symbols(0,0,circle=1,add=T,inches=F);
>    # I have added colour to the curves 
>    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1, col="red")
>    curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1, col="red")
>    lines(c(-1,1),c(1,1));
>    lines(c(-1,1),c(-1,-1));
> }
> 
> Paul

Actually, I think the real problem is that the plotting region is not
square, so  curve(sqrt(1 - x^2),...) is an ellipse. Insert
par(pty="s") to fix that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pdenis2@home.com  Fri Feb 16 04:35:06 2001
From: pdenis2@home.com (pdenis2@home.com)
Date: Fri, 16 Feb 2001 05:35:06 +0100 (MET)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
Message-ID: <200102160435.FAA08793@pubhealth.ku.dk>

print.matrix(x) segfaults if the vector supplied to 'rowlab' is
*shorter* than nrow(x):

> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    2.1
year     2001
month    01
day      15
language R
[installed from RPM]

> x<-1:4
> dim(x)<-c(2,2)
> x
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> print.matrix(x)
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> print.matrix(x,rowlab=c('a','b'))
  [,1] [,2]
a    1    3
b    2    4
> print.matrix(x,rowlab=c('a','b','c'))
  [,1] [,2]
a    1    3
b    2    4                                             [OK, ignores
extra labels ...]
> print.matrix(x,rowlab=c('a'))
Segmentation fault (core dumped)

Similar behavior for 'collab' ...



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Fri Feb 16 08:04:45 2001
From: adrian@olsen.ch (Adrian Trapletti)
Date: Fri, 16 Feb 2001 09:04:45 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <3A8CDF1D.707A7785@olsen.ch>

> Date: 15 Feb 2001 09:29:42 -0500
> From: Thomas Vogels
> Subject: Re: [Rd] who frees dd and xd in X11_Open?
>
> Prof Brian Ripley  writes:
>
> > On 14 Feb 2001, Thomas Vogels wrote:
> >
> > >
> > > Hi, I'm not sure this is a bug in the code, the comment or my
> > > thinking.  So first try goes to r-devel...  I find the following
> > > comment in X11_Open () (src/unix/X11/devX11.c):
> > >
> > > /* if we have to bail out with "error", then must free(dd) and free(xd) */
> > >
> > > A couple lines down, there is:
> > >
> > >     if (!strncmp(dsp, "png::", 5)) {
> > >     FILE *fp;
> > > #ifndef HAVE_PNG
> > >     error("No png support in this version of R");
> > > #endif
> > >     if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> > >         error("could not open PNG file `%s'", dsp+6);
> > >     ...
> > >
> > > So what does the comment imply?  If error jumps out to the toplevel
> > > without giving X11DeviceDriver a chance to free dd and xd, then this
> > > should be:
> >
> > [...]
> >
> > Well, the thinking was that people would not be trying to use facilities
> > on systems where they had not bothered to implement them, so what problem
> > was a small memory leak?  They would only do it once, ever ....
>
> uh, I guess I screwed up the example.  Even more lines down, there is
> no free accompanying the error ("could not open PNG file ...").  That
> can happen more often and more memory would leak.  But no, I wanted to
> know this for another reason: I've played around with the X11 device
> driver to implement a feature that allows me to embed the device into
> another window.  Opening and closing of x11()'s can happen often
> during the execution of the program.  But I'm still not interested in
> the memory leak issue per se.
>
> I've seen a segfault or two (not in the regular code) and right now I
> blame it on Xevents arriving after the device is shut down.  Now all
> of a sudden the calls to free become very interesting.  As I said at
> the beginning of the email, I wanted to simply understand the comment,
> understand what should be going on, not criticize for it not being
> followed.
>
> Although I got the question wrong, I guess, I got the right answer :-)
> Thanks.
>
> Regards,
>   -tom
>
>
> >
> > In these cases it would be better to give a warning and return FALSE, when
> > the normal return mechanism will free xd and then dd.  I will alter it to
> > that when I have tested it out.
>
>
I don't know if it has something to do with this discussion, but it's
probably worth reporting it.

Under
SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
R : Version 1.2.1  (2001-01-15)
Fvwm95 Version 2.0.43a
the window manager always crashes when I close an x11() device started
within R.

Adrian

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Feb 16 09:03:17 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 16 Feb 2001 09:03:17 +0000 (GMT)
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <200102160903.JAA29278@toucan.stats.ox.ac.uk>


> Date: Fri, 16 Feb 2001 09:04:45 +0100
> From: Adrian Trapletti <adrian@olsen.ch

> I don't know if it has something to do with this discussion, but it's
> probably worth reporting it.
> 
> Under
> SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> R : Version 1.2.1  (2001-01-15)
> Fvwm95 Version 2.0.43a
> the window manager always crashes when I close an x11() device started
> within R.

This discussion is about png() and jpeg() devices.  We've had other
reports about FVWM, though.

Why anyone would use FVWM95 on a system that comes with CDE is an
interesting question, though....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Fri Feb 16 12:03:48 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 2001 13:03:48 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Prof Brian Ripley's message of "Fri, 16 Feb 2001 09:03:17 +0000 (GMT)"
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
Message-ID: <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > From: Adrian Trapletti <adrian@olsen.ch
> 
> > I don't know if it has something to do with this discussion, but it's
> > probably worth reporting it.
> > 
> > Under
> > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > R : Version 1.2.1  (2001-01-15)
> > Fvwm95 Version 2.0.43a
> > the window manager always crashes when I close an x11() device started
> > within R.
> 
> This discussion is about png() and jpeg() devices.  We've had other
> reports about FVWM, though.

...and they too refer to improper error handling by X11. I'm somewhat
baffled by the effect reported, though. Surely, an application
crashing the window manager is a bug in the latter, not the former?
What we've heard of before is that closing X11 windows with the window
manager crashes R, but this sounds like the other way around.

> Why anyone would use FVWM95 on a system that comes with CDE is an
> interesting question, though....

Except for the "95" bit I can empathize with it. (and the law of
inertia is strong for user interfaces in any case).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From stefano.iacus@unimi.it  Fri Feb 16 16:10:44 2001
From: stefano.iacus@unimi.it (Stefano Iacus)
Date: Fri, 16 Feb 2001 17:10:44 +0100
Subject: [Rd] R 1.2.2 (pre-release) available
Message-ID: <a05001900b6b3006ec3ab@[159.149.74.61]>

A pre-release of R 1.2.2 based on the latest R-patched archive 
(2/14/2001) for Macintosh is available at:


http://www.eco-dip.unimi.it/R


It is important to receive as much feedback as possible before R 
1.2.2 is released.

Stefano
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb 16 16:50:01 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Fri, 16 Feb 2001 08:50:01 -0800 (PST)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
In-Reply-To: <200102160435.FAA08793@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.33.0102160848140.53536-100000@homer40.u.washington.edu>

On Fri, 16 Feb 2001 pdenis2@home.com wrote:

> print.matrix(x) segfaults if the vector supplied to 'rowlab' is
> *shorter* than nrow(x):
>

Ok, the cause is the obvious one: there is no check for the length of
rowlab in print[type]Matrix, nor in formatString. formatString happily
wanders along the vector and falls off the end.

I'm going to fix it in formatString, we may also want to fix it higher up.

	-thomas


> > version
>          _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    2.1
> year     2001
> month    01
> day      15
> language R
> [installed from RPM]
>
> > x<-1:4
> > dim(x)<-c(2,2)
> > x
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > print.matrix(x)
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > print.matrix(x,rowlab=c('a','b'))
>   [,1] [,2]
> a    1    3
> b    2    4
> > print.matrix(x,rowlab=c('a','b','c'))
>   [,1] [,2]
> a    1    3
> b    2    4                                             [OK, ignores
> extra labels ...]
> > print.matrix(x,rowlab=c('a'))
> Segmentation fault (core dumped)
>
> Similar behavior for 'collab' ...
>
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle
^^^^^^^^^^^^^^^^^^^^^^^^
 NOTE NEW EMAIL ADDRESS

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb 16 16:54:23 2001
From: tlumley@u.washington.edu (tlumley@u.washington.edu)
Date: Fri, 16 Feb 2001 17:54:23 +0100 (MET)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
Message-ID: <200102161654.RAA17826@pubhealth.ku.dk>

On Fri, 16 Feb 2001, Thomas Lumley wrote:

> On Fri, 16 Feb 2001 pdenis2@home.com wrote:
>
> > print.matrix(x) segfaults if the vector supplied to 'rowlab' is
> > *shorter* than nrow(x):
> >
>
> Ok, the cause is the obvious one: there is no check for the length of
> rowlab in print[type]Matrix, nor in formatString. formatString happily
> wanders along the vector and falls off the end.
>
> I'm going to fix it in formatString, we may also want to fix it higher up.

No I'm not: formatString gets a C vector of strings, not an R vector. It
has to be fixed higher up.

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From denis@mail.cor.epa.gov  Fri Feb 16 17:09:14 2001
From: denis@mail.cor.epa.gov (Denis White)
Date: Fri, 16 Feb 2001 09:09:14 -0800 (PST)
Subject: [Rd] Re: polygon border colors
Message-ID: <Pine.SUN.3.91.1010216085824.11176B@okapi.cor.epa.gov>

I think I see in do_polygon() in plot.c that border colors are
not cycled, and that changes in the lines

...
    PROTECT(border = FixupCol(CAR(args), dd->gp.fg));	args = CDR(args);
...
		GPolygon(i-start, x+start, y+start, USER,
			 INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
...
	    GPolygon(nx-start, x+start, y+start, USER,
		     INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
...

following the pattern for "col" might make cycling possible.

Is this a change that I should try locally, or could this be
considered for the standard version?

thanks,

Denis

---------- Forwarded message ----------
Date: Thu, 15 Feb 2001 18:33:26 -0800 (PST)
From: Denis White <denis@mail.cor.epa.gov>
To: r-help@hypatia.math.ethz.ch
Subject: polygon border colors

Simple question: is it true that 

  polygon (x, y, col=vec, border=vec, ...)

will cycle through the vec colors for fills but not for
the border colors when sending multiple polygons?

thanks,

Denis White
   US EPA, 200 SW 35th St, Corvallis, Oregon, 97333 USA
   voice: 541.754.4476, email: white.denis@epa.gov
   web: www.epa.gov/wed/pages/staff/white/


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Feb 16 17:57:52 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 16 Feb 2001 12:57:52 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Peter Dalgaard BSA's message of "16 Feb 2001 13:03:48 +0100"
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
 <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk>
Message-ID: <pxwvaqse73.fsf@infiniti.ece.cmu.edu>


Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk> writes:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > > From: Adrian Trapletti <adrian@olsen.ch
> > 
> > > I don't know if it has something to do with this discussion, but it's
> > > probably worth reporting it.
> > > 
> > > Under
> > > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > > R : Version 1.2.1  (2001-01-15)
> > > Fvwm95 Version 2.0.43a
> > > the window manager always crashes when I close an x11() device started
> > > within R.
> > 
> > This discussion is about png() and jpeg() devices.  We've had other
> > reports about FVWM, though.
> 
> ...and they too refer to improper error handling by X11. I'm somewhat
> baffled by the effect reported, though. Surely, an application
> crashing the window manager is a bug in the latter, not the former?
> What we've heard of before is that closing X11 windows with the window
> manager crashes R, but this sounds like the other way around.

The question about freeing xd and dd comes indeed from my fiddling
with the X11 driver and understanding the code there...  As for the
current handleEvent: there are some events simply ignored (like the
DestroyNotify event) and some are not reaped due to the sequence of
events in X11_Close/R_ProcessEvents.  (And the way inclose is handled
is scary once you think of closing two windows at roughly the same
time...)  The events that linger after R is done shouldn't confuse the
window manager, though.

I've put my code, patches, comments, suggestions, etc. at:
http://www.ece.cmu.edu/~tov/public/R/X11andTk.html
I'd be curious whether R with the patched handleEvent still crashes
FVWM95.  Probably but who knows.

  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gs@statlab.uni-heidelberg.de  Fri Feb 16 18:12:29 2001
From: gs@statlab.uni-heidelberg.de (G. Sawitzki)
Date: Fri, 16 Feb 2001 19:12:29 +0100
Subject: [Rd] Re: R 1.2.2 (pre-release) available
In-Reply-To: <a05001900b6b3006ec3ab@[159.149.74.61]>
References: <a05001900b6b3006ec3ab@[159.149.74.61]>
Message-ID: <p05010400b6b31ca16507@[129.206.113.199]>

At 17:10 +0100 16.02.2001, Stefano Iacus wrote:
>A pre-release of R 1.2.2 based on the latest R-patched archive 
>(2/14/2001) for Macintosh is available at:
>
>http://www.eco-dip.unimi.it/R
>
>It is important to receive as much feedback as possible before R 
>1.2.2 is released.
>
>Stefano

Stefano,

the link to Waste does not work. The correct link is
http://www.merzwaren.com/bin/waste/waste-20b3.sit

(/bin/ is missing on you page).

I have three bugs from the previos version where it ran into a crash. 
Standard logs are in
	<ftp://max.statlab.uni-heidelberg.de/users/gs/>,
filenames startign with R. Maybe you can have a short look, but you 
should not spend too much time on these - they may already be fixed 
in the new version.
  gs.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From beebe@math.utah.edu  Sat Feb 17 00:44:15 2001
From: beebe@math.utah.edu (beebe@math.utah.edu)
Date: Sat, 17 Feb 2001 01:44:15 +0100 (MET)
Subject: [Rd] Comments on R-1.2.1 builds (PR#851)
Message-ID: <200102170044.BAA19310@pubhealth.ku.dk>

The R-1.2.1 builds have gone fairly smoothly on most of my UNIX
architectures, but there were many warnings reported by the picky SGI
compiler that could be eliminated in future releases.

Generally, I have found the SGI compilers very helpful in ferreting
out portability problems, unused and/or obsolete variables, unexpected
datatype coercions, etc., and they compile faster than any other
compilers too.

First, I configured like this:

env CC='c89 -mips3 -O3' ./configure && make all

This reports:

	R is now configured for mips-sgi-irix6.5

	  Source directory:          .
	  Installation directory:    /usr/local
	  C compiler:                c89 -mips3 -O3  -OPT:IEEE_NaN_inf=ON -g
	  C++ compiler:              c++  -g -O2
	  FORTRAN compiler:          g77  -OPT:IEEE_NaN_inf=ON -g -O2

	  X11 support:               yes
	  Gnome support:             no
	  Tcl/Tk support:            yes

	  R profiling support:       yes
	  R as a shared library:     no

The build proceeds until this failure:

	g77 -OPT:IEEE_NaN_inf=ON  -g -O2 -c ch2inv.f -o ch2inv.o
	f771: Invalid option `-OPT:IEEE_NaN_inf=ON'
	make[3]: *** [ch2inv.o] Error 1

Evidently, it was not prepared for the GNU Fortran compiler.

I started over with a new clean unpack of the distribution,
with

	env FC=f77 F77=f77 CC=c89 CXX=CC ./configure &&
		make all check install

and got a working build and install.  It reports

	R is now configured for mips-sgi-irix6.5

	  Source directory:          .
	  Installation directory:    /usr/local
	  C compiler:                c89  -OPT:IEEE_NaN_inf=ON -g
	  C++ compiler:              CC  -g
	  FORTRAN compiler:          f77  -OPT:IEEE_NaN_inf=ON -g

	  X11 support:               yes
	  Gnome support:             no
	  Tcl/Tk support:            yes

	  R profiling support:       yes
	  R as a shared library:     no


Here are the all the compiler warnings reported:

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/appl
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c chull.c -o chull.o
cc-1185 c89: WARNING File = chull.c, Line = 77
  An enumerated type is mixed with another type.

      Rboolean vert, neg_dir=0;
                             ^

cc-1185 c89: WARNING File = chull.c, Line = 84
  An enumerated type is mixed with another type.

      vert = (x[jj] == xt);
           ^

cc-1185 c89: WARNING File = chull.c, Line = 87
  An enumerated type is mixed with another type.

        neg_dir = ((s > 0 && d1 < 0.) || (s < 0 && d1 > 0.));
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c cpoly.c -o cpoly.o
cc-1185 c89: WARNING File = cpoly.c, Line = 490
  An enumerated type is mixed with another type.

      *bool = hypot(hvr, hvi) <= are * 10. * hypot(hr[n-1], hi[n-1]);
            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c lbfgsb.c -o lbfgsb.o
cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l1" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l2" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                    ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l3" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                        ^

cc-1551 c89: WARNING File = lbfgsb.c, Line = 687
  The variable "xstep" is used before its value is set.

                   nint, word, iback, stp, xstep, k);
                                           ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 582
  The variable "time" is set but never used.

      double time;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c pretty.c -o pretty.o
cc-1185 c89: WARNING File = pretty.c, Line = 82
  An enumerated type is mixed with another type.

        i_small = dx < cell * U * imax2(1,*ndiv) * DBL_EPSILON *3;
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c strsignif.c -o strsignif.o
cc-1552 c89: WARNING File = strsignif.c, Line = 80
  The variable "jL" is set but never used.

      int iex, j, jL, len_flag = strlen(*flag);
                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c uncmin.c -o uncmin.o
cc-1551 c89: WARNING File = uncmin.c, Line = 2443
  The variable "mxtake" is used before its value is set.

         steptl, sx, fscale, itnlim, iretcd, mxtake, msg);
                                             ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/nmath
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c polygamma.c -o polygamma.o
cc-1167 c89: WARNING File = polygamma.c, Line = 167
  Pointer points outside of underlying object.

  static double *b = (double *)&bvalues -1;
                                        ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/unix
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devices.c -o devices.o
cc-1185 c89: WARNING File = devices.c, Line = 111
  An enumerated type is mixed with another type.

                                 colormodel, maxcubesize)) {
                                 ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c edit.c -o edit.o
cc-1185 c89: WARNING File = edit.c, Line = 109
  An enumerated type is mixed with another type.

            t = deparse1(x, 0);
                            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c system.c -o system.o
cc-1185 c89: WARNING File = system.c, Line = 196
  An enumerated type is mixed with another type.

                UsingReadline = 0;
                              ^

cc-1185 c89: WARNING File = system.c, Line = 211
  An enumerated type is mixed with another type.

      R_Interactive = isatty(0);
                    ^

cc-1185 c89: WARNING File = system.c, Line = 234
  An enumerated type is mixed with another type.

      fpu_setup(1);
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c sys-common.c -o sys-common.o
cc-1185 c89: WARNING File = sys-common.c, Line = 173
  An enumerated type is mixed with another type.

      return stat(R_ExpandFileName(path), &sb) == 0;
             ^

cc-1185 c89: WARNING File = sys-common.c, Line = 188
  An enumerated type is mixed with another type.

      if (name && name[0] != '.') return 0;
                                         ^

cc-1185 c89: WARNING File = sys-common.c, Line = 189
  An enumerated type is mixed with another type.

      else return 1;
                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/main
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c RNG.c -o RNG.o
cc-1185 c89: WARNING File = RNG.c, Line = 63
  An enumerated type is mixed with another type.

      { 0, 0, "Wichmann-Hill",          3,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 63
  An enumerated type is mixed with another type.

      { 0, 0, "Wichmann-Hill",          3,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 64
  An enumerated type is mixed with another type.

      { 1, 0, "Marsaglia-MultiCarry",   2,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 64
  An enumerated type is mixed with another type.

      { 1, 0, "Marsaglia-MultiCarry",   2,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 65
  An enumerated type is mixed with another type.

      { 2, 0, "Super-Duper",            2,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 65
  An enumerated type is mixed with another type.

      { 2, 0, "Super-Duper",            2,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 66
  An enumerated type is mixed with another type.

      { 3, 0, "Mersenne-Twister",           1+624,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 66
  An enumerated type is mixed with another type.

      { 3, 0, "Mersenne-Twister",           1+624,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 67
  An enumerated type is mixed with another type.

      { 4, 0, "Knuth-TAOCP",          1+100,    dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 67
  An enumerated type is mixed with another type.

      { 4, 0, "Knuth-TAOCP",          1+100,    dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 68
  An enumerated type is mixed with another type.

      { 5, 0, "User-supplied",            0,    dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 68
  An enumerated type is mixed with another type.

      { 5, 0, "User-supplied",            0,    dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 264
  An enumerated type is mixed with another type.

        newRNG = tmp % 100;
               ^

cc-1185 c89: WARNING File = RNG.c, Line = 265
  An enumerated type is mixed with another type.

        newN01 = tmp / 100;
               ^

cc-1185 c89: WARNING File = RNG.c, Line = 382
  An enumerated type is mixed with another type.

        RNGkind(asInteger(rng));
                ^

cc-1185 c89: WARNING File = RNG.c, Line = 385
  An enumerated type is mixed with another type.

        Norm_kind(asInteger(norm));
                  ^

cc-1185 c89: WARNING File = RNG.c, Line = 404
  An enumerated type is mixed with another type.

        kind = asInteger(skind);
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c arithmetic.c -o arithmetic.o
cc-1185 c89: WARNING File = arithmetic.c, Line = 505
  An enumerated type is mixed with another type.

        x = complex_binary(PRIMVAL(op), x, y);
                           ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 511
  An enumerated type is mixed with another type.

            x = real_binary(PRIMVAL(op), x, y);
                            ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 514
  An enumerated type is mixed with another type.

            x = integer_binary(PRIMVAL(op), x, y);
                               ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 553
  An enumerated type is mixed with another type.

        return integer_unary(PRIMVAL(op), s1);
                             ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 555
  An enumerated type is mixed with another type.

        return real_unary(PRIMVAL(op), s1);
                          ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 557
  An enumerated type is mixed with another type.

        return complex_unary(PRIMVAL(op), s1);
                             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c array.c -o array.o
cc-1185 c89: WARNING File = array.c, Line = 98
  An enumerated type is mixed with another type.

        copyMatrix(snr, vals, byrow);
                              ^

cc-1185 c89: WARNING File = array.c, Line = 100
  An enumerated type is mixed with another type.

        copyListMatrix(snr, vals, byrow);
                                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c bind.c -o bind.o
cc-1185 c89: WARNING File = bind.c, Line = 496
  An enumerated type is mixed with another type.

        if (n != R_NilValue && pmatch(R_RecursiveSymbol, n, 1)) {
                                                            ^

cc-1185 c89: WARNING File = bind.c, Line = 505
  An enumerated type is mixed with another type.

        else if (n != R_NilValue &&  pmatch(R_UseNamesSymbol, n, 1)) {
                                                                 ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c builtin.c -o builtin.o
cc-1185 c89: WARNING File = builtin.c, Line = 573
  An enumerated type is mixed with another type.

            if (TAG(y) != R_NilValue && pmatch(STRING_ELT(x, 0), TAG(y), 1)) {
                                                                         ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c character.c -o character.o
cc-1552 c89: WARNING File = character.c, Line = 368
  The variable "uclass" is set but never used.

      int i, len, minlen, uclass;
                          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c coerce.c -o coerce.o
cc-1185 c89: WARNING File = coerce.c, Line = 703
  An enumerated type is mixed with another type.

                SET_STRING_ELT(rval, i, STRING_ELT(deparse1(CAR(vp), 0), 0));
                                        ^

cc-1185 c89: WARNING File = coerce.c, Line = 776
  An enumerated type is mixed with another type.

                               STRING_ELT(deparse1(VECTOR_ELT(v, i), 0), 0));
                               ^

cc-1185 c89: WARNING File = coerce.c, Line = 902
  An enumerated type is mixed with another type.

        x = install(CHAR(STRING_ELT(deparse1(x, 1), 0)));
                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c connections.c -o connections.o
cc-1185 c89: WARNING File = connections.c, Line = 127
  An enumerated type is mixed with another type.

      con->canwrite = (con->mode[0] == 'w' || con->mode[0] == 'a');
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 128
  An enumerated type is mixed with another type.

      con->canread = !con->canwrite;
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 291
  An enumerated type is mixed with another type.

      con->canwrite = (con->mode[0] == 'w');
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 292
  An enumerated type is mixed with another type.

      con->canread = !con->canwrite;
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 494
  An enumerated type is mixed with another type.

      new->canread = (strcmp(mode, "r") == 0);
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 495
  An enumerated type is mixed with another type.

      new->canwrite = (strcmp(mode, "w") == 0);
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 772
  An enumerated type is mixed with another type.

            con->incomplete = strlen(this->lastline) > 0;
                            ^

cc-1552 c89: WARNING File = connections.c, Line = 855
  The variable "con" is set but never used.

      Rconnection con = NULL;
                  ^

cc-1185 c89: WARNING File = connections.c, Line = 910
  An enumerated type is mixed with another type.

      con->blocking = block;
                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devPS.c -o devPS.o
cc-1185 c89: WARNING File = devPS.c, Line = 978
  An enumerated type is mixed with another type.

      dd->dp.canResizePlot = 0;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 979
  An enumerated type is mixed with another type.

      dd->dp.canChangeFont = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 980
  An enumerated type is mixed with another type.

      dd->dp.canRotateText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 981
  An enumerated type is mixed with another type.

      dd->dp.canResizeText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 982
  An enumerated type is mixed with another type.

      dd->dp.canClip = 1;
                     ^

cc-1552 c89: WARNING File = devPS.c, Line = 823
  The variable "setfill" is set but never used.

      rcolor setbg, setfg, setfill;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1328
  An enumerated type is mixed with another type.

        GConvert(&x0, &y0, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1329
  An enumerated type is mixed with another type.

        GConvert(&x1, &y1, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1356
  An enumerated type is mixed with another type.

        GConvert(&x, &y, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1367
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1368
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1405
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1410
  An enumerated type is mixed with another type.

            GConvert(&xx, &yy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1430
  An enumerated type is mixed with another type.

      GConvert(&xx, &yy, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1435
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1446
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devPS.c, Line = 1662
  An enumerated type is mixed with another type.

        return 0;
               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1788
  An enumerated type is mixed with another type.

      dd->dp.canResizePlot = 0;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1789
  An enumerated type is mixed with another type.

      dd->dp.canChangeFont = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1790
  An enumerated type is mixed with another type.

      dd->dp.canRotateText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1791
  An enumerated type is mixed with another type.

      dd->dp.canResizeText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1792
  An enumerated type is mixed with another type.

      dd->dp.canClip = 0;
                     ^

cc-1185 c89: WARNING File = devPS.c, Line = 1802
  An enumerated type is mixed with another type.

        return 0;
               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1826
  An enumerated type is mixed with another type.

      return 1;
             ^

cc-1185 c89: WARNING File = devPS.c, Line = 1976
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd); XFconvert(&x0, &y0, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1977
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd); XFconvert(&x1, &y1, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2004
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd); XFconvert(&x, &y, pd);
                       ^

cc-1185 c89: WARNING File = devPS.c, Line = 2023
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd); XFconvert(&x1, &y1, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2024
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd); XFconvert(&x2, &y2, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2058
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd); XFconvert(&xx, &yy, pd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 2080
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd); XFconvert(&xx, &yy, pd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 2101
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd); XFconvert(&x, &y, pd);
                       ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devPicTeX.c -o devPicTeX.o
cc-1185 c89: WARNING File = devPicTeX.c, Line = 409
  An enumerated type is mixed with another type.

        GConvert(&x1, &y1, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 410
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 437
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 441
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 502
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 519
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 523
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 533
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 585
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c deparse.c -o deparse.o
cc-1185 c89: WARNING File = deparse.c, Line = 153
  An enumerated type is mixed with another type.

      ca1 = deparse1(ca1, 0);
                          ^

cc-1185 c89: WARNING File = deparse.c, Line = 222
  An enumerated type is mixed with another type.

      tval = deparse1(tval, 0);
                            ^

cc-1185 c89: WARNING File = deparse.c, Line = 229
  An enumerated type is mixed with another type.

      wasopen = 1;
              ^

cc-1185 c89: WARNING File = deparse.c, Line = 274
  An enumerated type is mixed with another type.

            tval = deparse1(CAR(o), 0);
                                    ^

cc-1185 c89: WARNING File = deparse.c, Line = 289
  An enumerated type is mixed with another type.

            tval = deparse1(CAR(o), 0);
                                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devices.c -o devices.o
cc-1185 c89: WARNING File = devices.c, Line = 107
  An enumerated type is mixed with another type.

                           width, height, (double)horizontal, ps, onefile,
                                          ^

cc-1185 c89: WARNING File = devices.c, Line = 107
  An enumerated type is mixed with another type.

                           width, height, (double)horizontal, ps, onefile,
                                                                  ^

cc-1185 c89: WARNING File = devices.c, Line = 108
  An enumerated type is mixed with another type.

                           pagecentre, printit, cmd)) {
                           ^

cc-1185 c89: WARNING File = devices.c, Line = 108
  An enumerated type is mixed with another type.

                           pagecentre, printit, cmd)) {
                                       ^

cc-1185 c89: WARNING File = devices.c, Line = 145
  An enumerated type is mixed with another type.

      debug = asLogical(CAR(args));    args = CDR(args);
            ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                             ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                                                     ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                                                              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c dotcode.c -o dotcode.o
cc-1552 c89: WARNING File = dotcode.c, Line = 369
  The variable "fun" is set but never used.

      DL_FUNC fun;
              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c dstruct.c -o dstruct.o
cc-1552 c89: WARNING File = dstruct.c, Line = 111
  The variable "rval" is set but never used.

      int rval;
          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c errors.c -o errors.o
cc-1185 c89: WARNING File = errors.c, Line = 197
  An enumerated type is mixed with another type.

            dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                    ^

cc-1552 c89: WARNING File = errors.c, Line = 161
  The variable "slen" is set but never used.

      int w, slen;
             ^

cc-1185 c89: WARNING File = errors.c, Line = 238
  An enumerated type is mixed with another type.

                CHAR(STRING_ELT(deparse1(VECTOR_ELT(R_Warnings, 0),0), 0)));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 248
  An enumerated type is mixed with another type.

                   CHAR(STRING_ELT(deparse1(VECTOR_ELT(R_Warnings,i), 0), 0)));
                   ^

cc-1185 c89: WARNING File = errors.c, Line = 291
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 407
  An enumerated type is mixed with another type.

            SETCAR(t, deparse1(c->call, 0));
                                        ^

cc-1185 c89: WARNING File = errors.c, Line = 534
  An enumerated type is mixed with another type.

      { ERROR_NUMARGS,          "invalid number of arguments"           },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 535
  An enumerated type is mixed with another type.

      { ERROR_ARGTYPE,          "invalid argument type"                 },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 537
  An enumerated type is mixed with another type.

      { ERROR_TSVEC_MISMATCH,   "time-series/vector length mismatch"    },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 538
  An enumerated type is mixed with another type.

      { ERROR_INCOMPAT_ARGS,    "incompatible arguments"                },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 540
  An enumerated type is mixed with another type.

      { ERROR_UNIMPLEMENTED,    "unimplemented feature in %s"           },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 541
  An enumerated type is mixed with another type.

      { ERROR_UNKNOWN,          "unknown error (report this!)"          }
        ^

cc-1185 c89: WARNING File = errors.c, Line = 565
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 591
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c eval.c -o eval.o
cc-1552 c89: WARNING File = eval.c, Line = 372
  The variable "i" is set but never used.

      int i;
          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c fourier.c -o fourier.o
cc-1185 c89: WARNING File = fourier.c, Line = 187
  An enumerated type is mixed with another type.

      return n == 1;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c g_cntrlify.c -o g_cntrlify.o
cc-1552 c89: WARNING File = g_cntrlify.c, Line = 88
  The variable "previous_raw_fontnum" is set but never used.

    int previous_raw_fontnum;   /* implement depth-1 stack */
        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c g_alab_her.c -o g_alab_her.o
cc-1185 c89: WARNING File = g_alab_her.c, Line = 91
  An enumerated type is mixed with another type.

                 GConvertXUnits(HERSHEY_X_UNITS_TO_USER_UNITS (deltax),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 92
  An enumerated type is mixed with another type.

                                g_unit, INCHES, dd),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 93
  An enumerated type is mixed with another type.

                 GConvertYUnits(HERSHEY_Y_UNITS_TO_USER_UNITS (deltay),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 94
  An enumerated type is mixed with another type.

                                g_unit, INCHES, dd));
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 180
  An enumerated type is mixed with another type.

      return( HERSHEY_Y_UNITS_TO_USER_UNITS(HERSHEY_LARGE_CAPHEIGHT) );
              ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 247
  An enumerated type is mixed with another type.

    GConvert(&currX, &currY, g_unit, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 329
  An enumerated type is mixed with another type.

                    GConvertXUnits(x_offset * label_width, g_unit, INCHES, dd),
                                                           ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 330
  An enumerated type is mixed with another type.

                    GConvertYUnits(y_offset * label_height, g_unit, INCHES, dd));
                                                            ^

cc-1552 c89: WARNING File = g_alab_her.c, Line = 226
  The variable "x_displacement" is set but never used.

    double x_displacement;
           ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 547
  An enumerated type is mixed with another type.

    return HERSHEY_X_UNITS_TO_USER_UNITS (width);
           ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c graphics.c -o graphics.o
cc-1185 c89: WARNING File = graphics.c, Line = 121
  An enumerated type is mixed with another type.

      default:  return 0;
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 1280
  An enumerated type is mixed with another type.

      return allCmWidths(dd) && allCmHeights(dd);
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1285
  An enumerated type is mixed with another type.

      return noCmWidths(dd) && noCmHeights(dd);
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1693
  An enumerated type is mixed with another type.

      return ((dd->gp.fig[0] > 0-FLT_EPSILON) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1703
  An enumerated type is mixed with another type.

      return ((dd->gp.fig[0] < dd->gp.fig[1]) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1711
  An enumerated type is mixed with another type.

      return ((dd->gp.plt[0] > 0-FLT_EPSILON) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1721
  An enumerated type is mixed with another type.

      return ((dd->gp.plt[0] < dd->gp.plt[1]) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1832
  An enumerated type is mixed with another type.

      Rboolean swap, is_xaxis = (axis == 1 || axis == 3);
                                ^

cc-1185 c89: WARNING File = graphics.c, Line = 1921
  An enumerated type is mixed with another type.

      swap = min > max;
           ^

cc-1185 c89: WARNING File = graphics.c, Line = 1982
  An enumerated type is mixed with another type.

      Rboolean is_xaxis = (axis == 1 || axis == 3);
                          ^

cc-1185 c89: WARNING File = graphics.c, Line = 2263
  An enumerated type is mixed with another type.

      dd->gp.ann = annsave;
                 ^

cc-1185 c89: WARNING File = graphics.c, Line = 2373
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NPC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2374
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NPC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2377
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NFC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2378
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NFC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2381
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NDC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2382
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NDC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2630
  An enumerated type is mixed with another type.

        GConvert(x, y, DEVICE, coords, dd);
                               ^

cc-1185 c89: WARNING File = graphics.c, Line = 2770
  An enumerated type is mixed with another type.

                clipPoint (b + 1, ix, iy, xout, yout, cnt, store,
                           ^

cc-1185 c89: WARNING File = graphics.c, Line = 2789
  An enumerated type is mixed with another type.

            clipPoint (b + 1, x, y, xout, yout, cnt, store, clip, cs);
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 2812
  An enumerated type is mixed with another type.

                clipPoint (b + 1, ix, iy, xout, yout, cnt, store, clip, cs);
                           ^

cc-1185 c89: WARNING File = graphics.c, Line = 2986
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 3054
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3118
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3119
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3349
  An enumerated type is mixed with another type.

        GConvert(&x, &y, coords, INCHES, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3478
  An enumerated type is mixed with another type.

      GConvert(&xfromInch, &yfromInch, coords, INCHES, dd);
                                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 3479
  An enumerated type is mixed with another type.

      GConvert(&xtoInch, &ytoInch, coords, INCHES, dd);
                                   ^

cc-1185 c89: WARNING File = graphics.c, Line = 3699
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3715
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3727
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3739
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3746
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3753
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3763
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3775
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3784
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3794
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3807
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3814
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3831
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3841
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3848
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3859
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3875
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3888
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3916
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3923
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3934
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3947
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1552 c89: WARNING File = graphics.c, Line = 5189
  The variable "s" is set but never used.

      SEXP s, t;
           ^

cc-1552 c89: WARNING File = graphics.c, Line = 4138
  The variable "ColorDataBaseSize" is set but never used.

  static int ColorDataBaseSize;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c main.c -o main.o
cc-1185 c89: WARNING File = main.c, Line = 671
  An enumerated type is mixed with another type.

      R_CleanUp(ask, status, runLast);
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c match.c -o match.o
cc-1185 c89: WARNING File = match.c, Line = 119
  An enumerated type is mixed with another type.

           psmatch(tag, CHAR(PRINTNAME(TAG(*list))), 0)) {
                                                     ^

cc-1185 c89: WARNING File = match.c, Line = 129
  An enumerated type is mixed with another type.

          psmatch(tag, CHAR(PRINTNAME(TAG(next))), 0)) {
                                                   ^

cc-1185 c89: WARNING File = match.c, Line = 189
  An enumerated type is mixed with another type.

                if (TAG(b) != R_NilValue && pmatch(TAG(f), TAG(b), 1)) {
                                                                   ^

cc-1185 c89: WARNING File = match.c, Line = 226
  An enumerated type is mixed with another type.

                        pmatch(TAG(f), TAG(b), seendots)) {
                                               ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c memory.c -o memory.o
cc-1185 c89: WARNING File = memory.c, Line = 831
  An enumerated type is mixed with another type.

      return TYPEOF(fun) == CHARSXP;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c model.c -o model.o
cc-1552 c89: WARNING File = model.c, Line = 280
  The variable "tmp" is set but never used.

      unsigned tmp;
               ^

cc-1185 c89: WARNING File = model.c, Line = 909
  An enumerated type is mixed with another type.

            SET_STRING_ELT(varnames, i++, STRING_ELT(deparse1line(CAR(v), 0), 0));
                                          ^

cc-1552 c89: WARNING File = model.c, Line = 739
  The variable "abb" is set but never used.

      SEXP specials, t, abb, data;
                        ^

cc-1552 c89: WARNING File = model.c, Line = 1483
  The variable "v" is set but never used.

      SEXP expr, factors, terms, v, vars, vnames, assign;
                                 ^

cc-1552 c89: WARNING File = model.c, Line = 46
  The variable "identSymbol" is set but never used.

  static SEXP identSymbol = NULL;
              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c names.c -o names.o
cc-1185 c89: WARNING File = names.c, Line = 747
  An enumerated type is mixed with another type.

  {NULL,                NULL,           0,      0,      0,      0},
                                                                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c objects.c -o objects.o
cc-1185 c89: WARNING File = objects.c, Line = 50
  An enumerated type is mixed with another type.

            if (TAG(b) != R_NilValue && pmatch(tag, TAG(b), 1)) {
                                                            ^

cc-1185 c89: WARNING File = objects.c, Line = 60
  An enumerated type is mixed with another type.

                if (TAG(b) != R_NilValue && pmatch(tag, TAG(b), 0)) {
                                                                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c optim.c -o optim.o
cc-1185 c89: WARNING File = optim.c, Line = 514
  An enumerated type is mixed with another type.

            accpoint = FALSE;
                     ^

cc-1185 c89: WARNING File = optim.c, Line = 525
  An enumerated type is mixed with another type.

                    accpoint = R_FINITE(f) &&
                             ^

cc-1185 c89: WARNING File = optim.c, Line = 532
  An enumerated type is mixed with another type.

            enough = (f > abstol) &&
                   ^

cc-1185 c89: WARNING File = optim.c, Line = 610
  An enumerated type is mixed with another type.

      Rboolean calcvert, shrinkfail = FALSE;
                                      ^

cc-1185 c89: WARNING File = optim.c, Line = 662
  An enumerated type is mixed with another type.

        calcvert = TRUE;
                 ^

cc-1185 c89: WARNING File = optim.c, Line = 663
  An enumerated type is mixed with another type.

        shrinkfail = FALSE;
                   ^

cc-1185 c89: WARNING File = optim.c, Line = 676
  An enumerated type is mixed with another type.

                calcvert = FALSE;
                         ^

cc-1185 c89: WARNING File = optim.c, Line = 757
  An enumerated type is mixed with another type.

                            calcvert = TRUE;
                                     ^

cc-1185 c89: WARNING File = optim.c, Line = 768
  An enumerated type is mixed with another type.

                                shrinkfail = FALSE;
                                           ^

cc-1185 c89: WARNING File = optim.c, Line = 773
  An enumerated type is mixed with another type.

                                shrinkfail = TRUE;
                                           ^

cc-1552 c89: WARNING File = optim.c, Line = 618
  The variable "VN" is set but never used.

      double VH, VL, VN, VR;
                     ^

cc-1185 c89: WARNING File = optim.c, Line = 901
  An enumerated type is mixed with another type.

                    accpoint = FALSE;
                             ^

cc-1185 c89: WARNING File = optim.c, Line = 912
  An enumerated type is mixed with another type.

                            accpoint = (R_FINITE(f) &&
                                     ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c options.c -o options.o
cc-1185 c89: WARNING File = options.c, Line = 249
  An enumerated type is mixed with another type.

      R_KeepSource = (p && (strcmp(p, "yes") == 0)) ? 1 : 0;
                   ^

cc-1185 c89: WARNING File = options.c, Line = 371
  An enumerated type is mixed with another type.

                R_KeepSource = k;
                             ^

cc-1185 c89: WARNING File = options.c, Line = 433
  An enumerated type is mixed with another type.

                R_Slave = !k;
                        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c par.c -o par.o
cc-1185 c89: WARNING File = par.c, Line = 151
  An enumerated type is mixed with another type.

        dd->dp.ann = dd->gp.ann = (ix != 0);/* NA |-> TRUE */
                                ^

cc-1185 c89: WARNING File = par.c, Line = 155
  An enumerated type is mixed with another type.

        dd->dp.ask = dd->gp.ask = (ix == 1);/* NA |-> FALSE */
                                ^

cc-1185 c89: WARNING File = par.c, Line = 263
  An enumerated type is mixed with another type.

            dd->gp.defaultFigure = dd->dp.defaultFigure = 0;
                                                        ^

cc-1185 c89: WARNING File = par.c, Line = 286
  An enumerated type is mixed with another type.

        dd->gp.defaultFigure = dd->dp.defaultFigure = 0;
                                                    ^

cc-1185 c89: WARNING File = par.c, Line = 493
  An enumerated type is mixed with another type.

        dd->gp.new = dd->dp.new = 1;
                                ^

cc-1185 c89: WARNING File = par.c, Line = 530
  An enumerated type is mixed with another type.

        dd->dp.new = dd->gp.new = (ix != 0);
                                ^

cc-1185 c89: WARNING File = par.c, Line = 762
  An enumerated type is mixed with another type.

        dd->dp.xlog = dd->gp.xlog = (ix != 0);
                                  ^

cc-1185 c89: WARNING File = par.c, Line = 802
  An enumerated type is mixed with another type.

        dd->dp.ylog = dd->gp.ylog = (ix != 0);
                                  ^

cc-1185 c89: WARNING File = par.c, Line = 826
  An enumerated type is mixed with another type.

        dd->gp.ann = (ix != 0);
                   ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plot.c -o plot.o
cc-1185 c89: WARNING File = plot.c, Line = 442
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1552 c89: WARNING File = plot.c, Line = 611
  The variable "save_digits" is set but never used.

      int save_digits, i, n, w, d, e, wi, di, ei;
          ^

cc-1185 c89: WARNING File = plot.c, Line = 871
  An enumerated type is mixed with another type.

      doticks = asLogical(CAR(args));
              ^

cc-1185 c89: WARNING File = plot.c, Line = 1029
  An enumerated type is mixed with another type.

                axis_base = GConvertY(0.0, outer, NFC, dd)
                                           ^

cc-1185 c89: WARNING File = plot.c, Line = 1040
  An enumerated type is mixed with another type.

                axis_base =  GConvertY(1.0, outer, NFC, dd)
                                            ^

cc-1185 c89: WARNING File = plot.c, Line = 1129
  An enumerated type is mixed with another type.

                axis_base =  GConvertX(0.0, outer, NFC, dd)
                                            ^

cc-1185 c89: WARNING File = plot.c, Line = 1140
  An enumerated type is mixed with another type.

                axis_base =  GConvertX(1.0, outer, NFC, dd)
                                            ^

cc-1552 c89: WARNING File = plot.c, Line = 810
  The variable "col" is set but never used.

      int col, fg, font;
          ^

cc-1552 c89: WARNING File = plot.c, Line = 814
  The variable "vectorFonts" is set but never used.

      Rboolean vectorFonts = FALSE;
               ^

cc-1552 c89: WARNING File = plot.c, Line = 1769
  The variable "nborder" is set but never used.

      int ncol, nborder, nlty, xpd, i, start=0;
                ^

cc-1552 c89: WARNING File = plot.c, Line = 1769
  The variable "nlty" is set but never used.

      int ncol, nborder, nlty, xpd, i, start=0;
                         ^

cc-1552 c89: WARNING File = plot.c, Line = 2620
  The variable "fg" is set but never used.

      int which, col, fg;
                      ^

cc-1185 c89: WARNING File = plot.c, Line = 2932
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1185 c89: WARNING File = plot.c, Line = 2968
  An enumerated type is mixed with another type.

      dd->dp.defaultPlot = dd->gp.defaultPlot = 1;
                                              ^

cc-1552 c89: WARNING File = plot.c, Line = 2911
  The variable "save_mUnits" is set but never used.

      int save_mUnits, save_defaultPlot;
          ^

cc-1552 c89: WARNING File = plot.c, Line = 2911
  The variable "save_defaultPlot" is set but never used.

      int save_mUnits, save_defaultPlot;
                       ^

cc-1552 c89: WARNING File = plot.c, Line = 3316
  The variable "ncol" is set but never used.

      int ncol;
          ^

cc-1185 c89: WARNING File = plot.c, Line = 3359
  An enumerated type is mixed with another type.

        dd->gp.ask = 1;
                   ^

cc-1185 c89: WARNING File = plot.c, Line = 3369
  An enumerated type is mixed with another type.

        dd->gp.ask = ask;
                   ^

cc-1185 c89: WARNING File = plot.c, Line = 3512
  An enumerated type is mixed with another type.

                GConvert(&xx, &yy, USER, units, dd);
                                         ^

cc-1185 c89: WARNING File = plot.c, Line = 3515
  An enumerated type is mixed with another type.

                    rx = GConvertXUnits(0.5 * p0, INCHES, units, dd);
                                                          ^

cc-1185 c89: WARNING File = plot.c, Line = 3516
  An enumerated type is mixed with another type.

                    ry = GConvertYUnits(0.5 * p0, INCHES, units, dd);
                                                          ^

cc-1185 c89: WARNING File = plot.c, Line = 3519
  An enumerated type is mixed with another type.

                    rx = GConvertXUnits(0.5 * p0, USER, units, dd);
                                                        ^

cc-1185 c89: WARNING File = plot.c, Line = 3520
  An enumerated type is mixed with another type.

                    ry = GConvertYUnits(0.5 * p0, USER, units, dd);
                                                        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plot3d.c -o plot3d.o
cc-1552 c89: WARNING File = plot3d.c, Line = 193
  The variable "q1" is set but never used.

      double Ax, Bx, Ay, By, ax, ay, bx, by, q1, q2;
                                             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 193
  The variable "q2" is set but never used.

      double Ax, Bx, Ay, By, ax, ay, bx, by, q1, q2;
                                                 ^

cc-1552 c89: WARNING File = plot3d.c, Line = 479
  The variable "ns2" is set but never used.

      int i, ii, j, jj, k, l, m, nacode, ns, ns2, dir;
                                             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 484
  The variable "deltaXC" is set but never used.

      double dXC, dYC, deltaXC, deltaYC;
                       ^

cc-1552 c89: WARNING File = plot3d.c, Line = 484
  The variable "deltaYC" is set but never used.

      double dXC, dYC, deltaXC, deltaYC;
                                ^

cc-1552 c89: WARNING File = plot3d.c, Line = 487
  The variable "sum" is set but never used.

      double squareSum, sum;
                        ^

cc-1552 c89: WARNING File = plot3d.c, Line = 490
  The variable "zeroCount" is set but never used.

      int zeroCount;
          ^

cc-1552 c89: WARNING File = plot3d.c, Line = 492
  The variable "avg" is set but never used.

      double avg;
             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 1328
  The variable "nz" is set but never used.

      int i, j, k, npt, nx, ny, nz, nc, ncol, colsave, xpdsave;
                                ^

cc-1185 c89: WARNING File = plot3d.c, Line = 2201
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1552 c89: WARNING File = plot3d.c, Line = 47
  The variable "gcall" is set but never used.

  static SEXP gcall;
              ^

cc-1552 c89: WARNING File = plot3d.c, Line = 313
  The variable "ctr_xtol" is set but never used.

  static double ctr_xtol;
                ^

cc-1552 c89: WARNING File = plot3d.c, Line = 314
  The variable "ctr_ytol" is set but never used.

  static double ctr_ytol;
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plotmath.c -o plotmath.o
cc-1185 c89: WARNING File = plotmath.c, Line = 916
  An enumerated type is mixed with another type.

      return MathDevice->gp.font;
             ^

cc-1185 c89: WARNING File = plotmath.c, Line = 921
  An enumerated type is mixed with another type.

      FontType prevfont = MathDevice->gp.font;
                          ^

cc-1552 c89: WARNING File = plotmath.c, Line = 1380
  The variable "s5" is set but never used.

      double v, s5, s16;
                ^

cc-1551 c89: WARNING File = plotmath.c, Line = 1926
  The variable "ansBBox" is used before its value is set.

        return ansBBox;/*never reached*/
               ^

cc-1552 c89: WARNING File = plotmath.c, Line = 2275
  The variable "radDepth" is set but never used.

      double radWidth, radHeight, radDepth;
                                  ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2543
  An enumerated type is mixed with another type.

      SetFont(prevfont);
              ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2564
  An enumerated type is mixed with another type.

      SetFont(prevfont);
              ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2907
  An enumerated type is mixed with another type.

      GConvert(&ReferenceX, &ReferenceY, coords, INCHES, dd);
                                         ^

cc-1552 c89: WARNING File = plotmath.c, Line = 38
  The variable "BoxColor" is set but never used.

  static unsigned int BoxColor;
                      ^

cc-1552 c89: WARNING File = plotmath.c, Line = 39
  The variable "TextColor" is set but never used.

  static unsigned int TextColor;
                      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c print.c -o print.o
cc-1552 c89: WARNING File = print.c, Line = 81
  The variable "append_" is set but never used.

      int  append_, ifile, closeOnExit;
           ^

cc-1185 c89: WARNING File = print.c, Line = 446
  An enumerated type is mixed with another type.

      u = deparse1(s, 0);
                      ^

cc-1185 c89: WARNING File = print.c, Line = 487
  An enumerated type is mixed with another type.

            t = deparse1(s, 0);
                            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c printarray.c -o printarray.o
cc-1552 c89: WARNING File = printarray.c, Line = 448
  The variable "ii" is set but never used.

      SEXP ii, nn, dn, dnn;
           ^

cc-1552 c89: WARNING File = printarray.c, Line = 448
  The variable "nn" is set but never used.

      SEXP ii, nn, dn, dnn;
               ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c regex.c -o regex.o
cc-1552 c89: WARNING File = regex.c, Line = 4922
  The variable "pdummy" is set but never used.

              unsigned char *pdummy;
                             ^

cc-1552 c89: WARNING File = regex.c, Line = 4923
  The variable "sdummy" is set but never used.

              const char *sdummy;
                          ^

cc-1548 c89: WARNING File = regex.c, Line = 5245
  The transfer of control bypasses...

            ... the initialization of variable "same_str_p" (declared at line
                      4130).
      goto restore_best_regs;
      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c relop.c -o relop.o
cc-1185 c89: WARNING File = relop.c, Line = 59
  An enumerated type is mixed with another type.

        SEXP ans = real_relop(PRIMVAL(op), x, y);
                              ^

cc-1185 c89: WARNING File = relop.c, Line = 67
  An enumerated type is mixed with another type.

        SET_STRING_ELT(tmp, 0, (iS) ? PRINTNAME(x) : deparse1(x, 0));
                                                                 ^

cc-1185 c89: WARNING File = relop.c, Line = 74
  An enumerated type is mixed with another type.

        SET_STRING_ELT(tmp, 0, (iS) ? PRINTNAME(y) : deparse1(y, 0));
                                                                 ^

cc-1185 c89: WARNING File = relop.c, Line = 123
  An enumerated type is mixed with another type.

            mismatch = ((nx > ny) ? nx % ny : ny % nx) != 0;
                     ^

cc-1185 c89: WARNING File = relop.c, Line = 155
  An enumerated type is mixed with another type.

        x = string_relop(PRIMVAL(op), x, y);
                         ^

cc-1185 c89: WARNING File = relop.c, Line = 160
  An enumerated type is mixed with another type.

        x = complex_relop(PRIMVAL(op), x, y);
                          ^

cc-1185 c89: WARNING File = relop.c, Line = 165
  An enumerated type is mixed with another type.

        x = real_relop(PRIMVAL(op), x, y);
                       ^

cc-1185 c89: WARNING File = relop.c, Line = 168
  An enumerated type is mixed with another type.

        x = integer_relop(PRIMVAL(op), x, y);
                          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c saveload.c -o saveload.o
cc-1552 c89: WARNING File = saveload.c, Line = 1600
  The variable "d1234" is set but never used.

      int d1, d2, d3, d4, d1234;
                          ^

cc-1552 c89: WARNING File = saveload.c, Line = 44
  The variable "NVSize" is set but never used.

  static int NVSize;            /* Number of vector cells */
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c source.c -o source.o
cc-1552 c89: WARNING File = source.c, Line = 45
  The variable "pstacktop" is set but never used.

      int ifile, num, pstacktop, status;
                      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c subassign.c -o subassign.o
cc-1185 c89: WARNING File = subassign.c, Line = 157
  An enumerated type is mixed with another type.

      Rboolean redo_which =  (level == 1);
                             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c unique.c -o unique.o
cc-1185 c89: WARNING File = unique.c, Line = 625
  An enumerated type is mixed with another type.

        b = deparse1(funcall, 1);
                              ^

cc-1185 c89: WARNING File = unique.c, Line = 655
  An enumerated type is mixed with another type.

        b = deparse1(b, 1);
                        ^

cc-1185 c89: WARNING File = unique.c, Line = 663
  An enumerated type is mixed with another type.

        b = deparse1(CADDR(args), 1);
                                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c util.c -o util.o
cc-1185 c89: WARNING File = util.c, Line = 235
  An enumerated type is mixed with another type.

      return isString(x) && LENGTH(x) > 0 && !isNull(STRING_ELT(x, 0));
             ^

cc-1185 c89: WARNING File = util.c, Line = 241
  An enumerated type is mixed with another type.

      return isValidString(x) && CHAR(STRING_ELT(x, 0))[0];
             ^

cc-1185 c89: WARNING File = util.c, Line = 246
  An enumerated type is mixed with another type.

      return TYPEOF(s) == SYMSXP;
             ^

cc-1185 c89: WARNING File = util.c, Line = 263
  An enumerated type is mixed with another type.

      return (s == R_NilValue ||
             ^

cc-1185 c89: WARNING File = util.c, Line = 270
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == CLOSXP ||
             ^

cc-1185 c89: WARNING File = util.c, Line = 278
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == LISTSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 284
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == VECSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 358
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == NILSXP || TYPEOF(s) == ENVSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 364
  An enumerated type is mixed with another type.

      return TYPEOF(s) == EXPRSXP;
             ^

cc-1185 c89: WARNING File = util.c, Line = 370
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == LANGSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 400
  An enumerated type is mixed with another type.

      return (isVector(s) && getAttrib(s, R_TspSymbol) != R_NilValue);
             ^

cc-1185 c89: WARNING File = util.c, Line = 408
  An enumerated type is mixed with another type.

        return INTEGER(x)[0] == INTEGER(x)[0] &&
               ^

cc-1185 c89: WARNING File = util.c, Line = 433
  An enumerated type is mixed with another type.

        return mode;
               ^

cc-1185 c89: WARNING File = util.c, Line = 441
  An enumerated type is mixed with another type.

        return mode;
               ^

cc-1185 c89: WARNING File = util.c, Line = 522
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == STRSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 528
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == LGLSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 534
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP && !inherits(s, "factor"));
             ^

cc-1185 c89: WARNING File = util.c, Line = 540
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == REALSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 546
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == CPLXSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 552
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP
             ^

cc-1185 c89: WARNING File = util.c, Line = 560
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP
             ^

cc-1185 c89: WARNING File = util.c, Line = 568
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP  && inherits(s, "factor"));
             ^

cc-1185 c89: WARNING File = util.c, Line = 574
  An enumerated type is mixed with another type.

      return OBJECT(s);/* really `1-bit unsigned int' */
             ^

cc-1185 c89: WARNING File = util.c, Line = 667
  An enumerated type is mixed with another type.

      else return CHAR(x)[0] == '\0';
                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/unix/X11
c89   -o R.bin  RNG.o apply.o arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o connections.o context.o cov.o cum.o datetime.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o g_her_glyph.o g_fontdb.o g_cntrlify.o g_alab_her.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optim.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o regex.o relop.o saveload.o scan.o seq.o size.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o xxxpr.o ../unix/libunix.a ../appl/libappl.a ../nmath/libnmath.a -lcomplib.sgimath -LANG:=f77 -L/usr/lib32/mips3/r4000 -L/usr/lib32/mips3 -L/usr/lib32 -lftn -lm  -L/usr/local/lib  -lz -ldl -lncurses -lm
ld32: WARNING 84 : /usr/lib32/libz.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/lib32/libdl.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/local/lib/libncurses.a is not used for resolving any symbol.
------------------------------------------------------------------------
c89 -I. -I../../../src/include -I../../../src/include  -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON -KPIC  -g -c dataentry.c -o dataentry.o
cc-1185 c89: WARNING File = dataentry.c, Line = 843
  An enumerated type is mixed with another type.

            Rboolean warn = !isBlankString(endp);
                            ^

cc-1552 c89: WARNING File = dataentry.c, Line = 1240
  The variable "i" is set but never used.

      int i;
          ^

cc-1552 c89: WARNING File = dataentry.c, Line = 1250
  The variable "i" is set but never used.

      int i;
          ^

cc-1552 c89: WARNING File = dataentry.c, Line = 148
  The variable "hand_cursor" is set but never used.

  static Cursor           hand_cursor;
                          ^

------------------------------------------------------------------------
c89 -I. -I../../../src/include -I../../../src/include  -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON -KPIC  -g -c devX11.c -o devX11.o
cc-1552 c89: WARNING File = devX11.c, Line = 250
  The variable "imin" is set but never used.

      int i, imin;
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 417
  The variable "imin" is set but never used.

      int i, imin;
             ^

cc-1136 c89: WARNING File = devX11.c, Line = 552
  Too many arguments in function call.

            SetupPseudoColor(model);
                             ^

cc-1136 c89: WARNING File = devX11.c, Line = 561
  Too many arguments in function call.

            SetupPseudoColor(model);
                             ^

cc-1185 c89: WARNING File = devX11.c, Line = 1595
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1596
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1656
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devX11.c, Line = 1688
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1689
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1722
  An enumerated type is mixed with another type.

        GConvert(&devx, &devy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devX11.c, Line = 1766
  An enumerated type is mixed with another type.

        GConvert(&devx, &devy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devX11.c, Line = 1771
  An enumerated type is mixed with another type.

      GConvert(&devx, &devy, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = devX11.c, Line = 1814
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1552 c89: WARNING File = devX11.c, Line = 1806
  The variable "len" is set but never used.

      int len, size;
          ^

cc-1185 c89: WARNING File = devX11.c, Line = 1837
  An enumerated type is mixed with another type.

      if (xd->type > WINDOW) return 0;
                                    ^

cc-1185 c89: WARNING File = devX11.c, Line = 1865
  An enumerated type is mixed with another type.

      return (done == 1);
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "RedLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "GreenLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
                        ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "BlueLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
                                     ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library
c89 -shared  -o R_X11.so  dataentry.o devX11.o rotated.o rbitmap.o -lSM -lICE -L/usr/local/lib -lX11  -L/usr/local/lib -ljpeg -lpng -lz -L/usr/local/lib  -lz -ldl -lncurses -lm
ld32: WARNING 84 : /usr/lib32/libSM.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/lib32/libdl.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/local/lib/libncurses.a is not used for resolving any symbol.
------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/ctest/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c fexact.c -o fexact.o
cc-1185 c89: WARNING File = fexact.c, Line = 389
  An enumerated type is mixed with another type.

      nr_gt_nc =  *nrow > *ncol;
               ^

------------------------------------------------------------------------
c89 -shared  -o ctest.so ansari.o d2x2xk.o fexact.o kendall.o ks.o prho.o swilk.o -L/usr/local/lib -LANG:=f77 -L/usr/lib32/mips3/r4000 -L/usr/lib32/mips3 -L/usr/lib32 -lftn -lm
ld32: WARNING 84 : /usr/lib32/mips3/libftn.so is not used for resolving any symbol.
------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/eda/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c smooth.c -o smooth.o
cc-1185 c89: WARNING File = smooth.c, Line = 51
  An enumerated type is mixed with another type.

        chg = chg || j;
            ^

cc-1185 c89: WARNING File = smooth.c, Line = 76
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 76
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 97
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);/* =>  chg = TRUE  iff  ends changed */
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 97
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);/* =>  chg = TRUE  iff  ends changed */
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 141
  An enumerated type is mixed with another type.

                chg = y[i] != x[i];
                    ^

cc-1185 c89: WARNING File = smooth.c, Line = 146
  An enumerated type is mixed with another type.

                chg = y[i+1] != x[i+1];
                    ^

cc-1185 c89: WARNING File = smooth.c, Line = 202
  An enumerated type is mixed with another type.

        ch2 = sm_3R(z, y, w, n, end_rule);
            ^

cc-1185 c89: WARNING File = smooth.c, Line = 203
  An enumerated type is mixed with another type.

        chg = chg || ch2;
            ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/nls/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c nls.c -o nls.o
cc-1552 c89: WARNING File = nls.c, Line = 66
  The variable "convNew" is set but never used.

      double dev, fac, minFac, tolerance, newDev, convNew;
                                                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/ts/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c mburg.c -o mburg.o
cc-1552 c89: WARNING File = mburg.c, Line = 222
  The variable "s_inv" is set but never used.

      Array s, s_inv, tmp, d1;
               ^

cc-1552 c89: WARNING File = mburg.c, Line = 225
  The variable "id" is set but never used.

      Array id;
            ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/tcltk/src
c89 -I../../../../include -I/usr/local/include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c tcltk.c -o tcltk.o
cc-1552 c89: WARNING File = tcltk.c, Line = 39
  The variable "ans" is set but never used.

      SEXP text, expr, ans;
                       ^

cc-1552 c89: WARNING File = tcltk.c, Line = 70
  The variable "ans" is set but never used.

      SEXP expr, ans, fun, alist;
                 ^

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- Center for Scientific Computing       FAX: +1 801 585 1640, +1 801 581 4148 -
- University of Utah                    Internet e-mail: beebe@math.utah.edu  -
- Department of Mathematics, 322 INSCC      beebe@acm.org  beebe@computer.org -
- 155 S 1400 E RM 233                       beebe@ieee.org                    -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -
-------------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From beebe@math.utah.edu  Sat Feb 17 01:47:00 2001
From: beebe@math.utah.edu (beebe@math.utah.edu)
Date: Sat, 17 Feb 2001 02:47:00 +0100 (MET)
Subject: [Rd] More comments on R-1.2.1 builds (PR#852)
Message-ID: <200102170147.CAA19365@pubhealth.ku.dk>

On IBM RS/6000 AIX 4.2, I built R-1.2.1 with

% env CC=xlc CXX=xlC F77=f77 FC=f77 ./configure

R is now configured for powerpc-ibm-aix4.2.1.0

  Source directory:          .
  Installation directory:    /usr/local
  C compiler:                c89  -g
  C++ compiler:              xlC  -g
  FORTRAN compiler:          f77  -g

  X11 support:               yes
  Gnome support:             no
  Tcl/Tk support:            yes

  R profiling support:       yes
  R as a shared library:     no

However, the R-1.2.1 build fails in a number of places:

c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -c fortran.c -o fortran.o
"../../src/include/Fortran.h", line 43.9: 1506-213 (S) Macro name abs cannot
be redefined.
"../../src/include/Fortran.h", line 43.9: 1506-358 (I) "abs" is defined on
line 362 of /usr/include/stdlib.h.

I found that putting "#undef abs" before line 43 of Fortran.h solves
that problem.

It then dies later in compilation of several routines, of which this
is typical:

c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -c devices.c -o devices.o
"../../src/include/Startup.h", line 48.14: 1506-009 (S) Bit-field R_Quiet
must be of type signed int, unsigned int or int.
...

The complaint is from the use of a bitfield modifier on an enum;
gcc will compile this code, but IBM's cc and c89 will not.

This appears to be a violation of 1989 Standard C: in ANSI
X3.159-1989, on p. 61, section 3.5.2.1, I find at line 30:

>> ...
>> A bit-field shall have a type that is a qualified or unqualified
>> version of one of {\bf int}, {\bf unsigned int}, or {\bf signed int}. ...
>> ...

On the p. 62 in section 3.5.2.2, line 60:

>> ...
>> Each enumerated type shall be compatible with an integer type; the
>> choice of type is implementation-defined.
>> ...

In particular, if an enum is treated as char, short, long, or long
long, then it does not match the requirement of section 3.5.2.1.

To test this further, I made an experiment:

	% cat boo.c
	#if 1
	typedef enum { apple = 0, pear } Fruit;
	#else
	typedef int Fruit;
	#endif


	typedef struct boo {
	    Fruit x : 1;
	} S_Fruit;

	S_Fruit y;

On Sun Solaris 2.7:

	% c89 -Xa -c boo.c
	% c89 -Xt -c boo.c
	% c89 -Xc -c boo.c
	"boo.c", line 9: warning: nonportable bit-field type
	% cc -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% CC -c boo.c
	% g++ -c boo.c

On SGI IRIX 6:

	% c89 -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% CC -c boo.c
	% g++ -c boo.c

On Compaq/DEC Alpha OSF/1 4.0:

	% c89 -c boo.c
	cc: Info: boo.c, line 9: In the declaration of "x", the bitfield type is not an int, signed int or unsigned int. (bitnotint)
	    Fruit x : 1;
	----------^
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% cxx -c boo.c
	% g++ -c boo.c

On GNU/Linux (Redhat 6.2) on Intel x86:

	% cc -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% g++ -c boo.c
	% pgcc -c boo.c
	% pgCC -c boo.c

On IBM RS/6000 AIX 4.3:
	% cc -c boo.c
	"boo.c", line 9.11: 1506-159 (E) Bit-field type specified for x is not valid. Type unsigned assumed.
	% gcc -c boo.c
	CC -c boo.c
	% CC -c boo.c
	% g++ -c boo.c
	% c89 -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.
	% xlC -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.
	% xlc -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.

Thus, the stricter 1989 Standard C compilers reject the use of the enum in
a bitfield.

C++ (ISO/IEC 14882-1998) says in section 9.5:

>> ...
>> 4 If the value true or false is stored into a bit-field of type bool
>> of any size (including a one bit bit-field), the original bool value
>> and the value of the bit-field shall compare equal.  If the value of
>> an enu-merator is stored into a bit-field of the same enumeration type
>> and the number of bits in the bit-field is large enough to hold all
>> the values of that enumeration type, the original enumerator value and
>> the value of thebit-field shall compare equal.
>> ...

This suggests that Standard C++ permits enums to have bitfield
modifiers.  However, as far as I know, there are not yet any Standard
C++ compilers available on any platform.

I could not find definitive language in ISO/IEC 9899-1999, the 1999 C
Standard on this point.

In summary, it seems best to eliminate the bitfield modifiers on enum
data.  Even if this involves a small memory penalty, it will probably
make the code faster, since bitmasking and shifting is no longer
needed to access the fields.

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- Center for Scientific Computing       FAX: +1 801 585 1640, +1 801 581 4148 -
- University of Utah                    Internet e-mail: beebe@math.utah.edu  -
- Department of Mathematics, 322 INSCC      beebe@acm.org  beebe@computer.org -
- 155 S 1400 E RM 233                       beebe@ieee.org                    -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -
-------------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sat Feb 17 14:25:13 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sat, 17 Feb 2001 15:25:13 +0100
Subject: [Rd] Comments on R-1.2.1 builds (PR#851)
In-Reply-To: <200102170044.BAA19310@pubhealth.ku.dk>
References: <200102170044.BAA19310@pubhealth.ku.dk>
Message-ID: <14990.35273.167526.4092@mithrandir.hornik.net>

>>>>> beebe  writes:

> The R-1.2.1 builds have gone fairly smoothly on most of my UNIX
> architectures, but there were many warnings reported by the picky SGI
> compiler that could be eliminated in future releases.

> Generally, I have found the SGI compilers very helpful in ferreting
> out portability problems, unused and/or obsolete variables, unexpected
> datatype coercions, etc., and they compile faster than any other
> compilers too.

> First, I configured like this:

> env CC='c89 -mips3 -O3' ./configure && make all

> This reports:

> 	R is now configured for mips-sgi-irix6.5

> 	  Source directory:          .
> 	  Installation directory:    /usr/local
> 	  C compiler:                c89 -mips3 -O3  -OPT:IEEE_NaN_inf=ON -g
> 	  C++ compiler:              c++  -g -O2
> 	  FORTRAN compiler:          g77  -OPT:IEEE_NaN_inf=ON -g -O2

> 	  X11 support:               yes
> 	  Gnome support:             no
> 	  Tcl/Tk support:            yes

> 	  R profiling support:       yes
> 	  R as a shared library:     no

> The build proceeds until this failure:

> 	g77 -OPT:IEEE_NaN_inf=ON  -g -O2 -c ch2inv.f -o ch2inv.o
> 	f771: Invalid option `-OPT:IEEE_NaN_inf=ON'
> 	make[3]: *** [ch2inv.o] Error 1

> Evidently, it was not prepared for the GNU Fortran compiler.

Yep, that is a bug.  I need some feedback for fixing this, though.  The
current logic is to run the autoconf R_C_OPTIEEE test if the platform is
IRIX.  The test itself tries to compile and run

#include <math.h>
#include <ieeefp.h>
int main () {
  double x = 0;
  fpsetmask(0); x = x / x; return (x != x);
}

and if that works adds -OPT:IEEE_NaN_inf=ON to both R_XTRA_CFLAGS and
R_XTRA_FFLAGS.

This obviously does not make sense for FORTRAN, and should be made more
defensive for C.

* For C, one should additionally test whether the compiler accepts this
  flag.  I assume gcc would not, so should we do

	if_not_using_gcc  check_arg("-OPT:IEEE_NaN_inf=ON")

* For FORTRAN, I am not sure whether the result of the above test has
  any relevance.  Question is, do we have a FORTRAN test program similar
  to the above to determine whether the flag is needed?  Again, we
  should also check whether the compiler accepts the flag ...

* Or should we simply unconditionally add the flag for ``native'', i.e.,
  non-GNU compilers?

(Sorry but I do not have access to SGIs ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb 17 15:01:32 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat, 17 Feb 2001 16:01:32 +0100 (MET)
Subject: [Rd] More comments on R-1.2.1 builds (PR#852)
Message-ID: <200102171501.QAA20856@pubhealth.ku.dk>

On Sat, 17 Feb 2001 beebe@math.utah.edu wrote:

> On IBM RS/6000 AIX 4.2, I built R-1.2.1 with
>
> % env CC=xlc CXX=xlC F77=f77 FC=f77 ./configure
>
> R is now configured for powerpc-ibm-aix4.2.1.0
>
>   Source directory:          .
>   Installation directory:    /usr/local
>   C compiler:                c89  -g
>   C++ compiler:              xlC  -g
>   FORTRAN compiler:          f77  -g
>
>   X11 support:               yes
>   Gnome support:             no
>   Tcl/Tk support:            yes
>
>   R profiling support:       yes
>   R as a shared library:     no
>
> However, the R-1.2.1 build fails in a number of places:
>
> c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -c fortran.c -o fortran.o
> "../../src/include/Fortran.h", line 43.9: 1506-213 (S) Macro name abs cannot
> be redefined.
> "../../src/include/Fortran.h", line 43.9: 1506-358 (I) "abs" is defined on
> line 362 of /usr/include/stdlib.h.
>
> I found that putting "#undef abs" before line 43 of Fortran.h solves
> that problem.

That definition is no longer used in the files using that header, and has
been deleted.  It looks like the file fortran.c is redundant too.

> It then dies later in compilation of several routines, of which this
> is typical:
>
> c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -c devices.c -o devices.o
> "../../src/include/Startup.h", line 48.14: 1506-009 (S) Bit-field R_Quiet
> must be of type signed int, unsigned int or int.
> ...

This seems a mis-placed fit of enthusiasm!  As the designer of that
structure I certainly did not pack it, and there is just one instance of it
per R process.  I have removed the packing, which was added last November,
documented `many more cleanups' from the CVS logs.

(These changes refer to 1.2.2, which is planned for a couple of weeks.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Feb 18 10:10:40 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 18 Feb 2001 11:10:40 +0100
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>
References: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>
Message-ID: <14991.40864.896451.453333@mithrandir.hornik.net>

>>>>> Paul Gilbert writes:

> I am trying to catch a segfault from a shell in the tests directory
> set up by R CMD check with

> R_LIBS=~/dse/CHECKED/library:..
> export R_LIBS
> R -d gdb
> run

> but then when I try to load a library I find the setting of R_LIBS is
> ignored. What am I doing wrong? The library is found ok without -d
> gdb. (Using Solaris 2.6, R 1.2.1 Patched (2001-02-06) )

Hmm ... hard to believe:

hornik@mithrandir:~/tmp$ export R_LIBS=~/dse/CHECKED/library:..
hornik@mithrandir:~/tmp$ R -d gdb
GNU gdb 19990928
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(gdb) r
...
R> Sys.getenv("R_LIBS")
                               R_LIBS 
"/home/Hornik/dse/CHECKED/library:.." 

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 18 11:05:08 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 18 Feb 2001 11:05:08 +0000 (GMT)
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <14991.40864.896451.453333@mithrandir.hornik.net>
Message-ID: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>

On Sun, 18 Feb 2001, Kurt Hornik wrote:

> >>>>> Paul Gilbert writes:
>
> > I am trying to catch a segfault from a shell in the tests directory
> > set up by R CMD check with
>
> > R_LIBS=~/dse/CHECKED/library:..
> > export R_LIBS
> > R -d gdb
> > run
>
> > but then when I try to load a library I find the setting of R_LIBS is
> > ignored. What am I doing wrong? The library is found ok without -d
> > gdb. (Using Solaris 2.6, R 1.2.1 Patched (2001-02-06) )
>
> Hmm ... hard to believe:
>
> hornik@mithrandir:~/tmp$ export R_LIBS=~/dse/CHECKED/library:..
> hornik@mithrandir:~/tmp$ R -d gdb
> GNU gdb 19990928
> Copyright 1998 Free Software Foundation, Inc.
> GDB is free software, covered by the GNU General Public License, and you are
> welcome to change it and/or distribute copies of it under certain conditions.
> Type "show copying" to see the conditions.
> There is absolutely no warranty for GDB.  Type "show warranty" for details.
> This GDB was configured as "i686-pc-linux-gnu"...
> (gdb) r
> ...
> R> Sys.getenv("R_LIBS")
>                                R_LIBS
> "/home/Hornik/dse/CHECKED/library:.."

Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
(gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From baron@cattell.psych.upenn.edu  Sun Feb 18 21:43:52 2001
From: baron@cattell.psych.upenn.edu (baron@cattell.psych.upenn.edu)
Date: Sun, 18 Feb 2001 22:43:52 +0100 (MET)
Subject: [Rd] match vs. %in% (PR#853)
Message-ID: <200102182143.WAA24872@pubhealth.ku.dk>

This isn't really a bug so much as an undocumented feature, but
perhaps the help file should be changed.

If you say
match(x,y)
you get the values of the _first_ instance in y that matches each
value of x.

If you say 
x %in% y
you get "TRUE" for every match, not just the first.

This is useful, now that I know it, but perhaps the thing
about the first instance should be documented.

I still don't understand why it happens!

Jon

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Sun Feb 18 22:41:56 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Mon, 19 Feb 2001 11:41:56 +1300
Subject: [Rd] Re: polygon border colors
References: <Pine.SUN.3.91.1010216085824.11176B@okapi.cor.epa.gov>
Message-ID: <012501c099fb$ffb7cad0$175dd882@stat.auckland.ac.nz>

Hi


> I think I see in do_polygon() in plot.c that border colors are
> not cycled, and that changes in the lines
>
> ...
>     PROTECT(border = FixupCol(CAR(args), dd->gp.fg)); args = CDR(args);
> ...
> GPolygon(i-start, x+start, y+start, USER,
> INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
> ...
>     GPolygon(nx-start, x+start, y+start, USER,
>      INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
> ...
>
> following the pattern for "col" might make cycling possible.
>
> Is this a change that I should try locally, or could this be
> considered for the standard version?


There is now a fix in the release version of R, which should come out fairly
soon.  There is also a fix to recycle the lty argument, plus documentation
and an example to show how you can get multiple polygons out of a single
call to polygon() using NA coordinates.

Thanks for the bug report and suggested solution.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 19 07:24:55 2001
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Feb 2001 07:24:55 +0000 (GMT)
Subject: [Rd] match vs. %in% (PR#853)
In-Reply-To: <200102182143.WAA24872@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0102190719130.26442-100000@auk.stats>

On Sun, 18 Feb 2001 baron@cattell.psych.upenn.edu wrote:

> This isn't really a bug so much as an undocumented feature, but
> perhaps the help file should be changed.
>
> If you say
> match(x,y)
> you get the values of the _first_ instance in y that matches each
> value of x.

Yes, but one match or not for each instance of x.

> If you say
> x %in% y
> you get "TRUE" for every match, not just the first.

You get a result for each element of x, not y.

Both return a result for each element of x. match returns the index of the
first match or `nomatch',  %in% returns TRUE or FALSE.

is.element is a synonym of %in% compatible with S, which uses %in% for
something else (nesting in formulae).

> This is useful, now that I know it, but perhaps the thing
> about the first instance should be documented.

Yes, ?match needs a `details' section.  I'll add one.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Mon Feb 19 09:35:36 2001
From: adrian@olsen.ch (Adrian Trapletti)
Date: Mon, 19 Feb 2001 10:35:36 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
 <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk> <pxwvaqse73.fsf@infiniti.ece.cmu.edu>
Message-ID: <3A90E8E7.7A066F7@olsen.ch>


Thomas Vogels wrote:

> Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk> writes:
>
> > Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> >
> > > > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > > > From: Adrian Trapletti <adrian@olsen.ch
> > >
> > > > I don't know if it has something to do with this discussion, but it's
> > > > probably worth reporting it.
> > > >
> > > > Under
> > > > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > > > R : Version 1.2.1  (2001-01-15)
> > > > Fvwm95 Version 2.0.43a
> > > > the window manager always crashes when I close an x11() device started
> > > > within R.
> > >
> > > This discussion is about png() and jpeg() devices.  We've had other
> > > reports about FVWM, though.
> >
> > ...and they too refer to improper error handling by X11. I'm somewhat
> > baffled by the effect reported, though. Surely, an application
> > crashing the window manager is a bug in the latter, not the former?
> > What we've heard of before is that closing X11 windows with the window
> > manager crashes R, but this sounds like the other way around.
>
> The question about freeing xd and dd comes indeed from my fiddling
> with the X11 driver and understanding the code there...  As for the
> current handleEvent: there are some events simply ignored (like the
> DestroyNotify event) and some are not reaped due to the sequence of
> events in X11_Close/R_ProcessEvents.  (And the way inclose is handled
> is scary once you think of closing two windows at roughly the same
> time...)  The events that linger after R is done shouldn't confuse the
> window manager, though.
>
> I've put my code, patches, comments, suggestions, etc. at:
> http://www.ece.cmu.edu/~tov/public/R/X11andTk.html
> I'd be curious whether R with the patched handleEvent still crashes
> FVWM95.  Probably but who knows.

First, I was somewhat sleeping when I reported this problem. It is not
window-close which causes the crash, but window-minimize (iconify 1) (sorry for
that).

I recompiled R-1.2.1 with your patch. FVWM95 still crashes when I minimize the
x11 device. Furthermore, no other WM (olwm, fvwm, fvwm2, icewm) crashes.

Adrian


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Feb 19 16:27:22 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Feb 2001 11:27:22 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
Message-ID: <3A914969.3A17BA04@bank-banque-canada.ca>

>Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
>(gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

This is the clue, though --vanilla doesn't fix it. R_LIBS is set in my
.cshrc file and when I use R -d gdb it grabs the setting from there (but
not when I don't use "-d gdb"). This seems a bit strange since I am
actually running this from sh (which I started from a csh). However, it
is not grabbing the R_LIBS setting from the original csh but directly
from the .cshrc file since it changes when I comment out the setting in
.cshrc and simply restart "R -d gdb".

Thanks,
Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Feb 20 13:45:00 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 20 Feb 2001 14:45:00 +0100
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <3A914969.3A17BA04@bank-banque-canada.ca>
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
 <3A914969.3A17BA04@bank-banque-canada.ca>
Message-ID: <14994.29916.987350.524484@mithrandir.hornik.net>

>>>>> Paul Gilbert writes:

>> Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
>> (gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

> This is the clue, though --vanilla doesn't fix it. R_LIBS is set in my
> .cshrc file and when I use R -d gdb it grabs the setting from there
> (but not when I don't use "-d gdb"). This seems a bit strange since I
> am actually running this from sh (which I started from a
> csh). However, it is not grabbing the R_LIBS setting from the original
> csh but directly from the .cshrc file since it changes when I comment
> out the setting in .cshrc and simply restart "R -d gdb".

I am confused.  But here's what the GDB info page says:

   *Warning:* On Unix systems, GDB runs your program using the shell
indicated by your `SHELL' environment variable if it exists (or
`/bin/sh' if not).  If your `SHELL' variable names a shell that runs an
initialization file--such as `.cshrc' for C-shell, or `.bashrc' for
BASH--any variables you set in that file affect your program.  You may
wish to move setting of environment variables to files that are only
run when you sign on, such as `.login' or `.profile'.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Feb 20 17:01:40 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 20 Feb 2001 12:01:40 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
 <3A914969.3A17BA04@bank-banque-canada.ca> <14994.29916.987350.524484@mithrandir.hornik.net>
Message-ID: <3A92A2F4.9B71740B@bank-banque-canada.ca>

Kurt

>   *Warning:* On Unix systems, GDB runs your program using the shell
> indicated by your `SHELL' environment variable if it exists (or
> `/bin/sh' if not).  If your `SHELL' variable names a shell that runs an
> initialization file--such as `.cshrc' for C-shell, or `.bashrc' for
> BASH--any variables you set in that file affect your program.  You may
> wish to move setting of environment variables to files that are only
> run when you sign on, such as `.login' or `.profile'.

Thanks, that explains it.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Feb 20 18:12:19 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 20 Feb 2001 13:12:19 -0500
Subject: [Rd] segfault
Message-ID: <3A92B383.422D1435@bank-banque-canada.ca>

I've managed to trap the following segfault with xxgdb and gctorture() set. The
segfault seems to move around if gctorture() is not set, but has now occurred twice
in the same spot with it set.  xxgdb gives the message

Program received signal SIGSEGV, Segmentation fault.
0x71244 in RunGenCollect (size_needed=2) at memory.c:1027

and the source listing points to FORWARD_CHILDREN(s); in the following section from
src/main/memory.c

#ifndef EXPEL_OLD_TO_NEW
    /* scan nodes in uncollected old generations with old-to-new pointers */
    for (gen = num_old_gens_to_collect; gen < NUM_OLD_GENERATIONS; gen++)
 for (i = 0; i < NUM_NODE_CLASSES; i++)
     for (s = NEXT_NODE(R_GenHeap[i].OldToNew[gen]);
   s != R_GenHeap[i].OldToNew[gen];
   s = NEXT_NODE(s))
  FORWARD_CHILDREN(s);
#endif


I'm using
> version
         _
platform sparc-sun-solaris2.6
arch     sparc
os       solaris2.6
system   sparc, solaris2.6
status   Patched
major    1
minor    2.1
year     2001
month    02
day      06
language R

Paul Gilbert

P.S. If someone can quickly tell me the trick to make cut and paste work with xxgdb
in Solaris I would appreciate it. (I realize I should probably read the manual, but
if it is simple please let me know.)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Tue Feb 20 20:09:21 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 20 Feb 2001 21:09:21 +0100
Subject: [Rd] segfault
In-Reply-To: Paul Gilbert's message of "Tue, 20 Feb 2001 13:12:19 -0500"
References: <3A92B383.422D1435@bank-banque-canada.ca>
Message-ID: <x266i5m80e.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> I've managed to trap the following segfault with xxgdb and gctorture() set. The
> segfault seems to move around if gctorture() is not set, but has now occurred twice
> in the same spot with it set.  xxgdb gives the message
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x71244 in RunGenCollect (size_needed=2) at memory.c:1027
> 
> and the source listing points to FORWARD_CHILDREN(s); in the following section from
> src/main/memory.c
> 
> #ifndef EXPEL_OLD_TO_NEW
>     /* scan nodes in uncollected old generations with old-to-new pointers */
>     for (gen = num_old_gens_to_collect; gen < NUM_OLD_GENERATIONS; gen++)
>  for (i = 0; i < NUM_NODE_CLASSES; i++)
>      for (s = NEXT_NODE(R_GenHeap[i].OldToNew[gen]);
>    s != R_GenHeap[i].OldToNew[gen];
>    s = NEXT_NODE(s))
>   FORWARD_CHILDREN(s);
> #endif
> 

This just shows that something corrupted the memory handling. The
actual bug is probably somewhat prior to this. If you do a "bt"
(backtrace) and go "up" a couple of times, you might find a spot where
someone forgot to PROTECT() a newly created R object.


> P.S. If someone can quickly tell me the trick to make cut and paste work with xxgdb
> in Solaris I would appreciate it. (I realize I should probably read the manual, but
> if it is simple please let me know.)

I gave up on xxgdb long ago because I thought it was enough to have to
deal with bugs in our own programs! However, it would seem that the
ordinary mousing techniques works as usual on Linux. Command-line
recall appears to be shot, however.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@pubhealth.ku.dk  Wed Feb 21 06:15:04 2001
From: pd@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: Wed, 21 Feb 2001 07:15:04 +0100
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200102210615.HAA18304@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.r-project.org or via email to
r-bugs@r-project.org. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 751 *
Subject: BUG: polyroot()
From: "Li Dongfeng" <mavip1@inet.polyu.edu.hk>
Date: Tue, 28 Nov 2000 13:24:33 +0800
--Numerical instability. We may want a better algorithm!

Directory:  Add-ons

* PR# 824 *
Subject: trouble with netCDF 
From: jasont@indigoindustrial.co.nz
Date: Thu, 25 Jan 2001 12:00:39 +1300
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 812 *
Subject: segmentation fault in integrate
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Thu, 11 Jan 2001 22:49:59 +0100
* PR# 781 *
Subject: syskern fails Rcmd check on Windows, gives incorrect information
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 20 Dec 2000 11:12:47 +0000 (GMT)
--Partially fixed by dse_2000.12, but still uses "ls" and gives
--incorrect information

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 839 *
Subject: clipped lines have wrong slope in log plot
From: Jason Eisner <jason@cs.rochester.edu>
Date: Sun, 4 Feb 2001 20:17:31 -0500 (EST)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
* PR# 750 *
Subject: abline() does not obey "xpd" (clipping rules)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 27 Nov 2000 18:27:11 +0100
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix is incorporated in 1.2.2.
--
--There is a deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--Paul thinks the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above 
--mayhave side-effects in many other pieces of interpreted code 
--(ii) do_mtext ignores dd->gp.cexbase unlike, for example, do_plot_xy 
--and anything to do with cexbase needs extreme care.
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
* PR# 830 *
Subject: Disappearing x axis in plot.factor
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:27:13 -0500
* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
--Neither of the proposed changes actually works in sufficient generality.
--
--The easy and unimportant part of this, the labels, is fixed in 1.2.2. Getting
--the data right is a project for 1.3
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500

Directory:  In-Out

* PR# 814 *
Subject: Memory problem ?
From: Zoltan Barta <Z.Barta@bristol.ac.uk>
Date: Mon, 15 Jan 2001 09:54:16 +0000 (GMT Standard Time)
--scan crashes R on Linux: a memory allocation problem, probably
--Uses n= or nlines= in scan will use less memory, and read.table does.

Directory:  Installation

none

Directory:  Language

* PR# 813 *
Subject: match.call problem
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jan 2001 17:46:15 +0100
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 851 *
Subject: Comments on R-1.2.1 builds
From: "Nelson H. F. Beebe" <beebe@math.utah.edu>
Date: Fri, 16 Feb 2001 17:44:17 -0700 (MST)
--These are only warnings: some have been eliminated for 1.2.2.
--Some are about constructs needed to satisfy other compilers.
--
--Also: configure problem with g77 on SGI.
* PR# 822 *
Subject: Re: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:56:32 +0100 (CET)
--part of 821
* PR# 821 *
Subject: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:44:28 +0100 (CET)
--See also 822, which shows the segfault is in strftime.c.
--From other correspondence, this is on RH5.0: we can't
--reproduce it on RH6.2 or anywhere else.
* PR# 848 *
Subject: X11 device doesn't handle destroy events correcly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
* PR# 838 *
Subject: Linux shared library problem
From: daniel.egloff@dplanet.ch
Date: Sun, 4 Feb 2001 22:37:31 +0100 (MET)
--RedHat 7.0: need updates?

Directory:  TooMuchAtOnce

* PR# 811 *
Subject: problem with strptime example (and mention of bug.report)
From: Stephen Eglen <stephen@anc.ed.ac.uk>
Date: Thu, 11 Jan 2001 19:18:39 GMT
--1) On OSF4, strptime is deficient. Nothing we can do.
--
--2) On Windows NT, the strptime problems are (i) German locale, English dates,
--(ii) Windows system errors with unknown DST (it move times to DST).
--(i) now has another warning in the help file (there already was one).
--(ii) was already worked around for 1.2.1.
--
--3) bug.report() uses a mailer option that does not exist on OSF4.

Directory:  Windows

none

Directory:  incoming

none
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pperkins@ucsd.edu  Thu Feb 22 07:36:55 2001
From: pperkins@ucsd.edu (pperkins@ucsd.edu)
Date: Thu, 22 Feb 2001 08:36:55 +0100 (MET)
Subject: [Rd] onefile= arg to postscript() (PR#854)
Message-ID: <200102220736.IAA07846@pubhealth.ku.dk>

Full_Name: Peter Perkins
Version: 1.2.1
OS: LinuxPPC
Submission from: (NULL) (24.4.89.36)


Unlike (at least some) other args/components of ps.options(), the onefile=
arg to postscript() does not default to ps.options()$onefile.  For the family=
and landscape= args, for example, it does.  Looking at postscript()'s code,
this
appears to be intentional.  If it _is_ intentional, the following clarification
might be added to the "onefile" line of the arguments section of the
postscript/ps.options help:

   "the onefile= arg to postscript() does _not_ default to the value set
    in the most recent call to ps.options(); rather, it defaults to TRUE."

but this raises the question, "just where _is_ the onefile arg to ps.options()
used, if not by postscript()?"

if the current behavior is not correct, then the solution seems to be
to change the default value to .PostScript.Options$onefile, if that's not
too ugly.  leaving onefile= out of the arg list would work, except then
the file= arg is left hanging.  for what it's worth, the explicit family=
arg seems to be superfluous, it would be handled by ... and the call to
check.options().

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 22 08:03:36 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 22 Feb 2001 09:03:36 +0100 (MET)
Subject: [Rd] onefile= arg to postscript() (PR#854)
Message-ID: <200102220803.JAA08341@pubhealth.ku.dk>

On Thu, 22 Feb 2001 pperkins@ucsd.edu wrote:

> for what it's worth, the explicit family=
> arg seems to be superfluous, it would be handled by ... and the call to
> check.options().

That is untrue, as you will see if you try it.
Take a look at the comment in the code, please.

    ## handle family separately as length can be 1 or 4
    if(!missing(family)) old$family <- family

In case you had not noticed, check.options would insist on length 1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gilb@home.com  Thu Feb 22 18:05:24 2001
From: gilb@home.com (Paul Gilbert)
Date: Thu, 22 Feb 2001 13:05:24 -0500
Subject: [Rd] segfault
Message-ID: <3A9554E3.357804E9@home.com>

A few people suggested ddd might be preferred to xxgdb, where upon xxgdb
crashed on me. I have now managed to get ddd working on my linux box at
home, but am still having some difficulty at work. (It requires a newer
c++ ,  some *tif libraries, etc.)

---- Peter D.  writes:
>The actual bug is probably somewhat prior to this. If you do a "bt"
>(backtrace) and go "up" a couple of times, you might find a spot where
>someone forgot to PROTECT() a newly created R object.

Well ddd  still does not install the innocent with the knowlege of C
programmers so I am guessing a bit about exactly what I should be
looking for. If I do "up" a few times I see a section of main/dotcode.c
starting at line 180 (copied below) that looks like it might have a
problem. The first few cases do not have any PROTECT statements and
others do. If this is not a a good guess then perhaps someone could fill
me in on what statements that create new R objects look like.

Thanks,
Paul
_____
    case INTSXP:
 s = allocVector(type, n);
 iptr = (int*)p;
 for(i=0 ; i<n ; i++) {
     INTEGER(s)[i] = iptr[i];
 }
 break;
    case REALSXP:
 s = allocVector(type, n);
 if(asLogical(getAttrib(arg, CSingSymbol)) == 1) {
     sptr = (float*) p;
     for(i=0 ; i<n ; i++) REAL(s)[i] = (double) sptr[i];
 } else {
     rptr = (double*) p;
     for(i=0 ; i<n ; i++) REAL(s)[i] = rptr[i];
 }
 break;
    case CPLXSXP:
 s = allocVector(type, n);
 zptr = (Rcomplex*)p;
 for(i=0 ; i<n ; i++) {
     COMPLEX(s)[i] = zptr[i];
 }
 break;
    case STRSXP:
 if(Fort) {
     /* only return one string: warned on the R -> Fortran step */
     strncpy(buf, (char*)p, 255);
     buf[256] = '\0';
     PROTECT(s = allocVector(type, 1));
     SET_STRING_ELT(s, 0, mkChar(buf));
     UNPROTECT(1);
 } else ...

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Thu Feb 22 22:37:18 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 22 Feb 2001 23:37:18 +0100
Subject: [Rd] segfault
In-Reply-To: Paul Gilbert's message of "Thu, 22 Feb 2001 13:05:24 -0500"
References: <3A9554E3.357804E9@home.com>
Message-ID: <x266i21h0h.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <gilb@home.com> writes:

> >The actual bug is probably somewhat prior to this. If you do a "bt"
> >(backtrace) and go "up" a couple of times, you might find a spot where
> >someone forgot to PROTECT() a newly created R object.
> 
> Well ddd  still does not install the innocent with the knowlege of C
> programmers so I am guessing a bit about exactly what I should be
> looking for. If I do "up" a few times I see a section of main/dotcode.c
> starting at line 180 (copied below) that looks like it might have a
> problem. The first few cases do not have any PROTECT statements and
> others do. If this is not a a good guess then perhaps someone could fill
> me in on what statements that create new R objects look like.

Briefly (and this'll have to be brief or I'll end up writing a
book...) things like allocVector create a new objects. As long as such
an object is "loose" - not assigned to an environment or made part of
an object which is - it is in danger of being destroyed by the garbage
collector. However, the garbage collector is not called randomly, it
can only happen when memory for a new object is being allocated. 

In the first handful of cases below, one allocates a vector and stuffs
some preexisting values into it (sitting in iptr, sptr, rptr,....) and
then passes s onto something else (it is the return value of
CPtrToRObj and that only gets called from do_dotCode where the return
value gets protected eventually)

However, in the STRSXP case, s needs protection because of the
mkChar(buf) which will allocate memory, and hence the construction:

     PROTECT(s = allocVector(type, 1));
     SET_STRING_ELT(s, 0, mkChar(buf));
     UNPROTECT(1);

I don't think this stretch of code is the culprit - it is a far too
busy area to be likely to have major bugs of this caliber.

Actually, once do_dotCode is involved, I'd suspect array overruns
rather than PROTECT bugs. I've seen several cases where a vector
turned out to getting passed with the wrong length or the wrong type.
Be very careful that all arguments to .Fortran/.C are explicitly
coerced to the right type - if you forget an as.double you might get a
routine that works impeccably until someone passes something like 1:12
(which has storage mode "integer") as an argument.

> Thanks,
> Paul
> _____
>     case INTSXP:
>  s = allocVector(type, n);
>  iptr = (int*)p;
>  for(i=0 ; i<n ; i++) {
>      INTEGER(s)[i] = iptr[i];
>  }
>  break;
>     case REALSXP:
>  s = allocVector(type, n);
>  if(asLogical(getAttrib(arg, CSingSymbol)) == 1) {
>      sptr = (float*) p;
>      for(i=0 ; i<n ; i++) REAL(s)[i] = (double) sptr[i];
>  } else {
>      rptr = (double*) p;
>      for(i=0 ; i<n ; i++) REAL(s)[i] = rptr[i];
>  }
>  break;
>     case CPLXSXP:
>  s = allocVector(type, n);
>  zptr = (Rcomplex*)p;
>  for(i=0 ; i<n ; i++) {
>      COMPLEX(s)[i] = zptr[i];
>  }
>  break;
>     case STRSXP:
>  if(Fort) {
>      /* only return one string: warned on the R -> Fortran step */
>      strncpy(buf, (char*)p, 255);
>      buf[256] = '\0';
>      PROTECT(s = allocVector(type, 1));
>      SET_STRING_ELT(s, 0, mkChar(buf));
>      UNPROTECT(1);
>  } else ...
> 
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Feb 12 15:10:14 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Feb 2001 16:10:14 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: <14962.20626.613619.35152@sonny.eddelbuettel.com>
References: <14962.20626.613619.35152@sonny.eddelbuettel.com>
Message-ID: <14983.64726.946115.11996@mithrandir.hornik.net>


	[Manually approved by MM -- because it contains binary attachment ]

--QcBiZYhiHg
Content-Type: text/plain; charset=us-ascii
Content-Description: message body text
Content-Transfer-Encoding: 7bit

>>>>> Dirk Eddelbuettel writes:

> GNU a2ps is a fairly versatile text-to-anything processor.  It is
> useful for typsetting source code from a wide variety of programming
> languages.  As R (ie S) wasn't supported yet, I quickly cobbled a
> style sheet for the S language together. Stylesheets are documented in
> the texinfo docs for a2ps, and examples can be found in
> /usr/share/a2ps/sheets (on Debian at least, others distros or unices
> probably have similar locations). IIRC a2ps exists for NT but might
> require Cygwin. I typeset on Linux and only print on NT :)

> Well, as I still don't really know what I'm doing with R, I would
> appreciate comments / feedback / input from anyone could spend a
> moment or two on this.  To activate the stylesheet, simple patch

>       /usr/share/a2ps/sheets/sheets.map

> as per the short diff below which declares that the stylesheet s.ssh
> shall be used for filenames matching /*.[RS]/.  The sheet itself is
> attached, just place it in the same directory, ie
> /usr/share/a2ps/sheets/.

> Usage then simply becomes
>       a2ps -Pdisplay foo.R
> or
>       a2ps foo.R -o foo.ps; gv foo.ps
> in case the "display" device isn't defined.

Thanks for bringing this up.  We have locally used style sheets S.ssh
for S code and Rd.ssh for Rd documentation format, both written by T
Hothorn.  I attach these files below.

> A few points / questions:

>  * content:  a2ps uses tricks to use TeX symbols. It works well to typset
>    <- with \leftarrow (uncomment that in s.ssh to see) but I couldn't tell
>    it to parse
>       a<-2
>    it only finds <- with whitespace, eg
>       a <- 2

Torsten gets this right by using a different alphabet, I think.

>    What could be done about <<- ?  Is there a matching TeX symbol?

Dunno.

>  * more content: Is the list of keywords really that short? I couldn't find
>    much else...

R-lang says:

	The following identifiers have a special meaning and should not
	be used for object names

	     if else repeat while function for in next break
	     TRUE FALSE NULL NA Inf NaN
	     ... ..1 ..2 etc.

so I think this is the list of keywords to use.

(Yes switch() is not in there ...)

>  * scope:  Are other file extensions in use? Are there conventions for S or
>    Splus files?  Any clever way to make a2ps understand the files in 
>    $R_HOME/library/$PACKAGE/R  are also R?  Could file(1) be taught what 
>    an R file is?

I think assuming that extensions `.R' and `.Rd' for R code and doc
source files are pretty safe.  The package installer will also allow for
code extensions `.r', `.S', `.s', and `.q', but I think only the last of
these may be specific enough to make it into the extension list.

No R magic in general.  ESS think .R/.r are safe for auto-mode-alist and
.S/.s need enforcing.  [One could try checking for Emacs-style mode
magic but I think that would be a bad idea.]

>  * editorial: shall this be the s.ssh or r.ssh or rs.ssh?

I think we want S.ssh, as this is a style sheet for code written in the
S language.

Best,
-k


--QcBiZYhiHg
Content-Type: application/octet-stream
Content-Disposition: attachment;
	filename="S.ssh"
Content-Transfer-Encoding: base64

IyBUaGlzIGlzIGEgUiBzaGVldApzdHlsZSBSIGlzCndyaXR0ZW4gYnkgIlRvcnN0ZW4gSG90aG9y
biA8aG90aG9ybkBjaS50dXdpZW4uYWMuYXQ+Igp2ZXJzaW9uIGlzIDAuMQpyZXF1aXJlcyBhMnBz
IDQuOS41Cgpkb2N1bWVudGF0aW9uIGlzCiAgICJDcmVhdGVzIHByZXR0eSBSLWNvZGUgcG9zdHNj
cmlwdCBmaWxlcy4iCmVuZCBkb2N1bWVudGF0aW9uCgphbHBoYWJldHMgYXJlCiAgICJBQkNERUZH
SElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XyMkJT0tJi8iCgpj
YXNlIHNlbnNpdGl2ZQoKIyBhbmNlc3RvcnMgYXJlCiMgICBjCiMgZW5kIGFuY2VzdG9ycwoKc2Vx
dWVuY2VzIGFyZQogICIjIiBDb21tZW50LAogICJcIiIgUGxhaW4gU3RyaW5nICJcIiIgUGxhaW4K
IyAgIGV4Y2VwdGlvbnMgYXJlCiMgICAgL1xcXFwsLwojICAgICAgIGVuZCBleGNlcHRpb25zCmVu
ZCBzZXF1ZW5jZXMKCmtleXdvcmRzIGluIEtleXdvcmRfc3Ryb25nIGFyZQogIGlmLCB0aGVuLCBl
bHNlLCBicmVhaywgd2hpbGUsIGZvciwgZnVuY3Rpb24sIG5leHQsIHJldHVybiwgRkFMU0UsIFRS
VUUKZW5kIGtleXdvcmRzCgpvcGVyYXRvcnMgYXJlCiAgIDwtIFxsZWZ0YXJyb3cKZW5kIG9wZXJh
dG9ycwoKb3B0aW9uYWwgc2VxdWVuY2VzIGFyZQogICA8IFBsYWluIEtleXdvcmQgPiBQbGFpbgpl
bmQgc2VxdWVuY2VzCmVuZCBzdHlsZQ==
--QcBiZYhiHg
Content-Type: application/octet-stream
Content-Disposition: attachment;
	filename="Rd.ssh"
Content-Transfer-Encoding: base64

IyBTdHlsZSBzaGVldCBmb3IgUyBvdXRwdXQKIyBDb3B5cmlnaHQgKGMpIDIwMDAgVG9yc3RlbiBI
b3Rob3JuCgojCiMgCiMgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVk
aXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKIyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIsIG9yIChhdCB5b3VyIG9wdGlvbikKIyBh
bnkgbGF0ZXIgdmVyc2lvbi4KIwojIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAojIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsg
d2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiMgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQojIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiMKIyBZb3Ugc2hvdWxkIGhhdmUgcmVj
ZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQojIGFsb25nIHdp
dGggdGhpcyBwcm9ncmFtOyBzZWUgdGhlIGZpbGUgQ09QWUlORy4gIElmIG5vdCwgd3JpdGUgdG8K
IyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAz
MzAsCiMgQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuCiMKIyAwLjEgVG9yc3RlbiBIb3Rob3Ju
CgpzdHlsZSBSZCBpcwp3cml0dGVuIGJ5ICJUb3JzdGVuIEhvdGhvcm4gPGhvdGhvcm5AY2kudHV3
aWVuLmFjLmF0PiIKdmVyc2lvbiBpcyAwLjEKcmVxdWlyZXMgYTJwcyA0LjkuNQoKZG9jdW1lbnRh
dGlvbiBpcwogICAJImEycHMgc3R5bGUgc2hlZXQgZm9yIFJkIgplbmQgZG9jdW1lbnRhdGlvbgoK
YWxwaGFiZXRzIGFyZQogICAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xt
bm9wcXJzdHV2d3h5el8jJCU9LSYvIgoKY2FzZSBzZW5zaXRpdmUKCiMgYW5jZXN0b3JzIGFyZQoj
ICAgYwojIGVuZCBhbmNlc3RvcnMKCnNlcXVlbmNlcyBhcmUKICAiIyIgQ29tbWVudCwKICAiXCIi
IFBsYWluIFN0cmluZyAiXCIiIFBsYWluLAogICJcXCIgS2V5d29yZF9zdHJvbmcgInsiIFBsYWlu
CiMgICJ7IiBQbGFpbiBTdHJpbmcgIn0iIFBsYWluCiMJZXhjZXB0aW9ucyBhcmUKIwkvaXRlbXss
Y29kZXssdXNhZ2V7LGtleXdvcmR7LwojCWVuZCBleGNlcHRpb25zCiMgICJ7IiBQbGFpbiBTdHJp
bmcgIn17IiBQbGFpbgojCQojICAgZXhjZXB0aW9ucyBhcmUKIyAgIC9cXFthOnpdey8gS2V5d29y
ZCAifSIgUGxhaW4KIyAgIGVuZCBleGNlcHRpb25zCmVuZCBzZXF1ZW5jZXMKCm9wZXJhdG9ycyBh
cmUKICAgPC0gXGxlZnRhcnJvdwplbmQgb3BlcmF0b3JzCgpvcHRpb25hbCBzZXF1ZW5jZXMgYXJl
CiAgIDwgUGxhaW4gS2V5d29yZCA+IFBsYWluCmVuZCBzZXF1ZW5jZXMKZW5kIHN0eWxl
--QcBiZYhiHg--

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Sat Feb 24 00:00:46 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 24 Feb 2001 01:00:46 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: Kurt Hornik's message of "Mon, 12 Feb 2001 16:10:14 +0100"
References: <14962.20626.613619.35152@sonny.eddelbuettel.com> <14983.64726.946115.11996@mithrandir.hornik.net>
Message-ID: <x266i1gdap.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> R-lang says:
> 
> 	The following identifiers have a special meaning and should not
> 	be used for object names
> 
> 	     if else repeat while function for in next break
> 	     TRUE FALSE NULL NA Inf NaN
> 	     ... ..1 ..2 etc.
> 
> so I think this is the list of keywords to use.
> 
> (Yes switch() is not in there ...)

switch() is technically a function call...

The true authority is the keywords[] array in gram.y, a study of which
indicates that ..1, ..2 et al. do bit count as keywords, whereas ...
does and we have an extra which was new to me, namely GLOBAL.ENV, and
truly enough:

> GLOBAL.ENV
<environment: R_GlobalEnv>
> GLOBAL.ENV <- 5
Error in <environment> <- 5 : invalid (do_set) left-hand side to
assignment

Wonder what that one is good for? The only symbolic reference to
it in the entire source is in gram.c, but I suppose its value gets
initialized somewhere. Looks like a relic from older times, but I
wouldn't dare to remove it for 1.2.2...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Feb 25 13:52:09 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 25 Feb 2001 14:52:09 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: <x266i1gdap.fsf@blueberry.kubism.ku.dk>
References: <14962.20626.613619.35152@sonny.eddelbuettel.com>
 <14983.64726.946115.11996@mithrandir.hornik.net>
 <x266i1gdap.fsf@blueberry.kubism.ku.dk>
Message-ID: <15001.3593.198071.614550@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> R-lang says:
>> 
>> The following identifiers have a special meaning and should not
>> be used for object names
>> 
>> if else repeat while function for in next break
>> TRUE FALSE NULL NA Inf NaN
>> ... ..1 ..2 etc.
>> 
>> so I think this is the list of keywords to use.
>> 
>> (Yes switch() is not in there ...)

> switch() is technically a function call...

> The true authority is the keywords[] array in gram.y, a study of which
> indicates that ..1, ..2 et al. do bit count as keywords, whereas ...
> does and we have an extra which was new to me, namely GLOBAL.ENV, and
> truly enough:

>> GLOBAL.ENV
> <environment: R_GlobalEnv>
>> GLOBAL.ENV <- 5
> Error in <environment> <- 5 : invalid (do_set) left-hand side to
> assignment

> Wonder what that one is good for? The only symbolic reference to
> it in the entire source is in gram.c, but I suppose its value gets
> initialized somewhere. Looks like a relic from older times, but I
> wouldn't dare to remove it for 1.2.2...

Fascinating.  Maybe file it as a bug report so that we do not forget to
fix this in the future?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Torsten.Hothorn@rzmail.uni-erlangen.de  Mon Feb 26 12:48:36 2001
From: Torsten.Hothorn@rzmail.uni-erlangen.de (Torsten.Hothorn@rzmail.uni-erlangen.de)
Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261248.NAA14371@pubhealth.ku.dk>


Hi, 

when we add 

\examples{
a <- 1:4

a %*% a
}

into a Rd-file are run R CMD check, the resulting R code is 

a <- 1:4

a

So, %*% ... is lost on the way if I'm not totally confused. 

Torsten

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Patched
 major = 1
 minor = 2.0
 year = 2001
 month = 01
 day = 07
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 26 12:57:23 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 26 Feb 2001 13:57:23 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261257.NAA14485@pubhealth.ku.dk>

>From R-exts.texi ca line 1125.

The ``comment'' and ``control'' characters @samp{%} and @samp{\}
@emph{always} need to be escaped.  Inside the verbatim-like commands
(@code{\code} and @code{\examples}), no other characters are special.

You need \%*\%, as it suggests there and is used in the base package
examples.

Brian

> From: Torsten.Hothorn@rzmail.uni-erlangen.de
> Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] %*% in examples (PR#855)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> 
> Hi, 
> 
> when we add 
> 
> \examples{
> a <- 1:4
> 
> a %*% a
> }
> 
> into a Rd-file are run R CMD check, the resulting R code is 
> 
> a <- 1:4
> 
> a
> 
> So, %*% ... is lost on the way if I'm not totally confused. 
> 
> Torsten
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = Patched
>  major = 1
>  minor = 2.0
>  year = 2001
>  month = 01
>  day = 07
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:ctest, Autoloads, package:base
> 
> 
> 
> 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> 
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Torsten.Hothorn@rzmail.uni-erlangen.de  Mon Feb 26 13:06:17 2001
From: Torsten.Hothorn@rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Mon, 26 Feb 2001 14:06:17 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
In-Reply-To: <200102261257.MAA16411@toucan.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.21.0102261405230.22353-100000@artemis.imbe.med.uni-erlangen.de>


> >From R-exts.texi ca line 1125.
> 
> The ``comment'' and ``control'' characters @samp{%} and @samp{\}
> @emph{always} need to be escaped.  Inside the verbatim-like commands
> (@code{\code} and @code{\examples}), no other characters are special.
> 
> You need \%*\%, as it suggests there and is used in the base package
> examples.

well, as always: read the docs ;-)

Torsten

> 
> Brian
> 
> > From: Torsten.Hothorn@rzmail.uni-erlangen.de
> > Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
> > To: r-devel@stat.math.ethz.ch
> > Subject: [Rd] %*% in examples (PR#855)
> > CC: R-bugs@biostat.ku.dk
> > X-Loop: R-bugs@biostat.ku.dk
> > 
> > 
> > Hi, 
> > 
> > when we add 
> > 
> > \examples{
> > a <- 1:4
> > 
> > a %*% a
> > }
> > 
> > into a Rd-file are run R CMD check, the resulting R code is 
> > 
> > a <- 1:4
> > 
> > a
> > 
> > So, %*% ... is lost on the way if I'm not totally confused. 
> > 
> > Torsten
> > 
> > --please do not edit the information below--
> > 
> > Version:
> >  platform = i686-pc-linux-gnu
> >  arch = i686
> >  os = linux-gnu
> >  system = i686, linux-gnu
> >  status = Patched
> >  major = 1
> >  minor = 2.0
> >  year = 2001
> >  month = 01
> >  day = 07
> >  language = R
> > 
> > Search Path:
> >  .GlobalEnv, package:ctest, Autoloads, package:base
> > 
> > 
> > 
> > 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > 
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Mon Feb 26 13:08:12 2001
From: ligges@statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Mon, 26 Feb 2001 14:08:12 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261308.OAA14670@pubhealth.ku.dk>

Torsten.Hothorn@rzmail.uni-erlangen.de wrote:
> 
> Hi,
> 
> when we add
> 
> \examples{
> a <- 1:4
> 
> a %*% a
> }
> 
> into a Rd-file are run R CMD check, the resulting R code is
> 
> a <- 1:4
> 
> a
> 
> So, %*% ... is lost on the way if I'm not totally confused.
> 

That's not a bug, Torsten.

Use 
a \%*\% a

% this is a comment

Uwe

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Feb 26 16:16:59 2001
From: pgilbert@bank-banque-canada.ca (pgilbert@bank-banque-canada.ca)
Date: Mon, 26 Feb 2001 17:16:59 +0100 (MET)
Subject: [Rd] "}  {" problem in Rd files (PR#856)
Message-ID: <200102261616.RAA18047@pubhealth.ku.dk>

I better report this before I forget again (I think it may also be a
problem with \item) :

>Paul Gilbert wrote:

>> >   \section{Model Parameters}{
>>
>> I seem to recall having a bit of trouble with this quietly omitting
things when the
>> last "{" had a space before it or was on a new line. I'm not sure if
that >>is still a problem (or if indeed it ever was).

>Indeed it is, and there would be a few extra dents in the wall at head
>height here if you had not mentioned it.  Thanks.

>Jim





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 26 17:12:18 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 26 Feb 2001 18:12:18 +0100 (MET)
Subject: [Rd] "}  {" problem in Rd files (PR#856)
Message-ID: <200102261712.SAA18492@pubhealth.ku.dk>


> From: pgilbert@bank-banque-canada.ca
> Date: Mon, 26 Feb 2001 17:16:59 +0100 (MET)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] "}  {" problem in Rd files (PR#856)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> I better report this before I forget again (I think it may also be a
> problem with \item) :
> 
> >Paul Gilbert wrote:
> 
> >> >   \section{Model Parameters}{
> >>
> >> I seem to recall having a bit of trouble with this quietly omitting
> things when the
> >> last "{" had a space before it or was on a new line. I'm not sure if
> that >>is still a problem (or if indeed it ever was).
> 
> >Indeed it is, and there would be a few extra dents in the wall at head
> >height here if you had not mentioned it.  Thanks.

Also \deqn, \eqn.  However, they do work when used as documented
in R-exts, so I am not sure this is a bug.  Adding new lines and spaces
is a problem in other places in Rd too: not a fatal one but gets
unwanted spaces in the output.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marchini@stats.ox.ac.uk  Tue Feb 27 09:00:33 2001
From: marchini@stats.ox.ac.uk (marchini@stats.ox.ac.uk)
Date: Tue, 27 Feb 2001 10:00:33 +0100 (MET)
Subject: [Rd] Plotting points on a filled.contour plot (PR#857)
Message-ID: <200102270900.KAA23881@pubhealth.ku.dk>

Full_Name: Jonathan Marchini
Version: R 1.2.2
OS: linux-gnu
Submission from: (NULL) (163.1.103.108)


When adding points to a filled.contour plot they do not appear at the correct
coordinates.
The following code demonstrates this.
 
a<-expand.grid(1:20,1:20)
b<-matrix(a[,1]+a[,2],20)
filled.contour(x=1:20,y=1:20,z=b)
points(10,10)  

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas.baumann@ch.tum.de  Tue Feb 27 08:35:57 2001
From: thomas.baumann@ch.tum.de (Dr. Thomas Baumann)
Date: Tue, 27 Feb 2001 09:35:57 +0100 (CET)
Subject: [Rd] Patch to coplot.R
Message-ID: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; charset=us-ascii

Hello,

and a big thank you for providing R!

Please find attached a diff for coplot which you may want to consider
for the next release. The diff is against R 1.2.2. The reasons for this
patch are:

1. The boxes of coplot did not align very well with the panel graphs if
   applied to a factor

2. Putting the levels as axis labels instead of just numbers makes the
   plot more readable

I also include a sample dataset (test.asc) and a sample program to show
the differences.

Thanks for looking at the code.

Thomas


---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="coplot.diff"

*** /tmp/mycoplot.R	Tue Feb 27 09:08:13 2001
--- /tmp/coplot.R.orig	Tue Feb 27 09:08:13 2001
***************
*** 201,227 ****
                  ...)
          }
          if ((i == total.rows) && (j%%2 == 0)) 
!             if (nlevels(x) > 0)
!               axis(1, labels = levels(x), xpd = NA)
!             else
!               axis(1, xpd = NA)
          else if ((i == istart || index + columns > nplots) && 
              (j%%2 == 1)) 
!             if (nlevels(x) > 0)
!               axis(3, labels = levels(x), xpd = NA)
!             else
!               axis(3, xpd = NA)
!         if ((j == 1) && ((total.rows - i)%%2 == 0))
!             if (nlevels(y) > 0)
!               axis(2, labels = levels(y), xpd = NA)
!             else
!               axis(2, xpd = NA)
          else if ((j == columns || index == nplots) && ((total.rows - 
!             i)%%2 == 1))
!             if (nlevels(y) > 0)
!               axis(4, labels = levels(y), xpd = NA)
!             else
!               axis(4, xpd = NA)
          box()
      }
      if (have.b) {
--- 201,215 ----
                  ...)
          }
          if ((i == total.rows) && (j%%2 == 0)) 
!             axis(1, xpd = NA)
          else if ((i == istart || index + columns > nplots) && 
              (j%%2 == 1)) 
!             axis(3, xpd = NA)
!         if ((j == 1) && ((total.rows - i)%%2 == 0)) 
!             axis(2, xpd = NA)
          else if ((j == columns || index == nplots) && ((total.rows - 
!             i)%%2 == 1)) 
!             axis(4, xpd = NA)
          box()
      }
      if (have.b) {
***************
*** 255,274 ****
          par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
          plot.new()
          nint <- nrow(a.intervals)
!         pwoffs <- nint / 32
!         plot.window(c(min(a.intervals[is.finite(a.intervals)] + pwoffs),
!                       max(a.intervals[is.finite(a.intervals)]) - pwoffs),
!                     0.5 + c(0, nint), log = "")
!         rect(a.intervals[, 1], 1:nint - 0.5, a.intervals[, 2], 
!             1:nint + 0.5, col = gray(0.95))
!         if (!is.null(a.levels)) {
              mid <- apply(a.intervals, 1, mean)
              text(mid, 1:nint, a.levels)
              NULL
          }
!         axis(3, labels = FALSE, tick = FALSE, xpd = NA)
!         axis(1, labels = FALSE, tick = FALSE)
!         box(col = "grey")
          mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
              line = 3, xpd = NA)
      }
--- 243,262 ----
          par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
          plot.new()
          nint <- nrow(a.intervals)
!         plot.window(range(a.intervals[is.finite(a.intervals)]), 
!             0.5 + c(0, nint), log = "")
!         bg <- if (is.null(a.levels)) 
!             gray(0.9)
!         else {
              mid <- apply(a.intervals, 1, mean)
              text(mid, 1:nint, a.levels)
              NULL
          }
!         rect(a.intervals[, 1], 1:nint - 0.3, a.intervals[, 2], 
!             1:nint + 0.3, col = bg)
!         axis(3, xpd = NA)
!         axis(1, labels = FALSE)
!         box()
          mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
              line = 3, xpd = NA)
      }
***************
*** 284,304 ****
              par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
              plot.new()
              nint <- nrow(b.intervals)
!             pwoffs <- nint / 32
!             plot.window(0.5 + c(0, nint),
!                         c(min(b.intervals[is.finite(b.intervals)] + pwoffs),
!                           max(b.intervals[is.finite(b.intervals)]) - pwoffs),
!                         log = "")
!             rect(1:nint - 0.5, b.intervals[, 1], 1:nint + 0.5, 
!                 b.intervals[, 2], col = gray(0.95))
!             if (!is.null(b.levels)) {
                  mid <- apply(b.intervals, 1, mean)
                  text(1:nint, mid, b.levels, srt = 90)
                  NULL
              }
!             axis(4, labels = FALSE, tick = FALSE, xpd = NA)
!             axis(2, labels = FALSE, tick = FALSE)
!             box(col = "grey")
              mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                  line = 3, xpd = NA)
          }
--- 272,291 ----
              par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
              plot.new()
              nint <- nrow(b.intervals)
!             plot.window(0.5 + c(0, nint), range(b.intervals, 
!                 finite = TRUE), log = "")
!             bg <- if (is.null(b.levels)) 
!                 gray(0.9)
!             else {
                  mid <- apply(b.intervals, 1, mean)
                  text(1:nint, mid, b.levels, srt = 90)
                  NULL
              }
!             rect(1:nint - 0.3, b.intervals[, 1], 1:nint + 0.3, 
!                 b.intervals[, 2], col = bg)
!             axis(4, xpd = NA)
!             axis(2, labels = FALSE)
!             box()
              mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                  line = 3, xpd = NA)
          }

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="mycoplot.R"

function (formula, data, given.values, panel = points, rows, 
    columns, show.given = TRUE, col = par("fg"), pch = par("pch"), 
    xlab = c(x.name, paste("Given :", a.name)), ylab = c(y.name, 
        paste("Given :", b.name)), subscripts = FALSE, number = 6, 
    overlap = 0.5, xlim, ylim, ...) 
{
    deparen <- function(expr) {
        while (is.language(expr) && !is.name(expr) && deparse(expr[[1]]) == 
            "(") expr <- expr[[2]]
        expr
    }
    bad.formula <- function() stop("invalid conditioning formula")
    bad.lengths <- function() stop("incompatible variable lengths")
    formula <- deparen(formula)
    if (!inherits(formula, "formula")) 
        bad.formula()
    y <- deparen(formula[[2]])
    rhs <- deparen(formula[[3]])
    if (deparse(rhs[[1]]) != "|") 
        bad.formula()
    x <- deparen(rhs[[2]])
    rhs <- deparen(rhs[[3]])
    if (is.language(rhs) && !is.name(rhs) && (deparse(rhs[[1]]) == 
        "*" || deparse(rhs[[1]]) == "+")) {
        have.b <- TRUE
        a <- deparen(rhs[[2]])
        b <- deparen(rhs[[3]])
    }
    else {
        have.b <- FALSE
        a <- rhs
    }
    if (missing(data)) 
        data <- parent.frame()
    x.name <- deparse(x)
    x <- eval(x, data, parent.frame())
    nobs <- length(x)
    y.name <- deparse(y)
    y <- eval(y, data, parent.frame())
    if (length(y) != nobs) 
        bad.lengths()
    a.name <- deparse(a)
    a <- eval(a, data, parent.frame())
    if (length(a) != nobs) 
        bad.lengths()
    if (is.character(a)) 
        a <- as.factor(a)
    a.levels <- NULL
    if (have.b) {
        b.levels <- NULL
        b.name <- deparse(b)
        b <- eval(b, data, parent.frame())
        if (length(b) != nobs) 
            bad.lengths()
        if (is.character(b)) 
            b <- as.factor(b)
        missingrows <- which(is.na(x) | is.na(y) | is.na(a) | 
            is.na(b))
    }
    else {
        missingrows <- which(is.na(x) | is.na(y) | is.na(a))
        b <- NULL
        b.name <- ""
    }
    number <- as.integer(number)
    if (length(number) == 0 || any(number < 1)) 
        stop("number must be integer >= 1")
    if (any(overlap >= 1)) 
        stop("overlap must be < 1 (and typically >= 0).")
    bad.givens <- function() stop("invalid given.values")
    if (missing(given.values)) {
        a.intervals <- if (is.factor(a)) {
            i <- 1:nlevels(a)
            a.levels <- levels(a)
            a <- as.numeric(a)
            cbind(i - 0.5, i + 0.5)
        }
        else co.intervals(a, number = number[1], overlap = overlap[1])
        b.intervals <- if (have.b) {
            if (is.factor(b)) {
                i <- 1:nlevels(b)
                b.levels <- levels(b)
                b <- as.numeric(b)
                cbind(i - 0.5, i + 0.5)
            }
            else {
                if (length(number) == 1) 
                  number <- rep(number, 2)
                if (length(overlap) == 1) 
                  overlap <- rep(overlap, 2)
                co.intervals(b, number = number[2], overlap = overlap[2])
            }
        }
    }
    else {
        if (!is.list(given.values)) 
            given.values <- list(given.values)
        if (length(given.values) != (if (have.b) 
            2
        else 1)) 
            bad.givens()
        a.intervals <- given.values[[1]]
        if (is.factor(a)) {
            if (is.character(a.intervals)) 
                a.intervals <- match(a.intervals, levels(a))
            a.intervals <- cbind(a.intervals - 0.5, a.intervals + 
                0.5)
            a.levels <- levels(a)
            a <- as.numeric(a)
        }
        else if (is.numeric(a)) {
            if (!is.numeric(a.intervals)) 
                bad.givens()
            if (!is.matrix(a.intervals) || ncol(a.intervals) != 
                2) 
                a.intervals <- cbind(a.intervals - 0.5, a.intervals + 
                  0.5)
        }
        if (have.b) {
            b.intervals <- given.values[[2]]
            if (is.factor(b)) {
                if (is.character(b.intervals)) 
                  b.intervals <- match(b.intervals, levels(b))
                b.intervals <- cbind(b.intervals - 0.5, b.intervals + 
                  0.5)
                b.levels <- levels(b)
                b <- as.numeric(b)
            }
            else if (is.numeric(b)) {
                if (!is.numeric(b.intervals)) 
                  bad.givens()
                if (!is.matrix(b.intervals) || ncol(b.intervals) != 
                  2) 
                  b.intervals <- cbind(b.intervals - 0.5, b.intervals + 
                    0.5)
            }
        }
    }
    if (any(is.na(a.intervals)) || (have.b && any(is.na(b.intervals)))) 
        bad.givens()
    if (have.b) {
        rows <- nrow(b.intervals)
        columns <- nrow(a.intervals)
        nplots <- rows * columns
        if (length(show.given) < 2) 
            show.given <- rep(show.given, 2)
    }
    else {
        nplots <- nrow(a.intervals)
        if (missing(rows)) {
            if (missing(columns)) {
                rows <- ceiling(round(sqrt(nplots)))
                columns <- ceiling(nplots/rows)
            }
            else rows <- ceiling(nplots/columns)
        }
        else if (missing(columns)) 
            columns <- ceiling(nplots/rows)
        if (rows * columns < nplots) 
            stop("rows * columns too small")
    }
    total.columns <- columns
    total.rows <- rows
    f.col <- f.row <- 1
    if (show.given[1]) {
        total.rows <- rows + 1
        f.row <- rows/total.rows
    }
    if (have.b && show.given[2]) {
        total.columns <- columns + 1
        f.col <- columns/total.columns
    }
    opar <- par(mfrow = c(total.rows, total.columns), oma = if (have.b) 
        rep(5, 4)
    else c(5, 6, 5, 4), mar = if (have.b) 
        rep(0, 4)
    else c(0.5, 0, 0.5, 0), new = FALSE)
    on.exit(par(opar))
    plot.new()
    if (missing(xlim)) 
        xlim <- range(x[is.finite(x)])
    if (missing(ylim)) 
        ylim <- range(y[is.finite(y)])
    pch <- rep(pch, length = nobs)
    col <- rep(col, length = nobs)
    do.panel <- function(index, subscripts = FALSE) {
        istart <- (total.rows - rows) + 1
        i <- total.rows - ((index - 1)%/%columns)
        j <- (index - 1)%%columns + 1
        par(mfg = c(i, j, total.rows, total.columns))
        plot.new()
        plot.window(xlim, ylim, log = "")
        if (any(is.na(id))) 
            id[is.na(id)] <- FALSE
        if (any(id)) {
            grid(lty = "solid")
            if (subscripts) 
                panel(x[id], y[id], subscripts = id, col = col[id], 
                  pch = pch[id], ...)
            else panel(x[id], y[id], col = col[id], pch = pch[id], 
                ...)
        }
        if ((i == total.rows) && (j%%2 == 0)) 
            if (nlevels(x) > 0)
              axis(1, labels = levels(x), xpd = NA)
            else
              axis(1, xpd = NA)
        else if ((i == istart || index + columns > nplots) && 
            (j%%2 == 1)) 
            if (nlevels(x) > 0)
              axis(3, labels = levels(x), xpd = NA)
            else
              axis(3, xpd = NA)
        if ((j == 1) && ((total.rows - i)%%2 == 0))
            if (nlevels(y) > 0)
              axis(2, labels = levels(y), xpd = NA)
            else
              axis(2, xpd = NA)
        else if ((j == columns || index == nplots) && ((total.rows - 
            i)%%2 == 1))
            if (nlevels(y) > 0)
              axis(4, labels = levels(y), xpd = NA)
            else
              axis(4, xpd = NA)
        box()
    }
    if (have.b) {
        count <- 1
        for (i in 1:rows) {
            for (j in 1:columns) {
                id <- ((a.intervals[j, 1] <= a) & (a <= a.intervals[j, 
                  2]) & (b.intervals[i, 1] <= b) & (b <= b.intervals[i, 
                  2]))
                do.panel(count, subscripts)
                count <- count + 1
            }
        }
    }
    else {
        for (i in 1:nplots) {
            id <- ((a.intervals[i, 1] <= a) & (a <= a.intervals[i, 
                2]))
            do.panel(i, subscripts)
        }
    }
    mtext(xlab[1], side = 1, at = 0.5 * f.col, outer = TRUE, 
        line = 3.5, xpd = NA)
    mtext(ylab[1], side = 2, at = 0.5 * f.row, outer = TRUE, 
        line = 3.5, xpd = NA)
    if (length(xlab) == 1) 
        xlab <- c(xlab, paste("Given :", a.name))
    if (show.given[1]) {
        mar <- par("mar")
        nmar <- mar + c(4, 0, 0, 0)
        par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
        plot.new()
        nint <- nrow(a.intervals)
        pwoffs <- nint / 32
        plot.window(c(min(a.intervals[is.finite(a.intervals)] + pwoffs),
                      max(a.intervals[is.finite(a.intervals)]) - pwoffs),
                    0.5 + c(0, nint), log = "")
        rect(a.intervals[, 1], 1:nint - 0.5, a.intervals[, 2], 
            1:nint + 0.5, col = gray(0.95))
        if (!is.null(a.levels)) {
            mid <- apply(a.intervals, 1, mean)
            text(mid, 1:nint, a.levels)
            NULL
        }
        axis(3, labels = FALSE, tick = FALSE, xpd = NA)
        axis(1, labels = FALSE, tick = FALSE)
        box(col = "grey")
        mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
            line = 3, xpd = NA)
    }
    else {
        mtext(xlab[2], side = 3, at = 0.5 * f.col, line = 3.25, 
            outer = TRUE, xpd = NA)
    }
    if (have.b) {
        if (length(ylab) == 1) 
            ylab <- c(ylab, paste("Given :", b.name))
        if (show.given[2]) {
            nmar <- mar + c(0, 4, 0, 0)
            par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
            plot.new()
            nint <- nrow(b.intervals)
            pwoffs <- nint / 32
            plot.window(0.5 + c(0, nint),
                        c(min(b.intervals[is.finite(b.intervals)] + pwoffs),
                          max(b.intervals[is.finite(b.intervals)]) - pwoffs),
                        log = "")
            rect(1:nint - 0.5, b.intervals[, 1], 1:nint + 0.5, 
                b.intervals[, 2], col = gray(0.95))
            if (!is.null(b.levels)) {
                mid <- apply(b.intervals, 1, mean)
                text(1:nint, mid, b.levels, srt = 90)
                NULL
            }
            axis(4, labels = FALSE, tick = FALSE, xpd = NA)
            axis(2, labels = FALSE, tick = FALSE)
            box(col = "grey")
            mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                line = 3, xpd = NA)
        }
        else {
            mtext(ylab[2], side = 4, at = 0.5 * f.row, line = 3.25, 
                outer = TRUE, xpd = NA)
        }
    }
    if (length(missingrows) > 0) {
        cat("\nMissing rows:", missingrows, "\n")
        invisible(missingrows)
    }
}

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="test.asc"

RDA1
5 0
9 row.names
5 names
5 class
6 levels
3 cxt
2 0 0
1 0 0
5
-1
19 0 1
4
13 0 1
90
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
2 0 0
1 0 0
4
-1
16 0 0
5
 3 WSA
 3 WSB
 3 WSC
 3 WSD
 3 WSE
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

13 0 1
90
 2
 2
 2
 2
 3
 4
 4
 4
 4
 5
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 2
 2
 2
 4
 4
 4
 4
 5
 5
 5
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 2
 2
 2
 4
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 4
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 3
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
2 0 0
1 0 0
4
-1
16 0 0
6
 2 Br
 2 Cr
 2 Ni
 3 PCP
 3 SRB
 3 URA
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

13 0 1
90
 1
 2
 4
 4
 4
 1
 2
 3
 4
 1
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 4
 4
 1
 2
 3
 4
 1
 3
 3
 4
 4
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 4
 4
 1
 2
 3
 4
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 2
 4
 1
 2
 3
 4
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 2
 4
 4
 1
 3
 4
 3
 4
 1
 1
 1
 1
 1
2 0 0
1 0 0
4
-1
16 0 0
4
 1 1
 2 20
 2 21
 2 22
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

14 0 0
90
 0.88690446
 0.88690513
 -0.008582909999999999
 0.84140389
 0.01547746
 0.82645292
 0.82645427
 0.76571345
 0.8263521
 0.37570381
 0.40361484
 0.40384806
 0.74884711
 0.94859763
 0.96677452
 0.97557102
 0.9832513000000001
 0.98572282
 0.99349502
 0.11416688
 0.8122289
 0.11418351
 0.88183559
 0.09723225000000001
 0.88183561
 0.83853386
 0.83863709
 0.74681656
 0.83251071
 0.8454432
 0.75563716
 0.92634558
 0.84537136
 0.97884589
 0.73673004
 0.96747265
 0.97369701
 0.98715169
 0.9914865
 0.99328531
 0.99652316
 0.25447211
 0.30372693
 0.25373806
 0.30371362
 0.2327828
 0.25372631
 0.96173564
 0.97069235
 0.95462282
 0.95459587
 0.91341539
 0.98234451
 0.60740805
 0.77592908
 0.93602096
 0.9867878
 0.98751514
 0.99363163
 0.9859177
 0.83318812
 0.83308551
 0.95750996
 0.91218418
 0.91217945
 0.8623662
 0.90722619
 0.89806433
 0.546805
 0.9623669500000001
 0.97003306
 0.97554032
 0.98202711
 0.98297822
 0.98880629
 0.99688566
 0.80436417
 0.88417903
 0.80423433
 0.45605293
 0.95874106
 0.56694216
 0.95734593
 0.87062068
 0.96359899
 0.9355361
 0.9629377
 0.96566601
 0.9679529100000001
 0.9834591
-1

2 0 0
1 0 0
3
-1
16 0 0
1
 10 data.frame
-1
2 0 0
1 0 0
2
-1
16 0 0
4
 6 loc.id
 7 chem.id
 4 mode
 6 fitpar
-1
2 0 0
1 0 0
1
-1
16 0 0
90
 1 1
 1 2
 1 3
 1 4
 1 5
 1 6
 1 7
 1 8
 1 9
 2 10
 2 11
 2 12
 2 13
 2 14
 2 15
 2 16
 2 17
 2 18
 2 19
 2 20
 2 21
 2 22
 2 23
 2 24
 2 25
 2 26
 2 27
 2 28
 2 29
 2 30
 2 31
 2 32
 2 33
 2 34
 2 35
 2 36
 2 37
 2 38
 2 39
 2 40
 2 41
 2 42
 2 43
 2 44
 2 45
 2 46
 2 47
 2 48
 2 49
 2 50
 2 51
 2 52
 2 53
 2 54
 2 55
 2 56
 2 57
 2 58
 2 59
 2 60
 2 61
 2 62
 2 63
 2 64
 2 65
 2 66
 2 67
 2 68
 2 69
 2 70
 2 71
 2 72
 2 73
 2 74
 2 75
 2 76
 2 77
 2 78
 2 79
 2 80
 2 81
 2 82
 2 83
 2 84
 2 85
 2 86
 2 87
 2 88
 2 89
 2 90
-1
-1
-1
-1
-1
-1
-1

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="coplot_sample.R"

load("test.asc")
mycoplot(cxt$fitpar ~ unclass(cxt$loc.id)|
         cxt$chem.id * cxt$mode,
         panel = points,
         bg = "blue",
         col = "blue",
         pch = 21,
         xlab = c("Location", "Contaminant"),
         ylab = c(label, "CXTFit-Mode"),
         ylim = c(0.6,1)
       )


coplot(cxt$fitpar ~ unclass(cxt$loc.id)|
         cxt$chem.id * cxt$mode,
         panel = points,
         bg = "blue",
         col = "blue",
         pch = 21,
         xlab = c("Location", "Contaminant"),
         ylab = c(label, "CXTFit-Mode"),
         ylim = c(0.6,1)
       )

---1149173172-1804289383-983267779=:26068--
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Feb 27 14:52:35 2001
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 27 Feb 2001 15:52:35 +0100
Subject: [Rd] Patch to coplot.R
In-Reply-To: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>
References: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>
Message-ID: <15003.48947.624227.304611@gargle.gargle.HOWL>

>>>>> "Thomas" == Thomas Baumann <thomas.baumann@ch.tum.de> writes:

      ...

    Thomas> Please find attached a diff for coplot which you may want to
    Thomas> consider for the next release. 

Thank you, Thomas!

    Thomas> The diff is against R 1.2.2. 

unfortunately *not* :

-------- sorry for the excursion --- but I must say this loudly ---
	 {it's by far not the first time, and it's a real pain for us
 	 merging the code!}

  Please -- everyone -- do not consider the output

      > functionname

  (or ESS/Emacs C-c C-d)
  as the source of function  functionname.

  There is only one source, and that is in 
	R-<version>/src/library/<pkg>/R/<foobar>.R
  in our case in
	    R-1.2.2/src/library/base/R/coplot.R

  Again: 
    Please, please do NOT ever patch against the output of typing the
    function name, but please diff against the real source...


---------- end of excursion --------------------

    Thomas> Thanks for looking at the code.

I've been doing that for a bit, now ..


    Thomas> The reasons for this patch are:

    Thomas> 1. The boxes of coplot did not align very well with the panel
    Thomas> graphs if applied to a factor

hmm, well, that's also a matter of taste, but I tend to agree with your
choice (though it slightly complicates the code).

    Thomas> 2. Putting the levels as axis labels instead of just numbers
    Thomas> makes the plot more readable

yes, unless the levels happen to be 10-letter words -- which seems to
happen for some data / people. 
I think one should make this an option (on by default), and also consider using
abbreviate(levels(x), ...) 

    Thomas> I also include a sample dataset (test.asc) and a sample program
    Thomas> to show the differences.

thanks, these *were* useful.

Note however, that you changed more.
We had explicitly 
   - empty boxes when conditioning on  ordinal variables (aka factors)
   - gray boxes  when using "shingles", i.e. conditioning on continuous vars.

you have all boxes gray which I don't necessarily prefer.
(and you should say that you were changing this, too...).
One could consider using two different kinds of gray for the two,
very light gray for factors, darker one for `shingle bars'.

I'm a bit reluctant to change this; R has been a `ripe' piece of software
for a while and people don't necessarily want to see changes that they
can't easily revert.  Hence, the two bg colors (bar backgrounds) would
become function arguments as well....

opinions?

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas.baumann@ch.tum.de  Tue Feb 27 15:53:47 2001
From: thomas.baumann@ch.tum.de (thomas.baumann@ch.tum.de)
Date: Tue, 27 Feb 2001 16:53:47 +0100 (CET)
Subject: [Rd] Patch to coplot.R
In-Reply-To: <15003.48947.624227.304611@gargle.gargle.HOWL>
Message-ID: <200102271553.f1RFrm808369@norvel.ws.chemie.tu-muenchen.de>



On 27 Feb, Martin Maechler wrote:
> ---------- end of excursion --------------------

sorry for any inconvenience, the next patches will definitely be against
the real source.

> you have all boxes gray which I don't necessarily prefer.
> (and you should say that you were changing this, too...).
> One could consider using two different kinds of gray for the two,
> very light gray for factors, darker one for `shingle bars'.
> 
> I'm a bit reluctant to change this; R has been a `ripe' piece of software
> for a while and people don't necessarily want to see changes that they
> can't easily revert.  Hence, the two bg colors (bar backgrounds) would
> become function arguments as well....
> 
> opinions?

I fully agree with your opinion, since I do not like having all the
automatically generated diagrams looking different after an update. But
an easy option would be nice...

Thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Tue Feb 27 22:13:09 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Wed, 28 Feb 2001 11:13:09 +1300
Subject: [Rd] Plotting points on a filled.contour plot (PR#857)
References: <200102270900.KAA23881@pubhealth.ku.dk>
Message-ID: <003501c0a10a$77f7b040$175dd882@stat.auckland.ac.nz>

Hi


> When adding points to a filled.contour plot they do not appear at the
correct
> coordinates.
> The following code demonstrates this.
>
> a<-expand.grid(1:20,1:20)
> b<-matrix(a[,1]+a[,2],20)
> filled.contour(x=1:20,y=1:20,z=b)
> points(10,10)


The problem here is that filled.contour is actually a combination of two
plots;  one is the filled contour and one is the legend.  filled.contour
sets up two separate coordinate systems for these two plots, but only does
so internally - once the function has returned these coordinate systems are
lost.  In order to access the coordinate system of the main contour plot you
can specify graphics commands in the plot.axes argument.  For example, in
your case, replace your call to filled.contour with the following, and all
is as it should be ...

filled.contour(x=1:20,y=1:20,z=b,plot.axes={axis(1);axis(2);points(10,10)})

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gilb@home.com  Wed Feb 28 15:43:19 2001
From: gilb@home.com (Paul Gilbert)
Date: Wed, 28 Feb 2001 10:43:19 -0500
Subject: [Rd] -malign-double
Message-ID: <3A9D1C96.FE7CF73A@home.com>

I was just looking at the documentation for g77 and noticed the
following, and also noticed that it is not used when fortran for a
package is compiled with the default (i.e. no Makefile in src
directory.)  Should it be considered?

Paul Gilbert
_____
`-malign-double'
     (Intel x86 architecture only.)

     Noticeably improves performance of `g77' programs making heavy use
     of `REAL(KIND=2)' (`DOUBLE PRECISION') data on some systems.  In
     particular, systems using Pentium, Pentium Pro, 586, and 686
     implementations of the i386 architecture execute programs faster
     when `REAL(KIND=2)' (`DOUBLE PRECISION') data are aligned on
     64-bit boundaries in memory.

     This option can, at least, make benchmark results more consistent
     across various system configurations, versions of the program, and
     data sets.

     *Note:* The warning in the `gcc' documentation about this option
     does not apply, generally speaking, to Fortran code compiled by
     `g77'.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb 28 18:44:26 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 28 Feb 2001 19:44:26 +0100
Subject: [Rd] Re: [R] re: Spatial stats: R vs. Splus
In-Reply-To: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk>
References: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk>
Message-ID: <15005.18186.355531.588114@mithrandir.hornik.net>

>>>>> Paulo Justiniano Ribeiro writes:

> Hi Kenneth
> Depends on what you are looking for, concerning methods for spatial data.

> At CRAN you will find the packages:

> 1) spatial, by Venables & Ripley, as part of the bundle VR
> This packages does some geostatistical and point process analysis

> 2) splancs by Rowlings, Diggle and ported by  Bivand
> For point process

> 3) sgeostats by Majure and proted by Gedhardt
> For geostatistics

> And outside CRAN I know about:

> 4) geoR by Ribeiro and Diggle,
> For (model-based) geostatistics
> available at: www.maths.lancs.ac.uk/~ribeiro.geoR.html

Are there any plans for making this available via CRAN?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Timothy.Keitt@StonyBrook.Edu  Wed Feb 28 20:11:08 2001
From: Timothy.Keitt@StonyBrook.Edu (Timothy H. Keitt)
Date: Wed, 28 Feb 2001 15:11:08 -0500
Subject: [Rd] Re: [R] re: Spatial stats: R vs. Splus
References: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk> <15005.18186.355531.588114@mithrandir.hornik.net>
Message-ID: <3A9D5B5C.8010604@StonyBrook.Edu>

Nice package.  I second the motion (for CRAN).

T.

Kurt Hornik wrote:

>>>>>> Paulo Justiniano Ribeiro writes:
>>>>> 
>> 4) geoR by Ribeiro and Diggle,
>> For (model-based) geostatistics
>> available at: www.maths.lancs.ac.uk/~ribeiro.geoR.html
> 
> Are there any plans for making this available via CRAN?
> 

-- 
Timothy H. Keitt
Department of Ecology and Evolution
State University of New York at Stony Brook
Phone: 631-632-1101, FAX: 631-632-7626
http://life.bio.sunysb.edu/ee/keitt/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Thu Feb  1 01:13:12 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Thu, 1 Feb 2001 02:13:12 +0100 (MET)
Subject: [Rd] screen can't go back to log="y" plot (PR#831)
Message-ID: <200102010113.CAA25183@pubhealth.ku.dk>


Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> [I have abbreviated the subject as jitterbug has been having probems
> with long subjects.]
> 
> The issue here is that one cannot mix log/non-log axes in the calls to
> screen(), as the appropriate par() parameter is read-only, but the
> meaning of yaxp depends on it.  But beyond that you can't set
> x/yaxp for log axes.
> 
> You should be able to do this: you can in the S original.
> 
> A simpler version:
> 
> plot (1:2, 1:2, log="y", main="1")
> zz <- par("yaxp")
> zz
> [1]  1  2 -5
> par(yaxp=zz)
> Error in par(yaxp = zz) : invalid value specified for graphics parameter
> "yaxp".
> 
> So you can't reset the yaxp parameter to what it is reported as!
[snip]

The code in main/par.c ignores the value of xlog (or ylog) when
setting xaxp (or yaxp).  Right now you have in Specify (and Specify2):

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        posIntCheck((int) (REAL(value)[2]), what);

Shouldn't that be something like:

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        if (dd->gp.xlog)
            logAxpCheck((int) (REAL(value)[2]), what);
        else
            posIntCheck((int) (REAL(value)[2]), what);

Where logAxpCheck is suitably defined as:

static void logAxpCheck(int x, char *s)
{
    if (x == NA_INTEGER || x == 0 || x > 4)
	par_error(s);
}

since only values < 0 or the values 1, 2, 3 are allowed?


> Additional bug: the meaning of x/yaxp for log axes is not defined
> in help(par).

excerpt from help(par):

    xaxp: A vector of the form `c(x1, x2, n)' giving the coordinates
          of the extreme tick marks and the number of intervals
          between tick-marks.

Could you add:

          The value of n must be positive for linear scale axes.  For
          logarithmic scale axes n must be either negative (then there
          will be (1-n) ticks at a linear distance) or one of 1, 2, or
          3 where n then indicates the number of ticks per decade.

similar for yaxp?  What am I missing?
Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Thu Feb  1 09:07:10 2001
From: adrian@olsen.ch (adrian@olsen.ch)
Date: Thu, 1 Feb 2001 10:07:10 +0100 (MET)
Subject: [Rd] inconsistent behaviour between class() and inherits() (PR#834)
Message-ID: <200102010907.KAA29138@pubhealth.ku.dk>

Example:

> x<-ts(rnorm(10))
> y<-ts(rnorm(10))
> r<-residuals(lm(y~x))
> is.ts(r)
[1] FALSE
> inherits(r,"ts")
[1] FALSE
> class(r)
[1] "ts"
> is.ts(x)
[1] TRUE
> inherits(x,"ts")
[1] TRUE
> class(x)
[1] "ts"


--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.5.1
 arch = sparc
 os = solaris2.5.1
 system = sparc, solaris2.5.1
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:olsen, package:ffnet, package:tseries, package:ts, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From james.lindsey@luc.ac.be  Thu Feb  1 09:56:07 2001
From: james.lindsey@luc.ac.be (james.lindsey@luc.ac.be)
Date: Thu, 1 Feb 2001 10:56:07 +0100 (MET)
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <200102010956.KAA29982@pubhealth.ku.dk>

The following seems to be a contradiction:

> df <- data.frame(x=gl(2,1,10))
> df[,1]
 [1] 1 2 1 2 1 2 1 2 1 2
Levels:  1 2 
> df[,1,drop=F]
   x
1  1
2  2
3  1
4  2
5  1
6  2
7  1
8  2
9  1
10 2
> is.factor(df[,1,drop=F])
[1] FALSE
> is.factor(df[,1])
[1] TRUE

with R1.2.1 both MS Windows and Intel RH5.2 versions.
 Jim

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb  1 10:15:26 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 1 Feb 2001 11:15:26 +0100 (MET)
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <200102011015.LAA00372@pubhealth.ku.dk>

> From: james.lindsey@luc.ac.be
> Date: Thu, 1 Feb 2001 10:56:07 +0100 (MET)
> 
> The following seems to be a contradiction:

What is, pray?

> class(df[, 1])
[1] "factor"
> class(df[, 1, drop = FALSE])
[1] "data.frame"

df[ , 1, drop=FALSE] is a data frame, so not a factor.
df[ , 1] is a factor.

> > df <- data.frame(x=gl(2,1,10))
> > df[,1]
>  [1] 1 2 1 2 1 2 1 2 1 2
> Levels:  1 2 
> > df[,1,drop=F]
>    x
> 1  1
> 2  2
> 3  1
> 4  2
> 5  1
> 6  2
> 7  1
> 8  2
> 9  1
> 10 2
> > is.factor(df[,1,drop=F])
> [1] FALSE
> > is.factor(df[,1])
> [1] TRUE
> 
> with R1.2.1 both MS Windows and Intel RH5.2 versions.
>  Jim

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From duncan@research.bell-labs.com  Thu Feb  1 12:45:15 2001
From: duncan@research.bell-labs.com (Duncan Temple Lang)
Date: Thu, 1 Feb 2001 07:45:15 -0500 (EST)
Subject: [Rd] Is Omegahat in R a general language function bus ?
Message-ID: <200102011245.HAA04008@jessie.research.bell-labs.com>


> Date: Tue, 30 Jan 2001 14:51:49 +0000
> From: David K Walker <dkwalker@online.no>
> Sender: owner-r-devel@stat.math.ethz.ch
> Precedence: bulk
> 
> Hi !
> 
> Can we e.g. embed Perl in R and embed R in Java, start the program counter
> in Java, call from Java to Perl via R, and then either (1) call back from
> Perl to Java via R or (2) just plain return from Perl to Java via R ?

Conceptually, Omegahat can act in this way as a broker or bus
connecting two other languages within R. However, in practice, I think
one would be less inclined to use this approach than finding a more
direct communication mechanism, in this case between Perl and Java.
And indeed there is such a mechanism -- JPL -- and it is more than
likeley available in your Perl installation (perhaps not compiled).
Code in these two languages could communicate with each other using
this mechanism and both could be running within R and communicating
with S code via the .Perl, .Java and callback mechanisms.

Using Omegahat as the broker would involve an extra layer of
conversion. Even if this were not an issue for performance in a
particular project, it certainly is a more complex setup to debug.  If
there were not already a tool for this pair of languages (Perl and
Java), it might indeed make sense to use Omegahat as a "quickly"
deployed prototype. 



> My reason for asking this is general interest in extensible programming
> languages.  My background is heavy in Forth, moderate in assembly language,
> so far very light in Scheme, R, Java, Perl, XML, Python.  Later I hope to
> implement new statistical software and port an existing large scale time
> series database/editor/tablewriter as packages under Debian
> Gnu/Linux.

And it is very much our goal in developing the collection of Omegahat
inter-system interface packages to facilitate this type of development
with the minimal amount of re-development. So it would be good to find
out what is needed and see how these interfaces can be adapted to such
needs.  Perhaps it would be good to discuss these on the omegahat
development list (omega-devel@omegahat.org) or directly with me.

> 
> David Walker
> 

 All the best,
  Duncan

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lhecking@nmrc.ie  Thu Feb  1 18:41:19 2001
From: lhecking@nmrc.ie (lhecking@nmrc.ie)
Date: Thu, 1 Feb 2001 19:41:19 +0100 (MET)
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
Message-ID: <200102011841.TAA08532@pubhealth.ku.dk>


 Unless I force the Fortran compiler through --with-g77, configure fails to
 find and use the installed g77. I would submit a patch for configure.in,
 but I can't quite follow the logic in configure.in.

$ ./configure 
creating cache ./config.cache
[...]
checking for main in -lm... yes
checking for g77... /usr/local/gnu/bin/g77
checking for fort77... (cached) /usr/local/gnu/bin/g77
checking for f77... (cached) /usr/local/gnu/bin/g77
checking for f90... (cached) /usr/local/gnu/bin/g77
checking for xlf... (cached) /usr/local/gnu/bin/g77
checking for cf77... (cached) /usr/local/gnu/bin/g77
checking for fc... (cached) /usr/local/gnu/bin/g77
checking for f2c... no
configure: error: Neither an F77 compiler nor f2c found
$ 


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Thu Feb  1 19:20:41 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Thu, 1 Feb 2001 20:20:41 +0100 (MET)
Subject: [Rd] screen doesn't handle redrawing properly (PR#837)
Message-ID: <200102011920.UAA08731@pubhealth.ku.dk>


Hi.  As far as I understand it, there is a list of graphic primitives
stored for a device.  So for example, when I iconify/deiconify an X11
window, the plot will be redrawn.  Now screen (split.screen and
friends) appear not to handle this list properly, the list is reset or
not reset at odd times.  The commands below will show clearly what I
mean.  There are two effects:

  - After splitting the device real estate into two screens, I can
    plot on these screens, alternating between them.  When I then
    touch the window to force a redraw, *all* the plots are redrawn,
    not just the last (and visible) ones.
    [This happens when the X server runs on AIX, R runs on AIX or Sun.]

  - Again, after splitting, plotting on one screen can affect the
    other screen.  I.e. plot(...); plot (...) on the left screen can
    erase the *right* screen.
    [This happens for all platforms I have access to, AIX, Linux, Sun.]

The first effect may be due to a bad interaction with the X server,
but the second effect is surely not desirable, is it?  Am I mis-using
'screen' here?

R> split.screen (c(1,2))
[1] 1 2
R> # Draw 10000 points to make the effect obvious
R> screen (1)
R> plot (1:10000, 1:10000, main="1")
R> screen (2)
R> plot (1:10000, 1:10000, main="2")
R> # Ok, go back to screen 1, draw plots 3 and 4
R> screen (1)
R> plot (1:10000, 10000:1, main="3")
R> screen (2)
R> plot (1:10000, 10000:1, main="4")
R> 
R> ########################################
R> # NOW lower/raise window, do something to force device to redraw itself.
R> # You'll see again plot 1 (!), 2 (!), 3, and 4.  Why 1 and 2?
R> ########################################
R> 
R> # Here's how to erase screen 2 from screen 1 (!)
R> screen (1)
R> plot (1:10, 1:10, main="3a")
R> ########################################
R> # The following plot will erase screen 2
R> ########################################
R> plot (1:10, 1:10, main="3b")
R> 
R> # The good news is that this resets the list of graphic ops:
R> screen (2)
R> plot (1:10, 1:10, main="4")
R> # Now if you touch the window, you'll see only plot 3b and 4.

Regards,
  -tom

R> R.version
         _                   
platform sparc-sun-solaris2.7
arch     sparc               
os       solaris2.7          
system   sparc, solaris2.7   
status   Patched             
major    1                   
minor    2.1                 
year     2001                
month    01                  
day      31                  
language R                   

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@CMIS.CSIRO.AU  Fri Feb  2 07:30:09 2001
From: Bill.Venables@CMIS.CSIRO.AU (Bill.Venables@CMIS.CSIRO.AU)
Date: Fri, 2 Feb 2001 17:30:09 +1000
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <2B7F04539DAFD311B61D009027D0DDA20C3C85@roper-cv.qld.cmis.CSIRO.AU>



| -----Original Message-----
| From: james.lindsey@luc.ac.be [mailto:james.lindsey@luc.ac.be]
| Sent: Thursday, 1 February 2001 19:56
| To: r-devel@stat.math.ethz.ch
| Cc: R-bugs@biostat.ku.dk
| Subject: [Rd] factors in data.frames (PR#835)
| 
| 
| The following seems to be a contradiction:
| 
| > df <- data.frame(x=gl(2,1,10))
| > df[,1]
|  [1] 1 2 1 2 1 2 1 2 1 2
| Levels:  1 2 
| > df[,1,drop=F]
|    x
| 1  1
| 2  2
| 3  1
| 4  2
| 5  1
| 6  2
| 7  1
| 8  2
| 9  1
| 10 2
| > is.factor(df[,1,drop=F])
| [1] FALSE
| > is.factor(df[,1])
| [1] TRUE
| 
| with R1.2.1 both MS Windows and Intel RH5.2 versions.
|  Jim

Eh?  df[,1,drop = F] is a data frame with one component and hence NOT a
factor 
 but df[,1] is one (factor) component of a fata frame and hence IS a factor.

I think it is entirely consistent with the advertised behaviour.

Bill.

| 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Feb  2 20:26:25 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 2 Feb 2001 21:26:25 +0100
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
In-Reply-To: <200102011841.TAA08532@pubhealth.ku.dk>
References: <200102011841.TAA08532@pubhealth.ku.dk>
Message-ID: <14971.6129.767816.279330@mithrandir.hornik.net>

>>>>> lhecking  writes:

>  Unless I force the Fortran compiler through --with-g77, configure fails to
>  find and use the installed g77. I would submit a patch for configure.in,
>  but I can't quite follow the logic in configure.in.

> $ ./configure 
> creating cache ./config.cache
> [...]
> checking for main in -lm... yes
> checking for g77... /usr/local/gnu/bin/g77
> checking for fort77... (cached) /usr/local/gnu/bin/g77
> checking for f77... (cached) /usr/local/gnu/bin/g77
> checking for f90... (cached) /usr/local/gnu/bin/g77
> checking for xlf... (cached) /usr/local/gnu/bin/g77
> checking for cf77... (cached) /usr/local/gnu/bin/g77
> checking for fc... (cached) /usr/local/gnu/bin/g77
> checking for f2c... no
> configure: error: Neither an F77 compiler nor f2c found
> $ 

It might have been helpful to use bug.report() ...

Which platform is this?
Apparently /usr/local/gnu/bin/g77 is the GNU C compiler?
What happens if you do

F77=/usr/local/gnu/bin/g77
file ${F77} | grep script

???

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lhecking@nmrc.ie  Sat Feb  3 16:11:13 2001
From: lhecking@nmrc.ie (Lars Hecking)
Date: Sat, 3 Feb 2001 16:11:13 +0000
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
In-Reply-To: <14971.6129.767816.279330@mithrandir.hornik.net>; from Kurt.Hornik@ci.tuwien.ac.at on Fri, Feb 02, 2001 at 09:26:25PM +0100
References: <200102011841.TAA08532@pubhealth.ku.dk> <14971.6129.767816.279330@mithrandir.hornik.net>
Message-ID: <20010203161113.B3001@nmrc.ie>


> It might have been helpful to use bug.report() ...
 
 I'm not a user of R, I just install the stuff :)

> Which platform is this?

 Solaris 7 SPARC.

> Apparently /usr/local/gnu/bin/g77 is the GNU C compiler?
> What happens if you do
> 
> F77=/usr/local/gnu/bin/g77
> file ${F77} | grep script

$ file /usr/local/gnu/bin/g77
/usr/local/gnu/bin/g77: executable shell script
$ 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Sat Feb  3 19:27:47 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 03 Feb 2001 14:27:47 -0500
Subject: [Rd] tk non-widget commands (esp. update and winfo)
Message-ID: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>


Hi,

I've been playing with the tcltk package.  It's very nice to have
access to buttons, menus etc. now.  Thank you!

Alas, I also have questions: In Tcl everything is a string [*].  This
is not the case in R, of course.  So why are return values of tk
commands still strings?  (Is there any other reason than speed or
"package is work in progress"?)

Example:

   > tt <- tktoplevel ()
   > tkwinfo ("width", tt)
  [1] "200"

Could (Should?) be:

   > tt <- tktoplevel ()
   > tkwinfo ("width", tt)
  [1] 200

with 
   > tkwidth <- function (widget) as.numeric (tkcmd ("winfo", "width", widget))

Maybe a better example is the use of logical results:

  > if (tkwinfo ("exists", tt)) cat ("exists\n")
  Error in if (tkwinfo("exists", tt)) cat("exists\n") : 
          argument of if(*) is not interpretable as logical

Huh? Here you might have expected:

  > if (tkexists (tt)) cat ("exists\n")
  exists

with
  > tkexists <- function (widget) (tkcmd ("winfo", "exists", widget) == "1")

One problem is that the number of functions just explodes, so it might
be better to wrap them into one enchillada?

  >  tkwinfo <- function (widget, what="exists", ...) 
     switch (what,
             exists=tkcmd("winfo", "exists", widget)=="1",
             ismapped=tkcmd("winfo", "ismapped", widget)=="1",
             width=as.numeric (tkcmd("winfo", "width", widget)),
             height=as.numeric (tkcmd("winfo", "height", widget)),
             tkcmd ("winfo", what, widget, ...))

(The other problem is that tkcmd("winfo",...) may fail.)

Oh, while I'm at it:  There is no tkupdate:
  >  tkupdate <- function (idletasks=FALSE)
     if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")

(which is essential to making sure that a window is mapped before its
width or height is queried.)  That's trivial if you have hacked Tcl/Tk
before -- so who is the package tlctk aimed at?

Regards,
  -tom


[*] Nowadays, they have glorified strings into objects.  Anywho...

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Feb  3 20:05:06 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 03 Feb 2001 21:05:06 +0100
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Thomas Vogels's message of "03 Feb 2001 14:27:47 -0500"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>
Message-ID: <x2n1c3353h.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@ece.cmu.edu> writes:

> Hi,
> 
> I've been playing with the tcltk package.  It's very nice to have
> access to buttons, menus etc. now.  Thank you!
> 
> Alas, I also have questions: In Tcl everything is a string [*].  This
> is not the case in R, of course.  So why are return values of tk
> commands still strings?  (Is there any other reason than speed or
> "package is work in progress"?)

The latter. Also to some extent the fact that it requires more
knowledge about the content of the return value. The argument passing
scheme is as you can see quite general and essentially ignorant of the
routines that are called. In essence the issue is that it is fairly
easy to convert whatever to strings, but harder the other way around.
So for the first iteration of the package, the idea would be to have
the user do the necessary as.xxx conversions of return values.

> One problem is that the number of functions just explodes, so it might
> be better to wrap them into one enchillada?
> 
>   >  tkwinfo <- function (widget, what="exists", ...) 
>      switch (what,
>              exists=tkcmd("winfo", "exists", widget)=="1",
>              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
>              width=as.numeric (tkcmd("winfo", "width", widget)),
>              height=as.numeric (tkcmd("winfo", "height", widget)),
>              tkcmd ("winfo", what, widget, ...))
> 
> (The other problem is that tkcmd("winfo",...) may fail.)
> 
> Oh, while I'm at it:  There is no tkupdate:
>   >  tkupdate <- function (idletasks=FALSE)
>      if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")
> 
> (which is essential to making sure that a window is mapped before its
> width or height is queried.)  That's trivial if you have hacked Tcl/Tk
> before -- so who is the package tlctk aimed at?

Tcl/Tk hackers of course, the author of the package not being one...

Basically, the plan is to add stuff as it becomes necessary to do
useful things, so feedback and suggestions from developers are always
welcome.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Feb  4 14:38:05 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 04 Feb 2001 15:38:05 +0100
Subject: [Rd] help with build on windows needed.
Message-ID: <3A7D694D.EA43CA59@univie.ac.at>

i installed r for window 1.2.1
and suddenly
rcmd build 
does not work any more.

C:\work\checked.out>rcmd build
Please set TMPDIR to a valid temporary directory

C:\work\checked.out>echo %TMPDIR%
C:\Documents and Settings\Erich Neuwirth\Local Settings\Temp

and this is a valid directory.

things worked smoothly in 1.2.0

what can i do?



--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb  4 15:48:33 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 4 Feb 2001 15:48:33 +0000 (GMT)
Subject: [Rd] help with build on windows needed.
In-Reply-To: <3A7D694D.EA43CA59@univie.ac.at>
Message-ID: <Pine.GSO.4.31.0102041542460.21221-100000@toucan.stats>

On Sun, 4 Feb 2001, Erich Neuwirth wrote:

> i installed r for window 1.2.1
> and suddenly
> rcmd build
> does not work any more.
>
> C:\work\checked.out>rcmd build
> Please set TMPDIR to a valid temporary directory
>
> C:\work\checked.out>echo %TMPDIR%
> C:\Documents and Settings\Erich Neuwirth\Local Settings\Temp
>
> and this is a valid directory.
>
> things worked smoothly in 1.2.0
>
> what can i do?

Win2k, right?  It's a Windows Perl bug, already discussed a couple
of times here or R-help.  In rw1021/bin/build replace

        unless (-d $TMPDIR);
by

        unless (-e $tmpdir);

Basically, -d is not working properly on any Windows platform, but it
is incorrectly mostly returning false on Win2K, and always true on NT4.

It's possible that you need
        unless (-e '$tmpdir');

if so, please let me know.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Feb  4 18:00:34 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 04 Feb 2001 19:00:34 +0100
Subject: [Rd] Rcsound
Message-ID: <3A7D98C2.A6D18B98@univie.ac.at>

there is a new version of my "R sings" package
no functional changes, but more stable and reliable on windows.
feedback about unix needed!

http://sunsite.univie.ac.at/~neuwirth/Rcsound/


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From daniel.egloff@dplanet.ch  Sun Feb  4 21:37:36 2001
From: daniel.egloff@dplanet.ch (daniel.egloff@dplanet.ch)
Date: Sun, 4 Feb 2001 22:37:36 +0100 (MET)
Subject: [Rd] Linux shared library problem (PR#838)
Message-ID: <200102042137.WAA28592@pubhealth.ku.dk>

Full_Name: Daniel Egloff
Version: 1.2.1
OS: Linux Redhat 7.0
Submission from: (NULL) (212.35.34.200)


Externals in the shared library libc.so.6 not found. See the 
following R session, with the abort message at the end.

> demo(graphics)
 
 
        demo(graphics)
        ---- ~~~~~~~~
 
Type  <Return>   to start :
 
> opar <- par(ask = interactive() && (.Device %in% c("X11",
    "GTK", "windows", "Macintosh")))
 
> x <- rnorm(50)
 
> opar <- c(opar, par(bg = "white"))
 
> plot(x, ann = FALSE, type = "n")
Hit <Return> to see next plot:
 
> abline(h = 0, col = gray(0.9))
 
> lines(x, col = "green4", lty = "dotted")
 
> points(x, bg = "limegreen", pch = 21)
 
> title(main = "Simple Use of Color In a Plot", xlab = "Just a Whisper of a
Label",
    col.main = "blue", col.lab = gray(0.8), cex.main = 1.2, cex.lab = 1,
    font.main = 4, font.lab = 3)
 
> par(bg = "gray")
 
> piechart(rep(1, 24), col = rainbow(24), radius = 0.9)
Hit <Return> to see next plot:
 
> title(main = "A Sample Color Wheel", cex.main = 1.4,
    font.main = 3)
 
> title(xlab = "(Use this as a test of monitor linearity)",
    cex.lab = 0.8, font.lab = 3)
 
> pie.sales <- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
 
> names(pie.sales) <- c("Blueberry", "Cherry", "Apple",
    "Boston Cream", "Other", "Vanilla Cream")
 
> piechart(pie.sales, col = c("purple", "violetred1",
    "green3", "cornsilk", "cyan", "white"))
Hit <Return> to see next plot:
/usr/lib/R/bin/R.bin: error while loading shared libraries:
/usr/lib/R/bin/R.bin: symbol __sysconf, version GLIBC_2.2 not defined in file
libc.so.6 with link time reference
[dani@PLUTO amopt_sim]$             

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb  4 22:32:41 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 Feb 2001 23:32:41 +0100
Subject: [Rd] Linux shared library problem (PR#838)
In-Reply-To: daniel.egloff@dplanet.ch's message of "Sun, 4 Feb 2001 22:37:36 +0100 (MET)"
References: <200102042137.WAA28592@pubhealth.ku.dk>
Message-ID: <x2d7cyf59y.fsf@blueberry.kubism.ku.dk>

daniel.egloff@dplanet.ch writes:

> Full_Name: Daniel Egloff
> Version: 1.2.1
> OS: Linux Redhat 7.0
> Submission from: (NULL) (212.35.34.200)
> 
> 
> Externals in the shared library libc.so.6 not found. See the 
> following R session, with the abort message at the end.
> 
....
> > piechart(pie.sales, col = c("purple", "violetred1",
>     "green3", "cornsilk", "cyan", "white"))
> Hit <Return> to see next plot:
> /usr/lib/R/bin/R.bin: error while loading shared libraries:
> /usr/lib/R/bin/R.bin: symbol __sysconf, version GLIBC_2.2 not defined in file
> libc.so.6 with link time reference
> [dani@PLUTO amopt_sim]$             

if (you.compiled.it) {
    have.you(updated.gcc)   # need 2.96-69 or better
    have.you(updated.glibc) # at -12 now. I think the orig caused trouble 
} else {
    have.you(correct.rpm)   # need the one for 7.0
    have.you(updated.glibc) # at -12 now. I think the orig caused trouble 
}
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jason@cs.rochester.edu  Mon Feb  5 01:17:21 2001
From: jason@cs.rochester.edu (jason@cs.rochester.edu)
Date: Mon, 5 Feb 2001 02:17:21 +0100 (MET)
Subject: [Rd] clipped lines have wrong slope in log plot (PR#839)
Message-ID: <200102050117.CAA29241@pubhealth.ku.dk>

Hi,

I'm using R version 1.2.0 (2000-12-15), on RedHat Linux 6.2 (kernel 2.2.14).

The following command ought to plot a straight-line on a log-log
graph but instead plots two line segments, both with the wrong
slope:

  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,20),ylim=c(1,20),log="xy")

Only clipped lines seem to have this problem.  Changing to type "b"
or enlarging the ranges fixes it:

  plot(c(1,10,100),c(100,10,1),type="b",xlim=c(1,20),ylim=c(1,20),log="xy")
  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,100),ylim=c(1,100),log="xy")

abline has the same problem.  Try following the above calls with abline(2,-1).
(This is supposed to plot a straight line in the log-log domain, and
does, but it's the wrong straight line.)

I can also get the problem where only one axis is logarithmic.  
Let's untransform the x-axis from the original command:
 
  plot(log(c(1,10,100)),c(100,10,1),type="l",xlim=log(c(1,20)),ylim=c(1,20),log="y")

Thanks! - Jason Eisner






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Feb  5 10:50:38 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 5 Feb 2001 10:50:38 +0000 (GMT)
Subject: [Rd] Change of licence for header files and import libraries
Message-ID: <200102051050.KAA22990@toucan.stats.ox.ac.uk>

The copyrights on the distributed header files and export files R.exp
have been changed to the more permissive LGPL.

It came to our attention that some projects are interpreting GPL to
mean that compiling against the header files or linking against a
Windows import library brings the compiled code under the scope of
GPL.  This would mean it would be impossible to distribute binary
versions of non-GPL packages with compiled code which called entry
points in the R executable or DLL, of which there are many on CRAN.

We encourage packages to be distributed under Open Source conditions,
but accept that this is not possible for some contributions.  Our
intention is that export files and import libraries be `accessors'
under clause 5 of the LGPL, so that in most cases no (additional)
restrictions are imposed by compiling a package using the LGPL-ed
components of R.

To avoid any anomalies, the versions of the same files in R versions
1.0.0 to 1.2.1 may also be used under LGPL or GPL.

For the R core team,

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paradis@isem.univ-montp2.fr  Mon Feb  5 11:12:29 2001
From: paradis@isem.univ-montp2.fr (Emmanuel Paradis)
Date: Mon, 05 Feb 2001 12:12:29 +0100
Subject: [Rd] clipped lines have wrong slope in log plot (PR#839)
Message-ID: <3.0.32.20010205121229.008ec380@162.38.183.200>

At 02:17 05/02/01 +0100, you wrote:
>Hi,
>
>I'm using R version 1.2.0 (2000-12-15), on RedHat Linux 6.2 (kernel 2.2.14).
>
>The following command ought to plot a straight-line on a log-log
>graph but instead plots two line segments, both with the wrong
>slope:
>
>  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,20),ylim=c(1,20),log="xy")
>
>Only clipped lines seem to have this problem.  Changing to type "b"
>or enlarging the ranges fixes it:
>
>  plot(c(1,10,100),c(100,10,1),type="b",xlim=c(1,20),ylim=c(1,20),log="xy")
>  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,100),ylim=c(1,100),log="xy")
>
>abline has the same problem.  Try following the above calls with
abline(2,-1).
>(This is supposed to plot a straight line in the log-log domain, and
>does, but it's the wrong straight line.)
>
>I can also get the problem where only one axis is logarithmic.  
>Let's untransform the x-axis from the original command:
> 
>
plot(log(c(1,10,100)),c(100,10,1),type="l",xlim=log(c(1,20)),ylim=c(1,20),lo
g="y")
>
>Thanks! - Jason Eisner

I had a similar result with R-1.2.1 on WinNT 4.0.

plot(c(1,10,100), c(100,10,1), type="l", log="xy")  ### this looks OK
plot(c(1,10,100), c(100,10,1), type="l", xlim=c(1,20), ylim=c(1,20), log="xy")

I'd expect setting xlim= and ylim= would 'zoom in' on the first plot, but
it doesn't. It seems that, in this second case, that the coordinates of the
points outside the plotting region are not computed on the log-scale but on
the normal arithmetic scale.


Emmanuel Paradis
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 10:25:39 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 11:25:39 +0100
Subject: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <Pine.GSO.4.31.0102051834530.282-100000@auk.stats>
References: <Pine.GSO.4.31.0102051834530.282-100000@auk.stats>
Message-ID: <01020611253900.00712@Centaurea>

Prof. Ripley wrote on r-help:

> Completely distinct row vectors?  Take a look at the code of
> merge.data.frame.  Something like
>
>     bx <- matrix(as.character(a), nrow(a))
>     bx <- drop(apply(bx, 1, function(x) paste(x, collapse = "\r")))
>     length(unique(bx))
>
> This turns each row into a single character string, and counts the unique
> ones.

Hmmm... couldn't one build on this in order to generalize the 
unique() function?

I'm asking because when I once tried to use unique() on a matrix (to collapse 
duplicate rows), I found that it and duplicated() work only on vectors. I 
think a generalization, at least for matrices and simple data.frames, would 
be useful.

I tried my hand at it and came up with this:

----------------------------------------------------

"unique.default" <- get("unique", pos="package:base")    # old version becomes
                                                         # default behaviour
"unique" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(unique.matrix(object, ...))
   else
       UseMethod("unique")      # doesn't seem to work for matrices, hence 
}                               # the condition
                         


"duplicated.default" <- get("duplicated", pos="package:base")	

"duplicated" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(duplicated.matrix(object, ...))
   else
       UseMethod("duplicated")  
}


"duplicated.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
  return(duplicated(strvect))
}


"unique.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  dup <- duplicated(mat, MARGIN)
  return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
}


"duplicated.data.frame" <-
  function(df, MARGIN=1)
{
  strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse 
= "\r")))
  duplicated(strvect)
}


"unique.data.frame" <-
  function(df, MARGIN=1)
{
  dup <- duplicated(df, MARGIN)
  return(if (MARGIN==1) df[!dup,] else df[,!dup])
}

----------------------------------------------------

I couldn't figure out how to generalize to more than two dimensions (more 
accurately, how to subset in the dimension given by the variable MARGIN). 

Does anybody else consider this useful?


Cheers

Kaspar Pflugshaupt
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 12:34:01 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 13:34:01 +0100
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <01C09039.6E17C100.jens.oehlschlaegel@bbdo-interone.de>
References: <01C09039.6E17C100.jens.oehlschlaegel@bbdo-interone.de>
Message-ID: <01020613340100.00877@Aconitum>

On Tuesday 06 February 2001 12:36, Dr. Jens Oehlschlägel wrote:
> I like the idea. Why don't you call duplicated.matrix() directly in
> unique.matrix() and duplicated.data.frame() in unique.data.frame() ?
>
> Jens Oehlschlägel

Good point. I guess I got carried away with using methods (having just gotten 
the hang of the concept). :-)

Anyway, here's a corrected version:

----------------------------------------------------

"unique.default" <- get("unique", pos="package:base")    # old version becomes
                                                         # default behaviour
"unique" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(unique.matrix(object, ...))
   else
       UseMethod("unique")      # doesn't seem to work for matrices, hence 
}                               # the condition
                         


"duplicated.default" <- get("duplicated", pos="package:base")    

"duplicated" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(duplicated.matrix(object, ...))
   else
       UseMethod("duplicated")  
}


"duplicated.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
  return(duplicated(strvect))
}


"unique.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  dup <- duplicated.matrix(mat, MARGIN)
  return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
}


"duplicated.data.frame" <-
  function(df, MARGIN=1)
{
  strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse 
= "\r")))
  duplicated(strvect)
}


"unique.data.frame" <-
  function(df, MARGIN=1)
{
  dup <- duplicated.data.frame(df, MARGIN)
  return(if (MARGIN==1) df[!dup,] else df[,!dup])
}

----------------------------------------------------

Cheers

Kaspar Pflugshaupt
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb  6 12:49:28 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Feb 2001 12:49:28 +0000 (GMT)
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <01020613340100.00877@Aconitum>
Message-ID: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>

Method dispatch is far from free (it is quite slow). Do we want to
encumber unique() (a fast internal function) in this way?

There are better ways to do this if one is going to use C code:
converting to character and comparing long strings are both expensive,


On Tue, 6 Feb 2001, Kaspar Pflugshaupt wrote:

> On Tuesday 06 February 2001 12:36, Dr. Jens Oehlschlägel wrote:
> > I like the idea. Why don't you call duplicated.matrix() directly in
> > unique.matrix() and duplicated.data.frame() in unique.data.frame() ?
> >
> > Jens Oehlschlägel
>
> Good point. I guess I got carried away with using methods (having just gotten
> the hang of the concept). :-)
>
> Anyway, here's a corrected version:
>
> ----------------------------------------------------
>
> "unique.default" <- get("unique", pos="package:base")    # old version becomes
>                                                          # default behaviour
> "unique" <- function(object, ...)
> {
>    if (data.class(object)=="matrix")
>        return(unique.matrix(object, ...))
>    else
>        UseMethod("unique")      # doesn't seem to work for matrices, hence
> }                               # the condition
>                          
>
>
> "duplicated.default" <- get("duplicated", pos="package:base")   
>
> "duplicated" <- function(object, ...)
> {
>    if (data.class(object)=="matrix")
>        return(duplicated.matrix(object, ...))
>    else
>        UseMethod("duplicated")  
> }
>
>
> "duplicated.matrix" <-
>   function(mat, MARGIN=1)    # defaulting to work on rows
> {
>   strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
>   return(duplicated(strvect))
> }
>
>
> "unique.matrix" <-
>   function(mat, MARGIN=1)    # defaulting to work on rows
> {
>   dup <- duplicated.matrix(mat, MARGIN)
>   return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
> }
>
>
> "duplicated.data.frame" <-
>   function(df, MARGIN=1)
> {
>   strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse
> = "\r")))
>   duplicated(strvect)
> }
>
>
> "unique.data.frame" <-
>   function(df, MARGIN=1)
> {
>   dup <- duplicated.data.frame(df, MARGIN)
>   return(if (MARGIN==1) df[!dup,] else df[,!dup])
> }
>
> ----------------------------------------------------
>
> Cheers
>
> Kaspar Pflugshaupt
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Tue Feb  6 14:50:42 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Tue, 6 Feb 2001 15:50:42 +0100 (MET)
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
Message-ID: <200102061450.PAA22765@pubhealth.ku.dk>


Hi.  This is cosmetic in nature, yet annoying as the warning points
to the wrong source:  On a screen running on an X server with 100 DPI,
I always got warnings about X11 using the wrong font size:

> x11()
Warning message: 
X11 used font size 17 when 12 was requested 

Then I looked at the code and X11 is _not_ to be blamed for this:
R resets the requested font size for 100 DPI screens!  There should be
no warning.  (At least not a warning that makes people wonder whether
they misconfigured the font server again.)

The patch below moves Peter's scaling equation up, before the font
cache check and directly writes to size.  Thus it's true that:
  variable size == (IS_100DPI ? scaled requested size : requested size)
  variable pixelsize == (font available ? size (same as above)
						: size of allocated font)

Regards,
  -tom



*** ../src/unix/X11/devX11.c	Tue Feb  6 09:27:48 2001
--- ../src/unix/X11/devX11.c~	Fri Feb  2 08:20:37 2001
***************
*** 834,855 ****
      if (size < SMALLEST) size = SMALLEST;
      face--;
  
-     /* Here's a 1st class fudge: make sure that the Adobe design sizes
-        8, 10, 11, 12, 14, 17, 18, 20, 24, 25, 34 can be obtained via
-        an integer "size" at 100 dpi, namely 6, 7, 8, 9, 10, 12, 13,
-        14, 17, 18, 24 points. It's almost y = x * 100/72, but not
-        quite. The constants were found using lm(). --pd */
-     if (IS_100DPI) size = R_rint(size * 1.43 - 0.4);
- 
      /* search fontcache */
      for ( i = nfonts ; i-- ; ) {
  	f = &fontcache[i];
  	if ( f->face == face && f->size == size ) return f->font;
      }
  
!     /* 'size' is the requested size, 'pixelsize'  the size of the
!        actually allocated font*/
!     pixelsize = size;
  
      if (face == 4)
  	sprintf(buf, symbolname,  pixelsize);
--- 834,854 ----
      if (size < SMALLEST) size = SMALLEST;
      face--;
  
      /* search fontcache */
      for ( i = nfonts ; i-- ; ) {
  	f = &fontcache[i];
  	if ( f->face == face && f->size == size ) return f->font;
      }
  
! 
! 
!     /* Here's a 1st class fudge: make sure that the Adobe design sizes
!        8, 10, 11, 12, 14, 17, 18, 20, 24, 25, 34 can be obtained via
!        an integer "size" at 100 dpi, namely 6, 7, 8, 9, 10, 12, 13,
!        14, 17, 18, 24 points. It's almost y = x * 100/72, but not
!        quite. The constants were found using lm(). --pd */
! 
!     pixelsize = IS_100DPI ? R_rint(size * 1.43 - 0.4) : size;
  
      if (face == 4)
  	sprintf(buf, symbolname,  pixelsize);


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 02
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  6 15:33:19 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Feb 2001 16:33:19 +0100
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 6 Feb 2001 15:50:42 +0100 (MET)"
References: <200102061450.PAA22765@pubhealth.ku.dk>
Message-ID: <x2zofzvnb4.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:

> Hi.  This is cosmetic in nature, yet annoying as the warning points
> to the wrong source:  On a screen running on an X server with 100 DPI,
> I always got warnings about X11 using the wrong font size:
> 
> > x11()
> Warning message: 
> X11 used font size 17 when 12 was requested 
> 
> Then I looked at the code and X11 is _not_ to be blamed for this:
> R resets the requested font size for 100 DPI screens!  There should be
> no warning.  (At least not a warning that makes people wonder whether
> they misconfigured the font server again.)
                                     ===== :-)

Thanks. (Funny... I could have sworn I zapped that 100DPI
special-casing a while back. Maybe I forgot to commit?)

> 
> The patch below moves Peter's scaling equation up, before the font
> cache check and directly writes to size.  Thus it's true that:
>   variable size == (IS_100DPI ? scaled requested size : requested size)
>   variable pixelsize == (font available ? size (same as above)
> 						: size of allocated font)
> 
> Regards,
>   -tom

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 15:51:34 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 16:51:34 +0100
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>
References: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>
Message-ID: <01020616503101.00877@Aconitum>

On Tuesday 06 February 2001 13:49, Prof Brian Ripley wrote:

> Method dispatch is far from free (it is quite slow). Do we want to
> encumber unique() (a fast internal function) in this way?

That's a good argument. I did not know dispatch was such a problem in terms 
of speed. J. Oelschlägel suggested eliminating two dispatches by calling 

  return(duplicated.default(strvect)) 

instead of

  return(duplicated(strvect))

in both duplicated.matrix() and duplicated.data.frame().
But the speed gain, following your second argument, would probably be 
marginal. And the default methods would still get dispatched.

>
> There are better ways to do this if one is going to use C code:
> converting to character and comparing long strings are both expensive,

Since I cannot write C, this is not an option for me. I guess I'll take back 
my proposal and use the functions privately. I might publish them on r-help 
(in a non-dispatched form, not overloading the original functions), so others 
can use them as well.


Thanks for the feedback (I learned a lot)

Kaspar Pflugshaupt

----

Kaspar Pflugshaupt
Geobotanical Institute
ETH Zurich, Switzerland

http://www.geobot.umnw.ethz.ch
mailto:pflugshaupt@geobot.umnw.ethz.ch

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  6 16:32:39 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Feb 2001 17:32:39 +0100
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 6 Feb 2001 15:50:42 +0100 (MET)"
References: <200102061450.PAA22765@pubhealth.ku.dk>
Message-ID: <x2d7cvvkk8.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:

> The patch below moves Peter's scaling equation up, before the font
> cache check and directly writes to size.  Thus it's true that:
>   variable size == (IS_100DPI ? scaled requested size : requested size)
>   variable pixelsize == (font available ? size (same as above)
> 						: size of allocated font)

Patch installed and committed to the release branch (1.2.2pre).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Wed Feb  7 06:15:04 2001
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed, 7 Feb 2001 07:15:04 +0100
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200102070615.HAA03109@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.r-project.org or via email to
r-bugs@r-project.org. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 751 *
Subject: BUG: polyroot()
From: "Li Dongfeng" <mavip1@inet.polyu.edu.hk>
Date: Tue, 28 Nov 2000 13:24:33 +0800
--Numerical instability. We may want a better algorithm!

Directory:  Add-ons

* PR# 824 *
Subject: trouble with netCDF 
From: jasont@indigoindustrial.co.nz
Date: Thu, 25 Jan 2001 12:00:39 +1300
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 812 *
Subject: segmentation fault in integrate
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Thu, 11 Jan 2001 22:49:59 +0100
* PR# 781 *
Subject: syskern fails Rcmd check on Windows, gives incorrect information
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 20 Dec 2000 11:12:47 +0000 (GMT)
--Partially fixed by dse_2000.12, but still uses "ls" and gives
--incorrect information

Directory:  Analyses

* PR# 653 *
Subject: bug in spline()?
From: Ian White <imsw@holyrood.ed.ac.uk>
Date: Mon, 4 Sep 2000 12:29:26 +0100 (BST)
--bug in spline: replace by interSpline in package spline?
--address problems are fixed

Directory:  Documentation

none

Directory:  Graphics

* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
* PR# 726 *
Subject: par(las=.)  gives wrong "adj" for mtext()
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 7 Nov 2000 13:03:58 +0100
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
* PR# 750 *
Subject: abline() does not obey "xpd" (clipping rules)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 27 Nov 2000 18:27:11 +0100
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix will work (and spaces for labels will be fine), but there is a
--deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--I think the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above may
--have side-effects in many other pieces of interpreted code (ii) do_mtext ignores
--
--dd->gp.cexbase unlike, for example, do_plot_xy and anything to do with cexbase
--needs extreme care.
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
* PR# 823 *
Subject: adjustment of expressions with mtext(..., las=2)
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Wed, 24 Jan 2001 20:12:43 +0100
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100

Directory:  In-Out

* PR# 814 *
Subject: Memory problem ?
From: Zoltan Barta <Z.Barta@bristol.ac.uk>
Date: Mon, 15 Jan 2001 09:54:16 +0000 (GMT Standard Time)
--scan crashes R on Linux: a memory allocation problem, probably
--Uses n= or nlines= in scan will use less memory, and read.table does.

Directory:  Installation

* PR# 806 *
Subject: configure error on alpha
From: Richard Beare <Richard.Beare@cmis.CSIRO.AU>
Date: Wed, 10 Jan 2001 16:52:58 +1100

Directory:  Language

* PR# 813 *
Subject: match.call problem
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jan 2001 17:46:15 +0100
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 822 *
Subject: Re: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:56:32 +0100 (CET)
--part of 821
* PR# 821 *
Subject: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:44:28 +0100 (CET)
--See also 822, which shows the segfault is in strftime.c.
--From other correspondence, this is on RH5.0: we can't
--reproduce it on RH6.2 or anywhere else.
* PR# 808 *
Subject: Time zone
From: Herve Morin <morin@mat.ulaval.ca>
Date: Wed, 10 Jan 2001 07:24:07 -0500
--This appears to be a complaint about a warning on a beta Mac version
--(but Macs are never mentioned!).  That version is incomplete.

Directory:  TooMuchAtOnce

* PR# 811 *
Subject: problem with strptime example (and mention of bug.report)
From: Stephen Eglen <stephen@anc.ed.ac.uk>
Date: Thu, 11 Jan 2001 19:18:39 GMT
--1) On OSF4, strptime is deficient. Nothing we can do.
--
--2) On Windows NT, the strptime problems are (i) German locale, English dates,
--(ii) Windows system errors with unknown DST (it move times to DST).
--(i) now has another warning in the help file (there already was one).
--(ii) was already worked around for 1.2.1.
--
--3) bug.report() uses a mailer option that does not exist on OSF4.

Directory:  Windows

none

Directory:  incoming

* PR# 840 *
Subject: X11 warnings about "wrong" font sizes
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 06 Feb 2001 09:50:44 -0500
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500
* PR# 830 *
Subject: Disappearing x axis in plot.factor
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:27:13 -0500
* PR# 829 *
Subject: variables in nls
From: baron@cattell.psych.upenn.edu
Date: Sun, 28 Jan 2001 15:07:27 +0100 (MET)
* PR# 835 *
Subject: factors in data.frames
From: Jim Lindsey <james.lindsey@luc.ac.be>
Date: Thu, 1 Feb 2001 10:55:59 +0100 (MET)
* PR# 834 *
Subject:  inconsistent behaviour between class() and inherits() 
From: adrian@olsen.ch
Date: Thu, 01 Feb 2001 10:07:13 +0100
* PR# 832 *
Subject: Rconsole documentation
From: david.firth@nuffield.oxford.ac.uk
Date: Tue, 30 Jan 2001 15:52:49 +0100 (MET)
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
* PR# 836 *
Subject: configure bug in R-1.2.1 and earlier
From: Lars Hecking <lhecking@nmrc.ie>
Date: Thu, 1 Feb 2001 18:41:09 +0000
* PR# 839 *
Subject: clipped lines have wrong slope in log plot
From: Jason Eisner <jason@cs.rochester.edu>
Date: Sun, 4 Feb 2001 20:17:31 -0500 (EST)
* PR# 838 *
Subject: Linux shared library problem
From: daniel.egloff@dplanet.ch
Date: Sun, 4 Feb 2001 22:37:31 +0100 (MET)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 15:45:58 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 16:45:58 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
References: <200102071105.LAA08910@achill.nmrc.ucc.ie>
 <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
Message-ID: <14977.28086.8858.910911@mithrandir.hornik.net>

>>>>> Yves Gauvreau writes:

> Try this
> sampled <- data.frame(sample(rnorm(100),2))
> colnames(sampled) <- " " # Or preferably something meaningful
> sampled

> 1 1.777068
> 2 0.937161

Ouch!

This *surely* is a bug.  How can it be possible to remove the variable
names in a data frame?

It may be time to reconsider what
	rownames
	colnames
	case.names
	variable.names
do for data frames.

But in fact, both

	names(sampled) <- " "
and
	dimnames(sampled)[[2]] <- " "

happily introduce non-unique variable names in the data frame.

Is the rule that row.names and names must be unique still on?

Argh ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley" <ripley@stats.ox.ac.uk  Mon Feb  5 10:50:38 2001
From: Prof Brian Ripley" <ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 05 Feb 2001 10:50:38 +0000 (GMT)
Subject: [Rd] Change of licence for header files and import libraries
Message-ID: <200102051050.KAA22990@toucan.stats.ox.ac.uk>

The copyrights on the distributed header files and export files R.exp
have been changed to the more permissive LGPL.

It came to our attention that some projects are interpreting GPL to
mean that compiling against the header files or linking against a
Windows import library brings the compiled code under the scope of
GPL.  This would mean it would be impossible to distribute binary
versions of non-GPL packages with compiled code which called entry
points in the R executable or DLL, of which there are many on CRAN.

We encourage packages to be distributed under Open Source conditions,
but accept that this is not possible for some contributions.  Our
intention is that export files and import libraries be `accessors'
under clause 5 of the LGPL, so that in most cases no (additional)
restrictions are imposed by compiling a package using the LGPL-ed
components of R.

To avoid any anomalies, the versions of the same files in R versions
1.0.0 to 1.2.1 may also be used under LGPL or GPL.

For the R core team,

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 15:54:16 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 07:54:16 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.28086.8858.910911@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Yves Gauvreau writes:
> 
> > Try this
> > sampled <- data.frame(sample(rnorm(100),2))
> > colnames(sampled) <- " " # Or preferably something meaningful
> > sampled
> 
> > 1 1.777068
> > 2 0.937161
> 
> Ouch!
> 
> This *surely* is a bug.  How can it be possible to remove the variable
> names in a data frame?

He hasn't removed them, just set them to " ". We allow variable names that
are not valid R names (in fact, we rely on them in model.frame).

	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 15:57:27 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 16:57:27 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>
References: <14977.28086.8858.910911@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.28775.611743.933442@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Yves Gauvreau writes:
>> 
>> > Try this
>> > sampled <- data.frame(sample(rnorm(100),2))
>> > colnames(sampled) <- " " # Or preferably something meaningful
>> > sampled
>> 
>> > 1 1.777068
>> > 2 0.937161
>> 
>> Ouch!
>> 
>> This *surely* is a bug.  How can it be possible to remove the variable
>> names in a data frame?

> He hasn't removed them, just set them to " ". We allow variable names
> that are not valid R names (in fact, we rely on them in model.frame).

Correct.  Let me rephrase the question: how can it be possible to set
the (variable) names in a data frame to something non-unique?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb  7 16:06:03 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Feb 2001 17:06:03 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: Kurt Hornik's message of "Wed, 7 Feb 2001 16:45:58 +0100"
References: <200102071105.LAA08910@achill.nmrc.ucc.ie> <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca> <14977.28086.8858.910911@mithrandir.hornik.net>
Message-ID: <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 	names(sampled) <- " "
> and
> 	dimnames(sampled)[[2]] <- " "
> 
> happily introduce non-unique variable names in the data frame.
> 
> Is the rule that row.names and names must be unique still on?
> 
> Argh ...

Splus 3.4 dispatches on dimnames<-, but not on names<- with the
following curious result:

> d <- data.frame(a=1:3,b=4:6)
> names(d)<-c(" "," ")
> d
      
1 1 4
2 2 5
3 3 6
> dimnames(d)[[1]] <- rep(" ",3)  
Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
Dumped

R dispatches similarly, but doesn't check the dimnames in
dimnames<-.data.frame. It could do so quite easily. Just add 

|| any(duplicated(d[[1]])) || any(duplicated(d[[2]]))

at the appropriate spot. 
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 16:13:29 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 17:13:29 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>
References: <200102071105.LAA08910@achill.nmrc.ucc.ie>
 <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
 <14977.28086.8858.910911@mithrandir.hornik.net>
 <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>
Message-ID: <14977.29737.623121.566627@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> names(sampled) <- " "
>> and
>> dimnames(sampled)[[2]] <- " "
>> 
>> happily introduce non-unique variable names in the data frame.
>> 
>> Is the rule that row.names and names must be unique still on?
>> 
>> Argh ...

> Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> following curious result:

>> d <- data.frame(a=1:3,b=4:6)
>> names(d)<-c(" "," ")
>> d
      
> 1 1 4
> 2 2 5
> 3 3 6
>> dimnames(d)[[1]] <- rep(" ",3)  
> Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> Dumped

> R dispatches similarly, but doesn't check the dimnames in
> dimnames<-.data.frame. It could do so quite easily. Just add 

> || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))

> at the appropriate spot.

Thomas' view about what should be permitted seems to be different.

Also note that the convenience functions for name manipulation such as
variable.names typically do their own little thing and do not go via
dimnames.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 16:00:46 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 08:00:46 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.28775.611743.933442@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> Correct.  Let me rephrase the question: how can it be possible to set
> the (variable) names in a data frame to something non-unique?

1) he didn't: there was only one column
2) we allow duplicated column names
 For example
  a<-data.frame(rnorm(10),rnorm(10)) 
 gives a data frame with two columns having the same name. What do you
think they should be called?  
We discussed this some time ago in the context of offsets in glm(), and
model.offset contains code to handle multiple "(offset)" columns.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 16:23:06 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 08:23:06 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.29737.623121.566627@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Peter Dalgaard BSA writes:
> 
> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> names(sampled) <- " "
> >> and
> >> dimnames(sampled)[[2]] <- " "
> >> 
> >> happily introduce non-unique variable names in the data frame.
> >> 
> >> Is the rule that row.names and names must be unique still on?
> >> 
> >> Argh ...
> 
> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> > following curious result:
> 
> >> d <- data.frame(a=1:3,b=4:6)
> >> names(d)<-c(" "," ")
> >> d
>       
> > 1 1 4
> > 2 2 5
> > 3 3 6
> >> dimnames(d)[[1]] <- rep(" ",3)  
> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> > Dumped
> 
> > R dispatches similarly, but doesn't check the dimnames in
> > dimnames<-.data.frame. It could do so quite easily. Just add 
> 
> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> 
> > at the appropriate spot.
> 
> Thomas' view about what should be permitted seems to be different.

I wouldn't object to making it hard to create duplicated names(), but I
think it would be a bad idea to have data.frame() make up unique names if
it's given non-unique ones.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:20:29 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:20:29 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>
References: <14977.28775.611743.933442@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.33757.452637.165825@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> Correct.  Let me rephrase the question: how can it be possible to set
>> the (variable) names in a data frame to something non-unique?

> 1) he didn't: there was only one column

Maybe I should be more careful when composing my emails :-)

I think I am also concerned about data frames with variable names which
are not syntactically valid, but one can also get that by creating the
data frame with `check.names = FALSE'.

> 2) we allow duplicated column names
>  For example
>   a<-data.frame(rnorm(10),rnorm(10)) 
>  gives a data frame with two columns having the same name. What do you
> think they should be called?  
> We discussed this some time ago in the context of offsets in glm(), and
> model.offset contains code to handle multiple "(offset)" columns.

Hmm, I must have missed that.

My understanding thus far was that I can always rely on unique case and
variable names in a data frame.  I see the potential usefulness in
allowing multiple "(offset)" columns in a model frame ... but wouldn't
that (at least in theory) call for using a different class?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:23:12 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:23:12 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>
References: <14977.29737.623121.566627@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.33920.590610.689408@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Peter Dalgaard BSA writes:
>> 
>> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> names(sampled) <- " "
>> >> and
>> >> dimnames(sampled)[[2]] <- " "
>> >> 
>> >> happily introduce non-unique variable names in the data frame.
>> >> 
>> >> Is the rule that row.names and names must be unique still on?
>> >> 
>> >> Argh ...
>> 
>> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> > following curious result:
>> 
>> >> d <- data.frame(a=1:3,b=4:6)
>> >> names(d)<-c(" "," ")
>> >> d
>> 
>> > 1 1 4
>> > 2 2 5
>> > 3 3 6
>> >> dimnames(d)[[1]] <- rep(" ",3)  
>> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> > Dumped
>> 
>> > R dispatches similarly, but doesn't check the dimnames in
>> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> 
>> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> 
>> > at the appropriate spot.
>> 
>> Thomas' view about what should be permitted seems to be different.

> I wouldn't object to making it hard to create duplicated names(), but
> I think it would be a bad idea to have data.frame() make up unique
> names if it's given non-unique ones.

Maybe `check.names' could also be used for uniqueness testing?

In any case, I think we should specify what *exactly* a data frame is.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 17:33:12 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.33920.590610.689408@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Thomas Lumley writes:
> 
> > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> >>>>> Peter Dalgaard BSA writes:
> >> 
> >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> >> names(sampled) <- " "
> >> >> and
> >> >> dimnames(sampled)[[2]] <- " "
> >> >> 
> >> >> happily introduce non-unique variable names in the data frame.
> >> >> 
> >> >> Is the rule that row.names and names must be unique still on?
> >> >> 
> >> >> Argh ...
> >> 
> >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> >> > following curious result:
> >> 
> >> >> d <- data.frame(a=1:3,b=4:6)
> >> >> names(d)<-c(" "," ")
> >> >> d
> >> 
> >> > 1 1 4
> >> > 2 2 5
> >> > 3 3 6
> >> >> dimnames(d)[[1]] <- rep(" ",3)  
> >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> >> > Dumped
> >> 
> >> > R dispatches similarly, but doesn't check the dimnames in
> >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> >> 
> >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> >> 
> >> > at the appropriate spot.
> >> 
> >> Thomas' view about what should be permitted seems to be different.
> 
> > I wouldn't object to making it hard to create duplicated names(), but
> > I think it would be a bad idea to have data.frame() make up unique
> > names if it's given non-unique ones.
> 
> Maybe `check.names' could also be used for uniqueness testing?
> 
> In any case, I think we should specify what *exactly* a data frame is.
>

I think we should specify, and check.names is a logical way to
allow/forbid non-unique columns.  

Having a new class would be messy: logically it shouldn't inherit from
data.frame, data.frame should inherit from it, but that would be a real
pain to set up.

	-thomas


	

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:36:55 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:36:55 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>
References: <14977.33920.590610.689408@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>
Message-ID: <14977.34743.548005.545365@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Thomas Lumley writes:
>> 
>> > On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >> >>>>> Peter Dalgaard BSA writes:
>> >> 
>> >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> >> names(sampled) <- " "
>> >> >> and
>> >> >> dimnames(sampled)[[2]] <- " "
>> >> >> 
>> >> >> happily introduce non-unique variable names in the data frame.
>> >> >> 
>> >> >> Is the rule that row.names and names must be unique still on?
>> >> >> 
>> >> >> Argh ...
>> >> 
>> >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> >> > following curious result:
>> >> 
>> >> >> d <- data.frame(a=1:3,b=4:6)
>> >> >> names(d)<-c(" "," ")
>> >> >> d
>> >> 
>> >> > 1 1 4
>> >> > 2 2 5
>> >> > 3 3 6
>> >> >> dimnames(d)[[1]] <- rep(" ",3)  
>> >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> >> > Dumped
>> >> 
>> >> > R dispatches similarly, but doesn't check the dimnames in
>> >> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> >> 
>> >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> >> 
>> >> > at the appropriate spot.
>> >> 
>> >> Thomas' view about what should be permitted seems to be different.
>> 
>> > I wouldn't object to making it hard to create duplicated names(), but
>> > I think it would be a bad idea to have data.frame() make up unique
>> > names if it's given non-unique ones.
>> 
>> Maybe `check.names' could also be used for uniqueness testing?
>> 
>> In any case, I think we should specify what *exactly* a data frame is.
>> 

> I think we should specify, and check.names is a logical way to
> allow/forbid non-unique columns.

O.k.  Would the assignment versions of rownames/colnames etc also have
the `check.names' argument for their data frame methods?  Personally I
have no preferences for row/colnames which are, by their naming, more
matrix style.  But I think the ``high-level'' case.names and
variable.names perhaps should ...

> Having a new class would be messy: logically it shouldn't inherit from
> data.frame, data.frame should inherit from it, but that would be a real
> pain to set up.

[Yes, unfortunately.]

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From murdoch@stats.uwo.ca  Wed Feb  7 17:51:12 2001
From: murdoch@stats.uwo.ca (Duncan Murdoch)
Date: Wed, 07 Feb 2001 12:51:12 -0500
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from contour)
Message-ID: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>

I submitted a message to r-help this morning that really belongs in
r-devel; here's its URL in the archive:
<http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.

In summary, I suggest that R graphics objects should be accessible and
modifiable, but it raises some problems if you want to do it without
pointers.

Duncan Murdoch
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Feb  7 18:45:02 2001
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 7 Feb 2001 18:45:02 +0000 (GMT)
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from
 contour)
In-Reply-To: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>
Message-ID: <Pine.GSO.4.31.0102071828220.14134-100000@auk.stats>

On Wed, 7 Feb 2001, Duncan Murdoch wrote:

> I submitted a message to r-help this morning that really belongs in
> r-devel; here's its URL in the archive:
> <http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.
>
> In summary, I suggest that R graphics objects should be accessible and
> modifiable, but it raises some problems if you want to do it without
> pointers.

Duncan,

I saw your post, and Ross's.   As I understand it, in R there is a
separation between computing and drawing, but it is at a higher level than
the original question wanted.  That's not to say I am very sure of this!

Normally, R maintains a display list, that is a list of high-level
description of graphics calls.  The idea is that list can be replayed
to refresh the display as needed (especially if it is resized), but the
idea has been taken further, for example to copy plots by replaying
on another device.  Further, individual plots can be saved and replayed,
first by menus on Guido's Windows display driver, and later from R
functions.

Now, I don't understand the display list in detail, but I know we have had
problems with statefulness.  There is also a lower-level separation, the
set of calls made to the graphics driver, more akin to Windows GDI calls.
One of my motivations for writing a PDF driver (there is one in R-devel
now) was to allow editing of graphical output at object level.
Unfortunately, this is not to be as the graphics driver interface is too
low-level, for plotmath at the level of a single character, for example.

I suspect that the ideal is somewhere in between the display list and the
graphics driver level, and that probably PDF is about right.  Someone in
Apple clearly thinks so given the fuss being made about MacOSX graphics.

I am not sure this helps you much.  It is one example of an issue that is
beginning to come up in several places:  is it better to re-design and
re-implement, or to try to maintain what we have?

On the actual issue of extracting contours, then I think if you
turn labelling off and use a device like XFig, it is quite easy to pull out
the contours as vectors.

Some background thoughts, I hope of some use.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From David James <dj@research.bell-labs.com>  Wed Feb  7 18:50:26 2001
From: David James <dj@research.bell-labs.com> (David James)
Date: Wed, 7 Feb 2001 13:50:26 -0500 (EST)
Subject: [Rd] RE: [R] Removing "row.names"
Message-ID: <200102071850.NAA22791@jessie.research.bell-labs.com>


> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
> From: Thomas Lumley <tlumley@u.washington.edu>
> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
> Subject: Re: [Rd] RE: [R] Removing "row.names"
> MIME-Version: 1.0
> 
> On Wed, 7 Feb 2001, Kurt Hornik wrote:
> 
> > >>>>> Thomas Lumley writes:
> > 
> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> > >> >>>>> Peter Dalgaard BSA writes:
> > >> 
> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> > >> >> names(sampled) <- " "
> > >> >> and
> > >> >> dimnames(sampled)[[2]] <- " "
> > >> >> 
> > >> >> happily introduce non-unique variable names in the data frame.
> > >> >> 
> > >> >> Is the rule that row.names and names must be unique still on?
> > >> >> 
> > >> >> Argh ...
> > >> 
> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> > >> > following curious result:
> > >> 
> > >> >> d <- data.frame(a=1:3,b=4:6)
> > >> >> names(d)<-c(" "," ")
> > >> >> d
> > >> 
> > >> > 1 1 4
> > >> > 2 2 5
> > >> > 3 3 6
> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> > >> > Dumped
> > >> 
> > >> > R dispatches similarly, but doesn't check the dimnames in
> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> > >> 
> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> > >> 
> > >> > at the appropriate spot.
> > >> 
> > >> Thomas' view about what should be permitted seems to be different.
> > 
> > > I wouldn't object to making it hard to create duplicated names(), but
> > > I think it would be a bad idea to have data.frame() make up unique
> > > names if it's given non-unique ones.
> > 
> > Maybe `check.names' could also be used for uniqueness testing?
> > 
> > In any case, I think we should specify what *exactly* a data frame is.
> >
> 
> I think we should specify, and check.names is a logical way to
> allow/forbid non-unique columns.  
> 
> Having a new class would be messy: logically it shouldn't inherit from
> data.frame, data.frame should inherit from it, but that would be a real
> pain to set up.
> 

Data frames were originally meant to be used in modeling functions.
The opening paragraph in Chapter 3 (Data for Models) in the White Book
says:
 
  "This chapter describes the general structure for data that
  will be used throughout the book.  In particular, it introduces the
  data frame, a class of objects to represent the data typically encounterd  
  in fitting models."

However, data.frames may not be quite appropriate for representing
other types of tabular data (certainly a data.frame does not capture
the essence of, say, a "relational" table in the SQL sense, which doesn't
have the concept of row names).  Several manifestations of this problem are 
coercing character data to factors "at the drop of a hat" (as someone wrote 
here or in s-news), the row.names issue now being discussed,  problems 
including general objets in the "cells" of the data.frame, etc.  

I think that the concept of a data.frame to represent data for fitting
models is fine, but we may (certainly I) have abused this concept.  We need 
other classes of tabular data objects in addition (not as a replacement) to 
data.frames, together with coercion methods and perhaps other utilities.


David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Wed Feb  7 20:28:57 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Thu, 8 Feb 2001 09:28:57 +1300
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from contour)
References: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>
Message-ID: <008c01c09144$9b684740$175dd882@stat.auckland.ac.nz>

Hi


----- Original Message -----
From: Duncan Murdoch <murdoch@stats.uwo.ca>
To: <r-devel@stat.math.ethz.ch>
Sent: Thursday, February 08, 2001 6:51 AM
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from
contour)


> I submitted a message to r-help this morning that really belongs in
> r-devel; here's its URL in the archive:
> <http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.
>
> In summary, I suggest that R graphics objects should be accessible and
> modifiable, but it raises some problems if you want to do it without
> pointers.


I have been doing some similar stuff to what you describe (primitives and
groups arranged in hierarchies), but for 2D graphics, and I have used Luke
Tierney's "external pointers" to provide access to graphical objects which
represent the graphical output.  See the R developer page
http://developer.r-project.org/ for Luke's stuff, but please note the
disclaimer at the top of that page.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Feb  8 08:09:54 2001
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Thu, 8 Feb 2001 09:09:54 +0100 (MET)
Subject: [Rd] RE: [R] Re: failed rpm installation of R 1.2-1 (fwd) (PR#841)
Message-ID: <200102080809.JAA13815@pubhealth.ku.dk>

I'm forwarding this to R-bugs.

In R 1.2.1 the file $R_HOME/bin/maketitle.awk is installed as an
executable. It should not be since it is just a set of awk commands,
not a script file that can be run from the shell (This is a change from
R 1.2.0 in which the file $R_HOME/bin/maketitle was a shell script).

This confuses an rpm utility called "find-requires" which scans all
executable files in an effort to determine the dependencies of 
the rpm package.
- binaries are scanned for the dynamic libraries they are linked against
- The heads of script files are scanned to see what language they
  are written in. In this case the first line of maketitle.awk is
  the awk command BEGIN, which is misinterpreted as a dependency for R.

Martyn


On 07-Feb-01 Albrecht Gebhardt wrote:
> On Wed, 7 Feb 2001, Faheem Mitha wrote:
> 
>> Dear Albrecht,
>> 
>> Just sent the following message out to r-help. Have you any idea what this
>> problem could be?
>> 
>>                          Sincerely, Faheem Mitha.
>> 
>> ---------- Forwarded message ----------
>> Date: Wed, 7 Feb 2001 00:04:35 -0500 (EST)
>> From: Faheem Mitha <faheem@email.unc.edu>
>> To: r-help@stat.math.ethz.ch
>> Subject: failed rpm installation of R 1.2-1
>> 
>> Dear People,
>> 
>> Just tried to compile an rpm for R 1.2-1 (using Albrecht Gebhardt's spec
>> file). The compile went successfully and produced a binary rpm, but when I
>> tried to install it, I got an error
>> 
>> error: failed dependencies:
>>         BEGIN is needed by R-base-1.2.1-1
>> 
>> I see this was also listed in the Requires list at the end of the rpm
>> compilation: 
>> 
>> Requires: /bin/sh /usr/bin/perl BEGIN ...
>> 
>> Of course I could force installation of the package, but I would like to
>> know what I am doing first. Albrecht does not say anything about BEGIN in
>> his spec file, so this must be somethin internal to R. Does anyone have
>> any idea what? I have no idea.
>>
> 
> I guess, there is some executable file (a snippet of some script with mode
> 755 or similar) which starts with a line "BEGIN". ....
> 
> Well, I just found it, it is an awk script:
> find -type f -exec grep -l BEGIN {} \;
> ...
> ./bin/maketitle.awk
> 
> Clearly it doesn't need the executable bits so simply add
> 
> chmod 644 $RPM_BUILD_ROOT/%{prefix}/R/bin/maketitle.awk
> 
> to the end of the %install section of my spec file.
> 
> 
> Albrecht

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rbeer@uni-goettingen.de  Thu Feb  8 12:29:07 2001
From: rbeer@uni-goettingen.de (Ragnar Beer)
Date: Thu, 8 Feb 2001 13:29:07 +0100
Subject: [Rd] hollow points bug?
Message-ID: <p04330100b6a8406244a7@[134.76.136.114]>

Howdy!

According to help(points) setting the bg parameter should set the 
background fill color for open plot symbols. But when I tried out 
(R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always 
see through the "O". Is this a bug or am getting something wrong?

Ragnar
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb  8 12:44:45 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 8 Feb 2001 12:44:45 +0000 (GMT)
Subject: [Rd] hollow points bug?
In-Reply-To: <p04330100b6a8406244a7@[134.76.136.114]>
Message-ID: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>

On Thu, 8 Feb 2001, Ragnar Beer wrote:

> Howdy!
>
> According to help(points) setting the bg parameter should set the
> background fill color for open plot symbols. But when I tried out
> (R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always
> see through the "O". Is this a bug or am getting something wrong?

I believe it refers only to pch=21:25, as described about 10 lines
further up.  Certainly pch=1 is the outline of a cicrle, not a filled
circle.  I've made this explicit in the documentation.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rbeer@uni-goettingen.de  Thu Feb  8 13:22:04 2001
From: rbeer@uni-goettingen.de (Ragnar Beer)
Date: Thu, 8 Feb 2001 14:22:04 +0100
Subject: [Rd] hollow points bug?
In-Reply-To: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>
References: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>
Message-ID: <p04330102b6a84cbe1a70@[134.76.136.114]>

Got it. Thanks a lot! Perhaps " (pch=21:25)" could be added to the 
line describing bg to add some redundancy.

Ragnar

>On Thu, 8 Feb 2001, Ragnar Beer wrote:
>
>>  Howdy!
>>
>>  According to help(points) setting the bg parameter should set the
>>  background fill color for open plot symbols. But when I tried out
>>  (R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always
>>  see through the "O". Is this a bug or am getting something wrong?
>
>I believe it refers only to pch=21:25, as described about 10 lines
>further up.  Certainly pch=1 is the outline of a cicrle, not a filled
>circle.  I've made this explicit in the documentation.
>
>--
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272860 (secr)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
>r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
>Send "info", "help", or "[un]subscribe"
>(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
>_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Feb  8 13:41:03 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 8 Feb 2001 14:41:03 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <200102071850.NAA22791@jessie.research.bell-labs.com>
References: <200102071850.NAA22791@jessie.research.bell-labs.com>
Message-ID: <14978.41455.172646.505117@mithrandir.hornik.net>

>>>>> David James writes:

>> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
>> From: Thomas Lumley <tlumley@u.washington.edu>
>> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
>> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
>> Subject: Re: [Rd] RE: [R] Removing "row.names"
>> MIME-Version: 1.0
>> 
>> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> 
>> > >>>>> Thomas Lumley writes:
>> > 
>> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> > >> >>>>> Peter Dalgaard BSA writes:
>> > >> 
>> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> > >> >> names(sampled) <- " "
>> > >> >> and
>> > >> >> dimnames(sampled)[[2]] <- " "
>> > >> >> 
>> > >> >> happily introduce non-unique variable names in the data frame.
>> > >> >> 
>> > >> >> Is the rule that row.names and names must be unique still on?
>> > >> >> 
>> > >> >> Argh ...
>> > >> 
>> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> > >> > following curious result:
>> > >> 
>> > >> >> d <- data.frame(a=1:3,b=4:6)
>> > >> >> names(d)<-c(" "," ")
>> > >> >> d
>> > >> 
>> > >> > 1 1 4
>> > >> > 2 2 5
>> > >> > 3 3 6
>> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
>> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> > >> > Dumped
>> > >> 
>> > >> > R dispatches similarly, but doesn't check the dimnames in
>> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> > >> 
>> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> > >> 
>> > >> > at the appropriate spot.
>> > >> 
>> > >> Thomas' view about what should be permitted seems to be different.
>> > 
>> > > I wouldn't object to making it hard to create duplicated names(), but
>> > > I think it would be a bad idea to have data.frame() make up unique
>> > > names if it's given non-unique ones.
>> > 
>> > Maybe `check.names' could also be used for uniqueness testing?
>> > 
>> > In any case, I think we should specify what *exactly* a data frame is.
>> >
>> 
>> I think we should specify, and check.names is a logical way to
>> allow/forbid non-unique columns.  
>> 
>> Having a new class would be messy: logically it shouldn't inherit from
>> data.frame, data.frame should inherit from it, but that would be a real
>> pain to set up.
>> 

> Data frames were originally meant to be used in modeling functions.
> The opening paragraph in Chapter 3 (Data for Models) in the White Book
> says:
 
>   "This chapter describes the general structure for data that
>   will be used throughout the book.  In particular, it introduces the
>   data frame, a class of objects to represent the data typically encounterd  
>   in fitting models."

> However, data.frames may not be quite appropriate for representing
> other types of tabular data (certainly a data.frame does not capture
> the essence of, say, a "relational" table in the SQL sense, which
> doesn't have the concept of row names).  Several manifestations of
> this problem are coercing character data to factors "at the drop of a
> hat" (as someone wrote here or in s-news), the row.names issue now
> being discussed, problems including general objets in the "cells" of
> the data.frame, etc.

> I think that the concept of a data.frame to represent data for fitting
> models is fine, but we may (certainly I) have abused this concept.  We
> need other classes of tabular data objects in addition (not as a
> replacement) to data.frames, together with coercion methods and
> perhaps other utilities.

Thomas had said that yes it would be nice to have something with less
restrictions for modeling, but that it was uneconomical at least to
introduce a new class that data.frame would then inherit from.

I interpret your comment as suggesting that we introduce a new class for
holding tabular data?  Do you have specific ideas on this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Diego@kuonen.com  Thu Feb  8 19:01:46 2001
From: Diego@kuonen.com (Diego Kuonen)
Date: Thu, 08 Feb 2001 20:01:46 +0100
Subject: [Rd] What is R?
Message-ID: <3A82ED1A.E2505E42@Kuonen.com>

Dear all

there's something. that puzzles me about what R is :-)

   "R is available as Free Software under the terms of the Free 
    Software Foundation's GNU General Public License in source 
    code form."

(Source: http://www.r-project.org/about.html)

But, looking at the second paragraph of the same site, you
see this:

   "... and R provides an Open Source route to participation in
    that activity."

As we all know the term "open source" means something close 
(but not identical) to "free software". 

So, what is R?

It clearly seems to be "free software" and not only "open source" 
software, or?


Finally, Let's have a look at the following:

   "... This article describes why using the term ``open source'' does 
    not solve any problems, and in fact creates some. These are the reasons 
    why it is better to stick with ``free software.'' ... "

(Source: http://www.gnu.org/philosophy/free-software-for-freedom.html )


I'm puzzled, are you?


Greets

  Diego


P.S.: What about "Omegahat"?


-- 
Diego Kuonen $\in$ Chairs of Statistics $\subset$ DMA \@ EPFL
http://stat.kuonen.com                  http://www.Statoo.com 
Q: How do I type "for i in *.dvi; do xdvi $i; done" in a GUI?  
/*      panic("esp: Aiee penguin on the SCSI-bus.");       */
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Thu Feb  8 19:44:20 2001
From: tlumley@u.washington.edu (tlumley@u.washington.edu)
Date: Thu, 8 Feb 2001 20:44:20 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102081944.UAA23120@pubhealth.ku.dk>


This came up on r-help but indicates a bug.

dnbinom(x,n,p) calls dbinom_raw(n-1,...)
which returns 0 for n<1.

	-thomas


---------- Forwarded message ----------
Date: Thu, 08 Feb 2001 17:10:23 +0000
From: Yudi Pawitan <yudi@stat.ucc.ie>
To: Mark Myatt <mark@myatt.demon.co.uk>
Cc: R-Help <r-help@stat.math.ethz.ch>
Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

Sorry, Mark, the program worked for Rw1011, but this is
what happened in Rw1021:

> dnbinom(0:5,.9,.4)  
[1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

while, the correct result from Rw1011 is:
>  dnbinom(0:5,.9,.4)
[1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

I have added a corrected dnbinom() below, which makes the program
works  for Rw1021.

-YP-

x_ c(70, 38, 17, 10,  9, 6) 
kk_ 0:5
n_ sum(x)

dnbinom_ function(x,n,p){
         gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
}

fn_ function(p){
    r_ p[1]
    th_ p[2]
    ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
          x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    return(ll)
}

a_ nlm(fn,p=c(.9,.5),hes=T)
est_ a$est

phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
        1-pnbinom((max(kk)-1),est[1],est[2]))
E_ n*phat
chi2_ sum((x-E)^2/E)
cat('Chi2 goodness-of-fit = ',chi2,'\n')
cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


===========================================
At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
>Yudi,
>
>Thanks for this:
>
>>x_ c(70, 38, 17, 10,  9, 6) 
>>kk_ 0:5
>>n_ sum(x)
>>
>>fn_ function(p){
>>    r_ p[1]
>>    th_ p[2]
>>    ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
>>          x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
>>    return(ll)
>>}
>>
>>a_ nlm(fn,p=c(.9,.5),hes=T)
>>est_ a$est
>>
>>phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
>>        1-pnbinom((max(kk)-1),est[1],est[2]))
>>E_ n*phat
>>chi2_ sum((x-E)^2/E)
>>cat('Chi2 goodness-of-fit = ',chi2,'\n')
>>cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
>>
>>print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
>
>It is certainly more elegant than anything I would have come up with but
>I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
>
>        Warning messages: 
>        1: NA/Inf replaced by maximum positive value 
>        2: NA/Inf replaced by maximum positive value 
>        3: NA/Inf replaced by maximum positive value 
>        4: NA/Inf replaced by maximum positive value 
>        5: NA/Inf replaced by maximum positive value 
>        6: NA/Inf replaced by maximum positive value 
>        7: NA/Inf replaced by maximum positive value 
>        8: NA/Inf replaced by maximum positive value 
>
>est holds the starting parameters:
>
>        [1] 0.9 0.5
>
>E (from n*phat) holds:
>
>        [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
>
>which gives a very big chi-square.
>
>Sorry to be a nuisance.
>
>Mark
>
>
>--
>Mark Myatt
>
>
>
Yudi Pawitan     yudi@stat.ucc.ie
Department of Statistics UCC
Cork, Ireland
Ph   353-21-490 2906
Fax 353-21-427 1040 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Thu Feb  8 19:17:20 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Thu, 8 Feb 2001 11:17:20 -0800 (PST)
Subject: [Rd] Re: [R] What is R?
In-Reply-To: <3A82ED1A.E2505E42@Kuonen.com>
Message-ID: <Pine.A41.4.21.0102081105420.191392-100000@homer40.u.washington.edu>

On Thu, 8 Feb 2001, Diego Kuonen wrote:

> Dear all
> 
> there's something. that puzzles me about what R is :-)
> 
>    "R is available as Free Software under the terms of the Free 
>     Software Foundation's GNU General Public License in source 
>     code form."
> 
> (Source: http://www.r-project.org/about.html)
> 
> But, looking at the second paragraph of the same site, you
> see this:
> 
>    "... and R provides an Open Source route to participation in
>     that activity."
> 
> As we all know the term "open source" means something close 
> (but not identical) to "free software". 
> 
> So, what is R?
> 
> It clearly seems to be "free software" and not only "open source" 
> software, or?


R is Open Source software in that it's license complies with the OSI
definition. It is "free software" by the Debian and Free Software
Foundation definitions, and is official GNU software.  No problems
here. 

As Richard Stallman and Eric Raymond (among others) have pointed out,
the difference between these concepts is one of philosophical and
marketing emphasis. The R developers, as far as I know, have no unified
view on "open source" vs "free", nor do they need one. 


	-thomas


Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Feb  9 07:59:01 2001
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 9 Feb 2001 08:59:01 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102090759.IAA25635@pubhealth.ku.dk>

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu> writes:

    TL> This came up on r-help but indicates a bug.

    TL> dnbinom(x,n,p) calls dbinom_raw(n-1,...)
    TL> which returns 0 for n<1.

Actually for all  non-integer n.

This is now fixed for "R-release" aka "R-patched" aka "R 1.2.2 to be" :

--- src/nmath/dnbinom.c.~6~	Wed Jan 24 18:02:07 2001
+++ src/nmath/dnbinom.c	Fri Feb  9 08:37:14 2001
@@ -47,6 +47,12 @@
     if (x < 0 || !R_FINITE(x)) return R_D__0;
     x = R_D_forceint(x);
 
+    if(R_D_nonint(n)) {
+	return R_D_exp(lfastchoose(x + n - 1, x)
+		       + n * log(p) + x * log(1 - p));
+    } 
+    else { /* n is integer */
     prob = dbinom_raw(n-1,n+x-1,p,1-p,give_log);
     return((give_log) ? log(p) + prob : p*prob);
+    }
 }


Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><


    TL> ---------- Forwarded message ----------
    TL> Date: Thu, 08 Feb 2001 17:10:23 +0000
    TL> From: Yudi Pawitan <yudi@stat.ucc.ie>
    TL> To: Mark Myatt <mark@myatt.demon.co.uk>
    TL> Cc: R-Help <r-help@stat.math.ethz.ch>
    TL> Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

    TL> Sorry, Mark, the program worked for Rw1011, but this is
    TL> what happened in Rw1021:

    >> dnbinom(0:5,.9,.4)  
    TL> [1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

    TL> while, the correct result from Rw1011 is:
    >> dnbinom(0:5,.9,.4)
    TL> [1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

    TL> I have added a corrected dnbinom() below, which makes the program
    TL> works  for Rw1021.

    TL> -YP-

    TL> x_ c(70, 38, 17, 10,  9, 6) 
    TL> kk_ 0:5
    TL> n_ sum(x)

    TL> dnbinom_ function(x,n,p){
    TL> gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
    TL> }

    TL> fn_ function(p){
    TL> r_ p[1]
    TL> th_ p[2]
    TL> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    TL> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    TL> return(ll)
    TL> }

    TL> a_ nlm(fn,p=c(.9,.5),hes=T)
    TL> est_ a$est

    TL> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    TL> 1-pnbinom((max(kk)-1),est[1],est[2]))
    TL> E_ n*phat
    TL> chi2_ sum((x-E)^2/E)
    TL> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    TL> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

    TL> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


    TL> ===========================================
    TL> At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
    >> Yudi,
    >> 
    >> Thanks for this:
    >> 
    >>> x_ c(70, 38, 17, 10,  9, 6) 
    >>> kk_ 0:5
    >>> n_ sum(x)
    >>> 
    >>> fn_ function(p){
    >>> r_ p[1]
    >>> th_ p[2]
    >>> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    >>> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    >>> return(ll)
    >>> }
    >>> 
    >>> a_ nlm(fn,p=c(.9,.5),hes=T)
    >>> est_ a$est
    >>> 
    >>> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    >>> 1-pnbinom((max(kk)-1),est[1],est[2]))
    >>> E_ n*phat
    >>> chi2_ sum((x-E)^2/E)
    >>> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    >>> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
    >>> 
    >>> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
    >> 
    >> It is certainly more elegant than anything I would have come up with but
    >> I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
    >> 
    >> Warning messages: 
    >> 1: NA/Inf replaced by maximum positive value 
    >> 2: NA/Inf replaced by maximum positive value 
    >> 3: NA/Inf replaced by maximum positive value 
    >> 4: NA/Inf replaced by maximum positive value 
    >> 5: NA/Inf replaced by maximum positive value 
    >> 6: NA/Inf replaced by maximum positive value 
    >> 7: NA/Inf replaced by maximum positive value 
    >> 8: NA/Inf replaced by maximum positive value 
    >> 
    >> est holds the starting parameters:
    >> 
    >> [1] 0.9 0.5
    >> 
    >> E (from n*phat) holds:
    >> 
    >> [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
    >> 
    >> which gives a very big chi-square.
    >> 
    >> Sorry to be a nuisance.
    >> 
    >> Mark
    >> 
    >> 
    >> --
    >> Mark Myatt
    >> 
    >> 
    >> 
    TL> Yudi Pawitan     yudi@stat.ucc.ie
    TL> Department of Statistics UCC
    TL> Cork, Ireland
    TL> Ph   353-21-490 2906
    TL> Fax 353-21-427 1040 
    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Feb  9 08:08:58 2001
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 9 Feb 2001 09:08:58 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102090808.JAA25876@pubhealth.ku.dk>

       
>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu> writes:
    TL> This came up on r-help but indicates a bug.

    TL> dnbinom(x,n,p) calls dbinom_raw(n-1,...)
    TL> which returns 0 for n<1.

  MM> Actually for all  non-integer n.

wrong, Martin!

Thomas was right:  
       dbinom_raw(m, *)		
       seems fine for non-negative non-integers m.

    MM> This is now fixed for "R-release" aka "R-patched" aka "R 1.2.2 to be" :

    MM> --- src/nmath/dnbinom.c.~6~	Wed Jan 24 18:02:07 2001
    MM> +++ src/nmath/dnbinom.c	Fri Feb  9 08:37:14 2001
    MM> @@ -47,6 +47,12 @@
    MM> if (x < 0 || !R_FINITE(x)) return R_D__0;
    MM> x = R_D_forceint(x);
 
    MM> +    if(R_D_nonint(n)) {
    MM> +	return R_D_exp(lfastchoose(x + n - 1, x)
    MM> +		       + n * log(p) + x * log(1 - p));
    MM> +    } 
    MM> +    else { /* n is integer */
    MM> prob = dbinom_raw(n-1,n+x-1,p,1-p,give_log);
    MM> return((give_log) ? log(p) + prob : p*prob);
    MM> +    }
    MM> }

The above fix reverts to pre R 1.2.0 behaviour 
for non-integer `n' (in C; `size' in R) which is `first order ok',
but far from optimal.

The real solution must be better,
and should be done along the code (see comments!) in dbeta.c.

I won't have time to look at this for the next time though.

    MM> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
    MM> Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
    MM> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
    MM> phone: x-41-1-632-3408		fax: ...-1228			<><


    TL> ---------- Forwarded message ----------
    TL> Date: Thu, 08 Feb 2001 17:10:23 +0000
    TL> From: Yudi Pawitan <yudi@stat.ucc.ie>
    TL> To: Mark Myatt <mark@myatt.demon.co.uk>
    TL> Cc: R-Help <r-help@stat.math.ethz.ch>
    TL> Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

    TL> Sorry, Mark, the program worked for Rw1011, but this is
    TL> what happened in Rw1021:

    >>> dnbinom(0:5,.9,.4)  
    TL> [1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

    TL> while, the correct result from Rw1011 is:
    >>> dnbinom(0:5,.9,.4)
    TL> [1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

    TL> I have added a corrected dnbinom() below, which makes the program
    TL> works  for Rw1021.

    TL> -YP-

    TL> x_ c(70, 38, 17, 10,  9, 6) 
    TL> kk_ 0:5
    TL> n_ sum(x)

    TL> dnbinom_ function(x,n,p){
    TL> gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
    TL> }

    TL> fn_ function(p){
    TL> r_ p[1]
    TL> th_ p[2]
    TL> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    TL> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    TL> return(ll)
    TL> }

    TL> a_ nlm(fn,p=c(.9,.5),hes=T)
    TL> est_ a$est

    TL> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    TL> 1-pnbinom((max(kk)-1),est[1],est[2]))
    TL> E_ n*phat
    TL> chi2_ sum((x-E)^2/E)
    TL> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    TL> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

    TL> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


    TL> ===========================================
    TL> At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
    >>> Yudi,
    >>> 
    >>> Thanks for this:
    >>> 
    >>>> x_ c(70, 38, 17, 10,  9, 6) 
    >>>> kk_ 0:5
    >>>> n_ sum(x)
    >>>> 
    >>>> fn_ function(p){
    >>>> r_ p[1]
    >>>> th_ p[2]
    >>>> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    >>>> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    >>>> return(ll)
    >>>> }
    >>>> 
    >>>> a_ nlm(fn,p=c(.9,.5),hes=T)
    >>>> est_ a$est
    >>>> 
    >>>> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    >>>> 1-pnbinom((max(kk)-1),est[1],est[2]))
    >>>> E_ n*phat
    >>>> chi2_ sum((x-E)^2/E)
    >>>> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    >>>> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
    >>>> 
    >>>> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
    >>> 
    >>> It is certainly more elegant than anything I would have come up with but
    >>> I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
    >>> 
    >>> Warning messages: 
    >>> 1: NA/Inf replaced by maximum positive value 
    >>> 2: NA/Inf replaced by maximum positive value 
    >>> 3: NA/Inf replaced by maximum positive value 
    >>> 4: NA/Inf replaced by maximum positive value 
    >>> 5: NA/Inf replaced by maximum positive value 
    >>> 6: NA/Inf replaced by maximum positive value 
    >>> 7: NA/Inf replaced by maximum positive value 
    >>> 8: NA/Inf replaced by maximum positive value 
    >>> 
    >>> est holds the starting parameters:
    >>> 
    >>> [1] 0.9 0.5
    >>> 
    >>> E (from n*phat) holds:
    >>> 
    >>> [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
    >>> 
    >>> which gives a very big chi-square.
    >>> 
    >>> Sorry to be a nuisance.
    >>> 
    >>> Mark
    >>> 
    >>> 
    >>> --
    >>> Mark Myatt
    >>> 
    >>> 
    >>> 
    TL> Yudi Pawitan     yudi@stat.ucc.ie
    TL> Department of Statistics UCC
    TL> Cork, Ireland
    TL> Ph   353-21-490 2906
    TL> Fax 353-21-427 1040 
    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

    MM> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    MM> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    MM> Send "info", "help", or "[un]subscribe"
    MM> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    MM> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Fri Feb  9 13:20:08 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Fri, 09 Feb 2001 14:20:08 +0100
Subject: [Rd] system command
Message-ID: <3A83EE88.67F639ED@univie.ac.at>

i am using
system
to call the external program csound.
csound does some output to stdout and some to stderr
system handles this differently on the different platforms.

on unix (i have solaris, but as far as i know it is the same on linux)
system("csound",intern=TRUE) redirects stdin into an R object, 
by still outputs stdout to the R window.
system("csound",intern=FALSE) (equivalent to system("csound"))
stdout and stderr go into the R window

Rterm
on win95
system("csound",intern=TRUE) redirects stdin and stderr into an R object
system("csound",intern=FALSE) (equivalent to system("csound"))
outputs everything

Rterm
on win2k
system("csound",intern=TRUE) redirects stdin and stderr into an R object
system("csound",intern=FALSE) (equivalent to system("csound"))
outputs everything
EXCEPT
once 
system("csound",intern=TRUE) has been done
and later one tries
system("csound",intern=FALSE)
stderr is lost completely.
going back to
system("csound",intern=TRUE)
redirects stderr again into the R object,
but stderr does not go to the screen any more
after intern=TRUE has been used once.


so we seem to have to problems:
1) different behavior of system on unix and win32k
2) problems with system and redirection on win32k.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Feb  9 14:28:58 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 9 Feb 2001 14:28:58 +0000 (GMT)
Subject: [Rd] system command
In-Reply-To: <3A83EE88.67F639ED@univie.ac.at>
Message-ID: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>

On Fri, 9 Feb 2001, Erich Neuwirth wrote:

> i am using
> system
> to call the external program csound.
> csound does some output to stdout and some to stderr
> system handles this differently on the different platforms.
>
> on unix (i have solaris, but as far as i know it is the same on linux)
> system("csound",intern=TRUE) redirects stdin into an R object,
> by still outputs stdout to the R window.

I *think* you mean redirect stdout, and sends stderr to the terminal
running R.

> system("csound",intern=FALSE) (equivalent to system("csound"))
> stdout and stderr go into the R window
>
> Rterm
> on win95
> system("csound",intern=TRUE) redirects stdin and stderr into an R object

Redirects stdout and stderr to the terminal running R?

> system("csound",intern=FALSE) (equivalent to system("csound"))
> outputs everything
>
> Rterm
> on win2k
> system("csound",intern=TRUE) redirects stdin and stderr into an R object
> system("csound",intern=FALSE) (equivalent to system("csound"))
> outputs everything
> EXCEPT
> once
> system("csound",intern=TRUE) has been done
> and later one tries
> system("csound",intern=FALSE)
> stderr is lost completely.
> going back to
> system("csound",intern=TRUE)
> redirects stderr again into the R object,
> but stderr does not go to the screen any more
> after intern=TRUE has been used once.
>
>
> so we seem to have to problems:
> 1) different behavior of system on unix and win32k

They are documented to be different!  Whether stdout and stderr are
different is OS-specific.  In particular, Windows consoles have no concept
of stdout.

> 2) problems with system and redirection on win32k.

A bug, almost certainly in Windows 2000 since this works as documented
under NT.   Guido?

But, the essence is that you cannot reasonably expect to use stderr from
a program run by a system() commands, and that applies to, say, Perl
as much as to R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Fri Feb  9 14:38:17 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Fri, 09 Feb 2001 15:38:17 +0100
Subject: [Rd] system command
References: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>
Message-ID: <3A8400D9.F1AB4A14@univie.ac.at>

you are right,
i was using stdin in places where i meant stdout.
stupido.
logically, just do a global replace stdin->stdout in my last message.

currently i am trying to convince the maintainer of csound to add a
command line switch
which switches of stderr output completely.

and i understand theat the unix version and the windows version are
different.
but it still makes sense that they behave as similar as possible
whenever possible.

the whole thing is caused by the fact that the current version of csound
writes to stderr in any case.

and system on unix puts the stderr output in the r console window
in any case. that is what surprises me.
alternatively, system could ignore stderr,
or have an option for ingoring stderr.



Prof Brian Ripley wrote:
> 
> On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> 
> > i am using
> > system
> > to call the external program csound.
> > csound does some output to stdout and some to stderr
> > system handles this differently on the different platforms.
> >
> > on unix (i have solaris, but as far as i know it is the same on linux)
> > system("csound",intern=TRUE) redirects stdin into an R object,
> > by still outputs stdout to the R window.
> 
> I *think* you mean redirect stdout, and sends stderr to the terminal
> running R.
> 
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > stdout and stderr go into the R window
> >
> > Rterm
> > on win95
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> 
> Redirects stdout and stderr to the terminal running R?
> 
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> >
> > Rterm
> > on win2k
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> > EXCEPT
> > once
> > system("csound",intern=TRUE) has been done
> > and later one tries
> > system("csound",intern=FALSE)
> > stderr is lost completely.
> > going back to
> > system("csound",intern=TRUE)
> > redirects stderr again into the R object,
> > but stderr does not go to the screen any more
> > after intern=TRUE has been used once.
> >
> >
> > so we seem to have to problems:
> > 1) different behavior of system on unix and win32k
> 
> They are documented to be different!  Whether stdout and stderr are
> different is OS-specific.  In particular, Windows consoles have no concept
> of stdout.
> 
> > 2) problems with system and redirection on win32k.
> 
> A bug, almost certainly in Windows 2000 since this works as documented
> under NT.   Guido?
> 
> But, the essence is that you cannot reasonably expect to use stderr from
> a program run by a system() commands, and that applies to, say, Perl
> as much as to R.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bwheeler@echip.com  Fri Feb  9 17:36:45 2001
From: bwheeler@echip.com (bwheeler@echip.com)
Date: Fri, 9 Feb 2001 18:36:45 +0100 (MET)
Subject: [Rd] Minor doc bug (PR#843)
Message-ID: <200102091736.SAA07613@pubhealth.ku.dk>

In the doc for split, the factor g is unordered,
so the illustrative code

x <- rnorm(n * nn) + sqrt(codes(g))

should be

x <- rnorm(n * nn) + sqrt(as.numeric(g))


-- 
Bob Wheeler --- (Reply to: bwheeler@echip.com)
        ECHIP, Inc. --- (302) 239-6620, voice and
FAX
           724 Yorklyn Rd., Hockessin, DE 19707
              Randomness comes in bunches

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From David James <dj@research.bell-labs.com>  Fri Feb  9 18:24:50 2001
From: David James <dj@research.bell-labs.com> (David James)
Date: Fri, 9 Feb 2001 13:24:50 -0500 (EST)
Subject: [Rd] tabular data (was RE: [R] Removing "row.names")
Message-ID: <200102091824.NAA03028@jessie.research.bell-labs.com>

Hi,

I agree that replacing data.frames for modeling functions would 
be too painful.  Also I agree with Thomas that new class(es) for 
tabular data should not inherit from data.frame, and that data.frames 
should conceptually inherit from some other base tabular data class.  

At this point I'm not suggesting anything in concrete --- I haven't 
sorted it out in my own mind --- but I want to point out that (1) we
already have several tabular data clasess (not one), including matrices,
arrays, contingency tables, data.frames, etc.;  and that (2) I feel we'll 
need to address some of the problems we get into when we use data.frames 
inappropriately due to lack of other/better data structures. But I 
don't think that one single class can truthfully and completely represent 
all "tabular data".

For instance, interfaces to XML, spreadsheets, DBMS, etc., will further 
expose some of the limitations of these existing objects.  
Tables holding data from relational DBMS are an easy case: this class 
should preserve the original data as much as possible, i.e., no coercing 
into factors, no changing column names, no row names, but otherwise 
very similar to data.frames.  (Timothy Keitt has a more interesting concept 
of "proxyTables" that presents some very interesting issues: should 
proxyTables, which "point" to remote relations in dbms, allow integer 
indexing? --- the relational database model does not support it)

Is there something common to all these objects?  Obviously they all 
support indexing x[i,j, ...] plus the methods dim() and (possibly
NULL) dimnames().  S4 defines vectors as a (virtual) class in 
terms of the indexing operation in exactly this way -- thus in S4 lists 
are vectors, and so are logicals, characters, etc.  We may be able to
group the various "tabular data" classes under such virtual class,
and provide simple coercion facilities so that users can easily
fit, say, a linear model to data coming as an XML document or
in a table stored in a dbms.

David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636
----------------------------------------------------------------------------
> From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> MIME-Version: 1.0
> Content-Transfer-Encoding: 7bit
> Date: Thu, 8 Feb 2001 14:41:03 +0100
> To: David James <dj@research.bell-labs.com>
> Cc: Kurt.Hornik@ci.tuwien.ac.at, tlumley@u.washington.edu, 
p.dalgaard@biostat.ku.dk, R-devel@r-project.org
> Subject: Re: [Rd] RE: [R] Removing "row.names"
> 
> >>>>> David James writes:
> 
> >> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
> >> From: Thomas Lumley <tlumley@u.washington.edu>
> >> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> >> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
> >> Subject: Re: [Rd] RE: [R] Removing "row.names"
> >> MIME-Version: 1.0
> >> 
> >> On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> 
> >> > >>>>> Thomas Lumley writes:
> >> > 
> >> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> > >> >>>>> Peter Dalgaard BSA writes:
> >> > >> 
> >> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> > >> >> names(sampled) <- " "
> >> > >> >> and
> >> > >> >> dimnames(sampled)[[2]] <- " "
> >> > >> >> 
> >> > >> >> happily introduce non-unique variable names in the data frame.
> >> > >> >> 
> >> > >> >> Is the rule that row.names and names must be unique still on?
> >> > >> >> 
> >> > >> >> Argh ...
> >> > >> 
> >> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> >> > >> > following curious result:
> >> > >> 
> >> > >> >> d <- data.frame(a=1:3,b=4:6)
> >> > >> >> names(d)<-c(" "," ")
> >> > >> >> d
> >> > >> 
> >> > >> > 1 1 4
> >> > >> > 2 2 5
> >> > >> > 3 3 6
> >> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
> >> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be 
unique
> >> > >> > Dumped
> >> > >> 
> >> > >> > R dispatches similarly, but doesn't check the dimnames in
> >> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> >> > >> 
> >> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> >> > >> 
> >> > >> > at the appropriate spot.
> >> > >> 
> >> > >> Thomas' view about what should be permitted seems to be different.
> >> > 
> >> > > I wouldn't object to making it hard to create duplicated names(), but
> >> > > I think it would be a bad idea to have data.frame() make up unique
> >> > > names if it's given non-unique ones.
> >> > 
> >> > Maybe `check.names' could also be used for uniqueness testing?
> >> > 
> >> > In any case, I think we should specify what *exactly* a data frame is.
> >> >
> >> 
> >> I think we should specify, and check.names is a logical way to
> >> allow/forbid non-unique columns.  
> >> 
> >> Having a new class would be messy: logically it shouldn't inherit from
> >> data.frame, data.frame should inherit from it, but that would be a real
> >> pain to set up.
> >> 
> 
> > Data frames were originally meant to be used in modeling functions.
> > The opening paragraph in Chapter 3 (Data for Models) in the White Book
> > says:
>  
> >   "This chapter describes the general structure for data that
> >   will be used throughout the book.  In particular, it introduces the
> >   data frame, a class of objects to represent the data typically encounterd  
> >   in fitting models."
> 
> > However, data.frames may not be quite appropriate for representing
> > other types of tabular data (certainly a data.frame does not capture
> > the essence of, say, a "relational" table in the SQL sense, which
> > doesn't have the concept of row names).  Several manifestations of
> > this problem are coercing character data to factors "at the drop of a
> > hat" (as someone wrote here or in s-news), the row.names issue now
> > being discussed, problems including general objets in the "cells" of
> > the data.frame, etc.
> 
> > I think that the concept of a data.frame to represent data for fitting
> > models is fine, but we may (certainly I) have abused this concept.  We
> > need other classes of tabular data objects in addition (not as a
> > replacement) to data.frames, together with coercion methods and
> > perhaps other utilities.
> 
> Thomas had said that yes it would be nice to have something with less
> restrictions for modeling, but that it was uneconomical at least to
> introduce a new class that data.frame would then inherit from.
> 
> I interpret your comment as suggesting that we introduce a new class for
> holding tabular data?  Do you have specific ideas on this?
> 
> -k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Feb  9 21:05:44 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 09 Feb 2001 16:05:44 -0500
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Peter Dalgaard BSA's message of "03 Feb 2001 21:05:06 +0100"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>
 <x2n1c3353h.fsf@blueberry.kubism.ku.dk>
Message-ID: <px1yt7efdj.fsf@infiniti.ece.cmu.edu>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Thomas Vogels <tov@ece.cmu.edu> writes:
> 
> > Hi,
> > 
> > I've been playing with the tcltk package.  It's very nice to have
> > access to buttons, menus etc. now.  Thank you!
> > 
> > Alas, I also have questions: In Tcl everything is a string [*].  This
> > is not the case in R, of course.  So why are return values of tk
> > commands still strings?  (Is there any other reason than speed or
> > "package is work in progress"?)
> 
> The latter. Also to some extent the fact that it requires more
> knowledge about the content of the return value. The argument passing
> scheme is as you can see quite general and essentially ignorant of the
> routines that are called. In essence the issue is that it is fairly
> easy to convert whatever to strings, but harder the other way around.
> So for the first iteration of the package, the idea would be to have
> the user do the necessary as.xxx conversions of return values.

Requiring the user to do the "type casting" will make the user's code
larger and will make it harder to adopt the package.  It would be nice
if the information would "flow more easily" to the programmer.  I
don't want to have to use more as.whatever than I have to in other
functions.

> > One problem is that the number of functions just explodes, so it might
> > be better to wrap them into one enchillada?
> > 
> >   >  tkwinfo <- function (widget, what="exists", ...) 
> >      switch (what,
> >              exists=tkcmd("winfo", "exists", widget)=="1",
> >              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
> >              width=as.numeric (tkcmd("winfo", "width", widget)),
> >              height=as.numeric (tkcmd("winfo", "height", widget)),
> >              tkcmd ("winfo", what, widget, ...))
> > 
> > (The other problem is that tkcmd("winfo",...) may fail.)

OK, instead of going for enchilladas, how about burritos:

For a graphics device, I would use
  > par("xaxp")  # to obtain values
  [1]  2 10  4
  > par (xaxp=c(2,10,4))  # to set values

Wouldn't something similar to this effect simplify the api and reduce
the number of commands in the package (vastly)?

1) Why not

  > tt<-tktoplevel()
  > button <- tkbutton(tt, text="Push", command=function()cat("Ouch\n"))
  > tkpar (button, c("text", "command"))
  $text
  [1]  "Push"

  $command
  [1] " R_call 0xbfeb1c "

  > tkpar (button, text="Yow!", command=function()cat("Yow\n"))

instead of:

  > tkcget (button, "-text")  # (hmm, shouldn't need '-' here!)
  [1] "b"
  > tkcget (button, "-command")  # (again, why '-command'?)
  [1] " R_call 0xbfeb1c "
  > tkconfigure (button, text="Yow!", command=function()cat("Yow\n"))
  [1] ""
  > # Doesn't return previous value...

This examples applies to a bunch of command pairs, like
cget/configure, itemcget/itemconfigure, imagecget/imageconfigure,
entrycget/entryconfigure, window.cget/window.configure, ...

2) Why not:

  > tt <- tktoplevel()
  > tkwm (tt, "minwidth")  # returns integers not strings
  [1] 1 1
  > tkwm (tt, minwidth=c(100,100))  # sets new values

instead of:

  > tkwm.minsize (tt)
  [1] "1 1"
  > tkwm.minsize (tt, "100","100")
  [1] ""

The second example would wipe out 25 or so tkwm.* commands to be
replaced by one tkwm.  (Same would apply for tkwinfo...)  Wouldn't
that also simplify maintenance and documentation?

Does this make sense?  Or does it sound like I've been smoking my corn
flakes instead of eating them?  Is anybody else using the package
tcltk and would it make sense to put some code behind those
suggestions?

Thanks,
  -tom


> > Oh, while I'm at it:  There is no tkupdate:
> >   >  tkupdate <- function (idletasks=FALSE)
> >      if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")
> > 
> > (which is essential to making sure that a window is mapped before its
> > width or height is queried.)  That's trivial if you have hacked Tcl/Tk
> > before -- so who is the package tlctk aimed at?
> 
> Tcl/Tk hackers of course, the author of the package not being one...
> 
> Basically, the plan is to add stuff as it becomes necessary to do
> useful things, so feedback and suggestions from developers are always
> welcome.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pperkins@ucsd.edu  Fri Feb  9 22:04:43 2001
From: pperkins@ucsd.edu (pperkins@ucsd.edu)
Date: Fri, 9 Feb 2001 23:04:43 +0100 (MET)
Subject: [Rd] default data= arg to glm() (PR#844)
Message-ID: <200102092204.XAA08400@pubhealth.ku.dk>

Full_Name: Peter Perkins
Version: 1.2.1
OS: LinuxPPC
Submission from: (NULL) (24.4.89.36)


the lines

   if (missing(data)) 
      data <- environment(formula)

in glm() seem to contradict the documentaton:

   data: an optional data frame containing the variables in the model.
         By default the variables are taken from the environment from
         which `glm' is called.

actually, the near lack of other references to "data" is glm() is not
clear to me, so i may have this wrong.  but a small test seems to bear
out the problem:

function () 
{
	form <- y ~ x
	fun1 <- function(f)
	{
		n <- 10
		x <- runif(n, 1, 10)
		y <- rpois(n, x)
		glm(f, family=poisson(link="log"), data=environment())
	}
	fun2 <- function(f)
	{
		n <- 10
		x <- runif(n, 1, 10)
		y <- rpois(n, x)
		glm(f, family=poisson(link="log"))
	}
	print("fit1")
	print(fun1(form)$call)
	print("fit2")
	print(fun2(form)$call)
}

> test()
[1] "fit1"
glm(formula = f, family = poisson(link = "log"), data = environment())
[1] "fit2"
Error in eval(expr, envir, enclos) : Object "y" not found


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb  9 22:57:19 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Fri, 9 Feb 2001 14:57:19 -0800 (PST)
Subject: [Rd] default data= arg to glm() (PR#844)
In-Reply-To: <200102092204.XAA08400@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0102091417100.82220-100000@homer27.u.washington.edu>

On Fri, 9 Feb 2001 pperkins@ucsd.edu wrote:
> 
> the lines
> 
>    if (missing(data)) 
>       data <- environment(formula)
> 
> in glm() seem to contradict the documentaton:
> 
>    data: an optional data frame containing the variables in the model.
>          By default the variables are taken from the environment from
>          which `glm' is called.
> 
> actually, the near lack of other references to "data" is glm() is not
> clear to me, so i may have this wrong.  but a small test seems to bear
> out the problem:

The documentation is slightly out of date.  The current behaviour is that
the variables are taken from the environment in which the model formula is
defined. This will usually, but not always, be the same thing. This
behaviour is new in 1.2.0, and is designed to give functions like
predict() and update() a fighting chance.

However, the line you quote is in fact irrelevant to this. The
variable `data' that it modifies is not used in fitting the model, it is
just returned as part of the result. So, you ask, if the `data' variable
is never used, how is it used?

This is Deep Magic, and probably worth explaining.
A copy of the call to glm() (or other modelling functions) is grabbed by
match.call() and turned into a call to model.frame(). This call is then
evaluated in the parent environment to create a model frame. The
model.matrix() function is then called to create a design matrix from the
model frame.

This is how we fake dynamic scope -- using the values of variables in the
parent environment --  in a language that really has static scope. 

The moral of this is that it pays to put the variables you want to use in
a data frame. It's much easier to find them that way than by playing
clever games with environments.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Sat Feb 10 01:50:13 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 10 Feb 2001 02:50:13 +0100
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Thomas Vogels's message of "09 Feb 2001 16:05:44 -0500"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu> <x2n1c3353h.fsf@blueberry.kubism.ku.dk> <px1yt7efdj.fsf@infiniti.ece.cmu.edu>
Message-ID: <x2ofwbl31m.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@ece.cmu.edu> writes:

> > The latter. Also to some extent the fact that it requires more
> > knowledge about the content of the return value. The argument passing
> > scheme is as you can see quite general and essentially ignorant of the
> > routines that are called. In essence the issue is that it is fairly
> > easy to convert whatever to strings, but harder the other way around.
> > So for the first iteration of the package, the idea would be to have
> > the user do the necessary as.xxx conversions of return values.
> 
> Requiring the user to do the "type casting" will make the user's code
> larger and will make it harder to adopt the package.  It would be nice
> if the information would "flow more easily" to the programmer.  I
> don't want to have to use more as.whatever than I have to in other
> functions.

Sure, but it requires more detailed study of what the query-type
functions do, and what values they return.

> > > One problem is that the number of functions just explodes, so it might
> > > be better to wrap them into one enchillada?
> > > 
> > >   >  tkwinfo <- function (widget, what="exists", ...) 
> > >      switch (what,
> > >              exists=tkcmd("winfo", "exists", widget)=="1",
> > >              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
> > >              width=as.numeric (tkcmd("winfo", "width", widget)),
> > >              height=as.numeric (tkcmd("winfo", "height", widget)),
> > >              tkcmd ("winfo", what, widget, ...))
> > > 
> > > (The other problem is that tkcmd("winfo",...) may fail.)
> 
> OK, instead of going for enchilladas, how about burritos:
> 
> For a graphics device, I would use
>   > par("xaxp")  # to obtain values
>   [1]  2 10  4
>   > par (xaxp=c(2,10,4))  # to set values
> 
> Wouldn't something similar to this effect simplify the api and reduce
> the number of commands in the package (vastly)?
> 
> 1) Why not
> 
>   > tt<-tktoplevel()
>   > button <- tkbutton(tt, text="Push", command=function()cat("Ouch\n"))
>   > tkpar (button, c("text", "command"))
>   $text
>   [1]  "Push"
> 
>   $command
>   [1] " R_call 0xbfeb1c "

>   > tkpar (button, text="Yow!", command=function()cat("Yow\n"))
> 
> instead of:
> 
>   > tkcget (button, "-text")  # (hmm, shouldn't need '-' here!)
>   [1] "b"
>   > tkcget (button, "-command")  # (again, why '-command'?)
>   [1] " R_call 0xbfeb1c "

Actually, I think tkcget(button, text=NULL) is the convention for
argument-less options. The " R_call 0xbfeb1c " is wrong in either
case: It really should return the R object sitting at the address
0xbfeb1c, reversing .Tcl.callback. 

Not sure that I would want to go the tkpar() route. If I were moving
away from the direct correspondence between the R and Tcl side of the
fence I'd probably rather overload the $ $<- [[ [[<- set of operators
and have stuff like

> button$text
[1]  "Push"
> button$command
function()cat("Ouch\n")
<environment: 0x8b4641c>
> button$text<-"Pull"

and so forth. I sort of started along a similar path with the
tktitle()/tktitle()<- mechanism, but stopped as it seemed to be
getting excessive to complete this mechanism for all commands.

>   > tkconfigure (button, text="Yow!", command=function()cat("Yow\n"))
>   [1] ""
>   > # Doesn't return previous value...
> 
> This examples applies to a bunch of command pairs, like
> cget/configure, itemcget/itemconfigure, imagecget/imageconfigure,
> entrycget/entryconfigure, window.cget/window.configure, ...
> 
> 2) Why not:
> 
>   > tt <- tktoplevel()
>   > tkwm (tt, "minwidth")  # returns integers not strings
>   [1] 1 1
>   > tkwm (tt, minwidth=c(100,100))  # sets new values
> 
> instead of:
> 
>   > tkwm.minsize (tt)
>   [1] "1 1"
>   > tkwm.minsize (tt, "100","100")
>   [1] ""
> 
> The second example would wipe out 25 or so tkwm.* commands to be
> replaced by one tkwm.  (Same would apply for tkwinfo...)  Wouldn't
> that also simplify maintenance and documentation?

Nope. I'm not necessarily saying that it might not be a good idea, but
introducing command-dependent option handling is not going to simplify
the documentation. Explaining why tkwm (tt, minsize=c(100,100))
doesn't come across as "wm .1 -minsize 100 100" but as "wm minsize .1
100 100" would be tricky to explain. In this case, the changed syntax
doesn't actually save you anything anyway.
 
> Does this make sense?  Or does it sound like I've been smoking my corn
> flakes instead of eating them?  Is anybody else using the package
> tcltk and would it make sense to put some code behind those
> suggestions?

We have the occasional report from people using the package. My guess
is that it gets used for fairly simplistic things similar to the
demos. In a slightly longer perspective, I'd like to see a more
elaborate user interface prototype emerge from it. The package
certainly needs further development, and in particular the return
value handling needs some sort of fixing up. 

I still think it is useful to keep some sort of unifying perspective
on the whole thing, and I do think it is useful - at least for now -
to try and maintain some of the transparency between the R functions
and the corresponding Tcl commands.

If you want to start writing code, it might be useful to attack the
cget-style functions first. It might be nice if they could vector to a
(say) tkquery function which could be supplied with a table of return
types by option.

One possible gotcha is that the list of options is really widget
specific, and I'm not quite sure that it cannot happen that the same
option name corresponds to different value types in different widgets.

The set of valid options is certainly widget dependent (i.e. you
cannot have tkcget(radiobutton, xscrollIncrement=NULL) for instance),
and the full set of options is reall unspecified if you start thinking
of imported megawidgets and soforth. 

Hmmm.... I think you need to store the list of options with the
widgets or their class somehow, so you'd soon be on the way to a true
object system.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Sun Feb 11 10:54:28 2001
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Sun, 11 Feb 2001 11:54:28 +0100
Subject: [Rd] system command
In-Reply-To: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>; from ripley@stats.ox.ac.uk on Fri, Feb 09, 2001 at 02:28:58PM +0000
References: <3A83EE88.67F639ED@univie.ac.at> <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>
Message-ID: <20010211115428.A20548@sirio.stat.unipd.it>

On Fri, Feb 09, 2001 at 02:28:58PM +0000, Prof Brian Ripley wrote:
> On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> > ...........................................................
> > Rterm
> > on win2k
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> > EXCEPT
> > once
> > system("csound",intern=TRUE) has been done
> > and later one tries
> > system("csound",intern=FALSE)
> > stderr is lost completely.
> > going back to
> > system("csound",intern=TRUE)
> > redirects stderr again into the R object,
> > but stderr does not go to the screen any more
> > after intern=TRUE has been used once.
> >
> > .....................................................................
> > 2) problems with system and redirection on win32k.
> 
> A bug, almost certainly in Windows 2000 since this works as documented
> under NT.   Guido?

  I can replicate the problem (under Windows 2000 but not under
  Win98 or NT) using
  > system("ls",intern=TRUE);system("ls")
  I will take a look.

  guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Sun Feb 11 11:48:54 2001
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Sun, 11 Feb 2001 12:48:54 +0100
Subject: [Rd] system command
In-Reply-To: <20010211115428.A20548@sirio.stat.unipd.it>; from guido@sirio.stat.unipd.it on Sun, Feb 11, 2001 at 11:54:28AM +0100
References: <3A83EE88.67F639ED@univie.ac.at> <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats> <20010211115428.A20548@sirio.stat.unipd.it>
Message-ID: <20010211124854.A21040@sirio.stat.unipd.it>

On Sun, Feb 11, 2001 at 11:54:28AM +0100, Guido Masarotto wrote:
> On Fri, Feb 09, 2001 at 02:28:58PM +0000, Prof Brian Ripley wrote:
> > On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> > > .....................................................................
> > > 2) problems with system and redirection on win32k.
> > 
> > A bug, almost certainly in Windows 2000 since this works as documented
> > under NT.   Guido?
> 
>   I can replicate the problem (under Windows 2000 but not under
>   Win98 or NT) using
>   > system("ls",intern=TRUE);system("ls")
>   I will take a look.
> 


  Oops. After redirection (needed by system(...,intern=TRUE), Rterm's
  stdout was marked as not inheritable. 
  I have committed a fix for 1.2.2.
  guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From patrick.lindsey@luc.ac.be  Sun Feb 11 13:53:09 2001
From: patrick.lindsey@luc.ac.be (patrick.lindsey@luc.ac.be)
Date: Sun, 11 Feb 2001 14:53:09 +0100 (MET)
Subject: [Rd] Bug in pictex output. (PR#845)
Message-ID: <200102111353.OAA12746@pubhealth.ku.dk>

Hi everyone,
  I have just received a bug from one of my students. It concerns the pictex
command to produce plots in latex format. It seems to add lines on the graph
even in the most simplest cases. For example, try the following quadratic
curve:
plot(1:11,(-5:5)^2,type="b",main="Simple Example Plot")
Now, saving the plot with the following command:
pictex("plot.tex")
plot(1:11,(-5:5)^2,type="b",main="Simple Example Plot")
dev.off()
and then latex the file using the example in the help page as
\documentclass{article}
\begin{document}
\begin{figure}[h]
\centerline{\input{plots.tex}}
\end{figure}
\end{document}
produces a plot with an additional line (a diagonal line going all the way
through the plot from bottom left to top right). The error occurs on line
78 (out of 87) produced by pictex. Removing that latex command from the file
(or commenting it out) corrects the problem in this case... but looking
closer to how the axis are setup one can rapidely see that this is not done
very efficiently and could perhaps be simplified (there are 4 lines super-
imposing one another! just keeping the longest one would be enough). Hence,
perhaps something is wrong in the driver at the axis level...
As I said this problem was found by a student, as I use postscript to produce
my graphs I was just told that all plots produced with pictex produced similar
problems... but I don't know what happens in other cases than this simple
example I got from the student.
Hope this helps in fixing the problem.
Patrick.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tsumi@leo.auric.ne.jp  Sun Feb 11 14:28:55 2001
From: tsumi@leo.auric.ne.jp (Tsumiyama Isao)
Date: Sun, 11 Feb 2001 23:28:55 +0900
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102111433.PAA13691@stat.math.ethz.ch>

 Dear R users,
 
  I want to create a C program drawing a scatter plot
  with R functions.

Is it possible to do such a thing with interfaces declared
in 'Rgraphics.h'? If so, I would like to get sample C sources.

>From a user in Japan.

 Thanks,



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 11 16:49:28 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 11 Feb 2001 16:49:28 +0000 (GMT)
Subject: [Rd] Scatter plot calling R function from C
In-Reply-To: <200102111433.PAA13691@stat.math.ethz.ch>
Message-ID: <Pine.GSO.4.31.0102111644480.29747-100000@toucan.stats>

On Sun, 11 Feb 2001, Tsumiyama Isao wrote:

>  Dear R users,
>
>   I want to create a C program drawing a scatter plot
>   with R functions.
>
> Is it possible to do such a thing with interfaces declared
> in 'Rgraphics.h'? If so, I would like to get sample C sources.

Strictly no.  You would need to open an R graphics device, and you can't
do that from the publically declared headers.  And you would need to
handle all the error conditions that call back into R.

>From C code called from R you can write to an already opened graphics
device.  Alternatives, you can embed R in your C program and then call R
graphics via R calls.

I don't think there are many examples: Rgraphics.h was included for
use by experts writing addons.  Paul Murrell may be able to help more.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Mon Feb 12 01:27:18 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Mon, 12 Feb 2001 14:27:18 +1300
Subject: [Rd] Scatter plot calling R function from C
References: <Pine.GSO.4.31.0102111644480.29747-100000@toucan.stats>
Message-ID: <021301c09492$f32ad320$175dd882@stat.auckland.ac.nz>

Hi


> On Sun, 11 Feb 2001, Tsumiyama Isao wrote:
>
> >  Dear R users,
> >
> >   I want to create a C program drawing a scatter plot
> >   with R functions.
> >
> > Is it possible to do such a thing with interfaces declared
> > in 'Rgraphics.h'? If so, I would like to get sample C sources.
>
> Strictly no.  You would need to open an R graphics device, and you can't
> do that from the publically declared headers.  And you would need to
> handle all the error conditions that call back into R.
>
> From C code called from R you can write to an already opened graphics
> device.  Alternatives, you can embed R in your C program and then call R
> graphics via R calls.
>
> I don't think there are many examples: Rgraphics.h was included for
> use by experts writing addons.  Paul Murrell may be able to help more.


As Brian says, the first big obstacle is getting a device started, which can
only be done from R.  Once you have that, then all of the necessary graphics
is there in Rgraphics.h, but its at a very low level.  Rgraphics.h gives you
access to a basic graphics engine for drawing lines and rectangles and such,
plus some more complicated things like data symbols, but it does not have
anything really high level like a plot or even an axis.  You have to compose
these things yourself.

There are examples of how R uses these functions in R/src/main/plot.c, but
it would take a considerable effort to work out what is going on.

The functions Rgraphics.h exports are useful if you want to write your own
graphics system from the ground up, but they are not very useful if you want
to produce plots like the ones that R already produces.  If you want to do
the latter then you are much better to try the route suggested by Brian and
embed R in your C program so that you can call R's high-level graphics
functions.

Hope that helps

Paul






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Feb 12 15:47:45 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Feb 2001 16:47:45 +0100
Subject: [Rd] Re: tabular data (was RE: [R] Removing "row.names")
In-Reply-To: <200102091824.NAA03028@jessie.research.bell-labs.com>
References: <200102091824.NAA03028@jessie.research.bell-labs.com>
Message-ID: <14984.1441.181293.426501@mithrandir.hornik.net>

>>>>> David James writes:

> Hi,

> For instance, interfaces to XML, spreadsheets, DBMS, etc., will
> further expose some of the limitations of these existing objects.
> Tables holding data from relational DBMS are an easy case: this class
> should preserve the original data as much as possible, i.e., no
> coercing into factors, no changing column names, no row names, but
> otherwise very similar to data.frames.  (Timothy Keitt has a more
> interesting concept of "proxyTables" that presents some very
> interesting issues: should proxyTables, which "point" to remote
> relations in dbms, allow integer indexing? --- the relational database
> model does not support it)

> Is there something common to all these objects?  Obviously they all
> support indexing x[i,j, ...] plus the methods dim() and (possibly
> NULL) dimnames().  S4 defines vectors as a (virtual) class in terms of
> the indexing operation in exactly this way -- thus in S4 lists are
> vectors, and so are logicals, characters, etc.  We may be able to
> group the various "tabular data" classes under such virtual class, and
> provide simple coercion facilities so that users can easily fit, say,
> a linear model to data coming as an XML document or in a table stored
> in a dbms.

Maybe this is something to be kicked off at the official part of DSC and
discussed in the `r-core' part.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bwheeler@echip.com  Tue Feb 13 00:38:48 2001
From: bwheeler@echip.com (bwheeler@echip.com)
Date: Tue, 13 Feb 2001 01:38:48 +0100 (MET)
Subject: [Rd] Sticky levels (PR#846)
Message-ID: <200102130038.BAA29298@pubhealth.ku.dk>

This isn't actually a bug, but what is one to do
in cast of a typo?

> citizen<-factor(c("uk","as","no","au","uk","us","us"))
> levels(citizen)
[1] "as" "au" "no" "uk" "us"
> citizen[2]<-"us"
> citizen
[1] uk us no au uk us us
Levels:  as au no uk us    ** [STICKY "as"] **
> citizen[2]<-"gs"
Warning message: 
invalid factor level, NAs generated in:
[<-.factor(*tmp*, 2, value = "gs")

-- 
Bob Wheeler --- (Reply to: bwheeler@echip.com)
        ECHIP, Inc.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Tue Feb 13 00:44:58 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Mon, 12 Feb 2001 16:44:58 -0800 (PST)
Subject: [Rd] Sticky levels (PR#846)
In-Reply-To: <200102130038.BAA29298@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0102121642400.133498-100000@homer27.u.washington.edu>

On Tue, 13 Feb 2001 bwheeler@echip.com wrote:

> This isn't actually a bug, 

True. Perhaps R-bugs wasn't the best place for it initially?

>			but what is one to do
> in cast of a typo?
> 
> > citizen<-factor(c("uk","as","no","au","uk","us","us"))
> > levels(citizen)
> [1] "as" "au" "no" "uk" "us"
> > citizen[2]<-"us"

  citizen<-as.character(citizen)
  citizen[2]<-"us"
  citizen<-factor(citizen)

would do it. Yes, certain aspects of factors are a pain at times.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From cyg@sympatico.ca  Tue Feb 13 11:06:40 2001
From: cyg@sympatico.ca (Yves Gauvreau)
Date: Tue, 13 Feb 2001 06:06:40 -0500
Subject: [Rd] Documentation suggestion!
In-Reply-To: <Pine.GSO.4.31.0102130718110.9532-100000@auk.stats>
Message-ID: <NEBBJKDJHEFCOOLFFAKKOEOACAAA.cyg@sympatico.ca>

Hi,

Could I suggest that the documentation of "locator" and "identify" be
modified so that they refer to each other and that the "graphic" keyword be
added to "identify". If you think it's a good idea of course, I would even
volunteer to do it if you can point me to the procedure. (What file(s) would
have to be modified beside Rd files if any and what do I do with them
afterward.)

I'm making this suggestion because I had a hard time locating them
especially "identify". I vaguely recalled the functionality was implemented
but I had forgotten the function names. I got to "locator" using
help.search("graphic") and as for "identify" I had to remember the name
which I finally did.

While writing this I took a look at some .Rd files, at keywords and at
keywords.db which are located in D:\R-1.2.0\doc of the main *nix source and
I wonder if there is any kind of information on how the help system works?


Thanks

Yves Gauvreau
B.E.F.P. Universite du Quebec a Montreal
cyg@sympatico.ca

PS. I hope this is the right place to send this.

         _
platform i386-pc-mingw32
arch     x86
os       Win32
system   x86, Win32
status
major    1
minor    2.1
year     2001
month    01
day      15
language R

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Feb 13 11:17:09 2001
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 13 Feb 2001 12:17:09 +0100 (MET)
Subject: [Rd] RE: [R] silly question about spec (PR#847)
Message-ID: <200102131117.MAA04218@pubhealth.ku.dk>

On 14-Feb-01 Jason Turner wrote:
> I'm using spec for multivariate time series, and have a 
> question about "coh".  
> 
> This is probably a very silly question, but I'm a bit stumped.
> From the documentation: 
> 
> Column i + (j - 1) * (j - 2)/2 of coh contains the squared coherency 
> between columns i and j of x, where i > j.
> 
> What's in column 1 of coh?

Not a silly question, but a silly typo in the help page.  In fact the
formula is valid for i < j not i > j, so column 1 gives the squared
coherency between columns 1 and 2:

1 + (2 - 1) * (2 - 2)/2 = 1

Martyn

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Feb 13 11:35:53 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 13 Feb 2001 11:35:53 +0000 (GMT)
Subject: [Rd] Documentation suggestion!
Message-ID: <200102131135.LAA09098@toucan.stats.ox.ac.uk>

> From: "Yves Gauvreau" <cyg@sympatico.ca>
> Date: Tue, 13 Feb 2001 06:06:40 -0500

> Could I suggest that the documentation of "locator" and "identify" be
> modified so that they refer to each other 

That's easy, and done now.

> and that the "graphic" keyword be
> added to "identify". If you think it's a good idea of course, I would even
> volunteer to do it if you can point me to the procedure. (What file(s) would
> have to be modified beside Rd files if any and what do I do with them
> afterward.)

There is no `graphic' keyword.  locator and identify have keyword
`iplot', `Interacting with Plots'.  See below.

> I'm making this suggestion because I had a hard time locating them
> especially "identify". I vaguely recalled the functionality was implemented
> but I had forgotten the function names. I got to "locator" using
> help.search("graphic") and as for "identify" I had to remember the name
> which I finally did.

It took `graphic' from the title for locator, not the keyword.

> While writing this I took a look at some .Rd files, at keywords and at
> keywords.db which are located in D:\R-1.2.0\doc of the main *nix source and

[Actually, there is only one set of sources: it is the Windows source too.]

> I wonder if there is any kind of information on how the help system works?

Really there is not just one help system, but several.  The `keywords'
are a misnomer carried over from S3:  they are in fact categories used
by the HTML search system, and by help.search.  On Windows the CHTML
and WinHelp help systems have full-text-search by default, and we are
looking at ways of providing FTS and approximate matching on other platforms.

I think had you done a search under HTML help, it would have been more
obvious from the categories presented to you.  I would also commend
CHTML full-text searches to you.

We are aware that the help system could be improved, and I have already
suggested real keywords for a future version.


Another issue that is just as important is the contents of the help.  I
realised recently that the documentation for many of the basic graphics
operations is incomplete (they accept many more forms of input via
xy.coords, NAs can be used to break lines, polygons are supposed to be
automatically closed, and so on).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tsumi@leo.auric.ne.jp  Tue Feb 13 14:42:36 2001
From: tsumi@leo.auric.ne.jp (Tsumiyama Isao)
Date: Tue, 13 Feb 2001 23:42:36 +0900
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102131447.PAA17346@stat.math.ethz.ch>

Hi, R users.

Thank you for kind advices.
But I have an additional question about how to emded R in
C code.
Is it like 'Embeded  SQL'? Are there any libraries or interfaces
used to embed R in C code?

>From a R beginner in Japan, 


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Feb 13 15:02:25 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 13 Feb 2001 15:02:25 +0000 (GMT)
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102131502.PAA09385@toucan.stats.ox.ac.uk>


> From: "Tsumiyama Isao" <tsumi@leo.auric.ne.jp>
> Date: Tue, 13 Feb 2001 23:42:36 +0900
> 
> Hi, R users.
> 
> Thank you for kind advices.
> But I have an additional question about how to emded R in
> C code.
> Is it like 'Embeded  SQL'? Are there any libraries or interfaces
> used to embed R in C code?

It is not like Embedded SQL.  You need to tell us whether you want to
do this on Unix or Windows.  For the latter, it is easiest to
use the DCOM interface on CRAN.  For the former, you need to build
R as shared library, and see the outline instructions on the developer site.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Tue Feb 13 22:40:37 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Tue, 13 Feb 2001 23:40:37 +0100 (MET)
Subject: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
Message-ID: <200102132240.XAA10562@pubhealth.ku.dk>


Hi, there are two problems in devX11.c.  The one is an undocumented
nuisance and the other isn't a bug until you try to embed an X11
device in another window (think tktoplevel() in tcltk package...).

Let's take a look at locator() first: Assuming you call locator() with
a current X11 device, this call is handled in X11_Locator
(src/unix/X11/devX11.c).  When you have one window open and call
locator, you have three options to quit the locator: click Button 1
(to locate), click Button 2 (to abort), or destroy the window.  The
later results in the error message: "Error in locator(1) : No graphics
device is active". That's OK, sort of.

This gets problematic when you open two windows:
> x11()  # assume that's device 2
> x11()  # assume that's device 3
> plot(1)
> locator(1)  # with device 3 == dev.cur()!

When you now destroy device 3 (where locator expects the click), you have
*no alternative but to close _all_ windows* to abort the locator.  The
locator continues to wait for mouse clicks in device 3 where of course
no further clicks can come from.  That's the nuisance part.

The second problem is that the device may try to plot() into a
non-existant window.  Assume that the window was destroyed by some
other part of the program.  The device (at some point in the future)
will receive a DestroyNotify event that handleEvent ignores.
Blissfully!  *No KillDevice is called* when the window is destroyed by
something other than the WM_DELETE_WINDOW mechanism!  This happens
when you embed the X11 device into another window/application.  For
starters, the device no longer receives WM_DELETE_WINDOW client
messages.  But it does receive a DestroyNotify event when the parent
(the container window) is destroyed.  HandleEvent should, well
_handle_ this _event_.

The patch below is a _suggestion_ how to solve both problems.  It is
against the current r-devel, 1.3, as of 2/13.  I believe this behavior
exists in version 1.2 as well and can be solved there the same way.
The patch is just meant as a convenient and concise way to describe
my suggestion.  I'd greatly appreciate feedback or other ideas!

Implementation:

-- the variable inclose is now in the device specific structure (why
   was it global?)  After the window is mapped, inclose is TRUE until
   the window is destroyed explicitly or a DestroyNotify event has been
   received.
-- the deviceSpecific pointer is set to NULL after the memory has been
   freed. This (side?) effect is used in X11_Locator to detect the
   closing of the current device  which _must_ lead to an error.
-- the if statement to handle events of type DestroyEvent is added to 
   handleEvent
-- when the user closes the device (dev.off()), the window is
   destroyed in X11_Close
-- when the user pushes the close button in the window frame, the
   window is destroyed in handleEvent and X11_Close is initiated
   (the WM_DELETE_WINDOW mechanism already in place.)
-- when the window is destroyed for another reason (e.g. the parent
   being destroyed), it is not destroyed again but X11_Close is still
   initiated.

Regards,
  -tom


--------------------------------------------------
*** devX11.c_orig	Tue Feb 13 15:32:24 2001
--- devX11.c	Tue Feb 13 17:24:04 2001
***************
*** 116,121 ****
--- 116,122 ----
      FILE *fp;				/* file for a bitmap device */
      int quality;			/* JPEG quality */
  
+     Rboolean inclose;                   /* TRUE if window is being closed */
  } x11Desc;
  
  
***************
*** 145,151 ****
  static Atom _XA_WM_PROTOCOLS, protocol;
  
  static Rboolean displayOpen = FALSE;
- static Rboolean inclose = FALSE;
  static int numX11Devices = 0;
  
  	/********************************************************/
--- 146,151 ----
***************
*** 619,632 ****
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS))
! 	if (!inclose && event.xclient.data.l[0] == protocol) {
! 	    XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    KillDevice(dd);
  	}
  }
  
  static void R_ProcessEvents(void *data)
--- 619,652 ----
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
+     else if (event.type == DestroyNotify) {
+         /* The window is being destroyed, kill the device, too. */
+         XFindContext(display, event.xdestroywindow.window,
+                      devPtrContext, &temp);
+         dd = (DevDesc *) temp;
+         xd = (x11Desc *) dd->deviceSpecific;
+         if (!xd->inclose) {
+             xd->inclose = TRUE;
+             KillDevice(dd);
+         }
+     }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS)) {
! 	if (event.xclient.data.l[0] == protocol) {
!             XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    xd = (x11Desc *) dd->deviceSpecific;
! 	    if (!xd->inclose) {
! 		/* Dispatch destroy only once */
! 		xd->inclose = TRUE;
! 		XDestroyWindow(display, xd->window);
! 		XSync (display, 0);
! 		KillDevice(dd);
! 	    }
  	}
+     }
+ 
  }
  
  static void R_ProcessEvents(void *data)
***************
*** 1208,1213 ****
--- 1228,1234 ----
  		     ExposureMask | ButtonPressMask | StructureNotifyMask);
  	XMapWindow(display, xd->window);
  	XSync(display, 0);
+         xd->inclose = FALSE;
  
  	/* Gobble expose events */
  
***************
*** 1464,1476 ****
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* process pending events */
! 	/* set block on destroy events */
! 	inclose = TRUE;
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
- 	XDestroyWindow(display, xd->window);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
--- 1485,1506 ----
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* There are three reasons to be here: */
! 	/* 1) The user clicked on a button in the window frame */
! 	/*    and we received a DELETE_WINDOW from the wm, */
! 	/* 2) Somebody destroyed our window directly, or if */
! 	/*    embedded, the parent is being destroyed, and so */
! 	/*    we got a DestroyNotify event, too, */
! 	/* 3) The user used dev.off() to get rid of us. Bye. */
! 
! 	if (!xd->inclose) {
! 	    xd->inclose = TRUE;
! 	    XDestroyWindow(display, xd->window);
! 	}
! 	/* process pending events (esp. reap events for this window) */
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
***************
*** 1517,1523 ****
      }
  
      free(xd);
!     inclose = FALSE;
  }
  
  	/********************************************************/
--- 1547,1553 ----
      }
  
      free(xd);
!     dd->deviceSpecific = NULL;
  }
  
  	/********************************************************/
***************
*** 1858,1866 ****
  		else
  		    done = 2;
  	    }
! 	}
! 	else
  	    handleEvent(event);
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--- 1888,1901 ----
  		else
  		    done = 2;
  	    }
! 	} else {
  	    handleEvent(event);
+ 	    if (!dd->deviceSpecific) {
+ 		/* Allow new active window to redraw */
+ 		R_ProcessEvents((void*)NULL);
+ 		error ("Device closed while waiting for input.\n");
+ 	    }
+         }
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--------------------------------------------------




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Feb 13 23:19:49 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 13 Feb 2001 18:19:49 -0500
Subject: [Rd] devX11.c -- questions about expose events and XBell
Message-ID: <pxy9va5fxm.fsf@infiniti.ece.cmu.edu>


Hi,  sorry for lumping this together...  Both these issues are rather
small, and I'm not sure either qualifies as a bug...

1) After a window id created in X11_Open and mapped,  you "gobble the
   expose events".  Not true, you gobble any event that comes along!
   The code below fixes this by using *XCheckTypedEvent*.  Hmm, I'm
   not sure this right already, but better...

*** devX11.c~    Tue Feb 13 17:24:40 2001
--- devX11.c    Tue Feb 13 18:07:41 2001
***************
*** 1232,1242 ****
  
        /* Gobble expose events */
  
!       XNextEvent(display, &event);
!       if (event.xany.type == Expose) {
!           while (event.xexpose.count)
!               XNextEvent(display, &event);
!       }
      } else { /* PIXMAP */
        xd->windowWidth = iw = w;
        xd->windowHeight = ih = h;
--- 1232,1241 ----
  
        /* Gobble expose events */
  
!       if (XCheckTypedEvent(display, Expose, &event)) {
!           while (event.xexpose.count)
!               XNextEvent(display, &event);
!       }
      } else { /* PIXMAP */
        xd->windowWidth = iw = w;
        xd->windowHeight = ih = h;


2) There are beeps from X11_Locator for every successful mouse click.
   The code here assumes that stderr is connected to a terminal.
   This is not always true!  When I run R within an ESS session in
   emacs, I get ^G  but no sound.  When I redirect the output, I get
   nothing...  *Question* Why don't you use *XBell*?

*** devX11.c~    Tue Feb 13 17:24:40 2001
--- devX11.c    Tue Feb 13 18:07:41 2001
***************
*** 1880,1887 ****
                if (event.xbutton.button == Button1) {
                    *x = event.xbutton.x;
                    *y = event.xbutton.y;
!                   fprintf(stderr, "\07");
!                   fflush(stderr);
                    XSync(display, 0);
                    done = 1;
                }
--- 1879,1885 ----
                if (event.xbutton.button == Button1) {
                    *x = event.xbutton.x;
                    *y = event.xbutton.y;
!                   XBell (display, 0);
                    XSync(display, 0);
                    done = 1;
                }
   

Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Wed Feb 14 00:11:56 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 14 Feb 2001 01:11:56 +0100
Subject: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 13 Feb 2001 23:40:37 +0100 (MET)"
References: <200102132240.XAA10562@pubhealth.ku.dk>
Message-ID: <x2elx2yvg3.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:


> Blissfully!  *No KillDevice is called* when the window is destroyed by
> something other than the WM_DELETE_WINDOW mechanism!  This happens
> when you embed the X11 device into another window/application.  For
> starters, the device no longer receives WM_DELETE_WINDOW client
> messages.  But it does receive a DestroyNotify event when the parent
> (the container window) is destroyed.  HandleEvent should, well
> _handle_ this _event_.

Heh. Quite probably, this is also the source of the FVWM trouble
reported earlier although that triggered an infinite loop which should
probably be guarded against by other means as well. 

Thanks for filing this (good to have as bug report so that we don't
forget - it's the sort of thing that often has to wait until someone
has a clear enough mind and sufficient stamina to try and get it
right.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Feb 15 04:38:15 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 14 Feb 2001 23:38:15 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <pxae7opnm0.fsf@infiniti.ece.cmu.edu>


Hi, I'm not sure this is a bug in the code, the comment or my
thinking.  So first try goes to r-devel...  I find the following
comment in X11_Open () (src/unix/X11/devX11.c):

/* if we have to bail out with "error", then must free(dd) and free(xd) */

A couple lines down, there is:

    if (!strncmp(dsp, "png::", 5)) {
	FILE *fp;
#ifndef HAVE_PNG
	error("No png support in this version of R");
#endif
	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
	    error("could not open PNG file `%s'", dsp+6);
    ...

So what does the comment imply?  If error jumps out to the toplevel
without giving X11DeviceDriver a chance to free dd and xd, then this
should be:

    if (!strncmp(dsp, "png::", 5)) {
	FILE *fp;
#ifndef HAVE_PNG
        free (xd);
        free (dd);
	error("No png support in this version of R");
#endif
	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w"))) {
            free (xd);
            free (dd);
	    error("could not open PNG file `%s'", dsp+6);
        }

There are a couple more error()s without free()s.  The memory leak
isn't big, I'd still appreciate it if you clarify who should do the free().
Thanks,
  -tom



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 15 08:28:30 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Feb 2001 08:28:30 +0000 (GMT)
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: <pxae7opnm0.fsf@infiniti.ece.cmu.edu>
Message-ID: <Pine.GSO.4.31.0102150824260.13108-100000@toucan.stats>

On 14 Feb 2001, Thomas Vogels wrote:

>
> Hi, I'm not sure this is a bug in the code, the comment or my
> thinking.  So first try goes to r-devel...  I find the following
> comment in X11_Open () (src/unix/X11/devX11.c):
>
> /* if we have to bail out with "error", then must free(dd) and free(xd) */
>
> A couple lines down, there is:
>
>     if (!strncmp(dsp, "png::", 5)) {
> 	FILE *fp;
> #ifndef HAVE_PNG
> 	error("No png support in this version of R");
> #endif
> 	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> 	    error("could not open PNG file `%s'", dsp+6);
>     ...
>
> So what does the comment imply?  If error jumps out to the toplevel
> without giving X11DeviceDriver a chance to free dd and xd, then this
> should be:

[...]

Well, the thinking was that people would not be trying to use facilities
on systems where they had not bothered to implement them, so what problem
was a small memory leak?  They would only do it once, ever ....

In these cases it would be better to give a warning and return FALSE, when
the normal return mechanism will free xd and then dd.  I will alter it to
that when I have tested it out.

BDR

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Feb 15 14:29:42 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 15 Feb 2001 09:29:42 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Prof Brian Ripley's message of "Thu, 15 Feb 2001 08:28:30 +0000 (GMT)"
References: <Pine.GSO.4.31.0102150824260.13108-100000@toucan.stats>
Message-ID: <pxr9106muh.fsf@infiniti.ece.cmu.edu>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> On 14 Feb 2001, Thomas Vogels wrote:
> 
> >
> > Hi, I'm not sure this is a bug in the code, the comment or my
> > thinking.  So first try goes to r-devel...  I find the following
> > comment in X11_Open () (src/unix/X11/devX11.c):
> >
> > /* if we have to bail out with "error", then must free(dd) and free(xd) */
> >
> > A couple lines down, there is:
> >
> >     if (!strncmp(dsp, "png::", 5)) {
> > 	FILE *fp;
> > #ifndef HAVE_PNG
> > 	error("No png support in this version of R");
> > #endif
> > 	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> > 	    error("could not open PNG file `%s'", dsp+6);
> >     ...
> >
> > So what does the comment imply?  If error jumps out to the toplevel
> > without giving X11DeviceDriver a chance to free dd and xd, then this
> > should be:
> 
> [...]
> 
> Well, the thinking was that people would not be trying to use facilities
> on systems where they had not bothered to implement them, so what problem
> was a small memory leak?  They would only do it once, ever ....

uh, I guess I screwed up the example.  Even more lines down, there is
no free accompanying the error ("could not open PNG file ...").  That
can happen more often and more memory would leak.  But no, I wanted to
know this for another reason: I've played around with the X11 device
driver to implement a feature that allows me to embed the device into
another window.  Opening and closing of x11()'s can happen often
during the execution of the program.  But I'm still not interested in
the memory leak issue per se.

I've seen a segfault or two (not in the regular code) and right now I
blame it on Xevents arriving after the device is shut down.  Now all
of a sudden the calls to free become very interesting.  As I said at
the beginning of the email, I wanted to simply understand the comment,
understand what should be going on, not criticize for it not being
followed.

Although I got the question wrong, I guess, I got the right answer :-)
Thanks.

Regards,
  -tom


> 
> In these cases it would be better to give a warning and return FALSE, when
> the normal return mechanism will free xd and then dd.  I will alter it to
> that when I have tested it out.

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From I.Wilson@maths.abdn.ac.uk  Thu Feb 15 17:59:12 2001
From: I.Wilson@maths.abdn.ac.uk (I.Wilson@maths.abdn.ac.uk)
Date: Thu, 15 Feb 2001 18:59:12 +0100 (MET)
Subject: [Rd] (PR#849)
Message-ID: <200102151759.SAA06837@pubhealth.ku.dk>



The symbol( circle) function does not create
circles.

See following function

ijwbug <- function()
{
   plot.new()
     plot.window(c(-1,1),c(-1,1));
   symbols(0,0,circle=1,add=T,inches=F);

   curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
     curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
lines(c(-1,1),c(1,1));
lines(c(-1,1),c(-1,-1));


}



--please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = x86
  os = Win32
  system = x86, Win32
  status =
  major = 1
  minor = 2.1
  year = 2001
  month = 01
  day = 15
  language = R

Windows NT 4.0 (build 1381) Service Pack 5

Search Path:
  .GlobalEnv, Autoloads, package:base


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 15 18:08:58 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 15 Feb 2001 13:08:58 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
Message-ID: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>

I am trying to catch a segfault from a shell in the tests directory set up by R CMD
check with

R_LIBS=~/dse/CHECKED/library:..
export R_LIBS
R -d gdb
run

but then when I try to load a library I find the setting of R_LIBS is ignored. What
am I doing wrong? The library is found ok without -d gdb. (Using Solaris 2.6, R 1.2.1
Patched (2001-02-06) )

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Thu Feb 15 19:19:13 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Fri, 16 Feb 2001 08:19:13 +1300
Subject: [Rd] (PR#849)
References: <200102151759.SAA06837@pubhealth.ku.dk>
Message-ID: <007701c09784$2e4e3b10$175dd882@stat.auckland.ac.nz>

Hi


> The symbol( circle) function does not create
> circles.
>
> See following function
>
> ijwbug <- function()
> {
>    plot.new()
>      plot.window(c(-1,1),c(-1,1));
>    symbols(0,0,circle=1,add=T,inches=F);
>
>    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
>      curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
> lines(c(-1,1),c(1,1));
> lines(c(-1,1),c(-1,-1));
>
>
> }


If I understand correctly, I think you're just seeing clipping.

Does the slight modification of your function given below behave as you
would expect ?

ijwbug <- function()
{ 
   # do not clip to figure region, clip only to device region
   par(xpd=NA) 
   plot.new()
   plot.window(c(-1,1),c(-1,1));
   symbols(0,0,circle=1,add=T,inches=F);
   # I have added colour to the curves 
   curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1, col="red")
   curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1, col="red")
   lines(c(-1,1),c(1,1));
   lines(c(-1,1),c(-1,-1));
}

Paul




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Thu Feb 15 21:22:01 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 15 Feb 2001 22:22:01 +0100
Subject: [Rd] (PR#849)
In-Reply-To: "Paul Murrell"'s message of "Fri, 16 Feb 2001 08:19:13 +1300"
References: <200102151759.SAA06837@pubhealth.ku.dk> <007701c09784$2e4e3b10$175dd882@stat.auckland.ac.nz>
Message-ID: <x2vgqb63ra.fsf@blueberry.kubism.ku.dk>

"Paul Murrell" <paul@stat.auckland.ac.nz> writes:

> Hi
> 
> 
> > The symbol( circle) function does not create
> > circles.
> >
> > See following function
> >
> > ijwbug <- function()
> > {
> >    plot.new()
> >      plot.window(c(-1,1),c(-1,1));
> >    symbols(0,0,circle=1,add=T,inches=F);
> >
> >    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
> >      curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
> > lines(c(-1,1),c(1,1));
> > lines(c(-1,1),c(-1,-1));
> >
> >
> > }
> 
> 
> If I understand correctly, I think you're just seeing clipping.
> 
> Does the slight modification of your function given below behave as you
> would expect ?
> 
> ijwbug <- function()
> { 
>    # do not clip to figure region, clip only to device region
>    par(xpd=NA) 
>    plot.new()
>    plot.window(c(-1,1),c(-1,1));
>    symbols(0,0,circle=1,add=T,inches=F);
>    # I have added colour to the curves 
>    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1, col="red")
>    curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1, col="red")
>    lines(c(-1,1),c(1,1));
>    lines(c(-1,1),c(-1,-1));
> }
> 
> Paul

Actually, I think the real problem is that the plotting region is not
square, so  curve(sqrt(1 - x^2),...) is an ellipse. Insert
par(pty="s") to fix that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pdenis2@home.com  Fri Feb 16 04:35:06 2001
From: pdenis2@home.com (pdenis2@home.com)
Date: Fri, 16 Feb 2001 05:35:06 +0100 (MET)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
Message-ID: <200102160435.FAA08793@pubhealth.ku.dk>

print.matrix(x) segfaults if the vector supplied to 'rowlab' is
*shorter* than nrow(x):

> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    2.1
year     2001
month    01
day      15
language R
[installed from RPM]

> x<-1:4
> dim(x)<-c(2,2)
> x
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> print.matrix(x)
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> print.matrix(x,rowlab=c('a','b'))
  [,1] [,2]
a    1    3
b    2    4
> print.matrix(x,rowlab=c('a','b','c'))
  [,1] [,2]
a    1    3
b    2    4                                             [OK, ignores
extra labels ...]
> print.matrix(x,rowlab=c('a'))
Segmentation fault (core dumped)

Similar behavior for 'collab' ...



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Fri Feb 16 08:04:45 2001
From: adrian@olsen.ch (Adrian Trapletti)
Date: Fri, 16 Feb 2001 09:04:45 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <3A8CDF1D.707A7785@olsen.ch>

> Date: 15 Feb 2001 09:29:42 -0500
> From: Thomas Vogels
> Subject: Re: [Rd] who frees dd and xd in X11_Open?
>
> Prof Brian Ripley  writes:
>
> > On 14 Feb 2001, Thomas Vogels wrote:
> >
> > >
> > > Hi, I'm not sure this is a bug in the code, the comment or my
> > > thinking.  So first try goes to r-devel...  I find the following
> > > comment in X11_Open () (src/unix/X11/devX11.c):
> > >
> > > /* if we have to bail out with "error", then must free(dd) and free(xd) */
> > >
> > > A couple lines down, there is:
> > >
> > >     if (!strncmp(dsp, "png::", 5)) {
> > >     FILE *fp;
> > > #ifndef HAVE_PNG
> > >     error("No png support in this version of R");
> > > #endif
> > >     if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> > >         error("could not open PNG file `%s'", dsp+6);
> > >     ...
> > >
> > > So what does the comment imply?  If error jumps out to the toplevel
> > > without giving X11DeviceDriver a chance to free dd and xd, then this
> > > should be:
> >
> > [...]
> >
> > Well, the thinking was that people would not be trying to use facilities
> > on systems where they had not bothered to implement them, so what problem
> > was a small memory leak?  They would only do it once, ever ....
>
> uh, I guess I screwed up the example.  Even more lines down, there is
> no free accompanying the error ("could not open PNG file ...").  That
> can happen more often and more memory would leak.  But no, I wanted to
> know this for another reason: I've played around with the X11 device
> driver to implement a feature that allows me to embed the device into
> another window.  Opening and closing of x11()'s can happen often
> during the execution of the program.  But I'm still not interested in
> the memory leak issue per se.
>
> I've seen a segfault or two (not in the regular code) and right now I
> blame it on Xevents arriving after the device is shut down.  Now all
> of a sudden the calls to free become very interesting.  As I said at
> the beginning of the email, I wanted to simply understand the comment,
> understand what should be going on, not criticize for it not being
> followed.
>
> Although I got the question wrong, I guess, I got the right answer :-)
> Thanks.
>
> Regards,
>   -tom
>
>
> >
> > In these cases it would be better to give a warning and return FALSE, when
> > the normal return mechanism will free xd and then dd.  I will alter it to
> > that when I have tested it out.
>
>
I don't know if it has something to do with this discussion, but it's
probably worth reporting it.

Under
SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
R : Version 1.2.1  (2001-01-15)
Fvwm95 Version 2.0.43a
the window manager always crashes when I close an x11() device started
within R.

Adrian

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Feb 16 09:03:17 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 16 Feb 2001 09:03:17 +0000 (GMT)
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <200102160903.JAA29278@toucan.stats.ox.ac.uk>


> Date: Fri, 16 Feb 2001 09:04:45 +0100
> From: Adrian Trapletti <adrian@olsen.ch

> I don't know if it has something to do with this discussion, but it's
> probably worth reporting it.
> 
> Under
> SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> R : Version 1.2.1  (2001-01-15)
> Fvwm95 Version 2.0.43a
> the window manager always crashes when I close an x11() device started
> within R.

This discussion is about png() and jpeg() devices.  We've had other
reports about FVWM, though.

Why anyone would use FVWM95 on a system that comes with CDE is an
interesting question, though....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Fri Feb 16 12:03:48 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 2001 13:03:48 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Prof Brian Ripley's message of "Fri, 16 Feb 2001 09:03:17 +0000 (GMT)"
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
Message-ID: <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > From: Adrian Trapletti <adrian@olsen.ch
> 
> > I don't know if it has something to do with this discussion, but it's
> > probably worth reporting it.
> > 
> > Under
> > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > R : Version 1.2.1  (2001-01-15)
> > Fvwm95 Version 2.0.43a
> > the window manager always crashes when I close an x11() device started
> > within R.
> 
> This discussion is about png() and jpeg() devices.  We've had other
> reports about FVWM, though.

...and they too refer to improper error handling by X11. I'm somewhat
baffled by the effect reported, though. Surely, an application
crashing the window manager is a bug in the latter, not the former?
What we've heard of before is that closing X11 windows with the window
manager crashes R, but this sounds like the other way around.

> Why anyone would use FVWM95 on a system that comes with CDE is an
> interesting question, though....

Except for the "95" bit I can empathize with it. (and the law of
inertia is strong for user interfaces in any case).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From stefano.iacus@unimi.it  Fri Feb 16 16:10:44 2001
From: stefano.iacus@unimi.it (Stefano Iacus)
Date: Fri, 16 Feb 2001 17:10:44 +0100
Subject: [Rd] R 1.2.2 (pre-release) available
Message-ID: <a05001900b6b3006ec3ab@[159.149.74.61]>

A pre-release of R 1.2.2 based on the latest R-patched archive 
(2/14/2001) for Macintosh is available at:


http://www.eco-dip.unimi.it/R


It is important to receive as much feedback as possible before R 
1.2.2 is released.

Stefano
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb 16 16:50:01 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Fri, 16 Feb 2001 08:50:01 -0800 (PST)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
In-Reply-To: <200102160435.FAA08793@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.33.0102160848140.53536-100000@homer40.u.washington.edu>

On Fri, 16 Feb 2001 pdenis2@home.com wrote:

> print.matrix(x) segfaults if the vector supplied to 'rowlab' is
> *shorter* than nrow(x):
>

Ok, the cause is the obvious one: there is no check for the length of
rowlab in print[type]Matrix, nor in formatString. formatString happily
wanders along the vector and falls off the end.

I'm going to fix it in formatString, we may also want to fix it higher up.

	-thomas


> > version
>          _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    2.1
> year     2001
> month    01
> day      15
> language R
> [installed from RPM]
>
> > x<-1:4
> > dim(x)<-c(2,2)
> > x
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > print.matrix(x)
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > print.matrix(x,rowlab=c('a','b'))
>   [,1] [,2]
> a    1    3
> b    2    4
> > print.matrix(x,rowlab=c('a','b','c'))
>   [,1] [,2]
> a    1    3
> b    2    4                                             [OK, ignores
> extra labels ...]
> > print.matrix(x,rowlab=c('a'))
> Segmentation fault (core dumped)
>
> Similar behavior for 'collab' ...
>
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle
^^^^^^^^^^^^^^^^^^^^^^^^
 NOTE NEW EMAIL ADDRESS

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb 16 16:54:23 2001
From: tlumley@u.washington.edu (tlumley@u.washington.edu)
Date: Fri, 16 Feb 2001 17:54:23 +0100 (MET)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
Message-ID: <200102161654.RAA17826@pubhealth.ku.dk>

On Fri, 16 Feb 2001, Thomas Lumley wrote:

> On Fri, 16 Feb 2001 pdenis2@home.com wrote:
>
> > print.matrix(x) segfaults if the vector supplied to 'rowlab' is
> > *shorter* than nrow(x):
> >
>
> Ok, the cause is the obvious one: there is no check for the length of
> rowlab in print[type]Matrix, nor in formatString. formatString happily
> wanders along the vector and falls off the end.
>
> I'm going to fix it in formatString, we may also want to fix it higher up.

No I'm not: formatString gets a C vector of strings, not an R vector. It
has to be fixed higher up.

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From denis@mail.cor.epa.gov  Fri Feb 16 17:09:14 2001
From: denis@mail.cor.epa.gov (Denis White)
Date: Fri, 16 Feb 2001 09:09:14 -0800 (PST)
Subject: [Rd] Re: polygon border colors
Message-ID: <Pine.SUN.3.91.1010216085824.11176B@okapi.cor.epa.gov>

I think I see in do_polygon() in plot.c that border colors are
not cycled, and that changes in the lines

...
    PROTECT(border = FixupCol(CAR(args), dd->gp.fg));	args = CDR(args);
...
		GPolygon(i-start, x+start, y+start, USER,
			 INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
...
	    GPolygon(nx-start, x+start, y+start, USER,
		     INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
...

following the pattern for "col" might make cycling possible.

Is this a change that I should try locally, or could this be
considered for the standard version?

thanks,

Denis

---------- Forwarded message ----------
Date: Thu, 15 Feb 2001 18:33:26 -0800 (PST)
From: Denis White <denis@mail.cor.epa.gov>
To: r-help@hypatia.math.ethz.ch
Subject: polygon border colors

Simple question: is it true that 

  polygon (x, y, col=vec, border=vec, ...)

will cycle through the vec colors for fills but not for
the border colors when sending multiple polygons?

thanks,

Denis White
   US EPA, 200 SW 35th St, Corvallis, Oregon, 97333 USA
   voice: 541.754.4476, email: white.denis@epa.gov
   web: www.epa.gov/wed/pages/staff/white/


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Feb 16 17:57:52 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 16 Feb 2001 12:57:52 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Peter Dalgaard BSA's message of "16 Feb 2001 13:03:48 +0100"
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
 <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk>
Message-ID: <pxwvaqse73.fsf@infiniti.ece.cmu.edu>


Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk> writes:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > > From: Adrian Trapletti <adrian@olsen.ch
> > 
> > > I don't know if it has something to do with this discussion, but it's
> > > probably worth reporting it.
> > > 
> > > Under
> > > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > > R : Version 1.2.1  (2001-01-15)
> > > Fvwm95 Version 2.0.43a
> > > the window manager always crashes when I close an x11() device started
> > > within R.
> > 
> > This discussion is about png() and jpeg() devices.  We've had other
> > reports about FVWM, though.
> 
> ...and they too refer to improper error handling by X11. I'm somewhat
> baffled by the effect reported, though. Surely, an application
> crashing the window manager is a bug in the latter, not the former?
> What we've heard of before is that closing X11 windows with the window
> manager crashes R, but this sounds like the other way around.

The question about freeing xd and dd comes indeed from my fiddling
with the X11 driver and understanding the code there...  As for the
current handleEvent: there are some events simply ignored (like the
DestroyNotify event) and some are not reaped due to the sequence of
events in X11_Close/R_ProcessEvents.  (And the way inclose is handled
is scary once you think of closing two windows at roughly the same
time...)  The events that linger after R is done shouldn't confuse the
window manager, though.

I've put my code, patches, comments, suggestions, etc. at:
http://www.ece.cmu.edu/~tov/public/R/X11andTk.html
I'd be curious whether R with the patched handleEvent still crashes
FVWM95.  Probably but who knows.

  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gs@statlab.uni-heidelberg.de  Fri Feb 16 18:12:29 2001
From: gs@statlab.uni-heidelberg.de (G. Sawitzki)
Date: Fri, 16 Feb 2001 19:12:29 +0100
Subject: [Rd] Re: R 1.2.2 (pre-release) available
In-Reply-To: <a05001900b6b3006ec3ab@[159.149.74.61]>
References: <a05001900b6b3006ec3ab@[159.149.74.61]>
Message-ID: <p05010400b6b31ca16507@[129.206.113.199]>

At 17:10 +0100 16.02.2001, Stefano Iacus wrote:
>A pre-release of R 1.2.2 based on the latest R-patched archive 
>(2/14/2001) for Macintosh is available at:
>
>http://www.eco-dip.unimi.it/R
>
>It is important to receive as much feedback as possible before R 
>1.2.2 is released.
>
>Stefano

Stefano,

the link to Waste does not work. The correct link is
http://www.merzwaren.com/bin/waste/waste-20b3.sit

(/bin/ is missing on you page).

I have three bugs from the previos version where it ran into a crash. 
Standard logs are in
	<ftp://max.statlab.uni-heidelberg.de/users/gs/>,
filenames startign with R. Maybe you can have a short look, but you 
should not spend too much time on these - they may already be fixed 
in the new version.
  gs.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From beebe@math.utah.edu  Sat Feb 17 00:44:15 2001
From: beebe@math.utah.edu (beebe@math.utah.edu)
Date: Sat, 17 Feb 2001 01:44:15 +0100 (MET)
Subject: [Rd] Comments on R-1.2.1 builds (PR#851)
Message-ID: <200102170044.BAA19310@pubhealth.ku.dk>

The R-1.2.1 builds have gone fairly smoothly on most of my UNIX
architectures, but there were many warnings reported by the picky SGI
compiler that could be eliminated in future releases.

Generally, I have found the SGI compilers very helpful in ferreting
out portability problems, unused and/or obsolete variables, unexpected
datatype coercions, etc., and they compile faster than any other
compilers too.

First, I configured like this:

env CC='c89 -mips3 -O3' ./configure && make all

This reports:

	R is now configured for mips-sgi-irix6.5

	  Source directory:          .
	  Installation directory:    /usr/local
	  C compiler:                c89 -mips3 -O3  -OPT:IEEE_NaN_inf=ON -g
	  C++ compiler:              c++  -g -O2
	  FORTRAN compiler:          g77  -OPT:IEEE_NaN_inf=ON -g -O2

	  X11 support:               yes
	  Gnome support:             no
	  Tcl/Tk support:            yes

	  R profiling support:       yes
	  R as a shared library:     no

The build proceeds until this failure:

	g77 -OPT:IEEE_NaN_inf=ON  -g -O2 -c ch2inv.f -o ch2inv.o
	f771: Invalid option `-OPT:IEEE_NaN_inf=ON'
	make[3]: *** [ch2inv.o] Error 1

Evidently, it was not prepared for the GNU Fortran compiler.

I started over with a new clean unpack of the distribution,
with

	env FC=f77 F77=f77 CC=c89 CXX=CC ./configure &&
		make all check install

and got a working build and install.  It reports

	R is now configured for mips-sgi-irix6.5

	  Source directory:          .
	  Installation directory:    /usr/local
	  C compiler:                c89  -OPT:IEEE_NaN_inf=ON -g
	  C++ compiler:              CC  -g
	  FORTRAN compiler:          f77  -OPT:IEEE_NaN_inf=ON -g

	  X11 support:               yes
	  Gnome support:             no
	  Tcl/Tk support:            yes

	  R profiling support:       yes
	  R as a shared library:     no


Here are the all the compiler warnings reported:

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/appl
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c chull.c -o chull.o
cc-1185 c89: WARNING File = chull.c, Line = 77
  An enumerated type is mixed with another type.

      Rboolean vert, neg_dir=0;
                             ^

cc-1185 c89: WARNING File = chull.c, Line = 84
  An enumerated type is mixed with another type.

      vert = (x[jj] == xt);
           ^

cc-1185 c89: WARNING File = chull.c, Line = 87
  An enumerated type is mixed with another type.

        neg_dir = ((s > 0 && d1 < 0.) || (s < 0 && d1 > 0.));
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c cpoly.c -o cpoly.o
cc-1185 c89: WARNING File = cpoly.c, Line = 490
  An enumerated type is mixed with another type.

      *bool = hypot(hvr, hvi) <= are * 10. * hypot(hr[n-1], hi[n-1]);
            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c lbfgsb.c -o lbfgsb.o
cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l1" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l2" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                    ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l3" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                        ^

cc-1551 c89: WARNING File = lbfgsb.c, Line = 687
  The variable "xstep" is used before its value is set.

                   nint, word, iback, stp, xstep, k);
                                           ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 582
  The variable "time" is set but never used.

      double time;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c pretty.c -o pretty.o
cc-1185 c89: WARNING File = pretty.c, Line = 82
  An enumerated type is mixed with another type.

        i_small = dx < cell * U * imax2(1,*ndiv) * DBL_EPSILON *3;
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c strsignif.c -o strsignif.o
cc-1552 c89: WARNING File = strsignif.c, Line = 80
  The variable "jL" is set but never used.

      int iex, j, jL, len_flag = strlen(*flag);
                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c uncmin.c -o uncmin.o
cc-1551 c89: WARNING File = uncmin.c, Line = 2443
  The variable "mxtake" is used before its value is set.

         steptl, sx, fscale, itnlim, iretcd, mxtake, msg);
                                             ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/nmath
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c polygamma.c -o polygamma.o
cc-1167 c89: WARNING File = polygamma.c, Line = 167
  Pointer points outside of underlying object.

  static double *b = (double *)&bvalues -1;
                                        ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/unix
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devices.c -o devices.o
cc-1185 c89: WARNING File = devices.c, Line = 111
  An enumerated type is mixed with another type.

                                 colormodel, maxcubesize)) {
                                 ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c edit.c -o edit.o
cc-1185 c89: WARNING File = edit.c, Line = 109
  An enumerated type is mixed with another type.

            t = deparse1(x, 0);
                            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c system.c -o system.o
cc-1185 c89: WARNING File = system.c, Line = 196
  An enumerated type is mixed with another type.

                UsingReadline = 0;
                              ^

cc-1185 c89: WARNING File = system.c, Line = 211
  An enumerated type is mixed with another type.

      R_Interactive = isatty(0);
                    ^

cc-1185 c89: WARNING File = system.c, Line = 234
  An enumerated type is mixed with another type.

      fpu_setup(1);
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c sys-common.c -o sys-common.o
cc-1185 c89: WARNING File = sys-common.c, Line = 173
  An enumerated type is mixed with another type.

      return stat(R_ExpandFileName(path), &sb) == 0;
             ^

cc-1185 c89: WARNING File = sys-common.c, Line = 188
  An enumerated type is mixed with another type.

      if (name && name[0] != '.') return 0;
                                         ^

cc-1185 c89: WARNING File = sys-common.c, Line = 189
  An enumerated type is mixed with another type.

      else return 1;
                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/main
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c RNG.c -o RNG.o
cc-1185 c89: WARNING File = RNG.c, Line = 63
  An enumerated type is mixed with another type.

      { 0, 0, "Wichmann-Hill",          3,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 63
  An enumerated type is mixed with another type.

      { 0, 0, "Wichmann-Hill",          3,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 64
  An enumerated type is mixed with another type.

      { 1, 0, "Marsaglia-MultiCarry",   2,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 64
  An enumerated type is mixed with another type.

      { 1, 0, "Marsaglia-MultiCarry",   2,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 65
  An enumerated type is mixed with another type.

      { 2, 0, "Super-Duper",            2,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 65
  An enumerated type is mixed with another type.

      { 2, 0, "Super-Duper",            2,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 66
  An enumerated type is mixed with another type.

      { 3, 0, "Mersenne-Twister",           1+624,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 66
  An enumerated type is mixed with another type.

      { 3, 0, "Mersenne-Twister",           1+624,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 67
  An enumerated type is mixed with another type.

      { 4, 0, "Knuth-TAOCP",          1+100,    dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 67
  An enumerated type is mixed with another type.

      { 4, 0, "Knuth-TAOCP",          1+100,    dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 68
  An enumerated type is mixed with another type.

      { 5, 0, "User-supplied",            0,    dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 68
  An enumerated type is mixed with another type.

      { 5, 0, "User-supplied",            0,    dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 264
  An enumerated type is mixed with another type.

        newRNG = tmp % 100;
               ^

cc-1185 c89: WARNING File = RNG.c, Line = 265
  An enumerated type is mixed with another type.

        newN01 = tmp / 100;
               ^

cc-1185 c89: WARNING File = RNG.c, Line = 382
  An enumerated type is mixed with another type.

        RNGkind(asInteger(rng));
                ^

cc-1185 c89: WARNING File = RNG.c, Line = 385
  An enumerated type is mixed with another type.

        Norm_kind(asInteger(norm));
                  ^

cc-1185 c89: WARNING File = RNG.c, Line = 404
  An enumerated type is mixed with another type.

        kind = asInteger(skind);
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c arithmetic.c -o arithmetic.o
cc-1185 c89: WARNING File = arithmetic.c, Line = 505
  An enumerated type is mixed with another type.

        x = complex_binary(PRIMVAL(op), x, y);
                           ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 511
  An enumerated type is mixed with another type.

            x = real_binary(PRIMVAL(op), x, y);
                            ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 514
  An enumerated type is mixed with another type.

            x = integer_binary(PRIMVAL(op), x, y);
                               ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 553
  An enumerated type is mixed with another type.

        return integer_unary(PRIMVAL(op), s1);
                             ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 555
  An enumerated type is mixed with another type.

        return real_unary(PRIMVAL(op), s1);
                          ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 557
  An enumerated type is mixed with another type.

        return complex_unary(PRIMVAL(op), s1);
                             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c array.c -o array.o
cc-1185 c89: WARNING File = array.c, Line = 98
  An enumerated type is mixed with another type.

        copyMatrix(snr, vals, byrow);
                              ^

cc-1185 c89: WARNING File = array.c, Line = 100
  An enumerated type is mixed with another type.

        copyListMatrix(snr, vals, byrow);
                                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c bind.c -o bind.o
cc-1185 c89: WARNING File = bind.c, Line = 496
  An enumerated type is mixed with another type.

        if (n != R_NilValue && pmatch(R_RecursiveSymbol, n, 1)) {
                                                            ^

cc-1185 c89: WARNING File = bind.c, Line = 505
  An enumerated type is mixed with another type.

        else if (n != R_NilValue &&  pmatch(R_UseNamesSymbol, n, 1)) {
                                                                 ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c builtin.c -o builtin.o
cc-1185 c89: WARNING File = builtin.c, Line = 573
  An enumerated type is mixed with another type.

            if (TAG(y) != R_NilValue && pmatch(STRING_ELT(x, 0), TAG(y), 1)) {
                                                                         ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c character.c -o character.o
cc-1552 c89: WARNING File = character.c, Line = 368
  The variable "uclass" is set but never used.

      int i, len, minlen, uclass;
                          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c coerce.c -o coerce.o
cc-1185 c89: WARNING File = coerce.c, Line = 703
  An enumerated type is mixed with another type.

                SET_STRING_ELT(rval, i, STRING_ELT(deparse1(CAR(vp), 0), 0));
                                        ^

cc-1185 c89: WARNING File = coerce.c, Line = 776
  An enumerated type is mixed with another type.

                               STRING_ELT(deparse1(VECTOR_ELT(v, i), 0), 0));
                               ^

cc-1185 c89: WARNING File = coerce.c, Line = 902
  An enumerated type is mixed with another type.

        x = install(CHAR(STRING_ELT(deparse1(x, 1), 0)));
                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c connections.c -o connections.o
cc-1185 c89: WARNING File = connections.c, Line = 127
  An enumerated type is mixed with another type.

      con->canwrite = (con->mode[0] == 'w' || con->mode[0] == 'a');
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 128
  An enumerated type is mixed with another type.

      con->canread = !con->canwrite;
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 291
  An enumerated type is mixed with another type.

      con->canwrite = (con->mode[0] == 'w');
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 292
  An enumerated type is mixed with another type.

      con->canread = !con->canwrite;
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 494
  An enumerated type is mixed with another type.

      new->canread = (strcmp(mode, "r") == 0);
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 495
  An enumerated type is mixed with another type.

      new->canwrite = (strcmp(mode, "w") == 0);
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 772
  An enumerated type is mixed with another type.

            con->incomplete = strlen(this->lastline) > 0;
                            ^

cc-1552 c89: WARNING File = connections.c, Line = 855
  The variable "con" is set but never used.

      Rconnection con = NULL;
                  ^

cc-1185 c89: WARNING File = connections.c, Line = 910
  An enumerated type is mixed with another type.

      con->blocking = block;
                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devPS.c -o devPS.o
cc-1185 c89: WARNING File = devPS.c, Line = 978
  An enumerated type is mixed with another type.

      dd->dp.canResizePlot = 0;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 979
  An enumerated type is mixed with another type.

      dd->dp.canChangeFont = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 980
  An enumerated type is mixed with another type.

      dd->dp.canRotateText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 981
  An enumerated type is mixed with another type.

      dd->dp.canResizeText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 982
  An enumerated type is mixed with another type.

      dd->dp.canClip = 1;
                     ^

cc-1552 c89: WARNING File = devPS.c, Line = 823
  The variable "setfill" is set but never used.

      rcolor setbg, setfg, setfill;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1328
  An enumerated type is mixed with another type.

        GConvert(&x0, &y0, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1329
  An enumerated type is mixed with another type.

        GConvert(&x1, &y1, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1356
  An enumerated type is mixed with another type.

        GConvert(&x, &y, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1367
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1368
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1405
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1410
  An enumerated type is mixed with another type.

            GConvert(&xx, &yy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1430
  An enumerated type is mixed with another type.

      GConvert(&xx, &yy, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1435
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1446
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devPS.c, Line = 1662
  An enumerated type is mixed with another type.

        return 0;
               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1788
  An enumerated type is mixed with another type.

      dd->dp.canResizePlot = 0;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1789
  An enumerated type is mixed with another type.

      dd->dp.canChangeFont = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1790
  An enumerated type is mixed with another type.

      dd->dp.canRotateText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1791
  An enumerated type is mixed with another type.

      dd->dp.canResizeText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1792
  An enumerated type is mixed with another type.

      dd->dp.canClip = 0;
                     ^

cc-1185 c89: WARNING File = devPS.c, Line = 1802
  An enumerated type is mixed with another type.

        return 0;
               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1826
  An enumerated type is mixed with another type.

      return 1;
             ^

cc-1185 c89: WARNING File = devPS.c, Line = 1976
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd); XFconvert(&x0, &y0, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1977
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd); XFconvert(&x1, &y1, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2004
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd); XFconvert(&x, &y, pd);
                       ^

cc-1185 c89: WARNING File = devPS.c, Line = 2023
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd); XFconvert(&x1, &y1, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2024
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd); XFconvert(&x2, &y2, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2058
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd); XFconvert(&xx, &yy, pd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 2080
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd); XFconvert(&xx, &yy, pd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 2101
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd); XFconvert(&x, &y, pd);
                       ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devPicTeX.c -o devPicTeX.o
cc-1185 c89: WARNING File = devPicTeX.c, Line = 409
  An enumerated type is mixed with another type.

        GConvert(&x1, &y1, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 410
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 437
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 441
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 502
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 519
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 523
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 533
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 585
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c deparse.c -o deparse.o
cc-1185 c89: WARNING File = deparse.c, Line = 153
  An enumerated type is mixed with another type.

      ca1 = deparse1(ca1, 0);
                          ^

cc-1185 c89: WARNING File = deparse.c, Line = 222
  An enumerated type is mixed with another type.

      tval = deparse1(tval, 0);
                            ^

cc-1185 c89: WARNING File = deparse.c, Line = 229
  An enumerated type is mixed with another type.

      wasopen = 1;
              ^

cc-1185 c89: WARNING File = deparse.c, Line = 274
  An enumerated type is mixed with another type.

            tval = deparse1(CAR(o), 0);
                                    ^

cc-1185 c89: WARNING File = deparse.c, Line = 289
  An enumerated type is mixed with another type.

            tval = deparse1(CAR(o), 0);
                                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devices.c -o devices.o
cc-1185 c89: WARNING File = devices.c, Line = 107
  An enumerated type is mixed with another type.

                           width, height, (double)horizontal, ps, onefile,
                                          ^

cc-1185 c89: WARNING File = devices.c, Line = 107
  An enumerated type is mixed with another type.

                           width, height, (double)horizontal, ps, onefile,
                                                                  ^

cc-1185 c89: WARNING File = devices.c, Line = 108
  An enumerated type is mixed with another type.

                           pagecentre, printit, cmd)) {
                           ^

cc-1185 c89: WARNING File = devices.c, Line = 108
  An enumerated type is mixed with another type.

                           pagecentre, printit, cmd)) {
                                       ^

cc-1185 c89: WARNING File = devices.c, Line = 145
  An enumerated type is mixed with another type.

      debug = asLogical(CAR(args));    args = CDR(args);
            ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                             ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                                                     ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                                                              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c dotcode.c -o dotcode.o
cc-1552 c89: WARNING File = dotcode.c, Line = 369
  The variable "fun" is set but never used.

      DL_FUNC fun;
              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c dstruct.c -o dstruct.o
cc-1552 c89: WARNING File = dstruct.c, Line = 111
  The variable "rval" is set but never used.

      int rval;
          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c errors.c -o errors.o
cc-1185 c89: WARNING File = errors.c, Line = 197
  An enumerated type is mixed with another type.

            dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                    ^

cc-1552 c89: WARNING File = errors.c, Line = 161
  The variable "slen" is set but never used.

      int w, slen;
             ^

cc-1185 c89: WARNING File = errors.c, Line = 238
  An enumerated type is mixed with another type.

                CHAR(STRING_ELT(deparse1(VECTOR_ELT(R_Warnings, 0),0), 0)));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 248
  An enumerated type is mixed with another type.

                   CHAR(STRING_ELT(deparse1(VECTOR_ELT(R_Warnings,i), 0), 0)));
                   ^

cc-1185 c89: WARNING File = errors.c, Line = 291
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 407
  An enumerated type is mixed with another type.

            SETCAR(t, deparse1(c->call, 0));
                                        ^

cc-1185 c89: WARNING File = errors.c, Line = 534
  An enumerated type is mixed with another type.

      { ERROR_NUMARGS,          "invalid number of arguments"           },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 535
  An enumerated type is mixed with another type.

      { ERROR_ARGTYPE,          "invalid argument type"                 },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 537
  An enumerated type is mixed with another type.

      { ERROR_TSVEC_MISMATCH,   "time-series/vector length mismatch"    },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 538
  An enumerated type is mixed with another type.

      { ERROR_INCOMPAT_ARGS,    "incompatible arguments"                },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 540
  An enumerated type is mixed with another type.

      { ERROR_UNIMPLEMENTED,    "unimplemented feature in %s"           },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 541
  An enumerated type is mixed with another type.

      { ERROR_UNKNOWN,          "unknown error (report this!)"          }
        ^

cc-1185 c89: WARNING File = errors.c, Line = 565
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 591
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c eval.c -o eval.o
cc-1552 c89: WARNING File = eval.c, Line = 372
  The variable "i" is set but never used.

      int i;
          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c fourier.c -o fourier.o
cc-1185 c89: WARNING File = fourier.c, Line = 187
  An enumerated type is mixed with another type.

      return n == 1;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c g_cntrlify.c -o g_cntrlify.o
cc-1552 c89: WARNING File = g_cntrlify.c, Line = 88
  The variable "previous_raw_fontnum" is set but never used.

    int previous_raw_fontnum;   /* implement depth-1 stack */
        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c g_alab_her.c -o g_alab_her.o
cc-1185 c89: WARNING File = g_alab_her.c, Line = 91
  An enumerated type is mixed with another type.

                 GConvertXUnits(HERSHEY_X_UNITS_TO_USER_UNITS (deltax),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 92
  An enumerated type is mixed with another type.

                                g_unit, INCHES, dd),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 93
  An enumerated type is mixed with another type.

                 GConvertYUnits(HERSHEY_Y_UNITS_TO_USER_UNITS (deltay),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 94
  An enumerated type is mixed with another type.

                                g_unit, INCHES, dd));
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 180
  An enumerated type is mixed with another type.

      return( HERSHEY_Y_UNITS_TO_USER_UNITS(HERSHEY_LARGE_CAPHEIGHT) );
              ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 247
  An enumerated type is mixed with another type.

    GConvert(&currX, &currY, g_unit, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 329
  An enumerated type is mixed with another type.

                    GConvertXUnits(x_offset * label_width, g_unit, INCHES, dd),
                                                           ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 330
  An enumerated type is mixed with another type.

                    GConvertYUnits(y_offset * label_height, g_unit, INCHES, dd));
                                                            ^

cc-1552 c89: WARNING File = g_alab_her.c, Line = 226
  The variable "x_displacement" is set but never used.

    double x_displacement;
           ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 547
  An enumerated type is mixed with another type.

    return HERSHEY_X_UNITS_TO_USER_UNITS (width);
           ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c graphics.c -o graphics.o
cc-1185 c89: WARNING File = graphics.c, Line = 121
  An enumerated type is mixed with another type.

      default:  return 0;
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 1280
  An enumerated type is mixed with another type.

      return allCmWidths(dd) && allCmHeights(dd);
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1285
  An enumerated type is mixed with another type.

      return noCmWidths(dd) && noCmHeights(dd);
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1693
  An enumerated type is mixed with another type.

      return ((dd->gp.fig[0] > 0-FLT_EPSILON) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1703
  An enumerated type is mixed with another type.

      return ((dd->gp.fig[0] < dd->gp.fig[1]) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1711
  An enumerated type is mixed with another type.

      return ((dd->gp.plt[0] > 0-FLT_EPSILON) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1721
  An enumerated type is mixed with another type.

      return ((dd->gp.plt[0] < dd->gp.plt[1]) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1832
  An enumerated type is mixed with another type.

      Rboolean swap, is_xaxis = (axis == 1 || axis == 3);
                                ^

cc-1185 c89: WARNING File = graphics.c, Line = 1921
  An enumerated type is mixed with another type.

      swap = min > max;
           ^

cc-1185 c89: WARNING File = graphics.c, Line = 1982
  An enumerated type is mixed with another type.

      Rboolean is_xaxis = (axis == 1 || axis == 3);
                          ^

cc-1185 c89: WARNING File = graphics.c, Line = 2263
  An enumerated type is mixed with another type.

      dd->gp.ann = annsave;
                 ^

cc-1185 c89: WARNING File = graphics.c, Line = 2373
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NPC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2374
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NPC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2377
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NFC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2378
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NFC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2381
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NDC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2382
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NDC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2630
  An enumerated type is mixed with another type.

        GConvert(x, y, DEVICE, coords, dd);
                               ^

cc-1185 c89: WARNING File = graphics.c, Line = 2770
  An enumerated type is mixed with another type.

                clipPoint (b + 1, ix, iy, xout, yout, cnt, store,
                           ^

cc-1185 c89: WARNING File = graphics.c, Line = 2789
  An enumerated type is mixed with another type.

            clipPoint (b + 1, x, y, xout, yout, cnt, store, clip, cs);
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 2812
  An enumerated type is mixed with another type.

                clipPoint (b + 1, ix, iy, xout, yout, cnt, store, clip, cs);
                           ^

cc-1185 c89: WARNING File = graphics.c, Line = 2986
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 3054
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3118
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3119
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3349
  An enumerated type is mixed with another type.

        GConvert(&x, &y, coords, INCHES, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3478
  An enumerated type is mixed with another type.

      GConvert(&xfromInch, &yfromInch, coords, INCHES, dd);
                                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 3479
  An enumerated type is mixed with another type.

      GConvert(&xtoInch, &ytoInch, coords, INCHES, dd);
                                   ^

cc-1185 c89: WARNING File = graphics.c, Line = 3699
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3715
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3727
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3739
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3746
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3753
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3763
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3775
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3784
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3794
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3807
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3814
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3831
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3841
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3848
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3859
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3875
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3888
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3916
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3923
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3934
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3947
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1552 c89: WARNING File = graphics.c, Line = 5189
  The variable "s" is set but never used.

      SEXP s, t;
           ^

cc-1552 c89: WARNING File = graphics.c, Line = 4138
  The variable "ColorDataBaseSize" is set but never used.

  static int ColorDataBaseSize;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c main.c -o main.o
cc-1185 c89: WARNING File = main.c, Line = 671
  An enumerated type is mixed with another type.

      R_CleanUp(ask, status, runLast);
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c match.c -o match.o
cc-1185 c89: WARNING File = match.c, Line = 119
  An enumerated type is mixed with another type.

           psmatch(tag, CHAR(PRINTNAME(TAG(*list))), 0)) {
                                                     ^

cc-1185 c89: WARNING File = match.c, Line = 129
  An enumerated type is mixed with another type.

          psmatch(tag, CHAR(PRINTNAME(TAG(next))), 0)) {
                                                   ^

cc-1185 c89: WARNING File = match.c, Line = 189
  An enumerated type is mixed with another type.

                if (TAG(b) != R_NilValue && pmatch(TAG(f), TAG(b), 1)) {
                                                                   ^

cc-1185 c89: WARNING File = match.c, Line = 226
  An enumerated type is mixed with another type.

                        pmatch(TAG(f), TAG(b), seendots)) {
                                               ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c memory.c -o memory.o
cc-1185 c89: WARNING File = memory.c, Line = 831
  An enumerated type is mixed with another type.

      return TYPEOF(fun) == CHARSXP;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c model.c -o model.o
cc-1552 c89: WARNING File = model.c, Line = 280
  The variable "tmp" is set but never used.

      unsigned tmp;
               ^

cc-1185 c89: WARNING File = model.c, Line = 909
  An enumerated type is mixed with another type.

            SET_STRING_ELT(varnames, i++, STRING_ELT(deparse1line(CAR(v), 0), 0));
                                          ^

cc-1552 c89: WARNING File = model.c, Line = 739
  The variable "abb" is set but never used.

      SEXP specials, t, abb, data;
                        ^

cc-1552 c89: WARNING File = model.c, Line = 1483
  The variable "v" is set but never used.

      SEXP expr, factors, terms, v, vars, vnames, assign;
                                 ^

cc-1552 c89: WARNING File = model.c, Line = 46
  The variable "identSymbol" is set but never used.

  static SEXP identSymbol = NULL;
              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c names.c -o names.o
cc-1185 c89: WARNING File = names.c, Line = 747
  An enumerated type is mixed with another type.

  {NULL,                NULL,           0,      0,      0,      0},
                                                                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c objects.c -o objects.o
cc-1185 c89: WARNING File = objects.c, Line = 50
  An enumerated type is mixed with another type.

            if (TAG(b) != R_NilValue && pmatch(tag, TAG(b), 1)) {
                                                            ^

cc-1185 c89: WARNING File = objects.c, Line = 60
  An enumerated type is mixed with another type.

                if (TAG(b) != R_NilValue && pmatch(tag, TAG(b), 0)) {
                                                                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c optim.c -o optim.o
cc-1185 c89: WARNING File = optim.c, Line = 514
  An enumerated type is mixed with another type.

            accpoint = FALSE;
                     ^

cc-1185 c89: WARNING File = optim.c, Line = 525
  An enumerated type is mixed with another type.

                    accpoint = R_FINITE(f) &&
                             ^

cc-1185 c89: WARNING File = optim.c, Line = 532
  An enumerated type is mixed with another type.

            enough = (f > abstol) &&
                   ^

cc-1185 c89: WARNING File = optim.c, Line = 610
  An enumerated type is mixed with another type.

      Rboolean calcvert, shrinkfail = FALSE;
                                      ^

cc-1185 c89: WARNING File = optim.c, Line = 662
  An enumerated type is mixed with another type.

        calcvert = TRUE;
                 ^

cc-1185 c89: WARNING File = optim.c, Line = 663
  An enumerated type is mixed with another type.

        shrinkfail = FALSE;
                   ^

cc-1185 c89: WARNING File = optim.c, Line = 676
  An enumerated type is mixed with another type.

                calcvert = FALSE;
                         ^

cc-1185 c89: WARNING File = optim.c, Line = 757
  An enumerated type is mixed with another type.

                            calcvert = TRUE;
                                     ^

cc-1185 c89: WARNING File = optim.c, Line = 768
  An enumerated type is mixed with another type.

                                shrinkfail = FALSE;
                                           ^

cc-1185 c89: WARNING File = optim.c, Line = 773
  An enumerated type is mixed with another type.

                                shrinkfail = TRUE;
                                           ^

cc-1552 c89: WARNING File = optim.c, Line = 618
  The variable "VN" is set but never used.

      double VH, VL, VN, VR;
                     ^

cc-1185 c89: WARNING File = optim.c, Line = 901
  An enumerated type is mixed with another type.

                    accpoint = FALSE;
                             ^

cc-1185 c89: WARNING File = optim.c, Line = 912
  An enumerated type is mixed with another type.

                            accpoint = (R_FINITE(f) &&
                                     ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c options.c -o options.o
cc-1185 c89: WARNING File = options.c, Line = 249
  An enumerated type is mixed with another type.

      R_KeepSource = (p && (strcmp(p, "yes") == 0)) ? 1 : 0;
                   ^

cc-1185 c89: WARNING File = options.c, Line = 371
  An enumerated type is mixed with another type.

                R_KeepSource = k;
                             ^

cc-1185 c89: WARNING File = options.c, Line = 433
  An enumerated type is mixed with another type.

                R_Slave = !k;
                        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c par.c -o par.o
cc-1185 c89: WARNING File = par.c, Line = 151
  An enumerated type is mixed with another type.

        dd->dp.ann = dd->gp.ann = (ix != 0);/* NA |-> TRUE */
                                ^

cc-1185 c89: WARNING File = par.c, Line = 155
  An enumerated type is mixed with another type.

        dd->dp.ask = dd->gp.ask = (ix == 1);/* NA |-> FALSE */
                                ^

cc-1185 c89: WARNING File = par.c, Line = 263
  An enumerated type is mixed with another type.

            dd->gp.defaultFigure = dd->dp.defaultFigure = 0;
                                                        ^

cc-1185 c89: WARNING File = par.c, Line = 286
  An enumerated type is mixed with another type.

        dd->gp.defaultFigure = dd->dp.defaultFigure = 0;
                                                    ^

cc-1185 c89: WARNING File = par.c, Line = 493
  An enumerated type is mixed with another type.

        dd->gp.new = dd->dp.new = 1;
                                ^

cc-1185 c89: WARNING File = par.c, Line = 530
  An enumerated type is mixed with another type.

        dd->dp.new = dd->gp.new = (ix != 0);
                                ^

cc-1185 c89: WARNING File = par.c, Line = 762
  An enumerated type is mixed with another type.

        dd->dp.xlog = dd->gp.xlog = (ix != 0);
                                  ^

cc-1185 c89: WARNING File = par.c, Line = 802
  An enumerated type is mixed with another type.

        dd->dp.ylog = dd->gp.ylog = (ix != 0);
                                  ^

cc-1185 c89: WARNING File = par.c, Line = 826
  An enumerated type is mixed with another type.

        dd->gp.ann = (ix != 0);
                   ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plot.c -o plot.o
cc-1185 c89: WARNING File = plot.c, Line = 442
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1552 c89: WARNING File = plot.c, Line = 611
  The variable "save_digits" is set but never used.

      int save_digits, i, n, w, d, e, wi, di, ei;
          ^

cc-1185 c89: WARNING File = plot.c, Line = 871
  An enumerated type is mixed with another type.

      doticks = asLogical(CAR(args));
              ^

cc-1185 c89: WARNING File = plot.c, Line = 1029
  An enumerated type is mixed with another type.

                axis_base = GConvertY(0.0, outer, NFC, dd)
                                           ^

cc-1185 c89: WARNING File = plot.c, Line = 1040
  An enumerated type is mixed with another type.

                axis_base =  GConvertY(1.0, outer, NFC, dd)
                                            ^

cc-1185 c89: WARNING File = plot.c, Line = 1129
  An enumerated type is mixed with another type.

                axis_base =  GConvertX(0.0, outer, NFC, dd)
                                            ^

cc-1185 c89: WARNING File = plot.c, Line = 1140
  An enumerated type is mixed with another type.

                axis_base =  GConvertX(1.0, outer, NFC, dd)
                                            ^

cc-1552 c89: WARNING File = plot.c, Line = 810
  The variable "col" is set but never used.

      int col, fg, font;
          ^

cc-1552 c89: WARNING File = plot.c, Line = 814
  The variable "vectorFonts" is set but never used.

      Rboolean vectorFonts = FALSE;
               ^

cc-1552 c89: WARNING File = plot.c, Line = 1769
  The variable "nborder" is set but never used.

      int ncol, nborder, nlty, xpd, i, start=0;
                ^

cc-1552 c89: WARNING File = plot.c, Line = 1769
  The variable "nlty" is set but never used.

      int ncol, nborder, nlty, xpd, i, start=0;
                         ^

cc-1552 c89: WARNING File = plot.c, Line = 2620
  The variable "fg" is set but never used.

      int which, col, fg;
                      ^

cc-1185 c89: WARNING File = plot.c, Line = 2932
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1185 c89: WARNING File = plot.c, Line = 2968
  An enumerated type is mixed with another type.

      dd->dp.defaultPlot = dd->gp.defaultPlot = 1;
                                              ^

cc-1552 c89: WARNING File = plot.c, Line = 2911
  The variable "save_mUnits" is set but never used.

      int save_mUnits, save_defaultPlot;
          ^

cc-1552 c89: WARNING File = plot.c, Line = 2911
  The variable "save_defaultPlot" is set but never used.

      int save_mUnits, save_defaultPlot;
                       ^

cc-1552 c89: WARNING File = plot.c, Line = 3316
  The variable "ncol" is set but never used.

      int ncol;
          ^

cc-1185 c89: WARNING File = plot.c, Line = 3359
  An enumerated type is mixed with another type.

        dd->gp.ask = 1;
                   ^

cc-1185 c89: WARNING File = plot.c, Line = 3369
  An enumerated type is mixed with another type.

        dd->gp.ask = ask;
                   ^

cc-1185 c89: WARNING File = plot.c, Line = 3512
  An enumerated type is mixed with another type.

                GConvert(&xx, &yy, USER, units, dd);
                                         ^

cc-1185 c89: WARNING File = plot.c, Line = 3515
  An enumerated type is mixed with another type.

                    rx = GConvertXUnits(0.5 * p0, INCHES, units, dd);
                                                          ^

cc-1185 c89: WARNING File = plot.c, Line = 3516
  An enumerated type is mixed with another type.

                    ry = GConvertYUnits(0.5 * p0, INCHES, units, dd);
                                                          ^

cc-1185 c89: WARNING File = plot.c, Line = 3519
  An enumerated type is mixed with another type.

                    rx = GConvertXUnits(0.5 * p0, USER, units, dd);
                                                        ^

cc-1185 c89: WARNING File = plot.c, Line = 3520
  An enumerated type is mixed with another type.

                    ry = GConvertYUnits(0.5 * p0, USER, units, dd);
                                                        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plot3d.c -o plot3d.o
cc-1552 c89: WARNING File = plot3d.c, Line = 193
  The variable "q1" is set but never used.

      double Ax, Bx, Ay, By, ax, ay, bx, by, q1, q2;
                                             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 193
  The variable "q2" is set but never used.

      double Ax, Bx, Ay, By, ax, ay, bx, by, q1, q2;
                                                 ^

cc-1552 c89: WARNING File = plot3d.c, Line = 479
  The variable "ns2" is set but never used.

      int i, ii, j, jj, k, l, m, nacode, ns, ns2, dir;
                                             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 484
  The variable "deltaXC" is set but never used.

      double dXC, dYC, deltaXC, deltaYC;
                       ^

cc-1552 c89: WARNING File = plot3d.c, Line = 484
  The variable "deltaYC" is set but never used.

      double dXC, dYC, deltaXC, deltaYC;
                                ^

cc-1552 c89: WARNING File = plot3d.c, Line = 487
  The variable "sum" is set but never used.

      double squareSum, sum;
                        ^

cc-1552 c89: WARNING File = plot3d.c, Line = 490
  The variable "zeroCount" is set but never used.

      int zeroCount;
          ^

cc-1552 c89: WARNING File = plot3d.c, Line = 492
  The variable "avg" is set but never used.

      double avg;
             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 1328
  The variable "nz" is set but never used.

      int i, j, k, npt, nx, ny, nz, nc, ncol, colsave, xpdsave;
                                ^

cc-1185 c89: WARNING File = plot3d.c, Line = 2201
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1552 c89: WARNING File = plot3d.c, Line = 47
  The variable "gcall" is set but never used.

  static SEXP gcall;
              ^

cc-1552 c89: WARNING File = plot3d.c, Line = 313
  The variable "ctr_xtol" is set but never used.

  static double ctr_xtol;
                ^

cc-1552 c89: WARNING File = plot3d.c, Line = 314
  The variable "ctr_ytol" is set but never used.

  static double ctr_ytol;
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plotmath.c -o plotmath.o
cc-1185 c89: WARNING File = plotmath.c, Line = 916
  An enumerated type is mixed with another type.

      return MathDevice->gp.font;
             ^

cc-1185 c89: WARNING File = plotmath.c, Line = 921
  An enumerated type is mixed with another type.

      FontType prevfont = MathDevice->gp.font;
                          ^

cc-1552 c89: WARNING File = plotmath.c, Line = 1380
  The variable "s5" is set but never used.

      double v, s5, s16;
                ^

cc-1551 c89: WARNING File = plotmath.c, Line = 1926
  The variable "ansBBox" is used before its value is set.

        return ansBBox;/*never reached*/
               ^

cc-1552 c89: WARNING File = plotmath.c, Line = 2275
  The variable "radDepth" is set but never used.

      double radWidth, radHeight, radDepth;
                                  ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2543
  An enumerated type is mixed with another type.

      SetFont(prevfont);
              ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2564
  An enumerated type is mixed with another type.

      SetFont(prevfont);
              ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2907
  An enumerated type is mixed with another type.

      GConvert(&ReferenceX, &ReferenceY, coords, INCHES, dd);
                                         ^

cc-1552 c89: WARNING File = plotmath.c, Line = 38
  The variable "BoxColor" is set but never used.

  static unsigned int BoxColor;
                      ^

cc-1552 c89: WARNING File = plotmath.c, Line = 39
  The variable "TextColor" is set but never used.

  static unsigned int TextColor;
                      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c print.c -o print.o
cc-1552 c89: WARNING File = print.c, Line = 81
  The variable "append_" is set but never used.

      int  append_, ifile, closeOnExit;
           ^

cc-1185 c89: WARNING File = print.c, Line = 446
  An enumerated type is mixed with another type.

      u = deparse1(s, 0);
                      ^

cc-1185 c89: WARNING File = print.c, Line = 487
  An enumerated type is mixed with another type.

            t = deparse1(s, 0);
                            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c printarray.c -o printarray.o
cc-1552 c89: WARNING File = printarray.c, Line = 448
  The variable "ii" is set but never used.

      SEXP ii, nn, dn, dnn;
           ^

cc-1552 c89: WARNING File = printarray.c, Line = 448
  The variable "nn" is set but never used.

      SEXP ii, nn, dn, dnn;
               ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c regex.c -o regex.o
cc-1552 c89: WARNING File = regex.c, Line = 4922
  The variable "pdummy" is set but never used.

              unsigned char *pdummy;
                             ^

cc-1552 c89: WARNING File = regex.c, Line = 4923
  The variable "sdummy" is set but never used.

              const char *sdummy;
                          ^

cc-1548 c89: WARNING File = regex.c, Line = 5245
  The transfer of control bypasses...

            ... the initialization of variable "same_str_p" (declared at line
                      4130).
      goto restore_best_regs;
      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c relop.c -o relop.o
cc-1185 c89: WARNING File = relop.c, Line = 59
  An enumerated type is mixed with another type.

        SEXP ans = real_relop(PRIMVAL(op), x, y);
                              ^

cc-1185 c89: WARNING File = relop.c, Line = 67
  An enumerated type is mixed with another type.

        SET_STRING_ELT(tmp, 0, (iS) ? PRINTNAME(x) : deparse1(x, 0));
                                                                 ^

cc-1185 c89: WARNING File = relop.c, Line = 74
  An enumerated type is mixed with another type.

        SET_STRING_ELT(tmp, 0, (iS) ? PRINTNAME(y) : deparse1(y, 0));
                                                                 ^

cc-1185 c89: WARNING File = relop.c, Line = 123
  An enumerated type is mixed with another type.

            mismatch = ((nx > ny) ? nx % ny : ny % nx) != 0;
                     ^

cc-1185 c89: WARNING File = relop.c, Line = 155
  An enumerated type is mixed with another type.

        x = string_relop(PRIMVAL(op), x, y);
                         ^

cc-1185 c89: WARNING File = relop.c, Line = 160
  An enumerated type is mixed with another type.

        x = complex_relop(PRIMVAL(op), x, y);
                          ^

cc-1185 c89: WARNING File = relop.c, Line = 165
  An enumerated type is mixed with another type.

        x = real_relop(PRIMVAL(op), x, y);
                       ^

cc-1185 c89: WARNING File = relop.c, Line = 168
  An enumerated type is mixed with another type.

        x = integer_relop(PRIMVAL(op), x, y);
                          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c saveload.c -o saveload.o
cc-1552 c89: WARNING File = saveload.c, Line = 1600
  The variable "d1234" is set but never used.

      int d1, d2, d3, d4, d1234;
                          ^

cc-1552 c89: WARNING File = saveload.c, Line = 44
  The variable "NVSize" is set but never used.

  static int NVSize;            /* Number of vector cells */
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c source.c -o source.o
cc-1552 c89: WARNING File = source.c, Line = 45
  The variable "pstacktop" is set but never used.

      int ifile, num, pstacktop, status;
                      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c subassign.c -o subassign.o
cc-1185 c89: WARNING File = subassign.c, Line = 157
  An enumerated type is mixed with another type.

      Rboolean redo_which =  (level == 1);
                             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c unique.c -o unique.o
cc-1185 c89: WARNING File = unique.c, Line = 625
  An enumerated type is mixed with another type.

        b = deparse1(funcall, 1);
                              ^

cc-1185 c89: WARNING File = unique.c, Line = 655
  An enumerated type is mixed with another type.

        b = deparse1(b, 1);
                        ^

cc-1185 c89: WARNING File = unique.c, Line = 663
  An enumerated type is mixed with another type.

        b = deparse1(CADDR(args), 1);
                                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c util.c -o util.o
cc-1185 c89: WARNING File = util.c, Line = 235
  An enumerated type is mixed with another type.

      return isString(x) && LENGTH(x) > 0 && !isNull(STRING_ELT(x, 0));
             ^

cc-1185 c89: WARNING File = util.c, Line = 241
  An enumerated type is mixed with another type.

      return isValidString(x) && CHAR(STRING_ELT(x, 0))[0];
             ^

cc-1185 c89: WARNING File = util.c, Line = 246
  An enumerated type is mixed with another type.

      return TYPEOF(s) == SYMSXP;
             ^

cc-1185 c89: WARNING File = util.c, Line = 263
  An enumerated type is mixed with another type.

      return (s == R_NilValue ||
             ^

cc-1185 c89: WARNING File = util.c, Line = 270
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == CLOSXP ||
             ^

cc-1185 c89: WARNING File = util.c, Line = 278
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == LISTSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 284
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == VECSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 358
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == NILSXP || TYPEOF(s) == ENVSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 364
  An enumerated type is mixed with another type.

      return TYPEOF(s) == EXPRSXP;
             ^

cc-1185 c89: WARNING File = util.c, Line = 370
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == LANGSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 400
  An enumerated type is mixed with another type.

      return (isVector(s) && getAttrib(s, R_TspSymbol) != R_NilValue);
             ^

cc-1185 c89: WARNING File = util.c, Line = 408
  An enumerated type is mixed with another type.

        return INTEGER(x)[0] == INTEGER(x)[0] &&
               ^

cc-1185 c89: WARNING File = util.c, Line = 433
  An enumerated type is mixed with another type.

        return mode;
               ^

cc-1185 c89: WARNING File = util.c, Line = 441
  An enumerated type is mixed with another type.

        return mode;
               ^

cc-1185 c89: WARNING File = util.c, Line = 522
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == STRSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 528
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == LGLSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 534
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP && !inherits(s, "factor"));
             ^

cc-1185 c89: WARNING File = util.c, Line = 540
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == REALSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 546
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == CPLXSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 552
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP
             ^

cc-1185 c89: WARNING File = util.c, Line = 560
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP
             ^

cc-1185 c89: WARNING File = util.c, Line = 568
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP  && inherits(s, "factor"));
             ^

cc-1185 c89: WARNING File = util.c, Line = 574
  An enumerated type is mixed with another type.

      return OBJECT(s);/* really `1-bit unsigned int' */
             ^

cc-1185 c89: WARNING File = util.c, Line = 667
  An enumerated type is mixed with another type.

      else return CHAR(x)[0] == '\0';
                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/unix/X11
c89   -o R.bin  RNG.o apply.o arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o connections.o context.o cov.o cum.o datetime.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o g_her_glyph.o g_fontdb.o g_cntrlify.o g_alab_her.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optim.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o regex.o relop.o saveload.o scan.o seq.o size.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o xxxpr.o ../unix/libunix.a ../appl/libappl.a ../nmath/libnmath.a -lcomplib.sgimath -LANG:=f77 -L/usr/lib32/mips3/r4000 -L/usr/lib32/mips3 -L/usr/lib32 -lftn -lm  -L/usr/local/lib  -lz -ldl -lncurses -lm
ld32: WARNING 84 : /usr/lib32/libz.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/lib32/libdl.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/local/lib/libncurses.a is not used for resolving any symbol.
------------------------------------------------------------------------
c89 -I. -I../../../src/include -I../../../src/include  -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON -KPIC  -g -c dataentry.c -o dataentry.o
cc-1185 c89: WARNING File = dataentry.c, Line = 843
  An enumerated type is mixed with another type.

            Rboolean warn = !isBlankString(endp);
                            ^

cc-1552 c89: WARNING File = dataentry.c, Line = 1240
  The variable "i" is set but never used.

      int i;
          ^

cc-1552 c89: WARNING File = dataentry.c, Line = 1250
  The variable "i" is set but never used.

      int i;
          ^

cc-1552 c89: WARNING File = dataentry.c, Line = 148
  The variable "hand_cursor" is set but never used.

  static Cursor           hand_cursor;
                          ^

------------------------------------------------------------------------
c89 -I. -I../../../src/include -I../../../src/include  -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON -KPIC  -g -c devX11.c -o devX11.o
cc-1552 c89: WARNING File = devX11.c, Line = 250
  The variable "imin" is set but never used.

      int i, imin;
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 417
  The variable "imin" is set but never used.

      int i, imin;
             ^

cc-1136 c89: WARNING File = devX11.c, Line = 552
  Too many arguments in function call.

            SetupPseudoColor(model);
                             ^

cc-1136 c89: WARNING File = devX11.c, Line = 561
  Too many arguments in function call.

            SetupPseudoColor(model);
                             ^

cc-1185 c89: WARNING File = devX11.c, Line = 1595
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1596
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1656
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devX11.c, Line = 1688
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1689
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1722
  An enumerated type is mixed with another type.

        GConvert(&devx, &devy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devX11.c, Line = 1766
  An enumerated type is mixed with another type.

        GConvert(&devx, &devy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devX11.c, Line = 1771
  An enumerated type is mixed with another type.

      GConvert(&devx, &devy, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = devX11.c, Line = 1814
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1552 c89: WARNING File = devX11.c, Line = 1806
  The variable "len" is set but never used.

      int len, size;
          ^

cc-1185 c89: WARNING File = devX11.c, Line = 1837
  An enumerated type is mixed with another type.

      if (xd->type > WINDOW) return 0;
                                    ^

cc-1185 c89: WARNING File = devX11.c, Line = 1865
  An enumerated type is mixed with another type.

      return (done == 1);
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "RedLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "GreenLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
                        ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "BlueLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
                                     ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library
c89 -shared  -o R_X11.so  dataentry.o devX11.o rotated.o rbitmap.o -lSM -lICE -L/usr/local/lib -lX11  -L/usr/local/lib -ljpeg -lpng -lz -L/usr/local/lib  -lz -ldl -lncurses -lm
ld32: WARNING 84 : /usr/lib32/libSM.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/lib32/libdl.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/local/lib/libncurses.a is not used for resolving any symbol.
------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/ctest/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c fexact.c -o fexact.o
cc-1185 c89: WARNING File = fexact.c, Line = 389
  An enumerated type is mixed with another type.

      nr_gt_nc =  *nrow > *ncol;
               ^

------------------------------------------------------------------------
c89 -shared  -o ctest.so ansari.o d2x2xk.o fexact.o kendall.o ks.o prho.o swilk.o -L/usr/local/lib -LANG:=f77 -L/usr/lib32/mips3/r4000 -L/usr/lib32/mips3 -L/usr/lib32 -lftn -lm
ld32: WARNING 84 : /usr/lib32/mips3/libftn.so is not used for resolving any symbol.
------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/eda/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c smooth.c -o smooth.o
cc-1185 c89: WARNING File = smooth.c, Line = 51
  An enumerated type is mixed with another type.

        chg = chg || j;
            ^

cc-1185 c89: WARNING File = smooth.c, Line = 76
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 76
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 97
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);/* =>  chg = TRUE  iff  ends changed */
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 97
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);/* =>  chg = TRUE  iff  ends changed */
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 141
  An enumerated type is mixed with another type.

                chg = y[i] != x[i];
                    ^

cc-1185 c89: WARNING File = smooth.c, Line = 146
  An enumerated type is mixed with another type.

                chg = y[i+1] != x[i+1];
                    ^

cc-1185 c89: WARNING File = smooth.c, Line = 202
  An enumerated type is mixed with another type.

        ch2 = sm_3R(z, y, w, n, end_rule);
            ^

cc-1185 c89: WARNING File = smooth.c, Line = 203
  An enumerated type is mixed with another type.

        chg = chg || ch2;
            ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/nls/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c nls.c -o nls.o
cc-1552 c89: WARNING File = nls.c, Line = 66
  The variable "convNew" is set but never used.

      double dev, fac, minFac, tolerance, newDev, convNew;
                                                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/ts/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c mburg.c -o mburg.o
cc-1552 c89: WARNING File = mburg.c, Line = 222
  The variable "s_inv" is set but never used.

      Array s, s_inv, tmp, d1;
               ^

cc-1552 c89: WARNING File = mburg.c, Line = 225
  The variable "id" is set but never used.

      Array id;
            ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/tcltk/src
c89 -I../../../../include -I/usr/local/include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c tcltk.c -o tcltk.o
cc-1552 c89: WARNING File = tcltk.c, Line = 39
  The variable "ans" is set but never used.

      SEXP text, expr, ans;
                       ^

cc-1552 c89: WARNING File = tcltk.c, Line = 70
  The variable "ans" is set but never used.

      SEXP expr, ans, fun, alist;
                 ^

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- Center for Scientific Computing       FAX: +1 801 585 1640, +1 801 581 4148 -
- University of Utah                    Internet e-mail: beebe@math.utah.edu  -
- Department of Mathematics, 322 INSCC      beebe@acm.org  beebe@computer.org -
- 155 S 1400 E RM 233                       beebe@ieee.org                    -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -
-------------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From beebe@math.utah.edu  Sat Feb 17 01:47:00 2001
From: beebe@math.utah.edu (beebe@math.utah.edu)
Date: Sat, 17 Feb 2001 02:47:00 +0100 (MET)
Subject: [Rd] More comments on R-1.2.1 builds (PR#852)
Message-ID: <200102170147.CAA19365@pubhealth.ku.dk>

On IBM RS/6000 AIX 4.2, I built R-1.2.1 with

% env CC=xlc CXX=xlC F77=f77 FC=f77 ./configure

R is now configured for powerpc-ibm-aix4.2.1.0

  Source directory:          .
  Installation directory:    /usr/local
  C compiler:                c89  -g
  C++ compiler:              xlC  -g
  FORTRAN compiler:          f77  -g

  X11 support:               yes
  Gnome support:             no
  Tcl/Tk support:            yes

  R profiling support:       yes
  R as a shared library:     no

However, the R-1.2.1 build fails in a number of places:

c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -c fortran.c -o fortran.o
"../../src/include/Fortran.h", line 43.9: 1506-213 (S) Macro name abs cannot
be redefined.
"../../src/include/Fortran.h", line 43.9: 1506-358 (I) "abs" is defined on
line 362 of /usr/include/stdlib.h.

I found that putting "#undef abs" before line 43 of Fortran.h solves
that problem.

It then dies later in compilation of several routines, of which this
is typical:

c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -c devices.c -o devices.o
"../../src/include/Startup.h", line 48.14: 1506-009 (S) Bit-field R_Quiet
must be of type signed int, unsigned int or int.
...

The complaint is from the use of a bitfield modifier on an enum;
gcc will compile this code, but IBM's cc and c89 will not.

This appears to be a violation of 1989 Standard C: in ANSI
X3.159-1989, on p. 61, section 3.5.2.1, I find at line 30:

>> ...
>> A bit-field shall have a type that is a qualified or unqualified
>> version of one of {\bf int}, {\bf unsigned int}, or {\bf signed int}. ...
>> ...

On the p. 62 in section 3.5.2.2, line 60:

>> ...
>> Each enumerated type shall be compatible with an integer type; the
>> choice of type is implementation-defined.
>> ...

In particular, if an enum is treated as char, short, long, or long
long, then it does not match the requirement of section 3.5.2.1.

To test this further, I made an experiment:

	% cat boo.c
	#if 1
	typedef enum { apple = 0, pear } Fruit;
	#else
	typedef int Fruit;
	#endif


	typedef struct boo {
	    Fruit x : 1;
	} S_Fruit;

	S_Fruit y;

On Sun Solaris 2.7:

	% c89 -Xa -c boo.c
	% c89 -Xt -c boo.c
	% c89 -Xc -c boo.c
	"boo.c", line 9: warning: nonportable bit-field type
	% cc -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% CC -c boo.c
	% g++ -c boo.c

On SGI IRIX 6:

	% c89 -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% CC -c boo.c
	% g++ -c boo.c

On Compaq/DEC Alpha OSF/1 4.0:

	% c89 -c boo.c
	cc: Info: boo.c, line 9: In the declaration of "x", the bitfield type is not an int, signed int or unsigned int. (bitnotint)
	    Fruit x : 1;
	----------^
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% cxx -c boo.c
	% g++ -c boo.c

On GNU/Linux (Redhat 6.2) on Intel x86:

	% cc -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% g++ -c boo.c
	% pgcc -c boo.c
	% pgCC -c boo.c

On IBM RS/6000 AIX 4.3:
	% cc -c boo.c
	"boo.c", line 9.11: 1506-159 (E) Bit-field type specified for x is not valid. Type unsigned assumed.
	% gcc -c boo.c
	CC -c boo.c
	% CC -c boo.c
	% g++ -c boo.c
	% c89 -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.
	% xlC -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.
	% xlc -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.

Thus, the stricter 1989 Standard C compilers reject the use of the enum in
a bitfield.

C++ (ISO/IEC 14882-1998) says in section 9.5:

>> ...
>> 4 If the value true or false is stored into a bit-field of type bool
>> of any size (including a one bit bit-field), the original bool value
>> and the value of the bit-field shall compare equal.  If the value of
>> an enu-merator is stored into a bit-field of the same enumeration type
>> and the number of bits in the bit-field is large enough to hold all
>> the values of that enumeration type, the original enumerator value and
>> the value of thebit-field shall compare equal.
>> ...

This suggests that Standard C++ permits enums to have bitfield
modifiers.  However, as far as I know, there are not yet any Standard
C++ compilers available on any platform.

I could not find definitive language in ISO/IEC 9899-1999, the 1999 C
Standard on this point.

In summary, it seems best to eliminate the bitfield modifiers on enum
data.  Even if this involves a small memory penalty, it will probably
make the code faster, since bitmasking and shifting is no longer
needed to access the fields.

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- Center for Scientific Computing       FAX: +1 801 585 1640, +1 801 581 4148 -
- University of Utah                    Internet e-mail: beebe@math.utah.edu  -
- Department of Mathematics, 322 INSCC      beebe@acm.org  beebe@computer.org -
- 155 S 1400 E RM 233                       beebe@ieee.org                    -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -
-------------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sat Feb 17 14:25:13 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sat, 17 Feb 2001 15:25:13 +0100
Subject: [Rd] Comments on R-1.2.1 builds (PR#851)
In-Reply-To: <200102170044.BAA19310@pubhealth.ku.dk>
References: <200102170044.BAA19310@pubhealth.ku.dk>
Message-ID: <14990.35273.167526.4092@mithrandir.hornik.net>

>>>>> beebe  writes:

> The R-1.2.1 builds have gone fairly smoothly on most of my UNIX
> architectures, but there were many warnings reported by the picky SGI
> compiler that could be eliminated in future releases.

> Generally, I have found the SGI compilers very helpful in ferreting
> out portability problems, unused and/or obsolete variables, unexpected
> datatype coercions, etc., and they compile faster than any other
> compilers too.

> First, I configured like this:

> env CC='c89 -mips3 -O3' ./configure && make all

> This reports:

> 	R is now configured for mips-sgi-irix6.5

> 	  Source directory:          .
> 	  Installation directory:    /usr/local
> 	  C compiler:                c89 -mips3 -O3  -OPT:IEEE_NaN_inf=ON -g
> 	  C++ compiler:              c++  -g -O2
> 	  FORTRAN compiler:          g77  -OPT:IEEE_NaN_inf=ON -g -O2

> 	  X11 support:               yes
> 	  Gnome support:             no
> 	  Tcl/Tk support:            yes

> 	  R profiling support:       yes
> 	  R as a shared library:     no

> The build proceeds until this failure:

> 	g77 -OPT:IEEE_NaN_inf=ON  -g -O2 -c ch2inv.f -o ch2inv.o
> 	f771: Invalid option `-OPT:IEEE_NaN_inf=ON'
> 	make[3]: *** [ch2inv.o] Error 1

> Evidently, it was not prepared for the GNU Fortran compiler.

Yep, that is a bug.  I need some feedback for fixing this, though.  The
current logic is to run the autoconf R_C_OPTIEEE test if the platform is
IRIX.  The test itself tries to compile and run

#include <math.h>
#include <ieeefp.h>
int main () {
  double x = 0;
  fpsetmask(0); x = x / x; return (x != x);
}

and if that works adds -OPT:IEEE_NaN_inf=ON to both R_XTRA_CFLAGS and
R_XTRA_FFLAGS.

This obviously does not make sense for FORTRAN, and should be made more
defensive for C.

* For C, one should additionally test whether the compiler accepts this
  flag.  I assume gcc would not, so should we do

	if_not_using_gcc  check_arg("-OPT:IEEE_NaN_inf=ON")

* For FORTRAN, I am not sure whether the result of the above test has
  any relevance.  Question is, do we have a FORTRAN test program similar
  to the above to determine whether the flag is needed?  Again, we
  should also check whether the compiler accepts the flag ...

* Or should we simply unconditionally add the flag for ``native'', i.e.,
  non-GNU compilers?

(Sorry but I do not have access to SGIs ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb 17 15:01:32 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat, 17 Feb 2001 16:01:32 +0100 (MET)
Subject: [Rd] More comments on R-1.2.1 builds (PR#852)
Message-ID: <200102171501.QAA20856@pubhealth.ku.dk>

On Sat, 17 Feb 2001 beebe@math.utah.edu wrote:

> On IBM RS/6000 AIX 4.2, I built R-1.2.1 with
>
> % env CC=xlc CXX=xlC F77=f77 FC=f77 ./configure
>
> R is now configured for powerpc-ibm-aix4.2.1.0
>
>   Source directory:          .
>   Installation directory:    /usr/local
>   C compiler:                c89  -g
>   C++ compiler:              xlC  -g
>   FORTRAN compiler:          f77  -g
>
>   X11 support:               yes
>   Gnome support:             no
>   Tcl/Tk support:            yes
>
>   R profiling support:       yes
>   R as a shared library:     no
>
> However, the R-1.2.1 build fails in a number of places:
>
> c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -c fortran.c -o fortran.o
> "../../src/include/Fortran.h", line 43.9: 1506-213 (S) Macro name abs cannot
> be redefined.
> "../../src/include/Fortran.h", line 43.9: 1506-358 (I) "abs" is defined on
> line 362 of /usr/include/stdlib.h.
>
> I found that putting "#undef abs" before line 43 of Fortran.h solves
> that problem.

That definition is no longer used in the files using that header, and has
been deleted.  It looks like the file fortran.c is redundant too.

> It then dies later in compilation of several routines, of which this
> is typical:
>
> c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -c devices.c -o devices.o
> "../../src/include/Startup.h", line 48.14: 1506-009 (S) Bit-field R_Quiet
> must be of type signed int, unsigned int or int.
> ...

This seems a mis-placed fit of enthusiasm!  As the designer of that
structure I certainly did not pack it, and there is just one instance of it
per R process.  I have removed the packing, which was added last November,
documented `many more cleanups' from the CVS logs.

(These changes refer to 1.2.2, which is planned for a couple of weeks.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Feb 18 10:10:40 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 18 Feb 2001 11:10:40 +0100
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>
References: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>
Message-ID: <14991.40864.896451.453333@mithrandir.hornik.net>

>>>>> Paul Gilbert writes:

> I am trying to catch a segfault from a shell in the tests directory
> set up by R CMD check with

> R_LIBS=~/dse/CHECKED/library:..
> export R_LIBS
> R -d gdb
> run

> but then when I try to load a library I find the setting of R_LIBS is
> ignored. What am I doing wrong? The library is found ok without -d
> gdb. (Using Solaris 2.6, R 1.2.1 Patched (2001-02-06) )

Hmm ... hard to believe:

hornik@mithrandir:~/tmp$ export R_LIBS=~/dse/CHECKED/library:..
hornik@mithrandir:~/tmp$ R -d gdb
GNU gdb 19990928
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(gdb) r
...
R> Sys.getenv("R_LIBS")
                               R_LIBS 
"/home/Hornik/dse/CHECKED/library:.." 

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 18 11:05:08 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 18 Feb 2001 11:05:08 +0000 (GMT)
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <14991.40864.896451.453333@mithrandir.hornik.net>
Message-ID: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>

On Sun, 18 Feb 2001, Kurt Hornik wrote:

> >>>>> Paul Gilbert writes:
>
> > I am trying to catch a segfault from a shell in the tests directory
> > set up by R CMD check with
>
> > R_LIBS=~/dse/CHECKED/library:..
> > export R_LIBS
> > R -d gdb
> > run
>
> > but then when I try to load a library I find the setting of R_LIBS is
> > ignored. What am I doing wrong? The library is found ok without -d
> > gdb. (Using Solaris 2.6, R 1.2.1 Patched (2001-02-06) )
>
> Hmm ... hard to believe:
>
> hornik@mithrandir:~/tmp$ export R_LIBS=~/dse/CHECKED/library:..
> hornik@mithrandir:~/tmp$ R -d gdb
> GNU gdb 19990928
> Copyright 1998 Free Software Foundation, Inc.
> GDB is free software, covered by the GNU General Public License, and you are
> welcome to change it and/or distribute copies of it under certain conditions.
> Type "show copying" to see the conditions.
> There is absolutely no warranty for GDB.  Type "show warranty" for details.
> This GDB was configured as "i686-pc-linux-gnu"...
> (gdb) r
> ...
> R> Sys.getenv("R_LIBS")
>                                R_LIBS
> "/home/Hornik/dse/CHECKED/library:.."

Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
(gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From baron@cattell.psych.upenn.edu  Sun Feb 18 21:43:52 2001
From: baron@cattell.psych.upenn.edu (baron@cattell.psych.upenn.edu)
Date: Sun, 18 Feb 2001 22:43:52 +0100 (MET)
Subject: [Rd] match vs. %in% (PR#853)
Message-ID: <200102182143.WAA24872@pubhealth.ku.dk>

This isn't really a bug so much as an undocumented feature, but
perhaps the help file should be changed.

If you say
match(x,y)
you get the values of the _first_ instance in y that matches each
value of x.

If you say 
x %in% y
you get "TRUE" for every match, not just the first.

This is useful, now that I know it, but perhaps the thing
about the first instance should be documented.

I still don't understand why it happens!

Jon

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Sun Feb 18 22:41:56 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Mon, 19 Feb 2001 11:41:56 +1300
Subject: [Rd] Re: polygon border colors
References: <Pine.SUN.3.91.1010216085824.11176B@okapi.cor.epa.gov>
Message-ID: <012501c099fb$ffb7cad0$175dd882@stat.auckland.ac.nz>

Hi


> I think I see in do_polygon() in plot.c that border colors are
> not cycled, and that changes in the lines
>
> ...
>     PROTECT(border = FixupCol(CAR(args), dd->gp.fg)); args = CDR(args);
> ...
> GPolygon(i-start, x+start, y+start, USER,
> INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
> ...
>     GPolygon(nx-start, x+start, y+start, USER,
>      INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
> ...
>
> following the pattern for "col" might make cycling possible.
>
> Is this a change that I should try locally, or could this be
> considered for the standard version?


There is now a fix in the release version of R, which should come out fairly
soon.  There is also a fix to recycle the lty argument, plus documentation
and an example to show how you can get multiple polygons out of a single
call to polygon() using NA coordinates.

Thanks for the bug report and suggested solution.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 19 07:24:55 2001
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Feb 2001 07:24:55 +0000 (GMT)
Subject: [Rd] match vs. %in% (PR#853)
In-Reply-To: <200102182143.WAA24872@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0102190719130.26442-100000@auk.stats>

On Sun, 18 Feb 2001 baron@cattell.psych.upenn.edu wrote:

> This isn't really a bug so much as an undocumented feature, but
> perhaps the help file should be changed.
>
> If you say
> match(x,y)
> you get the values of the _first_ instance in y that matches each
> value of x.

Yes, but one match or not for each instance of x.

> If you say
> x %in% y
> you get "TRUE" for every match, not just the first.

You get a result for each element of x, not y.

Both return a result for each element of x. match returns the index of the
first match or `nomatch',  %in% returns TRUE or FALSE.

is.element is a synonym of %in% compatible with S, which uses %in% for
something else (nesting in formulae).

> This is useful, now that I know it, but perhaps the thing
> about the first instance should be documented.

Yes, ?match needs a `details' section.  I'll add one.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Mon Feb 19 09:35:36 2001
From: adrian@olsen.ch (Adrian Trapletti)
Date: Mon, 19 Feb 2001 10:35:36 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
 <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk> <pxwvaqse73.fsf@infiniti.ece.cmu.edu>
Message-ID: <3A90E8E7.7A066F7@olsen.ch>


Thomas Vogels wrote:

> Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk> writes:
>
> > Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> >
> > > > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > > > From: Adrian Trapletti <adrian@olsen.ch
> > >
> > > > I don't know if it has something to do with this discussion, but it's
> > > > probably worth reporting it.
> > > >
> > > > Under
> > > > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > > > R : Version 1.2.1  (2001-01-15)
> > > > Fvwm95 Version 2.0.43a
> > > > the window manager always crashes when I close an x11() device started
> > > > within R.
> > >
> > > This discussion is about png() and jpeg() devices.  We've had other
> > > reports about FVWM, though.
> >
> > ...and they too refer to improper error handling by X11. I'm somewhat
> > baffled by the effect reported, though. Surely, an application
> > crashing the window manager is a bug in the latter, not the former?
> > What we've heard of before is that closing X11 windows with the window
> > manager crashes R, but this sounds like the other way around.
>
> The question about freeing xd and dd comes indeed from my fiddling
> with the X11 driver and understanding the code there...  As for the
> current handleEvent: there are some events simply ignored (like the
> DestroyNotify event) and some are not reaped due to the sequence of
> events in X11_Close/R_ProcessEvents.  (And the way inclose is handled
> is scary once you think of closing two windows at roughly the same
> time...)  The events that linger after R is done shouldn't confuse the
> window manager, though.
>
> I've put my code, patches, comments, suggestions, etc. at:
> http://www.ece.cmu.edu/~tov/public/R/X11andTk.html
> I'd be curious whether R with the patched handleEvent still crashes
> FVWM95.  Probably but who knows.

First, I was somewhat sleeping when I reported this problem. It is not
window-close which causes the crash, but window-minimize (iconify 1) (sorry for
that).

I recompiled R-1.2.1 with your patch. FVWM95 still crashes when I minimize the
x11 device. Furthermore, no other WM (olwm, fvwm, fvwm2, icewm) crashes.

Adrian


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Feb 19 16:27:22 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Feb 2001 11:27:22 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
Message-ID: <3A914969.3A17BA04@bank-banque-canada.ca>

>Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
>(gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

This is the clue, though --vanilla doesn't fix it. R_LIBS is set in my
.cshrc file and when I use R -d gdb it grabs the setting from there (but
not when I don't use "-d gdb"). This seems a bit strange since I am
actually running this from sh (which I started from a csh). However, it
is not grabbing the R_LIBS setting from the original csh but directly
from the .cshrc file since it changes when I comment out the setting in
.cshrc and simply restart "R -d gdb".

Thanks,
Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Feb 20 13:45:00 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 20 Feb 2001 14:45:00 +0100
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <3A914969.3A17BA04@bank-banque-canada.ca>
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
 <3A914969.3A17BA04@bank-banque-canada.ca>
Message-ID: <14994.29916.987350.524484@mithrandir.hornik.net>

>>>>> Paul Gilbert writes:

>> Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
>> (gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

> This is the clue, though --vanilla doesn't fix it. R_LIBS is set in my
> .cshrc file and when I use R -d gdb it grabs the setting from there
> (but not when I don't use "-d gdb"). This seems a bit strange since I
> am actually running this from sh (which I started from a
> csh). However, it is not grabbing the R_LIBS setting from the original
> csh but directly from the .cshrc file since it changes when I comment
> out the setting in .cshrc and simply restart "R -d gdb".

I am confused.  But here's what the GDB info page says:

   *Warning:* On Unix systems, GDB runs your program using the shell
indicated by your `SHELL' environment variable if it exists (or
`/bin/sh' if not).  If your `SHELL' variable names a shell that runs an
initialization file--such as `.cshrc' for C-shell, or `.bashrc' for
BASH--any variables you set in that file affect your program.  You may
wish to move setting of environment variables to files that are only
run when you sign on, such as `.login' or `.profile'.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Feb 20 17:01:40 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 20 Feb 2001 12:01:40 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
 <3A914969.3A17BA04@bank-banque-canada.ca> <14994.29916.987350.524484@mithrandir.hornik.net>
Message-ID: <3A92A2F4.9B71740B@bank-banque-canada.ca>

Kurt

>   *Warning:* On Unix systems, GDB runs your program using the shell
> indicated by your `SHELL' environment variable if it exists (or
> `/bin/sh' if not).  If your `SHELL' variable names a shell that runs an
> initialization file--such as `.cshrc' for C-shell, or `.bashrc' for
> BASH--any variables you set in that file affect your program.  You may
> wish to move setting of environment variables to files that are only
> run when you sign on, such as `.login' or `.profile'.

Thanks, that explains it.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Feb 20 18:12:19 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 20 Feb 2001 13:12:19 -0500
Subject: [Rd] segfault
Message-ID: <3A92B383.422D1435@bank-banque-canada.ca>

I've managed to trap the following segfault with xxgdb and gctorture() set. The
segfault seems to move around if gctorture() is not set, but has now occurred twice
in the same spot with it set.  xxgdb gives the message

Program received signal SIGSEGV, Segmentation fault.
0x71244 in RunGenCollect (size_needed=2) at memory.c:1027

and the source listing points to FORWARD_CHILDREN(s); in the following section from
src/main/memory.c

#ifndef EXPEL_OLD_TO_NEW
    /* scan nodes in uncollected old generations with old-to-new pointers */
    for (gen = num_old_gens_to_collect; gen < NUM_OLD_GENERATIONS; gen++)
 for (i = 0; i < NUM_NODE_CLASSES; i++)
     for (s = NEXT_NODE(R_GenHeap[i].OldToNew[gen]);
   s != R_GenHeap[i].OldToNew[gen];
   s = NEXT_NODE(s))
  FORWARD_CHILDREN(s);
#endif


I'm using
> version
         _
platform sparc-sun-solaris2.6
arch     sparc
os       solaris2.6
system   sparc, solaris2.6
status   Patched
major    1
minor    2.1
year     2001
month    02
day      06
language R

Paul Gilbert

P.S. If someone can quickly tell me the trick to make cut and paste work with xxgdb
in Solaris I would appreciate it. (I realize I should probably read the manual, but
if it is simple please let me know.)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Tue Feb 20 20:09:21 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 20 Feb 2001 21:09:21 +0100
Subject: [Rd] segfault
In-Reply-To: Paul Gilbert's message of "Tue, 20 Feb 2001 13:12:19 -0500"
References: <3A92B383.422D1435@bank-banque-canada.ca>
Message-ID: <x266i5m80e.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> I've managed to trap the following segfault with xxgdb and gctorture() set. The
> segfault seems to move around if gctorture() is not set, but has now occurred twice
> in the same spot with it set.  xxgdb gives the message
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x71244 in RunGenCollect (size_needed=2) at memory.c:1027
> 
> and the source listing points to FORWARD_CHILDREN(s); in the following section from
> src/main/memory.c
> 
> #ifndef EXPEL_OLD_TO_NEW
>     /* scan nodes in uncollected old generations with old-to-new pointers */
>     for (gen = num_old_gens_to_collect; gen < NUM_OLD_GENERATIONS; gen++)
>  for (i = 0; i < NUM_NODE_CLASSES; i++)
>      for (s = NEXT_NODE(R_GenHeap[i].OldToNew[gen]);
>    s != R_GenHeap[i].OldToNew[gen];
>    s = NEXT_NODE(s))
>   FORWARD_CHILDREN(s);
> #endif
> 

This just shows that something corrupted the memory handling. The
actual bug is probably somewhat prior to this. If you do a "bt"
(backtrace) and go "up" a couple of times, you might find a spot where
someone forgot to PROTECT() a newly created R object.


> P.S. If someone can quickly tell me the trick to make cut and paste work with xxgdb
> in Solaris I would appreciate it. (I realize I should probably read the manual, but
> if it is simple please let me know.)

I gave up on xxgdb long ago because I thought it was enough to have to
deal with bugs in our own programs! However, it would seem that the
ordinary mousing techniques works as usual on Linux. Command-line
recall appears to be shot, however.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@pubhealth.ku.dk  Wed Feb 21 06:15:04 2001
From: pd@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: Wed, 21 Feb 2001 07:15:04 +0100
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200102210615.HAA18304@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.r-project.org or via email to
r-bugs@r-project.org. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 751 *
Subject: BUG: polyroot()
From: "Li Dongfeng" <mavip1@inet.polyu.edu.hk>
Date: Tue, 28 Nov 2000 13:24:33 +0800
--Numerical instability. We may want a better algorithm!

Directory:  Add-ons

* PR# 824 *
Subject: trouble with netCDF 
From: jasont@indigoindustrial.co.nz
Date: Thu, 25 Jan 2001 12:00:39 +1300
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 812 *
Subject: segmentation fault in integrate
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Thu, 11 Jan 2001 22:49:59 +0100
* PR# 781 *
Subject: syskern fails Rcmd check on Windows, gives incorrect information
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 20 Dec 2000 11:12:47 +0000 (GMT)
--Partially fixed by dse_2000.12, but still uses "ls" and gives
--incorrect information

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 839 *
Subject: clipped lines have wrong slope in log plot
From: Jason Eisner <jason@cs.rochester.edu>
Date: Sun, 4 Feb 2001 20:17:31 -0500 (EST)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
* PR# 750 *
Subject: abline() does not obey "xpd" (clipping rules)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 27 Nov 2000 18:27:11 +0100
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix is incorporated in 1.2.2.
--
--There is a deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--Paul thinks the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above 
--mayhave side-effects in many other pieces of interpreted code 
--(ii) do_mtext ignores dd->gp.cexbase unlike, for example, do_plot_xy 
--and anything to do with cexbase needs extreme care.
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
* PR# 830 *
Subject: Disappearing x axis in plot.factor
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:27:13 -0500
* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
--Neither of the proposed changes actually works in sufficient generality.
--
--The easy and unimportant part of this, the labels, is fixed in 1.2.2. Getting
--the data right is a project for 1.3
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500

Directory:  In-Out

* PR# 814 *
Subject: Memory problem ?
From: Zoltan Barta <Z.Barta@bristol.ac.uk>
Date: Mon, 15 Jan 2001 09:54:16 +0000 (GMT Standard Time)
--scan crashes R on Linux: a memory allocation problem, probably
--Uses n= or nlines= in scan will use less memory, and read.table does.

Directory:  Installation

none

Directory:  Language

* PR# 813 *
Subject: match.call problem
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jan 2001 17:46:15 +0100
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 851 *
Subject: Comments on R-1.2.1 builds
From: "Nelson H. F. Beebe" <beebe@math.utah.edu>
Date: Fri, 16 Feb 2001 17:44:17 -0700 (MST)
--These are only warnings: some have been eliminated for 1.2.2.
--Some are about constructs needed to satisfy other compilers.
--
--Also: configure problem with g77 on SGI.
* PR# 822 *
Subject: Re: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:56:32 +0100 (CET)
--part of 821
* PR# 821 *
Subject: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:44:28 +0100 (CET)
--See also 822, which shows the segfault is in strftime.c.
--From other correspondence, this is on RH5.0: we can't
--reproduce it on RH6.2 or anywhere else.
* PR# 848 *
Subject: X11 device doesn't handle destroy events correcly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
* PR# 838 *
Subject: Linux shared library problem
From: daniel.egloff@dplanet.ch
Date: Sun, 4 Feb 2001 22:37:31 +0100 (MET)
--RedHat 7.0: need updates?

Directory:  TooMuchAtOnce

* PR# 811 *
Subject: problem with strptime example (and mention of bug.report)
From: Stephen Eglen <stephen@anc.ed.ac.uk>
Date: Thu, 11 Jan 2001 19:18:39 GMT
--1) On OSF4, strptime is deficient. Nothing we can do.
--
--2) On Windows NT, the strptime problems are (i) German locale, English dates,
--(ii) Windows system errors with unknown DST (it move times to DST).
--(i) now has another warning in the help file (there already was one).
--(ii) was already worked around for 1.2.1.
--
--3) bug.report() uses a mailer option that does not exist on OSF4.

Directory:  Windows

none

Directory:  incoming

none
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pperkins@ucsd.edu  Thu Feb 22 07:36:55 2001
From: pperkins@ucsd.edu (pperkins@ucsd.edu)
Date: Thu, 22 Feb 2001 08:36:55 +0100 (MET)
Subject: [Rd] onefile= arg to postscript() (PR#854)
Message-ID: <200102220736.IAA07846@pubhealth.ku.dk>

Full_Name: Peter Perkins
Version: 1.2.1
OS: LinuxPPC
Submission from: (NULL) (24.4.89.36)


Unlike (at least some) other args/components of ps.options(), the onefile=
arg to postscript() does not default to ps.options()$onefile.  For the family=
and landscape= args, for example, it does.  Looking at postscript()'s code,
this
appears to be intentional.  If it _is_ intentional, the following clarification
might be added to the "onefile" line of the arguments section of the
postscript/ps.options help:

   "the onefile= arg to postscript() does _not_ default to the value set
    in the most recent call to ps.options(); rather, it defaults to TRUE."

but this raises the question, "just where _is_ the onefile arg to ps.options()
used, if not by postscript()?"

if the current behavior is not correct, then the solution seems to be
to change the default value to .PostScript.Options$onefile, if that's not
too ugly.  leaving onefile= out of the arg list would work, except then
the file= arg is left hanging.  for what it's worth, the explicit family=
arg seems to be superfluous, it would be handled by ... and the call to
check.options().

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 22 08:03:36 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 22 Feb 2001 09:03:36 +0100 (MET)
Subject: [Rd] onefile= arg to postscript() (PR#854)
Message-ID: <200102220803.JAA08341@pubhealth.ku.dk>

On Thu, 22 Feb 2001 pperkins@ucsd.edu wrote:

> for what it's worth, the explicit family=
> arg seems to be superfluous, it would be handled by ... and the call to
> check.options().

That is untrue, as you will see if you try it.
Take a look at the comment in the code, please.

    ## handle family separately as length can be 1 or 4
    if(!missing(family)) old$family <- family

In case you had not noticed, check.options would insist on length 1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gilb@home.com  Thu Feb 22 18:05:24 2001
From: gilb@home.com (Paul Gilbert)
Date: Thu, 22 Feb 2001 13:05:24 -0500
Subject: [Rd] segfault
Message-ID: <3A9554E3.357804E9@home.com>

A few people suggested ddd might be preferred to xxgdb, where upon xxgdb
crashed on me. I have now managed to get ddd working on my linux box at
home, but am still having some difficulty at work. (It requires a newer
c++ ,  some *tif libraries, etc.)

---- Peter D.  writes:
>The actual bug is probably somewhat prior to this. If you do a "bt"
>(backtrace) and go "up" a couple of times, you might find a spot where
>someone forgot to PROTECT() a newly created R object.

Well ddd  still does not install the innocent with the knowlege of C
programmers so I am guessing a bit about exactly what I should be
looking for. If I do "up" a few times I see a section of main/dotcode.c
starting at line 180 (copied below) that looks like it might have a
problem. The first few cases do not have any PROTECT statements and
others do. If this is not a a good guess then perhaps someone could fill
me in on what statements that create new R objects look like.

Thanks,
Paul
_____
    case INTSXP:
 s = allocVector(type, n);
 iptr = (int*)p;
 for(i=0 ; i<n ; i++) {
     INTEGER(s)[i] = iptr[i];
 }
 break;
    case REALSXP:
 s = allocVector(type, n);
 if(asLogical(getAttrib(arg, CSingSymbol)) == 1) {
     sptr = (float*) p;
     for(i=0 ; i<n ; i++) REAL(s)[i] = (double) sptr[i];
 } else {
     rptr = (double*) p;
     for(i=0 ; i<n ; i++) REAL(s)[i] = rptr[i];
 }
 break;
    case CPLXSXP:
 s = allocVector(type, n);
 zptr = (Rcomplex*)p;
 for(i=0 ; i<n ; i++) {
     COMPLEX(s)[i] = zptr[i];
 }
 break;
    case STRSXP:
 if(Fort) {
     /* only return one string: warned on the R -> Fortran step */
     strncpy(buf, (char*)p, 255);
     buf[256] = '\0';
     PROTECT(s = allocVector(type, 1));
     SET_STRING_ELT(s, 0, mkChar(buf));
     UNPROTECT(1);
 } else ...

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Thu Feb 22 22:37:18 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 22 Feb 2001 23:37:18 +0100
Subject: [Rd] segfault
In-Reply-To: Paul Gilbert's message of "Thu, 22 Feb 2001 13:05:24 -0500"
References: <3A9554E3.357804E9@home.com>
Message-ID: <x266i21h0h.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <gilb@home.com> writes:

> >The actual bug is probably somewhat prior to this. If you do a "bt"
> >(backtrace) and go "up" a couple of times, you might find a spot where
> >someone forgot to PROTECT() a newly created R object.
> 
> Well ddd  still does not install the innocent with the knowlege of C
> programmers so I am guessing a bit about exactly what I should be
> looking for. If I do "up" a few times I see a section of main/dotcode.c
> starting at line 180 (copied below) that looks like it might have a
> problem. The first few cases do not have any PROTECT statements and
> others do. If this is not a a good guess then perhaps someone could fill
> me in on what statements that create new R objects look like.

Briefly (and this'll have to be brief or I'll end up writing a
book...) things like allocVector create a new objects. As long as such
an object is "loose" - not assigned to an environment or made part of
an object which is - it is in danger of being destroyed by the garbage
collector. However, the garbage collector is not called randomly, it
can only happen when memory for a new object is being allocated. 

In the first handful of cases below, one allocates a vector and stuffs
some preexisting values into it (sitting in iptr, sptr, rptr,....) and
then passes s onto something else (it is the return value of
CPtrToRObj and that only gets called from do_dotCode where the return
value gets protected eventually)

However, in the STRSXP case, s needs protection because of the
mkChar(buf) which will allocate memory, and hence the construction:

     PROTECT(s = allocVector(type, 1));
     SET_STRING_ELT(s, 0, mkChar(buf));
     UNPROTECT(1);

I don't think this stretch of code is the culprit - it is a far too
busy area to be likely to have major bugs of this caliber.

Actually, once do_dotCode is involved, I'd suspect array overruns
rather than PROTECT bugs. I've seen several cases where a vector
turned out to getting passed with the wrong length or the wrong type.
Be very careful that all arguments to .Fortran/.C are explicitly
coerced to the right type - if you forget an as.double you might get a
routine that works impeccably until someone passes something like 1:12
(which has storage mode "integer") as an argument.

> Thanks,
> Paul
> _____
>     case INTSXP:
>  s = allocVector(type, n);
>  iptr = (int*)p;
>  for(i=0 ; i<n ; i++) {
>      INTEGER(s)[i] = iptr[i];
>  }
>  break;
>     case REALSXP:
>  s = allocVector(type, n);
>  if(asLogical(getAttrib(arg, CSingSymbol)) == 1) {
>      sptr = (float*) p;
>      for(i=0 ; i<n ; i++) REAL(s)[i] = (double) sptr[i];
>  } else {
>      rptr = (double*) p;
>      for(i=0 ; i<n ; i++) REAL(s)[i] = rptr[i];
>  }
>  break;
>     case CPLXSXP:
>  s = allocVector(type, n);
>  zptr = (Rcomplex*)p;
>  for(i=0 ; i<n ; i++) {
>      COMPLEX(s)[i] = zptr[i];
>  }
>  break;
>     case STRSXP:
>  if(Fort) {
>      /* only return one string: warned on the R -> Fortran step */
>      strncpy(buf, (char*)p, 255);
>      buf[256] = '\0';
>      PROTECT(s = allocVector(type, 1));
>      SET_STRING_ELT(s, 0, mkChar(buf));
>      UNPROTECT(1);
>  } else ...
> 
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Feb 12 15:10:14 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Feb 2001 16:10:14 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: <14962.20626.613619.35152@sonny.eddelbuettel.com>
References: <14962.20626.613619.35152@sonny.eddelbuettel.com>
Message-ID: <14983.64726.946115.11996@mithrandir.hornik.net>


	[Manually approved by MM -- because it contains binary attachment ]

--QcBiZYhiHg
Content-Type: text/plain; charset=us-ascii
Content-Description: message body text
Content-Transfer-Encoding: 7bit

>>>>> Dirk Eddelbuettel writes:

> GNU a2ps is a fairly versatile text-to-anything processor.  It is
> useful for typsetting source code from a wide variety of programming
> languages.  As R (ie S) wasn't supported yet, I quickly cobbled a
> style sheet for the S language together. Stylesheets are documented in
> the texinfo docs for a2ps, and examples can be found in
> /usr/share/a2ps/sheets (on Debian at least, others distros or unices
> probably have similar locations). IIRC a2ps exists for NT but might
> require Cygwin. I typeset on Linux and only print on NT :)

> Well, as I still don't really know what I'm doing with R, I would
> appreciate comments / feedback / input from anyone could spend a
> moment or two on this.  To activate the stylesheet, simple patch

>       /usr/share/a2ps/sheets/sheets.map

> as per the short diff below which declares that the stylesheet s.ssh
> shall be used for filenames matching /*.[RS]/.  The sheet itself is
> attached, just place it in the same directory, ie
> /usr/share/a2ps/sheets/.

> Usage then simply becomes
>       a2ps -Pdisplay foo.R
> or
>       a2ps foo.R -o foo.ps; gv foo.ps
> in case the "display" device isn't defined.

Thanks for bringing this up.  We have locally used style sheets S.ssh
for S code and Rd.ssh for Rd documentation format, both written by T
Hothorn.  I attach these files below.

> A few points / questions:

>  * content:  a2ps uses tricks to use TeX symbols. It works well to typset
>    <- with \leftarrow (uncomment that in s.ssh to see) but I couldn't tell
>    it to parse
>       a<-2
>    it only finds <- with whitespace, eg
>       a <- 2

Torsten gets this right by using a different alphabet, I think.

>    What could be done about <<- ?  Is there a matching TeX symbol?

Dunno.

>  * more content: Is the list of keywords really that short? I couldn't find
>    much else...

R-lang says:

	The following identifiers have a special meaning and should not
	be used for object names

	     if else repeat while function for in next break
	     TRUE FALSE NULL NA Inf NaN
	     ... ..1 ..2 etc.

so I think this is the list of keywords to use.

(Yes switch() is not in there ...)

>  * scope:  Are other file extensions in use? Are there conventions for S or
>    Splus files?  Any clever way to make a2ps understand the files in 
>    $R_HOME/library/$PACKAGE/R  are also R?  Could file(1) be taught what 
>    an R file is?

I think assuming that extensions `.R' and `.Rd' for R code and doc
source files are pretty safe.  The package installer will also allow for
code extensions `.r', `.S', `.s', and `.q', but I think only the last of
these may be specific enough to make it into the extension list.

No R magic in general.  ESS think .R/.r are safe for auto-mode-alist and
.S/.s need enforcing.  [One could try checking for Emacs-style mode
magic but I think that would be a bad idea.]

>  * editorial: shall this be the s.ssh or r.ssh or rs.ssh?

I think we want S.ssh, as this is a style sheet for code written in the
S language.

Best,
-k


--QcBiZYhiHg
Content-Type: application/octet-stream
Content-Disposition: attachment;
	filename="S.ssh"
Content-Transfer-Encoding: base64

IyBUaGlzIGlzIGEgUiBzaGVldApzdHlsZSBSIGlzCndyaXR0ZW4gYnkgIlRvcnN0ZW4gSG90aG9y
biA8aG90aG9ybkBjaS50dXdpZW4uYWMuYXQ+Igp2ZXJzaW9uIGlzIDAuMQpyZXF1aXJlcyBhMnBz
IDQuOS41Cgpkb2N1bWVudGF0aW9uIGlzCiAgICJDcmVhdGVzIHByZXR0eSBSLWNvZGUgcG9zdHNj
cmlwdCBmaWxlcy4iCmVuZCBkb2N1bWVudGF0aW9uCgphbHBoYWJldHMgYXJlCiAgICJBQkNERUZH
SElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XyMkJT0tJi8iCgpj
YXNlIHNlbnNpdGl2ZQoKIyBhbmNlc3RvcnMgYXJlCiMgICBjCiMgZW5kIGFuY2VzdG9ycwoKc2Vx
dWVuY2VzIGFyZQogICIjIiBDb21tZW50LAogICJcIiIgUGxhaW4gU3RyaW5nICJcIiIgUGxhaW4K
IyAgIGV4Y2VwdGlvbnMgYXJlCiMgICAgL1xcXFwsLwojICAgICAgIGVuZCBleGNlcHRpb25zCmVu
ZCBzZXF1ZW5jZXMKCmtleXdvcmRzIGluIEtleXdvcmRfc3Ryb25nIGFyZQogIGlmLCB0aGVuLCBl
bHNlLCBicmVhaywgd2hpbGUsIGZvciwgZnVuY3Rpb24sIG5leHQsIHJldHVybiwgRkFMU0UsIFRS
VUUKZW5kIGtleXdvcmRzCgpvcGVyYXRvcnMgYXJlCiAgIDwtIFxsZWZ0YXJyb3cKZW5kIG9wZXJh
dG9ycwoKb3B0aW9uYWwgc2VxdWVuY2VzIGFyZQogICA8IFBsYWluIEtleXdvcmQgPiBQbGFpbgpl
bmQgc2VxdWVuY2VzCmVuZCBzdHlsZQ==
--QcBiZYhiHg
Content-Type: application/octet-stream
Content-Disposition: attachment;
	filename="Rd.ssh"
Content-Transfer-Encoding: base64

IyBTdHlsZSBzaGVldCBmb3IgUyBvdXRwdXQKIyBDb3B5cmlnaHQgKGMpIDIwMDAgVG9yc3RlbiBI
b3Rob3JuCgojCiMgCiMgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVk
aXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKIyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIsIG9yIChhdCB5b3VyIG9wdGlvbikKIyBh
bnkgbGF0ZXIgdmVyc2lvbi4KIwojIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAojIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsg
d2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiMgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQojIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiMKIyBZb3Ugc2hvdWxkIGhhdmUgcmVj
ZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQojIGFsb25nIHdp
dGggdGhpcyBwcm9ncmFtOyBzZWUgdGhlIGZpbGUgQ09QWUlORy4gIElmIG5vdCwgd3JpdGUgdG8K
IyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAz
MzAsCiMgQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuCiMKIyAwLjEgVG9yc3RlbiBIb3Rob3Ju
CgpzdHlsZSBSZCBpcwp3cml0dGVuIGJ5ICJUb3JzdGVuIEhvdGhvcm4gPGhvdGhvcm5AY2kudHV3
aWVuLmFjLmF0PiIKdmVyc2lvbiBpcyAwLjEKcmVxdWlyZXMgYTJwcyA0LjkuNQoKZG9jdW1lbnRh
dGlvbiBpcwogICAJImEycHMgc3R5bGUgc2hlZXQgZm9yIFJkIgplbmQgZG9jdW1lbnRhdGlvbgoK
YWxwaGFiZXRzIGFyZQogICAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xt
bm9wcXJzdHV2d3h5el8jJCU9LSYvIgoKY2FzZSBzZW5zaXRpdmUKCiMgYW5jZXN0b3JzIGFyZQoj
ICAgYwojIGVuZCBhbmNlc3RvcnMKCnNlcXVlbmNlcyBhcmUKICAiIyIgQ29tbWVudCwKICAiXCIi
IFBsYWluIFN0cmluZyAiXCIiIFBsYWluLAogICJcXCIgS2V5d29yZF9zdHJvbmcgInsiIFBsYWlu
CiMgICJ7IiBQbGFpbiBTdHJpbmcgIn0iIFBsYWluCiMJZXhjZXB0aW9ucyBhcmUKIwkvaXRlbXss
Y29kZXssdXNhZ2V7LGtleXdvcmR7LwojCWVuZCBleGNlcHRpb25zCiMgICJ7IiBQbGFpbiBTdHJp
bmcgIn17IiBQbGFpbgojCQojICAgZXhjZXB0aW9ucyBhcmUKIyAgIC9cXFthOnpdey8gS2V5d29y
ZCAifSIgUGxhaW4KIyAgIGVuZCBleGNlcHRpb25zCmVuZCBzZXF1ZW5jZXMKCm9wZXJhdG9ycyBh
cmUKICAgPC0gXGxlZnRhcnJvdwplbmQgb3BlcmF0b3JzCgpvcHRpb25hbCBzZXF1ZW5jZXMgYXJl
CiAgIDwgUGxhaW4gS2V5d29yZCA+IFBsYWluCmVuZCBzZXF1ZW5jZXMKZW5kIHN0eWxl
--QcBiZYhiHg--

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Sat Feb 24 00:00:46 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 24 Feb 2001 01:00:46 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: Kurt Hornik's message of "Mon, 12 Feb 2001 16:10:14 +0100"
References: <14962.20626.613619.35152@sonny.eddelbuettel.com> <14983.64726.946115.11996@mithrandir.hornik.net>
Message-ID: <x266i1gdap.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> R-lang says:
> 
> 	The following identifiers have a special meaning and should not
> 	be used for object names
> 
> 	     if else repeat while function for in next break
> 	     TRUE FALSE NULL NA Inf NaN
> 	     ... ..1 ..2 etc.
> 
> so I think this is the list of keywords to use.
> 
> (Yes switch() is not in there ...)

switch() is technically a function call...

The true authority is the keywords[] array in gram.y, a study of which
indicates that ..1, ..2 et al. do bit count as keywords, whereas ...
does and we have an extra which was new to me, namely GLOBAL.ENV, and
truly enough:

> GLOBAL.ENV
<environment: R_GlobalEnv>
> GLOBAL.ENV <- 5
Error in <environment> <- 5 : invalid (do_set) left-hand side to
assignment

Wonder what that one is good for? The only symbolic reference to
it in the entire source is in gram.c, but I suppose its value gets
initialized somewhere. Looks like a relic from older times, but I
wouldn't dare to remove it for 1.2.2...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Feb 25 13:52:09 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 25 Feb 2001 14:52:09 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: <x266i1gdap.fsf@blueberry.kubism.ku.dk>
References: <14962.20626.613619.35152@sonny.eddelbuettel.com>
 <14983.64726.946115.11996@mithrandir.hornik.net>
 <x266i1gdap.fsf@blueberry.kubism.ku.dk>
Message-ID: <15001.3593.198071.614550@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> R-lang says:
>> 
>> The following identifiers have a special meaning and should not
>> be used for object names
>> 
>> if else repeat while function for in next break
>> TRUE FALSE NULL NA Inf NaN
>> ... ..1 ..2 etc.
>> 
>> so I think this is the list of keywords to use.
>> 
>> (Yes switch() is not in there ...)

> switch() is technically a function call...

> The true authority is the keywords[] array in gram.y, a study of which
> indicates that ..1, ..2 et al. do bit count as keywords, whereas ...
> does and we have an extra which was new to me, namely GLOBAL.ENV, and
> truly enough:

>> GLOBAL.ENV
> <environment: R_GlobalEnv>
>> GLOBAL.ENV <- 5
> Error in <environment> <- 5 : invalid (do_set) left-hand side to
> assignment

> Wonder what that one is good for? The only symbolic reference to
> it in the entire source is in gram.c, but I suppose its value gets
> initialized somewhere. Looks like a relic from older times, but I
> wouldn't dare to remove it for 1.2.2...

Fascinating.  Maybe file it as a bug report so that we do not forget to
fix this in the future?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Torsten.Hothorn@rzmail.uni-erlangen.de  Mon Feb 26 12:48:36 2001
From: Torsten.Hothorn@rzmail.uni-erlangen.de (Torsten.Hothorn@rzmail.uni-erlangen.de)
Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261248.NAA14371@pubhealth.ku.dk>


Hi, 

when we add 

\examples{
a <- 1:4

a %*% a
}

into a Rd-file are run R CMD check, the resulting R code is 

a <- 1:4

a

So, %*% ... is lost on the way if I'm not totally confused. 

Torsten

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Patched
 major = 1
 minor = 2.0
 year = 2001
 month = 01
 day = 07
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 26 12:57:23 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 26 Feb 2001 13:57:23 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261257.NAA14485@pubhealth.ku.dk>

>From R-exts.texi ca line 1125.

The ``comment'' and ``control'' characters @samp{%} and @samp{\}
@emph{always} need to be escaped.  Inside the verbatim-like commands
(@code{\code} and @code{\examples}), no other characters are special.

You need \%*\%, as it suggests there and is used in the base package
examples.

Brian

> From: Torsten.Hothorn@rzmail.uni-erlangen.de
> Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] %*% in examples (PR#855)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> 
> Hi, 
> 
> when we add 
> 
> \examples{
> a <- 1:4
> 
> a %*% a
> }
> 
> into a Rd-file are run R CMD check, the resulting R code is 
> 
> a <- 1:4
> 
> a
> 
> So, %*% ... is lost on the way if I'm not totally confused. 
> 
> Torsten
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = Patched
>  major = 1
>  minor = 2.0
>  year = 2001
>  month = 01
>  day = 07
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:ctest, Autoloads, package:base
> 
> 
> 
> 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> 
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Torsten.Hothorn@rzmail.uni-erlangen.de  Mon Feb 26 13:06:17 2001
From: Torsten.Hothorn@rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Mon, 26 Feb 2001 14:06:17 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
In-Reply-To: <200102261257.MAA16411@toucan.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.21.0102261405230.22353-100000@artemis.imbe.med.uni-erlangen.de>


> >From R-exts.texi ca line 1125.
> 
> The ``comment'' and ``control'' characters @samp{%} and @samp{\}
> @emph{always} need to be escaped.  Inside the verbatim-like commands
> (@code{\code} and @code{\examples}), no other characters are special.
> 
> You need \%*\%, as it suggests there and is used in the base package
> examples.

well, as always: read the docs ;-)

Torsten

> 
> Brian
> 
> > From: Torsten.Hothorn@rzmail.uni-erlangen.de
> > Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
> > To: r-devel@stat.math.ethz.ch
> > Subject: [Rd] %*% in examples (PR#855)
> > CC: R-bugs@biostat.ku.dk
> > X-Loop: R-bugs@biostat.ku.dk
> > 
> > 
> > Hi, 
> > 
> > when we add 
> > 
> > \examples{
> > a <- 1:4
> > 
> > a %*% a
> > }
> > 
> > into a Rd-file are run R CMD check, the resulting R code is 
> > 
> > a <- 1:4
> > 
> > a
> > 
> > So, %*% ... is lost on the way if I'm not totally confused. 
> > 
> > Torsten
> > 
> > --please do not edit the information below--
> > 
> > Version:
> >  platform = i686-pc-linux-gnu
> >  arch = i686
> >  os = linux-gnu
> >  system = i686, linux-gnu
> >  status = Patched
> >  major = 1
> >  minor = 2.0
> >  year = 2001
> >  month = 01
> >  day = 07
> >  language = R
> > 
> > Search Path:
> >  .GlobalEnv, package:ctest, Autoloads, package:base
> > 
> > 
> > 
> > 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > 
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Mon Feb 26 13:08:12 2001
From: ligges@statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Mon, 26 Feb 2001 14:08:12 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261308.OAA14670@pubhealth.ku.dk>

Torsten.Hothorn@rzmail.uni-erlangen.de wrote:
> 
> Hi,
> 
> when we add
> 
> \examples{
> a <- 1:4
> 
> a %*% a
> }
> 
> into a Rd-file are run R CMD check, the resulting R code is
> 
> a <- 1:4
> 
> a
> 
> So, %*% ... is lost on the way if I'm not totally confused.
> 

That's not a bug, Torsten.

Use 
a \%*\% a

% this is a comment

Uwe

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Feb 26 16:16:59 2001
From: pgilbert@bank-banque-canada.ca (pgilbert@bank-banque-canada.ca)
Date: Mon, 26 Feb 2001 17:16:59 +0100 (MET)
Subject: [Rd] "}  {" problem in Rd files (PR#856)
Message-ID: <200102261616.RAA18047@pubhealth.ku.dk>

I better report this before I forget again (I think it may also be a
problem with \item) :

>Paul Gilbert wrote:

>> >   \section{Model Parameters}{
>>
>> I seem to recall having a bit of trouble with this quietly omitting
things when the
>> last "{" had a space before it or was on a new line. I'm not sure if
that >>is still a problem (or if indeed it ever was).

>Indeed it is, and there would be a few extra dents in the wall at head
>height here if you had not mentioned it.  Thanks.

>Jim





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 26 17:12:18 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 26 Feb 2001 18:12:18 +0100 (MET)
Subject: [Rd] "}  {" problem in Rd files (PR#856)
Message-ID: <200102261712.SAA18492@pubhealth.ku.dk>


> From: pgilbert@bank-banque-canada.ca
> Date: Mon, 26 Feb 2001 17:16:59 +0100 (MET)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] "}  {" problem in Rd files (PR#856)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> I better report this before I forget again (I think it may also be a
> problem with \item) :
> 
> >Paul Gilbert wrote:
> 
> >> >   \section{Model Parameters}{
> >>
> >> I seem to recall having a bit of trouble with this quietly omitting
> things when the
> >> last "{" had a space before it or was on a new line. I'm not sure if
> that >>is still a problem (or if indeed it ever was).
> 
> >Indeed it is, and there would be a few extra dents in the wall at head
> >height here if you had not mentioned it.  Thanks.

Also \deqn, \eqn.  However, they do work when used as documented
in R-exts, so I am not sure this is a bug.  Adding new lines and spaces
is a problem in other places in Rd too: not a fatal one but gets
unwanted spaces in the output.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marchini@stats.ox.ac.uk  Tue Feb 27 09:00:33 2001
From: marchini@stats.ox.ac.uk (marchini@stats.ox.ac.uk)
Date: Tue, 27 Feb 2001 10:00:33 +0100 (MET)
Subject: [Rd] Plotting points on a filled.contour plot (PR#857)
Message-ID: <200102270900.KAA23881@pubhealth.ku.dk>

Full_Name: Jonathan Marchini
Version: R 1.2.2
OS: linux-gnu
Submission from: (NULL) (163.1.103.108)


When adding points to a filled.contour plot they do not appear at the correct
coordinates.
The following code demonstrates this.
 
a<-expand.grid(1:20,1:20)
b<-matrix(a[,1]+a[,2],20)
filled.contour(x=1:20,y=1:20,z=b)
points(10,10)  

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas.baumann@ch.tum.de  Tue Feb 27 08:35:57 2001
From: thomas.baumann@ch.tum.de (Dr. Thomas Baumann)
Date: Tue, 27 Feb 2001 09:35:57 +0100 (CET)
Subject: [Rd] Patch to coplot.R
Message-ID: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; charset=us-ascii

Hello,

and a big thank you for providing R!

Please find attached a diff for coplot which you may want to consider
for the next release. The diff is against R 1.2.2. The reasons for this
patch are:

1. The boxes of coplot did not align very well with the panel graphs if
   applied to a factor

2. Putting the levels as axis labels instead of just numbers makes the
   plot more readable

I also include a sample dataset (test.asc) and a sample program to show
the differences.

Thanks for looking at the code.

Thomas


---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="coplot.diff"

*** /tmp/mycoplot.R	Tue Feb 27 09:08:13 2001
--- /tmp/coplot.R.orig	Tue Feb 27 09:08:13 2001
***************
*** 201,227 ****
                  ...)
          }
          if ((i == total.rows) && (j%%2 == 0)) 
!             if (nlevels(x) > 0)
!               axis(1, labels = levels(x), xpd = NA)
!             else
!               axis(1, xpd = NA)
          else if ((i == istart || index + columns > nplots) && 
              (j%%2 == 1)) 
!             if (nlevels(x) > 0)
!               axis(3, labels = levels(x), xpd = NA)
!             else
!               axis(3, xpd = NA)
!         if ((j == 1) && ((total.rows - i)%%2 == 0))
!             if (nlevels(y) > 0)
!               axis(2, labels = levels(y), xpd = NA)
!             else
!               axis(2, xpd = NA)
          else if ((j == columns || index == nplots) && ((total.rows - 
!             i)%%2 == 1))
!             if (nlevels(y) > 0)
!               axis(4, labels = levels(y), xpd = NA)
!             else
!               axis(4, xpd = NA)
          box()
      }
      if (have.b) {
--- 201,215 ----
                  ...)
          }
          if ((i == total.rows) && (j%%2 == 0)) 
!             axis(1, xpd = NA)
          else if ((i == istart || index + columns > nplots) && 
              (j%%2 == 1)) 
!             axis(3, xpd = NA)
!         if ((j == 1) && ((total.rows - i)%%2 == 0)) 
!             axis(2, xpd = NA)
          else if ((j == columns || index == nplots) && ((total.rows - 
!             i)%%2 == 1)) 
!             axis(4, xpd = NA)
          box()
      }
      if (have.b) {
***************
*** 255,274 ****
          par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
          plot.new()
          nint <- nrow(a.intervals)
!         pwoffs <- nint / 32
!         plot.window(c(min(a.intervals[is.finite(a.intervals)] + pwoffs),
!                       max(a.intervals[is.finite(a.intervals)]) - pwoffs),
!                     0.5 + c(0, nint), log = "")
!         rect(a.intervals[, 1], 1:nint - 0.5, a.intervals[, 2], 
!             1:nint + 0.5, col = gray(0.95))
!         if (!is.null(a.levels)) {
              mid <- apply(a.intervals, 1, mean)
              text(mid, 1:nint, a.levels)
              NULL
          }
!         axis(3, labels = FALSE, tick = FALSE, xpd = NA)
!         axis(1, labels = FALSE, tick = FALSE)
!         box(col = "grey")
          mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
              line = 3, xpd = NA)
      }
--- 243,262 ----
          par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
          plot.new()
          nint <- nrow(a.intervals)
!         plot.window(range(a.intervals[is.finite(a.intervals)]), 
!             0.5 + c(0, nint), log = "")
!         bg <- if (is.null(a.levels)) 
!             gray(0.9)
!         else {
              mid <- apply(a.intervals, 1, mean)
              text(mid, 1:nint, a.levels)
              NULL
          }
!         rect(a.intervals[, 1], 1:nint - 0.3, a.intervals[, 2], 
!             1:nint + 0.3, col = bg)
!         axis(3, xpd = NA)
!         axis(1, labels = FALSE)
!         box()
          mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
              line = 3, xpd = NA)
      }
***************
*** 284,304 ****
              par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
              plot.new()
              nint <- nrow(b.intervals)
!             pwoffs <- nint / 32
!             plot.window(0.5 + c(0, nint),
!                         c(min(b.intervals[is.finite(b.intervals)] + pwoffs),
!                           max(b.intervals[is.finite(b.intervals)]) - pwoffs),
!                         log = "")
!             rect(1:nint - 0.5, b.intervals[, 1], 1:nint + 0.5, 
!                 b.intervals[, 2], col = gray(0.95))
!             if (!is.null(b.levels)) {
                  mid <- apply(b.intervals, 1, mean)
                  text(1:nint, mid, b.levels, srt = 90)
                  NULL
              }
!             axis(4, labels = FALSE, tick = FALSE, xpd = NA)
!             axis(2, labels = FALSE, tick = FALSE)
!             box(col = "grey")
              mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                  line = 3, xpd = NA)
          }
--- 272,291 ----
              par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
              plot.new()
              nint <- nrow(b.intervals)
!             plot.window(0.5 + c(0, nint), range(b.intervals, 
!                 finite = TRUE), log = "")
!             bg <- if (is.null(b.levels)) 
!                 gray(0.9)
!             else {
                  mid <- apply(b.intervals, 1, mean)
                  text(1:nint, mid, b.levels, srt = 90)
                  NULL
              }
!             rect(1:nint - 0.3, b.intervals[, 1], 1:nint + 0.3, 
!                 b.intervals[, 2], col = bg)
!             axis(4, xpd = NA)
!             axis(2, labels = FALSE)
!             box()
              mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                  line = 3, xpd = NA)
          }

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="mycoplot.R"

function (formula, data, given.values, panel = points, rows, 
    columns, show.given = TRUE, col = par("fg"), pch = par("pch"), 
    xlab = c(x.name, paste("Given :", a.name)), ylab = c(y.name, 
        paste("Given :", b.name)), subscripts = FALSE, number = 6, 
    overlap = 0.5, xlim, ylim, ...) 
{
    deparen <- function(expr) {
        while (is.language(expr) && !is.name(expr) && deparse(expr[[1]]) == 
            "(") expr <- expr[[2]]
        expr
    }
    bad.formula <- function() stop("invalid conditioning formula")
    bad.lengths <- function() stop("incompatible variable lengths")
    formula <- deparen(formula)
    if (!inherits(formula, "formula")) 
        bad.formula()
    y <- deparen(formula[[2]])
    rhs <- deparen(formula[[3]])
    if (deparse(rhs[[1]]) != "|") 
        bad.formula()
    x <- deparen(rhs[[2]])
    rhs <- deparen(rhs[[3]])
    if (is.language(rhs) && !is.name(rhs) && (deparse(rhs[[1]]) == 
        "*" || deparse(rhs[[1]]) == "+")) {
        have.b <- TRUE
        a <- deparen(rhs[[2]])
        b <- deparen(rhs[[3]])
    }
    else {
        have.b <- FALSE
        a <- rhs
    }
    if (missing(data)) 
        data <- parent.frame()
    x.name <- deparse(x)
    x <- eval(x, data, parent.frame())
    nobs <- length(x)
    y.name <- deparse(y)
    y <- eval(y, data, parent.frame())
    if (length(y) != nobs) 
        bad.lengths()
    a.name <- deparse(a)
    a <- eval(a, data, parent.frame())
    if (length(a) != nobs) 
        bad.lengths()
    if (is.character(a)) 
        a <- as.factor(a)
    a.levels <- NULL
    if (have.b) {
        b.levels <- NULL
        b.name <- deparse(b)
        b <- eval(b, data, parent.frame())
        if (length(b) != nobs) 
            bad.lengths()
        if (is.character(b)) 
            b <- as.factor(b)
        missingrows <- which(is.na(x) | is.na(y) | is.na(a) | 
            is.na(b))
    }
    else {
        missingrows <- which(is.na(x) | is.na(y) | is.na(a))
        b <- NULL
        b.name <- ""
    }
    number <- as.integer(number)
    if (length(number) == 0 || any(number < 1)) 
        stop("number must be integer >= 1")
    if (any(overlap >= 1)) 
        stop("overlap must be < 1 (and typically >= 0).")
    bad.givens <- function() stop("invalid given.values")
    if (missing(given.values)) {
        a.intervals <- if (is.factor(a)) {
            i <- 1:nlevels(a)
            a.levels <- levels(a)
            a <- as.numeric(a)
            cbind(i - 0.5, i + 0.5)
        }
        else co.intervals(a, number = number[1], overlap = overlap[1])
        b.intervals <- if (have.b) {
            if (is.factor(b)) {
                i <- 1:nlevels(b)
                b.levels <- levels(b)
                b <- as.numeric(b)
                cbind(i - 0.5, i + 0.5)
            }
            else {
                if (length(number) == 1) 
                  number <- rep(number, 2)
                if (length(overlap) == 1) 
                  overlap <- rep(overlap, 2)
                co.intervals(b, number = number[2], overlap = overlap[2])
            }
        }
    }
    else {
        if (!is.list(given.values)) 
            given.values <- list(given.values)
        if (length(given.values) != (if (have.b) 
            2
        else 1)) 
            bad.givens()
        a.intervals <- given.values[[1]]
        if (is.factor(a)) {
            if (is.character(a.intervals)) 
                a.intervals <- match(a.intervals, levels(a))
            a.intervals <- cbind(a.intervals - 0.5, a.intervals + 
                0.5)
            a.levels <- levels(a)
            a <- as.numeric(a)
        }
        else if (is.numeric(a)) {
            if (!is.numeric(a.intervals)) 
                bad.givens()
            if (!is.matrix(a.intervals) || ncol(a.intervals) != 
                2) 
                a.intervals <- cbind(a.intervals - 0.5, a.intervals + 
                  0.5)
        }
        if (have.b) {
            b.intervals <- given.values[[2]]
            if (is.factor(b)) {
                if (is.character(b.intervals)) 
                  b.intervals <- match(b.intervals, levels(b))
                b.intervals <- cbind(b.intervals - 0.5, b.intervals + 
                  0.5)
                b.levels <- levels(b)
                b <- as.numeric(b)
            }
            else if (is.numeric(b)) {
                if (!is.numeric(b.intervals)) 
                  bad.givens()
                if (!is.matrix(b.intervals) || ncol(b.intervals) != 
                  2) 
                  b.intervals <- cbind(b.intervals - 0.5, b.intervals + 
                    0.5)
            }
        }
    }
    if (any(is.na(a.intervals)) || (have.b && any(is.na(b.intervals)))) 
        bad.givens()
    if (have.b) {
        rows <- nrow(b.intervals)
        columns <- nrow(a.intervals)
        nplots <- rows * columns
        if (length(show.given) < 2) 
            show.given <- rep(show.given, 2)
    }
    else {
        nplots <- nrow(a.intervals)
        if (missing(rows)) {
            if (missing(columns)) {
                rows <- ceiling(round(sqrt(nplots)))
                columns <- ceiling(nplots/rows)
            }
            else rows <- ceiling(nplots/columns)
        }
        else if (missing(columns)) 
            columns <- ceiling(nplots/rows)
        if (rows * columns < nplots) 
            stop("rows * columns too small")
    }
    total.columns <- columns
    total.rows <- rows
    f.col <- f.row <- 1
    if (show.given[1]) {
        total.rows <- rows + 1
        f.row <- rows/total.rows
    }
    if (have.b && show.given[2]) {
        total.columns <- columns + 1
        f.col <- columns/total.columns
    }
    opar <- par(mfrow = c(total.rows, total.columns), oma = if (have.b) 
        rep(5, 4)
    else c(5, 6, 5, 4), mar = if (have.b) 
        rep(0, 4)
    else c(0.5, 0, 0.5, 0), new = FALSE)
    on.exit(par(opar))
    plot.new()
    if (missing(xlim)) 
        xlim <- range(x[is.finite(x)])
    if (missing(ylim)) 
        ylim <- range(y[is.finite(y)])
    pch <- rep(pch, length = nobs)
    col <- rep(col, length = nobs)
    do.panel <- function(index, subscripts = FALSE) {
        istart <- (total.rows - rows) + 1
        i <- total.rows - ((index - 1)%/%columns)
        j <- (index - 1)%%columns + 1
        par(mfg = c(i, j, total.rows, total.columns))
        plot.new()
        plot.window(xlim, ylim, log = "")
        if (any(is.na(id))) 
            id[is.na(id)] <- FALSE
        if (any(id)) {
            grid(lty = "solid")
            if (subscripts) 
                panel(x[id], y[id], subscripts = id, col = col[id], 
                  pch = pch[id], ...)
            else panel(x[id], y[id], col = col[id], pch = pch[id], 
                ...)
        }
        if ((i == total.rows) && (j%%2 == 0)) 
            if (nlevels(x) > 0)
              axis(1, labels = levels(x), xpd = NA)
            else
              axis(1, xpd = NA)
        else if ((i == istart || index + columns > nplots) && 
            (j%%2 == 1)) 
            if (nlevels(x) > 0)
              axis(3, labels = levels(x), xpd = NA)
            else
              axis(3, xpd = NA)
        if ((j == 1) && ((total.rows - i)%%2 == 0))
            if (nlevels(y) > 0)
              axis(2, labels = levels(y), xpd = NA)
            else
              axis(2, xpd = NA)
        else if ((j == columns || index == nplots) && ((total.rows - 
            i)%%2 == 1))
            if (nlevels(y) > 0)
              axis(4, labels = levels(y), xpd = NA)
            else
              axis(4, xpd = NA)
        box()
    }
    if (have.b) {
        count <- 1
        for (i in 1:rows) {
            for (j in 1:columns) {
                id <- ((a.intervals[j, 1] <= a) & (a <= a.intervals[j, 
                  2]) & (b.intervals[i, 1] <= b) & (b <= b.intervals[i, 
                  2]))
                do.panel(count, subscripts)
                count <- count + 1
            }
        }
    }
    else {
        for (i in 1:nplots) {
            id <- ((a.intervals[i, 1] <= a) & (a <= a.intervals[i, 
                2]))
            do.panel(i, subscripts)
        }
    }
    mtext(xlab[1], side = 1, at = 0.5 * f.col, outer = TRUE, 
        line = 3.5, xpd = NA)
    mtext(ylab[1], side = 2, at = 0.5 * f.row, outer = TRUE, 
        line = 3.5, xpd = NA)
    if (length(xlab) == 1) 
        xlab <- c(xlab, paste("Given :", a.name))
    if (show.given[1]) {
        mar <- par("mar")
        nmar <- mar + c(4, 0, 0, 0)
        par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
        plot.new()
        nint <- nrow(a.intervals)
        pwoffs <- nint / 32
        plot.window(c(min(a.intervals[is.finite(a.intervals)] + pwoffs),
                      max(a.intervals[is.finite(a.intervals)]) - pwoffs),
                    0.5 + c(0, nint), log = "")
        rect(a.intervals[, 1], 1:nint - 0.5, a.intervals[, 2], 
            1:nint + 0.5, col = gray(0.95))
        if (!is.null(a.levels)) {
            mid <- apply(a.intervals, 1, mean)
            text(mid, 1:nint, a.levels)
            NULL
        }
        axis(3, labels = FALSE, tick = FALSE, xpd = NA)
        axis(1, labels = FALSE, tick = FALSE)
        box(col = "grey")
        mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
            line = 3, xpd = NA)
    }
    else {
        mtext(xlab[2], side = 3, at = 0.5 * f.col, line = 3.25, 
            outer = TRUE, xpd = NA)
    }
    if (have.b) {
        if (length(ylab) == 1) 
            ylab <- c(ylab, paste("Given :", b.name))
        if (show.given[2]) {
            nmar <- mar + c(0, 4, 0, 0)
            par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
            plot.new()
            nint <- nrow(b.intervals)
            pwoffs <- nint / 32
            plot.window(0.5 + c(0, nint),
                        c(min(b.intervals[is.finite(b.intervals)] + pwoffs),
                          max(b.intervals[is.finite(b.intervals)]) - pwoffs),
                        log = "")
            rect(1:nint - 0.5, b.intervals[, 1], 1:nint + 0.5, 
                b.intervals[, 2], col = gray(0.95))
            if (!is.null(b.levels)) {
                mid <- apply(b.intervals, 1, mean)
                text(1:nint, mid, b.levels, srt = 90)
                NULL
            }
            axis(4, labels = FALSE, tick = FALSE, xpd = NA)
            axis(2, labels = FALSE, tick = FALSE)
            box(col = "grey")
            mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                line = 3, xpd = NA)
        }
        else {
            mtext(ylab[2], side = 4, at = 0.5 * f.row, line = 3.25, 
                outer = TRUE, xpd = NA)
        }
    }
    if (length(missingrows) > 0) {
        cat("\nMissing rows:", missingrows, "\n")
        invisible(missingrows)
    }
}

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="test.asc"

RDA1
5 0
9 row.names
5 names
5 class
6 levels
3 cxt
2 0 0
1 0 0
5
-1
19 0 1
4
13 0 1
90
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
2 0 0
1 0 0
4
-1
16 0 0
5
 3 WSA
 3 WSB
 3 WSC
 3 WSD
 3 WSE
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

13 0 1
90
 2
 2
 2
 2
 3
 4
 4
 4
 4
 5
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 2
 2
 2
 4
 4
 4
 4
 5
 5
 5
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 2
 2
 2
 4
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 4
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 3
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
2 0 0
1 0 0
4
-1
16 0 0
6
 2 Br
 2 Cr
 2 Ni
 3 PCP
 3 SRB
 3 URA
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

13 0 1
90
 1
 2
 4
 4
 4
 1
 2
 3
 4
 1
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 4
 4
 1
 2
 3
 4
 1
 3
 3
 4
 4
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 4
 4
 1
 2
 3
 4
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 2
 4
 1
 2
 3
 4
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 2
 4
 4
 1
 3
 4
 3
 4
 1
 1
 1
 1
 1
2 0 0
1 0 0
4
-1
16 0 0
4
 1 1
 2 20
 2 21
 2 22
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

14 0 0
90
 0.88690446
 0.88690513
 -0.008582909999999999
 0.84140389
 0.01547746
 0.82645292
 0.82645427
 0.76571345
 0.8263521
 0.37570381
 0.40361484
 0.40384806
 0.74884711
 0.94859763
 0.96677452
 0.97557102
 0.9832513000000001
 0.98572282
 0.99349502
 0.11416688
 0.8122289
 0.11418351
 0.88183559
 0.09723225000000001
 0.88183561
 0.83853386
 0.83863709
 0.74681656
 0.83251071
 0.8454432
 0.75563716
 0.92634558
 0.84537136
 0.97884589
 0.73673004
 0.96747265
 0.97369701
 0.98715169
 0.9914865
 0.99328531
 0.99652316
 0.25447211
 0.30372693
 0.25373806
 0.30371362
 0.2327828
 0.25372631
 0.96173564
 0.97069235
 0.95462282
 0.95459587
 0.91341539
 0.98234451
 0.60740805
 0.77592908
 0.93602096
 0.9867878
 0.98751514
 0.99363163
 0.9859177
 0.83318812
 0.83308551
 0.95750996
 0.91218418
 0.91217945
 0.8623662
 0.90722619
 0.89806433
 0.546805
 0.9623669500000001
 0.97003306
 0.97554032
 0.98202711
 0.98297822
 0.98880629
 0.99688566
 0.80436417
 0.88417903
 0.80423433
 0.45605293
 0.95874106
 0.56694216
 0.95734593
 0.87062068
 0.96359899
 0.9355361
 0.9629377
 0.96566601
 0.9679529100000001
 0.9834591
-1

2 0 0
1 0 0
3
-1
16 0 0
1
 10 data.frame
-1
2 0 0
1 0 0
2
-1
16 0 0
4
 6 loc.id
 7 chem.id
 4 mode
 6 fitpar
-1
2 0 0
1 0 0
1
-1
16 0 0
90
 1 1
 1 2
 1 3
 1 4
 1 5
 1 6
 1 7
 1 8
 1 9
 2 10
 2 11
 2 12
 2 13
 2 14
 2 15
 2 16
 2 17
 2 18
 2 19
 2 20
 2 21
 2 22
 2 23
 2 24
 2 25
 2 26
 2 27
 2 28
 2 29
 2 30
 2 31
 2 32
 2 33
 2 34
 2 35
 2 36
 2 37
 2 38
 2 39
 2 40
 2 41
 2 42
 2 43
 2 44
 2 45
 2 46
 2 47
 2 48
 2 49
 2 50
 2 51
 2 52
 2 53
 2 54
 2 55
 2 56
 2 57
 2 58
 2 59
 2 60
 2 61
 2 62
 2 63
 2 64
 2 65
 2 66
 2 67
 2 68
 2 69
 2 70
 2 71
 2 72
 2 73
 2 74
 2 75
 2 76
 2 77
 2 78
 2 79
 2 80
 2 81
 2 82
 2 83
 2 84
 2 85
 2 86
 2 87
 2 88
 2 89
 2 90
-1
-1
-1
-1
-1
-1
-1

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="coplot_sample.R"

load("test.asc")
mycoplot(cxt$fitpar ~ unclass(cxt$loc.id)|
         cxt$chem.id * cxt$mode,
         panel = points,
         bg = "blue",
         col = "blue",
         pch = 21,
         xlab = c("Location", "Contaminant"),
         ylab = c(label, "CXTFit-Mode"),
         ylim = c(0.6,1)
       )


coplot(cxt$fitpar ~ unclass(cxt$loc.id)|
         cxt$chem.id * cxt$mode,
         panel = points,
         bg = "blue",
         col = "blue",
         pch = 21,
         xlab = c("Location", "Contaminant"),
         ylab = c(label, "CXTFit-Mode"),
         ylim = c(0.6,1)
       )

---1149173172-1804289383-983267779=:26068--
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Feb 27 14:52:35 2001
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 27 Feb 2001 15:52:35 +0100
Subject: [Rd] Patch to coplot.R
In-Reply-To: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>
References: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>
Message-ID: <15003.48947.624227.304611@gargle.gargle.HOWL>

>>>>> "Thomas" == Thomas Baumann <thomas.baumann@ch.tum.de> writes:

      ...

    Thomas> Please find attached a diff for coplot which you may want to
    Thomas> consider for the next release. 

Thank you, Thomas!

    Thomas> The diff is against R 1.2.2. 

unfortunately *not* :

-------- sorry for the excursion --- but I must say this loudly ---
	 {it's by far not the first time, and it's a real pain for us
 	 merging the code!}

  Please -- everyone -- do not consider the output

      > functionname

  (or ESS/Emacs C-c C-d)
  as the source of function  functionname.

  There is only one source, and that is in 
	R-<version>/src/library/<pkg>/R/<foobar>.R
  in our case in
	    R-1.2.2/src/library/base/R/coplot.R

  Again: 
    Please, please do NOT ever patch against the output of typing the
    function name, but please diff against the real source...


---------- end of excursion --------------------

    Thomas> Thanks for looking at the code.

I've been doing that for a bit, now ..


    Thomas> The reasons for this patch are:

    Thomas> 1. The boxes of coplot did not align very well with the panel
    Thomas> graphs if applied to a factor

hmm, well, that's also a matter of taste, but I tend to agree with your
choice (though it slightly complicates the code).

    Thomas> 2. Putting the levels as axis labels instead of just numbers
    Thomas> makes the plot more readable

yes, unless the levels happen to be 10-letter words -- which seems to
happen for some data / people. 
I think one should make this an option (on by default), and also consider using
abbreviate(levels(x), ...) 

    Thomas> I also include a sample dataset (test.asc) and a sample program
    Thomas> to show the differences.

thanks, these *were* useful.

Note however, that you changed more.
We had explicitly 
   - empty boxes when conditioning on  ordinal variables (aka factors)
   - gray boxes  when using "shingles", i.e. conditioning on continuous vars.

you have all boxes gray which I don't necessarily prefer.
(and you should say that you were changing this, too...).
One could consider using two different kinds of gray for the two,
very light gray for factors, darker one for `shingle bars'.

I'm a bit reluctant to change this; R has been a `ripe' piece of software
for a while and people don't necessarily want to see changes that they
can't easily revert.  Hence, the two bg colors (bar backgrounds) would
become function arguments as well....

opinions?

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas.baumann@ch.tum.de  Tue Feb 27 15:53:47 2001
From: thomas.baumann@ch.tum.de (thomas.baumann@ch.tum.de)
Date: Tue, 27 Feb 2001 16:53:47 +0100 (CET)
Subject: [Rd] Patch to coplot.R
In-Reply-To: <15003.48947.624227.304611@gargle.gargle.HOWL>
Message-ID: <200102271553.f1RFrm808369@norvel.ws.chemie.tu-muenchen.de>



On 27 Feb, Martin Maechler wrote:
> ---------- end of excursion --------------------

sorry for any inconvenience, the next patches will definitely be against
the real source.

> you have all boxes gray which I don't necessarily prefer.
> (and you should say that you were changing this, too...).
> One could consider using two different kinds of gray for the two,
> very light gray for factors, darker one for `shingle bars'.
> 
> I'm a bit reluctant to change this; R has been a `ripe' piece of software
> for a while and people don't necessarily want to see changes that they
> can't easily revert.  Hence, the two bg colors (bar backgrounds) would
> become function arguments as well....
> 
> opinions?

I fully agree with your opinion, since I do not like having all the
automatically generated diagrams looking different after an update. But
an easy option would be nice...

Thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Tue Feb 27 22:13:09 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Wed, 28 Feb 2001 11:13:09 +1300
Subject: [Rd] Plotting points on a filled.contour plot (PR#857)
References: <200102270900.KAA23881@pubhealth.ku.dk>
Message-ID: <003501c0a10a$77f7b040$175dd882@stat.auckland.ac.nz>

Hi


> When adding points to a filled.contour plot they do not appear at the
correct
> coordinates.
> The following code demonstrates this.
>
> a<-expand.grid(1:20,1:20)
> b<-matrix(a[,1]+a[,2],20)
> filled.contour(x=1:20,y=1:20,z=b)
> points(10,10)


The problem here is that filled.contour is actually a combination of two
plots;  one is the filled contour and one is the legend.  filled.contour
sets up two separate coordinate systems for these two plots, but only does
so internally - once the function has returned these coordinate systems are
lost.  In order to access the coordinate system of the main contour plot you
can specify graphics commands in the plot.axes argument.  For example, in
your case, replace your call to filled.contour with the following, and all
is as it should be ...

filled.contour(x=1:20,y=1:20,z=b,plot.axes={axis(1);axis(2);points(10,10)})

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gilb@home.com  Wed Feb 28 15:43:19 2001
From: gilb@home.com (Paul Gilbert)
Date: Wed, 28 Feb 2001 10:43:19 -0500
Subject: [Rd] -malign-double
Message-ID: <3A9D1C96.FE7CF73A@home.com>

I was just looking at the documentation for g77 and noticed the
following, and also noticed that it is not used when fortran for a
package is compiled with the default (i.e. no Makefile in src
directory.)  Should it be considered?

Paul Gilbert
_____
`-malign-double'
     (Intel x86 architecture only.)

     Noticeably improves performance of `g77' programs making heavy use
     of `REAL(KIND=2)' (`DOUBLE PRECISION') data on some systems.  In
     particular, systems using Pentium, Pentium Pro, 586, and 686
     implementations of the i386 architecture execute programs faster
     when `REAL(KIND=2)' (`DOUBLE PRECISION') data are aligned on
     64-bit boundaries in memory.

     This option can, at least, make benchmark results more consistent
     across various system configurations, versions of the program, and
     data sets.

     *Note:* The warning in the `gcc' documentation about this option
     does not apply, generally speaking, to Fortran code compiled by
     `g77'.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb 28 18:44:26 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 28 Feb 2001 19:44:26 +0100
Subject: [Rd] Re: [R] re: Spatial stats: R vs. Splus
In-Reply-To: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk>
References: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk>
Message-ID: <15005.18186.355531.588114@mithrandir.hornik.net>

>>>>> Paulo Justiniano Ribeiro writes:

> Hi Kenneth
> Depends on what you are looking for, concerning methods for spatial data.

> At CRAN you will find the packages:

> 1) spatial, by Venables & Ripley, as part of the bundle VR
> This packages does some geostatistical and point process analysis

> 2) splancs by Rowlings, Diggle and ported by  Bivand
> For point process

> 3) sgeostats by Majure and proted by Gedhardt
> For geostatistics

> And outside CRAN I know about:

> 4) geoR by Ribeiro and Diggle,
> For (model-based) geostatistics
> available at: www.maths.lancs.ac.uk/~ribeiro.geoR.html

Are there any plans for making this available via CRAN?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Timothy.Keitt@StonyBrook.Edu  Wed Feb 28 20:11:08 2001
From: Timothy.Keitt@StonyBrook.Edu (Timothy H. Keitt)
Date: Wed, 28 Feb 2001 15:11:08 -0500
Subject: [Rd] Re: [R] re: Spatial stats: R vs. Splus
References: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk> <15005.18186.355531.588114@mithrandir.hornik.net>
Message-ID: <3A9D5B5C.8010604@StonyBrook.Edu>

Nice package.  I second the motion (for CRAN).

T.

Kurt Hornik wrote:

>>>>>> Paulo Justiniano Ribeiro writes:
>>>>> 
>> 4) geoR by Ribeiro and Diggle,
>> For (model-based) geostatistics
>> available at: www.maths.lancs.ac.uk/~ribeiro.geoR.html
> 
> Are there any plans for making this available via CRAN?
> 

-- 
Timothy H. Keitt
Department of Ecology and Evolution
State University of New York at Stony Brook
Phone: 631-632-1101, FAX: 631-632-7626
http://life.bio.sunysb.edu/ee/keitt/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Thu Feb  1 01:13:12 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Thu, 1 Feb 2001 02:13:12 +0100 (MET)
Subject: [Rd] screen can't go back to log="y" plot (PR#831)
Message-ID: <200102010113.CAA25183@pubhealth.ku.dk>


Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> [I have abbreviated the subject as jitterbug has been having probems
> with long subjects.]
> 
> The issue here is that one cannot mix log/non-log axes in the calls to
> screen(), as the appropriate par() parameter is read-only, but the
> meaning of yaxp depends on it.  But beyond that you can't set
> x/yaxp for log axes.
> 
> You should be able to do this: you can in the S original.
> 
> A simpler version:
> 
> plot (1:2, 1:2, log="y", main="1")
> zz <- par("yaxp")
> zz
> [1]  1  2 -5
> par(yaxp=zz)
> Error in par(yaxp = zz) : invalid value specified for graphics parameter
> "yaxp".
> 
> So you can't reset the yaxp parameter to what it is reported as!
[snip]

The code in main/par.c ignores the value of xlog (or ylog) when
setting xaxp (or yaxp).  Right now you have in Specify (and Specify2):

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        posIntCheck((int) (REAL(value)[2]), what);

Shouldn't that be something like:

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        if (dd->gp.xlog)
            logAxpCheck((int) (REAL(value)[2]), what);
        else
            posIntCheck((int) (REAL(value)[2]), what);

Where logAxpCheck is suitably defined as:

static void logAxpCheck(int x, char *s)
{
    if (x == NA_INTEGER || x == 0 || x > 4)
	par_error(s);
}

since only values < 0 or the values 1, 2, 3 are allowed?


> Additional bug: the meaning of x/yaxp for log axes is not defined
> in help(par).

excerpt from help(par):

    xaxp: A vector of the form `c(x1, x2, n)' giving the coordinates
          of the extreme tick marks and the number of intervals
          between tick-marks.

Could you add:

          The value of n must be positive for linear scale axes.  For
          logarithmic scale axes n must be either negative (then there
          will be (1-n) ticks at a linear distance) or one of 1, 2, or
          3 where n then indicates the number of ticks per decade.

similar for yaxp?  What am I missing?
Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Thu Feb  1 09:07:10 2001
From: adrian@olsen.ch (adrian@olsen.ch)
Date: Thu, 1 Feb 2001 10:07:10 +0100 (MET)
Subject: [Rd] inconsistent behaviour between class() and inherits() (PR#834)
Message-ID: <200102010907.KAA29138@pubhealth.ku.dk>

Example:

> x<-ts(rnorm(10))
> y<-ts(rnorm(10))
> r<-residuals(lm(y~x))
> is.ts(r)
[1] FALSE
> inherits(r,"ts")
[1] FALSE
> class(r)
[1] "ts"
> is.ts(x)
[1] TRUE
> inherits(x,"ts")
[1] TRUE
> class(x)
[1] "ts"


--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.5.1
 arch = sparc
 os = solaris2.5.1
 system = sparc, solaris2.5.1
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:olsen, package:ffnet, package:tseries, package:ts, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From james.lindsey@luc.ac.be  Thu Feb  1 09:56:07 2001
From: james.lindsey@luc.ac.be (james.lindsey@luc.ac.be)
Date: Thu, 1 Feb 2001 10:56:07 +0100 (MET)
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <200102010956.KAA29982@pubhealth.ku.dk>

The following seems to be a contradiction:

> df <- data.frame(x=gl(2,1,10))
> df[,1]
 [1] 1 2 1 2 1 2 1 2 1 2
Levels:  1 2 
> df[,1,drop=F]
   x
1  1
2  2
3  1
4  2
5  1
6  2
7  1
8  2
9  1
10 2
> is.factor(df[,1,drop=F])
[1] FALSE
> is.factor(df[,1])
[1] TRUE

with R1.2.1 both MS Windows and Intel RH5.2 versions.
 Jim

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb  1 10:15:26 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 1 Feb 2001 11:15:26 +0100 (MET)
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <200102011015.LAA00372@pubhealth.ku.dk>

> From: james.lindsey@luc.ac.be
> Date: Thu, 1 Feb 2001 10:56:07 +0100 (MET)
> 
> The following seems to be a contradiction:

What is, pray?

> class(df[, 1])
[1] "factor"
> class(df[, 1, drop = FALSE])
[1] "data.frame"

df[ , 1, drop=FALSE] is a data frame, so not a factor.
df[ , 1] is a factor.

> > df <- data.frame(x=gl(2,1,10))
> > df[,1]
>  [1] 1 2 1 2 1 2 1 2 1 2
> Levels:  1 2 
> > df[,1,drop=F]
>    x
> 1  1
> 2  2
> 3  1
> 4  2
> 5  1
> 6  2
> 7  1
> 8  2
> 9  1
> 10 2
> > is.factor(df[,1,drop=F])
> [1] FALSE
> > is.factor(df[,1])
> [1] TRUE
> 
> with R1.2.1 both MS Windows and Intel RH5.2 versions.
>  Jim

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From duncan@research.bell-labs.com  Thu Feb  1 12:45:15 2001
From: duncan@research.bell-labs.com (Duncan Temple Lang)
Date: Thu, 1 Feb 2001 07:45:15 -0500 (EST)
Subject: [Rd] Is Omegahat in R a general language function bus ?
Message-ID: <200102011245.HAA04008@jessie.research.bell-labs.com>


> Date: Tue, 30 Jan 2001 14:51:49 +0000
> From: David K Walker <dkwalker@online.no>
> Sender: owner-r-devel@stat.math.ethz.ch
> Precedence: bulk
> 
> Hi !
> 
> Can we e.g. embed Perl in R and embed R in Java, start the program counter
> in Java, call from Java to Perl via R, and then either (1) call back from
> Perl to Java via R or (2) just plain return from Perl to Java via R ?

Conceptually, Omegahat can act in this way as a broker or bus
connecting two other languages within R. However, in practice, I think
one would be less inclined to use this approach than finding a more
direct communication mechanism, in this case between Perl and Java.
And indeed there is such a mechanism -- JPL -- and it is more than
likeley available in your Perl installation (perhaps not compiled).
Code in these two languages could communicate with each other using
this mechanism and both could be running within R and communicating
with S code via the .Perl, .Java and callback mechanisms.

Using Omegahat as the broker would involve an extra layer of
conversion. Even if this were not an issue for performance in a
particular project, it certainly is a more complex setup to debug.  If
there were not already a tool for this pair of languages (Perl and
Java), it might indeed make sense to use Omegahat as a "quickly"
deployed prototype. 



> My reason for asking this is general interest in extensible programming
> languages.  My background is heavy in Forth, moderate in assembly language,
> so far very light in Scheme, R, Java, Perl, XML, Python.  Later I hope to
> implement new statistical software and port an existing large scale time
> series database/editor/tablewriter as packages under Debian
> Gnu/Linux.

And it is very much our goal in developing the collection of Omegahat
inter-system interface packages to facilitate this type of development
with the minimal amount of re-development. So it would be good to find
out what is needed and see how these interfaces can be adapted to such
needs.  Perhaps it would be good to discuss these on the omegahat
development list (omega-devel@omegahat.org) or directly with me.

> 
> David Walker
> 

 All the best,
  Duncan

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lhecking@nmrc.ie  Thu Feb  1 18:41:19 2001
From: lhecking@nmrc.ie (lhecking@nmrc.ie)
Date: Thu, 1 Feb 2001 19:41:19 +0100 (MET)
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
Message-ID: <200102011841.TAA08532@pubhealth.ku.dk>


 Unless I force the Fortran compiler through --with-g77, configure fails to
 find and use the installed g77. I would submit a patch for configure.in,
 but I can't quite follow the logic in configure.in.

$ ./configure 
creating cache ./config.cache
[...]
checking for main in -lm... yes
checking for g77... /usr/local/gnu/bin/g77
checking for fort77... (cached) /usr/local/gnu/bin/g77
checking for f77... (cached) /usr/local/gnu/bin/g77
checking for f90... (cached) /usr/local/gnu/bin/g77
checking for xlf... (cached) /usr/local/gnu/bin/g77
checking for cf77... (cached) /usr/local/gnu/bin/g77
checking for fc... (cached) /usr/local/gnu/bin/g77
checking for f2c... no
configure: error: Neither an F77 compiler nor f2c found
$ 


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Thu Feb  1 19:20:41 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Thu, 1 Feb 2001 20:20:41 +0100 (MET)
Subject: [Rd] screen doesn't handle redrawing properly (PR#837)
Message-ID: <200102011920.UAA08731@pubhealth.ku.dk>


Hi.  As far as I understand it, there is a list of graphic primitives
stored for a device.  So for example, when I iconify/deiconify an X11
window, the plot will be redrawn.  Now screen (split.screen and
friends) appear not to handle this list properly, the list is reset or
not reset at odd times.  The commands below will show clearly what I
mean.  There are two effects:

  - After splitting the device real estate into two screens, I can
    plot on these screens, alternating between them.  When I then
    touch the window to force a redraw, *all* the plots are redrawn,
    not just the last (and visible) ones.
    [This happens when the X server runs on AIX, R runs on AIX or Sun.]

  - Again, after splitting, plotting on one screen can affect the
    other screen.  I.e. plot(...); plot (...) on the left screen can
    erase the *right* screen.
    [This happens for all platforms I have access to, AIX, Linux, Sun.]

The first effect may be due to a bad interaction with the X server,
but the second effect is surely not desirable, is it?  Am I mis-using
'screen' here?

R> split.screen (c(1,2))
[1] 1 2
R> # Draw 10000 points to make the effect obvious
R> screen (1)
R> plot (1:10000, 1:10000, main="1")
R> screen (2)
R> plot (1:10000, 1:10000, main="2")
R> # Ok, go back to screen 1, draw plots 3 and 4
R> screen (1)
R> plot (1:10000, 10000:1, main="3")
R> screen (2)
R> plot (1:10000, 10000:1, main="4")
R> 
R> ########################################
R> # NOW lower/raise window, do something to force device to redraw itself.
R> # You'll see again plot 1 (!), 2 (!), 3, and 4.  Why 1 and 2?
R> ########################################
R> 
R> # Here's how to erase screen 2 from screen 1 (!)
R> screen (1)
R> plot (1:10, 1:10, main="3a")
R> ########################################
R> # The following plot will erase screen 2
R> ########################################
R> plot (1:10, 1:10, main="3b")
R> 
R> # The good news is that this resets the list of graphic ops:
R> screen (2)
R> plot (1:10, 1:10, main="4")
R> # Now if you touch the window, you'll see only plot 3b and 4.

Regards,
  -tom

R> R.version
         _                   
platform sparc-sun-solaris2.7
arch     sparc               
os       solaris2.7          
system   sparc, solaris2.7   
status   Patched             
major    1                   
minor    2.1                 
year     2001                
month    01                  
day      31                  
language R                   

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@CMIS.CSIRO.AU  Fri Feb  2 07:30:09 2001
From: Bill.Venables@CMIS.CSIRO.AU (Bill.Venables@CMIS.CSIRO.AU)
Date: Fri, 2 Feb 2001 17:30:09 +1000
Subject: [Rd] factors in data.frames (PR#835)
Message-ID: <2B7F04539DAFD311B61D009027D0DDA20C3C85@roper-cv.qld.cmis.CSIRO.AU>



| -----Original Message-----
| From: james.lindsey@luc.ac.be [mailto:james.lindsey@luc.ac.be]
| Sent: Thursday, 1 February 2001 19:56
| To: r-devel@stat.math.ethz.ch
| Cc: R-bugs@biostat.ku.dk
| Subject: [Rd] factors in data.frames (PR#835)
| 
| 
| The following seems to be a contradiction:
| 
| > df <- data.frame(x=gl(2,1,10))
| > df[,1]
|  [1] 1 2 1 2 1 2 1 2 1 2
| Levels:  1 2 
| > df[,1,drop=F]
|    x
| 1  1
| 2  2
| 3  1
| 4  2
| 5  1
| 6  2
| 7  1
| 8  2
| 9  1
| 10 2
| > is.factor(df[,1,drop=F])
| [1] FALSE
| > is.factor(df[,1])
| [1] TRUE
| 
| with R1.2.1 both MS Windows and Intel RH5.2 versions.
|  Jim

Eh?  df[,1,drop = F] is a data frame with one component and hence NOT a
factor 
 but df[,1] is one (factor) component of a fata frame and hence IS a factor.

I think it is entirely consistent with the advertised behaviour.

Bill.

| 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Feb  2 20:26:25 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 2 Feb 2001 21:26:25 +0100
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
In-Reply-To: <200102011841.TAA08532@pubhealth.ku.dk>
References: <200102011841.TAA08532@pubhealth.ku.dk>
Message-ID: <14971.6129.767816.279330@mithrandir.hornik.net>

>>>>> lhecking  writes:

>  Unless I force the Fortran compiler through --with-g77, configure fails to
>  find and use the installed g77. I would submit a patch for configure.in,
>  but I can't quite follow the logic in configure.in.

> $ ./configure 
> creating cache ./config.cache
> [...]
> checking for main in -lm... yes
> checking for g77... /usr/local/gnu/bin/g77
> checking for fort77... (cached) /usr/local/gnu/bin/g77
> checking for f77... (cached) /usr/local/gnu/bin/g77
> checking for f90... (cached) /usr/local/gnu/bin/g77
> checking for xlf... (cached) /usr/local/gnu/bin/g77
> checking for cf77... (cached) /usr/local/gnu/bin/g77
> checking for fc... (cached) /usr/local/gnu/bin/g77
> checking for f2c... no
> configure: error: Neither an F77 compiler nor f2c found
> $ 

It might have been helpful to use bug.report() ...

Which platform is this?
Apparently /usr/local/gnu/bin/g77 is the GNU C compiler?
What happens if you do

F77=/usr/local/gnu/bin/g77
file ${F77} | grep script

???

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lhecking@nmrc.ie  Sat Feb  3 16:11:13 2001
From: lhecking@nmrc.ie (Lars Hecking)
Date: Sat, 3 Feb 2001 16:11:13 +0000
Subject: [Rd] configure bug in R-1.2.1 and earlier (PR#836)
In-Reply-To: <14971.6129.767816.279330@mithrandir.hornik.net>; from Kurt.Hornik@ci.tuwien.ac.at on Fri, Feb 02, 2001 at 09:26:25PM +0100
References: <200102011841.TAA08532@pubhealth.ku.dk> <14971.6129.767816.279330@mithrandir.hornik.net>
Message-ID: <20010203161113.B3001@nmrc.ie>


> It might have been helpful to use bug.report() ...
 
 I'm not a user of R, I just install the stuff :)

> Which platform is this?

 Solaris 7 SPARC.

> Apparently /usr/local/gnu/bin/g77 is the GNU C compiler?
> What happens if you do
> 
> F77=/usr/local/gnu/bin/g77
> file ${F77} | grep script

$ file /usr/local/gnu/bin/g77
/usr/local/gnu/bin/g77: executable shell script
$ 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Sat Feb  3 19:27:47 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 03 Feb 2001 14:27:47 -0500
Subject: [Rd] tk non-widget commands (esp. update and winfo)
Message-ID: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>


Hi,

I've been playing with the tcltk package.  It's very nice to have
access to buttons, menus etc. now.  Thank you!

Alas, I also have questions: In Tcl everything is a string [*].  This
is not the case in R, of course.  So why are return values of tk
commands still strings?  (Is there any other reason than speed or
"package is work in progress"?)

Example:

   > tt <- tktoplevel ()
   > tkwinfo ("width", tt)
  [1] "200"

Could (Should?) be:

   > tt <- tktoplevel ()
   > tkwinfo ("width", tt)
  [1] 200

with 
   > tkwidth <- function (widget) as.numeric (tkcmd ("winfo", "width", widget))

Maybe a better example is the use of logical results:

  > if (tkwinfo ("exists", tt)) cat ("exists\n")
  Error in if (tkwinfo("exists", tt)) cat("exists\n") : 
          argument of if(*) is not interpretable as logical

Huh? Here you might have expected:

  > if (tkexists (tt)) cat ("exists\n")
  exists

with
  > tkexists <- function (widget) (tkcmd ("winfo", "exists", widget) == "1")

One problem is that the number of functions just explodes, so it might
be better to wrap them into one enchillada?

  >  tkwinfo <- function (widget, what="exists", ...) 
     switch (what,
             exists=tkcmd("winfo", "exists", widget)=="1",
             ismapped=tkcmd("winfo", "ismapped", widget)=="1",
             width=as.numeric (tkcmd("winfo", "width", widget)),
             height=as.numeric (tkcmd("winfo", "height", widget)),
             tkcmd ("winfo", what, widget, ...))

(The other problem is that tkcmd("winfo",...) may fail.)

Oh, while I'm at it:  There is no tkupdate:
  >  tkupdate <- function (idletasks=FALSE)
     if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")

(which is essential to making sure that a window is mapped before its
width or height is queried.)  That's trivial if you have hacked Tcl/Tk
before -- so who is the package tlctk aimed at?

Regards,
  -tom


[*] Nowadays, they have glorified strings into objects.  Anywho...

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Feb  3 20:05:06 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 03 Feb 2001 21:05:06 +0100
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Thomas Vogels's message of "03 Feb 2001 14:27:47 -0500"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>
Message-ID: <x2n1c3353h.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@ece.cmu.edu> writes:

> Hi,
> 
> I've been playing with the tcltk package.  It's very nice to have
> access to buttons, menus etc. now.  Thank you!
> 
> Alas, I also have questions: In Tcl everything is a string [*].  This
> is not the case in R, of course.  So why are return values of tk
> commands still strings?  (Is there any other reason than speed or
> "package is work in progress"?)

The latter. Also to some extent the fact that it requires more
knowledge about the content of the return value. The argument passing
scheme is as you can see quite general and essentially ignorant of the
routines that are called. In essence the issue is that it is fairly
easy to convert whatever to strings, but harder the other way around.
So for the first iteration of the package, the idea would be to have
the user do the necessary as.xxx conversions of return values.

> One problem is that the number of functions just explodes, so it might
> be better to wrap them into one enchillada?
> 
>   >  tkwinfo <- function (widget, what="exists", ...) 
>      switch (what,
>              exists=tkcmd("winfo", "exists", widget)=="1",
>              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
>              width=as.numeric (tkcmd("winfo", "width", widget)),
>              height=as.numeric (tkcmd("winfo", "height", widget)),
>              tkcmd ("winfo", what, widget, ...))
> 
> (The other problem is that tkcmd("winfo",...) may fail.)
> 
> Oh, while I'm at it:  There is no tkupdate:
>   >  tkupdate <- function (idletasks=FALSE)
>      if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")
> 
> (which is essential to making sure that a window is mapped before its
> width or height is queried.)  That's trivial if you have hacked Tcl/Tk
> before -- so who is the package tlctk aimed at?

Tcl/Tk hackers of course, the author of the package not being one...

Basically, the plan is to add stuff as it becomes necessary to do
useful things, so feedback and suggestions from developers are always
welcome.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Feb  4 14:38:05 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 04 Feb 2001 15:38:05 +0100
Subject: [Rd] help with build on windows needed.
Message-ID: <3A7D694D.EA43CA59@univie.ac.at>

i installed r for window 1.2.1
and suddenly
rcmd build 
does not work any more.

C:\work\checked.out>rcmd build
Please set TMPDIR to a valid temporary directory

C:\work\checked.out>echo %TMPDIR%
C:\Documents and Settings\Erich Neuwirth\Local Settings\Temp

and this is a valid directory.

things worked smoothly in 1.2.0

what can i do?



--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb  4 15:48:33 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 4 Feb 2001 15:48:33 +0000 (GMT)
Subject: [Rd] help with build on windows needed.
In-Reply-To: <3A7D694D.EA43CA59@univie.ac.at>
Message-ID: <Pine.GSO.4.31.0102041542460.21221-100000@toucan.stats>

On Sun, 4 Feb 2001, Erich Neuwirth wrote:

> i installed r for window 1.2.1
> and suddenly
> rcmd build
> does not work any more.
>
> C:\work\checked.out>rcmd build
> Please set TMPDIR to a valid temporary directory
>
> C:\work\checked.out>echo %TMPDIR%
> C:\Documents and Settings\Erich Neuwirth\Local Settings\Temp
>
> and this is a valid directory.
>
> things worked smoothly in 1.2.0
>
> what can i do?

Win2k, right?  It's a Windows Perl bug, already discussed a couple
of times here or R-help.  In rw1021/bin/build replace

        unless (-d $TMPDIR);
by

        unless (-e $tmpdir);

Basically, -d is not working properly on any Windows platform, but it
is incorrectly mostly returning false on Win2K, and always true on NT4.

It's possible that you need
        unless (-e '$tmpdir');

if so, please let me know.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Feb  4 18:00:34 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 04 Feb 2001 19:00:34 +0100
Subject: [Rd] Rcsound
Message-ID: <3A7D98C2.A6D18B98@univie.ac.at>

there is a new version of my "R sings" package
no functional changes, but more stable and reliable on windows.
feedback about unix needed!

http://sunsite.univie.ac.at/~neuwirth/Rcsound/


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From daniel.egloff@dplanet.ch  Sun Feb  4 21:37:36 2001
From: daniel.egloff@dplanet.ch (daniel.egloff@dplanet.ch)
Date: Sun, 4 Feb 2001 22:37:36 +0100 (MET)
Subject: [Rd] Linux shared library problem (PR#838)
Message-ID: <200102042137.WAA28592@pubhealth.ku.dk>

Full_Name: Daniel Egloff
Version: 1.2.1
OS: Linux Redhat 7.0
Submission from: (NULL) (212.35.34.200)


Externals in the shared library libc.so.6 not found. See the 
following R session, with the abort message at the end.

> demo(graphics)
 
 
        demo(graphics)
        ---- ~~~~~~~~
 
Type  <Return>   to start :
 
> opar <- par(ask = interactive() && (.Device %in% c("X11",
    "GTK", "windows", "Macintosh")))
 
> x <- rnorm(50)
 
> opar <- c(opar, par(bg = "white"))
 
> plot(x, ann = FALSE, type = "n")
Hit <Return> to see next plot:
 
> abline(h = 0, col = gray(0.9))
 
> lines(x, col = "green4", lty = "dotted")
 
> points(x, bg = "limegreen", pch = 21)
 
> title(main = "Simple Use of Color In a Plot", xlab = "Just a Whisper of a
Label",
    col.main = "blue", col.lab = gray(0.8), cex.main = 1.2, cex.lab = 1,
    font.main = 4, font.lab = 3)
 
> par(bg = "gray")
 
> piechart(rep(1, 24), col = rainbow(24), radius = 0.9)
Hit <Return> to see next plot:
 
> title(main = "A Sample Color Wheel", cex.main = 1.4,
    font.main = 3)
 
> title(xlab = "(Use this as a test of monitor linearity)",
    cex.lab = 0.8, font.lab = 3)
 
> pie.sales <- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
 
> names(pie.sales) <- c("Blueberry", "Cherry", "Apple",
    "Boston Cream", "Other", "Vanilla Cream")
 
> piechart(pie.sales, col = c("purple", "violetred1",
    "green3", "cornsilk", "cyan", "white"))
Hit <Return> to see next plot:
/usr/lib/R/bin/R.bin: error while loading shared libraries:
/usr/lib/R/bin/R.bin: symbol __sysconf, version GLIBC_2.2 not defined in file
libc.so.6 with link time reference
[dani@PLUTO amopt_sim]$             

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb  4 22:32:41 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 Feb 2001 23:32:41 +0100
Subject: [Rd] Linux shared library problem (PR#838)
In-Reply-To: daniel.egloff@dplanet.ch's message of "Sun, 4 Feb 2001 22:37:36 +0100 (MET)"
References: <200102042137.WAA28592@pubhealth.ku.dk>
Message-ID: <x2d7cyf59y.fsf@blueberry.kubism.ku.dk>

daniel.egloff@dplanet.ch writes:

> Full_Name: Daniel Egloff
> Version: 1.2.1
> OS: Linux Redhat 7.0
> Submission from: (NULL) (212.35.34.200)
> 
> 
> Externals in the shared library libc.so.6 not found. See the 
> following R session, with the abort message at the end.
> 
....
> > piechart(pie.sales, col = c("purple", "violetred1",
>     "green3", "cornsilk", "cyan", "white"))
> Hit <Return> to see next plot:
> /usr/lib/R/bin/R.bin: error while loading shared libraries:
> /usr/lib/R/bin/R.bin: symbol __sysconf, version GLIBC_2.2 not defined in file
> libc.so.6 with link time reference
> [dani@PLUTO amopt_sim]$             

if (you.compiled.it) {
    have.you(updated.gcc)   # need 2.96-69 or better
    have.you(updated.glibc) # at -12 now. I think the orig caused trouble 
} else {
    have.you(correct.rpm)   # need the one for 7.0
    have.you(updated.glibc) # at -12 now. I think the orig caused trouble 
}
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jason@cs.rochester.edu  Mon Feb  5 01:17:21 2001
From: jason@cs.rochester.edu (jason@cs.rochester.edu)
Date: Mon, 5 Feb 2001 02:17:21 +0100 (MET)
Subject: [Rd] clipped lines have wrong slope in log plot (PR#839)
Message-ID: <200102050117.CAA29241@pubhealth.ku.dk>

Hi,

I'm using R version 1.2.0 (2000-12-15), on RedHat Linux 6.2 (kernel 2.2.14).

The following command ought to plot a straight-line on a log-log
graph but instead plots two line segments, both with the wrong
slope:

  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,20),ylim=c(1,20),log="xy")

Only clipped lines seem to have this problem.  Changing to type "b"
or enlarging the ranges fixes it:

  plot(c(1,10,100),c(100,10,1),type="b",xlim=c(1,20),ylim=c(1,20),log="xy")
  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,100),ylim=c(1,100),log="xy")

abline has the same problem.  Try following the above calls with abline(2,-1).
(This is supposed to plot a straight line in the log-log domain, and
does, but it's the wrong straight line.)

I can also get the problem where only one axis is logarithmic.  
Let's untransform the x-axis from the original command:
 
  plot(log(c(1,10,100)),c(100,10,1),type="l",xlim=log(c(1,20)),ylim=c(1,20),log="y")

Thanks! - Jason Eisner






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Feb  5 10:50:38 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 5 Feb 2001 10:50:38 +0000 (GMT)
Subject: [Rd] Change of licence for header files and import libraries
Message-ID: <200102051050.KAA22990@toucan.stats.ox.ac.uk>

The copyrights on the distributed header files and export files R.exp
have been changed to the more permissive LGPL.

It came to our attention that some projects are interpreting GPL to
mean that compiling against the header files or linking against a
Windows import library brings the compiled code under the scope of
GPL.  This would mean it would be impossible to distribute binary
versions of non-GPL packages with compiled code which called entry
points in the R executable or DLL, of which there are many on CRAN.

We encourage packages to be distributed under Open Source conditions,
but accept that this is not possible for some contributions.  Our
intention is that export files and import libraries be `accessors'
under clause 5 of the LGPL, so that in most cases no (additional)
restrictions are imposed by compiling a package using the LGPL-ed
components of R.

To avoid any anomalies, the versions of the same files in R versions
1.0.0 to 1.2.1 may also be used under LGPL or GPL.

For the R core team,

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paradis@isem.univ-montp2.fr  Mon Feb  5 11:12:29 2001
From: paradis@isem.univ-montp2.fr (Emmanuel Paradis)
Date: Mon, 05 Feb 2001 12:12:29 +0100
Subject: [Rd] clipped lines have wrong slope in log plot (PR#839)
Message-ID: <3.0.32.20010205121229.008ec380@162.38.183.200>

At 02:17 05/02/01 +0100, you wrote:
>Hi,
>
>I'm using R version 1.2.0 (2000-12-15), on RedHat Linux 6.2 (kernel 2.2.14).
>
>The following command ought to plot a straight-line on a log-log
>graph but instead plots two line segments, both with the wrong
>slope:
>
>  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,20),ylim=c(1,20),log="xy")
>
>Only clipped lines seem to have this problem.  Changing to type "b"
>or enlarging the ranges fixes it:
>
>  plot(c(1,10,100),c(100,10,1),type="b",xlim=c(1,20),ylim=c(1,20),log="xy")
>  plot(c(1,10,100),c(100,10,1),type="l",xlim=c(1,100),ylim=c(1,100),log="xy")
>
>abline has the same problem.  Try following the above calls with
abline(2,-1).
>(This is supposed to plot a straight line in the log-log domain, and
>does, but it's the wrong straight line.)
>
>I can also get the problem where only one axis is logarithmic.  
>Let's untransform the x-axis from the original command:
> 
>
plot(log(c(1,10,100)),c(100,10,1),type="l",xlim=log(c(1,20)),ylim=c(1,20),lo
g="y")
>
>Thanks! - Jason Eisner

I had a similar result with R-1.2.1 on WinNT 4.0.

plot(c(1,10,100), c(100,10,1), type="l", log="xy")  ### this looks OK
plot(c(1,10,100), c(100,10,1), type="l", xlim=c(1,20), ylim=c(1,20), log="xy")

I'd expect setting xlim= and ylim= would 'zoom in' on the first plot, but
it doesn't. It seems that, in this second case, that the coordinates of the
points outside the plotting region are not computed on the log-scale but on
the normal arithmetic scale.


Emmanuel Paradis
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 10:25:39 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 11:25:39 +0100
Subject: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <Pine.GSO.4.31.0102051834530.282-100000@auk.stats>
References: <Pine.GSO.4.31.0102051834530.282-100000@auk.stats>
Message-ID: <01020611253900.00712@Centaurea>

Prof. Ripley wrote on r-help:

> Completely distinct row vectors?  Take a look at the code of
> merge.data.frame.  Something like
>
>     bx <- matrix(as.character(a), nrow(a))
>     bx <- drop(apply(bx, 1, function(x) paste(x, collapse = "\r")))
>     length(unique(bx))
>
> This turns each row into a single character string, and counts the unique
> ones.

Hmmm... couldn't one build on this in order to generalize the 
unique() function?

I'm asking because when I once tried to use unique() on a matrix (to collapse 
duplicate rows), I found that it and duplicated() work only on vectors. I 
think a generalization, at least for matrices and simple data.frames, would 
be useful.

I tried my hand at it and came up with this:

----------------------------------------------------

"unique.default" <- get("unique", pos="package:base")    # old version becomes
                                                         # default behaviour
"unique" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(unique.matrix(object, ...))
   else
       UseMethod("unique")      # doesn't seem to work for matrices, hence 
}                               # the condition
                         


"duplicated.default" <- get("duplicated", pos="package:base")	

"duplicated" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(duplicated.matrix(object, ...))
   else
       UseMethod("duplicated")  
}


"duplicated.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
  return(duplicated(strvect))
}


"unique.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  dup <- duplicated(mat, MARGIN)
  return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
}


"duplicated.data.frame" <-
  function(df, MARGIN=1)
{
  strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse 
= "\r")))
  duplicated(strvect)
}


"unique.data.frame" <-
  function(df, MARGIN=1)
{
  dup <- duplicated(df, MARGIN)
  return(if (MARGIN==1) df[!dup,] else df[,!dup])
}

----------------------------------------------------

I couldn't figure out how to generalize to more than two dimensions (more 
accurately, how to subset in the dimension given by the variable MARGIN). 

Does anybody else consider this useful?


Cheers

Kaspar Pflugshaupt
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 12:34:01 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 13:34:01 +0100
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <01C09039.6E17C100.jens.oehlschlaegel@bbdo-interone.de>
References: <01C09039.6E17C100.jens.oehlschlaegel@bbdo-interone.de>
Message-ID: <01020613340100.00877@Aconitum>

On Tuesday 06 February 2001 12:36, Dr. Jens Oehlschlägel wrote:
> I like the idea. Why don't you call duplicated.matrix() directly in
> unique.matrix() and duplicated.data.frame() in unique.data.frame() ?
>
> Jens Oehlschlägel

Good point. I guess I got carried away with using methods (having just gotten 
the hang of the concept). :-)

Anyway, here's a corrected version:

----------------------------------------------------

"unique.default" <- get("unique", pos="package:base")    # old version becomes
                                                         # default behaviour
"unique" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(unique.matrix(object, ...))
   else
       UseMethod("unique")      # doesn't seem to work for matrices, hence 
}                               # the condition
                         


"duplicated.default" <- get("duplicated", pos="package:base")    

"duplicated" <- function(object, ...)
{
   if (data.class(object)=="matrix")
       return(duplicated.matrix(object, ...))
   else
       UseMethod("duplicated")  
}


"duplicated.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
  return(duplicated(strvect))
}


"unique.matrix" <-
  function(mat, MARGIN=1)    # defaulting to work on rows
{
  dup <- duplicated.matrix(mat, MARGIN)
  return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
}


"duplicated.data.frame" <-
  function(df, MARGIN=1)
{
  strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse 
= "\r")))
  duplicated(strvect)
}


"unique.data.frame" <-
  function(df, MARGIN=1)
{
  dup <- duplicated.data.frame(df, MARGIN)
  return(if (MARGIN==1) df[!dup,] else df[,!dup])
}

----------------------------------------------------

Cheers

Kaspar Pflugshaupt
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb  6 12:49:28 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Feb 2001 12:49:28 +0000 (GMT)
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <01020613340100.00877@Aconitum>
Message-ID: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>

Method dispatch is far from free (it is quite slow). Do we want to
encumber unique() (a fast internal function) in this way?

There are better ways to do this if one is going to use C code:
converting to character and comparing long strings are both expensive,


On Tue, 6 Feb 2001, Kaspar Pflugshaupt wrote:

> On Tuesday 06 February 2001 12:36, Dr. Jens Oehlschlägel wrote:
> > I like the idea. Why don't you call duplicated.matrix() directly in
> > unique.matrix() and duplicated.data.frame() in unique.data.frame() ?
> >
> > Jens Oehlschlägel
>
> Good point. I guess I got carried away with using methods (having just gotten
> the hang of the concept). :-)
>
> Anyway, here's a corrected version:
>
> ----------------------------------------------------
>
> "unique.default" <- get("unique", pos="package:base")    # old version becomes
>                                                          # default behaviour
> "unique" <- function(object, ...)
> {
>    if (data.class(object)=="matrix")
>        return(unique.matrix(object, ...))
>    else
>        UseMethod("unique")      # doesn't seem to work for matrices, hence
> }                               # the condition
>                          
>
>
> "duplicated.default" <- get("duplicated", pos="package:base")   
>
> "duplicated" <- function(object, ...)
> {
>    if (data.class(object)=="matrix")
>        return(duplicated.matrix(object, ...))
>    else
>        UseMethod("duplicated")  
> }
>
>
> "duplicated.matrix" <-
>   function(mat, MARGIN=1)    # defaulting to work on rows
> {
>   strvect <- drop(apply(mat, MARGIN, function(x) paste(x, collapse = "\r")))
>   return(duplicated(strvect))
> }
>
>
> "unique.matrix" <-
>   function(mat, MARGIN=1)    # defaulting to work on rows
> {
>   dup <- duplicated.matrix(mat, MARGIN)
>   return(if (MARGIN==1) mat[!dup,] else mat[,!dup])
> }
>
>
> "duplicated.data.frame" <-
>   function(df, MARGIN=1)
> {
>   strvect <- drop(apply(as.matrix(df), MARGIN, function(x) paste(x, collapse
> = "\r")))
>   duplicated(strvect)
> }
>
>
> "unique.data.frame" <-
>   function(df, MARGIN=1)
> {
>   dup <- duplicated.data.frame(df, MARGIN)
>   return(if (MARGIN==1) df[!dup,] else df[,!dup])
> }
>
> ----------------------------------------------------
>
> Cheers
>
> Kaspar Pflugshaupt
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Tue Feb  6 14:50:42 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Tue, 6 Feb 2001 15:50:42 +0100 (MET)
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
Message-ID: <200102061450.PAA22765@pubhealth.ku.dk>


Hi.  This is cosmetic in nature, yet annoying as the warning points
to the wrong source:  On a screen running on an X server with 100 DPI,
I always got warnings about X11 using the wrong font size:

> x11()
Warning message: 
X11 used font size 17 when 12 was requested 

Then I looked at the code and X11 is _not_ to be blamed for this:
R resets the requested font size for 100 DPI screens!  There should be
no warning.  (At least not a warning that makes people wonder whether
they misconfigured the font server again.)

The patch below moves Peter's scaling equation up, before the font
cache check and directly writes to size.  Thus it's true that:
  variable size == (IS_100DPI ? scaled requested size : requested size)
  variable pixelsize == (font available ? size (same as above)
						: size of allocated font)

Regards,
  -tom



*** ../src/unix/X11/devX11.c	Tue Feb  6 09:27:48 2001
--- ../src/unix/X11/devX11.c~	Fri Feb  2 08:20:37 2001
***************
*** 834,855 ****
      if (size < SMALLEST) size = SMALLEST;
      face--;
  
-     /* Here's a 1st class fudge: make sure that the Adobe design sizes
-        8, 10, 11, 12, 14, 17, 18, 20, 24, 25, 34 can be obtained via
-        an integer "size" at 100 dpi, namely 6, 7, 8, 9, 10, 12, 13,
-        14, 17, 18, 24 points. It's almost y = x * 100/72, but not
-        quite. The constants were found using lm(). --pd */
-     if (IS_100DPI) size = R_rint(size * 1.43 - 0.4);
- 
      /* search fontcache */
      for ( i = nfonts ; i-- ; ) {
  	f = &fontcache[i];
  	if ( f->face == face && f->size == size ) return f->font;
      }
  
!     /* 'size' is the requested size, 'pixelsize'  the size of the
!        actually allocated font*/
!     pixelsize = size;
  
      if (face == 4)
  	sprintf(buf, symbolname,  pixelsize);
--- 834,854 ----
      if (size < SMALLEST) size = SMALLEST;
      face--;
  
      /* search fontcache */
      for ( i = nfonts ; i-- ; ) {
  	f = &fontcache[i];
  	if ( f->face == face && f->size == size ) return f->font;
      }
  
! 
! 
!     /* Here's a 1st class fudge: make sure that the Adobe design sizes
!        8, 10, 11, 12, 14, 17, 18, 20, 24, 25, 34 can be obtained via
!        an integer "size" at 100 dpi, namely 6, 7, 8, 9, 10, 12, 13,
!        14, 17, 18, 24 points. It's almost y = x * 100/72, but not
!        quite. The constants were found using lm(). --pd */
! 
!     pixelsize = IS_100DPI ? R_rint(size * 1.43 - 0.4) : size;
  
      if (face == 4)
  	sprintf(buf, symbolname,  pixelsize);


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 02
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  6 15:33:19 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Feb 2001 16:33:19 +0100
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 6 Feb 2001 15:50:42 +0100 (MET)"
References: <200102061450.PAA22765@pubhealth.ku.dk>
Message-ID: <x2zofzvnb4.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:

> Hi.  This is cosmetic in nature, yet annoying as the warning points
> to the wrong source:  On a screen running on an X server with 100 DPI,
> I always got warnings about X11 using the wrong font size:
> 
> > x11()
> Warning message: 
> X11 used font size 17 when 12 was requested 
> 
> Then I looked at the code and X11 is _not_ to be blamed for this:
> R resets the requested font size for 100 DPI screens!  There should be
> no warning.  (At least not a warning that makes people wonder whether
> they misconfigured the font server again.)
                                     ===== :-)

Thanks. (Funny... I could have sworn I zapped that 100DPI
special-casing a while back. Maybe I forgot to commit?)

> 
> The patch below moves Peter's scaling equation up, before the font
> cache check and directly writes to size.  Thus it's true that:
>   variable size == (IS_100DPI ? scaled requested size : requested size)
>   variable pixelsize == (font available ? size (same as above)
> 						: size of allocated font)
> 
> Regards,
>   -tom

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pflugshaupt@geobot.umnw.ethz.ch  Tue Feb  6 15:51:34 2001
From: pflugshaupt@geobot.umnw.ethz.ch (Kaspar Pflugshaupt)
Date: Tue, 6 Feb 2001 16:51:34 +0100
Subject: AW: [Rd] Proposal: Generalizing unique() and duplicated()
In-Reply-To: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>
References: <Pine.GSO.4.31.0102061244320.453-100000@toucan.stats>
Message-ID: <01020616503101.00877@Aconitum>

On Tuesday 06 February 2001 13:49, Prof Brian Ripley wrote:

> Method dispatch is far from free (it is quite slow). Do we want to
> encumber unique() (a fast internal function) in this way?

That's a good argument. I did not know dispatch was such a problem in terms 
of speed. J. Oelschlägel suggested eliminating two dispatches by calling 

  return(duplicated.default(strvect)) 

instead of

  return(duplicated(strvect))

in both duplicated.matrix() and duplicated.data.frame().
But the speed gain, following your second argument, would probably be 
marginal. And the default methods would still get dispatched.

>
> There are better ways to do this if one is going to use C code:
> converting to character and comparing long strings are both expensive,

Since I cannot write C, this is not an option for me. I guess I'll take back 
my proposal and use the functions privately. I might publish them on r-help 
(in a non-dispatched form, not overloading the original functions), so others 
can use them as well.


Thanks for the feedback (I learned a lot)

Kaspar Pflugshaupt

----

Kaspar Pflugshaupt
Geobotanical Institute
ETH Zurich, Switzerland

http://www.geobot.umnw.ethz.ch
mailto:pflugshaupt@geobot.umnw.ethz.ch

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  6 16:32:39 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Feb 2001 17:32:39 +0100
Subject: [Rd] X11 warnings about "wrong" font sizes (PR#840)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 6 Feb 2001 15:50:42 +0100 (MET)"
References: <200102061450.PAA22765@pubhealth.ku.dk>
Message-ID: <x2d7cvvkk8.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:

> The patch below moves Peter's scaling equation up, before the font
> cache check and directly writes to size.  Thus it's true that:
>   variable size == (IS_100DPI ? scaled requested size : requested size)
>   variable pixelsize == (font available ? size (same as above)
> 						: size of allocated font)

Patch installed and committed to the release branch (1.2.2pre).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Wed Feb  7 06:15:04 2001
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed, 7 Feb 2001 07:15:04 +0100
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200102070615.HAA03109@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.r-project.org or via email to
r-bugs@r-project.org. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 751 *
Subject: BUG: polyroot()
From: "Li Dongfeng" <mavip1@inet.polyu.edu.hk>
Date: Tue, 28 Nov 2000 13:24:33 +0800
--Numerical instability. We may want a better algorithm!

Directory:  Add-ons

* PR# 824 *
Subject: trouble with netCDF 
From: jasont@indigoindustrial.co.nz
Date: Thu, 25 Jan 2001 12:00:39 +1300
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 812 *
Subject: segmentation fault in integrate
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Thu, 11 Jan 2001 22:49:59 +0100
* PR# 781 *
Subject: syskern fails Rcmd check on Windows, gives incorrect information
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 20 Dec 2000 11:12:47 +0000 (GMT)
--Partially fixed by dse_2000.12, but still uses "ls" and gives
--incorrect information

Directory:  Analyses

* PR# 653 *
Subject: bug in spline()?
From: Ian White <imsw@holyrood.ed.ac.uk>
Date: Mon, 4 Sep 2000 12:29:26 +0100 (BST)
--bug in spline: replace by interSpline in package spline?
--address problems are fixed

Directory:  Documentation

none

Directory:  Graphics

* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
* PR# 726 *
Subject: par(las=.)  gives wrong "adj" for mtext()
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 7 Nov 2000 13:03:58 +0100
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
* PR# 750 *
Subject: abline() does not obey "xpd" (clipping rules)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 27 Nov 2000 18:27:11 +0100
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix will work (and spaces for labels will be fine), but there is a
--deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--I think the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above may
--have side-effects in many other pieces of interpreted code (ii) do_mtext ignores
--
--dd->gp.cexbase unlike, for example, do_plot_xy and anything to do with cexbase
--needs extreme care.
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
* PR# 823 *
Subject: adjustment of expressions with mtext(..., las=2)
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Wed, 24 Jan 2001 20:12:43 +0100
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100

Directory:  In-Out

* PR# 814 *
Subject: Memory problem ?
From: Zoltan Barta <Z.Barta@bristol.ac.uk>
Date: Mon, 15 Jan 2001 09:54:16 +0000 (GMT Standard Time)
--scan crashes R on Linux: a memory allocation problem, probably
--Uses n= or nlines= in scan will use less memory, and read.table does.

Directory:  Installation

* PR# 806 *
Subject: configure error on alpha
From: Richard Beare <Richard.Beare@cmis.CSIRO.AU>
Date: Wed, 10 Jan 2001 16:52:58 +1100

Directory:  Language

* PR# 813 *
Subject: match.call problem
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jan 2001 17:46:15 +0100
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 822 *
Subject: Re: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:56:32 +0100 (CET)
--part of 821
* PR# 821 *
Subject: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:44:28 +0100 (CET)
--See also 822, which shows the segfault is in strftime.c.
--From other correspondence, this is on RH5.0: we can't
--reproduce it on RH6.2 or anywhere else.
* PR# 808 *
Subject: Time zone
From: Herve Morin <morin@mat.ulaval.ca>
Date: Wed, 10 Jan 2001 07:24:07 -0500
--This appears to be a complaint about a warning on a beta Mac version
--(but Macs are never mentioned!).  That version is incomplete.

Directory:  TooMuchAtOnce

* PR# 811 *
Subject: problem with strptime example (and mention of bug.report)
From: Stephen Eglen <stephen@anc.ed.ac.uk>
Date: Thu, 11 Jan 2001 19:18:39 GMT
--1) On OSF4, strptime is deficient. Nothing we can do.
--
--2) On Windows NT, the strptime problems are (i) German locale, English dates,
--(ii) Windows system errors with unknown DST (it move times to DST).
--(i) now has another warning in the help file (there already was one).
--(ii) was already worked around for 1.2.1.
--
--3) bug.report() uses a mailer option that does not exist on OSF4.

Directory:  Windows

none

Directory:  incoming

* PR# 840 *
Subject: X11 warnings about "wrong" font sizes
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 06 Feb 2001 09:50:44 -0500
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500
* PR# 830 *
Subject: Disappearing x axis in plot.factor
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:27:13 -0500
* PR# 829 *
Subject: variables in nls
From: baron@cattell.psych.upenn.edu
Date: Sun, 28 Jan 2001 15:07:27 +0100 (MET)
* PR# 835 *
Subject: factors in data.frames
From: Jim Lindsey <james.lindsey@luc.ac.be>
Date: Thu, 1 Feb 2001 10:55:59 +0100 (MET)
* PR# 834 *
Subject:  inconsistent behaviour between class() and inherits() 
From: adrian@olsen.ch
Date: Thu, 01 Feb 2001 10:07:13 +0100
* PR# 832 *
Subject: Rconsole documentation
From: david.firth@nuffield.oxford.ac.uk
Date: Tue, 30 Jan 2001 15:52:49 +0100 (MET)
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
* PR# 836 *
Subject: configure bug in R-1.2.1 and earlier
From: Lars Hecking <lhecking@nmrc.ie>
Date: Thu, 1 Feb 2001 18:41:09 +0000
* PR# 839 *
Subject: clipped lines have wrong slope in log plot
From: Jason Eisner <jason@cs.rochester.edu>
Date: Sun, 4 Feb 2001 20:17:31 -0500 (EST)
* PR# 838 *
Subject: Linux shared library problem
From: daniel.egloff@dplanet.ch
Date: Sun, 4 Feb 2001 22:37:31 +0100 (MET)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 15:45:58 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 16:45:58 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
References: <200102071105.LAA08910@achill.nmrc.ucc.ie>
 <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
Message-ID: <14977.28086.8858.910911@mithrandir.hornik.net>

>>>>> Yves Gauvreau writes:

> Try this
> sampled <- data.frame(sample(rnorm(100),2))
> colnames(sampled) <- " " # Or preferably something meaningful
> sampled

> 1 1.777068
> 2 0.937161

Ouch!

This *surely* is a bug.  How can it be possible to remove the variable
names in a data frame?

It may be time to reconsider what
	rownames
	colnames
	case.names
	variable.names
do for data frames.

But in fact, both

	names(sampled) <- " "
and
	dimnames(sampled)[[2]] <- " "

happily introduce non-unique variable names in the data frame.

Is the rule that row.names and names must be unique still on?

Argh ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley" <ripley@stats.ox.ac.uk  Mon Feb  5 10:50:38 2001
From: Prof Brian Ripley" <ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 05 Feb 2001 10:50:38 +0000 (GMT)
Subject: [Rd] Change of licence for header files and import libraries
Message-ID: <200102051050.KAA22990@toucan.stats.ox.ac.uk>

The copyrights on the distributed header files and export files R.exp
have been changed to the more permissive LGPL.

It came to our attention that some projects are interpreting GPL to
mean that compiling against the header files or linking against a
Windows import library brings the compiled code under the scope of
GPL.  This would mean it would be impossible to distribute binary
versions of non-GPL packages with compiled code which called entry
points in the R executable or DLL, of which there are many on CRAN.

We encourage packages to be distributed under Open Source conditions,
but accept that this is not possible for some contributions.  Our
intention is that export files and import libraries be `accessors'
under clause 5 of the LGPL, so that in most cases no (additional)
restrictions are imposed by compiling a package using the LGPL-ed
components of R.

To avoid any anomalies, the versions of the same files in R versions
1.0.0 to 1.2.1 may also be used under LGPL or GPL.

For the R core team,

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 15:54:16 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 07:54:16 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.28086.8858.910911@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Yves Gauvreau writes:
> 
> > Try this
> > sampled <- data.frame(sample(rnorm(100),2))
> > colnames(sampled) <- " " # Or preferably something meaningful
> > sampled
> 
> > 1 1.777068
> > 2 0.937161
> 
> Ouch!
> 
> This *surely* is a bug.  How can it be possible to remove the variable
> names in a data frame?

He hasn't removed them, just set them to " ". We allow variable names that
are not valid R names (in fact, we rely on them in model.frame).

	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 15:57:27 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 16:57:27 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>
References: <14977.28086.8858.910911@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070752550.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.28775.611743.933442@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Yves Gauvreau writes:
>> 
>> > Try this
>> > sampled <- data.frame(sample(rnorm(100),2))
>> > colnames(sampled) <- " " # Or preferably something meaningful
>> > sampled
>> 
>> > 1 1.777068
>> > 2 0.937161
>> 
>> Ouch!
>> 
>> This *surely* is a bug.  How can it be possible to remove the variable
>> names in a data frame?

> He hasn't removed them, just set them to " ". We allow variable names
> that are not valid R names (in fact, we rely on them in model.frame).

Correct.  Let me rephrase the question: how can it be possible to set
the (variable) names in a data frame to something non-unique?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb  7 16:06:03 2001
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Feb 2001 17:06:03 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: Kurt Hornik's message of "Wed, 7 Feb 2001 16:45:58 +0100"
References: <200102071105.LAA08910@achill.nmrc.ucc.ie> <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca> <14977.28086.8858.910911@mithrandir.hornik.net>
Message-ID: <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 	names(sampled) <- " "
> and
> 	dimnames(sampled)[[2]] <- " "
> 
> happily introduce non-unique variable names in the data frame.
> 
> Is the rule that row.names and names must be unique still on?
> 
> Argh ...

Splus 3.4 dispatches on dimnames<-, but not on names<- with the
following curious result:

> d <- data.frame(a=1:3,b=4:6)
> names(d)<-c(" "," ")
> d
      
1 1 4
2 2 5
3 3 6
> dimnames(d)[[1]] <- rep(" ",3)  
Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
Dumped

R dispatches similarly, but doesn't check the dimnames in
dimnames<-.data.frame. It could do so quite easily. Just add 

|| any(duplicated(d[[1]])) || any(duplicated(d[[2]]))

at the appropriate spot. 
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 16:13:29 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 17:13:29 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>
References: <200102071105.LAA08910@achill.nmrc.ucc.ie>
 <NEBBJKDJHEFCOOLFFAKKIEMFCAAA.cyg@sympatico.ca>
 <14977.28086.8858.910911@mithrandir.hornik.net>
 <x2g0hqbhqs.fsf@blueberry.kubism.ku.dk>
Message-ID: <14977.29737.623121.566627@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> names(sampled) <- " "
>> and
>> dimnames(sampled)[[2]] <- " "
>> 
>> happily introduce non-unique variable names in the data frame.
>> 
>> Is the rule that row.names and names must be unique still on?
>> 
>> Argh ...

> Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> following curious result:

>> d <- data.frame(a=1:3,b=4:6)
>> names(d)<-c(" "," ")
>> d
      
> 1 1 4
> 2 2 5
> 3 3 6
>> dimnames(d)[[1]] <- rep(" ",3)  
> Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> Dumped

> R dispatches similarly, but doesn't check the dimnames in
> dimnames<-.data.frame. It could do so quite easily. Just add 

> || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))

> at the appropriate spot.

Thomas' view about what should be permitted seems to be different.

Also note that the convenience functions for name manipulation such as
variable.names typically do their own little thing and do not go via
dimnames.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 16:00:46 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 08:00:46 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.28775.611743.933442@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> Correct.  Let me rephrase the question: how can it be possible to set
> the (variable) names in a data frame to something non-unique?

1) he didn't: there was only one column
2) we allow duplicated column names
 For example
  a<-data.frame(rnorm(10),rnorm(10)) 
 gives a data frame with two columns having the same name. What do you
think they should be called?  
We discussed this some time ago in the context of offsets in glm(), and
model.offset contains code to handle multiple "(offset)" columns.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 16:23:06 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 08:23:06 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.29737.623121.566627@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Peter Dalgaard BSA writes:
> 
> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> names(sampled) <- " "
> >> and
> >> dimnames(sampled)[[2]] <- " "
> >> 
> >> happily introduce non-unique variable names in the data frame.
> >> 
> >> Is the rule that row.names and names must be unique still on?
> >> 
> >> Argh ...
> 
> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> > following curious result:
> 
> >> d <- data.frame(a=1:3,b=4:6)
> >> names(d)<-c(" "," ")
> >> d
>       
> > 1 1 4
> > 2 2 5
> > 3 3 6
> >> dimnames(d)[[1]] <- rep(" ",3)  
> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> > Dumped
> 
> > R dispatches similarly, but doesn't check the dimnames in
> > dimnames<-.data.frame. It could do so quite easily. Just add 
> 
> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> 
> > at the appropriate spot.
> 
> Thomas' view about what should be permitted seems to be different.

I wouldn't object to making it hard to create duplicated names(), but I
think it would be a bad idea to have data.frame() make up unique names if
it's given non-unique ones.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:20:29 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:20:29 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>
References: <14977.28775.611743.933442@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070757370.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.33757.452637.165825@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> Correct.  Let me rephrase the question: how can it be possible to set
>> the (variable) names in a data frame to something non-unique?

> 1) he didn't: there was only one column

Maybe I should be more careful when composing my emails :-)

I think I am also concerned about data frames with variable names which
are not syntactically valid, but one can also get that by creating the
data frame with `check.names = FALSE'.

> 2) we allow duplicated column names
>  For example
>   a<-data.frame(rnorm(10),rnorm(10)) 
>  gives a data frame with two columns having the same name. What do you
> think they should be called?  
> We discussed this some time ago in the context of offsets in glm(), and
> model.offset contains code to handle multiple "(offset)" columns.

Hmm, I must have missed that.

My understanding thus far was that I can always rely on unique case and
variable names in a data frame.  I see the potential usefulness in
allowing multiple "(offset)" columns in a model frame ... but wouldn't
that (at least in theory) call for using a different class?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:23:12 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:23:12 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>
References: <14977.29737.623121.566627@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070820570.112748-100000@homer40.u.washington.edu>
Message-ID: <14977.33920.590610.689408@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Peter Dalgaard BSA writes:
>> 
>> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> names(sampled) <- " "
>> >> and
>> >> dimnames(sampled)[[2]] <- " "
>> >> 
>> >> happily introduce non-unique variable names in the data frame.
>> >> 
>> >> Is the rule that row.names and names must be unique still on?
>> >> 
>> >> Argh ...
>> 
>> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> > following curious result:
>> 
>> >> d <- data.frame(a=1:3,b=4:6)
>> >> names(d)<-c(" "," ")
>> >> d
>> 
>> > 1 1 4
>> > 2 2 5
>> > 3 3 6
>> >> dimnames(d)[[1]] <- rep(" ",3)  
>> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> > Dumped
>> 
>> > R dispatches similarly, but doesn't check the dimnames in
>> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> 
>> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> 
>> > at the appropriate spot.
>> 
>> Thomas' view about what should be permitted seems to be different.

> I wouldn't object to making it hard to create duplicated names(), but
> I think it would be a bad idea to have data.frame() make up unique
> names if it's given non-unique ones.

Maybe `check.names' could also be used for uniqueness testing?

In any case, I think we should specify what *exactly* a data frame is.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Wed Feb  7 17:33:12 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <14977.33920.590610.689408@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>

On Wed, 7 Feb 2001, Kurt Hornik wrote:

> >>>>> Thomas Lumley writes:
> 
> > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> >>>>> Peter Dalgaard BSA writes:
> >> 
> >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> >> names(sampled) <- " "
> >> >> and
> >> >> dimnames(sampled)[[2]] <- " "
> >> >> 
> >> >> happily introduce non-unique variable names in the data frame.
> >> >> 
> >> >> Is the rule that row.names and names must be unique still on?
> >> >> 
> >> >> Argh ...
> >> 
> >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> >> > following curious result:
> >> 
> >> >> d <- data.frame(a=1:3,b=4:6)
> >> >> names(d)<-c(" "," ")
> >> >> d
> >> 
> >> > 1 1 4
> >> > 2 2 5
> >> > 3 3 6
> >> >> dimnames(d)[[1]] <- rep(" ",3)  
> >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> >> > Dumped
> >> 
> >> > R dispatches similarly, but doesn't check the dimnames in
> >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> >> 
> >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> >> 
> >> > at the appropriate spot.
> >> 
> >> Thomas' view about what should be permitted seems to be different.
> 
> > I wouldn't object to making it hard to create duplicated names(), but
> > I think it would be a bad idea to have data.frame() make up unique
> > names if it's given non-unique ones.
> 
> Maybe `check.names' could also be used for uniqueness testing?
> 
> In any case, I think we should specify what *exactly* a data frame is.
>

I think we should specify, and check.names is a logical way to
allow/forbid non-unique columns.  

Having a new class would be messy: logically it shouldn't inherit from
data.frame, data.frame should inherit from it, but that would be a real
pain to set up.

	-thomas


	

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb  7 17:36:55 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Feb 2001 18:36:55 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>
References: <14977.33920.590610.689408@mithrandir.hornik.net>
 <Pine.A41.4.21.0102070930090.181294-100000@homer37.u.washington.edu>
Message-ID: <14977.34743.548005.545365@mithrandir.hornik.net>

>>>>> Thomas Lumley writes:

> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >>>>> Thomas Lumley writes:
>> 
>> > On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> >> >>>>> Peter Dalgaard BSA writes:
>> >> 
>> >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> >> names(sampled) <- " "
>> >> >> and
>> >> >> dimnames(sampled)[[2]] <- " "
>> >> >> 
>> >> >> happily introduce non-unique variable names in the data frame.
>> >> >> 
>> >> >> Is the rule that row.names and names must be unique still on?
>> >> >> 
>> >> >> Argh ...
>> >> 
>> >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> >> > following curious result:
>> >> 
>> >> >> d <- data.frame(a=1:3,b=4:6)
>> >> >> names(d)<-c(" "," ")
>> >> >> d
>> >> 
>> >> > 1 1 4
>> >> > 2 2 5
>> >> > 3 3 6
>> >> >> dimnames(d)[[1]] <- rep(" ",3)  
>> >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> >> > Dumped
>> >> 
>> >> > R dispatches similarly, but doesn't check the dimnames in
>> >> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> >> 
>> >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> >> 
>> >> > at the appropriate spot.
>> >> 
>> >> Thomas' view about what should be permitted seems to be different.
>> 
>> > I wouldn't object to making it hard to create duplicated names(), but
>> > I think it would be a bad idea to have data.frame() make up unique
>> > names if it's given non-unique ones.
>> 
>> Maybe `check.names' could also be used for uniqueness testing?
>> 
>> In any case, I think we should specify what *exactly* a data frame is.
>> 

> I think we should specify, and check.names is a logical way to
> allow/forbid non-unique columns.

O.k.  Would the assignment versions of rownames/colnames etc also have
the `check.names' argument for their data frame methods?  Personally I
have no preferences for row/colnames which are, by their naming, more
matrix style.  But I think the ``high-level'' case.names and
variable.names perhaps should ...

> Having a new class would be messy: logically it shouldn't inherit from
> data.frame, data.frame should inherit from it, but that would be a real
> pain to set up.

[Yes, unfortunately.]

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From murdoch@stats.uwo.ca  Wed Feb  7 17:51:12 2001
From: murdoch@stats.uwo.ca (Duncan Murdoch)
Date: Wed, 07 Feb 2001 12:51:12 -0500
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from contour)
Message-ID: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>

I submitted a message to r-help this morning that really belongs in
r-devel; here's its URL in the archive:
<http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.

In summary, I suggest that R graphics objects should be accessible and
modifiable, but it raises some problems if you want to do it without
pointers.

Duncan Murdoch
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Feb  7 18:45:02 2001
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 7 Feb 2001 18:45:02 +0000 (GMT)
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from
 contour)
In-Reply-To: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>
Message-ID: <Pine.GSO.4.31.0102071828220.14134-100000@auk.stats>

On Wed, 7 Feb 2001, Duncan Murdoch wrote:

> I submitted a message to r-help this morning that really belongs in
> r-devel; here's its URL in the archive:
> <http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.
>
> In summary, I suggest that R graphics objects should be accessible and
> modifiable, but it raises some problems if you want to do it without
> pointers.

Duncan,

I saw your post, and Ross's.   As I understand it, in R there is a
separation between computing and drawing, but it is at a higher level than
the original question wanted.  That's not to say I am very sure of this!

Normally, R maintains a display list, that is a list of high-level
description of graphics calls.  The idea is that list can be replayed
to refresh the display as needed (especially if it is resized), but the
idea has been taken further, for example to copy plots by replaying
on another device.  Further, individual plots can be saved and replayed,
first by menus on Guido's Windows display driver, and later from R
functions.

Now, I don't understand the display list in detail, but I know we have had
problems with statefulness.  There is also a lower-level separation, the
set of calls made to the graphics driver, more akin to Windows GDI calls.
One of my motivations for writing a PDF driver (there is one in R-devel
now) was to allow editing of graphical output at object level.
Unfortunately, this is not to be as the graphics driver interface is too
low-level, for plotmath at the level of a single character, for example.

I suspect that the ideal is somewhere in between the display list and the
graphics driver level, and that probably PDF is about right.  Someone in
Apple clearly thinks so given the fuss being made about MacOSX graphics.

I am not sure this helps you much.  It is one example of an issue that is
beginning to come up in several places:  is it better to re-design and
re-implement, or to try to maintain what we have?

On the actual issue of extracting contours, then I think if you
turn labelling off and use a device like XFig, it is quite easy to pull out
the contours as vectors.

Some background thoughts, I hope of some use.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From David James <dj@research.bell-labs.com>  Wed Feb  7 18:50:26 2001
From: David James <dj@research.bell-labs.com> (David James)
Date: Wed, 7 Feb 2001 13:50:26 -0500 (EST)
Subject: [Rd] RE: [R] Removing "row.names"
Message-ID: <200102071850.NAA22791@jessie.research.bell-labs.com>


> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
> From: Thomas Lumley <tlumley@u.washington.edu>
> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
> Subject: Re: [Rd] RE: [R] Removing "row.names"
> MIME-Version: 1.0
> 
> On Wed, 7 Feb 2001, Kurt Hornik wrote:
> 
> > >>>>> Thomas Lumley writes:
> > 
> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> > >> >>>>> Peter Dalgaard BSA writes:
> > >> 
> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> > >> >> names(sampled) <- " "
> > >> >> and
> > >> >> dimnames(sampled)[[2]] <- " "
> > >> >> 
> > >> >> happily introduce non-unique variable names in the data frame.
> > >> >> 
> > >> >> Is the rule that row.names and names must be unique still on?
> > >> >> 
> > >> >> Argh ...
> > >> 
> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> > >> > following curious result:
> > >> 
> > >> >> d <- data.frame(a=1:3,b=4:6)
> > >> >> names(d)<-c(" "," ")
> > >> >> d
> > >> 
> > >> > 1 1 4
> > >> > 2 2 5
> > >> > 3 3 6
> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
> > >> > Dumped
> > >> 
> > >> > R dispatches similarly, but doesn't check the dimnames in
> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> > >> 
> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> > >> 
> > >> > at the appropriate spot.
> > >> 
> > >> Thomas' view about what should be permitted seems to be different.
> > 
> > > I wouldn't object to making it hard to create duplicated names(), but
> > > I think it would be a bad idea to have data.frame() make up unique
> > > names if it's given non-unique ones.
> > 
> > Maybe `check.names' could also be used for uniqueness testing?
> > 
> > In any case, I think we should specify what *exactly* a data frame is.
> >
> 
> I think we should specify, and check.names is a logical way to
> allow/forbid non-unique columns.  
> 
> Having a new class would be messy: logically it shouldn't inherit from
> data.frame, data.frame should inherit from it, but that would be a real
> pain to set up.
> 

Data frames were originally meant to be used in modeling functions.
The opening paragraph in Chapter 3 (Data for Models) in the White Book
says:
 
  "This chapter describes the general structure for data that
  will be used throughout the book.  In particular, it introduces the
  data frame, a class of objects to represent the data typically encounterd  
  in fitting models."

However, data.frames may not be quite appropriate for representing
other types of tabular data (certainly a data.frame does not capture
the essence of, say, a "relational" table in the SQL sense, which doesn't
have the concept of row names).  Several manifestations of this problem are 
coercing character data to factors "at the drop of a hat" (as someone wrote 
here or in s-news), the row.names issue now being discussed,  problems 
including general objets in the "cells" of the data.frame, etc.  

I think that the concept of a data.frame to represent data for fitting
models is fine, but we may (certainly I) have abused this concept.  We need 
other classes of tabular data objects in addition (not as a replacement) to 
data.frames, together with coercion methods and perhaps other utilities.


David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Wed Feb  7 20:28:57 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Thu, 8 Feb 2001 09:28:57 +1300
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from contour)
References: <qf238t4ps6bht9tvkblvfnof8a7oe106o0@4ax.com>
Message-ID: <008c01c09144$9b684740$175dd882@stat.auckland.ac.nz>

Hi


----- Original Message -----
From: Duncan Murdoch <murdoch@stats.uwo.ca>
To: <r-devel@stat.math.ethz.ch>
Sent: Thursday, February 08, 2001 6:51 AM
Subject: [Rd] Re: Writing graphics code (was: [R] get vector data from
contour)


> I submitted a message to r-help this morning that really belongs in
> r-devel; here's its URL in the archive:
> <http://www.r-project.org/nocvs/mail/r-help/2001/0693.html>.
>
> In summary, I suggest that R graphics objects should be accessible and
> modifiable, but it raises some problems if you want to do it without
> pointers.


I have been doing some similar stuff to what you describe (primitives and
groups arranged in hierarchies), but for 2D graphics, and I have used Luke
Tierney's "external pointers" to provide access to graphical objects which
represent the graphical output.  See the R developer page
http://developer.r-project.org/ for Luke's stuff, but please note the
disclaimer at the top of that page.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Feb  8 08:09:54 2001
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Thu, 8 Feb 2001 09:09:54 +0100 (MET)
Subject: [Rd] RE: [R] Re: failed rpm installation of R 1.2-1 (fwd) (PR#841)
Message-ID: <200102080809.JAA13815@pubhealth.ku.dk>

I'm forwarding this to R-bugs.

In R 1.2.1 the file $R_HOME/bin/maketitle.awk is installed as an
executable. It should not be since it is just a set of awk commands,
not a script file that can be run from the shell (This is a change from
R 1.2.0 in which the file $R_HOME/bin/maketitle was a shell script).

This confuses an rpm utility called "find-requires" which scans all
executable files in an effort to determine the dependencies of 
the rpm package.
- binaries are scanned for the dynamic libraries they are linked against
- The heads of script files are scanned to see what language they
  are written in. In this case the first line of maketitle.awk is
  the awk command BEGIN, which is misinterpreted as a dependency for R.

Martyn


On 07-Feb-01 Albrecht Gebhardt wrote:
> On Wed, 7 Feb 2001, Faheem Mitha wrote:
> 
>> Dear Albrecht,
>> 
>> Just sent the following message out to r-help. Have you any idea what this
>> problem could be?
>> 
>>                          Sincerely, Faheem Mitha.
>> 
>> ---------- Forwarded message ----------
>> Date: Wed, 7 Feb 2001 00:04:35 -0500 (EST)
>> From: Faheem Mitha <faheem@email.unc.edu>
>> To: r-help@stat.math.ethz.ch
>> Subject: failed rpm installation of R 1.2-1
>> 
>> Dear People,
>> 
>> Just tried to compile an rpm for R 1.2-1 (using Albrecht Gebhardt's spec
>> file). The compile went successfully and produced a binary rpm, but when I
>> tried to install it, I got an error
>> 
>> error: failed dependencies:
>>         BEGIN is needed by R-base-1.2.1-1
>> 
>> I see this was also listed in the Requires list at the end of the rpm
>> compilation: 
>> 
>> Requires: /bin/sh /usr/bin/perl BEGIN ...
>> 
>> Of course I could force installation of the package, but I would like to
>> know what I am doing first. Albrecht does not say anything about BEGIN in
>> his spec file, so this must be somethin internal to R. Does anyone have
>> any idea what? I have no idea.
>>
> 
> I guess, there is some executable file (a snippet of some script with mode
> 755 or similar) which starts with a line "BEGIN". ....
> 
> Well, I just found it, it is an awk script:
> find -type f -exec grep -l BEGIN {} \;
> ...
> ./bin/maketitle.awk
> 
> Clearly it doesn't need the executable bits so simply add
> 
> chmod 644 $RPM_BUILD_ROOT/%{prefix}/R/bin/maketitle.awk
> 
> to the end of the %install section of my spec file.
> 
> 
> Albrecht

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rbeer@uni-goettingen.de  Thu Feb  8 12:29:07 2001
From: rbeer@uni-goettingen.de (Ragnar Beer)
Date: Thu, 8 Feb 2001 13:29:07 +0100
Subject: [Rd] hollow points bug?
Message-ID: <p04330100b6a8406244a7@[134.76.136.114]>

Howdy!

According to help(points) setting the bg parameter should set the 
background fill color for open plot symbols. But when I tried out 
(R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always 
see through the "O". Is this a bug or am getting something wrong?

Ragnar
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb  8 12:44:45 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 8 Feb 2001 12:44:45 +0000 (GMT)
Subject: [Rd] hollow points bug?
In-Reply-To: <p04330100b6a8406244a7@[134.76.136.114]>
Message-ID: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>

On Thu, 8 Feb 2001, Ragnar Beer wrote:

> Howdy!
>
> According to help(points) setting the bg parameter should set the
> background fill color for open plot symbols. But when I tried out
> (R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always
> see through the "O". Is this a bug or am getting something wrong?

I believe it refers only to pch=21:25, as described about 10 lines
further up.  Certainly pch=1 is the outline of a cicrle, not a filled
circle.  I've made this explicit in the documentation.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rbeer@uni-goettingen.de  Thu Feb  8 13:22:04 2001
From: rbeer@uni-goettingen.de (Ragnar Beer)
Date: Thu, 8 Feb 2001 14:22:04 +0100
Subject: [Rd] hollow points bug?
In-Reply-To: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>
References: <Pine.GSO.4.31.0102081240570.14253-100000@toucan.stats>
Message-ID: <p04330102b6a84cbe1a70@[134.76.136.114]>

Got it. Thanks a lot! Perhaps " (pch=21:25)" could be added to the 
line describing bg to add some redundancy.

Ragnar

>On Thu, 8 Feb 2001, Ragnar Beer wrote:
>
>>  Howdy!
>>
>>  According to help(points) setting the bg parameter should set the
>>  background fill color for open plot symbols. But when I tried out
>>  (R-1.2.1 on Linux and Mac) e.g. points(1,1,bg="white") I could always
>>  see through the "O". Is this a bug or am getting something wrong?
>
>I believe it refers only to pch=21:25, as described about 10 lines
>further up.  Certainly pch=1 is the outline of a cicrle, not a filled
>circle.  I've made this explicit in the documentation.
>
>--
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272860 (secr)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
>r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
>Send "info", "help", or "[un]subscribe"
>(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
>_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Feb  8 13:41:03 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 8 Feb 2001 14:41:03 +0100
Subject: [Rd] RE: [R] Removing "row.names"
In-Reply-To: <200102071850.NAA22791@jessie.research.bell-labs.com>
References: <200102071850.NAA22791@jessie.research.bell-labs.com>
Message-ID: <14978.41455.172646.505117@mithrandir.hornik.net>

>>>>> David James writes:

>> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
>> From: Thomas Lumley <tlumley@u.washington.edu>
>> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
>> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
>> Subject: Re: [Rd] RE: [R] Removing "row.names"
>> MIME-Version: 1.0
>> 
>> On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> 
>> > >>>>> Thomas Lumley writes:
>> > 
>> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
>> > >> >>>>> Peter Dalgaard BSA writes:
>> > >> 
>> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> > >> >> names(sampled) <- " "
>> > >> >> and
>> > >> >> dimnames(sampled)[[2]] <- " "
>> > >> >> 
>> > >> >> happily introduce non-unique variable names in the data frame.
>> > >> >> 
>> > >> >> Is the rule that row.names and names must be unique still on?
>> > >> >> 
>> > >> >> Argh ...
>> > >> 
>> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
>> > >> > following curious result:
>> > >> 
>> > >> >> d <- data.frame(a=1:3,b=4:6)
>> > >> >> names(d)<-c(" "," ")
>> > >> >> d
>> > >> 
>> > >> > 1 1 4
>> > >> > 2 2 5
>> > >> > 3 3 6
>> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
>> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be unique
>> > >> > Dumped
>> > >> 
>> > >> > R dispatches similarly, but doesn't check the dimnames in
>> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
>> > >> 
>> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
>> > >> 
>> > >> > at the appropriate spot.
>> > >> 
>> > >> Thomas' view about what should be permitted seems to be different.
>> > 
>> > > I wouldn't object to making it hard to create duplicated names(), but
>> > > I think it would be a bad idea to have data.frame() make up unique
>> > > names if it's given non-unique ones.
>> > 
>> > Maybe `check.names' could also be used for uniqueness testing?
>> > 
>> > In any case, I think we should specify what *exactly* a data frame is.
>> >
>> 
>> I think we should specify, and check.names is a logical way to
>> allow/forbid non-unique columns.  
>> 
>> Having a new class would be messy: logically it shouldn't inherit from
>> data.frame, data.frame should inherit from it, but that would be a real
>> pain to set up.
>> 

> Data frames were originally meant to be used in modeling functions.
> The opening paragraph in Chapter 3 (Data for Models) in the White Book
> says:
 
>   "This chapter describes the general structure for data that
>   will be used throughout the book.  In particular, it introduces the
>   data frame, a class of objects to represent the data typically encounterd  
>   in fitting models."

> However, data.frames may not be quite appropriate for representing
> other types of tabular data (certainly a data.frame does not capture
> the essence of, say, a "relational" table in the SQL sense, which
> doesn't have the concept of row names).  Several manifestations of
> this problem are coercing character data to factors "at the drop of a
> hat" (as someone wrote here or in s-news), the row.names issue now
> being discussed, problems including general objets in the "cells" of
> the data.frame, etc.

> I think that the concept of a data.frame to represent data for fitting
> models is fine, but we may (certainly I) have abused this concept.  We
> need other classes of tabular data objects in addition (not as a
> replacement) to data.frames, together with coercion methods and
> perhaps other utilities.

Thomas had said that yes it would be nice to have something with less
restrictions for modeling, but that it was uneconomical at least to
introduce a new class that data.frame would then inherit from.

I interpret your comment as suggesting that we introduce a new class for
holding tabular data?  Do you have specific ideas on this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Diego@kuonen.com  Thu Feb  8 19:01:46 2001
From: Diego@kuonen.com (Diego Kuonen)
Date: Thu, 08 Feb 2001 20:01:46 +0100
Subject: [Rd] What is R?
Message-ID: <3A82ED1A.E2505E42@Kuonen.com>

Dear all

there's something. that puzzles me about what R is :-)

   "R is available as Free Software under the terms of the Free 
    Software Foundation's GNU General Public License in source 
    code form."

(Source: http://www.r-project.org/about.html)

But, looking at the second paragraph of the same site, you
see this:

   "... and R provides an Open Source route to participation in
    that activity."

As we all know the term "open source" means something close 
(but not identical) to "free software". 

So, what is R?

It clearly seems to be "free software" and not only "open source" 
software, or?


Finally, Let's have a look at the following:

   "... This article describes why using the term ``open source'' does 
    not solve any problems, and in fact creates some. These are the reasons 
    why it is better to stick with ``free software.'' ... "

(Source: http://www.gnu.org/philosophy/free-software-for-freedom.html )


I'm puzzled, are you?


Greets

  Diego


P.S.: What about "Omegahat"?


-- 
Diego Kuonen $\in$ Chairs of Statistics $\subset$ DMA \@ EPFL
http://stat.kuonen.com                  http://www.Statoo.com 
Q: How do I type "for i in *.dvi; do xdvi $i; done" in a GUI?  
/*      panic("esp: Aiee penguin on the SCSI-bus.");       */
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Thu Feb  8 19:44:20 2001
From: tlumley@u.washington.edu (tlumley@u.washington.edu)
Date: Thu, 8 Feb 2001 20:44:20 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102081944.UAA23120@pubhealth.ku.dk>


This came up on r-help but indicates a bug.

dnbinom(x,n,p) calls dbinom_raw(n-1,...)
which returns 0 for n<1.

	-thomas


---------- Forwarded message ----------
Date: Thu, 08 Feb 2001 17:10:23 +0000
From: Yudi Pawitan <yudi@stat.ucc.ie>
To: Mark Myatt <mark@myatt.demon.co.uk>
Cc: R-Help <r-help@stat.math.ethz.ch>
Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

Sorry, Mark, the program worked for Rw1011, but this is
what happened in Rw1021:

> dnbinom(0:5,.9,.4)  
[1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

while, the correct result from Rw1011 is:
>  dnbinom(0:5,.9,.4)
[1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

I have added a corrected dnbinom() below, which makes the program
works  for Rw1021.

-YP-

x_ c(70, 38, 17, 10,  9, 6) 
kk_ 0:5
n_ sum(x)

dnbinom_ function(x,n,p){
         gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
}

fn_ function(p){
    r_ p[1]
    th_ p[2]
    ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
          x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    return(ll)
}

a_ nlm(fn,p=c(.9,.5),hes=T)
est_ a$est

phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
        1-pnbinom((max(kk)-1),est[1],est[2]))
E_ n*phat
chi2_ sum((x-E)^2/E)
cat('Chi2 goodness-of-fit = ',chi2,'\n')
cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


===========================================
At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
>Yudi,
>
>Thanks for this:
>
>>x_ c(70, 38, 17, 10,  9, 6) 
>>kk_ 0:5
>>n_ sum(x)
>>
>>fn_ function(p){
>>    r_ p[1]
>>    th_ p[2]
>>    ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
>>          x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
>>    return(ll)
>>}
>>
>>a_ nlm(fn,p=c(.9,.5),hes=T)
>>est_ a$est
>>
>>phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
>>        1-pnbinom((max(kk)-1),est[1],est[2]))
>>E_ n*phat
>>chi2_ sum((x-E)^2/E)
>>cat('Chi2 goodness-of-fit = ',chi2,'\n')
>>cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
>>
>>print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
>
>It is certainly more elegant than anything I would have come up with but
>I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
>
>        Warning messages: 
>        1: NA/Inf replaced by maximum positive value 
>        2: NA/Inf replaced by maximum positive value 
>        3: NA/Inf replaced by maximum positive value 
>        4: NA/Inf replaced by maximum positive value 
>        5: NA/Inf replaced by maximum positive value 
>        6: NA/Inf replaced by maximum positive value 
>        7: NA/Inf replaced by maximum positive value 
>        8: NA/Inf replaced by maximum positive value 
>
>est holds the starting parameters:
>
>        [1] 0.9 0.5
>
>E (from n*phat) holds:
>
>        [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
>
>which gives a very big chi-square.
>
>Sorry to be a nuisance.
>
>Mark
>
>
>--
>Mark Myatt
>
>
>
Yudi Pawitan     yudi@stat.ucc.ie
Department of Statistics UCC
Cork, Ireland
Ph   353-21-490 2906
Fax 353-21-427 1040 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Thu Feb  8 19:17:20 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Thu, 8 Feb 2001 11:17:20 -0800 (PST)
Subject: [Rd] Re: [R] What is R?
In-Reply-To: <3A82ED1A.E2505E42@Kuonen.com>
Message-ID: <Pine.A41.4.21.0102081105420.191392-100000@homer40.u.washington.edu>

On Thu, 8 Feb 2001, Diego Kuonen wrote:

> Dear all
> 
> there's something. that puzzles me about what R is :-)
> 
>    "R is available as Free Software under the terms of the Free 
>     Software Foundation's GNU General Public License in source 
>     code form."
> 
> (Source: http://www.r-project.org/about.html)
> 
> But, looking at the second paragraph of the same site, you
> see this:
> 
>    "... and R provides an Open Source route to participation in
>     that activity."
> 
> As we all know the term "open source" means something close 
> (but not identical) to "free software". 
> 
> So, what is R?
> 
> It clearly seems to be "free software" and not only "open source" 
> software, or?


R is Open Source software in that it's license complies with the OSI
definition. It is "free software" by the Debian and Free Software
Foundation definitions, and is official GNU software.  No problems
here. 

As Richard Stallman and Eric Raymond (among others) have pointed out,
the difference between these concepts is one of philosophical and
marketing emphasis. The R developers, as far as I know, have no unified
view on "open source" vs "free", nor do they need one. 


	-thomas


Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Feb  9 07:59:01 2001
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 9 Feb 2001 08:59:01 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102090759.IAA25635@pubhealth.ku.dk>

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu> writes:

    TL> This came up on r-help but indicates a bug.

    TL> dnbinom(x,n,p) calls dbinom_raw(n-1,...)
    TL> which returns 0 for n<1.

Actually for all  non-integer n.

This is now fixed for "R-release" aka "R-patched" aka "R 1.2.2 to be" :

--- src/nmath/dnbinom.c.~6~	Wed Jan 24 18:02:07 2001
+++ src/nmath/dnbinom.c	Fri Feb  9 08:37:14 2001
@@ -47,6 +47,12 @@
     if (x < 0 || !R_FINITE(x)) return R_D__0;
     x = R_D_forceint(x);
 
+    if(R_D_nonint(n)) {
+	return R_D_exp(lfastchoose(x + n - 1, x)
+		       + n * log(p) + x * log(1 - p));
+    } 
+    else { /* n is integer */
     prob = dbinom_raw(n-1,n+x-1,p,1-p,give_log);
     return((give_log) ? log(p) + prob : p*prob);
+    }
 }


Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><


    TL> ---------- Forwarded message ----------
    TL> Date: Thu, 08 Feb 2001 17:10:23 +0000
    TL> From: Yudi Pawitan <yudi@stat.ucc.ie>
    TL> To: Mark Myatt <mark@myatt.demon.co.uk>
    TL> Cc: R-Help <r-help@stat.math.ethz.ch>
    TL> Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

    TL> Sorry, Mark, the program worked for Rw1011, but this is
    TL> what happened in Rw1021:

    >> dnbinom(0:5,.9,.4)  
    TL> [1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

    TL> while, the correct result from Rw1011 is:
    >> dnbinom(0:5,.9,.4)
    TL> [1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

    TL> I have added a corrected dnbinom() below, which makes the program
    TL> works  for Rw1021.

    TL> -YP-

    TL> x_ c(70, 38, 17, 10,  9, 6) 
    TL> kk_ 0:5
    TL> n_ sum(x)

    TL> dnbinom_ function(x,n,p){
    TL> gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
    TL> }

    TL> fn_ function(p){
    TL> r_ p[1]
    TL> th_ p[2]
    TL> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    TL> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    TL> return(ll)
    TL> }

    TL> a_ nlm(fn,p=c(.9,.5),hes=T)
    TL> est_ a$est

    TL> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    TL> 1-pnbinom((max(kk)-1),est[1],est[2]))
    TL> E_ n*phat
    TL> chi2_ sum((x-E)^2/E)
    TL> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    TL> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

    TL> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


    TL> ===========================================
    TL> At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
    >> Yudi,
    >> 
    >> Thanks for this:
    >> 
    >>> x_ c(70, 38, 17, 10,  9, 6) 
    >>> kk_ 0:5
    >>> n_ sum(x)
    >>> 
    >>> fn_ function(p){
    >>> r_ p[1]
    >>> th_ p[2]
    >>> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    >>> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    >>> return(ll)
    >>> }
    >>> 
    >>> a_ nlm(fn,p=c(.9,.5),hes=T)
    >>> est_ a$est
    >>> 
    >>> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    >>> 1-pnbinom((max(kk)-1),est[1],est[2]))
    >>> E_ n*phat
    >>> chi2_ sum((x-E)^2/E)
    >>> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    >>> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
    >>> 
    >>> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
    >> 
    >> It is certainly more elegant than anything I would have come up with but
    >> I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
    >> 
    >> Warning messages: 
    >> 1: NA/Inf replaced by maximum positive value 
    >> 2: NA/Inf replaced by maximum positive value 
    >> 3: NA/Inf replaced by maximum positive value 
    >> 4: NA/Inf replaced by maximum positive value 
    >> 5: NA/Inf replaced by maximum positive value 
    >> 6: NA/Inf replaced by maximum positive value 
    >> 7: NA/Inf replaced by maximum positive value 
    >> 8: NA/Inf replaced by maximum positive value 
    >> 
    >> est holds the starting parameters:
    >> 
    >> [1] 0.9 0.5
    >> 
    >> E (from n*phat) holds:
    >> 
    >> [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
    >> 
    >> which gives a very big chi-square.
    >> 
    >> Sorry to be a nuisance.
    >> 
    >> Mark
    >> 
    >> 
    >> --
    >> Mark Myatt
    >> 
    >> 
    >> 
    TL> Yudi Pawitan     yudi@stat.ucc.ie
    TL> Department of Statistics UCC
    TL> Cork, Ireland
    TL> Ph   353-21-490 2906
    TL> Fax 353-21-427 1040 
    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Feb  9 08:08:58 2001
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 9 Feb 2001 09:08:58 +0100 (MET)
Subject: [Rd] dnbinom(,size<1,)=0 (PR#842)
Message-ID: <200102090808.JAA25876@pubhealth.ku.dk>

       
>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "TL" == Thomas Lumley <tlumley@u.washington.edu> writes:
    TL> This came up on r-help but indicates a bug.

    TL> dnbinom(x,n,p) calls dbinom_raw(n-1,...)
    TL> which returns 0 for n<1.

  MM> Actually for all  non-integer n.

wrong, Martin!

Thomas was right:  
       dbinom_raw(m, *)		
       seems fine for non-negative non-integers m.

    MM> This is now fixed for "R-release" aka "R-patched" aka "R 1.2.2 to be" :

    MM> --- src/nmath/dnbinom.c.~6~	Wed Jan 24 18:02:07 2001
    MM> +++ src/nmath/dnbinom.c	Fri Feb  9 08:37:14 2001
    MM> @@ -47,6 +47,12 @@
    MM> if (x < 0 || !R_FINITE(x)) return R_D__0;
    MM> x = R_D_forceint(x);
 
    MM> +    if(R_D_nonint(n)) {
    MM> +	return R_D_exp(lfastchoose(x + n - 1, x)
    MM> +		       + n * log(p) + x * log(1 - p));
    MM> +    } 
    MM> +    else { /* n is integer */
    MM> prob = dbinom_raw(n-1,n+x-1,p,1-p,give_log);
    MM> return((give_log) ? log(p) + prob : p*prob);
    MM> +    }
    MM> }

The above fix reverts to pre R 1.2.0 behaviour 
for non-integer `n' (in C; `size' in R) which is `first order ok',
but far from optimal.

The real solution must be better,
and should be done along the code (see comments!) in dbeta.c.

I won't have time to look at this for the next time though.

    MM> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
    MM> Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
    MM> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
    MM> phone: x-41-1-632-3408		fax: ...-1228			<><


    TL> ---------- Forwarded message ----------
    TL> Date: Thu, 08 Feb 2001 17:10:23 +0000
    TL> From: Yudi Pawitan <yudi@stat.ucc.ie>
    TL> To: Mark Myatt <mark@myatt.demon.co.uk>
    TL> Cc: R-Help <r-help@stat.math.ethz.ch>
    TL> Subject: Re: [R] Goodness of fit to Poisson / NegBinomial

    TL> Sorry, Mark, the program worked for Rw1011, but this is
    TL> what happened in Rw1021:

    >>> dnbinom(0:5,.9,.4)  
    TL> [1] 0.4383833 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000   #wrong!!

    TL> while, the correct result from Rw1011 is:
    >>> dnbinom(0:5,.9,.4)
    TL> [1] 0.43838329 0.23672698 0.13493438 0.07826194 0.04578323 0.02692054

    TL> I have added a corrected dnbinom() below, which makes the program
    TL> works  for Rw1021.

    TL> -YP-

    TL> x_ c(70, 38, 17, 10,  9, 6) 
    TL> kk_ 0:5
    TL> n_ sum(x)

    TL> dnbinom_ function(x,n,p){
    TL> gamma(x+n)/gamma(n)/gamma(x+1)*p^n * (1-p)^x
    TL> }

    TL> fn_ function(p){
    TL> r_ p[1]
    TL> th_ p[2]
    TL> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    TL> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    TL> return(ll)
    TL> }

    TL> a_ nlm(fn,p=c(.9,.5),hes=T)
    TL> est_ a$est

    TL> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    TL> 1-pnbinom((max(kk)-1),est[1],est[2]))
    TL> E_ n*phat
    TL> chi2_ sum((x-E)^2/E)
    TL> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    TL> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')

    TL> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))


    TL> ===========================================
    TL> At 02:31 PM 2/8/01 +0000, Mark Wyatt wrote:
    >>> Yudi,
    >>> 
    >>> Thanks for this:
    >>> 
    >>>> x_ c(70, 38, 17, 10,  9, 6) 
    >>>> kk_ 0:5
    >>>> n_ sum(x)
    >>>> 
    >>>> fn_ function(p){
    >>>> r_ p[1]
    >>>> th_ p[2]
    >>>> ll _ -sum(x[1:max(kk)]*log(dnbinom(kk[-length(kk)],r,th))) -
    >>>> x[length(kk)]*log(1-pnbinom((max(kk)-1),r,th))
    >>>> return(ll)
    >>>> }
    >>>> 
    >>>> a_ nlm(fn,p=c(.9,.5),hes=T)
    >>>> est_ a$est
    >>>> 
    >>>> phat_ c(dnbinom(kk[-length(kk)],est[1],est[2]),
    >>>> 1-pnbinom((max(kk)-1),est[1],est[2]))
    >>>> E_ n*phat
    >>>> chi2_ sum((x-E)^2/E)
    >>>> cat('Chi2 goodness-of-fit = ',chi2,'\n')
    >>>> cat('P-value=',1-pchisq(chi2,df=length(kk)-1-2),'\n')
    >>>> 
    >>>> print(cbind(O=x,E=round(E,1),err=round((x-E)^2/E,1)))
    >>> 
    >>> It is certainly more elegant than anything I would have come up with but
    >>> I just cannot get it to work (Rwin 1.21). The call to nlm() returns:
    >>> 
    >>> Warning messages: 
    >>> 1: NA/Inf replaced by maximum positive value 
    >>> 2: NA/Inf replaced by maximum positive value 
    >>> 3: NA/Inf replaced by maximum positive value 
    >>> 4: NA/Inf replaced by maximum positive value 
    >>> 5: NA/Inf replaced by maximum positive value 
    >>> 6: NA/Inf replaced by maximum positive value 
    >>> 7: NA/Inf replaced by maximum positive value 
    >>> 8: NA/Inf replaced by maximum positive value 
    >>> 
    >>> est holds the starting parameters:
    >>> 
    >>> [1] 0.9 0.5
    >>> 
    >>> E (from n*phat) holds:
    >>> 
    >>> [1] 80.38301  0.00000  0.00000  0.00000  0.00000  3.90972
    >>> 
    >>> which gives a very big chi-square.
    >>> 
    >>> Sorry to be a nuisance.
    >>> 
    >>> Mark
    >>> 
    >>> 
    >>> --
    >>> Mark Myatt
    >>> 
    >>> 
    >>> 
    TL> Yudi Pawitan     yudi@stat.ucc.ie
    TL> Department of Statistics UCC
    TL> Cork, Ireland
    TL> Ph   353-21-490 2906
    TL> Fax 353-21-427 1040 
    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


    TL> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    TL> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    TL> Send "info", "help", or "[un]subscribe"
    TL> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    TL> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

    MM> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    MM> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
    MM> Send "info", "help", or "[un]subscribe"
    MM> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
    MM> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Fri Feb  9 13:20:08 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Fri, 09 Feb 2001 14:20:08 +0100
Subject: [Rd] system command
Message-ID: <3A83EE88.67F639ED@univie.ac.at>

i am using
system
to call the external program csound.
csound does some output to stdout and some to stderr
system handles this differently on the different platforms.

on unix (i have solaris, but as far as i know it is the same on linux)
system("csound",intern=TRUE) redirects stdin into an R object, 
by still outputs stdout to the R window.
system("csound",intern=FALSE) (equivalent to system("csound"))
stdout and stderr go into the R window

Rterm
on win95
system("csound",intern=TRUE) redirects stdin and stderr into an R object
system("csound",intern=FALSE) (equivalent to system("csound"))
outputs everything

Rterm
on win2k
system("csound",intern=TRUE) redirects stdin and stderr into an R object
system("csound",intern=FALSE) (equivalent to system("csound"))
outputs everything
EXCEPT
once 
system("csound",intern=TRUE) has been done
and later one tries
system("csound",intern=FALSE)
stderr is lost completely.
going back to
system("csound",intern=TRUE)
redirects stderr again into the R object,
but stderr does not go to the screen any more
after intern=TRUE has been used once.


so we seem to have to problems:
1) different behavior of system on unix and win32k
2) problems with system and redirection on win32k.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Feb  9 14:28:58 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 9 Feb 2001 14:28:58 +0000 (GMT)
Subject: [Rd] system command
In-Reply-To: <3A83EE88.67F639ED@univie.ac.at>
Message-ID: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>

On Fri, 9 Feb 2001, Erich Neuwirth wrote:

> i am using
> system
> to call the external program csound.
> csound does some output to stdout and some to stderr
> system handles this differently on the different platforms.
>
> on unix (i have solaris, but as far as i know it is the same on linux)
> system("csound",intern=TRUE) redirects stdin into an R object,
> by still outputs stdout to the R window.

I *think* you mean redirect stdout, and sends stderr to the terminal
running R.

> system("csound",intern=FALSE) (equivalent to system("csound"))
> stdout and stderr go into the R window
>
> Rterm
> on win95
> system("csound",intern=TRUE) redirects stdin and stderr into an R object

Redirects stdout and stderr to the terminal running R?

> system("csound",intern=FALSE) (equivalent to system("csound"))
> outputs everything
>
> Rterm
> on win2k
> system("csound",intern=TRUE) redirects stdin and stderr into an R object
> system("csound",intern=FALSE) (equivalent to system("csound"))
> outputs everything
> EXCEPT
> once
> system("csound",intern=TRUE) has been done
> and later one tries
> system("csound",intern=FALSE)
> stderr is lost completely.
> going back to
> system("csound",intern=TRUE)
> redirects stderr again into the R object,
> but stderr does not go to the screen any more
> after intern=TRUE has been used once.
>
>
> so we seem to have to problems:
> 1) different behavior of system on unix and win32k

They are documented to be different!  Whether stdout and stderr are
different is OS-specific.  In particular, Windows consoles have no concept
of stdout.

> 2) problems with system and redirection on win32k.

A bug, almost certainly in Windows 2000 since this works as documented
under NT.   Guido?

But, the essence is that you cannot reasonably expect to use stderr from
a program run by a system() commands, and that applies to, say, Perl
as much as to R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Fri Feb  9 14:38:17 2001
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Fri, 09 Feb 2001 15:38:17 +0100
Subject: [Rd] system command
References: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>
Message-ID: <3A8400D9.F1AB4A14@univie.ac.at>

you are right,
i was using stdin in places where i meant stdout.
stupido.
logically, just do a global replace stdin->stdout in my last message.

currently i am trying to convince the maintainer of csound to add a
command line switch
which switches of stderr output completely.

and i understand theat the unix version and the windows version are
different.
but it still makes sense that they behave as similar as possible
whenever possible.

the whole thing is caused by the fact that the current version of csound
writes to stderr in any case.

and system on unix puts the stderr output in the r console window
in any case. that is what surprises me.
alternatively, system could ignore stderr,
or have an option for ingoring stderr.



Prof Brian Ripley wrote:
> 
> On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> 
> > i am using
> > system
> > to call the external program csound.
> > csound does some output to stdout and some to stderr
> > system handles this differently on the different platforms.
> >
> > on unix (i have solaris, but as far as i know it is the same on linux)
> > system("csound",intern=TRUE) redirects stdin into an R object,
> > by still outputs stdout to the R window.
> 
> I *think* you mean redirect stdout, and sends stderr to the terminal
> running R.
> 
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > stdout and stderr go into the R window
> >
> > Rterm
> > on win95
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> 
> Redirects stdout and stderr to the terminal running R?
> 
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> >
> > Rterm
> > on win2k
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> > EXCEPT
> > once
> > system("csound",intern=TRUE) has been done
> > and later one tries
> > system("csound",intern=FALSE)
> > stderr is lost completely.
> > going back to
> > system("csound",intern=TRUE)
> > redirects stderr again into the R object,
> > but stderr does not go to the screen any more
> > after intern=TRUE has been used once.
> >
> >
> > so we seem to have to problems:
> > 1) different behavior of system on unix and win32k
> 
> They are documented to be different!  Whether stdout and stderr are
> different is OS-specific.  In particular, Windows consoles have no concept
> of stdout.
> 
> > 2) problems with system and redirection on win32k.
> 
> A bug, almost certainly in Windows 2000 since this works as documented
> under NT.   Guido?
> 
> But, the essence is that you cannot reasonably expect to use stderr from
> a program run by a system() commands, and that applies to, say, Perl
> as much as to R.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bwheeler@echip.com  Fri Feb  9 17:36:45 2001
From: bwheeler@echip.com (bwheeler@echip.com)
Date: Fri, 9 Feb 2001 18:36:45 +0100 (MET)
Subject: [Rd] Minor doc bug (PR#843)
Message-ID: <200102091736.SAA07613@pubhealth.ku.dk>

In the doc for split, the factor g is unordered,
so the illustrative code

x <- rnorm(n * nn) + sqrt(codes(g))

should be

x <- rnorm(n * nn) + sqrt(as.numeric(g))


-- 
Bob Wheeler --- (Reply to: bwheeler@echip.com)
        ECHIP, Inc. --- (302) 239-6620, voice and
FAX
           724 Yorklyn Rd., Hockessin, DE 19707
              Randomness comes in bunches

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From David James <dj@research.bell-labs.com>  Fri Feb  9 18:24:50 2001
From: David James <dj@research.bell-labs.com> (David James)
Date: Fri, 9 Feb 2001 13:24:50 -0500 (EST)
Subject: [Rd] tabular data (was RE: [R] Removing "row.names")
Message-ID: <200102091824.NAA03028@jessie.research.bell-labs.com>

Hi,

I agree that replacing data.frames for modeling functions would 
be too painful.  Also I agree with Thomas that new class(es) for 
tabular data should not inherit from data.frame, and that data.frames 
should conceptually inherit from some other base tabular data class.  

At this point I'm not suggesting anything in concrete --- I haven't 
sorted it out in my own mind --- but I want to point out that (1) we
already have several tabular data clasess (not one), including matrices,
arrays, contingency tables, data.frames, etc.;  and that (2) I feel we'll 
need to address some of the problems we get into when we use data.frames 
inappropriately due to lack of other/better data structures. But I 
don't think that one single class can truthfully and completely represent 
all "tabular data".

For instance, interfaces to XML, spreadsheets, DBMS, etc., will further 
expose some of the limitations of these existing objects.  
Tables holding data from relational DBMS are an easy case: this class 
should preserve the original data as much as possible, i.e., no coercing 
into factors, no changing column names, no row names, but otherwise 
very similar to data.frames.  (Timothy Keitt has a more interesting concept 
of "proxyTables" that presents some very interesting issues: should 
proxyTables, which "point" to remote relations in dbms, allow integer 
indexing? --- the relational database model does not support it)

Is there something common to all these objects?  Obviously they all 
support indexing x[i,j, ...] plus the methods dim() and (possibly
NULL) dimnames().  S4 defines vectors as a (virtual) class in 
terms of the indexing operation in exactly this way -- thus in S4 lists 
are vectors, and so are logicals, characters, etc.  We may be able to
group the various "tabular data" classes under such virtual class,
and provide simple coercion facilities so that users can easily
fit, say, a linear model to data coming as an XML document or
in a table stored in a dbms.

David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636
----------------------------------------------------------------------------
> From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> MIME-Version: 1.0
> Content-Transfer-Encoding: 7bit
> Date: Thu, 8 Feb 2001 14:41:03 +0100
> To: David James <dj@research.bell-labs.com>
> Cc: Kurt.Hornik@ci.tuwien.ac.at, tlumley@u.washington.edu, 
p.dalgaard@biostat.ku.dk, R-devel@r-project.org
> Subject: Re: [Rd] RE: [R] Removing "row.names"
> 
> >>>>> David James writes:
> 
> >> Date: Wed, 7 Feb 2001 09:33:12 -0800 (PST)
> >> From: Thomas Lumley <tlumley@u.washington.edu>
> >> To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
> >> cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-devel@r-project.org
> >> Subject: Re: [Rd] RE: [R] Removing "row.names"
> >> MIME-Version: 1.0
> >> 
> >> On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> 
> >> > >>>>> Thomas Lumley writes:
> >> > 
> >> > > On Wed, 7 Feb 2001, Kurt Hornik wrote:
> >> > >> >>>>> Peter Dalgaard BSA writes:
> >> > >> 
> >> > >> > Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> >> > >> >> names(sampled) <- " "
> >> > >> >> and
> >> > >> >> dimnames(sampled)[[2]] <- " "
> >> > >> >> 
> >> > >> >> happily introduce non-unique variable names in the data frame.
> >> > >> >> 
> >> > >> >> Is the rule that row.names and names must be unique still on?
> >> > >> >> 
> >> > >> >> Argh ...
> >> > >> 
> >> > >> > Splus 3.4 dispatches on dimnames<-, but not on names<- with the
> >> > >> > following curious result:
> >> > >> 
> >> > >> >> d <- data.frame(a=1:3,b=4:6)
> >> > >> >> names(d)<-c(" "," ")
> >> > >> >> d
> >> > >> 
> >> > >> > 1 1 4
> >> > >> > 2 2 5
> >> > >> > 3 3 6
> >> > >> >> dimnames(d)[[1]] <- rep(" ",3)  
> >> > >> > Error in "dimnames<-.data.frame"(d, .A0): column names must be 
unique
> >> > >> > Dumped
> >> > >> 
> >> > >> > R dispatches similarly, but doesn't check the dimnames in
> >> > >> > dimnames<-.data.frame. It could do so quite easily. Just add 
> >> > >> 
> >> > >> > || any(duplicated(d[[1]])) || any(duplicated(d[[2]]))
> >> > >> 
> >> > >> > at the appropriate spot.
> >> > >> 
> >> > >> Thomas' view about what should be permitted seems to be different.
> >> > 
> >> > > I wouldn't object to making it hard to create duplicated names(), but
> >> > > I think it would be a bad idea to have data.frame() make up unique
> >> > > names if it's given non-unique ones.
> >> > 
> >> > Maybe `check.names' could also be used for uniqueness testing?
> >> > 
> >> > In any case, I think we should specify what *exactly* a data frame is.
> >> >
> >> 
> >> I think we should specify, and check.names is a logical way to
> >> allow/forbid non-unique columns.  
> >> 
> >> Having a new class would be messy: logically it shouldn't inherit from
> >> data.frame, data.frame should inherit from it, but that would be a real
> >> pain to set up.
> >> 
> 
> > Data frames were originally meant to be used in modeling functions.
> > The opening paragraph in Chapter 3 (Data for Models) in the White Book
> > says:
>  
> >   "This chapter describes the general structure for data that
> >   will be used throughout the book.  In particular, it introduces the
> >   data frame, a class of objects to represent the data typically encounterd  
> >   in fitting models."
> 
> > However, data.frames may not be quite appropriate for representing
> > other types of tabular data (certainly a data.frame does not capture
> > the essence of, say, a "relational" table in the SQL sense, which
> > doesn't have the concept of row names).  Several manifestations of
> > this problem are coercing character data to factors "at the drop of a
> > hat" (as someone wrote here or in s-news), the row.names issue now
> > being discussed, problems including general objets in the "cells" of
> > the data.frame, etc.
> 
> > I think that the concept of a data.frame to represent data for fitting
> > models is fine, but we may (certainly I) have abused this concept.  We
> > need other classes of tabular data objects in addition (not as a
> > replacement) to data.frames, together with coercion methods and
> > perhaps other utilities.
> 
> Thomas had said that yes it would be nice to have something with less
> restrictions for modeling, but that it was uneconomical at least to
> introduce a new class that data.frame would then inherit from.
> 
> I interpret your comment as suggesting that we introduce a new class for
> holding tabular data?  Do you have specific ideas on this?
> 
> -k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Feb  9 21:05:44 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 09 Feb 2001 16:05:44 -0500
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Peter Dalgaard BSA's message of "03 Feb 2001 21:05:06 +0100"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu>
 <x2n1c3353h.fsf@blueberry.kubism.ku.dk>
Message-ID: <px1yt7efdj.fsf@infiniti.ece.cmu.edu>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Thomas Vogels <tov@ece.cmu.edu> writes:
> 
> > Hi,
> > 
> > I've been playing with the tcltk package.  It's very nice to have
> > access to buttons, menus etc. now.  Thank you!
> > 
> > Alas, I also have questions: In Tcl everything is a string [*].  This
> > is not the case in R, of course.  So why are return values of tk
> > commands still strings?  (Is there any other reason than speed or
> > "package is work in progress"?)
> 
> The latter. Also to some extent the fact that it requires more
> knowledge about the content of the return value. The argument passing
> scheme is as you can see quite general and essentially ignorant of the
> routines that are called. In essence the issue is that it is fairly
> easy to convert whatever to strings, but harder the other way around.
> So for the first iteration of the package, the idea would be to have
> the user do the necessary as.xxx conversions of return values.

Requiring the user to do the "type casting" will make the user's code
larger and will make it harder to adopt the package.  It would be nice
if the information would "flow more easily" to the programmer.  I
don't want to have to use more as.whatever than I have to in other
functions.

> > One problem is that the number of functions just explodes, so it might
> > be better to wrap them into one enchillada?
> > 
> >   >  tkwinfo <- function (widget, what="exists", ...) 
> >      switch (what,
> >              exists=tkcmd("winfo", "exists", widget)=="1",
> >              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
> >              width=as.numeric (tkcmd("winfo", "width", widget)),
> >              height=as.numeric (tkcmd("winfo", "height", widget)),
> >              tkcmd ("winfo", what, widget, ...))
> > 
> > (The other problem is that tkcmd("winfo",...) may fail.)

OK, instead of going for enchilladas, how about burritos:

For a graphics device, I would use
  > par("xaxp")  # to obtain values
  [1]  2 10  4
  > par (xaxp=c(2,10,4))  # to set values

Wouldn't something similar to this effect simplify the api and reduce
the number of commands in the package (vastly)?

1) Why not

  > tt<-tktoplevel()
  > button <- tkbutton(tt, text="Push", command=function()cat("Ouch\n"))
  > tkpar (button, c("text", "command"))
  $text
  [1]  "Push"

  $command
  [1] " R_call 0xbfeb1c "

  > tkpar (button, text="Yow!", command=function()cat("Yow\n"))

instead of:

  > tkcget (button, "-text")  # (hmm, shouldn't need '-' here!)
  [1] "b"
  > tkcget (button, "-command")  # (again, why '-command'?)
  [1] " R_call 0xbfeb1c "
  > tkconfigure (button, text="Yow!", command=function()cat("Yow\n"))
  [1] ""
  > # Doesn't return previous value...

This examples applies to a bunch of command pairs, like
cget/configure, itemcget/itemconfigure, imagecget/imageconfigure,
entrycget/entryconfigure, window.cget/window.configure, ...

2) Why not:

  > tt <- tktoplevel()
  > tkwm (tt, "minwidth")  # returns integers not strings
  [1] 1 1
  > tkwm (tt, minwidth=c(100,100))  # sets new values

instead of:

  > tkwm.minsize (tt)
  [1] "1 1"
  > tkwm.minsize (tt, "100","100")
  [1] ""

The second example would wipe out 25 or so tkwm.* commands to be
replaced by one tkwm.  (Same would apply for tkwinfo...)  Wouldn't
that also simplify maintenance and documentation?

Does this make sense?  Or does it sound like I've been smoking my corn
flakes instead of eating them?  Is anybody else using the package
tcltk and would it make sense to put some code behind those
suggestions?

Thanks,
  -tom


> > Oh, while I'm at it:  There is no tkupdate:
> >   >  tkupdate <- function (idletasks=FALSE)
> >      if (idletasks) tkcmd ("update", "idletasks") else tkcmd ("update")
> > 
> > (which is essential to making sure that a window is mapped before its
> > width or height is queried.)  That's trivial if you have hacked Tcl/Tk
> > before -- so who is the package tlctk aimed at?
> 
> Tcl/Tk hackers of course, the author of the package not being one...
> 
> Basically, the plan is to add stuff as it becomes necessary to do
> useful things, so feedback and suggestions from developers are always
> welcome.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pperkins@ucsd.edu  Fri Feb  9 22:04:43 2001
From: pperkins@ucsd.edu (pperkins@ucsd.edu)
Date: Fri, 9 Feb 2001 23:04:43 +0100 (MET)
Subject: [Rd] default data= arg to glm() (PR#844)
Message-ID: <200102092204.XAA08400@pubhealth.ku.dk>

Full_Name: Peter Perkins
Version: 1.2.1
OS: LinuxPPC
Submission from: (NULL) (24.4.89.36)


the lines

   if (missing(data)) 
      data <- environment(formula)

in glm() seem to contradict the documentaton:

   data: an optional data frame containing the variables in the model.
         By default the variables are taken from the environment from
         which `glm' is called.

actually, the near lack of other references to "data" is glm() is not
clear to me, so i may have this wrong.  but a small test seems to bear
out the problem:

function () 
{
	form <- y ~ x
	fun1 <- function(f)
	{
		n <- 10
		x <- runif(n, 1, 10)
		y <- rpois(n, x)
		glm(f, family=poisson(link="log"), data=environment())
	}
	fun2 <- function(f)
	{
		n <- 10
		x <- runif(n, 1, 10)
		y <- rpois(n, x)
		glm(f, family=poisson(link="log"))
	}
	print("fit1")
	print(fun1(form)$call)
	print("fit2")
	print(fun2(form)$call)
}

> test()
[1] "fit1"
glm(formula = f, family = poisson(link = "log"), data = environment())
[1] "fit2"
Error in eval(expr, envir, enclos) : Object "y" not found


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb  9 22:57:19 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Fri, 9 Feb 2001 14:57:19 -0800 (PST)
Subject: [Rd] default data= arg to glm() (PR#844)
In-Reply-To: <200102092204.XAA08400@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0102091417100.82220-100000@homer27.u.washington.edu>

On Fri, 9 Feb 2001 pperkins@ucsd.edu wrote:
> 
> the lines
> 
>    if (missing(data)) 
>       data <- environment(formula)
> 
> in glm() seem to contradict the documentaton:
> 
>    data: an optional data frame containing the variables in the model.
>          By default the variables are taken from the environment from
>          which `glm' is called.
> 
> actually, the near lack of other references to "data" is glm() is not
> clear to me, so i may have this wrong.  but a small test seems to bear
> out the problem:

The documentation is slightly out of date.  The current behaviour is that
the variables are taken from the environment in which the model formula is
defined. This will usually, but not always, be the same thing. This
behaviour is new in 1.2.0, and is designed to give functions like
predict() and update() a fighting chance.

However, the line you quote is in fact irrelevant to this. The
variable `data' that it modifies is not used in fitting the model, it is
just returned as part of the result. So, you ask, if the `data' variable
is never used, how is it used?

This is Deep Magic, and probably worth explaining.
A copy of the call to glm() (or other modelling functions) is grabbed by
match.call() and turned into a call to model.frame(). This call is then
evaluated in the parent environment to create a model frame. The
model.matrix() function is then called to create a design matrix from the
model frame.

This is how we fake dynamic scope -- using the values of variables in the
parent environment --  in a language that really has static scope. 

The moral of this is that it pays to put the variables you want to use in
a data frame. It's much easier to find them that way than by playing
clever games with environments.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Sat Feb 10 01:50:13 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 10 Feb 2001 02:50:13 +0100
Subject: [Rd] tk non-widget commands (esp. update and winfo)
In-Reply-To: Thomas Vogels's message of "09 Feb 2001 16:05:44 -0500"
References: <pxofwjd0ss.fsf@infiniti.ece.cmu.edu> <x2n1c3353h.fsf@blueberry.kubism.ku.dk> <px1yt7efdj.fsf@infiniti.ece.cmu.edu>
Message-ID: <x2ofwbl31m.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@ece.cmu.edu> writes:

> > The latter. Also to some extent the fact that it requires more
> > knowledge about the content of the return value. The argument passing
> > scheme is as you can see quite general and essentially ignorant of the
> > routines that are called. In essence the issue is that it is fairly
> > easy to convert whatever to strings, but harder the other way around.
> > So for the first iteration of the package, the idea would be to have
> > the user do the necessary as.xxx conversions of return values.
> 
> Requiring the user to do the "type casting" will make the user's code
> larger and will make it harder to adopt the package.  It would be nice
> if the information would "flow more easily" to the programmer.  I
> don't want to have to use more as.whatever than I have to in other
> functions.

Sure, but it requires more detailed study of what the query-type
functions do, and what values they return.

> > > One problem is that the number of functions just explodes, so it might
> > > be better to wrap them into one enchillada?
> > > 
> > >   >  tkwinfo <- function (widget, what="exists", ...) 
> > >      switch (what,
> > >              exists=tkcmd("winfo", "exists", widget)=="1",
> > >              ismapped=tkcmd("winfo", "ismapped", widget)=="1",
> > >              width=as.numeric (tkcmd("winfo", "width", widget)),
> > >              height=as.numeric (tkcmd("winfo", "height", widget)),
> > >              tkcmd ("winfo", what, widget, ...))
> > > 
> > > (The other problem is that tkcmd("winfo",...) may fail.)
> 
> OK, instead of going for enchilladas, how about burritos:
> 
> For a graphics device, I would use
>   > par("xaxp")  # to obtain values
>   [1]  2 10  4
>   > par (xaxp=c(2,10,4))  # to set values
> 
> Wouldn't something similar to this effect simplify the api and reduce
> the number of commands in the package (vastly)?
> 
> 1) Why not
> 
>   > tt<-tktoplevel()
>   > button <- tkbutton(tt, text="Push", command=function()cat("Ouch\n"))
>   > tkpar (button, c("text", "command"))
>   $text
>   [1]  "Push"
> 
>   $command
>   [1] " R_call 0xbfeb1c "

>   > tkpar (button, text="Yow!", command=function()cat("Yow\n"))
> 
> instead of:
> 
>   > tkcget (button, "-text")  # (hmm, shouldn't need '-' here!)
>   [1] "b"
>   > tkcget (button, "-command")  # (again, why '-command'?)
>   [1] " R_call 0xbfeb1c "

Actually, I think tkcget(button, text=NULL) is the convention for
argument-less options. The " R_call 0xbfeb1c " is wrong in either
case: It really should return the R object sitting at the address
0xbfeb1c, reversing .Tcl.callback. 

Not sure that I would want to go the tkpar() route. If I were moving
away from the direct correspondence between the R and Tcl side of the
fence I'd probably rather overload the $ $<- [[ [[<- set of operators
and have stuff like

> button$text
[1]  "Push"
> button$command
function()cat("Ouch\n")
<environment: 0x8b4641c>
> button$text<-"Pull"

and so forth. I sort of started along a similar path with the
tktitle()/tktitle()<- mechanism, but stopped as it seemed to be
getting excessive to complete this mechanism for all commands.

>   > tkconfigure (button, text="Yow!", command=function()cat("Yow\n"))
>   [1] ""
>   > # Doesn't return previous value...
> 
> This examples applies to a bunch of command pairs, like
> cget/configure, itemcget/itemconfigure, imagecget/imageconfigure,
> entrycget/entryconfigure, window.cget/window.configure, ...
> 
> 2) Why not:
> 
>   > tt <- tktoplevel()
>   > tkwm (tt, "minwidth")  # returns integers not strings
>   [1] 1 1
>   > tkwm (tt, minwidth=c(100,100))  # sets new values
> 
> instead of:
> 
>   > tkwm.minsize (tt)
>   [1] "1 1"
>   > tkwm.minsize (tt, "100","100")
>   [1] ""
> 
> The second example would wipe out 25 or so tkwm.* commands to be
> replaced by one tkwm.  (Same would apply for tkwinfo...)  Wouldn't
> that also simplify maintenance and documentation?

Nope. I'm not necessarily saying that it might not be a good idea, but
introducing command-dependent option handling is not going to simplify
the documentation. Explaining why tkwm (tt, minsize=c(100,100))
doesn't come across as "wm .1 -minsize 100 100" but as "wm minsize .1
100 100" would be tricky to explain. In this case, the changed syntax
doesn't actually save you anything anyway.
 
> Does this make sense?  Or does it sound like I've been smoking my corn
> flakes instead of eating them?  Is anybody else using the package
> tcltk and would it make sense to put some code behind those
> suggestions?

We have the occasional report from people using the package. My guess
is that it gets used for fairly simplistic things similar to the
demos. In a slightly longer perspective, I'd like to see a more
elaborate user interface prototype emerge from it. The package
certainly needs further development, and in particular the return
value handling needs some sort of fixing up. 

I still think it is useful to keep some sort of unifying perspective
on the whole thing, and I do think it is useful - at least for now -
to try and maintain some of the transparency between the R functions
and the corresponding Tcl commands.

If you want to start writing code, it might be useful to attack the
cget-style functions first. It might be nice if they could vector to a
(say) tkquery function which could be supplied with a table of return
types by option.

One possible gotcha is that the list of options is really widget
specific, and I'm not quite sure that it cannot happen that the same
option name corresponds to different value types in different widgets.

The set of valid options is certainly widget dependent (i.e. you
cannot have tkcget(radiobutton, xscrollIncrement=NULL) for instance),
and the full set of options is reall unspecified if you start thinking
of imported megawidgets and soforth. 

Hmmm.... I think you need to store the list of options with the
widgets or their class somehow, so you'd soon be on the way to a true
object system.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Sun Feb 11 10:54:28 2001
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Sun, 11 Feb 2001 11:54:28 +0100
Subject: [Rd] system command
In-Reply-To: <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>; from ripley@stats.ox.ac.uk on Fri, Feb 09, 2001 at 02:28:58PM +0000
References: <3A83EE88.67F639ED@univie.ac.at> <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats>
Message-ID: <20010211115428.A20548@sirio.stat.unipd.it>

On Fri, Feb 09, 2001 at 02:28:58PM +0000, Prof Brian Ripley wrote:
> On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> > ...........................................................
> > Rterm
> > on win2k
> > system("csound",intern=TRUE) redirects stdin and stderr into an R object
> > system("csound",intern=FALSE) (equivalent to system("csound"))
> > outputs everything
> > EXCEPT
> > once
> > system("csound",intern=TRUE) has been done
> > and later one tries
> > system("csound",intern=FALSE)
> > stderr is lost completely.
> > going back to
> > system("csound",intern=TRUE)
> > redirects stderr again into the R object,
> > but stderr does not go to the screen any more
> > after intern=TRUE has been used once.
> >
> > .....................................................................
> > 2) problems with system and redirection on win32k.
> 
> A bug, almost certainly in Windows 2000 since this works as documented
> under NT.   Guido?

  I can replicate the problem (under Windows 2000 but not under
  Win98 or NT) using
  > system("ls",intern=TRUE);system("ls")
  I will take a look.

  guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Sun Feb 11 11:48:54 2001
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Sun, 11 Feb 2001 12:48:54 +0100
Subject: [Rd] system command
In-Reply-To: <20010211115428.A20548@sirio.stat.unipd.it>; from guido@sirio.stat.unipd.it on Sun, Feb 11, 2001 at 11:54:28AM +0100
References: <3A83EE88.67F639ED@univie.ac.at> <Pine.GSO.4.31.0102091415080.18117-100000@toucan.stats> <20010211115428.A20548@sirio.stat.unipd.it>
Message-ID: <20010211124854.A21040@sirio.stat.unipd.it>

On Sun, Feb 11, 2001 at 11:54:28AM +0100, Guido Masarotto wrote:
> On Fri, Feb 09, 2001 at 02:28:58PM +0000, Prof Brian Ripley wrote:
> > On Fri, 9 Feb 2001, Erich Neuwirth wrote:
> > > .....................................................................
> > > 2) problems with system and redirection on win32k.
> > 
> > A bug, almost certainly in Windows 2000 since this works as documented
> > under NT.   Guido?
> 
>   I can replicate the problem (under Windows 2000 but not under
>   Win98 or NT) using
>   > system("ls",intern=TRUE);system("ls")
>   I will take a look.
> 


  Oops. After redirection (needed by system(...,intern=TRUE), Rterm's
  stdout was marked as not inheritable. 
  I have committed a fix for 1.2.2.
  guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From patrick.lindsey@luc.ac.be  Sun Feb 11 13:53:09 2001
From: patrick.lindsey@luc.ac.be (patrick.lindsey@luc.ac.be)
Date: Sun, 11 Feb 2001 14:53:09 +0100 (MET)
Subject: [Rd] Bug in pictex output. (PR#845)
Message-ID: <200102111353.OAA12746@pubhealth.ku.dk>

Hi everyone,
  I have just received a bug from one of my students. It concerns the pictex
command to produce plots in latex format. It seems to add lines on the graph
even in the most simplest cases. For example, try the following quadratic
curve:
plot(1:11,(-5:5)^2,type="b",main="Simple Example Plot")
Now, saving the plot with the following command:
pictex("plot.tex")
plot(1:11,(-5:5)^2,type="b",main="Simple Example Plot")
dev.off()
and then latex the file using the example in the help page as
\documentclass{article}
\begin{document}
\begin{figure}[h]
\centerline{\input{plots.tex}}
\end{figure}
\end{document}
produces a plot with an additional line (a diagonal line going all the way
through the plot from bottom left to top right). The error occurs on line
78 (out of 87) produced by pictex. Removing that latex command from the file
(or commenting it out) corrects the problem in this case... but looking
closer to how the axis are setup one can rapidely see that this is not done
very efficiently and could perhaps be simplified (there are 4 lines super-
imposing one another! just keeping the longest one would be enough). Hence,
perhaps something is wrong in the driver at the axis level...
As I said this problem was found by a student, as I use postscript to produce
my graphs I was just told that all plots produced with pictex produced similar
problems... but I don't know what happens in other cases than this simple
example I got from the student.
Hope this helps in fixing the problem.
Patrick.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tsumi@leo.auric.ne.jp  Sun Feb 11 14:28:55 2001
From: tsumi@leo.auric.ne.jp (Tsumiyama Isao)
Date: Sun, 11 Feb 2001 23:28:55 +0900
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102111433.PAA13691@stat.math.ethz.ch>

 Dear R users,
 
  I want to create a C program drawing a scatter plot
  with R functions.

Is it possible to do such a thing with interfaces declared
in 'Rgraphics.h'? If so, I would like to get sample C sources.

>From a user in Japan.

 Thanks,



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 11 16:49:28 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 11 Feb 2001 16:49:28 +0000 (GMT)
Subject: [Rd] Scatter plot calling R function from C
In-Reply-To: <200102111433.PAA13691@stat.math.ethz.ch>
Message-ID: <Pine.GSO.4.31.0102111644480.29747-100000@toucan.stats>

On Sun, 11 Feb 2001, Tsumiyama Isao wrote:

>  Dear R users,
>
>   I want to create a C program drawing a scatter plot
>   with R functions.
>
> Is it possible to do such a thing with interfaces declared
> in 'Rgraphics.h'? If so, I would like to get sample C sources.

Strictly no.  You would need to open an R graphics device, and you can't
do that from the publically declared headers.  And you would need to
handle all the error conditions that call back into R.

>From C code called from R you can write to an already opened graphics
device.  Alternatives, you can embed R in your C program and then call R
graphics via R calls.

I don't think there are many examples: Rgraphics.h was included for
use by experts writing addons.  Paul Murrell may be able to help more.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Mon Feb 12 01:27:18 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Mon, 12 Feb 2001 14:27:18 +1300
Subject: [Rd] Scatter plot calling R function from C
References: <Pine.GSO.4.31.0102111644480.29747-100000@toucan.stats>
Message-ID: <021301c09492$f32ad320$175dd882@stat.auckland.ac.nz>

Hi


> On Sun, 11 Feb 2001, Tsumiyama Isao wrote:
>
> >  Dear R users,
> >
> >   I want to create a C program drawing a scatter plot
> >   with R functions.
> >
> > Is it possible to do such a thing with interfaces declared
> > in 'Rgraphics.h'? If so, I would like to get sample C sources.
>
> Strictly no.  You would need to open an R graphics device, and you can't
> do that from the publically declared headers.  And you would need to
> handle all the error conditions that call back into R.
>
> From C code called from R you can write to an already opened graphics
> device.  Alternatives, you can embed R in your C program and then call R
> graphics via R calls.
>
> I don't think there are many examples: Rgraphics.h was included for
> use by experts writing addons.  Paul Murrell may be able to help more.


As Brian says, the first big obstacle is getting a device started, which can
only be done from R.  Once you have that, then all of the necessary graphics
is there in Rgraphics.h, but its at a very low level.  Rgraphics.h gives you
access to a basic graphics engine for drawing lines and rectangles and such,
plus some more complicated things like data symbols, but it does not have
anything really high level like a plot or even an axis.  You have to compose
these things yourself.

There are examples of how R uses these functions in R/src/main/plot.c, but
it would take a considerable effort to work out what is going on.

The functions Rgraphics.h exports are useful if you want to write your own
graphics system from the ground up, but they are not very useful if you want
to produce plots like the ones that R already produces.  If you want to do
the latter then you are much better to try the route suggested by Brian and
embed R in your C program so that you can call R's high-level graphics
functions.

Hope that helps

Paul






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Feb 12 15:47:45 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Feb 2001 16:47:45 +0100
Subject: [Rd] Re: tabular data (was RE: [R] Removing "row.names")
In-Reply-To: <200102091824.NAA03028@jessie.research.bell-labs.com>
References: <200102091824.NAA03028@jessie.research.bell-labs.com>
Message-ID: <14984.1441.181293.426501@mithrandir.hornik.net>

>>>>> David James writes:

> Hi,

> For instance, interfaces to XML, spreadsheets, DBMS, etc., will
> further expose some of the limitations of these existing objects.
> Tables holding data from relational DBMS are an easy case: this class
> should preserve the original data as much as possible, i.e., no
> coercing into factors, no changing column names, no row names, but
> otherwise very similar to data.frames.  (Timothy Keitt has a more
> interesting concept of "proxyTables" that presents some very
> interesting issues: should proxyTables, which "point" to remote
> relations in dbms, allow integer indexing? --- the relational database
> model does not support it)

> Is there something common to all these objects?  Obviously they all
> support indexing x[i,j, ...] plus the methods dim() and (possibly
> NULL) dimnames().  S4 defines vectors as a (virtual) class in terms of
> the indexing operation in exactly this way -- thus in S4 lists are
> vectors, and so are logicals, characters, etc.  We may be able to
> group the various "tabular data" classes under such virtual class, and
> provide simple coercion facilities so that users can easily fit, say,
> a linear model to data coming as an XML document or in a table stored
> in a dbms.

Maybe this is something to be kicked off at the official part of DSC and
discussed in the `r-core' part.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bwheeler@echip.com  Tue Feb 13 00:38:48 2001
From: bwheeler@echip.com (bwheeler@echip.com)
Date: Tue, 13 Feb 2001 01:38:48 +0100 (MET)
Subject: [Rd] Sticky levels (PR#846)
Message-ID: <200102130038.BAA29298@pubhealth.ku.dk>

This isn't actually a bug, but what is one to do
in cast of a typo?

> citizen<-factor(c("uk","as","no","au","uk","us","us"))
> levels(citizen)
[1] "as" "au" "no" "uk" "us"
> citizen[2]<-"us"
> citizen
[1] uk us no au uk us us
Levels:  as au no uk us    ** [STICKY "as"] **
> citizen[2]<-"gs"
Warning message: 
invalid factor level, NAs generated in:
[<-.factor(*tmp*, 2, value = "gs")

-- 
Bob Wheeler --- (Reply to: bwheeler@echip.com)
        ECHIP, Inc.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Tue Feb 13 00:44:58 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Mon, 12 Feb 2001 16:44:58 -0800 (PST)
Subject: [Rd] Sticky levels (PR#846)
In-Reply-To: <200102130038.BAA29298@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0102121642400.133498-100000@homer27.u.washington.edu>

On Tue, 13 Feb 2001 bwheeler@echip.com wrote:

> This isn't actually a bug, 

True. Perhaps R-bugs wasn't the best place for it initially?

>			but what is one to do
> in cast of a typo?
> 
> > citizen<-factor(c("uk","as","no","au","uk","us","us"))
> > levels(citizen)
> [1] "as" "au" "no" "uk" "us"
> > citizen[2]<-"us"

  citizen<-as.character(citizen)
  citizen[2]<-"us"
  citizen<-factor(citizen)

would do it. Yes, certain aspects of factors are a pain at times.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From cyg@sympatico.ca  Tue Feb 13 11:06:40 2001
From: cyg@sympatico.ca (Yves Gauvreau)
Date: Tue, 13 Feb 2001 06:06:40 -0500
Subject: [Rd] Documentation suggestion!
In-Reply-To: <Pine.GSO.4.31.0102130718110.9532-100000@auk.stats>
Message-ID: <NEBBJKDJHEFCOOLFFAKKOEOACAAA.cyg@sympatico.ca>

Hi,

Could I suggest that the documentation of "locator" and "identify" be
modified so that they refer to each other and that the "graphic" keyword be
added to "identify". If you think it's a good idea of course, I would even
volunteer to do it if you can point me to the procedure. (What file(s) would
have to be modified beside Rd files if any and what do I do with them
afterward.)

I'm making this suggestion because I had a hard time locating them
especially "identify". I vaguely recalled the functionality was implemented
but I had forgotten the function names. I got to "locator" using
help.search("graphic") and as for "identify" I had to remember the name
which I finally did.

While writing this I took a look at some .Rd files, at keywords and at
keywords.db which are located in D:\R-1.2.0\doc of the main *nix source and
I wonder if there is any kind of information on how the help system works?


Thanks

Yves Gauvreau
B.E.F.P. Universite du Quebec a Montreal
cyg@sympatico.ca

PS. I hope this is the right place to send this.

         _
platform i386-pc-mingw32
arch     x86
os       Win32
system   x86, Win32
status
major    1
minor    2.1
year     2001
month    01
day      15
language R

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Feb 13 11:17:09 2001
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 13 Feb 2001 12:17:09 +0100 (MET)
Subject: [Rd] RE: [R] silly question about spec (PR#847)
Message-ID: <200102131117.MAA04218@pubhealth.ku.dk>

On 14-Feb-01 Jason Turner wrote:
> I'm using spec for multivariate time series, and have a 
> question about "coh".  
> 
> This is probably a very silly question, but I'm a bit stumped.
> From the documentation: 
> 
> Column i + (j - 1) * (j - 2)/2 of coh contains the squared coherency 
> between columns i and j of x, where i > j.
> 
> What's in column 1 of coh?

Not a silly question, but a silly typo in the help page.  In fact the
formula is valid for i < j not i > j, so column 1 gives the squared
coherency between columns 1 and 2:

1 + (2 - 1) * (2 - 2)/2 = 1

Martyn

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Feb 13 11:35:53 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 13 Feb 2001 11:35:53 +0000 (GMT)
Subject: [Rd] Documentation suggestion!
Message-ID: <200102131135.LAA09098@toucan.stats.ox.ac.uk>

> From: "Yves Gauvreau" <cyg@sympatico.ca>
> Date: Tue, 13 Feb 2001 06:06:40 -0500

> Could I suggest that the documentation of "locator" and "identify" be
> modified so that they refer to each other 

That's easy, and done now.

> and that the "graphic" keyword be
> added to "identify". If you think it's a good idea of course, I would even
> volunteer to do it if you can point me to the procedure. (What file(s) would
> have to be modified beside Rd files if any and what do I do with them
> afterward.)

There is no `graphic' keyword.  locator and identify have keyword
`iplot', `Interacting with Plots'.  See below.

> I'm making this suggestion because I had a hard time locating them
> especially "identify". I vaguely recalled the functionality was implemented
> but I had forgotten the function names. I got to "locator" using
> help.search("graphic") and as for "identify" I had to remember the name
> which I finally did.

It took `graphic' from the title for locator, not the keyword.

> While writing this I took a look at some .Rd files, at keywords and at
> keywords.db which are located in D:\R-1.2.0\doc of the main *nix source and

[Actually, there is only one set of sources: it is the Windows source too.]

> I wonder if there is any kind of information on how the help system works?

Really there is not just one help system, but several.  The `keywords'
are a misnomer carried over from S3:  they are in fact categories used
by the HTML search system, and by help.search.  On Windows the CHTML
and WinHelp help systems have full-text-search by default, and we are
looking at ways of providing FTS and approximate matching on other platforms.

I think had you done a search under HTML help, it would have been more
obvious from the categories presented to you.  I would also commend
CHTML full-text searches to you.

We are aware that the help system could be improved, and I have already
suggested real keywords for a future version.


Another issue that is just as important is the contents of the help.  I
realised recently that the documentation for many of the basic graphics
operations is incomplete (they accept many more forms of input via
xy.coords, NAs can be used to break lines, polygons are supposed to be
automatically closed, and so on).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tsumi@leo.auric.ne.jp  Tue Feb 13 14:42:36 2001
From: tsumi@leo.auric.ne.jp (Tsumiyama Isao)
Date: Tue, 13 Feb 2001 23:42:36 +0900
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102131447.PAA17346@stat.math.ethz.ch>

Hi, R users.

Thank you for kind advices.
But I have an additional question about how to emded R in
C code.
Is it like 'Embeded  SQL'? Are there any libraries or interfaces
used to embed R in C code?

>From a R beginner in Japan, 


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Feb 13 15:02:25 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 13 Feb 2001 15:02:25 +0000 (GMT)
Subject: [Rd] Scatter plot calling R function from C
Message-ID: <200102131502.PAA09385@toucan.stats.ox.ac.uk>


> From: "Tsumiyama Isao" <tsumi@leo.auric.ne.jp>
> Date: Tue, 13 Feb 2001 23:42:36 +0900
> 
> Hi, R users.
> 
> Thank you for kind advices.
> But I have an additional question about how to emded R in
> C code.
> Is it like 'Embeded  SQL'? Are there any libraries or interfaces
> used to embed R in C code?

It is not like Embedded SQL.  You need to tell us whether you want to
do this on Unix or Windows.  For the latter, it is easiest to
use the DCOM interface on CRAN.  For the former, you need to build
R as shared library, and see the outline instructions on the developer site.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Tue Feb 13 22:40:37 2001
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Tue, 13 Feb 2001 23:40:37 +0100 (MET)
Subject: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
Message-ID: <200102132240.XAA10562@pubhealth.ku.dk>


Hi, there are two problems in devX11.c.  The one is an undocumented
nuisance and the other isn't a bug until you try to embed an X11
device in another window (think tktoplevel() in tcltk package...).

Let's take a look at locator() first: Assuming you call locator() with
a current X11 device, this call is handled in X11_Locator
(src/unix/X11/devX11.c).  When you have one window open and call
locator, you have three options to quit the locator: click Button 1
(to locate), click Button 2 (to abort), or destroy the window.  The
later results in the error message: "Error in locator(1) : No graphics
device is active". That's OK, sort of.

This gets problematic when you open two windows:
> x11()  # assume that's device 2
> x11()  # assume that's device 3
> plot(1)
> locator(1)  # with device 3 == dev.cur()!

When you now destroy device 3 (where locator expects the click), you have
*no alternative but to close _all_ windows* to abort the locator.  The
locator continues to wait for mouse clicks in device 3 where of course
no further clicks can come from.  That's the nuisance part.

The second problem is that the device may try to plot() into a
non-existant window.  Assume that the window was destroyed by some
other part of the program.  The device (at some point in the future)
will receive a DestroyNotify event that handleEvent ignores.
Blissfully!  *No KillDevice is called* when the window is destroyed by
something other than the WM_DELETE_WINDOW mechanism!  This happens
when you embed the X11 device into another window/application.  For
starters, the device no longer receives WM_DELETE_WINDOW client
messages.  But it does receive a DestroyNotify event when the parent
(the container window) is destroyed.  HandleEvent should, well
_handle_ this _event_.

The patch below is a _suggestion_ how to solve both problems.  It is
against the current r-devel, 1.3, as of 2/13.  I believe this behavior
exists in version 1.2 as well and can be solved there the same way.
The patch is just meant as a convenient and concise way to describe
my suggestion.  I'd greatly appreciate feedback or other ideas!

Implementation:

-- the variable inclose is now in the device specific structure (why
   was it global?)  After the window is mapped, inclose is TRUE until
   the window is destroyed explicitly or a DestroyNotify event has been
   received.
-- the deviceSpecific pointer is set to NULL after the memory has been
   freed. This (side?) effect is used in X11_Locator to detect the
   closing of the current device  which _must_ lead to an error.
-- the if statement to handle events of type DestroyEvent is added to 
   handleEvent
-- when the user closes the device (dev.off()), the window is
   destroyed in X11_Close
-- when the user pushes the close button in the window frame, the
   window is destroyed in handleEvent and X11_Close is initiated
   (the WM_DELETE_WINDOW mechanism already in place.)
-- when the window is destroyed for another reason (e.g. the parent
   being destroyed), it is not destroyed again but X11_Close is still
   initiated.

Regards,
  -tom


--------------------------------------------------
*** devX11.c_orig	Tue Feb 13 15:32:24 2001
--- devX11.c	Tue Feb 13 17:24:04 2001
***************
*** 116,121 ****
--- 116,122 ----
      FILE *fp;				/* file for a bitmap device */
      int quality;			/* JPEG quality */
  
+     Rboolean inclose;                   /* TRUE if window is being closed */
  } x11Desc;
  
  
***************
*** 145,151 ****
  static Atom _XA_WM_PROTOCOLS, protocol;
  
  static Rboolean displayOpen = FALSE;
- static Rboolean inclose = FALSE;
  static int numX11Devices = 0;
  
  	/********************************************************/
--- 146,151 ----
***************
*** 619,632 ****
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS))
! 	if (!inclose && event.xclient.data.l[0] == protocol) {
! 	    XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    KillDevice(dd);
  	}
  }
  
  static void R_ProcessEvents(void *data)
--- 619,652 ----
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
+     else if (event.type == DestroyNotify) {
+         /* The window is being destroyed, kill the device, too. */
+         XFindContext(display, event.xdestroywindow.window,
+                      devPtrContext, &temp);
+         dd = (DevDesc *) temp;
+         xd = (x11Desc *) dd->deviceSpecific;
+         if (!xd->inclose) {
+             xd->inclose = TRUE;
+             KillDevice(dd);
+         }
+     }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS)) {
! 	if (event.xclient.data.l[0] == protocol) {
!             XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    xd = (x11Desc *) dd->deviceSpecific;
! 	    if (!xd->inclose) {
! 		/* Dispatch destroy only once */
! 		xd->inclose = TRUE;
! 		XDestroyWindow(display, xd->window);
! 		XSync (display, 0);
! 		KillDevice(dd);
! 	    }
  	}
+     }
+ 
  }
  
  static void R_ProcessEvents(void *data)
***************
*** 1208,1213 ****
--- 1228,1234 ----
  		     ExposureMask | ButtonPressMask | StructureNotifyMask);
  	XMapWindow(display, xd->window);
  	XSync(display, 0);
+         xd->inclose = FALSE;
  
  	/* Gobble expose events */
  
***************
*** 1464,1476 ****
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* process pending events */
! 	/* set block on destroy events */
! 	inclose = TRUE;
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
- 	XDestroyWindow(display, xd->window);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
--- 1485,1506 ----
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* There are three reasons to be here: */
! 	/* 1) The user clicked on a button in the window frame */
! 	/*    and we received a DELETE_WINDOW from the wm, */
! 	/* 2) Somebody destroyed our window directly, or if */
! 	/*    embedded, the parent is being destroyed, and so */
! 	/*    we got a DestroyNotify event, too, */
! 	/* 3) The user used dev.off() to get rid of us. Bye. */
! 
! 	if (!xd->inclose) {
! 	    xd->inclose = TRUE;
! 	    XDestroyWindow(display, xd->window);
! 	}
! 	/* process pending events (esp. reap events for this window) */
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
***************
*** 1517,1523 ****
      }
  
      free(xd);
!     inclose = FALSE;
  }
  
  	/********************************************************/
--- 1547,1553 ----
      }
  
      free(xd);
!     dd->deviceSpecific = NULL;
  }
  
  	/********************************************************/
***************
*** 1858,1866 ****
  		else
  		    done = 2;
  	    }
! 	}
! 	else
  	    handleEvent(event);
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--- 1888,1901 ----
  		else
  		    done = 2;
  	    }
! 	} else {
  	    handleEvent(event);
+ 	    if (!dd->deviceSpecific) {
+ 		/* Allow new active window to redraw */
+ 		R_ProcessEvents((void*)NULL);
+ 		error ("Device closed while waiting for input.\n");
+ 	    }
+         }
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--------------------------------------------------




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Feb 13 23:19:49 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 13 Feb 2001 18:19:49 -0500
Subject: [Rd] devX11.c -- questions about expose events and XBell
Message-ID: <pxy9va5fxm.fsf@infiniti.ece.cmu.edu>


Hi,  sorry for lumping this together...  Both these issues are rather
small, and I'm not sure either qualifies as a bug...

1) After a window id created in X11_Open and mapped,  you "gobble the
   expose events".  Not true, you gobble any event that comes along!
   The code below fixes this by using *XCheckTypedEvent*.  Hmm, I'm
   not sure this right already, but better...

*** devX11.c~    Tue Feb 13 17:24:40 2001
--- devX11.c    Tue Feb 13 18:07:41 2001
***************
*** 1232,1242 ****
  
        /* Gobble expose events */
  
!       XNextEvent(display, &event);
!       if (event.xany.type == Expose) {
!           while (event.xexpose.count)
!               XNextEvent(display, &event);
!       }
      } else { /* PIXMAP */
        xd->windowWidth = iw = w;
        xd->windowHeight = ih = h;
--- 1232,1241 ----
  
        /* Gobble expose events */
  
!       if (XCheckTypedEvent(display, Expose, &event)) {
!           while (event.xexpose.count)
!               XNextEvent(display, &event);
!       }
      } else { /* PIXMAP */
        xd->windowWidth = iw = w;
        xd->windowHeight = ih = h;


2) There are beeps from X11_Locator for every successful mouse click.
   The code here assumes that stderr is connected to a terminal.
   This is not always true!  When I run R within an ESS session in
   emacs, I get ^G  but no sound.  When I redirect the output, I get
   nothing...  *Question* Why don't you use *XBell*?

*** devX11.c~    Tue Feb 13 17:24:40 2001
--- devX11.c    Tue Feb 13 18:07:41 2001
***************
*** 1880,1887 ****
                if (event.xbutton.button == Button1) {
                    *x = event.xbutton.x;
                    *y = event.xbutton.y;
!                   fprintf(stderr, "\07");
!                   fflush(stderr);
                    XSync(display, 0);
                    done = 1;
                }
--- 1879,1885 ----
                if (event.xbutton.button == Button1) {
                    *x = event.xbutton.x;
                    *y = event.xbutton.y;
!                   XBell (display, 0);
                    XSync(display, 0);
                    done = 1;
                }
   

Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Wed Feb 14 00:11:56 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 14 Feb 2001 01:11:56 +0100
Subject: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 13 Feb 2001 23:40:37 +0100 (MET)"
References: <200102132240.XAA10562@pubhealth.ku.dk>
Message-ID: <x2elx2yvg3.fsf@blueberry.kubism.ku.dk>

tov@ece.cmu.edu writes:


> Blissfully!  *No KillDevice is called* when the window is destroyed by
> something other than the WM_DELETE_WINDOW mechanism!  This happens
> when you embed the X11 device into another window/application.  For
> starters, the device no longer receives WM_DELETE_WINDOW client
> messages.  But it does receive a DestroyNotify event when the parent
> (the container window) is destroyed.  HandleEvent should, well
> _handle_ this _event_.

Heh. Quite probably, this is also the source of the FVWM trouble
reported earlier although that triggered an infinite loop which should
probably be guarded against by other means as well. 

Thanks for filing this (good to have as bug report so that we don't
forget - it's the sort of thing that often has to wait until someone
has a clear enough mind and sufficient stamina to try and get it
right.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Feb 15 04:38:15 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 14 Feb 2001 23:38:15 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <pxae7opnm0.fsf@infiniti.ece.cmu.edu>


Hi, I'm not sure this is a bug in the code, the comment or my
thinking.  So first try goes to r-devel...  I find the following
comment in X11_Open () (src/unix/X11/devX11.c):

/* if we have to bail out with "error", then must free(dd) and free(xd) */

A couple lines down, there is:

    if (!strncmp(dsp, "png::", 5)) {
	FILE *fp;
#ifndef HAVE_PNG
	error("No png support in this version of R");
#endif
	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
	    error("could not open PNG file `%s'", dsp+6);
    ...

So what does the comment imply?  If error jumps out to the toplevel
without giving X11DeviceDriver a chance to free dd and xd, then this
should be:

    if (!strncmp(dsp, "png::", 5)) {
	FILE *fp;
#ifndef HAVE_PNG
        free (xd);
        free (dd);
	error("No png support in this version of R");
#endif
	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w"))) {
            free (xd);
            free (dd);
	    error("could not open PNG file `%s'", dsp+6);
        }

There are a couple more error()s without free()s.  The memory leak
isn't big, I'd still appreciate it if you clarify who should do the free().
Thanks,
  -tom



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 15 08:28:30 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Feb 2001 08:28:30 +0000 (GMT)
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: <pxae7opnm0.fsf@infiniti.ece.cmu.edu>
Message-ID: <Pine.GSO.4.31.0102150824260.13108-100000@toucan.stats>

On 14 Feb 2001, Thomas Vogels wrote:

>
> Hi, I'm not sure this is a bug in the code, the comment or my
> thinking.  So first try goes to r-devel...  I find the following
> comment in X11_Open () (src/unix/X11/devX11.c):
>
> /* if we have to bail out with "error", then must free(dd) and free(xd) */
>
> A couple lines down, there is:
>
>     if (!strncmp(dsp, "png::", 5)) {
> 	FILE *fp;
> #ifndef HAVE_PNG
> 	error("No png support in this version of R");
> #endif
> 	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> 	    error("could not open PNG file `%s'", dsp+6);
>     ...
>
> So what does the comment imply?  If error jumps out to the toplevel
> without giving X11DeviceDriver a chance to free dd and xd, then this
> should be:

[...]

Well, the thinking was that people would not be trying to use facilities
on systems where they had not bothered to implement them, so what problem
was a small memory leak?  They would only do it once, ever ....

In these cases it would be better to give a warning and return FALSE, when
the normal return mechanism will free xd and then dd.  I will alter it to
that when I have tested it out.

BDR

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Feb 15 14:29:42 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 15 Feb 2001 09:29:42 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Prof Brian Ripley's message of "Thu, 15 Feb 2001 08:28:30 +0000 (GMT)"
References: <Pine.GSO.4.31.0102150824260.13108-100000@toucan.stats>
Message-ID: <pxr9106muh.fsf@infiniti.ece.cmu.edu>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> On 14 Feb 2001, Thomas Vogels wrote:
> 
> >
> > Hi, I'm not sure this is a bug in the code, the comment or my
> > thinking.  So first try goes to r-devel...  I find the following
> > comment in X11_Open () (src/unix/X11/devX11.c):
> >
> > /* if we have to bail out with "error", then must free(dd) and free(xd) */
> >
> > A couple lines down, there is:
> >
> >     if (!strncmp(dsp, "png::", 5)) {
> > 	FILE *fp;
> > #ifndef HAVE_PNG
> > 	error("No png support in this version of R");
> > #endif
> > 	if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> > 	    error("could not open PNG file `%s'", dsp+6);
> >     ...
> >
> > So what does the comment imply?  If error jumps out to the toplevel
> > without giving X11DeviceDriver a chance to free dd and xd, then this
> > should be:
> 
> [...]
> 
> Well, the thinking was that people would not be trying to use facilities
> on systems where they had not bothered to implement them, so what problem
> was a small memory leak?  They would only do it once, ever ....

uh, I guess I screwed up the example.  Even more lines down, there is
no free accompanying the error ("could not open PNG file ...").  That
can happen more often and more memory would leak.  But no, I wanted to
know this for another reason: I've played around with the X11 device
driver to implement a feature that allows me to embed the device into
another window.  Opening and closing of x11()'s can happen often
during the execution of the program.  But I'm still not interested in
the memory leak issue per se.

I've seen a segfault or two (not in the regular code) and right now I
blame it on Xevents arriving after the device is shut down.  Now all
of a sudden the calls to free become very interesting.  As I said at
the beginning of the email, I wanted to simply understand the comment,
understand what should be going on, not criticize for it not being
followed.

Although I got the question wrong, I guess, I got the right answer :-)
Thanks.

Regards,
  -tom


> 
> In these cases it would be better to give a warning and return FALSE, when
> the normal return mechanism will free xd and then dd.  I will alter it to
> that when I have tested it out.

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From I.Wilson@maths.abdn.ac.uk  Thu Feb 15 17:59:12 2001
From: I.Wilson@maths.abdn.ac.uk (I.Wilson@maths.abdn.ac.uk)
Date: Thu, 15 Feb 2001 18:59:12 +0100 (MET)
Subject: [Rd] (PR#849)
Message-ID: <200102151759.SAA06837@pubhealth.ku.dk>



The symbol( circle) function does not create
circles.

See following function

ijwbug <- function()
{
   plot.new()
     plot.window(c(-1,1),c(-1,1));
   symbols(0,0,circle=1,add=T,inches=F);

   curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
     curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
lines(c(-1,1),c(1,1));
lines(c(-1,1),c(-1,-1));


}



--please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = x86
  os = Win32
  system = x86, Win32
  status =
  major = 1
  minor = 2.1
  year = 2001
  month = 01
  day = 15
  language = R

Windows NT 4.0 (build 1381) Service Pack 5

Search Path:
  .GlobalEnv, Autoloads, package:base


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 15 18:08:58 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 15 Feb 2001 13:08:58 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
Message-ID: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>

I am trying to catch a segfault from a shell in the tests directory set up by R CMD
check with

R_LIBS=~/dse/CHECKED/library:..
export R_LIBS
R -d gdb
run

but then when I try to load a library I find the setting of R_LIBS is ignored. What
am I doing wrong? The library is found ok without -d gdb. (Using Solaris 2.6, R 1.2.1
Patched (2001-02-06) )

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Thu Feb 15 19:19:13 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Fri, 16 Feb 2001 08:19:13 +1300
Subject: [Rd] (PR#849)
References: <200102151759.SAA06837@pubhealth.ku.dk>
Message-ID: <007701c09784$2e4e3b10$175dd882@stat.auckland.ac.nz>

Hi


> The symbol( circle) function does not create
> circles.
>
> See following function
>
> ijwbug <- function()
> {
>    plot.new()
>      plot.window(c(-1,1),c(-1,1));
>    symbols(0,0,circle=1,add=T,inches=F);
>
>    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
>      curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
> lines(c(-1,1),c(1,1));
> lines(c(-1,1),c(-1,-1));
>
>
> }


If I understand correctly, I think you're just seeing clipping.

Does the slight modification of your function given below behave as you
would expect ?

ijwbug <- function()
{ 
   # do not clip to figure region, clip only to device region
   par(xpd=NA) 
   plot.new()
   plot.window(c(-1,1),c(-1,1));
   symbols(0,0,circle=1,add=T,inches=F);
   # I have added colour to the curves 
   curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1, col="red")
   curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1, col="red")
   lines(c(-1,1),c(1,1));
   lines(c(-1,1),c(-1,-1));
}

Paul




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Thu Feb 15 21:22:01 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 15 Feb 2001 22:22:01 +0100
Subject: [Rd] (PR#849)
In-Reply-To: "Paul Murrell"'s message of "Fri, 16 Feb 2001 08:19:13 +1300"
References: <200102151759.SAA06837@pubhealth.ku.dk> <007701c09784$2e4e3b10$175dd882@stat.auckland.ac.nz>
Message-ID: <x2vgqb63ra.fsf@blueberry.kubism.ku.dk>

"Paul Murrell" <paul@stat.auckland.ac.nz> writes:

> Hi
> 
> 
> > The symbol( circle) function does not create
> > circles.
> >
> > See following function
> >
> > ijwbug <- function()
> > {
> >    plot.new()
> >      plot.window(c(-1,1),c(-1,1));
> >    symbols(0,0,circle=1,add=T,inches=F);
> >
> >    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1)
> >      curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1)
> > lines(c(-1,1),c(1,1));
> > lines(c(-1,1),c(-1,-1));
> >
> >
> > }
> 
> 
> If I understand correctly, I think you're just seeing clipping.
> 
> Does the slight modification of your function given below behave as you
> would expect ?
> 
> ijwbug <- function()
> { 
>    # do not clip to figure region, clip only to device region
>    par(xpd=NA) 
>    plot.new()
>    plot.window(c(-1,1),c(-1,1));
>    symbols(0,0,circle=1,add=T,inches=F);
>    # I have added colour to the curves 
>    curve(sqrt(1 - x^2), from = -1, to = 1, add = T, lty = 1, col="red")
>    curve(-sqrt(1 - x^2), from =  -1, to = 1, add = T, lty = 1, col="red")
>    lines(c(-1,1),c(1,1));
>    lines(c(-1,1),c(-1,-1));
> }
> 
> Paul

Actually, I think the real problem is that the plotting region is not
square, so  curve(sqrt(1 - x^2),...) is an ellipse. Insert
par(pty="s") to fix that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pdenis2@home.com  Fri Feb 16 04:35:06 2001
From: pdenis2@home.com (pdenis2@home.com)
Date: Fri, 16 Feb 2001 05:35:06 +0100 (MET)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
Message-ID: <200102160435.FAA08793@pubhealth.ku.dk>

print.matrix(x) segfaults if the vector supplied to 'rowlab' is
*shorter* than nrow(x):

> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    2.1
year     2001
month    01
day      15
language R
[installed from RPM]

> x<-1:4
> dim(x)<-c(2,2)
> x
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> print.matrix(x)
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> print.matrix(x,rowlab=c('a','b'))
  [,1] [,2]
a    1    3
b    2    4
> print.matrix(x,rowlab=c('a','b','c'))
  [,1] [,2]
a    1    3
b    2    4                                             [OK, ignores
extra labels ...]
> print.matrix(x,rowlab=c('a'))
Segmentation fault (core dumped)

Similar behavior for 'collab' ...



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Fri Feb 16 08:04:45 2001
From: adrian@olsen.ch (Adrian Trapletti)
Date: Fri, 16 Feb 2001 09:04:45 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <3A8CDF1D.707A7785@olsen.ch>

> Date: 15 Feb 2001 09:29:42 -0500
> From: Thomas Vogels
> Subject: Re: [Rd] who frees dd and xd in X11_Open?
>
> Prof Brian Ripley  writes:
>
> > On 14 Feb 2001, Thomas Vogels wrote:
> >
> > >
> > > Hi, I'm not sure this is a bug in the code, the comment or my
> > > thinking.  So first try goes to r-devel...  I find the following
> > > comment in X11_Open () (src/unix/X11/devX11.c):
> > >
> > > /* if we have to bail out with "error", then must free(dd) and free(xd) */
> > >
> > > A couple lines down, there is:
> > >
> > >     if (!strncmp(dsp, "png::", 5)) {
> > >     FILE *fp;
> > > #ifndef HAVE_PNG
> > >     error("No png support in this version of R");
> > > #endif
> > >     if (!(fp = R_fopen(R_ExpandFileName(dsp+5), "w")))
> > >         error("could not open PNG file `%s'", dsp+6);
> > >     ...
> > >
> > > So what does the comment imply?  If error jumps out to the toplevel
> > > without giving X11DeviceDriver a chance to free dd and xd, then this
> > > should be:
> >
> > [...]
> >
> > Well, the thinking was that people would not be trying to use facilities
> > on systems where they had not bothered to implement them, so what problem
> > was a small memory leak?  They would only do it once, ever ....
>
> uh, I guess I screwed up the example.  Even more lines down, there is
> no free accompanying the error ("could not open PNG file ...").  That
> can happen more often and more memory would leak.  But no, I wanted to
> know this for another reason: I've played around with the X11 device
> driver to implement a feature that allows me to embed the device into
> another window.  Opening and closing of x11()'s can happen often
> during the execution of the program.  But I'm still not interested in
> the memory leak issue per se.
>
> I've seen a segfault or two (not in the regular code) and right now I
> blame it on Xevents arriving after the device is shut down.  Now all
> of a sudden the calls to free become very interesting.  As I said at
> the beginning of the email, I wanted to simply understand the comment,
> understand what should be going on, not criticize for it not being
> followed.
>
> Although I got the question wrong, I guess, I got the right answer :-)
> Thanks.
>
> Regards,
>   -tom
>
>
> >
> > In these cases it would be better to give a warning and return FALSE, when
> > the normal return mechanism will free xd and then dd.  I will alter it to
> > that when I have tested it out.
>
>
I don't know if it has something to do with this discussion, but it's
probably worth reporting it.

Under
SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
R : Version 1.2.1  (2001-01-15)
Fvwm95 Version 2.0.43a
the window manager always crashes when I close an x11() device started
within R.

Adrian

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Feb 16 09:03:17 2001
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 16 Feb 2001 09:03:17 +0000 (GMT)
Subject: [Rd] who frees dd and xd in X11_Open?
Message-ID: <200102160903.JAA29278@toucan.stats.ox.ac.uk>


> Date: Fri, 16 Feb 2001 09:04:45 +0100
> From: Adrian Trapletti <adrian@olsen.ch

> I don't know if it has something to do with this discussion, but it's
> probably worth reporting it.
> 
> Under
> SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> R : Version 1.2.1  (2001-01-15)
> Fvwm95 Version 2.0.43a
> the window manager always crashes when I close an x11() device started
> within R.

This discussion is about png() and jpeg() devices.  We've had other
reports about FVWM, though.

Why anyone would use FVWM95 on a system that comes with CDE is an
interesting question, though....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Fri Feb 16 12:03:48 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 2001 13:03:48 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Prof Brian Ripley's message of "Fri, 16 Feb 2001 09:03:17 +0000 (GMT)"
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
Message-ID: <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > From: Adrian Trapletti <adrian@olsen.ch
> 
> > I don't know if it has something to do with this discussion, but it's
> > probably worth reporting it.
> > 
> > Under
> > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > R : Version 1.2.1  (2001-01-15)
> > Fvwm95 Version 2.0.43a
> > the window manager always crashes when I close an x11() device started
> > within R.
> 
> This discussion is about png() and jpeg() devices.  We've had other
> reports about FVWM, though.

...and they too refer to improper error handling by X11. I'm somewhat
baffled by the effect reported, though. Surely, an application
crashing the window manager is a bug in the latter, not the former?
What we've heard of before is that closing X11 windows with the window
manager crashes R, but this sounds like the other way around.

> Why anyone would use FVWM95 on a system that comes with CDE is an
> interesting question, though....

Except for the "95" bit I can empathize with it. (and the law of
inertia is strong for user interfaces in any case).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From stefano.iacus@unimi.it  Fri Feb 16 16:10:44 2001
From: stefano.iacus@unimi.it (Stefano Iacus)
Date: Fri, 16 Feb 2001 17:10:44 +0100
Subject: [Rd] R 1.2.2 (pre-release) available
Message-ID: <a05001900b6b3006ec3ab@[159.149.74.61]>

A pre-release of R 1.2.2 based on the latest R-patched archive 
(2/14/2001) for Macintosh is available at:


http://www.eco-dip.unimi.it/R


It is important to receive as much feedback as possible before R 
1.2.2 is released.

Stefano
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb 16 16:50:01 2001
From: tlumley@u.washington.edu (Thomas Lumley)
Date: Fri, 16 Feb 2001 08:50:01 -0800 (PST)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
In-Reply-To: <200102160435.FAA08793@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.33.0102160848140.53536-100000@homer40.u.washington.edu>

On Fri, 16 Feb 2001 pdenis2@home.com wrote:

> print.matrix(x) segfaults if the vector supplied to 'rowlab' is
> *shorter* than nrow(x):
>

Ok, the cause is the obvious one: there is no check for the length of
rowlab in print[type]Matrix, nor in formatString. formatString happily
wanders along the vector and falls off the end.

I'm going to fix it in formatString, we may also want to fix it higher up.

	-thomas


> > version
>          _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    2.1
> year     2001
> month    01
> day      15
> language R
> [installed from RPM]
>
> > x<-1:4
> > dim(x)<-c(2,2)
> > x
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > print.matrix(x)
>      [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > print.matrix(x,rowlab=c('a','b'))
>   [,1] [,2]
> a    1    3
> b    2    4
> > print.matrix(x,rowlab=c('a','b','c'))
>   [,1] [,2]
> a    1    3
> b    2    4                                             [OK, ignores
> extra labels ...]
> > print.matrix(x,rowlab=c('a'))
> Segmentation fault (core dumped)
>
> Similar behavior for 'collab' ...
>
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle
^^^^^^^^^^^^^^^^^^^^^^^^
 NOTE NEW EMAIL ADDRESS

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tlumley@u.washington.edu  Fri Feb 16 16:54:23 2001
From: tlumley@u.washington.edu (tlumley@u.washington.edu)
Date: Fri, 16 Feb 2001 17:54:23 +0100 (MET)
Subject: [Rd] print.matrix segfaults if rowlab vector too short (PR#850)
Message-ID: <200102161654.RAA17826@pubhealth.ku.dk>

On Fri, 16 Feb 2001, Thomas Lumley wrote:

> On Fri, 16 Feb 2001 pdenis2@home.com wrote:
>
> > print.matrix(x) segfaults if the vector supplied to 'rowlab' is
> > *shorter* than nrow(x):
> >
>
> Ok, the cause is the obvious one: there is no check for the length of
> rowlab in print[type]Matrix, nor in formatString. formatString happily
> wanders along the vector and falls off the end.
>
> I'm going to fix it in formatString, we may also want to fix it higher up.

No I'm not: formatString gets a C vector of strings, not an R vector. It
has to be fixed higher up.

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From denis@mail.cor.epa.gov  Fri Feb 16 17:09:14 2001
From: denis@mail.cor.epa.gov (Denis White)
Date: Fri, 16 Feb 2001 09:09:14 -0800 (PST)
Subject: [Rd] Re: polygon border colors
Message-ID: <Pine.SUN.3.91.1010216085824.11176B@okapi.cor.epa.gov>

I think I see in do_polygon() in plot.c that border colors are
not cycled, and that changes in the lines

...
    PROTECT(border = FixupCol(CAR(args), dd->gp.fg));	args = CDR(args);
...
		GPolygon(i-start, x+start, y+start, USER,
			 INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
...
	    GPolygon(nx-start, x+start, y+start, USER,
		     INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
...

following the pattern for "col" might make cycling possible.

Is this a change that I should try locally, or could this be
considered for the standard version?

thanks,

Denis

---------- Forwarded message ----------
Date: Thu, 15 Feb 2001 18:33:26 -0800 (PST)
From: Denis White <denis@mail.cor.epa.gov>
To: r-help@hypatia.math.ethz.ch
Subject: polygon border colors

Simple question: is it true that 

  polygon (x, y, col=vec, border=vec, ...)

will cycle through the vec colors for fills but not for
the border colors when sending multiple polygons?

thanks,

Denis White
   US EPA, 200 SW 35th St, Corvallis, Oregon, 97333 USA
   voice: 541.754.4476, email: white.denis@epa.gov
   web: www.epa.gov/wed/pages/staff/white/


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Feb 16 17:57:52 2001
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: 16 Feb 2001 12:57:52 -0500
Subject: [Rd] who frees dd and xd in X11_Open?
In-Reply-To: Peter Dalgaard BSA's message of "16 Feb 2001 13:03:48 +0100"
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
 <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk>
Message-ID: <pxwvaqse73.fsf@infiniti.ece.cmu.edu>


Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk> writes:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > > From: Adrian Trapletti <adrian@olsen.ch
> > 
> > > I don't know if it has something to do with this discussion, but it's
> > > probably worth reporting it.
> > > 
> > > Under
> > > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > > R : Version 1.2.1  (2001-01-15)
> > > Fvwm95 Version 2.0.43a
> > > the window manager always crashes when I close an x11() device started
> > > within R.
> > 
> > This discussion is about png() and jpeg() devices.  We've had other
> > reports about FVWM, though.
> 
> ...and they too refer to improper error handling by X11. I'm somewhat
> baffled by the effect reported, though. Surely, an application
> crashing the window manager is a bug in the latter, not the former?
> What we've heard of before is that closing X11 windows with the window
> manager crashes R, but this sounds like the other way around.

The question about freeing xd and dd comes indeed from my fiddling
with the X11 driver and understanding the code there...  As for the
current handleEvent: there are some events simply ignored (like the
DestroyNotify event) and some are not reaped due to the sequence of
events in X11_Close/R_ProcessEvents.  (And the way inclose is handled
is scary once you think of closing two windows at roughly the same
time...)  The events that linger after R is done shouldn't confuse the
window manager, though.

I've put my code, patches, comments, suggestions, etc. at:
http://www.ece.cmu.edu/~tov/public/R/X11andTk.html
I'd be curious whether R with the patched handleEvent still crashes
FVWM95.  Probably but who knows.

  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gs@statlab.uni-heidelberg.de  Fri Feb 16 18:12:29 2001
From: gs@statlab.uni-heidelberg.de (G. Sawitzki)
Date: Fri, 16 Feb 2001 19:12:29 +0100
Subject: [Rd] Re: R 1.2.2 (pre-release) available
In-Reply-To: <a05001900b6b3006ec3ab@[159.149.74.61]>
References: <a05001900b6b3006ec3ab@[159.149.74.61]>
Message-ID: <p05010400b6b31ca16507@[129.206.113.199]>

At 17:10 +0100 16.02.2001, Stefano Iacus wrote:
>A pre-release of R 1.2.2 based on the latest R-patched archive 
>(2/14/2001) for Macintosh is available at:
>
>http://www.eco-dip.unimi.it/R
>
>It is important to receive as much feedback as possible before R 
>1.2.2 is released.
>
>Stefano

Stefano,

the link to Waste does not work. The correct link is
http://www.merzwaren.com/bin/waste/waste-20b3.sit

(/bin/ is missing on you page).

I have three bugs from the previos version where it ran into a crash. 
Standard logs are in
	<ftp://max.statlab.uni-heidelberg.de/users/gs/>,
filenames startign with R. Maybe you can have a short look, but you 
should not spend too much time on these - they may already be fixed 
in the new version.
  gs.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From beebe@math.utah.edu  Sat Feb 17 00:44:15 2001
From: beebe@math.utah.edu (beebe@math.utah.edu)
Date: Sat, 17 Feb 2001 01:44:15 +0100 (MET)
Subject: [Rd] Comments on R-1.2.1 builds (PR#851)
Message-ID: <200102170044.BAA19310@pubhealth.ku.dk>

The R-1.2.1 builds have gone fairly smoothly on most of my UNIX
architectures, but there were many warnings reported by the picky SGI
compiler that could be eliminated in future releases.

Generally, I have found the SGI compilers very helpful in ferreting
out portability problems, unused and/or obsolete variables, unexpected
datatype coercions, etc., and they compile faster than any other
compilers too.

First, I configured like this:

env CC='c89 -mips3 -O3' ./configure && make all

This reports:

	R is now configured for mips-sgi-irix6.5

	  Source directory:          .
	  Installation directory:    /usr/local
	  C compiler:                c89 -mips3 -O3  -OPT:IEEE_NaN_inf=ON -g
	  C++ compiler:              c++  -g -O2
	  FORTRAN compiler:          g77  -OPT:IEEE_NaN_inf=ON -g -O2

	  X11 support:               yes
	  Gnome support:             no
	  Tcl/Tk support:            yes

	  R profiling support:       yes
	  R as a shared library:     no

The build proceeds until this failure:

	g77 -OPT:IEEE_NaN_inf=ON  -g -O2 -c ch2inv.f -o ch2inv.o
	f771: Invalid option `-OPT:IEEE_NaN_inf=ON'
	make[3]: *** [ch2inv.o] Error 1

Evidently, it was not prepared for the GNU Fortran compiler.

I started over with a new clean unpack of the distribution,
with

	env FC=f77 F77=f77 CC=c89 CXX=CC ./configure &&
		make all check install

and got a working build and install.  It reports

	R is now configured for mips-sgi-irix6.5

	  Source directory:          .
	  Installation directory:    /usr/local
	  C compiler:                c89  -OPT:IEEE_NaN_inf=ON -g
	  C++ compiler:              CC  -g
	  FORTRAN compiler:          f77  -OPT:IEEE_NaN_inf=ON -g

	  X11 support:               yes
	  Gnome support:             no
	  Tcl/Tk support:            yes

	  R profiling support:       yes
	  R as a shared library:     no


Here are the all the compiler warnings reported:

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/appl
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c chull.c -o chull.o
cc-1185 c89: WARNING File = chull.c, Line = 77
  An enumerated type is mixed with another type.

      Rboolean vert, neg_dir=0;
                             ^

cc-1185 c89: WARNING File = chull.c, Line = 84
  An enumerated type is mixed with another type.

      vert = (x[jj] == xt);
           ^

cc-1185 c89: WARNING File = chull.c, Line = 87
  An enumerated type is mixed with another type.

        neg_dir = ((s > 0 && d1 < 0.) || (s < 0 && d1 > 0.));
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c cpoly.c -o cpoly.o
cc-1185 c89: WARNING File = cpoly.c, Line = 490
  An enumerated type is mixed with another type.

      *bool = hypot(hvr, hvi) <= are * 10. * hypot(hr[n-1], hi[n-1]);
            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c lbfgsb.c -o lbfgsb.o
cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l1" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l2" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                    ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 326
  The variable "l3" is set but never used.

      int lsnd, l1, l2, l3, ld, lr, lt;
                        ^

cc-1551 c89: WARNING File = lbfgsb.c, Line = 687
  The variable "xstep" is used before its value is set.

                   nint, word, iback, stp, xstep, k);
                                           ^

cc-1552 c89: WARNING File = lbfgsb.c, Line = 582
  The variable "time" is set but never used.

      double time;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c pretty.c -o pretty.o
cc-1185 c89: WARNING File = pretty.c, Line = 82
  An enumerated type is mixed with another type.

        i_small = dx < cell * U * imax2(1,*ndiv) * DBL_EPSILON *3;
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c strsignif.c -o strsignif.o
cc-1552 c89: WARNING File = strsignif.c, Line = 80
  The variable "jL" is set but never used.

      int iex, j, jL, len_flag = strlen(*flag);
                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c uncmin.c -o uncmin.o
cc-1551 c89: WARNING File = uncmin.c, Line = 2443
  The variable "mxtake" is used before its value is set.

         steptl, sx, fscale, itnlim, iretcd, mxtake, msg);
                                             ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/nmath
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c polygamma.c -o polygamma.o
cc-1167 c89: WARNING File = polygamma.c, Line = 167
  Pointer points outside of underlying object.

  static double *b = (double *)&bvalues -1;
                                        ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/unix
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devices.c -o devices.o
cc-1185 c89: WARNING File = devices.c, Line = 111
  An enumerated type is mixed with another type.

                                 colormodel, maxcubesize)) {
                                 ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c edit.c -o edit.o
cc-1185 c89: WARNING File = edit.c, Line = 109
  An enumerated type is mixed with another type.

            t = deparse1(x, 0);
                            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c system.c -o system.o
cc-1185 c89: WARNING File = system.c, Line = 196
  An enumerated type is mixed with another type.

                UsingReadline = 0;
                              ^

cc-1185 c89: WARNING File = system.c, Line = 211
  An enumerated type is mixed with another type.

      R_Interactive = isatty(0);
                    ^

cc-1185 c89: WARNING File = system.c, Line = 234
  An enumerated type is mixed with another type.

      fpu_setup(1);
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c sys-common.c -o sys-common.o
cc-1185 c89: WARNING File = sys-common.c, Line = 173
  An enumerated type is mixed with another type.

      return stat(R_ExpandFileName(path), &sb) == 0;
             ^

cc-1185 c89: WARNING File = sys-common.c, Line = 188
  An enumerated type is mixed with another type.

      if (name && name[0] != '.') return 0;
                                         ^

cc-1185 c89: WARNING File = sys-common.c, Line = 189
  An enumerated type is mixed with another type.

      else return 1;
                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/main
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c RNG.c -o RNG.o
cc-1185 c89: WARNING File = RNG.c, Line = 63
  An enumerated type is mixed with another type.

      { 0, 0, "Wichmann-Hill",          3,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 63
  An enumerated type is mixed with another type.

      { 0, 0, "Wichmann-Hill",          3,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 64
  An enumerated type is mixed with another type.

      { 1, 0, "Marsaglia-MultiCarry",   2,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 64
  An enumerated type is mixed with another type.

      { 1, 0, "Marsaglia-MultiCarry",   2,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 65
  An enumerated type is mixed with another type.

      { 2, 0, "Super-Duper",            2,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 65
  An enumerated type is mixed with another type.

      { 2, 0, "Super-Duper",            2,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 66
  An enumerated type is mixed with another type.

      { 3, 0, "Mersenne-Twister",           1+624,      dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 66
  An enumerated type is mixed with another type.

      { 3, 0, "Mersenne-Twister",           1+624,      dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 67
  An enumerated type is mixed with another type.

      { 4, 0, "Knuth-TAOCP",          1+100,    dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 67
  An enumerated type is mixed with another type.

      { 4, 0, "Knuth-TAOCP",          1+100,    dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 68
  An enumerated type is mixed with another type.

      { 5, 0, "User-supplied",            0,    dummy},
        ^

cc-1185 c89: WARNING File = RNG.c, Line = 68
  An enumerated type is mixed with another type.

      { 5, 0, "User-supplied",            0,    dummy},
           ^

cc-1185 c89: WARNING File = RNG.c, Line = 264
  An enumerated type is mixed with another type.

        newRNG = tmp % 100;
               ^

cc-1185 c89: WARNING File = RNG.c, Line = 265
  An enumerated type is mixed with another type.

        newN01 = tmp / 100;
               ^

cc-1185 c89: WARNING File = RNG.c, Line = 382
  An enumerated type is mixed with another type.

        RNGkind(asInteger(rng));
                ^

cc-1185 c89: WARNING File = RNG.c, Line = 385
  An enumerated type is mixed with another type.

        Norm_kind(asInteger(norm));
                  ^

cc-1185 c89: WARNING File = RNG.c, Line = 404
  An enumerated type is mixed with another type.

        kind = asInteger(skind);
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c arithmetic.c -o arithmetic.o
cc-1185 c89: WARNING File = arithmetic.c, Line = 505
  An enumerated type is mixed with another type.

        x = complex_binary(PRIMVAL(op), x, y);
                           ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 511
  An enumerated type is mixed with another type.

            x = real_binary(PRIMVAL(op), x, y);
                            ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 514
  An enumerated type is mixed with another type.

            x = integer_binary(PRIMVAL(op), x, y);
                               ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 553
  An enumerated type is mixed with another type.

        return integer_unary(PRIMVAL(op), s1);
                             ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 555
  An enumerated type is mixed with another type.

        return real_unary(PRIMVAL(op), s1);
                          ^

cc-1185 c89: WARNING File = arithmetic.c, Line = 557
  An enumerated type is mixed with another type.

        return complex_unary(PRIMVAL(op), s1);
                             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c array.c -o array.o
cc-1185 c89: WARNING File = array.c, Line = 98
  An enumerated type is mixed with another type.

        copyMatrix(snr, vals, byrow);
                              ^

cc-1185 c89: WARNING File = array.c, Line = 100
  An enumerated type is mixed with another type.

        copyListMatrix(snr, vals, byrow);
                                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c bind.c -o bind.o
cc-1185 c89: WARNING File = bind.c, Line = 496
  An enumerated type is mixed with another type.

        if (n != R_NilValue && pmatch(R_RecursiveSymbol, n, 1)) {
                                                            ^

cc-1185 c89: WARNING File = bind.c, Line = 505
  An enumerated type is mixed with another type.

        else if (n != R_NilValue &&  pmatch(R_UseNamesSymbol, n, 1)) {
                                                                 ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c builtin.c -o builtin.o
cc-1185 c89: WARNING File = builtin.c, Line = 573
  An enumerated type is mixed with another type.

            if (TAG(y) != R_NilValue && pmatch(STRING_ELT(x, 0), TAG(y), 1)) {
                                                                         ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c character.c -o character.o
cc-1552 c89: WARNING File = character.c, Line = 368
  The variable "uclass" is set but never used.

      int i, len, minlen, uclass;
                          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c coerce.c -o coerce.o
cc-1185 c89: WARNING File = coerce.c, Line = 703
  An enumerated type is mixed with another type.

                SET_STRING_ELT(rval, i, STRING_ELT(deparse1(CAR(vp), 0), 0));
                                        ^

cc-1185 c89: WARNING File = coerce.c, Line = 776
  An enumerated type is mixed with another type.

                               STRING_ELT(deparse1(VECTOR_ELT(v, i), 0), 0));
                               ^

cc-1185 c89: WARNING File = coerce.c, Line = 902
  An enumerated type is mixed with another type.

        x = install(CHAR(STRING_ELT(deparse1(x, 1), 0)));
                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c connections.c -o connections.o
cc-1185 c89: WARNING File = connections.c, Line = 127
  An enumerated type is mixed with another type.

      con->canwrite = (con->mode[0] == 'w' || con->mode[0] == 'a');
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 128
  An enumerated type is mixed with another type.

      con->canread = !con->canwrite;
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 291
  An enumerated type is mixed with another type.

      con->canwrite = (con->mode[0] == 'w');
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 292
  An enumerated type is mixed with another type.

      con->canread = !con->canwrite;
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 494
  An enumerated type is mixed with another type.

      new->canread = (strcmp(mode, "r") == 0);
                   ^

cc-1185 c89: WARNING File = connections.c, Line = 495
  An enumerated type is mixed with another type.

      new->canwrite = (strcmp(mode, "w") == 0);
                    ^

cc-1185 c89: WARNING File = connections.c, Line = 772
  An enumerated type is mixed with another type.

            con->incomplete = strlen(this->lastline) > 0;
                            ^

cc-1552 c89: WARNING File = connections.c, Line = 855
  The variable "con" is set but never used.

      Rconnection con = NULL;
                  ^

cc-1185 c89: WARNING File = connections.c, Line = 910
  An enumerated type is mixed with another type.

      con->blocking = block;
                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devPS.c -o devPS.o
cc-1185 c89: WARNING File = devPS.c, Line = 978
  An enumerated type is mixed with another type.

      dd->dp.canResizePlot = 0;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 979
  An enumerated type is mixed with another type.

      dd->dp.canChangeFont = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 980
  An enumerated type is mixed with another type.

      dd->dp.canRotateText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 981
  An enumerated type is mixed with another type.

      dd->dp.canResizeText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 982
  An enumerated type is mixed with another type.

      dd->dp.canClip = 1;
                     ^

cc-1552 c89: WARNING File = devPS.c, Line = 823
  The variable "setfill" is set but never used.

      rcolor setbg, setfg, setfill;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1328
  An enumerated type is mixed with another type.

        GConvert(&x0, &y0, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1329
  An enumerated type is mixed with another type.

        GConvert(&x1, &y1, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1356
  An enumerated type is mixed with another type.

        GConvert(&x, &y, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1367
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1368
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1405
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1410
  An enumerated type is mixed with another type.

            GConvert(&xx, &yy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1430
  An enumerated type is mixed with another type.

      GConvert(&xx, &yy, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1435
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1446
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devPS.c, Line = 1662
  An enumerated type is mixed with another type.

        return 0;
               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1788
  An enumerated type is mixed with another type.

      dd->dp.canResizePlot = 0;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1789
  An enumerated type is mixed with another type.

      dd->dp.canChangeFont = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1790
  An enumerated type is mixed with another type.

      dd->dp.canRotateText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1791
  An enumerated type is mixed with another type.

      dd->dp.canResizeText = 1;
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 1792
  An enumerated type is mixed with another type.

      dd->dp.canClip = 0;
                     ^

cc-1185 c89: WARNING File = devPS.c, Line = 1802
  An enumerated type is mixed with another type.

        return 0;
               ^

cc-1185 c89: WARNING File = devPS.c, Line = 1826
  An enumerated type is mixed with another type.

      return 1;
             ^

cc-1185 c89: WARNING File = devPS.c, Line = 1976
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd); XFconvert(&x0, &y0, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 1977
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd); XFconvert(&x1, &y1, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2004
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd); XFconvert(&x, &y, pd);
                       ^

cc-1185 c89: WARNING File = devPS.c, Line = 2023
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd); XFconvert(&x1, &y1, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2024
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd); XFconvert(&x2, &y2, pd);
                         ^

cc-1185 c89: WARNING File = devPS.c, Line = 2058
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd); XFconvert(&xx, &yy, pd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 2080
  An enumerated type is mixed with another type.

        GConvert(&xx, &yy, coords, DEVICE, dd); XFconvert(&xx, &yy, pd);
                           ^

cc-1185 c89: WARNING File = devPS.c, Line = 2101
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd); XFconvert(&x, &y, pd);
                       ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devPicTeX.c -o devPicTeX.o
cc-1185 c89: WARNING File = devPicTeX.c, Line = 409
  An enumerated type is mixed with another type.

        GConvert(&x1, &y1, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 410
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 437
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 441
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 502
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 519
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 523
  An enumerated type is mixed with another type.

        GConvert(&x2, &y2, coords, DEVICE, dd);
                           ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 533
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devPicTeX.c, Line = 585
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c deparse.c -o deparse.o
cc-1185 c89: WARNING File = deparse.c, Line = 153
  An enumerated type is mixed with another type.

      ca1 = deparse1(ca1, 0);
                          ^

cc-1185 c89: WARNING File = deparse.c, Line = 222
  An enumerated type is mixed with another type.

      tval = deparse1(tval, 0);
                            ^

cc-1185 c89: WARNING File = deparse.c, Line = 229
  An enumerated type is mixed with another type.

      wasopen = 1;
              ^

cc-1185 c89: WARNING File = deparse.c, Line = 274
  An enumerated type is mixed with another type.

            tval = deparse1(CAR(o), 0);
                                    ^

cc-1185 c89: WARNING File = deparse.c, Line = 289
  An enumerated type is mixed with another type.

            tval = deparse1(CAR(o), 0);
                                    ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c devices.c -o devices.o
cc-1185 c89: WARNING File = devices.c, Line = 107
  An enumerated type is mixed with another type.

                           width, height, (double)horizontal, ps, onefile,
                                          ^

cc-1185 c89: WARNING File = devices.c, Line = 107
  An enumerated type is mixed with another type.

                           width, height, (double)horizontal, ps, onefile,
                                                                  ^

cc-1185 c89: WARNING File = devices.c, Line = 108
  An enumerated type is mixed with another type.

                           pagecentre, printit, cmd)) {
                           ^

cc-1185 c89: WARNING File = devices.c, Line = 108
  An enumerated type is mixed with another type.

                           pagecentre, printit, cmd)) {
                                       ^

cc-1185 c89: WARNING File = devices.c, Line = 145
  An enumerated type is mixed with another type.

      debug = asLogical(CAR(args));    args = CDR(args);
            ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                             ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                                                     ^

cc-1185 c89: WARNING File = devices.c, Line = 215
  An enumerated type is mixed with another type.

                             (double)horizontal, ps, onefile, pagecentre)) {
                                                              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c dotcode.c -o dotcode.o
cc-1552 c89: WARNING File = dotcode.c, Line = 369
  The variable "fun" is set but never used.

      DL_FUNC fun;
              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c dstruct.c -o dstruct.o
cc-1552 c89: WARNING File = dstruct.c, Line = 111
  The variable "rval" is set but never used.

      int rval;
          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c errors.c -o errors.o
cc-1185 c89: WARNING File = errors.c, Line = 197
  An enumerated type is mixed with another type.

            dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                    ^

cc-1552 c89: WARNING File = errors.c, Line = 161
  The variable "slen" is set but never used.

      int w, slen;
             ^

cc-1185 c89: WARNING File = errors.c, Line = 238
  An enumerated type is mixed with another type.

                CHAR(STRING_ELT(deparse1(VECTOR_ELT(R_Warnings, 0),0), 0)));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 248
  An enumerated type is mixed with another type.

                   CHAR(STRING_ELT(deparse1(VECTOR_ELT(R_Warnings,i), 0), 0)));
                   ^

cc-1185 c89: WARNING File = errors.c, Line = 291
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 407
  An enumerated type is mixed with another type.

            SETCAR(t, deparse1(c->call, 0));
                                        ^

cc-1185 c89: WARNING File = errors.c, Line = 534
  An enumerated type is mixed with another type.

      { ERROR_NUMARGS,          "invalid number of arguments"           },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 535
  An enumerated type is mixed with another type.

      { ERROR_ARGTYPE,          "invalid argument type"                 },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 537
  An enumerated type is mixed with another type.

      { ERROR_TSVEC_MISMATCH,   "time-series/vector length mismatch"    },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 538
  An enumerated type is mixed with another type.

      { ERROR_INCOMPAT_ARGS,    "incompatible arguments"                },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 540
  An enumerated type is mixed with another type.

      { ERROR_UNIMPLEMENTED,    "unimplemented feature in %s"           },
        ^

cc-1185 c89: WARNING File = errors.c, Line = 541
  An enumerated type is mixed with another type.

      { ERROR_UNKNOWN,          "unknown error (report this!)"          }
        ^

cc-1185 c89: WARNING File = errors.c, Line = 565
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

cc-1185 c89: WARNING File = errors.c, Line = 591
  An enumerated type is mixed with another type.

        dcall = CHAR(STRING_ELT(deparse1(call, 0), 0));
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c eval.c -o eval.o
cc-1552 c89: WARNING File = eval.c, Line = 372
  The variable "i" is set but never used.

      int i;
          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c fourier.c -o fourier.o
cc-1185 c89: WARNING File = fourier.c, Line = 187
  An enumerated type is mixed with another type.

      return n == 1;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c g_cntrlify.c -o g_cntrlify.o
cc-1552 c89: WARNING File = g_cntrlify.c, Line = 88
  The variable "previous_raw_fontnum" is set but never used.

    int previous_raw_fontnum;   /* implement depth-1 stack */
        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c g_alab_her.c -o g_alab_her.o
cc-1185 c89: WARNING File = g_alab_her.c, Line = 91
  An enumerated type is mixed with another type.

                 GConvertXUnits(HERSHEY_X_UNITS_TO_USER_UNITS (deltax),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 92
  An enumerated type is mixed with another type.

                                g_unit, INCHES, dd),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 93
  An enumerated type is mixed with another type.

                 GConvertYUnits(HERSHEY_Y_UNITS_TO_USER_UNITS (deltay),
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 94
  An enumerated type is mixed with another type.

                                g_unit, INCHES, dd));
                                ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 180
  An enumerated type is mixed with another type.

      return( HERSHEY_Y_UNITS_TO_USER_UNITS(HERSHEY_LARGE_CAPHEIGHT) );
              ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 247
  An enumerated type is mixed with another type.

    GConvert(&currX, &currY, g_unit, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 329
  An enumerated type is mixed with another type.

                    GConvertXUnits(x_offset * label_width, g_unit, INCHES, dd),
                                                           ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 330
  An enumerated type is mixed with another type.

                    GConvertYUnits(y_offset * label_height, g_unit, INCHES, dd));
                                                            ^

cc-1552 c89: WARNING File = g_alab_her.c, Line = 226
  The variable "x_displacement" is set but never used.

    double x_displacement;
           ^

cc-1185 c89: WARNING File = g_alab_her.c, Line = 547
  An enumerated type is mixed with another type.

    return HERSHEY_X_UNITS_TO_USER_UNITS (width);
           ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c graphics.c -o graphics.o
cc-1185 c89: WARNING File = graphics.c, Line = 121
  An enumerated type is mixed with another type.

      default:  return 0;
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 1280
  An enumerated type is mixed with another type.

      return allCmWidths(dd) && allCmHeights(dd);
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1285
  An enumerated type is mixed with another type.

      return noCmWidths(dd) && noCmHeights(dd);
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1693
  An enumerated type is mixed with another type.

      return ((dd->gp.fig[0] > 0-FLT_EPSILON) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1703
  An enumerated type is mixed with another type.

      return ((dd->gp.fig[0] < dd->gp.fig[1]) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1711
  An enumerated type is mixed with another type.

      return ((dd->gp.plt[0] > 0-FLT_EPSILON) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1721
  An enumerated type is mixed with another type.

      return ((dd->gp.plt[0] < dd->gp.plt[1]) &&
             ^

cc-1185 c89: WARNING File = graphics.c, Line = 1832
  An enumerated type is mixed with another type.

      Rboolean swap, is_xaxis = (axis == 1 || axis == 3);
                                ^

cc-1185 c89: WARNING File = graphics.c, Line = 1921
  An enumerated type is mixed with another type.

      swap = min > max;
           ^

cc-1185 c89: WARNING File = graphics.c, Line = 1982
  An enumerated type is mixed with another type.

      Rboolean is_xaxis = (axis == 1 || axis == 3);
                          ^

cc-1185 c89: WARNING File = graphics.c, Line = 2263
  An enumerated type is mixed with another type.

      dd->gp.ann = annsave;
                 ^

cc-1185 c89: WARNING File = graphics.c, Line = 2373
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NPC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2374
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NPC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2377
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NFC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2378
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NFC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2381
  An enumerated type is mixed with another type.

        GConvert(x1, y1, NDC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2382
  An enumerated type is mixed with another type.

        GConvert(x2, y2, NDC, coords, dd);
                              ^

cc-1185 c89: WARNING File = graphics.c, Line = 2630
  An enumerated type is mixed with another type.

        GConvert(x, y, DEVICE, coords, dd);
                               ^

cc-1185 c89: WARNING File = graphics.c, Line = 2770
  An enumerated type is mixed with another type.

                clipPoint (b + 1, ix, iy, xout, yout, cnt, store,
                           ^

cc-1185 c89: WARNING File = graphics.c, Line = 2789
  An enumerated type is mixed with another type.

            clipPoint (b + 1, x, y, xout, yout, cnt, store, clip, cs);
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 2812
  An enumerated type is mixed with another type.

                clipPoint (b + 1, ix, iy, xout, yout, cnt, store, clip, cs);
                           ^

cc-1185 c89: WARNING File = graphics.c, Line = 2986
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 3054
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3118
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3119
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3349
  An enumerated type is mixed with another type.

        GConvert(&x, &y, coords, INCHES, dd);
                         ^

cc-1185 c89: WARNING File = graphics.c, Line = 3478
  An enumerated type is mixed with another type.

      GConvert(&xfromInch, &yfromInch, coords, INCHES, dd);
                                       ^

cc-1185 c89: WARNING File = graphics.c, Line = 3479
  An enumerated type is mixed with another type.

      GConvert(&xtoInch, &ytoInch, coords, INCHES, dd);
                                   ^

cc-1185 c89: WARNING File = graphics.c, Line = 3699
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3715
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3727
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3739
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3746
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3753
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3763
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3775
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3784
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3794
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3807
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3814
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3831
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3841
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3848
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3859
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3875
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3888
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3916
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3923
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3934
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1185 c89: WARNING File = graphics.c, Line = 3947
  An enumerated type is mixed with another type.

            GConvert(&x, &y, coords, INCHES, dd);
                             ^

cc-1552 c89: WARNING File = graphics.c, Line = 5189
  The variable "s" is set but never used.

      SEXP s, t;
           ^

cc-1552 c89: WARNING File = graphics.c, Line = 4138
  The variable "ColorDataBaseSize" is set but never used.

  static int ColorDataBaseSize;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c main.c -o main.o
cc-1185 c89: WARNING File = main.c, Line = 671
  An enumerated type is mixed with another type.

      R_CleanUp(ask, status, runLast);
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c match.c -o match.o
cc-1185 c89: WARNING File = match.c, Line = 119
  An enumerated type is mixed with another type.

           psmatch(tag, CHAR(PRINTNAME(TAG(*list))), 0)) {
                                                     ^

cc-1185 c89: WARNING File = match.c, Line = 129
  An enumerated type is mixed with another type.

          psmatch(tag, CHAR(PRINTNAME(TAG(next))), 0)) {
                                                   ^

cc-1185 c89: WARNING File = match.c, Line = 189
  An enumerated type is mixed with another type.

                if (TAG(b) != R_NilValue && pmatch(TAG(f), TAG(b), 1)) {
                                                                   ^

cc-1185 c89: WARNING File = match.c, Line = 226
  An enumerated type is mixed with another type.

                        pmatch(TAG(f), TAG(b), seendots)) {
                                               ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c memory.c -o memory.o
cc-1185 c89: WARNING File = memory.c, Line = 831
  An enumerated type is mixed with another type.

      return TYPEOF(fun) == CHARSXP;
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c model.c -o model.o
cc-1552 c89: WARNING File = model.c, Line = 280
  The variable "tmp" is set but never used.

      unsigned tmp;
               ^

cc-1185 c89: WARNING File = model.c, Line = 909
  An enumerated type is mixed with another type.

            SET_STRING_ELT(varnames, i++, STRING_ELT(deparse1line(CAR(v), 0), 0));
                                          ^

cc-1552 c89: WARNING File = model.c, Line = 739
  The variable "abb" is set but never used.

      SEXP specials, t, abb, data;
                        ^

cc-1552 c89: WARNING File = model.c, Line = 1483
  The variable "v" is set but never used.

      SEXP expr, factors, terms, v, vars, vnames, assign;
                                 ^

cc-1552 c89: WARNING File = model.c, Line = 46
  The variable "identSymbol" is set but never used.

  static SEXP identSymbol = NULL;
              ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c names.c -o names.o
cc-1185 c89: WARNING File = names.c, Line = 747
  An enumerated type is mixed with another type.

  {NULL,                NULL,           0,      0,      0,      0},
                                                                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c objects.c -o objects.o
cc-1185 c89: WARNING File = objects.c, Line = 50
  An enumerated type is mixed with another type.

            if (TAG(b) != R_NilValue && pmatch(tag, TAG(b), 1)) {
                                                            ^

cc-1185 c89: WARNING File = objects.c, Line = 60
  An enumerated type is mixed with another type.

                if (TAG(b) != R_NilValue && pmatch(tag, TAG(b), 0)) {
                                                                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c optim.c -o optim.o
cc-1185 c89: WARNING File = optim.c, Line = 514
  An enumerated type is mixed with another type.

            accpoint = FALSE;
                     ^

cc-1185 c89: WARNING File = optim.c, Line = 525
  An enumerated type is mixed with another type.

                    accpoint = R_FINITE(f) &&
                             ^

cc-1185 c89: WARNING File = optim.c, Line = 532
  An enumerated type is mixed with another type.

            enough = (f > abstol) &&
                   ^

cc-1185 c89: WARNING File = optim.c, Line = 610
  An enumerated type is mixed with another type.

      Rboolean calcvert, shrinkfail = FALSE;
                                      ^

cc-1185 c89: WARNING File = optim.c, Line = 662
  An enumerated type is mixed with another type.

        calcvert = TRUE;
                 ^

cc-1185 c89: WARNING File = optim.c, Line = 663
  An enumerated type is mixed with another type.

        shrinkfail = FALSE;
                   ^

cc-1185 c89: WARNING File = optim.c, Line = 676
  An enumerated type is mixed with another type.

                calcvert = FALSE;
                         ^

cc-1185 c89: WARNING File = optim.c, Line = 757
  An enumerated type is mixed with another type.

                            calcvert = TRUE;
                                     ^

cc-1185 c89: WARNING File = optim.c, Line = 768
  An enumerated type is mixed with another type.

                                shrinkfail = FALSE;
                                           ^

cc-1185 c89: WARNING File = optim.c, Line = 773
  An enumerated type is mixed with another type.

                                shrinkfail = TRUE;
                                           ^

cc-1552 c89: WARNING File = optim.c, Line = 618
  The variable "VN" is set but never used.

      double VH, VL, VN, VR;
                     ^

cc-1185 c89: WARNING File = optim.c, Line = 901
  An enumerated type is mixed with another type.

                    accpoint = FALSE;
                             ^

cc-1185 c89: WARNING File = optim.c, Line = 912
  An enumerated type is mixed with another type.

                            accpoint = (R_FINITE(f) &&
                                     ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c options.c -o options.o
cc-1185 c89: WARNING File = options.c, Line = 249
  An enumerated type is mixed with another type.

      R_KeepSource = (p && (strcmp(p, "yes") == 0)) ? 1 : 0;
                   ^

cc-1185 c89: WARNING File = options.c, Line = 371
  An enumerated type is mixed with another type.

                R_KeepSource = k;
                             ^

cc-1185 c89: WARNING File = options.c, Line = 433
  An enumerated type is mixed with another type.

                R_Slave = !k;
                        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c par.c -o par.o
cc-1185 c89: WARNING File = par.c, Line = 151
  An enumerated type is mixed with another type.

        dd->dp.ann = dd->gp.ann = (ix != 0);/* NA |-> TRUE */
                                ^

cc-1185 c89: WARNING File = par.c, Line = 155
  An enumerated type is mixed with another type.

        dd->dp.ask = dd->gp.ask = (ix == 1);/* NA |-> FALSE */
                                ^

cc-1185 c89: WARNING File = par.c, Line = 263
  An enumerated type is mixed with another type.

            dd->gp.defaultFigure = dd->dp.defaultFigure = 0;
                                                        ^

cc-1185 c89: WARNING File = par.c, Line = 286
  An enumerated type is mixed with another type.

        dd->gp.defaultFigure = dd->dp.defaultFigure = 0;
                                                    ^

cc-1185 c89: WARNING File = par.c, Line = 493
  An enumerated type is mixed with another type.

        dd->gp.new = dd->dp.new = 1;
                                ^

cc-1185 c89: WARNING File = par.c, Line = 530
  An enumerated type is mixed with another type.

        dd->dp.new = dd->gp.new = (ix != 0);
                                ^

cc-1185 c89: WARNING File = par.c, Line = 762
  An enumerated type is mixed with another type.

        dd->dp.xlog = dd->gp.xlog = (ix != 0);
                                  ^

cc-1185 c89: WARNING File = par.c, Line = 802
  An enumerated type is mixed with another type.

        dd->dp.ylog = dd->gp.ylog = (ix != 0);
                                  ^

cc-1185 c89: WARNING File = par.c, Line = 826
  An enumerated type is mixed with another type.

        dd->gp.ann = (ix != 0);
                   ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plot.c -o plot.o
cc-1185 c89: WARNING File = plot.c, Line = 442
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1552 c89: WARNING File = plot.c, Line = 611
  The variable "save_digits" is set but never used.

      int save_digits, i, n, w, d, e, wi, di, ei;
          ^

cc-1185 c89: WARNING File = plot.c, Line = 871
  An enumerated type is mixed with another type.

      doticks = asLogical(CAR(args));
              ^

cc-1185 c89: WARNING File = plot.c, Line = 1029
  An enumerated type is mixed with another type.

                axis_base = GConvertY(0.0, outer, NFC, dd)
                                           ^

cc-1185 c89: WARNING File = plot.c, Line = 1040
  An enumerated type is mixed with another type.

                axis_base =  GConvertY(1.0, outer, NFC, dd)
                                            ^

cc-1185 c89: WARNING File = plot.c, Line = 1129
  An enumerated type is mixed with another type.

                axis_base =  GConvertX(0.0, outer, NFC, dd)
                                            ^

cc-1185 c89: WARNING File = plot.c, Line = 1140
  An enumerated type is mixed with another type.

                axis_base =  GConvertX(1.0, outer, NFC, dd)
                                            ^

cc-1552 c89: WARNING File = plot.c, Line = 810
  The variable "col" is set but never used.

      int col, fg, font;
          ^

cc-1552 c89: WARNING File = plot.c, Line = 814
  The variable "vectorFonts" is set but never used.

      Rboolean vectorFonts = FALSE;
               ^

cc-1552 c89: WARNING File = plot.c, Line = 1769
  The variable "nborder" is set but never used.

      int ncol, nborder, nlty, xpd, i, start=0;
                ^

cc-1552 c89: WARNING File = plot.c, Line = 1769
  The variable "nlty" is set but never used.

      int ncol, nborder, nlty, xpd, i, start=0;
                         ^

cc-1552 c89: WARNING File = plot.c, Line = 2620
  The variable "fg" is set but never used.

      int which, col, fg;
                      ^

cc-1185 c89: WARNING File = plot.c, Line = 2932
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1185 c89: WARNING File = plot.c, Line = 2968
  An enumerated type is mixed with another type.

      dd->dp.defaultPlot = dd->gp.defaultPlot = 1;
                                              ^

cc-1552 c89: WARNING File = plot.c, Line = 2911
  The variable "save_mUnits" is set but never used.

      int save_mUnits, save_defaultPlot;
          ^

cc-1552 c89: WARNING File = plot.c, Line = 2911
  The variable "save_defaultPlot" is set but never used.

      int save_mUnits, save_defaultPlot;
                       ^

cc-1552 c89: WARNING File = plot.c, Line = 3316
  The variable "ncol" is set but never used.

      int ncol;
          ^

cc-1185 c89: WARNING File = plot.c, Line = 3359
  An enumerated type is mixed with another type.

        dd->gp.ask = 1;
                   ^

cc-1185 c89: WARNING File = plot.c, Line = 3369
  An enumerated type is mixed with another type.

        dd->gp.ask = ask;
                   ^

cc-1185 c89: WARNING File = plot.c, Line = 3512
  An enumerated type is mixed with another type.

                GConvert(&xx, &yy, USER, units, dd);
                                         ^

cc-1185 c89: WARNING File = plot.c, Line = 3515
  An enumerated type is mixed with another type.

                    rx = GConvertXUnits(0.5 * p0, INCHES, units, dd);
                                                          ^

cc-1185 c89: WARNING File = plot.c, Line = 3516
  An enumerated type is mixed with another type.

                    ry = GConvertYUnits(0.5 * p0, INCHES, units, dd);
                                                          ^

cc-1185 c89: WARNING File = plot.c, Line = 3519
  An enumerated type is mixed with another type.

                    rx = GConvertXUnits(0.5 * p0, USER, units, dd);
                                                        ^

cc-1185 c89: WARNING File = plot.c, Line = 3520
  An enumerated type is mixed with another type.

                    ry = GConvertYUnits(0.5 * p0, USER, units, dd);
                                                        ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plot3d.c -o plot3d.o
cc-1552 c89: WARNING File = plot3d.c, Line = 193
  The variable "q1" is set but never used.

      double Ax, Bx, Ay, By, ax, ay, bx, by, q1, q2;
                                             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 193
  The variable "q2" is set but never used.

      double Ax, Bx, Ay, By, ax, ay, bx, by, q1, q2;
                                                 ^

cc-1552 c89: WARNING File = plot3d.c, Line = 479
  The variable "ns2" is set but never used.

      int i, ii, j, jj, k, l, m, nacode, ns, ns2, dir;
                                             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 484
  The variable "deltaXC" is set but never used.

      double dXC, dYC, deltaXC, deltaYC;
                       ^

cc-1552 c89: WARNING File = plot3d.c, Line = 484
  The variable "deltaYC" is set but never used.

      double dXC, dYC, deltaXC, deltaYC;
                                ^

cc-1552 c89: WARNING File = plot3d.c, Line = 487
  The variable "sum" is set but never used.

      double squareSum, sum;
                        ^

cc-1552 c89: WARNING File = plot3d.c, Line = 490
  The variable "zeroCount" is set but never used.

      int zeroCount;
          ^

cc-1552 c89: WARNING File = plot3d.c, Line = 492
  The variable "avg" is set but never used.

      double avg;
             ^

cc-1552 c89: WARNING File = plot3d.c, Line = 1328
  The variable "nz" is set but never used.

      int i, j, k, npt, nx, ny, nz, nc, ncol, colsave, xpdsave;
                                ^

cc-1185 c89: WARNING File = plot3d.c, Line = 2201
  An enumerated type is mixed with another type.

      dd = GNewPlot(GRecording(call));
                    ^

cc-1552 c89: WARNING File = plot3d.c, Line = 47
  The variable "gcall" is set but never used.

  static SEXP gcall;
              ^

cc-1552 c89: WARNING File = plot3d.c, Line = 313
  The variable "ctr_xtol" is set but never used.

  static double ctr_xtol;
                ^

cc-1552 c89: WARNING File = plot3d.c, Line = 314
  The variable "ctr_ytol" is set but never used.

  static double ctr_ytol;
                ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c plotmath.c -o plotmath.o
cc-1185 c89: WARNING File = plotmath.c, Line = 916
  An enumerated type is mixed with another type.

      return MathDevice->gp.font;
             ^

cc-1185 c89: WARNING File = plotmath.c, Line = 921
  An enumerated type is mixed with another type.

      FontType prevfont = MathDevice->gp.font;
                          ^

cc-1552 c89: WARNING File = plotmath.c, Line = 1380
  The variable "s5" is set but never used.

      double v, s5, s16;
                ^

cc-1551 c89: WARNING File = plotmath.c, Line = 1926
  The variable "ansBBox" is used before its value is set.

        return ansBBox;/*never reached*/
               ^

cc-1552 c89: WARNING File = plotmath.c, Line = 2275
  The variable "radDepth" is set but never used.

      double radWidth, radHeight, radDepth;
                                  ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2543
  An enumerated type is mixed with another type.

      SetFont(prevfont);
              ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2564
  An enumerated type is mixed with another type.

      SetFont(prevfont);
              ^

cc-1185 c89: WARNING File = plotmath.c, Line = 2907
  An enumerated type is mixed with another type.

      GConvert(&ReferenceX, &ReferenceY, coords, INCHES, dd);
                                         ^

cc-1552 c89: WARNING File = plotmath.c, Line = 38
  The variable "BoxColor" is set but never used.

  static unsigned int BoxColor;
                      ^

cc-1552 c89: WARNING File = plotmath.c, Line = 39
  The variable "TextColor" is set but never used.

  static unsigned int TextColor;
                      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c print.c -o print.o
cc-1552 c89: WARNING File = print.c, Line = 81
  The variable "append_" is set but never used.

      int  append_, ifile, closeOnExit;
           ^

cc-1185 c89: WARNING File = print.c, Line = 446
  An enumerated type is mixed with another type.

      u = deparse1(s, 0);
                      ^

cc-1185 c89: WARNING File = print.c, Line = 487
  An enumerated type is mixed with another type.

            t = deparse1(s, 0);
                            ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c printarray.c -o printarray.o
cc-1552 c89: WARNING File = printarray.c, Line = 448
  The variable "ii" is set but never used.

      SEXP ii, nn, dn, dnn;
           ^

cc-1552 c89: WARNING File = printarray.c, Line = 448
  The variable "nn" is set but never used.

      SEXP ii, nn, dn, dnn;
               ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c regex.c -o regex.o
cc-1552 c89: WARNING File = regex.c, Line = 4922
  The variable "pdummy" is set but never used.

              unsigned char *pdummy;
                             ^

cc-1552 c89: WARNING File = regex.c, Line = 4923
  The variable "sdummy" is set but never used.

              const char *sdummy;
                          ^

cc-1548 c89: WARNING File = regex.c, Line = 5245
  The transfer of control bypasses...

            ... the initialization of variable "same_str_p" (declared at line
                      4130).
      goto restore_best_regs;
      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c relop.c -o relop.o
cc-1185 c89: WARNING File = relop.c, Line = 59
  An enumerated type is mixed with another type.

        SEXP ans = real_relop(PRIMVAL(op), x, y);
                              ^

cc-1185 c89: WARNING File = relop.c, Line = 67
  An enumerated type is mixed with another type.

        SET_STRING_ELT(tmp, 0, (iS) ? PRINTNAME(x) : deparse1(x, 0));
                                                                 ^

cc-1185 c89: WARNING File = relop.c, Line = 74
  An enumerated type is mixed with another type.

        SET_STRING_ELT(tmp, 0, (iS) ? PRINTNAME(y) : deparse1(y, 0));
                                                                 ^

cc-1185 c89: WARNING File = relop.c, Line = 123
  An enumerated type is mixed with another type.

            mismatch = ((nx > ny) ? nx % ny : ny % nx) != 0;
                     ^

cc-1185 c89: WARNING File = relop.c, Line = 155
  An enumerated type is mixed with another type.

        x = string_relop(PRIMVAL(op), x, y);
                         ^

cc-1185 c89: WARNING File = relop.c, Line = 160
  An enumerated type is mixed with another type.

        x = complex_relop(PRIMVAL(op), x, y);
                          ^

cc-1185 c89: WARNING File = relop.c, Line = 165
  An enumerated type is mixed with another type.

        x = real_relop(PRIMVAL(op), x, y);
                       ^

cc-1185 c89: WARNING File = relop.c, Line = 168
  An enumerated type is mixed with another type.

        x = integer_relop(PRIMVAL(op), x, y);
                          ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c saveload.c -o saveload.o
cc-1552 c89: WARNING File = saveload.c, Line = 1600
  The variable "d1234" is set but never used.

      int d1, d2, d3, d4, d1234;
                          ^

cc-1552 c89: WARNING File = saveload.c, Line = 44
  The variable "NVSize" is set but never used.

  static int NVSize;            /* Number of vector cells */
             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c source.c -o source.o
cc-1552 c89: WARNING File = source.c, Line = 45
  The variable "pstacktop" is set but never used.

      int ifile, num, pstacktop, status;
                      ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c subassign.c -o subassign.o
cc-1185 c89: WARNING File = subassign.c, Line = 157
  An enumerated type is mixed with another type.

      Rboolean redo_which =  (level == 1);
                             ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c unique.c -o unique.o
cc-1185 c89: WARNING File = unique.c, Line = 625
  An enumerated type is mixed with another type.

        b = deparse1(funcall, 1);
                              ^

cc-1185 c89: WARNING File = unique.c, Line = 655
  An enumerated type is mixed with another type.

        b = deparse1(b, 1);
                        ^

cc-1185 c89: WARNING File = unique.c, Line = 663
  An enumerated type is mixed with another type.

        b = deparse1(CADDR(args), 1);
                                  ^

------------------------------------------------------------------------
c89 -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON  -g -c util.c -o util.o
cc-1185 c89: WARNING File = util.c, Line = 235
  An enumerated type is mixed with another type.

      return isString(x) && LENGTH(x) > 0 && !isNull(STRING_ELT(x, 0));
             ^

cc-1185 c89: WARNING File = util.c, Line = 241
  An enumerated type is mixed with another type.

      return isValidString(x) && CHAR(STRING_ELT(x, 0))[0];
             ^

cc-1185 c89: WARNING File = util.c, Line = 246
  An enumerated type is mixed with another type.

      return TYPEOF(s) == SYMSXP;
             ^

cc-1185 c89: WARNING File = util.c, Line = 263
  An enumerated type is mixed with another type.

      return (s == R_NilValue ||
             ^

cc-1185 c89: WARNING File = util.c, Line = 270
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == CLOSXP ||
             ^

cc-1185 c89: WARNING File = util.c, Line = 278
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == LISTSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 284
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == VECSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 358
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == NILSXP || TYPEOF(s) == ENVSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 364
  An enumerated type is mixed with another type.

      return TYPEOF(s) == EXPRSXP;
             ^

cc-1185 c89: WARNING File = util.c, Line = 370
  An enumerated type is mixed with another type.

      return (s == R_NilValue || TYPEOF(s) == LANGSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 400
  An enumerated type is mixed with another type.

      return (isVector(s) && getAttrib(s, R_TspSymbol) != R_NilValue);
             ^

cc-1185 c89: WARNING File = util.c, Line = 408
  An enumerated type is mixed with another type.

        return INTEGER(x)[0] == INTEGER(x)[0] &&
               ^

cc-1185 c89: WARNING File = util.c, Line = 433
  An enumerated type is mixed with another type.

        return mode;
               ^

cc-1185 c89: WARNING File = util.c, Line = 441
  An enumerated type is mixed with another type.

        return mode;
               ^

cc-1185 c89: WARNING File = util.c, Line = 522
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == STRSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 528
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == LGLSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 534
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP && !inherits(s, "factor"));
             ^

cc-1185 c89: WARNING File = util.c, Line = 540
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == REALSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 546
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == CPLXSXP);
             ^

cc-1185 c89: WARNING File = util.c, Line = 552
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP
             ^

cc-1185 c89: WARNING File = util.c, Line = 560
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP
             ^

cc-1185 c89: WARNING File = util.c, Line = 568
  An enumerated type is mixed with another type.

      return (TYPEOF(s) == INTSXP  && inherits(s, "factor"));
             ^

cc-1185 c89: WARNING File = util.c, Line = 574
  An enumerated type is mixed with another type.

      return OBJECT(s);/* really `1-bit unsigned int' */
             ^

cc-1185 c89: WARNING File = util.c, Line = 667
  An enumerated type is mixed with another type.

      else return CHAR(x)[0] == '\0';
                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/unix/X11
c89   -o R.bin  RNG.o apply.o arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o connections.o context.o cov.o cum.o datetime.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o g_her_glyph.o g_fontdb.o g_cntrlify.o g_alab_her.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optim.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o regex.o relop.o saveload.o scan.o seq.o size.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o xxxpr.o ../unix/libunix.a ../appl/libappl.a ../nmath/libnmath.a -lcomplib.sgimath -LANG:=f77 -L/usr/lib32/mips3/r4000 -L/usr/lib32/mips3 -L/usr/lib32 -lftn -lm  -L/usr/local/lib  -lz -ldl -lncurses -lm
ld32: WARNING 84 : /usr/lib32/libz.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/lib32/libdl.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/local/lib/libncurses.a is not used for resolving any symbol.
------------------------------------------------------------------------
c89 -I. -I../../../src/include -I../../../src/include  -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON -KPIC  -g -c dataentry.c -o dataentry.o
cc-1185 c89: WARNING File = dataentry.c, Line = 843
  An enumerated type is mixed with another type.

            Rboolean warn = !isBlankString(endp);
                            ^

cc-1552 c89: WARNING File = dataentry.c, Line = 1240
  The variable "i" is set but never used.

      int i;
          ^

cc-1552 c89: WARNING File = dataentry.c, Line = 1250
  The variable "i" is set but never used.

      int i;
          ^

cc-1552 c89: WARNING File = dataentry.c, Line = 148
  The variable "hand_cursor" is set but never used.

  static Cursor           hand_cursor;
                          ^

------------------------------------------------------------------------
c89 -I. -I../../../src/include -I../../../src/include  -I/usr/local/include -DHAVE_CONFIG_H -OPT:IEEE_NaN_inf=ON -KPIC  -g -c devX11.c -o devX11.o
cc-1552 c89: WARNING File = devX11.c, Line = 250
  The variable "imin" is set but never used.

      int i, imin;
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 417
  The variable "imin" is set but never used.

      int i, imin;
             ^

cc-1136 c89: WARNING File = devX11.c, Line = 552
  Too many arguments in function call.

            SetupPseudoColor(model);
                             ^

cc-1136 c89: WARNING File = devX11.c, Line = 561
  Too many arguments in function call.

            SetupPseudoColor(model);
                             ^

cc-1185 c89: WARNING File = devX11.c, Line = 1595
  An enumerated type is mixed with another type.

      GConvert(&x0, &y0, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1596
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1656
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1185 c89: WARNING File = devX11.c, Line = 1688
  An enumerated type is mixed with another type.

      GConvert(&x1, &y1, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1689
  An enumerated type is mixed with another type.

      GConvert(&x2, &y2, coords, DEVICE, dd);
                         ^

cc-1185 c89: WARNING File = devX11.c, Line = 1722
  An enumerated type is mixed with another type.

        GConvert(&devx, &devy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devX11.c, Line = 1766
  An enumerated type is mixed with another type.

        GConvert(&devx, &devy, coords, DEVICE, dd);
                               ^

cc-1185 c89: WARNING File = devX11.c, Line = 1771
  An enumerated type is mixed with another type.

      GConvert(&devx, &devy, coords, DEVICE, dd);
                             ^

cc-1185 c89: WARNING File = devX11.c, Line = 1814
  An enumerated type is mixed with another type.

      GConvert(&x, &y, coords, DEVICE, dd);
                       ^

cc-1552 c89: WARNING File = devX11.c, Line = 1806
  The variable "len" is set but never used.

      int len, size;
          ^

cc-1185 c89: WARNING File = devX11.c, Line = 1837
  An enumerated type is mixed with another type.

      if (xd->type > WINDOW) return 0;
                                    ^

cc-1185 c89: WARNING File = devX11.c, Line = 1865
  An enumerated type is mixed with another type.

      return (done == 1);
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "RedLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
             ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "GreenLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
                        ^

cc-1552 c89: WARNING File = devX11.c, Line = 222
  The variable "BlueLevels" is set but never used.

  static int RedLevels, GreenLevels, BlueLevels;
                                     ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library
c89 -shared  -o R_X11.so  dataentry.o devX11.o rotated.o rbitmap.o -lSM -lICE -L/usr/local/lib -lX11  -L/usr/local/lib -ljpeg -lpng -lz -L/usr/local/lib  -lz -ldl -lncurses -lm
ld32: WARNING 84 : /usr/lib32/libSM.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/lib32/libdl.so is not used for resolving any symbol.
ld32: WARNING 84 : /usr/local/lib/libncurses.a is not used for resolving any symbol.
------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/ctest/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c fexact.c -o fexact.o
cc-1185 c89: WARNING File = fexact.c, Line = 389
  An enumerated type is mixed with another type.

      nr_gt_nc =  *nrow > *ncol;
               ^

------------------------------------------------------------------------
c89 -shared  -o ctest.so ansari.o d2x2xk.o fexact.o kendall.o ks.o prho.o swilk.o -L/usr/local/lib -LANG:=f77 -L/usr/lib32/mips3/r4000 -L/usr/lib32/mips3 -L/usr/lib32 -lftn -lm
ld32: WARNING 84 : /usr/lib32/mips3/libftn.so is not used for resolving any symbol.
------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/eda/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c smooth.c -o smooth.o
cc-1185 c89: WARNING File = smooth.c, Line = 51
  An enumerated type is mixed with another type.

        chg = chg || j;
            ^

cc-1185 c89: WARNING File = smooth.c, Line = 76
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 76
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 97
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);/* =>  chg = TRUE  iff  ends changed */
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 97
  An enumerated type is mixed with another type.

      sm_DO_ENDRULE(y);/* =>  chg = TRUE  iff  ends changed */
      ^

cc-1185 c89: WARNING File = smooth.c, Line = 141
  An enumerated type is mixed with another type.

                chg = y[i] != x[i];
                    ^

cc-1185 c89: WARNING File = smooth.c, Line = 146
  An enumerated type is mixed with another type.

                chg = y[i+1] != x[i+1];
                    ^

cc-1185 c89: WARNING File = smooth.c, Line = 202
  An enumerated type is mixed with another type.

        ch2 = sm_3R(z, y, w, n, end_rule);
            ^

cc-1185 c89: WARNING File = smooth.c, Line = 203
  An enumerated type is mixed with another type.

        chg = chg || ch2;
            ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/nls/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c nls.c -o nls.o
cc-1552 c89: WARNING File = nls.c, Line = 66
  The variable "convNew" is set but never used.

      double dev, fac, minFac, tolerance, newDev, convNew;
                                                  ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/ts/src
c89 -I../../../../include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c mburg.c -o mburg.o
cc-1552 c89: WARNING File = mburg.c, Line = 222
  The variable "s_inv" is set but never used.

      Array s, s_inv, tmp, d1;
               ^

cc-1552 c89: WARNING File = mburg.c, Line = 225
  The variable "id" is set but never used.

      Array id;
            ^

------------------------------------------------------------------------
DIRECTORY: R-1.2.1/src/library/tcltk/src
c89 -I../../../../include -I/usr/local/include  -I/usr/local/include -OPT:IEEE_NaN_inf=ON  -KPIC  -g -c tcltk.c -o tcltk.o
cc-1552 c89: WARNING File = tcltk.c, Line = 39
  The variable "ans" is set but never used.

      SEXP text, expr, ans;
                       ^

cc-1552 c89: WARNING File = tcltk.c, Line = 70
  The variable "ans" is set but never used.

      SEXP expr, ans, fun, alist;
                 ^

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- Center for Scientific Computing       FAX: +1 801 585 1640, +1 801 581 4148 -
- University of Utah                    Internet e-mail: beebe@math.utah.edu  -
- Department of Mathematics, 322 INSCC      beebe@acm.org  beebe@computer.org -
- 155 S 1400 E RM 233                       beebe@ieee.org                    -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -
-------------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From beebe@math.utah.edu  Sat Feb 17 01:47:00 2001
From: beebe@math.utah.edu (beebe@math.utah.edu)
Date: Sat, 17 Feb 2001 02:47:00 +0100 (MET)
Subject: [Rd] More comments on R-1.2.1 builds (PR#852)
Message-ID: <200102170147.CAA19365@pubhealth.ku.dk>

On IBM RS/6000 AIX 4.2, I built R-1.2.1 with

% env CC=xlc CXX=xlC F77=f77 FC=f77 ./configure

R is now configured for powerpc-ibm-aix4.2.1.0

  Source directory:          .
  Installation directory:    /usr/local
  C compiler:                c89  -g
  C++ compiler:              xlC  -g
  FORTRAN compiler:          f77  -g

  X11 support:               yes
  Gnome support:             no
  Tcl/Tk support:            yes

  R profiling support:       yes
  R as a shared library:     no

However, the R-1.2.1 build fails in a number of places:

c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -c fortran.c -o fortran.o
"../../src/include/Fortran.h", line 43.9: 1506-213 (S) Macro name abs cannot
be redefined.
"../../src/include/Fortran.h", line 43.9: 1506-358 (I) "abs" is defined on
line 362 of /usr/include/stdlib.h.

I found that putting "#undef abs" before line 43 of Fortran.h solves
that problem.

It then dies later in compilation of several routines, of which this
is typical:

c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -c devices.c -o devices.o
"../../src/include/Startup.h", line 48.14: 1506-009 (S) Bit-field R_Quiet
must be of type signed int, unsigned int or int.
...

The complaint is from the use of a bitfield modifier on an enum;
gcc will compile this code, but IBM's cc and c89 will not.

This appears to be a violation of 1989 Standard C: in ANSI
X3.159-1989, on p. 61, section 3.5.2.1, I find at line 30:

>> ...
>> A bit-field shall have a type that is a qualified or unqualified
>> version of one of {\bf int}, {\bf unsigned int}, or {\bf signed int}. ...
>> ...

On the p. 62 in section 3.5.2.2, line 60:

>> ...
>> Each enumerated type shall be compatible with an integer type; the
>> choice of type is implementation-defined.
>> ...

In particular, if an enum is treated as char, short, long, or long
long, then it does not match the requirement of section 3.5.2.1.

To test this further, I made an experiment:

	% cat boo.c
	#if 1
	typedef enum { apple = 0, pear } Fruit;
	#else
	typedef int Fruit;
	#endif


	typedef struct boo {
	    Fruit x : 1;
	} S_Fruit;

	S_Fruit y;

On Sun Solaris 2.7:

	% c89 -Xa -c boo.c
	% c89 -Xt -c boo.c
	% c89 -Xc -c boo.c
	"boo.c", line 9: warning: nonportable bit-field type
	% cc -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% CC -c boo.c
	% g++ -c boo.c

On SGI IRIX 6:

	% c89 -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% CC -c boo.c
	% g++ -c boo.c

On Compaq/DEC Alpha OSF/1 4.0:

	% c89 -c boo.c
	cc: Info: boo.c, line 9: In the declaration of "x", the bitfield type is not an int, signed int or unsigned int. (bitnotint)
	    Fruit x : 1;
	----------^
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% cxx -c boo.c
	% g++ -c boo.c

On GNU/Linux (Redhat 6.2) on Intel x86:

	% cc -c boo.c
	% gcc -c boo.c
	% lcc -A -A -c boo.c
	boo.c:9: `Fruit' is an illegal bit-field type
	% g++ -c boo.c
	% pgcc -c boo.c
	% pgCC -c boo.c

On IBM RS/6000 AIX 4.3:
	% cc -c boo.c
	"boo.c", line 9.11: 1506-159 (E) Bit-field type specified for x is not valid. Type unsigned assumed.
	% gcc -c boo.c
	CC -c boo.c
	% CC -c boo.c
	% g++ -c boo.c
	% c89 -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.
	% xlC -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.
	% xlc -c boo.c
	"boo.c", line 9.11: 1506-009 (S) Bit-field x must be of type signed int, unsigned int or int.

Thus, the stricter 1989 Standard C compilers reject the use of the enum in
a bitfield.

C++ (ISO/IEC 14882-1998) says in section 9.5:

>> ...
>> 4 If the value true or false is stored into a bit-field of type bool
>> of any size (including a one bit bit-field), the original bool value
>> and the value of the bit-field shall compare equal.  If the value of
>> an enu-merator is stored into a bit-field of the same enumeration type
>> and the number of bits in the bit-field is large enough to hold all
>> the values of that enumeration type, the original enumerator value and
>> the value of thebit-field shall compare equal.
>> ...

This suggests that Standard C++ permits enums to have bitfield
modifiers.  However, as far as I know, there are not yet any Standard
C++ compilers available on any platform.

I could not find definitive language in ISO/IEC 9899-1999, the 1999 C
Standard on this point.

In summary, it seems best to eliminate the bitfield modifiers on enum
data.  Even if this involves a small memory penalty, it will probably
make the code faster, since bitmasking and shifting is no longer
needed to access the fields.

-------------------------------------------------------------------------------
- Nelson H. F. Beebe                    Tel: +1 801 581 5254                  -
- Center for Scientific Computing       FAX: +1 801 585 1640, +1 801 581 4148 -
- University of Utah                    Internet e-mail: beebe@math.utah.edu  -
- Department of Mathematics, 322 INSCC      beebe@acm.org  beebe@computer.org -
- 155 S 1400 E RM 233                       beebe@ieee.org                    -
- Salt Lake City, UT 84112-0090, USA    URL: http://www.math.utah.edu/~beebe  -
-------------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sat Feb 17 14:25:13 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sat, 17 Feb 2001 15:25:13 +0100
Subject: [Rd] Comments on R-1.2.1 builds (PR#851)
In-Reply-To: <200102170044.BAA19310@pubhealth.ku.dk>
References: <200102170044.BAA19310@pubhealth.ku.dk>
Message-ID: <14990.35273.167526.4092@mithrandir.hornik.net>

>>>>> beebe  writes:

> The R-1.2.1 builds have gone fairly smoothly on most of my UNIX
> architectures, but there were many warnings reported by the picky SGI
> compiler that could be eliminated in future releases.

> Generally, I have found the SGI compilers very helpful in ferreting
> out portability problems, unused and/or obsolete variables, unexpected
> datatype coercions, etc., and they compile faster than any other
> compilers too.

> First, I configured like this:

> env CC='c89 -mips3 -O3' ./configure && make all

> This reports:

> 	R is now configured for mips-sgi-irix6.5

> 	  Source directory:          .
> 	  Installation directory:    /usr/local
> 	  C compiler:                c89 -mips3 -O3  -OPT:IEEE_NaN_inf=ON -g
> 	  C++ compiler:              c++  -g -O2
> 	  FORTRAN compiler:          g77  -OPT:IEEE_NaN_inf=ON -g -O2

> 	  X11 support:               yes
> 	  Gnome support:             no
> 	  Tcl/Tk support:            yes

> 	  R profiling support:       yes
> 	  R as a shared library:     no

> The build proceeds until this failure:

> 	g77 -OPT:IEEE_NaN_inf=ON  -g -O2 -c ch2inv.f -o ch2inv.o
> 	f771: Invalid option `-OPT:IEEE_NaN_inf=ON'
> 	make[3]: *** [ch2inv.o] Error 1

> Evidently, it was not prepared for the GNU Fortran compiler.

Yep, that is a bug.  I need some feedback for fixing this, though.  The
current logic is to run the autoconf R_C_OPTIEEE test if the platform is
IRIX.  The test itself tries to compile and run

#include <math.h>
#include <ieeefp.h>
int main () {
  double x = 0;
  fpsetmask(0); x = x / x; return (x != x);
}

and if that works adds -OPT:IEEE_NaN_inf=ON to both R_XTRA_CFLAGS and
R_XTRA_FFLAGS.

This obviously does not make sense for FORTRAN, and should be made more
defensive for C.

* For C, one should additionally test whether the compiler accepts this
  flag.  I assume gcc would not, so should we do

	if_not_using_gcc  check_arg("-OPT:IEEE_NaN_inf=ON")

* For FORTRAN, I am not sure whether the result of the above test has
  any relevance.  Question is, do we have a FORTRAN test program similar
  to the above to determine whether the flag is needed?  Again, we
  should also check whether the compiler accepts the flag ...

* Or should we simply unconditionally add the flag for ``native'', i.e.,
  non-GNU compilers?

(Sorry but I do not have access to SGIs ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb 17 15:01:32 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat, 17 Feb 2001 16:01:32 +0100 (MET)
Subject: [Rd] More comments on R-1.2.1 builds (PR#852)
Message-ID: <200102171501.QAA20856@pubhealth.ku.dk>

On Sat, 17 Feb 2001 beebe@math.utah.edu wrote:

> On IBM RS/6000 AIX 4.2, I built R-1.2.1 with
>
> % env CC=xlc CXX=xlC F77=f77 FC=f77 ./configure
>
> R is now configured for powerpc-ibm-aix4.2.1.0
>
>   Source directory:          .
>   Installation directory:    /usr/local
>   C compiler:                c89  -g
>   C++ compiler:              xlC  -g
>   FORTRAN compiler:          f77  -g
>
>   X11 support:               yes
>   Gnome support:             no
>   Tcl/Tk support:            yes
>
>   R profiling support:       yes
>   R as a shared library:     no
>
> However, the R-1.2.1 build fails in a number of places:
>
> c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -c fortran.c -o fortran.o
> "../../src/include/Fortran.h", line 43.9: 1506-213 (S) Macro name abs cannot
> be redefined.
> "../../src/include/Fortran.h", line 43.9: 1506-358 (I) "abs" is defined on
> line 362 of /usr/include/stdlib.h.
>
> I found that putting "#undef abs" before line 43 of Fortran.h solves
> that problem.

That definition is no longer used in the files using that header, and has
been deleted.  It looks like the file fortran.c is redundant too.

> It then dies later in compilation of several routines, of which this
> is typical:
>
> c89 -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -c devices.c -o devices.o
> "../../src/include/Startup.h", line 48.14: 1506-009 (S) Bit-field R_Quiet
> must be of type signed int, unsigned int or int.
> ...

This seems a mis-placed fit of enthusiasm!  As the designer of that
structure I certainly did not pack it, and there is just one instance of it
per R process.  I have removed the packing, which was added last November,
documented `many more cleanups' from the CVS logs.

(These changes refer to 1.2.2, which is planned for a couple of weeks.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Feb 18 10:10:40 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 18 Feb 2001 11:10:40 +0100
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>
References: <3A8C1B3A.6C16FBB1@bank-banque-canada.ca>
Message-ID: <14991.40864.896451.453333@mithrandir.hornik.net>

>>>>> Paul Gilbert writes:

> I am trying to catch a segfault from a shell in the tests directory
> set up by R CMD check with

> R_LIBS=~/dse/CHECKED/library:..
> export R_LIBS
> R -d gdb
> run

> but then when I try to load a library I find the setting of R_LIBS is
> ignored. What am I doing wrong? The library is found ok without -d
> gdb. (Using Solaris 2.6, R 1.2.1 Patched (2001-02-06) )

Hmm ... hard to believe:

hornik@mithrandir:~/tmp$ export R_LIBS=~/dse/CHECKED/library:..
hornik@mithrandir:~/tmp$ R -d gdb
GNU gdb 19990928
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(gdb) r
...
R> Sys.getenv("R_LIBS")
                               R_LIBS 
"/home/Hornik/dse/CHECKED/library:.." 

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 18 11:05:08 2001
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 18 Feb 2001 11:05:08 +0000 (GMT)
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <14991.40864.896451.453333@mithrandir.hornik.net>
Message-ID: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>

On Sun, 18 Feb 2001, Kurt Hornik wrote:

> >>>>> Paul Gilbert writes:
>
> > I am trying to catch a segfault from a shell in the tests directory
> > set up by R CMD check with
>
> > R_LIBS=~/dse/CHECKED/library:..
> > export R_LIBS
> > R -d gdb
> > run
>
> > but then when I try to load a library I find the setting of R_LIBS is
> > ignored. What am I doing wrong? The library is found ok without -d
> > gdb. (Using Solaris 2.6, R 1.2.1 Patched (2001-02-06) )
>
> Hmm ... hard to believe:
>
> hornik@mithrandir:~/tmp$ export R_LIBS=~/dse/CHECKED/library:..
> hornik@mithrandir:~/tmp$ R -d gdb
> GNU gdb 19990928
> Copyright 1998 Free Software Foundation, Inc.
> GDB is free software, covered by the GNU General Public License, and you are
> welcome to change it and/or distribute copies of it under certain conditions.
> Type "show copying" to see the conditions.
> There is absolutely no warranty for GDB.  Type "show warranty" for details.
> This GDB was configured as "i686-pc-linux-gnu"...
> (gdb) r
> ...
> R> Sys.getenv("R_LIBS")
>                                R_LIBS
> "/home/Hornik/dse/CHECKED/library:.."

Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
(gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From baron@cattell.psych.upenn.edu  Sun Feb 18 21:43:52 2001
From: baron@cattell.psych.upenn.edu (baron@cattell.psych.upenn.edu)
Date: Sun, 18 Feb 2001 22:43:52 +0100 (MET)
Subject: [Rd] match vs. %in% (PR#853)
Message-ID: <200102182143.WAA24872@pubhealth.ku.dk>

This isn't really a bug so much as an undocumented feature, but
perhaps the help file should be changed.

If you say
match(x,y)
you get the values of the _first_ instance in y that matches each
value of x.

If you say 
x %in% y
you get "TRUE" for every match, not just the first.

This is useful, now that I know it, but perhaps the thing
about the first instance should be documented.

I still don't understand why it happens!

Jon

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Sun Feb 18 22:41:56 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Mon, 19 Feb 2001 11:41:56 +1300
Subject: [Rd] Re: polygon border colors
References: <Pine.SUN.3.91.1010216085824.11176B@okapi.cor.epa.gov>
Message-ID: <012501c099fb$ffb7cad0$175dd882@stat.auckland.ac.nz>

Hi


> I think I see in do_polygon() in plot.c that border colors are
> not cycled, and that changes in the lines
>
> ...
>     PROTECT(border = FixupCol(CAR(args), dd->gp.fg)); args = CDR(args);
> ...
> GPolygon(i-start, x+start, y+start, USER,
> INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
> ...
>     GPolygon(nx-start, x+start, y+start, USER,
>      INTEGER(col)[num%ncol], INTEGER(border)[0], dd);
> ...
>
> following the pattern for "col" might make cycling possible.
>
> Is this a change that I should try locally, or could this be
> considered for the standard version?


There is now a fix in the release version of R, which should come out fairly
soon.  There is also a fix to recycle the lty argument, plus documentation
and an example to show how you can get multiple polygons out of a single
call to polygon() using NA coordinates.

Thanks for the bug report and suggested solution.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 19 07:24:55 2001
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Feb 2001 07:24:55 +0000 (GMT)
Subject: [Rd] match vs. %in% (PR#853)
In-Reply-To: <200102182143.WAA24872@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0102190719130.26442-100000@auk.stats>

On Sun, 18 Feb 2001 baron@cattell.psych.upenn.edu wrote:

> This isn't really a bug so much as an undocumented feature, but
> perhaps the help file should be changed.
>
> If you say
> match(x,y)
> you get the values of the _first_ instance in y that matches each
> value of x.

Yes, but one match or not for each instance of x.

> If you say
> x %in% y
> you get "TRUE" for every match, not just the first.

You get a result for each element of x, not y.

Both return a result for each element of x. match returns the index of the
first match or `nomatch',  %in% returns TRUE or FALSE.

is.element is a synonym of %in% compatible with S, which uses %in% for
something else (nesting in formulae).

> This is useful, now that I know it, but perhaps the thing
> about the first instance should be documented.

Yes, ?match needs a `details' section.  I'll add one.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From adrian@olsen.ch  Mon Feb 19 09:35:36 2001
From: adrian@olsen.ch (Adrian Trapletti)
Date: Mon, 19 Feb 2001 10:35:36 +0100
Subject: [Rd] who frees dd and xd in X11_Open?
References: <200102160903.JAA29278@toucan.stats.ox.ac.uk>
 <x2n1bmrg0r.fsf@blueberry.kubism.ku.dk> <pxwvaqse73.fsf@infiniti.ece.cmu.edu>
Message-ID: <3A90E8E7.7A066F7@olsen.ch>


Thomas Vogels wrote:

> Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk> writes:
>
> > Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> >
> > > > Date: Fri, 16 Feb 2001 09:04:45 +0100
> > > > From: Adrian Trapletti <adrian@olsen.ch
> > >
> > > > I don't know if it has something to do with this discussion, but it's
> > > > probably worth reporting it.
> > > >
> > > > Under
> > > > SunOS pul 5.8 Generic sun4u sparc SUNW,Ultra-5_10
> > > > R : Version 1.2.1  (2001-01-15)
> > > > Fvwm95 Version 2.0.43a
> > > > the window manager always crashes when I close an x11() device started
> > > > within R.
> > >
> > > This discussion is about png() and jpeg() devices.  We've had other
> > > reports about FVWM, though.
> >
> > ...and they too refer to improper error handling by X11. I'm somewhat
> > baffled by the effect reported, though. Surely, an application
> > crashing the window manager is a bug in the latter, not the former?
> > What we've heard of before is that closing X11 windows with the window
> > manager crashes R, but this sounds like the other way around.
>
> The question about freeing xd and dd comes indeed from my fiddling
> with the X11 driver and understanding the code there...  As for the
> current handleEvent: there are some events simply ignored (like the
> DestroyNotify event) and some are not reaped due to the sequence of
> events in X11_Close/R_ProcessEvents.  (And the way inclose is handled
> is scary once you think of closing two windows at roughly the same
> time...)  The events that linger after R is done shouldn't confuse the
> window manager, though.
>
> I've put my code, patches, comments, suggestions, etc. at:
> http://www.ece.cmu.edu/~tov/public/R/X11andTk.html
> I'd be curious whether R with the patched handleEvent still crashes
> FVWM95.  Probably but who knows.

First, I was somewhat sleeping when I reported this problem. It is not
window-close which causes the crash, but window-minimize (iconify 1) (sorry for
that).

I recompiled R-1.2.1 with your patch. FVWM95 still crashes when I minimize the
x11 device. Furthermore, no other WM (olwm, fvwm, fvwm2, icewm) crashes.

Adrian


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Feb 19 16:27:22 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Feb 2001 11:27:22 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
Message-ID: <3A914969.3A17BA04@bank-banque-canada.ca>

>Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
>(gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

This is the clue, though --vanilla doesn't fix it. R_LIBS is set in my
.cshrc file and when I use R -d gdb it grabs the setting from there (but
not when I don't use "-d gdb"). This seems a bit strange since I am
actually running this from sh (which I started from a csh). However, it
is not grabbing the R_LIBS setting from the original csh but directly
from the .cshrc file since it changes when I comment out the setting in
.cshrc and simply restart "R -d gdb".

Thanks,
Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Feb 20 13:45:00 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 20 Feb 2001 14:45:00 +0100
Subject: [Rd] R_LIBS setting in R -d gdb
In-Reply-To: <3A914969.3A17BA04@bank-banque-canada.ca>
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
 <3A914969.3A17BA04@bank-banque-canada.ca>
Message-ID: <14994.29916.987350.524484@mithrandir.hornik.net>

>>>>> Paul Gilbert writes:

>> Is R_LIBS set anywhere else?  This works for me (Solaris 2.7) if I use
>> (gdb) r --vanilla to avoid the .Renviron which contains R_LIBS.

> This is the clue, though --vanilla doesn't fix it. R_LIBS is set in my
> .cshrc file and when I use R -d gdb it grabs the setting from there
> (but not when I don't use "-d gdb"). This seems a bit strange since I
> am actually running this from sh (which I started from a
> csh). However, it is not grabbing the R_LIBS setting from the original
> csh but directly from the .cshrc file since it changes when I comment
> out the setting in .cshrc and simply restart "R -d gdb".

I am confused.  But here's what the GDB info page says:

   *Warning:* On Unix systems, GDB runs your program using the shell
indicated by your `SHELL' environment variable if it exists (or
`/bin/sh' if not).  If your `SHELL' variable names a shell that runs an
initialization file--such as `.cshrc' for C-shell, or `.bashrc' for
BASH--any variables you set in that file affect your program.  You may
wish to move setting of environment variables to files that are only
run when you sign on, such as `.login' or `.profile'.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Feb 20 17:01:40 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 20 Feb 2001 12:01:40 -0500
Subject: [Rd] R_LIBS setting in R -d gdb
References: <Pine.GSO.4.31.0102181102000.2115-100000@toucan.stats>
 <3A914969.3A17BA04@bank-banque-canada.ca> <14994.29916.987350.524484@mithrandir.hornik.net>
Message-ID: <3A92A2F4.9B71740B@bank-banque-canada.ca>

Kurt

>   *Warning:* On Unix systems, GDB runs your program using the shell
> indicated by your `SHELL' environment variable if it exists (or
> `/bin/sh' if not).  If your `SHELL' variable names a shell that runs an
> initialization file--such as `.cshrc' for C-shell, or `.bashrc' for
> BASH--any variables you set in that file affect your program.  You may
> wish to move setting of environment variables to files that are only
> run when you sign on, such as `.login' or `.profile'.

Thanks, that explains it.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Feb 20 18:12:19 2001
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 20 Feb 2001 13:12:19 -0500
Subject: [Rd] segfault
Message-ID: <3A92B383.422D1435@bank-banque-canada.ca>

I've managed to trap the following segfault with xxgdb and gctorture() set. The
segfault seems to move around if gctorture() is not set, but has now occurred twice
in the same spot with it set.  xxgdb gives the message

Program received signal SIGSEGV, Segmentation fault.
0x71244 in RunGenCollect (size_needed=2) at memory.c:1027

and the source listing points to FORWARD_CHILDREN(s); in the following section from
src/main/memory.c

#ifndef EXPEL_OLD_TO_NEW
    /* scan nodes in uncollected old generations with old-to-new pointers */
    for (gen = num_old_gens_to_collect; gen < NUM_OLD_GENERATIONS; gen++)
 for (i = 0; i < NUM_NODE_CLASSES; i++)
     for (s = NEXT_NODE(R_GenHeap[i].OldToNew[gen]);
   s != R_GenHeap[i].OldToNew[gen];
   s = NEXT_NODE(s))
  FORWARD_CHILDREN(s);
#endif


I'm using
> version
         _
platform sparc-sun-solaris2.6
arch     sparc
os       solaris2.6
system   sparc, solaris2.6
status   Patched
major    1
minor    2.1
year     2001
month    02
day      06
language R

Paul Gilbert

P.S. If someone can quickly tell me the trick to make cut and paste work with xxgdb
in Solaris I would appreciate it. (I realize I should probably read the manual, but
if it is simple please let me know.)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Tue Feb 20 20:09:21 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 20 Feb 2001 21:09:21 +0100
Subject: [Rd] segfault
In-Reply-To: Paul Gilbert's message of "Tue, 20 Feb 2001 13:12:19 -0500"
References: <3A92B383.422D1435@bank-banque-canada.ca>
Message-ID: <x266i5m80e.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> I've managed to trap the following segfault with xxgdb and gctorture() set. The
> segfault seems to move around if gctorture() is not set, but has now occurred twice
> in the same spot with it set.  xxgdb gives the message
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x71244 in RunGenCollect (size_needed=2) at memory.c:1027
> 
> and the source listing points to FORWARD_CHILDREN(s); in the following section from
> src/main/memory.c
> 
> #ifndef EXPEL_OLD_TO_NEW
>     /* scan nodes in uncollected old generations with old-to-new pointers */
>     for (gen = num_old_gens_to_collect; gen < NUM_OLD_GENERATIONS; gen++)
>  for (i = 0; i < NUM_NODE_CLASSES; i++)
>      for (s = NEXT_NODE(R_GenHeap[i].OldToNew[gen]);
>    s != R_GenHeap[i].OldToNew[gen];
>    s = NEXT_NODE(s))
>   FORWARD_CHILDREN(s);
> #endif
> 

This just shows that something corrupted the memory handling. The
actual bug is probably somewhat prior to this. If you do a "bt"
(backtrace) and go "up" a couple of times, you might find a spot where
someone forgot to PROTECT() a newly created R object.


> P.S. If someone can quickly tell me the trick to make cut and paste work with xxgdb
> in Solaris I would appreciate it. (I realize I should probably read the manual, but
> if it is simple please let me know.)

I gave up on xxgdb long ago because I thought it was enough to have to
deal with bugs in our own programs! However, it would seem that the
ordinary mousing techniques works as usual on Linux. Command-line
recall appears to be shot, however.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@pubhealth.ku.dk  Wed Feb 21 06:15:04 2001
From: pd@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: Wed, 21 Feb 2001 07:15:04 +0100
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200102210615.HAA18304@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.r-project.org or via email to
r-bugs@r-project.org. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 751 *
Subject: BUG: polyroot()
From: "Li Dongfeng" <mavip1@inet.polyu.edu.hk>
Date: Tue, 28 Nov 2000 13:24:33 +0800
--Numerical instability. We may want a better algorithm!

Directory:  Add-ons

* PR# 824 *
Subject: trouble with netCDF 
From: jasont@indigoindustrial.co.nz
Date: Thu, 25 Jan 2001 12:00:39 +1300
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 812 *
Subject: segmentation fault in integrate
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Thu, 11 Jan 2001 22:49:59 +0100
* PR# 781 *
Subject: syskern fails Rcmd check on Windows, gives incorrect information
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 20 Dec 2000 11:12:47 +0000 (GMT)
--Partially fixed by dse_2000.12, but still uses "ls" and gives
--incorrect information

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 839 *
Subject: clipped lines have wrong slope in log plot
From: Jason Eisner <jason@cs.rochester.edu>
Date: Sun, 4 Feb 2001 20:17:31 -0500 (EST)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
* PR# 750 *
Subject: abline() does not obey "xpd" (clipping rules)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 27 Nov 2000 18:27:11 +0100
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix is incorporated in 1.2.2.
--
--There is a deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--Paul thinks the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above 
--mayhave side-effects in many other pieces of interpreted code 
--(ii) do_mtext ignores dd->gp.cexbase unlike, for example, do_plot_xy 
--and anything to do with cexbase needs extreme care.
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
* PR# 830 *
Subject: Disappearing x axis in plot.factor
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:27:13 -0500
* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
--Neither of the proposed changes actually works in sufficient generality.
--
--The easy and unimportant part of this, the labels, is fixed in 1.2.2. Getting
--the data right is a project for 1.3
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500

Directory:  In-Out

* PR# 814 *
Subject: Memory problem ?
From: Zoltan Barta <Z.Barta@bristol.ac.uk>
Date: Mon, 15 Jan 2001 09:54:16 +0000 (GMT Standard Time)
--scan crashes R on Linux: a memory allocation problem, probably
--Uses n= or nlines= in scan will use less memory, and read.table does.

Directory:  Installation

none

Directory:  Language

* PR# 813 *
Subject: match.call problem
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jan 2001 17:46:15 +0100
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 851 *
Subject: Comments on R-1.2.1 builds
From: "Nelson H. F. Beebe" <beebe@math.utah.edu>
Date: Fri, 16 Feb 2001 17:44:17 -0700 (MST)
--These are only warnings: some have been eliminated for 1.2.2.
--Some are about constructs needed to satisfy other compilers.
--
--Also: configure problem with g77 on SGI.
* PR# 822 *
Subject: Re: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:56:32 +0100 (CET)
--part of 821
* PR# 821 *
Subject: Sys.time dumps core at start-up
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Tue, 23 Jan 2001 19:44:28 +0100 (CET)
--See also 822, which shows the segfault is in strftime.c.
--From other correspondence, this is on RH5.0: we can't
--reproduce it on RH6.2 or anywhere else.
* PR# 848 *
Subject: X11 device doesn't handle destroy events correcly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
* PR# 838 *
Subject: Linux shared library problem
From: daniel.egloff@dplanet.ch
Date: Sun, 4 Feb 2001 22:37:31 +0100 (MET)
--RedHat 7.0: need updates?

Directory:  TooMuchAtOnce

* PR# 811 *
Subject: problem with strptime example (and mention of bug.report)
From: Stephen Eglen <stephen@anc.ed.ac.uk>
Date: Thu, 11 Jan 2001 19:18:39 GMT
--1) On OSF4, strptime is deficient. Nothing we can do.
--
--2) On Windows NT, the strptime problems are (i) German locale, English dates,
--(ii) Windows system errors with unknown DST (it move times to DST).
--(i) now has another warning in the help file (there already was one).
--(ii) was already worked around for 1.2.1.
--
--3) bug.report() uses a mailer option that does not exist on OSF4.

Directory:  Windows

none

Directory:  incoming

none
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pperkins@ucsd.edu  Thu Feb 22 07:36:55 2001
From: pperkins@ucsd.edu (pperkins@ucsd.edu)
Date: Thu, 22 Feb 2001 08:36:55 +0100 (MET)
Subject: [Rd] onefile= arg to postscript() (PR#854)
Message-ID: <200102220736.IAA07846@pubhealth.ku.dk>

Full_Name: Peter Perkins
Version: 1.2.1
OS: LinuxPPC
Submission from: (NULL) (24.4.89.36)


Unlike (at least some) other args/components of ps.options(), the onefile=
arg to postscript() does not default to ps.options()$onefile.  For the family=
and landscape= args, for example, it does.  Looking at postscript()'s code,
this
appears to be intentional.  If it _is_ intentional, the following clarification
might be added to the "onefile" line of the arguments section of the
postscript/ps.options help:

   "the onefile= arg to postscript() does _not_ default to the value set
    in the most recent call to ps.options(); rather, it defaults to TRUE."

but this raises the question, "just where _is_ the onefile arg to ps.options()
used, if not by postscript()?"

if the current behavior is not correct, then the solution seems to be
to change the default value to .PostScript.Options$onefile, if that's not
too ugly.  leaving onefile= out of the arg list would work, except then
the file= arg is left hanging.  for what it's worth, the explicit family=
arg seems to be superfluous, it would be handled by ... and the call to
check.options().

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 22 08:03:36 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 22 Feb 2001 09:03:36 +0100 (MET)
Subject: [Rd] onefile= arg to postscript() (PR#854)
Message-ID: <200102220803.JAA08341@pubhealth.ku.dk>

On Thu, 22 Feb 2001 pperkins@ucsd.edu wrote:

> for what it's worth, the explicit family=
> arg seems to be superfluous, it would be handled by ... and the call to
> check.options().

That is untrue, as you will see if you try it.
Take a look at the comment in the code, please.

    ## handle family separately as length can be 1 or 4
    if(!missing(family)) old$family <- family

In case you had not noticed, check.options would insist on length 1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gilb@home.com  Thu Feb 22 18:05:24 2001
From: gilb@home.com (Paul Gilbert)
Date: Thu, 22 Feb 2001 13:05:24 -0500
Subject: [Rd] segfault
Message-ID: <3A9554E3.357804E9@home.com>

A few people suggested ddd might be preferred to xxgdb, where upon xxgdb
crashed on me. I have now managed to get ddd working on my linux box at
home, but am still having some difficulty at work. (It requires a newer
c++ ,  some *tif libraries, etc.)

---- Peter D.  writes:
>The actual bug is probably somewhat prior to this. If you do a "bt"
>(backtrace) and go "up" a couple of times, you might find a spot where
>someone forgot to PROTECT() a newly created R object.

Well ddd  still does not install the innocent with the knowlege of C
programmers so I am guessing a bit about exactly what I should be
looking for. If I do "up" a few times I see a section of main/dotcode.c
starting at line 180 (copied below) that looks like it might have a
problem. The first few cases do not have any PROTECT statements and
others do. If this is not a a good guess then perhaps someone could fill
me in on what statements that create new R objects look like.

Thanks,
Paul
_____
    case INTSXP:
 s = allocVector(type, n);
 iptr = (int*)p;
 for(i=0 ; i<n ; i++) {
     INTEGER(s)[i] = iptr[i];
 }
 break;
    case REALSXP:
 s = allocVector(type, n);
 if(asLogical(getAttrib(arg, CSingSymbol)) == 1) {
     sptr = (float*) p;
     for(i=0 ; i<n ; i++) REAL(s)[i] = (double) sptr[i];
 } else {
     rptr = (double*) p;
     for(i=0 ; i<n ; i++) REAL(s)[i] = rptr[i];
 }
 break;
    case CPLXSXP:
 s = allocVector(type, n);
 zptr = (Rcomplex*)p;
 for(i=0 ; i<n ; i++) {
     COMPLEX(s)[i] = zptr[i];
 }
 break;
    case STRSXP:
 if(Fort) {
     /* only return one string: warned on the R -> Fortran step */
     strncpy(buf, (char*)p, 255);
     buf[256] = '\0';
     PROTECT(s = allocVector(type, 1));
     SET_STRING_ELT(s, 0, mkChar(buf));
     UNPROTECT(1);
 } else ...

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Thu Feb 22 22:37:18 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 22 Feb 2001 23:37:18 +0100
Subject: [Rd] segfault
In-Reply-To: Paul Gilbert's message of "Thu, 22 Feb 2001 13:05:24 -0500"
References: <3A9554E3.357804E9@home.com>
Message-ID: <x266i21h0h.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <gilb@home.com> writes:

> >The actual bug is probably somewhat prior to this. If you do a "bt"
> >(backtrace) and go "up" a couple of times, you might find a spot where
> >someone forgot to PROTECT() a newly created R object.
> 
> Well ddd  still does not install the innocent with the knowlege of C
> programmers so I am guessing a bit about exactly what I should be
> looking for. If I do "up" a few times I see a section of main/dotcode.c
> starting at line 180 (copied below) that looks like it might have a
> problem. The first few cases do not have any PROTECT statements and
> others do. If this is not a a good guess then perhaps someone could fill
> me in on what statements that create new R objects look like.

Briefly (and this'll have to be brief or I'll end up writing a
book...) things like allocVector create a new objects. As long as such
an object is "loose" - not assigned to an environment or made part of
an object which is - it is in danger of being destroyed by the garbage
collector. However, the garbage collector is not called randomly, it
can only happen when memory for a new object is being allocated. 

In the first handful of cases below, one allocates a vector and stuffs
some preexisting values into it (sitting in iptr, sptr, rptr,....) and
then passes s onto something else (it is the return value of
CPtrToRObj and that only gets called from do_dotCode where the return
value gets protected eventually)

However, in the STRSXP case, s needs protection because of the
mkChar(buf) which will allocate memory, and hence the construction:

     PROTECT(s = allocVector(type, 1));
     SET_STRING_ELT(s, 0, mkChar(buf));
     UNPROTECT(1);

I don't think this stretch of code is the culprit - it is a far too
busy area to be likely to have major bugs of this caliber.

Actually, once do_dotCode is involved, I'd suspect array overruns
rather than PROTECT bugs. I've seen several cases where a vector
turned out to getting passed with the wrong length or the wrong type.
Be very careful that all arguments to .Fortran/.C are explicitly
coerced to the right type - if you forget an as.double you might get a
routine that works impeccably until someone passes something like 1:12
(which has storage mode "integer") as an argument.

> Thanks,
> Paul
> _____
>     case INTSXP:
>  s = allocVector(type, n);
>  iptr = (int*)p;
>  for(i=0 ; i<n ; i++) {
>      INTEGER(s)[i] = iptr[i];
>  }
>  break;
>     case REALSXP:
>  s = allocVector(type, n);
>  if(asLogical(getAttrib(arg, CSingSymbol)) == 1) {
>      sptr = (float*) p;
>      for(i=0 ; i<n ; i++) REAL(s)[i] = (double) sptr[i];
>  } else {
>      rptr = (double*) p;
>      for(i=0 ; i<n ; i++) REAL(s)[i] = rptr[i];
>  }
>  break;
>     case CPLXSXP:
>  s = allocVector(type, n);
>  zptr = (Rcomplex*)p;
>  for(i=0 ; i<n ; i++) {
>      COMPLEX(s)[i] = zptr[i];
>  }
>  break;
>     case STRSXP:
>  if(Fort) {
>      /* only return one string: warned on the R -> Fortran step */
>      strncpy(buf, (char*)p, 255);
>      buf[256] = '\0';
>      PROTECT(s = allocVector(type, 1));
>      SET_STRING_ELT(s, 0, mkChar(buf));
>      UNPROTECT(1);
>  } else ...
> 
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Feb 12 15:10:14 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Feb 2001 16:10:14 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: <14962.20626.613619.35152@sonny.eddelbuettel.com>
References: <14962.20626.613619.35152@sonny.eddelbuettel.com>
Message-ID: <14983.64726.946115.11996@mithrandir.hornik.net>


	[Manually approved by MM -- because it contains binary attachment ]

--QcBiZYhiHg
Content-Type: text/plain; charset=us-ascii
Content-Description: message body text
Content-Transfer-Encoding: 7bit

>>>>> Dirk Eddelbuettel writes:

> GNU a2ps is a fairly versatile text-to-anything processor.  It is
> useful for typsetting source code from a wide variety of programming
> languages.  As R (ie S) wasn't supported yet, I quickly cobbled a
> style sheet for the S language together. Stylesheets are documented in
> the texinfo docs for a2ps, and examples can be found in
> /usr/share/a2ps/sheets (on Debian at least, others distros or unices
> probably have similar locations). IIRC a2ps exists for NT but might
> require Cygwin. I typeset on Linux and only print on NT :)

> Well, as I still don't really know what I'm doing with R, I would
> appreciate comments / feedback / input from anyone could spend a
> moment or two on this.  To activate the stylesheet, simple patch

>       /usr/share/a2ps/sheets/sheets.map

> as per the short diff below which declares that the stylesheet s.ssh
> shall be used for filenames matching /*.[RS]/.  The sheet itself is
> attached, just place it in the same directory, ie
> /usr/share/a2ps/sheets/.

> Usage then simply becomes
>       a2ps -Pdisplay foo.R
> or
>       a2ps foo.R -o foo.ps; gv foo.ps
> in case the "display" device isn't defined.

Thanks for bringing this up.  We have locally used style sheets S.ssh
for S code and Rd.ssh for Rd documentation format, both written by T
Hothorn.  I attach these files below.

> A few points / questions:

>  * content:  a2ps uses tricks to use TeX symbols. It works well to typset
>    <- with \leftarrow (uncomment that in s.ssh to see) but I couldn't tell
>    it to parse
>       a<-2
>    it only finds <- with whitespace, eg
>       a <- 2

Torsten gets this right by using a different alphabet, I think.

>    What could be done about <<- ?  Is there a matching TeX symbol?

Dunno.

>  * more content: Is the list of keywords really that short? I couldn't find
>    much else...

R-lang says:

	The following identifiers have a special meaning and should not
	be used for object names

	     if else repeat while function for in next break
	     TRUE FALSE NULL NA Inf NaN
	     ... ..1 ..2 etc.

so I think this is the list of keywords to use.

(Yes switch() is not in there ...)

>  * scope:  Are other file extensions in use? Are there conventions for S or
>    Splus files?  Any clever way to make a2ps understand the files in 
>    $R_HOME/library/$PACKAGE/R  are also R?  Could file(1) be taught what 
>    an R file is?

I think assuming that extensions `.R' and `.Rd' for R code and doc
source files are pretty safe.  The package installer will also allow for
code extensions `.r', `.S', `.s', and `.q', but I think only the last of
these may be specific enough to make it into the extension list.

No R magic in general.  ESS think .R/.r are safe for auto-mode-alist and
.S/.s need enforcing.  [One could try checking for Emacs-style mode
magic but I think that would be a bad idea.]

>  * editorial: shall this be the s.ssh or r.ssh or rs.ssh?

I think we want S.ssh, as this is a style sheet for code written in the
S language.

Best,
-k


--QcBiZYhiHg
Content-Type: application/octet-stream
Content-Disposition: attachment;
	filename="S.ssh"
Content-Transfer-Encoding: base64

IyBUaGlzIGlzIGEgUiBzaGVldApzdHlsZSBSIGlzCndyaXR0ZW4gYnkgIlRvcnN0ZW4gSG90aG9y
biA8aG90aG9ybkBjaS50dXdpZW4uYWMuYXQ+Igp2ZXJzaW9uIGlzIDAuMQpyZXF1aXJlcyBhMnBz
IDQuOS41Cgpkb2N1bWVudGF0aW9uIGlzCiAgICJDcmVhdGVzIHByZXR0eSBSLWNvZGUgcG9zdHNj
cmlwdCBmaWxlcy4iCmVuZCBkb2N1bWVudGF0aW9uCgphbHBoYWJldHMgYXJlCiAgICJBQkNERUZH
SElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XyMkJT0tJi8iCgpj
YXNlIHNlbnNpdGl2ZQoKIyBhbmNlc3RvcnMgYXJlCiMgICBjCiMgZW5kIGFuY2VzdG9ycwoKc2Vx
dWVuY2VzIGFyZQogICIjIiBDb21tZW50LAogICJcIiIgUGxhaW4gU3RyaW5nICJcIiIgUGxhaW4K
IyAgIGV4Y2VwdGlvbnMgYXJlCiMgICAgL1xcXFwsLwojICAgICAgIGVuZCBleGNlcHRpb25zCmVu
ZCBzZXF1ZW5jZXMKCmtleXdvcmRzIGluIEtleXdvcmRfc3Ryb25nIGFyZQogIGlmLCB0aGVuLCBl
bHNlLCBicmVhaywgd2hpbGUsIGZvciwgZnVuY3Rpb24sIG5leHQsIHJldHVybiwgRkFMU0UsIFRS
VUUKZW5kIGtleXdvcmRzCgpvcGVyYXRvcnMgYXJlCiAgIDwtIFxsZWZ0YXJyb3cKZW5kIG9wZXJh
dG9ycwoKb3B0aW9uYWwgc2VxdWVuY2VzIGFyZQogICA8IFBsYWluIEtleXdvcmQgPiBQbGFpbgpl
bmQgc2VxdWVuY2VzCmVuZCBzdHlsZQ==
--QcBiZYhiHg
Content-Type: application/octet-stream
Content-Disposition: attachment;
	filename="Rd.ssh"
Content-Transfer-Encoding: base64

IyBTdHlsZSBzaGVldCBmb3IgUyBvdXRwdXQKIyBDb3B5cmlnaHQgKGMpIDIwMDAgVG9yc3RlbiBI
b3Rob3JuCgojCiMgCiMgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVk
aXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKIyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIsIG9yIChhdCB5b3VyIG9wdGlvbikKIyBh
bnkgbGF0ZXIgdmVyc2lvbi4KIwojIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAojIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsg
d2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiMgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQojIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiMKIyBZb3Ugc2hvdWxkIGhhdmUgcmVj
ZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQojIGFsb25nIHdp
dGggdGhpcyBwcm9ncmFtOyBzZWUgdGhlIGZpbGUgQ09QWUlORy4gIElmIG5vdCwgd3JpdGUgdG8K
IyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAz
MzAsCiMgQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuCiMKIyAwLjEgVG9yc3RlbiBIb3Rob3Ju
CgpzdHlsZSBSZCBpcwp3cml0dGVuIGJ5ICJUb3JzdGVuIEhvdGhvcm4gPGhvdGhvcm5AY2kudHV3
aWVuLmFjLmF0PiIKdmVyc2lvbiBpcyAwLjEKcmVxdWlyZXMgYTJwcyA0LjkuNQoKZG9jdW1lbnRh
dGlvbiBpcwogICAJImEycHMgc3R5bGUgc2hlZXQgZm9yIFJkIgplbmQgZG9jdW1lbnRhdGlvbgoK
YWxwaGFiZXRzIGFyZQogICAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xt
bm9wcXJzdHV2d3h5el8jJCU9LSYvIgoKY2FzZSBzZW5zaXRpdmUKCiMgYW5jZXN0b3JzIGFyZQoj
ICAgYwojIGVuZCBhbmNlc3RvcnMKCnNlcXVlbmNlcyBhcmUKICAiIyIgQ29tbWVudCwKICAiXCIi
IFBsYWluIFN0cmluZyAiXCIiIFBsYWluLAogICJcXCIgS2V5d29yZF9zdHJvbmcgInsiIFBsYWlu
CiMgICJ7IiBQbGFpbiBTdHJpbmcgIn0iIFBsYWluCiMJZXhjZXB0aW9ucyBhcmUKIwkvaXRlbXss
Y29kZXssdXNhZ2V7LGtleXdvcmR7LwojCWVuZCBleGNlcHRpb25zCiMgICJ7IiBQbGFpbiBTdHJp
bmcgIn17IiBQbGFpbgojCQojICAgZXhjZXB0aW9ucyBhcmUKIyAgIC9cXFthOnpdey8gS2V5d29y
ZCAifSIgUGxhaW4KIyAgIGVuZCBleGNlcHRpb25zCmVuZCBzZXF1ZW5jZXMKCm9wZXJhdG9ycyBh
cmUKICAgPC0gXGxlZnRhcnJvdwplbmQgb3BlcmF0b3JzCgpvcHRpb25hbCBzZXF1ZW5jZXMgYXJl
CiAgIDwgUGxhaW4gS2V5d29yZCA+IFBsYWluCmVuZCBzZXF1ZW5jZXMKZW5kIHN0eWxl
--QcBiZYhiHg--

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@pubhealth.ku.dk  Sat Feb 24 00:00:46 2001
From: p.dalgaard@pubhealth.ku.dk (Peter Dalgaard BSA)
Date: 24 Feb 2001 01:00:46 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: Kurt Hornik's message of "Mon, 12 Feb 2001 16:10:14 +0100"
References: <14962.20626.613619.35152@sonny.eddelbuettel.com> <14983.64726.946115.11996@mithrandir.hornik.net>
Message-ID: <x266i1gdap.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> R-lang says:
> 
> 	The following identifiers have a special meaning and should not
> 	be used for object names
> 
> 	     if else repeat while function for in next break
> 	     TRUE FALSE NULL NA Inf NaN
> 	     ... ..1 ..2 etc.
> 
> so I think this is the list of keywords to use.
> 
> (Yes switch() is not in there ...)

switch() is technically a function call...

The true authority is the keywords[] array in gram.y, a study of which
indicates that ..1, ..2 et al. do bit count as keywords, whereas ...
does and we have an extra which was new to me, namely GLOBAL.ENV, and
truly enough:

> GLOBAL.ENV
<environment: R_GlobalEnv>
> GLOBAL.ENV <- 5
Error in <environment> <- 5 : invalid (do_set) left-hand side to
assignment

Wonder what that one is good for? The only symbolic reference to
it in the entire source is in gram.c, but I suppose its value gets
initialized somewhere. Looks like a relic from older times, but I
wouldn't dare to remove it for 1.2.2...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Feb 25 13:52:09 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 25 Feb 2001 14:52:09 +0100
Subject: [Rd] Off-topic: Pretty-printing R (or S) code with GNU a2ps
In-Reply-To: <x266i1gdap.fsf@blueberry.kubism.ku.dk>
References: <14962.20626.613619.35152@sonny.eddelbuettel.com>
 <14983.64726.946115.11996@mithrandir.hornik.net>
 <x266i1gdap.fsf@blueberry.kubism.ku.dk>
Message-ID: <15001.3593.198071.614550@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> R-lang says:
>> 
>> The following identifiers have a special meaning and should not
>> be used for object names
>> 
>> if else repeat while function for in next break
>> TRUE FALSE NULL NA Inf NaN
>> ... ..1 ..2 etc.
>> 
>> so I think this is the list of keywords to use.
>> 
>> (Yes switch() is not in there ...)

> switch() is technically a function call...

> The true authority is the keywords[] array in gram.y, a study of which
> indicates that ..1, ..2 et al. do bit count as keywords, whereas ...
> does and we have an extra which was new to me, namely GLOBAL.ENV, and
> truly enough:

>> GLOBAL.ENV
> <environment: R_GlobalEnv>
>> GLOBAL.ENV <- 5
> Error in <environment> <- 5 : invalid (do_set) left-hand side to
> assignment

> Wonder what that one is good for? The only symbolic reference to
> it in the entire source is in gram.c, but I suppose its value gets
> initialized somewhere. Looks like a relic from older times, but I
> wouldn't dare to remove it for 1.2.2...

Fascinating.  Maybe file it as a bug report so that we do not forget to
fix this in the future?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Torsten.Hothorn@rzmail.uni-erlangen.de  Mon Feb 26 12:48:36 2001
From: Torsten.Hothorn@rzmail.uni-erlangen.de (Torsten.Hothorn@rzmail.uni-erlangen.de)
Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261248.NAA14371@pubhealth.ku.dk>


Hi, 

when we add 

\examples{
a <- 1:4

a %*% a
}

into a Rd-file are run R CMD check, the resulting R code is 

a <- 1:4

a

So, %*% ... is lost on the way if I'm not totally confused. 

Torsten

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Patched
 major = 1
 minor = 2.0
 year = 2001
 month = 01
 day = 07
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 26 12:57:23 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 26 Feb 2001 13:57:23 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261257.NAA14485@pubhealth.ku.dk>

>From R-exts.texi ca line 1125.

The ``comment'' and ``control'' characters @samp{%} and @samp{\}
@emph{always} need to be escaped.  Inside the verbatim-like commands
(@code{\code} and @code{\examples}), no other characters are special.

You need \%*\%, as it suggests there and is used in the base package
examples.

Brian

> From: Torsten.Hothorn@rzmail.uni-erlangen.de
> Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] %*% in examples (PR#855)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> 
> Hi, 
> 
> when we add 
> 
> \examples{
> a <- 1:4
> 
> a %*% a
> }
> 
> into a Rd-file are run R CMD check, the resulting R code is 
> 
> a <- 1:4
> 
> a
> 
> So, %*% ... is lost on the way if I'm not totally confused. 
> 
> Torsten
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = Patched
>  major = 1
>  minor = 2.0
>  year = 2001
>  month = 01
>  day = 07
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:ctest, Autoloads, package:base
> 
> 
> 
> 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> 
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Torsten.Hothorn@rzmail.uni-erlangen.de  Mon Feb 26 13:06:17 2001
From: Torsten.Hothorn@rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Mon, 26 Feb 2001 14:06:17 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
In-Reply-To: <200102261257.MAA16411@toucan.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.21.0102261405230.22353-100000@artemis.imbe.med.uni-erlangen.de>


> >From R-exts.texi ca line 1125.
> 
> The ``comment'' and ``control'' characters @samp{%} and @samp{\}
> @emph{always} need to be escaped.  Inside the verbatim-like commands
> (@code{\code} and @code{\examples}), no other characters are special.
> 
> You need \%*\%, as it suggests there and is used in the base package
> examples.

well, as always: read the docs ;-)

Torsten

> 
> Brian
> 
> > From: Torsten.Hothorn@rzmail.uni-erlangen.de
> > Date: Mon, 26 Feb 2001 13:48:36 +0100 (MET)
> > To: r-devel@stat.math.ethz.ch
> > Subject: [Rd] %*% in examples (PR#855)
> > CC: R-bugs@biostat.ku.dk
> > X-Loop: R-bugs@biostat.ku.dk
> > 
> > 
> > Hi, 
> > 
> > when we add 
> > 
> > \examples{
> > a <- 1:4
> > 
> > a %*% a
> > }
> > 
> > into a Rd-file are run R CMD check, the resulting R code is 
> > 
> > a <- 1:4
> > 
> > a
> > 
> > So, %*% ... is lost on the way if I'm not totally confused. 
> > 
> > Torsten
> > 
> > --please do not edit the information below--
> > 
> > Version:
> >  platform = i686-pc-linux-gnu
> >  arch = i686
> >  os = linux-gnu
> >  system = i686, linux-gnu
> >  status = Patched
> >  major = 1
> >  minor = 2.0
> >  year = 2001
> >  month = 01
> >  day = 07
> >  language = R
> > 
> > Search Path:
> >  .GlobalEnv, package:ctest, Autoloads, package:base
> > 
> > 
> > 
> > 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > 
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Mon Feb 26 13:08:12 2001
From: ligges@statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Mon, 26 Feb 2001 14:08:12 +0100 (MET)
Subject: [Rd] %*% in examples (PR#855)
Message-ID: <200102261308.OAA14670@pubhealth.ku.dk>

Torsten.Hothorn@rzmail.uni-erlangen.de wrote:
> 
> Hi,
> 
> when we add
> 
> \examples{
> a <- 1:4
> 
> a %*% a
> }
> 
> into a Rd-file are run R CMD check, the resulting R code is
> 
> a <- 1:4
> 
> a
> 
> So, %*% ... is lost on the way if I'm not totally confused.
> 

That's not a bug, Torsten.

Use 
a \%*\% a

% this is a comment

Uwe

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Feb 26 16:16:59 2001
From: pgilbert@bank-banque-canada.ca (pgilbert@bank-banque-canada.ca)
Date: Mon, 26 Feb 2001 17:16:59 +0100 (MET)
Subject: [Rd] "}  {" problem in Rd files (PR#856)
Message-ID: <200102261616.RAA18047@pubhealth.ku.dk>

I better report this before I forget again (I think it may also be a
problem with \item) :

>Paul Gilbert wrote:

>> >   \section{Model Parameters}{
>>
>> I seem to recall having a bit of trouble with this quietly omitting
things when the
>> last "{" had a space before it or was on a new line. I'm not sure if
that >>is still a problem (or if indeed it ever was).

>Indeed it is, and there would be a few extra dents in the wall at head
>height here if you had not mentioned it.  Thanks.

>Jim





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Feb 26 17:12:18 2001
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 26 Feb 2001 18:12:18 +0100 (MET)
Subject: [Rd] "}  {" problem in Rd files (PR#856)
Message-ID: <200102261712.SAA18492@pubhealth.ku.dk>


> From: pgilbert@bank-banque-canada.ca
> Date: Mon, 26 Feb 2001 17:16:59 +0100 (MET)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] "}  {" problem in Rd files (PR#856)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> I better report this before I forget again (I think it may also be a
> problem with \item) :
> 
> >Paul Gilbert wrote:
> 
> >> >   \section{Model Parameters}{
> >>
> >> I seem to recall having a bit of trouble with this quietly omitting
> things when the
> >> last "{" had a space before it or was on a new line. I'm not sure if
> that >>is still a problem (or if indeed it ever was).
> 
> >Indeed it is, and there would be a few extra dents in the wall at head
> >height here if you had not mentioned it.  Thanks.

Also \deqn, \eqn.  However, they do work when used as documented
in R-exts, so I am not sure this is a bug.  Adding new lines and spaces
is a problem in other places in Rd too: not a fatal one but gets
unwanted spaces in the output.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marchini@stats.ox.ac.uk  Tue Feb 27 09:00:33 2001
From: marchini@stats.ox.ac.uk (marchini@stats.ox.ac.uk)
Date: Tue, 27 Feb 2001 10:00:33 +0100 (MET)
Subject: [Rd] Plotting points on a filled.contour plot (PR#857)
Message-ID: <200102270900.KAA23881@pubhealth.ku.dk>

Full_Name: Jonathan Marchini
Version: R 1.2.2
OS: linux-gnu
Submission from: (NULL) (163.1.103.108)


When adding points to a filled.contour plot they do not appear at the correct
coordinates.
The following code demonstrates this.
 
a<-expand.grid(1:20,1:20)
b<-matrix(a[,1]+a[,2],20)
filled.contour(x=1:20,y=1:20,z=b)
points(10,10)  

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas.baumann@ch.tum.de  Tue Feb 27 08:35:57 2001
From: thomas.baumann@ch.tum.de (Dr. Thomas Baumann)
Date: Tue, 27 Feb 2001 09:35:57 +0100 (CET)
Subject: [Rd] Patch to coplot.R
Message-ID: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; charset=us-ascii

Hello,

and a big thank you for providing R!

Please find attached a diff for coplot which you may want to consider
for the next release. The diff is against R 1.2.2. The reasons for this
patch are:

1. The boxes of coplot did not align very well with the panel graphs if
   applied to a factor

2. Putting the levels as axis labels instead of just numbers makes the
   plot more readable

I also include a sample dataset (test.asc) and a sample program to show
the differences.

Thanks for looking at the code.

Thomas


---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="coplot.diff"

*** /tmp/mycoplot.R	Tue Feb 27 09:08:13 2001
--- /tmp/coplot.R.orig	Tue Feb 27 09:08:13 2001
***************
*** 201,227 ****
                  ...)
          }
          if ((i == total.rows) && (j%%2 == 0)) 
!             if (nlevels(x) > 0)
!               axis(1, labels = levels(x), xpd = NA)
!             else
!               axis(1, xpd = NA)
          else if ((i == istart || index + columns > nplots) && 
              (j%%2 == 1)) 
!             if (nlevels(x) > 0)
!               axis(3, labels = levels(x), xpd = NA)
!             else
!               axis(3, xpd = NA)
!         if ((j == 1) && ((total.rows - i)%%2 == 0))
!             if (nlevels(y) > 0)
!               axis(2, labels = levels(y), xpd = NA)
!             else
!               axis(2, xpd = NA)
          else if ((j == columns || index == nplots) && ((total.rows - 
!             i)%%2 == 1))
!             if (nlevels(y) > 0)
!               axis(4, labels = levels(y), xpd = NA)
!             else
!               axis(4, xpd = NA)
          box()
      }
      if (have.b) {
--- 201,215 ----
                  ...)
          }
          if ((i == total.rows) && (j%%2 == 0)) 
!             axis(1, xpd = NA)
          else if ((i == istart || index + columns > nplots) && 
              (j%%2 == 1)) 
!             axis(3, xpd = NA)
!         if ((j == 1) && ((total.rows - i)%%2 == 0)) 
!             axis(2, xpd = NA)
          else if ((j == columns || index == nplots) && ((total.rows - 
!             i)%%2 == 1)) 
!             axis(4, xpd = NA)
          box()
      }
      if (have.b) {
***************
*** 255,274 ****
          par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
          plot.new()
          nint <- nrow(a.intervals)
!         pwoffs <- nint / 32
!         plot.window(c(min(a.intervals[is.finite(a.intervals)] + pwoffs),
!                       max(a.intervals[is.finite(a.intervals)]) - pwoffs),
!                     0.5 + c(0, nint), log = "")
!         rect(a.intervals[, 1], 1:nint - 0.5, a.intervals[, 2], 
!             1:nint + 0.5, col = gray(0.95))
!         if (!is.null(a.levels)) {
              mid <- apply(a.intervals, 1, mean)
              text(mid, 1:nint, a.levels)
              NULL
          }
!         axis(3, labels = FALSE, tick = FALSE, xpd = NA)
!         axis(1, labels = FALSE, tick = FALSE)
!         box(col = "grey")
          mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
              line = 3, xpd = NA)
      }
--- 243,262 ----
          par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
          plot.new()
          nint <- nrow(a.intervals)
!         plot.window(range(a.intervals[is.finite(a.intervals)]), 
!             0.5 + c(0, nint), log = "")
!         bg <- if (is.null(a.levels)) 
!             gray(0.9)
!         else {
              mid <- apply(a.intervals, 1, mean)
              text(mid, 1:nint, a.levels)
              NULL
          }
!         rect(a.intervals[, 1], 1:nint - 0.3, a.intervals[, 2], 
!             1:nint + 0.3, col = bg)
!         axis(3, xpd = NA)
!         axis(1, labels = FALSE)
!         box()
          mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
              line = 3, xpd = NA)
      }
***************
*** 284,304 ****
              par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
              plot.new()
              nint <- nrow(b.intervals)
!             pwoffs <- nint / 32
!             plot.window(0.5 + c(0, nint),
!                         c(min(b.intervals[is.finite(b.intervals)] + pwoffs),
!                           max(b.intervals[is.finite(b.intervals)]) - pwoffs),
!                         log = "")
!             rect(1:nint - 0.5, b.intervals[, 1], 1:nint + 0.5, 
!                 b.intervals[, 2], col = gray(0.95))
!             if (!is.null(b.levels)) {
                  mid <- apply(b.intervals, 1, mean)
                  text(1:nint, mid, b.levels, srt = 90)
                  NULL
              }
!             axis(4, labels = FALSE, tick = FALSE, xpd = NA)
!             axis(2, labels = FALSE, tick = FALSE)
!             box(col = "grey")
              mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                  line = 3, xpd = NA)
          }
--- 272,291 ----
              par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
              plot.new()
              nint <- nrow(b.intervals)
!             plot.window(0.5 + c(0, nint), range(b.intervals, 
!                 finite = TRUE), log = "")
!             bg <- if (is.null(b.levels)) 
!                 gray(0.9)
!             else {
                  mid <- apply(b.intervals, 1, mean)
                  text(1:nint, mid, b.levels, srt = 90)
                  NULL
              }
!             rect(1:nint - 0.3, b.intervals[, 1], 1:nint + 0.3, 
!                 b.intervals[, 2], col = bg)
!             axis(4, xpd = NA)
!             axis(2, labels = FALSE)
!             box()
              mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                  line = 3, xpd = NA)
          }

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="mycoplot.R"

function (formula, data, given.values, panel = points, rows, 
    columns, show.given = TRUE, col = par("fg"), pch = par("pch"), 
    xlab = c(x.name, paste("Given :", a.name)), ylab = c(y.name, 
        paste("Given :", b.name)), subscripts = FALSE, number = 6, 
    overlap = 0.5, xlim, ylim, ...) 
{
    deparen <- function(expr) {
        while (is.language(expr) && !is.name(expr) && deparse(expr[[1]]) == 
            "(") expr <- expr[[2]]
        expr
    }
    bad.formula <- function() stop("invalid conditioning formula")
    bad.lengths <- function() stop("incompatible variable lengths")
    formula <- deparen(formula)
    if (!inherits(formula, "formula")) 
        bad.formula()
    y <- deparen(formula[[2]])
    rhs <- deparen(formula[[3]])
    if (deparse(rhs[[1]]) != "|") 
        bad.formula()
    x <- deparen(rhs[[2]])
    rhs <- deparen(rhs[[3]])
    if (is.language(rhs) && !is.name(rhs) && (deparse(rhs[[1]]) == 
        "*" || deparse(rhs[[1]]) == "+")) {
        have.b <- TRUE
        a <- deparen(rhs[[2]])
        b <- deparen(rhs[[3]])
    }
    else {
        have.b <- FALSE
        a <- rhs
    }
    if (missing(data)) 
        data <- parent.frame()
    x.name <- deparse(x)
    x <- eval(x, data, parent.frame())
    nobs <- length(x)
    y.name <- deparse(y)
    y <- eval(y, data, parent.frame())
    if (length(y) != nobs) 
        bad.lengths()
    a.name <- deparse(a)
    a <- eval(a, data, parent.frame())
    if (length(a) != nobs) 
        bad.lengths()
    if (is.character(a)) 
        a <- as.factor(a)
    a.levels <- NULL
    if (have.b) {
        b.levels <- NULL
        b.name <- deparse(b)
        b <- eval(b, data, parent.frame())
        if (length(b) != nobs) 
            bad.lengths()
        if (is.character(b)) 
            b <- as.factor(b)
        missingrows <- which(is.na(x) | is.na(y) | is.na(a) | 
            is.na(b))
    }
    else {
        missingrows <- which(is.na(x) | is.na(y) | is.na(a))
        b <- NULL
        b.name <- ""
    }
    number <- as.integer(number)
    if (length(number) == 0 || any(number < 1)) 
        stop("number must be integer >= 1")
    if (any(overlap >= 1)) 
        stop("overlap must be < 1 (and typically >= 0).")
    bad.givens <- function() stop("invalid given.values")
    if (missing(given.values)) {
        a.intervals <- if (is.factor(a)) {
            i <- 1:nlevels(a)
            a.levels <- levels(a)
            a <- as.numeric(a)
            cbind(i - 0.5, i + 0.5)
        }
        else co.intervals(a, number = number[1], overlap = overlap[1])
        b.intervals <- if (have.b) {
            if (is.factor(b)) {
                i <- 1:nlevels(b)
                b.levels <- levels(b)
                b <- as.numeric(b)
                cbind(i - 0.5, i + 0.5)
            }
            else {
                if (length(number) == 1) 
                  number <- rep(number, 2)
                if (length(overlap) == 1) 
                  overlap <- rep(overlap, 2)
                co.intervals(b, number = number[2], overlap = overlap[2])
            }
        }
    }
    else {
        if (!is.list(given.values)) 
            given.values <- list(given.values)
        if (length(given.values) != (if (have.b) 
            2
        else 1)) 
            bad.givens()
        a.intervals <- given.values[[1]]
        if (is.factor(a)) {
            if (is.character(a.intervals)) 
                a.intervals <- match(a.intervals, levels(a))
            a.intervals <- cbind(a.intervals - 0.5, a.intervals + 
                0.5)
            a.levels <- levels(a)
            a <- as.numeric(a)
        }
        else if (is.numeric(a)) {
            if (!is.numeric(a.intervals)) 
                bad.givens()
            if (!is.matrix(a.intervals) || ncol(a.intervals) != 
                2) 
                a.intervals <- cbind(a.intervals - 0.5, a.intervals + 
                  0.5)
        }
        if (have.b) {
            b.intervals <- given.values[[2]]
            if (is.factor(b)) {
                if (is.character(b.intervals)) 
                  b.intervals <- match(b.intervals, levels(b))
                b.intervals <- cbind(b.intervals - 0.5, b.intervals + 
                  0.5)
                b.levels <- levels(b)
                b <- as.numeric(b)
            }
            else if (is.numeric(b)) {
                if (!is.numeric(b.intervals)) 
                  bad.givens()
                if (!is.matrix(b.intervals) || ncol(b.intervals) != 
                  2) 
                  b.intervals <- cbind(b.intervals - 0.5, b.intervals + 
                    0.5)
            }
        }
    }
    if (any(is.na(a.intervals)) || (have.b && any(is.na(b.intervals)))) 
        bad.givens()
    if (have.b) {
        rows <- nrow(b.intervals)
        columns <- nrow(a.intervals)
        nplots <- rows * columns
        if (length(show.given) < 2) 
            show.given <- rep(show.given, 2)
    }
    else {
        nplots <- nrow(a.intervals)
        if (missing(rows)) {
            if (missing(columns)) {
                rows <- ceiling(round(sqrt(nplots)))
                columns <- ceiling(nplots/rows)
            }
            else rows <- ceiling(nplots/columns)
        }
        else if (missing(columns)) 
            columns <- ceiling(nplots/rows)
        if (rows * columns < nplots) 
            stop("rows * columns too small")
    }
    total.columns <- columns
    total.rows <- rows
    f.col <- f.row <- 1
    if (show.given[1]) {
        total.rows <- rows + 1
        f.row <- rows/total.rows
    }
    if (have.b && show.given[2]) {
        total.columns <- columns + 1
        f.col <- columns/total.columns
    }
    opar <- par(mfrow = c(total.rows, total.columns), oma = if (have.b) 
        rep(5, 4)
    else c(5, 6, 5, 4), mar = if (have.b) 
        rep(0, 4)
    else c(0.5, 0, 0.5, 0), new = FALSE)
    on.exit(par(opar))
    plot.new()
    if (missing(xlim)) 
        xlim <- range(x[is.finite(x)])
    if (missing(ylim)) 
        ylim <- range(y[is.finite(y)])
    pch <- rep(pch, length = nobs)
    col <- rep(col, length = nobs)
    do.panel <- function(index, subscripts = FALSE) {
        istart <- (total.rows - rows) + 1
        i <- total.rows - ((index - 1)%/%columns)
        j <- (index - 1)%%columns + 1
        par(mfg = c(i, j, total.rows, total.columns))
        plot.new()
        plot.window(xlim, ylim, log = "")
        if (any(is.na(id))) 
            id[is.na(id)] <- FALSE
        if (any(id)) {
            grid(lty = "solid")
            if (subscripts) 
                panel(x[id], y[id], subscripts = id, col = col[id], 
                  pch = pch[id], ...)
            else panel(x[id], y[id], col = col[id], pch = pch[id], 
                ...)
        }
        if ((i == total.rows) && (j%%2 == 0)) 
            if (nlevels(x) > 0)
              axis(1, labels = levels(x), xpd = NA)
            else
              axis(1, xpd = NA)
        else if ((i == istart || index + columns > nplots) && 
            (j%%2 == 1)) 
            if (nlevels(x) > 0)
              axis(3, labels = levels(x), xpd = NA)
            else
              axis(3, xpd = NA)
        if ((j == 1) && ((total.rows - i)%%2 == 0))
            if (nlevels(y) > 0)
              axis(2, labels = levels(y), xpd = NA)
            else
              axis(2, xpd = NA)
        else if ((j == columns || index == nplots) && ((total.rows - 
            i)%%2 == 1))
            if (nlevels(y) > 0)
              axis(4, labels = levels(y), xpd = NA)
            else
              axis(4, xpd = NA)
        box()
    }
    if (have.b) {
        count <- 1
        for (i in 1:rows) {
            for (j in 1:columns) {
                id <- ((a.intervals[j, 1] <= a) & (a <= a.intervals[j, 
                  2]) & (b.intervals[i, 1] <= b) & (b <= b.intervals[i, 
                  2]))
                do.panel(count, subscripts)
                count <- count + 1
            }
        }
    }
    else {
        for (i in 1:nplots) {
            id <- ((a.intervals[i, 1] <= a) & (a <= a.intervals[i, 
                2]))
            do.panel(i, subscripts)
        }
    }
    mtext(xlab[1], side = 1, at = 0.5 * f.col, outer = TRUE, 
        line = 3.5, xpd = NA)
    mtext(ylab[1], side = 2, at = 0.5 * f.row, outer = TRUE, 
        line = 3.5, xpd = NA)
    if (length(xlab) == 1) 
        xlab <- c(xlab, paste("Given :", a.name))
    if (show.given[1]) {
        mar <- par("mar")
        nmar <- mar + c(4, 0, 0, 0)
        par(fig = c(0, f.col, f.row, 1), mar = nmar, new = TRUE)
        plot.new()
        nint <- nrow(a.intervals)
        pwoffs <- nint / 32
        plot.window(c(min(a.intervals[is.finite(a.intervals)] + pwoffs),
                      max(a.intervals[is.finite(a.intervals)]) - pwoffs),
                    0.5 + c(0, nint), log = "")
        rect(a.intervals[, 1], 1:nint - 0.5, a.intervals[, 2], 
            1:nint + 0.5, col = gray(0.95))
        if (!is.null(a.levels)) {
            mid <- apply(a.intervals, 1, mean)
            text(mid, 1:nint, a.levels)
            NULL
        }
        axis(3, labels = FALSE, tick = FALSE, xpd = NA)
        axis(1, labels = FALSE, tick = FALSE)
        box(col = "grey")
        mtext(xlab[2], side = 3, at = mean(par("usr")[1:2]), 
            line = 3, xpd = NA)
    }
    else {
        mtext(xlab[2], side = 3, at = 0.5 * f.col, line = 3.25, 
            outer = TRUE, xpd = NA)
    }
    if (have.b) {
        if (length(ylab) == 1) 
            ylab <- c(ylab, paste("Given :", b.name))
        if (show.given[2]) {
            nmar <- mar + c(0, 4, 0, 0)
            par(fig = c(f.col, 1, 0, f.row), mar = nmar, new = TRUE)
            plot.new()
            nint <- nrow(b.intervals)
            pwoffs <- nint / 32
            plot.window(0.5 + c(0, nint),
                        c(min(b.intervals[is.finite(b.intervals)] + pwoffs),
                          max(b.intervals[is.finite(b.intervals)]) - pwoffs),
                        log = "")
            rect(1:nint - 0.5, b.intervals[, 1], 1:nint + 0.5, 
                b.intervals[, 2], col = gray(0.95))
            if (!is.null(b.levels)) {
                mid <- apply(b.intervals, 1, mean)
                text(1:nint, mid, b.levels, srt = 90)
                NULL
            }
            axis(4, labels = FALSE, tick = FALSE, xpd = NA)
            axis(2, labels = FALSE, tick = FALSE)
            box(col = "grey")
            mtext(ylab[2], side = 4, at = mean(par("usr")[3:4]), 
                line = 3, xpd = NA)
        }
        else {
            mtext(ylab[2], side = 4, at = 0.5 * f.row, line = 3.25, 
                outer = TRUE, xpd = NA)
        }
    }
    if (length(missingrows) > 0) {
        cat("\nMissing rows:", missingrows, "\n")
        invisible(missingrows)
    }
}

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="test.asc"

RDA1
5 0
9 row.names
5 names
5 class
6 levels
3 cxt
2 0 0
1 0 0
5
-1
19 0 1
4
13 0 1
90
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 2
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 3
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 4
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
 5
2 0 0
1 0 0
4
-1
16 0 0
5
 3 WSA
 3 WSB
 3 WSC
 3 WSD
 3 WSE
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

13 0 1
90
 2
 2
 2
 2
 3
 4
 4
 4
 4
 5
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 2
 2
 2
 4
 4
 4
 4
 5
 5
 5
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 2
 2
 2
 4
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 4
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
 6
 1
 2
 2
 2
 3
 4
 4
 4
 5
 5
 6
 6
 6
 6
 6
2 0 0
1 0 0
4
-1
16 0 0
6
 2 Br
 2 Cr
 2 Ni
 3 PCP
 3 SRB
 3 URA
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

13 0 1
90
 1
 2
 4
 4
 4
 1
 2
 3
 4
 1
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 4
 4
 1
 2
 3
 4
 1
 3
 3
 4
 4
 1
 1
 1
 1
 1
 1
 1
 1
 1
 2
 2
 4
 4
 1
 2
 3
 4
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 2
 4
 1
 2
 3
 4
 3
 4
 1
 1
 1
 1
 1
 1
 1
 1
 2
 4
 4
 1
 3
 4
 3
 4
 1
 1
 1
 1
 1
2 0 0
1 0 0
4
-1
16 0 0
4
 1 1
 2 20
 2 21
 2 22
-1
2 0 0
1 0 0
3
-1
16 0 0
1
 6 factor
-1
-1
-1
-1

14 0 0
90
 0.88690446
 0.88690513
 -0.008582909999999999
 0.84140389
 0.01547746
 0.82645292
 0.82645427
 0.76571345
 0.8263521
 0.37570381
 0.40361484
 0.40384806
 0.74884711
 0.94859763
 0.96677452
 0.97557102
 0.9832513000000001
 0.98572282
 0.99349502
 0.11416688
 0.8122289
 0.11418351
 0.88183559
 0.09723225000000001
 0.88183561
 0.83853386
 0.83863709
 0.74681656
 0.83251071
 0.8454432
 0.75563716
 0.92634558
 0.84537136
 0.97884589
 0.73673004
 0.96747265
 0.97369701
 0.98715169
 0.9914865
 0.99328531
 0.99652316
 0.25447211
 0.30372693
 0.25373806
 0.30371362
 0.2327828
 0.25372631
 0.96173564
 0.97069235
 0.95462282
 0.95459587
 0.91341539
 0.98234451
 0.60740805
 0.77592908
 0.93602096
 0.9867878
 0.98751514
 0.99363163
 0.9859177
 0.83318812
 0.83308551
 0.95750996
 0.91218418
 0.91217945
 0.8623662
 0.90722619
 0.89806433
 0.546805
 0.9623669500000001
 0.97003306
 0.97554032
 0.98202711
 0.98297822
 0.98880629
 0.99688566
 0.80436417
 0.88417903
 0.80423433
 0.45605293
 0.95874106
 0.56694216
 0.95734593
 0.87062068
 0.96359899
 0.9355361
 0.9629377
 0.96566601
 0.9679529100000001
 0.9834591
-1

2 0 0
1 0 0
3
-1
16 0 0
1
 10 data.frame
-1
2 0 0
1 0 0
2
-1
16 0 0
4
 6 loc.id
 7 chem.id
 4 mode
 6 fitpar
-1
2 0 0
1 0 0
1
-1
16 0 0
90
 1 1
 1 2
 1 3
 1 4
 1 5
 1 6
 1 7
 1 8
 1 9
 2 10
 2 11
 2 12
 2 13
 2 14
 2 15
 2 16
 2 17
 2 18
 2 19
 2 20
 2 21
 2 22
 2 23
 2 24
 2 25
 2 26
 2 27
 2 28
 2 29
 2 30
 2 31
 2 32
 2 33
 2 34
 2 35
 2 36
 2 37
 2 38
 2 39
 2 40
 2 41
 2 42
 2 43
 2 44
 2 45
 2 46
 2 47
 2 48
 2 49
 2 50
 2 51
 2 52
 2 53
 2 54
 2 55
 2 56
 2 57
 2 58
 2 59
 2 60
 2 61
 2 62
 2 63
 2 64
 2 65
 2 66
 2 67
 2 68
 2 69
 2 70
 2 71
 2 72
 2 73
 2 74
 2 75
 2 76
 2 77
 2 78
 2 79
 2 80
 2 81
 2 82
 2 83
 2 84
 2 85
 2 86
 2 87
 2 88
 2 89
 2 90
-1
-1
-1
-1
-1
-1
-1

---1149173172-1804289383-983267779=:26068
Content-Type: TEXT/plain; NAME="coplot_sample.R"

load("test.asc")
mycoplot(cxt$fitpar ~ unclass(cxt$loc.id)|
         cxt$chem.id * cxt$mode,
         panel = points,
         bg = "blue",
         col = "blue",
         pch = 21,
         xlab = c("Location", "Contaminant"),
         ylab = c(label, "CXTFit-Mode"),
         ylim = c(0.6,1)
       )


coplot(cxt$fitpar ~ unclass(cxt$loc.id)|
         cxt$chem.id * cxt$mode,
         panel = points,
         bg = "blue",
         col = "blue",
         pch = 21,
         xlab = c("Location", "Contaminant"),
         ylab = c(label, "CXTFit-Mode"),
         ylim = c(0.6,1)
       )

---1149173172-1804289383-983267779=:26068--
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Feb 27 14:52:35 2001
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 27 Feb 2001 15:52:35 +0100
Subject: [Rd] Patch to coplot.R
In-Reply-To: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>
References: <200102270956.f1R9uGo26080@mafu.ws.chemie.tu-muenchen.de>
Message-ID: <15003.48947.624227.304611@gargle.gargle.HOWL>

>>>>> "Thomas" == Thomas Baumann <thomas.baumann@ch.tum.de> writes:

      ...

    Thomas> Please find attached a diff for coplot which you may want to
    Thomas> consider for the next release. 

Thank you, Thomas!

    Thomas> The diff is against R 1.2.2. 

unfortunately *not* :

-------- sorry for the excursion --- but I must say this loudly ---
	 {it's by far not the first time, and it's a real pain for us
 	 merging the code!}

  Please -- everyone -- do not consider the output

      > functionname

  (or ESS/Emacs C-c C-d)
  as the source of function  functionname.

  There is only one source, and that is in 
	R-<version>/src/library/<pkg>/R/<foobar>.R
  in our case in
	    R-1.2.2/src/library/base/R/coplot.R

  Again: 
    Please, please do NOT ever patch against the output of typing the
    function name, but please diff against the real source...


---------- end of excursion --------------------

    Thomas> Thanks for looking at the code.

I've been doing that for a bit, now ..


    Thomas> The reasons for this patch are:

    Thomas> 1. The boxes of coplot did not align very well with the panel
    Thomas> graphs if applied to a factor

hmm, well, that's also a matter of taste, but I tend to agree with your
choice (though it slightly complicates the code).

    Thomas> 2. Putting the levels as axis labels instead of just numbers
    Thomas> makes the plot more readable

yes, unless the levels happen to be 10-letter words -- which seems to
happen for some data / people. 
I think one should make this an option (on by default), and also consider using
abbreviate(levels(x), ...) 

    Thomas> I also include a sample dataset (test.asc) and a sample program
    Thomas> to show the differences.

thanks, these *were* useful.

Note however, that you changed more.
We had explicitly 
   - empty boxes when conditioning on  ordinal variables (aka factors)
   - gray boxes  when using "shingles", i.e. conditioning on continuous vars.

you have all boxes gray which I don't necessarily prefer.
(and you should say that you were changing this, too...).
One could consider using two different kinds of gray for the two,
very light gray for factors, darker one for `shingle bars'.

I'm a bit reluctant to change this; R has been a `ripe' piece of software
for a while and people don't necessarily want to see changes that they
can't easily revert.  Hence, the two bg colors (bar backgrounds) would
become function arguments as well....

opinions?

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas.baumann@ch.tum.de  Tue Feb 27 15:53:47 2001
From: thomas.baumann@ch.tum.de (thomas.baumann@ch.tum.de)
Date: Tue, 27 Feb 2001 16:53:47 +0100 (CET)
Subject: [Rd] Patch to coplot.R
In-Reply-To: <15003.48947.624227.304611@gargle.gargle.HOWL>
Message-ID: <200102271553.f1RFrm808369@norvel.ws.chemie.tu-muenchen.de>



On 27 Feb, Martin Maechler wrote:
> ---------- end of excursion --------------------

sorry for any inconvenience, the next patches will definitely be against
the real source.

> you have all boxes gray which I don't necessarily prefer.
> (and you should say that you were changing this, too...).
> One could consider using two different kinds of gray for the two,
> very light gray for factors, darker one for `shingle bars'.
> 
> I'm a bit reluctant to change this; R has been a `ripe' piece of software
> for a while and people don't necessarily want to see changes that they
> can't easily revert.  Hence, the two bg colors (bar backgrounds) would
> become function arguments as well....
> 
> opinions?

I fully agree with your opinion, since I do not like having all the
automatically generated diagrams looking different after an update. But
an easy option would be nice...

Thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From paul@stat.auckland.ac.nz  Tue Feb 27 22:13:09 2001
From: paul@stat.auckland.ac.nz (Paul Murrell)
Date: Wed, 28 Feb 2001 11:13:09 +1300
Subject: [Rd] Plotting points on a filled.contour plot (PR#857)
References: <200102270900.KAA23881@pubhealth.ku.dk>
Message-ID: <003501c0a10a$77f7b040$175dd882@stat.auckland.ac.nz>

Hi


> When adding points to a filled.contour plot they do not appear at the
correct
> coordinates.
> The following code demonstrates this.
>
> a<-expand.grid(1:20,1:20)
> b<-matrix(a[,1]+a[,2],20)
> filled.contour(x=1:20,y=1:20,z=b)
> points(10,10)


The problem here is that filled.contour is actually a combination of two
plots;  one is the filled contour and one is the legend.  filled.contour
sets up two separate coordinate systems for these two plots, but only does
so internally - once the function has returned these coordinate systems are
lost.  In order to access the coordinate system of the main contour plot you
can specify graphics commands in the plot.axes argument.  For example, in
your case, replace your call to filled.contour with the following, and all
is as it should be ...

filled.contour(x=1:20,y=1:20,z=b,plot.axes={axis(1);axis(2);points(10,10)})

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gilb@home.com  Wed Feb 28 15:43:19 2001
From: gilb@home.com (Paul Gilbert)
Date: Wed, 28 Feb 2001 10:43:19 -0500
Subject: [Rd] -malign-double
Message-ID: <3A9D1C96.FE7CF73A@home.com>

I was just looking at the documentation for g77 and noticed the
following, and also noticed that it is not used when fortran for a
package is compiled with the default (i.e. no Makefile in src
directory.)  Should it be considered?

Paul Gilbert
_____
`-malign-double'
     (Intel x86 architecture only.)

     Noticeably improves performance of `g77' programs making heavy use
     of `REAL(KIND=2)' (`DOUBLE PRECISION') data on some systems.  In
     particular, systems using Pentium, Pentium Pro, 586, and 686
     implementations of the i386 architecture execute programs faster
     when `REAL(KIND=2)' (`DOUBLE PRECISION') data are aligned on
     64-bit boundaries in memory.

     This option can, at least, make benchmark results more consistent
     across various system configurations, versions of the program, and
     data sets.

     *Note:* The warning in the `gcc' documentation about this option
     does not apply, generally speaking, to Fortran code compiled by
     `g77'.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Feb 28 18:44:26 2001
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 28 Feb 2001 19:44:26 +0100
Subject: [Rd] Re: [R] re: Spatial stats: R vs. Splus
In-Reply-To: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk>
References: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk>
Message-ID: <15005.18186.355531.588114@mithrandir.hornik.net>

>>>>> Paulo Justiniano Ribeiro writes:

> Hi Kenneth
> Depends on what you are looking for, concerning methods for spatial data.

> At CRAN you will find the packages:

> 1) spatial, by Venables & Ripley, as part of the bundle VR
> This packages does some geostatistical and point process analysis

> 2) splancs by Rowlings, Diggle and ported by  Bivand
> For point process

> 3) sgeostats by Majure and proted by Gedhardt
> For geostatistics

> And outside CRAN I know about:

> 4) geoR by Ribeiro and Diggle,
> For (model-based) geostatistics
> available at: www.maths.lancs.ac.uk/~ribeiro.geoR.html

Are there any plans for making this available via CRAN?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Timothy.Keitt@StonyBrook.Edu  Wed Feb 28 20:11:08 2001
From: Timothy.Keitt@StonyBrook.Edu (Timothy H. Keitt)
Date: Wed, 28 Feb 2001 15:11:08 -0500
Subject: [Rd] Re: [R] re: Spatial stats: R vs. Splus
References: <Pine.GSO.4.21.0102281517590.9133-100000@unixb.lancs.ac.uk> <15005.18186.355531.588114@mithrandir.hornik.net>
Message-ID: <3A9D5B5C.8010604@StonyBrook.Edu>

Nice package.  I second the motion (for CRAN).

T.

Kurt Hornik wrote:

>>>>>> Paulo Justiniano Ribeiro writes:
>>>>> 
>> 4) geoR by Ribeiro and Diggle,
>> For (model-based) geostatistics
>> available at: www.maths.lancs.ac.uk/~ribeiro.geoR.html
> 
> Are there any plans for making this available via CRAN?
> 

-- 
Timothy H. Keitt
Department of Ecology and Evolution
State University of New York at Stony Brook
Phone: 631-632-1101, FAX: 631-632-7626
http://life.bio.sunysb.edu/ee/keitt/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

