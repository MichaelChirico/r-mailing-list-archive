From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: Bugs in R-0.50-a1.
In-Reply-To: <9707290928.AA07210@alpha.luc.ac.be>
References: <9707290928.AA07210@alpha.luc.ac.be>
Message-ID: <199708011154.NAA20022@aragorn.ci.tuwien.ac.at>

>>>>> Patrick Lindsey writes:

> Problems in R but not in S:
> ---------------------------

> 1) 'unlist' seems to have several other problems than the ones
> reported up to now. For instance, 'unlist' can be used on almost any
> object in S without much trouble. Eg.:
S> unlist(c(2))
> 	[1] 2
S> 
> 	---
R> unlist(c(2))
> 	Segmentation fault (core dumped)
> This occurs in R-0.49 and in R-0.50-a1.

Confirmed.

> 1) The 'R Graphics' window does not have any X class or resource and
> therefore cannot be given a default size or geometry. Would it be
> possible to give the graphic window a class name so that the size
> could be specified in the '.Xdefaults' file?

Yes, that would be nice.

> 3) Some problems occur when using the help. Eg.,
R> ?"+"
> sorry, no help for "Arithmetic".
R> 
> This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
> any item contained in a help file starting with a capital letter.

The problem is as follows.  The function help() catches the special funs
like "+" etc (more precisely, the arithmetic, comparison, logic and
extract ones) and directly assigns a topic for them.

For "+", the topic is 'Arithmetic".  But the index file has no entry for
that, because (see RHOME/etc/install-help)

***********************************************************************
if [ $lib != 'base' ]
##-- The following is NOT done anymore in 'base':
##-- 1) Each help file should have  ALIAS(..) for  ALL it's objects
##-- 2) The  help file name may differ from _ANY_ object (eg 'Special')
then 
	for file in $FILES
	do
		echo "$file	$file"
	done
fi
***********************************************************************

If that really is the intended usage (Martin?), then e.g. the Arithmetic
file should also have ALIAS(Arithmetic) in it.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: R 0.50.a1 graphics
Message-ID: <199708011154.NAA20025@aragorn.ci.tuwien.ac.at>

Here are some misc comments on graphics.

* I am not sure whether `adj' works correctly.  When using e.g.

	title(sub = "SUBTITLE", adj = 0)

shouldn't the subtitle appear on the very left?  It seems that
justification is done off the middle of the plot window.

* S barplot has argument `horiz', R does not.

* More importantly, the barplot() argument `space' is treated
differently under R and S.

S has,

	the space (as a fraction of the average bar width) that
	should be left before each bar.
	This may be given as a single number or one number per bar.
	If `beside' is `TRUE', `space' may be specified by 2 numbers
	where the first is the space between bars in a set,
	and the second is the space between sets.

R has,

	the relative amount of space between the bars or groups of
	bars. The width of a bar (or group of bars) plus the value of
	space is one.

The S behavior is perhaps more useful, as it allows to have groups of
bars.

* The documentation for title() does not mention `sub'

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: R 0.50.a1 bug in do_title()
Message-ID: <199708011154.NAA20023@aragorn.ci.tuwien.ac.at>

There is an empty `else' clause in the code for do_title() in
src/main/plot.c (which results in subtitles appearing twice, or some
other strange thing ...).

Below is a `patch'.

-k

*** src/main/plot.c.orig	Fri Aug  1 10:17:41 1997
--- src/main/plot.c	Fri Aug  1 10:18:05 1997
*************** SEXP do_title(SEXP call, SEXP op, SEXP a
*** 1224,1231 ****
  
  	if (CAR(args) != R_NilValue && LENGTH(CAR(args)) > 0)
  		sub = CAR(args);
- 	else
- 		
  	args = CDR(args);
  
  	if (CAR(args) != R_NilValue && LENGTH(CAR(args)) > 0)
--- 1224,1229 ----
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 15:04:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 16:04:48 +0200
Subject: R-alpha: R-beta: RPM package for R
In-Reply-To: <199707292358.LAA18350@stat1.stat.auckland.ac.nz>
References: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
 <199707292358.LAA18350@stat1.stat.auckland.ac.nz>
Message-ID: <199708011404.QAA20492@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Martyn Plummer writes in r-announce:
>> A precompiled "RPM" binary of R-0.50.a1 is now available on CRAN for
>> installation on Linux systems which use the RedHat Package
>> Manager

> Before we get to may versions floating about ... 

> I had intended that these "a1", "a2" ... releases be hacker releases
> which will be followed by a R-0.50.stable release when the (worst)
> problems are sorted out.  Thats why I announced to "r-devel" rather
> than "r-announce".

> (Note this is information rather than any kind of policy statement,
> you are of course free to do whatever you like with R)

Sorry everyone,

This was mostly my mistake.  Martyn sent me an email that he had
uploaded the packages to CRAN incoming, and I was only in my office for
a few minutes, so without further thinking I moved them into CRAN/src
and told Martyn that I had done so and that he might announce the
packages now.

>From a user perspective, the bugs are perhaps not that bad (well, 
ignoring the shortest segfaulter `unlist(1)'), but anyway ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Aug  2 16:55:05 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 2 Aug 1997 17:55:05 +0200
Subject: R-alpha: Re: ?"+"; ALIAS(Arithmetic)
In-Reply-To: <199708011154.NAA20022@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 1 Aug 1997 13:54:36 +0200)
Message-ID: <199708021555.RAA14833@florence.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Patrick Lindsey writes:
    >> Problems in R but not in S: ---------------------------
    ......

    >> 3) Some problems occur when using the help. Eg.,
    R> ?"+"
    >> sorry, no help for "Arithmetic".
    R>
    >> This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
    >> any item contained in a help file starting with a capital letter.

    Kurt> The problem is as follows.  The function help() catches the
    Kurt> special funs like "+" etc (more precisely, the arithmetic,
    Kurt> comparison, logic and extract ones) and directly assigns a topic
    Kurt> for them.

    Kurt> For "+", the topic is 'Arithmetic".  But the index file has no
    Kurt> entry for that, because (see RHOME/etc/install-help)
			.......

    Kurt> If that really is the intended usage (Martin?), then e.g. the
    Kurt> Arithmetic file should also have ALIAS(Arithmetic) in it.

Yes, this is the thing to do.

It was R&R's idea to change the usage of  ALIAS(.).
[[Again: an ALIAS(..) should be made for  EVERY  R object that is
	 documented in that man file, and sometimes even for things such as
  Special or Arithmetic
]]

The current  etc/install-help  
was made by me in order to merge the former  install-help and
install-libhelp (Kurt, this answers another question of you) and
reflects the fact that the help files in the libraries have not (yet!?)
been adapted to the new scheme.

I think, we should decide to upgrade the help files of the libraries --
(eda & mva) and ALL the 'contrib' ones !! -- to the new scheme.

The only thing: The upgrade should happen  'SIMULTANEOUSLY'
such that a simple change to etc/install-help then would make things work.
A good time to do this would be  "about now", i.e. before another alpha
release and (somewhat ?) close to THE 0.50 beta relase...

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Aug  2 23:40:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Aug 1997 00:40:44 +0200
Subject: R-alpha: .RData zapped by system shutdown
Message-ID: <x2pvrw2opf.fsf@bush.kubism.ku.dk>


Watch:

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-1 (July 22, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

[Previously saved workspace restored]

Error: restore file corrupted -- no data loaded

---

-rw-r--r--   1 pd       users      0 Aug  1 12:46 /home/pd/R-sandbox/.RData

---

Aug  1 12:46:27 blackbird init: Switching to runlevel: 6
Aug  1 12:46:28 blackbird getty[197]: exiting on TERM signal

---

"Houston, we have a problem here".... As I remember, R was just
sitting in an xterm window doing nothing when the system was taken
down. This is weird, because as far as I can tell from the source, R
shouldn't try to save the workspace in an interactive session without
user confirmation. 

One possible scenario to explain it is that when the xterm got killed,
R's standard input was closed *and detached from the pty*, so that the
evaluation loop terminates, isatty(0) returns 0, forcing a save of the
GlobalEnv, during which the R process itself got terminated.

Fix? First of all, I suggest that the original .RData be rename()'d
before it is opened for writing (the backup may or may not be removed
afterwards). Secondly, do we really want this behaviour where isatty()
is called at a very late stage, or would we rather have the logic
depend on R_interactive? The cases to consider is when an interactive
session gets backgrounded, or loses its controlling terminal. And
shouldn't there be a signal handler for the TERM signal, to ensure
that things get wrapped up?

[Fortunately, the important bits of that workspace had been dumped out
previously, so I didn't lose much]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Aug  3 15:22:13 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Aug 1997 16:22:13 +0200
Subject: R-alpha: One-row frames don't work
Message-ID: <x2hgd7ny7d.fsf@bush.kubism.ku.dk>


While trying to write a half-decent predict.lm, I stumbled upon this
obstacle:

> data.frame(x=2)
  x
> data.frame(x=1:2)
     x
[1,] 1
[2,] 2

BTW, there really isn't a working predict() floating around, is there?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 10:47:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 11:47:35 +0200
Subject: R-alpha: 0.50-a1 -- "more lost comments"
Message-ID: <199708040947.LAA28328@sophie.ethz.ch>

In CHANGES, it says

------------------------------------------------------------
>> BUG FIXES

   ........

>>  o  Comments are handled better in functions.  The rule is that they
>>     are shifted to just before their statements.  Comments after the
>>     last statement of a function are lost.
------------------------------------------------------------
I think we could live with the above advertized behavior.
Unfortunately, in the following case 'xx1' even a comment BEFORE the last
statement is lost 
 ((because the last statement is so trivial ???,
   it is NOT lost in the  'xx1a' example  (and in others I tried)) :

This is in plain  0.50-a1 :

> xx1 <- function(x) {
+  ##--- a Start-comment ... (lost in 0.50-a1)
+  x
+ }
> xx1 
function (x) 
{
        x
}


> xx1a <- function(x) {
+   ##--- a Start-comment ... (ok in 0.50-a1)
+   x+1
+ }
> xx1a
function (x) 
{
        ##--- a Start-comment ... (ok in 0.50-a1)
        x + 1
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: pow_dd
Message-ID: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>

Hmm ... It seems that as of 0.50.a1 we need to link against f2c because
pow_dd is no longer provided (internally, POW_DD is used).  I am not
sure how much sense that really makes, but it would seem that getting
the things from 0.49 f2clib.c back would be great ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: `axes' argument for barplot()
Message-ID: <199708041115.NAA21208@aragorn.ci.tuwien.ac.at>

Clearly, barplot should have an `axes' argument.  The following trivial
patch does that ... pls apply.

-k

*** src/library/base/funs/barplot.orig	Sat Aug  2 15:58:44 1997
--- src/library/base/funs/barplot	Sat Aug  2 16:00:22 1997
***************
*** 1,7 ****
  "barplot" <-
  function (height, names.arg, col=NULL, border=par("fg"),
  	beside=FALSE, space=0.2, legend.text,
! 	main=NULL, xlab=NULL, ylab=NULL, xlim, ylim, ...)
  {
  	opar <- par(yaxs="i", xpd=TRUE)
  	on.exit(par(opar))
--- 1,7 ----
  "barplot" <-
  function (height, names.arg, col=NULL, border=par("fg"),
  	beside=FALSE, space=0.2, legend.text,
! 	main=NULL, xlab=NULL, ylab=NULL, xlim, ylim, axes = TRUE, ...)
  {
  	opar <- par(yaxs="i", xpd=TRUE)
  	on.exit(par(opar))
*************** function (height, names.arg, col=NULL, b
*** 68,72 ****
  			xjust=1, yjust=1)
  	}
  	title(main=main, xlab=xlab, ylab=ylab, ...)
! 	axis(2)
  }
--- 68,73 ----
  			xjust=1, yjust=1)
  	}
  	title(main=main, xlab=xlab, ylab=ylab, ...)
! 	if (axes)
! 		axis(2)
  }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: sd2rd version 0.1-5
Message-ID: <199708041115.NAA21212@aragorn.ci.tuwien.ac.at>

Oops,
Just found a typo.  Here's the updated version.
-k

***********************************************************************
#!/usr/bin/perl

$VERSION = "0.1-5";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &section(0, "SECTION(Side Effects @@"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &section(0, "SECTION($word[1] @@");
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par))) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: ???
Message-ID: <199708041115.NAA21213@aragorn.ci.tuwien.ac.at>

Is there any reason why the third argument to text() is called `text' in
R versus `labels' in S (I mean, other than that it makes more sense)?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: scale()
Message-ID: <199708041115.NAA21211@aragorn.ci.tuwien.ac.at>

Here is a version of the function scale() which may be worth adding to
the distribution.  No NA's yet, though.  And yes, I could also write
documentation if necessary ...

-k

***********************************************************************
scale <- function(x, center = TRUE, scale = TRUE) {
  x <- as.matrix(x)
  nc <- ncol(x)
  if (is.logical(center)) {
    if (center)
      x <- sweep(x, 2, apply(x, 2, mean))
  }
  else if (is.numeric(center) && (length(center) == nc))
    x <- sweep(x, 2, center)
  else
    stop("Length of center must equal the number of columns of x")
  if (is.logical(scale)) {
    if (scale)
      x <- sweep(x, 2, apply(x, 2, function (v)
			     sum(v^2) / max(1, length(v) - 1)), "/")
  }
  else if (is.numeric(scale) && length(scale) == nc)
    x <- sweep(x, 2, scale, "/")
  else
    stop("Length of scale must equal the number of columns of x")
  x
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: ports ...
Message-ID: <199708041115.NAA21209@aragorn.ci.tuwien.ac.at>

Just wanted to mention that I've more or less successfully completed
ports of the V&R library `class' (I hope I can also have lda and qda in
there soon) and the library `clus' by Anja Struyf, Mia Hubert, and Peter
J. Rousseeuw provided via the Journal of Statistical Software, volume 1.
For `clus', the plots needed to be rotated because R barplot does not
support the `horiz' argument yet (and having `scale' work as in S would
also be nice)

I've added the current versions into my r-contrib Debian package, and
will officially release them after 0.50 is out.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:35:42 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:35:42 +0200
Subject: R-alpha: Re: your mail
In-Reply-To: <Pine.LNX.3.96.970802190706.1843A-100000@buffy>
References: <199708011340.PAA20453@aragorn.ci.tuwien.ac.at>
 <Pine.LNX.3.96.970802190706.1843A-100000@buffy>
Message-ID: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Fri, 1 Aug 1997, Kurt Hornik wrote:
>> Thomas,
>> 
>> Could you add the "-lf2c" at the end of the line
>> @$(LD) $(SHLIBLDFLAGS) -o $(LIBNAME).so $(OBJS)
>> in acepack's src-c/Makefile?
>> 
>> I ran across an identical pow_dd problem recently with another package.
>> Did we always need the "-lf2c", or is this a feature of the new version?
>> 

> This is very strange.  My copy works ok as is, in all the versions of
> R I have installed (including 0.50a1). On the other hand, using nm
> reveals that R0.50 has replaced pow_dd and pow_di by f77_pow_dd and
> f77_pow_di respectively.  It looks like the builtin subset of libf2c
> has vanished.  This is a problem, as we should not require people to
> have f2c in order to run the C version of the library -- after all, if
> they had f2c they could run the FORTRAN version.

You're right, see also one of my previous mails.  They now have POW_DD
and f77_pow_dd (where does this come from, anyway).  I think that in the
``old days'' we were lucky that everything was based on C, so FORTRAN
was converted using f2c and compatibility functions were provided by the
distribution proper.  Of course, in general one cannot expect that ALL
functions needed after using f2c would be in a compatibility library,
unless it was identical to libf2c ...

But clearly, pow_dd and pow_di should exist again ...

> I'll also do the version numbers.  I should probably regenerate all
> the help files, and there may also be more changes to survival4 now
> that array subsetting works properly.  Unfortunately the test file now
> doesn't work, as R batch mode terminates on errors, and the file stops
> at the first unimplemented feature.

O.k., no problem.  As long as there are packages maintained by me
without version numbers ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:02:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:02:08 +0200
Subject: R-alpha: scale()
In-Reply-To: <199708041115.NAA21211@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 4 Aug 1997 13:15:54 +0200)
Message-ID: <199708041302.PAA28454@sophie.ethz.ch>

Lieber Kurt,

vielen Dank f=FCr Deine neuen  R Funktionen,...
Ja, die scheinen n=FCtzlich.

Was Du vergessen (oder extra nicht gesagt) hast:

=09Die Funktionen existieren in S(-plus).

Ich wuerde dies doch erw=E4hnen in Deinen 'Posts' als Motivation, wieso
=FCberhaupt...

Und, ideal w=E4re schon, gerade ein shar-file zu bekommen, welches in
in RHOME  oder  RHOME/src/library/base
ausgepackt w=FCrde, und sowohl   funs/FOO  als auch  man/FOO  enthielte,
das 'man' inklusive EXAMPLES(.)...

  [dann k=F6nnte auch ich die Funktionen in den Source tree installieren...=
]

--
Martin=
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:10:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:10:50 +0200
Subject: R-alpha: Re: pow_dd & pow_di [was f2clib.c  etc..] --  yes, please !
In-Reply-To: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 4 Aug 1997 13:35:42 +0200)
Message-ID: <199708041310.PAA28457@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Thomas Lumley writes:
    >> On Fri, 1 Aug 1997, Kurt Hornik wrote:
    >>> Thomas,
    >>> 
    >>> Could you add the "-lf2c" at the end of the line @$(LD)
    >>> $(SHLIBLDFLAGS) -o $(LIBNAME).so $(OBJS) in acepack's
    >>> src-c/Makefile?
    >>> 
    >>> I ran across an identical pow_dd problem recently with another
    >>> package.  Did we always need the "-lf2c", or is this a feature of
    >>> the new version?
    >>> 

    >> This is very strange.  My copy works ok as is, in all the versions
    >> of R I have installed (including 0.50a1). On the other hand, using
    >> nm reveals that R0.50 has replaced pow_dd and pow_di by f77_pow_dd
    >> and f77_pow_di respectively.  It looks like the builtin subset of
    >> libf2c has vanished.  This is a problem, as we should not require
    >> people to have f2c in order to run the C version of the library --
    >> after all, if they had f2c they could run the FORTRAN version.
yep
    Kurt> You're right, see also one of my previous mails.  They now have
    Kurt> POW_DD and f77_pow_dd (where does this come from, anyway).  I
    Kurt> think that in the ``old days'' we were lucky that everything was
    Kurt> based on C, so FORTRAN was converted using f2c and compatibility
    Kurt> functions were provided by the distribution proper.  Of course,
    Kurt> in general one cannot expect that ALL functions needed after
    Kurt> using f2c would be in a compatibility library, unless it was
    Kurt> identical to libf2c ...

    Kurt> But clearly, pow_dd and pow_di should exist again ...

Even more: I think it's just these two which should 
	'officially' part of the R binary, i.e., their sourc should be in
	src/main/  or src/math/  rather than in appl  or somewhere.

I think there are several instances in the current  R source tree, where
the code could be improved by using  pow_d{d|i}(..).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug  4 14:13:03 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Aug 1997 15:13:03 +0200
Subject: R-alpha: scale()
In-Reply-To: Martin Maechler's message of Mon, 4 Aug 1997 15:02:08 +0200
References: <199708041302.PAA28454@sophie.ethz.ch>
Message-ID: <x2n2my2isg.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Lieber Kurt,
> 
> vielen Dank für Deine neuen  R Funktionen,...
> Ja, die scheinen nützlich.
> 
> Was Du vergessen (oder extra nicht gesagt) hast:
...

- und was Du vergisst ist dein CC:-header zu redigieren.... 

§;^{)>

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:15:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:15:34 +0200
Subject: R-alpha: Excuse the German post to R-devel...
Message-ID: <199708041315.PAA28466@sophie.ethz.ch>

it was intented to just go to Kurt..

Excuse again...	Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 17:15:49 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 18:15:49 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708041615.SAA28741@sophie.ethz.ch>

I am sorry that this IS an old topic.
Yet another task
I think the bug is somewhere in hidden  in  src/main/options.c ..

##-- The following does not work as it should in  R (0.50-a1, but I think
							also earlier)

tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
tst()
tst(dig = 12)


##-- This should do the same; it works as expected in R & S :

tst2 <- function(x=pi, dig =3) {
  oo <- options(digits=dig); on.exit(oo); print(x);x}
tst2()
tst2(dig = 12)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug  4 18:36:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Aug 1997 19:36:24 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: Martin Maechler's message of Mon, 4 Aug 1997 18:15:49 +0200
References: <199708041615.SAA28741@sophie.ethz.ch>
Message-ID: <x2g1spq293.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> I am sorry that this IS an old topic.
> Yet another task
> I think the bug is somewhere in hidden  in  src/main/options.c ..
> 
> ##-- The following does not work as it should in  R (0.50-a1, but I think
> 							also earlier)
> 
> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
> tst()
> tst(dig = 12)
> 
> 
> ##-- This should do the same; it works as expected in R & S :
> 
> tst2 <- function(x=pi, dig =3) {
>   oo <- options(digits=dig); on.exit(oo); print(x);x}
                               ^^^^^^^^^^^
                           on.exit(options(oo))

> tst2()
> tst2(dig = 12)

I'm not sure this is a bug at all, given the scoping rules, etc.
However, things are strange. Consider the following:

> f<-function(){print(a$b);a$b<-pi;print(a$b)}
> f()
[1] 2
[1] 2
> f<-function(){print(a$b);a<-a;a$b<-pi;print(a$b)}
> f()
[1] 2
[1] 3.141593

The difference is that in the first case, a is in .GlobalEnv, and not
modifiable with "<-" ("<<-" works). Apparently, "$<-" won't
automatically create a copy of a in the current environment which is
what I had expected. Still, creating .Options explicitly in tst()
doesn't work, which fact is probably due to the digits argument in
print.default defaulting to NULL, and print.default has no reason to
look on the frame stack for .Options.

However, changing the print.default definition to

print.default<-function (x, digits = eval(expression(.Options$digits),
sys.frame(sys.parent())), quote = TRUE, na.print = NULL, print.gap = NULL) 
{
        .Internal(print.default(x, digits, quote, na.print, print.gap))
}

*and*

tst<-function (x = pi, dig = 3) 
{
        .Options <- .Options
        .Options$digits <- as.integer(dig)
        print(x)
        x
}


does seem to do what you wanted...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug  4 23:12:38 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 10:12:38 +1200 (NZST)
Subject: R-alpha: pow_dd
In-Reply-To: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>
References: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>
Message-ID: <199708042212.KAA12791@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > Hmm ... It seems that as of 0.50.a1 we need to link against f2c because
 > pow_dd is no longer provided (internally, POW_DD is used).  I am not
 > sure how much sense that really makes, but it would seem that getting
 > the things from 0.49 f2clib.c back would be great ...

I was worried about name conflicts with systems which do not follow
the f77/f2c standard.  I will put these back the old way and make it
possible to #define NONSTANDARD_F77LIBS or somesuch to get the new
effect if it is needed.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug  4 23:34:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 10:34:14 +1200 (NZST)
Subject: R-alpha: Re: pow_dd & pow_di [was f2clib.c  etc..] --  yes, please !
In-Reply-To: <199708041310.PAA28457@sophie.ethz.ch>
References: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at>
 <199708041310.PAA28457@sophie.ethz.ch>
Message-ID: <199708042234.KAA14790@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
 > Even more: I think it's just these two which should 
 > 	'officially' part of the R binary, i.e., their sourc should be in
 > 	src/main/  or src/math/  rather than in appl  or somewhere.
 > 
 > I think there are several instances in the current  R source tree, where
 > the code could be improved by using  pow_d{d|i}(..).

I think that there are two problems here.

 1. Providing support for functionality in the R core (all C code).

 2. Supporting code in external libraries (mainly f77).

I think it might be useful to keep these problems separate.

We can certainly put in support for a wider range of "pow" functions
and any other math functions.  Putting these in the "math" library
seems natural.

One possible solution to the second problem would be to declare that R
will work with f2c generated code and anything compatible with it.
This is pretty extreme though.  On more exotic platforms it would be
nice to use custom blas etc.

Better dyn.load support is on the way (complements of GNU dld 4) and
this may well solve problem 2 above.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug  5 01:20:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 4 Aug 1997 17:20:18 -0700 (PDT)
Subject: R-alpha: f2c compatibility
In-Reply-To: <199708042234.KAA14790@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970804171330.10278A-100000@chekov>

On Tue, 5 Aug 1997, Ross Ihaka wrote:
> I think that there are two problems here.
> 
>  1. Providing support for functionality in the R core (all C code).
> 
>  2. Supporting code in external libraries (mainly f77).
> 
> I think it might be useful to keep these problems separate.
> 

I agree. I don't think it is necessarily a good idea for R to contain all
of libf2c that we might want to use.  My question was much simpler: 

Should we assume in creating libraries with C translations of FORTRAN that
ld -lf2c works, or should we explicitly include the C source for functions
that we call (as R does with pow_dd and pow_di)?


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Aug  5 06:00:03 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 17:00:03 +1200 (NZST)
Subject: R-alpha: Version 0.50-a1 patches
Message-ID: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>

A set of patches for R-0.50-a1 is now available as
	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
The patches mainly fix problems reported since R-0.50-a1 but some
older problems are also fixed.

Here is the list of changes.
	Ross

 o  Many subsetting and mutation problems with the new "expression" type
    have now been fixed.

 o  When ask=T is set in par() the user is instructed
	"Press <Return> for next plot:"
    rather than asked
	"Next Plot?"

 o  The infinite recursion observed by in Kurt Hornik in:
	R> test2
	function (x) 
	{
		attr(x, "call") <- sys.call()
		x
	}
	R> test2(x)
	Error: stack overflow
    has been cured.  There may be one or two more of these.  All the
    xxxx<- functions should be checked.

 o  Patches from Benjamin Bolker to cure some line type problems has
    been applied.

 o  Fixed the t(table(0)) problem (1-d arrays not quite handled right).

 o  Changed naming back so that pow_dd etc are available.

 o  Patches to barplot and text from Kurt Hornik.

 o  When x was a data frame,
	mode(x) <- "character"
	x
    caused a crash.  This was because a class of "data.frame"
    was being attached to a character vector.  Now only lists
    can become data frames.

 o  There is now a -gdb option to the R front end as well as -xxgdb.

 o  Documentation of NChisquare fixed.

 o  Definition of S_alloc fixed.

 o  Changed the names of seeds_in and seeds_out to seed_in and
    seed_out as per Kurt's request.

 o  "unlist(c(2))" fixed.

 o  "data.frame(x=2)" fixed.

 o  Bug in do_title fixed.

 o  Scoping for subset methods by forcing an eval of the args on
    entry fixed (bug reported by Patric Lindsay).

 o  subsetting of data frames fixed .

 o  Misc problems in Rdoc.sty reported by Kurt Hornik fixed.
 
 o  Permissions in the data subdir for quakes and sunspots fixed.

 o  Segfault in dimnames mutation
	R> x <- 1:5
	R> dimnames(x)[1,2] <- NULL
    fixed.

 o  It was observed that
	> D(expression(z * (log(z) /z)), "z")
    returns
	(log(z)/z) + z * (1/z/z - log(z)/z^2)
    This is exactly what S-Pus produces.

 o  Added the option -B 8192 to m4 in the etc/doc2* files to keep
    m4 happy.

 o  New functions "as.ordered", "data.class" and "scale" from, Kurt
    Hornik added.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug  5 10:55:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Aug 1997 11:55:58 +0200
Subject: R-alpha: Version 0.50-a1 patches
In-Reply-To: Ross Ihaka's message of Tue, 5 Aug 1997 17:00:03 +1200 (NZST)
References: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
Message-ID: <x2sowp3qdt.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> A set of patches for R-0.50-a1 is now available as
> 	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
> The patches mainly fix problems reported since R-0.50-a1 but some
> older problems are also fixed.
..
>  o  It was observed that
> 	> D(expression(z * (log(z) /z)), "z")
>     returns
> 	(log(z)/z) + z * (1/z/z - log(z)/z^2)
>     This is exactly what S-Pus produces.

Heyheyheyheeeyyy, no need to resort to name calling, next thing,
you'll be talking about Windoze, HP-SUX, and Slowlaris! ;)

>  o  New functions "as.ordered", "data.class" and "scale" from, Kurt
>     Hornik added.
[The end]

Hmm. The "move .RData before writing to it" fix didn't seem to make
it. It's a one-liner (in the most primitive version), and really quite
important. Actually, the problem is worse than I thought initially:
.RData can get zapped to a zero-length file whenever you destroy the
xterm window containing R, not only on system shutdown. This happens
on both of my Linux boxes, but it's probably a quite generic race
condition.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 11:44:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 12:44:48 +0200
Subject: R-alpha: Version 0.50-a1 patches -- New and old bugs..
In-Reply-To: <199708050500.RAA08160@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 5 Aug 1997 17:00:03 +1200 (NZST))
Message-ID: <199708051044.MAA00635@sophie.ethz.ch>

Thank you !
~~~~~~~~~~~

The new patches
	 (which incidentally make  0.50-a1 into  0.50-a2
	  IF you run ./configure)
really do quite a few good things.

A few comments.

1) I had to do the following to make things compile and link properly

   in	appl/cpoly.c :  line  42 : OUT-commented  (pow_di) 
   otherwise compiler barfed about redefined  pow_di	[Solaris 2.5, Sun cc]

2) In order for 'legend' and 'barplot' to work I had to edit
	src/library/base/funs/legend: 
   Last line: replace 'text=' by 'labels='  [reflect change of text(...)]

NOTE: After applying the patch, I recommend the following

    make clean
    configure
    make
    make install
    make tests install-latex install-help install-html

---------------------
Further notes:

3) Whereas  unlist(1), unlist(c(2)), etc. work,
   the two unlist problems that Kurt reported about,
   especially

    l.ex <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
    unlist(l.ex) #-- still in 0.50-a2
    ##- INTERNAL ERROR: ans_nnames = 10    ans_length = 12
    ##- Error: incorrect names vector length

 still exist. {Nobody claimed otherwise}


4) The parser problem reported by Patrick Lindsey remains :

  ##- From: Patrick Lindsey <plindsey@luc.ac.be>
  ##- Date: Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
  ##- To: r-devel@stat.math.ethz.ch (R list)
  ##- Subject: R-alpha: Bugs in R-0.50-a1.
  ##-
  ##- Problems in R but not in S:
  ##- ---------------------------

  ##- 2) Problem with the parser: When a function contains a condition
  ##- between brackets the closing bracket must be adjacent to the last item
  ##- in R but not in S. Here is an example:
  ##- 	S> new <- function (x,y,z,k) {
  ##- 	S+ message <- list(x,y,a=if(z) k
  ##- 	S+ )
  ##- 	S+ message
  ##- 	S+ }
  ##- 	S>
  ##- 	---
  ##- 	R> new <- function (x,y,z,k) {
  ##- 	R+ message <- list(x,y,a=if(z) k
  ##- 	R+ )
  ##- 	)
  ##- 	^
  ##- 	Error: syntax error
  ##- 	R>
  ##- This occurs in R-0.49 and in R-0.50-a1, R-0.50-a2

  new <- function (x,y,z,k) {
    message <- list(x,y, a=if(z) k
		    )
  }

---------------------------------------------------------------------------
I think I found one  NEW bug  (a1 -> a2):
		     =======
  	options(digits = ...) fails to work AT ALL in a 'local environment'

which makes even my  tst2()  function 'fail' :
  

 p0 <- (0:2)/1000 ; p <- p0 + 1e-10
 p
 ## Fails in 0.50-a2, (NOT in 0.50-a1, I think):
 for(d in 1:20) { options(digits=d); cat(d,": ", p,";\t",p0, "  ");print(p)}
 options(digits=7)
 ## Now,the print(.) at least works:
 for(d in 1:20) { options(digits=d); cat(d,": ", p,";",p0, "  ");print(p,dig=d)}

 ##-- The following does not work as it should in  R (0.50-a1, maybe earlier)
 tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
 tst()
 tst(dig = 12)
 ##-- This should do the same; works as expected in S & R-0.50-a1, NOT in -a2:
 tst2 <- function(x=pi, dig =3) {
   oo <- options(digits=dig); on.exit(options(oo)); print(x);x}
 tst2()
 tst2(dig = 12)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 14:02:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 15:02:11 +0200
Subject: R-alpha: R-0.50-a{1|2} : Yet another shortest SEGFAULT  --- + PATCH
Message-ID: <199708051302.PAA00761@sophie.ethz.ch>

[ already in 0.50-a1 ]

is.loaded(1) gives a SEGFAULT.

----------------------------------------
Here is the patch :


--- src/main/dotcode.c~	Thu Jun  5 03:07:00 1997
+++ src/main/dotcode.c	Tue Aug  5 14:57:15 1997
@@ -434,7 +434,7 @@
 
 	checkArity(op, args);
 	if(!isString(CAR(args)) || length(CAR(args)) < 1)
-		errorcall(call, "invalid argument");
+		errorcall(call, "invalid argument\n");
 
 	p = CHAR(STRING(CAR(args))[0]);
 	q = buf;
@@ -459,6 +459,8 @@
 	char *sym;
 	int val;
 	checkArity(op, args);
+	if(!isString(CAR(args)) || length(CAR(args)) < 1)
+		errorcall(call, "invalid argument\n");
 	sym = CHAR(STRING(CAR(args))[0]);
 
 	val = 1;
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug  5 14:14:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 5 Aug 1997 15:14:32 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: <x2204gg2mf.fsf@bush.kubism.ku.dk>
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
 <x2204gg2mf.fsf@bush.kubism.ku.dk>
Message-ID: <199708051314.PAA22117@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> Ross and I have been back and forth on this one a few times already;
>> it's probably a faq (Kurt);
>                 ^^^^^

> This belongs on the *manual page*. I suggest something along these
> lines:

> NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
> get values of LANG(x) and LANG(y) looked up in the environment
> LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
> LANG(expr) is usually a simple variable ITALIC(containing) an
> expression to evaluate or a LANG(substitute(...)) call
> ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
> passed to the evaluator.
> )

Perhaps as a compromise, we could put something like the above into the
man page, AND I'll add something in the FAQ?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug  5 14:40:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Aug 1997 15:40:40 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: Kurt Hornik's message of Tue, 5 Aug 1997 15:14:32 +0200
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
 <x2204gg2mf.fsf@bush.kubism.ku.dk>
 <199708051314.PAA22117@aragorn.ci.tuwien.ac.at>
Message-ID: <x2n2mw4ujr.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Peter Dalgaard BSA writes:
> 
> > Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
> >> Ross and I have been back and forth on this one a few times already;
> >> it's probably a faq (Kurt);
> >                 ^^^^^
> 
> > This belongs on the *manual page*. I suggest something along these
> > lines:
> 
...
> 
> Perhaps as a compromise, we could put something like the above into the
> man page, AND I'll add something in the FAQ?

Certainly. A "Fine points" section in the FAQ would be very nice
indeed. It could contain several items of the "looks wrong, but isn't"
variety as well as "debatable, but it was done this way, because..."
and "bug compatible with S-Plus". 

On the other hand, the FAQ might not be the preferred document for
online help during programming, whereas the manpages would typically
be the first place to look. Therefore, it is a very good idea to put a
terse description of any counterintuitive behaviour on the man page. 

One could probably argue that the man page addition that I suggested
is a bit on the verbose side. "That won't work, do this instead"
should suffice on the man page, whereas a fuller explanation could go
in the FAQ.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 15:22:24 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 16:22:24 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: <x2n2mw4ujr.fsf@bush.kubism.ku.dk> (message from Peter Dalgaard
 BSA on 05 Aug 1997 15:40:40 +0200)
Message-ID: <199708051422.QAA18877@sophie.ethz.ch>

If you look at the new  'eval' man page that comes with the  a1-->a2
patches, you see that R or R has added a paragraph that somewhat resembles
your proposal.

PD> This belongs on the *manual page*. I suggest something along these
PD> lines:

PD> NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
PD> get values of LANG(x) and LANG(y) looked up in the environment
PD> LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
PD> LANG(expr) is usually a simple variable ITALIC(containing) an
PD> expression to evaluate or a LANG(substitute(...)) call
PD> ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
PD> passed to the evaluator.
PD> )

They don't use any pejorative words such as "counterintuitive" though... ;-)

help(eval)>  The expression expr is evaluated in the environment
help(eval)>  that eval is called from. This allows you to assign
help(eval)>  complicated expressions to symbols and then evaluate
help(eval)>  them. If you want to evaluate expr in envir then you
help(eval)>  must wrap a call to expression around it.
	
  and later

help(eval)> 	Examples:

	     ....

help(eval)> 	     tst.ev <- function(a = 7) { x <- pi; y <- 1; ev() }
help(eval)> 	     ev <- function() {
help(eval)> 	          e1 <- sys.frame(sys.parent())
help(eval)> 	          ## Evaluate a in e1
help(eval)> 	          aa <- eval(expression(a),e1)
help(eval)> 	          ## evaluate the expression bound to a in e1
help(eval)> 	          a <- expression(x+y)
help(eval)> 	          list(aa = aa, eval = eval(a, e1))
help(eval)> 	     }
help(eval)> 	     tst.ev()#-> aa : 7,  eval : 4.14
	
	[R&R: The example was improved by me:  
	      ALL examples should be self-contained executable !]

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Tue Aug  5 21:28:49 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 6 Aug 1997 08:28:49 +1200 (NZST)
Subject: R-alpha: Environment strangeness
Message-ID: <199708052028.IAA20017@stat1.stat.auckland.ac.nz>


I'd already adjusted the man pages before Peter's suggestion came along
and was too lazy/buzy to change it again. Most of the reason I suggested
the faq was that Ross and I really have changed this one back and forth
a lot; each time it seems like the change is the right thing to do. But
we're now convinced that this is correct. Putting it in writing in a few
places should hopefully make it easier to remember that it's correct.

We're having some real problems synchronizing work on bug reports and
will probably need to set up something more automatic. This is probably
going to involve a separate email address (or special subject) so we
can pull them out and put them in a list that everyone involved can
work off of that without duplication of fixes.


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:39 +0200
Subject: R-alpha: Version 0.50-a1 patches
In-Reply-To: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
References: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
Message-ID: <199708061106.NAA22856@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> A set of patches for R-0.50-a1 is now available as
> 	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
> The patches mainly fix problems reported since R-0.50-a1 but some
> older problems are also fixed.

> ...

>  o  New functions "as.ordered", "data.class" and "scale" from, Kurt
>     Hornik added.

Almost.  `scale' seems to be missing ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:38 +0200
Subject: R-alpha: R 0.50.a2
Message-ID: <199708061106.NAA22853@aragorn.ci.tuwien.ac.at>

Here's a trivial patch (Martin!).
-k

--- src/library/base/man/Arithmetic.orig	Tue Aug  5 22:33:16 1997
+++ src/library/base/man/Arithmetic	Tue Aug  5 22:35:51 1997
@@ -15,6 +15,7 @@
 ALIAS(^)
 ALIAS(%%)
 ALIAS(%/%)
+ALIAS(Arithmetic)
 VALUE(
 These binary operators perform arithmetic on vector objects.
 They return numeric vectors containing the result of the element
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:39 +0200
Subject: R-alpha: R color problem
Message-ID: <199708061106.NAA22855@aragorn.ci.tuwien.ac.at>

There seems to be a small problem with the S-compatible small numbers
color specification, colors 0 and 2 are the same.

Have a look at e.g.
	barplot(rbind(1:3, 1), col = c(0,2))

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:38 +0200
Subject: R-alpha: R 0.50.a2 shortest segfault ...
Message-ID: <199708061106.NAA22854@aragorn.ci.tuwien.ac.at>

This time, it seems that
	browser()
wins.  Grr ...
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug  6 14:04:59 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 06 Aug 1997 15:04:59 +0200
Subject: R-alpha: R 0.50.a2 shortest segfault ...
In-Reply-To: Kurt Hornik's message of Wed, 6 Aug 1997 13:06:38 +0200
References: <199708061106.NAA22854@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb6fa2dg.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> This time, it seems that
> 	browser()
> wins.  Grr ...

On a related note, other bottom-level things act strangely:

> sys.parent()
Error: failed to match environments
> sys.nframe()
Error: failed to match environments
> sys.frame(0)
Error: failed to match environments

The 1st might make sense (I'd prefer it to return NULL whenever n is
bigger than the stack height, rather than error out), but the 2nd
should return 0 and the 3rd the R_GlobalEnv as it does on any other
levels.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug  6 14:16:11 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 06 Aug 1997 15:16:11 +0200
Subject: R-alpha: Re: R 0.50.a2 - unlist() still broken
In-Reply-To: Kurt Hornik's message of Wed, 6 Aug 1997 13:06:38 +0200
References: <199708061106.NAA22853@aragorn.ci.tuwien.ac.at>
Message-ID: <x2wwlza1us.fsf@bush.kubism.ku.dk>


You still can't unlist() a regression object:

x<-rnorm(3)
y<-rnorm(3)+x
o<-lm(y~x)
unlist(o)
ou<-unclass(o)
ou
unlist(ou)

Part of the explanation seems to be contained in

unlist(list(1,2,3,4))
unlist(list(1,2,3,4,"a"))
unlist(list(1,2,3,4,x~y))

and also in

unlist(list(x~y))



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug  6 14:54:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 Aug 1997 15:54:56 +0200
Subject: R-alpha: R color problem  (col=0 is wrong; col=1 S incompatible)
In-Reply-To: <199708061106.NAA22855@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 6 Aug 1997 13:06:39 +0200)
Message-ID: <199708061354.PAA01946@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> There seems to be a small problem with the S-compatible small
    Kurt> numbers color specification, colors 0 and 2 are the same.

    Kurt> Have a look at e.g.  barplot(rbind(1:3, 1), col = c(0,2))

I had reported this problem  even more extensively in R-help (not R-devel),
since I thought it important to be known by everyone:

Here is the relevant part (in R-help, I went further with a wish...):

MM> Date: Mon, 14 Jul 1997 15:07:19 +0200
MM> From: Martin Maechler <maechler@stat.math.ethz.ch>
MM> To: R-help@stat.math.ethz.ch
MM> Subject: R-beta: Plotting: numeric 'col' colors;  col=0, col=1, ..

MM> ``We all know''
MM>  that R has more flexible and nicer color specifications than S-plus.

MM> There are situations however, where I'd like to specify colors numerically,
MM> e.g.
MM> 	1) convenience of using different colors in a for(.) loop
MM>  or
MM> 	2) backward compatibility with S.
MM> 
MM> In S, there's the quite known  ``standard''
MM> 
MM> 	col = 0  :<==>   current background color	[ = white by default]
MM> 	col = 1  :<==>   current foreground color, ie. default color. [ = black]
MM> 
MM> In R, this is currently different:
MM> 
MM> col = 0 is the same as  col = 2  
MM> 	which maybe rather an accident than anything else.
MM> col = 1 however takes a different color than the current foreground
MM> 	-- which can be NICE  in certain situations, where we'd rather have
MM> 	   points / lines  in a different color than the default foreground
MM> 	On the other hand, I think  "S compatibility" is more important here.
MM> 
MM> I assume that it's not too hard to change the 
MM> ``numeric color'' map such as to get S compatibility.

Yes, I still think it would be nice if this was changed...

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug  6 17:41:37 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 6 Aug 1997 09:41:37 -0700 (PDT)
Subject: R-alpha: browser()
In-Reply-To: <199708060311.PAA14297@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970806093214.2623A-100000@zen>


Kurt pointed out that
R> browser() 
is now the shortest segfault.  The problem is in do_browser in main.c at
about line 420:
       if( !DEBUG(rho) ) {
                cptr=R_GlobalContext;
                while (cptr->callflag != CTXT_RETURN) 
                        cptr = cptr->nextcontext;
                Rprintf("Called from: ");
                PrintValueRec(cptr->call);
        }
When browser() is called from the top level rather than from a function we
have cptr->callflag==CTXT_TOPLEVEL, so the test succeeds, but as there are
no other contexts we have cptr->nextcontext==NULL and a segfault.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Aug  6 21:59:51 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 6 Aug 1997 15:59:51 -0500 (CDT)
Subject: R-alpha: Re: R-beta: ?faq example of scoping
In-Reply-To: <199708062021.IAA21936@stat1.stat.auckland.ac.nz> from "Robert Gentleman" at Aug 7, 97 08:21:01 am
Message-ID: <9708062059.AA08076@nokomis.stat.umn.edu>

Robert Gentleman wrote:
> 
>  I like Thomas' example. Kurt can you include it in the FAQ. 
>  
>  Recently I have been doing a lot of programming that has required either
>  optimization or zero-finding. Unfortunately most of the functions need
>  some arguments to be optimized over and have other parameters that depend on
>  the data but are fixed with respect to optimization. With R scoping rules
>  this is a trivial problem; simply make up the function with the required
>  definitions in the same environment and scoping takes care of it. With
>  Splus my solution has been to add an extra parameter to the function and
>  to the optimizer to pass in these extras. That's fine for optimizers I 
>  write myself but it doesn't work for the builtin ones. Fortunately I haven't
>  yet found a one-d problem that some thought and bisection won't take care
>  of.
>  
>  robert
>  

There might also be some use for a clean dynamic scoping mechanism to
to make it easier to make things like the minimizers in optimize.c
reentrant.  In 0.49 at least they use a static variable, and I think
things would go bad if they were called recursively. THis may not be
likely for a minimizer, but it would be very reasonable for an
integrator. You could save previous values of the globals on the C
stack, but with the need to provide protection for non-local exits on
errors this can get messy. A dynamic binding mechanism, preferably
with a separate name space like dynamic-bind stuff in Scheme, would
make this easier.

luke




-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug  7 05:42:21 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 7 Aug 1997 16:42:21 +1200 (NZST)
Subject: R-alpha: Colors
Message-ID: <199708070442.QAA10907@stat1.stat.auckland.ac.nz>

Here is a proposal:

At present when you specify a color with an integer it is taken as an
index into a fixed table of 8 colors.

	1=red, 2=green, 3=blue, 4=cyan,
	5=magenta, 6=yellow, 7=white, 8=black

[At least this is the intention, there may be bugs in the
implementation].  Since I am looking at this anyway (to see if I can
see the bug that Martin and Kurt have mentioned) I thought I might
make a larger change.

I would like to make the color table, user definable.  To do this
there needs to be a function

	palette(name, value)

where "name" could be used to select one on a number of standard
built-in palettes (e.g. "default", "heat", "terrain", "pastels" etc)
and (if name was not specified, "value" could be a character vector of
color specifications (of length less than or equal to 256?).  Either
names (e.g. "red", "lightblue" ...)  or by rgb values (e.g "#FF00FF")
could be used in the vector.

The function palette would return the previous palette, and
	palette()
could be used to obtain the current settings without a change.

After a call to palette integer col= specification would provide
indexes into this table.

col=0 could be used to indicate the current background color.

The "default" palette would have 1=black.

Any comments?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug  7 09:37:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 Aug 1997 10:37:12 +0200
Subject: R-alpha: Colors -- Comment: yes, great !!
In-Reply-To: <199708070442.QAA10907@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Thu, 7 Aug 1997 16:42:21 +1200 (NZST))
Message-ID: <199708070837.KAA02747@sophie>

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> Here is a proposal: At present when you specify a color with an
    Ross> integer it is taken as an index into a fixed table of 8 colors.
     
    Ross>    ....

    Ross> I would like to make the color table, user definable.  To do this
    Ross> there needs to be a function

    Ross> 	palette(name, value)

    Ross> where "name" could be used to select one on a number of standard
    Ross> built-in palettes (e.g. "default", "heat", "terrain", "pastels"
    Ross> etc) and (if name was not specified, "value" could be a character
    Ross> vector of color specifications (of length less than or equal to
    Ross> 256?).  Either names (e.g. "red", "lightblue" ...)  or by rgb
    Ross> values (e.g "#FF00FF") could be used in the vector.

You could even do with one argument -- collapsing  name & value.
	character(1) -> 'name'
	character(> 1) -> 'value'

But this may be just about the S practice 
which has been in use in functions like  diag(..) and
seems to confusing people..


    Ross> The function palette would return the previous palette, and
    Ross> palette() could be used to obtain the current settings without a
    Ross> change.

    Ross> After a call to palette integer col= specification would provide
    Ross> indexes into this table.

This sounds really great!
Just about what I may have dreamed when I sent my e-mail
a few weeks ago :-)



    Ross> col=0 could be used to indicate the current background color.
Yes, please

    Ross> The "default" palette would have 1=black.
Ok.
    Ross> Any comments?  Ross

Yes: Sounds great!
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug  7 17:49:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 7 Aug 1997 09:49:20 -0700 (PDT)
Subject: R-alpha: expressions in graphs
In-Reply-To: <199708060311.PAA14297@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970807094715.3948D-100000@zen>


The expression parser for graph labels is wonderful.  Two comments.

1. save.plot and print.plot don't quite work -- they don't allow enough
space for text included in expressions.

2. Can we have = and sqrt() added to the wish list?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug  7 19:17:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Aug 1997 20:17:54 +0200
Subject: R-alpha: expressions in graphs
In-Reply-To: Thomas Lumley's message of Thu, 7 Aug 1997 09:49:20 -0700 (PDT)
References: <Pine.SUN.3.95.970807094715.3948D-100000@zen>
Message-ID: <x267th3lik.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 2. Can we have = and sqrt() added to the wish list?

For "=" you'd need to type == (try expression(r=2) to see why). Not
that that works as of now...

Sqrt() shouldn't be much more difficult than bar(), should it? For now, 
V*bar(...) does a fairly decent impersonation.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug  7 21:12:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 8 Aug 1997 08:12:35 +1200 (NZST)
Subject: R-alpha: expressions in graphs
Message-ID: <199708072012.IAA16673@stat1.stat.auckland.ac.nz>

Thomas Lumley writes:

> The expression parser for graph labels is wonderful.  Two comments.

> 1. save.plot and print.plot don't quite work -- they don't
> allow enough space for text included in expressions.

This is because the X11 font metrics are used in conjunction with
PostScript fonts.  The mismatch doesn't show with the usual plot
labels, but it does look pretty bad with mathematics.

General help is on the way.  We are about to completely rewite the
lower levels of the graphics system to support multiple active devices
and rather more interactive graphics.  This will change the way that
print.plot and save.plot will work (they may disappear and be replaced
by menu selections in the graphics window).

> 2. Can we have = and sqrt() added to the wish list?

I think the functionality is there, its just called "root".  We will
change the name to "sqrt".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug  8 04:06:50 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 8 Aug 1997 15:06:50 +1200 (NZST)
Subject: R-alpha: Second patch for 0.50-a1
Message-ID: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>

A second patch for R-0.50-a1 is available from
	ftp://stat.auckland.ac.nz/pub/R
The patch produces the following changes

 o  cpoly problem with pow_di fixed.

 o  legend had a call to "text" with an incorrect argument tag.
    Changed "text" to "labels".

 o  The variable "dup" was uninitialised in the function "naoktrim" in
    src/main/dotcode.c.

 o  There have been some fixes to the color support code and there
    is now a function palette which allows a user to specify the
    palette to be used when the value of col= is numeric.

 o  Problems pointed out in "unlist" are fixed.

 o  A parsing problem for "if" statements in argument lists is fixed.

Enjoy
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 10:29:43 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 11:29:43 +0200
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails ..
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 8 Aug 1997 15:06:50 +1200 (NZST))
Message-ID: <199708080929.LAA03674@sophie.ethz.ch>

Thank you for these patches, especially the new color scheme!


``As always'' (;-)  
some remarks:

1)
 	     cut(rep(1,5),4)
>>>> Error: character variables must be duplicated in .C/.Fortran

  Which seems the old '*dup =0' problem, but is NOT (identical at least)
	  [Yes, I made sure that the above was applied dotcode.c]

  This seems only for  cut(...), not for 
	  approx(.),  spline(.) or lowess(.) 
  which also use .C(...).

  Further note that cut(.) had no problems in 0.50-Alpha-2 


2) I think that
	given the definition in	src/include/Fortran.h ,
	src/appl/cpoly.c  should rather use  POW_DI(.)  instead of  pow_di(.).

  It probably won't matter for most (all?) installations,
  since it only becomes important when

#ifdef NONSTANDARD_F77LIBS  
				is true


3) Important(IMHO) bugs [besides '1)' above] remaining:
	
	i.  browser()  ##	-> seg.fault

	ii. options(digits ..) still ``fails''
	    when used in non-global environments	(see my earlier posts)
	
--------
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 13:56:17 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 14:56:17 +0200
Subject: R-alpha:  unlist(..) forever..
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 8 Aug 1997 15:06:50 +1200 (NZST))
Message-ID: <199708081256.OAA03801@sophie.ethz.ch>

[[ R-0.50 Alpha-3  --- i.e. both patches applied to 0.50-a1 ]]

There are less problems, but I think two remain

1) Peter Dalgaard's example {which "includes"  Kurt's unlist(lm(..))}

> unlist(list(1,2,x~y))
[[1]]
[1] 1

[[2]]
NULL

[[3]]
NULL


2) [unreported yet:]

l.ex <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)

unlist(l.ex) #-- now 'okay' in 0.50-a3 !!

unlist(l.ex, recursive=FALSE) #-- --- recursive has no effect!
	     ##-------------   

which returns the same as the default recursive = TRUE

whereas S gives
S> unlist(list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA), rec = FALSE)
$a1:
[1] 1 2 3 4 5

$a2:
[1] "A" "B" "C" "D" "E"

$b:
[1] "Z"

$c:
[1] NA
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 16:15:10 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 17:15:10 +0200
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails .. -- PATCH (?!)
In-Reply-To: <199708080929.LAA03674@sophie.ethz.ch> (message from Martin
 Maechler on Fri, 8 Aug 1997 11:29:43 +0200)
Message-ID: <199708081515.RAA03936@sophie.ethz.ch>


It was not only  cut(.) but also  formatC(.)
whose .C(..) calls gave the
 >>>> Error: character variables must be duplicated in .C/.Fortran

Looking a bit at  src/main/dotcode.c
(and reading Ross' explanation that it was a "variable initialization problem")

I decided to 
REPLACE line 413  in src/main/dotcode.c
which (after the patch) reads
		*dup = 0;
by
		*dup = 1;
---
and yes, this seems to solve the problem.

'make tests' at least works and gives about the same as with  0.50 Alpha-2.

----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug  8 21:53:33 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 9 Aug 1997 08:53:33 +1200 (NZST)
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails .. -- PATCH (?!)
Message-ID: <199708082053.IAA03751@stat1.stat.auckland.ac.nz>

	From: Martin Maechler <maechler@stat.math.ethz.ch>

	Looking a bit at  src/main/dotcode.c
	(and reading Ross' explanation that it was a "variable
	initialization problem")

	I decided to 
	REPLACE line 413  in src/main/dotcode.c
	which (after the patch) reads
			*dup = 0;
	by
			*dup = 1;

Ooops!  Martin is right.  Make this change.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Sun Aug 10 23:57:58 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Mon, 11 Aug 1997 10:57:58 +1200 (NZST)
Subject: R-alpha:  unlist(..) forever..
Message-ID: <199708102257.KAA17769@stat1.stat.auckland.ac.nz>

Take about the bug from hell; well I'm sure that I'm not done with this
one yet but it should work a little better on the next patch.


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: R 0.50.a3:  adj?
Message-ID: <199708111336.PAA00438@aragorn.ci.tuwien.ac.at>

Not sure if I already reported this ... it seems that as of 0.50.a2, the
adj graphics parameter is completely ignored.  Try e.g.

	plot(1:10)
	title(main = "This is a title", adj = 0)
	title(main = "This is a title", adj = 1)

No difference ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: CFLAGS in config.site
Message-ID: <199708111336.PAA00442@aragorn.ci.tuwien.ac.at>

Could we change the default value of CFLAGS in config.site (back) to
"-O2 -g"?
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: R 0.50.a3 family.lm()
Message-ID: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>

The following patch adds a trivial family method for linear models.
-k

--- src/library/base/funs/lm.orig	Tue May 27 02:53:58 1997
+++ src/library/base/funs/lm	Sun Aug 10 22:00:46 1997
@@ -412,3 +412,5 @@
 }
 
 formula.lm<-function(x)formula(x$terms)
+
+family.lm <- function(x) { gaussian() }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3 problem with `make tests'
Message-ID: <199708111336.PAA00453@aragorn.ci.tuwien.ac.at>

Not really important, but ... `make tests' fails if a user's .Rprofile
asks for libraries which are not found by the binary in the compilation
tree (yes I know, we're here perhaps the only ones who use private
libraries ...).

Perhaps we should have options
	--no-site-file
	--no-init-file
which inhibit the loading of a global and a user's init file?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:09 +0200
Subject: R-alpha: R 0.50.a3  tapply patch
Message-ID: <199708111336.PAA00464@aragorn.ci.tuwien.ac.at>

Can we please apply the following patch?  It fixes the following problem
I already reported:

************************************************************************
There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
R> f
[1] a a b
R> codes(f)
[1] 1 1 2
R> levels(f)
[1] "a" "b" "c"

which gives e.g.

R> tapply(rep(1, length(f)), f, sum)
Error: names attribute must be the same length as the vector
************************************************************************

Thanks,
-k

--- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
+++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
@@ -14,7 +14,7 @@
 		index <- as.factor(INDEX[[i]])
 		if (length(index) != nx) 
 			stop("arguments must have same length")
-		namelist[[i]] <- levels(index)
+		namelist[[i]] <- unique(levels(index)[index])
 		extent[[i]] <- nlevels(index)
 		group <- group + ngroup * (codes(index) - 1)
 		ngroup <- ngroup * nlevels(index)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3:  patch for man/palette
Message-ID: <199708111336.PAA00456@aragorn.ci.tuwien.ac.at>

The following patch fixes an obvious problem with the man source for
palette().
-k

--- src/library/base/man/palette.orig	Sun Aug 10 17:50:11 1997
+++ src/library/base/man/palette	Sun Aug 10 18:49:14 1997
@@ -14,7 +14,7 @@
 a built in color palette.  If LANG(value) has length greater
 than 1 it is assumed to contain a description of the colors
 which are to make up the new palette (either by name or
-by RGB levels.
+by RGB levels).
 PARA
 If LANG(value) is omitted or has length 0, no change is made
 the current palette.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: frame tools
Message-ID: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>

Btw, what happened to Peter's frame tools?   Is there a new version?
Are there plans to include them in the distribution?
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3 minor remark
Message-ID: <199708111336.PAA00459@aragorn.ci.tuwien.ac.at>

Just a minor remark.  We now have

> args(ls)
function (name, pos = -1, envir = pos.to.env(pos), all.names = FALSE, 
        pattern) 

but

> pos.to.env(-1)
Error in pos.to.env(-1) : invalid argument

whereas

> pos.to.env(length(search()))
NULL


Perhaps pos.to.env should really return the corresponding environments,
just for sake of completeness ... or the fun of it.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:09 +0200
Subject: R-alpha: Second patch for 0.50-a1
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
References: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
Message-ID: <199708111336.PAA00462@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> A second patch for R-0.50-a1 is available from
> 	ftp://stat.auckland.ac.nz/pub/R
> The patch produces the following changes

> ...

scale() is still missing ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 11 15:42:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 11 Aug 1997 16:42:02 +0200
Subject: R-alpha: frame tools
In-Reply-To: Kurt Hornik's message of Mon, 11 Aug 1997 15:36:08 +0200
References: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>
Message-ID: <x2bu34eq85.fsf@biostat.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> Btw, what happened to Peter's frame tools?   Is there a new version?
> Are there plans to include them in the distribution?

In the cooler for the time being. I did a little poking around some
weeks ago, planning to change the syntax slightly so that there would
be two functions, accessed as generic methods:

subset.data.frame(fr,...,where)
transform.data.frame(fr,...)

e.g.,

subset(data,visit1:visit5,where=(treat=="placebo"))
transform(data,log.creatin=log(creatin))

I.e. subset now combines the old select.frame and subset.frame
mechanisms.

I also spent a litle while pondering whether the method for
substituting names in an object of mode "call" could be generalized
somehow, but decided that it was probably too difficult to get it
right.

Then the close-xterm bug zapped the .RData in the directory where I
had been experimenting... Actually, I hadn't done all that much,
mainly terminology cleanup, and what was lost should be easily
recreated.

What's really keeping me is that I've decided to try using R for our
course in basic statistics for medical researchers, so now I need to
focus on making sure things work that I absolutely *need*, and write
various tutorials and missing functions (anyone have logrank.test and
kaplan.meier.plot? Working with the Windows version, that is!).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 11 18:12:49 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 Aug 1997 10:12:49 -0700 (PDT)
Subject: R-alpha: eigen
In-Reply-To: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970811094129.432B-100000@zen>


eigen is behaving very strangely in my copy of patch 3 (solaris 2.5.1). 
The calls to .Fortran are returning absolute rubbish and are also mutating
things that shouldn't be mutated. 

example:
> eigen(matrix(c(1,0,0,1),2))  
debug: z <- .Fortran("rs", n, n, x, values = vals, only.values == FALSE, 
        vectors = x, vals, vals, ierr = integer(1))
Browse[1]> x
     [,1] [,2]
[1,]    1    0
[2,]    0    1
Browse[1]> 
debug: if (z$ierr) stop(paste("rs returned code ", z$ierr, " in eigen"))
Browse[1]> dim(x)
[1] -1076060379  -977277476
Browse[1]> dim(z$vectors)
[1] -1076060379  -977277476
Browse[1]> dim(x)<-c(2,2)
Browse[1]> dim(x)
[1] 2 2
Browse[1]> dim(z$vectors)
[1] 2 2
Browse[1]> z$vectors
          [,1]       [,2]
[1,] 0.8506508 -0.4472136
[2,] 0.5257311  0.7236068

Not only are these clearly not the eigenvectors of the identity, but the
.Fortran routine shouldn't even have access to x.

The problems turn out to be related: when separate objects are supplied
for each argument the function works properly, ie
        z <- .Fortran("rs", n, n, x, values = vals, only.values ==  FALSE, 
		vectors = 0 * x, vals * 0, vals * 0, ierr = integer(1))

Somehow the arguments to .Fortran aren't getting properly copied.


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug 11 22:14:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 12 Aug 1997 09:14:42 +1200 (NZST)
Subject: R-alpha: eigen
In-Reply-To: <Pine.SUN.3.95.970811094129.432B-100000@zen>
References: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970811094129.432B-100000@zen>
Message-ID: <199708112114.JAA09123@stat1.stat.auckland.ac.nz>

Thomas Lumley writes:
 > 
 > eigen is behaving very strangely in my copy of patch 3 (solaris 2.5.1). 
 > The calls to .Fortran are returning absolute rubbish and are also mutating
 > things that shouldn't be mutated. 

I think that this is my fault for making a "quick fix" without really
testing it.  The problem (as pointed out by Martin) is in dotcode.c.

The function naoktrim should read

static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 1;	/* <---- 1 not 0 */
                *len = 0;
        }

Sorry about that.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Aug 12 01:21:12 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 12 Aug 1997 12:21:12 +1200 (NZST)
Subject: R-alpha: Matrix Class
Message-ID: <199708120021.MAA16813@stat1.stat.auckland.ac.nz>

The have been a few prods to create an S-like matrix class for R.  A
major reason for having a matrix class seems to be that people get
bitten by the default behavior of the drop= parameter to "[".  That
being the case does it make sense to change the semantics of "["
rather than introducing a new class?

I'm just wondering because I'm in a "smaller is better" kind of mood
after having been delving into the "lm" code and thinking about how
big R is becoming ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 02:04:28 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 Aug 1997 18:04:28 -0700 (PDT)
Subject: R-alpha: Matrix Class
In-Reply-To: <199708120021.MAA16813@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970811174844.739A-100000@zen>

On Tue, 12 Aug 1997, Ross Ihaka wrote:

> The have been a few prods to create an S-like matrix class for R.  A
> major reason for having a matrix class seems to be that people get
> bitten by the default behavior of the drop= parameter to "[".  That
> being the case does it make sense to change the semantics of "["
> rather than introducing a new class?

I think changing the semantics is preferable, in part because it fixes the
drop problem automatically, rather than requiring everyone to use a new
feature.  Creating a Matrix class would not fix the array problem for
arrays of dimension 3 or more, either.

However, a Matrix library might be a nice place to put matrix features
that not everyone needs. This helps keep the size of R down.  Libraries
that can be loaded and unloaded seem like the ideal place to put a whole
lot of things, rather than taking the S-PLUS approach of bundling gam and
trees and nlme and everything else together.  


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 08:32:10 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 09:32:10 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <Pine.SUN.3.95.970811174844.739A-100000@zen> (message from Thomas
 Lumley on Mon, 11 Aug 1997 18:04:28 -0700 (PDT))
Message-ID: <199708120732.JAA00579@sophie.ethz.ch>

	we are discussing, yes? -- 
	please nobody feel hurt just  because I disagree so heartily .. ;-)


>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    TL> On Tue, 12 Aug 1997, Ross Ihaka wrote:
    >> There have been a few prods to create an S-like matrix class for R.
    >> A major reason for having a matrix class seems to be that people get
    >> bitten by the default behavior of the drop= parameter to "[".
I think there are quite a few other reasons. I've been wanting to have 
a 'matrix' class for other reasons for quite a long time.
(One that come to my mind:
	Kurt's (and my earlier) proposal for a generic  "write" function
	with a write.data.frame  method would be much
	cleaner to implement with a write.matrix method when matrix was a class)

    >> That being the case does it make sense to change the semantics of "["
    >> rather than introducing a new class?

I don't think so. (see above and below)

    TL> I think changing the semantics is preferable, in part because it
    TL> fixes the drop problem automatically, rather than requiring
    TL> everyone to use a new feature.  Creating a Matrix class would not
    TL> fix the array problem for arrays of dimension 3 or more, either.

I disagree (I think this is a rare thing with you Thomas..).
----------
1) Lest I misunderstood something,
  you mean that	for matrices 'x',
	  x[,1]
  would be a 1--column matrix instead of a vector ?
  IMHO, this is ugly, and is really just logical if you come from a strict
  matrix thinker's corner which is the case for  matlab users, and maybe even
  mathematicians and the like (I'm one myself),
  but not for an average person analyzing  statistical data.

2) I'm quite convinced that this will break quite a bit of existing code,
   maybe code outside the R 'base' source, but still.

   It is more basically incompatible to S semantics than many other things,
   I think.

3) What if  x  is a data.frame? Would  x[,1] still be a data.frame?
  If not (which I presume), wouldn't this be contrary to the idea which I
  teach to beginners that
	``data.frames are just matrices, but a bit more general since
	  they can contain both numbers and character codes''


All in all, the use of  ``drop = FALSE'' is one way to avoid the problem,
and I agree there should be others,
(namely a  'Matrix' class in "R base" INDEPENDENT of the Matrix library.)

I do like the  class approach in any case and would like to have
'matrix' be THE generic class for all matrices 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[[I've advocating this even for S-plus,
  years ago, before 'Matrix' came into existence]] 

Then, 'Matrix' would be a class inheriting from 'matrix' with 
at least it's own "].Matrix" method.

    TL> However, a Matrix library might be a nice place to put matrix
    TL> features that not everyone needs. This helps keep the size of R
    TL> down.  Libraries that can be loaded and unloaded seem like the
    TL> ideal place to put a whole lot of things, rather than taking the
    TL> S-PLUS approach of bundling gam and trees and nlme and everything
    TL> else together.
yes. {also see above: 'Matrix' would be a class ANYWAY, for the
	``[,1] ==> Matrix''   aficionados}

Especially that we now have require() and provide()  
[[ provide  has been  fallen out of the source recently,
   it is "back again" and should appear in the next (pre)release
]]


This is an important discussion - I think -
so please tell me why you disagree...

--- Martin


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 14:23:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 15:23:13 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708111336.PAA00453@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 11 Aug 1997 15:36:08 +0200)
Message-ID: <199708121323.PAA02620@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Not really important, but ... `make tests' fails if a user's
    Kurt> .Rprofile asks for libraries which are not found by the binary in
    Kurt> the compilation tree (yes I know, we're here perhaps the only
    Kurt> ones who use private libraries ...).

    Kurt> Perhaps we should have options
    Kurt>  --no-site-file
    Kurt>  --no-init-file
    Kurt> which inhibit the loading of a global and a user's init file?

Yes, this (or something similar, maybe also allowing "-q" as short form)
would be useful!


For me even more important, is an option such as
	--dont-stop-on-error-if-batch

As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
namely "Termination upon 'error'".

I think this is THE good default behavior for "batch mode".
However
 1) for several purposes I'd very much want an option to change this
    default behavior.
 2) S-plus behaves differently, i.e., just continues evaluation after
    telling about the error, both in  "Splus BATCH .." and "Splus < file" mode.

Instead of the above switch ((which is hard to port to point'n'click
			      Win or Mac versions))
we could have something as

	options(error.stop = FALSE)

whereas the default was

	options(error.stop = TRUE)

I think it'd be very neat then if
	options(error.stop = FALSE)
actually translated all errors [stop(.)] to warnings [warning()].

The above option may come handy even in NON-BATCH mode,
e.g. when minimizing functions that produce NA from time to time or similar
things, and you are running large loops of simulations...


Just for the sake of completeness, the following is somewhat related to the
above discussion and  has been part of the TASKS for a while :
----------------------------------------------------------------------
TASK:	warnings option
STATUS:	Open
FROM:	maechler@stat.math.ethz.ch
	which reminds me that we/I also would like something similar as S's
	options(warn = k)
	k=  0 : [default]  print warnings
	k= -1 :	do nothing (maybe append warnings to some temp-file)
	k=  1 : produce an error ('warning' becomes 'stop'). 

----------------------------------------------------------------------


-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 15:16:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 16:16:12 +0200
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: <199708111336.PAA00438@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 11 Aug 1997 15:36:07 +0200)
Message-ID: <199708121416.QAA02795@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Not sure if I already reported this ... it seems that as of
    Kurt> 0.50.a2, the adj graphics parameter is completely ignored.  Try
    Kurt> e.g.
    Kurt>	plot(1:10)
    Kurt>	title(main = "This is a title", adj = 0)
    Kurt>	title(main = "This is a title", adj = 1)

    Kurt> No difference ...

true.
	{{are you sure if your example worked before ??}}


For  'mtext(..)'  adj does something but not the proper one :

	plot(1:10)#-- or just in the plot above..

	mtext( "This is an 'mtext(.. adj=0)'", adj = 0)
	mtext( "This is an 'mtext(.. adj=1)'", adj = 1)
	## is different but result is WRONG: adj=1 is LEFT of adj=0


for  'text(..)'   adj works as it should, at least in the cases I used it.
					 [ -> see the example in  ?text]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Aug 12 15:29:18 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 12 Aug 1997 10:29:18 -0400
Subject: R-alpha: Matrix Class
Message-ID: <97Aug12.103129edt.26507@mailgate.bank-banque-canada.ca>

Ross

If you're looking at the drop= code it sure would be nice to be able to (optionally) supply a vector (eg. drop=c(F,F,T) ) for higer dimension arrays.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 16:48:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 17:48:03 +0200
Subject: R-alpha: yet another remaining buglet
Message-ID: <199708121548.RAA02951@sophie.ethz.ch>

This was originally 

>> Cc: r-devel@stat.math.ethz.ch
>> Subject: Re: R-alpha: list assignment
>> References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
>> From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
>> Date: 25 Apr 1997 13:09:01 +0200
>> In-Reply-To: Robert Gentleman's message of Fri, 25 Apr 1997 13:12:36 +1200 (NZST)

### 2)  names(x)[1] <- "a"  still gives extraneous doublequotes IN the name

x <- list()
x[[1]] <- 23
names(x)[1] <- "a"
x  #----------------- got the quotes, also !!
##- $"a"
##- [1] 23
unlist(x)
##- \"a\"
##-    23
names(x) #> [1] "\"a\""


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 17:28:13 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 12 Aug 1997 09:28:13 -0700 (PDT)
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <199708120732.JAA00579@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970812090421.777A-100000@spock>

> 
> I disagree (I think this is a rare thing with you Thomas..).
> ----------
> 1) Lest I misunderstood something,
>   you mean that	for matrices 'x',
> 	  x[,1]
>   would be a 1--column matrix instead of a vector ?
>   IMHO, this is ugly, and is really just logical if you come from a strict
>   matrix thinker's corner which is the case for  matlab users, and maybe even
>   mathematicians and the like (I'm one myself),
>   but not for an average person analyzing  statistical data.

I'm not opposed to a matrix class, but I do think drop=FALSE should be the
default for arrays (I'm not as sure about data frames, but I do think it
is reasonable that one row of a data frame should be a data frame). The
reason is that the *current* behaviour of [ with drop=TRUE in S and R
breaks a lot of S code. 

I have found this particular problem in code written for other people to
use by people from a wide range of backgrounds. For example, Harald
Fekjaer's addreg library, Adrian Raftery's bayesian model averaging code,
and even an early version of Brian Ripley's linear discrimination
function. These functions break because they assume that x[vec,] is a
matrix even when it has a single row.  It rarely seems to matter if x[,1]
is a matrix or a vector, but it is important if x[1,] is a vector. 

For data analysis I don't think it matters much, though I agree it is a
little ugly for x[,1] to be a matrix. For programming I think that drop=F
is the same sort of incompatibility as the R scoping rules: one that
fixes, rather than breaks, S code. Of course people could just use drop=F,
the way they could just pass variables into nested functions explicitly.
The problem is that most of us don't, and it's a remarkably difficult bug
to find.

I may well be wrong, of course. ;-)


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 17:35:46 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 12 Aug 1997 09:35:46 -0700 (PDT)
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708121323.PAA02620@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970812093005.777B-100000@spock>

On Tue, 12 Aug 1997, Martin Maechler wrote:
> 
> As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
> namely "Termination upon 'error'".
> 
> I think this is THE good default behavior for "batch mode".
> However
>  1) for several purposes I'd very much want an option to change this
>     default behavior.
Hear, hear!

> 
> I think it'd be very neat then if
> 	options(error.stop = FALSE)
> actually translated all errors [stop(.)] to warnings [warning()].
> 

I'm not convinced.  Being able to make warnings fatal is a good option,
but being able to continue after errors may make no sense.   How do you
continue after subscript out of bounds, or argument missing with no
default, or memory exhausted or ...

You may well need to jump back to the top level before it makes sense to
continue.  On the other hand, once at the top level it is certainly
possible to proceed, and so there should be an option to do it.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 17:40:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 18:40:55 +0200
Subject: R-alpha: attach( <data.frame> , pos = 1) -- does not work.   detach(., save=..)
Message-ID: <199708121640.SAA03254@sophie.ethz.ch>

	[R-0.50-a3]

It seems intuitive that
	  attach( .., pos = 1)
is harder
than other attach()es.

But still...

If it ever will work, it is even more important to have

detach( .... , save = "VAR.name")
	       ~~~~~~~ --------
to be working.

The documentation says that  detach(.) returns invisibly.
Therefore, we don't NEED the above  'save = ' argument to detach,
since we can work with

	VAR.name <- detach ( .... )
instead.
However, there's a little problem there, too:
if the frame has been changed it is always returned as list
(which is different from S's ``save = T'' 
 which tries to coerce to data.frame)

Otherwise, things are ok (and conform to S's behavior):


###-------  Martin Mächler, Aug.12, 1997  (0.50-a3) : -----
data(bees)
search()

attach(bees)
attach(bees[-1,])
search()#ok : ".GlobalEnv"   "bees[, -1]"   "bees"   "library:base"

length(Lcp <- log(colpos)) # 63
assign("Lcp", Lcp, pos = 2)
b1 <- detach()#-- now, b1 is a 'list' instead of a data.frame ..

length(Lcp <- log(colpos)) # 64
bb <- detach()#>>> bb is a data.frame
search()#-- as it was 'at the beginning'

data.class(bb)# "data.frame"
data.class(b1)# "list"

db1 <- as.data.frame(b1)
##>> Error: no applicable method for "as.data.frame"

## And -- as a matter of fact -- there are __NO__ methods for as.data.frame...

## The following helps:
as.data.frame.default <-
  function (x, row.names = NULL, optional = F, ...)
  data.frame(x, row.names=row.names, ...)

db1 <- as.data.frame(b1)
summary(db1) #--> ok


attach(bees, pos = 1)
search()#- just still at  pos = 2 ..
attach(bees[,-1], pos = 3) #-- works ok !
search()#ok:  ".GlobalEnv"   "bees"   "bees[, -1]"   "library:base"

detach() #-- detaches pos=2, [ NOT the last attached one; -- AS S-plus ]
search()#--  ".GlobalEnv"    "bees[, -1]"   "library:base"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Aug 12 18:48:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 12 Aug 1997 13:48:56 -0400
Subject: R-alpha: error.handler
Message-ID: <97Aug12.135112edt.26508@mailgate.bank-banque-canada.ca>

> I think it'd be very neat then if
> 	options(error.stop = FALSE)

It would be even better to have
	options(error.handler = error.handling.routine)

so it would be possible to do some special error checking or just stop().

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug 12 23:39:14 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Aug 1997 00:39:14 +0200
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: Martin Maechler's message of Tue, 12 Aug 1997 16:16:12 +0200
References: <199708121416.QAA02795@sophie.ethz.ch>
Message-ID: <x2g1sf2fhp.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> For  'mtext(..)'  adj does something but not the proper one :
> 
> 	plot(1:10)#-- or just in the plot above..
> 
> 	mtext( "This is an 'mtext(.. adj=0)'", adj = 0)
> 	mtext( "This is an 'mtext(.. adj=1)'", adj = 1)
> 	## is different but result is WRONG: adj=1 is LEFT of adj=0

-- as it should be! adj=0 is left-aligned, adj=1 is right-aligned

(take a string, attach a scale 0 to 1 along it, mark the value of adj
on scale, attach that point to the anchor point, i.e. the midpoint of
the plotting frame).

> 
> 
> for  'text(..)'   adj works as it should, at least in the cases I used it.
> 					 [ -> see the example in  ?text]

seems to work exactly the same!

The confusion seems to come from wanting 0/0.5/1 to mean
left/center/right-*justified* along the plot frame, which it really
doesn't. 

Even if it did, it wouldn't help, the control really needs to be
two-dimensional: you might want text left/center/right aligned with
the top of the y-axis. The at= parameter *almost* does it, but it is
in user coordinates, rather than frame coordinates. Perhaps we want an
anchor= parameter? -- or even better, a way of attaching units to plot
lengths. This kind of problem also appears with text() and legend()
(ever tried to produce plots with different scales but the legends in
the exact same spot?).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Wed Aug 13 00:58:51 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 13 Aug 1997 11:58:51 +1200 (NZST)
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>

Martin wrote:
>  I am sorry that this IS an old topic.
> Yet another task
> I think the bug is somewhere in hidden  in  src/main/options.c ..
> 
> ##-- The following does not work as it should in  R (0.50-a1, but I think
> 							also earlier)
> 
> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
> tst()
> tst(dig = 12)
> 
> 
> ##-- This should do the same; it works as expected in R & S :
> 
> tst2 <- function(x=pi, dig =3) {
>   oo <- options(digits=dig); on.exit(oo); print(x);x}
> tst2()
> tst2(dig = 12)


  Well it isn't really clear what Splus does to get tst to work. It appears
  that they use some form of dynamic scope for Options. Clearly, the 
  assignment,
    .Options$digits<- xxxx
  creates a local copy of .Options and changes the value of that. The only
  way that print can find this local copy is if  it looks up the stack of
  calling functions to find it (or perhaps Splus squirrels it away somewhere
  that print looks but then <- starts to behave in a very peculiar manner).
  This sort of behaviour is bad for two reasons
    1) We really want people to use lexical scope and any examples where you
    have dynamic scope simply confuse things
    2) It is quite inefficient for print (and anything else that uses Options)
    to have to look up the stack of calling functions.
    
  Since the method Martin so capably demonstrated with tst2 does work
   (except I think he meant on.exit(options(oo)) rather than on.exit(oo))
   I think we should stick with that. In that case the global value of 
   options(digits) is changed for the duration of the function evaluation
   of tst2.
   
 robert
 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Aug 13 01:01:09 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 13 Aug 1997 12:01:09 +1200 (NZST)
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: <x2g1sf2fhp.fsf@bush.kubism.ku.dk>
References: <199708121416.QAA02795@sophie.ethz.ch>
 <x2g1sf2fhp.fsf@bush.kubism.ku.dk>
Message-ID: <199708130001.MAA04180@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > (ever tried to produce plots with different scales but the legends in
 > the exact same spot?).

There is a barely documented (and nearly forgotten) R "feature" which you
might find useful ...

The functions xinch() and yinch() convert inches (xcm() and ycm() are
left as an exercise) to "usr" coordinates.

For example, to plot a point half an inch up from the lower left
corner of a plot you can use:

	ll <- par("usr")[c(1,3)] + c(xinch(0.5), yinch(0.5))
	points(ll[1], ll[2])

The same trick works for placing legends in "usr" coordinates.
	Ross


PS: I am making the "adj" feature behave like S.  Again this was
ignorance on my part, not malice.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 08:28:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 09:28:08 +0200
Subject: R-alpha: another minor problem
Message-ID: <199708130728.JAA01062@aragorn.ci.tuwien.ac.at>

As it seems that everyone's wishes for getting bugs fixed are granted
right away, here is something that I alread mentioned once.

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

        R> x <- 1:5
        R> x
        [1] 1 2 3 4 5
        R> i <- c(F, T)
        R> x[i]
        Error: invalid subscript type
        R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

        R> x[-6]
        Error: subscript out of bounds


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 08:54:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 09:54:31 +0200
Subject: R-alpha: frame tools
In-Reply-To: <x2bu34eq85.fsf@biostat.ku.dk>
References: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>
 <x2bu34eq85.fsf@biostat.ku.dk>
Message-ID: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <hornik@ci.tuwien.ac.at> writes:
>> 
>> Btw, what happened to Peter's frame tools?   Is there a new version?
>> Are there plans to include them in the distribution?

> In the cooler for the time being. I did a little poking around some
> weeks ago, planning to change the syntax slightly so that there would
> be two functions, accessed as generic methods:

> subset.data.frame(fr,...,where)
> transform.data.frame(fr,...)

> e.g.,

> subset(data,visit1:visit5,where=(treat=="placebo"))
> transform(data,log.creatin=log(creatin))

> I.e. subset now combines the old select.frame and subset.frame
> mechanisms.

Sounds very nice.

> I also spent a litle while pondering whether the method for
> substituting names in an object of mode "call" could be generalized
> somehow, but decided that it was probably too difficult to get it
> right.

> Then the close-xterm bug zapped the .RData in the directory where I
> had been experimenting... Actually, I hadn't done all that much,
> mainly terminology cleanup, and what was lost should be easily
> recreated.

(Maybe run R from within Emacs?)

> What's really keeping me is that I've decided to try using R for our
> course in basic statistics for medical researchers, so now I need to
> focus on making sure things work that I absolutely *need*, and write
> various tutorials and missing functions (anyone have logrank.test and
> kaplan.meier.plot? Working with the Windows version, that is!).

Yes, that would be nice, too.  I remember you asked for that some time
ago ...

What's also needed is something to produce and plot empirical
distribution functions.  I thought I could write something for my
Biostat course last semester, but it never happened ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 09:08:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 10:08:19 +0200
Subject: R-alpha: plotting empirical distribution function -- plot.step
In-Reply-To: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 13 Aug 1997 09:54:31 +0200)
Message-ID: <199708130808.KAA00695@ingrid.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
   
	.............

    Kurt> What's also needed is something to produce and plot empirical
    Kurt> distribution functions.  I thought I could write something for my
    Kurt> Biostat course last semester, but it never happened ...

Maybe I  REALLY should   have my  'plot.step'  function  put into R.

It does empirical distribution functions and quite a bite more..
Just need a little time to fixup the man page and do a few more tests..

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:09:18 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:09:18 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <199708120732.JAA00579@sophie.ethz.ch>
References: <Pine.SUN.3.95.970811174844.739A-100000@zen>
 <199708120732.JAA00579@sophie.ethz.ch>
Message-ID: <199708130809.KAA01211@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> 	we are discussing, yes? -- 
> 	please nobody feel hurt just  because I disagree so heartily
> .. ;-)

I certainly don't.

>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

TL> On Tue, 12 Aug 1997, Ross Ihaka wrote:
>>> There have been a few prods to create an S-like matrix class for R.
>>> A major reason for having a matrix class seems to be that people get
>>> bitten by the default behavior of the drop= parameter to "[".

> I think there are quite a few other reasons. I've been wanting to have 
> a 'matrix' class for other reasons for quite a long time.
> (One that come to my mind:
> 	Kurt's (and my earlier) proposal for a generic  "write" function
> 	with a write.data.frame  method would be much
> 	cleaner to implement with a write.matrix method when matrix was
> a class)

Yes, exactly.  It seems stupid to have to write code like

	xxx.default <- function(obj, ...) {
          if (is.matrix(obj)) {
             xxx.matrix(obj, ...)
          } else {
             ...
          }

(Not only with e.g. the generic write function ... there are many more
examples.)

>>> That being the case does it make sense to change the semantics of "["
>>> rather than introducing a new class?

> I don't think so. (see above and below)

TL> I think changing the semantics is preferable, in part because it
TL> fixes the drop problem automatically, rather than requiring
TL> everyone to use a new feature.  Creating a Matrix class would not
TL> fix the array problem for arrays of dimension 3 or more, either.

> I disagree (I think this is a rare thing with you Thomas..).
> ----------
> 1) Lest I misunderstood something,
>   you mean that	for matrices 'x',
> 	  x[,1]
>   would be a 1--column matrix instead of a vector ?
>   IMHO, this is ugly, and is really just logical if you come from a strict
>   matrix thinker's corner which is the case for  matlab users, and maybe even
>   mathematicians and the like (I'm one myself),
>   but not for an average person analyzing  statistical data.

Exactly.  Having done statistics with Octave prior to the existence of
R, I can only say that `strict matrix thinking' is terrible.  (In
particular, having to worry whether something is a row or a column
vector, when it DOES NOT MATTER AT ALL!)

> 2) I'm quite convinced that this will break quite a bit of existing code,
>    maybe code outside the R 'base' source, but still.

>    It is more basically incompatible to S semantics than many other things,
>    I think.

> 3) What if  x  is a data.frame? Would  x[,1] still be a data.frame?
>   If not (which I presume), wouldn't this be contrary to the idea which I
>   teach to beginners that
> 	``data.frames are just matrices, but a bit more general since
> 	  they can contain both numbers and character codes''

Right!

> All in all, the use of  ``drop = FALSE'' is one way to avoid the problem,
> and I agree there should be others,
> (namely a  'Matrix' class in "R base" INDEPENDENT of the Matrix
> library.)

> I do like the  class approach in any case and would like to have
> 'matrix' be THE generic class for all matrices 
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> [[I've advocating this even for S-plus,
>   years ago, before 'Matrix' came into existence]]

Again, definitely right!

> Then, 'Matrix' would be a class inheriting from 'matrix' with 
> at least it's own "].Matrix" method.

Exactly.

TL> However, a Matrix library might be a nice place to put matrix
TL> features that not everyone needs. This helps keep the size of R
TL> down.  Libraries that can be loaded and unloaded seem like the
TL> ideal place to put a whole lot of things, rather than taking the
TL> S-PLUS approach of bundling gam and trees and nlme and everything
TL> else together.
> yes. {also see above: 'Matrix' would be a class ANYWAY, for the
> 	``[,1] ==> Matrix''   aficionados}

> Especially that we now have require() and provide()  
> [[ provide  has been  fallen out of the source recently,
>    it is "back again" and should appear in the next (pre)release
> ]]


> This is an important discussion - I think -
> so please tell me why you disagree...

> --- Martin

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:13:23 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:13:23 +0200
Subject: R-alpha: plotting empirical distribution function -- plot.step
In-Reply-To: <199708130808.KAA00695@ingrid.ethz.ch>
References: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at>
 <199708130808.KAA00695@ingrid.ethz.ch>
Message-ID: <199708130813.KAA01217@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 	.............

Kurt> What's also needed is something to produce and plot empirical
Kurt> distribution functions.  I thought I could write something for my
Kurt> Biostat course last semester, but it never happened ...

> Maybe I  REALLY should   have my  'plot.step'  function  put into R.

> It does empirical distribution functions and quite a bite more..
> Just need a little time to fixup the man page and do a few more
> tests..

Martin,

Your plot.step should definitely come with R.  The question is, should
there be a class `step' or something similar?  Is there a generic way of
representing step functions?  Then having e.g. print and plot for ECDF
would be automatic, which would be very nice, imho.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:23:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:23:43 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <Pine.SUN.3.95.970812090421.777A-100000@spock>
References: <199708120732.JAA00579@sophie.ethz.ch>
 <Pine.SUN.3.95.970812090421.777A-100000@spock>
Message-ID: <199708130823.KAA01224@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

>> 
>> I disagree (I think this is a rare thing with you Thomas..).
>> ----------
>> 1) Lest I misunderstood something,
>> you mean that	for matrices 'x',
>> x[,1]
>> would be a 1--column matrix instead of a vector ?
>> IMHO, this is ugly, and is really just logical if you come from a strict
>> matrix thinker's corner which is the case for  matlab users, and maybe even
>> mathematicians and the like (I'm one myself),
>> but not for an average person analyzing  statistical data.

> I'm not opposed to a matrix class, but I do think drop=FALSE should be
> the default for arrays (I'm not as sure about data frames, but I do
> think it is reasonable that one row of a data frame should be a data
> frame). The reason is that the *current* behaviour of [ with drop=TRUE
> in S and R breaks a lot of S code.

> I have found this particular problem in code written for other people
> to use by people from a wide range of backgrounds. For example, Harald
> Fekjaer's addreg library, Adrian Raftery's bayesian model averaging
> code, and even an early version of Brian Ripley's linear
> discrimination function. These functions break because they assume
> that x[vec,] is a matrix even when it has a single row.  It rarely
> seems to matter if x[,1] is a matrix or a vector, but it is important
> if x[1,] is a vector.

(Hmm.  Why do they break subsequently?)

> For data analysis I don't think it matters much, though I agree it is
> a little ugly for x[,1] to be a matrix. For programming I think that
> drop=F is the same sort of incompatibility as the R scoping rules: one
> that fixes, rather than breaks, S code. Of course people could just
> use drop=F, the way they could just pass variables into nested
> functions explicitly.  The problem is that most of us don't, and it's
> a remarkably difficult bug to find.

I have two remarks on this one.

* Thomas, if you have ports of the above software, could you PLEASE
package them?  (Btw, I have a finished `port' of the V&R `classif'
library, and of the `clus' library which comes with the paper on JSS.)

* Personally, I feel that x[1,] and x[,1] should be a vector if x is a
matrix.  As Martin said, MATRIX `freaks' should be able to attach class
attribute Matrix which would give drop = F.  (Fortunately, the S lang
does not have scalars, otherwise we'd we in trouble with x[i] for x a
vector ...).

If that breaks existing code, I think we should try to get the authors
of that code to make compatibility changes if possible.  E.g. in the
above cases, if subscripting with drop = F would do the trick in either
case, then I don't think that e.g. V&R would object to making the
change.

Or, perhaps R&R should ask Chambers why S does things the way it does?

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 11:37:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 12:37:03 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: <199708122358.LAA04005@stat1.stat.auckland.ac.nz> (message from
 Robert Gentleman on Wed, 13 Aug 1997 11:58:51 +1200 (NZST))
Message-ID: <199708131037.MAA00520@sophie.ethz.ch>

>>>>> "Robert" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

    Robert> Martin wrote:
    >> I am sorry that this IS an old topic.  Yet another task I think the
    >> bug is somewhere in hidden in src/main/options.c ..
    >> 
    >> ##-- The following does not work as it should in R (0.50-a1, but I
    >> think also earlier)
    >> 
    >> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig);
    >> print(x);x} tst() tst(dig = 12)
    >> 
    >> 
    >> ##-- This should do the same; it works as expected in R & S :
    >> 
    >> tst2 <- function(x=pi, dig =3) { oo <- options(digits=dig);
    >> on.exit(oo); print(x);x} tst2() tst2(dig = 12)

    Robert>   Well it isn't really clear what Splus does to get tst to
    Robert> work. It appears that they use some form of dynamic scope for
    Robert> Options. Clearly, the assignment, .Options$digits<- xxxx
    Robert> creates a local copy of .Options and changes the value of
    Robert> that. The only way that print can find this local copy is if it
    Robert> looks up the stack of calling functions to find it (or perhaps
    Robert> Splus squirrels it away somewhere that print looks but then <-
    Robert> starts to behave in a very peculiar manner).  This sort of
    Robert> behaviour is bad for two reasons 1) We really want people to
    Robert> use lexical scope and any examples where you have dynamic scope
    Robert> simply confuse things 2) It is quite inefficient for print (and
    Robert> anything else that uses Options) to have to look up the stack
    Robert> of calling functions.

ok;
yes, I wonder too, how S-plus does it. (Bill V. ?)
    
    Robert>   Since the method Martin so capably demonstrated with tst2
    Robert> does work (except I think he meant on.exit(options(oo)) rather
    Robert> than on.exit(oo)) I think we should stick with that. In that
    Robert> case the global value of options(digits) is changed for the
    Robert> duration of the function evaluation of tst2.
   
okay, I could live with it.

Problem is:

	In the current version (i.e. 0.50-a3), even  tst2(.)
						     ---^---
	does NOT work !
	(yes, it did before ..)

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug 13 12:13:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Aug 1997 13:13:35 +0200
Subject: R-alpha: .Options$digits do not (always) work.
In-Reply-To: Robert Gentleman's message of Wed, 13 Aug 1997 11:58:51 +1200 (NZST)
References: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>
Message-ID: <x290y6z674.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

>   Well it isn't really clear what Splus does to get tst to work. It appears
>   that they use some form of dynamic scope for Options. Clearly, the 
>   assignment,
>     .Options$digits<- xxxx
>   creates a local copy of .Options and changes the value of that. The only
>   way that print can find this local copy is if  it looks up the stack of
>   calling functions to find it (or perhaps Splus squirrels it away somewhere

Couldn't one have the digits argument of print default to
.Options$digits (or is that eval(.Options$digits,
sys.frame(sys.parent)) ??)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 13 17:21:00 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 Aug 1997 09:21:00 -0700 (PDT)
Subject: R-alpha: Matrix: I surrender
In-Reply-To: <199708130823.KAA01224@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970813085249.1515A-100000@zen>


To make what I was saying a little clearer, the fact that eg
y<-x[vec,]
y[1,]
returns an error if vec is of length 1 (or has one T, &c) is compatible
with S, but not with what most people expect when writing programs.
Statements like y<-x[vec,] nearly always need drop=F as otherwise any
future references to y must have special cases to handle vectors. 

The problem is that we should have drop=F when indexing by vectors that
happen to be of length 1 and drop=T when indexing by scalars. I suppose
it's reasonable to say that programmers can take care of themselves and we
should choose the best default for interactive use, which is certainly
drop=T. 

Perhaps we just need a mental health warning in the documentation and/or
the faq to remind programmers that array dimensions can vanish whenever
you subset. 

Also

Kurt wrote:
> 
> * Thomas, if you have ports of the above software, could you PLEASE
> package them?  (Btw, I have a finished `port' of the V&R `classif'
> library, and of the `clus' library which comes with the paper on JSS.)
> 

 I have ported the addreg library, with additions (and sent it back to
 Harald Fekjaer, who should be releasing it Real Soon Now).  The linear
 discrimination code I referred to is long obsolete and has been fixed (I
 saw it in 1992, I think). I'm intermittently working on the bayesian
 model averaging code, which was the major reason for creating the "leaps" 
 subset selection library. 


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 17:38:20 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 18:38:20 +0200
Subject: R-alpha: Re: R-beta: compiling R-5.0 on IRIX6.1
In-Reply-To: <9708131608.AA11484@isdux1.bham.ac.uk> (message from Dr X Cai on
 Wed, 13 Aug 1997 17:08:31 +0100)
Message-ID: <199708131638.SAA01351@sophie.ethz.ch>

Note that  R-0.50  is  ALPHA testing software
and should only be used by people who are willing to 'bleed'.

Their e-mail list is really  'R-devel' and  NOT  R-help
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Wed Aug 13 18:16:27 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 Aug 1997 13:16:27 -0400
Subject: R-alpha: update on patching
Message-ID: <97Aug13.131808edt.26507@mailgate.bank-banque-canada.ca>

Sorry for previously posting on R-help. 

Thanks to a few people for pointing out -p 0 on patch, but that was not enough (at least under Solaris). It seems Solaris tries to figure out which of the two files is to be updated, and if it finds them both then it starts asking for names. What I actually had to do was

1/ mv R-0.50-a1  R-0.50-a2
2/ cd R-0.50-a2
3/ patch -p 0 <R-0.50-a1.patch

If you 
 cp -r R-0.50-a1  R-0.50-a2
rather than mv, then you must rename R-0.50-a1 or the above mentioned problem occurs.

Paul
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Aug 13 21:18:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 14 Aug 1997 08:18:59 +1200 (NZST)
Subject: R-alpha: frame tools
Message-ID: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>

	Kurt Hornik writes:

	> What's also needed is something to produce and plot empirical
	> distribution functions.  I thought I could write something for my
	> Biostat course last semester, but it never happened ...

Have you had a look at the type="S" and type="s" options to plot?  They
produce two variants of step functions.  I didn't know about them until
I started implementing our version graphics.  They are documented in "par".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Aug 14 00:32:04 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Thu, 14 Aug 1997 11:32:04 +1200 (NZST)
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708132332.LAA23379@stat1.stat.auckland.ac.nz>

> From pd@kubism.ku.dk Wed Aug 13 23:11 NZS 1997
> To: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
> Cc: R-devel@stat.math.ethz.ch
> Subject: Re: R-alpha: .Options$digits  do not (always) work.
> From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
> Date: 13 Aug 1997 13:13:35 +0200
> 
> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
> 
> >   Well it isn't really clear what Splus does to get tst to work. It appears
> >   that they use some form of dynamic scope for Options. Clearly, the 
> >   assignment,
> >     .Options$digits<- xxxx
> >   creates a local copy of .Options and changes the value of that. The only
> >   way that print can find this local copy is if  it looks up the stack of
> >   calling functions to find it (or perhaps Splus squirrels it away somewhere
> 
> Couldn't one have the digits argument of print default to
> .Options$digits (or is that eval(.Options$digits,
> sys.frame(sys.parent)) ??)

  Ah, but how far up do you look? That's fine if print is called from the
  function that sets .Options but what if it is called from a function that
  is called from the function that is....called from the function that set
  .Options. Looking back up all of these is dynamic scope. It is pretty
  inefficient for print to have to look in all these places for a .Options
  before it can do its thing.
  
  Alternatively you could say that print either gets .Options from the parent
  or from top level and so it looks in sys.frame(sys.parent) but then someone
  will want to do it from the grandparent and not understand why it doesn't
  work. 
  
  I think it would be nice if Martin's example ended up in the FAQ (or a
  programming examples repository) with an explanation that the global
  .Options is checked; local copies aren't and that if you want to affect
  the global value you can do it in the manner shown in the example. I think
  this is a big change from what S does so it should be well signposted.
  
  robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From wvenable@attunga.stats.adelaide.edu.au  Thu Aug 14 06:13:11 1997
From: wvenable@attunga.stats.adelaide.edu.au (Bill Venables)
Date: Thu, 14 Aug 1997 14:43:11 +0930
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: <199708131037.MAA00520@sophie.ethz.ch>
References: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>
 <199708131037.MAA00520@sophie.ethz.ch>
Message-ID: <9708140513.AA13924@attunga.stats.adelaide.edu.au>

Martin Maechler writes:
 > >>>>> "Robert" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
 > 
 >     Robert> Martin wrote:
 >     >> I am sorry that this IS an old topic.  Yet another task I think the
 >     >> bug is somewhere in hidden in src/main/options.c ..
 >     >> 
 >     >> ##-- The following does not work as it should in R (0.50-a1, but I
 >     >> think also earlier)
 >     >> 
 >     >> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig);
 >     >> print(x);x} tst() tst(dig = 12)
 >     >> 
 >     >> 
 >     >> ##-- This should do the same; it works as expected in R & S :
 >     >> 
 >     >> tst2 <- function(x=pi, dig =3) { oo <- options(digits=dig);
 >     >> on.exit(oo); print(x);x} tst2() tst2(dig = 12)

I think not.  Here is what you probably meant to use

tst2 <- function(x = pi, dig = 3) {
  oo <- options(digits = dig)
  on.exit(options(oo))
  print(x)
  x
}

> tst2()
[1] 3.14
[1] 3.14159

Notice that the on.exit() happens after the function is complete
but before auto-printing.

 >     Robert> Well it isn't really clear what Splus does to get
 >     Robert> tst to work. It appears that they use some form of
 >     Robert> dynamic scope for Options.  Clearly, the
 >     Robert> assignment, .Options$digits <- xxxx creates a local
 >     Robert> copy of .Options and changes the value of
 >     Robert> that.  The only way that print can find this local
 >     Robert> copy is if it looks up the stack of calling
 >     Robert> functions to find it (or perhaps Splus squirrels
 >     Robert> it away somewhere that print looks but then <-
 >     Robert> starts to behave in a very peculiar manner).  This
 >     Robert> sort of behaviour is bad for two reasons 1) We
 >     Robert> really want people to use lexical scope and any
 >     Robert> examples where you have dynamic scope simply
 >     Robert> confuse things 2) It is quite inefficient for
 >     Robert> print (and anything else that uses Options) to
 >     Robert> have to look up the stack of calling functions.
 > 
 > ok;
 > yes, I wonder too, how S-plus does it. (Bill V. ?)

(? Y me?) Sorry, but I don't have any inside knowledge.  A little
experimentation shows that

> options(digits = 10)

operates like an assignment sequence of the form

> .Options$digits <- 10
> assign(".Options", .Options, where = 6)  # or wherever...
> remove(".Options")

Which you normally cannot do directly, of course, (and clearly
the effect is not permanent).

Bill.

-- 
Bill Venables, Head, Dept of Statistics,    Tel.: +61 8 8303 5418
University of Adelaide,                     Fax.: +61 8 8303 3696
South AUSTRALIA.     5005.   Email: Bill.Venables@adelaide.edu.au
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 14 09:30:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 14 Aug 1997 10:30:44 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: Robert Gentleman's message of Thu, 14 Aug 1997 11:32:04 +1200 (NZST)
References: <199708132332.LAA23379@stat1.stat.auckland.ac.nz>
Message-ID: <x2hgct4157.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> > Couldn't one have the digits argument of print default to
> > .Options$digits (or is that eval(.Options$digits,
> > sys.frame(sys.parent)) ??)
> 
>   Ah, but how far up do you look? That's fine if print is called from the
>   function that sets .Options but what if it is called from a function that
>   is called from the function that is....called from the function that set
>   .Options. Looking back up all of these is dynamic scope. It is pretty
>   inefficient for print to have to look in all these places for a .Options
>   before it can do its thing.
>   
>   Alternatively you could say that print either gets .Options from the parent
>   or from top level and so it looks in sys.frame(sys.parent) but then someone
>   will want to do it from the grandparent and not understand why it doesn't
>   work. 
>   
>   I think it would be nice if Martin's example ended up in the FAQ (or a
>   programming examples repository) with an explanation that the global
>   .Options is checked; local copies aren't and that if you want to affect
>   the global value you can do it in the manner shown in the example. I think
>   this is a big change from what S does so it should be well signposted.

Aha. Is this a case where S's "expression frame" does something useful
for once? I've always hated it because it prevents the whole language
from being self-similar: Run the good ol' read-eval-print loop and all
the assignments to frame 1 will get cleaned up between commands, make
a menu-style function that runs the same commands and the crud builds
up.

Maybe we need some kind of limited support for dynamically scoped
variables? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 14 13:01:31 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 14 Aug 1997 14:01:31 +0200
Subject: R-alpha: Re: R-beta:  R-0.49 on IRIX6.1 does not compile
In-Reply-To: <9708140950.AA23517@isdux1.bham.ac.uk> (message from Dr X Cai on
 Thu, 14 Aug 1997 10:50:08 +0100)
Message-ID: <199708141201.OAA01160@sophie.ethz.ch>

>>>>> "XC" == X Cai <caix@isdugp.bham.ac.uk> writes:

    XC> Dear Martin, I am sorry to put the message for the alpha testing
    XC> software.  In fact, when I compiled version R-0.49, the same error
    XC> occurred to me.  Is R-0.49 also at alpha testing stage?  This means
    XC> that I cannot use any version of R.  Do you have any idea about the
    XC> compiling error?


Dear Cai,

R-0.49  was released as beta. 
and
it's good to know about compilation problems, even for alpha releases.

My point really was that you should send reports like these to R-devel
rather than R-help.

    XC> Your kind assistance would be greatly appreciated!

I can only help a little:

1) The 'statement is unreachable' is really just a warning.
   [ I also get a few of those when compiling 
     under Solaris 2.5.1 with Sun's cc.]
 
   They shouldn't have caused your compilation problem.

   [now, see below]

    XC> p.s.: The last few lines of message when compiling R-0.49:

    XC> 	cc -g -I../include -DPOSIX_MISTAKE -c regerror.c
    XC> 	cc -g -I../include -DPOSIX_MISTAKE -c regexec.c
    XC> "engine.c", line 604: warning(1110): statement is unreachable
    XC>   		break;
    XC>   		^

    XC> "engine.c", line 610: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 616: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 627: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 648: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 659: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 670: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 604: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 610: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 616: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 627: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 648: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 659: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 670: warning(1110): statement is unreachable
    XC> break; ^



    XC> Signal: SIGSEGV in Scope Setup phase.
    XC> ### Error (user routine 'sdissect'):
    XC> ### Signal SIGSEGV in phase Scope Setup -- processing aborted
    XC> cc ERROR:  /usr/lib64/cmplrs/fec died due to signal 4
    XC> cc ERROR:  core dumped
    XC> *** Error code 2 (bu21)
    XC> *** Error code 1 (bu21)
    XC> *** Error code 1 (bu21)

Just above lies the compilation error culprit.
Unfortunately, I have no idea what  "Scope Setup phase"  means...

Can you find out what  'fec' is doing, or where  'bu21' comes from?


Probably someone else from the R-devel  list can help you better than I
do...
-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From caix@isdugp.bham.ac.uk  Thu Aug 14 14:40:20 1997
From: caix@isdugp.bham.ac.uk (Dr X Cai)
Date: Thu, 14 Aug 1997 14:40:20 +0100
Subject: R-alpha: Compiling 0.49 on IRIX6.1
Message-ID: <9708141340.AA14089@isdux1.bham.ac.uk>

Hi,

I am compiling R-0.49 on my SGI Indigo 2 R8000 machine and it stopped
in the middle.  Could anyone help me to fix it?

Many thanks!
-- 

                                     Xiaoming Cai
                                     School of Geography
      .&______~*@*~______&.          University of Birmingham
    "w/%%%%%%%%%%%%%%%%%%%\w"        Edgbaston, Birmingham
      `Y""Y""Y"""""Y""Y""Y'          B15 2TT United Kingdom
   p-p_|__|__|_____|__|__|_q-q       Tel: 44 (121) 414-5533 (O)
_-[EEEEM==M==MM===MM==M==MEEEE]-_    Tel: 44 (121) 454-4018 (H)
                                     Fax: 44 (121) 414-5528


p.s.:  The last few lines of message when compiling R-0.49:

	cc -g -I../include -DPOSIX_MISTAKE -c regerror.c
	cc -g -I../include -DPOSIX_MISTAKE -c regexec.c
"engine.c", line 604: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 610: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 616: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 627: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 648: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 659: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 670: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 604: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 610: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 616: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 627: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 648: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 659: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 670: warning(1110): statement is unreachable
  		break;
  		^

Signal: SIGSEGV in Scope Setup phase.
### Error (user routine 'sdissect'):
### Signal SIGSEGV in phase Scope Setup -- processing aborted
cc ERROR:  /usr/lib64/cmplrs/fec died due to signal 4
cc ERROR:  core dumped
*** Error code 2 (bu21)
*** Error code 1 (bu21)
*** Error code 1 (bu21)


-- 

                                     Xiaoming Cai
                                     School of Geography
      .&______~*@*~______&.          University of Birmingham
    "w/%%%%%%%%%%%%%%%%%%%\w"        Edgbaston, Birmingham
      `Y""Y""Y"""""Y""Y""Y'          B15 2TT United Kingdom
   p-p_|__|__|_____|__|__|_q-q       Tel: 44 (121) 414-5533 (O)
_-[EEEEM==M==MM===MM==M==MEEEE]-_    Tel: 44 (121) 454-4018 (H)
                                     Fax: 44 (121) 414-5528
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 14 19:58:29 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 Aug 1997 11:58:29 -0700 (PDT)
Subject: R-alpha: library()
In-Reply-To: <97Aug13.131808edt.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970814115635.1947A-100000@zen>


The CHANGES file says that libraries can now have a .First.lib and
.Last.lib function.  While this is certainly true the functions don't seem
to get called...


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 14 20:38:31 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 Aug 1997 12:38:31 -0700 (PDT)
Subject: R-alpha: autoload again
In-Reply-To: <Pine.SUN.3.95.970814115635.1947A-100000@zen>
Message-ID: <Pine.SUN.3.95.970814123032.1947B-100000@zen>


I have made an autoload library, with a nicer version of the autoload code
I posted a few weeks ago.  It now stores things in a special environment
and it will re-autoload libraries that have been detached. It only works
with the new alpha R. The syntax is eg
autoload("line","eda") 
to automatically load library("eda") when the function line() is invoked.

The library file is at 
http://www.biostat.washington.edu/~thomas/autoload.tar.gz

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 15 08:45:41 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 15 Aug 1997 09:45:41 +0200
Subject: R-alpha: autoload  -- cool!
In-Reply-To: <Pine.SUN.3.95.970814123032.1947B-100000@zen> (message from
 Thomas Lumley on Thu, 14 Aug 1997 12:38:31 -0700 (PDT))
Message-ID: <199708150745.JAA02268@sophie.ethz.ch>

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> I have made an autoload library, with a nicer version of the
    Thomas> autoload code I posted a few weeks ago.  It now stores things
    Thomas> in a special environment and it will re-autoload libraries that
    Thomas> have been detached. It only works with the new alpha R. The
    Thomas> syntax is eg autoload("line","eda") to automatically load
    Thomas> library("eda") when the function line() is invoked.

    Thomas> The library file is at
    Thomas> http://www.biostat.washington.edu/~thomas/autoload.tar.gz

I did not try it (yet);
however, it's such a cool idea that I think 
it should make its way into "R base" !

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 15 09:25:04 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 15 Aug 1997 20:25:04 +1200 (NZST)
Subject: R-alpha: autoload  -- cool!
Message-ID: <199708150825.UAA17107@stat1.stat.auckland.ac.nz>

Sounds great!  I will snag a copy and add it.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 15 16:06:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 15 Aug 1997 17:06:35 +0200
Subject: R-alpha: (minor?) S-R inconsistency:  NULL =~= list()  -- useful is.ALL function
Message-ID: <199708151506.RAA02837@sophie.ethz.ch>


In S, 
	NULL
and
	list()
are not the same.

In R they are (I think).

---------------------------------------------------

At least,

	is.list(NULL) #-> 'F' in S;   'TRUE' in R


Yes: I had an instance where this broke correct S code:

	match(c("xlab","ylab"), names(list(...)))

when '...' is empty, 
gives an error in R,
but gives
	c(NA,NA)
in S.

------------
You may like my function 'is.ALL(.)' for detecting things like these :
(actually some more functions;
 a relatively nice example of using NextMethod(..) for a new "print" method
)

is.ALL <- function(obj, func.names = ls("library:base"),
                   not.using = c("is.single", "is.na.data.frame", "is.loaded"),
                   true.only = FALSE)
{
  ## Purpose: show many 'attributes' of  R object __obj__
  ## -------------------------------------------------------------------------
  ## Arguments: obj: any R object
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date:  6 Dec 96, 15:23

  is.fn <- func.names[substring(func.names,1,3) == "is."]
  use.fn <- is.fn[ is.na(match(is.fn, not.using))]

  r <- if(true.only) character(0)
  else structure(vector("list", length= length(use.fn)), names= use.fn)
  for(f in use.fn) {
    if(any(f == c("is.na", "is.finite"))) {
      if(!is.list(obj) && !is.vector(obj) && !is.array(obj)) {
        if(!true.only) r[[f]] <- NA
        next
      }
    }
    ##prt.DEBUG("f =",f,"; last rr:", if(f!=use.fn[1]) rr else ".. not yet..")
    rr <-  (get(f))(obj)
    if(!is.logical(rr)) cat("f=",f," --- rr  is NOT logical  = ",rr,"\n")
    ##if(1!=length(rr))   cat("f=",f," --- rr NOT of length 1; = ",rr,"\n")
    if(true.only && length(rr)==1 && rr) r <- c(r, f)
    else if(!true.only) r[[f]] <- rr
  }
  if(is.list(r)) structure(r, class = "isList") else r
}

print.isList <- function(r, ...)
{
  ## Purpose:  print METHOD  for  'isList' objects
  ## -------------------------------------------------------------------------
  ## Arguments:
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date: 12 Mar 97, 15:07
  ## >>>>> needs  cmp.logical  --> /u/maechler/R/Util.R
  if(is.list(r)) {
    nm <- format(names(r))
    rr <- lapply(r,cmp.logical)
    for(i in seq(along=r)) cat(nm[i],":",rr[[i]],"\n", ...)
  } else NextMethod("print", ...)
}

cmp.logical <- function(log.v)
{
  ## Purpose: compact printing of logicals
  ## -------------------------------------------------------------------------
  ## Arguments: log.v : logical vector
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date: 13 Dec 96, 16:28
  if(!is.logical(log.v)) {
    warning("coercing argument 'log.v' to logical")
    log.v <- as.logical(log.v)
  }
  structure(if(length(log.v) == 0) "()" else c(".","|")[ 1+ log.v],
	    class = "noquote")
}


## The constructor function
noquote <- function(obj) {
  if(!inherits(obj,"noquote"))
    class(obj) <- c(class(obj),"noquote")
  obj
}
##-- this is just like 'expression'
"[.noquote" <- function (x, subs) structure(unclass(x)[subs], class = "noquote")
## A method for (character) objects of class  'noquote' :
print.noquote <- function(obj,...) {
  cl <- class(obj)
  class(obj) <- cl[cl != "noquote"]
  NextMethod('print', obj, quote = F, ...)
}


### ------------------------------------------------------------------
### Here are some examples on its (is.ALL)  usage :


is.ALL(NULL)

###------- more compactly : ------------ here, we see that   NULL "==" list()

is.ALL(NULL,   true.only = TRUE)
## [1] "is.atomic" "is.list"   "is.null"  
is.ALL(list(), true.only = TRUE)
## [1] "is.atomic" "is.list"   "is.null"  



is.ALL(1:5)
is.ALL(array(1:24, 2:4))
is.ALL(1 + 3)
e13 <- expression(1 + 3)
is.ALL(e13)
## fails (0.50-a) [is.loaded]
##   is.ALL(e13, not.using=c("is.single", "is.finite", "is.na"))
is.ALL(y ~ x) #--> (0.49):  NA  for 'is.na' (& is.finite)



is.ALL(numeric(0), true=T)
is.ALL(array(1,1:3), true=T)
is.ALL(cbind(1:3), true=T)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Aug 15 16:53:11 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 15 Aug 1997 08:53:11 -0700 (PDT)
Subject: R-alpha: (minor?) S-R inconsistency:  NULL =~= list()  -- useful is.ALL function
In-Reply-To: <199708151506.RAA02837@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970815084207.2193A-100000@zen>

On Fri, 15 Aug 1997, Martin Maechler wrote:
> In S, 
> 	NULL
> and
> 	list()
> are not the same.
> 
> In R they are (I think).
> 

The thing that really broke your code is an incompatibility I reported a
while back that people didn't seem to think was serious.  

Comparisons involving NULL give an error in R, but give NA in S.  I didn't
have an example at the time except to point out that returning NA would at
least allow correct short-circuiting of & and | conditions. 

I think in match() there is a much stronger argument for returning NA (or
the nomatch value).  After all, the description of match says

             If x[i] is found to equal table[j] then the value
             returned in the i-th position of the return value is j.
             If no match is found, the value is nomatch.

Surely if table==NULL then the correct return value is nomatch.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 18 10:00:25 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 18 Aug 1997 11:00:25 +0200
Subject: R-alpha: Re: R-beta: Bug or feature?  [+ better histograms]
In-Reply-To: <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
References: <199708170921.VAA03388@stat1.stat.auckland.ac.nz>
 <9708172313.AA15474@attunga.stats.adelaide.edu.au>
 <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
Message-ID: <199708180900.LAA02371@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Bill Venables writes:
>> First a bit of an explanation.  Brian Ripley and I are firmly of
>> the opinion that, to be any use in teaching at all, histograms
>> should be nonparametric estimators of the probability density
>> function.  That is, the vertical scale should be a relative
>> frequency density scale.  It seems impossible to get this in R, so
>> here is a function (+ a few extras) that does give you a "true"
>> histogram, (unless you are peverse enough to request otherwise.)

> Oh goody!  I HATE the present hist; partly because of the
> frequency/density aspect, but mainly because if I ask for 10 cells I
> expect to get 10 cells, not 7 or 35 or whatever.  I'd like propose
> that the present hist get renamed hist.old (or something similar) and
> that Bill's "truehist" become the true "hist".

I'd say, get rid of the old one ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 18 10:51:57 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Aug 1997 11:51:57 +0200
Subject: R-alpha: Re: R-beta: Bug or feature?  [+ better histograms]
In-Reply-To: Kurt Hornik's message of Mon, 18 Aug 1997 11:00:25 +0200
References: <199708170921.VAA03388@stat1.stat.auckland.ac.nz>
 <9708172313.AA15474@attunga.stats.adelaide.edu.au>
 <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
 <199708180900.LAA02371@aragorn.ci.tuwien.ac.at>
Message-ID: <x23eo7ddj6.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Ross Ihaka writes:
> 
> > Bill Venables writes:
> >> First a bit of an explanation.  Brian Ripley and I are firmly of
> >> the opinion that, to be any use in teaching at all, histograms
> >> should be nonparametric estimators of the probability density
> >> function.  That is, the vertical scale should be a relative
> >> frequency density scale.  It seems impossible to get this in R, so
> >> here is a function (+ a few extras) that does give you a "true"
> >> histogram, (unless you are peverse enough to request otherwise.)
> 
> > Oh goody!  I HATE the present hist; partly because of the
> > frequency/density aspect, but mainly because if I ask for 10 cells I
> > expect to get 10 cells, not 7 or 35 or whatever.  I'd like propose
> > that the present hist get renamed hist.old (or something similar) and
> > that Bill's "truehist" become the true "hist".
> 
> I'd say, get rid of the old one ...
> 

Ugh. Please do NOT do that! Some of us need to teach histograms to
people who have difficulties with integrals (and also in recognizing
the connection between a barplot and a step function), so we have to
make do with "shape of curve" considerations, at least in the
beginning. The last thing we need is inexplicable y-axes.

The "# in bin" is not really problematic as long as the the bins are
of the same size and *much* easier to explain to students. 

Even for a statistician, the number is really what conveys the
accuracy estimate that you need when you try to evaluate whether a
histogram matches a given density.

Make it an option, e.g. hist(x,as.density=T). People who can
understand why the "sum of area of blocks should be 1" can also figure
out how to add an option to a function call.

I could easily do without the "prettification" silliness, though.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 18 14:03:37 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Aug 1997 15:03:37 +0200
Subject: R-alpha: Re: R-beta: .C and dyn.load for Windows
In-Reply-To: Goran Brostrom's message of Mon, 18 Aug 1997 14:10:10 +0200 (MET DST)
References: <Pine.GSO.3.95.970818135113.11654A-100000@pc30.stat.umu.se>
Message-ID: <x2yb5zbq3a.fsf@bush.kubism.ku.dk>

Goran Brostrom <gb@pc30.stat.umu.se> writes:

> 
> Dear R-users,
> 
> I maintain software for survival analysis written in C and Fortran since
> many years ago. Recently I have rewritten part of it as functions to
> be called from R by .C. This works fine with the unix version. I just
> create a ".so" file as described in an example in the R distribution.
> 
> However, when I try this approach in Windows (NT or 95), using the 
> Cygnus gcc latest version, the "ld" command to create the ".so" file fails
> miserably. The Windows R documentation talks about "DLL"s, of which I
> know very little.
> 
> Can anyone tell me how to create R-loadable C-code with Cygnus gcc under
> Windows (NT, 95)?
> Maybe it isn't possible?

(This really is alpha/development  stuff, belonging on r-devel)

Is this the Cygnus gcc from gnuwin32? You're a very brave person..!
You didn't happen to get the Windows GUI stuff going while you were at
it, did you?

Robert Gentleman says that he has DLL loading "near the top of his
list" for the next Windows binary version.

Another pointer is that it is rumored that *scilab* has some code to
do the trick on the windows platforms

Some nice guy on the gnuwin32 list claimed to have compatibility
functions for the whole dlopen/dlsym/.. slew a few weeks ago.

BTW: You do know that there already is a quite comprehensive survival
package for R?

Here is the note from gnuwin32:

------------------
Dear all,

I have made some work to let dlls have almost the same behavior as so on UNIX:

        - implementation of dlopen,dlclose,dlsym,dlerror
        - correct init when loaded + call of global contructors
        - call of global destructors when detached
        - dlls are accessible and correctly initialized in forked process
        - handles got through dlopen or dlsym in parent are accessible in child
        - use of LD_LIBRARY_PATH in dlopen search

I think it can help people who need an intensive use of dll ( plugins ... )

My patch is 59082 bytes, so I will not send it to the list.
Anyway, if you are interested, send me a mail and I will send you the patch
personnaly ...

Regards.

P.S: I will send the patch to Geoffrey Noer


 ==========================================================================
|                         Philippe GIACINTI                                |
|                                                                          |
| DALiM GmbH R&D                                email:  giac@dalim.de      |
| Daimler Strasse 2,                            tel:    +49.7851.9196-28   |
| D-77694 Kehl-Sundheim Germany                 fax:    +49.7851.73576     |
|                                                                          |
 ==========================================================================


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Tue Aug 19 09:53:48 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Tue, 19 Aug 1997 10:53:48 +0200 (MET DST)
Subject: R-alpha: A few bugs in R-0.50-a3.
Message-ID: <9708190853.AA10759@alpha.luc.ac.be>

A few problems in R-0.50-a3 (which were also in R-0.49):

1)
y <- c(10,11,12,13,14,NA,NA)
n <- length(y)
missed <- (1:n)[is.na(y)]
notmissed <- (1:n)[!is.na(y)]
blocks <- cut(missed,breaks=c(0,notmissed,n+1))
a <- function(v) {
	q <- range(v)
	c(q[1]-1,q[2]+1)
}
brackets <- tapply(missed,blocks,a)

This codes gives the following in S:
> brackets
$"0+ thru 1":
NULL

$"1+ thru 2":
NULL

$"2+ thru 3":
NULL

$"3+ thru 4":
NULL

$"4+ thru 5":
NULL

$"5+ thru 8":
[1] 5 8

>

And the following in R:

> brackets <- tapply(missed,blocks,a)
Error: names attribute must be same length as the vector

I also had similar problems when using "lm" with data containing NA's
but could not find back a precise example...

2)
b <- list(2)
names(b) <- "lty"
a <- function(...) {
	par(c(...,b))
	par()
}
a()


The following is obtained in S:
> win.graph()
> a()
$"1em":
[1] 0.03150623 0.05075211

$adj:
[1] 0.5

$ask:
[1] F

$bty:
[1] "o"

$cex:
[1] 1

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 19 19:51:17 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 19 Aug 1997 20:51:17 +0200
Subject: R-alpha: ECDFs
In-Reply-To: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>
References: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>
Message-ID: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> 	Kurt Hornik writes:
>> What's also needed is something to produce and plot empirical
>> distribution functions.  I thought I could write something for my
>> Biostat course last semester, but it never happened ...

> Have you had a look at the type="S" and type="s" options to plot?
> They produce two variants of step functions.  I didn't know about them
> until I started implementing our version graphics.  They are
> documented in "par".

I hadn't known about them either, but I think Martin's plot.step is
needed for plotting e.g. ECDFs.

Here's something what is needed for teaching elementary statistics:
Given a sample vector x, compute the corresponding ECDF, plot it, and
perhaps evaluate it at points other than the data points.

One solution might be to have a function "ecdf" which returns an obj of
class "step" (e.g., simply a list with the points where the jumps occur
and the corresponding values, and maybe if we want to be more general
than that info on whether the function is left- or right-continuous at
the point (or perhaps attains a different value).  (I.e., something of
the kind that Martin's plot.step uses ...)

This would more or less automagically take care of the plotting part.
We could also easily add print and summary methods.

The question is, how can we `easily' evaluate a step function at some
point?  Using `predict' does not seem to be the right thing ... any
suggestions?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 19 19:55:34 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 19 Aug 1997 11:55:34 -0700 (PDT)
Subject: R-alpha: ECDFs
In-Reply-To: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>

On Tue, 19 Aug 1997, Kurt Hornik wrote:
> 
> Here's something what is needed for teaching elementary statistics:
> Given a sample vector x, compute the corresponding ECDF, plot it, and
> perhaps evaluate it at points other than the data points.

The approx() function is supposed to do this (it currently only does
linear interpolation).  If the right and left continuous step functions
were added to approx then we could easily use approxfun to define the ECDF
as a function closure, making it automatically available at any point you
want. After all, the ECDF *is* a function.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 19 19:57:56 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 19 Aug 1997 20:57:56 +0200
Subject: R-alpha: A few bugs in R-0.50-a3.
In-Reply-To: <9708190853.AA10759@alpha.luc.ac.be>
References: <9708190853.AA10759@alpha.luc.ac.be>
Message-ID: <199708191857.UAA02786@aragorn.ci.tuwien.ac.at>

>>>>> Patrick Lindsey writes:

> A few problems in R-0.50-a3 (which were also in R-0.49):
> 1)
> y <- c(10,11,12,13,14,NA,NA)
> n <- length(y)
> missed <- (1:n)[is.na(y)]
> notmissed <- (1:n)[!is.na(y)]
> blocks <- cut(missed,breaks=c(0,notmissed,n+1))
> a <- function(v) {
> 	q <- range(v)
> 	c(q[1]-1,q[2]+1)
> }
> brackets <- tapply(missed,blocks,a)

> This codes gives the following in S:
>> brackets
> $"0+ thru 1":
> NULL

> $"1+ thru 2":
> NULL

> $"2+ thru 3":
> NULL

> $"3+ thru 4":
> NULL

> $"4+ thru 5":
> NULL

> $"5+ thru 8":
> [1] 5 8

>> 

> And the following in R:

>> brackets <- tapply(missed,blocks,a)
> Error: names attribute must be same length as the vector

> I also had similar problems when using "lm" with data containing NA's
> but could not find back a precise example...

I think the patch below (which should make it into the next set of
patches) fixes that.

(Except for the differences in cut() ...)

--- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
+++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
@@ -14,7 +14,7 @@
 		index <- as.factor(INDEX[[i]])
 		if (length(index) != nx) 
 			stop("arguments must have same length")
-		namelist[[i]] <- levels(index)
+		namelist[[i]] <- unique(levels(index)[index])
 		extent[[i]] <- nlevels(index)
 		group <- group + ngroup * (codes(index) - 1)
 		ngroup <- ngroup * nlevels(index)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 19 19:58:13 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 19 Aug 1997 11:58:13 -0700 (PDT)
Subject: R-alpha: tapply
In-Reply-To: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
Message-ID: <Pine.SUN.3.95.970819115641.28406E-100000@chekov>


tapply() has been broken for a long time and is still wrong in 50-a3.  I
think the following version works. 

	-thomas

"tapply" <-function (x, INDEX, FUN, ...) 
{
        if (is.character(FUN)) 
                FUN <- get(FUN, mode = "function")
        if (mode(FUN) != "function") 
                stop(paste("\"", FUN, "\" is not a function"))
        if (!is.list(INDEX)) 
                INDEX <- list(INDEX)
        namelist <- vector("list", length(INDEX))
        extent <- integer(length(INDEX))
        nx <- length(x)
        group <- rep(1, nx)
        ngroup <- 1
        for (i in seq(INDEX)) {
                index <- as.factor(INDEX[[i]])
                if (length(index) != nx) 
                        stop("arguments must have same length")
                namelist[[i]] <- levels(index)
                extent[[i]] <- nlevels(index)
                group <- group + ngroup * (codes(index) - 1)
                ngroup <- ngroup * nlevels(index)
        }
        if (missing(FUN))  
                return(group)
	ansmat<-array(NA,dim=extent,dimnames=namelist)
        ans <- lapply(split(x, group), FUN, ...)
        if (all(unlist(lapply(ans, length)) == 1)) {
                ans <- unlist(ans, recursive = FALSE)
	      }
	else { mode(ansmat)<-"list"}
	ansmat[as.numeric(names(ans))]<-ans
	ans<-ansmat
        return(ans)
}


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 09:45:21 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 10:45:21 +0200
Subject: R-alpha:  tapply patch -- Thomas version?
In-Reply-To: <199708191857.UAA02786@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 19 Aug 1997 20:57:56 +0200)
Message-ID: <199708200845.KAA02289@sophie.ethz.ch>


>>>>> Patrick Lindsey writes:
> A few problems in R-0.50-a3 (which were also in R-0.49):
> 1)
> y <- c(10,11,12,13,14,NA,NA)
> n <- length(y)
> missed <- (1:n)[is.na(y)]
> notmissed <- (1:n)[!is.na(y)]
> blocks <- cut(missed,breaks=c(0,notmissed,n+1))
> a <- function(v) {
> 	q <- range(v)
> 	c(q[1]-1,q[2]+1)
> }
> brackets <- tapply(missed,blocks,a)

> This codes gives the following in S:   

> .....

    Kurt> I think the patch below (which should make it into the next set of
    Kurt> patches) fixes that.

yes, it does fix the problem -- and it has been in the current source tree
for about 10 days...
 
   Kurt> (Except for the differences in cut() ...)

    Kurt> --- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
    Kurt> +++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
    Kurt> @@ -14,7 +14,7 @@
    Kurt> index <- as.factor(INDEX[[i]])
    Kurt> if (length(index) != nx) 
    Kurt> stop("arguments must have same length")
    Kurt> -		namelist[[i]] <- levels(index)
    Kurt> +		namelist[[i]] <- unique(levels(index)[index])
    Kurt> extent[[i]] <- nlevels(index)
    Kurt> group <- group + ngroup * (codes(index) - 1)
    Kurt> ngroup <- ngroup * nlevels(index)
 
Thomas, what does your function do differently ?

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 16:52:53 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 17:52:53 +0200
Subject: R-alpha: R-0.50-a3(+) Method despatching bug ?
Message-ID: <199708201552.RAA02602@sophie.ethz.ch>

It is very wierd...  Can some of you confirm the following behavior ?
It is a new bug (feature ?)  which was not yet in 0.49 ...




noquote <- function(obj) {
	## constructor for a useful "minor" class
	if(!inherits(obj,"noquote")) class(obj) <- c(class(obj),"noquote")
	obj
}
"[.noquote" <- function (x, subs) structure(unclass(x)[subs], class = "noquote")

print.noquote <- function(obj,...) {
	## method for (character) objects of class 'noquote'
	cl <- class(obj)
	class(obj) <- cl[cl != "noquote"]
	NextMethod("print", obj, quote = FALSE, ...)
}

nq <- noquote(letters)

##-- the next two should be equivalent, but are not ...?..
print(nq)
nq

> print(nq)
 [1] a b c d e f g h i j k l m n o p q r s t u v w x y z

> nq
Error: couldn't find function "print.noquote"
> unclass(nq)
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"
[20] "t" "u" "v" "w" "x" "y" "z"
> nq
Error: couldn't find function "print.noquote"
> ls()
[1] "[.noquote"     "noquote"       "nq"            "print.noquote"
> print.noquote
function (obj, ...) 
{
        ## method for (character) objects of class 'noquote'
        cl <- class(obj)
        class(obj) <- cl[cl != "noquote"]
        NextMethod("print", obj, quote = FALSE, ...)
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 18:06:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 19:06:11 +0200
Subject: R-alpha: R-0.50-a3: [logical, drop = FALSE] -- bug in R (and S-plus)
Message-ID: <199708201706.TAA02765@sophie.ethz.ch>

This is a bug both in R and S-plus (in R it's "worse"), I think.
Look at this :

ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
ma[logi,]
##>      [,1] [,2]
##> [1,]    1    1
##> [2,]    1    3
##> [3,]    1    5
##> [4,]    1    7

##-- now the same with  [ , drop = FALSE]

## R (-0.50-a3) :

	 ma[logi, drop = F]
##>> Error: invalid subscript type


## Splus-3.4:
	 ma[logi, drop = F]
##>> [1] 1 1 1 1 1 3 5 7

##---- which is not correct either, we would want the matrix !
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 20 18:21:25 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 Aug 1997 10:21:25 -0700 (PDT)
Subject: R-alpha: R-0.50-a3: [logical, drop = FALSE] -- bug in R (and S-plus)
In-Reply-To: <199708201706.TAA02765@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970820101359.641C-100000@chekov>

On Wed, 20 Aug 1997, Martin Maechler wrote:

> This is a bug both in R and S-plus (in R it's "worse"), I think.

I don't think it's a bug

> Look at this :
> 
> ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
> ma[logi,]
> ##>      [,1] [,2]
> ##> [1,]    1    1
> ##> [2,]    1    3
> ##> [3,]    1    5
> ##> [4,]    1    7
> 
> ##-- now the same with  [ , drop = FALSE]
> 
> ## R (-0.50-a3) :
> 
> 	 ma[logi, drop = F]
> ##>> Error: invalid subscript type
> ## Splus-3.4:
> 	 ma[logi, drop = F]
> ##>> [1] 1 1 1 1 1 3 5 7

This is correct.  Did you mean ma[logi,,drop=F]? If you use
ma[logi,drop=F] then this is the equivalent of ma[logi] with drop=F. But
ma[logi] treats the matrix as a vector and there aren't any dimensions to
drop. R should probably recycle the index vector the way S does. 

The loss of dimensions is unavoidable -- suppose you had
ma[c(3,7,8),drop=F].  How are you going to turn this into a matrix?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Wed Aug 20 18:34:35 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Wed, 20 Aug 1997 10:34:35 -0700 (PDT)
Subject: R-alpha: R-0.50-a3(+) Method despatching bug ?
In-Reply-To: <199708201552.RAA02602@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970820094622.641B-100000@chekov>

On Wed, 20 Aug 1997, Martin Maechler wrote:

> It is very wierd...  Can some of you confirm the following behavior ?
> It is a new bug (feature ?)  which was not yet in 0.49 ...
>

I'm not sure that you can expect NextMethod to work if you fiddle with the
class list...

However, there is still something wrong with method dispatching, since
print.noquote <- function (obj, ...)  NextMethod(quote = FALSE,...)
doesn't work either.  The error occurs when R tries for some reason to
make a recursive call to print.noquote.

Using debug() also shows the interesting fact that
R> nq 
calls print() with its arguments evaluated
------
debugging in: print(structure(c("a", "b", "c", "d", "e", "f", "g", "h",
"i", 
"j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", 
"w", "x", "y", "z"), class = "noquote"))
debugging in: print.noquote(structure(c("a", "b", "c", "d", "e", "f", "g", 
"h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", 
"u", "v", "w", "x", "y", "z"), class = "noquote"))
Error: couldn't find function "print.noquote"
-------
but
----------
R> print(nq)
 print(nq)
debugging in: print(nq)
debugging in: print.noquote(nq)
 [1] a b c d e f g h i j k l m n o p q r s t u v w x y z
attr(,"class")
[1] noquote
exiting from: print.noquote(nq)
exiting from: print(nq)
----------
doesn't evaluate the argument first.




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Aug 20 19:26:20 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 20 Aug 1997 13:26:20 -0500
Subject: R-alpha: The Template Numerical Toolkit and R
Message-ID: <6r3eo4soc3.fsf@franz.stat.wisc.edu>

I have tried linking C++ code using the Template Numerical Toolkit
version 0.8.3 (see http://math.nist.gov/tnt/) with R-0.50-a3 (see
http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html).  I expected this to
be very difficult.  It was very easy.  I was pleasantly surprised.
Nice work by the developers all around.

A bit of background for the R crowd: TNT, being developed by Roldan
Pozo at the National Institute for Standards and Technology, is the
successor to lapack++

As the name indicates, all the representations in TNT are templated.
The advantages of using it with R would be that one could obtain the
execution speed of compiled linear algebra code without the
corresponding hassle of keeping track of all the dimensions associated
with matrix representations in Fortran.  All of us really love to
write those calls that require
 A, LDA, M, N
for each matrix being passed but some of us in the baby boomer
generation are getting on in age and we lose track of the calling
sequence at about the 12th argument :-)

TNT creates all matrices as copies of the original content.  Because
it is written in C++, it gracefully handles the releasing of the
storage when the identifier goes out of scope.

Here is a sample run on a Linux system
$ cat R_link.cc
// An example of linking the Template Numerical Toolkit 0.8.3 with R-0.50 
// 
#include "tnt.h" 
#include "vec.h" 
#include "fmat.h" 
 
extern "C" { 
  static double * 
    copy_contents(double *dest, Fortran_matrix<double> A) 
    { 
      double *dd = dest, *src = &A(1,1); 
      int nn = A.num_rows() * A.num_cols(); 
 
      while (nn--) { *dd++ = *src++; } 
      return dest; 
    } 
 
  void my_mat_sum(double * A, double * B, long int * dims) { 
    Fortran_matrix<double> 
      AA(dims[0], dims[1], A),  // creates a copy 
      BB(dims[0], dims[1], B), 
      CC = AA + BB; 
 
    cout << "A on input: " << AA << endl; 
    cout << "B on input: " << BB << endl; 
    cout << "Sum: " << CC << endl;  
    copy_contents(A, CC); 
  } 
} 
$ g++ -c -fpic R_link.cc 
$ ld -shared -o R_link.so R_link.o -lstdc++ 
$ R 
 
R : Copyright 1997, Robert Gentleman and Ross Ihaka 
Version 0.50 Alpha-3 (August 8, 1997) 
 
R is free software and comes with ABSOLUTELY NO WARRANTY. 
You are welcome to redistribute it under certain conditions. 
Type "license()" for details. 
 
[Previously saved workspace restored] 
 
> A 
           [,1]       [,2]       [,3] 
[1,] -0.2713707 -1.1715863  0.8884861 
[2,] -1.7103328  0.6957497 -0.7603538 
> B 
          [,1]      [,2]       [,3] 
[1,] -1.573575 0.1554325 -1.1013854 
[2,] -1.151815 0.1632211 -0.4710143 
> A+B 
          [,1]       [,2]       [,3] 
[1,] -1.844946 -1.0161538 -0.2128993 
[2,] -2.862148  0.8589708 -1.2313680 
> dyn.load("R_link.so") 
> .C("my_mat_sum", A, B, as.integer(dim(A)))[[1]] 
A on input: 2 3 
-0.271371 -1.17159 0.888486  
-1.71033 0.69575 -0.760354  

B on input: 2 3 
-1.57357 0.155432 -1.10139  
-1.15181 0.163221 -0.471014  
 
Sum: 2 3 
-1.84495 -1.01615 -0.212899  
-2.86215 0.858971 -1.23137  
 
          [,1]       [,2]       [,3] 
[1,] -1.844946 -1.0161538 -0.2128993 
[2,] -2.862148  0.8589708 -1.2313680 
> q() 
Save workspace image? [y/n/c]: n 

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 20 22:31:07 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 Aug 1997 14:31:07 -0700 (PDT)
Subject: R-alpha: names for .RData
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970820141956.24129B-100000@chekov>


It would be nice for the save file name .RData to be a variable in
config.site (unless the machine-independent files are coming very soon). 
We are currently running R on a cluster with both sparc-solaris and
intel-linux machines, which don't like each other's .RData files.  At the
moment I edit the source files by hand to change the name to .RData-linux.

On a related topic, has anyone given any more thought to installing
multiple binaries in the same directory tree (as suggested some time ago
by Greg Warnes)?  This could save quite a lot of space as well as making
it easier to keep different operating systems synchronised. 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 21 08:40:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 21 Aug 1997 09:40:08 +0200
Subject: R-alpha:  [logical, drop = FALSE] -- my silliness ..
In-Reply-To: <Pine.SUN.3.95.970820101359.641C-100000@chekov> (message from
 Thomas Lumley on Wed, 20 Aug 1997 10:21:25 -0700 (PDT))
Message-ID: <199708210740.JAA03263@sophie.ethz.ch>

I must have been a bit tired or screwed up otherwise:
As Thomas guessed, I've forgotten the extra ","  which is needed for drop=..

ma[logi, , drop = FALSE]	works all right.
        ^^^
	do not forget this !

 MM> Look at this :
 MM> 
 MM> ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
 MM> ma[logi,]
 MM> ##>      [,1] [,2]
 MM> ##> [1,]    1    1
 MM> ##> [2,]    1    3
 MM> ##> [3,]    1    5
 MM> ##> [4,]    1    7
 MM> 
 MM> ##-- now the same with  [ , drop = FALSE]
 MM> 
 MM> ## R (-0.50-a3) :
 MM> 
 MM> 	 ma[logi, drop = F]
 MM> ##>> Error: invalid subscript type
 MM> ## Splus-3.4:
 MM> 	 ma[logi, drop = F]
 MM> ##>> [1] 1 1 1 1 1 3 5 7
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Thu Aug 21 08:44:35 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 21 Aug 1997 09:44:35 +0200 (MET DST)
Subject: R-alpha: thoughts on batch and fortran
Message-ID: <9708210744.AA13701@alpha.luc.ac.be>

Batch:
  For me, batch in its present state is broken and useless. My primary
need for batch is to produce a final output file of a session after I
have worked out a sequence of procedures. I save my instructions in a
file that I can source, then run it in batch to have a copy of input
and output together. (If there was a log file (or dribble), this
problem would be solved.) At present, there are two problems with batch:
(1) I always run R interactively with saving the .RData shut off. This
is not possible in batch. Robert promised that it would be changed in
R0.14 but that never occurred so I am obliged to modify the C code of
each new version of R to avoid the problems of rereading .RData that I
described at that time.
(2) In any case, since 0.49, I cannot use batch because, as soon as
it hits a plot instruction, it stops with an error.

Fortran:
  I think that, if .Fortran is to exist, then the full fortran library
(except I/O) should be available, not just those functions required by
the basic R. I am thinking in particular of the complex functions that
I require for Kalman filtering in carma (soon to be released as a
dynamic library). Having the full f2c library linked in (-lf2c, when it
works under Linux - see the recent comments of my son, Patrick) does
not take more space unless it is actually used because it is dynamic.
carma will not work without these functions so how can I release
something that will not work for most users?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 21 10:44:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 21 Aug 1997 21:44:05 +1200 (NZST)
Subject: R-alpha: thoughts on batch and fortran
Message-ID: <199708210944.VAA22730@stat1.stat.auckland.ac.nz>

	From r-devel-owner@stat.math.ethz.ch Thu Aug 21 19:40 NZS 1997
	From: Jim Lindsey <jlindsey@luc.ac.be>
	Subject: R-alpha: thoughts on batch and fortran
	To: r-devel@stat.math.ethz.ch (r-devel)
	Date: Thu, 21 Aug 1997 09:44:35 +0200 (MET DST)

	Batch:
	  For me, batch in its present state is broken and useless. My primary
	need for batch is to produce a final output file of a session after I
	have worked out a sequence of procedures. I save my instructions in a
	file that I can source, then run it in batch to have a copy of input
	and output together. (If there was a log file (or dribble), this
	problem would be solved.) At present, there are two problems with batch:
	(1) I always run R interactively with saving the .RData shut off. This
	is not possible in batch. Robert promised that it would be changed in
	R0.14 but that never occurred so I am obliged to modify the C code of
	each new version of R to avoid the problems of rereading .RData that I
	described at that time.

The problem is that we had requests both ways - i.e. saving and not
saving.  Sorry, but we can't do it both ways.  But, if you end your
input file with
	q(save=FALSE)
you will get the effect you want.

	(2) In any case, since 0.49, I cannot use batch because, as soon as
	it hits a plot instruction, it stops with an error.

If you are plotting you will need to be running a device driver
of some sort.  In batch we don't automatically run any.
You can put either
	x11()
or
	postscript()
at the top of the file you are running to get a driver started.
Perhaps I will look at creating a "dummy" do-nothing driver which
will be run by default in batch mode.

	Fortran:
	I think that, if .Fortran is to exist, then the full fortran library
	(except I/O) should be available, not just those functions required by
	the basic R. I am thinking in particular of the complex functions that
	I require for Kalman filtering in carma (soon to be released as a
	dynamic library). Having the full f2c library linked in (-lf2c, when it
	works under Linux - see the recent comments of my son, Patrick) does
	not take more space unless it is actually used because it is dynamic.
	carma will not work without these functions so how can I release
	something that will not work for most users?

We've been talking about this a bit - its a general problem.
I will look and see if we can package the f2c library as an R library.
Then we could say
	library("f2c")
	library("carma")
I don't know if this will work - i.e. whether functions in carma.so
will "see" functions in f2c.so.  If I get a second in the next couple of
days I will try the experiment.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 21 11:08:25 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 21 Aug 1997 12:08:25 +0200
Subject: R-alpha: thoughts on batch (stop on error)
In-Reply-To: <199708210944.VAA22730@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Thu, 21 Aug 1997 21:44:05 +1200 (NZST))
Message-ID: <199708211008.MAA03618@sophie.ethz.ch>

Batch:
	Several of us still would like either a command option or 
		[better, but more complicated;
		 this would also be available in non-Batch) an  ]
        an
		options(error.handling = ...)

	option to turn-off the behavior that Batch mode stops on error.

 (It's good that batch stops on error by default,
  however in some cases we'd want to override this default !)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 21 11:19:50 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 21 Aug 1997 22:19:50 +1200 (NZST)
Subject: R-alpha: libf2c as a shared library
Message-ID: <199708211019.WAA22920@stat1.stat.auckland.ac.nz>

Ok, I did the following experiment

	dyn.load("/usr/local/lib/libf2c.so.2.0")
	dyn.load("try.so")
	.Fortran("try", 10.5)

where try.so contains the following compiled subroutine

	subroutine try(x)
        double precision x
        write(*,*) x
        return
        end

It worked just fine (at least here on my FreeBSD machine at home).
So it seems that it will be easy to make all of f2c available,
including the all the IO stuff.

It should be easy to package the libf2c sources as an R library.
I'm hesitant to put it into the core R distribution, because it
adds a lot of source, although this would ensure that it was always
available.

So, should it go in the R core, or to CRAN?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 14:13:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 21 Aug 1997 15:13:02 +0200
Subject: R-alpha: libf2c as a shared library
In-Reply-To: Ross Ihaka's message of Thu, 21 Aug 1997 22:19:50 +1200 (NZST)
References: <199708211019.WAA22920@stat1.stat.auckland.ac.nz>
Message-ID: <x267szvfvl.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> It should be easy to package the libf2c sources as an R library.
> I'm hesitant to put it into the core R distribution, because it
> adds a lot of source, although this would ensure that it was always
> available.
> 
> So, should it go in the R core, or to CRAN?
> 	Ross

CRAN. Linuxites have in their distributions already, for instance.
Nothing good will come from having it twice. Possibly in different
versions... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 14:19:34 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 21 Aug 1997 15:19:34 +0200
Subject: R-alpha: axes & plot boundary
Message-ID: <x24t8jvfkp.fsf@bush.kubism.ku.dk>

I don't rcall seeing this one reported before:

plot(...,axes=F) 

removes not only the axes, but also the plot boundary. The 'bty'
parameter loses its effect completely. getting it back seems to
require fiddling with par("usr") and rect() or lines()

(Linux, Alpha-3)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Thu Aug 21 15:00:28 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 21 Aug 1997 16:00:28 +0200
Subject: R-alpha: libf2c as a shared library
Message-ID: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>

At 15:15 21/08/97, p.dalgaard@kubism.ku.dk wrote:
>Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
>
>> It should be easy to package the libf2c sources as an R library.
>> I'm hesitant to put it into the core R distribution, because it
>> adds a lot of source, although this would ensure that it was always
>> available.
>> 
>> So, should it go in the R core, or to CRAN?
>> 	Ross
>
>CRAN. Linuxites have in their distributions already, for instance.
>Nothing good will come from having it twice. Possibly in different
>versions... 

I agree. The require function is designed to take care of this situation
surely? Indeed, there is already a contributed library (survival) which
depends on another contributed library (splines).

Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Thu Aug 21 16:34:08 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 21 Aug 1997 10:34:08 -0500 (CDT)
Subject: R-alpha: thoughts on batch and fortran
In-Reply-To: <199708210944.VAA22730@stat1.stat.auckland.ac.nz> from "Ross Ihaka" at Aug 21, 97 09:44:05 pm
Message-ID: <9708211534.AA21276@nokomis.stat.umn.edu>

> We've been talking about this a bit - its a general problem.
> I will look and see if we can package the f2c library as an R library.
> Then we could say
> 	library("f2c")
> 	library("carma")
> I don't know if this will work - i.e. whether functions in carma.so
> will "see" functions in f2c.so.  If I get a second in the next couple of
> days I will try the experiment.
> 	Ross

In UNIX you have two choices. You do it this way, or you can establish
the connection to dependent libraries at link time by your systems
variant of

	ld -shared -o carma carma.o -lf2c

when you create your carma shared library and then

	library("carma")

within R. In either case libf2c.so should only be loaded once. On
NT/Win95 I *think* you essentially only have the second choice. I
don't believe a DLL can have any undefined symbols that are resolved
into the running executable or other DLL's ar run time (I'm not
certain about this but is would be easy to check). If I'm right, it
would probably be best to recommend doing things the second way on all
systems just for consistency. I don't know how the Mac shared library
manager works, but I suspect it it more like the way I think NT/Win95
work.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 21 17:10:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 21 Aug 1997 09:10:03 -0700 (PDT)
Subject: R-alpha: thoughts on batch and fortran
In-Reply-To: <9708210744.AA13701@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970821085541.7394A-100000@chekov>

On Thu, 21 Aug 1997, Jim Lindsey wrote:
> Fortran:
>   I think that, if .Fortran is to exist, then the full fortran library
> (except I/O) should be available, not just those functions required by
> the basic R. I am thinking in particular of the complex functions that
> I require for Kalman filtering in carma (soon to be released as a
> dynamic library). Having the full f2c library linked in (-lf2c, when it
> works under Linux - see the recent comments of my son, Patrick) does
> not take more space unless it is actually used because it is dynamic.
> carma will not work without these functions so how can I release
> something that will not work for most users?

I don't think it's as simple as this.  If you can assume all users have
libf2c then your carma Makefile can link it with -lf2c.  This would be
ideal as I think some versions of Unix do still load libraries when the
program loads, whether or not they are actually used.

The real problem comes with machines that don't have f2c.  Most of our
machines here don't, for example, as we tend to use real Fortran when we
want it.  We currently don't assume that everyone has f2c as then we would
not need to distribute C versions of Fortran code. This would have the
added advantage that people who use real Fortran don't have to load
libf2c. 

If we don't assume that everyone has f2c then people distributing
libraries need to distribute all or part of libf2c. Source to libf2c is
readily available. 

I asked for opinions on this question a while back and didn't get any.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 21 18:31:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 21 Aug 1997 13:31:59 -0400
Subject: R-alpha: f2c
Message-ID: <97Aug21.133451edt.26498@mailgate.bank-banque-canada.ca>


> If we don't assume that everyone has f2c then people distributing
> libraries need to distribute all or part of libf2c. Source to libf2c is
> readily available. 

I'm a bit confused about this discussion, but since I don't have f2c on
the computer I've been using the past week, I assume most of the
necessary parts on this library have been distributed with R (but I
can't find them). I have been compiling the C version of my code,
generated with f2c on another machine, and almost everything seems to
be working. I am having trouble with pow_dd, pow_ii and pow_ri.

If there are truely only a few important routines missing then it would
be a lot easier for people distributing libraries to have those pieces
added to the R distribution.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: ECDFs
In-Reply-To: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
References: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
Message-ID: <199708212102.XAA03945@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 19 Aug 1997, Kurt Hornik wrote:
>> 
>> Here's something what is needed for teaching elementary statistics:
>> Given a sample vector x, compute the corresponding ECDF, plot it, and
>> perhaps evaluate it at points other than the data points.

> The approx() function is supposed to do this (it currently only does
> linear interpolation).  If the right and left continuous step
> functions were added to approx then we could easily use approxfun to
> define the ECDF as a function closure, making it automatically
> available at any point you want. After all, the ECDF *is* a function.

Ah, very nice idea!

So, we'd have

	ecdf(x)

return a FUNCTION of class (e.g.) "step" which would on the one hand
have the right methods for it and on the other hand would allow us to
evaluate it at new points right away?

Martin, Peter?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <Pine.SUN.3.95.970812093005.777B-100000@spock>
References: <199708121323.PAA02620@sophie.ethz.ch>
 <Pine.SUN.3.95.970812093005.777B-100000@spock>
Message-ID: <199708212102.XAA03944@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 12 Aug 1997, Martin Maechler wrote:
>> 
>> As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
>> namely "Termination upon 'error'".
>> 
>> I think this is THE good default behavior for "batch mode".
>> However
>> 1) for several purposes I'd very much want an option to change this
>> default behavior.
> Hear, hear!

>> 
>> I think it'd be very neat then if
>> options(error.stop = FALSE)
>> actually translated all errors [stop(.)] to warnings [warning()].
>> 

> I'm not convinced.  Being able to make warnings fatal is a good option,
> but being able to continue after errors may make no sense.   How do you
> continue after subscript out of bounds, or argument missing with no
> default, or memory exhausted or ...

> You may well need to jump back to the top level before it makes sense to
> continue.  On the other hand, once at the top level it is certainly
> possible to proceed, and so there should be an option to do it.

There is an obvious trade-off between having a lot of flexibility and
simple too many options :-)

I am not sure about making warnings fatal.  E.g., code for chisquare
tests usually displays a warning if the approximation may be bad.  That
should never be fatal, though ...

Re termination upon error, couldn't there be situations with a huge
simulation loop where one could still do something useful after
e.g. running out of memory?

If I unterstand Martin correctly, the extra options() come into being
only because command-line options are hard to port to point-and-click
interfaces ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: new class for chisquare tests?
Message-ID: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at>

I sort of asked this before, but perhaps not explicitly enough.

In my ctest collection, there are several chisquare-based tests.  For
some of them, it may be useful to also return information on expected
(and observed) counts.  The question is, how should this be done.  Of
course, there is no problem adding the corresponding components to the
list returned by the functions.  However, as these are of class `htest',
the components don't show up in the printed output.

(Of course, one can easily obtain them if they are in the list, but I
think Peter is with me when I say that this is not the right thing in an
intro course.)

* Should we extend print.htest() to display info on expected and
observed counts in case it is there?

* (Should we have an extra argument to control this behavior?)

* Or should there be a class "chisqtest" with a slightly different print
and perhaps also summary method?

* Or ...?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: Mutivariate Analysis
In-Reply-To: <199612022355.MAA17838@stat13.stat.auckland.ac.nz>
References: <199612022355.MAA17838@stat13.stat.auckland.ac.nz>
Message-ID: <199708212102.XAA03947@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> I have got a little side-tracked (from graphics) and am putting
> together a little multivariate analysis library.  This is just
> intended to be a "core" library rather than anything exhaustive.
> Mainly it is a matter of putting togther code which already exists at
> StatLib.  Here is my present list (only some of which is finished).

>  1. Principal Components
>     prcomp
	
>  2. Clustering
>     dist, hclust, plclust, subtree, cutree
>     kmeans

>  3. Canonical correlations (is this ever used?)
>     cancor

>  4. Scaling
>     cmdscal, sammon, isoscal

>  5. Graphics
>     (Optimal) profile plots
>     biplots
>     stars etc
>     A bunch of Michael Friendly's stuff converted from SAS

>  6. Discriminant analysis
>     discr (a real one which takes prior probs and returns posterior
>     ones) 

> I would also like to use the object facility so that printing,
> plotting etc is done with generic functions; e.g. plot(prcomp(x))
> should produce a scree plot, coef(prcomp(x)) should deliver the
> loadings - plclust() should also really be plot.hclust().

Yes I know this is a very old mail from Ross ...

I have two questions.

* Is the (already existing) plot.hclust() already a replacement for
plclust()?  (I.e., could we add

	plclust <- function(...) plot.hclust(...)

for compatibility purposes?)

* I'd be very much interested in some of the functions that are not yet
in the current `mva'.  Has there been any work on this one lately?  How
can we help?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:07 +0200
Subject: R-alpha: a question on terminology
Message-ID: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at>

Whereas we typically refer to the add-on `modules' as `libraries' (viz
also the way these are represented in the search list, and the variable
.Libraries), S speaks about `sections'.

Shall we stay with our terminology?  Or instead, speak of `sections',
`packages', `modules', ...?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:07 +0200
Subject: R-alpha: another ctest question
Message-ID: <199708212102.XAA03949@aragorn.ci.tuwien.ac.at>

I have the following problem.  Consider a `classical' test which works
for k .ge. 2 samples.  Possible interfaces are e.g.

	xxx.test(x, g)	    x ... all data, g ... corresponding groups
	xxx.test(x1, ..., xk)
	xxx.test(list(x1, ..., xk))

etc etc.

Clearly, the first and the second one are nice, but cannot be combined
without making `g' (i.e., `group') a named argument.

Hence, in e.g. my current version of kruskal.test() I've combined the
first (by compatibility with S-PLUS) and third interfaces.  Perhaps this
is not optimal, though ...

What I'd like to do now is to extend var.test() as follows.

* With one data arg, perform a chisq-based test for a certain value of
the variance, as specified by an optional var argument
* With two data args, do the usual F test
* With more than two data args, perform some test for the homogeneity of
variances, as specified by an optional method (default "Bartlett") arg.

What is the right interface then?  Should we have

  var.test(x, y = NULL, ..., group = NULL, alternative = "two.sided",
	   conf.level = 0.95, var = 1, ratio = 1, method = "Bartlett")

???

If so, should the interface to kruskal.test be changed accordingly?

Please advise me here.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 23:13:15 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 00:13:15 +0200
Subject: R-alpha: new class for chisquare tests?
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:06 +0200
References: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at>
Message-ID: <x2203nfamc.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> I sort of asked this before, but perhaps not explicitly enough.
> 
> In my ctest collection, there are several chisquare-based tests.  For
> some of them, it may be useful to also return information on expected
> (and observed) counts.  The question is, how should this be done.  Of
> course, there is no problem adding the corresponding components to the
> list returned by the functions.  However, as these are of class `htest',
> the components don't show up in the printed output.
> 
> (Of course, one can easily obtain them if they are in the list, but I
> think Peter is with me when I say that this is not the right thing in an
> intro course.)
> 
> * Should we extend print.htest() to display info on expected and
> observed counts in case it is there?
> 
> * (Should we have an extra argument to control this behavior?)
> 
> * Or should there be a class "chisqtest" with a slightly different print
> and perhaps also summary method?
> 
> * Or ...?

Couldn't the basic logic of print.lm/summary.lm/anova.lm be applied
here too? I.e.

h<-chisquare.test(blipblop)
observed(h)
fitted(h)
partials(h)

This might be implemented simply by adding items to the return list,
and have fitted.htest() extract the relevant item if it is there.

Or maybe slightly safer from a name-space point of view: add *one*
extra item ("comp", say) which is a list containing the other stuff.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 23:48:30 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 00:48:30 +0200
Subject: R-alpha: ECDFs
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:06 +0200
References: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
 <199708212102.XAA03945@aragorn.ci.tuwien.ac.at>
Message-ID: <x2zpqbduf5.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Thomas Lumley writes:
> 
> > On Tue, 19 Aug 1997, Kurt Hornik wrote:
> >> 
> >> Here's something what is needed for teaching elementary statistics:
> >> Given a sample vector x, compute the corresponding ECDF, plot it, and
> >> perhaps evaluate it at points other than the data points.
> 
> > The approx() function is supposed to do this (it currently only does
> > linear interpolation).  If the right and left continuous step
> > functions were added to approx then we could easily use approxfun to
> > define the ECDF as a function closure, making it automatically
> > available at any point you want. After all, the ECDF *is* a function.
> 
> Ah, very nice idea!
> 
> So, we'd have
> 
> 	ecdf(x)
> 
> return a FUNCTION of class (e.g.) "step" which would on the one hand
> have the right methods for it and on the other hand would allow us to
> evaluate it at new points right away?
> 
> Martin, Peter?
> 

Neat idea. And - hey! - someone has made it possible to assign classes
to a function now. I looked into that a while ago with a view to kill
off the antipedagogical habit that R and S has of dumping screenfulls
of gibberish on the unsuspecting newbie. At that time, it wasn't
possible so I dropped it, meaning to take it up on the list later on.

That would be like

print.function<-function(f)cat("Use 'show' to see content of function\n")
show<-unclass

Hmm. Do we want something like this? It clashes a little with other
uses of function classes, but not badly as far as I can see.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 00:11:18 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 01:11:18 +0200
Subject: R-alpha: another ctest question
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:07 +0200
References: <199708212102.XAA03949@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb5vdtd5.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> I have the following problem.  Consider a `classical' test which works
> for k .ge. 2 samples.  Possible interfaces are e.g.
> 
> 	xxx.test(x, g)	    x ... all data, g ... corresponding groups
> 	xxx.test(x1, ..., xk)
> 	xxx.test(list(x1, ..., xk))
> 
> etc etc.
> 
> Clearly, the first and the second one are nice, but cannot be combined
> without making `g' (i.e., `group') a named argument.

I'm sort of beginning to like the list(...) construction. It might
also allow one to assign meaningful tags to the variables (as in
kruskal.test(list(bp.males=dataframe$bp[dataframe$sex==1],bp.females=....)

>   var.test(x, y = NULL, ..., group = NULL, alternative = "two.sided",
> 	   conf.level = 0.95, var = 1, ratio = 1, method = "Bartlett")
> 
> ???
> 
> If so, should the interface to kruskal.test be changed accordingly?
> 
> Please advise me here.
> 

You won't gain much above (pardon the sketchy code)

var.test(x,g = NULL,..etc..)
if (is.list(x))
	g<-...
	x<-c(x)

if( g == NULL) ng<-1 else ng<-length(unique(g[nonmiss])) 
if (ng == 1)
	..
else if (ng == 2)
	..
else
	..

I'd say that the real issue is whether t.test should be supplied with
a group= parameter?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 02:27:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 13:27:59 +1200 (NZST)
Subject: R-alpha: axes & plot boundary
In-Reply-To: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
References: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
Message-ID: <199708220127.NAA28846@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > I don't rcall seeing this one reported before:
 > 
 > plot(...,axes=F) 
 > 
 > removes not only the axes, but also the plot boundary. The 'bty'
 > parameter loses its effect completely. getting it back seems to
 > require fiddling with par("usr") and rect() or lines()

This S compatible.  You can get the box after by saying
	box()
Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 07:40:25 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 08:40:25 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708212102.XAA03944@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:06 +0200)
Message-ID: <199708220640.IAA20151@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Thomas Lumley writes:
    >> On Tue, 12 Aug 1997, Martin Maechler wrote:
    MM>  As Thomas Lumley has noted before, the behavior in 'batch mode'
    MM> has changed; namely "Termination upon 'error'".
    MM> 
    MM> I think this is THE good default behavior for "batch mode".
    MM> However 1) for several purposes I'd very much want an option to
    MM> change this default behavior.
    >> Hear, hear!

    MM>  I think it'd be very neat then if options(error.stop = FALSE)
    MM> actually translated all errors [stop(.)] to warnings [warning()].
    MM> 

    >> I'm not convinced.  Being able to make warnings fatal is a good
    >> option, but being able to continue after errors may make no sense.
    >> How do you continue after subscript out of bounds, or argument
    >> missing with no default, or memory exhausted or ...

    >> You may well need to jump back to the top level before it makes
    >> sense to continue.  On the other hand, once at the top level it is
    >> certainly possible to proceed, and so there should be an option to
    >> do it.

    Kurt> There is an obvious trade-off between having a lot of flexibility
    Kurt> and simple too many options :-)

I don't quite see (the ":-)").
The non-expert user just changes options like 'digits' and 'width'
and leaves the others alone.

    Kurt> I am not sure about making warnings fatal.  E.g., code for
    Kurt> chisquare tests usually displays a warning if the approximation
    Kurt> may be bad.  That should never be fatal, though ...
The option exists in S.
It can be very useful for debugging purposes (and that't about it):
If you call a top level function  / a for loop which in certain
circumstances produces warnings that look funny to you, and somehow it's
hard to detect when / why the warnings are produced.

Now you (temporarily) make warnings fatal, and also add something like
options(error = 'dump.frames')  or an "on.exit(browser())".
You will now be able to quickly find and debug the circumstances under
which the warnings were produced.....


    Kurt> Re termination upon error, couldn't there be situations with a
    Kurt> huge simulation loop where one could still do something useful
    Kurt> after e.g. running out of memory?
sure.
As I (and others) said, there are other situations where you just want to
run a source.R file through R and you don't care if somewhere an
unimportant variable is not defined, a graphics device is not open,....

    Kurt> If I unterstand Martin correctly, the extra options() come into
    Kurt> being only because command-line options are hard to port to
    Kurt> point-and-click interfaces ...

This would be the main reason.

I think it's just 'neater' to have many things as part of R core,
instead of part of the OS-interface [to where command line options belong].

On the other hand, currently I (still) can't imagine myself moving off an
Unix based OS. Therefore, I'd be happy with a command line option which
turns off 'stop on error' in batch mode.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 07:59:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 08:59:34 +0200
Subject: R-alpha: class for chisquare tests; Thoughts on print & summary
In-Reply-To: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:06 +0200)
Message-ID: <199708220659.IAA20154@sophie.ethz.ch>

Kurt,
I think we hopefully are coming to an agreement that

	1)  your ctest collection should make its way into 'R core'
		((and you are the one who can make it happen now ..))
	2)  it should remain S-plus downward compatible as much as
	    reasonably possible.

My conclusions:
	a. keep class 'htest'
	b. extend  print.htest  (AND  summary.htest !)
	   to make it possible to display your extra info.
        b2. Yes, add extra arguments to print.htest / summary.htest to
	   control this behavior.
	 [this is also done for the correlation matrix
	  in print.summary.lm in S (not yet in R ..)]

alternatively, you would make a new class  'chisqtest' but give your test
results BOTH classes  
	class(res) <- c("chisqtest","htest")
Such that you can use 'htest' methods in general, and just one
	print.chisqtest
in particular.



General note on  'print' (and 'summary') methods:
~~~~~~~~~~~~      =====     
1) I think we should keep to the S convention that EVERY print method
   semantically acts as

    print.foo <- function(x,.........) {

	    .........

	    invisible(x)
    }

	[[a few days ago, I've patched print.lm (?I think) in order to do this]]

2) For summary, there are two approaches 
   
	A. Just print summary information  AND  return something useful.

	B. Don't print anything in summary.foo but return an object of 
	   CLASS  'summary.foo'
	   
	   AND write a method  print.summary.foo  
	   which nicely prints the  summary.foo information and
		[see remark '1)' on "print"] invisibly returns its object.

   Approach 'B' is THE way to go useful for "big" things like 'lm'.
   IMHO it should be used in general as soon as quite a bit of "computing"
   is involved ("computing" is NOT computer intensive; just things that are
   tedious to re-type).
	
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 09:21:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 20:21:14 +1200 (NZST)
Subject: R-alpha: class for chisquare tests; Thoughts on print & summary
Message-ID: <199708220821.UAA23531@stat1.stat.auckland.ac.nz>

	From: Martin Maechler <maechler@stat.math.ethz.ch>
	To: Kurt.Hornik@ci.tuwien.ac.at
	CC: R-devel@stat.math.ethz.ch
	Subject: Re: R-alpha: class for chisquare tests; Thoughts on print & summary

	Kurt,
	I think we hopefully are coming to an agreement that

		1)  your ctest collection should make its way into 'R core'
			((and you are the one who can make it happen now ..))

By all means - throw the present versions away and add yours.
We may have to move to an inner and outer core if the core grows too
big.

		2)  it should remain S-plus downward compatible as much as
		    reasonably possible.

For functions which are not going to be building blocks such compatibility
is less important.  Better to do it "right".

	        b2. Yes, add extra arguments to print.htest / summary.htest to
		   control this behavior.
		 [this is also done for the correlation matrix
		  in print.summary.lm in S (not yet in R ..)]

[ Actually I think that we just have a different default value for the
corr= argument.  If you'd like this changed just say.  I just don't
find the correlations that informative. ]

I'm reviewing the "lm" methods at present because thats what I'm
teaching at present.  I have an "lm.predict" about ready to roll,
but am a bit hung up on trying to propagate case names through
"model.frame", which in turn is inducing an sidetrack into
[<- etc etc ...

	alternatively, you would make a new class  'chisqtest' but give
	your test results BOTH classes  
		class(res) <- c("chisqtest","htest")
	Such that you can use 'htest' methods in general, and just one
		print.chisqtest
	in particular.

I'd probably try to avoid making a separate class for every kind of
test result and try to build methods for the general case.  This would
make implementing new tests easier as well as imposing the same
general structure on the output.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 09:24:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 10:24:56 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:07 +0200)
Message-ID: <199708220824.KAA26083@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
    Kurt> also the way these are represented in the search list, and the variable
    Kurt> .Libraries), S speaks about `sections'.
[.Libraries are not used anymore and will be gone in the next version.
 library

    Kurt> Shall we stay with our terminology?
I think so.
Or use something which S does not use at all,
since 'require(.);  provide(.)' and  Thomas Lumley's  
autoload(..) features enable an entirely different approach.

    Kurt>  Or instead, speak of `sections',
    Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
    Kurt> `packages', `modules', ...?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 09:39:32 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 10:39:32 +0200
Subject: R-alpha: axes & plot boundary
In-Reply-To: Ross Ihaka's message of Fri, 22 Aug 1997 13:27:59 +1200 (NZST)
References: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
 <199708220127.NAA28846@stat1.stat.auckland.ac.nz>
Message-ID: <x2bu2qvcfv.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Peter Dalgaard BSA writes:
>  > I don't rcall seeing this one reported before:
>  > 
>  > plot(...,axes=F) 
>  > 
>  > removes not only the axes, but also the plot boundary. The 'bty'
>  > parameter loses its effect completely. getting it back seems to
>  > require fiddling with par("usr") and rect() or lines()
> 
> This S compatible.  You can get the box after by saying
> 	box()

By golly! So it is. Sorry. That is the trouble with working from home
and not having Splus around...

Actually, I did look for something that did what box() does, but
couldn't find it off-hand. It isn't really obvious where to look.

When we get around to finishing the plot() man page, let's try to
remember to add a short note on axes=F. Something like

"
axes=F removes the axes and the plot boundary. Use 'axis'
and 'box' to add them later.
"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 09:34:26 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 20:34:26 +1200 (NZST)
Subject: R-alpha: a question on terminology
Message-ID: <199708220834.UAA23628@stat1.stat.auckland.ac.nz>

I like "packages".  Modules have namespace implications which the
present setup does not provide.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 10:17:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 11:17:34 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:07 +0200)
Message-ID: <199708220917.LAA26226@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
    Kurt> also the way these are represented in the search list, and the variable
    Kurt> .Libraries), S speaks about `sections'.
[.Libraries are not used anymore ...
 search() & .Provided should be enough, ...]

    Kurt> Shall we stay with our terminology?
I think so.

    Kurt>  Or instead, speak of `sections',
    Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
    Kurt> `packages', `modules', ...?

Or use something which S does not use at all,
since 'require(.);  provide(.)' and  Thomas Lumley's  
autoload(..) features enable an entirely different approach.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 10:52:21 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 11:52:21 +0200
Subject: R-alpha: names for .RData
In-Reply-To: <Pine.SUN.3.95.970820141956.24129B-100000@chekov>
References: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
 <Pine.SUN.3.95.970820141956.24129B-100000@chekov>
Message-ID: <199708220952.LAA04284@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> It would be nice for the save file name .RData to be a variable in
> config.site (unless the machine-independent files are coming very
> soon).  We are currently running R on a cluster with both
> sparc-solaris and intel-linux machines, which don't like each other's
> .RData files.  At the moment I edit the source files by hand to change
> the name to .RData-linux.

I thought by switching to the new format (XDR?) this would no longer be
a problem?

> On a related topic, has anyone given any more thought to installing
> multiple binaries in the same directory tree (as suggested some time ago
> by Greg Warnes)?  This could save quite a lot of space as well as making
> it easier to keep different operating systems synchronised. 

There was some discussion a time ago.  Let me try to summarize it in my
own biased way.

* In general, we have two ways of arranging the `library' tree.  One is,
grouped according to module, the other, according to type.  I.e.,

	library/<module>/
	library/<module>/funs/
	library/<module>/help/
	library/<module>/html/
	library/<module>/rman/
	library/<module>/objs/<platform>

etc or

	library/funs/<module>
	...
	library/objs/<platform>/<module>

Given that we also have architecture-dependent things in the library, I
would suggest to adopt the former strategy (similar to Emacs) and not
the latter as e.g. in the TeX Directory Standard.

* (As an aside, we could also discuss whether we want to have several
versions of R installed simultaneously.  This would imply having

	RHOME/<version_1>/...
	RHOME/<version_2>/...
	...
	RHOME/<site>

with all potential problems of such.)

* Similarly, there should not be any problem with having

	RHOME/bin/R-<platform>

instead of

	RHOME/bin/R.binary

* The first question is, what EXACTLY is `platform'?  E.g., the GNU
Coding Standards would imply the triplet

	MACHINE-VENDOR-OS

whereas e.g. the Debian GNU/Linux standards tell you to use

	MACHINE-OS

(e.g., `i386-linux') ...

* The main question is, how is the right platform determined at runtime?
I've had some discussions here (forgot who with) where I claimed that
this is not possible from the shell alone.  E.g., on my current system
the output of `uname -a' is

	Linux teddy 2.0.27 #2 Sun Dec 22 22:12:46 MET 1996 i586 unknown

and if someone had compiled R on an i386 I'd be nowhere.  The same
applies for shell variables such as OSTYPE and MACHTYPE, which don't
seem to be POSIX anyway.

* Hence, I think the right things to do are

** Either have several scripts in RHOME/bin, and have links to these
from somewhere in PATH (which sounds a bit stupid)

** Have a simple shell wrapper installed in the PATH which calls the
real one passing the PLATFORM information.  If this sounds confusing,
the idea is the following.  Suppose we install in /usr/local (and that
/usr/local/bin is not shared among platforms).  Then RHOME would be

	/usr/local/lib/R

with

	/usr/local/lib/R/bin/R			# shell script
	/usr/local/lib/R/bin/R-<platform>	# binaries ...

and

	/usr/local/bin/R

would contain

	exec /usr/local/lib/R/bin/R -p PLATFORM $*

and `PLATFORM' is what was determined at compile time.

* I think this is the cleanest solution, and should not be too hard to
implement:

STEP 1.

** Introduce the -p argument (or whatever else) to the script.  Maybe do
something nice such as providing a `default' platform in the script,
such that those with a single-platform setup don't see any difference.

** Rename `R.binary' accordingly.

** Introduce a platform layer in `lib' (and perhaps rename it to `objs'
right away, PLEASE).

** Modify library.dynam() accordingly. (Not a problem, as we have the
`arch' and `os' elements of version() anyway.)

STEP 2.

The above does not create a platform wrapper (where should it put it?),
but single-platform sites won't know a difference (shell script has a
default), and multi-platform people can either have private aliases or
set up wrappers at the sysadmin level.

Eventually, there should be something like a real `make install' with
the installation tree different from the source/build tree.  Then, we
can generate a wrapper at compile time and install it to $(bindir) (the
runtime system will go into $(libdir), and the man page into $(mandir)).

****

That's all, folks.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 10:52:21 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 11:52:21 +0200
Subject: R-alpha: libf2c as a shared library
In-Reply-To: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>
References: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>
Message-ID: <199708220952.LAA04280@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> At 15:15 21/08/97, p.dalgaard@kubism.ku.dk wrote:
>> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
>> 
>>> It should be easy to package the libf2c sources as an R library.
>>> I'm hesitant to put it into the core R distribution, because it
>>> adds a lot of source, although this would ensure that it was always
>>> available.
>>> 
>>> So, should it go in the R core, or to CRAN?
>>> Ross
>> 
>> CRAN. Linuxites have in their distributions already, for instance.
>> Nothing good will come from having it twice. Possibly in different
>> versions... 

> I agree. The require function is designed to take care of this situation
> surely? Indeed, there is already a contributed library (survival) which
> depends on another contributed library (splines).

Hmm ... not so fast ...

Does this also affect the parts of f2c that are already come with R?
I.e., if compiled without a Fortran compiler and a shared libf2c is
found, would R be linked dynamically against that and a corresponding
statement added to the site-wide init file?

-k


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 11:37:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 12:37:36 +0200
Subject: R-alpha: apply()
Message-ID: <199708221037.MAA04898@aragorn.ci.tuwien.ac.at>

The following is identical in R and S, but still strange ...

R> apply(matrix(1:20, nc = 4), 1, table)
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    1    1    1    1
[2,]    1    1    1    1    1
[3,]    1    1    1    1    1
[4,]    1    1    1    1    1
R> apply(matrix(rep(1, 20), nc = 4), 1, table)
[1] 4 4 4 4 4
R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
[[1]]
1 3 7 
2 1 1 

[[2]]
2 4 6 8 
1 1 1 1

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Fri Aug 22 13:02:31 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 22 Aug 1997 14:02:31 +0200 (MET DST)
Subject: R-alpha: eigen
Message-ID: <9708221202.AA06994@alpha.luc.ac.be>

eigen(matrix(rep(1,9),ncol=3),only.values=T)

works repeatedly but eventually (after 3 or 4 goes) gave a core dump
of 11mb (I think only the first answer was right).

if I type
gc()
immediately after the first call, I get a core dump right away (this
might possibly be related to my huge core dumps with nlm)

eigen(matrix(rep(1,9),ncol=3))
core dumps immediately after the first call

Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 13:05:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 14:05:56 +0200
Subject: R-alpha: eigen
In-Reply-To: <9708221202.AA06994@alpha.luc.ac.be> (message from Jim Lindsey on
 Fri, 22 Aug 1997 14:02:31 +0200 (MET DST))
Message-ID: <199708221205.OAA26421@sophie.ethz.ch>

I cannot produce any core dump with these statements here ...

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> eigen(matrix(rep(1,9),ncol=3),only.values=T)

    Jim> works repeatedly but eventually (after 3 or 4 goes) gave a core dump
    Jim> of 11mb (I think only the first answer was right).

    Jim> if I type
    Jim> gc()
    Jim> immediately after the first call, I get a core dump right away (this
    Jim> might possibly be related to my huge core dumps with nlm)

    Jim> eigen(matrix(rep(1,9),ncol=3))
    Jim> core dumps immediately after the first call
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 13:16:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 14:16:51 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: <199708181405.QAA00632@sophie.ethz.ch> (message from Martin
 Maechler on Mon, 18 Aug 1997 16:05:18 +0200)
Message-ID: <199708221216.OAA26424@sophie.ethz.ch>

This is propagated to  R-devel in case anyone else has a comment on this :

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

  MM> On Aug. 14,
  MM> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

  Ross> Re the emacs stuff:

  MM> ...

  Ross> 2. Peter Dalgaard made the suggestion that we made R source names
  Ross> end in ".R" in the source tree.  This seems like a good idea.  We
  Ross> might also consider making manual files end in .man so that it
  Ross> obvious what they are.

  MM> Kurt and me also would like to agree on a file extension for  
  MM> 'R man' files.

  MM> Either	.man  [PROBLEM: this extension is used in Unix
  MM> 			already for [t/n]roff style manual pages.
  MM> 			Emacs therefore switches to nroff mode for this
  MM> 			extension. That's why I wouldn't like it all.]

  MM> or	.Rd   [in S there are '.d' help files with roff-like syntax]
  MM> or	.Rman

Current status (between Kurt & me):
	
Kurt proposes
	.Rd
	.Rdoc
	.Rman     (in DEcreasing order of preference)

My own order of preference would be

	.Rman .Rd .Rdoc

which would result in '.Rd' as a fair compromise.
		       ===

Any other opinions / votes ?

-- MM
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 13:39:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 14:39:52 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708220917.LAA26226@sophie.ethz.ch>
References: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at>
 <199708220917.LAA26226@sophie.ethz.ch>
Message-ID: <199708221239.OAA05132@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
Kurt> also the way these are represented in the search list, and the variable
Kurt> .Libraries), S speaks about `sections'.

> [.Libraries are not used anymore ...
>  search() & .Provided should be enough, ...]

Kurt> Shall we stay with our terminology?

> I think so.

Kurt> Or instead, speak of `sections',
Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
Kurt> `packages', `modules', ...?

> Or use something which S does not use at all,
> since 'require(.);  provide(.)' and  Thomas Lumley's  
> autoload(..) features enable an entirely different approach.

Thanks to Martin and Ross for the immediate response.

Ross wrote,

> I like "packages".  Modules have namespace implications which the
> present setup does not provide.

I guess we have a decision then, and will refer to an `add-on' as a

	>>> PACKAGE <<<

E.g., the PACKAGE `mva', ...

(And hope than when R conquers the world there will be real modules.)

To make things consistent, could we PLEASE make the corresponding
changes so that search() shows

	"package:base"

rather than "library:base"?

Locations I found were

src/main/envir.c:
	STRING(ans)[n-1] = mkChar("library:base");

src/main/main.c:
	suicide("unable to open the base library\n");

and in src/library/base/funs/library

I will meanwhile change things in the FAQ accordingly.

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Aug 22 15:30:32 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 22 Aug 1997 10:30:32 -0400
Subject: R-alpha: RHOME
Message-ID: <97Aug22.103211edt.26506@mailgate.bank-banque-canada.ca>

> * In general, we have two ways of arranging the `library' tree.  One is,
> grouped according to module, the other, according to type.  I.e.,

> 	library/<module>/
> 	library/<module>/funs/
> 	library/<module>/help/

I find this a much better way to organize things. Old versions of
packages can be removed cleanly with

rm -r library/<package>

It also means that the userid for the maintainer of a package does not
necessarily need to be the userid of R.

> * (As an aside, we could also discuss whether we want to have several
> versions of R installed simultaneously.  This would imply having

> 	RHOME/<version_1>/...
> 	RHOME/<version_2>/...
>  ...
> * The main question is, how is the right platform determined at runtime?
>  ...

There seems to be an assumption here that RHOME will be the same no
matter what machine you are running on. I would set RHOME depending on
the machine, eg.

RHOME=/usr/local/lib/R-Sun4
RHOME=/usr/local/lib/R-Sun5
RHOME=/usr/local/lib/R-Linux386

and then use links to the XDR files and other files which are not
machine dependent, so they do not have to be duplicated.

Determining the platform universally may be fairly difficult, but at a
given site there is usually a fairly small mix of machines and it is
possible to write a shell script to determine the machine. In fact,
this is a pretty common problem and you are probably already doing it
in your .login or .chrc.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Fri Aug 22 17:20:43 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 22 Aug 1997 18:20:43 +0200
Subject: R-alpha: apply()
Message-ID: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>

At 12:42 22/08/97, kurt.hornik@ci.tuwien.ac.at wrote:

>The following is identical in R and S, but still strange ...
>
>R> apply(matrix(1:20, nc = 4), 1, table)
>     [,1] [,2] [,3] [,4] [,5]
>[1,]    1    1    1    1    1
>[2,]    1    1    1    1    1
>[3,]    1    1    1    1    1
>[4,]    1    1    1    1    1
>R> apply(matrix(rep(1, 20), nc = 4), 1, table)
>[1] 4 4 4 4 4
>R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
>[[1]]
>1 3 7 
>2 1 1 
>
>[[2]]
>2 4 6 8 
>1 1 1 1
>
>-k

It is strange, but logical.  The problem is that it's an undocumented
feature. If the help page said something like "If the calls to FUN
return vectors of different lengths then apply returns a list of
length dim(x)[MARGIN]" then it would be less surprising. Or would you
prefer that apply returns an error message if it can't coerce the
result to an array?

Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Aug 22 17:30:08 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:30:08 -0700 (PDT)
Subject: R-alpha: apply()
In-Reply-To: <199708221037.MAA04898@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970822092037.10703A-100000@chekov>

On Fri, 22 Aug 1997, Kurt Hornik wrote:

> The following is identical in R and S, but still strange ...
> 
> R> apply(matrix(1:20, nc = 4), 1, table)
>      [,1] [,2] [,3] [,4] [,5]
> [1,]    1    1    1    1    1
> [2,]    1    1    1    1    1
> [3,]    1    1    1    1    1
> [4,]    1    1    1    1    1
> R> apply(matrix(rep(1, 20), nc = 4), 1, table)
> [1] 4 4 4 4 4

Yes it is.  This is the sort of thing I meant when I complained about
drop=F being the default.  

The third example should be documented in the man page, which only
describes what happens "If each call to FUN returns a vector of length n" 
In fact the Blue Book help pages and the current S-PLUS help also
ignore this possibility.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Aug 22 17:33:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:33:18 -0700 (PDT)
Subject: R-alpha: eigen
In-Reply-To: <9708221202.AA06994@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970822093036.10703B-100000@chekov>

On Fri, 22 Aug 1997, Jim Lindsey wrote:

> eigen(matrix(rep(1,9),ncol=3),only.values=T)
> 
> works repeatedly but eventually (after 3 or 4 goes) gave a core dump
> of 11mb (I think only the first answer was right).
> 

The bug in foreign function calling pointed out by Martin in a different
context does this, if you haven't fixed it (it's more recent than 50a3).
In naoktrim in dotcode.c, which begins 
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 0;
                *len = 0;
        }
   
change *dup = 0 to *dup = 1.



Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Aug 22 17:45:44 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:45:44 -0700 (PDT)
Subject: R-alpha: terms
In-Reply-To: <x2zpqbduf5.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970822094149.10703D-100000@chekov>


Another minor incompatibility
R>attr(terms(y~x),"response")
[1] TRUE
S> attr(terms(y~x),"response")
[1] 1

In S the attribute indicates which column of the model frame will contain
the response. In R this always column 1 because model frames are only
useful when their columns are in the right order (model.matrix doesn't
check).


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 22:20:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 23:20:43 +0200
Subject: R-alpha: apply()
In-Reply-To: Thomas Lumley's message of Fri, 22 Aug 1997 09:30:08 -0700 (PDT)
References: <Pine.SUN.3.95.970822092037.10703A-100000@chekov>
Message-ID: <x2203l52z8.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> On Fri, 22 Aug 1997, Kurt Hornik wrote:
> 
> > The following is identical in R and S, but still strange ...
> > 
> > R> apply(matrix(1:20, nc = 4), 1, table)
> >      [,1] [,2] [,3] [,4] [,5]
> > [1,]    1    1    1    1    1
> > [2,]    1    1    1    1    1
> > [3,]    1    1    1    1    1
> > [4,]    1    1    1    1    1
> > R> apply(matrix(rep(1, 20), nc = 4), 1, table)
> > [1] 4 4 4 4 4
> 
> Yes it is.  This is the sort of thing I meant when I complained about
> drop=F being the default.  
> 
> The third example should be documented in the man page, which only
> describes what happens "If each call to FUN returns a vector of length n" 
> In fact the Blue Book help pages and the current S-PLUS help also
> ignore this possibility.
> 

The weirdest thing is actually the first case, where tables of the
same length *but different dimnames* are getting pasted together into
a matrix with no dimnames... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Sat Aug 23 05:10:10 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Sat, 23 Aug 1997 16:10:10 +1200 (NZST)
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
Message-ID: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>

Whatever extensions are decided on for any of the R stuff it is important
to realize that Windows (3.11) only lets you have one dot (.) and then
only 3 characters. The base name should be only 8 characters long as well.
Since I'm worrying about it a little these days I just want to put my 2 cents
worth in on this topic.

It is looking like a real pain to translate the current set of html files to
this format which means that there is going to be some real work required in
getting a 3.11 version going.

On a related note I really have started on the RSept and have postscript
functioning (once again big changes will be needed to get it to fly under
3.11 so it'll be a Win95 version first).

Getting dll's going is the next trick I'm going to try.

robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Aug 23 11:59:39 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Aug 1997 12:59:39 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: Robert Gentleman's message of Sat, 23 Aug 1997 16:10:10 +1200 (NZST)
References: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>
Message-ID: <x2203lp3kz.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> 
> Whatever extensions are decided on for any of the R stuff it is important
> to realize that Windows (3.11) only lets you have one dot (.) and then
> only 3 characters. The base name should be only 8 characters long as well.
> Since I'm worrying about it a little these days I just want to put my 2 cents
> worth in on this topic.
> 
> It is looking like a real pain to translate the current set of html files to
> this format which means that there is going to be some real work required in
> getting a 3.11 version going.

Is it possible that the HTML->RTF->WinHelp generation pointer I sent
you would work faster? Point being that you could generate the RTF
file on a machine with long filenames yielding a file with *internal"
links, no restrictions on names, and in turn a .HLP file - which we
want to have anyway.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Aug 23 20:07:04 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 23 Aug 1997 12:07:04 -0700 (PDT)
Subject: R-alpha: plots and batch mode
In-Reply-To: <x2zpqbduf5.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.LNX.3.96.970823120250.1852A-100000@buffy>


You can always define a dummy graphics driver for batch mode by

dummy.driver<-function() postscript(file="/dev/null")

which will actually do all the calculations needed (and so catch errors)
but won't produce anything.  Then you can edit the Rprofile so that
dummy.driver() is started if you aren't running interactively.  

I don't know if something similar can be done for Mac/Win.

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:28:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:28:09 +0200
Subject: R-alpha: barplot()
Message-ID: <199708250628.IAA13999@aragorn.ci.tuwien.ac.at>

I've created a hacked version of barplot() which is more compatible with
the S version, but currently ONLY FOR VECTORS.

Differences && new features:

* The `space' argument is interpreted as the fraction of the average bar
width.  (The current version has the width of the bar plus the space in
between constrained to sum to 1.)

* There is a new argument `width'.

* There is a new argument `horiz' for producing horizontal barplots.

Please have a look.  If the changes are ok'ed, I will also change the
matrix case accordingly.

I have a remark and a question.

* The printing of labels at the vertical axis seems to be different in R
and S when using axis(), the labels come out horizontal in S and
vertical in R.  Compare
	x <- 1:5
	plot(x, axes = F)
	axis(2, at = x, labels = LETTERS[x])

* I feel a bit stupid repeating most code for the horiz T and F cases.
Is there a smarter way to `swap' x and y when plotting?

-k

*************************************************************************
"barplot" <-
function(height, width = 1, space = 0.2, names.arg, legend.text,
	 beside = FALSE, horiz = FALSE, col = NULL, border = par("fg"),
	 main = NULL, xlab = NULL, ylab = NULL, xlim, ylim, axes = TRUE,
	 ...)
{
  opar <- par(yaxs="i", xpd=TRUE)
  on.exit(par(opar))
  if (is.matrix(height)) {
    if (beside) {
      delta <- 0.5 * (1 - space)
      if (missing(xlim))
	xlim <- c(0, ncol(height)) + 0.5
      if (missing(ylim))
	ylim <- range(-0.01, height)
      plot.new()
      plot.window(xlim, ylim, log = "")
      for (i in 1:ncol(height)) {
	xx <- seq(i-delta, i+delta, length=nrow(height)+1)
	xl <- xx[1:nrow(height)]
	xr <- xx[1:nrow(height)+1]
	rect(xl, 0, xr, height[,i], col=col, xpd=TRUE)
      }
    } else { #-- not 'beside' --
      delta <- 0.5 * (1 - space)
      nheight <- rbind(0, apply(height, 2, cumsum))
      if (missing(xlim)) 
	xlim <- c(0, ncol(height)) + 0.5
      if (missing(ylim)) 
	ylim <- range(-0.01, nheight)
      plot.new()
      plot.window(xlim, ylim, log = "")
      for (i in 1:ncol(height))
	rect(i - delta, nheight[-1, i],
	     i + delta, nheight[1:nrow(height), i],
	     col = col, xpd=TRUE)
    }
    if(missing(names.arg))
      names.arg <- dimnames(height)[[2]]
    if(!is.null(names.arg)) {
      if(length(names.arg) != ncol(height))
	stop("incorrect number of names")
      for(i in 1:length(names.arg))
	axis(1, at=1:length(names.arg), labels=names.arg, lty=0)
    }
  }
  else { ##---- height is vector ---------
    space <- space * mean(width)
    width <- rep(width, length = length(height))
    delta <- width / 2
    LRC <- cumsum(space + width)
    MID <- LRC - delta
    LLC <- MID - delta
    if (missing(xlim)) xlim <- c(0, max(LRC))
    if (missing(ylim)) ylim <- range(-0.01, height)
    plot.new()
    if (horiz) {
      plot.window(ylim, xlim, log = "")
      rect(0, LLC, height, LRC, col, xpd = TRUE)
    } else {
      plot.window(xlim, ylim, log = "")      
      rect(LLC, 0, LRC, height, col, xpd = TRUE)
    }
    if (missing(names.arg))
      names.arg <- names(height)
    if (!is.null(names.arg))
      for (i in 1:length(names.arg))
	if (horiz)
	  axis(2, at = MID, labels = names.arg, lty = 0)
	else
	  axis(1, at = MID, labels = names.arg, lty = 0)
  }
  if (!missing(legend.text) && !missing(col)) {
    xy <- par("usr")
    legend(xy[2] - xinch(0.1), xy[4] - yinch(0.1),
	   legend = rev(legend.text), fill = rev(col),
	   xjust = 1, yjust = 1)
  }
  title(main = main, xlab = xlab, ylab = ylab, ...)
  if (axes)
    if (horiz)
      axis(1)
    else
      axis(2)
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:33:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:33:16 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: <x2203lp3kz.fsf@bush.kubism.ku.dk>
References: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>
 <x2203lp3kz.fsf@bush.kubism.ku.dk>
Message-ID: <199708250633.IAA14016@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> 
>> Whatever extensions are decided on for any of the R stuff it is important
>> to realize that Windows (3.11) only lets you have one dot (.) and then
>> only 3 characters. The base name should be only 8 characters long as well.
>> Since I'm worrying about it a little these days I just want to put my 2 cents
>> worth in on this topic.
>> 
>> It is looking like a real pain to translate the current set of html files to
>> this format which means that there is going to be some real work required in
>> getting a 3.11 version going.

> Is it possible that the HTML->RTF->WinHelp generation pointer I sent
> you would work faster? Point being that you could generate the RTF
> file on a machine with long filenames yielding a file with *internal"
> links, no restrictions on names, and in turn a .HLP file - which we
> want to have anyway.

That would be nice ... names in RApril.zip such as
	chisquare.test.html
won't work in 3.11 anyway ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:51:44 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:51:44 +0200
Subject: R-alpha: Re:  .Options$digits do not (always) work
Message-ID: <199708250651.IAA14063@aragorn.ci.tuwien.ac.at>

While trying to understand official and private explanations of Robert
and Martin before writing something useful in the FAQ, I did some more
experimenting ...

Please have a look at the following.  According to Martin, this is also
what he observed about 2 weeks ago but did not document exactly enough
when posting.

Note:  the explanation given by Robert was (roughly speaking) that the
result of options()$digits is used for printing, and NOT the value of
.Options$digits.

Here it comes.

***********************************************************************
R> .Options$digits
[1] 7

R> tst2 <- function(x=pi, dig =3) {
+   oo <- options(digits=dig); on.exit(options(oo)); print(x);x}
R> tst2()
[1] 3.14
[1] 3.141593
R> tst2(dig = 12)
[1] 3.14159265359
[1] 3.141593
***********************************************************************

Up to here, everything is fine and rational.  But now:

***********************************************************************
R> .Options$digits <- 5

R> tst2()
[1] 3.1416
[1] 3.1416
R> tst2(dig = 12)
[1] 3.1416
[1] 3.1416
***********************************************************************

Oops, the internal value of options()$digits is ignored .... Really?
Let's test:

***********************************************************************
R> tst3 <- function(x=pi, dig =3) {
+ oo <- options(digits=dig); on.exit(options(oo));
+ print(c(.Options$digits, options()$digits)); print(x); x }
R> tst3()
[1] 5 3
[1] 3.1416
[1] 3.1416
R> tst3(dig = 12)
[1]  5 12
[1] 3.1416
[1] 3.1416

R> tst4 <- function(x=pi, dig =3) {
+ .Options$digits <- dig;
+ print(c(.Options$digits, options()$digits)); print(x); x }
R> tst4()
[1] 3 7
[1] 3.1416
[1] 3.1416
***********************************************************************

SUMMARY:  If we assign explicitly to .Options$digits in .GlobalEnv,
there is NO WAY we can change the print behavior inside functions after
that, neither by assigning to .Options$digits nor by using
options(digits = ...).

Surely, this cannot be a feature!

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:59:40 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:59:40 +0200
Subject: R-alpha: R documentation boilerplates
Message-ID: <199708250659.IAA14098@aragorn.ci.tuwien.ac.at>

Just a minor remark.  Perhaps it would be useful to have some of the
`boilerplates' used by S for the man pages, e.g.,

	.GE .ME .XY .GR .AO .NA

Perhaps .GE() or GENERIC()?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 08:07:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 09:07:48 +0200
Subject: R-alpha: apply()
In-Reply-To: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>
References: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>
Message-ID: <199708250707.JAA14115@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> At 12:42 22/08/97, kurt.hornik@ci.tuwien.ac.at wrote:
>> The following is identical in R and S, but still strange ...
>> 
R> apply(matrix(1:20, nc = 4), 1, table)
>> [,1] [,2] [,3] [,4] [,5]
>> [1,]    1    1    1    1    1
>> [2,]    1    1    1    1    1
>> [3,]    1    1    1    1    1
>> [4,]    1    1    1    1    1
R> apply(matrix(rep(1, 20), nc = 4), 1, table)
>> [1] 4 4 4 4 4
R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
>> [[1]]
>> 1 3 7 
>> 2 1 1 
>> 
>> [[2]]
>> 2 4 6 8 
>> 1 1 1 1
>> 
>> -k

> It is strange, but logical.  The problem is that it's an undocumented
> feature. If the help page said something like "If the calls to FUN
> return vectors of different lengths then apply returns a list of
> length dim(x)[MARGIN]" then it would be less surprising. Or would you
> prefer that apply returns an error message if it can't coerce the
> result to an array?

No, some explanation would be fine.  But from the examples, I don't
think that we always get a list of a certain length ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 08:10:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 09:10:20 +0200
Subject: R-alpha: tapply() strangeness
Message-ID: <199708250710.JAA14123@aragorn.ci.tuwien.ac.at>

Here's something related to last week's apply() problem:

R> x <- matrix(1:20, nc = 4)
R> x
     [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20

R> tapply(x, row(x), table)
[1] Numeric,4 Numeric,4 Numeric,4 Numeric,4 Numeric,4

???

In S,

> tapply(x, row(x), table)
$"1":
 1 6 11 16 
 1 1  1  1

$"2":
 2 7 12 17 
 1 1  1  1

$"3":
 3 8 13 18 
 1 1  1  1

$"4":
 4 9 14 19 
 1 1  1  1

$"5":
 5 10 15 20 
 1  1  1  1

which is (apart from labels) the same as

R> lapply(split(x, row(x)), table)
$1
 1  6 11 16 
 1  1  1  1 

$2
 2  7 12 17 
 1  1  1  1 

$3
 3  8 13 18 
 1  1  1  1 

$4
 4  9 14 19 
 1  1  1  1 

$5
 5 10 15 20 
 1  1  1  1 


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Mon Aug 25 08:42:30 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Mon, 25 Aug 1997 09:42:30 +0200 (MET DST)
Subject: R-alpha: eigen and batch
Message-ID: <9708250742.AA12773@alpha.luc.ac.be>

Batch:
  Putting q(save=F) at the end of my file does not work in my
context because I can no longer source the file without quitting. I
have that quit statement in my .First so that I always quit that way
interactively. The problem is that it is ignored in batch.

eigen:
  The crash occurs on my 586 running Red Hat Linux 2.0.27 but not on
my son's 486 running SLackware Linix 2.0.29. We both have the same
most recent libraries installed (libc, libm, etc).
   I started looking in the eispack C code and traced down the
problem. In three of the four Fortran calls in eigen, (ch,rs,cg but
not rg), the same vector (vals) is used for the return eigenvalues as
for two or three temporary workspace vectors. This is risky
programming at any time and leads to a catastrophe with a 586 where
several things may be calculated at the same time. If the variable,
vals, is removed and all use of it in the .Fortran call replaced by
double(n) (as in the call to rg), eigen works on a 586.
  This sort of problem should be checked elsewhere in R.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Aug 25 08:38:08 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 25 Aug 1997 09:38:08 +0200 (MET DST)
Subject: R-alpha: ts problems
Message-ID: <XFMail.970825095458.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.1.p0.Linux:970825095458:252=_
Content-Type: text/plain; charset=us-ascii

Here is a patch which fixes some problems with time series functions.
Some examples of what goes wrong...

> x <- ts(rnorm(100),start=1,deltat=2)
> start(x)
Error in ts[1] : object is not subsettable
> end(x)
Error in ts[2] : object is not subsettable
> y <- ts(matrix(rnorm(100),ncol=2))
> window(y,1,10)
Error in [.ts(x, (trunc((start - xtsp[1]) * freq + 1.5):trunc((end - xtsp[1]) *
 : unused argument to function

The first two bugs propagate quite widely. You can't even print x.

Unlike S-PLUS, R does not allow you to take row subsets of a time series
object without unclassing it (Of course there is the window function, but
you can't thin out a time series with this).   I've extended "[.ts"
to allow you to do this. I didn't put this version of "[.ts" in the patch.
Instead it is given below in full.

"[.ts" <-
function (x, i, j, drop = T)
{
        y <- NextMethod("[")
        if (missing(i))
                ts(y, start = start(x), freq = frequency(x))
        else {
                n <- if (is.matrix(x))
                        nrow(x)
                else length(x)
                ind <- (1:n)[i]
                delta <- unique(ind[-1] - ind[-length(ind)])
                if (length(delta) != 1 || delta == 0) {
                        warning("Not returning a time series object")
                }
                else {
                        xtsp <- tsp(x)
                        xtimes <- seq(from = xtsp[1], to = xtsp[2],
                                by = 1/xtsp[3])
                        ytsp <- numeric(3)
                        ytsp[1] <- xtimes[min(ind)]
                        ytsp[2] <- xtimes[max(ind)]
                        ytsp[3] <- (length(ind) - 1)/(ytsp[2] -
                                ytsp[1])
                        tsp(y) <- ytsp
                }
                y
        }
}

I hope this is useful.
Martyn

--_=XFMail.1.1.p0.Linux:970825095458:252=_
Content-Type: text/plain;
 charset=us-ascii; name=R-0.50.a3-tspatch; SizeOnDisk=613
Content-Description: R-0.50.a3-tspatch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="R-0.50.a3-tspatch"

diff -uNr R-0.50-a1-orig/src/library/base/funs/ts R-0.50-a1/src/library/base/fun
s/ts
--- R-0.50-a1-orig/src/library/base/funs/ts	Sun Aug 24 14:51:23 1997
+++ R-0.50-a1/src/library/base/funs/ts	Sun Aug 24 14:55:26 1997
@@ -103,7 +103,7 @@
 		fs <- floor(tsp[3]*(tsp[1] - is)+0.001)
 		c(is,fs+1)
 	}
-	else ts[1]
+	else tsp[1]
 }
 
 end.ts <-
@@ -118,7 +118,7 @@
 		fs <- floor(tsp[3]*(tsp[2] - is)+0.001)
 		c(is, fs+1)
 	}
-	else ts[2]
+	else tsp[2]
 }
 
 frequency.ts <-
@@ -266,7 +266,7 @@
 }
 
 "[.ts" <-
-function(x, i, j)
+function(x, i, j, drop=T)
 {
 	y <- NextMethod("[")
 	if(is.matrix(x) & missing(i))

--_=XFMail.1.1.p0.Linux:970825095458:252=_--
End of MIME message
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 09:17:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 10:17:52 +0200
Subject: R-alpha: R documentation problems
Message-ID: <199708250817.KAA14244@aragorn.ci.tuwien.ac.at>

Last week I spent some time going through the Blue Book to figure out
what we are missing and where we are different.  (Results will come in
subsequent emails.)  As a byproduct, here is a list of the documentation
problems I found.

As soon as time and my knowledge of CVS allow, I'll try to fix some of
these ...

-k

***********************************************************************
* The following man pages are completely missing:

	do.call
	.First
	.Last
	menu
	proc.time
	readline
	segments
	sink
	traceback

* The documentation for approx needs to be updated to reflect the the
new "constant" method.

* The documentation of approxfun() has an unnecessary xout part.  Also
needs to be updated to reflect the "constant" method.

* Man page for as.name mentions `name', which does not exist

* Man page for call is confusing.  It says,
	We don't differentiate between expressions and function
	    calls.  So is.call is the same as is.expression.
But,
  R> cl <- call("round",10.5)
  R> is.call(cl)
  [1] TRUE
  R> is.expression(cl)
  [1] FALSE

* Man page for function() (and invisible()) is incomplete

* Man page for points() gets formatted strangely

* Man page for split() should consistently talk about `group'
  (The `groups' in USAGE should be `group').

* The documentation of cat() is incomplete:  it has
  cat(... , sep="")
but
  R> args(cat)
  function (..., file = "", sep = " ", fill = FALSE, labels = NULL, 
          append = FALSE)

* The documentation of complex() is incorrect:
  complex(n=0, real=numeric(), imag=numeric())
but
  R> args(complex)
	function (n = 0, real = numeric(), imaginary = numeric())

* Man page for log() is not correct:
  The 2-arg version is not explained

* Man page for matrix() is incomplete:
  The `dimnames' argument is missing

* Man page for mode() is incomplete:
  The assignment form "mode<-" is not documenented

* Man page for stem() has
  stem(x, scale=1)
but
  R> args(stem)
  function (x, scale = 1, width = 80, atom = 1e-08)
Also, the EXAMPLES section should start with `data(islands)'	

* Man page for storage.mode() is incomplete:
  The assignment form "storage.mode<-" is not documented

* Man page for ts says
  ts(x, start=1, end, frequency=1, deltat=1, ts.eps = .Options$ts.eps)
but
  R> args(ts)
  function (data = NA, start = 1, end = numeric(0), frequency = 1, 
          deltat = 1, ts.eps = .Options$ts.eps)
(The first arg should	be `data' and not `x'.)

* In the `mva' package, the man page for dist() is not correct
  (The method "binary" is not mentioned.)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 09:18:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 10:18:47 +0200
Subject: R-alpha: Differences R/S
Message-ID: <199708250818.KAA14248@aragorn.ci.tuwien.ac.at>

Here's what I found.

* parse() has white = F by default (is T by default in S)

* S seems to have signif(x, digits = 6) whereas R needs an explicit
  second argument

* S title() has an axes = F optional argument

* In S, first argument to vector() is called `mode' and not `type'

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 25 10:49:48 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Aug 1997 11:49:48 +0200
Subject: R-alpha: R documentation problems
In-Reply-To: Kurt Hornik's message of Mon, 25 Aug 1997 10:17:52 +0200
References: <199708250817.KAA14244@aragorn.ci.tuwien.ac.at>
Message-ID: <x2203i1tj7.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> Last week I spent some time going through the Blue Book to figure out
> what we are missing and where we are different.  (Results will come in
> subsequent emails.)  As a byproduct, here is a list of the documentation
> problems I found.
...
> 
> ***********************************************************************
> * The following man pages are completely missing:
> 
...
> 
> * In the `mva' package, the man page for dist() is not correct
>   (The method "binary" is not mentioned.)

And, rather important:

 * Manpages for plot() and par() are incomplete. axes= is missing and
so is lwd=, e.g. It's on the plot.default() page, but it needs to be
duplicated on plot(), or plot() needs to refer more explicitly to
plot.default(), than "See also". Similar notes regarding barplot() and
hist().

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 11:12:14 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 12:12:14 +0200
Subject: R-alpha: `missing' BB functions
Message-ID: <199708251012.MAA14358@aragorn.ci.tuwien.ac.at>

Here are the functions documented in the Blue Book that I found missing
in R (ignoring the ones which are obviously outdated).

	aggregate allocated amatch axes chull clorder cutree cycle date
	debugger dget discr faces interp l1fit labclust lag loglin
	monthplot mstree mulbar napsack odometer persp plclust plotfit
	rep.int restore rreg sabl sablplot set.seed smooth sort.list
	Stable stars starsymb storage subtree symbols tempfile tslines
	tsmatrix tsplot tspoints twoway unlink usa xor

In some detail:

aggregate cycle lag smooth tslines tsmatrix tsplot tspoints:
	Obviously useful for time series.  Andreas has a quick version
	of lag() ...

allocated storage:
	Something to display the current memory consumption (other than
	as a byproduct of calling gc() would be nice ...
amatch

axes:
	Seems to be the same as title() except for axes = T and F, resp.
	R currently does not have this extra arg.

chull

clorder(?) cutree discr faces(?) labclust(?) mstree(?) plclust stars
subtree:
	These are already (sort of) in the full version of `mva' as
	(still?) planned by Ross (question marks indicate the ones not
	mentioned explicitly)

date:
	If we'd want this, we could add
		date <- function() system("date")
	to work under UNIX, at least

debugger

dget

loglin:
	Would this be useful?  It should not be too hard to write
	something around AS 51 ... Should that be compatible with the S
	version?
interp

l1fit rreg:
	These would certainly be nice as workhorses, but shouldn't L1
	and robust fitting of linear models be specifyable at the model
	level?

monthplot sabl sablplot

mulbar:
	Would be nice to have, in particular in connection with Mosaic
	plots ...

napsack

odometer

persp:
	This is already in "3D GRAPHICS" of PROJECTS.

plotfit twoway:
	Outdated?

rep.int

restore:
	Should be the opposite of dump() ... In R, can we simply use
	source()?

set.seed:
	Martin, do you have a version of that for R? 

sort.list

Stable:
	Jim Lindsey <jlindsey@luc.ac.be> wrote that he has d and p
	function for the four-parameter stable family, perhaps we should
	include this.
	
starsymb

symbols

tempfile:
	Would be very useful, although I'd prefer it to be called
	`tmpfile' instead.  I am not sure if tmpfile() is ANSI C.  If
	so, we could simply wrap around it, as Fritz posted some time
	ago.

unlink:
	We most likely don't need this one, right?

usa:
	Would be nice, of course ...

xor:
	Is trivial and useful.  Could we add
		xor <- function(x, y) { (x | y) & !(x & y) }
	to the distribution?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug 25 11:24:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 25 Aug 1997 12:24:54 +0200
Subject: R-alpha: batch   q(save = 'no')
In-Reply-To: <9708250742.AA12773@alpha.luc.ac.be> (message from Jim Lindsey on
 Mon, 25 Aug 1997 09:42:30 +0200 (MET DST))
Message-ID: <199708251024.MAA00793@sophie.ethz.ch>

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> Batch: Putting q(save=F) at the end of my file does not work in my
    Jim> context because I can no longer source the file without
    Jim> quitting. I have that quit statement in my .First so that I always
    Jim> quit that way interactively. The problem is that it is ignored in
    Jim> batch.

I've tested the following, and it seems to work :

Add
	if(!interactive()) q(save = "no")

at the end of your batch files.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 13:39:45 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 14:39:45 +0200
Subject: R-alpha: R FAQ
Message-ID: <199708251239.OAA14629@aragorn.ci.tuwien.ac.at>

Attached is a snapshot of the new version of the FAQ.  What is still
missing is something on eval and .Options versus options().  As always,
feedback is greatly appreciated.
Best,
-k

***********************************************************************
  R FAQ
  Kurt Hornik
  v0.2-0, 1997/09/01

  This document contains answers to some of the most frequently asked
  questions about R.  Feedback is welcome.
  ______________________________________________________________________

  Table of Contents:

  1. Introduction

     1.1 Legalese
     1.2 Obtaining this Document
     1.3 Notation
     1.4 Feedback

  2. R Basics

     2.1 What Is R?
     2.2 What Machines Does R Run on?
     2.3 What Is the Current Version of R?
     2.4 How Can R Be Obtained?
     2.5 How Can R Be Installed?
        2.5.1 How Can R Be Installed (Unix)
        2.5.2 How Can R Be Installed (Windows)
        2.5.3 How Can R Be Installed (Macintosh)
     2.6 Are there Unix Binaries for R?
     2.7 Which Documentation Exists for R?
     2.8 Which Mailing Lists Exist for R?
     2.9 What is CRAN?

  3. R and S

     3.1 What Is S?
     3.2 What Is S-PLUS?
     3.3 What Are the Differences between R and S?

  4. R Add-On Packages

     4.1 Which Add-on Packages Exist for R?
     4.2 How Can Add-on Packages Be Installed?
     4.3 How Can Add-on Packages Be Used?
     4.4 How Can I Contribute to R?

  5. R and Emacs

     5.1 Is there Emacs Support for R?
     5.2 Should I Run R from Within Emacs?

  6. R Miscellania

     6.1 How Can I Read a Large Data Set into R?
     6.2 Why Can't R Source a `Correct' File?
     6.3 How Can I Set Components of a List to NULL?
     6.4 How Can I Save My Workspace?
     6.5 How Can I Clean Up My Workspace?
     6.6 Why Do My Matrices Lose Dimensions?

  7. Acknowledgments

  ______________________________________________________________________

  1.  Introduction

  This document contains answers to some of the most frequently asked
  questions about R.

  1.1.  Legalese

  This document is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  General Public License for more details.

  A copy of the GNU General Public License is available via WWW at
  http://www.gnu.org/copyleft/gpl.html.  You can also obtain it by
  writing to the Free Software Foundation, Inc., 675 Mass Ave,
  Cambridge, MA 02139, USA.

  1.2.  Obtaining this Document

  The latest version of this document is always available from

       http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html

  From there, you can also obtain versions converted to plain ASCII
  text, GNU info, DVI, and PostScript, as well as the SGML source used
  for creating all these formats using the SGML-Tools (formerly
  Linuxdoc-SGML) system.

  1.3.  Notation

  Everything should be pretty standard.  `R>' is used for the R prompt,
  and a `$' for the shell prompt (where applicable).

  1.4.  Feedback

  Feedback is of course most welcome.

  In particular, note that I do not have access to Windows or Mac
  systems.  If you have information on these systems that you think
  should be added to this document, please let me know.

  2.  R Basics

  2.1.  What Is R?

  R is a system for statistical computation and graphics.  It consists
  of a language plus a run-time environment with graphics, a debugger,
  access to certain system functions, and the ability to run programs
  stored in script files.
  The design of R has been heavily influenced by two existing languages:
  Becker, Chambers & Wilks' S (see question ``What is S?'') and
  Sussman's Scheme.  Whereas the resulting language is very similar in
  appearance to S, the underlying implementation and semantics are
  derived from Scheme.  See question ``What Are the Differences between
  R and S?'' for a discussion of the differences between R and S.

  R is being developed by Ross Ihaka and Robert Gentleman, who are
  Senior Lecturers at the Department of Statistics of the University of
  Auckland in Auckland, New Zealand.

  R has a home page at http://stat.auckland.ac.nz/r/r.html, and is free
  software distributed under a GNU-style copyleft.

  2.2.  What Machines Does R Run on?

  R is being developed for the Unix, Windows and Mac platforms.

  R will configure and build under a number of common Unix platforms
  including dec-alpha-osf, freebsd, hpux, linux-elf-ix86, sgi-irix,
  solaris, and sunos, and according to Jim Lindsey <jlindsey@luc.ac.be>
  also on Mac, Amiga and Atari under linux-m68k.

  If you know about other platforms, please drop me a note.

  2.3.  What Is the Current Version of R?

  The current Unix version is 0.50.  The previous version was 0.49 and
  added group methods and complex numbers, thus providing a more or less
  provides a full implementation of S as described in ``The New S
  Language''.

  The versions for Windows and Mac are pre-alpha.  With some good luck,
  the Windows version will soon catch up with the Unix version.

  2.4.  How Can R Be Obtained?

  Sources, binaries and documentation for R can be obtained via CRAN,
  the ``Comprehensive R Archive Network'' (see question ``What is
  CRAN?'').

  2.5.  How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  If binaries are available for your platform (see question ``Are there
  Unix Binaries for R?''), you can use these, following the instructions
  that come with them.

  Otherwise, you can compile and install R yourself, which can be done
  very easily under a number of common Unix platforms (see question
  ``What Machines Does R Run on?'').  The file INSTALL that comes with
  the R distribution contains instructions.

  Choose a place to install the R tree (R is not just a binary, but has
  additional data sets, help files, font metrics etc).  Let's call this
  place RHOME (given appropriate permissions, a natural choice would be
  `/usr/local/lib/R').  Untar the source code, and issue the following
  commands (at the shell prompt):

       $ ./configure
       $ make
       $ make install-help

  You can also build a LaTeX version of the manual entries with

       $ make install-latex

  and an HTML version of the manual with

       $ make install-html

  If these commands execute successfully, the R binary will be copied to
  the `$RHOME/bin' directory.  In addition, a shell script font-end
  called `R' will be created and copied to the same directory.  You can
  copy this script to a place where users can invoke it, for example to
  `/usr/local/bin'.  You could also copy the man page `R.1' to a place
  where your man reader finds it, such as `/usr/local/man/man1'.

  2.5.2.  How Can R Be Installed (Windows)

  The file `RApril.zip' from the `bin/ms-windows' directory of a CRAN
  site contains a binary Windows 95 distribution for R which should be
  about a 0.48 release.  This version is quite limited in Windows-
  specific features and probably contains many bugs, although it has
  been reported to work rather nicely.  As always, there is no limit to
  the damage a buggy program can do under Windows, so, at least until
  more experience have been gained with it, it should probably not be
  used on systems containing very important data.  It is not clear
  whether it works under Windows 3.11 (the HTML help system cannot work
  under 3.11 as it needs long file names).  According to James Neild
  <jneild@esri.com>, it works fine under Windows NT 3.51.

  Note that when uncompressing `RApril.zip', the pkunzip program needs
  to be invoked with the -D flag to create subdirectories.

  2.5.3.  How Can R Be Installed (Macintosh)

  The CRAN `bin/macintosh' directory contains `R.sea.hqx', a binhexed
  self-extracting archive, and installation instructions in
  `README.MACINTOSH'.  Note that the version in it is nowhere near the
  quality of the current Unix version.

  The Power Macintosh port is temporarily on hold.

  2.6.  Are there Unix Binaries for R?

  Experimental `.deb' and `.rpm' packages for installation under the
  ix86 versions of Debian GNU/Linux and Red Hat Linux, respectively, can
  be found in `bin/ix86-linux'.  No other binary distributions for Unix
  systems have thus far been made publically available.

  2.7.  Which Documentation Exists for R?

  Online documentation for most of the functions and variables in R
  exists, and can be printed on-screen by typing help(name) (or ?name)
  at the R prompt, where name is the name of the R object help is sought
  for.  (In the case of unary and binary operators and control-flow
  special forms, the name may need to be be quoted.)

  This documentation can also be made available as HTML, and as hardcopy
  via LaTeX, see question ``How Can R Be Installed?''.  An up-to-date
  HTML version is always available for web browsing at

       http://www.stat.math.ethz.ch/R-manual

  An R manual (``Notes on R:  A Programming Environment for Data
  Analysis and Graphics'') is currently being written, based on the
  ``Notes on S-PLUS'' by Bill Venables <venables@stats.adelaide.edu.au>
  and David Smith <D.M.Smith@lancaster.ac.uk>.  The current version can
  be obtained as `Rnotes.tgz' (LaTeX source) in a CRAN `doc' directory.
  Note that the ``conversion'' from S(-PLUS) to R is not complete yet.

  Last, but not least, Ross' and Robert's experience in designing and
  implementing R is described in:

       @Article{,
         author =       {Ross Ihaka and Robert Gentleman},
         title =        {R: A Language for Data Analysis and Graphics},
         journal =      {Journal of Computational and Graphical Statistics},
         year =         1996,
         volume =       5,
         number =       3,
         pages =        {299--314}
       }

  This is also the reference for R to use in publications.

  2.8.  Which Mailing Lists Exist for R?

  Thanks to Martin Maechler <maechler@stat.math.ethz.ch>, there are
  three mailing lists devoted to R.

     r-announce
        This list is for announcements about the development of R and
        the availability of new code.

     r-devel
        This list is for discussions about the future of R and pre-
        testing of new versions.  It is meant for those who maintain an
        active position in the development of R.
     r-help
        The `main' R mailing list, for announcements about the
        development of R and the availability of new code, questions and
        answers about problems and solutions using R, enhancements and
        patches to the source code and documentation of R, comparison
        and compatibility with S and S-plus, and for the posting of nice
        examples and, benchmarks.

  To send a message to everyone on the r-help mailing list, send email
  to

       r-help@stat.math.ethz.ch

  To subscribe (or unsubscribe) to this list send subscribe (or unsub-
  scribe) in the BODY of the message (not in the subject!)  to r-help-
  request@stat.math.ethz.ch.  Information about the list can be obtained
  by sending an email with info as its contens to r-help-
  request@stat.math.ethz.ch.

  Subscription and posting to the other lists is done analogously, with
  `r-help' replaced by `r-announce' and `r-devel', respectively.  Note
  that the r-announce list is gatewayed into r-help, so you don't need
  to subscribe to both of them.

  It is recommended that you send mail to r-help rather than only to the
  R developers (who are also subscribed to the list, of course).  This
  may save them precious time they can use for constantly improving R,
  and will typically also result in much quicker feedback for yourself.

  Of course, in the case of bug reports it would be very helpful to have
  code which reliably reproduces the problem.

  Archives of the above three mailing lists are made available on the
  net in a monthly schedule at ftp://ftp.stat.math.ethz.ch/Mail-
  archives/ (which is a directory of mail archive files).  Archives of
  the r-help mailing list (including the previous r-testers lists back
  to March 1996), are also available in HTML format at
  http://www.ens.gu.edu.au/robertk/rhelp/about.htm.

  The WWW page http://www.maths.uq.edu.au/~gks/r/mail.html is devoted to
  the R mailing lists, providing easy posting, subscription and
  unsubscription, and access to mailing list archives.

  The developers of R can be reached for comments and reports at
  R@stat.auckland.ac.nz.

  2.9.  What is CRAN?

  The ``Comprehensive R Archive Network'' (CRAN) is a collection of
  sites which carry identical material, consisting of the R
  distribution(s), the contributed extensions, documentation for R, and
  binaries.

  The CRAN master site can be found at the URL

       ftp://ftp.ci.tuwien.ac.at/pub/R/

  and is currently being mirrored daily at

       http://lib.stat.cmu.edu/R/CRAN/
       ftp://franz.stat.wisc.edu/pub/R/
       ftp://ftp.stat.math.ethz.ch/R-CRAN/
  http://www.stat.unipg.it/pub/stat/statlib/R/CRAN/
  ftp://ftp.u-aizu.ac.jp/pub/lang/R/CRAN/

  Please use the CRAN site closest to you to reduce network load.

  The structure of the CRAN tree is as follows.

     `src/base'
        contains the official R distribution as provided by Ross Ihaka
        and Robert Gentleman.

     `src/contrib'
        contains code for extension packages.

     `doc'
        is for additional documentation and information on R.

     `bin'
        is for prebuilt R binaries (the base distribution and
        extensions), grouped according to platforms.  Currently, there
        are only experimental packages for Debian GNU/Linux.  I hope
        that `.tar.gz' files with contents relative to an installation
        tree (e.g. `bin', `lib/R/', and `man/man1/R.1') can be made
        available soon for all major supported Unix platforms.

  To ``submit'' to CRAN, simply upload to
  ftp://ftp.ci.tuwien.ac.at/incoming and send email to Kurt Hornik
  <Kurt.Hornik@ci.tuwien.ac.at>.  Please indicate the copyright
  situation (GPL, ...) in your submission.

  3.  R and S

  3.1.  What Is S?

  S is a very high level language and an environment for data analysis
  and graphics.  S was written by Richard A. Becker, John M. Chambers,
  and Allan R. Wilks of AT&T Bell Laboratories Statistics Research
  Department.

  The primary references for S are two books by the creators of S.

  o  Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
     ``The New S Language,'' Chapman & Hall, London.

     This book is often called the ``Blue Book''.

  o  John M. Chambers and Trevor J. Hastie (1992), ``Statistical Models
     in S,'' Chapman & Hall, London.

     This is also called the ``White Book''.

  There is a huge amount of user-contributed code for S, available at
  the S Repository at CMU.

  See the ``Frequently Asked Questions about S''
  (http://lib.stat.cmu.edu/S/faq) for further information about S.

  3.2.  What Is S-PLUS?

  S-PLUS is a value-added version of S sold by Statistical Sciences,
  Inc. (now a division of Mathsoft, Inc.)  S is a subset of S-PLUS, and
  hence anything which may be done in S may be done in S-PLUS.  In
  addition S-PLUS has extended functionality in a wide variety areas,
  including robust regression, modern nonparametric regression, time
  series, survival analysis, multivariate analysis, classical
  statistical tests, quality control, and graphics drivers.  Add-on
  modules add additional capabilities for wavelet analysis, spatial
  statistics, and design of experiments.

  See the MathSoft S-PLUS page (http://www.mathsoft.com/splus.html) for
  further information.

  3.3.  What Are the Differences between R and S?

  Whereas the developers of R have tried to stick to the S language as
  defined in ``The New S Language'' (Blue Book, see question ``What is
  S?''), they have adopted the evaluation model of Scheme.

  This difference becomes manifest when free variables occur in a
  function.  Free variables are those which are neither formal
  parameters (occurring in the argument list of the function) nor local
  variables (created by assigning to them in the body of the function).
  Whereas S (like C) by default uses static scoping, R (like Scheme) has
  adopted lexical scoping.  This means the values of free variables are
  determined by a set of global variables in S, but in R by the bindings
  that were in effect at the time the function was created.

  Consider the following function:

       cube <- function(n) {
         sq <- function() n * n
         n * sq()
       }

  Under S, sq() does not ``know'' about the variable n unless it is
  defined globally:

       S> cube(2)
       Error in sq():  Object "n" not found
       Dumped
       S> n <- 3
       S> cube(2)
       [1] 18

  In R, the ``environment'' created when cube() was invoked is also
  looked in:

       R> cube(2)
       [1] 8

  The following more `realistic' example illustrating the differences in
  scoping is due to Thomas Lumley <thomas@biostat.washington.edu>.  The
  function

       jackknife.lm <- function(lmobj) {
         n <- length(resid(lmobj))
         jval <- t(apply(as.matrix(1:n), 1,
                         function(i) coef(update(lmobj, subset = -i))))
         (n - 1) * (n - 1) * var(jval) / n
       }

  does something useful in R, but does not work in S.  In order to make
  it work in S you need to explicitly pass the linear model object into
  the function nested in apply().  If you don't and you are lucky you
  will get ``Error: Object "lmobj" not found''.  If you are unlucky
  enough to have a linear model called lmobj in your global environment
  you will get the wrong answer with no warning.

  The following version works in S.

       jackknife.S.lm <- function(lmobj) {
         n <- length(resid(lmobj))
         jval <- t(apply(as.matrix(1:n), 1,
                         function(i, lmobj) coef(update(lmobj, subset = -i)),
                         lmobj = lmobj))
         (n - 1) * (n - 1) * var(jval) / n
       }

  (The S version was written independently by Thomas and at least three
  of his fellow students over the past couple of years, causing liter-
  ally hours of confusion on each occasion.)

  Similarly, most optimization (or zero-finding) routines need some
  arguments to be optimized over and have other parameters that depend
  on the data but are fixed with respect to optimization.  With R
  scoping rules, this is a trivial problem; simply make up the function
  with the required definitions in the same environment and scoping
  takes care of it.  With S, one solution is to add an extra parameter
  to the function and to the optimizer to pass in these extras, which
  however can only work if the optimizer supports this (and typically,
  the builtin ones do not).

  Lexical scoping allows using function closures and maintaining local
  state.  A simple example (taken from Abelson and Sussman) can be found
  in the `demos/language' subdirectory of the R distribution.  Further
  information is provided in the standard R reference ``R: A Language
  for Data Analysis and Graphics'' (see question ``Which Documentation
  Exists for R?'') and a paper on ``Lexical Scope and Statistical
  Computing'' by Robert Gentleman and Ross Ihaka which can be obtained
  from the `doc/misc' directory of a CRAN site.

  Lexical scoping also implies a further major difference.  Whereas S
  stores all objects as separate files in a directory somewhere (usually
  `.Data' under the current directory), R does not.  All objects in R
  are stored internally.  When R is started up it grabs a very large
  piece of memory and uses it to store the objects.  R performs its own
  memory management of this piece of memory.  Having everything in
  memory is necessary because it is not really possible to externally
  maintain all relevant ``environments'' of symbol/value pairs.  This
  difference also seems to make R much faster than S.

  The down side is that if R crashes you will lose all the work for the
  current session.  Saving and restoring the memory ``images'' (the
  functions and data stored in R's internal memory at any time) can be a
  bit slow, especially if they are big.  In S this does not happen,
  because everything is saved in disk files and if you crash nothing is
  likely to happen to them.  R is still in an alpha stage, and does
  crash from time to time.  Hence, for important work you should
  consider saving often, see question ``How Can I Save My Workspace?''
  (other possibilities are logging your sessions, or have your R
  commands stored in text files which can be read in using source()).
  (Note that if you run R from within Emacs (see question ``R and
  Emacs''), you can save the contents of the interaction buffer to a
  file and conveniently manipulate it using S-transcript-mode, as well
  as save source copies of all functions and data used.)

  Apart from lexical scoping and its implications, R follows the S
  language definition in the Blue Book as much as possible, and hence
  really is an ``implementation'' of S.  There are some intentional
  differences where the behavior of S is considered ``not clean''.  In
  general, the rationale is that R should help you detect programming
  errors, while at the same time being as compatible as possible with S.

  Some known differences are the following.

  o  In R, if x is a list, then x[sub] <- NULL and x[[sub]] <- NULL
     remove the specified elements from x.  The first of these is
     incompatible with S, where it is a no-op.

  o  In S, the functions named .First and .Last in the `.Data' directory
     can be used for customizing, as they are executed at the very
     beginning and end of a session, respectively.  R looks for files
     called `.Rprofile' in the user's home directory and the current
     directory, and sources these.  (It also loads a saved image from
     `.RData' in case there is one.)  If a .First function exists then,
     it is executed.  The .Last mechanism is not supported yet.

  o  In S, library(name) adds the data directory for the library section
     name to the search list.  If a function object named `.First.lib'
     exists in the directory, it is executed; this is typically used to
     dynamically load compiled code required by the functions in the
     section.  In R, library(name) currently simply sources the file
     $RHOME/library/name, and compiled code can be loaded by calling
     library.dynam() in this file.  The .First.lib mechanism is not
     really supported.

  o  In R, dyn.load() can only load shared libraries, as created for
     example by `R SHLIB'.

  o  R presently does not support IEEE Inf and NaN.

  o  In R, attach currently only works for lists and data frames (not
     for directories).

  o  Categories do not exist in R, and never will as they are deprecated
     now in S.  Use factors instead.

  o  In R, For() loops are not necessary and hence not supported.

  o  In R, assign() uses the argument envir= rather than where= as in S.

  o  The random number generators are different, and the seeds have
     different length.

  o  The glm family objects are implemented differently in R and S.  The
     same functionality is available but the components have different
     names.

  o  terms objects are stored differently.  In S a terms object is an
     expression with attributes, in R it is a formula with attributes.
     The attributes have the same names but are mostly stored
     differently.  The major difference in functionality is that a terms
     object is subscriptable in S but not in R.  If you can't imagine
     why this would matter then you don't need to know.

     Also, attr(terms(y~x),"response") give 1 in S and TRUE in R.  In S
     the attribute indicates which column of the model frame will
     contain the response. In R this always column 1 because model
     frames are only useful when their columns are in the right order
     (model.matrix doesn't check).

  There are also differences which are not intentional, and result from
  missing or incorrect code in R.  The developers would appreciate
  hearing about any deficiencies you may find (in a written report fully
  documenting the difference as you see it).  Of course, it would be
  useful if you were to implement the change yourself and make sure it
  works.

  4.  R Add-On Packages

  4.1.  Which Add-on Packages Exist for R?

  The R distribution comes with the following extra packages:

     eda
        Exploratory Data Analysis.  Currently only contains functions
        for robust line fitting, and median polish and smoothing.

     mva
        Multivariate Analysis.  Currently contains code for principal
        components (prcomp), canonical correlations (cancor),
        hierarchichal clustering (hclust), and metric multidimensional
        scaling (cmdscale).  More functions for clustering and scaling,
        biplots, profile and star plots, and code for ``real''
        discriminant analysis will be added soon.

  The following packages are available from the CRAN `src/contrib' area.

     acepack
        ace (Alternating Conditional Expectations) and avas (Additivity
        and VAriance Stabilization for regression) for selecting
        regression transformations.

     bootstrap
        Software (bootstrap, cross-validation, jackknife), data and
        errata for the book ``An Introduction to the Bootstrap'' by B.
        Efron and R. Tibshirani, 1993, Chapman and Hall.

     class
        Functions for classification (k-nearest neighbor and LVQ).

     clus
        Functions for cluster analysis.

     ctest
        A collection of classical tests, including the Bartlett, Fisher,
        Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.

     date
        Functions for dealing with dates.  The most useful of them
        accepts a vector of input dates in any of the forms 8/30/53,
        30Aug53, 30 August 1953, ..., August 30 53, or any mixture of
        these.

     e1071
        Miscellaneous functions used at the Department of Statistics at
        TU Wien (E1071).

     fracdiff
        Maximum likelihood estimation of the parameters of a
        fractionally differenced ARIMA(p,d,q) model (Haslett and
        Raftery, Applied Statistics, 1989).

     gee
        An implementation of the Liang/Zeger generalized estimating
        equation approach to GLMs for dependent data.

     integrate
        Code for adaptive quadrature.

     jpn
        A function to plot Japan's coast-line and prefecture boundaries.

     leaps
        A package which performs an exhaustive search for the best
        subsets of a given set of potential regressors, using a branch-
        and-bound algorithm, and also performs searches using a number
        of less time-consuming techniques.

     mlbench
        A collection of artificial and real-world machine learning
        benchmark problems, including the Boston housing data.

     oz Functions for plotting Australia's coastline and state
        boundaries.

     polynom
        A collection of functions to implement a class for univariate
        polynomial manipulations.

     snns
        An R interface to the Stuttgart Neural Networks Simulator
        (SNNS).

     splines
        Regression spline functions.

     survival4
        Functions for survival analysis (requires splines).

     wavethresh
        Code for doing wavelet transforms and thresholding in 1 and 2D.

     xgobi
        Interface to the XGobi program for graphical data analysis.

  See CRAN `src/contrib/INDEX' for more information.

  Paul Gilbert <pgilbert@bank-banque-canada.ca> has a written a
  multivariate time series package for S called time.series that is
  mostly converted to run in R.  He is currently debugging the code, and
  will officially release it in the near future.
  According to Paul, the PADI interface from the Bank of Canada also
  works with minor changes.  PADI can be used to access Fame time series
  data bases and potentially other databases, even remotely over the
  Internet.  For further information see http://www.bank-banque-
  canada.ca/pgilbert.

  Harald Fekjaer <hfe@math.uio.no> has written addreg, a package for
  additive hazards regression, which can be obtained from
  http://www.med.uio.no/imb/stat/addreg/.

  More code has been posted to the r-help mailing list, and can be
  obtained from the mailing list archive.

  4.2.  How Can Add-on Packages Be Installed?

  (Unix only.)  Untar the add-on packages in $RHOME/src/library/ and
  type

       $ make libs
       $ cd ../..
       $ ./etc/install-libhelp

  at the shell prompt.

  4.3.  How Can Add-on Packages Be Used?

  To find out which add-ons have already been installed, type

       R> library()

  at the R prompt.  This produces something like

       NAME         DESCRIPTION
       acepack      ace() and avas() for selecting regression transformations
       bootstrap    Functions for the book "An Introduction to the Bootstrap"
       ctest        Classical Tests
       date         Functions for handling dates
       eda          Exploratory Data Analysis
       fracdiff     Fractionally differenced ARIMA (p,d,q) models
       gee          Generalized Estimating Equation models
       mva          Classical Multivariate Analysis
       splines      Regression spline functions
       survival4    Survival analysis [needs library(splines)]

  You can ``load'' the installed package name by

       R> library(name)

  You can then find out which functions it provides by typing
       R> help(library = name)

  4.4.  How Can I Contribute to R?

  R is currently still in alpha (or pre-alpha) state, so simply using it
  and communicating problems is certainly of great value.

  One place where functionality is still missing is the modeling
  software as described in ``Statistical Models in S'' (see question
  ``What is S?''.  The functions

        add1 kappa alias labels drop1 proj

  are missing; many of these are interpreted functions so anyone that is
  bored and wants to have a go at implementing them it would be appreci-
  ated.  In addition, only linear and generalized linear models are cur-
  rently available, aov, gam, loess, tree, and the nonlinear modelling
  code are not there yet.

  See also the `PROJECTS' file in the top level R source directory.

  Many of the packages available at the Statlib S Repository might be
  worth porting to R.

  If you are interested in working on any of these projects, please
  notify Kurt Hornik.

  5.  R and Emacs

  5.1.  Is there Emacs Support for R?

  There is an Emacs-Lisp interface to S/S-PLUS called S-mode.  Its
  current version is 4.8 and can be obtained at
  http://www.maths.lancs.ac.uk:2080/~maa036/elisp/S-mode/.  The earlier
  versions which can be found at the Statlib S repository (gnuemacs3 and
  gnuemacs4) are outdated.

  It contains code for interacting with an inferior S process from
  within Emacs including an interface to the help system, editing S
  source code, and transcript manipulation, and comes with detailed
  instructions for installation.

  Martin Maechler <maechler@stat.math.ethz.ch> and Tony Rossini
  <rossini@math.sc.edu> have integrated support for R into this package.
  The current version is at

       ftp://ftp.math.sc.edu/rossini/S-mode-4.8.MM6.XE2.tar.gz

  and runs under both GNU Emacs and XEmacs.

  To install, put the byte-compiled `.el' files into a place where Emacs
  can find them, and add

  (if (not (assoc "\\.R$" auto-mode-alist)
      (add-to-list 'auto-mode-alist (cons "\\.R$" 'R-mode))))
  (autoload 'R "S" "Run an inferior R process" t)
  (autoload 'R-mode "S" "Mode for editing R source" t)
  (autoload 'r-mode "S" "Mode for editing R source" t)

  to one of your Emacs startup files, typically `~/.emacs'.  You can
  then fire up R from within Emacs by typing `M-x R' (note however that
  many interface functions will not work), and if you use the extension
  `.R' for your files with R code, Emacs will automagically turn on R
  edit mode whenever you visit such a file.

  Tony Rossini, Martin Maechler and Kurt Hornik have officially taken
  over the development of S-mode.  A new version, renamed ``ESS'' (for
  ``Emacs Speaks Statistics'') and including support for R, all S
  versions, and even Xlisp-STAT and Vista, will be released shortly.

  5.2.  Should I Run R from Within Emacs?

  Yes.  Inferior R mode provides a readline/history mechanism, object
  name completion, and syntax-based highlighting of the interaction
  buffer using Font Lock mode, as well as a very convenient interface to
  the R help system.

  Of course, it also integrates nicely with the mechanisms for editing R
  source using Emacs.  One can write code in one Emacs buffer and send
  whole or parts of it for execution to R; this is helpful for both data
  analysis and programming.  One can also seamlessly integrate with a
  revision control system, in order to maintain a log of changes in your
  programs and data, as well as to allow for the retrieval of past
  versions of the code.

  In addition, it allows you to keep a record of your session, which can
  also be used for error recovery through the use of the transcript
  mode.

  6.  R Miscellania

  6.1.  How Can I Read a Large Data Set into R?

  R (currently) uses a static memory model.  This means that when it
  starts up, it asks the operating system to reserve a fixed amount of
  memory for it.  The size of this chunk cannot be changed subsequently.
  Hence, it can happen that not enough memory was allocated.

  In these cases, you should restart R with more memory available, using
  the command line options -n and -v.  To understand these options, one
  needs to know that R maintains separate areas for fixed and variable
  sized objects.  The first of these is allocated as an array of ``cons
  cells'' (Lisp programmers will know what they are, others may think of
  them as the building blocks of the language itself, parse trees,
  etc.), and the second are thrown on a ``heap''.  The -n option can be
  used to specify the number of cons cells (each occupying 16 bytes)
  which R is to use (the default is 200000), and the -v option to
  specify the size of the vector heap in megabytes (the default is 2).
  Only integers are allowed for both options.

  E.g., to read in a table of 5000 observations on 40 numeric variables,
  R -v 6 should do.

  Note that the information on where to find vectors and strings on the
  heap is stored using cons cells.  Thus, it may also be necessary to
  allocate more space for cons cells in order to perform computations
  with very ``large'' variable-size objects.

  You can find out the current memory comsumption by typing gc() at the
  R prompt.

  6.2.  Why Can't R Source a `Correct' File?

  R sometimes has problems parsing a file which does not end in a
  newline.  This can happen for example when Emacs is used for editing
  the file and next-line-add-newlines is set to nil.  To avoid the
  problem, either set require-final-newline to a non-nil value in one of
  your Emacs startup files, or make sure R-mode (see question ``Is there
  Emacs Support for R?'') is used for editing R source files (which
  locally ensures this setting).

  Earlier R versions had a similar problem when reading in data files,
  but this should have been taken care of now.

  6.3.  How Can I Set Components of a List to NULL?

  You can use

       x[i] <- list(NULL)

  to set component i of the list x to NULL, similarly for named compo-
  nents.  Do not set x[i] or x[[i]] to NULL, because this will remove
  the corresponding component from the list.

  For dropping the row names of a matrix x, it may be easier to use
  rownames(x) <- NULL, similarly for column names.

  6.4.  How Can I Save My Workspace?

  The expression

       save(list = ls(), file = ".RData")

  saves the objects in the currently active environment (typically the
  user's .GlobalEnv) to the file `.RData' in the R startup directory.

  6.5.  How Can I Clean Up My Workspace?

  To remove all objects in the currently active environment (typically
  the user's .GlobalEnv), you can do
       rm(list = ls())

  6.6.  Why Do My Matrices Lose Dimensions?

  When a matrix with a single row or column is created by a subscripting
  operation, e.g., row <- mat[2, ], it is by default turned into a
  vector.  In a similar way if an array with dimension, say, 2x3x1x4 is
  created by subscripting it will be coerced into a 2x3x4 array, losing
  the unnecessary dimension.  After much discussion this has been
  determined to be a feature.

  To prevent this happening, add the option `drop = FALSE' to the
  subscripting. For example,

         rowmatrix <- mat[2, , drop = F]  # creates a row matrix
         colmatrix <- mat[, 2, drop = F]  # creates a column matrix
         a <- b[1, 1, 1, drop = F]        # creates a 1x1x1 array

  The `drop = F' option should be used defensively when programming.
  For example, the statement

         somerows <- mat[index, ]

  will return a vector rather than a matrix if index happens to have
  length 1, causing errors later in the code.  It should probably be
  rewritten as

         somerows <- mat[index, , drop = F]

  7.  Acknowledgments

  Of course, many many thanks to Robert and Ross for the R system, and
  to the package writers and porters for adding to it.

  Special thanks go to Peter Dalgaard, Paul Gilbert, Jim Lindsey, Thomas
  Lumley, Martin Maechler, and Anthony Rossini for their comments which
  helped me improve this FAQ.

  More to some soon ...


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Aug 25 15:02:14 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 25 Aug 1997 10:02:14 -0400
Subject: R-alpha: HTML help
Message-ID: <97Aug25.100418edt.26506@mailgate.bank-banque-canada.ca>

>> It is looking like a real pain to translate the current set of html files to
>> this format which means that there is going to be some real work required in
>> getting a 3.11 version going.

> Is it possible that the HTML->RTF->WinHelp generation pointer I sent
> you would work faster? Point being that you could generate the RTF
> file on a machine with long filenames yielding a file with *internal"
> links, no restrictions on names, and in turn a .HLP file - which we
> want to have anyway.

I came to the "real pain" conclusion a couple of years ago when I
converted the help files for my time series library to HTML. My
conclusion was essentially Kurt's: give up on meaningful filenames and
build internal links. I have a couple of unix scripts which build an
index by function name and an index by title and change the "see also"
pointers to appropriate links into the index. I don't get RTF out of
this though. (I was looking for a common format, not a way to generate
all formats.) If the scripts would be of use to you let me know.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug 25 16:15:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 25 Aug 1997 17:15:32 +0200
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
Message-ID: <199708251515.RAA01258@sophie.ethz.ch>

Another request for comments

	(the last one on file extensions had not too many 'voters' ...)

Both questions have to do with improving the 'man' file format,
conventions, .. AND building the  'help', 'latex' and 'html' files from the
man sources. 

Before you read on.. 
Kurt Hornik has suggested that in any case, the compiled
'help', 'html' (and 'tex' and 'R' Example) files could be provided  
(through CRAN) for those people who would lack in the following..

1) I am trying to `replace' the current scheme of
	make install-help
	make install-latex
	make install-html
	make test-Examples	which just calls  shell script in RHOME/etc

   by a scheme that uses proper dependencies and only
   rebuilds things when and where they have changed.

   Currently, I believe that this would be much easier / nicer  if I could
   require  GNU make  (which all Linuxers have anyway) for doing these.
   I could then use things such as  $(shell: ...)   $(wildcard: ...), etc.

 Is this ok with all of you?


2) Even more extreme: Can we require  __Perl__ to be available for most
   (for all who want to build  help/html/tex files themselves)?

   If yes, we could think of enhancing the "compilation" of man files
   quite a bit, using perl instead of the
	sed .. | m4 | sed ..
   pipe which we currently need.

What do you think?

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Mon Aug 25 16:51:26 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 25 Aug 1997 11:51:26 -0400
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
In-Reply-To: Martin Maechler's message of "Mon, 25 Aug 1997 17:15:32 +0200"
References: <199708251515.RAA01258@sophie.ethz.ch>
Message-ID: <wncg1ryl0qp.fsf@fhat.stat.sc.edu>


>>>>> "Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:


    Martin>    Currently, I believe that this would be much easier /
    Martin>    nicer if I could require GNU make (which all Linuxers
    Martin>    have anyway) for doing these.  I could then use things
    Martin>    such as $(shell: ...)  $(wildcard: ...), etc.

    Martin>  Is this ok with all of you?


    Martin> 2) Even more extreme: Can we require __Perl__ to be
    Martin>    available for most (for all who want to build
    Martin>    help/html/tex files themselves)?

    Martin> What do you think?

Fine for Unix platforms.  Both are easy to build (easier than R, sort
of), and can be installed in a personal account.

I'm worried about the Mac and W95 platforms.  Ross and Robert?

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 17:31:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 09:31:20 -0700 (PDT)
Subject: R-alpha: tapply() strangeness
In-Reply-To: <199708250710.JAA14123@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970825092244.1542B-100000@avon>

On Mon, 25 Aug 1997, Kurt Hornik wrote:

> Here's something related to last week's apply() problem:
> 
> R> x <- matrix(1:20, nc = 4)
> R> x
>      [,1] [,2] [,3] [,4]
> [1,]    1    6   11   16
> [2,]    2    7   12   17
> [3,]    3    8   13   18
> [4,]    4    9   14   19
> [5,]    5   10   15   20
> 
> R> tapply(x, row(x), table)
> [1] Numeric,4 Numeric,4 Numeric,4 Numeric,4 Numeric,4
> 

Not terribly strange.  What we have here is a vector of lists (not a list
of lists as in S).  If you look at the components you see that everything
is the same as in S, it just prints differently
> tapply(x, row(x), table)->a
> a[1]
$1
 1  6 11 16 
 1  1  1  1 
or 
> a[[1]]
 1  6 11 16 
 1  1  1  1 

According to the Blue Book tapply() is supposed to return an array of
mode list  when the result of FUN applied to each category is not of
length 1. What you see is the result of my taking this literally: a
one-dimensional array
> dim(a)
[1] 5
> dimnames(a)
[[1]]
[1] "1" "2" "3" "4" "5"

I must confess that I didn't even know one-dimensional arrays were
possible -- I thought we would get a vector of mode list. Still, it seems
to work ok.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Aug 25 17:43:55 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 25 Aug 1997 12:43:55 -0400
Subject: R-alpha: Re: missing' BB functions
Message-ID: <97Aug25.124604edt.26509@mailgate.bank-banque-canada.ca>

Kurt

The function tempfile is available based on some C code from Friedrich
Leisch. The function unlink is fairly simple in unix but I haven't
experimented elsewhere. In this regard, I have put together a small
kernel set of functions to try to handle cross platform and R vs S
issues. This is appended below and I would certainly appreciate
feedback. The purpose of this kernel is so that I can write my code in
a way which will work in Splus or R and on most platforms.

I believe the function sort.list is just a special case of the function
order, which works in R.

Included with the kernel functions below is a set.seed function which I
have modified slightly (both in Splus and in R) so that it returns the
new value of the seed rather than returning NULL. There is a bit of a
kludge to make set.seed work with the single integer argument suggested
in the BB. It also works with the more realistic argument, a
previous setting of the seed.

I have working versions of tsmatrix and tsplot, but I'm not sure to
what extent they can be separated from a small "tframe library" I have
built to separate out (improve) the handling of the time dimension in
both Splus and R. I'll take a look at this shortly.

Also, if anyone has coded the functions acf and/or ar I would certainly
appreciate having them.


Paul Gilbert 


##############################################################################


# This file has code which contains operating system and S/R specific 
#   functions. They are intended to be used as a kernel to help 
#   protect other code from these problems.

# The MSwindows versions are not done. The Splus and Sun versions are done
# largely from memory (and old code) and have not yet been checked.

# The following functions are attempted:
#   For S/R differences:
#      global.assign, system.info, exists.graphics.device, tmpfile, unlink,
#      synchronize,  list.add for [["new.element"]]<-
#   For OS differences: 
#     system.call, sleep, present.working.directory, whoami, file.copy, 
#     file.date.info, date, mail, unlink, local.host.netname, 

# Also a number of is.xx functions are defined to identify systems.

# The variable  .SPAWN is also set to be used to identify if Splus "For" loops
#    should be used. (It is sometimes better not to use these even in Splus.)

##############################################################################

# there is a bit of a bootstrap problem first. 
  
# S untested !!!
if (!exists("version")) 
                 {version <- list(language="S", major=1, minor=1) 
                  system.call<- function(cmd){unix(cmd) }   
                 }
# Splus
if( is.null(version$language))
                  system.call<- function(cmd){unix(cmd) }   
# R:
if(!is.null(version$language) && (version$language=="R"))
                  system.call<- function(cmd){system(cmd, intern=T)}
 
#  end of bootstrap

system.info <- function() 
  {r <-unclass(version)
   r$minor <- as.numeric(r$minor)
   r$major <- as.numeric(r$major)
   if (is.null(r$language))  r$language <- "Splus"
   r$OSversion <- paste(system.call("uname -s"), 
                        system.call("uname -r | sed -e 's/\\.\.\*//'"), sep="")
   r
  }

is.R <- function(){system.info()$language == "R"}
is.S <- function(){is.Splus() | (system.info()$language == "S")}
is.Splus <- function(){system.info()$language == "Splus"}
is.Splus.pre3.3 <- function()
 {# <= 3.2 
  is.Splus() &&  ((system.info()$major+.1*system.info()$minor) < 3.3)
 }
is.Linux <- function(){system.info()$os == "linux"} 
is.MSwindows <- function(){system.info()$os == "MS Windows"}
is.Sun4 <- function(){"SunOS4" == system.info()$OSversion }
is.Sun5 <- function(){"SunOS5" == system.info()$OSversion }
is.unix <- function(){is.Linux() | is.Sun5() | is.Sun4() | 
                      (system.info()$os == "Unix")}  # ???

if(is.unix())
  {if(is.R()) unix <- function(cmd) system(cmd, intern=T)
   sleep <- function(n) {unix(paste("sleep ", n))} # pause for n seconds
   present.working.directory <- function(){unix("pwd")} # present directory
   whoami <- function(){unix("whoami")} # return user id (for mail)
   local.host.netname <-function() {unix("uname -n")}
   date <-function() {unix("date")}

   mail <- function(to, subject="", text="")
    {# If to is null then mail is not sent (useful for testing).
     file <- tmpfile()
     write(text, file=file)
   if(!is.null(to)) unix(paste("cat ",file, " | mail  -s '", subject, "' ", to))
     unlink(file)
     invisible()
    }

   file.copy <- function(from, to)unix(paste("cp ", from, to)) # copy file

   file.date.info <- function(file.name)
     {mo <- (1:12)[c("Jan","Feb","Mar","Apr","May", "Jun","Jul","Aug", "Sep",
         "Oct","Nov","Dec") ==substring(unix(paste("ls -l ",file)),33,35)]
      day <- as.integer(substring(unix(paste("ls -l ",file.name)),37,38))
      hr  <- as.integer(substring(unix(paste("ls -l ",file.name)),40,41))
      sec <- as.integer(substring(unix(paste("ls -l ",file.name)),43,44))
      c(mo,day,hr,sec)
     }
  }

if(is.MSwindows())
  {system.call  <- function(cmd) 
         {stop("system calls must be modified for this operating system.")}
   sleep <- system.call 
   present.working.directory <- system.call
   whoami <- system.call
   file.copy <- system.call
   file.date.info <- system.call
  }


if(is.S())
   {tmpfile <- tempfile
    if(is.unix())system  <- unix   
    global.assign <- function(name, value) {assign(name,value, where = 1)}
    .SPAWN <- TRUE
    exists.graphics.device <- function(){dev.cur() !=1 }
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                 {motif(display) }
    close.graphics.device <- function(){dev.off() }
    if (!exists("set.seed.Splus")) set.seed.Splus <- set.seed
    set.seed <- function(seed=NULL)
      {if (is.null(seed)) 
          seed <-.Random.seed
       else 
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }

    "list.add<-" <- function(x, replace, value)
       {# replace or add elements to a list.
        x[replace] <- value
        # x[[replace]] <- value  would be more logical but doesn't work
        x
       }
   }
        
if(is.R()) 
   {tmpfile <- function(f)
        {# Requires C code also from Friedrich Leisch not in version 0.15 of R.
         d<-"This is simply a string long enough to hold the name of a tmpfile";
         .C("tmpf", as.character(d))[[1]]
        }
    unlink <- function(file) system.call(paste("rm -fr ", file))
    global.assign <- function(name, value) 
                          {assign(name,value, envir=.GlobalEnv)}
    synchronize<- function(x){NULL} # perhaps this should do something?
    .SPAWN <- FALSE
    exists.graphics.device <- function(){exists(".Device")}
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                {x11(display) }
    close.graphics.device <- function(){F} # how do I do this?
    set.seed <- function(seed=NULL)
      {if (is.null(seed)) 
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not yet exist
          seed <-.Random.seed
         }
       else 
         {if (1==length(seed))
             global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }

   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list. 
      if (is.numeric(replace))
        {# x<- do.call("default.[[<-", list(x,replace,value))   # use default
         x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value)) 
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }
 }



##############################################################################

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 17:48:15 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 09:48:15 -0700 (PDT)
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
In-Reply-To: <199708251515.RAA01258@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970825094416.1542D-100000@avon>

On Mon, 25 Aug 1997, Martin Maechler wrote:
> 1) I am trying to `replace' the current scheme of
> 	make install-help
> 	make install-latex
> 	make install-html
> 	make test-Examples	which just calls  shell script in RHOME/etc
> 
>    by a scheme that uses proper dependencies and only
>    rebuilds things when and where they have changed.

Yes, yes !!
 
>    Currently, I believe that this would be much easier / nicer  if I could
>    require  GNU make  (which all Linuxers have anyway) for doing these.
>    I could then use things such as  $(shell: ...)   $(wildcard: ...), etc.
> 
>  Is this ok with all of you?

We tend to have GNU tools available on machines here, even under
SunOS/Solaris.  I don't know common this is.

> 
> 2) Even more extreme: Can we require  __Perl__ to be available for most
>    (for all who want to build  help/html/tex files themselves)?


I actually think requiring Perl is less extreme than requiring GNU make.
Perl is useful for so many things (eg CGI scripts) that almost everyone
has it.  There must be quite a lot of people who rely on the make that
comes with their system, though.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 18:18:08 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 10:18:08 -0700 (PDT)
Subject: R-alpha: eigen and batch
In-Reply-To: <9708250742.AA12773@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970825095235.1542E-100000@avon>

On Mon, 25 Aug 1997, Jim Lindsey wrote:
> 
> eigen:
>    I started looking in the eispack C code and traced down the
> problem. In three of the four Fortran calls in eigen, (ch,rs,cg but
> not rg), the same vector (vals) is used for the return eigenvalues as
> for two or three temporary workspace vectors. This is risky
> programming at any time and leads to a catastrophe with a 586 where
> several things may be calculated at the same time. 

No, this is a bug in .Fortran.  Everything sent to C or FORTRAN code is
supposed to be a *copy* of the R object.  This is because R is allowed to
move things around in memory whenever it feels the urge, but C and FORTRAN
assume things stay fixed.  Since everything is supposed to be copied there
is no harm in using multiple copies of the same thing. 

One possible source of this bug is in naoktrim in src/main/dotcode.c
which begins
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 0;
                *len = 0;
        }
but should begin
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 1;
                *len = 0;
        }


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Tue Aug 26 00:49:40 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Tue, 26 Aug 1997 11:49:40 +1200 (NZST)
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
Message-ID: <199708252349.LAA23088@stat1.stat.auckland.ac.nz>

As for windows (I'm no expert though);
  perl is nicer than anything else and it's available on the mac as well.
  make is a bit of a moot point; all c compilers have a make but it is
  different and the whole notion of distributing patches etc doesn't
  seem to have caught on much in the windows environment so I don't think
  we should worry about it too much.
  
  
robert  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 26 07:13:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 26 Aug 1997 08:13:55 +0200
Subject: R-alpha: Re:  barplot
Message-ID: <199708260613.IAA22900@aragorn.ci.tuwien.ac.at>

Did anyone have a quick look at my modified barplot?  I am waiting for
some kind of `OK' before I go on to convert the matrix case, too ...
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 27 16:11:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 27 Aug 1997 17:11:50 +0200
Subject: R-alpha: (minor?) S/R inconsistency:  mode(unclass(terms(...)))
Message-ID: <199708271511.RAA00953@sophie.ethz.ch>

I just stumbled over the following :

  mode(utf <- unclass(tf <- terms( ~ (x + y + z)^2)))
  ## R:  "call"
  ## S:  "expression"

Don't know if/when this could be important.
It made a big difference for me, but this was in low-level
experimentation...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Aug 27 16:46:59 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 27 Aug 1997 17:46:59 +0200
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <199708271546.RAA00253@galadriel.ci.tuwien.ac.at>


With help by Kurt and Martin I have written a short proposal for a new
R doc source format that should be easier to parse using, e.g.,
perl. There should be especially a clearer distinction between text
and keywords.

Here we go, please make comments, corrections, etc.

Best,
Fritz

**********************************************************

Conversion:
-----------

A perl module providing functions to parse the source text which are
used by other functions to produce latex, html, etc. 


Environment delimiters:
-----------------------
Change from () to {} as in latex and most programming languages such
that `()' can be used in equations without need for escaping


Keywords:
---------
Start all keywords with a backslash like in latex, because IMO the
word TITLE should not be something special simply because it is
written in capital letters.

if possible, keep latex syntax whenever possible, e.g., replace
greekalpha with \alpha, LDOTS with \ldots, etc.


Unknown keywords are ignored and result in a warning message from the
parser.


Logical Blocks:
---------------

The current logical blocks of the source files such as

	TITLE(...)
	USAGE(...)
	ALIAS(...)
	ARGUMENTS(...)

are kept and the first step of parsing the file is splitting it into
these blocks.

Then the single blocks are parsed and splitted into their parts (like
ARG lists), the remaining parts should then be something like `Rdoc text'
which must only be correctly converted into the output language
(equations, bold font, ...).


VALUE(S)
--------

Here only one environment should be necessary, if it contains more
than one ARG environment, it is what's now VALUES.


New keywords:
-------------

	TITLE, USAGE, ...	\title{...}, \usage{...}, ...
	ARG			\arg{argname}{description}
	BOLD			\bf{word}
	ITALIC			\emph{word}
	LANG			\code{word}
	PARA			\par
	BLANK			\blank
	LINK			\link{...}
	DOTS			\dots
	LDOTS			\ldots
	EQUALS			\=       ???but why is this needed???
	LT			\lt
	GT			\gt
	...

replace all math constructs with latex commands

Equation commands:

	EQN()			\eqn{A1}{A2}   ??? or \eqn[A2]{A1} ???
	DEQN(A1 @@ A2)		\deqn{A1}{A2}

where A1 is pure latex and A2 is an ascii version of the formula. If
only one argument is given, A1 and A2 are taken to be the same (such
that we don't have to write \eqn{x}{x}). \eqn corresponds to latex's
$$ and \deqn corresponds to \[ \].


Hard line break
---------------

\cr gives a hard line break



Comments:
---------

Ignore everything after a `%', \% gives the corresponding
character. We don't use the usual # for comments, because # appears to
often in example environments.







=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Thu Aug 28 08:13:37 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 28 Aug 1997 09:13:37 +0200
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>

At 17:53 27/08/97, friedrich.leisch@ci.tuwien.ac.at wrote:

>With help by Kurt and Martin I have written a short proposal for a new
>R doc source format that should be easier to parse using, e.g.,
>perl. There should be especially a clearer distinction between text
>and keywords.

What happened to the idea of using SGML for the new documentation
format?  
Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 28 09:17:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 28 Aug 1997 20:17:42 +1200 (NZST)
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <199708280817.UAA18043@stat1.stat.auckland.ac.nz>

I think SGML was an idea I was pushing,  but I don't have the time
to pursue it.  I'm not sure that the required tools are out there
yet anyway.  Friedrich's proposal has the definite advantage that
it will happen.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Aug 28 15:14:14 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 28 Aug 1997 16:14:14 +0200
Subject: R-alpha: Proposal for a new R doc source format
In-Reply-To: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>
References: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>
Message-ID: <199708281414.QAA01409@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 28 Aug 1997 09:13:37 +0200,
>>>>> Martyn Plummer wrote:

> At 17:53 27/08/97, friedrich.leisch@ci.tuwien.ac.at wrote:
>> With help by Kurt and Martin I have written a short proposal for a new
>> R doc source format that should be easier to parse using, e.g.,
>> perl. There should be especially a clearer distinction between text
>> and keywords.

> What happened to the idea of using SGML for the new documentation
> format?

Well, that's not too easy to explain ... first of all Kurt doesn't
like SGML (from his experience writing the FAQ in SGML) and he's my
boss, so I don't like it, too ;-)

More serious reasons:

1) More people writing R code will know LaTeX than SGML, so if we
have a LaTeX-like syntax it should be easier to learn. I want to keep
the new format as close to latex as possible such that it should be
very easy ...

2) Is the SGML-tools output not always really satisfying, and we would
have to extend the existing SGML formats anyway because it doesn't
support everything we want.

3) Is perl definetely on more systems installed than the sgml-tools.

For all this reasons (and some more which I don't remember right now)
I wouldn't like to make an R help system based on SGML, but if you
volunteer ...

Best,
Fritz

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 28 17:01:05 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 28 Aug 1997 12:01:05 -0400
Subject: R-alpha: pow_ii
Message-ID: <97Aug28.120241edt.26501@mailgate.bank-banque-canada.ca>


>> I'm a bit confused about this discussion, but since I don't have f2c on
...

>A lot of Fortran code doesn't require any libf2c routines.  When routines
>are needed the most common ones are the exponentiation routines pow_dd,
>pow_ii and pow_di (pow_ri is for single precision reals and so is less
>needed in R, which uses double precision).  However, *some* fortran code,
...

Thomas

>From your previous response to my confusion I guessed I would be ok
with pow_ii, but that does not seem to be the case:

R
...
>  dsecurve.function.tests(verbose=T) 
Random number generator tests ...ok
DSE curvature test 1 ... ld.so.1: /R/bin/R.binary: fatal: relocation error: symbol not found: pow_ii: referenced in /dse/dsefor.so
Killed

[4] /R : nm bin/R.binary | grep pow
[146]	|    244556|     312|FUNC |LOCL |0    |7      |complex_pow
[2557]	|   1462800|       0|FUNC |GLOB |0    |UNDEF  |pow
[2795]	|   1053360|      68|FUNC |GLOB |0    |7      |pow_dd
[2800]	|   1053124|     236|FUNC |GLOB |0    |7      |pow_di
[377]	|   1474036|       4|OBJT |LOCL |0    |15     |powerSymbol
[5] /R : 
[5] /R : R


This leads me to wonder how R calculates powers and exp for complex
numbers. I presume that if I can arrange to call the same routines then
I can avoid the extra burden of having to include parts of libf2c with
my distributed code. Do you know what R uses and can I call these from
fortran?

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 28 19:36:10 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 28 Aug 1997 11:36:10 -0700 (PDT)
Subject: R-alpha: Re: pow_ii
In-Reply-To: <97Aug28.120241edt.26501@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970828112057.7336A-100000@troi>

On Thu, 28 Aug 1997, Paul Gilbert wrote:

> Thomas
> 
> >From your previous response to my confusion I guessed I would be ok
> with pow_ii, but that does not seem to be the case:

No, pow_ii doesn't seem to be in there
 
> 
> This leads me to wonder how R calculates powers and exp for complex
> numbers. I presume that if I can arrange to call the same routines then
> I can avoid the extra burden of having to include parts of libf2c with
> my distributed code. Do you know what R uses and can I call these from
> fortran?

There is code in src/main/complex.c

This contains routines for powers, division and transcendental functions.
Unfortunately they are all declared static, so you can't use them. 

I don't know if there is any real need to make these static, apart from
tidiness (Anyone?) so it's possible that these could be changed in the
future.

Still, I liked Ross' suggestion of just making a f2c R package


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 28 19:49:03 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 28 Aug 1997 14:49:03 -0400
Subject: R-alpha: HTML help
Message-ID: <97Aug28.145036edt.26508@mailgate.bank-banque-canada.ca>

Below is a copy of the script I mentioned a few days ago, and Kurt
suggested I should post. It takes as input a single file of all the
html formatted function help, divides this into single files with
non-descriptive but unique and dos8.3 compatable names, and generates
both name and title indexes. It also changes the "see also"
functions to be links to the appropriate place in the name index.
(This is a compromise which was easier to do then link directly to the
appropriate file.) 

If you want to see how this approach to help works, look at

http://www.bank-banque-canada.ca/pgilbert/help/dsehome.htm

The indexes are generated from two html "NAME" tags I have written into
the html files, one for the function name and one for the function
title. eg.

<A NAME=stability><H1>stability</H1></A>
<A NAME=CalculatestabilityofaTSmodel>Calculate stability of a TSmodel</A><BR><HR>

The "see also" links are generated from the HREF tag, eg.

<H2>See Also</H2>
<UL>
<A HREF="#stability">stability</A>
</UL>


I have used a convention of .htm instead of .html because I wanted this
to work in DOS too. (I just noticed this has not been done in the R
html help.)

The generated files have "dse" prefixed to indicate my library. I tried
to make the prefix variable, but so far I haven't had any luck.

Another convention I have found very useful in maintaining help is to
embed the help directly into my coded files using /* */ multi-line
style comments to separate it from code. I then run these files through
an awk filter to separate the help into one file and the code into a
second. This can be done with a modified source() function within R or
S. Before I started to use this convention I found that I was
duplicating much of the documentation into comments in the code, and in
fact the comments in the code were often much more accurate than the
help files.


Paul Gilbert

______
#!/bin/sh

if [ $# -ne 2 ]; then
  echo usage:
  echo "  build.HTML.help2  sourcefile targetlocation"
  echo "   where sourcefile is a file of all the HTML help and"
  echo "       targetlocation is the target directory"
  exit
fi 


# I haven't been able to get the variable substitution to work 
#    in some places where there are quotes
# PREFIX is added to the beginning of all generated help files
# PREFIX should not be more than 3 character for dos compliance
# PREFIX=dse

#intro is an html file used as the starting point for 
#   a browser (eg home.htm or index.htm)
#intro=dsehome.htm

tmphelp=$1
help=$2
mkdir -p $help
cd $help  

echo help directory set to $help
# This script expects to find the two files:
#     $tmphelp (all function help) and dsehome.htm (the introduction)
# The function help in the file $tmphelp is broken into individual files and
# an indexes built. $tmphelp is removed on completion.

# A function index is built from the <A NAME= ... ><H1> lines
# and  title index is built from the other <A NAME=  lines.
# These are put in the file dsefidx.htm and dsetidx.htm respectively

echo "number of NAME lines in $tmphelp " `grep NAME $tmphelp | wc -l`
echo "(The number of NAME lines is aprox. 2 times the number of help functions)"

#  Step 1 -  break up  functions into alphabetical sub-files.

sed  "s/<A NAME=\(.*\)><H1>\(.*\)/@<A NAME=\1><H1>\2/g" $tmphelp >zot2$$

# The next line converts line breaks to ; then converts @ to line breaks
tr '\012'  '\073' <zot2$$ | tr '@' '\012'  >zot3$$

echo "1st check: the number of help functions is about " `wc -l <zot3$$`

split -1 zot3$$ $help/dseH
rm zot2$$ zot3$$

echo "2nd check: the number of help functions is about " `ls -l dseH* | wc -l`


#  Step 2 - convert See Also references to point to the function index, eg:
# <A HREF="#TSmodel"> TSmodel</A>
# or
# <A HREF=#TSmodel> TSmodel</A>
# or
# <A HREF=TSmodel> TSmodel</A>

# to
# <A HREF="dsefidx.htm#TSmodel"> TSmodel</A>

# and first convert ; back to <cr>

for f in `ls dseH[a-z]*`
do
  tr '\073' '\012'<$f | sed 's/<A HREF="\(.*\)">\(.*\)/<A HREF="\1">\2/g' >zotaa
  sed 's/<A HREF="#\(.*\)">\(.*\)/<A HREF="#\1">\2/g' zotaa >zotbb
  sed 's/<A HREF="#\(.*\)">\(.*\)/<A HREF="dsefidx.htm#\1">\2/g' zotbb >$f.htm
  echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>$f.htm
  rm $f
done
rm  zotaa zotbb 

# Step 3 - build Function and Title indexes dsefidx.htm and dsetidx.htm

grep "<A NAME=" dseH[a-z]*.htm | grep -v "<H1>" >zotT$$
grep "<A NAME=" dseH[a-z]*.htm | grep "<H1>" >zotN$$

# build Index to functions by Name


echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR><A NAME=IndexbyFunctionName><H1>Index to Functions by Name</H1></A><HR><HR>' >dsefidx.htm

# use grep output of file name in eg
# dseHaa.htm:<A NAME=arma><H1>ARMA</H1></A>
#           \1              \2       \3

# to insert HREF links (but leave NAME for jump into index) eg
# <A NAME=->arma</A><A HREF=dse1.htm>ARMA</A><BR>
#            \2                \1       \3
 
sed 's/<H1>//g' zotN$$ | sed 's/<\/H1>//g' | sed 's/<HR>//g' | sed 's/<BR>//g' >zotN5$$
sed 's/\(.*\):<A NAME=\(.*\)>\(.*\)<\/A>/<A NAME=\2>-<\/A><A HREF=\1>\3<\/A><BR>/g' zotN5$$ >zotN6$$

sort -f <zotN6$$ >>dsefidx.htm
rm zotN[1-6]*$$

echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>dsefidx.htm


# build Index to functions by Title

echo '<HR><HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR><A NAME=IndexbyTitle><H1>Index to Functions by Title</H1></A><HR><HR>' >dsetidx.htm

sed "s/<HR>//g" zotT$$  >zotT2$$
sed "s/<BR>//g" zotT2$$ >zotT3$$
sed "s/\(.*\):<A NAME=\(.*\)>\(.*\)<\/A>/<A NAME=\2>-<\/A><A HREF=\1>\3<\/A><BR>/g" zotT3$$ >zotT4$$

sort -f <zotT4$$ >>dsetidx.htm
rm zotT[1-6]*$$

echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>dsetidx.htm

rm zot?$$
#  $tmphelp

echo "number of help functions in title index    " `wc -l <dsetidx.htm` "-2"
echo "number of help functions in function index " `wc -l <dsefidx.htm` "-2"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 29 17:47:26 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 29 Aug 1997 18:47:26 +0200
Subject: SUMMARY: R-alpha: Can we "require"  1) GNU make,  2) Perl
In-Reply-To: <Pine.SUN.3.95.970825094416.1542D-100000@avon> (message from
 Thomas Lumley on Mon, 25 Aug 1997 09:48:15 -0700 (PDT))
Message-ID: <199708291647.SAA08655@sophie.ethz.ch>

Just to 'clean up' the week,  a summary about my 'RFC' :

The reactions I got (not all went thru  R-devel):

1) perl is ok  (--> new 'R doc/man' format by Fritz Leisch & Kurt Hornik ...)

2) GNU make is not really ok.

 Some people like to use their vendor's make rather than GNU's
	[I myself have changed this behavior a few years ago;
	 here, we all PATH such that GNU's make comes BEFORE Sun's make ..]

==> I'll try not to rely on GNU make at all.

	[[Actually I haven't done too much yet, 
	  just created an  etc/Makefile and
	  moved things from $RHOME/Makefile there..]]


--- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Sun Aug 31 20:34:59 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Sun, 31 Aug 1997 12:34:59 -0700 (PDT)
Subject: R-alpha: ?bug in [.data.frame
In-Reply-To: <199708311138.NAA13464@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SOL.3.95.970831122953.22219B-100000@gorn>


If you subscript a data frame using the names of the columns and there is
more than one column with the same name only the first one is found.
eg
	mm<-data.frame(1:10,log(1:10))
	names(mm)<-c("(offset)","(offset)")
	mm[,"(offset)"]			# only returns first column
	mm[,"(offset)"]<-rep(1,10)	# only sets first column

This *is* compatible with S, but I still think it's the wrong thing to do.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Aug 31 21:11:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 31 Aug 1997 22:11:54 +0200
Subject: R-alpha: ?bug in [.data.frame
In-Reply-To: Thomas Lumley's message of Sun, 31 Aug 1997 12:34:59 -0700 (PDT)
References: <Pine.SOL.3.95.970831122953.22219B-100000@gorn>
Message-ID: <x2g1rq6rjp.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> If you subscript a data frame using the names of the columns and there is
> more than one column with the same name only the first one is found.
> eg
> 	mm<-data.frame(1:10,log(1:10))
> 	names(mm)<-c("(offset)","(offset)")
> 	mm[,"(offset)"]			# only returns first column
> 	mm[,"(offset)"]<-rep(1,10)	# only sets first column
> 
> This *is* compatible with S, but I still think it's the wrong thing to do.

This is a generic list thing. Nothing keeps you from having several
elements with the same name, you just get certain problems accessing
them. 

> l<-list(1,2,3)
> names(l)<-c("a","b","b")
> l
$a
[1] 1

$b
[1] 2

$b
[1] 3

> l$b
[1] 2

I rather strongly suspect that coding for the possibility, that in a
list of vectors l$b could mean another list, would be a real pain.
I.e. you deserve what you get...

If you must have identically named columns, try something along the
lines of

> l[names(l)=="b"]
$b
[1] 2

$b
[1] 3

> l[names(l)=="b"]<-4
> l
$a
[1] 1

$b
[1] 4

$b
[1] 4


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: Bugs in R-0.50-a1.
In-Reply-To: <9707290928.AA07210@alpha.luc.ac.be>
References: <9707290928.AA07210@alpha.luc.ac.be>
Message-ID: <199708011154.NAA20022@aragorn.ci.tuwien.ac.at>

>>>>> Patrick Lindsey writes:

> Problems in R but not in S:
> ---------------------------

> 1) 'unlist' seems to have several other problems than the ones
> reported up to now. For instance, 'unlist' can be used on almost any
> object in S without much trouble. Eg.:
S> unlist(c(2))
> 	[1] 2
S> 
> 	---
R> unlist(c(2))
> 	Segmentation fault (core dumped)
> This occurs in R-0.49 and in R-0.50-a1.

Confirmed.

> 1) The 'R Graphics' window does not have any X class or resource and
> therefore cannot be given a default size or geometry. Would it be
> possible to give the graphic window a class name so that the size
> could be specified in the '.Xdefaults' file?

Yes, that would be nice.

> 3) Some problems occur when using the help. Eg.,
R> ?"+"
> sorry, no help for "Arithmetic".
R> 
> This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
> any item contained in a help file starting with a capital letter.

The problem is as follows.  The function help() catches the special funs
like "+" etc (more precisely, the arithmetic, comparison, logic and
extract ones) and directly assigns a topic for them.

For "+", the topic is 'Arithmetic".  But the index file has no entry for
that, because (see RHOME/etc/install-help)

***********************************************************************
if [ $lib != 'base' ]
##-- The following is NOT done anymore in 'base':
##-- 1) Each help file should have  ALIAS(..) for  ALL it's objects
##-- 2) The  help file name may differ from _ANY_ object (eg 'Special')
then 
	for file in $FILES
	do
		echo "$file	$file"
	done
fi
***********************************************************************

If that really is the intended usage (Martin?), then e.g. the Arithmetic
file should also have ALIAS(Arithmetic) in it.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: R 0.50.a1 graphics
Message-ID: <199708011154.NAA20025@aragorn.ci.tuwien.ac.at>

Here are some misc comments on graphics.

* I am not sure whether `adj' works correctly.  When using e.g.

	title(sub = "SUBTITLE", adj = 0)

shouldn't the subtitle appear on the very left?  It seems that
justification is done off the middle of the plot window.

* S barplot has argument `horiz', R does not.

* More importantly, the barplot() argument `space' is treated
differently under R and S.

S has,

	the space (as a fraction of the average bar width) that
	should be left before each bar.
	This may be given as a single number or one number per bar.
	If `beside' is `TRUE', `space' may be specified by 2 numbers
	where the first is the space between bars in a set,
	and the second is the space between sets.

R has,

	the relative amount of space between the bars or groups of
	bars. The width of a bar (or group of bars) plus the value of
	space is one.

The S behavior is perhaps more useful, as it allows to have groups of
bars.

* The documentation for title() does not mention `sub'

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: R 0.50.a1 bug in do_title()
Message-ID: <199708011154.NAA20023@aragorn.ci.tuwien.ac.at>

There is an empty `else' clause in the code for do_title() in
src/main/plot.c (which results in subtitles appearing twice, or some
other strange thing ...).

Below is a `patch'.

-k

*** src/main/plot.c.orig	Fri Aug  1 10:17:41 1997
--- src/main/plot.c	Fri Aug  1 10:18:05 1997
*************** SEXP do_title(SEXP call, SEXP op, SEXP a
*** 1224,1231 ****
  
  	if (CAR(args) != R_NilValue && LENGTH(CAR(args)) > 0)
  		sub = CAR(args);
- 	else
- 		
  	args = CDR(args);
  
  	if (CAR(args) != R_NilValue && LENGTH(CAR(args)) > 0)
--- 1224,1229 ----
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 15:04:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 16:04:48 +0200
Subject: R-alpha: R-beta: RPM package for R
In-Reply-To: <199707292358.LAA18350@stat1.stat.auckland.ac.nz>
References: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
 <199707292358.LAA18350@stat1.stat.auckland.ac.nz>
Message-ID: <199708011404.QAA20492@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Martyn Plummer writes in r-announce:
>> A precompiled "RPM" binary of R-0.50.a1 is now available on CRAN for
>> installation on Linux systems which use the RedHat Package
>> Manager

> Before we get to may versions floating about ... 

> I had intended that these "a1", "a2" ... releases be hacker releases
> which will be followed by a R-0.50.stable release when the (worst)
> problems are sorted out.  Thats why I announced to "r-devel" rather
> than "r-announce".

> (Note this is information rather than any kind of policy statement,
> you are of course free to do whatever you like with R)

Sorry everyone,

This was mostly my mistake.  Martyn sent me an email that he had
uploaded the packages to CRAN incoming, and I was only in my office for
a few minutes, so without further thinking I moved them into CRAN/src
and told Martyn that I had done so and that he might announce the
packages now.

>From a user perspective, the bugs are perhaps not that bad (well, 
ignoring the shortest segfaulter `unlist(1)'), but anyway ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Aug  2 16:55:05 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 2 Aug 1997 17:55:05 +0200
Subject: R-alpha: Re: ?"+"; ALIAS(Arithmetic)
In-Reply-To: <199708011154.NAA20022@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 1 Aug 1997 13:54:36 +0200)
Message-ID: <199708021555.RAA14833@florence.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Patrick Lindsey writes:
    >> Problems in R but not in S: ---------------------------
    ......

    >> 3) Some problems occur when using the help. Eg.,
    R> ?"+"
    >> sorry, no help for "Arithmetic".
    R>
    >> This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
    >> any item contained in a help file starting with a capital letter.

    Kurt> The problem is as follows.  The function help() catches the
    Kurt> special funs like "+" etc (more precisely, the arithmetic,
    Kurt> comparison, logic and extract ones) and directly assigns a topic
    Kurt> for them.

    Kurt> For "+", the topic is 'Arithmetic".  But the index file has no
    Kurt> entry for that, because (see RHOME/etc/install-help)
			.......

    Kurt> If that really is the intended usage (Martin?), then e.g. the
    Kurt> Arithmetic file should also have ALIAS(Arithmetic) in it.

Yes, this is the thing to do.

It was R&R's idea to change the usage of  ALIAS(.).
[[Again: an ALIAS(..) should be made for  EVERY  R object that is
	 documented in that man file, and sometimes even for things such as
  Special or Arithmetic
]]

The current  etc/install-help  
was made by me in order to merge the former  install-help and
install-libhelp (Kurt, this answers another question of you) and
reflects the fact that the help files in the libraries have not (yet!?)
been adapted to the new scheme.

I think, we should decide to upgrade the help files of the libraries --
(eda & mva) and ALL the 'contrib' ones !! -- to the new scheme.

The only thing: The upgrade should happen  'SIMULTANEOUSLY'
such that a simple change to etc/install-help then would make things work.
A good time to do this would be  "about now", i.e. before another alpha
release and (somewhat ?) close to THE 0.50 beta relase...

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Aug  2 23:40:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Aug 1997 00:40:44 +0200
Subject: R-alpha: .RData zapped by system shutdown
Message-ID: <x2pvrw2opf.fsf@bush.kubism.ku.dk>


Watch:

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-1 (July 22, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

[Previously saved workspace restored]

Error: restore file corrupted -- no data loaded

---

-rw-r--r--   1 pd       users      0 Aug  1 12:46 /home/pd/R-sandbox/.RData

---

Aug  1 12:46:27 blackbird init: Switching to runlevel: 6
Aug  1 12:46:28 blackbird getty[197]: exiting on TERM signal

---

"Houston, we have a problem here".... As I remember, R was just
sitting in an xterm window doing nothing when the system was taken
down. This is weird, because as far as I can tell from the source, R
shouldn't try to save the workspace in an interactive session without
user confirmation. 

One possible scenario to explain it is that when the xterm got killed,
R's standard input was closed *and detached from the pty*, so that the
evaluation loop terminates, isatty(0) returns 0, forcing a save of the
GlobalEnv, during which the R process itself got terminated.

Fix? First of all, I suggest that the original .RData be rename()'d
before it is opened for writing (the backup may or may not be removed
afterwards). Secondly, do we really want this behaviour where isatty()
is called at a very late stage, or would we rather have the logic
depend on R_interactive? The cases to consider is when an interactive
session gets backgrounded, or loses its controlling terminal. And
shouldn't there be a signal handler for the TERM signal, to ensure
that things get wrapped up?

[Fortunately, the important bits of that workspace had been dumped out
previously, so I didn't lose much]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Aug  3 15:22:13 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Aug 1997 16:22:13 +0200
Subject: R-alpha: One-row frames don't work
Message-ID: <x2hgd7ny7d.fsf@bush.kubism.ku.dk>


While trying to write a half-decent predict.lm, I stumbled upon this
obstacle:

> data.frame(x=2)
  x
> data.frame(x=1:2)
     x
[1,] 1
[2,] 2

BTW, there really isn't a working predict() floating around, is there?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 10:47:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 11:47:35 +0200
Subject: R-alpha: 0.50-a1 -- "more lost comments"
Message-ID: <199708040947.LAA28328@sophie.ethz.ch>

In CHANGES, it says

------------------------------------------------------------
>> BUG FIXES

   ........

>>  o  Comments are handled better in functions.  The rule is that they
>>     are shifted to just before their statements.  Comments after the
>>     last statement of a function are lost.
------------------------------------------------------------
I think we could live with the above advertized behavior.
Unfortunately, in the following case 'xx1' even a comment BEFORE the last
statement is lost 
 ((because the last statement is so trivial ???,
   it is NOT lost in the  'xx1a' example  (and in others I tried)) :

This is in plain  0.50-a1 :

> xx1 <- function(x) {
+  ##--- a Start-comment ... (lost in 0.50-a1)
+  x
+ }
> xx1 
function (x) 
{
        x
}


> xx1a <- function(x) {
+   ##--- a Start-comment ... (ok in 0.50-a1)
+   x+1
+ }
> xx1a
function (x) 
{
        ##--- a Start-comment ... (ok in 0.50-a1)
        x + 1
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: pow_dd
Message-ID: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>

Hmm ... It seems that as of 0.50.a1 we need to link against f2c because
pow_dd is no longer provided (internally, POW_DD is used).  I am not
sure how much sense that really makes, but it would seem that getting
the things from 0.49 f2clib.c back would be great ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: `axes' argument for barplot()
Message-ID: <199708041115.NAA21208@aragorn.ci.tuwien.ac.at>

Clearly, barplot should have an `axes' argument.  The following trivial
patch does that ... pls apply.

-k

*** src/library/base/funs/barplot.orig	Sat Aug  2 15:58:44 1997
--- src/library/base/funs/barplot	Sat Aug  2 16:00:22 1997
***************
*** 1,7 ****
  "barplot" <-
  function (height, names.arg, col=NULL, border=par("fg"),
  	beside=FALSE, space=0.2, legend.text,
! 	main=NULL, xlab=NULL, ylab=NULL, xlim, ylim, ...)
  {
  	opar <- par(yaxs="i", xpd=TRUE)
  	on.exit(par(opar))
--- 1,7 ----
  "barplot" <-
  function (height, names.arg, col=NULL, border=par("fg"),
  	beside=FALSE, space=0.2, legend.text,
! 	main=NULL, xlab=NULL, ylab=NULL, xlim, ylim, axes = TRUE, ...)
  {
  	opar <- par(yaxs="i", xpd=TRUE)
  	on.exit(par(opar))
*************** function (height, names.arg, col=NULL, b
*** 68,72 ****
  			xjust=1, yjust=1)
  	}
  	title(main=main, xlab=xlab, ylab=ylab, ...)
! 	axis(2)
  }
--- 68,73 ----
  			xjust=1, yjust=1)
  	}
  	title(main=main, xlab=xlab, ylab=ylab, ...)
! 	if (axes)
! 		axis(2)
  }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: sd2rd version 0.1-5
Message-ID: <199708041115.NAA21212@aragorn.ci.tuwien.ac.at>

Oops,
Just found a typo.  Here's the updated version.
-k

***********************************************************************
#!/usr/bin/perl

$VERSION = "0.1-5";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &section(0, "SECTION(Side Effects @@"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &section(0, "SECTION($word[1] @@");
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par))) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: ???
Message-ID: <199708041115.NAA21213@aragorn.ci.tuwien.ac.at>

Is there any reason why the third argument to text() is called `text' in
R versus `labels' in S (I mean, other than that it makes more sense)?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: scale()
Message-ID: <199708041115.NAA21211@aragorn.ci.tuwien.ac.at>

Here is a version of the function scale() which may be worth adding to
the distribution.  No NA's yet, though.  And yes, I could also write
documentation if necessary ...

-k

***********************************************************************
scale <- function(x, center = TRUE, scale = TRUE) {
  x <- as.matrix(x)
  nc <- ncol(x)
  if (is.logical(center)) {
    if (center)
      x <- sweep(x, 2, apply(x, 2, mean))
  }
  else if (is.numeric(center) && (length(center) == nc))
    x <- sweep(x, 2, center)
  else
    stop("Length of center must equal the number of columns of x")
  if (is.logical(scale)) {
    if (scale)
      x <- sweep(x, 2, apply(x, 2, function (v)
			     sum(v^2) / max(1, length(v) - 1)), "/")
  }
  else if (is.numeric(scale) && length(scale) == nc)
    x <- sweep(x, 2, scale, "/")
  else
    stop("Length of scale must equal the number of columns of x")
  x
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: ports ...
Message-ID: <199708041115.NAA21209@aragorn.ci.tuwien.ac.at>

Just wanted to mention that I've more or less successfully completed
ports of the V&R library `class' (I hope I can also have lda and qda in
there soon) and the library `clus' by Anja Struyf, Mia Hubert, and Peter
J. Rousseeuw provided via the Journal of Statistical Software, volume 1.
For `clus', the plots needed to be rotated because R barplot does not
support the `horiz' argument yet (and having `scale' work as in S would
also be nice)

I've added the current versions into my r-contrib Debian package, and
will officially release them after 0.50 is out.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:35:42 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:35:42 +0200
Subject: R-alpha: Re: your mail
In-Reply-To: <Pine.LNX.3.96.970802190706.1843A-100000@buffy>
References: <199708011340.PAA20453@aragorn.ci.tuwien.ac.at>
 <Pine.LNX.3.96.970802190706.1843A-100000@buffy>
Message-ID: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Fri, 1 Aug 1997, Kurt Hornik wrote:
>> Thomas,
>> 
>> Could you add the "-lf2c" at the end of the line
>> @$(LD) $(SHLIBLDFLAGS) -o $(LIBNAME).so $(OBJS)
>> in acepack's src-c/Makefile?
>> 
>> I ran across an identical pow_dd problem recently with another package.
>> Did we always need the "-lf2c", or is this a feature of the new version?
>> 

> This is very strange.  My copy works ok as is, in all the versions of
> R I have installed (including 0.50a1). On the other hand, using nm
> reveals that R0.50 has replaced pow_dd and pow_di by f77_pow_dd and
> f77_pow_di respectively.  It looks like the builtin subset of libf2c
> has vanished.  This is a problem, as we should not require people to
> have f2c in order to run the C version of the library -- after all, if
> they had f2c they could run the FORTRAN version.

You're right, see also one of my previous mails.  They now have POW_DD
and f77_pow_dd (where does this come from, anyway).  I think that in the
``old days'' we were lucky that everything was based on C, so FORTRAN
was converted using f2c and compatibility functions were provided by the
distribution proper.  Of course, in general one cannot expect that ALL
functions needed after using f2c would be in a compatibility library,
unless it was identical to libf2c ...

But clearly, pow_dd and pow_di should exist again ...

> I'll also do the version numbers.  I should probably regenerate all
> the help files, and there may also be more changes to survival4 now
> that array subsetting works properly.  Unfortunately the test file now
> doesn't work, as R batch mode terminates on errors, and the file stops
> at the first unimplemented feature.

O.k., no problem.  As long as there are packages maintained by me
without version numbers ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:02:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:02:08 +0200
Subject: R-alpha: scale()
In-Reply-To: <199708041115.NAA21211@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 4 Aug 1997 13:15:54 +0200)
Message-ID: <199708041302.PAA28454@sophie.ethz.ch>

Lieber Kurt,

vielen Dank f=FCr Deine neuen  R Funktionen,...
Ja, die scheinen n=FCtzlich.

Was Du vergessen (oder extra nicht gesagt) hast:

=09Die Funktionen existieren in S(-plus).

Ich wuerde dies doch erw=E4hnen in Deinen 'Posts' als Motivation, wieso
=FCberhaupt...

Und, ideal w=E4re schon, gerade ein shar-file zu bekommen, welches in
in RHOME  oder  RHOME/src/library/base
ausgepackt w=FCrde, und sowohl   funs/FOO  als auch  man/FOO  enthielte,
das 'man' inklusive EXAMPLES(.)...

  [dann k=F6nnte auch ich die Funktionen in den Source tree installieren...=
]

--
Martin=
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:10:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:10:50 +0200
Subject: R-alpha: Re: pow_dd & pow_di [was f2clib.c  etc..] --  yes, please !
In-Reply-To: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 4 Aug 1997 13:35:42 +0200)
Message-ID: <199708041310.PAA28457@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Thomas Lumley writes:
    >> On Fri, 1 Aug 1997, Kurt Hornik wrote:
    >>> Thomas,
    >>> 
    >>> Could you add the "-lf2c" at the end of the line @$(LD)
    >>> $(SHLIBLDFLAGS) -o $(LIBNAME).so $(OBJS) in acepack's
    >>> src-c/Makefile?
    >>> 
    >>> I ran across an identical pow_dd problem recently with another
    >>> package.  Did we always need the "-lf2c", or is this a feature of
    >>> the new version?
    >>> 

    >> This is very strange.  My copy works ok as is, in all the versions
    >> of R I have installed (including 0.50a1). On the other hand, using
    >> nm reveals that R0.50 has replaced pow_dd and pow_di by f77_pow_dd
    >> and f77_pow_di respectively.  It looks like the builtin subset of
    >> libf2c has vanished.  This is a problem, as we should not require
    >> people to have f2c in order to run the C version of the library --
    >> after all, if they had f2c they could run the FORTRAN version.
yep
    Kurt> You're right, see also one of my previous mails.  They now have
    Kurt> POW_DD and f77_pow_dd (where does this come from, anyway).  I
    Kurt> think that in the ``old days'' we were lucky that everything was
    Kurt> based on C, so FORTRAN was converted using f2c and compatibility
    Kurt> functions were provided by the distribution proper.  Of course,
    Kurt> in general one cannot expect that ALL functions needed after
    Kurt> using f2c would be in a compatibility library, unless it was
    Kurt> identical to libf2c ...

    Kurt> But clearly, pow_dd and pow_di should exist again ...

Even more: I think it's just these two which should 
	'officially' part of the R binary, i.e., their sourc should be in
	src/main/  or src/math/  rather than in appl  or somewhere.

I think there are several instances in the current  R source tree, where
the code could be improved by using  pow_d{d|i}(..).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug  4 14:13:03 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Aug 1997 15:13:03 +0200
Subject: R-alpha: scale()
In-Reply-To: Martin Maechler's message of Mon, 4 Aug 1997 15:02:08 +0200
References: <199708041302.PAA28454@sophie.ethz.ch>
Message-ID: <x2n2my2isg.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Lieber Kurt,
> 
> vielen Dank für Deine neuen  R Funktionen,...
> Ja, die scheinen nützlich.
> 
> Was Du vergessen (oder extra nicht gesagt) hast:
...

- und was Du vergisst ist dein CC:-header zu redigieren.... 

§;^{)>

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:15:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:15:34 +0200
Subject: R-alpha: Excuse the German post to R-devel...
Message-ID: <199708041315.PAA28466@sophie.ethz.ch>

it was intented to just go to Kurt..

Excuse again...	Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 17:15:49 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 18:15:49 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708041615.SAA28741@sophie.ethz.ch>

I am sorry that this IS an old topic.
Yet another task
I think the bug is somewhere in hidden  in  src/main/options.c ..

##-- The following does not work as it should in  R (0.50-a1, but I think
							also earlier)

tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
tst()
tst(dig = 12)


##-- This should do the same; it works as expected in R & S :

tst2 <- function(x=pi, dig =3) {
  oo <- options(digits=dig); on.exit(oo); print(x);x}
tst2()
tst2(dig = 12)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug  4 18:36:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Aug 1997 19:36:24 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: Martin Maechler's message of Mon, 4 Aug 1997 18:15:49 +0200
References: <199708041615.SAA28741@sophie.ethz.ch>
Message-ID: <x2g1spq293.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> I am sorry that this IS an old topic.
> Yet another task
> I think the bug is somewhere in hidden  in  src/main/options.c ..
> 
> ##-- The following does not work as it should in  R (0.50-a1, but I think
> 							also earlier)
> 
> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
> tst()
> tst(dig = 12)
> 
> 
> ##-- This should do the same; it works as expected in R & S :
> 
> tst2 <- function(x=pi, dig =3) {
>   oo <- options(digits=dig); on.exit(oo); print(x);x}
                               ^^^^^^^^^^^
                           on.exit(options(oo))

> tst2()
> tst2(dig = 12)

I'm not sure this is a bug at all, given the scoping rules, etc.
However, things are strange. Consider the following:

> f<-function(){print(a$b);a$b<-pi;print(a$b)}
> f()
[1] 2
[1] 2
> f<-function(){print(a$b);a<-a;a$b<-pi;print(a$b)}
> f()
[1] 2
[1] 3.141593

The difference is that in the first case, a is in .GlobalEnv, and not
modifiable with "<-" ("<<-" works). Apparently, "$<-" won't
automatically create a copy of a in the current environment which is
what I had expected. Still, creating .Options explicitly in tst()
doesn't work, which fact is probably due to the digits argument in
print.default defaulting to NULL, and print.default has no reason to
look on the frame stack for .Options.

However, changing the print.default definition to

print.default<-function (x, digits = eval(expression(.Options$digits),
sys.frame(sys.parent())), quote = TRUE, na.print = NULL, print.gap = NULL) 
{
        .Internal(print.default(x, digits, quote, na.print, print.gap))
}

*and*

tst<-function (x = pi, dig = 3) 
{
        .Options <- .Options
        .Options$digits <- as.integer(dig)
        print(x)
        x
}


does seem to do what you wanted...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug  4 23:12:38 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 10:12:38 +1200 (NZST)
Subject: R-alpha: pow_dd
In-Reply-To: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>
References: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>
Message-ID: <199708042212.KAA12791@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > Hmm ... It seems that as of 0.50.a1 we need to link against f2c because
 > pow_dd is no longer provided (internally, POW_DD is used).  I am not
 > sure how much sense that really makes, but it would seem that getting
 > the things from 0.49 f2clib.c back would be great ...

I was worried about name conflicts with systems which do not follow
the f77/f2c standard.  I will put these back the old way and make it
possible to #define NONSTANDARD_F77LIBS or somesuch to get the new
effect if it is needed.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug  4 23:34:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 10:34:14 +1200 (NZST)
Subject: R-alpha: Re: pow_dd & pow_di [was f2clib.c  etc..] --  yes, please !
In-Reply-To: <199708041310.PAA28457@sophie.ethz.ch>
References: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at>
 <199708041310.PAA28457@sophie.ethz.ch>
Message-ID: <199708042234.KAA14790@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
 > Even more: I think it's just these two which should 
 > 	'officially' part of the R binary, i.e., their sourc should be in
 > 	src/main/  or src/math/  rather than in appl  or somewhere.
 > 
 > I think there are several instances in the current  R source tree, where
 > the code could be improved by using  pow_d{d|i}(..).

I think that there are two problems here.

 1. Providing support for functionality in the R core (all C code).

 2. Supporting code in external libraries (mainly f77).

I think it might be useful to keep these problems separate.

We can certainly put in support for a wider range of "pow" functions
and any other math functions.  Putting these in the "math" library
seems natural.

One possible solution to the second problem would be to declare that R
will work with f2c generated code and anything compatible with it.
This is pretty extreme though.  On more exotic platforms it would be
nice to use custom blas etc.

Better dyn.load support is on the way (complements of GNU dld 4) and
this may well solve problem 2 above.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug  5 01:20:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 4 Aug 1997 17:20:18 -0700 (PDT)
Subject: R-alpha: f2c compatibility
In-Reply-To: <199708042234.KAA14790@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970804171330.10278A-100000@chekov>

On Tue, 5 Aug 1997, Ross Ihaka wrote:
> I think that there are two problems here.
> 
>  1. Providing support for functionality in the R core (all C code).
> 
>  2. Supporting code in external libraries (mainly f77).
> 
> I think it might be useful to keep these problems separate.
> 

I agree. I don't think it is necessarily a good idea for R to contain all
of libf2c that we might want to use.  My question was much simpler: 

Should we assume in creating libraries with C translations of FORTRAN that
ld -lf2c works, or should we explicitly include the C source for functions
that we call (as R does with pow_dd and pow_di)?


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Aug  5 06:00:03 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 17:00:03 +1200 (NZST)
Subject: R-alpha: Version 0.50-a1 patches
Message-ID: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>

A set of patches for R-0.50-a1 is now available as
	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
The patches mainly fix problems reported since R-0.50-a1 but some
older problems are also fixed.

Here is the list of changes.
	Ross

 o  Many subsetting and mutation problems with the new "expression" type
    have now been fixed.

 o  When ask=T is set in par() the user is instructed
	"Press <Return> for next plot:"
    rather than asked
	"Next Plot?"

 o  The infinite recursion observed by in Kurt Hornik in:
	R> test2
	function (x) 
	{
		attr(x, "call") <- sys.call()
		x
	}
	R> test2(x)
	Error: stack overflow
    has been cured.  There may be one or two more of these.  All the
    xxxx<- functions should be checked.

 o  Patches from Benjamin Bolker to cure some line type problems has
    been applied.

 o  Fixed the t(table(0)) problem (1-d arrays not quite handled right).

 o  Changed naming back so that pow_dd etc are available.

 o  Patches to barplot and text from Kurt Hornik.

 o  When x was a data frame,
	mode(x) <- "character"
	x
    caused a crash.  This was because a class of "data.frame"
    was being attached to a character vector.  Now only lists
    can become data frames.

 o  There is now a -gdb option to the R front end as well as -xxgdb.

 o  Documentation of NChisquare fixed.

 o  Definition of S_alloc fixed.

 o  Changed the names of seeds_in and seeds_out to seed_in and
    seed_out as per Kurt's request.

 o  "unlist(c(2))" fixed.

 o  "data.frame(x=2)" fixed.

 o  Bug in do_title fixed.

 o  Scoping for subset methods by forcing an eval of the args on
    entry fixed (bug reported by Patric Lindsay).

 o  subsetting of data frames fixed .

 o  Misc problems in Rdoc.sty reported by Kurt Hornik fixed.
 
 o  Permissions in the data subdir for quakes and sunspots fixed.

 o  Segfault in dimnames mutation
	R> x <- 1:5
	R> dimnames(x)[1,2] <- NULL
    fixed.

 o  It was observed that
	> D(expression(z * (log(z) /z)), "z")
    returns
	(log(z)/z) + z * (1/z/z - log(z)/z^2)
    This is exactly what S-Pus produces.

 o  Added the option -B 8192 to m4 in the etc/doc2* files to keep
    m4 happy.

 o  New functions "as.ordered", "data.class" and "scale" from, Kurt
    Hornik added.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug  5 10:55:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Aug 1997 11:55:58 +0200
Subject: R-alpha: Version 0.50-a1 patches
In-Reply-To: Ross Ihaka's message of Tue, 5 Aug 1997 17:00:03 +1200 (NZST)
References: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
Message-ID: <x2sowp3qdt.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> A set of patches for R-0.50-a1 is now available as
> 	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
> The patches mainly fix problems reported since R-0.50-a1 but some
> older problems are also fixed.
..
>  o  It was observed that
> 	> D(expression(z * (log(z) /z)), "z")
>     returns
> 	(log(z)/z) + z * (1/z/z - log(z)/z^2)
>     This is exactly what S-Pus produces.

Heyheyheyheeeyyy, no need to resort to name calling, next thing,
you'll be talking about Windoze, HP-SUX, and Slowlaris! ;)

>  o  New functions "as.ordered", "data.class" and "scale" from, Kurt
>     Hornik added.
[The end]

Hmm. The "move .RData before writing to it" fix didn't seem to make
it. It's a one-liner (in the most primitive version), and really quite
important. Actually, the problem is worse than I thought initially:
.RData can get zapped to a zero-length file whenever you destroy the
xterm window containing R, not only on system shutdown. This happens
on both of my Linux boxes, but it's probably a quite generic race
condition.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 11:44:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 12:44:48 +0200
Subject: R-alpha: Version 0.50-a1 patches -- New and old bugs..
In-Reply-To: <199708050500.RAA08160@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 5 Aug 1997 17:00:03 +1200 (NZST))
Message-ID: <199708051044.MAA00635@sophie.ethz.ch>

Thank you !
~~~~~~~~~~~

The new patches
	 (which incidentally make  0.50-a1 into  0.50-a2
	  IF you run ./configure)
really do quite a few good things.

A few comments.

1) I had to do the following to make things compile and link properly

   in	appl/cpoly.c :  line  42 : OUT-commented  (pow_di) 
   otherwise compiler barfed about redefined  pow_di	[Solaris 2.5, Sun cc]

2) In order for 'legend' and 'barplot' to work I had to edit
	src/library/base/funs/legend: 
   Last line: replace 'text=' by 'labels='  [reflect change of text(...)]

NOTE: After applying the patch, I recommend the following

    make clean
    configure
    make
    make install
    make tests install-latex install-help install-html

---------------------
Further notes:

3) Whereas  unlist(1), unlist(c(2)), etc. work,
   the two unlist problems that Kurt reported about,
   especially

    l.ex <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
    unlist(l.ex) #-- still in 0.50-a2
    ##- INTERNAL ERROR: ans_nnames = 10    ans_length = 12
    ##- Error: incorrect names vector length

 still exist. {Nobody claimed otherwise}


4) The parser problem reported by Patrick Lindsey remains :

  ##- From: Patrick Lindsey <plindsey@luc.ac.be>
  ##- Date: Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
  ##- To: r-devel@stat.math.ethz.ch (R list)
  ##- Subject: R-alpha: Bugs in R-0.50-a1.
  ##-
  ##- Problems in R but not in S:
  ##- ---------------------------

  ##- 2) Problem with the parser: When a function contains a condition
  ##- between brackets the closing bracket must be adjacent to the last item
  ##- in R but not in S. Here is an example:
  ##- 	S> new <- function (x,y,z,k) {
  ##- 	S+ message <- list(x,y,a=if(z) k
  ##- 	S+ )
  ##- 	S+ message
  ##- 	S+ }
  ##- 	S>
  ##- 	---
  ##- 	R> new <- function (x,y,z,k) {
  ##- 	R+ message <- list(x,y,a=if(z) k
  ##- 	R+ )
  ##- 	)
  ##- 	^
  ##- 	Error: syntax error
  ##- 	R>
  ##- This occurs in R-0.49 and in R-0.50-a1, R-0.50-a2

  new <- function (x,y,z,k) {
    message <- list(x,y, a=if(z) k
		    )
  }

---------------------------------------------------------------------------
I think I found one  NEW bug  (a1 -> a2):
		     =======
  	options(digits = ...) fails to work AT ALL in a 'local environment'

which makes even my  tst2()  function 'fail' :
  

 p0 <- (0:2)/1000 ; p <- p0 + 1e-10
 p
 ## Fails in 0.50-a2, (NOT in 0.50-a1, I think):
 for(d in 1:20) { options(digits=d); cat(d,": ", p,";\t",p0, "  ");print(p)}
 options(digits=7)
 ## Now,the print(.) at least works:
 for(d in 1:20) { options(digits=d); cat(d,": ", p,";",p0, "  ");print(p,dig=d)}

 ##-- The following does not work as it should in  R (0.50-a1, maybe earlier)
 tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
 tst()
 tst(dig = 12)
 ##-- This should do the same; works as expected in S & R-0.50-a1, NOT in -a2:
 tst2 <- function(x=pi, dig =3) {
   oo <- options(digits=dig); on.exit(options(oo)); print(x);x}
 tst2()
 tst2(dig = 12)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 14:02:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 15:02:11 +0200
Subject: R-alpha: R-0.50-a{1|2} : Yet another shortest SEGFAULT  --- + PATCH
Message-ID: <199708051302.PAA00761@sophie.ethz.ch>

[ already in 0.50-a1 ]

is.loaded(1) gives a SEGFAULT.

----------------------------------------
Here is the patch :


--- src/main/dotcode.c~	Thu Jun  5 03:07:00 1997
+++ src/main/dotcode.c	Tue Aug  5 14:57:15 1997
@@ -434,7 +434,7 @@
 
 	checkArity(op, args);
 	if(!isString(CAR(args)) || length(CAR(args)) < 1)
-		errorcall(call, "invalid argument");
+		errorcall(call, "invalid argument\n");
 
 	p = CHAR(STRING(CAR(args))[0]);
 	q = buf;
@@ -459,6 +459,8 @@
 	char *sym;
 	int val;
 	checkArity(op, args);
+	if(!isString(CAR(args)) || length(CAR(args)) < 1)
+		errorcall(call, "invalid argument\n");
 	sym = CHAR(STRING(CAR(args))[0]);
 
 	val = 1;
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug  5 14:14:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 5 Aug 1997 15:14:32 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: <x2204gg2mf.fsf@bush.kubism.ku.dk>
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
 <x2204gg2mf.fsf@bush.kubism.ku.dk>
Message-ID: <199708051314.PAA22117@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> Ross and I have been back and forth on this one a few times already;
>> it's probably a faq (Kurt);
>                 ^^^^^

> This belongs on the *manual page*. I suggest something along these
> lines:

> NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
> get values of LANG(x) and LANG(y) looked up in the environment
> LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
> LANG(expr) is usually a simple variable ITALIC(containing) an
> expression to evaluate or a LANG(substitute(...)) call
> ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
> passed to the evaluator.
> )

Perhaps as a compromise, we could put something like the above into the
man page, AND I'll add something in the FAQ?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug  5 14:40:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Aug 1997 15:40:40 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: Kurt Hornik's message of Tue, 5 Aug 1997 15:14:32 +0200
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
 <x2204gg2mf.fsf@bush.kubism.ku.dk>
 <199708051314.PAA22117@aragorn.ci.tuwien.ac.at>
Message-ID: <x2n2mw4ujr.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Peter Dalgaard BSA writes:
> 
> > Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
> >> Ross and I have been back and forth on this one a few times already;
> >> it's probably a faq (Kurt);
> >                 ^^^^^
> 
> > This belongs on the *manual page*. I suggest something along these
> > lines:
> 
...
> 
> Perhaps as a compromise, we could put something like the above into the
> man page, AND I'll add something in the FAQ?

Certainly. A "Fine points" section in the FAQ would be very nice
indeed. It could contain several items of the "looks wrong, but isn't"
variety as well as "debatable, but it was done this way, because..."
and "bug compatible with S-Plus". 

On the other hand, the FAQ might not be the preferred document for
online help during programming, whereas the manpages would typically
be the first place to look. Therefore, it is a very good idea to put a
terse description of any counterintuitive behaviour on the man page. 

One could probably argue that the man page addition that I suggested
is a bit on the verbose side. "That won't work, do this instead"
should suffice on the man page, whereas a fuller explanation could go
in the FAQ.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 15:22:24 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 16:22:24 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: <x2n2mw4ujr.fsf@bush.kubism.ku.dk> (message from Peter Dalgaard
 BSA on 05 Aug 1997 15:40:40 +0200)
Message-ID: <199708051422.QAA18877@sophie.ethz.ch>

If you look at the new  'eval' man page that comes with the  a1-->a2
patches, you see that R or R has added a paragraph that somewhat resembles
your proposal.

PD> This belongs on the *manual page*. I suggest something along these
PD> lines:

PD> NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
PD> get values of LANG(x) and LANG(y) looked up in the environment
PD> LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
PD> LANG(expr) is usually a simple variable ITALIC(containing) an
PD> expression to evaluate or a LANG(substitute(...)) call
PD> ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
PD> passed to the evaluator.
PD> )

They don't use any pejorative words such as "counterintuitive" though... ;-)

help(eval)>  The expression expr is evaluated in the environment
help(eval)>  that eval is called from. This allows you to assign
help(eval)>  complicated expressions to symbols and then evaluate
help(eval)>  them. If you want to evaluate expr in envir then you
help(eval)>  must wrap a call to expression around it.
	
  and later

help(eval)> 	Examples:

	     ....

help(eval)> 	     tst.ev <- function(a = 7) { x <- pi; y <- 1; ev() }
help(eval)> 	     ev <- function() {
help(eval)> 	          e1 <- sys.frame(sys.parent())
help(eval)> 	          ## Evaluate a in e1
help(eval)> 	          aa <- eval(expression(a),e1)
help(eval)> 	          ## evaluate the expression bound to a in e1
help(eval)> 	          a <- expression(x+y)
help(eval)> 	          list(aa = aa, eval = eval(a, e1))
help(eval)> 	     }
help(eval)> 	     tst.ev()#-> aa : 7,  eval : 4.14
	
	[R&R: The example was improved by me:  
	      ALL examples should be self-contained executable !]

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Tue Aug  5 21:28:49 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 6 Aug 1997 08:28:49 +1200 (NZST)
Subject: R-alpha: Environment strangeness
Message-ID: <199708052028.IAA20017@stat1.stat.auckland.ac.nz>


I'd already adjusted the man pages before Peter's suggestion came along
and was too lazy/buzy to change it again. Most of the reason I suggested
the faq was that Ross and I really have changed this one back and forth
a lot; each time it seems like the change is the right thing to do. But
we're now convinced that this is correct. Putting it in writing in a few
places should hopefully make it easier to remember that it's correct.

We're having some real problems synchronizing work on bug reports and
will probably need to set up something more automatic. This is probably
going to involve a separate email address (or special subject) so we
can pull them out and put them in a list that everyone involved can
work off of that without duplication of fixes.


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:39 +0200
Subject: R-alpha: Version 0.50-a1 patches
In-Reply-To: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
References: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
Message-ID: <199708061106.NAA22856@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> A set of patches for R-0.50-a1 is now available as
> 	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
> The patches mainly fix problems reported since R-0.50-a1 but some
> older problems are also fixed.

> ...

>  o  New functions "as.ordered", "data.class" and "scale" from, Kurt
>     Hornik added.

Almost.  `scale' seems to be missing ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:38 +0200
Subject: R-alpha: R 0.50.a2
Message-ID: <199708061106.NAA22853@aragorn.ci.tuwien.ac.at>

Here's a trivial patch (Martin!).
-k

--- src/library/base/man/Arithmetic.orig	Tue Aug  5 22:33:16 1997
+++ src/library/base/man/Arithmetic	Tue Aug  5 22:35:51 1997
@@ -15,6 +15,7 @@
 ALIAS(^)
 ALIAS(%%)
 ALIAS(%/%)
+ALIAS(Arithmetic)
 VALUE(
 These binary operators perform arithmetic on vector objects.
 They return numeric vectors containing the result of the element
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:39 +0200
Subject: R-alpha: R color problem
Message-ID: <199708061106.NAA22855@aragorn.ci.tuwien.ac.at>

There seems to be a small problem with the S-compatible small numbers
color specification, colors 0 and 2 are the same.

Have a look at e.g.
	barplot(rbind(1:3, 1), col = c(0,2))

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:38 +0200
Subject: R-alpha: R 0.50.a2 shortest segfault ...
Message-ID: <199708061106.NAA22854@aragorn.ci.tuwien.ac.at>

This time, it seems that
	browser()
wins.  Grr ...
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug  6 14:04:59 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 06 Aug 1997 15:04:59 +0200
Subject: R-alpha: R 0.50.a2 shortest segfault ...
In-Reply-To: Kurt Hornik's message of Wed, 6 Aug 1997 13:06:38 +0200
References: <199708061106.NAA22854@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb6fa2dg.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> This time, it seems that
> 	browser()
> wins.  Grr ...

On a related note, other bottom-level things act strangely:

> sys.parent()
Error: failed to match environments
> sys.nframe()
Error: failed to match environments
> sys.frame(0)
Error: failed to match environments

The 1st might make sense (I'd prefer it to return NULL whenever n is
bigger than the stack height, rather than error out), but the 2nd
should return 0 and the 3rd the R_GlobalEnv as it does on any other
levels.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug  6 14:16:11 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 06 Aug 1997 15:16:11 +0200
Subject: R-alpha: Re: R 0.50.a2 - unlist() still broken
In-Reply-To: Kurt Hornik's message of Wed, 6 Aug 1997 13:06:38 +0200
References: <199708061106.NAA22853@aragorn.ci.tuwien.ac.at>
Message-ID: <x2wwlza1us.fsf@bush.kubism.ku.dk>


You still can't unlist() a regression object:

x<-rnorm(3)
y<-rnorm(3)+x
o<-lm(y~x)
unlist(o)
ou<-unclass(o)
ou
unlist(ou)

Part of the explanation seems to be contained in

unlist(list(1,2,3,4))
unlist(list(1,2,3,4,"a"))
unlist(list(1,2,3,4,x~y))

and also in

unlist(list(x~y))



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug  6 14:54:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 Aug 1997 15:54:56 +0200
Subject: R-alpha: R color problem  (col=0 is wrong; col=1 S incompatible)
In-Reply-To: <199708061106.NAA22855@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 6 Aug 1997 13:06:39 +0200)
Message-ID: <199708061354.PAA01946@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> There seems to be a small problem with the S-compatible small
    Kurt> numbers color specification, colors 0 and 2 are the same.

    Kurt> Have a look at e.g.  barplot(rbind(1:3, 1), col = c(0,2))

I had reported this problem  even more extensively in R-help (not R-devel),
since I thought it important to be known by everyone:

Here is the relevant part (in R-help, I went further with a wish...):

MM> Date: Mon, 14 Jul 1997 15:07:19 +0200
MM> From: Martin Maechler <maechler@stat.math.ethz.ch>
MM> To: R-help@stat.math.ethz.ch
MM> Subject: R-beta: Plotting: numeric 'col' colors;  col=0, col=1, ..

MM> ``We all know''
MM>  that R has more flexible and nicer color specifications than S-plus.

MM> There are situations however, where I'd like to specify colors numerically,
MM> e.g.
MM> 	1) convenience of using different colors in a for(.) loop
MM>  or
MM> 	2) backward compatibility with S.
MM> 
MM> In S, there's the quite known  ``standard''
MM> 
MM> 	col = 0  :<==>   current background color	[ = white by default]
MM> 	col = 1  :<==>   current foreground color, ie. default color. [ = black]
MM> 
MM> In R, this is currently different:
MM> 
MM> col = 0 is the same as  col = 2  
MM> 	which maybe rather an accident than anything else.
MM> col = 1 however takes a different color than the current foreground
MM> 	-- which can be NICE  in certain situations, where we'd rather have
MM> 	   points / lines  in a different color than the default foreground
MM> 	On the other hand, I think  "S compatibility" is more important here.
MM> 
MM> I assume that it's not too hard to change the 
MM> ``numeric color'' map such as to get S compatibility.

Yes, I still think it would be nice if this was changed...

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug  6 17:41:37 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 6 Aug 1997 09:41:37 -0700 (PDT)
Subject: R-alpha: browser()
In-Reply-To: <199708060311.PAA14297@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970806093214.2623A-100000@zen>


Kurt pointed out that
R> browser() 
is now the shortest segfault.  The problem is in do_browser in main.c at
about line 420:
       if( !DEBUG(rho) ) {
                cptr=R_GlobalContext;
                while (cptr->callflag != CTXT_RETURN) 
                        cptr = cptr->nextcontext;
                Rprintf("Called from: ");
                PrintValueRec(cptr->call);
        }
When browser() is called from the top level rather than from a function we
have cptr->callflag==CTXT_TOPLEVEL, so the test succeeds, but as there are
no other contexts we have cptr->nextcontext==NULL and a segfault.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Aug  6 21:59:51 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 6 Aug 1997 15:59:51 -0500 (CDT)
Subject: R-alpha: Re: R-beta: ?faq example of scoping
In-Reply-To: <199708062021.IAA21936@stat1.stat.auckland.ac.nz> from "Robert Gentleman" at Aug 7, 97 08:21:01 am
Message-ID: <9708062059.AA08076@nokomis.stat.umn.edu>

Robert Gentleman wrote:
> 
>  I like Thomas' example. Kurt can you include it in the FAQ. 
>  
>  Recently I have been doing a lot of programming that has required either
>  optimization or zero-finding. Unfortunately most of the functions need
>  some arguments to be optimized over and have other parameters that depend on
>  the data but are fixed with respect to optimization. With R scoping rules
>  this is a trivial problem; simply make up the function with the required
>  definitions in the same environment and scoping takes care of it. With
>  Splus my solution has been to add an extra parameter to the function and
>  to the optimizer to pass in these extras. That's fine for optimizers I 
>  write myself but it doesn't work for the builtin ones. Fortunately I haven't
>  yet found a one-d problem that some thought and bisection won't take care
>  of.
>  
>  robert
>  

There might also be some use for a clean dynamic scoping mechanism to
to make it easier to make things like the minimizers in optimize.c
reentrant.  In 0.49 at least they use a static variable, and I think
things would go bad if they were called recursively. THis may not be
likely for a minimizer, but it would be very reasonable for an
integrator. You could save previous values of the globals on the C
stack, but with the need to provide protection for non-local exits on
errors this can get messy. A dynamic binding mechanism, preferably
with a separate name space like dynamic-bind stuff in Scheme, would
make this easier.

luke




-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug  7 05:42:21 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 7 Aug 1997 16:42:21 +1200 (NZST)
Subject: R-alpha: Colors
Message-ID: <199708070442.QAA10907@stat1.stat.auckland.ac.nz>

Here is a proposal:

At present when you specify a color with an integer it is taken as an
index into a fixed table of 8 colors.

	1=red, 2=green, 3=blue, 4=cyan,
	5=magenta, 6=yellow, 7=white, 8=black

[At least this is the intention, there may be bugs in the
implementation].  Since I am looking at this anyway (to see if I can
see the bug that Martin and Kurt have mentioned) I thought I might
make a larger change.

I would like to make the color table, user definable.  To do this
there needs to be a function

	palette(name, value)

where "name" could be used to select one on a number of standard
built-in palettes (e.g. "default", "heat", "terrain", "pastels" etc)
and (if name was not specified, "value" could be a character vector of
color specifications (of length less than or equal to 256?).  Either
names (e.g. "red", "lightblue" ...)  or by rgb values (e.g "#FF00FF")
could be used in the vector.

The function palette would return the previous palette, and
	palette()
could be used to obtain the current settings without a change.

After a call to palette integer col= specification would provide
indexes into this table.

col=0 could be used to indicate the current background color.

The "default" palette would have 1=black.

Any comments?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug  7 09:37:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 Aug 1997 10:37:12 +0200
Subject: R-alpha: Colors -- Comment: yes, great !!
In-Reply-To: <199708070442.QAA10907@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Thu, 7 Aug 1997 16:42:21 +1200 (NZST))
Message-ID: <199708070837.KAA02747@sophie>

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> Here is a proposal: At present when you specify a color with an
    Ross> integer it is taken as an index into a fixed table of 8 colors.
     
    Ross>    ....

    Ross> I would like to make the color table, user definable.  To do this
    Ross> there needs to be a function

    Ross> 	palette(name, value)

    Ross> where "name" could be used to select one on a number of standard
    Ross> built-in palettes (e.g. "default", "heat", "terrain", "pastels"
    Ross> etc) and (if name was not specified, "value" could be a character
    Ross> vector of color specifications (of length less than or equal to
    Ross> 256?).  Either names (e.g. "red", "lightblue" ...)  or by rgb
    Ross> values (e.g "#FF00FF") could be used in the vector.

You could even do with one argument -- collapsing  name & value.
	character(1) -> 'name'
	character(> 1) -> 'value'

But this may be just about the S practice 
which has been in use in functions like  diag(..) and
seems to confusing people..


    Ross> The function palette would return the previous palette, and
    Ross> palette() could be used to obtain the current settings without a
    Ross> change.

    Ross> After a call to palette integer col= specification would provide
    Ross> indexes into this table.

This sounds really great!
Just about what I may have dreamed when I sent my e-mail
a few weeks ago :-)



    Ross> col=0 could be used to indicate the current background color.
Yes, please

    Ross> The "default" palette would have 1=black.
Ok.
    Ross> Any comments?  Ross

Yes: Sounds great!
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug  7 17:49:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 7 Aug 1997 09:49:20 -0700 (PDT)
Subject: R-alpha: expressions in graphs
In-Reply-To: <199708060311.PAA14297@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970807094715.3948D-100000@zen>


The expression parser for graph labels is wonderful.  Two comments.

1. save.plot and print.plot don't quite work -- they don't allow enough
space for text included in expressions.

2. Can we have = and sqrt() added to the wish list?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug  7 19:17:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Aug 1997 20:17:54 +0200
Subject: R-alpha: expressions in graphs
In-Reply-To: Thomas Lumley's message of Thu, 7 Aug 1997 09:49:20 -0700 (PDT)
References: <Pine.SUN.3.95.970807094715.3948D-100000@zen>
Message-ID: <x267th3lik.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 2. Can we have = and sqrt() added to the wish list?

For "=" you'd need to type == (try expression(r=2) to see why). Not
that that works as of now...

Sqrt() shouldn't be much more difficult than bar(), should it? For now, 
V*bar(...) does a fairly decent impersonation.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug  7 21:12:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 8 Aug 1997 08:12:35 +1200 (NZST)
Subject: R-alpha: expressions in graphs
Message-ID: <199708072012.IAA16673@stat1.stat.auckland.ac.nz>

Thomas Lumley writes:

> The expression parser for graph labels is wonderful.  Two comments.

> 1. save.plot and print.plot don't quite work -- they don't
> allow enough space for text included in expressions.

This is because the X11 font metrics are used in conjunction with
PostScript fonts.  The mismatch doesn't show with the usual plot
labels, but it does look pretty bad with mathematics.

General help is on the way.  We are about to completely rewite the
lower levels of the graphics system to support multiple active devices
and rather more interactive graphics.  This will change the way that
print.plot and save.plot will work (they may disappear and be replaced
by menu selections in the graphics window).

> 2. Can we have = and sqrt() added to the wish list?

I think the functionality is there, its just called "root".  We will
change the name to "sqrt".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug  8 04:06:50 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 8 Aug 1997 15:06:50 +1200 (NZST)
Subject: R-alpha: Second patch for 0.50-a1
Message-ID: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>

A second patch for R-0.50-a1 is available from
	ftp://stat.auckland.ac.nz/pub/R
The patch produces the following changes

 o  cpoly problem with pow_di fixed.

 o  legend had a call to "text" with an incorrect argument tag.
    Changed "text" to "labels".

 o  The variable "dup" was uninitialised in the function "naoktrim" in
    src/main/dotcode.c.

 o  There have been some fixes to the color support code and there
    is now a function palette which allows a user to specify the
    palette to be used when the value of col= is numeric.

 o  Problems pointed out in "unlist" are fixed.

 o  A parsing problem for "if" statements in argument lists is fixed.

Enjoy
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 10:29:43 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 11:29:43 +0200
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails ..
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 8 Aug 1997 15:06:50 +1200 (NZST))
Message-ID: <199708080929.LAA03674@sophie.ethz.ch>

Thank you for these patches, especially the new color scheme!


``As always'' (;-)  
some remarks:

1)
 	     cut(rep(1,5),4)
>>>> Error: character variables must be duplicated in .C/.Fortran

  Which seems the old '*dup =0' problem, but is NOT (identical at least)
	  [Yes, I made sure that the above was applied dotcode.c]

  This seems only for  cut(...), not for 
	  approx(.),  spline(.) or lowess(.) 
  which also use .C(...).

  Further note that cut(.) had no problems in 0.50-Alpha-2 


2) I think that
	given the definition in	src/include/Fortran.h ,
	src/appl/cpoly.c  should rather use  POW_DI(.)  instead of  pow_di(.).

  It probably won't matter for most (all?) installations,
  since it only becomes important when

#ifdef NONSTANDARD_F77LIBS  
				is true


3) Important(IMHO) bugs [besides '1)' above] remaining:
	
	i.  browser()  ##	-> seg.fault

	ii. options(digits ..) still ``fails''
	    when used in non-global environments	(see my earlier posts)
	
--------
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 13:56:17 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 14:56:17 +0200
Subject: R-alpha:  unlist(..) forever..
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 8 Aug 1997 15:06:50 +1200 (NZST))
Message-ID: <199708081256.OAA03801@sophie.ethz.ch>

[[ R-0.50 Alpha-3  --- i.e. both patches applied to 0.50-a1 ]]

There are less problems, but I think two remain

1) Peter Dalgaard's example {which "includes"  Kurt's unlist(lm(..))}

> unlist(list(1,2,x~y))
[[1]]
[1] 1

[[2]]
NULL

[[3]]
NULL


2) [unreported yet:]

l.ex <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)

unlist(l.ex) #-- now 'okay' in 0.50-a3 !!

unlist(l.ex, recursive=FALSE) #-- --- recursive has no effect!
	     ##-------------   

which returns the same as the default recursive = TRUE

whereas S gives
S> unlist(list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA), rec = FALSE)
$a1:
[1] 1 2 3 4 5

$a2:
[1] "A" "B" "C" "D" "E"

$b:
[1] "Z"

$c:
[1] NA
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 16:15:10 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 17:15:10 +0200
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails .. -- PATCH (?!)
In-Reply-To: <199708080929.LAA03674@sophie.ethz.ch> (message from Martin
 Maechler on Fri, 8 Aug 1997 11:29:43 +0200)
Message-ID: <199708081515.RAA03936@sophie.ethz.ch>


It was not only  cut(.) but also  formatC(.)
whose .C(..) calls gave the
 >>>> Error: character variables must be duplicated in .C/.Fortran

Looking a bit at  src/main/dotcode.c
(and reading Ross' explanation that it was a "variable initialization problem")

I decided to 
REPLACE line 413  in src/main/dotcode.c
which (after the patch) reads
		*dup = 0;
by
		*dup = 1;
---
and yes, this seems to solve the problem.

'make tests' at least works and gives about the same as with  0.50 Alpha-2.

----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug  8 21:53:33 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 9 Aug 1997 08:53:33 +1200 (NZST)
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails .. -- PATCH (?!)
Message-ID: <199708082053.IAA03751@stat1.stat.auckland.ac.nz>

	From: Martin Maechler <maechler@stat.math.ethz.ch>

	Looking a bit at  src/main/dotcode.c
	(and reading Ross' explanation that it was a "variable
	initialization problem")

	I decided to 
	REPLACE line 413  in src/main/dotcode.c
	which (after the patch) reads
			*dup = 0;
	by
			*dup = 1;

Ooops!  Martin is right.  Make this change.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Sun Aug 10 23:57:58 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Mon, 11 Aug 1997 10:57:58 +1200 (NZST)
Subject: R-alpha:  unlist(..) forever..
Message-ID: <199708102257.KAA17769@stat1.stat.auckland.ac.nz>

Take about the bug from hell; well I'm sure that I'm not done with this
one yet but it should work a little better on the next patch.


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: R 0.50.a3:  adj?
Message-ID: <199708111336.PAA00438@aragorn.ci.tuwien.ac.at>

Not sure if I already reported this ... it seems that as of 0.50.a2, the
adj graphics parameter is completely ignored.  Try e.g.

	plot(1:10)
	title(main = "This is a title", adj = 0)
	title(main = "This is a title", adj = 1)

No difference ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: CFLAGS in config.site
Message-ID: <199708111336.PAA00442@aragorn.ci.tuwien.ac.at>

Could we change the default value of CFLAGS in config.site (back) to
"-O2 -g"?
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: R 0.50.a3 family.lm()
Message-ID: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>

The following patch adds a trivial family method for linear models.
-k

--- src/library/base/funs/lm.orig	Tue May 27 02:53:58 1997
+++ src/library/base/funs/lm	Sun Aug 10 22:00:46 1997
@@ -412,3 +412,5 @@
 }
 
 formula.lm<-function(x)formula(x$terms)
+
+family.lm <- function(x) { gaussian() }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3 problem with `make tests'
Message-ID: <199708111336.PAA00453@aragorn.ci.tuwien.ac.at>

Not really important, but ... `make tests' fails if a user's .Rprofile
asks for libraries which are not found by the binary in the compilation
tree (yes I know, we're here perhaps the only ones who use private
libraries ...).

Perhaps we should have options
	--no-site-file
	--no-init-file
which inhibit the loading of a global and a user's init file?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:09 +0200
Subject: R-alpha: R 0.50.a3  tapply patch
Message-ID: <199708111336.PAA00464@aragorn.ci.tuwien.ac.at>

Can we please apply the following patch?  It fixes the following problem
I already reported:

************************************************************************
There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
R> f
[1] a a b
R> codes(f)
[1] 1 1 2
R> levels(f)
[1] "a" "b" "c"

which gives e.g.

R> tapply(rep(1, length(f)), f, sum)
Error: names attribute must be the same length as the vector
************************************************************************

Thanks,
-k

--- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
+++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
@@ -14,7 +14,7 @@
 		index <- as.factor(INDEX[[i]])
 		if (length(index) != nx) 
 			stop("arguments must have same length")
-		namelist[[i]] <- levels(index)
+		namelist[[i]] <- unique(levels(index)[index])
 		extent[[i]] <- nlevels(index)
 		group <- group + ngroup * (codes(index) - 1)
 		ngroup <- ngroup * nlevels(index)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3:  patch for man/palette
Message-ID: <199708111336.PAA00456@aragorn.ci.tuwien.ac.at>

The following patch fixes an obvious problem with the man source for
palette().
-k

--- src/library/base/man/palette.orig	Sun Aug 10 17:50:11 1997
+++ src/library/base/man/palette	Sun Aug 10 18:49:14 1997
@@ -14,7 +14,7 @@
 a built in color palette.  If LANG(value) has length greater
 than 1 it is assumed to contain a description of the colors
 which are to make up the new palette (either by name or
-by RGB levels.
+by RGB levels).
 PARA
 If LANG(value) is omitted or has length 0, no change is made
 the current palette.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: frame tools
Message-ID: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>

Btw, what happened to Peter's frame tools?   Is there a new version?
Are there plans to include them in the distribution?
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3 minor remark
Message-ID: <199708111336.PAA00459@aragorn.ci.tuwien.ac.at>

Just a minor remark.  We now have

> args(ls)
function (name, pos = -1, envir = pos.to.env(pos), all.names = FALSE, 
        pattern) 

but

> pos.to.env(-1)
Error in pos.to.env(-1) : invalid argument

whereas

> pos.to.env(length(search()))
NULL


Perhaps pos.to.env should really return the corresponding environments,
just for sake of completeness ... or the fun of it.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:09 +0200
Subject: R-alpha: Second patch for 0.50-a1
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
References: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
Message-ID: <199708111336.PAA00462@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> A second patch for R-0.50-a1 is available from
> 	ftp://stat.auckland.ac.nz/pub/R
> The patch produces the following changes

> ...

scale() is still missing ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 11 15:42:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 11 Aug 1997 16:42:02 +0200
Subject: R-alpha: frame tools
In-Reply-To: Kurt Hornik's message of Mon, 11 Aug 1997 15:36:08 +0200
References: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>
Message-ID: <x2bu34eq85.fsf@biostat.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> Btw, what happened to Peter's frame tools?   Is there a new version?
> Are there plans to include them in the distribution?

In the cooler for the time being. I did a little poking around some
weeks ago, planning to change the syntax slightly so that there would
be two functions, accessed as generic methods:

subset.data.frame(fr,...,where)
transform.data.frame(fr,...)

e.g.,

subset(data,visit1:visit5,where=(treat=="placebo"))
transform(data,log.creatin=log(creatin))

I.e. subset now combines the old select.frame and subset.frame
mechanisms.

I also spent a litle while pondering whether the method for
substituting names in an object of mode "call" could be generalized
somehow, but decided that it was probably too difficult to get it
right.

Then the close-xterm bug zapped the .RData in the directory where I
had been experimenting... Actually, I hadn't done all that much,
mainly terminology cleanup, and what was lost should be easily
recreated.

What's really keeping me is that I've decided to try using R for our
course in basic statistics for medical researchers, so now I need to
focus on making sure things work that I absolutely *need*, and write
various tutorials and missing functions (anyone have logrank.test and
kaplan.meier.plot? Working with the Windows version, that is!).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 11 18:12:49 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 Aug 1997 10:12:49 -0700 (PDT)
Subject: R-alpha: eigen
In-Reply-To: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970811094129.432B-100000@zen>


eigen is behaving very strangely in my copy of patch 3 (solaris 2.5.1). 
The calls to .Fortran are returning absolute rubbish and are also mutating
things that shouldn't be mutated. 

example:
> eigen(matrix(c(1,0,0,1),2))  
debug: z <- .Fortran("rs", n, n, x, values = vals, only.values == FALSE, 
        vectors = x, vals, vals, ierr = integer(1))
Browse[1]> x
     [,1] [,2]
[1,]    1    0
[2,]    0    1
Browse[1]> 
debug: if (z$ierr) stop(paste("rs returned code ", z$ierr, " in eigen"))
Browse[1]> dim(x)
[1] -1076060379  -977277476
Browse[1]> dim(z$vectors)
[1] -1076060379  -977277476
Browse[1]> dim(x)<-c(2,2)
Browse[1]> dim(x)
[1] 2 2
Browse[1]> dim(z$vectors)
[1] 2 2
Browse[1]> z$vectors
          [,1]       [,2]
[1,] 0.8506508 -0.4472136
[2,] 0.5257311  0.7236068

Not only are these clearly not the eigenvectors of the identity, but the
.Fortran routine shouldn't even have access to x.

The problems turn out to be related: when separate objects are supplied
for each argument the function works properly, ie
        z <- .Fortran("rs", n, n, x, values = vals, only.values ==  FALSE, 
		vectors = 0 * x, vals * 0, vals * 0, ierr = integer(1))

Somehow the arguments to .Fortran aren't getting properly copied.


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug 11 22:14:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 12 Aug 1997 09:14:42 +1200 (NZST)
Subject: R-alpha: eigen
In-Reply-To: <Pine.SUN.3.95.970811094129.432B-100000@zen>
References: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970811094129.432B-100000@zen>
Message-ID: <199708112114.JAA09123@stat1.stat.auckland.ac.nz>

Thomas Lumley writes:
 > 
 > eigen is behaving very strangely in my copy of patch 3 (solaris 2.5.1). 
 > The calls to .Fortran are returning absolute rubbish and are also mutating
 > things that shouldn't be mutated. 

I think that this is my fault for making a "quick fix" without really
testing it.  The problem (as pointed out by Martin) is in dotcode.c.

The function naoktrim should read

static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 1;	/* <---- 1 not 0 */
                *len = 0;
        }

Sorry about that.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Aug 12 01:21:12 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 12 Aug 1997 12:21:12 +1200 (NZST)
Subject: R-alpha: Matrix Class
Message-ID: <199708120021.MAA16813@stat1.stat.auckland.ac.nz>

The have been a few prods to create an S-like matrix class for R.  A
major reason for having a matrix class seems to be that people get
bitten by the default behavior of the drop= parameter to "[".  That
being the case does it make sense to change the semantics of "["
rather than introducing a new class?

I'm just wondering because I'm in a "smaller is better" kind of mood
after having been delving into the "lm" code and thinking about how
big R is becoming ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 02:04:28 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 Aug 1997 18:04:28 -0700 (PDT)
Subject: R-alpha: Matrix Class
In-Reply-To: <199708120021.MAA16813@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970811174844.739A-100000@zen>

On Tue, 12 Aug 1997, Ross Ihaka wrote:

> The have been a few prods to create an S-like matrix class for R.  A
> major reason for having a matrix class seems to be that people get
> bitten by the default behavior of the drop= parameter to "[".  That
> being the case does it make sense to change the semantics of "["
> rather than introducing a new class?

I think changing the semantics is preferable, in part because it fixes the
drop problem automatically, rather than requiring everyone to use a new
feature.  Creating a Matrix class would not fix the array problem for
arrays of dimension 3 or more, either.

However, a Matrix library might be a nice place to put matrix features
that not everyone needs. This helps keep the size of R down.  Libraries
that can be loaded and unloaded seem like the ideal place to put a whole
lot of things, rather than taking the S-PLUS approach of bundling gam and
trees and nlme and everything else together.  


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 08:32:10 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 09:32:10 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <Pine.SUN.3.95.970811174844.739A-100000@zen> (message from Thomas
 Lumley on Mon, 11 Aug 1997 18:04:28 -0700 (PDT))
Message-ID: <199708120732.JAA00579@sophie.ethz.ch>

	we are discussing, yes? -- 
	please nobody feel hurt just  because I disagree so heartily .. ;-)


>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    TL> On Tue, 12 Aug 1997, Ross Ihaka wrote:
    >> There have been a few prods to create an S-like matrix class for R.
    >> A major reason for having a matrix class seems to be that people get
    >> bitten by the default behavior of the drop= parameter to "[".
I think there are quite a few other reasons. I've been wanting to have 
a 'matrix' class for other reasons for quite a long time.
(One that come to my mind:
	Kurt's (and my earlier) proposal for a generic  "write" function
	with a write.data.frame  method would be much
	cleaner to implement with a write.matrix method when matrix was a class)

    >> That being the case does it make sense to change the semantics of "["
    >> rather than introducing a new class?

I don't think so. (see above and below)

    TL> I think changing the semantics is preferable, in part because it
    TL> fixes the drop problem automatically, rather than requiring
    TL> everyone to use a new feature.  Creating a Matrix class would not
    TL> fix the array problem for arrays of dimension 3 or more, either.

I disagree (I think this is a rare thing with you Thomas..).
----------
1) Lest I misunderstood something,
  you mean that	for matrices 'x',
	  x[,1]
  would be a 1--column matrix instead of a vector ?
  IMHO, this is ugly, and is really just logical if you come from a strict
  matrix thinker's corner which is the case for  matlab users, and maybe even
  mathematicians and the like (I'm one myself),
  but not for an average person analyzing  statistical data.

2) I'm quite convinced that this will break quite a bit of existing code,
   maybe code outside the R 'base' source, but still.

   It is more basically incompatible to S semantics than many other things,
   I think.

3) What if  x  is a data.frame? Would  x[,1] still be a data.frame?
  If not (which I presume), wouldn't this be contrary to the idea which I
  teach to beginners that
	``data.frames are just matrices, but a bit more general since
	  they can contain both numbers and character codes''


All in all, the use of  ``drop = FALSE'' is one way to avoid the problem,
and I agree there should be others,
(namely a  'Matrix' class in "R base" INDEPENDENT of the Matrix library.)

I do like the  class approach in any case and would like to have
'matrix' be THE generic class for all matrices 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[[I've advocating this even for S-plus,
  years ago, before 'Matrix' came into existence]] 

Then, 'Matrix' would be a class inheriting from 'matrix' with 
at least it's own "].Matrix" method.

    TL> However, a Matrix library might be a nice place to put matrix
    TL> features that not everyone needs. This helps keep the size of R
    TL> down.  Libraries that can be loaded and unloaded seem like the
    TL> ideal place to put a whole lot of things, rather than taking the
    TL> S-PLUS approach of bundling gam and trees and nlme and everything
    TL> else together.
yes. {also see above: 'Matrix' would be a class ANYWAY, for the
	``[,1] ==> Matrix''   aficionados}

Especially that we now have require() and provide()  
[[ provide  has been  fallen out of the source recently,
   it is "back again" and should appear in the next (pre)release
]]


This is an important discussion - I think -
so please tell me why you disagree...

--- Martin


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 14:23:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 15:23:13 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708111336.PAA00453@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 11 Aug 1997 15:36:08 +0200)
Message-ID: <199708121323.PAA02620@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Not really important, but ... `make tests' fails if a user's
    Kurt> .Rprofile asks for libraries which are not found by the binary in
    Kurt> the compilation tree (yes I know, we're here perhaps the only
    Kurt> ones who use private libraries ...).

    Kurt> Perhaps we should have options
    Kurt>  --no-site-file
    Kurt>  --no-init-file
    Kurt> which inhibit the loading of a global and a user's init file?

Yes, this (or something similar, maybe also allowing "-q" as short form)
would be useful!


For me even more important, is an option such as
	--dont-stop-on-error-if-batch

As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
namely "Termination upon 'error'".

I think this is THE good default behavior for "batch mode".
However
 1) for several purposes I'd very much want an option to change this
    default behavior.
 2) S-plus behaves differently, i.e., just continues evaluation after
    telling about the error, both in  "Splus BATCH .." and "Splus < file" mode.

Instead of the above switch ((which is hard to port to point'n'click
			      Win or Mac versions))
we could have something as

	options(error.stop = FALSE)

whereas the default was

	options(error.stop = TRUE)

I think it'd be very neat then if
	options(error.stop = FALSE)
actually translated all errors [stop(.)] to warnings [warning()].

The above option may come handy even in NON-BATCH mode,
e.g. when minimizing functions that produce NA from time to time or similar
things, and you are running large loops of simulations...


Just for the sake of completeness, the following is somewhat related to the
above discussion and  has been part of the TASKS for a while :
----------------------------------------------------------------------
TASK:	warnings option
STATUS:	Open
FROM:	maechler@stat.math.ethz.ch
	which reminds me that we/I also would like something similar as S's
	options(warn = k)
	k=  0 : [default]  print warnings
	k= -1 :	do nothing (maybe append warnings to some temp-file)
	k=  1 : produce an error ('warning' becomes 'stop'). 

----------------------------------------------------------------------


-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 15:16:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 16:16:12 +0200
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: <199708111336.PAA00438@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 11 Aug 1997 15:36:07 +0200)
Message-ID: <199708121416.QAA02795@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Not sure if I already reported this ... it seems that as of
    Kurt> 0.50.a2, the adj graphics parameter is completely ignored.  Try
    Kurt> e.g.
    Kurt>	plot(1:10)
    Kurt>	title(main = "This is a title", adj = 0)
    Kurt>	title(main = "This is a title", adj = 1)

    Kurt> No difference ...

true.
	{{are you sure if your example worked before ??}}


For  'mtext(..)'  adj does something but not the proper one :

	plot(1:10)#-- or just in the plot above..

	mtext( "This is an 'mtext(.. adj=0)'", adj = 0)
	mtext( "This is an 'mtext(.. adj=1)'", adj = 1)
	## is different but result is WRONG: adj=1 is LEFT of adj=0


for  'text(..)'   adj works as it should, at least in the cases I used it.
					 [ -> see the example in  ?text]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Aug 12 15:29:18 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 12 Aug 1997 10:29:18 -0400
Subject: R-alpha: Matrix Class
Message-ID: <97Aug12.103129edt.26507@mailgate.bank-banque-canada.ca>

Ross

If you're looking at the drop= code it sure would be nice to be able to (optionally) supply a vector (eg. drop=c(F,F,T) ) for higer dimension arrays.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 16:48:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 17:48:03 +0200
Subject: R-alpha: yet another remaining buglet
Message-ID: <199708121548.RAA02951@sophie.ethz.ch>

This was originally 

>> Cc: r-devel@stat.math.ethz.ch
>> Subject: Re: R-alpha: list assignment
>> References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
>> From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
>> Date: 25 Apr 1997 13:09:01 +0200
>> In-Reply-To: Robert Gentleman's message of Fri, 25 Apr 1997 13:12:36 +1200 (NZST)

### 2)  names(x)[1] <- "a"  still gives extraneous doublequotes IN the name

x <- list()
x[[1]] <- 23
names(x)[1] <- "a"
x  #----------------- got the quotes, also !!
##- $"a"
##- [1] 23
unlist(x)
##- \"a\"
##-    23
names(x) #> [1] "\"a\""


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 17:28:13 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 12 Aug 1997 09:28:13 -0700 (PDT)
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <199708120732.JAA00579@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970812090421.777A-100000@spock>

> 
> I disagree (I think this is a rare thing with you Thomas..).
> ----------
> 1) Lest I misunderstood something,
>   you mean that	for matrices 'x',
> 	  x[,1]
>   would be a 1--column matrix instead of a vector ?
>   IMHO, this is ugly, and is really just logical if you come from a strict
>   matrix thinker's corner which is the case for  matlab users, and maybe even
>   mathematicians and the like (I'm one myself),
>   but not for an average person analyzing  statistical data.

I'm not opposed to a matrix class, but I do think drop=FALSE should be the
default for arrays (I'm not as sure about data frames, but I do think it
is reasonable that one row of a data frame should be a data frame). The
reason is that the *current* behaviour of [ with drop=TRUE in S and R
breaks a lot of S code. 

I have found this particular problem in code written for other people to
use by people from a wide range of backgrounds. For example, Harald
Fekjaer's addreg library, Adrian Raftery's bayesian model averaging code,
and even an early version of Brian Ripley's linear discrimination
function. These functions break because they assume that x[vec,] is a
matrix even when it has a single row.  It rarely seems to matter if x[,1]
is a matrix or a vector, but it is important if x[1,] is a vector. 

For data analysis I don't think it matters much, though I agree it is a
little ugly for x[,1] to be a matrix. For programming I think that drop=F
is the same sort of incompatibility as the R scoping rules: one that
fixes, rather than breaks, S code. Of course people could just use drop=F,
the way they could just pass variables into nested functions explicitly.
The problem is that most of us don't, and it's a remarkably difficult bug
to find.

I may well be wrong, of course. ;-)


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 17:35:46 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 12 Aug 1997 09:35:46 -0700 (PDT)
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708121323.PAA02620@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970812093005.777B-100000@spock>

On Tue, 12 Aug 1997, Martin Maechler wrote:
> 
> As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
> namely "Termination upon 'error'".
> 
> I think this is THE good default behavior for "batch mode".
> However
>  1) for several purposes I'd very much want an option to change this
>     default behavior.
Hear, hear!

> 
> I think it'd be very neat then if
> 	options(error.stop = FALSE)
> actually translated all errors [stop(.)] to warnings [warning()].
> 

I'm not convinced.  Being able to make warnings fatal is a good option,
but being able to continue after errors may make no sense.   How do you
continue after subscript out of bounds, or argument missing with no
default, or memory exhausted or ...

You may well need to jump back to the top level before it makes sense to
continue.  On the other hand, once at the top level it is certainly
possible to proceed, and so there should be an option to do it.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 17:40:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 18:40:55 +0200
Subject: R-alpha: attach( <data.frame> , pos = 1) -- does not work.   detach(., save=..)
Message-ID: <199708121640.SAA03254@sophie.ethz.ch>

	[R-0.50-a3]

It seems intuitive that
	  attach( .., pos = 1)
is harder
than other attach()es.

But still...

If it ever will work, it is even more important to have

detach( .... , save = "VAR.name")
	       ~~~~~~~ --------
to be working.

The documentation says that  detach(.) returns invisibly.
Therefore, we don't NEED the above  'save = ' argument to detach,
since we can work with

	VAR.name <- detach ( .... )
instead.
However, there's a little problem there, too:
if the frame has been changed it is always returned as list
(which is different from S's ``save = T'' 
 which tries to coerce to data.frame)

Otherwise, things are ok (and conform to S's behavior):


###-------  Martin Mächler, Aug.12, 1997  (0.50-a3) : -----
data(bees)
search()

attach(bees)
attach(bees[-1,])
search()#ok : ".GlobalEnv"   "bees[, -1]"   "bees"   "library:base"

length(Lcp <- log(colpos)) # 63
assign("Lcp", Lcp, pos = 2)
b1 <- detach()#-- now, b1 is a 'list' instead of a data.frame ..

length(Lcp <- log(colpos)) # 64
bb <- detach()#>>> bb is a data.frame
search()#-- as it was 'at the beginning'

data.class(bb)# "data.frame"
data.class(b1)# "list"

db1 <- as.data.frame(b1)
##>> Error: no applicable method for "as.data.frame"

## And -- as a matter of fact -- there are __NO__ methods for as.data.frame...

## The following helps:
as.data.frame.default <-
  function (x, row.names = NULL, optional = F, ...)
  data.frame(x, row.names=row.names, ...)

db1 <- as.data.frame(b1)
summary(db1) #--> ok


attach(bees, pos = 1)
search()#- just still at  pos = 2 ..
attach(bees[,-1], pos = 3) #-- works ok !
search()#ok:  ".GlobalEnv"   "bees"   "bees[, -1]"   "library:base"

detach() #-- detaches pos=2, [ NOT the last attached one; -- AS S-plus ]
search()#--  ".GlobalEnv"    "bees[, -1]"   "library:base"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Aug 12 18:48:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 12 Aug 1997 13:48:56 -0400
Subject: R-alpha: error.handler
Message-ID: <97Aug12.135112edt.26508@mailgate.bank-banque-canada.ca>

> I think it'd be very neat then if
> 	options(error.stop = FALSE)

It would be even better to have
	options(error.handler = error.handling.routine)

so it would be possible to do some special error checking or just stop().

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug 12 23:39:14 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Aug 1997 00:39:14 +0200
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: Martin Maechler's message of Tue, 12 Aug 1997 16:16:12 +0200
References: <199708121416.QAA02795@sophie.ethz.ch>
Message-ID: <x2g1sf2fhp.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> For  'mtext(..)'  adj does something but not the proper one :
> 
> 	plot(1:10)#-- or just in the plot above..
> 
> 	mtext( "This is an 'mtext(.. adj=0)'", adj = 0)
> 	mtext( "This is an 'mtext(.. adj=1)'", adj = 1)
> 	## is different but result is WRONG: adj=1 is LEFT of adj=0

-- as it should be! adj=0 is left-aligned, adj=1 is right-aligned

(take a string, attach a scale 0 to 1 along it, mark the value of adj
on scale, attach that point to the anchor point, i.e. the midpoint of
the plotting frame).

> 
> 
> for  'text(..)'   adj works as it should, at least in the cases I used it.
> 					 [ -> see the example in  ?text]

seems to work exactly the same!

The confusion seems to come from wanting 0/0.5/1 to mean
left/center/right-*justified* along the plot frame, which it really
doesn't. 

Even if it did, it wouldn't help, the control really needs to be
two-dimensional: you might want text left/center/right aligned with
the top of the y-axis. The at= parameter *almost* does it, but it is
in user coordinates, rather than frame coordinates. Perhaps we want an
anchor= parameter? -- or even better, a way of attaching units to plot
lengths. This kind of problem also appears with text() and legend()
(ever tried to produce plots with different scales but the legends in
the exact same spot?).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Wed Aug 13 00:58:51 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 13 Aug 1997 11:58:51 +1200 (NZST)
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>

Martin wrote:
>  I am sorry that this IS an old topic.
> Yet another task
> I think the bug is somewhere in hidden  in  src/main/options.c ..
> 
> ##-- The following does not work as it should in  R (0.50-a1, but I think
> 							also earlier)
> 
> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
> tst()
> tst(dig = 12)
> 
> 
> ##-- This should do the same; it works as expected in R & S :
> 
> tst2 <- function(x=pi, dig =3) {
>   oo <- options(digits=dig); on.exit(oo); print(x);x}
> tst2()
> tst2(dig = 12)


  Well it isn't really clear what Splus does to get tst to work. It appears
  that they use some form of dynamic scope for Options. Clearly, the 
  assignment,
    .Options$digits<- xxxx
  creates a local copy of .Options and changes the value of that. The only
  way that print can find this local copy is if  it looks up the stack of
  calling functions to find it (or perhaps Splus squirrels it away somewhere
  that print looks but then <- starts to behave in a very peculiar manner).
  This sort of behaviour is bad for two reasons
    1) We really want people to use lexical scope and any examples where you
    have dynamic scope simply confuse things
    2) It is quite inefficient for print (and anything else that uses Options)
    to have to look up the stack of calling functions.
    
  Since the method Martin so capably demonstrated with tst2 does work
   (except I think he meant on.exit(options(oo)) rather than on.exit(oo))
   I think we should stick with that. In that case the global value of 
   options(digits) is changed for the duration of the function evaluation
   of tst2.
   
 robert
 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Aug 13 01:01:09 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 13 Aug 1997 12:01:09 +1200 (NZST)
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: <x2g1sf2fhp.fsf@bush.kubism.ku.dk>
References: <199708121416.QAA02795@sophie.ethz.ch>
 <x2g1sf2fhp.fsf@bush.kubism.ku.dk>
Message-ID: <199708130001.MAA04180@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > (ever tried to produce plots with different scales but the legends in
 > the exact same spot?).

There is a barely documented (and nearly forgotten) R "feature" which you
might find useful ...

The functions xinch() and yinch() convert inches (xcm() and ycm() are
left as an exercise) to "usr" coordinates.

For example, to plot a point half an inch up from the lower left
corner of a plot you can use:

	ll <- par("usr")[c(1,3)] + c(xinch(0.5), yinch(0.5))
	points(ll[1], ll[2])

The same trick works for placing legends in "usr" coordinates.
	Ross


PS: I am making the "adj" feature behave like S.  Again this was
ignorance on my part, not malice.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 08:28:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 09:28:08 +0200
Subject: R-alpha: another minor problem
Message-ID: <199708130728.JAA01062@aragorn.ci.tuwien.ac.at>

As it seems that everyone's wishes for getting bugs fixed are granted
right away, here is something that I alread mentioned once.

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

        R> x <- 1:5
        R> x
        [1] 1 2 3 4 5
        R> i <- c(F, T)
        R> x[i]
        Error: invalid subscript type
        R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

        R> x[-6]
        Error: subscript out of bounds


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 08:54:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 09:54:31 +0200
Subject: R-alpha: frame tools
In-Reply-To: <x2bu34eq85.fsf@biostat.ku.dk>
References: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>
 <x2bu34eq85.fsf@biostat.ku.dk>
Message-ID: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <hornik@ci.tuwien.ac.at> writes:
>> 
>> Btw, what happened to Peter's frame tools?   Is there a new version?
>> Are there plans to include them in the distribution?

> In the cooler for the time being. I did a little poking around some
> weeks ago, planning to change the syntax slightly so that there would
> be two functions, accessed as generic methods:

> subset.data.frame(fr,...,where)
> transform.data.frame(fr,...)

> e.g.,

> subset(data,visit1:visit5,where=(treat=="placebo"))
> transform(data,log.creatin=log(creatin))

> I.e. subset now combines the old select.frame and subset.frame
> mechanisms.

Sounds very nice.

> I also spent a litle while pondering whether the method for
> substituting names in an object of mode "call" could be generalized
> somehow, but decided that it was probably too difficult to get it
> right.

> Then the close-xterm bug zapped the .RData in the directory where I
> had been experimenting... Actually, I hadn't done all that much,
> mainly terminology cleanup, and what was lost should be easily
> recreated.

(Maybe run R from within Emacs?)

> What's really keeping me is that I've decided to try using R for our
> course in basic statistics for medical researchers, so now I need to
> focus on making sure things work that I absolutely *need*, and write
> various tutorials and missing functions (anyone have logrank.test and
> kaplan.meier.plot? Working with the Windows version, that is!).

Yes, that would be nice, too.  I remember you asked for that some time
ago ...

What's also needed is something to produce and plot empirical
distribution functions.  I thought I could write something for my
Biostat course last semester, but it never happened ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 09:08:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 10:08:19 +0200
Subject: R-alpha: plotting empirical distribution function -- plot.step
In-Reply-To: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 13 Aug 1997 09:54:31 +0200)
Message-ID: <199708130808.KAA00695@ingrid.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
   
	.............

    Kurt> What's also needed is something to produce and plot empirical
    Kurt> distribution functions.  I thought I could write something for my
    Kurt> Biostat course last semester, but it never happened ...

Maybe I  REALLY should   have my  'plot.step'  function  put into R.

It does empirical distribution functions and quite a bite more..
Just need a little time to fixup the man page and do a few more tests..

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:09:18 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:09:18 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <199708120732.JAA00579@sophie.ethz.ch>
References: <Pine.SUN.3.95.970811174844.739A-100000@zen>
 <199708120732.JAA00579@sophie.ethz.ch>
Message-ID: <199708130809.KAA01211@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> 	we are discussing, yes? -- 
> 	please nobody feel hurt just  because I disagree so heartily
> .. ;-)

I certainly don't.

>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

TL> On Tue, 12 Aug 1997, Ross Ihaka wrote:
>>> There have been a few prods to create an S-like matrix class for R.
>>> A major reason for having a matrix class seems to be that people get
>>> bitten by the default behavior of the drop= parameter to "[".

> I think there are quite a few other reasons. I've been wanting to have 
> a 'matrix' class for other reasons for quite a long time.
> (One that come to my mind:
> 	Kurt's (and my earlier) proposal for a generic  "write" function
> 	with a write.data.frame  method would be much
> 	cleaner to implement with a write.matrix method when matrix was
> a class)

Yes, exactly.  It seems stupid to have to write code like

	xxx.default <- function(obj, ...) {
          if (is.matrix(obj)) {
             xxx.matrix(obj, ...)
          } else {
             ...
          }

(Not only with e.g. the generic write function ... there are many more
examples.)

>>> That being the case does it make sense to change the semantics of "["
>>> rather than introducing a new class?

> I don't think so. (see above and below)

TL> I think changing the semantics is preferable, in part because it
TL> fixes the drop problem automatically, rather than requiring
TL> everyone to use a new feature.  Creating a Matrix class would not
TL> fix the array problem for arrays of dimension 3 or more, either.

> I disagree (I think this is a rare thing with you Thomas..).
> ----------
> 1) Lest I misunderstood something,
>   you mean that	for matrices 'x',
> 	  x[,1]
>   would be a 1--column matrix instead of a vector ?
>   IMHO, this is ugly, and is really just logical if you come from a strict
>   matrix thinker's corner which is the case for  matlab users, and maybe even
>   mathematicians and the like (I'm one myself),
>   but not for an average person analyzing  statistical data.

Exactly.  Having done statistics with Octave prior to the existence of
R, I can only say that `strict matrix thinking' is terrible.  (In
particular, having to worry whether something is a row or a column
vector, when it DOES NOT MATTER AT ALL!)

> 2) I'm quite convinced that this will break quite a bit of existing code,
>    maybe code outside the R 'base' source, but still.

>    It is more basically incompatible to S semantics than many other things,
>    I think.

> 3) What if  x  is a data.frame? Would  x[,1] still be a data.frame?
>   If not (which I presume), wouldn't this be contrary to the idea which I
>   teach to beginners that
> 	``data.frames are just matrices, but a bit more general since
> 	  they can contain both numbers and character codes''

Right!

> All in all, the use of  ``drop = FALSE'' is one way to avoid the problem,
> and I agree there should be others,
> (namely a  'Matrix' class in "R base" INDEPENDENT of the Matrix
> library.)

> I do like the  class approach in any case and would like to have
> 'matrix' be THE generic class for all matrices 
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> [[I've advocating this even for S-plus,
>   years ago, before 'Matrix' came into existence]]

Again, definitely right!

> Then, 'Matrix' would be a class inheriting from 'matrix' with 
> at least it's own "].Matrix" method.

Exactly.

TL> However, a Matrix library might be a nice place to put matrix
TL> features that not everyone needs. This helps keep the size of R
TL> down.  Libraries that can be loaded and unloaded seem like the
TL> ideal place to put a whole lot of things, rather than taking the
TL> S-PLUS approach of bundling gam and trees and nlme and everything
TL> else together.
> yes. {also see above: 'Matrix' would be a class ANYWAY, for the
> 	``[,1] ==> Matrix''   aficionados}

> Especially that we now have require() and provide()  
> [[ provide  has been  fallen out of the source recently,
>    it is "back again" and should appear in the next (pre)release
> ]]


> This is an important discussion - I think -
> so please tell me why you disagree...

> --- Martin

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:13:23 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:13:23 +0200
Subject: R-alpha: plotting empirical distribution function -- plot.step
In-Reply-To: <199708130808.KAA00695@ingrid.ethz.ch>
References: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at>
 <199708130808.KAA00695@ingrid.ethz.ch>
Message-ID: <199708130813.KAA01217@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 	.............

Kurt> What's also needed is something to produce and plot empirical
Kurt> distribution functions.  I thought I could write something for my
Kurt> Biostat course last semester, but it never happened ...

> Maybe I  REALLY should   have my  'plot.step'  function  put into R.

> It does empirical distribution functions and quite a bite more..
> Just need a little time to fixup the man page and do a few more
> tests..

Martin,

Your plot.step should definitely come with R.  The question is, should
there be a class `step' or something similar?  Is there a generic way of
representing step functions?  Then having e.g. print and plot for ECDF
would be automatic, which would be very nice, imho.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:23:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:23:43 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <Pine.SUN.3.95.970812090421.777A-100000@spock>
References: <199708120732.JAA00579@sophie.ethz.ch>
 <Pine.SUN.3.95.970812090421.777A-100000@spock>
Message-ID: <199708130823.KAA01224@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

>> 
>> I disagree (I think this is a rare thing with you Thomas..).
>> ----------
>> 1) Lest I misunderstood something,
>> you mean that	for matrices 'x',
>> x[,1]
>> would be a 1--column matrix instead of a vector ?
>> IMHO, this is ugly, and is really just logical if you come from a strict
>> matrix thinker's corner which is the case for  matlab users, and maybe even
>> mathematicians and the like (I'm one myself),
>> but not for an average person analyzing  statistical data.

> I'm not opposed to a matrix class, but I do think drop=FALSE should be
> the default for arrays (I'm not as sure about data frames, but I do
> think it is reasonable that one row of a data frame should be a data
> frame). The reason is that the *current* behaviour of [ with drop=TRUE
> in S and R breaks a lot of S code.

> I have found this particular problem in code written for other people
> to use by people from a wide range of backgrounds. For example, Harald
> Fekjaer's addreg library, Adrian Raftery's bayesian model averaging
> code, and even an early version of Brian Ripley's linear
> discrimination function. These functions break because they assume
> that x[vec,] is a matrix even when it has a single row.  It rarely
> seems to matter if x[,1] is a matrix or a vector, but it is important
> if x[1,] is a vector.

(Hmm.  Why do they break subsequently?)

> For data analysis I don't think it matters much, though I agree it is
> a little ugly for x[,1] to be a matrix. For programming I think that
> drop=F is the same sort of incompatibility as the R scoping rules: one
> that fixes, rather than breaks, S code. Of course people could just
> use drop=F, the way they could just pass variables into nested
> functions explicitly.  The problem is that most of us don't, and it's
> a remarkably difficult bug to find.

I have two remarks on this one.

* Thomas, if you have ports of the above software, could you PLEASE
package them?  (Btw, I have a finished `port' of the V&R `classif'
library, and of the `clus' library which comes with the paper on JSS.)

* Personally, I feel that x[1,] and x[,1] should be a vector if x is a
matrix.  As Martin said, MATRIX `freaks' should be able to attach class
attribute Matrix which would give drop = F.  (Fortunately, the S lang
does not have scalars, otherwise we'd we in trouble with x[i] for x a
vector ...).

If that breaks existing code, I think we should try to get the authors
of that code to make compatibility changes if possible.  E.g. in the
above cases, if subscripting with drop = F would do the trick in either
case, then I don't think that e.g. V&R would object to making the
change.

Or, perhaps R&R should ask Chambers why S does things the way it does?

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 11:37:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 12:37:03 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: <199708122358.LAA04005@stat1.stat.auckland.ac.nz> (message from
 Robert Gentleman on Wed, 13 Aug 1997 11:58:51 +1200 (NZST))
Message-ID: <199708131037.MAA00520@sophie.ethz.ch>

>>>>> "Robert" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

    Robert> Martin wrote:
    >> I am sorry that this IS an old topic.  Yet another task I think the
    >> bug is somewhere in hidden in src/main/options.c ..
    >> 
    >> ##-- The following does not work as it should in R (0.50-a1, but I
    >> think also earlier)
    >> 
    >> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig);
    >> print(x);x} tst() tst(dig = 12)
    >> 
    >> 
    >> ##-- This should do the same; it works as expected in R & S :
    >> 
    >> tst2 <- function(x=pi, dig =3) { oo <- options(digits=dig);
    >> on.exit(oo); print(x);x} tst2() tst2(dig = 12)

    Robert>   Well it isn't really clear what Splus does to get tst to
    Robert> work. It appears that they use some form of dynamic scope for
    Robert> Options. Clearly, the assignment, .Options$digits<- xxxx
    Robert> creates a local copy of .Options and changes the value of
    Robert> that. The only way that print can find this local copy is if it
    Robert> looks up the stack of calling functions to find it (or perhaps
    Robert> Splus squirrels it away somewhere that print looks but then <-
    Robert> starts to behave in a very peculiar manner).  This sort of
    Robert> behaviour is bad for two reasons 1) We really want people to
    Robert> use lexical scope and any examples where you have dynamic scope
    Robert> simply confuse things 2) It is quite inefficient for print (and
    Robert> anything else that uses Options) to have to look up the stack
    Robert> of calling functions.

ok;
yes, I wonder too, how S-plus does it. (Bill V. ?)
    
    Robert>   Since the method Martin so capably demonstrated with tst2
    Robert> does work (except I think he meant on.exit(options(oo)) rather
    Robert> than on.exit(oo)) I think we should stick with that. In that
    Robert> case the global value of options(digits) is changed for the
    Robert> duration of the function evaluation of tst2.
   
okay, I could live with it.

Problem is:

	In the current version (i.e. 0.50-a3), even  tst2(.)
						     ---^---
	does NOT work !
	(yes, it did before ..)

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug 13 12:13:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Aug 1997 13:13:35 +0200
Subject: R-alpha: .Options$digits do not (always) work.
In-Reply-To: Robert Gentleman's message of Wed, 13 Aug 1997 11:58:51 +1200 (NZST)
References: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>
Message-ID: <x290y6z674.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

>   Well it isn't really clear what Splus does to get tst to work. It appears
>   that they use some form of dynamic scope for Options. Clearly, the 
>   assignment,
>     .Options$digits<- xxxx
>   creates a local copy of .Options and changes the value of that. The only
>   way that print can find this local copy is if  it looks up the stack of
>   calling functions to find it (or perhaps Splus squirrels it away somewhere

Couldn't one have the digits argument of print default to
.Options$digits (or is that eval(.Options$digits,
sys.frame(sys.parent)) ??)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 13 17:21:00 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 Aug 1997 09:21:00 -0700 (PDT)
Subject: R-alpha: Matrix: I surrender
In-Reply-To: <199708130823.KAA01224@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970813085249.1515A-100000@zen>


To make what I was saying a little clearer, the fact that eg
y<-x[vec,]
y[1,]
returns an error if vec is of length 1 (or has one T, &c) is compatible
with S, but not with what most people expect when writing programs.
Statements like y<-x[vec,] nearly always need drop=F as otherwise any
future references to y must have special cases to handle vectors. 

The problem is that we should have drop=F when indexing by vectors that
happen to be of length 1 and drop=T when indexing by scalars. I suppose
it's reasonable to say that programmers can take care of themselves and we
should choose the best default for interactive use, which is certainly
drop=T. 

Perhaps we just need a mental health warning in the documentation and/or
the faq to remind programmers that array dimensions can vanish whenever
you subset. 

Also

Kurt wrote:
> 
> * Thomas, if you have ports of the above software, could you PLEASE
> package them?  (Btw, I have a finished `port' of the V&R `classif'
> library, and of the `clus' library which comes with the paper on JSS.)
> 

 I have ported the addreg library, with additions (and sent it back to
 Harald Fekjaer, who should be releasing it Real Soon Now).  The linear
 discrimination code I referred to is long obsolete and has been fixed (I
 saw it in 1992, I think). I'm intermittently working on the bayesian
 model averaging code, which was the major reason for creating the "leaps" 
 subset selection library. 


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 17:38:20 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 18:38:20 +0200
Subject: R-alpha: Re: R-beta: compiling R-5.0 on IRIX6.1
In-Reply-To: <9708131608.AA11484@isdux1.bham.ac.uk> (message from Dr X Cai on
 Wed, 13 Aug 1997 17:08:31 +0100)
Message-ID: <199708131638.SAA01351@sophie.ethz.ch>

Note that  R-0.50  is  ALPHA testing software
and should only be used by people who are willing to 'bleed'.

Their e-mail list is really  'R-devel' and  NOT  R-help
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Wed Aug 13 18:16:27 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 Aug 1997 13:16:27 -0400
Subject: R-alpha: update on patching
Message-ID: <97Aug13.131808edt.26507@mailgate.bank-banque-canada.ca>

Sorry for previously posting on R-help. 

Thanks to a few people for pointing out -p 0 on patch, but that was not enough (at least under Solaris). It seems Solaris tries to figure out which of the two files is to be updated, and if it finds them both then it starts asking for names. What I actually had to do was

1/ mv R-0.50-a1  R-0.50-a2
2/ cd R-0.50-a2
3/ patch -p 0 <R-0.50-a1.patch

If you 
 cp -r R-0.50-a1  R-0.50-a2
rather than mv, then you must rename R-0.50-a1 or the above mentioned problem occurs.

Paul
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Aug 13 21:18:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 14 Aug 1997 08:18:59 +1200 (NZST)
Subject: R-alpha: frame tools
Message-ID: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>

	Kurt Hornik writes:

	> What's also needed is something to produce and plot empirical
	> distribution functions.  I thought I could write something for my
	> Biostat course last semester, but it never happened ...

Have you had a look at the type="S" and type="s" options to plot?  They
produce two variants of step functions.  I didn't know about them until
I started implementing our version graphics.  They are documented in "par".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Aug 14 00:32:04 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Thu, 14 Aug 1997 11:32:04 +1200 (NZST)
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708132332.LAA23379@stat1.stat.auckland.ac.nz>

> From pd@kubism.ku.dk Wed Aug 13 23:11 NZS 1997
> To: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
> Cc: R-devel@stat.math.ethz.ch
> Subject: Re: R-alpha: .Options$digits  do not (always) work.
> From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
> Date: 13 Aug 1997 13:13:35 +0200
> 
> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
> 
> >   Well it isn't really clear what Splus does to get tst to work. It appears
> >   that they use some form of dynamic scope for Options. Clearly, the 
> >   assignment,
> >     .Options$digits<- xxxx
> >   creates a local copy of .Options and changes the value of that. The only
> >   way that print can find this local copy is if  it looks up the stack of
> >   calling functions to find it (or perhaps Splus squirrels it away somewhere
> 
> Couldn't one have the digits argument of print default to
> .Options$digits (or is that eval(.Options$digits,
> sys.frame(sys.parent)) ??)

  Ah, but how far up do you look? That's fine if print is called from the
  function that sets .Options but what if it is called from a function that
  is called from the function that is....called from the function that set
  .Options. Looking back up all of these is dynamic scope. It is pretty
  inefficient for print to have to look in all these places for a .Options
  before it can do its thing.
  
  Alternatively you could say that print either gets .Options from the parent
  or from top level and so it looks in sys.frame(sys.parent) but then someone
  will want to do it from the grandparent and not understand why it doesn't
  work. 
  
  I think it would be nice if Martin's example ended up in the FAQ (or a
  programming examples repository) with an explanation that the global
  .Options is checked; local copies aren't and that if you want to affect
  the global value you can do it in the manner shown in the example. I think
  this is a big change from what S does so it should be well signposted.
  
  robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From wvenable@attunga.stats.adelaide.edu.au  Thu Aug 14 06:13:11 1997
From: wvenable@attunga.stats.adelaide.edu.au (Bill Venables)
Date: Thu, 14 Aug 1997 14:43:11 +0930
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: <199708131037.MAA00520@sophie.ethz.ch>
References: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>
 <199708131037.MAA00520@sophie.ethz.ch>
Message-ID: <9708140513.AA13924@attunga.stats.adelaide.edu.au>

Martin Maechler writes:
 > >>>>> "Robert" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
 > 
 >     Robert> Martin wrote:
 >     >> I am sorry that this IS an old topic.  Yet another task I think the
 >     >> bug is somewhere in hidden in src/main/options.c ..
 >     >> 
 >     >> ##-- The following does not work as it should in R (0.50-a1, but I
 >     >> think also earlier)
 >     >> 
 >     >> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig);
 >     >> print(x);x} tst() tst(dig = 12)
 >     >> 
 >     >> 
 >     >> ##-- This should do the same; it works as expected in R & S :
 >     >> 
 >     >> tst2 <- function(x=pi, dig =3) { oo <- options(digits=dig);
 >     >> on.exit(oo); print(x);x} tst2() tst2(dig = 12)

I think not.  Here is what you probably meant to use

tst2 <- function(x = pi, dig = 3) {
  oo <- options(digits = dig)
  on.exit(options(oo))
  print(x)
  x
}

> tst2()
[1] 3.14
[1] 3.14159

Notice that the on.exit() happens after the function is complete
but before auto-printing.

 >     Robert> Well it isn't really clear what Splus does to get
 >     Robert> tst to work. It appears that they use some form of
 >     Robert> dynamic scope for Options.  Clearly, the
 >     Robert> assignment, .Options$digits <- xxxx creates a local
 >     Robert> copy of .Options and changes the value of
 >     Robert> that.  The only way that print can find this local
 >     Robert> copy is if it looks up the stack of calling
 >     Robert> functions to find it (or perhaps Splus squirrels
 >     Robert> it away somewhere that print looks but then <-
 >     Robert> starts to behave in a very peculiar manner).  This
 >     Robert> sort of behaviour is bad for two reasons 1) We
 >     Robert> really want people to use lexical scope and any
 >     Robert> examples where you have dynamic scope simply
 >     Robert> confuse things 2) It is quite inefficient for
 >     Robert> print (and anything else that uses Options) to
 >     Robert> have to look up the stack of calling functions.
 > 
 > ok;
 > yes, I wonder too, how S-plus does it. (Bill V. ?)

(? Y me?) Sorry, but I don't have any inside knowledge.  A little
experimentation shows that

> options(digits = 10)

operates like an assignment sequence of the form

> .Options$digits <- 10
> assign(".Options", .Options, where = 6)  # or wherever...
> remove(".Options")

Which you normally cannot do directly, of course, (and clearly
the effect is not permanent).

Bill.

-- 
Bill Venables, Head, Dept of Statistics,    Tel.: +61 8 8303 5418
University of Adelaide,                     Fax.: +61 8 8303 3696
South AUSTRALIA.     5005.   Email: Bill.Venables@adelaide.edu.au
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 14 09:30:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 14 Aug 1997 10:30:44 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: Robert Gentleman's message of Thu, 14 Aug 1997 11:32:04 +1200 (NZST)
References: <199708132332.LAA23379@stat1.stat.auckland.ac.nz>
Message-ID: <x2hgct4157.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> > Couldn't one have the digits argument of print default to
> > .Options$digits (or is that eval(.Options$digits,
> > sys.frame(sys.parent)) ??)
> 
>   Ah, but how far up do you look? That's fine if print is called from the
>   function that sets .Options but what if it is called from a function that
>   is called from the function that is....called from the function that set
>   .Options. Looking back up all of these is dynamic scope. It is pretty
>   inefficient for print to have to look in all these places for a .Options
>   before it can do its thing.
>   
>   Alternatively you could say that print either gets .Options from the parent
>   or from top level and so it looks in sys.frame(sys.parent) but then someone
>   will want to do it from the grandparent and not understand why it doesn't
>   work. 
>   
>   I think it would be nice if Martin's example ended up in the FAQ (or a
>   programming examples repository) with an explanation that the global
>   .Options is checked; local copies aren't and that if you want to affect
>   the global value you can do it in the manner shown in the example. I think
>   this is a big change from what S does so it should be well signposted.

Aha. Is this a case where S's "expression frame" does something useful
for once? I've always hated it because it prevents the whole language
from being self-similar: Run the good ol' read-eval-print loop and all
the assignments to frame 1 will get cleaned up between commands, make
a menu-style function that runs the same commands and the crud builds
up.

Maybe we need some kind of limited support for dynamically scoped
variables? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 14 13:01:31 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 14 Aug 1997 14:01:31 +0200
Subject: R-alpha: Re: R-beta:  R-0.49 on IRIX6.1 does not compile
In-Reply-To: <9708140950.AA23517@isdux1.bham.ac.uk> (message from Dr X Cai on
 Thu, 14 Aug 1997 10:50:08 +0100)
Message-ID: <199708141201.OAA01160@sophie.ethz.ch>

>>>>> "XC" == X Cai <caix@isdugp.bham.ac.uk> writes:

    XC> Dear Martin, I am sorry to put the message for the alpha testing
    XC> software.  In fact, when I compiled version R-0.49, the same error
    XC> occurred to me.  Is R-0.49 also at alpha testing stage?  This means
    XC> that I cannot use any version of R.  Do you have any idea about the
    XC> compiling error?


Dear Cai,

R-0.49  was released as beta. 
and
it's good to know about compilation problems, even for alpha releases.

My point really was that you should send reports like these to R-devel
rather than R-help.

    XC> Your kind assistance would be greatly appreciated!

I can only help a little:

1) The 'statement is unreachable' is really just a warning.
   [ I also get a few of those when compiling 
     under Solaris 2.5.1 with Sun's cc.]
 
   They shouldn't have caused your compilation problem.

   [now, see below]

    XC> p.s.: The last few lines of message when compiling R-0.49:

    XC> 	cc -g -I../include -DPOSIX_MISTAKE -c regerror.c
    XC> 	cc -g -I../include -DPOSIX_MISTAKE -c regexec.c
    XC> "engine.c", line 604: warning(1110): statement is unreachable
    XC>   		break;
    XC>   		^

    XC> "engine.c", line 610: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 616: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 627: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 648: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 659: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 670: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 604: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 610: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 616: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 627: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 648: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 659: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 670: warning(1110): statement is unreachable
    XC> break; ^



    XC> Signal: SIGSEGV in Scope Setup phase.
    XC> ### Error (user routine 'sdissect'):
    XC> ### Signal SIGSEGV in phase Scope Setup -- processing aborted
    XC> cc ERROR:  /usr/lib64/cmplrs/fec died due to signal 4
    XC> cc ERROR:  core dumped
    XC> *** Error code 2 (bu21)
    XC> *** Error code 1 (bu21)
    XC> *** Error code 1 (bu21)

Just above lies the compilation error culprit.
Unfortunately, I have no idea what  "Scope Setup phase"  means...

Can you find out what  'fec' is doing, or where  'bu21' comes from?


Probably someone else from the R-devel  list can help you better than I
do...
-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From caix@isdugp.bham.ac.uk  Thu Aug 14 14:40:20 1997
From: caix@isdugp.bham.ac.uk (Dr X Cai)
Date: Thu, 14 Aug 1997 14:40:20 +0100
Subject: R-alpha: Compiling 0.49 on IRIX6.1
Message-ID: <9708141340.AA14089@isdux1.bham.ac.uk>

Hi,

I am compiling R-0.49 on my SGI Indigo 2 R8000 machine and it stopped
in the middle.  Could anyone help me to fix it?

Many thanks!
-- 

                                     Xiaoming Cai
                                     School of Geography
      .&______~*@*~______&.          University of Birmingham
    "w/%%%%%%%%%%%%%%%%%%%\w"        Edgbaston, Birmingham
      `Y""Y""Y"""""Y""Y""Y'          B15 2TT United Kingdom
   p-p_|__|__|_____|__|__|_q-q       Tel: 44 (121) 414-5533 (O)
_-[EEEEM==M==MM===MM==M==MEEEE]-_    Tel: 44 (121) 454-4018 (H)
                                     Fax: 44 (121) 414-5528


p.s.:  The last few lines of message when compiling R-0.49:

	cc -g -I../include -DPOSIX_MISTAKE -c regerror.c
	cc -g -I../include -DPOSIX_MISTAKE -c regexec.c
"engine.c", line 604: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 610: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 616: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 627: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 648: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 659: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 670: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 604: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 610: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 616: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 627: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 648: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 659: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 670: warning(1110): statement is unreachable
  		break;
  		^

Signal: SIGSEGV in Scope Setup phase.
### Error (user routine 'sdissect'):
### Signal SIGSEGV in phase Scope Setup -- processing aborted
cc ERROR:  /usr/lib64/cmplrs/fec died due to signal 4
cc ERROR:  core dumped
*** Error code 2 (bu21)
*** Error code 1 (bu21)
*** Error code 1 (bu21)


-- 

                                     Xiaoming Cai
                                     School of Geography
      .&______~*@*~______&.          University of Birmingham
    "w/%%%%%%%%%%%%%%%%%%%\w"        Edgbaston, Birmingham
      `Y""Y""Y"""""Y""Y""Y'          B15 2TT United Kingdom
   p-p_|__|__|_____|__|__|_q-q       Tel: 44 (121) 414-5533 (O)
_-[EEEEM==M==MM===MM==M==MEEEE]-_    Tel: 44 (121) 454-4018 (H)
                                     Fax: 44 (121) 414-5528
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 14 19:58:29 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 Aug 1997 11:58:29 -0700 (PDT)
Subject: R-alpha: library()
In-Reply-To: <97Aug13.131808edt.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970814115635.1947A-100000@zen>


The CHANGES file says that libraries can now have a .First.lib and
.Last.lib function.  While this is certainly true the functions don't seem
to get called...


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 14 20:38:31 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 Aug 1997 12:38:31 -0700 (PDT)
Subject: R-alpha: autoload again
In-Reply-To: <Pine.SUN.3.95.970814115635.1947A-100000@zen>
Message-ID: <Pine.SUN.3.95.970814123032.1947B-100000@zen>


I have made an autoload library, with a nicer version of the autoload code
I posted a few weeks ago.  It now stores things in a special environment
and it will re-autoload libraries that have been detached. It only works
with the new alpha R. The syntax is eg
autoload("line","eda") 
to automatically load library("eda") when the function line() is invoked.

The library file is at 
http://www.biostat.washington.edu/~thomas/autoload.tar.gz

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 15 08:45:41 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 15 Aug 1997 09:45:41 +0200
Subject: R-alpha: autoload  -- cool!
In-Reply-To: <Pine.SUN.3.95.970814123032.1947B-100000@zen> (message from
 Thomas Lumley on Thu, 14 Aug 1997 12:38:31 -0700 (PDT))
Message-ID: <199708150745.JAA02268@sophie.ethz.ch>

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> I have made an autoload library, with a nicer version of the
    Thomas> autoload code I posted a few weeks ago.  It now stores things
    Thomas> in a special environment and it will re-autoload libraries that
    Thomas> have been detached. It only works with the new alpha R. The
    Thomas> syntax is eg autoload("line","eda") to automatically load
    Thomas> library("eda") when the function line() is invoked.

    Thomas> The library file is at
    Thomas> http://www.biostat.washington.edu/~thomas/autoload.tar.gz

I did not try it (yet);
however, it's such a cool idea that I think 
it should make its way into "R base" !

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 15 09:25:04 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 15 Aug 1997 20:25:04 +1200 (NZST)
Subject: R-alpha: autoload  -- cool!
Message-ID: <199708150825.UAA17107@stat1.stat.auckland.ac.nz>

Sounds great!  I will snag a copy and add it.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 15 16:06:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 15 Aug 1997 17:06:35 +0200
Subject: R-alpha: (minor?) S-R inconsistency:  NULL =~= list()  -- useful is.ALL function
Message-ID: <199708151506.RAA02837@sophie.ethz.ch>


In S, 
	NULL
and
	list()
are not the same.

In R they are (I think).

---------------------------------------------------

At least,

	is.list(NULL) #-> 'F' in S;   'TRUE' in R


Yes: I had an instance where this broke correct S code:

	match(c("xlab","ylab"), names(list(...)))

when '...' is empty, 
gives an error in R,
but gives
	c(NA,NA)
in S.

------------
You may like my function 'is.ALL(.)' for detecting things like these :
(actually some more functions;
 a relatively nice example of using NextMethod(..) for a new "print" method
)

is.ALL <- function(obj, func.names = ls("library:base"),
                   not.using = c("is.single", "is.na.data.frame", "is.loaded"),
                   true.only = FALSE)
{
  ## Purpose: show many 'attributes' of  R object __obj__
  ## -------------------------------------------------------------------------
  ## Arguments: obj: any R object
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date:  6 Dec 96, 15:23

  is.fn <- func.names[substring(func.names,1,3) == "is."]
  use.fn <- is.fn[ is.na(match(is.fn, not.using))]

  r <- if(true.only) character(0)
  else structure(vector("list", length= length(use.fn)), names= use.fn)
  for(f in use.fn) {
    if(any(f == c("is.na", "is.finite"))) {
      if(!is.list(obj) && !is.vector(obj) && !is.array(obj)) {
        if(!true.only) r[[f]] <- NA
        next
      }
    }
    ##prt.DEBUG("f =",f,"; last rr:", if(f!=use.fn[1]) rr else ".. not yet..")
    rr <-  (get(f))(obj)
    if(!is.logical(rr)) cat("f=",f," --- rr  is NOT logical  = ",rr,"\n")
    ##if(1!=length(rr))   cat("f=",f," --- rr NOT of length 1; = ",rr,"\n")
    if(true.only && length(rr)==1 && rr) r <- c(r, f)
    else if(!true.only) r[[f]] <- rr
  }
  if(is.list(r)) structure(r, class = "isList") else r
}

print.isList <- function(r, ...)
{
  ## Purpose:  print METHOD  for  'isList' objects
  ## -------------------------------------------------------------------------
  ## Arguments:
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date: 12 Mar 97, 15:07
  ## >>>>> needs  cmp.logical  --> /u/maechler/R/Util.R
  if(is.list(r)) {
    nm <- format(names(r))
    rr <- lapply(r,cmp.logical)
    for(i in seq(along=r)) cat(nm[i],":",rr[[i]],"\n", ...)
  } else NextMethod("print", ...)
}

cmp.logical <- function(log.v)
{
  ## Purpose: compact printing of logicals
  ## -------------------------------------------------------------------------
  ## Arguments: log.v : logical vector
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date: 13 Dec 96, 16:28
  if(!is.logical(log.v)) {
    warning("coercing argument 'log.v' to logical")
    log.v <- as.logical(log.v)
  }
  structure(if(length(log.v) == 0) "()" else c(".","|")[ 1+ log.v],
	    class = "noquote")
}


## The constructor function
noquote <- function(obj) {
  if(!inherits(obj,"noquote"))
    class(obj) <- c(class(obj),"noquote")
  obj
}
##-- this is just like 'expression'
"[.noquote" <- function (x, subs) structure(unclass(x)[subs], class = "noquote")
## A method for (character) objects of class  'noquote' :
print.noquote <- function(obj,...) {
  cl <- class(obj)
  class(obj) <- cl[cl != "noquote"]
  NextMethod('print', obj, quote = F, ...)
}


### ------------------------------------------------------------------
### Here are some examples on its (is.ALL)  usage :


is.ALL(NULL)

###------- more compactly : ------------ here, we see that   NULL "==" list()

is.ALL(NULL,   true.only = TRUE)
## [1] "is.atomic" "is.list"   "is.null"  
is.ALL(list(), true.only = TRUE)
## [1] "is.atomic" "is.list"   "is.null"  



is.ALL(1:5)
is.ALL(array(1:24, 2:4))
is.ALL(1 + 3)
e13 <- expression(1 + 3)
is.ALL(e13)
## fails (0.50-a) [is.loaded]
##   is.ALL(e13, not.using=c("is.single", "is.finite", "is.na"))
is.ALL(y ~ x) #--> (0.49):  NA  for 'is.na' (& is.finite)



is.ALL(numeric(0), true=T)
is.ALL(array(1,1:3), true=T)
is.ALL(cbind(1:3), true=T)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Aug 15 16:53:11 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 15 Aug 1997 08:53:11 -0700 (PDT)
Subject: R-alpha: (minor?) S-R inconsistency:  NULL =~= list()  -- useful is.ALL function
In-Reply-To: <199708151506.RAA02837@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970815084207.2193A-100000@zen>

On Fri, 15 Aug 1997, Martin Maechler wrote:
> In S, 
> 	NULL
> and
> 	list()
> are not the same.
> 
> In R they are (I think).
> 

The thing that really broke your code is an incompatibility I reported a
while back that people didn't seem to think was serious.  

Comparisons involving NULL give an error in R, but give NA in S.  I didn't
have an example at the time except to point out that returning NA would at
least allow correct short-circuiting of & and | conditions. 

I think in match() there is a much stronger argument for returning NA (or
the nomatch value).  After all, the description of match says

             If x[i] is found to equal table[j] then the value
             returned in the i-th position of the return value is j.
             If no match is found, the value is nomatch.

Surely if table==NULL then the correct return value is nomatch.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 18 10:00:25 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 18 Aug 1997 11:00:25 +0200
Subject: R-alpha: Re: R-beta: Bug or feature?  [+ better histograms]
In-Reply-To: <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
References: <199708170921.VAA03388@stat1.stat.auckland.ac.nz>
 <9708172313.AA15474@attunga.stats.adelaide.edu.au>
 <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
Message-ID: <199708180900.LAA02371@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Bill Venables writes:
>> First a bit of an explanation.  Brian Ripley and I are firmly of
>> the opinion that, to be any use in teaching at all, histograms
>> should be nonparametric estimators of the probability density
>> function.  That is, the vertical scale should be a relative
>> frequency density scale.  It seems impossible to get this in R, so
>> here is a function (+ a few extras) that does give you a "true"
>> histogram, (unless you are peverse enough to request otherwise.)

> Oh goody!  I HATE the present hist; partly because of the
> frequency/density aspect, but mainly because if I ask for 10 cells I
> expect to get 10 cells, not 7 or 35 or whatever.  I'd like propose
> that the present hist get renamed hist.old (or something similar) and
> that Bill's "truehist" become the true "hist".

I'd say, get rid of the old one ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 18 10:51:57 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Aug 1997 11:51:57 +0200
Subject: R-alpha: Re: R-beta: Bug or feature?  [+ better histograms]
In-Reply-To: Kurt Hornik's message of Mon, 18 Aug 1997 11:00:25 +0200
References: <199708170921.VAA03388@stat1.stat.auckland.ac.nz>
 <9708172313.AA15474@attunga.stats.adelaide.edu.au>
 <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
 <199708180900.LAA02371@aragorn.ci.tuwien.ac.at>
Message-ID: <x23eo7ddj6.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Ross Ihaka writes:
> 
> > Bill Venables writes:
> >> First a bit of an explanation.  Brian Ripley and I are firmly of
> >> the opinion that, to be any use in teaching at all, histograms
> >> should be nonparametric estimators of the probability density
> >> function.  That is, the vertical scale should be a relative
> >> frequency density scale.  It seems impossible to get this in R, so
> >> here is a function (+ a few extras) that does give you a "true"
> >> histogram, (unless you are peverse enough to request otherwise.)
> 
> > Oh goody!  I HATE the present hist; partly because of the
> > frequency/density aspect, but mainly because if I ask for 10 cells I
> > expect to get 10 cells, not 7 or 35 or whatever.  I'd like propose
> > that the present hist get renamed hist.old (or something similar) and
> > that Bill's "truehist" become the true "hist".
> 
> I'd say, get rid of the old one ...
> 

Ugh. Please do NOT do that! Some of us need to teach histograms to
people who have difficulties with integrals (and also in recognizing
the connection between a barplot and a step function), so we have to
make do with "shape of curve" considerations, at least in the
beginning. The last thing we need is inexplicable y-axes.

The "# in bin" is not really problematic as long as the the bins are
of the same size and *much* easier to explain to students. 

Even for a statistician, the number is really what conveys the
accuracy estimate that you need when you try to evaluate whether a
histogram matches a given density.

Make it an option, e.g. hist(x,as.density=T). People who can
understand why the "sum of area of blocks should be 1" can also figure
out how to add an option to a function call.

I could easily do without the "prettification" silliness, though.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 18 14:03:37 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Aug 1997 15:03:37 +0200
Subject: R-alpha: Re: R-beta: .C and dyn.load for Windows
In-Reply-To: Goran Brostrom's message of Mon, 18 Aug 1997 14:10:10 +0200 (MET DST)
References: <Pine.GSO.3.95.970818135113.11654A-100000@pc30.stat.umu.se>
Message-ID: <x2yb5zbq3a.fsf@bush.kubism.ku.dk>

Goran Brostrom <gb@pc30.stat.umu.se> writes:

> 
> Dear R-users,
> 
> I maintain software for survival analysis written in C and Fortran since
> many years ago. Recently I have rewritten part of it as functions to
> be called from R by .C. This works fine with the unix version. I just
> create a ".so" file as described in an example in the R distribution.
> 
> However, when I try this approach in Windows (NT or 95), using the 
> Cygnus gcc latest version, the "ld" command to create the ".so" file fails
> miserably. The Windows R documentation talks about "DLL"s, of which I
> know very little.
> 
> Can anyone tell me how to create R-loadable C-code with Cygnus gcc under
> Windows (NT, 95)?
> Maybe it isn't possible?

(This really is alpha/development  stuff, belonging on r-devel)

Is this the Cygnus gcc from gnuwin32? You're a very brave person..!
You didn't happen to get the Windows GUI stuff going while you were at
it, did you?

Robert Gentleman says that he has DLL loading "near the top of his
list" for the next Windows binary version.

Another pointer is that it is rumored that *scilab* has some code to
do the trick on the windows platforms

Some nice guy on the gnuwin32 list claimed to have compatibility
functions for the whole dlopen/dlsym/.. slew a few weeks ago.

BTW: You do know that there already is a quite comprehensive survival
package for R?

Here is the note from gnuwin32:

------------------
Dear all,

I have made some work to let dlls have almost the same behavior as so on UNIX:

        - implementation of dlopen,dlclose,dlsym,dlerror
        - correct init when loaded + call of global contructors
        - call of global destructors when detached
        - dlls are accessible and correctly initialized in forked process
        - handles got through dlopen or dlsym in parent are accessible in child
        - use of LD_LIBRARY_PATH in dlopen search

I think it can help people who need an intensive use of dll ( plugins ... )

My patch is 59082 bytes, so I will not send it to the list.
Anyway, if you are interested, send me a mail and I will send you the patch
personnaly ...

Regards.

P.S: I will send the patch to Geoffrey Noer


 ==========================================================================
|                         Philippe GIACINTI                                |
|                                                                          |
| DALiM GmbH R&D                                email:  giac@dalim.de      |
| Daimler Strasse 2,                            tel:    +49.7851.9196-28   |
| D-77694 Kehl-Sundheim Germany                 fax:    +49.7851.73576     |
|                                                                          |
 ==========================================================================


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Tue Aug 19 09:53:48 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Tue, 19 Aug 1997 10:53:48 +0200 (MET DST)
Subject: R-alpha: A few bugs in R-0.50-a3.
Message-ID: <9708190853.AA10759@alpha.luc.ac.be>

A few problems in R-0.50-a3 (which were also in R-0.49):

1)
y <- c(10,11,12,13,14,NA,NA)
n <- length(y)
missed <- (1:n)[is.na(y)]
notmissed <- (1:n)[!is.na(y)]
blocks <- cut(missed,breaks=c(0,notmissed,n+1))
a <- function(v) {
	q <- range(v)
	c(q[1]-1,q[2]+1)
}
brackets <- tapply(missed,blocks,a)

This codes gives the following in S:
> brackets
$"0+ thru 1":
NULL

$"1+ thru 2":
NULL

$"2+ thru 3":
NULL

$"3+ thru 4":
NULL

$"4+ thru 5":
NULL

$"5+ thru 8":
[1] 5 8

>

And the following in R:

> brackets <- tapply(missed,blocks,a)
Error: names attribute must be same length as the vector

I also had similar problems when using "lm" with data containing NA's
but could not find back a precise example...

2)
b <- list(2)
names(b) <- "lty"
a <- function(...) {
	par(c(...,b))
	par()
}
a()


The following is obtained in S:
> win.graph()
> a()
$"1em":
[1] 0.03150623 0.05075211

$adj:
[1] 0.5

$ask:
[1] F

$bty:
[1] "o"

$cex:
[1] 1

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 19 19:51:17 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 19 Aug 1997 20:51:17 +0200
Subject: R-alpha: ECDFs
In-Reply-To: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>
References: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>
Message-ID: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> 	Kurt Hornik writes:
>> What's also needed is something to produce and plot empirical
>> distribution functions.  I thought I could write something for my
>> Biostat course last semester, but it never happened ...

> Have you had a look at the type="S" and type="s" options to plot?
> They produce two variants of step functions.  I didn't know about them
> until I started implementing our version graphics.  They are
> documented in "par".

I hadn't known about them either, but I think Martin's plot.step is
needed for plotting e.g. ECDFs.

Here's something what is needed for teaching elementary statistics:
Given a sample vector x, compute the corresponding ECDF, plot it, and
perhaps evaluate it at points other than the data points.

One solution might be to have a function "ecdf" which returns an obj of
class "step" (e.g., simply a list with the points where the jumps occur
and the corresponding values, and maybe if we want to be more general
than that info on whether the function is left- or right-continuous at
the point (or perhaps attains a different value).  (I.e., something of
the kind that Martin's plot.step uses ...)

This would more or less automagically take care of the plotting part.
We could also easily add print and summary methods.

The question is, how can we `easily' evaluate a step function at some
point?  Using `predict' does not seem to be the right thing ... any
suggestions?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 19 19:55:34 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 19 Aug 1997 11:55:34 -0700 (PDT)
Subject: R-alpha: ECDFs
In-Reply-To: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>

On Tue, 19 Aug 1997, Kurt Hornik wrote:
> 
> Here's something what is needed for teaching elementary statistics:
> Given a sample vector x, compute the corresponding ECDF, plot it, and
> perhaps evaluate it at points other than the data points.

The approx() function is supposed to do this (it currently only does
linear interpolation).  If the right and left continuous step functions
were added to approx then we could easily use approxfun to define the ECDF
as a function closure, making it automatically available at any point you
want. After all, the ECDF *is* a function.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 19 19:57:56 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 19 Aug 1997 20:57:56 +0200
Subject: R-alpha: A few bugs in R-0.50-a3.
In-Reply-To: <9708190853.AA10759@alpha.luc.ac.be>
References: <9708190853.AA10759@alpha.luc.ac.be>
Message-ID: <199708191857.UAA02786@aragorn.ci.tuwien.ac.at>

>>>>> Patrick Lindsey writes:

> A few problems in R-0.50-a3 (which were also in R-0.49):
> 1)
> y <- c(10,11,12,13,14,NA,NA)
> n <- length(y)
> missed <- (1:n)[is.na(y)]
> notmissed <- (1:n)[!is.na(y)]
> blocks <- cut(missed,breaks=c(0,notmissed,n+1))
> a <- function(v) {
> 	q <- range(v)
> 	c(q[1]-1,q[2]+1)
> }
> brackets <- tapply(missed,blocks,a)

> This codes gives the following in S:
>> brackets
> $"0+ thru 1":
> NULL

> $"1+ thru 2":
> NULL

> $"2+ thru 3":
> NULL

> $"3+ thru 4":
> NULL

> $"4+ thru 5":
> NULL

> $"5+ thru 8":
> [1] 5 8

>> 

> And the following in R:

>> brackets <- tapply(missed,blocks,a)
> Error: names attribute must be same length as the vector

> I also had similar problems when using "lm" with data containing NA's
> but could not find back a precise example...

I think the patch below (which should make it into the next set of
patches) fixes that.

(Except for the differences in cut() ...)

--- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
+++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
@@ -14,7 +14,7 @@
 		index <- as.factor(INDEX[[i]])
 		if (length(index) != nx) 
 			stop("arguments must have same length")
-		namelist[[i]] <- levels(index)
+		namelist[[i]] <- unique(levels(index)[index])
 		extent[[i]] <- nlevels(index)
 		group <- group + ngroup * (codes(index) - 1)
 		ngroup <- ngroup * nlevels(index)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 19 19:58:13 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 19 Aug 1997 11:58:13 -0700 (PDT)
Subject: R-alpha: tapply
In-Reply-To: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
Message-ID: <Pine.SUN.3.95.970819115641.28406E-100000@chekov>


tapply() has been broken for a long time and is still wrong in 50-a3.  I
think the following version works. 

	-thomas

"tapply" <-function (x, INDEX, FUN, ...) 
{
        if (is.character(FUN)) 
                FUN <- get(FUN, mode = "function")
        if (mode(FUN) != "function") 
                stop(paste("\"", FUN, "\" is not a function"))
        if (!is.list(INDEX)) 
                INDEX <- list(INDEX)
        namelist <- vector("list", length(INDEX))
        extent <- integer(length(INDEX))
        nx <- length(x)
        group <- rep(1, nx)
        ngroup <- 1
        for (i in seq(INDEX)) {
                index <- as.factor(INDEX[[i]])
                if (length(index) != nx) 
                        stop("arguments must have same length")
                namelist[[i]] <- levels(index)
                extent[[i]] <- nlevels(index)
                group <- group + ngroup * (codes(index) - 1)
                ngroup <- ngroup * nlevels(index)
        }
        if (missing(FUN))  
                return(group)
	ansmat<-array(NA,dim=extent,dimnames=namelist)
        ans <- lapply(split(x, group), FUN, ...)
        if (all(unlist(lapply(ans, length)) == 1)) {
                ans <- unlist(ans, recursive = FALSE)
	      }
	else { mode(ansmat)<-"list"}
	ansmat[as.numeric(names(ans))]<-ans
	ans<-ansmat
        return(ans)
}


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 09:45:21 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 10:45:21 +0200
Subject: R-alpha:  tapply patch -- Thomas version?
In-Reply-To: <199708191857.UAA02786@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 19 Aug 1997 20:57:56 +0200)
Message-ID: <199708200845.KAA02289@sophie.ethz.ch>


>>>>> Patrick Lindsey writes:
> A few problems in R-0.50-a3 (which were also in R-0.49):
> 1)
> y <- c(10,11,12,13,14,NA,NA)
> n <- length(y)
> missed <- (1:n)[is.na(y)]
> notmissed <- (1:n)[!is.na(y)]
> blocks <- cut(missed,breaks=c(0,notmissed,n+1))
> a <- function(v) {
> 	q <- range(v)
> 	c(q[1]-1,q[2]+1)
> }
> brackets <- tapply(missed,blocks,a)

> This codes gives the following in S:   

> .....

    Kurt> I think the patch below (which should make it into the next set of
    Kurt> patches) fixes that.

yes, it does fix the problem -- and it has been in the current source tree
for about 10 days...
 
   Kurt> (Except for the differences in cut() ...)

    Kurt> --- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
    Kurt> +++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
    Kurt> @@ -14,7 +14,7 @@
    Kurt> index <- as.factor(INDEX[[i]])
    Kurt> if (length(index) != nx) 
    Kurt> stop("arguments must have same length")
    Kurt> -		namelist[[i]] <- levels(index)
    Kurt> +		namelist[[i]] <- unique(levels(index)[index])
    Kurt> extent[[i]] <- nlevels(index)
    Kurt> group <- group + ngroup * (codes(index) - 1)
    Kurt> ngroup <- ngroup * nlevels(index)
 
Thomas, what does your function do differently ?

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 16:52:53 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 17:52:53 +0200
Subject: R-alpha: R-0.50-a3(+) Method despatching bug ?
Message-ID: <199708201552.RAA02602@sophie.ethz.ch>

It is very wierd...  Can some of you confirm the following behavior ?
It is a new bug (feature ?)  which was not yet in 0.49 ...




noquote <- function(obj) {
	## constructor for a useful "minor" class
	if(!inherits(obj,"noquote")) class(obj) <- c(class(obj),"noquote")
	obj
}
"[.noquote" <- function (x, subs) structure(unclass(x)[subs], class = "noquote")

print.noquote <- function(obj,...) {
	## method for (character) objects of class 'noquote'
	cl <- class(obj)
	class(obj) <- cl[cl != "noquote"]
	NextMethod("print", obj, quote = FALSE, ...)
}

nq <- noquote(letters)

##-- the next two should be equivalent, but are not ...?..
print(nq)
nq

> print(nq)
 [1] a b c d e f g h i j k l m n o p q r s t u v w x y z

> nq
Error: couldn't find function "print.noquote"
> unclass(nq)
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"
[20] "t" "u" "v" "w" "x" "y" "z"
> nq
Error: couldn't find function "print.noquote"
> ls()
[1] "[.noquote"     "noquote"       "nq"            "print.noquote"
> print.noquote
function (obj, ...) 
{
        ## method for (character) objects of class 'noquote'
        cl <- class(obj)
        class(obj) <- cl[cl != "noquote"]
        NextMethod("print", obj, quote = FALSE, ...)
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 18:06:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 19:06:11 +0200
Subject: R-alpha: R-0.50-a3: [logical, drop = FALSE] -- bug in R (and S-plus)
Message-ID: <199708201706.TAA02765@sophie.ethz.ch>

This is a bug both in R and S-plus (in R it's "worse"), I think.
Look at this :

ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
ma[logi,]
##>      [,1] [,2]
##> [1,]    1    1
##> [2,]    1    3
##> [3,]    1    5
##> [4,]    1    7

##-- now the same with  [ , drop = FALSE]

## R (-0.50-a3) :

	 ma[logi, drop = F]
##>> Error: invalid subscript type


## Splus-3.4:
	 ma[logi, drop = F]
##>> [1] 1 1 1 1 1 3 5 7

##---- which is not correct either, we would want the matrix !
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 20 18:21:25 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 Aug 1997 10:21:25 -0700 (PDT)
Subject: R-alpha: R-0.50-a3: [logical, drop = FALSE] -- bug in R (and S-plus)
In-Reply-To: <199708201706.TAA02765@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970820101359.641C-100000@chekov>

On Wed, 20 Aug 1997, Martin Maechler wrote:

> This is a bug both in R and S-plus (in R it's "worse"), I think.

I don't think it's a bug

> Look at this :
> 
> ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
> ma[logi,]
> ##>      [,1] [,2]
> ##> [1,]    1    1
> ##> [2,]    1    3
> ##> [3,]    1    5
> ##> [4,]    1    7
> 
> ##-- now the same with  [ , drop = FALSE]
> 
> ## R (-0.50-a3) :
> 
> 	 ma[logi, drop = F]
> ##>> Error: invalid subscript type
> ## Splus-3.4:
> 	 ma[logi, drop = F]
> ##>> [1] 1 1 1 1 1 3 5 7

This is correct.  Did you mean ma[logi,,drop=F]? If you use
ma[logi,drop=F] then this is the equivalent of ma[logi] with drop=F. But
ma[logi] treats the matrix as a vector and there aren't any dimensions to
drop. R should probably recycle the index vector the way S does. 

The loss of dimensions is unavoidable -- suppose you had
ma[c(3,7,8),drop=F].  How are you going to turn this into a matrix?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Wed Aug 20 18:34:35 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Wed, 20 Aug 1997 10:34:35 -0700 (PDT)
Subject: R-alpha: R-0.50-a3(+) Method despatching bug ?
In-Reply-To: <199708201552.RAA02602@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970820094622.641B-100000@chekov>

On Wed, 20 Aug 1997, Martin Maechler wrote:

> It is very wierd...  Can some of you confirm the following behavior ?
> It is a new bug (feature ?)  which was not yet in 0.49 ...
>

I'm not sure that you can expect NextMethod to work if you fiddle with the
class list...

However, there is still something wrong with method dispatching, since
print.noquote <- function (obj, ...)  NextMethod(quote = FALSE,...)
doesn't work either.  The error occurs when R tries for some reason to
make a recursive call to print.noquote.

Using debug() also shows the interesting fact that
R> nq 
calls print() with its arguments evaluated
------
debugging in: print(structure(c("a", "b", "c", "d", "e", "f", "g", "h",
"i", 
"j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", 
"w", "x", "y", "z"), class = "noquote"))
debugging in: print.noquote(structure(c("a", "b", "c", "d", "e", "f", "g", 
"h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", 
"u", "v", "w", "x", "y", "z"), class = "noquote"))
Error: couldn't find function "print.noquote"
-------
but
----------
R> print(nq)
 print(nq)
debugging in: print(nq)
debugging in: print.noquote(nq)
 [1] a b c d e f g h i j k l m n o p q r s t u v w x y z
attr(,"class")
[1] noquote
exiting from: print.noquote(nq)
exiting from: print(nq)
----------
doesn't evaluate the argument first.




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Aug 20 19:26:20 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 20 Aug 1997 13:26:20 -0500
Subject: R-alpha: The Template Numerical Toolkit and R
Message-ID: <6r3eo4soc3.fsf@franz.stat.wisc.edu>

I have tried linking C++ code using the Template Numerical Toolkit
version 0.8.3 (see http://math.nist.gov/tnt/) with R-0.50-a3 (see
http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html).  I expected this to
be very difficult.  It was very easy.  I was pleasantly surprised.
Nice work by the developers all around.

A bit of background for the R crowd: TNT, being developed by Roldan
Pozo at the National Institute for Standards and Technology, is the
successor to lapack++

As the name indicates, all the representations in TNT are templated.
The advantages of using it with R would be that one could obtain the
execution speed of compiled linear algebra code without the
corresponding hassle of keeping track of all the dimensions associated
with matrix representations in Fortran.  All of us really love to
write those calls that require
 A, LDA, M, N
for each matrix being passed but some of us in the baby boomer
generation are getting on in age and we lose track of the calling
sequence at about the 12th argument :-)

TNT creates all matrices as copies of the original content.  Because
it is written in C++, it gracefully handles the releasing of the
storage when the identifier goes out of scope.

Here is a sample run on a Linux system
$ cat R_link.cc
// An example of linking the Template Numerical Toolkit 0.8.3 with R-0.50 
// 
#include "tnt.h" 
#include "vec.h" 
#include "fmat.h" 
 
extern "C" { 
  static double * 
    copy_contents(double *dest, Fortran_matrix<double> A) 
    { 
      double *dd = dest, *src = &A(1,1); 
      int nn = A.num_rows() * A.num_cols(); 
 
      while (nn--) { *dd++ = *src++; } 
      return dest; 
    } 
 
  void my_mat_sum(double * A, double * B, long int * dims) { 
    Fortran_matrix<double> 
      AA(dims[0], dims[1], A),  // creates a copy 
      BB(dims[0], dims[1], B), 
      CC = AA + BB; 
 
    cout << "A on input: " << AA << endl; 
    cout << "B on input: " << BB << endl; 
    cout << "Sum: " << CC << endl;  
    copy_contents(A, CC); 
  } 
} 
$ g++ -c -fpic R_link.cc 
$ ld -shared -o R_link.so R_link.o -lstdc++ 
$ R 
 
R : Copyright 1997, Robert Gentleman and Ross Ihaka 
Version 0.50 Alpha-3 (August 8, 1997) 
 
R is free software and comes with ABSOLUTELY NO WARRANTY. 
You are welcome to redistribute it under certain conditions. 
Type "license()" for details. 
 
[Previously saved workspace restored] 
 
> A 
           [,1]       [,2]       [,3] 
[1,] -0.2713707 -1.1715863  0.8884861 
[2,] -1.7103328  0.6957497 -0.7603538 
> B 
          [,1]      [,2]       [,3] 
[1,] -1.573575 0.1554325 -1.1013854 
[2,] -1.151815 0.1632211 -0.4710143 
> A+B 
          [,1]       [,2]       [,3] 
[1,] -1.844946 -1.0161538 -0.2128993 
[2,] -2.862148  0.8589708 -1.2313680 
> dyn.load("R_link.so") 
> .C("my_mat_sum", A, B, as.integer(dim(A)))[[1]] 
A on input: 2 3 
-0.271371 -1.17159 0.888486  
-1.71033 0.69575 -0.760354  

B on input: 2 3 
-1.57357 0.155432 -1.10139  
-1.15181 0.163221 -0.471014  
 
Sum: 2 3 
-1.84495 -1.01615 -0.212899  
-2.86215 0.858971 -1.23137  
 
          [,1]       [,2]       [,3] 
[1,] -1.844946 -1.0161538 -0.2128993 
[2,] -2.862148  0.8589708 -1.2313680 
> q() 
Save workspace image? [y/n/c]: n 

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 20 22:31:07 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 Aug 1997 14:31:07 -0700 (PDT)
Subject: R-alpha: names for .RData
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970820141956.24129B-100000@chekov>


It would be nice for the save file name .RData to be a variable in
config.site (unless the machine-independent files are coming very soon). 
We are currently running R on a cluster with both sparc-solaris and
intel-linux machines, which don't like each other's .RData files.  At the
moment I edit the source files by hand to change the name to .RData-linux.

On a related topic, has anyone given any more thought to installing
multiple binaries in the same directory tree (as suggested some time ago
by Greg Warnes)?  This could save quite a lot of space as well as making
it easier to keep different operating systems synchronised. 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 21 08:40:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 21 Aug 1997 09:40:08 +0200
Subject: R-alpha:  [logical, drop = FALSE] -- my silliness ..
In-Reply-To: <Pine.SUN.3.95.970820101359.641C-100000@chekov> (message from
 Thomas Lumley on Wed, 20 Aug 1997 10:21:25 -0700 (PDT))
Message-ID: <199708210740.JAA03263@sophie.ethz.ch>

I must have been a bit tired or screwed up otherwise:
As Thomas guessed, I've forgotten the extra ","  which is needed for drop=..

ma[logi, , drop = FALSE]	works all right.
        ^^^
	do not forget this !

 MM> Look at this :
 MM> 
 MM> ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
 MM> ma[logi,]
 MM> ##>      [,1] [,2]
 MM> ##> [1,]    1    1
 MM> ##> [2,]    1    3
 MM> ##> [3,]    1    5
 MM> ##> [4,]    1    7
 MM> 
 MM> ##-- now the same with  [ , drop = FALSE]
 MM> 
 MM> ## R (-0.50-a3) :
 MM> 
 MM> 	 ma[logi, drop = F]
 MM> ##>> Error: invalid subscript type
 MM> ## Splus-3.4:
 MM> 	 ma[logi, drop = F]
 MM> ##>> [1] 1 1 1 1 1 3 5 7
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Thu Aug 21 08:44:35 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 21 Aug 1997 09:44:35 +0200 (MET DST)
Subject: R-alpha: thoughts on batch and fortran
Message-ID: <9708210744.AA13701@alpha.luc.ac.be>

Batch:
  For me, batch in its present state is broken and useless. My primary
need for batch is to produce a final output file of a session after I
have worked out a sequence of procedures. I save my instructions in a
file that I can source, then run it in batch to have a copy of input
and output together. (If there was a log file (or dribble), this
problem would be solved.) At present, there are two problems with batch:
(1) I always run R interactively with saving the .RData shut off. This
is not possible in batch. Robert promised that it would be changed in
R0.14 but that never occurred so I am obliged to modify the C code of
each new version of R to avoid the problems of rereading .RData that I
described at that time.
(2) In any case, since 0.49, I cannot use batch because, as soon as
it hits a plot instruction, it stops with an error.

Fortran:
  I think that, if .Fortran is to exist, then the full fortran library
(except I/O) should be available, not just those functions required by
the basic R. I am thinking in particular of the complex functions that
I require for Kalman filtering in carma (soon to be released as a
dynamic library). Having the full f2c library linked in (-lf2c, when it
works under Linux - see the recent comments of my son, Patrick) does
not take more space unless it is actually used because it is dynamic.
carma will not work without these functions so how can I release
something that will not work for most users?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 21 10:44:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 21 Aug 1997 21:44:05 +1200 (NZST)
Subject: R-alpha: thoughts on batch and fortran
Message-ID: <199708210944.VAA22730@stat1.stat.auckland.ac.nz>

	From r-devel-owner@stat.math.ethz.ch Thu Aug 21 19:40 NZS 1997
	From: Jim Lindsey <jlindsey@luc.ac.be>
	Subject: R-alpha: thoughts on batch and fortran
	To: r-devel@stat.math.ethz.ch (r-devel)
	Date: Thu, 21 Aug 1997 09:44:35 +0200 (MET DST)

	Batch:
	  For me, batch in its present state is broken and useless. My primary
	need for batch is to produce a final output file of a session after I
	have worked out a sequence of procedures. I save my instructions in a
	file that I can source, then run it in batch to have a copy of input
	and output together. (If there was a log file (or dribble), this
	problem would be solved.) At present, there are two problems with batch:
	(1) I always run R interactively with saving the .RData shut off. This
	is not possible in batch. Robert promised that it would be changed in
	R0.14 but that never occurred so I am obliged to modify the C code of
	each new version of R to avoid the problems of rereading .RData that I
	described at that time.

The problem is that we had requests both ways - i.e. saving and not
saving.  Sorry, but we can't do it both ways.  But, if you end your
input file with
	q(save=FALSE)
you will get the effect you want.

	(2) In any case, since 0.49, I cannot use batch because, as soon as
	it hits a plot instruction, it stops with an error.

If you are plotting you will need to be running a device driver
of some sort.  In batch we don't automatically run any.
You can put either
	x11()
or
	postscript()
at the top of the file you are running to get a driver started.
Perhaps I will look at creating a "dummy" do-nothing driver which
will be run by default in batch mode.

	Fortran:
	I think that, if .Fortran is to exist, then the full fortran library
	(except I/O) should be available, not just those functions required by
	the basic R. I am thinking in particular of the complex functions that
	I require for Kalman filtering in carma (soon to be released as a
	dynamic library). Having the full f2c library linked in (-lf2c, when it
	works under Linux - see the recent comments of my son, Patrick) does
	not take more space unless it is actually used because it is dynamic.
	carma will not work without these functions so how can I release
	something that will not work for most users?

We've been talking about this a bit - its a general problem.
I will look and see if we can package the f2c library as an R library.
Then we could say
	library("f2c")
	library("carma")
I don't know if this will work - i.e. whether functions in carma.so
will "see" functions in f2c.so.  If I get a second in the next couple of
days I will try the experiment.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 21 11:08:25 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 21 Aug 1997 12:08:25 +0200
Subject: R-alpha: thoughts on batch (stop on error)
In-Reply-To: <199708210944.VAA22730@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Thu, 21 Aug 1997 21:44:05 +1200 (NZST))
Message-ID: <199708211008.MAA03618@sophie.ethz.ch>

Batch:
	Several of us still would like either a command option or 
		[better, but more complicated;
		 this would also be available in non-Batch) an  ]
        an
		options(error.handling = ...)

	option to turn-off the behavior that Batch mode stops on error.

 (It's good that batch stops on error by default,
  however in some cases we'd want to override this default !)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 21 11:19:50 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 21 Aug 1997 22:19:50 +1200 (NZST)
Subject: R-alpha: libf2c as a shared library
Message-ID: <199708211019.WAA22920@stat1.stat.auckland.ac.nz>

Ok, I did the following experiment

	dyn.load("/usr/local/lib/libf2c.so.2.0")
	dyn.load("try.so")
	.Fortran("try", 10.5)

where try.so contains the following compiled subroutine

	subroutine try(x)
        double precision x
        write(*,*) x
        return
        end

It worked just fine (at least here on my FreeBSD machine at home).
So it seems that it will be easy to make all of f2c available,
including the all the IO stuff.

It should be easy to package the libf2c sources as an R library.
I'm hesitant to put it into the core R distribution, because it
adds a lot of source, although this would ensure that it was always
available.

So, should it go in the R core, or to CRAN?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 14:13:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 21 Aug 1997 15:13:02 +0200
Subject: R-alpha: libf2c as a shared library
In-Reply-To: Ross Ihaka's message of Thu, 21 Aug 1997 22:19:50 +1200 (NZST)
References: <199708211019.WAA22920@stat1.stat.auckland.ac.nz>
Message-ID: <x267szvfvl.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> It should be easy to package the libf2c sources as an R library.
> I'm hesitant to put it into the core R distribution, because it
> adds a lot of source, although this would ensure that it was always
> available.
> 
> So, should it go in the R core, or to CRAN?
> 	Ross

CRAN. Linuxites have in their distributions already, for instance.
Nothing good will come from having it twice. Possibly in different
versions... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 14:19:34 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 21 Aug 1997 15:19:34 +0200
Subject: R-alpha: axes & plot boundary
Message-ID: <x24t8jvfkp.fsf@bush.kubism.ku.dk>

I don't rcall seeing this one reported before:

plot(...,axes=F) 

removes not only the axes, but also the plot boundary. The 'bty'
parameter loses its effect completely. getting it back seems to
require fiddling with par("usr") and rect() or lines()

(Linux, Alpha-3)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Thu Aug 21 15:00:28 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 21 Aug 1997 16:00:28 +0200
Subject: R-alpha: libf2c as a shared library
Message-ID: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>

At 15:15 21/08/97, p.dalgaard@kubism.ku.dk wrote:
>Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
>
>> It should be easy to package the libf2c sources as an R library.
>> I'm hesitant to put it into the core R distribution, because it
>> adds a lot of source, although this would ensure that it was always
>> available.
>> 
>> So, should it go in the R core, or to CRAN?
>> 	Ross
>
>CRAN. Linuxites have in their distributions already, for instance.
>Nothing good will come from having it twice. Possibly in different
>versions... 

I agree. The require function is designed to take care of this situation
surely? Indeed, there is already a contributed library (survival) which
depends on another contributed library (splines).

Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Thu Aug 21 16:34:08 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 21 Aug 1997 10:34:08 -0500 (CDT)
Subject: R-alpha: thoughts on batch and fortran
In-Reply-To: <199708210944.VAA22730@stat1.stat.auckland.ac.nz> from "Ross Ihaka" at Aug 21, 97 09:44:05 pm
Message-ID: <9708211534.AA21276@nokomis.stat.umn.edu>

> We've been talking about this a bit - its a general problem.
> I will look and see if we can package the f2c library as an R library.
> Then we could say
> 	library("f2c")
> 	library("carma")
> I don't know if this will work - i.e. whether functions in carma.so
> will "see" functions in f2c.so.  If I get a second in the next couple of
> days I will try the experiment.
> 	Ross

In UNIX you have two choices. You do it this way, or you can establish
the connection to dependent libraries at link time by your systems
variant of

	ld -shared -o carma carma.o -lf2c

when you create your carma shared library and then

	library("carma")

within R. In either case libf2c.so should only be loaded once. On
NT/Win95 I *think* you essentially only have the second choice. I
don't believe a DLL can have any undefined symbols that are resolved
into the running executable or other DLL's ar run time (I'm not
certain about this but is would be easy to check). If I'm right, it
would probably be best to recommend doing things the second way on all
systems just for consistency. I don't know how the Mac shared library
manager works, but I suspect it it more like the way I think NT/Win95
work.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 21 17:10:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 21 Aug 1997 09:10:03 -0700 (PDT)
Subject: R-alpha: thoughts on batch and fortran
In-Reply-To: <9708210744.AA13701@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970821085541.7394A-100000@chekov>

On Thu, 21 Aug 1997, Jim Lindsey wrote:
> Fortran:
>   I think that, if .Fortran is to exist, then the full fortran library
> (except I/O) should be available, not just those functions required by
> the basic R. I am thinking in particular of the complex functions that
> I require for Kalman filtering in carma (soon to be released as a
> dynamic library). Having the full f2c library linked in (-lf2c, when it
> works under Linux - see the recent comments of my son, Patrick) does
> not take more space unless it is actually used because it is dynamic.
> carma will not work without these functions so how can I release
> something that will not work for most users?

I don't think it's as simple as this.  If you can assume all users have
libf2c then your carma Makefile can link it with -lf2c.  This would be
ideal as I think some versions of Unix do still load libraries when the
program loads, whether or not they are actually used.

The real problem comes with machines that don't have f2c.  Most of our
machines here don't, for example, as we tend to use real Fortran when we
want it.  We currently don't assume that everyone has f2c as then we would
not need to distribute C versions of Fortran code. This would have the
added advantage that people who use real Fortran don't have to load
libf2c. 

If we don't assume that everyone has f2c then people distributing
libraries need to distribute all or part of libf2c. Source to libf2c is
readily available. 

I asked for opinions on this question a while back and didn't get any.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 21 18:31:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 21 Aug 1997 13:31:59 -0400
Subject: R-alpha: f2c
Message-ID: <97Aug21.133451edt.26498@mailgate.bank-banque-canada.ca>


> If we don't assume that everyone has f2c then people distributing
> libraries need to distribute all or part of libf2c. Source to libf2c is
> readily available. 

I'm a bit confused about this discussion, but since I don't have f2c on
the computer I've been using the past week, I assume most of the
necessary parts on this library have been distributed with R (but I
can't find them). I have been compiling the C version of my code,
generated with f2c on another machine, and almost everything seems to
be working. I am having trouble with pow_dd, pow_ii and pow_ri.

If there are truely only a few important routines missing then it would
be a lot easier for people distributing libraries to have those pieces
added to the R distribution.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: ECDFs
In-Reply-To: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
References: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
Message-ID: <199708212102.XAA03945@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 19 Aug 1997, Kurt Hornik wrote:
>> 
>> Here's something what is needed for teaching elementary statistics:
>> Given a sample vector x, compute the corresponding ECDF, plot it, and
>> perhaps evaluate it at points other than the data points.

> The approx() function is supposed to do this (it currently only does
> linear interpolation).  If the right and left continuous step
> functions were added to approx then we could easily use approxfun to
> define the ECDF as a function closure, making it automatically
> available at any point you want. After all, the ECDF *is* a function.

Ah, very nice idea!

So, we'd have

	ecdf(x)

return a FUNCTION of class (e.g.) "step" which would on the one hand
have the right methods for it and on the other hand would allow us to
evaluate it at new points right away?

Martin, Peter?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <Pine.SUN.3.95.970812093005.777B-100000@spock>
References: <199708121323.PAA02620@sophie.ethz.ch>
 <Pine.SUN.3.95.970812093005.777B-100000@spock>
Message-ID: <199708212102.XAA03944@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 12 Aug 1997, Martin Maechler wrote:
>> 
>> As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
>> namely "Termination upon 'error'".
>> 
>> I think this is THE good default behavior for "batch mode".
>> However
>> 1) for several purposes I'd very much want an option to change this
>> default behavior.
> Hear, hear!

>> 
>> I think it'd be very neat then if
>> options(error.stop = FALSE)
>> actually translated all errors [stop(.)] to warnings [warning()].
>> 

> I'm not convinced.  Being able to make warnings fatal is a good option,
> but being able to continue after errors may make no sense.   How do you
> continue after subscript out of bounds, or argument missing with no
> default, or memory exhausted or ...

> You may well need to jump back to the top level before it makes sense to
> continue.  On the other hand, once at the top level it is certainly
> possible to proceed, and so there should be an option to do it.

There is an obvious trade-off between having a lot of flexibility and
simple too many options :-)

I am not sure about making warnings fatal.  E.g., code for chisquare
tests usually displays a warning if the approximation may be bad.  That
should never be fatal, though ...

Re termination upon error, couldn't there be situations with a huge
simulation loop where one could still do something useful after
e.g. running out of memory?

If I unterstand Martin correctly, the extra options() come into being
only because command-line options are hard to port to point-and-click
interfaces ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: new class for chisquare tests?
Message-ID: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at>

I sort of asked this before, but perhaps not explicitly enough.

In my ctest collection, there are several chisquare-based tests.  For
some of them, it may be useful to also return information on expected
(and observed) counts.  The question is, how should this be done.  Of
course, there is no problem adding the corresponding components to the
list returned by the functions.  However, as these are of class `htest',
the components don't show up in the printed output.

(Of course, one can easily obtain them if they are in the list, but I
think Peter is with me when I say that this is not the right thing in an
intro course.)

* Should we extend print.htest() to display info on expected and
observed counts in case it is there?

* (Should we have an extra argument to control this behavior?)

* Or should there be a class "chisqtest" with a slightly different print
and perhaps also summary method?

* Or ...?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: Mutivariate Analysis
In-Reply-To: <199612022355.MAA17838@stat13.stat.auckland.ac.nz>
References: <199612022355.MAA17838@stat13.stat.auckland.ac.nz>
Message-ID: <199708212102.XAA03947@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> I have got a little side-tracked (from graphics) and am putting
> together a little multivariate analysis library.  This is just
> intended to be a "core" library rather than anything exhaustive.
> Mainly it is a matter of putting togther code which already exists at
> StatLib.  Here is my present list (only some of which is finished).

>  1. Principal Components
>     prcomp
	
>  2. Clustering
>     dist, hclust, plclust, subtree, cutree
>     kmeans

>  3. Canonical correlations (is this ever used?)
>     cancor

>  4. Scaling
>     cmdscal, sammon, isoscal

>  5. Graphics
>     (Optimal) profile plots
>     biplots
>     stars etc
>     A bunch of Michael Friendly's stuff converted from SAS

>  6. Discriminant analysis
>     discr (a real one which takes prior probs and returns posterior
>     ones) 

> I would also like to use the object facility so that printing,
> plotting etc is done with generic functions; e.g. plot(prcomp(x))
> should produce a scree plot, coef(prcomp(x)) should deliver the
> loadings - plclust() should also really be plot.hclust().

Yes I know this is a very old mail from Ross ...

I have two questions.

* Is the (already existing) plot.hclust() already a replacement for
plclust()?  (I.e., could we add

	plclust <- function(...) plot.hclust(...)

for compatibility purposes?)

* I'd be very much interested in some of the functions that are not yet
in the current `mva'.  Has there been any work on this one lately?  How
can we help?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:07 +0200
Subject: R-alpha: a question on terminology
Message-ID: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at>

Whereas we typically refer to the add-on `modules' as `libraries' (viz
also the way these are represented in the search list, and the variable
.Libraries), S speaks about `sections'.

Shall we stay with our terminology?  Or instead, speak of `sections',
`packages', `modules', ...?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:07 +0200
Subject: R-alpha: another ctest question
Message-ID: <199708212102.XAA03949@aragorn.ci.tuwien.ac.at>

I have the following problem.  Consider a `classical' test which works
for k .ge. 2 samples.  Possible interfaces are e.g.

	xxx.test(x, g)	    x ... all data, g ... corresponding groups
	xxx.test(x1, ..., xk)
	xxx.test(list(x1, ..., xk))

etc etc.

Clearly, the first and the second one are nice, but cannot be combined
without making `g' (i.e., `group') a named argument.

Hence, in e.g. my current version of kruskal.test() I've combined the
first (by compatibility with S-PLUS) and third interfaces.  Perhaps this
is not optimal, though ...

What I'd like to do now is to extend var.test() as follows.

* With one data arg, perform a chisq-based test for a certain value of
the variance, as specified by an optional var argument
* With two data args, do the usual F test
* With more than two data args, perform some test for the homogeneity of
variances, as specified by an optional method (default "Bartlett") arg.

What is the right interface then?  Should we have

  var.test(x, y = NULL, ..., group = NULL, alternative = "two.sided",
	   conf.level = 0.95, var = 1, ratio = 1, method = "Bartlett")

???

If so, should the interface to kruskal.test be changed accordingly?

Please advise me here.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 23:13:15 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 00:13:15 +0200
Subject: R-alpha: new class for chisquare tests?
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:06 +0200
References: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at>
Message-ID: <x2203nfamc.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> I sort of asked this before, but perhaps not explicitly enough.
> 
> In my ctest collection, there are several chisquare-based tests.  For
> some of them, it may be useful to also return information on expected
> (and observed) counts.  The question is, how should this be done.  Of
> course, there is no problem adding the corresponding components to the
> list returned by the functions.  However, as these are of class `htest',
> the components don't show up in the printed output.
> 
> (Of course, one can easily obtain them if they are in the list, but I
> think Peter is with me when I say that this is not the right thing in an
> intro course.)
> 
> * Should we extend print.htest() to display info on expected and
> observed counts in case it is there?
> 
> * (Should we have an extra argument to control this behavior?)
> 
> * Or should there be a class "chisqtest" with a slightly different print
> and perhaps also summary method?
> 
> * Or ...?

Couldn't the basic logic of print.lm/summary.lm/anova.lm be applied
here too? I.e.

h<-chisquare.test(blipblop)
observed(h)
fitted(h)
partials(h)

This might be implemented simply by adding items to the return list,
and have fitted.htest() extract the relevant item if it is there.

Or maybe slightly safer from a name-space point of view: add *one*
extra item ("comp", say) which is a list containing the other stuff.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 23:48:30 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 00:48:30 +0200
Subject: R-alpha: ECDFs
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:06 +0200
References: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
 <199708212102.XAA03945@aragorn.ci.tuwien.ac.at>
Message-ID: <x2zpqbduf5.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Thomas Lumley writes:
> 
> > On Tue, 19 Aug 1997, Kurt Hornik wrote:
> >> 
> >> Here's something what is needed for teaching elementary statistics:
> >> Given a sample vector x, compute the corresponding ECDF, plot it, and
> >> perhaps evaluate it at points other than the data points.
> 
> > The approx() function is supposed to do this (it currently only does
> > linear interpolation).  If the right and left continuous step
> > functions were added to approx then we could easily use approxfun to
> > define the ECDF as a function closure, making it automatically
> > available at any point you want. After all, the ECDF *is* a function.
> 
> Ah, very nice idea!
> 
> So, we'd have
> 
> 	ecdf(x)
> 
> return a FUNCTION of class (e.g.) "step" which would on the one hand
> have the right methods for it and on the other hand would allow us to
> evaluate it at new points right away?
> 
> Martin, Peter?
> 

Neat idea. And - hey! - someone has made it possible to assign classes
to a function now. I looked into that a while ago with a view to kill
off the antipedagogical habit that R and S has of dumping screenfulls
of gibberish on the unsuspecting newbie. At that time, it wasn't
possible so I dropped it, meaning to take it up on the list later on.

That would be like

print.function<-function(f)cat("Use 'show' to see content of function\n")
show<-unclass

Hmm. Do we want something like this? It clashes a little with other
uses of function classes, but not badly as far as I can see.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 00:11:18 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 01:11:18 +0200
Subject: R-alpha: another ctest question
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:07 +0200
References: <199708212102.XAA03949@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb5vdtd5.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> I have the following problem.  Consider a `classical' test which works
> for k .ge. 2 samples.  Possible interfaces are e.g.
> 
> 	xxx.test(x, g)	    x ... all data, g ... corresponding groups
> 	xxx.test(x1, ..., xk)
> 	xxx.test(list(x1, ..., xk))
> 
> etc etc.
> 
> Clearly, the first and the second one are nice, but cannot be combined
> without making `g' (i.e., `group') a named argument.

I'm sort of beginning to like the list(...) construction. It might
also allow one to assign meaningful tags to the variables (as in
kruskal.test(list(bp.males=dataframe$bp[dataframe$sex==1],bp.females=....)

>   var.test(x, y = NULL, ..., group = NULL, alternative = "two.sided",
> 	   conf.level = 0.95, var = 1, ratio = 1, method = "Bartlett")
> 
> ???
> 
> If so, should the interface to kruskal.test be changed accordingly?
> 
> Please advise me here.
> 

You won't gain much above (pardon the sketchy code)

var.test(x,g = NULL,..etc..)
if (is.list(x))
	g<-...
	x<-c(x)

if( g == NULL) ng<-1 else ng<-length(unique(g[nonmiss])) 
if (ng == 1)
	..
else if (ng == 2)
	..
else
	..

I'd say that the real issue is whether t.test should be supplied with
a group= parameter?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 02:27:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 13:27:59 +1200 (NZST)
Subject: R-alpha: axes & plot boundary
In-Reply-To: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
References: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
Message-ID: <199708220127.NAA28846@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > I don't rcall seeing this one reported before:
 > 
 > plot(...,axes=F) 
 > 
 > removes not only the axes, but also the plot boundary. The 'bty'
 > parameter loses its effect completely. getting it back seems to
 > require fiddling with par("usr") and rect() or lines()

This S compatible.  You can get the box after by saying
	box()
Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 07:40:25 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 08:40:25 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708212102.XAA03944@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:06 +0200)
Message-ID: <199708220640.IAA20151@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Thomas Lumley writes:
    >> On Tue, 12 Aug 1997, Martin Maechler wrote:
    MM>  As Thomas Lumley has noted before, the behavior in 'batch mode'
    MM> has changed; namely "Termination upon 'error'".
    MM> 
    MM> I think this is THE good default behavior for "batch mode".
    MM> However 1) for several purposes I'd very much want an option to
    MM> change this default behavior.
    >> Hear, hear!

    MM>  I think it'd be very neat then if options(error.stop = FALSE)
    MM> actually translated all errors [stop(.)] to warnings [warning()].
    MM> 

    >> I'm not convinced.  Being able to make warnings fatal is a good
    >> option, but being able to continue after errors may make no sense.
    >> How do you continue after subscript out of bounds, or argument
    >> missing with no default, or memory exhausted or ...

    >> You may well need to jump back to the top level before it makes
    >> sense to continue.  On the other hand, once at the top level it is
    >> certainly possible to proceed, and so there should be an option to
    >> do it.

    Kurt> There is an obvious trade-off between having a lot of flexibility
    Kurt> and simple too many options :-)

I don't quite see (the ":-)").
The non-expert user just changes options like 'digits' and 'width'
and leaves the others alone.

    Kurt> I am not sure about making warnings fatal.  E.g., code for
    Kurt> chisquare tests usually displays a warning if the approximation
    Kurt> may be bad.  That should never be fatal, though ...
The option exists in S.
It can be very useful for debugging purposes (and that't about it):
If you call a top level function  / a for loop which in certain
circumstances produces warnings that look funny to you, and somehow it's
hard to detect when / why the warnings are produced.

Now you (temporarily) make warnings fatal, and also add something like
options(error = 'dump.frames')  or an "on.exit(browser())".
You will now be able to quickly find and debug the circumstances under
which the warnings were produced.....


    Kurt> Re termination upon error, couldn't there be situations with a
    Kurt> huge simulation loop where one could still do something useful
    Kurt> after e.g. running out of memory?
sure.
As I (and others) said, there are other situations where you just want to
run a source.R file through R and you don't care if somewhere an
unimportant variable is not defined, a graphics device is not open,....

    Kurt> If I unterstand Martin correctly, the extra options() come into
    Kurt> being only because command-line options are hard to port to
    Kurt> point-and-click interfaces ...

This would be the main reason.

I think it's just 'neater' to have many things as part of R core,
instead of part of the OS-interface [to where command line options belong].

On the other hand, currently I (still) can't imagine myself moving off an
Unix based OS. Therefore, I'd be happy with a command line option which
turns off 'stop on error' in batch mode.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 07:59:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 08:59:34 +0200
Subject: R-alpha: class for chisquare tests; Thoughts on print & summary
In-Reply-To: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:06 +0200)
Message-ID: <199708220659.IAA20154@sophie.ethz.ch>

Kurt,
I think we hopefully are coming to an agreement that

	1)  your ctest collection should make its way into 'R core'
		((and you are the one who can make it happen now ..))
	2)  it should remain S-plus downward compatible as much as
	    reasonably possible.

My conclusions:
	a. keep class 'htest'
	b. extend  print.htest  (AND  summary.htest !)
	   to make it possible to display your extra info.
        b2. Yes, add extra arguments to print.htest / summary.htest to
	   control this behavior.
	 [this is also done for the correlation matrix
	  in print.summary.lm in S (not yet in R ..)]

alternatively, you would make a new class  'chisqtest' but give your test
results BOTH classes  
	class(res) <- c("chisqtest","htest")
Such that you can use 'htest' methods in general, and just one
	print.chisqtest
in particular.



General note on  'print' (and 'summary') methods:
~~~~~~~~~~~~      =====     
1) I think we should keep to the S convention that EVERY print method
   semantically acts as

    print.foo <- function(x,.........) {

	    .........

	    invisible(x)
    }

	[[a few days ago, I've patched print.lm (?I think) in order to do this]]

2) For summary, there are two approaches 
   
	A. Just print summary information  AND  return something useful.

	B. Don't print anything in summary.foo but return an object of 
	   CLASS  'summary.foo'
	   
	   AND write a method  print.summary.foo  
	   which nicely prints the  summary.foo information and
		[see remark '1)' on "print"] invisibly returns its object.

   Approach 'B' is THE way to go useful for "big" things like 'lm'.
   IMHO it should be used in general as soon as quite a bit of "computing"
   is involved ("computing" is NOT computer intensive; just things that are
   tedious to re-type).
	
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 09:21:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 20:21:14 +1200 (NZST)
Subject: R-alpha: class for chisquare tests; Thoughts on print & summary
Message-ID: <199708220821.UAA23531@stat1.stat.auckland.ac.nz>

	From: Martin Maechler <maechler@stat.math.ethz.ch>
	To: Kurt.Hornik@ci.tuwien.ac.at
	CC: R-devel@stat.math.ethz.ch
	Subject: Re: R-alpha: class for chisquare tests; Thoughts on print & summary

	Kurt,
	I think we hopefully are coming to an agreement that

		1)  your ctest collection should make its way into 'R core'
			((and you are the one who can make it happen now ..))

By all means - throw the present versions away and add yours.
We may have to move to an inner and outer core if the core grows too
big.

		2)  it should remain S-plus downward compatible as much as
		    reasonably possible.

For functions which are not going to be building blocks such compatibility
is less important.  Better to do it "right".

	        b2. Yes, add extra arguments to print.htest / summary.htest to
		   control this behavior.
		 [this is also done for the correlation matrix
		  in print.summary.lm in S (not yet in R ..)]

[ Actually I think that we just have a different default value for the
corr= argument.  If you'd like this changed just say.  I just don't
find the correlations that informative. ]

I'm reviewing the "lm" methods at present because thats what I'm
teaching at present.  I have an "lm.predict" about ready to roll,
but am a bit hung up on trying to propagate case names through
"model.frame", which in turn is inducing an sidetrack into
[<- etc etc ...

	alternatively, you would make a new class  'chisqtest' but give
	your test results BOTH classes  
		class(res) <- c("chisqtest","htest")
	Such that you can use 'htest' methods in general, and just one
		print.chisqtest
	in particular.

I'd probably try to avoid making a separate class for every kind of
test result and try to build methods for the general case.  This would
make implementing new tests easier as well as imposing the same
general structure on the output.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 09:24:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 10:24:56 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:07 +0200)
Message-ID: <199708220824.KAA26083@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
    Kurt> also the way these are represented in the search list, and the variable
    Kurt> .Libraries), S speaks about `sections'.
[.Libraries are not used anymore and will be gone in the next version.
 library

    Kurt> Shall we stay with our terminology?
I think so.
Or use something which S does not use at all,
since 'require(.);  provide(.)' and  Thomas Lumley's  
autoload(..) features enable an entirely different approach.

    Kurt>  Or instead, speak of `sections',
    Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
    Kurt> `packages', `modules', ...?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 09:39:32 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 10:39:32 +0200
Subject: R-alpha: axes & plot boundary
In-Reply-To: Ross Ihaka's message of Fri, 22 Aug 1997 13:27:59 +1200 (NZST)
References: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
 <199708220127.NAA28846@stat1.stat.auckland.ac.nz>
Message-ID: <x2bu2qvcfv.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Peter Dalgaard BSA writes:
>  > I don't rcall seeing this one reported before:
>  > 
>  > plot(...,axes=F) 
>  > 
>  > removes not only the axes, but also the plot boundary. The 'bty'
>  > parameter loses its effect completely. getting it back seems to
>  > require fiddling with par("usr") and rect() or lines()
> 
> This S compatible.  You can get the box after by saying
> 	box()

By golly! So it is. Sorry. That is the trouble with working from home
and not having Splus around...

Actually, I did look for something that did what box() does, but
couldn't find it off-hand. It isn't really obvious where to look.

When we get around to finishing the plot() man page, let's try to
remember to add a short note on axes=F. Something like

"
axes=F removes the axes and the plot boundary. Use 'axis'
and 'box' to add them later.
"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 09:34:26 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 20:34:26 +1200 (NZST)
Subject: R-alpha: a question on terminology
Message-ID: <199708220834.UAA23628@stat1.stat.auckland.ac.nz>

I like "packages".  Modules have namespace implications which the
present setup does not provide.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 10:17:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 11:17:34 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:07 +0200)
Message-ID: <199708220917.LAA26226@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
    Kurt> also the way these are represented in the search list, and the variable
    Kurt> .Libraries), S speaks about `sections'.
[.Libraries are not used anymore ...
 search() & .Provided should be enough, ...]

    Kurt> Shall we stay with our terminology?
I think so.

    Kurt>  Or instead, speak of `sections',
    Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
    Kurt> `packages', `modules', ...?

Or use something which S does not use at all,
since 'require(.);  provide(.)' and  Thomas Lumley's  
autoload(..) features enable an entirely different approach.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 10:52:21 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 11:52:21 +0200
Subject: R-alpha: names for .RData
In-Reply-To: <Pine.SUN.3.95.970820141956.24129B-100000@chekov>
References: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
 <Pine.SUN.3.95.970820141956.24129B-100000@chekov>
Message-ID: <199708220952.LAA04284@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> It would be nice for the save file name .RData to be a variable in
> config.site (unless the machine-independent files are coming very
> soon).  We are currently running R on a cluster with both
> sparc-solaris and intel-linux machines, which don't like each other's
> .RData files.  At the moment I edit the source files by hand to change
> the name to .RData-linux.

I thought by switching to the new format (XDR?) this would no longer be
a problem?

> On a related topic, has anyone given any more thought to installing
> multiple binaries in the same directory tree (as suggested some time ago
> by Greg Warnes)?  This could save quite a lot of space as well as making
> it easier to keep different operating systems synchronised. 

There was some discussion a time ago.  Let me try to summarize it in my
own biased way.

* In general, we have two ways of arranging the `library' tree.  One is,
grouped according to module, the other, according to type.  I.e.,

	library/<module>/
	library/<module>/funs/
	library/<module>/help/
	library/<module>/html/
	library/<module>/rman/
	library/<module>/objs/<platform>

etc or

	library/funs/<module>
	...
	library/objs/<platform>/<module>

Given that we also have architecture-dependent things in the library, I
would suggest to adopt the former strategy (similar to Emacs) and not
the latter as e.g. in the TeX Directory Standard.

* (As an aside, we could also discuss whether we want to have several
versions of R installed simultaneously.  This would imply having

	RHOME/<version_1>/...
	RHOME/<version_2>/...
	...
	RHOME/<site>

with all potential problems of such.)

* Similarly, there should not be any problem with having

	RHOME/bin/R-<platform>

instead of

	RHOME/bin/R.binary

* The first question is, what EXACTLY is `platform'?  E.g., the GNU
Coding Standards would imply the triplet

	MACHINE-VENDOR-OS

whereas e.g. the Debian GNU/Linux standards tell you to use

	MACHINE-OS

(e.g., `i386-linux') ...

* The main question is, how is the right platform determined at runtime?
I've had some discussions here (forgot who with) where I claimed that
this is not possible from the shell alone.  E.g., on my current system
the output of `uname -a' is

	Linux teddy 2.0.27 #2 Sun Dec 22 22:12:46 MET 1996 i586 unknown

and if someone had compiled R on an i386 I'd be nowhere.  The same
applies for shell variables such as OSTYPE and MACHTYPE, which don't
seem to be POSIX anyway.

* Hence, I think the right things to do are

** Either have several scripts in RHOME/bin, and have links to these
from somewhere in PATH (which sounds a bit stupid)

** Have a simple shell wrapper installed in the PATH which calls the
real one passing the PLATFORM information.  If this sounds confusing,
the idea is the following.  Suppose we install in /usr/local (and that
/usr/local/bin is not shared among platforms).  Then RHOME would be

	/usr/local/lib/R

with

	/usr/local/lib/R/bin/R			# shell script
	/usr/local/lib/R/bin/R-<platform>	# binaries ...

and

	/usr/local/bin/R

would contain

	exec /usr/local/lib/R/bin/R -p PLATFORM $*

and `PLATFORM' is what was determined at compile time.

* I think this is the cleanest solution, and should not be too hard to
implement:

STEP 1.

** Introduce the -p argument (or whatever else) to the script.  Maybe do
something nice such as providing a `default' platform in the script,
such that those with a single-platform setup don't see any difference.

** Rename `R.binary' accordingly.

** Introduce a platform layer in `lib' (and perhaps rename it to `objs'
right away, PLEASE).

** Modify library.dynam() accordingly. (Not a problem, as we have the
`arch' and `os' elements of version() anyway.)

STEP 2.

The above does not create a platform wrapper (where should it put it?),
but single-platform sites won't know a difference (shell script has a
default), and multi-platform people can either have private aliases or
set up wrappers at the sysadmin level.

Eventually, there should be something like a real `make install' with
the installation tree different from the source/build tree.  Then, we
can generate a wrapper at compile time and install it to $(bindir) (the
runtime system will go into $(libdir), and the man page into $(mandir)).

****

That's all, folks.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 10:52:21 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 11:52:21 +0200
Subject: R-alpha: libf2c as a shared library
In-Reply-To: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>
References: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>
Message-ID: <199708220952.LAA04280@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> At 15:15 21/08/97, p.dalgaard@kubism.ku.dk wrote:
>> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
>> 
>>> It should be easy to package the libf2c sources as an R library.
>>> I'm hesitant to put it into the core R distribution, because it
>>> adds a lot of source, although this would ensure that it was always
>>> available.
>>> 
>>> So, should it go in the R core, or to CRAN?
>>> Ross
>> 
>> CRAN. Linuxites have in their distributions already, for instance.
>> Nothing good will come from having it twice. Possibly in different
>> versions... 

> I agree. The require function is designed to take care of this situation
> surely? Indeed, there is already a contributed library (survival) which
> depends on another contributed library (splines).

Hmm ... not so fast ...

Does this also affect the parts of f2c that are already come with R?
I.e., if compiled without a Fortran compiler and a shared libf2c is
found, would R be linked dynamically against that and a corresponding
statement added to the site-wide init file?

-k


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 11:37:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 12:37:36 +0200
Subject: R-alpha: apply()
Message-ID: <199708221037.MAA04898@aragorn.ci.tuwien.ac.at>

The following is identical in R and S, but still strange ...

R> apply(matrix(1:20, nc = 4), 1, table)
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    1    1    1    1
[2,]    1    1    1    1    1
[3,]    1    1    1    1    1
[4,]    1    1    1    1    1
R> apply(matrix(rep(1, 20), nc = 4), 1, table)
[1] 4 4 4 4 4
R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
[[1]]
1 3 7 
2 1 1 

[[2]]
2 4 6 8 
1 1 1 1

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Fri Aug 22 13:02:31 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 22 Aug 1997 14:02:31 +0200 (MET DST)
Subject: R-alpha: eigen
Message-ID: <9708221202.AA06994@alpha.luc.ac.be>

eigen(matrix(rep(1,9),ncol=3),only.values=T)

works repeatedly but eventually (after 3 or 4 goes) gave a core dump
of 11mb (I think only the first answer was right).

if I type
gc()
immediately after the first call, I get a core dump right away (this
might possibly be related to my huge core dumps with nlm)

eigen(matrix(rep(1,9),ncol=3))
core dumps immediately after the first call

Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 13:05:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 14:05:56 +0200
Subject: R-alpha: eigen
In-Reply-To: <9708221202.AA06994@alpha.luc.ac.be> (message from Jim Lindsey on
 Fri, 22 Aug 1997 14:02:31 +0200 (MET DST))
Message-ID: <199708221205.OAA26421@sophie.ethz.ch>

I cannot produce any core dump with these statements here ...

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> eigen(matrix(rep(1,9),ncol=3),only.values=T)

    Jim> works repeatedly but eventually (after 3 or 4 goes) gave a core dump
    Jim> of 11mb (I think only the first answer was right).

    Jim> if I type
    Jim> gc()
    Jim> immediately after the first call, I get a core dump right away (this
    Jim> might possibly be related to my huge core dumps with nlm)

    Jim> eigen(matrix(rep(1,9),ncol=3))
    Jim> core dumps immediately after the first call
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 13:16:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 14:16:51 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: <199708181405.QAA00632@sophie.ethz.ch> (message from Martin
 Maechler on Mon, 18 Aug 1997 16:05:18 +0200)
Message-ID: <199708221216.OAA26424@sophie.ethz.ch>

This is propagated to  R-devel in case anyone else has a comment on this :

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

  MM> On Aug. 14,
  MM> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

  Ross> Re the emacs stuff:

  MM> ...

  Ross> 2. Peter Dalgaard made the suggestion that we made R source names
  Ross> end in ".R" in the source tree.  This seems like a good idea.  We
  Ross> might also consider making manual files end in .man so that it
  Ross> obvious what they are.

  MM> Kurt and me also would like to agree on a file extension for  
  MM> 'R man' files.

  MM> Either	.man  [PROBLEM: this extension is used in Unix
  MM> 			already for [t/n]roff style manual pages.
  MM> 			Emacs therefore switches to nroff mode for this
  MM> 			extension. That's why I wouldn't like it all.]

  MM> or	.Rd   [in S there are '.d' help files with roff-like syntax]
  MM> or	.Rman

Current status (between Kurt & me):
	
Kurt proposes
	.Rd
	.Rdoc
	.Rman     (in DEcreasing order of preference)

My own order of preference would be

	.Rman .Rd .Rdoc

which would result in '.Rd' as a fair compromise.
		       ===

Any other opinions / votes ?

-- MM
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 13:39:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 14:39:52 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708220917.LAA26226@sophie.ethz.ch>
References: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at>
 <199708220917.LAA26226@sophie.ethz.ch>
Message-ID: <199708221239.OAA05132@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
Kurt> also the way these are represented in the search list, and the variable
Kurt> .Libraries), S speaks about `sections'.

> [.Libraries are not used anymore ...
>  search() & .Provided should be enough, ...]

Kurt> Shall we stay with our terminology?

> I think so.

Kurt> Or instead, speak of `sections',
Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
Kurt> `packages', `modules', ...?

> Or use something which S does not use at all,
> since 'require(.);  provide(.)' and  Thomas Lumley's  
> autoload(..) features enable an entirely different approach.

Thanks to Martin and Ross for the immediate response.

Ross wrote,

> I like "packages".  Modules have namespace implications which the
> present setup does not provide.

I guess we have a decision then, and will refer to an `add-on' as a

	>>> PACKAGE <<<

E.g., the PACKAGE `mva', ...

(And hope than when R conquers the world there will be real modules.)

To make things consistent, could we PLEASE make the corresponding
changes so that search() shows

	"package:base"

rather than "library:base"?

Locations I found were

src/main/envir.c:
	STRING(ans)[n-1] = mkChar("library:base");

src/main/main.c:
	suicide("unable to open the base library\n");

and in src/library/base/funs/library

I will meanwhile change things in the FAQ accordingly.

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Aug 22 15:30:32 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 22 Aug 1997 10:30:32 -0400
Subject: R-alpha: RHOME
Message-ID: <97Aug22.103211edt.26506@mailgate.bank-banque-canada.ca>

> * In general, we have two ways of arranging the `library' tree.  One is,
> grouped according to module, the other, according to type.  I.e.,

> 	library/<module>/
> 	library/<module>/funs/
> 	library/<module>/help/

I find this a much better way to organize things. Old versions of
packages can be removed cleanly with

rm -r library/<package>

It also means that the userid for the maintainer of a package does not
necessarily need to be the userid of R.

> * (As an aside, we could also discuss whether we want to have several
> versions of R installed simultaneously.  This would imply having

> 	RHOME/<version_1>/...
> 	RHOME/<version_2>/...
>  ...
> * The main question is, how is the right platform determined at runtime?
>  ...

There seems to be an assumption here that RHOME will be the same no
matter what machine you are running on. I would set RHOME depending on
the machine, eg.

RHOME=/usr/local/lib/R-Sun4
RHOME=/usr/local/lib/R-Sun5
RHOME=/usr/local/lib/R-Linux386

and then use links to the XDR files and other files which are not
machine dependent, so they do not have to be duplicated.

Determining the platform universally may be fairly difficult, but at a
given site there is usually a fairly small mix of machines and it is
possible to write a shell script to determine the machine. In fact,
this is a pretty common problem and you are probably already doing it
in your .login or .chrc.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Fri Aug 22 17:20:43 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 22 Aug 1997 18:20:43 +0200
Subject: R-alpha: apply()
Message-ID: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>

At 12:42 22/08/97, kurt.hornik@ci.tuwien.ac.at wrote:

>The following is identical in R and S, but still strange ...
>
>R> apply(matrix(1:20, nc = 4), 1, table)
>     [,1] [,2] [,3] [,4] [,5]
>[1,]    1    1    1    1    1
>[2,]    1    1    1    1    1
>[3,]    1    1    1    1    1
>[4,]    1    1    1    1    1
>R> apply(matrix(rep(1, 20), nc = 4), 1, table)
>[1] 4 4 4 4 4
>R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
>[[1]]
>1 3 7 
>2 1 1 
>
>[[2]]
>2 4 6 8 
>1 1 1 1
>
>-k

It is strange, but logical.  The problem is that it's an undocumented
feature. If the help page said something like "If the calls to FUN
return vectors of different lengths then apply returns a list of
length dim(x)[MARGIN]" then it would be less surprising. Or would you
prefer that apply returns an error message if it can't coerce the
result to an array?

Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Aug 22 17:30:08 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:30:08 -0700 (PDT)
Subject: R-alpha: apply()
In-Reply-To: <199708221037.MAA04898@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970822092037.10703A-100000@chekov>

On Fri, 22 Aug 1997, Kurt Hornik wrote:

> The following is identical in R and S, but still strange ...
> 
> R> apply(matrix(1:20, nc = 4), 1, table)
>      [,1] [,2] [,3] [,4] [,5]
> [1,]    1    1    1    1    1
> [2,]    1    1    1    1    1
> [3,]    1    1    1    1    1
> [4,]    1    1    1    1    1
> R> apply(matrix(rep(1, 20), nc = 4), 1, table)
> [1] 4 4 4 4 4

Yes it is.  This is the sort of thing I meant when I complained about
drop=F being the default.  

The third example should be documented in the man page, which only
describes what happens "If each call to FUN returns a vector of length n" 
In fact the Blue Book help pages and the current S-PLUS help also
ignore this possibility.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Aug 22 17:33:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:33:18 -0700 (PDT)
Subject: R-alpha: eigen
In-Reply-To: <9708221202.AA06994@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970822093036.10703B-100000@chekov>

On Fri, 22 Aug 1997, Jim Lindsey wrote:

> eigen(matrix(rep(1,9),ncol=3),only.values=T)
> 
> works repeatedly but eventually (after 3 or 4 goes) gave a core dump
> of 11mb (I think only the first answer was right).
> 

The bug in foreign function calling pointed out by Martin in a different
context does this, if you haven't fixed it (it's more recent than 50a3).
In naoktrim in dotcode.c, which begins 
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 0;
                *len = 0;
        }
   
change *dup = 0 to *dup = 1.



Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Aug 22 17:45:44 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:45:44 -0700 (PDT)
Subject: R-alpha: terms
In-Reply-To: <x2zpqbduf5.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970822094149.10703D-100000@chekov>


Another minor incompatibility
R>attr(terms(y~x),"response")
[1] TRUE
S> attr(terms(y~x),"response")
[1] 1

In S the attribute indicates which column of the model frame will contain
the response. In R this always column 1 because model frames are only
useful when their columns are in the right order (model.matrix doesn't
check).


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 22:20:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 23:20:43 +0200
Subject: R-alpha: apply()
In-Reply-To: Thomas Lumley's message of Fri, 22 Aug 1997 09:30:08 -0700 (PDT)
References: <Pine.SUN.3.95.970822092037.10703A-100000@chekov>
Message-ID: <x2203l52z8.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> On Fri, 22 Aug 1997, Kurt Hornik wrote:
> 
> > The following is identical in R and S, but still strange ...
> > 
> > R> apply(matrix(1:20, nc = 4), 1, table)
> >      [,1] [,2] [,3] [,4] [,5]
> > [1,]    1    1    1    1    1
> > [2,]    1    1    1    1    1
> > [3,]    1    1    1    1    1
> > [4,]    1    1    1    1    1
> > R> apply(matrix(rep(1, 20), nc = 4), 1, table)
> > [1] 4 4 4 4 4
> 
> Yes it is.  This is the sort of thing I meant when I complained about
> drop=F being the default.  
> 
> The third example should be documented in the man page, which only
> describes what happens "If each call to FUN returns a vector of length n" 
> In fact the Blue Book help pages and the current S-PLUS help also
> ignore this possibility.
> 

The weirdest thing is actually the first case, where tables of the
same length *but different dimnames* are getting pasted together into
a matrix with no dimnames... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Sat Aug 23 05:10:10 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Sat, 23 Aug 1997 16:10:10 +1200 (NZST)
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
Message-ID: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>

Whatever extensions are decided on for any of the R stuff it is important
to realize that Windows (3.11) only lets you have one dot (.) and then
only 3 characters. The base name should be only 8 characters long as well.
Since I'm worrying about it a little these days I just want to put my 2 cents
worth in on this topic.

It is looking like a real pain to translate the current set of html files to
this format which means that there is going to be some real work required in
getting a 3.11 version going.

On a related note I really have started on the RSept and have postscript
functioning (once again big changes will be needed to get it to fly under
3.11 so it'll be a Win95 version first).

Getting dll's going is the next trick I'm going to try.

robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Aug 23 11:59:39 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Aug 1997 12:59:39 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: Robert Gentleman's message of Sat, 23 Aug 1997 16:10:10 +1200 (NZST)
References: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>
Message-ID: <x2203lp3kz.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> 
> Whatever extensions are decided on for any of the R stuff it is important
> to realize that Windows (3.11) only lets you have one dot (.) and then
> only 3 characters. The base name should be only 8 characters long as well.
> Since I'm worrying about it a little these days I just want to put my 2 cents
> worth in on this topic.
> 
> It is looking like a real pain to translate the current set of html files to
> this format which means that there is going to be some real work required in
> getting a 3.11 version going.

Is it possible that the HTML->RTF->WinHelp generation pointer I sent
you would work faster? Point being that you could generate the RTF
file on a machine with long filenames yielding a file with *internal"
links, no restrictions on names, and in turn a .HLP file - which we
want to have anyway.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Aug 23 20:07:04 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 23 Aug 1997 12:07:04 -0700 (PDT)
Subject: R-alpha: plots and batch mode
In-Reply-To: <x2zpqbduf5.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.LNX.3.96.970823120250.1852A-100000@buffy>


You can always define a dummy graphics driver for batch mode by

dummy.driver<-function() postscript(file="/dev/null")

which will actually do all the calculations needed (and so catch errors)
but won't produce anything.  Then you can edit the Rprofile so that
dummy.driver() is started if you aren't running interactively.  

I don't know if something similar can be done for Mac/Win.

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:28:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:28:09 +0200
Subject: R-alpha: barplot()
Message-ID: <199708250628.IAA13999@aragorn.ci.tuwien.ac.at>

I've created a hacked version of barplot() which is more compatible with
the S version, but currently ONLY FOR VECTORS.

Differences && new features:

* The `space' argument is interpreted as the fraction of the average bar
width.  (The current version has the width of the bar plus the space in
between constrained to sum to 1.)

* There is a new argument `width'.

* There is a new argument `horiz' for producing horizontal barplots.

Please have a look.  If the changes are ok'ed, I will also change the
matrix case accordingly.

I have a remark and a question.

* The printing of labels at the vertical axis seems to be different in R
and S when using axis(), the labels come out horizontal in S and
vertical in R.  Compare
	x <- 1:5
	plot(x, axes = F)
	axis(2, at = x, labels = LETTERS[x])

* I feel a bit stupid repeating most code for the horiz T and F cases.
Is there a smarter way to `swap' x and y when plotting?

-k

*************************************************************************
"barplot" <-
function(height, width = 1, space = 0.2, names.arg, legend.text,
	 beside = FALSE, horiz = FALSE, col = NULL, border = par("fg"),
	 main = NULL, xlab = NULL, ylab = NULL, xlim, ylim, axes = TRUE,
	 ...)
{
  opar <- par(yaxs="i", xpd=TRUE)
  on.exit(par(opar))
  if (is.matrix(height)) {
    if (beside) {
      delta <- 0.5 * (1 - space)
      if (missing(xlim))
	xlim <- c(0, ncol(height)) + 0.5
      if (missing(ylim))
	ylim <- range(-0.01, height)
      plot.new()
      plot.window(xlim, ylim, log = "")
      for (i in 1:ncol(height)) {
	xx <- seq(i-delta, i+delta, length=nrow(height)+1)
	xl <- xx[1:nrow(height)]
	xr <- xx[1:nrow(height)+1]
	rect(xl, 0, xr, height[,i], col=col, xpd=TRUE)
      }
    } else { #-- not 'beside' --
      delta <- 0.5 * (1 - space)
      nheight <- rbind(0, apply(height, 2, cumsum))
      if (missing(xlim)) 
	xlim <- c(0, ncol(height)) + 0.5
      if (missing(ylim)) 
	ylim <- range(-0.01, nheight)
      plot.new()
      plot.window(xlim, ylim, log = "")
      for (i in 1:ncol(height))
	rect(i - delta, nheight[-1, i],
	     i + delta, nheight[1:nrow(height), i],
	     col = col, xpd=TRUE)
    }
    if(missing(names.arg))
      names.arg <- dimnames(height)[[2]]
    if(!is.null(names.arg)) {
      if(length(names.arg) != ncol(height))
	stop("incorrect number of names")
      for(i in 1:length(names.arg))
	axis(1, at=1:length(names.arg), labels=names.arg, lty=0)
    }
  }
  else { ##---- height is vector ---------
    space <- space * mean(width)
    width <- rep(width, length = length(height))
    delta <- width / 2
    LRC <- cumsum(space + width)
    MID <- LRC - delta
    LLC <- MID - delta
    if (missing(xlim)) xlim <- c(0, max(LRC))
    if (missing(ylim)) ylim <- range(-0.01, height)
    plot.new()
    if (horiz) {
      plot.window(ylim, xlim, log = "")
      rect(0, LLC, height, LRC, col, xpd = TRUE)
    } else {
      plot.window(xlim, ylim, log = "")      
      rect(LLC, 0, LRC, height, col, xpd = TRUE)
    }
    if (missing(names.arg))
      names.arg <- names(height)
    if (!is.null(names.arg))
      for (i in 1:length(names.arg))
	if (horiz)
	  axis(2, at = MID, labels = names.arg, lty = 0)
	else
	  axis(1, at = MID, labels = names.arg, lty = 0)
  }
  if (!missing(legend.text) && !missing(col)) {
    xy <- par("usr")
    legend(xy[2] - xinch(0.1), xy[4] - yinch(0.1),
	   legend = rev(legend.text), fill = rev(col),
	   xjust = 1, yjust = 1)
  }
  title(main = main, xlab = xlab, ylab = ylab, ...)
  if (axes)
    if (horiz)
      axis(1)
    else
      axis(2)
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:33:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:33:16 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: <x2203lp3kz.fsf@bush.kubism.ku.dk>
References: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>
 <x2203lp3kz.fsf@bush.kubism.ku.dk>
Message-ID: <199708250633.IAA14016@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> 
>> Whatever extensions are decided on for any of the R stuff it is important
>> to realize that Windows (3.11) only lets you have one dot (.) and then
>> only 3 characters. The base name should be only 8 characters long as well.
>> Since I'm worrying about it a little these days I just want to put my 2 cents
>> worth in on this topic.
>> 
>> It is looking like a real pain to translate the current set of html files to
>> this format which means that there is going to be some real work required in
>> getting a 3.11 version going.

> Is it possible that the HTML->RTF->WinHelp generation pointer I sent
> you would work faster? Point being that you could generate the RTF
> file on a machine with long filenames yielding a file with *internal"
> links, no restrictions on names, and in turn a .HLP file - which we
> want to have anyway.

That would be nice ... names in RApril.zip such as
	chisquare.test.html
won't work in 3.11 anyway ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:51:44 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:51:44 +0200
Subject: R-alpha: Re:  .Options$digits do not (always) work
Message-ID: <199708250651.IAA14063@aragorn.ci.tuwien.ac.at>

While trying to understand official and private explanations of Robert
and Martin before writing something useful in the FAQ, I did some more
experimenting ...

Please have a look at the following.  According to Martin, this is also
what he observed about 2 weeks ago but did not document exactly enough
when posting.

Note:  the explanation given by Robert was (roughly speaking) that the
result of options()$digits is used for printing, and NOT the value of
.Options$digits.

Here it comes.

***********************************************************************
R> .Options$digits
[1] 7

R> tst2 <- function(x=pi, dig =3) {
+   oo <- options(digits=dig); on.exit(options(oo)); print(x);x}
R> tst2()
[1] 3.14
[1] 3.141593
R> tst2(dig = 12)
[1] 3.14159265359
[1] 3.141593
***********************************************************************

Up to here, everything is fine and rational.  But now:

***********************************************************************
R> .Options$digits <- 5

R> tst2()
[1] 3.1416
[1] 3.1416
R> tst2(dig = 12)
[1] 3.1416
[1] 3.1416
***********************************************************************

Oops, the internal value of options()$digits is ignored .... Really?
Let's test:

***********************************************************************
R> tst3 <- function(x=pi, dig =3) {
+ oo <- options(digits=dig); on.exit(options(oo));
+ print(c(.Options$digits, options()$digits)); print(x); x }
R> tst3()
[1] 5 3
[1] 3.1416
[1] 3.1416
R> tst3(dig = 12)
[1]  5 12
[1] 3.1416
[1] 3.1416

R> tst4 <- function(x=pi, dig =3) {
+ .Options$digits <- dig;
+ print(c(.Options$digits, options()$digits)); print(x); x }
R> tst4()
[1] 3 7
[1] 3.1416
[1] 3.1416
***********************************************************************

SUMMARY:  If we assign explicitly to .Options$digits in .GlobalEnv,
there is NO WAY we can change the print behavior inside functions after
that, neither by assigning to .Options$digits nor by using
options(digits = ...).

Surely, this cannot be a feature!

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:59:40 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:59:40 +0200
Subject: R-alpha: R documentation boilerplates
Message-ID: <199708250659.IAA14098@aragorn.ci.tuwien.ac.at>

Just a minor remark.  Perhaps it would be useful to have some of the
`boilerplates' used by S for the man pages, e.g.,

	.GE .ME .XY .GR .AO .NA

Perhaps .GE() or GENERIC()?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 08:07:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 09:07:48 +0200
Subject: R-alpha: apply()
In-Reply-To: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>
References: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>
Message-ID: <199708250707.JAA14115@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> At 12:42 22/08/97, kurt.hornik@ci.tuwien.ac.at wrote:
>> The following is identical in R and S, but still strange ...
>> 
R> apply(matrix(1:20, nc = 4), 1, table)
>> [,1] [,2] [,3] [,4] [,5]
>> [1,]    1    1    1    1    1
>> [2,]    1    1    1    1    1
>> [3,]    1    1    1    1    1
>> [4,]    1    1    1    1    1
R> apply(matrix(rep(1, 20), nc = 4), 1, table)
>> [1] 4 4 4 4 4
R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
>> [[1]]
>> 1 3 7 
>> 2 1 1 
>> 
>> [[2]]
>> 2 4 6 8 
>> 1 1 1 1
>> 
>> -k

> It is strange, but logical.  The problem is that it's an undocumented
> feature. If the help page said something like "If the calls to FUN
> return vectors of different lengths then apply returns a list of
> length dim(x)[MARGIN]" then it would be less surprising. Or would you
> prefer that apply returns an error message if it can't coerce the
> result to an array?

No, some explanation would be fine.  But from the examples, I don't
think that we always get a list of a certain length ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 08:10:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 09:10:20 +0200
Subject: R-alpha: tapply() strangeness
Message-ID: <199708250710.JAA14123@aragorn.ci.tuwien.ac.at>

Here's something related to last week's apply() problem:

R> x <- matrix(1:20, nc = 4)
R> x
     [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20

R> tapply(x, row(x), table)
[1] Numeric,4 Numeric,4 Numeric,4 Numeric,4 Numeric,4

???

In S,

> tapply(x, row(x), table)
$"1":
 1 6 11 16 
 1 1  1  1

$"2":
 2 7 12 17 
 1 1  1  1

$"3":
 3 8 13 18 
 1 1  1  1

$"4":
 4 9 14 19 
 1 1  1  1

$"5":
 5 10 15 20 
 1  1  1  1

which is (apart from labels) the same as

R> lapply(split(x, row(x)), table)
$1
 1  6 11 16 
 1  1  1  1 

$2
 2  7 12 17 
 1  1  1  1 

$3
 3  8 13 18 
 1  1  1  1 

$4
 4  9 14 19 
 1  1  1  1 

$5
 5 10 15 20 
 1  1  1  1 


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Mon Aug 25 08:42:30 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Mon, 25 Aug 1997 09:42:30 +0200 (MET DST)
Subject: R-alpha: eigen and batch
Message-ID: <9708250742.AA12773@alpha.luc.ac.be>

Batch:
  Putting q(save=F) at the end of my file does not work in my
context because I can no longer source the file without quitting. I
have that quit statement in my .First so that I always quit that way
interactively. The problem is that it is ignored in batch.

eigen:
  The crash occurs on my 586 running Red Hat Linux 2.0.27 but not on
my son's 486 running SLackware Linix 2.0.29. We both have the same
most recent libraries installed (libc, libm, etc).
   I started looking in the eispack C code and traced down the
problem. In three of the four Fortran calls in eigen, (ch,rs,cg but
not rg), the same vector (vals) is used for the return eigenvalues as
for two or three temporary workspace vectors. This is risky
programming at any time and leads to a catastrophe with a 586 where
several things may be calculated at the same time. If the variable,
vals, is removed and all use of it in the .Fortran call replaced by
double(n) (as in the call to rg), eigen works on a 586.
  This sort of problem should be checked elsewhere in R.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Aug 25 08:38:08 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 25 Aug 1997 09:38:08 +0200 (MET DST)
Subject: R-alpha: ts problems
Message-ID: <XFMail.970825095458.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.1.p0.Linux:970825095458:252=_
Content-Type: text/plain; charset=us-ascii

Here is a patch which fixes some problems with time series functions.
Some examples of what goes wrong...

> x <- ts(rnorm(100),start=1,deltat=2)
> start(x)
Error in ts[1] : object is not subsettable
> end(x)
Error in ts[2] : object is not subsettable
> y <- ts(matrix(rnorm(100),ncol=2))
> window(y,1,10)
Error in [.ts(x, (trunc((start - xtsp[1]) * freq + 1.5):trunc((end - xtsp[1]) *
 : unused argument to function

The first two bugs propagate quite widely. You can't even print x.

Unlike S-PLUS, R does not allow you to take row subsets of a time series
object without unclassing it (Of course there is the window function, but
you can't thin out a time series with this).   I've extended "[.ts"
to allow you to do this. I didn't put this version of "[.ts" in the patch.
Instead it is given below in full.

"[.ts" <-
function (x, i, j, drop = T)
{
        y <- NextMethod("[")
        if (missing(i))
                ts(y, start = start(x), freq = frequency(x))
        else {
                n <- if (is.matrix(x))
                        nrow(x)
                else length(x)
                ind <- (1:n)[i]
                delta <- unique(ind[-1] - ind[-length(ind)])
                if (length(delta) != 1 || delta == 0) {
                        warning("Not returning a time series object")
                }
                else {
                        xtsp <- tsp(x)
                        xtimes <- seq(from = xtsp[1], to = xtsp[2],
                                by = 1/xtsp[3])
                        ytsp <- numeric(3)
                        ytsp[1] <- xtimes[min(ind)]
                        ytsp[2] <- xtimes[max(ind)]
                        ytsp[3] <- (length(ind) - 1)/(ytsp[2] -
                                ytsp[1])
                        tsp(y) <- ytsp
                }
                y
        }
}

I hope this is useful.
Martyn

--_=XFMail.1.1.p0.Linux:970825095458:252=_
Content-Type: text/plain;
 charset=us-ascii; name=R-0.50.a3-tspatch; SizeOnDisk=613
Content-Description: R-0.50.a3-tspatch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="R-0.50.a3-tspatch"

diff -uNr R-0.50-a1-orig/src/library/base/funs/ts R-0.50-a1/src/library/base/fun
s/ts
--- R-0.50-a1-orig/src/library/base/funs/ts	Sun Aug 24 14:51:23 1997
+++ R-0.50-a1/src/library/base/funs/ts	Sun Aug 24 14:55:26 1997
@@ -103,7 +103,7 @@
 		fs <- floor(tsp[3]*(tsp[1] - is)+0.001)
 		c(is,fs+1)
 	}
-	else ts[1]
+	else tsp[1]
 }
 
 end.ts <-
@@ -118,7 +118,7 @@
 		fs <- floor(tsp[3]*(tsp[2] - is)+0.001)
 		c(is, fs+1)
 	}
-	else ts[2]
+	else tsp[2]
 }
 
 frequency.ts <-
@@ -266,7 +266,7 @@
 }
 
 "[.ts" <-
-function(x, i, j)
+function(x, i, j, drop=T)
 {
 	y <- NextMethod("[")
 	if(is.matrix(x) & missing(i))

--_=XFMail.1.1.p0.Linux:970825095458:252=_--
End of MIME message
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 09:17:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 10:17:52 +0200
Subject: R-alpha: R documentation problems
Message-ID: <199708250817.KAA14244@aragorn.ci.tuwien.ac.at>

Last week I spent some time going through the Blue Book to figure out
what we are missing and where we are different.  (Results will come in
subsequent emails.)  As a byproduct, here is a list of the documentation
problems I found.

As soon as time and my knowledge of CVS allow, I'll try to fix some of
these ...

-k

***********************************************************************
* The following man pages are completely missing:

	do.call
	.First
	.Last
	menu
	proc.time
	readline
	segments
	sink
	traceback

* The documentation for approx needs to be updated to reflect the the
new "constant" method.

* The documentation of approxfun() has an unnecessary xout part.  Also
needs to be updated to reflect the "constant" method.

* Man page for as.name mentions `name', which does not exist

* Man page for call is confusing.  It says,
	We don't differentiate between expressions and function
	    calls.  So is.call is the same as is.expression.
But,
  R> cl <- call("round",10.5)
  R> is.call(cl)
  [1] TRUE
  R> is.expression(cl)
  [1] FALSE

* Man page for function() (and invisible()) is incomplete

* Man page for points() gets formatted strangely

* Man page for split() should consistently talk about `group'
  (The `groups' in USAGE should be `group').

* The documentation of cat() is incomplete:  it has
  cat(... , sep="")
but
  R> args(cat)
  function (..., file = "", sep = " ", fill = FALSE, labels = NULL, 
          append = FALSE)

* The documentation of complex() is incorrect:
  complex(n=0, real=numeric(), imag=numeric())
but
  R> args(complex)
	function (n = 0, real = numeric(), imaginary = numeric())

* Man page for log() is not correct:
  The 2-arg version is not explained

* Man page for matrix() is incomplete:
  The `dimnames' argument is missing

* Man page for mode() is incomplete:
  The assignment form "mode<-" is not documenented

* Man page for stem() has
  stem(x, scale=1)
but
  R> args(stem)
  function (x, scale = 1, width = 80, atom = 1e-08)
Also, the EXAMPLES section should start with `data(islands)'	

* Man page for storage.mode() is incomplete:
  The assignment form "storage.mode<-" is not documented

* Man page for ts says
  ts(x, start=1, end, frequency=1, deltat=1, ts.eps = .Options$ts.eps)
but
  R> args(ts)
  function (data = NA, start = 1, end = numeric(0), frequency = 1, 
          deltat = 1, ts.eps = .Options$ts.eps)
(The first arg should	be `data' and not `x'.)

* In the `mva' package, the man page for dist() is not correct
  (The method "binary" is not mentioned.)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 09:18:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 10:18:47 +0200
Subject: R-alpha: Differences R/S
Message-ID: <199708250818.KAA14248@aragorn.ci.tuwien.ac.at>

Here's what I found.

* parse() has white = F by default (is T by default in S)

* S seems to have signif(x, digits = 6) whereas R needs an explicit
  second argument

* S title() has an axes = F optional argument

* In S, first argument to vector() is called `mode' and not `type'

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 25 10:49:48 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Aug 1997 11:49:48 +0200
Subject: R-alpha: R documentation problems
In-Reply-To: Kurt Hornik's message of Mon, 25 Aug 1997 10:17:52 +0200
References: <199708250817.KAA14244@aragorn.ci.tuwien.ac.at>
Message-ID: <x2203i1tj7.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> Last week I spent some time going through the Blue Book to figure out
> what we are missing and where we are different.  (Results will come in
> subsequent emails.)  As a byproduct, here is a list of the documentation
> problems I found.
...
> 
> ***********************************************************************
> * The following man pages are completely missing:
> 
...
> 
> * In the `mva' package, the man page for dist() is not correct
>   (The method "binary" is not mentioned.)

And, rather important:

 * Manpages for plot() and par() are incomplete. axes= is missing and
so is lwd=, e.g. It's on the plot.default() page, but it needs to be
duplicated on plot(), or plot() needs to refer more explicitly to
plot.default(), than "See also". Similar notes regarding barplot() and
hist().

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 11:12:14 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 12:12:14 +0200
Subject: R-alpha: `missing' BB functions
Message-ID: <199708251012.MAA14358@aragorn.ci.tuwien.ac.at>

Here are the functions documented in the Blue Book that I found missing
in R (ignoring the ones which are obviously outdated).

	aggregate allocated amatch axes chull clorder cutree cycle date
	debugger dget discr faces interp l1fit labclust lag loglin
	monthplot mstree mulbar napsack odometer persp plclust plotfit
	rep.int restore rreg sabl sablplot set.seed smooth sort.list
	Stable stars starsymb storage subtree symbols tempfile tslines
	tsmatrix tsplot tspoints twoway unlink usa xor

In some detail:

aggregate cycle lag smooth tslines tsmatrix tsplot tspoints:
	Obviously useful for time series.  Andreas has a quick version
	of lag() ...

allocated storage:
	Something to display the current memory consumption (other than
	as a byproduct of calling gc() would be nice ...
amatch

axes:
	Seems to be the same as title() except for axes = T and F, resp.
	R currently does not have this extra arg.

chull

clorder(?) cutree discr faces(?) labclust(?) mstree(?) plclust stars
subtree:
	These are already (sort of) in the full version of `mva' as
	(still?) planned by Ross (question marks indicate the ones not
	mentioned explicitly)

date:
	If we'd want this, we could add
		date <- function() system("date")
	to work under UNIX, at least

debugger

dget

loglin:
	Would this be useful?  It should not be too hard to write
	something around AS 51 ... Should that be compatible with the S
	version?
interp

l1fit rreg:
	These would certainly be nice as workhorses, but shouldn't L1
	and robust fitting of linear models be specifyable at the model
	level?

monthplot sabl sablplot

mulbar:
	Would be nice to have, in particular in connection with Mosaic
	plots ...

napsack

odometer

persp:
	This is already in "3D GRAPHICS" of PROJECTS.

plotfit twoway:
	Outdated?

rep.int

restore:
	Should be the opposite of dump() ... In R, can we simply use
	source()?

set.seed:
	Martin, do you have a version of that for R? 

sort.list

Stable:
	Jim Lindsey <jlindsey@luc.ac.be> wrote that he has d and p
	function for the four-parameter stable family, perhaps we should
	include this.
	
starsymb

symbols

tempfile:
	Would be very useful, although I'd prefer it to be called
	`tmpfile' instead.  I am not sure if tmpfile() is ANSI C.  If
	so, we could simply wrap around it, as Fritz posted some time
	ago.

unlink:
	We most likely don't need this one, right?

usa:
	Would be nice, of course ...

xor:
	Is trivial and useful.  Could we add
		xor <- function(x, y) { (x | y) & !(x & y) }
	to the distribution?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug 25 11:24:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 25 Aug 1997 12:24:54 +0200
Subject: R-alpha: batch   q(save = 'no')
In-Reply-To: <9708250742.AA12773@alpha.luc.ac.be> (message from Jim Lindsey on
 Mon, 25 Aug 1997 09:42:30 +0200 (MET DST))
Message-ID: <199708251024.MAA00793@sophie.ethz.ch>

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> Batch: Putting q(save=F) at the end of my file does not work in my
    Jim> context because I can no longer source the file without
    Jim> quitting. I have that quit statement in my .First so that I always
    Jim> quit that way interactively. The problem is that it is ignored in
    Jim> batch.

I've tested the following, and it seems to work :

Add
	if(!interactive()) q(save = "no")

at the end of your batch files.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 13:39:45 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 14:39:45 +0200
Subject: R-alpha: R FAQ
Message-ID: <199708251239.OAA14629@aragorn.ci.tuwien.ac.at>

Attached is a snapshot of the new version of the FAQ.  What is still
missing is something on eval and .Options versus options().  As always,
feedback is greatly appreciated.
Best,
-k

***********************************************************************
  R FAQ
  Kurt Hornik
  v0.2-0, 1997/09/01

  This document contains answers to some of the most frequently asked
  questions about R.  Feedback is welcome.
  ______________________________________________________________________

  Table of Contents:

  1. Introduction

     1.1 Legalese
     1.2 Obtaining this Document
     1.3 Notation
     1.4 Feedback

  2. R Basics

     2.1 What Is R?
     2.2 What Machines Does R Run on?
     2.3 What Is the Current Version of R?
     2.4 How Can R Be Obtained?
     2.5 How Can R Be Installed?
        2.5.1 How Can R Be Installed (Unix)
        2.5.2 How Can R Be Installed (Windows)
        2.5.3 How Can R Be Installed (Macintosh)
     2.6 Are there Unix Binaries for R?
     2.7 Which Documentation Exists for R?
     2.8 Which Mailing Lists Exist for R?
     2.9 What is CRAN?

  3. R and S

     3.1 What Is S?
     3.2 What Is S-PLUS?
     3.3 What Are the Differences between R and S?

  4. R Add-On Packages

     4.1 Which Add-on Packages Exist for R?
     4.2 How Can Add-on Packages Be Installed?
     4.3 How Can Add-on Packages Be Used?
     4.4 How Can I Contribute to R?

  5. R and Emacs

     5.1 Is there Emacs Support for R?
     5.2 Should I Run R from Within Emacs?

  6. R Miscellania

     6.1 How Can I Read a Large Data Set into R?
     6.2 Why Can't R Source a `Correct' File?
     6.3 How Can I Set Components of a List to NULL?
     6.4 How Can I Save My Workspace?
     6.5 How Can I Clean Up My Workspace?
     6.6 Why Do My Matrices Lose Dimensions?

  7. Acknowledgments

  ______________________________________________________________________

  1.  Introduction

  This document contains answers to some of the most frequently asked
  questions about R.

  1.1.  Legalese

  This document is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  General Public License for more details.

  A copy of the GNU General Public License is available via WWW at
  http://www.gnu.org/copyleft/gpl.html.  You can also obtain it by
  writing to the Free Software Foundation, Inc., 675 Mass Ave,
  Cambridge, MA 02139, USA.

  1.2.  Obtaining this Document

  The latest version of this document is always available from

       http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html

  From there, you can also obtain versions converted to plain ASCII
  text, GNU info, DVI, and PostScript, as well as the SGML source used
  for creating all these formats using the SGML-Tools (formerly
  Linuxdoc-SGML) system.

  1.3.  Notation

  Everything should be pretty standard.  `R>' is used for the R prompt,
  and a `$' for the shell prompt (where applicable).

  1.4.  Feedback

  Feedback is of course most welcome.

  In particular, note that I do not have access to Windows or Mac
  systems.  If you have information on these systems that you think
  should be added to this document, please let me know.

  2.  R Basics

  2.1.  What Is R?

  R is a system for statistical computation and graphics.  It consists
  of a language plus a run-time environment with graphics, a debugger,
  access to certain system functions, and the ability to run programs
  stored in script files.
  The design of R has been heavily influenced by two existing languages:
  Becker, Chambers & Wilks' S (see question ``What is S?'') and
  Sussman's Scheme.  Whereas the resulting language is very similar in
  appearance to S, the underlying implementation and semantics are
  derived from Scheme.  See question ``What Are the Differences between
  R and S?'' for a discussion of the differences between R and S.

  R is being developed by Ross Ihaka and Robert Gentleman, who are
  Senior Lecturers at the Department of Statistics of the University of
  Auckland in Auckland, New Zealand.

  R has a home page at http://stat.auckland.ac.nz/r/r.html, and is free
  software distributed under a GNU-style copyleft.

  2.2.  What Machines Does R Run on?

  R is being developed for the Unix, Windows and Mac platforms.

  R will configure and build under a number of common Unix platforms
  including dec-alpha-osf, freebsd, hpux, linux-elf-ix86, sgi-irix,
  solaris, and sunos, and according to Jim Lindsey <jlindsey@luc.ac.be>
  also on Mac, Amiga and Atari under linux-m68k.

  If you know about other platforms, please drop me a note.

  2.3.  What Is the Current Version of R?

  The current Unix version is 0.50.  The previous version was 0.49 and
  added group methods and complex numbers, thus providing a more or less
  provides a full implementation of S as described in ``The New S
  Language''.

  The versions for Windows and Mac are pre-alpha.  With some good luck,
  the Windows version will soon catch up with the Unix version.

  2.4.  How Can R Be Obtained?

  Sources, binaries and documentation for R can be obtained via CRAN,
  the ``Comprehensive R Archive Network'' (see question ``What is
  CRAN?'').

  2.5.  How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  If binaries are available for your platform (see question ``Are there
  Unix Binaries for R?''), you can use these, following the instructions
  that come with them.

  Otherwise, you can compile and install R yourself, which can be done
  very easily under a number of common Unix platforms (see question
  ``What Machines Does R Run on?'').  The file INSTALL that comes with
  the R distribution contains instructions.

  Choose a place to install the R tree (R is not just a binary, but has
  additional data sets, help files, font metrics etc).  Let's call this
  place RHOME (given appropriate permissions, a natural choice would be
  `/usr/local/lib/R').  Untar the source code, and issue the following
  commands (at the shell prompt):

       $ ./configure
       $ make
       $ make install-help

  You can also build a LaTeX version of the manual entries with

       $ make install-latex

  and an HTML version of the manual with

       $ make install-html

  If these commands execute successfully, the R binary will be copied to
  the `$RHOME/bin' directory.  In addition, a shell script font-end
  called `R' will be created and copied to the same directory.  You can
  copy this script to a place where users can invoke it, for example to
  `/usr/local/bin'.  You could also copy the man page `R.1' to a place
  where your man reader finds it, such as `/usr/local/man/man1'.

  2.5.2.  How Can R Be Installed (Windows)

  The file `RApril.zip' from the `bin/ms-windows' directory of a CRAN
  site contains a binary Windows 95 distribution for R which should be
  about a 0.48 release.  This version is quite limited in Windows-
  specific features and probably contains many bugs, although it has
  been reported to work rather nicely.  As always, there is no limit to
  the damage a buggy program can do under Windows, so, at least until
  more experience have been gained with it, it should probably not be
  used on systems containing very important data.  It is not clear
  whether it works under Windows 3.11 (the HTML help system cannot work
  under 3.11 as it needs long file names).  According to James Neild
  <jneild@esri.com>, it works fine under Windows NT 3.51.

  Note that when uncompressing `RApril.zip', the pkunzip program needs
  to be invoked with the -D flag to create subdirectories.

  2.5.3.  How Can R Be Installed (Macintosh)

  The CRAN `bin/macintosh' directory contains `R.sea.hqx', a binhexed
  self-extracting archive, and installation instructions in
  `README.MACINTOSH'.  Note that the version in it is nowhere near the
  quality of the current Unix version.

  The Power Macintosh port is temporarily on hold.

  2.6.  Are there Unix Binaries for R?

  Experimental `.deb' and `.rpm' packages for installation under the
  ix86 versions of Debian GNU/Linux and Red Hat Linux, respectively, can
  be found in `bin/ix86-linux'.  No other binary distributions for Unix
  systems have thus far been made publically available.

  2.7.  Which Documentation Exists for R?

  Online documentation for most of the functions and variables in R
  exists, and can be printed on-screen by typing help(name) (or ?name)
  at the R prompt, where name is the name of the R object help is sought
  for.  (In the case of unary and binary operators and control-flow
  special forms, the name may need to be be quoted.)

  This documentation can also be made available as HTML, and as hardcopy
  via LaTeX, see question ``How Can R Be Installed?''.  An up-to-date
  HTML version is always available for web browsing at

       http://www.stat.math.ethz.ch/R-manual

  An R manual (``Notes on R:  A Programming Environment for Data
  Analysis and Graphics'') is currently being written, based on the
  ``Notes on S-PLUS'' by Bill Venables <venables@stats.adelaide.edu.au>
  and David Smith <D.M.Smith@lancaster.ac.uk>.  The current version can
  be obtained as `Rnotes.tgz' (LaTeX source) in a CRAN `doc' directory.
  Note that the ``conversion'' from S(-PLUS) to R is not complete yet.

  Last, but not least, Ross' and Robert's experience in designing and
  implementing R is described in:

       @Article{,
         author =       {Ross Ihaka and Robert Gentleman},
         title =        {R: A Language for Data Analysis and Graphics},
         journal =      {Journal of Computational and Graphical Statistics},
         year =         1996,
         volume =       5,
         number =       3,
         pages =        {299--314}
       }

  This is also the reference for R to use in publications.

  2.8.  Which Mailing Lists Exist for R?

  Thanks to Martin Maechler <maechler@stat.math.ethz.ch>, there are
  three mailing lists devoted to R.

     r-announce
        This list is for announcements about the development of R and
        the availability of new code.

     r-devel
        This list is for discussions about the future of R and pre-
        testing of new versions.  It is meant for those who maintain an
        active position in the development of R.
     r-help
        The `main' R mailing list, for announcements about the
        development of R and the availability of new code, questions and
        answers about problems and solutions using R, enhancements and
        patches to the source code and documentation of R, comparison
        and compatibility with S and S-plus, and for the posting of nice
        examples and, benchmarks.

  To send a message to everyone on the r-help mailing list, send email
  to

       r-help@stat.math.ethz.ch

  To subscribe (or unsubscribe) to this list send subscribe (or unsub-
  scribe) in the BODY of the message (not in the subject!)  to r-help-
  request@stat.math.ethz.ch.  Information about the list can be obtained
  by sending an email with info as its contens to r-help-
  request@stat.math.ethz.ch.

  Subscription and posting to the other lists is done analogously, with
  `r-help' replaced by `r-announce' and `r-devel', respectively.  Note
  that the r-announce list is gatewayed into r-help, so you don't need
  to subscribe to both of them.

  It is recommended that you send mail to r-help rather than only to the
  R developers (who are also subscribed to the list, of course).  This
  may save them precious time they can use for constantly improving R,
  and will typically also result in much quicker feedback for yourself.

  Of course, in the case of bug reports it would be very helpful to have
  code which reliably reproduces the problem.

  Archives of the above three mailing lists are made available on the
  net in a monthly schedule at ftp://ftp.stat.math.ethz.ch/Mail-
  archives/ (which is a directory of mail archive files).  Archives of
  the r-help mailing list (including the previous r-testers lists back
  to March 1996), are also available in HTML format at
  http://www.ens.gu.edu.au/robertk/rhelp/about.htm.

  The WWW page http://www.maths.uq.edu.au/~gks/r/mail.html is devoted to
  the R mailing lists, providing easy posting, subscription and
  unsubscription, and access to mailing list archives.

  The developers of R can be reached for comments and reports at
  R@stat.auckland.ac.nz.

  2.9.  What is CRAN?

  The ``Comprehensive R Archive Network'' (CRAN) is a collection of
  sites which carry identical material, consisting of the R
  distribution(s), the contributed extensions, documentation for R, and
  binaries.

  The CRAN master site can be found at the URL

       ftp://ftp.ci.tuwien.ac.at/pub/R/

  and is currently being mirrored daily at

       http://lib.stat.cmu.edu/R/CRAN/
       ftp://franz.stat.wisc.edu/pub/R/
       ftp://ftp.stat.math.ethz.ch/R-CRAN/
  http://www.stat.unipg.it/pub/stat/statlib/R/CRAN/
  ftp://ftp.u-aizu.ac.jp/pub/lang/R/CRAN/

  Please use the CRAN site closest to you to reduce network load.

  The structure of the CRAN tree is as follows.

     `src/base'
        contains the official R distribution as provided by Ross Ihaka
        and Robert Gentleman.

     `src/contrib'
        contains code for extension packages.

     `doc'
        is for additional documentation and information on R.

     `bin'
        is for prebuilt R binaries (the base distribution and
        extensions), grouped according to platforms.  Currently, there
        are only experimental packages for Debian GNU/Linux.  I hope
        that `.tar.gz' files with contents relative to an installation
        tree (e.g. `bin', `lib/R/', and `man/man1/R.1') can be made
        available soon for all major supported Unix platforms.

  To ``submit'' to CRAN, simply upload to
  ftp://ftp.ci.tuwien.ac.at/incoming and send email to Kurt Hornik
  <Kurt.Hornik@ci.tuwien.ac.at>.  Please indicate the copyright
  situation (GPL, ...) in your submission.

  3.  R and S

  3.1.  What Is S?

  S is a very high level language and an environment for data analysis
  and graphics.  S was written by Richard A. Becker, John M. Chambers,
  and Allan R. Wilks of AT&T Bell Laboratories Statistics Research
  Department.

  The primary references for S are two books by the creators of S.

  o  Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
     ``The New S Language,'' Chapman & Hall, London.

     This book is often called the ``Blue Book''.

  o  John M. Chambers and Trevor J. Hastie (1992), ``Statistical Models
     in S,'' Chapman & Hall, London.

     This is also called the ``White Book''.

  There is a huge amount of user-contributed code for S, available at
  the S Repository at CMU.

  See the ``Frequently Asked Questions about S''
  (http://lib.stat.cmu.edu/S/faq) for further information about S.

  3.2.  What Is S-PLUS?

  S-PLUS is a value-added version of S sold by Statistical Sciences,
  Inc. (now a division of Mathsoft, Inc.)  S is a subset of S-PLUS, and
  hence anything which may be done in S may be done in S-PLUS.  In
  addition S-PLUS has extended functionality in a wide variety areas,
  including robust regression, modern nonparametric regression, time
  series, survival analysis, multivariate analysis, classical
  statistical tests, quality control, and graphics drivers.  Add-on
  modules add additional capabilities for wavelet analysis, spatial
  statistics, and design of experiments.

  See the MathSoft S-PLUS page (http://www.mathsoft.com/splus.html) for
  further information.

  3.3.  What Are the Differences between R and S?

  Whereas the developers of R have tried to stick to the S language as
  defined in ``The New S Language'' (Blue Book, see question ``What is
  S?''), they have adopted the evaluation model of Scheme.

  This difference becomes manifest when free variables occur in a
  function.  Free variables are those which are neither formal
  parameters (occurring in the argument list of the function) nor local
  variables (created by assigning to them in the body of the function).
  Whereas S (like C) by default uses static scoping, R (like Scheme) has
  adopted lexical scoping.  This means the values of free variables are
  determined by a set of global variables in S, but in R by the bindings
  that were in effect at the time the function was created.

  Consider the following function:

       cube <- function(n) {
         sq <- function() n * n
         n * sq()
       }

  Under S, sq() does not ``know'' about the variable n unless it is
  defined globally:

       S> cube(2)
       Error in sq():  Object "n" not found
       Dumped
       S> n <- 3
       S> cube(2)
       [1] 18

  In R, the ``environment'' created when cube() was invoked is also
  looked in:

       R> cube(2)
       [1] 8

  The following more `realistic' example illustrating the differences in
  scoping is due to Thomas Lumley <thomas@biostat.washington.edu>.  The
  function

       jackknife.lm <- function(lmobj) {
         n <- length(resid(lmobj))
         jval <- t(apply(as.matrix(1:n), 1,
                         function(i) coef(update(lmobj, subset = -i))))
         (n - 1) * (n - 1) * var(jval) / n
       }

  does something useful in R, but does not work in S.  In order to make
  it work in S you need to explicitly pass the linear model object into
  the function nested in apply().  If you don't and you are lucky you
  will get ``Error: Object "lmobj" not found''.  If you are unlucky
  enough to have a linear model called lmobj in your global environment
  you will get the wrong answer with no warning.

  The following version works in S.

       jackknife.S.lm <- function(lmobj) {
         n <- length(resid(lmobj))
         jval <- t(apply(as.matrix(1:n), 1,
                         function(i, lmobj) coef(update(lmobj, subset = -i)),
                         lmobj = lmobj))
         (n - 1) * (n - 1) * var(jval) / n
       }

  (The S version was written independently by Thomas and at least three
  of his fellow students over the past couple of years, causing liter-
  ally hours of confusion on each occasion.)

  Similarly, most optimization (or zero-finding) routines need some
  arguments to be optimized over and have other parameters that depend
  on the data but are fixed with respect to optimization.  With R
  scoping rules, this is a trivial problem; simply make up the function
  with the required definitions in the same environment and scoping
  takes care of it.  With S, one solution is to add an extra parameter
  to the function and to the optimizer to pass in these extras, which
  however can only work if the optimizer supports this (and typically,
  the builtin ones do not).

  Lexical scoping allows using function closures and maintaining local
  state.  A simple example (taken from Abelson and Sussman) can be found
  in the `demos/language' subdirectory of the R distribution.  Further
  information is provided in the standard R reference ``R: A Language
  for Data Analysis and Graphics'' (see question ``Which Documentation
  Exists for R?'') and a paper on ``Lexical Scope and Statistical
  Computing'' by Robert Gentleman and Ross Ihaka which can be obtained
  from the `doc/misc' directory of a CRAN site.

  Lexical scoping also implies a further major difference.  Whereas S
  stores all objects as separate files in a directory somewhere (usually
  `.Data' under the current directory), R does not.  All objects in R
  are stored internally.  When R is started up it grabs a very large
  piece of memory and uses it to store the objects.  R performs its own
  memory management of this piece of memory.  Having everything in
  memory is necessary because it is not really possible to externally
  maintain all relevant ``environments'' of symbol/value pairs.  This
  difference also seems to make R much faster than S.

  The down side is that if R crashes you will lose all the work for the
  current session.  Saving and restoring the memory ``images'' (the
  functions and data stored in R's internal memory at any time) can be a
  bit slow, especially if they are big.  In S this does not happen,
  because everything is saved in disk files and if you crash nothing is
  likely to happen to them.  R is still in an alpha stage, and does
  crash from time to time.  Hence, for important work you should
  consider saving often, see question ``How Can I Save My Workspace?''
  (other possibilities are logging your sessions, or have your R
  commands stored in text files which can be read in using source()).
  (Note that if you run R from within Emacs (see question ``R and
  Emacs''), you can save the contents of the interaction buffer to a
  file and conveniently manipulate it using S-transcript-mode, as well
  as save source copies of all functions and data used.)

  Apart from lexical scoping and its implications, R follows the S
  language definition in the Blue Book as much as possible, and hence
  really is an ``implementation'' of S.  There are some intentional
  differences where the behavior of S is considered ``not clean''.  In
  general, the rationale is that R should help you detect programming
  errors, while at the same time being as compatible as possible with S.

  Some known differences are the following.

  o  In R, if x is a list, then x[sub] <- NULL and x[[sub]] <- NULL
     remove the specified elements from x.  The first of these is
     incompatible with S, where it is a no-op.

  o  In S, the functions named .First and .Last in the `.Data' directory
     can be used for customizing, as they are executed at the very
     beginning and end of a session, respectively.  R looks for files
     called `.Rprofile' in the user's home directory and the current
     directory, and sources these.  (It also loads a saved image from
     `.RData' in case there is one.)  If a .First function exists then,
     it is executed.  The .Last mechanism is not supported yet.

  o  In S, library(name) adds the data directory for the library section
     name to the search list.  If a function object named `.First.lib'
     exists in the directory, it is executed; this is typically used to
     dynamically load compiled code required by the functions in the
     section.  In R, library(name) currently simply sources the file
     $RHOME/library/name, and compiled code can be loaded by calling
     library.dynam() in this file.  The .First.lib mechanism is not
     really supported.

  o  In R, dyn.load() can only load shared libraries, as created for
     example by `R SHLIB'.

  o  R presently does not support IEEE Inf and NaN.

  o  In R, attach currently only works for lists and data frames (not
     for directories).

  o  Categories do not exist in R, and never will as they are deprecated
     now in S.  Use factors instead.

  o  In R, For() loops are not necessary and hence not supported.

  o  In R, assign() uses the argument envir= rather than where= as in S.

  o  The random number generators are different, and the seeds have
     different length.

  o  The glm family objects are implemented differently in R and S.  The
     same functionality is available but the components have different
     names.

  o  terms objects are stored differently.  In S a terms object is an
     expression with attributes, in R it is a formula with attributes.
     The attributes have the same names but are mostly stored
     differently.  The major difference in functionality is that a terms
     object is subscriptable in S but not in R.  If you can't imagine
     why this would matter then you don't need to know.

     Also, attr(terms(y~x),"response") give 1 in S and TRUE in R.  In S
     the attribute indicates which column of the model frame will
     contain the response. In R this always column 1 because model
     frames are only useful when their columns are in the right order
     (model.matrix doesn't check).

  There are also differences which are not intentional, and result from
  missing or incorrect code in R.  The developers would appreciate
  hearing about any deficiencies you may find (in a written report fully
  documenting the difference as you see it).  Of course, it would be
  useful if you were to implement the change yourself and make sure it
  works.

  4.  R Add-On Packages

  4.1.  Which Add-on Packages Exist for R?

  The R distribution comes with the following extra packages:

     eda
        Exploratory Data Analysis.  Currently only contains functions
        for robust line fitting, and median polish and smoothing.

     mva
        Multivariate Analysis.  Currently contains code for principal
        components (prcomp), canonical correlations (cancor),
        hierarchichal clustering (hclust), and metric multidimensional
        scaling (cmdscale).  More functions for clustering and scaling,
        biplots, profile and star plots, and code for ``real''
        discriminant analysis will be added soon.

  The following packages are available from the CRAN `src/contrib' area.

     acepack
        ace (Alternating Conditional Expectations) and avas (Additivity
        and VAriance Stabilization for regression) for selecting
        regression transformations.

     bootstrap
        Software (bootstrap, cross-validation, jackknife), data and
        errata for the book ``An Introduction to the Bootstrap'' by B.
        Efron and R. Tibshirani, 1993, Chapman and Hall.

     class
        Functions for classification (k-nearest neighbor and LVQ).

     clus
        Functions for cluster analysis.

     ctest
        A collection of classical tests, including the Bartlett, Fisher,
        Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.

     date
        Functions for dealing with dates.  The most useful of them
        accepts a vector of input dates in any of the forms 8/30/53,
        30Aug53, 30 August 1953, ..., August 30 53, or any mixture of
        these.

     e1071
        Miscellaneous functions used at the Department of Statistics at
        TU Wien (E1071).

     fracdiff
        Maximum likelihood estimation of the parameters of a
        fractionally differenced ARIMA(p,d,q) model (Haslett and
        Raftery, Applied Statistics, 1989).

     gee
        An implementation of the Liang/Zeger generalized estimating
        equation approach to GLMs for dependent data.

     integrate
        Code for adaptive quadrature.

     jpn
        A function to plot Japan's coast-line and prefecture boundaries.

     leaps
        A package which performs an exhaustive search for the best
        subsets of a given set of potential regressors, using a branch-
        and-bound algorithm, and also performs searches using a number
        of less time-consuming techniques.

     mlbench
        A collection of artificial and real-world machine learning
        benchmark problems, including the Boston housing data.

     oz Functions for plotting Australia's coastline and state
        boundaries.

     polynom
        A collection of functions to implement a class for univariate
        polynomial manipulations.

     snns
        An R interface to the Stuttgart Neural Networks Simulator
        (SNNS).

     splines
        Regression spline functions.

     survival4
        Functions for survival analysis (requires splines).

     wavethresh
        Code for doing wavelet transforms and thresholding in 1 and 2D.

     xgobi
        Interface to the XGobi program for graphical data analysis.

  See CRAN `src/contrib/INDEX' for more information.

  Paul Gilbert <pgilbert@bank-banque-canada.ca> has a written a
  multivariate time series package for S called time.series that is
  mostly converted to run in R.  He is currently debugging the code, and
  will officially release it in the near future.
  According to Paul, the PADI interface from the Bank of Canada also
  works with minor changes.  PADI can be used to access Fame time series
  data bases and potentially other databases, even remotely over the
  Internet.  For further information see http://www.bank-banque-
  canada.ca/pgilbert.

  Harald Fekjaer <hfe@math.uio.no> has written addreg, a package for
  additive hazards regression, which can be obtained from
  http://www.med.uio.no/imb/stat/addreg/.

  More code has been posted to the r-help mailing list, and can be
  obtained from the mailing list archive.

  4.2.  How Can Add-on Packages Be Installed?

  (Unix only.)  Untar the add-on packages in $RHOME/src/library/ and
  type

       $ make libs
       $ cd ../..
       $ ./etc/install-libhelp

  at the shell prompt.

  4.3.  How Can Add-on Packages Be Used?

  To find out which add-ons have already been installed, type

       R> library()

  at the R prompt.  This produces something like

       NAME         DESCRIPTION
       acepack      ace() and avas() for selecting regression transformations
       bootstrap    Functions for the book "An Introduction to the Bootstrap"
       ctest        Classical Tests
       date         Functions for handling dates
       eda          Exploratory Data Analysis
       fracdiff     Fractionally differenced ARIMA (p,d,q) models
       gee          Generalized Estimating Equation models
       mva          Classical Multivariate Analysis
       splines      Regression spline functions
       survival4    Survival analysis [needs library(splines)]

  You can ``load'' the installed package name by

       R> library(name)

  You can then find out which functions it provides by typing
       R> help(library = name)

  4.4.  How Can I Contribute to R?

  R is currently still in alpha (or pre-alpha) state, so simply using it
  and communicating problems is certainly of great value.

  One place where functionality is still missing is the modeling
  software as described in ``Statistical Models in S'' (see question
  ``What is S?''.  The functions

        add1 kappa alias labels drop1 proj

  are missing; many of these are interpreted functions so anyone that is
  bored and wants to have a go at implementing them it would be appreci-
  ated.  In addition, only linear and generalized linear models are cur-
  rently available, aov, gam, loess, tree, and the nonlinear modelling
  code are not there yet.

  See also the `PROJECTS' file in the top level R source directory.

  Many of the packages available at the Statlib S Repository might be
  worth porting to R.

  If you are interested in working on any of these projects, please
  notify Kurt Hornik.

  5.  R and Emacs

  5.1.  Is there Emacs Support for R?

  There is an Emacs-Lisp interface to S/S-PLUS called S-mode.  Its
  current version is 4.8 and can be obtained at
  http://www.maths.lancs.ac.uk:2080/~maa036/elisp/S-mode/.  The earlier
  versions which can be found at the Statlib S repository (gnuemacs3 and
  gnuemacs4) are outdated.

  It contains code for interacting with an inferior S process from
  within Emacs including an interface to the help system, editing S
  source code, and transcript manipulation, and comes with detailed
  instructions for installation.

  Martin Maechler <maechler@stat.math.ethz.ch> and Tony Rossini
  <rossini@math.sc.edu> have integrated support for R into this package.
  The current version is at

       ftp://ftp.math.sc.edu/rossini/S-mode-4.8.MM6.XE2.tar.gz

  and runs under both GNU Emacs and XEmacs.

  To install, put the byte-compiled `.el' files into a place where Emacs
  can find them, and add

  (if (not (assoc "\\.R$" auto-mode-alist)
      (add-to-list 'auto-mode-alist (cons "\\.R$" 'R-mode))))
  (autoload 'R "S" "Run an inferior R process" t)
  (autoload 'R-mode "S" "Mode for editing R source" t)
  (autoload 'r-mode "S" "Mode for editing R source" t)

  to one of your Emacs startup files, typically `~/.emacs'.  You can
  then fire up R from within Emacs by typing `M-x R' (note however that
  many interface functions will not work), and if you use the extension
  `.R' for your files with R code, Emacs will automagically turn on R
  edit mode whenever you visit such a file.

  Tony Rossini, Martin Maechler and Kurt Hornik have officially taken
  over the development of S-mode.  A new version, renamed ``ESS'' (for
  ``Emacs Speaks Statistics'') and including support for R, all S
  versions, and even Xlisp-STAT and Vista, will be released shortly.

  5.2.  Should I Run R from Within Emacs?

  Yes.  Inferior R mode provides a readline/history mechanism, object
  name completion, and syntax-based highlighting of the interaction
  buffer using Font Lock mode, as well as a very convenient interface to
  the R help system.

  Of course, it also integrates nicely with the mechanisms for editing R
  source using Emacs.  One can write code in one Emacs buffer and send
  whole or parts of it for execution to R; this is helpful for both data
  analysis and programming.  One can also seamlessly integrate with a
  revision control system, in order to maintain a log of changes in your
  programs and data, as well as to allow for the retrieval of past
  versions of the code.

  In addition, it allows you to keep a record of your session, which can
  also be used for error recovery through the use of the transcript
  mode.

  6.  R Miscellania

  6.1.  How Can I Read a Large Data Set into R?

  R (currently) uses a static memory model.  This means that when it
  starts up, it asks the operating system to reserve a fixed amount of
  memory for it.  The size of this chunk cannot be changed subsequently.
  Hence, it can happen that not enough memory was allocated.

  In these cases, you should restart R with more memory available, using
  the command line options -n and -v.  To understand these options, one
  needs to know that R maintains separate areas for fixed and variable
  sized objects.  The first of these is allocated as an array of ``cons
  cells'' (Lisp programmers will know what they are, others may think of
  them as the building blocks of the language itself, parse trees,
  etc.), and the second are thrown on a ``heap''.  The -n option can be
  used to specify the number of cons cells (each occupying 16 bytes)
  which R is to use (the default is 200000), and the -v option to
  specify the size of the vector heap in megabytes (the default is 2).
  Only integers are allowed for both options.

  E.g., to read in a table of 5000 observations on 40 numeric variables,
  R -v 6 should do.

  Note that the information on where to find vectors and strings on the
  heap is stored using cons cells.  Thus, it may also be necessary to
  allocate more space for cons cells in order to perform computations
  with very ``large'' variable-size objects.

  You can find out the current memory comsumption by typing gc() at the
  R prompt.

  6.2.  Why Can't R Source a `Correct' File?

  R sometimes has problems parsing a file which does not end in a
  newline.  This can happen for example when Emacs is used for editing
  the file and next-line-add-newlines is set to nil.  To avoid the
  problem, either set require-final-newline to a non-nil value in one of
  your Emacs startup files, or make sure R-mode (see question ``Is there
  Emacs Support for R?'') is used for editing R source files (which
  locally ensures this setting).

  Earlier R versions had a similar problem when reading in data files,
  but this should have been taken care of now.

  6.3.  How Can I Set Components of a List to NULL?

  You can use

       x[i] <- list(NULL)

  to set component i of the list x to NULL, similarly for named compo-
  nents.  Do not set x[i] or x[[i]] to NULL, because this will remove
  the corresponding component from the list.

  For dropping the row names of a matrix x, it may be easier to use
  rownames(x) <- NULL, similarly for column names.

  6.4.  How Can I Save My Workspace?

  The expression

       save(list = ls(), file = ".RData")

  saves the objects in the currently active environment (typically the
  user's .GlobalEnv) to the file `.RData' in the R startup directory.

  6.5.  How Can I Clean Up My Workspace?

  To remove all objects in the currently active environment (typically
  the user's .GlobalEnv), you can do
       rm(list = ls())

  6.6.  Why Do My Matrices Lose Dimensions?

  When a matrix with a single row or column is created by a subscripting
  operation, e.g., row <- mat[2, ], it is by default turned into a
  vector.  In a similar way if an array with dimension, say, 2x3x1x4 is
  created by subscripting it will be coerced into a 2x3x4 array, losing
  the unnecessary dimension.  After much discussion this has been
  determined to be a feature.

  To prevent this happening, add the option `drop = FALSE' to the
  subscripting. For example,

         rowmatrix <- mat[2, , drop = F]  # creates a row matrix
         colmatrix <- mat[, 2, drop = F]  # creates a column matrix
         a <- b[1, 1, 1, drop = F]        # creates a 1x1x1 array

  The `drop = F' option should be used defensively when programming.
  For example, the statement

         somerows <- mat[index, ]

  will return a vector rather than a matrix if index happens to have
  length 1, causing errors later in the code.  It should probably be
  rewritten as

         somerows <- mat[index, , drop = F]

  7.  Acknowledgments

  Of course, many many thanks to Robert and Ross for the R system, and
  to the package writers and porters for adding to it.

  Special thanks go to Peter Dalgaard, Paul Gilbert, Jim Lindsey, Thomas
  Lumley, Martin Maechler, and Anthony Rossini for their comments which
  helped me improve this FAQ.

  More to some soon ...


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Aug 25 15:02:14 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 25 Aug 1997 10:02:14 -0400
Subject: R-alpha: HTML help
Message-ID: <97Aug25.100418edt.26506@mailgate.bank-banque-canada.ca>

>> It is looking like a real pain to translate the current set of html files to
>> this format which means that there is going to be some real work required in
>> getting a 3.11 version going.

> Is it possible that the HTML->RTF->WinHelp generation pointer I sent
> you would work faster? Point being that you could generate the RTF
> file on a machine with long filenames yielding a file with *internal"
> links, no restrictions on names, and in turn a .HLP file - which we
> want to have anyway.

I came to the "real pain" conclusion a couple of years ago when I
converted the help files for my time series library to HTML. My
conclusion was essentially Kurt's: give up on meaningful filenames and
build internal links. I have a couple of unix scripts which build an
index by function name and an index by title and change the "see also"
pointers to appropriate links into the index. I don't get RTF out of
this though. (I was looking for a common format, not a way to generate
all formats.) If the scripts would be of use to you let me know.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug 25 16:15:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 25 Aug 1997 17:15:32 +0200
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
Message-ID: <199708251515.RAA01258@sophie.ethz.ch>

Another request for comments

	(the last one on file extensions had not too many 'voters' ...)

Both questions have to do with improving the 'man' file format,
conventions, .. AND building the  'help', 'latex' and 'html' files from the
man sources. 

Before you read on.. 
Kurt Hornik has suggested that in any case, the compiled
'help', 'html' (and 'tex' and 'R' Example) files could be provided  
(through CRAN) for those people who would lack in the following..

1) I am trying to `replace' the current scheme of
	make install-help
	make install-latex
	make install-html
	make test-Examples	which just calls  shell script in RHOME/etc

   by a scheme that uses proper dependencies and only
   rebuilds things when and where they have changed.

   Currently, I believe that this would be much easier / nicer  if I could
   require  GNU make  (which all Linuxers have anyway) for doing these.
   I could then use things such as  $(shell: ...)   $(wildcard: ...), etc.

 Is this ok with all of you?


2) Even more extreme: Can we require  __Perl__ to be available for most
   (for all who want to build  help/html/tex files themselves)?

   If yes, we could think of enhancing the "compilation" of man files
   quite a bit, using perl instead of the
	sed .. | m4 | sed ..
   pipe which we currently need.

What do you think?

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Mon Aug 25 16:51:26 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 25 Aug 1997 11:51:26 -0400
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
In-Reply-To: Martin Maechler's message of "Mon, 25 Aug 1997 17:15:32 +0200"
References: <199708251515.RAA01258@sophie.ethz.ch>
Message-ID: <wncg1ryl0qp.fsf@fhat.stat.sc.edu>


>>>>> "Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:


    Martin>    Currently, I believe that this would be much easier /
    Martin>    nicer if I could require GNU make (which all Linuxers
    Martin>    have anyway) for doing these.  I could then use things
    Martin>    such as $(shell: ...)  $(wildcard: ...), etc.

    Martin>  Is this ok with all of you?


    Martin> 2) Even more extreme: Can we require __Perl__ to be
    Martin>    available for most (for all who want to build
    Martin>    help/html/tex files themselves)?

    Martin> What do you think?

Fine for Unix platforms.  Both are easy to build (easier than R, sort
of), and can be installed in a personal account.

I'm worried about the Mac and W95 platforms.  Ross and Robert?

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 17:31:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 09:31:20 -0700 (PDT)
Subject: R-alpha: tapply() strangeness
In-Reply-To: <199708250710.JAA14123@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970825092244.1542B-100000@avon>

On Mon, 25 Aug 1997, Kurt Hornik wrote:

> Here's something related to last week's apply() problem:
> 
> R> x <- matrix(1:20, nc = 4)
> R> x
>      [,1] [,2] [,3] [,4]
> [1,]    1    6   11   16
> [2,]    2    7   12   17
> [3,]    3    8   13   18
> [4,]    4    9   14   19
> [5,]    5   10   15   20
> 
> R> tapply(x, row(x), table)
> [1] Numeric,4 Numeric,4 Numeric,4 Numeric,4 Numeric,4
> 

Not terribly strange.  What we have here is a vector of lists (not a list
of lists as in S).  If you look at the components you see that everything
is the same as in S, it just prints differently
> tapply(x, row(x), table)->a
> a[1]
$1
 1  6 11 16 
 1  1  1  1 
or 
> a[[1]]
 1  6 11 16 
 1  1  1  1 

According to the Blue Book tapply() is supposed to return an array of
mode list  when the result of FUN applied to each category is not of
length 1. What you see is the result of my taking this literally: a
one-dimensional array
> dim(a)
[1] 5
> dimnames(a)
[[1]]
[1] "1" "2" "3" "4" "5"

I must confess that I didn't even know one-dimensional arrays were
possible -- I thought we would get a vector of mode list. Still, it seems
to work ok.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Aug 25 17:43:55 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 25 Aug 1997 12:43:55 -0400
Subject: R-alpha: Re: missing' BB functions
Message-ID: <97Aug25.124604edt.26509@mailgate.bank-banque-canada.ca>

Kurt

The function tempfile is available based on some C code from Friedrich
Leisch. The function unlink is fairly simple in unix but I haven't
experimented elsewhere. In this regard, I have put together a small
kernel set of functions to try to handle cross platform and R vs S
issues. This is appended below and I would certainly appreciate
feedback. The purpose of this kernel is so that I can write my code in
a way which will work in Splus or R and on most platforms.

I believe the function sort.list is just a special case of the function
order, which works in R.

Included with the kernel functions below is a set.seed function which I
have modified slightly (both in Splus and in R) so that it returns the
new value of the seed rather than returning NULL. There is a bit of a
kludge to make set.seed work with the single integer argument suggested
in the BB. It also works with the more realistic argument, a
previous setting of the seed.

I have working versions of tsmatrix and tsplot, but I'm not sure to
what extent they can be separated from a small "tframe library" I have
built to separate out (improve) the handling of the time dimension in
both Splus and R. I'll take a look at this shortly.

Also, if anyone has coded the functions acf and/or ar I would certainly
appreciate having them.


Paul Gilbert 


##############################################################################


# This file has code which contains operating system and S/R specific 
#   functions. They are intended to be used as a kernel to help 
#   protect other code from these problems.

# The MSwindows versions are not done. The Splus and Sun versions are done
# largely from memory (and old code) and have not yet been checked.

# The following functions are attempted:
#   For S/R differences:
#      global.assign, system.info, exists.graphics.device, tmpfile, unlink,
#      synchronize,  list.add for [["new.element"]]<-
#   For OS differences: 
#     system.call, sleep, present.working.directory, whoami, file.copy, 
#     file.date.info, date, mail, unlink, local.host.netname, 

# Also a number of is.xx functions are defined to identify systems.

# The variable  .SPAWN is also set to be used to identify if Splus "For" loops
#    should be used. (It is sometimes better not to use these even in Splus.)

##############################################################################

# there is a bit of a bootstrap problem first. 
  
# S untested !!!
if (!exists("version")) 
                 {version <- list(language="S", major=1, minor=1) 
                  system.call<- function(cmd){unix(cmd) }   
                 }
# Splus
if( is.null(version$language))
                  system.call<- function(cmd){unix(cmd) }   
# R:
if(!is.null(version$language) && (version$language=="R"))
                  system.call<- function(cmd){system(cmd, intern=T)}
 
#  end of bootstrap

system.info <- function() 
  {r <-unclass(version)
   r$minor <- as.numeric(r$minor)
   r$major <- as.numeric(r$major)
   if (is.null(r$language))  r$language <- "Splus"
   r$OSversion <- paste(system.call("uname -s"), 
                        system.call("uname -r | sed -e 's/\\.\.\*//'"), sep="")
   r
  }

is.R <- function(){system.info()$language == "R"}
is.S <- function(){is.Splus() | (system.info()$language == "S")}
is.Splus <- function(){system.info()$language == "Splus"}
is.Splus.pre3.3 <- function()
 {# <= 3.2 
  is.Splus() &&  ((system.info()$major+.1*system.info()$minor) < 3.3)
 }
is.Linux <- function(){system.info()$os == "linux"} 
is.MSwindows <- function(){system.info()$os == "MS Windows"}
is.Sun4 <- function(){"SunOS4" == system.info()$OSversion }
is.Sun5 <- function(){"SunOS5" == system.info()$OSversion }
is.unix <- function(){is.Linux() | is.Sun5() | is.Sun4() | 
                      (system.info()$os == "Unix")}  # ???

if(is.unix())
  {if(is.R()) unix <- function(cmd) system(cmd, intern=T)
   sleep <- function(n) {unix(paste("sleep ", n))} # pause for n seconds
   present.working.directory <- function(){unix("pwd")} # present directory
   whoami <- function(){unix("whoami")} # return user id (for mail)
   local.host.netname <-function() {unix("uname -n")}
   date <-function() {unix("date")}

   mail <- function(to, subject="", text="")
    {# If to is null then mail is not sent (useful for testing).
     file <- tmpfile()
     write(text, file=file)
   if(!is.null(to)) unix(paste("cat ",file, " | mail  -s '", subject, "' ", to))
     unlink(file)
     invisible()
    }

   file.copy <- function(from, to)unix(paste("cp ", from, to)) # copy file

   file.date.info <- function(file.name)
     {mo <- (1:12)[c("Jan","Feb","Mar","Apr","May", "Jun","Jul","Aug", "Sep",
         "Oct","Nov","Dec") ==substring(unix(paste("ls -l ",file)),33,35)]
      day <- as.integer(substring(unix(paste("ls -l ",file.name)),37,38))
      hr  <- as.integer(substring(unix(paste("ls -l ",file.name)),40,41))
      sec <- as.integer(substring(unix(paste("ls -l ",file.name)),43,44))
      c(mo,day,hr,sec)
     }
  }

if(is.MSwindows())
  {system.call  <- function(cmd) 
         {stop("system calls must be modified for this operating system.")}
   sleep <- system.call 
   present.working.directory <- system.call
   whoami <- system.call
   file.copy <- system.call
   file.date.info <- system.call
  }


if(is.S())
   {tmpfile <- tempfile
    if(is.unix())system  <- unix   
    global.assign <- function(name, value) {assign(name,value, where = 1)}
    .SPAWN <- TRUE
    exists.graphics.device <- function(){dev.cur() !=1 }
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                 {motif(display) }
    close.graphics.device <- function(){dev.off() }
    if (!exists("set.seed.Splus")) set.seed.Splus <- set.seed
    set.seed <- function(seed=NULL)
      {if (is.null(seed)) 
          seed <-.Random.seed
       else 
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }

    "list.add<-" <- function(x, replace, value)
       {# replace or add elements to a list.
        x[replace] <- value
        # x[[replace]] <- value  would be more logical but doesn't work
        x
       }
   }
        
if(is.R()) 
   {tmpfile <- function(f)
        {# Requires C code also from Friedrich Leisch not in version 0.15 of R.
         d<-"This is simply a string long enough to hold the name of a tmpfile";
         .C("tmpf", as.character(d))[[1]]
        }
    unlink <- function(file) system.call(paste("rm -fr ", file))
    global.assign <- function(name, value) 
                          {assign(name,value, envir=.GlobalEnv)}
    synchronize<- function(x){NULL} # perhaps this should do something?
    .SPAWN <- FALSE
    exists.graphics.device <- function(){exists(".Device")}
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                {x11(display) }
    close.graphics.device <- function(){F} # how do I do this?
    set.seed <- function(seed=NULL)
      {if (is.null(seed)) 
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not yet exist
          seed <-.Random.seed
         }
       else 
         {if (1==length(seed))
             global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }

   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list. 
      if (is.numeric(replace))
        {# x<- do.call("default.[[<-", list(x,replace,value))   # use default
         x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value)) 
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }
 }



##############################################################################

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 17:48:15 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 09:48:15 -0700 (PDT)
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
In-Reply-To: <199708251515.RAA01258@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970825094416.1542D-100000@avon>

On Mon, 25 Aug 1997, Martin Maechler wrote:
> 1) I am trying to `replace' the current scheme of
> 	make install-help
> 	make install-latex
> 	make install-html
> 	make test-Examples	which just calls  shell script in RHOME/etc
> 
>    by a scheme that uses proper dependencies and only
>    rebuilds things when and where they have changed.

Yes, yes !!
 
>    Currently, I believe that this would be much easier / nicer  if I could
>    require  GNU make  (which all Linuxers have anyway) for doing these.
>    I could then use things such as  $(shell: ...)   $(wildcard: ...), etc.
> 
>  Is this ok with all of you?

We tend to have GNU tools available on machines here, even under
SunOS/Solaris.  I don't know common this is.

> 
> 2) Even more extreme: Can we require  __Perl__ to be available for most
>    (for all who want to build  help/html/tex files themselves)?


I actually think requiring Perl is less extreme than requiring GNU make.
Perl is useful for so many things (eg CGI scripts) that almost everyone
has it.  There must be quite a lot of people who rely on the make that
comes with their system, though.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 18:18:08 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 10:18:08 -0700 (PDT)
Subject: R-alpha: eigen and batch
In-Reply-To: <9708250742.AA12773@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970825095235.1542E-100000@avon>

On Mon, 25 Aug 1997, Jim Lindsey wrote:
> 
> eigen:
>    I started looking in the eispack C code and traced down the
> problem. In three of the four Fortran calls in eigen, (ch,rs,cg but
> not rg), the same vector (vals) is used for the return eigenvalues as
> for two or three temporary workspace vectors. This is risky
> programming at any time and leads to a catastrophe with a 586 where
> several things may be calculated at the same time. 

No, this is a bug in .Fortran.  Everything sent to C or FORTRAN code is
supposed to be a *copy* of the R object.  This is because R is allowed to
move things around in memory whenever it feels the urge, but C and FORTRAN
assume things stay fixed.  Since everything is supposed to be copied there
is no harm in using multiple copies of the same thing. 

One possible source of this bug is in naoktrim in src/main/dotcode.c
which begins
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 0;
                *len = 0;
        }
but should begin
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 1;
                *len = 0;
        }


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Tue Aug 26 00:49:40 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Tue, 26 Aug 1997 11:49:40 +1200 (NZST)
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
Message-ID: <199708252349.LAA23088@stat1.stat.auckland.ac.nz>

As for windows (I'm no expert though);
  perl is nicer than anything else and it's available on the mac as well.
  make is a bit of a moot point; all c compilers have a make but it is
  different and the whole notion of distributing patches etc doesn't
  seem to have caught on much in the windows environment so I don't think
  we should worry about it too much.
  
  
robert  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 26 07:13:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 26 Aug 1997 08:13:55 +0200
Subject: R-alpha: Re:  barplot
Message-ID: <199708260613.IAA22900@aragorn.ci.tuwien.ac.at>

Did anyone have a quick look at my modified barplot?  I am waiting for
some kind of `OK' before I go on to convert the matrix case, too ...
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 27 16:11:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 27 Aug 1997 17:11:50 +0200
Subject: R-alpha: (minor?) S/R inconsistency:  mode(unclass(terms(...)))
Message-ID: <199708271511.RAA00953@sophie.ethz.ch>

I just stumbled over the following :

  mode(utf <- unclass(tf <- terms( ~ (x + y + z)^2)))
  ## R:  "call"
  ## S:  "expression"

Don't know if/when this could be important.
It made a big difference for me, but this was in low-level
experimentation...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Aug 27 16:46:59 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 27 Aug 1997 17:46:59 +0200
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <199708271546.RAA00253@galadriel.ci.tuwien.ac.at>


With help by Kurt and Martin I have written a short proposal for a new
R doc source format that should be easier to parse using, e.g.,
perl. There should be especially a clearer distinction between text
and keywords.

Here we go, please make comments, corrections, etc.

Best,
Fritz

**********************************************************

Conversion:
-----------

A perl module providing functions to parse the source text which are
used by other functions to produce latex, html, etc. 


Environment delimiters:
-----------------------
Change from () to {} as in latex and most programming languages such
that `()' can be used in equations without need for escaping


Keywords:
---------
Start all keywords with a backslash like in latex, because IMO the
word TITLE should not be something special simply because it is
written in capital letters.

if possible, keep latex syntax whenever possible, e.g., replace
greekalpha with \alpha, LDOTS with \ldots, etc.


Unknown keywords are ignored and result in a warning message from the
parser.


Logical Blocks:
---------------

The current logical blocks of the source files such as

	TITLE(...)
	USAGE(...)
	ALIAS(...)
	ARGUMENTS(...)

are kept and the first step of parsing the file is splitting it into
these blocks.

Then the single blocks are parsed and splitted into their parts (like
ARG lists), the remaining parts should then be something like `Rdoc text'
which must only be correctly converted into the output language
(equations, bold font, ...).


VALUE(S)
--------

Here only one environment should be necessary, if it contains more
than one ARG environment, it is what's now VALUES.


New keywords:
-------------

	TITLE, USAGE, ...	\title{...}, \usage{...}, ...
	ARG			\arg{argname}{description}
	BOLD			\bf{word}
	ITALIC			\emph{word}
	LANG			\code{word}
	PARA			\par
	BLANK			\blank
	LINK			\link{...}
	DOTS			\dots
	LDOTS			\ldots
	EQUALS			\=       ???but why is this needed???
	LT			\lt
	GT			\gt
	...

replace all math constructs with latex commands

Equation commands:

	EQN()			\eqn{A1}{A2}   ??? or \eqn[A2]{A1} ???
	DEQN(A1 @@ A2)		\deqn{A1}{A2}

where A1 is pure latex and A2 is an ascii version of the formula. If
only one argument is given, A1 and A2 are taken to be the same (such
that we don't have to write \eqn{x}{x}). \eqn corresponds to latex's
$$ and \deqn corresponds to \[ \].


Hard line break
---------------

\cr gives a hard line break



Comments:
---------

Ignore everything after a `%', \% gives the corresponding
character. We don't use the usual # for comments, because # appears to
often in example environments.







=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Thu Aug 28 08:13:37 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 28 Aug 1997 09:13:37 +0200
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>

At 17:53 27/08/97, friedrich.leisch@ci.tuwien.ac.at wrote:

>With help by Kurt and Martin I have written a short proposal for a new
>R doc source format that should be easier to parse using, e.g.,
>perl. There should be especially a clearer distinction between text
>and keywords.

What happened to the idea of using SGML for the new documentation
format?  
Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 28 09:17:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 28 Aug 1997 20:17:42 +1200 (NZST)
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <199708280817.UAA18043@stat1.stat.auckland.ac.nz>

I think SGML was an idea I was pushing,  but I don't have the time
to pursue it.  I'm not sure that the required tools are out there
yet anyway.  Friedrich's proposal has the definite advantage that
it will happen.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Aug 28 15:14:14 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 28 Aug 1997 16:14:14 +0200
Subject: R-alpha: Proposal for a new R doc source format
In-Reply-To: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>
References: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>
Message-ID: <199708281414.QAA01409@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 28 Aug 1997 09:13:37 +0200,
>>>>> Martyn Plummer wrote:

> At 17:53 27/08/97, friedrich.leisch@ci.tuwien.ac.at wrote:
>> With help by Kurt and Martin I have written a short proposal for a new
>> R doc source format that should be easier to parse using, e.g.,
>> perl. There should be especially a clearer distinction between text
>> and keywords.

> What happened to the idea of using SGML for the new documentation
> format?

Well, that's not too easy to explain ... first of all Kurt doesn't
like SGML (from his experience writing the FAQ in SGML) and he's my
boss, so I don't like it, too ;-)

More serious reasons:

1) More people writing R code will know LaTeX than SGML, so if we
have a LaTeX-like syntax it should be easier to learn. I want to keep
the new format as close to latex as possible such that it should be
very easy ...

2) Is the SGML-tools output not always really satisfying, and we would
have to extend the existing SGML formats anyway because it doesn't
support everything we want.

3) Is perl definetely on more systems installed than the sgml-tools.

For all this reasons (and some more which I don't remember right now)
I wouldn't like to make an R help system based on SGML, but if you
volunteer ...

Best,
Fritz

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 28 17:01:05 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 28 Aug 1997 12:01:05 -0400
Subject: R-alpha: pow_ii
Message-ID: <97Aug28.120241edt.26501@mailgate.bank-banque-canada.ca>


>> I'm a bit confused about this discussion, but since I don't have f2c on
...

>A lot of Fortran code doesn't require any libf2c routines.  When routines
>are needed the most common ones are the exponentiation routines pow_dd,
>pow_ii and pow_di (pow_ri is for single precision reals and so is less
>needed in R, which uses double precision).  However, *some* fortran code,
...

Thomas

>From your previous response to my confusion I guessed I would be ok
with pow_ii, but that does not seem to be the case:

R
...
>  dsecurve.function.tests(verbose=T) 
Random number generator tests ...ok
DSE curvature test 1 ... ld.so.1: /R/bin/R.binary: fatal: relocation error: symbol not found: pow_ii: referenced in /dse/dsefor.so
Killed

[4] /R : nm bin/R.binary | grep pow
[146]	|    244556|     312|FUNC |LOCL |0    |7      |complex_pow
[2557]	|   1462800|       0|FUNC |GLOB |0    |UNDEF  |pow
[2795]	|   1053360|      68|FUNC |GLOB |0    |7      |pow_dd
[2800]	|   1053124|     236|FUNC |GLOB |0    |7      |pow_di
[377]	|   1474036|       4|OBJT |LOCL |0    |15     |powerSymbol
[5] /R : 
[5] /R : R


This leads me to wonder how R calculates powers and exp for complex
numbers. I presume that if I can arrange to call the same routines then
I can avoid the extra burden of having to include parts of libf2c with
my distributed code. Do you know what R uses and can I call these from
fortran?

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 28 19:36:10 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 28 Aug 1997 11:36:10 -0700 (PDT)
Subject: R-alpha: Re: pow_ii
In-Reply-To: <97Aug28.120241edt.26501@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970828112057.7336A-100000@troi>

On Thu, 28 Aug 1997, Paul Gilbert wrote:

> Thomas
> 
> >From your previous response to my confusion I guessed I would be ok
> with pow_ii, but that does not seem to be the case:

No, pow_ii doesn't seem to be in there
 
> 
> This leads me to wonder how R calculates powers and exp for complex
> numbers. I presume that if I can arrange to call the same routines then
> I can avoid the extra burden of having to include parts of libf2c with
> my distributed code. Do you know what R uses and can I call these from
> fortran?

There is code in src/main/complex.c

This contains routines for powers, division and transcendental functions.
Unfortunately they are all declared static, so you can't use them. 

I don't know if there is any real need to make these static, apart from
tidiness (Anyone?) so it's possible that these could be changed in the
future.

Still, I liked Ross' suggestion of just making a f2c R package


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 28 19:49:03 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 28 Aug 1997 14:49:03 -0400
Subject: R-alpha: HTML help
Message-ID: <97Aug28.145036edt.26508@mailgate.bank-banque-canada.ca>

Below is a copy of the script I mentioned a few days ago, and Kurt
suggested I should post. It takes as input a single file of all the
html formatted function help, divides this into single files with
non-descriptive but unique and dos8.3 compatable names, and generates
both name and title indexes. It also changes the "see also"
functions to be links to the appropriate place in the name index.
(This is a compromise which was easier to do then link directly to the
appropriate file.) 

If you want to see how this approach to help works, look at

http://www.bank-banque-canada.ca/pgilbert/help/dsehome.htm

The indexes are generated from two html "NAME" tags I have written into
the html files, one for the function name and one for the function
title. eg.

<A NAME=stability><H1>stability</H1></A>
<A NAME=CalculatestabilityofaTSmodel>Calculate stability of a TSmodel</A><BR><HR>

The "see also" links are generated from the HREF tag, eg.

<H2>See Also</H2>
<UL>
<A HREF="#stability">stability</A>
</UL>


I have used a convention of .htm instead of .html because I wanted this
to work in DOS too. (I just noticed this has not been done in the R
html help.)

The generated files have "dse" prefixed to indicate my library. I tried
to make the prefix variable, but so far I haven't had any luck.

Another convention I have found very useful in maintaining help is to
embed the help directly into my coded files using /* */ multi-line
style comments to separate it from code. I then run these files through
an awk filter to separate the help into one file and the code into a
second. This can be done with a modified source() function within R or
S. Before I started to use this convention I found that I was
duplicating much of the documentation into comments in the code, and in
fact the comments in the code were often much more accurate than the
help files.


Paul Gilbert

______
#!/bin/sh

if [ $# -ne 2 ]; then
  echo usage:
  echo "  build.HTML.help2  sourcefile targetlocation"
  echo "   where sourcefile is a file of all the HTML help and"
  echo "       targetlocation is the target directory"
  exit
fi 


# I haven't been able to get the variable substitution to work 
#    in some places where there are quotes
# PREFIX is added to the beginning of all generated help files
# PREFIX should not be more than 3 character for dos compliance
# PREFIX=dse

#intro is an html file used as the starting point for 
#   a browser (eg home.htm or index.htm)
#intro=dsehome.htm

tmphelp=$1
help=$2
mkdir -p $help
cd $help  

echo help directory set to $help
# This script expects to find the two files:
#     $tmphelp (all function help) and dsehome.htm (the introduction)
# The function help in the file $tmphelp is broken into individual files and
# an indexes built. $tmphelp is removed on completion.

# A function index is built from the <A NAME= ... ><H1> lines
# and  title index is built from the other <A NAME=  lines.
# These are put in the file dsefidx.htm and dsetidx.htm respectively

echo "number of NAME lines in $tmphelp " `grep NAME $tmphelp | wc -l`
echo "(The number of NAME lines is aprox. 2 times the number of help functions)"

#  Step 1 -  break up  functions into alphabetical sub-files.

sed  "s/<A NAME=\(.*\)><H1>\(.*\)/@<A NAME=\1><H1>\2/g" $tmphelp >zot2$$

# The next line converts line breaks to ; then converts @ to line breaks
tr '\012'  '\073' <zot2$$ | tr '@' '\012'  >zot3$$

echo "1st check: the number of help functions is about " `wc -l <zot3$$`

split -1 zot3$$ $help/dseH
rm zot2$$ zot3$$

echo "2nd check: the number of help functions is about " `ls -l dseH* | wc -l`


#  Step 2 - convert See Also references to point to the function index, eg:
# <A HREF="#TSmodel"> TSmodel</A>
# or
# <A HREF=#TSmodel> TSmodel</A>
# or
# <A HREF=TSmodel> TSmodel</A>

# to
# <A HREF="dsefidx.htm#TSmodel"> TSmodel</A>

# and first convert ; back to <cr>

for f in `ls dseH[a-z]*`
do
  tr '\073' '\012'<$f | sed 's/<A HREF="\(.*\)">\(.*\)/<A HREF="\1">\2/g' >zotaa
  sed 's/<A HREF="#\(.*\)">\(.*\)/<A HREF="#\1">\2/g' zotaa >zotbb
  sed 's/<A HREF="#\(.*\)">\(.*\)/<A HREF="dsefidx.htm#\1">\2/g' zotbb >$f.htm
  echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>$f.htm
  rm $f
done
rm  zotaa zotbb 

# Step 3 - build Function and Title indexes dsefidx.htm and dsetidx.htm

grep "<A NAME=" dseH[a-z]*.htm | grep -v "<H1>" >zotT$$
grep "<A NAME=" dseH[a-z]*.htm | grep "<H1>" >zotN$$

# build Index to functions by Name


echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR><A NAME=IndexbyFunctionName><H1>Index to Functions by Name</H1></A><HR><HR>' >dsefidx.htm

# use grep output of file name in eg
# dseHaa.htm:<A NAME=arma><H1>ARMA</H1></A>
#           \1              \2       \3

# to insert HREF links (but leave NAME for jump into index) eg
# <A NAME=->arma</A><A HREF=dse1.htm>ARMA</A><BR>
#            \2                \1       \3
 
sed 's/<H1>//g' zotN$$ | sed 's/<\/H1>//g' | sed 's/<HR>//g' | sed 's/<BR>//g' >zotN5$$
sed 's/\(.*\):<A NAME=\(.*\)>\(.*\)<\/A>/<A NAME=\2>-<\/A><A HREF=\1>\3<\/A><BR>/g' zotN5$$ >zotN6$$

sort -f <zotN6$$ >>dsefidx.htm
rm zotN[1-6]*$$

echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>dsefidx.htm


# build Index to functions by Title

echo '<HR><HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR><A NAME=IndexbyTitle><H1>Index to Functions by Title</H1></A><HR><HR>' >dsetidx.htm

sed "s/<HR>//g" zotT$$  >zotT2$$
sed "s/<BR>//g" zotT2$$ >zotT3$$
sed "s/\(.*\):<A NAME=\(.*\)>\(.*\)<\/A>/<A NAME=\2>-<\/A><A HREF=\1>\3<\/A><BR>/g" zotT3$$ >zotT4$$

sort -f <zotT4$$ >>dsetidx.htm
rm zotT[1-6]*$$

echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>dsetidx.htm

rm zot?$$
#  $tmphelp

echo "number of help functions in title index    " `wc -l <dsetidx.htm` "-2"
echo "number of help functions in function index " `wc -l <dsefidx.htm` "-2"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 29 17:47:26 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 29 Aug 1997 18:47:26 +0200
Subject: SUMMARY: R-alpha: Can we "require"  1) GNU make,  2) Perl
In-Reply-To: <Pine.SUN.3.95.970825094416.1542D-100000@avon> (message from
 Thomas Lumley on Mon, 25 Aug 1997 09:48:15 -0700 (PDT))
Message-ID: <199708291647.SAA08655@sophie.ethz.ch>

Just to 'clean up' the week,  a summary about my 'RFC' :

The reactions I got (not all went thru  R-devel):

1) perl is ok  (--> new 'R doc/man' format by Fritz Leisch & Kurt Hornik ...)

2) GNU make is not really ok.

 Some people like to use their vendor's make rather than GNU's
	[I myself have changed this behavior a few years ago;
	 here, we all PATH such that GNU's make comes BEFORE Sun's make ..]

==> I'll try not to rely on GNU make at all.

	[[Actually I haven't done too much yet, 
	  just created an  etc/Makefile and
	  moved things from $RHOME/Makefile there..]]


--- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Sun Aug 31 20:34:59 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Sun, 31 Aug 1997 12:34:59 -0700 (PDT)
Subject: R-alpha: ?bug in [.data.frame
In-Reply-To: <199708311138.NAA13464@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SOL.3.95.970831122953.22219B-100000@gorn>


If you subscript a data frame using the names of the columns and there is
more than one column with the same name only the first one is found.
eg
	mm<-data.frame(1:10,log(1:10))
	names(mm)<-c("(offset)","(offset)")
	mm[,"(offset)"]			# only returns first column
	mm[,"(offset)"]<-rep(1,10)	# only sets first column

This *is* compatible with S, but I still think it's the wrong thing to do.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Aug 31 21:11:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 31 Aug 1997 22:11:54 +0200
Subject: R-alpha: ?bug in [.data.frame
In-Reply-To: Thomas Lumley's message of Sun, 31 Aug 1997 12:34:59 -0700 (PDT)
References: <Pine.SOL.3.95.970831122953.22219B-100000@gorn>
Message-ID: <x2g1rq6rjp.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> If you subscript a data frame using the names of the columns and there is
> more than one column with the same name only the first one is found.
> eg
> 	mm<-data.frame(1:10,log(1:10))
> 	names(mm)<-c("(offset)","(offset)")
> 	mm[,"(offset)"]			# only returns first column
> 	mm[,"(offset)"]<-rep(1,10)	# only sets first column
> 
> This *is* compatible with S, but I still think it's the wrong thing to do.

This is a generic list thing. Nothing keeps you from having several
elements with the same name, you just get certain problems accessing
them. 

> l<-list(1,2,3)
> names(l)<-c("a","b","b")
> l
$a
[1] 1

$b
[1] 2

$b
[1] 3

> l$b
[1] 2

I rather strongly suspect that coding for the possibility, that in a
list of vectors l$b could mean another list, would be a real pain.
I.e. you deserve what you get...

If you must have identically named columns, try something along the
lines of

> l[names(l)=="b"]
$b
[1] 2

$b
[1] 3

> l[names(l)=="b"]<-4
> l
$a
[1] 1

$b
[1] 4

$b
[1] 4


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: Bugs in R-0.50-a1.
In-Reply-To: <9707290928.AA07210@alpha.luc.ac.be>
References: <9707290928.AA07210@alpha.luc.ac.be>
Message-ID: <199708011154.NAA20022@aragorn.ci.tuwien.ac.at>

>>>>> Patrick Lindsey writes:

> Problems in R but not in S:
> ---------------------------

> 1) 'unlist' seems to have several other problems than the ones
> reported up to now. For instance, 'unlist' can be used on almost any
> object in S without much trouble. Eg.:
S> unlist(c(2))
> 	[1] 2
S> 
> 	---
R> unlist(c(2))
> 	Segmentation fault (core dumped)
> This occurs in R-0.49 and in R-0.50-a1.

Confirmed.

> 1) The 'R Graphics' window does not have any X class or resource and
> therefore cannot be given a default size or geometry. Would it be
> possible to give the graphic window a class name so that the size
> could be specified in the '.Xdefaults' file?

Yes, that would be nice.

> 3) Some problems occur when using the help. Eg.,
R> ?"+"
> sorry, no help for "Arithmetic".
R> 
> This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
> any item contained in a help file starting with a capital letter.

The problem is as follows.  The function help() catches the special funs
like "+" etc (more precisely, the arithmetic, comparison, logic and
extract ones) and directly assigns a topic for them.

For "+", the topic is 'Arithmetic".  But the index file has no entry for
that, because (see RHOME/etc/install-help)

***********************************************************************
if [ $lib != 'base' ]
##-- The following is NOT done anymore in 'base':
##-- 1) Each help file should have  ALIAS(..) for  ALL it's objects
##-- 2) The  help file name may differ from _ANY_ object (eg 'Special')
then 
	for file in $FILES
	do
		echo "$file	$file"
	done
fi
***********************************************************************

If that really is the intended usage (Martin?), then e.g. the Arithmetic
file should also have ALIAS(Arithmetic) in it.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: R 0.50.a1 graphics
Message-ID: <199708011154.NAA20025@aragorn.ci.tuwien.ac.at>

Here are some misc comments on graphics.

* I am not sure whether `adj' works correctly.  When using e.g.

	title(sub = "SUBTITLE", adj = 0)

shouldn't the subtitle appear on the very left?  It seems that
justification is done off the middle of the plot window.

* S barplot has argument `horiz', R does not.

* More importantly, the barplot() argument `space' is treated
differently under R and S.

S has,

	the space (as a fraction of the average bar width) that
	should be left before each bar.
	This may be given as a single number or one number per bar.
	If `beside' is `TRUE', `space' may be specified by 2 numbers
	where the first is the space between bars in a set,
	and the second is the space between sets.

R has,

	the relative amount of space between the bars or groups of
	bars. The width of a bar (or group of bars) plus the value of
	space is one.

The S behavior is perhaps more useful, as it allows to have groups of
bars.

* The documentation for title() does not mention `sub'

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 12:54:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 13:54:36 +0200
Subject: R-alpha: R 0.50.a1 bug in do_title()
Message-ID: <199708011154.NAA20023@aragorn.ci.tuwien.ac.at>

There is an empty `else' clause in the code for do_title() in
src/main/plot.c (which results in subtitles appearing twice, or some
other strange thing ...).

Below is a `patch'.

-k

*** src/main/plot.c.orig	Fri Aug  1 10:17:41 1997
--- src/main/plot.c	Fri Aug  1 10:18:05 1997
*************** SEXP do_title(SEXP call, SEXP op, SEXP a
*** 1224,1231 ****
  
  	if (CAR(args) != R_NilValue && LENGTH(CAR(args)) > 0)
  		sub = CAR(args);
- 	else
- 		
  	args = CDR(args);
  
  	if (CAR(args) != R_NilValue && LENGTH(CAR(args)) > 0)
--- 1224,1229 ----
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug  1 15:04:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 1 Aug 1997 16:04:48 +0200
Subject: R-alpha: R-beta: RPM package for R
In-Reply-To: <199707292358.LAA18350@stat1.stat.auckland.ac.nz>
References: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
 <199707292358.LAA18350@stat1.stat.auckland.ac.nz>
Message-ID: <199708011404.QAA20492@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Martyn Plummer writes in r-announce:
>> A precompiled "RPM" binary of R-0.50.a1 is now available on CRAN for
>> installation on Linux systems which use the RedHat Package
>> Manager

> Before we get to may versions floating about ... 

> I had intended that these "a1", "a2" ... releases be hacker releases
> which will be followed by a R-0.50.stable release when the (worst)
> problems are sorted out.  Thats why I announced to "r-devel" rather
> than "r-announce".

> (Note this is information rather than any kind of policy statement,
> you are of course free to do whatever you like with R)

Sorry everyone,

This was mostly my mistake.  Martyn sent me an email that he had
uploaded the packages to CRAN incoming, and I was only in my office for
a few minutes, so without further thinking I moved them into CRAN/src
and told Martyn that I had done so and that he might announce the
packages now.

>From a user perspective, the bugs are perhaps not that bad (well, 
ignoring the shortest segfaulter `unlist(1)'), but anyway ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Aug  2 16:55:05 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 2 Aug 1997 17:55:05 +0200
Subject: R-alpha: Re: ?"+"; ALIAS(Arithmetic)
In-Reply-To: <199708011154.NAA20022@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 1 Aug 1997 13:54:36 +0200)
Message-ID: <199708021555.RAA14833@florence.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Patrick Lindsey writes:
    >> Problems in R but not in S: ---------------------------
    ......

    >> 3) Some problems occur when using the help. Eg.,
    R> ?"+"
    >> sorry, no help for "Arithmetic".
    R>
    >> This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
    >> any item contained in a help file starting with a capital letter.

    Kurt> The problem is as follows.  The function help() catches the
    Kurt> special funs like "+" etc (more precisely, the arithmetic,
    Kurt> comparison, logic and extract ones) and directly assigns a topic
    Kurt> for them.

    Kurt> For "+", the topic is 'Arithmetic".  But the index file has no
    Kurt> entry for that, because (see RHOME/etc/install-help)
			.......

    Kurt> If that really is the intended usage (Martin?), then e.g. the
    Kurt> Arithmetic file should also have ALIAS(Arithmetic) in it.

Yes, this is the thing to do.

It was R&R's idea to change the usage of  ALIAS(.).
[[Again: an ALIAS(..) should be made for  EVERY  R object that is
	 documented in that man file, and sometimes even for things such as
  Special or Arithmetic
]]

The current  etc/install-help  
was made by me in order to merge the former  install-help and
install-libhelp (Kurt, this answers another question of you) and
reflects the fact that the help files in the libraries have not (yet!?)
been adapted to the new scheme.

I think, we should decide to upgrade the help files of the libraries --
(eda & mva) and ALL the 'contrib' ones !! -- to the new scheme.

The only thing: The upgrade should happen  'SIMULTANEOUSLY'
such that a simple change to etc/install-help then would make things work.
A good time to do this would be  "about now", i.e. before another alpha
release and (somewhat ?) close to THE 0.50 beta relase...

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Aug  2 23:40:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Aug 1997 00:40:44 +0200
Subject: R-alpha: .RData zapped by system shutdown
Message-ID: <x2pvrw2opf.fsf@bush.kubism.ku.dk>


Watch:

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Alpha-1 (July 22, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

[Previously saved workspace restored]

Error: restore file corrupted -- no data loaded

---

-rw-r--r--   1 pd       users      0 Aug  1 12:46 /home/pd/R-sandbox/.RData

---

Aug  1 12:46:27 blackbird init: Switching to runlevel: 6
Aug  1 12:46:28 blackbird getty[197]: exiting on TERM signal

---

"Houston, we have a problem here".... As I remember, R was just
sitting in an xterm window doing nothing when the system was taken
down. This is weird, because as far as I can tell from the source, R
shouldn't try to save the workspace in an interactive session without
user confirmation. 

One possible scenario to explain it is that when the xterm got killed,
R's standard input was closed *and detached from the pty*, so that the
evaluation loop terminates, isatty(0) returns 0, forcing a save of the
GlobalEnv, during which the R process itself got terminated.

Fix? First of all, I suggest that the original .RData be rename()'d
before it is opened for writing (the backup may or may not be removed
afterwards). Secondly, do we really want this behaviour where isatty()
is called at a very late stage, or would we rather have the logic
depend on R_interactive? The cases to consider is when an interactive
session gets backgrounded, or loses its controlling terminal. And
shouldn't there be a signal handler for the TERM signal, to ensure
that things get wrapped up?

[Fortunately, the important bits of that workspace had been dumped out
previously, so I didn't lose much]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Aug  3 15:22:13 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Aug 1997 16:22:13 +0200
Subject: R-alpha: One-row frames don't work
Message-ID: <x2hgd7ny7d.fsf@bush.kubism.ku.dk>


While trying to write a half-decent predict.lm, I stumbled upon this
obstacle:

> data.frame(x=2)
  x
> data.frame(x=1:2)
     x
[1,] 1
[2,] 2

BTW, there really isn't a working predict() floating around, is there?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 10:47:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 11:47:35 +0200
Subject: R-alpha: 0.50-a1 -- "more lost comments"
Message-ID: <199708040947.LAA28328@sophie.ethz.ch>

In CHANGES, it says

------------------------------------------------------------
>> BUG FIXES

   ........

>>  o  Comments are handled better in functions.  The rule is that they
>>     are shifted to just before their statements.  Comments after the
>>     last statement of a function are lost.
------------------------------------------------------------
I think we could live with the above advertized behavior.
Unfortunately, in the following case 'xx1' even a comment BEFORE the last
statement is lost 
 ((because the last statement is so trivial ???,
   it is NOT lost in the  'xx1a' example  (and in others I tried)) :

This is in plain  0.50-a1 :

> xx1 <- function(x) {
+  ##--- a Start-comment ... (lost in 0.50-a1)
+  x
+ }
> xx1 
function (x) 
{
        x
}


> xx1a <- function(x) {
+   ##--- a Start-comment ... (ok in 0.50-a1)
+   x+1
+ }
> xx1a
function (x) 
{
        ##--- a Start-comment ... (ok in 0.50-a1)
        x + 1
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: pow_dd
Message-ID: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>

Hmm ... It seems that as of 0.50.a1 we need to link against f2c because
pow_dd is no longer provided (internally, POW_DD is used).  I am not
sure how much sense that really makes, but it would seem that getting
the things from 0.49 f2clib.c back would be great ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: `axes' argument for barplot()
Message-ID: <199708041115.NAA21208@aragorn.ci.tuwien.ac.at>

Clearly, barplot should have an `axes' argument.  The following trivial
patch does that ... pls apply.

-k

*** src/library/base/funs/barplot.orig	Sat Aug  2 15:58:44 1997
--- src/library/base/funs/barplot	Sat Aug  2 16:00:22 1997
***************
*** 1,7 ****
  "barplot" <-
  function (height, names.arg, col=NULL, border=par("fg"),
  	beside=FALSE, space=0.2, legend.text,
! 	main=NULL, xlab=NULL, ylab=NULL, xlim, ylim, ...)
  {
  	opar <- par(yaxs="i", xpd=TRUE)
  	on.exit(par(opar))
--- 1,7 ----
  "barplot" <-
  function (height, names.arg, col=NULL, border=par("fg"),
  	beside=FALSE, space=0.2, legend.text,
! 	main=NULL, xlab=NULL, ylab=NULL, xlim, ylim, axes = TRUE, ...)
  {
  	opar <- par(yaxs="i", xpd=TRUE)
  	on.exit(par(opar))
*************** function (height, names.arg, col=NULL, b
*** 68,72 ****
  			xjust=1, yjust=1)
  	}
  	title(main=main, xlab=xlab, ylab=ylab, ...)
! 	axis(2)
  }
--- 68,73 ----
  			xjust=1, yjust=1)
  	}
  	title(main=main, xlab=xlab, ylab=ylab, ...)
! 	if (axes)
! 		axis(2)
  }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: sd2rd version 0.1-5
Message-ID: <199708041115.NAA21212@aragorn.ci.tuwien.ac.at>

Oops,
Just found a typo.  Here's the updated version.
-k

***********************************************************************
#!/usr/bin/perl

$VERSION = "0.1-5";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &section(0, "SECTION(Side Effects @@"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &section(0, "SECTION($word[1] @@");
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par))) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: ???
Message-ID: <199708041115.NAA21213@aragorn.ci.tuwien.ac.at>

Is there any reason why the third argument to text() is called `text' in
R versus `labels' in S (I mean, other than that it makes more sense)?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: scale()
Message-ID: <199708041115.NAA21211@aragorn.ci.tuwien.ac.at>

Here is a version of the function scale() which may be worth adding to
the distribution.  No NA's yet, though.  And yes, I could also write
documentation if necessary ...

-k

***********************************************************************
scale <- function(x, center = TRUE, scale = TRUE) {
  x <- as.matrix(x)
  nc <- ncol(x)
  if (is.logical(center)) {
    if (center)
      x <- sweep(x, 2, apply(x, 2, mean))
  }
  else if (is.numeric(center) && (length(center) == nc))
    x <- sweep(x, 2, center)
  else
    stop("Length of center must equal the number of columns of x")
  if (is.logical(scale)) {
    if (scale)
      x <- sweep(x, 2, apply(x, 2, function (v)
			     sum(v^2) / max(1, length(v) - 1)), "/")
  }
  else if (is.numeric(scale) && length(scale) == nc)
    x <- sweep(x, 2, scale, "/")
  else
    stop("Length of scale must equal the number of columns of x")
  x
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:15:54 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:15:54 +0200
Subject: R-alpha: ports ...
Message-ID: <199708041115.NAA21209@aragorn.ci.tuwien.ac.at>

Just wanted to mention that I've more or less successfully completed
ports of the V&R library `class' (I hope I can also have lda and qda in
there soon) and the library `clus' by Anja Struyf, Mia Hubert, and Peter
J. Rousseeuw provided via the Journal of Statistical Software, volume 1.
For `clus', the plots needed to be rotated because R barplot does not
support the `horiz' argument yet (and having `scale' work as in S would
also be nice)

I've added the current versions into my r-contrib Debian package, and
will officially release them after 0.50 is out.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug  4 12:35:42 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 4 Aug 1997 13:35:42 +0200
Subject: R-alpha: Re: your mail
In-Reply-To: <Pine.LNX.3.96.970802190706.1843A-100000@buffy>
References: <199708011340.PAA20453@aragorn.ci.tuwien.ac.at>
 <Pine.LNX.3.96.970802190706.1843A-100000@buffy>
Message-ID: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Fri, 1 Aug 1997, Kurt Hornik wrote:
>> Thomas,
>> 
>> Could you add the "-lf2c" at the end of the line
>> @$(LD) $(SHLIBLDFLAGS) -o $(LIBNAME).so $(OBJS)
>> in acepack's src-c/Makefile?
>> 
>> I ran across an identical pow_dd problem recently with another package.
>> Did we always need the "-lf2c", or is this a feature of the new version?
>> 

> This is very strange.  My copy works ok as is, in all the versions of
> R I have installed (including 0.50a1). On the other hand, using nm
> reveals that R0.50 has replaced pow_dd and pow_di by f77_pow_dd and
> f77_pow_di respectively.  It looks like the builtin subset of libf2c
> has vanished.  This is a problem, as we should not require people to
> have f2c in order to run the C version of the library -- after all, if
> they had f2c they could run the FORTRAN version.

You're right, see also one of my previous mails.  They now have POW_DD
and f77_pow_dd (where does this come from, anyway).  I think that in the
``old days'' we were lucky that everything was based on C, so FORTRAN
was converted using f2c and compatibility functions were provided by the
distribution proper.  Of course, in general one cannot expect that ALL
functions needed after using f2c would be in a compatibility library,
unless it was identical to libf2c ...

But clearly, pow_dd and pow_di should exist again ...

> I'll also do the version numbers.  I should probably regenerate all
> the help files, and there may also be more changes to survival4 now
> that array subsetting works properly.  Unfortunately the test file now
> doesn't work, as R batch mode terminates on errors, and the file stops
> at the first unimplemented feature.

O.k., no problem.  As long as there are packages maintained by me
without version numbers ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:02:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:02:08 +0200
Subject: R-alpha: scale()
In-Reply-To: <199708041115.NAA21211@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 4 Aug 1997 13:15:54 +0200)
Message-ID: <199708041302.PAA28454@sophie.ethz.ch>

Lieber Kurt,

vielen Dank f=FCr Deine neuen  R Funktionen,...
Ja, die scheinen n=FCtzlich.

Was Du vergessen (oder extra nicht gesagt) hast:

=09Die Funktionen existieren in S(-plus).

Ich wuerde dies doch erw=E4hnen in Deinen 'Posts' als Motivation, wieso
=FCberhaupt...

Und, ideal w=E4re schon, gerade ein shar-file zu bekommen, welches in
in RHOME  oder  RHOME/src/library/base
ausgepackt w=FCrde, und sowohl   funs/FOO  als auch  man/FOO  enthielte,
das 'man' inklusive EXAMPLES(.)...

  [dann k=F6nnte auch ich die Funktionen in den Source tree installieren...=
]

--
Martin=
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:10:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:10:50 +0200
Subject: R-alpha: Re: pow_dd & pow_di [was f2clib.c  etc..] --  yes, please !
In-Reply-To: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 4 Aug 1997 13:35:42 +0200)
Message-ID: <199708041310.PAA28457@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Thomas Lumley writes:
    >> On Fri, 1 Aug 1997, Kurt Hornik wrote:
    >>> Thomas,
    >>> 
    >>> Could you add the "-lf2c" at the end of the line @$(LD)
    >>> $(SHLIBLDFLAGS) -o $(LIBNAME).so $(OBJS) in acepack's
    >>> src-c/Makefile?
    >>> 
    >>> I ran across an identical pow_dd problem recently with another
    >>> package.  Did we always need the "-lf2c", or is this a feature of
    >>> the new version?
    >>> 

    >> This is very strange.  My copy works ok as is, in all the versions
    >> of R I have installed (including 0.50a1). On the other hand, using
    >> nm reveals that R0.50 has replaced pow_dd and pow_di by f77_pow_dd
    >> and f77_pow_di respectively.  It looks like the builtin subset of
    >> libf2c has vanished.  This is a problem, as we should not require
    >> people to have f2c in order to run the C version of the library --
    >> after all, if they had f2c they could run the FORTRAN version.
yep
    Kurt> You're right, see also one of my previous mails.  They now have
    Kurt> POW_DD and f77_pow_dd (where does this come from, anyway).  I
    Kurt> think that in the ``old days'' we were lucky that everything was
    Kurt> based on C, so FORTRAN was converted using f2c and compatibility
    Kurt> functions were provided by the distribution proper.  Of course,
    Kurt> in general one cannot expect that ALL functions needed after
    Kurt> using f2c would be in a compatibility library, unless it was
    Kurt> identical to libf2c ...

    Kurt> But clearly, pow_dd and pow_di should exist again ...

Even more: I think it's just these two which should 
	'officially' part of the R binary, i.e., their sourc should be in
	src/main/  or src/math/  rather than in appl  or somewhere.

I think there are several instances in the current  R source tree, where
the code could be improved by using  pow_d{d|i}(..).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug  4 14:13:03 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Aug 1997 15:13:03 +0200
Subject: R-alpha: scale()
In-Reply-To: Martin Maechler's message of Mon, 4 Aug 1997 15:02:08 +0200
References: <199708041302.PAA28454@sophie.ethz.ch>
Message-ID: <x2n2my2isg.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Lieber Kurt,
> 
> vielen Dank für Deine neuen  R Funktionen,...
> Ja, die scheinen nützlich.
> 
> Was Du vergessen (oder extra nicht gesagt) hast:
...

- und was Du vergisst ist dein CC:-header zu redigieren.... 

§;^{)>

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 14:15:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 15:15:34 +0200
Subject: R-alpha: Excuse the German post to R-devel...
Message-ID: <199708041315.PAA28466@sophie.ethz.ch>

it was intented to just go to Kurt..

Excuse again...	Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug  4 17:15:49 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 4 Aug 1997 18:15:49 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708041615.SAA28741@sophie.ethz.ch>

I am sorry that this IS an old topic.
Yet another task
I think the bug is somewhere in hidden  in  src/main/options.c ..

##-- The following does not work as it should in  R (0.50-a1, but I think
							also earlier)

tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
tst()
tst(dig = 12)


##-- This should do the same; it works as expected in R & S :

tst2 <- function(x=pi, dig =3) {
  oo <- options(digits=dig); on.exit(oo); print(x);x}
tst2()
tst2(dig = 12)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug  4 18:36:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Aug 1997 19:36:24 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: Martin Maechler's message of Mon, 4 Aug 1997 18:15:49 +0200
References: <199708041615.SAA28741@sophie.ethz.ch>
Message-ID: <x2g1spq293.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> I am sorry that this IS an old topic.
> Yet another task
> I think the bug is somewhere in hidden  in  src/main/options.c ..
> 
> ##-- The following does not work as it should in  R (0.50-a1, but I think
> 							also earlier)
> 
> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
> tst()
> tst(dig = 12)
> 
> 
> ##-- This should do the same; it works as expected in R & S :
> 
> tst2 <- function(x=pi, dig =3) {
>   oo <- options(digits=dig); on.exit(oo); print(x);x}
                               ^^^^^^^^^^^
                           on.exit(options(oo))

> tst2()
> tst2(dig = 12)

I'm not sure this is a bug at all, given the scoping rules, etc.
However, things are strange. Consider the following:

> f<-function(){print(a$b);a$b<-pi;print(a$b)}
> f()
[1] 2
[1] 2
> f<-function(){print(a$b);a<-a;a$b<-pi;print(a$b)}
> f()
[1] 2
[1] 3.141593

The difference is that in the first case, a is in .GlobalEnv, and not
modifiable with "<-" ("<<-" works). Apparently, "$<-" won't
automatically create a copy of a in the current environment which is
what I had expected. Still, creating .Options explicitly in tst()
doesn't work, which fact is probably due to the digits argument in
print.default defaulting to NULL, and print.default has no reason to
look on the frame stack for .Options.

However, changing the print.default definition to

print.default<-function (x, digits = eval(expression(.Options$digits),
sys.frame(sys.parent())), quote = TRUE, na.print = NULL, print.gap = NULL) 
{
        .Internal(print.default(x, digits, quote, na.print, print.gap))
}

*and*

tst<-function (x = pi, dig = 3) 
{
        .Options <- .Options
        .Options$digits <- as.integer(dig)
        print(x)
        x
}


does seem to do what you wanted...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug  4 23:12:38 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 10:12:38 +1200 (NZST)
Subject: R-alpha: pow_dd
In-Reply-To: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>
References: <199708041115.NAA21210@aragorn.ci.tuwien.ac.at>
Message-ID: <199708042212.KAA12791@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > Hmm ... It seems that as of 0.50.a1 we need to link against f2c because
 > pow_dd is no longer provided (internally, POW_DD is used).  I am not
 > sure how much sense that really makes, but it would seem that getting
 > the things from 0.49 f2clib.c back would be great ...

I was worried about name conflicts with systems which do not follow
the f77/f2c standard.  I will put these back the old way and make it
possible to #define NONSTANDARD_F77LIBS or somesuch to get the new
effect if it is needed.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug  4 23:34:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 10:34:14 +1200 (NZST)
Subject: R-alpha: Re: pow_dd & pow_di [was f2clib.c  etc..] --  yes, please !
In-Reply-To: <199708041310.PAA28457@sophie.ethz.ch>
References: <199708041135.NAA21247@aragorn.ci.tuwien.ac.at>
 <199708041310.PAA28457@sophie.ethz.ch>
Message-ID: <199708042234.KAA14790@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
 > Even more: I think it's just these two which should 
 > 	'officially' part of the R binary, i.e., their sourc should be in
 > 	src/main/  or src/math/  rather than in appl  or somewhere.
 > 
 > I think there are several instances in the current  R source tree, where
 > the code could be improved by using  pow_d{d|i}(..).

I think that there are two problems here.

 1. Providing support for functionality in the R core (all C code).

 2. Supporting code in external libraries (mainly f77).

I think it might be useful to keep these problems separate.

We can certainly put in support for a wider range of "pow" functions
and any other math functions.  Putting these in the "math" library
seems natural.

One possible solution to the second problem would be to declare that R
will work with f2c generated code and anything compatible with it.
This is pretty extreme though.  On more exotic platforms it would be
nice to use custom blas etc.

Better dyn.load support is on the way (complements of GNU dld 4) and
this may well solve problem 2 above.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug  5 01:20:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 4 Aug 1997 17:20:18 -0700 (PDT)
Subject: R-alpha: f2c compatibility
In-Reply-To: <199708042234.KAA14790@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970804171330.10278A-100000@chekov>

On Tue, 5 Aug 1997, Ross Ihaka wrote:
> I think that there are two problems here.
> 
>  1. Providing support for functionality in the R core (all C code).
> 
>  2. Supporting code in external libraries (mainly f77).
> 
> I think it might be useful to keep these problems separate.
> 

I agree. I don't think it is necessarily a good idea for R to contain all
of libf2c that we might want to use.  My question was much simpler: 

Should we assume in creating libraries with C translations of FORTRAN that
ld -lf2c works, or should we explicitly include the C source for functions
that we call (as R does with pow_dd and pow_di)?


	-thomas


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Aug  5 06:00:03 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 Aug 1997 17:00:03 +1200 (NZST)
Subject: R-alpha: Version 0.50-a1 patches
Message-ID: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>

A set of patches for R-0.50-a1 is now available as
	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
The patches mainly fix problems reported since R-0.50-a1 but some
older problems are also fixed.

Here is the list of changes.
	Ross

 o  Many subsetting and mutation problems with the new "expression" type
    have now been fixed.

 o  When ask=T is set in par() the user is instructed
	"Press <Return> for next plot:"
    rather than asked
	"Next Plot?"

 o  The infinite recursion observed by in Kurt Hornik in:
	R> test2
	function (x) 
	{
		attr(x, "call") <- sys.call()
		x
	}
	R> test2(x)
	Error: stack overflow
    has been cured.  There may be one or two more of these.  All the
    xxxx<- functions should be checked.

 o  Patches from Benjamin Bolker to cure some line type problems has
    been applied.

 o  Fixed the t(table(0)) problem (1-d arrays not quite handled right).

 o  Changed naming back so that pow_dd etc are available.

 o  Patches to barplot and text from Kurt Hornik.

 o  When x was a data frame,
	mode(x) <- "character"
	x
    caused a crash.  This was because a class of "data.frame"
    was being attached to a character vector.  Now only lists
    can become data frames.

 o  There is now a -gdb option to the R front end as well as -xxgdb.

 o  Documentation of NChisquare fixed.

 o  Definition of S_alloc fixed.

 o  Changed the names of seeds_in and seeds_out to seed_in and
    seed_out as per Kurt's request.

 o  "unlist(c(2))" fixed.

 o  "data.frame(x=2)" fixed.

 o  Bug in do_title fixed.

 o  Scoping for subset methods by forcing an eval of the args on
    entry fixed (bug reported by Patric Lindsay).

 o  subsetting of data frames fixed .

 o  Misc problems in Rdoc.sty reported by Kurt Hornik fixed.
 
 o  Permissions in the data subdir for quakes and sunspots fixed.

 o  Segfault in dimnames mutation
	R> x <- 1:5
	R> dimnames(x)[1,2] <- NULL
    fixed.

 o  It was observed that
	> D(expression(z * (log(z) /z)), "z")
    returns
	(log(z)/z) + z * (1/z/z - log(z)/z^2)
    This is exactly what S-Pus produces.

 o  Added the option -B 8192 to m4 in the etc/doc2* files to keep
    m4 happy.

 o  New functions "as.ordered", "data.class" and "scale" from, Kurt
    Hornik added.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug  5 10:55:58 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Aug 1997 11:55:58 +0200
Subject: R-alpha: Version 0.50-a1 patches
In-Reply-To: Ross Ihaka's message of Tue, 5 Aug 1997 17:00:03 +1200 (NZST)
References: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
Message-ID: <x2sowp3qdt.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> A set of patches for R-0.50-a1 is now available as
> 	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
> The patches mainly fix problems reported since R-0.50-a1 but some
> older problems are also fixed.
..
>  o  It was observed that
> 	> D(expression(z * (log(z) /z)), "z")
>     returns
> 	(log(z)/z) + z * (1/z/z - log(z)/z^2)
>     This is exactly what S-Pus produces.

Heyheyheyheeeyyy, no need to resort to name calling, next thing,
you'll be talking about Windoze, HP-SUX, and Slowlaris! ;)

>  o  New functions "as.ordered", "data.class" and "scale" from, Kurt
>     Hornik added.
[The end]

Hmm. The "move .RData before writing to it" fix didn't seem to make
it. It's a one-liner (in the most primitive version), and really quite
important. Actually, the problem is worse than I thought initially:
.RData can get zapped to a zero-length file whenever you destroy the
xterm window containing R, not only on system shutdown. This happens
on both of my Linux boxes, but it's probably a quite generic race
condition.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 11:44:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 12:44:48 +0200
Subject: R-alpha: Version 0.50-a1 patches -- New and old bugs..
In-Reply-To: <199708050500.RAA08160@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 5 Aug 1997 17:00:03 +1200 (NZST))
Message-ID: <199708051044.MAA00635@sophie.ethz.ch>

Thank you !
~~~~~~~~~~~

The new patches
	 (which incidentally make  0.50-a1 into  0.50-a2
	  IF you run ./configure)
really do quite a few good things.

A few comments.

1) I had to do the following to make things compile and link properly

   in	appl/cpoly.c :  line  42 : OUT-commented  (pow_di) 
   otherwise compiler barfed about redefined  pow_di	[Solaris 2.5, Sun cc]

2) In order for 'legend' and 'barplot' to work I had to edit
	src/library/base/funs/legend: 
   Last line: replace 'text=' by 'labels='  [reflect change of text(...)]

NOTE: After applying the patch, I recommend the following

    make clean
    configure
    make
    make install
    make tests install-latex install-help install-html

---------------------
Further notes:

3) Whereas  unlist(1), unlist(c(2)), etc. work,
   the two unlist problems that Kurt reported about,
   especially

    l.ex <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
    unlist(l.ex) #-- still in 0.50-a2
    ##- INTERNAL ERROR: ans_nnames = 10    ans_length = 12
    ##- Error: incorrect names vector length

 still exist. {Nobody claimed otherwise}


4) The parser problem reported by Patrick Lindsey remains :

  ##- From: Patrick Lindsey <plindsey@luc.ac.be>
  ##- Date: Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
  ##- To: r-devel@stat.math.ethz.ch (R list)
  ##- Subject: R-alpha: Bugs in R-0.50-a1.
  ##-
  ##- Problems in R but not in S:
  ##- ---------------------------

  ##- 2) Problem with the parser: When a function contains a condition
  ##- between brackets the closing bracket must be adjacent to the last item
  ##- in R but not in S. Here is an example:
  ##- 	S> new <- function (x,y,z,k) {
  ##- 	S+ message <- list(x,y,a=if(z) k
  ##- 	S+ )
  ##- 	S+ message
  ##- 	S+ }
  ##- 	S>
  ##- 	---
  ##- 	R> new <- function (x,y,z,k) {
  ##- 	R+ message <- list(x,y,a=if(z) k
  ##- 	R+ )
  ##- 	)
  ##- 	^
  ##- 	Error: syntax error
  ##- 	R>
  ##- This occurs in R-0.49 and in R-0.50-a1, R-0.50-a2

  new <- function (x,y,z,k) {
    message <- list(x,y, a=if(z) k
		    )
  }

---------------------------------------------------------------------------
I think I found one  NEW bug  (a1 -> a2):
		     =======
  	options(digits = ...) fails to work AT ALL in a 'local environment'

which makes even my  tst2()  function 'fail' :
  

 p0 <- (0:2)/1000 ; p <- p0 + 1e-10
 p
 ## Fails in 0.50-a2, (NOT in 0.50-a1, I think):
 for(d in 1:20) { options(digits=d); cat(d,": ", p,";\t",p0, "  ");print(p)}
 options(digits=7)
 ## Now,the print(.) at least works:
 for(d in 1:20) { options(digits=d); cat(d,": ", p,";",p0, "  ");print(p,dig=d)}

 ##-- The following does not work as it should in  R (0.50-a1, maybe earlier)
 tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
 tst()
 tst(dig = 12)
 ##-- This should do the same; works as expected in S & R-0.50-a1, NOT in -a2:
 tst2 <- function(x=pi, dig =3) {
   oo <- options(digits=dig); on.exit(options(oo)); print(x);x}
 tst2()
 tst2(dig = 12)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 14:02:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 15:02:11 +0200
Subject: R-alpha: R-0.50-a{1|2} : Yet another shortest SEGFAULT  --- + PATCH
Message-ID: <199708051302.PAA00761@sophie.ethz.ch>

[ already in 0.50-a1 ]

is.loaded(1) gives a SEGFAULT.

----------------------------------------
Here is the patch :


--- src/main/dotcode.c~	Thu Jun  5 03:07:00 1997
+++ src/main/dotcode.c	Tue Aug  5 14:57:15 1997
@@ -434,7 +434,7 @@
 
 	checkArity(op, args);
 	if(!isString(CAR(args)) || length(CAR(args)) < 1)
-		errorcall(call, "invalid argument");
+		errorcall(call, "invalid argument\n");
 
 	p = CHAR(STRING(CAR(args))[0]);
 	q = buf;
@@ -459,6 +459,8 @@
 	char *sym;
 	int val;
 	checkArity(op, args);
+	if(!isString(CAR(args)) || length(CAR(args)) < 1)
+		errorcall(call, "invalid argument\n");
 	sym = CHAR(STRING(CAR(args))[0]);
 
 	val = 1;
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug  5 14:14:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 5 Aug 1997 15:14:32 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: <x2204gg2mf.fsf@bush.kubism.ku.dk>
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
 <x2204gg2mf.fsf@bush.kubism.ku.dk>
Message-ID: <199708051314.PAA22117@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> Ross and I have been back and forth on this one a few times already;
>> it's probably a faq (Kurt);
>                 ^^^^^

> This belongs on the *manual page*. I suggest something along these
> lines:

> NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
> get values of LANG(x) and LANG(y) looked up in the environment
> LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
> LANG(expr) is usually a simple variable ITALIC(containing) an
> expression to evaluate or a LANG(substitute(...)) call
> ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
> passed to the evaluator.
> )

Perhaps as a compromise, we could put something like the above into the
man page, AND I'll add something in the FAQ?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug  5 14:40:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 05 Aug 1997 15:40:40 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: Kurt Hornik's message of Tue, 5 Aug 1997 15:14:32 +0200
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
 <x2204gg2mf.fsf@bush.kubism.ku.dk>
 <199708051314.PAA22117@aragorn.ci.tuwien.ac.at>
Message-ID: <x2n2mw4ujr.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Peter Dalgaard BSA writes:
> 
> > Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
> >> Ross and I have been back and forth on this one a few times already;
> >> it's probably a faq (Kurt);
> >                 ^^^^^
> 
> > This belongs on the *manual page*. I suggest something along these
> > lines:
> 
...
> 
> Perhaps as a compromise, we could put something like the above into the
> man page, AND I'll add something in the FAQ?

Certainly. A "Fine points" section in the FAQ would be very nice
indeed. It could contain several items of the "looks wrong, but isn't"
variety as well as "debatable, but it was done this way, because..."
and "bug compatible with S-Plus". 

On the other hand, the FAQ might not be the preferred document for
online help during programming, whereas the manpages would typically
be the first place to look. Therefore, it is a very good idea to put a
terse description of any counterintuitive behaviour on the man page. 

One could probably argue that the man page addition that I suggested
is a bit on the verbose side. "That won't work, do this instead"
should suffice on the man page, whereas a fuller explanation could go
in the FAQ.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug  5 15:22:24 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 Aug 1997 16:22:24 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: <x2n2mw4ujr.fsf@bush.kubism.ku.dk> (message from Peter Dalgaard
 BSA on 05 Aug 1997 15:40:40 +0200)
Message-ID: <199708051422.QAA18877@sophie.ethz.ch>

If you look at the new  'eval' man page that comes with the  a1-->a2
patches, you see that R or R has added a paragraph that somewhat resembles
your proposal.

PD> This belongs on the *manual page*. I suggest something along these
PD> lines:

PD> NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
PD> get values of LANG(x) and LANG(y) looked up in the environment
PD> LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
PD> LANG(expr) is usually a simple variable ITALIC(containing) an
PD> expression to evaluate or a LANG(substitute(...)) call
PD> ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
PD> passed to the evaluator.
PD> )

They don't use any pejorative words such as "counterintuitive" though... ;-)

help(eval)>  The expression expr is evaluated in the environment
help(eval)>  that eval is called from. This allows you to assign
help(eval)>  complicated expressions to symbols and then evaluate
help(eval)>  them. If you want to evaluate expr in envir then you
help(eval)>  must wrap a call to expression around it.
	
  and later

help(eval)> 	Examples:

	     ....

help(eval)> 	     tst.ev <- function(a = 7) { x <- pi; y <- 1; ev() }
help(eval)> 	     ev <- function() {
help(eval)> 	          e1 <- sys.frame(sys.parent())
help(eval)> 	          ## Evaluate a in e1
help(eval)> 	          aa <- eval(expression(a),e1)
help(eval)> 	          ## evaluate the expression bound to a in e1
help(eval)> 	          a <- expression(x+y)
help(eval)> 	          list(aa = aa, eval = eval(a, e1))
help(eval)> 	     }
help(eval)> 	     tst.ev()#-> aa : 7,  eval : 4.14
	
	[R&R: The example was improved by me:  
	      ALL examples should be self-contained executable !]

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Tue Aug  5 21:28:49 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 6 Aug 1997 08:28:49 +1200 (NZST)
Subject: R-alpha: Environment strangeness
Message-ID: <199708052028.IAA20017@stat1.stat.auckland.ac.nz>


I'd already adjusted the man pages before Peter's suggestion came along
and was too lazy/buzy to change it again. Most of the reason I suggested
the faq was that Ross and I really have changed this one back and forth
a lot; each time it seems like the change is the right thing to do. But
we're now convinced that this is correct. Putting it in writing in a few
places should hopefully make it easier to remember that it's correct.

We're having some real problems synchronizing work on bug reports and
will probably need to set up something more automatic. This is probably
going to involve a separate email address (or special subject) so we
can pull them out and put them in a list that everyone involved can
work off of that without duplication of fixes.


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:39 +0200
Subject: R-alpha: Version 0.50-a1 patches
In-Reply-To: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
References: <199708050500.RAA08160@stat1.stat.auckland.ac.nz>
Message-ID: <199708061106.NAA22856@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> A set of patches for R-0.50-a1 is now available as
> 	ftp://stat.auckland.ac.nz/pub/R/R-0.50-a1.patch1.gz
> The patches mainly fix problems reported since R-0.50-a1 but some
> older problems are also fixed.

> ...

>  o  New functions "as.ordered", "data.class" and "scale" from, Kurt
>     Hornik added.

Almost.  `scale' seems to be missing ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:38 +0200
Subject: R-alpha: R 0.50.a2
Message-ID: <199708061106.NAA22853@aragorn.ci.tuwien.ac.at>

Here's a trivial patch (Martin!).
-k

--- src/library/base/man/Arithmetic.orig	Tue Aug  5 22:33:16 1997
+++ src/library/base/man/Arithmetic	Tue Aug  5 22:35:51 1997
@@ -15,6 +15,7 @@
 ALIAS(^)
 ALIAS(%%)
 ALIAS(%/%)
+ALIAS(Arithmetic)
 VALUE(
 These binary operators perform arithmetic on vector objects.
 They return numeric vectors containing the result of the element
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:39 +0200
Subject: R-alpha: R color problem
Message-ID: <199708061106.NAA22855@aragorn.ci.tuwien.ac.at>

There seems to be a small problem with the S-compatible small numbers
color specification, colors 0 and 2 are the same.

Have a look at e.g.
	barplot(rbind(1:3, 1), col = c(0,2))

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug  6 12:06:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 6 Aug 1997 13:06:38 +0200
Subject: R-alpha: R 0.50.a2 shortest segfault ...
Message-ID: <199708061106.NAA22854@aragorn.ci.tuwien.ac.at>

This time, it seems that
	browser()
wins.  Grr ...
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug  6 14:04:59 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 06 Aug 1997 15:04:59 +0200
Subject: R-alpha: R 0.50.a2 shortest segfault ...
In-Reply-To: Kurt Hornik's message of Wed, 6 Aug 1997 13:06:38 +0200
References: <199708061106.NAA22854@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb6fa2dg.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> This time, it seems that
> 	browser()
> wins.  Grr ...

On a related note, other bottom-level things act strangely:

> sys.parent()
Error: failed to match environments
> sys.nframe()
Error: failed to match environments
> sys.frame(0)
Error: failed to match environments

The 1st might make sense (I'd prefer it to return NULL whenever n is
bigger than the stack height, rather than error out), but the 2nd
should return 0 and the 3rd the R_GlobalEnv as it does on any other
levels.
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug  6 14:16:11 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 06 Aug 1997 15:16:11 +0200
Subject: R-alpha: Re: R 0.50.a2 - unlist() still broken
In-Reply-To: Kurt Hornik's message of Wed, 6 Aug 1997 13:06:38 +0200
References: <199708061106.NAA22853@aragorn.ci.tuwien.ac.at>
Message-ID: <x2wwlza1us.fsf@bush.kubism.ku.dk>


You still can't unlist() a regression object:

x<-rnorm(3)
y<-rnorm(3)+x
o<-lm(y~x)
unlist(o)
ou<-unclass(o)
ou
unlist(ou)

Part of the explanation seems to be contained in

unlist(list(1,2,3,4))
unlist(list(1,2,3,4,"a"))
unlist(list(1,2,3,4,x~y))

and also in

unlist(list(x~y))



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug  6 14:54:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 Aug 1997 15:54:56 +0200
Subject: R-alpha: R color problem  (col=0 is wrong; col=1 S incompatible)
In-Reply-To: <199708061106.NAA22855@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 6 Aug 1997 13:06:39 +0200)
Message-ID: <199708061354.PAA01946@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> There seems to be a small problem with the S-compatible small
    Kurt> numbers color specification, colors 0 and 2 are the same.

    Kurt> Have a look at e.g.  barplot(rbind(1:3, 1), col = c(0,2))

I had reported this problem  even more extensively in R-help (not R-devel),
since I thought it important to be known by everyone:

Here is the relevant part (in R-help, I went further with a wish...):

MM> Date: Mon, 14 Jul 1997 15:07:19 +0200
MM> From: Martin Maechler <maechler@stat.math.ethz.ch>
MM> To: R-help@stat.math.ethz.ch
MM> Subject: R-beta: Plotting: numeric 'col' colors;  col=0, col=1, ..

MM> ``We all know''
MM>  that R has more flexible and nicer color specifications than S-plus.

MM> There are situations however, where I'd like to specify colors numerically,
MM> e.g.
MM> 	1) convenience of using different colors in a for(.) loop
MM>  or
MM> 	2) backward compatibility with S.
MM> 
MM> In S, there's the quite known  ``standard''
MM> 
MM> 	col = 0  :<==>   current background color	[ = white by default]
MM> 	col = 1  :<==>   current foreground color, ie. default color. [ = black]
MM> 
MM> In R, this is currently different:
MM> 
MM> col = 0 is the same as  col = 2  
MM> 	which maybe rather an accident than anything else.
MM> col = 1 however takes a different color than the current foreground
MM> 	-- which can be NICE  in certain situations, where we'd rather have
MM> 	   points / lines  in a different color than the default foreground
MM> 	On the other hand, I think  "S compatibility" is more important here.
MM> 
MM> I assume that it's not too hard to change the 
MM> ``numeric color'' map such as to get S compatibility.

Yes, I still think it would be nice if this was changed...

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug  6 17:41:37 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 6 Aug 1997 09:41:37 -0700 (PDT)
Subject: R-alpha: browser()
In-Reply-To: <199708060311.PAA14297@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970806093214.2623A-100000@zen>


Kurt pointed out that
R> browser() 
is now the shortest segfault.  The problem is in do_browser in main.c at
about line 420:
       if( !DEBUG(rho) ) {
                cptr=R_GlobalContext;
                while (cptr->callflag != CTXT_RETURN) 
                        cptr = cptr->nextcontext;
                Rprintf("Called from: ");
                PrintValueRec(cptr->call);
        }
When browser() is called from the top level rather than from a function we
have cptr->callflag==CTXT_TOPLEVEL, so the test succeeds, but as there are
no other contexts we have cptr->nextcontext==NULL and a segfault.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Aug  6 21:59:51 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 6 Aug 1997 15:59:51 -0500 (CDT)
Subject: R-alpha: Re: R-beta: ?faq example of scoping
In-Reply-To: <199708062021.IAA21936@stat1.stat.auckland.ac.nz> from "Robert Gentleman" at Aug 7, 97 08:21:01 am
Message-ID: <9708062059.AA08076@nokomis.stat.umn.edu>

Robert Gentleman wrote:
> 
>  I like Thomas' example. Kurt can you include it in the FAQ. 
>  
>  Recently I have been doing a lot of programming that has required either
>  optimization or zero-finding. Unfortunately most of the functions need
>  some arguments to be optimized over and have other parameters that depend on
>  the data but are fixed with respect to optimization. With R scoping rules
>  this is a trivial problem; simply make up the function with the required
>  definitions in the same environment and scoping takes care of it. With
>  Splus my solution has been to add an extra parameter to the function and
>  to the optimizer to pass in these extras. That's fine for optimizers I 
>  write myself but it doesn't work for the builtin ones. Fortunately I haven't
>  yet found a one-d problem that some thought and bisection won't take care
>  of.
>  
>  robert
>  

There might also be some use for a clean dynamic scoping mechanism to
to make it easier to make things like the minimizers in optimize.c
reentrant.  In 0.49 at least they use a static variable, and I think
things would go bad if they were called recursively. THis may not be
likely for a minimizer, but it would be very reasonable for an
integrator. You could save previous values of the globals on the C
stack, but with the need to provide protection for non-local exits on
errors this can get messy. A dynamic binding mechanism, preferably
with a separate name space like dynamic-bind stuff in Scheme, would
make this easier.

luke




-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug  7 05:42:21 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 7 Aug 1997 16:42:21 +1200 (NZST)
Subject: R-alpha: Colors
Message-ID: <199708070442.QAA10907@stat1.stat.auckland.ac.nz>

Here is a proposal:

At present when you specify a color with an integer it is taken as an
index into a fixed table of 8 colors.

	1=red, 2=green, 3=blue, 4=cyan,
	5=magenta, 6=yellow, 7=white, 8=black

[At least this is the intention, there may be bugs in the
implementation].  Since I am looking at this anyway (to see if I can
see the bug that Martin and Kurt have mentioned) I thought I might
make a larger change.

I would like to make the color table, user definable.  To do this
there needs to be a function

	palette(name, value)

where "name" could be used to select one on a number of standard
built-in palettes (e.g. "default", "heat", "terrain", "pastels" etc)
and (if name was not specified, "value" could be a character vector of
color specifications (of length less than or equal to 256?).  Either
names (e.g. "red", "lightblue" ...)  or by rgb values (e.g "#FF00FF")
could be used in the vector.

The function palette would return the previous palette, and
	palette()
could be used to obtain the current settings without a change.

After a call to palette integer col= specification would provide
indexes into this table.

col=0 could be used to indicate the current background color.

The "default" palette would have 1=black.

Any comments?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug  7 09:37:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 Aug 1997 10:37:12 +0200
Subject: R-alpha: Colors -- Comment: yes, great !!
In-Reply-To: <199708070442.QAA10907@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Thu, 7 Aug 1997 16:42:21 +1200 (NZST))
Message-ID: <199708070837.KAA02747@sophie>

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> Here is a proposal: At present when you specify a color with an
    Ross> integer it is taken as an index into a fixed table of 8 colors.
     
    Ross>    ....

    Ross> I would like to make the color table, user definable.  To do this
    Ross> there needs to be a function

    Ross> 	palette(name, value)

    Ross> where "name" could be used to select one on a number of standard
    Ross> built-in palettes (e.g. "default", "heat", "terrain", "pastels"
    Ross> etc) and (if name was not specified, "value" could be a character
    Ross> vector of color specifications (of length less than or equal to
    Ross> 256?).  Either names (e.g. "red", "lightblue" ...)  or by rgb
    Ross> values (e.g "#FF00FF") could be used in the vector.

You could even do with one argument -- collapsing  name & value.
	character(1) -> 'name'
	character(> 1) -> 'value'

But this may be just about the S practice 
which has been in use in functions like  diag(..) and
seems to confusing people..


    Ross> The function palette would return the previous palette, and
    Ross> palette() could be used to obtain the current settings without a
    Ross> change.

    Ross> After a call to palette integer col= specification would provide
    Ross> indexes into this table.

This sounds really great!
Just about what I may have dreamed when I sent my e-mail
a few weeks ago :-)



    Ross> col=0 could be used to indicate the current background color.
Yes, please

    Ross> The "default" palette would have 1=black.
Ok.
    Ross> Any comments?  Ross

Yes: Sounds great!
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug  7 17:49:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 7 Aug 1997 09:49:20 -0700 (PDT)
Subject: R-alpha: expressions in graphs
In-Reply-To: <199708060311.PAA14297@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970807094715.3948D-100000@zen>


The expression parser for graph labels is wonderful.  Two comments.

1. save.plot and print.plot don't quite work -- they don't allow enough
space for text included in expressions.

2. Can we have = and sqrt() added to the wish list?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug  7 19:17:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 07 Aug 1997 20:17:54 +0200
Subject: R-alpha: expressions in graphs
In-Reply-To: Thomas Lumley's message of Thu, 7 Aug 1997 09:49:20 -0700 (PDT)
References: <Pine.SUN.3.95.970807094715.3948D-100000@zen>
Message-ID: <x267th3lik.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 2. Can we have = and sqrt() added to the wish list?

For "=" you'd need to type == (try expression(r=2) to see why). Not
that that works as of now...

Sqrt() shouldn't be much more difficult than bar(), should it? For now, 
V*bar(...) does a fairly decent impersonation.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug  7 21:12:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 8 Aug 1997 08:12:35 +1200 (NZST)
Subject: R-alpha: expressions in graphs
Message-ID: <199708072012.IAA16673@stat1.stat.auckland.ac.nz>

Thomas Lumley writes:

> The expression parser for graph labels is wonderful.  Two comments.

> 1. save.plot and print.plot don't quite work -- they don't
> allow enough space for text included in expressions.

This is because the X11 font metrics are used in conjunction with
PostScript fonts.  The mismatch doesn't show with the usual plot
labels, but it does look pretty bad with mathematics.

General help is on the way.  We are about to completely rewite the
lower levels of the graphics system to support multiple active devices
and rather more interactive graphics.  This will change the way that
print.plot and save.plot will work (they may disappear and be replaced
by menu selections in the graphics window).

> 2. Can we have = and sqrt() added to the wish list?

I think the functionality is there, its just called "root".  We will
change the name to "sqrt".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug  8 04:06:50 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 8 Aug 1997 15:06:50 +1200 (NZST)
Subject: R-alpha: Second patch for 0.50-a1
Message-ID: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>

A second patch for R-0.50-a1 is available from
	ftp://stat.auckland.ac.nz/pub/R
The patch produces the following changes

 o  cpoly problem with pow_di fixed.

 o  legend had a call to "text" with an incorrect argument tag.
    Changed "text" to "labels".

 o  The variable "dup" was uninitialised in the function "naoktrim" in
    src/main/dotcode.c.

 o  There have been some fixes to the color support code and there
    is now a function palette which allows a user to specify the
    palette to be used when the value of col= is numeric.

 o  Problems pointed out in "unlist" are fixed.

 o  A parsing problem for "if" statements in argument lists is fixed.

Enjoy
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 10:29:43 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 11:29:43 +0200
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails ..
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 8 Aug 1997 15:06:50 +1200 (NZST))
Message-ID: <199708080929.LAA03674@sophie.ethz.ch>

Thank you for these patches, especially the new color scheme!


``As always'' (;-)  
some remarks:

1)
 	     cut(rep(1,5),4)
>>>> Error: character variables must be duplicated in .C/.Fortran

  Which seems the old '*dup =0' problem, but is NOT (identical at least)
	  [Yes, I made sure that the above was applied dotcode.c]

  This seems only for  cut(...), not for 
	  approx(.),  spline(.) or lowess(.) 
  which also use .C(...).

  Further note that cut(.) had no problems in 0.50-Alpha-2 


2) I think that
	given the definition in	src/include/Fortran.h ,
	src/appl/cpoly.c  should rather use  POW_DI(.)  instead of  pow_di(.).

  It probably won't matter for most (all?) installations,
  since it only becomes important when

#ifdef NONSTANDARD_F77LIBS  
				is true


3) Important(IMHO) bugs [besides '1)' above] remaining:
	
	i.  browser()  ##	-> seg.fault

	ii. options(digits ..) still ``fails''
	    when used in non-global environments	(see my earlier posts)
	
--------
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 13:56:17 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 14:56:17 +0200
Subject: R-alpha:  unlist(..) forever..
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Fri, 8 Aug 1997 15:06:50 +1200 (NZST))
Message-ID: <199708081256.OAA03801@sophie.ethz.ch>

[[ R-0.50 Alpha-3  --- i.e. both patches applied to 0.50-a1 ]]

There are less problems, but I think two remain

1) Peter Dalgaard's example {which "includes"  Kurt's unlist(lm(..))}

> unlist(list(1,2,x~y))
[[1]]
[1] 1

[[2]]
NULL

[[3]]
NULL


2) [unreported yet:]

l.ex <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)

unlist(l.ex) #-- now 'okay' in 0.50-a3 !!

unlist(l.ex, recursive=FALSE) #-- --- recursive has no effect!
	     ##-------------   

which returns the same as the default recursive = TRUE

whereas S gives
S> unlist(list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA), rec = FALSE)
$a1:
[1] 1 2 3 4 5

$a2:
[1] "A" "B" "C" "D" "E"

$b:
[1] "Z"

$c:
[1] NA
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug  8 16:15:10 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 8 Aug 1997 17:15:10 +0200
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails .. -- PATCH (?!)
In-Reply-To: <199708080929.LAA03674@sophie.ethz.ch> (message from Martin
 Maechler on Fri, 8 Aug 1997 11:29:43 +0200)
Message-ID: <199708081515.RAA03936@sophie.ethz.ch>


It was not only  cut(.) but also  formatC(.)
whose .C(..) calls gave the
 >>>> Error: character variables must be duplicated in .C/.Fortran

Looking a bit at  src/main/dotcode.c
(and reading Ross' explanation that it was a "variable initialization problem")

I decided to 
REPLACE line 413  in src/main/dotcode.c
which (after the patch) reads
		*dup = 0;
by
		*dup = 1;
---
and yes, this seems to solve the problem.

'make tests' at least works and gives about the same as with  0.50 Alpha-2.

----
Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug  8 21:53:33 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 9 Aug 1997 08:53:33 +1200 (NZST)
Subject: R-alpha: Second patch for 0.50-a1:   cut(.) fails .. -- PATCH (?!)
Message-ID: <199708082053.IAA03751@stat1.stat.auckland.ac.nz>

	From: Martin Maechler <maechler@stat.math.ethz.ch>

	Looking a bit at  src/main/dotcode.c
	(and reading Ross' explanation that it was a "variable
	initialization problem")

	I decided to 
	REPLACE line 413  in src/main/dotcode.c
	which (after the patch) reads
			*dup = 0;
	by
			*dup = 1;

Ooops!  Martin is right.  Make this change.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Sun Aug 10 23:57:58 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Mon, 11 Aug 1997 10:57:58 +1200 (NZST)
Subject: R-alpha:  unlist(..) forever..
Message-ID: <199708102257.KAA17769@stat1.stat.auckland.ac.nz>

Take about the bug from hell; well I'm sure that I'm not done with this
one yet but it should work a little better on the next patch.


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: R 0.50.a3:  adj?
Message-ID: <199708111336.PAA00438@aragorn.ci.tuwien.ac.at>

Not sure if I already reported this ... it seems that as of 0.50.a2, the
adj graphics parameter is completely ignored.  Try e.g.

	plot(1:10)
	title(main = "This is a title", adj = 0)
	title(main = "This is a title", adj = 1)

No difference ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: CFLAGS in config.site
Message-ID: <199708111336.PAA00442@aragorn.ci.tuwien.ac.at>

Could we change the default value of CFLAGS in config.site (back) to
"-O2 -g"?
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:07 +0200
Subject: R-alpha: R 0.50.a3 family.lm()
Message-ID: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>

The following patch adds a trivial family method for linear models.
-k

--- src/library/base/funs/lm.orig	Tue May 27 02:53:58 1997
+++ src/library/base/funs/lm	Sun Aug 10 22:00:46 1997
@@ -412,3 +412,5 @@
 }
 
 formula.lm<-function(x)formula(x$terms)
+
+family.lm <- function(x) { gaussian() }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3 problem with `make tests'
Message-ID: <199708111336.PAA00453@aragorn.ci.tuwien.ac.at>

Not really important, but ... `make tests' fails if a user's .Rprofile
asks for libraries which are not found by the binary in the compilation
tree (yes I know, we're here perhaps the only ones who use private
libraries ...).

Perhaps we should have options
	--no-site-file
	--no-init-file
which inhibit the loading of a global and a user's init file?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:09 +0200
Subject: R-alpha: R 0.50.a3  tapply patch
Message-ID: <199708111336.PAA00464@aragorn.ci.tuwien.ac.at>

Can we please apply the following patch?  It fixes the following problem
I already reported:

************************************************************************
There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
R> f
[1] a a b
R> codes(f)
[1] 1 1 2
R> levels(f)
[1] "a" "b" "c"

which gives e.g.

R> tapply(rep(1, length(f)), f, sum)
Error: names attribute must be the same length as the vector
************************************************************************

Thanks,
-k

--- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
+++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
@@ -14,7 +14,7 @@
 		index <- as.factor(INDEX[[i]])
 		if (length(index) != nx) 
 			stop("arguments must have same length")
-		namelist[[i]] <- levels(index)
+		namelist[[i]] <- unique(levels(index)[index])
 		extent[[i]] <- nlevels(index)
 		group <- group + ngroup * (codes(index) - 1)
 		ngroup <- ngroup * nlevels(index)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3:  patch for man/palette
Message-ID: <199708111336.PAA00456@aragorn.ci.tuwien.ac.at>

The following patch fixes an obvious problem with the man source for
palette().
-k

--- src/library/base/man/palette.orig	Sun Aug 10 17:50:11 1997
+++ src/library/base/man/palette	Sun Aug 10 18:49:14 1997
@@ -14,7 +14,7 @@
 a built in color palette.  If LANG(value) has length greater
 than 1 it is assumed to contain a description of the colors
 which are to make up the new palette (either by name or
-by RGB levels.
+by RGB levels).
 PARA
 If LANG(value) is omitted or has length 0, no change is made
 the current palette.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: frame tools
Message-ID: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>

Btw, what happened to Peter's frame tools?   Is there a new version?
Are there plans to include them in the distribution?
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:08 +0200
Subject: R-alpha: R 0.50.a3 minor remark
Message-ID: <199708111336.PAA00459@aragorn.ci.tuwien.ac.at>

Just a minor remark.  We now have

> args(ls)
function (name, pos = -1, envir = pos.to.env(pos), all.names = FALSE, 
        pattern) 

but

> pos.to.env(-1)
Error in pos.to.env(-1) : invalid argument

whereas

> pos.to.env(length(search()))
NULL


Perhaps pos.to.env should really return the corresponding environments,
just for sake of completeness ... or the fun of it.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 11 14:36:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 11 Aug 1997 15:36:09 +0200
Subject: R-alpha: Second patch for 0.50-a1
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
References: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
Message-ID: <199708111336.PAA00462@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> A second patch for R-0.50-a1 is available from
> 	ftp://stat.auckland.ac.nz/pub/R
> The patch produces the following changes

> ...

scale() is still missing ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 11 15:42:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 11 Aug 1997 16:42:02 +0200
Subject: R-alpha: frame tools
In-Reply-To: Kurt Hornik's message of Mon, 11 Aug 1997 15:36:08 +0200
References: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>
Message-ID: <x2bu34eq85.fsf@biostat.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> Btw, what happened to Peter's frame tools?   Is there a new version?
> Are there plans to include them in the distribution?

In the cooler for the time being. I did a little poking around some
weeks ago, planning to change the syntax slightly so that there would
be two functions, accessed as generic methods:

subset.data.frame(fr,...,where)
transform.data.frame(fr,...)

e.g.,

subset(data,visit1:visit5,where=(treat=="placebo"))
transform(data,log.creatin=log(creatin))

I.e. subset now combines the old select.frame and subset.frame
mechanisms.

I also spent a litle while pondering whether the method for
substituting names in an object of mode "call" could be generalized
somehow, but decided that it was probably too difficult to get it
right.

Then the close-xterm bug zapped the .RData in the directory where I
had been experimenting... Actually, I hadn't done all that much,
mainly terminology cleanup, and what was lost should be easily
recreated.

What's really keeping me is that I've decided to try using R for our
course in basic statistics for medical researchers, so now I need to
focus on making sure things work that I absolutely *need*, and write
various tutorials and missing functions (anyone have logrank.test and
kaplan.meier.plot? Working with the Windows version, that is!).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 11 18:12:49 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 Aug 1997 10:12:49 -0700 (PDT)
Subject: R-alpha: eigen
In-Reply-To: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970811094129.432B-100000@zen>


eigen is behaving very strangely in my copy of patch 3 (solaris 2.5.1). 
The calls to .Fortran are returning absolute rubbish and are also mutating
things that shouldn't be mutated. 

example:
> eigen(matrix(c(1,0,0,1),2))  
debug: z <- .Fortran("rs", n, n, x, values = vals, only.values == FALSE, 
        vectors = x, vals, vals, ierr = integer(1))
Browse[1]> x
     [,1] [,2]
[1,]    1    0
[2,]    0    1
Browse[1]> 
debug: if (z$ierr) stop(paste("rs returned code ", z$ierr, " in eigen"))
Browse[1]> dim(x)
[1] -1076060379  -977277476
Browse[1]> dim(z$vectors)
[1] -1076060379  -977277476
Browse[1]> dim(x)<-c(2,2)
Browse[1]> dim(x)
[1] 2 2
Browse[1]> dim(z$vectors)
[1] 2 2
Browse[1]> z$vectors
          [,1]       [,2]
[1,] 0.8506508 -0.4472136
[2,] 0.5257311  0.7236068

Not only are these clearly not the eigenvectors of the identity, but the
.Fortran routine shouldn't even have access to x.

The problems turn out to be related: when separate objects are supplied
for each argument the function works properly, ie
        z <- .Fortran("rs", n, n, x, values = vals, only.values ==  FALSE, 
		vectors = 0 * x, vals * 0, vals * 0, ierr = integer(1))

Somehow the arguments to .Fortran aren't getting properly copied.


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Aug 11 22:14:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 12 Aug 1997 09:14:42 +1200 (NZST)
Subject: R-alpha: eigen
In-Reply-To: <Pine.SUN.3.95.970811094129.432B-100000@zen>
References: <199708111336.PAA00446@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970811094129.432B-100000@zen>
Message-ID: <199708112114.JAA09123@stat1.stat.auckland.ac.nz>

Thomas Lumley writes:
 > 
 > eigen is behaving very strangely in my copy of patch 3 (solaris 2.5.1). 
 > The calls to .Fortran are returning absolute rubbish and are also mutating
 > things that shouldn't be mutated. 

I think that this is my fault for making a "quick fix" without really
testing it.  The problem (as pointed out by Martin) is in dotcode.c.

The function naoktrim should read

static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 1;	/* <---- 1 not 0 */
                *len = 0;
        }

Sorry about that.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Aug 12 01:21:12 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 12 Aug 1997 12:21:12 +1200 (NZST)
Subject: R-alpha: Matrix Class
Message-ID: <199708120021.MAA16813@stat1.stat.auckland.ac.nz>

The have been a few prods to create an S-like matrix class for R.  A
major reason for having a matrix class seems to be that people get
bitten by the default behavior of the drop= parameter to "[".  That
being the case does it make sense to change the semantics of "["
rather than introducing a new class?

I'm just wondering because I'm in a "smaller is better" kind of mood
after having been delving into the "lm" code and thinking about how
big R is becoming ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 02:04:28 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 Aug 1997 18:04:28 -0700 (PDT)
Subject: R-alpha: Matrix Class
In-Reply-To: <199708120021.MAA16813@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970811174844.739A-100000@zen>

On Tue, 12 Aug 1997, Ross Ihaka wrote:

> The have been a few prods to create an S-like matrix class for R.  A
> major reason for having a matrix class seems to be that people get
> bitten by the default behavior of the drop= parameter to "[".  That
> being the case does it make sense to change the semantics of "["
> rather than introducing a new class?

I think changing the semantics is preferable, in part because it fixes the
drop problem automatically, rather than requiring everyone to use a new
feature.  Creating a Matrix class would not fix the array problem for
arrays of dimension 3 or more, either.

However, a Matrix library might be a nice place to put matrix features
that not everyone needs. This helps keep the size of R down.  Libraries
that can be loaded and unloaded seem like the ideal place to put a whole
lot of things, rather than taking the S-PLUS approach of bundling gam and
trees and nlme and everything else together.  


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 08:32:10 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 09:32:10 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <Pine.SUN.3.95.970811174844.739A-100000@zen> (message from Thomas
 Lumley on Mon, 11 Aug 1997 18:04:28 -0700 (PDT))
Message-ID: <199708120732.JAA00579@sophie.ethz.ch>

	we are discussing, yes? -- 
	please nobody feel hurt just  because I disagree so heartily .. ;-)


>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    TL> On Tue, 12 Aug 1997, Ross Ihaka wrote:
    >> There have been a few prods to create an S-like matrix class for R.
    >> A major reason for having a matrix class seems to be that people get
    >> bitten by the default behavior of the drop= parameter to "[".
I think there are quite a few other reasons. I've been wanting to have 
a 'matrix' class for other reasons for quite a long time.
(One that come to my mind:
	Kurt's (and my earlier) proposal for a generic  "write" function
	with a write.data.frame  method would be much
	cleaner to implement with a write.matrix method when matrix was a class)

    >> That being the case does it make sense to change the semantics of "["
    >> rather than introducing a new class?

I don't think so. (see above and below)

    TL> I think changing the semantics is preferable, in part because it
    TL> fixes the drop problem automatically, rather than requiring
    TL> everyone to use a new feature.  Creating a Matrix class would not
    TL> fix the array problem for arrays of dimension 3 or more, either.

I disagree (I think this is a rare thing with you Thomas..).
----------
1) Lest I misunderstood something,
  you mean that	for matrices 'x',
	  x[,1]
  would be a 1--column matrix instead of a vector ?
  IMHO, this is ugly, and is really just logical if you come from a strict
  matrix thinker's corner which is the case for  matlab users, and maybe even
  mathematicians and the like (I'm one myself),
  but not for an average person analyzing  statistical data.

2) I'm quite convinced that this will break quite a bit of existing code,
   maybe code outside the R 'base' source, but still.

   It is more basically incompatible to S semantics than many other things,
   I think.

3) What if  x  is a data.frame? Would  x[,1] still be a data.frame?
  If not (which I presume), wouldn't this be contrary to the idea which I
  teach to beginners that
	``data.frames are just matrices, but a bit more general since
	  they can contain both numbers and character codes''


All in all, the use of  ``drop = FALSE'' is one way to avoid the problem,
and I agree there should be others,
(namely a  'Matrix' class in "R base" INDEPENDENT of the Matrix library.)

I do like the  class approach in any case and would like to have
'matrix' be THE generic class for all matrices 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[[I've advocating this even for S-plus,
  years ago, before 'Matrix' came into existence]] 

Then, 'Matrix' would be a class inheriting from 'matrix' with 
at least it's own "].Matrix" method.

    TL> However, a Matrix library might be a nice place to put matrix
    TL> features that not everyone needs. This helps keep the size of R
    TL> down.  Libraries that can be loaded and unloaded seem like the
    TL> ideal place to put a whole lot of things, rather than taking the
    TL> S-PLUS approach of bundling gam and trees and nlme and everything
    TL> else together.
yes. {also see above: 'Matrix' would be a class ANYWAY, for the
	``[,1] ==> Matrix''   aficionados}

Especially that we now have require() and provide()  
[[ provide  has been  fallen out of the source recently,
   it is "back again" and should appear in the next (pre)release
]]


This is an important discussion - I think -
so please tell me why you disagree...

--- Martin


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 14:23:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 15:23:13 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708111336.PAA00453@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 11 Aug 1997 15:36:08 +0200)
Message-ID: <199708121323.PAA02620@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Not really important, but ... `make tests' fails if a user's
    Kurt> .Rprofile asks for libraries which are not found by the binary in
    Kurt> the compilation tree (yes I know, we're here perhaps the only
    Kurt> ones who use private libraries ...).

    Kurt> Perhaps we should have options
    Kurt>  --no-site-file
    Kurt>  --no-init-file
    Kurt> which inhibit the loading of a global and a user's init file?

Yes, this (or something similar, maybe also allowing "-q" as short form)
would be useful!


For me even more important, is an option such as
	--dont-stop-on-error-if-batch

As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
namely "Termination upon 'error'".

I think this is THE good default behavior for "batch mode".
However
 1) for several purposes I'd very much want an option to change this
    default behavior.
 2) S-plus behaves differently, i.e., just continues evaluation after
    telling about the error, both in  "Splus BATCH .." and "Splus < file" mode.

Instead of the above switch ((which is hard to port to point'n'click
			      Win or Mac versions))
we could have something as

	options(error.stop = FALSE)

whereas the default was

	options(error.stop = TRUE)

I think it'd be very neat then if
	options(error.stop = FALSE)
actually translated all errors [stop(.)] to warnings [warning()].

The above option may come handy even in NON-BATCH mode,
e.g. when minimizing functions that produce NA from time to time or similar
things, and you are running large loops of simulations...


Just for the sake of completeness, the following is somewhat related to the
above discussion and  has been part of the TASKS for a while :
----------------------------------------------------------------------
TASK:	warnings option
STATUS:	Open
FROM:	maechler@stat.math.ethz.ch
	which reminds me that we/I also would like something similar as S's
	options(warn = k)
	k=  0 : [default]  print warnings
	k= -1 :	do nothing (maybe append warnings to some temp-file)
	k=  1 : produce an error ('warning' becomes 'stop'). 

----------------------------------------------------------------------


-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 15:16:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 16:16:12 +0200
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: <199708111336.PAA00438@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 11 Aug 1997 15:36:07 +0200)
Message-ID: <199708121416.QAA02795@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Not sure if I already reported this ... it seems that as of
    Kurt> 0.50.a2, the adj graphics parameter is completely ignored.  Try
    Kurt> e.g.
    Kurt>	plot(1:10)
    Kurt>	title(main = "This is a title", adj = 0)
    Kurt>	title(main = "This is a title", adj = 1)

    Kurt> No difference ...

true.
	{{are you sure if your example worked before ??}}


For  'mtext(..)'  adj does something but not the proper one :

	plot(1:10)#-- or just in the plot above..

	mtext( "This is an 'mtext(.. adj=0)'", adj = 0)
	mtext( "This is an 'mtext(.. adj=1)'", adj = 1)
	## is different but result is WRONG: adj=1 is LEFT of adj=0


for  'text(..)'   adj works as it should, at least in the cases I used it.
					 [ -> see the example in  ?text]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Aug 12 15:29:18 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 12 Aug 1997 10:29:18 -0400
Subject: R-alpha: Matrix Class
Message-ID: <97Aug12.103129edt.26507@mailgate.bank-banque-canada.ca>

Ross

If you're looking at the drop= code it sure would be nice to be able to (optionally) supply a vector (eg. drop=c(F,F,T) ) for higer dimension arrays.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 16:48:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 17:48:03 +0200
Subject: R-alpha: yet another remaining buglet
Message-ID: <199708121548.RAA02951@sophie.ethz.ch>

This was originally 

>> Cc: r-devel@stat.math.ethz.ch
>> Subject: Re: R-alpha: list assignment
>> References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
>> From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
>> Date: 25 Apr 1997 13:09:01 +0200
>> In-Reply-To: Robert Gentleman's message of Fri, 25 Apr 1997 13:12:36 +1200 (NZST)

### 2)  names(x)[1] <- "a"  still gives extraneous doublequotes IN the name

x <- list()
x[[1]] <- 23
names(x)[1] <- "a"
x  #----------------- got the quotes, also !!
##- $"a"
##- [1] 23
unlist(x)
##- \"a\"
##-    23
names(x) #> [1] "\"a\""


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 17:28:13 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 12 Aug 1997 09:28:13 -0700 (PDT)
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <199708120732.JAA00579@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970812090421.777A-100000@spock>

> 
> I disagree (I think this is a rare thing with you Thomas..).
> ----------
> 1) Lest I misunderstood something,
>   you mean that	for matrices 'x',
> 	  x[,1]
>   would be a 1--column matrix instead of a vector ?
>   IMHO, this is ugly, and is really just logical if you come from a strict
>   matrix thinker's corner which is the case for  matlab users, and maybe even
>   mathematicians and the like (I'm one myself),
>   but not for an average person analyzing  statistical data.

I'm not opposed to a matrix class, but I do think drop=FALSE should be the
default for arrays (I'm not as sure about data frames, but I do think it
is reasonable that one row of a data frame should be a data frame). The
reason is that the *current* behaviour of [ with drop=TRUE in S and R
breaks a lot of S code. 

I have found this particular problem in code written for other people to
use by people from a wide range of backgrounds. For example, Harald
Fekjaer's addreg library, Adrian Raftery's bayesian model averaging code,
and even an early version of Brian Ripley's linear discrimination
function. These functions break because they assume that x[vec,] is a
matrix even when it has a single row.  It rarely seems to matter if x[,1]
is a matrix or a vector, but it is important if x[1,] is a vector. 

For data analysis I don't think it matters much, though I agree it is a
little ugly for x[,1] to be a matrix. For programming I think that drop=F
is the same sort of incompatibility as the R scoping rules: one that
fixes, rather than breaks, S code. Of course people could just use drop=F,
the way they could just pass variables into nested functions explicitly.
The problem is that most of us don't, and it's a remarkably difficult bug
to find.

I may well be wrong, of course. ;-)


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 12 17:35:46 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 12 Aug 1997 09:35:46 -0700 (PDT)
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708121323.PAA02620@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970812093005.777B-100000@spock>

On Tue, 12 Aug 1997, Martin Maechler wrote:
> 
> As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
> namely "Termination upon 'error'".
> 
> I think this is THE good default behavior for "batch mode".
> However
>  1) for several purposes I'd very much want an option to change this
>     default behavior.
Hear, hear!

> 
> I think it'd be very neat then if
> 	options(error.stop = FALSE)
> actually translated all errors [stop(.)] to warnings [warning()].
> 

I'm not convinced.  Being able to make warnings fatal is a good option,
but being able to continue after errors may make no sense.   How do you
continue after subscript out of bounds, or argument missing with no
default, or memory exhausted or ...

You may well need to jump back to the top level before it makes sense to
continue.  On the other hand, once at the top level it is certainly
possible to proceed, and so there should be an option to do it.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Aug 12 17:40:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 12 Aug 1997 18:40:55 +0200
Subject: R-alpha: attach( <data.frame> , pos = 1) -- does not work.   detach(., save=..)
Message-ID: <199708121640.SAA03254@sophie.ethz.ch>

	[R-0.50-a3]

It seems intuitive that
	  attach( .., pos = 1)
is harder
than other attach()es.

But still...

If it ever will work, it is even more important to have

detach( .... , save = "VAR.name")
	       ~~~~~~~ --------
to be working.

The documentation says that  detach(.) returns invisibly.
Therefore, we don't NEED the above  'save = ' argument to detach,
since we can work with

	VAR.name <- detach ( .... )
instead.
However, there's a little problem there, too:
if the frame has been changed it is always returned as list
(which is different from S's ``save = T'' 
 which tries to coerce to data.frame)

Otherwise, things are ok (and conform to S's behavior):


###-------  Martin Mächler, Aug.12, 1997  (0.50-a3) : -----
data(bees)
search()

attach(bees)
attach(bees[-1,])
search()#ok : ".GlobalEnv"   "bees[, -1]"   "bees"   "library:base"

length(Lcp <- log(colpos)) # 63
assign("Lcp", Lcp, pos = 2)
b1 <- detach()#-- now, b1 is a 'list' instead of a data.frame ..

length(Lcp <- log(colpos)) # 64
bb <- detach()#>>> bb is a data.frame
search()#-- as it was 'at the beginning'

data.class(bb)# "data.frame"
data.class(b1)# "list"

db1 <- as.data.frame(b1)
##>> Error: no applicable method for "as.data.frame"

## And -- as a matter of fact -- there are __NO__ methods for as.data.frame...

## The following helps:
as.data.frame.default <-
  function (x, row.names = NULL, optional = F, ...)
  data.frame(x, row.names=row.names, ...)

db1 <- as.data.frame(b1)
summary(db1) #--> ok


attach(bees, pos = 1)
search()#- just still at  pos = 2 ..
attach(bees[,-1], pos = 3) #-- works ok !
search()#ok:  ".GlobalEnv"   "bees"   "bees[, -1]"   "library:base"

detach() #-- detaches pos=2, [ NOT the last attached one; -- AS S-plus ]
search()#--  ".GlobalEnv"    "bees[, -1]"   "library:base"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Tue Aug 12 18:48:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 12 Aug 1997 13:48:56 -0400
Subject: R-alpha: error.handler
Message-ID: <97Aug12.135112edt.26508@mailgate.bank-banque-canada.ca>

> I think it'd be very neat then if
> 	options(error.stop = FALSE)

It would be even better to have
	options(error.handler = error.handling.routine)

so it would be possible to do some special error checking or just stop().

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Aug 12 23:39:14 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Aug 1997 00:39:14 +0200
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: Martin Maechler's message of Tue, 12 Aug 1997 16:16:12 +0200
References: <199708121416.QAA02795@sophie.ethz.ch>
Message-ID: <x2g1sf2fhp.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> For  'mtext(..)'  adj does something but not the proper one :
> 
> 	plot(1:10)#-- or just in the plot above..
> 
> 	mtext( "This is an 'mtext(.. adj=0)'", adj = 0)
> 	mtext( "This is an 'mtext(.. adj=1)'", adj = 1)
> 	## is different but result is WRONG: adj=1 is LEFT of adj=0

-- as it should be! adj=0 is left-aligned, adj=1 is right-aligned

(take a string, attach a scale 0 to 1 along it, mark the value of adj
on scale, attach that point to the anchor point, i.e. the midpoint of
the plotting frame).

> 
> 
> for  'text(..)'   adj works as it should, at least in the cases I used it.
> 					 [ -> see the example in  ?text]

seems to work exactly the same!

The confusion seems to come from wanting 0/0.5/1 to mean
left/center/right-*justified* along the plot frame, which it really
doesn't. 

Even if it did, it wouldn't help, the control really needs to be
two-dimensional: you might want text left/center/right aligned with
the top of the y-axis. The at= parameter *almost* does it, but it is
in user coordinates, rather than frame coordinates. Perhaps we want an
anchor= parameter? -- or even better, a way of attaching units to plot
lengths. This kind of problem also appears with text() and legend()
(ever tried to produce plots with different scales but the legends in
the exact same spot?).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Wed Aug 13 00:58:51 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 13 Aug 1997 11:58:51 +1200 (NZST)
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>

Martin wrote:
>  I am sorry that this IS an old topic.
> Yet another task
> I think the bug is somewhere in hidden  in  src/main/options.c ..
> 
> ##-- The following does not work as it should in  R (0.50-a1, but I think
> 							also earlier)
> 
> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig); print(x);x}
> tst()
> tst(dig = 12)
> 
> 
> ##-- This should do the same; it works as expected in R & S :
> 
> tst2 <- function(x=pi, dig =3) {
>   oo <- options(digits=dig); on.exit(oo); print(x);x}
> tst2()
> tst2(dig = 12)


  Well it isn't really clear what Splus does to get tst to work. It appears
  that they use some form of dynamic scope for Options. Clearly, the 
  assignment,
    .Options$digits<- xxxx
  creates a local copy of .Options and changes the value of that. The only
  way that print can find this local copy is if  it looks up the stack of
  calling functions to find it (or perhaps Splus squirrels it away somewhere
  that print looks but then <- starts to behave in a very peculiar manner).
  This sort of behaviour is bad for two reasons
    1) We really want people to use lexical scope and any examples where you
    have dynamic scope simply confuse things
    2) It is quite inefficient for print (and anything else that uses Options)
    to have to look up the stack of calling functions.
    
  Since the method Martin so capably demonstrated with tst2 does work
   (except I think he meant on.exit(options(oo)) rather than on.exit(oo))
   I think we should stick with that. In that case the global value of 
   options(digits) is changed for the duration of the function evaluation
   of tst2.
   
 robert
 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Aug 13 01:01:09 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 13 Aug 1997 12:01:09 +1200 (NZST)
Subject: R-alpha: R 0.50.a3: title( .. adj= x)  AND  mtext( .. adj= x)
In-Reply-To: <x2g1sf2fhp.fsf@bush.kubism.ku.dk>
References: <199708121416.QAA02795@sophie.ethz.ch>
 <x2g1sf2fhp.fsf@bush.kubism.ku.dk>
Message-ID: <199708130001.MAA04180@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > (ever tried to produce plots with different scales but the legends in
 > the exact same spot?).

There is a barely documented (and nearly forgotten) R "feature" which you
might find useful ...

The functions xinch() and yinch() convert inches (xcm() and ycm() are
left as an exercise) to "usr" coordinates.

For example, to plot a point half an inch up from the lower left
corner of a plot you can use:

	ll <- par("usr")[c(1,3)] + c(xinch(0.5), yinch(0.5))
	points(ll[1], ll[2])

The same trick works for placing legends in "usr" coordinates.
	Ross


PS: I am making the "adj" feature behave like S.  Again this was
ignorance on my part, not malice.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 08:28:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 09:28:08 +0200
Subject: R-alpha: another minor problem
Message-ID: <199708130728.JAA01062@aragorn.ci.tuwien.ac.at>

As it seems that everyone's wishes for getting bugs fixed are granted
right away, here is something that I alread mentioned once.

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

        R> x <- 1:5
        R> x
        [1] 1 2 3 4 5
        R> i <- c(F, T)
        R> x[i]
        Error: invalid subscript type
        R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

        R> x[-6]
        Error: subscript out of bounds


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 08:54:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 09:54:31 +0200
Subject: R-alpha: frame tools
In-Reply-To: <x2bu34eq85.fsf@biostat.ku.dk>
References: <199708111336.PAA00447@aragorn.ci.tuwien.ac.at>
 <x2bu34eq85.fsf@biostat.ku.dk>
Message-ID: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <hornik@ci.tuwien.ac.at> writes:
>> 
>> Btw, what happened to Peter's frame tools?   Is there a new version?
>> Are there plans to include them in the distribution?

> In the cooler for the time being. I did a little poking around some
> weeks ago, planning to change the syntax slightly so that there would
> be two functions, accessed as generic methods:

> subset.data.frame(fr,...,where)
> transform.data.frame(fr,...)

> e.g.,

> subset(data,visit1:visit5,where=(treat=="placebo"))
> transform(data,log.creatin=log(creatin))

> I.e. subset now combines the old select.frame and subset.frame
> mechanisms.

Sounds very nice.

> I also spent a litle while pondering whether the method for
> substituting names in an object of mode "call" could be generalized
> somehow, but decided that it was probably too difficult to get it
> right.

> Then the close-xterm bug zapped the .RData in the directory where I
> had been experimenting... Actually, I hadn't done all that much,
> mainly terminology cleanup, and what was lost should be easily
> recreated.

(Maybe run R from within Emacs?)

> What's really keeping me is that I've decided to try using R for our
> course in basic statistics for medical researchers, so now I need to
> focus on making sure things work that I absolutely *need*, and write
> various tutorials and missing functions (anyone have logrank.test and
> kaplan.meier.plot? Working with the Windows version, that is!).

Yes, that would be nice, too.  I remember you asked for that some time
ago ...

What's also needed is something to produce and plot empirical
distribution functions.  I thought I could write something for my
Biostat course last semester, but it never happened ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 09:08:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 10:08:19 +0200
Subject: R-alpha: plotting empirical distribution function -- plot.step
In-Reply-To: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 13 Aug 1997 09:54:31 +0200)
Message-ID: <199708130808.KAA00695@ingrid.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
   
	.............

    Kurt> What's also needed is something to produce and plot empirical
    Kurt> distribution functions.  I thought I could write something for my
    Kurt> Biostat course last semester, but it never happened ...

Maybe I  REALLY should   have my  'plot.step'  function  put into R.

It does empirical distribution functions and quite a bite more..
Just need a little time to fixup the man page and do a few more tests..

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:09:18 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:09:18 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <199708120732.JAA00579@sophie.ethz.ch>
References: <Pine.SUN.3.95.970811174844.739A-100000@zen>
 <199708120732.JAA00579@sophie.ethz.ch>
Message-ID: <199708130809.KAA01211@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> 	we are discussing, yes? -- 
> 	please nobody feel hurt just  because I disagree so heartily
> .. ;-)

I certainly don't.

>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

TL> On Tue, 12 Aug 1997, Ross Ihaka wrote:
>>> There have been a few prods to create an S-like matrix class for R.
>>> A major reason for having a matrix class seems to be that people get
>>> bitten by the default behavior of the drop= parameter to "[".

> I think there are quite a few other reasons. I've been wanting to have 
> a 'matrix' class for other reasons for quite a long time.
> (One that come to my mind:
> 	Kurt's (and my earlier) proposal for a generic  "write" function
> 	with a write.data.frame  method would be much
> 	cleaner to implement with a write.matrix method when matrix was
> a class)

Yes, exactly.  It seems stupid to have to write code like

	xxx.default <- function(obj, ...) {
          if (is.matrix(obj)) {
             xxx.matrix(obj, ...)
          } else {
             ...
          }

(Not only with e.g. the generic write function ... there are many more
examples.)

>>> That being the case does it make sense to change the semantics of "["
>>> rather than introducing a new class?

> I don't think so. (see above and below)

TL> I think changing the semantics is preferable, in part because it
TL> fixes the drop problem automatically, rather than requiring
TL> everyone to use a new feature.  Creating a Matrix class would not
TL> fix the array problem for arrays of dimension 3 or more, either.

> I disagree (I think this is a rare thing with you Thomas..).
> ----------
> 1) Lest I misunderstood something,
>   you mean that	for matrices 'x',
> 	  x[,1]
>   would be a 1--column matrix instead of a vector ?
>   IMHO, this is ugly, and is really just logical if you come from a strict
>   matrix thinker's corner which is the case for  matlab users, and maybe even
>   mathematicians and the like (I'm one myself),
>   but not for an average person analyzing  statistical data.

Exactly.  Having done statistics with Octave prior to the existence of
R, I can only say that `strict matrix thinking' is terrible.  (In
particular, having to worry whether something is a row or a column
vector, when it DOES NOT MATTER AT ALL!)

> 2) I'm quite convinced that this will break quite a bit of existing code,
>    maybe code outside the R 'base' source, but still.

>    It is more basically incompatible to S semantics than many other things,
>    I think.

> 3) What if  x  is a data.frame? Would  x[,1] still be a data.frame?
>   If not (which I presume), wouldn't this be contrary to the idea which I
>   teach to beginners that
> 	``data.frames are just matrices, but a bit more general since
> 	  they can contain both numbers and character codes''

Right!

> All in all, the use of  ``drop = FALSE'' is one way to avoid the problem,
> and I agree there should be others,
> (namely a  'Matrix' class in "R base" INDEPENDENT of the Matrix
> library.)

> I do like the  class approach in any case and would like to have
> 'matrix' be THE generic class for all matrices 
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> [[I've advocating this even for S-plus,
>   years ago, before 'Matrix' came into existence]]

Again, definitely right!

> Then, 'Matrix' would be a class inheriting from 'matrix' with 
> at least it's own "].Matrix" method.

Exactly.

TL> However, a Matrix library might be a nice place to put matrix
TL> features that not everyone needs. This helps keep the size of R
TL> down.  Libraries that can be loaded and unloaded seem like the
TL> ideal place to put a whole lot of things, rather than taking the
TL> S-PLUS approach of bundling gam and trees and nlme and everything
TL> else together.
> yes. {also see above: 'Matrix' would be a class ANYWAY, for the
> 	``[,1] ==> Matrix''   aficionados}

> Especially that we now have require() and provide()  
> [[ provide  has been  fallen out of the source recently,
>    it is "back again" and should appear in the next (pre)release
> ]]


> This is an important discussion - I think -
> so please tell me why you disagree...

> --- Martin

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:13:23 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:13:23 +0200
Subject: R-alpha: plotting empirical distribution function -- plot.step
In-Reply-To: <199708130808.KAA00695@ingrid.ethz.ch>
References: <199708130754.JAA01185@aragorn.ci.tuwien.ac.at>
 <199708130808.KAA00695@ingrid.ethz.ch>
Message-ID: <199708130813.KAA01217@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 	.............

Kurt> What's also needed is something to produce and plot empirical
Kurt> distribution functions.  I thought I could write something for my
Kurt> Biostat course last semester, but it never happened ...

> Maybe I  REALLY should   have my  'plot.step'  function  put into R.

> It does empirical distribution functions and quite a bite more..
> Just need a little time to fixup the man page and do a few more
> tests..

Martin,

Your plot.step should definitely come with R.  The question is, should
there be a class `step' or something similar?  Is there a generic way of
representing step functions?  Then having e.g. print and plot for ECDF
would be automatic, which would be very nice, imho.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Aug 13 09:23:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 13 Aug 1997 10:23:43 +0200
Subject: R-alpha: 'Matrix' & 'matrix' Class
In-Reply-To: <Pine.SUN.3.95.970812090421.777A-100000@spock>
References: <199708120732.JAA00579@sophie.ethz.ch>
 <Pine.SUN.3.95.970812090421.777A-100000@spock>
Message-ID: <199708130823.KAA01224@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

>> 
>> I disagree (I think this is a rare thing with you Thomas..).
>> ----------
>> 1) Lest I misunderstood something,
>> you mean that	for matrices 'x',
>> x[,1]
>> would be a 1--column matrix instead of a vector ?
>> IMHO, this is ugly, and is really just logical if you come from a strict
>> matrix thinker's corner which is the case for  matlab users, and maybe even
>> mathematicians and the like (I'm one myself),
>> but not for an average person analyzing  statistical data.

> I'm not opposed to a matrix class, but I do think drop=FALSE should be
> the default for arrays (I'm not as sure about data frames, but I do
> think it is reasonable that one row of a data frame should be a data
> frame). The reason is that the *current* behaviour of [ with drop=TRUE
> in S and R breaks a lot of S code.

> I have found this particular problem in code written for other people
> to use by people from a wide range of backgrounds. For example, Harald
> Fekjaer's addreg library, Adrian Raftery's bayesian model averaging
> code, and even an early version of Brian Ripley's linear
> discrimination function. These functions break because they assume
> that x[vec,] is a matrix even when it has a single row.  It rarely
> seems to matter if x[,1] is a matrix or a vector, but it is important
> if x[1,] is a vector.

(Hmm.  Why do they break subsequently?)

> For data analysis I don't think it matters much, though I agree it is
> a little ugly for x[,1] to be a matrix. For programming I think that
> drop=F is the same sort of incompatibility as the R scoping rules: one
> that fixes, rather than breaks, S code. Of course people could just
> use drop=F, the way they could just pass variables into nested
> functions explicitly.  The problem is that most of us don't, and it's
> a remarkably difficult bug to find.

I have two remarks on this one.

* Thomas, if you have ports of the above software, could you PLEASE
package them?  (Btw, I have a finished `port' of the V&R `classif'
library, and of the `clus' library which comes with the paper on JSS.)

* Personally, I feel that x[1,] and x[,1] should be a vector if x is a
matrix.  As Martin said, MATRIX `freaks' should be able to attach class
attribute Matrix which would give drop = F.  (Fortunately, the S lang
does not have scalars, otherwise we'd we in trouble with x[i] for x a
vector ...).

If that breaks existing code, I think we should try to get the authors
of that code to make compatibility changes if possible.  E.g. in the
above cases, if subscripting with drop = F would do the trick in either
case, then I don't think that e.g. V&R would object to making the
change.

Or, perhaps R&R should ask Chambers why S does things the way it does?

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 11:37:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 12:37:03 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: <199708122358.LAA04005@stat1.stat.auckland.ac.nz> (message from
 Robert Gentleman on Wed, 13 Aug 1997 11:58:51 +1200 (NZST))
Message-ID: <199708131037.MAA00520@sophie.ethz.ch>

>>>>> "Robert" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

    Robert> Martin wrote:
    >> I am sorry that this IS an old topic.  Yet another task I think the
    >> bug is somewhere in hidden in src/main/options.c ..
    >> 
    >> ##-- The following does not work as it should in R (0.50-a1, but I
    >> think also earlier)
    >> 
    >> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig);
    >> print(x);x} tst() tst(dig = 12)
    >> 
    >> 
    >> ##-- This should do the same; it works as expected in R & S :
    >> 
    >> tst2 <- function(x=pi, dig =3) { oo <- options(digits=dig);
    >> on.exit(oo); print(x);x} tst2() tst2(dig = 12)

    Robert>   Well it isn't really clear what Splus does to get tst to
    Robert> work. It appears that they use some form of dynamic scope for
    Robert> Options. Clearly, the assignment, .Options$digits<- xxxx
    Robert> creates a local copy of .Options and changes the value of
    Robert> that. The only way that print can find this local copy is if it
    Robert> looks up the stack of calling functions to find it (or perhaps
    Robert> Splus squirrels it away somewhere that print looks but then <-
    Robert> starts to behave in a very peculiar manner).  This sort of
    Robert> behaviour is bad for two reasons 1) We really want people to
    Robert> use lexical scope and any examples where you have dynamic scope
    Robert> simply confuse things 2) It is quite inefficient for print (and
    Robert> anything else that uses Options) to have to look up the stack
    Robert> of calling functions.

ok;
yes, I wonder too, how S-plus does it. (Bill V. ?)
    
    Robert>   Since the method Martin so capably demonstrated with tst2
    Robert> does work (except I think he meant on.exit(options(oo)) rather
    Robert> than on.exit(oo)) I think we should stick with that. In that
    Robert> case the global value of options(digits) is changed for the
    Robert> duration of the function evaluation of tst2.
   
okay, I could live with it.

Problem is:

	In the current version (i.e. 0.50-a3), even  tst2(.)
						     ---^---
	does NOT work !
	(yes, it did before ..)

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Aug 13 12:13:35 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Aug 1997 13:13:35 +0200
Subject: R-alpha: .Options$digits do not (always) work.
In-Reply-To: Robert Gentleman's message of Wed, 13 Aug 1997 11:58:51 +1200 (NZST)
References: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>
Message-ID: <x290y6z674.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

>   Well it isn't really clear what Splus does to get tst to work. It appears
>   that they use some form of dynamic scope for Options. Clearly, the 
>   assignment,
>     .Options$digits<- xxxx
>   creates a local copy of .Options and changes the value of that. The only
>   way that print can find this local copy is if  it looks up the stack of
>   calling functions to find it (or perhaps Splus squirrels it away somewhere

Couldn't one have the digits argument of print default to
.Options$digits (or is that eval(.Options$digits,
sys.frame(sys.parent)) ??)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 13 17:21:00 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 Aug 1997 09:21:00 -0700 (PDT)
Subject: R-alpha: Matrix: I surrender
In-Reply-To: <199708130823.KAA01224@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970813085249.1515A-100000@zen>


To make what I was saying a little clearer, the fact that eg
y<-x[vec,]
y[1,]
returns an error if vec is of length 1 (or has one T, &c) is compatible
with S, but not with what most people expect when writing programs.
Statements like y<-x[vec,] nearly always need drop=F as otherwise any
future references to y must have special cases to handle vectors. 

The problem is that we should have drop=F when indexing by vectors that
happen to be of length 1 and drop=T when indexing by scalars. I suppose
it's reasonable to say that programmers can take care of themselves and we
should choose the best default for interactive use, which is certainly
drop=T. 

Perhaps we just need a mental health warning in the documentation and/or
the faq to remind programmers that array dimensions can vanish whenever
you subset. 

Also

Kurt wrote:
> 
> * Thomas, if you have ports of the above software, could you PLEASE
> package them?  (Btw, I have a finished `port' of the V&R `classif'
> library, and of the `clus' library which comes with the paper on JSS.)
> 

 I have ported the addreg library, with additions (and sent it back to
 Harald Fekjaer, who should be releasing it Real Soon Now).  The linear
 discrimination code I referred to is long obsolete and has been fixed (I
 saw it in 1992, I think). I'm intermittently working on the bayesian
 model averaging code, which was the major reason for creating the "leaps" 
 subset selection library. 


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 13 17:38:20 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 Aug 1997 18:38:20 +0200
Subject: R-alpha: Re: R-beta: compiling R-5.0 on IRIX6.1
In-Reply-To: <9708131608.AA11484@isdux1.bham.ac.uk> (message from Dr X Cai on
 Wed, 13 Aug 1997 17:08:31 +0100)
Message-ID: <199708131638.SAA01351@sophie.ethz.ch>

Note that  R-0.50  is  ALPHA testing software
and should only be used by people who are willing to 'bleed'.

Their e-mail list is really  'R-devel' and  NOT  R-help
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Wed Aug 13 18:16:27 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 Aug 1997 13:16:27 -0400
Subject: R-alpha: update on patching
Message-ID: <97Aug13.131808edt.26507@mailgate.bank-banque-canada.ca>

Sorry for previously posting on R-help. 

Thanks to a few people for pointing out -p 0 on patch, but that was not enough (at least under Solaris). It seems Solaris tries to figure out which of the two files is to be updated, and if it finds them both then it starts asking for names. What I actually had to do was

1/ mv R-0.50-a1  R-0.50-a2
2/ cd R-0.50-a2
3/ patch -p 0 <R-0.50-a1.patch

If you 
 cp -r R-0.50-a1  R-0.50-a2
rather than mv, then you must rename R-0.50-a1 or the above mentioned problem occurs.

Paul
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Aug 13 21:18:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 14 Aug 1997 08:18:59 +1200 (NZST)
Subject: R-alpha: frame tools
Message-ID: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>

	Kurt Hornik writes:

	> What's also needed is something to produce and plot empirical
	> distribution functions.  I thought I could write something for my
	> Biostat course last semester, but it never happened ...

Have you had a look at the type="S" and type="s" options to plot?  They
produce two variants of step functions.  I didn't know about them until
I started implementing our version graphics.  They are documented in "par".
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Aug 14 00:32:04 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Thu, 14 Aug 1997 11:32:04 +1200 (NZST)
Subject: R-alpha: .Options$digits  do not (always) work.
Message-ID: <199708132332.LAA23379@stat1.stat.auckland.ac.nz>

> From pd@kubism.ku.dk Wed Aug 13 23:11 NZS 1997
> To: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
> Cc: R-devel@stat.math.ethz.ch
> Subject: Re: R-alpha: .Options$digits  do not (always) work.
> From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
> Date: 13 Aug 1997 13:13:35 +0200
> 
> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
> 
> >   Well it isn't really clear what Splus does to get tst to work. It appears
> >   that they use some form of dynamic scope for Options. Clearly, the 
> >   assignment,
> >     .Options$digits<- xxxx
> >   creates a local copy of .Options and changes the value of that. The only
> >   way that print can find this local copy is if  it looks up the stack of
> >   calling functions to find it (or perhaps Splus squirrels it away somewhere
> 
> Couldn't one have the digits argument of print default to
> .Options$digits (or is that eval(.Options$digits,
> sys.frame(sys.parent)) ??)

  Ah, but how far up do you look? That's fine if print is called from the
  function that sets .Options but what if it is called from a function that
  is called from the function that is....called from the function that set
  .Options. Looking back up all of these is dynamic scope. It is pretty
  inefficient for print to have to look in all these places for a .Options
  before it can do its thing.
  
  Alternatively you could say that print either gets .Options from the parent
  or from top level and so it looks in sys.frame(sys.parent) but then someone
  will want to do it from the grandparent and not understand why it doesn't
  work. 
  
  I think it would be nice if Martin's example ended up in the FAQ (or a
  programming examples repository) with an explanation that the global
  .Options is checked; local copies aren't and that if you want to affect
  the global value you can do it in the manner shown in the example. I think
  this is a big change from what S does so it should be well signposted.
  
  robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From wvenable@attunga.stats.adelaide.edu.au  Thu Aug 14 06:13:11 1997
From: wvenable@attunga.stats.adelaide.edu.au (Bill Venables)
Date: Thu, 14 Aug 1997 14:43:11 +0930
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: <199708131037.MAA00520@sophie.ethz.ch>
References: <199708122358.LAA04005@stat1.stat.auckland.ac.nz>
 <199708131037.MAA00520@sophie.ethz.ch>
Message-ID: <9708140513.AA13924@attunga.stats.adelaide.edu.au>

Martin Maechler writes:
 > >>>>> "Robert" == Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
 > 
 >     Robert> Martin wrote:
 >     >> I am sorry that this IS an old topic.  Yet another task I think the
 >     >> bug is somewhere in hidden in src/main/options.c ..
 >     >> 
 >     >> ##-- The following does not work as it should in R (0.50-a1, but I
 >     >> think also earlier)
 >     >> 
 >     >> tst <- function(x=pi, dig =3) {.Options$digits <- as.integer(dig);
 >     >> print(x);x} tst() tst(dig = 12)
 >     >> 
 >     >> 
 >     >> ##-- This should do the same; it works as expected in R & S :
 >     >> 
 >     >> tst2 <- function(x=pi, dig =3) { oo <- options(digits=dig);
 >     >> on.exit(oo); print(x);x} tst2() tst2(dig = 12)

I think not.  Here is what you probably meant to use

tst2 <- function(x = pi, dig = 3) {
  oo <- options(digits = dig)
  on.exit(options(oo))
  print(x)
  x
}

> tst2()
[1] 3.14
[1] 3.14159

Notice that the on.exit() happens after the function is complete
but before auto-printing.

 >     Robert> Well it isn't really clear what Splus does to get
 >     Robert> tst to work. It appears that they use some form of
 >     Robert> dynamic scope for Options.  Clearly, the
 >     Robert> assignment, .Options$digits <- xxxx creates a local
 >     Robert> copy of .Options and changes the value of
 >     Robert> that.  The only way that print can find this local
 >     Robert> copy is if it looks up the stack of calling
 >     Robert> functions to find it (or perhaps Splus squirrels
 >     Robert> it away somewhere that print looks but then <-
 >     Robert> starts to behave in a very peculiar manner).  This
 >     Robert> sort of behaviour is bad for two reasons 1) We
 >     Robert> really want people to use lexical scope and any
 >     Robert> examples where you have dynamic scope simply
 >     Robert> confuse things 2) It is quite inefficient for
 >     Robert> print (and anything else that uses Options) to
 >     Robert> have to look up the stack of calling functions.
 > 
 > ok;
 > yes, I wonder too, how S-plus does it. (Bill V. ?)

(? Y me?) Sorry, but I don't have any inside knowledge.  A little
experimentation shows that

> options(digits = 10)

operates like an assignment sequence of the form

> .Options$digits <- 10
> assign(".Options", .Options, where = 6)  # or wherever...
> remove(".Options")

Which you normally cannot do directly, of course, (and clearly
the effect is not permanent).

Bill.

-- 
Bill Venables, Head, Dept of Statistics,    Tel.: +61 8 8303 5418
University of Adelaide,                     Fax.: +61 8 8303 3696
South AUSTRALIA.     5005.   Email: Bill.Venables@adelaide.edu.au
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 14 09:30:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 14 Aug 1997 10:30:44 +0200
Subject: R-alpha: .Options$digits  do not (always) work.
In-Reply-To: Robert Gentleman's message of Thu, 14 Aug 1997 11:32:04 +1200 (NZST)
References: <199708132332.LAA23379@stat1.stat.auckland.ac.nz>
Message-ID: <x2hgct4157.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> > Couldn't one have the digits argument of print default to
> > .Options$digits (or is that eval(.Options$digits,
> > sys.frame(sys.parent)) ??)
> 
>   Ah, but how far up do you look? That's fine if print is called from the
>   function that sets .Options but what if it is called from a function that
>   is called from the function that is....called from the function that set
>   .Options. Looking back up all of these is dynamic scope. It is pretty
>   inefficient for print to have to look in all these places for a .Options
>   before it can do its thing.
>   
>   Alternatively you could say that print either gets .Options from the parent
>   or from top level and so it looks in sys.frame(sys.parent) but then someone
>   will want to do it from the grandparent and not understand why it doesn't
>   work. 
>   
>   I think it would be nice if Martin's example ended up in the FAQ (or a
>   programming examples repository) with an explanation that the global
>   .Options is checked; local copies aren't and that if you want to affect
>   the global value you can do it in the manner shown in the example. I think
>   this is a big change from what S does so it should be well signposted.

Aha. Is this a case where S's "expression frame" does something useful
for once? I've always hated it because it prevents the whole language
from being self-similar: Run the good ol' read-eval-print loop and all
the assignments to frame 1 will get cleaned up between commands, make
a menu-style function that runs the same commands and the crud builds
up.

Maybe we need some kind of limited support for dynamically scoped
variables? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 14 13:01:31 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 14 Aug 1997 14:01:31 +0200
Subject: R-alpha: Re: R-beta:  R-0.49 on IRIX6.1 does not compile
In-Reply-To: <9708140950.AA23517@isdux1.bham.ac.uk> (message from Dr X Cai on
 Thu, 14 Aug 1997 10:50:08 +0100)
Message-ID: <199708141201.OAA01160@sophie.ethz.ch>

>>>>> "XC" == X Cai <caix@isdugp.bham.ac.uk> writes:

    XC> Dear Martin, I am sorry to put the message for the alpha testing
    XC> software.  In fact, when I compiled version R-0.49, the same error
    XC> occurred to me.  Is R-0.49 also at alpha testing stage?  This means
    XC> that I cannot use any version of R.  Do you have any idea about the
    XC> compiling error?


Dear Cai,

R-0.49  was released as beta. 
and
it's good to know about compilation problems, even for alpha releases.

My point really was that you should send reports like these to R-devel
rather than R-help.

    XC> Your kind assistance would be greatly appreciated!

I can only help a little:

1) The 'statement is unreachable' is really just a warning.
   [ I also get a few of those when compiling 
     under Solaris 2.5.1 with Sun's cc.]
 
   They shouldn't have caused your compilation problem.

   [now, see below]

    XC> p.s.: The last few lines of message when compiling R-0.49:

    XC> 	cc -g -I../include -DPOSIX_MISTAKE -c regerror.c
    XC> 	cc -g -I../include -DPOSIX_MISTAKE -c regexec.c
    XC> "engine.c", line 604: warning(1110): statement is unreachable
    XC>   		break;
    XC>   		^

    XC> "engine.c", line 610: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 616: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 627: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 648: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 659: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 670: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 604: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 610: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 616: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 627: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 648: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 659: warning(1110): statement is unreachable
    XC> break; ^

    XC> "engine.c", line 670: warning(1110): statement is unreachable
    XC> break; ^



    XC> Signal: SIGSEGV in Scope Setup phase.
    XC> ### Error (user routine 'sdissect'):
    XC> ### Signal SIGSEGV in phase Scope Setup -- processing aborted
    XC> cc ERROR:  /usr/lib64/cmplrs/fec died due to signal 4
    XC> cc ERROR:  core dumped
    XC> *** Error code 2 (bu21)
    XC> *** Error code 1 (bu21)
    XC> *** Error code 1 (bu21)

Just above lies the compilation error culprit.
Unfortunately, I have no idea what  "Scope Setup phase"  means...

Can you find out what  'fec' is doing, or where  'bu21' comes from?


Probably someone else from the R-devel  list can help you better than I
do...
-- Martin

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From caix@isdugp.bham.ac.uk  Thu Aug 14 14:40:20 1997
From: caix@isdugp.bham.ac.uk (Dr X Cai)
Date: Thu, 14 Aug 1997 14:40:20 +0100
Subject: R-alpha: Compiling 0.49 on IRIX6.1
Message-ID: <9708141340.AA14089@isdux1.bham.ac.uk>

Hi,

I am compiling R-0.49 on my SGI Indigo 2 R8000 machine and it stopped
in the middle.  Could anyone help me to fix it?

Many thanks!
-- 

                                     Xiaoming Cai
                                     School of Geography
      .&______~*@*~______&.          University of Birmingham
    "w/%%%%%%%%%%%%%%%%%%%\w"        Edgbaston, Birmingham
      `Y""Y""Y"""""Y""Y""Y'          B15 2TT United Kingdom
   p-p_|__|__|_____|__|__|_q-q       Tel: 44 (121) 414-5533 (O)
_-[EEEEM==M==MM===MM==M==MEEEE]-_    Tel: 44 (121) 454-4018 (H)
                                     Fax: 44 (121) 414-5528


p.s.:  The last few lines of message when compiling R-0.49:

	cc -g -I../include -DPOSIX_MISTAKE -c regerror.c
	cc -g -I../include -DPOSIX_MISTAKE -c regexec.c
"engine.c", line 604: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 610: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 616: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 627: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 648: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 659: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 670: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 604: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 610: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 616: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 627: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 648: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 659: warning(1110): statement is unreachable
  		break;
  		^

"engine.c", line 670: warning(1110): statement is unreachable
  		break;
  		^

Signal: SIGSEGV in Scope Setup phase.
### Error (user routine 'sdissect'):
### Signal SIGSEGV in phase Scope Setup -- processing aborted
cc ERROR:  /usr/lib64/cmplrs/fec died due to signal 4
cc ERROR:  core dumped
*** Error code 2 (bu21)
*** Error code 1 (bu21)
*** Error code 1 (bu21)


-- 

                                     Xiaoming Cai
                                     School of Geography
      .&______~*@*~______&.          University of Birmingham
    "w/%%%%%%%%%%%%%%%%%%%\w"        Edgbaston, Birmingham
      `Y""Y""Y"""""Y""Y""Y'          B15 2TT United Kingdom
   p-p_|__|__|_____|__|__|_q-q       Tel: 44 (121) 414-5533 (O)
_-[EEEEM==M==MM===MM==M==MEEEE]-_    Tel: 44 (121) 454-4018 (H)
                                     Fax: 44 (121) 414-5528
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 14 19:58:29 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 Aug 1997 11:58:29 -0700 (PDT)
Subject: R-alpha: library()
In-Reply-To: <97Aug13.131808edt.26507@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970814115635.1947A-100000@zen>


The CHANGES file says that libraries can now have a .First.lib and
.Last.lib function.  While this is certainly true the functions don't seem
to get called...


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 14 20:38:31 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 Aug 1997 12:38:31 -0700 (PDT)
Subject: R-alpha: autoload again
In-Reply-To: <Pine.SUN.3.95.970814115635.1947A-100000@zen>
Message-ID: <Pine.SUN.3.95.970814123032.1947B-100000@zen>


I have made an autoload library, with a nicer version of the autoload code
I posted a few weeks ago.  It now stores things in a special environment
and it will re-autoload libraries that have been detached. It only works
with the new alpha R. The syntax is eg
autoload("line","eda") 
to automatically load library("eda") when the function line() is invoked.

The library file is at 
http://www.biostat.washington.edu/~thomas/autoload.tar.gz

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 15 08:45:41 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 15 Aug 1997 09:45:41 +0200
Subject: R-alpha: autoload  -- cool!
In-Reply-To: <Pine.SUN.3.95.970814123032.1947B-100000@zen> (message from
 Thomas Lumley on Thu, 14 Aug 1997 12:38:31 -0700 (PDT))
Message-ID: <199708150745.JAA02268@sophie.ethz.ch>

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> I have made an autoload library, with a nicer version of the
    Thomas> autoload code I posted a few weeks ago.  It now stores things
    Thomas> in a special environment and it will re-autoload libraries that
    Thomas> have been detached. It only works with the new alpha R. The
    Thomas> syntax is eg autoload("line","eda") to automatically load
    Thomas> library("eda") when the function line() is invoked.

    Thomas> The library file is at
    Thomas> http://www.biostat.washington.edu/~thomas/autoload.tar.gz

I did not try it (yet);
however, it's such a cool idea that I think 
it should make its way into "R base" !

Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 15 09:25:04 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 15 Aug 1997 20:25:04 +1200 (NZST)
Subject: R-alpha: autoload  -- cool!
Message-ID: <199708150825.UAA17107@stat1.stat.auckland.ac.nz>

Sounds great!  I will snag a copy and add it.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 15 16:06:35 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 15 Aug 1997 17:06:35 +0200
Subject: R-alpha: (minor?) S-R inconsistency:  NULL =~= list()  -- useful is.ALL function
Message-ID: <199708151506.RAA02837@sophie.ethz.ch>


In S, 
	NULL
and
	list()
are not the same.

In R they are (I think).

---------------------------------------------------

At least,

	is.list(NULL) #-> 'F' in S;   'TRUE' in R


Yes: I had an instance where this broke correct S code:

	match(c("xlab","ylab"), names(list(...)))

when '...' is empty, 
gives an error in R,
but gives
	c(NA,NA)
in S.

------------
You may like my function 'is.ALL(.)' for detecting things like these :
(actually some more functions;
 a relatively nice example of using NextMethod(..) for a new "print" method
)

is.ALL <- function(obj, func.names = ls("library:base"),
                   not.using = c("is.single", "is.na.data.frame", "is.loaded"),
                   true.only = FALSE)
{
  ## Purpose: show many 'attributes' of  R object __obj__
  ## -------------------------------------------------------------------------
  ## Arguments: obj: any R object
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date:  6 Dec 96, 15:23

  is.fn <- func.names[substring(func.names,1,3) == "is."]
  use.fn <- is.fn[ is.na(match(is.fn, not.using))]

  r <- if(true.only) character(0)
  else structure(vector("list", length= length(use.fn)), names= use.fn)
  for(f in use.fn) {
    if(any(f == c("is.na", "is.finite"))) {
      if(!is.list(obj) && !is.vector(obj) && !is.array(obj)) {
        if(!true.only) r[[f]] <- NA
        next
      }
    }
    ##prt.DEBUG("f =",f,"; last rr:", if(f!=use.fn[1]) rr else ".. not yet..")
    rr <-  (get(f))(obj)
    if(!is.logical(rr)) cat("f=",f," --- rr  is NOT logical  = ",rr,"\n")
    ##if(1!=length(rr))   cat("f=",f," --- rr NOT of length 1; = ",rr,"\n")
    if(true.only && length(rr)==1 && rr) r <- c(r, f)
    else if(!true.only) r[[f]] <- rr
  }
  if(is.list(r)) structure(r, class = "isList") else r
}

print.isList <- function(r, ...)
{
  ## Purpose:  print METHOD  for  'isList' objects
  ## -------------------------------------------------------------------------
  ## Arguments:
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date: 12 Mar 97, 15:07
  ## >>>>> needs  cmp.logical  --> /u/maechler/R/Util.R
  if(is.list(r)) {
    nm <- format(names(r))
    rr <- lapply(r,cmp.logical)
    for(i in seq(along=r)) cat(nm[i],":",rr[[i]],"\n", ...)
  } else NextMethod("print", ...)
}

cmp.logical <- function(log.v)
{
  ## Purpose: compact printing of logicals
  ## -------------------------------------------------------------------------
  ## Arguments: log.v : logical vector
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler, Date: 13 Dec 96, 16:28
  if(!is.logical(log.v)) {
    warning("coercing argument 'log.v' to logical")
    log.v <- as.logical(log.v)
  }
  structure(if(length(log.v) == 0) "()" else c(".","|")[ 1+ log.v],
	    class = "noquote")
}


## The constructor function
noquote <- function(obj) {
  if(!inherits(obj,"noquote"))
    class(obj) <- c(class(obj),"noquote")
  obj
}
##-- this is just like 'expression'
"[.noquote" <- function (x, subs) structure(unclass(x)[subs], class = "noquote")
## A method for (character) objects of class  'noquote' :
print.noquote <- function(obj,...) {
  cl <- class(obj)
  class(obj) <- cl[cl != "noquote"]
  NextMethod('print', obj, quote = F, ...)
}


### ------------------------------------------------------------------
### Here are some examples on its (is.ALL)  usage :


is.ALL(NULL)

###------- more compactly : ------------ here, we see that   NULL "==" list()

is.ALL(NULL,   true.only = TRUE)
## [1] "is.atomic" "is.list"   "is.null"  
is.ALL(list(), true.only = TRUE)
## [1] "is.atomic" "is.list"   "is.null"  



is.ALL(1:5)
is.ALL(array(1:24, 2:4))
is.ALL(1 + 3)
e13 <- expression(1 + 3)
is.ALL(e13)
## fails (0.50-a) [is.loaded]
##   is.ALL(e13, not.using=c("is.single", "is.finite", "is.na"))
is.ALL(y ~ x) #--> (0.49):  NA  for 'is.na' (& is.finite)



is.ALL(numeric(0), true=T)
is.ALL(array(1,1:3), true=T)
is.ALL(cbind(1:3), true=T)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Aug 15 16:53:11 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 15 Aug 1997 08:53:11 -0700 (PDT)
Subject: R-alpha: (minor?) S-R inconsistency:  NULL =~= list()  -- useful is.ALL function
In-Reply-To: <199708151506.RAA02837@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970815084207.2193A-100000@zen>

On Fri, 15 Aug 1997, Martin Maechler wrote:
> In S, 
> 	NULL
> and
> 	list()
> are not the same.
> 
> In R they are (I think).
> 

The thing that really broke your code is an incompatibility I reported a
while back that people didn't seem to think was serious.  

Comparisons involving NULL give an error in R, but give NA in S.  I didn't
have an example at the time except to point out that returning NA would at
least allow correct short-circuiting of & and | conditions. 

I think in match() there is a much stronger argument for returning NA (or
the nomatch value).  After all, the description of match says

             If x[i] is found to equal table[j] then the value
             returned in the i-th position of the return value is j.
             If no match is found, the value is nomatch.

Surely if table==NULL then the correct return value is nomatch.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 18 10:00:25 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 18 Aug 1997 11:00:25 +0200
Subject: R-alpha: Re: R-beta: Bug or feature?  [+ better histograms]
In-Reply-To: <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
References: <199708170921.VAA03388@stat1.stat.auckland.ac.nz>
 <9708172313.AA15474@attunga.stats.adelaide.edu.au>
 <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
Message-ID: <199708180900.LAA02371@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Bill Venables writes:
>> First a bit of an explanation.  Brian Ripley and I are firmly of
>> the opinion that, to be any use in teaching at all, histograms
>> should be nonparametric estimators of the probability density
>> function.  That is, the vertical scale should be a relative
>> frequency density scale.  It seems impossible to get this in R, so
>> here is a function (+ a few extras) that does give you a "true"
>> histogram, (unless you are peverse enough to request otherwise.)

> Oh goody!  I HATE the present hist; partly because of the
> frequency/density aspect, but mainly because if I ask for 10 cells I
> expect to get 10 cells, not 7 or 35 or whatever.  I'd like propose
> that the present hist get renamed hist.old (or something similar) and
> that Bill's "truehist" become the true "hist".

I'd say, get rid of the old one ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 18 10:51:57 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Aug 1997 11:51:57 +0200
Subject: R-alpha: Re: R-beta: Bug or feature?  [+ better histograms]
In-Reply-To: Kurt Hornik's message of Mon, 18 Aug 1997 11:00:25 +0200
References: <199708170921.VAA03388@stat1.stat.auckland.ac.nz>
 <9708172313.AA15474@attunga.stats.adelaide.edu.au>
 <199708172342.LAA09442@stat1.stat.auckland.ac.nz>
 <199708180900.LAA02371@aragorn.ci.tuwien.ac.at>
Message-ID: <x23eo7ddj6.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Ross Ihaka writes:
> 
> > Bill Venables writes:
> >> First a bit of an explanation.  Brian Ripley and I are firmly of
> >> the opinion that, to be any use in teaching at all, histograms
> >> should be nonparametric estimators of the probability density
> >> function.  That is, the vertical scale should be a relative
> >> frequency density scale.  It seems impossible to get this in R, so
> >> here is a function (+ a few extras) that does give you a "true"
> >> histogram, (unless you are peverse enough to request otherwise.)
> 
> > Oh goody!  I HATE the present hist; partly because of the
> > frequency/density aspect, but mainly because if I ask for 10 cells I
> > expect to get 10 cells, not 7 or 35 or whatever.  I'd like propose
> > that the present hist get renamed hist.old (or something similar) and
> > that Bill's "truehist" become the true "hist".
> 
> I'd say, get rid of the old one ...
> 

Ugh. Please do NOT do that! Some of us need to teach histograms to
people who have difficulties with integrals (and also in recognizing
the connection between a barplot and a step function), so we have to
make do with "shape of curve" considerations, at least in the
beginning. The last thing we need is inexplicable y-axes.

The "# in bin" is not really problematic as long as the the bins are
of the same size and *much* easier to explain to students. 

Even for a statistician, the number is really what conveys the
accuracy estimate that you need when you try to evaluate whether a
histogram matches a given density.

Make it an option, e.g. hist(x,as.density=T). People who can
understand why the "sum of area of blocks should be 1" can also figure
out how to add an option to a function call.

I could easily do without the "prettification" silliness, though.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 18 14:03:37 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 18 Aug 1997 15:03:37 +0200
Subject: R-alpha: Re: R-beta: .C and dyn.load for Windows
In-Reply-To: Goran Brostrom's message of Mon, 18 Aug 1997 14:10:10 +0200 (MET DST)
References: <Pine.GSO.3.95.970818135113.11654A-100000@pc30.stat.umu.se>
Message-ID: <x2yb5zbq3a.fsf@bush.kubism.ku.dk>

Goran Brostrom <gb@pc30.stat.umu.se> writes:

> 
> Dear R-users,
> 
> I maintain software for survival analysis written in C and Fortran since
> many years ago. Recently I have rewritten part of it as functions to
> be called from R by .C. This works fine with the unix version. I just
> create a ".so" file as described in an example in the R distribution.
> 
> However, when I try this approach in Windows (NT or 95), using the 
> Cygnus gcc latest version, the "ld" command to create the ".so" file fails
> miserably. The Windows R documentation talks about "DLL"s, of which I
> know very little.
> 
> Can anyone tell me how to create R-loadable C-code with Cygnus gcc under
> Windows (NT, 95)?
> Maybe it isn't possible?

(This really is alpha/development  stuff, belonging on r-devel)

Is this the Cygnus gcc from gnuwin32? You're a very brave person..!
You didn't happen to get the Windows GUI stuff going while you were at
it, did you?

Robert Gentleman says that he has DLL loading "near the top of his
list" for the next Windows binary version.

Another pointer is that it is rumored that *scilab* has some code to
do the trick on the windows platforms

Some nice guy on the gnuwin32 list claimed to have compatibility
functions for the whole dlopen/dlsym/.. slew a few weeks ago.

BTW: You do know that there already is a quite comprehensive survival
package for R?

Here is the note from gnuwin32:

------------------
Dear all,

I have made some work to let dlls have almost the same behavior as so on UNIX:

        - implementation of dlopen,dlclose,dlsym,dlerror
        - correct init when loaded + call of global contructors
        - call of global destructors when detached
        - dlls are accessible and correctly initialized in forked process
        - handles got through dlopen or dlsym in parent are accessible in child
        - use of LD_LIBRARY_PATH in dlopen search

I think it can help people who need an intensive use of dll ( plugins ... )

My patch is 59082 bytes, so I will not send it to the list.
Anyway, if you are interested, send me a mail and I will send you the patch
personnaly ...

Regards.

P.S: I will send the patch to Geoffrey Noer


 ==========================================================================
|                         Philippe GIACINTI                                |
|                                                                          |
| DALiM GmbH R&D                                email:  giac@dalim.de      |
| Daimler Strasse 2,                            tel:    +49.7851.9196-28   |
| D-77694 Kehl-Sundheim Germany                 fax:    +49.7851.73576     |
|                                                                          |
 ==========================================================================


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Tue Aug 19 09:53:48 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Tue, 19 Aug 1997 10:53:48 +0200 (MET DST)
Subject: R-alpha: A few bugs in R-0.50-a3.
Message-ID: <9708190853.AA10759@alpha.luc.ac.be>

A few problems in R-0.50-a3 (which were also in R-0.49):

1)
y <- c(10,11,12,13,14,NA,NA)
n <- length(y)
missed <- (1:n)[is.na(y)]
notmissed <- (1:n)[!is.na(y)]
blocks <- cut(missed,breaks=c(0,notmissed,n+1))
a <- function(v) {
	q <- range(v)
	c(q[1]-1,q[2]+1)
}
brackets <- tapply(missed,blocks,a)

This codes gives the following in S:
> brackets
$"0+ thru 1":
NULL

$"1+ thru 2":
NULL

$"2+ thru 3":
NULL

$"3+ thru 4":
NULL

$"4+ thru 5":
NULL

$"5+ thru 8":
[1] 5 8

>

And the following in R:

> brackets <- tapply(missed,blocks,a)
Error: names attribute must be same length as the vector

I also had similar problems when using "lm" with data containing NA's
but could not find back a precise example...

2)
b <- list(2)
names(b) <- "lty"
a <- function(...) {
	par(c(...,b))
	par()
}
a()


The following is obtained in S:
> win.graph()
> a()
$"1em":
[1] 0.03150623 0.05075211

$adj:
[1] 0.5

$ask:
[1] F

$bty:
[1] "o"

$cex:
[1] 1

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 19 19:51:17 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 19 Aug 1997 20:51:17 +0200
Subject: R-alpha: ECDFs
In-Reply-To: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>
References: <199708132018.IAA17831@stat1.stat.auckland.ac.nz>
Message-ID: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> 	Kurt Hornik writes:
>> What's also needed is something to produce and plot empirical
>> distribution functions.  I thought I could write something for my
>> Biostat course last semester, but it never happened ...

> Have you had a look at the type="S" and type="s" options to plot?
> They produce two variants of step functions.  I didn't know about them
> until I started implementing our version graphics.  They are
> documented in "par".

I hadn't known about them either, but I think Martin's plot.step is
needed for plotting e.g. ECDFs.

Here's something what is needed for teaching elementary statistics:
Given a sample vector x, compute the corresponding ECDF, plot it, and
perhaps evaluate it at points other than the data points.

One solution might be to have a function "ecdf" which returns an obj of
class "step" (e.g., simply a list with the points where the jumps occur
and the corresponding values, and maybe if we want to be more general
than that info on whether the function is left- or right-continuous at
the point (or perhaps attains a different value).  (I.e., something of
the kind that Martin's plot.step uses ...)

This would more or less automagically take care of the plotting part.
We could also easily add print and summary methods.

The question is, how can we `easily' evaluate a step function at some
point?  Using `predict' does not seem to be the right thing ... any
suggestions?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 19 19:55:34 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 19 Aug 1997 11:55:34 -0700 (PDT)
Subject: R-alpha: ECDFs
In-Reply-To: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>

On Tue, 19 Aug 1997, Kurt Hornik wrote:
> 
> Here's something what is needed for teaching elementary statistics:
> Given a sample vector x, compute the corresponding ECDF, plot it, and
> perhaps evaluate it at points other than the data points.

The approx() function is supposed to do this (it currently only does
linear interpolation).  If the right and left continuous step functions
were added to approx then we could easily use approxfun to define the ECDF
as a function closure, making it automatically available at any point you
want. After all, the ECDF *is* a function.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 19 19:57:56 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 19 Aug 1997 20:57:56 +0200
Subject: R-alpha: A few bugs in R-0.50-a3.
In-Reply-To: <9708190853.AA10759@alpha.luc.ac.be>
References: <9708190853.AA10759@alpha.luc.ac.be>
Message-ID: <199708191857.UAA02786@aragorn.ci.tuwien.ac.at>

>>>>> Patrick Lindsey writes:

> A few problems in R-0.50-a3 (which were also in R-0.49):
> 1)
> y <- c(10,11,12,13,14,NA,NA)
> n <- length(y)
> missed <- (1:n)[is.na(y)]
> notmissed <- (1:n)[!is.na(y)]
> blocks <- cut(missed,breaks=c(0,notmissed,n+1))
> a <- function(v) {
> 	q <- range(v)
> 	c(q[1]-1,q[2]+1)
> }
> brackets <- tapply(missed,blocks,a)

> This codes gives the following in S:
>> brackets
> $"0+ thru 1":
> NULL

> $"1+ thru 2":
> NULL

> $"2+ thru 3":
> NULL

> $"3+ thru 4":
> NULL

> $"4+ thru 5":
> NULL

> $"5+ thru 8":
> [1] 5 8

>> 

> And the following in R:

>> brackets <- tapply(missed,blocks,a)
> Error: names attribute must be same length as the vector

> I also had similar problems when using "lm" with data containing NA's
> but could not find back a precise example...

I think the patch below (which should make it into the next set of
patches) fixes that.

(Except for the differences in cut() ...)

--- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
+++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
@@ -14,7 +14,7 @@
 		index <- as.factor(INDEX[[i]])
 		if (length(index) != nx) 
 			stop("arguments must have same length")
-		namelist[[i]] <- levels(index)
+		namelist[[i]] <- unique(levels(index)[index])
 		extent[[i]] <- nlevels(index)
 		group <- group + ngroup * (codes(index) - 1)
 		ngroup <- ngroup * nlevels(index)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Aug 19 19:58:13 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 19 Aug 1997 11:58:13 -0700 (PDT)
Subject: R-alpha: tapply
In-Reply-To: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
Message-ID: <Pine.SUN.3.95.970819115641.28406E-100000@chekov>


tapply() has been broken for a long time and is still wrong in 50-a3.  I
think the following version works. 

	-thomas

"tapply" <-function (x, INDEX, FUN, ...) 
{
        if (is.character(FUN)) 
                FUN <- get(FUN, mode = "function")
        if (mode(FUN) != "function") 
                stop(paste("\"", FUN, "\" is not a function"))
        if (!is.list(INDEX)) 
                INDEX <- list(INDEX)
        namelist <- vector("list", length(INDEX))
        extent <- integer(length(INDEX))
        nx <- length(x)
        group <- rep(1, nx)
        ngroup <- 1
        for (i in seq(INDEX)) {
                index <- as.factor(INDEX[[i]])
                if (length(index) != nx) 
                        stop("arguments must have same length")
                namelist[[i]] <- levels(index)
                extent[[i]] <- nlevels(index)
                group <- group + ngroup * (codes(index) - 1)
                ngroup <- ngroup * nlevels(index)
        }
        if (missing(FUN))  
                return(group)
	ansmat<-array(NA,dim=extent,dimnames=namelist)
        ans <- lapply(split(x, group), FUN, ...)
        if (all(unlist(lapply(ans, length)) == 1)) {
                ans <- unlist(ans, recursive = FALSE)
	      }
	else { mode(ansmat)<-"list"}
	ansmat[as.numeric(names(ans))]<-ans
	ans<-ansmat
        return(ans)
}


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 09:45:21 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 10:45:21 +0200
Subject: R-alpha:  tapply patch -- Thomas version?
In-Reply-To: <199708191857.UAA02786@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 19 Aug 1997 20:57:56 +0200)
Message-ID: <199708200845.KAA02289@sophie.ethz.ch>


>>>>> Patrick Lindsey writes:
> A few problems in R-0.50-a3 (which were also in R-0.49):
> 1)
> y <- c(10,11,12,13,14,NA,NA)
> n <- length(y)
> missed <- (1:n)[is.na(y)]
> notmissed <- (1:n)[!is.na(y)]
> blocks <- cut(missed,breaks=c(0,notmissed,n+1))
> a <- function(v) {
> 	q <- range(v)
> 	c(q[1]-1,q[2]+1)
> }
> brackets <- tapply(missed,blocks,a)

> This codes gives the following in S:   

> .....

    Kurt> I think the patch below (which should make it into the next set of
    Kurt> patches) fixes that.

yes, it does fix the problem -- and it has been in the current source tree
for about 10 days...
 
   Kurt> (Except for the differences in cut() ...)

    Kurt> --- src/library/base/funs/tapply.orig	Fri Feb  7 01:08:31 1997
    Kurt> +++ src/library/base/funs/tapply	Sun Aug 10 21:57:31 1997
    Kurt> @@ -14,7 +14,7 @@
    Kurt> index <- as.factor(INDEX[[i]])
    Kurt> if (length(index) != nx) 
    Kurt> stop("arguments must have same length")
    Kurt> -		namelist[[i]] <- levels(index)
    Kurt> +		namelist[[i]] <- unique(levels(index)[index])
    Kurt> extent[[i]] <- nlevels(index)
    Kurt> group <- group + ngroup * (codes(index) - 1)
    Kurt> ngroup <- ngroup * nlevels(index)
 
Thomas, what does your function do differently ?

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 16:52:53 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 17:52:53 +0200
Subject: R-alpha: R-0.50-a3(+) Method despatching bug ?
Message-ID: <199708201552.RAA02602@sophie.ethz.ch>

It is very wierd...  Can some of you confirm the following behavior ?
It is a new bug (feature ?)  which was not yet in 0.49 ...




noquote <- function(obj) {
	## constructor for a useful "minor" class
	if(!inherits(obj,"noquote")) class(obj) <- c(class(obj),"noquote")
	obj
}
"[.noquote" <- function (x, subs) structure(unclass(x)[subs], class = "noquote")

print.noquote <- function(obj,...) {
	## method for (character) objects of class 'noquote'
	cl <- class(obj)
	class(obj) <- cl[cl != "noquote"]
	NextMethod("print", obj, quote = FALSE, ...)
}

nq <- noquote(letters)

##-- the next two should be equivalent, but are not ...?..
print(nq)
nq

> print(nq)
 [1] a b c d e f g h i j k l m n o p q r s t u v w x y z

> nq
Error: couldn't find function "print.noquote"
> unclass(nq)
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"
[20] "t" "u" "v" "w" "x" "y" "z"
> nq
Error: couldn't find function "print.noquote"
> ls()
[1] "[.noquote"     "noquote"       "nq"            "print.noquote"
> print.noquote
function (obj, ...) 
{
        ## method for (character) objects of class 'noquote'
        cl <- class(obj)
        class(obj) <- cl[cl != "noquote"]
        NextMethod("print", obj, quote = FALSE, ...)
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 20 18:06:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 Aug 1997 19:06:11 +0200
Subject: R-alpha: R-0.50-a3: [logical, drop = FALSE] -- bug in R (and S-plus)
Message-ID: <199708201706.TAA02765@sophie.ethz.ch>

This is a bug both in R and S-plus (in R it's "worse"), I think.
Look at this :

ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
ma[logi,]
##>      [,1] [,2]
##> [1,]    1    1
##> [2,]    1    3
##> [3,]    1    5
##> [4,]    1    7

##-- now the same with  [ , drop = FALSE]

## R (-0.50-a3) :

	 ma[logi, drop = F]
##>> Error: invalid subscript type


## Splus-3.4:
	 ma[logi, drop = F]
##>> [1] 1 1 1 1 1 3 5 7

##---- which is not correct either, we would want the matrix !
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 20 18:21:25 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 Aug 1997 10:21:25 -0700 (PDT)
Subject: R-alpha: R-0.50-a3: [logical, drop = FALSE] -- bug in R (and S-plus)
In-Reply-To: <199708201706.TAA02765@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970820101359.641C-100000@chekov>

On Wed, 20 Aug 1997, Martin Maechler wrote:

> This is a bug both in R and S-plus (in R it's "worse"), I think.

I don't think it's a bug

> Look at this :
> 
> ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
> ma[logi,]
> ##>      [,1] [,2]
> ##> [1,]    1    1
> ##> [2,]    1    3
> ##> [3,]    1    5
> ##> [4,]    1    7
> 
> ##-- now the same with  [ , drop = FALSE]
> 
> ## R (-0.50-a3) :
> 
> 	 ma[logi, drop = F]
> ##>> Error: invalid subscript type
> ## Splus-3.4:
> 	 ma[logi, drop = F]
> ##>> [1] 1 1 1 1 1 3 5 7

This is correct.  Did you mean ma[logi,,drop=F]? If you use
ma[logi,drop=F] then this is the equivalent of ma[logi] with drop=F. But
ma[logi] treats the matrix as a vector and there aren't any dimensions to
drop. R should probably recycle the index vector the way S does. 

The loss of dimensions is unavoidable -- suppose you had
ma[c(3,7,8),drop=F].  How are you going to turn this into a matrix?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Wed Aug 20 18:34:35 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Wed, 20 Aug 1997 10:34:35 -0700 (PDT)
Subject: R-alpha: R-0.50-a3(+) Method despatching bug ?
In-Reply-To: <199708201552.RAA02602@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970820094622.641B-100000@chekov>

On Wed, 20 Aug 1997, Martin Maechler wrote:

> It is very wierd...  Can some of you confirm the following behavior ?
> It is a new bug (feature ?)  which was not yet in 0.49 ...
>

I'm not sure that you can expect NextMethod to work if you fiddle with the
class list...

However, there is still something wrong with method dispatching, since
print.noquote <- function (obj, ...)  NextMethod(quote = FALSE,...)
doesn't work either.  The error occurs when R tries for some reason to
make a recursive call to print.noquote.

Using debug() also shows the interesting fact that
R> nq 
calls print() with its arguments evaluated
------
debugging in: print(structure(c("a", "b", "c", "d", "e", "f", "g", "h",
"i", 
"j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", 
"w", "x", "y", "z"), class = "noquote"))
debugging in: print.noquote(structure(c("a", "b", "c", "d", "e", "f", "g", 
"h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", 
"u", "v", "w", "x", "y", "z"), class = "noquote"))
Error: couldn't find function "print.noquote"
-------
but
----------
R> print(nq)
 print(nq)
debugging in: print(nq)
debugging in: print.noquote(nq)
 [1] a b c d e f g h i j k l m n o p q r s t u v w x y z
attr(,"class")
[1] noquote
exiting from: print.noquote(nq)
exiting from: print(nq)
----------
doesn't evaluate the argument first.




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From bates@stat.wisc.edu  Wed Aug 20 19:26:20 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 20 Aug 1997 13:26:20 -0500
Subject: R-alpha: The Template Numerical Toolkit and R
Message-ID: <6r3eo4soc3.fsf@franz.stat.wisc.edu>

I have tried linking C++ code using the Template Numerical Toolkit
version 0.8.3 (see http://math.nist.gov/tnt/) with R-0.50-a3 (see
http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html).  I expected this to
be very difficult.  It was very easy.  I was pleasantly surprised.
Nice work by the developers all around.

A bit of background for the R crowd: TNT, being developed by Roldan
Pozo at the National Institute for Standards and Technology, is the
successor to lapack++

As the name indicates, all the representations in TNT are templated.
The advantages of using it with R would be that one could obtain the
execution speed of compiled linear algebra code without the
corresponding hassle of keeping track of all the dimensions associated
with matrix representations in Fortran.  All of us really love to
write those calls that require
 A, LDA, M, N
for each matrix being passed but some of us in the baby boomer
generation are getting on in age and we lose track of the calling
sequence at about the 12th argument :-)

TNT creates all matrices as copies of the original content.  Because
it is written in C++, it gracefully handles the releasing of the
storage when the identifier goes out of scope.

Here is a sample run on a Linux system
$ cat R_link.cc
// An example of linking the Template Numerical Toolkit 0.8.3 with R-0.50 
// 
#include "tnt.h" 
#include "vec.h" 
#include "fmat.h" 
 
extern "C" { 
  static double * 
    copy_contents(double *dest, Fortran_matrix<double> A) 
    { 
      double *dd = dest, *src = &A(1,1); 
      int nn = A.num_rows() * A.num_cols(); 
 
      while (nn--) { *dd++ = *src++; } 
      return dest; 
    } 
 
  void my_mat_sum(double * A, double * B, long int * dims) { 
    Fortran_matrix<double> 
      AA(dims[0], dims[1], A),  // creates a copy 
      BB(dims[0], dims[1], B), 
      CC = AA + BB; 
 
    cout << "A on input: " << AA << endl; 
    cout << "B on input: " << BB << endl; 
    cout << "Sum: " << CC << endl;  
    copy_contents(A, CC); 
  } 
} 
$ g++ -c -fpic R_link.cc 
$ ld -shared -o R_link.so R_link.o -lstdc++ 
$ R 
 
R : Copyright 1997, Robert Gentleman and Ross Ihaka 
Version 0.50 Alpha-3 (August 8, 1997) 
 
R is free software and comes with ABSOLUTELY NO WARRANTY. 
You are welcome to redistribute it under certain conditions. 
Type "license()" for details. 
 
[Previously saved workspace restored] 
 
> A 
           [,1]       [,2]       [,3] 
[1,] -0.2713707 -1.1715863  0.8884861 
[2,] -1.7103328  0.6957497 -0.7603538 
> B 
          [,1]      [,2]       [,3] 
[1,] -1.573575 0.1554325 -1.1013854 
[2,] -1.151815 0.1632211 -0.4710143 
> A+B 
          [,1]       [,2]       [,3] 
[1,] -1.844946 -1.0161538 -0.2128993 
[2,] -2.862148  0.8589708 -1.2313680 
> dyn.load("R_link.so") 
> .C("my_mat_sum", A, B, as.integer(dim(A)))[[1]] 
A on input: 2 3 
-0.271371 -1.17159 0.888486  
-1.71033 0.69575 -0.760354  

B on input: 2 3 
-1.57357 0.155432 -1.10139  
-1.15181 0.163221 -0.471014  
 
Sum: 2 3 
-1.84495 -1.01615 -0.212899  
-2.86215 0.858971 -1.23137  
 
          [,1]       [,2]       [,3] 
[1,] -1.844946 -1.0161538 -0.2128993 
[2,] -2.862148  0.8589708 -1.2313680 
> q() 
Save workspace image? [y/n/c]: n 

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Aug 20 22:31:07 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 Aug 1997 14:31:07 -0700 (PDT)
Subject: R-alpha: names for .RData
In-Reply-To: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970820141956.24129B-100000@chekov>


It would be nice for the save file name .RData to be a variable in
config.site (unless the machine-independent files are coming very soon). 
We are currently running R on a cluster with both sparc-solaris and
intel-linux machines, which don't like each other's .RData files.  At the
moment I edit the source files by hand to change the name to .RData-linux.

On a related topic, has anyone given any more thought to installing
multiple binaries in the same directory tree (as suggested some time ago
by Greg Warnes)?  This could save quite a lot of space as well as making
it easier to keep different operating systems synchronised. 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 21 08:40:08 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 21 Aug 1997 09:40:08 +0200
Subject: R-alpha:  [logical, drop = FALSE] -- my silliness ..
In-Reply-To: <Pine.SUN.3.95.970820101359.641C-100000@chekov> (message from
 Thomas Lumley on Wed, 20 Aug 1997 10:21:25 -0700 (PDT))
Message-ID: <199708210740.JAA03263@sophie.ethz.ch>

I must have been a bit tired or screwed up otherwise:
As Thomas guessed, I've forgotten the extra ","  which is needed for drop=..

ma[logi, , drop = FALSE]	works all right.
        ^^^
	do not forget this !

 MM> Look at this :
 MM> 
 MM> ma <- cbind(1,1:8); logi <- rep(c(T,F),4)
 MM> ma[logi,]
 MM> ##>      [,1] [,2]
 MM> ##> [1,]    1    1
 MM> ##> [2,]    1    3
 MM> ##> [3,]    1    5
 MM> ##> [4,]    1    7
 MM> 
 MM> ##-- now the same with  [ , drop = FALSE]
 MM> 
 MM> ## R (-0.50-a3) :
 MM> 
 MM> 	 ma[logi, drop = F]
 MM> ##>> Error: invalid subscript type
 MM> ## Splus-3.4:
 MM> 	 ma[logi, drop = F]
 MM> ##>> [1] 1 1 1 1 1 3 5 7
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Thu Aug 21 08:44:35 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 21 Aug 1997 09:44:35 +0200 (MET DST)
Subject: R-alpha: thoughts on batch and fortran
Message-ID: <9708210744.AA13701@alpha.luc.ac.be>

Batch:
  For me, batch in its present state is broken and useless. My primary
need for batch is to produce a final output file of a session after I
have worked out a sequence of procedures. I save my instructions in a
file that I can source, then run it in batch to have a copy of input
and output together. (If there was a log file (or dribble), this
problem would be solved.) At present, there are two problems with batch:
(1) I always run R interactively with saving the .RData shut off. This
is not possible in batch. Robert promised that it would be changed in
R0.14 but that never occurred so I am obliged to modify the C code of
each new version of R to avoid the problems of rereading .RData that I
described at that time.
(2) In any case, since 0.49, I cannot use batch because, as soon as
it hits a plot instruction, it stops with an error.

Fortran:
  I think that, if .Fortran is to exist, then the full fortran library
(except I/O) should be available, not just those functions required by
the basic R. I am thinking in particular of the complex functions that
I require for Kalman filtering in carma (soon to be released as a
dynamic library). Having the full f2c library linked in (-lf2c, when it
works under Linux - see the recent comments of my son, Patrick) does
not take more space unless it is actually used because it is dynamic.
carma will not work without these functions so how can I release
something that will not work for most users?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 21 10:44:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 21 Aug 1997 21:44:05 +1200 (NZST)
Subject: R-alpha: thoughts on batch and fortran
Message-ID: <199708210944.VAA22730@stat1.stat.auckland.ac.nz>

	From r-devel-owner@stat.math.ethz.ch Thu Aug 21 19:40 NZS 1997
	From: Jim Lindsey <jlindsey@luc.ac.be>
	Subject: R-alpha: thoughts on batch and fortran
	To: r-devel@stat.math.ethz.ch (r-devel)
	Date: Thu, 21 Aug 1997 09:44:35 +0200 (MET DST)

	Batch:
	  For me, batch in its present state is broken and useless. My primary
	need for batch is to produce a final output file of a session after I
	have worked out a sequence of procedures. I save my instructions in a
	file that I can source, then run it in batch to have a copy of input
	and output together. (If there was a log file (or dribble), this
	problem would be solved.) At present, there are two problems with batch:
	(1) I always run R interactively with saving the .RData shut off. This
	is not possible in batch. Robert promised that it would be changed in
	R0.14 but that never occurred so I am obliged to modify the C code of
	each new version of R to avoid the problems of rereading .RData that I
	described at that time.

The problem is that we had requests both ways - i.e. saving and not
saving.  Sorry, but we can't do it both ways.  But, if you end your
input file with
	q(save=FALSE)
you will get the effect you want.

	(2) In any case, since 0.49, I cannot use batch because, as soon as
	it hits a plot instruction, it stops with an error.

If you are plotting you will need to be running a device driver
of some sort.  In batch we don't automatically run any.
You can put either
	x11()
or
	postscript()
at the top of the file you are running to get a driver started.
Perhaps I will look at creating a "dummy" do-nothing driver which
will be run by default in batch mode.

	Fortran:
	I think that, if .Fortran is to exist, then the full fortran library
	(except I/O) should be available, not just those functions required by
	the basic R. I am thinking in particular of the complex functions that
	I require for Kalman filtering in carma (soon to be released as a
	dynamic library). Having the full f2c library linked in (-lf2c, when it
	works under Linux - see the recent comments of my son, Patrick) does
	not take more space unless it is actually used because it is dynamic.
	carma will not work without these functions so how can I release
	something that will not work for most users?

We've been talking about this a bit - its a general problem.
I will look and see if we can package the f2c library as an R library.
Then we could say
	library("f2c")
	library("carma")
I don't know if this will work - i.e. whether functions in carma.so
will "see" functions in f2c.so.  If I get a second in the next couple of
days I will try the experiment.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Aug 21 11:08:25 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 21 Aug 1997 12:08:25 +0200
Subject: R-alpha: thoughts on batch (stop on error)
In-Reply-To: <199708210944.VAA22730@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Thu, 21 Aug 1997 21:44:05 +1200 (NZST))
Message-ID: <199708211008.MAA03618@sophie.ethz.ch>

Batch:
	Several of us still would like either a command option or 
		[better, but more complicated;
		 this would also be available in non-Batch) an  ]
        an
		options(error.handling = ...)

	option to turn-off the behavior that Batch mode stops on error.

 (It's good that batch stops on error by default,
  however in some cases we'd want to override this default !)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 21 11:19:50 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 21 Aug 1997 22:19:50 +1200 (NZST)
Subject: R-alpha: libf2c as a shared library
Message-ID: <199708211019.WAA22920@stat1.stat.auckland.ac.nz>

Ok, I did the following experiment

	dyn.load("/usr/local/lib/libf2c.so.2.0")
	dyn.load("try.so")
	.Fortran("try", 10.5)

where try.so contains the following compiled subroutine

	subroutine try(x)
        double precision x
        write(*,*) x
        return
        end

It worked just fine (at least here on my FreeBSD machine at home).
So it seems that it will be easy to make all of f2c available,
including the all the IO stuff.

It should be easy to package the libf2c sources as an R library.
I'm hesitant to put it into the core R distribution, because it
adds a lot of source, although this would ensure that it was always
available.

So, should it go in the R core, or to CRAN?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 14:13:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 21 Aug 1997 15:13:02 +0200
Subject: R-alpha: libf2c as a shared library
In-Reply-To: Ross Ihaka's message of Thu, 21 Aug 1997 22:19:50 +1200 (NZST)
References: <199708211019.WAA22920@stat1.stat.auckland.ac.nz>
Message-ID: <x267szvfvl.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> It should be easy to package the libf2c sources as an R library.
> I'm hesitant to put it into the core R distribution, because it
> adds a lot of source, although this would ensure that it was always
> available.
> 
> So, should it go in the R core, or to CRAN?
> 	Ross

CRAN. Linuxites have in their distributions already, for instance.
Nothing good will come from having it twice. Possibly in different
versions... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 14:19:34 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 21 Aug 1997 15:19:34 +0200
Subject: R-alpha: axes & plot boundary
Message-ID: <x24t8jvfkp.fsf@bush.kubism.ku.dk>

I don't rcall seeing this one reported before:

plot(...,axes=F) 

removes not only the axes, but also the plot boundary. The 'bty'
parameter loses its effect completely. getting it back seems to
require fiddling with par("usr") and rect() or lines()

(Linux, Alpha-3)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Thu Aug 21 15:00:28 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 21 Aug 1997 16:00:28 +0200
Subject: R-alpha: libf2c as a shared library
Message-ID: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>

At 15:15 21/08/97, p.dalgaard@kubism.ku.dk wrote:
>Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
>
>> It should be easy to package the libf2c sources as an R library.
>> I'm hesitant to put it into the core R distribution, because it
>> adds a lot of source, although this would ensure that it was always
>> available.
>> 
>> So, should it go in the R core, or to CRAN?
>> 	Ross
>
>CRAN. Linuxites have in their distributions already, for instance.
>Nothing good will come from having it twice. Possibly in different
>versions... 

I agree. The require function is designed to take care of this situation
surely? Indeed, there is already a contributed library (survival) which
depends on another contributed library (splines).

Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Thu Aug 21 16:34:08 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 21 Aug 1997 10:34:08 -0500 (CDT)
Subject: R-alpha: thoughts on batch and fortran
In-Reply-To: <199708210944.VAA22730@stat1.stat.auckland.ac.nz> from "Ross Ihaka" at Aug 21, 97 09:44:05 pm
Message-ID: <9708211534.AA21276@nokomis.stat.umn.edu>

> We've been talking about this a bit - its a general problem.
> I will look and see if we can package the f2c library as an R library.
> Then we could say
> 	library("f2c")
> 	library("carma")
> I don't know if this will work - i.e. whether functions in carma.so
> will "see" functions in f2c.so.  If I get a second in the next couple of
> days I will try the experiment.
> 	Ross

In UNIX you have two choices. You do it this way, or you can establish
the connection to dependent libraries at link time by your systems
variant of

	ld -shared -o carma carma.o -lf2c

when you create your carma shared library and then

	library("carma")

within R. In either case libf2c.so should only be loaded once. On
NT/Win95 I *think* you essentially only have the second choice. I
don't believe a DLL can have any undefined symbols that are resolved
into the running executable or other DLL's ar run time (I'm not
certain about this but is would be easy to check). If I'm right, it
would probably be best to recommend doing things the second way on all
systems just for consistency. I don't know how the Mac shared library
manager works, but I suspect it it more like the way I think NT/Win95
work.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 21 17:10:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 21 Aug 1997 09:10:03 -0700 (PDT)
Subject: R-alpha: thoughts on batch and fortran
In-Reply-To: <9708210744.AA13701@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970821085541.7394A-100000@chekov>

On Thu, 21 Aug 1997, Jim Lindsey wrote:
> Fortran:
>   I think that, if .Fortran is to exist, then the full fortran library
> (except I/O) should be available, not just those functions required by
> the basic R. I am thinking in particular of the complex functions that
> I require for Kalman filtering in carma (soon to be released as a
> dynamic library). Having the full f2c library linked in (-lf2c, when it
> works under Linux - see the recent comments of my son, Patrick) does
> not take more space unless it is actually used because it is dynamic.
> carma will not work without these functions so how can I release
> something that will not work for most users?

I don't think it's as simple as this.  If you can assume all users have
libf2c then your carma Makefile can link it with -lf2c.  This would be
ideal as I think some versions of Unix do still load libraries when the
program loads, whether or not they are actually used.

The real problem comes with machines that don't have f2c.  Most of our
machines here don't, for example, as we tend to use real Fortran when we
want it.  We currently don't assume that everyone has f2c as then we would
not need to distribute C versions of Fortran code. This would have the
added advantage that people who use real Fortran don't have to load
libf2c. 

If we don't assume that everyone has f2c then people distributing
libraries need to distribute all or part of libf2c. Source to libf2c is
readily available. 

I asked for opinions on this question a while back and didn't get any.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 21 18:31:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 21 Aug 1997 13:31:59 -0400
Subject: R-alpha: f2c
Message-ID: <97Aug21.133451edt.26498@mailgate.bank-banque-canada.ca>


> If we don't assume that everyone has f2c then people distributing
> libraries need to distribute all or part of libf2c. Source to libf2c is
> readily available. 

I'm a bit confused about this discussion, but since I don't have f2c on
the computer I've been using the past week, I assume most of the
necessary parts on this library have been distributed with R (but I
can't find them). I have been compiling the C version of my code,
generated with f2c on another machine, and almost everything seems to
be working. I am having trouble with pow_dd, pow_ii and pow_ri.

If there are truely only a few important routines missing then it would
be a lot easier for people distributing libraries to have those pieces
added to the R distribution.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: ECDFs
In-Reply-To: <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
References: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
Message-ID: <199708212102.XAA03945@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 19 Aug 1997, Kurt Hornik wrote:
>> 
>> Here's something what is needed for teaching elementary statistics:
>> Given a sample vector x, compute the corresponding ECDF, plot it, and
>> perhaps evaluate it at points other than the data points.

> The approx() function is supposed to do this (it currently only does
> linear interpolation).  If the right and left continuous step
> functions were added to approx then we could easily use approxfun to
> define the ECDF as a function closure, making it automatically
> available at any point you want. After all, the ECDF *is* a function.

Ah, very nice idea!

So, we'd have

	ecdf(x)

return a FUNCTION of class (e.g.) "step" which would on the one hand
have the right methods for it and on the other hand would allow us to
evaluate it at new points right away?

Martin, Peter?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <Pine.SUN.3.95.970812093005.777B-100000@spock>
References: <199708121323.PAA02620@sophie.ethz.ch>
 <Pine.SUN.3.95.970812093005.777B-100000@spock>
Message-ID: <199708212102.XAA03944@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 12 Aug 1997, Martin Maechler wrote:
>> 
>> As Thomas Lumley has noted before, the behavior in 'batch mode' has changed;
>> namely "Termination upon 'error'".
>> 
>> I think this is THE good default behavior for "batch mode".
>> However
>> 1) for several purposes I'd very much want an option to change this
>> default behavior.
> Hear, hear!

>> 
>> I think it'd be very neat then if
>> options(error.stop = FALSE)
>> actually translated all errors [stop(.)] to warnings [warning()].
>> 

> I'm not convinced.  Being able to make warnings fatal is a good option,
> but being able to continue after errors may make no sense.   How do you
> continue after subscript out of bounds, or argument missing with no
> default, or memory exhausted or ...

> You may well need to jump back to the top level before it makes sense to
> continue.  On the other hand, once at the top level it is certainly
> possible to proceed, and so there should be an option to do it.

There is an obvious trade-off between having a lot of flexibility and
simple too many options :-)

I am not sure about making warnings fatal.  E.g., code for chisquare
tests usually displays a warning if the approximation may be bad.  That
should never be fatal, though ...

Re termination upon error, couldn't there be situations with a huge
simulation loop where one could still do something useful after
e.g. running out of memory?

If I unterstand Martin correctly, the extra options() come into being
only because command-line options are hard to port to point-and-click
interfaces ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: new class for chisquare tests?
Message-ID: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at>

I sort of asked this before, but perhaps not explicitly enough.

In my ctest collection, there are several chisquare-based tests.  For
some of them, it may be useful to also return information on expected
(and observed) counts.  The question is, how should this be done.  Of
course, there is no problem adding the corresponding components to the
list returned by the functions.  However, as these are of class `htest',
the components don't show up in the printed output.

(Of course, one can easily obtain them if they are in the list, but I
think Peter is with me when I say that this is not the right thing in an
intro course.)

* Should we extend print.htest() to display info on expected and
observed counts in case it is there?

* (Should we have an extra argument to control this behavior?)

* Or should there be a class "chisqtest" with a slightly different print
and perhaps also summary method?

* Or ...?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:06 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:06 +0200
Subject: R-alpha: Mutivariate Analysis
In-Reply-To: <199612022355.MAA17838@stat13.stat.auckland.ac.nz>
References: <199612022355.MAA17838@stat13.stat.auckland.ac.nz>
Message-ID: <199708212102.XAA03947@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> I have got a little side-tracked (from graphics) and am putting
> together a little multivariate analysis library.  This is just
> intended to be a "core" library rather than anything exhaustive.
> Mainly it is a matter of putting togther code which already exists at
> StatLib.  Here is my present list (only some of which is finished).

>  1. Principal Components
>     prcomp
	
>  2. Clustering
>     dist, hclust, plclust, subtree, cutree
>     kmeans

>  3. Canonical correlations (is this ever used?)
>     cancor

>  4. Scaling
>     cmdscal, sammon, isoscal

>  5. Graphics
>     (Optimal) profile plots
>     biplots
>     stars etc
>     A bunch of Michael Friendly's stuff converted from SAS

>  6. Discriminant analysis
>     discr (a real one which takes prior probs and returns posterior
>     ones) 

> I would also like to use the object facility so that printing,
> plotting etc is done with generic functions; e.g. plot(prcomp(x))
> should produce a scree plot, coef(prcomp(x)) should deliver the
> loadings - plclust() should also really be plot.hclust().

Yes I know this is a very old mail from Ross ...

I have two questions.

* Is the (already existing) plot.hclust() already a replacement for
plclust()?  (I.e., could we add

	plclust <- function(...) plot.hclust(...)

for compatibility purposes?)

* I'd be very much interested in some of the functions that are not yet
in the current `mva'.  Has there been any work on this one lately?  How
can we help?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:07 +0200
Subject: R-alpha: a question on terminology
Message-ID: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at>

Whereas we typically refer to the add-on `modules' as `libraries' (viz
also the way these are represented in the search list, and the variable
.Libraries), S speaks about `sections'.

Shall we stay with our terminology?  Or instead, speak of `sections',
`packages', `modules', ...?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Aug 21 22:02:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 21 Aug 1997 23:02:07 +0200
Subject: R-alpha: another ctest question
Message-ID: <199708212102.XAA03949@aragorn.ci.tuwien.ac.at>

I have the following problem.  Consider a `classical' test which works
for k .ge. 2 samples.  Possible interfaces are e.g.

	xxx.test(x, g)	    x ... all data, g ... corresponding groups
	xxx.test(x1, ..., xk)
	xxx.test(list(x1, ..., xk))

etc etc.

Clearly, the first and the second one are nice, but cannot be combined
without making `g' (i.e., `group') a named argument.

Hence, in e.g. my current version of kruskal.test() I've combined the
first (by compatibility with S-PLUS) and third interfaces.  Perhaps this
is not optimal, though ...

What I'd like to do now is to extend var.test() as follows.

* With one data arg, perform a chisq-based test for a certain value of
the variance, as specified by an optional var argument
* With two data args, do the usual F test
* With more than two data args, perform some test for the homogeneity of
variances, as specified by an optional method (default "Bartlett") arg.

What is the right interface then?  Should we have

  var.test(x, y = NULL, ..., group = NULL, alternative = "two.sided",
	   conf.level = 0.95, var = 1, ratio = 1, method = "Bartlett")

???

If so, should the interface to kruskal.test be changed accordingly?

Please advise me here.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 23:13:15 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 00:13:15 +0200
Subject: R-alpha: new class for chisquare tests?
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:06 +0200
References: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at>
Message-ID: <x2203nfamc.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> I sort of asked this before, but perhaps not explicitly enough.
> 
> In my ctest collection, there are several chisquare-based tests.  For
> some of them, it may be useful to also return information on expected
> (and observed) counts.  The question is, how should this be done.  Of
> course, there is no problem adding the corresponding components to the
> list returned by the functions.  However, as these are of class `htest',
> the components don't show up in the printed output.
> 
> (Of course, one can easily obtain them if they are in the list, but I
> think Peter is with me when I say that this is not the right thing in an
> intro course.)
> 
> * Should we extend print.htest() to display info on expected and
> observed counts in case it is there?
> 
> * (Should we have an extra argument to control this behavior?)
> 
> * Or should there be a class "chisqtest" with a slightly different print
> and perhaps also summary method?
> 
> * Or ...?

Couldn't the basic logic of print.lm/summary.lm/anova.lm be applied
here too? I.e.

h<-chisquare.test(blipblop)
observed(h)
fitted(h)
partials(h)

This might be implemented simply by adding items to the return list,
and have fitted.htest() extract the relevant item if it is there.

Or maybe slightly safer from a name-space point of view: add *one*
extra item ("comp", say) which is a list containing the other stuff.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Aug 21 23:48:30 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 00:48:30 +0200
Subject: R-alpha: ECDFs
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:06 +0200
References: <199708191851.UAA02770@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970819115251.28406C-100000@chekov>
 <199708212102.XAA03945@aragorn.ci.tuwien.ac.at>
Message-ID: <x2zpqbduf5.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> >>>>> Thomas Lumley writes:
> 
> > On Tue, 19 Aug 1997, Kurt Hornik wrote:
> >> 
> >> Here's something what is needed for teaching elementary statistics:
> >> Given a sample vector x, compute the corresponding ECDF, plot it, and
> >> perhaps evaluate it at points other than the data points.
> 
> > The approx() function is supposed to do this (it currently only does
> > linear interpolation).  If the right and left continuous step
> > functions were added to approx then we could easily use approxfun to
> > define the ECDF as a function closure, making it automatically
> > available at any point you want. After all, the ECDF *is* a function.
> 
> Ah, very nice idea!
> 
> So, we'd have
> 
> 	ecdf(x)
> 
> return a FUNCTION of class (e.g.) "step" which would on the one hand
> have the right methods for it and on the other hand would allow us to
> evaluate it at new points right away?
> 
> Martin, Peter?
> 

Neat idea. And - hey! - someone has made it possible to assign classes
to a function now. I looked into that a while ago with a view to kill
off the antipedagogical habit that R and S has of dumping screenfulls
of gibberish on the unsuspecting newbie. At that time, it wasn't
possible so I dropped it, meaning to take it up on the list later on.

That would be like

print.function<-function(f)cat("Use 'show' to see content of function\n")
show<-unclass

Hmm. Do we want something like this? It clashes a little with other
uses of function classes, but not badly as far as I can see.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 00:11:18 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 01:11:18 +0200
Subject: R-alpha: another ctest question
In-Reply-To: Kurt Hornik's message of Thu, 21 Aug 1997 23:02:07 +0200
References: <199708212102.XAA03949@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb5vdtd5.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> 
> I have the following problem.  Consider a `classical' test which works
> for k .ge. 2 samples.  Possible interfaces are e.g.
> 
> 	xxx.test(x, g)	    x ... all data, g ... corresponding groups
> 	xxx.test(x1, ..., xk)
> 	xxx.test(list(x1, ..., xk))
> 
> etc etc.
> 
> Clearly, the first and the second one are nice, but cannot be combined
> without making `g' (i.e., `group') a named argument.

I'm sort of beginning to like the list(...) construction. It might
also allow one to assign meaningful tags to the variables (as in
kruskal.test(list(bp.males=dataframe$bp[dataframe$sex==1],bp.females=....)

>   var.test(x, y = NULL, ..., group = NULL, alternative = "two.sided",
> 	   conf.level = 0.95, var = 1, ratio = 1, method = "Bartlett")
> 
> ???
> 
> If so, should the interface to kruskal.test be changed accordingly?
> 
> Please advise me here.
> 

You won't gain much above (pardon the sketchy code)

var.test(x,g = NULL,..etc..)
if (is.list(x))
	g<-...
	x<-c(x)

if( g == NULL) ng<-1 else ng<-length(unique(g[nonmiss])) 
if (ng == 1)
	..
else if (ng == 2)
	..
else
	..

I'd say that the real issue is whether t.test should be supplied with
a group= parameter?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 02:27:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 13:27:59 +1200 (NZST)
Subject: R-alpha: axes & plot boundary
In-Reply-To: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
References: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
Message-ID: <199708220127.NAA28846@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > I don't rcall seeing this one reported before:
 > 
 > plot(...,axes=F) 
 > 
 > removes not only the axes, but also the plot boundary. The 'bty'
 > parameter loses its effect completely. getting it back seems to
 > require fiddling with par("usr") and rect() or lines()

This S compatible.  You can get the box after by saying
	box()
Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 07:40:25 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 08:40:25 +0200
Subject: R-alpha: options [--no-*-file] AND --dont-stop-on-error-if-batch
In-Reply-To: <199708212102.XAA03944@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:06 +0200)
Message-ID: <199708220640.IAA20151@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Thomas Lumley writes:
    >> On Tue, 12 Aug 1997, Martin Maechler wrote:
    MM>  As Thomas Lumley has noted before, the behavior in 'batch mode'
    MM> has changed; namely "Termination upon 'error'".
    MM> 
    MM> I think this is THE good default behavior for "batch mode".
    MM> However 1) for several purposes I'd very much want an option to
    MM> change this default behavior.
    >> Hear, hear!

    MM>  I think it'd be very neat then if options(error.stop = FALSE)
    MM> actually translated all errors [stop(.)] to warnings [warning()].
    MM> 

    >> I'm not convinced.  Being able to make warnings fatal is a good
    >> option, but being able to continue after errors may make no sense.
    >> How do you continue after subscript out of bounds, or argument
    >> missing with no default, or memory exhausted or ...

    >> You may well need to jump back to the top level before it makes
    >> sense to continue.  On the other hand, once at the top level it is
    >> certainly possible to proceed, and so there should be an option to
    >> do it.

    Kurt> There is an obvious trade-off between having a lot of flexibility
    Kurt> and simple too many options :-)

I don't quite see (the ":-)").
The non-expert user just changes options like 'digits' and 'width'
and leaves the others alone.

    Kurt> I am not sure about making warnings fatal.  E.g., code for
    Kurt> chisquare tests usually displays a warning if the approximation
    Kurt> may be bad.  That should never be fatal, though ...
The option exists in S.
It can be very useful for debugging purposes (and that't about it):
If you call a top level function  / a for loop which in certain
circumstances produces warnings that look funny to you, and somehow it's
hard to detect when / why the warnings are produced.

Now you (temporarily) make warnings fatal, and also add something like
options(error = 'dump.frames')  or an "on.exit(browser())".
You will now be able to quickly find and debug the circumstances under
which the warnings were produced.....


    Kurt> Re termination upon error, couldn't there be situations with a
    Kurt> huge simulation loop where one could still do something useful
    Kurt> after e.g. running out of memory?
sure.
As I (and others) said, there are other situations where you just want to
run a source.R file through R and you don't care if somewhere an
unimportant variable is not defined, a graphics device is not open,....

    Kurt> If I unterstand Martin correctly, the extra options() come into
    Kurt> being only because command-line options are hard to port to
    Kurt> point-and-click interfaces ...

This would be the main reason.

I think it's just 'neater' to have many things as part of R core,
instead of part of the OS-interface [to where command line options belong].

On the other hand, currently I (still) can't imagine myself moving off an
Unix based OS. Therefore, I'd be happy with a command line option which
turns off 'stop on error' in batch mode.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 07:59:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 08:59:34 +0200
Subject: R-alpha: class for chisquare tests; Thoughts on print & summary
In-Reply-To: <199708212102.XAA03943@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:06 +0200)
Message-ID: <199708220659.IAA20154@sophie.ethz.ch>

Kurt,
I think we hopefully are coming to an agreement that

	1)  your ctest collection should make its way into 'R core'
		((and you are the one who can make it happen now ..))
	2)  it should remain S-plus downward compatible as much as
	    reasonably possible.

My conclusions:
	a. keep class 'htest'
	b. extend  print.htest  (AND  summary.htest !)
	   to make it possible to display your extra info.
        b2. Yes, add extra arguments to print.htest / summary.htest to
	   control this behavior.
	 [this is also done for the correlation matrix
	  in print.summary.lm in S (not yet in R ..)]

alternatively, you would make a new class  'chisqtest' but give your test
results BOTH classes  
	class(res) <- c("chisqtest","htest")
Such that you can use 'htest' methods in general, and just one
	print.chisqtest
in particular.



General note on  'print' (and 'summary') methods:
~~~~~~~~~~~~      =====     
1) I think we should keep to the S convention that EVERY print method
   semantically acts as

    print.foo <- function(x,.........) {

	    .........

	    invisible(x)
    }

	[[a few days ago, I've patched print.lm (?I think) in order to do this]]

2) For summary, there are two approaches 
   
	A. Just print summary information  AND  return something useful.

	B. Don't print anything in summary.foo but return an object of 
	   CLASS  'summary.foo'
	   
	   AND write a method  print.summary.foo  
	   which nicely prints the  summary.foo information and
		[see remark '1)' on "print"] invisibly returns its object.

   Approach 'B' is THE way to go useful for "big" things like 'lm'.
   IMHO it should be used in general as soon as quite a bit of "computing"
   is involved ("computing" is NOT computer intensive; just things that are
   tedious to re-type).
	
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 09:21:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 20:21:14 +1200 (NZST)
Subject: R-alpha: class for chisquare tests; Thoughts on print & summary
Message-ID: <199708220821.UAA23531@stat1.stat.auckland.ac.nz>

	From: Martin Maechler <maechler@stat.math.ethz.ch>
	To: Kurt.Hornik@ci.tuwien.ac.at
	CC: R-devel@stat.math.ethz.ch
	Subject: Re: R-alpha: class for chisquare tests; Thoughts on print & summary

	Kurt,
	I think we hopefully are coming to an agreement that

		1)  your ctest collection should make its way into 'R core'
			((and you are the one who can make it happen now ..))

By all means - throw the present versions away and add yours.
We may have to move to an inner and outer core if the core grows too
big.

		2)  it should remain S-plus downward compatible as much as
		    reasonably possible.

For functions which are not going to be building blocks such compatibility
is less important.  Better to do it "right".

	        b2. Yes, add extra arguments to print.htest / summary.htest to
		   control this behavior.
		 [this is also done for the correlation matrix
		  in print.summary.lm in S (not yet in R ..)]

[ Actually I think that we just have a different default value for the
corr= argument.  If you'd like this changed just say.  I just don't
find the correlations that informative. ]

I'm reviewing the "lm" methods at present because thats what I'm
teaching at present.  I have an "lm.predict" about ready to roll,
but am a bit hung up on trying to propagate case names through
"model.frame", which in turn is inducing an sidetrack into
[<- etc etc ...

	alternatively, you would make a new class  'chisqtest' but give
	your test results BOTH classes  
		class(res) <- c("chisqtest","htest")
	Such that you can use 'htest' methods in general, and just one
		print.chisqtest
	in particular.

I'd probably try to avoid making a separate class for every kind of
test result and try to build methods for the general case.  This would
make implementing new tests easier as well as imposing the same
general structure on the output.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 09:24:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 10:24:56 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:07 +0200)
Message-ID: <199708220824.KAA26083@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
    Kurt> also the way these are represented in the search list, and the variable
    Kurt> .Libraries), S speaks about `sections'.
[.Libraries are not used anymore and will be gone in the next version.
 library

    Kurt> Shall we stay with our terminology?
I think so.
Or use something which S does not use at all,
since 'require(.);  provide(.)' and  Thomas Lumley's  
autoload(..) features enable an entirely different approach.

    Kurt>  Or instead, speak of `sections',
    Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
    Kurt> `packages', `modules', ...?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 09:39:32 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 10:39:32 +0200
Subject: R-alpha: axes & plot boundary
In-Reply-To: Ross Ihaka's message of Fri, 22 Aug 1997 13:27:59 +1200 (NZST)
References: <x24t8jvfkp.fsf@bush.kubism.ku.dk>
 <199708220127.NAA28846@stat1.stat.auckland.ac.nz>
Message-ID: <x2bu2qvcfv.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Peter Dalgaard BSA writes:
>  > I don't rcall seeing this one reported before:
>  > 
>  > plot(...,axes=F) 
>  > 
>  > removes not only the axes, but also the plot boundary. The 'bty'
>  > parameter loses its effect completely. getting it back seems to
>  > require fiddling with par("usr") and rect() or lines()
> 
> This S compatible.  You can get the box after by saying
> 	box()

By golly! So it is. Sorry. That is the trouble with working from home
and not having Splus around...

Actually, I did look for something that did what box() does, but
couldn't find it off-hand. It isn't really obvious where to look.

When we get around to finishing the plot() man page, let's try to
remember to add a short note on axes=F. Something like

"
axes=F removes the axes and the plot boundary. Use 'axis'
and 'box' to add them later.
"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Aug 22 09:34:26 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 22 Aug 1997 20:34:26 +1200 (NZST)
Subject: R-alpha: a question on terminology
Message-ID: <199708220834.UAA23628@stat1.stat.auckland.ac.nz>

I like "packages".  Modules have namespace implications which the
present setup does not provide.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 10:17:34 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 11:17:34 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 21 Aug 1997 23:02:07 +0200)
Message-ID: <199708220917.LAA26226@sophie.ethz.ch>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
    Kurt> also the way these are represented in the search list, and the variable
    Kurt> .Libraries), S speaks about `sections'.
[.Libraries are not used anymore ...
 search() & .Provided should be enough, ...]

    Kurt> Shall we stay with our terminology?
I think so.

    Kurt>  Or instead, speak of `sections',
    Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
    Kurt> `packages', `modules', ...?

Or use something which S does not use at all,
since 'require(.);  provide(.)' and  Thomas Lumley's  
autoload(..) features enable an entirely different approach.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 10:52:21 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 11:52:21 +0200
Subject: R-alpha: names for .RData
In-Reply-To: <Pine.SUN.3.95.970820141956.24129B-100000@chekov>
References: <199708080306.PAA27540@stat1.stat.auckland.ac.nz>
 <Pine.SUN.3.95.970820141956.24129B-100000@chekov>
Message-ID: <199708220952.LAA04284@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> It would be nice for the save file name .RData to be a variable in
> config.site (unless the machine-independent files are coming very
> soon).  We are currently running R on a cluster with both
> sparc-solaris and intel-linux machines, which don't like each other's
> .RData files.  At the moment I edit the source files by hand to change
> the name to .RData-linux.

I thought by switching to the new format (XDR?) this would no longer be
a problem?

> On a related topic, has anyone given any more thought to installing
> multiple binaries in the same directory tree (as suggested some time ago
> by Greg Warnes)?  This could save quite a lot of space as well as making
> it easier to keep different operating systems synchronised. 

There was some discussion a time ago.  Let me try to summarize it in my
own biased way.

* In general, we have two ways of arranging the `library' tree.  One is,
grouped according to module, the other, according to type.  I.e.,

	library/<module>/
	library/<module>/funs/
	library/<module>/help/
	library/<module>/html/
	library/<module>/rman/
	library/<module>/objs/<platform>

etc or

	library/funs/<module>
	...
	library/objs/<platform>/<module>

Given that we also have architecture-dependent things in the library, I
would suggest to adopt the former strategy (similar to Emacs) and not
the latter as e.g. in the TeX Directory Standard.

* (As an aside, we could also discuss whether we want to have several
versions of R installed simultaneously.  This would imply having

	RHOME/<version_1>/...
	RHOME/<version_2>/...
	...
	RHOME/<site>

with all potential problems of such.)

* Similarly, there should not be any problem with having

	RHOME/bin/R-<platform>

instead of

	RHOME/bin/R.binary

* The first question is, what EXACTLY is `platform'?  E.g., the GNU
Coding Standards would imply the triplet

	MACHINE-VENDOR-OS

whereas e.g. the Debian GNU/Linux standards tell you to use

	MACHINE-OS

(e.g., `i386-linux') ...

* The main question is, how is the right platform determined at runtime?
I've had some discussions here (forgot who with) where I claimed that
this is not possible from the shell alone.  E.g., on my current system
the output of `uname -a' is

	Linux teddy 2.0.27 #2 Sun Dec 22 22:12:46 MET 1996 i586 unknown

and if someone had compiled R on an i386 I'd be nowhere.  The same
applies for shell variables such as OSTYPE and MACHTYPE, which don't
seem to be POSIX anyway.

* Hence, I think the right things to do are

** Either have several scripts in RHOME/bin, and have links to these
from somewhere in PATH (which sounds a bit stupid)

** Have a simple shell wrapper installed in the PATH which calls the
real one passing the PLATFORM information.  If this sounds confusing,
the idea is the following.  Suppose we install in /usr/local (and that
/usr/local/bin is not shared among platforms).  Then RHOME would be

	/usr/local/lib/R

with

	/usr/local/lib/R/bin/R			# shell script
	/usr/local/lib/R/bin/R-<platform>	# binaries ...

and

	/usr/local/bin/R

would contain

	exec /usr/local/lib/R/bin/R -p PLATFORM $*

and `PLATFORM' is what was determined at compile time.

* I think this is the cleanest solution, and should not be too hard to
implement:

STEP 1.

** Introduce the -p argument (or whatever else) to the script.  Maybe do
something nice such as providing a `default' platform in the script,
such that those with a single-platform setup don't see any difference.

** Rename `R.binary' accordingly.

** Introduce a platform layer in `lib' (and perhaps rename it to `objs'
right away, PLEASE).

** Modify library.dynam() accordingly. (Not a problem, as we have the
`arch' and `os' elements of version() anyway.)

STEP 2.

The above does not create a platform wrapper (where should it put it?),
but single-platform sites won't know a difference (shell script has a
default), and multi-platform people can either have private aliases or
set up wrappers at the sysadmin level.

Eventually, there should be something like a real `make install' with
the installation tree different from the source/build tree.  Then, we
can generate a wrapper at compile time and install it to $(bindir) (the
runtime system will go into $(libdir), and the man page into $(mandir)).

****

That's all, folks.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 10:52:21 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 11:52:21 +0200
Subject: R-alpha: libf2c as a shared library
In-Reply-To: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>
References: <3.0.1.16.19970821160028.29a77162@droopy.iarc.fr>
Message-ID: <199708220952.LAA04280@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> At 15:15 21/08/97, p.dalgaard@kubism.ku.dk wrote:
>> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
>> 
>>> It should be easy to package the libf2c sources as an R library.
>>> I'm hesitant to put it into the core R distribution, because it
>>> adds a lot of source, although this would ensure that it was always
>>> available.
>>> 
>>> So, should it go in the R core, or to CRAN?
>>> Ross
>> 
>> CRAN. Linuxites have in their distributions already, for instance.
>> Nothing good will come from having it twice. Possibly in different
>> versions... 

> I agree. The require function is designed to take care of this situation
> surely? Indeed, there is already a contributed library (survival) which
> depends on another contributed library (splines).

Hmm ... not so fast ...

Does this also affect the parts of f2c that are already come with R?
I.e., if compiled without a Fortran compiler and a shared libf2c is
found, would R be linked dynamically against that and a corresponding
statement added to the site-wide init file?

-k


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 11:37:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 12:37:36 +0200
Subject: R-alpha: apply()
Message-ID: <199708221037.MAA04898@aragorn.ci.tuwien.ac.at>

The following is identical in R and S, but still strange ...

R> apply(matrix(1:20, nc = 4), 1, table)
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    1    1    1    1
[2,]    1    1    1    1    1
[3,]    1    1    1    1    1
[4,]    1    1    1    1    1
R> apply(matrix(rep(1, 20), nc = 4), 1, table)
[1] 4 4 4 4 4
R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
[[1]]
1 3 7 
2 1 1 

[[2]]
2 4 6 8 
1 1 1 1

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Fri Aug 22 13:02:31 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 22 Aug 1997 14:02:31 +0200 (MET DST)
Subject: R-alpha: eigen
Message-ID: <9708221202.AA06994@alpha.luc.ac.be>

eigen(matrix(rep(1,9),ncol=3),only.values=T)

works repeatedly but eventually (after 3 or 4 goes) gave a core dump
of 11mb (I think only the first answer was right).

if I type
gc()
immediately after the first call, I get a core dump right away (this
might possibly be related to my huge core dumps with nlm)

eigen(matrix(rep(1,9),ncol=3))
core dumps immediately after the first call

Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 13:05:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 14:05:56 +0200
Subject: R-alpha: eigen
In-Reply-To: <9708221202.AA06994@alpha.luc.ac.be> (message from Jim Lindsey on
 Fri, 22 Aug 1997 14:02:31 +0200 (MET DST))
Message-ID: <199708221205.OAA26421@sophie.ethz.ch>

I cannot produce any core dump with these statements here ...

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> eigen(matrix(rep(1,9),ncol=3),only.values=T)

    Jim> works repeatedly but eventually (after 3 or 4 goes) gave a core dump
    Jim> of 11mb (I think only the first answer was right).

    Jim> if I type
    Jim> gc()
    Jim> immediately after the first call, I get a core dump right away (this
    Jim> might possibly be related to my huge core dumps with nlm)

    Jim> eigen(matrix(rep(1,9),ncol=3))
    Jim> core dumps immediately after the first call
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 22 13:16:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 22 Aug 1997 14:16:51 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: <199708181405.QAA00632@sophie.ethz.ch> (message from Martin
 Maechler on Mon, 18 Aug 1997 16:05:18 +0200)
Message-ID: <199708221216.OAA26424@sophie.ethz.ch>

This is propagated to  R-devel in case anyone else has a comment on this :

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

  MM> On Aug. 14,
  MM> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

  Ross> Re the emacs stuff:

  MM> ...

  Ross> 2. Peter Dalgaard made the suggestion that we made R source names
  Ross> end in ".R" in the source tree.  This seems like a good idea.  We
  Ross> might also consider making manual files end in .man so that it
  Ross> obvious what they are.

  MM> Kurt and me also would like to agree on a file extension for  
  MM> 'R man' files.

  MM> Either	.man  [PROBLEM: this extension is used in Unix
  MM> 			already for [t/n]roff style manual pages.
  MM> 			Emacs therefore switches to nroff mode for this
  MM> 			extension. That's why I wouldn't like it all.]

  MM> or	.Rd   [in S there are '.d' help files with roff-like syntax]
  MM> or	.Rman

Current status (between Kurt & me):
	
Kurt proposes
	.Rd
	.Rdoc
	.Rman     (in DEcreasing order of preference)

My own order of preference would be

	.Rman .Rd .Rdoc

which would result in '.Rd' as a fair compromise.
		       ===

Any other opinions / votes ?

-- MM
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Aug 22 13:39:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 22 Aug 1997 14:39:52 +0200
Subject: R-alpha: a question on terminology
In-Reply-To: <199708220917.LAA26226@sophie.ethz.ch>
References: <199708212102.XAA03948@aragorn.ci.tuwien.ac.at>
 <199708220917.LAA26226@sophie.ethz.ch>
Message-ID: <199708221239.OAA05132@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

Kurt> Whereas we typically refer to the add-on `modules' as `libraries' (viz
Kurt> also the way these are represented in the search list, and the variable
Kurt> .Libraries), S speaks about `sections'.

> [.Libraries are not used anymore ...
>  search() & .Provided should be enough, ...]

Kurt> Shall we stay with our terminology?

> I think so.

Kurt> Or instead, speak of `sections',
Kurt> Shall we stay with our terminology?  Or instead, speak of `sections',
Kurt> `packages', `modules', ...?

> Or use something which S does not use at all,
> since 'require(.);  provide(.)' and  Thomas Lumley's  
> autoload(..) features enable an entirely different approach.

Thanks to Martin and Ross for the immediate response.

Ross wrote,

> I like "packages".  Modules have namespace implications which the
> present setup does not provide.

I guess we have a decision then, and will refer to an `add-on' as a

	>>> PACKAGE <<<

E.g., the PACKAGE `mva', ...

(And hope than when R conquers the world there will be real modules.)

To make things consistent, could we PLEASE make the corresponding
changes so that search() shows

	"package:base"

rather than "library:base"?

Locations I found were

src/main/envir.c:
	STRING(ans)[n-1] = mkChar("library:base");

src/main/main.c:
	suicide("unable to open the base library\n");

and in src/library/base/funs/library

I will meanwhile change things in the FAQ accordingly.

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Fri Aug 22 15:30:32 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 22 Aug 1997 10:30:32 -0400
Subject: R-alpha: RHOME
Message-ID: <97Aug22.103211edt.26506@mailgate.bank-banque-canada.ca>

> * In general, we have two ways of arranging the `library' tree.  One is,
> grouped according to module, the other, according to type.  I.e.,

> 	library/<module>/
> 	library/<module>/funs/
> 	library/<module>/help/

I find this a much better way to organize things. Old versions of
packages can be removed cleanly with

rm -r library/<package>

It also means that the userid for the maintainer of a package does not
necessarily need to be the userid of R.

> * (As an aside, we could also discuss whether we want to have several
> versions of R installed simultaneously.  This would imply having

> 	RHOME/<version_1>/...
> 	RHOME/<version_2>/...
>  ...
> * The main question is, how is the right platform determined at runtime?
>  ...

There seems to be an assumption here that RHOME will be the same no
matter what machine you are running on. I would set RHOME depending on
the machine, eg.

RHOME=/usr/local/lib/R-Sun4
RHOME=/usr/local/lib/R-Sun5
RHOME=/usr/local/lib/R-Linux386

and then use links to the XDR files and other files which are not
machine dependent, so they do not have to be duplicated.

Determining the platform universally may be fairly difficult, but at a
given site there is usually a fairly small mix of machines and it is
possible to write a shell script to determine the machine. In fact,
this is a pretty common problem and you are probably already doing it
in your .login or .chrc.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Fri Aug 22 17:20:43 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 22 Aug 1997 18:20:43 +0200
Subject: R-alpha: apply()
Message-ID: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>

At 12:42 22/08/97, kurt.hornik@ci.tuwien.ac.at wrote:

>The following is identical in R and S, but still strange ...
>
>R> apply(matrix(1:20, nc = 4), 1, table)
>     [,1] [,2] [,3] [,4] [,5]
>[1,]    1    1    1    1    1
>[2,]    1    1    1    1    1
>[3,]    1    1    1    1    1
>[4,]    1    1    1    1    1
>R> apply(matrix(rep(1, 20), nc = 4), 1, table)
>[1] 4 4 4 4 4
>R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
>[[1]]
>1 3 7 
>2 1 1 
>
>[[2]]
>2 4 6 8 
>1 1 1 1
>
>-k

It is strange, but logical.  The problem is that it's an undocumented
feature. If the help page said something like "If the calls to FUN
return vectors of different lengths then apply returns a list of
length dim(x)[MARGIN]" then it would be less surprising. Or would you
prefer that apply returns an error message if it can't coerce the
result to an array?

Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Fri Aug 22 17:30:08 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:30:08 -0700 (PDT)
Subject: R-alpha: apply()
In-Reply-To: <199708221037.MAA04898@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970822092037.10703A-100000@chekov>

On Fri, 22 Aug 1997, Kurt Hornik wrote:

> The following is identical in R and S, but still strange ...
> 
> R> apply(matrix(1:20, nc = 4), 1, table)
>      [,1] [,2] [,3] [,4] [,5]
> [1,]    1    1    1    1    1
> [2,]    1    1    1    1    1
> [3,]    1    1    1    1    1
> [4,]    1    1    1    1    1
> R> apply(matrix(rep(1, 20), nc = 4), 1, table)
> [1] 4 4 4 4 4

Yes it is.  This is the sort of thing I meant when I complained about
drop=F being the default.  

The third example should be documented in the man page, which only
describes what happens "If each call to FUN returns a vector of length n" 
In fact the Blue Book help pages and the current S-PLUS help also
ignore this possibility.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Aug 22 17:33:18 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:33:18 -0700 (PDT)
Subject: R-alpha: eigen
In-Reply-To: <9708221202.AA06994@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970822093036.10703B-100000@chekov>

On Fri, 22 Aug 1997, Jim Lindsey wrote:

> eigen(matrix(rep(1,9),ncol=3),only.values=T)
> 
> works repeatedly but eventually (after 3 or 4 goes) gave a core dump
> of 11mb (I think only the first answer was right).
> 

The bug in foreign function calling pointed out by Martin in a different
context does this, if you haven't fixed it (it's more recent than 50a3).
In naoktrim in dotcode.c, which begins 
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 0;
                *len = 0;
        }
   
change *dup = 0 to *dup = 1.



Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Aug 22 17:45:44 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 Aug 1997 09:45:44 -0700 (PDT)
Subject: R-alpha: terms
In-Reply-To: <x2zpqbduf5.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970822094149.10703D-100000@chekov>


Another minor incompatibility
R>attr(terms(y~x),"response")
[1] TRUE
S> attr(terms(y~x),"response")
[1] 1

In S the attribute indicates which column of the model frame will contain
the response. In R this always column 1 because model frames are only
useful when their columns are in the right order (model.matrix doesn't
check).


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Aug 22 22:20:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Aug 1997 23:20:43 +0200
Subject: R-alpha: apply()
In-Reply-To: Thomas Lumley's message of Fri, 22 Aug 1997 09:30:08 -0700 (PDT)
References: <Pine.SUN.3.95.970822092037.10703A-100000@chekov>
Message-ID: <x2203l52z8.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> On Fri, 22 Aug 1997, Kurt Hornik wrote:
> 
> > The following is identical in R and S, but still strange ...
> > 
> > R> apply(matrix(1:20, nc = 4), 1, table)
> >      [,1] [,2] [,3] [,4] [,5]
> > [1,]    1    1    1    1    1
> > [2,]    1    1    1    1    1
> > [3,]    1    1    1    1    1
> > [4,]    1    1    1    1    1
> > R> apply(matrix(rep(1, 20), nc = 4), 1, table)
> > [1] 4 4 4 4 4
> 
> Yes it is.  This is the sort of thing I meant when I complained about
> drop=F being the default.  
> 
> The third example should be documented in the man page, which only
> describes what happens "If each call to FUN returns a vector of length n" 
> In fact the Blue Book help pages and the current S-PLUS help also
> ignore this possibility.
> 

The weirdest thing is actually the first case, where tables of the
same length *but different dimnames* are getting pasted together into
a matrix with no dimnames... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Sat Aug 23 05:10:10 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Sat, 23 Aug 1997 16:10:10 +1200 (NZST)
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
Message-ID: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>

Whatever extensions are decided on for any of the R stuff it is important
to realize that Windows (3.11) only lets you have one dot (.) and then
only 3 characters. The base name should be only 8 characters long as well.
Since I'm worrying about it a little these days I just want to put my 2 cents
worth in on this topic.

It is looking like a real pain to translate the current set of html files to
this format which means that there is going to be some real work required in
getting a 3.11 version going.

On a related note I really have started on the RSept and have postscript
functioning (once again big changes will be needed to get it to fly under
3.11 so it'll be a Win95 version first).

Getting dll's going is the next trick I'm going to try.

robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sat Aug 23 11:59:39 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Aug 1997 12:59:39 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: Robert Gentleman's message of Sat, 23 Aug 1997 16:10:10 +1200 (NZST)
References: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>
Message-ID: <x2203lp3kz.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> 
> Whatever extensions are decided on for any of the R stuff it is important
> to realize that Windows (3.11) only lets you have one dot (.) and then
> only 3 characters. The base name should be only 8 characters long as well.
> Since I'm worrying about it a little these days I just want to put my 2 cents
> worth in on this topic.
> 
> It is looking like a real pain to translate the current set of html files to
> this format which means that there is going to be some real work required in
> getting a 3.11 version going.

Is it possible that the HTML->RTF->WinHelp generation pointer I sent
you would work faster? Point being that you could generate the RTF
file on a machine with long filenames yielding a file with *internal"
links, no restrictions on names, and in turn a .HLP file - which we
want to have anyway.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Aug 23 20:07:04 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 23 Aug 1997 12:07:04 -0700 (PDT)
Subject: R-alpha: plots and batch mode
In-Reply-To: <x2zpqbduf5.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.LNX.3.96.970823120250.1852A-100000@buffy>


You can always define a dummy graphics driver for batch mode by

dummy.driver<-function() postscript(file="/dev/null")

which will actually do all the calculations needed (and so catch errors)
but won't produce anything.  Then you can edit the Rprofile so that
dummy.driver() is started if you aren't running interactively.  

I don't know if something similar can be done for Mac/Win.

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:28:09 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:28:09 +0200
Subject: R-alpha: barplot()
Message-ID: <199708250628.IAA13999@aragorn.ci.tuwien.ac.at>

I've created a hacked version of barplot() which is more compatible with
the S version, but currently ONLY FOR VECTORS.

Differences && new features:

* The `space' argument is interpreted as the fraction of the average bar
width.  (The current version has the width of the bar plus the space in
between constrained to sum to 1.)

* There is a new argument `width'.

* There is a new argument `horiz' for producing horizontal barplots.

Please have a look.  If the changes are ok'ed, I will also change the
matrix case accordingly.

I have a remark and a question.

* The printing of labels at the vertical axis seems to be different in R
and S when using axis(), the labels come out horizontal in S and
vertical in R.  Compare
	x <- 1:5
	plot(x, axes = F)
	axis(2, at = x, labels = LETTERS[x])

* I feel a bit stupid repeating most code for the horiz T and F cases.
Is there a smarter way to `swap' x and y when plotting?

-k

*************************************************************************
"barplot" <-
function(height, width = 1, space = 0.2, names.arg, legend.text,
	 beside = FALSE, horiz = FALSE, col = NULL, border = par("fg"),
	 main = NULL, xlab = NULL, ylab = NULL, xlim, ylim, axes = TRUE,
	 ...)
{
  opar <- par(yaxs="i", xpd=TRUE)
  on.exit(par(opar))
  if (is.matrix(height)) {
    if (beside) {
      delta <- 0.5 * (1 - space)
      if (missing(xlim))
	xlim <- c(0, ncol(height)) + 0.5
      if (missing(ylim))
	ylim <- range(-0.01, height)
      plot.new()
      plot.window(xlim, ylim, log = "")
      for (i in 1:ncol(height)) {
	xx <- seq(i-delta, i+delta, length=nrow(height)+1)
	xl <- xx[1:nrow(height)]
	xr <- xx[1:nrow(height)+1]
	rect(xl, 0, xr, height[,i], col=col, xpd=TRUE)
      }
    } else { #-- not 'beside' --
      delta <- 0.5 * (1 - space)
      nheight <- rbind(0, apply(height, 2, cumsum))
      if (missing(xlim)) 
	xlim <- c(0, ncol(height)) + 0.5
      if (missing(ylim)) 
	ylim <- range(-0.01, nheight)
      plot.new()
      plot.window(xlim, ylim, log = "")
      for (i in 1:ncol(height))
	rect(i - delta, nheight[-1, i],
	     i + delta, nheight[1:nrow(height), i],
	     col = col, xpd=TRUE)
    }
    if(missing(names.arg))
      names.arg <- dimnames(height)[[2]]
    if(!is.null(names.arg)) {
      if(length(names.arg) != ncol(height))
	stop("incorrect number of names")
      for(i in 1:length(names.arg))
	axis(1, at=1:length(names.arg), labels=names.arg, lty=0)
    }
  }
  else { ##---- height is vector ---------
    space <- space * mean(width)
    width <- rep(width, length = length(height))
    delta <- width / 2
    LRC <- cumsum(space + width)
    MID <- LRC - delta
    LLC <- MID - delta
    if (missing(xlim)) xlim <- c(0, max(LRC))
    if (missing(ylim)) ylim <- range(-0.01, height)
    plot.new()
    if (horiz) {
      plot.window(ylim, xlim, log = "")
      rect(0, LLC, height, LRC, col, xpd = TRUE)
    } else {
      plot.window(xlim, ylim, log = "")      
      rect(LLC, 0, LRC, height, col, xpd = TRUE)
    }
    if (missing(names.arg))
      names.arg <- names(height)
    if (!is.null(names.arg))
      for (i in 1:length(names.arg))
	if (horiz)
	  axis(2, at = MID, labels = names.arg, lty = 0)
	else
	  axis(1, at = MID, labels = names.arg, lty = 0)
  }
  if (!missing(legend.text) && !missing(col)) {
    xy <- par("usr")
    legend(xy[2] - xinch(0.1), xy[4] - yinch(0.1),
	   legend = rev(legend.text), fill = rev(col),
	   xjust = 1, yjust = 1)
  }
  title(main = main, xlab = xlab, ylab = ylab, ...)
  if (axes)
    if (horiz)
      axis(1)
    else
      axis(2)
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:33:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:33:16 +0200
Subject: R-alpha: Re: Extensions .R and .Rd (in base/funs/ and base/man/ )
In-Reply-To: <x2203lp3kz.fsf@bush.kubism.ku.dk>
References: <199708230410.QAA28257@stat1.stat.auckland.ac.nz>
 <x2203lp3kz.fsf@bush.kubism.ku.dk>
Message-ID: <199708250633.IAA14016@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> 
>> Whatever extensions are decided on for any of the R stuff it is important
>> to realize that Windows (3.11) only lets you have one dot (.) and then
>> only 3 characters. The base name should be only 8 characters long as well.
>> Since I'm worrying about it a little these days I just want to put my 2 cents
>> worth in on this topic.
>> 
>> It is looking like a real pain to translate the current set of html files to
>> this format which means that there is going to be some real work required in
>> getting a 3.11 version going.

> Is it possible that the HTML->RTF->WinHelp generation pointer I sent
> you would work faster? Point being that you could generate the RTF
> file on a machine with long filenames yielding a file with *internal"
> links, no restrictions on names, and in turn a .HLP file - which we
> want to have anyway.

That would be nice ... names in RApril.zip such as
	chisquare.test.html
won't work in 3.11 anyway ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:51:44 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:51:44 +0200
Subject: R-alpha: Re:  .Options$digits do not (always) work
Message-ID: <199708250651.IAA14063@aragorn.ci.tuwien.ac.at>

While trying to understand official and private explanations of Robert
and Martin before writing something useful in the FAQ, I did some more
experimenting ...

Please have a look at the following.  According to Martin, this is also
what he observed about 2 weeks ago but did not document exactly enough
when posting.

Note:  the explanation given by Robert was (roughly speaking) that the
result of options()$digits is used for printing, and NOT the value of
.Options$digits.

Here it comes.

***********************************************************************
R> .Options$digits
[1] 7

R> tst2 <- function(x=pi, dig =3) {
+   oo <- options(digits=dig); on.exit(options(oo)); print(x);x}
R> tst2()
[1] 3.14
[1] 3.141593
R> tst2(dig = 12)
[1] 3.14159265359
[1] 3.141593
***********************************************************************

Up to here, everything is fine and rational.  But now:

***********************************************************************
R> .Options$digits <- 5

R> tst2()
[1] 3.1416
[1] 3.1416
R> tst2(dig = 12)
[1] 3.1416
[1] 3.1416
***********************************************************************

Oops, the internal value of options()$digits is ignored .... Really?
Let's test:

***********************************************************************
R> tst3 <- function(x=pi, dig =3) {
+ oo <- options(digits=dig); on.exit(options(oo));
+ print(c(.Options$digits, options()$digits)); print(x); x }
R> tst3()
[1] 5 3
[1] 3.1416
[1] 3.1416
R> tst3(dig = 12)
[1]  5 12
[1] 3.1416
[1] 3.1416

R> tst4 <- function(x=pi, dig =3) {
+ .Options$digits <- dig;
+ print(c(.Options$digits, options()$digits)); print(x); x }
R> tst4()
[1] 3 7
[1] 3.1416
[1] 3.1416
***********************************************************************

SUMMARY:  If we assign explicitly to .Options$digits in .GlobalEnv,
there is NO WAY we can change the print behavior inside functions after
that, neither by assigning to .Options$digits nor by using
options(digits = ...).

Surely, this cannot be a feature!

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 07:59:40 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 08:59:40 +0200
Subject: R-alpha: R documentation boilerplates
Message-ID: <199708250659.IAA14098@aragorn.ci.tuwien.ac.at>

Just a minor remark.  Perhaps it would be useful to have some of the
`boilerplates' used by S for the man pages, e.g.,

	.GE .ME .XY .GR .AO .NA

Perhaps .GE() or GENERIC()?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 08:07:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 09:07:48 +0200
Subject: R-alpha: apply()
In-Reply-To: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>
References: <3.0.1.16.19970822182043.51bf2ef2@droopy.iarc.fr>
Message-ID: <199708250707.JAA14115@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> At 12:42 22/08/97, kurt.hornik@ci.tuwien.ac.at wrote:
>> The following is identical in R and S, but still strange ...
>> 
R> apply(matrix(1:20, nc = 4), 1, table)
>> [,1] [,2] [,3] [,4] [,5]
>> [1,]    1    1    1    1    1
>> [2,]    1    1    1    1    1
>> [3,]    1    1    1    1    1
>> [4,]    1    1    1    1    1
R> apply(matrix(rep(1, 20), nc = 4), 1, table)
>> [1] 4 4 4 4 4
R> apply(matrix(c(1:4, 1, 6 : 8), nc = 4), 1, table)
>> [[1]]
>> 1 3 7 
>> 2 1 1 
>> 
>> [[2]]
>> 2 4 6 8 
>> 1 1 1 1
>> 
>> -k

> It is strange, but logical.  The problem is that it's an undocumented
> feature. If the help page said something like "If the calls to FUN
> return vectors of different lengths then apply returns a list of
> length dim(x)[MARGIN]" then it would be less surprising. Or would you
> prefer that apply returns an error message if it can't coerce the
> result to an array?

No, some explanation would be fine.  But from the examples, I don't
think that we always get a list of a certain length ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 08:10:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 09:10:20 +0200
Subject: R-alpha: tapply() strangeness
Message-ID: <199708250710.JAA14123@aragorn.ci.tuwien.ac.at>

Here's something related to last week's apply() problem:

R> x <- matrix(1:20, nc = 4)
R> x
     [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20

R> tapply(x, row(x), table)
[1] Numeric,4 Numeric,4 Numeric,4 Numeric,4 Numeric,4

???

In S,

> tapply(x, row(x), table)
$"1":
 1 6 11 16 
 1 1  1  1

$"2":
 2 7 12 17 
 1 1  1  1

$"3":
 3 8 13 18 
 1 1  1  1

$"4":
 4 9 14 19 
 1 1  1  1

$"5":
 5 10 15 20 
 1  1  1  1

which is (apart from labels) the same as

R> lapply(split(x, row(x)), table)
$1
 1  6 11 16 
 1  1  1  1 

$2
 2  7 12 17 
 1  1  1  1 

$3
 3  8 13 18 
 1  1  1  1 

$4
 4  9 14 19 
 1  1  1  1 

$5
 5 10 15 20 
 1  1  1  1 


-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Mon Aug 25 08:42:30 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Mon, 25 Aug 1997 09:42:30 +0200 (MET DST)
Subject: R-alpha: eigen and batch
Message-ID: <9708250742.AA12773@alpha.luc.ac.be>

Batch:
  Putting q(save=F) at the end of my file does not work in my
context because I can no longer source the file without quitting. I
have that quit statement in my .First so that I always quit that way
interactively. The problem is that it is ignored in batch.

eigen:
  The crash occurs on my 586 running Red Hat Linux 2.0.27 but not on
my son's 486 running SLackware Linix 2.0.29. We both have the same
most recent libraries installed (libc, libm, etc).
   I started looking in the eispack C code and traced down the
problem. In three of the four Fortran calls in eigen, (ch,rs,cg but
not rg), the same vector (vals) is used for the return eigenvalues as
for two or three temporary workspace vectors. This is risky
programming at any time and leads to a catastrophe with a 586 where
several things may be calculated at the same time. If the variable,
vals, is removed and all use of it in the .Fortran call replaced by
double(n) (as in the call to rg), eigen works on a 586.
  This sort of problem should be checked elsewhere in R.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Mon Aug 25 08:38:08 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 25 Aug 1997 09:38:08 +0200 (MET DST)
Subject: R-alpha: ts problems
Message-ID: <XFMail.970825095458.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.1.p0.Linux:970825095458:252=_
Content-Type: text/plain; charset=us-ascii

Here is a patch which fixes some problems with time series functions.
Some examples of what goes wrong...

> x <- ts(rnorm(100),start=1,deltat=2)
> start(x)
Error in ts[1] : object is not subsettable
> end(x)
Error in ts[2] : object is not subsettable
> y <- ts(matrix(rnorm(100),ncol=2))
> window(y,1,10)
Error in [.ts(x, (trunc((start - xtsp[1]) * freq + 1.5):trunc((end - xtsp[1]) *
 : unused argument to function

The first two bugs propagate quite widely. You can't even print x.

Unlike S-PLUS, R does not allow you to take row subsets of a time series
object without unclassing it (Of course there is the window function, but
you can't thin out a time series with this).   I've extended "[.ts"
to allow you to do this. I didn't put this version of "[.ts" in the patch.
Instead it is given below in full.

"[.ts" <-
function (x, i, j, drop = T)
{
        y <- NextMethod("[")
        if (missing(i))
                ts(y, start = start(x), freq = frequency(x))
        else {
                n <- if (is.matrix(x))
                        nrow(x)
                else length(x)
                ind <- (1:n)[i]
                delta <- unique(ind[-1] - ind[-length(ind)])
                if (length(delta) != 1 || delta == 0) {
                        warning("Not returning a time series object")
                }
                else {
                        xtsp <- tsp(x)
                        xtimes <- seq(from = xtsp[1], to = xtsp[2],
                                by = 1/xtsp[3])
                        ytsp <- numeric(3)
                        ytsp[1] <- xtimes[min(ind)]
                        ytsp[2] <- xtimes[max(ind)]
                        ytsp[3] <- (length(ind) - 1)/(ytsp[2] -
                                ytsp[1])
                        tsp(y) <- ytsp
                }
                y
        }
}

I hope this is useful.
Martyn

--_=XFMail.1.1.p0.Linux:970825095458:252=_
Content-Type: text/plain;
 charset=us-ascii; name=R-0.50.a3-tspatch; SizeOnDisk=613
Content-Description: R-0.50.a3-tspatch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="R-0.50.a3-tspatch"

diff -uNr R-0.50-a1-orig/src/library/base/funs/ts R-0.50-a1/src/library/base/fun
s/ts
--- R-0.50-a1-orig/src/library/base/funs/ts	Sun Aug 24 14:51:23 1997
+++ R-0.50-a1/src/library/base/funs/ts	Sun Aug 24 14:55:26 1997
@@ -103,7 +103,7 @@
 		fs <- floor(tsp[3]*(tsp[1] - is)+0.001)
 		c(is,fs+1)
 	}
-	else ts[1]
+	else tsp[1]
 }
 
 end.ts <-
@@ -118,7 +118,7 @@
 		fs <- floor(tsp[3]*(tsp[2] - is)+0.001)
 		c(is, fs+1)
 	}
-	else ts[2]
+	else tsp[2]
 }
 
 frequency.ts <-
@@ -266,7 +266,7 @@
 }
 
 "[.ts" <-
-function(x, i, j)
+function(x, i, j, drop=T)
 {
 	y <- NextMethod("[")
 	if(is.matrix(x) & missing(i))

--_=XFMail.1.1.p0.Linux:970825095458:252=_--
End of MIME message
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 09:17:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 10:17:52 +0200
Subject: R-alpha: R documentation problems
Message-ID: <199708250817.KAA14244@aragorn.ci.tuwien.ac.at>

Last week I spent some time going through the Blue Book to figure out
what we are missing and where we are different.  (Results will come in
subsequent emails.)  As a byproduct, here is a list of the documentation
problems I found.

As soon as time and my knowledge of CVS allow, I'll try to fix some of
these ...

-k

***********************************************************************
* The following man pages are completely missing:

	do.call
	.First
	.Last
	menu
	proc.time
	readline
	segments
	sink
	traceback

* The documentation for approx needs to be updated to reflect the the
new "constant" method.

* The documentation of approxfun() has an unnecessary xout part.  Also
needs to be updated to reflect the "constant" method.

* Man page for as.name mentions `name', which does not exist

* Man page for call is confusing.  It says,
	We don't differentiate between expressions and function
	    calls.  So is.call is the same as is.expression.
But,
  R> cl <- call("round",10.5)
  R> is.call(cl)
  [1] TRUE
  R> is.expression(cl)
  [1] FALSE

* Man page for function() (and invisible()) is incomplete

* Man page for points() gets formatted strangely

* Man page for split() should consistently talk about `group'
  (The `groups' in USAGE should be `group').

* The documentation of cat() is incomplete:  it has
  cat(... , sep="")
but
  R> args(cat)
  function (..., file = "", sep = " ", fill = FALSE, labels = NULL, 
          append = FALSE)

* The documentation of complex() is incorrect:
  complex(n=0, real=numeric(), imag=numeric())
but
  R> args(complex)
	function (n = 0, real = numeric(), imaginary = numeric())

* Man page for log() is not correct:
  The 2-arg version is not explained

* Man page for matrix() is incomplete:
  The `dimnames' argument is missing

* Man page for mode() is incomplete:
  The assignment form "mode<-" is not documenented

* Man page for stem() has
  stem(x, scale=1)
but
  R> args(stem)
  function (x, scale = 1, width = 80, atom = 1e-08)
Also, the EXAMPLES section should start with `data(islands)'	

* Man page for storage.mode() is incomplete:
  The assignment form "storage.mode<-" is not documented

* Man page for ts says
  ts(x, start=1, end, frequency=1, deltat=1, ts.eps = .Options$ts.eps)
but
  R> args(ts)
  function (data = NA, start = 1, end = numeric(0), frequency = 1, 
          deltat = 1, ts.eps = .Options$ts.eps)
(The first arg should	be `data' and not `x'.)

* In the `mva' package, the man page for dist() is not correct
  (The method "binary" is not mentioned.)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 09:18:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 10:18:47 +0200
Subject: R-alpha: Differences R/S
Message-ID: <199708250818.KAA14248@aragorn.ci.tuwien.ac.at>

Here's what I found.

* parse() has white = F by default (is T by default in S)

* S seems to have signif(x, digits = 6) whereas R needs an explicit
  second argument

* S title() has an axes = F optional argument

* In S, first argument to vector() is called `mode' and not `type'

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Aug 25 10:49:48 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Aug 1997 11:49:48 +0200
Subject: R-alpha: R documentation problems
In-Reply-To: Kurt Hornik's message of Mon, 25 Aug 1997 10:17:52 +0200
References: <199708250817.KAA14244@aragorn.ci.tuwien.ac.at>
Message-ID: <x2203i1tj7.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> Last week I spent some time going through the Blue Book to figure out
> what we are missing and where we are different.  (Results will come in
> subsequent emails.)  As a byproduct, here is a list of the documentation
> problems I found.
...
> 
> ***********************************************************************
> * The following man pages are completely missing:
> 
...
> 
> * In the `mva' package, the man page for dist() is not correct
>   (The method "binary" is not mentioned.)

And, rather important:

 * Manpages for plot() and par() are incomplete. axes= is missing and
so is lwd=, e.g. It's on the plot.default() page, but it needs to be
duplicated on plot(), or plot() needs to refer more explicitly to
plot.default(), than "See also". Similar notes regarding barplot() and
hist().

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 11:12:14 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 12:12:14 +0200
Subject: R-alpha: `missing' BB functions
Message-ID: <199708251012.MAA14358@aragorn.ci.tuwien.ac.at>

Here are the functions documented in the Blue Book that I found missing
in R (ignoring the ones which are obviously outdated).

	aggregate allocated amatch axes chull clorder cutree cycle date
	debugger dget discr faces interp l1fit labclust lag loglin
	monthplot mstree mulbar napsack odometer persp plclust plotfit
	rep.int restore rreg sabl sablplot set.seed smooth sort.list
	Stable stars starsymb storage subtree symbols tempfile tslines
	tsmatrix tsplot tspoints twoway unlink usa xor

In some detail:

aggregate cycle lag smooth tslines tsmatrix tsplot tspoints:
	Obviously useful for time series.  Andreas has a quick version
	of lag() ...

allocated storage:
	Something to display the current memory consumption (other than
	as a byproduct of calling gc() would be nice ...
amatch

axes:
	Seems to be the same as title() except for axes = T and F, resp.
	R currently does not have this extra arg.

chull

clorder(?) cutree discr faces(?) labclust(?) mstree(?) plclust stars
subtree:
	These are already (sort of) in the full version of `mva' as
	(still?) planned by Ross (question marks indicate the ones not
	mentioned explicitly)

date:
	If we'd want this, we could add
		date <- function() system("date")
	to work under UNIX, at least

debugger

dget

loglin:
	Would this be useful?  It should not be too hard to write
	something around AS 51 ... Should that be compatible with the S
	version?
interp

l1fit rreg:
	These would certainly be nice as workhorses, but shouldn't L1
	and robust fitting of linear models be specifyable at the model
	level?

monthplot sabl sablplot

mulbar:
	Would be nice to have, in particular in connection with Mosaic
	plots ...

napsack

odometer

persp:
	This is already in "3D GRAPHICS" of PROJECTS.

plotfit twoway:
	Outdated?

rep.int

restore:
	Should be the opposite of dump() ... In R, can we simply use
	source()?

set.seed:
	Martin, do you have a version of that for R? 

sort.list

Stable:
	Jim Lindsey <jlindsey@luc.ac.be> wrote that he has d and p
	function for the four-parameter stable family, perhaps we should
	include this.
	
starsymb

symbols

tempfile:
	Would be very useful, although I'd prefer it to be called
	`tmpfile' instead.  I am not sure if tmpfile() is ANSI C.  If
	so, we could simply wrap around it, as Fritz posted some time
	ago.

unlink:
	We most likely don't need this one, right?

usa:
	Would be nice, of course ...

xor:
	Is trivial and useful.  Could we add
		xor <- function(x, y) { (x | y) & !(x & y) }
	to the distribution?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug 25 11:24:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 25 Aug 1997 12:24:54 +0200
Subject: R-alpha: batch   q(save = 'no')
In-Reply-To: <9708250742.AA12773@alpha.luc.ac.be> (message from Jim Lindsey on
 Mon, 25 Aug 1997 09:42:30 +0200 (MET DST))
Message-ID: <199708251024.MAA00793@sophie.ethz.ch>

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> Batch: Putting q(save=F) at the end of my file does not work in my
    Jim> context because I can no longer source the file without
    Jim> quitting. I have that quit statement in my .First so that I always
    Jim> quit that way interactively. The problem is that it is ignored in
    Jim> batch.

I've tested the following, and it seems to work :

Add
	if(!interactive()) q(save = "no")

at the end of your batch files.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Aug 25 13:39:45 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 25 Aug 1997 14:39:45 +0200
Subject: R-alpha: R FAQ
Message-ID: <199708251239.OAA14629@aragorn.ci.tuwien.ac.at>

Attached is a snapshot of the new version of the FAQ.  What is still
missing is something on eval and .Options versus options().  As always,
feedback is greatly appreciated.
Best,
-k

***********************************************************************
  R FAQ
  Kurt Hornik
  v0.2-0, 1997/09/01

  This document contains answers to some of the most frequently asked
  questions about R.  Feedback is welcome.
  ______________________________________________________________________

  Table of Contents:

  1. Introduction

     1.1 Legalese
     1.2 Obtaining this Document
     1.3 Notation
     1.4 Feedback

  2. R Basics

     2.1 What Is R?
     2.2 What Machines Does R Run on?
     2.3 What Is the Current Version of R?
     2.4 How Can R Be Obtained?
     2.5 How Can R Be Installed?
        2.5.1 How Can R Be Installed (Unix)
        2.5.2 How Can R Be Installed (Windows)
        2.5.3 How Can R Be Installed (Macintosh)
     2.6 Are there Unix Binaries for R?
     2.7 Which Documentation Exists for R?
     2.8 Which Mailing Lists Exist for R?
     2.9 What is CRAN?

  3. R and S

     3.1 What Is S?
     3.2 What Is S-PLUS?
     3.3 What Are the Differences between R and S?

  4. R Add-On Packages

     4.1 Which Add-on Packages Exist for R?
     4.2 How Can Add-on Packages Be Installed?
     4.3 How Can Add-on Packages Be Used?
     4.4 How Can I Contribute to R?

  5. R and Emacs

     5.1 Is there Emacs Support for R?
     5.2 Should I Run R from Within Emacs?

  6. R Miscellania

     6.1 How Can I Read a Large Data Set into R?
     6.2 Why Can't R Source a `Correct' File?
     6.3 How Can I Set Components of a List to NULL?
     6.4 How Can I Save My Workspace?
     6.5 How Can I Clean Up My Workspace?
     6.6 Why Do My Matrices Lose Dimensions?

  7. Acknowledgments

  ______________________________________________________________________

  1.  Introduction

  This document contains answers to some of the most frequently asked
  questions about R.

  1.1.  Legalese

  This document is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  General Public License for more details.

  A copy of the GNU General Public License is available via WWW at
  http://www.gnu.org/copyleft/gpl.html.  You can also obtain it by
  writing to the Free Software Foundation, Inc., 675 Mass Ave,
  Cambridge, MA 02139, USA.

  1.2.  Obtaining this Document

  The latest version of this document is always available from

       http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html

  From there, you can also obtain versions converted to plain ASCII
  text, GNU info, DVI, and PostScript, as well as the SGML source used
  for creating all these formats using the SGML-Tools (formerly
  Linuxdoc-SGML) system.

  1.3.  Notation

  Everything should be pretty standard.  `R>' is used for the R prompt,
  and a `$' for the shell prompt (where applicable).

  1.4.  Feedback

  Feedback is of course most welcome.

  In particular, note that I do not have access to Windows or Mac
  systems.  If you have information on these systems that you think
  should be added to this document, please let me know.

  2.  R Basics

  2.1.  What Is R?

  R is a system for statistical computation and graphics.  It consists
  of a language plus a run-time environment with graphics, a debugger,
  access to certain system functions, and the ability to run programs
  stored in script files.
  The design of R has been heavily influenced by two existing languages:
  Becker, Chambers & Wilks' S (see question ``What is S?'') and
  Sussman's Scheme.  Whereas the resulting language is very similar in
  appearance to S, the underlying implementation and semantics are
  derived from Scheme.  See question ``What Are the Differences between
  R and S?'' for a discussion of the differences between R and S.

  R is being developed by Ross Ihaka and Robert Gentleman, who are
  Senior Lecturers at the Department of Statistics of the University of
  Auckland in Auckland, New Zealand.

  R has a home page at http://stat.auckland.ac.nz/r/r.html, and is free
  software distributed under a GNU-style copyleft.

  2.2.  What Machines Does R Run on?

  R is being developed for the Unix, Windows and Mac platforms.

  R will configure and build under a number of common Unix platforms
  including dec-alpha-osf, freebsd, hpux, linux-elf-ix86, sgi-irix,
  solaris, and sunos, and according to Jim Lindsey <jlindsey@luc.ac.be>
  also on Mac, Amiga and Atari under linux-m68k.

  If you know about other platforms, please drop me a note.

  2.3.  What Is the Current Version of R?

  The current Unix version is 0.50.  The previous version was 0.49 and
  added group methods and complex numbers, thus providing a more or less
  provides a full implementation of S as described in ``The New S
  Language''.

  The versions for Windows and Mac are pre-alpha.  With some good luck,
  the Windows version will soon catch up with the Unix version.

  2.4.  How Can R Be Obtained?

  Sources, binaries and documentation for R can be obtained via CRAN,
  the ``Comprehensive R Archive Network'' (see question ``What is
  CRAN?'').

  2.5.  How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  If binaries are available for your platform (see question ``Are there
  Unix Binaries for R?''), you can use these, following the instructions
  that come with them.

  Otherwise, you can compile and install R yourself, which can be done
  very easily under a number of common Unix platforms (see question
  ``What Machines Does R Run on?'').  The file INSTALL that comes with
  the R distribution contains instructions.

  Choose a place to install the R tree (R is not just a binary, but has
  additional data sets, help files, font metrics etc).  Let's call this
  place RHOME (given appropriate permissions, a natural choice would be
  `/usr/local/lib/R').  Untar the source code, and issue the following
  commands (at the shell prompt):

       $ ./configure
       $ make
       $ make install-help

  You can also build a LaTeX version of the manual entries with

       $ make install-latex

  and an HTML version of the manual with

       $ make install-html

  If these commands execute successfully, the R binary will be copied to
  the `$RHOME/bin' directory.  In addition, a shell script font-end
  called `R' will be created and copied to the same directory.  You can
  copy this script to a place where users can invoke it, for example to
  `/usr/local/bin'.  You could also copy the man page `R.1' to a place
  where your man reader finds it, such as `/usr/local/man/man1'.

  2.5.2.  How Can R Be Installed (Windows)

  The file `RApril.zip' from the `bin/ms-windows' directory of a CRAN
  site contains a binary Windows 95 distribution for R which should be
  about a 0.48 release.  This version is quite limited in Windows-
  specific features and probably contains many bugs, although it has
  been reported to work rather nicely.  As always, there is no limit to
  the damage a buggy program can do under Windows, so, at least until
  more experience have been gained with it, it should probably not be
  used on systems containing very important data.  It is not clear
  whether it works under Windows 3.11 (the HTML help system cannot work
  under 3.11 as it needs long file names).  According to James Neild
  <jneild@esri.com>, it works fine under Windows NT 3.51.

  Note that when uncompressing `RApril.zip', the pkunzip program needs
  to be invoked with the -D flag to create subdirectories.

  2.5.3.  How Can R Be Installed (Macintosh)

  The CRAN `bin/macintosh' directory contains `R.sea.hqx', a binhexed
  self-extracting archive, and installation instructions in
  `README.MACINTOSH'.  Note that the version in it is nowhere near the
  quality of the current Unix version.

  The Power Macintosh port is temporarily on hold.

  2.6.  Are there Unix Binaries for R?

  Experimental `.deb' and `.rpm' packages for installation under the
  ix86 versions of Debian GNU/Linux and Red Hat Linux, respectively, can
  be found in `bin/ix86-linux'.  No other binary distributions for Unix
  systems have thus far been made publically available.

  2.7.  Which Documentation Exists for R?

  Online documentation for most of the functions and variables in R
  exists, and can be printed on-screen by typing help(name) (or ?name)
  at the R prompt, where name is the name of the R object help is sought
  for.  (In the case of unary and binary operators and control-flow
  special forms, the name may need to be be quoted.)

  This documentation can also be made available as HTML, and as hardcopy
  via LaTeX, see question ``How Can R Be Installed?''.  An up-to-date
  HTML version is always available for web browsing at

       http://www.stat.math.ethz.ch/R-manual

  An R manual (``Notes on R:  A Programming Environment for Data
  Analysis and Graphics'') is currently being written, based on the
  ``Notes on S-PLUS'' by Bill Venables <venables@stats.adelaide.edu.au>
  and David Smith <D.M.Smith@lancaster.ac.uk>.  The current version can
  be obtained as `Rnotes.tgz' (LaTeX source) in a CRAN `doc' directory.
  Note that the ``conversion'' from S(-PLUS) to R is not complete yet.

  Last, but not least, Ross' and Robert's experience in designing and
  implementing R is described in:

       @Article{,
         author =       {Ross Ihaka and Robert Gentleman},
         title =        {R: A Language for Data Analysis and Graphics},
         journal =      {Journal of Computational and Graphical Statistics},
         year =         1996,
         volume =       5,
         number =       3,
         pages =        {299--314}
       }

  This is also the reference for R to use in publications.

  2.8.  Which Mailing Lists Exist for R?

  Thanks to Martin Maechler <maechler@stat.math.ethz.ch>, there are
  three mailing lists devoted to R.

     r-announce
        This list is for announcements about the development of R and
        the availability of new code.

     r-devel
        This list is for discussions about the future of R and pre-
        testing of new versions.  It is meant for those who maintain an
        active position in the development of R.
     r-help
        The `main' R mailing list, for announcements about the
        development of R and the availability of new code, questions and
        answers about problems and solutions using R, enhancements and
        patches to the source code and documentation of R, comparison
        and compatibility with S and S-plus, and for the posting of nice
        examples and, benchmarks.

  To send a message to everyone on the r-help mailing list, send email
  to

       r-help@stat.math.ethz.ch

  To subscribe (or unsubscribe) to this list send subscribe (or unsub-
  scribe) in the BODY of the message (not in the subject!)  to r-help-
  request@stat.math.ethz.ch.  Information about the list can be obtained
  by sending an email with info as its contens to r-help-
  request@stat.math.ethz.ch.

  Subscription and posting to the other lists is done analogously, with
  `r-help' replaced by `r-announce' and `r-devel', respectively.  Note
  that the r-announce list is gatewayed into r-help, so you don't need
  to subscribe to both of them.

  It is recommended that you send mail to r-help rather than only to the
  R developers (who are also subscribed to the list, of course).  This
  may save them precious time they can use for constantly improving R,
  and will typically also result in much quicker feedback for yourself.

  Of course, in the case of bug reports it would be very helpful to have
  code which reliably reproduces the problem.

  Archives of the above three mailing lists are made available on the
  net in a monthly schedule at ftp://ftp.stat.math.ethz.ch/Mail-
  archives/ (which is a directory of mail archive files).  Archives of
  the r-help mailing list (including the previous r-testers lists back
  to March 1996), are also available in HTML format at
  http://www.ens.gu.edu.au/robertk/rhelp/about.htm.

  The WWW page http://www.maths.uq.edu.au/~gks/r/mail.html is devoted to
  the R mailing lists, providing easy posting, subscription and
  unsubscription, and access to mailing list archives.

  The developers of R can be reached for comments and reports at
  R@stat.auckland.ac.nz.

  2.9.  What is CRAN?

  The ``Comprehensive R Archive Network'' (CRAN) is a collection of
  sites which carry identical material, consisting of the R
  distribution(s), the contributed extensions, documentation for R, and
  binaries.

  The CRAN master site can be found at the URL

       ftp://ftp.ci.tuwien.ac.at/pub/R/

  and is currently being mirrored daily at

       http://lib.stat.cmu.edu/R/CRAN/
       ftp://franz.stat.wisc.edu/pub/R/
       ftp://ftp.stat.math.ethz.ch/R-CRAN/
  http://www.stat.unipg.it/pub/stat/statlib/R/CRAN/
  ftp://ftp.u-aizu.ac.jp/pub/lang/R/CRAN/

  Please use the CRAN site closest to you to reduce network load.

  The structure of the CRAN tree is as follows.

     `src/base'
        contains the official R distribution as provided by Ross Ihaka
        and Robert Gentleman.

     `src/contrib'
        contains code for extension packages.

     `doc'
        is for additional documentation and information on R.

     `bin'
        is for prebuilt R binaries (the base distribution and
        extensions), grouped according to platforms.  Currently, there
        are only experimental packages for Debian GNU/Linux.  I hope
        that `.tar.gz' files with contents relative to an installation
        tree (e.g. `bin', `lib/R/', and `man/man1/R.1') can be made
        available soon for all major supported Unix platforms.

  To ``submit'' to CRAN, simply upload to
  ftp://ftp.ci.tuwien.ac.at/incoming and send email to Kurt Hornik
  <Kurt.Hornik@ci.tuwien.ac.at>.  Please indicate the copyright
  situation (GPL, ...) in your submission.

  3.  R and S

  3.1.  What Is S?

  S is a very high level language and an environment for data analysis
  and graphics.  S was written by Richard A. Becker, John M. Chambers,
  and Allan R. Wilks of AT&T Bell Laboratories Statistics Research
  Department.

  The primary references for S are two books by the creators of S.

  o  Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
     ``The New S Language,'' Chapman & Hall, London.

     This book is often called the ``Blue Book''.

  o  John M. Chambers and Trevor J. Hastie (1992), ``Statistical Models
     in S,'' Chapman & Hall, London.

     This is also called the ``White Book''.

  There is a huge amount of user-contributed code for S, available at
  the S Repository at CMU.

  See the ``Frequently Asked Questions about S''
  (http://lib.stat.cmu.edu/S/faq) for further information about S.

  3.2.  What Is S-PLUS?

  S-PLUS is a value-added version of S sold by Statistical Sciences,
  Inc. (now a division of Mathsoft, Inc.)  S is a subset of S-PLUS, and
  hence anything which may be done in S may be done in S-PLUS.  In
  addition S-PLUS has extended functionality in a wide variety areas,
  including robust regression, modern nonparametric regression, time
  series, survival analysis, multivariate analysis, classical
  statistical tests, quality control, and graphics drivers.  Add-on
  modules add additional capabilities for wavelet analysis, spatial
  statistics, and design of experiments.

  See the MathSoft S-PLUS page (http://www.mathsoft.com/splus.html) for
  further information.

  3.3.  What Are the Differences between R and S?

  Whereas the developers of R have tried to stick to the S language as
  defined in ``The New S Language'' (Blue Book, see question ``What is
  S?''), they have adopted the evaluation model of Scheme.

  This difference becomes manifest when free variables occur in a
  function.  Free variables are those which are neither formal
  parameters (occurring in the argument list of the function) nor local
  variables (created by assigning to them in the body of the function).
  Whereas S (like C) by default uses static scoping, R (like Scheme) has
  adopted lexical scoping.  This means the values of free variables are
  determined by a set of global variables in S, but in R by the bindings
  that were in effect at the time the function was created.

  Consider the following function:

       cube <- function(n) {
         sq <- function() n * n
         n * sq()
       }

  Under S, sq() does not ``know'' about the variable n unless it is
  defined globally:

       S> cube(2)
       Error in sq():  Object "n" not found
       Dumped
       S> n <- 3
       S> cube(2)
       [1] 18

  In R, the ``environment'' created when cube() was invoked is also
  looked in:

       R> cube(2)
       [1] 8

  The following more `realistic' example illustrating the differences in
  scoping is due to Thomas Lumley <thomas@biostat.washington.edu>.  The
  function

       jackknife.lm <- function(lmobj) {
         n <- length(resid(lmobj))
         jval <- t(apply(as.matrix(1:n), 1,
                         function(i) coef(update(lmobj, subset = -i))))
         (n - 1) * (n - 1) * var(jval) / n
       }

  does something useful in R, but does not work in S.  In order to make
  it work in S you need to explicitly pass the linear model object into
  the function nested in apply().  If you don't and you are lucky you
  will get ``Error: Object "lmobj" not found''.  If you are unlucky
  enough to have a linear model called lmobj in your global environment
  you will get the wrong answer with no warning.

  The following version works in S.

       jackknife.S.lm <- function(lmobj) {
         n <- length(resid(lmobj))
         jval <- t(apply(as.matrix(1:n), 1,
                         function(i, lmobj) coef(update(lmobj, subset = -i)),
                         lmobj = lmobj))
         (n - 1) * (n - 1) * var(jval) / n
       }

  (The S version was written independently by Thomas and at least three
  of his fellow students over the past couple of years, causing liter-
  ally hours of confusion on each occasion.)

  Similarly, most optimization (or zero-finding) routines need some
  arguments to be optimized over and have other parameters that depend
  on the data but are fixed with respect to optimization.  With R
  scoping rules, this is a trivial problem; simply make up the function
  with the required definitions in the same environment and scoping
  takes care of it.  With S, one solution is to add an extra parameter
  to the function and to the optimizer to pass in these extras, which
  however can only work if the optimizer supports this (and typically,
  the builtin ones do not).

  Lexical scoping allows using function closures and maintaining local
  state.  A simple example (taken from Abelson and Sussman) can be found
  in the `demos/language' subdirectory of the R distribution.  Further
  information is provided in the standard R reference ``R: A Language
  for Data Analysis and Graphics'' (see question ``Which Documentation
  Exists for R?'') and a paper on ``Lexical Scope and Statistical
  Computing'' by Robert Gentleman and Ross Ihaka which can be obtained
  from the `doc/misc' directory of a CRAN site.

  Lexical scoping also implies a further major difference.  Whereas S
  stores all objects as separate files in a directory somewhere (usually
  `.Data' under the current directory), R does not.  All objects in R
  are stored internally.  When R is started up it grabs a very large
  piece of memory and uses it to store the objects.  R performs its own
  memory management of this piece of memory.  Having everything in
  memory is necessary because it is not really possible to externally
  maintain all relevant ``environments'' of symbol/value pairs.  This
  difference also seems to make R much faster than S.

  The down side is that if R crashes you will lose all the work for the
  current session.  Saving and restoring the memory ``images'' (the
  functions and data stored in R's internal memory at any time) can be a
  bit slow, especially if they are big.  In S this does not happen,
  because everything is saved in disk files and if you crash nothing is
  likely to happen to them.  R is still in an alpha stage, and does
  crash from time to time.  Hence, for important work you should
  consider saving often, see question ``How Can I Save My Workspace?''
  (other possibilities are logging your sessions, or have your R
  commands stored in text files which can be read in using source()).
  (Note that if you run R from within Emacs (see question ``R and
  Emacs''), you can save the contents of the interaction buffer to a
  file and conveniently manipulate it using S-transcript-mode, as well
  as save source copies of all functions and data used.)

  Apart from lexical scoping and its implications, R follows the S
  language definition in the Blue Book as much as possible, and hence
  really is an ``implementation'' of S.  There are some intentional
  differences where the behavior of S is considered ``not clean''.  In
  general, the rationale is that R should help you detect programming
  errors, while at the same time being as compatible as possible with S.

  Some known differences are the following.

  o  In R, if x is a list, then x[sub] <- NULL and x[[sub]] <- NULL
     remove the specified elements from x.  The first of these is
     incompatible with S, where it is a no-op.

  o  In S, the functions named .First and .Last in the `.Data' directory
     can be used for customizing, as they are executed at the very
     beginning and end of a session, respectively.  R looks for files
     called `.Rprofile' in the user's home directory and the current
     directory, and sources these.  (It also loads a saved image from
     `.RData' in case there is one.)  If a .First function exists then,
     it is executed.  The .Last mechanism is not supported yet.

  o  In S, library(name) adds the data directory for the library section
     name to the search list.  If a function object named `.First.lib'
     exists in the directory, it is executed; this is typically used to
     dynamically load compiled code required by the functions in the
     section.  In R, library(name) currently simply sources the file
     $RHOME/library/name, and compiled code can be loaded by calling
     library.dynam() in this file.  The .First.lib mechanism is not
     really supported.

  o  In R, dyn.load() can only load shared libraries, as created for
     example by `R SHLIB'.

  o  R presently does not support IEEE Inf and NaN.

  o  In R, attach currently only works for lists and data frames (not
     for directories).

  o  Categories do not exist in R, and never will as they are deprecated
     now in S.  Use factors instead.

  o  In R, For() loops are not necessary and hence not supported.

  o  In R, assign() uses the argument envir= rather than where= as in S.

  o  The random number generators are different, and the seeds have
     different length.

  o  The glm family objects are implemented differently in R and S.  The
     same functionality is available but the components have different
     names.

  o  terms objects are stored differently.  In S a terms object is an
     expression with attributes, in R it is a formula with attributes.
     The attributes have the same names but are mostly stored
     differently.  The major difference in functionality is that a terms
     object is subscriptable in S but not in R.  If you can't imagine
     why this would matter then you don't need to know.

     Also, attr(terms(y~x),"response") give 1 in S and TRUE in R.  In S
     the attribute indicates which column of the model frame will
     contain the response. In R this always column 1 because model
     frames are only useful when their columns are in the right order
     (model.matrix doesn't check).

  There are also differences which are not intentional, and result from
  missing or incorrect code in R.  The developers would appreciate
  hearing about any deficiencies you may find (in a written report fully
  documenting the difference as you see it).  Of course, it would be
  useful if you were to implement the change yourself and make sure it
  works.

  4.  R Add-On Packages

  4.1.  Which Add-on Packages Exist for R?

  The R distribution comes with the following extra packages:

     eda
        Exploratory Data Analysis.  Currently only contains functions
        for robust line fitting, and median polish and smoothing.

     mva
        Multivariate Analysis.  Currently contains code for principal
        components (prcomp), canonical correlations (cancor),
        hierarchichal clustering (hclust), and metric multidimensional
        scaling (cmdscale).  More functions for clustering and scaling,
        biplots, profile and star plots, and code for ``real''
        discriminant analysis will be added soon.

  The following packages are available from the CRAN `src/contrib' area.

     acepack
        ace (Alternating Conditional Expectations) and avas (Additivity
        and VAriance Stabilization for regression) for selecting
        regression transformations.

     bootstrap
        Software (bootstrap, cross-validation, jackknife), data and
        errata for the book ``An Introduction to the Bootstrap'' by B.
        Efron and R. Tibshirani, 1993, Chapman and Hall.

     class
        Functions for classification (k-nearest neighbor and LVQ).

     clus
        Functions for cluster analysis.

     ctest
        A collection of classical tests, including the Bartlett, Fisher,
        Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.

     date
        Functions for dealing with dates.  The most useful of them
        accepts a vector of input dates in any of the forms 8/30/53,
        30Aug53, 30 August 1953, ..., August 30 53, or any mixture of
        these.

     e1071
        Miscellaneous functions used at the Department of Statistics at
        TU Wien (E1071).

     fracdiff
        Maximum likelihood estimation of the parameters of a
        fractionally differenced ARIMA(p,d,q) model (Haslett and
        Raftery, Applied Statistics, 1989).

     gee
        An implementation of the Liang/Zeger generalized estimating
        equation approach to GLMs for dependent data.

     integrate
        Code for adaptive quadrature.

     jpn
        A function to plot Japan's coast-line and prefecture boundaries.

     leaps
        A package which performs an exhaustive search for the best
        subsets of a given set of potential regressors, using a branch-
        and-bound algorithm, and also performs searches using a number
        of less time-consuming techniques.

     mlbench
        A collection of artificial and real-world machine learning
        benchmark problems, including the Boston housing data.

     oz Functions for plotting Australia's coastline and state
        boundaries.

     polynom
        A collection of functions to implement a class for univariate
        polynomial manipulations.

     snns
        An R interface to the Stuttgart Neural Networks Simulator
        (SNNS).

     splines
        Regression spline functions.

     survival4
        Functions for survival analysis (requires splines).

     wavethresh
        Code for doing wavelet transforms and thresholding in 1 and 2D.

     xgobi
        Interface to the XGobi program for graphical data analysis.

  See CRAN `src/contrib/INDEX' for more information.

  Paul Gilbert <pgilbert@bank-banque-canada.ca> has a written a
  multivariate time series package for S called time.series that is
  mostly converted to run in R.  He is currently debugging the code, and
  will officially release it in the near future.
  According to Paul, the PADI interface from the Bank of Canada also
  works with minor changes.  PADI can be used to access Fame time series
  data bases and potentially other databases, even remotely over the
  Internet.  For further information see http://www.bank-banque-
  canada.ca/pgilbert.

  Harald Fekjaer <hfe@math.uio.no> has written addreg, a package for
  additive hazards regression, which can be obtained from
  http://www.med.uio.no/imb/stat/addreg/.

  More code has been posted to the r-help mailing list, and can be
  obtained from the mailing list archive.

  4.2.  How Can Add-on Packages Be Installed?

  (Unix only.)  Untar the add-on packages in $RHOME/src/library/ and
  type

       $ make libs
       $ cd ../..
       $ ./etc/install-libhelp

  at the shell prompt.

  4.3.  How Can Add-on Packages Be Used?

  To find out which add-ons have already been installed, type

       R> library()

  at the R prompt.  This produces something like

       NAME         DESCRIPTION
       acepack      ace() and avas() for selecting regression transformations
       bootstrap    Functions for the book "An Introduction to the Bootstrap"
       ctest        Classical Tests
       date         Functions for handling dates
       eda          Exploratory Data Analysis
       fracdiff     Fractionally differenced ARIMA (p,d,q) models
       gee          Generalized Estimating Equation models
       mva          Classical Multivariate Analysis
       splines      Regression spline functions
       survival4    Survival analysis [needs library(splines)]

  You can ``load'' the installed package name by

       R> library(name)

  You can then find out which functions it provides by typing
       R> help(library = name)

  4.4.  How Can I Contribute to R?

  R is currently still in alpha (or pre-alpha) state, so simply using it
  and communicating problems is certainly of great value.

  One place where functionality is still missing is the modeling
  software as described in ``Statistical Models in S'' (see question
  ``What is S?''.  The functions

        add1 kappa alias labels drop1 proj

  are missing; many of these are interpreted functions so anyone that is
  bored and wants to have a go at implementing them it would be appreci-
  ated.  In addition, only linear and generalized linear models are cur-
  rently available, aov, gam, loess, tree, and the nonlinear modelling
  code are not there yet.

  See also the `PROJECTS' file in the top level R source directory.

  Many of the packages available at the Statlib S Repository might be
  worth porting to R.

  If you are interested in working on any of these projects, please
  notify Kurt Hornik.

  5.  R and Emacs

  5.1.  Is there Emacs Support for R?

  There is an Emacs-Lisp interface to S/S-PLUS called S-mode.  Its
  current version is 4.8 and can be obtained at
  http://www.maths.lancs.ac.uk:2080/~maa036/elisp/S-mode/.  The earlier
  versions which can be found at the Statlib S repository (gnuemacs3 and
  gnuemacs4) are outdated.

  It contains code for interacting with an inferior S process from
  within Emacs including an interface to the help system, editing S
  source code, and transcript manipulation, and comes with detailed
  instructions for installation.

  Martin Maechler <maechler@stat.math.ethz.ch> and Tony Rossini
  <rossini@math.sc.edu> have integrated support for R into this package.
  The current version is at

       ftp://ftp.math.sc.edu/rossini/S-mode-4.8.MM6.XE2.tar.gz

  and runs under both GNU Emacs and XEmacs.

  To install, put the byte-compiled `.el' files into a place where Emacs
  can find them, and add

  (if (not (assoc "\\.R$" auto-mode-alist)
      (add-to-list 'auto-mode-alist (cons "\\.R$" 'R-mode))))
  (autoload 'R "S" "Run an inferior R process" t)
  (autoload 'R-mode "S" "Mode for editing R source" t)
  (autoload 'r-mode "S" "Mode for editing R source" t)

  to one of your Emacs startup files, typically `~/.emacs'.  You can
  then fire up R from within Emacs by typing `M-x R' (note however that
  many interface functions will not work), and if you use the extension
  `.R' for your files with R code, Emacs will automagically turn on R
  edit mode whenever you visit such a file.

  Tony Rossini, Martin Maechler and Kurt Hornik have officially taken
  over the development of S-mode.  A new version, renamed ``ESS'' (for
  ``Emacs Speaks Statistics'') and including support for R, all S
  versions, and even Xlisp-STAT and Vista, will be released shortly.

  5.2.  Should I Run R from Within Emacs?

  Yes.  Inferior R mode provides a readline/history mechanism, object
  name completion, and syntax-based highlighting of the interaction
  buffer using Font Lock mode, as well as a very convenient interface to
  the R help system.

  Of course, it also integrates nicely with the mechanisms for editing R
  source using Emacs.  One can write code in one Emacs buffer and send
  whole or parts of it for execution to R; this is helpful for both data
  analysis and programming.  One can also seamlessly integrate with a
  revision control system, in order to maintain a log of changes in your
  programs and data, as well as to allow for the retrieval of past
  versions of the code.

  In addition, it allows you to keep a record of your session, which can
  also be used for error recovery through the use of the transcript
  mode.

  6.  R Miscellania

  6.1.  How Can I Read a Large Data Set into R?

  R (currently) uses a static memory model.  This means that when it
  starts up, it asks the operating system to reserve a fixed amount of
  memory for it.  The size of this chunk cannot be changed subsequently.
  Hence, it can happen that not enough memory was allocated.

  In these cases, you should restart R with more memory available, using
  the command line options -n and -v.  To understand these options, one
  needs to know that R maintains separate areas for fixed and variable
  sized objects.  The first of these is allocated as an array of ``cons
  cells'' (Lisp programmers will know what they are, others may think of
  them as the building blocks of the language itself, parse trees,
  etc.), and the second are thrown on a ``heap''.  The -n option can be
  used to specify the number of cons cells (each occupying 16 bytes)
  which R is to use (the default is 200000), and the -v option to
  specify the size of the vector heap in megabytes (the default is 2).
  Only integers are allowed for both options.

  E.g., to read in a table of 5000 observations on 40 numeric variables,
  R -v 6 should do.

  Note that the information on where to find vectors and strings on the
  heap is stored using cons cells.  Thus, it may also be necessary to
  allocate more space for cons cells in order to perform computations
  with very ``large'' variable-size objects.

  You can find out the current memory comsumption by typing gc() at the
  R prompt.

  6.2.  Why Can't R Source a `Correct' File?

  R sometimes has problems parsing a file which does not end in a
  newline.  This can happen for example when Emacs is used for editing
  the file and next-line-add-newlines is set to nil.  To avoid the
  problem, either set require-final-newline to a non-nil value in one of
  your Emacs startup files, or make sure R-mode (see question ``Is there
  Emacs Support for R?'') is used for editing R source files (which
  locally ensures this setting).

  Earlier R versions had a similar problem when reading in data files,
  but this should have been taken care of now.

  6.3.  How Can I Set Components of a List to NULL?

  You can use

       x[i] <- list(NULL)

  to set component i of the list x to NULL, similarly for named compo-
  nents.  Do not set x[i] or x[[i]] to NULL, because this will remove
  the corresponding component from the list.

  For dropping the row names of a matrix x, it may be easier to use
  rownames(x) <- NULL, similarly for column names.

  6.4.  How Can I Save My Workspace?

  The expression

       save(list = ls(), file = ".RData")

  saves the objects in the currently active environment (typically the
  user's .GlobalEnv) to the file `.RData' in the R startup directory.

  6.5.  How Can I Clean Up My Workspace?

  To remove all objects in the currently active environment (typically
  the user's .GlobalEnv), you can do
       rm(list = ls())

  6.6.  Why Do My Matrices Lose Dimensions?

  When a matrix with a single row or column is created by a subscripting
  operation, e.g., row <- mat[2, ], it is by default turned into a
  vector.  In a similar way if an array with dimension, say, 2x3x1x4 is
  created by subscripting it will be coerced into a 2x3x4 array, losing
  the unnecessary dimension.  After much discussion this has been
  determined to be a feature.

  To prevent this happening, add the option `drop = FALSE' to the
  subscripting. For example,

         rowmatrix <- mat[2, , drop = F]  # creates a row matrix
         colmatrix <- mat[, 2, drop = F]  # creates a column matrix
         a <- b[1, 1, 1, drop = F]        # creates a 1x1x1 array

  The `drop = F' option should be used defensively when programming.
  For example, the statement

         somerows <- mat[index, ]

  will return a vector rather than a matrix if index happens to have
  length 1, causing errors later in the code.  It should probably be
  rewritten as

         somerows <- mat[index, , drop = F]

  7.  Acknowledgments

  Of course, many many thanks to Robert and Ross for the R system, and
  to the package writers and porters for adding to it.

  Special thanks go to Peter Dalgaard, Paul Gilbert, Jim Lindsey, Thomas
  Lumley, Martin Maechler, and Anthony Rossini for their comments which
  helped me improve this FAQ.

  More to some soon ...


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Aug 25 15:02:14 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 25 Aug 1997 10:02:14 -0400
Subject: R-alpha: HTML help
Message-ID: <97Aug25.100418edt.26506@mailgate.bank-banque-canada.ca>

>> It is looking like a real pain to translate the current set of html files to
>> this format which means that there is going to be some real work required in
>> getting a 3.11 version going.

> Is it possible that the HTML->RTF->WinHelp generation pointer I sent
> you would work faster? Point being that you could generate the RTF
> file on a machine with long filenames yielding a file with *internal"
> links, no restrictions on names, and in turn a .HLP file - which we
> want to have anyway.

I came to the "real pain" conclusion a couple of years ago when I
converted the help files for my time series library to HTML. My
conclusion was essentially Kurt's: give up on meaningful filenames and
build internal links. I have a couple of unix scripts which build an
index by function name and an index by title and change the "see also"
pointers to appropriate links into the index. I don't get RTF out of
this though. (I was looking for a common format, not a way to generate
all formats.) If the scripts would be of use to you let me know.

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Aug 25 16:15:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 25 Aug 1997 17:15:32 +0200
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
Message-ID: <199708251515.RAA01258@sophie.ethz.ch>

Another request for comments

	(the last one on file extensions had not too many 'voters' ...)

Both questions have to do with improving the 'man' file format,
conventions, .. AND building the  'help', 'latex' and 'html' files from the
man sources. 

Before you read on.. 
Kurt Hornik has suggested that in any case, the compiled
'help', 'html' (and 'tex' and 'R' Example) files could be provided  
(through CRAN) for those people who would lack in the following..

1) I am trying to `replace' the current scheme of
	make install-help
	make install-latex
	make install-html
	make test-Examples	which just calls  shell script in RHOME/etc

   by a scheme that uses proper dependencies and only
   rebuilds things when and where they have changed.

   Currently, I believe that this would be much easier / nicer  if I could
   require  GNU make  (which all Linuxers have anyway) for doing these.
   I could then use things such as  $(shell: ...)   $(wildcard: ...), etc.

 Is this ok with all of you?


2) Even more extreme: Can we require  __Perl__ to be available for most
   (for all who want to build  help/html/tex files themselves)?

   If yes, we could think of enhancing the "compilation" of man files
   quite a bit, using perl instead of the
	sed .. | m4 | sed ..
   pipe which we currently need.

What do you think?

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Mon Aug 25 16:51:26 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 25 Aug 1997 11:51:26 -0400
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
In-Reply-To: Martin Maechler's message of "Mon, 25 Aug 1997 17:15:32 +0200"
References: <199708251515.RAA01258@sophie.ethz.ch>
Message-ID: <wncg1ryl0qp.fsf@fhat.stat.sc.edu>


>>>>> "Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:


    Martin>    Currently, I believe that this would be much easier /
    Martin>    nicer if I could require GNU make (which all Linuxers
    Martin>    have anyway) for doing these.  I could then use things
    Martin>    such as $(shell: ...)  $(wildcard: ...), etc.

    Martin>  Is this ok with all of you?


    Martin> 2) Even more extreme: Can we require __Perl__ to be
    Martin>    available for most (for all who want to build
    Martin>    help/html/tex files themselves)?

    Martin> What do you think?

Fine for Unix platforms.  Both are easy to build (easier than R, sort
of), and can be installed in a personal account.

I'm worried about the Mac and W95 platforms.  Ross and Robert?

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 17:31:20 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 09:31:20 -0700 (PDT)
Subject: R-alpha: tapply() strangeness
In-Reply-To: <199708250710.JAA14123@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970825092244.1542B-100000@avon>

On Mon, 25 Aug 1997, Kurt Hornik wrote:

> Here's something related to last week's apply() problem:
> 
> R> x <- matrix(1:20, nc = 4)
> R> x
>      [,1] [,2] [,3] [,4]
> [1,]    1    6   11   16
> [2,]    2    7   12   17
> [3,]    3    8   13   18
> [4,]    4    9   14   19
> [5,]    5   10   15   20
> 
> R> tapply(x, row(x), table)
> [1] Numeric,4 Numeric,4 Numeric,4 Numeric,4 Numeric,4
> 

Not terribly strange.  What we have here is a vector of lists (not a list
of lists as in S).  If you look at the components you see that everything
is the same as in S, it just prints differently
> tapply(x, row(x), table)->a
> a[1]
$1
 1  6 11 16 
 1  1  1  1 
or 
> a[[1]]
 1  6 11 16 
 1  1  1  1 

According to the Blue Book tapply() is supposed to return an array of
mode list  when the result of FUN applied to each category is not of
length 1. What you see is the result of my taking this literally: a
one-dimensional array
> dim(a)
[1] 5
> dimnames(a)
[[1]]
[1] "1" "2" "3" "4" "5"

I must confess that I didn't even know one-dimensional arrays were
possible -- I thought we would get a vector of mode list. Still, it seems
to work ok.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Mon Aug 25 17:43:55 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 25 Aug 1997 12:43:55 -0400
Subject: R-alpha: Re: missing' BB functions
Message-ID: <97Aug25.124604edt.26509@mailgate.bank-banque-canada.ca>

Kurt

The function tempfile is available based on some C code from Friedrich
Leisch. The function unlink is fairly simple in unix but I haven't
experimented elsewhere. In this regard, I have put together a small
kernel set of functions to try to handle cross platform and R vs S
issues. This is appended below and I would certainly appreciate
feedback. The purpose of this kernel is so that I can write my code in
a way which will work in Splus or R and on most platforms.

I believe the function sort.list is just a special case of the function
order, which works in R.

Included with the kernel functions below is a set.seed function which I
have modified slightly (both in Splus and in R) so that it returns the
new value of the seed rather than returning NULL. There is a bit of a
kludge to make set.seed work with the single integer argument suggested
in the BB. It also works with the more realistic argument, a
previous setting of the seed.

I have working versions of tsmatrix and tsplot, but I'm not sure to
what extent they can be separated from a small "tframe library" I have
built to separate out (improve) the handling of the time dimension in
both Splus and R. I'll take a look at this shortly.

Also, if anyone has coded the functions acf and/or ar I would certainly
appreciate having them.


Paul Gilbert 


##############################################################################


# This file has code which contains operating system and S/R specific 
#   functions. They are intended to be used as a kernel to help 
#   protect other code from these problems.

# The MSwindows versions are not done. The Splus and Sun versions are done
# largely from memory (and old code) and have not yet been checked.

# The following functions are attempted:
#   For S/R differences:
#      global.assign, system.info, exists.graphics.device, tmpfile, unlink,
#      synchronize,  list.add for [["new.element"]]<-
#   For OS differences: 
#     system.call, sleep, present.working.directory, whoami, file.copy, 
#     file.date.info, date, mail, unlink, local.host.netname, 

# Also a number of is.xx functions are defined to identify systems.

# The variable  .SPAWN is also set to be used to identify if Splus "For" loops
#    should be used. (It is sometimes better not to use these even in Splus.)

##############################################################################

# there is a bit of a bootstrap problem first. 
  
# S untested !!!
if (!exists("version")) 
                 {version <- list(language="S", major=1, minor=1) 
                  system.call<- function(cmd){unix(cmd) }   
                 }
# Splus
if( is.null(version$language))
                  system.call<- function(cmd){unix(cmd) }   
# R:
if(!is.null(version$language) && (version$language=="R"))
                  system.call<- function(cmd){system(cmd, intern=T)}
 
#  end of bootstrap

system.info <- function() 
  {r <-unclass(version)
   r$minor <- as.numeric(r$minor)
   r$major <- as.numeric(r$major)
   if (is.null(r$language))  r$language <- "Splus"
   r$OSversion <- paste(system.call("uname -s"), 
                        system.call("uname -r | sed -e 's/\\.\.\*//'"), sep="")
   r
  }

is.R <- function(){system.info()$language == "R"}
is.S <- function(){is.Splus() | (system.info()$language == "S")}
is.Splus <- function(){system.info()$language == "Splus"}
is.Splus.pre3.3 <- function()
 {# <= 3.2 
  is.Splus() &&  ((system.info()$major+.1*system.info()$minor) < 3.3)
 }
is.Linux <- function(){system.info()$os == "linux"} 
is.MSwindows <- function(){system.info()$os == "MS Windows"}
is.Sun4 <- function(){"SunOS4" == system.info()$OSversion }
is.Sun5 <- function(){"SunOS5" == system.info()$OSversion }
is.unix <- function(){is.Linux() | is.Sun5() | is.Sun4() | 
                      (system.info()$os == "Unix")}  # ???

if(is.unix())
  {if(is.R()) unix <- function(cmd) system(cmd, intern=T)
   sleep <- function(n) {unix(paste("sleep ", n))} # pause for n seconds
   present.working.directory <- function(){unix("pwd")} # present directory
   whoami <- function(){unix("whoami")} # return user id (for mail)
   local.host.netname <-function() {unix("uname -n")}
   date <-function() {unix("date")}

   mail <- function(to, subject="", text="")
    {# If to is null then mail is not sent (useful for testing).
     file <- tmpfile()
     write(text, file=file)
   if(!is.null(to)) unix(paste("cat ",file, " | mail  -s '", subject, "' ", to))
     unlink(file)
     invisible()
    }

   file.copy <- function(from, to)unix(paste("cp ", from, to)) # copy file

   file.date.info <- function(file.name)
     {mo <- (1:12)[c("Jan","Feb","Mar","Apr","May", "Jun","Jul","Aug", "Sep",
         "Oct","Nov","Dec") ==substring(unix(paste("ls -l ",file)),33,35)]
      day <- as.integer(substring(unix(paste("ls -l ",file.name)),37,38))
      hr  <- as.integer(substring(unix(paste("ls -l ",file.name)),40,41))
      sec <- as.integer(substring(unix(paste("ls -l ",file.name)),43,44))
      c(mo,day,hr,sec)
     }
  }

if(is.MSwindows())
  {system.call  <- function(cmd) 
         {stop("system calls must be modified for this operating system.")}
   sleep <- system.call 
   present.working.directory <- system.call
   whoami <- system.call
   file.copy <- system.call
   file.date.info <- system.call
  }


if(is.S())
   {tmpfile <- tempfile
    if(is.unix())system  <- unix   
    global.assign <- function(name, value) {assign(name,value, where = 1)}
    .SPAWN <- TRUE
    exists.graphics.device <- function(){dev.cur() !=1 }
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                 {motif(display) }
    close.graphics.device <- function(){dev.off() }
    if (!exists("set.seed.Splus")) set.seed.Splus <- set.seed
    set.seed <- function(seed=NULL)
      {if (is.null(seed)) 
          seed <-.Random.seed
       else 
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }

    "list.add<-" <- function(x, replace, value)
       {# replace or add elements to a list.
        x[replace] <- value
        # x[[replace]] <- value  would be more logical but doesn't work
        x
       }
   }
        
if(is.R()) 
   {tmpfile <- function(f)
        {# Requires C code also from Friedrich Leisch not in version 0.15 of R.
         d<-"This is simply a string long enough to hold the name of a tmpfile";
         .C("tmpf", as.character(d))[[1]]
        }
    unlink <- function(file) system.call(paste("rm -fr ", file))
    global.assign <- function(name, value) 
                          {assign(name,value, envir=.GlobalEnv)}
    synchronize<- function(x){NULL} # perhaps this should do something?
    .SPAWN <- FALSE
    exists.graphics.device <- function(){exists(".Device")}
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                {x11(display) }
    close.graphics.device <- function(){F} # how do I do this?
    set.seed <- function(seed=NULL)
      {if (is.null(seed)) 
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not yet exist
          seed <-.Random.seed
         }
       else 
         {if (1==length(seed))
             global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }

   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list. 
      if (is.numeric(replace))
        {# x<- do.call("default.[[<-", list(x,replace,value))   # use default
         x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value)) 
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }
 }



##############################################################################

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 17:48:15 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 09:48:15 -0700 (PDT)
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
In-Reply-To: <199708251515.RAA01258@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970825094416.1542D-100000@avon>

On Mon, 25 Aug 1997, Martin Maechler wrote:
> 1) I am trying to `replace' the current scheme of
> 	make install-help
> 	make install-latex
> 	make install-html
> 	make test-Examples	which just calls  shell script in RHOME/etc
> 
>    by a scheme that uses proper dependencies and only
>    rebuilds things when and where they have changed.

Yes, yes !!
 
>    Currently, I believe that this would be much easier / nicer  if I could
>    require  GNU make  (which all Linuxers have anyway) for doing these.
>    I could then use things such as  $(shell: ...)   $(wildcard: ...), etc.
> 
>  Is this ok with all of you?

We tend to have GNU tools available on machines here, even under
SunOS/Solaris.  I don't know common this is.

> 
> 2) Even more extreme: Can we require  __Perl__ to be available for most
>    (for all who want to build  help/html/tex files themselves)?


I actually think requiring Perl is less extreme than requiring GNU make.
Perl is useful for so many things (eg CGI scripts) that almost everyone
has it.  There must be quite a lot of people who rely on the make that
comes with their system, though.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Aug 25 18:18:08 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 Aug 1997 10:18:08 -0700 (PDT)
Subject: R-alpha: eigen and batch
In-Reply-To: <9708250742.AA12773@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970825095235.1542E-100000@avon>

On Mon, 25 Aug 1997, Jim Lindsey wrote:
> 
> eigen:
>    I started looking in the eispack C code and traced down the
> problem. In three of the four Fortran calls in eigen, (ch,rs,cg but
> not rg), the same vector (vals) is used for the return eigenvalues as
> for two or three temporary workspace vectors. This is risky
> programming at any time and leads to a catastrophe with a 586 where
> several things may be calculated at the same time. 

No, this is a bug in .Fortran.  Everything sent to C or FORTRAN code is
supposed to be a *copy* of the R object.  This is because R is allowed to
move things around in memory whenever it feels the urge, but C and FORTRAN
assume things stay fixed.  Since everything is supposed to be copied there
is no harm in using multiple copies of the same thing. 

One possible source of this bug is in naoktrim in src/main/dotcode.c
which begins
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 0;
                *len = 0;
        }
but should begin
static SEXP naoktrim(SEXP s, int * len, int *naok, int *dup)
{
        SEXP value;

        if(s == R_NilValue) {
                value = R_NilValue;
                *naok = 0;
                *dup = 1;
                *len = 0;
        }


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Tue Aug 26 00:49:40 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Tue, 26 Aug 1997 11:49:40 +1200 (NZST)
Subject: R-alpha: Can we "require"  1) GNU make,  2) Perl  -- for help "compiling"?
Message-ID: <199708252349.LAA23088@stat1.stat.auckland.ac.nz>

As for windows (I'm no expert though);
  perl is nicer than anything else and it's available on the mac as well.
  make is a bit of a moot point; all c compilers have a make but it is
  different and the whole notion of distributing patches etc doesn't
  seem to have caught on much in the windows environment so I don't think
  we should worry about it too much.
  
  
robert  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Aug 26 07:13:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 26 Aug 1997 08:13:55 +0200
Subject: R-alpha: Re:  barplot
Message-ID: <199708260613.IAA22900@aragorn.ci.tuwien.ac.at>

Did anyone have a quick look at my modified barplot?  I am waiting for
some kind of `OK' before I go on to convert the matrix case, too ...
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Aug 27 16:11:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 27 Aug 1997 17:11:50 +0200
Subject: R-alpha: (minor?) S/R inconsistency:  mode(unclass(terms(...)))
Message-ID: <199708271511.RAA00953@sophie.ethz.ch>

I just stumbled over the following :

  mode(utf <- unclass(tf <- terms( ~ (x + y + z)^2)))
  ## R:  "call"
  ## S:  "expression"

Don't know if/when this could be important.
It made a big difference for me, but this was in low-level
experimentation...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Aug 27 16:46:59 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 27 Aug 1997 17:46:59 +0200
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <199708271546.RAA00253@galadriel.ci.tuwien.ac.at>


With help by Kurt and Martin I have written a short proposal for a new
R doc source format that should be easier to parse using, e.g.,
perl. There should be especially a clearer distinction between text
and keywords.

Here we go, please make comments, corrections, etc.

Best,
Fritz

**********************************************************

Conversion:
-----------

A perl module providing functions to parse the source text which are
used by other functions to produce latex, html, etc. 


Environment delimiters:
-----------------------
Change from () to {} as in latex and most programming languages such
that `()' can be used in equations without need for escaping


Keywords:
---------
Start all keywords with a backslash like in latex, because IMO the
word TITLE should not be something special simply because it is
written in capital letters.

if possible, keep latex syntax whenever possible, e.g., replace
greekalpha with \alpha, LDOTS with \ldots, etc.


Unknown keywords are ignored and result in a warning message from the
parser.


Logical Blocks:
---------------

The current logical blocks of the source files such as

	TITLE(...)
	USAGE(...)
	ALIAS(...)
	ARGUMENTS(...)

are kept and the first step of parsing the file is splitting it into
these blocks.

Then the single blocks are parsed and splitted into their parts (like
ARG lists), the remaining parts should then be something like `Rdoc text'
which must only be correctly converted into the output language
(equations, bold font, ...).


VALUE(S)
--------

Here only one environment should be necessary, if it contains more
than one ARG environment, it is what's now VALUES.


New keywords:
-------------

	TITLE, USAGE, ...	\title{...}, \usage{...}, ...
	ARG			\arg{argname}{description}
	BOLD			\bf{word}
	ITALIC			\emph{word}
	LANG			\code{word}
	PARA			\par
	BLANK			\blank
	LINK			\link{...}
	DOTS			\dots
	LDOTS			\ldots
	EQUALS			\=       ???but why is this needed???
	LT			\lt
	GT			\gt
	...

replace all math constructs with latex commands

Equation commands:

	EQN()			\eqn{A1}{A2}   ??? or \eqn[A2]{A1} ???
	DEQN(A1 @@ A2)		\deqn{A1}{A2}

where A1 is pure latex and A2 is an ascii version of the formula. If
only one argument is given, A1 and A2 are taken to be the same (such
that we don't have to write \eqn{x}{x}). \eqn corresponds to latex's
$$ and \deqn corresponds to \[ \].


Hard line break
---------------

\cr gives a hard line break



Comments:
---------

Ignore everything after a `%', \% gives the corresponding
character. We don't use the usual # for comments, because # appears to
often in example environments.







=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plummer@iarc.fr  Thu Aug 28 08:13:37 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 28 Aug 1997 09:13:37 +0200
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>

At 17:53 27/08/97, friedrich.leisch@ci.tuwien.ac.at wrote:

>With help by Kurt and Martin I have written a short proposal for a new
>R doc source format that should be easier to parse using, e.g.,
>perl. There should be especially a clearer distinction between text
>and keywords.

What happened to the idea of using SGML for the new documentation
format?  
Martyn

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Aug 28 09:17:42 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 28 Aug 1997 20:17:42 +1200 (NZST)
Subject: R-alpha: Proposal for a new R doc source format
Message-ID: <199708280817.UAA18043@stat1.stat.auckland.ac.nz>

I think SGML was an idea I was pushing,  but I don't have the time
to pursue it.  I'm not sure that the required tools are out there
yet anyway.  Friedrich's proposal has the definite advantage that
it will happen.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Aug 28 15:14:14 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 28 Aug 1997 16:14:14 +0200
Subject: R-alpha: Proposal for a new R doc source format
In-Reply-To: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>
References: <3.0.1.16.19970828091337.095717ac@droopy.iarc.fr>
Message-ID: <199708281414.QAA01409@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 28 Aug 1997 09:13:37 +0200,
>>>>> Martyn Plummer wrote:

> At 17:53 27/08/97, friedrich.leisch@ci.tuwien.ac.at wrote:
>> With help by Kurt and Martin I have written a short proposal for a new
>> R doc source format that should be easier to parse using, e.g.,
>> perl. There should be especially a clearer distinction between text
>> and keywords.

> What happened to the idea of using SGML for the new documentation
> format?

Well, that's not too easy to explain ... first of all Kurt doesn't
like SGML (from his experience writing the FAQ in SGML) and he's my
boss, so I don't like it, too ;-)

More serious reasons:

1) More people writing R code will know LaTeX than SGML, so if we
have a LaTeX-like syntax it should be easier to learn. I want to keep
the new format as close to latex as possible such that it should be
very easy ...

2) Is the SGML-tools output not always really satisfying, and we would
have to extend the existing SGML formats anyway because it doesn't
support everything we want.

3) Is perl definetely on more systems installed than the sgml-tools.

For all this reasons (and some more which I don't remember right now)
I wouldn't like to make an R help system based on SGML, but if you
volunteer ...

Best,
Fritz

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 28 17:01:05 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 28 Aug 1997 12:01:05 -0400
Subject: R-alpha: pow_ii
Message-ID: <97Aug28.120241edt.26501@mailgate.bank-banque-canada.ca>


>> I'm a bit confused about this discussion, but since I don't have f2c on
...

>A lot of Fortran code doesn't require any libf2c routines.  When routines
>are needed the most common ones are the exponentiation routines pow_dd,
>pow_ii and pow_di (pow_ri is for single precision reals and so is less
>needed in R, which uses double precision).  However, *some* fortran code,
...

Thomas

>From your previous response to my confusion I guessed I would be ok
with pow_ii, but that does not seem to be the case:

R
...
>  dsecurve.function.tests(verbose=T) 
Random number generator tests ...ok
DSE curvature test 1 ... ld.so.1: /R/bin/R.binary: fatal: relocation error: symbol not found: pow_ii: referenced in /dse/dsefor.so
Killed

[4] /R : nm bin/R.binary | grep pow
[146]	|    244556|     312|FUNC |LOCL |0    |7      |complex_pow
[2557]	|   1462800|       0|FUNC |GLOB |0    |UNDEF  |pow
[2795]	|   1053360|      68|FUNC |GLOB |0    |7      |pow_dd
[2800]	|   1053124|     236|FUNC |GLOB |0    |7      |pow_di
[377]	|   1474036|       4|OBJT |LOCL |0    |15     |powerSymbol
[5] /R : 
[5] /R : R


This leads me to wonder how R calculates powers and exp for complex
numbers. I presume that if I can arrange to call the same routines then
I can avoid the extra burden of having to include parts of libf2c with
my distributed code. Do you know what R uses and can I call these from
fortran?

Paul Gilbert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Aug 28 19:36:10 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 28 Aug 1997 11:36:10 -0700 (PDT)
Subject: R-alpha: Re: pow_ii
In-Reply-To: <97Aug28.120241edt.26501@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.970828112057.7336A-100000@troi>

On Thu, 28 Aug 1997, Paul Gilbert wrote:

> Thomas
> 
> >From your previous response to my confusion I guessed I would be ok
> with pow_ii, but that does not seem to be the case:

No, pow_ii doesn't seem to be in there
 
> 
> This leads me to wonder how R calculates powers and exp for complex
> numbers. I presume that if I can arrange to call the same routines then
> I can avoid the extra burden of having to include parts of libf2c with
> my distributed code. Do you know what R uses and can I call these from
> fortran?

There is code in src/main/complex.c

This contains routines for powers, division and transcendental functions.
Unfortunately they are all declared static, so you can't use them. 

I don't know if there is any real need to make these static, apart from
tidiness (Anyone?) so it's possible that these could be changed in the
future.

Still, I liked Ross' suggestion of just making a f2c R package


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From pgilbert@bank-banque-canada.ca  Thu Aug 28 19:49:03 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 28 Aug 1997 14:49:03 -0400
Subject: R-alpha: HTML help
Message-ID: <97Aug28.145036edt.26508@mailgate.bank-banque-canada.ca>

Below is a copy of the script I mentioned a few days ago, and Kurt
suggested I should post. It takes as input a single file of all the
html formatted function help, divides this into single files with
non-descriptive but unique and dos8.3 compatable names, and generates
both name and title indexes. It also changes the "see also"
functions to be links to the appropriate place in the name index.
(This is a compromise which was easier to do then link directly to the
appropriate file.) 

If you want to see how this approach to help works, look at

http://www.bank-banque-canada.ca/pgilbert/help/dsehome.htm

The indexes are generated from two html "NAME" tags I have written into
the html files, one for the function name and one for the function
title. eg.

<A NAME=stability><H1>stability</H1></A>
<A NAME=CalculatestabilityofaTSmodel>Calculate stability of a TSmodel</A><BR><HR>

The "see also" links are generated from the HREF tag, eg.

<H2>See Also</H2>
<UL>
<A HREF="#stability">stability</A>
</UL>


I have used a convention of .htm instead of .html because I wanted this
to work in DOS too. (I just noticed this has not been done in the R
html help.)

The generated files have "dse" prefixed to indicate my library. I tried
to make the prefix variable, but so far I haven't had any luck.

Another convention I have found very useful in maintaining help is to
embed the help directly into my coded files using /* */ multi-line
style comments to separate it from code. I then run these files through
an awk filter to separate the help into one file and the code into a
second. This can be done with a modified source() function within R or
S. Before I started to use this convention I found that I was
duplicating much of the documentation into comments in the code, and in
fact the comments in the code were often much more accurate than the
help files.


Paul Gilbert

______
#!/bin/sh

if [ $# -ne 2 ]; then
  echo usage:
  echo "  build.HTML.help2  sourcefile targetlocation"
  echo "   where sourcefile is a file of all the HTML help and"
  echo "       targetlocation is the target directory"
  exit
fi 


# I haven't been able to get the variable substitution to work 
#    in some places where there are quotes
# PREFIX is added to the beginning of all generated help files
# PREFIX should not be more than 3 character for dos compliance
# PREFIX=dse

#intro is an html file used as the starting point for 
#   a browser (eg home.htm or index.htm)
#intro=dsehome.htm

tmphelp=$1
help=$2
mkdir -p $help
cd $help  

echo help directory set to $help
# This script expects to find the two files:
#     $tmphelp (all function help) and dsehome.htm (the introduction)
# The function help in the file $tmphelp is broken into individual files and
# an indexes built. $tmphelp is removed on completion.

# A function index is built from the <A NAME= ... ><H1> lines
# and  title index is built from the other <A NAME=  lines.
# These are put in the file dsefidx.htm and dsetidx.htm respectively

echo "number of NAME lines in $tmphelp " `grep NAME $tmphelp | wc -l`
echo "(The number of NAME lines is aprox. 2 times the number of help functions)"

#  Step 1 -  break up  functions into alphabetical sub-files.

sed  "s/<A NAME=\(.*\)><H1>\(.*\)/@<A NAME=\1><H1>\2/g" $tmphelp >zot2$$

# The next line converts line breaks to ; then converts @ to line breaks
tr '\012'  '\073' <zot2$$ | tr '@' '\012'  >zot3$$

echo "1st check: the number of help functions is about " `wc -l <zot3$$`

split -1 zot3$$ $help/dseH
rm zot2$$ zot3$$

echo "2nd check: the number of help functions is about " `ls -l dseH* | wc -l`


#  Step 2 - convert See Also references to point to the function index, eg:
# <A HREF="#TSmodel"> TSmodel</A>
# or
# <A HREF=#TSmodel> TSmodel</A>
# or
# <A HREF=TSmodel> TSmodel</A>

# to
# <A HREF="dsefidx.htm#TSmodel"> TSmodel</A>

# and first convert ; back to <cr>

for f in `ls dseH[a-z]*`
do
  tr '\073' '\012'<$f | sed 's/<A HREF="\(.*\)">\(.*\)/<A HREF="\1">\2/g' >zotaa
  sed 's/<A HREF="#\(.*\)">\(.*\)/<A HREF="#\1">\2/g' zotaa >zotbb
  sed 's/<A HREF="#\(.*\)">\(.*\)/<A HREF="dsefidx.htm#\1">\2/g' zotbb >$f.htm
  echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>$f.htm
  rm $f
done
rm  zotaa zotbb 

# Step 3 - build Function and Title indexes dsefidx.htm and dsetidx.htm

grep "<A NAME=" dseH[a-z]*.htm | grep -v "<H1>" >zotT$$
grep "<A NAME=" dseH[a-z]*.htm | grep "<H1>" >zotN$$

# build Index to functions by Name


echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR><A NAME=IndexbyFunctionName><H1>Index to Functions by Name</H1></A><HR><HR>' >dsefidx.htm

# use grep output of file name in eg
# dseHaa.htm:<A NAME=arma><H1>ARMA</H1></A>
#           \1              \2       \3

# to insert HREF links (but leave NAME for jump into index) eg
# <A NAME=->arma</A><A HREF=dse1.htm>ARMA</A><BR>
#            \2                \1       \3
 
sed 's/<H1>//g' zotN$$ | sed 's/<\/H1>//g' | sed 's/<HR>//g' | sed 's/<BR>//g' >zotN5$$
sed 's/\(.*\):<A NAME=\(.*\)>\(.*\)<\/A>/<A NAME=\2>-<\/A><A HREF=\1>\3<\/A><BR>/g' zotN5$$ >zotN6$$

sort -f <zotN6$$ >>dsefidx.htm
rm zotN[1-6]*$$

echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>dsefidx.htm


# build Index to functions by Title

echo '<HR><HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR><A NAME=IndexbyTitle><H1>Index to Functions by Title</H1></A><HR><HR>' >dsetidx.htm

sed "s/<HR>//g" zotT$$  >zotT2$$
sed "s/<BR>//g" zotT2$$ >zotT3$$
sed "s/\(.*\):<A NAME=\(.*\)>\(.*\)<\/A>/<A NAME=\2>-<\/A><A HREF=\1>\3<\/A><BR>/g" zotT3$$ >zotT4$$

sort -f <zotT4$$ >>dsetidx.htm
rm zotT[1-6]*$$

echo '<HR><A HREF="dsehome.htm#ToC">return to Table of Contents</A><HR>' >>dsetidx.htm

rm zot?$$
#  $tmphelp

echo "number of help functions in title index    " `wc -l <dsetidx.htm` "-2"
echo "number of help functions in function index " `wc -l <dsefidx.htm` "-2"
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Aug 29 17:47:26 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 29 Aug 1997 18:47:26 +0200
Subject: SUMMARY: R-alpha: Can we "require"  1) GNU make,  2) Perl
In-Reply-To: <Pine.SUN.3.95.970825094416.1542D-100000@avon> (message from
 Thomas Lumley on Mon, 25 Aug 1997 09:48:15 -0700 (PDT))
Message-ID: <199708291647.SAA08655@sophie.ethz.ch>

Just to 'clean up' the week,  a summary about my 'RFC' :

The reactions I got (not all went thru  R-devel):

1) perl is ok  (--> new 'R doc/man' format by Fritz Leisch & Kurt Hornik ...)

2) GNU make is not really ok.

 Some people like to use their vendor's make rather than GNU's
	[I myself have changed this behavior a few years ago;
	 here, we all PATH such that GNU's make comes BEFORE Sun's make ..]

==> I'll try not to rely on GNU make at all.

	[[Actually I haven't done too much yet, 
	  just created an  etc/Makefile and
	  moved things from $RHOME/Makefile there..]]


--- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Sun Aug 31 20:34:59 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Sun, 31 Aug 1997 12:34:59 -0700 (PDT)
Subject: R-alpha: ?bug in [.data.frame
In-Reply-To: <199708311138.NAA13464@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SOL.3.95.970831122953.22219B-100000@gorn>


If you subscript a data frame using the names of the columns and there is
more than one column with the same name only the first one is found.
eg
	mm<-data.frame(1:10,log(1:10))
	names(mm)<-c("(offset)","(offset)")
	mm[,"(offset)"]			# only returns first column
	mm[,"(offset)"]<-rep(1,10)	# only sets first column

This *is* compatible with S, but I still think it's the wrong thing to do.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Aug 31 21:11:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 31 Aug 1997 22:11:54 +0200
Subject: R-alpha: ?bug in [.data.frame
In-Reply-To: Thomas Lumley's message of Sun, 31 Aug 1997 12:34:59 -0700 (PDT)
References: <Pine.SOL.3.95.970831122953.22219B-100000@gorn>
Message-ID: <x2g1rq6rjp.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> If you subscript a data frame using the names of the columns and there is
> more than one column with the same name only the first one is found.
> eg
> 	mm<-data.frame(1:10,log(1:10))
> 	names(mm)<-c("(offset)","(offset)")
> 	mm[,"(offset)"]			# only returns first column
> 	mm[,"(offset)"]<-rep(1,10)	# only sets first column
> 
> This *is* compatible with S, but I still think it's the wrong thing to do.

This is a generic list thing. Nothing keeps you from having several
elements with the same name, you just get certain problems accessing
them. 

> l<-list(1,2,3)
> names(l)<-c("a","b","b")
> l
$a
[1] 1

$b
[1] 2

$b
[1] 3

> l$b
[1] 2

I rather strongly suspect that coding for the possibility, that in a
list of vectors l$b could mean another list, would be a real pain.
I.e. you deserve what you get...

If you must have identically named columns, try something along the
lines of

> l[names(l)=="b"]
$b
[1] 2

$b
[1] 3

> l[names(l)=="b"]<-4
> l
$a
[1] 1

$b
[1] 4

$b
[1] 4


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

