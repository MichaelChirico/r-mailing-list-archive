From bela_b at gmx.net  Tue Mar  1 12:27:36 2005
From: bela_b at gmx.net (Bela Bauer)
Date: Tue Mar  1 12:27:43 2005
Subject: [Rd] Re: [R] H-F corr.: covariance matrix for interaction effect
In-Reply-To: <x2ll98joa0.fsf@biostat.ku.dk>
References: <421C6A88.3030907@gmx.net>
	<x2psyrcr84.fsf@biostat.ku.dk>	<x2acptpiqm.fsf@biostat.ku.dk>
	<x2ll98joa0.fsf@biostat.ku.dk>
Message-ID: <422451A8.80102@gmx.net>

Peter Dalgaard wrote:
> Just in case anyone was wondering, I think I now know what SAS is
> doing, and yes, it is a bug. 

I was still wondering. :-)
Now, this is quite some interesting news, since everyone here has been 
relying on SAS H-F corrections, and I don't think they'll be amused to 
know that they might've been wrong.

I've been glancing over to Rd, but I didn't see anything about it - do 
you have any code yet that I could look at to figure out what you do? It 
doesn't need to be complete yet, just something that will tell me about 
the algorithm...

Thanks

Bela

From edd at debian.org  Tue Mar  1 14:17:36 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue Mar  1 14:17:46 2005
Subject: [Rd] Can crc32() assume to be available at the C level?
Message-ID: <16932.27504.50306.153858@basebud.nulle.part>


Dear R-develers,

Antoine Lucas suggested extending my small digest package (which provides md5
and sha-1 digests of R objects, which it are serialized if needed) with a
crc32 function, and provided a fairly complete patch.

We are now wondering if we should play it safe and bundle crc32.c (plus
utils) in the digest sources (as I do with md5 and sha1), or if we can assume
that crc32 is present on all R platforms thanks to zlib. 

Is that the case?  If so, is it a good idea to use it even though it doesn't
appear in the header files?  Or should we package "our" copy?

Thanks in advance for any advice, Dirk

-- 
Better to have an approximate answer to the right question than a precise 
answer to the wrong question.  --  John Tukey as quoted by John Chambers

From ripley at stats.ox.ac.uk  Tue Mar  1 15:57:11 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar  1 16:04:49 2005
Subject: [Rd] Can crc32() assume to be available at the C level?
In-Reply-To: <16932.27504.50306.153858@basebud.nulle.part>
References: <16932.27504.50306.153858@basebud.nulle.part>
Message-ID: <Pine.LNX.4.61.0503011326370.10692@gannet.stats>

On Tue, 1 Mar 2005, Dirk Eddelbuettel wrote:

> Antoine Lucas suggested extending my small digest package (which provides md5
> and sha-1 digests of R objects, which it are serialized if needed) with a
> crc32 function, and provided a fairly complete patch.
>
> We are now wondering if we should play it safe and bundle crc32.c (plus
> utils) in the digest sources (as I do with md5 and sha1), or if we can assume
> that crc32 is present on all R platforms thanks to zlib.
>
> Is that the case?  If so, is it a good idea to use it even though it doesn't
> appear in the header files?  Or should we package "our" copy?

It is present, but with --with-zlib options it could be in an external 
library and hence not exported by R.bin/libR.so. So I don't think you can 
rely on finding it.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pavel at stat.washington.edu  Wed Mar  2 08:08:03 2005
From: pavel at stat.washington.edu (Pavel N. Krivitsky)
Date: Wed Mar  2 08:04:55 2005
Subject: [Rd] Profiling C functions called from R.
In-Reply-To: <Pine.LNX.4.61.0502260757000.19634@gannet.stats>
References: <421FD69C.8000707@stat.washington.edu>
	<Pine.LNX.4.61.0502260757000.19634@gannet.stats>
Message-ID: <1109747283.24299.21.camel@Navi>

Hi,

Thank you for the reply. I think I've figured out the problem. In case
someone else might find this useful, the vanishing profile file turns
out to be the result of a semi-documented quirk (not in R). When using

LD_PROFILE=/$PATH_TO_LIB/$LIB_NAME.so R

the resulting $LIB_NAME.so.profile will be created
in /var/tmp/$PATH_TO_LIB/

_only_if_ /var/tmp/$PATH_TO_LIB/ already exists. If it doesn't, it'll
give an error message (that got buried in other output in my case) and
no profile will be created. If LD_PROFILE_OUTPUT is used to control
where the profile file goes:

export LD_PROFILE=/$PATH_TO_LIB/$LIB_NAME.so
export LD_PROFILE_OUPUT=/$PUT_PROFILE_HERE/
R
unset LD_PROFILE
unset LD_PROFILE_OUTPUT

then $LIB_NAME.so.profile will be created
in /$PUT_PROFILE_HERE/$PATH_TO_LIB/ again, only if the directory already
exists.

                             Thanks,
                             Pavel Krivitsky

From sfalcon at fhcrc.org  Wed Mar  2 16:45:43 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed Mar  2 16:45:56 2005
Subject: [Rd] Error on Windows installing package to non-default library
Message-ID: <f7b20e1a30ed3a6718958be5f784c7b7@fhcrc.org>

Hi all,

I'm seeing an error on Windows when I try to install a package to a 
package library path that starts with a digit.  I can reproduce the 
error as follows using R-devel from Feb 24 on Windows advanced server:

badLib = "c:\\badExample\\2\\foo"
dir.create(badLib, recursive=TRUE)
z = .libPaths()
z = .libPaths(c(badLib, z))
z
[1] "c:\\badExample\\2\\foo"         "C:/falcon/sw/rw2010dev/library"

pkg = "c:\\falcon\\abind_1.1-0.zip"
install.packages(pkg, repos=NULL, lib=badLib)
package 'abind' successfully unpacked and MD5 sums checked
updating HTML package descriptions
Error in gsub("^URL: ../../../library", lib0, readLines(cfile)) :
         invalid backreference 2 in regular expression

After looking at src/library/utils/R/windows/linkhtml.R, it seems the 
error is that the "\\2" part of the path is interpreted by gsub as a 
back reference.

Changing "\\" to "/" in the library path fixes this issue:

 > okLib = chartr("\\", "/", badLib)
 > z = .libPaths(okLib)
 > z
[1] "c:/badExample/2/foo"            "C:/falcon/sw/rw2010dev/library"
 > install.packages(pkg, repos=NULL, lib=okLib)
package 'abind' successfully unpacked and MD5 sums checked
updating HTML package descriptions

So adding a call to chartr inside make.search.html would seem to be an
improvement (i.e, it looks good from here, but I haven't tested and
don't know if there are reasons why this would be a bad idea).  OTOH,
maybe this should have already happened in the call to .libPaths()?

This came up because on the Windows server I'm using, tempdir() 
contains a directory names "2" as part of the path --- and I want to be 
able to install package to temporary package libraries for testing 
purposes.

+ seth

From ripley at stats.ox.ac.uk  Wed Mar  2 17:54:47 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar  2 17:54:58 2005
Subject: [Rd] Error on Windows installing package to non-default library
In-Reply-To: <f7b20e1a30ed3a6718958be5f784c7b7@fhcrc.org>
References: <f7b20e1a30ed3a6718958be5f784c7b7@fhcrc.org>
Message-ID: <Pine.LNX.4.61.0503021647410.28991@gannet.stats>

You can't please everyone all the time, and in this case you cannot just 
make the substitution as

1) some parts of Windows demand \
2) \ is a trail byte in some Japanese characters.

Why don't you just ensure that you don't use such paths for .libPaths()?

On Wed, 2 Mar 2005, Seth Falcon wrote:

> Hi all,
>
> I'm seeing an error on Windows when I try to install a package to a package 
> library path that starts with a digit.  I can reproduce the error as follows 
> using R-devel from Feb 24 on Windows advanced server:
>
> badLib = "c:\\badExample\\2\\foo"
> dir.create(badLib, recursive=TRUE)
> z = .libPaths()
> z = .libPaths(c(badLib, z))
> z
> [1] "c:\\badExample\\2\\foo"         "C:/falcon/sw/rw2010dev/library"
>
> pkg = "c:\\falcon\\abind_1.1-0.zip"
> install.packages(pkg, repos=NULL, lib=badLib)
> package 'abind' successfully unpacked and MD5 sums checked
> updating HTML package descriptions
> Error in gsub("^URL: ../../../library", lib0, readLines(cfile)) :
>        invalid backreference 2 in regular expression
>
> After looking at src/library/utils/R/windows/linkhtml.R, it seems the error 
> is that the "\\2" part of the path is interpreted by gsub as a back 
> reference.
>
> Changing "\\" to "/" in the library path fixes this issue:
>
>> okLib = chartr("\\", "/", badLib)
>> z = .libPaths(okLib)
>> z
> [1] "c:/badExample/2/foo"            "C:/falcon/sw/rw2010dev/library"
>> install.packages(pkg, repos=NULL, lib=okLib)
> package 'abind' successfully unpacked and MD5 sums checked
> updating HTML package descriptions
>
> So adding a call to chartr inside make.search.html would seem to be an
> improvement (i.e, it looks good from here, but I haven't tested and
> don't know if there are reasons why this would be a bad idea).  OTOH,
> maybe this should have already happened in the call to .libPaths()?
>
> This came up because on the Windows server I'm using, tempdir() contains a 
> directory names "2" as part of the path --- and I want to be able to install 
> package to temporary package libraries for testing purposes.
>
> + seth
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From sfalcon at fhcrc.org  Wed Mar  2 21:11:08 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed Mar  2 21:11:19 2005
Subject: [Rd] Error on Windows installing package to non-default library
In-Reply-To: <Pine.LNX.4.61.0503021647410.28991@gannet.stats>
References: <f7b20e1a30ed3a6718958be5f784c7b7@fhcrc.org>
	<Pine.LNX.4.61.0503021647410.28991@gannet.stats>
Message-ID: <0a2b66c907ad2ef8ff1915dd2c7822e9@fhcrc.org>


On Mar 2, 2005, at 8:54 AM, Prof Brian Ripley wrote:

> You can't please everyone all the time, and in this case you cannot 
> just make the substitution as
>
> 1) some parts of Windows demand \
> 2) \ is a trail byte in some Japanese characters.

I had a feeling it wouldn't be so simple, but wanted to bring it up in 
case...

>
> Why don't you just ensure that you don't use such paths for 
> .libPaths()?

Will do.

Thanks,

+ seth

From cupright at earthlink.net  Wed Mar  2 21:50:57 2005
From: cupright at earthlink.net (Craig Barton Upright)
Date: Wed Mar  2 21:51:09 2005
Subject: [Rd] Processing files with AlphaX and R 2.0.1
Message-ID: <531.1109796657.2@craig-barton-uprights-computer.local>

I am a volunteer developer for the text editor AlphaX

<http://alphatcl.sourceforge.net/wikit/>

and the author/maintainer of its "S+/R" mode.  We recently received this
note from a user:

>>>>>>>>

I am trying to process files written and edited in AlphaXb16 through R
v2.0.1.  This has worked previously under the last version of AlphaX and
R 1.9.1.

Now when I select 'Process File' under the S+/R menu, the program
switches to R and the file is pasted into a new edit window in R, rather
than the contents being processed by R, which is what happened with
earlier versions.

I am not able to figure out how to get the previous, desirable behavior
back.  Any suggestions on how to proceed?

>>>>>>>>

AlphaX's "Process File" command uses a very generic AppleEvent to send
and "open" the file in R, using the "TclAE" API created by Jon Guyer.

<http://www.sourceforge.net/projects/tclae/>

This API does allow for more sophisticated AppleEvents to be constructed
and passed on.  I've searched the Release Notes announcements available
for R 2.0.0 and R 2.0.1

<https://stat.ethz.ch/pipermail/r-announce/2004/000792.html>
<https://stat.ethz.ch/pipermail/r-announce/2004/000795.html>

but I don't see any mention of how inter-application protocols might
have changed in version 2.x of R. If there is a better place for me to
look, please send along that url.  Or (even better) if there is some
documentation for AE interactions, I'll take a look at that as well.

cheers,

Craig Barton Upright

From cupright at earthlink.net  Wed Mar  2 22:17:43 2005
From: cupright at earthlink.net (Craig Barton Upright)
Date: Wed Mar  2 22:17:53 2005
Subject: [Rd] Processing files with AlphaX and R 2.0.1
Message-ID: <531.1109798263.12@craig-barton-uprights-computer.local>

I've been instructed to consult the "R-sig-mac" list for further
information -- sorry for the noise.

-- Craig

From p.dalgaard at biostat.ku.dk  Wed Mar  2 22:35:51 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Mar  2 22:41:53 2005
Subject: [Rd] R 2.1.0 scheduled for April 18
Message-ID: <x2k6opivd4.fsf@biostat.ku.dk>


The release schedule has now been set with a release date on April 18.

The detailed procedure can be found at http://developer.r-project.org/
(it is not quite there yet, but will appear after a short propagation
delay.) 

The main point for non-developers is that we start making alpha
tarballs on March 21 and beta tarballs on April 4. Only very simple
and/or critical bugs are fixed in the last week before release.

As usual, we encourage users to build and test the pre-release, and
help us find and fix bugs before rather than immediately after the
release.

        For the R Core Team
        Peter Dalgaard


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From martin at ist.org  Thu Mar  3 13:58:17 2005
From: martin at ist.org (Martin Keller-Ressel)
Date: Thu Mar  3 14:00:19 2005
Subject: [Rd] Underscore character in Rd files
Message-ID: <opsm2bnfg9coyqna@mail.ist.org>

Hi,

I'm trying to document a data frame in Rd format. The data frame contains  
a variable called
'Health_Env'. When I create a template for the Rd file using 'prompt()'  
the variable name is
included as-is and when I run R CMD CHECK I get a latex error because  
latex considers '_' a special character (used for subscripts) which is  
only allowed in math mode.
When I replace the variable name with 'Health\_Env' in the Rd file latex  
runs fine, but I get a codoc-mismatch warning because the backslash is not  
part of the variable name in the data frame.
Is there a way to completely satisfy R CMD CHECK in this case and avoid  
both errors and warnings??

I'm using

> version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    0.0
year     2004
month    10
day      04
language R


best regards,

Martin Keller-Ressel

--

From jtk at cmp.uea.ac.uk  Thu Mar  3 15:05:09 2005
From: jtk at cmp.uea.ac.uk (Jan T. Kim)
Date: Thu Mar  3 14:08:29 2005
Subject: [Rd] Connection Programming API (was: R 2.1.0 scheduled for April
	18)
In-Reply-To: <x2k6opivd4.fsf@biostat.ku.dk>
References: <x2k6opivd4.fsf@biostat.ku.dk>
Message-ID: <20050303140509.GA26727@jtkpc.cmp.uea.ac.uk>

On Wed, Mar 02, 2005 at 10:35:51PM +0100, Peter Dalgaard wrote:
> The release schedule has now been set with a release date on April 18.
> 
> The detailed procedure can be found at http://developer.r-project.org/
> (it is not quite there yet, but will appear after a short propagation
> delay.) 

Are there any plans on providing an API that would allow packages to
create and handle connections, before the "grand feature freeze"?

The reason I ask is that I recently submitted a patch that adds
filtering data through pipes to the core code. I had to write this
as a patch because connection handling is done in a static array
in src/main/connections.c and there is no API allowing packages to
operate on that array.

Will R 2.1.0 include filtering? And perhaps also forking, while we're
at this?

Best regards, Jan
-- 
 +- Jan T. Kim -------------------------------------------------------+
 |    *NEW*    email: jtk@cmp.uea.ac.uk                               |
 |    *NEW*    WWW:   http://www.cmp.uea.ac.uk/people/jtk             |
 *-----=<  hierarchical systems are for files, not for humans  >=-----*

From ripley at stats.ox.ac.uk  Thu Mar  3 14:24:08 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar  3 14:24:20 2005
Subject: [Rd] Underscore character in Rd files
In-Reply-To: <opsm2bnfg9coyqna@mail.ist.org>
References: <opsm2bnfg9coyqna@mail.ist.org>
Message-ID: <Pine.LNX.4.61.0503031320390.7954@gannet.stats>

On Thu, 3 Mar 2005, Martin Keller-Ressel wrote:

> Hi,
>
> I'm trying to document a data frame in Rd format. The data frame contains a 
> variable called
> 'Health_Env'. When I create a template for the Rd file using 'prompt()' the 
> variable name is
> included as-is and when I run R CMD CHECK I get a latex error because latex 
> considers '_' a special character (used for subscripts) which is only allowed 
> in math mode.
> When I replace the variable name with 'Health\_Env' in the Rd file latex runs 
> fine, but I get a codoc-mismatch warning because the backslash is not part of 
> the variable name in the data frame.
> Is there a way to completely satisfy R CMD CHECK in this case and avoid both 
> errors and warnings??

Don't use _ in the \name field (as documented in `Writing R Extensions' 
for your version), or update your R: from the NEWS of R-devel (development 
releases available on CRAN for Windows)

     o	There are no longer any restrictions on characters in the
 	\name{} field of a .Rd file: in particular _ is supported.

> I'm using
>
>> version
>         _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    0.0
> year     2004
> month    10
> day      04
> language R


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From admin at ordo.org  Thu Mar  3 08:58:06 2005
From: admin at ordo.org (admin@ordo.org)
Date: Fri Mar  4 02:02:11 2005
Subject: [Rd] (no subject)
Message-ID: <200503030800.j238007L024868@hypatia.math.ethz.ch>

无法将您的邮件投递至以下指定地址:
jane@ordo.org : 投递失败, 帐号不存在.


//----------------------------------------------------------
Received: from [218.107.132.252]; Thu, 3 Mar 2005 15:57:54 +0800
From: r-devel@lists.r-project.org
To: jane@ordo.org
Subject: 
Date: Thu, 3 Mar 2005 15:59:28 +0800
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundaryX-Priority: 3
X-MSMail-Priority: Normal

This is a multi-part message in MIME format.

------Content-Type: text/plain;
	charsetContent-Transfer-Encoding: 7bit

It's the long-awaited film version of the Broadway hit. The  message  sent as  a binary attachment.


------Content-Type: application/octet-stream;
	nameContent-Transfer-Encoding: base64
Content-Disposition: attachment;
	filename
UEsDBAoAAAAAAG4/YzJilfOsAFICAABSAgAIAAAAYm9keS5zY3JNWpAAAwAAAAQAAAD//wAAuAAA
AAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADoAAAADh+6DgC0Cc0huAFM
zSFUaGlzIHByb2dyYW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZS4NDQokAAAAAAAAAKk09Tjt
VZtr7VWba+1Vm2u0dohr71Wba5ZJl2vvVZtrbkmVa/9Vm2sFSpFrsVWba49KiGv8VZtr7VWaa1hV
m2sFSpBrwVWba1JpY2jtVZtrAAAAAAAAAAAAAAAAAAAAAAAAAAAYWRh4UEUAAEwBCgBq9P8+AAAA
AAAAAADgAA8BCwEGAADwAAAA0AMAAAAAAAFABQAAEAAAAAABAAAAQAAAEAAAAAIAAAQAAAAAAAAA
BAAAAAAAAAAAcAUAABAAAPFlAgACAAAAAAAQAAAQAAAAABAAABAAAAAAAAAQAAAAAAAAAAAAAAAc
UgUALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMRQBQAIAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAEAAudGV4dAAAAADwAAAAEAAAAJQAAAAQAAAAAAAAAAAAAAAAAABAAADALnJkYXRhAAAAIAAA
AAABAAASAAAApAAAAAAAAAAAAAAAAAAAQAAAwC5kYXRhAAAAALADAAAgAQAAYgEAALYAAAAAAAAA
AAAAAAAAAEAAAMAuamRwYWNrAAAQAAAA0AQAAAoAAAAYAgAAAAAAAAAAAAAAAABAAADALmFzcGFj
awAAIAAAAOAEAAAOAAAAIgIAAAAAAAAAAAAAAAAAQAAAwC5kYXRhAAAAABAAAAAABQAAAAAAADAC
AAAAAAAAAAAAAAAAAEAAAMAuYXNwYWNrAAAgAAAAEAUAAA4AAAAwAgAAAAAAAAAAAAAAAABAAADA
LmRhdGEAAAAAEAAAADAFAAAAAAAAPgIAAAAAAAAAAAAAAAAAQAAAwC5hc3BhY2sAACAAAABABQAA
FAAAAD4CAAAAAAAAAAAAAAAAAEAAAMAuZGF0YQAAAAAQAAAAYAUAAAAAAABSAgAAAAAAAAAAAAAA
AABAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMoMAApoDKoALHG22sjbbc3G21kORsZHNzI2s
jkyTI2txsZFuNttijeUJ2hOUJ2jOfz6veUJ2/757rVIejzXhkUBAVNhf/yJUknvOYCPVMPWmCNyt

From webster at ryanairmail.com  Fri Mar  4 10:07:36 2005
From: webster at ryanairmail.com (webster@ryanairmail.com)
Date: Fri Mar  4 10:07:45 2005
Subject: [Rd] Free flights in April (PR#7714)
Message-ID: <20050304090736.667B8BB2C@slim.kubism.ku.dk>


Subscribers to Ryanair.com are getting first option on
thousands of free flights in April 

We have 37 routes with free flights in April, just pay 
the taxes, fees and charges.

Book only on http://www.ryanair.com before midnight 
Monday 7 March 
 
Travel between 5 April and 27 April inclusive on
Mondays to Thursday inclusive, some free seats
available on weekend dates on certain routes.


To and From London Luton
******************************
Dinard
Esbjerg
Venice Treviso

To and From London Stansted
*********************************

Pescara
Kerry
Blackpool
Klagenfurt
Carcassonne
Dinard
Nimes
Poitiers
Rochefort
La Rochelle
Rodez
Tours
Valladolid
Zaragoza
Karlsruhe Baden
Frankfurt Hahn
Dusseldorf Weeze
Malmo

To and From Glasgow Prestwick
***********************************
Hamburg Lubeck
Shannon
Bournemouth
 
To and From Frankfurt Hahn
*******************************
Riga
Santander
Klagenfurt
Bologna Forli
Gothenburg
Stockholm Skavsta

To and From Stockholm Skavsta
************************************
Riga
Dusseldorf Weeze
Frankfurt Hahn

To and From Tampere
*************************
Riga

To and From Milan Bergamo
*******************************
Newcastle
Zaragoza


Offer subject to availability, terms and conditions apply

For Special Hertz car hire rates book 
on http://www.ryanair.com/redirect/hertzredirect.html

For discounted hotel offers in all Ryanair destinations 
visit http://www.ryanairhotels.com

For great value Activity Break holidays, book online at
www.activitybreaks.com/ryanair





















=====================================================================

E-MAIL DISCLAIMER

This e-mail and any files and attachments transmitted with it 
are confidential and may be legally privileged. They are intended 
solely for the use of the intended recipient.  Any views and 
opinions expressed are those of the individual author/sender 
and are not necessarily shared or endorsed by Ryanair Holdings plc 
or any associated or related company. In particular e-mail 
transmissions are not binding for the purposes of forming 
a contract to sell airline seats, directly or via promotions, 
and do not form a contractual obligation of any type.   
Such contracts can only be formed in writing by post or fax, 
duly signed by a senior company executive, subject to approval 
by the Board of Directors.

The content of this e-mail or any file or attachment transmitted 
with it may have been changed or altered without the consent 
of the author.  If you are not the intended recipient of this e-mail, 
you are hereby notified that any review, dissemination, disclosure, 
alteration, printing, circulation or transmission of, or any 
action taken or omitted in reliance on this e-mail or any file 
or attachment transmitted with it is prohibited and may be unlawful.

If you have received this e-mail in error 
please notify Ryanair Holdings plc by emailing postmaster@ryanair.ie
or contact Ryanair Holdings plc, Dublin Airport, Co Dublin, Ireland.  

---
You are currently subscribed to customers as: r-bugs@r-project.org
To unsubscribe send a blank email to leave-customers-101677917Y@mail.ryanairmail.com
You are subscribed to  as r-bugs@r-project.org. 
To unsubscribe, send a blank email to leave-customers-101677917Y@mail.ryanairmail.com

From rgentlem at fhcrc.org  Fri Mar  4 17:13:46 2005
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Fri Mar  4 17:14:05 2005
Subject: [Rd] eapply weirdness/bug
In-Reply-To: <Pine.LNX.4.61.0502201056060.6368@itasca2.stat.uiowa.edu>
References: <4D99275E380CA94F998977EDACE548DC074AAC@extas2-hba.tas.csiro.au>
	<x2vf8q5k3a.fsf@biostat.ku.dk>
	<Pine.LNX.4.61.0502180821170.3177@itasca2.stat.uiowa.edu>
	<x23bvtdha6.fsf@biostat.ku.dk>
	<Pine.LNX.4.61.0502181029410.7043@nokomis.stat.uiowa.edu>
	<x2vf8ojasn.fsf@biostat.ku.dk>
	<Pine.LNX.4.61.0502201056060.6368@itasca2.stat.uiowa.edu>
Message-ID: <6331774F-8CC8-11D9-8AEC-000D933DC9FE@fhcrc.org>

This should be fixed in the most recent archives - it will take some  
time to propagate
(the .Internal version has been retained )

On Feb 20, 2005, at 8:58 AM, Luke Tierney wrote:

> On Sat, 20 Feb 2005, Peter Dalgaard wrote:
>
>> Luke Tierney <luke@stat.uiowa.edu> writes:
>>
>>> For this specific case though, I _think_ the semantics we want is  
>>> this:
>>>
>>>      eapply1 <- function(env, FUN, ..., all.names = FALSE) {
>>>  	FUN <- match.fun(FUN)
>>>  	lapply(.Internal(env2list(env, all.names)), FUN, ...)
>>>      }
>>>
>>> Not passing the ... in the current implementation is, I think, an
>>> oversight, as is the extra evaluation that occurs.  Given that lapply
>>> is already internal I'm not sure there really is very much benefit in
>>> having the internal eapply.  If not I'd prefer to replace it by
>>> something like this; if there are reasons for keeping the .Internal  
>>> we
>>> can work on replicating these semantics as closely as possible.  I
>>> think Robert is the one who would know the issues.
>>
>> I agree on the semantics (I didn't quite think of the consequences of
>> FUN doing an eval.parent and things like that before). But if
>> implemented literally, wouldn't that env2list cause some undesirable
>> copying? I have the impression that people interested in eapply use
>> their environments to hold some pretty large objects. So maybe we
>> should stick with the get()-based version
>>
>>      eapply2 <- function(env, FUN, ..., all.names = FALSE) {
>>       FUN <- match.fun(FUN)
>>       nm <- ls(envir=env,all.names=all.names)
>>       FUN2 <- function(name,...)FUN(get(name),...)
>>       lapply(nm, FUN2, ...)
>>      }
>
> The copying issue is a good point--Robert also reminded me of this.  I
> _think_ the approach based on env2list would be OK but I'd have to
> check very caerfully to be sure.  Rather than spend time doing that I
> think this argues for keeping the .Internal varsion and modifying it
> to obtain the semantics we want.  I'll look into that.
>
> luke
>
> --  
> Luke Tierney
> University of Iowa                  Phone:             319-335-3386
> Department of Statistics and        Fax:               319-335-3017
>    Actuarial Science
> 241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
+----------------------------------------------------------------------- 
----------------+
| Robert Gentleman              phone: (206) 667-7700                    
          |
| Head, Program in Computational Biology   fax:  (206) 667-1319   |
| Division of Public Health Sciences       office: M2-B865               
       |
| Fred Hutchinson Cancer Research Center                                 
          |
| email: rgentlem@fhcrc.org                                              
                          |
+----------------------------------------------------------------------- 
----------------+

From murdoch at stats.uwo.ca  Fri Mar  4 19:09:47 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Mar  4 19:09:55 2005
Subject: [Rd] Does anyone care about "wait" in Windows bug.report()?
Message-ID: <4p8h21hqgukdhfrfkbij80615ftbv25au3@4ax.com>

Since the internal editor was added in 2.0.0, the bug.report()
function has failed to run properly with it (and it's the default
editor on a new install).  The fix for this is simple (use file.edit()
instead of constructing a system call to call the editor), but
file.edit() doesn't support the "wait" parameter that bug.report()
currently has on Windows.

Rather than adding "wait" to file.edit(), I'd rather remove it from
bug.report().  Will anyone object if I do this?

Duncan Murdoch

From Georg.Roth at pubhealth.ku.dk  Sat Mar  5 21:53:58 2005
From: Georg.Roth at pubhealth.ku.dk (Georg.Roth@pubhealth.ku.dk)
Date: Sat Mar  5 21:54:06 2005
Subject: [Rd] spatstat on Win98 (PR#7715)
Message-ID: <20050305205358.1421AB28A@slim.kubism.ku.dk>

Full_Name: Georg Roth
Version: R.2.0.1.for Windows
OS: Win98
Submission from: (NULL) (134.95.43.165)


Using libraries "spatstat" and "sm" on R.2.0.1. under Windows 98

bug 1)
the libraries "spatstat" and "sm" are not properly identified by the 
"library()" command on R.2.0.1. (R for Windows98). the libraryname is shown in 
upper case ("SPATSTAT") although the original name is in lower case
("spatstat")
and no good commentary is available - instead the returned commentary in both
cases 
reads "**No title available (pre-2.0.0.install?)".

i suppose the following problem to be connected with the first bug:

bug 2)
it is impossible to load the two the libraries "spatstat" and "sm" with the 
command "library(libraryname)". using different versions like
"library("SPATSTAT")",  "library("spatstat")", or "library(spatstat)" and the
like.

the same copies of the two libraries work fine in R.2.0.1. on a Windows2000 PC

From Georg.Roth at uni-koeln.de  Sat Mar  5 22:03:49 2005
From: Georg.Roth at uni-koeln.de (Georg.Roth@uni-koeln.de)
Date: Sat Mar  5 22:03:57 2005
Subject: [Rd] spatstat(2) (PR#7716)
Message-ID: <20050305210349.DC38DB28A@slim.kubism.ku.dk>

Full_Name: Georg Roth
Version: R.2.0.1.
OS: 
Submission from: (NULL) (134.95.43.165)


Sorry, forgot my mailadress...

From ligges at statistik.uni-dortmund.de  Sun Mar  6 12:10:46 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Sun Mar  6 12:10:54 2005
Subject: [Rd] spatstat on Win98 (PR#7715)
Message-ID: <20050306111046.CA8BEB273@slim.kubism.ku.dk>

Georg.Roth@pubhealth.ku.dk wrote:

> Full_Name: Georg Roth
> Version: R.2.0.1.for Windows
> OS: Win98
> Submission from: (NULL) (134.95.43.165)


You have submitted two bug reports with two different PR#. Please don't 
do that!


> Using libraries "spatstat" and "sm" on R.2.0.1. under Windows 98

You are talking about *packages*.


> bug 1)
> the libraries "spatstat" and "sm" are not properly identified by the 
> "library()" command on R.2.0.1. (R for Windows98). the libraryname is shown in 
> upper case ("SPATSTAT") although the original name is in lower case
> ("spatstat")

So the *package* name is shown in uppercase?


> and no good commentary is available - instead the returned commentary in both
> cases 
> reads "**No title available (pre-2.0.0.install?)".

Are these the most recent version of the packages? Version numbers? Are 
these compiled for R-2.0.1? Did you download the binary versions from 
CRAN for R-2.0.x? Or do you use self-compiled ones?

Please be more precise when submitting bug reports!



> i suppose the following problem to be connected with the first bug:
> 
> bug 2)
> it is impossible to load the two the libraries "spatstat" and "sm" with the 
> command "library(libraryname)". using different versions like
> "library("SPATSTAT")",  "library("spatstat")", or "library(spatstat)" and the
> like.

And what does the error message (that one for "library("spaatstat")) 
tell you? Please be more precise when submitting bug reports!


> the same copies of the two libraries work fine in R.2.0.1. on a Windows2000 PC

Are you really sure?
I guess that the copies are NOT identical, maybe same version number, 
but at least one (the Win98 one) compiled for R < 2.0.0.
I do not have any DOS based Windows version around to test, so we need 
the details.

Uwe Ligges


> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From znmeb at cesmail.net  Mon Mar  7 09:08:28 2005
From: znmeb at cesmail.net (znmeb@cesmail.net)
Date: Mon Mar  7 09:08:36 2005
Subject: [Rd] "make check-all" fails on R-devel 2005/03/07 (PR#7718)
Message-ID: <20050307080828.6DFF78709@slim.kubism.ku.dk>

Full_Name: Ed Borasky
Version: R-devel 2005/03/07
OS: Gentoo Linux
Submission from: (NULL) (24.21.54.168)


How to reproduce:

1. Download R-devel.tar.bz2 (the one I have is 2005/03/07)
2. Unpack it
3. Type

   ./configure --prefix=/opt 2>&1 | tee configure.log
   make 2>&1 | tee make.log
   make check-all 2>&1 | tee make-check-all.log

running tests of LAPACK-based functions
make[3]: Entering directory `/home/znmeb/R-devel/tests'
running code in 'lapack.R' ... OK
make[3]: Leaving directory `/home/znmeb/R-devel/tests'
make[2]: Leaving directory `/home/znmeb/R-devel/tests'
make[2]: Entering directory `/home/znmeb/R-devel/tests'
running tests of NA handling functions
make[3]: Entering directory `/home/znmeb/R-devel/tests'
running code in 'nafns.R' ...make[3]: *** [nafns.Rout] Error 1
make[3]: Leaving directory `/home/znmeb/R-devel/tests'
make[2]: *** [test-Nafns] Error 2
make[2]: Leaving directory `/home/znmeb/R-devel/tests'
make[1]: *** [test-all-devel] Error 1
make[1]: Leaving directory `/home/znmeb/R-devel/tests'
make: *** [check-all] Error 2
bash-2.05b$      

I have the complete logs if you want them. This same sequence worked fine with
R-patched dated 2005/03/07. The system is Gentoo Linux (gcc-3.3.5,
glibc-2.3.4.20040808-r1, 2.6.10-gentoo-r7 i686)

From ripley at stats.ox.ac.uk  Mon Mar  7 09:22:34 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Mar  7 09:22:47 2005
Subject: [Rd] "make check-all" fails on R-devel 2005/03/07 (PR#7718)
In-Reply-To: <20050307080828.6DFF78709@slim.kubism.ku.dk>
References: <20050307080828.6DFF78709@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503070812380.3106@gannet.stats>

What platform is this?: `Gentoo Linux' is too vague.  Please investigate 
the failure and follow-up with the details (there should be a 
tests/nafns.Rout.fail file).

NB: we are not seeing a problem on FC3 Linux under i686 or x86_64 or under 
Windows or Solaris.

On Mon, 7 Mar 2005 znmeb@cesmail.net wrote:

> Full_Name: Ed Borasky
> Version: R-devel 2005/03/07
> OS: Gentoo Linux
> Submission from: (NULL) (24.21.54.168)
>
>
> How to reproduce:
>
> 1. Download R-devel.tar.bz2 (the one I have is 2005/03/07)



> 2. Unpack it
> 3. Type
>
>   ./configure --prefix=/opt 2>&1 | tee configure.log
>   make 2>&1 | tee make.log
>   make check-all 2>&1 | tee make-check-all.log
>
> running tests of LAPACK-based functions
> make[3]: Entering directory `/home/znmeb/R-devel/tests'
> running code in 'lapack.R' ... OK
> make[3]: Leaving directory `/home/znmeb/R-devel/tests'
> make[2]: Leaving directory `/home/znmeb/R-devel/tests'
> make[2]: Entering directory `/home/znmeb/R-devel/tests'
> running tests of NA handling functions
> make[3]: Entering directory `/home/znmeb/R-devel/tests'
> running code in 'nafns.R' ...make[3]: *** [nafns.Rout] Error 1
> make[3]: Leaving directory `/home/znmeb/R-devel/tests'
> make[2]: *** [test-Nafns] Error 2
> make[2]: Leaving directory `/home/znmeb/R-devel/tests'
> make[1]: *** [test-all-devel] Error 1
> make[1]: Leaving directory `/home/znmeb/R-devel/tests'
> make: *** [check-all] Error 2
> bash-2.05b$
>
> I have the complete logs if you want them. This same sequence worked fine with
> R-patched dated 2005/03/07. The system is Gentoo Linux (gcc-3.3.5,
> glibc-2.3.4.20040808-r1, 2.6.10-gentoo-r7 i686)
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From becker at kfs.oeaw.ac.at  Mon Mar  7 09:35:39 2005
From: becker at kfs.oeaw.ac.at (becker@kfs.oeaw.ac.at)
Date: Mon Mar  7 09:35:47 2005
Subject: [Rd] R crashes using the em function of package mclust (PR#7719)
Message-ID: <20050307083539.1F66DB273@slim.kubism.ku.dk>

Hi,

I got the same problem like
http://tolstoy.newcastle.edu.au/R/devel/04/11/1204.html

R crashes when I use the em function from the mclust package on 
univariate data and on a special case on bivariate data (when the matrix 
is not provided as written in the manual).
It seems as if the problem is the format of the data to be analyzed.

Operating System: Windows XP (SP2)
R version: R-2.0.1

The following example causes a crash of R:

# univariate example
require(mclust)
X <- c(rnorm(100, mean=1), rnorm(100, mean=5))
# I also tried: X <- as.matrix(c(rnorm(100, mean=1), rnorm(100, mean=5)))
Xmap <- cbind(c(rep(1, 100), rep(0, 100)), c(rep(0, 100), rep(1, 100)))
Xm <- mstep(modelName="V", data=X, z=Xmap)
# CRASH:
em(modelName=Xm$modelName, data=X, mu=Xm$mu, sigmasq=Xm$sigmasq, pro=Xm$pro)

For bivariate data the following example works:

# bivariate example
require(mclust)
Y <- as.matrix(cbind(c(rnorm(100, mean=1), rnorm(100, mean=5)), 
c(rnorm(100, mean=1), rnorm(100, mean=5))))
Ymap <- cbind(c(rep(1, 100), rep(0, 100)), c(rep(0, 100), rep(1, 100)))
Ym <- mstep(modelName="EEE", data=Y, z=Ymap)
# NO CRASH:
em(modelName=Ym$modelName, data=Y, mu=Ym$mu, sigmasq=Ym$Sigma, pro=Ym$pro)

But when the variables are not columns (as written in the mclust manual) 
but rows, R crashes again:

# CRASH:
em(modelName=Ym$modelName, data=t(Y), mu=Ym$mu, sigmasq=Ym$Sigma, 
pro=Ym$pro)

Perhaps this is a hint to the origin of the problem.
I could not use the em function for univariate data successfully yet.
Perhaps anyone can provide a working example for univariate data?

Thanks in advance.

From ripley at stats.ox.ac.uk  Mon Mar  7 10:15:04 2005
From: ripley at stats.ox.ac.uk (Brian D Ripley)
Date: Mon Mar  7 10:15:48 2005
Subject: [Rd] R crashes using the em function of package mclust (PR#7719)
In-Reply-To: <20050307083539.1F66DB273@slim.kubism.ku.dk>
Message-ID: <Pine.GSO.4.31.0503070913310.22372-100000@markov.stats>

Please read the FAQ and report this in the correct place:

   Bug reports on contributed packages should be sent first to the package
maintainer, and only submitted to the R-bugs repository by package
maintainers, mentioning the package in the subject line.

You are not the named maintainer.


On Mon, 7 Mar 2005 becker@kfs.oeaw.ac.at wrote:

> Hi,
>
> I got the same problem like
> http://tolstoy.newcastle.edu.au/R/devel/04/11/1204.html
>
> R crashes when I use the em function from the mclust package on
> univariate data and on a special case on bivariate data (when the matrix
> is not provided as written in the manual).
> It seems as if the problem is the format of the data to be analyzed.
>
> Operating System: Windows XP (SP2)
> R version: R-2.0.1
>
> The following example causes a crash of R:
>
> # univariate example
> require(mclust)
> X <- c(rnorm(100, mean=1), rnorm(100, mean=5))
> # I also tried: X <- as.matrix(c(rnorm(100, mean=1), rnorm(100, mean=5)))
> Xmap <- cbind(c(rep(1, 100), rep(0, 100)), c(rep(0, 100), rep(1, 100)))
> Xm <- mstep(modelName="V", data=X, z=Xmap)
> # CRASH:
> em(modelName=Xm$modelName, data=X, mu=Xm$mu, sigmasq=Xm$sigmasq, pro=Xm$pro)
>
> For bivariate data the following example works:
>
> # bivariate example
> require(mclust)
> Y <- as.matrix(cbind(c(rnorm(100, mean=1), rnorm(100, mean=5)),
> c(rnorm(100, mean=1), rnorm(100, mean=5))))
> Ymap <- cbind(c(rep(1, 100), rep(0, 100)), c(rep(0, 100), rep(1, 100)))
> Ym <- mstep(modelName="EEE", data=Y, z=Ymap)
> # NO CRASH:
> em(modelName=Ym$modelName, data=Y, mu=Ym$mu, sigmasq=Ym$Sigma, pro=Ym$pro)
>
> But when the variables are not columns (as written in the mclust manual)
> but rows, R crashes again:
>
> # CRASH:
> em(modelName=Ym$modelName, data=t(Y), mu=Ym$mu, sigmasq=Ym$Sigma,
> pro=Ym$pro)
>
> Perhaps this is a hint to the origin of the problem.
> I could not use the em function for univariate data successfully yet.
> Perhaps anyone can provide a working example for univariate data?
>
> Thanks in advance.
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Mon Mar  7 10:20:43 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Mon Mar  7 10:20:51 2005
Subject: [Rd] R crashes using the em function of package mclust (PR#7719)
Message-ID: <20050307092043.CB324BAD8@slim.kubism.ku.dk>

On Mon,  7 Mar 2005 09:35:39 +0100 (CET), becker@kfs.oeaw.ac.at wrote
:

>Hi,
>
>I got the same problem like
>http://tolstoy.newcastle.edu.au/R/devel/04/11/1204.html
>
>R crashes when I use the em function from the mclust package on 
>univariate data and on a special case on bivariate data (when the matrix 
>is not provided as written in the manual).
>It seems as if the problem is the format of the data to be analyzed.
>
>Operating System: Windows XP (SP2)
>R version: R-2.0.1
>
>The following example causes a crash of R:
>
># univariate example
>require(mclust)
>X <- c(rnorm(100, mean=1), rnorm(100, mean=5))
># I also tried: X <- as.matrix(c(rnorm(100, mean=1), rnorm(100, mean=5)))
>Xmap <- cbind(c(rep(1, 100), rep(0, 100)), c(rep(0, 100), rep(1, 100)))
>Xm <- mstep(modelName="V", data=X, z=Xmap)
># CRASH:
>em(modelName=Xm$modelName, data=X, mu=Xm$mu, sigmasq=Xm$sigmasq, pro=Xm$pro)

Which version of mclust?  I just installed  2.1-8  and ran your code
in R-2.0.1 with no problem.

In any case, this looks more like an mclust problem than an R problem;
if you're using the current version, you should follow up with the
maintainer,   Ron Wehrens <R.Wehrens@science.ru.nl>.

Duncan Murdoch

From becker at kfs.oeaw.ac.at  Mon Mar  7 10:36:19 2005
From: becker at kfs.oeaw.ac.at (becker@kfs.oeaw.ac.at)
Date: Mon Mar  7 10:36:27 2005
Subject: [Rd] R crashes using the em function of package mclust (PR#7719)
Message-ID: <20050307093619.99CFDBAD8@slim.kubism.ku.dk>

Duncan Murdoch schrieb:

>On Mon,  7 Mar 2005 09:35:39 +0100 (CET), becker@kfs.oeaw.ac.at wrote
>:
>
>  
>
>>Hi,
>>
>>I got the same problem like
>>http://tolstoy.newcastle.edu.au/R/devel/04/11/1204.html
>>
>>R crashes when I use the em function from the mclust package on 
>>univariate data and on a special case on bivariate data (when the matrix 
>>is not provided as written in the manual).
>>It seems as if the problem is the format of the data to be analyzed.
>>
>>Operating System: Windows XP (SP2)
>>R version: R-2.0.1
>>
>>The following example causes a crash of R:
>>
>># univariate example
>>require(mclust)
>>X <- c(rnorm(100, mean=1), rnorm(100, mean=5))
>># I also tried: X <- as.matrix(c(rnorm(100, mean=1), rnorm(100, mean=5)))
>>Xmap <- cbind(c(rep(1, 100), rep(0, 100)), c(rep(0, 100), rep(1, 100)))
>>Xm <- mstep(modelName="V", data=X, z=Xmap)
>># CRASH:
>>em(modelName=Xm$modelName, data=X, mu=Xm$mu, sigmasq=Xm$sigmasq, pro=Xm$pro)
>>    
>>
>
>Which version of mclust?  I just installed  2.1-8  and ran your code
>in R-2.0.1 with no problem.
>
>  
>
I used 2.1-6. As you say 2.1-8 runs with no problem.
Sorry, my fault.

>In any case, this looks more like an mclust problem than an R problem;
>if you're using the current version, you should follow up with the
>maintainer,   Ron Wehrens <R.Wehrens@science.ru.nl>.
>
>Duncan Murdoch
>
>  
>

From sshari11 at gmx.de  Mon Mar  7 15:11:08 2005
From: sshari11 at gmx.de (sshari11@gmx.de)
Date: Mon Mar  7 15:11:15 2005
Subject: [Rd] Dear Friend. (PR#7720)
Message-ID: <20050307141108.2B73BB268@slim.kubism.ku.dk>

Dear Friend.

As you read this, I don't want you to feel sorry for me, because, I believe
everyone will die someday.

My name is Shadak Shari, a merchant in Dubai, in the U.A.E.I have been
diagnosed with Esophageal cancer .It has defiled all forms of medical
treatment, and right now I have only about a few months to live, according
to medical experts.

I have not particularly lived my life so well, as I never really cared for
anyone(not even myself)but my business. Though I am very rich, I was never
generous, I was always hostile to people and only focused on my business as
that was the only thing I cared for. But now I regret all this as I now know
that there is more to life than just wanting to have or make all the money
in the world.

I believe when God gives me a second chance to come to this world I would
live my life a different way from how I have lived it. Now that God has
called me, I have willed and given most of my property and assets to my
immediate and extended family members as well as a few close friends.

I want God to be merciful to me and accept my soul so, I have decided to
give alms to charity organizations, as I want this to be one of the last
good deeds I do on earth. So far, I have distributed money to some charity
organizations in the U.A.E, Algeria and Malaysia. Now that my health has
deteriorated so badly, I cannot do this myself anymore.

I once asked members of my family to close one of my accounts and distribute
the money which I have there to charity organization in Bulgaria and
Pakistan, they refused and kept the money to themselves. Hence, I do not
trust them anymore, as they seem not to be contended with what I have left
for them.

The last of my money which no one knows of is the huge cash deposit of seven
million dollars $7,000,000,that I have with a 
finance/Security Company abroad. I will want you to help me collect this
deposit and dispatched it to charity organizations.

I have set aside 10% for you for your time and patience.please send a reply
through this email address(shadakshari002@telkom.net) with your full contact
information for more private and confidential 
communication.

God be with you.

Shadak Shari


-- 
DSL Komplett von GMX +++ Superg?nstig und stressfrei einsteigen!
AKTION "Kein Einrichtungspreis" nutzen: http://www.gmx.net/de/go/dsl

From murdoch at stats.uwo.ca  Mon Mar  7 21:02:12 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon Mar  7 21:02:16 2005
Subject: [Rd] Does cat("\a") ring a bell?
Message-ID: <alcp21p3k0640orctb9t9skqsv5d50he79@4ax.com>

Under GUIs other than Windows (Mac OS X, ESS, etc.) does 

 cat("\a") 

still make a bell (or some other) sound?  If so, I'll add a "bell()"
function to utils.

Duncan Murdoch

From stefano.iacus at unimi.it  Mon Mar  7 21:12:17 2005
From: stefano.iacus at unimi.it (stefano iacus)
Date: Mon Mar  7 21:12:25 2005
Subject: [Rd] Does cat("\a") ring a bell?
In-Reply-To: <alcp21p3k0640orctb9t9skqsv5d50he79@4ax.com>
References: <alcp21p3k0640orctb9t9skqsv5d50he79@4ax.com>
Message-ID: <7a266302b367c26bbfa976002675ccbd@unimi.it>

no, on Mac OS X, but could be easily implemented.
stefano

On 07/mar/05, at 21:02, Duncan Murdoch wrote:

> Under GUIs other than Windows (Mac OS X, ESS, etc.) does
>
>  cat("\a")
>
> still make a bell (or some other) sound?  If so, I'll add a "bell()"
> function to utils.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From vograno at evafunds.com  Mon Mar  7 21:14:38 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Mon Mar  7 21:14:50 2005
Subject: [Rd] Does cat("\a") ring a bell?
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF071@phost015.EVAFUNDS.intermedia.net>

Not under ESS/Emacs/Linux :

> cat("\a")
^G> 

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Duncan Murdoch
> Sent: Monday, March 07, 2005 12:02 PM
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] Does cat("\a") ring a bell?
> 
> Under GUIs other than Windows (Mac OS X, ESS, etc.) does 
> 
>  cat("\a") 
> 
> still make a bell (or some other) sound?  If so, I'll add a "bell()"
> function to utils.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From Friedrich.Leisch at tuwien.ac.at  Mon Mar  7 21:17:58 2005
From: Friedrich.Leisch at tuwien.ac.at (Friedrich.Leisch@tuwien.ac.at)
Date: Mon Mar  7 21:18:07 2005
Subject: [Rd] Does cat("\a") ring a bell?
In-Reply-To: <7a266302b367c26bbfa976002675ccbd@unimi.it>
References: <alcp21p3k0640orctb9t9skqsv5d50he79@4ax.com>
	<7a266302b367c26bbfa976002675ccbd@unimi.it>
Message-ID: <16940.46838.67989.270042@galadriel.ci.tuwien.ac.at>

>>>>> On Mon, 7 Mar 2005 21:12:17 +0100,
>>>>> stefano iacus (si) wrote:

  > no, on Mac OS X, but could be easily implemented.
  > stefano

  > On 07/mar/05, at 21:02, Duncan Murdoch wrote:

  >> Under GUIs other than Windows (Mac OS X, ESS, etc.) does
  >> 
  >> cat("\a")
  >> 
  >> still make a bell (or some other) sound?  If so, I'll add a "bell()"
  >> function to utils.
  >> 

On Linux:

xterm/gnome-terminal:	yes
ESS			no

.f

From jfox at mcmaster.ca  Mon Mar  7 22:16:14 2005
From: jfox at mcmaster.ca (John Fox)
Date: Mon Mar  7 22:16:24 2005
Subject: [Rd] Does cat("\a") ring a bell?
In-Reply-To: <16940.46838.67989.270042@galadriel.ci.tuwien.ac.at>
Message-ID: <20050307211613.FKUD2988.tomts5-srv.bellnexxia.net@JohnDesktop8300>

Dear Duncan et al.,

Actually, it doesn't work under ESS on Windows either.

Regards,
 John

--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario
Canada L8S 4M4
905-525-9140x23604
http://socserv.mcmaster.ca/jfox 
-------------------------------- 

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of 
> Friedrich.Leisch@tuwien.ac.at
> Sent: Monday, March 07, 2005 3:18 PM
> To: stefano iacus
> Cc: Duncan Murdoch; r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] Does cat("\a") ring a bell?
> 
> >>>>> On Mon, 7 Mar 2005 21:12:17 +0100, stefano iacus (si) wrote:
> 
>   > no, on Mac OS X, but could be easily implemented.
>   > stefano
> 
>   > On 07/mar/05, at 21:02, Duncan Murdoch wrote:
> 
>   >> Under GUIs other than Windows (Mac OS X, ESS, etc.) does
>   >>
>   >> cat("\a")
>   >>
>   >> still make a bell (or some other) sound?  If so, I'll 
> add a "bell()"
>   >> function to utils.
>   >> 
> 
> On Linux:
> 
> xterm/gnome-terminal:	yes
> ESS			no
> 
> .f
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From znmeb at cesmail.net  Tue Mar  8 05:19:48 2005
From: znmeb at cesmail.net (znmeb@cesmail.net)
Date: Tue Mar  8 05:19:55 2005
Subject: [Rd] PR#7718
Message-ID: <20050308041948.339F3BAD8@slim.kubism.ku.dk>

R-devel 2005/03/07 is totally innocent. Uninstalling Atlas 3.6.0 fixed 
this. You can close it out; once I figure out whether it's Gentoo's 
packaging of Atlas or Atlas/Athlon itself, I'll post a bug on whichever 
it turns out to be.

From ripley at stats.ox.ac.uk  Tue Mar  8 08:53:23 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar  8 08:53:37 2005
Subject: [Rd] PR#7718
In-Reply-To: <20050308041948.339F3BAD8@slim.kubism.ku.dk>
References: <20050308041948.339F3BAD8@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503080752180.15793@gannet.stats>

On Tue, 8 Mar 2005 znmeb@cesmail.net wrote:

> R-devel 2005/03/07 is totally innocent. Uninstalling Atlas 3.6.0 fixed
> this. You can close it out; once I figure out whether it's Gentoo's
> packaging of Atlas or Atlas/Athlon itself, I'll post a bug on whichever
> it turns out to be.

I've closed it.  I do run ATLAS 3.6.0 on an Athlon XP (32-bit) for my 
daily testing, so at least when built from the sources it works.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Tue Mar  8 15:23:01 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar  8 15:23:20 2005
Subject: [Rd] Does cat("\a") ring a bell?
In-Reply-To: <7a266302b367c26bbfa976002675ccbd@unimi.it>
References: <alcp21p3k0640orctb9t9skqsv5d50he79@4ax.com>
	<7a266302b367c26bbfa976002675ccbd@unimi.it>
Message-ID: <n6dr21pgfvl7jv9hsslbfhjceq8i7se826@4ax.com>

I've now added a function called "alarm()" to ring a bell.  It's
documented to work on some platforms, but not all.

If it truly is easy to support this, you might as well, but I can't
see this as a high priority.

Duncan Murdoch

On Mon, 7 Mar 2005 21:12:17 +0100, stefano iacus
<stefano.iacus@unimi.it> wrote :

>no, on Mac OS X, but could be easily implemented.
>stefano
>
>On 07/mar/05, at 21:02, Duncan Murdoch wrote:
>
>> Under GUIs other than Windows (Mac OS X, ESS, etc.) does
>>
>>  cat("\a")
>>
>> still make a bell (or some other) sound?  If so, I'll add a "bell()"
>> function to utils.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From murdoch at stats.uwo.ca  Tue Mar  8 18:15:58 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar  8 18:16:01 2005
Subject: [Rd] Bug in handling of promises?
Message-ID: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>

I'm working on a function that does adaptive sampling, and I thought
it would be handy to return the function's environment as part of the
result so that I could re-use local variables in a subsequent run.  My
first try didn't work, and it came down to code like this:

> f <- function( H, prevEnv = NULL) {
+     if (!is.null(prevEnv)) H <- prevEnv$H
+     cat('Evaluate H to get ', H(1), '\n')  
+     return(environment(NULL))
+ }

I thought that evaluating H would force it, so that H would be
available in the environment returned by the function.  But this is
not so:

> env <- f( function(x) x^2 )
Evaluate H to get  1 
> env$H
<promise: 012094D8>
> env$H(1)
Error: attempt to apply non-function

So I tried to explicitly force it:

> g <- function( H, prevEnv = NULL) {
+     if (!is.null(prevEnv)) H <- prevEnv$H
+     force(H)   
+     return(environment(NULL))
+ }

but this still doesn't work:

> env <- g( function(x) x^2 )
> env$H
<promise: 01206FC0>
> env$H(1)
Error: attempt to apply non-function

It seems that I need to do an assignment to convert H from a promise
to an evaluated object:

> h <- function( H, prevEnv = NULL) {
+     if (!is.null(prevEnv)) H <- prevEnv$H
+     H <- H     
+     return(environment(NULL))
+ }
> env <- h( function(x) x^2 )
> env$H
function(x) x^2
> env$H(1)
[1] 1

Is this a bug, or just the way things are?

I get the same results in both R-patched and R-devel.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Tue Mar  8 18:44:41 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar  8 18:44:50 2005
Subject: [Rd] Bug in handling of promises?
In-Reply-To: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>
References: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>
Message-ID: <Pine.LNX.4.61.0503081742530.3789@gannet.stats>

The following note in ?force may help

Note:

      'force' does not force the evaluation of promises.

It is there because people have been confused before.


On Tue, 8 Mar 2005, Duncan Murdoch wrote:

> I'm working on a function that does adaptive sampling, and I thought
> it would be handy to return the function's environment as part of the
> result so that I could re-use local variables in a subsequent run.  My
> first try didn't work, and it came down to code like this:
>
>> f <- function( H, prevEnv = NULL) {
> +     if (!is.null(prevEnv)) H <- prevEnv$H
> +     cat('Evaluate H to get ', H(1), '\n')
> +     return(environment(NULL))
> + }
>
> I thought that evaluating H would force it, so that H would be
> available in the environment returned by the function.  But this is
> not so:
>
>> env <- f( function(x) x^2 )
> Evaluate H to get  1
>> env$H
> <promise: 012094D8>
>> env$H(1)
> Error: attempt to apply non-function
>
> So I tried to explicitly force it:
>
>> g <- function( H, prevEnv = NULL) {
> +     if (!is.null(prevEnv)) H <- prevEnv$H
> +     force(H)
> +     return(environment(NULL))
> + }
>
> but this still doesn't work:
>
>> env <- g( function(x) x^2 )
>> env$H
> <promise: 01206FC0>
>> env$H(1)
> Error: attempt to apply non-function
>
> It seems that I need to do an assignment to convert H from a promise
> to an evaluated object:
>
>> h <- function( H, prevEnv = NULL) {
> +     if (!is.null(prevEnv)) H <- prevEnv$H
> +     H <- H
> +     return(environment(NULL))
> + }
>> env <- h( function(x) x^2 )
>> env$H
> function(x) x^2
>> env$H(1)
> [1] 1
>
> Is this a bug, or just the way things are?
>
> I get the same results in both R-patched and R-devel.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Tue Mar  8 19:00:10 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar  8 19:00:14 2005
Subject: [Rd] Bug in handling of promises?
In-Reply-To: <Pine.LNX.4.61.0503081742530.3789@gannet.stats>
References: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>
	<Pine.LNX.4.61.0503081742530.3789@gannet.stats>
Message-ID: <tapr21tfdfgdu2nnbdb5r9ndldn15nun31@4ax.com>

On Tue, 8 Mar 2005 17:44:41 +0000 (GMT), Prof Brian Ripley
<ripley@stats.ox.ac.uk> wrote :

>The following note in ?force may help
>
>Note:
>
>      'force' does not force the evaluation of promises.
>
>It is there because people have been confused before.

Yes, but it also says that it "forces the evaluation of a function
argument", which is what I was trying to do.

But mainly what may be a bug is the fact that H was available in env
but its value was not, even though it had already been evaluated in
that environment.  

My examples were unnecessarily complicated last time, because they
were too much like the original.  Here are simpler versions:

> f <- function( H ) {
+     cat('Evaluate H to get ', H, '\n')
+     return(environment())
+ }
> 
> env <- f( 1 )
Evaluate H to get  1 
> env$H
<promise: 0118BF1C>
> 
> g <- function( H ) {
+     force(H)
+     return(environment())
+ }
> 
> env <- g( 2 )
> env$H
<promise: 0118A148>
> 
> 
> h <- function( H ) {
+     H <- H
+     return(environment())
+ }
> 
> env <- h( 3 )
> env$H
[1] 3

Duncan Murdoch
>
>
>On Tue, 8 Mar 2005, Duncan Murdoch wrote:
>
>> I'm working on a function that does adaptive sampling, and I thought
>> it would be handy to return the function's environment as part of the
>> result so that I could re-use local variables in a subsequent run.  My
>> first try didn't work, and it came down to code like this:
>>
>>> f <- function( H, prevEnv = NULL) {
>> +     if (!is.null(prevEnv)) H <- prevEnv$H
>> +     cat('Evaluate H to get ', H(1), '\n')
>> +     return(environment(NULL))
>> + }
>>
>> I thought that evaluating H would force it, so that H would be
>> available in the environment returned by the function.  But this is
>> not so:
>>
>>> env <- f( function(x) x^2 )
>> Evaluate H to get  1
>>> env$H
>> <promise: 012094D8>
>>> env$H(1)
>> Error: attempt to apply non-function
>>
>> So I tried to explicitly force it:
>>
>>> g <- function( H, prevEnv = NULL) {
>> +     if (!is.null(prevEnv)) H <- prevEnv$H
>> +     force(H)
>> +     return(environment(NULL))
>> + }
>>
>> but this still doesn't work:
>>
>>> env <- g( function(x) x^2 )
>>> env$H
>> <promise: 01206FC0>
>>> env$H(1)
>> Error: attempt to apply non-function
>>
>> It seems that I need to do an assignment to convert H from a promise
>> to an evaluated object:
>>
>>> h <- function( H, prevEnv = NULL) {
>> +     if (!is.null(prevEnv)) H <- prevEnv$H
>> +     H <- H
>> +     return(environment(NULL))
>> + }
>>> env <- h( function(x) x^2 )
>>> env$H
>> function(x) x^2
>>> env$H(1)
>> [1] 1
>>
>> Is this a bug, or just the way things are?
>>
>> I get the same results in both R-patched and R-devel.

From murdoch at stats.uwo.ca  Tue Mar  8 19:09:46 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar  8 19:09:52 2005
Subject: [Rd] Bug in handling of promises?
In-Reply-To: <tapr21tfdfgdu2nnbdb5r9ndldn15nun31@4ax.com>
References: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>
	<Pine.LNX.4.61.0503081742530.3789@gannet.stats>
	<tapr21tfdfgdu2nnbdb5r9ndldn15nun31@4ax.com>
Message-ID: <t7qr215anqaesam3kejtf0qc393726vijj@4ax.com>

A followup:  doing an assignment of the value works even after the
return:

> f
function( H ) {
    cat('Evaluate H to get \n')
    print(H)
    return(environment())
}
> env <- f( function(x) x^2 )
Evaluate H to get 
function(x) x^2
> env$H
<promise: 0117C2D0>
> env$H(1)
Error: attempt to apply non-function
> H <- env$H
> H(1)
[1] 1

So the oddity is that I can evaluate H within f() without any problem,
but outside of f() I need extra work before I can do it.

Duncan Murdoch


On Tue, 08 Mar 2005 18:00:10 +0000, Duncan Murdoch
<murdoch@stats.uwo.ca> wrote :

>On Tue, 8 Mar 2005 17:44:41 +0000 (GMT), Prof Brian Ripley
><ripley@stats.ox.ac.uk> wrote :
>
>>The following note in ?force may help
>>
>>Note:
>>
>>      'force' does not force the evaluation of promises.
>>
>>It is there because people have been confused before.
>
>Yes, but it also says that it "forces the evaluation of a function
>argument", which is what I was trying to do.
>
>But mainly what may be a bug is the fact that H was available in env
>but its value was not, even though it had already been evaluated in
>that environment.  
>
>My examples were unnecessarily complicated last time, because they
>were too much like the original.  Here are simpler versions:
>
>> f <- function( H ) {
>+     cat('Evaluate H to get ', H, '\n')
>+     return(environment())
>+ }
>> 
>> env <- f( 1 )
>Evaluate H to get  1 
>> env$H
><promise: 0118BF1C>
>> 
>> g <- function( H ) {
>+     force(H)
>+     return(environment())
>+ }
>> 
>> env <- g( 2 )
>> env$H
><promise: 0118A148>
>> 
>> 
>> h <- function( H ) {
>+     H <- H
>+     return(environment())
>+ }
>> 
>> env <- h( 3 )
>> env$H
>[1] 3
>
>Duncan Murdoch
>>
>>
>>On Tue, 8 Mar 2005, Duncan Murdoch wrote:
>>
>>> I'm working on a function that does adaptive sampling, and I thought
>>> it would be handy to return the function's environment as part of the
>>> result so that I could re-use local variables in a subsequent run.  My
>>> first try didn't work, and it came down to code like this:
>>>
>>>> f <- function( H, prevEnv = NULL) {
>>> +     if (!is.null(prevEnv)) H <- prevEnv$H
>>> +     cat('Evaluate H to get ', H(1), '\n')
>>> +     return(environment(NULL))
>>> + }
>>>
>>> I thought that evaluating H would force it, so that H would be
>>> available in the environment returned by the function.  But this is
>>> not so:
>>>
>>>> env <- f( function(x) x^2 )
>>> Evaluate H to get  1
>>>> env$H
>>> <promise: 012094D8>
>>>> env$H(1)
>>> Error: attempt to apply non-function
>>>
>>> So I tried to explicitly force it:
>>>
>>>> g <- function( H, prevEnv = NULL) {
>>> +     if (!is.null(prevEnv)) H <- prevEnv$H
>>> +     force(H)
>>> +     return(environment(NULL))
>>> + }
>>>
>>> but this still doesn't work:
>>>
>>>> env <- g( function(x) x^2 )
>>>> env$H
>>> <promise: 01206FC0>
>>>> env$H(1)
>>> Error: attempt to apply non-function
>>>
>>> It seems that I need to do an assignment to convert H from a promise
>>> to an evaluated object:
>>>
>>>> h <- function( H, prevEnv = NULL) {
>>> +     if (!is.null(prevEnv)) H <- prevEnv$H
>>> +     H <- H
>>> +     return(environment(NULL))
>>> + }
>>>> env <- h( function(x) x^2 )
>>>> env$H
>>> function(x) x^2
>>>> env$H(1)
>>> [1] 1
>>>
>>> Is this a bug, or just the way things are?
>>>
>>> I get the same results in both R-patched and R-devel.
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From p.dalgaard at biostat.ku.dk  Tue Mar  8 19:10:26 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Mar  8 19:16:56 2005
Subject: [Rd] Bug in handling of promises?
In-Reply-To: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>
References: <bemr21dafvf5sp687mk0jpob2rual9ilan@4ax.com>
Message-ID: <x23bv6dn59.fsf@biostat.ku.dk>

Duncan Murdoch <murdoch@stats.uwo.ca> writes:

[snip]
> So I tried to explicitly force it:
> 
> > g <- function( H, prevEnv = NULL) {
> +     if (!is.null(prevEnv)) H <- prevEnv$H
> +     force(H)   
> +     return(environment(NULL))
> + }
> 
> but this still doesn't work:
> 
> > env <- g( function(x) x^2 )
> > env$H
> <promise: 01206FC0>
> > env$H(1)
> Error: attempt to apply non-function
> 
> It seems that I need to do an assignment to convert H from a promise
> to an evaluated object:
> 
> > h <- function( H, prevEnv = NULL) {
> +     if (!is.null(prevEnv)) H <- prevEnv$H
> +     H <- H     
> +     return(environment(NULL))
> + }
> > env <- h( function(x) x^2 )
> > env$H
> function(x) x^2
> > env$H(1)
> [1] 1
> 
> Is this a bug, or just the way things are?
> 
> I get the same results in both R-patched and R-devel.

Hmm, I don't think it is a bug as such that a promise in a function
environment stays a promise. Otherwise the semantics of substitute()
get messed up. However, it is a bit peculiar that the evaluator
doesn't extract the value when such an object is encountered in an
expression. Apparently (conjecture!) this is only done during variable
lookup, but not on return values from functions:

> env <- g( 2 )
> env$H+2
Error in env$H + 2 : non-numeric argument to binary operator
> with(env,H+2)
[1] 4
> x <- env$H
> x+2
[1] 4


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From xt_wang at cse.concordia.ca  Tue Mar  8 23:21:46 2005
From: xt_wang at cse.concordia.ca (xt_wang@cse.concordia.ca)
Date: Tue Mar  8 23:21:55 2005
Subject: [Rd] create a R package
Message-ID: <1110320506.422e257a9d506@mail.encs.concordia.ca>

Hello, everyone,

I would like to create a package which includes C code. My input data comes from
a text file and I will output my solution into a text file too. My question is
that I put the input file in src directory or data directory or somewhere else?

On the other hand, I want to call this C function from R. The R code is put in
the R directory or I carry out this code in R environment directly.


Maggie

From huber at ebi.ac.uk  Tue Mar  8 23:37:32 2005
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Tue Mar  8 23:38:01 2005
Subject: [Rd] create a R package
In-Reply-To: <1110320506.422e257a9d506@mail.encs.concordia.ca>
References: <1110320506.422e257a9d506@mail.encs.concordia.ca>
Message-ID: <422E292C.6020204@ebi.ac.uk>

xt_wang@cse.concordia.ca wrote:
> Hello, everyone,
> 
> I would like to create a package which includes C code. My input data comes from
> a text file and I will output my solution into a text file too. My question is
> that I put the input file in src directory or data directory or somewhere else?
> 
> On the other hand, I want to call this C function from R. The R code is put in
> the R directory or I carry out this code in R environment directly.
> 

Maggie

why did you send this message to R-devel?

Please have a look at the manual "Writing R extensions" available e.g. from
http://www.stats.bris.ac.uk/R/manuals.html

Best regards
   Wolfgang

-------------------------------------
Wolfgang Huber
European Bioinformatics Institute
European Molecular Biology Laboratory
Cambridge CB10 1SD
England
Phone: +44 1223 494642
Fax:   +44 1223 494486
Http:  www.ebi.ac.uk/huber

From andy_liaw at merck.com  Wed Mar  9 00:44:31 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Wed Mar  9 00:45:25 2005
Subject: [Rd] delay of warning for things in .Rprofile
Message-ID: <3A822319EB35174CA3714066D590DCD50994E808@usrymx25.merck.com>

Hi all,

I was playing with R-devel 2005-03-08 on winXP Pro (installed from Duncan's
installer).  My .Rprofile contains:

options(defaultPackages=c(getOption("defaultPackages"), "mypkg"),
        chmhelp=TRUE)

but "mypkg" has not yet been installed in the library/ directory of this
installation.  When Rgui starts, I do not get any error or warning, but upon
running one command, I get:

Warning messages:
1: there is no package called 'mypkg' in: library(package, character.only =
TRUE, logical = TRUE, warn.conflicts = warn.conflicts,  
2: package mypkg in options("defaultPackages") was not found 

This seems a bit strange...  I would expect the warning to show up before
the first prompt.  Is this intentional?

Best,
Andy

Andy Liaw, PhD
Biometrics Research      PO Box 2000, RY33-300     
Merck Research Labs           Rahway, NJ 07065
andy_liaw <at> merck.com          732-594-0820

From ripley at stats.ox.ac.uk  Wed Mar  9 07:33:14 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar  9 07:33:24 2005
Subject: [Rd] delay of warning for things in .Rprofile
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E808@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD50994E808@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.61.0503090613540.4469@gannet.stats>

On Tue, 8 Mar 2005, Liaw, Andy wrote:

> Hi all,
>
> I was playing with R-devel 2005-03-08 on winXP Pro (installed from Duncan's
> installer).  My .Rprofile contains:
>
> options(defaultPackages=c(getOption("defaultPackages"), "mypkg"),
>        chmhelp=TRUE)
>
> but "mypkg" has not yet been installed in the library/ directory of this
> installation.  When Rgui starts, I do not get any error or warning, but upon
> running one command, I get:
>
> Warning messages:
> 1: there is no package called 'mypkg' in: library(package, character.only =
> TRUE, logical = TRUE, warn.conflicts = warn.conflicts,
> 2: package mypkg in options("defaultPackages") was not found
>
> This seems a bit strange...  I would expect the warning to show up before
> the first prompt.  Is this intentional?

It is normal.  By default (options(warn=0)), warnings are collected and
(to quote the help page) `printed after the top-level function has 
completed'.  Warnings during startup wait until a top-level command has 
been completed.  It is done in the main REPL loop at main.c:362 (and also 
under some error conditions).

As to whether this is intentional: I don't know but it would be helpful to 
change it, so I will.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Achim.Zeileis at wu-wien.ac.at  Thu Mar 10 14:04:45 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Thu Mar 10 14:04:42 2005
Subject: [Rd] CRAN Task Views: ctv package available
Message-ID: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>

Dear developeRs,

in the last month I mentioned in several discussions on R-help that Kurt
and I were working on tools for "CRAN Task Views" which should help to
structure the fast-growing list of packages on CRAN.

Now the first version of a package called ctv (for CRAN Task Views) is
available from CRAN and also two frist drafts for such views can be seen
at 
  http://CRAN.R-project.org/src/contrib/Views/

When you install the ctv package you can also query this from within R
via:
  CRAN.views()
  install.views("Econometrics", lib = "/path/to/foo")

New views can be easily written in an XML-based format from which we can
generate the HTML information displayed on the Web and also the
information needed for querying the views via CRAN.views(). The package
contains a short vignette that explains how to write new task views.

Feedback on the package would be very welcome! Furthermore, if you want
to write and maintain a new task view for a certain topic, that would be
great! Just drop me an e-mail with your suggestion.

Best wishes from Vienna,
Z

From balboni.alessandro at student.unife.it  Thu Mar 10 14:16:06 2005
From: balboni.alessandro at student.unife.it (Alessandro Balboni)
Date: Thu Mar 10 14:19:58 2005
Subject: [Rd] How to use Rmpi?
Message-ID: <1686.130.186.7.46.1110460566.squirrel@student.unife.it>

I need to rewrite a software in R, that runs on a cluster.

I thought Rmpi will be good for me but I can't find
any help other than the Rmpi-manual that actually only
describe the functions in the Rmpi package.

Can someone point me to some usefull guide?

For example, I would like to run a for-statement on
several processors (a subset of the statement on each
processor) but I can't figure out how to do this!

Thanks

-- 
Alessandro_O

From sfalcon at fhcrc.org  Thu Mar 10 16:13:43 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Thu Mar 10 16:13:53 2005
Subject: [Rd] How to use Rmpi?
In-Reply-To: <1686.130.186.7.46.1110460566.squirrel@student.unife.it>
	(Alessandro
	Balboni's message of "Thu, 10 Mar 2005 14:16:06 +0100 (CET)")
References: <1686.130.186.7.46.1110460566.squirrel@student.unife.it>
Message-ID: <m2wtsf4jq0.fsf@macaroni.local>

Hi Alessandro,
"Alessandro Balboni" <balboni.alessandro@student.unife.it> writes:
> I need to rewrite a software in R, that runs on a cluster.

If you haven't already, take a look at the snow package on CRAN.  It
provides an easier to use wrapper around either Rmpi or Rpvm.  The
included documentation has some examples that should get you going.

+ seth

From andy_liaw at merck.com  Thu Mar 10 17:04:07 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Mar 10 17:04:46 2005
Subject: [Rd] dealing with package bundles (was RE: [R] Gregmisc)
Message-ID: <3A822319EB35174CA3714066D590DCD50994E823@usrymx25.merck.com>

Given the confusions that some users have regarding package bundles, I'd
like to suggest some changes to how package bundles are handled.

My understanding is that a package bundle is essentially a convenient way to
distribute related packages, so that users can download/install them in one
shot.  However, some users apparently get confused that one can do
install.packages("abundle") but can't do library("abundle").  I think it
might be worthwhile having library() (or it's to-be replacement(s)) do
something more informative, if the argument is the name of a bundle, instead
of a package.  Examples are:

- Give an error that says that's a package bundle, and the constituent
packages need to be loaded individually.

- Load all of the packages in the bundle, but issue an warning.

- (More elaborate) give a menu of packages and ask the user to choose which
one to load.

(Come to think of it, it would be nice for library() to be able to load
multiple packages in one go...)

One problem that I can see is that it seems like once a package bundle is
installed, R basically has no knowledge that the packages belong to one
bundle, other than the fact that the DESCRIPTION files of the packages have
entries that indicate that they are part of a bundle.  Are there ways to
figure out such information other than checking packageDescription() of all
installed packages?

Cheers,
Andy




> From: Marc Schwartz
> 
> On Thu, 2005-03-10 at 14:44 +0100, Christian Kamenik wrote:
> > Dear all,
> > 
> > I use R 2.0.1 on Windows XP professional. When I want to load the 
> > 'Gregmisc' library I get the following error message:
> > 
> > Error in library(pkg, character.only = TRUE) :  'gregmisc' is not a 
> > valid package -- installed < 2.0.0?
> > 
> > Can anybody tell me what's wrong with this package?
> 
> 
> gregmisc is a _bundle_, not a package. It is now comprised of four
> separate packages:
> 
> 1. gtools
> 
> 2. gdata
> 
> 3. gmodels
> 
> 4. gplots
> 
> You will need to load the particular package that you wish to use or
> load all four if you wish.
> 
> HTH,
> 
> Marc Schwartz
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! 
> http://www.R-project.org/posting-guide.html
> 
> 
>

From ripley at stats.ox.ac.uk  Thu Mar 10 17:27:02 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar 10 17:27:13 2005
Subject: [Rd] dealing with package bundles (was RE: [R] Gregmisc)
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E823@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD50994E823@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.61.0503101609000.2060@gannet.stats>

On Thu, 10 Mar 2005, Liaw, Andy wrote:

> Given the confusions that some users have regarding package bundles, I'd

Just one bundle, AFAICS.

> like to suggest some changes to how package bundles are handled.

The issue seems only to arise with one bundle that was formerly a package. 
I think re-naming that bundle would be the most effective solution. 
Alternatively, bundle 'gregmisc' could contain a package 'gregmisc' (there 
is an example of that already in CoCo) which told users what had happened 
(or even loaded all the components), which would also work with a rename.

> My understanding is that a package bundle is essentially a convenient way to
> distribute related packages, so that users can download/install them in one
> shot.  However, some users apparently get confused that one can do
> install.packages("abundle") but can't do library("abundle").  I think it
> might be worthwhile having library() (or it's to-be replacement(s)) do
> something more informative, if the argument is the name of a bundle, instead
> of a package.  Examples are:
>
> - Give an error that says that's a package bundle, and the constituent
> packages need to be loaded individually.

How can you know that?  The names of bundles are not known, and indeed 
`gregmisc' is a perfectly good package name and gregmisc 1.x might be what 
was intended.

> - Load all of the packages in the bundle, but issue an warning.
>
> - (More elaborate) give a menu of packages and ask the user to choose which
> one to load.
>
> (Come to think of it, it would be nice for library() to be able to load
> multiple packages in one go...)

In what order, and why, given that library() will already load all the 
dependencies in a sensible order?

> One problem that I can see is that it seems like once a package bundle is
> installed, R basically has no knowledge that the packages belong to one
> bundle, other than the fact that the DESCRIPTION files of the packages have
> entries that indicate that they are part of a bundle.  Are there ways to
> figure out such information other than checking packageDescription() of all
> installed packages?

No.

As from 2.1.0, install.packages() will install a bundle given the name of 
a package it contains (at least if the repositories supply the 
information), so there will be little need for users to know about 
bundles.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MSchwartz at MedAnalytics.com  Thu Mar 10 18:51:24 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Thu Mar 10 18:51:35 2005
Subject: [Rd] dealing with package bundles (was RE: [R] Gregmisc)
In-Reply-To: <Pine.LNX.4.61.0503101609000.2060@gannet.stats>
References: <3A822319EB35174CA3714066D590DCD50994E823@usrymx25.merck.com>
	<Pine.LNX.4.61.0503101609000.2060@gannet.stats>
Message-ID: <1110477084.7934.43.camel@horizons.localdomain>

On Thu, 2005-03-10 at 16:27 +0000, Prof Brian Ripley wrote:
> On Thu, 10 Mar 2005, Liaw, Andy wrote:

> > One problem that I can see is that it seems like once a package bundle is
> > installed, R basically has no knowledge that the packages belong to one
> > bundle, other than the fact that the DESCRIPTION files of the packages have
> > entries that indicate that they are part of a bundle.  Are there ways to
> > figure out such information other than checking packageDescription() of all
> > installed packages?
> 
> No.
> 
> As from 2.1.0, install.packages() will install a bundle given the name of 
> a package it contains (at least if the repositories supply the 
> information), so there will be little need for users to know about 
> bundles.


This is likely to be considered a kludgy approach, but one way of
linking packages to bundles with a more global approach (as opposed to
one package at at time) is the following:

# Get the set of currently installed packages, taking
# just the package and bundle names
Pkgs.Installed <- installed.packages()[, c("Package", "Bundle")]

# Get the packages that are in bundles
# "Bundle" will be NA if package is not in a bundle
Pkgs.Installed[!is.na(Pkgs.Installed[, "Bundle"]), ]


On my system, where I have installed all CRAN packages that do not
require third party libs, I get the following:

> Pkgs.Installed[!is.na(Pkgs.Installed[, "Bundle"]), ]
            Package       Bundle
CoCo        "CoCo"        "CoCo"
CoCoCg      "CoCoCg"      "CoCo"
CoCoCore    "CoCoCore"    "CoCo"
CoCoGraph   "CoCoGraph"   "CoCo"
CoCoObjects "CoCoObjects" "CoCo"
CoCoOldData "CoCoOldData" "CoCo"
CoCoRaw     "CoCoRaw"     "CoCo"
Greene      "Greene"      "Ecdat"
Hayashi     "Hayashi"     "Ecdat"
MASS        "MASS"        "VR"
class       "class"       "VR"
dse1        "dse1"        "dse"
dse2        "dse2"        "dse"
gdata       "gdata"       "gregmisc"
gmodels     "gmodels"     "gregmisc"
gplots      "gplots"      "gregmisc"
gtools      "gtools"      "gregmisc"
nnet        "nnet"        "VR"
spatial     "spatial"     "VR"
svDialogs   "svDialogs"   "SciViews"
svGUI       "svGUI"       "SciViews"
svIDE       "svIDE"       "SciViews"
svIO        "svIO"        "SciViews"
svMisc      "svMisc"      "SciViews"
svSocket    "svSocket"    "SciViews"
svViews     "svViews"     "SciViews"
tframe      "tframe"      "dse"

One could then feasibly manipulate this information as one desires.

HTH,

Marc Schwartz

From ripley at stats.ox.ac.uk  Thu Mar 10 18:55:09 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar 10 18:55:20 2005
Subject: [Rd] dealing with package bundles (was RE: [R] Gregmisc)
In-Reply-To: <1110477084.7934.43.camel@horizons.localdomain>
References: <3A822319EB35174CA3714066D590DCD50994E823@usrymx25.merck.com> 
	<Pine.LNX.4.61.0503101609000.2060@gannet.stats>
	<1110477084.7934.43.camel@horizons.localdomain>
Message-ID: <Pine.LNX.4.61.0503101752180.3707@gannet.stats>

On Thu, 10 Mar 2005, Marc Schwartz wrote:

> On Thu, 2005-03-10 at 16:27 +0000, Prof Brian Ripley wrote:
>> On Thu, 10 Mar 2005, Liaw, Andy wrote:
>
>>> One problem that I can see is that it seems like once a package bundle is
>>> installed, R basically has no knowledge that the packages belong to one
>>> bundle, other than the fact that the DESCRIPTION files of the packages have
>>> entries that indicate that they are part of a bundle.  Are there ways to
>>> figure out such information other than checking packageDescription() of all
>>> installed packages?
>>
>> No.
>>
>> As from 2.1.0, install.packages() will install a bundle given the name of
>> a package it contains (at least if the repositories supply the
>> information), so there will be little need for users to know about
>> bundles.
>
>
> This is likely to be considered a kludgy approach, but one way of
> linking packages to bundles with a more global approach (as opposed to
> one package at at time) is the following:

There is code like that in new.packages.  The problem is that looking at 
ca 500 packages is slow, especially on a laptop disc (or at least on the 
one of mine that has just died) but even on the fast RAIDs on our servers.

Brian


> # Get the set of currently installed packages, taking
> # just the package and bundle names
> Pkgs.Installed <- installed.packages()[, c("Package", "Bundle")]
>
> # Get the packages that are in bundles
> # "Bundle" will be NA if package is not in a bundle
> Pkgs.Installed[!is.na(Pkgs.Installed[, "Bundle"]), ]
>
>
> On my system, where I have installed all CRAN packages that do not
> require third party libs, I get the following:
>
>> Pkgs.Installed[!is.na(Pkgs.Installed[, "Bundle"]), ]
>            Package       Bundle
> CoCo        "CoCo"        "CoCo"
> CoCoCg      "CoCoCg"      "CoCo"
> CoCoCore    "CoCoCore"    "CoCo"
> CoCoGraph   "CoCoGraph"   "CoCo"
> CoCoObjects "CoCoObjects" "CoCo"
> CoCoOldData "CoCoOldData" "CoCo"
> CoCoRaw     "CoCoRaw"     "CoCo"
> Greene      "Greene"      "Ecdat"
> Hayashi     "Hayashi"     "Ecdat"
> MASS        "MASS"        "VR"
> class       "class"       "VR"
> dse1        "dse1"        "dse"
> dse2        "dse2"        "dse"
> gdata       "gdata"       "gregmisc"
> gmodels     "gmodels"     "gregmisc"
> gplots      "gplots"      "gregmisc"
> gtools      "gtools"      "gregmisc"
> nnet        "nnet"        "VR"
> spatial     "spatial"     "VR"
> svDialogs   "svDialogs"   "SciViews"
> svGUI       "svGUI"       "SciViews"
> svIDE       "svIDE"       "SciViews"
> svIO        "svIO"        "SciViews"
> svMisc      "svMisc"      "SciViews"
> svSocket    "svSocket"    "SciViews"
> svViews     "svViews"     "SciViews"
> tframe      "tframe"      "dse"
>
> One could then feasibly manipulate this information as one desires.
>
> HTH,
>
> Marc Schwartz
>
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MSchwartz at MedAnalytics.com  Thu Mar 10 19:16:15 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Thu Mar 10 19:16:26 2005
Subject: [Rd] dealing with package bundles (was RE: [R] Gregmisc)
In-Reply-To: <Pine.LNX.4.61.0503101752180.3707@gannet.stats>
References: <3A822319EB35174CA3714066D590DCD50994E823@usrymx25.merck.com>
	<Pine.LNX.4.61.0503101609000.2060@gannet.stats>
	<1110477084.7934.43.camel@horizons.localdomain>
	<Pine.LNX.4.61.0503101752180.3707@gannet.stats>
Message-ID: <1110478576.7934.56.camel@horizons.localdomain>

On Thu, 2005-03-10 at 17:55 +0000, Prof Brian Ripley wrote:
> On Thu, 10 Mar 2005, Marc Schwartz wrote:
> 
> > On Thu, 2005-03-10 at 16:27 +0000, Prof Brian Ripley wrote:
> >> On Thu, 10 Mar 2005, Liaw, Andy wrote:
> >
> >>> One problem that I can see is that it seems like once a package bundle is
> >>> installed, R basically has no knowledge that the packages belong to one
> >>> bundle, other than the fact that the DESCRIPTION files of the packages have
> >>> entries that indicate that they are part of a bundle.  Are there ways to
> >>> figure out such information other than checking packageDescription() of all
> >>> installed packages?
> >>
> >> No.
> >>
> >> As from 2.1.0, install.packages() will install a bundle given the name of
> >> a package it contains (at least if the repositories supply the
> >> information), so there will be little need for users to know about
> >> bundles.
> >
> >
> > This is likely to be considered a kludgy approach, but one way of
> > linking packages to bundles with a more global approach (as opposed to
> > one package at at time) is the following:
> 
> There is code like that in new.packages.  The problem is that looking at 
> ca 500 packages is slow, especially on a laptop disc (or at least on the 
> one of mine that has just died) but even on the fast RAIDs on our servers.
> 
> Brian


On my system, for the first step, which is the more time consuming:

> system.time(Pkgs.Installed <- installed.packages()[, c("Package",
"Bundle")], gcFirst = TRUE)
[1] 3.56 1.15 4.89 0.00 0.00

That is with 505 installed packages.

That's not tragic, but I do have a fast laptop (3.2 Ghz P4, 2 Gb RAM and
a 7200 RPM 60 Gb HD). The latter yields about 36 MB/sec for buffered
disk reads according to hdparm.

I suppose if this were a significant enough issue (yet to be
determined), one way of speeding up the process would be to create some
type of data structure (ie. a data frame in a .RData file) that gets
updated during package installation. The structure could be loaded,
updated and then saved for future recall as required. There would
presumably need to be some means of integrity checking on it I suppose.

Of course the a priori need has to be defined to make it logical to
allocate the dev resources to implement something like this.

Marc

From huber at ebi.ac.uk  Thu Mar 10 22:07:08 2005
From: huber at ebi.ac.uk (huber@ebi.ac.uk)
Date: Thu Mar 10 22:07:15 2005
Subject: [Rd] R_alloc with more than 2GB (PR#7721)
Message-ID: <20050310210708.309A0C00D@slim.kubism.ku.dk>

Full_Name: Wolfgang Huber
Version: R-devel_2005-03-10
OS: alphaev68-dec-osf4.0f
Submission from: (NULL) (62.253.128.15)


This report concerns allocation of large (>2^31 byte) chunks of memory with
R_alloc. I suspect it is a bug/typo but please don't hate me if it's actually a
feature:

In R, I can happily create large matrices:

> a= matrix(0, nrow=191481, ncol=3063)
> dim(a)
[1] 191481   3063
> length(a)*8 / 2^30
[1] 4.369812

but when I call R_alloc in some of my C code, I get
"negative length vectors are not allowed":

    maxcp = 3063; n = 191481;
    vs = (long) maxcp * (long) n;
    mI = (double*) R_alloc(vs, sizeof(double));


I suspect this caused by allocString(int), which is called by R_alloc, see
below. Would it be possible to have allocString take a long argument as well?

These code excerpts are from R-devel_2005-03-10.tar.gz:

char *R_alloc(long nelem, int eltsize) {
 R_size_t size = nelem * eltsize;
 SEXP s = allocString(size);
 ...
}


SEXP allocString(int length) {
   return allocVector(CHARSXP, length);
}


SEXP allocVector(SEXPTYPE type, R_len_t length) {
...    
   case CHARSXP:
	size = BYTE2VEC(length + 1);
...
   malloc(sizeof(SEXPREC_ALIGN) + size * sizeof(VECREC)))
...
}

From ripley at stats.ox.ac.uk  Thu Mar 10 23:02:19 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar 10 23:02:33 2005
Subject: [Rd] R_alloc with more than 2GB (PR#7721)
In-Reply-To: <20050310210708.309A0C00D@slim.kubism.ku.dk>
References: <20050310210708.309A0C00D@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503102137330.5792@gannet.stats>

It is a feature.  Other parts of R expect a CHARSXP to have length less 
than or equal to 2^31 - 1.

Because of the use of Fortran, it is hard to see how to allow internal 
lengths (in elements, not necessarily bytes) to exceed that value.  We 
need to return to that, but it is not straightforward and last time we 
discussed it we agreed to defer it.

We can manage a better error message, but I am afraid nothing else in the 
near future.

Could you not use x = allocVector(REALSXP, vs) and REAL(x)[i]?  That will 
get you up to 2^31 - 1 elements, which is the R limit AFAIK.

On Thu, 10 Mar 2005 huber@ebi.ac.uk wrote:

> Full_Name: Wolfgang Huber
> Version: R-devel_2005-03-10
> OS: alphaev68-dec-osf4.0f
> Submission from: (NULL) (62.253.128.15)
>
>
> This report concerns allocation of large (>2^31 byte) chunks of memory with
> R_alloc. I suspect it is a bug/typo but please don't hate me if it's actually a
> feature:
>
> In R, I can happily create large matrices:
>
>> a= matrix(0, nrow=191481, ncol=3063)
>> dim(a)
> [1] 191481   3063
>> length(a)*8 / 2^30
> [1] 4.369812
>
> but when I call R_alloc in some of my C code, I get
> "negative length vectors are not allowed":
>
>    maxcp = 3063; n = 191481;
>    vs = (long) maxcp * (long) n;
>    mI = (double*) R_alloc(vs, sizeof(double));
>
>
> I suspect this caused by allocString(int), which is called by R_alloc, see
> below. Would it be possible to have allocString take a long argument as well?
>
> These code excerpts are from R-devel_2005-03-10.tar.gz:
>
> char *R_alloc(long nelem, int eltsize) {
> R_size_t size = nelem * eltsize;
> SEXP s = allocString(size);
> ...
> }
>
>
> SEXP allocString(int length) {
>   return allocVector(CHARSXP, length);
> }
>
>
> SEXP allocVector(SEXPTYPE type, R_len_t length) {
> ...
>   case CHARSXP:
> 	size = BYTE2VEC(length + 1);
> ...
>   malloc(sizeof(SEXPREC_ALIGN) + size * sizeof(VECREC)))
> ...
> }
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From huber at ebi.ac.uk  Thu Mar 10 23:36:37 2005
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Thu Mar 10 23:37:10 2005
Subject: [Rd] R_alloc with more than 2GB (PR#7721)
In-Reply-To: <Pine.LNX.4.61.0503102137330.5792@gannet.stats>
References: <20050310210708.309A0C00D@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0503102137330.5792@gannet.stats>
Message-ID: <4230CBF5.2030903@ebi.ac.uk>

Dear Prof Ripley,

> It is a feature.  Other parts of R expect a CHARSXP to have length less 
> than or equal to 2^31 - 1.

OK, after looking closer at the code and comments in memory.c and 
Rinternals.h (typedef int R_len_t;) I realized that.

> 
> Could you not use x = allocVector(REALSXP, vs) and REAL(x)[i]?  That 
> will get you up to 2^31 - 1 elements, which is the R limit AFAIK.

Thanks, that is an excellent idea. It should be fine for my immediate 
needs, and better what I've just been doing with Calloc!

 > Because of the use of Fortran, it is hard to see how to allow internal
 > lengths (in elements, not necessarily bytes) to exceed that value.  We
 > need to return to that, but it is not straightforward and last time we
 > discussed it we agreed to defer it.

 > We can manage a better error message, but I am afraid nothing else in
 > the near future.

In the application that triggered this posting, the memory is for a C 
array of doubles within a user-defined C function, not for anything that 
needs to become an R object, so maybe a suggestion would be to make 
R_alloc go directly to malloc without the detour over allocString or 
allocVector; or something along that line?

  Best regards
   Wolfgang

-------------------------------------
Wolfgang Huber
European Bioinformatics Institute
European Molecular Biology Laboratory
Cambridge CB10 1SD
England
Phone: +44 1223 494642
Fax:   +44 1223 494486
Http:  www.ebi.ac.uk/huber

From huber at ebi.ac.uk  Thu Mar 10 23:36:49 2005
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Thu Mar 10 23:37:20 2005
Subject: [Rd] R_alloc with more than 2GB (PR#7721)
In-Reply-To: <Pine.LNX.4.61.0503102137330.5792@gannet.stats>
References: <20050310210708.309A0C00D@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0503102137330.5792@gannet.stats>
Message-ID: <4230CC01.2050804@ebi.ac.uk>

Dear Prof Ripley,

> It is a feature.  Other parts of R expect a CHARSXP to have length less 
> than or equal to 2^31 - 1.

OK, after looking closer at the code and comments in memory.c and 
Rinternals.h (typedef int R_len_t;) I realized that.

> 
> Could you not use x = allocVector(REALSXP, vs) and REAL(x)[i]?  That 
> will get you up to 2^31 - 1 elements, which is the R limit AFAIK.

Thanks, that is an excellent idea. It should be fine for my immediate 
needs, and better what I've just been doing with Calloc!

 > Because of the use of Fortran, it is hard to see how to allow internal
 > lengths (in elements, not necessarily bytes) to exceed that value.  We
 > need to return to that, but it is not straightforward and last time we
 > discussed it we agreed to defer it.

 > We can manage a better error message, but I am afraid nothing else in
 > the near future.

In the application that triggered this posting, the memory is for a C 
array of doubles within a user-defined C function, not for anything that 
needs to become an R object, so maybe a suggestion would be to make 
R_alloc go directly to malloc without the detour over allocString or 
allocVector; or something along that line?

  Best regards
   Wolfgang

-------------------------------------
Wolfgang Huber
European Bioinformatics Institute
European Molecular Biology Laboratory
Cambridge CB10 1SD
England
Phone: +44 1223 494642
Fax:   +44 1223 494486
Http:  www.ebi.ac.uk/huber

From deepayan at stat.wisc.edu  Fri Mar 11 02:57:13 2005
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Fri Mar 11 02:56:18 2005
Subject: [Rd] unexpected behaviour of expression(sum())
Message-ID: <200503101957.13827.deepayan@stat.wisc.edu>


I'm seeing inconsistent symbols from the same expression with the 
following code:


expr = expression(sum(x, 1, n))
plot(1, main = expr, type = "n")
text(1, 1, expr)


Moreover, the inconsistency is reversed in r-devel compared to R 2.0.1. 
In particular, the main label shows a \bigoplus instead of \sum in 
r-devel, and the other way round in 2.0.1. demo(plotmath) shows \sum in 
both.

Can anyone confirm? Is this intended behaviour (though I can't see how)?

-Deepayan

From keithw at galen.med.usyd.edu.au  Fri Mar 11 03:10:20 2005
From: keithw at galen.med.usyd.edu.au (Keith Wong)
Date: Fri Mar 11 03:11:44 2005
Subject: [Rd] Package Installation in RGui (PR#7262)
Message-ID: <6.0.0.22.2.20050311125955.01dec310@mail.med.usyd.edu.au>

In reference to the thread 
http://tolstoy.newcastle.edu.au/R/devel/04/10/0859.html

I have the same problem updating packages with newly-installed version of 
released version of R 2.0.1. Previous posts refer to a bug in windows. I 
wonder if there is a work-around? This probably should go to R-help but it 
follows on from the post in R-devel. Apologies in advance.

OS: Windows XP Professional, with current patches. I have administrator rights.
R version 2.0.1 released version (newly re-installed).

Problem:
update.packages() downloads the binaries, but installation stops with the 
same error message, and the package to be upgraded disappears entirely:

package 'boot' successfully unpacked and MD5 sums checked
bundle 'VR' successfully unpacked and MD5 sums checked
package 'cluster' successfully unpacked and MD5 sums checked
package 'foreign' successfully unpacked and MD5 sums checked
package 'KernSmooth' successfully unpacked and MD5 sums checked
package 'lattice' successfully unpacked and MD5 sums checked
package 'nlme' successfully unpacked and MD5 sums checked
Error: Can not remove prior installation of package 'nlme'
In addition: Warning message:
unable to move temp installation 
'C:/PROGRA~1/R/rw2001/library\file30867/foreign' to 
'C:/PROGRA~1/R/rw2001/library/foreign'
 > library(nlme)
Error in library(nlme) : There is no package called 'nlme'


Keith


 > update.packages()
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 26875 bytes
opened URL
downloaded 26Kb

boot :
  Version 1.2-20 in C:/PROGRA~1/R/rw2001/library
  Version 1.2-22 on CRAN
Update (y/N)?  y
VR :
  Version 7.2-10 in C:/PROGRA~1/R/rw2001/library
  Version 7.2-12 on CRAN
Update (y/N)?  y
cluster :
  Version 1.9.6 in C:/PROGRA~1/R/rw2001/library
  Version 1.9.7 on CRAN
Update (y/N)?  y
foreign :
  Version 0.8-0 in C:/PROGRA~1/R/rw2001/library
  Version 0.8-5 on CRAN
Update (y/N)?  y
KernSmooth :
  Version 2.22-14 in C:/PROGRA~1/R/rw2001/library
  Version 2.22-15 on CRAN
Update (y/N)?  y
lattice :
  Version 0.10-14 in C:/PROGRA~1/R/rw2001/library
  Version 0.10-16 on CRAN
Update (y/N)?  y
nlme :
  Version 3.1-53 in C:/PROGRA~1/R/rw2001/library
  Version 3.1-56 on CRAN
Update (y/N)?  y
rpart :
  Version 3.1-20 in C:/PROGRA~1/R/rw2001/library
  Version 3.1-22 on CRAN
Update (y/N)?  y
survival :
  Version 2.15 in C:/PROGRA~1/R/rw2001/library
  Version 2.16 on CRAN
Update (y/N)?  y
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/boot_1.2-22.zip'
Content type `application/zip' length 767540 bytes
opened URL
downloaded 749Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/VR_7.2-12.zip'
Content type `application/zip' length 1551825 bytes
opened URL
downloaded 1515Kb

trying URL 
`http://cran.r-project.org/bin/windows/contrib/2.0/cluster_1.9.7.zip'
Content type `application/zip' length 472995 bytes
opened URL
downloaded 461Kb

trying URL 
`http://cran.r-project.org/bin/windows/contrib/2.0/foreign_0.8-5.zip'
Content type `application/zip' length 172108 bytes
opened URL
downloaded 168Kb

trying URL 
`http://cran.r-project.org/bin/windows/contrib/2.0/KernSmooth_2.22-15.zip'
Content type `application/zip' length 95039 bytes
opened URL
downloaded 92Kb

trying URL 
`http://cran.r-project.org/bin/windows/contrib/2.0/lattice_0.10-16.zip'
Content type `application/zip' length 650372 bytes
opened URL
downloaded 635Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/nlme_3.1-56.zip'
Content type `application/zip' length 2144937 bytes
opened URL
downloaded 2094Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/rpart_3.1-22.zip'
Content type `application/zip' length 233548 bytes
opened URL
downloaded 228Kb

trying URL 
`http://cran.r-project.org/bin/windows/contrib/2.0/survival_2.16.zip'
Content type `application/zip' length 954786 bytes
opened URL
downloaded 932Kb

package 'boot' successfully unpacked and MD5 sums checked
bundle 'VR' successfully unpacked and MD5 sums checked
package 'cluster' successfully unpacked and MD5 sums checked
package 'foreign' successfully unpacked and MD5 sums checked
package 'KernSmooth' successfully unpacked and MD5 sums checked
package 'lattice' successfully unpacked and MD5 sums checked
package 'nlme' successfully unpacked and MD5 sums checked
Error: Can not remove prior installation of package 'nlme'
In addition: Warning message:
unable to move temp installation 
'C:/PROGRA~1/R/rw2001/library\file30867/foreign' to 
'C:/PROGRA~1/R/rw2001/library/foreign'
 > library(nlme)
Error in library(nlme) : There is no package called 'nlme'
 > library(lattice)
 > library(boot)

Attaching package 'boot':


         The following object(s) are masked from package:lattice :

          melanoma

 > library(rpart)
 > library(survival)
Loading required package: splines

Attaching package 'survival':


         The following object(s) are masked from package:boot :

          aml

 > library(VR)
Error in library(VR) : There is no package called 'VR'
 > library(cluster)
 > library(foreign)
Error in library(foreign) : There is no package called 'foreign'
 > library(KernSmooth)
KernSmooth 2.22 installed
Copyright M. P. Wand 1997
 > library(lattice)
 > local({a <- CRAN.packages()
+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a, 
dependencies=TRUE)})
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 26875 bytes
opened URL
downloaded 26Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/nlme_3.1-56.zip'
Content type `application/zip' length 2144937 bytes
opened URL
downloaded 2094Kb

package 'nlme' successfully unpacked and MD5 sums checked

Delete downloaded files (y/N)?
The packages are in C:\DOCUME~1\KeithW\LOCALS~1\Temp\Rtmp6848\Rinstdir19641
updating HTML package descriptions
 > local({a <- CRAN.packages()
+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a, 
dependencies=TRUE)})
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 26875 bytes
opened URL
downloaded 26Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/VR_7.2-12.zip'
Content type `application/zip' length 1551825 bytes
opened URL
downloaded 1515Kb

bundle 'VR' successfully unpacked and MD5 sums checked
Error: Can not remove prior installation of package 'MASS'
 >

From MSchwartz at MedAnalytics.com  Fri Mar 11 04:00:54 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Fri Mar 11 04:01:03 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <200503101957.13827.deepayan@stat.wisc.edu>
References: <200503101957.13827.deepayan@stat.wisc.edu>
Message-ID: <1110510054.14726.45.camel@horizons.localdomain>

On Thu, 2005-03-10 at 19:57 -0600, Deepayan Sarkar wrote:
> I'm seeing inconsistent symbols from the same expression with the 
> following code:
> 
> 
> expr = expression(sum(x, 1, n))
> plot(1, main = expr, type = "n")
> text(1, 1, expr)
> 
> 
> Moreover, the inconsistency is reversed in r-devel compared to R 2.0.1. 
> In particular, the main label shows a \bigoplus instead of \sum in 
> r-devel, and the other way round in 2.0.1. demo(plotmath) shows \sum in 
> both.
> 
> Can anyone confirm? Is this intended behaviour (though I can't see how)?


No problem in "Version 2.0.1 Patched (2005-03-07)". I get \sum in both
places. I do not see anything in the NEWS file suggesting a bug fix for
this.

I just installed "Version 2.1.0 Under development (unstable)
(2005-03-11)" and do not see the problem there either.

Both are under FC3.

HTH,

Marc Schwartz

From ripley at stats.ox.ac.uk  Fri Mar 11 08:19:25 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Mar 11 08:19:35 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <1110510054.14726.45.camel@horizons.localdomain>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<1110510054.14726.45.camel@horizons.localdomain>
Message-ID: <Pine.LNX.4.61.0503110705200.12191@gannet.stats>

On Thu, 10 Mar 2005, Marc Schwartz wrote:

> On Thu, 2005-03-10 at 19:57 -0600, Deepayan Sarkar wrote:
>> I'm seeing inconsistent symbols from the same expression with the
>> following code:
>>
>>
>> expr = expression(sum(x, 1, n))
>> plot(1, main = expr, type = "n")
>> text(1, 1, expr)
>>
>>
>> Moreover, the inconsistency is reversed in r-devel compared to R 2.0.1.
>> In particular, the main label shows a \bigoplus instead of \sum in
>> r-devel, and the other way round in 2.0.1. demo(plotmath) shows \sum in
>> both.
>>
>> Can anyone confirm? Is this intended behaviour (though I can't see how)?
>
>
> No problem in "Version 2.0.1 Patched (2005-03-07)". I get \sum in both
> places. I do not see anything in the NEWS file suggesting a bug fix for
> this.
>
> I just installed "Version 2.1.0 Under development (unstable)
> (2005-03-11)" and do not see the problem there either.
>
> Both are under FC3.

We need to know both the device and the locale.  Assuming this is X11,
there are two fixes for font selection:

     o	X11() was only scaling its fonts to pointsize if the dpi
 	was within 0.5 of 100dpi.

     o	X11() font selection was looking for any symbol font, and
 	sometimes got e.g. bold italic if the server has such a font.

The main title in plot() and text() are asking for different sizes.
If Deepayan had problems with getting a valid (Adobe symbol-encoded) font,
this might vary by size which would explain the reported differences.

Deepayan: can you please check what symbol fonts you have: the pattern in 
R-devel is

"-adobe-symbol-medium-r-*-*-*-*-*-*-*-*-*-*"

(Ideally we would select on encoding, but that is usually 'fontspecific' 
so not helpful.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri Mar 11 10:39:40 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Mar 11 10:39:49 2005
Subject: [Rd] R_alloc with more than 2GB (PR#7721)
In-Reply-To: <4230CBF5.2030903@ebi.ac.uk>
References: <20050310210708.309A0C00D@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0503102137330.5792@gannet.stats>
	<4230CBF5.2030903@ebi.ac.uk>
Message-ID: <Pine.LNX.4.61.0503110924150.11808@gannet.stats>

On Thu, 10 Mar 2005, Wolfgang Huber wrote:

> Dear Prof Ripley,
>
>> It is a feature.  Other parts of R expect a CHARSXP to have length less 
>> than or equal to 2^31 - 1.
>
> OK, after looking closer at the code and comments in memory.c and 
> Rinternals.h (typedef int R_len_t;) I realized that.
>
>> 
>> Could you not use x = allocVector(REALSXP, vs) and REAL(x)[i]?  That will 
>> get you up to 2^31 - 1 elements, which is the R limit AFAIK.
>
> Thanks, that is an excellent idea. It should be fine for my immediate needs, 
> and better what I've just been doing with Calloc!
>
>> Because of the use of Fortran, it is hard to see how to allow internal
>> lengths (in elements, not necessarily bytes) to exceed that value.  We
>> need to return to that, but it is not straightforward and last time we
>> discussed it we agreed to defer it.
>
>> We can manage a better error message, but I am afraid nothing else in
>> the near future.
>
> In the application that triggered this posting, the memory is for a C array 
> of doubles within a user-defined C function, not for anything that needs to 
> become an R object, so maybe a suggestion would be to make R_alloc go 
> directly to malloc without the detour over allocString or allocVector; or 
> something along that line?

R_alloc makes use of garbage collection to avoid the need for explicit
free()ing.  Otherwise you might as well use Calloc.

Given that all memory allocated via the heap is aligned to doubles, there 
seems to me to be little or no loss in using a REALSXP rather than a 
CHARSXP, and certainly negligible loss for large vectors.  That will buy 
us a factor of 8 for the present.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From luke at stat.uiowa.edu  Fri Mar 11 13:15:37 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri Mar 11 13:16:02 2005
Subject: [Rd] How to use Rmpi?
In-Reply-To: <1686.130.186.7.46.1110460566.squirrel@student.unife.it>
References: <1686.130.186.7.46.1110460566.squirrel@student.unife.it>
Message-ID: <Pine.LNX.4.61.0503110612111.15202@itasca2.stat.uiowa.edu>

If your computation is simple enough to express in terms of lapply or
other apply calls that you want to have run in parallel then you might
try the 'snow' package on CRAN which can run on top of Rmpi.  Some
places to get more details on that:

http://www.stat.uiowa.edu/~luke/R/cluster/cluster.html
http://www.bepress.com/cgi/viewcontent.cgi?article=1016&context=uwbiostat

Best,

luke

On Thu, 10 Mar 2005, Alessandro Balboni wrote:

> I need to rewrite a software in R, that runs on a cluster.
>
> I thought Rmpi will be good for me but I can't find
> any help other than the Rmpi-manual that actually only
> describe the functions in the Rmpi package.
>
> Can someone point me to some usefull guide?
>
> For example, I would like to run a for-statement on
> several processors (a subset of the statement on each
> processor) but I can't figure out how to do this!
>
> Thanks
>
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From murdoch at stats.uwo.ca  Fri Mar 11 13:39:38 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Mar 11 13:39:40 2005
Subject: [Rd] Quirk with as.function(..., envir = NULL) and body(...,
	envir = NULL) <-
Message-ID: <kr3331peistth8hom70kdun6gsm99o5uuk@4ax.com>

I've been doing some looking through the environment code lately, and
noticed that both as.function(..., envir = NULL) and body(..., envir =
NULL)<- treat the NULL as .GlobalEnv, even though NULL is the
environment of the base package.

The code that does this is very deep in the guts of R and affects all
sorts of things, so I'm not planning to change it for 2.1.0, but I
expect it will be fixed in 2.2.0 this fall.

In the meantime, I'd advise people to avoid using envir = NULL, and
instead use envir = globalenv() or envir = .GlobalEnv (which are
equivalent).  

If you want to set base as the environment for a function, you should
use

environment(f) <- NULL

for now. 

Duncan Murdoch

From jtk at cmp.uea.ac.uk  Fri Mar 11 14:49:08 2005
From: jtk at cmp.uea.ac.uk (jtk@cmp.uea.ac.uk)
Date: Fri Mar 11 14:49:16 2005
Subject: [Rd] read.table messes up stdin upon small,
	erroneous input (PR#7722)
Message-ID: <20050311134908.F3742C020@slim.kubism.ku.dk>

Full_Name: Jan T. Kim
Version: 2.0.1, devel-2005-02-24
OS: Linux 2.6.x
Submission from: (NULL) (139.222.3.229)


Run read.table(stdin()) and type in the broken table
1 2
1

terminating the input by pressing Ctrl-D at the 3rd line of input. An error
message by scan, complaining that "line 2 did not have 2 elements" appears,
as expected. However: After this, there are three empty lines buffered in
stdin:

> readLines(stdin())
[1] "" "" ""

Repeated attempts to read.table the broken input from stdin lead to even more
strange results:

> read.table(stdin())
0: 1 2
1: 1
2: Error in scan(file = file, what = what, sep = sep, quote = quote, dec = dec, 
: 
        line 2 did not have 2 elements
> read.table(stdin())
3: 1 2
4: 1
[1] V1 V2
<0 rows> (or 0-length row.names)
> 

Analysis: These effects are due to a combination of (1) the fact that
there appear to be various routes of accessing the standard input,
depending on context, and (2) the use of pushback in the process of
automatically figuring out the table format:

    * read.table uses .Internal(readTableHead(...)) to get the first
      nlines lines of the table (nlines = 5).

    * .Internal(readTableHead(...)) always returns nlines lines, adding
      empty lines if EOF comes before nlines lines are read.

    * These lines, including any empty ones not originating from the
      file in the first place, are then pushed back twice

    * The first set of lines is always consumed off by the subsequent
      code to figure out the number of columns.

    * The second set is intended to be consumed by the regular operation
      of scan.
      
    * However, if scan chokes before it can consume these lines, including
      the blank ones, these will be left in the pushback buffer.

    * R's interactive fetch-parse-evaluate loop does not use the connection
      provided by stdin(), and therefore, the buffered stuff is not
      noticed until the next attempt to read from the stdin connection.

The strange effects reported above could probably be fixed by modifying
the internal readTableHead function such that it does not produce emtpy
lines in order to return the number of lines "requested" by the nlines
parameter.

A more fundamental approach would be to avoid pushing back lines
altogether. The repeated scanning of the first few lines could be
done by using a textConnection instead. Some additional work will
probably be necessary to combine the first few and the remaining
lines, acquired by regular operation of scan, into the complete
table.

From murdoch at stats.uwo.ca  Fri Mar 11 17:05:48 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Mar 11 17:06:05 2005
Subject: [Rd] delay() has been deprecated for 2.1.0
Message-ID: <jje331l77dn9euafto7pb0conu1bh0r3as@4ax.com>

After a bunch of discussion in the core group, we have decided to
deprecate the delay() function (which was introduced as "experimental"
in R 0.50).  This is the function that duplicates in R code the
delayed evaluation mechanism (the promise) that's used in evaluating
function arguments.

The problem with delay() was that it was handled inconsistently (e.g.
sometimes you would see an object displayed as <promise:...>,
sometimes it would be evaluated); it tended to be error-prone in usage
(e.g. this was the cause of the bug that makes the curve() function
create a "pu" object in the global environment); and it was generally
difficult to figure out exactly what the semantics of it should be in
order to be consistent.  

delay() has been replaced with delayedAssign().  This new function
creates a promise and assigns it into an environment.  Once one more
set of changes is made and delay() is gone, there should be no way to
see a <promise: ...> object in R:  as soon as the object is accessed,
it will be evaluated and you'll see the value.

A few packages made use of delay().  I have replaced all of those uses
with delayedAssign().  The most common usage was something like the QA
code uses:

assign("T", delay(stop("T used instead of TRUE")),
		  pos = .CheckExEnv)

This translates to

delayedAssign("T", stop("T used instead of TRUE"), eval.env =
.GlobalEnv, assign.env = .CheckExEnv)

In most cases the "eval.env = .GlobalEnv" argument is not necessary
(and in fact it is often a bug, as it was in curve()).  The
environment where the promise is to be evaluated now defaults to the
environment where the call is being made, rather than the global
environment, and this is usually what you want.

Package writers who use delay() will now get a warning that it has
been deprecated.  They should recode their package to use
delayedAssign instead.

Examples from CRAN of this (I am not sure if this list is exhaustive):

exactRankTests, genetics, g.data, maxstat, taskPR, coin

I have cc'd the maintainers of those packages.

If you want a single code base for your package that works in both the
upcoming R 2.1.0 and older versions, this presents a problem: older
versions don't have delayedAssign.  Here is a workalike function that
could be used in older versions:

delayedAssign <- function(x, value,
		eval.env = parent.frame(),
		assign.env = parent.frame()) {
 assign(x, .Internal(delay(substitute(value), eval.env)), 
           envir = assign.env)
}

Because this function calls the internal delay() function directly, it
should work in R 2.1.0+ as well without a warning, but the internal
function will eventually go away too, so I don't recommend using it in
the long term.

Sorry for any inconvenience that this causes.

Duncan Murdoch

From deepayan at stat.wisc.edu  Fri Mar 11 17:53:59 2005
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Fri Mar 11 17:53:03 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <Pine.LNX.4.61.0503110705200.12191@gannet.stats>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<1110510054.14726.45.camel@horizons.localdomain>
	<Pine.LNX.4.61.0503110705200.12191@gannet.stats>
Message-ID: <200503111053.59534.deepayan@stat.wisc.edu>

On Friday 11 March 2005 01:19, Prof Brian Ripley wrote:
> On Thu, 10 Mar 2005, Marc Schwartz wrote:
> > On Thu, 2005-03-10 at 19:57 -0600, Deepayan Sarkar wrote:
> >> I'm seeing inconsistent symbols from the same expression with the
> >> following code:
> >>
> >>
> >> expr = expression(sum(x, 1, n))
> >> plot(1, main = expr, type = "n")
> >> text(1, 1, expr)
> >>
> >>
> >> Moreover, the inconsistency is reversed in r-devel compared to R
> >> 2.0.1. In particular, the main label shows a \bigoplus instead of
> >> \sum in r-devel, and the other way round in 2.0.1. demo(plotmath)
> >> shows \sum in both.
> >>
> >> Can anyone confirm? Is this intended behaviour (though I can't see
> >> how)?
> >
> > No problem in "Version 2.0.1 Patched (2005-03-07)". I get \sum in
> > both places. I do not see anything in the NEWS file suggesting a
> > bug fix for this.
> >
> > I just installed "Version 2.1.0 Under development (unstable)
> > (2005-03-11)" and do not see the problem there either.
> >
> > Both are under FC3.
>
> We need to know both the device and the locale.  Assuming this is
> X11, there are two fixes for font selection:

Yes, it's X11, with locale "C". It doesn't happen with postscript (I 
haven't tried anything else).

I had tried on 3 different machines other than my desktop, but all 
remotely. Marc's reply suggested that this was a problem with X on my 
local machine, and I haven't yet had a chance to check on any others.

>      o X11() was only scaling its fonts to pointsize if the dpi
>   was within 0.5 of 100dpi.
>
>      o X11() font selection was looking for any symbol font, and
>   sometimes got e.g. bold italic if the server has such a font.
>
> The main title in plot() and text() are asking for different sizes.
> If Deepayan had problems with getting a valid (Adobe symbol-encoded)
> font, this might vary by size which would explain the reported
> differences.
>
> Deepayan: can you please check what symbol fonts you have: the
> pattern in R-devel is
>
> "-adobe-symbol-medium-r-*-*-*-*-*-*-*-*-*-*"
>
> (Ideally we would select on encoding, but that is usually
> 'fontspecific' so not helpful.)

I'm not really sure what I'm looking for, but everything I get seems to 
be 'fontspecific':

deepayan $ xlsfonts | grep adobe-symbol-medium
-adobe-symbol-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific
-adobe-symbol-medium-r-normal--0-0-100-100-p-0-adobe-fontspecific
-adobe-symbol-medium-r-normal--0-0-75-75-p-0-adobe-fontspecific
-adobe-symbol-medium-r-normal--10-100-75-75-p-61-adobe-fontspecific
-adobe-symbol-medium-r-normal--10-100-75-75-p-61-adobe-fontspecific
-adobe-symbol-medium-r-normal--11-80-100-100-p-61-adobe-fontspecific
-adobe-symbol-medium-r-normal--11-80-100-100-p-61-adobe-fontspecific
-adobe-symbol-medium-r-normal--12-120-75-75-p-74-adobe-fontspecific
-adobe-symbol-medium-r-normal--12-120-75-75-p-74-adobe-fontspecific
-adobe-symbol-medium-r-normal--14-100-100-100-p-85-adobe-fontspecific
-adobe-symbol-medium-r-normal--14-100-100-100-p-85-adobe-fontspecific
-adobe-symbol-medium-r-normal--14-140-75-75-p-85-adobe-fontspecific
-adobe-symbol-medium-r-normal--14-140-75-75-p-85-adobe-fontspecific
-adobe-symbol-medium-r-normal--17-120-100-100-p-95-adobe-fontspecific
-adobe-symbol-medium-r-normal--17-120-100-100-p-95-adobe-fontspecific
-adobe-symbol-medium-r-normal--18-180-75-75-p-107-adobe-fontspecific
-adobe-symbol-medium-r-normal--18-180-75-75-p-107-adobe-fontspecific
-adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific
-adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific
-adobe-symbol-medium-r-normal--24-240-75-75-p-142-adobe-fontspecific
-adobe-symbol-medium-r-normal--24-240-75-75-p-142-adobe-fontspecific
-adobe-symbol-medium-r-normal--25-180-100-100-p-142-adobe-fontspecific
-adobe-symbol-medium-r-normal--25-180-100-100-p-142-adobe-fontspecific
-adobe-symbol-medium-r-normal--34-240-100-100-p-191-adobe-fontspecific
-adobe-symbol-medium-r-normal--34-240-100-100-p-191-adobe-fontspecific
-adobe-symbol-medium-r-normal--8-80-75-75-p-51-adobe-fontspecific
-adobe-symbol-medium-r-normal--8-80-75-75-p-51-adobe-fontspecific
deepayan $ 

-Deepayan

From ripley at stats.ox.ac.uk  Fri Mar 11 18:17:45 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Mar 11 18:17:56 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <200503111053.59534.deepayan@stat.wisc.edu>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<1110510054.14726.45.camel@horizons.localdomain>
	<Pine.LNX.4.61.0503110705200.12191@gannet.stats>
	<200503111053.59534.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.61.0503111658340.16843@gannet.stats>

I see you have both a scalable font (the first) and size-specfic fonts. 
My guess is that the scalable font is not encoded in the same way as the 
others: can you track down where it is coming from?

Otherwise my list on FC3 is the same as yours (minus the duplicates, which 
are also puzzling).  I have also just checked Exceed, which has the same 
list plus scalable fonts (and also has

-adobe-symbol-0-0-normal--0-0-0-0-p-0-adobe-fontspecific
-adobe-symbol-0-0-normal--0-0-0-0-p-0-sun-fontspecific
-adobe-symbol-0-0-normal--0-0-100-100-p-0-adobe-fontspecific
-adobe-symbol-0-0-normal--0-0-100-100-p-0-sun-fontspecific
-adobe-symbol-0-0-normal--0-0-75-75-p-0-adobe-fontspecific
-adobe-symbol-0-0-normal--0-0-75-75-p-0-sun-fontspecific

which caused problems for 2.0.1 with getting bold symbols in some sizes, 
hence the second bug fix I mentioned).

As a wild guess, do you have a font server as well as local fonts?

Brian


On Fri, 11 Mar 2005, Deepayan Sarkar wrote:

> On Friday 11 March 2005 01:19, Prof Brian Ripley wrote:
>> On Thu, 10 Mar 2005, Marc Schwartz wrote:
>>> On Thu, 2005-03-10 at 19:57 -0600, Deepayan Sarkar wrote:
>>>> I'm seeing inconsistent symbols from the same expression with the
>>>> following code:
>>>>
>>>>
>>>> expr = expression(sum(x, 1, n))
>>>> plot(1, main = expr, type = "n")
>>>> text(1, 1, expr)
>>>>
>>>>
>>>> Moreover, the inconsistency is reversed in r-devel compared to R
>>>> 2.0.1. In particular, the main label shows a \bigoplus instead of
>>>> \sum in r-devel, and the other way round in 2.0.1. demo(plotmath)
>>>> shows \sum in both.
>>>>
>>>> Can anyone confirm? Is this intended behaviour (though I can't see
>>>> how)?
>>>
>>> No problem in "Version 2.0.1 Patched (2005-03-07)". I get \sum in
>>> both places. I do not see anything in the NEWS file suggesting a
>>> bug fix for this.
>>>
>>> I just installed "Version 2.1.0 Under development (unstable)
>>> (2005-03-11)" and do not see the problem there either.
>>>
>>> Both are under FC3.
>>
>> We need to know both the device and the locale.  Assuming this is
>> X11, there are two fixes for font selection:
>
> Yes, it's X11, with locale "C". It doesn't happen with postscript (I
> haven't tried anything else).
>
> I had tried on 3 different machines other than my desktop, but all
> remotely. Marc's reply suggested that this was a problem with X on my
> local machine, and I haven't yet had a chance to check on any others.
>
>>      o X11() was only scaling its fonts to pointsize if the dpi
>>   was within 0.5 of 100dpi.
>>
>>      o X11() font selection was looking for any symbol font, and
>>   sometimes got e.g. bold italic if the server has such a font.
>>
>> The main title in plot() and text() are asking for different sizes.
>> If Deepayan had problems with getting a valid (Adobe symbol-encoded)
>> font, this might vary by size which would explain the reported
>> differences.
>>
>> Deepayan: can you please check what symbol fonts you have: the
>> pattern in R-devel is
>>
>> "-adobe-symbol-medium-r-*-*-*-*-*-*-*-*-*-*"
>>
>> (Ideally we would select on encoding, but that is usually
>> 'fontspecific' so not helpful.)
>
> I'm not really sure what I'm looking for, but everything I get seems to
> be 'fontspecific':
>
> deepayan $ xlsfonts | grep adobe-symbol-medium
> -adobe-symbol-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific
> -adobe-symbol-medium-r-normal--0-0-100-100-p-0-adobe-fontspecific
> -adobe-symbol-medium-r-normal--0-0-75-75-p-0-adobe-fontspecific
> -adobe-symbol-medium-r-normal--10-100-75-75-p-61-adobe-fontspecific
> -adobe-symbol-medium-r-normal--10-100-75-75-p-61-adobe-fontspecific
> -adobe-symbol-medium-r-normal--11-80-100-100-p-61-adobe-fontspecific
> -adobe-symbol-medium-r-normal--11-80-100-100-p-61-adobe-fontspecific
> -adobe-symbol-medium-r-normal--12-120-75-75-p-74-adobe-fontspecific
> -adobe-symbol-medium-r-normal--12-120-75-75-p-74-adobe-fontspecific
> -adobe-symbol-medium-r-normal--14-100-100-100-p-85-adobe-fontspecific
> -adobe-symbol-medium-r-normal--14-100-100-100-p-85-adobe-fontspecific
> -adobe-symbol-medium-r-normal--14-140-75-75-p-85-adobe-fontspecific
> -adobe-symbol-medium-r-normal--14-140-75-75-p-85-adobe-fontspecific
> -adobe-symbol-medium-r-normal--17-120-100-100-p-95-adobe-fontspecific
> -adobe-symbol-medium-r-normal--17-120-100-100-p-95-adobe-fontspecific
> -adobe-symbol-medium-r-normal--18-180-75-75-p-107-adobe-fontspecific
> -adobe-symbol-medium-r-normal--18-180-75-75-p-107-adobe-fontspecific
> -adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific
> -adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific
> -adobe-symbol-medium-r-normal--24-240-75-75-p-142-adobe-fontspecific
> -adobe-symbol-medium-r-normal--24-240-75-75-p-142-adobe-fontspecific
> -adobe-symbol-medium-r-normal--25-180-100-100-p-142-adobe-fontspecific
> -adobe-symbol-medium-r-normal--25-180-100-100-p-142-adobe-fontspecific
> -adobe-symbol-medium-r-normal--34-240-100-100-p-191-adobe-fontspecific
> -adobe-symbol-medium-r-normal--34-240-100-100-p-191-adobe-fontspecific
> -adobe-symbol-medium-r-normal--8-80-75-75-p-51-adobe-fontspecific
> -adobe-symbol-medium-r-normal--8-80-75-75-p-51-adobe-fontspecific
> deepayan $
>
> -Deepayan
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pgilbert at bank-banque-canada.ca  Fri Mar 11 18:34:10 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Mar 11 18:35:49 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <4231D692.6080600@bank-banque-canada.ca>

If I understand this correctly, I think it is a great idea. Just to be 
sure I do understand, would you expect there might also be a "Time 
Series" view, which would probably overlap some with the "Econometrics" 
view?

Paul Gilbert

Achim Zeileis wrote:

> Dear developeRs,
> 
> in the last month I mentioned in several discussions on R-help that Kurt
> and I were working on tools for "CRAN Task Views" which should help to
> structure the fast-growing list of packages on CRAN.
> 
> Now the first version of a package called ctv (for CRAN Task Views) is
> available from CRAN and also two frist drafts for such views can be seen
> at 
>   http://CRAN.R-project.org/src/contrib/Views/
> 
> When you install the ctv package you can also query this from within R
> via:
>   CRAN.views()
>   install.views("Econometrics", lib = "/path/to/foo")
> 
> New views can be easily written in an XML-based format from which we can
> generate the HTML information displayed on the Web and also the
> information needed for querying the views via CRAN.views(). The package
> contains a short vignette that explains how to write new task views.
> 
> Feedback on the package would be very welcome! Furthermore, if you want
> to write and maintain a new task view for a certain topic, that would be
> great! Just drop me an e-mail with your suggestion.
> 
> Best wishes from Vienna,
> Z
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From Achim.Zeileis at wu-wien.ac.at  Fri Mar 11 19:10:09 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Fri Mar 11 19:10:10 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <4231D692.6080600@bank-banque-canada.ca>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>
	<4231D692.6080600@bank-banque-canada.ca>
Message-ID: <20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>

Paul,

thanks for the feedback.

> If I understand this correctly, I think it is a great idea. Just to be
> sure I do understand, would you expect there might also be a "Time 
> Series" view, which would probably overlap some with the
> "Econometrics" view?

In principle, the presence of an "Econometrics" view does not preclude
the existence of a "TimeSeries" or "Finance" view (I already talked with
Dirk privately about the latter). Even if the overlap in packages would
be substantial, there could be value added via the information on the
corresponding HTML page. 
Currently, my personal opinion would be that we don't need a separate
"TimeSeries" view and that we should extend the information on the
Econometrics page instead. But it's not unlikely that I could be
convinced otherwise :-) So if you've got suggestions in that direction,
just let me know.

Best,
Z

From pgilbert at bank-banque-canada.ca  Fri Mar 11 20:04:36 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Mar 11 20:06:14 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>	<4231D692.6080600@bank-banque-canada.ca>
	<20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <4231EBC4.5070508@bank-banque-canada.ca>

Achim Zeileis wrote:

> Paul,
> 
> thanks for the feedback.
> 
> 
>>If I understand this correctly, I think it is a great idea. Just to be
>>sure I do understand, would you expect there might also be a "Time 
>>Series" view, which would probably overlap some with the
>>"Econometrics" view?
> 
> 
> In principle, the presence of an "Econometrics" view does not preclude
> the existence of a "TimeSeries" or "Finance" view (I already talked with
> Dirk privately about the latter). Even if the overlap in packages would
> be substantial, there could be value added via the information on the
> corresponding HTML page. 
> Currently, my personal opinion would be that we don't need a separate
> "TimeSeries" view and that we should extend the information on the
> Econometrics page instead. But it's not unlikely that I could be
> convinced otherwise :-) So if you've got suggestions in that direction,
> just let me know.

Achim

For my own purposes the "Econometrics" view is just fine, but I do 
sometimes get questions about dse from people in fields that are 
different enough that they might not even know to look in 
"Econometrics." A time series view might be useful even if it only said 
see also ... .  Another approach to this might be to have sub-views so, 
for example, "Econometrics" and "Control theory" could both point to 
"Time series."

Other things that might be useful are various programming views, like a 
Matlab view, and an SPSS view.

I feel uncomfortable suggesting things that sound more like work than 
feedback, because I am not about to offer to maintain anything. I have 
too much on my plate right now. But in this regard it would be nice to 
draw on more people contributing smaller pieces. Have you considered 
something like a wiki?

Best,
Paul

> 
> Best,
> Z
>

From MSchwartz at MedAnalytics.com  Fri Mar 11 20:13:51 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Fri Mar 11 20:15:47 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <Pine.LNX.4.61.0503111658340.16843@gannet.stats>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<1110510054.14726.45.camel@horizons.localdomain>
	<Pine.LNX.4.61.0503110705200.12191@gannet.stats>
	<200503111053.59534.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503111658340.16843@gannet.stats>
Message-ID: <1110568431.5799.13.camel@horizons.localdomain>

On Fri, 2005-03-11 at 17:17 +0000, Prof Brian Ripley wrote:
> I see you have both a scalable font (the first) and size-specfic fonts. 
> My guess is that the scalable font is not encoded in the same way as the 
> others: can you track down where it is coming from?
> 
> Otherwise my list on FC3 is the same as yours (minus the duplicates, which 
> are also puzzling).  I have also just checked Exceed, which has the same 
> list plus scalable fonts (and also has
> 
> -adobe-symbol-0-0-normal--0-0-0-0-p-0-adobe-fontspecific
> -adobe-symbol-0-0-normal--0-0-0-0-p-0-sun-fontspecific
> -adobe-symbol-0-0-normal--0-0-100-100-p-0-adobe-fontspecific
> -adobe-symbol-0-0-normal--0-0-100-100-p-0-sun-fontspecific
> -adobe-symbol-0-0-normal--0-0-75-75-p-0-adobe-fontspecific
> -adobe-symbol-0-0-normal--0-0-75-75-p-0-sun-fontspecific
> 
> which caused problems for 2.0.1 with getting bold symbols in some sizes, 
> hence the second bug fix I mentioned).
> 
> As a wild guess, do you have a font server as well as local fonts?
> 
> Brian


FWIW, here is my list:

$ xlsfonts | grep adobe-symbol
-adobe-symbol-medium-r-normal--10-100-75-75-p-61-adobe-fontspecific
-adobe-symbol-medium-r-normal--11-80-100-100-p-61-adobe-fontspecific
-adobe-symbol-medium-r-normal--12-120-75-75-p-74-adobe-fontspecific
-adobe-symbol-medium-r-normal--14-100-100-100-p-85-adobe-fontspecific
-adobe-symbol-medium-r-normal--14-140-75-75-p-85-adobe-fontspecific
-adobe-symbol-medium-r-normal--17-120-100-100-p-95-adobe-fontspecific
-adobe-symbol-medium-r-normal--18-180-75-75-p-107-adobe-fontspecific
-adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific
-adobe-symbol-medium-r-normal--24-240-75-75-p-142-adobe-fontspecific
-adobe-symbol-medium-r-normal--25-180-100-100-p-142-adobe-fontspecific
-adobe-symbol-medium-r-normal--34-240-100-100-p-191-adobe-fontspecific
-adobe-symbol-medium-r-normal--8-80-75-75-p-51-adobe-fontspecific

Deepayan, which X server is being used? FC3 (fully updated) is using
xorg 6.8.1 if that might make a difference. 

Marc

From Achim.Zeileis at wu-wien.ac.at  Fri Mar 11 20:26:34 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Fri Mar 11 20:26:34 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <4231EBC4.5070508@bank-banque-canada.ca>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>
	<4231D692.6080600@bank-banque-canada.ca>
	<20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>
	<4231EBC4.5070508@bank-banque-canada.ca>
Message-ID: <20050311202634.149afba2.Achim.Zeileis@wu-wien.ac.at>

On Fri, 11 Mar 2005 14:04:36 -0500 Paul Gilbert wrote:

> For my own purposes the "Econometrics" view is just fine, but I do 
> sometimes get questions about dse from people in fields that are 
> different enough that they might not even know to look in 
> "Econometrics." A time series view might be useful even if it only
> said see also ... .  Another approach to this might be to have
> sub-views so, for example, "Econometrics" and "Control theory" could
> both point to "Time series."

Yes, that is, of course, an obvious idea but it requires more
coordination between the different views, hence we've decided not to
support hierarchically ordered views. 
Re: "ControlTheory". If someone would raise his hand and provide a view
for that, it would be great. It could, of course, link to the
"Econometrics" view (and vice versa) but they wouldn't have a formally
defined subset in a "TimeSeries" view.

> Other things that might be useful are various programming views, like
> a Matlab view, and an SPSS view.

I'm not sure what you have in mind here, because I would think that this
amounts more to using the language in general than using certain
packages. But if someone has good ideas for a Matlab or SPSS view, I
would be interested to hear them.

> I feel uncomfortable suggesting things that sound more like work than 
> feedback, because I am not about to offer to maintain anything. I have
> too much on my plate right now. But in this regard it would be nice to
> draw on more people contributing smaller pieces. Have you considered 
> something like a wiki?

Yes, there have been discussions about stuff like that on R-SIG-Finance.
I think the presence of an "Econometrics" view shouldn't keep people
from setting up an econometrics wiki if they want something like that.
But my personal preference would be that someone starts collecting and
maintaining code snippets in an R package rather than a wiki. The
gregmisc bundle is a place for something like that with general
statistical functionality. And back then, when this was discussed on the
finance SIG, I suggested that someone who has some critical mass of code
would start something similar for finance/econometrics/time series
stuff.
Z

From simon.urbanek at r-project.org  Fri Mar 11 22:47:14 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri Mar 11 22:47:25 2005
Subject: [Rd] Customizable R_HOME at build time
Message-ID: <93C0ADB1-9D0C-4055-9095-033B5FC28B1F@r-project.org>

Currently there is no way to specify R_HOME at build time - it is 
hard-coded to ${prefix}/lib/R. This is slightly inconvenient for 
special setups (e.g. installing different versions of R in parallel). I 
was thinking of something like:

./configure --prefix=/usr --enable-custom-R-home=/usr/share/R-2.0

which will use /usr/share/R-2.0 as R_HOME - otherwise it would use 
/usr/lib/R

The following patch (against R-devel) implements that functionality, 
allowing more flexible builds/installs. As a side-effect it finally 
prints R_HOME in the configure summary.

Please let me know what you think ... (and yes, I know you don't have 
to run make install so one could build it in target place, but I think 
the above is more clean ..).

Cheers,
Simon

-------------- next part --------------
  
   
From pgilbert at bank-banque-canada.ca  Fri Mar 11 23:55:07 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Mar 11 23:56:45 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <20050311202634.149afba2.Achim.Zeileis@wu-wien.ac.at>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>	<4231D692.6080600@bank-banque-canada.ca>	<20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>	<4231EBC4.5070508@bank-banque-canada.ca>
	<20050311202634.149afba2.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <423221CB.7020008@bank-banque-canada.ca>

Achim
...
>>Other things that might be useful are various programming views, like
>>a Matlab view, and an SPSS view.
> 
> 
> I'm not sure what you have in mind here, because I would think that this
> amounts more to using the language in general than using certain
> packages. 
...

I guess I didn't see that this should only be about packages. It seems 
you could put just about anything in the HTML page. A table like

    Matlab    R translation
    -------    ------------
     eye(n)      diag(1,n)
       =            <-
  etc

might be useful to a lot of people converting from Matlab. I may have 
the above wrong, but I do have a good start on a table like this in a 
sed script somewhere, so if anyone volunteers to be the maintainer I can 
help a bit.

Paul

From Mark.Bravington at csiro.au  Sat Mar 12 01:55:21 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Sat Mar 12 01:55:38 2005
Subject: [Rd] delay() has been deprecated for 2.1.0
Message-ID: <4D99275E380CA94F998977EDACE548DC0625CE@extas2-hba.tas.csiro.au>

Uh-oh... I've just written a bunch of code for 'mvbutils' using 'delay', and am worried by the statement that "there should be no way to see a <promise:...> object in R". At present, it's possible to check whether 'x' is a promise via e.g. 'class( .GlobalEnv$x)'. This will be different to 'class( x)' if 'x' is a promise, regardless of whether the promise has or has not been forced yet. This can be very useful; my recent code relies on it to check whether certain objects have been changed since last being saved. [These certain objects are originally assigned as promises to load from individual files. Read-accessing the object keeps it as class 'promise', whereas write-access creates a non-promise. Thus I can tell whether the individual files need re-saving when the entire workspace is saved.]
 
The has-it-changed test has been very valuable to me in allowing fast handling of large collections of large objects (which is why I've been adding this functionality to 'mvbutils'); and apart from is-it-still-a-promise, I can't think of any other R-level way of testing whether an object has been modified. [If there is another way, please let me know!]
 
Is there any chance of retaining *some* R-level way of checking whether an object is a promise, both pre-forcing and post-forcing? (Not necessarily via the 'class( env$x)' method, if that's deemed objectionable.)
 
Mark Bravington
mark.bravington@csiro.au
 

	-----Original Message----- 
	From: r-devel-bounces@stat.math.ethz.ch on behalf of Duncan Murdoch 
	Sent: Sat 12/03/2005 3:05 AM 
	To: r-devel@stat.math.ethz.ch 
	Cc: Gregory Warnes; David Brahm; Torsten Hothorn; Nagiza F. Samatova 
	Subject: [Rd] delay() has been deprecated for 2.1.0
	
	

	After a bunch of discussion in the core group, we have decided to
	deprecate the delay() function (which was introduced as "experimental"
	in R 0.50).  This is the function that duplicates in R code the
	delayed evaluation mechanism (the promise) that's used in evaluating
	function arguments.
	
	The problem with delay() was that it was handled inconsistently (e.g.
	sometimes you would see an object displayed as <promise:...>,
	sometimes it would be evaluated); it tended to be error-prone in usage
	(e.g. this was the cause of the bug that makes the curve() function
	create a "pu" object in the global environment); and it was generally
	difficult to figure out exactly what the semantics of it should be in
	order to be consistent. 
	
	delay() has been replaced with delayedAssign().  This new function
	creates a promise and assigns it into an environment.  Once one more
	set of changes is made and delay() is gone, there should be no way to
	see a <promise: ...> object in R:  as soon as the object is accessed,
	it will be evaluated and you'll see the value.
	
	A few packages made use of delay().  I have replaced all of those uses
	with delayedAssign().  The most common usage was something like the QA
	code uses:
	
	assign("T", delay(stop("T used instead of TRUE")),
	                  pos = .CheckExEnv)
	
	This translates to
	
	delayedAssign("T", stop("T used instead of TRUE"), eval.env =
	.GlobalEnv, assign.env = .CheckExEnv)
	
	In most cases the "eval.env = .GlobalEnv" argument is not necessary
	(and in fact it is often a bug, as it was in curve()).  The
	environment where the promise is to be evaluated now defaults to the
	environment where the call is being made, rather than the global
	environment, and this is usually what you want.
	
	Package writers who use delay() will now get a warning that it has
	been deprecated.  They should recode their package to use
	delayedAssign instead.
	
	Examples from CRAN of this (I am not sure if this list is exhaustive):
	
	exactRankTests, genetics, g.data, maxstat, taskPR, coin
	
	I have cc'd the maintainers of those packages.
	
	If you want a single code base for your package that works in both the
	upcoming R 2.1.0 and older versions, this presents a problem: older
	versions don't have delayedAssign.  Here is a workalike function that
	could be used in older versions:
	
	delayedAssign <- function(x, value,
	                eval.env = parent.frame(),
	                assign.env = parent.frame()) {
	 assign(x, .Internal(delay(substitute(value), eval.env)),
	           envir = assign.env)
	}
	
	Because this function calls the internal delay() function directly, it
	should work in R 2.1.0+ as well without a warning, but the internal
	function will eventually go away too, so I don't recommend using it in
	the long term.
	
	Sorry for any inconvenience that this causes.
	
	Duncan Murdoch
	
	______________________________________________
	R-devel@stat.math.ethz.ch mailing list
	https://stat.ethz.ch/mailman/listinfo/r-devel

From edd at debian.org  Sat Mar 12 02:14:55 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat Mar 12 02:15:08 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <423221CB.7020008@bank-banque-canada.ca>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>
	<4231D692.6080600@bank-banque-canada.ca>
	<20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>
	<4231EBC4.5070508@bank-banque-canada.ca>
	<20050311202634.149afba2.Achim.Zeileis@wu-wien.ac.at>
	<423221CB.7020008@bank-banque-canada.ca>
Message-ID: <16946.17039.340033.755871@basebud.nulle.part>


Paul,

On 11 March 2005 at 17:55, Paul Gilbert wrote:
| Achim
| ...
| >>Other things that might be useful are various programming views, like
| >>a Matlab view, and an SPSS view.
| > 
| > 
| > I'm not sure what you have in mind here, because I would think that this
| > amounts more to using the language in general than using certain
| > packages. 
| ...
| 
| I guess I didn't see that this should only be about packages. It seems 
| you could put just about anything in the HTML page. A table like
| 
|     Matlab    R translation
|     -------    ------------
|      eye(n)      diag(1,n)
|        =            <-
|   etc
| 
| might be useful to a lot of people converting from Matlab. I may have 
| the above wrong, but I do have a good start on a table like this in a 
| sed script somewhere, so if anyone volunteers to be the maintainer I can 
| help a bit.

Recall that (at least some of) this exists already in Robin's page at
   http://cran.us.r-project.org/doc/contrib/R-and-octave-2.txt
(using the .us mirror here, adapt at will)

Dirk

-- 
Better to have an approximate answer to the right question than a precise 
answer to the wrong question.  --  John Tukey as quoted by John Chambers

From luke at stat.uiowa.edu  Sat Mar 12 05:03:52 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Sat Mar 12 05:04:17 2005
Subject: [Rd] delay() has been deprecated for 2.1.0
In-Reply-To: <4D99275E380CA94F998977EDACE548DC0625CE@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC0625CE@extas2-hba.tas.csiro.au>
Message-ID: <Pine.LNX.4.61.0503112145500.18283@itasca2.stat.uiowa.edu>

On Sat, 12 Mar 2005 Mark.Bravington@csiro.au wrote:

> Uh-oh... I've just written a bunch of code for 'mvbutils' using 'delay', and am worried by the statement that "there should be no way to see a <promise:...> object in R". At present, it's possible to check whether 'x' is a promise via e.g. 'class( .GlobalEnv$x)'. This will be different to 'class( x)' if 'x' is a promise, regardless of whether the promise has or has not been forced yet. This can be very useful; my recent code relies on it to check whether certain objects have been changed since last being saved. [These certain objects are originally assigned as promises to load from individual files. Read-accessing the object keeps it as class 'promise', whereas write-access creates a non-promise. Thus I can tell whether the individual files need re-saving when the entire workspace is saved.]

Relying on undocumented features when designing a package is not a
good idea.  In this case the feature of env$x returning a promise
contradicts the documentation and is therefore a bug (the
documentation says that env$x should behave like the corresponding
get() expression, and that forcec promises and returns their values).

>
> The has-it-changed test has been very valuable to me in allowing fast handling of large collections of large objects (which is why I've been adding this functionality to 'mvbutils'); and apart from is-it-still-a-promise, I can't think of any other R-level way of testing whether an object has been modified. [If there is another way, please let me know!]
>
> Is there any chance of retaining *some* R-level way of checking whether an object is a promise, both pre-forcing and post-forcing? (Not necessarily via the 'class( env$x)' method, if that's deemed objectionable.)

This would not be a good idea.  The current behavior of leaving an
evaluated promise in place is also not a documented feature as far as
I can see.  It is a convenient way of implementing lazy evaluation in
an interpreter but it has drawbacks.  One is the cost of the extra
dereference.  Another is the fact that these promises keep alive their
environments that might otherwise be inaccessible and hence available
for GC.  These environments might in turn reference large data
structures, keeping them alive.  At this point it seems too complicated
to deal with this in the interpreter, but a compiler might be able to
prove that a promise can be safely discarded.  (In fact a compiler
might be able to prove that a promise is not needed in the first
place).

There are other possible approaches that you might use, such as active
bindings (see the help for makeActiveBinding).  If that won't do we
can look into developing a suitable abstraction that we can implement
and document in a way that does not tie the hands of the internal
implementation.

Best,

luke

> Mark Bravington
> mark.bravington@csiro.au
>
>
> 	-----Original Message-----
> 	From: r-devel-bounces@stat.math.ethz.ch on behalf of Duncan Murdoch
> 	Sent: Sat 12/03/2005 3:05 AM
> 	To: r-devel@stat.math.ethz.ch
> 	Cc: Gregory Warnes; David Brahm; Torsten Hothorn; Nagiza F. Samatova
> 	Subject: [Rd] delay() has been deprecated for 2.1.0
>
>
>
> 	After a bunch of discussion in the core group, we have decided to
> 	deprecate the delay() function (which was introduced as "experimental"
> 	in R 0.50).  This is the function that duplicates in R code the
> 	delayed evaluation mechanism (the promise) that's used in evaluating
> 	function arguments.
>
> 	The problem with delay() was that it was handled inconsistently (e.g.
> 	sometimes you would see an object displayed as <promise:...>,
> 	sometimes it would be evaluated); it tended to be error-prone in usage
> 	(e.g. this was the cause of the bug that makes the curve() function
> 	create a "pu" object in the global environment); and it was generally
> 	difficult to figure out exactly what the semantics of it should be in
> 	order to be consistent.
>
> 	delay() has been replaced with delayedAssign().  This new function
> 	creates a promise and assigns it into an environment.  Once one more
> 	set of changes is made and delay() is gone, there should be no way to
> 	see a <promise: ...> object in R:  as soon as the object is accessed,
> 	it will be evaluated and you'll see the value.
>
> 	A few packages made use of delay().  I have replaced all of those uses
> 	with delayedAssign().  The most common usage was something like the QA
> 	code uses:
>
> 	assign("T", delay(stop("T used instead of TRUE")),
> 	                  pos = .CheckExEnv)
>
> 	This translates to
>
> 	delayedAssign("T", stop("T used instead of TRUE"), eval.env =
> 	.GlobalEnv, assign.env = .CheckExEnv)
>
> 	In most cases the "eval.env = .GlobalEnv" argument is not necessary
> 	(and in fact it is often a bug, as it was in curve()).  The
> 	environment where the promise is to be evaluated now defaults to the
> 	environment where the call is being made, rather than the global
> 	environment, and this is usually what you want.
>
> 	Package writers who use delay() will now get a warning that it has
> 	been deprecated.  They should recode their package to use
> 	delayedAssign instead.
>
> 	Examples from CRAN of this (I am not sure if this list is exhaustive):
>
> 	exactRankTests, genetics, g.data, maxstat, taskPR, coin
>
> 	I have cc'd the maintainers of those packages.
>
> 	If you want a single code base for your package that works in both the
> 	upcoming R 2.1.0 and older versions, this presents a problem: older
> 	versions don't have delayedAssign.  Here is a workalike function that
> 	could be used in older versions:
>
> 	delayedAssign <- function(x, value,
> 	                eval.env = parent.frame(),
> 	                assign.env = parent.frame()) {
> 	 assign(x, .Internal(delay(substitute(value), eval.env)),
> 	           envir = assign.env)
> 	}
>
> 	Because this function calls the internal delay() function directly, it
> 	should work in R 2.1.0+ as well without a warning, but the internal
> 	function will eventually go away too, so I don't recommend using it in
> 	the long term.
>
> 	Sorry for any inconvenience that this causes.
>
> 	Duncan Murdoch
>
> 	______________________________________________
> 	R-devel@stat.math.ethz.ch mailing list
> 	https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From Mark.Bravington at csiro.au  Sat Mar 12 10:01:32 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Sat Mar 12 10:01:47 2005
Subject: [Rd] delay() has been deprecated for 2.1.0
Message-ID: <4D99275E380CA94F998977EDACE548DC0625D0@extas2-hba.tas.csiro.au>

Thanks-- Luke Tierney's reply below is very helpful. 'makeActiveBinding' is brilliant and I'm pretty sure I can make it do just what I want.
 
One question though: my first experiment with it was this
 
> makeActiveBinding( 'myAB', function( x) if( missing( x)) get( 'myABguts', env=.GlobalEnv) else assign( 'myABguts', x, .GlobalEnv), .GlobalEnv)
> exists( 'myAB')
 
which appeared to return absolutely nothing-- not even a missing or a null. The problem, of course, is that 'myABguts' doesn't exist yet; what seems to happen, though,  is that the failure to 'get' causes a *messageless* error inside the active binding function. Is this intended?
 
I did think that class(env$x) != evalq( class( x), env) was a bit weird, but because it was useful to me, I wan't going to complain. Of course it's entirely true that reliance on the undocumented is dangerous and entirely my liability-- but even ___documented___ features in R have been know to come & go a bit :) . Nowadays I just expect to be buffetted by the winds of change every so often... 
 
Mark

	-----Original Message----- 
	From: Luke Tierney [mailto:luke@stat.uiowa.edu] 
	Sent: Sat 12/03/2005 3:03 PM 
	To: Bravington, Mark (CMIS, Hobart) 
	Cc: murdoch@stats.uwo.ca; r-devel@stat.math.ethz.ch 
	Subject: RE: [Rd] delay() has been deprecated for 2.1.0
	
	

	On Sat, 12 Mar 2005 Mark.Bravington@csiro.au wrote:
	
	> Uh-oh... I've just written a bunch of code for 'mvbutils' using 'delay', and am worried by the statement that "there should be no way to see a <promise:...> object in R". At present, it's possible to check whether 'x' is a promise via e.g. 'class( .GlobalEnv$x)'. This will be different to 'class( x)' if 'x' is a promise, regardless of whether the promise has or has not been forced yet. This can be very useful; my recent code relies on it to check whether certain objects have been changed since last being saved. [These certain objects are originally assigned as promises to load from individual files. Read-accessing the object keeps it as class 'promise', whereas write-access creates a non-promise. Thus I can tell whether the individual files need re-saving when the entire workspace is saved.]
	
	Relying on undocumented features when designing a package is not a
	good idea.  In this case the feature of env$x returning a promise
	contradicts the documentation and is therefore a bug (the
	documentation says that env$x should behave like the corresponding
	get() expression, and that forcec promises and returns their values).
	
	>
	> The has-it-changed test has been very valuable to me in allowing fast handling of large collections of large objects (which is why I've been adding this functionality to 'mvbutils'); and apart from is-it-still-a-promise, I can't think of any other R-level way of testing whether an object has been modified. [If there is another way, please let me know!]
	>
	> Is there any chance of retaining *some* R-level way of checking whether an object is a promise, both pre-forcing and post-forcing? (Not necessarily via the 'class( env$x)' method, if that's deemed objectionable.)
	
	This would not be a good idea.  The current behavior of leaving an
	evaluated promise in place is also not a documented feature as far as
	I can see.  It is a convenient way of implementing lazy evaluation in
	an interpreter but it has drawbacks.  One is the cost of the extra
	dereference.  Another is the fact that these promises keep alive their
	environments that might otherwise be inaccessible and hence available
	for GC.  These environments might in turn reference large data
	structures, keeping them alive.  At this point it seems too complicated
	to deal with this in the interpreter, but a compiler might be able to
	prove that a promise can be safely discarded.  (In fact a compiler
	might be able to prove that a promise is not needed in the first
	place).
	
	There are other possible approaches that you might use, such as active
	bindings (see the help for makeActiveBinding).  If that won't do we
	can look into developing a suitable abstraction that we can implement
	and document in a way that does not tie the hands of the internal
	implementation.
	
	Best,
	
	luke
	
	> Mark Bravington
	> mark.bravington@csiro.au
	>
	>
	>       -----Original Message-----
	>       From: r-devel-bounces@stat.math.ethz.ch on behalf of Duncan Murdoch
	>       Sent: Sat 12/03/2005 3:05 AM
	>       To: r-devel@stat.math.ethz.ch
	>       Cc: Gregory Warnes; David Brahm; Torsten Hothorn; Nagiza F. Samatova
	>       Subject: [Rd] delay() has been deprecated for 2.1.0
	>
	>
	>
	>       After a bunch of discussion in the core group, we have decided to
	>       deprecate the delay() function (which was introduced as "experimental"
	>       in R 0.50).  This is the function that duplicates in R code the
	>       delayed evaluation mechanism (the promise) that's used in evaluating
	>       function arguments.
	>
	>       The problem with delay() was that it was handled inconsistently (e.g.
	>       sometimes you would see an object displayed as <promise:...>,
	>       sometimes it would be evaluated); it tended to be error-prone in usage
	>       (e.g. this was the cause of the bug that makes the curve() function
	>       create a "pu" object in the global environment); and it was generally
	>       difficult to figure out exactly what the semantics of it should be in
	>       order to be consistent.
	>
	>       delay() has been replaced with delayedAssign().  This new function
	>       creates a promise and assigns it into an environment.  Once one more
	>       set of changes is made and delay() is gone, there should be no way to
	>       see a <promise: ...> object in R:  as soon as the object is accessed,
	>       it will be evaluated and you'll see the value.
	>
	>       A few packages made use of delay().  I have replaced all of those uses
	>       with delayedAssign().  The most common usage was something like the QA
	>       code uses:
	>
	>       assign("T", delay(stop("T used instead of TRUE")),
	>                         pos = .CheckExEnv)
	>
	>       This translates to
	>
	>       delayedAssign("T", stop("T used instead of TRUE"), eval.env =
	>       .GlobalEnv, assign.env = .CheckExEnv)
	>
	>       In most cases the "eval.env = .GlobalEnv" argument is not necessary
	>       (and in fact it is often a bug, as it was in curve()).  The
	>       environment where the promise is to be evaluated now defaults to the
	>       environment where the call is being made, rather than the global
	>       environment, and this is usually what you want.
	>
	>       Package writers who use delay() will now get a warning that it has
	>       been deprecated.  They should recode their package to use
	>       delayedAssign instead.
	>
	>       Examples from CRAN of this (I am not sure if this list is exhaustive):
	>
	>       exactRankTests, genetics, g.data, maxstat, taskPR, coin
	>
	>       I have cc'd the maintainers of those packages.
	>
	>       If you want a single code base for your package that works in both the
	>       upcoming R 2.1.0 and older versions, this presents a problem: older
	>       versions don't have delayedAssign.  Here is a workalike function that
	>       could be used in older versions:
	>
	>       delayedAssign <- function(x, value,
	>                       eval.env = parent.frame(),
	>                       assign.env = parent.frame()) {
	>        assign(x, .Internal(delay(substitute(value), eval.env)),
	>                  envir = assign.env)
	>       }
	>
	>       Because this function calls the internal delay() function directly, it
	>       should work in R 2.1.0+ as well without a warning, but the internal
	>       function will eventually go away too, so I don't recommend using it in
	>       the long term.
	>
	>       Sorry for any inconvenience that this causes.
	>
	>       Duncan Murdoch
	>
	>       ______________________________________________
	>       R-devel@stat.math.ethz.ch mailing list
	>       https://stat.ethz.ch/mailman/listinfo/r-devel
	>
	> ______________________________________________
	> R-devel@stat.math.ethz.ch mailing list
	> https://stat.ethz.ch/mailman/listinfo/r-devel
	>
	
	--
	Luke Tierney
	Chair, Statistics and Actuarial Science
	Ralph E. Wareham Professor of Mathematical Sciences
	University of Iowa                  Phone:             319-335-3386
	Department of Statistics and        Fax:               319-335-3017
	    Actuarial Science
	241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
	Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From ligges at statistik.uni-dortmund.de  Sat Mar 12 16:03:16 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Mar 12 16:03:38 2005
Subject: [Rd] Package Installation in RGui (PR#7262)
In-Reply-To: <6.0.0.22.2.20050311125955.01dec310@mail.med.usyd.edu.au>
References: <6.0.0.22.2.20050311125955.01dec310@mail.med.usyd.edu.au>
Message-ID: <423304B4.7050709@statistik.uni-dortmund.de>

I think this is a FAQ, hence not appropriate on ANY mailing list:

Please read a) The R for Windows FAQs, Section (currently 3.8) 
"update.packages() fails" and b) note that VR is a package bundle, hence 
nothing dubious if library(VR) fails. Also, if package MASS has been 
loaded, you cannot update the VR bundle.


Uwe Ligges



Keith Wong wrote:

> In reference to the thread 
> http://tolstoy.newcastle.edu.au/R/devel/04/10/0859.html
> 
> I have the same problem updating packages with newly-installed version 
> of released version of R 2.0.1. Previous posts refer to a bug in 
> windows. I wonder if there is a work-around? This probably should go to 
> R-help but it follows on from the post in R-devel. Apologies in advance.
> 
> OS: Windows XP Professional, with current patches. I have administrator 
> rights.
> R version 2.0.1 released version (newly re-installed).
> 
> Problem:
> update.packages() downloads the binaries, but installation stops with 
> the same error message, and the package to be upgraded disappears entirely:
> 
> package 'boot' successfully unpacked and MD5 sums checked
> bundle 'VR' successfully unpacked and MD5 sums checked
> package 'cluster' successfully unpacked and MD5 sums checked
> package 'foreign' successfully unpacked and MD5 sums checked
> package 'KernSmooth' successfully unpacked and MD5 sums checked
> package 'lattice' successfully unpacked and MD5 sums checked
> package 'nlme' successfully unpacked and MD5 sums checked
> Error: Can not remove prior installation of package 'nlme'
> In addition: Warning message:
> unable to move temp installation 
> 'C:/PROGRA~1/R/rw2001/library\file30867/foreign' to 
> 'C:/PROGRA~1/R/rw2001/library/foreign'
>  > library(nlme)
> Error in library(nlme) : There is no package called 'nlme'
> 
> 
> Keith
> 
> 
>  > update.packages()
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> Content type `text/plain; charset=iso-8859-1' length 26875 bytes
> opened URL
> downloaded 26Kb
> 
> boot :
>  Version 1.2-20 in C:/PROGRA~1/R/rw2001/library
>  Version 1.2-22 on CRAN
> Update (y/N)?  y
> VR :
>  Version 7.2-10 in C:/PROGRA~1/R/rw2001/library
>  Version 7.2-12 on CRAN
> Update (y/N)?  y
> cluster :
>  Version 1.9.6 in C:/PROGRA~1/R/rw2001/library
>  Version 1.9.7 on CRAN
> Update (y/N)?  y
> foreign :
>  Version 0.8-0 in C:/PROGRA~1/R/rw2001/library
>  Version 0.8-5 on CRAN
> Update (y/N)?  y
> KernSmooth :
>  Version 2.22-14 in C:/PROGRA~1/R/rw2001/library
>  Version 2.22-15 on CRAN
> Update (y/N)?  y
> lattice :
>  Version 0.10-14 in C:/PROGRA~1/R/rw2001/library
>  Version 0.10-16 on CRAN
> Update (y/N)?  y
> nlme :
>  Version 3.1-53 in C:/PROGRA~1/R/rw2001/library
>  Version 3.1-56 on CRAN
> Update (y/N)?  y
> rpart :
>  Version 3.1-20 in C:/PROGRA~1/R/rw2001/library
>  Version 3.1-22 on CRAN
> Update (y/N)?  y
> survival :
>  Version 2.15 in C:/PROGRA~1/R/rw2001/library
>  Version 2.16 on CRAN
> Update (y/N)?  y
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/boot_1.2-22.zip'
> Content type `application/zip' length 767540 bytes
> opened URL
> downloaded 749Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/VR_7.2-12.zip'
> Content type `application/zip' length 1551825 bytes
> opened URL
> downloaded 1515Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/cluster_1.9.7.zip'
> Content type `application/zip' length 472995 bytes
> opened URL
> downloaded 461Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/foreign_0.8-5.zip'
> Content type `application/zip' length 172108 bytes
> opened URL
> downloaded 168Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/KernSmooth_2.22-15.zip'
> Content type `application/zip' length 95039 bytes
> opened URL
> downloaded 92Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/lattice_0.10-16.zip'
> Content type `application/zip' length 650372 bytes
> opened URL
> downloaded 635Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/nlme_3.1-56.zip'
> Content type `application/zip' length 2144937 bytes
> opened URL
> downloaded 2094Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/rpart_3.1-22.zip'
> Content type `application/zip' length 233548 bytes
> opened URL
> downloaded 228Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/survival_2.16.zip'
> Content type `application/zip' length 954786 bytes
> opened URL
> downloaded 932Kb
> 
> package 'boot' successfully unpacked and MD5 sums checked
> bundle 'VR' successfully unpacked and MD5 sums checked
> package 'cluster' successfully unpacked and MD5 sums checked
> package 'foreign' successfully unpacked and MD5 sums checked
> package 'KernSmooth' successfully unpacked and MD5 sums checked
> package 'lattice' successfully unpacked and MD5 sums checked
> package 'nlme' successfully unpacked and MD5 sums checked
> Error: Can not remove prior installation of package 'nlme'
> In addition: Warning message:
> unable to move temp installation 
> 'C:/PROGRA~1/R/rw2001/library\file30867/foreign' to 
> 'C:/PROGRA~1/R/rw2001/library/foreign'
>  > library(nlme)
> Error in library(nlme) : There is no package called 'nlme'
>  > library(lattice)
>  > library(boot)
> 
> Attaching package 'boot':
> 
> 
>         The following object(s) are masked from package:lattice :
> 
>          melanoma
> 
>  > library(rpart)
>  > library(survival)
> Loading required package: splines
> 
> Attaching package 'survival':
> 
> 
>         The following object(s) are masked from package:boot :
> 
>          aml
> 
>  > library(VR)
> Error in library(VR) : There is no package called 'VR'
>  > library(cluster)
>  > library(foreign)
> Error in library(foreign) : There is no package called 'foreign'
>  > library(KernSmooth)
> KernSmooth 2.22 installed
> Copyright M. P. Wand 1997
>  > library(lattice)
>  > local({a <- CRAN.packages()
> + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> available=a, dependencies=TRUE)})
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> Content type `text/plain; charset=iso-8859-1' length 26875 bytes
> opened URL
> downloaded 26Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/nlme_3.1-56.zip'
> Content type `application/zip' length 2144937 bytes
> opened URL
> downloaded 2094Kb
> 
> package 'nlme' successfully unpacked and MD5 sums checked
> 
> Delete downloaded files (y/N)?
> The packages are in C:\DOCUME~1\KeithW\LOCALS~1\Temp\Rtmp6848\Rinstdir19641
> updating HTML package descriptions
>  > local({a <- CRAN.packages()
> + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> available=a, dependencies=TRUE)})
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> Content type `text/plain; charset=iso-8859-1' length 26875 bytes
> opened URL
> downloaded 26Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/VR_7.2-12.zip'
> Content type `application/zip' length 1551825 bytes
> opened URL
> downloaded 1515Kb
> 
> bundle 'VR' successfully unpacked and MD5 sums checked
> Error: Can not remove prior installation of package 'MASS'
>  >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From pgilbert at bank-banque-canada.ca  Sat Mar 12 16:26:15 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Sat Mar 12 16:27:52 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <16946.17039.340033.755871@basebud.nulle.part>
References: <20050310140445.388c9f39.Achim.Zeileis@wu-wien.ac.at>	<4231D692.6080600@bank-banque-canada.ca>	<20050311191009.49cceb75.Achim.Zeileis@wu-wien.ac.at>	<4231EBC4.5070508@bank-banque-canada.ca>	<20050311202634.149afba2.Achim.Zeileis@wu-wien.ac.at>	<423221CB.7020008@bank-banque-canada.ca>
	<16946.17039.340033.755871@basebud.nulle.part>
Message-ID: <42330A17.4020204@bank-banque-canada.ca>

Dirk Eddelbuettel wrote:

> Paul,
> 
> On 11 March 2005 at 17:55, Paul Gilbert wrote:
> | Achim
> | ...
> | >>Other things that might be useful are various programming views, like
> | >>a Matlab view, and an SPSS view.
> | > 
> | > 
> | > I'm not sure what you have in mind here, because I would think that this
> | > amounts more to using the language in general than using certain
> | > packages. 
> | ...
> | 
> | I guess I didn't see that this should only be about packages. It seems 
> | you could put just about anything in the HTML page. A table like
> | 
> |     Matlab    R translation
> |     -------    ------------
> |      eye(n)      diag(1,n)
> |        =            <-
> |   etc
> | 
> | might be useful to a lot of people converting from Matlab. I may have 
> | the above wrong, but I do have a good start on a table like this in a 
> | sed script somewhere, so if anyone volunteers to be the maintainer I can 
> | help a bit.
> 
> Recall that (at least some of) this exists already in Robin's page at
>    http://cran.us.r-project.org/doc/contrib/R-and-octave-2.txt
> (using the .us mirror here, adapt at will)
> 
> Dirk

Dirk

Thanks for point this out. It is certainly a better starting point than 
anything I have related to Matlab. I think this also underlines the 
bigger problem too. There is actually a very large amount of R 
documentation, but it is often hard for someone with a particular 
background to know were to start. Even though I now know this document 
exists, it seems a bit difficult to actually find it from CRAN. If I 
Google "R and Octave" I get it immediately, but it doesn't show up with 
"R and Matlab." It seems to me that the "view" idea may provide a very 
good mechanism that will work even when you really don't know where to 
start. (BTW, this is an example, I don't really know much about Matlab.)

Paul

From Gregor.Gorjanc at bfro.uni-lj.si  Sat Mar 12 17:00:52 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Sat Mar 12 17:01:00 2005
Subject: [Rd] CRAN Task Views: ctv package available
Message-ID: <7FFEE688B57D7346BC6241C55900E730B6FF97@pollux.bfro.uni-lj.si>

Hello!

First of all congratulations for a nice approach to present "R fields" in 
more coherent way. When I started with R I was often frustrated with long
list of packages, similarities between them, ... If I would take a slow 
approach (one thing at a time) things would be easier from the start, but 
usually one wants to know what a new program is capable of. This is esential
if one wants really to switch to R.

About ctv:
>> Paul Gilbert wrote:
>> For my own purposes the "Econometrics" view is just fine, but I do 
>> sometimes get questions about dse from people in fields that are 
>> different enough that they might not even know to look in 
>> "Econometrics." A time series view might be useful even if it only
>> said see also ... .  Another approach to this might be to have
>> sub-views so, for example, "Econometrics" and "Control theory" could
>> both point to "Time series."

> Achim Zeileis responded:
> Yes, that is, of course, an obvious idea but it requires more
> coordination between the different views, hence we've decided not to
> support hierarchically ordered views. 
> Re: "ControlTheory". If someone would raise his hand and provide a view
> for that, it would be great. It could, of course, link to the
> "Econometrics" view (and vice versa) but they wouldn't have a formally
> defined subset in a "TimeSeries" view.

I think that there is a lot of "fields" where this views cover the same
stuff. When I first read about ctv I thought it will be implemented more
in somewhat "hierarchical" or kind of "multiple" way, since for example 
linear models come usefull in many different fields and some people might
never look under "Econometrics" view as Paul stated.

I realize that "hierarchical/multiple" is far from easy and I do not have
any clear idea how to implement it, but it would probably easier to maintain
larger set of views in such a way and it would be easier to generate new
ones.

--
Lep pozdrav / With regards,
    Gregor GORJANC

-----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe

From luke at stat.uiowa.edu  Sat Mar 12 17:14:08 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Sat Mar 12 17:14:35 2005
Subject: [Rd] delay() has been deprecated for 2.1.0
In-Reply-To: <4D99275E380CA94F998977EDACE548DC0625D0@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC0625D0@extas2-hba.tas.csiro.au>
Message-ID: <Pine.LNX.4.61.0503120935320.20462@itasca2.stat.uiowa.edu>

On Sat, 12 Mar 2005 Mark.Bravington@csiro.au wrote:

> Thanks-- Luke Tierney's reply below is very helpful. 'makeActiveBinding' is brilliant and I'm pretty sure I can make it do just what I want.
>
> One question though: my first experiment with it was this
>
>> makeActiveBinding( 'myAB', function( x) if( missing( x)) get( 'myABguts', env=.GlobalEnv) else assign( 'myABguts', x, .GlobalEnv), .GlobalEnv)
>> exists( 'myAB')
>
> which appeared to return absolutely nothing-- not even a missing or a null. The problem, of course, is that 'myABguts' doesn't exist yet; what seems to happen, though,  is that the failure to 'get' causes a *messageless* error inside the active binding function. Is this intended?

What I get is this:

     > makeActiveBinding( 'myAB', function( x)
                                      if( missing( x))
                                          get( 'myABguts', env=.GlobalEnv)
                                      else assign( 'myABguts', x, .GlobalEnv),
                          .GlobalEnv)
     NULL
     Warning message:
     saved workspaces with active bindings may not work properly when loaded ...
     > exists( 'myAB')
     Error in get(x, envir, mode, inherits) : variable "myABguts" was not found

[We might want to get rid of the warning message at this point.]

Currently exists() for active bindings calls the value function even
if mode is "any".  Given that fact and your implementation the message
makes sense to me, and you get the same message if you try to access
the variable:

     > myAB
     Error in get(x, envir, mode, inherits) : variable "myABguts" was not found

You probably should write your function a bit more defensively.

For ordinary bindings that contain promises from delayed evaluation
exists() does not evaluate the promise for mode "any", but does for
other modes of course.  The behavior of exists() for active bindings
is bug.  A quick look at the code suggests that it will be a bit
tricky to fix, so I'm not sure it will get done before 2.1.0.

Best,

luke


>
> I did think that class(env$x) != evalq( class( x), env) was a bit weird, but because it was useful to me, I wan't going to complain. Of course it's entirely true that reliance on the undocumented is dangerous and entirely my liability-- but even ___documented___ features in R have been know to come & go a bit :) . Nowadays I just expect to be buffetted by the winds of change every so often...
>
> Mark
>
> 	-----Original Message-----
> 	From: Luke Tierney [mailto:luke@stat.uiowa.edu]
> 	Sent: Sat 12/03/2005 3:03 PM
> 	To: Bravington, Mark (CMIS, Hobart)
> 	Cc: murdoch@stats.uwo.ca; r-devel@stat.math.ethz.ch
> 	Subject: RE: [Rd] delay() has been deprecated for 2.1.0
>
>
>
> 	On Sat, 12 Mar 2005 Mark.Bravington@csiro.au wrote:
>
> 	> Uh-oh... I've just written a bunch of code for 'mvbutils' using 'delay', and am worried by the statement that "there should be no way to see a <promise:...> object in R". At present, it's possible to check whether 'x' is a promise via e.g. 'class( .GlobalEnv$x)'. This will be different to 'class( x)' if 'x' is a promise, regardless of whether the promise has or has not been forced yet. This can be very useful; my recent code relies on it to check whether certain objects have been changed since last being saved. [These certain objects are originally assigned as promises to load from individual files. Read-accessing the object keeps it as class 'promise', whereas write-access creates a non-promise. Thus I can tell whether the individual files need re-saving when the entire workspace is saved.]
>
> 	Relying on undocumented features when designing a package is not a
> 	good idea.  In this case the feature of env$x returning a promise
> 	contradicts the documentation and is therefore a bug (the
> 	documentation says that env$x should behave like the corresponding
> 	get() expression, and that forcec promises and returns their values).
>
> 	>
> 	> The has-it-changed test has been very valuable to me in allowing fast handling of large collections of large objects (which is why I've been adding this functionality to 'mvbutils'); and apart from is-it-still-a-promise, I can't think of any other R-level way of testing whether an object has been modified. [If there is another way, please let me know!]
> 	>
> 	> Is there any chance of retaining *some* R-level way of checking whether an object is a promise, both pre-forcing and post-forcing? (Not necessarily via the 'class( env$x)' method, if that's deemed objectionable.)
>
> 	This would not be a good idea.  The current behavior of leaving an
> 	evaluated promise in place is also not a documented feature as far as
> 	I can see.  It is a convenient way of implementing lazy evaluation in
> 	an interpreter but it has drawbacks.  One is the cost of the extra
> 	dereference.  Another is the fact that these promises keep alive their
> 	environments that might otherwise be inaccessible and hence available
> 	for GC.  These environments might in turn reference large data
> 	structures, keeping them alive.  At this point it seems too complicated
> 	to deal with this in the interpreter, but a compiler might be able to
> 	prove that a promise can be safely discarded.  (In fact a compiler
> 	might be able to prove that a promise is not needed in the first
> 	place).
>
> 	There are other possible approaches that you might use, such as active
> 	bindings (see the help for makeActiveBinding).  If that won't do we
> 	can look into developing a suitable abstraction that we can implement
> 	and document in a way that does not tie the hands of the internal
> 	implementation.
>
> 	Best,
>
> 	luke
>
> 	> Mark Bravington
> 	> mark.bravington@csiro.au
> 	>
> 	>
> 	>       -----Original Message-----
> 	>       From: r-devel-bounces@stat.math.ethz.ch on behalf of Duncan Murdoch
> 	>       Sent: Sat 12/03/2005 3:05 AM
> 	>       To: r-devel@stat.math.ethz.ch
> 	>       Cc: Gregory Warnes; David Brahm; Torsten Hothorn; Nagiza F. Samatova
> 	>       Subject: [Rd] delay() has been deprecated for 2.1.0
> 	>
> 	>
> 	>
> 	>       After a bunch of discussion in the core group, we have decided to
> 	>       deprecate the delay() function (which was introduced as "experimental"
> 	>       in R 0.50).  This is the function that duplicates in R code the
> 	>       delayed evaluation mechanism (the promise) that's used in evaluating
> 	>       function arguments.
> 	>
> 	>       The problem with delay() was that it was handled inconsistently (e.g.
> 	>       sometimes you would see an object displayed as <promise:...>,
> 	>       sometimes it would be evaluated); it tended to be error-prone in usage
> 	>       (e.g. this was the cause of the bug that makes the curve() function
> 	>       create a "pu" object in the global environment); and it was generally
> 	>       difficult to figure out exactly what the semantics of it should be in
> 	>       order to be consistent.
> 	>
> 	>       delay() has been replaced with delayedAssign().  This new function
> 	>       creates a promise and assigns it into an environment.  Once one more
> 	>       set of changes is made and delay() is gone, there should be no way to
> 	>       see a <promise: ...> object in R:  as soon as the object is accessed,
> 	>       it will be evaluated and you'll see the value.
> 	>
> 	>       A few packages made use of delay().  I have replaced all of those uses
> 	>       with delayedAssign().  The most common usage was something like the QA
> 	>       code uses:
> 	>
> 	>       assign("T", delay(stop("T used instead of TRUE")),
> 	>                         pos = .CheckExEnv)
> 	>
> 	>       This translates to
> 	>
> 	>       delayedAssign("T", stop("T used instead of TRUE"), eval.env =
> 	>       .GlobalEnv, assign.env = .CheckExEnv)
> 	>
> 	>       In most cases the "eval.env = .GlobalEnv" argument is not necessary
> 	>       (and in fact it is often a bug, as it was in curve()).  The
> 	>       environment where the promise is to be evaluated now defaults to the
> 	>       environment where the call is being made, rather than the global
> 	>       environment, and this is usually what you want.
> 	>
> 	>       Package writers who use delay() will now get a warning that it has
> 	>       been deprecated.  They should recode their package to use
> 	>       delayedAssign instead.
> 	>
> 	>       Examples from CRAN of this (I am not sure if this list is exhaustive):
> 	>
> 	>       exactRankTests, genetics, g.data, maxstat, taskPR, coin
> 	>
> 	>       I have cc'd the maintainers of those packages.
> 	>
> 	>       If you want a single code base for your package that works in both the
> 	>       upcoming R 2.1.0 and older versions, this presents a problem: older
> 	>       versions don't have delayedAssign.  Here is a workalike function that
> 	>       could be used in older versions:
> 	>
> 	>       delayedAssign <- function(x, value,
> 	>                       eval.env = parent.frame(),
> 	>                       assign.env = parent.frame()) {
> 	>        assign(x, .Internal(delay(substitute(value), eval.env)),
> 	>                  envir = assign.env)
> 	>       }
> 	>
> 	>       Because this function calls the internal delay() function directly, it
> 	>       should work in R 2.1.0+ as well without a warning, but the internal
> 	>       function will eventually go away too, so I don't recommend using it in
> 	>       the long term.
> 	>
> 	>       Sorry for any inconvenience that this causes.
> 	>
> 	>       Duncan Murdoch
> 	>
> 	>       ______________________________________________
> 	>       R-devel@stat.math.ethz.ch mailing list
> 	>       https://stat.ethz.ch/mailman/listinfo/r-devel
> 	>
> 	> ______________________________________________
> 	> R-devel@stat.math.ethz.ch mailing list
> 	> https://stat.ethz.ch/mailman/listinfo/r-devel
> 	>
>
> 	--
> 	Luke Tierney
> 	Chair, Statistics and Actuarial Science
> 	Ralph E. Wareham Professor of Mathematical Sciences
> 	University of Iowa                  Phone:             319-335-3386
> 	Department of Statistics and        Fax:               319-335-3017
> 	    Actuarial Science
> 	241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
> 	Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From Achim.Zeileis at wu-wien.ac.at  Sat Mar 12 18:04:05 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Sat Mar 12 18:04:13 2005
Subject: [Rd] CRAN Task Views: ctv package available
In-Reply-To: <7FFEE688B57D7346BC6241C55900E730B6FF97@pollux.bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B6FF97@pollux.bfro.uni-lj.si>
Message-ID: <Pine.LNX.4.58.0503121802080.8883@thorin.ci.tuwien.ac.at>

On Sat, 12 Mar 2005, Gorjanc Gregor wrote:

> Hello!
>
> First of all congratulations for a nice approach to present "R fields" in
> more coherent way. When I started with R I was often frustrated with long
> list of packages, similarities between them, ... If I would take a slow
> approach (one thing at a time) things would be easier from the start, but
> usually one wants to know what a new program is capable of. This is esential
> if one wants really to switch to R.
>
> About ctv:
> >> Paul Gilbert wrote:
> >> For my own purposes the "Econometrics" view is just fine, but I do
> >> sometimes get questions about dse from people in fields that are
> >> different enough that they might not even know to look in
> >> "Econometrics." A time series view might be useful even if it only
> >> said see also ... .  Another approach to this might be to have
> >> sub-views so, for example, "Econometrics" and "Control theory" could
> >> both point to "Time series."
>
> > Achim Zeileis responded:
> > Yes, that is, of course, an obvious idea but it requires more
> > coordination between the different views, hence we've decided not to
> > support hierarchically ordered views.
> > Re: "ControlTheory". If someone would raise his hand and provide a view
> > for that, it would be great. It could, of course, link to the
> > "Econometrics" view (and vice versa) but they wouldn't have a formally
> > defined subset in a "TimeSeries" view.
>
> I think that there is a lot of "fields" where this views cover the same
> stuff. When I first read about ctv I thought it will be implemented more
> in somewhat "hierarchical" or kind of "multiple" way, since for example
> linear models come usefull in many different fields and some people might
> never look under "Econometrics" view as Paul stated.
>
> I realize that "hierarchical/multiple" is far from easy and I do not have
> any clear idea how to implement it, but it would probably easier to maintain
> larger set of views in such a way and it would be easier to generate new
> ones.

Yes, the implementation would not be the main problem, but the
maintenance. For hierarchical views, there needs to be much more
communication and coordination between the maintainers of related views.
My idea was to keep the work low for the maintainers...hoping that there
would be more people volunteering to maintain a view related to their
field of research or application.
Z

> --
> Lep pozdrav / With regards,
>     Gregor GORJANC
>
> -----------------------------------------------------------------------
> University of Ljubljana
> Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
> Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
> Groblje 3                   tel: +386 (0)1 72 17 861
> SI-1230 Domzale             fax: +386 (0)1 72 17 888
> Slovenia, Europe
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From Gregor.Gorjanc at bfro.uni-lj.si  Sat Mar 12 23:16:54 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Sat Mar 12 23:17:08 2005
Subject: [Rd] CRAN Task Views: ctv package available
Message-ID: <7FFEE688B57D7346BC6241C55900E730B6FF98@pollux.bfro.uni-lj.si>

Gregor:
>> I think that there is a lot of "fields" where this views cover the same
>> stuff. When I first read about ctv I thought it will be implemented more
>> in somewhat "hierarchical" or kind of "multiple" way, since for example
>> linear models come usefull in many different fields and some people might
>> never look under "Econometrics" view as Paul stated.
>>
>> I realize that "hierarchical/multiple" is far from easy and I do not have
>> any clear idea how to implement it, but it would probably easier to maintain
>> larger set of views in such a way and it would be easier to generate new
>> ones.

Achim
> Yes, the implementation would not be the main problem, but the
> maintenance. For hierarchical views, there needs to be much more
> communication and coordination between the maintainers of related views.
> My idea was to keep the work low for the maintainers...hoping that there
> would be more people volunteering to maintain a view related to their
> field of research or application.

Yes, you are right about needed work. Anyway, one can copy some parts from 
different views and create a new one ;)

Regards, Gregor

From deepayan at stat.wisc.edu  Sat Mar 12 23:39:24 2005
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Sat Mar 12 23:38:35 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <1110568431.5799.13.camel@horizons.localdomain>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503111658340.16843@gannet.stats>
	<1110568431.5799.13.camel@horizons.localdomain>
Message-ID: <200503121639.24334.deepayan@stat.wisc.edu>

On Friday 11 March 2005 13:13, Marc Schwartz wrote:
> On Fri, 2005-03-11 at 17:17 +0000, Prof Brian Ripley wrote:
> > I see you have both a scalable font (the first) and size-specfic
> > fonts. My guess is that the scalable font is not encoded in the
> > same way as the others: can you track down where it is coming from?
> >
> > Otherwise my list on FC3 is the same as yours (minus the
> > duplicates, which are also puzzling).  I have also just checked
> > Exceed, which has the same list plus scalable fonts (and also has
> >
> > -adobe-symbol-0-0-normal--0-0-0-0-p-0-adobe-fontspecific
> > -adobe-symbol-0-0-normal--0-0-0-0-p-0-sun-fontspecific
> > -adobe-symbol-0-0-normal--0-0-100-100-p-0-adobe-fontspecific
> > -adobe-symbol-0-0-normal--0-0-100-100-p-0-sun-fontspecific
> > -adobe-symbol-0-0-normal--0-0-75-75-p-0-adobe-fontspecific
> > -adobe-symbol-0-0-normal--0-0-75-75-p-0-sun-fontspecific
> >
> > which caused problems for 2.0.1 with getting bold symbols in some
> > sizes, hence the second bug fix I mentioned).
> >
> > As a wild guess, do you have a font server as well as local fonts?

I don't think so. My XF86Config-4 file has the line 
        FontPath        "unix/:7100"      # local font server
but I don't see any font server package actually installed, and I get 

deepayan $ xfsinfo -server localhost:7100
xfsinfo:  unable to open server "localhost:7100"

. I do have fontconfig (and a bunch of fonts all over the place), which 
may explain the duplicates.

[...]

> Deepayan, which X server is being used? FC3 (fully updated) is using
> xorg 6.8.1 if that might make a difference.

I'm using Debian testing, the version of X being 4.3.0.dfsg.1-10 (4.3.0 
with some modifications). But this is not the issue, since things work 
fine on another Debian system with the same version of X. It turns out 
that the problem is with the gsfonts-x11 package. After removing it, I 
get the correct symbols (with a warning message):

> expr = expression(sum(x, 1, n))
> plot(1, main = expr, type = "n")
> text(1, 1, expr)
Warning message:
X11 used font size 8 when 9 was requested


There's still a bug, but probably not in R. The only external indication 
I can get that something is wrong is when I compare

$ xfd -fn 
-adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific 

and 

$ xfd -fn 
-adobe-symbol-medium-r-normal--0-0-100-100-p-107-adobe-fontspecific

The second one claims to display 

-urw-standard symbols 
l-medium-r-normal--17-120-100-100-p-89-adobe-fontspecific

and in fact does *not* have the summation symbol. (Screenshots at 

http://www.stat.wisc.edu/~deepayan/R/xfd-fixed.png and 
http://www.stat.wisc.edu/~deepayan/R/xfd-scalable.png

). However, the file /usr/X11R6/lib/X11/fonts/Type1/fonts.dir has the 
line

s050000l.pfb -urw-standard symbols 
l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific

which suggests that the actual font used is s050000l.pfb, and a font 
editor shows that it does contain the summation symbol (U+2211). 

Deepayan

From iad at columbia.edu  Sun Mar 13 01:43:03 2005
From: iad at columbia.edu (iad@columbia.edu)
Date: Sun Mar 13 01:43:17 2005
Subject: [Rd] Incorrect calculation of loop in R.2.0.1 (PR#7724)
Message-ID: <20050313004303.6ACBBC047@slim.kubism.ku.dk>

Full_Name: Ms. Drakes
Version: 2.01
OS: Windows XP
Submission from: (NULL) (4.237.32.239)


file="C:/glob.csv"
glob=read.csv(file,header=T)

y=glob$Temperature


z=max(y[1:40])
#  this has a probability of exceedance of 1/41 
# now you can check how this does in the 2nd sample - 
sum=0
for i = 41:100 if (z>y[i]sum=sum+1
sum
sum=sum/60
	sum


error: the loop i=41:100 does not work correctly, only if information after "if"
is enclosed in parentheses

From p.dalgaard at biostat.ku.dk  Sun Mar 13 01:52:28 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Mar 13 01:59:20 2005
Subject: [Rd] Incorrect calculation of loop in R.2.0.1 (PR#7724)
In-Reply-To: <20050313004303.6ACBBC047@slim.kubism.ku.dk>
References: <20050313004303.6ACBBC047@slim.kubism.ku.dk>
Message-ID: <x2r7ik1i5v.fsf@biostat.ku.dk>

iad@columbia.edu writes:

> Full_Name: Ms. Drakes
> Version: 2.01

2.0.1, I guess-

> OS: Windows XP
> Submission from: (NULL) (4.237.32.239)
> 
> 
> file="C:/glob.csv"
> glob=read.csv(file,header=T)
> 
> y=glob$Temperature
> 
> 
> z=max(y[1:40])
> #  this has a probability of exceedance of 1/41 
> # now you can check how this does in the 2nd sample - 
> sum=0
> for i = 41:100 if (z>y[i]sum=sum+1

That's not how you specify a for loop in R. Please read up on the
syntax, e.g. in "An Introduction to R"

> sum
> sum=sum/60
> 	sum
> 
> 
> error: the loop i=41:100 does not work correctly, only if information after "if"
> is enclosed in parentheses

It is not a bug in R that your program does not work correctly. Please
do not abuse the bug report system like that.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Sun Mar 13 08:36:29 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Mar 13 08:36:47 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <200503121639.24334.deepayan@stat.wisc.edu>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503111658340.16843@gannet.stats>
	<1110568431.5799.13.camel@horizons.localdomain>
	<200503121639.24334.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.61.0503130715480.14273@gannet.stats>

So my guess on scalable fonts was right.

I suspect this is a problem in how the X server is using Type1 fonts, 
specifically in how it thinks they are encoded.  This is why I asked about 
the locale: \summation is \345 in the Adobe symbol character set and 
\circleplus is \305 which is a u/case to l/case difference in Latin-1.

I now recall Kurt had similar problems with gsfonts-x11 last August:

>> Kurt has found a problem with the last two pages of demo(plotmath) on
>> X11 (some symbols either wrong or missing completely).

We found

>> the issue seems to be that gsfonts-x11 has aliases
>>
>> -adobe-symbol-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific 
"-urw-standard symbols l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific"
>> "-urw-standard symbols l-regular-r-normal--0-0-0-0-p-0-adobe-fontspecific" "-
urw-standard symbols l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific"

>> Any way to ensure that these fonts are not taken by us?

> I don't think so, for if I understand that the alias file is lying about
> encodings. We specifically added "-adobe-symbol" to overcome problems with
> abi symbol fonts at ETHZ, but if that package says the urw fonts in
> `standard symbols l' are in adobe symbol and they are not, you are in
> trouble.

Brian


On Sat, 12 Mar 2005, Deepayan Sarkar wrote:

> On Friday 11 March 2005 13:13, Marc Schwartz wrote:
>> On Fri, 2005-03-11 at 17:17 +0000, Prof Brian Ripley wrote:
>>> I see you have both a scalable font (the first) and size-specfic
>>> fonts. My guess is that the scalable font is not encoded in the
>>> same way as the others: can you track down where it is coming from?
>>>
>>> Otherwise my list on FC3 is the same as yours (minus the
>>> duplicates, which are also puzzling).  I have also just checked
>>> Exceed, which has the same list plus scalable fonts (and also has
>>>
>>> -adobe-symbol-0-0-normal--0-0-0-0-p-0-adobe-fontspecific
>>> -adobe-symbol-0-0-normal--0-0-0-0-p-0-sun-fontspecific
>>> -adobe-symbol-0-0-normal--0-0-100-100-p-0-adobe-fontspecific
>>> -adobe-symbol-0-0-normal--0-0-100-100-p-0-sun-fontspecific
>>> -adobe-symbol-0-0-normal--0-0-75-75-p-0-adobe-fontspecific
>>> -adobe-symbol-0-0-normal--0-0-75-75-p-0-sun-fontspecific
>>>
>>> which caused problems for 2.0.1 with getting bold symbols in some
>>> sizes, hence the second bug fix I mentioned).
>>>
>>> As a wild guess, do you have a font server as well as local fonts?
>
> I don't think so. My XF86Config-4 file has the line
>        FontPath        "unix/:7100"      # local font server
> but I don't see any font server package actually installed, and I get
>
> deepayan $ xfsinfo -server localhost:7100
> xfsinfo:  unable to open server "localhost:7100"
>
> . I do have fontconfig (and a bunch of fonts all over the place), which
> may explain the duplicates.
>
> [...]
>
>> Deepayan, which X server is being used? FC3 (fully updated) is using
>> xorg 6.8.1 if that might make a difference.
>
> I'm using Debian testing, the version of X being 4.3.0.dfsg.1-10 (4.3.0
> with some modifications). But this is not the issue, since things work
> fine on another Debian system with the same version of X. It turns out
> that the problem is with the gsfonts-x11 package. After removing it, I
> get the correct symbols (with a warning message):
>
>> expr = expression(sum(x, 1, n))
>> plot(1, main = expr, type = "n")
>> text(1, 1, expr)
> Warning message:
> X11 used font size 8 when 9 was requested
>
>
> There's still a bug, but probably not in R. The only external indication
> I can get that something is wrong is when I compare
>
> $ xfd -fn
> -adobe-symbol-medium-r-normal--20-140-100-100-p-107-adobe-fontspecific
>
> and
>
> $ xfd -fn
> -adobe-symbol-medium-r-normal--0-0-100-100-p-107-adobe-fontspecific
>
> The second one claims to display
>
> -urw-standard symbols
> l-medium-r-normal--17-120-100-100-p-89-adobe-fontspecific
>
> and in fact does *not* have the summation symbol. (Screenshots at
>
> http://www.stat.wisc.edu/~deepayan/R/xfd-fixed.png and
> http://www.stat.wisc.edu/~deepayan/R/xfd-scalable.png
>
> ). However, the file /usr/X11R6/lib/X11/fonts/Type1/fonts.dir has the
> line
>
> s050000l.pfb -urw-standard symbols
> l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific
>
> which suggests that the actual font used is s050000l.pfb, and a font
> editor shows that it does contain the summation symbol (U+2211).
>
> Deepayan
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Sun Mar 13 11:48:11 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Mar 13 11:55:07 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <Pine.LNX.4.61.0503130715480.14273@gannet.stats>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503111658340.16843@gannet.stats>
	<1110568431.5799.13.camel@horizons.localdomain>
	<200503121639.24334.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503130715480.14273@gannet.stats>
Message-ID: <x21xajrfdg.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> So my guess on scalable fonts was right.
> 
> I suspect this is a problem in how the X server is using Type1 fonts,
> specifically in how it thinks they are encoded.  This is why I asked
> about the locale: \summation is \345 in the Adobe symbol character set
> and \circleplus is \305 which is a u/case to l/case difference in
> Latin-1.

Well, the X server is defenseless against people aliasing fonts with
incompatible encodings...
 
> I now recall Kurt had similar problems with gsfonts-x11 last August:
> 
> >> Kurt has found a problem with the last two pages of demo(plotmath) on
> >> X11 (some symbols either wrong or missing completely).
> 
> We found
> 
> >> the issue seems to be that gsfonts-x11 has aliases
> >>
> >> -adobe-symbol-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific
> "-urw-standard symbols l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific"
> >> "-urw-standard symbols l-regular-r-normal--0-0-0-0-p-0-adobe-fontspecific" "-
> urw-standard symbols l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific"
> 
> >> Any way to ensure that these fonts are not taken by us?
> 
> > I don't think so, for if I understand that the alias file is lying about
> > encodings. We specifically added "-adobe-symbol" to overcome problems with
> > abi symbol fonts at ETHZ, but if that package says the urw fonts in
> > `standard symbols l' are in adobe symbol and they are not, you are in
> > trouble.
>

...as previously noted, it seems (who are you citing there?). 

I vaguely recall some messup with the GS fonts on Fedora 3 (making
xpdf misbehave on slides) but it seems to have been resolved long ago. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Sun Mar 13 13:04:49 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Mar 13 13:05:08 2005
Subject: [Rd] unexpected behaviour of expression(sum())
In-Reply-To: <x21xajrfdg.fsf@biostat.ku.dk>
References: <200503101957.13827.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503111658340.16843@gannet.stats>
	<1110568431.5799.13.camel@horizons.localdomain>
	<200503121639.24334.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503130715480.14273@gannet.stats>
	<x21xajrfdg.fsf@biostat.ku.dk>
Message-ID: <Pine.LNX.4.61.0503131202490.17002@gannet.stats>

On Sun, 13 Mar 2005, Peter Dalgaard wrote:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
>
>> So my guess on scalable fonts was right.
>>
>> I suspect this is a problem in how the X server is using Type1 fonts,
>> specifically in how it thinks they are encoded.  This is why I asked
>> about the locale: \summation is \345 in the Adobe symbol character set
>> and \circleplus is \305 which is a u/case to l/case difference in
>> Latin-1.
>
> Well, the X server is defenseless against people aliasing fonts with
> incompatible encodings...

That's still surmise.

>> I now recall Kurt had similar problems with gsfonts-x11 last August:
>>
>>>> Kurt has found a problem with the last two pages of demo(plotmath) on
>>>> X11 (some symbols either wrong or missing completely).
>>
>> We found
>>
>>>> the issue seems to be that gsfonts-x11 has aliases
>>>>
>>>> -adobe-symbol-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific
>> "-urw-standard symbols l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific"
>>>> "-urw-standard symbols l-regular-r-normal--0-0-0-0-p-0-adobe-fontspecific" "-
>> urw-standard symbols l-medium-r-normal--0-0-0-0-p-0-adobe-fontspecific"
>>
>>>> Any way to ensure that these fonts are not taken by us?
>>
>>> I don't think so, for if I understand that the alias file is lying about
>>> encodings. We specifically added "-adobe-symbol" to overcome problems with
>>> abi symbol fonts at ETHZ, but if that package says the urw fonts in
>>> `standard symbols l' are in adobe symbol and they are not, you are in
>>> trouble.
>>
>
> ...as previously noted, it seems (who are you citing there?).

Kurt and myself (where uncredited).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Gregor.Gorjanc at bfro.uni-lj.si  Sun Mar 13 21:57:59 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Sun Mar 13 21:58:08 2005
Subject: [Rd] Use of htest class for different tests
Message-ID: <7FFEE688B57D7346BC6241C55900E730B6FFA0@pollux.bfro.uni-lj.si>

Hello!

First of all I must appologize if this has been raised previously, but
search provided by Robert King at the University of Newcastle seems to
be down these days. Additionally let me know if such a question should
be sent to R-help.

I did a contribution to function hwe.hardy in package 'gap' during the
weekend. That functions performs Hardy-Weinberg equilibrium test using
MCMC. The return of the function does not have classical components for
htest class so I was afcourse not successfull in using it. However, I
managed to copy and modify some part of print.htest to accomplish the 
same task.

Now my question is what to do in such cases? Just copy parts of 
print.htest and modify for each test or anything else. Are such cases 
rare? If yes, then mentioned approach is probably the easiest. 

--
Lep pozdrav / With regards,
    Gregor GORJANC

------------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty       URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department    email: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                  tel: +386 (0)1 72 17 861
SI-1230 Domzale            fax: +386 (0)1 72 17 888
Slovenia

From jpnolan at american.edu  Mon Mar 14 06:12:27 2005
From: jpnolan at american.edu (jpnolan@american.edu)
Date: Mon Mar 14 10:19:23 2005
Subject: [Rd] ks.test (Kolmogorov-Smirnov) (PR#7725)
Message-ID: <20050314051227.9F35DC04B@slim.kubism.ku.dk>

Full_Name: John Nolan
Version: 2.0.1
OS: Win XP
Submission from: (NULL) (151.200.9.43)


I think there are two small bugs in the Kolmogorov Smirnov test routines.  

(1) In the R function ks.test, toward the bottom, the internal function pkstwo
does:

 p[IND] <- .C("pkstwo", as.integer(length(x)), p = as.double(x[IND]), 
                as.double(tol), PACKAGE = "stats")$p

Instead of length(x), shouldn't length(x[IND]) be passed?  If there are NAs,
length(x) > length(x[IND]) and the called C routine will try to process more
values than it should.


(2) In C routine ks.c, the function pkstwo describes two series it evaluates,
depending on whether x > 1 or x < 1.  The second case uses a formula described 
in the comments at the head of the function as

 *   = \sqrt{2\pi/x} \sum_{k=1}^\infty \exp(-(2k-1)^2\pi^2/(8x^2))

The code actually evaluates  \sqrt{2\pi}/x, not \sqrt{2\pi/x}.  I am not sure
which equation is right: both agree at x=1 so there is no easy test here.
If the equation is correct, the code should be changed to have w =
0.5*log(x[i]),
not w = log(x[i]).  If the code is right, change the equation in the comment.

John Nolan

From Torsten.Hothorn at rzmail.uni-erlangen.de  Mon Mar 14 13:43:32 2005
From: Torsten.Hothorn at rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Mon Mar 14 13:44:23 2005
Subject: [Rd] Use of htest class for different tests
In-Reply-To: <7FFEE688B57D7346BC6241C55900E730B6FFA0@pollux.bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B6FFA0@pollux.bfro.uni-lj.si>
Message-ID: <Pine.LNX.4.51.0503141338500.14878@artemis.imbe.med.uni-erlangen.de>

On Sun, 13 Mar 2005, Gorjanc Gregor wrote:

> Hello!
>
> First of all I must appologize if this has been raised previously, but
> search provided by Robert King at the University of Newcastle seems to
> be down these days. Additionally let me know if such a question should
> be sent to R-help.
>
> I did a contribution to function hwe.hardy in package 'gap' during the
> weekend. That functions performs Hardy-Weinberg equilibrium test using
> MCMC. The return of the function does not have classical components for
> htest class so I was afcourse not successfull in using it. However, I
> managed to copy and modify some part of print.htest to accomplish the
> same task.
>
> Now my question is what to do in such cases? Just copy parts of
> print.htest and modify for each test or anything else. Are such cases
> rare? If yes, then mentioned approach is probably the easiest.
>

you can use print.htest directly for the components which _are_ elements
of objects of class `htest' and provide your one print method for all
others. If your class `foo' (essentially) extends `htest', a
simple version of `print.foo' could by

print.foo <- function(x, ...) {

   # generate an object of class `htest'
   y <- x
   class(y) <- "htest"
   # maybe modify some thinks like y$method
   ...
   # print y using `print.htest' without copying code
   print(y)

   # and now print additional information
   cat(x$whatsoever)

}



> --
> Lep pozdrav / With regards,
>     Gregor GORJANC
>
> ------------------------------------------------------------------------
> University of Ljubljana
> Biotechnical Faculty       URI: http://www.bfro.uni-lj.si/MR/ggorjan
> Zootechnical Department    email: gregor.gorjanc <at> bfro.uni-lj.si
> Groblje 3                  tel: +386 (0)1 72 17 861
> SI-1230 Domzale            fax: +386 (0)1 72 17 888
> Slovenia
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

From maechler at stat.math.ethz.ch  Mon Mar 14 13:57:16 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Mar 14 13:57:31 2005
Subject: [Rd] Use of htest class for different tests
In-Reply-To: <Pine.LNX.4.51.0503141338500.14878@artemis.imbe.med.uni-erlangen.de>
References: <7FFEE688B57D7346BC6241C55900E730B6FFA0@pollux.bfro.uni-lj.si>
	<Pine.LNX.4.51.0503141338500.14878@artemis.imbe.med.uni-erlangen.de>
Message-ID: <16949.35372.502952.997482@stat.math.ethz.ch>

>>>>> "Torsten" == Torsten Hothorn <Torsten.Hothorn@rzmail.uni-erlangen.de>
>>>>>     on Mon, 14 Mar 2005 13:43:32 +0100 (CET) writes:

    Torsten> On Sun, 13 Mar 2005, Gorjanc Gregor wrote:
    >> Hello!
    >> 
    >> First of all I must appologize if this has been raised
    >> previously, but search provided by Robert King at the
    >> University of Newcastle seems to be down these
    >> days. Additionally let me know if such a question should
    >> be sent to R-help.
    >> 
    >> I did a contribution to function hwe.hardy in package
    >> 'gap' during the weekend. That functions performs
    >> Hardy-Weinberg equilibrium test using MCMC. The return of
    >> the function does not have classical components for htest
    >> class so I was afcourse not successfull in using
    >> it. However, I managed to copy and modify some part of
    >> print.htest to accomplish the same task.
    >> 
    >> Now my question is what to do in such cases? Just copy
    >> parts of print.htest and modify for each test or anything
    >> else. Are such cases rare? If yes, then mentioned
    >> approach is probably the easiest.
    >> 

    Torsten> you can use print.htest directly for the components
    Torsten> which _are_ elements of objects of class `htest'
    Torsten> and provide your one print method for all
    Torsten> others. If your class `foo' (essentially) extends
    Torsten> `htest', a simple version of `print.foo' could by

   Torsten>  print.foo <- function(x, ...) {
   Torsten>  
   Torsten>     # generate an object of class `htest'
   Torsten>     y <- x
   Torsten>     class(y) <- "htest"
   Torsten>     # maybe modify some thinks like y$method
   Torsten>     ...
   Torsten>     # print y using `print.htest' without copying code
   Torsten>     print(y)
   Torsten>  
   Torsten>     # and now print additional information
   Torsten>     cat(x$whatsoever)
   Torsten>  
   Torsten>  }

and if you want to really `comply to standards'
you should end your print method with

    invisible(x)

Martin Maechler, ETH Zurich

From Gregor.Gorjanc at bfro.uni-lj.si  Mon Mar 14 14:15:23 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Mon Mar 14 14:15:32 2005
Subject: [Rd] Package Installation in RGui (PR#7262)
Message-ID: <7FFEE688B57D7346BC6241C55900E730B6FFA7@pollux.bfro.uni-lj.si>

Hello!

I have just encountered the same situation as Heather and also Paul Gilbert at

http://tolstoy.newcastle.edu.au/R/devel/05/02/2095.html

I went into install.packages() in current release as well as in R-devel and
there is really no problem with \ or /. However, I also had the same warning

> install.packages("RODBC")
[... snip ...]
Delete downloaded files (y/N)? y

updating HTML package descriptions
Warning message: 
unable to move temp installation 'N:/Ovce/Programi/R/rw2001/library\file27583/RODBC' to 'N:/Ovce/Programi/R/rw2001/library/RODBC' 

The warning is issued from this part of install.packages()

if (ret == 0) {
                ## Move the new package to the install lib and
                ## remove our temp dir
                ret <- file.rename(file.path(tmpDir, curPkg), instPath)
                if(!ret) warning("unable to move temp installation ",
                                 sQuote(file.path(tmpDir, curPkg)),
                                 " to ",
                                 sQuote(instPath), call. = FALSE)
            } else {
                ## !! Can't revert to old 'zip.unpack' as it would
                ## !! potentially leave cruft from a bundle in there
                stop("Can not remove prior installation of package ",
                     sQuote(curPkg), call. = FALSE)
            }

"Problem" lies in 

ret <- file.rename(file.path(tmpDir, curPkg), instPath)

I went through the whole function "by hand" and at first the above line
didn't moved tmpDir to instPath. I tried several times and after a while
it was successfull. It is strange that it happens only with some packages
i.e. in my case with RODBC and car. I also noted that line above takes 
quite a lot of time to "accomplish" its work. It actually causes R to 
freeze for a moment. If I launched

file.rename(file.path(tmpDir, curPkg), instPath)

move was done in a moment. I know, that this comment is not the answer 
to the problem. However, someone might come with that.

One more thing. I have R installed on networked disk. I assume that Heather 
does also, since disk letter is H. On the other hand, Paul reported problems
with C disk.

Windows XP SP1
R 2.0.1

On Tue, 5 Oct 2004 Heather.Turner@warwick.ac.uk wrote:
> Full_Name: Heather Turner
> Version: 2.0.0
> OS: Windows NT
> Submission from: (NULL) (137.205.8.2)
>
>
> I tried using the Packages menu to install the gam package and get the following
> output:
>
> > local({a <- CRAN.packages()
> + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a,
> dependencies=TRUE)})
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> Content type `text/plain; charset=iso-8859-1' length 21246 bytes
> opened URL
> downloaded 20Kb
>
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/gam_0.92.zip'
> Content type `application/zip' length 224167 bytes
> opened URL
> downloaded 218Kb
>
> package 'gam' successfully unpacked and MD5 sums checked
>
> Delete downloaded files (y/N)? y
>
> Warning message:
> unable to move temp installation 'H:/rw2000/library\file15762/gam' to
> 'H:/rw2000/library/gam'
>
> I get the same message if I opt to delete the downloaded files and the
> same problem if I try to install from a downloaded .zip file instead -
> not really surprising as seems to "unpack" file okay, but loses the
> temporary file. As the syntax of the file path for the temporary file is
> incorrect, I'm assuming this is a bug in install.packages or one of the
> functions it calls...

Since you _incorrectly_ assume that the syntax is incorrect, the rest of
your assumption is incorrect. As the FAQ asks, please don't speculate
about things you are not expert about, but stick to facts. Also as the
FAQ asks, don't misuse R-bugs for things you do not know _for sure_ are
bugs in R.

FYI, Windows accepts both /and \ in file paths, including a mixture. If
your speculation was correct install.packages() would work for no one, and
do you seriously think that such a bug would go unreported and unfixed.

We have seen this once before, and it was a Windows bug solved by updating
Windows to the latest set of patches. Since you have not reported a
precise version of Windows, it is hard for us to know what you were using,
but if you mean NT4.0, that is rather old (last Service Pack five years
ago I read yesterday).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Lep pozdrav / With regards,
    Gregor GORJANC

------------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty       URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department    email: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                  tel: +386 (0)1 72 17 861
SI-1230 Domzale            fax: +386 (0)1 72 17 888
Slovenia

From ligges at statistik.uni-dortmund.de  Mon Mar 14 15:34:57 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Mar 14 15:35:17 2005
Subject: [Rd] Package Installation in RGui (PR#7262)
In-Reply-To: <7FFEE688B57D7346BC6241C55900E730B6FFA7@pollux.bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B6FFA7@pollux.bfro.uni-lj.si>
Message-ID: <4235A111.5050604@statistik.uni-dortmund.de>

Under Windows, you cannot update / install  a package, if the package 
has been loaded, because Windows locks the dll. This is a FAQ.

Uwe Ligges



Gorjanc Gregor wrote:

> Hello!
> 
> I have just encountered the same situation as Heather and also Paul Gilbert at
> 
> http://tolstoy.newcastle.edu.au/R/devel/05/02/2095.html
> 
> I went into install.packages() in current release as well as in R-devel and
> there is really no problem with \ or /. However, I also had the same warning
> 
> 
>>install.packages("RODBC")
> 
> [... snip ...]
> Delete downloaded files (y/N)? y
> 
> updating HTML package descriptions
> Warning message: 
> unable to move temp installation 'N:/Ovce/Programi/R/rw2001/library\file27583/RODBC' to 'N:/Ovce/Programi/R/rw2001/library/RODBC' 
> 
> The warning is issued from this part of install.packages()
> 
> if (ret == 0) {
>                 ## Move the new package to the install lib and
>                 ## remove our temp dir
>                 ret <- file.rename(file.path(tmpDir, curPkg), instPath)
>                 if(!ret) warning("unable to move temp installation ",
>                                  sQuote(file.path(tmpDir, curPkg)),
>                                  " to ",
>                                  sQuote(instPath), call. = FALSE)
>             } else {
>                 ## !! Can't revert to old 'zip.unpack' as it would
>                 ## !! potentially leave cruft from a bundle in there
>                 stop("Can not remove prior installation of package ",
>                      sQuote(curPkg), call. = FALSE)
>             }
> 
> "Problem" lies in 
> 
> ret <- file.rename(file.path(tmpDir, curPkg), instPath)
> 
> I went through the whole function "by hand" and at first the above line
> didn't moved tmpDir to instPath. I tried several times and after a while
> it was successfull. It is strange that it happens only with some packages
> i.e. in my case with RODBC and car. I also noted that line above takes 
> quite a lot of time to "accomplish" its work. It actually causes R to 
> freeze for a moment. If I launched
> 
> file.rename(file.path(tmpDir, curPkg), instPath)
> 
> move was done in a moment. I know, that this comment is not the answer 
> to the problem. However, someone might come with that.
> 
> One more thing. I have R installed on networked disk. I assume that Heather 
> does also, since disk letter is H. On the other hand, Paul reported problems
> with C disk.
> 
> Windows XP SP1
> R 2.0.1
> 
> On Tue, 5 Oct 2004 Heather.Turner@warwick.ac.uk wrote:
> 
>>Full_Name: Heather Turner
>>Version: 2.0.0
>>OS: Windows NT
>>Submission from: (NULL) (137.205.8.2)
>>
>>
>>I tried using the Packages menu to install the gam package and get the following
>>output:
>>
>>
>>>local({a <- CRAN.packages()
>>
>>+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a,
>>dependencies=TRUE)})
>>trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
>>Content type `text/plain; charset=iso-8859-1' length 21246 bytes
>>opened URL
>>downloaded 20Kb
>>
>>trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/gam_0.92.zip'
>>Content type `application/zip' length 224167 bytes
>>opened URL
>>downloaded 218Kb
>>
>>package 'gam' successfully unpacked and MD5 sums checked
>>
>>Delete downloaded files (y/N)? y
>>
>>Warning message:
>>unable to move temp installation 'H:/rw2000/library\file15762/gam' to
>>'H:/rw2000/library/gam'
>>
>>I get the same message if I opt to delete the downloaded files and the
>>same problem if I try to install from a downloaded .zip file instead -
>>not really surprising as seems to "unpack" file okay, but loses the
>>temporary file. As the syntax of the file path for the temporary file is
>>incorrect, I'm assuming this is a bug in install.packages or one of the
>>functions it calls...
> 
> 
> Since you _incorrectly_ assume that the syntax is incorrect, the rest of
> your assumption is incorrect. As the FAQ asks, please don't speculate
> about things you are not expert about, but stick to facts. Also as the
> FAQ asks, don't misuse R-bugs for things you do not know _for sure_ are
> bugs in R.
> 
> FYI, Windows accepts both /and \ in file paths, including a mixture. If
> your speculation was correct install.packages() would work for no one, and
> do you seriously think that such a bug would go unreported and unfixed.
> 
> We have seen this once before, and it was a Windows bug solved by updating
> Windows to the latest set of patches. Since you have not reported a
> precise version of Windows, it is hard for us to know what you were using,
> but if you mean NT4.0, that is rather old (last Service Pack five years
> ago I read yesterday).
>

From Gregor.Gorjanc at bfro.uni-lj.si  Mon Mar 14 15:58:50 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Mon Mar 14 15:59:11 2005
Subject: FW: [Rd] Package Installation in RGui (PR#7262)
Message-ID: <7FFEE688B57D7346BC6241C55900E730B6FFAF@pollux.bfro.uni-lj.si>

I didn't load the package. I wasn't able to do that, since I wasn't
successfull to install it in first place with install.packages.

-----Original Message-----
From: Uwe Ligges [mailto:ligges@statistik.uni-dortmund.de]
Sent: pon 2005-03-14 15:34
To: Gorjanc Gregor
Cc: r-devel@stat.math.ethz.ch
Subject: Re: [Rd] Package Installation in RGui (PR#7262)
 
Under Windows, you cannot update / install  a package, if the package 
has been loaded, because Windows locks the dll. This is a FAQ.

Uwe Ligges



Gorjanc Gregor wrote:

> Hello!
> 
> I have just encountered the same situation as Heather and also Paul Gilbert at
> 
> http://tolstoy.newcastle.edu.au/R/devel/05/02/2095.html
> 
> I went into install.packages() in current release as well as in R-devel and
> there is really no problem with \ or /. However, I also had the same warning
> 
> 
>>install.packages("RODBC")
> 
> [... snip ...]
> Delete downloaded files (y/N)? y
> 
> updating HTML package descriptions
> Warning message: 
> unable to move temp installation 'N:/Ovce/Programi/R/rw2001/library\file27583/RODBC' to 'N:/Ovce/Programi/R/rw2001/library/RODBC' 
> 
> The warning is issued from this part of install.packages()
> 
> if (ret == 0) {
>                 ## Move the new package to the install lib and
>                 ## remove our temp dir
>                 ret <- file.rename(file.path(tmpDir, curPkg), instPath)
>                 if(!ret) warning("unable to move temp installation ",
>                                  sQuote(file.path(tmpDir, curPkg)),
>                                  " to ",
>                                  sQuote(instPath), call. = FALSE)
>             } else {
>                 ## !! Can't revert to old 'zip.unpack' as it would
>                 ## !! potentially leave cruft from a bundle in there
>                 stop("Can not remove prior installation of package ",
>                      sQuote(curPkg), call. = FALSE)
>             }
> 
> "Problem" lies in 
> 
> ret <- file.rename(file.path(tmpDir, curPkg), instPath)
> 
> I went through the whole function "by hand" and at first the above line
> didn't moved tmpDir to instPath. I tried several times and after a while
> it was successfull. It is strange that it happens only with some packages
> i.e. in my case with RODBC and car. I also noted that line above takes 
> quite a lot of time to "accomplish" its work. It actually causes R to 
> freeze for a moment. If I launched
> 
> file.rename(file.path(tmpDir, curPkg), instPath)
> 
> move was done in a moment. I know, that this comment is not the answer 
> to the problem. However, someone might come with that.
> 
> One more thing. I have R installed on networked disk. I assume that Heather 
> does also, since disk letter is H. On the other hand, Paul reported problems
> with C disk.
> 
> Windows XP SP1
> R 2.0.1
> 
> On Tue, 5 Oct 2004 Heather.Turner@warwick.ac.uk wrote:
> 
>>Full_Name: Heather Turner
>>Version: 2.0.0
>>OS: Windows NT
>>Submission from: (NULL) (137.205.8.2)
>>
>>
>>I tried using the Packages menu to install the gam package and get the following
>>output:
>>
>>
>>>local({a <- CRAN.packages()
>>
>>+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a,
>>dependencies=TRUE)})
>>trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
>>Content type `text/plain; charset=iso-8859-1' length 21246 bytes
>>opened URL
>>downloaded 20Kb
>>
>>trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/gam_0.92.zip'
>>Content type `application/zip' length 224167 bytes
>>opened URL
>>downloaded 218Kb
>>
>>package 'gam' successfully unpacked and MD5 sums checked
>>
>>Delete downloaded files (y/N)? y
>>
>>Warning message:
>>unable to move temp installation 'H:/rw2000/library\file15762/gam' to
>>'H:/rw2000/library/gam'
>>
>>I get the same message if I opt to delete the downloaded files and the
>>same problem if I try to install from a downloaded .zip file instead -
>>not really surprising as seems to "unpack" file okay, but loses the
>>temporary file. As the syntax of the file path for the temporary file is
>>incorrect, I'm assuming this is a bug in install.packages or one of the
>>functions it calls...
> 
> 
> Since you _incorrectly_ assume that the syntax is incorrect, the rest of
> your assumption is incorrect. As the FAQ asks, please don't speculate
> about things you are not expert about, but stick to facts. Also as the
> FAQ asks, don't misuse R-bugs for things you do not know _for sure_ are
> bugs in R.
> 
> FYI, Windows accepts both /and \ in file paths, including a mixture. If
> your speculation was correct install.packages() would work for no one, and
> do you seriously think that such a bug would go unreported and unfixed.
> 
> We have seen this once before, and it was a Windows bug solved by updating
> Windows to the latest set of patches. Since you have not reported a
> precise version of Windows, it is hard for us to know what you were using,
> but if you mean NT4.0, that is rather old (last Service Pack five years
> ago I read yesterday).
>

From kwright at eskimo.com  Mon Mar 14 21:39:50 2005
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Mon Mar 14 21:40:02 2005
Subject: [Rd] Small suggestion for stripchart help
Message-ID: <54445.170.54.59.167.1110832790.squirrel@170.54.59.167>


I needed to look up information about the 'jitter' argument of stripchart.
 When I opened the help page for jitter I found:

jitter 	when jittering is used, jitter gives the amount of jittering applied.

which is slightly confusing/self-referential if you are lazy and don't
read the entire page.

It might be clearer to say

jitter  when \code{method="jitter"} is used, jitter gives the amount of
jittering applied.


Just my opinion.  Thanks for listening.

Kevin Wright

From Mark.Bravington at csiro.au  Tue Mar 15 00:04:40 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Tue Mar 15 00:05:13 2005
Subject: [Rd] delay() has been deprecated for 2.1.0
Message-ID: <4D99275E380CA94F998977EDACE548DC074B2B@extas2-hba.tas.csiro.au>

[MVB] 
[snip]
> >
> >> makeActiveBinding( 'myAB', function( x) if( missing( x)) get( 
> >> 'myABguts', env=.GlobalEnv) else assign( 'myABguts', x, 
> .GlobalEnv), 
> >> exists( 'myAB')
> >
> > which appeared to return absolutely nothing-- not even a 
> missing or a null. The problem, of course, is that 'myABguts' 
> doesn't exist yet; what seems to happen, though,  is that the 
> failure to 'get' causes a *messageless* error inside the 
> active binding function. Is this intended?
> 

[Luke Tierney]
> What I get is this:
>      > exists( 'myAB')
>      Error in get(x, envir, mode, inherits) : variable 
> "myABguts" was not found

[MVB]
Hmmm, yes, this morning that's exactly what I get too. I was running
this on a different machine (also R2.0.1 under Windows XP) when I
repeatedly got the messageless error which prompted my question. I'll
see whether I can re-reproduce it on that system.

Thanks
Mark

From Gregor.Gorjanc at bfro.uni-lj.si  Tue Mar 15 09:28:59 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Tue Mar 15 09:29:07 2005
Subject: [Rd] Package Installation on networked disk (was: Package
	Installation in RGui (PR#7262))
Message-ID: <7FFEE688B57D7346BC6241C55900E730B6FFB4@pollux.bfro.uni-lj.si>

Hi again!

I would just like to add that this surely must be a problem with network
disks. As I reported yesterady in, 

https://stat.ethz.ch/pipermail/r-devel/2005-March/032431.html

I have problems with installing packages on network drive (where I have R 
installed), marked N:

> install.packages("gap")
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 26936 bytes
opened URL
downloaded 26Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/gap_0.8-3.zip'
Content type `application/zip' length 437644 bytes
opened URL
downloaded 427Kb

package 'gap' successfully unpacked and MD5 sums checked

Delete downloaded files (y/N)? y

updating HTML package descriptions
Warning message: 
unable to move temp installation 'N:/Ovce/Programi/R/rw2001/library\file4821/gap' to 'N:/Ovce/Programi/R/rw2001/library/gap' 
> library("gap")
Error in library("gap") : There is no package called 'gap'

But if I try to install package on local disk, marked C:

> install.packages("gap", lib="C:/Programs/R/library")
> install.packages("gap", lib="C:/Programs/R/library")
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 26936 bytes
opened URL
downloaded 26Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/gap_0.8-3.zip'
Content type `application/zip' length 437644 bytes
opened URL
downloaded 427Kb

package 'gap' successfully unpacked and MD5 sums checked

Delete downloaded files (y/N)? y

updating HTML package descriptions
> library("gap")
Error in library("gap") : There is no package called 'gap'
> library("gap", lib.loc="C:/Programs/R/library")
> ?hwe.hardy

I also reported yesterday that this is not 100% reproducible. I tried 
to install today bundle 'gregmisc' and the installation failed only partly,
due to failure of moving temporary installation directory for 'gplots', while
others packages passed OK. Strange. Look below:

> install.packages("gregmisc")
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 26936 bytes
opened URL
downloaded 26Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/gregmisc_2.0.3.zip'
Content type `application/zip' length 821874 bytes
opened URL
downloaded 802Kb

bundle 'gregmisc' successfully unpacked and MD5 sums checked

Delete downloaded files (y/N)? y

updating HTML package descriptions
Warning message: 
unable to move temp installation 'N:/Ovce/Programi/R/rw2001/library\file1347/gplots' to 'N:/Ovce/Programi/R/rw2001/library/gplots' 
> library("gdata")
Loading required package: gtools 
> library("gplots")
Error in library("gplots") : There is no package called 'gplots'

Can someone try this with local and networked installation of package to confirm 
my thoughts.

Local system:
Windows XP SP1
R 2.0.1
Administrator rights

Network system (host of disk):
Sorry I don't have this information.

--
Lep pozdrav / With regards,
    Gregor GORJANC

------------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty       URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department    email: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                  tel: +386 (0)1 72 17 861
SI-1230 Domzale            fax: +386 (0)1 72 17 888
Slovenia

From maechler at stat.math.ethz.ch  Tue Mar 15 17:16:13 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Mar 15 17:16:30 2005
Subject: [Rd] Small suggestion for stripchart help
In-Reply-To: <54445.170.54.59.167.1110832790.squirrel@170.54.59.167>
References: <54445.170.54.59.167.1110832790.squirrel@170.54.59.167>
Message-ID: <16951.2637.98419.240914@stat.math.ethz.ch>

Thank you, Kevin.

I've just committed your improvement (to
 ..../src/library/graphics/man/stripchart.Rd).

Martin

>>>>> "KevinW" == Kevin Wright <kwright@eskimo.com>
>>>>>     on Mon, 14 Mar 2005 12:39:50 -0800 (PST) writes:

    KevinW> I needed to look up information about the 'jitter'
    KevinW> argument of stripchart.  When I opened the help page
    KevinW> for jitter I found:

    KevinW> jitter 	when jittering is used, jitter gives the amount of jittering applied.

    KevinW> which is slightly confusing/self-referential if you
    KevinW> are lazy and don't read the entire page.

    KevinW> It might be clearer to say

    KevinW> jitter when \code{method="jitter"} is used, jitter
    KevinW> gives the amount of jittering applied.

    KevinW> Just my opinion.  Thanks for listening.

    KevinW> Kevin Wright

From p.dalgaard at biostat.ku.dk  Tue Mar 15 18:05:12 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Mar 15 18:12:13 2005
Subject: [Rd] Lemon drops
Message-ID: <x2r7igon5j.fsf@biostat.ku.dk>

I bumped into the following situation:

Browse[1]> coef
            deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
(Intercept)    462    510    528    492    660    762
Browse[1]> coef[,1]
[1] 462
Browse[1]> coef[,1,drop=F]
            deg0NA
(Intercept)    462

where I really wanted neither, but

(Intercept)
        462

Anyone happen to know a neat way out of the conundrum?

I can think of

rowSums(coef[,1,drop=F])

or of course

val <- coef[,1]
names(val) <- rownames(x))

but the first one is sneaky and the second gets a bit tedious...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From MSchwartz at MedAnalytics.com  Tue Mar 15 18:28:57 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue Mar 15 18:29:09 2005
Subject: [Rd] Lemon drops
In-Reply-To: <x2r7igon5j.fsf@biostat.ku.dk>
References: <x2r7igon5j.fsf@biostat.ku.dk>
Message-ID: <1110907737.8170.17.camel@horizons.localdomain>

On Tue, 2005-03-15 at 18:05 +0100, Peter Dalgaard wrote:
> I bumped into the following situation:
> 
> Browse[1]> coef
>             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> (Intercept)    462    510    528    492    660    762
> Browse[1]> coef[,1]
> [1] 462
> Browse[1]> coef[,1,drop=F]
>             deg0NA
> (Intercept)    462
> 
> where I really wanted neither, but
> 
> (Intercept)
>         462
> 
> Anyone happen to know a neat way out of the conundrum?
> 
> I can think of
> 
> rowSums(coef[,1,drop=F])
> 
> or of course
> 
> val <- coef[,1]
> names(val) <- rownames(x))
> 
> but the first one is sneaky and the second gets a bit tedious...

Peter,

How about something like this:

> x
            deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
(Intercept)    462    510    528    492    660    762
IV1              1      2      3      4      5      6


> x[1]
(Intercept)
        462

> str(x[1])
 Named num 462
 - attr(*, "names")= chr "(Intercept)"


Does that work or am I missing something?

Marc Schwartz

From p.dalgaard at biostat.ku.dk  Tue Mar 15 18:26:46 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Mar 15 18:33:43 2005
Subject: [Rd] Lemon drops
In-Reply-To: <1110907737.8170.17.camel@horizons.localdomain>
References: <x2r7igon5j.fsf@biostat.ku.dk>
	<1110907737.8170.17.camel@horizons.localdomain>
Message-ID: <x2mzt4om5l.fsf@biostat.ku.dk>

Marc Schwartz <MSchwartz@MedAnalytics.com> writes:

> On Tue, 2005-03-15 at 18:05 +0100, Peter Dalgaard wrote:
> > I bumped into the following situation:
> > 
> > Browse[1]> coef
> >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > (Intercept)    462    510    528    492    660    762
> > Browse[1]> coef[,1]
> > [1] 462
> > Browse[1]> coef[,1,drop=F]
> >             deg0NA
> > (Intercept)    462
> > 
> > where I really wanted neither, but
> > 
> > (Intercept)
> >         462
> > 
> > Anyone happen to know a neat way out of the conundrum?
> > 
> > I can think of
> > 
> > rowSums(coef[,1,drop=F])
> > 
> > or of course
> > 
> > val <- coef[,1]
> > names(val) <- rownames(x))
> > 
> > but the first one is sneaky and the second gets a bit tedious...
> 
> Peter,
> 
> How about something like this:
> 
> > x
>             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> (Intercept)    462    510    528    492    660    762
> IV1              1      2      3      4      5      6
> 
> 
> > x[1]
> (Intercept)
>         462
> 
> > str(x[1])
>  Named num 462
>  - attr(*, "names")= chr "(Intercept)"
> 
> 
> Does that work or am I missing something?

You're missing the context. What I really need is something that will
extract a column of a matrix as a vector in the usual way, but will
not get confused if there is only one row.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From MSchwartz at MedAnalytics.com  Tue Mar 15 19:53:38 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue Mar 15 19:53:53 2005
Subject: [Rd] Lemon drops
In-Reply-To: <x2mzt4om5l.fsf@biostat.ku.dk>
References: <x2r7igon5j.fsf@biostat.ku.dk>
	<1110907737.8170.17.camel@horizons.localdomain>
	<x2mzt4om5l.fsf@biostat.ku.dk>
Message-ID: <1110912819.8170.36.camel@horizons.localdomain>

On Tue, 2005-03-15 at 18:26 +0100, Peter Dalgaard wrote:
> Marc Schwartz <MSchwartz@MedAnalytics.com> writes:
> 
> > On Tue, 2005-03-15 at 18:05 +0100, Peter Dalgaard wrote:
> > > I bumped into the following situation:
> > > 
> > > Browse[1]> coef
> > >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > > (Intercept)    462    510    528    492    660    762
> > > Browse[1]> coef[,1]
> > > [1] 462
> > > Browse[1]> coef[,1,drop=F]
> > >             deg0NA
> > > (Intercept)    462
> > > 
> > > where I really wanted neither, but
> > > 
> > > (Intercept)
> > >         462
> > > 
> > > Anyone happen to know a neat way out of the conundrum?
> > > 
> > > I can think of
> > > 
> > > rowSums(coef[,1,drop=F])
> > > 
> > > or of course
> > > 
> > > val <- coef[,1]
> > > names(val) <- rownames(x))
> > > 
> > > but the first one is sneaky and the second gets a bit tedious...
> > 
> > Peter,
> > 
> > How about something like this:
> > 
> > > x
> >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > (Intercept)    462    510    528    492    660    762
> > IV1              1      2      3      4      5      6
> > 
> > 
> > > x[1]
> > (Intercept)
> >         462
> > 
> > > str(x[1])
> >  Named num 462
> >  - attr(*, "names")= chr "(Intercept)"
> > 
> > 
> > Does that work or am I missing something?
> 
> You're missing the context. What I really need is something that will
> extract a column of a matrix as a vector in the usual way, but will
> not get confused if there is only one row.


OK.  <scratching head.....>

Well, thinking that there was an approach using t(), it works, but
retains a 2 dim structure which is not what you want. It also retains
the colname from the original structure as the rowname for the new
construct.

I don't have another idea at this point for you, but I'll keep
thinking... :-)

Marc

From Achim.Zeileis at wu-wien.ac.at  Tue Mar 15 20:05:40 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Tue Mar 15 20:05:47 2005
Subject: [Rd] Lemon drops
In-Reply-To: <x2mzt4om5l.fsf@biostat.ku.dk>
References: <x2r7igon5j.fsf@biostat.ku.dk>
	<1110907737.8170.17.camel@horizons.localdomain>
	<x2mzt4om5l.fsf@biostat.ku.dk>
Message-ID: <20050315200540.7a3df8c7.Achim.Zeileis@wu-wien.ac.at>

On 15 Mar 2005 18:26:46 +0100 Peter Dalgaard wrote:

> Marc Schwartz <MSchwartz@MedAnalytics.com> writes:
> 
> > On Tue, 2005-03-15 at 18:05 +0100, Peter Dalgaard wrote:
> > > I bumped into the following situation:
> > > 
> > > Browse[1]> coef
> > >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > > (Intercept)    462    510    528    492    660    762
> > > Browse[1]> coef[,1]
> > > [1] 462
> > > Browse[1]> coef[,1,drop=F]
> > >             deg0NA
> > > (Intercept)    462
> > > 
> > > where I really wanted neither, but
> > > 
> > > (Intercept)
> > >         462
> > > 
> > > Anyone happen to know a neat way out of the conundrum?
> > > 
> > > I can think of
> > > 
> > > rowSums(coef[,1,drop=F])
> > > 
> > > or of course
> > > 
> > > val <- coef[,1]
> > > names(val) <- rownames(x))
> > > 
> > > but the first one is sneaky and the second gets a bit tedious...
> > 
> > Peter,
> > 
> > How about something like this:
> > 
> > > x
> >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > (Intercept)    462    510    528    492    660    762
> > IV1              1      2      3      4      5      6
> > 
> > 
> > > x[1]
> > (Intercept)
> >         462
> > 
> > > str(x[1])
> >  Named num 462
> >  - attr(*, "names")= chr "(Intercept)"
> > 
> > 
> > Does that work or am I missing something?
> 
> You're missing the context. What I really need is something that will
> extract a column of a matrix as a vector in the usual way, but will
> not get confused if there is only one row.

Maybe:
  coef[,1,drop=FALSE][1:nrow(coef)]
?
Z

> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45)
>  35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45)
> 35327907
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From andy_liaw at merck.com  Tue Mar 15 20:21:36 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue Mar 15 20:22:16 2005
Subject: [Rd] syntax error in memory.c when building R-devel on AIX
Message-ID: <3A822319EB35174CA3714066D590DCD50994E85D@usrymx25.merck.com>

OK, this is really a new one for me.  Just thought I'd try building R-devel
(2005-03-15) on our AIX power machines and see if there are any problems.  I
used the settings in the Appendix B of R-admin, using the set of variables
that Tim Hoar used (i.e., trying to build 64-bit R using native compilers).
configure ran fine, but `gmake' gave me a syntax error when compiling
src/main/memory.c.  The offending line seems to be:

    Rboolean success = FALSE;

Can anyone provide pointers?  

(Just to make sure, I tried building it on our SLES9-x86_64 box, and that
passes make check.)

TIA!
Andy

From MSchwartz at MedAnalytics.com  Tue Mar 15 20:30:00 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue Mar 15 20:30:18 2005
Subject: [Rd] Lemon drops
In-Reply-To: <20050315200540.7a3df8c7.Achim.Zeileis@wu-wien.ac.at>
References: <x2r7igon5j.fsf@biostat.ku.dk>
	<1110907737.8170.17.camel@horizons.localdomain>
	<x2mzt4om5l.fsf@biostat.ku.dk>
	<20050315200540.7a3df8c7.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <1110915001.8170.46.camel@horizons.localdomain>

On Tue, 2005-03-15 at 20:05 +0100, Achim Zeileis wrote:
> On 15 Mar 2005 18:26:46 +0100 Peter Dalgaard wrote:
> 
> > Marc Schwartz <MSchwartz@MedAnalytics.com> writes:
> > 
> > > On Tue, 2005-03-15 at 18:05 +0100, Peter Dalgaard wrote:
> > > > I bumped into the following situation:
> > > > 
> > > > Browse[1]> coef
> > > >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > > > (Intercept)    462    510    528    492    660    762
> > > > Browse[1]> coef[,1]
> > > > [1] 462
> > > > Browse[1]> coef[,1,drop=F]
> > > >             deg0NA
> > > > (Intercept)    462
> > > > 
> > > > where I really wanted neither, but
> > > > 
> > > > (Intercept)
> > > >         462
> > > > 
> > > > Anyone happen to know a neat way out of the conundrum?
> > > > 
> > > > I can think of
> > > > 
> > > > rowSums(coef[,1,drop=F])
> > > > 
> > > > or of course
> > > > 
> > > > val <- coef[,1]
> > > > names(val) <- rownames(x))
> > > > 
> > > > but the first one is sneaky and the second gets a bit tedious...
> > > 
> > > Peter,
> > > 
> > > How about something like this:
> > > 
> > > > x
> > >             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
> > > (Intercept)    462    510    528    492    660    762
> > > IV1              1      2      3      4      5      6
> > > 
> > > 
> > > > x[1]
> > > (Intercept)
> > >         462
> > > 
> > > > str(x[1])
> > >  Named num 462
> > >  - attr(*, "names")= chr "(Intercept)"
> > > 
> > > 
> > > Does that work or am I missing something?
> > 
> > You're missing the context. What I really need is something that will
> > extract a column of a matrix as a vector in the usual way, but will
> > not get confused if there is only one row.
> 
> Maybe:
>   coef[,1,drop=FALSE][1:nrow(coef)]
> ?
> Z


Hmmmm....interesting.

At the risk of this degenerating into an obfuscated R contest, Achim's
post just gave me an idea to build on my original thought:


# With one row:
> x
            deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
(Intercept)    462    510    528    492    660    762

> apply(t(x)[1, , drop = FALSE], 2, FUN = "[")
(Intercept)
        462



# Now with two rows:
> x2
            deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
(Intercept)    462    510    528    492    660    762
IV1              1      2      3      4      5      6

> apply(t(x2)[1, , drop = FALSE], 2, FUN = "[")
(Intercept)         IV1
        462           1


Marc

From ripley at stats.ox.ac.uk  Tue Mar 15 22:11:11 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 15 22:11:21 2005
Subject: [Rd] syntax error in memory.c when building R-devel on AIX
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E85D@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD50994E85D@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.61.0503152103380.25880@gannet.stats>

That statement was added yesterday (not by me) and needed moving up a 
line. Which version do you have?  The current one has

 	    Rboolean success = FALSE;
 	    s = NULL; /* initialize to suppress warning */

and passes all my tests.  The previous one had those two lines reversed 
and worked on gcc (with a warning) but failed on Solaris' cc (and was not 
legal ISO C90).


On Tue, 15 Mar 2005, Liaw, Andy wrote:

> OK, this is really a new one for me.  Just thought I'd try building R-devel
> (2005-03-15) on our AIX power machines and see if there are any problems.  I
> used the settings in the Appendix B of R-admin, using the set of variables
> that Tim Hoar used (i.e., trying to build 64-bit R using native compilers).
> configure ran fine, but `gmake' gave me a syntax error when compiling
> src/main/memory.c.  The offending line seems to be:
>
>    Rboolean success = FALSE;
>
> Can anyone provide pointers?
>
> (Just to make sure, I tried building it on our SLES9-x86_64 box, and that
> passes make check.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From andy_liaw at merck.com  Tue Mar 15 22:22:20 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue Mar 15 22:22:51 2005
Subject: [Rd] syntax error in memory.c when building R-devel on AIX
Message-ID: <3A822319EB35174CA3714066D590DCD50994E862@usrymx25.merck.com>

> From: Prof Brian Ripley
> 
> That statement was added yesterday (not by me) and needed moving up a 
> line. Which version do you have?  The current one has
> 
>  	    Rboolean success = FALSE;
>  	    s = NULL; /* initialize to suppress warning */
> 
> and passes all my tests.  The previous one had those two 
> lines reversed 
> and worked on gcc (with a warning) but failed on Solaris' cc 
> (and was not 
> legal ISO C90).

Mine has those two lines in reverse order.  I will reverse them and see how
that works.

Many thanks!

Andy


> 
> On Tue, 15 Mar 2005, Liaw, Andy wrote:
> 
> > OK, this is really a new one for me.  Just thought I'd try 
> building R-devel
> > (2005-03-15) on our AIX power machines and see if there are 
> any problems.  I
> > used the settings in the Appendix B of R-admin, using the 
> set of variables
> > that Tim Hoar used (i.e., trying to build 64-bit R using 
> native compilers).
> > configure ran fine, but `gmake' gave me a syntax error when 
> compiling
> > src/main/memory.c.  The offending line seems to be:
> >
> >    Rboolean success = FALSE;
> >
> > Can anyone provide pointers?
> >
> > (Just to make sure, I tried building it on our SLES9-x86_64 
> box, and that
> > passes make check.)
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 
>

From luke at stat.uiowa.edu  Tue Mar 15 23:00:47 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Tue Mar 15 23:01:04 2005
Subject: [Rd] syntax error in memory.c when building R-devel on AIX
In-Reply-To: <Pine.LNX.4.61.0503152103380.25880@gannet.stats>
References: <3A822319EB35174CA3714066D590DCD50994E85D@usrymx25.merck.com>
	<Pine.LNX.4.61.0503152103380.25880@gannet.stats>
Message-ID: <Pine.LNX.4.61.0503151559130.16436@nokomis.stat.uiowa.edu>

On Tue, 15 Mar 2005, Prof Brian Ripley wrote:

> That statement was added yesterday (not by me) and needed moving up a line. 
> Which version do you have?  The current one has
>
> 	    Rboolean success = FALSE;
> 	    s = NULL; /* initialize to suppress warning */
>
> and passes all my tests.  The previous one had those two lines reversed and 
> worked on gcc (with a warning) but failed on Solaris' cc (and was not legal 
> ISO C90).

That was me--sorry.  gcc -Wall does not warn -- I've added -pedantic
to my .Rconf; that does warn.

luke

>
>
> On Tue, 15 Mar 2005, Liaw, Andy wrote:
>
>> OK, this is really a new one for me.  Just thought I'd try building R-devel
>> (2005-03-15) on our AIX power machines and see if there are any problems. 
>> I
>> used the settings in the Appendix B of R-admin, using the set of variables
>> that Tim Hoar used (i.e., trying to build 64-bit R using native compilers).
>> configure ran fine, but `gmake' gave me a syntax error when compiling
>> src/main/memory.c.  The offending line seems to be:
>> 
>>    Rboolean success = FALSE;
>> 
>> Can anyone provide pointers?
>> 
>> (Just to make sure, I tried building it on our SLES9-x86_64 box, and that
>> passes make check.)
>
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From ggrothendieck at myway.com  Tue Mar 15 23:44:08 2005
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Tue Mar 15 23:55:10 2005
Subject: [Rd] Lemon drops
References: <x2r7igon5j.fsf@biostat.ku.dk>
Message-ID: <loom.20050315T233915-735@post.gmane.org>

Peter Dalgaard <p.dalgaard <at> biostat.ku.dk> writes:

: 
: I bumped into the following situation:
: 
: Browse[1]> coef
:             deg0NA deg4NA deg8NA deg0NP deg4NP deg8NP
: (Intercept)    462    510    528    492    660    762
: Browse[1]> coef[,1]
: [1] 462
: Browse[1]> coef[,1,drop=F]
:             deg0NA
: (Intercept)    462
: 
: where I really wanted neither, but
: 
: (Intercept)
:         462
: 
: Anyone happen to know a neat way out of the conundrum?
: 
: I can think of
: 
: rowSums(coef[,1,drop=F])
: 
: or of course
: 
: val <- coef[,1]
: names(val) <- rownames(x))
: 
: but the first one is sneaky and the second gets a bit tedious...
: 


If by tedious you mean its not a single expression
then the basic idea of your solution #2 can be preserved
while doing it in a single expression like this:

structure(coef[,1], .Names = rownames(x))

From s.ruiter at ru.nl  Wed Mar 16 00:00:23 2005
From: s.ruiter at ru.nl (s.ruiter@ru.nl)
Date: Wed Mar 16 00:00:31 2005
Subject: [Rd] Trigonometric functions (PR#7728)
Message-ID: <20050315230023.8F5678571@slim.kubism.ku.dk>

Full_Name: Stijn Ruiter
Version: 2.0.1
OS: Linux
Submission from: (NULL) (195.169.225.10)


Why does

asin(1)
result in:
1.570796

and

x<-sqrt(2)
asin(x^2-1)
result in:
NaN

From tlumley at u.washington.edu  Wed Mar 16 00:08:25 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed Mar 16 00:08:42 2005
Subject: [Rd] Trigonometric functions (PR#7728)
In-Reply-To: <20050315230023.8F5678571@slim.kubism.ku.dk>
References: <20050315230023.8F5678571@slim.kubism.ku.dk>
Message-ID: <Pine.A41.4.61b.0503151507080.383546@homer03.u.washington.edu>

On Wed, 16 Mar 2005 s.ruiter@ru.nl wrote:

>
> Why does
>
> asin(1)
> result in:
> 1.570796

Because the arcsin of 1 is pi/2 radians.

> and
>
> x<-sqrt(2)
> asin(x^2-1)
> result in:
> NaN

Because you can't take the arcsin of 2^2-1=3.

 	-thomas

From kleiweg at let.rug.nl  Wed Mar 16 00:19:11 2005
From: kleiweg at let.rug.nl (Peter Kleiweg)
Date: Wed Mar 16 00:19:23 2005
Subject: [Rd] Trigonometric functions (PR#7728)
In-Reply-To: <Pine.A41.4.61b.0503151507080.383546@homer03.u.washington.edu>
Message-ID: <Pine.LNX.4.44.0503160018280.2246-100000@kleigh.nl>

Thomas Lumley schreef op de 15e dag van de lentemaand van het jaar 2005:


> > x<-sqrt(2)
> > asin(x^2-1)
> > result in:
> > NaN
>
> Because you can't take the arcsin of 2^2-1=3.

Wrong answer.

Why is this a bug report?

-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From tlumley at u.washington.edu  Wed Mar 16 00:26:30 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed Mar 16 00:26:48 2005
Subject: [Rd] Trigonometric functions (PR#7728)
In-Reply-To: <Pine.LNX.4.44.0503160018280.2246-100000@kleigh.nl>
References: <Pine.LNX.4.44.0503160018280.2246-100000@kleigh.nl>
Message-ID: <Pine.A41.4.61b.0503151524570.383546@homer03.u.washington.edu>

On Wed, 16 Mar 2005, Peter Kleiweg wrote:

> Thomas Lumley schreef op de 15e dag van de lentemaand van het jaar 2005:
>
>
>>> x<-sqrt(2)
>>> asin(x^2-1)
>>> result in:
>>> NaN
>>
>> Because you can't take the arcsin of 2^2-1=3.
>
> Wrong answer.

You're right.  It's actually because you can't take the arcsin of 
1+4.4e-16.  Same problem, just less extreme.

> x<-sqrt(2)
> x^2-1==1
[1] FALSE
> x^2-1>1
[1] TRUE
> x^2-1-1
[1] 4.440892e-16


 	-thomas

From vograno at evafunds.com  Wed Mar 16 00:30:11 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed Mar 16 00:30:22 2005
Subject: [Rd] How to store void* on 64 bit machines
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF422@phost015.EVAFUNDS.intermedia.net>

Hi,
 
I have an R class which represents a file stream (this is my custom
implementation of R I/O and has nothing to do with the standard R
connections). The class has a slot, called id, which is essentially a
void* pointer to a C++ stream object.
 
Up until now I worked on 32-bit machines and the id slot was an integer,
so one could cast back and forth between int and void*. However, on
64-bits void* is castable to 'long int', but not int, which poses a
couple of problems:
a) since there is no R arrays of 'long int' type what other built-in
type can I use to store void*. For example double is big enough to
accommodate void*, but I am not sure whether casting will work both
ways.
b) assuming that a) is solvable, is there a solution which is portable
between 64 and 32 bit machines?
 
Thanks,
Vadim

	[[alternative HTML version deleted]]

From osklyar at ebi.ac.uk  Wed Mar 16 00:31:46 2005
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Wed Mar 16 00:32:01 2005
Subject: [Rd] returning NULL from .Call call
Message-ID: <42377062.4020702@ebi.ac.uk>

Dear R developers,

I've just encountered one "feature" of R-C extensions. If it is known, I 
would be thankful for any hints why it works this way (I found the way 
around, which is also mentioned here, but maybe it is not the best one). 
If it is however unknown, it might be considered for a "wish list".

Consider a simple "aka" C function (the original implementation loads 
complex data structures and there could be other causes of trouble apart 
from non-existing files):

SEXP loadData(SEXP fileName) {
    int* data = NULL;
    try {
       // try to open the file and read the data into 'data'
    } catch(...) {
       std::cout << "Load failed (ANY REASON) - returning NULL" << 
std::endl;
       return NULL;
    }
    // operation successful, but the size of data can be nil
    if(data == NULL)
       return NULL;
    SEXP result = allocVector(INTSXP, numOfDataPoints);
    PROTECT(result);
    // copy data from 'data' into 'result'
    delete[] data;
    UNPROTECT(1);
    return result;
}

This function will nicely return a data array if no load problems occur 
and data is more than nil. If it is not the case I would be happy to 
receive a NULL as indication that the function didn't succeed, which I 
can then check with is.nul(...). I would consider it logical for SEXP, 
which is a pointer (in this case to a non-existing structure). However, 
trying to return NULL causes 'Segmentation Fault' without any further 
message and R-session closes. The question is, what would be a working 
way to return anything like NULL, something to check with is.null(...)?

Now the way around (just in case it might be of interest), slightly 
modified function returning numeric(0) on fail:

SEXP loadData(SEXP fileName) {
    // prerecreate and protect a non-NULL return value: numeric(0)
    SEXP result = allocVector(INTSXP, 0);
    PROTECT(result);
    int* data = NULL;
    try {
       // try to open the file and read the data into 'data'
    } catch(...) {
       std::cout << "Load failed (ANY REASON) - returning NULL" << 
std::endl;
       // unprotect and return numeric(0)
       UNPROTECT(1);
       return result;
    }
    // operation successful, but the size of data can be nil
    // unprotect old value to enable garbage collector to kill it sooner 
or later
    UNPROTECT(1);
    if(data == NULL)
       return result;
    // recreate and protect the return value
    result = allocVector(INTSXP, numOfDataPoints);
    PROTECT(result);
    // copy data from 'data' into 'result'
    delete[] data;
    UNPROTECT(1);
    return result;
}

This function always has something to return and it works, but not 
really elegantly and returning wrong data when fails.

Thanks in advance for any comments.
Regards
Oleg

-- 
Dr Oleg Sklyar
European Bioinformatics Institute
Wellcome Trust Genome Campus
Hinxton, Cambridge, CB10 1SD
England
phone/fax  +44(0)1223 49 4478/4468
e-mail osklyar@ebi.ac.uk

From ripley at stats.ox.ac.uk  Wed Mar 16 00:49:11 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 00:49:21 2005
Subject: [Rd] How to store void* on 64 bit machines
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF422@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF422@phost015.EVAFUNDS.intermedia.net>
Message-ID: <Pine.LNX.4.61.0503152342400.17975@gannet.stats>

On Tue, 15 Mar 2005, Vadim Ogranovich wrote:

> I have an R class which represents a file stream (this is my custom
> implementation of R I/O and has nothing to do with the standard R
> connections). The class has a slot, called id, which is essentially a
> void* pointer to a C++ stream object.
>
> Up until now I worked on 32-bit machines and the id slot was an integer,

If by `slot' you mean the slot in an S4 class, that is not correct.
R has integer vectors, not integer scalars.

> so one could cast back and forth between int and void*. However, on
> 64-bits void* is castable to 'long int', but not int, which poses a
> couple of problems:
> a) since there is no R arrays of 'long int' type what other built-in
> type can I use to store void*. For example double is big enough to
> accommodate void*, but I am not sure whether casting will work both
> ways.
>
> b) assuming that a) is solvable, is there a solution which is portable
> between 64 and 32 bit machines?

The raw type can store anything: your pointer is just a stream of bytes.
It could also be stored as one or two integers.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Mar 16 00:58:09 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 00:58:18 2005
Subject: [Rd] returning NULL from .Call call
In-Reply-To: <42377062.4020702@ebi.ac.uk>
References: <42377062.4020702@ebi.ac.uk>
Message-ID: <Pine.LNX.4.61.0503152349580.17975@gannet.stats>

On Tue, 15 Mar 2005, Oleg Sklyar wrote:

> Dear R developers,
>
> I've just encountered one "feature" of R-C extensions.

What feature is that?  (It really is not clear from your description.)

NULL in R is expressed as R_NilValue in C.  What did you do when `trying 
to return NULL'?  NULL in C is not a valid value for a SEXP pointer, of 
course.

This is documented in `Writing R Extensions', and there are many examples 
of it around.

> If it is known, I would be thankful for any hints why it works this way 
> (I found the way around, which is also mentioned here, but maybe it is 
> not the best one). If it is however unknown, it might be considered for 
> a "wish list".
>
> Consider a simple "aka" C function (the original implementation loads complex 
> data structures and there could be other causes of trouble apart from 
> non-existing files):
>
> SEXP loadData(SEXP fileName) {
>   int* data = NULL;
>   try {
>      // try to open the file and read the data into 'data'
>   } catch(...) {
>      std::cout << "Load failed (ANY REASON) - returning NULL" << std::endl;
>      return NULL;
>   }
>   // operation successful, but the size of data can be nil
>   if(data == NULL)
>      return NULL;
>   SEXP result = allocVector(INTSXP, numOfDataPoints);
>   PROTECT(result);
>   // copy data from 'data' into 'result'
>   delete[] data;
>   UNPROTECT(1);
>   return result;
> }
>
> This function will nicely return a data array if no load problems occur and 
> data is more than nil. If it is not the case I would be happy to receive a 
> NULL as indication that the function didn't succeed, which I can then check 
> with is.nul(...). I would consider it logical for SEXP, which is a pointer 
> (in this case to a non-existing structure). However, trying to return NULL 
> causes 'Segmentation Fault' without any further message and R-session closes. 
> The question is, what would be a working way to return anything like NULL, 
> something to check with is.null(...)?
>
> Now the way around (just in case it might be of interest), slightly modified 
> function returning numeric(0) on fail:
>
> SEXP loadData(SEXP fileName) {
>   // prerecreate and protect a non-NULL return value: numeric(0)
>   SEXP result = allocVector(INTSXP, 0);
>   PROTECT(result);
>   int* data = NULL;
>   try {
>      // try to open the file and read the data into 'data'
>   } catch(...) {
>      std::cout << "Load failed (ANY REASON) - returning NULL" << std::endl;
>      // unprotect and return numeric(0)
>      UNPROTECT(1);
>      return result;
>   }
>   // operation successful, but the size of data can be nil
>   // unprotect old value to enable garbage collector to kill it sooner or 
> later
>   UNPROTECT(1);
>   if(data == NULL)
>      return result;
>   // recreate and protect the return value
>   result = allocVector(INTSXP, numOfDataPoints);
>   PROTECT(result);
>   // copy data from 'data' into 'result'
>   delete[] data;
>   UNPROTECT(1);
>   return result;
> }
>
> This function always has something to return and it works, but not really 
> elegantly and returning wrong data when fails.
>
> Thanks in advance for any comments.
> Regards
> Oleg
>
> -- 
> Dr Oleg Sklyar
> European Bioinformatics Institute
> Wellcome Trust Genome Campus
> Hinxton, Cambridge, CB10 1SD
> England
> phone/fax  +44(0)1223 49 4478/4468
> e-mail osklyar@ebi.ac.uk
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Mar 16 01:12:09 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 01:12:19 2005
Subject: [Rd] How to store void* on 64 bit machines
In-Reply-To: <Pine.LNX.4.61.0503152342400.17975@gannet.stats>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF422@phost015.EVAFUNDS.intermedia.net>
	<Pine.LNX.4.61.0503152342400.17975@gannet.stats>
Message-ID: <Pine.LNX.4.61.0503160009020.18306@gannet.stats>

On Tue, 15 Mar 2005, Prof Brian Ripley wrote:

> On Tue, 15 Mar 2005, Vadim Ogranovich wrote:
>
>> I have an R class which represents a file stream (this is my custom
>> implementation of R I/O and has nothing to do with the standard R
>> connections). The class has a slot, called id, which is essentially a
>> void* pointer to a C++ stream object.
>> 
>> Up until now I worked on 32-bit machines and the id slot was an integer,
>
> If by `slot' you mean the slot in an S4 class, that is not correct.
> R has integer vectors, not integer scalars.
>
>> so one could cast back and forth between int and void*. However, on
>> 64-bits void* is castable to 'long int', but not int, which poses a
>> couple of problems:
>> a) since there is no R arrays of 'long int' type what other built-in
>> type can I use to store void*. For example double is big enough to
>> accommodate void*, but I am not sure whether casting will work both
>> ways.
>> 
>> b) assuming that a) is solvable, is there a solution which is portable
>> between 64 and 32 bit machines?
>
> The raw type can store anything: your pointer is just a stream of bytes.
> It could also be stored as one or two integers.

Depending what you want to do with this pointer and if there is only one 
of them, the externalptr type might be an even better match -- be careful 
about the non-copy-on-change semantics of that type.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From vograno at evafunds.com  Wed Mar 16 03:58:32 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed Mar 16 03:58:43 2005
Subject: [Rd] function-like macros undefined
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF437@phost015.EVAFUNDS.intermedia.net>

Hi,
 
Somehow function-like macros from Rinternals.h are not defined when I
include the file.
 
foo.c
##################
#include <R.h>
#include <Rinternals.h>
 

#ifndef NILSXP
#error("NILSXP")
#endif
 

#ifndef INTEGER
#error("INTEGER")
#endif
###################

 
When compiled:
vor/src% gcc -I/usr/local/lib/R/include  -g -O2 -c foo.c -o foo.o
foo.c:11:2: #error ("INTEGER")

Note that NILSXP is defined. This is true for some other function-like
macros, e.g. RAW()
 
 
Did anyone come across such a problem?
 
> version
         _                       
platform x86_64-unknown-linux-gnu
arch     x86_64                  
os       linux-gnu               
system   x86_64, linux-gnu       
status                           
major    2                       
minor    0.1                     
year     2004                    
month    11                      
day      15                      
language R                       

 
OS: suse.9.2_64
 
Note also that R doesn't recognize this is Suse, it says
x86_64-unknown-linux-gnu. Hope this is not a problem.
 
Thanks,
Vadim

	[[alternative HTML version deleted]]

From r.hankin at soc.soton.ac.uk  Wed Mar 16 09:04:24 2005
From: r.hankin at soc.soton.ac.uk (Robin Hankin)
Date: Wed Mar 16 09:04:41 2005
Subject: [Rd] Trigonometric functions (PR#7728)
In-Reply-To: <Pine.A41.4.61b.0503151524570.383546@homer03.u.washington.edu>
References: <Pine.LNX.4.44.0503160018280.2246-100000@kleigh.nl>
	<Pine.A41.4.61b.0503151524570.383546@homer03.u.washington.edu>
Message-ID: <16091bc726bb18999a039e4b48236a49@soc.soton.ac.uk>


On Mar 15, 2005, at 11:26 pm, Thomas Lumley wrote:

> On Wed, 16 Mar 2005, Peter Kleiweg wrote:
>
>> Thomas Lumley schreef op de 15e dag van de lentemaand van het jaar 
>> 2005:
>>
>>
>>>> x<-sqrt(2)
>>>> asin(x^2-1)
>>>> result in:
>>>> NaN
>>>
>

The way I would deal with this would be to force asin() to work in 
complex mode:

 > x <- sqrt(2)
 > asin(x^2-1+0i)
[1] 1.570796+2.980232e-08i
 >

(the error is large because the derivative of arcsin is infinite at 
x=1).

--
Robin Hankin
Uncertainty Analyst
Southampton Oceanography Centre
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743

From dkoschuetzki at gmx.de  Wed Mar 16 11:39:31 2005
From: dkoschuetzki at gmx.de (dkoschuetzki@gmx.de)
Date: Wed Mar 16 11:39:39 2005
Subject: [Rd] Documentation: add link from "::" to "get" (PR#7729)
Message-ID: <20050316103931.B3D32BB71@slim.kubism.ku.dk>

Full_Name: Dirk Koschuetzki
Version: 2.0.1
OS: Linux (Debian Sarge)
Submission from: (NULL) (194.94.136.34)


Please add a link from the page for "::" (accessing from name spaces) to the
more general "get". 

Reason: Some package do not provide a name space add via "get" a (seoncd) method
exists to call a masked function.

From murdoch at stats.uwo.ca  Wed Mar 16 15:42:30 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Mar 16 15:42:30 2005
Subject: [Rd] function-like macros undefined
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF437@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF437@phost015.EVAFUNDS.intermedia.net>
Message-ID: <94hg31lqon7m2a7q4729gvb5g9578dbfst@4ax.com>

On Tue, 15 Mar 2005 18:58:32 -0800, "Vadim Ogranovich"
<vograno@evafunds.com> wrote :

>Hi,
> 
>Somehow function-like macros from Rinternals.h are not defined when I
>include the file.
> 
>foo.c
>##################
>#include <R.h>
>#include <Rinternals.h>
> 
>
>#ifndef NILSXP
>#error("NILSXP")
>#endif
> 
>
>#ifndef INTEGER
>#error("INTEGER")
>#endif
>###################
>
> 
>When compiled:
>vor/src% gcc -I/usr/local/lib/R/include  -g -O2 -c foo.c -o foo.o
>foo.c:11:2: #error ("INTEGER")
>
>Note that NILSXP is defined. This is true for some other function-like
>macros, e.g. RAW()

The definition of INTEGER is wrapped in 

#ifdef USE_RINTERNALS

and there's this comment in Defn.h:

/* To test the write barrier used by the generational collector,
   define TESTING_WRITE_BARRIER.  This makes the internal structure of
   SEXPRECs visible only inside of files that explicitly define
   USE_RINTERNALS, and all uses of SEXPREC fields that do not go
   through the appropriate functions or macros will become compilation
   errors.  Since this does impose a small but noticable performance
   penalty, code that includes Defn.h (or code that explicitly defines
   USE_RINTERNALS) can access a SEXPREC's fields directly. */

To read about the reasons for the write barrier, see

http://www.stat.uiowa.edu/~luke/R/barrier.html

Duncan Murdoch
> 
> 
>Did anyone come across such a problem?
> 
>> version
>         _                       
>platform x86_64-unknown-linux-gnu
>arch     x86_64                  
>os       linux-gnu               
>system   x86_64, linux-gnu       
>status                           
>major    2                       
>minor    0.1                     
>year     2004                    
>month    11                      
>day      15                      
>language R                       
>
> 
>OS: suse.9.2_64
> 
>Note also that R doesn't recognize this is Suse, it says
>x86_64-unknown-linux-gnu. Hope this is not a problem.
> 
>Thanks,
>Vadim
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From deepayan at stat.wisc.edu  Wed Mar 16 16:18:53 2005
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Wed Mar 16 16:17:57 2005
Subject: [Rd] minor iconvlist() bug in r-devel
Message-ID: <200503160918.53650.deepayan@stat.wisc.edu>


This is on r-devel from 2005-03-15. iconvlist() uses (at least some of 
the time)

icfile <- system.file("iconvlist", package = "utils")

which looks like 

"""
The following list contain all the coded character sets known.  This 
does not necessarily mean that all combinations of these names can be 
used for the FROM and TO command line parameters.  One coded character
set can be listed with several different names (aliases).

  437//
500//
.
.
.
"""

which leads to 

> tail(iconvlist(), n = 40)
 [1] "WS2"          "YU"           "all"          "all"          "and"
 [6] "be"           "be"           "can"          "can"      "character"
[11] "character"    "coded"        "coded"     "combinations" "command"
[16] "contain"      "different"    "does"         "following"    "for"
[21] "known."       "line"         "list"         "listed"       "mean"
[26] "names"        "names"        "necessarily"  "not"          "of"
[31] "parameters."  "set"          "sets"         "several"      "that"
[36] "the"          "the"          "these"        "used"         "with"

A possible fix seems to be to replace

    ext <- readLines(icfile)

by 

    ext <- grep("/$", readLines(icfile), value = TRUE)

but I don't know if that's guaranteed to work. 

-Deepayan

From ripley at stats.ox.ac.uk  Wed Mar 16 17:11:15 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 17:11:23 2005
Subject: [Rd] minor iconvlist() bug in r-devel
In-Reply-To: <200503160918.53650.deepayan@stat.wisc.edu>
References: <200503160918.53650.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.61.0503161547390.31367@gannet.stats>

That file is created by

$(top_builddir)/library/$(pkg)/iconvlist: most
         @iconv -l > $@ 2> /dev/null || touch $@

What version of iconv -l is that produces such a list?  That in glibc 
2.3.4 does not produce the header when redirected.

Your fix is not safe: iconv in libiconv produces items separated by space 
or newline.  Looks like we will have to work harder to distinguish the 
two.

Brian


On Wed, 16 Mar 2005, Deepayan Sarkar wrote:

>
> This is on r-devel from 2005-03-15. iconvlist() uses (at least some of
> the time)
>
> icfile <- system.file("iconvlist", package = "utils")
>
> which looks like
>
> """
> The following list contain all the coded character sets known.  This
> does not necessarily mean that all combinations of these names can be
> used for the FROM and TO command line parameters.  One coded character
> set can be listed with several different names (aliases).
>
>  437//
> 500//
> .
> .
> .
> """
>
> which leads to
>
>> tail(iconvlist(), n = 40)
> [1] "WS2"          "YU"           "all"          "all"          "and"
> [6] "be"           "be"           "can"          "can"      "character"
> [11] "character"    "coded"        "coded"     "combinations" "command"
> [16] "contain"      "different"    "does"         "following"    "for"
> [21] "known."       "line"         "list"         "listed"       "mean"
> [26] "names"        "names"        "necessarily"  "not"          "of"
> [31] "parameters."  "set"          "sets"         "several"      "that"
> [36] "the"          "the"          "these"        "used"         "with"
>
> A possible fix seems to be to replace
>
>    ext <- readLines(icfile)
>
> by
>
>    ext <- grep("/$", readLines(icfile), value = TRUE)
>
> but I don't know if that's guaranteed to work.
>
> -Deepayan
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From deepayan at stat.wisc.edu  Wed Mar 16 17:47:35 2005
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Wed Mar 16 17:46:36 2005
Subject: [Rd] minor iconvlist() bug in r-devel
In-Reply-To: <Pine.LNX.4.61.0503161547390.31367@gannet.stats>
References: <200503160918.53650.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503161547390.31367@gannet.stats>
Message-ID: <200503161047.35764.deepayan@stat.wisc.edu>

On Wednesday 16 March 2005 10:11, Prof Brian Ripley wrote:
> That file is created by
>
> $(top_builddir)/library/$(pkg)/iconvlist: most
>          @iconv -l > $@ 2> /dev/null || touch $@
>
> What version of iconv -l is that produces such a list?  That in glibc
> 2.3.4 does not produce the header when redirected.

I have version '2.3.2.ds1-20' on Debian testing. '--silent' doesn't 
help.

> Your fix is not safe: iconv in libiconv produces items separated by
> space or newline.  Looks like we will have to work harder to
> distinguish the two.

Can anything with a lowercase letter be safely rejected? That would 
bring the spurious names down to 2 (FROM and TO).

Deepayan

> Brian
>
> On Wed, 16 Mar 2005, Deepayan Sarkar wrote:
> > This is on r-devel from 2005-03-15. iconvlist() uses (at least some
> > of the time)
> >
> > icfile <- system.file("iconvlist", package = "utils")
> >
> > which looks like
> >
> > """
> > The following list contain all the coded character sets known. 
> > This does not necessarily mean that all combinations of these names
> > can be used for the FROM and TO command line parameters.  One coded
> > character set can be listed with several different names (aliases).
> >
> >  437//
> > 500//
> > .
> > .
> > .
> > """
> >
> > which leads to
> >
> >> tail(iconvlist(), n = 40)
> >
> > [1] "WS2"          "YU"           "all"          "all"         
> > "and" [6] "be"           "be"           "can"          "can"     
> > "character" [11] "character"    "coded"        "coded"    
> > "combinations" "command" [16] "contain"      "different"    "does" 
> >        "following"    "for" [21] "known."       "line"        
> > "list"         "listed"       "mean" [26] "names"        "names"   
> >     "necessarily"  "not"          "of" [31] "parameters."  "set"   
> >       "sets"         "several"      "that" [36] "the"         
> > "the"          "these"        "used"         "with"
> >
> > A possible fix seems to be to replace
> >
> >    ext <- readLines(icfile)
> >
> > by
> >
> >    ext <- grep("/$", readLines(icfile), value = TRUE)
> >
> > but I don't know if that's guaranteed to work.
> >
> > -Deepayan
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Wed Mar 16 17:57:56 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 17:58:05 2005
Subject: [Rd] minor iconvlist() bug in r-devel
In-Reply-To: <200503161047.35764.deepayan@stat.wisc.edu>
References: <200503160918.53650.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503161547390.31367@gannet.stats>
	<200503161047.35764.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.61.0503161650070.368@gannet.stats>

On Wed, 16 Mar 2005, Deepayan Sarkar wrote:

> On Wednesday 16 March 2005 10:11, Prof Brian Ripley wrote:
>> That file is created by
>>
>> $(top_builddir)/library/$(pkg)/iconvlist: most
>>          @iconv -l > $@ 2> /dev/null || touch $@
>>
>> What version of iconv -l is that produces such a list?  That in glibc
>> 2.3.4 does not produce the header when redirected.
>
> I have version '2.3.2.ds1-20' on Debian testing. '--silent' doesn't
> help.

I found an old RH9 system that did the same thing.

>> Your fix is not safe: iconv in libiconv produces items separated by
>> space or newline.  Looks like we will have to work harder to
>> distinguish the two.
>
> Can anything with a lowercase letter be safely rejected? That would
> bring the spurious names down to 2 (FROM and TO).

No.  I think what we can do is to look to see if most lines end in //, and 
if so assume glibc format.

Brian

>
> Deepayan
>
>> Brian
>>
>> On Wed, 16 Mar 2005, Deepayan Sarkar wrote:
>>> This is on r-devel from 2005-03-15. iconvlist() uses (at least some
>>> of the time)
>>>
>>> icfile <- system.file("iconvlist", package = "utils")
>>>
>>> which looks like
>>>
>>> """
>>> The following list contain all the coded character sets known.
>>> This does not necessarily mean that all combinations of these names
>>> can be used for the FROM and TO command line parameters.  One coded
>>> character set can be listed with several different names (aliases).
>>>
>>>  437//
>>> 500//
>>> .
>>> .
>>> .
>>> """
>>>
>>> which leads to
>>>
>>>> tail(iconvlist(), n = 40)
>>>
>>> [1] "WS2"          "YU"           "all"          "all"
>>> "and" [6] "be"           "be"           "can"          "can"
>>> "character" [11] "character"    "coded"        "coded"
>>> "combinations" "command" [16] "contain"      "different"    "does"
>>>        "following"    "for" [21] "known."       "line"
>>> "list"         "listed"       "mean" [26] "names"        "names"
>>>     "necessarily"  "not"          "of" [31] "parameters."  "set"
>>>       "sets"         "several"      "that" [36] "the"
>>> "the"          "these"        "used"         "with"
>>>
>>> A possible fix seems to be to replace
>>>
>>>    ext <- readLines(icfile)
>>>
>>> by
>>>
>>>    ext <- grep("/$", readLines(icfile), value = TRUE)
>>>
>>> but I don't know if that's guaranteed to work.
>>>
>>> -Deepayan
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From deepayan at stat.wisc.edu  Wed Mar 16 18:25:27 2005
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Wed Mar 16 18:24:28 2005
Subject: [Rd] minor iconvlist() bug in r-devel
In-Reply-To: <Pine.LNX.4.61.0503161650070.368@gannet.stats>
References: <200503160918.53650.deepayan@stat.wisc.edu>
	<200503161047.35764.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503161650070.368@gannet.stats>
Message-ID: <200503161125.27681.deepayan@stat.wisc.edu>

On Wednesday 16 March 2005 10:57, Prof Brian Ripley wrote:
> On Wed, 16 Mar 2005, Deepayan Sarkar wrote:
> > On Wednesday 16 March 2005 10:11, Prof Brian Ripley wrote:
> >> That file is created by
> >>
> >> $(top_builddir)/library/$(pkg)/iconvlist: most
> >>          @iconv -l > $@ 2> /dev/null || touch $@
> >>
> >> What version of iconv -l is that produces such a list?  That in
> >> glibc 2.3.4 does not produce the header when redirected.
> >
> > I have version '2.3.2.ds1-20' on Debian testing. '--silent' doesn't
> > help.
>
> I found an old RH9 system that did the same thing.
>
> >> Your fix is not safe: iconv in libiconv produces items separated
> >> by space or newline.  Looks like we will have to work harder to
> >> distinguish the two.
> >
> > Can anything with a lowercase letter be safely rejected? That would
> > bring the spurious names down to 2 (FROM and TO).
>
> No.  I think what we can do is to look to see if most lines end in
> //, and if so assume glibc format.

Yes, that should be good enough.  Actually, the matches intended by the 
glibc version seems to be those that look like "^.*/.*/$". In 
particular, there are names like 

ISO-10646/UCS2/
ISO-10646/UCS4/
ISO-10646/UTF-8/
ISO-10646/UTF8/

which should end up as

ISO-10646/UCS2, ISO-10646/UCS4, ISO-10646/UTF-8, ISO-10646/UTF8

but currently end up as 

 [545] "ISO-10646/UCS2/"        "ISO-10646/UCS4/"
 [547] "ISO-10646/UTF-8/"       "ISO-10646/UTF8/"

The libiconv equivalents look like 

ISO-10646-UCS-2
ISO-10646-UCS-4

which should be fine as they are.

Deepayan

From ripley at stats.ox.ac.uk  Wed Mar 16 18:34:25 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 18:34:34 2005
Subject: [Rd] minor iconvlist() bug in r-devel
In-Reply-To: <200503161125.27681.deepayan@stat.wisc.edu>
References: <200503160918.53650.deepayan@stat.wisc.edu>
	<200503161047.35764.deepayan@stat.wisc.edu>
	<Pine.LNX.4.61.0503161650070.368@gannet.stats>
	<200503161125.27681.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.61.0503161730310.5014@gannet.stats>

On Wed, 16 Mar 2005, Deepayan Sarkar wrote:

> On Wednesday 16 March 2005 10:57, Prof Brian Ripley wrote:
>> On Wed, 16 Mar 2005, Deepayan Sarkar wrote:
>>> On Wednesday 16 March 2005 10:11, Prof Brian Ripley wrote:
>>>> That file is created by
>>>>
>>>> $(top_builddir)/library/$(pkg)/iconvlist: most
>>>>          @iconv -l > $@ 2> /dev/null || touch $@
>>>>
>>>> What version of iconv -l is that produces such a list?  That in
>>>> glibc 2.3.4 does not produce the header when redirected.
>>>
>>> I have version '2.3.2.ds1-20' on Debian testing. '--silent' doesn't
>>> help.
>>
>> I found an old RH9 system that did the same thing.
>>
>>>> Your fix is not safe: iconv in libiconv produces items separated
>>>> by space or newline.  Looks like we will have to work harder to
>>>> distinguish the two.
>>>
>>> Can anything with a lowercase letter be safely rejected? That would
>>> bring the spurious names down to 2 (FROM and TO).
>>
>> No.  I think what we can do is to look to see if most lines end in
>> //, and if so assume glibc format.
>
> Yes, that should be good enough.  Actually, the matches intended by the
> glibc version seems to be those that look like "^.*/.*/$". In
> particular, there are names like
>
> ISO-10646/UCS2/
> ISO-10646/UCS4/
> ISO-10646/UTF-8/
> ISO-10646/UTF8/
>
> which should end up as
>
> ISO-10646/UCS2, ISO-10646/UCS4, ISO-10646/UTF-8, ISO-10646/UTF8
>
> but currently end up as
>
> [545] "ISO-10646/UCS2/"        "ISO-10646/UCS4/"
> [547] "ISO-10646/UTF-8/"       "ISO-10646/UTF8/"

I don't think so, and neither variant is in the human-readable list. The 
only documentation I have seen (a comment which said this, and `don't 
ask') suggests that only those ending in // are valid, and indeed that is 
all that gets through the most recent change.

> The libiconv equivalents look like
>
> ISO-10646-UCS-2
> ISO-10646-UCS-4

You only need UCS-2 and UCS-4, with LE and BE variants.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From osklyar at ebi.ac.uk  Wed Mar 16 18:40:54 2005
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Wed Mar 16 18:41:04 2005
Subject: [Rd] .Call - applying setAttrib(x, R_DimSymbol,
 s) to a matrix being an element of a list
Message-ID: <42386FA6.7040800@ebi.ac.uk>

Dear R developers,

I am writing some C code that loads multiple images into a list of R 
matrices. The whole R object is created within the C code. To simplify 
coding, elements of the list are first created as vectors and then 
converted to corresponding matrices using setAttrib(x, R_DimSymbol, s). 
Generally the code works fine except for one detail. Applying setAttrib 
sets ALL elements (matrices) in the list to the same size, namely to the 
one last applied, doesn't matter if other matrices are larger or 
smaller. The command is applied to an element, not to the whole list in 
the following way, see below. Is there any way to change the dims of an 
element without altering other elements in this example? Furthermore, if 
I skip the last command and return a list of vectors instead of a list 
of matrices - all vectors have different lengths corresponding to the 
respective image sizes.

// creating the list to hold matrices
SEXP result = allocVector(VECSXP, nFiles);

// creating a vector for the list element i
SET_VECTOR_ELT(result, i, allocVector(INTSXP, size[0] * size[1]));

// getting a pointer to the element to simlify coding
SEXP element = VECTOR_ELT(result, i);

// writing some values to the element

// converting element into a matrix
setAttrib(element, R_DimSymbol, imgSize);

Thanks in advance for help
Oleg

Dr Oleg Sklyar
European Bioinformatics Institute
Wellcome Trust Genome Campus
Hinxton, Cambridge, CB10 1SD
England
phone/fax  +44(0)1223 49 4478/4468
e-mail osklyar@ebi.ac.uk

From simon.urbanek at r-project.org  Wed Mar 16 19:01:46 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed Mar 16 19:02:07 2005
Subject: [Rd] .Call - applying setAttrib(x, R_DimSymbol,
	s) to a matrix being an element of a list
In-Reply-To: <42386FA6.7040800@ebi.ac.uk>
References: <42386FA6.7040800@ebi.ac.uk>
Message-ID: <34C019CA-160A-4AFF-B622-CFB95201F5AD@r-project.org>

Oleg,

you gave us only a fragment of your code, so I can only guess what the 
problem is:

On Mar 16, 2005, at 12:40 PM, Oleg Sklyar wrote:

> // converting element into a matrix
> setAttrib(element, R_DimSymbol, imgSize);

What is imgSize? The behavior you describe seems as if you re-using the 
imgSize SEXP in all elements. AFAIR in your case setAttrib doesn't copy 
the value, so you need to do so yourself (or alloc new dim array for 
each element).

Cheers,
Simon

From vograno at evafunds.com  Wed Mar 16 19:34:56 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed Mar 16 19:35:18 2005
Subject: Write Barrier: was: [Rd] function-like macros undefined
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF45A@phost015.EVAFUNDS.intermedia.net>

Hi,

Thank you to Duncan Murdoch for pointing to
http://www.stat.uiowa.edu/~luke/R/barrier.html.
I have a couple of questions in this regard:

* suppose that inside a C function I have a SEXP vector x of integers
and I want to increment each element by one. I understand that

int * xIPtr = INTEGER(x);
int i;

for (i=0; i<LENGTH(x); ++i)
     SET_VECTOR_ELT(x, i, xIPtr[i]+1);


is the recommended way of doing it. However it seems that only the very
first call to SET_VECTOR_ELT, i.e. the one that corresponds to i=0, is
strictly necessary. For example, and this is my question, the following
should be perfectly safe:

SET_VECTOR_ELT(x, 0, xIPtr[0]);

for (i=0; i<LENGTH(x); ++i)
     ++xIPtr[i];


Admittedly this looks a bit odd and breaks if LENGTH(x) is zero, but it
illustrates the point.

* Now, if the above variation is safe, maybe there is a macro that
simply marks atomic SEXP-s, i.g. integers and doubles, for modification?

* The "Write Barrier" document has a section "Changing the
Representation of String Vectors". Is this something which is in works,
or planned, for future versions? It would be great if it were, this
should give R considerable speed boost.

Thanks,
Vadim

From simon.urbanek at r-project.org  Wed Mar 16 19:56:37 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed Mar 16 19:56:58 2005
Subject: Write Barrier: was: [Rd] function-like macros undefined
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF45A@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF45A@phost015.EVAFUNDS.intermedia.net>
Message-ID: <745ED15D-F32A-4216-A268-2BCBFA828858@r-project.org>

On Mar 16, 2005, at 1:34 PM, Vadim Ogranovich wrote:

> * suppose that inside a C function I have a SEXP vector x of integers
> and I want to increment each element by one. I understand that

Please correct me if I'm wrong, but I thought that the write barrier 
applies to assignments of SEXP values only (from the doc: "... must be 
used for all assignments of SEXP pointers ..." - note it says "of", not 
"to"). When dealing with REAL/INTEGER, I believe it's still safe to use 
INTEGER(x)[0]=... IMHO that's logical, too, because primitive types 
have no 'age' to be inherited when using ggc.

Cheers,
Simon

From luke at stat.uiowa.edu  Wed Mar 16 20:08:10 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed Mar 16 20:08:27 2005
Subject: Write Barrier: was: [Rd] function-like macros undefined
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF45A@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF45A@phost015.EVAFUNDS.intermedia.net>
Message-ID: <Pine.LNX.4.61.0503161255520.17514@nokomis.stat.uiowa.edu>

Your original question was about macro-like functions.  INTEGER is
available to internal R code as a macro; it is also available as a
function.  Code in packages that uses standard hearders will see the
function, which is declared as

int *(INTEGER)(SEXP x);

I have no idea why you wanted to check whether INTEGER is a macro or
not.  The value returned is a pointer to the raw int data which you
can (ab)use like any other such pointer.

On Wed, 16 Mar 2005, Vadim Ogranovich wrote:

> Hi,
>
> Thank you to Duncan Murdoch for pointing to
> http://www.stat.uiowa.edu/~luke/R/barrier.html.
> I have a couple of questions in this regard:
>
> * suppose that inside a C function I have a SEXP vector x of integers
> and I want to increment each element by one. I understand that
>
> int * xIPtr = INTEGER(x);
> int i;
>
> for (i=0; i<LENGTH(x); ++i)
>     SET_VECTOR_ELT(x, i, xIPtr[i]+1);
>

The declaration of SET_VECTOR_ELT is

SEXP (SET_VECTOR_ELT)(SEXP x, int i, SEXP v);

Your compiler had better complain about your third argument.

> is the recommended way of doing it. However it seems that only the very
> first call to SET_VECTOR_ELT, i.e. the one that corresponds to i=0, is
> strictly necessary. For example, and this is my question, the following
> should be perfectly safe:
>
> SET_VECTOR_ELT(x, 0, xIPtr[0]);
>
> for (i=0; i<LENGTH(x); ++i)
>     ++xIPtr[i];

????????

> Admittedly this looks a bit odd and breaks if LENGTH(x) is zero, but it
> illustrates the point.
>
> * Now, if the above variation is safe, maybe there is a macro that
> simply marks atomic SEXP-s, i.g. integers and doubles, for modification?

Vectors of non-SEXP objects are not a problem--that is why REAL,
INTEGER, etc are available as functions to access the raw data
pointers.  Only vectors of SEXP's (i.e. generic and character vector
objects) need to go through the write barrier.

> * The "Write Barrier" document has a section "Changing the
> Representation of String Vectors". Is this something which is in works,
> or planned, for future versions? It would be great if it were, this
> should give R considerable speed boost.

This was considered at the time but is not on the table now.

luke


-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From vograno at evafunds.com  Wed Mar 16 20:32:23 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed Mar 16 20:33:30 2005
Subject: Write Barrier: was: [Rd] function-like macros undefined
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF466@phost015.EVAFUNDS.intermedia.net>

Luke,

My actual problem was with the RAW() macro, it is not available as a
function. I used INTEGER as an illustration because it was in the same
group of macros, I guess I shouldn't have.

Thank you for your other comments. I was confused, somehow I thought
that in 2.0.x ALL access, even to the atomic vectors, should be done via
macros/functions.

Thanks,
Vadim

> -----Original Message-----
> From: Luke Tierney [mailto:luke@stat.uiowa.edu] 
> Sent: Wednesday, March 16, 2005 11:08 AM
> To: Vadim Ogranovich
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: Write Barrier: was: [Rd] function-like macros undefined
> 
> Your original question was about macro-like functions.  
> INTEGER is available to internal R code as a macro; it is 
> also available as a function.  Code in packages that uses 
> standard hearders will see the function, which is declared as
> 
> int *(INTEGER)(SEXP x);
> 
> I have no idea why you wanted to check whether INTEGER is a 
> macro or not.  The value returned is a pointer to the raw int 
> data which you can (ab)use like any other such pointer.
> 
> On Wed, 16 Mar 2005, Vadim Ogranovich wrote:
> 
> > Hi,
> >
> > Thank you to Duncan Murdoch for pointing to 
> > http://www.stat.uiowa.edu/~luke/R/barrier.html.
> > I have a couple of questions in this regard:
> >
> > * suppose that inside a C function I have a SEXP vector x 
> of integers 
> > and I want to increment each element by one. I understand that
> >
> > int * xIPtr = INTEGER(x);
> > int i;
> >
> > for (i=0; i<LENGTH(x); ++i)
> >     SET_VECTOR_ELT(x, i, xIPtr[i]+1);
> >
> 
> The declaration of SET_VECTOR_ELT is
> 
> SEXP (SET_VECTOR_ELT)(SEXP x, int i, SEXP v);
> 
> Your compiler had better complain about your third argument.
> 
> > is the recommended way of doing it. However it seems that only the 
> > very first call to SET_VECTOR_ELT, i.e. the one that corresponds to 
> > i=0, is strictly necessary. For example, and this is my 
> question, the 
> > following should be perfectly safe:
> >
> > SET_VECTOR_ELT(x, 0, xIPtr[0]);
> >
> > for (i=0; i<LENGTH(x); ++i)
> >     ++xIPtr[i];
> 
> ????????
> 
> > Admittedly this looks a bit odd and breaks if LENGTH(x) is 
> zero, but 
> > it illustrates the point.
> >
> > * Now, if the above variation is safe, maybe there is a macro that 
> > simply marks atomic SEXP-s, i.g. integers and doubles, for 
> modification?
> 
> Vectors of non-SEXP objects are not a problem--that is why 
> REAL, INTEGER, etc are available as functions to access the 
> raw data pointers.  Only vectors of SEXP's (i.e. generic and 
> character vector
> objects) need to go through the write barrier.
> 
> > * The "Write Barrier" document has a section "Changing the 
> > Representation of String Vectors". Is this something which is in 
> > works, or planned, for future versions? It would be great 
> if it were, 
> > this should give R considerable speed boost.
> 
> This was considered at the time but is not on the table now.
> 
> luke
> 
> 
> --
> Luke Tierney
> Chair, Statistics and Actuarial Science
> Ralph E. Wareham Professor of Mathematical Sciences
> University of Iowa                  Phone:             319-335-3386
> Department of Statistics and        Fax:               319-335-3017
>     Actuarial Science
> 241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>

From ripley at stats.ox.ac.uk  Wed Mar 16 21:11:13 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 16 21:11:24 2005
Subject: Write Barrier: was: [Rd] function-like macros undefined
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF466@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF466@phost015.EVAFUNDS.intermedia.net>
Message-ID: <Pine.LNX.4.61.0503162007450.7319@gannet.stats>

On Wed, 16 Mar 2005, Vadim Ogranovich wrote:

> My actual problem was with the RAW() macro, it is not available as a
> function. I used INTEGER as an illustration because it was in the same
> group of macros, I guess I shouldn't have.

It *is* available in R-devel, soon to be 2.1.0: the function was 
overlooked for 2.0.x.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From stvjc at channing.harvard.edu  Wed Mar 16 21:57:30 2005
From: stvjc at channing.harvard.edu (Vincent Carey 525-2265)
Date: Wed Mar 16 21:57:39 2005
Subject: [Rd] authentication support question
Message-ID: <Pine.GSO.4.58.0503161552340.19164@capecod.bwh.harvard.edu>

I need to obtain username and password strings from the
user of a certain process running in R.  scan() can be used
to get the strings, but the password will be echoed back as the
user types it.  Is there any way to load keyboard input
to a variable without echoing the input back to the screen?

Thanks

From osklyar at ebi.ac.uk  Thu Mar 17 02:34:53 2005
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Thu Mar 17 02:35:09 2005
Subject: [Rd] .Call - applying setAttrib(x, R_DimSymbol, s) to a matrix
	being an element of a list
In-Reply-To: <34C019CA-160A-4AFF-B622-CFB95201F5AD@r-project.org>
References: <42386FA6.7040800@ebi.ac.uk>
	<34C019CA-160A-4AFF-B622-CFB95201F5AD@r-project.org>
Message-ID: <4238DEBD.1090805@ebi.ac.uk>

Dear Simon,

 > you gave us only a fragment of your code, so I can only guess what 
the problem is:

 > What is imgSize? The behavior you describe seems as if you re-using 
the imgSize SEXP in all elements.
 > AFAIR in your case setAttrib doesn't copy the value, so you need to 
do so yourself (or alloc new dim array
 > for each element).

Sorry, it is always a tradeoff - either to explain or put a relatively 
large code, which also uses non-standard libraries making the code 
difficult to read. imgSize values are reset in between: see the full 
code below. The SEXP pointer imgSize stays in tact, that's true, but its 
values are changed (the problem is, they are always the last in the 
row). I.e. if I have 3 images 40x20, 200x100 and 150x75 I will get three 
matrices of 150x75, but if I omit setAtrib and return vectors I get 
vectors of different length.

Oleg

SEXP load2DImages(SEXP fileNames) {
    int nFiles = LENGTH(fileNames);
    std::cout << "Loading " << nFiles << " files..." << std::endl;
    // SEXP result = allocList(nFiles);
    SEXP result = allocVector(VECSXP, nFiles);
    PROTECT(result);
    SEXP imgSize = allocVector(INTSXP, 2);
    PROTECT(imgSize);
    TRGB2DImage::Pointer image;
    TRGB2DReader::Pointer reader = TRGB2DReader::New();
    TRGB2DImage::SizeType size;   
    TRGB2DImage::IndexType pixIndex;
    for (int i = 0; i < nFiles; i++) {
        try {
            char *filename = CHAR(asChar(VECTOR_ELT(fileNames, i)));
            std::cout << std::endl << "Loading image file " << filename 
<< "... ";
            reader->SetFileName(filename);
            reader->Update();
            image = reader->GetOutput();
        } catch(...) {
            std::cout << "failed!";
            continue;
        }
        std::cout << std::endl;
        size = image->GetLargestPossibleRegion().GetSize();
        INTEGER(imgSize)[0] = size[1];
        INTEGER(imgSize)[1] = size[0];
        std::cout << size[0] << " x " << size[1] << std::endl;
        SET_VECTOR_ELT(result, i, allocVector(INTSXP, size[0] * size[1]));
        SEXP element = VECTOR_ELT(result, i);
        for (int ix = 0; ix < size[0]; ix++) {
            pixIndex[0] = ix;
            for (int iy = 0; iy < size[1]; iy++) {
                pixIndex[1] = iy;
                INTEGER(element)[size[1] * ix + iy] = 
getIntRGBColour(image->GetPixel(pixIndex));
            }
        }
        setAttrib(element, R_DimSymbol, imgSize);
    }
    UNPROTECT(2);
    if (nFiles == 1)
        return VECTOR_ELT(result, 0);
    else
        return result;
}

Dr Oleg Sklyar
European Bioinformatics Institute
Wellcome Trust Genome Campus
Hinxton, Cambridge, CB10 1SD
England
phone/fax  +44(0)1223 49 4478/4468
e-mail osklyar@ebi.ac.uk



Simon Urbanek wrote:

> Oleg,
>
> you gave us only a fragment of your code, so I can only guess what the 
> problem is:
>
> On Mar 16, 2005, at 12:40 PM, Oleg Sklyar wrote:
>
>> // converting element into a matrix
>> setAttrib(element, R_DimSymbol, imgSize);
>
>
> What is imgSize? The behavior you describe seems as if you re-using 
> the imgSize SEXP in all elements. AFAIR in your case setAttrib doesn't 
> copy the value, so you need to do so yourself (or alloc new dim array 
> for each element).
>
> Cheers,
> Simon
>
>
>

From ripley at stats.ox.ac.uk  Thu Mar 17 09:46:50 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar 17 09:46:59 2005
Subject: [Rd] .Call - applying setAttrib(x, R_DimSymbol, s) to a matrix
	being an element of a list
In-Reply-To: <4238DEBD.1090805@ebi.ac.uk>
References: <42386FA6.7040800@ebi.ac.uk>
	<34C019CA-160A-4AFF-B622-CFB95201F5AD@r-project.org>
	<4238DEBD.1090805@ebi.ac.uk>
Message-ID: <Pine.LNX.4.61.0503170719060.14118@gannet.stats>

On Thu, 17 Mar 2005, Oleg Sklyar wrote:

> Dear Simon,
>
>> you gave us only a fragment of your code, so I can only guess what the 
> problem is:
>
>> What is imgSize? The behavior you describe seems as if you re-using the 
> imgSize SEXP in all elements.
>> AFAIR in your case setAttrib doesn't copy the value, so you need to do so 
> yourself (or alloc new dim array
>> for each element).
>
> Sorry, it is always a tradeoff - either to explain or put a relatively large 
> code, which also uses non-standard libraries making the code difficult to 
> read. imgSize values are reset in between: see the full code below. The SEXP 
> pointer imgSize stays in tact, that's true, but its values are changed (the 
> problem is, they are always the last in the row). I.e. if I have 3 images 
> 40x20, 200x100 and 150x75 I will get three matrices of 150x75, but if I omit 
> setAtrib and return vectors I get vectors of different length.

So, as Simon says, you need to create separate objects for the dimensions 
of each matrix, not share the object.  It is the object pointed to by 
imgSize you have attached as the dimensions, not the values.

BTW, setAttrib(element, R_DimSymbol, imgSize) just calls dimgets(element, 
imgSize), so I would have used the latter directly.

I believe you do not have three matrices of 150x75, rather a vector of 
length 40*20 with an inconsistent dim attribute of c(150, 75), etc.

>
> Oleg
>
> SEXP load2DImages(SEXP fileNames) {
>   int nFiles = LENGTH(fileNames);
>   std::cout << "Loading " << nFiles << " files..." << std::endl;
>   // SEXP result = allocList(nFiles);
>   SEXP result = allocVector(VECSXP, nFiles);
>   PROTECT(result);
>   SEXP imgSize = allocVector(INTSXP, 2);
>   PROTECT(imgSize);
>   TRGB2DImage::Pointer image;
>   TRGB2DReader::Pointer reader = TRGB2DReader::New();
>   TRGB2DImage::SizeType size;      TRGB2DImage::IndexType pixIndex;
>   for (int i = 0; i < nFiles; i++) {
>       try {
>           char *filename = CHAR(asChar(VECTOR_ELT(fileNames, i)));
>           std::cout << std::endl << "Loading image file " << filename << 
> "... ";
>           reader->SetFileName(filename);
>           reader->Update();
>           image = reader->GetOutput();
>       } catch(...) {
>           std::cout << "failed!";
>           continue;
>       }
>       std::cout << std::endl;
>       size = image->GetLargestPossibleRegion().GetSize();
>       INTEGER(imgSize)[0] = size[1];
>       INTEGER(imgSize)[1] = size[0];
>       std::cout << size[0] << " x " << size[1] << std::endl;
>       SET_VECTOR_ELT(result, i, allocVector(INTSXP, size[0] * size[1]));
>       SEXP element = VECTOR_ELT(result, i);
>       for (int ix = 0; ix < size[0]; ix++) {
>           pixIndex[0] = ix;
>           for (int iy = 0; iy < size[1]; iy++) {
>               pixIndex[1] = iy;
>               INTEGER(element)[size[1] * ix + iy] = 
> getIntRGBColour(image->GetPixel(pixIndex));
>           }
>       }
>       setAttrib(element, R_DimSymbol, imgSize);
>   }
>   UNPROTECT(2);
>   if (nFiles == 1)
>       return VECTOR_ELT(result, 0);
>   else
>       return result;
> }
>
> Dr Oleg Sklyar
> European Bioinformatics Institute
> Wellcome Trust Genome Campus
> Hinxton, Cambridge, CB10 1SD
> England
> phone/fax  +44(0)1223 49 4478/4468
> e-mail osklyar@ebi.ac.uk
>
>
>
> Simon Urbanek wrote:
>
>> Oleg,
>> 
>> you gave us only a fragment of your code, so I can only guess what the 
>> problem is:
>> 
>> On Mar 16, 2005, at 12:40 PM, Oleg Sklyar wrote:
>> 
>>> // converting element into a matrix
>>> setAttrib(element, R_DimSymbol, imgSize);
>> 
>> 
>> What is imgSize? The behavior you describe seems as if you re-using the 
>> imgSize SEXP in all elements. AFAIR in your case setAttrib doesn't copy the 
>> value, so you need to do so yourself (or alloc new dim array for each 
>> element).
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu Mar 17 12:45:19 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar 17 12:45:31 2005
Subject: [Rd] authentication support question
In-Reply-To: <Pine.GSO.4.58.0503161552340.19164@capecod.bwh.harvard.edu>
References: <Pine.GSO.4.58.0503161552340.19164@capecod.bwh.harvard.edu>
Message-ID: <Pine.LNX.4.61.0503171140120.16994@gannet.stats>

On Wed, 16 Mar 2005, Vincent Carey 525-2265 wrote:

> I need to obtain username and password strings from the
> user of a certain process running in R.  scan() can be used
> to get the strings, but the password will be echoed back as the
> user types it.  Is there any way to load keyboard input
> to a variable without echoing the input back to the screen?

Not from an arbitrary terminal.

You haven't told us the OS, but e.g. on Unix-alikes with readline it is 
readline rather than R which is doing the echoing.

I would us a dialog box for such things: graphapp has one which we use for 
proxy authentication under Windows.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From laurent.mauron at credit-suisse.com  Thu Mar 17 13:22:44 2005
From: laurent.mauron at credit-suisse.com (Mauron Laurent (KETR 31))
Date: Thu Mar 17 13:22:58 2005
Subject: [Rd] Compiling "R Embedded" examples
Message-ID: <ED765D0AD42FD6408805FA8A766868D103C4E8B3@sxchs009b.itzrh.ska.com>

Hi,

This question was first posted wrongly on R-help. Apologize for the inconvenience.

I am working at a major financial institution and we would like to embed R in one of our front office application. 
The application is written in C/C++ so I started by trying to compile the examples in "tests/Embedding" of R 2.0.1.

I have modified "tests/Embedding/Makefile" according to  https://stat.ethz.ch/pipermail/r-help/2005-February/064341.html 
and set "LD_LIBRARY_PATH" using 

export LD_LIBRARY_PATH="/home/laurent/R-clean/lib/R/lib"

But I get the following error messages during linking:

---------------------
laurent@pollux $ make clean
laurent@pollux $ make
gcc -I. -I../../src/include -I/home/laurent/R-2.0.1/src/include -I/usr/local/include -DHAVE_CONFIG_H   -g -O2 -c /home/laurent/R-2.0.1/tests/Embedding/Rtest.c -o Rtest.o
gcc -I. -I../../src/include -I/home/laurent/R-2.0.1/src/include -I/usr/local/include -DHAVE_CONFIG_H   -g -O2 -c /home/laurent/R-2.0.1/tests/Embedding/embeddedRCall.c -o embeddedRCall.o
../../bin/R CMD LINK gcc -o Rtest Rtest.o embeddedRCall.o -L/home/laurent/R-clean/lib -lR
mkdir .libs
gcc -o Rtest Rtest.o embeddedRCall.o  -L/home/laurent/R-clean/lib -lR -R/home/laurent/R-clean/lib/R/lib
Undefined                       first referenced
 symbol                             in file
MAIN__                              /home/laurent/R-clean/lib/libR.so
ld: fatal: Symbol referencing errors. No output written to Rtest
collect2: ld returned 1 exit status
*** Error code 1
make: Fatal error: Command failed for target `Rtest'
-----------------------

I have installed R from source using the following commands.

-----------------------
laurent@pollux $ cd /home/laurent/R-clean/
laurent@pollux $ /home/laurent/R-2.0.1/configure --enable-R-shlib --prefix=/home/laurent/R-clean
laurent@pollux $ make
laurent@pollux $ make install
-----------------------

I am running Solaris 5.8 as non-admin user, compiler is gcc 2.95.3. Please let me know if more specific information about the environment is required.

Has anyone ne an idea where is the problem? I would be extremly grateful if someone could help us.

Best regards,

Laurent

From simon.urbanek at r-project.org  Thu Mar 17 15:06:22 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu Mar 17 15:06:38 2005
Subject: [Rd] .Call - applying setAttrib(x, R_DimSymbol,
	s) to a matrix being an element of a list
In-Reply-To: <4238DEBD.1090805@ebi.ac.uk>
References: <42386FA6.7040800@ebi.ac.uk>
	<34C019CA-160A-4AFF-B622-CFB95201F5AD@r-project.org>
	<4238DEBD.1090805@ebi.ac.uk>
Message-ID: <455C84D0-365B-47B9-9FFF-F0C5F6F334D0@r-project.org>

Oleg,

On Mar 16, 2005, at 8:34 PM, Oleg Sklyar wrote:

> Sorry, it is always a tradeoff - either to explain or put a 
> relatively large code,

Just posting all R related commands is sufficient ;) - in your case 
that would be the single imgSize alloc and the assignments- but the 
full code is fine, too.

> which also uses non-standard libraries making the code difficult to 
> read. imgSize values are reset in between: see the full code below. 
> The SEXP pointer imgSize stays in tact,

That's the problem. As I said previously - you need to duplicate it or 
alloc new ones. setAttrib of non-NAMED values doesn't copy the value, 
so you're passing the same pointer to all your matrices, so they all 
share the same dimension object. This means that whenever you change 
integers the pointer is pointing at, you change it for all matrices you 
used it in, which is probably not what you intended.

> that's true, but its values are changed (the problem is, they are 
> always the last in the row). I.e. if I have 3 images 40x20, 200x100 
> and 150x75 I will get three matrices of 150x75, but if I omit 
> setAtrib and return vectors I get vectors of different length.

The length of the vector has nothing to do with the dimensions - 
technically. In C you can say "this is a vector of 10 integers and has 
dimension 100x200" - although such matrix is invalid, in C you're free 
to do so. It's up to your code to make sure the dimension and the 
vector length match. In your case, they don't and your code is to blame 
;).

Cheers,
Simon

From osklyar at ebi.ac.uk  Thu Mar 17 16:16:53 2005
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Thu Mar 17 16:17:08 2005
Subject: [Rd] .Call - applying setAttrib(x, R_DimSymbol, s) to a matrix
	being an element of a list
In-Reply-To: <Pine.LNX.4.61.0503170719060.14118@gannet.stats>
References: <42386FA6.7040800@ebi.ac.uk>
	<34C019CA-160A-4AFF-B622-CFB95201F5AD@r-project.org>
	<4238DEBD.1090805@ebi.ac.uk>
	<Pine.LNX.4.61.0503170719060.14118@gannet.stats>
Message-ID: <42399F65.6020801@ebi.ac.uk>

Thanks a lot for your comments. In fact I had an idea that maybe it is a 
pointer that is transferred after Simon's yesterday's commnent. So 
generally I should always allocVector for imgSize before passing it and 
just let the garbage collector to clean them afterwards if I understand 
right.

Best regards
Oleg

Dr Oleg Sklyar
European Bioinformatics Institute
Wellcome Trust Genome Campus
Hinxton, Cambridge, CB10 1SD
England
phone/fax  +44(0)1223 49 4478/4468
e-mail osklyar@ebi.ac.uk



Prof Brian Ripley wrote:

> On Thu, 17 Mar 2005, Oleg Sklyar wrote:
>
>> Dear Simon,
>>
>>> you gave us only a fragment of your code, so I can only guess what the 
>>
>> problem is:
>>
>>> What is imgSize? The behavior you describe seems as if you re-using the 
>>
>> imgSize SEXP in all elements.
>>
>>> AFAIR in your case setAttrib doesn't copy the value, so you need to 
>>> do so 
>>
>> yourself (or alloc new dim array
>>
>>> for each element).
>>
>>
>> Sorry, it is always a tradeoff - either to explain or put a 
>> relatively large code, which also uses non-standard libraries making 
>> the code difficult to read. imgSize values are reset in between: see 
>> the full code below. The SEXP pointer imgSize stays in tact, that's 
>> true, but its values are changed (the problem is, they are always the 
>> last in the row). I.e. if I have 3 images 40x20, 200x100 and 150x75 I 
>> will get three matrices of 150x75, but if I omit setAtrib and return 
>> vectors I get vectors of different length.
>
>
> So, as Simon says, you need to create separate objects for the 
> dimensions of each matrix, not share the object.  It is the object 
> pointed to by imgSize you have attached as the dimensions, not the 
> values.
>
> BTW, setAttrib(element, R_DimSymbol, imgSize) just calls 
> dimgets(element, imgSize), so I would have used the latter directly.
>
> I believe you do not have three matrices of 150x75, rather a vector of 
> length 40*20 with an inconsistent dim attribute of c(150, 75), etc.
>
>>
>> Oleg
>>
>> SEXP load2DImages(SEXP fileNames) {
>>   int nFiles = LENGTH(fileNames);
>>   std::cout << "Loading " << nFiles << " files..." << std::endl;
>>   // SEXP result = allocList(nFiles);
>>   SEXP result = allocVector(VECSXP, nFiles);
>>   PROTECT(result);
>>   SEXP imgSize = allocVector(INTSXP, 2);
>>   PROTECT(imgSize);
>>   TRGB2DImage::Pointer image;
>>   TRGB2DReader::Pointer reader = TRGB2DReader::New();
>>   TRGB2DImage::SizeType size;      TRGB2DImage::IndexType pixIndex;
>>   for (int i = 0; i < nFiles; i++) {
>>       try {
>>           char *filename = CHAR(asChar(VECTOR_ELT(fileNames, i)));
>>           std::cout << std::endl << "Loading image file " << filename 
>> << "... ";
>>           reader->SetFileName(filename);
>>           reader->Update();
>>           image = reader->GetOutput();
>>       } catch(...) {
>>           std::cout << "failed!";
>>           continue;
>>       }
>>       std::cout << std::endl;
>>       size = image->GetLargestPossibleRegion().GetSize();
>>       INTEGER(imgSize)[0] = size[1];
>>       INTEGER(imgSize)[1] = size[0];
>>       std::cout << size[0] << " x " << size[1] << std::endl;
>>       SET_VECTOR_ELT(result, i, allocVector(INTSXP, size[0] * size[1]));
>>       SEXP element = VECTOR_ELT(result, i);
>>       for (int ix = 0; ix < size[0]; ix++) {
>>           pixIndex[0] = ix;
>>           for (int iy = 0; iy < size[1]; iy++) {
>>               pixIndex[1] = iy;
>>               INTEGER(element)[size[1] * ix + iy] = 
>> getIntRGBColour(image->GetPixel(pixIndex));
>>           }
>>       }
>>       setAttrib(element, R_DimSymbol, imgSize);
>>   }
>>   UNPROTECT(2);
>>   if (nFiles == 1)
>>       return VECTOR_ELT(result, 0);
>>   else
>>       return result;
>> }
>>
>> Dr Oleg Sklyar
>> European Bioinformatics Institute
>> Wellcome Trust Genome Campus
>> Hinxton, Cambridge, CB10 1SD
>> England
>> phone/fax  +44(0)1223 49 4478/4468
>> e-mail osklyar@ebi.ac.uk
>>
>>
>>
>> Simon Urbanek wrote:
>>
>>> Oleg,
>>>
>>> you gave us only a fragment of your code, so I can only guess what 
>>> the problem is:
>>>
>>> On Mar 16, 2005, at 12:40 PM, Oleg Sklyar wrote:
>>>
>>>> // converting element into a matrix
>>>> setAttrib(element, R_DimSymbol, imgSize);
>>>
>>>
>>>
>>> What is imgSize? The behavior you describe seems as if you re-using 
>>> the imgSize SEXP in all elements. AFAIR in your case setAttrib 
>>> doesn't copy the value, so you need to do so yourself (or alloc new 
>>> dim array for each element).
>>>
>>> Cheers,
>>> Simon
>>>
>>>
>>>
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>

From stvjc at channing.harvard.edu  Thu Mar 17 17:52:23 2005
From: stvjc at channing.harvard.edu (Vincent Carey 525-2265)
Date: Thu Mar 17 17:52:32 2005
Subject: [Rd] authentication support question
In-Reply-To: <Pine.LNX.4.61.0503171140120.16994@gannet.stats>
References: <Pine.GSO.4.58.0503161552340.19164@capecod.bwh.harvard.edu>
	<Pine.LNX.4.61.0503171140120.16994@gannet.stats>
Message-ID: <Pine.GSO.4.58.0503171136510.16@capecod.bwh.harvard.edu>


On Thu, 17 Mar 2005, Prof Brian Ripley wrote:

> On Wed, 16 Mar 2005, Vincent Carey 525-2265 wrote:
>
> > I need to obtain username and password strings from the
> > user of a certain process running in R.  scan() can be used
> > to get the strings, but the password will be echoed back as the
> > user types it.  Is there any way to load keyboard input
> > to a variable without echoing the input back to the screen?
>
> Not from an arbitrary terminal.
>
> You haven't told us the OS, but e.g. on Unix-alikes with readline it is
> readline rather than R which is doing the echoing.
>
> I would us a dialog box for such things: graphapp has one which we use for
> proxy authentication under Windows.
>

Thanks; I am in a unix setting.  I have coded a C solution using
the getpass library function.  Interested users can contact me for
the source (which does not work (yet?) under windows as the getpass symbol
cannot be found by the default SHLIB actions.)

From DMoore at exchange.hsc.mb.ca  Thu Mar 17 18:08:24 2005
From: DMoore at exchange.hsc.mb.ca (DMoore@exchange.hsc.mb.ca)
Date: Thu Mar 17 18:08:40 2005
Subject: [Rd] FW: R Process Killed out of logical swap space: Case id
	#259-4945 (PR#7732)
Message-ID: <20050317170824.30989C400@slim.kubism.ku.dk>


Dear Professor Ripley,

I am attempting a large scale mixed-model analysis of longitudinal gene
array data using R. I use a 64-bit SGI with 7GB available RAM and 40G
logical swap space together with unlimited virual swap space. The OS is IRIX
6.5.24. I use R version 1.9.0 since I have had problems upgrading to R 2.0.1
at 64-bit using native SGI compiler build.

I write a serial   for (i in 1:length(y)) { }
containing the call to lme as follows 

f1<-lme( expr ~ time + age + sex,random = ~ time | id,
correlation=cs3,data=gg.data.frame,method="ML",weights=varIdent(form= ~id))

After ~ 200 - 300 loops the process is killed by the OS with the following
errors

Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
space during stack growth - see swap(1M) [filter /usr/sbin/klogpp failed:
killed by signal 9]
Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
space during stack growth - see swap(1M)
Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
space during stack growth - see swap(1M)
Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
space during stack growth - see swap(1M)
Mar 17 08:55:56 1A:helmholtz unix: |$(0x6dc)ALERT: Process [R.bin] pid 1157
killed: not enough memory to grow stack
Mar 17 08:55:56 1A:helmholtz unix: |$(0x6dc)ALERT: Process [R.bin] pid 1157
killed: not enough memory to grow stack
Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd[1642] was killed; Dynamic
Loader cannot get enough memory to map exe
Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd[1642] was killed; Dynamic
Loader cannot get enough memory to map exe
Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd [1642] - out of logical
swap space during exec - see swap(1M)
Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd [1642] - out of logical
swap space during exec - see swap(1M)

I have observed the crash while examining the system memory and stack
allocations - these do not appear to be growing during execution of the
process loops. I have checked with SGI and the view is that this is likely
related to R. While there are several work-arounds it would be ideal to
'batch' this job and further it is unclear to me what is happening. I am
grateful for your attention and potential insights.

Sincerely

David F. Moore
Associate Professor of Vascular Neurology
University of Manitoba

This e-mail and/or any documents in this transmission is intended for the address(s) only and may contain legally privileged or confidential information. Any unauthorized use, disclosure, distribution, copying or dissemination is strictly prohibited. If you receive this transmission in error, please notify the sender immediately and return the original.

From dig.list at nm.ru  Thu Mar 17 19:15:40 2005
From: dig.list at nm.ru (DIG)
Date: Thu Mar 17 19:16:03 2005
Subject: [Rd] translation R into Russian
Message-ID: <20050317181540.GC14872@phenix.rootshell.be>

Hello, R developers,

I would like to contribute to the R project: I prepared Russian .po-files (and translated a few lines).

List of changes:

  * files *ru.po are generated and a few lines are translated;
  * files ./po/LINGUAS and ./po/THANKS are modified.

I am not sure whether to post the .diff- and archive files here would be such a great idea, so I put them on-line:

  (1) https://dig.yi.org/tmp/R/diff.-ruN.against-33659.diff.gz
  (2) https://dig.yi.org/tmp/R/new-files-for-33659.tar.gz

First file is the result of ``diff -ruN'' against revision 33659, and the second one is just gzipped tar archive of new or modified files.  So, use ``patch'' with the first file to modify the 33659 revision tree, or just unzip+untar second file over the 33659 revision tree.


Best regards,

P.S. Duncan, have you received my last (Mon Mar 14 06:29:39 2005) letter?

--
DIG (Dmitri I GOULIAEV)
1024D/63A6C649: 26A0 E4D5 AB3F C2D4 0112  66CD 4343 C0AF 63A6 C649

-------------- next part --------------
./R/po/LINGUAS
./R/po/THANKS
./R/po/ru.po
./R/po/RGui-ru.po
./R/src/library/base/po/R-ru.po
./R/src/library/graphics/po/R-ru.po
./R/src/library/grDevices/po/R-ru.po
./R/src/library/grDevices/po/ru.po
./R/src/library/grid/po/R-ru.po
./R/src/library/grid/po/ru.po
./R/src/library/methods/po/R-ru.po
./R/src/library/methods/po/ru.po
./R/src/library/splines/po/R-ru.po
./R/src/library/splines/po/ru.po
./R/src/library/stats/po/R-ru.po
./R/src/library/stats/po/ru.po
./R/src/library/stats4/po/R-ru.po
./R/src/library/tcltk/po/R-ru.po
./R/src/library/tools/po/R-ru.po
./R/src/library/tools/po/ru.po
./R/src/library/utils/po/R-ru.po
From p.dalgaard at biostat.ku.dk  Thu Mar 17 19:14:06 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Mar 17 19:21:13 2005
Subject: [Rd] FW: R Process Killed out of logical swap space: Case id
	#259-4945 (PR#7732)
In-Reply-To: <20050317170824.30989C400@slim.kubism.ku.dk>
References: <20050317170824.30989C400@slim.kubism.ku.dk>
Message-ID: <x2acp25edt.fsf@biostat.ku.dk>

DMoore@exchange.hsc.mb.ca writes:

> Dear Professor Ripley,

Ummm, "PR" is for "Problem Report", not "Professor Ripley"....
 
> I am attempting a large scale mixed-model analysis of longitudinal gene
> array data using R. I use a 64-bit SGI with 7GB available RAM and 40G
> logical swap space together with unlimited virual swap space. The OS is IRIX
> 6.5.24. I use R version 1.9.0 since I have had problems upgrading to R 2.0.1
> at 64-bit using native SGI compiler build.
> 
> I write a serial   for (i in 1:length(y)) { }
> containing the call to lme as follows 
> 
> f1<-lme( expr ~ time + age + sex,random = ~ time | id,
> correlation=cs3,data=gg.data.frame,method="ML",weights=varIdent(form= ~id))
> 
> After ~ 200 - 300 loops the process is killed by the OS with the following
> errors
> 
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
> space during stack growth - see swap(1M) [filter /usr/sbin/klogpp failed:
> killed by signal 9]
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
> space during stack growth - see swap(1M)
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
> space during stack growth - see swap(1M)
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: R.bin [1157] - out of logical swap
> space during stack growth - see swap(1M)
> Mar 17 08:55:56 1A:helmholtz unix: |$(0x6dc)ALERT: Process [R.bin] pid 1157
> killed: not enough memory to grow stack
> Mar 17 08:55:56 1A:helmholtz unix: |$(0x6dc)ALERT: Process [R.bin] pid 1157
> killed: not enough memory to grow stack
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd[1642] was killed; Dynamic
> Loader cannot get enough memory to map exe
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd[1642] was killed; Dynamic
> Loader cannot get enough memory to map exe
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd [1642] - out of logical
> swap space during exec - see swap(1M)
> Mar 17 08:55:56 1A:helmholtz unix: ALERT: syslogd [1642] - out of logical
> swap space during exec - see swap(1M)
> 
> I have observed the crash while examining the system memory and stack
> allocations - these do not appear to be growing during execution of the
> process loops. I have checked with SGI and the view is that this is likely
> related to R. While there are several work-arounds it would be ideal to
> 'batch' this job and further it is unclear to me what is happening. I am
> grateful for your attention and potential insights.

Hmm, I agree that this could well be a bug in R or the nlme package.
Sounds like a single huge memory allocation is attempted, which could
fairly easily happen as the result of a random memory overwrite.

However, it is not attractive to try and find bugs in old versions of
R (several bugs of this general variety have been fixed since 1.9.1),
and it is near impossible to find such bugs without a way of
reproducing the conditions. I.e. you are the one with the motivation
and probably also the only person with the means to pinpoint the bug. 

Can you run your code under a debugger?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From wb at arb-phys.uni-dortmund.de  Fri Mar 18 14:10:36 2005
From: wb at arb-phys.uni-dortmund.de (wb@arb-phys.uni-dortmund.de)
Date: Fri Mar 18 14:10:47 2005
Subject: [Rd] multiple Labels in .png plots (PR#7733)
Message-ID: <20050318131036.20F1DC01E@slim.kubism.ku.dk>

In R-2.0.1 on FreeBSD-5.3, I tried to make multiple plots in PNG format,
using the default plot()-function
with different labels on the y axis. Labels on the 2nd and later pages
overwrite the first instead of replacing it. This is probably the
case for other sorts of lables in PNG also. In Postscript, however,
the working is as expected.

W.B.Kloke

From scott.chasalow at bms.com  Fri Mar 18 18:21:30 2005
From: scott.chasalow at bms.com (scott.chasalow@bms.com)
Date: Fri Mar 18 18:21:38 2005
Subject: [Rd] 2 possible bugs in function validObject (PR#7735)
Message-ID: <20050318172130.567DBC6F9@slim.kubism.ku.dk>

Hi,

> R.version.string
[1] "R version 2.0.1, 2004-11-15"

I have found two possible bugs in function validObject.  Details below.

Cheers,
Scott

==================================
Scott D. Chasalow
Principal Statistician
Statistical Genetics and Biomarkers
Bristol-Myers Squibb Company
Email: scott.chasalow <AT> bms.com
==================================

------ BEGIN R commands and output ------
setClass("track",
      representation(x = "numeric", y = "numeric"))

validTrackObject <- function(x){
      if(length(x@x) == length(x@y)) TRUE
      else paste("Oooo that's bad", LETTERS[1:4])
}

## assign the function as the validity method for the class
setValidity("track", validTrackObject)

## Now define class "field", to include a "track" slot:
setClass("field",
      representation(t = "track", z = "character"))
setValidity("field", function(object) if (length(object@z) > 0)
      TRUE else "z is way short.")

## A good track: OK
t1 <- new("track", x = 1:10, y = sort(rnorm(10)))

## A good field: OK
f1 <- new("field", t = t1, z = letters[1:10])

## A bad field: OK
f1 <- new("field", t = t1)
Error in validObject(.Object) : Invalid "field" object: z is way short.

## Make t1 a bad track:  minor problem with error msg formatting?
t1@x <- 1:20
validObject(t1)
Error in validObject(t1) : Invalid "track" object: 1: Oooo that's bad A
Invalid "track" object: 2: Oooo that's bad B
Invalid "track" object: 3: Oooo that's bad C
Invalid "track" object: 4: Oooo that's bad D

## A bad field, because it contains a bad track (an invalid track
## object): fools validObject.  I expected that I would fail to create
## f1 here, or at least that validObject(f1) would report the problem
## with t1 in slot t.
f1 <- new("field", t = t1, z = letters[1:10])
validObject(f1)
[1] TRUE

validObject(f1@t)
Error in validObject(f1@t) : Invalid "track" object: 1: Oooo that's bad A
Invalid "track" object: 2: Oooo that's bad B
Invalid "track" object: 3: Oooo that's bad C
Invalid "track" object: 4: Oooo that's bad D


## A bad field, because I try to put a non-track in the track slot: OK
f1 <- new("field", t = 1:3, z = letters[1:10])
Error in validObject(.Object) : Invalid "field" object: Invalid object
for slot "t" in class "field": got class "integer", should be or extend
class "track"
------  END R commands and output ------


So, we see that validity of slot t is not tested, in the sense of
calling validObject on the slot.  The documentation for validObject
suggests (to me at least) that validObject should be called on the
slot.  Instead, validObject seems to test only that the slot has the
right class.  I'm not sure precisely what the author intended
validObject to do, but this seems to me either a bug in the code, or
else somewhat misleading documentation.

Concerning the error msg formatting, I suspect it possibly is not as
the author intended?  The code in validObject to create this error msg
is:

stop(paste("Invalid \"", Class, "\" object: ",
paste(paste(1:length(errors),
      errors, sep = ": ")), sep = "", collapse = "\n"))

As far as I can see, the second call to paste does nothing here.
Perhaps this is what was intended?:

stop(paste("Invalid \"", Class, "\" object: ",
paste(paste(1:length(errors),
      errors, sep = ": "), collapse = "\n"), sep = ""))

This would give:

Error in validObj(t1) : Invalid "track" object: 1: Oooo that's bad A
2: Oooo that's bad B
3: Oooo that's bad C
4: Oooo that's bad D

Personally, I like this even better:

stop(paste("Invalid \"", Class, "\" object:\n",
paste(paste(1:length(errors),
      errors, sep = ": "), collapse = "\n"), sep = ""))

Error in validObj(t1) : Invalid "track" object:
1: Oooo that's bad A
2: Oooo that's bad B
3: Oooo that's bad C
4: Oooo that's bad D

From sfalcon at fhcrc.org  Fri Mar 18 18:49:28 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Fri Mar 18 18:49:38 2005
Subject: [Rd] Trouble debugging with gdb, R on Windows
Message-ID: <m2u0n8rgif.fsf@macaroni.local>

I'm trying to follow the example in the R for Windows FAQ on running
gdb and am getting stuck because gdb tells me "Cannot access memory at
address ...".

Here's what my gdb session looks like (This one from a cygwin shell,
but same results from plain Windows CMD shell):

$ cd R-devel/src/gnuwin32
$ gdb ../../bin/Rgui.exe
GNU gdb 5.2.1
Copyright 2002 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-mingw32"...
(gdb) break WinMain
Breakpoint 1 at 0x401296: file ../graphapp/graphappmain.c, line 59.
(gdb) run
Starting program: y:\falcon\src\R-devel\src\gnuwin32/../../bin/Rgui.exe

Breakpoint 1, WinMain (Instance=0x400000, PrevInstance=0x0,
    CmdLine=0x261f26 "", CmdShow=10) at ../graphapp/graphappmain.c:59
59              startgraphapp(Instance, PrevInstance, CmdShow);
(gdb) break R_ReadConsole
Cannot access memory at address 0x23e17
(gdb) info symbol 0x23e17
R_ReadConsole in section .text
(gdb)

Any suggestions?  Attempting to set other break points (do_BLAH) gives
the same result.

I compiled with 'make DEBUG=T' per the instructions on Duncan
Murdoch's Building R for Windows page.  I also tried compiling after
modifying the makefiles to remove -02 optimization (see patch below
for what I did).  

Thanks,

+ seth







Index: src/extra/intl/Makefile.win
===================================================================
--- src/extra/intl/Makefile.win (revision 33477)
+++ src/extra/intl/Makefile.win (working copy)
@@ -18,6 +18,10 @@
 endif
 
 CFLAGS = -O2 $(DEFS) -I. -I../../include
+ifdef DEBUG 
+  CFLAGS = $(DEFS) -I. -I../../include
+endif
+
 dcigettext-CFLAGS=-DLOCALEDIR=\"\"
 
 SOURCES = \
Index: src/gnuwin32/Makefile
===================================================================
--- src/gnuwin32/Makefile       (revision 33477)
+++ src/gnuwin32/Makefile       (working copy)
@@ -33,8 +33,8 @@
 ## use FOPTFLAGS where complex*16 is used.
 FOPTFLAGS=-O2 -Wall
 ifdef DEBUG
- OPTFLAGS+=-g
- FOPTFLAGS+=-g
+ OPTFLAGS=-g -Wall -pedantic
+ FOPTFLAGS=-g -Wall
  DLLFLAGS=
 else
  DLLFLAGS=-s

From jmacdon at med.umich.edu  Fri Mar 18 19:28:18 2005
From: jmacdon at med.umich.edu (James MacDonald)
Date: Fri Mar 18 19:28:53 2005
Subject: [Rd] package.skeleton
Message-ID: <s23ad78c.060@med-gwia-02a.med.umich.edu>

> R.version.string
[1] "R version 2.1.0, 2005-03-17"

I don't see anything in either https://svn.r-project.org/R/trunk/NEWS
or in the Changes file for R-2.1.0 about changes in package.skeleton()
(nor in the help page), but when I run this function, all the .Rd files
produced are of the data format even if all I have in my .GlobalEnv are
functions.

A trivial example is to run the examples from the package.skeleton()
help page. I believe there should be two data type and two function type
.Rd files, but instead they are all of the data type.

Best,

Jim




James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109
734-647-5623


**********************************************************
Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues.

From roebuck at odin.mdacc.tmc.edu  Fri Mar 18 20:01:40 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Fri Mar 18 20:01:49 2005
Subject: [Rd] Trouble debugging with gdb, R on Windows
In-Reply-To: <m2u0n8rgif.fsf@macaroni.local>
References: <m2u0n8rgif.fsf@macaroni.local>
Message-ID: <Pine.OSF.4.58.0503181244410.51844@odin.mdacc.tmc.edu>

On Fri, 18 Mar 2005, Seth Falcon wrote:

> I'm trying to follow the example in the R for Windows FAQ on running
> gdb and am getting stuck because gdb tells me "Cannot access memory at
> address ...".
>
> Here's what my gdb session looks like (This one from a cygwin shell,
> but same results from plain Windows CMD shell):
>
> $ cd R-devel/src/gnuwin32
> $ gdb ../../bin/Rgui.exe
> GNU gdb 5.2.1
> Copyright 2002 Free Software Foundation, Inc.
> GDB is free software, covered by the GNU General Public License, and you are
> welcome to change it and/or distribute copies of it under certain conditions.
> Type "show copying" to see the conditions.
> There is absolutely no warranty for GDB.  Type "show warranty" for details.
> This GDB was configured as "i686-pc-mingw32"...
> (gdb) break WinMain
> Breakpoint 1 at 0x401296: file ../graphapp/graphappmain.c, line 59.
> (gdb) run
> Starting program: y:\falcon\src\R-devel\src\gnuwin32/../../bin/Rgui.exe
>
> Breakpoint 1, WinMain (Instance=0x400000, PrevInstance=0x0,
>     CmdLine=0x261f26 "", CmdShow=10) at ../graphapp/graphappmain.c:59
> 59              startgraphapp(Instance, PrevInstance, CmdShow);
> (gdb) break R_ReadConsole
> Cannot access memory at address 0x23e17
> (gdb) info symbol 0x23e17
> R_ReadConsole in section .text
> (gdb)
>
> Any suggestions?  Attempting to set other break points (do_BLAH) gives
> the same result.

Not a Windows developer so this may be off but did you try
loading the shared library prior to setting your breakpoint?

(gdb) break WinMain
(gdb) run
(gdb) info share

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From sfalcon at fhcrc.org  Fri Mar 18 20:26:50 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Fri Mar 18 20:27:07 2005
Subject: [Rd] Trouble debugging with gdb, R on Windows
In-Reply-To: <Pine.OSF.4.58.0503181244410.51844@odin.mdacc.tmc.edu> (Paul
	Roebuck's message of "Fri, 18 Mar 2005 13:01:40 -0600 (CST)")
References: <m2u0n8rgif.fsf@macaroni.local>
	<Pine.OSF.4.58.0503181244410.51844@odin.mdacc.tmc.edu>
Message-ID: <m2hdj8rc05.fsf@macaroni.local>

Paul Roebuck <roebuck@odin.mdacc.tmc.edu> writes:
> Not a Windows developer so this may be off but did you try
> loading the shared library prior to setting your breakpoint?
>
> (gdb) break WinMain
> (gdb) run
> (gdb) info share

Yes, in the transcript of gdb included in my post I did the first two
lines of the above.  Just tried the 'info share' and I see R.dll is
loaded, but I still get the same error when trying to set another
breakpoint.

Thanks,

+ seth

From murdoch at stats.uwo.ca  Fri Mar 18 20:59:56 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Mar 18 21:02:11 2005
Subject: [Rd] Trouble debugging with gdb, R on Windows
In-Reply-To: <m2u0n8rgif.fsf@macaroni.local>
References: <m2u0n8rgif.fsf@macaroni.local>
Message-ID: <9pcm31l20eaqigs8auut1r3utjq342078r@4ax.com>

On Fri, 18 Mar 2005 09:49:28 -0800, Seth Falcon <sfalcon@fhcrc.org>
wrote :

>I'm trying to follow the example in the R for Windows FAQ on running
>gdb and am getting stuck because gdb tells me "Cannot access memory at
>address ...".
>
>Here's what my gdb session looks like (This one from a cygwin shell,
>but same results from plain Windows CMD shell):
>
>$ cd R-devel/src/gnuwin32
>$ gdb ../../bin/Rgui.exe
>GNU gdb 5.2.1
>Copyright 2002 Free Software Foundation, Inc.
>GDB is free software, covered by the GNU General Public License, and you are
>welcome to change it and/or distribute copies of it under certain conditions.
>Type "show copying" to see the conditions.
>There is absolutely no warranty for GDB.  Type "show warranty" for details.
>This GDB was configured as "i686-pc-mingw32"...

I'm using the same version as you, but I don't see what you're seeing.
You got

>(gdb) break WinMain
>Breakpoint 1 at 0x401296: file ../graphapp/graphappmain.c, line 59.
>(gdb) run
>Starting program: y:\falcon\src\R-devel\src\gnuwin32/../../bin/Rgui.exe
>
>Breakpoint 1, WinMain (Instance=0x400000, PrevInstance=0x0,
>    CmdLine=0x261f26 "", CmdShow=10) at ../graphapp/graphappmain.c:59
>59              startgraphapp(Instance, PrevInstance, CmdShow);
>(gdb) break R_ReadConsole
>Cannot access memory at address 0x23e17
>(gdb) info symbol 0x23e17
>R_ReadConsole in section .text

and I get

(gdb) b WinMain
Breakpoint 1 at 0x401296: file ../graphapp/graphappmain.c, line 59.
(gdb) run
Starting program: f:\R\svn\r-devel\R\src\gnuwin32/../../bin/Rgui.exe

Breakpoint 1, WinMain (Instance=0x400000, PrevInstance=0x0,
    CmdLine=0x251f13 "", CmdShow=10) at ../graphapp/graphappmain.c:59
59              startgraphapp(Instance, PrevInstance, CmdShow);
(gdb) break R_ReadConsole
Breakpoint 2 at 0x1001d5e6
(gdb) info symbol 0x1001d5e6
R_ReadConsole + 6 in section .text

The only thing I can see is that your address for R_ReadConsole looks
suspiciously low:  normally code gets loaded at addresses above
0x400000.  I have no idea what would cause this, and am not even sure
it's not perfectly reasonable.

A workaround that might help would be to use the R menu item
"Misc|Break to debugger" to break out of R once it is running, and set
your breakpoints then, but I don't know that it will make any
difference.

Duncan Murdoch

From mailerndr at trademe.co.nz  Sat Mar 19 03:16:45 2005
From: mailerndr at trademe.co.nz (mailerndr@trademe.co.nz)
Date: Sat Mar 19 03:16:58 2005
Subject: [Rd] RE: Hi
Message-ID: <660493DE6B7C964485846DF4EA7C29D6977D5C@tmmail.TradeMe.local>

*****************************************
***** THIS IS AN AUTOMATED RESPONSE *****
*****   FROM MAILER@TRADEME.CO.NZ   *****
*****************************************
You have been sent this email because you responded to a Trade Me 
automated email.
 
We send out a number of emails automatically including:
* To the top bidder and seller at the conclusion of an auction
* To bidders when they are outbid
* To the seller when a question is placed on their auction
 

TO CONTACT THE SELLER OR TOP BIDDER
***********************************
If you are wanting to contact the seller or the top bidder in an 
auction, their email address is contained within the email we send 
you at the conclusion of the auction. Full details of all of your 
auctions can be found under the My Trade Me tab on Trade Me.
 
My Trade Me: http://www.trademe.co.nz/structure/my_trademe.asp
 

TO ANSWER A QUESTION ON YOUR AUCTION
************************************
To answer questions posted on your auction, visit Trade Me, login 
and go to the auction the question was asked on. The link to do this 
was contained in the email we sent when the question was asked. 
Your answer will be immediately posted on the auction and forwarded 
to the trader who asked the question.
 

TO CONTACT TRADE ME
*******************
If you were wanting to contact Trade Me Support, please visit the 
site at  http://www.trademe.co.nz/structure/helpdocs/contact_us.asp

	[[alternative HTML version deleted]]

From ligges at statistik.uni-dortmund.de  Sat Mar 19 19:27:17 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Mar 19 19:27:29 2005
Subject: [Rd] package.skeleton
In-Reply-To: <s23ad78c.060@med-gwia-02a.med.umich.edu>
References: <s23ad78c.060@med-gwia-02a.med.umich.edu>
Message-ID: <423C6F05.3010105@statistik.uni-dortmund.de>

James MacDonald wrote:

>>R.version.string
> 
> [1] "R version 2.1.0, 2005-03-17"
> 
> I don't see anything in either https://svn.r-project.org/R/trunk/NEWS
> or in the Changes file for R-2.1.0 about changes in package.skeleton()
> (nor in the help page), but when I run this function, all the .Rd files
> produced are of the data format even if all I have in my .GlobalEnv are
> functions.
> 
> A trivial example is to run the examples from the package.skeleton()
> help page. I believe there should be two data type and two function type
> .Rd files, but instead they are all of the data type.



Yes, I think package.skeleton() needs the follwing simple fix (since we 
do not get() each object in prompt() any more - alternatively, reverting 
some changes in prompt() fixes it as well):


@@ -140,7 +140,7 @@
      sink(outConn, type = "output")
      yy <- try(sapply(list,
                       function(item) {
-                         prompt(item,
+                         prompt(name = item,
                                  filename = file.path(path, name, "man",
                                  paste(list0[item], "Rd", sep=".")))
                       }))



Uwe Ligges




> Best,
> 
> Jim
> 
> 
> 
> 
> James W. MacDonald
> Affymetrix and cDNA Microarray Core
> University of Michigan Cancer Center
> 1500 E. Medical Center Drive
> 7410 CCGC
> Ann Arbor MI 48109
> 734-647-5623
> 
> 
> **********************************************************
> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From maechler at stat.math.ethz.ch  Sat Mar 19 19:53:57 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat Mar 19 19:54:05 2005
Subject: [Rd] package.skeleton
In-Reply-To: <s23ad78c.060@med-gwia-02a.med.umich.edu>
References: <s23ad78c.060@med-gwia-02a.med.umich.edu>
Message-ID: <16956.30021.203368.554425@stat.math.ethz.ch>

Thanks a lot, Jim,

yes, I can confirm the behavior;
clearly a bug in R-devel (only!)

Martin Maechler

>>>>> "JimMcD" == James MacDonald <jmacdon@med.umich.edu>
>>>>>     on Fri, 18 Mar 2005 13:28:18 -0500 writes:

    >> R.version.string
    JimMcD> [1] "R version 2.1.0, 2005-03-17"

    JimMcD> I don't see anything in either
    JimMcD> https://svn.r-project.org/R/trunk/NEWS or in the
    JimMcD> Changes file for R-2.1.0 about changes in
    JimMcD> package.skeleton() (nor in the help page), but when
    JimMcD> I run this function, all the .Rd files produced are
    JimMcD> of the data format even if all I have in my
    JimMcD> .GlobalEnv are functions.

    JimMcD> A trivial example is to run the examples from the
    JimMcD> package.skeleton() help page. I believe there should
    JimMcD> be two data type and two function type .Rd files,
    JimMcD> but instead they are all of the data type.

    JimMcD> Best,

    JimMcD> Jim

From stefano.iacus at unimi.it  Sun Mar 20 16:08:33 2005
From: stefano.iacus at unimi.it (stefano iacus)
Date: Sun Mar 20 16:08:51 2005
Subject: [Rd] Re: [R-SIG-Mac] NaN and linear algebra
In-Reply-To: <05b117504a886b06c399b67f965479cf@warwick.ac.uk>
References: <ad7bc81d30cdbed3e7f4b210318adf93@warwick.ac.uk>
	<p06210211be5e36bd7c33@[128.115.153.6]>
	<05b117504a886b06c399b67f965479cf@warwick.ac.uk>
Message-ID: <5fdd4a0b66dba89a53eecb50fd4205c4@unimi.it>

No, blas/veclib is tested, so aprt this extreme case you should report 
some other more commonly used cases in which something fails on OS X.  
This will help us to work it out.
As said, I'll try some tests without using veclib and let you know.

I've fowarded this mail to r-devel, which seems to be the right place, 
so for future msg on the subject please use r-devel.
stefano
On 19/mar/05, at 17:44, David Firth wrote:

> Dear Don, Bill and Stefano
>
> Many thanks for your helpful replies on this.  I do think this is 
> pretty serious: the example I gave is an extreme one, but in real 
> problems (e.g., calls to optim()) this sort of thing can and does 
> result in different behaviour on the Mac than on other systems.  And 
> that has to be a Bad Thing.
>
> I'm unsure whether it is better to press Apple to improve vecLib, or 
> to test R with an alternative BLAS (and if successful, recommend using 
> that BLAS in place of vecLib).  Or both.  Unfortunately I don't know 
> enough about these routines and the relevant standards to pursue 
> either route myself.
>
> Best regards,
> David
>
>>
>>
>> At 11:57 AM +0000 3/16/05, David Firth wrote:
>>> I don't know whether this is a bug, or a problem with the way I 
>>> built R 2.0.1 (under Mac OS 10.3 on a G5), or something else.  Can 
>>> anyone else confirm (or otherwise) that this happens in their R 
>>> 2.0.1 on Mac OS X?
>>>
>>>  >  d<-matrix(NaN,3,3)
>>>>   d
>>>     [,1] [,2] [,3]
>>> [1,]  NaN  NaN  NaN
>>> [2,]  NaN  NaN  NaN
>>> [3,]  NaN  NaN  NaN
>>>>   solve(d)
>>> Error in solve.default(d) : Lapack routine dgesv: system is exactly 
>>> singular
>>>>   chol(d)
>>> Error in chol(d) : the leading minor of order 1 is not positive 
>>> definite
>>>>   det(d)
>>> [1] 0
>>>
>>> Doing the same thing on a Windows setup gave a different (and more 
>>> useful, I think) result
>>>
>>>>  d<-matrix(NaN,3,3)
>>>>  d
>>>     [,1] [,2] [,3]
>>> [1,]  NaN  NaN  NaN
>>> [2,]  NaN  NaN  NaN
>>> [3,]  NaN  NaN  NaN
>>>>  solve(d)
>>>     [,1] [,2] [,3]
>>> [1,]  NaN  NaN  NaN
>>> [2,]  NaN  NaN  NaN
>>> [3,]  NaN  NaN  NaN
>>>>  chol(d)
>>>     [,1] [,2] [,3]
>>> [1,]  NaN  NaN  NaN
>>> [2,]    0  NaN  NaN
>>> [3,]    0    0  NaN
>>>>  det(d)
>>> [1] NaN
>>>
>>> Any thoughts?
>>> David
>>>
>>> Professor David Firth
>>> Dept of Statistics
>>> University of Warwick
>>> Coventry CV4 7AL
>>> United Kingdom
>>>
>>> Voice: +44 (0)247 657 2581
>>> Fax:   +44 (0)247 652 4532
>>> Web:   http://www.warwick.ac.uk/go/dfirth
>>>
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac@stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>>
>> -- 
>> --------------------------------------
>> Don MacQueen
>> Environmental Protection Department
>> Lawrence Livermore National Laboratory
>> Livermore, CA, USA
>> --------------------------------------
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac@stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>

From pgilbert at bank-banque-canada.ca  Sun Mar 20 16:37:29 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Sun Mar 20 16:38:59 2005
Subject: [Rd] loadings generic?
Message-ID: <423D98B9.7050005@bank-banque-canada.ca>

Can loadings in stats can be made generic?

Paul Gilbert

From pgilbert at bank-banque-canada.ca  Sun Mar 20 16:40:34 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Sun Mar 20 16:42:02 2005
Subject: [Rd] --with-readline=yes
Message-ID: <423D9972.1030509@bank-banque-canada.ca>

I think --with-readline=yes is a new default, but it does not seem to be 
mentioned in the installation changes of NEWS. (I could easily be 
mistaken on this.)

Paul Gilbert

From pgilbert at bank-banque-canada.ca  Sun Mar 20 17:52:11 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Sun Mar 20 17:53:41 2005
Subject: [Rd] edit(vignette(...))
Message-ID: <423DAA3B.8090803@bank-banque-canada.ca>

I have been looking at edit(vignette(...)) in r-devel, which I think 
will be really useful for people working through vignettes. Is there a 
way to fork the editor so that the R prompt is returned? The call seems 
to be passed though to edit.file, but I don't see any simple way to get 
the prompt back until the editor is closed.  (I seem to recall there was 
a problem with the prompt returning too soon from bug.report some time ago.)

I also noticed that many (most?) packages have a vignette with the same 
name as the package. Is this considered the standard now?

Paul Gilbert

From sfalcon at fhcrc.org  Mon Mar 21 03:34:13 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Mon Mar 21 03:34:24 2005
Subject: [Rd] Buglet in install.packages warning message
Message-ID: <m23bupiv6i.fsf@macaroni.local>

I've been experimenting with install.packages and it's new ability to
track down dependencies from a list of repositories and encountered
this:

install.packages(c("foo", "bar"), repos="http://cran.r-project.org", 
                 dependencies=c("Depends", "Suggests"))

dependencies 'foo' are not availabledependencies 'bar' are not available
                           ^^^^^^^^^^^^^^^^^^^^

With the following change (see below) I get what I suspect is the
intended warning message:

   dependencies 'foo', 'bar' are not available


+ seth


Index: packages2.R
===================================================================
--- packages2.R	(revision 33678)
+++ packages2.R	(working copy)
@@ -125,7 +125,7 @@
                 cat(sprintf(ngettext(sum(miss),
                                      "dependency %s is not available",
                                      "dependencies %s are not available"),
-                    paste(sQuote(p1[miss]), sep=", ")), "\n\n", sep ="")
+                    paste(sQuote(p1[miss]), collapse=", ")), "\n\n", sep ="")
                 flush.console()
             }
             p1 <- p1[!miss]

From maechler at stat.math.ethz.ch  Mon Mar 21 09:24:06 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Mar 21 09:24:14 2005
Subject: [Rd] Buglet in install.packages warning message
In-Reply-To: <m23bupiv6i.fsf@macaroni.local>
References: <m23bupiv6i.fsf@macaroni.local>
Message-ID: <16958.33958.342956.698811@stat.math.ethz.ch>

>>>>> "Seth" == Seth Falcon <sfalcon@fhcrc.org>
>>>>>     on Sun, 20 Mar 2005 18:34:13 -0800 writes:

    Seth> I've been experimenting with install.packages and it's
    Seth> new ability to track down dependencies from a list of
    Seth> repositories and encountered this:

    Seth> install.packages(c("foo", "bar"),
    Seth> repos="http://cran.r-project.org",
    Seth> dependencies=c("Depends", "Suggests"))

    Seth> dependencies 'foo' are not availabledependencies 'bar'
    Seth> are not available ^^^^^^^^^^^^^^^^^^^^

    Seth> With the following change (see below) I get what I
    Seth> suspect is the intended warning message:

    Seth>    dependencies 'foo', 'bar' are not available

Indeed.
Thank you Seth! - I've committed your change 
to be in '` R-alpha of 2005-03-22 ''

Apropos: Please, all users of R-2.1.0 (alpha)  {aka "R-devel"}:
	  ``keep your eyes open'' for not quite correctly
	  formatted error messages, or even other problems in
	  error and warning messages.

The large amount of work that was put in (mostly by Prof Brian
Ripley) rationalizing these messages in order to make them
more consistent (for translation, e.g.!) may have lead to a few
typos that are unavoidable when changing those thousand of
lines of code efficiently.

Martin

From d.firth at warwick.ac.uk  Mon Mar 21 10:25:58 2005
From: d.firth at warwick.ac.uk (David Firth)
Date: Mon Mar 21 10:26:08 2005
Subject: [Rd] Re: [R-SIG-Mac] NaN and linear algebra
In-Reply-To: <5fdd4a0b66dba89a53eecb50fd4205c4@unimi.it>
References: <ad7bc81d30cdbed3e7f4b210318adf93@warwick.ac.uk>
	<p06210211be5e36bd7c33@[128.115.153.6]>
	<05b117504a886b06c399b67f965479cf@warwick.ac.uk>
	<5fdd4a0b66dba89a53eecb50fd4205c4@unimi.it>
Message-ID: <c6f32aae84bcbcc9d3b4f4a437c7620d@warwick.ac.uk>

I am sorry that I wasn't clear.  All that I meant was that *this* 
problem can result in different behaviour in "ordinary" statistical 
applications.  For example, if the objective function in a call to 
optim() involves calling one of these linear algebra routines, the 
result may be NaN (on systems other than Mac OS X) --- which optim will 
typically handle sensibly --- or something else (an error, or perhaps 
some consequence of getting 0 for the determinant) under Mac OS X .

Probably this was obvious to you.  Apologies if I misled you into 
thinking that there was some other problem I knew about.

Best regards,
David

On 20 Mar, 2005, at 15:08, stefano iacus wrote:

> No, blas/veclib is tested, so aprt this extreme case you should report 
> some other more commonly used cases in which something fails on OS X.  
> This will help us to work it out.
> As said, I'll try some tests without using veclib and let you know.
>
> I've fowarded this mail to r-devel, which seems to be the right place, 
> so for future msg on the subject please use r-devel.
> stefano
> On 19/mar/05, at 17:44, David Firth wrote:
>
>> Dear Don, Bill and Stefano
>>
>> Many thanks for your helpful replies on this.  I do think this is 
>> pretty serious: the example I gave is an extreme one, but in real 
>> problems (e.g., calls to optim()) this sort of thing can and does 
>> result in different behaviour on the Mac than on other systems.  And 
>> that has to be a Bad Thing.
>>
>> I'm unsure whether it is better to press Apple to improve vecLib, or 
>> to test R with an alternative BLAS (and if successful, recommend 
>> using that BLAS in place of vecLib).  Or both.  Unfortunately I don't 
>> know enough about these routines and the relevant standards to pursue 
>> either route myself.
>>
>> Best regards,
>> David
>>
>>>
>>>
>>> At 11:57 AM +0000 3/16/05, David Firth wrote:
>>>> I don't know whether this is a bug, or a problem with the way I 
>>>> built R 2.0.1 (under Mac OS 10.3 on a G5), or something else.  Can 
>>>> anyone else confirm (or otherwise) that this happens in their R 
>>>> 2.0.1 on Mac OS X?
>>>>
>>>>  >  d<-matrix(NaN,3,3)
>>>>>   d
>>>>     [,1] [,2] [,3]
>>>> [1,]  NaN  NaN  NaN
>>>> [2,]  NaN  NaN  NaN
>>>> [3,]  NaN  NaN  NaN
>>>>>   solve(d)
>>>> Error in solve.default(d) : Lapack routine dgesv: system is exactly 
>>>> singular
>>>>>   chol(d)
>>>> Error in chol(d) : the leading minor of order 1 is not positive 
>>>> definite
>>>>>   det(d)
>>>> [1] 0
>>>>
>>>> Doing the same thing on a Windows setup gave a different (and more 
>>>> useful, I think) result
>>>>
>>>>>  d<-matrix(NaN,3,3)
>>>>>  d
>>>>     [,1] [,2] [,3]
>>>> [1,]  NaN  NaN  NaN
>>>> [2,]  NaN  NaN  NaN
>>>> [3,]  NaN  NaN  NaN
>>>>>  solve(d)
>>>>     [,1] [,2] [,3]
>>>> [1,]  NaN  NaN  NaN
>>>> [2,]  NaN  NaN  NaN
>>>> [3,]  NaN  NaN  NaN
>>>>>  chol(d)
>>>>     [,1] [,2] [,3]
>>>> [1,]  NaN  NaN  NaN
>>>> [2,]    0  NaN  NaN
>>>> [3,]    0    0  NaN
>>>>>  det(d)
>>>> [1] NaN
>>>>
>>>> Any thoughts?
>>>> David
>>>>
>>>> Professor David Firth
>>>> Dept of Statistics
>>>> University of Warwick
>>>> Coventry CV4 7AL
>>>> United Kingdom
>>>>
>>>> Voice: +44 (0)247 657 2581
>>>> Fax:   +44 (0)247 652 4532
>>>> Web:   http://www.warwick.ac.uk/go/dfirth
>>>>
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac@stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>
>>>
>>> -- 
>>> --------------------------------------
>>> Don MacQueen
>>> Environmental Protection Department
>>> Lawrence Livermore National Laboratory
>>> Livermore, CA, USA
>>> --------------------------------------
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac@stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>

From dimitris.rizopoulos at med.kuleuven.ac.be  Mon Mar 21 10:39:02 2005
From: dimitris.rizopoulos at med.kuleuven.ac.be (Dimitris Rizopoulos)
Date: Mon Mar 21 10:37:38 2005
Subject: [Rd] initial Hessian in optim's BFGS
Message-ID: <00a301c52df9$d0c5ae90$0540210a@www.domain>

Dear all,

I'd like to ask if it would be a good idea to add an extra argument to 
'optim' (with default value NULL) to give a initial Hessian for the 
BFGS algorithm. This could be handy in some cases where this initial 
approximation is available and thus it isn't required 'optim' to 
compute it again.

Thanks for any comments,
Dimitris

----
Dimitris Rizopoulos
Ph.D. Student
Biostatistical Centre
School of Public Health
Catholic University of Leuven

Address: Kapucijnenvoer 35, Leuven, Belgium
Tel: +32/16/336899
Fax: +32/16/337015
Web: http://www.med.kuleuven.ac.be/biostat/
     http://www.student.kuleuven.ac.be/~m0390867/dimitris.htm

From Jonathan.Swinton at astrazeneca.com  Mon Mar 21 15:02:05 2005
From: Jonathan.Swinton at astrazeneca.com (Jonathan.Swinton@astrazeneca.com)
Date: Mon Mar 21 15:02:16 2005
Subject: [Rd] PR#6904
Message-ID: <20050321140205.AC34AB250@slim.kubism.ku.dk>


Problem #6904 seems to have been fixed (thanks) between 1.9.0 and 2.0.1 and
can be moved from Add-ons to Add-ons-fixed.

Jonathan Swinton

From maechler at stat.math.ethz.ch  Mon Mar 21 18:49:00 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Mar 21 18:49:09 2005
Subject: [Rd] loadings generic?
In-Reply-To: <423D98B9.7050005@bank-banque-canada.ca>
References: <423D98B9.7050005@bank-banque-canada.ca>
Message-ID: <16959.2316.560057.121298@stat.math.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca>
>>>>>     on Sun, 20 Mar 2005 10:37:29 -0500 writes:

    PaulG> Can loadings in stats be made generic?

It becomes a (S4) generic automagically when you define an S4 method
for it.  ;-)

{yes, I know this isn't the answer you wanted to hear;
 but really, maybe it's worth considering to use S4 classes and
 methods ?}

For S3, it's a bit uglier, but I think you could still do -- in your
package --

if(!exists("loadings.default", mode="function")) {
  loadings.default <- loadings
  loadings <- function(x, ...) UseMethod("loadings")
}

loadings.<myclass> <- function(x, ...) {
   ......... 
}

and S3-export these.

Martin

From pgilbert at bank-banque-canada.ca  Mon Mar 21 18:59:30 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Mon Mar 21 19:01:36 2005
Subject: [Rd] loadings generic?
In-Reply-To: <16959.2316.560057.121298@stat.math.ethz.ch>
References: <423D98B9.7050005@bank-banque-canada.ca>
	<16959.2316.560057.121298@stat.math.ethz.ch>
Message-ID: <423F0B82.9080802@bank-banque-canada.ca>



Martin Maechler wrote:

>>>>>>"PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca>
>>>>>>    on Sun, 20 Mar 2005 10:37:29 -0500 writes:
>>>>>>            
>>>>>>
>
>    PaulG> Can loadings in stats be made generic?
>
>It becomes a (S4) generic automagically when you define an S4 method
>for it.  ;-)
>
>{yes, I know this isn't the answer you wanted to hear;
> but really, maybe it's worth considering to use S4 classes and
> methods ?}
>  
>
Yes, sometime.

>For S3, it's a bit uglier, but I think you could still do -- in your
>package --
>
>if(!exists("loadings.default", mode="function")) {
>  loadings.default <- loadings
>  loadings <- function(x, ...) UseMethod("loadings")
>}
>
>loadings.<myclass> <- function(x, ...) {
>   ......... 
>}
>
>and S3-export these.
>
I am doing this, but expect others will want to do it too. I think it 
gets a bit messy when multiple packages need to define the same generic. 
At least, it seems to me it would make more sense for the generic to be 
defined in one place that everyone uses.

Paul

>
>Martin
>
>  
>

From laurent.mauron at credit-suisse.com  Mon Mar 21 19:17:56 2005
From: laurent.mauron at credit-suisse.com (Mauron Laurent (KETR 31))
Date: Mon Mar 21 19:18:12 2005
Subject: [Rd] Compiling "R Embedded" examples
Message-ID: <ED765D0AD42FD6408805FA8A766868D103C4E8BF@sxchs009b.itzrh.ska.com>

Hi,

I haven't made any progress regarding compiling the "R embedding" example ( http://tolstoy.newcastle.edu.au/R/devel/05/03/0143.htm ) and I am running out of ideas. 

I would be very grateful if someone could give me some reference or pointers where to look. In other words, how would you attack the problem if you were in the same situation?

Thanks for your help,

Laurent

From duncan at wald.ucdavis.edu  Mon Mar 21 20:01:01 2005
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Mon Mar 21 20:01:14 2005
Subject: [Rd] Compiling "R Embedded" examples
In-Reply-To: <ED765D0AD42FD6408805FA8A766868D103C4E8BF@sxchs009b.itzrh.ska.com>
References: <ED765D0AD42FD6408805FA8A766868D103C4E8BF@sxchs009b.itzrh.ska.com>
Message-ID: <20050321190101.GA17245@wald.ucdavis.edu>

Mauron Laurent (KETR 31) wrote:
> Hi,
> 
> I haven't made any progress regarding compiling the "R embedding" example ( http://tolstoy.newcastle.edu.au/R/devel/05/03/0143.htm ) and I am running out of ideas. 
> 
> I would be very grateful if someone could give me some reference or pointers where to look. In other words, how would you attack the problem if you were in the same situation?


I would install a different version of gcc (e.g. gcc-3.3.3) as that works on
one of the Solaris machines I use.

   SunOS 5.8 Generic_117000-05 sun4u sparc SUNW,Ultra-5_10


On that machine, all works fine.

> 
> Thanks for your help,
> 
> Laurent
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Duncan Temple Lang                duncan@wald.ucdavis.edu
Department of Statistics          work:  (530) 752-4782
371 Kerr Hall                     fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis, CA 95616, USA

From Mark.Bravington at csiro.au  Tue Mar 22 00:09:30 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Tue Mar 22 00:09:42 2005
Subject: [Rd] trouble building r-devel
Message-ID: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>

I haven't been able to build yesterday's R-devel (or, as a test,
R-devel_2005-03-11) on Windows XP. The error message I'm getting is to
do with 'arithmetic.c', as shown below.

Current R-patched seems to build fine, and I've built previous R-devels
from source fairly often in the past-- though I have no understanding
whatsoever of what's going on. FWIW the only changes I made to MkRules
are (i) WINHELP=NO and (ii) TCL_HOME=C:/R/Tcl, which are the same ones I
always make.

Any help appreciated!

Mark

C:\R\R-devel\src\gnuwin32> make
<< some OK bits of output, to help show where the problem is>>
...
making vfonts.d from vfonts.c
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c CConverters.c -o CConverters.o
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c CommandLineArgs.c -o CommandLineArg
s.o
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c Rdynload.c -o Rdynload.o
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c Renviron.c -o Renviron.o
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c RNG.c -o RNG.o
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c apply.c -o apply.o
gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
-DR_DLL_BUILD  -c arithmetic.c -o arithmetic.o
arithmetic.c: In function `do_math1':
arithmetic.c:887: `acosh' undeclared (first use in this function)
arithmetic.c:887: (Each undeclared identifier is reported only once
arithmetic.c:887: for each function it appears in.)
arithmetic.c:888: `asinh' undeclared (first use in this function)
arithmetic.c:889: `atanh' undeclared (first use in this function)
make[4]: *** [arithmetic.o] Error 1
make[3]: *** [rlibs] Error 2
make[2]: *** [../../bin/R.dll] Error 2
make[1]: *** [rbuild] Error 2
make: *** [all] Error 2



Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623

From suzette at sdac.harvard.edu  Tue Mar 22 00:11:50 2005
From: suzette at sdac.harvard.edu (Suzette Blanchard)
Date: Tue Mar 22 00:11:44 2005
Subject: [Rd] Writing R documentation
Message-ID: <Pine.GSO.4.40.0503211746110.8570-100000@sdac.harvard.edu>


Greetings,

I used latex type code in my Rd files.

The pdf version using
R CMD Rd2dvi --output=PKtools.pdf --pdf --title="PKtools" PKtools man
came out quite nice.

However, my current HTML version does not tex the latex so there is
latex code in the files and looks bad.

example problem code:

AIC$_c$

or

\begin{itemize}
\item NLME:
\begin{itemize}
\item population level: identify(MM\$mm\$fitted[,1], MM\$pkdata\$conc)
\item individual level: identify(MM\$mm\$fitted[,2], MM\$pkdata\$conc)
\end{itemize}
\item NONMEM:
\begin{itemize}
\item population level: identify(NM\$pred\$PRED, NM\$pred\$CONC)
\item individual level: identify(NM\$pred\$IPRE, NM\$pred\$CONC)
\end{itemize}
\item WinBUGS:
\begin{itemize}
\item population level: identify(WB\$pred\$ppred, WB\$pred\$conc)
\item individual level: identify(WB\$pred\$ipred, WB\$pred\$conc)
\end{itemize}

Is there a way to fix this?

I tried Rdconv using --type=HTML but that did not work.

Any help you can send would be appreciated.

Thank you,
Suzette

=================================
Suzette Blanchard, Ph.D.
UCSD-PPRU

From arnima at u.washington.edu  Tue Mar 22 01:27:57 2005
From: arnima at u.washington.edu (arnima@u.washington.edu)
Date: Tue Mar 22 01:28:05 2005
Subject: [Rd] pch=NA (PR#7737)
Message-ID: <20050322002757.8E39CBAF4@slim.kubism.ku.dk>

I'd like to suggest changes to three help pages, regarding the use of 
pch=NA to suppress plotting symbols. See below.

Arni

R 2.0.1 on WinXP



===
help(bxp)
===

The argument outpch=" " needs to be replaced with outpch=NA in two places.

I actually wrote this part of the documentation myself at one point, but 
have now realized that pch=NA and pch=" " are not the same:

   x <- split(rlnorm(26e4), letters)
   ## NA generates small file
   postscript("na.ps");    boxplot(x,outpch=NA);  dev.off()
   ## Space generates large file
   postscript("space.ps"); boxplot(x,outpch=" "); dev.off()



===
help(par)
help(points)
===

Please specify that pch=NA can be used to suppress plotting symbols.

I'm aware of type="n", but pch=NA can be a useful feature inside functions 
and should be documented somewhere. Other negative-sounding values 
(-1,0,NULL,""," ") generate different results, and only pch=NA does the 
job properly.

From murdoch at stats.uwo.ca  Tue Mar 22 01:26:39 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar 22 01:28:47 2005
Subject: [Rd] trouble building r-devel
In-Reply-To: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>
Message-ID: <bapu31p5p5balf92s5om8f16f8da8f7oc4@4ax.com>

On Tue, 22 Mar 2005 10:09:30 +1100, <Mark.Bravington@csiro.au> wrote :

>I haven't been able to build yesterday's R-devel (or, as a test,
>R-devel_2005-03-11) on Windows XP. The error message I'm getting is to
>do with 'arithmetic.c', as shown below.
>
>Current R-patched seems to build fine, and I've built previous R-devels
>from source fairly often in the past-- though I have no understanding
>whatsoever of what's going on. FWIW the only changes I made to MkRules
>are (i) WINHELP=NO and (ii) TCL_HOME=C:/R/Tcl, which are the same ones I
>always make.
>
>Any help appreciated!
>
>Mark
>
>C:\R\R-devel\src\gnuwin32> make
><< some OK bits of output, to help show where the problem is>>
>...
>making vfonts.d from vfonts.c
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c CConverters.c -o CConverters.o
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c CommandLineArgs.c -o CommandLineArg
>s.o
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c Rdynload.c -o Rdynload.o
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c Renviron.c -o Renviron.o
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c RNG.c -o RNG.o
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c apply.c -o apply.o
>gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H
>-DR_DLL_BUILD  -c arithmetic.c -o arithmetic.o
>arithmetic.c: In function `do_math1':
>arithmetic.c:887: `acosh' undeclared (first use in this function)
>arithmetic.c:887: (Each undeclared identifier is reported only once
>arithmetic.c:887: for each function it appears in.)
>arithmetic.c:888: `asinh' undeclared (first use in this function)
>arithmetic.c:889: `atanh' undeclared (first use in this function)
>make[4]: *** [arithmetic.o] Error 1
>make[3]: *** [rlibs] Error 2
>make[2]: *** [../../bin/R.dll] Error 2
>make[1]: *** [rbuild] Error 2
>make: *** [all] Error 2

My guess would be that you are using bad headers, or perhaps an out of
date compiler.  I just recompiled today's arithmetic.c with no error,
using

$ gcc --version
gcc.exe (GCC) 3.4.2 (mingw-special)
Copyright (C) 2004 Free Software Foundation, Inc.

Duncan Murdoch

From w.northcott at unsw.edu.au  Tue Mar 22 04:31:31 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Tue Mar 22 04:31:34 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
Message-ID: <098c2dce898207218d3e518868d7ffec@unsw.edu.au>

On 21/03/2005, at 10:09 PM, David Firth wrote:
> I am sorry that I wasn't clear.  All that I meant was that *this*
> problem can result in different behaviour in "ordinary" statistical
> applications.  For example, if the objective function in a call to
> optim() involves calling one of these linear algebra routines, the
> result may be NaN (on systems other than Mac OS X) --- which optim will
> typically handle sensibly --- or something else (an error, or perhaps
> some consequence of getting 0 for the determinant) under Mac OS X .
>
> Probably this was obvious to you.  Apologies if I misled you into
> thinking that there was some other problem I knew about.
>
> Best regards,
> David
>>> At 11:57 AM +0000 3/16/05, David Firth wrote:
>>>> I don't know whether this is a bug, or a problem with the way I
>>>> built R 2.0.1 (under Mac OS 10.3 on a G5), or something else.  Can
>>>> anyone else confirm (or otherwise) that this happens in their R
>>>> 2.0.1 on Mac OS X?
>>>>
>>>>>  d<-matrix(NaN,3,3)
>>>>>   d
>>>>     [,1] [,2] [,3]
>>>> [1,]  NaN  NaN  NaN
>>>> [2,]  NaN  NaN  NaN
>>>> [3,]  NaN  NaN  NaN
>>>>>   solve(d)
>>>> Error in solve.default(d) : Lapack routine dgesv: system is exactly
>>>> singular
>>>>>   chol(d)
>>>> Error in chol(d) : the leading minor of order 1 is not positive
>>>> definite
>>>>>   det(d)
>>>> [1] 0
>>>>
>>>> Doing the same thing on a Windows setup gave a different (and more
>>>> useful, I think) result

>
As I see it, the MacOS X behaviour is not IEEE-754 compliant.

I had a quick look at the IEEE web site and it seems quite clear that 
NaNs should not cause errors, but propagate through calculations to be 
tested at some appropriate (not too frequent) point.

It seems to me the most useful response is to file a bug on Apple's bug 
reporter complete with simple test case etc.  It might also help to 
bitch about it on Apple's scitech or hpc mail lists, which get 
monitored by Apple people.

It certainly is not up to R developers to fix it.

Bill Northcott

From Mark.Bravington at csiro.au  Tue Mar 22 04:43:28 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Tue Mar 22 04:43:42 2005
Subject: [Rd] trouble building r-devel
Message-ID: <4D99275E380CA94F998977EDACE548DC0625E5@extas2-hba.tas.csiro.au>

[Mark Bravington]> >I haven't been able to build yesterday's R-devel
(or, as a test,
> >R-devel_2005-03-11) on Windows XP. The error message I'm 
> getting is to 
> >do with 'arithmetic.c', as shown below.

[Duncan Murdoch]> My guess would be that you are using bad headers, or
perhaps 
> an out of date compiler.  I just recompiled today's 
> arithmetic.c with no error, using
> 
> $ gcc --version
> gcc.exe (GCC) 3.4.2 (mingw-special)
> Copyright (C) 2004 Free Software Foundation, Inc.

Thanks (but please read on ..!)

(i) My original problem occurred with gcc version 3.2. I downloaded
MinGW-3.1.0-1.exe (as named in the Windows INSTALL file) and this gave
me gcc version 3.2.3 *BUT* this gave me exactly the same problem.

(ii) I then downloaded MinGW-3.2.0-rc-3.exe (giving me gcc 3.4.2) and
this did get me past arithmetic.c. [So presumably my headers are OK.]
But this isn't yet a full release of gcc, is it?-- so if this particular
gcc version is required, perhaps some mention is needed in the Windows
INSTALL and in the release notes.

(iii) In any case, there was still a crash later on with 3.4.2. This
looks unrelated but I am equally at a loss:

windres   -i dllversion.rc -o dllversion.o
gcc  --shared -s  -o vfonts.dll vfonts.def g_alab_her.o g_cntrlify.o
g_fontdb.o g_her_glyph.o dllversion.o  -L../../gnuw
in32  -lR
mkdir -p ../../../modules
cp vfonts.dll ../../../modules/vfonts.dll
cp unicode/iconv.dll ../../modules/
cp: cannot stat `unicode/iconv.dll': No such file or directory
make[2]: *** [rmodules] Error 1
make[1]: *** [rbuild] Error 2
make: *** [all] Error 2

Mark

> -----Original Message-----
> From: Duncan Murdoch [mailto:murdoch@stats.uwo.ca] 
> Sent: Tuesday, 22 March 2005 11:27 AM
> To: Bravington, Mark (CMIS, Hobart)
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] trouble building r-devel
> 
> On Tue, 22 Mar 2005 10:09:30 +1100, <Mark.Bravington@csiro.au> wrote :
> 
> >I haven't been able to build yesterday's R-devel (or, as a test,
> >R-devel_2005-03-11) on Windows XP. The error message I'm 
> getting is to 
> >do with 'arithmetic.c', as shown below.
> >
> >Current R-patched seems to build fine, and I've built 
> previous R-devels 
> >from source fairly often in the past-- though I have no 
> understanding 
> >whatsoever of what's going on. FWIW the only changes I made 
> to MkRules 
> >are (i) WINHELP=NO and (ii) TCL_HOME=C:/R/Tcl, which are the 
> same ones 
> >I always make.
> >
> >Any help appreciated!
> >
> >Mark
> >
> >C:\R\R-devel\src\gnuwin32> make
> ><< some OK bits of output, to help show where the problem is>> ...
> >making vfonts.d from vfonts.c
> >gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H 
> >-DR_DLL_BUILD  -c CConverters.c -o CConverters.o gcc  -O2 -Wall 
> >-pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H 
> -DR_DLL_BUILD  -c 
> >CommandLineArgs.c -o CommandLineArg s.o gcc  -O2 -Wall -pedantic 
> >-DLEA_MALLOC -I../include -DHAVE_CONFIG_H -DR_DLL_BUILD  -c 
> Rdynload.c 
> >-o Rdynload.o gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include 
> >-DHAVE_CONFIG_H -DR_DLL_BUILD  -c Renviron.c -o Renviron.o gcc  -O2 
> >-Wall -pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H 
> -DR_DLL_BUILD  
> >-c RNG.c -o RNG.o gcc  -O2 -Wall -pedantic -DLEA_MALLOC -I../include 
> >-DHAVE_CONFIG_H -DR_DLL_BUILD  -c apply.c -o apply.o gcc  -O2 -Wall 
> >-pedantic -DLEA_MALLOC -I../include -DHAVE_CONFIG_H 
> -DR_DLL_BUILD  -c 
> >arithmetic.c -o arithmetic.o
> >arithmetic.c: In function `do_math1':
> >arithmetic.c:887: `acosh' undeclared (first use in this function)
> >arithmetic.c:887: (Each undeclared identifier is reported only once
> >arithmetic.c:887: for each function it appears in.)
> >arithmetic.c:888: `asinh' undeclared (first use in this function)
> >arithmetic.c:889: `atanh' undeclared (first use in this function)
> >make[4]: *** [arithmetic.o] Error 1
> >make[3]: *** [rlibs] Error 2
> >make[2]: *** [../../bin/R.dll] Error 2
> >make[1]: *** [rbuild] Error 2
> >make: *** [all] Error 2
> 
> My guess would be that you are using bad headers, or perhaps 
> an out of date compiler.  I just recompiled today's 
> arithmetic.c with no error, using
> 
> $ gcc --version
> gcc.exe (GCC) 3.4.2 (mingw-special)
> Copyright (C) 2004 Free Software Foundation, Inc.
> 
> Duncan Murdoch
> 
>

From sfalcon at fhcrc.org  Tue Mar 22 05:32:05 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Tue Mar 22 05:32:14 2005
Subject: [Rd] trouble building r-devel
In-Reply-To: <4D99275E380CA94F998977EDACE548DC0625E5@extas2-hba.tas.csiro.au>
	(Mark Bravington's message of "Tue, 22 Mar 2005 14:43:28 +1100")
References: <4D99275E380CA94F998977EDACE548DC0625E5@extas2-hba.tas.csiro.au>
Message-ID: <m2hdj41et6.fsf@macaroni.local>

<Mark.Bravington@csiro.au> writes:
> cp unicode/iconv.dll ../../modules/
> cp: cannot stat `unicode/iconv.dll': No such file or directory
> make[2]: *** [rmodules] Error 1
> make[1]: *** [rbuild] Error 2
> make: *** [all] Error 2

See the section Unicode support here:
http://www.murdoch-sutherland.com/Rtools/

Basically, you just need to download and then copy the iconv.dll to
the right spot and you should be on your way.

+ seth

From Mark.Bravington at csiro.au  Tue Mar 22 06:16:36 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Tue Mar 22 06:16:49 2005
Subject: [Rd] trouble building r-devel
Message-ID: <4D99275E380CA94F998977EDACE548DC0625E8@extas2-hba.tas.csiro.au>

Thanks Seth (and Duncan)-- the murdoch-sutherland page seems to fix
everything. The slimmed-down INSTALL file in R-devel src gnuwin32
doesn't refer to the page-- it might be good to add a reference.

Mark

Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623
 

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Seth Falcon
> Sent: Tuesday, 22 March 2005 3:32 PM
> To: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] trouble building r-devel
> 
> <Mark.Bravington@csiro.au> writes:
> > cp unicode/iconv.dll ../../modules/
> > cp: cannot stat `unicode/iconv.dll': No such file or directory
> > make[2]: *** [rmodules] Error 1
> > make[1]: *** [rbuild] Error 2
> > make: *** [all] Error 2
> 
> See the section Unicode support here:
> http://www.murdoch-sutherland.com/Rtools/
> 
> Basically, you just need to download and then copy the 
> iconv.dll to the right spot and you should be on your way.
> 
> + seth
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From vograno at evafunds.com  Tue Mar 22 07:22:39 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Tue Mar 22 07:22:54 2005
Subject: [Rd] can R_do_slot_assign change slot type
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF619@phost015.EVAFUNDS.intermedia.net>

Hi,
 
It seems that R_do_slot_assign can change the type of an S4 class slot.
For example I have a class
 
setClass("ostream", representation(id = "integer", keepOpen =
"logical"))

and inside a C-function I was able to assign a RAW vector to the id
slot. Is this intentional? I remember reading somewhere that the slot
type is guaranteed by R. Maybe this doesn't extend to C code?
 
 
Now, in the above example I actually don't know the eventual type of the
'id' slot, it will be set up in some C code that intializes the class
instance. What is the right way to define the representation in such a
case?
 
Thanks,
Vadim

	[[alternative HTML version deleted]]

From ligges at statistik.uni-dortmund.de  Tue Mar 22 08:32:33 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue Mar 22 08:32:44 2005
Subject: [Rd] trouble building r-devel
In-Reply-To: <4D99275E380CA94F998977EDACE548DC0625E8@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC0625E8@extas2-hba.tas.csiro.au>
Message-ID: <423FCA11.4070908@statistik.uni-dortmund.de>

Mark.Bravington@csiro.au wrote:

> Thanks Seth (and Duncan)-- the murdoch-sutherland page seems to fix
> everything. The slimmed-down INSTALL file in R-devel src gnuwin32
> doesn't refer to the page-- it might be good to add a reference.

Mark,

I disagree.
This "slimmed-down" file points you to the thorough Chapter "Installing 
R under Windows" in the "`R Installation and Administration' manual in 
the doc/manual directory". Quite at the top of Section "Building from 
source" there is the Subsection "Getting the tools".

I think we do NOT want to point people to Duncan's page at first, or 
they would not read the more comprehensive manual any more.

Uwe


> Mark
> 
> Mark Bravington
> CSIRO Mathematical & Information Sciences
> Marine Laboratory
> Castray Esplanade
> Hobart 7001
> TAS
> 
> ph (+61) 3 6232 5118
> fax (+61) 3 6232 5012
> mob (+61) 438 315 623
>  
> 
> 
>>-----Original Message-----
>>From: r-devel-bounces@stat.math.ethz.ch 
>>[mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Seth Falcon
>>Sent: Tuesday, 22 March 2005 3:32 PM
>>To: r-devel@stat.math.ethz.ch
>>Subject: Re: [Rd] trouble building r-devel
>>
>><Mark.Bravington@csiro.au> writes:
>>
>>>cp unicode/iconv.dll ../../modules/
>>>cp: cannot stat `unicode/iconv.dll': No such file or directory
>>>make[2]: *** [rmodules] Error 1
>>>make[1]: *** [rbuild] Error 2
>>>make: *** [all] Error 2
>>
>>See the section Unicode support here:
>>http://www.murdoch-sutherland.com/Rtools/
>>
>>Basically, you just need to download and then copy the 
>>iconv.dll to the right spot and you should be on your way.
>>
>>+ seth
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ligges at statistik.uni-dortmund.de  Tue Mar 22 08:39:14 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue Mar 22 08:39:26 2005
Subject: [Rd] Writing R documentation
In-Reply-To: <Pine.GSO.4.40.0503211746110.8570-100000@sdac.harvard.edu>
References: <Pine.GSO.4.40.0503211746110.8570-100000@sdac.harvard.edu>
Message-ID: <423FCBA2.7090504@statistik.uni-dortmund.de>

Suzette Blanchard wrote:

> Greetings,
> 
> I used latex type code in my Rd files.
> 
> The pdf version using
> R CMD Rd2dvi --output=PKtools.pdf --pdf --title="PKtools" PKtools man
> came out quite nice.
> 
> However, my current HTML version does not tex the latex so there is
> latex code in the files and looks bad.

Sorry, I don't understand "HTML version does not tex the latex"?



> 
> example problem code:
> 
> AIC$_c$
> 
> or
> 
> \begin{itemize}
> \item NLME:
> \begin{itemize}
> \item population level: identify(MM\$mm\$fitted[,1], MM\$pkdata\$conc)
> \item individual level: identify(MM\$mm\$fitted[,2], MM\$pkdata\$conc)
> \end{itemize}
> \item NONMEM:
> \begin{itemize}
> \item population level: identify(NM\$pred\$PRED, NM\$pred\$CONC)
> \item individual level: identify(NM\$pred\$IPRE, NM\$pred\$CONC)
> \end{itemize}
> \item WinBUGS:
> \begin{itemize}
> \item population level: identify(WB\$pred\$ppred, WB\$pred\$conc)
> \item individual level: identify(WB\$pred\$ipred, WB\$pred\$conc)
> \end{itemize}
> 
> Is there a way to fix this?

.Rd is not .tex.

Please read the manual "Writing R Extensions". You cannot use 
mathematical environments that way. There are \eqn{} environments, if 
you really need it.

Uwe Ligges






> I tried Rdconv using --type=HTML but that did not work.
 >
> Any help you can send would be appreciated.
> 
> Thank you,
> Suzette
> 
> =================================
> Suzette Blanchard, Ph.D.
> UCSD-PPRU
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Tue Mar 22 09:06:48 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 09:07:01 2005
Subject: [Rd] pch=NA (PR#7737)
In-Reply-To: <20050322002757.8E39CBAF4@slim.kubism.ku.dk>
References: <20050322002757.8E39CBAF4@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503220803330.4965@gannet.stats>

Please check the current sources (R-2.1.0 alpha).
pch = NA is now documented under points(), where all the other values are,
and pch="" is now equivalent.


On Tue, 22 Mar 2005 arnima@u.washington.edu wrote:

> I'd like to suggest changes to three help pages, regarding the use of
> pch=NA to suppress plotting symbols. See below.
>
> Arni
>
> R 2.0.1 on WinXP
>
>
>
> ===
> help(bxp)
> ===
>
> The argument outpch=" " needs to be replaced with outpch=NA in two places.
>
> I actually wrote this part of the documentation myself at one point, but
> have now realized that pch=NA and pch=" " are not the same:
>
>   x <- split(rlnorm(26e4), letters)
>   ## NA generates small file
>   postscript("na.ps");    boxplot(x,outpch=NA);  dev.off()
>   ## Space generates large file
>   postscript("space.ps"); boxplot(x,outpch=" "); dev.off()

space was I am sure intended here.

>
>
>
> ===
> help(par)
> help(points)
> ===
>
> Please specify that pch=NA can be used to suppress plotting symbols.
>
> I'm aware of type="n", but pch=NA can be a useful feature inside functions
> and should be documented somewhere. Other negative-sounding values
> (-1,0,NULL,""," ") generate different results, and only pch=NA does the
> job properly.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Tue Mar 22 09:53:17 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Mar 22 09:53:27 2005
Subject: Alpha releases Re: [Rd] trouble building r-devel
In-Reply-To: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>
Message-ID: <x2k6o0f4ea.fsf@turmalin.kubism.ku.dk>

<Mark.Bravington@csiro.au> writes:

> I haven't been able to build yesterday's R-devel (or, as a test,
> R-devel_2005-03-11) on Windows XP. The error message I'm getting is to
> do with 'arithmetic.c', as shown below.

Apropos: The release process for 2.1.0 has now started and we are
putting up alpha tarballs in (e.g.)

http://cran.r-project.org/src/base-prerelease/R-alpha_2005-03-22.tar.gz

These tarballs are made using the same procedure as we intend to use
for the final release. It would be good if you'd try building from
these sources (rather than the daily snapshots) so that we may catch
any packaging errors in time.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Tue Mar 22 10:01:18 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 10:01:35 2005
Subject: Alpha releases Re: [Rd] trouble building r-devel
In-Reply-To: <x2k6o0f4ea.fsf@turmalin.kubism.ku.dk>
References: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>
	<x2k6o0f4ea.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503220857340.5460@gannet.stats>

On Tue, 22 Mar 2005, Peter Dalgaard wrote:

> <Mark.Bravington@csiro.au> writes:
>
>> I haven't been able to build yesterday's R-devel (or, as a test,
>> R-devel_2005-03-11) on Windows XP. The error message I'm getting is to
>> do with 'arithmetic.c', as shown below.
>
> Apropos: The release process for 2.1.0 has now started and we are
> putting up alpha tarballs in (e.g.)
>
> http://cran.r-project.org/src/base-prerelease/R-alpha_2005-03-22.tar.gz
>
> These tarballs are made using the same procedure as we intend to use
> for the final release. It would be good if you'd try building from
> these sources (rather than the daily snapshots) so that we may catch
> any packaging errors in time.

It would also be good if people would read the documentation that the 
INSTALL file points them to.  This whole thread is about things which are 
documented in the R-admin manual.  E.g.

> You need a recent version of the Mingw port of @code{gcc} from
              ^^^^^^^^^^^^^^
(MB's error was in not using a recent mingw-runtime, rather than the 
compiler per se, but the runtime is part of the port.  gcc 3.4.2 is 
definitely an official compiler release.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Mar 22 11:42:14 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 11:42:26 2005
Subject: [Rd] --with-readline=yes
In-Reply-To: <423D9972.1030509@bank-banque-canada.ca>
References: <423D9972.1030509@bank-banque-canada.ca>
Message-ID: <Pine.LNX.4.61.0503221040570.6614@gannet.stats>

On Sun, 20 Mar 2005, Paul Gilbert wrote:

> I think --with-readline=yes is a new default, but it does not seem to be 
> mentioned in the installation changes of NEWS. (I could easily be mistaken on 
> this.)

You could:

     o	R is now linked against ncurses/termlib/termcap only if
 	readline is specified (the default) and that requires it.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Tue Mar 22 12:40:48 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar 22 12:42:54 2005
Subject: [Rd] trouble building r-devel
In-Reply-To: <423FCA11.4070908@statistik.uni-dortmund.de>
References: <4D99275E380CA94F998977EDACE548DC0625E8@extas2-hba.tas.csiro.au>
	<423FCA11.4070908@statistik.uni-dortmund.de>
Message-ID: <5o0041h3hlt84rhm2kca8jijoevscqu1gs@4ax.com>

On Tue, 22 Mar 2005 08:32:33 +0100, Uwe Ligges
<ligges@statistik.uni-dortmund.de> wrote :

>Mark.Bravington@csiro.au wrote:
>
>> Thanks Seth (and Duncan)-- the murdoch-sutherland page seems to fix
>> everything. The slimmed-down INSTALL file in R-devel src gnuwin32
>> doesn't refer to the page-- it might be good to add a reference.
>
>Mark,
>
>I disagree.
>This "slimmed-down" file points you to the thorough Chapter "Installing 
>R under Windows" in the "`R Installation and Administration' manual in 
>the doc/manual directory". Quite at the top of Section "Building from 
>source" there is the Subsection "Getting the tools".
>
>I think we do NOT want to point people to Duncan's page at first, or 
>they would not read the more comprehensive manual any more.

This is a problem that is hopefully temporary.  Once 2.1.0 is out, it
will be reasonable to expect most Windows users to have installed the
binary version and have the manual available, the manual will be
available online, etc.  However, right now a source download only gets
the Texinfo source for the manual.

But as you say, the manual is the authority on how to do installs.
The web page will only have better information if the manual is out of
date, and that shouldn't happen before the release.

Duncan Murdoch

From ligges at statistik.uni-dortmund.de  Tue Mar 22 12:49:25 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue Mar 22 12:49:33 2005
Subject: [Rd] trouble building r-devel
In-Reply-To: <5o0041h3hlt84rhm2kca8jijoevscqu1gs@4ax.com>
References: <4D99275E380CA94F998977EDACE548DC0625E8@extas2-hba.tas.csiro.au>
	<423FCA11.4070908@statistik.uni-dortmund.de>
	<5o0041h3hlt84rhm2kca8jijoevscqu1gs@4ax.com>
Message-ID: <42400645.3010608@statistik.uni-dortmund.de>

Duncan Murdoch wrote:

> On Tue, 22 Mar 2005 08:32:33 +0100, Uwe Ligges
> <ligges@statistik.uni-dortmund.de> wrote :
> 
> 
>>Mark.Bravington@csiro.au wrote:
>>
>>
>>>Thanks Seth (and Duncan)-- the murdoch-sutherland page seems to fix
>>>everything. The slimmed-down INSTALL file in R-devel src gnuwin32
>>>doesn't refer to the page-- it might be good to add a reference.
>>
>>Mark,
>>
>>I disagree.
>>This "slimmed-down" file points you to the thorough Chapter "Installing 
>>R under Windows" in the "`R Installation and Administration' manual in 
>>the doc/manual directory". Quite at the top of Section "Building from 
>>source" there is the Subsection "Getting the tools".
>>
>>I think we do NOT want to point people to Duncan's page at first, or 
>>they would not read the more comprehensive manual any more.
> 
> 
> This is a problem that is hopefully temporary.  Once 2.1.0 is out, it
> will be reasonable to expect most Windows users to have installed the
> binary version and have the manual available, the manual will be
> available online, etc.  However, right now a source download only gets
> the Texinfo source for the manual.

The R-devel manual is online availabe at
http://stat.ethz.ch/R-manual/
so even this is not a big problem.

Uwe

> But as you say, the manual is the authority on how to do installs.
> The web page will only have better information if the manual is out of
> date, and that shouldn't happen before the release.
> 
> Duncan Murdoch

From ripley at stats.ox.ac.uk  Tue Mar 22 13:12:10 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 13:12:24 2005
Subject: [Rd] trouble building r-devel
In-Reply-To: <42400645.3010608@statistik.uni-dortmund.de>
References: <4D99275E380CA94F998977EDACE548DC0625E8@extas2-hba.tas.csiro.au>
	<423FCA11.4070908@statistik.uni-dortmund.de>
	<5o0041h3hlt84rhm2kca8jijoevscqu1gs@4ax.com>
	<42400645.3010608@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.61.0503221202070.22671@gannet.stats>

On Tue, 22 Mar 2005, Uwe Ligges wrote:

> Duncan Murdoch wrote:
>
>> On Tue, 22 Mar 2005 08:32:33 +0100, Uwe Ligges
>> <ligges@statistik.uni-dortmund.de> wrote :
>> 
>> 
>>> Mark.Bravington@csiro.au wrote:
>>> 
>>> 
>>>> Thanks Seth (and Duncan)-- the murdoch-sutherland page seems to fix
>>>> everything. The slimmed-down INSTALL file in R-devel src gnuwin32
>>>> doesn't refer to the page-- it might be good to add a reference.
>>> 
>>> Mark,
>>> 
>>> I disagree.
>>> This "slimmed-down" file points you to the thorough Chapter "Installing R 
>>> under Windows" in the "`R Installation and Administration' manual in the 
>>> doc/manual directory". Quite at the top of Section "Building from source" 
>>> there is the Subsection "Getting the tools".
>>> 
>>> I think we do NOT want to point people to Duncan's page at first, or they 
>>> would not read the more comprehensive manual any more.
>> 
>> 
>> This is a problem that is hopefully temporary.  Once 2.1.0 is out, it
>> will be reasonable to expect most Windows users to have installed the
>> binary version and have the manual available, the manual will be
>> available online, etc.  However, right now a source download only gets
>> the Texinfo source for the manual.
>
> The R-devel manual is online availabe at
> http://stat.ethz.ch/R-manual/
> so even this is not a big problem.

The HTML version of R-admin _is_ in the source tarballs: only if you get 
this by SubVersion will you be reduced to the texinfo version.  (And the 
top-level INSTALL file tells you that: I will repeat it in the 
src/gnuwin32/INSTALL file.)

Hence the comments in another part of the thread about getting the alpha 
tarballs and reading the documentation there.  (Since I have been away for 
a few days I have not checked the alpha tarballs, but I have checked the 
snapshots several times.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From edd at debian.org  Tue Mar 22 13:14:38 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue Mar 22 13:14:55 2005
Subject: Debian experimental release of Alpha releases (Was: [Rd] trouble
	building r-devel)
In-Reply-To: <x2k6o0f4ea.fsf@turmalin.kubism.ku.dk>
References: <4D99275E380CA94F998977EDACE548DC0625E2@extas2-hba.tas.csiro.au>
	<x2k6o0f4ea.fsf@turmalin.kubism.ku.dk>
Message-ID: <16960.3118.508307.900678@basebud.nulle.part>


On 22 March 2005 at 09:53, Peter Dalgaard wrote:
| <Mark.Bravington@csiro.au> writes:
| 
| > I haven't been able to build yesterday's R-devel (or, as a test,
| > R-devel_2005-03-11) on Windows XP. The error message I'm getting is to
| > do with 'arithmetic.c', as shown below.
| 
| Apropos: The release process for 2.1.0 has now started and we are
| putting up alpha tarballs in (e.g.)
| 
| http://cran.r-project.org/src/base-prerelease/R-alpha_2005-03-22.tar.gz
| 
| These tarballs are made using the same procedure as we intend to use
| for the final release. It would be good if you'd try building from
| these sources (rather than the daily snapshots) so that we may catch
| any packaging errors in time.

I didn't yet find that one yesterday, so I made the usual R-devel of
2005-03-22 the first new test release.  For now, these are going into
Debian's experimental branch (so you'd need experimental as a distribution in
apt's sources.list).  I'll switch to adding them to unstable once we get a
little closer to the release.

Dirk

-- 
Better to have an approximate answer to the right question than a precise 
answer to the wrong question.  --  John Tukey as quoted by John Chambers

From bates at stat.wisc.edu  Tue Mar 22 14:09:30 2005
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue Mar 22 14:10:32 2005
Subject: [Rd] can R_do_slot_assign change slot type
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF619@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF619@phost015.EVAFUNDS.intermedia.net>
Message-ID: <4240190A.4010606@stat.wisc.edu>

Vadim Ogranovich wrote:
> Hi,
>  
> It seems that R_do_slot_assign can change the type of an S4 class slot.
> For example I have a class
>  
> setClass("ostream", representation(id = "integer", keepOpen =
> "logical"))
> 
> and inside a C-function I was able to assign a RAW vector to the id
> slot. Is this intentional? I remember reading somewhere that the slot
> type is guaranteed by R. Maybe this doesn't extend to C code?
>  
>  
> Now, in the above example I actually don't know the eventual type of the
> 'id' slot, it will be set up in some C code that intializes the class
> instance. What is the right way to define the representation in such a
> case?
>  
> Thanks,
> Vadim

I think it would be more accurate to say that the SET_SLOT macro in C 
(which is preferred to using direct calls to the R_do_slot_assign 
function) does not check the type of the value being assigned.  I 
imagine this is for efficiency - you don't really want to have that code 
looking up the definition of the class of the target every time it is 
called.

Yes, this does provide you with rope with which to hang yourself. 
That's what programming in C is all about.  ;-)  If you are concerned 
about validity of objects from an S4 class, create explicit checks using 
validObject in your R code.

From simon.urbanek at r-project.org  Tue Mar 22 14:55:06 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue Mar 22 14:55:19 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <098c2dce898207218d3e518868d7ffec@unsw.edu.au>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
Message-ID: <3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>

Bill,

On Mar 21, 2005, at 10:31 PM, Bill Northcott wrote:

> As I see it, the MacOS X behaviour is not IEEE-754 compliant.
>
> I had a quick look at the IEEE web site and it seems quite clear  
> that NaNs should not cause errors, but propagate through  
> calculations to be tested at some appropriate (not too frequent)  
> point.

This is not quite correct and in fact irrelevant to the problem you  
describe. NaNs may or may not signal, depending on how they are used.  
Certain operations on NaN must signal by the IEEE-754 standard. The  
error you get is not a trap, and it's not a result of a signal check,  
either. The whole problem is that depending on which algorithm is  
used, the NaNs will be used different ways and thus may or may not  
use signaling operations.

I don't consider the `solve' error a bug - in fact I would rather get  
an error telling me that something is wrong (although I agree that  
the error is misleading - the error given in Linux is a bit more  
helpful) than getting a wrong result.

If I would mark something in your example as a bug that would be det 
(m)=0, because it should return NaN (remember, NaN==NaN is FALSE;  
furthermore if det was calculated inefficiently using Laplace  
expansion, the result would be NaN according to IEEE rules). det=0 is  
consistent with the error given, though. Should we check this in R  
before calling Lapack - if the vector contains NaNs, det/determinant  
should return NaN right away?

Many functions in R will actually bark at NaN inputs (e.g. qr,  
eigen, ...) - maybe you're saying that we should check for NaNs in  
solve before proceeding and raising an error?


Cheers,
Simon

From jmacdon at med.umich.edu  Tue Mar 22 15:02:38 2005
From: jmacdon at med.umich.edu (James MacDonald)
Date: Tue Mar 22 15:03:09 2005
Subject: [Rd] Segfault with savePlot
Message-ID: <s23fdf44.019@med-gwia-02a.med.umich.edu>

I get a segfault when using savePlot("foo","pdf"). FWIW, I don't have a
problem using the canonical

pdf("foo.pdf")
plot(something)
dev.off()

Best,

Jim



> R.Version()
$platform
[1] "i386-pc-mingw32"

$arch
[1] "i386"

$os
[1] "mingw32"

$system
[1] "i386, mingw32"

$status
[1] "Under development (unstable)"

$major
[1] "2"

$minor
[1] "1.0"

$year
[1] "2005"

$month
[1] "03"

$day
[1] "17"

$language
[1] "R"



James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109
734-647-5623


**********************************************************
Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues.

From ripley at stats.ox.ac.uk  Tue Mar 22 15:41:25 2005
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue Mar 22 15:41:32 2005
Subject: [Rd] Segfault with savePlot
In-Reply-To: <s23fdf44.019@med-gwia-02a.med.umich.edu>
References: <s23fdf44.019@med-gwia-02a.med.umich.edu>
Message-ID: <Pine.WNT.4.58.0503221432520.2696@auk>

This is due to a change last Thursday to the PDF device, and the person
doing so not making the corresponding change to savePlot().  Adding
arguments to the middle of a call is error-prone.

Should be back as it was before now.


On Tue, 22 Mar 2005, James MacDonald wrote:

> I get a segfault when using savePlot("foo","pdf"). FWIW, I don't have a
> problem using the canonical
>
> pdf("foo.pdf")
> plot(something)
> dev.off()
>
> Best,
>
> Jim
>
> i
>
> > R.Version()
> $platform
> [1] "i386-pc-mingw32"
>
> $arch
> [1] "i386"
>
> $os
> [1] "mingw32"
>
> $system
> [1] "i386, mingw32"
>
> $status
> [1] "Under development (unstable)"
>
> $major
> [1] "2"
>
> $minor
> [1] "1.0"
>
> $year
> [1] "2005"
>
> $month
> [1] "03"
>
> $day
> [1] "17"
>
> $language
> [1] "R"
>
>
>
> James W. MacDonald
> Affymetrix and cDNA Microarray Core
> University of Michigan Cancer Center
> 1500 E. Medical Center Drive
> 7410 CCGC
> Ann Arbor MI 48109
> 734-647-5623
>
>
> **********************************************************
> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues.
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From laurent.mauron at credit-suisse.com  Tue Mar 22 16:03:05 2005
From: laurent.mauron at credit-suisse.com (Mauron Laurent (KETR 31))
Date: Tue Mar 22 16:04:05 2005
Subject: [Rd] Compiling "R Embedded" examples
Message-ID: <ED765D0AD42FD6408805FA8A766868D103C4E8C6@sxchs009b.itzrh.ska.com>

Hi,

Thanks for your suggestion. I re-compiled R-2.0.1 with gcc 3.3.2. but got exactly the same problem. 

I am very puzzled because the compilation of R is ok. Is there any piece of code that was succesfully compiled on my setup that could be used as an example of embedding R in C/C++ (tcltk for example?).

Thanks for your help,

Laurent


$gcc -v
Reading specs from /app/gcc_3.3.2/lib/gcc-lib/sparc-sun-solaris2.8/3.3.2/specs
Configured with: ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs : (reconfigured) ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs
Thread model: posix
gcc version 3.3.2

-----Original Message-----
From: Duncan Temple Lang [mailto:duncan@wald.ucdavis.edu]
Sent: 21 March 2005 20:01
To: Mauron Laurent (KETR 31)
Cc: 'r-devel@stat.math.ethz.ch'
Subject: Re: [Rd] Compiling "R Embedded" examples


Mauron Laurent (KETR 31) wrote:
> Hi,
> 
> I haven't made any progress regarding compiling the "R embedding" example ( http://tolstoy.newcastle.edu.au/R/devel/05/03/0143.htm ) and I am running out of ideas. 
> 
> I would be very grateful if someone could give me some reference or pointers where to look. In other words, how would you attack the problem if you were in the same situation?


I would install a different version of gcc (e.g. gcc-3.3.3) as that works on
one of the Solaris machines I use.

   SunOS 5.8 Generic_117000-05 sun4u sparc SUNW,Ultra-5_10


On that machine, all works fine.

> 
> Thanks for your help,
> 
> Laurent
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Duncan Temple Lang                duncan@wald.ucdavis.edu
Department of Statistics          work:  (530) 752-4782
371 Kerr Hall                     fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis, CA 95616, USA

From ripley at stats.ox.ac.uk  Tue Mar 22 16:52:19 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 16:52:28 2005
Subject: [Rd] Compiling "R Embedded" examples
In-Reply-To: <ED765D0AD42FD6408805FA8A766868D103C4E8C6@sxchs009b.itzrh.ska.com>
References: <ED765D0AD42FD6408805FA8A766868D103C4E8C6@sxchs009b.itzrh.ska.com>
Message-ID: <Pine.LNX.4.61.0503221521270.28348@gannet.stats>

On Tue, 22 Mar 2005, Mauron Laurent (KETR 31) wrote:

> Thanks for your suggestion. I re-compiled R-2.0.1 with gcc 3.3.2. but 
> got exactly the same problem.

(Which problem is not described in this message and the stated URL is 
invalid.  Searching suggests it is related to MAIN__.)

> I am very puzzled because the compilation of R is ok. Is there any piece 
> of code that was succesfully compiled on my setup that could be used as 
> an example of embedding R in C/C++ (tcltk for example?).

No.  Only R.bin is in any way similar to the embedded examples: tcltk is 
run from R, not R from tcltk.

Solaris 8, gcc 3.4.3 works for me.

Note that MAIN__ is defined in Rmain.c, and that is part of R.bin and not 
libR.so.  You could try copying it is to Rtest.c to see if this helps.

What you have not told us is the Fortran that you are using.  That is 
likely to be the clue.  Try a current gcc AND g77 -- gcc is a Compiler 
Collection, not just a C compiler.


> $gcc -v
> Reading specs from /app/gcc_3.3.2/lib/gcc-lib/sparc-sun-solaris2.8/3.3.2/specs
> Configured with: ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs : (reconfigured) ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs
> Thread model: posix
> gcc version 3.3.2
>
> -----Original Message-----
> From: Duncan Temple Lang [mailto:duncan@wald.ucdavis.edu]
> Sent: 21 March 2005 20:01
> To: Mauron Laurent (KETR 31)
> Cc: 'r-devel@stat.math.ethz.ch'
> Subject: Re: [Rd] Compiling "R Embedded" examples
>
>
> Mauron Laurent (KETR 31) wrote:
>> Hi,
>>
>> I haven't made any progress regarding compiling the "R embedding" 
>> example ( http://tolstoy.newcastle.edu.au/R/devel/05/03/0143.htm ) and 
>> I am running out of ideas.
>>
>> I would be very grateful if someone could give me some reference or 
>> pointers where to look. In other words, how would you attack the 
>> problem if you were in the same situation?
>
>
> I would install a different version of gcc (e.g. gcc-3.3.3) as that works on
> one of the Solaris machines I use.
>
>   SunOS 5.8 Generic_117000-05 sun4u sparc SUNW,Ultra-5_10
>
>
> On that machine, all works fine.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Friedrich.Leisch at tuwien.ac.at  Tue Mar 22 18:15:48 2005
From: Friedrich.Leisch at tuwien.ac.at (Friedrich.Leisch@tuwien.ac.at)
Date: Tue Mar 22 18:15:56 2005
Subject: [Rd] edit(vignette(...))
In-Reply-To: <423DAA3B.8090803@bank-banque-canada.ca>
References: <423DAA3B.8090803@bank-banque-canada.ca>
Message-ID: <16960.21188.195530.761464@galadriel.ci.tuwien.ac.at>

>>>>> On Sun, 20 Mar 2005 11:52:11 -0500,
>>>>> Paul Gilbert (PG) wrote:

  > I have been looking at edit(vignette(...)) in r-devel, which I think 
  > will be really useful for people working through vignettes. Is there a 
  > way to fork the editor so that the R prompt is returned?
  > The call seems 
  > to be passed though to edit.file, but I don't see any simple way to get 
  > the prompt back until the editor is closed.  (I seem to recall there was 
  > a problem with the prompt returning too soon from bug.report some
  > time ago.)

On windows it does work, if you use the default internal editor. I
played a little bit with file.edit on Unix, but the problem is that
you know much less about the system, a lot of shells and editors could
possibly be involved ... maybe there is a simple solution, but I
failed to see it back then. Probably file.edit() could do with a
"background" argument.


  > I also noticed that many (most?) packages have a vignette with the same 
  > name as the package. Is this considered the standard now?

No, probably most authors are to lazy too invent another name, and of
course it also makes it easier for the user to remember the name of
the vignette ... but we have not written down any standard.

.f

From laurent.mauron at credit-suisse.com  Tue Mar 22 18:20:02 2005
From: laurent.mauron at credit-suisse.com (Mauron Laurent (KETR 31))
Date: Tue Mar 22 18:20:15 2005
Subject: [Rd] Compiling "R Embedded" examples
Message-ID: <ED765D0AD42FD6408805FA8A766868D103C4E8C8@sxchs009b.itzrh.ska.com>

Your suggestion to use Rmain.c led to the solution.

The compilation of Rmain.c worked ok. I had a look at Rmain.c and found this reference to MAIN__

/* Declarations to keep f77 happy */
int MAIN_(int ac, char **av)  {return 0;}
int MAIN__(int ac, char **av) {return 0;}
int __main(int ac, char **av) {return 0;}

Adding those lines to Rtest.c did the trick.

I am still puzzled by this problem. The fortran compiler I was using is g77 from gcc3.3.2.

$ g77 -v
Reading specs from /app/gcc_3.3.2/lib/gcc-lib/sparc-sun-solaris2.8/3.3.2/specs
Configured with: ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs : (reconfigured) ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs
Thread model: posix
gcc version 3.3.2

Anyway, it works now. Thanks a lot for your help!

Laurent




-----Original Message-----
From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
Sent: 22 March 2005 16:52
To: Mauron Laurent (KETR 31)
Cc: 'r-devel@stat.math.ethz.ch'
Subject: RE: [Rd] Compiling "R Embedded" examples


On Tue, 22 Mar 2005, Mauron Laurent (KETR 31) wrote:

> Thanks for your suggestion. I re-compiled R-2.0.1 with gcc 3.3.2. but 
> got exactly the same problem.

(Which problem is not described in this message and the stated URL is 
invalid.  Searching suggests it is related to MAIN__.)

> I am very puzzled because the compilation of R is ok. Is there any piece 
> of code that was succesfully compiled on my setup that could be used as 
> an example of embedding R in C/C++ (tcltk for example?).

No.  Only R.bin is in any way similar to the embedded examples: tcltk is 
run from R, not R from tcltk.

Solaris 8, gcc 3.4.3 works for me.

Note that MAIN__ is defined in Rmain.c, and that is part of R.bin and not 
libR.so.  You could try copying it is to Rtest.c to see if this helps.

What you have not told us is the Fortran that you are using.  That is 
likely to be the clue.  Try a current gcc AND g77 -- gcc is a Compiler 
Collection, not just a C compiler.


> $gcc -v
> Reading specs from /app/gcc_3.3.2/lib/gcc-lib/sparc-sun-solaris2.8/3.3.2/specs
> Configured with: ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs : (reconfigured) ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs
> Thread model: posix
> gcc version 3.3.2
>
> -----Original Message-----
> From: Duncan Temple Lang [mailto:duncan@wald.ucdavis.edu]
> Sent: 21 March 2005 20:01
> To: Mauron Laurent (KETR 31)
> Cc: 'r-devel@stat.math.ethz.ch'
> Subject: Re: [Rd] Compiling "R Embedded" examples
>
>
> Mauron Laurent (KETR 31) wrote:
>> Hi,
>>
>> I haven't made any progress regarding compiling the "R embedding" 
>> example ( http://tolstoy.newcastle.edu.au/R/devel/05/03/0143.htm ) and 
>> I am running out of ideas.
>>
>> I would be very grateful if someone could give me some reference or 
>> pointers where to look. In other words, how would you attack the 
>> problem if you were in the same situation?
>
>
> I would install a different version of gcc (e.g. gcc-3.3.3) as that works on
> one of the Solaris machines I use.
>
>   SunOS 5.8 Generic_117000-05 sun4u sparc SUNW,Ultra-5_10
>
>
> On that machine, all works fine.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From vograno at evafunds.com  Tue Mar 22 18:48:16 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Tue Mar 22 18:48:26 2005
Subject: [Rd] documentation on seek needs update
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF63B@phost015.EVAFUNDS.intermedia.net>

 Hi,
 
I wondered how seek() deals with large (>2GB) files. The help says that
the 'where' arg should be an integer, while the release notes for 2.0.0
say

    o	seek() on connections now accepts and returns a double for the
	file position.	This allows >2Gb files to be handled on a
	64-bit platform (and some 32-bit platforms).
 
I assume that the help file just had not been updated, correct?
 
Thanks,
Vadim

> version
         _                       
platform x86_64-unknown-linux-gnu
arch     x86_64                  
os       linux-gnu               
system   x86_64, linux-gnu       
status                           
major    2                       
minor    0.1                     
year     2004                    
month    11                      
day      15                      
language R

From ripley at stats.ox.ac.uk  Tue Mar 22 18:50:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 18:51:09 2005
Subject: [Rd] Compiling "R Embedded" examples
In-Reply-To: <ED765D0AD42FD6408805FA8A766868D103C4E8C8@sxchs009b.itzrh.ska.com>
References: <ED765D0AD42FD6408805FA8A766868D103C4E8C8@sxchs009b.itzrh.ska.com>
Message-ID: <Pine.LNX.4.61.0503221748270.30346@gannet.stats>

On Tue, 22 Mar 2005, Mauron Laurent (KETR 31) wrote:

> Your suggestion to use Rmain.c led to the solution.
>
> The compilation of Rmain.c worked ok. I had a look at Rmain.c and found this reference to MAIN__
>
> /* Declarations to keep f77 happy */
> int MAIN_(int ac, char **av)  {return 0;}
> int MAIN__(int ac, char **av) {return 0;}
> int __main(int ac, char **av) {return 0;}
>
> Adding those lines to Rtest.c did the trick.

That is actually what I suggested ... or rather, the second line.

> I am still puzzled by this problem.

So are we, but as two of us have no problem on our systems, it is 
something about yours, for example which loader you are using.

>  The fortran compiler I was using is 
> g77 from gcc3.3.2.

> $ g77 -v
> Reading specs from /app/gcc_3.3.2/lib/gcc-lib/sparc-sun-solaris2.8/3.3.2/specs
> Configured with: ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs : (reconfigured) ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs
> Thread model: posix
> gcc version 3.3.2
>
> Anyway, it works now. Thanks a lot for your help!
>
> Laurent
>
>
>
>
> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
> Sent: 22 March 2005 16:52
> To: Mauron Laurent (KETR 31)
> Cc: 'r-devel@stat.math.ethz.ch'
> Subject: RE: [Rd] Compiling "R Embedded" examples
>
>
> On Tue, 22 Mar 2005, Mauron Laurent (KETR 31) wrote:
>
>> Thanks for your suggestion. I re-compiled R-2.0.1 with gcc 3.3.2. but
>> got exactly the same problem.
>
> (Which problem is not described in this message and the stated URL is
> invalid.  Searching suggests it is related to MAIN__.)
>
>> I am very puzzled because the compilation of R is ok. Is there any piece
>> of code that was succesfully compiled on my setup that could be used as
>> an example of embedding R in C/C++ (tcltk for example?).
>
> No.  Only R.bin is in any way similar to the embedded examples: tcltk is
> run from R, not R from tcltk.
>
> Solaris 8, gcc 3.4.3 works for me.
>
> Note that MAIN__ is defined in Rmain.c, and that is part of R.bin and not
> libR.so.  You could try copying it is to Rtest.c to see if this helps.
>
> What you have not told us is the Fortran that you are using.  That is
> likely to be the clue.  Try a current gcc AND g77 -- gcc is a Compiler
> Collection, not just a C compiler.
>
>
>> $gcc -v
>> Reading specs from /app/gcc_3.3.2/lib/gcc-lib/sparc-sun-solaris2.8/3.3.2/specs
>> Configured with: ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs : (reconfigured) ../configure --prefix=/app/gcc_3.3.2 --with-local-prefix=/app/gcc_3.3.2 --enable-threads --enable-version-specific-runtime-libs
>> Thread model: posix
>> gcc version 3.3.2
>>
>> -----Original Message-----
>> From: Duncan Temple Lang [mailto:duncan@wald.ucdavis.edu]
>> Sent: 21 March 2005 20:01
>> To: Mauron Laurent (KETR 31)
>> Cc: 'r-devel@stat.math.ethz.ch'
>> Subject: Re: [Rd] Compiling "R Embedded" examples
>>
>>
>> Mauron Laurent (KETR 31) wrote:
>>> Hi,
>>>
>>> I haven't made any progress regarding compiling the "R embedding"
>>> example ( http://tolstoy.newcastle.edu.au/R/devel/05/03/0143.htm ) and
>>> I am running out of ideas.
>>>
>>> I would be very grateful if someone could give me some reference or
>>> pointers where to look. In other words, how would you attack the
>>> problem if you were in the same situation?
>>
>>
>> I would install a different version of gcc (e.g. gcc-3.3.3) as that works on
>> one of the Solaris machines I use.
>>
>>   SunOS 5.8 Generic_117000-05 sun4u sparc SUNW,Ultra-5_10
>>
>>
>> On that machine, all works fine.
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Mar 22 18:53:32 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 18:53:42 2005
Subject: [Rd] documentation on seek *does not* need update
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF63B@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF63B@phost015.EVAFUNDS.intermedia.net>
Message-ID: <Pine.LNX.4.61.0503221751130.30346@gannet.stats>

On Tue, 22 Mar 2005, Vadim Ogranovich wrote:

> Hi,
>
> I wondered how seek() deals with large (>2GB) files. The help says that
> the 'where' arg should be an integer, while the release notes for 2.0.0
> say
>
>    o	seek() on connections now accepts and returns a double for the
> 	file position.	This allows >2Gb files to be handled on a
> 	64-bit platform (and some 32-bit platforms).
>
> I assume that the help file just had not been updated, correct?

Not correct.  Integer is a concept, not the same as `int'.  The amount to 
seek by must be an integer, of course.

C doubles (and R doubles) can be integers.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From vograno at evafunds.com  Tue Mar 22 19:02:45 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Tue Mar 22 19:03:41 2005
Subject: [Rd] documentation on seek *does not* need update
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A58FF642@phost015.EVAFUNDS.intermedia.net>

Well, "integer" is also a storage.mode in R. It is not immediately clear
which meaning the help page uses. I guess some extra elaboration would
be helpful.

Anyway, thank you for the clarification,
Vadim

> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> Sent: Tuesday, March 22, 2005 9:54 AM
> To: Vadim Ogranovich
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] documentation on seek *does not* need update
> 
> On Tue, 22 Mar 2005, Vadim Ogranovich wrote:
> 
> > Hi,
> >
> > I wondered how seek() deals with large (>2GB) files. The help says 
> > that the 'where' arg should be an integer, while the 
> release notes for 
> > 2.0.0 say
> >
> >    o	seek() on connections now accepts and returns a 
> double for the
> > 	file position.	This allows >2Gb files to be handled on a
> > 	64-bit platform (and some 32-bit platforms).
> >
> > I assume that the help file just had not been updated, correct?
> 
> Not correct.  Integer is a concept, not the same as `int'.  
> The amount to seek by must be an integer, of course.
> 
> C doubles (and R doubles) can be integers.
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

From ripley at stats.ox.ac.uk  Tue Mar 22 19:07:57 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 19:08:06 2005
Subject: [Rd] documentation on seek *does not* need update
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF642@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF642@phost015.EVAFUNDS.intermedia.net>
Message-ID: <Pine.LNX.4.61.0503221806150.30346@gannet.stats>

What went wrong when you misunderstood this?

On Tue, 22 Mar 2005, Vadim Ogranovich wrote:

> Well, "integer" is also a storage.mode in R. It is not immediately clear
> which meaning the help page uses. I guess some extra elaboration would
> be helpful.
>
> Anyway, thank you for the clarification,
> Vadim
>
>> -----Original Message-----
>> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
>> Sent: Tuesday, March 22, 2005 9:54 AM
>> To: Vadim Ogranovich
>> Cc: r-devel@stat.math.ethz.ch
>> Subject: Re: [Rd] documentation on seek *does not* need update
>>
>> On Tue, 22 Mar 2005, Vadim Ogranovich wrote:
>>
>>> Hi,
>>>
>>> I wondered how seek() deals with large (>2GB) files. The help says
>>> that the 'where' arg should be an integer, while the
>> release notes for
>>> 2.0.0 say
>>>
>>>    o	seek() on connections now accepts and returns a
>> double for the
>>> 	file position.	This allows >2Gb files to be handled on a
>>> 	64-bit platform (and some 32-bit platforms).
>>>
>>> I assume that the help file just had not been updated, correct?
>>
>> Not correct.  Integer is a concept, not the same as `int'.
>> The amount to seek by must be an integer, of course.
>>
>> C doubles (and R doubles) can be integers.
>>
>> --
>> Brian D. Ripley,                  ripley@stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rpeng at jhsph.edu  Tue Mar 22 19:37:40 2005
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Tue Mar 22 19:37:48 2005
Subject: [Rd] make install fails with makeinfo < 4.7
Message-ID: <424065F4.3040809@jhsph.edu>

When I build R-devel (or the alpha snapshots) on a system without 
makeinfo >= 4.7, I get a warning about not being able to build 
HTML/Info help pages after running 'configure' (but 'make' runs 
smoothly and there are no errors).  However, when I run 'make install' 
I get an error, something like

make[2]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/html'
make[3]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/manual'
creating doc/html/resources.html
make[3]: *** [../html/resources.html] Error 1
make[3]: Leaving directory `/home/rpeng/R-local/src/R-devel/doc/manual'
installing doc/html ...
make[3]: Entering directory 
`/home/rpeng/R-local/src/R-devel/doc/html/search'
installing doc/html/search ...
make[3]: Leaving directory 
`/home/rpeng/R-local/src/R-devel/doc/html/search'
/usr/bin/install: cannot stat `resources.html': No such file or directory
make[2]: *** [install] Error 1
[... more errors ...]

Am I correct in assuming that I get this because I don't have the 
correct makeinfo version?  If so, is this the intended behavior of 
'make install'?  I figured I should be able to install R even if I 
couldn't build the HTML/Info help pages, but....

-roger
-- 
Roger D. Peng
http://www.biostat.jhsph.edu/~rpeng/

From ripley at stats.ox.ac.uk  Tue Mar 22 20:17:59 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 20:18:12 2005
Subject: [Rd] make install fails with makeinfo < 4.7
In-Reply-To: <424065F4.3040809@jhsph.edu>
References: <424065F4.3040809@jhsph.edu>
Message-ID: <Pine.LNX.4.61.0503221852150.31029@gannet.stats>

On Tue, 22 Mar 2005, Roger D. Peng wrote:

> When I build R-devel (or the alpha snapshots) on a system without makeinfo >= 
> 4.7, I get a warning about not being able to build HTML/Info help pages after 
> running 'configure' (but 'make' runs smoothly and there are no errors). 
> However, when I run 'make install' I get an error, something like
>
> make[2]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/html'
> make[3]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/manual'
> creating doc/html/resources.html
> make[3]: *** [../html/resources.html] Error 1
> make[3]: Leaving directory `/home/rpeng/R-local/src/R-devel/doc/manual'
> installing doc/html ...
> make[3]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/html/search'
> installing doc/html/search ...
> make[3]: Leaving directory `/home/rpeng/R-local/src/R-devel/doc/html/search'
> /usr/bin/install: cannot stat `resources.html': No such file or directory
> make[2]: *** [install] Error 1
> [... more errors ...]
>
> Am I correct in assuming that I get this because I don't have the correct 
> makeinfo version?

No.  The intention is that file should be in the tarball.  It seems to be.
Are you using builddir == srcdir or not?  Both seem to work for me.

The line

> creating doc/html/resources.html

should not occur when building from a tarball, as it comes from

 	@if test ! -f "$(srcdir)/resources.html" || test -f non-tarball ; then \
 	  (cd ../manual && $(MAKE) html-non-svn) ; \
 	  touch non-tarball ; \

Have you perchance previously built from an SVN checkout in the same dir?

> If so, is this the intended behavior of 'make install'?  I 
> figured I should be able to install R even if I couldn't build the HTML/Info 
> help pages, but....

If building from a tarball, yes.  The requirements for building from an 
SVN checkout are more stringent.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rpeng at jhsph.edu  Tue Mar 22 22:11:52 2005
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Tue Mar 22 22:12:00 2005
Subject: [Rd] make install fails with makeinfo < 4.7
In-Reply-To: <Pine.LNX.4.61.0503221852150.31029@gannet.stats>
References: <424065F4.3040809@jhsph.edu>
	<Pine.LNX.4.61.0503221852150.31029@gannet.stats>
Message-ID: <42408A18.90800@jhsph.edu>

Okay, a slight revision.  'make install' works fine when I build from 
the alpha tarballs (at least today's tarball works).  The error only 
occurs when I build from SVN sources, both when builddir == srcdir and 
when the build dir is a separate directory.

-roger

Prof Brian Ripley wrote:
> On Tue, 22 Mar 2005, Roger D. Peng wrote:
> 
>> When I build R-devel (or the alpha snapshots) on a system without 
>> makeinfo >= 4.7, I get a warning about not being able to build 
>> HTML/Info help pages after running 'configure' (but 'make' runs 
>> smoothly and there are no errors). However, when I run 'make install' 
>> I get an error, something like
>>
>> make[2]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/html'
>> make[3]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/manual'
>> creating doc/html/resources.html
>> make[3]: *** [../html/resources.html] Error 1
>> make[3]: Leaving directory `/home/rpeng/R-local/src/R-devel/doc/manual'
>> installing doc/html ...
>> make[3]: Entering directory 
>> `/home/rpeng/R-local/src/R-devel/doc/html/search'
>> installing doc/html/search ...
>> make[3]: Leaving directory 
>> `/home/rpeng/R-local/src/R-devel/doc/html/search'
>> /usr/bin/install: cannot stat `resources.html': No such file or directory
>> make[2]: *** [install] Error 1
>> [... more errors ...]
>>
>> Am I correct in assuming that I get this because I don't have the 
>> correct makeinfo version?
> 
> 
> No.  The intention is that file should be in the tarball.  It seems to be.
> Are you using builddir == srcdir or not?  Both seem to work for me.
> 
> The line
> 
>> creating doc/html/resources.html
> 
> 
> should not occur when building from a tarball, as it comes from
> 
>     @if test ! -f "$(srcdir)/resources.html" || test -f non-tarball ; 
> then \
>       (cd ../manual && $(MAKE) html-non-svn) ; \
>       touch non-tarball ; \
> 
> Have you perchance previously built from an SVN checkout in the same dir?
> 
>> If so, is this the intended behavior of 'make install'?  I figured I 
>> should be able to install R even if I couldn't build the HTML/Info 
>> help pages, but....
> 
> 
> If building from a tarball, yes.  The requirements for building from an 
> SVN checkout are more stringent.
> 

-- 
Roger D. Peng
http://www.biostat.jhsph.edu/~rpeng/

From molzon at ms.uky.edu  Tue Mar 22 22:32:22 2005
From: molzon at ms.uky.edu (molzon@ms.uky.edu)
Date: Tue Mar 22 22:32:30 2005
Subject: [Rd] demo(graphics) (PR#7740)
Message-ID: <20050322213222.DB659C005@slim.kubism.ku.dk>

demo(graphics) fails after third plot.  I am using Suse 9.1 on a Dell 8100.
I tried the solution suggested on the Mandrake install docs.
I removed "unscalled" from the 75dpi  and 100dpi font lines in the 
/etc/X11/fs/config   file. It did not help. I get the following error
 
Error in title(main = "January Pie Sales", cex.main = 1.8, font.main = 1) :
        X11 font at size 22 could not be loaded

I'd appreciate any suggestions.
-- 
Robert Molzon
Department of Mathematics
University of Kentucky
859 257-1480

From ripley at stats.ox.ac.uk  Tue Mar 22 22:34:26 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 22 22:34:37 2005
Subject: [Rd] make install fails with makeinfo < 4.7
In-Reply-To: <42408A18.90800@jhsph.edu>
References: <424065F4.3040809@jhsph.edu>
	<Pine.LNX.4.61.0503221852150.31029@gannet.stats>
	<42408A18.90800@jhsph.edu>
Message-ID: <Pine.LNX.4.61.0503222123290.23496@gannet.stats>

On Tue, 22 Mar 2005, Roger D. Peng wrote:

> Okay, a slight revision.  'make install' works fine when I build from the 
> alpha tarballs (at least today's tarball works).  The error only occurs when 
> I build from SVN sources, both when builddir == srcdir and when the build dir 
> is a separate directory.

Yes, that is intentional.  You are not supposed to be able to build from 
the SVN sources without a working makeinfo:  R-admin says under `Essential 
Programs'

   If you want to build from the R Subversion repository you need Perl,
   @command{makeinfo} and @command{pdflatex}.

which seems unequivocal to me.

>
> -roger
>
> Prof Brian Ripley wrote:
>> On Tue, 22 Mar 2005, Roger D. Peng wrote:
>> 
>>> When I build R-devel (or the alpha snapshots) on a system without makeinfo 
>>> >= 4.7, I get a warning about not being able to build HTML/Info help pages 
>>> after running 'configure' (but 'make' runs smoothly and there are no 
>>> errors). However, when I run 'make install' I get an error, something like
>>> 
>>> make[2]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/html'
>>> make[3]: Entering directory `/home/rpeng/R-local/src/R-devel/doc/manual'
>>> creating doc/html/resources.html
>>> make[3]: *** [../html/resources.html] Error 1
>>> make[3]: Leaving directory `/home/rpeng/R-local/src/R-devel/doc/manual'
>>> installing doc/html ...
>>> make[3]: Entering directory 
>>> `/home/rpeng/R-local/src/R-devel/doc/html/search'
>>> installing doc/html/search ...
>>> make[3]: Leaving directory 
>>> `/home/rpeng/R-local/src/R-devel/doc/html/search'
>>> /usr/bin/install: cannot stat `resources.html': No such file or directory
>>> make[2]: *** [install] Error 1
>>> [... more errors ...]
>>> 
>>> Am I correct in assuming that I get this because I don't have the correct 
>>> makeinfo version?
>> 
>> 
>> No.  The intention is that file should be in the tarball.  It seems to be.
>> Are you using builddir == srcdir or not?  Both seem to work for me.
>> 
>> The line
>> 
>>> creating doc/html/resources.html
>> 
>> 
>> should not occur when building from a tarball, as it comes from
>> 
>>     @if test ! -f "$(srcdir)/resources.html" || test -f non-tarball ; then 
>> \
>>       (cd ../manual && $(MAKE) html-non-svn) ; \
>>       touch non-tarball ; \
>> 
>> Have you perchance previously built from an SVN checkout in the same dir?
>> 
>>> If so, is this the intended behavior of 'make install'?  I figured I 
>>> should be able to install R even if I couldn't build the HTML/Info help 
>>> pages, but....
>> 
>> 
>> If building from a tarball, yes.  The requirements for building from an SVN 
>> checkout are more stringent.
>> 
>
> -- 
> Roger D. Peng
> http://www.biostat.jhsph.edu/~rpeng/
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From w.northcott at unsw.edu.au  Wed Mar 23 00:19:22 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Wed Mar 23 00:19:33 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
	<3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
Message-ID: <8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>

On 23/03/2005, at 12:55 AM, Simon Urbanek wrote:
>> As I see it, the MacOS X behaviour is not IEEE-754 compliant.
>>
>> I had a quick look at the IEEE web site and it seems quite clear that 
>> NaNs should not cause errors, but propagate through calculations to 
>> be tested at some appropriate (not too frequent) point.
>
> This is not quite correct and in fact irrelevant to the problem you 
> describe. NaNs may or may not signal, depending on how they are used. 
> Certain operations on NaN must signal by the IEEE-754 standard. The 
> error you get is not a trap, and it's not a result of a signal check, 
> either. The whole problem is that depending on which algorithm is 
> used, the NaNs will be used different ways and thus may or may not use 
> signaling operations.

It may not violate the letter of IEEE-754 because matrix calculations 
are not covered, but it certainly violates the spirit that arithmetic 
should be robust and programs should not halt on these sorts of errors.
>
> I don't consider the `solve' error a bug - in fact I would rather get 
> an error telling me that something is wrong (although I agree that the 
> error is misleading - the error given in Linux is a bit more helpful) 
> than getting a wrong result.

You may prefer the error, but it is not in the sprit of robust 
arithmetic. ie
 > d<-matrix(NaN,3,3)
 > f<-solve(d)
Error in solve.default(d) : Lapack routine dgesv: system is exactly 
singular
 > f
Error: Object "f" not found

> If I would mark something in your example as a bug that would be 
> det(m)=0, because it should return NaN (remember, NaN==NaN is FALSE; 
> furthermore if det was calculated inefficiently using Laplace 
> expansion, the result would be NaN according to IEEE rules). det=0 is 
> consistent with the error given, though. Should we check this in R 
> before calling Lapack - if the vector contains NaNs, det/determinant 
> should return NaN right away?

Clearly det(d) returning 0 is wrong.  As a result based on a 
computation including a NaN, it should return NaN.  The spirit of 
IEEE-754 is that the programmer should choose the appropriate point at 
which to check for NaNs.  I would interpret this to mean the R 
programmer not the R library developer.  Surely that is why R provides 
the is.nan function.

 > d
      [,1] [,2] [,3]
[1,]  NaN  NaN  NaN
[2,]  NaN  NaN  NaN
[3,]  NaN  NaN  NaN
 > is.nan(solve(d))
Error in solve.default(d) : Lapack routine dgesv: system is exactly 
singular

This is against the spirit of IEEE-754 because it halts the program.

 > is.nan(det(d))
[1] FALSE

That is plain wrong.

>
> Many functions in R will actually bark at NaN inputs (e.g. qr, eigen, 
> ...) - maybe you're saying that we should check for NaNs in solve 
> before proceeding and raising an error?

However, this problem is in the Apple library not R.

Bill Northcott

From pedro at est.ufpr.br  Wed Mar 23 05:32:57 2005
From: pedro at est.ufpr.br (Pedro Ribeiro de Andrade Neto)
Date: Wed Mar 23 05:32:29 2005
Subject: [Rd] forcing R CMD COMPILE
Message-ID: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>

Hi,

I am developing a package with a lot of C++ code, and I have a question
about R CMD COMPILE. As I can see, when the package's Makefile calls

R CMD COMPILE foo.cpp

R verifies if foo.o exists, and if it is up to date (last modified after
foo.cpp's last), trying to avoid recompile foo.cpp. But __all__ my files
have other dependencies (at least a .h). The Makefile verifies it, and
calls COMPILE only when it is sure that foo.o is not up to dated. The
problem occours, for example, if I modify only foo.h, and then compile
again. R will say that foo.o is up to date, but it is not true.

Is there any way to force R CMD COMPILE?? Well, I can remove the .o file
before COMPILE, but I think R could do something about it...

Thanks,

Pedro Andrade

--
LEG - Laboratrio de Estatstica e Geoinforma玢o
          http://www.est.ufpr.br/leg/
          Departamento de Estatstica
        Universidade Federal do Paran

From ripley at stats.ox.ac.uk  Wed Mar 23 08:55:07 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 08:55:19 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
Message-ID: <Pine.LNX.4.61.0503230744450.29643@gannet.stats>

On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:

> I am developing a package with a lot of C++ code, and I have a question
> about R CMD COMPILE. As I can see, when the package's Makefile calls
>
> R CMD COMPILE foo.cpp

Why does your package have a Makefile?  And why is it calling COMPILE and 
not SHLIB?

> R verifies if foo.o exists, and if it is up to date (last modified after
> foo.cpp's last), trying to avoid recompile foo.cpp.

Not quite: COMPILE is a make facility, and it calls make with its own 
Makefiles.  This does not seem appropriate to your usage.

> But __all__ my files have other dependencies (at least a .h). The 
> Makefile verifies it, and calls COMPILE only when it is sure that foo.o 
> is not up to dated. The problem occours, for example, if I modify only 
> foo.h, and then compile again. R will say that foo.o is up to date, but 
> it is not true.
>
> Is there any way to force R CMD COMPILE?? Well, I can remove the .o file
> before COMPILE, but I think R could do something about it...

Better not to use R CMD COMPILE.  R itself does not (AFAICS): it is there 
for S-PLUS compatibility.  It seems only ROracle on CRAN does.

Note that R CMD INSTALL is usually called on fresh sources (an unpacked 
tarball) so dependencies are not usually an issue.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Wed Mar 23 08:56:01 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Mar 23 08:56:08 2005
Subject: [Rd] sub('^', .....) bugs (PR#7742)
Message-ID: <20050323075601.0C916BAF4@slim.kubism.ku.dk>

>>>>> "David" == David Forrest <drf5n@maplepark.com>
>>>>>     on Tue, 22 Mar 2005 15:02:20 -0600 (CST) writes:

    David> According to help(sub), the ^ should match the
    David> zero-length string at the beginning of a string:

yes, indeed.

    David> sub('^','var',1:3) # "1" "2" "3"
    David> sub('$','var',1:3) # "1var" "2var" "3var"

    David> # This generates what I expected from the first case:
    David> sub('^.','var',11:13)  # "var1" "var2" "var3"

there are even more fishy things here:

1) In your cases, the integer 'x' argument is auto-coerced to
   character, however that fails as soon as  'perl = TRUE' is used.

 > sub('^','v_', 1:3, perl=TRUE)
 Error in sub.perl(pattern, replacement, x, ignore.case) : 
	 invalid argument

 {one can argue that this is not a bug, since the help file asks
  for 'x' to be a character vector; OTOH, we have
  as.character(.) magic in many other places, i.e. quite
  naturally here;  
  at least  perl=TRUE and perl=FALSE should behave consistently.}


2) The 'perl=TRUE' case behaves even more problematically here:

  > sub('^','v_', LETTERS[1:3], perl=TRUE)
  [1] "A\0e" "B\0J" "C\0S"
  > sub('^','v_', LETTERS[1:3], perl=TRUE)
  [1] "A\0J" "B\0P" "C\0J"
  > sub('^','v_', LETTERS[1:3], perl=TRUE)
  [1] "A\0\0" "B\0\0" "C\0m" 
  >

 i.e., the result is random nonsense.

Note that this happens both for R-patched (2.0.1)  and R-devel (2.1.0 alpha).

==> "forwarded" as bug report to R-bugs

From maechler at stat.math.ethz.ch  Wed Mar 23 09:04:32 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed Mar 23 09:04:42 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
	<3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
	<8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
Message-ID: <16961.8976.904601.424635@stat.math.ethz.ch>

>>>>> "Bill" == Bill Northcott <w.northcott@unsw.edu.au>
>>>>>     on Wed, 23 Mar 2005 10:19:22 +1100 writes:

    Bill> On 23/03/2005, at 12:55 AM, Simon Urbanek wrote:
    >>> As I see it, the MacOS X behaviour is not IEEE-754 compliant.
    >>> 
    >>> I had a quick look at the IEEE web site and it seems quite clear that 
    >>> NaNs should not cause errors, but propagate through calculations to 
    >>> be tested at some appropriate (not too frequent) point.
    >> 
    >> This is not quite correct and in fact irrelevant to the problem you 
    >> describe. NaNs may or may not signal, depending on how they are used. 
    >> Certain operations on NaN must signal by the IEEE-754 standard. The 
    >> error you get is not a trap, and it's not a result of a signal check, 
    >> either. The whole problem is that depending on which algorithm is 
    >> used, the NaNs will be used different ways and thus may or may not use 
    >> signaling operations.

    Bill> It may not violate the letter of IEEE-754 because matrix calculations 
    Bill> are not covered, but it certainly violates the spirit that arithmetic 
    Bill> should be robust and programs should not halt on these sorts of errors.
    >> 
    >> I don't consider the `solve' error a bug - in fact I would rather get 
    >> an error telling me that something is wrong (although I agree that the 
    >> error is misleading - the error given in Linux is a bit more helpful) 
    >> than getting a wrong result.

    Bill> You may prefer the error, but it is not in the sprit of robust 
    Bill> arithmetic. ie
    >> d<-matrix(NaN,3,3)
    >> f<-solve(d)
    Bill> Error in solve.default(d) : Lapack routine dgesv: system is exactly 
    Bill> singular
    >> f
    Bill> Error: Object "f" not found

    >> If I would mark something in your example as a bug that would be 
    >> det(m)=0, because it should return NaN (remember, NaN==NaN is FALSE; 
    >> furthermore if det was calculated inefficiently using Laplace 
    >> expansion, the result would be NaN according to IEEE rules). det=0 is 
    >> consistent with the error given, though. Should we check this in R 
    >> before calling Lapack - if the vector contains NaNs, det/determinant 
    >> should return NaN right away?

    Bill> Clearly det(d) returning 0 is wrong.  As a result based on a 
    Bill> computation including a NaN, it should return NaN.  The spirit of 
    Bill> IEEE-754 is that the programmer should choose the appropriate point at 
    Bill> which to check for NaNs.  I would interpret this to mean the R 
    Bill> programmer not the R library developer.  Surely that is why R provides 
    Bill> the is.nan function.

    >> d
    Bill> [,1] [,2] [,3]
    Bill> [1,]  NaN  NaN  NaN
    Bill> [2,]  NaN  NaN  NaN
    Bill> [3,]  NaN  NaN  NaN
    >> is.nan(solve(d))
    Bill> Error in solve.default(d) : Lapack routine dgesv: system is exactly 
    Bill> singular

    Bill> This is against the spirit of IEEE-754 because it halts the program.

    >> is.nan(det(d))
    Bill> [1] FALSE

    Bill> That is plain wrong.

    >> 
    >> Many functions in R will actually bark at NaN inputs (e.g. qr, eigen, 
    >> ...) - maybe you're saying that we should check for NaNs in solve 
    >> before proceeding and raising an error?

    Bill> However, this problem is in the Apple library not R.

    Bill> Bill Northcott

Indeed!

I pretty much entirely agree with your points, Bill, and would
tend to declare that this Apple library is ``broken''
for building a correctly running R.

Let me ask one question I've been wondering about now for a
while:

  Did you run "make check" after building R,
  and "make check" ran to completion without an error?

If yes (which I doubt quite a bit), there *is* a bug in R's
quality control / quality assurance tools -- and I would want to
add a check for the misbehavior you've mentioned.

Martin Maechler, ETH Zurich

From ripley at stats.ox.ac.uk  Wed Mar 23 10:07:47 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 10:07:59 2005
Subject: [Rd] sub('^', .....) bugs (PR#7742)
In-Reply-To: <20050323075601.0C916BAF4@slim.kubism.ku.dk>
References: <20050323075601.0C916BAF4@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503230900490.31124@gannet.stats>

On Wed, 23 Mar 2005 maechler@stat.math.ethz.ch wrote:

> 1) In your cases, the integer 'x' argument is auto-coerced to
>   character, however that fails as soon as  'perl = TRUE' is used.
>
> > sub('^','v_', 1:3, perl=TRUE)
> Error in sub.perl(pattern, replacement, x, ignore.case) :
> 	 invalid argument
>
> {one can argue that this is not a bug, since the help file asks
>  for 'x' to be a character vector; OTOH, we have
>  as.character(.) magic in many other places, i.e. quite
>  naturally here;
>  at least  perl=TRUE and perl=FALSE should behave consistently.}

I believe the bug is in the PERL=FALSE case.  This coercion is 
undocumented, and e.g.

> grep('^1', 1:3, perl=TRUE)
Error in grep.perl(pattern, x, ignore.case, value, useBytes) :
         invalid argument
> grep('^1', 1:3, perl=FALSE)
Error in grep(pattern, x, ignore.case, extended, value, fixed, useBytes) :
         invalid argument

do not accept non-character arguments.  The only one that does AFAICS is 
[g]sub(perl=FALSE), and the other functions like tolower, substr, 
strsplit, chartr, agrep do not.

The consistent thing to do seems to be to remove the anomalous coercion.
Otherwise we need to at least change grep and regexpr.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Wed Mar 23 10:45:16 2005
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Mar 23 10:48:01 2005
Subject: [Rd] sub('^', .....) bugs (PR#7742)
References: <20050323075601.0C916BAF4@slim.kubism.ku.dk>
Message-ID: <loom.20050323T103652-484@post.gmane.org>

 <maechler <at> stat.math.ethz.ch> writes:

: 
: >>>>> "David" == David Forrest <drf5n <at> maplepark.com>
: >>>>>     on Tue, 22 Mar 2005 15:02:20 -0600 (CST) writes:
: 
:     David> According to help(sub), the ^ should match the
:     David> zero-length string at the beginning of a string:
: 
: yes, indeed.
: 
:     David> sub('^','var',1:3) # "1" "2" "3"
:     David> sub('$','var',1:3) # "1var" "2var" "3var"
: 
:     David> # This generates what I expected from the first case:
:     David> sub('^.','var',11:13)  # "var1" "var2" "var3"
: 
: there are even more fishy things here:
: 
: 1) In your cases, the integer 'x' argument is auto-coerced to
:    character, however that fails as soon as  'perl = TRUE' is used.
: 
:  > sub('^','v_', 1:3, perl=TRUE)
:  Error in sub.perl(pattern, replacement, x, ignore.case) : 
: 	 invalid argument
: 
:  {one can argue that this is not a bug, since the help file asks
:   for 'x' to be a character vector; OTOH, we have
:   as.character(.) magic in many other places, i.e. quite
:   naturally here;  
:   at least  perl=TRUE and perl=FALSE should behave consistently.}
: 
: 2) The 'perl=TRUE' case behaves even more problematically here:
: 
:   > sub('^','v_', LETTERS[1:3], perl=TRUE)
:   [1] "A\0e" "B\0J" "C\0S"
:   > sub('^','v_', LETTERS[1:3], perl=TRUE)
:   [1] "A\0J" "B\0P" "C\0J"
:   > sub('^','v_', LETTERS[1:3], perl=TRUE)
:   [1] "A\0\0" "B\0\0" "C\0m" 
:   >
: 
:  i.e., the result is random nonsense.
: 
: Note that this happens both for R-patched (2.0.1)  and R-devel (2.1.0 alpha).
: 
: ==> "forwarded" as bug report to R-bugs

Also consider the following which may be related.  #1 does not
place an X before the first word and #2 causes R to hang.

R> R.version.string # Windows XP
[1] "R version 2.1.0, 2005-03-17"

R> gsub("\\b", "X", "The quick brown fox") # 1
[1] "The Xquick Xbrown Xfox"

R> gsub("\\b", "X", "The quick brown fox", perl = TRUE) # 2
... hangs ...

From ripley at stats.ox.ac.uk  Wed Mar 23 11:34:30 2005
From: ripley at stats.ox.ac.uk (Brian D Ripley)
Date: Wed Mar 23 11:34:40 2005
Subject: [Rd] sub('^', .....) bugs (PR#7742)
In-Reply-To: <loom.20050323T103652-484@post.gmane.org>
Message-ID: <Pine.GSO.4.31.0503231016120.27248-100000@markov.stats>

The first is as designed: zero-length initial matches are ignored in the C
code.  (Don't ask me why it was designed that way.)

The second is not reproducible in the current sources, so is probably
already fixed by the fix to PR#7742.

On Wed, 23 Mar 2005, Gabor Grothendieck wrote:

>  <maechler <at> stat.math.ethz.ch> writes:
>
> :
> : >>>>> "David" == David Forrest <drf5n <at> maplepark.com>
> : >>>>>     on Tue, 22 Mar 2005 15:02:20 -0600 (CST) writes:
> :
> :     David> According to help(sub), the ^ should match the
> :     David> zero-length string at the beginning of a string:
> :
> : yes, indeed.
> :
> :     David> sub('^','var',1:3) # "1" "2" "3"
> :     David> sub('$','var',1:3) # "1var" "2var" "3var"
> :
> :     David> # This generates what I expected from the first case:
> :     David> sub('^.','var',11:13)  # "var1" "var2" "var3"
> :
> : there are even more fishy things here:
> :
> : 1) In your cases, the integer 'x' argument is auto-coerced to
> :    character, however that fails as soon as  'perl = TRUE' is used.
> :
> :  > sub('^','v_', 1:3, perl=TRUE)
> :  Error in sub.perl(pattern, replacement, x, ignore.case) :
> : 	 invalid argument
> :
> :  {one can argue that this is not a bug, since the help file asks
> :   for 'x' to be a character vector; OTOH, we have
> :   as.character(.) magic in many other places, i.e. quite
> :   naturally here;
> :   at least  perl=TRUE and perl=FALSE should behave consistently.}
> :
> : 2) The 'perl=TRUE' case behaves even more problematically here:
> :
> :   > sub('^','v_', LETTERS[1:3], perl=TRUE)
> :   [1] "A\0e" "B\0J" "C\0S"
> :   > sub('^','v_', LETTERS[1:3], perl=TRUE)
> :   [1] "A\0J" "B\0P" "C\0J"
> :   > sub('^','v_', LETTERS[1:3], perl=TRUE)
> :   [1] "A\0\0" "B\0\0" "C\0m"
> :   >
> :
> :  i.e., the result is random nonsense.
> :
> : Note that this happens both for R-patched (2.0.1)  and R-devel (2.1.0 alpha).
> :
> : ==> "forwarded" as bug report to R-bugs
>
> Also consider the following which may be related.  #1 does not
> place an X before the first word and #2 causes R to hang.
>
> R> R.version.string # Windows XP
> [1] "R version 2.1.0, 2005-03-17"
>
> R> gsub("\\b", "X", "The quick brown fox") # 1
> [1] "The Xquick Xbrown Xfox"
>
> R> gsub("\\b", "X", "The quick brown fox", perl = TRUE) # 2
> ... hangs ...
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From w.northcott at unsw.edu.au  Wed Mar 23 14:06:33 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Wed Mar 23 14:06:57 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <16961.8976.904601.424635@stat.math.ethz.ch>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
	<3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
	<8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
	<16961.8976.904601.424635@stat.math.ethz.ch>
Message-ID: <3f3b0408f7702961dfaa199f9d559c04@unsw.edu.au>

On 23/03/2005, at 7:04 PM, Martin Maechler wrote:
> I pretty much entirely agree with your points, Bill, and would
> tend to declare that this Apple library is ``broken''
> for building a correctly running R.
>
Thanks for that.

> Let me ask one question I've been wondering about now for a
> while:
>
>   Did you run "make check" after building R,
>   and "make check" ran to completion without an error?

The thought occurred to me as well.  So I tried to run it, but I could 
not get it to run.  It was a couple of months ago I built this version 
of R, and maybe I trashed something.   Time ran out, and I had to go 
and earn a living.

I will try again, and report the results.
>
> If yes (which I doubt quite a bit), there *is* a bug in R's
> quality control / quality assurance tools -- and I would want to
> add a check for the misbehavior you've mentioned.

I would also be surprised if it runs without error.

I don't really understand LAPACK enough.  I started reading and trying 
to work out how to produce test cases which I could submit to Apple as 
a bug or bugs.

Bill

From ripley at stats.ox.ac.uk  Wed Mar 23 16:52:51 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 16:52:59 2005
Subject: [Rd] sub('^', .....) bugs (PR#7742)
In-Reply-To: <Pine.GSO.4.31.0503231016120.27248-100000@markov.stats>
References: <Pine.GSO.4.31.0503231016120.27248-100000@markov.stats>
Message-ID: <Pine.LNX.4.61.0503231547130.15035@gannet.stats>

On Wed, 23 Mar 2005, Brian D Ripley wrote:

> The first is as designed: zero-length initial matches are ignored in the C
> code.  (Don't ask me why it was designed that way.)
>
> The second is not reproducible in the current sources, so is probably
> already fixed by the fix to PR#7742.

I've found a better solution for the perl=T internal code:

> gsub("\\b", "X", "The quick brown fox", perl = TRUE)
[1] "XTheX XquickX XbrownX XfoxX"

but not yet for the standard case, because of the design limitations.


> On Wed, 23 Mar 2005, Gabor Grothendieck wrote:
>
>>  <maechler <at> stat.math.ethz.ch> writes:
>>
>> :
>> : >>>>> "David" == David Forrest <drf5n <at> maplepark.com>
>> : >>>>>     on Tue, 22 Mar 2005 15:02:20 -0600 (CST) writes:
>> :
>> :     David> According to help(sub), the ^ should match the
>> :     David> zero-length string at the beginning of a string:
>> :
>> : yes, indeed.
>> :
>> :     David> sub('^','var',1:3) # "1" "2" "3"
>> :     David> sub('$','var',1:3) # "1var" "2var" "3var"
>> :
>> :     David> # This generates what I expected from the first case:
>> :     David> sub('^.','var',11:13)  # "var1" "var2" "var3"
>> :
>> : there are even more fishy things here:
>> :
>> : 1) In your cases, the integer 'x' argument is auto-coerced to
>> :    character, however that fails as soon as  'perl = TRUE' is used.
>> :
>> :  > sub('^','v_', 1:3, perl=TRUE)
>> :  Error in sub.perl(pattern, replacement, x, ignore.case) :
>> : 	 invalid argument
>> :
>> :  {one can argue that this is not a bug, since the help file asks
>> :   for 'x' to be a character vector; OTOH, we have
>> :   as.character(.) magic in many other places, i.e. quite
>> :   naturally here;
>> :   at least  perl=TRUE and perl=FALSE should behave consistently.}
>> :
>> : 2) The 'perl=TRUE' case behaves even more problematically here:
>> :
>> :   > sub('^','v_', LETTERS[1:3], perl=TRUE)
>> :   [1] "A\0e" "B\0J" "C\0S"
>> :   > sub('^','v_', LETTERS[1:3], perl=TRUE)
>> :   [1] "A\0J" "B\0P" "C\0J"
>> :   > sub('^','v_', LETTERS[1:3], perl=TRUE)
>> :   [1] "A\0\0" "B\0\0" "C\0m"
>> :   >
>> :
>> :  i.e., the result is random nonsense.
>> :
>> : Note that this happens both for R-patched (2.0.1)  and R-devel (2.1.0 alpha).
>> :
>> : ==> "forwarded" as bug report to R-bugs
>>
>> Also consider the following which may be related.  #1 does not
>> place an X before the first word and #2 causes R to hang.
>>
>> R> R.version.string # Windows XP
>> [1] "R version 2.1.0, 2005-03-17"
>>
>> R> gsub("\\b", "X", "The quick brown fox") # 1
>> [1] "The Xquick Xbrown Xfox"
>>
>> R> gsub("\\b", "X", "The quick brown fox", perl = TRUE) # 2
>> ... hangs ...
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pedro at est.ufpr.br  Wed Mar 23 18:00:04 2005
From: pedro at est.ufpr.br (Pedro Ribeiro de Andrade Neto)
Date: Wed Mar 23 17:59:30 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.61.0503230744450.29643@gannet.stats>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
	<Pine.LNX.4.61.0503230744450.29643@gannet.stats>
Message-ID: <Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>


On Wed, 23 Mar 2005, Prof Brian Ripley wrote:

> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
>
> > I am developing a package with a lot of C++ code, and I have a question
> > about R CMD COMPILE. As I can see, when the package's Makefile calls
> >
> > R CMD COMPILE foo.cpp
>
> Why does your package have a Makefile?  And why is it calling COMPILE and
> not SHLIB?
>

My package has a Makefile because I need to compile 16 .cpp files. After
it, I call R CMD SHLIB.

> > R verifies if foo.o exists, and if it is up to date (last modified after
> > foo.cpp's last), trying to avoid recompile foo.cpp.
>
> Not quite: COMPILE is a make facility, and it calls make with its own
> Makefiles.  This does not seem appropriate to your usage.
>
> > But __all__ my files have other dependencies (at least a .h). The
> > Makefile verifies it, and calls COMPILE only when it is sure that foo.o
> > is not up to dated. The problem occours, for example, if I modify only
> > foo.h, and then compile again. R will say that foo.o is up to date, but
> > it is not true.
> >
> > Is there any way to force R CMD COMPILE?? Well, I can remove the .o file
> > before COMPILE, but I think R could do something about it...
>
> Better not to use R CMD COMPILE.  R itself does not (AFAICS): it is there
> for S-PLUS compatibility.  It seems only ROracle on CRAN does.
>
> Note that R CMD INSTALL is usually called on fresh sources (an unpacked
> tarball) so dependencies are not usually an issue.
>

OK. So I have to compile them with g++ implicitly (instead of using R CMD
COMPILE), and then call R CMD SHLIB.

Thanks,

Pedro Andrade

>
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>

--
LEG - Laboratorio de Estatistica e Geoinformacao
          http://www.est.ufpr.br/leg/
          Departamento de Estatistica
        Universidade Federal do Parana

From ripley at stats.ox.ac.uk  Wed Mar 23 18:05:22 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 18:05:33 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
	<Pine.LNX.4.61.0503230744450.29643@gannet.stats>
	<Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
Message-ID: <Pine.LNX.4.61.0503231703450.30989@gannet.stats>

On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:

>
> On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
>
>> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
>>
>>> I am developing a package with a lot of C++ code, and I have a question
>>> about R CMD COMPILE. As I can see, when the package's Makefile calls
>>>
>>> R CMD COMPILE foo.cpp
>>
>> Why does your package have a Makefile?  And why is it calling COMPILE and
>> not SHLIB?
>>
>
> My package has a Makefile because I need to compile 16 .cpp files. After
> it, I call R CMD SHLIB.

R CMD SHLIB would do that for you.  Many packages using multiple .cpp 
files have no Makefile.  Please study the many examples on CRAN.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From roebuck at odin.mdacc.tmc.edu  Wed Mar 23 18:29:37 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Wed Mar 23 18:29:48 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br><Pine.LNX.4.61.
	0503230744450.29643@gannet.stats>
	<Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
Message-ID: <Pine.OSF.4.58.0503231123130.406038@odin.mdacc.tmc.edu>

On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:

> On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
>
> > On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
> >
> > > I am developing a package with a lot of C++ code, and I have a question
> > > about R CMD COMPILE. As I can see, when the package's Makefile calls
> > >
> > > R CMD COMPILE foo.cpp
> >
> > Why does your package have a Makefile?  And why is it calling COMPILE and
> > not SHLIB?
>
> My package has a Makefile because I need to compile 16 .cpp files. After
> it, I call R CMD SHLIB.
>
> > > R verifies if foo.o exists, and if it is up to date (last modified after
> > > foo.cpp's last), trying to avoid recompile foo.cpp.
> >
> > Not quite: COMPILE is a make facility, and it calls make with its own
> > Makefiles.  This does not seem appropriate to your usage.
> >
> > > But __all__ my files have other dependencies (at least a .h). The
> > > Makefile verifies it, and calls COMPILE only when it is sure that foo.o
> > > is not up to dated. The problem occours, for example, if I modify only
> > > foo.h, and then compile again. R will say that foo.o is up to date, but
> > > it is not true.
> > >
> > > Is there any way to force R CMD COMPILE?? Well, I can remove the .o file
> > > before COMPILE, but I think R could do something about it...
> >
> > Better not to use R CMD COMPILE.  R itself does not (AFAICS): it is there
> > for S-PLUS compatibility.  It seems only ROracle on CRAN does.
> >
> > Note that R CMD INSTALL is usually called on fresh sources (an unpacked
> > tarball) so dependencies are not usually an issue.
> >
>
> OK. So I have to compile them with g++ implicitly (instead of using R CMD
> COMPILE), and then call R CMD SHLIB.

If you have your own makefile, why not just add a 'depend'
target?

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From stefano.iacus at unimi.it  Wed Mar 23 18:51:57 2005
From: stefano.iacus at unimi.it (stefano iacus)
Date: Wed Mar 23 18:52:15 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <16961.8976.904601.424635@stat.math.ethz.ch>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
	<3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
	<8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
	<16961.8976.904601.424635@stat.math.ethz.ch>
Message-ID: <798092b110803c9ce238a205621dd7cc@unimi.it>


On 23/mar/05, at 09:04, Martin Maechler wrote:

>>>>>> "Bill" == Bill Northcott <w.northcott@unsw.edu.au>
>>>>>>     on Wed, 23 Mar 2005 10:19:22 +1100 writes:
>
>     Bill> On 23/03/2005, at 12:55 AM, Simon Urbanek wrote:
>>>> As I see it, the MacOS X behaviour is not IEEE-754 compliant.
>>>>
>>>> I had a quick look at the IEEE web site and it seems quite clear 
>>>> that
>>>> NaNs should not cause errors, but propagate through calculations to
>>>> be tested at some appropriate (not too frequent) point.
>>>
>>> This is not quite correct and in fact irrelevant to the problem you
>>> describe. NaNs may or may not signal, depending on how they are used.
>>> Certain operations on NaN must signal by the IEEE-754 standard. The
>>> error you get is not a trap, and it's not a result of a signal check,
>>> either. The whole problem is that depending on which algorithm is
>>> used, the NaNs will be used different ways and thus may or may not 
>>> use
>>> signaling operations.
>
>     Bill> It may not violate the letter of IEEE-754 because matrix 
> calculations
>     Bill> are not covered, but it certainly violates the spirit that 
> arithmetic
>     Bill> should be robust and programs should not halt on these sorts 
> of errors.
>>>
>>> I don't consider the `solve' error a bug - in fact I would rather get
>>> an error telling me that something is wrong (although I agree that 
>>> the
>>> error is misleading - the error given in Linux is a bit more helpful)
>>> than getting a wrong result.
>
>     Bill> You may prefer the error, but it is not in the sprit of 
> robust
>     Bill> arithmetic. ie
>>> d<-matrix(NaN,3,3)
>>> f<-solve(d)
>     Bill> Error in solve.default(d) : Lapack routine dgesv: system is 
> exactly
>     Bill> singular
>>> f
>     Bill> Error: Object "f" not found
>
>>> If I would mark something in your example as a bug that would be
>>> det(m)=0, because it should return NaN (remember, NaN==NaN is FALSE;
>>> furthermore if det was calculated inefficiently using Laplace
>>> expansion, the result would be NaN according to IEEE rules). det=0 is
>>> consistent with the error given, though. Should we check this in R
>>> before calling Lapack - if the vector contains NaNs, det/determinant
>>> should return NaN right away?
>
>     Bill> Clearly det(d) returning 0 is wrong.  As a result based on a
>     Bill> computation including a NaN, it should return NaN.  The 
> spirit of
>     Bill> IEEE-754 is that the programmer should choose the 
> appropriate point at
>     Bill> which to check for NaNs.  I would interpret this to mean the 
> R
>     Bill> programmer not the R library developer.  Surely that is why 
> R provides
>     Bill> the is.nan function.
>
>>> d
>     Bill> [,1] [,2] [,3]
>     Bill> [1,]  NaN  NaN  NaN
>     Bill> [2,]  NaN  NaN  NaN
>     Bill> [3,]  NaN  NaN  NaN
>>> is.nan(solve(d))
>     Bill> Error in solve.default(d) : Lapack routine dgesv: system is 
> exactly
>     Bill> singular
>
>     Bill> This is against the spirit of IEEE-754 because it halts the 
> program.
>
>>> is.nan(det(d))
>     Bill> [1] FALSE
>
>     Bill> That is plain wrong.
>
>>>
>>> Many functions in R will actually bark at NaN inputs (e.g. qr, eigen,
>>> ...) - maybe you're saying that we should check for NaNs in solve
>>> before proceeding and raising an error?
>
>     Bill> However, this problem is in the Apple library not R.
>
>     Bill> Bill Northcott
>
> Indeed!
>
> I pretty much entirely agree with your points, Bill, and would
> tend to declare that this Apple library is ``broken''
> for building a correctly running R.
>
> Let me ask one question I've been wondering about now for a
> while:
>
>   Did you run "make check" after building R,
>   and "make check" ran to completion without an error?

Martin,
the use vecLib was (since now?) the suggested way to build R on OS X 
with blas support.
This is the way OS X binaries are distributed and of course they pass 
make check (I've checked again just now and both 2.0.0 and r-devel pass 
make check) so probably the NaN is a special case with don't test for 
LAPACK?
stefano


>
> If yes (which I doubt quite a bit), there *is* a bug in R's
> quality control / quality assurance tools -- and I would want to
> add a check for the misbehavior you've mentioned.
>
> Martin Maechler, ETH Zurich
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From simon.urbanek at r-project.org  Wed Mar 23 19:28:09 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed Mar 23 19:28:28 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
	<3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
	<8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
Message-ID: <8F4C141E-635D-4447-ABBE-27175C0AC676@r-project.org>

On Mar 22, 2005, at 6:19 PM, Bill Northcott wrote:

> On 23/03/2005, at 12:55 AM, Simon Urbanek wrote:
>
> You may prefer the error, but it is not in the sprit of robust  
> arithmetic. ie
> > d<-matrix(NaN,3,3)
> > f<-solve(d)
> Error in solve.default(d) : Lapack routine dgesv: system is exactly  
> singular
> > f
> Error: Object "f" not found

For the record: this is the behavior on all platforms I tested (Mac,  
Linux, IRIX) - the only platform with a different result is  
reportedly Windows. So what I was saying is that this is not  
"IEEE-754 non-compliance of MacOS X" as you put it.

> Clearly det(d) returning 0 is wrong.  As a result based on a  
> computation including a NaN, it should return NaN.

That's exactly what I was pointing out, and, yes, this is a bug in  
vecLib.

@Martin: I guess the most simple test for this would be probably
is.nan(det(matrix(NaN,2,2)))

>> Many functions in R will actually bark at NaN inputs (e.g. qr,  
>> eigen, ...) - maybe you're saying that we should check for NaNs in  
>> solve before proceeding and raising an error?
>
> However, this problem is in the Apple library not R.

Since you're referencing the "solve" problem here, again, it's not.

As I was explaining the the previous e-mail, there are at least two  
completely separate issues - handling of NaNs in solve and  
determinant of NaN matrices. The latter is a bug in vecLib, the first  
one is not an OS X specific problem. Many R functions will object to  
taking NaN inputs such as qr.solve which was the previous  
implementation of solve. At any rate this is error handling in R and  
not Lapack. The "example" on the top doesn't make any sense because  
when you type "f" you know that it doesn't exist and both are R  
errors. If you used that in a script you have both choices: abort and  
that point or continue with whatever fallback you choose.

Cheers,
Simon

From ripley at stats.ox.ac.uk  Wed Mar 23 20:28:11 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 20:28:19 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <8F4C141E-635D-4447-ABBE-27175C0AC676@r-project.org>
References: <200503211109.j2LB9Kbe018532@hypatia.math.ethz.ch>
	<098c2dce898207218d3e518868d7ffec@unsw.edu.au>
	<3E86E6D3-BB0E-42A1-A4BE-D00EF2F5C0EA@r-project.org>
	<8d7b823ac46177052ba1cac59b6cba22@unsw.edu.au>
	<8F4C141E-635D-4447-ABBE-27175C0AC676@r-project.org>
Message-ID: <Pine.LNX.4.61.0503231913330.32423@gannet.stats>

On Wed, 23 Mar 2005, Simon Urbanek wrote:

> On Mar 22, 2005, at 6:19 PM, Bill Northcott wrote:
>
>> On 23/03/2005, at 12:55 AM, Simon Urbanek wrote:
>> 
>> You may prefer the error, but it is not in the sprit of robust arithmetic. 
>> ie
>> > d<-matrix(NaN,3,3)
>> > f<-solve(d)
>> Error in solve.default(d) : Lapack routine dgesv: system is exactly 
>> singular
>> > f
>> Error: Object "f" not found
>
> For the record: this is the behavior on all platforms I tested (Mac, Linux, 
> IRIX) - the only platform with a different result is reportedly Windows. So 
> what I was saying is that this is not "IEEE-754 non-compliance of MacOS X" as 
> you put it.

Hmm: all the platforms I have tested using R's internal blas and some 
with external BLASes pass this test.  Only those with ATLAS and Goto 
BLAS' fail for me.

>> Clearly det(d) returning 0 is wrong.  As a result based on a computation 
>> including a NaN, it should return NaN.
>
> That's exactly what I was pointing out, and, yes, this is a bug in vecLib.
>
> @Martin: I guess the most simple test for this would be probably
> is.nan(det(matrix(NaN,2,2)))
>
>>> Many functions in R will actually bark at NaN inputs (e.g. qr, eigen, ...) 
>>> - maybe you're saying that we should check for NaNs in solve before 
>>> proceeding and raising an error?
>> 
>> However, this problem is in the Apple library not R.
>
> Since you're referencing the "solve" problem here, again, it's not.
>
> As I was explaining the the previous e-mail, there are at least two 
> completely separate issues - handling of NaNs in solve and determinant of NaN 
> matrices. The latter is a bug in vecLib, the first one is not an OS X 
> specific problem.

No, but it does appears to be an external BLAS-specific problem.

> Many R functions will object to taking NaN inputs such as qr.solve which 
> was the previous implementation of solve. At any rate this is error 
> handling in R and not Lapack. The "example" on the top doesn't make any 
> sense because when you type "f" you know that it doesn't exist and both 
> are R errors. If you used that in a script you have both choices: abort 
> and that point or continue with whatever fallback you choose.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From apjaworski at mmm.com  Wed Mar 23 21:13:11 2005
From: apjaworski at mmm.com (apjaworski@mmm.com)
Date: Wed Mar 23 21:13:24 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <Pine.LNX.4.61.0503231913330.32423@gannet.stats>
Message-ID: <OF5B137690.D5CDB827-ON86256FCD.006E2351-86256FCD.006F1217@mmm.com>






I just tested this problem on a Windows 2000 Pro P4-Xeon system.  I tried
this in patched 2.0.1 (2005-2-28) and 2.1.0-alpha (2005-3-23) with both
generic BLAS and precompiled ATLAS BLAS dll (downloaded from CRAN windows
binaries).  In all 4 combinations I get

> d<-matrix(NaN,3,3)
> f<-solve(d)
> f
     [,1] [,2] [,3]
[1,]  NaN  NaN  NaN
[2,]  NaN  NaN  NaN
[3,]  NaN  NaN  NaN
> det(d)
[1] NaN
>

which, I guess, is what is expected.

Hope this helps,

Andy

__________________________________
Andy Jaworski
518-1-01
Process Laboratory
3M Corporate Research Laboratory
-----
E-mail: apjaworski@mmm.com
Tel:  (651) 733-6092
Fax:  (651) 736-3122


                                                                           
             Prof Brian Ripley                                             
             <ripley@stats.ox.                                             
             ac.uk>                                                     To 
             Sent by:                  Simon Urbanek                       
             r-devel-bounces@s         <simon.urbanek@r-project.org>       
             tat.math.ethz.ch                                           cc 
                                       Martin Maechler                     
                                       <maechler@stat.math.ethz.ch>,       
             03/23/2005 01:28          r-devel@stat.math.ethz.ch           
             PM                                                    Subject 
                                       Re: [Rd] NaN and linear algebra     
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           




On Wed, 23 Mar 2005, Simon Urbanek wrote:

> On Mar 22, 2005, at 6:19 PM, Bill Northcott wrote:
>
>> On 23/03/2005, at 12:55 AM, Simon Urbanek wrote:
>>
>> You may prefer the error, but it is not in the sprit of robust
arithmetic.
>> ie
>> > d<-matrix(NaN,3,3)
>> > f<-solve(d)
>> Error in solve.default(d) : Lapack routine dgesv: system is exactly
>> singular
>> > f
>> Error: Object "f" not found
>
> For the record: this is the behavior on all platforms I tested (Mac,
Linux,
> IRIX) - the only platform with a different result is reportedly Windows.
So
> what I was saying is that this is not "IEEE-754 non-compliance of MacOS
X" as
> you put it.

Hmm: all the platforms I have tested using R's internal blas and some
with external BLASes pass this test.  Only those with ATLAS and Goto
BLAS' fail for me.

>> Clearly det(d) returning 0 is wrong.  As a result based on a computation

>> including a NaN, it should return NaN.
>
> That's exactly what I was pointing out, and, yes, this is a bug in
vecLib.
>
> @Martin: I guess the most simple test for this would be probably
> is.nan(det(matrix(NaN,2,2)))
>
>>> Many functions in R will actually bark at NaN inputs (e.g. qr, eigen,
...)
>>> - maybe you're saying that we should check for NaNs in solve before
>>> proceeding and raising an error?
>>
>> However, this problem is in the Apple library not R.
>
> Since you're referencing the "solve" problem here, again, it's not.
>
> As I was explaining the the previous e-mail, there are at least two
> completely separate issues - handling of NaNs in solve and determinant of
NaN
> matrices. The latter is a bug in vecLib, the first one is not an OS X
> specific problem.

No, but it does appears to be an external BLAS-specific problem.

> Many R functions will object to taking NaN inputs such as qr.solve which
> was the previous implementation of solve. At any rate this is error
> handling in R and not Lapack. The "example" on the top doesn't make any
> sense because when you type "f" you know that it doesn't exist and both
> are R errors. If you used that in a script you have both choices: abort
> and that point or continue with whatever fallback you choose.

--
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From takahama at andrew.cmu.edu  Wed Mar 23 22:16:30 2005
From: takahama at andrew.cmu.edu (takahama@andrew.cmu.edu)
Date: Wed Mar 23 22:16:38 2005
Subject: [Rd] interp.surface() error (PR#7745)
Message-ID: <20050323211630.8F05FBB2C@slim.kubism.ku.dk>

R version: 2.001
OS: Windows XP SP2

When I use the interp.surface() function, on occasion I have encountered 
the following error message:

Error in interp.surface(a, loc) : subscript out of bounds

Since it is somewhat dependent on the data set, I cannot say exactly in 
which cases these occur, but I believe I have found the problem and a 
solution for it:

The scaling calculations in the code,
    lx <- ((nx - 1) * (loc[, 1] - xa))/xr + 1
    ly <- ((ny - 1) * (loc[, 2] - ya))/yr + 1
can lead to numerical error, so in the following lines
    lx1 <- ifelse(lx == nx, nx - 1, trunc(lx))
    ly1 <- ifelse(ly == ny, ny - 1, trunc(ly))
the equality statements which are the first arguments to the IF-ELSE 
statements return false when they are supposed to be true. I believe the 
remedy is to simply avoid absolute equalities, as in the following example 
(which has worked for my problem):
    lx1 <- ifelse(abs(lx - nx) < 1e-10, nx - 1, trunc(lx))
    ly1 <- ifelse(abs(ly - ny) < 1e-10, ny - 1, trunc(ly))

I hope this is an appropriate posting for an error report. Thank you very 
much for your hard work,

Satoshi
_____
Satoshi Takahama
Dept. of Chemical Engineering
Carnegie Mellon University
Pittsburgh, PA 15213
Phone: 412-268-7570

From pedro at est.ufpr.br  Wed Mar 23 22:21:00 2005
From: pedro at est.ufpr.br (Pedro Ribeiro de Andrade Neto)
Date: Wed Mar 23 22:20:23 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.61.0503231703450.30989@gannet.stats>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
	<Pine.LNX.4.61.0503230744450.29643@gannet.stats>
	<Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
	<Pine.LNX.4.61.0503231703450.30989@gannet.stats>
Message-ID: <Pine.LNX.4.58L0.0503231621450.8500@est.ufpr.br>

Let me tell an example.

I found the bayesSurv package in CRAN. It has some .cpp and .h files, and
doesn't have a makefile. I did the following steps:

1. compile the package (R CMD INSTALL)
2. write something in /src/List.cpp (only add an empty line)
3. recompile package (INSTALL)
   it works, OK.
4. write something in /src/List.h
5. recompile
   it does nothing. List.cpp was not changed and so R says List.o is up
   to date, right?

Is there any way to tell R that List.o depends on List.h???

I think it is not an R problem, because Makefiles can check it. My
question is: I know that List.o is not up to dated, because I changed
List.h, and my Makefile recognizes it. But if I tell R to compile List.cpp
again using COMPILE, it will say that the file is up to date, and won't
compile it. So, the only way to check dependencies, as I can see, is using a
Makefile, and compiling .cpp files without any R help. Is it true?

Pedro Andrade

--
LEG - Laboratrio de Estatstica e Geoinforma玢o
          http://www.est.ufpr.br/leg/
          Departamento de Estatstica
        Universidade Federal do Paran

On Wed, 23 Mar 2005, Prof Brian Ripley wrote:

> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
>
> >
> > On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
> >
> >> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
> >>
> >>> I am developing a package with a lot of C++ code, and I have a question
> >>> about R CMD COMPILE. As I can see, when the package's Makefile calls
> >>>
> >>> R CMD COMPILE foo.cpp
> >>
> >> Why does your package have a Makefile?  And why is it calling COMPILE and
> >> not SHLIB?
> >>
> >
> > My package has a Makefile because I need to compile 16 .cpp files. After
> > it, I call R CMD SHLIB.
>
> R CMD SHLIB would do that for you.  Many packages using multiple .cpp
> files have no Makefile.  Please study the many examples on CRAN.
>
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>

From murdoch at stats.uwo.ca  Wed Mar 23 22:35:07 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Wed Mar 23 22:35:16 2005
Subject: [Rd] interp.surface() error (PR#7745)
Message-ID: <20050323213507.D4790BAF5@slim.kubism.ku.dk>

On Wed, 23 Mar 2005 22:16:30 +0100 (CET), takahama@andrew.cmu.edu
wrote :

>R version: 2.001
>OS: Windows XP SP2
>
>When I use the interp.surface() function, on occasion I have encountered 
>the following error message:
>
>Error in interp.surface(a, loc) : subscript out of bounds
>
>Since it is somewhat dependent on the data set, I cannot say exactly in 
>which cases these occur, but I believe I have found the problem and a 
>solution for it:
>
>The scaling calculations in the code,
>    lx <- ((nx - 1) * (loc[, 1] - xa))/xr + 1
>    ly <- ((ny - 1) * (loc[, 2] - ya))/yr + 1
>can lead to numerical error, so in the following lines
>    lx1 <- ifelse(lx == nx, nx - 1, trunc(lx))
>    ly1 <- ifelse(ly == ny, ny - 1, trunc(ly))
>the equality statements which are the first arguments to the IF-ELSE 
>statements return false when they are supposed to be true. I believe the 
>remedy is to simply avoid absolute equalities, as in the following example 
>(which has worked for my problem):
>    lx1 <- ifelse(abs(lx - nx) < 1e-10, nx - 1, trunc(lx))
>    ly1 <- ifelse(abs(ly - ny) < 1e-10, ny - 1, trunc(ly))
>
>I hope this is an appropriate posting for an error report. Thank you very 
>much for your hard work,

I think 

ifelse(lx >= nx, nx - 1, trunc(lx))
ifelse(ly >= ny, ny - 1, trunc(ly))

would probably be a better fix, but I'd really like to see an example
of this in action.  Could you email me a dataset where you see it?

Duncan Murdoch

From ripley at stats.ox.ac.uk  Wed Mar 23 22:59:00 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 22:59:12 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.58L0.0503231621450.8500@est.ufpr.br>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
	<Pine.LNX.4.61.0503230744450.29643@gannet.stats>
	<Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
	<Pine.LNX.4.61.0503231703450.30989@gannet.stats>
	<Pine.LNX.4.58L0.0503231621450.8500@est.ufpr.br>
Message-ID: <Pine.LNX.4.61.0503232156010.1947@gannet.stats>

On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:

> Let me tell an example.
>
> I found the bayesSurv package in CRAN. It has some .cpp and .h files, and
> doesn't have a makefile. I did the following steps:
>
> 1. compile the package (R CMD INSTALL)
> 2. write something in /src/List.cpp (only add an empty line)
> 3. recompile package (INSTALL)
>   it works, OK.
> 4. write something in /src/List.h
> 5. recompile
>   it does nothing. List.cpp was not changed and so R says List.o is up
>   to date, right?
>
> Is there any way to tell R that List.o depends on List.h???
>
> I think it is not an R problem, because Makefiles can check it. My
> question is: I know that List.o is not up to dated, because I changed
> List.h, and my Makefile recognizes it. But if I tell R to compile List.cpp
> again using COMPILE, it will say that the file is up to date, and won't
> compile it. So, the only way to check dependencies, as I can see, is using a
> Makefile, and compiling .cpp files without any R help. Is it true?

As I said before, COMPILE is not the correct tool.  Please don't expect me 
to keep repeating myself.

BTW, R CMD INSTALL under Windows does build dependencies, and you have not 
specified your platform here.

> On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
>
>> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
>>
>>>
>>> On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
>>>
>>>> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
>>>>
>>>>> I am developing a package with a lot of C++ code, and I have a question
>>>>> about R CMD COMPILE. As I can see, when the package's Makefile calls
>>>>>
>>>>> R CMD COMPILE foo.cpp
>>>>
>>>> Why does your package have a Makefile?  And why is it calling COMPILE and
>>>> not SHLIB?
>>>>
>>>
>>> My package has a Makefile because I need to compile 16 .cpp files. After
>>> it, I call R CMD SHLIB.
>>
>> R CMD SHLIB would do that for you.  Many packages using multiple .cpp
>> files have no Makefile.  Please study the many examples on CRAN.
>>
>> --
>> Brian D. Ripley,                  ripley@stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>>
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Mar 23 23:05:15 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 23 23:05:25 2005
Subject: [Rd] interp.surface() error (PR#7745)
In-Reply-To: <20050323213507.D4790BAF5@slim.kubism.ku.dk>
References: <20050323213507.D4790BAF5@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503232159560.1947@gannet.stats>

R does not contain a function interp.surface!

This is from package 'fields', and according to the FAQ only the 
maintainer is allowed to send bug reports on a contributed package to 
R-bugs.

I am closing this report: please contact the maintainer (and do read the 
FAQ).

On Wed, 23 Mar 2005 murdoch@stats.uwo.ca wrote:

> On Wed, 23 Mar 2005 22:16:30 +0100 (CET), takahama@andrew.cmu.edu
> wrote :
>
>> R version: 2.001

(There is no such version of R.)

>> OS: Windows XP SP2
>>
>> When I use the interp.surface() function, on occasion I have encountered
>> the following error message:
>>
>> Error in interp.surface(a, loc) : subscript out of bounds
>>
>> Since it is somewhat dependent on the data set, I cannot say exactly in
>> which cases these occur, but I believe I have found the problem and a
>> solution for it:
>>
>> The scaling calculations in the code,
>>    lx <- ((nx - 1) * (loc[, 1] - xa))/xr + 1
>>    ly <- ((ny - 1) * (loc[, 2] - ya))/yr + 1
>> can lead to numerical error, so in the following lines
>>    lx1 <- ifelse(lx == nx, nx - 1, trunc(lx))
>>    ly1 <- ifelse(ly == ny, ny - 1, trunc(ly))
>> the equality statements which are the first arguments to the IF-ELSE
>> statements return false when they are supposed to be true. I believe the
>> remedy is to simply avoid absolute equalities, as in the following example
>> (which has worked for my problem):
>>    lx1 <- ifelse(abs(lx - nx) < 1e-10, nx - 1, trunc(lx))
>>    ly1 <- ifelse(abs(ly - ny) < 1e-10, ny - 1, trunc(ly))
>>
>> I hope this is an appropriate posting for an error report. Thank you very
>> much for your hard work,
>
> I think
>
> ifelse(lx >= nx, nx - 1, trunc(lx))
> ifelse(ly >= ny, ny - 1, trunc(ly))
>
> would probably be a better fix, but I'd really like to see an example
> of this in action.  Could you email me a dataset where you see it?
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MPaschini at ewiprepaid.com  Wed Mar 23 23:58:00 2005
From: MPaschini at ewiprepaid.com (Miles Paschini)
Date: Wed Mar 23 23:55:54 2005
Subject: [Rd] RE: improved [Qurb #879958]
Message-ID: <427CE3ECB3B9844C85B2CDB15881E9F33A4923@sdoex1.ewi.com>

This is an automated message.

I apologize for the inconvenience, but I need your help in fighting
spam. I'm using a program called Qurb which automatically maintains
a list of approved senders for me. Messages from approved senders go
directly to my Inbox. Messages from addresses that Qurb hasn't seen
before are quarantined until the address of the sender can be
confirmed.

TO CONFIRM YOUR ADDRESS PLEASE REPLY TO THIS MESSAGE WITHOUT
MODIFYING THE SUBJECT.

There is no need to include any additional information in your
reply. I will be notified of your original message immediately and
you should not receive a confirmation message like this from me in
the future.

Thanks Miles

________________________________________________________________
Free download at http://www.qurb.com/

From w.northcott at unsw.edu.au  Thu Mar 24 12:59:16 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Thu Mar 24 12:59:36 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <200503241104.j2OB4U70024638@hypatia.math.ethz.ch>
References: <200503241104.j2OB4U70024638@hypatia.math.ethz.ch>
Message-ID: <9444a625058d32a3796a700d758668de@unsw.edu.au>

On 24/03/2005, at 10:04 PM, Andy wrote:
> I just tested this problem on a Windows 2000 Pro P4-Xeon system.  I 
> tried
> this in patched 2.0.1 (2005-2-28) and 2.1.0-alpha (2005-3-23) with both
> generic BLAS and precompiled ATLAS BLAS dll (downloaded from CRAN 
> windows
> binaries).  In all 4 combinations I get
>
>> d<-matrix(NaN,3,3)
>> f<-solve(d)
>> f
>      [,1] [,2] [,3]
> [1,]  NaN  NaN  NaN
> [2,]  NaN  NaN  NaN
> [3,]  NaN  NaN  NaN
>> det(d)
> [1] NaN
>>
>>
I just want to clarify some of the discussion here for my own benefit.

As I understand it, there are two software libraries involved (three if 
you count R).  BLAS is the lowest layer providing basic matrix 
operations.  It comes in vanilla and platform optimised (ATLAS or Goto) 
flavours.  Presumably R's built in version is vanilla.

Relying on BLAS is LAPACK which provides the functions which R actually 
calls like dgesv.  LAPACK relies on BLAS to provide the platform 
optimisations.  As far as I can see the issue(s) here is(are) with 
LAPACK not BLAS.  It is LAPACK that issues the error and halts the 
program.  (The MacOS X Accelerate Framework contains BLAS and LAPACK as 
distinct libraries libBlas.dylib and libLapack.dylib)

If, as reported, the behaviour is fundamentally similar on MacOS X, 
Linux and IRIX then it would appear that this is a feature(bug?) of the 
LAPACK reference implementation and that whoever wrote the Windows 
version saw fit to improve on it.  I don't think LAPACK ever pretended 
to properly handle NaNs.

It seems to me that the Windows version is an improvement, because it 
complies with the robust arithmetic principles that programs should not 
halt but propagate NaN or other indicators that can tested as 
appropriate in the application.  So it might be good idea to press 
other implementers of LAPACK to do the same.

My view for what it is worth is that R should also be robust in this 
sense and not halt on NaNs.  For preference this should be handled in 
the LAPACK implementations, but if not R should should trap them.  As I 
see it, it is incorrect to say a matrix containing NaNs is singular, 
not positive definite or whatever, because since it contains NaNs the 
computations to make those determinations cannot be performed.

Is this the wrong way to look at it?

Bill Northcott

PS  This discussion has given me another thought.  On MacOS X, it would 
be much faster to use floats instead of doubles because they can be 
directly processed by the Altivec section of the CPU.  I can see no way 
to have R use floats.  Would that be possible as a future enhancement 
or is it just too hard?

From andy_liaw at merck.com  Thu Mar 24 14:34:09 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Mar 24 14:34:52 2005
Subject: [Rd] RE: [R] Mapping actual to expected columns for princomp object
Message-ID: <3A822319EB35174CA3714066D590DCD50994E8E3@usrymx25.merck.com>

[Re-directing to R-devel, as I think this needs changes to the code.]

Can I suggest a modification to stats:predict.princomp so that it will check
for column (variable) names?

In src/library/stats/R/princomp-add.R, insert the following after line 4:

    if (!is.null(cn <- names(object$center))) newdata <- newdata[, cn]

Now Dana's example looks like:

> predict(pca1, frz)
Error in "[.data.frame"(newdata, , names(object$center)) : 
        undefined columns selected
> names(frz) <- c("x2", "x1")
> predict(pca1, frz)
        Comp.1      Comp.2
1  -3.29329963 -1.24675774
2   0.15760569  0.09364550
3   1.90206906  0.06292855
4  -0.92968723  0.64356801
5  -1.15298669  0.25451588
6   0.48466884 -0.87611668
7   0.98602646 -0.52156549
8  -1.53126034 -0.96259529
9  -0.79112984 -1.50831648
10  0.02997392 -0.18888807
> names(frz) <- c("x1", "x2")
> predict(pca1, frz)
        Comp.1      Comp.2
1   2.49603051 -2.42516162
2  -0.15633499  0.15754735
3  -1.77400454  0.81118427
4   1.05941012  0.23869214
5   1.11286213 -0.20669206
6  -0.83645436 -0.60720531
7  -1.15932677 -0.08488413
8   0.98526969 -1.47482877
9   0.09070675 -1.68781215
10 -0.14930067 -0.15239717

Best,
Andy

> From: Dana Honeycutt
> 
> I am working with data sets in which the number and order of columns
> may vary, but each column is uniquely identified by its name.  E.g.,
> one data set might have columns
>         MW logP Num_Rings Num_H_Donors
> while another has columns
>         Num_Rings Num_Atoms Num_H_Donors logP MW
> 
> I would like to be able to perform a principal component 
> analysis (PCA)
> on one data set and save the PCA object to a file.  In a 
> later R session, 
> I would like to load the object and then apply the loadings to a new 
> data set in order to compute the principal component (PC) values for 
> each row of new data.
> 
> I am trying to use the princomp method in R to do this. (I started 
> with prcomp, but found that there is no predict method for objects
> created by prcomp.)  The problem is that when using predict on a
> princomp object, R ignores the names of columns and simply assumes
> that the column order is the same as in the original data frame used
> to do the PCA.  (This contrasts, for example, with the behavior of a
> model produced by lm, which is aware of column names in a data frame.)
> 
> What I think I need to do is this:
> 
> 1. After reloading the princomp object, extract the names and order
> of columns that it expects. (If you look at the loadings for the
> object, you can see that this info is there, but I would like to 
> get at it directly somehow.)
> 
> 2. Reorder the columns in the new data set to correspond to this
> expected order, and remove any extra columns.
> 
> 3. Use the predict method to predict the PC values for the 
> new data set.
> 
> Is this the best approach to achieve what I am attempting?
> 
> If so, can anyone tell me how to accomplish steps 1 and 2 above?
> 
> Thanks,
> Dana Honeycutt
> 
> P.S. Here's a script that demonstrates the problem:
> 
> x1 <- rnorm(10)
> x2 <- rnorm(10)
> y <- rnorm(10)
> 
> frx <- data.frame(x1,x2)
> frxy <- data.frame(x1,x2,y)
> 
> lm1 <- lm(y~x1+x2,frxy)
> pca1 <- princomp(frx)
> 
> rm(x1,x2,y,frx,frxy)
> 
> z1 <- rnorm(10)
> z2 <- rnorm(10)
> frz <- data.frame(z1,z2)
> 
> predict(lm1, frz)  # gives error: Object "x1" not found
> predict(pca1, frz) # gives no error, indicating column names ignored
> 
> z3 <- rnorm(10)
> fr3z <- data.frame(frz,z3)
> predict(pca1,fr3z) # gives error due to unexpected number of columns
> 
> loadings(pca1) # shows linear combos of variables corresponding to PCs
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! 
> http://www.R-project.org/posting-guide.html
> 
> 
>

From ripley at stats.ox.ac.uk  Thu Mar 24 15:00:04 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Mar 24 15:00:14 2005
Subject: [Rd] RE: [R] Mapping actual to expected columns for princomp
	object
In-Reply-To: <3A822319EB35174CA3714066D590DCD50994E8E3@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD50994E8E3@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.61.0503241354030.2463@gannet.stats>

I am currently working on this (and on the predict method for prcomp, 
which does exist, BTW).  It needs a bit more in the way of sanity 
checks.

Note that the predict method for lm is for a formula-driven fit, whereas 
that for princomp is not, hence some of the differences.  It is not 
reasonable to apply the docs for predict.lm to predict.princomp, and they 
do not work the same way.

On Thu, 24 Mar 2005, Liaw, Andy wrote:

> [Re-directing to R-devel, as I think this needs changes to the code.]
>
> Can I suggest a modification to stats:predict.princomp so that it will check
> for column (variable) names?
>
> In src/library/stats/R/princomp-add.R, insert the following after line 4:
>
>    if (!is.null(cn <- names(object$center))) newdata <- newdata[, cn]
>
> Now Dana's example looks like:
>
>> predict(pca1, frz)
> Error in "[.data.frame"(newdata, , names(object$center)) :
>        undefined columns selected
>> names(frz) <- c("x2", "x1")
>> predict(pca1, frz)
>        Comp.1      Comp.2
> 1  -3.29329963 -1.24675774
> 2   0.15760569  0.09364550
> 3   1.90206906  0.06292855
> 4  -0.92968723  0.64356801
> 5  -1.15298669  0.25451588
> 6   0.48466884 -0.87611668
> 7   0.98602646 -0.52156549
> 8  -1.53126034 -0.96259529
> 9  -0.79112984 -1.50831648
> 10  0.02997392 -0.18888807
>> names(frz) <- c("x1", "x2")
>> predict(pca1, frz)
>        Comp.1      Comp.2
> 1   2.49603051 -2.42516162
> 2  -0.15633499  0.15754735
> 3  -1.77400454  0.81118427
> 4   1.05941012  0.23869214
> 5   1.11286213 -0.20669206
> 6  -0.83645436 -0.60720531
> 7  -1.15932677 -0.08488413
> 8   0.98526969 -1.47482877
> 9   0.09070675 -1.68781215
> 10 -0.14930067 -0.15239717
>
> Best,
> Andy
>
>> From: Dana Honeycutt
>>
>> I am working with data sets in which the number and order of columns
>> may vary, but each column is uniquely identified by its name.  E.g.,
>> one data set might have columns
>>         MW logP Num_Rings Num_H_Donors
>> while another has columns
>>         Num_Rings Num_Atoms Num_H_Donors logP MW
>>
>> I would like to be able to perform a principal component
>> analysis (PCA)
>> on one data set and save the PCA object to a file.  In a
>> later R session,
>> I would like to load the object and then apply the loadings to a new
>> data set in order to compute the principal component (PC) values for
>> each row of new data.
>>
>> I am trying to use the princomp method in R to do this. (I started
>> with prcomp, but found that there is no predict method for objects
>> created by prcomp.)  The problem is that when using predict on a
>> princomp object, R ignores the names of columns and simply assumes
>> that the column order is the same as in the original data frame used
>> to do the PCA.  (This contrasts, for example, with the behavior of a
>> model produced by lm, which is aware of column names in a data frame.)
>>
>> What I think I need to do is this:
>>
>> 1. After reloading the princomp object, extract the names and order
>> of columns that it expects. (If you look at the loadings for the
>> object, you can see that this info is there, but I would like to
>> get at it directly somehow.)
>>
>> 2. Reorder the columns in the new data set to correspond to this
>> expected order, and remove any extra columns.
>>
>> 3. Use the predict method to predict the PC values for the
>> new data set.
>>
>> Is this the best approach to achieve what I am attempting?
>>
>> If so, can anyone tell me how to accomplish steps 1 and 2 above?
>>
>> Thanks,
>> Dana Honeycutt
>>
>> P.S. Here's a script that demonstrates the problem:
>>
>> x1 <- rnorm(10)
>> x2 <- rnorm(10)
>> y <- rnorm(10)
>>
>> frx <- data.frame(x1,x2)
>> frxy <- data.frame(x1,x2,y)
>>
>> lm1 <- lm(y~x1+x2,frxy)
>> pca1 <- princomp(frx)
>>
>> rm(x1,x2,y,frx,frxy)
>>
>> z1 <- rnorm(10)
>> z2 <- rnorm(10)
>> frz <- data.frame(z1,z2)
>>
>> predict(lm1, frz)  # gives error: Object "x1" not found
>> predict(pca1, frz) # gives no error, indicating column names ignored
>>
>> z3 <- rnorm(10)
>> fr3z <- data.frame(frz,z3)
>> predict(pca1,fr3z) # gives error due to unexpected number of columns
>>
>> loadings(pca1) # shows linear combos of variables corresponding to PCs
>>
>> ______________________________________________
>> R-help@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide!
>> http://www.R-project.org/posting-guide.html
>>
>>
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Thu Mar 24 17:33:24 2005
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Thu Mar 24 17:35:11 2005
Subject: [Rd] rw2010alpha
Message-ID: <loom.20050324T172439-935@post.gmane.org>


Until recently R 2.1.0 was called rw2010dev.  I just visited

   http://cran.r-project.org/bin/windows/base/rdevel.html

and noticed its now called rw2010alpha, not rw2010dev.  I would like 
to use it without downloading all the libraries over again.

Can I 

- just rename my rw2010dev folder (Windows XP) to 
  rw2010alpha and then install rw2010alpha to that?  or 

- install it in a separate rw2010alpha folder, distinct 
  from the rw2010dev folder and then somehow copy the libraries 
  from one to the other? or 

- do I have to download the libraries all over again? or 

- some other solution?

Thanks.

From murdoch at stats.uwo.ca  Thu Mar 24 17:41:44 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Mar 24 17:43:50 2005
Subject: [Rd] rw2010alpha
In-Reply-To: <loom.20050324T172439-935@post.gmane.org>
References: <loom.20050324T172439-935@post.gmane.org>
Message-ID: <g4r5415fo66dpcb28bdlgchvf8ibt536n8@4ax.com>

On Thu, 24 Mar 2005 16:33:24 +0000 (UTC), Gabor Grothendieck
<ggrothendieck@myway.com> wrote :

>
>Until recently R 2.1.0 was called rw2010dev.  I just visited
>
>   http://cran.r-project.org/bin/windows/base/rdevel.html
>
>and noticed its now called rw2010alpha, not rw2010dev.  I would like 
>to use it without downloading all the libraries over again.
>
>Can I 
>
>- just rename my rw2010dev folder (Windows XP) to 
>  rw2010alpha and then install rw2010alpha to that?  or 
>
>- install it in a separate rw2010alpha folder, distinct 
>  from the rw2010dev folder and then somehow copy the libraries 
>  from one to the other? or 
>
>- do I have to download the libraries all over again? or 
>
>- some other solution?

I suspect renaming the folder would not work because the install
registers the DCOM server.  Copying the libraries might be okay, if
you then did a regular install of a package to update all the indices,
but there might be some other detail I missed.

Probably the easiest thing to do is to install the new one on top of
the old rw2010dev, by changing the default install directory when you
run rw2010alpha.exe.

The safest thing is to install to a new folder and download all the
packages again, because then you won't have any files installed which
shouldn't be there.

Duncan Murdoch

From ligges at statistik.uni-dortmund.de  Thu Mar 24 17:45:12 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Mar 24 17:45:17 2005
Subject: [Rd] rw2010alpha
In-Reply-To: <loom.20050324T172439-935@post.gmane.org>
References: <loom.20050324T172439-935@post.gmane.org>
Message-ID: <4242EE98.8000001@statistik.uni-dortmund.de>

Gabor Grothendieck wrote:

> Until recently R 2.1.0 was called rw2010dev.  I just visited
> 
>    http://cran.r-project.org/bin/windows/base/rdevel.html
> 
> and noticed its now called rw2010alpha, not rw2010dev.  I would like 
> to use it without downloading all the libraries over again.
> 
> Can I 
> 
> - just rename my rw2010dev folder (Windows XP) to 
>   rw2010alpha and then install rw2010alpha to that?  or 

yes

> - install it in a separate rw2010alpha folder, distinct 
>   from the rw2010dev folder and then somehow copy the libraries 
>   from one to the other? or 

yes

You can also install packages to a separate library and specify that one 
to be used by both versions.

> - do I have to download the libraries all over again? or 

no

> - some other solution?


You can use the packages compiled for R-devel also for R-2.1.0 alpha. 
Copying/renaming either way should work in this case.

Uwe Ligges


> Thanks.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From simon.urbanek at r-project.org  Thu Mar 24 17:54:16 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu Mar 24 17:54:30 2005
Subject: float vs double on Macs [was Re: [Rd] NaN and linear algebra]
In-Reply-To: <9444a625058d32a3796a700d758668de@unsw.edu.au>
References: <200503241104.j2OB4U70024638@hypatia.math.ethz.ch>
	<9444a625058d32a3796a700d758668de@unsw.edu.au>
Message-ID: <4C39ADF6-C46A-47E8-93BF-887C698E64EE@r-project.org>

On Mar 24, 2005, at 6:59 AM, Bill Northcott wrote:

> PS  This discussion has given me another thought.  On MacOS X, it  
> would be much faster to use floats instead of doubles because they  
> can be directly processed by the Altivec section of the CPU.  I can  
> see no way to have R use floats.  Would that be possible as a  
> future enhancement or is it just too hard?

To have just a rough idea about how "much faster" this would be, here  
are some timings for 2000 runs of 1000x1000 matrix-vector  
multiplications using vecLib's BLAS:
G5 1.8GHz
sgemv: 2.9s
dgemv: 6.7s

G4 1.5GHz
sgemv: 10.1s
dgemv: 17.3s

The performance difference between double and float is actually less  
astonishing (although is proves that altiVec is used - still) than  
the G4 vs G5 comparison. vecLib for G5 seems to be fairly well  
optimized and the G5 architecture seems to have better throughput.

Anyway, I'm not quite sure switching from doubles to floats yields  
big enough speed up to justify the effort. Maybe some Lapack test  
would helpful, too, to have a bigger picture of this.

Cheers,
Simon

PS: I'd rather move this part to R-SIG-Mac as this is actually a Mac- 
only question.

From rpeng at jhsph.edu  Thu Mar 24 19:14:20 2005
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Thu Mar 24 19:14:29 2005
Subject: [Rd] saving errors/warnings (conditions)
Message-ID: <4243037C.60702@jhsph.edu>

I recently ran a script which fit many different models (thousands, 
say) via glm(), some of which were successful and some not.  For the 
unsuccessful fits, I caught them using tryCatch() and returned either 
a "simpleError" object or a "simpleWarning" object, depending on 
whether it was an error or a warning that triggered the tryCatch.

I stored all the results in a single big list and I was surprised to 
see that the memory usage was nearly a 1 GB, but calling object.size() 
on the results list only returned about 5 MB (I only store two numbers 
from each fitted model object).  When I saved the results list the 
compressed workspace file was ~90MB.

The only thing I'd done differently from previous runs is store the 
error/warning objects.  Is there some environment that is being saved 
with a simpleError/Warning object that could be taking up all the 
memory?  I couldn't find any indication on the help page for tryCatch().

Thanks,

-roger
-- 
Roger D. Peng
http://www.biostat.jhsph.edu/~rpeng/

From konis at stats.ox.ac.uk  Thu Mar 24 21:03:45 2005
From: konis at stats.ox.ac.uk (Kjell Konis)
Date: Thu Mar 24 21:03:53 2005
Subject: [Rd] NaN and linear algebra
In-Reply-To: <9444a625058d32a3796a700d758668de@unsw.edu.au>
References: <200503241104.j2OB4U70024638@hypatia.math.ethz.ch>
	<9444a625058d32a3796a700d758668de@unsw.edu.au>
Message-ID: <1545b2a93b241cb49eff611612babb0a@stats.ox.ac.uk>

> If, as reported, the behaviour is fundamentally similar on MacOS X, 
> Linux and IRIX then it would appear that this is a feature(bug?) of 
> the LAPACK reference implementation and that whoever wrote the Windows 
> version saw fit to improve on it.  I don't think LAPACK ever pretended 
> to properly handle NaNs.

Although both Linux and OSX produce an error the behavior of LAPACK is 
not similar.

(It would be nice if someone using Windows could try the following test 
too)

(1) Compile the following C code

void testdgesv(long* N, long* NRHS, double* A, long* LDA, long* IPIVOT, 
double* B, long* LDB, long* INFO)
{
   DGESV(N, NRHS, A, LDA, IPIVOT, B, LDB, INFO);
}

(you will have to use the right combination of case and _s)

(2) Run these commands in R:

dyn.load("test.so")
N <- as.integer(3)
NRHS <- as.integer(3)
A <- matrix(as.double(NaN), 3, 3)
LDA <- as.integer(3)
IPIVOT <- integer(3)
B <- diag(3)
storage.mode(B) <- "double"
LDB <- as.integer(3)
INFO <- as.integer(0)

.C("testdgesv", N = N, NRHS = NRHS, A = A, LDA = LDA, IPIVOT = IPIVOT, 
B = B, LDB = LDB, INFO = INFO, NAOK = TRUE)

$N
[1] 3

$NRHS
[1] 3

$A
      [,1] [,2] [,3]
[1,]  NaN  NaN  NaN
[2,]  NaN  NaN  NaN
[3,]  NaN  NaN  NaN

$LDA
[1] 3

$IPIVOT
[1] 1 2 3

$B
      [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1

$LDB
[1] 3

$INFO
[1] 3

//////////////////

On my Mac mini this exits with no errors or warnings (other than INFO = 
3 anyway).  However,

solve(A)

generates the error:

Error in solve.default(A) : Lapack routine dgesv: system is exactly 
singular

This behavior seems to suggest that error is generated somewhere in R, 
not in LAPACK.

Okay, now for the weird bit.

When I run this in Linux I get:

 > .C("testdgesv", N = N, NRHS = NRHS, A = A, LDA = LDA, IPIVOT = 
IPIVOT, B = B, LDB = LDB, INFO = INFO, NAOK = TRUE)
$N
[1] 3

$NRHS
[1] 3

$A
      [,1] [,2] [,3]
[1,]  NaN  NaN  NaN
[2,]  NaN  NaN  NaN
[3,]  NaN  NaN  NaN

$LDA
[1] 3

$IPIVOT
[1] 3 2 3

$B
      [,1] [,2] [,3]
[1,]  NaN  NaN  NaN
[2,]  NaN  NaN  NaN
[3,]  NaN  NaN  NaN

$LDB
[1] 3

$INFO
[1] 0

where INFO == 0 indicates "successful exit" but

 > solve(A)
Error in solve.default(A) : system is computationally singular: 
reciprocal condition number = 0



In case it is important:

platform powerpc-apple-darwin7.8.0
arch     powerpc
os       darwin7.8.0
system   powerpc, darwin7.8.0
status
major    2
minor    0.1
year     2004
month    11
day      15
language R

and

platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    2
minor    0.1
year     2004
month    11
day      15
language R

prompt> more Makevars
PKG_LIBS=${LAPACK_LIBS} ${BLAS_LIBS} ${FLIBS}

From pedro at est.ufpr.br  Thu Mar 24 21:06:55 2005
From: pedro at est.ufpr.br (Pedro Ribeiro de Andrade Neto)
Date: Thu Mar 24 21:06:08 2005
Subject: [Rd] forcing R CMD COMPILE
In-Reply-To: <Pine.LNX.4.61.0503232156010.1947@gannet.stats>
References: <Pine.LNX.4.58L0.0503230041170.31558@est.ufpr.br>
	<Pine.LNX.4.61.0503230744450.29643@gannet.stats>
	<Pine.LNX.4.58L0.0503231341420.32487@est.ufpr.br>
	<Pine.LNX.4.61.0503231703450.30989@gannet.stats>
	<Pine.LNX.4.58L0.0503231621450.8500@est.ufpr.br>
	<Pine.LNX.4.61.0503232156010.1947@gannet.stats>
Message-ID: <Pine.LNX.4.58L0.0503241705010.31260@est.ufpr.br>

Hi,

platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   Patched
major    2
minor    0.1
year     2005
month    02
day      09
language R

is there any way? or must I compile by myself?

Pedro Andrade

--
LEG - Laboratrio de Estatstica e Geoinforma玢o
          http://www.est.ufpr.br/leg/
          Departamento de Estatstica
        Universidade Federal do Paran

On Wed, 23 Mar 2005, Prof Brian Ripley wrote:

> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
>
> > Let me tell an example.
> >
> > I found the bayesSurv package in CRAN. It has some .cpp and .h files, and
> > doesn't have a makefile. I did the following steps:
> >
> > 1. compile the package (R CMD INSTALL)
> > 2. write something in /src/List.cpp (only add an empty line)
> > 3. recompile package (INSTALL)
> >   it works, OK.
> > 4. write something in /src/List.h
> > 5. recompile
> >   it does nothing. List.cpp was not changed and so R says List.o is up
> >   to date, right?
> >
> > Is there any way to tell R that List.o depends on List.h???
> >
> > I think it is not an R problem, because Makefiles can check it. My
> > question is: I know that List.o is not up to dated, because I changed
> > List.h, and my Makefile recognizes it. But if I tell R to compile List.cpp
> > again using COMPILE, it will say that the file is up to date, and won't
> > compile it. So, the only way to check dependencies, as I can see, is using a
> > Makefile, and compiling .cpp files without any R help. Is it true?
>
> As I said before, COMPILE is not the correct tool.  Please don't expect me
> to keep repeating myself.
>
> BTW, R CMD INSTALL under Windows does build dependencies, and you have not
> specified your platform here.
>
> > On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
> >
> >> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
> >>
> >>>
> >>> On Wed, 23 Mar 2005, Prof Brian Ripley wrote:
> >>>
> >>>> On Wed, 23 Mar 2005, Pedro Ribeiro de Andrade Neto wrote:
> >>>>
> >>>>> I am developing a package with a lot of C++ code, and I have a question
> >>>>> about R CMD COMPILE. As I can see, when the package's Makefile calls
> >>>>>
> >>>>> R CMD COMPILE foo.cpp
> >>>>
> >>>> Why does your package have a Makefile?  And why is it calling COMPILE and
> >>>> not SHLIB?
> >>>>
> >>>
> >>> My package has a Makefile because I need to compile 16 .cpp files. After
> >>> it, I call R CMD SHLIB.
> >>
> >> R CMD SHLIB would do that for you.  Many packages using multiple .cpp
> >> files have no Makefile.  Please study the many examples on CRAN.
> >>
> >> --
> >> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> >> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> >> University of Oxford,             Tel:  +44 1865 272861 (self)
> >> 1 South Parks Road,                     +44 1865 272866 (PA)
> >> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >>
> >>
> >
> >
>
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>

From gregor.gorjanc at bfro.uni-lj.si  Fri Mar 25 10:35:53 2005
From: gregor.gorjanc at bfro.uni-lj.si (Gregor GORJANC)
Date: Fri Mar 25 10:36:27 2005
Subject: [Rd] CRAN website: link targets
Message-ID: <4243DB79.909@bfro.uni-lj.si>

Hello R-masters!

R and CRAN webpages use HTML frames for layout. Links to files such as PDF 
are therefore opened within frame. However, with PDFs this can be 
distracting if you have a small monitor, since left frame can be small for 
viewing PDFs with bookmark toolbar in the left in Acrobat Reader. It isn't 
such a bug problem with others i.e. (K)Ghostview etc, but it can be still 
small to look at.

I suggest to add targets to all links to PDF files. If one wants to see 
that link will be opened in new frame/tab then target="_blank" should used, 
otherwise target="_top" will cause that PDF will be opened "over all 
frames" of current website.

I can help if you find this idea good and don't find time to do it.

-- 
Lep pozdrav / With regards,
     Gregor Gorjanc

-----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe

From ripley at stats.ox.ac.uk  Fri Mar 25 11:06:05 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Mar 25 11:06:27 2005
Subject: [Rd] CRAN website: link targets
In-Reply-To: <4243DB79.909@bfro.uni-lj.si>
References: <4243DB79.909@bfro.uni-lj.si>
Message-ID: <Pine.LNX.4.61.0503250948010.24801@gannet.stats>

On Fri, 25 Mar 2005, Gregor GORJANC wrote:

> Hello R-masters!

This is R-devel, not the feedback page for CRAN/www.r-project.org.

> R

R webpages do not AFAICS.  www.r-project.org may, but that is not R.

>  and CRAN webpages use HTML frames for layout. Links to files such as PDF 
> are therefore opened within frame. However, with PDFs this can be distracting

That is a function of your browser settings, not part of the WWW standard.
Other settings open files in the assigned PDF reader.

> if you have a small monitor, since left frame can be small for viewing PDFs 
> with bookmark toolbar in the left in Acrobat Reader. It isn't such a bug 
> problem with others i.e. (K)Ghostview etc, but it can be still small to look 
> at.
>
> I suggest to add targets to all links to PDF files. If one wants to see that 
> link will be opened in new frame/tab then target="_blank" should used, 
> otherwise target="_top" will cause that PDF will be opened "over all frames" 
> of current website.

A decent browser will allow you the choice of opening in the frame, in a 
new tab/window or in the application (here the PDF reader).  If yours does 
not, try a better browser (e.g. Firefox).


What I do think is desirable is for *off-site* HTML links (e.g. for the 
mailing lists) to use target="_top".  That is certainly what my O'Reilly 
HTML book recommends.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ellis at stat.harvard.edu  Fri Mar 25 11:09:15 2005
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Fri Mar 25 11:09:36 2005
Subject: [Rd] can R_do_slot_assign change slot type
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A58FF619@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A58FF619@phost015.EVAFUNDS.intermedia.net>
Message-ID: <06a58b9399199d7a130b5d6f5b92bd9b@stat.harvard.edu>

I've done this by accident before and it works, but causes trouble down 
the line (IIRC saving and loading objects causes problems).

On Mar 21, 2005, at 10:22 PM, Vadim Ogranovich wrote:

> Hi,
>
> It seems that R_do_slot_assign can change the type of an S4 class slot.
> For example I have a class
>
> setClass("ostream", representation(id = "integer", keepOpen =
> "logical"))
>
> and inside a C-function I was able to assign a RAW vector to the id
> slot. Is this intentional? I remember reading somewhere that the slot
> type is guaranteed by R. Maybe this doesn't extend to C code?
>
>
> Now, in the above example I actually don't know the eventual type of 
> the
> 'id' slot, it will be set up in some C code that intializes the class
> instance. What is the right way to define the representation in such a
> case?
>
> Thanks,
> Vadim
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
---
Byron Ellis (ellis@stat.harvard.edu)
"Oook" -- The Librarian

From ellis at stat.harvard.edu  Fri Mar 25 11:30:01 2005
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Fri Mar 25 11:30:20 2005
Subject: [Rd] S4 methods semantics questions
Message-ID: <422af62516432df52f025c8bf6d3e48c@stat.harvard.edu>

Some quick questions about S4 methods.

Does the typing of S4 methods mean that lazy evaluation is no longer 
possible? It seems that you would need to evaluate the arguments to 
determine their type at dispatch.

Second, what role, if any, do default arguments play in S4 methods? I 
notice that you can put default arguments into generics but that the 
dispatch is still done on the type of the calling argument rather than 
the default argument, though the default arg is substituted. However, 
default values for arguments in method definition seem to be stripped 
or, more likely, overridden at dispatch by the calling argument (i.e. 
"missing").

Some examples:

setGeneric("foo",function(x="bar") standardGeneric("foo"))
setMethod("foo","missing",function(x) print(x))

 >foo()
[1] "bar"

setGeneric("foo",function(x,y) standardGeneric("foo"))
setMethod("foo","numeric",function(x,y=2) x+y)

 >foo(1)
Error in foo(1) : argument "y" is missing, with no default

---
Byron Ellis (ellis@stat.harvard.edu)
"Oook" -- The Librarian

From jmc at R-project.org  Fri Mar 25 16:26:07 2005
From: jmc at R-project.org (John Chambers)
Date: Fri Mar 25 16:26:34 2005
Subject: [Rd] S4 methods semantics questions
In-Reply-To: <422af62516432df52f025c8bf6d3e48c@stat.harvard.edu>
References: <422af62516432df52f025c8bf6d3e48c@stat.harvard.edu>
Message-ID: <42442D8F.9040807@R-project.org>

Byron Ellis wrote:

> Some quick questions about S4 methods.
> 
> Does the typing of S4 methods mean that lazy evaluation is no longer 
> possible? It seems that you would need to evaluate the arguments to 
> determine their type at dispatch.

Yes, it would be a neat trick to know the class of an actual argument 
without evaluating it ;-)

However, the evaluation proceeds stepwise until a unique method matches, 
so that arguments not needed to do the dispatch will not yet be 
evaluated.  The order of evaluation is controlled by the signature of 
the generic, by default all the arguments in order, but specifiable via 
the signature= argument to setGeneric.

> 
> Second, what role, if any, do default arguments play in S4 methods? I 
> notice that you can put default arguments into generics but that the 
> dispatch is still done on the type of the calling argument rather than 
> the default argument, though the default arg is substituted. 

Yes, dispatch depends on the call, not on the default expressions for 
the arguments.  If an actual argument is missing, the dispatch tries to 
match "missing" or "ANY".

> However, 
> default values for arguments in method definition seem to be stripped 
> or, more likely, overridden at dispatch by the calling argument (i.e. 
> "missing").
> 
> Some examples:
> 
> setGeneric("foo",function(x="bar") standardGeneric("foo"))
> setMethod("foo","missing",function(x) print(x))
> 
>  >foo()
> [1] "bar"
> 
> setGeneric("foo",function(x,y) standardGeneric("foo"))
> setMethod("foo","numeric",function(x,y=2) x+y)
> 
>  >foo(1)
> Error in foo(1) : argument "y" is missing, with no default

Well, the intent is that defaults are indeed taken from the method, if 
there is a default there, otherwise from the generic.  It looks as if 
there is a bug in the case that the generic has NO default for that 
argument (unless, of course, it's a subtle feature, but not that I can 
think of at the moment).

Your example works as intended if there is a default expression for y in 
the generic:

R> setGeneric("foo",function(x,y=stop("Need y")) standardGeneric("foo"))
[1] "foo"
R> setMethod("foo","numeric",function(x,y=2) x+y)
[1] "foo"
R> foo(1)
[1] 3


> 
> ---
> Byron Ellis (ellis@stat.harvard.edu)
> "Oook" -- The Librarian
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From kirschenbaumss at npt.nuwc.navy.mil  Fri Mar 25 16:48:35 2005
From: kirschenbaumss at npt.nuwc.navy.mil (kirschenbaumss@npt.nuwc.navy.mil)
Date: Fri Mar 25 16:49:02 2005
Subject: [Rd] R fails to start (PR#7747)
Message-ID: <20050325154835.66235AD74@slim.kubism.ku.dk>

Full_Name: Susan Kirschenbaum
Version: 2.0.1
OS: Mac OS 10.3.8
Submission from: (NULL) (164.223.72.7)


R failes to start. The console opens but, before fully loaded, it quits

From sfalcon at fhcrc.org  Fri Mar 25 19:36:23 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Fri Mar 25 19:36:33 2005
Subject: [Rd] S4 methods semantics questions
In-Reply-To: <42442D8F.9040807@R-project.org> (John Chambers's message of
	"Fri, 25 Mar 2005 10:26:07 -0500")
References: <422af62516432df52f025c8bf6d3e48c@stat.harvard.edu>
	<42442D8F.9040807@R-project.org>
Message-ID: <m2ll8bzi6w.fsf@macaroni.local>

John Chambers <jmc@R-project.org> writes:

> Well, the intent is that defaults are indeed taken from the method, if
> there is a default there, otherwise from the generic.  It looks as if
> there is a bug in the case that the generic has NO default for that
> argument (unless, of course, it's a subtle feature, but not that I can
> think of at the moment).
>
> Your example works as intended if there is a default expression for y
> in the generic:
>
> R> setGeneric("foo",function(x,y=stop("Need y")) standardGeneric("foo"))
> [1] "foo"
> R> setMethod("foo","numeric",function(x,y=2) x+y)
> [1] "foo"
> R> foo(1)
> [1] 3

FWIW, I've encountered the same error that the OP described.  I
certainly don't know if it is a bug, but I can say that I expected it
to work based on the documentation of setMethod.  

I ended up with a different workaround: if you don't need to do
dispatching on the default arguments, you can set

setGeneric("foo", function(x, ...) standardGeneric("foo"))

and then methods with defaults defined in their function do the
expected thing.

Best,

+ seth

From ellis at stat.harvard.edu  Fri Mar 25 22:34:24 2005
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Fri Mar 25 22:34:48 2005
Subject: [Rd] S4 methods semantics questions
In-Reply-To: <42442D8F.9040807@R-project.org>
References: <422af62516432df52f025c8bf6d3e48c@stat.harvard.edu>
	<42442D8F.9040807@R-project.org>
Message-ID: <46767a5bec481a68b90ca48706db36ee@stat.harvard.edu>


On Mar 25, 2005, at 7:26 AM, John Chambers wrote:

> Byron Ellis wrote:
>
>> Some quick questions about S4 methods.
>> Does the typing of S4 methods mean that lazy evaluation is no longer 
>> possible? It seems that you would need to evaluate the arguments to 
>> determine their type at dispatch.
>
> Yes, it would be a neat trick to know the class of an actual argument 
> without evaluating it ;-)

True enough. Though I suppose you could have done something with 
arguments that are method calls by inspecting valueClass to at least 
limit the set of possible types. :-)

>
> However, the evaluation proceeds stepwise until a unique method 
> matches, so that arguments not needed to do the dispatch will not yet 
> be evaluated.  The order of evaluation is controlled by the signature 
> of the generic, by default all the arguments in order, but specifiable 
> via the signature= argument to setGeneric.
>
>> Second, what role, if any, do default arguments play in S4 methods? I 
>> notice that you can put default arguments into generics but that the 
>> dispatch is still done on the type of the calling argument rather 
>> than the default argument, though the default arg is substituted.
>
> Yes, dispatch depends on the call, not on the default expressions for 
> the arguments.  If an actual argument is missing, the dispatch tries 
> to match "missing" or "ANY".
>
>> However, default values for arguments in method definition seem to be 
>> stripped or, more likely, overridden at dispatch by the calling 
>> argument (i.e. "missing").
>> Some examples:
>> setGeneric("foo",function(x="bar") standardGeneric("foo"))
>> setMethod("foo","missing",function(x) print(x))
>>  >foo()
>> [1] "bar"
>> setGeneric("foo",function(x,y) standardGeneric("foo"))
>> setMethod("foo","numeric",function(x,y=2) x+y)
>>  >foo(1)
>> Error in foo(1) : argument "y" is missing, with no default
>
> Well, the intent is that defaults are indeed taken from the method, if 
> there is a default there, otherwise from the generic.  It looks as if 
> there is a bug in the case that the generic has NO default for that 
> argument (unless, of course, it's a subtle feature, but not that I can 
> think of at the moment).
>
> Your example works as intended if there is a default expression for y 
> in the generic:
>
> R> setGeneric("foo",function(x,y=stop("Need y")) 
> standardGeneric("foo"))
> [1] "foo"
> R> setMethod("foo","numeric",function(x,y=2) x+y)
> [1] "foo"
> R> foo(1)
> [1] 3
>

Ah, interesting. I can't decide if thats a feature or a bug either :-)

>
>> ---
>> Byron Ellis (ellis@stat.harvard.edu)
>> "Oook" -- The Librarian
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
---
Byron Ellis (ellis@stat.harvard.edu)
"Oook" -- The Librarian

From weigand.stephen at charter.net  Sat Mar 26 01:36:46 2005
From: weigand.stephen at charter.net (weigand.stephen@charter.net)
Date: Sat Mar 26 01:37:01 2005
Subject: [Rd] Typo in setClass.Rd (PR#7748)
Message-ID: <20050326003646.F2B9CAD70@slim.kubism.ku.dk>

Full_Name: Stephen Weigand
Version: R-alpha
OS: Mac OS X
Submission from: (NULL) (129.176.151.21)


In R-alpha (R-latest.tar.gz as of Fri Mar 25 18:34:05 CST 2005) the file
setClass.Rd 
has the following typo: "Is this a the name of a formally defined class?" Either
"a" or "the"
should be removed.

From ggrothendieck at myway.com  Sat Mar 26 03:53:18 2005
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Mar 26 03:54:16 2005
Subject: [Rd] na.omit error message
Message-ID: <loom.20050326T034901-417@post.gmane.org>


If I create a bivariate ts series with 3 time points and run
na.omit on it expecting it to reduce it to a one point ts series
instead I get the following error messasge:


R> hh <- ts(matrix(c(NA,1:4,NA),3), start = c(1951,8), freq=12)
R> hh
         Series 1 Series 2
Aug 1951       NA        3
Sep 1951        1        4
Oct 1951        2       NA
R> na.omit(hh)
Error in "tsp<-"(`*tmp*`, value = c(1951.66666666667, 1951.66666666667,  : 
        invalid time series parameters specified
 

If I replace na.omit with na.contiguous then I get a protection stack
overflow:

R> na.contiguous(hh)
Error: protect(): protection stack overflow


R> R.version.string # Windows XP
[1] "R version 2.1.0, 2005-03-23"


Any comments on what is wrong?

From christos at nuverabio.com  Sat Mar 26 07:55:28 2005
From: christos at nuverabio.com (christos@nuverabio.com)
Date: Sat Mar 26 07:55:42 2005
Subject: [Rd] RGUI font problem (PR#7749)
Message-ID: <20050326065528.34EC6C702@slim.kubism.ku.dk>

Full_Name: Christos Hatzis
Version: 2.0.1 patched (2005-02-18)
OS: WinXP SP2
Submission from: (NULL) (24.61.19.101)


I had encountered a similar problem when changing the font in the R Console and
then then open the graphics device by plot(), the console window whites out. 
this might be related to bug report 7271.  I mentioned it sometime back and was
told is was not reproducible.

Now I have encountered a similar problem that does not appear to relate to the
graphics device. I started an R session, changed the font to size 8, Apply/OK. 
Then I opened a help page by typing 
> ?plot
the R help page opened in a different (system?) font and the font in the console
also changed to the same bold-face, non-proportional font.  Then when I typed
another help command, the console completely blanked out.

There seems to be some strange interaction going on between new windows opened
by the system and the font setting in the GUI preferences.

From ripley at stats.ox.ac.uk  Sat Mar 26 08:24:29 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Mar 26 08:24:49 2005
Subject: [Rd] RGUI font problem (PR#7749)
In-Reply-To: <20050326065528.34EC6C702@slim.kubism.ku.dk>
References: <20050326065528.34EC6C702@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503260718110.17910@gannet.stats>

This would appear to be the same as PR#7277.  That too is not really 
reproducible.

One possible crucial piece of missing information: is RGui being run in 
SDi or MDI mode?

On Sat, 26 Mar 2005 christos@nuverabio.com wrote:

> Full_Name: Christos Hatzis
> Version: 2.0.1 patched (2005-02-18)
> OS: WinXP SP2
> Submission from: (NULL) (24.61.19.101)
>
>
> I had encountered a similar problem when changing the font in the R Console and
> then then open the graphics device by plot(), the console window whites out.
> this might be related to bug report 7271.  I mentioned it sometime back and was
> told is was not reproducible.
>
> Now I have encountered a similar problem that does not appear to relate to the
> graphics device. I started an R session, changed the font to size 8, Apply/OK.
> Then I opened a help page by typing
>> ?plot
> the R help page opened in a different (system?) font and the font in the console
> also changed to the same bold-face, non-proportional font.  Then when I typed
> another help command, the console completely blanked out.

It is almost certainly not blank, just using the wrong foreground colour.

> There seems to be some strange interaction going on between new windows opened
> by the system and the font setting in the GUI preferences.

Yes, and that is PR#7277.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Sat Mar 26 17:28:19 2005
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Mar 26 17:30:16 2005
Subject: [Rd] na.omit error message
References: <loom.20050326T034901-417@post.gmane.org>
Message-ID: <loom.20050326T172614-258@post.gmane.org>

Gabor Grothendieck <ggrothendieck <at> myway.com> writes:

: 
: If I create a bivariate ts series with 3 time points and run
: na.omit on it expecting it to reduce it to a one point ts series
: instead I get the following error messasge:
: 
: R> hh <- ts(matrix(c(NA,1:4,NA),3), start = c(1951,8), freq=12)
: R> hh
:          Series 1 Series 2
: Aug 1951       NA        3
: Sep 1951        1        4
: Oct 1951        2       NA
: R> na.omit(hh)
: Error in "tsp<-"(`*tmp*`, value = c(1951.66666666667, 1951.66666666667,  : 
:         invalid time series parameters specified
: 
: If I replace na.omit with na.contiguous then I get a protection stack
: overflow:
: 
: R> na.contiguous(hh)
: Error: protect(): protection stack overflow
: 
: R> R.version.string # Windows XP
: [1] "R version 2.1.0, 2005-03-23"
: 
: Any comments on what is wrong?
: 



I am not sure if this is related to the last
problem or not but its a problem at any rate.
This is from R 2.1.0 March 23, 2005 on Windows XP.

1. stats:::.cbind.ts
====================

In stats:::.cbind.ts the line which is commented below
(which is currently in the existing R code) should 
be replaced by the line following it which I have 
added to take into account floating point 
approximations:

    if (union) {
        st <- min(tsps[1, ])
        en <- max(tsps[2, ])
    }
    else {
        st <- max(tsps[1, ])
        en <- min(tsps[2, ])
        # if (st > en) {
	if (st > en + getOption("ts.eps")) {  # replaces commented line
            warning("non-intersecting series")
            return(NULL)
        }
    }

2. stats:::window.default
=================

Also, for the same reason, in stats:::window.default, the 
line which I have commented should be changed to the
following line that is not commented:

    # if (start > end) 
    if (start > end + ts.eps)  # replaces commented line
        stop("'start' cannot be after 'end'")

also to take into account floating point approximations.

From Gregor.Gorjanc at bfro.uni-lj.si  Sun Mar 27 03:26:39 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Sun Mar 27 03:26:54 2005
Subject: [Rd] F90
Message-ID: <7FFEE688B57D7346BC6241C55900E730B70004@pollux.bfro.uni-lj.si>

Hello!

Has anyone successfully compiled F90 sources in R-package? I found the
same question on r-devel list from 2002 and I wonder if there is any
progress. I heard that g95 and gfortran can be usable. 

And one more thing. I have a program written in F90 and lets suppose that
compiler is not a problem. I've read manual 'Writing R Extensions' and
successfully loaded one F77 subroutine in R for test and I had no problem. 
However, what is the strategy if one has a whole program i.e. main program 
+ subroutines and wants to call it from R?

Thanks in advance!

--
Lep pozdrav / With regards,
    Gregor Gorjanc

------------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty       URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department    email: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                  tel: +386 (0)1 72 17 861
SI-1230 Domzale            fax: +386 (0)1 72 17 888
Slovenia

From stefano.iacus at unimi.it  Sun Mar 27 19:00:11 2005
From: stefano.iacus at unimi.it (stefano iacus)
Date: Sun Mar 27 19:00:55 2005
Subject: [Rd] R fails to start (PR#7747)
In-Reply-To: <20050325154835.66235AD74@slim.kubism.ku.dk>
References: <20050325154835.66235AD74@slim.kubism.ku.dk>
Message-ID: <ce5d873288e2c65aa4034932043e513d@unimi.it>

Please open the Console.app in Applications/Utilities and send us some 
more feedback.
stefano

On 25/mar/05, at 16:48, kirschenbaumss@npt.nuwc.navy.mil wrote:

> Full_Name: Susan Kirschenbaum
> Version: 2.0.1
> OS: Mac OS 10.3.8
> Submission from: (NULL) (164.223.72.7)
>
>
> R failes to start. The console opens but, before fully loaded, it quits
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From christos at nuverabio.com  Sun Mar 27 21:18:27 2005
From: christos at nuverabio.com (Christos Hatzis)
Date: Sun Mar 27 21:21:11 2005
Subject: [Rd] RGUI font problem (PR#7749)
In-Reply-To: <Pine.LNX.4.61.0503260718110.17910@gannet.stats>
Message-ID: <200503271920.j2RJKg408583@drac.host4u.net>

It is running on MDI mode (default).

It appears that if I save the preferences in the default (My Documents)
folder after I make the change, the problem disappears.  I was just
"Apply"-ing the changes and then "OK" without saving the new preferences
first.  As a result, I did not have an Rconsole file in My Documents.

This might be the reason why the problem was not reproducible by the
development team. 

Thanks for you time.
-Christos 

-----Original Message-----
From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
Sent: Saturday, March 26, 2005 2:24 AM
To: christos@nuverabio.com
Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
Subject: Re: [Rd] RGUI font problem (PR#7749)

This would appear to be the same as PR#7277.  That too is not really
reproducible.

One possible crucial piece of missing information: is RGui being run in SDi
or MDI mode?

On Sat, 26 Mar 2005 christos@nuverabio.com wrote:

> Full_Name: Christos Hatzis
> Version: 2.0.1 patched (2005-02-18)
> OS: WinXP SP2
> Submission from: (NULL) (24.61.19.101)
>
>
> I had encountered a similar problem when changing the font in the R 
> Console and then then open the graphics device by plot(), the console
window whites out.
> this might be related to bug report 7271.  I mentioned it sometime 
> back and was told is was not reproducible.
>
> Now I have encountered a similar problem that does not appear to 
> relate to the graphics device. I started an R session, changed the font to
size 8, Apply/OK.
> Then I opened a help page by typing
>> ?plot
> the R help page opened in a different (system?) font and the font in 
> the console also changed to the same bold-face, non-proportional font.  
> Then when I typed another help command, the console completely blanked
out.

It is almost certainly not blank, just using the wrong foreground colour.

> There seems to be some strange interaction going on between new 
> windows opened by the system and the font setting in the GUI preferences.

Yes, and that is PR#7277.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From kjetil at acelerate.com  Tue Mar 29 03:15:06 2005
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Tue Mar 29 03:18:36 2005
Subject: [Rd] strange error with rw2010dev
Message-ID: <4248AC1A.3020104@acelerate.com>

With rw2010dev I get a strange  protect(): protection stack overflow
error with a small data frame which otherwise is usable:

If anybody wants to have a look I can provide an RData file
with the problematic data frame.

Doesn't seem to be necessary, the following simulated example
generates the error:

 > testmat <- matrix(1:80, 20,4)
 > dim(testmat)
[1] 20  4
 > str(testmat)
 int [1:20, 1:4] 1 2 3 4 5 6 7 8 9 10 ...
 > testframe <- data.frame(testmat=I(testmat),
    x=rnorm(20), y=rnorm(20), z=sample(1:20))
 > str(testframe)
`data.frame':   20 obs. of  4 variables:
 $ testmat: int [1:20, 1:4] 1 2 3 4 5 6 7 8 9 10 ...
  ..- attr(*, "class")= chr "AsIs"
 $ x      : num   0.768 -0.462  0.450  0.476 -1.077 ...
 $ y      : num   0.453  1.227 -1.514 -0.904 -0.129 ...
 $ z      : int  10 4 15 19 14 3 9 17 18 5 ...
 > summary(testframe)
Error: protect(): protection stack overflow


Kjetil

-- 

Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra





-- 
No virus found in this outgoing message.
Checked by AVG Anti-Virus.

From tlumley at u.washington.edu  Tue Mar 29 03:34:57 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue Mar 29 03:35:17 2005
Subject: [Rd] strange error with rw2010dev
In-Reply-To: <4248AC1A.3020104@acelerate.com>
References: <4248AC1A.3020104@acelerate.com>
Message-ID: <Pine.A41.4.61b.0503281731450.345630@homer03.u.washington.edu>

On Mon, 28 Mar 2005, Kjetil Brinchmann Halvorsen wrote:

>> testmat <- matrix(1:80, 20,4)
>> dim(testmat)
> [1] 20  4
>> str(testmat)
> int [1:20, 1:4] 1 2 3 4 5 6 7 8 9 10 ...
>> testframe <- data.frame(testmat=I(testmat),
>   x=rnorm(20), y=rnorm(20), z=sample(1:20))
>> str(testframe)
> `data.frame':   20 obs. of  4 variables:
> $ testmat: int [1:20, 1:4] 1 2 3 4 5 6 7 8 9 10 ...
> ..- attr(*, "class")= chr "AsIs"
> $ x      : num   0.768 -0.462  0.450  0.476 -1.077 ...
> $ y      : num   0.453  1.227 -1.514 -0.904 -0.129 ...
> $ z      : int  10 4 15 19 14 3 9 17 18 5 ...
>> summary(testframe)
> Error: protect(): protection stack overflow
>

Yes, you're getting infinite recursion.

summary.data.frame calls summary.matrix to handle the first column, and 
this then calls summary.data.frame on data.frame(testframe[[1]]), but
> str(data.frame(testframe[[1]]))
`data.frame':   20 obs. of  1 variable:
  $ testframe..1..: int [1:20, 1:4] 1 2 3 4 5 6 7 8 9 10 ...
   ..- attr(*, "class")= chr "AsIs"

so round and round we go. Perhaps summary.matrix should do something to 
remove the AsIs attribute?

 	-thomas

From murdoch at stats.uwo.ca  Tue Mar 29 03:53:49 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Mar 29 03:54:19 2005
Subject: [Rd] RGUI font problem (PR#7749)
In-Reply-To: <200503271920.j2RJKg408583@drac.host4u.net>
References: <Pine.LNX.4.61.0503260718110.17910@gannet.stats>
	<200503271920.j2RJKg408583@drac.host4u.net>
Message-ID: <t6dh41h2t0gj1v8dr42e6a1ghcqb8mu8m5@4ax.com>

On Sun, 27 Mar 2005 14:18:27 -0500, "Christos Hatzis"
<christos@nuverabio.com> wrote :

>It is running on MDI mode (default).
>
>It appears that if I save the preferences in the default (My Documents)
>folder after I make the change, the problem disappears.  I was just
>"Apply"-ing the changes and then "OK" without saving the new preferences
>first.  As a result, I did not have an Rconsole file in My Documents.
>
>This might be the reason why the problem was not reproducible by the
>development team. 

I think there's still something else:  I don't see it when I follow
your instructions above.

Duncan Murdoch

>
>Thanks for you time.
>-Christos 
>
>-----Original Message-----
>From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
>Sent: Saturday, March 26, 2005 2:24 AM
>To: christos@nuverabio.com
>Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
>Subject: Re: [Rd] RGUI font problem (PR#7749)
>
>This would appear to be the same as PR#7277.  That too is not really
>reproducible.
>
>One possible crucial piece of missing information: is RGui being run in SDi
>or MDI mode?
>
>On Sat, 26 Mar 2005 christos@nuverabio.com wrote:
>
>> Full_Name: Christos Hatzis
>> Version: 2.0.1 patched (2005-02-18)
>> OS: WinXP SP2
>> Submission from: (NULL) (24.61.19.101)
>>
>>
>> I had encountered a similar problem when changing the font in the R 
>> Console and then then open the graphics device by plot(), the console
>window whites out.
>> this might be related to bug report 7271.  I mentioned it sometime 
>> back and was told is was not reproducible.
>>
>> Now I have encountered a similar problem that does not appear to 
>> relate to the graphics device. I started an R session, changed the font to
>size 8, Apply/OK.
>> Then I opened a help page by typing
>>> ?plot
>> the R help page opened in a different (system?) font and the font in 
>> the console also changed to the same bold-face, non-proportional font.  
>> Then when I typed another help command, the console completely blanked
>out.
>
>It is almost certainly not blank, just using the wrong foreground colour.
>
>> There seems to be some strange interaction going on between new 
>> windows opened by the system and the font setting in the GUI preferences.
>
>Yes, and that is PR#7277.

From murdoch at stats.uwo.ca  Tue Mar 29 03:54:09 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Tue Mar 29 03:54:25 2005
Subject: [Rd] RGUI font problem (PR#7749)
Message-ID: <20050329015409.71905AC45@slim.kubism.ku.dk>

On Sun, 27 Mar 2005 14:18:27 -0500, "Christos Hatzis"
<christos@nuverabio.com> wrote :

>It is running on MDI mode (default).
>
>It appears that if I save the preferences in the default (My Documents)
>folder after I make the change, the problem disappears.  I was just
>"Apply"-ing the changes and then "OK" without saving the new preferences
>first.  As a result, I did not have an Rconsole file in My Documents.
>
>This might be the reason why the problem was not reproducible by the
>development team. 

I think there's still something else:  I don't see it when I follow
your instructions above.

Duncan Murdoch

>
>Thanks for you time.
>-Christos 
>
>-----Original Message-----
>From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
>Sent: Saturday, March 26, 2005 2:24 AM
>To: christos@nuverabio.com
>Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
>Subject: Re: [Rd] RGUI font problem (PR#7749)
>
>This would appear to be the same as PR#7277.  That too is not really
>reproducible.
>
>One possible crucial piece of missing information: is RGui being run in SDi
>or MDI mode?
>
>On Sat, 26 Mar 2005 christos@nuverabio.com wrote:
>
>> Full_Name: Christos Hatzis
>> Version: 2.0.1 patched (2005-02-18)
>> OS: WinXP SP2
>> Submission from: (NULL) (24.61.19.101)
>>
>>
>> I had encountered a similar problem when changing the font in the R 
>> Console and then then open the graphics device by plot(), the console
>window whites out.
>> this might be related to bug report 7271.  I mentioned it sometime 
>> back and was told is was not reproducible.
>>
>> Now I have encountered a similar problem that does not appear to 
>> relate to the graphics device. I started an R session, changed the font to
>size 8, Apply/OK.
>> Then I opened a help page by typing
>>> ?plot
>> the R help page opened in a different (system?) font and the font in 
>> the console also changed to the same bold-face, non-proportional font.  
>> Then when I typed another help command, the console completely blanked
>out.
>
>It is almost certainly not blank, just using the wrong foreground colour.
>
>> There seems to be some strange interaction going on between new 
>> windows opened by the system and the font setting in the GUI preferences.
>
>Yes, and that is PR#7277.

From berwin at maths.uwa.edu.au  Tue Mar 29 05:53:56 2005
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue Mar 29 05:54:26 2005
Subject: [Rd] improved pairs.formula?
Message-ID: <16968.53588.237010.198357@bossiaea.maths.uwa.edu.au>

Dear all,

I would like to suggest changing the pairs.formula command such that a
command like

        pairs(GNP ~ . - Year - GNP.deflator, longley)

would behave in a similar fashion as 

        lm(GNP ~ . - Year - GNP.deflator, longley)

i.e., make a pairwise scatterplot of GNP and all other variables in
the (longley) dataframe except for Year and GNP.deflator.  The above
command, with the current version of pairs.formula, produces a
pairwise scatterplot of all variables in the (longley) dataframe.

After some tinkering around, I came up with the following replacement
function of pairs.formula which seems to do the job:

    pairs.formula <- 
    function (formula, data = NULL, ..., subset, na.action = stats::na.pass) 
    {
      m <- match.call(expand.dots = FALSE)
      if (is.matrix(eval(m$data, parent.frame()))) 
        m$data <- as.data.frame(data)
      m$... <- NULL
      m$na.action <- stats::na.pass
      m[[1]] <- as.name("model.frame")
      mf <- eval(m, parent.frame())
    
      mt <- attr(mf, "terms")
      tmp <- attr(mt, "factors")
      ind <- apply(tmp, 1, max)
      sv <- rownames(tmp)[ind>0]
      ind <- match(sv,
                   sapply(attr(mt, "variables"), deparse, width.cutoff=500)[-1])
      if( (tt <- attr(mt, "response")) != 0 ){
        ind <- c(tt, ind)
      }
    
      pairs(mf[,ind], ...)
    }

Would you please kindly consider replacing the current pairs.formula
function (at the top of the file src/library/graphics/R/pairs.R) with
the above function?

Best wishes,

        Berwin

========================== Full address ============================
Berwin A Turlach                      Tel.: +61 (8) 6488 3338 (secr)   
School of Mathematics and Statistics        +61 (8) 6488 3383 (self)      
The University of Western Australia   FAX : +61 (8) 6488 1028
35 Stirling Highway                   
Crawley WA 6009                e-mail: berwin@maths.uwa.edu.au
Australia                        http://www.maths.uwa.edu.au/~berwin

From ripley at stats.ox.ac.uk  Tue Mar 29 09:17:31 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 29 09:18:09 2005
Subject: [Rd] improved pairs.formula?
In-Reply-To: <16968.53588.237010.198357@bossiaea.maths.uwa.edu.au>
References: <16968.53588.237010.198357@bossiaea.maths.uwa.edu.au>
Message-ID: <Pine.LNX.4.61.0503290738350.25178@gannet.stats>

On Tue, 29 Mar 2005, Berwin A Turlach wrote:

> Dear all,
>
> I would like to suggest changing the pairs.formula command such that a
> command like
>
>        pairs(GNP ~ . - Year - GNP.deflator, longley)
>
> would behave in a similar fashion as
>
>        lm(GNP ~ . - Year - GNP.deflator, longley)
>
> i.e., make a pairwise scatterplot of GNP and all other variables in
> the (longley) dataframe except for Year and GNP.deflator.  The above
> command, with the current version of pairs.formula, produces a
> pairwise scatterplot of all variables in the (longley) dataframe.
>
> After some tinkering around, I came up with the following replacement
> function of pairs.formula which seems to do the job:
>
>    pairs.formula <-
>    function (formula, data = NULL, ..., subset, na.action = stats::na.pass)
>    {
>      m <- match.call(expand.dots = FALSE)
>      if (is.matrix(eval(m$data, parent.frame())))
>        m$data <- as.data.frame(data)
>      m$... <- NULL
>      m$na.action <- stats::na.pass
>      m[[1]] <- as.name("model.frame")
>      mf <- eval(m, parent.frame())
>
>      mt <- attr(mf, "terms")
>      tmp <- attr(mt, "factors")
>      ind <- apply(tmp, 1, max)
>      sv <- rownames(tmp)[ind>0]
>      ind <- match(sv,
>                   sapply(attr(mt, "variables"), deparse, width.cutoff=500)[-1])
>      if( (tt <- attr(mt, "response")) != 0 ){
>        ind <- c(tt, ind)
>      }
>
>      pairs(mf[,ind], ...)
>    }
>
> Would you please kindly consider replacing the current pairs.formula
> function (at the top of the file src/library/graphics/R/pairs.R) with
> the above function?

Perhaps you could explain what precisely 'the job' is and why you chose 
such an unusual piece of code to do it?  (E.g. what is the prescription 
for the ordering of terms, and why do you think the rownames of the 
factors and the variables might be in different orders?  They are set the 
same in the C code.)

BTW, the help page specifically warns against a formula of the type you 
specified.  Why do you want to allow a response?  Currently only '+' is 
documented to work.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From berwin at maths.uwa.edu.au  Tue Mar 29 10:00:23 2005
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue Mar 29 10:00:51 2005
Subject: [Rd] improved pairs.formula?
In-Reply-To: <Pine.LNX.4.61.0503290738350.25178@gannet.stats>
References: <16968.53588.237010.198357@bossiaea.maths.uwa.edu.au>
	<Pine.LNX.4.61.0503290738350.25178@gannet.stats>
Message-ID: <16969.2839.144336.754249@bossiaea.maths.uwa.edu.au>

Dear Brian,

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

    BDR> On Tue, 29 Mar 2005, Berwin A Turlach wrote:
    >> Dear all,
    >> 
    >> I would like to suggest changing the pairs.formula command such
    >> that a command like
    >> [...]

    BDR> Perhaps you could explain what precisely 'the job' is
Sorry, for not making it clear enough, must be that English is my
second language.  What I meant is, that with the above definition of
pairs.formula a command like
        pairs(GNP ~ . - Year - GNP.deflator, longley)
would only produce a pairwise scatterplot of GNP and all other
variables in the dataframe except for Year and GNP.deflator.  And,
incidentally, so would 
        pairs( ~ . - Year - GNP.deflator, longley)

    BDR> and why you chose such an unusual piece of code to do it?
Mmh, I don't think of it as being so unusual, most of it was gleaned
from other R function.  Well, I realise that R programing paradigms
change over the years, so I must have gotten them from quite old
routine.

    BDR> (E.g. what is the prescription for the ordering of terms, and
    BDR> why do you think the rownames of the factors and the
    BDR> variables might be in different orders?  They are set the
    BDR> same in the C code.)
In case that a user foolishly specifies a more complicated formula
having not read the help pages.  It seemed to me that this was the
only construct to figure out which variables are actually appearing in
terms of the formula.

    BDR> BTW, the help page specifically warns against a formula of
    BDR> the type you specified.
Does it?  I searched the help page (R 2.0.1) for `.' and couldn't find
anything about not using it in a formula.  But then, again, perhaps I
missed something with English being my second language......

    BDR> Why do you want to allow a response?
Why not, the current version allows it too. At least the help page in
my version of R states:

        (A response will be interpreted as another variable, but not
        treated specially, so it is confusing to use one.)

Actually, I noticed that the response variable will always be in the
top row, so it is treated specially.  Try it out and compare:

> pairs(longley)
> pairs(GNP ~ ., longley)


    BDR> Currently only '+' is documented to work.
The help page for pairs in my version of R states:

 formula: a formula, such as '~ x + y + z'.  Each term will give a
          separate variable in the pairs plot, so terms should be
          numeric vectors.  (A response will be interpreted as another
          variable, but not treated specially, so it is confusing to
          use one.)

I don't interpret this as "only '+' is documented to work".  For me
this is just an example of an allowed formula, but an exhaustive
listing of those formulas that are allowed.  But then, despite the
danger of repeating myself, English is only my second language....

Best wishes,

        Berwin

========================== Full address ============================
Berwin A Turlach                      Tel.: +61 (8) 6488 3338 (secr)   
School of Mathematics and Statistics        +61 (8) 6488 3383 (self)      
The University of Western Australia   FAX : +61 (8) 6488 1028
35 Stirling Highway                   
Crawley WA 6009                e-mail: berwin@maths.uwa.edu.au
Australia                        http://www.maths.uwa.edu.au/~berwin

From ripley at stats.ox.ac.uk  Tue Mar 29 10:09:57 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 29 10:10:40 2005
Subject: [Rd] improved pairs.formula?
In-Reply-To: <16969.2839.144336.754249@bossiaea.maths.uwa.edu.au>
References: <16968.53588.237010.198357@bossiaea.maths.uwa.edu.au>
	<Pine.LNX.4.61.0503290738350.25178@gannet.stats>
	<16969.2839.144336.754249@bossiaea.maths.uwa.edu.au>
Message-ID: <Pine.LNX.4.61.0503290902160.30722@gannet.stats>

On Tue, 29 Mar 2005, Berwin A Turlach wrote:

> Dear Brian,
>
>>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
>
>    BDR> On Tue, 29 Mar 2005, Berwin A Turlach wrote:
>    >> Dear all,
>    >>
>    >> I would like to suggest changing the pairs.formula command such
>    >> that a command like
>    >> [...]
>
>    BDR> Perhaps you could explain what precisely 'the job' is
> Sorry, for not making it clear enough, must be that English is my
> second language.  What I meant is, that with the above definition of
> pairs.formula a command like
>        pairs(GNP ~ . - Year - GNP.deflator, longley)
> would only produce a pairwise scatterplot of GNP and all other
> variables in the dataframe except for Year and GNP.deflator.  And,
> incidentally, so would
>        pairs( ~ . - Year - GNP.deflator, longley)

Still not a description, just two examples.  Since later on you took a 
description to be an example, I see the confusion.

>    BDR> and why you chose such an unusual piece of code to do it?

> Mmh, I don't think of it as being so unusual, most of it was gleaned
> from other R function.  Well, I realise that R programing paradigms
> change over the years, so I must have gotten them from quite old
> routine.

I guess you got it from an S not R function.

>    BDR> (E.g. what is the prescription for the ordering of terms, and
>    BDR> why do you think the rownames of the factors and the
>    BDR> variables might be in different orders?  They are set the
>    BDR> same in the C code.)
> In case that a user foolishly specifies a more complicated formula
> having not read the help pages.  It seemed to me that this was the
> only construct to figure out which variables are actually appearing in
> terms of the formula.

Really?  Please check what I wrote: `variables' and `rownames of the 
factors' are always the same, apart from the response.  Please show an 
example where you got something different.

>    BDR> BTW, the help page specifically warns against a formula of
>    BDR> the type you specified.
> Does it?  I searched the help page (R 2.0.1) for `.' and couldn't find
> anything about not using it in a formula.  But then, again, perhaps I
> missed something with English being my second language......
>
>    BDR> Why do you want to allow a response?

> Why not, the current version allows it too. At least the help page in
> my version of R states:
>
>        (A response will be interpreted as another variable, but not
>        treated specially, so it is confusing to use one.)
>
> Actually, I noticed that the response variable will always be in the
> top row, so it is treated specially.  Try it out and compare:
>
>> pairs(longley)
>> pairs(GNP ~ ., longley)

Yes, but those are different pairs() methods.  It is the same as
pairs(~ GNP + ., longley), so it is not treated specially.

>    BDR> Currently only '+' is documented to work.
> The help page for pairs in my version of R states:
>
> formula: a formula, such as '~ x + y + z'.  Each term will give a
>          separate variable in the pairs plot, so terms should be
>          numeric vectors.  (A response will be interpreted as another
>          variable, but not treated specially, so it is confusing to
>          use one.)
>
> I don't interpret this as "only '+' is documented to work".  For me
> this is just an example of an allowed formula, but an exhaustive
> listing of those formulas that are allowed.  But then, despite the
> danger of repeating myself, English is only my second language....

There are several places where only the allowed form of formulae is 
specified in this way.  You are not allowed interactions, for example, and 
it refers to `each term'.  `.' is not documented to work (and used not 
to).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Mar 29 10:33:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 29 10:34:13 2005
Subject: [Rd] RGUI font problem (PR#7749)
In-Reply-To: <t6dh41h2t0gj1v8dr42e6a1ghcqb8mu8m5@4ax.com>
References: <Pine.LNX.4.61.0503260718110.17910@gannet.stats>
	<200503271920.j2RJKg408583@drac.host4u.net>
	<t6dh41h2t0gj1v8dr42e6a1ghcqb8mu8m5@4ax.com>
Message-ID: <Pine.LNX.4.61.0503290915060.30824@gannet.stats>

On Mon, 28 Mar 2005, Duncan Murdoch wrote:

> On Sun, 27 Mar 2005 14:18:27 -0500, "Christos Hatzis"
> <christos@nuverabio.com> wrote :
>
>> It is running on MDI mode (default).
>>
>> It appears that if I save the preferences in the default (My Documents)
>> folder after I make the change, the problem disappears.  I was just
>> "Apply"-ing the changes and then "OK" without saving the new preferences
>> first.  As a result, I did not have an Rconsole file in My Documents.
>>
>> This might be the reason why the problem was not reproducible by the
>> development team.
>
> I think there's still something else:  I don't see it when I follow
> your instructions above.

This like PR#7277 fails for me in MDI mode but not SDI mode.
I have tracked it down to editorsetfont (in editor.c) which does
setfont(f).  That is incorrect, as there is no current window, and there 
may be no editor windows at all.  So it was setting the font on a 
random window and the effect will be unpredictable (and hence hard to 
fix).

So the problem was introduced by the editor code in 2.0.0.


> Duncan Murdoch
>
>>
>> Thanks for you time.
>> -Christos
>>
>> -----Original Message-----
>> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
>> Sent: Saturday, March 26, 2005 2:24 AM
>> To: christos@nuverabio.com
>> Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
>> Subject: Re: [Rd] RGUI font problem (PR#7749)
>>
>> This would appear to be the same as PR#7277.  That too is not really
>> reproducible.
>>
>> One possible crucial piece of missing information: is RGui being run in SDi
>> or MDI mode?
>>
>> On Sat, 26 Mar 2005 christos@nuverabio.com wrote:
>>
>>> Full_Name: Christos Hatzis
>>> Version: 2.0.1 patched (2005-02-18)
>>> OS: WinXP SP2
>>> Submission from: (NULL) (24.61.19.101)
>>>
>>>
>>> I had encountered a similar problem when changing the font in the R
>>> Console and then then open the graphics device by plot(), the console
>> window whites out.
>>> this might be related to bug report 7271.  I mentioned it sometime
>>> back and was told is was not reproducible.
>>>
>>> Now I have encountered a similar problem that does not appear to
>>> relate to the graphics device. I started an R session, changed the font to
>> size 8, Apply/OK.
>>> Then I opened a help page by typing
>>>> ?plot
>>> the R help page opened in a different (system?) font and the font in
>>> the console also changed to the same bold-face, non-proportional font.
>>> Then when I typed another help command, the console completely blanked
>> out.
>>
>> It is almost certainly not blank, just using the wrong foreground colour.
>>
>>> There seems to be some strange interaction going on between new
>>> windows opened by the system and the font setting in the GUI preferences.
>>
>> Yes, and that is PR#7277.
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Mar 29 10:34:08 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue Mar 29 10:34:24 2005
Subject: [Rd] RGUI font problem (PR#7749)
Message-ID: <20050329083408.D67ECC709@slim.kubism.ku.dk>

On Mon, 28 Mar 2005, Duncan Murdoch wrote:

> On Sun, 27 Mar 2005 14:18:27 -0500, "Christos Hatzis"
> <christos@nuverabio.com> wrote :
>
>> It is running on MDI mode (default).
>>
>> It appears that if I save the preferences in the default (My Documents)
>> folder after I make the change, the problem disappears.  I was just
>> "Apply"-ing the changes and then "OK" without saving the new preferences
>> first.  As a result, I did not have an Rconsole file in My Documents.
>>
>> This might be the reason why the problem was not reproducible by the
>> development team.
>
> I think there's still something else:  I don't see it when I follow
> your instructions above.

This like PR#7277 fails for me in MDI mode but not SDI mode.
I have tracked it down to editorsetfont (in editor.c) which does
setfont(f).  That is incorrect, as there is no current window, and there 
may be no editor windows at all.  So it was setting the font on a 
random window and the effect will be unpredictable (and hence hard to 
fix).

So the problem was introduced by the editor code in 2.0.0.


> Duncan Murdoch
>
>>
>> Thanks for you time.
>> -Christos
>>
>> -----Original Message-----
>> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
>> Sent: Saturday, March 26, 2005 2:24 AM
>> To: christos@nuverabio.com
>> Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
>> Subject: Re: [Rd] RGUI font problem (PR#7749)
>>
>> This would appear to be the same as PR#7277.  That too is not really
>> reproducible.
>>
>> One possible crucial piece of missing information: is RGui being run in SDi
>> or MDI mode?
>>
>> On Sat, 26 Mar 2005 christos@nuverabio.com wrote:
>>
>>> Full_Name: Christos Hatzis
>>> Version: 2.0.1 patched (2005-02-18)
>>> OS: WinXP SP2
>>> Submission from: (NULL) (24.61.19.101)
>>>
>>>
>>> I had encountered a similar problem when changing the font in the R
>>> Console and then then open the graphics device by plot(), the console
>> window whites out.
>>> this might be related to bug report 7271.  I mentioned it sometime
>>> back and was told is was not reproducible.
>>>
>>> Now I have encountered a similar problem that does not appear to
>>> relate to the graphics device. I started an R session, changed the font to
>> size 8, Apply/OK.
>>> Then I opened a help page by typing
>>>> ?plot
>>> the R help page opened in a different (system?) font and the font in
>>> the console also changed to the same bold-face, non-proportional font.
>>> Then when I typed another help command, the console completely blanked
>> out.
>>
>> It is almost certainly not blank, just using the wrong foreground colour.
>>
>>> There seems to be some strange interaction going on between new
>>> windows opened by the system and the font setting in the GUI preferences.
>>
>> Yes, and that is PR#7277.
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From berwin at maths.uwa.edu.au  Tue Mar 29 11:04:06 2005
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue Mar 29 11:04:31 2005
Subject: [Rd] improved pairs.formula?
In-Reply-To: <Pine.LNX.4.61.0503290902160.30722@gannet.stats>
References: <16968.53588.237010.198357@bossiaea.maths.uwa.edu.au>
	<Pine.LNX.4.61.0503290738350.25178@gannet.stats>
	<16969.2839.144336.754249@bossiaea.maths.uwa.edu.au>
	<Pine.LNX.4.61.0503290902160.30722@gannet.stats>
Message-ID: <16969.6662.660587.374624@bossiaea.maths.uwa.edu.au>

Dear Brian,

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

    [...]
    BDR> Still not a description, just two examples.
O.k., I believe that I slowly understand want you want.  So in my book
a description of "the job" would be: "that it is allowed to use '.' and
'-' in the formula given to pairs thus allowing pairs.formula".

    BDR> Since later on you took a description to be an example, I see
    BDR> the confusion.
Just to avoid future confusion, so how does one distinguish a
description from an example, especially if the description is after
the phrase "such as"

    BDR> and why you chose such an unusual piece of code to do it?
    >> Mmh, I don't think of it as being so unusual, most of it was
    >> gleaned from other R function.  Well, I realise that R
    >> programing paradigms change over the years, so I must have
    >> gotten them from quite old routine.
    BDR> I guess you got it from an S not R function.
Quite possible.  Sorry, I can't check since I never had access to S.

    BDR> (E.g. what is the prescription for the ordering of terms, and
    BDR> why do you think the rownames of the factors and the
    BDR> variables might be in different orders?  They are set the
    BDR> same in the C code.)
    >> In case that a user foolishly specifies a more complicated
    >> formula having not read the help pages.  It seemed to me that
    >> this was the only construct to figure out which variables are
    >> actually appearing in terms of the formula.
    BDR> Really?  Please check what I wrote: `variables' and `rownames
    BDR> of the factors' are always the same, apart from the response.
    BDR> Please show an example where you got something different.
Sorry, seems to be some misunderstanding here.  With 'variables' you
mean the "variables" attribute of the object extracted by "mt <-
attr(mf, "terms")" in my code?  It is well possible that this is
always in the same order as the rownames of the factors but I didn't
find that in the documentation and I didn't study the C code to write
this function.  But I take your word for it and in this case I can see
how the code could be simplified.  Shall I submit a revised version or
not bother?

    BDR> There are several places where only the allowed form of
    BDR> formulae is specified in this way.
In this case, may I request that this places are better marked than
they are at the moment? 

    BDR> You are not allowed interactions, for example, and it refers
    BDR> to `each term'.
Indeed, it states "Each term will give a separate variable in the
pairs plot, so terms should be numeric vectors".  So some users might
be surprise that the following works:

> dat <- data.frame(x=rnorm(30), y=rnorm(30), f=rep(c("A","B", "C"), 10))
> pairs(~x+y+f, dat)

Who, but the most arduous student of R help page language would have
thought that dat$f is a numeric vector?  :-))

    BDR> `.'  is not documented to work (and used not to).
So the question is whether it should remain this way or not.  But that
is for the R core team to decide and I shall stop my contributions to
this thread now.

Cheers,

        Berwin

========================== Full address ============================
Berwin A Turlach                      Tel.: +61 (8) 6488 3338 (secr)   
School of Mathematics and Statistics        +61 (8) 6488 3383 (self)      
The University of Western Australia   FAX : +61 (8) 6488 1028
35 Stirling Highway                   
Crawley WA 6009                e-mail: berwin@maths.uwa.edu.au
Australia                        http://www.maths.uwa.edu.au/~berwin

From buser at stat.math.ethz.ch  Tue Mar 29 11:08:48 2005
From: buser at stat.math.ethz.ch (Christoph Buser)
Date: Tue Mar 29 11:09:02 2005
Subject: [Rd] setAs between a new S4 class and "POSIXlt"
Message-ID: <16969.6944.571953.817446@stat.math.ethz.ch>

Dear R core team

Please apologize for posting the same question twice on R-help and
R-devel. Since I was not sure which list is appropriate I tried R-help (Tue
Mar 22), but got no answer.  
Now I do not know if the formulation of my question was unclear or the
question is not so easy to answer or to easy (what I do not hope).

My problem: I create a new S4 class, containing one slot, data (of class
	    POSIXlt). I tried to define a transformation via setAs()
	    between the new S4 class and the existing "POSIXlt" class that is 
	    virtual S4 Class with subclass "POSIXt".
	    Then using as() gives an error message (see code below) when I
	    transform from "POSIXlt" to the new class.
	    Then I defined another as() from the subclass "POSIXt" to the
	    new class and now everything works well.

This is the point where I do not understand what happens and why it works
like this. I'd be happy for some hints to improve my understanding (maybe
there is a help page or a reference).
I'd be happy with a confirmation of a better connoisseur of R than me, that
it is not so easy to understand, but correct, if that's the case. Thank you
very much.
Below I attached my R code.

Regards, 

Christoph Buser

--------------------------------------------------------------
Christoph Buser <buser@stat.math.ethz.ch>
Seminar fuer Statistik, LEO C11
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-5414		fax: 632-1228
http://stat.ethz.ch/~buser/
--------------------------------------------------------------

## R Code:

## Definition of my new S4 class
setClass("dtime",
         representation(data = "POSIXlt"),
         prototype(data = as.POSIXlt("2004/06/01")))

## Transformation between the new class "dtime" and "POSIXlt"
setAs("dtime", "POSIXlt", def = function(from) {
  from@data
})
setAs("POSIXlt", "dtime", def = function(from) {
  new("dtime", data = from)
})

## Create a new "dtime" object
(x1 <- new("dtime"))
str(x1)
## Transformation from "dtime" to "POSIXlt" works well
(y1 <- as(x1, "POSIXlt"))
str(y1)

## Create a new "POSIXlt" object
(y2 <- as.POSIXlt("2004/06/01"))
str(y2)
## Transformation from "POSIXlt" to "dtime" fails
as(y2, "dtime")
> Fehler in insertMethod(methods, sig, args, def, TRUE) : 
	inserting method into non-methods-list object (class "NULL")

## This works properly
new("dtime", data = y2)

## Now I put another setAs for the Subclass "POSIXt"
setAs("POSIXt", "dtime", def = function(from) {
  new("dtime", data = from)
})

## Now the transformation to "dtime" class works
as(y2, "dtime")

## I am using:
> version
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status   alpha            
major    2                
minor    1.0              
year     2005             
month    03               
day      24               
language R

From vosp at mail.ecu.edu  Tue Mar 29 16:52:07 2005
From: vosp at mail.ecu.edu (vosp@mail.ecu.edu)
Date: Tue Mar 29 16:52:22 2005
Subject: [Rd] zapsmall (PR#7755)
Message-ID: <20050329145207.3E123C6F9@slim.kubism.ku.dk>

Full_Name: Paul Vos
Version: 2.0.1
OS: windows XP
Submission from: (NULL) (150.216.148.20)


> zapsmall(.3-.2-.1,digits=7)
[1] -2.775558e-17

This should be zero.  By changing the condition
if (mx > 0)
in zapsmall to 
if (mx > 1)
we get

> zapsmall(.3-.2-.1,digits=7)
[1] 0

From ripley at stats.ox.ac.uk  Tue Mar 29 17:12:50 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Mar 29 17:13:08 2005
Subject: [Rd] zapsmall (PR#7755)
In-Reply-To: <20050329145207.3E123C6F9@slim.kubism.ku.dk>
References: <20050329145207.3E123C6F9@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503291557530.21319@gannet.stats>

On Tue, 29 Mar 2005 vosp@mail.ecu.edu wrote:

> Full_Name: Paul Vos
> Version: 2.0.1
> OS: windows XP
> Submission from: (NULL) (150.216.148.20)
>
>
>> zapsmall(.3-.2-.1,digits=7)
> [1] -2.775558e-17
>
> This should be zero.

Why `should' it?  The documentation says:

      'zapsmall' determines a 'digits' argument 'dr' for calling
      'round(x, digits = dr)' such that values "close to zero" (compared
      with the maximal absolute one) are "zapped", i.e., treated as '0'.

That value is not small compared with the maximal absolute one: it is 
equal to it.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From giovanty at certportal.com  Wed Mar 30 04:42:37 2005
From: giovanty at certportal.com (giovanty@certportal.com)
Date: Wed Mar 30 04:42:53 2005
Subject: [Rd] Preference for convenience and super value (PR#7758)
Message-ID: <20050330024237.1C92FC6E7@slim.kubism.ku.dk>

A better provider! It is your e-store for quality IINKS and superb benefits.

Select from all top ones! Cut down the expenses significantly at emart.

Select quick handling and dispensing that takes 2 to 3 days.

Experience timely support and professional assistance.

http://f.b.brightdew.com/ta/

Check our e-mart for top ones from Apple, Brother, Canon, Compaq, HP,
Lexmark, NEC and others!



Utk group the Guardian Angels.Tuesday morning,  enko is calling for peac
wife wasFo three days s E8
hy of her 57th
wice the energy of an adult dog  GOaai 0 Lags r Abbas, familiar ob 4 Cg

From mokada at md.tsukuba.ac.jp  Wed Mar 30 09:23:21 2005
From: mokada at md.tsukuba.ac.jp (mokada@md.tsukuba.ac.jp)
Date: Wed Mar 30 09:23:38 2005
Subject: [Rd] Mistype in CRAN mirror list(doc/CRAN_mirrors.csv) (PR#7759)
Message-ID: <20050330072321.9F019C710@slim.kubism.ku.dk>

Full_Name: Masafumi OKADA
Version: 2.0.1
OS: Windows
Submission from: (NULL) (130.158.158.65)


In the list of CRAN mirrors($R_HOME/doc/CRAN_mirrors.csv), I found a mistyping.

Mirror in University of Tsukuba is described as "Tsukaba", not "Tsukuba".
I know "Tsukuba" is correct, because I'm webmaster of this mirror :-)

Current:
"Japan (Tsukaba)",Japan,Tsukaba,http://cran.md.tsukuba.ac.jp/,"University of
Tsukuba"
Correct:
"Japan (Tsukuba)",Japan,Tsukuba,http://cran.md.tsukuba.ac.jp/,"University of
Tsukuba"

From ripley at stats.ox.ac.uk  Wed Mar 30 09:35:34 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Mar 30 09:35:56 2005
Subject: [Rd] Mistype in CRAN mirror list(doc/CRAN_mirrors.csv) (PR#7759)
In-Reply-To: <20050330072321.9F019C710@slim.kubism.ku.dk>
References: <20050330072321.9F019C710@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0503300830290.9769@gannet.stats>

On Wed, 30 Mar 2005 mokada@md.tsukuba.ac.jp wrote:

> Full_Name: Masafumi OKADA
> Version: 2.0.1
> OS: Windows
> Submission from: (NULL) (130.158.158.65)
>
>
> In the list of CRAN mirrors($R_HOME/doc/CRAN_mirrors.csv), I found a mistyping.
>
> Mirror in University of Tsukuba is described as "Tsukaba", not "Tsukuba".
> I know "Tsukuba" is correct, because I'm webmaster of this mirror :-)

It is so described in two of the four occurrences, fortunately not the 
most critical one, the URL (which is checked autmatically).

Thanks, corrected now.  For 2.1.0 these lists will be much more widely 
used, as all R users will be forced to choose a CRAN mirror.

> Current:
> "Japan (Tsukaba)",Japan,Tsukaba,http://cran.md.tsukuba.ac.jp/,"University of
> Tsukuba"
> Correct:
> "Japan (Tsukuba)",Japan,Tsukuba,http://cran.md.tsukuba.ac.jp/,"University of
> Tsukuba"

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From bhs2 at mevik.net  Thu Mar 31 16:20:12 2005
From: bhs2 at mevik.net (=?iso-8859-1?q?Bj=F8rn-Helge_Mevik?=)
Date: Thu Mar 31 16:20:25 2005
Subject: [Rd] R-alpha_2005-03-31: make check fails on Debian 3.0
Message-ID: <m03bubhp7n.fsf@bar.nemo-project.org>

I've just tested R-alpha_2005-03-31.tar.gz.  ./configure and make
ran without any apparent errors, but make check failed:

58 (0) $ make check 2>&1 | tee make_check-logg
make[1]: Entering directory `/usr/local/src/R/R-alpha/tests'
make[2]: Entering directory `/usr/local/src/R/R-alpha/tests'
make[3]: Entering directory `/usr/local/src/R/R-alpha/tests/Examples'
make[4]: Entering directory `/usr/local/src/R/R-alpha/tests/Examples'
make[4]: Leaving directory `/usr/local/src/R/R-alpha/tests/Examples'
make[4]: Entering directory `/usr/local/src/R/R-alpha/tests/Examples'
collecting examples for package 'base' ...
make[5]: Entering directory `/usr/local/src/R/R-alpha/src/library'
 >>> Building/Updating help pages for package 'base'
     Formats: text html latex example 
make[5]: Leaving directory `/usr/local/src/R/R-alpha/src/library'
running code in 'base-Ex.R' ... OK
collecting examples for package 'tools' ...
make[5]: Entering directory `/usr/local/src/R/R-alpha/src/library'
 >>> Building/Updating help pages for package 'tools'
     Formats: text html latex example 
make[5]: Leaving directory `/usr/local/src/R/R-alpha/src/library'
running code in 'tools-Ex.R' ... OK
collecting examples for package 'utils' ...
make[5]: Entering directory `/usr/local/src/R/R-alpha/src/library'
 >>> Building/Updating help pages for package 'utils'
     Formats: text html latex example 
make[5]: Leaving directory `/usr/local/src/R/R-alpha/src/library'
running code in 'utils-Ex.R' ...make[4]: *** [utils-Ex.Rout] Error 1
make[4]: Leaving directory `/usr/local/src/R/R-alpha/tests/Examples'
make[3]: *** [test-Examples-Base] Error 2
make[3]: Leaving directory `/usr/local/src/R/R-alpha/tests/Examples'
make[2]: *** [test-Examples] Error 2
make[2]: Leaving directory `/usr/local/src/R/R-alpha/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/usr/local/src/R/R-alpha/tests'
make: *** [check] Error 2
59 (0) $ 


The final part of tests/Examples/utils-Ex.Rout.fail reads

> cleanEx(); ..nameEx <- "help.search"
> 
> ### * help.search
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: help.search
> ### Title: Search the Help System
> ### Aliases: help.search print.hsearch
> ### Keywords: documentation
> 
> ### ** Examples
> 
> help.search("linear models")    # In case you forgot how to fit linear
Error in iconv(db[[i]][ind, ], enc, "") : 'iconv' is not available on this system
Execution halted


The parts of the output fron ./configure that meantion "iconv" is

checking iconv.h usability... yes
checking iconv.h presence... yes
checking for iconv.h... yes
checking for iconv... yes
checking whether iconv() accepts "UTF-8" and "latin1"... no
checking for iconvlist... no
[...]
checking for iconv... yes
checking for iconv declaration... 
         extern size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);

The only warnings I got was

checking whether makeinfo version is at least 4.7... no
configure: WARNING: you cannot build info or html versions of the R manuals

from ./configure, and

gcc -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre  -I. -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H   -g -O2 -c regex.c -o regex.o
regex.c:2525: warning: `noinline' attribute directive ignored
regex.c:2699: warning: `always_inline' attribute directive ignored
regex.c:6236: warning: `always_inline' attribute directive ignored
[...]
gcc -I/usr/local/src/R/R-alpha/include  -I/usr/local/include  -Wno-long-long -fPIC  -g -O2 -c pfm-read.c -o pfm-read.o
pfm-read.c:225: warning: `match' redefined
/usr/local/src/R/R-alpha/include/Rinternals.h:1002: warning: this is the location of the previous definition

from make.

-- 
Bj?rn-Helge Mevik

