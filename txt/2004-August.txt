From simon.urbanek at math.uni-augsburg.de  Sun Aug  1 11:21:40 2004
From: simon.urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Sun Aug  1 11:21:44 2004
Subject: [Rd] R + OS X + gcc 3.5 = not quite there ..
In-Reply-To: <095CB4BC-E326-11D8-9ED2-000A95A67E82@stat.ucla.edu>
References: <095CB4BC-E326-11D8-9ED2-000A95A67E82@stat.ucla.edu>
Message-ID: <322F3E63-E39C-11D8-89F4-000A959F327E@math.uni-augsburg.de>

On Jul 31, 2004, at 9:15 PM, Jan de Leeuw wrote:

> [cabledoc70:Developer/R/R-devel] deleeuw% bin/R
> Error in lazyLoadDBfetch(key, datafile, compressed, envhook) :
>         internal error in decompress1

I forgot to post it here, but the problem I had was in libz (thanks to 
Luke for some tips). When I used system's libz then the problems went 
away. I suspect the supplied libz is miscompiled in some way, however I 
had no time yet to track it down exactly.

> gfortran   -fno-common  -g -O2 -c ppr.f -o ppr.o
> /var/tmp//ccSqEJAf.s:8241:FATAL:Symbol __BLOCK_DATA____ already 
> defined.

Heh, I suspect it's the same code that my g77 cross-compiler hates, as 
I posed here few days ago ... got no response so far :/

> and the "bad restore file magic number" errors are there as well.

That's the libz thing: what happens is the following: first load opens 
the file as gzip, that should work, but for some reason it doesn't, so 
load falls back to raw mode and tries to read it as-is, however then 
the magic number is bogus since it's actually gzipped, so load fails. 
If you use system's libz the file is decompressed correctly.

Cheers,
Simon

From deleeuw at stat.ucla.edu  Sun Aug  1 19:25:24 2004
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sun Aug  1 19:26:04 2004
Subject: [Rd] 3.5 on Tiger
Message-ID: <C5D3C93E-E3DF-11D8-B19B-000A95A67E82@stat.ucla.edu>

setenv CC gcc-3.5
setenv F77 gfortran
setenv CXX g++-3.5

What I had to do.

1. Build a local zlib-1.2.1
2. Compile ppr.f in stats with g77-3.4 and not with gfortran-3.5
3. Change line 1581 in plot.c to

                double *aa = REAL(cex);
                 if (R_FINITE(aa[i % ncex])

      i.e. get the assignment out of the macro

4. Disable the DO_STR_DIM macro in plot.c (and thus the
functions do_strheight and do_strwidth). This could be fixed by
expanding the macros and pasting into the source.

From Kurt.Hornik at wu-wien.ac.at  Sun Aug  1 17:07:20 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Sun Aug  1 20:56:10 2004
Subject: [Rd] directing print.packageInfo to a file
In-Reply-To: <loom.20040726T011220-264@post.gmane.org>
References: <loom.20040726T011220-264@post.gmane.org>
Message-ID: <16653.1832.118387.608204@mithrandir.hornik.net>

>>>>> Gabor Grothendieck writes:

> There was a discussion on r-help of getting the output from 
> print.packageInfo into a file.  Spencer and I have added a file=
> argument to print.packageInfo for consideration in R.  Had this
> been available it would have simplified the answer to that
> thread.  If the file= argument is used then the packageInfo
> information is sent to the file specified rather than displayed
> using file.show .

What is wrong with

	capture.output(print.packageInfo(x, ...), file = NULL)

for what you want?

-k

> print.packageInfo <- function (x, ..., file = NULL) 
> {
>     if (!inherits(x, "packageInfo")) 
>         stop("wrong class")
>     outFile <- if (is.null(file))
> 	tempfile("RpackageInfo")
>     else
> 	file
>     outConn <- file(outFile, open = "w")
>     vignetteMsg <- paste("Further information is available in the following ", 
>         "vignettes in directory ", sQuote(file.path(x$path, "doc")), 
>         ":", sep = "")
>     headers <- c("", "Description:\n\n", "Index:\n\n", paste(paste(strwrap
> (vignetteMsg), 
>         collapse = "\n"), "\n\n", sep = ""))
>     footers <- c("\n", "\n", "\n", "")
>     formatDocEntry <- function(entry) {
>         if (is.list(entry) || is.matrix(entry)) 
>             formatDL(entry, style = "list")
>         else entry
>     }
>     for (i in which(!sapply(x$info, is.null))) {
>         writeLines(headers[i], outConn, sep = "")
>         writeLines(formatDocEntry(x$info[[i]]), outConn)
>         writeLines(footers[i], outConn, sep = "")
>     }
>     close(outConn)
>     if (is.null(file))
> 	    file.show(outFile, delete.file = TRUE, title = paste
> ("Documentation for package", 
> 		sQuote(x$name)))
>     invisible(x)
> }

> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From ggrothendieck at myway.com  Sun Aug  1 22:02:42 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Aug  1 22:02:55 2004
Subject: [Rd] directing print.packageInfo to a file
Message-ID: <20040801200242.EEE5D3984@mprdmxin.myway.com>



print.packageInfo does not print to the console, it uses file.show.
For example, on R 1.9.1 patched on Windows XP:

> require(chron)
[1] TRUE
>  capture.output(print.packageInfo(help(package = chron)), file = "/abc.txt")
NULL
> length(readLines("/abc.txt"))
[1] 0


Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:

>>>>> Gabor Grothendieck writes:

> There was a discussion on r-help of getting the output from
> print.packageInfo into a file. Spencer and I have added a file=
> argument to print.packageInfo for consideration in R. Had this
> been available it would have simplified the answer to that
> thread. If the file= argument is used then the packageInfo
> information is sent to the file specified rather than displayed
> using file.show .

What is wrong with

     capture.output(print.packageInfo(x, ...), file = NULL)

for what you want?

-k

> print.packageInfo <- function (x, ..., file = NULL)
> {
> if (!inherits(x, "packageInfo"))
> stop("wrong class")
> outFile <- if (is.null(file))
>      tempfile("RpackageInfo")
> else
>      file
> outConn <- file(outFile, open = "w")
> vignetteMsg <- paste("Further information is available in the following ",
> "vignettes in directory ", sQuote(file.path(x$path, "doc")),
> ":", sep = "")
> headers <- c("", "Description:\n\n", "Index:\n\n", paste(paste(strwrap
> (vignetteMsg),
> collapse = "\n"), "\n\n", sep = ""))
> footers <- c("\n", "\n", "\n", "")
> formatDocEntry <- function(entry) {
> if (is.list(entry) || is.matrix(entry))
> formatDL(entry, style = "list")
> else entry
> }
> for (i in which(!sapply(x$info, is.null))) {
> writeLines(headers[i], outConn, sep = "")
> writeLines(formatDocEntry(x$info[[i]]), outConn)
> writeLines(footers[i], outConn, sep = "")
> }
> close(outConn)
> if (is.null(file))
>       file.show(outFile, delete.file = TRUE, title = paste
> ("Documentation for package",
>           sQuote(x$name)))
> invisible(x)
> }

From p.murrell at auckland.ac.nz  Mon Aug  2 00:34:33 2004
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Mon Aug  2 00:34:56 2004
Subject: [Rd] plot(x,y) core dump
References: <291B348BC59B47468C7824603C326082946164@cmail3.central.cmich.local>
Message-ID: <410D6FF9.5020104@stat.auckland.ac.nz>

Hi

Rf_allocNewX11DeviceDesc is called by newX11DeviceDriver and the latter 
needs to check the value returned.  I think Brian Ripley has made a fix 
for this problem in the development version of R.  The first few lines 
of newX11DeviceDriver now look like ...

     newX11Desc *xd;
     char *fn;

     xd = Rf_allocNewX11DeviceDesc(pointsize);
     if(!xd) return FALSE;

Unfortunately, your next problem may be that you can't start an X11 
device (it looks like you are failing to allocate memory for the device).

Paul


Liao, Kexiao wrote:
> Dear R Development Team,
> 
>    I compile R-1.9.1 on AIX 5.2 under 2.9-aix51-020209, and xlf 7.1. In
> order to let R compile successfully under gcc 2.9, I have to change one
> C statement of file(RHOME//src/modules/X11/devX11.c) line 1768 from
> "retrun FALSE" to "retrun NULL", following is C code snapshot:
> 
>  
> 
> newX11Desc * Rf_allocNewX11DeviceDesc(double ps)
> 
> {
> 
>     newX11Desc *xd;
> 
>     /* allocate new device description */
> 
>     if (!(xd = (newX11Desc*)calloc(1, sizeof(newX11Desc))))
> 
>         return NULL;
> 
>  
> 
>     /* From here on, if we need to bail out with "error", */
> 
>     /* then we must also free(xd). */
> 
>  
> 
>     /*  Font will load at first use.  */
> 
>  
> 
>     if (ps < 6 || ps > 24) ps = 12;
> 
>     xd->fontface = -1;
> 
>     xd->fontsize = -1;
> 
>     xd->basefontface = 1;
> 
>     xd->basefontsize = ps;
> 
>     xd->handleOwnEvents = FALSE;
> 
>     xd->window = (Window) NULL;
> 
>  
> 
>     return(xd);
> 
> }
> 
>  
> 
> However I got core dump while I try to use plot() from R:
> 
>  
> 
>  
> 
> R : Copyright 2004, The R Foundation for Statistical Computing
> 
> Version 1.9.1  (2004-06-21), ISBN 3-900051-00-3
> 
>  
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> 
> You are welcome to redistribute it under certain conditions.
> 
> Type 'license()' or 'licence()' for distribution details.
> 
>  
> 
> R is a collaborative project with many contributors.
> 
> Type 'contributors()' for more information and
> 
> 'citation()' on how to cite R in publications.
> 
>  
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 
> 'help.start()' for a HTML browser interface to help.
> 
> Type 'q()' to quit R.
> 
>  
> 
> 
>>help.start()
> 
> 
> Making links in per-session dir ...
> 
> If /usr/bin/netscape is already running, it is *not* restarted, and
> 
>     you must switch to its window.
> 
> Otherwise, be patient ...
> 
> 
>>x <- rnorm(50)
> 
> 
>>y <- rnorm(x)
> 
> 
>>plot(x,y)
> 
> 
> Illegal instruction (core dumped)
> 
>  
> 
>  
> 
> Can anyone give me some suggestion? Thanks!
> 
>  
> 
>  
> 
> Kexiao
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From Kurt.Hornik at wu-wien.ac.at  Mon Aug  2 07:15:38 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Mon Aug  2 07:16:24 2004
Subject: [Rd] directing print.packageInfo to a file
In-Reply-To: <20040801200242.EEE5D3984@mprdmxin.myway.com>
References: <20040801200242.EEE5D3984@mprdmxin.myway.com>
Message-ID: <16653.52730.383537.81882@mithrandir.hornik.net>

>>>>> Gabor Grothendieck writes:

> 
> print.packageInfo does not print to the console, it uses file.show.
> For example, on R 1.9.1 patched on Windows XP:
> 
>> require(chron)
> [1] TRUE
>> capture.output(print.packageInfo(help(package = chron)), file = "/abc.txt")
> NULL
>> length(readLines("/abc.txt"))
> [1] 0

But file.show() can be tuned by playing with options(pager).

In your case, something like

  oop <- options(pager = function(file, ...) writeLines(readLines(file)))
  capture.output(print.packageInfo(help(package = "stats")),
	         file = "abc.txt")
  options(oop)

gives

R> length(readLines("abc.txt"))
[1] 345

Hth
-k





> 
> 
> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
> 
>>>>> Gabor Grothendieck writes:
> 
>> There was a discussion on r-help of getting the output from
>> print.packageInfo into a file. Spencer and I have added a file=
>> argument to print.packageInfo for consideration in R. Had this
>> been available it would have simplified the answer to that
>> thread. If the file= argument is used then the packageInfo
>> information is sent to the file specified rather than displayed
>> using file.show .
> 
> What is wrong with
> 
>      capture.output(print.packageInfo(x, ...), file = NULL)
> 
> for what you want?
> 
> -k
> 
>> print.packageInfo <- function (x, ..., file = NULL)
>> {
>> if (!inherits(x, "packageInfo"))
>> stop("wrong class")
>> outFile <- if (is.null(file))
>> tempfile("RpackageInfo")
>> else
>> file
>> outConn <- file(outFile, open = "w")
>> vignetteMsg <- paste("Further information is available in the following ",
>> "vignettes in directory ", sQuote(file.path(x$path, "doc")),
>> ":", sep = "")
>> headers <- c("", "Description:\n\n", "Index:\n\n", paste(paste(strwrap
>> (vignetteMsg),
>> collapse = "\n"), "\n\n", sep = ""))
>> footers <- c("\n", "\n", "\n", "")
>> formatDocEntry <- function(entry) {
>> if (is.list(entry) || is.matrix(entry))
>> formatDL(entry, style = "list")
>> else entry
>> }
>> for (i in which(!sapply(x$info, is.null))) {
>> writeLines(headers[i], outConn, sep = "")
>> writeLines(formatDocEntry(x$info[[i]]), outConn)
>> writeLines(footers[i], outConn, sep = "")
>> }
>> close(outConn)
>> if (is.null(file))
>> file.show(outFile, delete.file = TRUE, title = paste
>> ("Documentation for package",
>> sQuote(x$name)))
>> invisible(x)
>> }
> 


> _______________________________________________
> No banners. No pop-ups. No kidding.

From ripley at stats.ox.ac.uk  Mon Aug  2 08:41:42 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug  2 08:41:46 2004
Subject: [Rd] directing print.packageInfo to a file
In-Reply-To: <16653.52730.383537.81882@mithrandir.hornik.net>
Message-ID: <Pine.LNX.4.44.0408020739510.30735-100000@gannet.stats>

On Mon, 2 Aug 2004, Kurt Hornik wrote:

> >>>>> Gabor Grothendieck writes:
> 
> > 
> > print.packageInfo does not print to the console, it uses file.show.
> > For example, on R 1.9.1 patched on Windows XP:
> > 
> >> require(chron)
> > [1] TRUE
> >> capture.output(print.packageInfo(help(package = chron)), file = "/abc.txt")
> > NULL
> >> length(readLines("/abc.txt"))
> > [1] 0
> 
> But file.show() can be tuned by playing with options(pager).
> 
> In your case, something like
> 
>   oop <- options(pager = function(file, ...) writeLines(readLines(file)))
>   capture.output(print.packageInfo(help(package = "stats")),
> 	         file = "abc.txt")
>   options(oop)
> 
> gives
> 
> R> length(readLines("abc.txt"))
> [1] 345

or even

oop <- options(pager="console")

an internal version of the same thing under R for Windows.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Mon Aug  2 09:10:39 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Aug  2 09:10:42 2004
Subject: [Rd] directing print.packageInfo to a file
Message-ID: <20040802071039.4E77A399F@mprdmxin.myway.com>



I already suggested using the pager as a workaround
in the original thread although your pager workaround
has the advantage of being 100% in R while mine used
a batch file which defined a new pager.

Note that R already supports

   options(pager = "console")

but if you do this then it seems that capture.output
still won't capture it.  Thus one alternative solution
would be to get capture.output to work with 
pager = "console" and modify print.packageInfo to
take a pager= argument which it would pass down to file.show.
(file.show already has a pager argument.)

Then one could write:

  capture.output( print.packageInfo(help(package = chron), 
            pager = "console"), file = "myfile.txt")

That gets it down to one line although it still seems
unnecessarily indirect when one could just write:

  print.packageInfo(help(package = chron), file = "myfile.txt")

if print.packageInfo just had a file= argument.
Furthermore, print.packageInfo ALREADY creates the file as a 
temporary file to hand over to file.show so its not much of
a stretch to give the user access to what it is already 
creating anyway.

From:   	Kurt Hornik <Kurt.Hornik@wu-wien.ac.at>
>>>>> Gabor Grothendieck writes:

>
> print.packageInfo does not print to the console, it uses file.show.
> For example, on R 1.9.1 patched on Windows XP:
>
>> require(chron)
> [1] TRUE
>> capture.output(print.packageInfo(help(package = chron)), file = "/abc.txt")
> NULL
>> length(readLines("/abc.txt"))
> [1] 0

But file.show() can be tuned by playing with options(pager).

In your case, something like

oop <- options(pager = function(file, ...) writeLines(readLines(file)))
capture.output(print.packageInfo(help(package = "stats")),
      file = "abc.txt")
options(oop)

gives

R> length(readLines("abc.txt"))
[1] 345

Hth
-k





>
>
> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
>
>>>>> Gabor Grothendieck writes:
>
>> There was a discussion on r-help of getting the output from
>> print.packageInfo into a file. Spencer and I have added a file=
>> argument to print.packageInfo for consideration in R. Had this
>> been available it would have simplified the answer to that
>> thread. If the file= argument is used then the packageInfo
>> information is sent to the file specified rather than displayed
>> using file.show .
>
> What is wrong with
>
> capture.output(print.packageInfo(x, ...), file = NULL)
>
> for what you want?
>
> -k
>
>> print.packageInfo <- function (x, ..., file = NULL)
>> {
>> if (!inherits(x, "packageInfo"))
>> stop("wrong class")
>> outFile <- if (is.null(file))
>> tempfile("RpackageInfo")
>> else
>> file
>> outConn <- file(outFile, open = "w")
>> vignetteMsg <- paste("Further information is available in the following ",
>> "vignettes in directory ", sQuote(file.path(x$path, "doc")),
>> ":", sep = "")
>> headers <- c("", "Description:\n\n", "Index:\n\n", paste(paste(strwrap
>> (vignetteMsg),
>> collapse = "\n"), "\n\n", sep = ""))
>> footers <- c("\n", "\n", "\n", "")
>> formatDocEntry <- function(entry) {
>> if (is.list(entry) || is.matrix(entry))
>> formatDL(entry, style = "list")
>> else entry
>> }
>> for (i in which(!sapply(x$info, is.null))) {
>> writeLines(headers[i], outConn, sep = "")
>> writeLines(formatDocEntry(x$info[[i]]), outConn)
>> writeLines(footers[i], outConn, sep = "")
>> }
>> close(outConn)
>> if (is.null(file))
>> file.show(outFile, delete.file = TRUE, title = paste
>> ("Documentation for package",
>> sQuote(x$name)))
>> invisible(x)
>> }
>

From maechler at stat.math.ethz.ch  Mon Aug  2 10:15:21 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Aug  2 10:15:23 2004
Subject: [Rd] 3.5 on Tiger
In-Reply-To: <C5D3C93E-E3DF-11D8-B19B-000A95A67E82@stat.ucla.edu>
References: <C5D3C93E-E3DF-11D8-B19B-000A95A67E82@stat.ucla.edu>
Message-ID: <16653.63513.173300.867430@gargle.gargle.HOWL>

>>>>> "Jan" == Jan de Leeuw <deleeuw@stat.ucla.edu>
>>>>>     on Sun, 1 Aug 2004 10:25:24 -0700 writes:

    Jan> setenv CC gcc-3.5
    Jan> setenv F77 gfortran
    Jan> setenv CXX g++-3.5

    Jan> What I had to do.

(for what version of R exactly)

    Jan> 1. Build a local zlib-1.2.1

    Jan> 2. Compile ppr.f in stats with g77-3.4 and not with gfortran-3.5

(why -- a bug in gfortran-3.5 ? )

    Jan> 3. Change line 1581 in plot.c to

    Jan> double *aa = REAL(cex);
    Jan> if (R_FINITE(aa[i % ncex])

line 1582 {R-devel} is

		if (R_FINITE(thiscex = REAL(cex)[i % ncex])

would this work?

    Jan> i.e. get the assignment out of the macro

    Jan> 4. Disable the DO_STR_DIM macro in plot.c (and thus the
    Jan> functions do_strheight and do_strwidth). This could be fixed by
    Jan> expanding the macros and pasting into the source.

??? why that??

I wrote those quite carefully IIRC.


Regards,
Martin Maechler

From Kurt.Hornik at wu-wien.ac.at  Mon Aug  2 11:41:03 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Mon Aug  2 11:40:27 2004
Subject: [Rd] directing print.packageInfo to a file
In-Reply-To: <20040802071039.4E77A399F@mprdmxin.myway.com>
References: <20040802071039.4E77A399F@mprdmxin.myway.com>
Message-ID: <16654.3119.236333.453674@mithrandir.hornik.net>

>>>>> Gabor Grothendieck writes:

> 
> I already suggested using the pager as a workaround
> in the original thread although your pager workaround
> has the advantage of being 100% in R while mine used
> a batch file which defined a new pager.
> 
> Note that R already supports
> 
>    options(pager = "console")
> 
> but if you do this then it seems that capture.output
> still won't capture it.  Thus one alternative solution
> would be to get capture.output to work with 
> pager = "console" and modify print.packageInfo to
> take a pager= argument which it would pass down to file.show.
> (file.show already has a pager argument.)
> 
> Then one could write:
> 
>   capture.output( print.packageInfo(help(package = chron), 
>             pager = "console"), file = "myfile.txt")
> 
> That gets it down to one line although it still seems
> unnecessarily indirect when one could just write:
> 
>   print.packageInfo(help(package = chron), file = "myfile.txt")
> 
> if print.packageInfo just had a file= argument.
> Furthermore, print.packageInfo ALREADY creates the file as a 
> temporary file to hand over to file.show so its not much of
> a stretch to give the user access to what it is already 
> creating anyway.

The point about the proferred solution is that it works generally when
is is desired to capture output that is "printed" via file.show().  If
we start adding extra arguments to print.packageIQR (which is documented
to be internal, btw), we would need to do the same for print.libraryIQR
and print.hsearch and ..., i.e. for all print() methods which in fact
display something using file.show() as a "side effect".  That seems
suboptimal to me, when one can wrap the above in a very simple and
generally applicable function (and just calling the print() generic
rather than some method, btw).

-k

From ggrothendieck at myway.com  Mon Aug  2 16:07:22 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Aug  2 16:07:30 2004
Subject: [Rd] directing print.packageInfo to a file
Message-ID: <20040802140722.9B7FB39C1@mprdmxin.myway.com>


From:   	Kurt Hornik <Kurt.Hornik@wu-wien.ac.at>

>>>>> Gabor Grothendieck writes:

>
> I already suggested using the pager as a workaround
> in the original thread although your pager workaround
> has the advantage of being 100% in R while mine used
> a batch file which defined a new pager.
>
> Note that R already supports
>
> options(pager = "console")
>
> but if you do this then it seems that capture.output
> still won't capture it. Thus one alternative solution
> would be to get capture.output to work with
> pager = "console" and modify print.packageInfo to
> take a pager= argument which it would pass down to file.show.
> (file.show already has a pager argument.)
>
> Then one could write:
>
> capture.output( print.packageInfo(help(package = chron),
> pager = "console"), file = "myfile.txt")
>
> That gets it down to one line although it still seems
> unnecessarily indirect when one could just write:
>
> print.packageInfo(help(package = chron), file = "myfile.txt")
>
> if print.packageInfo just had a file= argument.
> Furthermore, print.packageInfo ALREADY creates the file as a
> temporary file to hand over to file.show so its not much of
> a stretch to give the user access to what it is already
> creating anyway.

The point about the proferred solution is that it works generally when
is is desired to capture output that is "printed" via file.show(). If
we start adding extra arguments to print.packageIQR (which is documented
to be internal, btw), we would need to do the same for print.libraryIQR
and print.hsearch and ..., i.e. for all print() methods which in fact
display something using file.show() as a "side effect". That seems
suboptimal to me, when one can wrap the above in a very simple and
generally applicable function (and just calling the print() generic
rather than some method, btw).

---

That's a good point but if a command _already_ produces a file 
I think its logical that access to that file be given directly, 
even if that means having to add a file= argument in many commands.   
In my opinion, both our pager workarounds are too complex/geeky 
for a simple task.

I think this whole thing could be streamlined by extending the
pager= option to accept a connection, e.g.

           options(pager = file("a.txt"))

and then modifying the args of file.show to:

function (..., header = rep("", nfiles), title = "R Information", 
  delete.file = FALSE, file, 
  pager = if (missing(file)) getOption("pager")) else base:file(file))

Now passing down the ... arguments from print.packageInfo
to file.show only involves a one line change, namely, just
add three dots at the end of the call to file.show within
print.packageInfo:

    file.show(outFile, delete.file = TRUE, title = 
        paste("Documentation for package", sQuote(x$name)), ...)

and this automatically gives pager= and file= support to it.
(Note that currently the three dots are already in the arg list to print.packageInfo but are not used anywhere in the body of that
function.)  Modifying the other functions might be just as easy.

Also, while we are at it we could add pager= arguments
to sink and to capture.output.  With the above any of the following
would work:

   print.packageInfo(help(package = chron), file = "a.txt")

   print.packageInfo(help(package = chron), pager = file("a.txt"))

   capture.output(help(package = chron), pager = file("a.txt"))

   sink(pager = file("a.txt"))
   help(package = chron)
   sink()

   oop <- options(pager = file("a.txt"))
   help(package = chron))
   options(oop)

From ripley at stats.ox.ac.uk  Mon Aug  2 17:15:48 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug  2 17:16:01 2004
Subject: [Rd] Re: [R] help(arima) return value typo?
In-Reply-To: <Pine.CYG.4.58.0408021557570.4016@erdos>
Message-ID: <Pine.LNX.4.44.0408021614001.5701-100000@gannet.stats>

On Mon, 2 Aug 2004, Hiroyuki Kawakatsu wrote:

> 
> in ?arima (R-1.9.1), the return value component 'convergence' should be
> 'code'?

Yes.  Not sure it says anywhere than R-help is the appropriate place for 
this and R-devel is better so I've moved it there.

> (it's a pity there is no reliable way to check return value documentation
> consistency with the code, or is there?)

There is not as the result can vary by input.  But you could try to 
contribute one!

From nospam at pubhealth.ku.dk  Tue Aug  3 16:01:18 2004
From: nospam at pubhealth.ku.dk (nospam@pubhealth.ku.dk)
Date: Tue Aug  3 16:01:20 2004
Subject: [Rd] Unmet dependency prevents r-gnome installation in Debian
	stable (PR#7151)
Message-ID: <20040803140118.2108F112E9@slim.kubism.ku.dk>

Full_Name: Kimmo Uusitalo
Version: 1.8.0-1
OS: Debian 3.0 "Woody"
Submission from: (NULL) (128.214.205.4)


r-gnome 1.8.0-1 requires gdk-imlib2 which is not available in Debian 3.0 stable.

I have the following in /etc/apt/sources.list :

deb http://cran.r-project.org/bin/linux/debian woody main


Btw, it would be very nice to have the newest version of R even for Debian
stable.

From edd at debian.org  Tue Aug  3 16:08:07 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue Aug  3 16:08:12 2004
Subject: [Rd] Unmet dependency prevents r-gnome installation in Debian
	stable (PR#7151)
In-Reply-To: <20040803140118.2108F112E9@slim.kubism.ku.dk>
References: <20040803140118.2108F112E9@slim.kubism.ku.dk>
Message-ID: <20040803140807.GA31868@sonny.eddelbuettel.com>

On Tue, Aug 03, 2004 at 04:01:18PM +0200, nospam@pubhealth.ku.dk wrote:
> Full_Name: Kimmo Uusitalo
> Version: 1.8.0-1
> OS: Debian 3.0 "Woody"
> Submission from: (NULL) (128.214.205.4)
> 
> 
> r-gnome 1.8.0-1 requires gdk-imlib2 which is not available in Debian 3.0 stable.

That isn't really a bug in R.
 
> I have the following in /etc/apt/sources.list :
> 
> deb http://cran.r-project.org/bin/linux/debian woody main
> 
> 
> Btw, it would be very nice to have the newest version of R even for Debian
> stable.

You are having a 'round peg in a square hole' problem. Either you take
Debian stable literally, and keep it stable -- so you stick with the ancient
version therein. Or you accept updates, and the easiest may be local
recompilations. 

What you found here is a missing Depends in a contributed package that a
volunteer gave back to CRAN. I don't think it is realistic to expect that
all possible system combinations are fulfilled on what is by now an old
system.  Debian stable has its uses (I still run it on my gateway), but if
you care about a current R, I strongly suggest  you rebuild R 1.9.1. 

Dirk

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From jpalmucci at machineinsight.com  Tue Aug  3 18:07:37 2004
From: jpalmucci at machineinsight.com (jpalmucci@machineinsight.com)
Date: Tue Aug  3 18:07:39 2004
Subject: [Rd] Ops.ts returns non-ts object for univariate operations
	(PR#7152)
Message-ID: <20040803160737.12726112F8@slim.kubism.ku.dk>

Full_Name: Jeff Palmucci
Version: 1.9.1
OS: XP
Submission from: (NULL) (129.44.190.60)


Ops.ts returns a non-time series object for univariate operations. Here is a
patch:

Ops.ts <- function(e1, e2)
{
    if(missing(e2)) {
        ## univariate operator
      result <- NextMethod(.Generic)
      attributes(result) <- attributes(e1)
      result
    } else if(any(nchar(.Method) == 0)) {
        ## one operand is not a ts
        NextMethod(.Generic)
    } else {
        nc1 <- NCOL(e1)
        nc2 <- NCOL(e2)
        ## use ts.intersect to align e1 and e2
        e12 <- .cbind.ts(list(e1, e2),
                         c(deparse(substitute(e1))[1],
                           deparse(substitute(e2))[1]),
                         union = FALSE)
        e1 <- if(is.matrix(e1)) e12[, 1:nc1, drop = FALSE] else e12[, 1]
        e2 <- if(is.matrix(e2)) e12[, nc1 + (1:nc2), drop = FALSE]
        else e12[, nc1 + 1]
        NextMethod(.Generic)
    }
}

From ripley at stats.ox.ac.uk  Tue Aug  3 18:53:28 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug  3 18:53:38 2004
Subject: [Rd] (PR#7152) Ops.ts returns non-ts object for univariate
	operations
In-Reply-To: <20040803160737.12726112F8@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408031743550.24106-100000@gannet.stats>

How about a statement of the problem and an example?  It is not clear to
me that there is anything here that is not intentional, and the stated
analysis is plain wrong: Ops.ts _is_ called for univariate "-" and _does_
return a time series.

Both +a.ts and -a.ts return a ts.  !a.ts does not, but we expect time 
series to be numeric so that is deliberate.  (Copying attributes wily-nily 
when changing mode is not a good idea.)

On Tue, 3 Aug 2004 jpalmucci@machineinsight.com wrote:

> Full_Name: Jeff Palmucci
> Version: 1.9.1
> OS: XP
> Submission from: (NULL) (129.44.190.60)
> 
> 
> Ops.ts returns a non-time series object for univariate operations. Here is a
> patch:
> 
> Ops.ts <- function(e1, e2)
> {
>     if(missing(e2)) {
>         ## univariate operator
>       result <- NextMethod(.Generic)
>       attributes(result) <- attributes(e1)
>       result
>     } else if(any(nchar(.Method) == 0)) {
>         ## one operand is not a ts
>         NextMethod(.Generic)
>     } else {
>         nc1 <- NCOL(e1)
>         nc2 <- NCOL(e2)
>         ## use ts.intersect to align e1 and e2
>         e12 <- .cbind.ts(list(e1, e2),
>                          c(deparse(substitute(e1))[1],
>                            deparse(substitute(e2))[1]),
>                          union = FALSE)
>         e1 <- if(is.matrix(e1)) e12[, 1:nc1, drop = FALSE] else e12[, 1]
>         e2 <- if(is.matrix(e2)) e12[, nc1 + (1:nc2), drop = FALSE]
>         else e12[, nc1 + 1]
>         NextMethod(.Generic)
>     }
> }
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jpalmucci at machineinsight.com  Tue Aug  3 19:48:30 2004
From: jpalmucci at machineinsight.com (jpalmucci@machineinsight.com)
Date: Tue Aug  3 19:48:32 2004
Subject: [Rd] (PR#7152) Ops.ts returns non-ts object for univariate
	operations
Message-ID: <20040803174830.27B8C1167A@slim.kubism.ku.dk>

This is a cryptographically signed message in MIME format.

--------------ms010908060700000604050108
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Sorry.

You're right about the univariate numeric operators. My bad.

However, I was expecting !x to return a time series, just like the 
binary logical operators do.

For example:

 > b <- ts(1:10) > 5
 > b
Time Series:
Start = 1
End = 10
Frequency = 1
 [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
 > b & lag(b)
Time Series:
Start = 1
End = 9
Frequency = 1
[1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
 > b | lag(b)
Time Series:
Start = 1
End = 9
Frequency = 1
[1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE

However, when you use the ! operator, the result is not a ts, which 
means the following is garbage:

 > b | !lag(b)
Time Series:
Start = 1
End = 10
Frequency = 1
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 >

Prof Brian Ripley wrote:

>How about a statement of the problem and an example?  It is not clear to
>me that there is anything here that is not intentional, and the stated
>analysis is plain wrong: Ops.ts _is_ called for univariate "-" and _does_
>return a time series.
>
>Both +a.ts and -a.ts return a ts.  !a.ts does not, but we expect time 
>series to be numeric so that is deliberate.  (Copying attributes wily-nily 
>when changing mode is not a good idea.)
>
>On Tue, 3 Aug 2004 jpalmucci@machineinsight.com wrote:
>
>  
>
>>Full_Name: Jeff Palmucci
>>Version: 1.9.1
>>OS: XP
>>Submission from: (NULL) (129.44.190.60)
>>
>>
>>Ops.ts returns a non-time series object for univariate operations. Here is a
>>patch:
>>
>>Ops.ts <- function(e1, e2)
>>{
>>    if(missing(e2)) {
>>        ## univariate operator
>>      result <- NextMethod(.Generic)
>>      attributes(result) <- attributes(e1)
>>      result
>>    } else if(any(nchar(.Method) == 0)) {
>>        ## one operand is not a ts
>>        NextMethod(.Generic)
>>    } else {
>>        nc1 <- NCOL(e1)
>>        nc2 <- NCOL(e2)
>>        ## use ts.intersect to align e1 and e2
>>        e12 <- .cbind.ts(list(e1, e2),
>>                         c(deparse(substitute(e1))[1],
>>                           deparse(substitute(e2))[1]),
>>                         union = FALSE)
>>        e1 <- if(is.matrix(e1)) e12[, 1:nc1, drop = FALSE] else e12[, 1]
>>        e2 <- if(is.matrix(e2)) e12[, nc1 + (1:nc2), drop = FALSE]
>>        else e12[, nc1 + 1]
>>        NextMethod(.Generic)
>>    }
>>}
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>    
>>
>
>  
>


--------------ms010908060700000604050108
Content-Type: application/x-pkcs7-signature; name="smime.p7s"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="smime.p7s"
Content-Description: S/MIME Cryptographic Signature

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIIJ+zCC
Az8wggKooAMCAQICAQ0wDQYJKoZIhvcNAQEFBQAwgdExCzAJBgNVBAYTAlpBMRUwEwYDVQQI
EwxXZXN0ZXJuIENhcGUxEjAQBgNVBAcTCUNhcGUgVG93bjEaMBgGA1UEChMRVGhhd3RlIENv
bnN1bHRpbmcxKDAmBgNVBAsTH0NlcnRpZmljYXRpb24gU2VydmljZXMgRGl2aXNpb24xJDAi
BgNVBAMTG1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBDQTErMCkGCSqGSIb3DQEJARYccGVy
c29uYWwtZnJlZW1haWxAdGhhd3RlLmNvbTAeFw0wMzA3MTcwMDAwMDBaFw0xMzA3MTYyMzU5
NTlaMGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5KSBM
dGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQTCBnzAN
BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAxKY8VXNV+065yplaHmjAdQRwnd/p/6Me7L3N9Vvy
Gna9fww6YfK/Uc4B1OVQCjDXAmNaLIkVcI7dyfArhVqqP3FWy688Cwfn8R+RNiQqE88r1fOC
dz0Dviv+uxg+B79AgAJk16emu59l0cUqVIUPSAR/p7bRPGEEQB5kGXJgt/sCAwEAAaOBlDCB
kTASBgNVHRMBAf8ECDAGAQH/AgEAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwudGhh
d3RlLmNvbS9UaGF3dGVQZXJzb25hbEZyZWVtYWlsQ0EuY3JsMAsGA1UdDwQEAwIBBjApBgNV
HREEIjAgpB4wHDEaMBgGA1UEAxMRUHJpdmF0ZUxhYmVsMi0xMzgwDQYJKoZIhvcNAQEFBQAD
gYEASIzRUIPqCy7MDaNmrGcPf6+svsIXoUOWlJ1/TCG4+DYfqi2fNi/A9BxQIJNwPP2t4WFi
w9k6GX6EsZkbAMUaC4J0niVQlGLH2ydxVyWN3amcOY6MIE9lX5Xa9/eH1sYITq726jTlEBpb
NU1341YheILcIRk13iSx0x1G/11fZU8wggNYMIICwaADAgECAgMLrW8wDQYJKoZIhvcNAQEE
BQAwYjELMAkGA1UEBhMCWkExJTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0
ZC4xLDAqBgNVBAMTI1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBMB4XDTA0
MDIwOTIzMTE1MloXDTA1MDIwODIzMTE1MlowgZYxHzAdBgNVBAMTFlRoYXd0ZSBGcmVlbWFp
bCBNZW1iZXIxJDAiBgkqhkiG9w0BCQEWFXBhbG11Y2NpQGFsdW0ubWl0LmVkdTEgMB4GCSqG
SIb3DQEJARYRanBhbG11Y2NpQHJjbi5jb20xKzApBgkqhkiG9w0BCQEWHGpwYWxtdWNjaUBt
YWNoaW5laW5zaWdodC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDV29qd
kRrXAYWUnO65QB5RKEOAT0cM1e25Mm3cLUmUPlXb4Q9rVMmgocNAB2gu10BE6dtnX92lzELC
zeh7WftzYJuyiL0pzH9lAnWSAKMzyHsj4Alb3mE4FMQ8GFLrZyywuewNFmQoQOiCdVns7c49
UPX+2zW1OZDnJXLl/08Kbkigc1hXi0tRkgLK/PQqmHsvmINTy6ALAlMhva3D4v62sPmwhnUa
QlWNvHPALKRhsq8vsCs+xb+RyfO4fNKh/t3MuETgZFIXsEBS9pwJNEhY2+qEvTrx/tBbbEaD
nB/+ly/4GNRfwVmzckzxwQaLPvokcaOu0nJzOduoPditUInNAgMBAAGjYzBhMFEGA1UdEQRK
MEiBFXBhbG11Y2NpQGFsdW0ubWl0LmVkdYERanBhbG11Y2NpQHJjbi5jb22BHGpwYWxtdWNj
aUBtYWNoaW5laW5zaWdodC5jb20wDAYDVR0TAQH/BAIwADANBgkqhkiG9w0BAQQFAAOBgQDC
f2BTNWvk0t3Li81GnR8AbDsXZ0k0Q2wso8vE7TAP47JIYoltmKBcbZ8tvkqbVHf9l7RRl3Od
wZLSGC9AkCq4vU6FqKHGSU0cmBitGLXJu3Vgcm+TFhYRweAMbys7O9OzhUHO9/RuAiXdJg1+
wYVdc33z4B3dbLf0yVwBkY/snzCCA1gwggLBoAMCAQICAwutbzANBgkqhkiG9w0BAQQFADBi
MQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEs
MCoGA1UEAxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVtYWlsIElzc3VpbmcgQ0EwHhcNMDQwMjA5
MjMxMTUyWhcNMDUwMjA4MjMxMTUyWjCBljEfMB0GA1UEAxMWVGhhd3RlIEZyZWVtYWlsIE1l
bWJlcjEkMCIGCSqGSIb3DQEJARYVcGFsbXVjY2lAYWx1bS5taXQuZWR1MSAwHgYJKoZIhvcN
AQkBFhFqcGFsbXVjY2lAcmNuLmNvbTErMCkGCSqGSIb3DQEJARYcanBhbG11Y2NpQG1hY2hp
bmVpbnNpZ2h0LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANXb2p2RGtcB
hZSc7rlAHlEoQ4BPRwzV7bkybdwtSZQ+VdvhD2tUyaChw0AHaC7XQETp22df3aXMQsLN6HtZ
+3Ngm7KIvSnMf2UCdZIAozPIeyPgCVveYTgUxDwYUutnLLC57A0WZChA6IJ1Weztzj1Q9f7b
NbU5kOclcuX/TwpuSKBzWFeLS1GSAsr89CqYey+Yg1PLoAsCUyG9rcPi/raw+bCGdRpCVY28
c8AspGGyry+wKz7Fv5HJ87h80qH+3cy4ROBkUhewQFL2nAk0SFjb6oS9OvH+0FtsRoOcH/6X
L/gY1F/BWbNyTPHBBos++iRxo67ScnM526g92K1Qic0CAwEAAaNjMGEwUQYDVR0RBEowSIEV
cGFsbXVjY2lAYWx1bS5taXQuZWR1gRFqcGFsbXVjY2lAcmNuLmNvbYEcanBhbG11Y2NpQG1h
Y2hpbmVpbnNpZ2h0LmNvbTAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBBAUAA4GBAMJ/YFM1
a+TS3cuLzUadHwBsOxdnSTRDbCyjy8TtMA/jskhiiW2YoFxtny2+SptUd/2XtFGXc53BktIY
L0CQKri9ToWoocZJTRyYGK0Ytcm7dWByb5MWFhHB4AxvKzs707OFQc739G4CJd0mDX7BhV1z
ffPgHd1st/TJXAGRj+yfMYIDOzCCAzcCAQEwaTBiMQswCQYDVQQGEwJaQTElMCMGA1UEChMc
VGhhd3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UEAxMjVGhhd3RlIFBlcnNvbmFs
IEZyZWVtYWlsIElzc3VpbmcgQ0ECAwutbzAJBgUrDgMCGgUAoIIBpzAYBgkqhkiG9w0BCQMx
CwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0wNDA4MDMxNzQ4MTRaMCMGCSqGSIb3DQEJ
BDEWBBQaAsBESsK5kCIHv8r1Fj3hxyOWtTBSBgkqhkiG9w0BCQ8xRTBDMAoGCCqGSIb3DQMH
MA4GCCqGSIb3DQMCAgIAgDANBggqhkiG9w0DAgIBQDAHBgUrDgMCBzANBggqhkiG9w0DAgIB
KDB4BgkrBgEEAYI3EAQxazBpMGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29u
c3VsdGluZyAoUHR5KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwg
SXNzdWluZyBDQQIDC61vMHoGCyqGSIb3DQEJEAILMWugaTBiMQswCQYDVQQGEwJaQTElMCMG
A1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UEAxMjVGhhd3RlIFBl
cnNvbmFsIEZyZWVtYWlsIElzc3VpbmcgQ0ECAwutbzANBgkqhkiG9w0BAQEFAASCAQCFvZN+
CVGJqXPZNtcNx+7ha20b3JkOkttHSJGB2BQFCEKE1FyE9vIrgL/H+GHF8bNrLpaDV/JGqnMv
ki7x9HAwzPuLzgF4liW/W24fJlmcM1Pcr8sWfhC1jOgmfhX+P7ne3R0hCugTb0I/5skg/mCv
F2/s+hlANeWKtaWLEMaO+IoL5PMkFQFgGa8wH25JQg8u8WR06kNZdBUsLUTgPOVHE/k3jMf6
QGHUt4+TxKhCeHhzFficRn3OLf01sxHOc8XCizsbut6mbAp7SbMua+qKop31FhCfv3+lHTpE
DdghFJowunt/lbLam1OYprjZdZ/5SUjfnaB6tPzj3IsJSfl/AAAAAAAA
--------------ms010908060700000604050108--

From ggrothendieck at myway.com  Tue Aug  3 20:10:34 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Tue Aug  3 20:10:44 2004
Subject: [Rd] (PR#7152) Ops.ts returns non-ts object for
	=?utf-8?b?dW5pdmFyaWF0ZQlvcGVyYXRpb25z?=
References: <20040803174830.27B8C1167A@slim.kubism.ku.dk>
Message-ID: <loom.20040803T200242-19@post.gmane.org>

 <jpalmucci <at> machineinsight.com> writes:

: However, I was expecting !x to return a time series, just like the 
: binary logical operators do.
: 
: For example:
: 
:  > b <- ts(1:10) > 5
: 
:  > b | !lag(b)
: Time Series:
: Start = 1
: End = 10
: Frequency = 1
:  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

As a workaround you could use the fact that xor(b, TRUE) negates b yet 
remains a ts object.

From ripley at stats.ox.ac.uk  Wed Aug  4 16:07:45 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Aug  4 16:07:56 2004
Subject: [Rd] R 1.9.1 Crash in Win2000 (PR#7139)
In-Reply-To: <20040728182242.266D2FCDC@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408041504160.8163-100000@gannet.stats>

It's a Windows limitation, it seems, so who knows (and it may depend on 
your exact OS version).  My guess is that it is 255, and I will add a 
limit of 255. (200 works, 300 crashes.)

On Wed, 28 Jul 2004 gunter.berton@gene.com wrote:

> 
> This probably should go to Duncan Murdoch ...
> 
> The following reliably crashes R Version 1.9.1 on Win2000:
> 
> winDialogString(paste(sample(letters,500,rep=TRUE),
> collapse=""),default="")
> 
> (presumably because of the too lengthy message string; but what is the
> length limit?).
> --
> 
> Bert Gunter
> 
> Non-Clinical Biostatistics
> Genentech
> MS: 240B
> Phone: 650-467-7374
> 
> 
> "The business of the statistician is to catalyze the scientific learning
> process."
> 
>  -- George E.P. Box
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From terra at gnome.org  Thu Aug  5 17:44:48 2004
From: terra at gnome.org (terra@gnome.org)
Date: Thu Aug  5 20:05:42 2004
Subject: [Rd] pbeta accuracy and efficiency (PR#7153)
Message-ID: <20040805154448.7626C115F5@slim.kubism.ku.dk>

Full_Name: M Welinder
Version: 1.9
OS: Solaris
Submission from: (NULL) (65.213.85.218)


pbeta has known accuracy and efficiency problems as noted in the code.

Gnumeric 1.3.1 is now out and features a new implementation of pbeta (with R's
calling conventions).  The code is thanks to Ian Smith and lives in
src/mathfunc.c
I know of no problematic arguments.  Gnumeric uses "gnm_float" where R uses
"double",
but this should all be easily fixable with a little search-and-replace.

This should facilitate improved qbeta, pt, pbinom [bug 5727], pnbinom, pf,
and whatever those drag with them.   Slight care will be needed to avoid
squeezing
pbeta's first argument up against 1, see Gnumeric's pf function, for example.

From ripley at stats.ox.ac.uk  Thu Aug  5 21:50:29 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug  5 21:50:32 2004
Subject: [Rd] Re: [R] Problem in method's Makefile?
In-Reply-To: <Pine.SOL.4.20.0408051425230.4703-100000@jaws.dfci.harvard.edu>
Message-ID: <Pine.LNX.4.44.0408052045590.6984-100000@gannet.stats>

This is really an R-devel question -- it is about an unreleased version of 
R.

On Thu, 5 Aug 2004, Jeff Gentry wrote:

> Hi there ...
> 
> Not too long after the switch to using Subversion I tried to checkout &
> build R but encountered an error - and being short on time at that point
> put it off to look at later.  So today I sat down again and was
> encountering this error every time I would attempt to build:
> 
>  dumping R code in package 'methods'
>  Saving namespace image ...
>  initializing class and method definitions now ...done
>  <environment: namespace:methods>
>  usage: touch [-acfm] [-r file] [-t [[CC]YY]MMDDhhmm[.SS]] file ...
>  *** Error code 1
> 
> I traced this down to the Makefile in methods:
> $(top_builddir)/library/$(pkg)/R/$(pkg).rdb: $(top_builddir)/library/$(pkg)/R/all.rda
>         @echo "tools:::makeLazyLoading(\"$(pkg)\")" | \
>           R_DEFAULT_PACKAGES=NULL LC_COLLATE=C $(R_EXE) --slave >
> /dev/null
>         @cat /dev/null > $(top_builddir)/library/$(pkg)/R/all.rda
>         @touch $^
> 
> 
> I'm not sure what it is about that touch call, but commenting it out
> causes things to build normally.  When I try to echo '$^', it appears to
> be an empty string.
>
> This is all on a FreeBSD machine - I'm assuming it is somehow OS specific
> as this would have come up a bunch of times if it wasn't.  

Yes.  Seems a make peculiarity, not even shared by Solaris make.
To get you going, replace $^ by 
$(top_builddir)/library/$(pkg)/R/$(pkg).rdb.  However, I am working right 
now on streamlining this now we don't allow lazy-loading to be optional.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jgentry at jimmy.harvard.edu  Thu Aug  5 22:43:06 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Thu Aug  5 22:43:12 2004
Subject: [Rd] Re: [R] Problem in method's Makefile?
In-Reply-To: <Pine.LNX.4.44.0408052045590.6984-100000@gannet.stats>
Message-ID: <Pine.SOL.4.20.0408051642350.4703-100000@jaws.dfci.harvard.edu>

> This is really an R-devel question -- it is about an unreleased version of 
> R.

Right you are - sorry about that.

> Yes.  Seems a make peculiarity, not even shared by Solaris make.
> To get you going, replace $^ by 
> $(top_builddir)/library/$(pkg)/R/$(pkg).rdb.  However, I am working right 
> now on streamlining this now we don't allow lazy-loading to be optional.

That fixes things for now.  Thanks much.

-J

From gunter.berton at gene.com  Thu Aug  5 23:17:11 2004
From: gunter.berton at gene.com (Berton Gunter)
Date: Thu Aug  5 23:17:16 2004
Subject: [Rd] Request for new Windoze GUI Widget
Message-ID: <4112A3D7.816F32A5@gene.com>

Folks:

I have found R's fewWindoze GUI Widgets (like winDialog,
choose.files,winMenuAdd etc.) to be quite useful in building simple but
functional interfaces (I hesitate to call them GUI's) for one-off
applications for non-R users. It's quite easy for me to write
statistical "solutions" in R, slap on a little GUI that allows users
access to the functionality, and then install the whole thing on their
machine.

For my very simple efforts, the only thing that I have found missing in
these Windows widgets is the equivalent of the Bioconductor argsWidget()
( in the tkWidgets package) for interactively entering arguments. This
CAN be done one at time with winDialogString(), but doing it as
argsWidget() does is much nicer. Of course, that's what I currently use
for this purpose, but it would be better to have the native Windows
equivalent in utils along with the others.

Obviously, not a big deal, but it would be a nice little addition if
someone wanted to bother. However, kudos to those responsible for what's
already there. It's a nice and useful little widget set as is. Lean and
mean.

Cheers,
Bert

--

Bert Gunter

Non-Clinical Biostatistics
Genentech
MS: 240B
Phone: 650-467-7374


"The business of the statistician is to catalyze the scientific learning
process."

 -- George E.P. Box

From ggrothendieck at myway.com  Fri Aug  6 04:08:01 2004
From: ggrothendieck at myway.com (ggrothendieck@myway.com)
Date: Fri Aug  6 04:08:05 2004
Subject: [Rd] sub() crashes (PR#7154)
Message-ID: <20040806020801.CBB0311683@slim.kubism.ku.dk>

Full_Name: G. Grothendieck
Version: R 1.9.1 patched 2004-07-13
OS: Windows XP
Submission from: (NULL) (209.226.152.23)



The following command causes R to crash every time:

sub("(.) (.)", "\\1 \\2 \\3", "abc", perl = TRUE)

on Windows XP R version 1.9.1 patched version of 2004-07-13.

From maechler at stat.math.ethz.ch  Fri Aug  6 09:27:12 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Aug  6 09:27:18 2004
Subject: [Rd] Re: [R] Problem in method's Makefile?
In-Reply-To: <Pine.LNX.4.44.0408052045590.6984-100000@gannet.stats>
References: <Pine.SOL.4.20.0408051425230.4703-100000@jaws.dfci.harvard.edu>
	<Pine.LNX.4.44.0408052045590.6984-100000@gannet.stats>
Message-ID: <16659.13008.483638.677914@gargle.gargle.HOWL>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Thu, 5 Aug 2004 20:50:29 +0100 (BST) writes:

    BDR> ......................  
    BDR> ......................  

    BDR> However, I am working right now on streamlining this 
    BDR> now we don't allow lazy-loading to be optional.

"don't allow" :
That is for the "core packages" only, right?

Martin

From ripley at stats.ox.ac.uk  Fri Aug  6 09:43:04 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug  6 09:43:07 2004
Subject: [Rd] Re: [R] Problem in method's Makefile?
In-Reply-To: <16659.13008.483638.677914@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.44.0408060831260.26412-100000@gannet.stats>

On Fri, 6 Aug 2004, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
> >>>>>     on Thu, 5 Aug 2004 20:50:29 +0100 (BST) writes:
> 
>     BDR> ......................  
>     BDR> ......................  
> 
>     BDR> However, I am working right now on streamlining this 
>     BDR> now we don't allow lazy-loading to be optional.
> 
> "don't allow" :
> That is for the "core packages" only, right?

I meant specifically for package methods under Unix (that file
Makefile.in).  There is in principle no need to save the image prior to 
preparing the lazyloading database but that needs code changes for 
methods.

The standard packages either use lazy loading (most) or not (the small 
ones, splines and tcltk) without any choice.  (There was a choice under 
Unix for a short while.)

For all contributed (including recommended) packages, lazy loading can be 
controlled by INSTALL --lazy/--no-lazy unless the package itself insists
via its DESCRIPTION file.  If unspecified, INSTALL selects lazy loading 
for largish packages without saved images (about 27% of those on CRAN 
yesterday).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Fri Aug  6 09:59:45 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri Aug  6 09:59:48 2004
Subject: [Rd] sub() crashes (PR#7154)
Message-ID: <20040806075945.970A011682@slim.kubism.ku.dk>

>>>>> "Gabor" == Gabor Grothendieck <ggrothendieck@myway.com>
>>>>>     on Fri,  6 Aug 2004 04:08:01 +0200 (CEST) writes:

    Gabor> Full_Name: G. Grothendieck Version: R 1.9.1 patched
    Gabor> 2004-07-13 OS: Windows XP Submission from: (NULL)
    Gabor> (209.226.152.23)


    Gabor> The following command causes R to crash every time:

    Gabor> sub("(.) (.)", "\\1 \\2 \\3", "abc", perl = TRUE)

    Gabor> on Windows XP R version 1.9.1 patched version of
    Gabor> 2004-07-13.

you need a later "patched version".

This was bug report 7108  and fixed (by BDR) about 10 days ago
or so.

Martin

From buser at stat.math.ethz.ch  Fri Aug  6 10:24:40 2004
From: buser at stat.math.ethz.ch (Christoph Buser)
Date: Fri Aug  6 10:24:41 2004
Subject: [Rd] interaction.plot
Message-ID: <16659.16456.59935.936785@gargle.gargle.HOWL>

Dear R core team

I've a proprosal to improve the function interaction.plot. It
should be allowed to use type = "b". This can be done by
changing the function's header from

function(        , type = c("l", "p"),     )

to

function(        , type = c("l", "p", "b"),     )

Then it works. This type = "b" is useful, if the second level
of the x.factor is missing for some level of the
trace.factor. With type= "l" you loose first level of the
x.factor, too (because you can't draw the line to the missing
second level). With type = "p" so see this first level, but you
have no lines at all (just chaos with points). With type = "b",
you get all existing levels plus the lines between two
contiguous levels (if they both exist).


There is a second point. Using interaction.plot with the
additional argument main creates a warning:

parameter "main" couldn't be set in high-level plot() function 

The reason is that "..." is used twice inside of
interaction.plot, in fact in

matplot( ,...)

and in

axis( ,...)

axis can do nothing with this argument main and creates this
warning. You could replace ,... in the axis function by
inserting all reasonable arguments of axis in the functions
header (interaction.plot) and give over those arguments to
axis. Then you shouldn't get this warning anymore.

Best regards

Christoph Buser

-- 
Christoph Buser <buser@stat.math.ethz.ch>
Seminar fuer Statistik, LEO D6
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3505		fax: 632-1228
http://stat.ethz.ch/~buser/

From matthias.burger at epigenomics.com  Fri Aug  6 21:38:22 2004
From: matthias.burger at epigenomics.com (Matthias Burger)
Date: Fri Aug  6 21:38:26 2004
Subject: [Rd] getAllMethods("print") uses undefined function packageName()
Message-ID: <4113DE2E.6070106@epigenomics.com>



Hi,

whilst debugging own code I encountered a problem with

 >getAllMethods("print")
Error in warning("\"", f, "\" from \"", packageName(gwhere), "\" is a nongeneric 
function; no methods available") :
         couldn't find function "packageName"

This is R 1.9.1 on Debian linux.

This also happens in todays R-devel snapshot
 >version
          _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   Under development (unstable)
major    2
minor    0.0
year     2004
month    08
day      06
language R


Best,

   Matthias


-- 
Matthias Burger                     Project Manager/ Biostatistician
Epigenomics AG    Kleine Praesidentenstr. 1    10178 Berlin, Germany
phone:+49-30-24345-371                          fax:+49-30-24345-555
http://www.epigenomics.com           matthias.burger@epigenomics.com

From thomasio at cs.tu-berlin.de  Sat Aug  7 15:14:10 2004
From: thomasio at cs.tu-berlin.de (Thomas =?iso-8859-1?q?K=F6nig?=)
Date: Sat Aug  7 15:11:02 2004
Subject: [Rd] memory usage of S4 methods
Message-ID: <200408071514.10998.thomasio@cs.tu-berlin.de>

Hi,

I have some problems with the memory usage of S4-generics. For example, I 
observed the following behaviour:
> gc()
         used (Mb) gc trigger (Mb)
Ncells 432091 11.6     531268 14.2
Vcells 116052  0.9     786432  6.0
> setClass("A",representation(x="numeric"));
[1] "A"
> setClass("B",representation(x="numeric"));
[1] "B"
> f.default <- function(a,b,c,d,e,f,g,h,i,j,k,l,m)
+ {
+   res <- standardGeneric("f");
+   return(res);
+ }
> f.A <- function(a)
+ {
+   print("f.A");
+   return(0);
+ }
> f.AB <- function(a,b)
+ {
+   print("f.B");
+   return(0);
+ }
> setGeneric("f",f.default)
[1] "f"
> 
setMethod("f",signature=signature("A","B","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing"),f.AB);
[1] "f"
> 
setMethod("f",signature=signature("A","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing"),f.A);
[1] "f"
> gc()
          used (Mb) gc trigger (Mb)
Ncells 1579264 42.2    3708127 99.1
Vcells 1558026 11.9    4232140 32.3
> R.version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   alpha
major    1
minor    9.1
year     2004
month    05
day      25
language R

More than 100 MB for 2 classes and 2 generics? Is this correct?

Greetings,

Thomas K?nig

From ripley at stats.ox.ac.uk  Sat Aug  7 15:33:15 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Aug  7 15:33:18 2004
Subject: [Rd] memory usage of S4 methods
In-Reply-To: <200408071514.10998.thomasio@cs.tu-berlin.de>
Message-ID: <Pine.LNX.4.44.0408071423390.20643-100000@gannet.stats>

On Sat, 7 Aug 2004, Thomas K?nig wrote:

> I have some problems with the memory usage of S4-generics. For example, I 
> observed the following behaviour:
> > gc()
>          used (Mb) gc trigger (Mb)
> Ncells 432091 11.6     531268 14.2
> Vcells 116052  0.9     786432  6.0
> > setClass("A",representation(x="numeric"));
> [1] "A"
> > setClass("B",representation(x="numeric"));
> [1] "B"
> > f.default <- function(a,b,c,d,e,f,g,h,i,j,k,l,m)
> + {
> +   res <- standardGeneric("f");
> +   return(res);
> + }
> > f.A <- function(a)
> + {
> +   print("f.A");
> +   return(0);
> + }
> > f.AB <- function(a,b)
> + {
> +   print("f.B");
> +   return(0);
> + }
> > setGeneric("f",f.default)
> [1] "f"
> > 
> setMethod("f",signature=signature("A","B","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing"),f.AB);
> [1] "f"
> > 
> setMethod("f",signature=signature("A","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing","missing"),f.A);
> [1] "f"
> > gc()
>           used (Mb) gc trigger (Mb)
> Ncells 1579264 42.2    3708127 99.1
> Vcells 1558026 11.9    4232140 32.3
> > R.version
>          _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status   alpha
> major    1
> minor    9.1
> year     2004
> month    05
> day      25
> language R
> 
> More than 100 MB for 2 classes and 2 generics? Is this correct?

No:  you are not reading gc() output correctly.  Please read its help
page, or even the output (`used' is what is used).

Please do not send reports on alpha pre-releases of released versions:
see the posting guide.  No one will have that version to hand to check 
what you are doing.  (I might have checked the released version if you 
had provided code that could be pasted in, but you made it unnecessarily 
hard, including using lines that the MUA has to break.)

The issue appears to be your attempt to set methods on a very long list of 
arguments.  What practical use is that?  I think you probably only want to 
set them on two arguments.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Sun Aug  8 03:38:08 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sun Aug  8 03:38:14 2004
Subject: [Rd] sequence of month ends using seq.Date
Message-ID: <loom.20040808T031628-610@post.gmane.org>


It seems that seq.Date starting from month end will always give d days past
the beginning of each month (if the month end of the first month is d days
after the first of that month).  This has the effect of jumping into the
following month for short months. For example, the 3 months after
Jan 31, 2004 are Mar 2, 2004, Mar 31, 2004 and May 1, 2004 according
to seq.Date:

R> seq(as.Date("2004-01-31"), length = 4, by = "month")
[1] "2004-01-31" "2004-03-02" "2004-03-31" "2004-05-01"

In contrast chron uses these rules:

- if the first date is near the end of the month and the sequence
  would otherwise skip a month at any point then use the last day
  of the month, as shown below.

- if the first date is the end of its month then use month ends.  Thus
  starting at Jan 31, 2004 or starting at Feb 29, 2004 would both
  give sequences of month ends.

Here is the calculation using chron:

R> require(chron)
R> seq(chron("01/31/04"), length = 4, by = "month")
[1] 01/31/04 02/29/04 03/31/04 04/30/04

Ideally one would be able to specify to seq.Date whether one wants 
counting done from the beginning of each month (to get the current effect)
or the end of each month (to easily get end of month or second day to the 
end of month sequences, etc.) with reasonable defaults.

(At the moment, workarounds to get end of month sequences
include performing the seq in chron and converting to Date or 
doing a seq relative to the first of the NEXT month and subtracting 
one to get end of month.)

From ripley at stats.ox.ac.uk  Sun Aug  8 21:27:55 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Aug  8 21:27:59 2004
Subject: [Rd] Use of R_PROFILE.R / install.R
Message-ID: <Pine.LNX.4.44.0408081955530.2043-100000@gannet.stats>

According to R-exts:

  The second purpose for @file{install.R} is to hold code that needs to be
  executed each time the package is attached, after the image is
  loaded.  Few packages have a need for such code so @file{install.R} is
  normally an empty file.

  The optional file @file{R_PROFILE.R} is executed before the code in the
  @file{R} subdirectory and should be used to set up an environment needed
  only to evaluate the code (which is run with the @option{--vanilla}
  command-line flag).  Very few packages will need such code.
  Indeed, both @file{install.R} and @file{R_PROFILE.R} should be viewed as
  experimental; the mechanism to execute code before attaching or 
  installing the package may change in the near future.

(Actually it's during loading, not attaching, a namespace, for packages
with namespaces.)

Looking on CRAN, it seems that two packages use R_PROFILE.R for
`options(echo=FALSE)', which does not do anything useful AFAICS.  A
non-empty install.R is used for

require(methods)
require(boot)
require("Hmisc")
data(Wcrit.R)

and that's not the intention (and in particular require() should have its 
return value checked!) -- this is best done in .First.lib/.onLoad.

One problem is that the package has no way to prevent a saved image being 
forced with INSTALL --save.


Since this mechanism is a maintenance nightmare (especially with
lazy-loading +/- saving images) I propose we drop it for 2.0.0.  Instead,
just as for lazy-loading, we should have a field in the DESCRIPTION file,
with

SaveImage: yes

forcing saving the image, and any other value forcing not saving it.

Note that most packages which currently save an image probably want to 
use lazy-loading instead and so should have LazyLoad: yes in their 
DESCRIPTION file.

The proposed change is not backwards compatible but affects very few CRAN 
packages, for all of which there is better solution that is backwards 
compatible.  I have not looked at BioConductor or elsewhere, so please 
will package authors let us know of any examples where R_PROFILE.R or 
install.R is essential (and why).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Aug  9 12:58:04 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug  9 12:58:07 2004
Subject: [Rd] Re: [R] /minus or /hyphen in PS output
In-Reply-To: <4118CCB3.7070203@hppi.troitsk.ru>
Message-ID: <Pine.LNX.4.44.0408091140290.2556-100000@gannet.stats>

1) You used the wrong list.  Please see the posting guide.

2) They used /minus because they wanted minus not hyphen.
R uses Latin1 and not standard encoding, and /minus is in Latin1.
I think the fonts you are using are not Latin1 fonts, as all the afms 
supplied with R support /minus.

If you look at the output with your patch, it uses hyphen for negative 
numbers, extremely poor typography (the sort of thing that you get from 
Word!).

3)  // is invalid in C code, and your patch will not compile on some 
systems which R supports.


There is perhaps a way around fonts which are missing /minus, but we want 
/minus if available.  Perhaps you would like to work on a more careful 
analysis and patch?  One that does not break standard usage?

On Tue, 10 Aug 2004, M.Kondrin wrote:

> Dear R devolepers!
> Wouldn't you change src/main/devPS.c file (patch will follow). Problem 
> is  with  minus sign in ps output. The original code forces the name 
> /minus to the character number 45 (-). But /minus symbol is not defined 
> in standard Adobe encoding and (even worse) is not defined in most type1 
> fonts (where the name /hyphen is used instead), in this case you will 
> have an empty space instead of -. Redefining encoding for this fonts 
> does not help because encoding vector in ps output got "corrected" and 
> /hyphen (or any other name I have selected for 45'th character) is 
> replaced with /minus. I have tried this patch and it works for me.
> 
> ------------------------------------------------
> 
> 449,450c449
> <       //      if(c == 45) strcpy(dest, "/minus"); else
> <           strcpy(dest, state->p0);
> ---
>  >       if(c == 45) strcpy(dest, "/minus"); else strcpy(dest, state->p0);
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Mon Aug  9 10:45:46 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Aug  9 14:35:03 2004
Subject: [Rd] URL change for Statistik ETH and web interface to mailing
	lists.
Message-ID: <16663.14778.68030.32860@gargle.gargle.HOWL>

       [exceptional cross-posting on purpose]

Dear users/readers of our mailing lists,

The following ONLY affects the web interface to our mailing lists. 
This is both for subscription changes and the mailing list archives.

For a long time, our "Statistics ETHZ" home page has been
available both as
    http://www.stat.math.ethz.ch/	[old default]
and http://stat.ethz.ch/		[new default]

For several reasons however, the longer URL above has been the
``default'', or the one to which stat.ethz.ch was automagically converted.
This now has finally been switched two hours ago, such that
http://stat.ethz.ch/  is now the official URL in all respects and
http://www.stat.math.ethz.ch/ is just an alias to the new URL
(and it seems to behave strangely just now for me, but that
 should be very temporary).

For existing mailing lists and their web interface, the change
change has to happen ``inside mailman'' (by calling the correct
python script and changing the lists URL explictly) 
once for each list.

I wanted to first announce this widely and do the change in
about 24 hours or so.
You may have to accept the SSL certificate again {and it's not
from a so called "trusted agency" since that would cost us lots
of money we rather spend differently}.

Regards,

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH Zurich, Switzerland

From Kurt.Hornik at wu-wien.ac.at  Mon Aug  9 21:12:15 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Mon Aug  9 21:26:50 2004
Subject: [Rd] Use of R_PROFILE.R / install.R
In-Reply-To: <Pine.LNX.4.44.0408081955530.2043-100000@gannet.stats>
References: <Pine.LNX.4.44.0408081955530.2043-100000@gannet.stats>
Message-ID: <16663.52367.688656.135340@mithrandir.hornik.net>

>>>>> Prof Brian Ripley writes:

> According to R-exts:

>   The second purpose for @file{install.R} is to hold code that needs
>   to be executed each time the package is attached, after the image is
>   loaded.  Few packages have a need for such code so @file{install.R}
>   is normally an empty file.

>   The optional file @file{R_PROFILE.R} is executed before the code in
>   the @file{R} subdirectory and should be used to set up an
>   environment needed only to evaluate the code (which is run with the
>   @option{--vanilla} command-line flag).  Very few packages will need
>   such code.  Indeed, both @file{install.R} and @file{R_PROFILE.R}
>   should be viewed as experimental; the mechanism to execute code
>   before attaching or installing the package may change in the near
>   future.

> (Actually it's during loading, not attaching, a namespace, for packages
> with namespaces.)

> Looking on CRAN, it seems that two packages use R_PROFILE.R for
> `options(echo=FALSE)', which does not do anything useful AFAICS.  A
> non-empty install.R is used for

> require(methods)
> require(boot)
> require("Hmisc")
> data(Wcrit.R)

> and that's not the intention (and in particular require() should have its 
> return value checked!) -- this is best done in .First.lib/.onLoad.

> One problem is that the package has no way to prevent a saved image being 
> forced with INSTALL --save.


> Since this mechanism is a maintenance nightmare (especially with
> lazy-loading +/- saving images) I propose we drop it for 2.0.0.
> Instead, just as for lazy-loading, we should have a field in the
> DESCRIPTION file, with

> SaveImage: yes

> forcing saving the image, and any other value forcing not saving it.

Fine with me.

Can we perhaps agree to allow both yes/no and true/false for such
logical package DESCRIPTION metadata (and also irrespective of case)?

-k

> Note that most packages which currently save an image probably want to 
> use lazy-loading instead and so should have LazyLoad: yes in their 
> DESCRIPTION file.

> The proposed change is not backwards compatible but affects very few CRAN 
> packages, for all of which there is better solution that is backwards 
> compatible.  I have not looked at BioConductor or elsewhere, so please 
> will package authors let us know of any examples where R_PROFILE.R or 
> install.R is essential (and why).

> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Mon Aug  9 21:34:28 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug  9 21:34:30 2004
Subject: [Rd] Use of R_PROFILE.R / install.R
In-Reply-To: <16663.52367.688656.135340@mithrandir.hornik.net>
Message-ID: <Pine.LNX.4.44.0408092029200.7066-100000@gannet.stats>

On Mon, 9 Aug 2004, Kurt Hornik wrote:

> >>>>> Prof Brian Ripley writes:
> 
> > According to R-exts:
> 
> >   The second purpose for @file{install.R} is to hold code that needs
> >   to be executed each time the package is attached, after the image is
> >   loaded.  Few packages have a need for such code so @file{install.R}
> >   is normally an empty file.
> 
> >   The optional file @file{R_PROFILE.R} is executed before the code in
> >   the @file{R} subdirectory and should be used to set up an
> >   environment needed only to evaluate the code (which is run with the
> >   @option{--vanilla} command-line flag).  Very few packages will need
> >   such code.  Indeed, both @file{install.R} and @file{R_PROFILE.R}
> >   should be viewed as experimental; the mechanism to execute code
> >   before attaching or installing the package may change in the near
> >   future.
> 
> > (Actually it's during loading, not attaching, a namespace, for packages
> > with namespaces.)
> 
> > Looking on CRAN, it seems that two packages use R_PROFILE.R for
> > `options(echo=FALSE)', which does not do anything useful AFAICS.  A
> > non-empty install.R is used for
> 
> > require(methods)
> > require(boot)
> > require("Hmisc")
> > data(Wcrit.R)
> 
> > and that's not the intention (and in particular require() should have its 
> > return value checked!) -- this is best done in .First.lib/.onLoad.
> 
> > One problem is that the package has no way to prevent a saved image being 
> > forced with INSTALL --save.
> 
> 
> > Since this mechanism is a maintenance nightmare (especially with
> > lazy-loading +/- saving images) I propose we drop it for 2.0.0.
> > Instead, just as for lazy-loading, we should have a field in the
> > DESCRIPTION file, with
> 
> > SaveImage: yes
> 
> > forcing saving the image, and any other value forcing not saving it.
> 
> Fine with me.
> 
> Can we perhaps agree to allow both yes/no and true/false for such
> logical package DESCRIPTION metadata (and also irrespective of case)?

I've allowed yes/Yes and no/No already.  I can fairly easily allow
true/false, but FaLSe is a little more difficult ....

It looks like Bioconductor has many examples so it will take longer to 
convert those.  The new mechanism is in place now, though.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Rob.Hyndman at buseco.monash.edu.au  Tue Aug 10 04:38:15 2004
From: Rob.Hyndman at buseco.monash.edu.au (Rob Hyndman)
Date: Tue Aug 10 04:39:35 2004
Subject: [Rd] Subsetting time series
Message-ID: <41183517.7030302@buseco.monash.edu.au>

When part of a time series is extracted, the time series component is 
lost. e.g.,
x <- ts(1:10)
x[1:4]

It would be nice if there was a subsetting function [.ts to avoid this 
problem. However, it is beyond my R-coding ability to produce such a 
thing.  Is someone willing to do it?

Rob

__________________________________________________
Professor Rob J Hyndman
Department of Econometrics & Business Statistics
Monash University, VIC 3800, Australia.
http://www-personal.buseco.monash.edu.au/~hyndman/

From ihaka at stat.auckland.ac.nz  Tue Aug 10 05:01:52 2004
From: ihaka at stat.auckland.ac.nz (Ross Ihaka)
Date: Tue Aug 10 05:04:00 2004
Subject: [Rd] Subsetting time series
In-Reply-To: <41183517.7030302@buseco.monash.edu.au>
References: <41183517.7030302@buseco.monash.edu.au>
Message-ID: <41183AA0.8010203@stat.auckland.ac.nz>

Rob Hyndman wrote:
> When part of a time series is extracted, the time series component is 
> lost. e.g.,
> x <- ts(1:10)
> x[1:4]
> 
> It would be nice if there was a subsetting function [.ts to avoid this 
> problem. However, it is beyond my R-coding ability to produce such a 
> thing.  Is someone willing to do it?

Have you had a look at "window"?  The problem with "["
its that it can produce non-contiguous sets of values.

-- 
Ross Ihaka                         Email:  ihaka@stat.auckland.ac.nz
Department of Statistics           Phone:  (64-9) 373-7599 x 85054
University of Auckland             Fax:    (64-9) 373-7018
Private Bag 92019, Auckland
New Zealand

From ripley at stats.ox.ac.uk  Tue Aug 10 06:47:28 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 10 06:47:38 2004
Subject: [Rd] Subsetting time series
In-Reply-To: <41183AA0.8010203@stat.auckland.ac.nz>
Message-ID: <Pine.LNX.4.44.0408100537040.13142-100000@gannet.stats>

On Tue, 10 Aug 2004, Ross Ihaka wrote:

> Rob Hyndman wrote:
> > When part of a time series is extracted, the time series component is 
> > lost. e.g.,
> > x <- ts(1:10)
> > x[1:4]
> > 
> > It would be nice if there was a subsetting function [.ts to avoid this 
> > problem. However, it is beyond my R-coding ability to produce such a 
> > thing.  Is someone willing to do it?

There is a [.ts, in src/library/stats/R/ts.R, and it is documented 
(?"[.ts").

> Have you had a look at "window"?  The problem with "["
> its that it can produce non-contiguous sets of values.

Yes.  If you look in the sources for [.ts you will see, commented, the
code that was once there to handle cases where the index was evenly
spaced.  But it was removed long ago in favour of window().  I tried to
consult the logs, but it seems that in the shift from CVS to SVN recently
I can't get at them.  I think the rationale was that x[ind] should always
produce an object of the same class.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Tue Aug 10 10:05:00 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Aug 10 10:05:01 2004
Subject: [Rd] Subsetting time series
In-Reply-To: <Pine.LNX.4.44.0408100537040.13142-100000@gannet.stats>
References: <41183AA0.8010203@stat.auckland.ac.nz>
	<Pine.LNX.4.44.0408100537040.13142-100000@gannet.stats>
Message-ID: <16664.33196.178734.309201@gargle.gargle.HOWL>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Tue, 10 Aug 2004 05:47:28 +0100 (BST) writes:

    BDR> On Tue, 10 Aug 2004, Ross Ihaka wrote:
    >> Rob Hyndman wrote:
    >> > When part of a time series is extracted, the time series component is 
    >> > lost. e.g.,
    >> > x <- ts(1:10)
    >> > x[1:4]
    >> > 
    >> > It would be nice if there was a subsetting function [.ts to avoid this 
    >> > problem. However, it is beyond my R-coding ability to produce such a 
    >> > thing.  Is someone willing to do it?

    BDR> There is a [.ts, in src/library/stats/R/ts.R, and it is documented 
    BDR> (?"[.ts").

    >> Have you had a look at "window"?  The problem with "["
    >> its that it can produce non-contiguous sets of values.

    BDR> Yes.

indeed.  window() is what we have been advocation for a long
time now ... (but see below).

    BDR>   If you look in the sources for [.ts you will see,
    BDR> commented, the code that was once there to handle cases
    BDR> where the index was evenly spaced.  But it was removed
    BDR> long ago in favour of window().  I tried to consult the
    BDR> logs, but it seems that in the shift from CVS to SVN
    BDR> recently I can't get at them.  I think the rationale
    BDR> was that x[ind] should always produce an object of the
    BDR> same class.

well, that can't have been the only rationale since now
x[ind] is *not* of the same class - when the "ts" property is
lost in any case.

I don't much like the current behavior of "[.ts" either.
It should either work by returning the "ts" object in the
equidistant case  and give a warning (at least) in the
non-equidistant case.
OTOH, intuitively, when 'ind' has length 1,  x[ind] should just
give a number... [grumble..]
But maybe it's only a very small performance hit when that
continues to carry the "ts" class attribute along.

If we think of the data.frame analogue, we might consider
defining "[[.ts" for extracting numbers and "[.ts" to always
return a time series or an error.
But that is probably too much incompatible to current behavior.

Martin

From ripley at stats.ox.ac.uk  Tue Aug 10 10:11:39 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 10 10:11:48 2004
Subject: [Rd] Subsetting time series
In-Reply-To: <16664.33196.178734.309201@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.44.0408100909110.24918-100000@gannet.stats>

On Tue, 10 Aug 2004, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
> >>>>>     on Tue, 10 Aug 2004 05:47:28 +0100 (BST) writes:
> 
>     BDR> On Tue, 10 Aug 2004, Ross Ihaka wrote:
>     >> Rob Hyndman wrote:
>     >> > When part of a time series is extracted, the time series component is 
>     >> > lost. e.g.,
>     >> > x <- ts(1:10)
>     >> > x[1:4]
>     >> > 
>     >> > It would be nice if there was a subsetting function [.ts to avoid this 
>     >> > problem. However, it is beyond my R-coding ability to produce such a 
>     >> > thing.  Is someone willing to do it?
> 
>     BDR> There is a [.ts, in src/library/stats/R/ts.R, and it is documented 
>     BDR> (?"[.ts").
> 
>     >> Have you had a look at "window"?  The problem with "["
>     >> its that it can produce non-contiguous sets of values.
> 
>     BDR> Yes.
> 
> indeed.  window() is what we have been advocation for a long
> time now ... (but see below).
> 
>     BDR>   If you look in the sources for [.ts you will see,
>     BDR> commented, the code that was once there to handle cases
>     BDR> where the index was evenly spaced.  But it was removed
>     BDR> long ago in favour of window().  I tried to consult the
>     BDR> logs, but it seems that in the shift from CVS to SVN
>     BDR> recently I can't get at them.  I think the rationale
>     BDR> was that x[ind] should always produce an object of the
>     BDR> same class.
> 
> well, that can't have been the only rationale since now
> x[ind] is *not* of the same class - when the "ts" property is
> lost in any case.

`always of the same class' : for all (non-trivial)  values of ind.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Tue Aug 10 10:29:58 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Aug 10 10:30:00 2004
Subject: [Rd] Subsetting time series
In-Reply-To: <Pine.LNX.4.44.0408100909110.24918-100000@gannet.stats>
References: <16664.33196.178734.309201@gargle.gargle.HOWL>
	<Pine.LNX.4.44.0408100909110.24918-100000@gannet.stats>
Message-ID: <16664.34694.648308.383000@gargle.gargle.HOWL>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Tue, 10 Aug 2004 09:11:39 +0100 (BST) writes:

    BDR> On Tue, 10 Aug 2004, Martin Maechler wrote:
    >> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
    >> >>>>>     on Tue, 10 Aug 2004 05:47:28 +0100 (BST) writes:
    >> 
    BDR> On Tue, 10 Aug 2004, Ross Ihaka wrote:
    >> >> Rob Hyndman wrote:
    >> >> > When part of a time series is extracted, the time series component is 
    >> >> > lost. e.g.,
    >> >> > x <- ts(1:10)
    >> >> > x[1:4]
    >> >> > 
    >> >> > It would be nice if there was a subsetting function [.ts to avoid this 
    >> >> > problem. However, it is beyond my R-coding ability to produce such a 
    >> >> > thing.  Is someone willing to do it?
    >> 
    BDR> There is a [.ts, in src/library/stats/R/ts.R, and it is documented 
    BDR> (?"[.ts").
    >> 
    >> >> Have you had a look at "window"?  The problem with "["
    >> >> its that it can produce non-contiguous sets of values.
    >> 
    BDR> Yes.
    >> 
    >> indeed.  window() is what we have been advocation for a long
    >> time now ... (but see below).
    >> 
    BDR> If you look in the sources for [.ts you will see,
    BDR> commented, the code that was once there to handle cases
    BDR> where the index was evenly spaced.  But it was removed
    BDR> long ago in favour of window().  I tried to consult the
    BDR> logs, but it seems that in the shift from CVS to SVN
    BDR> recently I can't get at them.  I think the rationale
    BDR> was that x[ind] should always produce an object of the
    BDR> same class.
    >> 
    >> well, that can't have been the only rationale since now
    >> x[ind] is *not* of the same class - when the "ts" property is
    >> lost in any case.

    BDR> `always of the same class' : for all (non-trivial)  values of ind.

aah!  please excuse my mis-interpretation of meaning "same class
as original x".

Martin

From mkondrin at hppi.troitsk.ru  Wed Aug 11 14:44:28 2004
From: mkondrin at hppi.troitsk.ru (M.Kondrin)
Date: Tue Aug 10 11:34:04 2004
Subject: [Rd] /minus or /hyphen in PS output (continued)
Message-ID: <411A14AC.40403@hppi.troitsk.ru>

 >>They used /minus because they wanted minus not hyphen.
 >>R uses Latin1 and not standard encoding, and /minus is in Latin1.

 >>There is perhaps a way around fonts which are missing /minus, but we 
 >>want
 >>/minus if available.  Perhaps you would like to work on a more careful
 >>analysis and patch?  One that does not break standard usage?

In this case there should not be any problem. If /minus is defined in 
ISOLatin1Encoding then by default /minus will be used. If someone (like 
me) wants to have something else instead of /minus then one have to 
change encoding and install it with ps.options(encoding=...). I just do 
not want to be forced to use /minus then I do not want it.

--------------------------------------------------------

449c449,450
<       if(c == 45) strcpy(dest, "/minus"); else strcpy(dest, state->p0);
---
 >       /*      if(c == 45) strcpy(dest, "/minus"); else*/
 >       strcpy(dest, state->p0);

From david.meyer at wu-wien.ac.at  Tue Aug 10 12:45:31 2004
From: david.meyer at wu-wien.ac.at (david.meyer@wu-wien.ac.at)
Date: Tue Aug 10 12:45:35 2004
Subject: [Rd] plot(SOM) segfaults (PR#7157)
Message-ID: <20040810104531.5929011195@slim.kubism.ku.dk>


library(class)
plot(SOM)

segfaults in curve() at the line:

 y <- eval(expr, envir = list(x = x), enclos = parent.frame())

at least since R version 1.8.1.

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 2
 minor = 0.0
 year = 2004
 month = 07
 day = 27
 language = R

Search Path:
 .GlobalEnv, package:class, package:methods, package:stats,
package:graphics, package:utils, Autoloads, package:base

-- 
Dr. David Meyer
Department of Information Systems

Vienna University of Economics and Business Administration
Augasse 2-6, A-1090 Wien, Austria, Europe
Fax: +43-1-313 36x746 
Tel: +43-1-313 36x4393
HP:  http://wi.wu-wien.ac.at/Wer_sind_wir/meyer/

From ripley at stats.ox.ac.uk  Tue Aug 10 13:22:19 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 10 13:22:26 2004
Subject: [Rd] plot(SOM) segfaults (PR#7157)
In-Reply-To: <20040810104531.5929011195@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408101217300.8623-100000@gannet.stats>

It is reasonable to expect plot to work for any arbitrary function, or
alternatively for any function to work with this sort of abuse?

If the latter, this is a bug report on class and was sent to the wrong 
place (see the FAQ).

If the former, plot.function and curve do no checking, but what could they 
reasonably do?

On Tue, 10 Aug 2004 david.meyer@wu-wien.ac.at wrote:

> 
> library(class)
> plot(SOM)
> 
> segfaults in curve() at the line:
> 
>  y <- eval(expr, envir = list(x = x), enclos = parent.frame())
> 
> at least since R version 1.8.1.
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = Under development (unstable)
>  major = 2
>  minor = 0.0
>  year = 2004
>  month = 07
>  day = 27
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:class, package:methods, package:stats,
> package:graphics, package:utils, Autoloads, package:base
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From david.meyer at wu-wien.ac.at  Tue Aug 10 14:04:48 2004
From: david.meyer at wu-wien.ac.at (David Meyer)
Date: Tue Aug 10 14:04:52 2004
Subject: [Rd] plot(SOM) segfaults (PR#7157)
In-Reply-To: <Pine.LNX.4.44.0408101217300.8623-100000@gannet.stats>
References: <20040810104531.5929011195@slim.kubism.ku.dk>
	<Pine.LNX.4.44.0408101217300.8623-100000@gannet.stats>
Message-ID: <20040810140448.3d9f9d91.david.meyer@wu-wien.ac.at>

On Tue, 10 Aug 2004 12:22:19 +0100 (BST)
Prof Brian Ripley <ripley@stats.ox.ac.uk> wrote:

> It is reasonable to expect plot to work for any arbitrary function, or
> alternatively for any function to work with this sort of abuse?

I think the former, but I agree it is impossible to do the necessary
checks. 

What probably remains is to add some check in SOM() to avoid the
segfault.
(Which, I guess, occurs in the call of "VR_onlineSOM" because n =
as.integer(nrow(data)) becomes numeric(0) since nrow(data) is NULL in
this case?)

So, this bug report was indeed sent to the wrong place, my apologies...

-d

> 
> If the latter, this is a bug report on class and was sent to the wrong
> 
> place (see the FAQ).
> 
> If the former, plot.function and curve do no checking, but what could
> they reasonably do?
> 
> On Tue, 10 Aug 2004 david.meyer@wu-wien.ac.at wrote:
> 
> > 
> > library(class)
> > plot(SOM)
> > 
> > segfaults in curve() at the line:
> > 
> >  y <- eval(expr, envir = list(x = x), enclos = parent.frame())
> > 
> > at least since R version 1.8.1.
> > 
> > Version:
> >  platform = i686-pc-linux-gnu
> >  arch = i686
> >  os = linux-gnu
> >  system = i686, linux-gnu
> >  status = Under development (unstable)
> >  major = 2
> >  minor = 0.0
> >  year = 2004
> >  month = 07
> >  day = 27
> >  language = R
> > 
> > Search Path:
> >  .GlobalEnv, package:class, package:methods, package:stats,
> > package:graphics, package:utils, Autoloads, package:base
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 


-- 
Dr. David Meyer
Department of Information Systems

Vienna University of Economics and Business Administration
Augasse 2-6, A-1090 Wien, Austria, Europe
Fax: +43-1-313 36x746 
Tel: +43-1-313 36x4393
HP:  http://wi.wu-wien.ac.at/Wer_sind_wir/meyer/

From david.meyer at wu-wien.ac.at  Tue Aug 10 14:13:22 2004
From: david.meyer at wu-wien.ac.at (David Meyer)
Date: Tue Aug 10 14:13:27 2004
Subject: [Rd] plot(SOM) segfaults (PR#7157)
In-Reply-To: <Pine.LNX.4.44.0408101217300.8623-100000@gannet.stats>
References: <20040810104531.5929011195@slim.kubism.ku.dk>
	<Pine.LNX.4.44.0408101217300.8623-100000@gannet.stats>
Message-ID: <20040810141322.353fbbac.david.meyer@wu-wien.ac.at>

On Tue, 10 Aug 2004 12:22:19 +0100 (BST)
Prof Brian Ripley <ripley@stats.ox.ac.uk> wrote:

> It is reasonable to expect plot to work for any arbitrary function, or
> alternatively for any function to work with this sort of abuse?

I think the former, but I agree it is impossible to do the necessary
checks. 

What probably remains is to add some check in SOM() to avoid the
segfault.
(Which, I guess, occurs in the call of "VR_onlineSOM" because n =
as.integer(nrow(data)) becomes numeric(0) since nrow(data) is NULL in
this case?)

So, this bug report was indeed sent to the wrong place, my apologies...

-d

> 
> If the latter, this is a bug report on class and was sent to the wrong
> 
> place (see the FAQ).
> 
> If the former, plot.function and curve do no checking, but what could
> they reasonably do?
> 
> On Tue, 10 Aug 2004 david.meyer@wu-wien.ac.at wrote:
> 
> > 
> > library(class)
> > plot(SOM)
> > 
> > segfaults in curve() at the line:
> > 
> >  y <- eval(expr, envir = list(x = x), enclos = parent.frame())
> > 
> > at least since R version 1.8.1.
> > 
> > Version:
> >  platform = i686-pc-linux-gnu
> >  arch = i686
> >  os = linux-gnu
> >  system = i686, linux-gnu
> >  status = Under development (unstable)
> >  major = 2
> >  minor = 0.0
> >  year = 2004
> >  month = 07
> >  day = 27
> >  language = R
> > 
> > Search Path:
> >  .GlobalEnv, package:class, package:methods, package:stats,
> > package:graphics, package:utils, Autoloads, package:base
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 


-- 
Dr. David Meyer
Department of Information Systems

Vienna University of Economics and Business Administration
Augasse 2-6, A-1090 Wien, Austria, Europe
Fax: +43-1-313 36x746 
Tel: +43-1-313 36x4393
HP:  http://wi.wu-wien.ac.at/Wer_sind_wir/meyer/

From l.k.s.daldorff at astro.uio.no  Tue Aug 10 14:27:44 2004
From: l.k.s.daldorff at astro.uio.no (l.k.s.daldorff@astro.uio.no)
Date: Tue Aug 10 14:27:50 2004
Subject: [Rd] R 1.9.1 (PR#7158)
Message-ID: <20040810122744.D209D1119A@slim.kubism.ku.dk>

Hi

I am not to familier with R

The following problem are observed on 1.9.1 but not on 1.9.0.
Both R distribution installed from source code.

System:

Mac os X 10.3
Xdarwin 4.4 (xfree)


Problem:

I generate a multiplot by :

X11() ## making the devise I want to save to file (num)
par(mfow=c(3,3))

par(mfg=c(1,1,3,3))
plot(........
...
..
.


Then I want to print it to file wit specifying the devise number. I use the
following structure

postscript(filename......)
d =dev.cur()
dev.set(which=num)  ### num : the devise I want to save to file
dev.copy(which=d)
dev.off(d)


The following message is than resived when running the functions:

Warning message:
Display list redraw incomplet


Lars Daldorff

From tkeitt at mail.utexas.edu  Tue Aug 10 16:22:12 2004
From: tkeitt at mail.utexas.edu (Timothy H. Keitt)
Date: Tue Aug 10 16:22:17 2004
Subject: [Rd] Subsetting time series
In-Reply-To: <16664.33196.178734.309201@gargle.gargle.HOWL>
References: <41183AA0.8010203@stat.auckland.ac.nz>
	<Pine.LNX.4.44.0408100537040.13142-100000@gannet.stats>
	<16664.33196.178734.309201@gargle.gargle.HOWL>
Message-ID: <33726.66.220.230.120.1092147732.squirrel@66.220.230.120>

The basic concepts here seem to be "implicitly indexed," with a start and
step, and "explicitly indexed," where each value has a time (or space)
stamp (I've left out for the moment whether these need to be monotonic).
Since implicitly indexed can mimic explicitly indexed simply by generating
the time stamps on the fly, it makes sense for implicitly indexed to
inherit from explicitly indexed. Subsampling of an implicitly indexed
array can then safely return an explicitly indexed object from
].implicite.series (or whatever naming is appropriate).

Cheers,
THK

Martin Maechler said:
>>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>>     on Tue, 10 Aug 2004 05:47:28 +0100 (BST) writes:
>
>     BDR> On Tue, 10 Aug 2004, Ross Ihaka wrote:
>     >> Rob Hyndman wrote:
>     >> > When part of a time series is extracted, the time series
> component is
>     >> > lost. e.g.,
>     >> > x <- ts(1:10)
>     >> > x[1:4]
>     >> >
>     >> > It would be nice if there was a subsetting function [.ts to avoid
> this
>     >> > problem. However, it is beyond my R-coding ability to produce
> such a
>     >> > thing.  Is someone willing to do it?
>
>     BDR> There is a [.ts, in src/library/stats/R/ts.R, and it is
> documented
>     BDR> (?"[.ts").
>
>     >> Have you had a look at "window"?  The problem with "["
>     >> its that it can produce non-contiguous sets of values.
>
>     BDR> Yes.
>
> indeed.  window() is what we have been advocation for a long
> time now ... (but see below).
>
>     BDR>   If you look in the sources for [.ts you will see,
>     BDR> commented, the code that was once there to handle cases
>     BDR> where the index was evenly spaced.  But it was removed
>     BDR> long ago in favour of window().  I tried to consult the
>     BDR> logs, but it seems that in the shift from CVS to SVN
>     BDR> recently I can't get at them.  I think the rationale
>     BDR> was that x[ind] should always produce an object of the
>     BDR> same class.
>
> well, that can't have been the only rationale since now
> x[ind] is *not* of the same class - when the "ts" property is
> lost in any case.
>
> I don't much like the current behavior of "[.ts" either.
> It should either work by returning the "ts" object in the
> equidistant case  and give a warning (at least) in the
> non-equidistant case.
> OTOH, intuitively, when 'ind' has length 1,  x[ind] should just
> give a number... [grumble..]
> But maybe it's only a very small performance hit when that
> continues to carry the "ts" class attribute along.
>
> If we think of the data.frame analogue, we might consider
> defining "[[.ts" for extracting numbers and "[.ts" to always
> return a time series or an error.
> But that is probably too much incompatible to current behavior.
>
> Martin
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


--
Timothy H. Keitt            http://www.keittlab.org/
Assistant professor
Section of Integrative Biology
University of Texas at Austin

From myeh at fs.fed.us  Tue Aug 10 18:58:34 2004
From: myeh at fs.fed.us (myeh@fs.fed.us)
Date: Tue Aug 10 18:58:39 2004
Subject: [Rd] Check failed after compilation (PR#7159)
Message-ID: <20040810165834.9B7E21119D@slim.kubism.ku.dk>

Full_Name: Madeleine Yeh
Version: 1.9.1
OS: AIX 5.2
Submission from: (NULL) (151.121.225.1)


  After compiling R-1.9.1 on AIX 5.2 using the IBM cc compiler, I ran the
checks.  One of them failed.  Here is the output from running the check solo.

root@svweb:/fsapps/test/build/R/1.9.1/R-1.9.1/tests/Examples:
># ../../bin/R --vanilla < stats-Ex.R                

R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.1  (2004-06-21), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> ### * <HEADER>
> ###
> attach(NULL, name = "CheckExEnv")
> assign(".CheckExEnv", as.environment(2), pos = length(search())) # base
> ## add some hooks to label plot pages, at least for base graphics
> .newplot.hook <- function()
+ {
+     pp <- par(c("mfg","mfcol","oma","mar"))
+     if(all(pp$mfg[1:2] == c(1, pp$mfcol[2]))) {
+       outer <- (oma4 <- pp$oma[4]) > 0; mar4 <- pp$mar[4]
+       mtext(paste("help(", ..nameEx, ")"), side = 4,
+             line = if(outer)max(1, oma4 - 1) else min(1, mar4 - 1),
+             outer = outer, adj = 1, cex = .8, col = "orchid", las=3)
+     }
+ }
> setHook("plot.new", .newplot.hook)
> setHook("persp", .newplot.hook)
> rm(.newplot.hook)
> ## add some hooks to label plot pages for grid graphics
> .gridplot.hook <- function()
+ {
+     pushViewport(viewport(width=unit(1, "npc") - unit(1, "lines"),
+                         x=0, just="left"))
+     grid.text(paste("help(", ..nameEx, ")"), 
+             x=unit(1, "npc") + unit(0.5, "lines"),
+             y=unit(0.8, "npc"), rot=90, 
+             gp=gpar(col="orchid"))
+ }
> setHook("grid.newpage", .gridplot.hook)
> rm(.gridplot.hook)
> assign("cleanEx",
+        function(env = .GlobalEnv) {
+          rm(list = ls(envir = env, all.names = TRUE), envir = env)
+            RNGkind("default", "default")
+          set.seed(1)
+          options(warn = 1)
+          assign("T", delay(stop("T used instead of TRUE")),
+                 pos = .CheckExEnv)
+          assign("F", delay(stop("F used instead of FALSE")),
+                 pos = .CheckExEnv)
+          sch <- search()
+          newitems <- sch[! sch %in% .oldSearch]
+          for(item in rev(newitems))
+                eval(substitute(detach(item), list(item=item)))
+          missitems <- .oldSearch[! .oldSearch %in% sch]
+          if(length(missitems))
+              warning("items ", paste(missitems, collapse=", "),
+                      " have been removed from the search path")
+        },
+        env = .CheckExEnv)
> assign("..nameEx", "__{must remake R-ex/*.R}__", env = .CheckExEnv) # for now
> assign("ptime", proc.time(), env = .CheckExEnv)
> graphics::postscript("stats-Examples.ps")
> assign("par.postscript", graphics::par(no.readonly = TRUE), env =
.CheckExEnv)
> options(contrasts = c(unordered = "contr.treatment", ordered = "contr.poly"))
> library('stats')
> 
> assign(".oldSearch", search(), env = .CheckExEnv)
> cleanEx(); ..nameEx <- "AIC"
> 
> ### * AIC
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: AIC
> ### Title: Akaike's An Information Criterion
> ### Aliases: AIC
> ### Keywords: models
> 
> ### ** Examples
> 
> data(swiss)
> lm1 <- lm(Fertility ~ . , data = swiss)
> AIC(lm1)
[1] 326.0716
> stopifnot(all.equal(AIC(lm1),
+                     AIC(logLik(lm1))))
> ## a version of BIC or Schwarz' BC :
> AIC(lm1, k = log(nrow(swiss)))
[1] 339.0226
> 
> 
> 
> cleanEx(); ..nameEx <- "ARMAacf"
> 
> ### * ARMAacf
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ARMAacf
> ### Title: Compute Theoretical ACF for an ARMA Process
> ### Aliases: ARMAacf
> ### Keywords: ts
> 
> ### ** Examples
> 
> ARMAacf(c(1.0, -0.25), 1.0, lag.max = 10)
          0           1           2           3           4           5 
1.000000000 0.875000000 0.625000000 0.406250000 0.250000000 0.148437500 
          6           7           8           9          10 
0.085937500 0.048828125 0.027343750 0.015136719 0.008300781 
> ## Example from Brockwell & Davis (1991, pp.92-4)
> ## answer 2^(-n) * (32/3 + 8 * n) /(32/3)
> n <- 1:10; 2^(-n) * (32/3 + 8 * n) /(32/3)
 [1] 0.875000000 0.625000000 0.406250000 0.250000000 0.148437500 0.085937500
 [7] 0.048828125 0.027343750 0.015136719 0.008300781
> ARMAacf(c(1.0, -0.25), 1.0, lag.max = 10, pacf = TRUE)
 [1]  0.8750000 -0.6000000  0.3750000 -0.2727273  0.2142857 -0.1764706
 [7]  0.1500000 -0.1304348  0.1153846 -0.1034483
> ARMAacf(c(1.0, -0.25), lag.max = 10, pacf = TRUE)
 [1]  8.000000e-01 -2.500000e-01 -6.579099e-17 -3.045879e-19  5.302086e-19
 [6]  2.059071e-17 -6.361500e-33 -1.027984e-17  5.139921e-18  1.606263e-33
> 
> 
> 
> cleanEx(); ..nameEx <- "ARMAtoMA"
> 
> ### * ARMAtoMA
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ARMAtoMA
> ### Title: Convert ARMA Process to Infinite MA Process
> ### Aliases: ARMAtoMA
> ### Keywords: ts
> 
> ### ** Examples
> 
> ARMAtoMA(c(1.0, -0.25), 1.0, 10)
 [1] 2.00000000 1.75000000 1.25000000 0.81250000 0.50000000 0.29687500
 [7] 0.17187500 0.09765625 0.05468750 0.03027344
> ## Example from Brockwell & Davis (1991, p.92)
> ## answer (1 + 3*n)*2^(-n)
> n <- 1:10; (1 + 3*n)*2^(-n)
 [1] 2.00000000 1.75000000 1.25000000 0.81250000 0.50000000 0.29687500
 [7] 0.17187500 0.09765625 0.05468750 0.03027344
> 
> 
> 
> cleanEx(); ..nameEx <- "AirPassengers"
> 
> ### * AirPassengers
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: AirPassengers
> ### Title: Monthly Airline Passenger Numbers 1949-1960
> ### Aliases: AirPassengers
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## Not run: ## These are quite slow and so not run by example(AirPassengers)
> ##D 
> ##D data(AirPassengers)
> ##D ## The classic 'airline model', by full ML
> ##D (fit <- arima(log10(AirPassengers), c(0, 1, 1),
> ##D               seasonal = list(order=c(0, 1 ,1), period=12)))
> ##D update(fit, method = "CSS")
> ##D update(fit, x=window(log10(AirPassengers), start = 1954))
> ##D pred <- predict(fit, n.ahead = 24)
> ##D tl <- pred$pred - 1.96 * pred$se
> ##D tu <- pred$pred + 1.96 * pred$se
> ##D ts.plot(AirPassengers, 10^tl, 10^tu, log = "y", lty = c(1,2,2))
> ##D 
> ##D ## full ML fit is the same if the series is reversed, CSS fit is not
> ##D ap0 <- rev(log10(AirPassengers))
> ##D attributes(ap0) <- attributes(AirPassengers)
> ##D arima(ap0, c(0, 1, 1), seasonal = list(order=c(0, 1 ,1), period=12))
> ##D arima(ap0, c(0, 1, 1), seasonal = list(order=c(0, 1 ,1), period=12),
> ##D       method = "CSS")
> ##D 
> ##D ## Structural Time Series
> ##D ap <- log10(AirPassengers) - 2
> ##D (fit <- StructTS(ap, type= "BSM"))
> ##D par(mfrow=c(1,2))
> ##D plot(cbind(ap, fitted(fit)), plot.type = "single")
> ##D plot(cbind(ap, tsSmooth(fit)), plot.type = "single")
> ## End(Not run)
> 
> 
> cleanEx(); ..nameEx <- "BOD"
> 
> ### * BOD
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: BOD
> ### Title: Biochemical Oxygen Demand
> ### Aliases: BOD
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(BOD)
> # simplest form of fitting a first-order model to these data
> fm1 <- nls(demand ~ A*(1-exp(-exp(lrc)*Time)), data = BOD,
+    start = c(A = 20, lrc = log(.35)))
> coef(fm1)
         A        lrc 
19.1425768 -0.6328215 
> print(fm1)
Nonlinear regression model
  model:  demand ~ A * (1 - exp(-exp(lrc) * Time)) 
   data:  BOD 
         A        lrc 
19.1425768 -0.6328215 
 residual sum-of-squares:  25.99027 
> # using the plinear algorithm
> fm2 <- nls(demand ~ (1-exp(-exp(lrc)*Time)), data = BOD,
+    start = c(lrc = log(.35)), algorithm = "plinear", trace = TRUE)
32.94622 : -1.049822 22.126001 
25.99248 : -0.6257161 19.1031883 
25.99027 : -0.6327039 19.1419223 
25.99027 : -0.6328192 19.1425644 
> # using a self-starting model
> fm3 <- nls(demand ~ SSasympOrig(Time, A, lrc), data = BOD)
> summary( fm3 )

Formula: demand ~ SSasympOrig(Time, A, lrc)

Parameters:
    Estimate Std. Error t value Pr(>|t|)   
A    19.1426     2.4959   7.670  0.00155 **
lrc  -0.6328     0.3824  -1.655  0.17328   
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 2.549 on 4 degrees of freedom

Correlation of Parameter Estimates:
          A
lrc -0.8528

> 
> 
> 
> cleanEx(); ..nameEx <- "Beta"
> 
> ### * Beta
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Beta
> ### Title: The Beta Distribution
> ### Aliases: Beta dbeta pbeta qbeta rbeta
> ### Keywords: distribution
> 
> ### ** Examples
> 
> x <- seq(0, 1, length=21)
> dbeta(x, 1, 1)
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
> pbeta(x, 1, 1)
 [1] 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[16] 0.75 0.80 0.85 0.90 0.95 1.00
> 
> 
> 
> cleanEx(); ..nameEx <- "Binomial"
> 
> ### * Binomial
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Binomial
> ### Title: The Binomial Distribution
> ### Aliases: Binomial dbinom pbinom qbinom rbinom
> ### Keywords: distribution
> 
> ### ** Examples
> 
> # Compute P(45 < X < 55) for X Binomial(100,0.5)
> sum(dbinom(46:54, 100, 0.5))
[1] 0.6317984
> 
> ## Using "log = TRUE" for an extended range :
> n <- 2000
> k <- seq(0, n, by = 20)
> plot (k, dbinom(k, n, pi/10, log=TRUE), type='l', ylab="log density",
+       main = "dbinom(*, log=TRUE) is better than  log(dbinom(*))")
> lines(k, log(dbinom(k, n, pi/10)), col='red', lwd=2)
> ## extreme points are omitted since dbinom gives 0.
> mtext("dbinom(k, log=TRUE)", adj=0)
> mtext("extended range", adj=0, line = -1, font=4)
> mtext("log(dbinom(k))", col="red", adj=1)
> 
> 
> 
> cleanEx(); ..nameEx <- "Cauchy"
> 
> ### * Cauchy
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Cauchy
> ### Title: The Cauchy Distribution
> ### Aliases: Cauchy dcauchy pcauchy qcauchy rcauchy
> ### Keywords: distribution
> 
> ### ** Examples
> 
> dcauchy(-1:4)
[1] 0.15915494 0.31830989 0.15915494 0.06366198 0.03183099 0.01872411
> 
> 
> 
> cleanEx(); ..nameEx <- "ChickWeight"
> 
> ### * ChickWeight
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ChickWeight
> ### Title: Weight versus age of chicks on different diets
> ### Aliases: ChickWeight
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(ChickWeight)
> coplot(weight ~ Time | Chick, data = ChickWeight,
+     type = "b", show = FALSE)
> ## fit a representative chick
> fm1 <- nls(weight ~ SSlogis( Time, Asym, xmid, scal ),
+     data = ChickWeight, subset = Chick == 1)
> summary( fm1 )

Formula: weight ~ SSlogis(Time, Asym, xmid, scal)

Parameters:
     Estimate Std. Error t value Pr(>|t|)    
Asym 937.0213   465.8578   2.011  0.07516 .  
xmid  35.2228     8.3119   4.238  0.00218 ** 
scal  11.4052     0.9052  12.599 5.08e-07 ***
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 2.919 on 9 degrees of freedom

Correlation of Parameter Estimates:
       Asym   xmid
xmid 0.9991       
scal 0.9745 0.9829

> 
> 
> 
> cleanEx(); ..nameEx <- "Chisquare"
> 
> ### * Chisquare
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Chisquare
> ### Title: The (non-central) Chi-Squared Distribution
> ### Aliases: Chisquare dchisq pchisq qchisq rchisq
> ### Keywords: distribution
> 
> ### ** Examples
> 
> dchisq(1, df=1:3)
[1] 0.2419707 0.3032653 0.2419707
> pchisq(1, df= 3)
[1] 0.1987480
> pchisq(1, df= 3, ncp = 0:4)# includes the above
[1] 0.19874804 0.13229855 0.08787311 0.05824691 0.03853592
> 
> x <- 1:10
> ## Chi-squared(df = 2) is a special exponential distribution
> all.equal(dchisq(x, df=2), dexp(x, 1/2))
[1] TRUE
> all.equal(pchisq(x, df=2), pexp(x, 1/2))
[1] TRUE
> 
> ## non-central RNG -- df=0 is ok for ncp > 0:  Z0 has point mass at 0!
> Z0 <- rchisq(100, df = 0, ncp = 2.)
> graphics::stem(Z0)

  The decimal point is at the |

  0 | 0000000000000000000000000000000000000013356778899
  1 | 0001333456678888899
  2 | 0011444467
  3 | 00233345888
  4 | 111246
  5 | 
  6 | 
  7 | 178
  8 | 23

> 
> ## Not run: 
> ##D ## visual testing
> ##D ## do P-P plots for 1000 points at various degrees of freedom
> ##D L <- 1.2; n <- 1000; pp <- ppoints(n)
> ##D op <- par(mfrow = c(3,3), mar= c(3,3,1,1)+.1, mgp= c(1.5,.6,0),
> ##D           oma = c(0,0,3,0))
> ##D for(df in 2^(4*rnorm(9))) {
> ##D   plot(pp, sort(pchisq(rr <- rchisq(n,df=df, ncp=L), df=df, ncp=L)),
> ##D        ylab="pchisq(rchisq(.),.)", pch=".")
> ##D   mtext(paste("df = ",formatC(df, digits = 4)), line= -2, adj=0.05)
> ##D   abline(0,1,col=2)
> ##D }
> ##D mtext(expression("P-P plots : Noncentral  "*
> ##D                  chi^2 *"(n=1000, df=X, ncp= 1.2)"),
> ##D       cex = 1.5, font = 2, outer=TRUE)
> ##D par(op)
> ## End(Not run)
> 
> 
> 
> cleanEx(); ..nameEx <- "DNase"
> 
> ### * DNase
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: DNase
> ### Title: Elisa assay of DNase
> ### Aliases: DNase
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(DNase)
> coplot(density ~ conc | Run, data = DNase,
+     show = FALSE, type = "b")
> coplot(density ~ log(conc) | Run, data = DNase,
+     show = FALSE, type = "b")
> ## fit a representative run
> fm1 <- nls(density ~ SSlogis( log(conc), Asym, xmid, scal ),
+     data = DNase, subset = Run == 1)
> ## compare with a four-parameter logistic
> fm2 <- nls(density ~ SSfpl( log(conc), A, B, xmid, scal ),
+     data = DNase, subset = Run == 1)
> summary(fm2)

Formula: density ~ SSfpl(log(conc), A, B, xmid, scal)

Parameters:
      Estimate Std. Error t value Pr(>|t|)    
A    -0.007897   0.017200  -0.459    0.654    
B     2.377239   0.109516  21.707 5.35e-11 ***
xmid  1.507403   0.102080  14.767 4.65e-09 ***
scal  1.062579   0.056996  18.643 3.16e-10 ***
---
Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

Residual standard error: 0.01981 on 12 degrees of freedom

Correlation of Parameter Estimates:
           A      B   xmid
B    -0.6375              
xmid -0.5176 0.9811       
scal -0.8030 0.9266 0.8796

> anova(fm1, fm2)
Analysis of Variance Table

Model 1: density ~ SSlogis(log(conc), Asym, xmid, scal)
Model 2: density ~ SSfpl(log(conc), A, B, xmid, scal)
  Res.Df Res.Sum Sq Df    Sum Sq F value Pr(>F)
1     13  0.0047896                            
2     12  0.0047073  1 0.0000823  0.2098 0.6551
> 
> 
> 
> cleanEx(); ..nameEx <- "Exponential"
> 
> ### * Exponential
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Exponential
> ### Title: The Exponential Distribution
> ### Aliases: Exponential dexp pexp qexp rexp
> ### Keywords: distribution
> 
> ### ** Examples
> 
> dexp(1) - exp(-1) #-> 0
[1] 0
> 
> 
> 
> cleanEx(); ..nameEx <- "Fdist"
> 
> ### * Fdist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: FDist
> ### Title: The F Distribution
> ### Aliases: FDist df pf qf rf
> ### Keywords: distribution
> 
> ### ** Examples
> 
> ## the density of the square of a t_m is 2*dt(x, m)/(2*x)
> # check this is the same as the density of F_{1,m}
> x <- seq(0.001, 5, len=100)
> all.equal(df(x^2, 1, 5), dt(x, 5)/x)
[1] TRUE
> 
> ## Identity:  qf(2*p - 1, 1, df)) == qt(p, df)^2)  for  p >= 1/2
> p <- seq(1/2, .99, length=50); df <- 10
> rel.err <- function(x,y) ifelse(x==y,0, abs(x-y)/mean(abs(c(x,y))))
> quantile(rel.err(qf(2*p - 1, df1=1, df2=df), qt(p, df)^2), .90)# ~= 7e-9
         90% 
1.542479e-15 
> 
> 
> 
> cleanEx(); ..nameEx <- "GammaDist"
> 
> ### * GammaDist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: GammaDist
> ### Title: The Gamma Distribution
> ### Aliases: GammaDist dgamma pgamma qgamma rgamma
> ### Keywords: distribution
> 
> ### ** Examples
> 
> -log(dgamma(1:4, shape=1))
[1] 1 2 3 4
> p <- (1:9)/10
> pgamma(qgamma(p,shape=2), shape=2)
[1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
> 1 - 1/exp(qgamma(p, shape=1))
[1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
> 
> 
> 
> cleanEx(); ..nameEx <- "Geometric"
> 
> ### * Geometric
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Geometric
> ### Title: The Geometric Distribution
> ### Aliases: Geometric dgeom pgeom qgeom rgeom
> ### Keywords: distribution
> 
> ### ** Examples
> 
> qgeom((1:9)/10, prob = .2)
[1]  0  0  1  2  3  4  5  7 10
> Ni <- rgeom(20, prob = 1/4); table(factor(Ni, 0:max(Ni)))

 0  1  2  3  4  5  6  7  8  9 10 11 
 5  3  3  1  2  2  0  1  0  1  1  1 
> 
> 
> 
> cleanEx(); ..nameEx <- "Harman23.cor"
> 
> ### * Harman23.cor
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: Harman23.cor
> ### Title: Harman Example 2.3
> ### Aliases: Harman23.cor
> ### Keywords: datasets
> 
> ### ** Examples
> 
> data(Harman23.cor)
> (Harman23.FA <- factanal(factors = 1, covmat = Harman23.cor))

Call:
factanal(factors = 1, covmat = Harman23.cor)

Uniquenesses:
        height       arm.span        forearm      lower.leg         weight 
         0.158          0.135          0.190          0.187          0.760 
bitro.diameter    chest.girth    chest.width 
         0.829          0.877          0.801 

Loadings:
               Factor1
height         0.918  
arm.span       0.930  
forearm        0.900  
lower.leg      0.902  
weight         0.490  
bitro.diameter 0.413  
chest.girth    0.351  
chest.width    0.446  

               Factor1
SS loadings      4.064
Proportion Var   0.508

Test of the hypothesis that 1 factor is sufficient.
The chi square statistic is 611.44 on 20 degrees of freedom.
The p-value is 1.12e-116 
> for(factors in 2:4) print(update(Harman23.FA, factors = factors))
Error in La.svd(B) : infinite or missing values in x
Execution halted

    If there is any other information I can give you, please write and I'll send
it.
 thanks;
       Madeleine

From l.k.s.daldorff at astro.uio.no  Wed Aug 11 10:38:45 2004
From: l.k.s.daldorff at astro.uio.no (l.k.s.daldorff@astro.uio.no)
Date: Wed Aug 11 10:38:47 2004
Subject: [Rd] Re Re: R 1.9.1 (PR#7158)
Message-ID: <20040811083845.B3A6F111AA@slim.kubism.ku.dk>

paul murrell writes:
>  Hi
>  
>  
>  > Hi
>  > 
>  > I am not to familier with R
>  > 
>  > The following problem are observed on 1.9.1 but not on 1.9.0.
>  > Both R distribution installed from source code.
>  > 
>  > System:
>  > 
>  > Mac os X 10.3
>  > Xdarwin 4.4 (xfree)
>  > 
>  > 
>  > Problem:
>  > 
>  > I generate a multiplot by :
>  > 
>  > X11() ## making the devise I want to save to file (num)
>  > par(mfow=c(3,3))
>  > 
>  > par(mfg=c(1,1,3,3))
>  > plot(........
>  > ...
>  > ..
>  > .
>  > 
>  > 
>  > Then I want to print it to file wit specifying the devise number. I use the
>  > following structure
>  > 
>  > postscript(filename......)
>  > d =dev.cur()
>  > dev.set(which=num)  ### num : the devise I want to save to file
>  > dev.copy(which=d)
>  > dev.off(d)
>  > 
>  > 
>  > The following message is than resived when running the functions:
>  > 
>  > Warning message:
>  > Display list redraw incomplet
>  
>  
>  This means that a problem has occurred during the dev.copy() and not all of the
>  graphical output has been copied (there should be stuff missing in the
>  postscript version).  The most likely source of the problem is that there is not
>  enough space for the plots (are you specifying the width and/or height for the
>  postscript file?  how big is the X11 window you did the original plotting in?). 
>  
>  (I don't think this is a bug)

Thanks for the fast reply.I don't know if it is a bug or not ,only that it
don't work. I have both R-1.9.0 and R-1.9.1 installed and run the exact same
program/data on both, the R-1.9.0 works. I agree that the problem most
probably is related to dev.copy() .

xwininfo gives H:524 and W:524 

The postscript file is ~A4 
postscript(filename,horizontal=FALSE,height=10,pointsize=10)
The function generate a postscript file with the headers and so on but none
of the plot are recreated in the file. 

Lars

From maechler at stat.math.ethz.ch  Wed Aug 11 19:14:17 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed Aug 11 19:14:19 2004
Subject: [Rd] interaction.plot
In-Reply-To: <16659.16456.59935.936785@gargle.gargle.HOWL>
References: <16659.16456.59935.936785@gargle.gargle.HOWL>
Message-ID: <16666.21481.976975.618301@gargle.gargle.HOWL>

>>>>> "ChrBu" == Christoph Buser <buser@stat.math.ethz.ch>
>>>>>     on Fri, 6 Aug 2004 10:24:40 +0200 writes:

    ChrBu> Dear R core team I've a proprosal to improve the
    ChrBu> function interaction.plot. It should be allowed to
    ChrBu> use type = "b". 

thank you for the suggestion.
I've implemented the above for R-devel several days ago.

    ChrBu> This can be done by changing the function's header from

    ChrBu> function( , type = c("l", "p"), )

    ChrBu> to

    ChrBu> function( , type = c("l", "p", "b"), )

    ChrBu> Then it works. 

well, as I mentioned to you privately, it also needs a change
in the legend() call subsequently.

    ChrBu> This type = "b" is useful, if the second level of the
    ChrBu> x.factor is missing for some level of the
    ChrBu> trace.factor. With type= "l" you loose first level of
    ChrBu> the x.factor, too (because you can't draw the line to
    ChrBu> the missing second level). With type = "p" so see
    ChrBu> this first level, but you have no lines at all (just
    ChrBu> chaos with points). With type = "b", you get all
    ChrBu> existing levels plus the lines between two contiguous
    ChrBu> levels (if they both exist).



    ChrBu> There is a second point. Using interaction.plot with
    ChrBu> the additional argument main creates a warning:

    ChrBu> parameter "main" couldn't be set in high-level plot() function

    ChrBu> The reason is that "..." is used twice inside of
    ChrBu> interaction.plot, in fact in

    ChrBu> matplot( ,...)

    ChrBu> and in

    ChrBu> axis( ,...)

    ChrBu> axis can do nothing with this argument main and
    ChrBu> creates this warning. You could replace ,... in the
    ChrBu> axis function by inserting all reasonable arguments
    ChrBu> of axis in the functions header (interaction.plot)
    ChrBu> and give over those arguments to axis. Then you
    ChrBu> shouldn't get this warning anymore.

yes, indeed.

Note however that this warning also happens with other such plotting
functions and I find it is not a real blemish.
Your proposed solution is not so obvious or easy, since 
axis() really has its own ``intrinsic'' ... argument and
conceptually does accept many more possible "graphical
parameters" in addition to its specific ones.

Hence I believe it would need quite a large extent of extra code
in order to
1) keep the current potential functionality
2) always properly separate arguments to be passed to matplot()
   from those to be passed to axis().

-- and as ``we all know'' we should really use lattice package
   functions rather than interaction.plot() 
   {but then I'm still not the role model here ... ;-( }

Martin

From deepayan at stat.wisc.edu  Wed Aug 11 23:22:55 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Wed Aug 11 23:23:15 2004
Subject: [Rd] doc buglet: misleading description in ?source 
Message-ID: <200408111622.55324.deepayan@stat.wisc.edu>


[with current r-devel]

source() works fine with connections, as explained in the entry for 
'file' and in the 'Details' section. However, the description is 
misleading, saying that:

    'source' causes R to accept its input from the named file (the
     name must be quoted). Input is read from that file until the end
     of the file is reached. <...>

Deepayan

From walke at demogr.mpg.de  Thu Aug 12 13:24:58 2004
From: walke at demogr.mpg.de (walke@demogr.mpg.de)
Date: Thu Aug 12 13:25:02 2004
Subject: [Rd] Install packages does not work on Win2003 server (PR#7163)
Message-ID: <20040812112458.77643111F0@slim.kubism.ku.dk>

Full_Name: Rainer Walke
Version: 1.9.1
OS: Windows XP
Submission from: (NULL) (195.37.34.66)


I tried to install R 1.9.1 on a network share on a Windows 2003 server. This
works fine. Then I tried to add some packages. This does not work.
There is no error message. It seems to hang a while, but then the command prompt
is back, but no package has been installed.

If you check the directory rw1091\library then a temporary directory file*
appears and disappears after a minute.

If I use a Windows NT client to add the packages at a Windows 2003 server it
works.
If I use a Windows XP client to add packages at a Windows NT share it work
either.

From ripley at stats.ox.ac.uk  Thu Aug 12 13:58:03 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 12 13:58:10 2004
Subject: [Rd] Install packages does not work on Win2003 server (PR#7163)
In-Reply-To: <20040812112458.77643111F0@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408121254380.16018-100000@gannet.stats>

`Windows 2003 server' is not in the list of supported OSes.  And that is 
both in the README and rw-FAQ.  So if you want to help, we need a patch 
from you -- the maintainers do not that access to such a machine.
(Well, I do, but it is a server which does not allow end users to run 
tasks.)

On Thu, 12 Aug 2004 walke@demogr.mpg.de wrote:

> Full_Name: Rainer Walke
> Version: 1.9.1
> OS: Windows XP
> Submission from: (NULL) (195.37.34.66)
> 
> 
> I tried to install R 1.9.1 on a network share on a Windows 2003 server. This
> works fine. Then I tried to add some packages. This does not work.
> There is no error message. It seems to hang a while, but then the command prompt
> is back, but no package has been installed.
> 
> If you check the directory rw1091\library then a temporary directory file*
> appears and disappears after a minute.

There are many ways to install packages, both from source and binary.
Please do as the FAQ and posting guide ask, and provide a reproducible 
example.

> If I use a Windows NT client to add the packages at a Windows 2003 server it
> works.
> If I use a Windows XP client to add packages at a Windows NT share it work
> either.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Thu Aug 12 14:10:26 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Thu Aug 12 14:10:33 2004
Subject: [Rd] Install packages does not work on Win2003 server (PR#7163)
Message-ID: <20040812121026.A45B110FDE@slim.kubism.ku.dk>

walke@demogr.mpg.de wrote:
> Full_Name: Rainer Walke
> Version: 1.9.1
> OS: Windows XP
> Submission from: (NULL) (195.37.34.66)
> 
> 
> I tried to install R 1.9.1 on a network share on a Windows 2003 server. This
> works fine. Then I tried to add some packages. This does not work.
> There is no error message. It seems to hang a while, but then the command prompt
> is back, but no package has been installed.
> 
> If you check the directory rw1091\library then a temporary directory file*
> appears and disappears after a minute.
> 
> If I use a Windows NT client to add the packages at a Windows 2003 server it
> works.
> If I use a Windows XP client to add packages at a Windows NT share it work
> either.

a) It works for me.
b) If it works for you on some Windows versions but not on others, why 
do you think it is a bug in R?

Quite probably something is not set up correctly either in your 
configuration of Windows (permissions, quota, ...) or in the 
configuration of R (do you have set another library path to install to)?

Please tell us the way you tried to install the package.

Uwe Ligges


> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Thu Aug 12 14:34:58 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 12 14:35:00 2004
Subject: [Rd] The Depends: field of a package is now used by library()
Message-ID: <Pine.LNX.4.44.0408121322180.16170-100000@gannet.stats>

In R-devel, the Depends: field in the DESCRIPTION file is now used by 
library() to load the named packages before the current package, and also 
to set up the environment to save images and prepare for lazy loading.

Would authors please use a minimally necessary set of packages in Depends, 
and put others in Suggests: -- the distinction is made in `Writing R 
Extensions'.  On the other hand, do include standard packages like
graphics, stats and utils if needed, as R can be run without these.
(For example, packages which define S4 methods for plot do depend on 
graphics and may fail if graphics is loaded after them.)

There is a little danger of cycles in dependencies if there are
unnecessary entries, and load time will be slowed (although with 
lazy-loading that is a much smaller penalty than it used to be).

This change should enable the installation procedure to be simplified for 
packages which save images -- you can probably omit both install.R and 
R_PROFILE.R and use fields in DESCRIPTION instead -- see `Writing R
Extensions'.  More details of recommended changes will appear on the 
developer site nearer release time.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Walke at demogr.mpg.de  Thu Aug 12 15:23:44 2004
From: Walke at demogr.mpg.de (Walke@demogr.mpg.de)
Date: Thu Aug 12 15:23:48 2004
Subject: [Rd] Install packages does not work on Win2003 server (PR#716 3)
Message-ID: <20040812132344.C21BA10F39@slim.kubism.ku.dk>

	>a) It works for me.
	>b) If it works for you on some Windows versions but not on others,
why 
	>do you think it is a bug in R?

	It is the first of our application that shows this problem. At least
as far as I know.
	The installation of R works without any problem, only the addition
of further packages does not. What is the difference between both
installation parts? Of course you may ask what is the difference between
Windows NT and Windows XP as client system. And you may ask what is the
difference between a Windows NT and a Windows 2003 file server?
	Is R using a piece of code that Windows XP sends wrong to a Windows
2003 file server?

	>Quite probably something is not set up correctly either in your 
	>configuration of Windows (permissions, quota, ...) or in the 
	>configuration of R (do you have set another library path to install
to)?

	>Please tell us the way you tried to install the package.

	>Uwe Ligges

	What I did, was "Install packages from local zip files..."
interactivly.

	Best,
	Rainer Walke





+++++
This mail has been sent through the MPI for Demographic Rese...{{dropped}}

From p.dalgaard at biostat.ku.dk  Thu Aug 12 16:05:47 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Aug 12 16:10:02 2004
Subject: [Rd] Disallowing a < b < c in R 2.0.0
Message-ID: <x2acx0h2o4.fsf@biostat.ku.dk>


We're making a change to R's syntax for the 2.0 series. The change
is to disallow associative usage of relational operators (since, e.g.,
a < b < c does not mean what some users think it does.) There are
legitimate uses, but they are quite rare. Further, they might be
considered questionable programming style and issues are always
fixable by inserting parentheses. Use braces in plotmath, e.g.
text(0,0,quote({a<b}<c)).

A not-quite exhaustive check found only 4 CRAN packages containing
this kind of construct and none in Bioconductor. To find problems in
your own code, probably the easiest thing is to run it with a snapshot
version of R, when it hits the CRAN mirrors in a few days.

        -p


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From deepayan at stat.wisc.edu  Thu Aug 12 16:42:20 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Thu Aug 12 16:42:35 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <Pine.LNX.4.44.0408121322180.16170-100000@gannet.stats>
References: <Pine.LNX.4.44.0408121322180.16170-100000@gannet.stats>
Message-ID: <200408120942.20270.deepayan@stat.wisc.edu>

On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> In R-devel, the Depends: field in the DESCRIPTION file is now used by
> library() to load the named packages before the current package, and
> also to set up the environment to save images and prepare for lazy
> loading.

How would this relate to namespaces? For instance, lattice imports grid 
(and a few things from stats and graphics). If I keep grid in the 
depends field, loading lattice does a require(grid), which defeats one 
of the purposes of having namespaces. If I leave it out, nothing bad 
seems to happen as long as grid is installed, but there should be some 
indication in the DESCRIPTION that that grid is a requirement. None of 
the other fields seem appropriate.

Deepayan

From w.huber at dkfz-heidelberg.de  Thu Aug 12 17:16:38 2004
From: w.huber at dkfz-heidelberg.de (Wolfgang Huber)
Date: Thu Aug 12 17:18:09 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <200408120942.20270.deepayan@stat.wisc.edu>
References: <Pine.LNX.4.44.0408121322180.16170-100000@gannet.stats>
	<200408120942.20270.deepayan@stat.wisc.edu>
Message-ID: <411B89D6.1040108@dkfz-heidelberg.de>

> On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> 
>>In R-devel, the Depends: field in the DESCRIPTION file is now used by
>>library() to load the named packages before the current package, and
>>also to set up the environment to save images and prepare for lazy
>>loading.
> 

Are circular dependencies allowed?
Or do they need to be broken, e.g. by replacing one of the edges in a 
loop by a "suggests"?

  Best wishes
    Wolfgang

-- 
-------------------------------------
Wolfgang Huber
Division of Molecular Genome Analysis
German Cancer Research Center
Heidelberg, Germany
Phone: +49 6221 424709
Fax:   +49 6221 42524709
Http:  www.dkfz.de/abt0840/whuber

From ripley at stats.ox.ac.uk  Thu Aug 12 17:19:12 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 12 17:19:15 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <200408120942.20270.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.44.0408121614320.20697-100000@gannet.stats>

On Thu, 12 Aug 2004, Deepayan Sarkar wrote:

> On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> > In R-devel, the Depends: field in the DESCRIPTION file is now used by
> > library() to load the named packages before the current package, and
> > also to set up the environment to save images and prepare for lazy
> > loading.
> 
> How would this relate to namespaces? For instance, lattice imports grid 
> (and a few things from stats and graphics). If I keep grid in the 
> depends field, loading lattice does a require(grid), which defeats one 
> of the purposes of having namespaces. If I leave it out, nothing bad 
> seems to happen as long as grid is installed, but there should be some 
> indication in the DESCRIPTION that that grid is a requirement. None of 
> the other fields seem appropriate.

It's a grey area.  As all copies of R that you are using will have grid, 
leave it out of Depends: for lattice.

Perhaps we need to invent another field such as UsesNamespaces?

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rossini at blindglobe.net  Thu Aug 12 17:22:17 2004
From: rossini at blindglobe.net (A.J. Rossini)
Date: Thu Aug 12 17:25:36 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <411B89D6.1040108@dkfz-heidelberg.de> (Wolfgang Huber's message
	of "Thu, 12 Aug 2004 17:16:38 +0200")
References: <Pine.LNX.4.44.0408121322180.16170-100000@gannet.stats>
	<200408120942.20270.deepayan@stat.wisc.edu>
	<411B89D6.1040108@dkfz-heidelberg.de>
Message-ID: <85u0v89yae.fsf@servant.blindglobe.net>

Wolfgang Huber <w.huber@dkfz-heidelberg.de> writes:

>> On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
>>
>>>In R-devel, the Depends: field in the DESCRIPTION file is now used by
>>>library() to load the named packages before the current package, and
>>>also to set up the environment to save images and prepare for lazy
>>>loading.
>>
>
> Are circular dependencies allowed?
> Or do they need to be broken, e.g. by replacing one of the edges in a
> loop by a "suggests"?

Argh -- BioC has something close to that for builds.  The release
folks will have to explore that issue!

-- 
Anthony Rossini			    Research Associate Professor
rossini@u.washington.edu            http://www.analytics.washington.edu/ 
Biomedical and Health Informatics   University of Washington
Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From ripley at stats.ox.ac.uk  Thu Aug 12 17:20:52 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 12 17:28:25 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <411B89D6.1040108@dkfz-heidelberg.de>
Message-ID: <Pine.LNX.4.44.0408121619270.20697-100000@gannet.stats>

On Thu, 12 Aug 2004, Wolfgang Huber wrote:

> > On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> > 
> >>In R-devel, the Depends: field in the DESCRIPTION file is now used by
> >>library() to load the named packages before the current package, and
> >>also to set up the environment to save images and prepare for lazy
> >>loading.
> > 
> 
> Are circular dependencies allowed?
> Or do they need to be broken, e.g. by replacing one of the edges in a 
> loop by a "suggests"?

They need to be broken.  I only encountered them where Suggests: was 
appropriate.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Thu Aug 12 17:37:40 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Aug 12 17:36:45 2004
Subject: [Rd] (PR#7163) Install packages does not work on Win2003 server
In-Reply-To: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFB@hermes.demogr.mpg.de>
References: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFB@hermes.demogr.mpg.de>
Message-ID: <411B8EC4.9040806@statistik.uni-dortmund.de>

Walke, Rainer wrote:

> 	>a) It works for me.
> 	>b) If it works for you on some Windows versions but not on others,
> why 
> 	>do you think it is a bug in R?
> 
> 	It is the first of our application that shows this problem. At least
> as far as I know.
> 	The installation of R works without any problem, only the addition
> of further packages does not. What is the difference between both
> installation parts? Of course you may ask what is the difference between
> Windows NT and Windows XP as client system. And you may ask what is the
> difference between a Windows NT and a Windows 2003 file server?
> 	Is R using a piece of code that Windows XP sends wrong to a Windows
> 2003 file server?
> 
> 	>Quite probably something is not set up correctly either in your 
> 	>configuration of Windows (permissions, quota, ...) or in the 
> 	>configuration of R (do you have set another library path to install
> to)?
> 
> 	>Please tell us the way you tried to install the package.
> 
> 	>Uwe Ligges
> 
> 	What I did, was "Install packages from local zip files..."
> interactivly.
> 
> 	Best,
> 	Rainer Walke


Is the share form which R has been started mounted on a drive letter or 
do you start via the UNC path?
Which package is it? Does it also happen for CRAN packages?
I guess any security setting either on the Server or the client are 
blocking the installation. But it is really hard to guess what it really 
is... You might want to ask your local IT stuff.

Uwe Ligges

From ripley at stats.ox.ac.uk  Thu Aug 12 17:32:11 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 12 17:39:43 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <85u0v89yae.fsf@servant.blindglobe.net>
Message-ID: <Pine.LNX.4.44.0408121627440.20697-100000@gannet.stats>

On Thu, 12 Aug 2004, A.J. Rossini wrote:

> Wolfgang Huber <w.huber@dkfz-heidelberg.de> writes:
> 
> >> On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> >>
> >>>In R-devel, the Depends: field in the DESCRIPTION file is now used by
> >>>library() to load the named packages before the current package, and
> >>>also to set up the environment to save images and prepare for lazy
> >>>loading.
> >>
> >
> > Are circular dependencies allowed?
> > Or do they need to be broken, e.g. by replacing one of the edges in a
> > loop by a "suggests"?
> 
> Argh -- BioC has something close to that for builds.  The release
> folks will have to explore that issue!

If all the packages were using saved images, nothing has changed, for the 
Depends: packages are the ones needed to save the image.  (The rest are 
Suggests:.)  And if a package is not using a saved image then the
Depends: are not needed to build it.

You can probably break this by building a package with --no-save and then 
building it later with --save.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From deepayan at stat.wisc.edu  Thu Aug 12 17:47:45 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Thu Aug 12 17:48:04 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <Pine.LNX.4.44.0408121614320.20697-100000@gannet.stats>
References: <Pine.LNX.4.44.0408121614320.20697-100000@gannet.stats>
Message-ID: <200408121047.45862.deepayan@stat.wisc.edu>

On Thursday 12 August 2004 10:19, Prof Brian Ripley wrote:
> On Thu, 12 Aug 2004, Deepayan Sarkar wrote:
> > On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> > > In R-devel, the Depends: field in the DESCRIPTION file is now
> > > used by library() to load the named packages before the current
> > > package, and also to set up the environment to save images and
> > > prepare for lazy loading.
> >
> > How would this relate to namespaces? For instance, lattice imports
> > grid (and a few things from stats and graphics). If I keep grid in
> > the depends field, loading lattice does a require(grid), which
> > defeats one of the purposes of having namespaces. If I leave it
> > out, nothing bad seems to happen as long as grid is installed, but
> > there should be some indication in the DESCRIPTION that that grid
> > is a requirement. None of the other fields seem appropriate.
>
> It's a grey area.  As all copies of R that you are using will have
> grid, leave it out of Depends: for lattice.
> 
> Perhaps we need to invent another field such as UsesNamespaces?

That should work. 

Writing R Extensions says that 

`Packages that are necessary to successfully load the package using 
library(pkgname) must be listed in the Depends field.'

which no longer remains true. Ideally, it probably would have been 
better to keep the old behaviour of Depends, and add the new 
functionality in a new field, but I guess this way the majority of 
packages can remain unchanged while being able to avail the new 
features.

Deepayan

From ripley at stats.ox.ac.uk  Thu Aug 12 17:55:02 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 12 17:55:04 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <200408121047.45862.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.44.0408121648220.20766-100000@gannet.stats>

On Thu, 12 Aug 2004, Deepayan Sarkar wrote:

> On Thursday 12 August 2004 10:19, Prof Brian Ripley wrote:
> > On Thu, 12 Aug 2004, Deepayan Sarkar wrote:
> > > On Thursday 12 August 2004 07:34, Prof Brian Ripley wrote:
> > > > In R-devel, the Depends: field in the DESCRIPTION file is now
> > > > used by library() to load the named packages before the current
> > > > package, and also to set up the environment to save images and
> > > > prepare for lazy loading.
> > >
> > > How would this relate to namespaces? For instance, lattice imports
> > > grid (and a few things from stats and graphics). If I keep grid in
> > > the depends field, loading lattice does a require(grid), which
> > > defeats one of the purposes of having namespaces. If I leave it
> > > out, nothing bad seems to happen as long as grid is installed, but
> > > there should be some indication in the DESCRIPTION that that grid
> > > is a requirement. None of the other fields seem appropriate.
> >
> > It's a grey area.  As all copies of R that you are using will have
> > grid, leave it out of Depends: for lattice.
> > 
> > Perhaps we need to invent another field such as UsesNamespaces?
> 
> That should work. 
> 
> Writing R Extensions says that 
> 
> `Packages that are necessary to successfully load the package using 
> library(pkgname) must be listed in the Depends field.'
> 
> which no longer remains true. 

Well, it was never true in the sense that it was frequently broken with 
impunity!  One could argue it is still true, as package != namespace.

> Ideally, it probably would have been 
> better to keep the old behaviour of Depends, and add the new 
> functionality in a new field, but I guess this way the majority of 
> packages can remain unchanged while being able to avail the new 
> features.

Yes.  I originally suggested 'EssentialPackages' and 'RequiredPackages',
but was persuaded otherwise.  Even then, it would be good to make clear
the difference between needing a namespace to be loadable and needing a 
package attached.

I can't think of any other example of one package only needing the 
namespace of another (contributed) package.

Thanks for raising the issue.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From deepayan at stat.wisc.edu  Thu Aug 12 18:24:00 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Thu Aug 12 18:24:22 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <Pine.LNX.4.44.0408121648220.20766-100000@gannet.stats>
References: <Pine.LNX.4.44.0408121648220.20766-100000@gannet.stats>
Message-ID: <200408121124.00119.deepayan@stat.wisc.edu>

On Thursday 12 August 2004 10:55, Prof Brian Ripley wrote:

> I can't think of any other example of one package only needing the
> namespace of another (contributed) package.

That's probably because few packages have namespaces yet. Another 
example is nlme which imports lattice, but that's still within 
recommended packages. In the long run, hopefully more packages will 
start using namespaces when appropriate, so this might become more 
relevant.

The only issue I see here is a way to mention namespace requirements in 
DESCRIPTION (which could have been done with Depends thus far because 
it didn't actually do anything else, even though though the intent has 
always been there).

Imported packages are still dependencies in the sense that a package has 
to be available for it's namespace to be usable, so leaving them out of 
Depends: feels slightly weird, but I can live with it.

Deepayan

From K9W8B2 at aol.com  Fri Aug 13 05:46:17 2004
From: K9W8B2 at aol.com (K9W8B2@aol.com)
Date: Fri Aug 13 05:46:18 2004
Subject: [Rd] - (no subject) RIX3Q5
Message-ID: <200408130346.i7D3kHRq024507@hypatia.math.ethz.ch>

Subject: (no subject) RIX3Q5

: Hey come check out my hot live webcam. My webcam is free to access so Sign up today!!  http://ez-cams.tk U756AA<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>W84VHR

From Walke at demogr.mpg.de  Fri Aug 13 08:39:52 2004
From: Walke at demogr.mpg.de (Walke, Rainer)
Date: Fri Aug 13 08:39:56 2004
Subject: [Rd] (PR#7163) Install packages does not work on Win2003 serv er
Message-ID: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFD@hermes.demogr.mpg.de>



> -----Original Message-----
> From:	Uwe Ligges [SMTP:ligges@statistik.uni-dortmund.de]
> Sent:	Thursday, August 12, 2004 5:38 PM
> To:	Walke, Rainer
> Cc:	R-devel
> Subject:	Re: [Rd] (PR#7163) Install packages does not work on Win2003
> server
> 
> Walke, Rainer wrote:
> 
> > 	>a) It works for me.
> > 	>b) If it works for you on some Windows versions but not on others,
> > why 
> > 	>do you think it is a bug in R?
> > 
> > 	It is the first of our application that shows this problem. At least
> > as far as I know.
> > 	The installation of R works without any problem, only the addition
> > of further packages does not. What is the difference between both
> > installation parts? Of course you may ask what is the difference between
> > Windows NT and Windows XP as client system. And you may ask what is the
> > difference between a Windows NT and a Windows 2003 file server?
> > 	Is R using a piece of code that Windows XP sends wrong to a Windows
> > 2003 file server?
> > 
> > 	>Quite probably something is not set up correctly either in your 
> > 	>configuration of Windows (permissions, quota, ...) or in the 
> > 	>configuration of R (do you have set another library path to install
> > to)?
> > 
> > 	>Please tell us the way you tried to install the package.
> > 
> > 	>Uwe Ligges
> > 
> > 	What I did, was "Install packages from local zip files..."
> > interactivly.
> > 
> > 	Best,
> > 	Rainer Walke
> 
> 
	> Is the share form which R has been started mounted on a drive
letter or 
	> do you start via the UNC path?
	> Which package is it? Does it also happen for CRAN packages?
	> I guess any security setting either on the Server or the client
are 
	> blocking the installation. But it is really hard to guess what it
really 
	> is... You might want to ask your local IT stuff.

	> Uwe Ligges

	Thanks for your e-mail message. Yes, the share has been mounted on a
drive letter P.
	Unfortunately, it happens for all packages starting from abind...
	And it happens if I load a package directly from CRAN as well.
	Do you know which part of the R code creates this temporary file*
directories in the library subdirectory?

	Rainer Walke



+++++
This mail has been sent through the MPI for Demographic Rese...{{dropped}}

From ligges at statistik.uni-dortmund.de  Fri Aug 13 08:55:30 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Aug 13 08:54:36 2004
Subject: [Rd] (PR#7163) Install packages does not work on Win2003 serv er
In-Reply-To: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFD@hermes.demogr.mpg.de>
References: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFD@hermes.demogr.mpg.de>
Message-ID: <411C65E2.1040703@statistik.uni-dortmund.de>

Walke, Rainer wrote:

> 
>>-----Original Message-----
>>From:	Uwe Ligges [SMTP:ligges@statistik.uni-dortmund.de]
>>Sent:	Thursday, August 12, 2004 5:38 PM
>>To:	Walke, Rainer
>>Cc:	R-devel
>>Subject:	Re: [Rd] (PR#7163) Install packages does not work on Win2003
>>server
>>
>>Walke, Rainer wrote:
>>
>>
>>>	>a) It works for me.
>>>	>b) If it works for you on some Windows versions but not on others,
>>>why 
>>>	>do you think it is a bug in R?
>>>
>>>	It is the first of our application that shows this problem. At least
>>>as far as I know.
>>>	The installation of R works without any problem, only the addition
>>>of further packages does not. What is the difference between both
>>>installation parts? Of course you may ask what is the difference between
>>>Windows NT and Windows XP as client system. And you may ask what is the
>>>difference between a Windows NT and a Windows 2003 file server?
>>>	Is R using a piece of code that Windows XP sends wrong to a Windows
>>>2003 file server?
>>>
>>>	>Quite probably something is not set up correctly either in your 
>>>	>configuration of Windows (permissions, quota, ...) or in the 
>>>	>configuration of R (do you have set another library path to install
>>>to)?
>>>
>>>	>Please tell us the way you tried to install the package.
>>>
>>>	>Uwe Ligges
>>>
>>>	What I did, was "Install packages from local zip files..."
>>>interactivly.
>>>
>>>	Best,
>>>	Rainer Walke
>>
>>
> 	> Is the share form which R has been started mounted on a drive
> letter or 
> 	> do you start via the UNC path?
> 	> Which package is it? Does it also happen for CRAN packages?
> 	> I guess any security setting either on the Server or the client
> are 
> 	> blocking the installation. But it is really hard to guess what it
> really 
> 	> is... You might want to ask your local IT stuff.
> 
> 	> Uwe Ligges
> 
> 	Thanks for your e-mail message. Yes, the share has been mounted on a
> drive letter P.
> 	Unfortunately, it happens for all packages starting from abind...
> 	And it happens if I load a package directly from CRAN as well.
> 	Do you know which part of the R code creates this temporary file*
> directories in the library subdirectory?

Yes, really not hard to find: The second call within function 
unpackPkg() in install.packages().


Uwe Ligges



> 	Rainer Walke
> 
> 
> 
> +++++
> This mail has been sent through the MPI for Demographic Research.  Should you receive a mail that is apparently from a MPI user without this text displayed, then the address has most likely been faked.   If you are uncertain about the validity of this message, please check the mail header or ask your system administrator for assistance.

From ripley at stats.ox.ac.uk  Fri Aug 13 09:02:07 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 13 09:02:09 2004
Subject: [Rd] (PR#7163) Install packages does not work on Win2003 serv er
In-Reply-To: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFD@hermes.demogr.mpg.de>
Message-ID: <Pine.LNX.4.44.0408130743370.18608-100000@gannet.stats>

On Fri, 13 Aug 2004, Walke, Rainer wrote:

> 	Do you know which part of the R code creates this temporary file*
> directories in the library subdirectory?

Why don't *you* know?  It is install.packages, surprisingly enough, in its
internal function unpackPkg, and running that under debug would show you
what is going on.  Once again, remember only you can do this as we cannot 
reproduce your claims.

Do remember you have already been told that you are using an unsupported 
OS, and quite possible a file system that has never been tested and is not 
supported by the compilers we use to build R.

One possible issue is that code uses

                file.rename(file.path(tmpDir, curPkg), instPath)

Internally that boils down to

int Rwin_rename(char *from, char *to)
{
    int res = 0;
    OSVERSIONINFO verinfo;

    verinfo.dwOSVersionInfoSize = sizeof(OSVERSIONINFO);
    GetVersionEx(&verinfo);
    switch(verinfo.dwPlatformId) {
    case VER_PLATFORM_WIN32_NT:
	res = (MoveFileEx(from, to, MOVEFILE_REPLACE_EXISTING) == 0);
	break;
    default:
	if (!DeleteFile(to) && GetLastError() != ERROR_FILE_NOT_FOUND)
	    return 1;
	res = (MoveFile(from, to) == 0);
    }
    return res;
}

Now, what your unsupported OS reports for dwPlatformId is undocumented in 
the MinGW header files (and in the VC6 docs), and your OS did not exist 
when that was written.  Given the choices

#define VER_PLATFORM_WIN32s 0
#define VER_PLATFORM_WIN32_WINDOWS 1
#define VER_PLATFORM_WIN32_NT 2

it is the third according the Microsoft's current Platform SDK, but is 
that correct (it seems to predate the release of your OS)?  Please check 
it for us.

BDR

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Walke at demogr.mpg.de  Fri Aug 13 11:29:25 2004
From: Walke at demogr.mpg.de (Walke, Rainer)
Date: Fri Aug 13 11:29:28 2004
Subject: [Rd] (PR#7163) Install packages does not work on Win2003 serv er
Message-ID: <3699CDBC4ED5D511BE6400306E1C0D81074CBBFF@hermes.demogr.mpg.de>


	>Why don't *you* know?  It is install.packages, surprisingly enough,
in its
	>internal function unpackPkg, and running that under debug would
show you
	>what is going on.  Once again, remember only you can do this as we
cannot 
	>reproduce your claims.

	>Do remember you have already been told that you are using an
unsupported 
	>OS, and quite possible a file system that has never been tested and
is not 
	>supported by the compilers we use to build R.

	>One possible issue is that code uses

>  >               file.rename(file.path(tmpDir, curPkg), instPath)
> 
	>Internally that boils down to

	>int Rwin_rename(char *from, char *to)
	>{
	>    int res = 0;
	>   OSVERSIONINFO verinfo;

	>    verinfo.dwOSVersionInfoSize = sizeof(OSVERSIONINFO);
	>    GetVersionEx(&verinfo);
	>    switch(verinfo.dwPlatformId) {
	>    case VER_PLATFORM_WIN32_NT:
	>	res = (MoveFileEx(from, to, MOVEFILE_REPLACE_EXISTING) ==
0);
	>	break;
	>    default:
	>	if (!DeleteFile(to) && GetLastError() !=
ERROR_FILE_NOT_FOUND)
	>	    return 1;
	>	res = (MoveFile(from, to) == 0);
	>   }
	>    return res;
	>}

	>Now, what your unsupported OS reports for dwPlatformId is
undocumented in 
	>the MinGW header files (and in the VC6 docs), and your OS did not
exist 
	>when that was written.  Given the choices

	>#define VER_PLATFORM_WIN32s 0
	>#define VER_PLATFORM_WIN32_WINDOWS 1
	>#define VER_PLATFORM_WIN32_NT 2

	>it is the third according the Microsoft's current Platform SDK, but
is 
	>that correct (it seems to predate the release of your OS)?  Please
check 
	>it for us.

	>BDR

	
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/bas
e/osversioninfo_str.asp
	says that VER_PLATFORM_WIN32_NT denotes
	WinNT, Win2000, WinXP and Win2003 Server

	dwMinorVersion is different 
	Windows Server 2003	2
	Windows XP			1
	Windows 2000			0
	Windows NT 4.0			0

	dwMajorVersion
	Windows Server 2003	5
	Windows XP			5
	Windows 2000			5
	Windows NT 4.0			4

	Further I checked
	
http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/base
/movefileex.asp
	about the movefileex command:
	Client: Requires Windows XP, Windows 2000 Professional, or Windows
NT Workstation.
	Server: Requires Windows Server 2003, Windows 2000 Server, or
Windows NT Server.
	Unicode: Implemented as Unicode and ANSI versions.
	Header: Declared in Winbase.h; include Windows.h.
	Library: Use Kernel32.lib.
	It seems that MoveFileEx should work without any change on NT, W2000
WinXP and Windows 2003.
      Now I think it is more a Windows than a R problem.
	Rainer Walke



+++++
This mail has been sent through the MPI for Demographic Rese...{{dropped}}

From j.van_den_hoff at fz-rossendorf.de  Fri Aug 13 12:47:27 2004
From: j.van_den_hoff at fz-rossendorf.de (j.van_den_hoff@fz-rossendorf.de)
Date: Fri Aug 13 12:47:29 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7166)
Message-ID: <20040813104727.74041111FE@slim.kubism.ku.dk>

Full_Name: joerg  van den hoff
Version: 1.9.0 and 1.7.1
OS: MacOS (1.9.0), SunOS (1.7.1)
Submission from: (NULL) (149.220.4.88)


something like (sure not the originally intended input, but something like this
can happen...):

approx(c(1,2),c(NA,NA),1.5)

crashes R (bus error under MacOS, segmentation fault under SunOS).


search of the bug archive did not work. I hope this bug was not reported
already


regards

joerg

From ripley at stats.ox.ac.uk  Fri Aug 13 13:05:14 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 13 13:05:23 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7166)
In-Reply-To: <20040813104727.74041111FE@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408131202360.2196-100000@gannet.stats>

Neither version of R is  current.  The NEWS file has

                CHANGES IN R VERSION 1.9.1

   o   approx(list(x=rep(NaN,9), y=1:9), xout=NaN) does not seg.fault
        anymore (PR#6809).

and neither does your example (on a machine in whihc it did under 1.9.0).

On Fri, 13 Aug 2004 j.van_den_hoff@fz-rossendorf.de wrote:

> Full_Name: joerg  van den hoff
> Version: 1.9.0 and 1.7.1
> OS: MacOS (1.9.0), SunOS (1.7.1)
> Submission from: (NULL) (149.220.4.88)
> 
> 
> something like (sure not the originally intended input, but something like this
> can happen...):
> 
> approx(c(1,2),c(NA,NA),1.5)
> 
> crashes R (bus error under MacOS, segmentation fault under SunOS).
> 
> 
> search of the bug archive did not work. I hope this bug was not reported
> already

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Fri Aug 13 13:25:00 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Aug 13 13:29:13 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7166)
In-Reply-To: <20040813104727.74041111FE@slim.kubism.ku.dk>
References: <20040813104727.74041111FE@slim.kubism.ku.dk>
Message-ID: <x2wu032sc3.fsf@biostat.ku.dk>

j.van_den_hoff@fz-rossendorf.de writes:

> Full_Name: joerg  van den hoff
> Version: 1.9.0 and 1.7.1
> OS: MacOS (1.9.0), SunOS (1.7.1)
> Submission from: (NULL) (149.220.4.88)
> 
> 
> something like (sure not the originally intended input, but something like this
> can happen...):
> 
> approx(c(1,2),c(NA,NA),1.5)
> 
> crashes R (bus error under MacOS, segmentation fault under SunOS).
> 
> 
> search of the bug archive did not work. I hope this bug was not reported
> already

You mean like in

                CHANGES IN R VERSION 1.9.1

...

BUG FIXES

...

    o   approx(list(x=rep(NaN,9), y=1:9), xout=NaN) does not seg.fault
        anymore (PR#6809).

?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From thibaut.pillas at fr.thalesgroup.com  Fri Aug 13 15:41:46 2004
From: thibaut.pillas at fr.thalesgroup.com (thibaut.pillas@fr.thalesgroup.com)
Date: Fri Aug 13 15:41:50 2004
Subject: [Rd] RODBC problem (or bug?) (PR#7167)
Message-ID: <20040813134146.524CE111ED@slim.kubism.ku.dk>

 
 
Hello,
 
I have a problem with the package RODBC (version 1.0-4). I am using DB2.
Here is the situation:
 
> version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    9.0            
year     2004           
month    04             
day      12             
language R              
 
odbc connection is OK
Core is the schema of the table "chunk" for DB2
*        Sqlquery select name_variable from core.chunk,...  --> no problem,
R recognize core.chunk 
*        sqlFetch(channel, "CORE.CHUNK") --> Error in
odbcTableExists(channel, sqtable) : 
        CORE.CHUNK : table not found on channel
*        Sqlfetch(channel, "chunk") --> [1] "[RODBC] ERROR: Could not
SQLExecute"

[2] "S0002 -204 [IBM][CLI Driver][DB2/NT] SQL0204N The name
\"KWADMIN.CHUNK\" is not defined.  SQLSTATE=42704\r\n"
 
It's not kwadmin.chunk but core.chunk (kwadmin is the userId)
Why does it search kwadmin.chunk?
The table's name for sqlquery is core.chunk and for sqlfetch is chunk. Is it
normal? 
Is there any solution with R or is it a problem with DB2?
 
Thank you very much for your answer
Yours sincerely
 
Thibaut Pillas
 

	[[alternative HTML version deleted]]

From J5QBAM at aol.com  Fri Aug 13 17:10:10 2004
From: J5QBAM at aol.com (J5QBAM@aol.com)
Date: Fri Aug 13 17:12:38 2004
Subject: [Rd] (no subject) CM7O58
Message-ID: <200408131510.i7DFAAK07552@ww2.sfgov.org>

Below is the result of your feedback form.  It was submitted by
 (J5QBAM@aol.com) on Friday, August 13, 2004 at 08:10:10
---------------------------------------------------------------------------

: Historykill lets you remove all unwanted material from your computer. Its free and you can download it at http://ezkill.tk KVNU6U<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>G03LS1

From murdoch at stats.uwo.ca  Fri Aug 13 21:37:28 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Aug 13 21:37:37 2004
Subject: [Rd] Bug or feature in winMenuDel?
Message-ID: <po5qh0tcc28i1lnc8iidmr58dmniged010@4ax.com>

I just noticed the following in Rgui:

> winMenuAdd('test')       # adds a menu
> winMenuAddItem('test', 'item', 'x')  # adds an item to it
> winMenuDel('test')        # deletes the menu...
> winMenuItems('test')        # but leaves the item behind.
item 
 "x" 

Would anyone object if I changed winMenuDel so that it deleted the
menu and any items or submenus in it as well?  

Duncan Murdoch

From pedro at est.ufpr.br  Fri Aug 13 21:49:08 2004
From: pedro at est.ufpr.br (Pedro Ribeiro de Andrade Neto)
Date: Fri Aug 13 21:46:28 2004
Subject: [Rd] redrawing in embedded R
Message-ID: <Pine.LNX.4.58L0.0408131645120.23473@est.ufpr.br>

Hi,

I'm embedding R in an application under Debian Linux. I need
to plot some graphicals using R, but they don't redraw. My
program uses qt graphical library.

I read in "Embedding R in Other Applications" that "... R should
be able to export the file descriptors on witch it is waiting
for events and also the callbacks...," but this document don't
tell how to export it.

I have to control the R event loop in my program or is there an
R function that I can call to do this? Is there any documentation
about it?

Best regards,

Pedro Andrade

From leroy at ucsd.edu  Sat Aug 14 01:43:28 2004
From: leroy at ucsd.edu (leroy@ucsd.edu)
Date: Sat Aug 14 01:43:31 2004
Subject: [Rd] re: R-1.9.1 preferences (PR#7170)
Message-ID: <20040813234328.3407F10EB9@slim.kubism.ku.dk>

okay, so checking the "override" box at the bottom of the menu allows 
the changes to take effect.

I still don't understand why you need to have the "override" box there 
in the first place

T

Begin forwarded message:

> From: Anthony Westerling <leroy@ucsd.edu>
> Date: Fri Aug 13, 2004  4:41:01  PM US/Pacific
> To: r-bugs@r-project.org
> Subject: R-1.9.1 preferences
>
>  R-1.9.1 on a PowerPC G4 with Mac OS X 10.2.8
>
> R:Preferences:Quartz Device:Quarz Window position is set to "center"
>
> I hit "apply"
>
> new quartz windows still appear in the upper right hand corner of the 
> screen
>
> if I reopen preferences and check the quartz device, it is still set 
> to "center"
>
> ditto if I close and restart R
>
> preferences cannot seem to set the quartz window to open anywhere but 
> the default position
>
> Thanks
>
> Tony Westerling
>

From jago at mclink.it  Sat Aug 14 01:59:16 2004
From: jago at mclink.it (stefano iacus)
Date: Sat Aug 14 01:59:39 2004
Subject: [Rd] re: R-1.9.1 preferences (PR#7170)
In-Reply-To: <20040813234328.3407F10EB9@slim.kubism.ku.dk>
References: <20040813234328.3407F10EB9@slim.kubism.ku.dk>
Message-ID: <C887B550-ED84-11D8-A176-000A95C87F66@mclink.it>


On Aug 14, 2004, at 1:43 AM, leroy@ucsd.edu wrote:

> okay, so checking the "override" box at the bottom of the menu allows
> the changes to take effect.
>
> I still don't understand why you need to have the "override" box there
> in the first place

if, in  the R Console, you specify arguments in quartz() than the 
behaviour is the following: if you didn't check the "override" box, 
specified arguments are used, otherwise (the box is checked) the 
arguments you pass in quartz() are ignored and preferences parameters 
are used instead.
We needed a criteria to let R understand what to do with two different 
specifications of input arguments.


stefano

>
> T
>
> Begin forwarded message:
>
>> From: Anthony Westerling <leroy@ucsd.edu>
>> Date: Fri Aug 13, 2004  4:41:01  PM US/Pacific
>> To: r-bugs@r-project.org
>> Subject: R-1.9.1 preferences
>>
>>  R-1.9.1 on a PowerPC G4 with Mac OS X 10.2.8
>>
>> R:Preferences:Quartz Device:Quarz Window position is set to "center"
>>
>> I hit "apply"
>>
>> new quartz windows still appear in the upper right hand corner of the
>> screen
>>
>> if I reopen preferences and check the quartz device, it is still set
>> to "center"
>>
>> ditto if I close and restart R
>>
>> preferences cannot seem to set the quartz window to open anywhere but
>> the default position
>>
>> Thanks
>>
>> Tony Westerling
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From jago at mclink.it  Sat Aug 14 02:01:06 2004
From: jago at mclink.it (stefano iacus)
Date: Sat Aug 14 02:01:16 2004
Subject: [Rd] re: R-1.9.1 preferences (PR#7170)
In-Reply-To: <20040813234328.3407F10EB9@slim.kubism.ku.dk>
References: <20040813234328.3407F10EB9@slim.kubism.ku.dk>
Message-ID: <0A7DF95F-ED85-11D8-A176-000A95C87F66@mclink.it>

BTW, this is not a bug and it's documented even in the tooltip of the 
"override" box in the preferences.

stefano

On Aug 14, 2004, at 1:43 AM, leroy@ucsd.edu wrote:

> okay, so checking the "override" box at the bottom of the menu allows
> the changes to take effect.
>
> I still don't understand why you need to have the "override" box there
> in the first place
>
> T
>
> Begin forwarded message:
>
>> From: Anthony Westerling <leroy@ucsd.edu>
>> Date: Fri Aug 13, 2004  4:41:01  PM US/Pacific
>> To: r-bugs@r-project.org
>> Subject: R-1.9.1 preferences
>>
>>  R-1.9.1 on a PowerPC G4 with Mac OS X 10.2.8
>>
>> R:Preferences:Quartz Device:Quarz Window position is set to "center"
>>
>> I hit "apply"
>>
>> new quartz windows still appear in the upper right hand corner of the
>> screen
>>
>> if I reopen preferences and check the quartz device, it is still set
>> to "center"
>>
>> ditto if I close and restart R
>>
>> preferences cannot seem to set the quartz window to open anywhere but
>> the default position
>>
>> Thanks
>>
>> Tony Westerling
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From jpalmucci at machineinsight.com  Sat Aug 14 06:27:26 2004
From: jpalmucci at machineinsight.com (jpalmucci@machineinsight.com)
Date: Sat Aug 14 06:27:30 2004
Subject: [Rd] write.table doesn't quote column names properly (PR#7171)
Message-ID: <20040814042726.9DFBF10EB9@slim.kubism.ku.dk>

Full_Name: Jeff Palmucci
Version: trunk
OS: Windows
Submission from: (NULL) (207.180.176.235)


write.table doesn't quote the column names using qmethod.

Here is the diff of the fix with revision 30658

svn diff write.table.R
Index: write.table.R
===================================================================
--- write.table.R	(revision 30658)
+++ write.table.R	(working copy)
@@ -76,21 +76,23 @@
         stop(paste("argument", sQuote("file"),
                    "must be a character string or connection"))
 
+        
+    qstring <-                          # quoted embedded quote string
+        switch(qmethod,
+               "escape" = '\\\\"',
+               "double" = '""')
+
     if(!is.null(col.names)) {
 	if(append)
 	    warning("appending column names to file")
 	if(!is.null(quote))
-	    col.names <- paste("\"", col.names, "\"", sep = "")
+	    col.names <- paste("\"", gsub('"', qstring, col.names), "\"", sep = "")
         writeLines(paste(col.names, collapse = sep), file, sep = eol)
     }
 
     if (NROW(x) == 0)
         return(invisible(x))
-    
-    qstring <-                          # quoted embedded quote string
-        switch(qmethod,
-               "escape" = '\\\\"',
-               "double" = '""')
+
     for(i in quote)
 	x[, i] <- paste('"', gsub('"', qstring, as.character(x[, i])),
                         '"', sep = "")

From j.van_den_hoff at fz-rossendorf.de  Mon Aug 16 11:36:49 2004
From: j.van_den_hoff at fz-rossendorf.de (j.van_den_hoff@fz-rossendorf.de)
Date: Mon Aug 16 11:36:50 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7177)
Message-ID: <20040816093649.075AB10EA6@slim.kubism.ku.dk>

Full_Name: joerg  van den hoff
Version: 1.9.1
OS: MacOS  and SunOS 
Submission from: (NULL) (149.220.4.88)


follow up to ID 7166. something like

approx(c(1,2),c(NA,NA),1.5,rule=2)

crashes 1.9.1 on both systems (MacOS 10.3.5.: bus error,  SunOS 5.9:
segmentation fault) even if xout is within given x range (as in example above)
where rule=2 seems not be relevant anyway.

From p.dalgaard at biostat.ku.dk  Mon Aug 16 12:01:20 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Aug 16 12:05:39 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7177)
In-Reply-To: <20040816093649.075AB10EA6@slim.kubism.ku.dk>
References: <20040816093649.075AB10EA6@slim.kubism.ku.dk>
Message-ID: <x28ycfh05r.fsf@biostat.ku.dk>

j.van_den_hoff@fz-rossendorf.de writes:

> follow up to ID 7166. something like
> 
> approx(c(1,2),c(NA,NA),1.5,rule=2)
> 
> crashes 1.9.1 on both systems (MacOS 10.3.5.: bus error,  SunOS 5.9:
> segmentation fault) even if xout is within given x range (as in example above)
> where rule=2 seems not be relevant anyway.

Yes, this is a silly bug in the R driver routine:


    if (nx < 2 && method == "linear")
        stop("approx requires at least two values to interpolate")
    if (any(na <- is.na(x) | is.na(y))) {
        ok <- !na
        x <- x[ok]
        y <- y[ok]
        nx <- length(x)
    }

You want to do the check after removing NAs! 

Also, we should probably have a check for (nx == 0 && method != "linear")

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From jjanmaat at acadiau.ca  Mon Aug 16 12:05:53 2004
From: jjanmaat at acadiau.ca (jjanmaat@acadiau.ca)
Date: Mon Aug 16 12:05:56 2004
Subject: [Rd] contour method="edge" when vertical. (PR#7178)
Message-ID: <20040816100553.C34D510940@slim.kubism.ku.dk>

Full_Name: John Janmaat
Version: 9.0
OS: SuSE Linux 9.0
Submission from: (NULL) (137.224.252.10)


When plotting a contour map, with multiple maps on a page, and overlaying
contour plots, and sending output to a postscript file, plotting will halt with
'method="edge"' for contours that appear to be nearly vertical.  Unfortunately I
cannot reproduce the problem using a simple code snippet, but will send code and
datafile that are creating problem to anyone interested.

John.

From Walke at demogr.mpg.de  Mon Aug 16 13:41:48 2004
From: Walke at demogr.mpg.de (Walke, Rainer)
Date: Mon Aug 16 13:41:57 2004
Subject: [Rd] (PR#7163) Install packages does not work on Win2003 serv er
Message-ID: <3699CDBC4ED5D511BE6400306E1C0D81074CBC05@hermes.demogr.mpg.de>

Applying SP2 for Windows XP solves this problem.

I do not know the reason for the behaviour. But it could be something like
described in MS knowledge base article 839027 (byte range locking).

Thanks,
Rainer Walke






+++++
This mail has been sent through the MPI for Demographic Rese...{{dropped}}

From maechler at stat.math.ethz.ch  Mon Aug 16 14:19:16 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon Aug 16 14:19:24 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7177)
Message-ID: <20040816121916.D7EB610EA8@slim.kubism.ku.dk>

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 16 Aug 2004 12:01:20 +0200 writes:

    PD> j.van_den_hoff@fz-rossendorf.de writes:
    >> follow up to ID 7166. something like
    >> 
    >> approx(c(1,2),c(NA,NA),1.5,rule=2)
    >> 
    >> crashes 1.9.1 on both systems (MacOS 10.3.5.: bus error,  SunOS 5.9:
    >> segmentation fault) even if xout is within given x range (as in example above)
    >> where rule=2 seems not be relevant anyway.

    PD> Yes, this is a silly bug in the R driver routine:


    PD> if (nx < 2 && method == "linear")
    PD> stop("approx requires at least two values to interpolate")
    PD> if (any(na <- is.na(x) | is.na(y))) {
    PD> ok <- !na
    PD> x <- x[ok]
    PD> y <- y[ok]
    PD> nx <- length(x)
    PD> }

    PD> You want to do the check after removing NAs! 

    PD> Also, we should probably have a check for (nx == 0 && method != "linear")
yes (2 times)  *and*  'method' is not a string anymore at that
moment because it has been pmatch()ed.

I'm going to match.arg() it instead.
And I see there's more cleanup possible, since,
xy.coords() already makes sure to return 2 equal length numeric
components.

When I do this now, it breaks back compatibility since things
like (PR#6809)
	approx(list(x=rep(NaN, 9), y=1:9), xout=NaN)
would give an error instead of (NaN, NaN).

OTOH, the stop("....") message you cite above was obviously
*intended* to be triggered for such a case.
I presume we rather intend to be back compatible?

Martin

From wolski at molgen.mpg.de  Mon Aug 16 15:54:11 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Mon Aug 16 15:54:15 2004
Subject: [Rd] promptClass("numeric")
Message-ID: <200408161554110262.49B4F510@mail.math.fu-berlin.de>

Hi!

Have written some functions with signature "numeric".

eg.
setGeneric("foo",
 function(object,...)
               standardGeneric("foo"))
setMethod("foo",signature(object="numeric"),def = ....

To generate the Rd file sceleton i use 

> promtClass("numeric")
A shell of class documentation has been written to the
file 'numeric-class.Rd'.


but the file does contains just.

\section{Methods}{
  \describe{
    \item{coerce}{\code{signature(from = "ANY", to = "numeric")}: ... }
  }
}

Were is my method "foo"?

In case of classes defined using setClass all works.

Its not a real Problem ( I can add the method definition by hand to the Rd file) it seems just a little inconsistent to mee.


Windows2000
R1.9.1

Eryk.

From deepayan at stat.wisc.edu  Mon Aug 16 16:27:47 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Mon Aug 16 16:28:01 2004
Subject: [Rd] promptClass("numeric")
In-Reply-To: <200408161554110262.49B4F510@mail.math.fu-berlin.de>
References: <200408161554110262.49B4F510@mail.math.fu-berlin.de>
Message-ID: <200408160927.47055.deepayan@stat.wisc.edu>

On Monday 16 August 2004 08:54, Wolski wrote:
> Hi!
>
> Have written some functions with signature "numeric".
>
> eg.
> setGeneric("foo",
>  function(object,...)
>                standardGeneric("foo"))
> setMethod("foo",signature(object="numeric"),def = ....
>
> To generate the Rd file sceleton i use
>
> > promtClass("numeric")
>
> A shell of class documentation has been written to the
> file 'numeric-class.Rd'.
>
>
> but the file does contains just.
>
> \section{Methods}{
>   \describe{
>     \item{coerce}{\code{signature(from = "ANY", to = "numeric")}: ...
> } }
> }
>
> Were is my method "foo"?

Why do you expect it to be there? If you want documentation for method 
definitions of foo, use promptMethods("foo"); this is indicated 
in ?promptClass:

See Also:

     'prompt' for documentation of functions, 'promptMethods' for
     documentation of method definitions.

Hth,

Deepayan

From wolski at molgen.mpg.de  Mon Aug 16 16:43:56 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Mon Aug 16 16:44:04 2004
Subject: [Rd] promptClass("numeric")
In-Reply-To: <200408160927.47055.deepayan@stat.wisc.edu>
References: <200408161554110262.49B4F510@mail.math.fu-berlin.de>
	<200408160927.47055.deepayan@stat.wisc.edu>
Message-ID: <200408161643560629.01928335@mail.math.fu-berlin.de>

Hi!

As I said its not really a Problem. Its just an inconsistency which need is not apparent to me.

You can alternatively use promptClass or promptMethods to document methods.
promptClass always generates a section:

>>>>\section{Methods}{
>>>>   \describe{
>>>>     \item{coerce}{\code{signature(from = "ANY", to = "numeric")}: ...
>>>> } }
>>>> }

So you can use promptClass to provide a short description to your methods.

I would use promptMethods if the methods are elaborated (like a the plotting methods in package lattice) and I would like to to provide intensive and extensive explanation with examples.

But in case if my method "foo" which is so simple (it just prints "foo") I would like to use promptClass.


Yours

Eryk.


*********** REPLY SEPARATOR  ***********

On 8/16/2004 at 9:27 AM Deepayan Sarkar wrote:

>>>On Monday 16 August 2004 08:54, Wolski wrote:
>>>> Hi!
>>>>
>>>> Have written some functions with signature "numeric".
>>>>
>>>> eg.
>>>> setGeneric("foo",
>>>>  function(object,...)
>>>>                standardGeneric("foo"))
>>>> setMethod("foo",signature(object="numeric"),def = ....
>>>>
>>>> To generate the Rd file sceleton i use
>>>>
>>>> > promtClass("numeric")
>>>>
>>>> A shell of class documentation has been written to the
>>>> file 'numeric-class.Rd'.
>>>>
>>>>
>>>> but the file does contains just.
>>>>
>>>> \section{Methods}{
>>>>   \describe{
>>>>     \item{coerce}{\code{signature(from = "ANY", to = "numeric")}: ...
>>>> } }
>>>> }
>>>>
>>>> Were is my method "foo"?
>>>
>>>Why do you expect it to be there? If you want documentation for method 
>>>definitions of foo, use promptMethods("foo"); this is indicated 
>>>in ?promptClass:
>>>
>>>See Also:
>>>
>>>     'prompt' for documentation of functions, 'promptMethods' for
>>>     documentation of method definitions.
>>>
>>>Hth,
>>>
>>>Deepayan



Dipl. bio-chem. Eryk Witold Wolski    @    MPI-Moleculare Genetic   
Ihnestrasse 63-73 14195 Berlin       'v'    
tel: 0049-30-83875219               /   \    
mail: wolski@molgen.mpg.de        ---W-W----    http://www.molgen.mpg.de/~wolski

From maechler at stat.math.ethz.ch  Mon Aug 16 16:53:54 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon Aug 16 16:53:56 2004
Subject: [Rd] bus error /segmentation fault from 'approx' (PR#7177)
Message-ID: <20040816145354.871D41093C@slim.kubism.ku.dk>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch>
>>>>>     on Mon, 16 Aug 2004 14:19:16 +0200 (CEST) writes:

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 16 Aug 2004 12:01:20 +0200 writes:

    PD> j.van_den_hoff@fz-rossendorf.de writes:
    >>> follow up to ID 7166. something like
    >>> 
    >>> approx(c(1,2),c(NA,NA),1.5,rule=2)
    >>> 
    >>> crashes 1.9.1 on both systems (MacOS 10.3.5.: bus error,
    >>> SunOS 5.9: segmentation fault) even if xout is within
    >>> given x range (as in example above) where rule=2 seems
    >>> not be relevant anyway.

      PD> Yes, this is a silly bug in the R driver routine:

      PD> if (nx < 2 && method == "linear")
      PD>    stop("approx requires at least two values to interpolate")
      PD> if (any(na <- is.na(x) | is.na(y))) {
      PD>    ok <- !na
      PD>    x <- x[ok]
      PD>    y <- y[ok]
      PD>    nx <- length(x)
      PD> }

      PD> You want to do the check after removing NAs! 

      PD> Also, we should probably have a check for (nx == 0 && method != "linear")
    MM> yes (2 times)  *and*  'method' is not a string anymore at that
    MM> moment because it has been pmatch()ed.

    MM> I'm going to match.arg() it instead.

(no, I didn't. It's not worth it, since the C code needs the
 integer version anyway.)

    MM> And I see there's more cleanup possible, since,
    MM> xy.coords() already makes sure to return 2 equal length numeric
    MM> components.

    MM> When I do this now, it breaks back compatibility since things
    MM> like (PR#6809)
    MM> approx(list(x=rep(NaN, 9), y=1:9), xout=NaN)
    MM> would give an error instead of (NaN, NaN).

    MM> OTOH, the stop("....") message you cite above was obviously
    MM> *intended* to be triggered for such a case.
    MM> I presume we rather intend to be back compatible?

I'm not so sure anymore:  For approxfun() {which must return a
function() in non-error cases} this would need extra code, just
for a somewhat non-sensical case.
And then, approx() should stay entirely "parallel" to approxfun().

S-plus also simply gives an error in these cases  {but AFAIR, R's
approx has tried to be better here...}

So, I propose to change behavior for all these cases and
produce an error,  for approx() from the following code part :

    if (nx <= 1) {
	if(method == 1)# linear
	    stop("need at least two non-NA values to interpolate")
	if(nx == 0) stop("zero non-NA points")
    }

Martin

From hoefler at mpipsykl.mpg.de  Mon Aug 16 17:15:20 2004
From: hoefler at mpipsykl.mpg.de (hoefler@mpipsykl.mpg.de)
Date: Mon Aug 16 17:15:27 2004
Subject: [Rd] weighted data (PR#7181)
Message-ID: <20040816151520.6AE0E10936@slim.kubism.ku.dk>




dear ladies and gentlemen,

i am currently working on the revised version of a paper entitled
"on the use of statistical weights to account for non-participation".

a reviewer suggested to provide a section on statistical
procedures that handle weighted data adequatly.
unfortunately, i did not find the information in the internet which
R procedures there are that handle weighted data with valid
confidence intervals, e.g. via the sandwich estimator.

which procedures allow to specify a weight variable?

can bootstrapping and the jackknife resampling be combined with
regression procedures that allow to specify a weight?

thanks a lot in advance,

kind regards,
michael hoefler

From murdoch at stats.uwo.ca  Mon Aug 16 17:30:50 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon Aug 16 17:30:49 2004
Subject: [Rd] Bug or feature in winMenuDel?
In-Reply-To: <po5qh0tcc28i1lnc8iidmr58dmniged010@4ax.com>
References: <po5qh0tcc28i1lnc8iidmr58dmniged010@4ax.com>
Message-ID: <nnk1i0pj7np6n7ccp3v9qla8mnvsbsonkm@4ax.com>

On Fri, 13 Aug 2004 15:37:28 -0400, Duncan Murdoch
<murdoch@stats.uwo.ca> wrote :

>I just noticed the following in Rgui:
>
>> winMenuAdd('test')       # adds a menu
>> winMenuAddItem('test', 'item', 'x')  # adds an item to it
>> winMenuDel('test')        # deletes the menu...
>> winMenuItems('test')        # but leaves the item behind.
>item 
> "x" 
>
>Would anyone object if I changed winMenuDel so that it deleted the
>menu and any items or submenus in it as well?  

I made this change in r-devel, along with some other ones that allow
items to be added to the popups and the graph window menus as well as
the standard ones.

Duncan Murdoch

From deepayan at stat.wisc.edu  Mon Aug 16 17:33:38 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Mon Aug 16 17:33:50 2004
Subject: [Rd] promptClass("numeric")
In-Reply-To: <200408161643560629.01928335@mail.math.fu-berlin.de>
References: <200408161554110262.49B4F510@mail.math.fu-berlin.de>
	<200408160927.47055.deepayan@stat.wisc.edu>
	<200408161643560629.01928335@mail.math.fu-berlin.de>
Message-ID: <200408161033.38255.deepayan@stat.wisc.edu>

On Monday 16 August 2004 09:43, Wolski wrote:
> Hi!
>
> As I said its not really a Problem. Its just an inconsistency which
> need is not apparent to me.
>
> You can alternatively use promptClass or promptMethods to document
> methods.
>
> promptClass always generates a section:
> >>>>\section{Methods}{
> >>>>   \describe{
> >>>>     \item{coerce}{\code{signature(from = "ANY", to =
> >>>> "numeric")}: ... } }
> >>>> }
>
> So you can use promptClass to provide a short description to your
> methods.
>
> I would use promptMethods if the methods are elaborated (like a the
> plotting methods in package lattice) and I would like to to provide
> intensive and extensive explanation with examples.
>
> But in case if my method "foo" which is so simple (it just prints
> "foo") I would like to use promptClass.

Yes, I should have RTFM before replying. On closer inspection, this 
seems to be a feature (?) of the "numeric" class (and perhaps other 
primitive classes). It works as you expect for a freshly defined formal 
class.

Deepayan

From ripley at stats.ox.ac.uk  Tue Aug 17 08:56:26 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 17 08:56:29 2004
Subject: [Rd] Meta information in packages in pre-2.0.0
Message-ID: <Pine.LNX.4.44.0408170747090.9322-100000@gannet.stats>

We are intending to include a lot more pre-computed information with an
installed package in 2.0.0, and to force all packages to be reinstalled
under 2.0.0.

This causes a problem with R-devel pre-2.0.0, which stamps packages as
having been installed under the future 2.0.0.  As of today we have changed
the format of the meta-information file 'Meta/package.rds', and you should
either reinstall packages under R-devel (a good idea if they were not
installed in August) or run

tools:::.update_package_rds()

(it has a lib.loc argument, so can be run a library at a time).  Even the 
standard and recommended packages need to be updated unless you are 
building from scratch.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Tue Aug 17 09:25:46 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue Aug 17 09:25:48 2004
Subject: [Rd] weighted data (PR#7181)
Message-ID: <20040817072546.2C9BD1093C@slim.kubism.ku.dk>

>>>>> "hoefler" == hoefler  <hoefler@mpipsykl.mpg.de>
>>>>>     on Mon, 16 Aug 2004 17:15:20 +0200 (CEST) writes:

    hoefler> dear ladies and gentlemen,

    hoefler> i am currently working on the revised version of a paper entitled
    hoefler> "on the use of statistical weights to account for non-participation".
    ........

this is not at all a bug report!!
By this action of misuse, you produce unnecessary work load for
R-core members (maintaining the R-bugs repository). 

Reason for some of us to not even considering to answer your
questions...  

**PLEASE** do read http://www.R-project.org/mail.html  
carefully including its link, "the posting guide" !

Martin Maechler

From hkawakat at qub.ac.uk  Tue Aug 17 11:37:09 2004
From: hkawakat at qub.ac.uk (Hiroyuki Kawakatsu)
Date: Tue Aug 17 11:37:17 2004
Subject: [Rd] suggestion for ARMAacf()
Message-ID: <Pine.CYG.4.58.0408171012260.988@erdos>

hi,

in 1.9.1, the return value from ARMAacf(pacf=TRUE) is not named by lags,
contrary to ?ARMAacf. the simple fix is to move names(Acf) <-
down after if(pacf), with an appropriate starting lag as pacf=TRUE appears
to start at lag 1 (whereas pacf=FALSE starts at lag 0).

for consistency, one could argue to append 1 for lag 0 for pacf=TRUE
(or start pacf=F at lag 1). however, given the inconsistency for the
sample counterparts acf() and pacf(), i am not too bothered with this
behavior as long as the lags are named for both pacf=T and pacf=F.

h.
----------------------------------
Hiroyuki Kawakatsu
School of Management and Economics
25 University Square
Queen's University, Belfast
Belfast BT7 1NN
Northern Ireland
United Kingdom
Tel +44 (0)28 9097 3290
Fax +44 (0)28 9033 5156

From wettenhall at wehi.edu.au  Tue Aug 17 12:09:08 2004
From: wettenhall at wehi.edu.au (James Wettenhall)
Date: Tue Aug 17 12:09:13 2004
Subject: [Rd] checkS3methods() change
Message-ID: <Pine.GSO.4.58.0408171959570.20582@unix33.alpha.wehi.edu.au>

Hi,

I'm using rw2000dev.exe (Win32) built on August 14.

If this isn't already planned, can I suggest that when
checkS3methods() (called by R CMD check) fails because of
a syntax error in a dependent package listed in the DESCRIPTION
file of the main package being checked, it would be nice if
checkS3methods() reported which dependent package caused it to
fail?

Running R CMD check on my package limmaGUI, revealed a syntax
error in one of limmaGUI's dependent packages, which turned out
to be the R2HTML package (after a bit of sleuthing).

Here's the syntax error in R2HTML, caused by the new parsing
rules for associative use of relational operators:

  x0 <- xm[okP] == 0 != (as.numeric(Cf[okP]) == 0)

The R2HTML package (version 1.3) was installed with:
> install.packages("R2HTML")
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'

Here's the tail of the R CMD check output for limmaGUI:

* checking R files for syntax errors ... OK
* checking R files for library.dynam ... OK
* checking S3 generic/method consistency ... WARNING
Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
Execution halted
See section 'Generic functions and methods' of the 'Writing R Extensions' manual.
* checking replacement functions ... WARNING
Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
Execution halted
In R, the argument of a replacement function which corresponds
to the right hand side must be named 'value'.
* checking foreign function calls ... WARNING
Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
Execution halted
See section 'System and foreign language interfaces' of the
'Writing R Extensions' manual.
* checking Rd files ... OK
* checking for missing documentation entries ... ERROR
Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446

Regards,
James

From Kurt.Hornik at wu-wien.ac.at  Tue Aug 17 12:21:05 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Tue Aug 17 12:21:00 2004
Subject: [Rd] checkS3methods() change
In-Reply-To: <Pine.GSO.4.58.0408171959570.20582@unix33.alpha.wehi.edu.au>
References: <Pine.GSO.4.58.0408171959570.20582@unix33.alpha.wehi.edu.au>
Message-ID: <16673.56337.900481.260563@mithrandir.hornik.net>

>>>>> James Wettenhall writes:

> Hi,
> I'm using rw2000dev.exe (Win32) built on August 14.

> If this isn't already planned, can I suggest that when
> checkS3methods() (called by R CMD check) fails because of
> a syntax error in a dependent package listed in the DESCRIPTION
> file of the main package being checked, it would be nice if
> checkS3methods() reported which dependent package caused it to
> fail?

> Running R CMD check on my package limmaGUI, revealed a syntax
> error in one of limmaGUI's dependent packages, which turned out
> to be the R2HTML package (after a bit of sleuthing).

> Here's the syntax error in R2HTML, caused by the new parsing
> rules for associative use of relational operators:

>   x0 <- xm[okP] == 0 != (as.numeric(Cf[okP]) == 0)

> The R2HTML package (version 1.3) was installed with:
>> install.packages("R2HTML")
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'

> Here's the tail of the R CMD check output for limmaGUI:

> * checking R files for syntax errors ... OK
> * checking R files for library.dynam ... OK
> * checking S3 generic/method consistency ... WARNING
> Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
> Execution halted
> See section 'Generic functions and methods' of the 'Writing R Extensions' manual.
> * checking replacement functions ... WARNING
> Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
> Execution halted
> In R, the argument of a replacement function which corresponds
> to the right hand side must be named 'value'.
> * checking foreign function calls ... WARNING
> Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
> Execution halted
> See section 'System and foreign language interfaces' of the
> 'Writing R Extensions' manual.
> * checking Rd files ... OK
> * checking for missing documentation entries ... ERROR
> Error in .try_quietly({ : Error in parse(file, n, text, prompt) :
> * syntax error on line 446

I am trying to find a general way of printing a suitable traceback
alongside .try_quietly() errors.  Turns out to be sort of tricky,
unfortunately ...

-k

From ripley at stats.ox.ac.uk  Tue Aug 17 12:31:16 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 17 12:31:22 2004
Subject: [Rd] suggestion for ARMAacf()
In-Reply-To: <Pine.CYG.4.58.0408171012260.988@erdos>
Message-ID: <Pine.LNX.4.44.0408171128590.13296-100000@gannet.stats>

Please supply a patch (diff -c or diff -u) against the current R-devel
sources, so there is no ambiguity as to what you are suggesting, together 
with examples and the intended output.

Verbal descriptions like this are not precise enough to be cross-checked.

On Tue, 17 Aug 2004, Hiroyuki Kawakatsu wrote:

> in 1.9.1, the return value from ARMAacf(pacf=TRUE) is not named by lags,
> contrary to ?ARMAacf. the simple fix is to move names(Acf) <-
> down after if(pacf), with an appropriate starting lag as pacf=TRUE appears
> to start at lag 1 (whereas pacf=FALSE starts at lag 0).
> 
> for consistency, one could argue to append 1 for lag 0 for pacf=TRUE
> (or start pacf=F at lag 1). however, given the inconsistency for the
> sample counterparts acf() and pacf(), i am not too bothered with this
> behavior as long as the lags are named for both pacf=T and pacf=F.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Aug 17 13:33:11 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 17 13:33:14 2004
Subject: [Rd] The Depends: field of a package is now used by library()
In-Reply-To: <200408121124.00119.deepayan@stat.wisc.edu>
Message-ID: <Pine.LNX.4.44.0408171230150.18876-100000@gannet.stats>

To close off this thread --

After various offline discussions we have adopted the new field Imports: 
(thanks, Martin Maechler, for the name) which should list namespaces that 
are required to load the package (via imports in the NAMESPACE file or use 
of :: or :::) but do not need to be attached as packages.

Depends: should be used for packages that need to be attached before the 
current package, and should be disjoint from Imports.


On Thu, 12 Aug 2004, Deepayan Sarkar wrote:

> On Thursday 12 August 2004 10:55, Prof Brian Ripley wrote:
> 
> > I can't think of any other example of one package only needing the
> > namespace of another (contributed) package.
> 
> That's probably because few packages have namespaces yet. Another 
> example is nlme which imports lattice, but that's still within 
> recommended packages. In the long run, hopefully more packages will 
> start using namespaces when appropriate, so this might become more 
> relevant.
> 
> The only issue I see here is a way to mention namespace requirements in 
> DESCRIPTION (which could have been done with Depends thus far because 
> it didn't actually do anything else, even though though the intent has 
> always been there).
> 
> Imported packages are still dependencies in the sense that a package has 
> to be available for it's namespace to be usable, so leaving them out of 
> Depends: feels slightly weird, but I can live with it.
> 
> Deepayan
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ramasamy at cancer.org.uk  Tue Aug 17 19:55:58 2004
From: ramasamy at cancer.org.uk (Adaikalavan Ramasamy)
Date: Tue Aug 17 19:56:03 2004
Subject: [Rd] subset and missing value indexing
Message-ID: <1092765358.4861.37.camel@vpn202001.lif.icnet.uk>

Out of curiosity, is this a bug or a feature or "==" ?

m <- matrix( 1:12, nc=4 )
f <- c("A", NA, "B", "A")

f == "A"
[1]  TRUE    NA FALSE  TRUE

m[ , f == "A"]         # equivalent to m[ , c(1, NA, 4) ]
     [,1] [,2] [,3]
[1,]    1   NA   10
[2,]    2   NA   11
[3,]    3   NA   12

m[ , which(f == "A")]
     [,1] [,2]
[1,]    1   10
[2,]    2   11
[3,]    3   12


In arguments section of help("which") it says that 
   'NA's are allowed and omitted (treated as if 'FALSE').

After some thinking, I think this might be due to subsetting using index
that includes missing value. help("[") appears not to say what happens
when one of the indexing element is a missing value, only that the index
can be logical ( and NA is logical ).

Is there any reason for allowing NA when subsetting ?

Regards, Adai

From ripley at stats.ox.ac.uk  Tue Aug 17 20:13:59 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 17 20:14:08 2004
Subject: [Rd] subset and missing value indexing
In-Reply-To: <1092765358.4861.37.camel@vpn202001.lif.icnet.uk>
Message-ID: <Pine.LNX.4.44.0408171902080.18915-100000@gannet.stats>

On Tue, 17 Aug 2004, Adaikalavan Ramasamy wrote:

> Out of curiosity, is this a bug or a feature or "==" ?

A documented feature.
 
> m <- matrix( 1:12, nc=4 )
> f <- c("A", NA, "B", "A")
> 
> f == "A"
> [1]  TRUE    NA FALSE  TRUE
> 
> m[ , f == "A"]         # equivalent to m[ , c(1, NA, 4) ]
>      [,1] [,2] [,3]
> [1,]    1   NA   10
> [2,]    2   NA   11
> [3,]    3   NA   12
> 
> m[ , which(f == "A")]
>      [,1] [,2]
> [1,]    1   10
> [2,]    2   11
> [3,]    3   12
> 
> 
> In arguments section of help("which") it says that 
>    'NA's are allowed and omitted (treated as if 'FALSE').
> 
> After some thinking, I think this might be due to subsetting using index
> that includes missing value. help("[") appears not to say what happens
> when one of the indexing element is a missing value, only that the index
> can be logical ( and NA is logical ).
>
> Is there any reason for allowing NA when subsetting ?

Yes: it is part of the S language and widely used to avoid special cases
when programming.  Since you don't know what the index value is, the
column (in your case) is included or not and the only thing to do is to 
return NA.

There are lot of things help("[") does not say, such what happens to
out-of-range indices.  It is in the reference given there (p.358), as
well as in the R Language Reference, section 3.4.1 in the version I looked
at.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Aug 18 13:56:35 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Aug 18 13:56:41 2004
Subject: [Rd] checkS3methods() change
In-Reply-To: <16673.56337.900481.260563@mithrandir.hornik.net>
Message-ID: <Pine.LNX.4.44.0408181250230.24684-100000@gannet.stats>

On Tue, 17 Aug 2004, Kurt Hornik wrote:

> >>>>> James Wettenhall writes:
> 
> > Hi,
> > I'm using rw2000dev.exe (Win32) built on August 14.
> 
> > If this isn't already planned, can I suggest that when
> > checkS3methods() (called by R CMD check) fails because of
> > a syntax error in a dependent package listed in the DESCRIPTION
> > file of the main package being checked, it would be nice if
> > checkS3methods() reported which dependent package caused it to
> > fail?
> 
> > Running R CMD check on my package limmaGUI, revealed a syntax
> > error in one of limmaGUI's dependent packages, which turned out
> > to be the R2HTML package (after a bit of sleuthing).
> 
> > Here's the syntax error in R2HTML, caused by the new parsing
> > rules for associative use of relational operators:
> 
> >   x0 <- xm[okP] == 0 != (as.numeric(Cf[okP]) == 0)
> 
> > The R2HTML package (version 1.3) was installed with:
> >> install.packages("R2HTML")
> > trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> 
> > Here's the tail of the R CMD check output for limmaGUI:
> 
> > * checking R files for syntax errors ... OK
> > * checking R files for library.dynam ... OK
> > * checking S3 generic/method consistency ... WARNING
> > Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
> > Execution halted
> > See section 'Generic functions and methods' of the 'Writing R Extensions' manual.
> > * checking replacement functions ... WARNING
> > Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
> > Execution halted
> > In R, the argument of a replacement function which corresponds
> > to the right hand side must be named 'value'.
> > * checking foreign function calls ... WARNING
> > Error in .try_quietly({ : Error in parse(file, n, text, prompt) : syntax error on line 446
> > Execution halted
> > See section 'System and foreign language interfaces' of the
> > 'Writing R Extensions' manual.
> > * checking Rd files ... OK
> > * checking for missing documentation entries ... ERROR
> > Error in .try_quietly({ : Error in parse(file, n, text, prompt) :
> > * syntax error on line 446
> 
> I am trying to find a general way of printing a suitable traceback
> alongside .try_quietly() errors.  Turns out to be sort of tricky,
> unfortunately ...

In this particular case it is a problem with library() not giving the 
information (or just saying `this package' in others).  I am trying 
systematically to improve the error messages, so it now gives

Error in parse(file, n, text, prompt) : syntax error on line 446
Error: Unable to load R code in package 'R2HTML'

for example.  And that's because I keep getting errors myself with no 
traceback.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jeff.horner at vanderbilt.edu  Wed Aug 18 19:08:52 2004
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Wed Aug 18 19:08:09 2004
Subject: [Rd] R as shared library
Message-ID: <41238D24.3020108@vanderbilt.edu>

Hello folks,

I'm embarking on a project to embed R into the Apache web server, and 
I'd like your help. Currently, I'm looking for a way for R code to call 
back into a shared library from which the R shared library was loaded.

Essentially, apache starts and loads mod_R.so which runs an 
initialization routine which calls  Rf_initEmbeddedR() and the following 
code:

  /* override to call apache library write routine */
  ptr_R_WriteConsole = Rapache_WriteConsole;

  /* load source(). I assume this is appropriate. I could
     always move this to the code that handles the requst */
  PROTECT(R_source_fun = allocVector(LANGSXP, 2));
  SETCAR(R_source_fun, Rf_install("source"));
  SETCAR(CDR(R_source_fun), R_source_arg = NEW_CHARACTER(1));

Then each request is serviced by the following code:

  /* r is apache request, r->filename is url translated to
     apsolute path to filename */
  SET_STRING_ELT(R_source_arg, 0, COPY_TO_USER_STRING(r->filename));
  errorOccurred=1;
  /* R code: source(filename) */
  val = R_tryEval(R_source_fun,NULL,&errorOccurred);
  if (errorOccurred){
    // Send a message to stderr (apache redirects this to the error log)
    fprintf(stderr,"apache2_mod_R: source(%s) failed!\n",r->filename);
    fflush(stderr);
  } else {
    return ok;
  }

I would like to write R routines which hook into apache specific library 
calls to get at the CGI and system data. The apache specific calls need 
a request structure (the r variable) which is available in mod_R.so 
(already loaded) on each request. If I use the .C, .Call, or .External 
interface, then I must load a shared library with the appropriate 
routines. I would like to place those routines in mod_R.so to take 
advantage of access to the request structure. Is this doable?

Another approach is to turn the CGI data into R variables and just place 
those in the top level environment, foregoing any callbacks into apache 
again until the R code has run to completion. This is similar to how PHP 
is embedded into Apache. Other languages that _do_ provide callbacks 
into apache include Perl, Python, and Ruby.


-- 
Jeffrey Horner       Computer Systems Analyst         School of Medicine
615-322-8606         Department of Biostatistics   Vanderbilt University

From hansheng at gsm.pku.edu.cn  Thu Aug 19 03:39:07 2004
From: hansheng at gsm.pku.edu.cn (faculty wang hansheng)
Date: Thu Aug 19 03:38:49 2004
Subject: [Rd] (no subject)
Message-ID: <20040819013907.12637.eqmail@gsm.pku.edu.cn>

Hi, there, 

I have a number of F90 codes wish to be linked into R under Windows XP OS.
Do anyone know how to do it and give some advice? Many thanks. 

Hanson

From ripley at stats.ox.ac.uk  Thu Aug 19 08:43:23 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 19 08:43:28 2004
Subject: [Rd] F90 in R (was (no subject))
In-Reply-To: <20040819013907.12637.eqmail@gsm.pku.edu.cn>
Message-ID: <Pine.LNX.4.44.0408190738050.13976-100000@gannet.stats>

On Thu, 19 Aug 2004, someone claiming to be `faculty wang hansheng' wrote:

> I have a number of F90 codes wish to be linked into R under Windows XP OS.
> Do anyone know how to do it and give some advice? Many thanks. 

Advice: please read the R posting guide, and use an appropriate subject 
line.

First you need to find an F90 compiler for Windows XP (I don't know of a
free one).  Then use it to produce an appropriate DLL with cdecl linkage,
as described in the file README.packages.

Given that R only has C and F77 interfaces to compiled code, you will need 
to ensure that the entry points you actually call use only C/F77 features.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu Aug 19 08:53:34 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 19 08:53:43 2004
Subject: [Rd] Re: [R] Getting data loaded
In-Reply-To: <41240FBE.8090606@jhsph.edu>
Message-ID: <Pine.LNX.4.44.0408190746320.13976-100000@gannet.stats>

Diverted to R-devel: please see the posting guide.

On Wed, 18 Aug 2004, Roger D. Peng wrote:

> I think you should load data in a .First.lib() function, or if 
> you have a namespace, in a .onLoad() function.

Yes, indeed.  However, using data() for system data is not a good idea and 
for R 2.0.0 you can use the new sysdata.rda facility (documented in R-exts 
for that version-to-be).

The issue is that the code in install.R is run *before* the saved image in
the package is loaded (even though it is run after the package itself is
sourced), so you needed data(Wcrit01, package="concord").  When you put
these in a .First.lib you should still specify the package for safety.

Finally, see the (currently draft) file

http://developer.r-project.org/200update.txt


> Jim Lemon wrote:
> > Hi,
> > 
> > I have been informed of a bug in the concord package, in that the data files 
> > containing the tabulated critical values for Kendall's W are not loaded on 
> > the command library(concord).
> > 
> > I had assumed that the lines in install.R would correspond to the commands to 
> > load data in R, e.g.
> > 
> > data(Wcrit01)
> > data(Wcrit05)
> > 
> > While these work on the command line, 

Don't think so.  You need to load your package first.

> I get the errors:
> > 
> > library(concord)
> > Warning messages:
> > 1: Data set 'Wcrit01' not found in: data(Wcrit01)
> > 2: Data set 'Wcrit05' not found in: data(Wcrit05)
> > 
> > The section on this in R-exts doesn't seem to have any information on how to 
> > write the lines in install.R, nor does Checking and Building Packages. I 
> > managed to locate a few install.R files in other packages, but they were all 
> > empty. Any hints?

Don't use install.R.

> > Jim
> > 
> > Dr Jim Lemon
> > Research Psychologist
> > Health Psychology Unit
> > University of Technology, Sydney
> > 
> > Feel free to ignore any garbage beneath this line.
> >
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Gerrit.Eichner at math.uni-giessen.de  Thu Aug 19 11:49:57 2004
From: Gerrit.Eichner at math.uni-giessen.de (Gerrit Eichner)
Date: Thu Aug 19 11:50:32 2004
Subject: [Rd] [R] Problem loading library Matrix on Solaris machine
Message-ID: <Pine.A41.4.58.0408191127550.19590@e1.hrz.uni-giessen.de>

Dear R-devel list members,

after having contacted Douglas Bates (author of package Matrix) he
suggested to ask this list for assistance with the following problem:

After having under

> version
platform sparc-sun-solaris2.9
arch     sparc
os       solaris2.9
system   sparc, solaris2.9
status
major    1
minor    9.1
year     2004
month    06
day      21
language R


successfully installed the Matrix package

> packageDescription( "Matrix")
Package: Matrix
Version: 0.8-10
Date: $Date: 2004-07-07 13:23:11 -0500 (Wed, 07 Jul 2004) $
...
Packaged: Wed Jul 7 14:22:56 2004; bates
Built: R 1.9.1; sparc-sun-solaris2.9; 2004-08-18 14:25:48; unix
-- File: /usr1/soft/R-1.9.1/lib/R/library/Matrix/DESCRIPTION


by using

> options(CRAN = "http://cran.r-project.org/")
> install.packages("Matrix")


the attempt to load the library failed:

> library( Matrix)
Error in dyn.load(x, as.logical(local), as.logical(now)) :
unable to load shared library
"/usr1/soft/R-1.9.1/lib/R/library/Matrix/libs/Matrix.so":
  ld.so.1: /usr1/soft/R-1.9.1/lib/R/bin/R.bin: fatal: relocation error:
file /usr1/soft/R-1.9.1/lib/R/library/Matrix/libs/Matrix.so: symbol isinf:
referenced symbol not found
Error in library(Matrix) : package/namespace load failed


Are we missing anything obvious? Is anybody able to point me to a
solution?
(We do not have the problem on a Linux machine, so it does not seem to be
an installation error made by us, but is apparently due to our Solaris
system libraries.)

Thank you for any help!

 Best regards  --  Gerrit

-------------------------------------------------------------------------
 AR Dr. Gerrit Eichner                            Mathematical Institute
 gerrit.eichner@math.uni-giessen.de     Justus-Liebig-University Giessen
 Tel: +49-(0)641-99-32104            Arndtstr. 2, 35392 Giessen, Germany
 Fax: +49-(0)641-99-32029      http://www.math.uni-giessen.de/Stochastik

From murdoch at stats.uwo.ca  Thu Aug 19 12:34:42 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Aug 19 12:35:05 2004
Subject: [Rd] Fortran 90 (was no subject)
In-Reply-To: <20040819013907.12637.eqmail@gsm.pku.edu.cn>
References: <20040819013907.12637.eqmail@gsm.pku.edu.cn>
Message-ID: <be09i0hb8cmmk21pqp4qqeim857kgurmd7@4ax.com>

On Thu, 19 Aug 2004 01:39:07 GMT, "faculty wang hansheng"
<hansheng@gsm.pku.edu.cn> wrote:

>Hi, there, 
>
>I have a number of F90 codes wish to be linked into R under Windows XP OS.
>Do anyone know how to do it and give some advice? Many thanks. 

It depends on which compiler you're using.  My web page
<http://www.stats.uwo.ca/faculty/murdoch/software/compilingDLLs/>
gives some advice for Salford FTN95, but no F90 compiler as far as I
know.

Duncan Murdoch

From joehl at gmx.de  Thu Aug 19 14:07:30 2004
From: joehl at gmx.de (joehl@gmx.de)
Date: Thu Aug 19 14:07:37 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
Message-ID: <20040819120730.74FD8EAB9@slim.kubism.ku.dk>

Dear all, 

Our quite basic function mtext() does wrong adjustments in some parameter
configurations. This gets obvious when using multi line texts: There is no
way to properly adjust text perpendicular to axis 2, for example.

Best


Jens Oehlschl?gel


m <- matrix(1:9, 3)
colnames(m) <- c("several\nlines", "several\nlines", "several\nlines")

par(mfrow=c(2,2))
barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=0.5 is
fine")
mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=0.5)
barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=1 is
different")
mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=1)
barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=1 adj=0.5 is
NOT fine")
mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=0.5)
barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="at las=1, adj=1
works the wrong direction", sub="no way to get adj=c(1, 0.5) with las=1 (or
2)")
mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=1)
par(mfrow=c(1,1))

> version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    9.1            
year     2004           
month    06             
day      21             
language R   


-- 
NEU: Bis zu 10 GB Speicher f?r e-mails & Dateien!
1 GB bereits bei GMX FreeMail http://www.gmx.net/de/go/mail

From ripley at stats.ox.ac.uk  Thu Aug 19 15:29:26 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 19 15:29:36 2004
Subject: [Rd] [R] Problem loading library Matrix on Solaris machine
In-Reply-To: <Pine.A41.4.58.0408191127550.19590@e1.hrz.uni-giessen.de>
Message-ID: <Pine.LNX.4.44.0408191421270.10774-100000@gannet.stats>

I have four Solaris build setups, gcc/Forte cc x 32/64-bit.
If you tell me a bit more about yours, I can do the appropriate testing.

Looks like this

Matrix/src/taucs/taucs.h:
#if (defined(OSTYPE_irix) || defined(OSTYPE_solaris))

#include <math.h>
#include <ieeefp.h>
#define isinf(x) (!finite((x)) && !isnan((x)))

needs OSTYPE_solaris defined.  (I think I told Doug about this long ago.)

On Thu, 19 Aug 2004, Gerrit Eichner wrote:

> Dear R-devel list members,
> 
> after having contacted Douglas Bates (author of package Matrix) he
> suggested to ask this list for assistance with the following problem:
> 
> After having under
> 
> > version
> platform sparc-sun-solaris2.9
> arch     sparc
> os       solaris2.9
> system   sparc, solaris2.9
> status
> major    1
> minor    9.1
> year     2004
> month    06
> day      21
> language R
> 
> 
> successfully installed the Matrix package
> 
> > packageDescription( "Matrix")
> Package: Matrix
> Version: 0.8-10
> Date: $Date: 2004-07-07 13:23:11 -0500 (Wed, 07 Jul 2004) $
> ...
> Packaged: Wed Jul 7 14:22:56 2004; bates
> Built: R 1.9.1; sparc-sun-solaris2.9; 2004-08-18 14:25:48; unix
> -- File: /usr1/soft/R-1.9.1/lib/R/library/Matrix/DESCRIPTION
> 
> 
> by using
> 
> > options(CRAN = "http://cran.r-project.org/")
> > install.packages("Matrix")
> 
> 
> the attempt to load the library failed:
> 
> > library( Matrix)
> Error in dyn.load(x, as.logical(local), as.logical(now)) :
> unable to load shared library
> "/usr1/soft/R-1.9.1/lib/R/library/Matrix/libs/Matrix.so":
>   ld.so.1: /usr1/soft/R-1.9.1/lib/R/bin/R.bin: fatal: relocation error:
> file /usr1/soft/R-1.9.1/lib/R/library/Matrix/libs/Matrix.so: symbol isinf:
> referenced symbol not found
> Error in library(Matrix) : package/namespace load failed
> 
> 
> Are we missing anything obvious? Is anybody able to point me to a
> solution?
> (We do not have the problem on a Linux machine, so it does not seem to be
> an installation error made by us, but is apparently due to our Solaris
> system libraries.)
> 
> Thank you for any help!
> 
>  Best regards  --  Gerrit
> 
> -------------------------------------------------------------------------
>  AR Dr. Gerrit Eichner                            Mathematical Institute
>  gerrit.eichner@math.uni-giessen.de     Justus-Liebig-University Giessen
>  Tel: +49-(0)641-99-32104            Arndtstr. 2, 35392 Giessen, Germany
>  Fax: +49-(0)641-99-32029      http://www.math.uni-giessen.de/Stochastik
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Whit.Armstrong at tudor.com  Thu Aug 19 17:11:44 2004
From: Whit.Armstrong at tudor.com (Whit Armstrong)
Date: Thu Aug 19 17:11:54 2004
Subject: [Rd] proposed change to [.POSIXct
Message-ID: <7669F018DC9DD711AEC500065B3D5ABF02CAD1C1@tudor.com>

R developers,

The "tzone" attribute is stripped from a POSIXct object when the subscript
command is called ("[.POISXct").  This results in dates being printed in the
locale specific format after a subscript operation is applied to a POSIXct
object which has cause several problems for me in the past.

Here is an example of this problem under R 1.9.1:

> x <- ISOdate(rep(2000,2),rep(3,2),rep(26,2),hour=0)
> x
[1] "2000-03-26 GMT" "2000-03-26 GMT"
> x[1]
[1] "2000-03-25 19:00:00 Eastern Standard Time"
> 
> unclass(x)
[1] 954028800 954028800
attr(,"tzone")
[1] "GMT"
> unclass(x[1])
[1] 954028800
>

Here is the current code for "[.POSIXct"

> get("[.POSIXct")
function (x, ..., drop = TRUE) 
{
    cl <- oldClass(x)
    class(x) <- NULL
    val <- NextMethod("[")
    class(val) <- cl
    val
}
<environment: namespace:base>
> 

I believe a sensible change is the following:

"[.POSIXct" <-
function (x, ..., drop = TRUE) 
{
    at <- attributes(x)
    class(x) <- NULL
    val <- NextMethod("[")
    attributes(val) <- at
    val
}

Using this code, the "tzone" attribute is preserved allowing dates to
continue to be printed in their intended timezone.

Thank you for considering this issue.

Regards,
Whit Armstrong

Here are the details of my system:

> R.Version()
$platform
[1] "i386-pc-mingw32"

$arch
[1] "i386"

$os
[1] "mingw32"

$system
[1] "i386, mingw32"

$status
[1] ""

$major
[1] "1"

$minor
[1] "9.1"

$year
[1] "2004"

$month
[1] "06"

$day
[1] "21"

$language
[1] "R"

> 

	[[alternative HTML version deleted]]

From ripley at stats.ox.ac.uk  Thu Aug 19 17:49:54 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 19 17:49:57 2004
Subject: [Rd] proposed change to [.POSIXct
In-Reply-To: <7669F018DC9DD711AEC500065B3D5ABF02CAD1C1@tudor.com>
Message-ID: <Pine.LNX.4.44.0408191642260.24765-100000@gannet.stats>

Sorry, but you really do not want that the change your patch makes.
Copying across the attributes will for example copy the original names,
any dim's etc.  There is a very good reason why [ does not do that itself.

I am not even sure you want to preserve the "tzone" attribute.  A POSIXct
time is an absolute time, and that attribute is just a reminder of where
it came from.  Since you have operated on it, the history is broken.

As timezones are always used when printing, I don't see anything
problematic about your example.  Do you have a more convincing example
from `which has cause several problems for me in the past'?

On Thu, 19 Aug 2004, Whit Armstrong wrote:

> R developers,
> 
> The "tzone" attribute is stripped from a POSIXct object when the subscript
> command is called ("[.POISXct").  This results in dates being printed in the
> locale specific format after a subscript operation is applied to a POSIXct
> object which has cause several problems for me in the past.
> 
> Here is an example of this problem under R 1.9.1:
> 
> > x <- ISOdate(rep(2000,2),rep(3,2),rep(26,2),hour=0)
> > x
> [1] "2000-03-26 GMT" "2000-03-26 GMT"
> > x[1]
> [1] "2000-03-25 19:00:00 Eastern Standard Time"
> > 
> > unclass(x)
> [1] 954028800 954028800
> attr(,"tzone")
> [1] "GMT"
> > unclass(x[1])
> [1] 954028800
> >
> 
> Here is the current code for "[.POSIXct"
> 
> > get("[.POSIXct")
> function (x, ..., drop = TRUE) 
> {
>     cl <- oldClass(x)
>     class(x) <- NULL
>     val <- NextMethod("[")
>     class(val) <- cl
>     val
> }
> <environment: namespace:base>
> > 
> 
> I believe a sensible change is the following:
> 
> "[.POSIXct" <-
> function (x, ..., drop = TRUE) 
> {
>     at <- attributes(x)
>     class(x) <- NULL
>     val <- NextMethod("[")
>     attributes(val) <- at
>     val
> }
> 
> Using this code, the "tzone" attribute is preserved allowing dates to
> continue to be printed in their intended timezone.
> 
> Thank you for considering this issue.
> 
> Regards,
> Whit Armstrong
> 
> Here are the details of my system:
> 
> > R.Version()
> $platform
> [1] "i386-pc-mingw32"
> 
> $arch
> [1] "i386"
> 
> $os
> [1] "mingw32"
> 
> $system
> [1] "i386, mingw32"
> 
> $status
> [1] ""
> 
> $major
> [1] "1"
> 
> $minor
> [1] "9.1"
> 
> $year
> [1] "2004"
> 
> $month
> [1] "06"
> 
> $day
> [1] "21"
> 
> $language
> [1] "R"
> 
> > 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Thu Aug 19 18:14:06 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Aug 19 18:14:08 2004
Subject: [Rd] text(x, y, labels) - recycling problems and RFC (PR#7084)
Message-ID: <20040819161406.A11FBEABA@slim.kubism.ku.dk>

I didn't get any feedback on this posting,

so I will commit my proposal to recycle the coordinates (x,y) to
the length of 'labels' if the latter is longer  (instead of
silently dropping the extra labels[] entries).

Martin Maechler

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch>
>>>>>     on Tue, 13 Jul 2004 18:22:05 +0200 (CEST) writes:

    MM> Not a bug necessarily, in text(), but at least an inconsistency,
    MM> and a need for more documentation:  Contrary to e.g., plot(),
    MM> text(x,y,labels) *does* recycle it's arguments to some extent --
    MM> and probably has always in S.

    MM> However it doesn't do all I think it should, i.e.,

    MM> plot(1:7); text(1:2, 1+ 1:3, LETTERS[1:4])

    MM> does recycle 'x' to c(1:2, 1) {length 3} to match 'y'
    MM> but doesn't recycle to length 4 in order to match 'labels'.

    MM> While one can well accept this, I believe it should give a
    MM> warning since it silently 'drops' the "d".

    MM> However, I'm proposing to consider S(-plus) compatibility here.
    MM> In S-PLUS 6.1, the result of the above is
    MM> identical to
    MM> plot(1:7); text(rep(1:2,length=4), rep(1+ 1:3, length=4), LETTERS[1:4])
    MM> i.e. (x,y) is recycled to length 4, the length of 'labels'.
					
    MM> Further note that in
    MM> plot(1:7); text(1:2, 1+ 1:3, LETTERS[1:2], col=2:6)
    MM> the 'labels' *are* recycled to length 3, matching (x,y) -- but
    MM> not to length 5 of 'col' which is fine -- just not the other way around.

    MM> I'd propose that R should recycle all three (x,y,labels)
    MM> [but not more] to common length.

    MM> BTW, "grid" graphics do recycle as well, at least  
    MM> grid.text(labels, x, y) does --- and as I see it does also
    MM> recycle at least the 'rotation'.

    MM> Martin Maechler

    MM> ______________________________________________
    MM> R-devel@stat.math.ethz.ch mailing list
    MM> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From sbagley at ucla.edu  Thu Aug 19 18:30:11 2004
From: sbagley at ucla.edu (sbagley@ucla.edu)
Date: Thu Aug 19 18:30:13 2004
Subject: [Rd] R 1.9.1 fails to install for Mac 10.2.8 (PR#7190)
Message-ID: <20040819163011.4EEA8EAC0@slim.kubism.ku.dk>

Full_Name: Steven Bagley
Version: 1.9.1
OS: Mac 10.2.8
Submission from: (NULL) (4.10.4.91)


Was running R 1.9.0 on iMac (10.2.8) without problems.  Tried to run installer
for 1.9.1, but this stops after only several seconds, saying "There were
problems installing the software."  Problem is repeatable, even after repairing
file permissions.  Installation log file shown here:

R 1.9.1 Installation Log
	Target Selection
		_volumeAppeared: Adding volume Macintosh HD
		deactivate: removing all cells from _volumeMatrix
	Selected volume "Macintosh HD"
		Mounted at: /
		OpenFirmware: mac-io/ata-4@1f000/@0:5
		Partition type: HFS+
		Partition map: disk0s5
		Partition: 5
		Protocol: ATA
		Media Type: Generic
		Volume Size: 80019709952
	rm: 
	/Library/Frameworks/R.framework/Versions/Current
	: 
	Permission denied
	rm: 
	/Library/Frameworks/R.framework/R
	: 
	Permission denied
	rm: 
	/Library/Frameworks/R.framework/Resources
	: 
	Permission denied
	rm: 
	/Library/Frameworks/R.framework/Headers
	: 
	Permission denied
	The preflight script in R framework failed.
	Install Failed
	Error detected
	Name: NSGenericException
	Reason: The preflight script in R framework failed. (code 1)

From ripley at stats.ox.ac.uk  Thu Aug 19 18:50:13 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 19 18:50:17 2004
Subject: [Rd] text(x, y, labels) - recycling problems and RFC (PR#7084)
In-Reply-To: <20040819161406.A11FBEABA@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408191725290.24875-100000@gannet.stats>

On Thu, 19 Aug 2004 maechler@stat.math.ethz.ch wrote:

> I didn't get any feedback on this posting,
> 
> so I will commit my proposal to recycle the coordinates (x,y) to
> the length of 'labels' if the latter is longer  (instead of
> silently dropping the extra labels[] entries).

I'd suggest only doing non-fractional recycling (or at the very least 
warning against fractional recycling).  I would expect almost all 
occurrences of your example would be unintended.


> 
> Martin Maechler
> 
> >>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch>
> >>>>>     on Tue, 13 Jul 2004 18:22:05 +0200 (CEST) writes:
> 
>     MM> Not a bug necessarily, in text(), but at least an inconsistency,
>     MM> and a need for more documentation:  Contrary to e.g., plot(),
>     MM> text(x,y,labels) *does* recycle it's arguments to some extent --
>     MM> and probably has always in S.
> 
>     MM> However it doesn't do all I think it should, i.e.,
> 
>     MM> plot(1:7); text(1:2, 1+ 1:3, LETTERS[1:4])
> 
>     MM> does recycle 'x' to c(1:2, 1) {length 3} to match 'y'
>     MM> but doesn't recycle to length 4 in order to match 'labels'.
> 
>     MM> While one can well accept this, I believe it should give a
>     MM> warning since it silently 'drops' the "d".
> 
>     MM> However, I'm proposing to consider S(-plus) compatibility here.
>     MM> In S-PLUS 6.1, the result of the above is
>     MM> identical to
>     MM> plot(1:7); text(rep(1:2,length=4), rep(1+ 1:3, length=4), LETTERS[1:4])
>     MM> i.e. (x,y) is recycled to length 4, the length of 'labels'.
> 					
>     MM> Further note that in
>     MM> plot(1:7); text(1:2, 1+ 1:3, LETTERS[1:2], col=2:6)
>     MM> the 'labels' *are* recycled to length 3, matching (x,y) -- but
>     MM> not to length 5 of 'col' which is fine -- just not the other way around.
> 
>     MM> I'd propose that R should recycle all three (x,y,labels)
>     MM> [but not more] to common length.
> 
>     MM> BTW, "grid" graphics do recycle as well, at least  
>     MM> grid.text(labels, x, y) does --- and as I see it does also
>     MM> recycle at least the 'rotation'.
> 
>     MM> Martin Maechler
> 
>     MM> ______________________________________________
>     MM> R-devel@stat.math.ethz.ch mailing list
>     MM> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Whit.Armstrong at tudor.com  Thu Aug 19 18:53:49 2004
From: Whit.Armstrong at tudor.com (Whit Armstrong)
Date: Thu Aug 19 18:54:01 2004
Subject: [Rd] proposed change to [.POSIXct
Message-ID: <7669F018DC9DD711AEC500065B3D5ABF02CAD1C6@tudor.com>

 
> Sorry, but you really do not want that the change your patch 
> makes. Copying across the attributes will for example copy 
> the original names, any dim's etc.  There is a very good 
> reason why [ does not do that itself.

Copying all attributes may very well be troublesome.  Perhaps the approach
taken in [.difftime or in [.times would be more appropriate:

> get("[.difftime")
function (x, ..., drop = TRUE) 
{
    cl <- oldClass(x)
    class(x) <- NULL
    val <- NextMethod("[")
    class(val) <- cl
    attr(val, "units") <- attr(x, "units")
    val
}
<environment: namespace:base>
> get("[.times")
function (x, ..., drop = TRUE) 
{
    cl <- class(x)
    class(x) <- NULL
    val <- NextMethod("[")
    attr(val, "format") <- attr(x, "format")
    attr(val, "origin") <- attr(x, "origin")
    class(val) <- cl
    val
}


Likewise, the new [.POSIXct would be:

"[.POSIXct" <-
function (x, ..., drop = TRUE) 
{
    old.tzone <- attr(x,"tzone")
    old.class <- class(x)
    class(x) <- NULL
    val <- NextMethod("[")
    class(val) <- old.class
    attr(val,"tzone") <- old.tzone
    val
}

The functions [.difftime and [.times preserve attributes when it's sensible
to do so.  I think POSIXct objects should follow the same rule.
 
> I am not even sure you want to preserve the "tzone" 
> attribute.  A POSIXct time is an absolute time, and that 
> attribute is just a reminder of where it came from.  Since 
> you have operated on it, the history is broken.

I think it should be preserved because in doing a subset operation does not
change the elements of an object, it just selects certain elements.  I'm not
sure what you mean about the history being broken.
 
> As timezones are always used when printing, I don't see 
> anything problematic about your example.  Do you have a more 
> convincing example from `which has cause several problems for 
> me in the past'?

My problems arose from trying to use the seq function with POSIXct objects.

Here is a toy example:

start <- ISOdate(1952,03,01,hour=0)
end <- ISOdate(2004,03,01,hour=0)

xx <- seq(start,end,by="months")
yy <- seq(start[1],end[1],by="months")

all(as.numeric(xx)==as.numeric(yy))
as.numeric(xx)==as.numeric(yy)

In my opinion, these two sequences should be the same. Since subsetting the
vectors causes their printed values to be different, the whole sequence is
thrown off even though the underlying values for start and end are the same:

> unclass(start)
[1] -562896000
attr(,"tzone")
[1] "GMT"
> unclass(start[1])
[1] -562896000

> unclass(end)
[1] 1078099200
attr(,"tzone")
[1] "GMT"
> unclass(end[1])
[1] 1078099200
> 

I hope this case is sufficient for you to consider this proposed change.
The r-list contains frequent posts by people who don't understand the
underlying implementation of dates in R.  I think this change will reduce
the cases in which unsuspecting users have their tzone attribute stripped
because of a subset operation.

Thanks again for your time in addressing this issue Professor Ripley.

Cheers,
Whit


> 
> On Thu, 19 Aug 2004, Whit Armstrong wrote:
> 
> > R developers,
> > 
> > The "tzone" attribute is stripped from a POSIXct object when the 
> > subscript command is called ("[.POISXct").  This results in dates 
> > being printed in the locale specific format after a subscript 
> > operation is applied to a POSIXct object which has cause several 
> > problems for me in the past.
> > 
> > Here is an example of this problem under R 1.9.1:
> > 
> > > x <- ISOdate(rep(2000,2),rep(3,2),rep(26,2),hour=0)
> > > x
> > [1] "2000-03-26 GMT" "2000-03-26 GMT"
> > > x[1]
> > [1] "2000-03-25 19:00:00 Eastern Standard Time"
> > > 
> > > unclass(x)
> > [1] 954028800 954028800
> > attr(,"tzone")
> > [1] "GMT"
> > > unclass(x[1])
> > [1] 954028800
> > >
> > 
> > Here is the current code for "[.POSIXct"
> > 
> > > get("[.POSIXct")
> > function (x, ..., drop = TRUE)
> > {
> >     cl <- oldClass(x)
> >     class(x) <- NULL
> >     val <- NextMethod("[")
> >     class(val) <- cl
> >     val
> > }
> > <environment: namespace:base>
> > > 
> > 
> > I believe a sensible change is the following:
> > 
> > "[.POSIXct" <-
> > function (x, ..., drop = TRUE)
> > {
> >     at <- attributes(x)
> >     class(x) <- NULL
> >     val <- NextMethod("[")
> >     attributes(val) <- at
> >     val
> > }
> > 
> > Using this code, the "tzone" attribute is preserved 
> allowing dates to 
> > continue to be printed in their intended timezone.
> > 
> > Thank you for considering this issue.
> > 
> > Regards,
> > Whit Armstrong
> > 
> > Here are the details of my system:
> > 
> > > R.Version()
> > $platform
> > [1] "i386-pc-mingw32"
> > 
> > $arch
> > [1] "i386"
> > 
> > $os
> > [1] "mingw32"
> > 
> > $system
> > [1] "i386, mingw32"
> > 
> > $status
> > [1] ""
> > 
> > $major
> > [1] "1"
> > 
> > $minor
> > [1] "9.1"
> > 
> > $year
> > [1] "2004"
> > 
> > $month
> > [1] "06"
> > 
> > $day
> > [1] "21"
> > 
> > $language
> > [1] "R"
> > 
> > > 
> > 
> > 	[[alternative HTML version deleted]]
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

From andy_liaw at merck.com  Thu Aug 19 21:00:40 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Aug 19 21:01:09 2004
Subject: [Rd] suggesting a new feature for unique()
Message-ID: <3A822319EB35174CA3714066D590DCD504AF8256@usrymx25.merck.com>

Dear R-devel,

May I suggest that a new feature be added to a couple of unique() methods?
Sometimes it's useful to have the indices of the original data that the
unique elements come from, so that the original data can be recreated from
the unique()ed data.  I suggest that an `index' argument be added for
unique.  Below is a suggested patch against
R/src/library/base/R/duplicated.R:

*** R-devel/src/library/base/R/duplicated.R	Tue Jul 20 12:45:52 2004
--- duplicated.R	Thu Aug 19 14:50:38 2004
***************
*** 34,50 ****
  
  ## NB unique.default is used by factor to avoid unique.matrix,
  ## so it needs to handle some other cases.
! unique.default <- function(x, incomparables = FALSE, ...)
  {
      if(!is.logical(incomparables) || incomparables)
  	.NotYetUsed("incomparables != FALSE")
      z <- .Internal(unique(x))
      if(is.factor(x))
! 	factor(z, levels = seq(len=nlevels(x)), labels = levels(x),
!                ordered = is.ordered(x))
      else if(inherits(x, "POSIXct") || inherits(x, "Date"))
!         structure(z, class=class(x))
!     else z
  }
  
  unique.data.frame <- function(x, incomparables = FALSE, ...)
--- 34,51 ----
  
  ## NB unique.default is used by factor to avoid unique.matrix,
  ## so it needs to handle some other cases.
! unique.default <- function(x, incomparables = FALSE, index=FALSE, ...)
  {
      if(!is.logical(incomparables) || incomparables)
  	.NotYetUsed("incomparables != FALSE")
      z <- .Internal(unique(x))
      if(is.factor(x))
! 	z <- factor(z, levels = seq(len=nlevels(x)), labels = levels(x),
!                     ordered = is.ordered(x))
      else if(inherits(x, "POSIXct") || inherits(x, "Date"))
!         z <- structure(z, class=class(x))
!     if (index) attr(z, "index") <- match(x, z)
!     z
  }
  
  unique.data.frame <- function(x, incomparables = FALSE, ...)
***************
*** 55,61 ****
  }
  
  unique.matrix <- unique.array <-
!     function(x, incomparables = FALSE , MARGIN = 1, ...)
  {
      if(!is.logical(incomparables) || incomparables)
  	.NotYetUsed("incomparables != FALSE")
--- 56,62 ----
  }
  
  unique.matrix <- unique.array <-
!     function(x, incomparables = FALSE , MARGIN = 1, index=FALSE, ...)
  {
      if(!is.logical(incomparables) || incomparables)
  	.NotYetUsed("incomparables != FALSE")
***************
*** 66,70 ****
      args <- rep(alist(a=), ndim)
      names(args) <- NULL
      args[[MARGIN]] <- !duplicated(as.vector(temp))
!     do.call("[", c(list(x=x), args, list(drop=FALSE)))
  }
--- 67,76 ----
      args <- rep(alist(a=), ndim)
      names(args) <- NULL
      args[[MARGIN]] <- !duplicated(as.vector(temp))
!     res <- do.call("[", c(list(x=x), args, list(drop=FALSE)))
!     if (index) {
!         resTemp <- apply(res, MARGIN, function(x) paste(x, collapse =
"\r"))
!         attr(res, "index") <- match(temp, resTemp)
!     }
!     res
  }

An example usage:

> x <- sample(5, 10, rep=T)
> x
 [1] 4 2 5 3 2 3 4 2 2 3
> z <- unique(x, index=TRUE)
> z[attr(z, "index")] == x
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
> x <- factor(x)
> z <- unique(x, index=TRUE)
> z
[1] 4 2 5 3
Levels: 2 3 4 5
> z[attr(z, "index")] == x
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE


[I have not tried adding the same thing for the unique.data.frame method,
but that shouldn't be too hard...]

Best,
Andy

Andy Liaw, PhD
Biometrics Research      PO Box 2000, RY33-300     
Merck Research Labs           Rahway, NJ 07065
mailto:andy_liaw@merck.com        732-594-0820

From andy_liaw at merck.com  Thu Aug 19 21:09:05 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Aug 19 21:09:30 2004
Subject: [Rd] small typo in ?attributes
Message-ID: <3A822319EB35174CA3714066D590DCD504AF8257@usrymx25.merck.com>

I believe in the `Description' section of ?attributes, `above' should be
`below'.

Best,
Andy

Andy Liaw, PhD
Biometrics Research      PO Box 2000, RY33-300     
Merck Research Labs           Rahway, NJ 07065
mailto:andy_liaw@merck.com        732-594-0820

From mayeul.kauffmann at tiscali.fr  Thu Aug 19 23:32:51 2004
From: mayeul.kauffmann at tiscali.fr (Mayeul KAUFFMANN)
Date: Thu Aug 19 23:33:01 2004
Subject: [Rd] Unbalanced parentheses printed by warnings() crash text editor
Message-ID: <000501c48634$15f86c00$e3489b53@amd>

Hello everyone,

Hope it is the good place for this (I discuss the question of the right
place below).

Most of the time, warnings are more than 1000 characters long and thus are
truncated.
Most of the time, this generates printouts with unbalanced parentheses.

Intelligent text editors which do  parentheses highlighting get very
confused with this.
After too many warnings, they give errors, and may even crash.

Specifically, I use ESS and XEmacs for Windows Users of R (by John Fox)
which is advised to do at http://ess.r-project.org/
with a buffer for text editing and an inferior ESS (R) buffer.
(I downloaded the latest Xemacs and ESS a month ago).

After too many warnings (with unbalanced parentheses), Xemacs  swithes to
an ESS-error buffer which says "error Nesting too deep for parser".
In some case, when back in R buffer, typing any letter switches back to
the ESS-error Buffer.
In other case, it simply takes ages (until you kill Xemacs) or it crashes.
In most case, the R process is lost.

I could have sent this to the ESS or Xemacs devel list, but ESS & Xemacs'
attempt to find balanced parentheses accross many lines seems sensible,
and is needed with very long functions.

A workaround would be to change the function that print warnings.

Instead of, for instance,
"error message xxxxxxxxxx in: function.yyyyyy(zzzzzzzzz,zzzzzzz,   ..."

It may print
"error message xxxxxxxxxx in: function.yyyyyy(zzzzzzzzz,zzzzzzz,   ...)"

The function should truncate the error message, find how many parenthesis
and brackets are open in the remaining part, substract the number of
closing parenthesis and brackets, and add that many parenthesis at the
end.
(Xemacs parentheses highligher regards "(" and "[" as equivalent)


Mayeul KAUFFMANN
Univ. Pierre Mendes France
Grenoble - France

From simon.urbanek at math.uni-augsburg.de  Fri Aug 20 00:40:57 2004
From: simon.urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Aug 20 00:41:20 2004
Subject: [Rd] R 1.9.1 fails to install for Mac 10.2.8 (PR#7190)
In-Reply-To: <20040819163011.4EEA8EAC0@slim.kubism.ku.dk>
References: <20040819163011.4EEA8EAC0@slim.kubism.ku.dk>
Message-ID: <D650FCA7-F230-11D8-853C-000A959F327E@math.uni-augsburg.de>


On Aug 19, 2004, at 6:30 PM, sbagley@ucla.edu wrote:

> Was running R 1.9.0 on iMac (10.2.8) without problems.  Tried to run 
> installer
> for 1.9.1, but this stops after only several seconds, saying "There 
> were
> problems installing the software." Problem is repeatable, even after 
> repairing file permissions.

This is repeatable only in your setup and if you really "repaired" 
permissions of R.framework it would go away ;) [Apple's DU doesn't do 
that AFAIR]. It seems that your R 1.9.0 uses different rights than 
1.9.1 which (depending on how you installed 1.9.0) may prevent the 
1.9.1 installer from having sufficient rights to delete the old 
version. The easiest way to solve this is to run
sudo rm -rf /Library/Frameworks/R.framework
in the Terminal, thus removing old R manually. Another possible fix is 
to bump up the authentication requirement of the installer from "admin" 
to "root" by editing the Info.plist ... which should be only done if 
you know what you're doing ;). We could do that in general if that 
bites more people...

Cheers,
Simon

From sbagley at ucla.edu  Fri Aug 20 01:20:45 2004
From: sbagley at ucla.edu (Steven C. Bagley)
Date: Fri Aug 20 01:21:08 2004
Subject: [Rd] R 1.9.1 fails to install for Mac 10.2.8 (PR#7190)
In-Reply-To: <D650FCA7-F230-11D8-853C-000A959F327E@math.uni-augsburg.de>
Message-ID: <BD4A83DD.138F%sbagley@ucla.edu>

> 
> On Aug 19, 2004, at 6:30 PM, sbagley@ucla.edu wrote:
> 
>> Was running R 1.9.0 on iMac (10.2.8) without problems.  Tried to run
>> installer
>> for 1.9.1, but this stops after only several seconds, saying "There
>> were
>> problems installing the software." Problem is repeatable, even after
>> repairing file permissions.
> 
> This is repeatable only in your setup and if you really "repaired"
> permissions of R.framework it would go away ;) [Apple's DU doesn't do
> that AFAIR]. It seems that your R 1.9.0 uses different rights than
> 1.9.1 which (depending on how you installed 1.9.0) may prevent the
> 1.9.1 installer from having sufficient rights to delete the old
> version. The easiest way to solve this is to run
> sudo rm -rf /Library/Frameworks/R.framework
> in the Terminal, thus removing old R manually. Another possible fix is
> to bump up the authentication requirement of the installer from "admin"
> to "root" by editing the Info.plist ... which should be only done if
> you know what you're doing ;). We could do that in general if that
> bites more people...
> 
> Cheers,
> Simon
> 
Thanks for your quick reply.  Unfortunately, I tried the "sudo rm ...",
followed by reinstallation of R 1.9.1, which got nearly all the way through
the installation process, and then stopped with an error.  Log file follows:

R 1.9.1 Installation Log
    Target Selection
        _volumeAppeared: Adding volume Macintosh HD
        deactivate: removing all cells from _volumeMatrix
    Selected volume "Macintosh HD"
        Mounted at: /
        OpenFirmware: mac-io/ata-4@1f000/@0:5
        Partition type: HFS+
        Partition map: disk0s5
        Partition: 5
        Protocol: ATA
        Media Type: Generic
        Volume Size: 80019709952
    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on . - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: . - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on ./Library - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: ./Library - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on ./Library/Frameworks - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: ./Library/Frameworks - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on ./Library/Frameworks - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: ./Library/Frameworks - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on ./Library - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: ./Library - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on . - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: . - Operation not permitted

    Some files for R framework may not have been written correctly.
    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on . - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: . - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Could not set
permissions on . - Operation not permitted

    ERROR:Could not set file attributes. - pax: error 1:Access/modification
time set failed on: . - Operation not permitted

    Some files for libxml2 may not have been written correctly.
    Registered /Applications/R.app.
    ln: 
    /usr/bin/R
    : 
    Permission denied
    The postflight script in R framework failed.
    Install Failed
    Error detected
    Name: NSGenericException
    Reason: The postflight script in R framework failed. (code 1)

From maechler at stat.math.ethz.ch  Fri Aug 20 08:59:10 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Aug 20 08:59:12 2004
Subject: [Rd] Springer: New Series Announcement "UseR!"
Message-ID: <16677.41278.847577.749744@gargle.gargle.HOWL>

	       [in behalf of John Kimmel and Kurt Hornik:]

       [PDF version for nice printing attached at the end]

NEW SERIES ANNOUNCEMENT and 
REQUEST FOR BOOK PROPOSALS 

Springer announces a series of books called 
	 UseR! 

edited by Robert Gentleman, Kurt Hornik, and Giovanni Parmigiani. 

This series of inexpensive and focused books on R will publish
shorter books aimed at practitioners. Books can discuss the use
of R in a particular subject area (e.g., epidemiology,
econometrics, psychometrics) or as it relates to statistical
topics (e.g., missing data, longitudinal data). In most cases,
books are to be written as combinations of LaTeX and R so that
all the code for figures and tables can be put on a
website. Authors should assume a background as supplied by
?Dalgaard s Introductory Statistics with R? so that each book does
not repeat basic material. Springer will supply a LaTeX style
file, all books will be reviewed and copyedited, and faster
production schedules will be used. 

To propose a book, please contact 

John Kimmel 
Executive Editor, 
Statistics Springer 
24494 Alta Vista Dr. 
Dana Point, CA 92629

john.kimmel@springer-sbm.com 
Telephone: 949-487-1216 Fax: 949-240-4321

-------------- next part --------------
A non-text attachment was scrubbed...
Name: UseR-Kimmel.pdf
Type: application/pdf
Size: 26260 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20040820/15143890/UseR-Kimmel.pdf
From murdoch at stats.uwo.ca  Fri Aug 20 11:52:56 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Aug 20 11:53:10 2004
Subject: [Rd] Unbalanced parentheses printed by warnings() crash text
	editor
In-Reply-To: <000501c48634$15f86c00$e3489b53@amd>
References: <000501c48634$15f86c00$e3489b53@amd>
Message-ID: <n9ibi0pr92qeodvmmiqng1l7df6rjc64a3@4ax.com>

On Thu, 19 Aug 2004 23:32:51 +0200, "Mayeul KAUFFMANN"
<mayeul.kauffmann@tiscali.fr> wrote:

>Hope it is the good place for this (I discuss the question of the right
>place below).

I don't think so.

>Most of the time, warnings are more than 1000 characters long and thus are
>truncated.
>Most of the time, this generates printouts with unbalanced parentheses.
>
>Intelligent text editors which do  parentheses highlighting get very
>confused with this.
>After too many warnings, they give errors, and may even crash.

As far as I know, this only affects one "intelligent" text editor.
It's clearly an ESS/XEmacs bug, not a natural thing for an editor to
do.

>I could have sent this to the ESS or Xemacs devel list, but ESS & Xemacs'
>attempt to find balanced parentheses accross many lines seems sensible,
>and is needed with very long functions.

Yes, it's sensible to try, but it is a bug that they don't fail
gracefully.

Duncan Murdoch

From p.dalgaard at biostat.ku.dk  Fri Aug 20 12:01:39 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Aug 20 12:06:20 2004
Subject: [Rd] Unbalanced parentheses printed by warnings() crash text
	editor
In-Reply-To: <n9ibi0pr92qeodvmmiqng1l7df6rjc64a3@4ax.com>
References: <000501c48634$15f86c00$e3489b53@amd>
	<n9ibi0pr92qeodvmmiqng1l7df6rjc64a3@4ax.com>
Message-ID: <x2zn4qm8l8.fsf@biostat.ku.dk>

Duncan Murdoch <murdoch@stats.uwo.ca> writes:

> >I could have sent this to the ESS or Xemacs devel list, but ESS & Xemacs'
> >attempt to find balanced parentheses accross many lines seems sensible,
> >and is needed with very long functions.
> 
> Yes, it's sensible to try, but it is a bug that they don't fail
> gracefully.

(Actually, it is not sensible; ESS should try harder to figure out
what is actually R code. Much as I love ESS, it is a persistent fly in
the ointment when the opening blurb comes up with "for" and "in" in
magenta.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Fri Aug 20 12:07:55 2004
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri Aug 20 12:08:12 2004
Subject: [Rd] small typo in ?attributes
In-Reply-To: <3A822319EB35174CA3714066D590DCD504AF8257@usrymx25.merck.com>
References: <3A822319EB35174CA3714066D590DCD504AF8257@usrymx25.merck.com>
Message-ID: <ebjbi0h38mjbammvnmuno200edspl1j04j@4ax.com>

On Thu, 19 Aug 2004 15:09:05 -0400, "Liaw, Andy" <andy_liaw@merck.com>
wrote:

>I believe in the `Description' section of ?attributes, `above' should be
>`below'.


I'll fix this.

Duncan Murdoch

From maechler at stat.math.ethz.ch  Fri Aug 20 14:29:41 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Aug 20 14:29:50 2004
Subject: [Rd] Unbalanced parentheses printed by warnings() crash text
	editor
In-Reply-To: <x2zn4qm8l8.fsf@biostat.ku.dk>
References: <000501c48634$15f86c00$e3489b53@amd>
	<n9ibi0pr92qeodvmmiqng1l7df6rjc64a3@4ax.com>
	<x2zn4qm8l8.fsf@biostat.ku.dk>
Message-ID: <16677.61109.796888.448784@gargle.gargle.HOWL>

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 20 Aug 2004 12:01:39 +0200 writes:

    PD> Duncan Murdoch <murdoch@stats.uwo.ca> writes:
    >> >I could have sent this to the ESS or Xemacs devel list, but ESS & Xemacs'
    >> >attempt to find balanced parentheses accross many lines seems sensible,
    >> >and is needed with very long functions.
    >> 
    >> Yes, it's sensible to try, but it is a bug that they don't fail
    >> gracefully.

    PD> (Actually, it is not sensible; ESS should try harder to figure out
    PD> what is actually R code. Much as I love ESS, it is a persistent fly in
    PD> the ointment when the opening blurb comes up with "for" and "in" in
    PD> magenta.)

I'm chiming in, since I have been addressed explicitly here (for
whatever reason):

Yes, yes, and yes to Duncan's and Peter's notes:

- This should have gone to the ESS-help mailing list
- it's no bug in R and a bug in ESS/Xemacs (actually a bug in Xemacs combined
  with a missing feature in ESS).

Martin Maechler

For the sake of ESS-help, here's the original message as well:

>>>>> "Mayeul" == Mayeul KAUFFMANN <mayeul.kauffmann@tiscali.fr>
>>>>>     on Thu, 19 Aug 2004 23:32:51 +0200 writes:

    Mayeul> ... Hope it is the good place for this
    Mayeul> (I discuss the question of the right place below).

    Mayeul> Most of the time, warnings are more than 1000

[?? you probably mean something like '100', not '1000', right?]

    Mayeul> characters long and thus are truncated.  Most of the
    Mayeul> time, this generates printouts with unbalanced parentheses.

    Mayeul> Intelligent text editors which do parentheses
    Mayeul> highlighting get very confused with this.  After too
    Mayeul> many warnings, they give errors, and may even crash.

crashing *must* be a bug of the editor setup (ESS - XEmacs -
Windows), not of R.

    Mayeul> Specifically, I use ESS and XEmacs for Windows Users
    Mayeul> of R (by John Fox) which is advised to do at
    Mayeul> http://ess.r-project.org/ with a buffer for text
    Mayeul> editing and an inferior ESS (R) buffer.  (I
    Mayeul> downloaded the latest Xemacs and ESS a month ago).

    Mayeul> After too many warnings (with unbalanced
    Mayeul> parentheses), Xemacs swithes to an ESS-error buffer
    Mayeul> which says "error Nesting too deep for parser".  In
    Mayeul> some case, when back in R buffer, typing any letter
    Mayeul> switches back to the ESS-error Buffer.  In other
    Mayeul> case, it simply takes ages (until you kill Xemacs)
    Mayeul> or it crashes.  In most case, the R process is lost.

    Mayeul> I could have sent this to the ESS or Xemacs devel
    Mayeul> list, but ESS & Xemacs' attempt to find balanced
    Mayeul> parentheses accross many lines seems sensible, and
    Mayeul> is needed with very long functions.

    Mayeul> A workaround would be to change the function that print warnings.

    Mayeul> Instead of, for instance,
    Mayeul> "error message xxxxxxxxxx in: function.yyyyyy(zzzzzzzzz,zzzzzzz,   ..."

    Mayeul> It may print
    Mayeul> "error message xxxxxxxxxx in: function.yyyyyy(zzzzzzzzz,zzzzzzz,   ...)"

    Mayeul> The function should truncate the error message, find
    Mayeul> how many parenthesis and brackets are open in the
    Mayeul> remaining part, substract the number of closing
    Mayeul> parenthesis and brackets, and add that many
    Mayeul> parenthesis at the end.  (Xemacs parentheses
    Mayeul> highligher regards "(" and "[" as equivalent)


    Mayeul> Mayeul KAUFFMANN
    Mayeul> Univ. Pierre Mendes France
    Mayeul> Grenoble - France

From maechler at stat.math.ethz.ch  Fri Aug 20 15:05:07 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri Aug 20 15:05:14 2004
Subject: [Rd] text(x, y, labels) - recycling problems and RFC (PR#7084)
Message-ID: <20040820130507.90AF7FCDC@slim.kubism.ku.dk>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Thu, 19 Aug 2004 17:50:13 +0100 (BST) writes:

    BDR> On Thu, 19 Aug 2004 maechler@stat.math.ethz.ch wrote:
    >> I didn't get any feedback on this posting,
    >> 
    >> so I will commit my proposal to recycle the coordinates (x,y) to
    >> the length of 'labels' if the latter is longer  (instead of
    >> silently dropping the extra labels[] entries).

    BDR> I'd suggest only doing non-fractional recycling (or at the very least 
    BDR> warning against fractional recycling).  I would expect almost all 
    BDR> occurrences of your example would be unintended.

well, as said, both "grid" and S-plus do recycle (w/o warning) in
this situation.

Do we have precedence cases of "recycling but warn if
fractional" ?

Martin

    >> >>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch>
    >> >>>>>     on Tue, 13 Jul 2004 18:22:05 +0200 (CEST) writes:
    >> 
    MM> Not a bug necessarily, in text(), but at least an inconsistency,
    MM> and a need for more documentation:  Contrary to e.g., plot(),
    MM> text(x,y,labels) *does* recycle it's arguments to some extent --
    MM> and probably has always in S.
    >> 
    MM> However it doesn't do all I think it should, i.e.,
    >> 
    MM> plot(1:7); text(1:2, 1+ 1:3, LETTERS[1:4])
    >> 
    MM> does recycle 'x' to c(1:2, 1) {length 3} to match 'y'
    MM> but doesn't recycle to length 4 in order to match 'labels'.
    >> 
    MM> While one can well accept this, I believe it should give a
    MM> warning since it silently 'drops' the "d".
    >> 
    MM> However, I'm proposing to consider S(-plus) compatibility here.
    MM> In S-PLUS 6.1, the result of the above is
    MM> identical to
    MM> plot(1:7); text(rep(1:2,length=4), rep(1+ 1:3, length=4), LETTERS[1:4])
    MM> i.e. (x,y) is recycled to length 4, the length of 'labels'.
    >> 
    MM> Further note that in
    MM> plot(1:7); text(1:2, 1+ 1:3, LETTERS[1:2], col=2:6)
    MM> the 'labels' *are* recycled to length 3, matching (x,y) -- but
    MM> not to length 5 of 'col' which is fine -- just not the other way around.
    >> 
    MM> I'd propose that R should recycle all three (x,y,labels)
    MM> [but not more] to common length.
    >> 
    MM> BTW, "grid" graphics do recycle as well, at least  
    MM> grid.text(labels, x, y) does --- and as I see it does also
    MM> recycle at least the 'rotation'.
    >> 
    MM> Martin Maechler
    >> 
    MM> ______________________________________________
    MM> R-devel@stat.math.ethz.ch mailing list
    MM> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> ______________________________________________
    >> R-devel@stat.math.ethz.ch mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> 

    BDR> -- 
    BDR> Brian D. Ripley,                  ripley@stats.ox.ac.uk
    BDR> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
    BDR> University of Oxford,             Tel:  +44 1865 272861 (self)
    BDR> 1 South Parks Road,                     +44 1865 272866 (PA)
    BDR> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

    BDR> ______________________________________________
    BDR> R-devel@stat.math.ethz.ch mailing list
    BDR> https://stat.ethz.ch/mailman/listinfo/r-devel

From ligges at statistik.uni-dortmund.de  Fri Aug 20 15:17:11 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri Aug 20 15:17:21 2004
Subject: [Rd] legend lwd - feature request (PR#7023)
Message-ID: <20040820131711.3C704FC04@slim.kubism.ku.dk>

Lfo@psykiatri.aaa.dk wrote:

> (R1.9.1 Windows)
> 
> In legend( ) lwd have no effect on points - contrary to the behaviour
> in e.g. plot( ) and points( ). It would be nice to have an option pt.lwd
> affecting the line width of legend points (like pt.cex changes the
> magnification).
> 
> 
> An example (note the difference in line width between points in the
> plot and the legend):
> x <- 1:10 ; y <- rnorm(10,10,5) ; y2 <- rnorm(10,8,4)
> plot(x,y,bty="l",lwd=3,type="o",col=2,ylim=c(min(y,y2),max(y,y2)),cex=1.5)
> points(x,y2,lwd=3,lty=8,col=4,type="o",pch=2,cex=1.5)
> legend(10,max(y,y2),legend=c("Method 1","Method
> 2"),col=c(2,4),lty=c(1,8),pch=c(1,2),
>     xjust=1,yjust=1,pt.cex=1.5,lwd=3)
> 
> Workaround (thanks to Peter Dalgaard):
> x <- 1:10 ; y <- rnorm(10,10,5) ; y2 <- rnorm(10,8,4)
> plot(x,y,bty="l",lwd=3,type="o",col=2,ylim=c(min(y,y2),max(y,y2)),cex=1.5)
> points(x,y2,lwd=3,lty=8,col=4,type="o",pch=2,cex=1.5)
> legend(10,max(y,y2),legend=c("Method 1","Method
> 2"),col=c(0,0),lty=c(1,8),pch=c(1,2),
>     xjust=1,yjust=1,pt.cex=1.5,lwd=0,text.col=0)
> pp <- par(lwd=3)
> legend(10,max(y,y2),legend=c("Method 1","Method 2"),
>     col=c(2,4),lty=c(1,8),pch=c(1,2), 
>     xjust=1,yjust=1,pt.cex=1.5,lwd=3,bty="n")
> par(pp)


The quick patch at the end of this message will add an argument pt.lwd 
to legend(). Note that this argument only accepts one value for all 
point, because vectorized widths are not supported by points() and friends.

There is another point to consider for the long term:
In order to restrict the possibly huge amount of possible values for 
legend() and make it legend() more flexible (I know, it already is very 
flexible), one might want to invent new arguments like point.args, 
line.args, text.args that accept lists of arguments to be passed to the 
corresponding underlying functions. However, that would require a 
redesign of legend() - and would certainly break some code ...

Uwe Ligges


Patch, diff'ed against r-devel (rev. 30796):


--- y:\recent\R\src\library\graphics\R\legend.R
+++ legend.R    2004-08-20 15:08:13.000000000 +0200
@@ -1,7 +1,7 @@
  legend <-
  function(x, y = NULL, legend, fill=NULL, col = "black", lty, lwd, pch,
-     angle = NULL, density = NULL, bty = "o",
-     bg = par("bg"), pt.bg = NA, cex = 1, pt.cex = cex,
+     angle = NULL, density = NULL, bty = "o", bg = par("bg"),
+     pt.bg = NA, cex = 1, pt.cex = cex, pt.lwd = par("lwd"),
       xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1, adj = c(0, 0.5),
       text.width = NULL, text.col = par("col"),
           merge = do.lines && has.pch, trace = FALSE,
@@ -178,8 +178,8 @@
      if(trace)
          catn("  points2(", x1,",", y1,", pch=", pch[ok],", ...)")
      if(plot)
-        points2(x1, y1,
-                    pch = pch[ok], col= col[ok], cex= pt.cex[ok], bg= 
pt.bg[ok])
+        points2(x1, y1, pch = pch[ok], col = col[ok], cex = pt.cex[ok],
+                bg = pt.bg[ok], lwd = pt.lwd)
      if (!merge) xt <- xt + dx.pch
      }



--- y:\recent\R\src\library\graphics\man\legend.Rd
+++ legend.Rd   2004-08-20 15:13:41.000000000 +0200
@@ -4,8 +4,8 @@
  \usage{
  legend(x, y = NULL, legend, fill = NULL, col = "black", lty, lwd, pch,
         angle = NULL, density = NULL, bty = "o", bg = par("bg"),
-       pt.bg = NA, cex = 1, pt.cex = cex, xjust = 0, yjust = 1,
-       x.intersp = 1, y.intersp = 1, adj = c(0, 0.5),
+       pt.bg = NA, cex = 1, pt.cex = cex, pt.lwd = par("lwd"), xjust = 0,
+       yjust = 1, x.intersp = 1, y.intersp = 1, adj = c(0, 0.5),
         text.width = NULL, text.col = par("col"),
         merge = do.lines && has.pch, trace = FALSE,
         plot = TRUE, ncol = 1, horiz = FALSE)
@@ -43,6 +43,7 @@
    \item{cex}{character expansion factor \bold{relative} to current
      \code{par("cex")}.}
    \item{pt.cex}{expansion factor(s) for the points.}
+  \item{pt.lwd}{line width for the points.}
    \item{xjust}{how the legend is to be justified relative to the legend
      x location.  A value of 0 means left justified, 0.5 means centered
      and 1 means right justified.}

From ligges at statistik.uni-dortmund.de  Fri Aug 20 15:34:05 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri Aug 20 15:34:14 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
Message-ID: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>

joehl@gmx.de wrote:

> Dear all, 
> 
> Our quite basic function mtext() does wrong adjustments in some parameter
> configurations. This gets obvious when using multi line texts: There is no
> way to properly adjust text perpendicular to axis 2, for example.
> 
> Best
> 
> 
> Jens Oehlschl?gel
> 
> 
> m <- matrix(1:9, 3)
> colnames(m) <- c("several\nlines", "several\nlines", "several\nlines")
> 
> par(mfrow=c(2,2))
> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=0.5 is
> fine")
> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=0.5)
> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=1 is
> different")
> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=1)
> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=1 adj=0.5 is
> NOT fine")
> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=0.5)
> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="at las=1, adj=1
> works the wrong direction", sub="no way to get adj=c(1, 0.5) with las=1 (or
> 2)")
> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=1)
> par(mfrow=c(1,1))
> 

Left / right adjustemnt seems to be perfectly OK.
The thing that matters is centering "several lines" to the specified 
("at=") location.
In fact, mtext() is not centering but bottom-aligning by adding a 
negative distance that looks OK for one line in the default font size, 
but not in most other cases.

Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment of 
perpendicular text"). Fixing this, and/or improving mtext()'s "adj" 
argument to accept 2 dimensions is desirable, but might be not that 
easy... I'll take a look during the next days, but nothing promised.

Uwe Ligges



>>version
> 
>          _              
> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    1              
> minor    9.1            
> year     2004           
> month    06             
> day      21             
> language R   
> 
>

From rossini at blindglobe.net  Fri Aug 20 15:37:08 2004
From: rossini at blindglobe.net (A.J. Rossini)
Date: Fri Aug 20 15:46:37 2004
Subject: [Rd] Unbalanced parentheses printed by warnings() crash text
	editor
In-Reply-To: <16677.61109.796888.448784@gargle.gargle.HOWL> (Martin
	Maechler's message of "Fri, 20 Aug 2004 14:29:41 +0200")
References: <000501c48634$15f86c00$e3489b53@amd>
	<n9ibi0pr92qeodvmmiqng1l7df6rjc64a3@4ax.com>
	<x2zn4qm8l8.fsf@biostat.ku.dk>
	<16677.61109.796888.448784@gargle.gargle.HOWL>
Message-ID: <85fz6i53sr.fsf@servant.blindglobe.net>

(address line truncated)

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>>     on 20 Aug 2004 12:01:39 +0200 writes:
>
>     PD> Duncan Murdoch <murdoch@stats.uwo.ca> writes:
>     >> >I could have sent this to the ESS or Xemacs devel list, but ESS & Xemacs'
>     >> >attempt to find balanced parentheses accross many lines seems sensible,
>     >> >and is needed with very long functions.
>     >> 
>     >> Yes, it's sensible to try, but it is a bug that they don't fail
>     >> gracefully.
>
>     PD> (Actually, it is not sensible; ESS should try harder to figure out
>     PD> what is actually R code. Much as I love ESS, it is a persistent fly in
>     PD> the ointment when the opening blurb comes up with "for" and "in" in
>     PD> magenta.)
>

Agreed with all -- it's an ESS bug.  I've made stabs in the recent
past at getting R's syntax into semantic (the Emacs parser tool) to
make much of these sorts of things more automatic (as well as provide
syntactical (?) completion :-).

I'll not have time again until next year, probably.

-- 
Anthony Rossini			    Research Associate Professor
rossini@u.washington.edu            http://www.analytics.washington.edu/ 
Biomedical and Health Informatics   University of Washington
Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From Simon.Urbanek at math.uni-augsburg.de  Fri Aug 20 16:02:55 2004
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Aug 20 16:03:10 2004
Subject: [Rd] R 1.9.1 fails to install for Mac 10.2.8 (PR#7190)
In-Reply-To: <BD4A83DD.138F%sbagley@ucla.edu>
References: <BD4A83DD.138F%sbagley@ucla.edu>
Message-ID: <A2521926-F2B1-11D8-AA5B-000A957CEFBA@math.uni-augsburg.de>

On Aug 20, 2004, at 1:20 AM, Steven C. Bagley wrote:

> Thanks for your quick reply.  Unfortunately, I tried the "sudo rm ...",
> followed by reinstallation of R 1.9.1, which got nearly all the way 
> through
> the installation process, and then stopped with an error.  Log file 
> follows:

According to the log R was installed allright - so does it in fact work 
or not?

AFAICS it just doesn't have enough rights to create the convenience 
symlink in /usr/bin, but that's not essential for R to work. Again the 
fix in your case would be to bump up the rights of the installer - 
admin doesn't seem to have enough rights on your computer.
I don't have a Jag machine here (there are no problems on Panther 
AFAIK) to confirm it atm, but I suspect that the cause is the old R 
1.9.0 installer, which forced owner change on folders it shouldn't have 
touched. This was fixed in the new installer (that is the new installer 
doesn't force ownership anymore), but it cannot reverse the changes 
made by the 1.9.0 installer. I'll dig out some old Jag machine and see 
if I can reproduce it... but again, bumping up the rights should fix it 
in any case.

If you want to try it out, just for the fun of it, do the following: 
open the R.dmg, go to the Packages folder and drag the "R 
framework.pkg" to your desktop.
Now copy/paste the following in Terminal:
cd Desktop/R\ framework.pkg/Contents/
chmod +w Info.plist
open Info.plist

Now you'll see a tree-like structure of the plist file - expand the 
branches and find the "IFPkgFlagAuthorizationAction" key with 
"AdminAuthorization" value - change that value to "RootAuthorization", 
save the file (cmd+s) and double-click on the "R framework.pkg" file. 
That should perform the R installation without errors. Since I don't 
know what goes on with the libxml package, you could try it on that 
one, too.

Cheers,
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From sbagley at ucla.edu  Fri Aug 20 16:44:16 2004
From: sbagley at ucla.edu (Steven C. Bagley)
Date: Fri Aug 20 16:44:35 2004
Subject: [Rd] R 1.9.1 fails to install for Mac 10.2.8 (PR#7190)
In-Reply-To: <A2521926-F2B1-11D8-AA5B-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <BD4B5C50.1399%sbagley@ucla.edu>

> On Aug 20, 2004, at 1:20 AM, Steven C. Bagley wrote:
> 
>> Thanks for your quick reply.  Unfortunately, I tried the "sudo rm ...",
>> followed by reinstallation of R 1.9.1, which got nearly all the way
>> through
>> the installation process, and then stopped with an error.  Log file
>> follows:
> 
> According to the log R was installed allright - so does it in fact work
> or not?
> 
> AFAICS it just doesn't have enough rights to create the convenience
> symlink in /usr/bin, but that's not essential for R to work. Again the
> fix in your case would be to bump up the rights of the installer -
> admin doesn't seem to have enough rights on your computer.
> I don't have a Jag machine here (there are no problems on Panther
> AFAIK) to confirm it atm, but I suspect that the cause is the old R
> 1.9.0 installer, which forced owner change on folders it shouldn't have
> touched. This was fixed in the new installer (that is the new installer
> doesn't force ownership anymore), but it cannot reverse the changes
> made by the 1.9.0 installer. I'll dig out some old Jag machine and see
> if I can reproduce it... but again, bumping up the rights should fix it
> in any case.
> 
> If you want to try it out, just for the fun of it, do the following:
> open the R.dmg, go to the Packages folder and drag the "R
> framework.pkg" to your desktop.
> Now copy/paste the following in Terminal:
> cd Desktop/R\ framework.pkg/Contents/
> chmod +w Info.plist
> open Info.plist
> 
> Now you'll see a tree-like structure of the plist file - expand the
> branches and find the "IFPkgFlagAuthorizationAction" key with
> "AdminAuthorization" value - change that value to "RootAuthorization",
> save the file (cmd+s) and double-click on the "R framework.pkg" file.
> That should perform the R installation without errors. Since I don't
> know what goes on with the libxml package, you could try it on that
> one, too.

My error.  R 1.9.1 DID get installed correctly.  Also, I did try your
suggestions for editing the Info.plist (although used Emacs, as open did not
cooperate), and the installation then re-ran without errors.  Thanks so much
for your help.

--Steve

From rpeng at jhsph.edu  Fri Aug 20 16:49:47 2004
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Fri Aug 20 16:49:56 2004
Subject: [Rd] require or import methods?
Message-ID: <41260F8B.2030909@jhsph.edu>

I'm developing a package now that creates some S4 classes/methods 
(hence, uses `methods') and also has a namespace.  I'm a little confused 
over whether I should be importing `methods' or require()-ing it.  It 
seems to me that `methods' should be imported since it is needed for 
setGeneric, setMethod, etc.  But, a person using my package will 
probably want `methods' on the search path in order to use functions 
like as() or is().  In this case, should I just require `methods' by 
putting it in the Depends: field (for R >= 2.0.0) and not bother 
importing the namespace?

-roger

From ripley at stats.ox.ac.uk  Fri Aug 20 16:59:42 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 20 16:59:47 2004
Subject: [Rd] require or import methods?
In-Reply-To: <41260F8B.2030909@jhsph.edu>
Message-ID: <Pine.LNX.4.44.0408201555540.14043-100000@gannet.stats>

You need methods to for example call setClass.  I doubt that your R code
can be sourced without methods being on the search path.  So it needs to
go in Depends.

OTOH, you could also import the namespace to ensure that your code 
does get functions from methods and not others of the same name.  That 
might be paranoia ....

Hope that clarifies things.

On Fri, 20 Aug 2004, Roger D. Peng wrote:

> I'm developing a package now that creates some S4 classes/methods 
> (hence, uses `methods') and also has a namespace.  I'm a little confused 
> over whether I should be importing `methods' or require()-ing it.  It 
> seems to me that `methods' should be imported since it is needed for 
> setGeneric, setMethod, etc.  But, a person using my package will 
> probably want `methods' on the search path in order to use functions 
> like as() or is().  In this case, should I just require `methods' by 
> putting it in the Depends: field (for R >= 2.0.0) and not bother 
> importing the namespace?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Fri Aug 20 17:01:13 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Aug 20 17:00:13 2004
Subject: [Rd] legend's arguments "angle" and "density"
In-Reply-To: <009b01c1cb92$c7fbdb80$7632d882@stat.auckland.ac.nz>
References: <Pine.GSO.3.96.1020313040441.2280B-100000@magic>
	<001e01c1cac5$2ac49960$7632d882@stat.auckland.ac.nz>
	<3C8FB3D0.C7CD3D3D@cancer.org.uk> <3C90045E.C8E0B8C0@icrf.icnet.uk>
	<009b01c1cb92$c7fbdb80$7632d882@stat.auckland.ac.nz>
Message-ID: <41261239.1030605@statistik.uni-dortmund.de>

Paul Murrell wrote [on 2002-03-14 with Subject: "filled bars with 
patterns" in reply to Arne Mueller]

> Hi
> 
> <snip>
> 
>>I'd also like to have the filled boxes in the legend to be striped. The
>>legend function has a 'density' attribute, but unfortunately this does't
>>seem to do anything
>>
>>following the above example
>>
>>legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), fill = c('red', 'blue',
>>'green', 'orange'))
>>
>>is the same as
>>
>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), density=10, fill = c('red',
>>'blue', 'green', 'orange'),
>>      density=c(10,-1,20, 200))
> 
> 
> 
> This appears to be a bug.  Can you file a bug report for this please?

[SNIP; I cannot find any related bug report in the repository]


I'm just reviewing bug reports and other stuff re. legend() and found 
this old message in one of my Next-Week-To-Do-folders.

Well, the point mentioned above is not really a bug, because one has to 
specify BOTH arguments, angle AND density in legend(). Is there any 
point not to make angle = 45 the default, as it already is for polygon() 
and rect()?

Uwe Ligges

From ripley at stats.ox.ac.uk  Fri Aug 20 18:01:42 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 20 18:01:52 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable
In-Reply-To: <200408201524.i7KFOrp9015320@hypatia.math.ethz.ch>
Message-ID: <Pine.LNX.4.44.0408201652270.13691-100000@gannet.stats>

As I read the posting guide this is not a help request and not of general 
interest, so diverted to R-devel.

Several people including me have built R on AMD64 with 3.3.3.  That's the
compiler of Fedora Core 2, and of whatever version of SuSE (perhaps 9.0)  
we have on our 110-processor cluster.  I am currently use 3.4.1.

Your error is in Fortran, and we have seen Fortran errors in earlier 
versions of the gcc collection so it's the g77 version that is relevant.

On Fri, 20 Aug 2004 ivo_welch-rstat8783@mailblocks.com wrote:

> 
> dear wizards:
> 
>   FYI: gentoo is a linux meta distribution, which compiles all packages. 
>   Once running, gentoo is stable on most applications.  (it has some 
> problems with system tools, such as grub.)  the compiler is gcc 3.3.3.  
> I do not expect anyone to track down for me why R fails on the gentoo 
> amd64+gcc3.3.3 system, but I thought that it would be good to put it on 
> the record to save others some time.
> 
> The resulting from-source-compiled R is not stable in this combination. 
>   R starts up ok, but a couple of commands (a simple linear regression) 
> usually result in a Segfault.  this applies both to the R provided by 
> gentoo (an old version of 1.9.0) or the latest version 1.9.1 which I 
> just pulled down.  in case someone is wondering, the debugger backtrace 
> provides
> 
> #0  0x000000000052ac16 in dnrm2_ ()
> #1  0x00000000005185e8 in dqrdc2_ ()
> #2  0x0000000000518db1 in dqrls_ ()
> #3  0x000000000045d5d5 in do_dotCode ()
> #4  0x0000000000472b6b in Rf_eval ()
> ...
> 
> (if any R wizard were to find it useful to try it out for himself, I 
> could arrange for machine access, or provide other relevant 
> information.  if anyone has compiled R 1.9.1 under amd64 with gcc 3.3.3 
> and found it to be stable, please let me know, too.)
> 
> sincerely,
> 
> /ivo welch
> 
> ---
> ivo welch
> professor of finance and economics
> brown / nber / yale
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From mentus at gmx.de  Fri Aug 20 19:11:04 2004
From: mentus at gmx.de (Fernando Henrique Ferraz P. da Rosa)
Date: Fri Aug 20 19:11:38 2004
Subject: [Rd] Proposed (minor) change to plot.TukeyHSD
Message-ID: <20040820171104.GA27208@ime.usp.br>

        Attached follows a patch to a minor change in the plot method of
the TukeyHSD class (package stats). Basically it defines main= and xlab=
as formal arguments of the plot function, with reasonable default
values, passing them to title(), instead of using hard-coded only values
for main= and xlab=. This way it's possible to change the title and xlab
of the plots created using plot.TukeyHSD(). It's a minor change but it's
useful when one has to display a plot's title/captions in other language
than english. 

        Thank you,

--
Fernando Henrique Ferraz P. da Rosa
http://www.ime.usp.br/~feferraz
-------------- next part --------------
--- current/TukeyHSD.R	2004-08-20 13:53:12.000000000 -0300
+++ proposed/TukeyHSD.R	2004-08-20 13:57:46.000000000 -0300
@@ -75,7 +75,9 @@
     print.default(unclass(x), ...)
 }
 
-plot.TukeyHSD <- function (x, ...)
+plot.TukeyHSD <- function (x,main = paste(format(100 * attr(x, "conf.level"),2),
+  "% family-wise confidence level\n", sep = ""),
+  xlab = paste("Differences in mean levels of", names(x)[i]), ...)
 {
     for (i in seq(along = x)) {
         xi <- x[[i]]
@@ -90,9 +92,7 @@
         segments(xi[, "lwr"], yvals, xi[, "upr"], yvals, ...)
         segments(as.vector(xi), rep.int(yvals - 0.1, 3), as.vector(xi),
                  rep.int(yvals + 0.1, 3), ...)
-        title(main = paste(format(100 * attr(x, "conf.level"),
-              2), "% family-wise confidence level\n", sep = ""),
-              xlab = paste("Differences in mean levels of", names(x)[i]))
+        title(main = main,xlab = xlab)
         box()
     }
 }
From maechler at stat.math.ethz.ch  Fri Aug 20 19:13:56 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Aug 20 19:13:57 2004
Subject: [Rd] legend's arguments "angle" and "density"
In-Reply-To: <41261239.1030605@statistik.uni-dortmund.de>
References: <Pine.GSO.3.96.1020313040441.2280B-100000@magic>
	<001e01c1cac5$2ac49960$7632d882@stat.auckland.ac.nz>
	<3C8FB3D0.C7CD3D3D@cancer.org.uk> <3C90045E.C8E0B8C0@icrf.icnet.uk>
	<009b01c1cb92$c7fbdb80$7632d882@stat.auckland.ac.nz>
	<41261239.1030605@statistik.uni-dortmund.de>
Message-ID: <16678.12628.219394.718403@gargle.gargle.HOWL>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Fri, 20 Aug 2004 17:01:13 +0200 writes:

    UweL> Paul Murrell wrote [on 2002-03-14 with Subject: "filled bars with 
    UweL> patterns" in reply to Arne Mueller]

    >> Hi
    >> 
    >> <snip>
    >> 
    >>> I'd also like to have the filled boxes in the legend to be striped. The
    >>> legend function has a 'density' attribute, but unfortunately this does't
    >>> seem to do anything
    >>> 
    >>> following the above example
    >>> 
    >>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), fill = c('red', 'blue',
    >>> 'green', 'orange'))
    >>> 
    >>> is the same as
    >>> 
    >>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), density=10, fill = c('red',
    >>> 'blue', 'green', 'orange'),
    >>> density=c(10,-1,20, 200))
    >> 
    >> 
    >> 
    >> This appears to be a bug.  Can you file a bug report for this please?

    UweL> [SNIP; I cannot find any related bug report in the repository]


    UweL> I'm just reviewing bug reports and other stuff re. legend() and found 
    UweL> this old message in one of my Next-Week-To-Do-folders.

    UweL> Well, the point mentioned above is not really a bug, because one has to 
    UweL> specify BOTH arguments, angle AND density in legend(). Is there any 
    UweL> point not to make angle = 45 the default, as it already is for polygon() 
    UweL> and rect()?

This seems like a good idea,
but we'll wait for your many other patches to legend.R and
legend.Rd   :-)

Martin

From vograno at evafunds.com  Fri Aug 20 19:20:02 2004
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Fri Aug 20 19:20:34 2004
Subject: [Rd] gcc optimization  flag when building R
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A563D457@phost015.EVAFUNDS.intermedia.net>

Hi,
 
I am building R on RH Linux 7.3 and I noticed that ./configure does not
set the optimization flag, -O or -O2, for gcc, but does set for g++ and
g77. Why is that? Should I try to set it manually, if yes how?
 
Thanks,
Vadim
 
P.S. This is the bottom portion of the ./configure run
 
 
R is now configured for i686-pc-linux-gnu
 
  Source directory:          .
  Installation directory:    /usr/local
 
  C compiler:                gcc -D__NO_MATH_INLINES -mieee-fp -DNO_PURE
-Wchar-subscripts -Wformat -Wimplicit -Wreturn-type -Wswitch -Wreorder
-Wwrite-strings -Woverloaded-virtual -Wshadow -Wno-ctor-dtor-privacy
-m486 -fPIC -DOSRELMAJOR=2 -DOSRELMINOR=4
  C++ compiler:              g++ -mieee-fp -g -O2
  Fortran compiler:          g77 -mieee-fp -g -O2
 
  Interfaces supported:      X11, tcltk
  External libraries:        readline, BLAS(generic)
  Additional capabilities:   PNG, JPEG
  Options enabled:           R profiling
 
  Recommended packages:      yes


	[[alternative HTML version deleted]]

From ligges at statistik.uni-dortmund.de  Fri Aug 20 19:44:40 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Aug 20 19:43:40 2004
Subject: [Rd] legend's arguments "angle" and "density"
In-Reply-To: <16678.12628.219394.718403@gargle.gargle.HOWL>
References: <Pine.GSO.3.96.1020313040441.2280B-100000@magic>	<001e01c1cac5$2ac49960$7632d882@stat.auckland.ac.nz>	<3C8FB3D0.C7CD3D3D@cancer.org.uk>
	<3C90045E.C8E0B8C0@icrf.icnet.uk>	<009b01c1cb92$c7fbdb80$7632d882@stat.auckland.ac.nz>	<41261239.1030605@statistik.uni-dortmund.de>
	<16678.12628.219394.718403@gargle.gargle.HOWL>
Message-ID: <41263888.2030000@statistik.uni-dortmund.de>

Martin Maechler wrote:

>>>>>>"UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>>    on Fri, 20 Aug 2004 17:01:13 +0200 writes:
> 
> 
>     UweL> Paul Murrell wrote [on 2002-03-14 with Subject: "filled bars with 
>     UweL> patterns" in reply to Arne Mueller]
> 
>     >> Hi
>     >> 
>     >> <snip>
>     >> 
>     >>> I'd also like to have the filled boxes in the legend to be striped. The
>     >>> legend function has a 'density' attribute, but unfortunately this does't
>     >>> seem to do anything
>     >>> 
>     >>> following the above example
>     >>> 
>     >>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), fill = c('red', 'blue',
>     >>> 'green', 'orange'))
>     >>> 
>     >>> is the same as
>     >>> 
>     >>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), density=10, fill = c('red',
>     >>> 'blue', 'green', 'orange'),
>     >>> density=c(10,-1,20, 200))
>     >> 
>     >> 
>     >> 
>     >> This appears to be a bug.  Can you file a bug report for this please?
> 
>     UweL> [SNIP; I cannot find any related bug report in the repository]
> 
> 
>     UweL> I'm just reviewing bug reports and other stuff re. legend() and found 
>     UweL> this old message in one of my Next-Week-To-Do-folders.
> 
>     UweL> Well, the point mentioned above is not really a bug, because one has to 
>     UweL> specify BOTH arguments, angle AND density in legend(). Is there any 
>     UweL> point not to make angle = 45 the default, as it already is for polygon() 
>     UweL> and rect()?
> 
> This seems like a good idea,
> but we'll wait for your many other patches to legend.R and
> legend.Rd   :-)

Just three rather than many issues I'm trying to address, the third one 
is just closing a bug report. ;-)
Here the two suggested patches in merged form.

Uwe


--- y:\recent\R\src\library\graphics\R\legend.R
+++ legend.R    2004-08-20 19:36:26.000000000 +0200
@@ -1,7 +1,7 @@
  legend <-
  function(x, y = NULL, legend, fill=NULL, col = "black", lty, lwd, pch,
-     angle = NULL, density = NULL, bty = "o",
-     bg = par("bg"), pt.bg = NA, cex = 1, pt.cex = cex,
+     angle = 45, density = NULL, bty = "o", bg = par("bg"),
+     pt.bg = NA, cex = 1, pt.cex = cex, pt.lwd = par("lwd"),
       xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1, adj = c(0, 0.5),
       text.width = NULL, text.col = par("col"),
           merge = do.lines && has.pch, trace = FALSE,
@@ -178,8 +178,8 @@
      if(trace)
          catn("  points2(", x1,",", y1,", pch=", pch[ok],", ...)")
      if(plot)
-        points2(x1, y1,
-                    pch = pch[ok], col= col[ok], cex= pt.cex[ok], bg= 
pt.bg[ok])
+        points2(x1, y1, pch = pch[ok], col = col[ok], cex = pt.cex[ok],
+                bg = pt.bg[ok], lwd = pt.lwd)
      if (!merge) xt <- xt + dx.pch
      }






--- y:\recent\R\src\library\graphics\man\legend.Rd
+++ legend.Rd   2004-08-20 19:36:16.000000000 +0200
@@ -3,9 +3,9 @@
  \title{Add Legends to Plots}
  \usage{
  legend(x, y = NULL, legend, fill = NULL, col = "black", lty, lwd, pch,
-       angle = NULL, density = NULL, bty = "o", bg = par("bg"),
-       pt.bg = NA, cex = 1, pt.cex = cex, xjust = 0, yjust = 1,
-       x.intersp = 1, y.intersp = 1, adj = c(0, 0.5),
+       angle = 45, density = NULL, bty = "o", bg = par("bg"),
+       pt.bg = NA, cex = 1, pt.cex = cex, pt.lwd = par("lwd"), xjust = 0,
+       yjust = 1, x.intersp = 1, y.intersp = 1, adj = c(0, 0.5),
         text.width = NULL, text.col = par("col"),
         merge = do.lines && has.pch, trace = FALSE,
         plot = TRUE, ncol = 1, horiz = FALSE)
@@ -43,6 +43,7 @@
    \item{cex}{character expansion factor \bold{relative} to current
      \code{par("cex")}.}
    \item{pt.cex}{expansion factor(s) for the points.}
+  \item{pt.lwd}{line width for the points.}
    \item{xjust}{how the legend is to be justified relative to the legend
      x location.  A value of 0 means left justified, 0.5 means centered
      and 1 means right justified.}

From vograno at evafunds.com  Fri Aug 20 19:50:37 2004
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Fri Aug 20 19:51:04 2004
Subject: [Rd] make check failed with a minor error
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A563D468@phost015.EVAFUNDS.intermedia.net>

Hi,
 
I am building R off the source file  "The latest release (2004-06-21):
R-1.9.1.tgz <http://cran.stat.ucla.edu/src/base/R-1.9.1.tgz>  " on RH
Linux 7.3. After the build the "make check" failed with an error which I
judge to be minor, but would like to hear from the experts in the field.
Is it harmeless? Can it indicate some problem with my computer setup
(not R)?
 
 
running code in 'd-p-q-r-tests.R' ... OK
comparing 'd-p-q-r-tests.Rout' to './d-p-q-r-tests.Rout.save' ...267c267
< df = 0.5[1] "Mean relative  difference: 5.001647e-10"
---
> df = 0.5[1] TRUE

 
Thanks a lot in advance,
Vadim
 

	[[alternative HTML version deleted]]

From p.dalgaard at biostat.ku.dk  Fri Aug 20 20:15:13 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Aug 20 20:19:55 2004
Subject: [Rd] gcc optimization  flag when building R
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A563D457@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A563D457@phost015.EVAFUNDS.intermedia.net>
Message-ID: <x2pt5lfzgu.fsf@biostat.ku.dk>

"Vadim Ogranovich" <vograno@evafunds.com> writes:

> Hi,
>  
> I am building R on RH Linux 7.3 and I noticed that ./configure does not
> set the optimization flag, -O or -O2, for gcc, but does set for g++ and
> g77. Why is that? Should I try to set it manually, if yes how?
>  
> Thanks,
> Vadim
>  
> P.S. This is the bottom portion of the ./configure run
>  
>  
> R is now configured for i686-pc-linux-gnu
>  
>   Source directory:          .
>   Installation directory:    /usr/local
>  
>   C compiler:                gcc -D__NO_MATH_INLINES -mieee-fp -DNO_PURE
> -Wchar-subscripts -Wformat -Wimplicit -Wreturn-type -Wswitch -Wreorder
> -Wwrite-strings -Woverloaded-virtual -Wshadow -Wno-ctor-dtor-privacy
> -m486 -fPIC -DOSRELMAJOR=2 -DOSRELMINOR=4
>   C++ compiler:              g++ -mieee-fp -g -O2
>   Fortran compiler:          g77 -mieee-fp -g -O2

Something appears to be setting a load of CFLAGS that are not usually
there, though. If you have set CFLAGS on the make line or in a config.site
file, just include -g -O2 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Fri Aug 20 20:20:43 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Aug 20 20:25:22 2004
Subject: [Rd] make check failed with a minor error
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A563D468@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A563D468@phost015.EVAFUNDS.intermedia.net>
Message-ID: <x2llg9fz7o.fsf@biostat.ku.dk>

"Vadim Ogranovich" <vograno@evafunds.com> writes:

> Hi,
>  
> I am building R off the source file  "The latest release (2004-06-21):
> R-1.9.1.tgz <http://cran.stat.ucla.edu/src/base/R-1.9.1.tgz>  " on RH
> Linux 7.3. After the build the "make check" failed with an error which I
> judge to be minor, but would like to hear from the experts in the field.
> Is it harmeless? Can it indicate some problem with my computer setup
> (not R)?
>  
>  
> running code in 'd-p-q-r-tests.R' ... OK
> comparing 'd-p-q-r-tests.Rout' to './d-p-q-r-tests.Rout.save' ...267c267
> < df = 0.5[1] "Mean relative  difference: 5.001647e-10"
> ---
> > df = 0.5[1] TRUE
> 
>  
> Thanks a lot in advance,

Didn't we just see that in another thread? If you have been tampering
with the compiler flags for numerics, this sort of thing may happen.
The tolerance in the check criterion is at 5e-10 so you're only just
over, and you might argue that the torerance is simply too tight.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From bellis at hsph.harvard.edu  Fri Aug 20 20:27:44 2004
From: bellis at hsph.harvard.edu (Byron Ellis)
Date: Fri Aug 20 20:27:50 2004
Subject: [Rd] R as shared library
In-Reply-To: <41238D24.3020108@vanderbilt.edu>
References: <41238D24.3020108@vanderbilt.edu>
Message-ID: <A12266EC-F2D6-11D8-8CA1-000D93C24D64@hsph.harvard.edu>

Building the callbacks is possible. Basically, you need to construct a 
fake DllInfo object for Apache and then use R_registerRoutines to 
attach the callbacks to R as it if were a normal R package registering 
its routines.

I might have a simple example of this lying around, I'll see if I can 
find it (especially since it seems I'll be needing it myself soon :-))

On Aug 18, 2004, at 1:08 PM, Jeffrey Horner wrote:

> Hello folks,
>
> I'm embarking on a project to embed R into the Apache web server, and 
> I'd like your help. Currently, I'm looking for a way for R code to 
> call back into a shared library from which the R shared library was 
> loaded.
>
> Essentially, apache starts and loads mod_R.so which runs an 
> initialization routine which calls  Rf_initEmbeddedR() and the 
> following code:
>
>  /* override to call apache library write routine */
>  ptr_R_WriteConsole = Rapache_WriteConsole;
>
>  /* load source(). I assume this is appropriate. I could
>     always move this to the code that handles the requst */
>  PROTECT(R_source_fun = allocVector(LANGSXP, 2));
>  SETCAR(R_source_fun, Rf_install("source"));
>  SETCAR(CDR(R_source_fun), R_source_arg = NEW_CHARACTER(1));
>
> Then each request is serviced by the following code:
>
>  /* r is apache request, r->filename is url translated to
>     apsolute path to filename */
>  SET_STRING_ELT(R_source_arg, 0, COPY_TO_USER_STRING(r->filename));
>  errorOccurred=1;
>  /* R code: source(filename) */
>  val = R_tryEval(R_source_fun,NULL,&errorOccurred);
>  if (errorOccurred){
>    // Send a message to stderr (apache redirects this to the error log)
>    fprintf(stderr,"apache2_mod_R: source(%s) failed!\n",r->filename);
>    fflush(stderr);
>  } else {
>    return ok;
>  }
>
> I would like to write R routines which hook into apache specific 
> library calls to get at the CGI and system data. The apache specific 
> calls need a request structure (the r variable) which is available in 
> mod_R.so (already loaded) on each request. If I use the .C, .Call, or 
> .External interface, then I must load a shared library with the 
> appropriate routines. I would like to place those routines in mod_R.so 
> to take advantage of access to the request structure. Is this doable?
>
> Another approach is to turn the CGI data into R variables and just 
> place those in the top level environment, foregoing any callbacks into 
> apache again until the R code has run to completion. This is similar 
> to how PHP is embedded into Apache. Other languages that _do_ provide 
> callbacks into apache include Perl, Python, and Ruby.
>
>
> -- 
> Jeffrey Horner       Computer Systems Analyst         School of 
> Medicine
> 615-322-8606         Department of Biostatistics   Vanderbilt 
> University
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
---
Byron Ellis (bellis@hsph.harvard.edu)
"Oook" -- The Librarian

From jeff.horner at vanderbilt.edu  Fri Aug 20 21:16:58 2004
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Fri Aug 20 21:17:18 2004
Subject: [Rd] R as shared library
In-Reply-To: <A12266EC-F2D6-11D8-8CA1-000D93C24D64@hsph.harvard.edu>
References: <41238D24.3020108@vanderbilt.edu>
	<A12266EC-F2D6-11D8-8CA1-000D93C24D64@hsph.harvard.edu>
Message-ID: <41264E2A.1020201@vanderbilt.edu>

Byron Ellis wrote:
> Building the callbacks is possible. Basically, you need to construct a 
> fake DllInfo object for Apache and then use R_registerRoutines to attach 
> the callbacks to R as it if were a normal R package registering its 
> routines.
> 
> I might have a simple example of this lying around, I'll see if I can 
> find it (especially since it seems I'll be needing it myself soon :-))

Yes. I thought about that, but that solution may break on future R 
releases and may hinder porting to other platforms outside of the UNIX 
family. I'm going to try Duncan's suggestion of a third dll which will 
install like a traditional R package.

-- 
Jeffrey Horner       Computer Systems Analyst         School of Medicine
615-322-8606         Department of Biostatistics   Vanderbilt University

From erich.neuwirth at univie.ac.at  Sat Aug 21 13:41:31 2004
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Sat Aug 21 13:37:38 2004
Subject: [Rd] rsync.r-project.org unreachable
Message-ID: <412734EB.9070307@univie.ac.at>

rsync.r-project.org (alias bates4.stat.wisc.edu)
seems to be unreachable right now.
is this only my problem?
will it be reachable soon again?


-- 
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386

From ripley at stats.ox.ac.uk  Sat Aug 21 13:56:46 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Aug 21 13:56:49 2004
Subject: [Rd] rsync.r-project.org unreachable
In-Reply-To: <412734EB.9070307@univie.ac.at>
Message-ID: <Pine.LNX.4.44.0408211247310.24962-100000@gannet.stats>

It is decomissioned.  See the current FAQ on CRAN, which says

  Sources are also available via `https://svn.r-project.org/R/', the R
  Subversion repository, but currently not via anonymous rsync (or CVS).

There are good, security-related, reasons for discontinuing rsync.

To get R from svn.r-project.org you need an svn client
(http://subversion.tigris.org/project_packages.html) and then look at
http://developer.r-project.org/SVNtips.html, although

  ## to checkout
  svn co https://svn.r-project.org/R/trunk R-devel
  ## to update
  cd R-devel
  svn up

is about all you need to know.  If you want a GUI use TortoiseSVN (but 
watch for drastic slowdowns to Explorer with it installed).


On Sat, 21 Aug 2004, Erich Neuwirth wrote:

> rsync.r-project.org (alias bates4.stat.wisc.edu)
> seems to be unreachable right now.
> is this only my problem?
> will it be reachable soon again?
> 
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ivo_welch-rstat8783 at mailblocks.com  Sat Aug 21 15:59:14 2004
From: ivo_welch-rstat8783 at mailblocks.com (ivo_welch-rstat8783@mailblocks.com)
Date: Sat Aug 21 15:59:19 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
In-Reply-To: <Pine.LNX.4.44.0408201652270.13691-100000@gannet.stats>
Message-ID: <200408211359.i7LDxG3D032187@hypatia.math.ethz.ch>


peter/brian:  thank you for the help.  i can now report that gentoo 
amd64 can compile R just fine, too; it requires the f77 USE flag and a 
gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my 
segfault troubles earlier were caused by my use of f2c.

suggestion: would it be possible to add a code snippet  that tests 
whether the user is trying to compile with f2c---and if so, bombs the 
installation?  (if "f77 --version == f2c" then die)  I know the 
problems are not R's fault, but it can percolate into R and it can 
protect people like myself.

regards,

/ivo

PS: I am still looking for an R wizard who would be interested in 
coauthoring an "R cookbook" ala the "perl cookbook" with me...

---
ivo welch
professor of finance and economics
brown / nber / yale


-----Original Message-----
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
To: ivo_welch-rstat8783@mailblocks.com
Cc: r-devel@stat.math.ethz.ch
Sent: Fri, 20 Aug 2004 17:01:42 +0100 (BST)
Subject: Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable

As I read the posting guide this is not a help request and not of 
general
interest, so diverted to R-devel.

Several people including me have built R on AMD64 with 3.3.3.  That's 
the
compiler of Fedora Core 2, and of whatever version of SuSE (perhaps 
9.0)
we have on our 110-processor cluster.  I am currently use 3.4.1.

Your error is in Fortran, and we have seen Fortran errors in earlier
versions of the gcc collection so it's the g77 version that is relevant.

On Fri, 20 Aug 2004 ivo_welch-rstat8783@mailblocks.com wrote:

>
> dear wizards:
>
>   FYI: gentoo is a linux meta distribution, which compiles all 
packages.
>   Once running, gentoo is stable on most applications.  (it has some
> problems with system tools, such as grub.)  the compiler is gcc 
3.3.3.
> I do not expect anyone to track down for me why R fails on the gentoo
> amd64+gcc3.3.3 system, but I thought that it would be good to put it 
on
> the record to save others some time.
>
> The resulting from-source-compiled R is not stable in this 
combination.
>   R starts up ok, but a couple of commands (a simple linear 
regression)
> usually result in a Segfault.  this applies both to the R provided by
> gentoo (an old version of 1.9.0) or the latest version 1.9.1 which I
> just pulled down.  in case someone is wondering, the debugger 
backtrace
> provides
>
> #0  0x000000000052ac16 in dnrm2_ ()
> #1  0x00000000005185e8 in dqrdc2_ ()
> #2  0x0000000000518db1 in dqrls_ ()
> #3  0x000000000045d5d5 in do_dotCode ()
> #4  0x0000000000472b6b in Rf_eval ()
> ...
>
> (if any R wizard were to find it useful to try it out for himself, I
> could arrange for machine access, or provide other relevant
> information.  if anyone has compiled R 1.9.1 under amd64 with gcc 
3.3.3
> and found it to be stable, please let me know, too.)
>
> sincerely,
>
> /ivo welch
>
> ---
> ivo welch
> professor of finance and economics
> brown / nber / yale
>
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! 
http://www.R-project.org/posting-guide.html
>
>

--
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat Aug 21 16:27:44 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Aug 21 16:27:56 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
In-Reply-To: <E1ByWOu-0006DN-1F@rx0.oucs.ox.ac.uk>
Message-ID: <Pine.LNX.4.44.0408211504560.12323-100000@gannet.stats>

On Sat, 21 Aug 2004 ivo_welch-rstat8783@mailblocks.com wrote:

> 
> peter/brian:  thank you for the help.  i can now report that gentoo 
> amd64 can compile R just fine, too; it requires the f77 USE flag and a 
> gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my 
> segfault troubles earlier were caused by my use of f2c.
> 
> suggestion: would it be possible to add a code snippet  that tests 
> whether the user is trying to compile with f2c---and if so, bombs the 
> installation?  (if "f77 --version == f2c" then die)  I know the 
> problems are not R's fault, but it can percolate into R and it can 
> protect people like myself.

The thing is, it does work on some platforms -- I do test i686 RH8.0
(updated with gcc 3.4.1) from time to time and it looks like I tested
1.9.0 during beta test.  So `make check' is the only reliable test.
(I've just run the current R-devel to cross-check.  It runs into the 
infinite-loop in LAPACK problem with gcc >= 3.4.0 though, with the same 
fix.)

I suspect f2c on a 64-bit platform is a bad idea as int != long.
We could detect that.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Gerrit.Eichner at math.uni-giessen.de  Sat Aug 21 19:49:49 2004
From: Gerrit.Eichner at math.uni-giessen.de (Gerrit Eichner)
Date: Sat Aug 21 19:50:08 2004
Subject: [Rd] Problem loading library Matrix on Solaris machine
In-Reply-To: <Pine.LNX.4.44.0408191421270.10774-100000@gannet.stats>
References: <Pine.LNX.4.44.0408191421270.10774-100000@gannet.stats>
Message-ID: <Pine.A41.4.58.0408211944480.14994@e1.hrz.uni-giessen.de>

Dear Prof. Ripley,

thank you for your offer for assistance. Here are some more details from
our sys admin (who sincerely thanks you for the hint to
Matrix/src/taucs/taucs.h):

--- the system administrator says: ---

Since we don't have a license for the cc compiler anymore I have to use
gcc. Trying to compile the Matrix package via the Makefile in Matrix/src
doesn't work as this uses the cc compiler and I don't know how to change
that in an appropriate way (there is no configure script for example).

As I don't really understand how R compiles downloaded packages and how
and where I could change the configuration for that, I tried the following
dirty hack:

- added '#define OSTYPE_solaris' in Matrix/src/taucs/taucs.h
- made a new tarball (Matrix_0.8-10.tar.gz) of the directory Matrix
- put PACKAGES and Matrix_0.8-10.tar.gz on my own website
- installed the changed package via
  > options(CRAN = 'http://my_own_website...')
  > install.packages("Matrix")

... which did the trick. But where should OSTYPE_solaris really be set?

--- end system administrator ---


I hope these informations can shed some light onto our problem and assist
you in tracking down the reason. Thanks again.

 Best regards  --  Gerrit Eichner

-------------------------------------------------------------------------
 AR Dr. Gerrit Eichner                            Mathematical Institute
 gerrit.eichner@math.uni-giessen.de     Justus-Liebig-University Giessen
 Tel: +49-(0)641-99-32104            Arndtstr. 2, 35392 Giessen, Germany
 Fax: +49-(0)641-99-32029      http://www.math.uni-giessen.de/Stochastik

From edd at debian.org  Sat Aug 21 19:59:35 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat Aug 21 19:59:38 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
In-Reply-To: <200408211359.i7LDxG3D032187@hypatia.math.ethz.ch>
References: <Pine.LNX.4.44.0408201652270.13691-100000@gannet.stats>
	<200408211359.i7LDxG3D032187@hypatia.math.ethz.ch>
Message-ID: <20040821175935.GA418@sonny.eddelbuettel.com>

On Sat, Aug 21, 2004 at 06:59:14AM -0700, ivo_welch-rstat8783@mailblocks.com wrote:
> 
> peter/brian:  thank you for the help.  i can now report that gentoo 
> amd64 can compile R just fine, too; it requires the f77 USE flag and a

(Err, no such thing exists: either g77, f2c or the fort77 wrapper for f2c.)

> gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my 
> segfault troubles earlier were caused by my use of f2c.
> 
> suggestion: would it be possible to add a code snippet  that tests 
> whether the user is trying to compile with f2c---and if so, bombs the 
> installation?  (if "f77 --version == f2c" then die)  I know the 

Bad idea. 

My Debian configuration, driven from a single configuration, is used on
about a dozen different platforms. One of these, m68k, has a continually
been problematic with g77, which forces us to use f2c. 

And despite your fears, that is working swimmingly for R as well as the by
now 40 or so CRAN packages that are in the distro too, incl the ones like
VR, Hmisc/Design, tseries, ... that contain Fortran code.

> problems are not R's fault, but it can percolate into R and it can 
> protect people like myself.

I'd argue that it wasn't f2c's fault, but maybe an unlucky mix of parts of
your toolchain (gcc, binutils, libc, ...).

Anyway, glad to know you have it working. R on amd64 must be nice.

> PS: I am still looking for an R wizard who would be interested in 
> coauthoring an "R cookbook" ala the "perl cookbook" with me...

This must be the third or fourth time that you ask for that. Why don't you
just start the project with a few snippets on an editable wiki (or
collaborate with Detlef Steuer who already set up a wiki for R that is
unused).  The Python Cookbook at O'Reilly was community-driven. And as the
saying goes: those with the greatest itch ...

By the way, you may also enjoy the 'R in Finance' special-interest group we
have going for things closer to your and my financial economics /
econometrisc heart.

Dirk

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From p.dalgaard at biostat.ku.dk  Sat Aug 21 20:20:59 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat Aug 21 20:25:44 2004
Subject: [Rd] Cookbook, was Re: [R] R on gentoo amd64, etc.
In-Reply-To: <20040821135918.973CBEAB9@slim.kubism.ku.dk>
References: <20040821135918.973CBEAB9@slim.kubism.ku.dk>
Message-ID: <x2pt5kmjxw.fsf@biostat.ku.dk>

<ivo_welch-rstat8783@mailblocks.com> writes:

> PS: I am still looking for an R wizard who would be interested in
> coauthoring an "R cookbook" ala the "perl cookbook" with me...

I think I've said it before, but I think such a book ought to coauthor
Paul Johnson, whether or not he does any work beyond the Rtips web
pages. A few of the tips may need a bit of critical review (as I
remember it -- haven't checked recently) and it's likely not quite
complete, but it is still an excellent starting point.

        -p

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From wolski at molgen.mpg.de  Sat Aug 21 22:21:59 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Sat Aug 21 22:22:08 2004
Subject: [Rd] Cookbook, was Re: [R] R on gentoo amd64, etc.
In-Reply-To: <x2pt5kmjxw.fsf@biostat.ku.dk>
References: <20040821135918.973CBEAB9@slim.kubism.ku.dk>
	<x2pt5kmjxw.fsf@biostat.ku.dk>
Message-ID: <200408212221590708.03098A16@mail.math.fu-berlin.de>

Hi!

Paul Johnsons Excellent Rtips page is not listed yet at the Contributed Documentation page.
I am missing a link to Rtips at this page.

I dont think that there are Cookbook neccessary.
 The only difference between the free documentation provided by Paul Johnson and a book for which you have to pay a lot will be a marketing guy.

Sincerely Yours
Eryk



*********** REPLY SEPARATOR  ***********

On 8/21/2004 at 8:20 PM Peter Dalgaard wrote:

><ivo_welch-rstat8783@mailblocks.com> writes:
>
>> PS: I am still looking for an R wizard who would be interested in
>> coauthoring an "R cookbook" ala the "perl cookbook" with me...
>
>I think I've said it before, but I think such a book ought to coauthor
>Paul Johnson, whether or not he does any work beyond the Rtips web
>pages. A few of the tips may need a bit of critical review (as I
>remember it -- haven't checked recently) and it's likely not quite
>complete, but it is still an excellent starting point.
>
>        -p
>
>-- 
>   O__  ---- Peter Dalgaard             Blegdamsvej 3  
>  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
> (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
>~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel



Dipl. bio-chem. Eryk Witold Wolski    @    MPI-Moleculare Genetic   
Ihnestrasse 63-73 14195 Berlin       'v'    
tel: 0049-30-83875219               /   \    
mail: wolski@molgen.mpg.de        ---W-W----    http://www.molgen.mpg.de/~wolski

From bates at stat.wisc.edu  Sun Aug 22 17:23:17 2004
From: bates at stat.wisc.edu (Douglas Bates)
Date: Sun Aug 22 17:25:25 2004
Subject: [Rd] Problem loading library Matrix on Solaris machine
In-Reply-To: <Pine.A41.4.58.0408211944480.14994@e1.hrz.uni-giessen.de>
References: <Pine.LNX.4.44.0408191421270.10774-100000@gannet.stats>
	<Pine.A41.4.58.0408211944480.14994@e1.hrz.uni-giessen.de>
Message-ID: <4128BA65.60502@stat.wisc.edu>

Gerrit Eichner wrote:
> Dear Prof. Ripley,
> 
> thank you for your offer for assistance. Here are some more details from
> our sys admin (who sincerely thanks you for the hint to
> Matrix/src/taucs/taucs.h):
> 
> --- the system administrator says: ---
> 
> Since we don't have a license for the cc compiler anymore I have to use
> gcc. Trying to compile the Matrix package via the Makefile in Matrix/src
> doesn't work as this uses the cc compiler and I don't know how to change
> that in an appropriate way (there is no configure script for example).
> 
> As I don't really understand how R compiles downloaded packages and how
> and where I could change the configuration for that, I tried the following
> dirty hack:
> 
> - added '#define OSTYPE_solaris' in Matrix/src/taucs/taucs.h
> - made a new tarball (Matrix_0.8-10.tar.gz) of the directory Matrix
> - put PACKAGES and Matrix_0.8-10.tar.gz on my own website
> - installed the changed package via
>   > options(CRAN = 'http://my_own_website...')
>   > install.packages("Matrix")
> 
> ... which did the trick. But where should OSTYPE_solaris really be set?
> 
> --- end system administrator ---
> 
> 
> I hope these informations can shed some light onto our problem and assist
> you in tracking down the reason. Thanks again.
> 
>  Best regards  --  Gerrit Eichner
> 
> -------------------------------------------------------------------------
>  AR Dr. Gerrit Eichner                            Mathematical Institute
>  gerrit.eichner@math.uni-giessen.de     Justus-Liebig-University Giessen
>  Tel: +49-(0)641-99-32104            Arndtstr. 2, 35392 Giessen, Germany
>  Fax: +49-(0)641-99-32029      http://www.math.uni-giessen.de/Stochastik
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

The problem stems from my not understanding the configuration of the 
taucs package, which I have included in the Matrix package for one 
routine only.  I configured the taucs package on a Linux machine then 
copied it into Matrix/src/taucs/.

Rather than redoing the taucs package so that it works properly I will 
probably use the LDL' form of the Cholesky decomposition from Tim 
Davis's LDL package and remove taucs entirely.

Watch for a new upload of the Matrix package in the next two days.

From ligges at statistik.uni-dortmund.de  Sun Aug 22 17:31:25 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Aug 22 17:30:27 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
In-Reply-To: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>
References: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>
Message-ID: <4128BC4D.1090204@statistik.uni-dortmund.de>

ligges@statistik.uni-dortmund.de wrote:

> joehl@gmx.de wrote:
> 
> 
>>Dear all, 
>>
>>Our quite basic function mtext() does wrong adjustments in some parameter
>>configurations. This gets obvious when using multi line texts: There is no
>>way to properly adjust text perpendicular to axis 2, for example.
>>
>>Best
>>
>>
>>Jens Oehlschl?gel
>>
>>
>>m <- matrix(1:9, 3)
>>colnames(m) <- c("several\nlines", "several\nlines", "several\nlines")
>>
>>par(mfrow=c(2,2))
>>barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=0.5 is
>>fine")
>>mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=0.5)
>>barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=1 is
>>different")
>>mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=1)
>>barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=1 adj=0.5 is
>>NOT fine")
>>mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=0.5)
>>barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="at las=1, adj=1
>>works the wrong direction", sub="no way to get adj=c(1, 0.5) with las=1 (or
>>2)")
>>mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=1)
>>par(mfrow=c(1,1))
>>
> 
> 
> Left / right adjustemnt seems to be perfectly OK.
> The thing that matters is centering "several lines" to the specified 
> ("at=") location.
> In fact, mtext() is not centering but bottom-aligning by adding a 
> negative distance that looks OK for one line in the default font size, 
> but not in most other cases.
> 
> Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment of 
> perpendicular text"). Fixing this, and/or improving mtext()'s "adj" 
> argument to accept 2 dimensions is desirable, but might be not that 
> easy... I'll take a look during the next days, but nothing promised.
> 
> Uwe Ligges


Having looked into the code, there are three possible solution (all with
some drawbacks) I can see. Well, the current argument "adj" becomes
"xadj" in the C sources (graphics.c, GMtext), and "yadj" is set to 0. 
Hence the ugly hard coded LineBias of 0.3.


Solutions
=========
1: Hardcode "yadj" to 0.5 and remove all those 0.3 biases. Looks good 
for axes, but it might break some code --> bad.
On the other hand, GMMathText has hardcoded yadj=0.5. Is there a problem 
with some special devices? Or any other reason not to center stuff using 
"adj=0.5"?

2: Allow the typical 2-value adj, take the first as xadj, the second one
as yadj. This might break some code, because currently adj of
arbitrary length (!=0) is allowed and recycled.

3: Invent an argument "padj" for mtext() that represents adjustment
*p*erpendicular to the text direction and gets mapped to "yadj" in
GMtext. In that case the hardcoded 0.3 bias mentioned above can be
removed. The question is whether to set the default to 0.5 (will still
break code, but easily to fix by setting padj to 0).

I'd like to propose the third solution and would be happy to provide a
patch of GMText, including corresponding patches to GMMathText, as well 
as mtext(), title() and axis() (and their inderlying do_* components).

Are there any objections? Any reasons not to do it?

Uwe Ligges



> 
> 
> 
>>>version
>>
>>         _              
>>platform i386-pc-mingw32
>>arch     i386           
>>os       mingw32        
>>system   i386, mingw32  
>>status                  
>>major    1              
>>minor    9.1            
>>year     2004           
>>month    06             
>>day      21             
>>language R   
>>
>>
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Mon Aug 23 13:33:56 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug 23 13:34:08 2004
Subject: [Rd] Re: [R] Installing R on DEC Alpha - problems with dynamic
	loading
In-Reply-To: <BAF5C0B1B1FE5A41B28C71CC977422E904964776@ukapphresmsx01.ukapd.astrazeneca.net>
Message-ID: <Pine.LNX.4.44.0408231216540.15116-100000@gannet.stats>

The line in the script as distributed is

   unloadNamespace("splines")

That is not the same thing at all.  Please confirm that you actually have
a problem with that form.  (Your examples should not work, and do not work
for me.)  If you do, it is likely that your system's dlclose is
non-standard/broken.  However, unloadNamespace is not normally used so it
may be that this does not impact your users.

Please read the posting guide: this is not an appropriate question for 
R-help so I have diverted it to R-devel.


On Mon, 23 Aug 2004, Firth, Mike A (ALDP) wrote:

> I have recently installed R on DEC Alpha OSF 5.1.
> 
> The first regression test (reg-test-1.R) failed with an unresolved symbol in
> lapack.so:
> 
> 2246839:/data/h1/bifdev/apps/wga/R-1.9.1/bin/R.bin: /sbin/loader: Fatal
> Error: call to unresolved symbol from
> /data/h1/bifdev/apps/wga/R-1.9.1/modules/lapack.so (pc=0x3ffbfe22b60)
> 
> Further investigation has revealed that there is NO problem with lapack.so.
> The problem seems to lie in the use of 'unloadNamespace' earlier in the
> script.
> 
> On our machine the following line:
> 
> 	unloadNamespace(splines)
> 
> seem to really confuse the dynamic linking/symbol resolution. I have a very
> small example to demonstrate:
> 
> 	data(iris)
> 	library(splines)
> 	unloadNamespace(splines)
> 	data(iris)
> 
> works fine, but:
> 
> 	library(splines)
> 	unloadNamespace(splines)
> 	data(iris)
> 
> falls over with:
> 
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>         unable to load shared library
> "/data/h1/bifdev/apps/wga/R-1.9.1/library/tools/libs/tools.so":
>   dlopen: /data/h1/bifdev/apps/wga/R-1.9.1/library/stats/libs/stats.so:
> symbol "bdrsplerr_" unresolved
> Execution halted
> 
> The unloadNamespace has effectively unloaded a symbol from a completely
> different shared object.
> 
> Can anybody shed any light on this problem?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From bjg at network-theory.co.uk  Mon Aug 23 14:45:19 2004
From: bjg at network-theory.co.uk (bjg@network-theory.co.uk)
Date: Mon Aug 23 14:45:25 2004
Subject: [Rd] corrections for R-intro.texi (PR#7192)
Message-ID: <20040823124519.8C29A10421@slim.kubism.ku.dk>

Hello,

Here are some patches for R-intro.texi, to correct various typos,
missing words, and minor inconsistencies in formatting.

Each patch is preceeded by its corresponding 'wdiff' output to make it
easier to see which words have changed.

-- 
Brian Gough

Network Theory Ltd,
Publishing the R Reference Manuals --- http://www.network-theory.co.uk/R/

======================================================================
 {+the+}
======================================================================
 [-pch="+",xlab="x",-] {+pch="+", xlab="x",+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:43 2004
+++ R-intro.texi	Mon Aug 23 13:23:43 2004
@@ -6026,7 +6026,7 @@
 the reduction factor is 0.66.
 
 @item mfg=c(2, 2, 3, 2)
-Position of current figure in a multiple figure environment.  The first
+Position of the current figure in a multiple figure environment.  The first
 two numbers are the row and column of the current figure; the last two
 are the number of rows and columns in the multiple figure array.  Set
 this parameter to jump between figures in the array.  You can even use
@@ -6574,7 +6574,7 @@
 @item w <- ifelse(Mod(w) > 1, 1/w, w)
 @dots{} and to map any outside the circle onto their reciprocal.
 
-@item plot(w, xlim=c(-1,1), ylim=c(-1,1), pch="+",xlab="x", ylab="y")
+@item plot(w, xlim=c(-1,1), ylim=c(-1,1), pch="+", xlab="x", ylab="y")
 @itemx lines(z)
 @itemx
 All points are inside the unit circle, but the distribution is not

======================================================================
 {+the+}
======================================================================
 {+a+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:43 2004
+++ R-intro.texi	Mon Aug 23 13:23:43 2004
@@ -6010,7 +6010,7 @@
 @table @code
 @item mfcol=c(3, 2)
 @itemx mfrow=c(2, 4)
-Set size of multiple figure array.  The first value is the number of
+Set the size of a multiple figure array.  The first value is the number of
 rows; the second is the number of columns.  The only difference between
 these two parameters is that setting @code{mfcol} causes figures to be
 filled by column; @code{mfrow} fills by rows.

======================================================================
 [-least.)-] {+least).+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:44 2004
+++ R-intro.texi	Mon Aug 23 13:23:44 2004
@@ -5952,7 +5952,7 @@
 
 Setting this parameter to @code{"d"} (direct axis) @emph{locks in} the
 current axis and uses it for all future plots (or until the parameter is
-set to one of the other values above, at least.) Useful for generating
+set to one of the other values above, at least). Useful for generating
 series of fixed-scale plots.
 @end table
 

======================================================================
 [-x1+x2,-] {+x1 + x2,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:44 2004
+++ R-intro.texi	Mon Aug 23 13:23:44 2004
@@ -4766,7 +4766,7 @@
 achieves the same result as
 
 @example
-> fm <- lm(y ~ x1+x2, data=sales)
+> fm <- lm(y ~ x1 + x2, data=sales)
 @end example
 
 @noindent

======================================================================
 [-but-] {+(but+}
======================================================================
 [-optional-] {+optional)+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:44 2004
+++ R-intro.texi	Mon Aug 23 13:23:44 2004
@@ -4383,7 +4383,7 @@
 would fit a multiple regression model of @math{y} on @math{x1} and
 @math{x2} (with implicit intercept term).
 
-The important but technically optional parameter @code{data =
+The important (but technically optional) parameter @code{data =
 production} specifies that any variables needed to construct the model
 should come first from the @code{production} @emph{data frame}.
 @emph{This is the case regardless of whether data frame

======================================================================

{+the+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:45 2004
+++ R-intro.texi	Mon Aug 23 13:23:45 2004
@@ -3967,7 +3967,7 @@
 
 The location of the site initialization file is taken from the value of
 the @env{R_PROFILE} environment variable.  If that variable is unset,
-file @file{Rprofile.site} in the @R{} home subdirectory @file{etc} is
+the file @file{Rprofile.site} in the @R{} home subdirectory @file{etc} is
 used.  This file should contain the commands that you want to execute
 every time @R{} is started under your system.  A second, personal,
 profile file named @file{.Rprofile}@footnote{So it is hidden under

======================================================================
 [-(it-] {+(if it+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:46 2004
+++ R-intro.texi	Mon Aug 23 13:23:46 2004
@@ -3090,7 +3090,7 @@
 @end example
 
 @noindent
-which will usually (it is a random sample) show longer tails than
+which will usually (if it is a random sample) show longer tails than
 expected for a normal.  We can make a Q-Q plot against the generating
 distribution by
 

======================================================================
  [-Standard-]  {+The standard+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:46 2004
+++ R-intro.texi	Mon Aug 23 13:23:46 2004
@@ -3100,7 +3100,7 @@
 @end example
 
 Finally, we might want a more formal test of agreement with normality
-(or not).  Standard package @pkg{stats} provides the Shapiro-Wilk test
+(or not).  The standard package @pkg{stats} provides the Shapiro-Wilk test
 @cindex Shapiro-Wilk test
 @findex shapiro.test
 

======================================================================

{+>+}
======================================================================

{+>+}
======================================================================

{+>+}
======================================================================

{+>+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:46 2004
+++ R-intro.texi	Mon Aug 23 13:23:46 2004
@@ -3071,8 +3071,8 @@
 @findex qqline
 
 @example
-par(pty="s")
-qqnorm(long); qqline(long)
+> par(pty="s")
+> qqnorm(long); qqline(long)
 @end example
 
 @noindent
@@ -3085,8 +3085,8 @@
 @end iftex
 
 @example
-x <- rt(250, df = 5)
-qqnorm(x); qqline(x)
+> x <- rt(250, df = 5)
+> qqnorm(x); qqline(x)
 @end example
 
 @noindent

======================================================================
 {+the+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:46 2004
+++ R-intro.texi	Mon Aug 23 13:23:46 2004
@@ -3040,7 +3040,7 @@
 @image{images/hist,9cm}
 @end iftex
 
-We can plot the empirical cumulative distribution function by using
+We can plot the empirical cumulative distribution function by using the
 function @code{ecdf} in the standard package @pkg{stepfun}.
 @findex ecdf
 @cindex Empirical CDFs

======================================================================
 {+are+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:47 2004
+++ R-intro.texi	Mon Aug 23 13:23:47 2004
@@ -1755,7 +1755,7 @@
 > dim(Z) <- c(3,4,2)
 @end example
 
-However if @code{h} is shorter than 24, its values recycled from the
+However if @code{h} is shorter than 24, its values are recycled from the
 beginning again to make it up to size 24 (@pxref{The recycling rule}).
 As an extreme but common example
 

======================================================================
 [-input.  (See-] {+input (see+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:47 2004
+++ R-intro.texi	Mon Aug 23 13:23:47 2004
@@ -1296,7 +1296,7 @@
 mode of the object in the first place.
 
 This automatic adjustment of lengths of an object is used often, for
-example in the @code{scan()} function for input.  (See @ref{The scan()
+example in the @code{scan()} function for input (see @ref{The scan()
 function}.)
 
 Conversely to truncate the size of an object requires only an assignment

======================================================================

[-no-]
{+not+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:47 2004
+++ R-intro.texi	Mon Aug 23 13:23:47 2004
@@ -1058,7 +1058,7 @@
 
 @noindent
 selects the first 10 elements of @code{x} (assuming @code{length(x)} is
-no less than 10).  Also
+not less than 10).  Also
 
 @example
 > c("x","y")[rep(c(1,2,2,1), times=4)]

======================================================================
 [-allows to collapse-] {+joins+}
======================================================================
 [-string-] {+string,+}
======================================================================
 [-between, and
there-] {+between.
There+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:47 2004
+++ R-intro.texi	Mon Aug 23 13:23:47 2004
@@ -999,9 +999,9 @@
 Note particularly that recycling of short lists takes place here too;
 thus @code{c("X", "Y")} is repeated 5 times to match the sequence
 @code{1:10}.
-@footnote{@code{paste(..., collapse=@var{ss})} allows to collapse the
-arguments into a single character string putting @var{ss} in between, and
-there are more tools for character manipulation, see the help
+@footnote{@code{paste(..., collapse=@var{ss})} joins the
+arguments into a single character string, putting @var{ss} in between.
+There are more tools for character manipulation, see the help
 for @code{sub} and @code{substring}.}
 
 @node Index vectors, Other types of objects, Character vectors, Simple manipulations numbers and vectors

======================================================================
 {+are+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:47 2004
+++ R-intro.texi	Mon Aug 23 13:23:48 2004
@@ -1022,7 +1022,7 @@
 @strong{A logical vector}.  In this case the index vector must be of the
 same length as the vector from which elements are to be selected.
 Values corresponding to @code{TRUE} in the index vector are selected and
-those corresponding to @code{FALSE} omitted.  For example
+those corresponding to @code{FALSE} are omitted.  For example
 
 @example
 > y <- x[!is.na(x)]

======================================================================
 [-vectors-] {+vector+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:48 2004
+++ R-intro.texi	Mon Aug 23 13:23:48 2004
@@ -853,7 +853,7 @@
 @section Logical vectors
 
 As well as numerical vectors, @R{} allows manipulation of logical
-quantities.  The elements of a logical vectors can have the values
+quantities.  The elements of a logical vector can have the values
 @code{TRUE}, @code{FALSE}, and @code{NA} (for ``not available'', see
 below).  The first two are often abbreviated as @code{T} and @code{F},
 respectively.  Note however that @code{T} and @code{F} are just

======================================================================
 [-in-]
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:48 2004
+++ R-intro.texi	Mon Aug 23 13:23:48 2004
@@ -2760,7 +2760,7 @@
 @section The @code{scan()} function
 @findex scan
 
-Suppose the data vectors are of equal length and are to be read in in
+Suppose the data vectors are of equal length and are to be read in
 parallel.  Further suppose that there are three vectors, the first of
 mode character and the remaining two of mode numeric, and the file is
 @file{input.dat}.  The first step is to use @code{scan()} to read in the

======================================================================
 [-the-]
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:48 2004
+++ R-intro.texi	Mon Aug 23 13:23:48 2004
@@ -1045,7 +1045,7 @@
 
 @item
 @strong{A vector of positive integral quantities}.  In this case the
-values in the index vector must lie in the the set @{1, 2, @dots{},
+values in the index vector must lie in the set @{1, 2, @dots{},
 @code{length(x)}@}.  The corresponding elements of the vector are
 selected and concatenated, @emph{in that order}, in the result.  The
 index vector can be of any length and the result is of the same length

======================================================================
 [-modelling,-] {+modeling,+}
======================================================================
 [-colours-] {+colors+}
======================================================================
 [-Unix-alikes-] {+Unix-like systems+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:48 2004
+++ R-intro.texi	Mon Aug 23 13:23:48 2004
@@ -93,7 +93,7 @@
 statistical computing and graphics.  R is similar to the award-winning S
 system, which was developed at Bell Laboratories by John Chambers et al.
 It provides a wide variety of statistical and graphical techniques
-(linear and nonlinear modelling, statistical tests, time series
+(linear and nonlinear modeling, statistical tests, time series
 analysis, classification, clustering, ...).
 
 This manual provides information on data types, programming elements,
@@ -5427,7 +5427,7 @@
 @findex contour
 @findex persp
 Plots of three variables.  The @code{image} plot draws a grid of rectangles
-using different colours to represent the value of @code{z}, the @code{contour}
+using different colors to represent the value of @code{z}, the @code{contour}
 plot draws contour lines to represent the value of @code{z}, and the
 @code{persp} plot draws a 3D surface.
 @end table
@@ -6084,7 +6084,7 @@
 @table @code
 @item X11()
 @findex X11
-For use with the X11 window system on Unix-alikes
+For use with the X11 window system on Unix-like systems
 @item windows()
 @findex windows
 For use on Windows

======================================================================
 {+the+}
======================================================================
 {+the+}
======================================================================
 {+the+}
======================================================================
 [-command,-] {+the command line,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:49 2004
+++ R-intro.texi	Mon Aug 23 13:23:49 2004
@@ -7027,9 +7027,9 @@
 @item C-d
 Delete the character under the cursor.
 @item M-d
-Delete rest of the word under the cursor, and ``save'' it.
+Delete the rest of the word under the cursor, and ``save'' it.
 @item C-k
-Delete from cursor to end of command, and ``save'' it.
+Delete from the cursor to the end of the command line, and ``save'' it.
 @item C-y
 Insert (yank) the last ``saved'' text here.
 @item C-t

======================================================================
 {+the+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:49 2004
+++ R-intro.texi	Mon Aug 23 13:23:49 2004
@@ -7021,7 +7021,7 @@
 @item @var{text}
 Insert @var{text} at the cursor.
 @item C-f @var{text}
-Append @var{text} after cursor.
+Append @var{text} after the cursor.
 @item @key{DEL}
 Delete the previous character (left of the cursor).
 @item C-d

======================================================================
 {+the+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:50 2004
+++ R-intro.texi	Mon Aug 23 13:23:50 2004
@@ -6931,7 +6931,7 @@
 When the @acronym{GNU} @strong{readline} library is available at the
 time @R{} is configured for compilation under UNIX, an inbuilt command
 line editor allowing recall, editing and re-submission of prior commands
-is used.  Note: this appendix does @strong{not} apply to @acronym{GNOME}
+is used.  Note: this appendix does @strong{not} apply to the @acronym{GNOME}
 interface under UNIX, only to the standard command-line interface.
 
 It can be disabled (useful for usage with @acronym{ESS}@footnote{The

======================================================================
 [-plot, if-] {+plot. If+}
======================================================================
 [-produce-] {+produces+}
======================================================================
 [-vector, and if-] {+vector. If+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:50 2004
+++ R-intro.texi	Mon Aug 23 13:23:50 2004
@@ -5297,9 +5297,9 @@
 containing two elements @var{x} and @var{y} or a two-column matrix.
 
 @item plot(@var{x})
-If @var{x} is a time series, this produces a time-series plot, if
-@var{x} is a numeric vector, it produce a plot of the values in the
-vector against their index in the vector, and if @var{x} is a complex
+If @var{x} is a time series, this produces a time-series plot. If
+@var{x} is a numeric vector, it produces a plot of the values in the
+vector against their index in the vector. If @var{x} is a complex
 vector, it produces a plot of imaginary versus real parts of the vector
 elements.
 

======================================================================
  [-Fitting, for-]  {+For+}
======================================================================
 {+fitting a+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:50 2004
+++ R-intro.texi	Mon Aug 23 13:23:50 2004
@@ -4356,9 +4356,9 @@
 
 Although the details are complicated, model formulae in @R{} will
 normally generate the models that an expert statistician would expect,
-provided that marginality is preserved.  Fitting, for example, model with
-interaction but not the corresponding main effects will in general lead
-to surprising results, and is for experts only.
+provided that marginality is preserved.  For example, fitting a model
+with interaction but not the corresponding main effects will in general
+lead to surprising results, and is for experts only.
 
 
 @node Linear models, Generic functions for extracting model information, Formulae for statistical models, Statistical models in R

======================================================================
 [-than-] {+then+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:50 2004
+++ R-intro.texi	Mon Aug 23 13:23:50 2004
@@ -3975,7 +3975,7 @@
 directory then that file will be sourced.  This file gives individual
 users control over their workspace and allows for different startup
 procedures in different working directories.  If no @file{.Rprofile}
-file is found in the startup directory, than @R{} looks for a
+file is found in the startup directory, then @R{} looks for a
 @file{.Rprofile} file in the user's home directory and uses that (if it
 exists).
 

======================================================================
 [-in the example below.-] {+below:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:51 2004
+++ R-intro.texi	Mon Aug 23 13:23:51 2004
@@ -3653,7 +3653,7 @@
 graphical output.  (@xref{The par() function}, for more details on the
 @code{par()} function.)  This can be done by including an extra
 argument, literally @samp{@dots{}}, of the function, which may then be
-passed on.  An outline example is given in the example below.
+passed on.  An outline example is given below:
 
 @example
 fun1 <- function(data, data.frame, graph=TRUE, limit=20, ...) @{

======================================================================
 {+as+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:51 2004
+++ R-intro.texi	Mon Aug 23 13:23:51 2004
@@ -2686,7 +2686,7 @@
 in the data frame.
 
 @item
-Each additional line of the file has its first item a @emph{row label}
+Each additional line of the file has as its first item a @emph{row label}
 and the values for each variable.
 @end itemize
 

======================================================================


[-However-]
{+@noindent
However,+}
======================================================================

{+@noindent+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:51 2004
+++ R-intro.texi	Mon Aug 23 13:23:51 2004
@@ -2531,8 +2531,8 @@
 @example
 > lentils$u <- v+w
 @end example
-
-However the new value of component @code{u} is not visible until the
+@noindent
+However, the new value of component @code{u} is not visible until the
 data frame is detached and attached again.
 
 To detach a data frame, use the function
@@ -2540,7 +2540,7 @@
 @example
 > detach()
 @end example
-
+@noindent
 More precisely, this statement detaches from the search path the entity
 currently at @w{position 2}.  Thus in the present context the variables
 @code{u}, @code{v} and @code{w} would be no longer visible, except under

======================================================================
 [-@code{1}s-] {+ones+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:51 2004
+++ R-intro.texi	Mon Aug 23 13:23:52 2004
@@ -2203,7 +2203,7 @@
 
 Suppose @code{X1} and @code{X2} have the same number of rows.  To
 combine these by columns into a matrix @code{X}, together with an
-initial column of @code{1}s we can use
+initial column of ones we can use
 
 @example
 > X <- cbind(1, X1, X2)

======================================================================
 [-argument, possibly-] {+arguments (possibly+}
======================================================================
 [-extended,-] {+extended)+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:52 2004
+++ R-intro.texi	Mon Aug 23 13:23:52 2004
@@ -2198,7 +2198,7 @@
 of the longest vector if no matrices are given).
 
 The function @code{rbind()} does the corresponding operation for rows.
-In this case any vector argument, possibly cyclically extended, are of
+In this case any vector arguments (possibly cyclically extended) are of
 course taken as row vectors.
 
 Suppose @code{X1} and @code{X2} have the same number of rows.  To

======================================================================
 [-0s.-] {+zero.+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:52 2004
+++ R-intro.texi	Mon Aug 23 13:23:52 2004
@@ -1665,7 +1665,7 @@
 Extract elements @code{X[1,3]}, @code{X[2,2]} and @code{X[3,1]} as a
 vector structure, and
 @item
-Replace these entries in the array @code{X} by 0s.
+Replace these entries in the array @code{X} by zero.
 @end itemize
 In this case we need a @math{3} by @math{2} subscript array, as in the
 following example.

======================================================================
 {+a specific example.+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:52 2004
+++ R-intro.texi	Mon Aug 23 13:23:52 2004
@@ -1386,7 +1386,7 @@
 classification (grouping) of the components of other vectors of the same length.
 @R{} provides both @emph{ordered} and @emph{unordered} factors.
 While the ``real'' application of factors is with model formulae
-(@pxref{Contrasts}), we here look at
+(@pxref{Contrasts}), we here look at a specific example.
 
 @section A specific example
 

======================================================================

{+@noindent+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:53 2004
+++ R-intro.texi	Mon Aug 23 13:23:53 2004
@@ -372,7 +372,7 @@
 > help(solve)
 @end example
 @findex help
-
+@noindent
 An alternative is
 
 @example

======================================================================
 [-Tree based-] {+Tree-based+}
======================================================================

[-@strong{Tree based-]
{+@strong{Tree-based+}
======================================================================
 [-tree based-] {+tree-based+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:53 2004
+++ R-intro.texi	Mon Aug 23 13:23:53 2004
@@ -5187,9 +5187,9 @@
 @c  newer functions.
 
 @item
-@cindex Tree based models
-@strong{Tree based models.} Rather than seek an explicit global linear
-model for prediction or interpretation, tree based models seek to
+@cindex Tree-based models
+@strong{Tree-based models.} Rather than seek an explicit global linear
+model for prediction or interpretation, tree-based models seek to
 bifurcate the data, recursively, at critical points of the determining
 variables in order to partition the data ultimately into groups that are
 as homogeneous as possible within, and as heterogeneous as possible

======================================================================
 [-low level-] {+low-level+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:53 2004
+++ R-intro.texi	Mon Aug 23 13:23:53 2004
@@ -2163,7 +2163,7 @@
 It is not assumed that @code{X} has full column rank.  Redundancies will
 be discovered and removed as they are found.
 
-This alternative is the older, low level way to perform least squares
+This alternative is the older, low-level way to perform least squares
 calculations.  Although still useful in some contexts, it would now
 generally be replaced by the statistical models features, as will be
 discussed in @ref{Statistical models in R}.

======================================================================
 [-(top level)-] {+(top-level)+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:53 2004
+++ R-intro.texi	Mon Aug 23 13:23:53 2004
@@ -2329,7 +2329,7 @@
 its first entry.
 
 If @code{Lst} is a list, then the function @code{length(Lst)} gives the
-number of (top level) components it has.
+number of (top-level) components it has.
 
 Components of lists may also be @emph{named}, and in this case the
 component may be referred to either by giving the component name as a

======================================================================
 [-two way-] {+two-way+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:54 2004
+++ R-intro.texi	Mon Aug 23 13:23:54 2004
@@ -2248,7 +2248,7 @@
 @cindex Tabulation
 
 Recall that a factor defines a partition into groups.  Similarly a pair
-of factors defines a two way cross classification, and so on.
+of factors defines a two-way cross classification, and so on.
 @findex table
 The function @code{table()} allows frequency tables to be calculated
 from equal length factors.  If there are @math{k} category arguments,

======================================================================
 [-element by element-] {+element-by-element+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:54 2004
+++ R-intro.texi	Mon Aug 23 13:23:54 2004
@@ -1772,7 +1772,7 @@
 subscript stands for the entire array as an array.
 
 Arrays may be used in arithmetic expressions and the result is an array
-formed by element by element operations on the data vector.  The
+formed by element-by-element operations on the data vector.  The
 @code{dim} attributes of operands generally need to be the same, and
 this becomes the dimension vector of the result.  So if @code{A},
 @code{B} and @code{C} are all similar arrays, then

======================================================================
 [-one dimensional-] {+one-dimensional+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:54 2004
+++ R-intro.texi	Mon Aug 23 13:23:54 2004
@@ -3790,7 +3790,7 @@
 are not inherited by called functions in higher evaluation frames as
 they would be if they were on the search path.
 
-The example below shows a naive way of performing one dimensional
+The example below shows a naive way of performing one-dimensional
 numerical integration.  The integrand is evaluated at the end points of
 the range and in the middle.  If the one-panel trapezium rule answer is
 close enough to the two panel, then the latter is returned as the value.

======================================================================
 [-plots,-] {+plots+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:55 2004
+++ R-intro.texi	Mon Aug 23 13:23:55 2004
@@ -6547,7 +6547,7 @@
 
 @item image(x, y, f)
 @itemx image(x, y, fa)
-Make some high density image plots, (of which you can get
+Make some high density image plots (of which you can get
 hardcopies if you wish), @dots{}
 
 @item objects(); rm(x, y, f, fa)

======================================================================
 [-@math{x}-] {+@math{x},+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:55 2004
+++ R-intro.texi	Mon Aug 23 13:23:55 2004
@@ -6421,7 +6421,7 @@
 
 @item fm <- lm(y ~ x, data=dummy)
 @itemx summary(fm)
-Fit a simple linear regression of @math{y} on @math{x} and look at the
+Fit a simple linear regression of @math{y} on @math{x}, and look at the
 analysis.
 
 @item fm1 <- lm(y ~ x, data=dummy, weight=1/w^2)

======================================================================
 [-dotchart-] {+dotchart,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:55 2004
+++ R-intro.texi	Mon Aug 23 13:23:55 2004
@@ -5415,7 +5415,7 @@
 
 @item dotchart(x, @dots{})
 @findex dotchart
-Constructs a dotchart of the data in @code{x}.  In a dotchart the
+Constructs a dotchart of the data in @code{x}.  In a dotchart, the
 @math{y}-axis gives a labelling of the data in @code{x} and the
 @math{x}-axis gives its value.  For example it allows easy visual
 selection of all data entries with values lying in specified ranges.

======================================================================
 [-graphs-] {+graphs,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:56 2004
+++ R-intro.texi	Mon Aug 23 13:23:56 2004
@@ -5213,7 +5213,7 @@
 
 Graphical facilities are an important and extremely versatile component
 of the @R{} environment.  It is possible to use the facilities to
-display a wide variety of statistical graphs and also to build entirely
+display a wide variety of statistical graphs, and also to build entirely
 new types of graph.
 
 The graphics facilities can be used in both interactive and batch modes, but in

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:56 2004
+++ R-intro.texi	Mon Aug 23 13:23:56 2004
@@ -4908,7 +4908,7 @@
 For all families the variance of the response will depend on the mean
 and will have the scale parameter as a multiplier.  The form of
 dependence of the variance on the mean is a characteristic of the
-response distribution; for example for the poisson distribution
+response distribution; for example, for the poisson distribution
 @eqn{\hbox{Var}[y] = \mu,Var(y) = mu}.
 
 For quasi-likelihood estimation and inference the precise response

======================================================================
 [-families-] {+families,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:56 2004
+++ R-intro.texi	Mon Aug 23 13:23:56 2004
@@ -4905,7 +4905,7 @@
 
 @subsubheading Quasi-likelihood models
 
-For all families the variance of the response will depend on the mean
+For all families, the variance of the response will depend on the mean
 and will have the scale parameter as a multiplier.  The form of
 dependence of the variance on the mean is a characteristic of the
 response distribution; for example, for the poisson distribution

======================================================================


[-Occasionally-]

{+Occasionally,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:56 2004
+++ R-intro.texi	Mon Aug 23 13:23:56 2004
@@ -4892,7 +4892,7 @@
 further here.  It even forms a major part of the use of non-gaussian
 generalized models overall.
 
-Occasionally genuinely Poisson data arises in practice and in the past
+Occasionally, genuinely Poisson data arises in practice and in the past
 it was often analyzed as gaussian data after either a log or a
 square-root transformation.  As a graceful alternative to the latter, a
 Poisson generalized linear model may be fitted as in the following

======================================================================
 [-default-] {+default,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:57 2004
+++ R-intro.texi	Mon Aug 23 13:23:57 2004
@@ -4864,7 +4864,7 @@
 > fml <- glm(Ymat ~ x, family = binomial, data = kalythos)
 @end example
 
-Since the logit link is the default the parameter may be omitted on the
+Since the logit link is the default, the parameter may be omitted on the
 second call.  To see the results of each fit we could use
 
 @example

======================================================================
 [-experiments-] {+experiments,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:57 2004
+++ R-intro.texi	Mon Aug 23 13:23:57 2004
@@ -4522,7 +4522,7 @@
 Hence only for orthogonal experiments will the order of inclusion be
 inconsequential.
 
-For multistratum experiments the procedure is first to project the
+For multistratum experiments, the procedure is first to project the
 response onto the error strata, again in sequence, and to fit the mean
 model to each projection.  For further details, see Chambers & Hastie
 (1992).

======================================================================
 [-terms-] {+terms,+}
======================================================================
 {+as+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:58 2004
+++ R-intro.texi	Mon Aug 23 13:23:58 2004
@@ -4114,7 +4114,7 @@
    \qquad i = 1, @dots{}, n
 $$
 @end tex
-In matrix terms this would be written
+In matrix terms, this would be written as
 
 @ifnottex
 @display

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:58 2004
+++ R-intro.texi	Mon Aug 23 13:23:58 2004
@@ -4051,7 +4051,7 @@
 @end example
 
 Conversely the number of classes a generic function can handle can also
-be quite large.  For example the @code{plot()} function has a default
+be quite large.  For example, the @code{plot()} function has a default
 method and variants for objects of classes @code{"data.frame"},
 @code{"density"}, @code{"factor"}, and more.  A complete list can be got
 again by using the @code{methods()} function:

======================================================================
 [-form-] {+form,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:58 2004
+++ R-intro.texi	Mon Aug 23 13:23:58 2004
@@ -3743,7 +3743,7 @@
 @subsection Dropping all names in a printed array
 
 For printing purposes with large matrices or arrays, it is often useful
-to print them in close block form without the array names or numbers.
+to print them in close block form, without the array names or numbers.
 Removing the @code{dimnames} attribute will not achieve this effect, but
 rather the array must be given a @code{dimnames} attribute consisting of
 empty strings.  For example to print a matrix, @code{X}

======================================================================
 [-temporary-] {+temporary,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:59 2004
+++ R-intro.texi	Mon Aug 23 13:23:59 2004
@@ -3668,7 +3668,7 @@
 @section Assignments within functions
 
 Note that @emph{any ordinary assignments done within the function are
-local and temporary and are lost after exit from the function}.  Thus
+local and temporary, and are lost after exit from the function}.  Thus
 the assignment @code{X <- qr(X)} does not affect the value of the
 argument in the calling program.
 

======================================================================
 [-cases-] {+cases,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:23:59 2004
+++ R-intro.texi	Mon Aug 23 13:23:59 2004
@@ -3613,7 +3613,7 @@
 @noindent
 are all equivalent.
 
-In many cases arguments can be given commonly appropriate default
+In many cases, arguments can be given commonly appropriate default
 values, in which case they may be omitted altogether from the call when
 the defaults are appropriate.  For example, if @code{fun1} were defined
 as

======================================================================


[-Thus-]

{+Thus,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:00 2004
+++ R-intro.texi	Mon Aug 23 13:24:00 2004
@@ -3593,7 +3593,7 @@
 may begin in the unnamed, positional form, and specify named arguments
 after the positional arguments.
 
-Thus if there is a function @code{fun1} defined by
+Thus, if there is a function @code{fun1} defined by
 
 @example
 > fun1 <- function(data, data.frame, graph, limit) @{

======================================================================
  [-Furthermore-]  {+Furthermore,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:00 2004
+++ R-intro.texi	Mon Aug 23 13:24:00 2004
@@ -3589,7 +3589,7 @@
 
 As first noted in @ref{Generating regular sequences}, if arguments to
 called functions are given in the ``@code{@var{name}=@var{object}}''
-form, they may be given in any order.  Furthermore the argument sequence
+form, they may be given in any order.  Furthermore, the argument sequence
 may begin in the unnamed, positional form, and specify named arguments
 after the positional arguments.
 

======================================================================
 [-created-] {+created,+}
======================================================================
 [-permanent, like all objects,-] {+permanent+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:01 2004
+++ R-intro.texi	Mon Aug 23 13:24:01 2004
@@ -3534,8 +3534,8 @@
 @}
 @end example
 
-After this object is created it is permanent, like all objects, and may
-be used in statements such as
+After this object is created, it is permanent and may be used in
+statements such as
 
 @example
 > regcoeff <- bslash(Xmat, yvar)

======================================================================

[-default-]
{+default,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:01 2004
+++ R-intro.texi	Mon Aug 23 13:24:01 2004
@@ -3199,7 +3199,7 @@
 
 @noindent
 which does indicate a significant difference, assuming normality.  By
-default the @R{} function does not assume equality of variances in the
+default, the @R{} function does not assume equality of variances in the
 two samples (in contrast to the similar @SPLUS{} @code{t.test}
 function).  We can use the F test to test for equality in the variances,
 provided that the two samples are from normal populations.

======================================================================
 [-samples.-] {+samples,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:02 2004
+++ R-intro.texi	Mon Aug 23 13:24:02 2004
@@ -3152,7 +3152,7 @@
 @end example
 
 @noindent
-Boxplots provide a simple graphical comparison of the two samples.
+Boxplots provide a simple graphical comparison of the two samples,
 
 @c NOTE scan() from stdin is not parse()able, hence not source()able
 @c Hence ./R-intro.R uses c(..)

======================================================================
 [-test-] {+test,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:02 2004
+++ R-intro.texi	Mon Aug 23 13:24:02 2004
@@ -3114,7 +3114,7 @@
 @end example
 
 @noindent
-and the Kolmogorov-Smirnov test
+and the Kolmogorov-Smirnov test,
 @cindex Kolmogorov-Smirnov test
 @findex ks.test
 

======================================================================
 [-data-] {+data,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:03 2004
+++ R-intro.texi	Mon Aug 23 13:24:03 2004
@@ -2974,7 +2974,7 @@
 @node  Examining the distribution of a set of data, One- and two-sample tests, R as a set of statistical tables, Probability distributions
 @section Examining the distribution of a set of data
 
-Given a (univariate) set of data we can examine its distribution in a
+Given a (univariate) set of data, we can examine its distribution in a
 large number of ways.  The simplest is to examine the numbers.  Two
 slightly different summaries are given by @code{summary} and
 @code{fivenum}

======================================================================
 [-addition-] {+addition,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:03 2004
+++ R-intro.texi	Mon Aug 23 13:24:03 2004
@@ -2958,7 +2958,7 @@
 or more accurate log-likelihoods (by @code{d@var{xxx}(..., log =
 TRUE)}), directly.
 
-In addition there are functions @code{ptukey} and @code{qtukey} for the
+In addition, there are functions @code{ptukey} and @code{qtukey} for the
 distribution of the studentized range of samples from a normal
 distribution.
 

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:03 2004
+++ R-intro.texi	Mon Aug 23 13:24:04 2004
@@ -2780,7 +2780,7 @@
 @end example
 
 More conveniently, the dummy list can have named components, in which
-case the names can be used to access the vectors read in.  For example
+case the names can be used to access the vectors read in.  For example,
 
 @example
 > inp <- scan("input.dat", list(id="", x=0, y=0))

======================================================================
  [-Initially-]  {+Initially,+}
======================================================================
 [-gives-] {+shows the
default path+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:04 2004
+++ R-intro.texi	Mon Aug 23 13:24:04 2004
@@ -2613,7 +2613,8 @@
 
 The function @code{search} shows the current search path and so is
 a very useful way to keep track of which data frames and lists (and
-packages) have been attached and detached.  Initially it gives
+packages) have been attached and detached.  Initially, it shows the
+default path
 
 @example
 > search()

======================================================================

[-objects-]
{+objects,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:04 2004
+++ R-intro.texi	Mon Aug 23 13:24:04 2004
@@ -2308,7 +2308,7 @@
 @cindex Lists
 
 An @R{} @emph{list} is an object consisting of an ordered collection of
-objects known as its @emph{components}.
+objects, known as its @emph{components}.
 
 There is no particular need for the components to be of the same mode or
 type, and, for example, a list could consist of a numeric vector, a

======================================================================
  [-Similarly-]  {+Similarly,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:06 2004
+++ R-intro.texi	Mon Aug 23 13:24:06 2004
@@ -2247,7 +2247,7 @@
 @section Frequency tables from factors
 @cindex Tabulation
 
-Recall that a factor defines a partition into groups.  Similarly a pair
+Recall that a factor defines a partition into groups.  Similarly, a pair
 of factors defines a two-way cross classification, and so on.
 @findex table
 The function @code{table()} allows frequency tables to be calculated

======================================================================
 [-array-] {+array,+}
======================================================================
 {+its+}
======================================================================
 {+being+}
======================================================================

[-evident-] {+given+}
======================================================================
  [-However-]  {+However,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:06 2004
+++ R-intro.texi	Mon Aug 23 13:24:06 2004
@@ -1782,8 +1782,8 @@
 @end example
 
 @noindent
-makes @code{D} a similar array with data vector the result of the
-evident element by element operations.  However the precise rule
+makes @code{D} a similar array, with its data vector being the result of
+the given element by element operations.  However, the precise rule
 concerning mixed array and vector calculations has to be considered a
 little more carefully.
 

======================================================================
 [-again-] {+again,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:06 2004
+++ R-intro.texi	Mon Aug 23 13:24:06 2004
@@ -1756,7 +1756,7 @@
 @end example
 
 However if @code{h} is shorter than 24, its values are recycled from the
-beginning again to make it up to size 24 (@pxref{The recycling rule}).
+beginning again, to make it up to size 24 (@pxref{The recycling rule}).
 As an extreme but common example
 
 @example

======================================================================
 [-example-] {+example,+}
======================================================================
 [-array, say-] {+array+}
======================================================================
 [-@code{a}-] {+@code{a},+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:06 2004
+++ R-intro.texi	Mon Aug 23 13:24:06 2004
@@ -1600,8 +1600,8 @@
 order as they would occur in FORTRAN, that is ``column major order,''
 with the first subscript moving fastest and the last subscript slowest.
 
-For example if the dimension vector for an array, say @code{a} is
-@code{c(3,4,2)} then there are @math{3 * 4 * 2 = 24} entries in @code{a}
+For example, if the dimension vector for an array @code{a} is
+@code{c(3,4,2)} then there are @math{3 * 4 * 2 = 24} entries in @code{a},
 and the data vector holds them in the order @code{a[1,1,1], a[2,1,1],
 @dots{}, a[2,4,2], a[3,4,2]}.
 

======================================================================
 [-factors-] {+factors,+}
======================================================================
 [-purposes-] {+purposes,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:06 2004
+++ R-intro.texi	Mon Aug 23 13:24:07 2004
@@ -1540,8 +1540,8 @@
 Sometimes the levels will have a natural ordering that we want to record
 and want our statistical analysis to make use of.  The @code{ordered()}
 @findex ordered
-function creates such ordered factors but is otherwise identical to
-@code{factor}.  For most purposes the only difference between ordered
+function creates such ordered factors, but is otherwise identical to
+@code{factor}.  For most purposes, the only difference between ordered
 and unordered factors is that the former are printed showing the
 ordering of the levels, but the contrasts generated for them in fitting
 linear models are different.

======================================================================
 [-factor-] {+factor,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:07 2004
+++ R-intro.texi	Mon Aug 23 13:24:07 2004
@@ -1425,7 +1425,7 @@
 Levels:  act nsw nt qld sa tas vic wa
 @end example
 
-To find out the levels of a factor the function @code{levels()} can be
+To find out the levels of a factor, the function @code{levels()} can be
 used.
 @findex levels
 

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:07 2004
+++ R-intro.texi	Mon Aug 23 13:24:07 2004
@@ -1347,7 +1347,7 @@
 A special attribute known as the @emph{class} of the object is used to
 allow for an object oriented style of programming in @R{}.
 
-For example if an object has class @code{"data.frame"}, it will be
+For example, if an object has class @code{"data.frame"}, it will be
 printed in a certain way, the @code{plot()} function will display it
 graphically in a certain way, and other so-called generic functions such
 as @code{summary()} will react to it as an argument in a way sensitive

======================================================================


[-Conversely-]

{+Conversely,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:07 2004
+++ R-intro.texi	Mon Aug 23 13:24:07 2004
@@ -1299,7 +1299,7 @@
 example in the @code{scan()} function for input (see @ref{The scan()
 function}.)
 
-Conversely to truncate the size of an object requires only an assignment
+Conversely, to truncate the size of an object requires only an assignment
 to do so.  Hence if @code{alpha} is an object of length 10, then
 
 @example

======================================================================
 [-so,-] {+so+}
======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:07 2004
+++ R-intro.texi	Mon Aug 23 13:24:07 2004
@@ -1237,7 +1237,7 @@
 @code{length(z)} is @code{100}.
 
 @R{} caters for changes of mode almost anywhere it could be considered
-sensible to do so, (and a few where it might not be).  For example with
+sensible to do so (and a few where it might not be).  For example, with
 
 @example
 > z <- 0:9

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:08 2004
+++ R-intro.texi	Mon Aug 23 13:24:08 2004
@@ -1107,7 +1107,7 @@
 the case of a logical index vector it must again be the same length as
 the vector it is indexing.
 
-For example
+For example,
 
 @example
 > x[is.na(x)] <- 0

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:08 2004
+++ R-intro.texi	Mon Aug 23 13:24:08 2004
@@ -1049,7 +1049,7 @@
 @code{length(x)}@}.  The corresponding elements of the vector are
 selected and concatenated, @emph{in that order}, in the result.  The
 index vector can be of any length and the result is of the same length
-as the index vector.  For example @code{x[6]} is the sixth component of
+as the index vector.  For example, @code{x[6]} is the sixth component of
 @code{x} and
 
 @example

======================================================================
 [-case-] {+case,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:08 2004
+++ R-intro.texi	Mon Aug 23 13:24:08 2004
@@ -1044,7 +1044,7 @@
 non-missing and positive.
 
 @item
-@strong{A vector of positive integral quantities}.  In this case the
+@strong{A vector of positive integral quantities}.  In this case, the
 values in the index vector must lie in the set @{1, 2, @dots{},
 @code{length(x)}@}.  The corresponding elements of the vector are
 selected and concatenated, @emph{in that order}, in the result.  The

======================================================================
 [-case-] {+case,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:08 2004
+++ R-intro.texi	Mon Aug 23 13:24:08 2004
@@ -1019,7 +1019,7 @@
 @enumerate
 
 @item
-@strong{A logical vector}.  In this case the index vector must be of the
+@strong{A logical vector}.  In this case, the index vector must be of the
 same length as the vector from which elements are to be selected.
 Values corresponding to @code{TRUE} in the index vector are selected and
 those corresponding to @code{FALSE} are omitted.  For example

======================================================================
 [-addition-] {+addition,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:09 2004
+++ R-intro.texi	Mon Aug 23 13:24:09 2004
@@ -884,7 +884,7 @@
 @findex >=
 @findex ==
 @findex !=
-In addition if @code{c1} and @code{c2} are logical expressions, then
+In addition, if @code{c1} and @code{c2} are logical expressions, then
 @w{@code{c1 & c2}} is their intersection (@emph{``and''}), @w{@code{c1 | c2}}
 is their union (@emph{``or''}), and @code{!c1} is the negation of
 @code{c1}.

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:09 2004
+++ R-intro.texi	Mon Aug 23 13:24:09 2004
@@ -865,7 +865,7 @@
 @findex F
 @findex T
 
-Logical vectors are generated by @emph{conditions}.  For example
+Logical vectors are generated by @emph{conditions}.  For example,
 
 @example
 > temp <- x > 13

======================================================================
  [-Thus-]  {+Thus,
the expression+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:09 2004
+++ R-intro.texi	Mon Aug 23 13:24:09 2004
@@ -754,7 +754,8 @@
 calculations are done as double precision real numbers, or double
 precision complex numbers if the input data are complex.
 
-To work with complex numbers, supply an explicit complex part.  Thus
+To work with complex numbers, supply an explicit complex part.  Thus,
+the expression
 
 @example
 sqrt(-17)

======================================================================
  [-Internally-]  {+Internally,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:09 2004
+++ R-intro.texi	Mon Aug 23 13:24:09 2004
@@ -750,7 +750,7 @@
 @findex pmin
 
 For most purposes the user will not be concerned if the ``numbers'' in a
-numeric vector are integers, reals or even complex.  Internally
+numeric vector are integers, reals or even complex.  Internally,
 calculations are done as double precision real numbers, or double
 precision complex numbers if the input data are complex.
 

======================================================================

[-particular-]
{+particular,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:10 2004
+++ R-intro.texi	Mon Aug 23 13:24:10 2004
@@ -673,7 +673,7 @@
 longest vector which occurs in the expression.  Shorter vectors in the
 expression are @emph{recycled} as often as need be (perhaps
 fractionally) until they match the length of the longest vector.  In
-particular a constant is simply repeated.  So with the above assignments
+particular, a constant is simply repeated.  So with the above assignments
 the command
 @cindex Recycling rule
 

======================================================================
 [-entries-] {+entries,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:10 2004
+++ R-intro.texi	Mon Aug 23 13:24:10 2004
@@ -660,7 +660,7 @@
 @end example
 
 @noindent
-would create a vector @code{y} with 11 entries consisting of two copies
+would create a vector @code{y} with 11 entries, consisting of two copies
 of @code{x} with a zero in the middle place.
 
 @node Vector arithmetic, Generating regular sequences, Vectors and assignment, Simple manipulations numbers and vectors

======================================================================
 [-time-] {+time,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:11 2004
+++ R-intro.texi	Mon Aug 23 13:24:11 2004
@@ -562,7 +562,7 @@
 this file name makes it @emph{invisible} in normal file listings in
 UNIX.} in the current directory.
 
-When @R{} is started at later time it reloads the workspace from this
+When @R{} is started at later time, it reloads the workspace from this
 file.  At the same time the associated command history is reloaded.
 
 It is recommended that you should use separate working directories for

======================================================================
 [-Windows-] {+Windows,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:11 2004
+++ R-intro.texi	Mon Aug 23 13:24:11 2004
@@ -506,7 +506,7 @@
 @end example
 @findex source
 
-For Windows @strong{Source} is also available on the
+For Windows, @strong{Source} is also available on the
 @strong{File} menu.  The function @code{sink},
 
 @example

======================================================================
 [-lines-] {+lines,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:11 2004
+++ R-intro.texi	Mon Aug 23 13:24:11 2004
@@ -467,7 +467,7 @@
 @end smallexample
 
 @noindent
-on second and subsequent lines and continue to read input until the
+on second and subsequent lines, and continue to read input until the
 command is syntactically complete.  This prompt may be changed by the
 user.  We will generally omit the continuation prompt
 and indicate continuation by simple indenting.

======================================================================
  [-Normally-]  {+Normally,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:11 2004
+++ R-intro.texi	Mon Aug 23 13:24:11 2004
@@ -439,7 +439,7 @@
 @code{A} and @code{a} are different symbols and would refer to different
 variables.  The set of symbols which can be used in @R{} names depends
 on the operating system and country within which @R{} is being run
-(technically on the @emph{locale} in use).  Normally all alphanumeric
+(technically on the @emph{locale} in use).  Normally, all alphanumeric
 symbols are allowed (and in some countries this includes accented
 letters) plus @samp{@code{.}} and @samp{@code{_}}, with the restriction
 that a name must start with @samp{@code{.}} or a letter, and if it

======================================================================
 [-sensitive}-] {+sensitive},+}
======================================================================
 [-would-]
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:11 2004
+++ R-intro.texi	Mon Aug 23 13:24:12 2004
@@ -435,8 +435,8 @@
 @section R commands, case sensitivity, etc.
 
 Technically @R{} is an @emph{expression language} with a very simple
-syntax.  It is @emph{case sensitive} as are most UNIX based packages, so
-@code{A} and @code{a} are different symbols and would refer to different
+syntax.  It is @emph{case sensitive}, as are most UNIX based packages, so
+@code{A} and @code{a} are different symbols and refer to different
 variables.  The set of symbols which can be used in @R{} names depends
 on the operating system and country within which @R{} is being run
 (technically on the @emph{locale} in use).  Normally, all alphanumeric

======================================================================


[-Technically-]

{+Technically,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:12 2004
+++ R-intro.texi	Mon Aug 23 13:24:12 2004
@@ -434,7 +434,7 @@
 @node R commands; case sensitivity etc, Recall and correction of previous commands, Getting help, Introduction and preliminaries
 @section R commands, case sensitivity, etc.
 
-Technically @R{} is an @emph{expression language} with a very simple
+Technically, @R{} is an @emph{expression language} with a very simple
 syntax.  It is @emph{case sensitive}, as are most UNIX based packages, so
 @code{A} and @code{a} are different symbols and refer to different
 variables.  The set of symbols which can be used in @R{} names depends

======================================================================
 [-program-] {+program,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:12 2004
+++ R-intro.texi	Mon Aug 23 13:24:12 2004
@@ -317,7 +317,7 @@
 At this point @R{} commands may be issued (see later).
 
 @item
-To quit the @R{} program the command is
+To quit the @R{} program, the command is
 
 @example
 > q()

======================================================================
 [-particular-] {+particular,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:12 2004
+++ R-intro.texi	Mon Aug 23 13:24:12 2004
@@ -267,7 +267,7 @@
 
 The most convenient way to use @R{} is at a graphics workstation running
 a windowing system.  This guide is aimed at users who have this
-facility.  In particular we will occasionally refer to the use of @R{}
+facility.  In particular, we will occasionally refer to the use of @R{}
 on an X window system although the vast bulk of what is said applies
 generally to any implementation of the @R{} environment.
 

======================================================================
 [-@Sl{}-] {+@Sl{},+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:13 2004
+++ R-intro.texi	Mon Aug 23 13:24:13 2004
@@ -255,7 +255,7 @@
 little work to find it.
 
 There is an important difference in philosophy between @Sl{} (and hence
-@R{}) and the other main statistical systems.  In @Sl{} a statistical
+@R{}) and the other main statistical systems.  In @Sl{}, a statistical
 analysis is normally done as a series of steps, with intermediate
 results being stored in objects.  Thus whereas SAS and SPSS will give
 copious output from a regression or discriminant analysis, @R{} will

======================================================================
  [-Similarly-]  {+Similarly,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:13 2004
+++ R-intro.texi	Mon Aug 23 13:24:13 2004
@@ -5594,7 +5594,7 @@
 
 Where @code{x} and @code{y} arguments are required, it is also
 sufficient to supply a single argument being a list with elements named
-@code{x} and @code{y}.  Similarly a matrix with two columns is also
+@code{x} and @code{y}.  Similarly, a matrix with two columns is also
 valid input.  In this way functions such as @code{locator()} (see below)
 may be used to specify positions on a plot interactively.
 

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:13 2004
+++ R-intro.texi	Mon Aug 23 13:24:13 2004
@@ -5419,7 +5419,7 @@
 @findex dotchart
 Constructs a dotchart of the data in @code{x}.  In a dotchart, the
 @math{y}-axis gives a labelling of the data in @code{x} and the
-@math{x}-axis gives its value.  For example it allows easy visual
+@math{x}-axis gives its value.  For example, it allows easy visual
 selection of all data entries with values lying in specified ranges.
 
 @item image(x, y, z, @dots{})

======================================================================

[-scatterplot-]
{+scatterplot,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:14 2004
+++ R-intro.texi	Mon Aug 23 13:24:14 2004
@@ -5372,7 +5372,7 @@
 The @code{coplot()} and @code{pairs()} function both take an argument
 @code{panel=} which can be used to customize the type of plot which
 appears in each panel.  The default is @code{points()} to produce a
-scatterplot but by supplying some other low-level graphics function of
+scatterplot, but by supplying some other low-level graphics function of
 two vectors @code{x} and @code{y} as the value of @code{panel=} you can
 produce any type of plot you wish.  An example panel function useful for
 coplots is @code{panel.smooth()}.

======================================================================


[-However-]

{+However,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:14 2004
+++ R-intro.texi	Mon Aug 23 13:24:14 2004
@@ -1720,7 +1720,7 @@
 @end example
 @findex crossprod
 
-However a simpler direct way of producing this matrix is to use
+However, a simpler direct way of producing this matrix is to use
 @code{table()}:
 @findex table
 

======================================================================

[-generally-]
{+generally,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:15 2004
+++ R-intro.texi	Mon Aug 23 13:24:15 2004
@@ -1011,7 +1011,7 @@
 
 Subsets of the elements of a vector may be selected by appending to the
 name of the vector an @emph{index vector} in square brackets.  More
-generally any expression that evaluates to a vector may have subsets of
+generally, any expression that evaluates to a vector may have subsets of
 its elements similarly selected by appending an index vector in square
 brackets immediately after the expression.
 

======================================================================
 [-example-] {+example,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:15 2004
+++ R-intro.texi	Mon Aug 23 13:24:15 2004
@@ -984,7 +984,7 @@
 @code{sep=@var{string}}, which changes it to @code{@var{string}},
 possibly empty.
 
-For example
+For example,
 
 @example
 > labs <- paste(c("X","Y"), 1:10, sep="")

======================================================================
 [-general-] {+general,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:15 2004
+++ R-intro.texi	Mon Aug 23 13:24:16 2004
@@ -908,7 +908,7 @@
 value'' in the statistical sense, a place within a vector may be
 reserved for it by assigning it the special value @code{NA}.
 @findex NA
-In general any operation on an @code{NA} becomes an @code{NA}.  The
+In general, any operation on an @code{NA} becomes an @code{NA}.  The
 motivation for this rule is simply that if the specification of an
 operation is incomplete, the result cannot be known and hence is not
 available.

======================================================================
 [-example-] {+example,+}
======================================================================
  [-Similarly-]  {+Similarly,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:16 2004
+++ R-intro.texi	Mon Aug 23 13:24:16 2004
@@ -815,7 +815,7 @@
 the sequence respectively.  If neither of these is given, the default
 @code{by=1} is assumed.
 
-For example
+For example,
 
 @example
 > seq(-5, 5, by=.2) -> s3
@@ -823,7 +823,7 @@
 
 @noindent
 generates in @code{s3} the vector @code{c(-5.0, -4.8, -4.6, @dots{},
-4.6, 4.8, 5.0)}.  Similarly
+4.6, 4.8, 5.0)}.  Similarly,
 
 @example
 > s4 <- seq(length=51, from=-5, by=.2)

======================================================================
 [-on-] {+in+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:16 2004
+++ R-intro.texi	Mon Aug 23 13:24:16 2004
@@ -497,7 +497,7 @@
 @section Executing commands from or diverting output to a file
 @cindex Diverting input and output
 
-If commands are stored on an external file, say @file{commands.R} in the
+If commands are stored in an external file, say @file{commands.R} in the
 working directory @file{work}, they may be executed at any time in an
 @R{} session with the command
 

======================================================================
 [-system-] {+system,+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:17 2004
+++ R-intro.texi	Mon Aug 23 13:24:17 2004
@@ -268,7 +268,7 @@
 The most convenient way to use @R{} is at a graphics workstation running
 a windowing system.  This guide is aimed at users who have this
 facility.  In particular, we will occasionally refer to the use of @R{}
-on an X window system although the vast bulk of what is said applies
+on an X window system, although the vast bulk of what is said applies
 generally to any implementation of the @R{} environment.
 
 Most users will find it necessary to interact directly with the

======================================================================
 [-options.-] {+options:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:17 2004
+++ R-intro.texi	Mon Aug 23 13:24:17 2004
@@ -6674,7 +6674,7 @@
 information).  Users will not normally need to use these unless they
 are trying to limit the amount of memory used by @R{}.
 
-@R{} accepts the following command-line options.
+@R{} accepts the following command-line options:
 
 @table @option
 @item --help

======================================================================
 [-as-] {+as:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:18 2004
+++ R-intro.texi	Mon Aug 23 13:24:18 2004
@@ -4945,7 +4945,7 @@
 $\beta_2=\theta_2/\theta_1$.
 @end tex
 Supposing a suitable data frame to be set up we could fit this
-non-linear regression as
+non-linear regression as:
 
 @example
 > nlfit <- glm(y ~ x1 + x2 - 1,

======================================================================
 [-below.-] {+below:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:18 2004
+++ R-intro.texi	Mon Aug 23 13:24:18 2004
@@ -4406,7 +4406,7 @@
 anova   drop1      formula   plot    proj     summary
 @end example
 
-A brief description of the most commonly used ones is given below.
+A brief description of the most commonly used ones is given below:
 
 @table @code
 @findex anova

======================================================================
 [-errors-] {+errors:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:19 2004
+++ R-intro.texi	Mon Aug 23 13:24:19 2004
@@ -4101,7 +4101,7 @@
 @cindex Formulae
 
 The template for a statistical model is a linear regression model with
-independent, homoscedastic errors
+independent, homoscedastic errors:
 
 @ifnottex
 @display

======================================================================
 [-is,-] {+is:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:19 2004
+++ R-intro.texi	Mon Aug 23 13:24:19 2004
@@ -3988,7 +3988,7 @@
 below alters the prompt to @code{$} and sets up various other useful
 things that can then be taken for granted in the rest of the session.
 
-Thus, the sequence in which files are executed is, @file{Rprofile.site},
+Thus, the sequence in which files are executed is: @file{Rprofile.site},
 @file{.Rprofile}, @file{.RData} and then @code{.First()}.  A definition
 in later files will mask definitions in earlier files.
 

======================================================================
 [-definition.-] {+definition:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:19 2004
+++ R-intro.texi	Mon Aug 23 13:24:19 2004
@@ -3850,7 +3850,7 @@
 of expressions in the body of the functions.  Variables which are not
 formal parameters or local variables are called free variables.  Free
 variables become local variables if they are assigned to.  Consider the
-following function definition.
+following function definition:
 
 @example
 f <- function(x) @{

======================================================================
 [-hypothesis.-] {+hypothesis:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:20 2004
+++ R-intro.texi	Mon Aug 23 13:24:20 2004
@@ -3243,7 +3243,7 @@
 
 All these tests assume normality of the two samples.  The two-sample
 Wilcoxon (or Mann-Whitney) test only assumes a common continuous
-distribution under the null hypothesis.
+distribution under the null hypothesis:
 
 @cindex Wilcoxon test
 @findex wilcox.test

======================================================================
 [-variances.-] {+variances:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:20 2004
+++ R-intro.texi	Mon Aug 23 13:24:20 2004
@@ -3224,7 +3224,7 @@
 
 @noindent
 which shows no evidence of a significant difference, and so we can use
-the classical @math{t}-test that assumes equality of the variances.
+the classical @math{t}-test that assumes equality of the variances:
 
 @example
 > t.test(A, B, var.equal=TRUE)

======================================================================
 [-populations.-] {+populations:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:21 2004
+++ R-intro.texi	Mon Aug 23 13:24:21 2004
@@ -3204,7 +3204,7 @@
 default, the @R{} function does not assume equality of variances in the
 two samples (in contrast to the similar @SPLUS{} @code{t.test}
 function).  We can use the F test to test for equality in the variances,
-provided that the two samples are from normal populations.
+provided that the two samples are from normal populations:
 
 @example
 > var.test(A, B)

======================================================================
 [-second.-] {+second:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:21 2004
+++ R-intro.texi	Mon Aug 23 13:24:21 2004
@@ -3173,7 +3173,7 @@
 
 @noindent
 which indicates that the first group tends to give higher results than
-the second.
+the second:
 
 @iftex
 @image{images/ice,7cm}

======================================================================
 [-examples-] {+examples:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:21 2004
+++ R-intro.texi	Mon Aug 23 13:24:21 2004
@@ -2964,7 +2964,7 @@
 distribution of the studentized range of samples from a normal
 distribution.
 
-Here are some examples
+Here are some examples:
 
 @example
 > ## @r{2-tailed p-value for t distribution}

======================================================================
 [-follows.-] {+follows:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:21 2004
+++ R-intro.texi	Mon Aug 23 13:24:21 2004
@@ -2694,7 +2694,7 @@
 
 If the file has one fewer item in its first line than in its second, this
 arrangement is presumed to be in force.  So the first few lines of a file
-to be read as a data frame might look as follows.
+to be read as a data frame might look as follows:
 
 @quotation
 @cartouche

======================================================================

[-parameters.-]
{+parameters:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:22 2004
+++ R-intro.texi	Mon Aug 23 13:24:22 2004
@@ -5910,7 +5910,7 @@
 @code{lty} graphics parameter), the @emph{tick marks} (which mark off unit
 divisions along the axis line) and the @emph{tick labels} (which mark the
 units.) These components can be customized with the following graphics
-parameters.
+parameters:
 
 @table @code
 @item lab=c(5, 7, 12)

======================================================================

[-as-]
{+shown+}
======================================================================
 [-table below.-] {+following table:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:22 2004
+++ R-intro.texi	Mon Aug 23 13:24:22 2004
@@ -4703,7 +4703,7 @@
 
 Each response distribution admits a variety of link functions to connect
 the mean with the linear predictor.  Those automatically available are
-as in the table below.
+shown in the following table:
 
 @quotation
 @multitable @columnfractions 0.25 0.55

======================================================================
 [-function.-] {+function:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:22 2004
+++ R-intro.texi	Mon Aug 23 13:24:22 2004
@@ -4530,7 +4530,7 @@
 (1992).
 
 A more flexible alternative to the default full ANOVA table is to
-compare two or more models directly using the @code{anova()} function.
+compare two or more models directly using the @code{anova()} function:
 @findex anova
 
 @example

======================================================================
 [-value.-] {+value:+}
======================================================================
 [-manual.-] {+R Reference Manual.+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:22 2004
+++ R-intro.texi	Mon Aug 23 13:24:22 2004
@@ -2801,14 +2801,14 @@
 
 If the second argument is a single value and not a list, a single vector
 is read in, all components of which must be of the same mode as the
-dummy value.
+dummy value:
 
 @example
 > X <- matrix(scan("light.dat", 0), ncol=5, byrow=TRUE)
 @end example
 
 There are more elaborate input facilities available and these are
-detailed in the manual.
+detailed in the R Reference Manual.
 
 @node Accessing builtin datasets, Editing data, The scan() function, Reading data from files
 @section Accessing builtin datasets

======================================================================
 [-example.-] {+example:+}
======================================================================
--- R-intro.texi~	Mon Aug 23 13:24:23 2004
+++ R-intro.texi	Mon Aug 23 13:24:23 2004
@@ -1669,7 +1669,7 @@
 Replace these entries in the array @code{X} by zero.
 @end itemize
 In this case we need a @math{3} by @math{2} subscript array, as in the
-following example.
+following example:
 
 @example
 > x <- array(1:20,dim=c(4,5))   # @r{Generate a 4 by 5 array.}

From maechler at stat.math.ethz.ch  Mon Aug 23 16:20:52 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon Aug 23 16:20:59 2004
Subject: [Rd] legend's arguments "angle", "density" & "lwd" (PR#7023)
In-Reply-To: <41263888.2030000@statistik.uni-dortmund.de>
References: <Pine.GSO.3.96.1020313040441.2280B-100000@magic>
	<001e01c1cac5$2ac49960$7632d882@stat.auckland.ac.nz>
	<3C8FB3D0.C7CD3D3D@cancer.org.uk> <3C90045E.C8E0B8C0@icrf.icnet.uk>
	<009b01c1cb92$c7fbdb80$7632d882@stat.auckland.ac.nz>
	<41261239.1030605@statistik.uni-dortmund.de>
	<16678.12628.219394.718403@gargle.gargle.HOWL>
	<41263888.2030000@statistik.uni-dortmund.de>
Message-ID: <16681.64836.177923.532692@gargle.gargle.HOWL>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Fri, 20 Aug 2004 19:44:40 +0200 writes:

    UweL> Martin Maechler wrote:
    >>>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
    >>>>>>> on Fri, 20 Aug 2004 17:01:13 +0200 writes:
    >> 
    UweL> Paul Murrell wrote [on 2002-03-14 with Subject: "filled bars with 
    UweL> patterns" in reply to Arne Mueller]
    >> 
    >> >> Hi
    >> >> 
    >> >> <snip>
    >> >> 
    >> >>> I'd also like to have the filled boxes in the legend to be striped. The
    >> >>> legend function has a 'density' attribute, but unfortunately this does't
    >> >>> seem to do anything
    >> >>> 
    >> >>> following the above example
    >> >>> 
    >> >>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), fill = c('red', 'blue',
    >> >>> 'green', 'orange'))
    >> >>> 
    >> >>> is the same as
    >> >>> 
    >> >>> legend(3.4, 5, c('Axx','Bxx','Cxx','Dxx'), density=10,
    >> >>>        fill = c('red', 'blue', 'green', 'orange'),
    >> >>>        density=c(10,-1,20, 200))


    >> >> This appears to be a bug.  Can you file a bug report for this please?

    UweL> [SNIP; I cannot find any related bug report in the repository]

    UweL> I'm just reviewing bug reports and other stuff re. legend() and found 
    UweL> this old message in one of my Next-Week-To-Do-folders.
    >> 
    UweL> Well, the point mentioned above is not really a bug,
    UweL> because one has to specify BOTH arguments, angle AND
    UweL> density in legend(). Is there any point not to make
    UweL> angle = 45 the default, as it already is for polygon()
    UweL> and rect()?

    MM> This seems like a good idea,
    MM> but we'll wait for your many other patches to legend.R and
    MM> legend.Rd   :-)

    UweL> Just three rather than many issues I'm trying to address, the third one 
    UweL> is just closing a bug report. ;-)
    UweL> Here the two suggested patches in merged form.

    UweL> Uwe

    <........... snipping Uwe's patches  .........>

This has now lead to more:
I've just added to NEWS (and the C and R sources of course)

    o	plot.xy(), the workhorse function of points, lines and plot.default
	now has 'lwd' as explicit argument instead of implicitly in "...",
	and now recycles lwd where it makes sense, i.e. for line based plot
	symbols.

such that Uwe's proposed new argument to legend(), pt.lwd is
also recycled and now can default to 'lwd', the line width of
the line segments in legend().
Hence, Leslie's original feature request (PR#7023) of June 25
is now also fulfilled using only 'lwd' and not both 'lwd' and 'pt.lwd'.
I.e., the following now works

x <- 1:10 ; y <- rnorm(10,10,5) ; y2 <- rnorm(10,8,4)
plot(x, y, bty="l", lwd=3, type="o", col=2, ylim = range(y,y2), cex=1.5)
points(x, y2, lwd=3, lty=8, col=4, type="o", pch=2, cex=1.5)
legend(10, max(y, y2), legend=c("Method 1","Method 2"),  
       col=c(2, 4), lty=c(1, 8), pch=c(1, 2), 
       xjust=1, yjust=1, pt.cex=1.5, lwd=3)

[note that I've used 'ylim = range(y,y2)' which is slightly better than
 'ylim = c(min(y,y2),max(y,y2))']

With thanks to Uwe!
Martin

From jgentry at jimmy.harvard.edu  Mon Aug 23 19:39:16 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Mon Aug 23 19:38:48 2004
Subject: [Rd] Possible Latex problem in R-devel?
Message-ID: <Pine.SOL.4.20.0408231335340.28864-100000@santiam.dfci.harvard.edu>

I'm getting this error when installing packages w/ a checkout of R from a
a little bit ago (23-Aug-2004, approx 1pm eastern US time):

** help
Bareword found where operator expected at
/usr/home/jgentry/R/share/perl/R/Rdconv.pm line 2331, near "$latexout
latex_link_trans0"
        (Missing operator before latex_link_trans0?)

It isn't obvious to me what the error is, although commenting out line
2331 definitely causes the error to go away.

-J

From ripley at stats.ox.ac.uk  Mon Aug 23 20:22:37 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug 23 20:22:43 2004
Subject: [Rd] Possible Latex problem in R-devel?
In-Reply-To: <Pine.SOL.4.20.0408231335340.28864-100000@santiam.dfci.harvard.edu>
Message-ID: <Pine.LNX.4.44.0408231919440.1940-100000@gannet.stats>

On Mon, 23 Aug 2004, Jeff Gentry wrote:

> I'm getting this error when installing packages w/ a checkout of R from a
> a little bit ago (23-Aug-2004, approx 1pm eastern US time):
> 
> ** help
> Bareword found where operator expected at
> /usr/home/jgentry/R/share/perl/R/Rdconv.pm line 2331, near "$latexout
> latex_link_trans0"
>         (Missing operator before latex_link_trans0?)
> 
> It isn't obvious to me what the error is, although commenting out line
> 2331 definitely causes the error to go away.

What version of perl?

It works correctly in the current 5.8.4 (it has installed all the CRAN
packages), but I think I have seen something similar in 5.8.0.  Making
that

    print $latexout &latex_link_trans0($blocks{"name"});

will probably solve it for you.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jgentry at jimmy.harvard.edu  Mon Aug 23 20:57:50 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Mon Aug 23 20:57:22 2004
Subject: [Rd] Installing package lattice
Message-ID: <Pine.SOL.4.20.0408231454420.28864-100000@santiam.dfci.harvard.edu>


Here's another issue (that might well be operator error):

> install.packages("lattice")

...
...
** save image
Loading required package: grid
Error in importIntoEnv(impenv, impnames, ns, impvars) :
        object(s) 'dev.list', 'cm.colors', 'gray', 'heat.colors' are not
exported by 'namespace:graphics'
Execution halted
ERROR: execution of package source for 'lattice' failed
** Removing '/usr/home/jgentry/R-devel/library/lattice'

Thanks
-J

From jgentry at jimmy.harvard.edu  Mon Aug 23 21:07:14 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Mon Aug 23 21:06:53 2004
Subject: [Rd] Possible Latex problem in R-devel?
In-Reply-To: <Pine.LNX.4.44.0408231919440.1940-100000@gannet.stats>
Message-ID: <Pine.SOL.4.20.0408231458390.28864-100000@santiam.dfci.harvard.edu>

> What version of perl?

Ack, didn't realize it was this ancient.  Version 5.005_03, which is what
comes with FreeBSD 4.9 apparently.  I did install the /usr/ports version
of perl is 5.8.2, although there seems to be other problems here (which
are most likely related to my system, will track that down before bringing
that issue up - it appears to be a mismatch on my libraries between the
two versions).

>     print $latexout &latex_link_trans0($blocks{"name"});
> will probably solve it for you.

Yup, this works, thanks.

From deepayan at stat.wisc.edu  Mon Aug 23 21:16:33 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Mon Aug 23 21:16:25 2004
Subject: [Rd] Installing package lattice
In-Reply-To: <Pine.SOL.4.20.0408231454420.28864-100000@santiam.dfci.harvard.edu>
References: <Pine.SOL.4.20.0408231454420.28864-100000@santiam.dfci.harvard.edu>
Message-ID: <200408231416.33167.deepayan@stat.wisc.edu>

?????? 23 ????? 2004 13:57 ??????, Jeff Gentry ?????????:
> Here's another issue (that might well be operator error):
> > install.packages("lattice")
>
> ...
> ...
> ** save image
> Loading required package: grid
> Error in importIntoEnv(impenv, impnames, ns, impvars) :
>         object(s) 'dev.list', 'cm.colors', 'gray', 'heat.colors' are not
> exported by 'namespace:graphics'
> Execution halted
> ERROR: execution of package source for 'lattice' failed
> ** Removing '/usr/home/jgentry/R-devel/library/lattice'


Yes, the released lattice version is no longer compatible with r-devel after a 
split of the graphics package, and install.packages doesn't know to look in 
http://cran.us.r-project.org/src/contrib/2.0.0/Recommended/. Doing 
a ./tools/rsync-recommended should get you the correct version.

Deepayan

From tlumley at u.washington.edu  Mon Aug 23 21:16:50 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon Aug 23 21:16:56 2004
Subject: [Rd] Installing package lattice
In-Reply-To: <Pine.SOL.4.20.0408231454420.28864-100000@santiam.dfci.harvard.edu>
References: <Pine.SOL.4.20.0408231454420.28864-100000@santiam.dfci.harvard.edu>
Message-ID: <Pine.A41.4.58.0408231213290.39702@homer08.u.washington.edu>

On Mon, 23 Aug 2004, Jeff Gentry wrote:

>
> Here's another issue (that might well be operator error):
>
> > install.packages("lattice")
>
> ...
> ...
> ** save image
> Loading required package: grid
> Error in importIntoEnv(impenv, impnames, ns, impvars) :
>         object(s) 'dev.list', 'cm.colors', 'gray', 'heat.colors' are not
> exported by 'namespace:graphics'

The graphics package has been split into grDevices and graphics. You need
to remove any previously built versions of graphics and grid in library/
before rebuilding.

	-thomas

From jgentry at jimmy.harvard.edu  Mon Aug 23 21:23:59 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Mon Aug 23 21:24:03 2004
Subject: [Rd] Installing package lattice
In-Reply-To: <200408231416.33167.deepayan@stat.wisc.edu>
Message-ID: <Pine.SOL.4.20.0408231523450.28864-100000@santiam.dfci.harvard.edu>

> Yes, the released lattice version is no longer compatible with r-devel after a 
> split of the graphics package, and install.packages doesn't know to look in 
> http://cran.us.r-project.org/src/contrib/2.0.0/Recommended/. Doing 
> a ./tools/rsync-recommended should get you the correct version.

Thanks.  Apparently today is "stupid questions" day for me.

-J

From ripley at stats.ox.ac.uk  Mon Aug 23 22:14:44 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug 23 22:14:49 2004
Subject: [Rd] Possible Latex problem in R-devel?
In-Reply-To: <Pine.SOL.4.20.0408231458390.28864-100000@santiam.dfci.harvard.edu>
Message-ID: <Pine.LNX.4.44.0408232112490.5481-100000@gannet.stats>

On Mon, 23 Aug 2004, Jeff Gentry wrote:

> > What version of perl?
> 
> Ack, didn't realize it was this ancient.  Version 5.005_03, which is what
> comes with FreeBSD 4.9 apparently.  I did install the /usr/ports version
> of perl is 5.8.2, although there seems to be other problems here (which
> are most likely related to my system, will track that down before bringing
> that issue up - it appears to be a mismatch on my libraries between the
> two versions).

Yes, that version of perl has a lot of bugs, but in theory we support it.
(It seems worse than either 5.004 or 5.005_04.)

> >     print $latexout &latex_link_trans0($blocks{"name"});
> > will probably solve it for you.
> 
> Yup, this works, thanks.

I've changed the sources, to be defensive.  I don't like reading Perl
like that, but it does work more portably.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Mon Aug 23 22:36:11 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Aug 23 22:41:02 2004
Subject: [Rd] Possible Latex problem in R-devel?
In-Reply-To: <Pine.LNX.4.44.0408231919440.1940-100000@gannet.stats>
References: <Pine.LNX.4.44.0408231919440.1940-100000@gannet.stats>
Message-ID: <x24qmtiock.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> On Mon, 23 Aug 2004, Jeff Gentry wrote:
> 
> > I'm getting this error when installing packages w/ a checkout of R from a
> > a little bit ago (23-Aug-2004, approx 1pm eastern US time):
> > 
> > ** help
> > Bareword found where operator expected at
> > /usr/home/jgentry/R/share/perl/R/Rdconv.pm line 2331, near "$latexout
> > latex_link_trans0"
> >         (Missing operator before latex_link_trans0?)
> > 
> > It isn't obvious to me what the error is, although commenting out line
> > 2331 definitely causes the error to go away.
> 
> What version of perl?
> 
> It works correctly in the current 5.8.4 (it has installed all the CRAN
> packages), but I think I have seen something similar in 5.8.0.  Making
> that
> 
>     print $latexout &latex_link_trans0($blocks{"name"});
> 
> will probably solve it for you.

RedHat 8 is actually on 5.8.0 and is affected by this nit. Could we
fix it in the sources? Would be nice if it doesn't turn into yet
another must-upgrade-this-tool for developers.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Mon Aug 23 22:46:18 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Aug 23 22:51:15 2004
Subject: [Rd] Possible Latex problem in R-devel?
In-Reply-To: <x24qmtiock.fsf@biostat.ku.dk>
References: <Pine.LNX.4.44.0408231919440.1940-100000@gannet.stats>
	<x24qmtiock.fsf@biostat.ku.dk>
Message-ID: <x2zn4lh9b9.fsf@biostat.ku.dk>

Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > On Mon, 23 Aug 2004, Jeff Gentry wrote:
> > 
> > > I'm getting this error when installing packages w/ a checkout of R from a
> > > a little bit ago (23-Aug-2004, approx 1pm eastern US time):
> > > 
> > > ** help
> > > Bareword found where operator expected at
> > > /usr/home/jgentry/R/share/perl/R/Rdconv.pm line 2331, near "$latexout
> > > latex_link_trans0"
> > >         (Missing operator before latex_link_trans0?)
> > > 
> > > It isn't obvious to me what the error is, although commenting out line
> > > 2331 definitely causes the error to go away.
> > 
> > What version of perl?
> > 
> > It works correctly in the current 5.8.4 (it has installed all the CRAN
> > packages), but I think I have seen something similar in 5.8.0.  Making
> > that
> > 
> >     print $latexout &latex_link_trans0($blocks{"name"});
> > 
> > will probably solve it for you.
> 
> RedHat 8 is actually on 5.8.0 and is affected by this nit. Could we
> fix it in the sources? Would be nice if it doesn't turn into yet
> another must-upgrade-this-tool for developers.

Looks like Brian flew back in his time machine and responded to my
request an hour or two before I stated it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From tplate at blackmesacapital.com  Mon Aug 23 21:16:18 2004
From: tplate at blackmesacapital.com (Tony Plate)
Date: Mon Aug 23 22:56:49 2004
Subject: [Rd] idea for "virtual matrix/array" class
Message-ID: <6.1.0.6.2.20040823120230.06461ff0@mailhost.blackmesacapital.com>

I've been wondering how to work with more data than can fit in memory, in a 
way that allows it to be worked with conveniently and quickly.  Of course, 
a database can be used for this purpose, but extracting data from a 
database is much slower and somewhat less convenient than extracting data 
from a native object (at least in our setup).

One idea I was thinking about was to have a new class of object that 
referred to data in a file on disk, and which had all the standard methods 
of matrices and arrays, i.e., subsetting ("["), dim, dimnames, etc.  The 
object in memory would only store the array attributes, while the actual 
array data (the elements) would reside in a file.  When some extraction 
method was called, it would access data in the file and return the 
appropriate data.  With sensible use of seek operations, the data access 
could probably be quite fast.  The file format of the object on disk could 
possibly be the standard serialized binary format as used in .RData 
files.  Of course, if the object was larger than would fit in memory, then 
trying to extract too large a subarray would exhaust memory, but it should 
be possible to efficiently extract reasonably sized subarrays.  To be more 
useful, one would want want apply() to work with such arrays.  That would 
be doable, either by creating a new method for apply, or possibly just for 
aperm.

Some difficulties that might arise could have to do with functions like 
"typeof" and "mode" and "storage.mode" -- what should these return for such 
an object?  Such a class would probably break the common relationships such 
as x[1] having the same storage mode as x.  I don't know if difficulties 
like these would ultimately make such a "virtual array" class unworkable.

Does anyone have any opinions as to the merits of this idea?  Would there 
be any interest in seeing such a class in R?

-- Tony Plate

From jgentry at jimmy.harvard.edu  Mon Aug 23 23:08:32 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Mon Aug 23 23:08:04 2004
Subject: [Rd] idea for "virtual matrix/array" class
In-Reply-To: <6.1.0.6.2.20040823120230.06461ff0@mailhost.blackmesacapital.com>
Message-ID: <Pine.SOL.4.20.0408231707490.28864-100000@santiam.dfci.harvard.edu>

> Does anyone have any opinions as to the merits of this idea?  Would there 
> be any interest in seeing such a class in R?

Have you looked at the 'externalVector' package in Bioconductor?  I'm
admittedly not super familiar with it, although my understanding of how it
works and what it does seems pretty similar to what you are describing.

-J

From tlumley at u.washington.edu  Mon Aug 23 23:13:40 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon Aug 23 23:13:45 2004
Subject: [Rd] idea for "virtual matrix/array" class
In-Reply-To: <6.1.0.6.2.20040823120230.06461ff0@mailhost.blackmesacapital.com>
References: <6.1.0.6.2.20040823120230.06461ff0@mailhost.blackmesacapital.com>
Message-ID: <Pine.A41.4.58.0408231402330.39702@homer08.u.washington.edu>

On Mon, 23 Aug 2004, Tony Plate wrote:
>
> One idea I was thinking about was to have a new class of object that
> referred to data in a file on disk, and which had all the standard methods
> of matrices and arrays, i.e., subsetting ("["), dim, dimnames, etc.  The
> object in memory would only store the array attributes, while the actual
> array data (the elements) would reside in a file.  When some extraction
> method was called, it would access data in the file and return the
> appropriate data.  With sensible use of seek operations, the data access
> could probably be quite fast.  The file format of the object on disk could
> possibly be the standard serialized binary format as used in .RData
> files.  Of course, if the object was larger than would fit in memory, then
> trying to extract too large a subarray would exhaust memory, but it should
> be possible to efficiently extract reasonably sized subarrays.  To be more
> useful, one would want want apply() to work with such arrays.  That would
> be doable, either by creating a new method for apply, or possibly just for
> aperm.

This is what RPgSql does with proxy dataframes and what I did (read-only)
for netCDF access. It's a good idea if you have a data format for which
random access is fairly fast.  I'm not sure that the standard serialized
binary format satisfies this.  Fixed-format text files would work, but
free-format ones wouldn't -- seek() only helps when you can work out where
to seek without reading all the data.

	-thomas

From ripley at stats.ox.ac.uk  Mon Aug 23 23:23:02 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug 23 23:23:07 2004
Subject: [Rd] idea for "virtual matrix/array" class
In-Reply-To: <6.1.0.6.2.20040823120230.06461ff0@mailhost.blackmesacapital.com>
Message-ID: <Pine.LNX.4.44.0408232205090.5551-100000@gannet.stats>

We've seen something very similar before.  A file is just a database writ 
small, and RPgSQL did essentially this in ca 2001.  Fei Chen's research 
system (see his talk at DSC2003) again does similar things.

Both of those were for virtual data frames as I recall.  It's easier for a
matrix/array, but I am not sure it is necessary.  At least on Unix-alikes
one could arrange to memory-map large vectors (logical, integer, double or
raw).  Character vectors would be a little harder, but a char ** version
could be memory mapped.  I presume you don't mean matrix/arrays of lists?

I think you need to show examples where an array/matrix is the right 
structure and the sort of access required.  Accessing rows in a matrix 
would cause severe page-faulting for example (and that's the sort of 
reason we recommend DBMSes).

On Mon, 23 Aug 2004, Tony Plate wrote:

> I've been wondering how to work with more data than can fit in memory, in a 
> way that allows it to be worked with conveniently and quickly.  Of course, 
> a database can be used for this purpose, but extracting data from a 
> database is much slower and somewhat less convenient than extracting data 
> from a native object (at least in our setup).
> 
> One idea I was thinking about was to have a new class of object that 
> referred to data in a file on disk, and which had all the standard methods 
> of matrices and arrays, i.e., subsetting ("["), dim, dimnames, etc.  The 
> object in memory would only store the array attributes, while the actual 
> array data (the elements) would reside in a file.  When some extraction 
> method was called, it would access data in the file and return the 
> appropriate data.  With sensible use of seek operations, the data access 
> could probably be quite fast.  The file format of the object on disk could 
> possibly be the standard serialized binary format as used in .RData 
> files.  Of course, if the object was larger than would fit in memory, then 
> trying to extract too large a subarray would exhaust memory, but it should 
> be possible to efficiently extract reasonably sized subarrays.  To be more 
> useful, one would want want apply() to work with such arrays.  That would 
> be doable, either by creating a new method for apply, or possibly just for 
> aperm.
> 
> Some difficulties that might arise could have to do with functions like 
> "typeof" and "mode" and "storage.mode" -- what should these return for such 
> an object?  Such a class would probably break the common relationships such 
> as x[1] having the same storage mode as x.  I don't know if difficulties 
> like these would ultimately make such a "virtual array" class unworkable.
> 
> Does anyone have any opinions as to the merits of this idea?  Would there 
> be any interest in seeing such a class in R?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.murrell at auckland.ac.nz  Tue Aug 24 01:39:42 2004
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Aug 24 01:40:26 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
References: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>
	<4128BC4D.1090204@statistik.uni-dortmund.de>
Message-ID: <412A803E.1020608@stat.auckland.ac.nz>

Hi


Uwe Ligges wrote:
> ligges@statistik.uni-dortmund.de wrote:
> 
>> joehl@gmx.de wrote:
>>
>>
>>> Dear all,
>>> Our quite basic function mtext() does wrong adjustments in some 
>>> parameter
>>> configurations. This gets obvious when using multi line texts: There 
>>> is no
>>> way to properly adjust text perpendicular to axis 2, for example.
>>>
>>> Best
>>>
>>>
>>> Jens Oehlschl?gel
>>>
>>>
>>> m <- matrix(1:9, 3)
>>> colnames(m) <- c("several\nlines", "several\nlines", "several\nlines")
>>>
>>> par(mfrow=c(2,2))
>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 
>>> adj=0.5 is
>>> fine")
>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, 
>>> adj=0.5)
>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 adj=1 is
>>> different")
>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, adj=1)
>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=1 
>>> adj=0.5 is
>>> NOT fine")
>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, 
>>> adj=0.5)
>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="at las=1, 
>>> adj=1
>>> works the wrong direction", sub="no way to get adj=c(1, 0.5) with 
>>> las=1 (or
>>> 2)")
>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, adj=1)
>>> par(mfrow=c(1,1))
>>>
>>
>>
>> Left / right adjustemnt seems to be perfectly OK.
>> The thing that matters is centering "several lines" to the specified 
>> ("at=") location.
>> In fact, mtext() is not centering but bottom-aligning by adding a 
>> negative distance that looks OK for one line in the default font size, 
>> but not in most other cases.
>>
>> Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment 
>> of perpendicular text"). Fixing this, and/or improving mtext()'s "adj" 
>> argument to accept 2 dimensions is desirable, but might be not that 
>> easy... I'll take a look during the next days, but nothing promised.
>>
>> Uwe Ligges
> 
> 
> 
> Having looked into the code, there are three possible solution (all with
> some drawbacks) I can see. Well, the current argument "adj" becomes
> "xadj" in the C sources (graphics.c, GMtext), and "yadj" is set to 0. 
> Hence the ugly hard coded LineBias of 0.3.
> 
> 
> Solutions
> =========
> 1: Hardcode "yadj" to 0.5 and remove all those 0.3 biases. Looks good 
> for axes, but it might break some code --> bad.
> On the other hand, GMMathText has hardcoded yadj=0.5. Is there a problem 
> with some special devices? Or any other reason not to center stuff using 
> "adj=0.5"?
> 
> 2: Allow the typical 2-value adj, take the first as xadj, the second one
> as yadj. This might break some code, because currently adj of
> arbitrary length (!=0) is allowed and recycled.
> 
> 3: Invent an argument "padj" for mtext() that represents adjustment
> *p*erpendicular to the text direction and gets mapped to "yadj" in
> GMtext. In that case the hardcoded 0.3 bias mentioned above can be
> removed. The question is whether to set the default to 0.5 (will still
> break code, but easily to fix by setting padj to 0).
> 
> I'd like to propose the third solution and would be happy to provide a
> patch of GMText, including corresponding patches to GMMathText, as well 
> as mtext(), title() and axis() (and their inderlying do_* components).
> 
> Are there any objections? Any reasons not to do it?


It hurts my head to think about this stuff.  There are so many 
combinations to worry about:
(i)   The las setting
(ii)  The axis (bottom, left, top, right)
(iii) Whether adj has been specified
(iv)  Whether the text is multi-line

I think mtext() does ok as long as adj is not specified and the text is 
single-line.

I would suggest addressing the multi-line problem for unspecified adj as 
a first step.  And I will definitely not mourn the passing of the 0.3 
constant.  Setting yadj to 0.5 is not enough though because that doesn't 
make sense for multi-line text that is parallel to an axis (in that 
case, yadj should probably be 0 for axis 2 and 3 and 1 for axis 1 and 4; 
  did I mention that there are lots of combinations to worry about?).

For user-specified adj, I agree that a 2-value adj is not a good 
solution (adj is assumed to be horizontal adjustment) so maybe a padj 
would be best to allow user control of vertical alignment.

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From maechler at stat.math.ethz.ch  Tue Aug 24 08:56:50 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Aug 24 08:56:51 2004
Subject: [Rd] Possible Latex problem in R-devel?
In-Reply-To: <Pine.LNX.4.44.0408232112490.5481-100000@gannet.stats>
References: <Pine.SOL.4.20.0408231458390.28864-100000@santiam.dfci.harvard.edu>
	<Pine.LNX.4.44.0408232112490.5481-100000@gannet.stats>
Message-ID: <16682.59058.349907.367669@gargle.gargle.HOWL>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Mon, 23 Aug 2004 21:14:44 +0100 (BST) writes:

    BDR> On Mon, 23 Aug 2004, Jeff Gentry wrote:
    >> > What version of perl?
    >> 
    >> Ack, didn't realize it was this ancient.  Version 5.005_03, which is what
    >> comes with FreeBSD 4.9 apparently.  I did install the /usr/ports version
    >> of perl is 5.8.2, although there seems to be other problems here (which
    >> are most likely related to my system, will track that down before bringing
    >> that issue up - it appears to be a mismatch on my libraries between the
    >> two versions).

    BDR> Yes, that version of perl has a lot of bugs, but in theory we support it.
    BDR> (It seems worse than either 5.004 or 5.005_04.)

    >> >     print $latexout &latex_link_trans0($blocks{"name"});
    >> > will probably solve it for you.
    >> 
    >> Yup, this works, thanks.

    BDR> I've changed the sources, to be defensive.  I don't like reading Perl
    BDR> like that, but it does work more portably.

I'm glad for the change.
Our redhat enterprise version of perl (5.8.0) also couldn't deal
with the other syntax.

Martin

From ligges at statistik.uni-dortmund.de  Tue Aug 24 10:08:03 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue Aug 24 10:06:58 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
In-Reply-To: <412A803E.1020608@stat.auckland.ac.nz>
References: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>
	<4128BC4D.1090204@statistik.uni-dortmund.de>
	<412A803E.1020608@stat.auckland.ac.nz>
Message-ID: <412AF763.3070201@statistik.uni-dortmund.de>

Paul Murrell wrote:

> Hi
> 
> 
> Uwe Ligges wrote:
> 
>> ligges@statistik.uni-dortmund.de wrote:
>>
>>> joehl@gmx.de wrote:
>>>
>>>
>>>> Dear all,
>>>> Our quite basic function mtext() does wrong adjustments in some 
>>>> parameter
>>>> configurations. This gets obvious when using multi line texts: There 
>>>> is no
>>>> way to properly adjust text perpendicular to axis 2, for example.
>>>>
>>>> Best
>>>>
>>>>
>>>> Jens Oehlschl?gel
>>>>
>>>>
>>>> m <- matrix(1:9, 3)
>>>> colnames(m) <- c("several\nlines", "several\nlines", "several\nlines")
>>>>
>>>> par(mfrow=c(2,2))
>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 
>>>> adj=0.5 is
>>>> fine")
>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, 
>>>> adj=0.5)
>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 
>>>> adj=1 is
>>>> different")
>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, 
>>>> adj=1)
>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=1 
>>>> adj=0.5 is
>>>> NOT fine")
>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, 
>>>> adj=0.5)
>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="at las=1, 
>>>> adj=1
>>>> works the wrong direction", sub="no way to get adj=c(1, 0.5) with 
>>>> las=1 (or
>>>> 2)")
>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, 
>>>> adj=1)
>>>> par(mfrow=c(1,1))
>>>>
>>>
>>>
>>> Left / right adjustemnt seems to be perfectly OK.
>>> The thing that matters is centering "several lines" to the specified 
>>> ("at=") location.
>>> In fact, mtext() is not centering but bottom-aligning by adding a 
>>> negative distance that looks OK for one line in the default font 
>>> size, but not in most other cases.
>>>
>>> Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment 
>>> of perpendicular text"). Fixing this, and/or improving mtext()'s 
>>> "adj" argument to accept 2 dimensions is desirable, but might be not 
>>> that easy... I'll take a look during the next days, but nothing 
>>> promised.
>>>
>>> Uwe Ligges
>>
>>
>>
>>
>> Having looked into the code, there are three possible solution (all with
>> some drawbacks) I can see. Well, the current argument "adj" becomes
>> "xadj" in the C sources (graphics.c, GMtext), and "yadj" is set to 0. 
>> Hence the ugly hard coded LineBias of 0.3.
>>
>>
>> Solutions
>> =========
>> 1: Hardcode "yadj" to 0.5 and remove all those 0.3 biases. Looks good 
>> for axes, but it might break some code --> bad.
>> On the other hand, GMMathText has hardcoded yadj=0.5. Is there a 
>> problem with some special devices? Or any other reason not to center 
>> stuff using "adj=0.5"?
>>
>> 2: Allow the typical 2-value adj, take the first as xadj, the second one
>> as yadj. This might break some code, because currently adj of
>> arbitrary length (!=0) is allowed and recycled.
>>
>> 3: Invent an argument "padj" for mtext() that represents adjustment
>> *p*erpendicular to the text direction and gets mapped to "yadj" in
>> GMtext. In that case the hardcoded 0.3 bias mentioned above can be
>> removed. The question is whether to set the default to 0.5 (will still
>> break code, but easily to fix by setting padj to 0).
>>
>> I'd like to propose the third solution and would be happy to provide a
>> patch of GMText, including corresponding patches to GMMathText, as 
>> well as mtext(), title() and axis() (and their inderlying do_* 
>> components).
>>
>> Are there any objections? Any reasons not to do it?
> 
> 
> 
> It hurts my head to think about this stuff.  There are so many 
> combinations to worry about:
> (i)   The las setting
> (ii)  The axis (bottom, left, top, right)
> (iii) Whether adj has been specified
> (iv)  Whether the text is multi-line
> 
> I think mtext() does ok as long as adj is not specified and the text is 
> single-line.

Unfortunately it does *not* (using axis() here for simplicity):
   plot(1:10)
   axis(3, cex.axis=5, las=2)


> I would suggest addressing the multi-line problem for unspecified adj as 
> a first step.  And I will definitely not mourn the passing of the 0.3 
> constant.  Setting yadj to 0.5 is not enough though because that doesn't 
> make sense for multi-line text that is parallel to an axis (in that 
> case, yadj should probably be 0 for axis 2 and 3 and 1 for axis 1 and 4; 
>  did I mention that there are lots of combinations to worry about?).

I think most of the stuff is already quite pretty.
The point is whether we are going to distinguish cases for 
(p)adj={0,0.5,1} automatically or not. If the latter, we can omit 
several of the cases mentioned above in (i)-(iv).
I think - as the first step - we should set the default to center (note 
that text() does so as well), and let the user change padj for 
multi-line text as required.

I'll try to provide a collection of patches as a proposal within, say, 
two weeks.

Uwe


> For user-specified adj, I agree that a 2-value adj is not a good 
> solution (adj is assumed to be horizontal adjustment) so maybe a padj 
> would be best to allow user control of vertical alignment.
 >
> Paul

From B.Rowlingson at lancaster.ac.uk  Tue Aug 24 10:54:12 2004
From: B.Rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue Aug 24 10:54:13 2004
Subject: [Rd] idea for "virtual matrix/array" class
In-Reply-To: <Pine.A41.4.58.0408231402330.39702@homer08.u.washington.edu>
References: <6.1.0.6.2.20040823120230.06461ff0@mailhost.blackmesacapital.com>
	<Pine.A41.4.58.0408231402330.39702@homer08.u.washington.edu>
Message-ID: <412B0234.3050504@lancaster.ac.uk>

Thomas Lumley wrote:
> On Mon, 23 Aug 2004, Tony Plate wrote:
> 
>>One idea I was thinking about was to have a new class of object that
>>referred to data in a file on disk, and which had all the standard methods
>>of matrices and arrays, i.e., subsetting ("["), dim, dimnames, etc. 
> 
> This is what RPgSql does with proxy dataframes and what I did (read-only)
> for netCDF access. It's a good idea if you have a data format for which
> random access is fairly fast.  I'm not sure that the standard serialized
> binary format satisfies this.  Fixed-format text files would work, but
> free-format ones wouldn't -- seek() only helps when you can work out where
> to seek without reading all the data.

  Just to join in on the 'done it' threads here, this is what my Rmap 
package does with DBF files (they are the database component of ESRI 
Shapefile maps). I use the dbf library from shapelib to access a DBF 
file just like a data frame.

  My dbf objects keep track of selected rows and columns, from the 
database file, so its possible to do:

  db1 = db[1:10,]

  and db1 is still a proxy object to the same DBF file as db, but with 
attributes that tell it that it only has rows 1 to 10 in it. If you 
really want a data frame, you just as.data.frame() it.

  If you wanted to do this sort of thing for space-saving reasons you'd 
have to be very careful, since for some operations R might slurp it all 
into memory.

Baz

http://www.maths.lancs.ac.uk/Software/Rmap/

From bjg at network-theory.co.uk  Tue Aug 24 13:00:06 2004
From: bjg at network-theory.co.uk (bjg@network-theory.co.uk)
Date: Tue Aug 24 13:00:11 2004
Subject: [Rd] additional examples for R-intro.texi (PR#7195)
Message-ID: <20040824110006.E48B710451@slim.kubism.ku.dk>

Here are some patches to expand some of the examples in R-intro.texi.

-- 
Brian Gough

Network Theory Ltd,
Publishing the R Reference Manuals --- http://www.network-theory.co.uk/R/

--- R-intro.texi~	Tue Aug 24 11:21:37 2004
+++ R-intro.texi	Tue Aug 24 11:21:37 2004
@@ -6288,6 +6288,21 @@
 use
 
 @example
+> help(package = "@var{name}")
+@end example
+
+A complete list of the user-level objects in a package can be displayed
+using the command
+
+@example
+> ls("package:@var{name}")
+@end example
+
+For example, @code{ls("package:base")} displays all the base package
+commands.  Alternatively, if you have a web-browser available, you can
+use
+
+@example
 > help.start()
 @end example
 
--- R-intro.texi~	Tue Aug 24 11:21:37 2004
+++ R-intro.texi	Tue Aug 24 11:21:37 2004
@@ -5019,6 +5019,31 @@
 
 After the fitting, @code{out$minimum} is the SSE, and
 @code{out$estimates} are the least squares estimates of the parameters.
+
+@example
+> out
+$minimum
+[1] 1195.449
+
+$estimate
+[1] 212.68384222   0.06412146
+
+$gradient
+[1] -0.0001535012  0.0934206673
+
+$hessian
+            [,1]        [,2]
+[1,]    11.94725   -7661.319
+[2,] -7661.31875 8039421.153
+
+$code
+[1] 3
+
+$iterations
+[1] 26
+@end example
+
+
 To obtain the approximate standard errors (SE) of the estimates we do:
 
 @example
@@ -5032,7 +5057,7 @@
 @example
 > plot(x, y)
 > xfit <- seq(.02, 1.1, .05)
-> yfit <- 212.68384222 * xfit/(0.06412146 + xfit)
+> yfit <- out$estimate[1] * xfit/(out$estimate[2] + xfit)
 > lines(spline(xfit, yfit))
 @end example
 
--- R-intro.texi~	Tue Aug 24 11:21:38 2004
+++ R-intro.texi	Tue Aug 24 11:21:38 2004
@@ -3307,8 +3307,8 @@
 @R{} is an expression language in the sense that its only command type
 is a function or expression which returns a result.  Even an assignment
 is an expression whose result is the value assigned, and it may be used
-wherever any expression may be used; in particular multiple assignments
-are possible.
+wherever any expression may be used; in particular, multiple assignments
+such as @code{x <- y <- z <- 0} are possible.
 
 Commands may be grouped together in braces, @code{@{@var{expr_1};
 @var{@dots{}}; @var{expr_m}@}}, in which case the value of the group
--- R-intro.texi~	Tue Aug 24 11:21:38 2004
+++ R-intro.texi	Tue Aug 24 11:21:38 2004
@@ -2021,9 +2021,8 @@
 @example
 > solve(A,b)
 @end example
-
 @noindent
-solves the system, returning @code{x} (up to some accuracy loss).
+solves the system @math{A x = b}, returning @code{x} (up to some accuracy loss).
 Note that in linear algebra, formally
 @eqn{@strong{x} = @strong{A}^{-1} @strong{b}, @code{x = A^@{-1@} %*% b}}
 where
--- R-intro.texi~	Tue Aug 24 11:21:39 2004
+++ R-intro.texi	Tue Aug 24 11:21:39 2004
@@ -413,7 +413,21 @@
 
 @findex help.search
 The @code{help.search} command allows searching for help in various
-ways: try @code{?help.search} for details and examples.
+ways: 
+
+@example
+> help.search("linear models") 
+Help files with alias or title matching `linear models',
+type `help(FOO, package = PKG)' to inspect entry `FOO(PKG) TITLE':
+
+glm(base)               Fitting Generalized Linear Models
+lm(base)                Fitting Linear Models
+lm.fit(base)            Fitter Functions for Linear Models
+loglin(base)            Fitting Log-Linear Models
+......                  .......
+@end example
+@noindent
+Use the command @code{?help.search} for further details and examples.
 
 The examples on a help topic can normally be run by
 
--- R-intro.texi~	Tue Aug 24 11:21:39 2004
+++ R-intro.texi	Tue Aug 24 11:21:39 2004
@@ -3966,17 +3966,27 @@
     @}
   )
 @}
+@end example
+The function can then be used as follows:
 
-ross <- open.account(100)
-robert <- open.account(200)
+@example
+> ross <- open.account(100)
+> robert <- open.account(200)
 
-ross$withdraw(30)
-ross$balance()
-robert$balance()
+> ross$withdraw(30)
+30 withdrawn.  Your balance is 70
+> ross$balance()
+Your balance is 70 
+> robert$balance()
+Your balance is 200 
 
-ross$deposit(50)
-ross$balance()
-ross$withdraw(500)
+> ross$deposit(50)
+50 deposited.  Your balance is 120 
+> ross$balance()
+Your balance is 120 
+> ross$withdraw(500)
+Error in ross$withdraw(500) : You don't have that 
+  much money!
 @end example
 
 @node Customizing the environment, Object orientation, Scope, Writing your own functions
--- R-intro.texi~	Tue Aug 24 11:21:39 2004
+++ R-intro.texi	Tue Aug 24 11:21:39 2004
@@ -3848,6 +3848,17 @@
   fun1(f, a, b, fa, fb, a0, eps, lim, fun1)
 @}
 @end example
+@noindent
+The following test cases demonstrate the use of this function:
+
+@example
+> area(sqrt,0,1)
+0.6666557
+> testfn <- function(x) 1/(1+x^2)
+> area(testfn, 0, 100)
+1.560808
+@end example
+
 
 @menu
 * Scope::

From david.meyer at wu-wien.ac.at  Tue Aug 24 13:29:34 2004
From: david.meyer at wu-wien.ac.at (david.meyer@wu-wien.ac.at)
Date: Tue Aug 24 13:29:35 2004
Subject: [Rd] replacement functions and lists (PR#7196)
Message-ID: <20040824112934.1A02D10483@slim.kubism.ku.dk>

Full_Name: David Meyer
Version: 2.0.0
OS: linux
Submission from: (NULL) (137.208.224.32)


l = list()
l[[2:3]] = 1

segfaults at least since 1.8.1

From ripley at stats.ox.ac.uk  Tue Aug 24 14:26:46 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 24 14:26:52 2004
Subject: [Rd] replacement functions and lists (PR#7196)
In-Reply-To: <20040824112934.1A02D10483@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408241326000.362-100000@gannet.stats>

A couple of incorrect range chacks, now fixed thank you.

On Tue, 24 Aug 2004 david.meyer@wu-wien.ac.at wrote:

> Full_Name: David Meyer
> Version: 2.0.0
> OS: linux
> Submission from: (NULL) (137.208.224.32)
> 
> 
> l = list()
> l[[2:3]] = 1
> 
> segfaults at least since 1.8.1
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From FWS4 at CDRH.FDA.GOV  Tue Aug 24 16:31:06 2004
From: FWS4 at CDRH.FDA.GOV (Samuelson, Frank*)
Date: Tue Aug 24 16:31:31 2004
Subject: [Rd] Need help debugging R.
Message-ID: <644D9337A02FC24689647BF9E48EC39E08ABB87B@drm556>


I originally posted this to R-help, but here is probably a better place.

I have a rather complex routine which works great in R.
Then I bootstrap it.  After running a few minutes it typically segfaults,
though it happens very randomly.
This happens w/ 1.9.0 and 1.9.1 on Fedora1 and a Scyld (RH7.3) system.
Traces always point back to routines in src/main/memory.c, though often
not the same routines.

Now for the strangeness:
It's never the same routines that appear in the trace.  
The trace gives sequential routine names that aren't called 
by previous routines.  Almost none of the variable names print in gdb.

I've even tried turning optimizations all the way off
and setting -g3 and I get the same problems.
 
Are there any important things I should know about debugging R
that I'm not doing?  Is this just total memory corruption? 


For what it's worth a sample trace below:
(gdb) where
#0  0x00a22096 in _int_free () from /lib/tls/libc.so.6
#1  0x00a2101b in free () from /lib/tls/libc.so.6
#2  0x080d632a in R_SetPPSize ()
#3  0x080d7d13 in do_regFinaliz ()
#4  0x080d9503 in do_gctime ()
#5  0x080d8fcb in Rf_allocVector ()
#6  0x080a9f7f in Rf_duplicate ()
#7  0x080aa18c in Rf_duplicate ()
#8  0x080b7b28 in R_execMethod ()
#9  0x080b8a0f in do_function ()
#10 0x080b8bf9 in do_function ()
#11 0x080b70b7 in Rf_eval ()
#12 0x080b87a5 in do_begin ()
#13 0x080b70b7 in Rf_eval ()
#14 0x080b80b1 in do_for ()
#15 0x080b70b7 in Rf_eval ()
#16 0x080b87a5 in do_begin ()
#17 0x080b70b7 in Rf_eval ()
#18 0x080b70b7 in Rf_eval ()
#19 0x080b87a5 in do_begin ()
#20 0x080b70b7 in Rf_eval ()
#21 0x080b73c3 in Rf_applyClosure ()
#22 0x080e03b4 in do_internal ()
#23 0x080e0b37 in Rf_usemethod ()
#24 0x080b9f34 in Rf_DispatchOrEval ()
#25 0x0813b48b in do_subset ()
#26 0x09fe39f0 in ?? ()
#27 0x081d620b in _length_code ()
#28 0x0be7aa5c in ?? ()
#29 0x0c05a050 in ?? ()
#30 0xbff046a8 in ?? ()

From ripley at stats.ox.ac.uk  Tue Aug 24 16:40:55 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 24 16:40:58 2004
Subject: [Rd] Need help debugging R.
In-Reply-To: <644D9337A02FC24689647BF9E48EC39E08ABB87B@drm556>
Message-ID: <Pine.LNX.4.44.0408241536590.2117-100000@gannet.stats>

You need one of

1) gctorture(TRUE)

2) Run under valgrind to look for memory overruns.

and patience.  If it segfaults under gctorture you will probably see the 
real culprit via gdb.

I would try under R-devel, as quite a few memory problems have been 
plugged there.  Or at least under R-patched (ditto, but not quite all 
those in R-devel).

On Tue, 24 Aug 2004, Samuelson, Frank* wrote:

> 
> I originally posted this to R-help, but here is probably a better place.
> 
> I have a rather complex routine which works great in R.
> Then I bootstrap it.  After running a few minutes it typically segfaults,
> though it happens very randomly.
> This happens w/ 1.9.0 and 1.9.1 on Fedora1 and a Scyld (RH7.3) system.
> Traces always point back to routines in src/main/memory.c, though often
> not the same routines.
> 
> Now for the strangeness:
> It's never the same routines that appear in the trace.  
> The trace gives sequential routine names that aren't called 
> by previous routines.  Almost none of the variable names print in gdb.
> 
> I've even tried turning optimizations all the way off
> and setting -g3 and I get the same problems.
>  
> Are there any important things I should know about debugging R
> that I'm not doing?  Is this just total memory corruption? 
> 
> 
> For what it's worth a sample trace below:
> (gdb) where
> #0  0x00a22096 in _int_free () from /lib/tls/libc.so.6
> #1  0x00a2101b in free () from /lib/tls/libc.so.6
> #2  0x080d632a in R_SetPPSize ()
> #3  0x080d7d13 in do_regFinaliz ()
> #4  0x080d9503 in do_gctime ()
> #5  0x080d8fcb in Rf_allocVector ()
> #6  0x080a9f7f in Rf_duplicate ()
> #7  0x080aa18c in Rf_duplicate ()
> #8  0x080b7b28 in R_execMethod ()
> #9  0x080b8a0f in do_function ()
> #10 0x080b8bf9 in do_function ()
> #11 0x080b70b7 in Rf_eval ()
> #12 0x080b87a5 in do_begin ()
> #13 0x080b70b7 in Rf_eval ()
> #14 0x080b80b1 in do_for ()
> #15 0x080b70b7 in Rf_eval ()
> #16 0x080b87a5 in do_begin ()
> #17 0x080b70b7 in Rf_eval ()
> #18 0x080b70b7 in Rf_eval ()
> #19 0x080b87a5 in do_begin ()
> #20 0x080b70b7 in Rf_eval ()
> #21 0x080b73c3 in Rf_applyClosure ()
> #22 0x080e03b4 in do_internal ()
> #23 0x080e0b37 in Rf_usemethod ()
> #24 0x080b9f34 in Rf_DispatchOrEval ()
> #25 0x0813b48b in do_subset ()
> #26 0x09fe39f0 in ?? ()
> #27 0x081d620b in _length_code ()
> #28 0x0be7aa5c in ?? ()
> #29 0x0c05a050 in ?? ()
> #30 0xbff046a8 in ?? ()
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Tue Aug 24 16:53:41 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Aug 24 16:58:37 2004
Subject: [Rd] Need help debugging R.
In-Reply-To: <Pine.LNX.4.44.0408241536590.2117-100000@gannet.stats>
References: <Pine.LNX.4.44.0408241536590.2117-100000@gannet.stats>
Message-ID: <x2brh01tai.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> You need one of
> 
> 1) gctorture(TRUE)
> 
> 2) Run under valgrind to look for memory overruns.
> 
> and patience.  If it segfaults under gctorture you will probably see the 
> real culprit via gdb.
> 
> I would try under R-devel, as quite a few memory problems have been 
> plugged there.  Or at least under R-patched (ditto, but not quite all 
> those in R-devel).

Other tricks: record the gc_count value at the crash and set a break
conditional on that value, before stack corruption sets in. Or break
at the previous value, and then set the gctorture switch. Once you
figure out which memory location has inconsistent data, set a hardware
watchpoint on it. Might take quite a bit of stamina, in additeon to
the patience...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From huan.huang at bnpparibas.com  Tue Aug 24 17:04:32 2004
From: huan.huang at bnpparibas.com (huan.huang@bnpparibas.com)
Date: Tue Aug 24 17:04:34 2004
Subject: [Rd] error when unsubscribe (PR#7198)
Message-ID: <20040824150432.33EF010454@slim.kubism.ku.dk>

Full_Name: Huan Huang
Version: 1.9.1
OS: Win NT
Submission from: (NULL) (155.140.122.227)


Traceback:

Traceback (most recent call last):
  File "/scratch/local/app/mailman-sfs/2.1.5/scripts/driver", line 87, in
run_main
    main()
  File "/scratch/local/app/mailman-sfs/2.1.5/Mailman/Cgi/options.py", line 91,
in main
    language = cgidata.getvalue('language')
  File "/scratch/local/app/python/2.3/lib/python2.3/cgi.py", line 560, in
getvalue
    if key in self:
  File "/scratch/local/app/python/2.3/lib/python2.3/cgi.py", line 611, in
__contains__
    raise TypeError, "not indexable"
TypeError: not indexable





--------------------------------------------------------------------------------

Python information:
Variable Value 
sys.version 2.3 (#1, Oct 16 2003, 05:04:34) [GCC 3.2.2 20030222 (Red Hat Linux
3.2.2-5)]  
sys.executable /scratch/local/app/python/current/bin/python  
sys.prefix /scratch/local/app/python/current  
sys.exec_prefix /scratch/local/app/python/current  
sys.path /scratch/local/app/python/current  
sys.platform linux2  




--------------------------------------------------------------------------------

Environment variables:
Variable Value 
force_response_1_0  1  
SSL_SERVER_I_DN_OU  Department of Mathematics  
SSL_CIPHER_EXPORT  false  
SSL_SERVER_S_DN_Email  webmaster@math.ethz.ch  
SERVER_SOFTWARE  Apache/2.0.48 (Unix)  
SSL_VERSION_INTERFACE  mod_ssl/2.0.48  
SCRIPT_NAME  /mailman/options  
SSL_SERVER_A_KEY  rsaEncryption  
SSL_SERVER_S_DN_ST  Switzerland  
SERVER_SIGNATURE  Apache/2.0.48 (Unix) Server at stat.ethz.ch Port 443 
REQUEST_METHOD  POST  
PATH_INFO  /r-help  
SERVER_PROTOCOL  HTTP/1.1  
SSL_SERVER_S_DN  /C=CH/ST=Switzerland/L=Zurich/O=ETH Zurich/OU=Seminar for
Statistics/CN=stat.ethz.ch/emailAddress=webmaster@math.ethz.ch  
SSL_CIPHER  RC4-MD5  
SSL_SERVER_V_START  Jan 9 12:56:05 2004 GMT  
SSL_SESSION_ID  210587E0DB04D2F7DAF67D64B4E9DDBA2F059B4E0671DD165F319D9EB1BB2057
 
CONTENT_LENGTH  83  
SSL_CLIENT_VERIFY  NONE  
SSL_SERVER_I_DN_ST  Switzerland  
SSL_SERVER_S_DN_O  ETH Zurich  
HTTP_REFERER  https://stat.ethz.ch/mailman/listinfo/r-help,
https://stat.ethz.ch/mailman/listinfo/r-help  
SERVER_NAME  stat.ethz.ch  
REMOTE_ADDR  155.140.122.227  
SSL_CIPHER_ALGKEYSIZE  128  
SSL_SERVER_I_DN  /C=CH/ST=Switzerland/L=Zurich/O=ETH Zurich/OU=Department of
Mathematics/CN=ISG D-MATH/emailAddress=webmaster@math.ethz.ch  
SSL_SERVER_I_DN_C  CH  
SSL_SERVER_M_VERSION  1  
SSL_SERVER_I_DN_O  ETH Zurich  
SERVER_ADDR  129.132.148.136  
DOCUMENT_ROOT  /var/www/vhosts/sfs/htdocs  
SSL_SERVER_S_DN_OU  Seminar for Statistics  
SERVER_PORT  443  
SSL_SERVER_I_DN_Email  webmaster@math.ethz.ch  
SSL_VERSION_LIBRARY  OpenSSL/0.9.7a  
PYTHONPATH  /scratch/local/app/mailman-sfs/2.1.5  
SCRIPT_FILENAME  /var/www/vhosts/sfs/mailman/options  
SERVER_ADMIN  webmaster@math.ethz.ch  
SCRIPT_URI  https://stat.ethz.ch/mailman/options/r-help  
SSL_SERVER_A_SIG  md5WithRSAEncryption  
SSL_SERVER_S_DN_L  Zurich  
HTTP_HOST  stat.ethz.ch  
SCRIPT_URL  /mailman/options/r-help  
HTTPS  on  
SSL_SERVER_I_DN_L  Zurich  
HTTP_CONNECTION  Keep-Alive  
PATH_TRANSLATED  /var/www/vhosts/sfs/htdocs/r-help  
HTTP_CACHE_CONTROL  no-cache  
SSL_SERVER_S_DN_C  CH  
REQUEST_URI  /mailman/options/r-help  
HTTP_ACCEPT  application/vnd.ms-excel, application/msword,
application/vnd.ms-powerpoint, image/gif, image/x-xbitmap, image/jpeg,
image/pjpeg, */*  
SSL_SERVER_M_SERIAL  13  
SSL_SERVER_S_DN_CN  stat.ethz.ch  
HTTP_USER_AGENT  Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 4.0; H010818; (R1
1.3))  
nokeepalive  1  
GATEWAY_INTERFACE  CGI/1.1  
SSL_PROTOCOL  SSLv3  
REMOTE_PORT  39557  
HTTP_ACCEPT_LANGUAGE  en-gb, en-gb  
HTTP_ACCEPT_ENCODING  gzip, deflate, gzip, deflate  
ssl_unclean_shutdown  1  
SSL_SERVER_V_END  Jan 6 12:56:05 2014 GMT  
CONTENT_TYPE  application/x-www-form-urlencoded,
application/x-www-form-urlencoded  
SSL_SERVER_I_DN_CN  ISG D-MATH  
QUERY_STRING   
SSL_CIPHER_USEKEYSIZE  128  
downgrade_1_0  1  
UNIQUE_ID  pOtOOYGElIIAAAlOUt0AAAAD

From jmc at research.bell-labs.com  Tue Aug 24 17:10:00 2004
From: jmc at research.bell-labs.com (John Chambers)
Date: Tue Aug 24 17:10:11 2004
Subject: [Rd] Changes to correct problems with classes in namespaces
Message-ID: <412B5A48.CC835E1F@research.bell-labs.com>

An extensive set of changes to the methods package has been committed
today to allow non-exported classes from packages with namespaces (and
some related fixes in dealing with generic functions from namespaces as
well).

The namespace mechanism requires packages to export any class
definitions that are part of the API.  Unfortunately, NOT exporting
classes has never really worked.

The problem was essentially that computations such as method dispatch
used the character-string name of a class, with no information about
where that class came from.  For non-exported classes, this caused many
computations down the line to fail.  Related problems came from not
using the generic function objects and the class definition objects.

The modified code passes the usual check and check-devel tests, plus
some tests for dealing with private classes, but if you have packages
that use methods extensively, please try these with the current r-devel
as soon as possible.

John
-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From ripley at stats.ox.ac.uk  Tue Aug 24 18:04:17 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 24 18:04:21 2004
Subject: [Rd] error when unsubscribe (PR#7198)
In-Reply-To: <20040824150432.33EF010454@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408241703350.2242-100000@gannet.stats>

R-bugs is not a mailing list: have you sent this to the wrong place?

On Tue, 24 Aug 2004 huan.huang@bnpparibas.com wrote:

> Full_Name: Huan Huang
> Version: 1.9.1
> OS: Win NT
> Submission from: (NULL) (155.140.122.227)
> 
> 
> Traceback:
> 
> Traceback (most recent call last):
>   File "/scratch/local/app/mailman-sfs/2.1.5/scripts/driver", line 87, in
> run_main
>     main()
>   File "/scratch/local/app/mailman-sfs/2.1.5/Mailman/Cgi/options.py", line 91,
> in main
>     language = cgidata.getvalue('language')
>   File "/scratch/local/app/python/2.3/lib/python2.3/cgi.py", line 560, in
> getvalue
>     if key in self:
>   File "/scratch/local/app/python/2.3/lib/python2.3/cgi.py", line 611, in
> __contains__
>     raise TypeError, "not indexable"
> TypeError: not indexable
> 
> 
> 
> 
> 
> --------------------------------------------------------------------------------
> 
> Python information:
> Variable Value 
> sys.version 2.3 (#1, Oct 16 2003, 05:04:34) [GCC 3.2.2 20030222 (Red Hat Linux
> 3.2.2-5)]  
> sys.executable /scratch/local/app/python/current/bin/python  
> sys.prefix /scratch/local/app/python/current  
> sys.exec_prefix /scratch/local/app/python/current  
> sys.path /scratch/local/app/python/current  
> sys.platform linux2  
> 
> 
> 
> 
> --------------------------------------------------------------------------------
> 
> Environment variables:
> Variable Value 
> force_response_1_0  1  
> SSL_SERVER_I_DN_OU  Department of Mathematics  
> SSL_CIPHER_EXPORT  false  
> SSL_SERVER_S_DN_Email  webmaster@math.ethz.ch  
> SERVER_SOFTWARE  Apache/2.0.48 (Unix)  
> SSL_VERSION_INTERFACE  mod_ssl/2.0.48  
> SCRIPT_NAME  /mailman/options  
> SSL_SERVER_A_KEY  rsaEncryption  
> SSL_SERVER_S_DN_ST  Switzerland  
> SERVER_SIGNATURE  Apache/2.0.48 (Unix) Server at stat.ethz.ch Port 443 
> REQUEST_METHOD  POST  
> PATH_INFO  /r-help  
> SERVER_PROTOCOL  HTTP/1.1  
> SSL_SERVER_S_DN  /C=CH/ST=Switzerland/L=Zurich/O=ETH Zurich/OU=Seminar for
> Statistics/CN=stat.ethz.ch/emailAddress=webmaster@math.ethz.ch  
> SSL_CIPHER  RC4-MD5  
> SSL_SERVER_V_START  Jan 9 12:56:05 2004 GMT  
> SSL_SESSION_ID  210587E0DB04D2F7DAF67D64B4E9DDBA2F059B4E0671DD165F319D9EB1BB2057
>  
> CONTENT_LENGTH  83  
> SSL_CLIENT_VERIFY  NONE  
> SSL_SERVER_I_DN_ST  Switzerland  
> SSL_SERVER_S_DN_O  ETH Zurich  
> HTTP_REFERER  https://stat.ethz.ch/mailman/listinfo/r-help,
> https://stat.ethz.ch/mailman/listinfo/r-help  
> SERVER_NAME  stat.ethz.ch  
> REMOTE_ADDR  155.140.122.227  
> SSL_CIPHER_ALGKEYSIZE  128  
> SSL_SERVER_I_DN  /C=CH/ST=Switzerland/L=Zurich/O=ETH Zurich/OU=Department of
> Mathematics/CN=ISG D-MATH/emailAddress=webmaster@math.ethz.ch  
> SSL_SERVER_I_DN_C  CH  
> SSL_SERVER_M_VERSION  1  
> SSL_SERVER_I_DN_O  ETH Zurich  
> SERVER_ADDR  129.132.148.136  
> DOCUMENT_ROOT  /var/www/vhosts/sfs/htdocs  
> SSL_SERVER_S_DN_OU  Seminar for Statistics  
> SERVER_PORT  443  
> SSL_SERVER_I_DN_Email  webmaster@math.ethz.ch  
> SSL_VERSION_LIBRARY  OpenSSL/0.9.7a  
> PYTHONPATH  /scratch/local/app/mailman-sfs/2.1.5  
> SCRIPT_FILENAME  /var/www/vhosts/sfs/mailman/options  
> SERVER_ADMIN  webmaster@math.ethz.ch  
> SCRIPT_URI  https://stat.ethz.ch/mailman/options/r-help  
> SSL_SERVER_A_SIG  md5WithRSAEncryption  
> SSL_SERVER_S_DN_L  Zurich  
> HTTP_HOST  stat.ethz.ch  
> SCRIPT_URL  /mailman/options/r-help  
> HTTPS  on  
> SSL_SERVER_I_DN_L  Zurich  
> HTTP_CONNECTION  Keep-Alive  
> PATH_TRANSLATED  /var/www/vhosts/sfs/htdocs/r-help  
> HTTP_CACHE_CONTROL  no-cache  
> SSL_SERVER_S_DN_C  CH  
> REQUEST_URI  /mailman/options/r-help  
> HTTP_ACCEPT  application/vnd.ms-excel, application/msword,
> application/vnd.ms-powerpoint, image/gif, image/x-xbitmap, image/jpeg,
> image/pjpeg, */*  
> SSL_SERVER_M_SERIAL  13  
> SSL_SERVER_S_DN_CN  stat.ethz.ch  
> HTTP_USER_AGENT  Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 4.0; H010818; (R1
> 1.3))  
> nokeepalive  1  
> GATEWAY_INTERFACE  CGI/1.1  
> SSL_PROTOCOL  SSLv3  
> REMOTE_PORT  39557  
> HTTP_ACCEPT_LANGUAGE  en-gb, en-gb  
> HTTP_ACCEPT_ENCODING  gzip, deflate, gzip, deflate  
> ssl_unclean_shutdown  1  
> SSL_SERVER_V_END  Jan 6 12:56:05 2014 GMT  
> CONTENT_TYPE  application/x-www-form-urlencoded,
> application/x-www-form-urlencoded  
> SSL_SERVER_I_DN_CN  ISG D-MATH  
> QUERY_STRING   
> SSL_CIPHER_USEKEYSIZE  128  
> downgrade_1_0  1  
> UNIQUE_ID  pOtOOYGElIIAAAlOUt0AAAAD
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Aug 24 19:59:39 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 24 19:59:45 2004
Subject: [Rd] Changes to correct problems with classes in namespaces
In-Reply-To: <412B5A48.CC835E1F@research.bell-labs.com>
Message-ID: <Pine.LNX.4.44.0408241858480.16258-100000@gannet.stats>

John,

Looks like several packages are failing to dump or load with messages like
(SparseM)

Error in warning("Undefined slot classes in definition of \"",
classDef@className,  :
        Object "classDef" not found

So far I have seen this with SparseM, dynamicGraph (and hence deal and
gRbase).  Should that be `ClassDef'?  And is this a new error detected?

Brian


On Tue, 24 Aug 2004, John Chambers wrote:

> An extensive set of changes to the methods package has been committed
> today to allow non-exported classes from packages with namespaces (and
> some related fixes in dealing with generic functions from namespaces as
> well).
> 
> The namespace mechanism requires packages to export any class
> definitions that are part of the API.  Unfortunately, NOT exporting
> classes has never really worked.
> 
> The problem was essentially that computations such as method dispatch
> used the character-string name of a class, with no information about
> where that class came from.  For non-exported classes, this caused many
> computations down the line to fail.  Related problems came from not
> using the generic function objects and the class definition objects.
> 
> The modified code passes the usual check and check-devel tests, plus
> some tests for dealing with private classes, but if you have packages
> that use methods extensively, please try these with the current r-devel
> as soon as possible.
> 
> John
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From cstrato at aon.at  Tue Aug 24 20:23:12 2004
From: cstrato at aon.at (cstrato)
Date: Tue Aug 24 20:23:37 2004
Subject: [Rd] License of Mathlib
Message-ID: <412B8790.4030303@aon.at>

Dear R-Developers

I have a question regarding the license of Mathlib:
Is the license GPL or LGPL?

I am confused, since the file "nmath.h" mentions GPL in the header,
while the file "Rmath.h0.in" mentions LGPL in the header.

Best regards
Christian
_._._._._._._._._._._._._._._._
C.h.i.s.t.i.a.n S.t.r.a.t.o.w.a
V.i.e.n.n.a A.u.s.t.r.i.a
_._._._._._._._._._._._._._._._

From morey at banta.psyc.missouri.edu  Tue Aug 24 20:30:49 2004
From: morey at banta.psyc.missouri.edu (morey@banta.psyc.missouri.edu)
Date: Tue Aug 24 20:30:51 2004
Subject: [Rd] function bug (PR#7199)
Message-ID: <20040824183049.74B1F10483@slim.kubism.ku.dk>


output of R.version
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    9.1
year     2004
month    06
day      21
language R

The following code prints [1] 2, as it should

temp<-function(ab,...){
print(ab)
}
temp(2,s=3)

However, this code prints [1] 3:

temp<-function(sb,...){
print(sb)
}
temp(2,s=3)
 
It should still print [1] 2. It appears 
that if a variable in ... begins with the same letter as another variable, 
the value in the variable in ... overwrites the value in the variable with 
the same first letter.

I didn't see this bug reported elsewhere.

Richard Morey

-- 
Richard Morey
Graduate Research Assistant, Cognition and Neuroscience
University of Missouri-Columbia

From rpeng at jhsph.edu  Tue Aug 24 20:43:53 2004
From: rpeng at jhsph.edu (rpeng@jhsph.edu)
Date: Tue Aug 24 20:43:56 2004
Subject: [Rd] (PR#7199) function bug
Message-ID: <20040824184353.CE3B31047E@slim.kubism.ku.dk>

This is a misunderstanding, I think, not a bug.  R is using partial 
matching and the `2', since it is not named, is being sent through the 
`...'.

-roger

morey@banta.psyc.missouri.edu wrote:
> output of R.version
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    9.1
> year     2004
> month    06
> day      21
> language R
> 
> The following code prints [1] 2, as it should
> 
> temp<-function(ab,...){
> print(ab)
> }
> temp(2,s=3)
> 
> However, this code prints [1] 3:
> 
> temp<-function(sb,...){
> print(sb)
> }
> temp(2,s=3)
>  
> It should still print [1] 2. It appears 
> that if a variable in ... begins with the same letter as another variable, 
> the value in the variable in ... overwrites the value in the variable with 
> the same first letter.
> 
> I didn't see this bug reported elsewhere.
> 
> Richard Morey
>

From andy_liaw at merck.com  Tue Aug 24 20:44:24 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue Aug 24 20:44:56 2004
Subject: [Rd] function bug (PR#7199)
Message-ID: <3A822319EB35174CA3714066D590DCD504AF8294@usrymx25.merck.com>

This is _not_ a bug.  Please read `R Language Manual', section 4.3.2 (as
well as the R FAQ on what constitute a bug).

Andy

> From: morey@banta.psyc.missouri.edu
> 
> The following code prints [1] 2, as it should
> 
> temp<-function(ab,...){
> print(ab)
> }
> temp(2,s=3)
> 
> However, this code prints [1] 3:
> 
> temp<-function(sb,...){
> print(sb)
> }
> temp(2,s=3)
>  
> It should still print [1] 2. It appears 
> that if a variable in ... begins with the same letter as 
> another variable, 
> the value in the variable in ... overwrites the value in the 
> variable with 
> the same first letter.
> 
> I didn't see this bug reported elsewhere.
> 
> Richard Morey
> 
> -- 
> Richard Morey
> Graduate Research Assistant, Cognition and Neuroscience
> University of Missouri-Columbia
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From morey at banta.psyc.missouri.edu  Tue Aug 24 20:48:13 2004
From: morey at banta.psyc.missouri.edu (Richard Morey)
Date: Tue Aug 24 20:48:22 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <3A822319EB35174CA3714066D590DCD504AF8294@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.44.0408241348080.18254-100000@banta.psyc.missouri.edu>

Ok, thanks.

On Tue, 24 Aug 2004, Liaw, Andy wrote:

> This is _not_ a bug.  Please read `R Language Manual', section 4.3.2 (as
> well as the R FAQ on what constitute a bug).
> 
> Andy
> 
> > From: morey@banta.psyc.missouri.edu
> > 
> > The following code prints [1] 2, as it should
> > 
> > temp<-function(ab,...){
> > print(ab)
> > }
> > temp(2,s=3)
> > 
> > However, this code prints [1] 3:
> > 
> > temp<-function(sb,...){
> > print(sb)
> > }
> > temp(2,s=3)
> >  
> > It should still print [1] 2. It appears 
> > that if a variable in ... begins with the same letter as 
> > another variable, 
> > the value in the variable in ... overwrites the value in the 
> > variable with 
> > the same first letter.
> > 
> > I didn't see this bug reported elsewhere.
> > 
> > Richard Morey
> > 
> > -- 
> > Richard Morey
> > Graduate Research Assistant, Cognition and Neuroscience
> > University of Missouri-Columbia
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> > 
> > 
> 
> 
> ------------------------------------------------------------------------------
> Notice:  This e-mail message, together with any attachments, contains information of Merck & Co., Inc. (One Merck Drive, Whitehouse Station, New Jersey, USA 08889), and/or its affiliates (which may be known outside the United States as Merck Frosst, Merck Sharp & Dohme or MSD and in Japan, as Banyu) that may be confidential, proprietary copyrighted and/or legally privileged. It is intended solely for the use of the individual or entity named on this message.  If you are not the intended recipient, and have received this message in error, please notify us immediately by reply e-mail and then delete it from your system.
> ------------------------------------------------------------------------------
> 

-- 
Richard Morey
Graduate Research Assistant, Cognition and Neuroscience
University of Missouri-Columbia

From ripley at stats.ox.ac.uk  Tue Aug 24 20:55:38 2004
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue Aug 24 20:57:44 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <Pine.LNX.4.44.0408241348080.18254-100000@banta.psyc.missouri.edu>
References: <Pine.LNX.4.44.0408241348080.18254-100000@banta.psyc.missouri.edu>
Message-ID: <Pine.WNT.4.58.0408241953400.4600@auk>

I think you mean

`I apologize for wasting your time by sending the same incorrect idea to
both R-help and R-bugs without doing my homework.'

It is *not* OK for those who have to clear up after you.

On Tue, 24 Aug 2004, Richard Morey wrote:

> Ok, thanks.
>
> On Tue, 24 Aug 2004, Liaw, Andy wrote:
>
> > This is _not_ a bug.  Please read `R Language Manual', section 4.3.2 (as
> > well as the R FAQ on what constitute a bug).
> >
> > Andy
> >
> > > From: morey@banta.psyc.missouri.edu
> > >
> > > The following code prints [1] 2, as it should
> > >
> > > temp<-function(ab,...){
> > > print(ab)
> > > }
> > > temp(2,s=3)
> > >
> > > However, this code prints [1] 3:
> > >
> > > temp<-function(sb,...){
> > > print(sb)
> > > }
> > > temp(2,s=3)
> > >
> > > It should still print [1] 2. It appears
> > > that if a variable in ... begins with the same letter as
> > > another variable,
> > > the value in the variable in ... overwrites the value in the
> > > variable with
> > > the same first letter.
> > >
> > > I didn't see this bug reported elsewhere.
> > >
> > > Richard Morey
> > >
> > > --
> > > Richard Morey
> > > Graduate Research Assistant, Cognition and Neuroscience
> > > University of Missouri-Columbia
> > >
> > > ______________________________________________
> > > R-devel@stat.math.ethz.ch mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-devel
> > >
> > >
> >
> >
> > ------------------------------------------------------------------------------
> > Notice:  This e-mail message, together with any attachments, contains information of Merck & Co., Inc. (One Merck Drive, Whitehouse Station, New Jersey, USA 08889), and/or its affiliates (which may be known outside the United States as Merck Frosst, Merck Sharp & Dohme or MSD and in Japan, as Banyu) that may be confidential, proprietary copyrighted and/or legally privileged. It is intended solely for the use of the individual or entity named on this message.  If you are not the intended recipient, and have received this message in error, please notify us immediately by reply e-mail and then delete it from your system.
> > ------------------------------------------------------------------------------
> >
>
> --
> Richard Morey
> Graduate Research Assistant, Cognition and Neuroscience
> University of Missouri-Columbia
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Aug 24 20:58:41 2004
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue Aug 24 21:00:43 2004
Subject: [Rd] License of Mathlib
In-Reply-To: <412B8790.4030303@aon.at>
References: <412B8790.4030303@aon.at>
Message-ID: <Pine.WNT.4.58.0408241955570.4600@auk>

On Tue, 24 Aug 2004, cstrato wrote:

> Dear R-Developers
>
> I have a question regarding the license of Mathlib:
> Is the license GPL or LGPL?
>
> I am confused, since the file "nmath.h" mentions GPL in the header,
> while the file "Rmath.h0.in" mentions LGPL in the header.

More importantly, the C code of the functions is under GPL.
It is only the public header files (and nmath.h is private) that have LGPL
in them.  See the file COPYRIGHTS (which you seem not to be aware of).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From kleiweg at let.rug.nl  Tue Aug 24 21:05:52 2004
From: kleiweg at let.rug.nl (Peter Kleiweg)
Date: Tue Aug 24 21:06:00 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <3A822319EB35174CA3714066D590DCD504AF8294@usrymx25.merck.com>
Message-ID: <Pine.LNX.4.44.0408242102410.1119-100000@kleigh.nl>

Liaw, Andy schreef:

> This is _not_ a bug.  Please read `R Language Manual', section 4.3.2

I don't have the `R Language Manual'. Is it explained somewhere
in the docs that come with R?


-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From andy_liaw at merck.com  Tue Aug 24 21:06:47 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue Aug 24 21:07:15 2004
Subject: typo in R-lang (was RE: [Rd] function bug (PR#7199))
Message-ID: <3A822319EB35174CA3714066D590DCD504AF8295@usrymx25.merck.com>

BTW, there's a small typo in section 4.1.2 of that manual.  `A an argument
that is ...' should be `An argument that is ...'.

Andy

> From: Liaw, Andy
> 
> This is _not_ a bug.  Please read `R Language Manual', 
> section 4.3.2 (as
> well as the R FAQ on what constitute a bug).
> 
> Andy
> 
> > From: morey@banta.psyc.missouri.edu
> > 
> > The following code prints [1] 2, as it should
> > 
> > temp<-function(ab,...){
> > print(ab)
> > }
> > temp(2,s=3)
> > 
> > However, this code prints [1] 3:
> > 
> > temp<-function(sb,...){
> > print(sb)
> > }
> > temp(2,s=3)
> >  
> > It should still print [1] 2. It appears 
> > that if a variable in ... begins with the same letter as 
> > another variable, 
> > the value in the variable in ... overwrites the value in the 
> > variable with 
> > the same first letter.
> > 
> > I didn't see this bug reported elsewhere.
> > 
> > Richard Morey
> > 
> > -- 
> > Richard Morey
> > Graduate Research Assistant, Cognition and Neuroscience
> > University of Missouri-Columbia

From jgentry at jimmy.harvard.edu  Tue Aug 24 21:09:42 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Tue Aug 24 21:09:17 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <Pine.LNX.4.44.0408242102410.1119-100000@kleigh.nl>
Message-ID: <Pine.SOL.4.20.0408241509010.29899-100000@santiam.dfci.harvard.edu>

> I don't have the `R Language Manual'. Is it explained somewhere
> in the docs that come with R?

See: <R directory>/doc/manual/

From kleiweg at let.rug.nl  Tue Aug 24 21:09:52 2004
From: kleiweg at let.rug.nl (Peter Kleiweg)
Date: Tue Aug 24 21:09:54 2004
Subject: [Rd] (PR#7199) function bug
In-Reply-To: <20040824184353.CE3B31047E@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408242108500.1119-100000@kleigh.nl>

rpeng@jhsph.edu schreef:

> This is a misunderstanding, I think, not a bug.  R is using partial
> matching and the `2', since it is not named, is being sent through the
> `...'.

That is not very sensible behaviour, and it certainly doesn't
explain why 2 is set equal to 3.


-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From ripley at stats.ox.ac.uk  Tue Aug 24 21:15:11 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 24 21:15:17 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <Pine.LNX.4.44.0408242102410.1119-100000@kleigh.nl>
Message-ID: <Pine.LNX.4.44.0408242012530.11850-100000@gannet.stats>

On Tue, 24 Aug 2004, Peter Kleiweg wrote:

> Liaw, Andy schreef:
> 
> > This is _not_ a bug.  Please read `R Language Manual', section 4.3.2
> 
> I don't have the `R Language Manual'. Is it explained somewhere
> in the docs that come with R?

Amongst the docs that come with R is the `R Language Definition' manual.
File doc/manual/R-lang.texi, before processing.  People are quoting the
section numbers in the HTML/PDF conversion.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jmc at research.bell-labs.com  Tue Aug 24 21:21:57 2004
From: jmc at research.bell-labs.com (John Chambers)
Date: Tue Aug 24 21:22:16 2004
Subject: [Rd] Changes to correct problems with classes in namespaces
References: <Pine.LNX.4.44.0408241858480.16258-100000@gannet.stats>
Message-ID: <412B9555.2C098C35@research.bell-labs.com>

Prof Brian Ripley wrote:
> 
> John,
> 
> Looks like several packages are failing to dump or load with messages like
> (SparseM)
> 
> Error in warning("Undefined slot classes in definition of \"",
> classDef@className,  :
>         Object "classDef" not found
> 
> So far I have seen this with SparseM, dynamicGraph (and hence deal and
> gRbase).  Should that be `ClassDef'?  

It should.  Thanks. 

> And is this a new error detected?

You mean a new test?  Yes, there's a sufficient chance of a typo-- that
the user didn't really mean to insert an undefined class as a slot --
that a warning (not an errorr) seems desirable.  (S3 classes are fine as
slots, but unless setOldClass  is used they can't be verified.)

John

> 
> Brian
> 
> On Tue, 24 Aug 2004, John Chambers wrote:
> 
> > An extensive set of changes to the methods package has been committed
> > today to allow non-exported classes from packages with namespaces (and
> > some related fixes in dealing with generic functions from namespaces as
> > well).
> >
> > The namespace mechanism requires packages to export any class
> > definitions that are part of the API.  Unfortunately, NOT exporting
> > classes has never really worked.
> >
> > The problem was essentially that computations such as method dispatch
> > used the character-string name of a class, with no information about
> > where that class came from.  For non-exported classes, this caused many
> > computations down the line to fail.  Related problems came from not
> > using the generic function objects and the class definition objects.
> >
> > The modified code passes the usual check and check-devel tests, plus
> > some tests for dealing with private classes, but if you have packages
> > that use methods extensively, please try these with the current r-devel
> > as soon as possible.
> >
> > John
> >
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From andy_liaw at merck.com  Tue Aug 24 21:21:50 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue Aug 24 21:22:23 2004
Subject: [Rd] function bug (PR#7199)
Message-ID: <3A822319EB35174CA3714066D590DCD504AF8298@usrymx25.merck.com>

> From: Prof Brian Ripley
> 
> On Tue, 24 Aug 2004, Peter Kleiweg wrote:
> 
> > Liaw, Andy schreef:
> > 
> > > This is _not_ a bug.  Please read `R Language Manual', 
> section 4.3.2
> > 
> > I don't have the `R Language Manual'. Is it explained somewhere
> > in the docs that come with R?
> 
> Amongst the docs that come with R is the `R Language 
> Definition' manual.

Maybe it would be a good idea to make the menu entries under Help/Manuals in
Rgui on Windows correspond to the actual titles of the manuals?

Best,
Andy


> File doc/manual/R-lang.texi, before processing.  People are 
> quoting the
> section numbers in the HTML/PDF conversion.
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From kleiweg at let.rug.nl  Tue Aug 24 21:34:31 2004
From: kleiweg at let.rug.nl (Peter Kleiweg)
Date: Tue Aug 24 21:34:34 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <Pine.LNX.4.44.0408242012530.11850-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0408242128360.1119-100000@kleigh.nl>

Prof Brian Ripley schreef:

> > > This is _not_ a bug.  Please read `R Language Manual', section 4.3.2

Found it, without section numbers.

I read it, and I can't think why anyone would come up with such
a scheme. It goes against all practices in other programming
languages. It is obfuscating. It's like designing a language
where 'if' actually means 'unless', just so you can chide some
more people for not reading the manual.

-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From cstrato at aon.at  Tue Aug 24 21:36:48 2004
From: cstrato at aon.at (cstrato)
Date: Tue Aug 24 21:37:10 2004
Subject: [Rd] License of Mathlib
In-Reply-To: <Pine.WNT.4.58.0408241955570.4600@auk>
References: <412B8790.4030303@aon.at> <Pine.WNT.4.58.0408241955570.4600@auk>
Message-ID: <412B98D0.3000301@aon.at>

Dear Prof Ripley

Thank you for this clarification.

Best regards
Christian Stratowa

Prof Brian D Ripley wrote:

> On Tue, 24 Aug 2004, cstrato wrote:
> 
> 
>>Dear R-Developers
>>
>>I have a question regarding the license of Mathlib:
>>Is the license GPL or LGPL?
>>
>>I am confused, since the file "nmath.h" mentions GPL in the header,
>>while the file "Rmath.h0.in" mentions LGPL in the header.
> 
> 
> More importantly, the C code of the functions is under GPL.
> It is only the public header files (and nmath.h is private) that have LGPL
> in them.  See the file COPYRIGHTS (which you seem not to be aware of).
>

From p.murrell at auckland.ac.nz  Tue Aug 24 22:44:13 2004
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Aug 24 22:44:48 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
References: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>
	<4128BC4D.1090204@statistik.uni-dortmund.de>
	<412A803E.1020608@stat.auckland.ac.nz>
	<412AF763.3070201@statistik.uni-dortmund.de>
Message-ID: <412BA89D.7050201@stat.auckland.ac.nz>

Hi


Uwe Ligges wrote:
> Paul Murrell wrote:
> 
>> Hi
>>
>>
>> Uwe Ligges wrote:
>>
>>> ligges@statistik.uni-dortmund.de wrote:
>>>
>>>> joehl@gmx.de wrote:
>>>>
>>>>
>>>>> Dear all,
>>>>> Our quite basic function mtext() does wrong adjustments in some 
>>>>> parameter
>>>>> configurations. This gets obvious when using multi line texts: 
>>>>> There is no
>>>>> way to properly adjust text perpendicular to axis 2, for example.
>>>>>
>>>>> Best
>>>>>
>>>>>
>>>>> Jens Oehlschl?gel
>>>>>
>>>>>
>>>>> m <- matrix(1:9, 3)
>>>>> colnames(m) <- c("several\nlines", "several\nlines", "several\nlines")
>>>>>
>>>>> par(mfrow=c(2,2))
>>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 
>>>>> adj=0.5 is
>>>>> fine")
>>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, 
>>>>> adj=0.5)
>>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=0 
>>>>> adj=1 is
>>>>> different")
>>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=0, 
>>>>> adj=1)
>>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="las=1 
>>>>> adj=0.5 is
>>>>> NOT fine")
>>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, 
>>>>> adj=0.5)
>>>>> barplot(m, horiz=TRUE, axes=FALSE, axisnames=FALSE, main="at las=1, 
>>>>> adj=1
>>>>> works the wrong direction", sub="no way to get adj=c(1, 0.5) with 
>>>>> las=1 (or
>>>>> 2)")
>>>>> mtext(colnames(m), 2, at=seq(0.5+0.2, by=1+0.2, length=3), las=1, 
>>>>> adj=1)
>>>>> par(mfrow=c(1,1))
>>>>>
>>>>
>>>>
>>>> Left / right adjustemnt seems to be perfectly OK.
>>>> The thing that matters is centering "several lines" to the specified 
>>>> ("at=") location.
>>>> In fact, mtext() is not centering but bottom-aligning by adding a 
>>>> negative distance that looks OK for one line in the default font 
>>>> size, but not in most other cases.
>>>>
>>>> Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment 
>>>> of perpendicular text"). Fixing this, and/or improving mtext()'s 
>>>> "adj" argument to accept 2 dimensions is desirable, but might be not 
>>>> that easy... I'll take a look during the next days, but nothing 
>>>> promised.
>>>>
>>>> Uwe Ligges
>>>
>>>
>>>
>>>
>>>
>>> Having looked into the code, there are three possible solution (all with
>>> some drawbacks) I can see. Well, the current argument "adj" becomes
>>> "xadj" in the C sources (graphics.c, GMtext), and "yadj" is set to 0. 
>>> Hence the ugly hard coded LineBias of 0.3.
>>>
>>>
>>> Solutions
>>> =========
>>> 1: Hardcode "yadj" to 0.5 and remove all those 0.3 biases. Looks good 
>>> for axes, but it might break some code --> bad.
>>> On the other hand, GMMathText has hardcoded yadj=0.5. Is there a 
>>> problem with some special devices? Or any other reason not to center 
>>> stuff using "adj=0.5"?
>>>
>>> 2: Allow the typical 2-value adj, take the first as xadj, the second one
>>> as yadj. This might break some code, because currently adj of
>>> arbitrary length (!=0) is allowed and recycled.
>>>
>>> 3: Invent an argument "padj" for mtext() that represents adjustment
>>> *p*erpendicular to the text direction and gets mapped to "yadj" in
>>> GMtext. In that case the hardcoded 0.3 bias mentioned above can be
>>> removed. The question is whether to set the default to 0.5 (will still
>>> break code, but easily to fix by setting padj to 0).
>>>
>>> I'd like to propose the third solution and would be happy to provide a
>>> patch of GMText, including corresponding patches to GMMathText, as 
>>> well as mtext(), title() and axis() (and their inderlying do_* 
>>> components).
>>>
>>> Are there any objections? Any reasons not to do it?
>>
>>
>>
>>
>> It hurts my head to think about this stuff.  There are so many 
>> combinations to worry about:
>> (i)   The las setting
>> (ii)  The axis (bottom, left, top, right)
>> (iii) Whether adj has been specified
>> (iv)  Whether the text is multi-line
>>
>> I think mtext() does ok as long as adj is not specified and the text 
>> is single-line.
> 
> 
> Unfortunately it does *not* (using axis() here for simplicity):
>   plot(1:10)
>   axis(3, cex.axis=5, las=2)


Good point :)


>> I would suggest addressing the multi-line problem for unspecified adj 
>> as a first step.  And I will definitely not mourn the passing of the 
>> 0.3 constant.  Setting yadj to 0.5 is not enough though because that 
>> doesn't make sense for multi-line text that is parallel to an axis (in 
>> that case, yadj should probably be 0 for axis 2 and 3 and 1 for axis 1 
>> and 4;  did I mention that there are lots of combinations to worry 
>> about?).
> 
> 
> I think most of the stuff is already quite pretty.
> The point is whether we are going to distinguish cases for 
> (p)adj={0,0.5,1} automatically or not. If the latter, we can omit 
> several of the cases mentioned above in (i)-(iv).
> I think - as the first step - we should set the default to center (note 
> that text() does so as well), and let the user change padj for 
> multi-line text as required.


I think the ideal would be to set padj automatically for multi-line text 
as well as single-line text (the current behaviour tries to set padj 
automatically for single-line text;  it's just not very good at it :).
But whatever first step is good;  then we can more easily discuss actual 
behaviour and code examples.


> I'll try to provide a collection of patches as a proposal within, say, 
> two weeks.


Great (modulo version scheduling issues discussed elsewhere).
Thanks Uwe!

Paul


>> For user-specified adj, I agree that a 2-value adj is not a good 
>> solution (adj is assumed to be horizontal adjustment) so maybe a padj 
>> would be best to allow user control of vertical alignment.
> 
>  >
> 
>> Paul
> 


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From p.dalgaard at biostat.ku.dk  Tue Aug 24 23:47:10 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Aug 24 23:52:05 2004
Subject: [Rd] (PR#7199) function bug
In-Reply-To: <Pine.LNX.4.44.0408242108500.1119-100000@kleigh.nl>
References: <Pine.LNX.4.44.0408242108500.1119-100000@kleigh.nl>
Message-ID: <x2wtzotdi9.fsf@biostat.ku.dk>

Peter Kleiweg <kleiweg@let.rug.nl> writes:

> rpeng@jhsph.edu schreef:
> 
> > This is a misunderstanding, I think, not a bug.  R is using partial
> > matching and the `2', since it is not named, is being sent through the
> > `...'.
> 
> That is not very sensible behaviour, and it certainly doesn't
> explain why 2 is set equal to 3.

It isn't. The arguments are switched around. Like plot(1,x=0) plots a
point at (0,1), a fact that is sometimes used in connection with the
apply()-family of functions.

Given that we allow partial matching, this effect is pretty much
unavoidable. However, the partial matching is probably a feature
regretted by its designer for reasons of examples like this. Trying to
remove the feature from the language at this stage is going to be
pretty painful!

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Wed Aug 25 00:04:07 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Aug 25 00:09:08 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
In-Reply-To: <412BA89D.7050201@stat.auckland.ac.nz>
References: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>
	<4128BC4D.1090204@statistik.uni-dortmund.de>
	<412A803E.1020608@stat.auckland.ac.nz>
	<412AF763.3070201@statistik.uni-dortmund.de>
	<412BA89D.7050201@stat.auckland.ac.nz>
Message-ID: <x2smactcq0.fsf@biostat.ku.dk>

Paul Murrell <p.murrell@auckland.ac.nz> writes:

> 
> I think the ideal would be to set padj automatically for multi-line
> text as well as single-line text (the current behaviour tries to set
> padj automatically for single-line text;  it's just not very good at
> it :).
> But whatever first step is good;  then we can more easily discuss
> actual behaviour and code examples.

A somewhat uninformed conjecture: You'll need to look at the TeXbook
again. Think of it like this: A single line of text forms a box that
has a top, a bottom, and a baseline, and you can align on either or on
some fraction between top and bottom. Multiple lines form a box too,
but you need a way to specify whether the baseline of the entire box
is defined by the top or the bottom line inside of it. In addition,
you need to specify alignment inside the box. Basically, we need a
more structured approach than a bunch of options that change meaning
depending on the setting of other options.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From bellis at hsph.harvard.edu  Wed Aug 25 02:47:37 2004
From: bellis at hsph.harvard.edu (Byron Ellis)
Date: Wed Aug 25 02:47:46 2004
Subject: [Rd] function bug (PR#7199)
In-Reply-To: <Pine.LNX.4.44.0408242128360.1119-100000@kleigh.nl>
References: <Pine.LNX.4.44.0408242128360.1119-100000@kleigh.nl>
Message-ID: <5C0831FC-F630-11D8-A576-000D93C24D64@hsph.harvard.edu>

Its there so people can be lazy and say s= instead of sb=. That sort of 
thing happens all the time in interactive environments. However, I'd 
hardly call it obfuscating---it doesn't reverse a known practice within 
the language domain, though its activity is apparently somewhat 
surprising. No worse than the effects of lexical scoping. Also, if 
people don't read the manual, how are they to learn the language? Its 
like saying you should make Scheme's macro syntax understandable at 
first glance. Unfortunately, the result is C's macro syntax (it you can 
call it that).


On Aug 24, 2004, at 3:34 PM, Peter Kleiweg wrote:

> Prof Brian Ripley schreef:
>
>>>> This is _not_ a bug.  Please read `R Language Manual', section 4.3.2
>
> Found it, without section numbers.
>
> I read it, and I can't think why anyone would come up with such
> a scheme. It goes against all practices in other programming
> languages. It is obfuscating. It's like designing a language
> where 'if' actually means 'unless', just so you can chide some
> more people for not reading the manual.
>
> -- 
> Peter Kleiweg
> http://www.let.rug.nl/~kleiweg/
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
---
Byron Ellis (bellis@hsph.harvard.edu)
"Oook" -- The Librarian

From ligges at statistik.uni-dortmund.de  Wed Aug 25 08:45:14 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed Aug 25 08:44:07 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
In-Reply-To: <x2smactcq0.fsf@biostat.ku.dk>
References: <20040820133405.6C06BFCDC@slim.kubism.ku.dk>	<4128BC4D.1090204@statistik.uni-dortmund.de>	<412A803E.1020608@stat.auckland.ac.nz>	<412AF763.3070201@statistik.uni-dortmund.de>	<412BA89D.7050201@stat.auckland.ac.nz>
	<x2smactcq0.fsf@biostat.ku.dk>
Message-ID: <412C357A.9040906@statistik.uni-dortmund.de>

Peter Dalgaard wrote:

> Paul Murrell <p.murrell@auckland.ac.nz> writes:
> 
> 
>>I think the ideal would be to set padj automatically for multi-line
>>text as well as single-line text (the current behaviour tries to set
>>padj automatically for single-line text;  it's just not very good at
>>it :).
>>But whatever first step is good;  then we can more easily discuss
>>actual behaviour and code examples.
> 
> 
> A somewhat uninformed conjecture: You'll need to look at the TeXbook
> again. Think of it like this: A single line of text forms a box that
> has a top, a bottom, and a baseline, and you can align on either or on
> some fraction between top and bottom. Multiple lines form a box too,
> but you need a way to specify whether the baseline of the entire box
> is defined by the top or the bottom line inside of it. In addition,
> you need to specify alignment inside the box. Basically, we need a
> more structured approach than a bunch of options that change meaning
> depending on the setting of other options.

I think we already have that (more or less), and we don't want to 
re-implement TeX, I hope (in this case I'm the wrong person given my 
capabilities ;-)).
There is a top and a bottom and the bottom line defined as a baseline.
Then we have (speaking about mtext() now) "adj" that controls the 
right/left adjustment in reading direction. What we do not have is 
adjustment in the perpendicular reading direction - it's simply a fixed 
value that can only be controlled using "at".
All the stuff does not change meaning depending on other options, only 
the defaults are sometimes changing (in order not be be completely ugly).
My aim is (a) to provide the missing argument and (b) to set more 
sensible defaults than that one we already have. It's not that easy 
doing it without breaking code.

Uwe

From trindade at stat.ufl.edu  Wed Aug 25 17:04:58 2004
From: trindade at stat.ufl.edu (trindade@stat.ufl.edu)
Date: Wed Aug 25 17:05:02 2004
Subject: [Rd] typo in R online manual (PR#7200)
Message-ID: <20040825150458.E687A10468@slim.kubism.ku.dk>

There is a mistake on the "Weibull Distribution" (base package) help 
page in the online docs (http://docs.stat.ufl.edu/R/doc/html/). The 
formula for Var(X) should have Gamma(1 + 1/a)^2 in place of Gamma(1 + 1/a).

-- 
Alex Trindade
Assistant Professor of Statistics
University of Florida
http://www.stat.ufl.edu/personnel/usrpages/trindade.shtml

From ripley at stats.ox.ac.uk  Wed Aug 25 17:20:26 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Aug 25 17:20:32 2004
Subject: [Rd] typo in R online manual (PR#7200)
In-Reply-To: <20040825150458.E687A10468@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0408251610160.26285-100000@gannet.stats>

That is a mistake at your own department's site, but not in the current R
sources.  It seems those docs are from R 1.2.2!  Even R 1.6.2 has the 
correct formula.

Please ask whoever maintains that site to correct it, and don't expect the 
R team to fix problems in 3.5 year old versions of R.

On Wed, 25 Aug 2004 trindade@stat.ufl.edu wrote:

> There is a mistake on the "Weibull Distribution" (base package) help 
> page in the online docs (http://docs.stat.ufl.edu/R/doc/html/). The 
> formula for Var(X) should have Gamma(1 + 1/a)^2 in place of Gamma(1 + 1/a).
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Wed Aug 25 17:17:55 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Aug 25 17:22:53 2004
Subject: [Rd] typo in R online manual (PR#7200)
In-Reply-To: <20040825150458.E687A10468@slim.kubism.ku.dk>
References: <20040825150458.E687A10468@slim.kubism.ku.dk>
Message-ID: <x23c2b2qn0.fsf@biostat.ku.dk>

trindade@stat.ufl.edu writes:

> There is a mistake on the "Weibull Distribution" (base package) help 
> page in the online docs (http://docs.stat.ufl.edu/R/doc/html/). The 
> formula for Var(X) should have Gamma(1 + 1/a)^2 in place of Gamma(1 + 1/a).

Looks like docs.stat.ufl.edu haven't been updated for a while. It
still has the old organisation of the base packages. We can't fix bugs
retrospectively, y'know... The 1.9.1 version does have the squared
term (it has gamma instead of Gamma, though).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Wed Aug 25 17:21:31 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Aug 25 17:26:30 2004
Subject: [Rd] typo in R online manual (PR#7200)
In-Reply-To: <Pine.LNX.4.44.0408251610160.26285-100000@gannet.stats>
References: <Pine.LNX.4.44.0408251610160.26285-100000@gannet.stats>
Message-ID: <x2y8k31bwk.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> That is a mistake at your own department's site, but not in the current R
> sources.  It seems those docs are from R 1.2.2!  Even R 1.6.2 has the 
> correct formula.
> 
> Please ask whoever maintains that site to correct it, and don't expect the 
> R team to fix problems in 3.5 year old versions of R.

Now that we have a PR#, maybe we should record a wishlist item that
the formatted docs should include the version of R for which they were
generated? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Wed Aug 25 17:26:30 2004
From: p.dalgaard at biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed Aug 25 17:26:32 2004
Subject: [Rd] typo in R online manual (PR#7200)
Message-ID: <20040825152630.8D2A710468@slim.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> That is a mistake at your own department's site, but not in the current R
> sources.  It seems those docs are from R 1.2.2!  Even R 1.6.2 has the 
> correct formula.
> 
> Please ask whoever maintains that site to correct it, and don't expect the 
> R team to fix problems in 3.5 year old versions of R.

Now that we have a PR#, maybe we should record a wishlist item that
the formatted docs should include the version of R for which they were
generated? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From brahm at alum.mit.edu  Wed Aug 25 21:10:04 2004
From: brahm at alum.mit.edu (David Brahm)
Date: Wed Aug 25 21:09:44 2004
Subject: [Rd] Minimal DESCRIPTION file
Message-ID: <16684.58380.213275.750530@lwtc3.fmr.com>

My "g.data" contributed package fails under R-devel.  g.data creates minimal
packages which consist only of a "DESCRIPTION" file and the "R" and "data"
subdirectories, but .find.package() now rejects them because the DESCRIPTION
file lacks a "Version" field.  I will fix g.data to add a "Version" field.

My question is, what else is necessary for a minimal package?  "Writing R
Extensions" states:
   "The `Package', `Version', `License', `Description', `Title', `Author',
    and `Maintainer' fields are mandatory..."
So should I really add all these (superfluous) fields, to avoid future
rejection?

(A comment inside .find.package() refers to tools:::check_package_description,
but I could not find such a function.  Is there a plan for a universal package
validator, and if so, what are its requirements?)

Bigger picture, will g.data be rendered obsolete by lazy loading?
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From jgentry at jimmy.harvard.edu  Wed Aug 25 21:12:15 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Wed Aug 25 21:11:45 2004
Subject: [Rd] Minimal DESCRIPTION file
In-Reply-To: <16684.58380.213275.750530@lwtc3.fmr.com>
Message-ID: <Pine.SOL.4.20.0408251511440.777-100000@santiam.dfci.harvard.edu>

> My question is, what else is necessary for a minimal package?  "Writing R
> Extensions" states:
>    "The `Package', `Version', `License', `Description', `Title', `Author',
>     and `Maintainer' fields are mandatory..."
> So should I really add all these (superfluous) fields, to avoid future
> rejection?

Mandatory does seem to imply something being mandatory. :)

From ripley at stats.ox.ac.uk  Wed Aug 25 22:39:36 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Aug 25 22:39:45 2004
Subject: [Rd] Minimal DESCRIPTION file
In-Reply-To: <16684.58380.213275.750530@lwtc3.fmr.com>
Message-ID: <Pine.LNX.4.44.0408252059470.1037-100000@gannet.stats>

On Wed, 25 Aug 2004, David Brahm wrote:

> My "g.data" contributed package fails under R-devel.  g.data creates minimal
> packages which consist only of a "DESCRIPTION" file and the "R" and "data"
> subdirectories, but .find.package() now rejects them because the DESCRIPTION
> file lacks a "Version" field.  I will fix g.data to add a "Version" field.
> 
> My question is, what else is necessary for a minimal package?  "Writing R
> Extensions" states:
>    "The `Package', `Version', `License', `Description', `Title', `Author',
>     and `Maintainer' fields are mandatory..."
> So should I really add all these (superfluous) fields, to avoid future
> rejection?

At least Package, Version and Title are not superfluous: they 
are used by library().

> (A comment inside .find.package() refers to tools:::check_package_description,
> but I could not find such a function.  

It is tools:::.check_package_description
              ^
> Is there a plan for a universal package
> validator, and if so, what are its requirements?)

It's called R CMD check, and also we have long required that packages be 
INSTALLed.  So we require valid metadata in pkg/Meta and a Built: field in 
the DESCRIPTION, since 2.0.0 will require a package to have been INSTALLed 
under 2.0.0.  (That has implications for the indices too.)

> Bigger picture, will g.data be rendered obsolete by lazy loading?

Is any one using it?  Lazy data loading in a package seems much simpler to 
me, as did direct use of delay() earlier.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jmc at research.bell-labs.com  Wed Aug 25 22:50:36 2004
From: jmc at research.bell-labs.com (John Chambers)
Date: Wed Aug 25 22:50:55 2004
Subject: [Rd] S3 classes in S4 class definitions
Message-ID: <412CFB9C.F890C6CF@research.bell-labs.com>

One of the changes some packages are  noticing from the recent
modifications to methods is warnings of "undefined classes" during
installation when the package extends S3 classes or uses them as slots
UNLESSS they have been declared in a setOldClass() call.  The green book
"strongly recommends" declaring S3 classs this way (pp 449-451).

The warnings on undeclared classes threatened in the book have now been
implemented ;-)  (However the statement in the book that S3 inheritance
is not used in dispatching S4 methods is not true.  Once the relevant
setOldClass call has been done, the inheritance should work.)

Since the packages using the S3 classes won't likely use any S4
methods,  it will be up to new packages to include the setOldClass()
calls, unless we try to provide some more systematic bridge for the old
code.

The text below is being added to the setClass() help file to articulate
some of the points.  Comments and suggestions welcome of course.

John

PS: I will be away for a few days, but should be back in e-mail contact
on Monday.

--------------------------
\section{S3 Classes}

     Earlier, informal classes of objects (usually referred to as "S3"
     classes) are used by many R functions.  It's natural to consider
     including them as the class for a slot in a formal class, or even
     as a class to be extended by the new class.  This isn't prohibited
     but there are some disadvantages, and if you do want to include S3
     classes, they should be declared by including them in a call to
     'setOldClass'.  Here are some considerations:

        *  Using S3 classes somewhat defeats the purpose of defining a
           formal class:  An important advantage to your users is that
           a formal class provides guarantees of what the object
           contains (minimally, the classes of the slots and therfore
           what data they contain; optionally, any other requirements
           imposed by a validity method).

           But there is no guarantee whatever about the data in an
           object from an S3 class.  It's entirely up to the functions
           that create or modify such objects.  If you want to provide
           guarantees to your users, you will need a valdity method
           that explicitly checks the contents of S3-class objects.

        *  To get the minimal guarantee (that the object in a slot has,
           or extends, the class for the slot) you should ensure that
           the S3 classes are known to _be_ S3 classes, with the
           possible inheritance.  To do this, include a call to
           'setOldClass' for the S3 classes used.

           Otherwise, the S3 class is undefined (and the code used by
           'setClass' will issue a warning).  Slot assignments, for
           example, will not then check for possible errors.

        *  These caveats apply to S3 classes; that is, objects with a
           class assigned by some R function but without a formal class
           definition.  In contrast, the  built-in data types
           ('numeric', 'list', etc.) are generally fine as slots or for
           'contains=' classes (see the previous section).  These data
           types don't have formal slots, but the base code in the
           system essentially forces them to contain the type of data
           they claim to have.

           The data types 'matrix' and 'array' are somewhat in between.
            They do not have an explicit S3 class, but do have one or
           two attributes.  There is no general problem in having these
           as slots, but because there is no guarantee of a dimnames
           slot, they don't work as formal classes.  The 'ts' class is
           treated as a formal class, extending class 'vector'.
----------------------------------

Plus an example of the form:

setOldClass(c("aov", "lm"))
setClass("lmCommented", representation(results = "lm", comments =
"character"))
aa = new("lmCommented", results = npk.aov, comments = "From the aov
example")
try(new("lmCommented", results = npk.aovE, comments = "BAD!!"))
### causes an error because npk.aovE is of class "aovlist"


-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From gregory_r_warnes at groton.pfizer.com  Wed Aug 25 23:08:02 2004
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Wed Aug 25 23:08:19 2004
Subject: [Rd] R as shared library
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20C521A89@groexmb02.pfizer.com>


Jeff,

Does apache use threads?  If it does, I would recommend *not* directly
putting R into the apache server for the simple reason that R is not
thread-safe.

You might find it simpler (and cleaner) to use the RSOAP
(http://rsoap.sf.net) interface to connect R with apache.  I originally
created RSOAP to get allow me to connect the ZOPE web application system's
web server to R.

-Greg

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch
> [mailto:r-devel-bounces@stat.math.ethz.ch]On Behalf Of Jeffrey Horner
> Sent: Friday, August 20, 2004 3:17 PM
> To: Byron Ellis
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] R as shared library
> 
> 
> Byron Ellis wrote:
> > Building the callbacks is possible. Basically, you need to 
> construct a 
> > fake DllInfo object for Apache and then use 
> R_registerRoutines to attach 
> > the callbacks to R as it if were a normal R package registering its 
> > routines.
> > 
> > I might have a simple example of this lying around, I'll 
> see if I can 
> > find it (especially since it seems I'll be needing it 
> myself soon :-))
> 
> Yes. I thought about that, but that solution may break on future R 
> releases and may hinder porting to other platforms outside of 
> the UNIX 
> family. I'm going to try Duncan's suggestion of a third dll 
> which will 
> install like a traditional R package.
> 
> -- 
> Jeffrey Horner       Computer Systems Analyst         School 
> of Medicine
> 615-322-8606         Department of Biostatistics   Vanderbilt 
> University
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From gregory_r_warnes at groton.pfizer.com  Wed Aug 25 23:11:57 2004
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Wed Aug 25 23:12:23 2004
Subject: [Rd] Parrallel and multiple-thread 
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20C521A8B@groexmb02.pfizer.com>

Multi-threaded:  No
Parallel:  *Explicit* parallelism is supported if you use one of the
parallel libraries:  rpvm, rmpi.  The snow libraray provides a nice wrapper
for both / either of these.

-Greg

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch
> [mailto:r-devel-bounces@stat.math.ethz.ch]On Behalf Of Liao, Kexiao 
> Sent: Friday, July 30, 2004 9:29 AM
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] Parrallel and multiple-thread 
> 
> 
> Dear R Development Team,
> 
>    Does R-1.9.1 support multiple-thread and parallel 
> computation when it
> is running under IBM e-server P series AIX environment?
> 
>  
> 
> Kexiao
> 
>  
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 


LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From gregory_r_warnes at groton.pfizer.com  Wed Aug 25 23:15:03 2004
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Wed Aug 25 23:15:57 2004
Subject: [Rd] No is.formula()
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20C521A8C@groexmb02.pfizer.com>


There appears to be no "is.formula()" function in R-1.9.1.  May I suggest
that

	is.formula <- function(x) inherits(x, "formula")

be added to base, since formula is a fundimental R type?

Gregory R. Warnes
Manager, Non-Clinical Statistics
Pfizer Global Research and Development



LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From rossini at blindglobe.net  Wed Aug 25 23:33:23 2004
From: rossini at blindglobe.net (A.J. Rossini)
Date: Wed Aug 25 23:27:31 2004
Subject: [Rd] No is.formula()
In-Reply-To: <D7A3CFD7825BD6119B880002A58F06C20C521A8C@groexmb02.pfizer.com>
	(Gregory R. Warnes's message of "Wed, 25 Aug 2004 17:15:03 -0400")
References: <D7A3CFD7825BD6119B880002A58F06C20C521A8C@groexmb02.pfizer.com>
Message-ID: <856576oqcc.fsf@servant.blindglobe.net>

"Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com> writes:

> There appears to be no "is.formula()" function in R-1.9.1.  May I suggest
> that
>
> 	is.formula <- function(x) inherits(x, "formula")
>
> be added to base, since formula is a fundimental R type?

why not just 

    is(x,"formula") 

?

best,
-tony

-- 
Anthony Rossini			    Research Associate Professor
rossini@u.washington.edu            http://www.analytics.washington.edu/ 
Biomedical and Health Informatics   University of Washington
Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From tkeitt at mail.utexas.edu  Wed Aug 25 23:53:39 2004
From: tkeitt at mail.utexas.edu (Timothy H. Keitt)
Date: Wed Aug 25 23:50:05 2004
Subject: [Rd] author field in Rd files
Message-ID: <1093470818.15819.18.camel@workstation-3>

I noticed in the extension manual that the \author{} entry should refer
to the author of the Rd file and not the code documented. I had always
interpreted it as the author of the code, not the documentation. I
wonder if others also find this ambiguous. Its generally not an issue,
except when there is a third party writing documentation. It looks like
they wrote all the code. Would it make sense to have two entries, one
for the documentation author and one for the code author if different?

Tim

-- 
Timothy H. Keitt
Section of Integrative Biology
University of Texas at Austin
http://www.keittlab.org/

From jeff.horner at vanderbilt.edu  Thu Aug 26 00:15:59 2004
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Thu Aug 26 00:16:01 2004
Subject: [Rd] R as shared library
In-Reply-To: <D7A3CFD7825BD6119B880002A58F06C20C521A89@groexmb02.pfizer.com>
References: <D7A3CFD7825BD6119B880002A58F06C20C521A89@groexmb02.pfizer.com>
Message-ID: <412D0F9F.8050207@vanderbilt.edu>

Warnes, Gregory R wrote:
> Jeff,
> 
> Does apache use threads?  If it does, I would recommend *not* directly
> putting R into the apache server for the simple reason that R is not
> thread-safe.

Apache 1.3 doesn't use threads, and Apache 2.0 doesn't have to use 
threads. Both are still actively maintained by the Apache Foundation. 
The reason 1.3 is still around is because of its reliability and the 
fact that it's non-threaded. 2.0 introduced a handful of threaded 
plugins (called mpm's) for improving performance, but it's use has not 
caught on like some folks expected. The problem in my opinion? upgrading 
modules to be thread-safe *and* reliable.

I'm currently developing a version for Apache 2.0 since that's what we 
run (without threads). I plan on developing the same for 1.3.

> You might find it simpler (and cleaner) to use the RSOAP
> (http://rsoap.sf.net) interface to connect R with apache.  I originally
> created RSOAP to get allow me to connect the ZOPE web application system's
> web server to R.

Good point. However, I chose this route to 1) understand R and its 
internals, which is more complicated than I thought,  2) write an apache 
module, which I've always wanted to do, and 3) leverage Apache's robust 
  server technology. In my opinion, no other server software is as 
scalable and reliable as Apache. Plus, it has a module API to plugin 
other code, like an R interpreter.


-- 
Jeffrey Horner       Computer Systems Analyst         School of Medicine
615-322-8606         Department of Biostatistics   Vanderbilt University

From rossini at blindglobe.net  Thu Aug 26 00:40:20 2004
From: rossini at blindglobe.net (A.J. Rossini)
Date: Thu Aug 26 00:34:07 2004
Subject: [Rd] R as shared library
In-Reply-To: <412D0F9F.8050207@vanderbilt.edu> (Jeffrey Horner's message of
	"Wed, 25 Aug 2004 17:15:59 -0500")
References: <D7A3CFD7825BD6119B880002A58F06C20C521A89@groexmb02.pfizer.com>
	<412D0F9F.8050207@vanderbilt.edu>
Message-ID: <85zn4in8ob.fsf@servant.blindglobe.net>

Jeffrey Horner <jeff.horner@vanderbilt.edu> writes:

> Good point. However, I chose this route to 1) understand R and its
> internals, which is more complicated than I thought,  2) write an
> apache module, which I've always wanted to do, and 3) leverage
> Apache's robust server technology. In my opinion, no other server
> software is as scalable and reliable as Apache. Plus, it has a module
> API to plugin other code, like an R interpreter.

All good reasons.  But what is the final API going to look like?  Are
you planning on SSI's for the general interface?

best,
-tony


-- 
Anthony Rossini			    Research Associate Professor
rossini@u.washington.edu            http://www.analytics.washington.edu/ 
Biomedical and Health Informatics   University of Washington
Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From maechler at stat.math.ethz.ch  Thu Aug 26 09:22:50 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu Aug 26 09:22:53 2004
Subject: [Rd] No is.formula()
In-Reply-To: <856576oqcc.fsf@servant.blindglobe.net>
References: <D7A3CFD7825BD6119B880002A58F06C20C521A8C@groexmb02.pfizer.com>
	<856576oqcc.fsf@servant.blindglobe.net>
Message-ID: <16685.36810.724200.155771@gargle.gargle.HOWL>

>>>>> "tony" == A J Rossini <rossini@blindglobe.net>
>>>>>     on Wed, 25 Aug 2004 14:33:23 -0700 writes:

    tony> "Warnes, Gregory R"
    tony> <gregory_r_warnes@groton.pfizer.com> writes:
    >> There appears to be no "is.formula()" function in
    >> R-1.9.1.  May I suggest that
    >> 
    >> is.formula <- function(x) inherits(x, "formula")
    >> 
    >> be added to base, since formula is a fundimental R type?

    tony> why not just

    tony>     is(x,"formula")
    tony> ?

because the latter needs the methods package and base functions
must work independently of "methods".

The question is what  "fundamental R type" would be exactly.
But I tend to agree with Greg, since formulae are constructed
via the .Primitive '~' operator.

Apropos, I believe we should move the  is.primitive function
from "methods" to "base".

Martin

From ripley at stats.ox.ac.uk  Thu Aug 26 09:42:22 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Aug 26 09:42:27 2004
Subject: [Rd] No is.formula()
In-Reply-To: <16685.36810.724200.155771@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.44.0408260834320.23554-100000@gannet.stats>

On Thu, 26 Aug 2004, Martin Maechler wrote:

> >>>>> "tony" == A J Rossini <rossini@blindglobe.net>
> >>>>>     on Wed, 25 Aug 2004 14:33:23 -0700 writes:
> 
>     tony> "Warnes, Gregory R"
>     tony> <gregory_r_warnes@groton.pfizer.com> writes:
>     >> There appears to be no "is.formula()" function in
>     >> R-1.9.1.  May I suggest that
>     >> 
>     >> is.formula <- function(x) inherits(x, "formula")
>     >> 
>     >> be added to base, since formula is a fundimental R type?
> 
>     tony> why not just
> 
>     tony>     is(x,"formula")
>     tony> ?
> 
> because the latter needs the methods package and base functions
> must work independently of "methods".

(It would be a `stats' function, I believe, but equally true.)

> The question is what  "fundamental R type" would be exactly.
> But I tend to agree with Greg, since formulae are constructed
> via the .Primitive '~' operator.

> Apropos, I believe we should move the  is.primitive function
> from "methods" to "base".

Given how long we have lived without either (methods needs is.primitive 
for its internal workings, only) I believe we should continue to do so.

May I remind people that our aim is for base to be as lean as possible, 
since we now use R *a lot* for computations during installation, checking 
etc.  This discourages adding trivial wrappers like these, especially to 
base.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From joehl at gmx.de  Thu Aug 26 16:42:46 2004
From: joehl at gmx.de (joehl@gmx.de)
Date: Thu Aug 26 16:42:49 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
Message-ID: <20040826144246.29ED810460@slim.kubism.ku.dk>



Hi Uwe,

Thanks for your mail.

I see it different: yes, Left / right adjustemnt seems to be perfectly OK.
But at axis 1 with las=1, it's not Left / right adjustement what is needed
here. Here the text needs to be right adjusted, and the (one) adj= par
should determine the vertical alignment. It is a bit confusing, but for
mtext, the distance to the axis is done via line= and adj= moves ALONG the
axis, whatever las= says. 

I agree that it would be more flexible and logical to also have the 2
element form of adj=c(horizontal, vertical) here, but I fear that this
creates a lot of incompatibilities with existing code and with S+.

Best


Jens


> Left / right adjustemnt seems to be perfectly OK.
> The thing that matters is centering "several lines" to the specified 
> ("at=") location.
> In fact, mtext() is not centering but bottom-aligning by adding a 
> negative distance that looks OK for one line in the default font size, 
> but not in most other cases.
> 
> Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment of 
> perpendicular text"). Fixing this, and/or improving mtext()'s "adj" 
> argument to accept 2 dimensions is desirable, but might be not that 
> easy... I'll take a look during the next days, but nothing promised.

--

From ligges at statistik.uni-dortmund.de  Thu Aug 26 17:02:01 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Aug 26 17:01:20 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
In-Reply-To: <20040826144246.29ED810460@slim.kubism.ku.dk>
References: <20040826144246.29ED810460@slim.kubism.ku.dk>
Message-ID: <412DFB69.9000503@statistik.uni-dortmund.de>

joehl@gmx.de wrote:
> 
> Hi Uwe,
> 
> Thanks for your mail.
> 
> I see it different: yes, Left / right adjustemnt seems to be perfectly OK.
> But at axis 1 with las=1, it's not Left / right adjustement what is needed
> here. Here the text needs to be right adjusted, and the (one) adj= par
> should determine the vertical alignment. 

I don't think so. Things are perfectly clear for the user if adj 
controls adjustment in reading direction independently from the las 
setting - and a second value specifying perpendicular adjustment.


 > It is a bit confusing, but for
> mtext, the distance to the axis is done via line= and adj= moves ALONG the
> axis, whatever las= says. 

No, adj moves not always along the axis:

plot(1:10)
mtext("Hello", 3, at=5, adj=0, col="red")
mtext("Hello", 3, at=5, adj=1, col="green")
mtext("Hello", 3, at=5, adj=0, col="red", las = 2)
mtext("Hello", 3, at=5, adj=1, col="green", las = 2)


> I agree that it would be more flexible and logical to also have the 2
> element form of adj=c(horizontal, vertical) here, but I fear that this
> creates a lot of incompatibilities with existing code and with S+.

My suggestion was different: using a new argument padj to be more flexible.

Uwe Ligges


> Best
> 
> 
> Jens
> 
> 
> 
>>Left / right adjustemnt seems to be perfectly OK.
>>The thing that matters is centering "several lines" to the specified 
>>("at=") location.
>>In fact, mtext() is not centering but bottom-aligning by adding a 
>>negative distance that looks OK for one line in the default font size, 
>>but not in most other cases.
>>
>>Hence this is the same as Paul Murrell's PR#1659 ("mtext() alignment of 
>>perpendicular text"). Fixing this, and/or improving mtext()'s "adj" 
>>argument to accept 2 dimensions is desirable, but might be not that 
>>easy... I'll take a look during the next days, but nothing promised.
> 
> 
> --
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From wolski at molgen.mpg.de  Thu Aug 26 18:48:18 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Thu Aug 26 18:48:22 2004
Subject: [Rd] How to enable ANSII C checking?
Message-ID: <200408261848180839.00432965@mail.math.fu-berlin.de>

Hi!

I have run R CMD check on a package on Windows 2000, Linux (Debian), Linux Mandrake. On all of this platforms the check runs without any warning.
I send the package to a colleague. He runs R CMD check on his machine and gets errors eg.

mscalibD.c:161: syntax error before `int'
mscalibD.c:165: `i' undeclared (first use in this function)
mscalibD.c:165: (Each undeclared identifier is reported only once

Looking at the sources the answer is simple. His compiler is set to check if the C code is ANSII compliant. On my platforms the compilers are not set to check for this.
Why? How can I tell R CMD check to check for this? I would find it usefully if R CMD check behaves with this respect similar on all platforms.

Eryk.


Dipl. bio-chem. Eryk Witold Wolski    @    MPI-Moleculare Genetic   
Ihnestrasse 63-73 14195 Berlin       'v'    
tel: 0049-30-83875219               /   \    
mail: wolski@molgen.mpg.de        ---W-W----    http://www.molgen.mpg.de/~wolski

From joehl at gmx.de  Thu Aug 26 20:48:01 2004
From: joehl at gmx.de (=?ISO-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Thu Aug 26 20:48:08 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
Message-ID: <1708.1093546081@www17.gmx.net>


> No, adj moves not always along the axis:

No, not yet. But mtext logically is oriented relative to its axis. And it
should behave consistently relative to its axis. 

Whichever solution is choosen finally, I think it is important, that the
default parametrisation will handle multi-line labels such that they are
centered around at= and aligned at line=, whatever side= and las= are
choosen. Beeing forced to tweak with adj= / padj= depending on side= / las=
would be very impractical. This "requirement" is easily fullfilled with
default adj=0.5 if we have mtext's adj= always move along the axis. With a
adj= / padj= solution, different defaults would be needed for the different
combinations of side= and las=.

How does it S+?

Best


Jens


# Thats my problem
txt <- "This are\nfour lines\nof some\nrubish"
y <- barplot(x, axes=FALSE, axisnames=FALSE, horiz=TRUE)
# axis doesn't align it properly
axis(2, label=rep(txt, 5), at=y, las=2, adj=0)
# and no mtext parameters give vertically centered and right adjusted text
mtext(rep(txt, 5), side=2, line=1, at=y, las=2, adj=0)


-- 
Supergnstige DSL-Tarife + WLAN-Router fr 0,- EUR*
Jetzt zu GMX wechseln und sparen http://www.gmx.net/de/go/dsl

From jeff.horner at Vanderbilt.Edu  Thu Aug 26 20:55:36 2004
From: jeff.horner at Vanderbilt.Edu (Horner, Jeff)
Date: Thu Aug 26 20:56:45 2004
Subject: [Rd] R as shared library
Message-ID: <BA5458EA4625894B8A7B70CB1307CA90081BC5@mailbe07.mc.vanderbilt.edu>


>From: A.J. Rossini [mailto:rossini@blindglobe.net]
>
>Jeffrey Horner <jeff.horner@vanderbilt.edu> writes:
>
>> Good point. However, I chose this route to 1) understand R and its
>> internals, which is more complicated than I thought,  2) write an
>> apache module, which I've always wanted to do, and 3) leverage
>> Apache's robust server technology. In my opinion, no other server
>> software is as scalable and reliable as Apache. Plus, it has a module
>> API to plugin other code, like an R interpreter.
>
>All good reasons.  But what is the final API going to look like?  Are
>you planning on SSI's for the general interface?

For my prototype which already works, it's as simple as placing your code
in a .R file accessible from the web server. That means your R code is
responsible for generating HTML, similar to other languages embedded
into Apache like Perl and Python. PHP is different in that the interpreter
is only entered once a special tag is seen:

file.php
-------------
<html>
<body>
<?php  
 /* php code here */ 
?>
</body>
</html>
-------------

And you can jump into and out of the interpreter an unlimited number of times.
This allows for embedding parts of the HTML document within your code. Whether
or not this is a good thing is debatable.

The problem I'm working on right now, and which was talked about in the
previous emails, is how to expose the CGI data to the R interpreter. Another
part of this is how tight should R hook into Apache. Languages like Perl and
Python expose many different parts of the http request to be overidden by
language specific handlers, whereas PHP doesn't.

My intent is to release a proof of concept prototype and then work with the R
developer community to determine how it should evolve.

Jeff

	[[alternative HTML version deleted]]

From gcorral at ifc.unam.mx  Fri Aug 27 05:48:34 2004
From: gcorral at ifc.unam.mx (Gustavo Corral)
Date: Fri Aug 27 05:49:44 2004
Subject: [Rd] Is this a problem with methods??
Message-ID: <1093578514.412eaf1268954@webmail.ifc.unam.mx>

Dear R-devel list members,

we have developed a package and it works perfect in R 1.9.1 but when we prooved
with R-devel we get the next output from the R CMD check:


Error in eval(expr, envir, enclos) : couldn't find function "@<-"
Execution halted
ERROR: installing package indices failed
** Removing '/home/pgomez/genArise.Rcheck/genArise'
 ERROR
Installation failed. 

We think this is a problem with methods, but we can't find how to correct it and
we are stuck. I do not have the source code now to be more specific but maybe an
error is obvious. I will send a new mail tomorrow with more details.

Thanks
Gustavo and Ana from Cellular Phisyology Institute UNAM

From ligges at statistik.uni-dortmund.de  Fri Aug 27 09:05:09 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Aug 27 09:04:01 2004
Subject: [Rd] mtext adj= wrong with several las= (PR#7188)
In-Reply-To: <1708.1093546081@www17.gmx.net>
References: <1708.1093546081@www17.gmx.net>
Message-ID: <412EDD25.3070103@statistik.uni-dortmund.de>

Jens Oehlschl?gel wrote:

>>No, adj moves not always along the axis:
> 
> 
> No, not yet. But mtext logically is oriented relative to its axis. And it
> should behave consistently relative to its axis. 
> 
> Whichever solution is choosen finally, I think it is important, that the
> default parametrisation will handle multi-line labels such that they are
> centered around at= and aligned at line=, whatever side= and las= are
> choosen. Beeing forced to tweak with adj= / padj= depending on side= / las=
> would be very impractical. This "requirement" is easily fullfilled with
> default adj=0.5 if we have mtext's adj= always move along the axis. With a
> adj= / padj= solution, different defaults would be needed for the different
> combinations of side= and las=.

Might be nice, but I don't think we can easily change that much in 
mtext()'s behaviour. It is widely used in graphic functions and changing 
the defaults too much will break an incredible amount of code (if 
someone changes mtext() in that manner, I'll unsubsribe from R-help for 
half a year ;-)).

> How does it S+?

The outdated S-PLUS 4.5 behaves like R does, but the logic is different 
since you have to specify srt rather than las.

Uwe Ligges

> Best
> 
> 
> Jens
> 
> 
> # Thats my problem
> txt <- "This are\nfour lines\nof some\nrubish"
> y <- barplot(x, axes=FALSE, axisnames=FALSE, horiz=TRUE)
> # axis doesn't align it properly
> axis(2, label=rep(txt, 5), at=y, las=2, adj=0)
> # and no mtext parameters give vertically centered and right adjusted text
> mtext(rep(txt, 5), side=2, line=1, at=y, las=2, adj=0)
> 
>

From ripley at stats.ox.ac.uk  Fri Aug 27 09:04:17 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 27 09:04:35 2004
Subject: [Rd] Is this a problem with methods??
In-Reply-To: <1093578514.412eaf1268954@webmail.ifc.unam.mx>
Message-ID: <Pine.LNX.4.44.0408270800330.30532-100000@gannet.stats>

Does your package have methods in the Depends: line in its DESCRIPTION 
file?

Are its data files self-sufficient (that is work without either the 
package or methods being loaded)?

R-devel is under development and before release we will make detailed 
advice available to developers.  But see the draft at

	http://developer.r-project.org/200update.txt

It's almost certainly a problem with your package not loading methids when 
it needs to.

On Thu, 26 Aug 2004, Gustavo Corral wrote:

> Dear R-devel list members,
> 
> we have developed a package and it works perfect in R 1.9.1 but when we
> prooved with R-devel we get the next output from the R CMD check:
> 
> 
> Error in eval(expr, envir, enclos) : couldn't find function "@<-"
> Execution halted
> ERROR: installing package indices failed
> ** Removing '/home/pgomez/genArise.Rcheck/genArise'
>  ERROR
> Installation failed. 
> 
> We think this is a problem with methods, but we can't find how to
> correct it and we are stuck. I do not have the source code now to be
> more specific but maybe an error is obvious. I will send a new mail
> tomorrow with more details.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tapake.kishore at hp.com  Fri Aug 27 12:37:56 2004
From: tapake.kishore at hp.com (tapake.kishore@hp.com)
Date: Fri Aug 27 12:38:01 2004
Subject: [Rd] about passing parameter to  '.R' script file (PR#7201)
Message-ID: <20040827103756.6C21C1048F@slim.kubism.ku.dk>

Hi,

I am trying the 'R' application for generating the data for the uploaded '.gpr' file. I have written script file named 'test.R'. Currently i have hardcoded the path of uploaded '.gpr' file in the script itself. 

I would like to know how to pass a command line parameter to the 'test.R' script file, so that i dont have to hardcode the path and filename of the '.gpr' files.
Also, need to access these parameters inside the script file to use the path of the uploaded file.
I am using below command to invoke the 'R' application by using the 'test.R' script file.

e.g.
c:\\R\\rw1091\\bin\\R.exe CMD BATCH c:\\R\\rw1091\\bin\\test.R

Expecting your suggestion on this.

Thanks in advance.

Regards,
Kishore

From ligges at statistik.uni-dortmund.de  Fri Aug 27 12:52:49 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri Aug 27 12:52:54 2004
Subject: [Rd] about passing parameter to  '.R' script file (PR#7201)
Message-ID: <20040827105249.F27B210487@slim.kubism.ku.dk>

tapake.kishore@hp.com wrote:



*** Please send questions to R-help, not to r-bugs! ***
"Expecting your ...[apologies] on this."


> Hi,
> 
> I am trying the 'R' application for generating the data for the uploaded '.gpr' file. I have written script file named 'test.R'. Currently i have hardcoded the path of uploaded '.gpr' file in the script itself. 
> 
> I would like to know how to pass a command line parameter to the 'test.R' script file, so that i dont have to hardcode the path and filename of the '.gpr' files.
> Also, need to access these parameters inside the script file to use the path of the uploaded file.
> I am using below command to invoke the 'R' application by using the 'test.R' script file.
> 
> e.g.
> c:\\R\\rw1091\\bin\\R.exe CMD BATCH c:\\R\\rw1091\\bin\\test.R
> 
> Expecting your suggestion on this.


What about using environment variables?

Uwe Ligges




> Thanks in advance.
> 
> Regards,
> Kishore
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From tapake.kishore at hp.com  Fri Aug 27 14:26:23 2004
From: tapake.kishore at hp.com (tapake.kishore@hp.com)
Date: Fri Aug 27 14:26:27 2004
Subject: [Rd] about passing parameter to  '.R' script file (PR#7201)
Message-ID: <20040827122623.518F010494@slim.kubism.ku.dk>

Hi,

I am sorry for asking help from 'R-bugs' instead of 'R-help'.

Regards,
Kishore

-----Original Message-----
From: Uwe Ligges [mailto:ligges@statistik.uni-dortmund.de]
Sent: Friday, August 27, 2004 4:24 PM
To: Kishore, Tapake
Cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] about passing parameter to '.R' script file (PR#7201)


tapake.kishore@hp.com wrote:



*** Please send questions to R-help, not to r-bugs! ***
"Expecting your ...[apologies] on this."


> Hi,
>=20
> I am trying the 'R' application for generating the data for the =
uploaded '.gpr' file. I have written script file named 'test.R'. =
Currently i have hardcoded the path of uploaded '.gpr' file in the =
script itself.=20
>=20
> I would like to know how to pass a command line parameter to the =
'test.R' script file, so that i dont have to hardcode the path and =
filename of the '.gpr' files.
> Also, need to access these parameters inside the script file to use =
the path of the uploaded file.
> I am using below command to invoke the 'R' application by using the =
'test.R' script file.
>=20
> e.g.
> c:\\R\\rw1091\\bin\\R.exe CMD BATCH c:\\R\\rw1091\\bin\\test.R
>=20
> Expecting your suggestion on this.


What about using environment variables?

Uwe Ligges




> Thanks in advance.
>=20
> Regards,
> Kishore
>=20
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From deepayan at stat.wisc.edu  Fri Aug 27 16:28:15 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Fri Aug 27 16:28:26 2004
Subject: [Rd] reorder [stats] and reorder.factor [lattice]
Message-ID: <Pine.LNX.4.58.0408270918570.2608@public02.stat.wisc.edu>


It was recently pointed out on the lists that the S-PLUS Trellis suite has
a function called reorder.factor that's useful in getting useful ordering
of factors for graphs. I happily went ahead and implemented it, but it
turns out that R (not S-PLUS) has a generic called reorder (with a method
for "dendrogram"). Naturally, this causes R to think I'm defining a
method for "factor", and gives a warning during check because of
mismatching argument names.

Any suggestions as to what I should do? Retaining S compatibility doesn't
seem to be an option. I could make a reorder method for "factor" (which
sounds like a good option to me), or rename it to something like
reorderFactor.

Deepayan

From brahm at alum.mit.edu  Fri Aug 27 16:33:32 2004
From: brahm at alum.mit.edu (David Brahm)
Date: Fri Aug 27 16:33:11 2004
Subject: [Rd] Minimal DESCRIPTION file
References: <6AF7541D27821A4BAB515245C1A2FEED02BA6F04@MSGBOSCLC2WIN.DMN1.FMR.COM>
Message-ID: <16687.17980.923129.296986@lwtc3.fmr.com>

I wrote:
> My "g.data" contributed package fails under R-devel...because the
> DESCRIPTION file [of packages it creates] lacks a "Version" field.
> My question is, what else is necessary for a minimal package?
> A comment inside .find.package() refers to tools:::check_package_description,
> but I could not find such a function.

Prof Brian D. Ripley <ripley@stats.ox.ac.uk> responded:
> It is tools:::.check_package_description
>               ^

Thank you!  I see the typo in the comment (line 690 of library.R) has now been
corrected.  .check_package_description() and "Writing R Extensions" both
clearly and consistently state that `Package', `Version', `License',
`Description', `Title', `Author', and `Maintainer' fields are mandatory, so I
have added these to the packages (DDP's) that g.data creates.

g.data_1.5.tar.gz is now available on CRAN.

Maybe someday I'll do a major re-write to use lazy loading, but not today...
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From kjetil at acelerate.com  Fri Aug 27 17:39:35 2004
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Fri Aug 27 17:39:43 2004
Subject: [Rd] Packing of data files in packages
Message-ID: <412F55B7.4040306@acelerate.com>

Hola!

I am writing a package with some large data files, so it would be good to
use the feature of zipping data.

However, I use .R files to read in the data from one (sometimes more)
files, so Rcmd build --zip-data
gives a package which does'nt work. How should I do it, is it better ti
zip each data file individually and use the functions to read from 
zipped files, or are there some other solution?
Did'nt find anything in "Writing R extensions".

Kjetil

From wolski at molgen.mpg.de  Fri Aug 27 17:51:40 2004
From: wolski at molgen.mpg.de (Wolski)
Date: Fri Aug 27 17:51:47 2004
Subject: [Rd] Packing of data files in packages
References: <412F55B7.4040306@acelerate.com>
	<200408271751170779.01F44206@mail.math.fu-berlin.de>
Message-ID: <200408271751400842.01F49C1D@mail.math.fu-berlin.de>

Hi Kjetil!

I would pack the files, as you said, and use functions to read from zipped files.

You can place the data file in the directory e.g inst/mydata.
See (writing R extension to know more about the inst directory)
After installing the package you can get the path to the mydata direcotry using the function ?system.file
dir<-system.file("mydata",package="mypackage")


Eryk


*********** REPLY SEPARATOR  ***********

On 8/27/2004 at 11:39 AM Kjetil Brinchmann Halvorsen wrote:

>>>Hola!
>>>
>>>I am writing a package with some large data files, so it would be good to
>>>use the feature of zipping data.
>>>
>>>However, I use .R files to read in the data from one (sometimes more)
>>>files, so Rcmd build --zip-data
>>>gives a package which does'nt work. How should I do it, is it better ti
>>>zip each data file individually and use the functions to read from 
>>>zipped files, or are there some other solution?
>>>Did'nt find anything in "Writing R extensions".
>>>
>>>Kjetil
>>>
>>>______________________________________________
>>>R-devel@stat.math.ethz.ch mailing list
>>>https://stat.ethz.ch/mailman/listinfo/r-devel



Dipl. bio-chem. Eryk Witold Wolski    @    MPI-Moleculare Genetic   
Ihnestrasse 63-73 14195 Berlin       'v'    
tel: 0049-30-83875219               /   \    
mail: wolski@molgen.mpg.de        ---W-W----    http://www.molgen.mpg.de/~wolski

From ripley at stats.ox.ac.uk  Fri Aug 27 17:52:47 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 27 17:52:58 2004
Subject: [Rd] Packing of data files in packages
In-Reply-To: <412F55B7.4040306@acelerate.com>
Message-ID: <Pine.LNX.4.44.0408271649200.6790-100000@gannet.stats>

On Fri, 27 Aug 2004, Kjetil Brinchmann Halvorsen wrote:

> Hola!
> 
> I am writing a package with some large data files, so it would be good to
> use the feature of zipping data.
> 
> However, I use .R files to read in the data from one (sometimes more)
> files, so Rcmd build --zip-data

I think you mean Rcmd INSTALL here: build --binary is just a wrapper
                                          ^^^^^^^^
> gives a package which does'nt work. How should I do it, is it better ti
> zip each data file individually and use the functions to read from 
> zipped files, or are there some other solution?
> Did'nt find anything in "Writing R extensions".

Did you notice about .rda files?  Writing compressed .rda files is 
the best way to provide large datasets.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From kjetil at acelerate.com  Fri Aug 27 17:48:31 2004
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Fri Aug 27 17:54:31 2004
Subject: [Rd] reorder [stats] and reorder.factor [lattice]
In-Reply-To: <Pine.LNX.4.58.0408270918570.2608@public02.stat.wisc.edu>
References: <Pine.LNX.4.58.0408270918570.2608@public02.stat.wisc.edu>
Message-ID: <412F57CF.6010603@acelerate.com>

Deepayan Sarkar wrote:

>It was recently pointed out on the lists that the S-PLUS Trellis suite has
>a function called reorder.factor that's useful in getting useful ordering
>of factors for graphs. I happily went ahead and implemented it, but it
>turns out that R (not S-PLUS) has a generic called reorder (with a method
>for "dendrogram"). Naturally, this causes R to think I'm defining a
>method for "factor", and gives a warning during check because of
>mismatching argument names.
>
>Any suggestions as to what I should do? Retaining S compatibility doesn't
>seem to be an option. I could make a reorder method for "factor" (which
>sounds like a good option to me), or rename it to something like
>reorderFactor.
>
>  
>
Make a reorder method for factor, which would be usefull also outside
lattice, so could be in stats

Kjetil halvorsen


>Deepayan
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>  
>

From ripley at stats.ox.ac.uk  Fri Aug 27 18:17:02 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Aug 27 18:17:07 2004
Subject: [Rd] reorder [stats] and reorder.factor [lattice]
In-Reply-To: <Pine.LNX.4.58.0408270918570.2608@public02.stat.wisc.edu>
Message-ID: <Pine.LNX.4.44.0408271705170.6872-100000@gannet.stats>

On Fri, 27 Aug 2004, Deepayan Sarkar wrote:

> It was recently pointed out on the lists that the S-PLUS Trellis suite has
> a function called reorder.factor that's useful in getting useful ordering
> of factors for graphs. I happily went ahead and implemented it, but it
> turns out that R (not S-PLUS) has a generic called reorder (with a method
> for "dendrogram"). Naturally, this causes R to think I'm defining a
> method for "factor", and gives a warning during check because of
> mismatching argument names.
> 
> Any suggestions as to what I should do? Retaining S compatibility doesn't
> seem to be an option. I could make a reorder method for "factor" (which
> sounds like a good option to me), or rename it to something like
> reorderFactor.

I am pretty sure you don't want to copy the Trellis call, which is

function(Factor, X, Function = mean, ...)

and suggests it dates from the days when S3 lookup could not distingush
functions from other objects by context, hence the capitalization.  Even
then, it is inconsistent with tapply etc which use FUN.

reorder.factor <- function(x, X, FUN=mean)

looks about right.  Another problem though: in Trellis reorder.factor 
doesn't just reorder the factor, it makes it an ordered factor.  I don't 
really see why, especially as the modelling functions assume that ordered 
means equally spaced.  If this is to be used more generally (as Kjetil 
Halvorsen suggests) then it should record the scores used to do the 
ordering in an attribute.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From deepayan at stat.wisc.edu  Fri Aug 27 21:31:43 2004
From: deepayan at stat.wisc.edu (Deepayan Sarkar)
Date: Fri Aug 27 21:31:14 2004
Subject: [Rd] reorder [stats] and reorder.factor [lattice]
In-Reply-To: <Pine.LNX.4.44.0408271705170.6872-100000@gannet.stats>
References: <Pine.LNX.4.44.0408271705170.6872-100000@gannet.stats>
Message-ID: <200408271431.43864.deepayan@stat.wisc.edu>

On Friday 27 August 2004 11:17, Prof Brian Ripley wrote:
> On Fri, 27 Aug 2004, Deepayan Sarkar wrote:
> > It was recently pointed out on the lists that the S-PLUS Trellis suite
> > has a function called reorder.factor that's useful in getting useful
> > ordering of factors for graphs. I happily went ahead and implemented it,
> > but it turns out that R (not S-PLUS) has a generic called reorder (with a
> > method for "dendrogram"). Naturally, this causes R to think I'm defining
> > a method for "factor", and gives a warning during check because of
> > mismatching argument names.
> >
> > Any suggestions as to what I should do? Retaining S compatibility doesn't
> > seem to be an option. I could make a reorder method for "factor" (which
> > sounds like a good option to me), or rename it to something like
> > reorderFactor.
>
> I am pretty sure you don't want to copy the Trellis call, which is
>
> function(Factor, X, Function = mean, ...)
>
> and suggests it dates from the days when S3 lookup could not distingush
> functions from other objects by context, hence the capitalization.  Even
> then, it is inconsistent with tapply etc which use FUN.
>
> reorder.factor <- function(x, X, FUN=mean)
>
> looks about right.  Another problem though: in Trellis reorder.factor
> doesn't just reorder the factor, it makes it an ordered factor.  I don't
> really see why, especially as the modelling functions assume that ordered
> means equally spaced.  If this is to be used more generally (as Kjetil
> Halvorsen suggests) then it should record the scores used to do the
> ordering in an attribute.

Well, the ordered factor issue had come up before, and I currently define this 
as

reorder.factor <-
  function (Factor, X, Function = mean, ..., order = is.ordered(Factor))
    (if (order) ordered else factor)(Factor, 
        levels = names(sort(tapply(X, Factor, Function, ...))))

which is different from the S-PLUS version in 2 ways: 

1. for (unordered) factors, it changes the levels, but keeps it a factor

2. it works for non-factors as well (which is moot if it's going to be 
   a factor method)


Implementation details aside, this seems to me like a good candidate for stats 
(although it'll probably be used very little). lattice functions (will) have 
an alternative way of determining panel order based on panel contents, which 
makes more sense to me in the plotting context.

Deepayan

From maechler at stat.math.ethz.ch  Fri Aug 27 22:54:19 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Aug 27 22:54:23 2004
Subject: [Rd] author field in Rd files
In-Reply-To: <1093470818.15819.18.camel@workstation-3>
References: <1093470818.15819.18.camel@workstation-3>
Message-ID: <16687.40827.558208.989350@gargle.gargle.HOWL>

Since nobody else has reacted yet:

>>>>> "Timothy" == Timothy H Keitt <tkeitt@mail.utexas.edu>
>>>>>     on Wed, 25 Aug 2004 16:53:39 -0500 writes:

    Timothy> I noticed in the extension manual that the
    Timothy> \author{} entry should refer to the author of the
    Timothy> Rd file and not the code documented. I had always
    Timothy> interpreted it as the author of the code, not the
    Timothy> documentation. I wonder if others also find this
    Timothy> ambiguous.

I tend to agree with you.  Very often the author means both the
author of the R object and the help page.
In the few other cases, for me, I was the help page author
(rather than the other way around) and I think I usually have
done what you suggest:  Showed the author of the code and
sometimes also mentioned myself (as docu-author), but typically
only if I had also improved on the code.

    Timothy> Its generally not an issue, except when there is a
    Timothy> third party writing documentation. It looks like
    Timothy> they wrote all the code. Would it make sense to
    Timothy> have two entries, one for the documentation author
    Timothy> and one for the code author if different?

I think in such a case \author{..} should contain both the code
and documentation authors.
In a package with many help pages, a possibility is also to
 specify  \author{..} and \references{....} in only a few help
pages and for the others, inside the   \seealso{...}   section
have a sentence pointing to the main help page(s), such as
\seealso{ 
	  ..............
	  For references etc, \code{\link{<mainpage>}}.
}


Regards,
Martin Maechler

From ggrothendieck at myway.com  Sat Aug 28 06:05:48 2004
From: ggrothendieck at myway.com (ggrothendieck@myway.com)
Date: Sat Aug 28 06:05:54 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
Message-ID: <20040828040548.11F6EF306@slim.kubism.ku.dk>

Full_Name: Gabor Grothendieck
Version: R version 1.9.1, 2004-08-03
OS: Windows XP
Submission from: (NULL) (207.35.143.52)



The following gives an error:

	> `a(b)` <- 1:4
	> `c(d)` <- (1:4)^2
	> lm(`a(b)` ~ `c(d)`)
	Error in model.matrix.default(mt, mf, contrasts) : 
        	model frame and formula mismatch in model.matrix()

To fix it replace this line in model.matrix.default:

	reorder <- match(attr(t, "variables")[-1], names(data))

with these two lines:

	strip.backquote <- function(x) gsub("^`(.*)`", "\\1", x)
	reorder <- match(strip.backquote(attr(t, "variables"))[-1], 
			strip.backquote(names(data)))

From ggrothendieck at myway.com  Sat Aug 28 06:26:52 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Aug 28 06:27:08 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
Message-ID: <20040828042652.66AC812CD6@mprdmxin.myway.com>



Sorry, but my solution itself had a shortcoming.  The $ at the
end of the regular expression is missing and gsub can simply be
sub.  Here it is again:

     strip.backquote <- function(x) sub("^`(.*)`$", "\\1", x)
     reorder <- match(strip.backquote(attr(t, "variables"))[-1],
               strip.backquote(names(data)))



Full_Name: Gabor Grothendieck
Version: R version 1.9.1, 2004-08-03
OS: Windows XP
Submission from: (NULL) (207.35.143.52)



The following gives an error:

     > `a(b)` <- 1:4
     > `c(d)` <- (1:4)^2
     > lm(`a(b)` ~ `c(d)`)
     Error in model.matrix.default(mt, mf, contrasts) :
     model frame and formula mismatch in model.matrix()

To fix it replace this line in model.matrix.default:

     reorder <- match(attr(t, "variables")[-1], names(data))

with these two lines:

     strip.backquote <- function(x) gsub("^`(.*)`", "\\1", x)
     reorder <- match(strip.backquote(attr(t, "variables"))[-1],
               strip.backquote(names(data)))

From p.dalgaard at biostat.ku.dk  Sat Aug 28 10:40:59 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat Aug 28 10:46:12 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
In-Reply-To: <20040828040548.11F6EF306@slim.kubism.ku.dk>
References: <20040828040548.11F6EF306@slim.kubism.ku.dk>
Message-ID: <x2llfzd59g.fsf@biostat.ku.dk>

ggrothendieck@myway.com writes:

> The following gives an error:
> 
> 	> `a(b)` <- 1:4
> 	> `c(d)` <- (1:4)^2
> 	> lm(`a(b)` ~ `c(d)`)
> 	Error in model.matrix.default(mt, mf, contrasts) : 
>         	model frame and formula mismatch in model.matrix()
> 
> To fix it replace this line in model.matrix.default:
> 
> 	reorder <- match(attr(t, "variables")[-1], names(data))
> 
> with these two lines:
> 
> 	strip.backquote <- function(x) gsub("^`(.*)`", "\\1", x)
> 	reorder <- match(strip.backquote(attr(t, "variables"))[-1], 
> 			strip.backquote(names(data)))

Hmm.. Yes, there's a bug (and it's likely not the only one we have
relating to odd variable names in model formulas), but I suspect that
the fix is wrong. 

The backquotes are not part of the variable names, but get added by
deparsing -- sometimes! Other times they do not: Try for instance
as.character(quote(`a(b)`)). (Which is as it should be. Other pieces
of logic relating to nonsyntactical names represent some rather
awkward compromises.)

When backquotes have found their way into names(data) or the
"variables" attribute, I would rather suspect that they were created
by the wrong tool and fix that, not cure the symptom by stripping them
off at a later stage.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Sat Aug 28 15:36:12 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Aug 28 15:36:18 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
Message-ID: <20040828133612.8800A12D17@mprdmxin.myway.com>



> ggrothendieck@myway.com writes:
> 
> > The following gives an error:
> >
> >      > `a(b)` <- 1:4
> >      > `c(d)` <- (1:4)^2
> >      > lm(`a(b)` ~ `c(d)`)
> >      Error in model.matrix.default(mt, mf, contrasts) :
> >      model frame and formula mismatch in model.matrix()
> >
> > To fix it replace this line in model.matrix.default:
> >
> >      reorder <- match(attr(t, "variables")[-1], names(data))
> >
> > with these two lines:
> >
> >      strip.backquote <- function(x) gsub("^`(.*)`", "\\1", x)
> >      reorder <- match(strip.backquote(attr(t, "variables"))[-1],
> >                strip.backquote(names(data)))
> 
> Hmm.. Yes, there's a bug (and it's likely not the only one we have
> relating to odd variable names in model formulas), but I suspect that
> the fix is wrong.
> 
> The backquotes are not part of the variable names, but get added by
> deparsing -- sometimes! Other times they do not: Try for instance
> as.character(quote(`a(b)`)). (Which is as it should be. Other pieces
> of logic relating to nonsyntactical names represent some rather
> awkward compromises.)
> 
> When backquotes have found their way into names(data) or the
> "variables" attribute, I would rather suspect that they were created
> by the wrong tool and fix that, not cure the symptom by stripping them
> off at a later stage.

In model.frame.default there is a line:

   varnames <- as.character(vars[-1])

that turns part of a call object, vars, into a character string.  
We could change that to:

   varnames <- strip.backquote(as.character(as.list(vars[-1])))

or perhaps as.character should not return the backquotes in the
first place in which case the fix would be to fix as.character.

From p.dalgaard at biostat.ku.dk  Sat Aug 28 16:47:52 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat Aug 28 16:53:05 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
In-Reply-To: <20040828133612.8800A12D17@mprdmxin.myway.com>
References: <20040828133612.8800A12D17@mprdmxin.myway.com>
Message-ID: <x28ybzco9z.fsf@biostat.ku.dk>

"Gabor Grothendieck" <ggrothendieck@myway.com> writes:

> > ggrothendieck@myway.com writes:
> > 
> > > The following gives an error:
> > >
> > >      > `a(b)` <- 1:4
> > >      > `c(d)` <- (1:4)^2
> > >      > lm(`a(b)` ~ `c(d)`)
> > >      Error in model.matrix.default(mt, mf, contrasts) :
> > >      model frame and formula mismatch in model.matrix()
> > >
> > > To fix it replace this line in model.matrix.default:
> > >
> > >      reorder <- match(attr(t, "variables")[-1], names(data))
> > >
> > > with these two lines:
> > >
> > >      strip.backquote <- function(x) gsub("^`(.*)`", "\\1", x)
> > >      reorder <- match(strip.backquote(attr(t, "variables"))[-1],
> > >                strip.backquote(names(data)))
> > 
> > Hmm.. Yes, there's a bug (and it's likely not the only one we have
> > relating to odd variable names in model formulas), but I suspect that
> > the fix is wrong.
> > 
> > The backquotes are not part of the variable names, but get added by
> > deparsing -- sometimes! Other times they do not: Try for instance
> > as.character(quote(`a(b)`)). (Which is as it should be. Other pieces
> > of logic relating to nonsyntactical names represent some rather
> > awkward compromises.)
> > 
> > When backquotes have found their way into names(data) or the
> > "variables" attribute, I would rather suspect that they were created
> > by the wrong tool and fix that, not cure the symptom by stripping them
> > off at a later stage.
> 
> In model.frame.default there is a line:
> 
>    varnames <- as.character(vars[-1])
> 
> that turns part of a call object, vars, into a character string.  
> We could change that to:
> 
>    varnames <- strip.backquote(as.character(as.list(vars[-1])))
> 
> or perhaps as.character should not return the backquotes in the
> first place in which case the fix would be to fix as.character.

Or not use it in this way. I forget what the reasoning was behind the
current behaviour of as.character, but the point is that 

> as.character(attr(terms(`a(b)`~`c(d)`),"variables"))
[1] "list"   "`a(b)`" "`c(d)`"

whereas for instance

> sapply(attr(terms(`a(b)`~`c(d)`),"variables")[-1],as.character)
[1] "a(b)" "c(d)"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Sat Aug 28 17:15:00 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Sat Aug 28 17:15:13 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
Message-ID: <20040828151500.1FE99394F@mprdmxin.myway.com>


> 
> From:   	Peter Dalgaard <p.dalgaard@biostat.ku.dk>
> 
> "Gabor Grothendieck" <ggrothendieck@myway.com> writes:
> 
> > > ggrothendieck@myway.com writes:
> > >
> > > > The following gives an error:
> > > >
> > > > > `a(b)` <- 1:4
> > > > > `c(d)` <- (1:4)^2
> > > > > lm(`a(b)` ~ `c(d)`)
> > > > Error in model.matrix.default(mt, mf, contrasts) :
> > > > model frame and formula mismatch in model.matrix()
> > > >
> > > > To fix it replace this line in model.matrix.default:
> > > >
> > > > reorder <- match(attr(t, "variables")[-1], names(data))
> > > >
> > > > with these two lines:
> > > >
> > > > strip.backquote <- function(x) gsub("^`(.*)`", "\\1", x)
> > > > reorder <- match(strip.backquote(attr(t, "variables"))[-1],
> > > > strip.backquote(names(data)))
> > >
> > > Hmm.. Yes, there's a bug (and it's likely not the only one we have
> > > relating to odd variable names in model formulas), but I suspect that
> > > the fix is wrong.
> > >
> > > The backquotes are not part of the variable names, but get added by
> > > deparsing -- sometimes! Other times they do not: Try for instance
> > > as.character(quote(`a(b)`)). (Which is as it should be. Other pieces
> > > of logic relating to nonsyntactical names represent some rather
> > > awkward compromises.)
> > >
> > > When backquotes have found their way into names(data) or the
> > > "variables" attribute, I would rather suspect that they were created
> > > by the wrong tool and fix that, not cure the symptom by stripping them
> > > off at a later stage.
> >
> > In model.frame.default there is a line:
> >
> > varnames <- as.character(vars[-1])
> >
> > that turns part of a call object, vars, into a character string.
> > We could change that to:
> >
> > varnames <- strip.backquote(as.character(as.list(vars[-1])))
> >
> > or perhaps as.character should not return the backquotes in the
> > first place in which case the fix would be to fix as.character.
> 
> Or not use it in this way. I forget what the reasoning was behind the
> current behaviour of as.character, but the point is that
> 
> > as.character(attr(terms(`a(b)`~`c(d)`),"variables"))
> [1] "list" "`a(b)`" "`c(d)`"
> 
> whereas for instance
> 
> > sapply(attr(terms(`a(b)`~`c(d)`),"variables")[-1],as.character)
> [1] "a(b)" "c(d)"

1. That is quite subtle but a fix based on that would appear to 
   solve it.

2. Your example and possibly some verbiage should be added to 
   ?as.character .  

3. In looking for the offending spot, I seem to remember (though I did 
   not keep track of it) that one or more of lm, model.frame.default, 
   terms.formula, etc. had additional applications of as.character 
   directly to a list as in your first example and these should 
   probably be changed to correspond to your second example, as 
   well, where as.character is applied to the elements of the 
   list rather than the lsit itself.

From jfox at mcmaster.ca  Sun Aug 29 05:53:11 2004
From: jfox at mcmaster.ca (John Fox)
Date: Sun Aug 29 05:53:13 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0 
Message-ID: <20040829035309.OTHL15743.tomts22-srv.bellnexxia.net@JohnDesktop8300>

Dear list members,

I've encountered the following problem with the Rcmdr Help menu in the
development version of R 2.0.0 under Windows XP ("Version 2.0.0 Under
development (unstable) (2004-08-20), ISBN 3-900051-00-3"):

The main Commander window has a (tcltk) Help menu with three items,
"Commander help", "About Rcmdr", and "Introduction to the R Commander",
which, in the development version of the Rcmdr package, call the following
three functions:

helpCommander <- function() help("Commander")

helpAboutCommander <- function() help("aboutRcmdr")

browseManual <- function() {
    browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
        "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
    }

(Of course, there are help pages for "Commander" and "aboutRcmdr" in the
Rcmdr package).

These functions are not exported by the Rcmdr package, but as near as I can
tell, that doesn't seem to be the source of the problem.

The third menu item works fine, but the other two [which contain calls to
help()] appear to do nothing. I've tried several variations, including
specifying the package argument to help() and using ? in place of help(),
but to no avail. Curiously, calling, e.g., Rcmdr:::helpCommander() directly
from the R command prompt works just fine.

Unrelated to the above, I've also encountered some MD5 checksum problems
with R 2.0.0 binary packages for Windows installed from CRAN:

------------- output --------------------

files R/car have the wrong MD5 checksums
files R/effects have the wrong MD5 checksums
files R/multcomp have the wrong MD5 checksums
files R/relimp have the wrong MD5 checksums

-------------  end  ---------------------

Finally, there seems to be a dependency problem with the lmtest package
Windows binary installed via the "Packages -> Install package(s) from CRAN"
menu in the R Console:
    
------------- output --------------------

> local({a <- CRAN.packages()
+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a,
dependencies=TRUE)})
trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 18348 bytes
opened URL
downloaded 17Kb

also installing the dependencies 'sandwich', 'zoo', 'strucchange'

trying URL
`http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
Content type `application/zip' length 75982 bytes
opened URL
downloaded 74Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
Content type `application/zip' length 53003 bytes
opened URL
downloaded 51Kb

trying URL
`http://cran.r-project.org/bin/windows/contrib/2.0/strucchange_1.2-4.zip'
Error in download.file(url, destfile, method, mode = "wb") : 
        cannot open URL
`http://cran.r-project.org/bin/windows/contrib/2.0/strucchange_1.2-4.zip'
In addition: Warning message: 
cannot open: HTTP status was `404 Not Found' 
> 

-------------  end  ---------------------


Any help would be appreciated, particularly with the problem I'm
experiencing with the Rcmdr Help menu.

Thanks,
 John

From jfox at mcmaster.ca  Sun Aug 29 07:05:49 2004
From: jfox at mcmaster.ca (John Fox)
Date: Sun Aug 29 07:05:53 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0 
In-Reply-To: <20040829035309.OTHL15743.tomts22-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <20040829050549.KYFD14082.tomts16-srv.bellnexxia.net@JohnDesktop8300>

Dear list members,

As an addendum to my previous message, Help buttons in Rcmdr dialogs --
which generate calls to help() -- also fail to bring up corresponding help
pages. 

Again, any assistance would be appreciated.
 John 

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of John Fox
> Sent: Saturday, August 28, 2004 10:53 PM
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] Problem with Rcmdr Help menu under devel 
> version of R 2.0.0 
> 
> Dear list members,
> 
> I've encountered the following problem with the Rcmdr Help 
> menu in the development version of R 2.0.0 under Windows XP 
> ("Version 2.0.0 Under development (unstable) (2004-08-20), 
> ISBN 3-900051-00-3"):
> 
> The main Commander window has a (tcltk) Help menu with three 
> items, "Commander help", "About Rcmdr", and "Introduction to 
> the R Commander", which, in the development version of the 
> Rcmdr package, call the following three functions:
> 
> helpCommander <- function() help("Commander")
> 
> helpAboutCommander <- function() help("aboutRcmdr")
> 
> browseManual <- function() {
>     
> browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
>         "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
>     }
> 
> (Of course, there are help pages for "Commander" and 
> "aboutRcmdr" in the Rcmdr package).
> 
> These functions are not exported by the Rcmdr package, but as 
> near as I can tell, that doesn't seem to be the source of the problem.
> 
> The third menu item works fine, but the other two [which 
> contain calls to help()] appear to do nothing. I've tried 
> several variations, including specifying the package argument 
> to help() and using ? in place of help(), but to no avail. 
> Curiously, calling, e.g., Rcmdr:::helpCommander() directly 
> from the R command prompt works just fine.
> 
> Unrelated to the above, I've also encountered some MD5 
> checksum problems with R 2.0.0 binary packages for Windows 
> installed from CRAN:
> 
> ------------- output --------------------
> 
> files R/car have the wrong MD5 checksums files R/effects have 
> the wrong MD5 checksums files R/multcomp have the wrong MD5 
> checksums files R/relimp have the wrong MD5 checksums
> 
> -------------  end  ---------------------
> 
> Finally, there seems to be a dependency problem with the 
> lmtest package Windows binary installed via the "Packages -> 
> Install package(s) from CRAN"
> menu in the R Console:
>     
> ------------- output --------------------
> 
> > local({a <- CRAN.packages()
> + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> + available=a,
> dependencies=TRUE)})
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> Content type `text/plain; charset=iso-8859-1' length 18348 
> bytes opened URL downloaded 17Kb
> 
> also installing the dependencies 'sandwich', 'zoo', 'strucchange'
> 
> trying URL
> `http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
> Content type `application/zip' length 75982 bytes opened URL 
> downloaded 74Kb
> 
> trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
> Content type `application/zip' length 53003 bytes opened URL 
> downloaded 51Kb
> 
> trying URL
> `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
_1.2-4.zip'
> Error in download.file(url, destfile, method, mode = "wb") : 
>         cannot open URL
> `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
_1.2-4.zip'
> In addition: Warning message: 
> cannot open: HTTP status was `404 Not Found' 
> > 
> 
> -------------  end  ---------------------
> 
> 
> Any help would be appreciated, particularly with the problem 
> I'm experiencing with the Rcmdr Help menu.
> 
> Thanks,
>  John
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Sun Aug 29 08:32:43 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Aug 29 08:32:47 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <20040829050549.KYFD14082.tomts16-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <Pine.LNX.4.44.0408290731120.4097-100000@gannet.stats>

You need to print the result of help.  From NEWS

    o	help() now returns information about available documentation for
	a given topic, and notifies about multiple matches.

and (unstated) does not print.

Brian

On Sun, 29 Aug 2004, John Fox wrote:

> Dear list members,
> 
> As an addendum to my previous message, Help buttons in Rcmdr dialogs --
> which generate calls to help() -- also fail to bring up corresponding help
> pages. 
> 
> Again, any assistance would be appreciated.
>  John 
> 
> > -----Original Message-----
> > From: r-devel-bounces@stat.math.ethz.ch 
> > [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of John Fox
> > Sent: Saturday, August 28, 2004 10:53 PM
> > To: r-devel@stat.math.ethz.ch
> > Subject: [Rd] Problem with Rcmdr Help menu under devel 
> > version of R 2.0.0 
> > 
> > Dear list members,
> > 
> > I've encountered the following problem with the Rcmdr Help 
> > menu in the development version of R 2.0.0 under Windows XP 
> > ("Version 2.0.0 Under development (unstable) (2004-08-20), 
> > ISBN 3-900051-00-3"):
> > 
> > The main Commander window has a (tcltk) Help menu with three 
> > items, "Commander help", "About Rcmdr", and "Introduction to 
> > the R Commander", which, in the development version of the 
> > Rcmdr package, call the following three functions:
> > 
> > helpCommander <- function() help("Commander")
> > 
> > helpAboutCommander <- function() help("aboutRcmdr")
> > 
> > browseManual <- function() {
> >     
> > browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
> >         "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
> >     }
> > 
> > (Of course, there are help pages for "Commander" and 
> > "aboutRcmdr" in the Rcmdr package).
> > 
> > These functions are not exported by the Rcmdr package, but as 
> > near as I can tell, that doesn't seem to be the source of the problem.
> > 
> > The third menu item works fine, but the other two [which 
> > contain calls to help()] appear to do nothing. I've tried 
> > several variations, including specifying the package argument 
> > to help() and using ? in place of help(), but to no avail. 
> > Curiously, calling, e.g., Rcmdr:::helpCommander() directly 
> > from the R command prompt works just fine.
> > 
> > Unrelated to the above, I've also encountered some MD5 
> > checksum problems with R 2.0.0 binary packages for Windows 
> > installed from CRAN:
> > 
> > ------------- output --------------------
> > 
> > files R/car have the wrong MD5 checksums files R/effects have 
> > the wrong MD5 checksums files R/multcomp have the wrong MD5 
> > checksums files R/relimp have the wrong MD5 checksums
> > 
> > -------------  end  ---------------------
> > 
> > Finally, there seems to be a dependency problem with the 
> > lmtest package Windows binary installed via the "Packages -> 
> > Install package(s) from CRAN"
> > menu in the R Console:
> >     
> > ------------- output --------------------
> > 
> > > local({a <- CRAN.packages()
> > + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> > + available=a,
> > dependencies=TRUE)})
> > trying URL 
> > `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> > Content type `text/plain; charset=iso-8859-1' length 18348 
> > bytes opened URL downloaded 17Kb
> > 
> > also installing the dependencies 'sandwich', 'zoo', 'strucchange'
> > 
> > trying URL
> > `http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
> > Content type `application/zip' length 75982 bytes opened URL 
> > downloaded 74Kb
> > 
> > trying URL 
> > `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
> > Content type `application/zip' length 53003 bytes opened URL 
> > downloaded 51Kb
> > 
> > trying URL
> > `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> _1.2-4.zip'
> > Error in download.file(url, destfile, method, mode = "wb") : 
> >         cannot open URL
> > `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> _1.2-4.zip'
> > In addition: Warning message: 
> > cannot open: HTTP status was `404 Not Found' 
> > > 
> > 
> > -------------  end  ---------------------
> > 
> > 
> > Any help would be appreciated, particularly with the problem 
> > I'm experiencing with the Rcmdr Help menu.
> > 
> > Thanks,
> >  John
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From erich.neuwirth at univie.ac.at  Sun Aug 29 08:46:50 2004
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Sun Aug 29 08:47:04 2004
Subject: [Rd] attach behavior
Message-ID: <41317BDA.3010101@univie.ac.at>

In R 1.9.1, attaching an object more than once puts the object's name on 
the search path more than once also. Therefore, to remove it, one has to 
detach it multiply.
Wouldn'tn it make sense to change the behavior of attach in a way
that object names are not added to the search path more than once?

-- 
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386

From ripley at stats.ox.ac.uk  Sun Aug 29 09:09:08 2004
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sun Aug 29 09:07:05 2004
Subject: [Rd] attach behavior
In-Reply-To: <41317BDA.3010101@univie.ac.at>
References: <41317BDA.3010101@univie.ac.at>
Message-ID: <Pine.WNT.4.58.0408290807160.1880@auk>

On Sun, 29 Aug 2004, Erich Neuwirth wrote:

> In R 1.9.1, attaching an object more than once puts the object's name on
> the search path more than once also. Therefore, to remove it, one has to
> detach it multiply.
> Wouldn'tn it make sense to change the behavior of attach in a way
> that object names are not added to the search path more than once?

They need not be the same object, so no.  It's quite common practice to
modify an object, attach it temporarily and detach it again.  I suspect
that people using attach() frequently should be thinking more in terms of
with().

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Sun Aug 29 09:26:08 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Aug 29 09:31:27 2004
Subject: [Rd] attach behavior
In-Reply-To: <Pine.WNT.4.58.0408290807160.1880@auk>
References: <41317BDA.3010101@univie.ac.at>
	<Pine.WNT.4.58.0408290807160.1880@auk>
Message-ID: <x265721k33.fsf@biostat.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> On Sun, 29 Aug 2004, Erich Neuwirth wrote:
> 
> > In R 1.9.1, attaching an object more than once puts the object's name on
> > the search path more than once also. Therefore, to remove it, one has to
> > detach it multiply.
> > Wouldn'tn it make sense to change the behavior of attach in a way
> > that object names are not added to the search path more than once?
> 
> They need not be the same object, so no.  It's quite common practice to
> modify an object, attach it temporarily and detach it again.  I suspect
> that people using attach() frequently should be thinking more in terms of
> with().

That's one argument. Another is that attach(foo) followed by detach()
should leave the search path unchanged. I.e. if attach() is sometimes
a NOP, we must arrange so that the next detach() is one too. You could
do that I suppose, but then there's code that acts depending on what
it finds in search(), and... 

Or, briefly: That way lies madness!

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ligges at statistik.uni-dortmund.de  Sun Aug 29 12:24:03 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Aug 29 12:21:24 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <20040829035309.OTHL15743.tomts22-srv.bellnexxia.net@JohnDesktop8300>
References: <20040829035309.OTHL15743.tomts22-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <4131AEC3.7010700@statistik.uni-dortmund.de>

John,

due to some Server modifications on my side and quite a lot of changes 
in R-2.0.0 (in devel) there might be an inconsistancy on CRAN. I'll 
check it this afternoon (MEST).

Uwe Ligges


John Fox wrote:

> Dear list members,
> 
> I've encountered the following problem with the Rcmdr Help menu in the
> development version of R 2.0.0 under Windows XP ("Version 2.0.0 Under
> development (unstable) (2004-08-20), ISBN 3-900051-00-3"):
> 
> The main Commander window has a (tcltk) Help menu with three items,
> "Commander help", "About Rcmdr", and "Introduction to the R Commander",
> which, in the development version of the Rcmdr package, call the following
> three functions:
> 
> helpCommander <- function() help("Commander")
> 
> helpAboutCommander <- function() help("aboutRcmdr")
> 
> browseManual <- function() {
>     browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
>         "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
>     }
> 
> (Of course, there are help pages for "Commander" and "aboutRcmdr" in the
> Rcmdr package).
> 
> These functions are not exported by the Rcmdr package, but as near as I can
> tell, that doesn't seem to be the source of the problem.
> 
> The third menu item works fine, but the other two [which contain calls to
> help()] appear to do nothing. I've tried several variations, including
> specifying the package argument to help() and using ? in place of help(),
> but to no avail. Curiously, calling, e.g., Rcmdr:::helpCommander() directly
> from the R command prompt works just fine.
> 
> Unrelated to the above, I've also encountered some MD5 checksum problems
> with R 2.0.0 binary packages for Windows installed from CRAN:
> 
> ------------- output --------------------
> 
> files R/car have the wrong MD5 checksums
> files R/effects have the wrong MD5 checksums
> files R/multcomp have the wrong MD5 checksums
> files R/relimp have the wrong MD5 checksums
> 
> -------------  end  ---------------------
> 
> Finally, there seems to be a dependency problem with the lmtest package
> Windows binary installed via the "Packages -> Install package(s) from CRAN"
> menu in the R Console:
>     
> ------------- output --------------------
> 
> 
>>local({a <- CRAN.packages()
> 
> + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a,
> dependencies=TRUE)})
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> Content type `text/plain; charset=iso-8859-1' length 18348 bytes
> opened URL
> downloaded 17Kb
> 
> also installing the dependencies 'sandwich', 'zoo', 'strucchange'
> 
> trying URL
> `http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
> Content type `application/zip' length 75982 bytes
> opened URL
> downloaded 74Kb
> 
> trying URL `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
> Content type `application/zip' length 53003 bytes
> opened URL
> downloaded 51Kb
> 
> trying URL
> `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange_1.2-4.zip'
> Error in download.file(url, destfile, method, mode = "wb") : 
>         cannot open URL
> `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange_1.2-4.zip'
> In addition: Warning message: 
> cannot open: HTTP status was `404 Not Found' 
> 
> 
> -------------  end  ---------------------
> 
> 
> Any help would be appreciated, particularly with the problem I'm
> experiencing with the Rcmdr Help menu.
> 
> Thanks,
>  John
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From jfox at mcmaster.ca  Sun Aug 29 15:18:21 2004
From: jfox at mcmaster.ca (John Fox)
Date: Sun Aug 29 15:18:25 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <Pine.LNX.4.44.0408290731120.4097-100000@gannet.stats>
Message-ID: <20040829131821.VDEJ4758.tomts13-srv.bellnexxia.net@JohnDesktop8300>

Dear Brian,

Thank you very much for this -- I didn't grasp the implication of the NEWS
item.

I still have a small residual problem with respect to notification of
multiple matches, etc.: My normal procedure is to redirect informational
messages from the console to tcltk message boxes, but I can't figure out how
to suppress console output of these messages. If the messages were issued
via warning() rather than writeLines() in print.help_files_with_topic(), I'd
intercept them. Is there a reason for bypassing warning()?

Again, thanks.
 John

> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> Sent: Sunday, August 29, 2004 1:33 AM
> To: John Fox
> Cc: r-devel@stat.math.ethz.ch
> Subject: RE: [Rd] Problem with Rcmdr Help menu under devel 
> version of R 2.0.0
> 
> You need to print the result of help.  From NEWS
> 
>     o	help() now returns information about available documentation for
> 	a given topic, and notifies about multiple matches.
> 
> and (unstated) does not print.
> 
> Brian
> 
> On Sun, 29 Aug 2004, John Fox wrote:
> 
> > Dear list members,
> > 
> > As an addendum to my previous message, Help buttons in 
> Rcmdr dialogs 
> > -- which generate calls to help() -- also fail to bring up 
> > corresponding help pages.
> > 
> > Again, any assistance would be appreciated.
> >  John
> > 
> > > -----Original Message-----
> > > From: r-devel-bounces@stat.math.ethz.ch 
> > > [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of John Fox
> > > Sent: Saturday, August 28, 2004 10:53 PM
> > > To: r-devel@stat.math.ethz.ch
> > > Subject: [Rd] Problem with Rcmdr Help menu under devel 
> version of R 
> > > 2.0.0
> > > 
> > > Dear list members,
> > > 
> > > I've encountered the following problem with the Rcmdr 
> Help menu in 
> > > the development version of R 2.0.0 under Windows XP 
> ("Version 2.0.0 
> > > Under development (unstable) (2004-08-20), ISBN 3-900051-00-3"):
> > > 
> > > The main Commander window has a (tcltk) Help menu with 
> three items, 
> > > "Commander help", "About Rcmdr", and "Introduction to the R 
> > > Commander", which, in the development version of the 
> Rcmdr package, 
> > > call the following three functions:
> > > 
> > > helpCommander <- function() help("Commander")
> > > 
> > > helpAboutCommander <- function() help("aboutRcmdr")
> > > 
> > > browseManual <- function() {
> > >     
> > > 
> browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
> > >         "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
> > >     }
> > > 
> > > (Of course, there are help pages for "Commander" and 
> "aboutRcmdr" in 
> > > the Rcmdr package).
> > > 
> > > These functions are not exported by the Rcmdr package, 
> but as near 
> > > as I can tell, that doesn't seem to be the source of the problem.
> > > 
> > > The third menu item works fine, but the other two [which contain 
> > > calls to help()] appear to do nothing. I've tried several 
> > > variations, including specifying the package argument to 
> help() and 
> > > using ? in place of help(), but to no avail.
> > > Curiously, calling, e.g., Rcmdr:::helpCommander() 
> directly from the 
> > > R command prompt works just fine.
> > > 
> > > Unrelated to the above, I've also encountered some MD5 checksum 
> > > problems with R 2.0.0 binary packages for Windows installed from 
> > > CRAN:
> > > 
> > > ------------- output --------------------
> > > 
> > > files R/car have the wrong MD5 checksums files R/effects have the 
> > > wrong MD5 checksums files R/multcomp have the wrong MD5 checksums 
> > > files R/relimp have the wrong MD5 checksums
> > > 
> > > -------------  end  ---------------------
> > > 
> > > Finally, there seems to be a dependency problem with the lmtest 
> > > package Windows binary installed via the "Packages -> Install 
> > > package(s) from CRAN"
> > > menu in the R Console:
> > >     
> > > ------------- output --------------------
> > > 
> > > > local({a <- CRAN.packages()
> > > + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> > > + available=a,
> > > dependencies=TRUE)})
> > > trying URL
> > > `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> > > Content type `text/plain; charset=iso-8859-1' length 18348 bytes 
> > > opened URL downloaded 17Kb
> > > 
> > > also installing the dependencies 'sandwich', 'zoo', 'strucchange'
> > > 
> > > trying URL
> > > 
> `http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
> > > Content type `application/zip' length 75982 bytes opened URL 
> > > downloaded 74Kb
> > > 
> > > trying URL
> > > `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
> > > Content type `application/zip' length 53003 bytes opened URL 
> > > downloaded 51Kb
> > > 
> > > trying URL
> > > `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> > _1.2-4.zip'
> > > Error in download.file(url, destfile, method, mode = "wb") : 
> > >         cannot open URL
> > > `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> > _1.2-4.zip'
> > > In addition: Warning message: 
> > > cannot open: HTTP status was `404 Not Found' 
> > > > 
> > > 
> > > -------------  end  ---------------------
> > > 
> > > 
> > > Any help would be appreciated, particularly with the problem I'm 
> > > experiencing with the Rcmdr Help menu.
> > > 
> > > Thanks,
> > >  John
> > > 
> > > ______________________________________________
> > > R-devel@stat.math.ethz.ch mailing list 
> > > https://stat.ethz.ch/mailman/listinfo/r-devel
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

From diman.todorov at chello.at  Sun Aug 29 17:21:37 2004
From: diman.todorov at chello.at (Diman Todorov)
Date: Sun Aug 29 15:19:53 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
Message-ID: <20040829152137.0faa78ff.diman.todorov@chello.at>

Dear Dirk,
I have had the exactly same problem like Ivo and his solution worked for me.
Hence the USE=f77 flag is NOT a typo but a Gentoo quirk.
As far as modifying the configure script is concerned, I believe that it is certainly
possible to perform said check (if 'f77 --version == f2c' then die)
only on x86_64 platforms.
And I'd argue it is f2c's fault. AMD64 linux distros have been known to have troubles of this sort
especially as far as compilers are concerned.


regards
Diman Todorov

On Sat, Aug 21, 2004 at 06:59:14AM -0700, [EMAIL PROTECTED] wrote:
> 
> peter/brian:  thank you for the help.  i can now report that gentoo 
> amd64 can compile R just fine, too; it requires the f77 USE flag and a

(Err, no such thing exists: either g77, f2c or the fort77 wrapper for f2c.)

> gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my 
> segfault troubles earlier were caused by my use of f2c.
> 
> suggestion: would it be possible to add a code snippet  that tests 
> whether the user is trying to compile with f2c and if so, bombs the 
> installation?  (if "f77 --version == f2c" then die)  I know the 

Bad idea. 

My Debian configuration, driven from a single configuration, is used on
about a dozen different platforms. One of these, m68k, has a continually
been problematic with g77, which forces us to use f2c. 

And despite your fears, that is working swimmingly for R as well as the by
now 40 or so CRAN packages that are in the distro too, incl the ones like
VR, Hmisc/Design, tseries, ... that contain Fortran code.

> problems are not R's fault, but it can percolate into R and it can 
> protect people like myself.

I'd argue that it wasn't f2c's fault, but maybe an unlucky mix of parts of
your toolchain (gcc, binutils, libc, ...).

From jfox at mcmaster.ca  Sun Aug 29 15:21:17 2004
From: jfox at mcmaster.ca (John Fox)
Date: Sun Aug 29 15:21:20 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <4131AEC3.7010700@statistik.uni-dortmund.de>
Message-ID: <20040829132116.IZU7925.tomts25-srv.bellnexxia.net@JohnDesktop8300>

Dear Uwe,

Brian has solved my help problem. I assume that you're responding to my
report of problems with some R 2.0.0 Windows binary packages on CRAN.

Thanks for your help.
 John

> -----Original Message-----
> From: Uwe Ligges [mailto:ligges@statistik.uni-dortmund.de] 
> Sent: Sunday, August 29, 2004 5:24 AM
> To: John Fox
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] Problem with Rcmdr Help menu under devel 
> version of R 2.0.0
> 
> John,
> 
> due to some Server modifications on my side and quite a lot 
> of changes in R-2.0.0 (in devel) there might be an 
> inconsistancy on CRAN. I'll check it this afternoon (MEST).
> 
> Uwe Ligges
> 
> 
> John Fox wrote:
> 
> > Dear list members,
> > 
> > I've encountered the following problem with the Rcmdr Help 
> menu in the 
> > development version of R 2.0.0 under Windows XP ("Version 
> 2.0.0 Under 
> > development (unstable) (2004-08-20), ISBN 3-900051-00-3"):
> > 
> > The main Commander window has a (tcltk) Help menu with three items, 
> > "Commander help", "About Rcmdr", and "Introduction to the R 
> > Commander", which, in the development version of the Rcmdr package, 
> > call the following three functions:
> > 
> > helpCommander <- function() help("Commander")
> > 
> > helpAboutCommander <- function() help("aboutRcmdr")
> > 
> > browseManual <- function() {
> >     
> browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
> >         "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
> >     }
> > 
> > (Of course, there are help pages for "Commander" and 
> "aboutRcmdr" in 
> > the Rcmdr package).
> > 
> > These functions are not exported by the Rcmdr package, but 
> as near as 
> > I can tell, that doesn't seem to be the source of the problem.
> > 
> > The third menu item works fine, but the other two [which 
> contain calls 
> > to help()] appear to do nothing. I've tried several variations, 
> > including specifying the package argument to help() and using ? in 
> > place of help(), but to no avail. Curiously, calling, e.g., 
> > Rcmdr:::helpCommander() directly from the R command prompt 
> works just fine.
> > 
> > Unrelated to the above, I've also encountered some MD5 checksum 
> > problems with R 2.0.0 binary packages for Windows installed 
> from CRAN:
> > 
> > ------------- output --------------------
> > 
> > files R/car have the wrong MD5 checksums files R/effects have the 
> > wrong MD5 checksums files R/multcomp have the wrong MD5 checksums 
> > files R/relimp have the wrong MD5 checksums
> > 
> > -------------  end  ---------------------
> > 
> > Finally, there seems to be a dependency problem with the lmtest 
> > package Windows binary installed via the "Packages -> 
> Install package(s) from CRAN"
> > menu in the R Console:
> >     
> > ------------- output --------------------
> > 
> > 
> >>local({a <- CRAN.packages()
> > 
> > + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> > + available=a,
> > dependencies=TRUE)})
> > trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> > Content type `text/plain; charset=iso-8859-1' length 18348 bytes 
> > opened URL downloaded 17Kb
> > 
> > also installing the dependencies 'sandwich', 'zoo', 'strucchange'
> > 
> > trying URL
> > 
> `http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
> > Content type `application/zip' length 75982 bytes opened URL 
> > downloaded 74Kb
> > 
> > trying URL 
> `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
> > Content type `application/zip' length 53003 bytes opened URL 
> > downloaded 51Kb
> > 
> > trying URL
> > 
> `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> _1.2-4.zip'
> > Error in download.file(url, destfile, method, mode = "wb") : 
> >         cannot open URL
> > 
> `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> _1.2-4.zip'
> > In addition: Warning message: 
> > cannot open: HTTP status was `404 Not Found' 
> > 
> > 
> > -------------  end  ---------------------
> > 
> > 
> > Any help would be appreciated, particularly with the problem I'm 
> > experiencing with the Rcmdr Help menu.
> > 
> > Thanks,
> >  John
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ripley at stats.ox.ac.uk  Sun Aug 29 15:44:20 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Aug 29 15:44:28 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
In-Reply-To: <20040829152137.0faa78ff.diman.todorov@chello.at>
Message-ID: <Pine.LNX.4.44.0408291443370.2379-100000@gannet.stats>

You are 8 days behind the times -- take a look at the current R-devel.

On Sun, 29 Aug 2004, Diman Todorov wrote:

> Dear Dirk,
> I have had the exactly same problem like Ivo and his solution worked for me.
> Hence the USE=f77 flag is NOT a typo but a Gentoo quirk.
> As far as modifying the configure script is concerned, I believe that it is certainly
> possible to perform said check (if 'f77 --version == f2c' then die)
> only on x86_64 platforms.
> And I'd argue it is f2c's fault. AMD64 linux distros have been known to have troubles of this sort
> especially as far as compilers are concerned.
> 
> 
> regards
> Diman Todorov
> 
> On Sat, Aug 21, 2004 at 06:59:14AM -0700, [EMAIL PROTECTED] wrote:
> > 
> > peter/brian:  thank you for the help.  i can now report that gentoo 
> > amd64 can compile R just fine, too; it requires the f77 USE flag and a
> 
> (Err, no such thing exists: either g77, f2c or the fort77 wrapper for f2c.)
> 
> > gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my 
> > segfault troubles earlier were caused by my use of f2c.
> > 
> > suggestion: would it be possible to add a code snippet  that tests 
> > whether the user is trying to compile with f2c and if so, bombs the 
> > installation?  (if "f77 --version == f2c" then die)  I know the 
> 
> Bad idea. 
> 
> My Debian configuration, driven from a single configuration, is used on
> about a dozen different platforms. One of these, m68k, has a continually
> been problematic with g77, which forces us to use f2c. 
> 
> And despite your fears, that is working swimmingly for R as well as the by
> now 40 or so CRAN packages that are in the distro too, incl the ones like
> VR, Hmisc/Design, tseries, ... that contain Fortran code.
> 
> > problems are not R's fault, but it can percolate into R and it can 
> > protect people like myself.
> 
> I'd argue that it wasn't f2c's fault, but maybe an unlucky mix of parts of
> your toolchain (gcc, binutils, libc, ...).
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sun Aug 29 15:46:05 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Aug 29 15:46:09 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <20040829131821.VDEJ4758.tomts13-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <Pine.LNX.4.44.0408291444490.2379-100000@gannet.stats>

John,

It's not my code but I think the intention is that you should write your 
own print function for a GUI.

Brian

On Sun, 29 Aug 2004, John Fox wrote:

> Dear Brian,
> 
> Thank you very much for this -- I didn't grasp the implication of the NEWS
> item.
> 
> I still have a small residual problem with respect to notification of
> multiple matches, etc.: My normal procedure is to redirect informational
> messages from the console to tcltk message boxes, but I can't figure out how
> to suppress console output of these messages. If the messages were issued
> via warning() rather than writeLines() in print.help_files_with_topic(), I'd
> intercept them. Is there a reason for bypassing warning()?
> 
> Again, thanks.
>  John
> 
> > -----Original Message-----
> > From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> > Sent: Sunday, August 29, 2004 1:33 AM
> > To: John Fox
> > Cc: r-devel@stat.math.ethz.ch
> > Subject: RE: [Rd] Problem with Rcmdr Help menu under devel 
> > version of R 2.0.0
> > 
> > You need to print the result of help.  From NEWS
> > 
> >     o	help() now returns information about available documentation for
> > 	a given topic, and notifies about multiple matches.
> > 
> > and (unstated) does not print.
> > 
> > Brian
> > 
> > On Sun, 29 Aug 2004, John Fox wrote:
> > 
> > > Dear list members,
> > > 
> > > As an addendum to my previous message, Help buttons in 
> > Rcmdr dialogs 
> > > -- which generate calls to help() -- also fail to bring up 
> > > corresponding help pages.
> > > 
> > > Again, any assistance would be appreciated.
> > >  John
> > > 
> > > > -----Original Message-----
> > > > From: r-devel-bounces@stat.math.ethz.ch 
> > > > [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of John Fox
> > > > Sent: Saturday, August 28, 2004 10:53 PM
> > > > To: r-devel@stat.math.ethz.ch
> > > > Subject: [Rd] Problem with Rcmdr Help menu under devel 
> > version of R 
> > > > 2.0.0
> > > > 
> > > > Dear list members,
> > > > 
> > > > I've encountered the following problem with the Rcmdr 
> > Help menu in 
> > > > the development version of R 2.0.0 under Windows XP 
> > ("Version 2.0.0 
> > > > Under development (unstable) (2004-08-20), ISBN 3-900051-00-3"):
> > > > 
> > > > The main Commander window has a (tcltk) Help menu with 
> > three items, 
> > > > "Commander help", "About Rcmdr", and "Introduction to the R 
> > > > Commander", which, in the development version of the 
> > Rcmdr package, 
> > > > call the following three functions:
> > > > 
> > > > helpCommander <- function() help("Commander")
> > > > 
> > > > helpAboutCommander <- function() help("aboutRcmdr")
> > > > 
> > > > browseManual <- function() {
> > > >     
> > > > 
> > browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
> > > >         "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
> > > >     }
> > > > 
> > > > (Of course, there are help pages for "Commander" and 
> > "aboutRcmdr" in 
> > > > the Rcmdr package).
> > > > 
> > > > These functions are not exported by the Rcmdr package, 
> > but as near 
> > > > as I can tell, that doesn't seem to be the source of the problem.
> > > > 
> > > > The third menu item works fine, but the other two [which contain 
> > > > calls to help()] appear to do nothing. I've tried several 
> > > > variations, including specifying the package argument to 
> > help() and 
> > > > using ? in place of help(), but to no avail.
> > > > Curiously, calling, e.g., Rcmdr:::helpCommander() 
> > directly from the 
> > > > R command prompt works just fine.
> > > > 
> > > > Unrelated to the above, I've also encountered some MD5 checksum 
> > > > problems with R 2.0.0 binary packages for Windows installed from 
> > > > CRAN:
> > > > 
> > > > ------------- output --------------------
> > > > 
> > > > files R/car have the wrong MD5 checksums files R/effects have the 
> > > > wrong MD5 checksums files R/multcomp have the wrong MD5 checksums 
> > > > files R/relimp have the wrong MD5 checksums
> > > > 
> > > > -------------  end  ---------------------
> > > > 
> > > > Finally, there seems to be a dependency problem with the lmtest 
> > > > package Windows binary installed via the "Packages -> Install 
> > > > package(s) from CRAN"
> > > > menu in the R Console:
> > > >     
> > > > ------------- output --------------------
> > > > 
> > > > > local({a <- CRAN.packages()
> > > > + install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
> > > > + available=a,
> > > > dependencies=TRUE)})
> > > > trying URL
> > > > `http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
> > > > Content type `text/plain; charset=iso-8859-1' length 18348 bytes 
> > > > opened URL downloaded 17Kb
> > > > 
> > > > also installing the dependencies 'sandwich', 'zoo', 'strucchange'
> > > > 
> > > > trying URL
> > > > 
> > `http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
> > > > Content type `application/zip' length 75982 bytes opened URL 
> > > > downloaded 74Kb
> > > > 
> > > > trying URL
> > > > `http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
> > > > Content type `application/zip' length 53003 bytes opened URL 
> > > > downloaded 51Kb
> > > > 
> > > > trying URL
> > > > `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> > > _1.2-4.zip'
> > > > Error in download.file(url, destfile, method, mode = "wb") : 
> > > >         cannot open URL
> > > > `http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
> > > _1.2-4.zip'
> > > > In addition: Warning message: 
> > > > cannot open: HTTP status was `404 Not Found' 
> > > > > 
> > > > 
> > > > -------------  end  ---------------------
> > > > 
> > > > 
> > > > Any help would be appreciated, particularly with the problem I'm 
> > > > experiencing with the Rcmdr Help menu.
> > > > 
> > > > Thanks,
> > > >  John
> > > > 
> > > > ______________________________________________
> > > > R-devel@stat.math.ethz.ch mailing list 
> > > > https://stat.ethz.ch/mailman/listinfo/r-devel
> > > 
> > > ______________________________________________
> > > R-devel@stat.math.ethz.ch mailing list 
> > > https://stat.ethz.ch/mailman/listinfo/r-devel
> > > 
> > > 
> > 
> > -- 
> > Brian D. Ripley,                  ripley@stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272866 (PA)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jfox at mcmaster.ca  Sun Aug 29 16:28:16 2004
From: jfox at mcmaster.ca (John Fox)
Date: Sun Aug 29 16:28:18 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <Pine.LNX.4.44.0408291444490.2379-100000@gannet.stats>
Message-ID: <20040829142815.BPXJ7925.tomts25-srv.bellnexxia.net@JohnDesktop8300>

Dear Brian,

OK -- it's simple for me to replace all the calls to writeLines() in
print.help_files_with_topic() with calls to warning(), but since these are
warning messages, I don't see why the former is preferred to the latter
(though, of course, I may be missing something -- and, as you say, you
didn't write this code). Or is your point more general -- that I should have
a different generic print function? If so, how could I avoid writing new
print methods? (Again, perhaps there's a general solution here that I don't
see.)

Regards,
 John

> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> Sent: Sunday, August 29, 2004 8:46 AM
> To: John Fox
> Cc: r-devel@stat.math.ethz.ch
> Subject: RE: [Rd] Problem with Rcmdr Help menu under devel 
> version of R 2.0.0
> 
> John,
> 
> It's not my code but I think the intention is that you should 
> write your own print function for a GUI.
> 
> Brian
> 
> On Sun, 29 Aug 2004, John Fox wrote:
> 
> > Dear Brian,
> > 
> > Thank you very much for this -- I didn't grasp the 
> implication of the 
> > NEWS item.
> > 
> > I still have a small residual problem with respect to 
> notification of 
> > multiple matches, etc.: My normal procedure is to redirect 
> > informational messages from the console to tcltk message 
> boxes, but I 
> > can't figure out how to suppress console output of these 
> messages. If 
> > the messages were issued via warning() rather than writeLines() in 
> > print.help_files_with_topic(), I'd intercept them. Is there 
> a reason for bypassing warning()?
> > 
> > Again, thanks.
> >  John
> >

From ripley at stats.ox.ac.uk  Sun Aug 29 16:30:33 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Aug 29 16:30:36 2004
Subject: [Rd] Problem with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <20040829142815.BPXJ7925.tomts25-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <Pine.LNX.4.44.0408291529220.2494-100000@gannet.stats>

On Sun, 29 Aug 2004, John Fox wrote:

> Dear Brian,
> 
> OK -- it's simple for me to replace all the calls to writeLines() in
> print.help_files_with_topic() with calls to warning(), but since these are
> warning messages, I don't see why the former is preferred to the latter
> (though, of course, I may be missing something -- and, as you say, you
> didn't write this code). Or is your point more general -- that I should have
> a different generic print function? If so, how could I avoid writing new
> print methods? (Again, perhaps there's a general solution here that I don't
> see.)

I think the intention is that you have a function say RcmdrShow, and 
write methods for that, with RcmdrShow.default calling print.

Brian

> 
> Regards,
>  John
> 
> > -----Original Message-----
> > From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> > Sent: Sunday, August 29, 2004 8:46 AM
> > To: John Fox
> > Cc: r-devel@stat.math.ethz.ch
> > Subject: RE: [Rd] Problem with Rcmdr Help menu under devel 
> > version of R 2.0.0
> > 
> > John,
> > 
> > It's not my code but I think the intention is that you should 
> > write your own print function for a GUI.
> > 
> > Brian
> > 
> > On Sun, 29 Aug 2004, John Fox wrote:
> > 
> > > Dear Brian,
> > > 
> > > Thank you very much for this -- I didn't grasp the 
> > implication of the 
> > > NEWS item.
> > > 
> > > I still have a small residual problem with respect to 
> > notification of 
> > > multiple matches, etc.: My normal procedure is to redirect 
> > > informational messages from the console to tcltk message 
> > boxes, but I 
> > > can't figure out how to suppress console output of these 
> > messages. If 
> > > the messages were issued via warning() rather than writeLines() in 
> > > print.help_files_with_topic(), I'd intercept them. Is there 
> > a reason for bypassing warning()?
> > > 
> > > Again, thanks.
> > >  John
> > > 
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From diman.todorov at chello.at  Sun Aug 29 16:48:38 2004
From: diman.todorov at chello.at (Diman Todorov)
Date: Sun Aug 29 16:49:02 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
Message-ID: <83015F2F-F9CA-11D8-999A-000A95AA0D40@chello.at>

My appologies, this estimation is about right,
I spent last week at COMPSTAT in prague and didn't follow the list 
closely.
Inspite of this fact I believe my posting is not entirely out of date.


regards
Diman Todorov



------------------------------

You are 8 days behind the times -- take a look at the current R-devel.

On Sun, 29 Aug 2004, Diman Todorov wrote:

 > Dear Dirk,
 > I have had the exactly same problem like Ivo and his solution worked 
for me.
 > Hence the USE=f77 flag is NOT a typo but a Gentoo quirk.
 > As far as modifying the configure script is concerned, I believe that 
it is certainly
 > possible to perform said check (if 'f77 --version == f2c' then die)
 > only on x86_64 platforms.
 > And I'd argue it is f2c's fault. AMD64 linux distros have been known 
to have troubles of this sort
 > especially as far as compilers are concerned.
 >
 >
 > regards
 > Diman Todorov
 >
 > On Sat, Aug 21, 2004 at 06:59:14AM -0700, [EMAIL PROTECTED] wrote:
 > >
 > > peter/brian:  thank you for the help.  i can now report that gentoo
 > > amd64 can compile R just fine, too; it requires the f77 USE flag 
and a
 >
 > (Err, no such thing exists: either g77, f2c or the fort77 wrapper for 
f2c.)
 >
 > > gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my
 > > segfault troubles earlier were caused by my use of f2c.
 > >
 > > suggestion: would it be possible to add a code snippet  that tests
 > > whether the user is trying to compile with f2c and if so, bombs the
 > > installation?  (if "f77 --version == f2c" then die)  I know the
 >
 > Bad idea.
 >
 > My Debian configuration, driven from a single configuration, is used 
on
 > about a dozen different platforms. One of these, m68k, has a 
continually
 > been problematic with g77, which forces us to use f2c.
 >
 > And despite your fears, that is working swimmingly for R as well as 
the by
 > now 40 or so CRAN packages that are in the distro too, incl the ones 
like
 > VR, Hmisc/Design, tseries, ... that contain Fortran code.
 >
 > > problems are not R's fault, but it can percolate into R and it can
 > > protect people like myself.
 >
 > I'd argue that it wasn't f2c's fault, but maybe an unlucky mix of 
parts of
 > your toolchain (gcc, binutils, libc, ...).
 >
 > ______________________________________________
 > R-devel at stat.math.ethz.ch mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-devel
 >
 >

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Sun Aug 29 16:59:07 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Aug 29 16:57:58 2004
Subject: [Rd] R-2.0.0 (devel) binary Windows package problems; was: Problem
	with Rcmdr Help menu under devel version of R 2.0.0
In-Reply-To: <20040829132116.IZU7925.tomts25-srv.bellnexxia.net@JohnDesktop8300>
References: <20040829132116.IZU7925.tomts25-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <4131EF3B.2050408@statistik.uni-dortmund.de>

John Fox wrote:
> Dear Uwe,
> 
> Brian has solved my help problem. I assume that you're responding to my
> report of problems with some R 2.0.0 Windows binary packages on CRAN.

John,

you are right (I was in hurry this morning, hence the too short answer).
Thanks for reporting your problems.

The problem with package dependencies was my fault and will be fixed 
tomorrow. I was not careful enough during the last complete update of 
the binary packages (the scipts should have removed strucchange for 
R-2.0.0 also from the PACKAGES file, since it gives an error - Achim 
might want to fix it).

Wrong MD5 checksums are also reported by the machine I'm compiling the 
packages on. Look's like something has been chenged - but I do not know 
what ...
Just ignore the warnings and trust your updated virus scanner in the 
meantime. ;-)

Uwe




> Thanks for your help.
>  John
> 
> 
>>-----Original Message-----
>>From: Uwe Ligges [mailto:ligges@statistik.uni-dortmund.de] 
>>Sent: Sunday, August 29, 2004 5:24 AM
>>To: John Fox
>>Cc: r-devel@stat.math.ethz.ch
>>Subject: Re: [Rd] Problem with Rcmdr Help menu under devel 
>>version of R 2.0.0
>>
>>John,
>>
>>due to some Server modifications on my side and quite a lot 
>>of changes in R-2.0.0 (in devel) there might be an 
>>inconsistancy on CRAN. I'll check it this afternoon (MEST).
>>
>>Uwe Ligges
>>
>>
>>John Fox wrote:
>>
>>
>>>Dear list members,
>>>
>>>I've encountered the following problem with the Rcmdr Help 
>>
>>menu in the 
>>
>>>development version of R 2.0.0 under Windows XP ("Version 
>>
>>2.0.0 Under 
>>
>>>development (unstable) (2004-08-20), ISBN 3-900051-00-3"):
>>>
>>>The main Commander window has a (tcltk) Help menu with three items, 
>>>"Commander help", "About Rcmdr", and "Introduction to the R 
>>>Commander", which, in the development version of the Rcmdr package, 
>>>call the following three functions:
>>>
>>>helpCommander <- function() help("Commander")
>>>
>>>helpAboutCommander <- function() help("aboutRcmdr")
>>>
>>>browseManual <- function() {
>>>    
>>
>>browseURL(paste(file.path(.path.package(package="Rcmdr")[1], "doc"), 
>>
>>>        "/Getting-Started-with-the-Rcmdr.pdf", sep=""))
>>>    }
>>>
>>>(Of course, there are help pages for "Commander" and 
>>
>>"aboutRcmdr" in 
>>
>>>the Rcmdr package).
>>>
>>>These functions are not exported by the Rcmdr package, but 
>>
>>as near as 
>>
>>>I can tell, that doesn't seem to be the source of the problem.
>>>
>>>The third menu item works fine, but the other two [which 
>>
>>contain calls 
>>
>>>to help()] appear to do nothing. I've tried several variations, 
>>>including specifying the package argument to help() and using ? in 
>>>place of help(), but to no avail. Curiously, calling, e.g., 
>>>Rcmdr:::helpCommander() directly from the R command prompt 
>>
>>works just fine.
>>
>>>Unrelated to the above, I've also encountered some MD5 checksum 
>>>problems with R 2.0.0 binary packages for Windows installed 
>>
>>from CRAN:
>>
>>>------------- output --------------------
>>>
>>>files R/car have the wrong MD5 checksums files R/effects have the 
>>>wrong MD5 checksums files R/multcomp have the wrong MD5 checksums 
>>>files R/relimp have the wrong MD5 checksums
>>>
>>>-------------  end  ---------------------
>>>
>>>Finally, there seems to be a dependency problem with the lmtest 
>>>package Windows binary installed via the "Packages -> 
>>
>>Install package(s) from CRAN"
>>
>>>menu in the R Console:
>>>    
>>>------------- output --------------------
>>>
>>>
>>>
>>>>local({a <- CRAN.packages()
>>>
>>>+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], 
>>>+ available=a,
>>>dependencies=TRUE)})
>>>trying URL 
>>
>>`http://cran.r-project.org/bin/windows/contrib/2.0/PACKAGES'
>>
>>>Content type `text/plain; charset=iso-8859-1' length 18348 bytes 
>>>opened URL downloaded 17Kb
>>>
>>>also installing the dependencies 'sandwich', 'zoo', 'strucchange'
>>>
>>>trying URL
>>>
>>
>>`http://cran.r-project.org/bin/windows/contrib/2.0/sandwich_0.1-3.zip'
>>
>>>Content type `application/zip' length 75982 bytes opened URL 
>>>downloaded 74Kb
>>>
>>>trying URL 
>>
>>`http://cran.r-project.org/bin/windows/contrib/2.0/zoo_0.2-0.zip'
>>
>>>Content type `application/zip' length 53003 bytes opened URL 
>>>downloaded 51Kb
>>>
>>>trying URL
>>>
>>
>>`http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
>>_1.2-4.zip'
>>
>>>Error in download.file(url, destfile, method, mode = "wb") : 
>>>        cannot open URL
>>>
>>
>>`http://cran.r-project.org/bin/windows/contrib/2.0/strucchange
>>_1.2-4.zip'
>>
>>>In addition: Warning message: 
>>>cannot open: HTTP status was `404 Not Found' 
>>>
>>>
>>>-------------  end  ---------------------
>>>
>>>
>>>Any help would be appreciated, particularly with the problem I'm 
>>>experiencing with the Rcmdr Help menu.
>>>
>>>Thanks,
>>> John
>>>
>>>______________________________________________
>>>R-devel@stat.math.ethz.ch mailing list 
>>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>

From ripley at stats.ox.ac.uk  Sun Aug 29 17:02:23 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Aug 29 17:02:32 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
In-Reply-To: <83015F2F-F9CA-11D8-999A-000A95AA0D40@chello.at>
Message-ID: <Pine.LNX.4.44.0408291601250.2552-100000@gannet.stats>

On Sun, 29 Aug 2004, Diman Todorov wrote:

> My appologies, this estimation is about right,
> I spent last week at COMPSTAT in prague and didn't follow the list 
> closely.
> Inspite of this fact I believe my posting is not entirely out of date.

Have you actually looked at the current R-devel, which no longer allows
f2c to be used on 64-bit platforms?

> 
> 
> regards
> Diman Todorov
> 
> 
> 
> ------------------------------
> 
> You are 8 days behind the times -- take a look at the current R-devel.
> 
> On Sun, 29 Aug 2004, Diman Todorov wrote:
> 
>  > Dear Dirk,
>  > I have had the exactly same problem like Ivo and his solution worked 
> for me.
>  > Hence the USE=f77 flag is NOT a typo but a Gentoo quirk.
>  > As far as modifying the configure script is concerned, I believe that 
> it is certainly
>  > possible to perform said check (if 'f77 --version == f2c' then die)
>  > only on x86_64 platforms.
>  > And I'd argue it is f2c's fault. AMD64 linux distros have been known 
> to have troubles of this sort
>  > especially as far as compilers are concerned.
>  >
>  >
>  > regards
>  > Diman Todorov
>  >
>  > On Sat, Aug 21, 2004 at 06:59:14AM -0700, [EMAIL PROTECTED] wrote:
>  > >
>  > > peter/brian:  thank you for the help.  i can now report that gentoo
>  > > amd64 can compile R just fine, too; it requires the f77 USE flag 
> and a
>  >
>  > (Err, no such thing exists: either g77, f2c or the fort77 wrapper for 
> f2c.)
>  >
>  > > gcc compiler rebuild first, though.  I also went to gcc 3.4.1.  my
>  > > segfault troubles earlier were caused by my use of f2c.
>  > >
>  > > suggestion: would it be possible to add a code snippet  that tests
>  > > whether the user is trying to compile with f2c and if so, bombs the
>  > > installation?  (if "f77 --version == f2c" then die)  I know the
>  >
>  > Bad idea.
>  >
>  > My Debian configuration, driven from a single configuration, is used 
> on
>  > about a dozen different platforms. One of these, m68k, has a 
> continually
>  > been problematic with g77, which forces us to use f2c.
>  >
>  > And despite your fears, that is working swimmingly for R as well as 
> the by
>  > now 40 or so CRAN packages that are in the distro too, incl the ones 
> like
>  > VR, Hmisc/Design, tseries, ... that contain Fortran code.
>  >
>  > > problems are not R's fault, but it can percolate into R and it can
>  > > protect people like myself.
>  >
>  > I'd argue that it wasn't f2c's fault, but maybe an unlucky mix of 
> parts of
>  > your toolchain (gcc, binutils, libc, ...).
>  >
>  > ______________________________________________
>  > R-devel at stat.math.ethz.ch mailing list
>  > https://stat.ethz.ch/mailman/listinfo/r-devel
>  >
>  >
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From diman.todorov at chello.at  Sun Aug 29 17:10:35 2004
From: diman.todorov at chello.at (Diman Todorov)
Date: Sun Aug 29 17:10:58 2004
Subject: [Rd] Re: [R] R on gentoo amd64 (gcc 3.3.3) is unstable --- no!
In-Reply-To: <Pine.LNX.4.44.0408291601250.2552-100000@gannet.stats>
References: <Pine.LNX.4.44.0408291601250.2552-100000@gannet.stats>
Message-ID: <9413C5EC-F9CD-11D8-999A-000A95AA0D40@chello.at>

Dear Brian,

> Have you actually looked at the current R-devel, which no longer allows
> f2c to be used on 64-bit platforms?
>
I kindly invite you to quote the part of my posting that made you think 
that I hadn't read
those previous postings.
I believe I was addressing Dirk's response to Ivo's solution to said 
problem.
I was pointing out that in gentoo you actually have to set the USE flag 
to USE=USE:f77
although f77 is not a compiler name. Dirk suggested that f77 might be a 
typo
which i negated.
I can see how such a detail might have eluded you while skimming texts 
briefly.

regards
Diman Todorov

From jmc at research.bell-labs.com  Sun Aug 29 22:21:10 2004
From: jmc at research.bell-labs.com (John Chambers)
Date: Sun Aug 29 22:21:20 2004
Subject: [Rd] classes and namespaces, continued
Message-ID: <41323AB6.C8C1F629@research.bell-labs.com>

Some more fixes have been committed to r-devel, again with the aim of
making S4 classes, including non-exported classes, work with
namespaces.  (This is inevitably an iterative process of finding
examples where only the class name, without the relevant
package/environment, is passed down.)

John
-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From p.dalgaard at biostat.ku.dk  Mon Aug 30 01:47:47 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Aug 30 01:53:16 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
In-Reply-To: <20040828151500.1FE99394F@mprdmxin.myway.com>
References: <20040828151500.1FE99394F@mprdmxin.myway.com>
Message-ID: <x2sma5ld5o.fsf@biostat.ku.dk>

"Gabor Grothendieck" <ggrothendieck@myway.com> writes:

> > > as.character(attr(terms(`a(b)`~`c(d)`),"variables"))
> > [1] "list" "`a(b)`" "`c(d)`"
> > 
> > whereas for instance
> > 
> > > sapply(attr(terms(`a(b)`~`c(d)`),"variables")[-1],as.character)
> > [1] "a(b)" "c(d)"
> 
> 1. That is quite subtle but a fix based on that would appear to 
>    solve it.

Hmm, not quite. I tried, and terms like offset(foo) gets me in
trouble. Probably, I was fixing the wrong end of the original problem:
In the comparisons, we can't have one side with backquotes and the
other without them. That doesn't have to mean that they should be
removed from both sides, and indeed it would get us in trouble if
someone was perverse enough to do things like

 y ~ `offset(foo)` + offset(foo)

I.e. perhaps the real issue is that names(data) gets generated without
backquotes.

Anyways, this is a real can of worms and I'm not sure we're not too
close to 2.0.0 to start tampering with it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Mon Aug 30 03:35:21 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Aug 30 03:35:29 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
Message-ID: <20040830013521.DDAEC39AA@mprdmxin.myway.com>


Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:
>
> "Gabor Grothendieck" <ggrothendieck@myway.com> writes:
> 
> > > > as.character(attr(terms(`a(b)`~`c(d)`),"variables"))
> > > [1] "list" "`a(b)`" "`c(d)`"
> > >
> > > whereas for instance
> > >
> > > > sapply(attr(terms(`a(b)`~`c(d)`),"variables")[-1],as.character)
> > > [1] "a(b)" "c(d)"
> >
> > 1. That is quite subtle but a fix based on that would appear to
> > solve it.
> 
> Hmm, not quite. I tried, and terms like offset(foo) gets me in
> trouble. Probably, I was fixing the wrong end of the original problem:
> In the comparisons, we can't have one side with backquotes and the
> other without them. That doesn't have to mean that they should be
> removed from both sides, and indeed it would get us in trouble if
> someone was perverse enough to do things like
> 
> y ~ `offset(foo)` + offset(foo)
> 
> I.e. perhaps the real issue is that names(data) gets generated without
> backquotes.
> 
> Anyways, this is a real can of worms and I'm not sure we're not too
> close to 2.0.0 to start tampering with it...

How about a partial fix that does not address pathological 
cases where the variable names themselves have embedded 
backquotes but does address the common cases such as:

	y <- ts(1:10); x1 <- y^2; x2 <- y^4
	lm(`lag(y)` ~ ., cbind(lag(y), x1, diff(x2)) )

without having to resort to:

	lm(lag.y ~ ., cbind(lag.y = lag(y), x1, diff(x2)) )

From p.dalgaard at biostat.ku.dk  Mon Aug 30 08:34:35 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Aug 30 08:39:55 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
In-Reply-To: <20040830013521.DDAEC39AA@mprdmxin.myway.com>
References: <20040830013521.DDAEC39AA@mprdmxin.myway.com>
Message-ID: <x2r7ppp210.fsf@biostat.ku.dk>

"Gabor Grothendieck" <ggrothendieck@myway.com> writes:

> > y ~ `offset(foo)` + offset(foo)
> > 
> > I.e. perhaps the real issue is that names(data) gets generated without
> > backquotes.
> > 
> > Anyways, this is a real can of worms and I'm not sure we're not too
> > close to 2.0.0 to start tampering with it...
> 
> How about a partial fix that does not address pathological 
> cases where the variable names themselves have embedded 
> backquotes but does address the common cases such as:
> 
> 	y <- ts(1:10); x1 <- y^2; x2 <- y^4
> 	lm(`lag(y)` ~ ., cbind(lag(y), x1, diff(x2)) )
> 
> without having to resort to:
> 
> 	lm(lag.y ~ ., cbind(lag.y = lag(y), x1, diff(x2)) )

Hmmm... Point taken, but I'm not happy about the fact that the
internals seem unable to  discern `lag(y)` (the name) and lag(y) (the
call). One might consider "backtickifying" the names of the data
matrix instead:

> bq <- function(x)sapply(x,
          function(nm)deparse(as.name(nm),backtick=TRUE))
> bq(c("a","a(b)"))
       a     a(b)
     "a" "`a(b)`"


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ggrothendieck at myway.com  Mon Aug 30 16:21:03 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Mon Aug 30 16:21:12 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
Message-ID: <20040830142103.2926312CEF@mprdmxin.myway.com>


Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:
> 
> "Gabor Grothendieck" <ggrothendieck@myway.com> writes:
> 
> > > y ~ `offset(foo)` + offset(foo)
> > >
> > > I.e. perhaps the real issue is that names(data) gets generated without
> > > backquotes.
> > >
> > > Anyways, this is a real can of worms and I'm not sure we're not too
> > > close to 2.0.0 to start tampering with it...
> >
> > How about a partial fix that does not address pathological
> > cases where the variable names themselves have embedded
> > backquotes but does address the common cases such as:
> >
> >      y <- ts(1:10); x1 <- y^2; x2 <- y^4
> >      lm(`lag(y)` ~ ., cbind(lag(y), x1, diff(x2)) )
> >
> > without having to resort to:
> >
> >      lm(lag.y ~ ., cbind(lag.y = lag(y), x1, diff(x2)) )
> 
> Hmmm... Point taken, but I'm not happy about the fact that the
> internals seem unable to discern `lag(y)` (the name) and lag(y) (the
> call). One might consider "backtickifying" the names of the data
> matrix instead:
> 
> > bq <- function(x)sapply(x,
> function(nm)deparse(as.name(nm),backtick=TRUE))
> > bq(c("a","a(b)"))
> a a(b)
> "a" "`a(b)`"

Just one other comment.  The reason that the example I provided arises
is that one cannot write:

      lm(lag(y) ~ x1 + diff(x2))
or
      lm(lag(y) ~ x1 + diff(x2), cbind(y, x1, x2))

For these to work it would have to align the time scales of ts
objects passed to it.

From gunter.berton at gene.com  Mon Aug 30 19:21:16 2004
From: gunter.berton at gene.com (gunter.berton@gene.com)
Date: Mon Aug 30 19:21:21 2004
Subject: [Rd] small bug in apply() ??? (PR#7205)
Message-ID: <20040830172116.1B599EAC0@slim.kubism.ku.dk>

System: R 1.9.1 on Windows 2000.

Description of problem:

So far as I can tell, this occurs only when using apply() on an array of
dimension >=3 AND when for each iteration the function returns a named
vector of length >=2. I propose the source of the bug and the fix below,
but let me stick to the facts first.

Here is an example:

>a<-array(1:24, dim=2:4)
> func1<-function(x)c(a=mean(x),b=max(x))
> func2<-function(x)c(mean(x),max(x))
> apply(a,1:2,func1)
Error in array(ans, c(len.a%/%d2, d.ans), if (is.null(dn.ans)) { :
        length of dimnames [2] must match that of dims [3]
> apply(a,1:2,func2)
, , 1

     [,1] [,2]
[1,]   10   11
[2,]   19   20

, , 2

     [,1] [,2]
[1,]   12   13
[2,]   21   22

, , 3

     [,1] [,2]
[1,]   14   15
[2,]   23   24

******************
The problem appears to be in the next to last line of apply in the
"list" construction

if (len.a > 0 && len.a%%d2 == 0)
        return(array(ans, c(len.a%/%d2, d.ans), if (is.null(dn.ans)) {
            if (!is.null(ans.names)) *****list(ans.names, NULL) ****
        } else c(list(ans.names), dn.ans)))
    return(ans)
}

As the error message says, the dimnames list is the wrong length. I
believe the following change fixes the problem, though someone much more
familiar with the code will need to check and/or improve it:

 if (len.a > 0 && len.a%%d2 == 0)
        return(array(ans, c(len.a%/%d2, d.ans), if (is.null(dn.ans)) {
            if (!is.null(ans.names))
*****c(list(ans.names),vector(mode="list",length(d.ans)))  *****
        } else c(list(ans.names), dn.ans)))
    return(ans)
}

With this change, both my examples (and others) ran fine.

I checked the bug list and didn't find this problem, but if I just
missed it, I apologize for wasting your time. While I am here, let me
again take the opportunity to say that I continue to be amazed by the R
phenomenon. I appreciate the hard work that you all do, and I am
astounded by the patience you display on R-help answering questions from
people who for reasons I cannot fathom, won't read the excellent
documentation that you all have written. Sometimes I get exasperated
just reading the questions, let alone answering them.

Cheers,

Bert Gunter
Genentech

From stvjc at channing.harvard.edu  Mon Aug 30 20:12:19 2004
From: stvjc at channing.harvard.edu (Vincent Carey 525-2265)
Date: Mon Aug 30 20:12:22 2004
Subject: [Rd] can't build recent checkout of r-devel: tools invalid package
Message-ID: <Pine.GSO.4.58.0408301408380.11879@capecod.bwh.harvard.edu>

subsequent to a fresh svn checkout, configure, make:

make[5]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
make[4]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
Error in loadNamespace(package, lib.loc, keep.source, TRUE, TRUE) :
        'tools' is not a valid package -- installed < 2.0.0?
Execution halted
make[3]: *** [all] Error 1
make[3]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools'
make[2]: *** [R] Error 1
make[2]: Leaving directory `/udd/stvjc/JEDI/R200/src/library'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/udd/stvjc/JEDI/R200/src'
make: *** [R] Error 1
-bash-2.05b$ cat date-stamp
2004/08/30
-bash-2.05b$ cat VERSION
2.0.0 Under development (unstable)
-bash-2.05b$ uname -a
Linux xxxx 2.4.22-openmosix1smp #1 SMP Fri Sep 5 01:05:37 CEST 2003 i686 athlon i386 GNU/Linux

-bash-2.05b$ svn up
At revision 30943.

From jgentry at jimmy.harvard.edu  Mon Aug 30 20:36:32 2004
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Mon Aug 30 20:36:01 2004
Subject: [Rd] can't build recent checkout of r-devel: tools invalid package
In-Reply-To: <Pine.GSO.4.58.0408301408380.11879@capecod.bwh.harvard.edu>
Message-ID: <Pine.SOL.4.20.0408301436001.2167-100000@santiam.dfci.harvard.edu>

> make[5]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
> make[4]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
> Error in loadNamespace(package, lib.loc, keep.source, TRUE, TRUE) :
>         'tools' is not a valid package -- installed < 2.0.0?
> Execution halted

I'm getting the same error.  At first I thought it was that I was picking
up an older version of R in my path, but that's not the case.

-J

From ripley at stats.ox.ac.uk  Mon Aug 30 20:58:23 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Aug 30 20:58:37 2004
Subject: [Rd] can't build recent checkout of r-devel: tools invalid package
In-Reply-To: <Pine.SOL.4.20.0408301436001.2167-100000@santiam.dfci.harvard.edu>
Message-ID: <Pine.LNX.4.44.0408301953390.887-100000@gannet.stats>

On Mon, 30 Aug 2004, Jeff Gentry wrote:

> > make[5]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
> > make[4]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
> > Error in loadNamespace(package, lib.loc, keep.source, TRUE, TRUE) :
> >         'tools' is not a valid package -- installed < 2.0.0?
> > Execution halted
> 
> I'm getting the same error.  At first I thought it was that I was picking
> up an older version of R in my path, but that's not the case.

This is a transient problem caused by a bug fix, and has gone away 
again.

Please do remember that R-devel is `under development' and be a bit more
patient.  We do not guarantee that it will build from `make distclean' on
all OSes at all hours of every day (and explicitly say otherwise).

BDR

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Mon Aug 30 21:20:27 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Aug 30 21:25:48 2004
Subject: [Rd] can't build recent checkout of r-devel: tools invalid package
In-Reply-To: <Pine.LNX.4.44.0408301953390.887-100000@gannet.stats>
References: <Pine.LNX.4.44.0408301953390.887-100000@gannet.stats>
Message-ID: <x2sma4touc.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> On Mon, 30 Aug 2004, Jeff Gentry wrote:
> 
> > > make[5]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
> > > make[4]: Leaving directory `/udd/stvjc/JEDI/R200/src/library/tools/src'
> > > Error in loadNamespace(package, lib.loc, keep.source, TRUE, TRUE) :
> > >         'tools' is not a valid package -- installed < 2.0.0?
> > > Execution halted
> > 
> > I'm getting the same error.  At first I thought it was that I was picking
> > up an older version of R in my path, but that's not the case.
> 
> This is a transient problem caused by a bug fix, and has gone away 
> again.
> 
> Please do remember that R-devel is `under development' and be a bit more
> patient.  We do not guarantee that it will build from `make distclean' on
> all OSes at all hours of every day (and explicitly say otherwise).

This was actually quite an insidious error. Rebuilding in an existing
build directory showed no errors for me, only when I tried a
completely clean build did I reproduce the problem reported. Maybe
it's not too bad to have people a bit quick to complain...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From edd at debian.org  Tue Aug 31 04:38:58 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue Aug 31 04:39:00 2004
Subject: [Rd] Problem with R --gui=GNOME when launched from a menu system
Message-ID: <20040831023858.GA9751@sonny.eddelbuettel.com>


A Debian user filed a bug report the details of which are at
	http://bugs.debian.org/269107

I can replicate his problem: the R/Gnome entry that is made available to the
various window managers fails. A window pops, and exists.

As far as I can tell, the menuing system does not have a problem with shell
script wrapper. Environment variables like PATH, DISPLAY etc should be set
too.  So the best idea I am having now is that R _may_ think that
interactive() is FALSE when it should in fact be TRUE.

Does anybody have a) other ideas, and fixes, or b) an idea how I could
correct the menuing system?

Dirk

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From halunotes01/kyoritsu%KYORITSU at kyoritsugroup.co.jp  Tue Aug 31 09:50:40 2004
From: halunotes01/kyoritsu%KYORITSU at kyoritsugroup.co.jp (halunotes01/kyoritsu%KYORITSU@kyoritsugroup.co.jp)
Date: Tue Aug 31 09:47:27 2004
Subject: [Rd] Security Alert - InterScan for Lotus Notes
Message-ID: <OFFA6B6504.92809083-ON49256F01.002B1768@kyoritsugroup.co.jp>

????????????????????????????

Date:        8/31/2004 16:50:40
Subject:   Hey!
From:       r-devel@lists.r-project.org
To:            tom@kyoritsugroup.co.jp

Virus:        WORM_MYDOOM.H
File:           account.exe
Action:      Uncleanable quarantine
Event:       Virus Scan

From bhs2 at mevik.net  Tue Aug 31 09:49:20 2004
From: bhs2 at mevik.net (=?iso-8859-1?q?Bj=F8rn-Helge_Mevik?=)
Date: Tue Aug 31 09:49:27 2004
Subject: [Rd] Dimension of apply(X, MARGIN, FUN) when FUN returns a matrix
Message-ID: <m0r7pn3fy7.fsf@bar.nemo-project.org>

Dear all,

apply(X, MARGIN, FUN, ...) returns an array of dimension
c(n, dim(X)[MARGIN]) when FUN returns a vector of length n > 1.

Matrices and arrays are also vectors, so if FUN returns a matrix or an
array, apply returns an array of dimension c(n, dim(X)[MARGIN]) as
above.  This is in accordance with the description of apply in the
Blue Book, and also how Splus works (at least v6.0).

I am curious: why was it decided not to return an array of dimension
c(dim(result.of.FUN), dim(X)[MARGIN]) when FUN returns a matrix or an
array?

(This is not meant as criticism.  I am sure there is a good reason; I
just cannot see it.)

-- 
Bj?rn-Helge Mevik

From MSchwartz at MedAnalytics.com  Tue Aug 31 14:56:47 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue Aug 31 14:56:57 2004
Subject: [Rd] Problem with R --gui=GNOME when launched from a menu system
In-Reply-To: <20040831023858.GA9751@sonny.eddelbuettel.com>
References: <20040831023858.GA9751@sonny.eddelbuettel.com>
Message-ID: <1093957007.30615.39.camel@localhost.localdomain>

On Mon, 2004-08-30 at 21:38, Dirk Eddelbuettel wrote: 
> A Debian user filed a bug report the details of which are at
> 	http://bugs.debian.org/269107
> 
> I can replicate his problem: the R/Gnome entry that is made available to the
> various window managers fails. A window pops, and exists.
> 
> As far as I can tell, the menuing system does not have a problem with shell
> script wrapper. Environment variables like PATH, DISPLAY etc should be set
> too.  So the best idea I am having now is that R _may_ think that
> interactive() is FALSE when it should in fact be TRUE.
> 
> Does anybody have a) other ideas, and fixes, or b) an idea how I could
> correct the menuing system?
> 
> Dirk


Dirk,

FWIW, I can replicate this behavior using a CVS build of XFCE4 (V4.1.3),
which uses xfwm4 as the window manager and not metacity. This is on an
FC2 system which otherwise has GNOME 2.6.

I recompiled R 1.9.1 patched to use the GNOME GUI. If I run it from a
bash shell, it is fine. If I try to run it from the XFCE4 run dialog or
add it to the desktop menu, it pops up briefly and then closes.

If I specify that the R session should run in a terminal, it opens a
regular R terminal console, but no GNOME GUI.

I created a shell script file (test.sh) with the command. I use ROX for
my FM, which has the "run action" for scripts set to "sh ScriptFile". If
I click on the file, the R window pops up briefly and then clears. I can
however, run the script from a console using either "sh test.sh" or
"./test.sh" without problem.

So this behavior is not limited to GNOME/metacity and seems to be
environmental as you suggest.

Not sure if that helps, other than adding some confirmatory data points.

Best regards,

Marc

From ripley at stats.ox.ac.uk  Tue Aug 31 15:21:40 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 31 15:21:49 2004
Subject: [Rd] Problem with R --gui=GNOME when launched from a menu system
In-Reply-To: <20040831023858.GA9751@sonny.eddelbuettel.com>
Message-ID: <Pine.LNX.4.44.0408311413080.25501-100000@gannet.stats>

What are stdin/stdout/stderr connected to when you do that? R --gui=GNOME
does write certain error messages (from GDK/GTK) to the controlling
terminal so you may need one, at least if there is an error/warning.

I see gnome_start in src/modules/gnome/system.c has

    R_Interactive = isatty(0);

I would think that was blind copying.  Please see if setting it to 1 
helps.


On Mon, 30 Aug 2004, Dirk Eddelbuettel wrote:

> 
> A Debian user filed a bug report the details of which are at
> 	http://bugs.debian.org/269107
> 
> I can replicate his problem: the R/Gnome entry that is made available to the
> various window managers fails. A window pops, and exists.
> 
> As far as I can tell, the menuing system does not have a problem with shell
> script wrapper. Environment variables like PATH, DISPLAY etc should be set
> too.  So the best idea I am having now is that R _may_ think that
> interactive() is FALSE when it should in fact be TRUE.
> 
> Does anybody have a) other ideas, and fixes, or b) an idea how I could
> correct the menuing system?
> 
> Dirk
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From edd at debian.org  Tue Aug 31 15:55:10 2004
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue Aug 31 15:55:20 2004
Subject: [Rd] Problem with R --gui=GNOME when launched from a menu system
In-Reply-To: <Pine.LNX.4.44.0408311413080.25501-100000@gannet.stats>
References: <20040831023858.GA9751@sonny.eddelbuettel.com>
	<Pine.LNX.4.44.0408311413080.25501-100000@gannet.stats>
Message-ID: <20040831135509.GA16750@sonny.eddelbuettel.com>


Brian,

On Tue, Aug 31, 2004 at 02:21:40PM +0100, Prof Brian Ripley wrote:
> What are stdin/stdout/stderr connected to when you do that? R --gui=GNOME
> does write certain error messages (from GDK/GTK) to the controlling
> terminal so you may need one, at least if there is an error/warning.
> 
> I see gnome_start in src/modules/gnome/system.c has
> 
>     R_Interactive = isatty(0);
> 
> I would think that was blind copying.  Please see if setting it to 1 
> helps.

Excellent suggestion, I'll try that this eve.

Thanks as always,  Dirk

> 
> 
> On Mon, 30 Aug 2004, Dirk Eddelbuettel wrote:
> 
> > 
> > A Debian user filed a bug report the details of which are at
> > 	http://bugs.debian.org/269107
> > 
> > I can replicate his problem: the R/Gnome entry that is made available to the
> > various window managers fails. A window pops, and exists.
> > 
> > As far as I can tell, the menuing system does not have a problem with shell
> > script wrapper. Environment variables like PATH, DISPLAY etc should be set
> > too.  So the best idea I am having now is that R _may_ think that
> > interactive() is FALSE when it should in fact be TRUE.
> > 
> > Does anybody have a) other ideas, and fixes, or b) an idea how I could
> > correct the menuing system?
> > 
> > Dirk
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From rpeng at jhsph.edu  Tue Aug 31 16:11:51 2004
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Tue Aug 31 16:11:59 2004
Subject: [Rd] file.info() on file larger than 2GB
Message-ID: <41348727.8050009@jhsph.edu>

I've got a file that's approximately 2.2GB and it seems to be foiling 
file.info().  When I run `stat' from the shell I get

zooey:> stat data.csv
   File: `data.csv'
   Size: 2271197563      Blocks: 4440280    IO Block: 4096   regular file
Device: 342h/834d       Inode: 9994308     Links: 1
Access: (0644/-rw-r--r--)  Uid: (  500/   rpeng)   Gid: (  500/   rpeng)
Access: 2004-08-31 09:50:04.000000000 -0400
Modify: 2004-08-26 19:09:42.000000000 -0400
Change: 2004-08-31 09:53:29.000000000 -0400

But, file.info() in R-devel gives me:

 > file.info("data.csv")
          size isdir mode mtime ctime atime uid gid uname grname
data.csv   NA    NA <NA>  <NA>  <NA>  <NA>  NA  NA  <NA>   <NA>

I assume this has something to do with the underlying call to `stat' 
in `do_fileinfo'.

This alone is not much of a problem but I also can't seem to be able 
to open a file connection to the same file.  For example,

 > con <- file("data.csv")
 > open(con, "r")
Error in open.connection(con, "r") : unable to open connection
In addition: Warning message:
cannot open file `data.csv'

Also, interestingly,

 > file.exists("data.csv")
[1] FALSE

I take it all these things are related.

Is it possible to fix this within R?  Or should there be a note in the 
help pages?

 > version
          _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   Under development (unstable)
major    2
minor    0.0
year     2004
month    08
day      31
language R

-roger

From p.dalgaard at biostat.ku.dk  Tue Aug 31 16:40:57 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Aug 31 16:46:20 2004
Subject: [Rd] model.matrix.default chokes on backquote (PR#7202)
In-Reply-To: <20040830013521.DDAEC39AA@mprdmxin.myway.com>
References: <20040830013521.DDAEC39AA@mprdmxin.myway.com>
Message-ID: <x2vfez8j5y.fsf@biostat.ku.dk>

"Gabor Grothendieck" <ggrothendieck@myway.com> writes:

> Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:
> >
> > "Gabor Grothendieck" <ggrothendieck@myway.com> writes:
> > 
> > > > > as.character(attr(terms(`a(b)`~`c(d)`),"variables"))
> > > > [1] "list" "`a(b)`" "`c(d)`"
> > > >
> > > > whereas for instance
> > > >
> > > > > sapply(attr(terms(`a(b)`~`c(d)`),"variables")[-1],as.character)
> > > > [1] "a(b)" "c(d)"
> > >
> > > 1. That is quite subtle but a fix based on that would appear to
> > > solve it.
> > 
> > Hmm, not quite. I tried, and terms like offset(foo) gets me in
> > trouble. Probably, I was fixing the wrong end of the original problem:
> > In the comparisons, we can't have one side with backquotes and the
> > other without them. That doesn't have to mean that they should be
> > removed from both sides, and indeed it would get us in trouble if
> > someone was perverse enough to do things like
> > 
> > y ~ `offset(foo)` + offset(foo)
> > 
> > I.e. perhaps the real issue is that names(data) gets generated without
> > backquotes.
> > 
> > Anyways, this is a real can of worms and I'm not sure we're not too
> > close to 2.0.0 to start tampering with it...
> 
> How about a partial fix that does not address pathological 
> cases where the variable names themselves have embedded 
> backquotes but does address the common cases such as:
> 
> 	y <- ts(1:10); x1 <- y^2; x2 <- y^4
> 	lm(`lag(y)` ~ ., cbind(lag(y), x1, diff(x2)) )
> 
> without having to resort to:
> 
> 	lm(lag.y ~ ., cbind(lag.y = lag(y), x1, diff(x2)) )
> 

Hmm, I can get that example to run by using sapply(...,deparse)[-1] in
about three places, without breaking make check except that it choked
on one example in survival which needs width=500 added. 

Still doesn't solve the ~ `offset(foo)` + offset(foo) issue though,
and I'm  beginning to suspect that that would require a complete
redesign. Thing is that `offset(foo)` only makes sense if the column
is named "offset(foo)" with no ``, but model.frame and friends will
turn an offset(foo) term into a column with exactly the same name.  

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From tplate at blackmesacapital.com  Tue Aug 31 17:15:19 2004
From: tplate at blackmesacapital.com (Tony Plate)
Date: Tue Aug 31 17:15:38 2004
Subject: [Rd] Dimension of apply(X, MARGIN, FUN) when FUN returns a matrix
In-Reply-To: <m0r7pn3fy7.fsf@bar.nemo-project.org>
References: <m0r7pn3fy7.fsf@bar.nemo-project.org>
Message-ID: <6.1.0.6.2.20040831085459.06702da8@mailhost.blackmesacapital.com>

Bjorn, sorry I can't answer your question, but I had the same question some 
time ago and ended up creating a modified version of apply() that would do 
something like what you suggested.  It used the abind() function (from the 
abind package) to assemble the result.  For example, if dim(X)=c(7,6,5,4) 
and MARGIN=c(1,2) and dim(FUN.result)==c(3,2), it would return an array 
with dim==c(7,6,3,2).  The main tricky design issue was working out what it 
should do in cases with "holes" in MARGIN such as the following:

* length(dim(X))==5 and MARGIN=c(1,3,5) and length(dim(FUN.result))==2
* length(dim(X))==3 and MARGIN=c(1,3) and length(dim(FUN.result))==2
* length(dim(X))==5 and MARGIN=c(1,3,5) and length(dim(FUN.result))==1

I think the approach I took was to fill in the "holes" in MARGIN in order 
with the dimensions of the result, with extra ones going on at the end, but 
I can't really remember because I don't really ever use that feature.  I 
did this because that seemed to preserve the structure of X to the greatest 
degree possible.  This also results in calls like enhanced.apply(X, 1, c) 
and enhanced.apply(X, 2, c) both returning the original matrix, in contrast 
to behavior of apply().  However, if anyone has any ideas about what is the 
most principled and useful way to assemble results, I'd be interested to 
hear.  (FWIW, I called this function "bapply", for "array binding apply".)

Note that tapply() can also be given the same treatment (as could be 
sapply(), though with sapply() it is just as easy to call 
abind(lapply(...), ...) instead).

cheers,

Tony Plate

At Tuesday 01:49 AM 8/31/2004, you wrote:
>Dear all,
>
>apply(X, MARGIN, FUN, ...) returns an array of dimension
>c(n, dim(X)[MARGIN]) when FUN returns a vector of length n > 1.
>
>Matrices and arrays are also vectors, so if FUN returns a matrix or an
>array, apply returns an array of dimension c(n, dim(X)[MARGIN]) as
>above.  This is in accordance with the description of apply in the
>Blue Book, and also how Splus works (at least v6.0).
>
>I am curious: why was it decided not to return an array of dimension
>c(dim(result.of.FUN), dim(X)[MARGIN]) when FUN returns a matrix or an
>array?
>
>(This is not meant as criticism.  I am sure there is a good reason; I
>just cannot see it.)
>
>--
>Bj?rn-Helge Mevik
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Tue Aug 31 17:36:20 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Aug 31 17:36:27 2004
Subject: [Rd] file.info() on file larger than 2GB
In-Reply-To: <41348727.8050009@jhsph.edu>
Message-ID: <Pine.LNX.4.44.0408311601020.29264-100000@gannet.stats>

This is a purely OS issue: your OS has not been set up so the fopen and
stat calls handle > 2Gb files.  There is one R issue: the size will
overflow in file.info.

For example, under Solaris 64-bit applications can handle such files 
whereas 32-bit ones need calls to stat64, fopen64 etc.

It seems a very exotic need, but if someone wants to find out how to use 
the OS-specific ways to extend stat etc and supply patches, please do so.

We don't put OS-specific limitations on help pages.

On Tue, 31 Aug 2004, Roger D. Peng wrote:

> I've got a file that's approximately 2.2GB and it seems to be foiling 
> file.info().  When I run `stat' from the shell I get
> 
> zooey:> stat data.csv
>    File: `data.csv'
>    Size: 2271197563      Blocks: 4440280    IO Block: 4096   regular file
> Device: 342h/834d       Inode: 9994308     Links: 1
> Access: (0644/-rw-r--r--)  Uid: (  500/   rpeng)   Gid: (  500/   rpeng)
> Access: 2004-08-31 09:50:04.000000000 -0400
> Modify: 2004-08-26 19:09:42.000000000 -0400
> Change: 2004-08-31 09:53:29.000000000 -0400

Take a look at the source code for stat, in coreutils.

> But, file.info() in R-devel gives me:
> 
>  > file.info("data.csv")
>           size isdir mode mtime ctime atime uid gid uname grname
> data.csv   NA    NA <NA>  <NA>  <NA>  <NA>  NA  NA  <NA>   <NA>
> 
> I assume this has something to do with the underlying call to `stat' 
> in `do_fileinfo'.
> 
> This alone is not much of a problem but I also can't seem to be able 
> to open a file connection to the same file.  For example,
> 
>  > con <- file("data.csv")
>  > open(con, "r")
> Error in open.connection(con, "r") : unable to open connection
> In addition: Warning message:
> cannot open file `data.csv'
> 
> Also, interestingly,
> 
>  > file.exists("data.csv")
> [1] FALSE
> 
> I take it all these things are related.
> 
> Is it possible to fix this within R?  Or should there be a note in the 
> help pages?
> 
>  > version
>           _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status   Under development (unstable)
> major    2
> minor    0.0
> year     2004
> month    08
> day      31
> language R
> 
> -roger
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MSchwartz at MedAnalytics.com  Tue Aug 31 17:48:28 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue Aug 31 17:48:34 2004
Subject: [Rd] Problem with R --gui=GNOME when launched from a menu system
In-Reply-To: <20040831135509.GA16750@sonny.eddelbuettel.com>
References: <20040831023858.GA9751@sonny.eddelbuettel.com>
	<Pine.LNX.4.44.0408311413080.25501-100000@gannet.stats>
	<20040831135509.GA16750@sonny.eddelbuettel.com>
Message-ID: <1093967308.30615.115.camel@localhost.localdomain>

On Tue, 2004-08-31 at 08:55, Dirk Eddelbuettel wrote:
> Brian,
> 
> On Tue, Aug 31, 2004 at 02:21:40PM +0100, Prof Brian Ripley wrote:
> > What are stdin/stdout/stderr connected to when you do that? R --gui=GNOME
> > does write certain error messages (from GDK/GTK) to the controlling
> > terminal so you may need one, at least if there is an error/warning.
> > 
> > I see gnome_start in src/modules/gnome/system.c has
> > 
> >     R_Interactive = isatty(0);
> > 
> > I would think that was blind copying.  Please see if setting it to 1 
> > helps.
> 
> Excellent suggestion, I'll try that this eve.
> 
> Thanks as always,  Dirk


FWIW, no default change in behavior here under XFCE4 when using the run
dialog or in a desktop menu with the above source change.

However, if I run 'xfrun4' (which is the XFCE4 run app dialog) from a
console and then run the R GNOME/GUI command in the dialog, it now
works. So it would seem that a controlling console is required.

Supporting that notion, if I use the following command in a bash script:

gnome-terminal -e "R --gui=GNOME --no-save"

then the R GNOME/GUI runs properly when I click on the script in ROX.

The same thing if I use that script file in the desktop run application
dialog, either directly by name or use the actual command in the dialog
window.

I changed the source file above back to the original setting and this
does not impact the use of the above script. It still works.

The downside to the above is of course an open terminal window on the
desktop.

I tried some combinations of redirecting stdout/stderr, for example:

R --gui=GNOME --no-save 1>/dev/null 2>&1

or 

R --gui=GNOME --no-save 1>stdout.txt 2>stderr.txt


but this does not appear to be a solution. The window still clears.


HTH,

Marc

From ggrothendieck at myway.com  Tue Aug 31 18:55:47 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Tue Aug 31 18:55:57 2004
Subject: [Rd] Dimension of apply(X, MARGIN, FUN) when FUN returns a matrix
References: <m0r7pn3fy7.fsf@bar.nemo-project.org>
Message-ID: <loom.20040831T185217-924@post.gmane.org>

 <bhs2 <at> mevik.net> writes:

: 
: Dear all,
: 
: apply(X, MARGIN, FUN, ...) returns an array of dimension
: c(n, dim(X)[MARGIN]) when FUN returns a vector of length n > 1.
: 
: Matrices and arrays are also vectors, so if FUN returns a matrix or an
: array, apply returns an array of dimension c(n, dim(X)[MARGIN]) as
: above.  This is in accordance with the description of apply in the
: Blue Book, and also how Splus works (at least v6.0).
: 
: I am curious: why was it decided not to return an array of dimension
: c(dim(result.of.FUN), dim(X)[MARGIN]) when FUN returns a matrix or an
: array?
: 
: (This is not meant as criticism.  I am sure there is a good reason; I
: just cannot see it.)
: 


This does not answer your question but note that you can return the 
result as a list.  In the following apply is used to turn each column
of x into a 2x3 matrix returning the list of four such matrices:

R> x <- matrix(1:24,6)
R> apply(x, 2, function(x)list(matrix(x,2)))
[[1]]
[[1]][[1]]
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6


[[2]]
[[2]][[1]]
     [,1] [,2] [,3]
[1,]    7    9   11
[2,]    8   10   12


[[3]]
[[3]][[1]]
     [,1] [,2] [,3]
[1,]   13   15   17
[2,]   14   16   18


[[4]]
[[4]][[1]]
     [,1] [,2] [,3]
[1,]   19   21   23
[2,]   20   22   24

From gb at stat.umu.se  Tue Aug 31 23:33:48 2004
From: gb at stat.umu.se (gb)
Date: Tue Aug 31 23:34:32 2004
Subject: [Rd] make check failure
Message-ID: <20040831213348.GC3504@stat.umu.se>

I have built today's R-devel without problem on a fresh installation of
debian testing. However, 'make check' fails. In 
'tests/Examples/tools-Ex.Rout.fail':

> ### * vignetteDepends
>
> flush(stderr()); flush(stdout())
>
> ### Name: vignetteDepends
> ### Title: Retrieve Dependency Information for a Vignette
> ### Aliases: vignetteDepends
> ### Keywords: utilities
>
> ### ** Examples
>
> gridEx <- system.file("doc", "grid.Snw", package = "grid")
> vignetteDepends(gridEx)
Error in if ((!is.null(depMtrx)) && (nrow(depMtrx) > 0)) { :
        missing value where TRUE/FALSE needed
Execution halted
 -----------
Since my debian installation may be incomplete, I checked out R-1.9.1, but
there 'make check' ran without errors.

G?ran
-- 
 G?ran Brostr?m                    tel: +46 90 786 5223
 Department of Statistics          fax: +46 90 786 6614
 Ume? University                   http://www.stat.umu.se/egna/gb/
 SE-90187 Ume?, Sweden             e-mail: gb@stat.umu.se

