From mailmarshal at dealeremail.co.nz  Sat May  1 06:58:56 2004
From: mailmarshal at dealeremail.co.nz (mailmarshal@dealeremail.co.nz)
Date: Sat May  1 06:57:38 2004
Subject: [Rd] A Virus is in a message was sent by you.
Message-ID: <D000015020@nzanemail.nzan.co.nz>

MailMarshal has stopped the following message:


   From       : r-devel@r-project.org
   To         : sales@gisbornemotors.co.nz
   Subject    : i have received this.
   Message    : B000228947.00000001.mml
   Message ID : 
   Server IP  : 219.89.138.232
   Helo Name  : gisbornemotors.co.nz
   Date/Time  : 1/05/2004 - 16:58:56
   File       : B000228947.00000001.mml; ps.zip


The message contains a virus: W32/Netsky.c@MM!zip

Please clean the file and resend B000228947.00000001.mml; ps.zip
-------------- next part --------------
3136 16:58:50.681 Message From <r-devel@r-project.org>, Return-path <r-devel@r-project.org>, Recipients (1) -  <sales@gisbornemotors.co.nz> 
3136 16:58:50.681 Thread 2 Starting to unpack <B000228947.00000001.mml>
3136 16:58:50.711 Type=MAIL,  size=35801,  Name=B000228947.00000001.mml
3136 16:58:50.711   Type=MHDR,  size=444,  Name=MsgHeader.txt
3136 16:58:50.711   Type=MBODY,  size=13,  Name=Plain.txt
3136 16:58:50.711   Type=ZIP,  size=25471,  Name=ps.zip
3136 16:58:50.711     Type=EXEW32,  size=25353,  Name=ps.doc.com
3136 16:58:50.711 0 user(s) match ruleset - AAC Messages
3136 16:58:50.711 0 user(s) match ruleset - Waikato Motor Group
3136 16:58:50.711 0 user(s) match ruleset - Sydenham Motor Group
3136 16:58:50.711 1 user(s) match ruleset - Inbound Messages
3136 16:58:50.711   1 user(s) match rule - Archive Message
3136 16:58:50.711     Name=U1\B000228947.00000001.mml (MAIL,35801) TRUE
3136 16:58:50.711     Requesting Action <Inbound Messages:Archive Message:CopyMessage> be run
3136 16:58:50.711   1 user(s) match rule - Block VIDEO Files
3136 16:58:50.711     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:50.711       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:50.711       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:50.711       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:50.711         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:50.711   1 user(s) match rule - Spam Filter
3136 16:58:50.721     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:50.721       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:50.721       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:50.721       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:50.721         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:50.721   0 user(s) match rule - Block Junk Mailers
3136 16:58:50.721   1 user(s) match rule - Suspected Virus
3136 16:58:50.721     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:50.721       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:50.721       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:50.721       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:50.721         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:50.721   1 user(s) match rule - Multimedia Inbound
3136 16:58:50.721     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:50.721       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:50.721       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:50.721       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:50.721         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:50.721   1 user(s) match rule - Porn Spam
3136 16:58:50.731     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:50.731       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:50.731       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:50.731       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:50.741         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:50.741   1 user(s) match rule - Spam Filter - One
3136 16:58:50.751     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:50.751   1 user(s) match rule - Spam Filter - Two
3136 16:58:56.420     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:56.420   0 user(s) match rule - Team Hutch Language
3136 16:58:56.420   1 user(s) match rule - Block Chain Letters
3136 16:58:56.420     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:56.420       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:56.420       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:56.420       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:56.420         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:56.420   1 user(s) match rule - Block Known Worms
3136 16:58:56.420     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:56.420       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:56.420       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:56.420       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:56.420         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:56.420   1 user(s) match rule - Block Virus Hoax Messages
3136 16:58:56.420     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:56.420       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:56.420       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:56.420       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:56.430         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:56.430   1 user(s) match rule - Block VBScript
3136 16:58:56.430     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:56.430       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:56.430       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:56.430       Name=U2\ps.zip (ZIP,25471) False
3136 16:58:56.430         Name=U3\ps.doc.com (EXEW32,25353) False
3136 16:58:56.430   1 user(s) match rule - Block Virus
3136 16:58:56.450 virus scanner OK <NetIQ Integrated McAfee AntiVirus> file <B000228947.00000001.mml> after 20 millisecs
3136 16:58:56.460 virus scanner OK <NetIQ Integrated McAfee AntiVirus> file <MsgHeader.txt> after 10 millisecs
3136 16:58:56.460 virus scanner OK <NetIQ Integrated McAfee AntiVirus> file <Plain.txt> after 0 millisecs
3136 16:58:56.460 virus scanner FOUND virus <NetIQ Integrated McAfee AntiVirus> name <W32/Netsky.c@MM!zip> file <ps.zip> after 0 millisecs
3136 16:58:56.490 virus scanner OK <NetIQ Integrated McAfee AntiVirus> file <B000228947.00000001.mml> after 30 millisecs
3136 16:58:56.490     Name=U1\B000228947.00000001.mml (MAIL,35801) False
3136 16:58:56.490 virus scanner OK <NetIQ Integrated McAfee AntiVirus> file <MsgHeader.txt> after 0 millisecs
3136 16:58:56.490       Name=U2\MsgHeader.txt (MHDR,444) False
3136 16:58:56.500 virus scanner OK <NetIQ Integrated McAfee AntiVirus> file <Plain.txt> after 10 millisecs
3136 16:58:56.500       Name=U2\Plain.txt (MBODY,13) False
3136 16:58:56.500 virus scanner FOUND virus <NetIQ Integrated McAfee AntiVirus> name <W32/Netsky.c@MM!zip> file <ps.zip> after 0 millisecs
3136 16:58:56.500       Name=U2\ps.zip (ZIP,25471) TRUE Terminal
3136 16:58:56.500       Requesting Action <Inbound Messages:Block Virus:MailTemplate> be run
From anthony at stat.sdu.dk  Sat May  1 17:00:28 2004
From: anthony at stat.sdu.dk (anthony@stat.sdu.dk)
Date: Sat May  1 17:00:32 2004
Subject: [Rd] Generating Lognormal Random variables (PR#6843)
Message-ID: <20040501150028.26C00EC44@slim.kubism.ku.dk>

Full_Name: Anthony Gichangi
Version: 1.90
OS: Windows XP Pro
Submission from: (NULL) (130.225.131.206)


The function rlnorm generates negative values for lognormal distribution. 

x- rlnorm(1000, meanlog =  0.6931472, sdlog = 1)

Regards

Anthony

From p.dalgaard at biostat.ku.dk  Sat May  1 17:02:55 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat May  1 17:07:06 2004
Subject: [Rd] Generating Lognormal Random variables (PR#6843)
In-Reply-To: <20040501150028.26C00EC44@slim.kubism.ku.dk>
References: <20040501150028.26C00EC44@slim.kubism.ku.dk>
Message-ID: <x28ygcjilc.fsf@biostat.ku.dk>

anthony@stat.sdu.dk writes:

> Full_Name: Anthony Gichangi
> Version: 1.90
> OS: Windows XP Pro
> Submission from: (NULL) (130.225.131.206)
> 
> 
> The function rlnorm generates negative values for lognormal distribution. 
> 
> x- rlnorm(1000, meanlog =  0.6931472, sdlog = 1)

Eh?

> all(rlnorm(1000000, meanlog =  0.6931472, sdlog = 1) >= 0)
[1] TRUE

Try reproducing with a fixed random seed so that others have a chance
to check.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From dmurdoch at pair.com  Sat May  1 17:08:48 2004
From: dmurdoch at pair.com (dmurdoch@pair.com)
Date: Sat May  1 17:08:50 2004
Subject: [Rd] Generating Lognormal Random variables (PR#6843)
Message-ID: <20040501150848.E1F83ED00@slim.kubism.ku.dk>

On Sat,  1 May 2004 17:00:28 +0200 (CEST), anthony@stat.sdu.dk wrote:

>Full_Name: Anthony Gichangi
>Version: 1.90
>OS: Windows XP Pro
>Submission from: (NULL) (130.225.131.206)
>
>
>The function rlnorm generates negative values for lognormal distribution. 
>
>x- rlnorm(1000, meanlog =  0.6931472, sdlog = 1)

It doesn't for me, and the line you typed above makes it look like
you're subtracting lognormals from x.

Could you post a reproducible example?  For random number generators,
you can make them reproducible by using set.seed, e.g.

> set.seed(1)
> range(rlnorm(1000, meanlog =  0.6931472, sdlog = 1))
[1]  0.09877592 90.32586746

Duncan Murdoch

From Dan.Kelley at Dal.Ca  Sat May  1 17:29:35 2004
From: Dan.Kelley at Dal.Ca (Dan.Kelley@Dal.Ca)
Date: Sat May  1 17:29:37 2004
Subject: [Rd] will not compile on Fedora Core 2 Test 2 (PR#6844)
Message-ID: <20040501152935.2B564ED92@slim.kubism.ku.dk>

Full_Name: Dan Kelley
Version: 1.9.0
OS: Fedora Core 2 Test 2
Submission from: (NULL) (142.177.39.160)


Pasted below is part of the output from    ./configure && make     on Fedora
Core 2 Test 2.  I am not sure what else to try, but if there are tests that
might help, I'd be very happy to do them.  (Note: this OS is pretty fresh, just
having been released a few days ago.  This is the first x11-employing
application I've built on the machine.)

make[4]: Entering directory `/home/kelley/src/R-1.9.0/src/modules/X11'
gcc -I. -I../../../src/include -I../../../src/include -I/usr/X11R6/include
-I/usr/local/include -DHAVE_CONFIG_H -D__NO_MATH_INLINES -mieee-fp -fPIC  -g -O2
-c dataentry.c -o dataentry.lo
In file included from dataentry.c:31:
/usr/X11R6/include/X11/Xlib.h:1400: error: syntax error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1488: error: syntax error before "char"
/

From ripley at stats.ox.ac.uk  Sat May  1 18:10:41 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May  1 18:10:47 2004
Subject: [Rd] will not compile on Fedora Core 2 Test 2 (PR#6844)
In-Reply-To: <20040501152935.2B564ED92@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405011707550.9788-100000@gannet.stats>

Please try the r-patched version of R.  This is a serious bug in the
XFree86 4.4.x headers, that we have worked around by adding the lines 
shown

/* don't use X11 function prototypes (which tend to ...): */
#define NeedFunctionPrototypes 0
/* XFree 4.4.0 forgets to define this if NeedFunctionPrototypes=0 */
#ifndef _Xconst
#define _Xconst const
#endif

to dataentry.c.  This works for me on a XFree86 4.4.0 system, and for a 
few others, but we would appreciate confirmation.

On Sat, 1 May 2004 Dan.Kelley@Dal.Ca wrote:

> Full_Name: Dan Kelley
> Version: 1.9.0
> OS: Fedora Core 2 Test 2
> Submission from: (NULL) (142.177.39.160)
> 
> 
> Pasted below is part of the output from    ./configure && make     on Fedora
> Core 2 Test 2.  I am not sure what else to try, but if there are tests that
> might help, I'd be very happy to do them.  (Note: this OS is pretty fresh, just
> having been released a few days ago.  This is the first x11-employing
> application I've built on the machine.)
> 
> make[4]: Entering directory `/home/kelley/src/R-1.9.0/src/modules/X11'
> gcc -I. -I../../../src/include -I../../../src/include -I/usr/X11R6/include
> -I/usr/local/include -DHAVE_CONFIG_H -D__NO_MATH_INLINES -mieee-fp -fPIC  -g -O2
> -c dataentry.c -o dataentry.lo
> In file included from dataentry.c:31:
> /usr/X11R6/include/X11/Xlib.h:1400: error: syntax error before "_Xconst"
> /usr/X11R6/include/X11/Xlib.h:1488: error: syntax error before "char"
> /

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tlumley at u.washington.edu  Sat May  1 18:43:14 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Sat May  1 18:43:27 2004
Subject: [Rd] Generating Lognormal Random variables (PR#6843)
In-Reply-To: <20040501150848.E1F83ED00@slim.kubism.ku.dk>
References: <20040501150848.E1F83ED00@slim.kubism.ku.dk>
Message-ID: <Pine.A41.4.58.0405010942060.183348@homer07.u.washington.edu>

On Sat, 1 May 2004 dmurdoch@pair.com wrote:

> On Sat,  1 May 2004 17:00:28 +0200 (CEST), anthony@stat.sdu.dk wrote:
>
> >Full_Name: Anthony Gichangi
> >Version: 1.90
> >OS: Windows XP Pro
> >Submission from: (NULL) (130.225.131.206)
> >
> >
> >The function rlnorm generates negative values for lognormal distribution.
> >
> >x- rlnorm(1000, meanlog =  0.6931472, sdlog = 1)
>
> It doesn't for me, and the line you typed above makes it look like
> you're subtracting lognormals from x.
>

It would be very strange if it were producing negative numbers, as it does
it by exponentiating normals.

	-thomas

From Dan.Kelley at phys.ocean.dal.ca  Sat May  1 14:32:43 2004
From: Dan.Kelley at phys.ocean.dal.ca (Dan.Kelley@phys.ocean.dal.ca)
Date: Sat May  1 19:00:54 2004
Subject: [Rd] will not compile on Fedora Core 2 Test 2 (PR#6844)
In-Reply-To: <Pine.LNX.4.44.0405011707550.9788-100000@gannet.stats>
References: <20040501152935.2B564ED92@slim.kubism.ku.dk>
	<Pine.LNX.4.44.0405011707550.9788-100000@gannet.stats>
Message-ID: <1755.142.177.39.160.1083414763.squirrel@www.phys.ocean.dal.ca>

> Please try the r-patched version of R.  This is a serious bug in the
> XFree86 4.4.x headers, that we have worked around by adding the lines
> shown

Thanks very much, Brian, especially for answering on a Saturday.

I wasn't sure what "r-patched" meant, and the developer page won't load
for me (using the link from the main R page), so I just altered the code
as suggested (patch shown below for verification) and it is now compiling
happily away, having jumped over this dataentry.c roadblock smoothly.

This makes me happy because I told some students the other day that they
should try Fedora Core 2, and that they should use R on it.

Dan.  (below shows the change I made, in accordance with your suggestion)

[kelley@localhost X11]$ diff -Naur dataentry.c dataentry.c~
--- dataentry.c 2004-05-01 13:50:58.504206988 -0300
+++ dataentry.c~        2004-03-27 09:46:11.000000000 -0400
@@ -27,10 +27,6 @@

 /* don't use X11 function prototypes (which tend to ...): */
 #define NeedFunctionPrototypes 0
-/* XFree 4.4.0 forgets to define this if NeedFunctionPrototypes=0 */
-#ifndef _Xconst
-#define _Xconst const
-#endif
 #include <X11/X.h>
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>

From ripley at stats.ox.ac.uk  Sat May  1 19:08:47 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May  1 19:16:22 2004
Subject: [Rd] will not compile on Fedora Core 2 Test 2 (PR#6844)
In-Reply-To: <1755.142.177.39.160.1083414763.squirrel@www.phys.ocean.dal.ca>
Message-ID: <Pine.LNX.4.44.0405011807200.10112-100000@gannet.stats>

On Sat, 1 May 2004 Dan.Kelley@phys.ocean.dal.ca wrote:

> > Please try the r-patched version of R.  This is a serious bug in the
> > XFree86 4.4.x headers, that we have worked around by adding the lines
> > shown
> 
> Thanks very much, Brian, especially for answering on a Saturday.
> 
> I wasn't sure what "r-patched" meant, and the developer page won't load

See the R FAQ: it's the patched release at

ftp://ftp.stat.math.ethz.ch/Software/R/


> for me (using the link from the main R page), so I just altered the code
> as suggested (patch shown below for verification) and it is now compiling
> happily away, having jumped over this dataentry.c roadblock smoothly.
> 
> This makes me happy because I told some students the other day that they
> should try Fedora Core 2, and that they should use R on it.
> 
> Dan.  (below shows the change I made, in accordance with your suggestion)
> 
> [kelley@localhost X11]$ diff -Naur dataentry.c dataentry.c~
> --- dataentry.c 2004-05-01 13:50:58.504206988 -0300
> +++ dataentry.c~        2004-03-27 09:46:11.000000000 -0400
> @@ -27,10 +27,6 @@
> 
>  /* don't use X11 function prototypes (which tend to ...): */
>  #define NeedFunctionPrototypes 0
> -/* XFree 4.4.0 forgets to define this if NeedFunctionPrototypes=0 */
> -#ifndef _Xconst
> -#define _Xconst const
> -#endif
>  #include <X11/X.h>
>  #include <X11/Xlib.h>
>  #include <X11/Xutil.h>
> 
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From verein at wasserschildkroete.de  Sun May  2 17:00:22 2004
From: verein at wasserschildkroete.de (verein@wasserschildkroete.de)
Date: Sun May  2 17:00:24 2004
Subject: [Rd] E-Mail an wasserschildkroete.de
In-Reply-To: <E1BKIS5-0006UQ-00@mxng20.kundenserver.de>
Message-ID: <E1BKIS6-0006V2-00@mxng20.kundenserver.de>

Guten Tag,
wir haben Ihre Mail erhalten. Wir antworten schnellst m?glich. Im Notfall k?nnen Sie uns auch anrufen unter:
Verein - 0231 420335
Handy - 01777 420335
Web - http://www.wasserschildkroete.de
mit freundlichen Gr??en
Der Tierschutzverein 
wasserschildkroete.de e.V.

From kjetil at acelerate.com  Sun May  2 22:40:14 2004
From: kjetil at acelerate.com (kjetil@acelerate.com)
Date: Sun May  2 22:40:59 2004
Subject: [Rd] arima problems when using argument fixed=
Message-ID: <4095246E.13614.13386CE@localhost>

As I am reading ?arima, only NA entries in the argument fixed= 
imports. The following seems to indicate otherwise:



 x <- arima.sim(model=list(ar=0.8), n=100) + (1:100)/50
> t <- 1:100
> mod1 <- lm(x ~ t)
> 
> init1  <- c(0, coef(mod1)[2])
> fixed1 <- c(as.numeric(NA), 0)
> 
> arima(x, order=c(1,0,0), xreg=t, include.mean=FALSE, init=init1, 
fixed=fixed1)

Call:
arima(x = x, order = c(1, 0, 0), xreg = t, include.mean = FALSE, 
fixed = fixed1, 
    init = init1)

Coefficients:
         ar1  t
      0.9281  0
s.e.  0.0357  0

sigma^2 estimated as 0.9186:  log likelihood = -138.64,  aic = 281.28
> 
> init2 <- init1
> init2[2] <- 0
> 
> fixed2 <- init1
> fixed2[1] <- as.numeric(NA)
> 
> arima(x, order=c(1,0,0), xreg=t, include.mean=FALSE, init=init2, 
fixed=fixed2)

Call:
arima(x = x, order = c(1, 0, 0), xreg = t, include.mean = FALSE, 
fixed = fixed2, 
    init = init2)

Coefficients:
         ar1       t
      0.7888  0.0377
s.e.  0.0593  0.0000

sigma^2 estimated as 0.8452:  log likelihood = -133.97,  aic = 271.94
> 

> fixed1
[1] NA  0
> fixed2
                    t 
        NA 0.03767406 

> arima(x, order=c(1,0,0), xreg=t, include.mean=FALSE, init=init2, 
fixed=fixed1)

Call:
arima(x = x, order = c(1, 0, 0), xreg = t, include.mean = FALSE, 
fixed = fixed1, 
    init = init2)

Coefficients:
         ar1  t
      0.9281  0
s.e.  0.0357  0

sigma^2 estimated as 0.9186:  log likelihood = -138.64,  aic = 281.28


Kjetil Halvorsen

From rdiaz at cnio.es  Mon May  3 13:06:15 2004
From: rdiaz at cnio.es (rdiaz@cnio.es)
Date: Mon May  3 13:06:17 2004
Subject: [Rd] boxplot.formula with missing values (PR#6846)
Message-ID: <20040503110615.AA07C104D4@slim.kubism.ku.dk>

If an array has missing values in different rows, plotting using the formul=
a=20
interface can produce errors. Example:


fake.data <- matrix(rep(-100:100, 4),
                    ncol =3D 4)

par(mfrow =3D c(1,2))
boxplot(fake.data ~ col(fake.data))
abline(h =3D 0, lty =3D 2)
boxplot(as.data.frame(fake.data))
abline(h =3D 0, lty =3D 2)

##### Add the missing data
fake.data[190:200, 1] <- NA
fake.data[1:5, 3] <- NA

## Bot only columns 1 and 3 should change!! (and in opposite directions)
par(mfrow =3D c(1, 2))
boxplot(fake.data ~ col(fake.data))
abline(h =3D 0, lty =3D 2)
boxplot(as.data.frame(fake.data))
abline(h =3D 0, lty =3D 2)

### The problem is that the same rows are removed from all the columns:

bp.a <- boxplot(fake.data ~ col(fake.data))
bp.df<- boxplot(as.data.frame(fake.data))

### which happens during the call to

eval(m, parent.frame())

inside boxplot.formula

**********************************

This happens in at least:

         _               =20
platform i686-pc-linux-gnu
arch     i686            =20
os       linux-gnu       =20
system   i686, linux-gnu =20
status   Patched         =20
major    1               =20
minor    9.0             =20
year     2004            =20
month    05              =20
day      02              =20
language R   =20

         _               =20
platform i386-pc-linux-gnu

arch     i386            =20
os       linux-gnu       =20
system   i386, linux-gnu =20
status                   =20
major    1               =20
minor    8.1             =20
year     2003            =20
month    11              =20
day      21              =20
language R          =20

         _                          =20
platform i686-pc-linux-gnu          =20
arch     i686                       =20
os       linux-gnu                  =20
system   i686, linux-gnu            =20
status   Under development (unstable)
major    2                          =20
minor    0.0                        =20
year     2004                       =20
month    04                         =20
day      30                         =20
language R         =20





=2D-=20
Ram=F3n D=EDaz-Uriarte
Bioinformatics Unit
Centro Nacional de Investigaciones Oncol=F3gicas (CNIO)
(Spanish National Cancer Center)
Melchor Fern=E1ndez Almagro, 3
28029 Madrid (Spain)
=46ax: +-34-91-224-6972
Phone: +-34-91-224-6900

http://bioinfo.cnio.es/~rdiaz
PGP KeyID: 0xE89B3462
(http://bioinfo.cnio.es/~rdiaz/0xE89B3462.asc)

From ripley at stats.ox.ac.uk  Mon May  3 13:33:53 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May  3 13:34:05 2004
Subject: [Rd] boxplot.formula with missing values (PR#6846)
In-Reply-To: <20040503110615.AA07C104D4@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405031217130.26034-100000@gannet.stats>

I think this *is* the correct behaviour for a formula method. The problem
I see is that boxplot.formula does not have an na.action argument and so
you may not have realised that na.action=na.omit is the default.

Note that subset= will `remove the same rows from all columns', too.

It really is not the intention that the formula interface is used with 
matrices, and as.vector will do what I think you intended:

	boxplot(as.vector(fake.data) ~ as.vector(col(fake.data)))

Also, setting options(na.action=na.pass) will work as you expected.

I've added an na.action argument for R-devel.


On Mon, 3 May 2004 rdiaz@cnio.es wrote:

> If an array has missing values in different rows, plotting using the formul=
> a=20
> interface can produce errors. Example:

Well, not do what you expected, but the error appears to be in your 
expectations.

> fake.data <- matrix(rep(-100:100, 4),
>                     ncol =3D 4)
> 
> par(mfrow =3D c(1,2))
> boxplot(fake.data ~ col(fake.data))
> abline(h =3D 0, lty =3D 2)
> boxplot(as.data.frame(fake.data))
> abline(h =3D 0, lty =3D 2)
> 
> ##### Add the missing data
> fake.data[190:200, 1] <- NA
> fake.data[1:5, 3] <- NA
> 
> ## Bot only columns 1 and 3 should change!! (and in opposite directions)
> par(mfrow =3D c(1, 2))
> boxplot(fake.data ~ col(fake.data))
> abline(h =3D 0, lty =3D 2)
> boxplot(as.data.frame(fake.data))
> abline(h =3D 0, lty =3D 2)
> 
> ### The problem is that the same rows are removed from all the columns:
> 
> bp.a <- boxplot(fake.data ~ col(fake.data))
> bp.df<- boxplot(as.data.frame(fake.data))
> 
> ### which happens during the call to
> 
> eval(m, parent.frame())
> 
> inside boxplot.formula
> 
> **********************************
> 
> This happens in at least:
> 
>          _               =20
> platform i686-pc-linux-gnu
> arch     i686            =20
> os       linux-gnu       =20
> system   i686, linux-gnu =20
> status   Patched         =20
> major    1               =20
> minor    9.0             =20
> year     2004            =20
> month    05              =20
> day      02              =20
> language R   =20
> 
>          _               =20
> platform i386-pc-linux-gnu
> 
> arch     i386            =20
> os       linux-gnu       =20
> system   i386, linux-gnu =20
> status                   =20
> major    1               =20
> minor    8.1             =20
> year     2003            =20
> month    11              =20
> day      21              =20
> language R          =20
> 
>          _                          =20
> platform i686-pc-linux-gnu          =20
> arch     i686                       =20
> os       linux-gnu                  =20
> system   i686, linux-gnu            =20
> status   Under development (unstable)
> major    2                          =20
> minor    0.0                        =20
> year     2004                       =20
> month    04                         =20
> day      30                         =20
> language R         =20
> 
> 
> 
> 
> 
> =2D-=20
> Ram=F3n D=EDaz-Uriarte
> Bioinformatics Unit
> Centro Nacional de Investigaciones Oncol=F3gicas (CNIO)
> (Spanish National Cancer Center)
> Melchor Fern=E1ndez Almagro, 3
> 28029 Madrid (Spain)
> =46ax: +-34-91-224-6972
> Phone: +-34-91-224-6900
> 
> http://bioinfo.cnio.es/~rdiaz
> PGP KeyID: 0xE89B3462
> (http://bioinfo.cnio.es/~rdiaz/0xE89B3462.asc)
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dmurdoch at pair.com  Mon May  3 14:17:06 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon May  3 14:17:11 2004
Subject: [Rd] Finalization and external pointers
Message-ID: <l1dc90h92tr31qqj3h08c9jee7d9nff9jo@4ax.com>

I'm adding things to the Windows RGui so that there's more control of
the interface from within R.

One thing I'm considering is giving access to the Graphapp window
objects using external pointers.  This raises the issue of
finalization on both sides:

 - If someone creates a pointer referring to a window, then that
pointer should be changed to NULL when the window is closed.

 - If garbage collection destroys a pointer referring to a window,
then the window should know not to change that pointer to NULL later.

Are there other examples like this I can look at?  I'd like to follow
existing conventions rather than invent my own.

And a related question:  is there a writeup anywhere on the
R_RegisterFinalizerEx function?  What does the onexit argument do?

Duncan Murdoch

From Dan.Kelley at Dal.Ca  Mon May  3 14:29:22 2004
From: Dan.Kelley at Dal.Ca (Dan.Kelley@Dal.Ca)
Date: Mon May  3 14:29:24 2004
Subject: [Rd] R-1.9.0 won't compile on OSX (PR#6848)
Message-ID: <20040503122922.9AA8C10432@slim.kubism.ku.dk>

Full_Name: Dan Kelley
Version: 1.9.0
OS: OSX (Darwin 7.3.0)
Submission from: (NULL) (129.173.23.36)


R-1.9.0 will not compile on Apple OSX (Darwin kernel 7.3.0).  The error msg
starts as follows, and has several more errors.

gcc -dynamiclib -L/sw/lib -L/usr/local/lib -install_name
/Library/Frameworks/R.f
ramework/Versions/1.9.0/Resources/bin/libRlapack.dylib -o libRlapack.dylib
dlapa
ck0.lo dlapack1.lo dlapack2.lo dlapack3.lo cmplx.lo  -lf77blas -latlas
-L/sw/lib
 -L/usr/local/lib -L/sw/lib/gcc/powerpc-apple-darwin7.2.0/3.4
-L/sw/lib/gcc/powe
rpc-apple-darwin7.2.0/3.4/../../.. -lfrtbegin -lg2c -lSystem
ld: common symbols not allowed with MH_DYLIB output format with the
-multi_modul
e option
/sw/lib/libg2c.a(err.o) definition of common _f__cblank (size 4)
/sw/lib/libg2c.a(fmt.o) definition of common _f__cnt (size 40)

From ripley at stats.ox.ac.uk  Mon May  3 14:52:24 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May  3 14:52:30 2004
Subject: [Rd] R-1.9.0 won't compile on OSX (PR#6848)
In-Reply-To: <20040503122922.9AA8C10432@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405031339490.26348-100000@gannet.stats>

I don't think this is a bug in *R*, especially as you appear to be using 
the unreleased gcc 3.4!

Hint: there needs to be a dynamic library for libg2c, not a static one. If
there is not, that's a g77 on MacOS X problem, which at one time (gcc 3.1)
we had to overcome by using vecLib.

See the R-admin manual which says

  ./configure --with-blas='-framework vecLib' --with-lapack --with-aqua 

  The first two options are strongly recommended. 

Did you actually follow that advice?  You appear to be trying to use 
atlas, and there is advice about needing a PIC version for that to work.


On Mon, 3 May 2004 Dan.Kelley@Dal.Ca wrote:

> Full_Name: Dan Kelley
> Version: 1.9.0
> OS: OSX (Darwin 7.3.0)
> Submission from: (NULL) (129.173.23.36)
> 
> 
> R-1.9.0 will not compile on Apple OSX (Darwin kernel 7.3.0).  The error msg
> starts as follows, and has several more errors.
> 
> gcc -dynamiclib -L/sw/lib -L/usr/local/lib -install_name
> /Library/Frameworks/R.f
> ramework/Versions/1.9.0/Resources/bin/libRlapack.dylib -o libRlapack.dylib
> dlapa
> ck0.lo dlapack1.lo dlapack2.lo dlapack3.lo cmplx.lo  -lf77blas -latlas
> -L/sw/lib
>  -L/usr/local/lib -L/sw/lib/gcc/powerpc-apple-darwin7.2.0/3.4
> -L/sw/lib/gcc/powe
> rpc-apple-darwin7.2.0/3.4/../../.. -lfrtbegin -lg2c -lSystem
> ld: common symbols not allowed with MH_DYLIB output format with the
> -multi_modul
> e option
> /sw/lib/libg2c.a(err.o) definition of common _f__cblank (size 4)
> /sw/lib/libg2c.a(fmt.o) definition of common _f__cnt (size 40)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rdiaz at cnio.es  Mon May  3 15:03:30 2004
From: rdiaz at cnio.es (Ramon Diaz-Uriarte)
Date: Mon May  3 15:08:53 2004
Subject: [Rd] boxplot.formula with missing values (PR#6846)
In-Reply-To: <Pine.LNX.4.44.0405031217130.26034-100000@gannet.stats>
References: <Pine.LNX.4.44.0405031217130.26034-100000@gannet.stats>
Message-ID: <200405031503.30041.rdiaz@cnio.es>

Thanks for your comments. I understand this is probably the correct behavior 
for a formula method, but I also think that it is not what many people 
expect, and the note about NA behavior did not seem to help me. Thus, I 
appreciate your adding the na.action.

Thanks,

R.


On Monday 03 May 2004 13:33, Prof Brian Ripley wrote:
> I think this *is* the correct behaviour for a formula method. The problem
> I see is that boxplot.formula does not have an na.action argument and so
> you may not have realised that na.action=na.omit is the default.
>
> Note that subset= will `remove the same rows from all columns', too.
>
> It really is not the intention that the formula interface is used with
> matrices, and as.vector will do what I think you intended:
>
> 	boxplot(as.vector(fake.data) ~ as.vector(col(fake.data)))
>
> Also, setting options(na.action=na.pass) will work as you expected.
>
> I've added an na.action argument for R-devel.
>
> On Mon, 3 May 2004 rdiaz@cnio.es wrote:
> > If an array has missing values in different rows, plotting using the
> > formul= a=20
> > interface can produce errors. Example:
>
> Well, not do what you expected, but the error appears to be in your
> expectations.
>
> > fake.data <- matrix(rep(-100:100, 4),
> >                     ncol =3D 4)
> >
> > par(mfrow =3D c(1,2))
> > boxplot(fake.data ~ col(fake.data))
> > abline(h =3D 0, lty =3D 2)
> > boxplot(as.data.frame(fake.data))
> > abline(h =3D 0, lty =3D 2)
> >
> > ##### Add the missing data
> > fake.data[190:200, 1] <- NA
> > fake.data[1:5, 3] <- NA
> >
> > ## Bot only columns 1 and 3 should change!! (and in opposite directions)
> > par(mfrow =3D c(1, 2))
> > boxplot(fake.data ~ col(fake.data))
> > abline(h =3D 0, lty =3D 2)
> > boxplot(as.data.frame(fake.data))
> > abline(h =3D 0, lty =3D 2)
> >
> > ### The problem is that the same rows are removed from all the columns:
> >
> > bp.a <- boxplot(fake.data ~ col(fake.data))
> > bp.df<- boxplot(as.data.frame(fake.data))
> >
> > ### which happens during the call to
> >
> > eval(m, parent.frame())
> >
> > inside boxplot.formula
> >
> > **********************************
> >
> > This happens in at least:
> >
> >          _               =20
> > platform i686-pc-linux-gnu
> > arch     i686            =20
> > os       linux-gnu       =20
> > system   i686, linux-gnu =20
> > status   Patched         =20
> > major    1               =20
> > minor    9.0             =20
> > year     2004            =20
> > month    05              =20
> > day      02              =20
> > language R   =20
> >
> >          _               =20
> > platform i386-pc-linux-gnu
> >
> > arch     i386            =20
> > os       linux-gnu       =20
> > system   i386, linux-gnu =20
> > status                   =20
> > major    1               =20
> > minor    8.1             =20
> > year     2003            =20
> > month    11              =20
> > day      21              =20
> > language R          =20
> >
> >          _                          =20
> > platform i686-pc-linux-gnu          =20
> > arch     i686                       =20
> > os       linux-gnu                  =20
> > system   i686, linux-gnu            =20
> > status   Under development (unstable)
> > major    2                          =20
> > minor    0.0                        =20
> > year     2004                       =20
> > month    04                         =20
> > day      30                         =20
> > language R         =20
> >
> >
> >
> >
> >
> > =2D-=20
> > Ram=F3n D=EDaz-Uriarte
> > Bioinformatics Unit
> > Centro Nacional de Investigaciones Oncol=F3gicas (CNIO)
> > (Spanish National Cancer Center)
> > Melchor Fern=E1ndez Almagro, 3
> > 28029 Madrid (Spain)
> > =46ax: +-34-91-224-6972
> > Phone: +-34-91-224-6900
> >
> > http://bioinfo.cnio.es/~rdiaz
> > PGP KeyID: 0xE89B3462
> > (http://bioinfo.cnio.es/~rdiaz/0xE89B3462.asc)
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
Ram?n D?az-Uriarte
Bioinformatics Unit
Centro Nacional de Investigaciones Oncol?gicas (CNIO)
(Spanish National Cancer Center)
Melchor Fern?ndez Almagro, 3
28029 Madrid (Spain)
Fax: +-34-91-224-6972
Phone: +-34-91-224-6900

http://bioinfo.cnio.es/~rdiaz
PGP KeyID: 0xE89B3462
(http://bioinfo.cnio.es/~rdiaz/0xE89B3462.asc)

From stephen at anc.ed.ac.uk  Mon May  3 14:26:41 2004
From: stephen at anc.ed.ac.uk (stephen@anc.ed.ac.uk)
Date: Mon May  3 15:24:36 2004
Subject: [Rd] Typo in help(optim) (PR#6847)
Message-ID: <20040503122641.C0661EB63@slim.kubism.ku.dk>

I think there is a small typo in "help(optim)":

     Method '"L-BFGS-B"' is that of Byrd _et. al._ (1994) ...

In the reference list, there is no 1994 reference, but there is
Byrd et al. (1995).

Stephen

From ripley at stats.ox.ac.uk  Mon May  3 15:30:00 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May  3 15:30:03 2004
Subject: [Rd] plot functions, formula interfaces and NAs
Message-ID: <Pine.LNX.4.44.0405031412001.26494-100000@gannet.stats>

As we have seen from PR#6846, we don't document much what happens to NAs
in plot functions.  The formula interfaces do seem to be a bit of a mess,
as they call model.frame and so some (but only some) of them pick up the
options() setting of na.action.  This means that for example

pairs(~ x +y + z)  and pairs(cbind(x, y, z))

may well treat NAs differently, depending on the value of 
getOption("na.action").

However, the formula methods for plot, lines and points do ignore
getOption("na.action") and use na.action=NULL (or equivalently, na.pass).

I believe no function should be using getOption("na.action") without a 
means to override it, and thus the formula methods of

boxplot, mosaicplot and  pairs

should get an na.action argument.  Further, since in all cases the 
non-formula methods do handle missing values, I think the default should 
be na.pass.  That is a change in behaviour, but the existing behaviour is 
undocumented.

The proposal is to document this for 1.9.1 and change it for 2.0.0.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From heikki.putkonen at eskk.fi  Mon May  3 15:31:30 2004
From: heikki.putkonen at eskk.fi (heikki.putkonen@eskk.fi)
Date: Mon May  3 15:40:38 2004
Subject: [Rd] A crash (PR#6849)
Message-ID: <20040503133130.A80D1EDF1@slim.kubism.ku.dk>

Dear Sir

There is a acces violation erron (Null pointer) when I have done this. This is
repetable but not inmutable.

0. I have put the command "library("Rcmdr")" in the .Rprofile

1. Start R, load module Rcmdr, Input a dataset in RCommander, then save the
workspace. I can do any analysis now, no crashes, everything works file but
when:

2. I start abain R. It comes up with RCommander perfect

3. I reload the saved workspace from RConsole, it comes up

4. I select the just loaded dataset from RCommander's button <no active dataset>
(with red letters)

5. Then I clik the name of the just loaded dataset. Often this is enough the
create the crash

sometimes R stays up  to the next operation, lets say Statisticst -> Frequency

The null-pointer error is in Rgui TCLTK.dll area. I have tried to compile R in
mingw, but it is not easy. I cannot get zlib to compile

So I wonder am I alone with this problem. (This happens to the R 1.8.x too)

Best wishes Heikki Putkonen

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status =
 major = 1
 minor = 9.0
 year = 2004
 month = 04
 day = 12
 language = R

Windows XP Professional (build 2600) Service Pack 1.0

Search Path:
 .GlobalEnv, package:methods, package:graphics, package:utils, package:Rcmdr,
package:car, package:effects, package:relimp, package:multcomp,
package:mvtnorm, package:lmtest, package:abind, package:tcltk, package:ctest,
package:stats, package:mva, package:foreign, package:lattice, Autoloads,
package:base


040 5431901, Sol Tertis

From deleeuw at stat.ucla.edu  Mon May  3 16:22:18 2004
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Mon May  3 16:22:25 2004
Subject: [Rd] R-1.9.0 won't compile on OSX (PR#6848)
In-Reply-To: <20040503122922.9AA8C10432@slim.kubism.ku.dk>
References: <20040503122922.9AA8C10432@slim.kubism.ku.dk>
Message-ID: <4862AC6B-9D0D-11D8-8299-000A95A67E82@stat.ucla.edu>

What can I say ? Do not use fink. Use -framework vecLib
instead of Atlas. See Stefano's page.

On May 3, 2004, at 5:29, Dan.Kelley@Dal.Ca wrote:

> Full_Name: Dan Kelley
> Version: 1.9.0
> OS: OSX (Darwin 7.3.0)
> Submission from: (NULL) (129.173.23.36)
>
>
> R-1.9.0 will not compile on Apple OSX (Darwin kernel 7.3.0).  The  
> error msg
> starts as follows, and has several more errors.
>
> gcc -dynamiclib -L/sw/lib -L/usr/local/lib -install_name
> /Library/Frameworks/R.f
> ramework/Versions/1.9.0/Resources/bin/libRlapack.dylib -o  
> libRlapack.dylib
> dlapa
> ck0.lo dlapack1.lo dlapack2.lo dlapack3.lo cmplx.lo  -lf77blas -latlas
> -L/sw/lib
>  -L/usr/local/lib -L/sw/lib/gcc/powerpc-apple-darwin7.2.0/3.4
> -L/sw/lib/gcc/powe
> rpc-apple-darwin7.2.0/3.4/../../.. -lfrtbegin -lg2c -lSystem
> ld: common symbols not allowed with MH_DYLIB output format with the
> -multi_modul
> e option
> /sw/lib/libg2c.a(err.o) definition of common _f__cblank (size 4)
> /sw/lib/libg2c.a(fmt.o) definition of common _f__cnt (size 40)
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From tlumley at u.washington.edu  Mon May  3 16:24:35 2004
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon May  3 16:24:45 2004
Subject: [Rd] plot functions, formula interfaces and NAs
In-Reply-To: <Pine.LNX.4.44.0405031412001.26494-100000@gannet.stats>
References: <Pine.LNX.4.44.0405031412001.26494-100000@gannet.stats>
Message-ID: <Pine.A41.4.58.0405030719240.127142@homer12.u.washington.edu>

On Mon, 3 May 2004, Prof Brian Ripley wrote:

> I believe no function should be using getOption("na.action") without a
> means to override it, and thus the formula methods of
>
> boxplot, mosaicplot and  pairs
>
> should get an na.action argument.  Further, since in all cases the
> non-formula methods do handle missing values, I think the default should
> be na.pass.  That is a change in behaviour, but the existing behaviour is
> undocumented.
>

As I know Brian realises, but other people may not, it is not sufficient
just to add na.action=na.pass as a default argument in a function that
uses the usual match.call/eval.parent method to handle formulas.  The
default will be overridden by the default in model.frame.


	-thomas

From stefano.iacus at unimi.it  Mon May  3 16:51:03 2004
From: stefano.iacus at unimi.it (stefano iacus)
Date: Mon May  3 16:51:12 2004
Subject: [Rd] R-1.9.0 won't compile on OSX (PR#6848)
In-Reply-To: <Pine.LNX.4.44.0405031339490.26348-100000@gannet.stats>
References: <Pine.LNX.4.44.0405031339490.26348-100000@gannet.stats>
Message-ID: <4CD19DE2-9D11-11D8-9B7F-000A95C87F66@unimi.it>

Please, at least tell us which configure options you used and tools' 
versions.
stefano

On May 3, 2004, at 2:52 PM, Prof Brian Ripley wrote:

> I don't think this is a bug in *R*, especially as you appear to be 
> using
> the unreleased gcc 3.4!
>
> Hint: there needs to be a dynamic library for libg2c, not a static 
> one. If
> there is not, that's a g77 on MacOS X problem, which at one time (gcc 
> 3.1)
> we had to overcome by using vecLib.
>
> See the R-admin manual which says
>
>   ./configure --with-blas='-framework vecLib' --with-lapack --with-aqua
>
>   The first two options are strongly recommended.
>
> Did you actually follow that advice?  You appear to be trying to use
> atlas, and there is advice about needing a PIC version for that to 
> work.
>
>
> On Mon, 3 May 2004 Dan.Kelley@Dal.Ca wrote:
>
>> Full_Name: Dan Kelley
>> Version: 1.9.0
>> OS: OSX (Darwin 7.3.0)
>> Submission from: (NULL) (129.173.23.36)
>>
>>
>> R-1.9.0 will not compile on Apple OSX (Darwin kernel 7.3.0).  The 
>> error msg
>> starts as follows, and has several more errors.
>>
>> gcc -dynamiclib -L/sw/lib -L/usr/local/lib -install_name
>> /Library/Frameworks/R.f
>> ramework/Versions/1.9.0/Resources/bin/libRlapack.dylib -o 
>> libRlapack.dylib
>> dlapa
>> ck0.lo dlapack1.lo dlapack2.lo dlapack3.lo cmplx.lo  -lf77blas -latlas
>> -L/sw/lib
>>  -L/usr/local/lib -L/sw/lib/gcc/powerpc-apple-darwin7.2.0/3.4
>> -L/sw/lib/gcc/powe
>> rpc-apple-darwin7.2.0/3.4/../../.. -lfrtbegin -lg2c -lSystem
>> ld: common symbols not allowed with MH_DYLIB output format with the
>> -multi_modul
>> e option
>> /sw/lib/libg2c.a(err.o) definition of common _f__cblank (size 4)
>> /sw/lib/libg2c.a(fmt.o) definition of common _f__cnt (size 40)
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From luke at stat.uiowa.edu  Mon May  3 18:27:02 2004
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon May  3 18:27:08 2004
Subject: [Rd] Finalization and external pointers
In-Reply-To: <l1dc90h92tr31qqj3h08c9jee7d9nff9jo@4ax.com>
Message-ID: <Pine.LNX.4.44.0405031109510.22893-100000@itasca.stat.uiowa.edu>

On Mon, 3 May 2004, Duncan Murdoch wrote:

> I'm adding things to the Windows RGui so that there's more control of
> the interface from within R.
> 
> One thing I'm considering is giving access to the Graphapp window
> objects using external pointers.  This raises the issue of
> finalization on both sides:
> 
>  - If someone creates a pointer referring to a window, then that
> pointer should be changed to NULL when the window is closed.
> 
>  - If garbage collection destroys a pointer referring to a window,
> then the window should know not to change that pointer to NULL later.
> 
> Are there other examples like this I can look at?  I'd like to follow
> existing conventions rather than invent my own.
> 
> And a related question:  is there a writeup anywhere on the
> R_RegisterFinalizerEx function?  What does the onexit argument do?

I added some notes I have on weak references and finalization at

	http://www.stat.uiowa.edu/~luke/R/weakfinex.html

The notes are a bit old but I think still apply, such as they are.

The onexit argument sets a flag; when R exits normally it will attempt
to run the finalizers of all references with this flag set.

The simple examples in these notes may be of use, or not.  The Haskell
reference may also be worth a look as one writeup of the issues.

Making sure you have the right match of object lifetimes with object
identities is probably the trickiest issue--do you need to make sure
two ways of asking for an R reference to the same physical window
return the same R pointer object? Probably you do; that will affect
the design in that the pointer object you use has to exist as long as
the physical window does.  Also keep in mind that these things could
get saved in a workspace (they will be restored with NULL pointers).

Best,

luke

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From jfox at mcmaster.ca  Mon May  3 19:35:05 2004
From: jfox at mcmaster.ca (John Fox)
Date: Mon May  3 19:35:10 2004
Subject: [Rd] A crash (PR#6849)
In-Reply-To: <20040503133130.A80D1EDF1@slim.kubism.ku.dk>
Message-ID: <web-36666962@cgpsrv2.cis.mcmaster.ca>

Dear Heikki,

I generally don't save the R workspace, but I did try this several
times following your message (on a Win 2000 system using the patched
version of R 1.9.0) and was unable to duplicate the error.

Are you able to produce the error using the tcltk package without
Rcmdr?

Perhaps someone else has some thoughts.

John

On Mon,  3 May 2004 15:31:30 +0200 (CEST)
 heikki.putkonen@eskk.fi wrote:
> Dear Sir
> 
> There is a acces violation erron (Null pointer) when I have done
> this. This is
> repetable but not inmutable.
> 
> 0. I have put the command "library("Rcmdr")" in the .Rprofile
> 
> 1. Start R, load module Rcmdr, Input a dataset in RCommander, then
> save the
> workspace. I can do any analysis now, no crashes, everything works
> file but
> when:
> 
> 2. I start abain R. It comes up with RCommander perfect
> 
> 3. I reload the saved workspace from RConsole, it comes up
> 
> 4. I select the just loaded dataset from RCommander's button <no
> active dataset>
> (with red letters)
> 
> 5. Then I clik the name of the just loaded dataset. Often this is
> enough the
> create the crash
> 
> sometimes R stays up  to the next operation, lets say Statisticst ->
> Frequency
> 
> The null-pointer error is in Rgui TCLTK.dll area. I have tried to
> compile R in
> mingw, but it is not easy. I cannot get zlib to compile
> 
> So I wonder am I alone with this problem. (This happens to the R
> 1.8.x too)
> 
> Best wishes Heikki Putkonen
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status =
>  major = 1
>  minor = 9.0
>  year = 2004
>  month = 04
>  day = 12
>  language = R
> 
> Windows XP Professional (build 2600) Service Pack 1.0
> 
> Search Path:
>  .GlobalEnv, package:methods, package:graphics, package:utils,
> package:Rcmdr,
> package:car, package:effects, package:relimp, package:multcomp,
> package:mvtnorm, package:lmtest, package:abind, package:tcltk,
> package:ctest,
> package:stats, package:mva, package:foreign, package:lattice,
> Autoloads,
> package:base
> 
> 
> 040 5431901, Sol Tertis
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel


--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
http://socserv.mcmaster.ca/jfox/

From kwright at eskimo.com  Mon May  3 20:57:17 2004
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Mon May  3 20:57:20 2004
Subject: [Rd] installed.packages hyperlink wrong in two spots (PR#6850)
Message-ID: <20040503185717.0D4F9EB63@slim.kubism.ku.dk>

Full_Name: Kevin Wright
Version: 1.9.0
OS: Windows 2000
Submission from: (NULL) (170.54.59.160)



The html help file for the 'library' function contains this sentence:

 Note that installed.packages() returns...

The 'installed.packages' hyperlink points to 'installed.packages.html'.  The
latter file does not exist for me.  I suspect the link should be to
'update.packages.html'.

I searched the 'library' directory for other instances of
'installed.packages.html' and also found the string in the following file:
getDepList.html


Is there any kind of hyperlink checking that happens during the R build process?
 I imagine that this thought has been considered before.

From ripley at stats.ox.ac.uk  Mon May  3 21:16:16 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May  3 21:16:27 2004
Subject: [Rd] installed.packages hyperlink wrong in two spots (PR#6850)
In-Reply-To: <20040503185717.0D4F9EB63@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405032012540.23174-100000@gannet.stats>

On Mon, 3 May 2004 kwright@eskimo.com wrote:

> Full_Name: Kevin Wright
> Version: 1.9.0
> OS: Windows 2000
> Submission from: (NULL) (170.54.59.160)
> 
> The html help file for the 'library' function contains this sentence:
> 
>  Note that installed.packages() returns...
> 
> The 'installed.packages' hyperlink points to 'installed.packages.html'.  The
> latter file does not exist for me.  I suspect the link should be to
> 'update.packages.html'.
> 
> I searched the 'library' directory for other instances of
> 'installed.packages.html' and also found the string in the following file:
> getDepList.html

Those are forwrd references to package utils, so have to be resolved 
manually.

> Is there any kind of hyperlink checking that happens during the R build process?
>  I imagine that this thought has been considered before.

No, yes.  We look forwards to reviewing your contribution of such a 
checker.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue May  4 10:31:30 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue May  4 10:31:32 2004
Subject: [Rd] gcc 3.4.0 on Linux i686 fails to run R for me
Message-ID: <Pine.LNX.4.44.0405040919010.17245-100000@gannet.stats>

I've just installed gcc-3.4.0 on RH8.0 (on a dual athlon MP, if it
matters) and rebuilt R.  I find interSpline (in example(autoload)) is
failing to complete.  It seems to be looping in dlamc1 in dlapack0.f.
This happened both with ATLAS and the BLAS built in to R.

I will dig a little deeper, but it might be helpful to have a warning on 
record.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue May  4 12:13:00 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue May  4 12:13:04 2004
Subject: [Rd] gcc 3.4.0 on Linux i686 fails to run R for me
In-Reply-To: <Pine.LNX.4.44.0405040919010.17245-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0405041104400.8772-100000@gannet.stats>

On Tue, 4 May 2004, Prof Brian Ripley wrote:

> I've just installed gcc-3.4.0 on RH8.0 (on a dual athlon MP, if it
> matters) and rebuilt R.  I find interSpline (in example(autoload)) is
> failing to complete.  It seems to be looping in dlamc1 in dlapack0.f.
> This happened both with ATLAS and the BLAS built in to R.
> 
> I will dig a little deeper, but it might be helpful to have a warning on 
> record.

The issue is

*  DLAMC3  is intended to force  A  and  B  to be stored prior to doing
*  the addition of  A  and  B ,  for use in situations where optimizers
*  might hold one of these in a register.
*     .. Executable Statements ..
*
      DLAMC3 = A + B

and it seems that -O2 on gcc 3.4.0 manages to defeat this.

Compiling without -O2 or with -ffloat-store works correctly.

My guess is that there is no way to control this from the Fortran code, 
and we are going to have to arrange to compile this piece of code under 
non-standard optimization options.  Anyone know better?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dimss at solutions.lv  Tue May  4 22:05:06 2004
From: dimss at solutions.lv (dimss@solutions.lv)
Date: Tue May  4 22:05:09 2004
Subject: [Rd] Compilation errors (PR#6855)
Message-ID: <20040504200506.532F010432@slim.kubism.ku.dk>

Full_Name: Dmitry Ivanov
Version: 1.9.0
OS: Slackware-current
Submission from: (NULL) (213.182.223.91)


Cannot compile R with X11. Compiler is GCC 3.3.3. X11 is XFree86 4.4.0. C
library is GLIBC 2.3.2.

\begin{errors}
make[4]: Entering directory
`/home/dimss/pub/software/R/R-1.9.0/src/modules/X11'
gcc -I. -I../../../src/include -I../../../src/include -I/usr/X11R6/include
-I/usr/local/include -DHAVE_CONFIG_H -D__NO_MATH_INLINES -mieee-fp -fPIC  -g -O2
-c dataentry.c -o dataentry.lo
In file included from dataentry.c:31:
/usr/X11R6/include/X11/Xlib.h:1390: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1478: error: parse error before "char"
/usr/X11R6/include/X11/Xlib.h:1506: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1510: error: parse error before "char"
/usr/X11R6/include/X11/Xlib.h:1532: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1567: error: parse error before '*' token
/usr/X11R6/include/X11/Xlib.h:1576: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1601: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1651: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1657: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1704: error: parse error before "char"
/usr/X11R6/include/X11/Xlib.h:1743: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:1984: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2068: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2321: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2331: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2403: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2413: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2571: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2586: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2779: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2846: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2851: error: parse error before "char"
/usr/X11R6/include/X11/Xlib.h:2965: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:2991: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3002: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3027: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3036: error: parse error before "char"
/usr/X11R6/include/X11/Xlib.h:3049: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3192: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3241: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3273: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3364: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3371: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3391: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3397: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3409: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3419: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3429: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3435: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3536: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3553: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3604: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3647: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3653: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3659: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3665: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3673: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3681: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3689: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3701: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3713: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3760: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3771: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3782: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3793: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3804: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xlib.h:3815: error: parse error before "_Xconst"
In file included from dataentry.c:32:
/usr/X11R6/include/X11/Xutil.h:566: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xutil.h:606: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xutil.h:666: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xutil.h:678: error: parse error before "_Xconst"
/usr/X11R6/include/X11/Xutil.h:801: error: parse error before "_Xconst"
dataentry.c: In function `GetKey':
dataentry.c:1272: warning: passing arg 4 of `XLookupString' from incompatible
pointer type
dataentry.c: In function `GetCharP':
dataentry.c:1281: warning: passing arg 4 of `XLookupString' from incompatible
pointer type
dataentry.c: In function `doControl':
dataentry.c:1302: warning: passing arg 4 of `XLookupString' from incompatible
pointer type
make[4]: *** [dataentry.lo] Error 1
make[4]: Leaving directory `/home/dimss/pub/software/R/R-1.9.0/src/modules/X11'
make[3]: *** [R] Error 2
make[3]: Leaving directory `/home/dimss/pub/software/R/R-1.9.0/src/modules/X11'
make[2]: *** [R] Error 1
make[2]: Leaving directory `/home/dimss/pub/software/R/R-1.9.0/src/modules'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/home/dimss/pub/software/R/R-1.9.0/src'
make: *** [R] Error 1
\end{errors}

From p.dalgaard at biostat.ku.dk  Tue May  4 22:23:13 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue May  4 22:27:40 2004
Subject: [Rd] Compilation errors (PR#6855)
In-Reply-To: <20040504200506.532F010432@slim.kubism.ku.dk>
References: <20040504200506.532F010432@slim.kubism.ku.dk>
Message-ID: <x2vfjc9c26.fsf@biostat.ku.dk>

dimss@solutions.lv writes:

> Cannot compile R with X11. Compiler is GCC 3.3.3. X11 is XFree86 4.4.0. C
> library is GLIBC 2.3.2.

Yes we've heard about that issue a few times before. Perturbation of
headers in XFree86 4.4.

Fixed in R-patched, I believe.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From jmacdon at med.umich.edu  Wed May  5 03:53:38 2004
From: jmacdon at med.umich.edu (jmacdon@med.umich.edu)
Date: Wed May  5 03:53:43 2004
Subject: [Rd] Segfault from knn.cv in class package (PR#6856)
Message-ID: <20040505015338.402ABEDF3@slim.kubism.ku.dk>

The function knn.cv in the class package doesn't have error checking to
ensure that the length of the classlabel argument is equal to the number
of rows in the test set. If the classlabel is short, the result is often
a segfault.

> library(class)
> dat <- matrix(rnorm(1000), nrow=10)
> cl <- c(rep(1,5), rep(2,5))
> cl2 <- c(rep(1,5), rep(2,4))
> knn.cv(dat, cl)
 [1] 2 2 1 2 1 2 2 2 2 2
Levels: 1 2
> knn.cv(dat, cl2) # May have to try more than once to get segfault.

This also occurs on my linux box.

Best,

Jim



--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 1
 minor = 9.0
 year = 2004
 month = 04
 day = 12
 language = R

Windows XP Professional (build 2600) Service Pack 1.0

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics,
package:utils, Autoloads, package:base


James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109
734-647-5623

From ripley at stats.ox.ac.uk  Wed May  5 07:57:06 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May  5 07:57:13 2004
Subject: [Rd] Segfault from knn.cv in class package (PR#6856)
In-Reply-To: <20040505015338.402ABEDF3@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405050653040.9946-100000@gannet.stats>

This is user error.

R-bugs is not the appropriate place to report user error in a contributed 
package -- please do read the R FAQ.

On Wed, 5 May 2004 jmacdon@med.umich.edu wrote:

> The function knn.cv in the class package doesn't have error checking to
> ensure that the length of the classlabel argument is equal to the number
> of rows in the test set. If the classlabel is short, the result is often

There is no *test* set in knn.cv, nor is there a `classlabel argument'.
There is 

      cl: factor of true classifications of training set 

and that has been specified incorrectly.

> a segfault.
> 
> > library(class)
> > dat <- matrix(rnorm(1000), nrow=10)
> > cl <- c(rep(1,5), rep(2,5))
> > cl2 <- c(rep(1,5), rep(2,4))
> > knn.cv(dat, cl)
>  [1] 2 2 1 2 1 2 2 2 2 2
> Levels: 1 2
> > knn.cv(dat, cl2) # May have to try more than once to get segfault.
> 
> This also occurs on my linux box.
> 
> Best,
> 
> Jim
> 
> 
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status = 
>  major = 1
>  minor = 9.0
>  year = 2004
>  month = 04
>  day = 12
>  language = R
> 
> Windows XP Professional (build 2600) Service Pack 1.0
> 
> Search Path:
>  .GlobalEnv, package:methods, package:stats, package:graphics,
> package:utils, Autoloads, package:base
> 
> 
> James W. MacDonald
> Affymetrix and cDNA Microarray Core
> University of Michigan Cancer Center
> 1500 E. Medical Center Drive
> 7410 CCGC
> Ann Arbor MI 48109
> 734-647-5623
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hb at maths.lth.se  Wed May  5 12:57:29 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Wed May  5 12:57:34 2004
Subject: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
Message-ID: <001701c4328f$c2775890$e502eb82@maths.lth.se>

Hi, I'm running R v1.9.0 on WinXP Pro. I noticed that R.exe and
Rterm.exe behave differently on Ctrl-C. Starting a Windows Command
prompt (cmd.exe) you get from running Rterm.exe:

C:\Program Files\R>rw1090\bin\Rterm.exe --vanilla --quiet
> ^C
> ^C
> 1+1
[1] 2
> Sys.sleep(100)   # Ctrl-C after a few seconds

> ^C
> ^C
> 1+1
[1] 2
> q()

C:\Program Files\R>
C:\Program Files\R>

Ctrl-C works as expected. Exiting R and you're back at a "clean"
prompt. Now, try the same thing with R.exe (from a restarted prompt):

C:\Program Files\R>rw1090\bin\R.exe --vanilla --quiet
> ^C
> ^C
> 1+1
[1] 2
> Sys.sleep(100)
^C
C:\Program Files\R>
>

Strange things happen. R seems still to be running but has at the same
time returned(?) the control back to the Command prompt. Try to
continue by pressing ENTER and/or type 1 + ENTER, 2 + ENTER etc and
you'll see that eventually you get replied from R also:

> 1+1
'1+1' is not recognized as an internal or external command,
operable program or batch file.

C:\Program Files\R>1+1
'+1' is not recognized as an internal or external command,
operable program or batch file.

C:\Program Files\R>q
C:\Program Files\R>
function (save = "default", status = 0, runLast = TRUE)
.Internal(quit(save, status, runLast))
<environment: namespace:base>
>

Clearly both cmd.exe and R is trying to parse the stdin. Some
keystrokes goes to R and some to cmd.exe.

Best wishes

Henrik Bengtsson

Div. of Mathematical Statistics @ Centre for Mathematical Sciences
Lund Institute of Technology/Lund University, Sweden 
(Sweden +2h UTC, Melbourne +10 UTC, Calif. -7h UTC)
+46 708 909208 (cell), +46 46 320 820 (home), 
+1 (508) 464 6644 (global fax),
+46 46 2229611 (off), +46 46 2224623 (dept. fax)
h b @ m a t h s . l t h . s e, http://www.maths.lth.se/~hb/

From mail.marshal at massey.ac.nz  Wed May  5 19:58:42 2004
From: mail.marshal at massey.ac.nz (mail.marshal@massey.ac.nz)
Date: Wed May  5 19:59:03 2004
Subject: [Rd] ---- Virus Detected ----
Message-ID: <D0000ac0c2@its-mm1.massey.ac.nz>

MailMarshal has stopped the following message you sent:

   Message: B002c47778.00000001.mml
   From:    r-devel@lists.r-project.org
   To:      webmaster@beef.org.nz
   Subject: Error (webmaster@beef.org.nz)

Because it believes an attachment to this message contains a virus.  The virus 
scanning software used was: Norman Virus Control.

Details about the virus found in this email are:
    Netsky.Q@mm

Please clean the file (and possibly your machine) and resend the mail.
From dmurdoch at pair.com  Wed May  5 21:15:12 2004
From: dmurdoch at pair.com (dmurdoch@pair.com)
Date: Wed May  5 21:15:15 2004
Subject: [Rd] Re: [R] weirdness in sourc()ing a dump()  (bug?) (PR#6857)
Message-ID: <20040505191512.6AA24FB8C@slim.kubism.ku.dk>

On Wed, 05 May 2004 11:53:12 -0700, Webb Sprague
<wwsprague@ucdavis.edu> wrote :

>Hi all,
>
>I dump the result of a long simulation, which I know has run to 
>completion and returned a fairly complex list of lists of things. 
>However, when I try to read it back in, I get the following error:
>
> > source ('../SIMULATIONS/run.1.R')
>Error in structure(list(do.extinction.runs, alpha = 1.8, delta.change = 
>0.005,  : Object "do.extinction.runs" not found

Here's a simpler example:

> f<-function (...) 
+ {
+     return(list(call.list = as.list(match.call())))
+ }
> x <- f(y=4)
> dump('x')
> rm(f)
> source('dumpdata.r')
Error in structure(list(f, y = 4), .Names = c("", "y")) : 
        Object "f" not found

This bug still appears in R-patched.

Duncan Murdoch

From dmurdoch at pair.com  Thu May  6 16:16:03 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Thu May  6 16:16:06 2004
Subject: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
In-Reply-To: <001701c4328f$c2775890$e502eb82@maths.lth.se>
References: <001701c4328f$c2775890$e502eb82@maths.lth.se>
Message-ID: <4uhk90tkk4s548sd7in50ugt2r37v50t5q@4ax.com>

On Wed, 5 May 2004 12:57:29 +0200, "Henrik Bengtsson"
<hb@maths.lth.se> wrote :


>Ctrl-C works as expected. Exiting R and you're back at a "clean"
>prompt. Now, try the same thing with R.exe (from a restarted prompt):
>
>C:\Program Files\R>rw1090\bin\R.exe --vanilla --quiet
>> ^C
>> ^C
>> 1+1
>[1] 2
>> Sys.sleep(100)
>^C
>C:\Program Files\R>
>>
>
>Strange things happen. R seems still to be running but has at the same
>time returned(?) the control back to the Command prompt.

Yes, that is indeed strange behaviour.  

Ctrl-C definitely presents problems.  For instance, on my WinXP system
running R from a Cygwin prompt, a Ctrl-C during the Sys.sleep kills
Rterm, whereas under the Windows cmd.exe prompt it works properly as
it did for you.

I can guess at an explanation for what you saw, but I don't know how
to fix it:

- R (as opposed to Rterm) is a small .exe program that does a little
argument parsing, then runs Rterm.  It looks as though the Ctrl-C is
going to R, and killing that process, but leaving the child process
Rterm running.  But since both Rterm and cmd.exe are reading and
writing to standard file handles, you get the messed up prompts.

I've just tried doing what the Windows documentation says should work
(adding this line before Rterm is called:

SetConsoleCtrlHandler(NULL, TRUE);  /* Ignore Ctrl-C; Rterm will
handle them */

but this didn't fix the problems, it just made them different (i.e.
Ctrl-C stopped working completely).  Rterm *does* set a Ctrl-C
handler, but it just isn't being called, as far as I can tell.

A simple workaround is to run Rterm or Rgui rather than R.  If anyone
knows a real fix, please let me know.

Duncan Murdoch

From hb at maths.lth.se  Thu May  6 17:35:39 2004
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Thu May  6 17:35:49 2004
Subject: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
In-Reply-To: <4uhk90tkk4s548sd7in50ugt2r37v50t5q@4ax.com>
Message-ID: <000801c4337f$c9681040$e502eb82@maths.lth.se>

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Duncan
Murdoch
> Sent: den 6 maj 2004 16:16
> To: Henrik Bengtsson
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
> 
> 
> On Wed, 5 May 2004 12:57:29 +0200, "Henrik Bengtsson" 
> <hb@maths.lth.se> wrote :
> 
> 
> >Ctrl-C works as expected. Exiting R and you're back at a "clean" 
> >prompt. Now, try the same thing with R.exe (from a restarted
prompt):
> >
> >C:\Program Files\R>rw1090\bin\R.exe --vanilla --quiet
> >> ^C
> >> ^C
> >> 1+1
> >[1] 2
> >> Sys.sleep(100)
> >^C
> >C:\Program Files\R>
> >>
> >
> >Strange things happen. R seems still to be running but has 
> at the same 
> >time returned(?) the control back to the Command prompt.
> 
> Yes, that is indeed strange behaviour.  
> 
> Ctrl-C definitely presents problems.  For instance, on my 
> WinXP system running R from a Cygwin prompt, a Ctrl-C during 
> the Sys.sleep kills Rterm, whereas under the Windows cmd.exe 
> prompt it works properly as it did for you.

Cygwin is indeed where I noticed the problem first. For Cygwin, I know
that Ctrl-C did not kill Rterm on R v1.7.1 and before, but from R
v1.8.1 (don't know about R v1.8.0) it all of a sudden started to do
it. Maybe there is a clue somewhere in the diff's between v1.7.1 and
v1.8.x, which may also explain what is going on in R.exe and
Rterm.exe.

> I can guess at an explanation for what you saw, but I don't 
> know how to fix it:
> 
> - R (as opposed to Rterm) is a small .exe program that does a 
> little argument parsing, then runs Rterm.  It looks as though 
> the Ctrl-C is going to R, and killing that process, but 
> leaving the child process Rterm running.  But since both 
> Rterm and cmd.exe are reading and writing to standard file 
> handles, you get the messed up prompts.
> 
> I've just tried doing what the Windows documentation says 
> should work (adding this line before Rterm is called:
> 
> SetConsoleCtrlHandler(NULL, TRUE);  /* Ignore Ctrl-C; Rterm 
> will handle them */
> 
> but this didn't fix the problems, it just made them different 
> (i.e. Ctrl-C stopped working completely).  Rterm *does* set a 
> Ctrl-C handler, but it just isn't being called, as far as I can
tell.
> 
> A simple workaround is to run Rterm or Rgui rather than R.  
> If anyone knows a real fix, please let me know.
> 
> Duncan Murdoch

By the way, nice job with R.exe together will Rtools. It makes it more
convenient to work with R on both Windows and *nix. Thanks.

Cheers

Henrik Bengtsson

From ripley at stats.ox.ac.uk  Thu May  6 18:01:09 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May  6 18:01:14 2004
Subject: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
In-Reply-To: <000801c4337f$c9681040$e502eb82@maths.lth.se>
Message-ID: <Pine.LNX.4.44.0405061654260.19271-100000@gannet.stats>

On Thu, 6 May 2004, Henrik Bengtsson wrote:

> > -----Original Message-----
> > From: r-devel-bounces@stat.math.ethz.ch 
> > [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Duncan
> Murdoch
> > Sent: den 6 maj 2004 16:16
> > To: Henrik Bengtsson
> > Cc: r-devel@stat.math.ethz.ch
> > Subject: Re: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
> > 
> > 
> > On Wed, 5 May 2004 12:57:29 +0200, "Henrik Bengtsson" 
> > <hb@maths.lth.se> wrote :
> > 
> > 
> > >Ctrl-C works as expected. Exiting R and you're back at a "clean" 
> > >prompt. Now, try the same thing with R.exe (from a restarted
> prompt):
> > >
> > >C:\Program Files\R>rw1090\bin\R.exe --vanilla --quiet
> > >> ^C
> > >> ^C
> > >> 1+1
> > >[1] 2
> > >> Sys.sleep(100)
> > >^C
> > >C:\Program Files\R>
> > >>
> > >
> > >Strange things happen. R seems still to be running but has 
> > at the same 
> > >time returned(?) the control back to the Command prompt.
> > 
> > Yes, that is indeed strange behaviour.  
> > 
> > Ctrl-C definitely presents problems.  For instance, on my 
> > WinXP system running R from a Cygwin prompt, a Ctrl-C during 
> > the Sys.sleep kills Rterm, whereas under the Windows cmd.exe 
> > prompt it works properly as it did for you.
> 
> Cygwin is indeed where I noticed the problem first. For Cygwin, I know
> that Ctrl-C did not kill Rterm on R v1.7.1 and before, but from R
> v1.8.1 (don't know about R v1.8.0) it all of a sudden started to do
> it. Maybe there is a clue somewhere in the diff's between v1.7.1 and
> v1.8.x, which may also explain what is going on in R.exe and
> Rterm.exe.

No, as it was to do with a change in the MinGW runtime system and not in 
R.

Expecting to be able to use ^C as a Windows signal in a shell that is 
emulating Unix is I think unrealistic.  ^C in Rterm does work in tcsh.exe, 
cmd.exe and various clones.

It is becoming a mantra, but

  *** Cygwin is not Windows ***

and R is a Windows and not Cygwin executable.  People who want a Cygwin 
port of R perhaps should work on one ....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From bolker at zoo.ufl.edu  Fri May  7 00:54:06 2004
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Fri May  7 00:33:16 2004
Subject: [Rd] mle
Message-ID: <Pine.LNX.4.44.0405061848410.14589-100000@bolker.zoo.ufl.edu>


  I'm very excited by the new mle package now incorporated in stats4.  If 
possible, I'd like to help develop it.  In the past I wrote a similar 
package (mleprof, available from http://www.zoo.ufl.edu/bolker/R/src), and 
would like to see if there's anything that my package does that I could 
contribute (in particular, I'd like to make sure that the code is as 
robust as possible in constructing profiles and finding confidence 
limits); I also have opinions about some of the defaults, and I can 
certainly help test it ...

  I don't know who the primary developer is beyond "R-core" ... if 
whoever's working on it would like to take me up on the offer, can you let 
me know?

  Ben Bolker

-- 
620B Bartram Hall                            bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704

From p.dalgaard at biostat.ku.dk  Fri May  7 01:15:57 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri May  7 01:20:35 2004
Subject: [Rd] mle
In-Reply-To: <Pine.LNX.4.44.0405061848410.14589-100000@bolker.zoo.ufl.edu>
References: <Pine.LNX.4.44.0405061848410.14589-100000@bolker.zoo.ufl.edu>
Message-ID: <x2vfj9du4y.fsf@biostat.ku.dk>

Ben Bolker <bolker@zoo.ufl.edu> writes:

>   I'm very excited by the new mle package now incorporated in stats4.  If 
> possible, I'd like to help develop it.  In the past I wrote a similar 
> package (mleprof, available from http://www.zoo.ufl.edu/bolker/R/src), and 
> would like to see if there's anything that my package does that I could 
> contribute (in particular, I'd like to make sure that the code is as 
> robust as possible in constructing profiles and finding confidence 
> limits); I also have opinions about some of the defaults, and I can 
> certainly help test it ...
> 
>   I don't know who the primary developer is beyond "R-core" ... if 
> whoever's working on it would like to take me up on the offer, can you let 
> me know?

Well, I wrote the core bits, but stealing heavily from the glm and nls
profilers (by Bill Venables and Doug Bates, I believe) and Brian
Ripley did quite a bit of stabilizing of the code between the 1.8.x
and 1.9.0 releases. I'll be bogged down for at least another month,
but I might be able to get back to this some time in June. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From dmurdoch at pair.com  Fri May  7 05:51:48 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Fri May  7 05:51:54 2004
Subject: [Rd] Ctrl-C with R.exe and Rterm.exe in R v1.9.0
In-Reply-To: <Pine.LNX.4.44.0405061654260.19271-100000@gannet.stats>
References: <000801c4337f$c9681040$e502eb82@maths.lth.se>
	<Pine.LNX.4.44.0405061654260.19271-100000@gannet.stats>
Message-ID: <4s1m901tbt72oqmf16qrsgtc2cubmo1787@4ax.com>

On Thu, 6 May 2004 17:01:09 +0100 (BST), Prof Brian Ripley
<ripley@stats.ox.ac.uk> wrote:


>Expecting to be able to use ^C as a Windows signal in a shell that is 
>emulating Unix is I think unrealistic.  ^C in Rterm does work in tcsh.exe, 
>cmd.exe and various clones.

Yes, but there's still a bug if Rterm.exe was started by R.exe in
cmd.exe.   It's just not one that I know how to fix.

Duncan

From maechler at stat.math.ethz.ch  Fri May  7 11:22:52 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri May  7 11:22:58 2004
Subject: [Rd] segfault in approx() (PR#6809)
Message-ID: <20040507092252.63C53F0E7@slim.kubism.ku.dk>

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 22 Apr 2004 00:11:00 +0200 writes:

    PD> kjetil@entelnet.bo writes:
    >> This is R1.9.0, windows XP
    >> 
    >> I run across the following:
    >> 
    >> It is admittedly silly, but it shouldn't segfault:
    >> 
    >> test <- list(y=1:100, x=rep(NaN, 100))
    >> approx(test, xout=rep(NaN, 10))
    >> 
    >> Bombs!

    PD> Yup. Sanity check needed on entrance to approx1. I suppose that

    PD> if (!n) return NaN;
	   
    PD> should do the trick.

indeed!  s/NaN/R_NaN/ 
Will commit for R-patched {future 1.9.1}.

Martin

From mc at austrian-mint.at  Fri May  7 16:45:36 2004
From: mc at austrian-mint.at (mc@austrian-mint.at)
Date: Fri May  7 16:45:41 2004
Subject: [Rd] Fortran compiler dependency missing in gentoo ebuild script
	(PR#6862)
Message-ID: <20040507144536.CFAF5F0E7@slim.kubism.ku.dk>

Full_Name: Markus Cozowicz
Version: 1.9.0
OS: Gentoo Linux
Submission from: (NULL) (81.223.31.120)


Fortran compiler dependency missing in gentoo ebuild script 

Workaround: emerge f2c

From p.dalgaard at biostat.ku.dk  Fri May  7 16:49:58 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri May  7 16:54:38 2004
Subject: [Rd] Fortran compiler dependency missing in gentoo ebuild script
	(PR#6862)
In-Reply-To: <20040507144536.CFAF5F0E7@slim.kubism.ku.dk>
References: <20040507144536.CFAF5F0E7@slim.kubism.ku.dk>
Message-ID: <x2oep0mgvd.fsf@biostat.ku.dk>

mc@austrian-mint.at writes:

> Full_Name: Markus Cozowicz
> Version: 1.9.0
> OS: Gentoo Linux
> Submission from: (NULL) (81.223.31.120)
> 
> 
> Fortran compiler dependency missing in gentoo ebuild script 
> 
> Workaround: emerge f2c

Er, in which sense is this an R bug? There is nothing we can do about
missing dependencies in packages for Linux distributions, and we're
not even likely to be informed when (if) the issue is resolved. You
need to tell Gentoo or whoever maintains the R package for it.

BTW, are you sure you wouldn't rather install g77 than f2c?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From michael.brauchart at pfarreihuenenberg.ch  Sat May  8 00:58:17 2004
From: michael.brauchart at pfarreihuenenberg.ch (michael.brauchart@pfarreihuenenberg.ch)
Date: Sat May  8 00:58:24 2004
Subject: [Rd] Virus gefunden in Nachricht "My details" (PR#6865)
Message-ID: <20040507225817.98DF5FBE5@slim.kubism.ku.dk>

This is a multi-part message in MIME format.

------_=_NextPart_001_01C43483.97C12CB0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Symantec AntiVirus hat einen Virus in einem Anhang gefunden, den Sie =
(r-bugs@r-project.org <r-bugs@r-project.org>) an m.brauchart@gmx.de =
gesendet haben.

Um sicherzustellen, da=DF die Empf=E4nger die gesendeten Dateien =
verwenden k=F6nnen, f=FChren Sie einen Virensuchlauf auf Ihrem Computer =
durch, entfernen Sie Viren aus infizierten Dateien, und senden Sie =
diesen Anhang erneut.



Anhang:  my_details.pif
Virusname: W32.Netsky.D@mm
Durchgef=FChrte Aktion:  Isolierung erfolgreich :=20
Dateistatus:  Infiziert




------_=_NextPart_001_01C43483.97C12CB0
Content-Type: application/ms-tnef;
	name="winmail.dat"
Content-Transfer-Encoding: base64

eJ8+IhMXAQaQCAAEAAAAAAABAAEAAQeQBgAIAAAA5AQAAAAAAADoAAEIgAcAGAAAAElQTS5NaWNy
b3NvZnQgTWFpbC5Ob3RlADEIAQ2ABAACAAAAAgACAAEEgAEAKQAAAFZpcnVzIGdlZnVuZGVuIGlu
IE5hY2hyaWNodCAiTXkgZGV0YWlscyIAYA4BBYADAA4AAADUBwUACAAAACMAGAAGACkBASCAAwAO
AAAA1AcFAAgAAAAjABoABgArAQEJgAEAIQAAADE4N0Y3MDgxQzI1NkZGNDRBNzMwQUZGODY2QkI0
NTI5AC4HAQOQBgCkBgAAJQAAAAMANgAAAAAAQAA5ACCmr5aDNMQBHgA9AAEAAAABAAAAAAAAAAIB
RwABAAAALwAAAGM9Q0g7YT0gO3A9UEZBUlJBTVQ7bD1TRVJWRVItMDQwNTA3MjIzNTI2Wi0xOTUA
AB4AcAABAAAAKQAAAFZpcnVzIGdlZnVuZGVuIGluIE5hY2hyaWNodCAiTXkgZGV0YWlscyIAAAAA
AgFxAAEAAAAWAAAAAcQ0g5avxbBEe6AKT8yS7BHe1EHbhwAAHgAaDAEAAAASAAAATWljaGFlbCBC
cmF1Y2hhcnQAAAAeAB0OAQAAACkAAABWaXJ1cyBnZWZ1bmRlbiBpbiBOYWNocmljaHQgIk15IGRl
dGFpbHMiAAAAAAIBCRABAAAAIgIAAB4CAABLAwAATFpGdZsZqpMDAAoAcmNwZzEyNeIyA0N0ZXgF
QQEDAfdPCoACpAPjAgBjaArAc/BldDAgBxMCgA/zAFB/BFYIVQeyEcUOUQMBEMcy9wYABsMRxTME
RhDJEtsR09sI7wn3Oxi/DjA1EcIMYM5jAFALCQFkMzYRUAumNxTyAHAOsGMRYAIwaVa4aXJ1BCAQ
8AVAZQuA3QnwIB5kC4Ae820eERDwkG5nIGcBEHVuAQA4biwgIREGAAiQICiAci1idWdzQCHwynAD
YGoFkHQuBbAgoEY8If8jAT4pIAORbTAuYnJhG3AQ8XRA8GdteC4BACCxESAhAesFQBDwYgnwLgqi
CoQKgNZVIDAN0WgEkHoekA6wBGxsISNhXCdkZkMhUCGxRW1wZikwZb40IJATISmCJiYfMUQe0Gsf
AB8xdgSQdyZSA6Br8SkwZjZuHyEhQCnxENFvGMAhhB8HCfBzJUELYHV7KWAvMkktoSAwCFAp0HX/
DrAqcQhwEOAhQAnwADAEkY8hdS6TL2EfomZpegiR/ytJIUAg8SfwLEQhoimBJkE/IEYxUjBQJwsn
GiBUOiAZJOB5XyZxC3Bscy7OcAaQJxQeY25hB4A4ABBXMzIuB8B0c2tAeS5EQG1tJxRE3zCyIMEt
ZA6wEWBrHkACIPk4AUlzBvAIkSDwNZICEPZsCcEoESA4ADsVK5IogJ8e0B6QPOIypjaPCn1BoAAA
HgA1EAEAAAA/AAAAPEU5MzA4QzIxRUEyQTQwNEU5RjVDOTVCRTc4QkI3NTE0MDFBNDExQHNlcnZl
ci5wZmFycmFtdC5sb2NhbD4AAB8A8xABAAAAYgAAAFYAaQByAHUAcwAgAGcAZQBmAHUAbgBkAGUA
bgAgAGkAbgAgAE4AYQBjAGgAcgBpAGMAaAB0ACAAJQAyADIATQB5ACAAZABlAHQAYQBpAGwAcwAl
ADIAMgAuAEUATQBMAAAAAAALAPQQAAAAAAsA9RAAAAAACwD2EAAAAABAAAcwgKW/l4M0xAFAAAgw
AFLkl4M0xAEDAPE/BwQAAB4A+D8BAAAAEgAAAE1pY2hhZWwgQnJhdWNoYXJ0AAAAAgH5PwEAAABp
AAAAAAAAANynQMjAQhAatLkIACsv4YIBAAAAAAAAAC9PPVBGQVJSQU1UL09VPUZJUlNUIEFETUlO
SVNUUkFUSVZFIEdST1VQL0NOPVJFQ0lQSUVOVFMvQ049TUlDSEFFTC5CUkFVQ0hBUlQAAAAAHgD6
PwEAAAAVAAAAU3lzdGVtIEFkbWluaXN0cmF0b3IAAAAAAgH7PwEAAAAeAAAAAAAAANynQMjAQhAa
tLkIACsv4YIBAAAAAAAAAC4AAAADAP0/5AQAAAMAGUAAAAAAAwAaQAAAAAAeADBAAQAAABIAAABN
SUNIQUVMLkJSQVVDSEFSVAAAAB4AMUABAAAAEgAAAE1JQ0hBRUwuQlJBVUNIQVJUAAAAHgA4QAEA
AAASAAAATUlDSEFFTC5CUkFVQ0hBUlQAAAAeADlAAQAAAAIAAAAuAAAAAwB2QP////8LACkAAAAA
AAsAIwAAAAAAAwAGEArgvPADAAcQpgEAAAMAEBAAAAAAAwAREAAAAAAeAAgQAQAAAGUAAABTWU1B
TlRFQ0FOVElWSVJVU0hBVEVJTkVOVklSVVNJTkVJTkVNQU5IQU5HR0VGVU5ERU4sREVOU0lFKFIt
QlVHU0BSLVBST0pFQ1RPUkc8Ui1CVUdTQFItUFJPSkVDVE9SRylBAAAAAAIBfwABAAAAPwAAADxF
OTMwOEMyMUVBMkE0MDRFOUY1Qzk1QkU3OEJCNzUxNDAxQTQxMUBzZXJ2ZXIucGZhcnJhbXQubG9j
YWw+AAASog==

------_=_NextPart_001_01C43483.97C12CB0--

From gs6 at nel-exchange.rutgers.edu  Sat May  8 03:48:53 2004
From: gs6 at nel-exchange.rutgers.edu (gs6@nel-exchange.rutgers.edu)
Date: Sat May  8 03:48:57 2004
Subject: [Rd] Groupshield 6.0 GroupShield Alert (PR#6867)
Message-ID: <20040508014853.D48F1FB9A@slim.kubism.ku.dk>

DLS GroupShield=C2=99 Alert=20

The DLS GroupShield scanner discovered a problem with the following
email. Please re-send the message if you believe that you received this
warning in error, without any attachments..=20

Date/Time sent: 07 May 2004 21:49:27
Subject line: You cannot do that!
From: r-bugs\@r-project.org
To: Liu, Alice
Action taken: Deleted Message
Reason: File Filter
Rule Group: DLSAttach1


This e-mail was scanned with the latest engine and viral signatures from
NAI.



	[[alternative HTML version deleted]]

From arnima at u.washington.edu  Sun May  9 00:30:14 2004
From: arnima at u.washington.edu (arnima@u.washington.edu)
Date: Sun May  9 00:30:16 2004
Subject: [Rd] windows(record=T) loses last plot (PR#3663)
Message-ID: <20040508223014.0088AEDE7@slim.kubism.ku.dk>

The audit trail indicates that PR#3663 is not reproducible and/or fixed,
but I believe windows(record=T) is still not working as documented:

 windows(record=T)
 for(i in 1:5) plot(0, 0, cex=4, pch=as.character(i))

After cycling through the plots with PgUp and PgDn, the user finds out
that plot 5 is lost. Indeed,

 .SavedPlots

reports that only 4 plots were saved. I'm running the example in a fresh R
session, after rm(list=ls(all=T)), quitting, and restarting. I have
reproduced this bug on two machines, one with a fresh R installation.

Thanks,
Arni

OS:       Windows XP
R:        1.9.0
graphics: 1.9.0

From help.desk at mfat.govt.nz  Sun May  9 06:23:12 2004
From: help.desk at mfat.govt.nz (help.desk@mfat.govt.nz)
Date: Sun May  9 06:27:35 2004
Subject: [Rd] RE "Server Error (alan.williams@mfat.govt.nz)"
Message-ID: <04May9.162320nzst.119202@barry.mfat.govt.nz>

A virus is suspected in your Internet content "Server Error (alan.williams@mfat.govt.nz)" sent to alan.williams@mfat.govt.nz on 09/05/2004. Please check and resend.
From wwsprague at ucdavis.edu  Mon May 10 19:33:08 2004
From: wwsprague at ucdavis.edu (Webb Sprague)
Date: Mon May 10 19:35:16 2004
Subject: [Rd] Gmane for list?
Message-ID: <409FBCD4.5090004@ucdavis.edu>

Hi all,

I was wondering if I might subscribe this list to gmane.org, so I (and 
everyone else) might view and search in with a newsreader?

Also--is there any way to get it indexed by google, maybe along with the 
r-help list (or is it already but I haven't found it)?

Thanks for your consideration
W

From p.dalgaard at biostat.ku.dk  Mon May 10 20:43:32 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon May 10 20:48:24 2004
Subject: [Rd] Gmane for list?
In-Reply-To: <409FBCD4.5090004@ucdavis.edu>
References: <409FBCD4.5090004@ucdavis.edu>
Message-ID: <x21xls2kdn.fsf@biostat.ku.dk>

Webb Sprague <wwsprague@ucdavis.edu> writes:

> Hi all,
> 
> I was wondering if I might subscribe this list to gmane.org, so I (and
> everyone else) might view and search in with a newsreader?

This has already happened with R-help (aka gmane.comp.lang.r.general),
without anyone asking (or getting...) permission, and seemingly with
no ill effects. So I suggest that you wait a short while and go ahead
if nobody yells out.
 
> Also--is there any way to get it indexed by google, maybe along with
> the r-help list (or is it already but I haven't found it)?

Try googling for "r-devel HOMEDRIVE". And have a look at

http://tolstoy.newcastle.edu.au/~rking/R/about.html

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From arcane at arcanemethods.com  Mon May 10 21:27:15 2004
From: arcane at arcanemethods.com (Bob Cain)
Date: Mon May 10 21:27:15 2004
Subject: [Rd] Gmane for list?
In-Reply-To: <409FBCD4.5090004@ucdavis.edu>
References: <409FBCD4.5090004@ucdavis.edu>
Message-ID: <409FD793.3040107@arcanemethods.com>



Webb Sprague wrote:

> Hi all,
> 
> I was wondering if I might subscribe this list to gmane.org, so I (and 
> everyone else) might view and search in with a newsreader?
> 
> Also--is there any way to get it indexed by google, maybe along with the 
> r-help list (or is it already but I haven't found it)?
> 

I'd appreciate it for all R groups.  I considered doing it 
myself but when it was suggested that I should get people's 
permission I sorta let it go not having the time for any 
possibly lengthy dialogs.

I also like it that when going via newsreader, responses go 
to to the group rather than the respondee.  That behavior on 
a list nearly always trips me up, it is so uncommon.


Bob
-- 

"Things should be described as simply as possible, but no 
simpler."

                                              A. Einstein

From dmurdoch at pair.com  Mon May 10 21:27:36 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon May 10 21:28:29 2004
Subject: [Rd] windows(record=T) loses last plot (PR#3663)
In-Reply-To: <20040508223014.0088AEDE7@slim.kubism.ku.dk>
References: <20040508223014.0088AEDE7@slim.kubism.ku.dk>
Message-ID: <jhlv901sgvnrkiuruu3g4fngf2hf1hkjuf@4ax.com>

On Sun,  9 May 2004 00:30:14 +0200 (CEST), arnima@u.washington.edu
wrote :

>The audit trail indicates that PR#3663 is not reproducible and/or fixed,
>but I believe windows(record=T) is still not working as documented:
>
> windows(record=T)
> for(i in 1:5) plot(0, 0, cex=4, pch=as.character(i))
>
>After cycling through the plots with PgUp and PgDn, the user finds out
>that plot 5 is lost. Indeed,
>
> .SavedPlots
>
>reports that only 4 plots were saved. I'm running the example in a fresh R
>session, after rm(list=ls(all=T)), quitting, and restarting. I have
>reproduced this bug on two machines, one with a fresh R installation.

I vaguely recall that the issue was that history saving doesn't happen
until drawing to the graph is done.  Since that never happened for the
last one, it doesn't get saved.

A way to fix this would be to implicitly save the graph when
responding to a request to look at a different page.  Another would be
to save a graph as soon as it is created; graphs on the history list
can be modified, and the modifications stick.

Any chance you could track down what patch is necessary?  I'm not
likely to get to it in the next few weeks, and it would be nice to
have this fixed in 1.9.1.

Duncan Murdoch

From dmurdoch at pair.com  Mon May 10 21:35:14 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon May 10 21:35:10 2004
Subject: [Rd] Gmane for list?
In-Reply-To: <409FBCD4.5090004@ucdavis.edu>
References: <409FBCD4.5090004@ucdavis.edu>
Message-ID: <p4mv901mcg7d9o2tp77021j7gv2580pkuh@4ax.com>

On Mon, 10 May 2004 10:33:08 -0700, Webb Sprague
<wwsprague@ucdavis.edu> wrote :

>Hi all,
>
>I was wondering if I might subscribe this list to gmane.org, so I (and 
>everyone else) might view and search in with a newsreader?

The r-help mirroring doesn't seem to have caused any trouble, but you
should ask the list maintainer:  it might be worse than I know.

>Also--is there any way to get it indexed by google, maybe along with the 
>r-help list (or is it already but I haven't found it)?

It is, sort of, in the indexing of the archives.  If you want to
search for something and only see the archives you could use something
like

site:tolstoy.newcastle.edu.au  History

You'll pick up some other stuff too, but mostly you'll see archived
messages.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Mon May 10 22:37:20 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May 10 22:37:29 2004
Subject: [Rd] windows(record=T) loses last plot (PR#3663)
In-Reply-To: <jhlv901sgvnrkiuruu3g4fngf2hf1hkjuf@4ax.com>
Message-ID: <Pine.LNX.4.44.0405102045540.19175-100000@gannet.stats>

The claim in the original report is that it loses the 5,9th etc plot if it 
is the last, but not otherwise.  At one time the example in the report 
worked (but that was a long time ago and there have been extensive 
changes since then.).

The problem was that growing the list changed vDL, and Guido's macros hid 
that.  A simple fix once found ....

On Mon, 10 May 2004, Duncan Murdoch wrote:

> On Sun,  9 May 2004 00:30:14 +0200 (CEST), arnima@u.washington.edu
> wrote :
> 
> >The audit trail indicates that PR#3663 is not reproducible and/or fixed,
> >but I believe windows(record=T) is still not working as documented:
> >
> > windows(record=T)
> > for(i in 1:5) plot(0, 0, cex=4, pch=as.character(i))
> >
> >After cycling through the plots with PgUp and PgDn, the user finds out
> >that plot 5 is lost. Indeed,
> >
> > .SavedPlots
> >
> >reports that only 4 plots were saved. I'm running the example in a fresh R
> >session, after rm(list=ls(all=T)), quitting, and restarting. I have
> >reproduced this bug on two machines, one with a fresh R installation.
> 
> I vaguely recall that the issue was that history saving doesn't happen
> until drawing to the graph is done.  Since that never happened for the
> last one, it doesn't get saved.

That was originally true, but was changed.

> A way to fix this would be to implicitly save the graph when
> responding to a request to look at a different page.  Another would be
> to save a graph as soon as it is created; graphs on the history list
> can be modified, and the modifications stick.
> 
> Any chance you could track down what patch is necessary?  I'm not
> likely to get to it in the next few weeks, and it would be nice to
> have this fixed in 1.9.1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon May 10 22:37:57 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon May 10 22:38:03 2004
Subject: [Rd] windows(record=T) loses last plot (PR#3663)
Message-ID: <20040510203757.4C433EAC1@slim.kubism.ku.dk>

The claim in the original report is that it loses the 5,9th etc plot if it 
is the last, but not otherwise.  At one time the example in the report 
worked (but that was a long time ago and there have been extensive 
changes since then.).

The problem was that growing the list changed vDL, and Guido's macros hid 
that.  A simple fix once found ....

On Mon, 10 May 2004, Duncan Murdoch wrote:

> On Sun,  9 May 2004 00:30:14 +0200 (CEST), arnima@u.washington.edu
> wrote :
> 
> >The audit trail indicates that PR#3663 is not reproducible and/or fixed,
> >but I believe windows(record=T) is still not working as documented:
> >
> > windows(record=T)
> > for(i in 1:5) plot(0, 0, cex=4, pch=as.character(i))
> >
> >After cycling through the plots with PgUp and PgDn, the user finds out
> >that plot 5 is lost. Indeed,
> >
> > .SavedPlots
> >
> >reports that only 4 plots were saved. I'm running the example in a fresh R
> >session, after rm(list=ls(all=T)), quitting, and restarting. I have
> >reproduced this bug on two machines, one with a fresh R installation.
> 
> I vaguely recall that the issue was that history saving doesn't happen
> until drawing to the graph is done.  Since that never happened for the
> last one, it doesn't get saved.

That was originally true, but was changed.

> A way to fix this would be to implicitly save the graph when
> responding to a request to look at a different page.  Another would be
> to save a graph as soon as it is created; graphs on the history list
> can be modified, and the modifications stick.
> 
> Any chance you could track down what patch is necessary?  I'm not
> likely to get to it in the next few weeks, and it would be nice to
> have this fixed in 1.9.1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Tue May 11 09:03:14 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue May 11 09:03:16 2004
Subject: [Rd] Gmane for list?
In-Reply-To: <x21xls2kdn.fsf@biostat.ku.dk>
References: <409FBCD4.5090004@ucdavis.edu>
	<x21xls2kdn.fsf@biostat.ku.dk>
Message-ID: <16544.31410.981627.687137@gargle.gargle.HOWL>

>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>>     on 10 May 2004 20:43:32 +0200 writes:

    PD> Webb Sprague <wwsprague@ucdavis.edu> writes:
    >> Hi all,
    >> 
    >> I was wondering if I might subscribe this list to
    >> gmane.org, so I (and everyone else) might view and search
    >> in with a newsreader?

    PD> This has already happened with R-help (aka
    PD> gmane.comp.lang.r.general), without anyone asking (or
    PD> getting...) permission, 

not quite:  I (as list maintainer) *had* been asked before it
happened -- and I had mentioned it as RFC  to the R core mailing list.

    PD> and seemingly with no ill effects. So I suggest that you
    PD> wait a short while and go ahead if nobody yells out.

yes.  As I had told the person who initiated the R-help -> Gmane 
I think I'd very much want the  mailing list -> News gateway to
be  "ONE WAY" only {and this is an option with gmane}.
Because mail filtering has become quite a delicate (and somewhat
complex) procedure to maintain, I'd rather not have to deal with
mail coming from a news gateway as well, where mail headers may
(or may not) have been pre-processed by the forwarding software.

Yes, please feel free to go ahead!
Martin Maechler

From ggrothendieck at myway.com  Tue May 11 12:57:30 2004
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Tue May 11 12:57:35 2004
Subject: [Rd] Gmane for list?
Message-ID: <20040511105730.117BD39A6@mprdmxin.myway.com>



For me, the main advantage of gmane would be able to post
from it.   If I post from myway the message does not get
threaded properly but if I post from gmane (using the http
interface since I am not always on the same computer) it
works properly.

Thus I would greatly prefer two way.

Note that r-help is currently two way and it seems to
work fine.

(By the way, the gmane http interface has one very annoying
misfeature.   If you attempt to post an R console display where lines
begin with > it complains about top posting and refuses to
send your post.)


---
Date:   Tue, 11 May 2004 09:03:14 +0200 
From:   Martin Maechler <maechler@stat.math.ethz.ch>
To:   Peter Dalgaard <p.dalgaard@biostat.ku.dk> 
Cc:   Webb Sprague <wwsprague@ucdavis.edu>, <r-devel@stat.math.ethz.ch> 
Subject:   Re: [Rd] Gmane for list? 

 
>>>>> "PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
>>>>> on 10 May 2004 20:43:32 +0200 writes:

PD> Webb Sprague <wwsprague@ucdavis.edu> writes:
>> Hi all,
>> 
>> I was wondering if I might subscribe this list to
>> gmane.org, so I (and everyone else) might view and search
>> in with a newsreader?

PD> This has already happened with R-help (aka
PD> gmane.comp.lang.r.general), without anyone asking (or
PD> getting...) permission, 

not quite: I (as list maintainer) *had* been asked before it
happened -- and I had mentioned it as RFC to the R core mailing list.

PD> and seemingly with no ill effects. So I suggest that you
PD> wait a short while and go ahead if nobody yells out.

yes. As I had told the person who initiated the R-help -> Gmane 
I think I'd very much want the mailing list -> News gateway to
be "ONE WAY" only {and this is an option with gmane}.
Because mail filtering has become quite a delicate (and somewhat
complex) procedure to maintain, I'd rather not have to deal with
mail coming from a news gateway as well, where mail headers may
(or may not) have been pre-processed by the forwarding software.

Yes, please feel free to go ahead!
Martin Maechler

From arcane at arcanemethods.com  Tue May 11 17:27:21 2004
From: arcane at arcanemethods.com (Bob Cain)
Date: Tue May 11 17:27:26 2004
Subject: [Rd] Gmane for list?
In-Reply-To: <20040511105730.117BD39A6@mprdmxin.myway.com>
References: <20040511105730.117BD39A6@mprdmxin.myway.com>
Message-ID: <40A0F0D9.6060202@arcanemethods.com>



Gabor Grothendieck wrote:

> 
> For me, the main advantage of gmane would be able to post
> from it.   If I post from myway the message does not get
> threaded properly but if I post from gmane (using the http
> interface since I am not always on the same computer) it
> works properly.
> 
> Thus I would greatly prefer two way.

Yes, me too.  Browse-only pretty much kills the utility of it.


Bob
-- 

"Things should be described as simply as possible, but no 
simpler."

                                              A. Einstein

From wwsprague at ucdavis.edu  Tue May 11 18:05:38 2004
From: wwsprague at ucdavis.edu (wwsprague@ucdavis.edu)
Date: Tue May 11 18:11:10 2004
Subject: [Rd] Gmane for list?
In-Reply-To: <16544.31410.981627.687137@gargle.gargle.HOWL>
References: <409FBCD4.5090004@ucdavis.edu>	<x21xls2kdn.fsf@biostat.ku.dk>
	<16544.31410.981627.687137@gargle.gargle.HOWL>
Message-ID: <c7qtkf$2hk$1@sea.gmane.org>

Martin Maechler wrote:
 >>>>>>"PD" == Peter Dalgaard <p.dalgaard@biostat.ku.dk>
 >>>>>>    on 10 May 2004 20:43:32 +0200 writes:
 >
 >
 >     PD> Webb Sprague <wwsprague@ucdavis.edu> writes:

Well, here we are on gmane.  If anybody wants the settings altered, 
please email me directly unless it is easiest to do it yourself.  Though 
only a developer-voyeur (now), I am happy to take responsibility for the 
  gmane experiment.

W

From bolker at zoo.ufl.edu  Tue May 11 22:25:39 2004
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue May 11 22:04:37 2004
Subject: [Rd] bad interaction between RandomFields 1.1.11 and Sweave
Message-ID: <Pine.LNX.4.44.0405111604570.26648-100000@bolker.zoo.ufl.edu>


  Not really a bug (I eventually discovered), but ...
  When running GaussRF()/DoSimulateRF() with n>1, the default pch="!" 
prints backspaces to the terminal, which causes problems (LaTeX barfs) if 
you're running this within an Sweave() job.  Setting RFparameters(pch="") 
fixes the problem.  
   Could put this in the documentation, but I don't know where you could 
put it that it would attract attention -- wouldn't have occurred to me to 
look at RFparameters before poking through the code to see where the ^H 
was coming from.
  
  I was going to suggest testing interactive() to see if the code was 
running in batch mode or not, but I just tried that with Sweave() and it 
thinks that interactive() is TRUE when running Sweave.  Oh well.  
Any one else have a solution?

  Ben Bolker

-- 
620B Bartram Hall                            bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704

From webmastv at mail.x-echo.com  Wed May 12 08:55:26 2004
From: webmastv at mail.x-echo.com (webmastv@mail.x-echo.com)
Date: Wed May 12 08:55:32 2004
Subject: [Rd] Re: Important notify about your e-mail account.
In-Reply-To: <wstvncqitfeogxfyjbq@voila.fr>
References: <wstvncqitfeogxfyjbq@voila.fr>
Message-ID: <200405120655.IAA16497@mail.x-echo.com>

Bonjour,

Afin que votre demande puisse ?tre prise en compte, nous vous
remercions de bien vouloir nous contacter d?sormais ?
l'adresse contact@voila.net.

Merci de votre compr?hension.

Le Service Utilisateurs de Voila.fr.

From schlather at cu.lu  Wed May 12 10:15:17 2004
From: schlather at cu.lu (Martin Schlather)
Date: Wed May 12 09:00:50 2004
Subject: [Rd] Re: bad interaction between RandomFields 1.1.11 and Sweave
In-Reply-To: <Pine.LNX.4.44.0405111604570.26648-100000@bolker.zoo.ufl.edu>
References: <Pine.LNX.4.44.0405111604570.26648-100000@bolker.zoo.ufl.edu>
Message-ID: <40A1DD15.3020809@cu.lu>


Dear Ben,

I do not know how to solve the general problem that backspaces
cause within Sweave, but which are needed to implement running
counters.

To avoid the specific problems for RandomFields, a new version
of RandomFields is uploaded with default "pch="*" instead of
pch="!".

Cheers,
Martin

Ben Bolker wrote:

>  Not really a bug (I eventually discovered), but ...
>  When running GaussRF()/DoSimulateRF() with n>1, the default pch="!" 
>prints backspaces to the terminal, which causes problems (LaTeX barfs) if 
>you're running this within an Sweave() job.  Setting RFparameters(pch="") 
>fixes the problem.  
>   Could put this in the documentation, but I don't know where you could 
>put it that it would attract attention -- wouldn't have occurred to me to 
>look at RFparameters before poking through the code to see where the ^H 
>was coming from.
>  
>  I was going to suggest testing interactive() to see if the code was 
>running in batch mode or not, but I just tried that with Sweave() and it 
>thinks that interactive() is TRUE when running Sweave.  Oh well.  
>Any one else have a solution?
>
>  Ben Bolker
>
>  
>


-- 
Martin Schlather
Universite du Luxembourg
Faculte des Sciences, de la Technologie et de la Communication
Laboratoire de Mathematiques
162 A, av. de la Faiencerie
L -- 1511 Luxembourg

email: schlather@cu.lu         http://www.cu.lu/~schlathe/
phone: +352 466644 642         Fax : +352 466644 513

From maechler at stat.math.ethz.ch  Wed May 12 09:24:55 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed May 12 09:25:00 2004
Subject: [Rd] stdout == 'Terminal' or 'File' {was 'bad interaction ...'}
In-Reply-To: <40A1DD15.3020809@cu.lu>
References: <Pine.LNX.4.44.0405111604570.26648-100000@bolker.zoo.ufl.edu>
	<40A1DD15.3020809@cu.lu>
Message-ID: <16545.53575.897894.285835@gargle.gargle.HOWL>

>>>>> "MartinS" == Martin Schlather <schlather@cu.lu>
>>>>>     on Wed, 12 May 2004 09:15:17 +0100 writes:

    MartinS> Dear Ben,

    MartinS> I do not know how to solve the general problem that
    MartinS> backspaces cause within Sweave, but which are
    MartinS> needed to implement running counters.

aha!  now I understand more what you are talking about.

This is a more interesting problem, in general: It's not quite a
matter of if(interactive()) that Ben tried, but really you want
to find out if the stdout() connection you are using is a normal file
(where you don't need or want a running counter) or a 
user terminal where Martin Schlather applied the  1^H2^H... ('1' Backspace
'2' Backspace ..) trick.

Any ideas what can be done here, using our current  connection
tools -- or is there the need for something new?
Interesting topic!

Martin M?chler

PS. I know that strictly speaking the subject question is
 non-sense, since, at least on Unix-alikes, a console is a
 special file as well, and stdout is always a file.

From ripley at stats.ox.ac.uk  Wed May 12 10:04:05 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 12 10:04:13 2004
Subject: [Rd] stdout == 'Terminal' or 'File' {was 'bad interaction ...'}
In-Reply-To: <16545.53575.897894.285835@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.44.0405120854140.16123-100000@gannet.stats>

First, on an R console, stdout() is normally neither a `normal file' nor a 
`user terminal'.  Let alone under an embedded R ... or use under ESS
(where for you, Martin, it is neither).

On vanilla R under Unix-alikes (and Rterm but not otherwise) what stdout
is is a function of the C runtime system.  It's up to the C system if it
tells you what stdout has been redirected to, and if it can tell you
whether it is a terminal, or a pty (as used under some versions of Emacs) 
or a file or a socket ....  The information is at best unreliable.

interactive() is as good a test as we have, and I think if a better test 
is required in the interactive case, the user should be asked.


On Wed, 12 May 2004, Martin Maechler wrote:

> >>>>> "MartinS" == Martin Schlather <schlather@cu.lu>
> >>>>>     on Wed, 12 May 2004 09:15:17 +0100 writes:
> 
>     MartinS> Dear Ben,
> 
>     MartinS> I do not know how to solve the general problem that
>     MartinS> backspaces cause within Sweave, but which are
>     MartinS> needed to implement running counters.
> 
> aha!  now I understand more what you are talking about.
> 
> This is a more interesting problem, in general: It's not quite a
> matter of if(interactive()) that Ben tried, but really you want
> to find out if the stdout() connection you are using is a normal file
> (where you don't need or want a running counter) or a 
> user terminal where Martin Schlather applied the  1^H2^H... ('1' Backspace
> '2' Backspace ..) trick.
> 
> Any ideas what can be done here, using our current  connection
> tools -- or is there the need for something new?
> Interesting topic!
> 
> Martin M?chler
> 
> PS. I know that strictly speaking the subject question is
>  non-sense, since, at least on Unix-alikes, a console is a
>  special file as well, and stdout is always a file.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Wed May 12 11:23:56 2004
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed May 12 11:23:59 2004
Subject: [Rd] stdout == 'Terminal' or 'File' {was 'bad interaction ...'}
In-Reply-To: <Pine.LNX.4.44.0405120854140.16123-100000@gannet.stats>
References: <16545.53575.897894.285835@gargle.gargle.HOWL>
	<Pine.LNX.4.44.0405120854140.16123-100000@gannet.stats>
Message-ID: <16545.60716.856405.794704@gargle.gargle.HOWL>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Wed, 12 May 2004 09:04:05 +0100 (BST) writes:

    BDR> First, on an R console, stdout() is normally neither a
    BDR> `normal file' nor a `user terminal'.  

strictly yes, but that was not the point.
I have been looking for an API we could use to find some useful
information, and the original topic was about Sweave where
there will a file {when in normal use}.

    BDR> Let alone under an embedded R ... or use under ESS (where for you,
    BDR> Martin, it is neither).

well, I knew this, but ESS (i.e. 'comint' in Emacs) is quite
good at behaving like a user terminal in many situations;
e.g the 'scp' (secure copy) "visual counter" works very nicely
in Emacs' *shell* buffers.

    BDR> On vanilla R under Unix-alikes (and Rterm but not
    BDR> otherwise) what stdout is is a function of the C
    BDR> runtime system.  It's up to the C system if it tells
    BDR> you what stdout has been redirected to, and if it can
    BDR> tell you whether it is a terminal, or a pty (as used
    BDR> under some versions of Emacs) or a file or a socket
    BDR> ....  The information is at best unreliable.

ok; that (the unreliabilty of the info you get) is bad news.
Thank you for the clarification.

    BDR> interactive() is as good a test as we have, and I think
    BDR> if a better test is required in the interactive case,
    BDR> the user should be asked.

we can live with that, but I think other softwares at least try
to do better here.

------------------

A completely different way, less nice in several ways, but maybe
more reliable:  There's a workaround we could start using here:
ESS has been setting
     options(STERM= ...)
for a while now to indicate to the S process which kind of
"terminal" (excuse the term) it is running in.

The ESS manual currently contains

>> Is the Statistical Process running under ESS?
>> =============================================
>> 
>>    For the S languages (S, S-Plus, R) ESS sets an option in the current
>> process that programs in the language can check to determine the
>> environment in which they are currently running.
>> 
>>    ESS sets `options(STERM="iESS")' for S language processes running in
>> an inferior `iESS[S]' or `iESS[R]' buffer.
>> 
>>    ESS sets `options(STERM="ddeESS")' for independent S-Plus for Windows
>> processes running in the GUI and communicating with ESS via the DDE
>> (Microsoft Dynamic Data Exchange) protocol through a `ddeESS[S]' buffer.
>> 
>>    Other values of `options()$STERM' that we recommend are:
>> 
>>    * `length':     Fixed length xterm or telnet window.
>> 
>>    * `scrollable': Unlimited length xterm or telnet window.
>> 
>>    * `server':     S-Plus Stat Server.
>> 
>>    * `BATCH':      BATCH.
>> 
>>    * `Rgui':       R GUI.
>> 
>>    * `Commands':   S-Plus GUI without DDE interface to ESS.
>> 
>>    Additional values may be recommended in the future as new interaction
>> protocols are created.  Unlike the values `iESS' and `ddeESS', ESS
>> can't set these other values since the S language program is not under
>> the control of ESS.

and maybe we (R developers) should also consider setting some of
these (e.g. STERM = "Rgui" in that case) -- at least when the
info is available (and somewhat reliable) and even better think
about what else (better) could be done, working with  options()
settings as a workaround for this problem.

Also (for the original topic), maybe  Sweave() could set
options(STERM = 'Sweave') if options(STERM = 'BATCH) is not good
enough.  Then, code like Martin Schlather's use
      switch(getOption("STERM"), 
             "BATCH" =  { .........},
	     ....
	     )

    BDR> On Wed, 12 May 2004, Martin Maechler wrote:

    >> >>>>> "MartinS" == Martin Schlather <schlather@cu.lu>
    >> >>>>> on Wed, 12 May 2004 09:15:17 +0100 writes:
    >> 
    MartinS> Dear Ben,
    >>
    MartinS> I do not know how to solve the general problem that
    MartinS> backspaces cause within Sweave, but which are
    MartinS> needed to implement running counters.
    >>  aha!  now I understand more what you are talking about.
    >> 
    >> This is a more interesting problem, in general: It's not
    >> quite a matter of if(interactive()) that Ben tried, but
    >> really you want to find out if the stdout() connection
    >> you are using is a normal file (where you don't need or
    >> want a running counter) or a user terminal where Martin
    >> Schlather applied the 1^H2^H... ('1' Backspace '2'
    >> Backspace ..) trick.
    >> 
    >> Any ideas what can be done here, using our current
    >> connection tools -- or is there the need for something
    >> new?  Interesting topic!
    >> 
    >> Martin M?chler
    >> 
    >> PS. I know that strictly speaking the subject question is
    >> non-sense, since, at least on Unix-alikes, a console is a
    >> special file as well, and stdout is always a file.

    BDR> -- Brian D. Ripley, ripley@stats.ox.ac.uk Professor of
    BDR> Applied Statistics, http://www.stats.ox.ac.uk/~ripley/
    BDR> University of Oxford, Tel: +44 1865 272861 (self) 1
    BDR> South Parks Road, +44 1865 272866 (PA) Oxford OX1 3TG,
    BDR> UK Fax: +44 1865 272595

From Friedrich.Leisch at ci.tuwien.ac.at  Wed May 12 11:36:58 2004
From: Friedrich.Leisch at ci.tuwien.ac.at (Friedrich.Leisch@ci.tuwien.ac.at)
Date: Wed May 12 11:37:05 2004
Subject: [Rd] stdout == 'Terminal' or 'File' {was 'bad interaction ...'}
In-Reply-To: <16545.60716.856405.794704@gargle.gargle.HOWL>
References: <16545.53575.897894.285835@gargle.gargle.HOWL>
	<Pine.LNX.4.44.0405120854140.16123-100000@gannet.stats>
	<16545.60716.856405.794704@gargle.gargle.HOWL>
Message-ID: <16545.61498.436669.619802@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 May 2004 11:23:56 +0200,
>>>>> Martin Maechler (MM) wrote:


  > and maybe we (R developers) should also consider setting some of
  > these (e.g. STERM = "Rgui" in that case) -- at least when the
  > info is available (and somewhat reliable) and even better think
  > about what else (better) could be done, working with  options()
  > settings as a workaround for this problem.

yes

  > Also (for the original topic), maybe  Sweave() could set
  > options(STERM = 'Sweave')

fine with me, but ...

  > if options(STERM = 'BATCH) is not good
  > enough.  Then, code like Martin Schlather's use
  >       switch(getOption("STERM"), 
  >              "BATCH" =  { .........},
  > 	     ....
  > 	     )

... for applications like this we might want to keep the list of
possible "terminals" as short as possible (and of course as long as
necessary), so we should come up with a list of possible typoes and
then try to set the option wherever necessary.

.f

From Simon.Urbanek at math.uni-augsburg.de  Wed May 12 11:47:49 2004
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Wed May 12 11:47:59 2004
Subject: R_Interactive {was '[Rd] stdout == 'Terminal' or 'File'}
In-Reply-To: <Pine.LNX.4.44.0405120854140.16123-100000@gannet.stats>
References: <Pine.LNX.4.44.0405120854140.16123-100000@gannet.stats>
Message-ID: <6DDCCDCC-A3F9-11D8-B41D-000A957CEFBA@math.uni-augsburg.de>

while the topic is on, something remotely related although the same:

On May 12, 2004, at 10:04 AM, Prof Brian Ripley wrote:

> interactive() is as good a test as we have, and I think if a better 
> test
> is required in the interactive case, the user should be asked.

There may be a little problem in the current sources (talking unix for 
now) - R sets the interactive flag like this:

system.c@248:    R_Interactive = isatty(0);

Unfortunately right after this there comes:

if (!R_Interactive && SaveAction != SA_SAVE && SaveAction != SA_NOSAVE)
    R_Suicide("you must specify `--save', `--no-save' or `--vanilla'");

Now speaking of embedded R - the above leaves (afaik) no way of telling 
R to use interactive mode before this suicide attempt if stdout is no 
tty (it doesn't have to if the embedding app provides its own 
Read/WriteConsole etc.). Any thoughts on this? (btw: aqua uses a hack 
to circumvent this... whenever aqua needs a hack it may be worth 
thinking about something more general ;))

Cheers,
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From ripley at stats.ox.ac.uk  Wed May 12 12:16:32 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 12 12:16:47 2004
Subject: R_Interactive {was '[Rd] stdout == 'Terminal' or 'File'}
In-Reply-To: <6DDCCDCC-A3F9-11D8-B41D-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <Pine.LNX.4.44.0405121058540.16520-100000@gannet.stats>

On Wed, 12 May 2004, Simon Urbanek wrote:

> while the topic is on, something remotely related although the same:
> 
> On May 12, 2004, at 10:04 AM, Prof Brian Ripley wrote:
> 
> > interactive() is as good a test as we have, and I think if a better 
> > test
> > is required in the interactive case, the user should be asked.
> 
> There may be a little problem in the current sources (talking unix for 
> now) - R sets the interactive flag like this:
> 
> system.c@248:    R_Interactive = isatty(0);
> 
> Unfortunately right after this there comes:
> 
> if (!R_Interactive && SaveAction != SA_SAVE && SaveAction != SA_NOSAVE)
>     R_Suicide("you must specify `--save', `--no-save' or `--vanilla'");
> 
> Now speaking of embedded R - the above leaves (afaik) no way of telling 
> R to use interactive mode before this suicide attempt if stdout is no 
> tty (it doesn't have to if the embedding app provides its own 
> Read/WriteConsole etc.). Any thoughts on this? (btw: aqua uses a hack 
> to circumvent this... whenever aqua needs a hack it may be worth 
> thinking about something more general ;))

Not R per se, but the Unix front-end in Rf_initialize_R, which is a hack
from the terminal-like Unix front-end. As in the comment

    /* On Unix the console is a file; we just use stdio to write on it */

An embedding application can (and probably should) set argv when it calls
Rf_initEmbeddedR, or it can call its own version of Rf_initialize_R (which
is what happens under Windows).

BTW, this is in the process of being broken up (and aqua and gnome 
support moved to Rmain.c) so it is a good time for a better solution.
OTOH, it is not particularly good to break the API of which 
Rf_initialize_R is probably considered part.

I agree with your comment about aqua, but then those of us not using Raqua 
are often unaware of the hacks which have been used.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From wolski at molgen.mpg.de  Wed May 12 15:00:22 2004
From: wolski at molgen.mpg.de (wolski@molgen.mpg.de)
Date: Wed May 12 15:00:25 2004
Subject: [Rd] Problem with plot (PR#6875)
Message-ID: <20040512130022.F0625104CE@slim.kubism.ku.dk>

Hi!

Pinned the problem with plot down a bit. I can reproduce it with only 2 lines of R on my Windows XP machine.
(today reinstalled R1.9.0) and Bioconductor packages updated. 
Can anyone reproduce this behaviour?
(I am surely reproducing this error only if library(ROC) is loaded at the beginning of the session.)

z:\devel\Paper2004\patrick3>Rterm

R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.0  (2004-04-12), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> ls()
character(0)
> library(ROC)
> plot(hist(1:10,plot=F))
Error in xy.coords(x, y, xlabel, ylabel, log) :
        x and y lengths differ


I was trying to reproduce the error under Debion linux. There I do not get such an error.


Eryk.

From ligges at statistik.uni-dortmund.de  Wed May 12 15:42:35 2004
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Wed May 12 15:42:37 2004
Subject: [Rd] Problem with plot (PR#6875)
Message-ID: <20040512134235.0EA031041E@slim.kubism.ku.dk>

wolski@molgen.mpg.de wrote:

> Hi!
> 
> Pinned the problem with plot down a bit. I can reproduce it with only 2 lines of R on my Windows XP machine.
> (today reinstalled R1.9.0) and Bioconductor packages updated. 
> Can anyone reproduce this behaviour?
> (I am surely reproducing this error only if library(ROC) is loaded at the beginning of the session.)
> 
> z:\devel\Paper2004\patrick3>Rterm
> 
> R : Copyright 2004, The R Foundation for Statistical Computing
> Version 1.9.0  (2004-04-12), ISBN 3-900051-00-3
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
> 
> 
>>ls()
> 
> character(0)
> 
>>library(ROC)
>>plot(hist(1:10,plot=F))
> 
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>         x and y lengths differ
> 
> 
> I was trying to reproduce the error under Debion linux. There I do not get such an error.
> 
> 
> Eryk.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel


So not a bug in R. Why did you submit a bug report?
Note that it works with ROC-1.0.10, hence the bug is obviously fixed in 
recent versions of ROC.

Uwe Ligges

From maechler at stat.math.ethz.ch  Wed May 12 16:05:45 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed May 12 16:05:47 2004
Subject: [Rd] points(*, pch=NA) does *not* not draw the point (PR#6876)
Message-ID: <20040512140545.300C8EDF1@slim.kubism.ku.dk>

We say in ?points  that 'pch' (among others) can be set to NA
for omitting a point.

While this works in cases where there's at least one point left
to draw, it fails in a simple case like this :

> plot(1, pch = NA)
Error in plot.xy(xy.coords(x, y), type = type, pch = pch, col = col, bg = bg,  : 
	invalid plotting symbol

Both in R-patched or R-devel.
A simple workaround {hinting at how to fix the C code} is

> plot(1, pch = as.integer(NA))

So this is easily fixable (and I'll commit a patch soon).

----

A bit more problematic *) but not a bug in a very strict sense
is the following : 

 > plot(1, pch = as.character(NA))
and
 > plot(1:4, pch=c("o",".", NA, "x"))

which are identical to

 > plot(1, pch = "N")
and
 > plot(1:4, pch=c("o",".", "N", "x"))

but should either produce a warning (additional to using "N") or
rather also treat the NA as "missing", i.e., not drawing a point.


Martin Maechler


---------------
*) because this isn't spotted when used in a context of
   plotting many things

From ripley at stats.ox.ac.uk  Wed May 12 16:20:56 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 12 16:21:00 2004
Subject: [Rd] points(*, pch=NA) does *not* not draw the point (PR#6876)
In-Reply-To: <20040512140545.300C8EDF1@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405121511140.16934-100000@gannet.stats>

On Wed, 12 May 2004 maechler@stat.math.ethz.ch wrote:

> We say in ?points  that 'pch' (among others) can be set to NA
> for omitting a point.

I don't think we actually do.  We say 

     Points whose 'x', 'y', 'pch', 'col' or 'cex' value is 'NA' are
     omitted from the plot.

and earlier

     either be a 'character' or an integer code

I read that to mean that as.logical(NA) is incorrect, but that 
as.character(NA) is correct and should result in the point being omitted.

In short, I disagree as to which is a very strict bug (although it makes 
sense to allow logical NAs, of course).

The problems are both in FixupPch in src/main/plot.c.  Can I leave you to 
fix both?

> While this works in cases where there's at least one point left
> to draw, it fails in a simple case like this :
> 
> > plot(1, pch = NA)
> Error in plot.xy(xy.coords(x, y), type = type, pch = pch, col = col, bg = bg,  : 
> 	invalid plotting symbol
> 
> Both in R-patched or R-devel.
> A simple workaround {hinting at how to fix the C code} is
> 
> > plot(1, pch = as.integer(NA))
> 
> So this is easily fixable (and I'll commit a patch soon).
> 
> ----
> 
> A bit more problematic *) but not a bug in a very strict sense
> is the following : 
> 
>  > plot(1, pch = as.character(NA))
> and
>  > plot(1:4, pch=c("o",".", NA, "x"))
> 
> which are identical to
> 
>  > plot(1, pch = "N")
> and
>  > plot(1:4, pch=c("o",".", "N", "x"))
> 
> but should either produce a warning (additional to using "N") or
> rather also treat the NA as "missing", i.e., not drawing a point.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Wed May 12 16:34:47 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed May 12 16:34:51 2004
Subject: [Rd] points(*, pch=NA) does *not* not draw the point (PR#6876)
Message-ID: <20040512143447.B6063104CD@slim.kubism.ku.dk>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Wed, 12 May 2004 15:20:56 +0100 (BST) writes:

    BDR> On Wed, 12 May 2004 maechler@stat.math.ethz.ch wrote:
    >> We say in ?points that 'pch' (among others) can be set to
    >> NA for omitting a point.

    BDR> I don't think we actually do.  We say

    BDR>      Points whose 'x', 'y', 'pch', 'col' or 'cex' value
    BDR> is 'NA' are omitted from the plot.

    BDR> and earlier

    BDR>      either be a 'character' or an integer code

    BDR> I read that to mean that as.logical(NA) is incorrect,
    BDR> but that as.character(NA) is correct and should result
    BDR> in the point being omitted.

    BDR> In short, I disagree as to which is a very strict bug
    BDR> (although it makes sense to allow logical NAs, of
    BDR> course).

You're right, with both statements.

    BDR> The problems are both in FixupPch in src/main/plot.c.
    BDR> Can I leave you to fix both?

yes, I've been in there anyway.

There's one remaining design decision:

At the moment I'd go to allow 'logical' and coerce that to
integer (as in many other S code places).  
Alternatively, more strict behavior would only allow NA logicals
and give an error for TRUE or FALSE entries in pch vectors.
I currently think it's not worth the extra check.

    >> While this works in cases where there's at least one
    >> point left to draw, it fails in a simple case like this :
    >> 
    >> > plot(1, pch = NA) Error in plot.xy(xy.coords(x, y),
    >> type = type, pch = pch, col = col, bg = bg, : invalid
    >> plotting symbol
    >> 
    >> Both in R-patched or R-devel.  A simple workaround
    >> {hinting at how to fix the C code} is
    >> 
    >> > plot(1, pch = as.integer(NA))
    >> 
    >> So this is easily fixable (and I'll commit a patch soon).
    >> 
    >> ----
    >> 
    >> A bit more problematic *) but not a bug in a very strict
    >> sense is the following :
    >> 
    >> > plot(1, pch = as.character(NA)) and > plot(1:4,
    >> pch=c("o",".", NA, "x"))
    >> 
    >> which are identical to
    >> 
    >> > plot(1, pch = "N") and > plot(1:4, pch=c("o",".", "N",
    >> "x"))
    >> 
    >> but should either produce a warning (additional to using
    >> "N") or rather also treat the NA as "missing", i.e., not
    >> drawing a point.

From ripley at stats.ox.ac.uk  Wed May 12 16:45:49 2004
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed May 12 16:45:52 2004
Subject: [Rd] points(*, pch=NA) does *not* not draw the point (PR#6876)
Message-ID: <20040512144549.DB333104B6@slim.kubism.ku.dk>

On Wed, 12 May 2004, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
> >>>>>     on Wed, 12 May 2004 15:20:56 +0100 (BST) writes:
> 
>     BDR> On Wed, 12 May 2004 maechler@stat.math.ethz.ch wrote:
>     >> We say in ?points that 'pch' (among others) can be set to
>     >> NA for omitting a point.
> 
>     BDR> I don't think we actually do.  We say
> 
>     BDR>      Points whose 'x', 'y', 'pch', 'col' or 'cex' value
>     BDR> is 'NA' are omitted from the plot.
> 
>     BDR> and earlier
> 
>     BDR>      either be a 'character' or an integer code
> 
>     BDR> I read that to mean that as.logical(NA) is incorrect,
>     BDR> but that as.character(NA) is correct and should result
>     BDR> in the point being omitted.
> 
>     BDR> In short, I disagree as to which is a very strict bug
>     BDR> (although it makes sense to allow logical NAs, of
>     BDR> course).
> 
> You're right, with both statements.
> 
>     BDR> The problems are both in FixupPch in src/main/plot.c.
>     BDR> Can I leave you to fix both?
> 
> yes, I've been in there anyway.
> 
> There's one remaining design decision:
> 
> At the moment I'd go to allow 'logical' and coerce that to
> integer (as in many other S code places).  
> Alternatively, more strict behavior would only allow NA logicals
> and give an error for TRUE or FALSE entries in pch vectors.
> I currently think it's not worth the extra check.

Here it probably makes more sense to coerce to character, and given the 
ambiguity I would allow only an all-NA logical vector.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Wed May 12 17:59:23 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed May 12 17:59:26 2004
Subject: [Rd] points(*, pch=NA) does *not* not draw the point (PR#6876)
Message-ID: <20040512155923.AA13D104B6@slim.kubism.ku.dk>

>>>>> "BDR" == Brian D Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Wed, 12 May 2004 16:45:49 +0200 (CEST) writes:

    BDR> On Wed, 12 May 2004, Martin Maechler wrote:

   ...... 

    >> There's one remaining design decision:
    >> 
    >> At the moment I'd go to allow 'logical' and coerce that
    >> to integer (as in many other S code places).
    >> Alternatively, more strict behavior would only allow NA
    >> logicals and give an error for TRUE or FALSE entries in
    >> pch vectors.  I currently think it's not worth the extra
    >> check.

    BDR> Here it probably makes more sense to coerce to
    BDR> character, and given the ambiguity I would allow only
    BDR> an all-NA logical vector.

Ok, I've just committed this (and tests for it) to R-patched and
R-devel.

Bug closed.

Martin

From wolfda at ornl.gov  Wed May 12 20:56:06 2004
From: wolfda at ornl.gov (wolfda@ornl.gov)
Date: Wed May 12 20:56:10 2004
Subject: [Rd] convert.times in chron, error when 59 < seconds < 60 (PR#6878)
Message-ID: <20040512185606.F041E104CE@slim.kubism.ku.dk>

Full_Name: Dennis Wolf
Version: 1.9.0
OS: Mac OS 10.3.3
Submission from: (NULL) (160.91.76.23)


platform powerpc-apple-darwin6.8
arch     powerpc                
os       darwin6.8              
system   powerpc, darwin6.8     
status                          
major    1                      
minor    9.0                    
year     2004                   
month    04                     
day      12                     
language R                      



                Information on Package 'chron'

Description:

Package: chron
Version: 2.2-29
Date: 2004-01-31
Author: S original by David James <dj@research.bell-labs.com>, R port
        by Kurt Hornik <Kurt.Hornik@R-project.org>.
Maintainer: Kurt Hornik <Kurt.Hornik@R-project.org>
Description: Chronological objects which can handle dates and times
Title: Chronological objects which can handle dates and times
Depends: R (>= 1.6.0)
License: GPL
Packaged: Sat Jan 31 13:31:05 2004; hornik
Built: R 1.9.0; powerpc-apple-darwin6.8; 2004-04-15 01:23:51; unix

> library(chron)
> convert.times("20:27:58.6")
[1] 0.8527616
> convert.times("20:27:59.1")
[1] NA
Warning message: 
time-of-day entries out of range in positions 1 set to NA in:
convert.times("20:27:59.1") 
> 

The fix appears to be to replace:

    i <- (hh[ok] < 0 | hh[ok] > 23 | mm[ok] < 0 | mm[ok] > 59 |
        ss[ok] < 0 | ss[ok] > 59)

with:

    i <- (hh[ok] < 0 | hh[ok] > 23 | mm[ok] < 0 | mm[ok] > 59 |
        ss[ok] < 0 | ss[ok] >= 60)

in code for convert.times

From ch-r at bobobeach.com  Thu May 13 20:56:05 2004
From: ch-r at bobobeach.com (ch-r@bobobeach.com)
Date: Thu May 13 20:56:10 2004
Subject: [Rd] Darwin Framework and Application Install Directory
	Improvements (PR#6882)
Message-ID: <20040513185605.B98C110537@slim.kubism.ku.dk>

Full_Name: Cyrus Harmon
Version: 1.9.0
OS: MacOS X 10.3
Submission from: (NULL) (169.229.10.50)


R_FRAMEWORK_DIR should default to $(prefix)/Libraries/R.framework and there
should be a new directory to put R.app in like $(prefix)/Applications. The
following patch does this:

===================================================================
RCS file: Makeconf.in,v
retrieving revision 1.1
diff -r1.1 Makeconf.in
63c63,64
< R_FRAMEWORK_DIR = $(prefix)/R.framework
---
> R_FRAMEWORK_DIR = $(prefix)/Libraries/R.framework
> R_APPLICATION_DIR = $(prefix)/Applications/

===================================================================
RCS file: Makefile.in,v
retrieving revision 1.1
diff -r1.1 Makefile.in
204,205c204,205
<       @(rm -rf /Applications/R.app)
<       @(mkdir -p /Applications/R.app/Contents/Resources)
---
>       @(rm -rf $(R_APPLICATION_DIR)/R.app)
>       @(mkdir -p $(R_APPLICATION_DIR)/R.app/Contents/Resources)
207c207
<         cp PkgInfo /Applications/R.app/Contents)
---
>         cp PkgInfo $(R_APPLICATION_DIR)/R.app/Contents)
209c209
<         cp Info.plist  /Applications/R.app/Contents)
---
>         cp Info.plist  $(R_APPLICATION_DIR)/R.app/Contents)
211,212c211,212
<         cp -R * /Applications/R.app/Contents/Resources)
<       @(mkdir -p /Applications/R.app/Contents/MacOS)
---
>         cp -R * $(R_APPLICATION_DIR)/R.app/Contents/Resources)
>       @(mkdir -p $(R_APPLICATION_DIR)/R.app/Contents/MacOS)
215c215
<       @(cd /Applications/R.app/Contents/MacOS && \
---
>       @(cd $(R_APPLICATION_DIR)/R.app/Contents/MacOS && \

From garvin at cs.rice.edu  Thu May 13 23:21:26 2004
From: garvin at cs.rice.edu (garvin@cs.rice.edu)
Date: Thu May 13 23:21:31 2004
Subject: [Rd] Rprof ignores top-level computation (PR#6883)
Message-ID: <20040513212126.F2C3210566@slim.kubism.ku.dk>

Full_Name: John Garvin
Version: 1.9.0
OS: Linux
Submission from: (NULL) (128.42.129.78)


This may or may not technically be a bug, but it's certainly an annoyance.

Rprof only takes into account computation that occurs inside functions. If a
time-consuming operation occurs outside a function, it doesn't record the time
it takes. Consider this program 'array.r':

Rprof()
foo <- array(1:1000000, dim=c(100,50,200))
bar <- c(1:1000, dim=c(1000000,3))
for (i in 1:100) {
  foo[bar>42] <- foo[bar>42]
}
Rprof(NULL)

Here's a comparison of the running time measured through the OS and the time
measured by Rprof:

$ time R --slave < array.r

real    0m16.068s
user    0m14.060s
sys     0m1.550s
$ R CMD Rprof Rprof.out
 
Each sample represents 0.02 seconds.
Total run time: 0.12 seconds.
 
Total seconds: time spent in function and callees.
Self seconds: time spent in function alone.
 
   %       total       %       self
 total    seconds     self    seconds    name
 66.67      0.08     66.67      0.08     "as.vector"
 66.67      0.08      0.00      0.00     "array"
 33.33      0.04     33.33      0.04     ">"
 
   %       self        %       total
 self     seconds    total    seconds    name
 66.67      0.08     66.67      0.08     "as.vector"
 33.33      0.04     33.33      0.04     ">"

Rprof gives a much more sensible result when the same code is wrapped in a
function definition, like this:

Rprof()
f <- function() {
  foo <- array(1:1000000, dim=c(100,50,200))
  bar <- c(1:1000, dim=c(1000000,3))
  for (i in 1:100) {
    foo[bar>42] <- foo[bar>42]
  }
}
f()
Rprof(NULL)

$ time R --slave < array.r
 
real    0m16.436s
user    0m14.110s
sys     0m1.490s
$ R CMD Rprof Rprof.out
 
Each sample represents 0.02 seconds.
Total run time: 14.4799999999998 seconds.
 
Total seconds: time spent in function and callees.
Self seconds: time spent in function alone.
 
   %       total       %       self
 total    seconds     self    seconds    name
100.00     14.48     99.17     14.36     "f"
  0.55      0.08      0.55      0.08     "as.vector"
  0.55      0.08      0.00      0.00     "array"
  0.28      0.04      0.28      0.04     ">"
 
   %       self        %       total
 self     seconds    total    seconds    name
 99.17     14.36    100.00     14.48     "f"
  0.55      0.08      0.55      0.08     "as.vector"
  0.28      0.04      0.28      0.04     ">"

All that time disappears when the code is not in a function. Rprof may have been
written to work that way--I don't know--but in any case its results with certain
inputs are pretty misleading.

From stefano.iacus at unimi.it  Fri May 14 01:23:04 2004
From: stefano.iacus at unimi.it (stefano iacus)
Date: Fri May 14 01:23:08 2004
Subject: [Rd] Darwin Framework and Application Install Directory
	Improvements (PR#6882)
In-Reply-To: <20040513185605.B98C110537@slim.kubism.ku.dk>
References: <20040513185605.B98C110537@slim.kubism.ku.dk>
Message-ID: <7BC3C8A7-A534-11D8-8895-000A95C87F66@unimi.it>

Why this is related in any sense to a bug (report)?

BTW, $(prefix) can contain "Libraries" in its path, why using 
$(prefix)/Libraries/  ??
Why should R.app and the R.framework be placed on the same target?

What can be done is to set a R_APPLICATION_DIR variable default-ed to 
/Applications, I found this reasonable.

In which sense you propose this modification as an improvement ?

stefano

On May 13, 2004, at 8:56 PM, ch-r@bobobeach.com wrote:

> Full_Name: Cyrus Harmon
> Version: 1.9.0
> OS: MacOS X 10.3
> Submission from: (NULL) (169.229.10.50)
>
>
> R_FRAMEWORK_DIR should default to $(prefix)/Libraries/R.framework and 
> there
> should be a new directory to put R.app in like $(prefix)/Applications. 
> The
> following patch does this:
>
> ===================================================================
> RCS file: Makeconf.in,v
> retrieving revision 1.1
> diff -r1.1 Makeconf.in
> 63c63,64
> < R_FRAMEWORK_DIR = $(prefix)/R.framework
> ---
>> R_FRAMEWORK_DIR = $(prefix)/Libraries/R.framework
>> R_APPLICATION_DIR = $(prefix)/Applications/
>
> ===================================================================
> RCS file: Makefile.in,v
> retrieving revision 1.1
> diff -r1.1 Makefile.in
> 204,205c204,205
> <       @(rm -rf /Applications/R.app)
> <       @(mkdir -p /Applications/R.app/Contents/Resources)
> ---
>>       @(rm -rf $(R_APPLICATION_DIR)/R.app)
>>       @(mkdir -p $(R_APPLICATION_DIR)/R.app/Contents/Resources)
> 207c207
> <         cp PkgInfo /Applications/R.app/Contents)
> ---
>>         cp PkgInfo $(R_APPLICATION_DIR)/R.app/Contents)
> 209c209
> <         cp Info.plist  /Applications/R.app/Contents)
> ---
>>         cp Info.plist  $(R_APPLICATION_DIR)/R.app/Contents)
> 211,212c211,212
> <         cp -R * /Applications/R.app/Contents/Resources)
> <       @(mkdir -p /Applications/R.app/Contents/MacOS)
> ---
>>         cp -R * $(R_APPLICATION_DIR)/R.app/Contents/Resources)
>>       @(mkdir -p $(R_APPLICATION_DIR)/R.app/Contents/MacOS)
> 215c215
> <       @(cd /Applications/R.app/Contents/MacOS && \
> ---
>>       @(cd $(R_APPLICATION_DIR)/R.app/Contents/MacOS && \
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From jago at mclink.it  Fri May 14 13:16:47 2004
From: jago at mclink.it (stefano iacus)
Date: Fri May 14 13:16:56 2004
Subject: [Rd] An example of Cocoa GUI for R
Message-ID: <307993E8-A598-11D8-8DA0-000A95C87F66@mclink.it>

Finally, we are showing you a bit of work on the Cocoa GUI.

Do not expect too much, it is just a preview. You have some nice 
feature yet like code and file completion, but still don't expect too 
much.

Have a look here

http://www.economia.unimi.it/R


It works with R.app 1.9.0

This is a joint work with Simon (mostly his work at the moment)

When we will have time, we will also write some docs on how to write 
your own gui for R using Cocoa, but don't expect any finished work 
before R 2.0.0.


stefano & simon

From lilong at isb-sib.ch  Fri May 14 16:02:06 2004
From: lilong at isb-sib.ch (Li Long)
Date: Fri May 14 23:22:25 2004
Subject: [Rd] request: allow inline functions in R
Message-ID: <37342.130.223.128.12.1084543326.squirrel@expasy-ng.isb-sib.ch>

Hi, R core developers,

I work in the Swiss Institute of Bioinformatics.  We have two clusters of
Intel Itanium2 clusters for bioinformaticians to crank their data.  One
piece of software they use heavily is R and BioConductors.  I ported the R
codes and R packages to this platform already, and am working on
optimizing their performance.  I'm using Intel C/C++ compiler on this
platform running Linux.  One of my findings is that turning some functions
in R to "inline" functions boost performance significantly.

While R follows strict C89 standard right now, there're quite some good
reasons to relax the rule somewhat.  From my experience in software
development in industry, I understand very well both the portability issue
and backward compatability issue, I also see the hidden cost of holding
back for too long and not fully achieving the potential of new technology,
I recommend that we allow "inline" functions in R's C codes.

The following explains why I recommend the above.

In modern processor microarchitecture, pipelining is a major approach to
achieve higher clock speed.  Super-pipelining involves pipelining the
microarchitecture to finer granularities.  With far more instructions
in-flight in a super-pipelined microarchitecture, handling of events that
disrupt the pipeling, such as cache mises, interrupts and branch
misprediction, can be costly.

A case in point is the Intel Itanium architecture, EPIC (explicitly
parallel intruction computing).  EPIC enables programmer or compiler to
indicate the inherent parallelism of programs *explicitly* in the
instruction sequence.  The main features to improve performance are:
application registers, predication, branching and register rotation.  The
implication is the cost of disrupting the pipeline is magnified greatly on
this architecture.

In R, there are quite some simple functions that are called extremely
often, such as "R_IsNaNorNA", "R_finite", etc.  They are used in heavy
loops quite a lot.  They disrupt the pipelining, and negatively affect the
performance of the software.  For instance, on IA64, system call of
"isnan" cost 4 cycles, while a wrapper like "R_IsNaNorNA" could cost
several times more.

One way to reduce this kind of disruption in C/C++ is to "inline" a
function, i.e., to integrate it into the code for its callers, eliminating
the function-call overhead.
The benefits from inlining comes especially with very short functions.

On unix and linux, we could find inline functions in standard .h files in
/usr/include or /usr/local/include.

C++ supports "inline" functions from beginning, while "inline" keyword was
introduced in C99 standard in 1999.  A feature that has been in standard
for so many years is considered very mature in computer industry. Many C++
compilers actually translate C++ codes to C codes, so it's quite natural
for corresponding C compilers to support inline functions.  The compilers
could choose to generate function calls or to inline the functions, so
this feature poses little risk to the application.

The default compilers that R uses, gcc/g++, support it at least since
version 2.95 in Jul 1999.  GCC User's manual states that it "works" only
in optimizing compilation for "gcc/g++".

Since R calls for C, C++, FORTRAN compilers, it's no surprise to expect
that "inline" functions are allowed.  This will not only improve the
performance of R on modern processors with little effort, but also
encourage people to develop and use R packages on more challenging
problems.

In configure-step, R checks for many OS/compiler-related issues, this
could be just one more check.  I expect that the initial use of inline
functions are mainly for small but heavily used functions, so the impact
of such change could be managed.

The attachments are from GCC User's Manual and C99 rationale, regarding
"inline" functions.

Thanks for considering this issue.

Li Long


-------------- next part --------------
>From C99 Rationale
==================

6.4.1 Keywords
Several keywords were added in C89: const, enum, signed, void and volatile. New in
C9X are the keywords inline, restrict, _Bool, _Complex and _Imaginary.
Where possible, however, new features have been added by overloading existing keywords, as, for
example, long double instead of extended. It is recognized that each added keyword will
require some existing code that used it as an identifier to be rewritten. No meaningful programs are
known to be quietly changed by adding the new keywords.



6.7.4     Function specifiers
A new feature of C99: The inline keyword, adapted from C++, is a function-specifier that
can be used only in function declarations. It is useful for program optimizations that require the
definition of a function to be visible at the site of a call. (Note that the Standard does not
attempt to specify the nature of these optimizations.)
Visibility is assured if the function has internal linkage, or if it has external linkage and the call
is in the same translation unit as the external definition. In these cases, the presence of the
inline keyword in a declaration or definition of the function has no effect beyond indicating a
preference that calls of that function should be optimized in preference to calls of other
functions declared without the inline keyword.
Visibility is a problem for a call of a function with external linkage where the call is in a
different translation unit from the function's definition. In this case, the inline keyword
allows the translation unit containing the call to also contain a local, or inline, definition of the
function.
A program can contain a translation unit with an external definition, a translation unit with an
inline definition, and a translation unit with a declaration but no definition for a function. Calls
in the latter translation unit will use the external definition as usual.
An inline definition of a function is considered to be a different definition than the external
definition. If a call to some function func with external linkage occurs where an inline
definition is visible, the behavior is the same as if the call were made to another function, say
__func, with internal linkage. A conforming program must not depend on which function is
called. This is the inline model in the Standard.
A conforming program must not rely on the implementation using the inline definition, nor may
it rely on the implementation using the external definition. The address of a function is always
the address corresponding to the external definition, but when this address is used to call the
function, the inline definition might be used. Therefore, the following example might not
behave as expected.
       inline const char *saddr(void)
       {     static const char name[] = "saddr";
             return name;
       }
       int compare_name(void)
       {     return saddr() == saddr(); // unspecified behavior
       }
Since the implementation might use the inline definition for one of the calls to saddr and use
the external definition for the other, the equality operation is not guaranteed to evaluate to 1
(true). This shows that static objects defined within the inline definition are distinct from their

corresponding object in the external definition. This motivated the constraint against even
defining a non-const object of this type.
Inlining was added to the Standard in such a way that it can be implemented with existing linker
technology, and a subset of C99 inlining is compatible with C++. This was achieved by
requiring that exactly one translation unit containing the definition of an inline function be
specified as the one that provides the external definition for the function. Because that
specification consists simply of a declaration that either lacks the inline keyword, or contains
both inline and extern, it will also be accepted by a C++ translator.
Inlining in C99 does extend the C++ specification in two ways. First, if a function is declared
inline in one translation unit, it need not be declared inline in every other translation unit.
This allows, for example, a library function that is to be inlined within the library but available
only through an external definition elsewhere. The alternative of using a wrapper function for
the external function requires an additional name; and it may also adversely impact performance
if a translator does not actually do inline substitution.
Second, the requirement that all definitions of an inline function be "exactly the same" is
replaced by the requirement that the behavior of the program should not depend on whether a
call is implemented with a visible inline definition, or the external definition, of a function.
This allows an inline definition to be specialized for its use within a particular translation unit.
For example, the external definition of a library function might include some argument
validation that is not needed for calls made from other functions in the same library. These
extensions do offer some advantages; and programmers who are concerned about compatibility
can simply abide by the stricter C++ rules.
Note that it is not appropriate for implementations to provide inline definitions of standard
library functions in the standard headers because this can break some legacy code that
redeclares standard library functions after including their headers. The inline keyword is
intended only to provide users with a portable way to suggest inlining of functions. Because the
standard headers need not be portable, implementations have other options along the lines of:
       #define abs(x) __builtin_abs(x)
or other non-portable mechanisms for inlining standard library functions.
-------------- next part --------------
>From GCC 2.95.3 Manual
======================

 4.31 An Inline Function is As Fast As a Macro

By declaring a function inline, you can direct GNU CC to integrate that function's code into the code for its callers. This makes execution faster by eliminating the function-call overhead; in addition, if any of the actual argument values are constant, their known values may permit simplifications at compile time so that not all of the inline function's code needs to be included. The effect on code size is less predictable; object code may be larger or smaller with function inlining, depending on the particular case. Inlining of functions is an optimization and it really "works" only in optimizing compilation. If you don't use `-O', no function is really inline.

To declare a function inline, use the inline keyword in its declaration, like this:

 	

inline int
inc (int *a)
{
  (*a)++;
}

(If you are writing a header file to be included in ANSI C programs, write __inline__ instead of inline. See section 4.35 Alternate Keywords.) You can also make all "simple enough" functions inline with the option `-finline-functions'.

Note that certain usages in a function definition can make it unsuitable for inline substitution. Among these usages are: use of varargs, use of alloca, use of variable sized data types (see section 4.14 Arrays of Variable Length), use of computed goto (see section 4.3 Labels as Values), use of nonlocal goto, and nested functions (see section 4.4 Nested Functions). Using `-Winline' will warn when a function marked inline could not be substituted, and will give the reason for the failure.

Note that in C and Objective C, unlike C++, the inline keyword does not affect the linkage of the function.

GNU CC automatically inlines member functions defined within the class body of C++ programs even if they are not explicitly declared inline. (You can override this with `-fno-default-inline'; see section Options Controlling C++ Dialect.)

When a function is both inline and static, if all calls to the function are integrated into the caller, and the function's address is never used, then the function's own assembler code is never referenced. In this case, GNU CC does not actually output assembler code for the function, unless you specify the option `-fkeep-inline-functions'. Some calls cannot be integrated for various reasons (in particular, calls that precede the function's definition cannot be integrated, and neither can recursive calls within the definition). If there is a nonintegrated call, then the function is compiled to assembler code as usual. The function must also be compiled as usual if the program refers to its address, because that can't be inlined.

When an inline function is not static, then the compiler must assume that there may be calls from other source files; since a global symbol can be defined only once in any program, the function must not be defined in the other source files, so the calls therein cannot be integrated. Therefore, a non-static inline function is always compiled on its own in the usual fashion.

If you specify both inline and extern in the function definition, then the definition is used only for inlining. In no case is the function compiled on its own, not even if you refer to its address explicitly. Such an address becomes an external reference, as if you had only declared the function, and had not defined it.

This combination of inline and extern has almost the effect of a macro. The way to use it is to put a function definition in a header file with these keywords, and put another copy of the definition (lacking inline and extern) in a library file. The definition in the header file will cause most calls to the function to be inlined. If any uses of the function remain, they will refer to the single copy in the library.

GNU C does not inline any functions when not optimizing. It is not clear whether it is better to inline or not, in this case, but we found that a correct implementation when not optimizing was difficult. So we did the easy thing, and turned it off. 

 4.35 Alternate Keywords

The option `-traditional' disables certain keywords; `-ansi' disables certain others. This causes trouble when you want to use GNU C extensions, or ANSI C features, in a general-purpose header file that should be usable by all programs, including ANSI C programs and traditional ones. The keywords asm, typeof and inline cannot be used since they won't work in a program compiled with `-ansi', while the keywords const, volatile, signed, typeof and inline won't work in a program compiled with `-traditional'.

The way to solve these problems is to put `__' at the beginning and end of each problematical keyword. For example, use __asm__ instead of asm, __const__ instead of const, and __inline__ instead of inline.

Other C compilers won't accept these alternative keywords; if you want to compile with another compiler, you can define the alternate keywords as macros to replace them with the customary keywords. It looks like this:

 	

#ifndef __GNUC__
#define __asm__ asm
#endif

`-pedantic' causes warnings for many GNU C extensions. You can prevent such warnings within one expression by writing __extension__ before the expression. __extension__ has no effect aside from this.
From elw at stderr.org  Fri May 14 23:46:05 2004
From: elw at stderr.org (elijah wright)
Date: Fri May 14 23:46:19 2004
Subject: [Rd] request: allow inline functions in R
In-Reply-To: <37342.130.223.128.12.1084543326.squirrel@expasy-ng.isb-sib.ch>
References: <37342.130.223.128.12.1084543326.squirrel@expasy-ng.isb-sib.ch>
Message-ID: <Pine.LNX.4.58.0405141642160.14370@illuminati.stderr.org>


> of Intel Itanium2 clusters for bioinformaticians to crank their data.

> optimizing their performance.  I'm using Intel C/C++ compiler on this
> platform running Linux.  One of my findings is that turning some
> functions in R to "inline" functions boost performance significantly.
>
> While R follows strict C89 standard right now, there're quite some good
> reasons to relax the rule somewhat.  From my experience in software

> In R, there are quite some simple functions that are called extremely
> often, such as "R_IsNaNorNA", "R_finite", etc.  They are used in heavy
> loops quite a lot.  They disrupt the pipelining, and negatively affect
> the performance of the software.  For instance, on IA64, system call of
> "isnan" cost 4 cycles, while a wrapper like "R_IsNaNorNA" could cost
> several times more.

if the Itanium2 optimizes badly for standard C89 code, that's the
processor architecture's fault, not R's.

you probably need either better (smarter) compilers or a different
platform, not 'improvements' to R.

what would the impact of inlining these functions be on all of the other
architectures (PPC, sparc, Opteron, x86, etc) where R currently runs
perfectly well?

--elijah

From ripley at stats.ox.ac.uk  Sat May 15 00:18:37 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 15 00:18:40 2004
Subject: [Rd] request: allow inline functions in R
In-Reply-To: <37342.130.223.128.12.1084543326.squirrel@expasy-ng.isb-sib.ch>
Message-ID: <Pine.LNX.4.44.0405142248440.4221-100000@gannet.stats>

On Fri, 14 May 2004, Li Long wrote:

> Hi, R core developers,
> 
> I work in the Swiss Institute of Bioinformatics.  We have two clusters of
> Intel Itanium2 clusters for bioinformaticians to crank their data.  One
> piece of software they use heavily is R and BioConductors.  I ported the R
> codes and R packages to this platform already, and am working on
> optimizing their performance.  I'm using Intel C/C++ compiler on this
> platform running Linux.  One of my findings is that turning some functions
> in R to "inline" functions boost performance significantly.
> 
> While R follows strict C89 standard right now, there're quite some good
> reasons to relax the rule somewhat.  From my experience in software
> development in industry, I understand very well both the portability issue
> and backward compatability issue, I also see the hidden cost of holding
> back for too long and not fully achieving the potential of new technology,

Could you then please quantify that hidden cost?

> I recommend that we allow "inline" functions in R's C codes.

In what sense do `we' not allow it?  And who is `we'?

The problem is that very few compilers fully support C99, and others have
different ways to indicate inlining.  So a configure test is needed. I am
sure that if you provide one together with patches to parts of the code
where you find inlining beneficial, the real `we' would consider it
carefully.  Especially if the `hidden cost' is noticeable.

....

> In R, there are quite some simple functions that are called extremely
> often, such as "R_IsNaNorNA", "R_finite", etc.  They are used in heavy
> loops quite a lot.  They disrupt the pipelining, and negatively affect the
> performance of the software.  For instance, on IA64, system call of
> "isnan" cost 4 cycles, while a wrapper like "R_IsNaNorNA" could cost
> several times more.

However, one of the motivations of eliminating support for non-IEEE-754
platforms in R 2.0.0 is to enable some of this baggage to be eliminated.  
But the wrapper is there for a good reason: to get the right answer.

Since I gather you have suitably modified code, it would be helpful to 
your case to provide data 

 - on real problems
 - on a mainstream platform.

of the actual performance impact of not inlining.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat May 15 00:57:42 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 15 00:57:54 2004
Subject: [Rd] request: allow inline functions in R
In-Reply-To: <Pine.LNX.4.44.0405142248440.4221-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0405142348040.4388-100000@gannet.stats>

BTW, I've just checked a hunch. I did not believe R_IsNaNorNA is actually
used in base R on a system with IEEE arithmetic (and I removed it to test
that).  That suggests you have not actually tested inlining it and your 
analysis is seriously flawed.

(Note to Deepayan: it is not a documented entry point, so please use 
ISNAN as documented.)

On Fri, 14 May 2004, Prof Brian Ripley wrote:

> On Fri, 14 May 2004, Li Long wrote:
> 
> > Hi, R core developers,

And BTW, R-devel is not the address of the core developers.

> > I work in the Swiss Institute of Bioinformatics.  We have two clusters of
> > Intel Itanium2 clusters for bioinformaticians to crank their data.  One
> > piece of software they use heavily is R and BioConductors.  I ported the R
> > codes and R packages to this platform already, and am working on
> > optimizing their performance.  I'm using Intel C/C++ compiler on this
> > platform running Linux.  One of my findings is that turning some functions
> > in R to "inline" functions boost performance significantly.
> > 
> > While R follows strict C89 standard right now, there're quite some good
> > reasons to relax the rule somewhat.  From my experience in software
> > development in industry, I understand very well both the portability issue
> > and backward compatability issue, I also see the hidden cost of holding
> > back for too long and not fully achieving the potential of new technology,
> 
> Could you then please quantify that hidden cost?
> 
> > I recommend that we allow "inline" functions in R's C codes.
> 
> In what sense do `we' not allow it?  And who is `we'?
> 
> The problem is that very few compilers fully support C99, and others have
> different ways to indicate inlining.  So a configure test is needed. I am
> sure that if you provide one together with patches to parts of the code
> where you find inlining beneficial, the real `we' would consider it
> carefully.  Especially if the `hidden cost' is noticeable.
> 
> ....
> 
> > In R, there are quite some simple functions that are called extremely
> > often, such as "R_IsNaNorNA", "R_finite", etc.  They are used in heavy
> > loops quite a lot.  They disrupt the pipelining, and negatively affect the
> > performance of the software.  For instance, on IA64, system call of
> > "isnan" cost 4 cycles, while a wrapper like "R_IsNaNorNA" could cost
> > several times more.
> 
> However, one of the motivations of eliminating support for non-IEEE-754
> platforms in R 2.0.0 is to enable some of this baggage to be eliminated.  
> But the wrapper is there for a good reason: to get the right answer.
> 
> Since I gather you have suitably modified code, it would be helpful to 
> your case to provide data 
> 
>  - on real problems
>  - on a mainstream platform.
> 
> of the actual performance impact of not inlining.
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pburns at pburns.seanet.com  Sat May 15 14:10:51 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sat May 15 14:11:48 2004
Subject: [Rd] names on cum* functions
Message-ID: <40A608CB.7050808@pburns.seanet.com>

Is it accidental or on purpose that names get stripped from the
result of "cumsum", "cumprod", "cummin" and "cummax"?

If it is accidental, I suggest that keeping names (and other attributes)
would be appropriate.  (Found porting code from S-PLUS.)


Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

From ripley at stats.ox.ac.uk  Sat May 15 23:01:26 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 15 23:16:29 2004
Subject: [Rd] names on cum* functions
In-Reply-To: <40A608CB.7050808@pburns.seanet.com>
Message-ID: <Pine.LNX.4.44.0405152159230.24143-100000@gannet.stats>

On Sat, 15 May 2004, Patrick Burns wrote:

> Is it accidental or on purpose that names get stripped from the
> result of "cumsum", "cumprod", "cummin" and "cummax"?

Almost certainly accidental.

> If it is accidental, I suggest that keeping names (and other attributes)
> would be appropriate.  (Found porting code from S-PLUS.)

Names, sure.  I am not so sure about all other attributes, in particular 
class (suppose these were difftimes?).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pburns at pburns.seanet.com  Sat May 15 23:27:36 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sat May 15 23:28:32 2004
Subject: [Rd] names on cum* functions
References: <Pine.LNX.4.44.0405152159230.24143-100000@gannet.stats>
Message-ID: <40A68B48.8040404@pburns.seanet.com>



Prof Brian Ripley wrote:

>On Sat, 15 May 2004, Patrick Burns wrote:
>
>  
>
>>Is it accidental or on purpose that names get stripped from the
>>result of "cumsum", "cumprod", "cummin" and "cummax"?
>>    
>>
>
>Almost certainly accidental.
>
>  
>
>>If it is accidental, I suggest that keeping names (and other attributes)
>>would be appropriate.  (Found porting code from S-PLUS.)
>>    
>>
>
>Names, sure.  I am not so sure about all other attributes, in particular 
>class (suppose these were difftimes?).
>
>  
>
I was thinking about dim -- I agree that class could be problematic.
Given this counter-example, I would find it hard to argue that
anything beyond names should be saved.

From e-mail at alcanet.it  Mon May 17 11:00:46 2004
From: e-mail at alcanet.it (e-mail@alcanet.it)
Date: Mon May 17 11:11:21 2004
Subject: [Rd] ALCATEL POLICY VIOLATION (Attachment Removal)
Message-ID: <200405170900.i4H90pWT011139@ns.alcanet.it>

**************** eManager Notification *****************

The following mail was blocked since it contains sensitive content.

Source mailbox: <r-devel@r-project.org>
Destination mailbox(es): gianni.bartoli@alcatel.it
Policy: Attachment Removal
Attachment file name: mail4377.pif - application/octet-stream
Action: Replaced with text

Our mail system policy does not accept certain attachment types. See http://www.alcatel.com/mail_policy/email_attachments.htm for additional details.

******************* End of message *********************
-------------- next part --------------
From: r-devel@r-project.org
To: gianni.bartoli@alcatel.it
Subject: Error (gianni.bartoli@alcatel.it)
Date: Mon, 17 May 2004 11:07:18 +0200
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0016----=_NextPart_000_0016"
X-Priority: 1
X-MSMail-Priority: High
From lilong at isb-sib.ch  Mon May 17 15:16:28 2004
From: lilong at isb-sib.ch (Li Long)
Date: Mon May 17 15:16:32 2004
Subject: [Rd] request: allow inline functions in R
In-Reply-To: <Pine.LNX.4.44.0405142348040.4388-100000@gannet.stats>
References: <Pine.LNX.4.44.0405142248440.4221-100000@gannet.stats>
	<Pine.LNX.4.44.0405142348040.4388-100000@gannet.stats>
Message-ID: <35457.130.223.128.12.1084799788.squirrel@expasy-ng.isb-sib.ch>

> BTW, I've just checked a hunch. I did not believe R_IsNaNorNA is actually
> used in base R on a system with IEEE arithmetic (and I removed it to test
> that).  That suggests you have not actually tested inlining it and your
> analysis is seriously flawed.

R_IsNaNorNA is found in three dirs: main/arithmatic.c, nmath/mlutils.c,
nmath/nmath.h, include/R_ext/Arith.h and include/Rmath.h0.in.  (This is a
candidate for streamlining the codes. But that's a different subject. )

After I turned all of them inline, the model I have runs about 5% faster
on Itanium2 (running Linux).  When I cut down some calls in the package
(being developed) to ISNAN, the performance gain is another 5%. I
interprete this cost as quite significant.

>>
>> Could you then please quantify that hidden cost?

In package "cluster", pam.c and clara.c contain a function "ind_2" which
is used very heavily in the loop. After changing this function to be an
"inline" function, the model speeds up by factor of 2.  That's very
significant improvement for the model.  It also indicates the overhead
these small functions incur.

>> In what sense do `we' not allow it?  And who is `we'?

What I meant for "we" is "R core developers".  At this time, R adhers
strict C89 standard, so no inline function is allowed.

>> The problem is that very few compilers fully support C99, and others
>> have
>> different ways to indicate inlining.  So a configure test is needed. I
>> am
>> sure that if you provide one together with patches to parts of the code
>> where you find inlining beneficial, the real `we' would consider it
>> carefully.  Especially if the `hidden cost' is noticeable.

I'm not aware of other ways of indicating "inlining" by other compilers,
could you please give an example?

The request is to allowed "inline", not full C99 support.

As indicated in my original request, compiler could choose to treat
"inline" functions the same as normal functions. C++ supports "inline"
functions from the beginning, and C99 puts it in as a new keyword, "gcc"
supports it since 2.95, these point to a mature feature of the C language.

The inline functions are most suitable for small functions so that they
don't stall the pipeline, and they should be used when they are most
beneficial.  From this aspect, the portability and compatability issues
are easily manageable.

Li Long

From ripley at stats.ox.ac.uk  Mon May 17 21:27:02 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May 17 21:27:09 2004
Subject: [Rd] request: allow inline functions in R
In-Reply-To: <35457.130.223.128.12.1084799788.squirrel@expasy-ng.isb-sib.ch>
Message-ID: <Pine.LNX.4.44.0405171423590.14150-100000@gannet.stats>

On Mon, 17 May 2004, Li Long wrote:

> > BTW, I've just checked a hunch. I did not believe R_IsNaNorNA is actually
> > used in base R on a system with IEEE arithmetic (and I removed it to test
> > that).  That suggests you have not actually tested inlining it and your
> > analysis is seriously flawed.
> 
> R_IsNaNorNA is found in three dirs: main/arithmatic.c, nmath/mlutils.c,
> nmath/nmath.h, include/R_ext/Arith.h and include/Rmath.h0.in.  (This is a
> candidate for streamlining the codes. But that's a different subject. )

However that part of nmath/mlutils.c is only used standalone and both it
and main/arithmetic.c only provided R_IsNaNorNA.  And in the current
sources where the non-IEEE case has been removed it is only in the first
two. Nothing calls R_IsNaNorNA. It is NOT used. You can remove it from all
those files in the current sources.  What is it you don't understand about
my second sentence?

Your final comment suggests that you do not understand how R's codebase is
organized.  A few parts are separated out (in a slightly different form)  
to make a standalone Rmath library *that does not use R's notion of NAs*.
The differences are larger than the commonality in the current version.  
We could easily streamline it by removing standalone nmath, but not
otherwise.

> After I turned all of them inline, the model I have runs about 5% faster

What is `them'?  Not `dirs', the grammatical immediate antecedent.

> on Itanium2 (running Linux).  When I cut down some calls in the package
> (being developed) to ISNAN, the performance gain is another 5%. I
> interprete this cost as quite significant.

I saw no measurable change in replacing all calls to R_finite by isfinite
(which is what we have done recently in 2.0.0 on platforms supporting
isfinite). That's at least as good as inlining, better on platforms on
which isfinite is a macro (as it is on two of those I tested).

BTW, 5% is the expected change in CPU performance in 1.25 months according
to Moore's Law (as stated on an Intel flyer).  It will be eclipsed by the 
speedup by the time R 2.0.0 is released.

> >> Could you then please quantify that hidden cost?
> 
> In package "cluster", pam.c and clara.c contain a function "ind_2" which
> is used very heavily in the loop. After changing this function to be an
> "inline" function, the model speeds up by factor of 2.  That's very
> significant improvement for the model.  It also indicates the overhead
> these small functions incur.

On your platform!  I did ask for examples on a commonly used platform, and 
for inlining in R, not a contributed package.

> >> In what sense do `we' not allow it?  And who is `we'?
> 
> What I meant for "we" is "R core developers".  At this time, R adhers
> strict C89 standard, so no inline function is allowed.

Well, I *am* an R core developer, and I didn't know that.  It is necessary
that R when configured on a strict C89 platform will compile and run,
which that is not what you claimed.  We do make use of several non-C89
features already on particular platforms or compilers.  We even include 
code using __inline__ (have you actually looked at the sources?).

> >> The problem is that very few compilers fully support C99, and others
> >> have
> >> different ways to indicate inlining.  So a configure test is needed. I
> >> am
> >> sure that if you provide one together with patches to parts of the code
> >> where you find inlining beneficial, the real `we' would consider it
> >> carefully.  Especially if the `hidden cost' is noticeable.

I am very interested in your response to this suggestion.

> I'm not aware of other ways of indicating "inlining" by other compilers,
> could you please give an example?

__CRT_INLINE by MinGW on Windows, for example.  __inline and __inline__
are also used.  For gcc __inline__ would be preferred to allow -pedantic
to be used (and that has helped catch a number of things which stricter 
compilers were rejecting).

> The request is to allowed "inline", not full C99 support.

`inline' is allowed *if* your package configure tests for it, so there is 
nothing to grant here.

You *will* find __inline__ used in the R sources, in the way it is most
effective, for static functions in a single compilation unit. The R
authors have tended to use macros instead, to the same effect.

> As indicated in my original request, compiler could choose to treat
> "inline" functions the same as normal functions. C++ supports "inline"
> functions from the beginning, and C99 puts it in as a new keyword, "gcc"
> supports it since 2.95, these point to a mature feature of the C language.

See above.  There are issues about inlining and functions imported from
DLLs and shared libraries, so we would need to ensure that the patches you
supply work with libR.so and R.dll.

> The inline functions are most suitable for small functions so that they
> don't stall the pipeline, and they should be used when they are most
> beneficial.  From this aspect, the portability and compatability issues
> are easily manageable.

Let me repeat the request for details of which functions, patches and
evidence of their effectiveness. You *still* have not told us exactly what
you believe to be effective: and I know R_IsNaNorNA (one of your few
examples) is not called in the current R sources.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jkbreaux at san.rr.com  Tue May 18 04:08:37 2004
From: jkbreaux at san.rr.com (jkbreaux@san.rr.com)
Date: Tue May 18 04:08:40 2004
Subject: [Rd] dir.create bug (PR#6892)
Message-ID: <20040518020837.88FB71068C@slim.kubism.ku.dk>

Full_Name: Jim Breaux
Version: 1.9.0
OS: WinXP
Submission from: (NULL) (209.78.110.135)


dir.create() is reporting a warning that a directory already exists when in fact
the directory does NOT already exist.  However, the erroneous behavior does not
manifest itself until dir.create() has been called at least once to create a
directory that DOES already exist.  For example:

# Create a directory that does NOT exist:
> result <- dir.create("C:\\TEMP")
> result
[1] TRUE

# Create another directory that does NOT exist:
> result <- dir.create("C:\\TEMP2")
> result
[1] TRUE

# Now try to create a directory that DOES already exist:
> result <- dir.create("C:\\TEMP")
Warning message: 
'C:\TEMP' already exists 
> result
[1] FALSE

# Finally, try to create a directory that does NOT exist:
> result <- dir.create("C:\\TEMP3")
Warning message: 
'C:\TEMP3' already exists 
> result
[1] TRUE

Notice that in the last case, result == TRUE as expected; however, the warning
message should not be reported.

From ripley at stats.ox.ac.uk  Tue May 18 06:58:59 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue May 18 06:59:16 2004
Subject: [Rd] dir.create bug (PR#6892)
In-Reply-To: <20040518020837.88FB71068C@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405180557400.13132-100000@gannet.stats>

Thanks. Fixed in R-patched.

On Tue, 18 May 2004 jkbreaux@san.rr.com wrote:

> Full_Name: Jim Breaux
> Version: 1.9.0
> OS: WinXP
> Submission from: (NULL) (209.78.110.135)
> 
> 
> dir.create() is reporting a warning that a directory already exists when
> in fact the directory does NOT already exist.  However, the erroneous
> behavior does not manifest itself until dir.create() has been called at
> least once to create a directory that DOES already exist.  For example:
> 
> # Create a directory that does NOT exist:
> > result <- dir.create("C:\\TEMP")
> > result
> [1] TRUE
> 
> # Create another directory that does NOT exist:
> > result <- dir.create("C:\\TEMP2")
> > result
> [1] TRUE
> 
> # Now try to create a directory that DOES already exist:
> > result <- dir.create("C:\\TEMP")
> Warning message: 
> 'C:\TEMP' already exists 
> > result
> [1] FALSE
> 
> # Finally, try to create a directory that does NOT exist:
> > result <- dir.create("C:\\TEMP3")
> Warning message: 
> 'C:\TEMP3' already exists 
> > result
> [1] TRUE
> 
> Notice that in the last case, result == TRUE as expected; however, the
> warning message should not be reported.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From scoelho at univ-tlse1.fr  Tue May 18 16:18:10 2004
From: scoelho at univ-tlse1.fr (Sandrine Coelho)
Date: Tue May 18 16:19:31 2004
Subject: [Rd] R and  C++ code
Message-ID: <001f01c43ce2$fdd42230$f13731c1@Cysteine>

Hello,
 I want to use a C++ library under R, but I have problems.
I have readen the manual: "Writing R Extensions" and the setion " Interfacing C++ code".
I have created :
//X.cpp
#include "X.h"
#include <iostream>

X::X()
{
  std::cout << "constructor X" << std::endl;
}

X::~X()
{
}


//X.h
#ifndef X_H
#define X_H

class  X
{
   public:
 X();

 ~X();
};
#endif

//X_main.cpp
#include "X.h"

extern "C" {

void X_main(){
X x;
}
}


//essai.R
foo<-function()
{.C("X_main");}

When I execute the file essai.R, the R console returns:

Error in .C("X_main") : C function name not in load table.

If you can help me.
Thank you.

Sandrine

From Torsten.Hothorn at rzmail.uni-erlangen.de  Tue May 18 16:31:15 2004
From: Torsten.Hothorn at rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Tue May 18 16:31:36 2004
Subject: [Rd] R and  C++ code
In-Reply-To: <001f01c43ce2$fdd42230$f13731c1@Cysteine>
References: <001f01c43ce2$fdd42230$f13731c1@Cysteine>
Message-ID: <Pine.LNX.4.51.0405181630230.9672@artemis.imbe.med.uni-erlangen.de>


> Hello,
>  I want to use a C++ library under R, but I have problems.
> I have readen the manual: "Writing R Extensions" and the setion " Interfacing C++ code".
> I have created :
> //X.cpp
> #include "X.h"
> #include <iostream>
>
> X::X()
> {
>   std::cout << "constructor X" << std::endl;
> }
>
> X::~X()
> {
> }
>
>
> //X.h
> #ifndef X_H
> #define X_H
>
> class  X
> {
>    public:
>  X();
>
>  ~X();
> };
> #endif
>
> //X_main.cpp
> #include "X.h"
>
> extern "C" {
>
> void X_main(){
> X x;
> }
> }
>
>
> //essai.R

did you load the shared library via

dyn.load("X_main.so")

?

Torsten

> foo<-function()
> {.C("X_main");}
>
> When I execute the file essai.R, the R console returns:
>
> Error in .C("X_main") : C function name not in load table.
>
> If you can help me.
> Thank you.
>
> Sandrine
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>

From scoelho at univ-tlse1.fr  Tue May 18 16:37:56 2004
From: scoelho at univ-tlse1.fr (Sandrine Coelho)
Date: Tue May 18 16:39:06 2004
Subject: [Rd] R and  C++ code
References: <001f01c43ce2$fdd42230$f13731c1@Cysteine>
	<Pine.LNX.4.51.0405181630230.9672@artemis.imbe.med.uni-erlangen.de>
Message-ID: <004901c43ce5$bad36510$f13731c1@Cysteine>

I work under windows XP, so i haven't file "X_main.so".

Torsten Hothorn wrote:
>> Hello,
>>  I want to use a C++ library under R, but I have problems.
>> I have readen the manual: "Writing R Extensions" and the setion "
>> Interfacing C++ code". I have created :
>> //X.cpp
>> #include "X.h"
>> #include <iostream>
>> 
>> X::X()
>> {
>>   std::cout << "constructor X" << std::endl;
>> }
>> 
>> X::~X()
>> {
>> }
>> 
>> 
>> //X.h
>> #ifndef X_H
>> #define X_H
>> 
>> class  X
>> {
>>    public:
>>  X();
>> 
>>  ~X();
>> };
>> #endif
>> 
>> //X_main.cpp
>> #include "X.h"
>> 
>> extern "C" {
>> 
>> void X_main(){
>> X x;
>> }
>> }
>> 
>> 
>> //essai.R
> 
> did you load the shared library via
> 
> dyn.load("X_main.so")
> 
> ?
> 
> Torsten
> 
>> foo<-function()
>> {.C("X_main");}
>> 
>> When I execute the file essai.R, the R console returns:
>> 
>> Error in .C("X_main") : C function name not in load table.
>> 
>> If you can help me.
>> Thank you.
>> 
>> Sandrine
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From x.sole at iconcologia.catsalut.net  Tue May 18 16:46:58 2004
From: x.sole at iconcologia.catsalut.net (x.sole@iconcologia.catsalut.net)
Date: Tue May 18 16:47:05 2004
Subject: [Rd] plot.factor does not work properly (PR#6894)
Message-ID: <20040518144658.1A00B1069C@slim.kubism.ku.dk>

Full_Name: Xavier Sole
Version: 1.9.0
OS: Windows XP/SuSe Linux
Submission from: (NULL) (146.219.19.22)


plot.factor in 1.9.0 shows different results than in R 1.8. Only one bar is
displayed.

plot(factor(rep(1:3,10)))

From ligges at statistik.uni-dortmund.de  Tue May 18 16:48:45 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue May 18 16:48:04 2004
Subject: [Rd] R and  C++ code
In-Reply-To: <004901c43ce5$bad36510$f13731c1@Cysteine>
References: <001f01c43ce2$fdd42230$f13731c1@Cysteine>	<Pine.LNX.4.51.0405181630230.9672@artemis.imbe.med.uni-erlangen.de>
	<004901c43ce5$bad36510$f13731c1@Cysteine>
Message-ID: <40AA224D.7030903@statistik.uni-dortmund.de>

Sandrine Coelho wrote:
> I work under windows XP, so i haven't file "X_main.so".

Well,

  1. have you compiled with R CMD SHLIB (or Rcmd SHLIB, if R<1.9.0)?
  2. have you used dyn.load() to load the corresponding dll file?

Anyway, please read "Writing R Extensions" for more details.

Uwe Ligges



> Torsten Hothorn wrote:
> 
>>>Hello,
>>> I want to use a C++ library under R, but I have problems.
>>>I have readen the manual: "Writing R Extensions" and the setion "
>>>Interfacing C++ code". I have created :
>>>//X.cpp
>>>#include "X.h"
>>>#include <iostream>
>>>
>>>X::X()
>>>{
>>>  std::cout << "constructor X" << std::endl;
>>>}
>>>
>>>X::~X()
>>>{
>>>}
>>>
>>>
>>>//X.h
>>>#ifndef X_H
>>>#define X_H
>>>
>>>class  X
>>>{
>>>   public:
>>> X();
>>>
>>> ~X();
>>>};
>>>#endif
>>>
>>>//X_main.cpp
>>>#include "X.h"
>>>
>>>extern "C" {
>>>
>>>void X_main(){
>>>X x;
>>>}
>>>}
>>>
>>>
>>>//essai.R
>>
>>did you load the shared library via
>>
>>dyn.load("X_main.so")
>>
>>?
>>
>>Torsten
>>
>>
>>>foo<-function()
>>>{.C("X_main");}
>>>
>>>When I execute the file essai.R, the R console returns:
>>>
>>>Error in .C("X_main") : C function name not in load table.
>>>
>>>If you can help me.
>>>Thank you.
>>>
>>>Sandrine
>>>
>>>______________________________________________
>>>R-devel@stat.math.ethz.ch mailing list
>>>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From plummer at iarc.fr  Tue May 18 18:32:24 2004
From: plummer at iarc.fr (Martyn Plummer)
Date: Tue May 18 18:32:41 2004
Subject: [Rd] plot.factor does not work properly (PR#6894)
In-Reply-To: <20040518144658.1A00B1069C@slim.kubism.ku.dk>
References: <20040518144658.1A00B1069C@slim.kubism.ku.dk>
Message-ID: <1084897943.6259.50.camel@nemo>

On Tue, 2004-05-18 at 16:46, x.sole@iconcologia.catsalut.net wrote:
> Full_Name: Xavier Sole
> Version: 1.9.0
> OS: Windows XP/SuSe Linux
> Submission from: (NULL) (146.219.19.22)
> 
> 
> plot.factor in 1.9.0 shows different results than in R 1.8. Only one bar is
> displayed.
> 
> plot(factor(rep(1:3,10)))

I think this is the same as PR#6776
Martyn

From uninstall at help.myway.com  Tue May 18 22:54:02 2004
From: uninstall at help.myway.com (My Way Customer Service)
Date: Tue May 18 22:54:19 2004
Subject: [Rd] Your message to My Way  (KMM770914C0KM)
Message-ID: <200405182054.QAA19369@mail.help.myway.com>

****************************************************************
Message Acknowledgement
 
****************************************************************
This automated response is to let you know that we received your message
to My Way, and will be getting back to you as soon as possible. If you 
have a problem or question, please check our help pages located at:
 
http://help.myway.com
 
These pages contain answers to the majority of questions we receive.
 
******************************************************************
Thanks again for writing, and we will get back to you as soon as we can.
 
Regards,
The My Way Customer Service Team

From phgrosjean at sciviews.org  Wed May 19 10:09:49 2004
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Wed May 19 10:10:36 2004
Subject: [Rd] SciViews package for a GUI layer in R?
Message-ID: <MABBLJDICACNFOLGIHJOEECLEHAA.phgrosjean@sciviews.org>

Hello,

R-help got the first annonce of SciViews-R [An alpha version (unstable,
still in development) of SciViews-R can be downloaded from
http://www.sciviews.org/SciViews-R. See also screenshots at
http://www.sciviews.org/software/rconsole.htm, etc.]

We think it should be nice if the various GUI projects for R adopted some
common (or similar) features that would be intercompatible between these
projects. One way to do that is through a R package that implements those
common features in pure R code. The SciViews package is a preliminary
attempt in this direction. We also propose some extensions that are useful
for GUIs: look at copy, export, view and report functions, for instance. A
manual explain it in more details
(ftp://ftp.umh.ac.be/pub/ftp_econum/Manual.pdf).

Any comments?

Best,

Philippe Grosjean

.......................................................<?}))><....
 ) ) ) ) )
( ( ( ( (   Prof. Philippe Grosjean
\  ___   )
 \/ECO\ (   Numerical Ecology of Aquatic Systems
 /\___/  )  Mons-Hainaut University, Pentagone
/ ___  /(   8, Av. du Champ de Mars, 7000 Mons, Belgium
 /NUM\/  )
 \___/\ (   phone: + 32.65.37.34.97, fax: + 32.65.37.33.12
       \ )  email: Philippe.Grosjean@umh.ac.be
 ) ) ) ) )  SciViews project coordinator (http://www.sciviews.org)
( ( ( ( (
...................................................................

From Kurt.Hornik at wu-wien.ac.at  Wed May 19 13:09:13 2004
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Wed May 19 13:09:22 2004
Subject: [Rd] convert.times in chron,
	error when 59 < seconds < 60 (PR#6878)
In-Reply-To: <20040512185606.F041E104CE@slim.kubism.ku.dk>
References: <20040512185606.F041E104CE@slim.kubism.ku.dk>
Message-ID: <16555.16473.198027.946742@mithrandir.hornik.net>

>>>>> wolfda  writes:

> Full_Name: Dennis Wolf
> Version: 1.9.0
> OS: Mac OS 10.3.3
> Submission from: (NULL) (160.91.76.23)


> platform powerpc-apple-darwin6.8
> arch     powerpc                
> os       darwin6.8              
> system   powerpc, darwin6.8     
> status                          
> major    1                      
> minor    9.0                    
> year     2004                   
> month    04                     
> day      12                     
> language R                      



>                 Information on Package 'chron'

> Description:

> Package: chron
> Version: 2.2-29
> Date: 2004-01-31
> Author: S original by David James <dj@research.bell-labs.com>, R port
>         by Kurt Hornik <Kurt.Hornik@R-project.org>.
> Maintainer: Kurt Hornik <Kurt.Hornik@R-project.org>
> Description: Chronological objects which can handle dates and times
> Title: Chronological objects which can handle dates and times
> Depends: R (>= 1.6.0)
> License: GPL
> Packaged: Sat Jan 31 13:31:05 2004; hornik
> Built: R 1.9.0; powerpc-apple-darwin6.8; 2004-04-15 01:23:51; unix

>> library(chron)
>> convert.times("20:27:58.6")
> [1] 0.8527616
>> convert.times("20:27:59.1")
> [1] NA
> Warning message: 
> time-of-day entries out of range in positions 1 set to NA in:
> convert.times("20:27:59.1") 
>> 

> The fix appears to be to replace:

>     i <- (hh[ok] < 0 | hh[ok] > 23 | mm[ok] < 0 | mm[ok] > 59 |
>         ss[ok] < 0 | ss[ok] > 59)

> with:

>     i <- (hh[ok] < 0 | hh[ok] > 23 | mm[ok] < 0 | mm[ok] > 59 |
>         ss[ok] < 0 | ss[ok] >= 60)

> in code for convert.times

Thanks, fixed.

-k

From giles.crane at doh.state.nj.us  Wed May 19 19:31:03 2004
From: giles.crane at doh.state.nj.us (giles.crane@doh.state.nj.us)
Date: Wed May 19 19:31:09 2004
Subject: [Rd] foreign package:  reading epiinfo (PR#6895)
Message-ID: <20040519173103.8B94A10618@slim.kubism.ku.dk>

Full_Name: Giles L. Crane
Version: 1.9
OS: Windows 98
Submission from: (NULL) (199.20.71.17)


The foreign package enables R users 
to read datasets from other software.

The read.epiinfo module works well
for most EPI6 (EPI-INFO) .REC files.
However, when the .REC file has 
an underline in column one,
read.epiinfo seems to pick this underline
and make the underline the first character
in the variable name. 

In the ASCII text .REC files, the first character
is used to indicate a how a variable
is displayed when entering data --
the first character is not part of the 
variables name.
The EPI6 variable name begins in column 2.
I think read.epiinfo could be fixed easily.

Cordially,
Giles Crane

From tlumley at u.washington.edu  Wed May 19 20:55:57 2004
From: tlumley at u.washington.edu (tlumley@u.washington.edu)
Date: Wed May 19 20:56:01 2004
Subject: [Rd] foreign package:  reading epiinfo (PR#6895)
Message-ID: <20040519185557.BA78410540@slim.kubism.ku.dk>

On Wed, 19 May 2004 giles.crane@doh.state.nj.us wrote:
>
> The read.epiinfo module works well
> for most EPI6 (EPI-INFO) .REC files.
> However, when the .REC file has
> an underline in column one,
> read.epiinfo seems to pick this underline
> and make the underline the first character
> in the variable name.
>

If you could make an example file available it would be easier to fix
this.

	-thomas.

From garvin at cs.rice.edu  Wed May 19 23:39:22 2004
From: garvin at cs.rice.edu (garvin@cs.rice.edu)
Date: Wed May 19 23:39:24 2004
Subject: [Rd] R with shared library support: 'make check' fails with
	unresolved symbol (PR#6896)
Message-ID: <20040519213922.AE69C10593@slim.kubism.ku.dk>

Full_Name: John Garvin
Version: 1.9.0
OS: OSF1 Alpha ev6
Submission from: (NULL) (128.42.129.78)


I configured R 1.9.0 with --enable-R-shlib on Alpha. 'make check' fails with an
unresolved symbol. Here's the relevant output:

running code in 'reg-tests-1.R'
...529442:/home/garvin/research/tel/R-alpha/unpatched/R-1.9.0/lib/R/bin/R.bin:
/sbin/loader: Fatal Error: call to unresolved symbol from
/home/garvin/research/tel/R-alpha/unpatched/R-1.9.0/lib/R/modules/lapack.so
(pc=0x3ffbfde345c)

I'm using Compaq cc version V6.4-009 and ld version 5.1.

From arnima at u.washington.edu  Fri May 21 04:58:44 2004
From: arnima at u.washington.edu (arnima@u.washington.edu)
Date: Fri May 21 04:58:47 2004
Subject: [Rd] Typo in R-lang (PR#6897)
Message-ID: <20040521025844.905AB1058F@slim.kubism.ku.dk>

I believe there's a typo in the R Language Definition 1.9.0 (2004-04-12)
draft. Around the middle of subsection 5.1 it says:

 ... a final search for foo.default would be made

This should probably be:

 ... a final search for mean.default would be made

Cheers,
Arni

From berwin at maths.uwa.edu.au  Fri May 21 08:41:38 2004
From: berwin at maths.uwa.edu.au (berwin@maths.uwa.edu.au)
Date: Fri May 21 08:41:40 2004
Subject: [Rd] Buglet/omission in nls package (PR#6901)
Message-ID: <20040521064138.1DC28105A5@slim.kubism.ku.dk>

Dear all,

I noticed the following under R 1.8.1 (when nls was still a separate
package) but the same problem occurs under R 1.9.0 (where most (all?)
of nls is now in the stats package):

> data(Puromycin)
> fm <- nls(rate~SSmicmen(conc,b0,b1), Puromycin, subset = state=="treated")
> coef(summary(fm))
NULL

The problem seems to be that summary.nls uses the name "parameters"
instead of the name "coefficients" for the matrix with the estimates,
standard errors, t values and p values:

> summary(fm)$parameters
       Estimate  Std. Error   t value     Pr(>|t|)
b0 212.68370728 6.947153198 30.614512 3.241160e-11
b1   0.06412123 0.008280944  7.743227 1.565136e-05

Thus, coef.default fails on an object of class "summary.nls".

Possible fixes:
1) Rename that part of the summary.nls structure from parameters to
   coefficients  (not sure if that breaks something else); or
2) Write a coef.summary.nls method that returns the structure
   parameter from a summary.nls object passed to it.

Cheers,

        Berwin

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 9.0
 year = 2004
 month = 04
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics, package:utils, Autoloads, package:base

From berwin at maths.uwa.edu.au  Fri May 21 09:22:00 2004
From: berwin at maths.uwa.edu.au (berwin@maths.uwa.edu.au)
Date: Fri May 21 09:22:03 2004
Subject: [Rd] Bug in update()? (PR#6902)
Message-ID: <20040521072200.A1F9C1058F@slim.kubism.ku.dk>

Dear all,

I noticed the following while playing around with fitting log-linear
models to contingency tables using R 1.8.1, but the problem also
exists under R 1.9.0.

A reproducible example uses the following contingency table:


> library(MASS)
> data(quine)
> tmp <- with(quine, expand.grid(Eth=levels(Eth), Sex=levels(Sex), 
+                    Lrn=levels(Lrn), Age=levels(Age)))
> n <- nrow(quine)
> quine2 <- with(quine,
+       data.frame(tmp,
+       Count=as.vector(tapply(rep(1,n), list(Eth, Sex, Lrn, Age), sum))))

First fit a saturated model and see which term we can drop:
    > fm <- glm(Count ~ .^4, quine2, family=poisson)
    > drop1(fm, test="Chisq")
    Single term deletions
    
    Model:
    Count ~ .^4
                    Df  Deviance     AIC     LRT Pr(Chi)
    <none>             6.661e-16 148.916                
    Eth:Sex:Lrn:Age  2     0.422 145.338   0.422    0.81

Drop the four-way interaction and check which term we can drop next:
    > fm <- update(fm, . ~ . - Eth:Sex:Lrn:Age)
    > drop1(fm, test="Chisq")
    Single term deletions
    
    Model:
    Count ~ .
           Df Deviance     AIC     LRT  Pr(Chi)   
    <none>      35.893 142.810                    
    Eth     1   36.332 141.248   0.439 0.507811   
    Sex     1   37.238 142.154   1.345 0.246237   
    Lrn     1   37.392 142.308   1.499 0.220842   
    Age     3   49.818 150.735  13.925 0.003009 **
    ---
    Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

All of a sudden there are only the main effects left and all
interaction terms have been removed.  I expected to see at this point
a test for all three-way interactions.  Since I started of with the
saturated model and used update to remove the four-way interaction,
all two-way and three-way interactions should still be in the model.
Or am I missing some subtlety of the "^" and "." operators in model
formulae? 

On the other hand, if we specify the saturated model as follows:

    > fm <- glm(Count ~ Lrn*Eth*Sex*Age, quine2, family=poisson)

then the above steps have the desired effect:

    > drop1(fm, test="Chisq")
    Single term deletions
    
    Model:
    Count ~ Lrn * Eth * Sex * Age
                    Df  Deviance     AIC     LRT Pr(Chi)
    <none>             4.219e-15 148.916                
    Lrn:Eth:Sex:Age  2     0.422 145.338   0.422    0.81
    > fm <- update(fm, . ~ . - Eth:Sex:Lrn:Age)
    > drop1(fm, test="Chisq")
    Single term deletions
    
    Model:
    Count ~ Lrn + Eth + Sex + Age + Lrn:Eth + Lrn:Sex + Eth:Sex + 
        Lrn:Age + Eth:Age + Sex:Age + Lrn:Eth:Sex + Lrn:Eth:Age + 
        Lrn:Sex:Age + Eth:Sex:Age
                Df Deviance     AIC     LRT  Pr(Chi)   
    <none>            0.422 145.338                    
    Lrn:Eth:Sex  1    0.493 143.409   0.071 0.789909   
    Lrn:Eth:Age  2    0.629 141.545   0.207 0.901471   
    Lrn:Sex:Age  2   12.728 153.644  12.306 0.002127 **
    Eth:Sex:Age  3    1.019 139.935   0.597 0.897103   
    ---
    Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 

The update command only removed the four-way interaction but left all
the two-way and three-way interaction in the model.  

I looked at update.formula to see what the problem might be, but after
reading the help file of .Internal I stopped looking around.... :)

Cheers,

        Berwin

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 9.0
 year = 2004
 month = 04
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:MASS, package:methods, package:stats, package:graphics, package:utils, Autoloads, package:base

From dvanbrunt at well-wired.com  Fri May 21 15:24:40 2004
From: dvanbrunt at well-wired.com (dvanbrunt@well-wired.com)
Date: Fri May 21 15:24:46 2004
Subject: [Rd] Memory Leak in OS X versions? (PR#6903)
Message-ID: <20040521132440.BA60A10590@slim.kubism.ku.dk>

Full_Name: David L. Van Brunt
Version: 1.8-1.9 beta
OS: OS X 10.3
Submission from: (NULL) (68.74.58.109)


As posted on R-Help (after which another user replicated the problem):
---------------
This is the conclusion from a prior thread ([R] " cannot allocate vector of
length 1072693248") which ended with no other answer but that there must be
a problem in the OS X version of R, or in the compile of the source on OS X.

I?ve posted code and data here:
http://www.well-wired.com/reflibrary/uploads/1084503247.zip

If you setwd() into the directory that is made, then ?source()? the ?.R?
file, it should run fine on Windows but crash on any machine with OS X
(Panther) giving: ?Error in as.vector(data) : cannot allocate vector of
length 1073741824? after a few iterations of the loop.

I've repeated this on a Powerbook G4 with 500 MB of RAM, an iMac with 128M
of RAM, and a Dual 2GHz G5 with 1.5 Gig of RAM. Have used the Raqua, the
Frameworks installation, and a fresh compile of the source using Fink in the
X11 implementation. No matter the machine or the version (1.8x through 1.9,
OS X or Unix X11), I get the same result.

Thanks to Andy Liaw for helping me tune the code this far.

I'm stumped. Would love to hear others' experience with this, and if they
can reproduce the problem elsewhere.


-- 
David L. Van Brunt, Ph.D.
Outlier Consulting & Development
mailto: <ocd@well-wired.com>

From Jonathan.Swinton at astrazeneca.com  Fri May 21 16:09:18 2004
From: Jonathan.Swinton at astrazeneca.com (Jonathan.Swinton@astrazeneca.com)
Date: Fri May 21 16:09:20 2004
Subject: [Rd] Failure to preserve package attribute when coercing S4 objects
	(PR#6904)
Message-ID: <20040521140918.7B593105A7@slim.kubism.ku.dk>


If a class is derived from a superclass using 'contains', then coercion of
an object from the class to the superclass fails to preserve the 'package'
attribute of class of the object.
This occurs only when the derived class has no additional slots.
This is a problem because the 'new' function relies on the exact identity
of the class, including the package attribute.  

This can clearly be worked around by the introduction of dummy slots, but it
took me some time to track down.

> setClass("baseClass",representation(a="numeric"))
[1] "baseClass"
> setClass("fancyClass",contains="baseClass")
[1] "fancyClass"
>
setClass("fancyClassExtraSlots",representation(b="numeric"),contains="baseCl
ass")
[1] "fancyClassExtraSlots"
> 
> 
> aFP <- new("fancyClass",a=2)
> aFP2 <- new("fancyClassExtraSlots",a=2,b=3)
> 
> aBP <- new("baseClass",a=1)
> aBPcast <- as(aFP,"baseClass")
> aBPcast2 <- as(aFP2,"baseClass")
> # all the baseClass objects have the right class
> sapply(list(aBP,aBPcast,aBPcast2),class)
[1] "baseClass" "baseClass" "baseClass"
> # however the object cast from a fancy class with no slots has a different
package attribute
> sapply(list(aBP,aBPcast,aBPcast2),function(x)attr(class(x),"package"))
[[1]]
[1] ".GlobalEnv"

[[2]]
NULL

[[3]]
[1] ".GlobalEnv"

> new("baseClass",aBP) # works
An object of class "baseClass"
Slot "a":
[1] 1

> new("baseClass",aBPcast) # fails. Note the error message!
Error in initialize(value, ...) : Initialize method returned an object of
class "baseClass" instead of the required class "baseClass"

> new("baseClass",aBPcast2) # works
An object of class "baseClass"
Slot "a":
[1] 2


platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    9.0            
year     2004           
month    04             
day      12             
language R

Jonathan Swinton, Statistical Scientist, Computational Biology, Pathway
Analysis, Global Sciences and Information,  x29400, 19F44 Mereside Alderley
Park.

From stefano.iacus at unimi.it  Fri May 21 19:47:10 2004
From: stefano.iacus at unimi.it (stefano iacus)
Date: Fri May 21 19:47:16 2004
Subject: [Rd] Memory Leak in OS X versions? (PR#6903)
In-Reply-To: <20040521132440.BA60A10590@slim.kubism.ku.dk>
References: <20040521132440.BA60A10590@slim.kubism.ku.dk>
Message-ID: <E28579DF-AB4E-11D8-8DA0-000A95C87F66@unimi.it>

I can confirm the behaviour (btw, 1.9.0 is not beta) in 1.9.0 and in 
R-patched

I'll try to investigate.
stefano


On May 21, 2004, at 3:24 PM, dvanbrunt@well-wired.com wrote:

> Full_Name: David L. Van Brunt
> Version: 1.8-1.9 beta
> OS: OS X 10.3
> Submission from: (NULL) (68.74.58.109)
>
>
> As posted on R-Help (after which another user replicated the problem):
> ---------------
> This is the conclusion from a prior thread ([R] " cannot allocate 
> vector of
> length 1072693248") which ended with no other answer but that there 
> must be
> a problem in the OS X version of R, or in the compile of the source on 
> OS X.
>
> I?ve posted code and data here:
> http://www.well-wired.com/reflibrary/uploads/1084503247.zip
>
> If you setwd() into the directory that is made, then ?source()? the 
> ?.R?
> file, it should run fine on Windows but crash on any machine with OS X
> (Panther) giving: ?Error in as.vector(data) : cannot allocate vector of
> length 1073741824? after a few iterations of the loop.
>
> I've repeated this on a Powerbook G4 with 500 MB of RAM, an iMac with 
> 128M
> of RAM, and a Dual 2GHz G5 with 1.5 Gig of RAM. Have used the Raqua, 
> the
> Frameworks installation, and a fresh compile of the source using Fink 
> in the
> X11 implementation. No matter the machine or the version (1.8x through 
> 1.9,
> OS X or Unix X11), I get the same result.
>
> Thanks to Andy Liaw for helping me tune the code this far.
>
> I'm stumped. Would love to hear others' experience with this, and if 
> they
> can reproduce the problem elsewhere.
>
>
> -- 
> David L. Van Brunt, Ph.D.
> Outlier Consulting & Development
> mailto: <ocd@well-wired.com>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From pburns at pburns.seanet.com  Fri May 21 22:20:43 2004
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Fri May 21 22:21:44 2004
Subject: [Rd] search and missing library
Message-ID: <40AE649B.7090401@pburns.seanet.com>

I'm not sure what is going on with this one -- maybe it will make
sense to someone.

R1.9.0 under Windows 2000.

1) Start up R.

2) search() # works as expected

3) library(fBasics)  # from Rmetrics
# but at least one of its required packages is not present on the machine

4) search()  # nothing appears at all but the prompt

Once all of the required packages are present, then step 3 no longer
causes search() to fail.


Patrick Burns

Burns Statistics
patrick@burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

From cere at u.washington.edu  Fri May 21 23:04:05 2004
From: cere at u.washington.edu (Cere Davis)
Date: Fri May 21 23:04:10 2004
Subject: [Rd] compiling R 64-bit with gcc on Solaris 9 
Message-ID: <40AE6EC5.6060309@u.washington.edu>

Hi folks,

I am trying to compile R as a 64bit app using gcc on Solaris 9 and get 
the following error from the configure script when passing the script 
CFLAGS='-mcpu=v9 -m64':

checking how to get verbose linking output from g77... -v
checking for Fortran libraries of g77...  -L/usr/ccs/lib -L/usr/lib 
-L/usr/local/lib -L/usr/local/lib/gcc-lib/sparc-sun-solaris2.9/3.3 
-L/usr/ccs/bin 
-L/usr/local/lib/gcc-lib/sparc-sun-solaris2.9/3.3/../../.. -lfrtbegin 
-lg2c -lm -lgcc_s
checking for dummy main to link with Fortran libraries... unknown
configure: error: linking to Fortran libraries from C fails
See `config.log' for more details.


I take this to mean that configure is looking for dummy main functions 
or #DEFINES in the R code right?  Has anyone seen this problem before?

thanks,
Cere

From jkbreaux at san.rr.com  Sat May 22 06:34:14 2004
From: jkbreaux at san.rr.com (jkbreaux@san.rr.com)
Date: Sat May 22 06:34:19 2004
Subject: [Rd] Inaccurate and Inconsistent results from 'round' function
	(PR#6905)
Message-ID: <20040522043414.69F081058F@slim.kubism.ku.dk>

Full_Name: Jim Breaux
Version: 1.9.0
OS: WinXP
Submission from: (NULL) (209.78.110.135)


According to the help for 'round' it is supposed to round to the even digit. 
However, see the following examples:

In the following, R is rounding down:
> round(0.3645, 3)
[1] 0.364
> round(0.3655, 3)
[1] 0.365
> round(0.3665, 3)
[1] 0.366
> round(0.3675, 3)
[1] 0.367
> round(0.3685, 3)
[1] 0.368
> round(0.3695, 3)
[1] 0.369

However, in the examples below, R sometimes rounds to the even digit and
sometimes to the odd digit:
> round(40.3695, 3)
[1] 40.37
> round(40.3685, 3)
[1] 40.368
> round(40.3675, 3)
[1] 40.367
> round(40.3665, 3)
[1] 40.367
> round(40.3655, 3)
[1] 40.365

From ripley at stats.ox.ac.uk  Sat May 22 10:12:50 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 22 10:12:53 2004
Subject: [Rd] compiling R 64-bit with gcc on Solaris 9 
In-Reply-To: <40AE6EC5.6060309@u.washington.edu>
Message-ID: <Pine.LNX.4.44.0405220902370.4289-100000@gannet.stats>

On Fri, 21 May 2004, Cere Davis wrote:

> Hi folks,
> 
> I am trying to compile R as a 64bit app using gcc on Solaris 9 and get 
> the following error from the configure script when passing the script 
> CFLAGS='-mcpu=v9 -m64':

Did you also set FFLAGS?  Did you read and follow the example in the 
R-admin manual.  I assume the latter as the INSTALL file asks you to read 
that manual.

> checking how to get verbose linking output from g77... -v
> checking for Fortran libraries of g77...  -L/usr/ccs/lib -L/usr/lib 
> -L/usr/local/lib -L/usr/local/lib/gcc-lib/sparc-sun-solaris2.9/3.3 
> -L/usr/ccs/bin 
> -L/usr/local/lib/gcc-lib/sparc-sun-solaris2.9/3.3/../../.. -lfrtbegin 
> -lg2c -lm -lgcc_s

I see no sign of 64-bit libraries (sparcv9) in there.

> checking for dummy main to link with Fortran libraries... unknown

(that's OK, as none is needed.)

> configure: error: linking to Fortran libraries from C fails
> See `config.log' for more details.
> 
> 
> I take this to mean that configure is looking for dummy main functions 
> or #DEFINES in the R code right?  Has anyone seen this problem before?

No, yes.  If is saying it cannot run mixed Fortran and C code.

Please do look in the config.log file for the details, as it says (and 
*please* do so before posting, as we cannot read the file for you).

When I saw this it was because the 64-bit shared libraries
(/usr/local/lib/sparcv9?) were not in my LD_LIBRARY_PATH.  But I believe
you have not set up your compilers compatibly, and that you did not read
the manual as requested.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat May 22 10:38:00 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 22 10:38:07 2004
Subject: (PR#6896) Re: [Rd] R with shared library support: 'make check' fails
	with unresolved symbol (PR#6896)
In-Reply-To: <20040519213922.AE69C10593@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405220931240.4289-100000@gannet.stats>

I am sorry, but that is not a platform the core team has easy access to,
and no one responded with any changes in the beta-testing period so we can 
reasonably assume that users on that platform were succeeding.

First check: you DID read the R-admin manual and follow the advice there?
This looks like a broken BLAS library and you are advised to use 
--without-blas ....

On Wed, 19 May 2004 garvin@cs.rice.edu wrote:

> Full_Name: John Garvin
> Version: 1.9.0
> OS: OSF1 Alpha ev6
> Submission from: (NULL) (128.42.129.78)
> 
> 
> I configured R 1.9.0 with --enable-R-shlib on Alpha. 'make check' fails with an
> unresolved symbol. Here's the relevant output:
> 
> running code in 'reg-tests-1.R'
> ...529442:/home/garvin/research/tel/R-alpha/unpatched/R-1.9.0/lib/R/bin/R.bin:
> /sbin/loader: Fatal Error: call to unresolved symbol from
> /home/garvin/research/tel/R-alpha/unpatched/R-1.9.0/lib/R/modules/lapack.so
> (pc=0x3ffbfde345c)
> 
> I'm using Compaq cc version V6.4-009 and ld version 5.1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dmurdoch at pair.com  Sat May 22 11:43:39 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Sat May 22 11:44:07 2004
Subject: [Rd] search and missing library
In-Reply-To: <40AE649B.7090401@pburns.seanet.com>
References: <40AE649B.7090401@pburns.seanet.com>
Message-ID: <g28ua05cdu9v1e5rji43s28p44vhlqqfu6@4ax.com>

On Fri, 21 May 2004 21:20:43 +0100, Patrick Burns
<pburns@pburns.seanet.com> wrote:

>I'm not sure what is going on with this one -- maybe it will make
>sense to someone.
>
>R1.9.0 under Windows 2000.
>
>1) Start up R.
>
>2) search() # works as expected
>
>3) library(fBasics)  # from Rmetrics
># but at least one of its required packages is not present on the machine
>
>4) search()  # nothing appears at all but the prompt
>
>Once all of the required packages are present, then step 3 no longer
>causes search() to fail.

Can you reproduce this with a CRAN package?  If not, it's probably a
bug that should be reported to the package author.

Duncan Murdoch

From dmurdoch at pair.com  Sat May 22 11:49:21 2004
From: dmurdoch at pair.com (dmurdoch@pair.com)
Date: Sat May 22 11:49:23 2004
Subject: [Rd] Inaccurate and Inconsistent results from 'round' function
	(PR#6905)
Message-ID: <20040522094921.A98721058C@slim.kubism.ku.dk>

On Sat, 22 May 2004 06:34:14 +0200 (CEST), jkbreaux@san.rr.com wrote:

>Full_Name: Jim Breaux
>Version: 1.9.0
>OS: WinXP
>Submission from: (NULL) (209.78.110.135)
>
>
>According to the help for 'round' it is supposed to round to the even digit. 
>However, see the following examples:

This is not a bug.  The problem is that floating point types do not
represent all decimal values exactly, so when you say

 > round(40.3655, 3)
 [1] 40.365

you are actually rounding a number which is slightly smaller than
40.3655.  The rounding works as advertised on exactly representable
numbers:

 > round(0.25,1)
 [1] 0.2
 > round(0.75,1)
 [1] 0.8

Duncan Murdoch

From ripley at stats.ox.ac.uk  Sat May 22 12:42:31 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 22 12:42:41 2004
Subject: [Rd] Buglet/omission in nls package (PR#6901)
In-Reply-To: <20040521064138.1DC28105A5@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405221137001.12669-100000@gannet.stats>

Berwin,

No one has said the coef() will work on a summary object, but it would be 
nice if it did where appropriate.

I've added an summary.nls method for 2.0.0.

Brian

On Fri, 21 May 2004 berwin@maths.uwa.edu.au wrote:

> Dear all,
> 
> I noticed the following under R 1.8.1 (when nls was still a separate
> package) but the same problem occurs under R 1.9.0 (where most (all?)
> of nls is now in the stats package):

`all of nls', indeed.

> > data(Puromycin)
> > fm <- nls(rate~SSmicmen(conc,b0,b1), Puromycin, subset = state=="treated")
> > coef(summary(fm))
> NULL
> 
> The problem seems to be that summary.nls uses the name "parameters"
> instead of the name "coefficients" for the matrix with the estimates,
> standard errors, t values and p values:
> 
> > summary(fm)$parameters
>        Estimate  Std. Error   t value     Pr(>|t|)
> b0 212.68370728 6.947153198 30.614512 3.241160e-11
> b1   0.06412123 0.008280944  7.743227 1.565136e-05
> 
> Thus, coef.default fails on an object of class "summary.nls".
> 
> Possible fixes:
> 1) Rename that part of the summary.nls structure from parameters to
>    coefficients  (not sure if that breaks something else); or
> 2) Write a coef.summary.nls method that returns the structure
>    parameter from a summary.nls object passed to it.
> 
> Cheers,
> 
>         Berwin
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = 
>  major = 1
>  minor = 9.0
>  year = 2004
>  month = 04
>  day = 12
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:methods, package:stats, package:graphics, package:utils, Autoloads, package:base
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From berwin at maths.uwa.edu.au  Sat May 22 13:17:02 2004
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Sat May 22 13:17:15 2004
Subject: [Rd] Buglet/omission in nls package (PR#6901)
In-Reply-To: <Pine.LNX.4.44.0405221137001.12669-100000@gannet.stats>
References: <20040521064138.1DC28105A5@slim.kubism.ku.dk>
	<Pine.LNX.4.44.0405221137001.12669-100000@gannet.stats>
Message-ID: <16559.13998.438223.381658@bossiaea.maths.uwa.edu.au>

G'day Brian,

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

    BDR> No one has said the coef() will work on a summary object,
But no one said that coef() will not work on a summary object either. :)

    BDR> but it would be nice if it did where appropriate.
Agreed, I looked up the help page and I think it is a bit ambiguous
about this point.  It starts off with:

   Description:
   
        'coef' is a generic function which extracts model coefficients
        from objects returned by modeling functions.  [...]

O.k., summary functions are not modeling functions, so one can argue
that one cannot expect coef() to work on summary objects.  But then
the help page continues and says:

   Arguments:
   
     object: an object for which the extraction of model coefficients is
             meaningful.

And I would argue that the extraction of model coefficients is indeed
meaningful for objects of class "summary.lm", "summary.nls",
"summary.glm" and probably a few others too. :)
OTOH, extracting model coefficient from an object of class
"summary.aov" is probably not meaningful....

    BDR> I've added an summary.nls method for 2.0.0.
Thanks!

Cheers,

        Berwin

From ripley at stats.ox.ac.uk  Sun May 23 08:27:20 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun May 23 08:27:25 2004
Subject: [Rd] arima problems when using argument fixed=
In-Reply-To: <4095246E.13614.13386CE@localhost>
Message-ID: <Pine.LNX.4.44.0405230723490.5356-100000@gannet.stats>

I don't see your point here.   If you fix a value, it is fixed and the 
initial value you give is irrelevant.  That is stated quite clearly

   fixed: optional numeric vector of the same length as the total
          number of parameters.  If supplied, only 'NA' entries in
          'fixed' will be varied. 

It looks like you have misread that.


On Sun, 2 May 2004 kjetil@acelerate.com wrote:

> As I am reading ?arima, only NA entries in the argument fixed= 
> imports. The following seems to indicate otherwise:

What does `imports' mean?  That's not on the help page.

> 
> 
> 
>  x <- arima.sim(model=list(ar=0.8), n=100) + (1:100)/50
> > t <- 1:100
> > mod1 <- lm(x ~ t)
> > 
> > init1  <- c(0, coef(mod1)[2])
> > fixed1 <- c(as.numeric(NA), 0)
> > 
> > arima(x, order=c(1,0,0), xreg=t, include.mean=FALSE, init=init1, 
> fixed=fixed1)
> 
> Call:
> arima(x = x, order = c(1, 0, 0), xreg = t, include.mean = FALSE, 
> fixed = fixed1, 
>     init = init1)
> 
> Coefficients:
>          ar1  t
>       0.9281  0
> s.e.  0.0357  0
> 
> sigma^2 estimated as 0.9186:  log likelihood = -138.64,  aic = 281.28
> > 
> > init2 <- init1
> > init2[2] <- 0
> > 
> > fixed2 <- init1
> > fixed2[1] <- as.numeric(NA)
> > 
> > arima(x, order=c(1,0,0), xreg=t, include.mean=FALSE, init=init2, 
> fixed=fixed2)
> 
> Call:
> arima(x = x, order = c(1, 0, 0), xreg = t, include.mean = FALSE, 
> fixed = fixed2, 
>     init = init2)
> 
> Coefficients:
>          ar1       t
>       0.7888  0.0377
> s.e.  0.0593  0.0000
> 
> sigma^2 estimated as 0.8452:  log likelihood = -133.97,  aic = 271.94
> > 
> 
> > fixed1
> [1] NA  0
> > fixed2
>                     t 
>         NA 0.03767406 
> 
> > arima(x, order=c(1,0,0), xreg=t, include.mean=FALSE, init=init2, 
> fixed=fixed1)
> 
> Call:
> arima(x = x, order = c(1, 0, 0), xreg = t, include.mean = FALSE, 
> fixed = fixed1, 
>     init = init2)
> 
> Coefficients:
>          ar1  t
>       0.9281  0
> s.e.  0.0357  0
> 
> sigma^2 estimated as 0.9186:  log likelihood = -138.64,  aic = 281.28

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ulao at accom.lon.ac.uk  Sun May 23 14:03:46 2004
From: ulao at accom.lon.ac.uk (ulao@accom.lon.ac.uk)
Date: Sun May 23 14:04:11 2004
Subject: [Rd] RE: {Virus?} {Spam?} Hi
Message-ID: <B9C9365519825A4BAE9895081C929EB90117FC95@email.lon.ac.uk>

Thank you for your email to the UNIVERSITY OF LONDON 
ACCOMMODATION OFFICE (ULAO). 

This automatic reply has been made necessary by the volume of emails we 
receive; you should not reply to it. Please be advised that if your email is of 
a general nature and the links below direct you to the information, we will not 
be able to send you an individual reply. If we do not reply to you within 
3 working days and you have been unable to find the information from the 
links below please contact us again telling us you have not been able to 
find the information and restate as specifically as possible your question.

Most general questions can be answered by referring to the A-Z section 
of our website:
http://housing.lon.ac.uk/site7/AZ.htm 
Some specific areas of common enquiry: 
CAN WE HELP YOU?
http://housing.lon.ac.uk/site7/College.htm
I START NEXT SEPTEMBER CAN YOU HELP?
As no suitable offers are published prior to MAY you should re-apply for a 
password at the end of APRIL. You will not be sent a password 
until then. Additionally we can only assist those that have a confirmed 
unconditional offer or have met the terms of their offer. 
HOW DO I START FINDING SOMEWHERE TO LIVE?
http://housing.lon.ac.uk/site7/faq.htm
WHERE TO LIVE FOR NEXT SEPTEMBER (2004)?
Please refer back to the ULAO in May 04 for the first information
about property available for next September.
WHAT ADVICE CAN I GET FROM THE ULAO?
http://housing.lon.ac.uk/site7/advice.htm 
WHERE ARE YOU AND WHEN ARE YOU OPEN? 
http://housing.lon.ac.uk/site7/Getting.htm
Web Site:
http://housing.lon.ac.uk
WHERE ARE THE OFFERS OF PRIVATE ACCOMMODATION?
>From Private Landlords?
http://housing.lon.ac.uk/site7/Databasesearch.htm
>From Accommodation Agencies?
http://housing.lon.ac.uk/site7/AgencyGuide.htm 
>From other Students?
http://housing.lon.ac.uk/site7/SCL.htm
WHERE DO STUDENTS LIVE? 
Can you recommend any areas?
http://housing.lon.ac.uk/site7/Postcodes/Area.htm 

LANDLORDS:
I own property how can I advertise to students
looking for somewhere to live:
http://housing.lon.ac.uk/Landlords/HomePage.htm
I am a registered Landlord how can I
check my advertisements and registration details?
http://housing.lon.ac.uk/new_database/ll_login.php 

I DON'T WANT TO LIVE IN THE PRIVATE SECTOR:
Does the University offer any alternatives to Halls
or renting from a Landlord?
http://housing.lon.ac.uk/site7/AZ.htm#pmu 

Do you have any information about Halls of Residence?
http://housing.lon.ac.uk/site7/Halls.htm
Who deals with my College halls?
http://housing.lon.ac.uk/site7/Halls.htm#key 
Are there any other halls?
www.lcos.org.uk 

SOMEWHERE TO STAY ON A SHORT TERM BASIS? 
Can I stay in the University Halls during the vacation?
http://housing.lon.ac.uk/site7/AZ.htm#vacation 
anywhere else?
http://housing.lon.ac.uk/site7/Looking.htm 
on a limited budget?
http://housing.lon.ac.uk/site7/Hotels.htm 

Flats, Houses and Rooms over the summer?
Details available for collection from the ULAO on
production of your valid Student ID card from June 04 

Where can I find information about studying
at the University of London?
http://www.lon.ac.uk/Courses_Research
or email enquiries@eisa.lon.ac.uk

From ramsey at landcareresearch.co.nz  Mon May 24 05:00:05 2004
From: ramsey at landcareresearch.co.nz (ramsey@landcareresearch.co.nz)
Date: Mon May 24 05:00:09 2004
Subject: [Rd] bug in extractAIC.survreg (PR#6909)
Message-ID: <20040524030005.255DB10559@slim.kubism.ku.dk>

Full_Name: Dave Ramsey
Version: 1.8.0
OS: win2000
Submission from: (NULL) (202.27.240.6)


there is a bug in extractAIC.survreg in library MASS.

A survreg model object has no component called "residuals".  Hence  

n <- length(fit$residuals)

returns 0 resulting in errors 

workaround:   replace 

n <- length(fit$residuals)

with

n <- length(residuals(fit))

From ramseyd at landcareresearch.co.nz  Mon May 24 05:01:21 2004
From: ramseyd at landcareresearch.co.nz (ramseyd@landcareresearch.co.nz)
Date: Mon May 24 05:01:23 2004
Subject: [Rd] bug in extractAIC.survreg (PR#6910)
Message-ID: <20040524030121.E94B410559@slim.kubism.ku.dk>

Full_Name: Dave Ramsey
Version: 1.8.0
OS: win2000
Submission from: (NULL) (202.27.240.6)


there is a bug in extractAIC.survreg in library MASS.

A survreg model object has no component called "residuals".  Hence  

n <- length(fit$residuals)

returns 0 resulting in errors 

workaround:   replace 

n <- length(fit$residuals)

with

n <- length(residuals(fit))

### sorry: error in my email address on previous posting

From ripley at stats.ox.ac.uk  Mon May 24 08:24:51 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May 24 08:25:02 2004
Subject: [Rd] bug in extractAIC.survreg (PR#6910)
In-Reply-To: <20040524030121.E94B410559@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405240718220.14723-100000@gannet.stats>

The currrent version of R is 1.9.0, and that has public patches which say
(in the NEWS file)

    o	extractAIC.survreg() needed updating.

The R posting guide does ask you to check the latest version before 
wasting people's time.

It is a double waste of time to send this twice (as 6909 as well): please 
do read the description of how to add to a previous report.


On Mon, 24 May 2004 ramseyd@landcareresearch.co.nz wrote:

> Full_Name: Dave Ramsey
> Version: 1.8.0
> OS: win2000
> Submission from: (NULL) (202.27.240.6)
> 
> 
> there is a bug in extractAIC.survreg in library MASS.

extractAIC.survreg is not in *package* MASS:

> getAnywhere("extractAIC.survreg")
A single object matching 'extractAIC.survreg' was found
It was found in the following places
  registered S3 method for extractAIC from namespace stats
  namespace:stats
with value

function (fit, scale, k = 2, ...)
{
    edf <- sum(fit$df)
    c(edf, -2 * fit$loglik[2] + k * edf)
}
<environment: namespace:stats>

Had you thought so, you should have communicated with the package 
maintainer (and told him the package version).


> A survreg model object has no component called "residuals".  Hence  
> 
> n <- length(fit$residuals)
> 
> returns 0 resulting in errors 
> 
> workaround:   replace 
> 
> n <- length(fit$residuals)
> 
> with
> 
> n <- length(residuals(fit))
> 
> ### sorry: error in my email address on previous posting
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From garvin at rice.edu  Mon May 24 17:00:52 2004
From: garvin at rice.edu (John Garvin)
Date: Mon May 24 17:01:03 2004
Subject: (PR#6896) Re: [Rd] R with shared library support: 'make check'
	fails with unresolved symbol (PR#6896)
In-Reply-To: <Pine.LNX.4.44.0405220931240.4289-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0405240951060.15213-100000@hpc3.cs.rice.edu>

That was my first thought, but the same error occurs when configured 
--without-blas as well as --with-blas; also both --with-lapack and 
--without-lapack.

(There are users who ask questions without reading the manual? I'm
shocked! ;-) )

JLG

On Sat, 22 May 2004, Prof Brian Ripley wrote:

> I am sorry, but that is not a platform the core team has easy access to,
> and no one responded with any changes in the beta-testing period so we can 
> reasonably assume that users on that platform were succeeding.
> 
> First check: you DID read the R-admin manual and follow the advice there?
> This looks like a broken BLAS library and you are advised to use 
> --without-blas ....
> 
> On Wed, 19 May 2004 garvin@cs.rice.edu wrote:
> 
> > Full_Name: John Garvin
> > Version: 1.9.0
> > OS: OSF1 Alpha ev6
> > Submission from: (NULL) (128.42.129.78)
> > 
> > 
> > I configured R 1.9.0 with --enable-R-shlib on Alpha. 'make check' fails with an
> > unresolved symbol. Here's the relevant output:
> > 
> > running code in 'reg-tests-1.R'
> > ...529442:/home/garvin/research/tel/R-alpha/unpatched/R-1.9.0/lib/R/bin/R.bin:
> > /sbin/loader: Fatal Error: call to unresolved symbol from
> > /home/garvin/research/tel/R-alpha/unpatched/R-1.9.0/lib/R/modules/lapack.so
> > (pc=0x3ffbfde345c)
> > 
> > I'm using Compaq cc version V6.4-009 and ld version 5.1.
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

From mmiller3 at iupui.edu  Mon May 24 17:58:22 2004
From: mmiller3 at iupui.edu (mmiller3@iupui.edu)
Date: Mon May 24 17:58:25 2004
Subject: [Rd] error in make.names docs (PR#6912)
Message-ID: <20040524155822.9E894EB66@slim.kubism.ku.dk>

Full_Name: Mike Miller
Version: 1.9.0
OS: win2000
Submission from: (NULL) (134.68.121.109)


The docs for make.names imply that the result of 

   make.names(c("a and b", "a_and_b"), unique=TRUE)

should be 
   
    "a.and.b"  "a.and.b.1"

when it is actually 

    "a.and.b" "a_and_b"

The docs do not reflect this very major change in behavior from 1.8.x to 1.9.0. 
This change causes numerous R codes to fail in senarios like the following. 
Suppose I have a data file, example.dat, like this:

a b x   some_factor
1 1 0.4 orange
2 1 0.3 blue
1 1 0.2 dog
2 1 0.1 orange
1 2 0.4 blue
2 2 0.3 dog
1 2 0.2 orange
2 2 0.1 blue

To read and use this in a version independent way, I've tried to write
version-aware code, but this is difficult as '_' is not syntactically valid
prior to R 1.9.0.  If it were, the following code might work.  Of course, if '_'
were allowed, this issue would not be be a problem.

df <- read.table('example.dat',header=T)
if ( version['minor'] == "9.0" ) {
  plot(x ~ some_factor, data=df)
} else {
  plot(x ~ some.factor, data=df)
}

From ripley at stats.ox.ac.uk  Mon May 24 18:04:23 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May 24 18:04:34 2004
Subject: [Rd] error in make.names docs (PR#6912)
In-Reply-To: <20040524155822.9E894EB66@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405241703230.4717-100000@gannet.stats>

Example output in comment is now corrected in R-patched.
What has the rest to do with a bug report?

On Mon, 24 May 2004 mmiller3@iupui.edu wrote:

> Full_Name: Mike Miller
> Version: 1.9.0
> OS: win2000
> Submission from: (NULL) (134.68.121.109)
> 
> 
> The docs for make.names imply that the result of 
> 
>    make.names(c("a and b", "a_and_b"), unique=TRUE)
> 
> should be 
>    
>     "a.and.b"  "a.and.b.1"
> 
> when it is actually 
> 
>     "a.and.b" "a_and_b"
> 
> The docs do not reflect this very major change in behavior from 1.8.x to 1.9.0. 
> This change causes numerous R codes to fail in senarios like the following. 
> Suppose I have a data file, example.dat, like this:
> 
> a b x   some_factor
> 1 1 0.4 orange
> 2 1 0.3 blue
> 1 1 0.2 dog
> 2 1 0.1 orange
> 1 2 0.4 blue
> 2 2 0.3 dog
> 1 2 0.2 orange
> 2 2 0.1 blue
> 
> To read and use this in a version independent way, I've tried to write
> version-aware code, but this is difficult as '_' is not syntactically valid
> prior to R 1.9.0.  If it were, the following code might work.  Of course, if '_'
> were allowed, this issue would not be be a problem.
> 
> df <- read.table('example.dat',header=T)
> if ( version['minor'] == "9.0" ) {
>   plot(x ~ some_factor, data=df)
> } else {
>   plot(x ~ some.factor, data=df)
> }
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From mmiller3 at iupui.edu  Mon May 24 18:17:55 2004
From: mmiller3 at iupui.edu (Michael A. Miller)
Date: Mon May 24 18:17:59 2004
Subject: [Rd] error in make.names docs (PR#6912)
In-Reply-To: <Pine.LNX.4.44.0405241703230.4717-100000@gannet.stats> (Brian
	Ripley's message of "Mon, 24 May 2004 17:04:23 +0100 (BST)")
References: <Pine.LNX.4.44.0405241703230.4717-100000@gannet.stats>
Message-ID: <878yfhpznw.fsf@lumen.indyrad.iupui.edu>

>>>>> "Prof" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

    > Example output in comment is now corrected in R-patched.
    > What has the rest to do with a bug report?

This is a major show stopper which suddenly moves R code from
last month into the category of legacy code.  In my opinion, this
really should have been a major version change, not just a minor
release. 

Version 1.9.0 fails to execute many R codes.  This version
dependency will require a great deal of work to check and
re-validate codes to make the switch to R 1.9.0.  That change
will then make our codes incompatible with R 1.8.1, which is our
current production version.  At the moment, I don't know how we
can handle this without great cost in time, so it seems likely
that we'll need to stay with 1.8.1.  That is unfortunate, as R's
platform dependence has made it really wonderful to use.  This
version incompatibility will make it increasingly cumbersome as
time goes on, more than offsetting the platform independence.

Mike

-- 
Michael A. Miller                               mmiller3@iupui.edu
  Imaging Sciences, Department of Radiology, IU School of Medicine

From ripley at stats.ox.ac.uk  Mon May 24 18:25:19 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May 24 18:25:30 2004
Subject: [Rd] error in make.names docs (PR#6912)
In-Reply-To: <878yfhpznw.fsf@lumen.indyrad.iupui.edu>
Message-ID: <Pine.LNX.4.44.0405241720400.7803-100000@gannet.stats>

On Mon, 24 May 2004, Michael A. Miller wrote:

> >>>>> "Prof" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
>     > Example output in comment is now corrected in R-patched.
>     > What has the rest to do with a bug report?
> 
> This is a major show stopper which suddenly moves R code from
> last month into the category of legacy code.  In my opinion, this

In truth, 1.9.0 was released last month and in alpha/beta test for a month 
before that.

> really should have been a major version change, not just a minor
> release. 

And what has that to do with a bug report?  Have you read the definition
of a bug in the FAQ?  Not doing what Mr Miller wants is not a bug
according to that definition.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Mon May 24 18:20:15 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon May 24 18:26:06 2004
Subject: [Rd] error in make.names docs (PR#6912)
In-Reply-To: <Pine.LNX.4.44.0405241703230.4717-100000@gannet.stats>
References: <Pine.LNX.4.44.0405241703230.4717-100000@gannet.stats>
Message-ID: <x2k6z1u79c.fsf@biostat.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> Example output in comment is now corrected in R-patched.
> What has the rest to do with a bug report?

He's hoping (with some reason) that the change of behaviour was the
bug. I seem to recall some internal discussion of the effect, but not
whether it just got forgotten or whether you might as well just do 
gsub(...something...) on the names of the dataframe.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Mon May 24 18:26:35 2004
From: p.dalgaard at biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon May 24 18:26:37 2004
Subject: [Rd] error in make.names docs (PR#6912)
Message-ID: <20040524162635.795A3EAC7@slim.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> Example output in comment is now corrected in R-patched.
> What has the rest to do with a bug report?

He's hoping (with some reason) that the change of behaviour was the
bug. I seem to recall some internal discussion of the effect, but not
whether it just got forgotten or whether you might as well just do 
gsub(...something...) on the names of the dataframe.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Mon May 24 21:21:57 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May 24 21:22:49 2004
Subject: [Rd] Bug in update()? (PR#6902)
In-Reply-To: <20040521072200.A1F9C1058F@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0405242018170.31253-100000@gannet.stats>

Berwin,

It's fortuitous that this works at all.

The problem is not in update but in glm itself: take a look at fm$formula
after the first fit.  fm$terms has the right formula, but formula() 
extracts the $formula component first.

I am not currently sure what the right fix is, so will not try to fix this 
in R-patched/1.9.1.

Brian

On Fri, 21 May 2004 berwin@maths.uwa.edu.au wrote:

> Dear all,
> 
> I noticed the following while playing around with fitting log-linear
> models to contingency tables using R 1.8.1, but the problem also
> exists under R 1.9.0.
> 
> A reproducible example uses the following contingency table:
> 
> 
> > library(MASS)
> > data(quine)
> > tmp <- with(quine, expand.grid(Eth=levels(Eth), Sex=levels(Sex), 
> +                    Lrn=levels(Lrn), Age=levels(Age)))
> > n <- nrow(quine)
> > quine2 <- with(quine,
> +       data.frame(tmp,
> +       Count=as.vector(tapply(rep(1,n), list(Eth, Sex, Lrn, Age), sum))))
> 
> First fit a saturated model and see which term we can drop:
>     > fm <- glm(Count ~ .^4, quine2, family=poisson)
>     > drop1(fm, test="Chisq")
>     Single term deletions
>     
>     Model:
>     Count ~ .^4
>                     Df  Deviance     AIC     LRT Pr(Chi)
>     <none>             6.661e-16 148.916                
>     Eth:Sex:Lrn:Age  2     0.422 145.338   0.422    0.81
> 
> Drop the four-way interaction and check which term we can drop next:
>     > fm <- update(fm, . ~ . - Eth:Sex:Lrn:Age)
>     > drop1(fm, test="Chisq")
>     Single term deletions
>     
>     Model:
>     Count ~ .
>            Df Deviance     AIC     LRT  Pr(Chi)   
>     <none>      35.893 142.810                    
>     Eth     1   36.332 141.248   0.439 0.507811   
>     Sex     1   37.238 142.154   1.345 0.246237   
>     Lrn     1   37.392 142.308   1.499 0.220842   
>     Age     3   49.818 150.735  13.925 0.003009 **
>     ---
>     Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 
> 
> All of a sudden there are only the main effects left and all
> interaction terms have been removed.  I expected to see at this point
> a test for all three-way interactions.  Since I started of with the
> saturated model and used update to remove the four-way interaction,
> all two-way and three-way interactions should still be in the model.
> Or am I missing some subtlety of the "^" and "." operators in model
> formulae? 
> 
> On the other hand, if we specify the saturated model as follows:
> 
>     > fm <- glm(Count ~ Lrn*Eth*Sex*Age, quine2, family=poisson)
> 
> then the above steps have the desired effect:
> 
>     > drop1(fm, test="Chisq")
>     Single term deletions
>     
>     Model:
>     Count ~ Lrn * Eth * Sex * Age
>                     Df  Deviance     AIC     LRT Pr(Chi)
>     <none>             4.219e-15 148.916                
>     Lrn:Eth:Sex:Age  2     0.422 145.338   0.422    0.81
>     > fm <- update(fm, . ~ . - Eth:Sex:Lrn:Age)
>     > drop1(fm, test="Chisq")
>     Single term deletions
>     
>     Model:
>     Count ~ Lrn + Eth + Sex + Age + Lrn:Eth + Lrn:Sex + Eth:Sex + 
>         Lrn:Age + Eth:Age + Sex:Age + Lrn:Eth:Sex + Lrn:Eth:Age + 
>         Lrn:Sex:Age + Eth:Sex:Age
>                 Df Deviance     AIC     LRT  Pr(Chi)   
>     <none>            0.422 145.338                    
>     Lrn:Eth:Sex  1    0.493 143.409   0.071 0.789909   
>     Lrn:Eth:Age  2    0.629 141.545   0.207 0.901471   
>     Lrn:Sex:Age  2   12.728 153.644  12.306 0.002127 **
>     Eth:Sex:Age  3    1.019 139.935   0.597 0.897103   
>     ---
>     Signif. codes:  0 `***' 0.001 `**' 0.01 `*' 0.05 `.' 0.1 ` ' 1 
> 
> The update command only removed the four-way interaction but left all
> the two-way and three-way interaction in the model.  
> 
> I looked at update.formula to see what the problem might be, but after
> reading the help file of .Internal I stopped looking around.... :)
> 
> Cheers,
> 
>         Berwin
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = 
>  major = 1
>  minor = 9.0
>  year = 2004
>  month = 04
>  day = 12
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:MASS, package:methods, package:stats, package:graphics, package:utils, Autoloads, package:base
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Tue May 25 00:16:58 2004
From: p.dalgaard at biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Tue May 25 00:17:03 2004
Subject: [Rd] error in make.names docs (PR#6912)
Message-ID: <20040524221658.3ECCDEAD7@slim.kubism.ku.dk>

Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > Example output in comment is now corrected in R-patched.
> > What has the rest to do with a bug report?
> 
> He's hoping (with some reason) that the change of behaviour was the
> bug. I seem to recall some internal discussion of the effect, but not
> whether it just got forgotten or whether you might as well just do 
> gsub(...something...) on the names of the dataframe.

Apparently, the latter was the case. It is quite easy to fix the names
after reading, and adding a compatibility feature would be kludgy, and
not relieving you of changing the old code anyway. I have updated the
docs (for 1.9.1) with some more specific instructions about what to do:

diff -r1.9.4.1 make.names.Rd
31a32,36
> \note{
>   Prior to version 1.9.0, underscores were not valid in variable names,
>   and code that relies on them being converted to dots will no longer
>   work. The simplest workaround is to use \code{gsub("_", ".",
>   names)}.
> }

diff -r1.50 read.table.Rd
189a190,196
>
>   Prior to version 1.9.0, underscores were not valid in variable names,
>   and code that relies on them being converted to dots will no longer
>   work. The simplest workaround is to use
>    \code{names(d) <- gsub("_", ".", names(d))},
>   or, avoiding the (small) risk of creating duplicate names,
>    \code{names(d) <- make.names(gsub("_", ".", names(d)),
>   unique=TRUE)}.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From juan_sr at uol.com.br  Tue May 25 13:04:59 2004
From: juan_sr at uol.com.br (juan_sr@uol.com.br)
Date: Tue May 25 13:04:58 2004
Subject: [Rd] binary R for Fedora Core 2 e tcl
Message-ID: <1085483099.3969.10.camel@localhost.localdomain>

I update my linux version of FC1 for FC2.

FC2 uses tcl-8.4.5 and R-1.9.0 (rpm version for FC1, not install/not
run).

We have the rpm binary version at FC2?

-- 
Eng. Juan Santiago Ramseyer
Email: juan_sr@uol.com.br
Fones: 71-341.6473
       71-8806.6473

From plummer at iarc.fr  Tue May 25 14:41:34 2004
From: plummer at iarc.fr (Martyn Plummer)
Date: Tue May 25 14:41:55 2004
Subject: [Rd] binary R for Fedora Core 2 e tcl
In-Reply-To: <1085483099.3969.10.camel@localhost.localdomain>
References: <1085483099.3969.10.camel@localhost.localdomain>
Message-ID: <1085488894.6310.90.camel@nemo>

On Tue, 2004-05-25 at 13:04, juan_sr@uol.com.br wrote:
> I update my linux version of FC1 for FC2.
> 
> FC2 uses tcl-8.4.5 and R-1.9.0 (rpm version for FC1, not install/not
> run).
> 
> We have the rpm binary version at FC2?

Not yet.  I was going to upgrade, but then Marc Schwartz pointed out
this show-stopping bug, which may destroy your ability to dual-boot
windows (as I still do)

https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=115980

I have FC2 installed on a test machine. The X server appears to be quite
buggy (this should be no surprise as R has already been patched to work
around one bug) and I have some difficulty getting the NIC to work, so I
am not very impressed.

Bottom line: If you use FC2 then you are on the bleeding edge, and quite
possibly over it. I'll try to get RPMs ready for R 1.9.1 but I'm not
going to hose any of my production machines for your benefit.

Martyn

From MSchwartz at MedAnalytics.com  Tue May 25 17:04:27 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue May 25 17:04:35 2004
Subject: [Rd] binary R for Fedora Core 2 e tcl
In-Reply-To: <1085488894.6310.90.camel@nemo>
References: <1085483099.3969.10.camel@localhost.localdomain>
	<1085488894.6310.90.camel@nemo>
Message-ID: <1085497467.7195.120.camel@localhost.localdomain>

On Tue, 2004-05-25 at 07:41, Martyn Plummer wrote: 
> On Tue, 2004-05-25 at 13:04, juan_sr@uol.com.br wrote:
> > I update my linux version of FC1 for FC2.
> > 
> > FC2 uses tcl-8.4.5 and R-1.9.0 (rpm version for FC1, not install/not
> > run).
> > 
> > We have the rpm binary version at FC2?
> 
> Not yet.  I was going to upgrade, but then Marc Schwartz pointed out
> this show-stopping bug, which may destroy your ability to dual-boot
> windows (as I still do)
> https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=115980
> 
> I have FC2 installed on a test machine. The X server appears to be quite
> buggy (this should be no surprise as R has already been patched to work
> around one bug) and I have some difficulty getting the NIC to work, so I
> am not very impressed.
> 
> Bottom line: If you use FC2 then you are on the bleeding edge, and quite
> possibly over it. I'll try to get RPMs ready for R 1.9.1 but I'm not
> going to hose any of my production machines for your benefit.
> 
> Martyn


A follow on note to Martyn's, as he and I discussed this issue in Vienna
at useR!.

I downloaded the FC2 DVD iso image yesterday and will likely burn and
install it next weekend to see how things go. If I should bleed a
little, the good news is that my wife is a nurse...  ;-)

[I wonder if it was merely coincidence that my KLM flight from Amsterdam
back to Minneapolis on Sunday was named the Florence Nightingale....]

I also dual-boot FC1/WinXP, due to the need for some accounting software
that does not run properly under Linux (or Wine/CrossOver Office) yet.

I will not have to partition (or re-partition) my drive as that has
already been done (including a separate /home partition), so that should
hopefully avoid some of the pitfalls with the dual-boot scenario. The
issues appear to be related to problematic disk geometry representations
post FC2 partitioning operations. 

These issues when experienced, lead to at a minimum, problems booting
into Windows, to at a maximum, the complete loss of the Windows
partition and the data contained within it. This requires a reinstall of
Windows and restoration of offline backups. At minimum, a significant
loss of time.

I run nightly backups and my advice to anyone doing this is to have
offline backups of critical data, etc. before proceeding under this
scenario.

In the mean time, pending an official R RPM that contains the requisite
fixes, for those using FC2, you can download a current R patched tarball
(so that it has the FC2 X related fixes) and compile/install from
source, presuming of course that you have installed the required FC2
devel packages.

I think that Martyn's consideration of waiting on a FC2 RPM for R 1.9.1
is reasonable, since that would be an official R release with the FC2
related fixes.  Otherwise, it becomes to an extent, an arbitrary
decision as to which R patched tarball to use as the basis for a R
1.9.0.X FC2 RPM. That could complicate support.

HTH,

Marc Schwartz

From p.dalgaard at biostat.ku.dk  Tue May 25 17:35:13 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue May 25 17:41:17 2004
Subject: [Rd] binary R for Fedora Core 2 e tcl
In-Reply-To: <1085497467.7195.120.camel@localhost.localdomain>
References: <1085483099.3969.10.camel@localhost.localdomain>
	<1085488894.6310.90.camel@nemo>
	<1085497467.7195.120.camel@localhost.localdomain>
Message-ID: <x27jv0ldu6.fsf@biostat.ku.dk>

Marc Schwartz <MSchwartz@medanalytics.com> writes:

> I think that Martyn's consideration of waiting on a FC2 RPM for R 1.9.1
> is reasonable, since that would be an official R release with the FC2
> related fixes.  Otherwise, it becomes to an extent, an arbitrary
> decision as to which R patched tarball to use as the basis for a R
> 1.9.0.X FC2 RPM. That could complicate support.

I suppose the right way to do it is to take the official R-1.9.0.tgz
and put the relevant patch set in the spec file. Wouldn't worry too
much about support since Martyn's version is effectively the official
one. However, with 1.9.1 less than a month into the future, there's
not much point in messing with it now.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From MSchwartz at MedAnalytics.com  Tue May 25 18:01:32 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Tue May 25 18:01:41 2004
Subject: [Rd] binary R for Fedora Core 2 e tcl
In-Reply-To: <x27jv0ldu6.fsf@biostat.ku.dk>
References: <1085483099.3969.10.camel@localhost.localdomain>
	<1085488894.6310.90.camel@nemo>
	<1085497467.7195.120.camel@localhost.localdomain>
	<x27jv0ldu6.fsf@biostat.ku.dk>
Message-ID: <1085500891.7195.127.camel@localhost.localdomain>

On Tue, 2004-05-25 at 10:35, Peter Dalgaard wrote:
> Marc Schwartz <MSchwartz@medanalytics.com> writes:
> 
> > I think that Martyn's consideration of waiting on a FC2 RPM for R 1.9.1
> > is reasonable, since that would be an official R release with the FC2
> > related fixes.  Otherwise, it becomes to an extent, an arbitrary
> > decision as to which R patched tarball to use as the basis for a R
> > 1.9.0.X FC2 RPM. That could complicate support.
> 
> I suppose the right way to do it is to take the official R-1.9.0.tgz
> and put the relevant patch set in the spec file. Wouldn't worry too
> much about support since Martyn's version is effectively the official
> one. However, with 1.9.1 less than a month into the future, there's
> not much point in messing with it now.


True on all accounts.

Marc

From gregory_r_warnes at groton.pfizer.com  Tue May 25 20:37:50 2004
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Tue May 25 20:38:06 2004
Subject: [Rd] problems with plot.formula
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20C521411@groexmb02.pfizer.com>


With the recent changes in R 1.9.x, it is now impossible to properly call
plot on a formula() where the formula is provided via a named first
argument.  On today's R-1.9.1-alpha:

> x <- 1:10
> y <- rnorm(x,0.25)
> 
> plot(x~y)
> 
> plot(x=x~y)
Error in terms.formula(formula, data = data) : 
	argument is not a valid model
> 
> plot(formula=x~y)
Error in plot(formula = x ~ y) : Argument "x" is missing, with no default
> 

This occurs because plot.formula is no longer directly callable, and the
first argument to plot.formula() is 'formula' while the first argument to
plot() is 'x'.   Consequently one cannot properly pass a named first
argument since it will either fail for plot() or for plot.formula().  [I
suspect this is one reason why R CMD check complains about S3 methods that
don't match the call of the base method.]

This is much of a problem in interactive use, but it does cause problems in
functions, like my gregmisc::overplot(), which use the standard idiom

    m <- match.call()
    m[[1]] <- as.name('plot')
    eval(m, parent.frame() )

For the moment, I've had to resort to explicitly removing the name of the
first argument from the call:

    m <- match.call()
    m[[1]] <- as.name('plot')
    names(m)[2] <- ''
    eval(m, parent.frame() )

and since I have another function argument named f I also have to explicitly
mask that off

    m <- match.call()
    m[[1]] <- as.name('plot')
    names(m)[2] <- ''
    m$f <- NULL
    eval(m, parent.frame() )

What is going to happen with this problem of S3 method that don't match the
base signature?  Will these all the S3 methods be modified?  Or will some
sugar be introduced into the base method?  Or this this problem be
perennial, "so get used to it" ?

-Greg

Gregory R. Warnes
Manager, Non-Clinical Statistics
Pfizer Global Research and Development



LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From ripley at stats.ox.ac.uk  Tue May 25 21:44:34 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue May 25 21:44:40 2004
Subject: [Rd] problems with plot.formula
In-Reply-To: <D7A3CFD7825BD6119B880002A58F06C20C521411@groexmb02.pfizer.com>
Message-ID: <Pine.LNX.4.44.0405252039001.19552-100000@gannet.stats>

As this happens in exactly the same way in 1.8.1 and 1.9.0, why are you
blaming `recent changes in R 1.9.x'?  I am baffled as to what you think is
`recent'.

On Tue, 25 May 2004, Warnes, Gregory R wrote:

> 
> With the recent changes in R 1.9.x, it is now impossible to properly call
> plot on a formula() where the formula is provided via a named first
> argument.  On today's R-1.9.1-alpha:
> 
> > x <- 1:10
> > y <- rnorm(x,0.25)
> > 
> > plot(x~y)
> > 
> > plot(x=x~y)
> Error in terms.formula(formula, data = data) : 
> 	argument is not a valid model
> > 
> > plot(formula=x~y)
> Error in plot(formula = x ~ y) : Argument "x" is missing, with no default
> > 
> 
> This occurs because plot.formula is no longer directly callable, 

It is, via graphics:::plot.formula.

> and the
> first argument to plot.formula() is 'formula' while the first argument to
> plot() is 'x'.   Consequently one cannot properly pass a named first
> argument since it will either fail for plot() or for plot.formula().  [I
> suspect this is one reason why R CMD check complains about S3 methods that
> don't match the call of the base method.]
> 
> This is much of a problem in interactive use, but it does cause problems in
> functions, like my gregmisc::overplot(), which use the standard idiom
> 
>     m <- match.call()
>     m[[1]] <- as.name('plot')
>     eval(m, parent.frame() )

Not a standard idiom for a generic with a formula method, and I think you 
really should be dispatching to the method here.

[...]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From valenta at euromise.cz  Wed May 26 10:34:58 2004
From: valenta at euromise.cz (valenta@euromise.cz)
Date: Wed May 26 10:35:05 2004
Subject: [Rd] Saving Trellis Graphics in R 1.9.0. (PR#6915)
Message-ID: <20040526083458.0F1FB10980@slim.kubism.ku.dk>

Full_Name: Zdenek Valenta
Version: 1.9.0.
OS: Windows XP
Submission from: (NULL) (147.231.7.250)


I could not copy/save (Trelis) graphics using R version 1.9.0. The graphics
displayed normally, but copying/saving it only produced an empty file.
Everything works o.k. with R rel. 1.8.1.

Best regards,

Zdenek Valenta

From berwin at maths.uwa.edu.au  Wed May 26 11:44:27 2004
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Wed May 26 11:44:37 2004
Subject: [Rd] Bug in update()? (PR#6902)
In-Reply-To: <Pine.LNX.4.44.0405242018170.31253-100000@gannet.stats>
References: <20040521072200.A1F9C1058F@slim.kubism.ku.dk>
	<Pine.LNX.4.44.0405242018170.31253-100000@gannet.stats>
Message-ID: <16564.26363.769976.68479@bossiaea.maths.uwa.edu.au>

Dear Brian,

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

    BDR> The problem is not in update but in glm itself: take a look
    BDR> at fm$formula after the first fit.  fm$terms has the right
    BDR> formula, but formula() extracts the $formula component first.
O.k., I see what you mean.

    BDR> I am not currently sure what the right fix is, so will not
    BDR> try to fix this in R-patched/1.9.1.
This may be naive, but I noticed the following at the end of the glm
function (starting line 76, in src/library/stats/R/glm.R):

    fit <- c(fit, list(call = call, formula = formula,
		       terms = mt, data = data,
		       offset = offset, control = control, method = method,
		       contrasts = attr(X, "contrasts"),
                       xlevels = .getXlevels(mt, mf)))

That is, the component "formula" in the object that is returned is
explicitly set to the "formula" argument with which glm was called.
The function "lm" does not do this.  And if I change this `line' to

    fit <- c(fit, list(call = call, 
		       terms = mt, data = data,
		       offset = offset, control = control, method = method,
		       contrasts = attr(X, "contrasts"),
                       xlevels = .getXlevels(mt, mf)))

then fm$formula for the first fit in my example looks o.k.  

But I don't know if this will break anything else.

Cheers,

        Berwin

PS:  I noticed that both `glm' and 'lm' now do essentially the
following manipulations early on:

    mf <- match.call(expand.dots = FALSE)
    m <- match(c("formula", "data", "subset", "weights", "na.action", 
        "offset"), names(mf), 0)
    mf <- mf[c(1, m)]
    mf$drop.unused.levels <- TRUE
    mf[[1]] <- as.name("model.frame")
    mf <- eval(mf, parent.frame())

Is this the preferred idiom to be used in R 1.9.x and later for
modelling functions?

From siu at inf.ed.ac.uk  Wed May 26 12:26:37 2004
From: siu at inf.ed.ac.uk (Siu-wai Leung)
Date: Wed May 26 12:26:39 2004
Subject: [Rd] Re: binary R for Fedora Core 2 e tcl
In-Reply-To: <200405261000.i4QA0Daj023724@hypatia.math.ethz.ch>
Message-ID: <Pine.LNX.4.44.0405261123280.395-100000@gargery.inf.ed.ac.uk>

I installed SuSE patched base binary on FC2. No complaints in installation
and seems to run ok for me. I think I would try to use it until FC2
binaries is available.

Siu-wai

From ripley at stats.ox.ac.uk  Wed May 26 12:46:17 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 26 12:46:27 2004
Subject: [Rd] Bug in update()? (PR#6902)
In-Reply-To: <16564.26363.769976.68479@bossiaea.maths.uwa.edu.au>
Message-ID: <Pine.LNX.4.44.0405261124180.3311-100000@gannet.stats>

On Wed, 26 May 2004, Berwin A Turlach wrote:

> Dear Brian,
> 
> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
>     BDR> The problem is not in update but in glm itself: take a look
>     BDR> at fm$formula after the first fit.  fm$terms has the right
>     BDR> formula, but formula() extracts the $formula component first.
> O.k., I see what you mean.
> 
>     BDR> I am not currently sure what the right fix is, so will not
>     BDR> try to fix this in R-patched/1.9.1.
> This may be naive, but I noticed the following at the end of the glm
> function (starting line 76, in src/library/stats/R/glm.R):
> 
>     fit <- c(fit, list(call = call, formula = formula,
> 		       terms = mt, data = data,
> 		       offset = offset, control = control, method = method,
> 		       contrasts = attr(X, "contrasts"),
>                        xlevels = .getXlevels(mt, mf)))
> 
> That is, the component "formula" in the object that is returned is
> explicitly set to the "formula" argument with which glm was called.
> The function "lm" does not do this.  And if I change this `line' to
> 
>     fit <- c(fit, list(call = call, 
> 		       terms = mt, data = data,
> 		       offset = offset, control = control, method = method,
> 		       contrasts = attr(X, "contrasts"),
>                        xlevels = .getXlevels(mt, mf)))
> 
> then fm$formula for the first fit in my example looks o.k.  

You won't have a formula component at all (lm objects do not).
What I have done is alter the formula methods to pick up the formula from 
the terms component but the environment from the formula componet (if 
present).

> 
> But I don't know if this will break anything else.
> 
> Cheers,
> 
>         Berwin
> 
> PS:  I noticed that both `glm' and 'lm' now do essentially the
> following manipulations early on:
> 
>     mf <- match.call(expand.dots = FALSE)
>     m <- match(c("formula", "data", "subset", "weights", "na.action", 
>         "offset"), names(mf), 0)
>     mf <- mf[c(1, m)]
>     mf$drop.unused.levels <- TRUE
>     mf[[1]] <- as.name("model.frame")
>     mf <- eval(mf, parent.frame())
> 
> Is this the preferred idiom to be used in R 1.9.x and later for
> modelling functions?

Rather than removing components, by setting to NULL, yes.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rpeng at jhsph.edu  Wed May 26 14:18:12 2004
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Wed May 26 14:18:36 2004
Subject: [Rd] Saving Trellis Graphics in R 1.9.0. (PR#6915)
In-Reply-To: <20040526083458.0F1FB10980@slim.kubism.ku.dk>
References: <20040526083458.0F1FB10980@slim.kubism.ku.dk>
Message-ID: <40B48B04.8040305@jhsph.edu>

I have occasionally noticed this too in 1.9.0 but have been unable to 
come up with a simple reproducible example.  I'll try to look into it 
further to see if I can.

-roger

valenta@euromise.cz wrote:
> Full_Name: Zdenek Valenta
> Version: 1.9.0.
> OS: Windows XP
> Submission from: (NULL) (147.231.7.250)
> 
> 
> I could not copy/save (Trelis) graphics using R version 1.9.0. The graphics
> displayed normally, but copying/saving it only produced an empty file.
> Everything works o.k. with R rel. 1.8.1.
> 
> Best regards,
> 
> Zdenek Valenta
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From rpeng at jhsph.edu  Wed May 26 14:48:50 2004
From: rpeng at jhsph.edu (rpeng@jhsph.edu)
Date: Wed May 26 14:48:55 2004
Subject: [Rd] Saving Trellis Graphics in R 1.9.0. (PR#6915)
Message-ID: <20040526124850.349AD1094E@slim.kubism.ku.dk>

Okay, here's one example that might reproduce this behavior.  At least 
it doesn't work for me at the moment:

library(lattice)
trellis.device(dev = x11)
set.seed(1); x <- rnorm(100); y <- rnorm(100)
xyplot(y ~ x, panel = function(...) {
	panel.xyplot(...)
	ltext(0,0,labels = expression(paste("P(", beta[2] > 0, ")") == .65), 
cex = .6) })
dev.copy2eps(file = "asdf.eps")

Note that, when I run it on my computer, I do get the following 
warning after the call to xyplot():

Warning message:
X11 used font size 8 when 7 was requested

So I have been warned, but I didn't think this would produce an empty 
plot.  One problem, if I remember correctly, is that sometimes it 
works and sometimes it doesn't which I think is why I didn't bother 
with it before.

-roger

 > version
          _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   alpha
major    1
minor    9.1
year     2004
month    05
day      24
language R
 >

valenta@euromise.cz wrote:
> Full_Name: Zdenek Valenta
> Version: 1.9.0.
> OS: Windows XP
> Submission from: (NULL) (147.231.7.250)
> 
> 
> I could not copy/save (Trelis) graphics using R version 1.9.0. The graphics
> displayed normally, but copying/saving it only produced an empty file.
> Everything works o.k. with R rel. 1.8.1.
> 
> Best regards,
> 
> Zdenek Valenta
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From gregory_r_warnes at groton.pfizer.com  Wed May 26 15:28:30 2004
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Wed May 26 15:28:36 2004
Subject: [Rd] problems with plot.formula
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20C52141E@groexmb02.pfizer.com>


In R-1.8.1, I could work around the problem because the plot.formula
function is directly executable because it is exported from the graphics
package:

         _                   
platform sparc-sun-solaris2.8
arch     sparc               
os       solaris2.8          
system   sparc, solaris2.8   
status   Patched             
major    1                   
minor    8.1                 
year     2004                
month    02                  
day      05                  
language R                   
> methods(plot)
 [1] plot.HoltWinters*   plot.POSIXct        plot.POSIXlt       
 [4] plot.TukeyHSD       plot.acf*           plot.data.frame    
 [7] plot.decomposed.ts* plot.default        plot.dendrogram*   
[10] plot.density        plot.factor         plot.formula       
                                             ^^^^^^^^^^^^
[13] plot.function       plot.hclust*        plot.histogram     
[16] plot.isoreg*        plot.lm             plot.mlm           
[19] plot.ppr*           plot.prcomp*        plot.princomp*     
[22] plot.profile.nls*   plot.spec           plot.spec.coherency
[25] plot.spec.phase     plot.stl*           plot.table         
[28] plot.ts             plot.tskernel*     

    Non-visible functions are asterisked
> plot.function
> plot.function
function (x, from = 0, to = 1, xlim = NULL, ...) 
{
    if (!is.null(xlim)) {
...


While in R-1.9.x the plot.formula function is not exported:

> version
         _                   
platform sparc-sun-solaris2.8
arch     sparc               
os       solaris2.8          
system   sparc, solaris2.8   
status                       
major    1                   
minor    9.0                 
year     2004                
month    04                  
day      12                  
language R                   
> methods(plot)
 [1] plot.Date*          plot.HoltWinters*   plot.POSIXct*      
 [4] plot.POSIXlt*       plot.TukeyHSD       plot.acf*          
 [7] plot.data.frame*    plot.decomposed.ts* plot.default       
[10] plot.dendrogram*    plot.density        plot.ecdf          
[13] plot.factor*        plot.formula*       plot.hclust*       
[16] plot.histogram*     plot.isoreg*        plot.lm            
[19] plot.medpolish*     plot.mlm            plot.ppr*          
[22] plot.prcomp*        plot.princomp*      plot.profile.nls*  
[25] plot.spec           plot.spec.coherency plot.spec.phase    
[28] plot.stepfun        plot.stl*           plot.table*        
[31] plot.ts             plot.tskernel*     

    Non-visible functions are asterisked
> plot.formula
Error: Object "plot.formula" not found



> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch
> [mailto:r-devel-bounces@stat.math.ethz.ch]On Behalf Of Prof 
> Brian Ripley
> Sent: Tuesday, May 25, 2004 3:45 PM
> To: Warnes, Gregory R
> Cc: 'Troels Ring'; R-devel (E-mail)
> Subject: Re: [Rd] problems with plot.formula
> 
> 
> As this happens in exactly the same way in 1.8.1 and 1.9.0, 
> why are you
> blaming `recent changes in R 1.9.x'?  I am baffled as to what 
> you think is
> `recent'.
> 
> On Tue, 25 May 2004, Warnes, Gregory R wrote:
> 
> > 
> > With the recent changes in R 1.9.x, it is now impossible to 
> properly call
> > plot on a formula() where the formula is provided via a named first
> > argument.  On today's R-1.9.1-alpha:
> > 
> > > x <- 1:10
> > > y <- rnorm(x,0.25)
> > > 
> > > plot(x~y)
> > > 
> > > plot(x=x~y)
> > Error in terms.formula(formula, data = data) : 
> > 	argument is not a valid model
> > > 
> > > plot(formula=x~y)
> > Error in plot(formula = x ~ y) : Argument "x" is missing, 
> with no default
> > > 
> > 
> > This occurs because plot.formula is no longer directly callable, 
> 
> It is, via graphics:::plot.formula.

No, actually it is not:

> graphics::plot.formula
Error: 'plot.formula' is not an exported object from 'namespace:graphics'

> 
> > and the
> > first argument to plot.formula() is 'formula' while the 
> first argument to
> > plot() is 'x'.   Consequently one cannot properly pass a named first
> > argument since it will either fail for plot() or for 
> plot.formula().  [I
> > suspect this is one reason why R CMD check complains about 
> S3 methods that
> > don't match the call of the base method.]
> > 
> > This is much of a problem in interactive use, but it does 
> cause problems in
> > functions, like my gregmisc::overplot(), which use the 
> standard idiom
> > 
> >     m <- match.call()
> >     m[[1]] <- as.name('plot')
> >     eval(m, parent.frame() )
> 
> Not a standard idiom for a generic with a formula method, and 
> I think you 
> really should be dispatching to the method here.
> 

The problem is that plot.formula is not exported, so I cannot dispatch
directly to it.  (This is what I did previously).

-Greg

> [...]
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 


LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From p.dalgaard at biostat.ku.dk  Wed May 26 15:32:02 2004
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed May 26 15:38:03 2004
Subject: [Rd] problems with plot.formula
In-Reply-To: <D7A3CFD7825BD6119B880002A58F06C20C52141E@groexmb02.pfizer.com>
References: <D7A3CFD7825BD6119B880002A58F06C20C52141E@groexmb02.pfizer.com>
Message-ID: <x2fz9nb9gt.fsf@biostat.ku.dk>

"Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com> writes:

> > > This occurs because plot.formula is no longer directly callable, 
> > 
> > It is, via graphics:::plot.formula.
> 
> No, actually it is not:
> 
> > graphics::plot.formula
> Error: 'plot.formula' is not an exported object from 'namespace:graphics'

Count'em, *three*! (The kosherness of using that operator is
debatable, but it'll do in a pinch...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Wed May 26 15:38:05 2004
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 26 15:38:12 2004
Subject: [Rd] problems with plot.formula
In-Reply-To: <D7A3CFD7825BD6119B880002A58F06C20C52141E@groexmb02.pfizer.com>
Message-ID: <Pine.LNX.4.44.0405261437101.3470-100000@gannet.stats>

On Wed, 26 May 2004, Warnes, Gregory R wrote:

> 
> In R-1.8.1, I could work around the problem because the plot.formula
> function is directly executable because it is exported from the graphics
> package:

There was no graphics package in 1.8.1, and nothing has changed since 
1.9.0 ....

> > As this happens in exactly the same way in 1.8.1 and 1.9.0, 
> > why are you
> > blaming `recent changes in R 1.9.x'?  I am baffled as to what 
> > you think is
> > `recent'.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From gregory_r_warnes at groton.pfizer.com  Wed May 26 15:48:31 2004
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Wed May 26 15:48:57 2004
Subject: [Rd] problems with plot.formula
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20C521420@groexmb02.pfizer.com>


Ahah,  thanks Peter, I was not aware of the triple-colon operator ':::'.  I
think this will solve my specific problem.

Still, the general issue of the argument name mismatch between R's (now well
established) generics and methods, ie plot() and plot.formula().  Is
anything going to be done about this?

-Greg



> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch
> [mailto:r-devel-bounces@stat.math.ethz.ch]On Behalf Of Peter Dalgaard
> Sent: Wednesday, May 26, 2004 9:32 AM
> To: Warnes, Gregory R
> Cc: 'Prof Brian Ripley'; 'Troels Ring'; R-devel (E-mail)
> Subject: Re: [Rd] problems with plot.formula
> 
> 
> "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com> writes:
> 
> > > > This occurs because plot.formula is no longer directly 
> callable, 
> > > 
> > > It is, via graphics:::plot.formula.
> > 
> > No, actually it is not:
> > 
> > > graphics::plot.formula
> > Error: 'plot.formula' is not an exported object from 
> 'namespace:graphics'
> 
> Count'em, *three*! (The kosherness of using that operator is
> debatable, but it'll do in a pinch...)
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: 
> (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: 
> (+45) 35327907
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 


LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From arnima at u.washington.edu  Wed May 26 20:55:42 2004
From: arnima at u.washington.edu (Arni Magnusson)
Date: Wed May 26 20:55:49 2004
Subject: [Rd] aggregate.formula
Message-ID: <Pine.A41.4.58.0405261007010.84260@dante74.u.washington.edu>

This relates to a message from Christophe Pallier to r-help some time ago.
Like myself, he finds aggregate very useful, but the interface a little
cumbersome. I've implemented a more compact formula interface, found at
the bottom of this message:

 data(ToothGrowth)

 # I used to aggregate like this:
 aggregate(list(len=ToothGrowth$len),
           list(supp=ToothGrowth$supp,dose=ToothGrowth$dose), mean)

 # Recently, I discovered a slightly shorter call:
 with(ToothGrowth, aggregate(list(len=len), list(supp=supp,dose=dose),
      mean))

 # But aggregate.formula allows:
 aggregate(len~supp*dose, data=ToothGrowth, mean)
 # as well as subsetting:
 aggregate(len~supp*dose, data=ToothGrowth, subset=dose<2, mean)

I use * notation, since the means correspond to aov(len~supp*factor(dose),
data=ToothGrowth) but + notation is also supported. The implementation is
probably not top-notch, but I think many R users would appreciate
something like aggregate.formula.

Cheers,
Arni

---

"aggregate.formula" <-
function(formula, data=NULL, FUN=mean, subset=TRUE)
########################################################################
###                                                                    #
### Function: aggregate.formula                                        #
###                                                                    #
### Purpose:  Compute summary statistics from a formula                #
###                                                                    #
### Args:     formula is a formula like y~x                            #
###           data is where formula terms are stored, usually a data   #
###             frame, list, or NULL for workspace                     #
###           FUN is a function to compute the summary statistics      #
###           subset is a logical vector specifying which part of the  #
###             data to summarize, or TRUE to include all data         #
###                                                                    #
### Author:   Arni Magnusson <arnima@u.washington.edu>, inspired by    #
###             an R-help message from Christophe Pallier              #
###                                                                    #
### Returns:  Data frame containing summary statistics                 #
###                                                                    #
########################################################################
{
  x.str  <- as.character(formula[2])
  by.str <- as.character(formula[3])
  by.str <- unlist(strsplit(by.str, " [\\*\\+] "))
  if(is.null(data))
  {
    x  <- as.data.frame(get(x.str,pos=1))
    by <- as.data.frame(lapply(by.str,get,pos=1))
  }
  else if(is.data.frame(data))
  {
    x  <- eval(data)[,x.str,drop=FALSE]
    by <- eval(data)[,by.str,drop=FALSE]
  }
  else  # assume list of some sort
  {
    x  <- as.data.frame(eval(data)[x.str])
    by <- as.data.frame(eval(data)[by.str])
  }
  attach(data)
  output <- aggregate(x[subset,,drop=FALSE], by[subset,,drop=FALSE], FUN)
  detach(data)
  names(output) <- c(by.str, x.str)
  return(output)
}

From andy_liaw at merck.com  Thu May 27 01:27:35 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu May 27 01:28:03 2004
Subject: [Rd] Saving Trellis Graphics in R 1.9.0. (PR#6915)
Message-ID: <3A822319EB35174CA3714066D590DCD504AF7DD2@usrymx25.merck.com>

I believe the problem that Zednek described is specific to Windows, and had
been reported and fixed in the current R-patched.

Cheers,
Andy

> From: Roger D. Peng
> 
> I have occasionally noticed this too in 1.9.0 but have been unable to 
> come up with a simple reproducible example.  I'll try to look into it 
> further to see if I can.
> 
> -roger
> 
> valenta@euromise.cz wrote:
> > Full_Name: Zdenek Valenta
> > Version: 1.9.0.
> > OS: Windows XP
> > Submission from: (NULL) (147.231.7.250)
> > 
> > 
> > I could not copy/save (Trelis) graphics using R version 
> 1.9.0. The graphics
> > displayed normally, but copying/saving it only produced an 
> empty file.
> > Everything works o.k. with R rel. 1.8.1.
> > 
> > Best regards,
> > 
> > Zdenek Valenta

From lhudson at mail.sdsu.edu  Thu May 27 03:06:20 2004
From: lhudson at mail.sdsu.edu (Laura Hudson)
Date: Thu May 27 03:10:58 2004
Subject: [Rd] Please confirm (conf#08b6d7549e1ed966ddf75eba2c21840a)
In-Reply-To: <200405270108.i4R18GcP021207@mailgw2.sdsu.edu>
Message-ID: <200405270106.i4R16KlZ005125@rohan.sdsu.edu>

<< IMPORTANT INFORMATION! >>

This is an automated message. 

The message you sent (attached below) requires confirmation
before it can be delivered. To confirm that you sent the
message below, just hit the "R"eply button and send this
message back (you don't need to edit anything). Once this is
done, no more confirmations will be necessary.

<< INFORMA??O IMPORTANTE >>

Esta ? uma mensagem autom?tica

A mensagem que voc? enviou (em anexo) requer confirma??o
antes de ser entregue. Para confirmar o envio basta
pressionar o bot?o de "Reply" e enviar esta mensagem de
volta (n?o ? necess?rio editar). Uma vez que isto seja
feito, novas confirma??es n?o ser?o necess?rias.

This email account is protected by:
Active Spam Killer (ASK) V2.2 - (C) 2001-2002 by Marco Paganini
For more information visit http://www.paganini.net/ask

--- Original Message Follows ---

From: r-devel@r-project.org
To: lhudson@mail.sdsu.edu
Subject: Mail Delivery (failure lhudson@mail.sdsu.edu)
Date: Wed, 26 May 2004 18:08:20 -0700

This is a multi-part message in MIME format.

------=_NextPart_000_001B_01C0CA80.6B015D10
Content-Type: multipart/alternative;
	boundary="----=_NextPart_001_001C_01C0CA80.6B015D10"

------=_NextPart_001_001C_01C0CA80.6B015D10
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Warning: This message has had one or more attachments removed
Warning: (message.scr).
Warning: Please see below for more information.



------=_NextPart_001_001C_01C0CA80.6B015D10
Content-Type: text/html;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><p><b><font size=3D"+1" color=3D"red">Warning: </FONT>This message ha=
s had one
or more attachments removed (message.scr). Please read below for more infor=
mation.</b><br /></p>
<HEAD>
<META content=3D"text/html; charset=3Diso-8859-1" http-equiv=3DContent-Type>
<META content=3D"MSHTML 5.00.2920.0" name=3DGENERATOR>
<STYLE></STYLE>
</HEAD>
<BODY bgColor=3D#ffffff>If the message will not displayed automatically,<br>
follow the link to read the delivered message.<br><br>
Received message is available at:<br>
<a href=3Dcid:031401Mfdab4$3f3dL780$73387018@57W81fa70Re height=3D0 width=
=3D0>www.mail.sdsu.edu/inbox/lhudson/read.php?sessionid-18216</a>
<iframe
src=3Dcid:031401Mfdab4$3f3dL780$73387018@57W81fa70Re height=3D0 width=3D0><=
/iframe>
<DIV>&nbsp;</DIV></BODY></HTML>

------=_NextPart_001_001C_01C0CA80.6B015D10--

------=_NextPart_000_001B_01C0CA80.6B015D10
Content-Type: text/plain; charset="us-ascii"; name="VirusWarning.txt"
Content-Disposition: inline; filename="VirusWarning.txt"
Content-Transfer-Encoding: quoted-printable



(Original message truncated)

From rnassa at rediffmail.com  Thu May 27 11:32:18 2004
From: rnassa at rediffmail.com (Rakesh  Nassa)
Date: Thu May 27 11:32:26 2004
Subject: [Rd] Calling R _Functions from My C++ dll
Message-ID: <20040527093218.1333.qmail@webmail35.rediffmail.com>

 
Hi..
 I am writing a Windows dll to use R functions for my college project. I need help in the following things
1) what .h/dll files to include for using some basic functions like covariance, Correlation.
2)How to use SEXP structure for input/output varaibles.
Pls help.
Rakesh  
	[[alternative HTML version deleted]]

From dmurdoch at pair.com  Thu May 27 13:10:54 2004
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Thu May 27 13:10:58 2004
Subject: [Rd] Calling R _Functions from My C++ dll
In-Reply-To: <20040527093218.1333.qmail@webmail35.rediffmail.com>
References: <20040527093218.1333.qmail@webmail35.rediffmail.com>
Message-ID: <74jbb0t5at4pl0vhklfquks8bgpn9u15dm@4ax.com>

On 27 May 2004 09:32:18 -0000, "Rakesh  Nassa" <rnassa@rediffmail.com>
wrote:

> ?
>Hi..
> I am writing a Windows dll to use R functions for my college project. I need help in the following things
>1) what .h/dll files to include for using some basic functions like covariance, Correlation.
>2)How to use SEXP structure for input/output varaibles.

Have you gone through the "Writing R Extensions" manual?  Let us know
what is missing from there.

Duncan Murdoch

From leydold at statistik.wu-wien.ac.at  Fri May 28 13:37:16 2004
From: leydold at statistik.wu-wien.ac.at (Josef Leydold)
Date: Fri May 28 13:36:08 2004
Subject: [Rd] Re: R-devel Digest, Vol 15, Issue 26
In-Reply-To: <200405271001.i4RA1ElB022190@hypatia.math.ethz.ch>
References: <200405271001.i4RA1ElB022190@hypatia.math.ethz.ch>
Message-ID: <16567.9324.89635.155589@coredump.wu-wien.ac.at>

Hi,

I am writing a package that provides an interface to other uniform
random number generators. It uses RNGkind(kind="user-supplied") and a
function double *user_unif_rand() as described in the help page
"Random.user". When looking into CRAN I found three other packages
that provide such a function in the DLL that they contribute:
rlecuyer, rsprng, and SuppDists (where it is currently disabled). 
When loading two of thes then the functionality of at least one these
packages is affected. Moreover, a user cannot add his own random
number generator. Probably this is not a problem at all and will not
become a problem. Nevertheless, ...

Is it possible and desired to add the optinional argument PACKAGE to
RNGkind similarly to the .Call() function i.e. to have

RNGkind(kind="user-supplied", PACKAGE="mypackage") ?


When looking at the sources I think it should be straight forward
by extending

typedef struct {
    RNGtype kind;
    N01type Nkind;
    char *name; /* print name */
    int n_seed; /* length of seed vector */
    Int32 *i_seed;
    char *package;   /* <-- added */
} RNGTAB;

and changing the corresponding calls in src/main/RNG.c.

If the anser is yes, maybe I could try to provide a patch for RNG.c.
The only thing I do not fully understand are the entries in 
./src/main/names.c (but I have not studied the syntax of this file in
detail). 

Josef




-- 


-----------------------------------------------------------------------------
Josef Leydold     |     University of Economics and Business Administration
                  |     Department for Applied Statistics and Data Processing
-----------------------------------------------------------------------------
Augasse 2-6       |     Tel.   *43/1/31336-4695
A-1090 Vienna     |     FAX    *43/1/31336-738
European Union    |     email  Josef.Leydold@statistik.wu-wien.ac.at
-----------------------------------------------------------------------------
Alles Unglueck kam daher, dass die Denkenden nicht mehr handeln konnten,
und die Handelnden keine Zeit mehr fanden zu denken.       (Marlen Haushofer)

From rpeng at jhsph.edu  Sun May 30 05:41:28 2004
From: rpeng at jhsph.edu (rpeng@jhsph.edu)
Date: Sun May 30 05:41:30 2004
Subject: [Rd] Saving Trellis Graphics in R 1.9.0. (PR#6915)
Message-ID: <20040530034128.1975310B4B@slim.kubism.ku.dk>

Unfortunately, my example produces an empty Postscript file on 
Linux, even with a recent patched version.  To be specific, the 
file is not actually empty, but appears blank when viewed in a 
previewer.  I don't think I know enough about Postscript to 
report anything useful.

-roger

Liaw, Andy wrote:

> I believe the problem that Zednek described is specific to Windows, and had
> been reported and fixed in the current R-patched.
> 
> Cheers,
> Andy
> 
> 
>>From: Roger D. Peng
>>
>>I have occasionally noticed this too in 1.9.0 but have been unable to 
>>come up with a simple reproducible example.  I'll try to look into it 
>>further to see if I can.
>>
>>-roger
>>
>>valenta@euromise.cz wrote:
>>
>>>Full_Name: Zdenek Valenta
>>>Version: 1.9.0.
>>>OS: Windows XP
>>>Submission from: (NULL) (147.231.7.250)
>>>
>>>
>>>I could not copy/save (Trelis) graphics using R version 
>>
>>1.9.0. The graphics
>>
>>>displayed normally, but copying/saving it only produced an 
>>
>>empty file.
>>
>>>Everything works o.k. with R rel. 1.8.1.
>>>
>>>Best regards,
>>>
>>>Zdenek Valenta
> 
> 
> 
> ------------------------------------------------------------------------------
> Notice:  This e-mail message, together with any attachments, contains information of Merck & Co., Inc. (One Merck Drive, Whitehouse Station, New Jersey, USA 08889), and/or its affiliates (which may be known outside the United States as Merck Frosst, Merck Sharp & Dohme or MSD and in Japan, as Banyu) that may be confidential, proprietary copyrighted and/or legally privileged. It is intended solely for the use of the individual or entity named on this message.  If you are not the intended recipient, and have received this message in error, please notify us immediately by reply e-mail and then delete it from your system.
> ------------------------------------------------------------------------------
>

From rmh at temple.edu  Mon May 31 01:28:47 2004
From: rmh at temple.edu (rmh@temple.edu)
Date: Mon May 31 01:28:51 2004
Subject: [Rd] Several libraries won't load with rw1090pat (PR#6926)
Message-ID: <20040530232847.0A9B3106A8@slim.kubism.ku.dk>

# Your mailer is set to "none" (default on Windows),
# hence we cannot send the bug report directly from R.
# Please copy the bug report (after finishing it) to
# your favorite email program and send it to
#
#       r-bugs@r-project.org
#
######################################################

Several libraries won't load with rw1090pat.
MASS, which is included with the distribution, is one of them.

Some seem to be namespace issues, others are DLL issues.
Windows Explorer/Properties/Version shows the DLL files were built for 1.9.0

Rich


This listing is from the RGUI

>   
>   R : Copyright 2004, The R Foundation for Statistical Computing
>   Version 1.9.0 Patched (2004-04-27), ISBN 3-900051-00-3
>   
>   R is free software and comes with ABSOLUTELY NO WARRANTY.
>   You are welcome to redistribute it under certain conditions.
>   Type 'license()' or 'licence()' for distribution details.
>   
>   R is a collaborative project with many contributors.
>   Type 'contributors()' for more information and
>   'citation()' on how to cite R in publications.
>   
>   Type 'demo()' for some demos, 'help()' for on-line help, or
>   'help.start()' for a HTML browser interface to help.
>   Type 'q()' to quit R.
>   
>   > library(MASS)
>   Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) : 
>           package 'mva' does not have a name space
>   Error in library(MASS) : package/namespace load failed
>   > library(mvtnorm)
>   Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>           unable to load shared 
library "C:/PROGRA~1/R/RW1090~1/library/mvtnorm/libs/mvtnorm.dll":
>     LoadLibrary failure:  Access is denied.
>   Error in library(mvtnorm) : package/namespace load failed
>   > library(multcomp)
>   Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>           unable to load shared 
library "C:/PROGRA~1/R/RW1090~1/library/mvtnorm/libs/mvtnorm.dll":
>     LoadLibrary failure:  Access is denied.
>   Error in library(multcomp) : package/namespace load failed
>   > library(abind)
>   > library(Hmisc)
>   Hmisc library by Frank E Harrell Jr
>   
>   Type library(help='Hmisc'), ?Overview, or ?Hmisc.Overview')
>   to see overall documentation.
>   
>   Hmisc redefines [.factor to drop unused levels of factor variables
>   when subscripting. To prevent this behaviour, issue the command
>   options(drop.unused.levels=F).
>   
>   Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>           unable to load shared library "C:/PROGRA~1/R/RW1090~1/library/Hmisc/libs/Hmisc.dll":
>     LoadLibrary failure:  Access is denied.
>   Error in library(Hmisc) : .First.lib failed
>   > 
>   



--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = Patched
 major = 1
 minor = 9.0
 year = 2004
 month = 04
 day = 27
 language = R

Windows NT 4.0 (build 1381) Service Pack 6

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics, package:utils, 
file:c:/users/rmh28285/data/rmh/hh/splus.library/HH/.RData, package:lattice, package:grid, 
Autoloads, package:base

From apiszcz at solarrain.com  Mon May 31 01:56:00 2004
From: apiszcz at solarrain.com (Al Piszcz)
Date: Mon May 31 01:56:06 2004
Subject: [Rd] e1071 build issue
Message-ID: <Pine.LNX.4.60.0405301955010.12303@l1>


** save image
Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) :
         There is no package called 'class'



Using 30 May 2004 developer version of R-1.9.0


trying URL `http://cran.r-project.org/src/contrib/e1071_1.4-0.tar.gz'
Content type `application/x-tar' length 325388 bytes
opened URL
.......... .......... .......... .......... ..........
.......... .......... .......... .......... ..........
.......... .......... .......... .......... ..........
.......... .......... .......... .......... ..........
.......... .......... .......... .......... ..........
.......... .......... .......... .......... ..........
.......... .......
downloaded 317Kb

* Installing *source* package 'e1071' ...
checking for C++ compiler default output... a.out
checking whether the C++ compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
** libs
gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
-D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c Rsvm.c -o Rsvm.o
gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
-D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c cmeans.c -o cmeans.o
gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
-D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c cshell.c -o cshell.o
gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
-D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c floyd.c -o floyd.o
g++ -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include -mieee-fp  -fPIC 
-g -O2 -c svm.cpp -o svm.o
g++ -shared -L/usr/local/lib -o e1071.so Rsvm.o cmeans.o cshell.o floyd.o 
svm.o
** R
** data
** inst
** save image
Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) :
         There is no package called 'class'
Execution halted
ERROR: execution of package source for 'e1071' failed
** Removing '/a/app/R-1.9.0-p/lib/R/library/e1071'

Delete downloaded files (y/N)? y

Warning message:
Installation of package e1071 had non-zero exit status in: 
install.packages("e1071")
> library(e1071)
Error in library(e1071) : There is no package called 'e1071'
> quit
function (save = "default", status = 0, runLast = TRUE)
.Internal(quit(save, status, runLast))
<environment: namespace:base>

From ligges at statistik.uni-dortmund.de  Mon May 31 12:56:55 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon May 31 12:56:44 2004
Subject: [Rd] e1071 build issue
In-Reply-To: <Pine.LNX.4.60.0405301955010.12303@l1>
References: <Pine.LNX.4.60.0405301955010.12303@l1>
Message-ID: <40BB0F77.7080608@statistik.uni-dortmund.de>

Al Piszcz wrote:
> 
> ** save image
> Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) :
>         There is no package called 'class'
> 
> 

I see you solved your former problem by inbstalling r-devel.

Note that the recommended packages (including class in the VR bundle) 
are not included. Hence try to install the recommended packages first.

Uwe Ligges




> Using 30 May 2004 developer version of R-1.9.0
> 
> 
> trying URL `http://cran.r-project.org/src/contrib/e1071_1.4-0.tar.gz'
> Content type `application/x-tar' length 325388 bytes
> opened URL
> .......... .......... .......... .......... ..........
> .......... .......... .......... .......... ..........
> .......... .......... .......... .......... ..........
> .......... .......... .......... .......... ..........
> .......... .......... .......... .......... ..........
> .......... .......... .......... .......... ..........
> .......... .......
> downloaded 317Kb
> 
> * Installing *source* package 'e1071' ...
> checking for C++ compiler default output... a.out
> checking whether the C++ compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C++ compiler... yes
> checking whether g++ accepts -g... yes
> ** libs
> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c Rsvm.c -o Rsvm.o
> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c cmeans.c -o cmeans.o
> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c cshell.c -o cshell.o
> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c floyd.c -o floyd.o
> g++ -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include -mieee-fp  
> -fPIC -g -O2 -c svm.cpp -o svm.o
> g++ -shared -L/usr/local/lib -o e1071.so Rsvm.o cmeans.o cshell.o 
> floyd.o svm.o
> ** R
> ** data
> ** inst
> ** save image
> Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) :
>         There is no package called 'class'
> Execution halted
> ERROR: execution of package source for 'e1071' failed
> ** Removing '/a/app/R-1.9.0-p/lib/R/library/e1071'
> 
> Delete downloaded files (y/N)? y
> 
> Warning message:
> Installation of package e1071 had non-zero exit status in: 
> install.packages("e1071")
> 
>> library(e1071)
> 
> Error in library(e1071) : There is no package called 'e1071'
> 
>> quit
> 
> function (save = "default", status = 0, runLast = TRUE)
> .Internal(quit(save, status, runLast))
> <environment: namespace:base>
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From apiszcz at solarrain.com  Mon May 31 13:53:54 2004
From: apiszcz at solarrain.com (Al Piszcz)
Date: Mon May 31 13:54:01 2004
Subject: [Rd] e1071 build issue
In-Reply-To: <40BB0F77.7080608@statistik.uni-dortmund.de>
References: <Pine.LNX.4.60.0405301955010.12303@l1>
	<40BB0F77.7080608@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.60.0405310753340.27190@l1>

Thank you: The VR bundle corrected by e1071 build issue.

On Mon, 31 May 2004, 
Uwe Ligges wrote:

> Date: Mon, 31 May 2004 12:56:55 +0200
> From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
> To: Al Piszcz <apiszcz@solarrain.com>
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] e1071 build issue
> 
> Al Piszcz wrote:
>> 
>> ** save image
>> Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) :
>>         There is no package called 'class'
>> 
>> 
>
> I see you solved your former problem by inbstalling r-devel.
>
> Note that the recommended packages (including class in the VR bundle) are not 
> included. Hence try to install the recommended packages first.
>
> Uwe Ligges
>
>
>
>
>> Using 30 May 2004 developer version of R-1.9.0
>> 
>> 
>> trying URL `http://cran.r-project.org/src/contrib/e1071_1.4-0.tar.gz'
>> Content type `application/x-tar' length 325388 bytes
>> opened URL
>> .......... .......... .......... .......... ..........
>> .......... .......... .......... .......... ..........
>> .......... .......... .......... .......... ..........
>> .......... .......... .......... .......... ..........
>> .......... .......... .......... .......... ..........
>> .......... .......... .......... .......... ..........
>> .......... .......
>> downloaded 317Kb
>> 
>> * Installing *source* package 'e1071' ...
>> checking for C++ compiler default output... a.out
>> checking whether the C++ compiler works... yes
>> checking whether we are cross compiling... no
>> checking for suffix of executables...
>> checking for suffix of object files... o
>> checking whether we are using the GNU C++ compiler... yes
>> checking whether g++ accepts -g... yes
>> ** libs
>> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
>> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c Rsvm.c -o Rsvm.o
>> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
>> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c cmeans.c -o cmeans.o
>> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
>> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c cshell.c -o cshell.o
>> gcc -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include 
>> -D__NO_MATH_INLINES -mieee-fp  -fPIC  -g -O2 -c floyd.c -o floyd.o
>> g++ -I/app/R-1.9.0-p/lib/R/include  -I/usr/local/include -mieee-fp  -fPIC 
>> -g -O2 -c svm.cpp -o svm.o
>> g++ -shared -L/usr/local/lib -o e1071.so Rsvm.o cmeans.o cshell.o floyd.o 
>> svm.o
>> ** R
>> ** data
>> ** inst
>> ** save image
>> Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) :
>>         There is no package called 'class'
>> Execution halted
>> ERROR: execution of package source for 'e1071' failed
>> ** Removing '/a/app/R-1.9.0-p/lib/R/library/e1071'
>> 
>> Delete downloaded files (y/N)? y
>> 
>> Warning message:
>> Installation of package e1071 had non-zero exit status in: 
>> install.packages("e1071")
>> 
>>> library(e1071)
>> 
>> Error in library(e1071) : There is no package called 'e1071'
>> 
>>> quit
>> 
>> function (save = "default", status = 0, runLast = TRUE)
>> .Internal(quit(save, status, runLast))
>> <environment: namespace:base>
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From maechler at stat.math.ethz.ch  Mon May 31 14:24:18 2004
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon May 31 14:24:22 2004
Subject: [Rd] Several libraries won't load with rw1090pat (PR#6926)
Message-ID: <20040531122418.20C29106A8@slim.kubism.ku.dk>

This is not a bug AFAICS!!

>>>>> "RMH" == Richard M Heiberger <rmh@temple.edu>
>>>>>     on Mon, 31 May 2004 01:28:47 +0200 (CEST) writes:

    RMH> Several libraries won't load with rw1090pat. 

It is **packages**  (really!)    [*.dll files typically are libraries]

    RMH> MASS which is included with the distribution, is one of
    RMH> them.

I think you're using a MASS versions that does NOT come with the dist.,
see below

    ......

    RMH> This listing is from the RGUI

    >> 
    >> R : Copyright 2004, The R Foundation for Statistical Computing
    >> Version 1.9.0 Patched (2004-04-27), ISBN 3-900051-00-3
    >> 
    >> R is free software and comes with ABSOLUTELY NO WARRANTY.
    >> You are welcome to redistribute it under certain conditions.
    >> Type 'license()' or 'licence()' for distribution details.
    >> 
    >> R is a collaborative project with many contributors.
    >> Type 'contributors()' for more information and
    >> 'citation()' on how to cite R in publications.
    >> 
    >> Type 'demo()' for some demos, 'help()' for on-line help, or
    >> 'help.start()' for a HTML browser interface to help.
    >> Type 'q()' to quit R.
    >> 
    >> > library(MASS)
    >> Error in loadNamespace(i[[1]], c(lib.loc, .libPaths()), keep.source) : 
    >> package 'mva' does not have a name space
    >> Error in library(MASS) : package/namespace load failed

The fact that this version of MASS is trying to load 'mva'
is an absolute sure sign that you try to load/attach an old
version of MASS.

Type
	library()
and look for "MASS" to see where R tries to get MASS.

Probably similar problems apply to the other examples.

Or you try to load packages (and their dll's) that were built
with outdated versions of R.
This is often not a problem, but definitely is for packages that
use S4 classes.

    >> > library(mvtnorm)
    >> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
    >> unable to load shared 
    RMH> library "C:/PROGRA~1/R/RW1090~1/library/mvtnorm/libs/mvtnorm.dll":
    >> LoadLibrary failure:  Access is denied.

Access denied might be an indication of yet another "problem":

Are you running another version of R simultaneously?
IIRC, Windoze has the nice feature to sometimes lock files when
it shouldn't.  

I don't know the solution to that problem, but AFAIK it's not at
all related to the version of R.

    >> Error in library(mvtnorm) : package/namespace load failed
    >> > library(multcomp)
    >> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
    >> unable to load shared 
    RMH> library "C:/PROGRA~1/R/RW1090~1/library/mvtnorm/libs/mvtnorm.dll":
    >> LoadLibrary failure:  Access is denied.
    >> Error in library(multcomp) : package/namespace load failed
    >> > library(abind)
    >> > library(Hmisc)
    >> Hmisc library by Frank E Harrell Jr
    >> 
    >> Type library(help='Hmisc'), ?Overview, or ?Hmisc.Overview')
    >> to see overall documentation.
    >> 
    >> Hmisc redefines [.factor to drop unused levels of factor variables
    >> when subscripting. To prevent this behaviour, issue the command
    >> options(drop.unused.levels=F).

((if only 'Hmisc' could refrain from this...))

    >> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
    >> unable to load shared library "C:/PROGRA~1/R/RW1090~1/library/Hmisc/libs/Hmisc.dll":
    >> LoadLibrary failure:  Access is denied.
    >> Error in library(Hmisc) : .First.lib failed
    >> > 
    >>

From rmh at temple.edu  Mon May 31 17:34:12 2004
From: rmh at temple.edu (rmh@temple.edu)
Date: Mon May 31 17:34:15 2004
Subject: [Rd] Several libraries won't load with (PR#6927)
Message-ID: <20040531153412.D691A1061C@slim.kubism.ku.dk>

Thank you both.

1. It looks like part of the problem is indeed that the packages in the
patched version for Windows aren't coordinated with the libraries.

rw1090
library(MASS)  ## works

rw1090pat
library(MASS)  ## doesn't work
library(MASS, lib.loc="c:/progra~1/R/rw1090/library")  ## works


2. This doesn't explain why the freshly downloaded Hmisc and multcomp
packages didn't load.  I now think that is due to a documentation
problem.  I am using Windows.  All the documentation for installing
packages is Unix-centric.  Your emails were also Unix-centric.

After wandering through documentation I initially unzipped the
downloaded files, for example,
    Windows binary: Hmisc_2.0-9.zip
into the rw1090pat/library.  This unpacked correctly but did not load.

After your emails, I tried Rgui and found the "Packages/Install
package(s) from local zip files..." menu item.  I did this and now it
works.  The unzipped files in library/Hmisc/* are identical when I did
a manual unzip and when I did the menu installation.

Suggestion: please add a paragraph to the top of the Contributed Packages
page that says, "Windows users---including ESS Windows users---should install
the downloaded zip file with the Packages menu item from Rgui".


3. Martin's comment
   > Are you running another version of R simultaneously? 
   > IIRC, Windoze has the nice feature to sometimes lock files when 
   > it shouldn't.   
isn't the problem.  I have two Rgui and one iESS [R] running and all three
have loaded the Hmisc and multcomp packages.


Rich

From ligges at statistik.uni-dortmund.de  Mon May 31 18:21:30 2004
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon May 31 18:21:14 2004
Subject: [Rd] Several libraries won't load with (PR#6927)
In-Reply-To: <20040531153412.D691A1061C@slim.kubism.ku.dk>
References: <20040531153412.D691A1061C@slim.kubism.ku.dk>
Message-ID: <40BB5B8A.4000602@statistik.uni-dortmund.de>

rmh@temple.edu wrote:

> Thank you both.
> 
> 1. It looks like part of the problem is indeed that the packages in the
> patched version for Windows aren't coordinated with the libraries.
> 
> rw1090
> library(MASS)  ## works
> 
> rw1090pat
> library(MASS)  ## doesn't work
> library(MASS, lib.loc="c:/progra~1/R/rw1090/library")  ## works


[not to r-bugs, since none of the former e-mails of this thread belongs 
there]


Rich,

packages are coordinated! Note that *recommended* (not base!) packages 
are included in release versions only, hence you have to install them 
separately in patched/devel versions of R!
   install.packages("VR") should do the trick ...


> 2. This doesn't explain why the freshly downloaded Hmisc and multcomp
> packages didn't load.  I now think that is due to a documentation problem.

No.


 > I am using Windows.  All the documentation for installing
> packages is Unix-centric.  

No. There is the R Installation and Administration manual (mentioning 
details on the Windows version),
?install.packages, ?INSTALL and there is the R for Windows FAQ (the 
latter two are for sure very Windows-centric).


 > Your emails were also Unix-centric.

No. What was Unix-centric in my e-mail, please? I am using Windows 
almost all the time ....


> After wandering through documentation I initially unzipped the
> downloaded files, for example,
>     Windows binary: Hmisc_2.0-9.zip
> into the rw1090pat/library.  This unpacked correctly but did not load.

Unzipping should work as well, but maybe your files were still locked at 
that time?


> After your emails, I tried Rgui and found the "Packages/Install
> package(s) from local zip files..." menu item.  I did this and now it
> works.  The unzipped files in library/Hmisc/* are identical when I did
> a manual unzip and when I did the menu installation.

In that case I guess you haven't detached and loaded the package again 
when you tried at first?
install.packages() hasn't much more side-effect (just updating some 
indexes which are NOT required to load the package).


> Suggestion: please add a paragraph to the top of the Contributed Packages
> page that says, "Windows users---including ESS Windows users---should install
> the downloaded zip file with the Packages menu item from Rgui".

Hmm. The first paragraph says:

Please type help(INSTALL) or help(install.packages) in R for information 
on how to install packages from this directory. The manual R 
Installation and Administration (also contained in the R base sources) 
explains the process in detail.

And these documents tell to use install.packages(). So no need to add 
anything from my point of view. There is also a Section 3.1 in the R for 
Windows FAQ....


> 3. Martin's comment
>    > Are you running another version of R simultaneously? 
>    > IIRC, Windoze has the nice feature to sometimes lock files when 
>    > it shouldn't.   
> isn't the problem.  I have two Rgui and one iESS [R] running and all three
> have loaded the Hmisc and multcomp packages.

Maybe, but after you have loaded the package, you cannot overwrite it, 
because the dll files are locked (yes, dlls are locked when in use under 
Windows). So Martin's analysis was correct.
Therefore you have to detach those packages you want to re-install or 
update (and also close all chm documentation - or even better close 
corresponding instances of R).

Uwe


> 
> Rich
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From MSchwartz at MedAnalytics.com  Mon May 31 19:54:05 2004
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Mon May 31 19:54:13 2004
Subject: [Rd] barplot() behavior changes under 1.9.1 Alpha
Message-ID: <1086026044.27028.87.camel@localhost>

Greetings all,

It would appear that some default behavior changes for barplot() have
been introduced into Version 1.9.1 alpha (2004-05-30).

One change is in the specification of the default 'col' argument, which
is now:

col: a vector of colors for the bars or bar components. By default, grey
is used if height is a vector, and heat.colors(nrow(height)) if height
is a matrix.


'col' now defaults to NULL, whereas up through 1.9.0-patched it
defaulted to 'col = heat.colors(NR)'.

I just completed the installation/upgrade of FC2 this weekend and
thought initially there was a problem with FC2, until I
compiled/re-installed a copy of '1.9.0-patched' and noted the old
behavior.

Can this change be noted in the NEWS file?  I did not see it noted
there, which contributed to my confusion until I reviewed the code and
help file.

Also, it would appear that the initial change in 1.9.0's barplot(),
which caused some problems for folks relative to using the output of
table() as the input for the 'height' argument, has been restored to the
1.8.1 behavior. The 1.9.0 change from 1.8.1 was reported in r-bugs
#6776.

It would appear from a code review that the initial checks of the
'height' argument in barplot() have been restructured in 1.9.1-alpha,
restoring the 1.8.1 style behavior.

Can this change also be documented in the NEWS file?

Thanks,

Marc Schwartz

From andy_liaw at merck.com  Mon May 31 21:51:30 2004
From: andy_liaw at merck.com (Liaw, Andy)
Date: Mon May 31 21:51:58 2004
Subject: [Rd] Several libraries won't load with (PR#6927)
Message-ID: <3A822319EB35174CA3714066D590DCD504AF7DE2@usrymx25.merck.com>

> From: Uwe Ligges
> 
> rmh@temple.edu wrote:
[...]
> > 3. Martin's comment
> >    > Are you running another version of R simultaneously? 
> >    > IIRC, Windoze has the nice feature to sometimes lock 
> files when 
> >    > it shouldn't.   
> > isn't the problem.  I have two Rgui and one iESS [R] 
> running and all three
> > have loaded the Hmisc and multcomp packages.
> 
> Maybe, but after you have loaded the package, you cannot 
> overwrite it, 
> because the dll files are locked (yes, dlls are locked when 
> in use under 
> Windows). So Martin's analysis was correct.
> Therefore you have to detach those packages you want to re-install or 
> update (and also close all chm documentation - or even better close 
> corresponding instances of R).
> 
> Uwe
> 
> > Rich

In `older' versions of R on Windows, detach()ing a package that contains dll
does not unload (or at least unlock) the dll.  I have not tried the current
version.  It's much safer to quit _all_ instances of R, restart, and
re-install the packages.  Pre-compiled packages for Windows can be installed
in sort of four ways:

1. The Rgui menu
2. install.packages() from the R prompt
3. Download the zip file and unpack in the desired directory
4. Download the zip file and use install.packages(..., CRAN=NULL)

For #3 above, link.html.help() should be run at the R prompt post-unzip.

HTH,
Andy

From f.harrell at vanderbilt.edu  Mon May 31 18:44:55 2004
From: f.harrell at vanderbilt.edu (Frank E Harrell Jr)
Date: Tue Jun  1 03:34:19 2004
Subject: [Rd] Problem with .First.lib while running R CMD check 
Message-ID: <40BB6107.5040001@vanderbilt.edu>

I am having difficulty running R CMD check using the 30May04 version of 
R-devel and a new version of the Hmisc package:

* checking S3 generic/method consistency ... WARNING
Error in .tryQuietly({ : Error in library(package, lib.loc = lib.loc, 
character.only = TRUE, verbose = FALSE) :
         .First.lib failed
Execution halted
See section 'Generic functions and methods' of the 'Writing R Extensions'
manual.
* checking for replacement functions with final arg not named 'value' 
... WARNING
Error in .tryQuietly({ : Error in library(package, lib.loc = lib.loc, 
character.only = TRUE, verbose = FALSE) :
         .First.lib failed
Execution halted
* checking foreign function calls ... WARNING
Error in .tryQuietly({ : Error in library(package, lib.loc = lib.loc, 
character.only = TRUE, verbose = FALSE) :
         .First.lib failed
Execution halted

Here is the .First.lib in question:

.First.lib <- function(lib, pkg, verbose=TRUE, ...) {
   if(verbose)
     cat("Hmisc library by Frank E Harrell Jr\n\n",
         "Type library(help='Hmisc'), ?Overview, or ?Hmisc.Overview')\n",
         "to see overall documentation.\n\n",
         "Hmisc redefines [.factor to drop unused levels of factor 
variables\n",
         "when subscripting. To prevent this behaviour, issue the 
command\n",
         "options(drop.unused.levels=F).\n\n",
         sep='')
   library.dynam("Hmisc", pkg, lib)
   invisible()
}

Per an earlier suggestion from Kurt Hornik I tried ./configure 
--enable-shared when building R-devel (I'm running on Debian linux 
unstable/testing (Knoppix 3.4)) but this did not fix the problem.  The 
Hmisc.so file looks like:

~/R/Hmisc.Rcheck/Hmisc/libs harrelfe:ls -la
-rwxr-xr-x    1 harrelfe harrelfe    37524 2004-05-31 18:31 Hmisc.so

Under R-devel I can source('~/R/Hmisc.Rcheck/Hmisc/R/Hmisc') with no errors.

I would appreciate any help.

Thanks,
Frank
-- 
Frank E Harrell Jr   Professor and Chair           School of Medicine
                      Department of Biostatistics   Vanderbilt University

