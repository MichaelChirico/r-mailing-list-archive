From bogus@does.not.exist.com  Fri Jul  2 08:37:58 1999
From: bogus@does.not.exist.com ()
Date: Fri, 02 Jul 1999 03:37:58 -0400 (EDT)
Subject: Win cash & a cruise!
Message-ID: <46448.16661@ccr.dsi.uanl.mx>

Raquel's Casino, Inc. is awarding a cruise + $300 to a lucky member.  No
purchase necessary to play!

Join before month end to participate.  (You will automatically be entered
into the next drawing.)You can join at
    http://www.raquelscasino.com  (casino)
    http://www.tobet.com (sportsbook)
Raquel's online casino provides guests with a state-of-the-art gaming
experience:
    - A chance to win a cruise and $300!
    - 10% sign-up bonus!
    - Free casino software!
    - 25 casino games!
    - International sportsbook!
    - Horse racing!
    - Play for fun, or for real!
Our casino is secure, audited, private, and insured.

Thank you for your time and consideration.





*********************************************
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Jul  2 16:24:04 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 02 Jul 1999 11:24:04 -0400
Subject: changing the RNG transformation
Message-ID: <377CD994.44D698F7@bank-banque-canada.ca>

I have just circulated some code on S-new which gives a general strategy for
defining different RNGs and (normal) transformations in Splus (and R). Most of
this is already built into R, but the strategy for defining the transformation
is not. (Although a quick look at the C code suggests someone has been thinking
about it).

I would appreciate comments, especially on the transformation strategy. I expect
the code would be faster if the transformation was done in C.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Fri Jul  2 17:22:38 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Fri, 02 Jul 1999 16:22:38 +0000
Subject: Problem with plot.ts, "["
Message-ID: <377CE74E.A742EB01@wu-wien.ac.at>

There seems to be a problem with plot.ts (R Version 0.64.2)

>x<-cbind(1:10,2:11)
>x<-as.ts(x)
>plot(x)
Error: subscript (20) out of bounds, should be at most 10
>

The problem is located in "[.ts":

> x<-cbind(1:10,2:11)
> x[is.finite(x)]
 [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> x<-as.ts(x)
> x[is.finite(x)]
Error: subscript (20) out of bounds, should be at most 10
>

and there (in "[.ts") the following statement gives the error:

Browse[1]>
debug: li <- length(ind <- (1:n)[i])

However I don't understand what this part exactly does?

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Jul  2 17:44:18 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 2 Jul 1999 18:44:18 +0200 (MET DST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["} (PR#216)
Message-ID: <199907021644.SAA21974@pubhealth.ku.dk>


>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> said:

    Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
    > x<-cbind(1:10,2:11)
    > x<-as.ts(x)
    > plot(x)
    Adrian> Error: subscript (20) out of bounds, should be at most 10

This is definitely a bug
--> CC: R-bugs

ALL NOTE : This is *not* new in 0.64.2



    Adrian> The problem is located in "[.ts":

    > x<-cbind(1:10,2:11)
    > x[is.finite(x)]
    Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
    > x<-as.ts(x)
    > x[is.finite(x)]
    Adrian> Error: subscript (20) out of bounds, should be at most 10


    Adrian> and there (in "[.ts") the following statement gives the error:

    Adrian> Browse[1]>
    Adrian> debug: li <- length(ind <- (1:n)[i])

    Adrian> However I don't understand what this part exactly does?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  2 17:53:31 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Jul 1999 18:53:31 +0200
Subject: Problem with plot.ts, "["
In-Reply-To: Adrian Trapletti's message of "Fri, 02 Jul 1999 16:22:38 +0000"
References: <377CE74E.A742EB01@wu-wien.ac.at>
Message-ID: <x2vhc3at84.fsf@blueberry.kubism.ku.dk>

Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> writes:

> There seems to be a problem with plot.ts (R Version 0.64.2)
> 
> >x<-cbind(1:10,2:11)
> >x<-as.ts(x)
> >plot(x)
> Error: subscript (20) out of bounds, should be at most 10
> >
> 

If it's any consolation to you, this didn't work in 0.64.1 and not in
0.65unstable either, although it gets a different error there...

> The problem is located in "[.ts":
> 
> > x<-cbind(1:10,2:11)
> > x[is.finite(x)]
>  [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> > x<-as.ts(x)
> > x[is.finite(x)]
> Error: subscript (20) out of bounds, should be at most 10
> >
> 
> and there (in "[.ts") the following statement gives the error:

Actually, I suspect that the mistake is to do  x[is.finite(x)] in the
first place. It is used to calculate ranges for plot limits, but one
might better have used range(x,finite=TRUE) for that. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 16:52:17 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 02 Jul 1999 17:52:17 +0200 (CEST)
Subject: segfault on Sparc Linux (RH6.0)
Message-ID: <XFMail.990702175217.plummer@iarc.fr>

We are having problems building R on Red Hat Linux 6.0/Sparc.
R compiles with no problem but then it fails "make tests".
Specifically, the line

eigen(cbind(-1,c(1:2,0),0:2)) # complex values

causes a segmentation fault. Previous versions of Red Hat Linux
did not give this problem.

The eigen() function is one of the rare cases in the base library where
Fortran code is called via the .Fortran interface, which suggests to me
that the problem lies in the Fortran installation or flags.

Vin Everett, who is actually doing the compiling, has provided output
from gdb, which is given below. Any help would be greatly appreciated.

Martyn

> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
0xb1dc8 in hqr2_ ()
(gdb) 

bt gives:-
(gdb) bt
#0  0xb1dc8 in hqr2_ ()
#1  0xb4bb4 in rg_ ()
#2  0x3909c in do_dotCode (call=0x70421f64, op=0x70421b90, args=0x70679f28, 
    env=0x7067791c) at dotcode.c:386
#3  0x3fc7c in eval (e=0x70421f64, rho=0x7067791c) at eval.c:180
#4  0x41118 in do_set (call=0x70421fa0, op=0x702d4828, args=0x70421f8c, 
    rho=0x7067791c) at eval.c:761
#5  0x3fc7c in eval (e=0x70421fa0, rho=0x7067791c) at eval.c:180
#6  0x40b58 in do_begin (call=0x70421fb4, op=0x702d48c8, args=0x70421fc8, 
    rho=0x7067791c) at eval.c:588
#7  0x3fc7c in eval (e=0x70421fb4, rho=0x7067791c) at eval.c:180
#8  0x40280 in do_if (call=0x70422ef0, op=0x702d44b8, args=0x70422edc, 
    rho=0x7067791c) at eval.c:379
#9  0x3fc7c in eval (e=0x70422ef0, rho=0x7067791c) at eval.c:180
#10 0x40b58 in do_begin (call=0x70422f04, op=0x702d48c8, args=0x70422f18, 
    rho=0x7067791c) at eval.c:588
#11 0x3fc7c in eval (e=0x70422f04, rho=0x7067791c) at eval.c:180
#12 0x40280 in do_if (call=0x70423120, op=0x702d44b8, args=0x7042310c, 
    rho=0x7067791c) at eval.c:379
#13 0x3fc7c in eval (e=0x70423120, rho=0x7067791c) at eval.c:180
#14 0x40b58 in do_begin (call=0x7041eddc, op=0x702d48c8, args=0x70423134, 
    rho=0x7067791c) at eval.c:588
#15 0x3fc7c in eval (e=0x7041eddc, rho=0x7067791c) at eval.c:180
#16 0x3ffcc in applyClosure (call=0x70677868, op=0x7042347c, 
    arglist=0x706778cc, rho=0x702dca50, suppliedenv=0x702d4008) at eval.c:293
#17 0x3fcf0 in eval (e=0x70677868, rho=0x702dca50) at eval.c:189
#18 0x5370c in R_ReplConsole (rho=0x702dca50, savestack=0, browselevel=0)
    at main.c:274
#19 0x53b74 in mainloop () at main.c:465
#20 0xa0adc in main (ac=0, av=0xeffffc84) at system.c:641
#21 0x701eb8d0 in __libc_start_main () at ../sysdeps/generic/libc-start.c:78




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 18:20:22 1999
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Fri, 2 Jul 1999 19:20:22 +0200 (MET DST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "[" (PR#217)
Message-ID: <199907021720.TAA22201@pubhealth.ku.dk>

This message is in MIME format
--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Type: text/plain; charset=us-ascii

There was some discussion a while back on R-devel between Ross Ihaka,
Paul Gilbert and myself about row subsetting in time series.  I think
the consensus was that "[.ts" should not try to coerce its result
back to a time series object (which is underlying the problem here).
If you really do want to take a subseries from a regular time series,
a modified version of window.ts would do. I am attaching my
suggested modifications.
Martyn


On 02-Jul-99 maechler@stat.math.ethz.ch wrote:
> 
>>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at>
>>>>>> said:
> 
>     Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
>     > x<-cbind(1:10,2:11)
>     > x<-as.ts(x)
>     > plot(x)
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> This is definitely a bug
> --> CC: R-bugs
> 
> ALL NOTE : This is *not* new in 0.64.2
> 
> 
> 
>     Adrian> The problem is located in "[.ts":
> 
>     > x<-cbind(1:10,2:11)
>     > x[is.finite(x)]
>     Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
>     > x<-as.ts(x)
>     > x[is.finite(x)]
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> 
>     Adrian> and there (in "[.ts") the following statement gives the error:
> 
>     Adrian> Browse[1]>
>     Adrian> debug: li <- length(ind <- (1:n)[i])
> 
>     Adrian> However I don't understand what this part exactly does?
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _

----------------------------------
E-Mail: Martyn Plummer <plummer@iarc.fr>
Date: 02-Jul-99
Time: 18:02:32

This message was sent by XFMail
----------------------------------

--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Disposition: attachment; filename="tsfix"
Content-Transfer-Encoding: 7bit
Content-Description: tsfix
Content-Type: text/plain; charset=us-ascii; name=tsfix; SizeOnDisk=1838

"[.ts" <- function (x, i, j, drop = TRUE) 
{
    y <- NextMethod("[")
    if (missing(i)) 
        ts(y, start = start(x), freq = frequency(x))
    else y
}

"window.ts" <-
function (x, start, end, frequency, deltat) 
{
    x <- as.ts(x)
    xtsp <- tsp(x)
    xfreq <- xtsp[3]
    xtime <- time(x)
    ts.eps <- .Options$ts.eps
    if (missing(frequency) && missing(deltat)) 
        yfreq <- xfreq
    else if (missing(deltat)) 
        yfreq <- frequency
    else if (missing(frequency)) 
        yfreq <- 1/deltat
    if (xfreq%%yfreq < ts.eps) {
        thin <- round(xfreq/yfreq)
        yfreq <- xfreq/thin
    }
    else {
        thin <- 1
        yfreq <- xfreq
        warning("Frequency not changed")
    }
    start <- if (missing(start)) 
        xtsp[1]
    else switch(length(start), start, start[1] + (start[2] - 
        1)/xfreq, stop("Bad value for start"))
    if (start < xtsp[1]) {
        start <- xtsp[1]
        warning("start value not changed")
    }
    end <- if (missing(end)) 
        xtsp[2]
    else switch(length(end), end, end[1] + (end[2] - 1)/xfreq, 
        stop("Bad value for end"))
    if (end > xtsp[2]) {
        end <- xtsp[2]
        warning("end value not changed")
    }
    if (start > end) 
        stop("start cannot be after end")
    if (all(abs(start - xtime) > abs(start) * ts.eps)) {
        start <- xtime[(xtime > start) & ((start + 1/xfreq) > 
            xtime)]
    }
    if (all(abs(end - xtime) > abs(end) * ts.eps)) {
        end <- xtime[(xtime < end) & ((end - 1/xfreq) < xtime)]
    }
    i <- seq(trunc((start - xtsp[1]) * xfreq + 1.5), trunc((end - 
        xtsp[1]) * xfreq + 1.5), by = thin)
    y <- if (is.matrix(x)) 
        x[i, , drop = FALSE]
    else x[i]
    ystart <- xtime[i[1]]
    yend <- xtime[i[length(i)]]
    tsp(y) <- c(ystart, yend, yfreq)
    y
}


--_=XFMail.1.3.p0.Linux:990702182137:16900=_--
End of MIME message

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 17:21:37 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 02 Jul 1999 18:21:37 +0200 (CEST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["
In-Reply-To: <199907021644.SAA21974@pubhealth.ku.dk>
Message-ID: <XFMail.990702182137.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Type: text/plain; charset=us-ascii

There was some discussion a while back on R-devel between Ross Ihaka,
Paul Gilbert and myself about row subsetting in time series.  I think
the consensus was that "[.ts" should not try to coerce its result
back to a time series object (which is underlying the problem here).
If you really do want to take a subseries from a regular time series,
a modified version of window.ts would do. I am attaching my
suggested modifications.
Martyn


On 02-Jul-99 maechler@stat.math.ethz.ch wrote:
> 
>>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at>
>>>>>> said:
> 
>     Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
>     > x<-cbind(1:10,2:11)
>     > x<-as.ts(x)
>     > plot(x)
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> This is definitely a bug
> --> CC: R-bugs
> 
> ALL NOTE : This is *not* new in 0.64.2
> 
> 
> 
>     Adrian> The problem is located in "[.ts":
> 
>     > x<-cbind(1:10,2:11)
>     > x[is.finite(x)]
>     Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
>     > x<-as.ts(x)
>     > x[is.finite(x)]
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> 
>     Adrian> and there (in "[.ts") the following statement gives the error:
> 
>     Adrian> Browse[1]>
>     Adrian> debug: li <- length(ind <- (1:n)[i])
> 
>     Adrian> However I don't understand what this part exactly does?
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _

----------------------------------
E-Mail: Martyn Plummer <plummer@iarc.fr>
Date: 02-Jul-99
Time: 18:02:32

This message was sent by XFMail
----------------------------------

--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Disposition: attachment; filename="tsfix"
Content-Transfer-Encoding: 7bit
Content-Description: tsfix
Content-Type: text/plain; charset=us-ascii; name=tsfix; SizeOnDisk=1838

"[.ts" <- function (x, i, j, drop = TRUE) 
{
    y <- NextMethod("[")
    if (missing(i)) 
        ts(y, start = start(x), freq = frequency(x))
    else y
}

"window.ts" <-
function (x, start, end, frequency, deltat) 
{
    x <- as.ts(x)
    xtsp <- tsp(x)
    xfreq <- xtsp[3]
    xtime <- time(x)
    ts.eps <- .Options$ts.eps
    if (missing(frequency) && missing(deltat)) 
        yfreq <- xfreq
    else if (missing(deltat)) 
        yfreq <- frequency
    else if (missing(frequency)) 
        yfreq <- 1/deltat
    if (xfreq%%yfreq < ts.eps) {
        thin <- round(xfreq/yfreq)
        yfreq <- xfreq/thin
    }
    else {
        thin <- 1
        yfreq <- xfreq
        warning("Frequency not changed")
    }
    start <- if (missing(start)) 
        xtsp[1]
    else switch(length(start), start, start[1] + (start[2] - 
        1)/xfreq, stop("Bad value for start"))
    if (start < xtsp[1]) {
        start <- xtsp[1]
        warning("start value not changed")
    }
    end <- if (missing(end)) 
        xtsp[2]
    else switch(length(end), end, end[1] + (end[2] - 1)/xfreq, 
        stop("Bad value for end"))
    if (end > xtsp[2]) {
        end <- xtsp[2]
        warning("end value not changed")
    }
    if (start > end) 
        stop("start cannot be after end")
    if (all(abs(start - xtime) > abs(start) * ts.eps)) {
        start <- xtime[(xtime > start) & ((start + 1/xfreq) > 
            xtime)]
    }
    if (all(abs(end - xtime) > abs(end) * ts.eps)) {
        end <- xtime[(xtime < end) & ((end - 1/xfreq) < xtime)]
    }
    i <- seq(trunc((start - xtsp[1]) * xfreq + 1.5), trunc((end - 
        xtsp[1]) * xfreq + 1.5), by = thin)
    y <- if (is.matrix(x)) 
        x[i, , drop = FALSE]
    else x[i]
    ystart <- xtime[i[1]]
    yend <- xtime[i[length(i)]]
    tsp(y) <- c(ystart, yend, yfreq)
    y
}


--_=XFMail.1.3.p0.Linux:990702182137:16900=_--
End of MIME message
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  2 18:27:58 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Jul 1999 19:27:58 +0200
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Martyn Plummer's message of "Fri, 02 Jul 1999 17:52:17 +0200 (CEST)"
References: <XFMail.990702175217.plummer@iarc.fr>
Message-ID: <x2u2rnarmp.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> Vin Everett, who is actually doing the compiling, has provided output
> from gdb, which is given below. Any help would be greatly appreciated.
> 
> Martyn
> 
> > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0xb1dc8 in hqr2_ ()
> (gdb) 
> 
> bt gives:-
> (gdb) bt
> #0  0xb1dc8 in hqr2_ ()
> #1  0xb4bb4 in rg_ ()

You kind of forgot to tell us which version of R and which
compiler.... 

The first thing I'd try would be to change the FFLAGS line in Makeconf
to -g and recompile eigen.o. That way gdb would at least tell you
exactly where it crashes.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Mon Jul  5 09:21:44 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Mon, 05 Jul 1999 08:21:44 +0000
Subject: Problem with plot.ts, "["
References: <377CE74E.A742EB01@wu-wien.ac.at> <x2vhc3at84.fsf@blueberry.kubism.ku.dk>
Message-ID: <37806B18.F08AFB2D@wu-wien.ac.at>

Peter Dalgaard BSA wrote:

> Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> writes:
>
> > There seems to be a problem with plot.ts (R Version 0.64.2)
> >
> > >x<-cbind(1:10,2:11)
> > >x<-as.ts(x)
> > >plot(x)
> > Error: subscript (20) out of bounds, should be at most 10
> > >
> >
>
> If it's any consolation to you, this didn't work in 0.64.1 and not in
> 0.65unstable either, although it gets a different error there...
>
> > The problem is located in "[.ts":
> >
> > > x<-cbind(1:10,2:11)
> > > x[is.finite(x)]
> >  [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> > > x<-as.ts(x)
> > > x[is.finite(x)]
> > Error: subscript (20) out of bounds, should be at most 10
> > >
> >
> > and there (in "[.ts") the following statement gives the error:
>
> Actually, I suspect that the mistake is to do  x[is.finite(x)] in the
> first place. It is used to calculate ranges for plot limits, but one
> might better have used range(x,finite=TRUE) for that.

In fact, that works fine and does not affect the "[.ts" method.

Concerning "[.ts" method, I think the user expects that it works
like the "[" for vectors and matrices with further setting the
tsp attributes correctly. Hence, also for me the actual behaviour
is more a bug than a feature...

thanks

Adrian

>
>
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul  5 14:27:12 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 05 Jul 1999 09:27:12 -0400
Subject: Problem with plot.ts, "["
References: <377CE74E.A742EB01@wu-wien.ac.at> <x2vhc3at84.fsf@blueberry.kubism.ku.dk> <37806B18.F08AFB2D@wu-wien.ac.at>
Message-ID: <3780B2AD.26375290@bank-banque-canada.ca>

>Concerning "[.ts" method, I think the user expects that it works
>like the "[" for vectors and matrices with further setting the
>tsp attributes correctly.

The problem is that for any complicated subset in the time dimesion it
becomes very difficult to decide what the correct tsp attributes should
be. I think after previous discussions we agreed that window should be
used to preserve attributes in the time dimension and "[.ts" should drop
any ts attributes. In the non-time dimension it makes more sense to
preserve ts attributes, but S does not, as I recall. I'm not sure what
the status of this change is, but I don't think the behaviour is the
same in 0.65 as it was in 0.64.1.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From vin.everett@mrc-bsu.cam.ac.uk  Mon Jul  5 16:56:12 1999
From: vin.everett@mrc-bsu.cam.ac.uk (Vin Everett)
Date: Mon, 05 Jul 1999 16:56:12 +0100
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Your message of "02 Jul 1999 19:27:58 +0200."
 <x2u2rnarmp.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907051556.QAA24294@bernstein.mrc-bsu.cam.ac.uk>


Hello Peter,

I hope this is more helpful ?

-g flag, using g77 version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release) (from FSF-g77 version 0.5.24-19981002)

And srpms R-base-0.64.1-6.src.rpm


Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) bt
#0  hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
#1  0xb4c10 in rg_ (nm=0x70d99fd0, n=0x70d99fc8, a=0x70d99f80, wr=0x70d99f68, 
    wi=0x70d99f50, matz=0x70d99f48, z=0x70d99f00, iv1=0x70d99ef0, 
    fv1=0x70d99ed8, ierr=0x70d99ed0) at eigen.f:3263
#2  0x3909c in do_dotCode (call=0x70421f64, op=0x70421b90, args=0x70679f28, 
    env=0x7067791c) at dotcode.c:386
#3  0x3fc7c in eval (e=0x70421f64, rho=0x7067791c) at eval.c:180
#4  0x41118 in do_set (call=0x70421fa0, op=0x702d4828, args=0x70421f8c, 
    rho=0x7067791c) at eval.c:761
#5  0x3fc7c in eval (e=0x70421fa0, rho=0x7067791c) at eval.c:180
#6  0x40b58 in do_begin (call=0x70421fb4, op=0x702d48c8, args=0x70421fc8, 
    rho=0x7067791c) at eval.c:588
#7  0x3fc7c in eval (e=0x70421fb4, rho=0x7067791c) at eval.c:180
#8  0x40280 in do_if (call=0x70422ef0, op=0x702d44b8, args=0x70422edc, 
    rho=0x7067791c) at eval.c:379
#9  0x3fc7c in eval (e=0x70422ef0, rho=0x7067791c) at eval.c:180
#10 0x40b58 in do_begin (call=0x70422f04, op=0x702d48c8, args=0x70422f18, 
    rho=0x7067791c) at eval.c:588
#11 0x3fc7c in eval (e=0x70422f04, rho=0x7067791c) at eval.c:180
#12 0x40280 in do_if (call=0x70423120, op=0x702d44b8, args=0x7042310c, 
    rho=0x7067791c) at eval.c:379
#13 0x3fc7c in eval (e=0x70423120, rho=0x7067791c) at eval.c:180
#14 0x40b58 in do_begin (call=0x7041eddc, op=0x702d48c8, args=0x70423134, 
    rho=0x7067791c) at eval.c:588
#15 0x3fc7c in eval (e=0x7041eddc, rho=0x7067791c) at eval.c:180
#16 0x3ffcc in applyClosure (call=0x70677868, op=0x7042347c, 
    arglist=0x706778cc, rho=0x702dca50, suppliedenv=0x702d4008) at eval.c:293
#17 0x3fcf0 in eval (e=0x70677868, rho=0x702dca50) at eval.c:189
#18 0x53768 in R_ReplConsole (rho=0x702dca50, savestack=0, browselevel=0)
    at main.c:274
#19 0x53bd0 in mainloop () at main.c:465
#20 0xa0b38 in main (ac=0, av=0xeffffc84) at system.c:641
#21 0x701eb8d0 in __libc_start_main () at ../sysdeps/generic/libc-start.c:78


Cheers Vin

-------------------------------------------------------------------
Vin Everett                   email:  vin.everett@mrc-bsu.cam.ac.uk
Medical Research Council      voice:  +44 (0) 1223 330381 
Biostatistics Unit            fax:    +44 (0) 1223 330383 
Cambridge                     mobile: +44 (0) 468 828238 
Key fingerprint =  69 CE C7 59 9B 7C AB 57  B0 B5 47 2A 1E 99 49 30
-------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Jul  5 17:43:20 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 05 Jul 1999 18:43:20 +0200
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Vin Everett's message of "Mon, 05 Jul 1999 16:56:12 +0100"
References: <199907051556.QAA24294@bernstein.mrc-bsu.cam.ac.uk>
Message-ID: <x2so73yrmf.fsf@blueberry.kubism.ku.dk>

Vin Everett <vin.everett@mrc-bsu.cam.ac.uk> writes:

> Hello Peter,
> 
> I hope this is more helpful ?
> 
> -g flag, using g77 version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release) (from FSF-g77 version 0.5.24-19981002)
> 
> And srpms R-base-0.64.1-6.src.rpm
> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
>     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
>     at eigen.f:2120
> 2120                   RA = RA + H(I,J) * H(J,NA)
> Current language:  auto; currently fortran
> (gdb) bt

Fine, now what is the value of i,j, and na at that point? (the p
function in gdb) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From vin.everett@mrc-bsu.cam.ac.uk  Tue Jul  6 10:53:59 1999
From: vin.everett@mrc-bsu.cam.ac.uk (Vin Everett)
Date: Tue, 06 Jul 1999 10:53:59 +0100
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Your message of "05 Jul 1999 18:43:20 +0200."
 <x2so73yrmf.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907060953.KAA01225@bernstein.mrc-bsu.cam.ac.uk>


Hi Peter, sorry for the tardiness, I have been in a meeting the gdb p option 
provides no history.

Cheers Vin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Wed Jul  7 06:15:02 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed, 7 Jul 1999 07:15:02 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199907070515.HAA10215@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 192 *
Subject: dev.print aspect ratio
From: wsi@gcal.ac.uk
Date: Tue, 11 May 1999 13:43:50 +0200 (MET DST)
--Difficulty getting a square plot.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.
* PR# 211 *
Subject: readline/history size
From: seniorr@teleport.com
Date: Tue, 15 Jun 1999 00:08:59 +0200 (MET DST)
--Limitation of history size. Kurt cannot reproduce. 
--Depends on libreadline version??

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 118 *
Subject: Function parsing
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 10 Feb 1999 13:42:01 +0000 (GMT)
--comment placement.

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

* PR# 21 *
Subject: Restoring large image files
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 21 Aug 1998 13:29:16 -0000 ()
--Request to change in error conditions in R_InitialData. Could be done, but
--at present initial loads are not distinguished from load("file") calls. 

Directory:  System-specific

* PR# 145 *
Subject: R-0.63.3 package on IRIX 6.5 machine
From: Jayshree Sarma <jsarma@cs.gmu.edu>
Date: Tue, 23 Mar 1999 16:54:20 -0500 (EST)
* PR# 163 *
Subject: IRIX compile
From: mtim@farm.ecs.umass.edu
Date: Sat, 10 Apr 1999 19:35:43 +0200
* PR# 196 *
Subject: R 0.64 and -release fails to build on DU4.0
From: Leif Johansson <leifj@matematik.su.se>
Date: Fri, 14 May 1999 12:32:14 +0200
* PR# 201 *
Subject: RedHat Linux 6.0 Problems
From: jacobm@magnet.drcmr.dk
Date: Wed, 2 Jun 1999 10:58:45 +0200 (MET DST)
* PR# 208 *
Subject: R correct g77 flags for Linux/Alpha
From: Naoki Takebayashi <ntakebay@bio.indiana.edu>
Date: Tue, 8 Jun 1999 19:12:03 -0500 (EST)
* PR# 209 *
Subject: Compilation fails
From: beimfohr@statistik.uni-dortmund.de
Date: Thu, 10 Jun 1999 13:52:01 +0200 (MET DST)
* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 216 *
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 2 Jul 1999 18:45:20 +0200
* PR# 217 *
Subject: RE: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 02 Jul 1999 18:21:37 +0200 (CEST)
Date: 02-Jul-99
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jperez@cesma.usb.ve  Wed Jul  7 15:23:54 1999
From: jperez@cesma.usb.ve (jperez@cesma.usb.ve)
Date: Wed, 7 Jul 1999 16:23:54 +0200 (MET DST)
Subject: Bug on sample (PR#219)
Message-ID: <199907071423.QAA19825@pubhealth.ku.dk>

Full_Name: Jose M. Perez
Version: 0.64.2
OS: Linux/x86
Submission from: (NULL) (159.90.200.68)


sample(1,1,prob=c(1))
Causes a core dump.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jperez@cesma.usb.ve  Wed Jul  7 15:23:33 1999
From: jperez@cesma.usb.ve (jperez@cesma.usb.ve)
Date: Wed, 7 Jul 1999 16:23:33 +0200 (MET DST)
Subject: Bug on sample (PR#218)
Message-ID: <199907071423.QAA19811@pubhealth.ku.dk>

Full_Name: Jose M. Perez
Version: 0.61.2
OS: Linux/x86
Submission from: (NULL) (159.90.200.68)


sample(1,1,prob=c(1))
Causes a core dump.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 15:45:41 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 16:45:41 +0200
Subject: Bug on sample (PR#219)
In-Reply-To: jperez@cesma.usb.ve's message of "Wed, 7 Jul 1999 16:23:54 +0200 (MET DST)"
References: <199907071423.QAA19825@pubhealth.ku.dk>
Message-ID: <x2oghobjsa.fsf@blueberry.kubism.ku.dk>

jperez@cesma.usb.ve writes:

> sample(1,1,prob=c(1))
> Causes a core dump.

...confirmed. prob=1 is not necessary, sample(1,1,,.1) crashes too.

Cause: revsort() does horrible things if n <= 1. Will fix.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Jul  7 17:35:36 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 7 Jul 1999 18:35:36 +0200 (CEST)
Subject: Almost succesfull build on AIX
Message-ID: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>


Hi,

Kurt Hornik and myself have an almost successful build of R on AIX 
including dynamic loading of libraries ... which fails make check :-(
Anyway, as we have no AIX experience at all, maybe somebody else knows
what's going on.

Here's the problem:

> 1/0
[1]INF
> is.finite(1/0)
[1] TRUE

R was built using the flags included below, gcc version is 2.7.2. Does
anybody with experience on AIX know what's going on (the all uppercase
INF looks somewhat suspicious).

If you want to give it a try, in tomorrow's devel snapshot from CRAN
all configure/make scripts should be sufficent for a usual compile,
i.e., simply say
	configure; make
using GNU make and the install-sh from the tools directory (the
installbsd on our AIX machine fails).

Best,
Fritz

**********************************************************

> version
           _                           
platform   rs6000-ibm-aix4.2.1.0       
arch       rs6000                      
os         aix4.2.1.0                  
system     rs6000, aix4.2.1.0          
status     Under development (unstable)
status.rev 0                           
major      0                           
minor      65.0                        
year       1999                        
month      July                        
day        08                          
language   R                           


**********************************************************


PACKAGE = R
VERSION = 0.65.0

AR = ar
BLAS = 
CC = gcc
CFLAGS = -g -O2
CPICFLAGS = -fPIC
CPPFLAGS = 
DEFS = -DHAVE_CONFIG_H
DLLFLAGS = -bdynamic -bE:$(top_builddir)/etc/R.exp -bM:SRE -lc -lm
DVIPS = /usr/local/bin/dvips
FC = f77
FFLAGS = 
FLIBS = -lblas  -L/usr/local/lib -lxlf90 -lxlf -lm
FPICFLAGS = -fPIC
F2C = 
F2CFLAGS = 
GNOMEUI_LIBS = 
GNOME_LIBDIR = 
GNOME_INCLUDEDIR = 
INSTALL = /tmp/fl/R/tools/install-sh -c
INSTALL_DATA = ${INSTALL} -m 644
INSTALL_PROGRAM = ${INSTALL}
INSTALL_DIR = ${INSTALL} -d
LATEX = /usr/local/bin/latex
LDCMD = f77
LDFLAGS = 
LIBS = -ldl -ltermcap -lm 
LN_S = ln -s
MAKEINDEX = /usr/local/bin/makeindex
MKINSTALLDIRS = $(top_srcdir)/tools/mkinstalldirs
R_XTRA_CFLAGS = 
R_XTRA_CPPFLAGS = -I. -I../include -I$(top_srcdir)/src/include
R_XTRA_FFLAGS = 
R_XTRA_LIBS = 
RANLIB = ranlib
SHELL = /bin/sh
SHLIBEXT = so
SHLIBLD = f77
SHLIBLDFLAGS = -bM:SRE -H512 -T512 -bnoentry -bexpall       -bI:$(R_HOME)/etc/R.
exp -lc -lm
TAR = tar
X_CFLAGS = 
X_LIBS =  -lX11
X_PRE_LIBS = 
X_EXTRA_LIBS = 
YACC = bison -y
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul  7 18:00:11 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Jul 1999 19:00:11 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>
References: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>
Message-ID: <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>

>>>>> Friedrich Leisch writes:

> Hi,

> Kurt Hornik and myself have an almost successful build of R on AIX 
> including dynamic loading of libraries ... which fails make check :-(
> Anyway, as we have no AIX experience at all, maybe somebody else knows
> what's going on.

> Here's the problem:

>> 1/0
> [1]INF
>> is.finite(1/0)
> [1] TRUE

> R was built using the flags included below, gcc version is 2.7.2. Does
> anybody with experience on AIX know what's going on (the all uppercase
> INF looks somewhat suspicious).

> If you want to give it a try, in tomorrow's devel snapshot from CRAN
> all configure/make scripts should be sufficent for a usual compile,
> i.e., simply say
> 	configure; make
> using GNU make and the install-sh from the tools directory (the
> installbsd on our AIX machine fails).

If I may add.  Building for me only works with LDCMD and SHLIBLD as

	f77
or
	cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

It did not work with

	ld (gives an exec format error in the main binary)
or
	gcc (cannot find libgcc.a???)

I am not sure up to what extend this is a problem with AIX in general or
the specific system Fritz and I have access to, which in particular has
gcc built 3 years ago for AIX 3.something.

Perhaps someone knows more about this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.princeton.edu  Wed Jul  7 20:43:33 1999
From: ben@eno.princeton.edu (Ben Bolker)
Date: Wed, 7 Jul 1999 15:43:33 -0400 (EDT)
Subject: superscript -,+?
Message-ID: <Pine.SUN.3.95.990707153807.18452A-100000@paca>


  In Version 0.64.1  (May 8, 1999), Solaris 2.5.1,

   expression(theta^{-})
      
      and

   expression(theta^{+})

 (and the equivalent subscripts) give syntax errors.

  (Superscript or subscripts of numbers, letters, or "+1" or "-1" all
work.)

  Anyone have a workaround or a patch?
  Or should I just use psfrag as god intended?

  Ben


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.princeton.edu  Wed Jul  7 20:52:47 1999
From: ben@eno.princeton.edu (Ben Bolker)
Date: Wed, 7 Jul 1999 15:52:47 -0400 (EDT)
Subject: answering my own question
Message-ID: <Pine.SUN.3.95.990707155129.18476A-100000@paca>


  expression(theta^{"+"})
  expression(theta^{"-"})
  expression({theta^{"+"}}(mu)})

  etc., work fine (once I actually *thought* about what the problem was)

 Ben B.

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Wed Jul  7 21:39:44 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Wed, 07 Jul 1999 16:39:44 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Wed, 07 Jul 1999 19:00:11 EDT."
 <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>
Message-ID: <199907072039.QAA29250@infiniti.ece.cmu.edu>


"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>> Here's the problem:
>>> 1/0
>> [1]INF
>>> is.finite(1/0)
>> [1] TRUE

Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
program.  Should this not result in a floating point exception?

>> R was built using the flags included below, gcc version is 2.7.2. Does
>> anybody with experience on AIX know what's going on (the all uppercase
>> INF looks somewhat suspicious).

Because it's a return value, not the R string "Inf".  Wild guess,
lemme think about it.

Kurt> If I may add.  Building for me only works with LDCMD and SHLIBLD as
Kurt> 
Kurt> f77
Kurt> or
Kurt> cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

Yes, there is still something wrong with the DLLFLAGS.  (Which also
shows up when you try to link local libraries (like a private copy of
the readline lib).)   I've played a little more with the way R.exp is
generated.  Let me try it on 64.2 and 65.

Kurt> It did not work with
Kurt> ld (gives an exec format error in the main binary)

My experience is that if I compile the main function with gcc then I
have to link with gcc, otherwise it can't find .__main.  Which leads
to:

Kurt> gcc (cannot find libgcc.a???)
Yep and hmm.  Arne found that you can say "gcc --print-libgcc-file-name" and
then gcc actually does that.  You can add the result of the command on
the link line.  (If however gcc never finds libgcc.a then you're in
deep trouble.  Check wether you can find gcc's spec file.)

Kurt> I am not sure up to what extend this is a problem with AIX in general or
Kurt> the specific system Fritz and I have access to, which in particular has
Kurt> gcc built 3 years ago for AIX 3.something.

Probably something with AIX in general.

BTW, do you not get compiler errors about blkcnt not being defined
when you compile with gcc?  So far, I had to patch most programs
because there is a bug with the standard include files.

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 22:17:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 23:17:55 +0200
Subject: [R] superscript -,+?
In-Reply-To: Ben Bolker's message of "Wed, 7 Jul 1999 15:43:33 -0400 (EDT)"
References: <Pine.SUN.3.95.990707153807.18452A-100000@paca>
Message-ID: <x2lncsupks.fsf@blueberry.kubism.ku.dk>

Ben Bolker <ben@eno.princeton.edu> writes:

>   In Version 0.64.1  (May 8, 1999), Solaris 2.5.1,
> 
>    expression(theta^{-})
>       
>       and
> 
>    expression(theta^{+})
> 
>  (and the equivalent subscripts) give syntax errors.
> 
>   (Superscript or subscripts of numbers, letters, or "+1" or "-1" all
> work.)
> 
>   Anyone have a workaround or a patch?
>   Or should I just use psfrag as god intended?
> 

Both theta^"+" and theta^+{} seem to work ok. The thing to remember is
that + is an operator so if it is used in an expression, it needs to
have something to operate on, or you need to explicitly use it as a
character.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 22:35:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 23:35:37 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: Thomas Vogels's message of "Wed, 07 Jul 1999 16:39:44 -0400"
References: <199907072039.QAA29250@infiniti.ece.cmu.edu>
Message-ID: <x2k8scuora.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 
> >> Here's the problem:
> >>> 1/0
> >> [1]INF
> >>> is.finite(1/0)
> >> [1] TRUE
> 
> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
> program.  Should this not result in a floating point exception?

Not according to IEEE specs (but integer divide by zero is generally
unmaskable). The interesting thing is that is.finite returns TRUE on
the result, and the printing also suggests that the infinite value is
not recognised internally (if it were, it would get printed as 
> 1/0
[1] Inf
)

It would be nice to see the actual bit pattern of 1/.0. Could one of
you do something like

	x = 1/.0;
	printf("%0x,%0x\n", ((int *) &x)[0], ((int *) &x)[1]);

or whatever other obfuscation works on AIX...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kriszti@a2a00996.direct.bconnected.net  Thu Jul  8 06:55:43 1999
From: kriszti@a2a00996.direct.bconnected.net (kriszti@a2a00996.direct.bconnected.net)
Date: Thu, 8 Jul 1999 07:55:43 +0200 (MET DST)
Subject: Bad Units Bug in barplot with pictex output device. (PR#220)
Message-ID: <199907080555.HAA22260@pubhealth.ku.dk>

Dear Bug Team:

I encountered a bug when trying to make a barplot with the pictex
output device.

The following commands demonstrate the bug:

-----------------------------------------------
> errors <- c(3.08, 35.38, 33.85, 20.00,  7.69)
> errors
[1]  3.08 35.38 33.85 20.00  7.69
> pictex()
> barplot(errors)
Error: Bad units specified in GConvert, please report!
> 
-----------------------------------------------

Here is my R version information:

-----------------------------------------------
> Version()
$platform
[1] "i386-unknown-freebsd2.2.7"

$arch
[1] "i386"

$os
[1] "freebsd2.2.7"

$system
[1] "i386, freebsd2.2.7"

$status
[1] ""

$status.rev
[1] "0"

$major
[1] "0"

$minor
[1] "62.2"

$year
[1] "1998"

$month
[1] "July"

$day
[1] "10"

$language
[1] "R"

---------------------------------------------------

Thank you very much for all your good work on R!

Best regards,

Krisztina Vasarhelyi
Anthropologisches Institut der
Universitaet Zuerich
krva@aim.unizh.ch

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul  8 07:34:00 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 8 Jul 1999 08:34:00 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907072039.QAA29250@infiniti.ece.cmu.edu>
References: <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>
 <199907072039.QAA29250@infiniti.ece.cmu.edu>
Message-ID: <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>> Here's the problem:
>>>> 1/0
>>> [1]INF
>>>> is.finite(1/0)
>>> [1] TRUE

Ah ... but FRITZ wrote that ...

> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
> program.  Should this not result in a floating point exception?

>>> R was built using the flags included below, gcc version is 2.7.2. Does
>>> anybody with experience on AIX know what's going on (the all uppercase
>>> INF looks somewhat suspicious).

> Because it's a return value, not the R string "Inf".  Wild guess,
> lemme think about it.

Kurt> If I may add.  Building for me only works with LDCMD and SHLIBLD as
Kurt> 
Kurt> f77
Kurt> or
Kurt> cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

> Yes, there is still something wrong with the DLLFLAGS.  (Which also
> shows up when you try to link local libraries (like a private copy of
> the readline lib).)   I've played a little more with the way R.exp is
> generated.  Let me try it on 64.2 and 65.

Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!

Kurt> It did not work with
Kurt> ld (gives an exec format error in the main binary)

> My experience is that if I compile the main function with gcc then I
> have to link with gcc, otherwise it can't find .__main.  Which leads
> to:

Kurt> gcc (cannot find libgcc.a???)

> Yep and hmm.  Arne found that you can say "gcc
> --print-libgcc-file-name" and then gcc actually does that.  You can
> add the result of the command on the link line.  (If however gcc never
> finds libgcc.a then you're in deep trouble.  Check wether you can find
> gcc's spec file.)

The specs file is fine.  My question is, is that a known gcc problem on
AIX or is that due to the rather outdated version of gcc we have?  If it
is a general problem, I can easily add to DLLFLAGS.

Kurt> I am not sure up to what extend this is a problem with AIX in general or
Kurt> the specific system Fritz and I have access to, which in particular has
Kurt> gcc built 3 years ago for AIX 3.something.

> Probably something with AIX in general.

> BTW, do you not get compiler errors about blkcnt not being defined
> when you compile with gcc?  So far, I had to patch most programs
> because there is a bug with the standard include files.

No.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 08:27:39 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 09:27:39 +0200
Subject: Bad Units Bug in barplot with pictex output device. (PR#220)
In-Reply-To: <199907080555.HAA22260@pubhealth.ku.dk>
 (kriszti@a2a00996.direct.bconnected.net)
References: <199907080555.HAA22260@pubhealth.ku.dk>
Message-ID: <199907080727.JAA21615@sophie.ethz.ch>

Dear Krisztina
The bug you reported has been fixed a while ago.

you "only" need to upgrade your version of R.
As you said it's 0.62.2 of July 1998.

Just get 0.64.2 of July 1999...
from any CRAN mirror, ie. in your case from  http://stat.ethz.ch/CRAN/

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 09:24:15 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 10:24:15 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: <x2k8scuora.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 07 Jul 1999 23:35:37 +0200)
References: <199907072039.QAA29250@infiniti.ece.cmu.edu> <x2k8scuora.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907080824.KAA26378@sophie.ethz.ch>

>>>>> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:
    >> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

      > >> Here's the problem:
      > >>> 1/0
      > >> [1]INF
      > >>> is.finite(1/0)
      > >> [1] TRUE

    >> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
    >> program.  Should this not result in a floating point exception?

    PD> Not according to IEEE specs (but integer divide by zero is
    PD> generally unmaskable). The interesting thing is that is.finite
    PD> returns TRUE on the result, and the printing also suggests that the
    PD> infinite value is not recognised internally (if it were, it would
    PD> get printed as
    >> 1/0
    PD> [1] Inf )

    PD> It would be nice to see the actual bit pattern of 1/.0. Could one
    PD> of you do something like

    PD>    x = 1/.0; printf("%0x,%0x\n", ((int *) &x)[0], ((int *) &x)[1]);

    PD> or whatever other obfuscation works on AIX...

I've done more than Peter requested;
namely, the "finite" probing has always been a big problem on AIX,
and I rediscovered my old testing code -- which I enhanced with Peter's HEX
dump proposal:
  [everything in  ftp://stat.ethz.ch/U/maechler/R/AIX-finite-tst.tar.gz !]

    #include <stdio.h>
    #include <math.h>

    #ifdef AIX
    # include <fp.h>
    #endif

    main() {
      double x,x2,x3;
      printf("finite(1.0)= %d (=1, hopefully)\n", finite(1.0));
      x=1./0.; x2= (-1.)/0.;  x3 = 0./0.;
      printf("Inf := 1/0 = %f;\t -Inf := -1/0 = %f;\t NaN:= 0/0 = %f\n",x, x2, x3);
      printf("finite(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
	     finite(x),finite(x2),finite(x3));
      printf("Now the `bits':\n");
      printf(" Inf : %0x,%0x\n", ((int *) &x )[0], ((int *) &x )[1]);
      printf("-Inf : %0x,%0x\n", ((int *) &x2)[0], ((int *) &x2)[1]);
      printf(" NaN : %0x,%0x\n", ((int *) &x3)[0], ((int *) &x3)[1]);

    #ifdef AIX
      printf("FINITE(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
	     FINITE(x),FINITE(x2),FINITE(x3));
    #endif
    }

------------
And I have this in my Makefile  [also available on Web, s.above]

    ## on AIX (percol)
    #CFLAGS = -D_XOPEN_SOURCE -DAIX
    # better for R (defines cosh(.)  AND fd_set(.) (sys/time.h):
    CFLAGS = -D_XOPEN_SOURCE_EXTENDED=1 -DAIX

My Conclusions: 

  - Only if I use these CFLAGS does  finite work properly.
  - The bit pattern are compiler-independent for +-Inf, but NOT for NaN :

Here is gcc [with above CFLAGS],  gcc version 2.7.2.3,  output:
----------------------------------
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;	 -Inf := -1/0 = -INF;	 NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
----------------------------------

xlc (the native AIX C compiler) gives the same BUT for the NaN bit pattern
where it has

 NaN : 7ff80000,0

------------------------

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 11:36:36 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 12:36:36 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: <199907080824.KAA26378@sophie.ethz.ch> (message from Martin
 Maechler on Thu, 8 Jul 1999 10:24:15 +0200)
References: <199907072039.QAA29250@infiniti.ece.cmu.edu> <x2k8scuora.fsf@blueberry.kubism.ku.dk> <199907080824.KAA26378@sophie.ethz.ch>
Message-ID: <199907081036.MAA02797@sophie.ethz.ch>

To add to my last E-mail  
where I said more-or-less

      ``we need  CFLAGS   -D_XOPEN_SOURCE_EXTENDED=1  

        for finite() and things to work ''

I now have put this into  config.site,
but then the compilation breaks when trying to compile 
src/unix/sock.c

it seems because of broken combination of header files 
   /usr/include/netinet/in_systm.h
   /usr/include/netinet/tcp.h
   /usr/include/netinet/ip.h

Maybe,  sock.c  {and further files?}
use other CFLAGS explicitly ?

Here the beginning of the long compilation error messages:

 gcc -I. -I../include -I../../src/include   -DHAVE_CONFIG_H  -g -O2 -D_XOPEN_SOURCE_EXTENDED=1 -c sock.c -o sock.o

 In file included from /usr/include/netinet/ip.h:75,
		  from /usr/include/netinet/tcp.h:72,
		  from sock.c:25:
 /usr/include/netinet/in_systm.h:79: parse error before `n_short'
 /usr/include/netinet/in_systm.h:79: warning: data definition has no type or storage class
 /usr/include/netinet/in_systm.h:80: parse error before `n_long'
 /usr/include/netinet/in_systm.h:80: warning: data definition has no type or storage class
 /usr/include/netinet/in_systm.h:82: parse error before `n_time'
 /usr/include/netinet/in_systm.h:82: warning: data definition has no type or storage class
 In file included from /usr/include/netinet/tcp.h:72,
		  from sock.c:25:
 /usr/include/netinet/ip.h:104: parse error before `u_long'
 /usr/include/netinet/ip.h:104: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:104: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:114: parse error before `ip_xhl'
 /usr/include/netinet/ip.h:114: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:119: warning: data definition has no type or storage class
 /usr/include/netinet/ip.h:120: parse error before `}'
 /usr/include/netinet/ip.h:120: warning: data definition has no type or storage class
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul  8 14:52:10 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Jul 1999 15:52:10 +0200
Subject: r-bugs going down temporarily (upgrade)
Message-ID: <x27lobw8ol.fsf@blueberry.kubism.ku.dk>

I'll start upgrading the computer running the r-bugs web server in a
moment (to RedHat 6.0). This *should* be a relatively painless
operation, but you never know... Email to r-bugs is handled by a
different machine and should remain unaffected.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Jul  8 19:05:43 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 08 Jul 1999 14:05:43 -0400
Subject: summary.default & is.recursive
References: <199907071321.PAA16206@sophie.ethz.ch> <378361E6.5BF86D8C@bank-banque-canada.ca> <199907080634.IAA21541@sophie.ethz.ch> <3784BC8C.6801672@bank-banque-canada.ca> <199907081615.SAA08660@sophie.ethz.ch>
Message-ID: <3784E877.40D25BE9@bank-banque-canada.ca>

I'm moving this part of an on-going discussion to r-devel because I think I've
uncovered a bug:

>summary.default :  How is yours different from R's (I didn't try to find out)
>       If it has an advantage you should post to R-devel as a proposal

I did propose  it along time ago, but ... The fix was for a bug that Splus 3.2
and 3.3 have. It does not work properly with lists having an object with class
length greater than 1. I reported it to StatSci and it was suppose to get fixed
in 3.3 but didn't. I'm not sure about later versions. Having now just checked R,
I see that R's summary.default has been changed. But the problem does not occur
because another more serious incompatibility occurs first:

z <- 1:3
class(z) <- c("a", "b")

is.recursive(list(z, a=list(1:3)) )

R64.2:>   [1] FALSE
Splus3.3> [1] T


My change to summary.default was to fix the following warning in Splus3.2 and
3.3:

> summary.default(list(z, a=list(1:3)))
  Length Class    Mode
  3      a     numeric
a 1            list
Warning messages:
  Replacement length not a multiple of number of elements to replace in: sumry[
 i, 2] <- class(ii)

and consisted simply of changing

      sumry[i, 2] <- if (is.object(ii))
           class(ii)
to
   sumry[i, 2] <- if (is.object(ii))
        paste(class(ii), collapse=" ")

This may not be necessary in the current R version, but because of the above
error in is.recursive, that part of summary.default is not used now.


Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul  8 19:36:47 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu, 8 Jul 1999 20:36:47 +0200 (MET DST)
Subject: summary.default & is.recursive (PR#221)
Message-ID: <199907081836.UAA28992@pubhealth.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> is.recursive(list(z, a=list(1:3)) )
> 
> R64.2:>   [1] FALSE
> Splus3.3> [1] T

Yup, it's a bug. Cc'ed to r-bugs so that we don't forget.

> is.recursive(list(1,2))
[1] FALSE
> is.recursive(pairlist(1,2))
[1] TRUE

[maybe Martin would want to add a check that is.whatever works
identically on lists and pairlists. Not is.pairlist, though...]
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Thu Jul  8 05:14:11 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Thu, 8 Jul 1999 16:14:11 +1200
Subject: Gnome interface status report
Message-ID: <19990708161411.A97838@r.stat.auckland.ac.nz>

Hi,

The Gnome version now compiles, and it should also be working (at least as much as it
ever has).  I've changed Makefile.in to the new system, which is very cool.  What I
want to work on now is:

- Graphics.  I want to move to the Gnome canvas for this, which should be reasonably
  easy.  This will give us rotated text (which I never got going properly before) and
  the option for antialiased graphics.  However, there are some unimplemented bits in
  the canvas (and the antialiasing is currently a bit buggy), so this may take a while
  to get going properly.

- Printing.  This will hopefully include chucking text (like the console and help
  pages) to the print spooler, and somehow making graphics windows spit out PS files.
  If the Gnome print architecture ever gets finished, we will be able to do really
  cool printing stuff, but that might be a while.

- Preferences.  I need to add a few more things, and make some of the existing prefs
  actually do something.  Some of this will be easier once Brian Ripley's stuff to do
  with the command line parameters is finished, I think.

- Syntax highlighting.  Someone has written a widget that can do syntax highlighting,
  so I would like to base the R console on it.  This could take a bit of work, but
  would look fantastic.

I've decided to use Glade (http://glade.pn.org) for laying out the dialog boxes from
now on.  This will mean fixing a couple of things in Glade, and including libglade in
the R source (this will only affect the gnome part of the source, of course).  The
time savings from using Glade are incredible; writing the GUI code in C was horrible.

Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Jul  9 04:35:58 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Thu, 08 Jul 1999 23:35:58 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Thu, 08 Jul 1999 08:34:00 EDT."
 <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>
Message-ID: <199907090335.XAA03774@infiniti.ece.cmu.edu>


(If you don't care about R on AIX, happily ignore this email...)

First about Martin's question (concerning /usr/bin/make):
  I took a quick look at the Makefile.  The problem is with the
Makedeps target.  Replacing $< with $? solves the problem.  Shouldn't
but does.  Will this break on other platforms?  Shouldn't but may.

"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>> Yes, there is still something wrong with the DLLFLAGS.  (Which also
>> shows up when you try to link local libraries (like a private copy of
>> the readline lib).)   I've played a little more with the way R.exp is
>> generated.  Let me try it on 64.2 and 65.

Kurt> Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!
I know, but I also need a stable version.

Kurt> gcc (cannot find libgcc.a???)

If gcc cannot find libgcc.a for any other compilation, I'd get worried
in your place.  I might even get scared.
For R.binary linking it's simple and necessary to search for
libgcc.a and put it in the DLLFLAGS.  If you want to link with ld
instead of cc/f77, you have to add default libs, like -lxlf90 -lxlf
-lc -lm.  Which ones exactly, you can find out by calling ld with the
nobind option.  Most instructive since this will result in the binder
commands being printed.  

Kurt> The specs file is fine.  My question is, is that a known gcc problem on
Kurt> AIX or is that due to the rather outdated version of gcc we have?  If it
Kurt> is a general problem, I can easily add to DLLFLAGS.

See above.  But we may not be talking about the same.  When is
libgcc.a not found?

>> BTW, do you not get compiler errors about blkcnt not being defined
>> when you compile with gcc?  So far, I had to patch most programs
>> because there is a bug with the standard include files.

Hmm, I have gcc 2.8.1 (for AIX 4.1) which barfs at sys/stat.h and
friends. Somehow somebody forgot sometime about "typedef long
blk_cnt".  Or something close to this effect.

About DLLFLAGS, SHLIBLD etc:  Currently you'll probably need to know
the libraries (-lm -lxlf ...) when linking a shared lib since the
fortran library code is currently not exported via ldAIX4.  Is this
"bad"?  Is it worth spending time to get this right, i.e. R.binary
exports all symbols that are actually linked in?  Or can we live with
the baggage of extra libs in SHLIBFLAGS and a little bit bigger shared
libs?

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 15:18:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Jul 1999 16:18:37 +0200
Subject: Those #"&/! comments
Message-ID: <x2emihvrcy.fsf@blueberry.kubism.ku.dk>


I promised R-core write-up of my understanding of the comment
placement nastiness, but I might as well increase the scope to
R-devel:

(R moves, mangles, or deletes comments in mysterious ways -- see for
instance PR#118)

One basic issue is that any R parse tree can have 0, 1, or more
textual representations. Examples

quote(x)                   # one, presumably...
substitute(+x,x=list(1:2)) # none
quote("+"(2,2))	           # two

This means that parse and deparse are not inverses in any sense, and
since you cannot reliably reproduce the textual input, you cannot
place comments correctly either. Of course, one might just say that if
people do sneaky things, then they deserve whatever they get. 

But there's another snag: parse trees can contain any R object and the
only way of placing comments in a parse tree is by attaching them to
one of the nodes. So we have fun with objects carrying the "blah"
comment attribute all over the place, as already happens with 

> f<-function()1#blah
> f()
[1] 1
> f
function () 
structure(1, comment = "#blah")
> dput(f())
structure(1, comment = "#blah")
> substitute(+x,list(x=f()))
+structure(1, comment = "#blah")

On top of that there's figuring out which entity should own a comment.
Probably the most viable scheme is that a comment belongs to the token
preceding it. But not all tokens are stored in the parse tree.
Consider

if  #1
( #2
x #3
) #4
    3 #5
else #6
    4 #7
#8

The parse tree is, however, equivalent to "if"(x, 3, 4)

To faithfully reproduce any "if" construct, one needs to store at
least four comment structures (for "if", "(", ")",and "else") with it.
General function calls have roughly three per actual argument (after
the ',' and before and after the '=').

As you may have gathered, if you set out to get it right this way,
things quickly get unwieldy.

An alternate suggestion (by Robert at the Vienna meeting) is to "store
the text with the function". I am more and more inclined to think that
this is the viable way to proceed. It takes up a bit of space, but so
what? There are several other questions coming up, though:

(1) can one be sure that the text and the parse tree is in sync?
(2) can we retain the automatic indentation when editing?
(3) what does one do with function definitions within functions?

(1) I don't think so. As long as there's a parse step involved in the
    definition, it is easy enough, but body()<- and formals()<- is
    bound to spoil the fun. One could adopt the convention that such
    operations destroy the comment structure (if a function has no
    stored text, just use the old deparsing technique). That would
    leave only direct manipulations of parse trees as a source for
    inconsistency, in which case it would be fair to let the user
    deserve what he gets.

(2) (and I think this is useful for debugging, etc.). One thing that
    one might do is to store the code in tokenized form more or less
    as the lexical analyser generates it. Then just add the
    indentation when printing.

(3) I think it is necessary to store the text *both* with the inner
    and the outer function. It is not too hard to think of schemes
    to keep track of which parts of a token stream are to be cut out
    and stored with the "function" tokens (and, when the definition is
    evaluated, with the resulting function object).


Comments? (Pardon the pun...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul  9 15:34:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 9 Jul 1999 16:34:54 +0200 (CEST)
Subject: platforms
Message-ID: <14214.2190.45310.941332@aragorn.ci.tuwien.ac.at>

As you may have noticed, the configure/make mechanism has undergone
further substantial changes.  The idea is that (maybe setting a few
shell variables) and then doing configure; make; make install should
work ``as much as possible''.

I don't have access to most platforms and cc/f77/make combinations.
What I am looking for is volunteers in r-devel, BUT NOT IN r-core, who
are willing to ``support'' certain
	cpu-vendor-os cc/f77/make
`platforms' in the sense that they regularly try to recompile the
current (devel and maybe also release) versions for their platform and
let me know whether everything is fine or what needs to be fixed.

Any volunteers?  (Note that the PLATFORMS file in the R distribution is
a good start, but I'd really like to keep the info in it as up-to-date
as possible ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul  9 16:13:29 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 9 Jul 1999 17:13:29 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907090335.XAA03774@infiniti.ece.cmu.edu>
References: <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>
 <199907090335.XAA03774@infiniti.ece.cmu.edu>
Message-ID: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> (If you don't care about R on AIX, happily ignore this email...)

> First about Martin's question (concerning /usr/bin/make):
>   I took a quick look at the Makefile.  The problem is with the
> Makedeps target.  Replacing $< with $? solves the problem.  Shouldn't
> but does.  Will this break on other platforms?  Shouldn't but may.

Actually, replacing it by an explicit `Makefile' is much better.  Sorry
for that.  I keep forgetting that $< does strange things with some make
programs ... fixed now.

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>> Yes, there is still something wrong with the DLLFLAGS.  (Which also
>>> shows up when you try to link local libraries (like a private copy of
>>> the readline lib).)   I've played a little more with the way R.exp is
>>> generated.  Let me try it on 64.2 and 65.

Kurt> Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!

> I know, but I also need a stable version.

:-)  (Actually, I think devel is more stable than release.  The major
difference is that configure/make changes are all in devel as they
typically are NOT bug fixes at all, so they must be in devel ...

Kurt> gcc (cannot find libgcc.a???)

> If gcc cannot find libgcc.a for any other compilation, I'd get worried
> in your place.  I might even get scared.
> For R.binary linking it's simple and necessary to search for
> libgcc.a and put it in the DLLFLAGS.  If you want to link with ld
> instead of cc/f77, you have to add default libs, like -lxlf90 -lxlf
> -lc -lm.  Which ones exactly, you can find out by calling ld with the
> nobind option.  Most instructive since this will result in the binder
> commands being printed.

How does this work exactly?

Kurt> The specs file is fine.  My question is, is that a known gcc problem on
Kurt> AIX or is that due to the rather outdated version of gcc we have?  If it
Kurt> is a general problem, I can easily add to DLLFLAGS.

> See above.  But we may not be talking about the same.  When is
> libgcc.a not found?

Here's what happens:

e8725245@fbma:/tmp/fl/build/src/main$ gmake LDCMD=gcc
gmake[1]: Entering directory `/tmp/fl/build/src/main'
gmake[1]: `Makedeps' is up to date.
gmake[1]: Leaving directory `/tmp/fl/build/src/main'
gmake[1]: Entering directory `/tmp/fl/build/src/main'
gcc -bdynamic -bE:../../etc/R.exp -bM:SRE -lc -lm -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a  -lX11  -lblas  -L/usr/local/lib -lxlf90 -lxlf -lm  -ldl -ltermcap -lm 
ld: 0706-005 Cannot find or open file: libgcc.a
        ld:open(): No such file or directory
ld: 0706-005 Cannot find or open file: libgcc.a
        ld:open(): No such file or directory
gmake[1]: *** [../../bin/R.X11] Error 1
gmake[1]: Leaving directory `/tmp/fl/build/src/main'
gmake: *** [R] Error 2

???  and interestingly, adding
-L/usr/local/lib/gcc-lib/rs6000-ibm-aix3.2.5/2.7.2/ does not help.

>>> BTW, do you not get compiler errors about blkcnt not being defined
>>> when you compile with gcc?  So far, I had to patch most programs
>>> because there is a bug with the standard include files.

> Hmm, I have gcc 2.8.1 (for AIX 4.1) which barfs at sys/stat.h and
> friends. Somehow somebody forgot sometime about "typedef long
> blk_cnt".  Or something close to this effect.

> About DLLFLAGS, SHLIBLD etc:  Currently you'll probably need to know
> the libraries (-lm -lxlf ...) when linking a shared lib since the
> fortran library code is currently not exported via ldAIX4.  Is this
> "bad"?  Is it worth spending time to get this right, i.e. R.binary
> exports all symbols that are actually linked in?  Or can we live with
> the baggage of extra libs in SHLIBFLAGS and a little bit bigger shared
> libs?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul  9 17:05:28 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 9 Jul 1999 18:05:28 +0200
Subject: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
Message-ID: <199907091605.SAA12966@sophie.ethz.ch>

I've (remote) access to a new Linux system which has some flavor of Rehat
installed.

Compiling R-0.64.2 fails -- at the end when  eda.so should be made.

    make[4]: Entering directory `/u/u2/maechler/Linux/R/R-0.64.2/src/library/eda/src'
    gcc -g -O2 -fpic -I../../../../include -c line.c -o line.o
    gcc -g -O2 -fpic -I../../../../include -c smooth.c -o smooth.o
    ld -shared -o eda.so line.o smooth.o
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:1414
    make[4]: *** [eda.so] Segmentation fault
    make[4]: *** Deleting file `eda.so'
    make[4]: Leaving directory `/u/u2/maechler/Linux/R/R-0.64.2/src/library/eda/src'
    <.....>
    make: *** [R] Error 1

---
Interestingly, "mva" {instead of "eda"} works fine...

Further, the number of
	 "ld: bfd assertion fail ..." 
lines is not constant.  Above we had 2 of them;
but I have also seen 5 :
    ld -shared -o eda.so line.o smooth.o
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:1414
or three....

-----------

mkellers{maechler}425% gcc --version
egcs-2.91.66
mkellers{maechler}426% ld --version
GNU ld 2.9.1
Copyright 1997 Free Software Foundation, Inc.
This program is free software; you may redistribute it under the terms of
the GNU General Public License.  This program has absolutely no warranty.
  Supported emulations:
   elf_i386
   i386linux

------------------

I'm guessing that the  gcc/ld/library combination hasn't been 
installed/configured properly... 
???

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri Jul  9 21:23:25 1999
From: bates@stat.wisc.edu (bates@stat.wisc.edu)
Date: Fri, 9 Jul 1999 22:23:25 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907092023.WAA06813@pubhealth.ku.dk>

..
R is now configured for sparc-sun-solaris2.6

  Source directory:         .
  Installation directory:   /unsup/R-0.64.2
  C compiler:               gcc -g -O2
  FORTRAN compiler:         g77 -O2
  Gnome support:            no

$ gcc --version
egcs-2.91.66
$ g77 --version
GNU Fortran 0.5.24-19981002

"make check" later fails.  The failure is in the test of the eigen()
function.  The specific example is:

> eigen(cbind( 1,3:1,1:3))
Segmentation Fault - core dumped

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Jul  9 21:32:15 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 9 Jul 1999 13:32:15 -0700 (PDT)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <199907092023.WAA06813@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.10.9907091329240.22928-100000@wompom.biostat.washington.edu>

On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:

> ..
> R is now configured for sparc-sun-solaris2.6
> 
>   Source directory:         .
>   Installation directory:   /unsup/R-0.64.2
>   C compiler:               gcc -g -O2
>   FORTRAN compiler:         g77 -O2
>   Gnome support:            no
> 
> $ gcc --version
> egcs-2.91.66
> $ g77 --version
> GNU Fortran 0.5.24-19981002

I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77

wompom% gcc --version
2.8.1
wompom% f77 -V
f77: WorkShop Compilers 4.2 30 Oct 1996 FORTRAN 77 4.2
> eigen(cbind( 1,3:1,1:3))
$values
[1] 5 1 0

$vectors
           [,1]  [,2]       [,3]
[1,] -0.8246211 -1.25 -0.9701425
[2,] -0.8246211 -0.25  0.2425356
[3,] -0.8246211  0.75  0.2425356


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 22:51:34 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Jul 1999 23:51:34 +0200
Subject: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
In-Reply-To: Martin Maechler's message of "Fri, 9 Jul 1999 18:05:28 +0200"
References: <199907091605.SAA12966@sophie.ethz.ch>
Message-ID: <x2oghlxzix.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> I've (remote) access to a new Linux system which has some flavor of Rehat
> installed.
> 
> Compiling R-0.64.2 fails -- at the end when  eda.so should be made.
.....> 
> mkellers{maechler}425% gcc --version
> egcs-2.91.66
> mkellers{maechler}426% ld --version
> GNU ld 2.9.1
> Copyright 1997 Free Software Foundation, Inc.
> This program is free software; you may redistribute it under the terms of
> the GNU General Public License.  This program has absolutely no warranty.
>   Supported emulations:
>    elf_i386
>    i386linux
> 
> ------------------
> 
> I'm guessing that the  gcc/ld/library combination hasn't been 
> installed/configured properly... 
> ???

Or hardware. I've been running that combination for a couple of
months on my home machine and since yesterday on the work machine,
including a compile from scratch of the official 0.64.2 as late as
today (the old binary broke due to the __setfpucw silliness).

But first check the install with 

rpm -V egcs binutils 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 23:04:38 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Jul 1999 00:04:38 +0200
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: Thomas Lumley's message of "Fri, 9 Jul 1999 13:32:15 -0700 (PDT)"
References: <Pine.GSO.4.10.9907091329240.22928-100000@wompom.biostat.washington.edu>
Message-ID: <x2n1x5xyx5.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> 
> > ..
> > R is now configured for sparc-sun-solaris2.6
> > 
> >   Source directory:         .
> >   Installation directory:   /unsup/R-0.64.2
> >   C compiler:               gcc -g -O2
> >   FORTRAN compiler:         g77 -O2
> >   Gnome support:            no
> > 
> > $ gcc --version
> > egcs-2.91.66
> > $ g77 --version
> > GNU Fortran 0.5.24-19981002
> 
> I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77
> 

This is very likely the same trouble that I just spent some time
analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
to something that looks suspiciously like a compiler error. I actually
considered asking around if anyone used same egcs version on Solaris,
but though "nah, probably not"....

Doug, could you 

- recompile eigen.o with -g 
- run it with -d gdb
- see if the crash resembles the one below

...
> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
h=0x70d99f80,
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) p j
$1 = 0
(gdb) p na
$2 = 0
(gdb) p en
$3 = 3
(gdb) p n
$4 = (PTR TO -> ( integer )) 0x70d99fc8
(gdb) p nm
$5 = (PTR TO -> ( integer )) 0x1


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Sat Jul 10 02:53:28 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Fri, 09 Jul 1999 21:53:28 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Fri, 09 Jul 1999 17:13:29 EDT."
 <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
Message-ID: <199907100153.VAA16542@infiniti.ece.cmu.edu>


These are some notes about compilation of R-devel (1999-July-08):

-- Compilation breaks when using gcc due to a bug in the include
files.  gcc is version 2.8.1.  In the files Defn.h, Rsock.c and
sock.c, I had to add "typedef long blkcnt_t" which somehow is not
found in sys/types.h.  This may be specific to my installation or to
this version of gcc.

-- The linking stage breaks because it can't find libz.a and
libncurses.a.  I can't quite figure out why R.X11 would want them.
This appears to be a new feature in configure.  BTW, for the readline 
lib I need -lcurses (note no n).

-- Sorry, I forgot to pass this on: You (Kurt) should try to link with
ld not with gcc.  (This will cover up that I have no clue why -L<path>
wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
-lgcc where path is taken from "gcc --print-libgcc-file-name"

Here is the deal with LDCMD/SHLIBLD as far as I understand it:

-- For the R binary (R.X11) we need:
   == LDCMD: ld (native linker)
   == DLLFLAGS: mainly the export symbol flags
	("-bdynamic -bE:${EXPORTFILE} -bM:SRE") and libraries ("-lc -lm
	-l<fortran libs>", if CC==gcc libgcc.a as well);
	but also the LDFLAGS (see buttom).

-- For shared libraries (like eda.so) we need:
   == SHLIBLD:  ld
   == SHLIBLDFLAGS: again the symbol stuff
	("-bM:SRE -bnoentry -bexpall -bI:${EXPORTFILE}"), maybe libraries

Below is some code that can figure out which libraries to use and
where they are.  "ld -bnobind" does the work, providing us wiht lines
like "i array.o" or "lib /usr/lib/libm.a".  This code would put all
symbols that are in R.X11 (not just all the .o and .a files) into the
export file.  Advantage:  If the shared libs don't need any more
libraries than R, we are set and don't need any libraries (-lm etc) in
SHLIBLDFLAGS.  Disadvantage:  We have to make sure that everything
from the libraries actually makes it into R.  Dunno.

-- warning shell script ahead, avert eyes --
ld -bnobind "$@" |
sed -n -e 's/^i /. /p' -e 's/^lib \(.*\)/\1 \1/p' |
(
        while read a b; do
                echo 1>&2 "$a $b"
                echo "#! $a" >> $mainexp
                $nm $nmopts $b |
                        awk '
$2 == "T" && $1 ~ /^\.[^_]/ { found[substr($1, 2)] = 1 }
$2 == "D" { text[$1] = 1 }
$2 == "B" && $1 ~ /^[^_]/ { bss[$1] = 1 }
END {
        for (x in text)
                if (found[x]) print x;
        for (b in bss)
                print b;
}' |
                        sort | uniq >> $mainexp
        done
)
-- you may now open your eyes again --

My suggestion would be: - fix ldAIX so that it helps finding all the
libs and we can use ld as the linker command.  (I can do this).  -
leave the libs in SHLIBLDFLAGS.  This makes the shared libs a little
bit bigger but we are on the save side.

This is new but may help:  If I want to have my local copy of
readline linked into R, I have to set in my config.site:
CPPFLAGS=-I/home/opt/share/include
LIBS=-lcurses
LDFLAGS=-L/home/opt/arch/lib

I can't put the path to my libreadline.a into LIBS, this would fail.
I need a seperate way of telling to the linker where to find local
libs, which is what LDFLAGS is meant for.  BUT DLLFLAGS does currently
not include the LDFLAGS.

It's still compiling the docs.  make check will have to wait till tomorrow.

  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Sat Jul 10 15:49:14 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Sat, 10 Jul 1999 16:49:14 +0200 (CEST)
Subject: who submitted ratetables to CRAN?
Message-ID: <14215.23914.834446.454221@galadriel.ci.tuwien.ac.at>


Hi,

the ratetables package on CRAN contains no author/maintainer
information whatsoever and I cannot remember who submitted it
... is the creator out there on this list?

The DESCRIPTION file is missing (otherwise I wouldn't have problems
with finding the author) ...

Fritz
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sat Jul 10 19:57:30 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 10 Jul 1999 11:57:30 -0700 (PDT)
Subject: who submitted ratetables to CRAN?
In-Reply-To: <14215.23914.834446.454221@galadriel.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.10.9907101152400.23215-100000@wompom.biostat.washington.edu>

On Sat, 10 Jul 1999, Friedrich Leisch wrote:

> 
> Hi,
> 
> the ratetables package on CRAN contains no author/maintainer
> information whatsoever and I cannot remember who submitted it
> ... is the creator out there on this list?

It was part of survival4, packaged separately because it was too big to
load routinely in the days before data() and autoload(). I would suggest
that survival4 and ratetables disappear when 0.65 is released. Survival5
requires 0.64.1 or better to install in the standard way, and there might
be (unwise) people out there who don't install the dot releases.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Jul 11 08:56:21 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 11 Jul 1999 09:56:21 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907110756.JAA09333@pubhealth.ku.dk>

On 10 Jul 1999, Peter Dalgaard BSA wrote:

> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> > 
> > > ..
> > > R is now configured for sparc-sun-solaris2.6
> > > 
> > >   Source directory:         .
> > >   Installation directory:   /unsup/R-0.64.2
> > >   C compiler:               gcc -g -O2
> > >   FORTRAN compiler:         g77 -O2
> > >   Gnome support:            no
> > > 
> > > $ gcc --version
> > > egcs-2.91.66
> > > $ g77 --version
> > > GNU Fortran 0.5.24-19981002
> > 
> > I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77
> > 
> 
> This is very likely the same trouble that I just spent some time
> analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
> to something that looks suspiciously like a compiler error. I actually
> considered asking around if anyone used same egcs version on Solaris,
> but though "nah, probably not"....

I do (see PLATFORMS) but unfortunately did my pre-tests of 0.64.2
at home, using egcs 1.1. That works fine, so I suspect a compiler bug.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Jul 11 16:31:13 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 11 Jul 1999 17:31:13 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907111531.RAA09876@pubhealth.ku.dk>

On 10 Jul 1999, Peter Dalgaard BSA wrote:

> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> > 
> > > ..
> > > R is now configured for sparc-sun-solaris2.6
> > > 
> > >   Source directory:         .
> > >   Installation directory:   /unsup/R-0.64.2
> > >   C compiler:               gcc -g -O2
> > >   FORTRAN compiler:         g77 -O2

(Why is the default to have -g for C but not Fortran? That has puzzled me
before now. At least for gcc/g77 we could be consistent.)

> > >   Gnome support:            no
> > > 
> > > $ gcc --version
> > > egcs-2.91.66
> > > $ g77 --version
> > > GNU Fortran 0.5.24-19981002
> 
> This is very likely the same trouble that I just spent some time
> analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
> to something that looks suspiciously like a compiler error. I actually
> considered asking around if anyone used same egcs version on Solaris,
> but though "nah, probably not"....

Solaris 2.6
Same gcc and g77 as above (egcs-1.1.2)

I get the same behaviour if eigen.f is compiled with -O2, but not if it
is compiled without optimization, nor if it is compiled with egcs-1.1
(and -O2) nor if it is compiled with SunPro SC4.x f77.

> Doug, could you 
> 
> - recompile eigen.o with -g 
> - run it with -d gdb
> - see if the crash resembles the one below
> 
> ...
> > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> 
> Program received signal SIGSEGV, Segmentation fault.
> hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> h=0x70d99f80,
>     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
>     at eigen.f:2120
> 2120                   RA = RA + H(I,J) * H(J,NA)
> Current language:  auto; currently fortran
> (gdb) p j
> $1 = 0
> (gdb) p na
> $2 = 0
> (gdb) p en
> $3 = 3
> (gdb) p n
> $4 = (PTR TO -> ( integer )) 0x70d99fc8
> (gdb) p nm
> $5 = (PTR TO -> ( integer )) 0x1

Does for me (modulo addresses, of course).

The remedy (as usual) seems to be not to optimize when compiling eigen.f
under egcs-1.1.2.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Jul 12 00:35:27 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Jul 1999 01:35:27 +0200
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Sun, 11 Jul 1999 17:31:13 +0200 (MET DST)"
References: <199907111531.RAA09876@pubhealth.ku.dk>
Message-ID: <x2673qiwu8.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> > Doug, could you 
> > 
> > - recompile eigen.o with -g 
> > - run it with -d gdb
> > - see if the crash resembles the one below
> > 
> > ...
> > > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> > 
> > Program received signal SIGSEGV, Segmentation fault.
> > hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> > h=0x70d99f80,
> >     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
> >     at eigen.f:2120
> > 2120                   RA = RA + H(I,J) * H(J,NA)
> > Current language:  auto; currently fortran
> > (gdb) p j
> > $1 = 0
> > (gdb) p na
> > $2 = 0
> > (gdb) p en
> > $3 = 3
> > (gdb) p n
> > $4 = (PTR TO -> ( integer )) 0x70d99fc8
> > (gdb) p nm
> > $5 = (PTR TO -> ( integer )) 0x1
> 
> Does for me (modulo addresses, of course).

Exactly the same?? (Doug's wasn't...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 12 07:49:34 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 12 Jul 1999 07:49:34 +0100 (BST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <x2673qiwu8.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907120745450.21920-100000@auk.stats>

On 12 Jul 1999, Peter Dalgaard BSA wrote:

> ripley@stats.ox.ac.uk writes:
> 
> > > Doug, could you 
> > > 
> > > - recompile eigen.o with -g 
> > > - run it with -d gdb
> > > - see if the crash resembles the one below
> > > 
> > > ...
> > > > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> > > 
> > > Program received signal SIGSEGV, Segmentation fault.
> > > hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> > > h=0x70d99f80,
> > >     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
> > >     at eigen.f:2120
> > > 2120                   RA = RA + H(I,J) * H(J,NA)
> > > Current language:  auto; currently fortran
> > > (gdb) p j
> > > $1 = 0
> > > (gdb) p na
> > > $2 = 0
> > > (gdb) p en
> > > $3 = 3
> > > (gdb) p n
> > > $4 = (PTR TO -> ( integer )) 0x70d99fc8
> > > (gdb) p nm
> > > $5 = (PTR TO -> ( integer )) 0x1
> > 
> > Does for me (modulo addresses, of course).
> 
> Exactly the same?? (Doug's wasn't...)

Modulo addresses as I said, yes:

> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0xbe0a58, low=0xefffe414, igh=0xefffe410, h=0xbe0a10, 
    wr=0xbe09f8, wi=0xbe09e0, z=0xbe0990, ierr=0xbe0960) at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) p j
$1 = 0
(gdb) p na
$2 = 0
(gdb) p en
$3 = 3
(gdb) p n
$4 = (PTR TO -> ( integer )) 0xbe0a58
(gdb) p nm
$5 = (PTR TO -> ( integer )) 0x1

which looks pretty much the same to me.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 07:53:12 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 08:53:12 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907100153.VAA16542@infiniti.ece.cmu.edu>
References: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
 <199907100153.VAA16542@infiniti.ece.cmu.edu>
Message-ID: <14217.37080.324259.602862@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> These are some notes about compilation of R-devel (1999-July-08):

> -- Compilation breaks when using gcc due to a bug in the include
> files.  gcc is version 2.8.1.  In the files Defn.h, Rsock.c and
> sock.c, I had to add "typedef long blkcnt_t" which somehow is not
> found in sys/types.h.  This may be specific to my installation or to
> this version of gcc.

I cannot confirm this with 2.7.1 (!).  I could add

	AC_CHECK_TYPE(blkcnt_t, long)

to configure.in but I'd want to be sure this is really needed.

> -- The linking stage breaks because it can't find libz.a and
> libncurses.a.  I can't quite figure out why R.X11 would want them.
> This appears to be a new feature in configure.

Very strange.  Are you saying that -lz and -lncurses are detected at
configure time but not found at compilation/link time?  (Could it be
that they are in /home/opt/arch/lib?)  Note (see also below) that you
really should use LIBS and not LDFLAGS for -L and -l stuff.

> BTW, for the readline lib I need -lcurses (note no n).

Need?  Better not ... any of ncurses, termcap or termlib would be o.k.
(See also above.)

> -- Sorry, I forgot to pass this on: You (Kurt) should try to link with
> ld not with gcc.  (This will cover up that I have no clue why -L<path>
> wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
> -lgcc where path is taken from "gcc --print-libgcc-file-name"

As I already wrote, I'd like to.  Problem is we need to know which libs
(such as -lc -lm) to link against ... I'll do something about DLLFLAGS
as suggested.

> Here is the deal with LDCMD/SHLIBLD as far as I understand it:

> -- For the R binary (R.X11) we need:
>    == LDCMD: ld (native linker)
>    == DLLFLAGS: mainly the export symbol flags
> 	("-bdynamic -bE:${EXPORTFILE} -bM:SRE") and libraries ("-lc -lm
> 	-l<fortran libs>", if CC==gcc libgcc.a as well);
> 	but also the LDFLAGS (see buttom).

The Fortran libs are not needed because they are in FLIBS anyway.  Is
`-lc' and maybe `-lgcc' if GCC really enough?

> -- For shared libraries (like eda.so) we need:
>    == SHLIBLD:  ld
>    == SHLIBLDFLAGS: again the symbol stuff
> 	("-bM:SRE -bnoentry -bexpall -bI:${EXPORTFILE}"), maybe libraries

> Below is some code that can figure out which libraries to use and
> where they are.  "ld -bnobind" does the work, providing us wiht lines
> like "i array.o" or "lib /usr/lib/libm.a".  This code would put all
> symbols that are in R.X11 (not just all the .o and .a files) into the
> export file.  Advantage:  If the shared libs don't need any more
> libraries than R, we are set and don't need any libraries (-lm etc) in
> SHLIBLDFLAGS.  Disadvantage:  We have to make sure that everything
> from the libraries actually makes it into R.  Dunno.

> -- warning shell script ahead, avert eyes --
> ld -bnobind "$@" |
> sed -n -e 's/^i /. /p' -e 's/^lib \(.*\)/\1 \1/p' |
> (
>         while read a b; do
>                 echo 1>&2 "$a $b"
>                 echo "#! $a" >> $mainexp
>                 $nm $nmopts $b |
>                         awk '
> $2 == "T" && $1 ~ /^\.[^_]/ { found[substr($1, 2)] = 1 }
> $2 == "D" { text[$1] = 1 }
> $2 == "B" && $1 ~ /^[^_]/ { bss[$1] = 1 }
> END {
>         for (x in text)
>                 if (found[x]) print x;
>         for (b in bss)
>                 print b;
> }' |
>                         sort | uniq >> $mainexp
>         done
> )
> -- you may now open your eyes again --

> My suggestion would be: - fix ldAIX so that it helps finding all the
> libs and we can use ld as the linker command.  (I can do this).  -
> leave the libs in SHLIBLDFLAGS.  This makes the shared libs a little
> bit bigger but we are on the save side.

Hmm ... we need to determine DLLFLAGS and SHLIBLDFLAGS at configure
time.  The above would only work at run time, right?  I can see that
this is not a problem with DLLFLAGS because we could wrap things into
the ldAIX script, but how could we do this with SHLIBLDFLAGS then?

> This is new but may help:  If I want to have my local copy of
> readline linked into R, I have to set in my config.site:
> CPPFLAGS=-I/home/opt/share/include
> LIBS=-lcurses
> LDFLAGS=-L/home/opt/arch/lib

> I can't put the path to my libreadline.a into LIBS, this would fail.
> I need a seperate way of telling to the linker where to find local
> libs, which is what LDFLAGS is meant for.  BUT DLLFLAGS does currently
> not include the LDFLAGS.

Maybe I should add LDFLAGS to the LD-like rules.

Re LIBS, why does this not work (as it should)?

> It's still compiling the docs.  make check will have to wait till
> tomorrow.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Mon Jul 12 09:54:43 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Mon, 12 Jul 1999 20:54:43 +1200
Subject: Gnome interface status report
Message-ID: <19990712205443.A4298@stat1.stat.auckland.ac.nz>

Hi,

First, the Find dialog now works.  Users can search backwards or forwards, from the top,
bottom or current cursor position.  Tomorrow I'm going to add regular expression searches
and the option to wrap searches.

I have also got command line arguments working.  I'd really like someone to test this out,
as I never use the command line arguments and so don't know what people generally use.

I have added support for the R_NSIZE, R_VSIZE, R_HISTFILE, and R_HISTSIZE environment
variables (cut'n'paste from unix/system.c :-).  If there are any other environment
variables lurking in the unix source code that I should know about, please let me know.

Given that things like NSize and VSize can be set via environment variable, command line
argument and GUI preferences, I have arbitrarily come up with a precedence (it's easy to
change if anyone disagrees).  Command line arguments have the highest precedence,
followed by the GUI prefs, followed by the environment variables.  Arguably the 
environment variables should take precedence over the GUI preferences; but I think that
it could be a bit confusing if a user sets the vsize using the preferences dialog, but
the setting never takes effect because of an environment variable in the system profile.
However, the GUI will use any environment variables as the default when creating the
preferences.

I have also split gnome/system.c into several files, because it was becoming to big for
easy navigation.  The files are: system.c, system-unix.c, system-choosefile.c,
system-console.c, and system-showfiles.c.  system.c has main, the argument parsing and
the cleanup stuff.  system-unix.c has all the code that I haven't touched, i.e. that is
(hopefully) identical to the corresponding functions in unix/system.c.

Lyndon

PS: I broke the Gnome graphics today, which is wierd because I didn't touch them.  I'll
figure it out tomorrow.  I've also noticed that several console control keys no longer
work (C-u in particular), which I will need to sort out.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:08:02 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:08:02 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907100153.VAA16542@infiniti.ece.cmu.edu>
References: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
 <199907100153.VAA16542@infiniti.ece.cmu.edu>
Message-ID: <14217.45170.691017.489081@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> These are some notes about compilation of R-devel (1999-July-08):

> -- Sorry, I forgot to pass this on: You (Kurt) should try to link with
> ld not with gcc.  (This will cover up that I have no clue why -L<path>
> wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
> -lgcc where path is taken from "gcc --print-libgcc-file-name"

When I use ld for linking the main, I get

  Could not load program /tmp/fl/build/bin/R.X11 
  Error was: Exec format error

The problem seems to be __start

(ld): resolve
ld: 0711-327 WARNING: Entry point not found: __start
ld: 0711-228 WARNING: Duplicate symbols were found while resolving symbols.
        The following duplicates were found:
 Symbol                    Source-File(Object) OR Import-File{Shared-object}
 ------------------------- -------------------------------------------------
 errno                     {/usr/lib/libc.a[shr.o]}
    ** Duplicate **        main.c(main.o)
 gc_inhibit_torture        memory.c(memory.o)
    ** Duplicate **        main.c(main.o)
RESOLVE: 7982 of 18361 symbols were kept.
RESOLVE: The return code is 4.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 171 symbols.
(ld): er full
ER: There are no unresolved symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.

I can fix this by linking with

	/usr/lib/crt0_r.o -lpthreads

but is this the right thing to do?

-k

PS.  Also, I get

e8725245@fbma:/usr/lib$ strings libxlf90.a | grep start
__start
__start

but

e8725245@fbma:/usr/lib$ nm libxlf90.a  | grep start
nm: libxlf90.a[_xlf_aix42sys.imp]: 0654-203 Specify an XCOFF object module.

What is this?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:22:17 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:22:17 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <199907111531.RAA09876@pubhealth.ku.dk>
References: <199907111531.RAA09876@pubhealth.ku.dk>
Message-ID: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>

>>>>> ripley  writes:

> On 10 Jul 1999, Peter Dalgaard BSA wrote:
>> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
>> > 
>> > > ..
>> > > R is now configured for sparc-sun-solaris2.6
>> > > 
>> > >   Source directory:         .
>> > >   Installation directory:   /unsup/R-0.64.2
>> > >   C compiler:               gcc -g -O2
>> > >   FORTRAN compiler:         g77 -O2

> (Why is the default to have -g for C but not Fortran? That has puzzled me
> before now. At least for gcc/g77 we could be consistent.)

Simply an omission.  Autoconf does almost everything for the C compiler
and basically nothing for the Fortran compiler.  R_PROG_F77 now sets
FFLAGS to "-g -O2" for g77 unless FFLAGS is already set.

> The remedy (as usual) seems to be not to optimize when compiling eigen.f
> under egcs-1.1.2.

Should we special-case this into configure?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:34:49 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:34:49 +0200 (CEST)
Subject: Gnome interface status report
In-Reply-To: <19990712205443.A4298@stat1.stat.auckland.ac.nz>
References: <19990712205443.A4298@stat1.stat.auckland.ac.nz>
Message-ID: <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>

>>>>> Lyndon Drake writes:

> Hi,

> First, the Find dialog now works.  Users can search backwards or
> forwards, from the top, bottom or current cursor position.  Tomorrow
> I'm going to add regular expression searches and the option to wrap
> searches.

> I have also got command line arguments working.  I'd really like
> someone to test this out, as I never use the command line arguments
> and so don't know what people generally use.

> I have added support for the R_NSIZE, R_VSIZE, R_HISTFILE, and
> R_HISTSIZE environment variables (cut'n'paste from unix/system.c :-).
> If there are any other environment variables lurking in the unix
> source code that I should know about, please let me know.

> Given that things like NSize and VSize can be set via environment
> variable, command line argument and GUI preferences, I have
> arbitrarily come up with a precedence (it's easy to change if anyone
> disagrees).  Command line arguments have the highest precedence,
> followed by the GUI prefs, followed by the environment variables.
> Arguably the environment variables should take precedence over the GUI
> preferences; but I think that it could be a bit confusing if a user
> sets the vsize using the preferences dialog, but the setting never
> takes effect because of an environment variable in the system profile.
> However, the GUI will use any environment variables as the default
> when creating the preferences.

> I have also split gnome/system.c into several files, because it was
> becoming to big for easy navigation.  The files are: system.c,
> system-unix.c, system-choosefile.c, system-console.c, and
> system-showfiles.c.  system.c has main, the argument parsing and the
> cleanup stuff.  system-unix.c has all the code that I haven't touched,
> i.e. that is (hopefully) identical to the corresponding functions in
> unix/system.c.

Committed yet?  I don't seem to get these with cvs update ...

Re X11/gnome: Last week I suggested that eventually we might have
something like

	unix/...
	unix/X11	=> libRX11.so
	unix/gnome	=> libRgnome.so
maybe also
	unix/kde
???

and at startup do

	LoadSharedLib("libR$GUI.so")

My impression was that the comments we received were all positive.  So,
maybe we should keep this in mind.

Even without the GUI DLL, the above organization would be a lot cleaner.
How easy would it be to accomplish that?  It seems that we can have

	*sock*
	dynload.c
	hpdlfcn.c

in common, and maybe we only need to take waitforActivity() out from
system.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Jul 12 11:09:40 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 12 Jul 1999 12:09:40 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>
Message-ID: <XFMail.990712120940.plummer@iarc.fr>

On 12-Jul-99 Kurt Hornik wrote:
>>>>>> ripley  writes:
>> The remedy (as usual) seems to be not to optimize when compiling eigen.f
>> under egcs-1.1.2.
> 
> Should we special-case this into configure?

To work around a compiler bug? The obvious disadvantage of this is that
you won't easily find out when the bug is fixed.  There was an egcs
optimization bug on Alpha which is now fixed, but that was never taken
care of by configure.

For Linux on Sparc, I have put the fix in the spec file for the RPM,
where it remains quite visible and can be tested periodically.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 14:56:15 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 15:56:15 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <XFMail.990712120940.plummer@iarc.fr>
References: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>
 <XFMail.990712120940.plummer@iarc.fr>
Message-ID: <14217.62463.450638.675680@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> On 12-Jul-99 Kurt Hornik wrote:
>>>>>>> ripley  writes:
>>> The remedy (as usual) seems to be not to optimize when compiling eigen.f
>>> under egcs-1.1.2.
>> 
>> Should we special-case this into configure?

> To work around a compiler bug? The obvious disadvantage of this is
> that you won't easily find out when the bug is fixed.  There was an
> egcs optimization bug on Alpha which is now fixed, but that was never
> taken care of by configure.

O.k., won't change configure then ...

> For Linux on Sparc, I have put the fix in the spec file for the RPM,
> where it remains quite visible and can be tested periodically.

:-)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Mon Jul 12 21:58:54 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Tue, 13 Jul 1999 08:58:54 +1200
Subject: Gnome interface status report
In-Reply-To: <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>; from Kurt Hornik on Mon, Jul 12, 1999 at 11:34:49AM +0200
References: <19990712205443.A4298@stat1.stat.auckland.ac.nz> <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>
Message-ID: <19990713085854.A25357@r.stat.auckland.ac.nz>

On Mon, Jul 12, 1999 at 11:34:49AM +0200, Kurt Hornik wrote:
> Committed yet?  I don't seem to get these with cvs update ...
> 

Oops.  Done now.

> Re X11/gnome: Last week I suggested that eventually we might have
> something like
> 
> 	unix/...
> 	unix/X11	=> libRX11.so
> 	unix/gnome	=> libRgnome.so
> maybe also
> 	unix/kde
> ???
> 
> and at startup do
> 
> 	LoadSharedLib("libR$GUI.so")
> 
> My impression was that the comments we received were all positive.  So,
> maybe we should keep this in mind.
> 
> Even without the GUI DLL, the above organization would be a lot cleaner.
> How easy would it be to accomplish that?  It seems that we can have
> 
> 	*sock*
> 	dynload.c
> 	hpdlfcn.c
> 
> in common, and maybe we only need to take waitforActivity() out from
> system.c?
> 

I like the idea of organising the files this way.  The shared library thing
could be a bit tricky, but I guess it could be done.

devPS.c 
devPicTeX.c 
dynload.c 
edit.c 
Rsock.c 
sock.c 

are already used directly from the unix directory by the Gnome interface.
We could easily split up system.c into a couple of files.  This would give
us:

unix
|-system.c, devPS.c, ..., sock.c
|-X11
| |-system-X11.c, edit.c, devX11.c, ...
|-gnome
| |-system-gnome.c, edit.c, devGnome.c, ...

Doing this as a source split (rather than turning things into shared
libraries) would mean putting main into system-X11.c and system-gnome.c,
but would make maintaining the source for the stuff that's share between
both interfaces much simpler.

Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@cmis.csiro.au  Tue Jul 13 06:13:46 1999
From: Bill.Venables@cmis.csiro.au (Bill.Venables@cmis.csiro.au)
Date: Tue, 13 Jul 1999 07:13:46 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907130513.HAA16802@pubhealth.ku.dk>

Peter,

There is a clear and simple bug in glm() that I have noticed in
0.64.2 (Windows and Unix) but may have been present in earlier
versions.

The function starts as follows:

> glm
function (formula, family = gaussian, data = list(), weights = NULL, 
    subset = NULL, na.action = na.fail, start = NULL, offset = NULL, 
    control = glm.control(...), model = TRUE, method = "glm.fit", 
    x = FALSE, y = TRUE, contrasts = NULL, ...) 
{
    call <- match.call(expand.dots = FALSE)	### <<<<----------------------------
    ## family
    if (is.character(family)) 
        family <- get(family)
    if (is.function(family)) 
        family <- family()
    ## extract x, y, etc from the model formula and frame
    if (is.null(family$family)) {
        print(family)
        stop("`family' not recognized")
    }
    mt <- terms(formula, data = data)
    if (missing(data)) 
        data <- sys.frame(sys.parent())
    mf <- match.call()				### <<<<----------------------------
    mf$family <- mf$start <- mf$control <- mf$maxit <- NULL
    mf$model <- mf$method <- mf$x <- mf$y <- mf$contrasts <- NULL
    mf$... <- NULL

######

The two marked lines should clearly be

    call <- match.call()

and

    mf <- match.call(expand.dots = FALSE)

The error in the first line can case problems with update() (I
suspect) but the error in the second line does not allow isolated
control arguments (like trace = T) to appear on the main call as
they get passed on to the call to model.frame, causing
pandemonium.  As a confirmation of the second change above,
unless you do have (expand.dots = FALSE) the last line quoted
above has no effect.

Regards,
Bill Venables.

-- 
-----------------------------------------------------------------
Bill Venables, Statistician, CMIS Environmetrics Project.

Physical address:                            Postal address:
CSIRO Marine Laboratories,                   PO Box 120,       
233 Middle St, Cleveland, Queensland         Cleveland, Qld, 4163
AUSTRALIA                                    AUSTRALIA

Telephone: +61 7 3826 7251     Email: Bill.Venables@cmis.csiro.au     
      Fax: +61 7 3826 7304

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:09:43 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:09:43 +0200 (CEST)
Subject: 0.65/AIX
Message-ID: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>

Martin:

With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I cannot get
artihmetic.c to compile---it dies because of undefined acosh etc.

Is this specific of the system that I have access to?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:12:16 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:12:16 +0200 (CEST)
Subject: 0.65/HPUX
Message-ID: <14218.55488.832244.223924@aragorn.ci.tuwien.ac.at>

I am trying to compile 0.65 on HPUX using c89/f77/make.  This dies with

        c89 -I. -I../include -I../../src/include   -DHAVE_CONFIG_H  -g -c Rsock.c -o Rsock.o
cc: "Rsock.c", line 135: error 1588: "WNOHANG" undefined.
cc: "Rsock.c", line 142: error 1000: Unexpected symbol: "pid".
cc: "Rsock.c", line 142: error 1588: "pid_t" undefined.
cc: "Rsock.c", line 144: error 1574: Unknown size for "sa".
cc: "Rsock.c", line 145: error 1530: Undefined struct or union.
cc: "Rsock.c", line 146: error 1530: Undefined struct or union.
cc: "Rsock.c", line 147: error 1588: "SIGCHLD" undefined.
cc: "Rsock.c", line 150: error 1588: "pid" undefined.
cc: "Rsock.c", line 151: error 1527: Incompatible types in cast: Must cast from scalar to scalar or to void type.
*** Error exit code 1

although WNOHANG is defined in sys/wait.h which gets included by
Rsock.c.  Does anyone have an idea what is going on?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 13 07:37:46 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 13 Jul 1999 08:37:46 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907130637.IAA17100@pubhealth.ku.dk>

On Tue, 13 Jul 1999 Bill.Venables@cmis.csiro.au wrote:

> Peter,

[Peter only fixes most of the bugs....]

> There is a clear and simple bug in glm() that I have noticed in
> 0.64.2 (Windows and Unix) but may have been present in earlier
> versions.

It has a long history: the expand.dots = FALSE was introduced in 0.63, 
but the second call has been wrong for longer.

> The two marked lines should clearly be
> 
>     call <- match.call()
> 
> and
> 
>     mf <- match.call(expand.dots = FALSE)

as in S.

I've committed this for 0.65.0.

We have had various discussions about glm: it is proving very hard to
maintain (that is, find the bugs) and is irritatingly different from S.
One option is to reimplement it.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:52:01 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:52:01 +0200 (CEST)
Subject: 0.65/AIX
Message-ID: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>

Another problem we encounter is that configure finds installbsd as a
usable install program which does not work correctly.  Has anyone else
experienced this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 10:53:54 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 11:53:54 +0200
Subject: 0.65/AIX
In-Reply-To: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:09:43 +0200 (CEST))
References: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>
Message-ID: <199907130953.LAA14607@sophie.ethz.ch>


    KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
    KH> cannot get artihmetic.c to compile---it dies because of undefined
    KH> acosh etc.

Compilation dies ??    

    KH> Is this specific of the system that I have access to?

Oh dear... the infinite story continues...

The AIX system I have acess to {uname -a ==> AIX percol 2 4 000333104600}
is fine here..
As a matter of fact, I can see in  /usr/include/math.h  that
acosh() is only declared when -D_XOPEN_SOURCE_EXTENDED(=1) !!!

this is what worked here

gcc -I. -I../include -I../../src/include  -DHAVE_CONFIG_H  -g -O2 -D_XOPEN_SOURCE_EXTENDED=1 -c arithmetic.c -o arithmetic.o

a few days ago (I kept the full ./configure; make  shell transcript).

---
I'm trying again with the July 12 snapshot..
+ my line 
======================================================
CFLAGS="-g -O2 -D_XOPEN_SOURCE_EXTENDED"
======================================================
in config.site
((to which configure now adds `` -mno-fp-in-toc ''))


Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 10:59:17 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 11:59:17 +0200
Subject: 0.65/AIX
In-Reply-To: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:52:01 +0200 (CEST))
References: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
Message-ID: <199907130959.LAA14609@sophie.ethz.ch>


    KH> Another problem we encounter is that configure finds installbsd as
    KH> a usable install program which does not work correctly.  Has anyone
    KH> else experienced this?

Well, for me configure gives (as its 2nd output line)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
checking for a BSD compatible install... /usr/bin/installbsd -c
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

But then, I install in the build directory and this may be the reason that
I don't see problems afterwards. 

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 13:40:08 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 14:40:08 +0200
Subject: 0.65/AIX  -D_XOPEN_SOURCE_EXTENDED
In-Reply-To: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:09:43 +0200 (CEST))
References: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>
Message-ID: <199907131240.OAA14751@sophie.ethz.ch>

>>>>> On Tue, 13 Jul 1999 08:09:43 +0200 (CEST), Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> said:

    KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
    KH> cannot get artihmetic.c to compile---it dies because of undefined
    KH> acosh etc.

    KH> Is this specific of the system that I have access to?

It seems, to some extent.
make went all smooth with the additional -D_XOPEN_SOURCE_EXTENDED
CFLAGS.

My few tests (graphic, dyn.load, Inf,...) completed well
including the  "make check" part till it comes to testing the
"specifics" in ./tests/ which dies when it tries to remake package `eda',
the problem being the already reported Problem when cp'ing libraries that
are already there..
    cp: ../../../../library/lqs/libs/lqs.so: Text file busy
[[that problem is being fixed as well..]]

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 13:52:11 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 14:52:11 +0200
Subject: Solution: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
In-Reply-To: <x2oghlxzix.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 09 Jul 1999 23:51:34 +0200)
References: <199907091605.SAA12966@sophie.ethz.ch> <x2oghlxzix.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907131252.OAA14759@sophie.ethz.ch>

>>>>> On 09 Jul 1999 23:51, Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> said:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> I've (remote) access to a new Linux system which has some flavor of Rehat
    >> installed.
    >> 
    >> Compiling R-0.64.2 fails -- at the end when  eda.so should be made.
    .....> 
    >> mkellers{maechler}425% gcc --version
    >> egcs-2.91.66
    >> mkellers{maechler}426% ld --version
    >> GNU ld 2.9.1
    >> Copyright 1997 Free Software Foundation, Inc.
    >> This program is free software; you may redistribute it under the terms of
    >> the GNU General Public License.  This program has absolutely no warranty.
    >> Supported emulations:
    >> elf_i386
    >> i386linux
    >> 
    >> ------------------
    >> 
    >> I'm guessing that the  gcc/ld/library combination hasn't been 
    >> installed/configured properly... 
    >> ???

    PD> Or hardware. I've been running that combination for a couple of
    PD> months on my home machine and since yesterday on the work machine,
    PD> including a compile from scratch of the official 0.64.2 as late as
    PD> today (the old binary broke due to the __setfpucw silliness).

    PD> But first check the install with 

    PD> rpm -V egcs binutils 

which showed that everything looked okay [by giving no output].

Peter, your guess with "hardware" was actually quite close :

Considering using some Linux clients with Solaris file- (and other)
servers, we still have user home directories (auto)mounted from the Solaris
File-server.
When I work in such a file-system, I get funny compiler and linker errors
such as above,
also, e.g. Splus 5.1 for Linux sometimes (not always!) can't find the
objects that I create -- when they reside on the mounted file system...

Alas, so much for system integration...

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 13 14:07:51 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 13 Jul 1999 09:07:51 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "Tue, 13 Jul 1999 11:53:54 EDT."
 <199907130953.LAA14607@sophie.ethz.ch>
Message-ID: <199907131307.JAA29236@infiniti.ece.cmu.edu>


"Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
KH> cannot get artihmetic.c to compile---it dies because of undefined
KH> acosh etc.

Martin> Compilation dies ??    

../../../src/main/arithmetic.c: In function `do_math1':
../../../src/main/arithmetic.c:868: `acosh' undeclared (first use in this function)

KH> Is this specific of the system that I have access to?

Martin> The AIX system I have acess to {uname -a ==> AIX percol 2 4 000333104600}
Martin> is fine here..

Uh, I'm afraid it's not the AIX version, it may be gcc vs. cc
Simply try (I compile in a separate build directory)
cc -E -I. -I../include -I../../../src/include -DHAVE_CONFIG_H  -g -O2 \
-D_XOPEN_SOURCE_EXTENDED=1 ../../../src/main/arithmetic.c | grep \
acosh
which should return "extern     double   acosh(double);"

Three cases, two compilers on an AIX 4.2 box:

-U_XOPEN_SOURCE_EXTENDED - gcc (2.8.1) and cc ok
-D_XOPEN_SOURCE_EXTENDED=1 - gcc fails (no declaration of acosh), cc ok
-D_XOPEN_SOURCE_EXTENDED=2 - gcc and cc ok, both with warnings about
					 redefining _XOPEN_SOURCE_EXTENDED

Sorry, but why do you need _XOPEN_SOURCE_EXTENDED to be defined?  And
why does -D_XOPEN_SOURCE_EXTENDED=2 work, albeit noisely?

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue Jul 13 16:21:34 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 13 Jul 1999 08:21:34 -0700 (PDT)
Subject: 0.65/AIX
In-Reply-To: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>

On Tue, 13 Jul 1999, Kurt Hornik wrote:

> Another problem we encounter is that configure finds installbsd as a
> usable install program which does not work correctly.  Has anyone else
> experienced this?
> 

No, but I had this problem with the Stata install script. configure
doesn't seem very fussy about what counts as an install program.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:02:41 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:02:41 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <199907131333.PAA14854@sophie.ethz.ch>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
Message-ID: <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

ToV> Sorry, but why do you need _XOPEN_SOURCE_EXTENDED to be defined?  And
ToV> why does -D_XOPEN_SOURCE_EXTENDED=2 work, albeit noisely?

> This is used to be the only flag (from the many I tried about a year ago) 
> for which
>      1/0  
>      is.finite(1)
>      atanh(1)
> worked .

Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
Now, this gives

> 1/0 + 1/0# Inf
[1]INF
> 1/0 - 1/0# NaN
[1]NaNQ

which is only sort of o.k.???

For the time being, I'll commit this version ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:09:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:09:54 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>
References: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
 <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>
Message-ID: <14219.25810.198731.567682@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 13 Jul 1999, Kurt Hornik wrote:
>> Another problem we encounter is that configure finds installbsd as a
>> usable install program which does not work correctly.  Has anyone else
>> experienced this?
>> 

> No, but I had this problem with the Stata install script. configure
> doesn't seem very fussy about what counts as an install program.

Hmm.  Guess I should hardwire the fix then into configure (if aix and
installbsd then use install-sh).

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 13 17:23:36 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 13 Jul 1999 18:23:36 +0200
Subject: 0.65/AIX
In-Reply-To: Kurt Hornik's message of "Tue, 13 Jul 1999 18:02:41 +0200 (CEST)"
References: <199907131307.JAA29236@infiniti.ece.cmu.edu> 	<199907131333.PAA14854@sophie.ethz.ch> <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
Message-ID: <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
> Now, this gives
> 
> > 1/0 + 1/0# Inf
> [1]INF
> > 1/0 - 1/0# NaN
> [1]NaNQ
> 
> which is only sort of o.k.???

No! ...which is patently WRONG. When this kind of printout, it shows
that the print routines in R are not able to recognize Inf and NaN
(using R_FINITE) which implies that they aren't properly recognized
anywhere else.

> For the time being, I'll commit this version ...

Not for long, I hope...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:36:57 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:36:57 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
 <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
 <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
Message-ID: <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
>> Now, this gives
>> 
>> > 1/0 + 1/0# Inf
>> [1]INF
>> > 1/0 - 1/0# NaN
>> [1]NaNQ
>> 
>> which is only sort of o.k.???

> No! ...which is patently WRONG. When this kind of printout, it shows
> that the print routines in R are not able to recognize Inf and NaN
> (using R_FINITE) which implies that they aren't properly recognized
> anywhere else.

>> For the time being, I'll commit this version ...

> Not for long, I hope...

Hmm.

On the system I have access to, I can compile only with

	-D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
or
	-D_ALL_SOURCE

In either case, we get the above.

I will hence use ALL_SOURCE for the time being.

Note that

> 1/0 - 1/0# NaN
[1]NaNQ
> is.nan(1/0 - 1/0)
[1] TRUE

so what is really going on here???

-k


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 13 23:12:48 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Jul 1999 00:12:48 +0200
Subject: 0.65/AIX
In-Reply-To: Kurt Hornik's message of "Tue, 13 Jul 1999 18:36:57 +0200 (CEST)"
References: <199907131307.JAA29236@infiniti.ece.cmu.edu> 	<199907131333.PAA14854@sophie.ethz.ch> 	<14219.25377.308702.802943@aragorn.ci.tuwien.ac.at> 	<x2vhbozfg7.fsf@blueberry.kubism.ku.dk> <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>
Message-ID: <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> On the system I have access to, I can compile only with
> 
> 	-D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
> or
> 	-D_ALL_SOURCE
> 
> In either case, we get the above.
> 
> I will hence use ALL_SOURCE for the time being.
> 
> Note that
> 
> > 1/0 - 1/0# NaN
> [1]NaNQ
> > is.nan(1/0 - 1/0)
> [1] TRUE
> 
> so what is really going on here???

Double "hmmmm"....

Can you run this under gdb? If so, could you set a breakpoint in
EncodeReal and step through it? 

That'll be (roughly)

R -d gdb
(gdb) run
^C
(gdb) break EncodeReal
(gdb) continue
> 1/0
(gdb) next
<etc.>

I bet it never enters the "if (!R_FINITE(x))" branch as it should.
This could happen if HAVE_FINITE and IEEE_754 are both undefined in
Arith.h, or if finite(x) doesn't work in the IEEE way.

>From what Martin has been telling us, AIX is using IEEE format numbers
and arithmetic anyhow, so it should be fairly easy to fudge a better
R_FINITE (and ISNAN too). I think we went through some of that last
time we had R_FINITE/ISNAN and friends on the board, didn't we?
Something pretty close to the following should work:

#define R_FINITE(x) ({double y = x; \
	 *((int *) &y) & 0x7ff00000 != 0x7ff00000})

#define ISNAN(x) ({double y = x; \
	*((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
	(*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

Of course, that kind of code is pretty architecture dependent, etc...
Perhaps one should first check what the status of IEEE macros in AIX
really is.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From 320098218774-0001@t-online.de  Wed Jul 14 01:01:47 1999
From: 320098218774-0001@t-online.de (320098218774-0001@t-online.de)
Date: Wed, 14 Jul 1999 02:01:47 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907140001.CAA25350@pubhealth.ku.dk>

ripley@stats.ox.ac.uk schrieb:
> On Tue, 13 Jul 1999 Bill.Venables@cmis.csiro.au wrote:
>
> > Peter,
>
> [Peter only fixes most of the bugs....]
>
> > There is a clear and simple bug in glm() that I have noticed in
> > 0.64.2 (Windows and Unix) but may have been present in earlier
> > versions.
>
> It has a long history: the expand.dots = FALSE was introduced in 0.63, 
> but the second call has been wrong for longer.
>
> > The two marked lines should clearly be
> > 
> >     call <- match.call()
> > 
> > and
> > 
> >     mf <- match.call(expand.dots = FALSE)
>
> as in S.
>
> I've committed this for 0.65.0.
>
> We have had various discussions about glm: it is proving very hard to
> maintain (that is, find the bugs) and is irritatingly different from S.
> One option is to reimplement it.

My opinion as a simple user ... reimplement glm is a very good idea!. Just
for the "cosmetic" point of view: please, take out all of these silly *`s 
indicating significant levels in the output. Also, if somebody needs the "null 
deviance" make it as optional, and not in the stardard output.

Best regards,
Pablo.



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 08:24:32 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 09:24:32 +0200
Subject: 0.65/HPUX
In-Reply-To: <9907131048.AA22896@nokomis.stat.umn.edu>
References: <14218.55488.832244.223924@aragorn.ci.tuwien.ac.at>
 <9907131048.AA22896@nokomis.stat.umn.edu>
Message-ID: <199907140724.JAA19840@aragorn.ci.tuwien.ac.at>

>>>>> Luke Tierney writes:

> On HPUX a lot of stuff like this is only available if you set the
> appropriate define, like HPUX_SOURCE_ or POSIX_SOURCE_.  Unless that
> is set in an include file, I suspect it is needed with the c89 command
> line.

Thanks.  Seems that c89 needs -D_HPUX_SOURCE so I now define this via
Platform.h.  We also seem to need -L/lib/pa1.1 in LIBS.

The problem I now seem to have is that alloca is not found when loading
the main binary ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 13:40:52 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 14:40:52 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
Message-ID: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>

I've made some more changes to configure/make which still don't solve
everything but I think I have to stop for now.

Status AIX:

* I can compile with gcc/f77/make.
* AIX make check fails (cannot build base-Ex.R).
* GNU make check fails in the contour example.
* Plotting is broken (tickmarks go all the way thru).
* IEEE fp stuff is strange (will look into this).
* I still need f77 for linking.  Using ld with the suggested flags gives
  a binary with `exec format error'.  The problem seems to be with an
  unreferenced __start.
* The basic add-ons seem to work, though.

Status HPUX:

* I can compile the main binary with c89/f77/make.
* Compilation fails in eda (syntax error in etc/Makeconf).  The problem
  disappears when the SHLIB target is commented ... but then building
  the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
* QUESTION: what about src/unix/hpdlfcn.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 15:56:23 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 16:56:23 +0200 (CEST)
Subject: docs: topic && availability
Message-ID: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>

I think that users quite often want to answers to questions like ``Is
there something to do FOO in R?'', where FOO might e.g. be ``isotonic
regression''.  The answer should be something like ``you can use BAR in
package BAZ, or ...''.

For this, full text search is not the right approach and the keywords
are not enough.  We could maybe search dedicated fields (like \title),
but I think what we really want is something like an \index{} entry.
(I am not sure whether we want concept/variable/function/... indices a
la Texinfo.)

Access/retrieval could even happen on the command line via something
like
	help(topic = "FOO")

However, I am not sure what the right back-end is.  We definitely do not
want to confine the search to the loaded packages.  But even the locally
available ones are not enough.  On the other hand, I don't think doing
all topic lookups via CRAN is the right thing, either.  So maybe

	help(topic = "FOO")

would use all topic indices in R_LIBS but there could be a message
indicating that one can also use CRAN for lookup via WWW.

Opinions?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 14 16:07:25 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 14 Jul 1999 17:07:25 +0200
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 14 Jul 1999 14:40:52 +0200 (CEST))
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
Message-ID: <199907141507.RAA27266@sophie.ethz.ch>


    KH> I've made some more changes to configure/make which still don't solve
    KH> everything but I think I have to stop for now.

too bad (the "stop for now").

    KH> Status AIX:

    KH> * I can compile with gcc/f77/make.
    KH> * AIX make check fails (cannot build base-Ex.R).
    KH> * GNU make check fails in the contour example.
    KH> * Plotting is broken (tickmarks go all the way thru).

This is exactly the typical result of the next item :
In my experience, whenever  is.finite(), finite()  1/0, 0/0 etc weren't ok
(and as Peter emphasized, they are *not at all* as long as you get
 "INF" and "NaNQ"  instead of "Inf" and "NaN")
then the graphics show the above symptome.

The way that I found that -D_XOPEN_SOURCE_EXTENDED
will save me, was by looking into /usr/include/math.h

It seems that you (and Thomas Vogels !) have a different one, than, even
though Thomas said that he had AIX 4.2 as well?
This is what I have :

    $ uname -a
    AIX percol 2 4 000333104600

    $ ls -l /usr/include/math.h
    -r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

What versions of AIX 4.2 are around?


    KH> * IEEE fp stuff is strange (will look into this).
    KH> * I still need f77 for linking.  Using ld with the suggested flags gives
    KH> a binary with `exec format error'.  The problem seems to be with an
    KH> unreferenced __start.
    KH> * The basic add-ons seem to work, though.


    KH> Status HPUX:

    KH> * I can compile the main binary with c89/f77/make.
    KH> * Compilation fails in eda (syntax error in etc/Makeconf).  The problem
    KH> disappears when the SHLIB target is commented ... but then building
    KH> the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
				       ~~~~~~~~~
				       sure about that ??

    KH> * QUESTION: what about src/unix/hpdlfcn.c?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 16:18:46 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 17:18:46 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <199907141507.RAA27266@sophie.ethz.ch>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
Message-ID: <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

KH> I've made some more changes to configure/make which still don't solve
KH> everything but I think I have to stop for now.

> too bad (the "stop for now").

(Well, the point is that the experimental approach is very inefficient.
We need someone who really knows about these platforms.)

KH> Status AIX:

KH> * I can compile with gcc/f77/make.
KH> * AIX make check fails (cannot build base-Ex.R).
KH> * GNU make check fails in the contour example.
KH> * Plotting is broken (tickmarks go all the way thru).

> This is exactly the typical result of the next item : In my
> experience, whenever is.finite(), finite() 1/0, 0/0 etc weren't ok
> (and as Peter emphasized, they are *not at all* as long as you get
> "INF" and "NaNQ" instead of "Inf" and "NaN") then the graphics show
> the above symptome.

Hmm.  Perhaps we can nail that down.  My impression was that the finite
et al tests I tried were o.k.  Do you know what exactly causes the
plotting problem?

> The way that I found that -D_XOPEN_SOURCE_EXTENDED
> will save me, was by looking into /usr/include/math.h

> It seems that you (and Thomas Vogels !) have a different one, than,
> even though Thomas said that he had AIX 4.2 as well?  This is what I
> have :

>     $ uname -a
>     AIX percol 2 4 000333104600

>     $ ls -l /usr/include/math.h
>     -r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

> What versions of AIX 4.2 are around?

I have

e8725245@fbma:/home2/e8725245$ uname -a
AIX fbma 2 4 000147825700
e8725245@fbma:/home2/e8725245$ ls -l /usr/include/math.h 
-r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

Also,

e8725245@fbma:/home2/e8725245$ ls -l /usr/bin/f77 
-rwxr-xr-x   3 bin      bin        99453 May  7 1998  /usr/bin/f77*
e8725245@fbma:/home2/e8725245$ gcc --version
2.7.2
e8725245@fbma:/home2/e8725245$ gmake --version
GNU Make version 3.77, by Richard Stallman and Roland McGrath.

KH> * IEEE fp stuff is strange (will look into this).
KH> * I still need f77 for linking.  Using ld with the suggested flags gives
KH> a binary with `exec format error'.  The problem seems to be with an
KH> unreferenced __start.
KH> * The basic add-ons seem to work, though.


KH> Status HPUX:

KH> * I can compile the main binary with c89/f77/make.
KH> * Compilation fails in eda (syntax error in etc/Makeconf).  The problem
KH> disappears when the SHLIB target is commented ... but then building
KH> the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
> 				       ~~~~~~~~~
> 				       sure about that ??

3-52-5 configure has

    *hpux*)
      FOREIGN_FILE="sysvr4-foreign.h"
      AC_DEFINE(HAVE_FOREIGN)
      AC_DEFINE(HAVE_DLOPEN)
      UCFLAGS="$UCFLAGS -Imachines/hpux/dlfcn"
      EXTRAOBJS="$EXTRAOBJS dlfcn.o"
      link_sources="$link_sources machines/hpux/dlfcn/dlfcn.c"
      link_targets="$link_targets dlfcn.c"
      EXTRALIBS="$EXTRALIBS -ldld"
      ULDFLAGS="$ULDFLAGS -Wl,-E"
      foreign=1


KH> * QUESTION: what about src/unix/hpdlfcn.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 14 16:41:50 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 14 Jul 1999 17:41:50 +0200
Subject: tseries package -- license
Message-ID: <199907141541.RAA27707@sophie.ethz.ch>


Thanks a lot for "tseries"!

The new (0.1-2) version of the tseries package
contains the following in ./README :

>> Author(s): A. Trapletti <A.Trapletti@ci.tuwien.ac.at>, 
>>         B. LeBaron ("./src/bdstest.c"),
>>         K. Krischer, and T. M. Kruel ("./src/muin2ser.f", 
>>         "./misc/mutinfo-1.21b.tar.gz")

>> License: "./src/muin2ser.f", "./misc/mutinfo-1.21b.tar.gz" are 
>>         free for non-commercial purposes. "./src/bdstest.c" is 
>>         free. The remainder is covered by GPL version 2 or 
>>         newer; see file COPYING

I think the ``free for non-commercial purposes''
is not good enough for us.

Could you try to contact K.Krischer und T.M.Kruel and ask if they would
release their software under GPL (or something similar)?

If not, it may be worth to separate your "tseries" package into a
free part (that can be put onto CD-ROMs !),
and a non-free part (that CAN'T be put onto CD-ROMs) for the "muin/mutinfo"
stuff.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 14 20:05:25 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 14 Jul 1999 15:05:25 -0400
Subject: docs: topic && availability
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
Message-ID: <378CDF72.5499BD27@bank-banque-canada.ca>

I've often thought that some sort of synonym dictionary would be useful,
especially for new users. That is, give the name of some procedure, say
in Matlab, SAS or SPSS, or even a statistical term, and get information
about possible procedures to consider in S/R (and the other way around
too). I think this might be much more broadly useful than just for R, so
I wouldn't tie it too closely to R help() or CRAN.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From s-harker@adfa.edu.au  Thu Jul 15 03:28:02 1999
From: s-harker@adfa.edu.au (s-harker@adfa.edu.au)
Date: Thu, 15 Jul 1999 04:28:02 +0200 (MET DST)
Subject: pch and mkh bug PR#225
Message-ID: <199907150228.EAA02869@pubhealth.ku.dk>

I am sorry about the problem caused by my first attempt at reporting a
bug.  This is a followup to my report PR#225, hopefully being more
useful.  By not I have a better understanding of the problems being
reported.

I wish to report one bug relating to plot character and to mention two
other possible bugs (these may relate to differences between R and S)
I have noticed with R.  We have recently installed R and I am
converting some scripts I had previously used with a very old version
of S (not Splus).  The R version information is:

platform   sparc-sun-solaris2.5.1
arch       sparc                 
os         solaris2.5.1          
system     sparc, solaris2.5.1   
status                           
status.rev 0                     
major      0                     
minor      64.2                  
year       1999                  
month      July                  
day        3                     
language   R  

In the following I will be quoting some extracts from R A Becker, J M
Chambers and A R Wilks _The New S Language_, Wadsworth & Brooks/Cole
1988, isbn 0-534-09192-X.  We have a copy of this book since, although
our departmental server did not update from S to Splus, the campus
server did.  I am using this as an authority to report some of the
following as being bugs.

(1)  First the boxes drawn using `points()' via the following example

Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15),type="n")
points(X,Y,pch=0,mkh=0.02)
points(X,Y,pch=0,mkh=1.0)
points(X,Y-1,pch=0,cex=4.0)
points(X,Y-1,pch=0,cex=0.02)

are of a size that indicated that the mkh value is being ignored (the
upper set of boxes).  This can be fixed by using cex (the lower set of
boxes).  However, the S manual states that `mkh' gives the height in
inches of mark symbols drawn when `pch' is given as a number.  This
comment is also made in the help for the `par' function within R.  This
would appear to be a bug, using `cex' is correct only when giving a
character.

(2)  The plotting of axis labels on an axis becomes confused if the
`at' vector is descending.  For exaample, consider the following:

labels <- c("A", "B", "C", "D")
Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15))
axis(side=4,at=Y,labels=labels)

According to the S manual `label[i]' is plotted at coordinate `at[i]'.
Although S (or R) plot the vector in ascending order this still worked
(in old S, anyway), it may have been a feature.  However, R appears to
sort `at[i]' but not do a corresponding sort on label[i].  The R help
does not make the statement about plotting `label[i]' at coordinate
`at[i]', so this may be a difference between S and R.  It can be
overcome by appropriate pre-sorting of the two vectors.

(3)  The use of `mtext' only works for a string, not for a vector of
strings.  For example, the following commands.

labels <- c("A", "B", "C", "D")
Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15))
mtext(text=labels, side=4, line=0.5, at=Y)

plots only the first of the elements of `labels'.  Again, this may
reflect a difference between S and R.  The S manual states that `text'
is a character vector to be plotted and `at' is an optional vector of
positions.  However, the R help states that `text' is a character
string and `at' gives the location in user coordiates.  This can be
overcome by plotting `labels[i]' at `at[i]' within a loop.

-- 
Stephen Harker                                        s-harker@adfa.edu.au
School of Physics               Baloney Baffles brains: Eric Frank Russell
University College                http://www.adfa.edu.au/physics/s-harker/
UNSW, ADFA

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 08:14:46 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 15 Jul 1999 09:14:46 +0200 (MET DST)
Subject: which() does not handle NAs in named vectors. (PR#226)
Message-ID: <199907150714.JAA03804@pubhealth.ku.dk>

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

-- It is unclear to me that the handling of NAs is desirable, and it
   has problems with names:

> z <- c(T,T,NA,F,T)
> names(z) <- letters[1:5]
> which(z)
Error: names attribute must be the same length as the vector
      
(Why do the vector and its names have different subscripts?  And while
you are correcting this,

Arguments:

       x: a logical vector or array.  `NA's are allowed an
          omitted.
  
has a typo, and the logic can be simplified: see below.)

On Thu, 15 Jul 1999, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
>     BDR> On Wed, 14 Jul 1999, Friedrich Leisch wrote:
>     >> >>>>> On Wed, 14 Jul 1999 04:09:21, >>>>> Peter B Mandeville (PBM)
>     >> wrote:
>     >> 
>     PBM> I have a vector Pes with 600 elements some of which are NA's. How
>     PBM> can I form a vector of the indices of the NA's.
>     >>
>     PBM> for(i in 1:600) if(is.na(Pes[i])) print(i)
>     >>
>     PBM> prints the indices of the NA's but I can't figure out how to put
>     PBM> the results in a vector.
>     >>  try this:
>     >> 
>     >> x <- (1:length(Pes))[is.na(Pes)]
> 
>     BDR> Tip: that sort of thing often fails for a length 0 vector. The
>     BDR> `approved' spell is
> 
>     BDR> seq(along=Pes)[is.na(Pes)]
> 
>     BDR> In this case it does not matter as the subscript is of length 0,
>     BDR> but it has floored enough library/package writers to be worth
>     BDR> thinking about.
> 
> Good teaching about seq() vs.  1:n 
> 
> However, the solution I gave 
> 
>      which(is.na(Pes))
> 
> is the one I stilly really recommend; 
> it does deal with 0-length objects, and it keeps names when there are some,
> and it has an `arr.ind = FALSE' argument to return array indices instead of
> vector indices when so desired.

Yes, but

-- It is not in S (so causing difficulty in porting from R to S)
-- It looks a relatively expensive operation.
-- Internally which could be simplified by using seq(along=) as it
   is a wrapper for this construct, but actually the separate
   handling of n == 0 is unnecessary (as logic & !is.na(logic) will have
   length zero.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Thu Jul 15 09:04:53 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Thu, 15 Jul 1999 08:04:53 +0000
Subject: tseries package -- license
References: <199907141541.RAA27707@sophie.ethz.ch>
Message-ID: <378D9625.50BB8F9F@wu-wien.ac.at>

Martin Maechler wrote:

> Thanks a lot for "tseries"!
>
> The new (0.1-2) version of the tseries package
> contains the following in ./README :
>
> >> Author(s): A. Trapletti <A.Trapletti@ci.tuwien.ac.at>,
> >>         B. LeBaron ("./src/bdstest.c"),
> >>         K. Krischer, and T. M. Kruel ("./src/muin2ser.f",
> >>         "./misc/mutinfo-1.21b.tar.gz")
>
> >> License: "./src/muin2ser.f", "./misc/mutinfo-1.21b.tar.gz" are
> >>         free for non-commercial purposes. "./src/bdstest.c" is
> >>         free. The remainder is covered by GPL version 2 or
> >>         newer; see file COPYING
>
> I think the ``free for non-commercial purposes''
> is not good enough for us.
>
> Could you try to contact K.Krischer und T.M.Kruel and ask if they would
> release their software under GPL (or something similar)?

I will try...

>
>
> If not, it may be worth to separate your "tseries" package into a
> free part (that can be put onto CD-ROMs !),
> and a non-free part (that CAN'T be put onto CD-ROMs) for the "muin/mutinfo"
> stuff.

The non-free part only contains the "amif" function. I think although the
"auto mutual information" is a nice toy, it is not a very big loss, if we
don't have it in the "free" tseries package.

Adrian

>
>
> Martin

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 10:28:13 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 15 Jul 1999 11:28:13 +0200 (MET DST)
Subject: .Last is usually not called (PR#227)
Message-ID: <199907150928.LAA05145@pubhealth.ku.dk>

R-0.64.2 and R-devel:

[I found this by looking at the code.]

A .Last function is _only_ called if the condition that causes termination
is EOF on the console or input:

> .Last <- function() cat("ran .Last\n")
> q("no")
returns to the shell.

> .Last <- function() cat("ran .Last\n")
> # I hit ^D here
ran .Last
Save workspace image? [y/n/c]: n

The problem is that .Last is handled in end_Rmainloop(), and that is
not called by q(). We need to move the handling to R_CleanUp (and
for some reason do_quit is system-dependent, so need not even call
R_CleanUp). I'll work on this.

I did check the documentation: ?quit does claim .Last should be called:

     Immediately before terminating, the function `.Last()'
     is executed if it exists.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul 15 12:53:54 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu, 15 Jul 1999 13:53:54 +0200 (MET DST)
Subject: [R] R: ts - objects (PR#228)
Message-ID: <199907151153.NAA06756@pubhealth.ku.dk>

Marcus Eger <marcus.eger@physik.uni-marburg.de> writes:

> > time(sqrt(arrts))
> Time Series:
> Start = c(1, 1) 
> End = c(5, 1) 
> Frequency = 1 
> [1] 1 2 3 4 5

Looks like a bug...

> ----------------------------------------------------------------------------
> 2. (At least) boolean indexing with matrices does not seem to work
> properly:
> ----------------------------------------------------------------------------
> > arrts[is.finite(arrts)]
> Error: subscript (10) out of bounds, should be at most 5
> > 
> > unclass(arrts)[is.finite(arrts)]
>  [1]  1  2  3  4  5  6  7  8  9 10

Yes, we discussed that a short while ago on R-devel. It's trying too
hard to retain the ts attributes in these cases.

> 
> ----------------------------------------------------------------------------
> This problem arose when I tried to plot my time series: > plot(arrts)
> It was easy to fix in plot.ts:
> ----------------------------------------------------------------------------
> ....
>   if (is.null(ylim)) 
>     ylim <- range(unclass(x)[is.finite(x)])  #by ME, 14-07-99
> #    ylim <- range(x[is.finite(x)])
>   plot.new()
> ....

...although range(x,finite=T) is probably a better fix.

> 
> -----------------------------------------------------------------------------
> 3. Another problem had to do with the value of delta and/or start:
> -----------------------------------------------------------------------------
> > time(ts(c(1,2,3,4),start=3,delta=1.5))
> Error: invalid start

or just: 

> ts(c(1,2,3,4),start=3,delta=1.5)
Time Series:
Start = c(3, 1) 
End = c(7, 1) 
Frequency = 0.666666666666667 
Error: invalid start

..which is pretty darn weird! CC'ed to R-bugs.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 13:57:22 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 14:57:22 +0200
Subject: which() does not handle NAs in named vectors. (PR#226)
In-Reply-To: <199907150714.JAA03804@pubhealth.ku.dk> (ripley@stats.ox.ac.uk)
References: <199907150714.JAA03804@pubhealth.ku.dk>
Message-ID: <199907151257.OAA06166@sophie.ethz.ch>

>>>>> On Thu, 15 Jul 1999 09:14, ripley@stats.ox.ac.uk (Brian D. Ripley) said:

Thank you for the bug report

    BDR> -- It is unclear to me that the handling of NAs is desirable, and
    BDR> it has problems with names:

{function which in its present form very much evolved out of user wishes...}

    BDR> z <- c(T,T,NA,F,T)
    BDR> names(z) <- letters[1:5]
    BDR> which(z)
    BDR> Error: names attribute must be the same length as the vector

fixed for release-patches [available in a day or two from CRAN src/devel/]
and hence every new release.

    BDR> (Why do the vector and its names have different subscripts?  And
    BDR> while you are correcting this,

    BDR> Arguments:

    BDR>        x: a logical vector or array.  `NA's are allowed an
    BDR>	   omitted.

is now

       x: a `logical' vector or array.  `NA's are allowed
          and omitted (treated as if `FALSE').

  
    BDR> has a typo, and the logic can be simplified: see below.)

    BDR> On Thu, 15 Jul 1999, Martin Maechler wrote:

    >> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
    >> 
    BDR> On Wed, 14 Jul 1999, Friedrich Leisch wrote:
    >> >> >>>>> On Wed, 14 Jul 1999 04:09:21, >>>>> Peter B Mandeville
    >> (PBM) >> wrote:
    >> >> 
    PBM> I have a vector Pes with 600 elements some of which are NA's. How
    PBM> can I form a vector of the indices of the NA's.
    >> >>
    PBM> for(i in 1:600) if(is.na(Pes[i])) print(i)
    >> >>
    PBM> prints the indices of the NA's but I can't figure out how to put
    PBM> the results in a vector.
    >> >> try this:
    >> >> 
    >> >> x <- (1:length(Pes))[is.na(Pes)]
    >> 
    BDR> Tip: that sort of thing often fails for a length 0 vector. The
    BDR> `approved' spell is
    >>
    BDR> seq(along=Pes)[is.na(Pes)]

BTW, currently  seq(along = x)  returns "numeric" ("double") 
whereas		1:length(x)     returns "integer".
I'm about to fix this...

    BDR> In this case it does not matter as the subscript is of length 0,
    BDR> but it has floored enough library/package writers to be worth
    BDR> thinking about.
    >>  Good teaching about seq() vs.  1:n
    >> 
    >> However, the solution I gave
    >> 
    >> which(is.na(Pes))
    >> 
    >> is the one I stilly really recommend; it does deal with 0-length
    >> objects, and it keeps names when there are some, and it has an
    >> `arr.ind = FALSE' argument to return array indices instead of vector
    >> indices when so desired.

    BDR> Yes, but

    BDR> -- It is not in S (so causing difficulty in porting from R to S)

Well, I know what you mean and your point is all well in the above case...
but anyway:
Our group here has been using this ("which" function) in S for quite a while and
eventually, someone will have to collect a library of things from R, missing in
S-plus and easily implementable.

And then, for quite a few R users, S-plus backward compatibility is not the
big issue. Locally, in our collection of S-plus add-ons, we've got already
quite a few of them.. 
And in other ways, R is so much nicer
    - math annotation in graphics
    - color, line types  {  plot(x,y, col="light blue", col.main = "blue") }
    - filled.contour
    - persp() with shading..

I think if you want to live in both worlds, I want (and recommend) to use

    if(is.R()) {

       ...R specific...

    } 
    else { ## S-plus ---

       ...S-plus specific...

    }

anyway, even within user written functions
and make sure (via .First or S_FIRST or ...)  that is.R() |--> FALSE in S-plus


    BDR> -- It looks a relatively expensive operation.

I don't think it is expensive (for arr.ind=FALSE !) if you want to do deal
with missings (NA) at all.  (Peter's example above is one of the few places 
where you are absolutely sure there are no missings...)
Assume x has some NAs, e.g.
    x <- rnorm(1000); x[1000*runif(rpois(1,lam=50))] <- NA
Then
    which( x < -2 )  

works how one would want;

    seq(along = x)[x < -2]

gives silly NA's (which make sense for the logical vector but not for the
		 extraction).

    BDR> -- Internally which could be simplified by using seq(along=) as it is a wrapper for
    BDR> this construct, but actually the separate handling of n == 0 is
    BDR> unnecessary (as logic & !is.na(logic) will have length zero.)

You are right, and that's part of the fix for `which' which is currently

which <- function(logic, arr.ind = FALSE)
{
    if(!is.logical(logic))
	stop("argument to \"which\" is not logical")
    wh <- seq(along=logic)[ll <- logic & !is.na(logic)]
    if ((m <- length(wh)) > 0) {
	dl <- dim(logic)
	if (is.null(dl) || !arr.ind) {
	    names(wh) <- names(logic)[ll]
	}
	else { ##-- return a matrix  length(wh) x rank
	    rank <- length(dl)
	    wh1 <- wh - 1
	    wh <- 1 + wh1 %% dl[1]
	    wh <- matrix(wh, nrow = m, ncol = rank,
			 dimnames =
			 list(dimnames(logic)[[1]][wh],
			      if(rank == 2) c("row", "col")# for matrices
			      else paste("dim", 1:rank, sep="")))
	    if(rank >= 2) {
		denom <- 1
		for (i in 2:rank) {
		    denom <- denom * dl[i-1]
		    nextd1 <- wh1 %/% denom# (next dim of elements) - 1
		    wh[,i] <- 1 + nextd1 %% dl[i]
		}
	    }
	    storage.mode(wh) <- "integer"
	}
    }
    wh
}
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 14:03:56 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 15:03:56 +0200 (CEST)
Subject: [R] R: ts - objects (PR#228)
In-Reply-To: <199907151153.NAA06756@pubhealth.ku.dk>
Message-ID: <XFMail.990715150356.plummer@iarc.fr>

> Marcus Eger <marcus.eger@physik.uni-marburg.de> writes:
>> 
>> -----------------------------------------------------------------------------
>> 3. Another problem had to do with the value of delta and/or start:
>> -----------------------------------------------------------------------------
>> > time(ts(c(1,2,3,4),start=3,delta=1.5))
>> Error: invalid start
> 
> or just: 
> 
>> ts(c(1,2,3,4),start=3,delta=1.5)
> Time Series:
> Start = c(3, 1) 
> End = c(7, 1) 
> Frequency = 0.666666666666667 
> Error: invalid start
> 
> ..which is pretty darn weird! CC'ed to R-bugs.

That's just the print method for ts objects calling
time().

The underlying problem is in start().
> start(x)
[1] 3 1

I think the 2-vector form of start and end only makes sense when the
frequency is an integer. If I am right then the following versions of
start.ts and end.ts (which check that tsp[3] is an integer) should solve
the problem.

M.

"start.ts" <- function (x) 
{
    ts.eps <- .Options$ts.eps
    ##if(is.null(ts.eps)) ts.eps <- 1.e-5
    tsp <- attr(as.ts(x), "tsp")
    is <- tsp[1] * tsp[3]
    if (abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < 
        ts.eps) {
        is <- floor(tsp[1])
        fs <- floor(tsp[3] * (tsp[1] - is) + 0.001)
        c(is, fs + 1)
    }
    else tsp[1]
}

"end.ts" <- function(x)
{
    ts.eps <- .Options$ts.eps
    ## if(is.null(ts.eps)) ts.eps <- 1.e-5
    tsp <- attr(as.ts(x), "tsp")
    is <- tsp[2] * tsp[3]
    if (abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < 
        ts.eps) {
        is <- floor(tsp[2])
        fs <- floor(tsp[3] * (tsp[2] - is) + 0.001)
        c(is, fs + 1)
    }
    else tsp[2]
}

M.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Thu Jul 15 16:19:22 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Thu, 15 Jul 1999 15:19:22 +0000
Subject: tseries
References: <XFMail.990715163125.plummer@iarc.fr>
Message-ID: <378DFBF9.FE784F5E@wu-wien.ac.at>

Martyn Plummer wrote:

> Dear Adrian,

Hi Martin

>
>
> Thank you for providing your time series library for R. I have been
> working on a time series package myself, with help from Paul Gilbert. It
> is called "bats" (doesn't stand for anything except possibly "basic time
> series") and can be found in the devel directory on CRAN.
>
> The "bats" library was a collection of S-PLUS compatibile functions
> that I needed for my "coda" package. With a little encouragement from
> Paul, I split these off into a separate package and developed them into
> more-or-less full clones of the S-PLUS functions. There are a couple of
> functions yet unwritten (autoregressive estimation via Burg's algorithm
> and spectral density estimation from fitting ar models) and this is the
> only reason why the package is in the "devel" directory.
>
> I am writing to ask if you would like to merge the two libraries
> together. The primary design goal of bats is compatibility with S-PLUS,

Even if I would like to, it would not be easy for me because I don't have
access to any S-PLUS.

To the R developpers: Is that a primary design goal?

>
> which may not be what you want. In any case, both libraries are GPL so
> you are free to use any of the code. Please have a look at bats and
> tell me what you think.
>
> Martyn

I compared the acf functions of both "bats" and "tseries":

> x<-rnorm(10000)
> library(bats)
> x<-rnorm(10000)
> system.time(a<-acf(x,1000))
[1] 15.70  0.02 31.00  0.00  0.00
> library(tseries)
> system.time(a<-acf(x,1000,pl=F))
[1] 0.29 0.00 1.00 0.00 0.00
>

I think, to achieve a better performance you should avoid loops of the
order of the length of a usual data set. It makes your routines very slow.

Though I think we should here some opinions about the design of a time
series library and then we can discuss about merging any parts or splitting
some programming work for THE R time series library.

Thanks

Adrian


--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 15 16:47:25 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 15 Jul 1999 17:47:25 +0200 (CEST)
Subject: docs: topic && availability
In-Reply-To: <378CDF72.5499BD27@bank-banque-canada.ca>
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
 <378CDF72.5499BD27@bank-banque-canada.ca>
Message-ID: <14222.653.137118.492844@balin.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> I've often thought that some sort of synonym dictionary would be
> useful, especially for new users. That is, give the name of some
> procedure, say in Matlab, SAS or SPSS, or even a statistical term, and
> get information about possible procedures to consider in S/R (and the
> other way around too). I think this might be much more broadly useful
> than just for R, so I wouldn't tie it too closely to R help() or CRAN.

Yes, it is much more broadly useful.

Nevertheless, using \index{} in Rd files would be one source for such
info, almost ``for free'' ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 16:51:04 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 15 Jul 1999 16:51:04 +0100 (BST)
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <Pine.GSO.4.05.9907151649240.26531-100000@auk.stats>

On Thu, 15 Jul 1999, Adrian Trapletti wrote:

> Martyn Plummer wrote:
> 
> > Dear Adrian,
> 
> Hi Martin
> 
> >
> >
> > Thank you for providing your time series library for R. I have been
> > working on a time series package myself, with help from Paul Gilbert. It
> > is called "bats" (doesn't stand for anything except possibly "basic time
> > series") and can be found in the devel directory on CRAN.
> >
> > The "bats" library was a collection of S-PLUS compatibile functions
> > that I needed for my "coda" package. With a little encouragement from
> > Paul, I split these off into a separate package and developed them into
> > more-or-less full clones of the S-PLUS functions. There are a couple of
> > functions yet unwritten (autoregressive estimation via Burg's algorithm
> > and spectral density estimation from fitting ar models) and this is the
> > only reason why the package is in the "devel" directory.
> >
> > I am writing to ask if you would like to merge the two libraries
> > together. The primary design goal of bats is compatibility with S-PLUS,
> 
> Even if I would like to, it would not be easy for me because I don't have
> access to any S-PLUS.
> 
> To the R developpers: Is that a primary design goal?

One design goal for one library.

> >
> > which may not be what you want. In any case, both libraries are GPL so
> > you are free to use any of the code. Please have a look at bats and
> > tell me what you think.
> >
> > Martyn
> 
> I compared the acf functions of both "bats" and "tseries":
> 
> > x<-rnorm(10000)
> > library(bats)
> > x<-rnorm(10000)
> > system.time(a<-acf(x,1000))
> [1] 15.70  0.02 31.00  0.00  0.00
> > library(tseries)
> > system.time(a<-acf(x,1000,pl=F))
> [1] 0.29 0.00 1.00 0.00 0.00
> >
> 
> I think, to achieve a better performance you should avoid loops of the
> order of the length of a usual data set. It makes your routines very slow.
> 
> Though I think we should here some opinions about the design of a time
> series library and then we can discuss about merging any parts or splitting
> some programming work for THE R time series library.

I have been promising to do this for some time (indeed, promised Adrian
to do so). Let me try to do some work on this and come to a proposal
shortly.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 17:04:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 18:04:09 +0200
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at> (message from Adrian Trapletti
 on Thu, 15 Jul 1999 15:19:22 +0000)
References: <XFMail.990715163125.plummer@iarc.fr> <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <199907151604.SAA10786@sophie.ethz.ch>

Dear Adrian (and everyone else),

to the same topic,
I've got a file "tseries-comments" five days old that I never got around
polishing before sending to you :

>> Thank you very much for the functionality !
>> 
>> - tsparam : not the best name for that class.. ???
>> 
>>    ybnd : should be allowed to have EITHER length 1 of length = length(x)
>> 
>>    --> my patched version
>> 
>> - plot.tsparam: 	use 'type = "h"'  as default!
>> 
>> - acf, pacf :
>> 
>> 	are *one* function in S-plus,
>> 
>> 	use 'plot = T', not 'pl = T'  as argument
>> 			(in line with several other R functions !)
>> 
>>   --> other small improvements...
>> 
>>   {including:  instead of  rep(0, nnn),  use numeric(nnn) }
>> 
>>    --> my version
>> [[ I'll send this in private to Adrian ]]

As you see, 
some of these 5day old comments are in line with Martyn's 
(he is Martyn, I am Martin). 

A few thoughts :

- Yes, we want to be S(-plus) compatible as long as it is not too hard or
  there are not good reasons against compatibility.
 
  Particularly,  acf(), spec.pgram(),  spectrum(), ar(), ar.yw()
  should have compatible argument names [at least for the important ones]
  to make it easy to many users moving from S to R (;-).

- Of course, it is *the wise thing* to use FFT for acf -- for the case of no
  NAs.. [and I think the NA case should be handled as well, and for small
        no-NA series that straightforward method will probably be faster
	than FFT as well ].

- I'd very much appreciate if Martyn and you and Paul G. 
  (and Brian and Ross and ... 
   and me, we also have a few improvements on S-plus laying around here)
  could coordinate to produce ``the real'' time series package for R.

- As a matter of fact, I hope that some of the functions would become part
  of "Core R" (such as e.g. "modreg" is base of "Core R"),
  since e.g., the availability of  acf()  should not depend on having a
  contributed package installed on top of "Core R".

Thanks once more to all the "time series" coders !
Martin

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 17:19:11 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 18:19:11 +0200 (CEST)
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <XFMail.990715181911.plummer@iarc.fr>

On 15-Jul-99 Adrian Trapletti wrote:
> Martyn Plummer wrote:
>> I am writing to ask if you would like to merge the two libraries
>> together. The primary design goal of bats is compatibility with S-PLUS,
> 
> Even if I would like to, it would not be easy for me because I don't have
> access to any S-PLUS.

Oh.
 
> To the R developpers: Is that a primary design goal?

A delicate question. Some people have strong views on compatibility, but
I think it is safe to say that compatibility with S considered a good thing
as it makes it easier to port existing S code to R, and that on that basis
incompatibilities are considered bugs, unless there is a good reason for
doing something differently.

However, here we are talking about the PLUS part of S-PLUS, for which there
are fewer precedents, and it may even be good politics to do things differently.

>>
>> which may not be what you want. In any case, both libraries are GPL so
>> you are free to use any of the code. Please have a look at bats and
>> tell me what you think.
>>
>> Martyn
> 
> I compared the acf functions of both "bats" and "tseries":
> 
>> x<-rnorm(10000)
>> library(bats)
>> x<-rnorm(10000)
>> system.time(a<-acf(x,1000))
> [1] 15.70  0.02 31.00  0.00  0.00
>> library(tseries)
>> system.time(a<-acf(x,1000,pl=F))
> [1] 0.29 0.00 1.00 0.00 0.00
>>
> 
> I think, to achieve a better performance you should avoid loops of the
> order of the length of a usual data set. It makes your routines very slow.

Ouch! I know that acf isn't very efficient, but on the other hand I have
never wanted to calculate the acf to this order, and if I did I would
certainly use fft too.
 
> Though I think we should here some opinions about the design of a time
> series library and then we can discuss about merging any parts or splitting
> some programming work for THE R time series library.
> 
> Thanks
> 
> Adrian

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 17:30:12 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 18:30:12 +0200 (CEST)
Subject: tseries
In-Reply-To: <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <XFMail.990715183012.plummer@iarc.fr>

On 15-Jul-99 Martin Maechler wrote:
> - Of course, it is *the wise thing* to use FFT for acf -- for the case of no
>   NAs.. [and I think the NA case should be handled as well, and for small
>         no-NA series that straightforward method will probably be faster
>       than FFT as well ].

This reminds me of a request I have been meaning to make.

S-plus time series functions normally use only the longest contiguous
portion of the series with no missing values. I think a good way to implement
this would be to have an "na.omit" method for time series, but this
isn't a generic function in R (It is in SPLUS 3.3). Could this be changed?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 17:36:48 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 18:36:48 +0200
Subject: docs: topic && availability
In-Reply-To: <14222.653.137118.492844@balin.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 15 Jul 1999 17:47:25 +0200 (CEST))
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
 <378CDF72.5499BD27@bank-banque-canada.ca> <14222.653.137118.492844@balin.ci.tuwien.ac.at>
Message-ID: <199907151636.SAA10972@sophie.ethz.ch>

Just to give my 5 Rp. in a very time constrained situation:

Yes, Kurt, 
yes, yes!

This *is* an urgent problem we should attack.

If someone doesn't find the Wilcoxon Test in R, {s}he must think we are all
nuts to use such a system at all .. until some crack tells him
``oh yeah, that's available in "ctest"...''.
and Joe User replies to the crack ``how on earth should I have guessed..''

[[and I **REALLY** think wilcoxon.test() should be moved to "Core R", even
  to the base:package !]]

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 15 17:38:03 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 15 Jul 1999 18:38:03 +0200 (CEST)
Subject: tseries
In-Reply-To: <199907151604.SAA10786@sophie.ethz.ch>
References: <XFMail.990715163125.plummer@iarc.fr>
 <378DFBF9.FE784F5E@wu-wien.ac.at>
 <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <14222.3691.526557.34151@balin.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> Dear Adrian (and everyone else), to the same topic, I've got a file
> "tseries-comments" five days old that I never got around polishing
> before sending to you :

>>> Thank you very much for the functionality !
>>> 
>>> - tsparam : not the best name for that class.. ???
>>> 
>>> ybnd : should be allowed to have EITHER length 1 of length = length(x)
>>> 
--> my patched version
>>> 
>>> - plot.tsparam: 	use 'type = "h"'  as default!
>>> 
>>> - acf, pacf :
>>> 
>>> are *one* function in S-plus,
>>> 
>>> use 'plot = T', not 'pl = T'  as argument
>>> (in line with several other R functions !)
>>> 
--> other small improvements...
>>> 
>>> {including:  instead of  rep(0, nnn),  use numeric(nnn) }
>>> 
--> my version
>>> [[ I'll send this in private to Adrian ]]

> As you see, 
> some of these 5day old comments are in line with Martyn's 
> (he is Martyn, I am Martin). 

> A few thoughts :

> - Yes, we want to be S(-plus) compatible as long as it is not too hard
>   or there are not good reasons against compatibility.

Agreed.
 
>   Particularly, acf(), spec.pgram(), spectrum(), ar(), ar.yw() should
>   have compatible argument names [at least for the important ones] to
>   make it easy to many users moving from S to R (;-).

Agreed.

> - Of course, it is *the wise thing* to use FFT for acf -- for the case
>   of no NAs.. [and I think the NA case should be handled as well, and
>   for small no-NA series that straightforward method will probably be
>   faster > than FFT as well ].

> - I'd very much appreciate if Martyn and you and Paul G.  (and Brian
>   and Ross and ...  and me, we also have a few improvements on S-plus
>   laying around here) could coordinate to produce ``the real'' time
>   series package for R.

> - As a matter of fact, I hope that some of the functions would become
>   part of "Core R" (such as e.g. "modreg" is base of "Core R"), since
>   e.g., the availability of acf() should not depend on having a
>   contributed package installed on top of "Core R".

Yes, definitely.

> Thanks once more to all the "time series" coders !

What I'd like to see in particular is some work going into model-style
interfaces.  Not sure exactly what it would be like, but something like

   armaxm(y ~ x, orderspecifications)

or maybe even

   armaxm(y ~ A(L) * y + B(L) * e + C(L) * x, ...)

Actually, creating an ARMA model could happen via the parameters or via
fitting data, so here is an extra challenge.

(A comment on tseries:  If possible, I'd prefer to use UC ini style
naming for data sets, such as TreeRing etc.  Name space etc ...)

-k



> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
> Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
> phone: x-41-1-632-3408		fax: ...-1086			<><
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From osman.buyukisik@ae.ge.com  Thu Jul 15 20:24:35 1999
From: osman.buyukisik@ae.ge.com (U-E59264-Osman F Buyukisik)
Date: Thu, 15 Jul 1999 15:24:35 -0400 (EDT)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
 <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
Message-ID: <14222.13284.386863.936325@c1186.ae.ge.com>

July 14 tarball.
In my case hpux 10.20 with gcc/f77/make (gnu make), The configure does 
not correctly pick the FPICFLAGS. It should be "+z". ALso the SHLIBLD
is incorrectly set as "gcc", it should be "ld". I fixed both in
Makeconf and etc/Makeconf and the build went OK. dynamic load stuff
seems to be working (eda loads OK and works).
I also have to hand fix "readline". It correctly picks that I have
readline but not history! Also the the readline lib location had to be 
corrected. Since it knows where to look up for the readline.h why
could it not find the lib location? in my case they are in
$prefix/include and $prefix/lib. 

Best Regards,
osman

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Jul 15 20:38:44 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 15 Jul 1999 15:38:44 -0400
Subject: ``the real'' time series package
References: <XFMail.990715163125.plummer@iarc.fr> <378DFBF9.FE784F5E@wu-wien.ac.at> <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <378E38C4.AF2B1803@bank-banque-canada.ca>

>- I'd very much appreciate if Martyn and you and Paul G.
>  (and Brian and Ross and ...
>   and me, we also have a few improvements on S-plus laying around here)
>  could coordinate to produce ``the real'' time series package for R.

I'd like to split this into pieces:

- Some core functions for Splus compatibility. (acf and ar are the important
ones for me right now, but the spectrum stuff is important too.) Name space
conflicts will be a problem if there are two versions of, for example, acf,
which take different arguments (and  give different results - although bats acf
purposely gives different results from Splus). The objective of "bats" was to
fill this gap.

- Programming tools for operating on the time dimension of data. My tframe
library tries to do most of that. The idea is that other programs should be able
to use window, start, end, trim.na, etc., and not need to worry about whether
the time series is an old S tsp series, a "ts", an "rts", a "cts", a "tf", or
anything else that might come along. The library seems to work well and provides
an extremely useful building block. (I always appreciate constructive comments.)
This is also related to the question of what "[.ts" should do.

- A convenient method for pulling time series data from other sources into R
(and S and Omega, etc.). My PADI library does that. It works well, but is
getting a bit dated. I've been thinking about a CORBA replacement. (Any
volunteers to work on that?)

- A library of optimization methods which can be used for maximizing
likelihood(data, model(parameters)) would be useful. This is not specific to
time series and there is a fair amount of stuff around, so the problem is really
just making sure it fits the time series context. I have DFP and non-linear
simplex, but I haven't used them in a while.

- General structures for time series analysis. I am relatively committed to the
structure I have been using for several years now, but I would always consider
improvements. It should at least be considered as a good starting point. The
main elements are:
    1/  an abstract data representation with a distinction between input
(exogenous or conditioning) data and output (endogenous) data. These are x and y
in y ~ f(x), but it seems useful to put them in one structure because time
alignment is important. Then for example, window can be applied to the two
together rather than separately.  Currently my code supports an internal
implementation (input and output are time series matrices) and a PADI
implementation (the data is on a remote database running the PADI interface).
    2/  an abstract model representation which can be applied to the data.
Currently my code supports multivariate ARMA and state space models, Troll
models, and some crude attempts with NN models. But the idea is that it should
be easy to add other representations.
    3/  an object which combines the above two and adds some statistics
(likelihood, residuals, etc.)

- Methods for operating on the general structures: estimation techniques,
simulation, conversion, information criteria, etc. This is the fun part. I have
a fair amount of this, but it should be easy to add more.

- "Superstructure" methods for studying estimation techniques and the
forecasting properties of models. For example, one can take a "true model"
(defined as in 2/), simulate it (to get data as in 1/), and examine the small
sample properties of different estimation techniques. Or, take a given data set
and examine the (out-of-sample) forecasting properties of different models. The
idea is that these superstructure methods do not need to be changed if new data
representations or new model representations are added. (e.g. they do not need a
specific method for a new kind of model, they just call "simulate" and there
needs to be a simulate method for the new model.) My library has a fair amount
of this too,  but there is always room to add more here.

There are several areas in which I think my library is good, and there are
several deficiencies. I've played a bit with frequency domain methods, but that
is a general weakness. I'm very happy to see Adrian's unit root stuff, as it has
been on my "to do" list for several years now. I also get regular requests for
ARCH and GARCH modeling.

I do hope people will work on new stuff rather than things which are already
done by someone else. It might be useful to put a "time series" bullet on CRAN
(in contrib/PACKAGES.html probably) giving a general outline of what is where. I
get pretty upset when I see references to the lack of time series functionality
in R. (My DSE package is in the development area of CRAN only because the
documentation is in HTML rather than R's .Rd format and R's installation
procedures have been changing. The code is not unstable or incomplete.  The
version on CRAN installed with 0.63? and the most recent version at
<http://www.bank-banque-canada.ca/pgilbert> installs with 0.64 and 0.65)

Paul Gilbert


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 23:25:16 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 15 Jul 1999 23:25:16 +0100 (BST)
Subject: ``the real'' time series package
In-Reply-To: <378E38C4.AF2B1803@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907152315160.6049-100000@auk.stats>

On Thu, 15 Jul 1999, Paul Gilbert wrote:

> >- I'd very much appreciate if Martyn and you and Paul G.
> >  (and Brian and Ross and ...
> >   and me, we also have a few improvements on S-plus laying around here)
> >  could coordinate to produce ``the real'' time series package for R.
> 
> I'd like to split this into pieces:
> 
> - Some core functions for Splus compatibility. (acf and ar are the important
> ones for me right now, but the spectrum stuff is important too.) Name space
> conflicts will be a problem if there are two versions of, for example, acf,
> which take different arguments (and  give different results - although bats acf
> purposely gives different results from Splus). The objective of "bats" was to
> fill this gap.

[...]

> I do hope people will work on new stuff rather than things which are already
> done by someone else. It might be useful to put a "time series" bullet on CRAN
> (in contrib/PACKAGES.html probably) giving a general outline of what is where. I
> get pretty upset when I see references to the lack of time series functionality
> in R. (My DSE package is in the development area of CRAN only because the
> documentation is in HTML rather than R's .Rd format and R's installation
> procedures have been changing. The code is not unstable or incomplete.  The
> version on CRAN installed with 0.63? and the most recent version at
> <http://www.bank-banque-canada.ca/pgilbert> installs with 0.64 and 0.65)

Paul:

you are taking a limited view of time series analysis: there _is_ a
lot missing from R (even if DSE is included, and as it lacks R
documentation and a Windows port, that is a moot point). In particular
there is no AFAIK

de-seasonalizing (e.g. X11-ARIMA or whatever, stl, sabl)
easy-to-use (seasonal) ARIMA fitting
flexible spectral analysis
GARCH etc
regression with autocorrelated errors and related econometric techniques
(there is now some in lme, but I still have problems with that under R).

Compared to S-PLUS (especially 5.1, including the add-on modules) I think
`the lack of time series functionality in R' is fair comment. Let's
change that. Some of it is easy to do: the S-PLUS spectral analysis stuff
is based on Bloomfield's code, and I already have a package based on that.
Similarly, I have easy-to-use (seasonal) ARIMA fitting to hand.

I'll try to review what we do have and the gaps and report to R-devel
on Monday.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Fri Jul 16 03:09:33 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Fri, 16 Jul 1999 04:09:33 +0200 (MET DST)
Subject: dev.print scaling bug? (PR#229)
Message-ID: <199907160209.EAA10314@pubhealth.ku.dk>


# demo of bug in dev.print()
# (trivial, but detracts from Rolls Royce feel of R and forces workarounds)
# seen in rw0642 and linux version of 0.64.1

# Verbal attempt at generalising the behaviour illustrated by this file:

# If "par(mfrow)" is used to set more than 2 graphs vertically or 
# horizontally on the page, then, in the file generated by "dev.print()", 
# the default size of the graph points created by "points()" differs from 
# the size created by "plot()", although it does not differ on the 
# screen display.

a_1:10
b_c(2:10,NA)

opar_par(mfrow=c(1,3))	# set up page for 1x3 graphs, bug
#opar_par(mfrow=c(3,1))	# set up page for 3x1 graphs, bug
#opar_par(mfrow=c(2,1))	# set up page for 2x1 graphs, OK

plot(a,a)
points(a,b)

plot(a,b)
points(a,a)

plot(a,a)
points(a,b)

par(opar)

dev.print(file="printdev.ps")

# gv or print "printdev.ps"

----------------------------------------------------------------------------

Thanks for R

John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 08:52:35 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 09:52:35 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14222.13284.386863.936325@c1186.ae.ge.com>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
 <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
 <14222.13284.386863.936325@c1186.ae.ge.com>
Message-ID: <14222.58563.920246.500172@aragorn.ci.tuwien.ac.at>

>>>>> U-E59264-Osman F Buyukisik writes:

> July 14 tarball.

> In my case hpux 10.20 with gcc/f77/make (gnu make), The configure does
> not correctly pick the FPICFLAGS. It should be "+z". ALso the SHLIBLD
> is incorrectly set as "gcc", it should be "ld". I fixed both in
> Makeconf and etc/Makeconf and the build went OK. dynamic load stuff
> seems to be working (eda loads OK and works).

A mental malfunction on my behalf ... sorry.  Should be fixed now.  

> I also have to hand fix "readline". It correctly picks that I have
> readline but not history! Also the the readline lib location had to be 
> corrected. Since it knows where to look up for the readline.h why
> could it not find the lib location? in my case they are in
> $prefix/include and $prefix/lib.

Don't know.  You say that you have /usr/local/lib/libreadline.a but it
is not found?  (by gcc?)  Very strange ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Fri Jul 16 14:12:30 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Fri, 16 Jul 1999 14:12:30 +0100 (BST)
Subject: vector()
Message-ID: <Pine.GSO.3.96.990716140337.4499A-100000@laplace>

Can I suggest that vector() has an additional names argument?  This would
make it more comparable with matrix() and array().  I frequently find
myself doing

	fred <- vector("list", length(happy))
	names(fred) <- names(happy)

when I would rather be doing

	fred <- vector("list", length(happy), names = names(happy))

Just a thought.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From johann@ai.univie.ac.at  Fri Jul 16 14:13:03 1999
From: johann@ai.univie.ac.at (Johann Petrak)
Date: Fri, 16 Jul 1999 15:13:03 +0200
Subject: R-0.64.2 ssize_t not defined in src/unix/sock.h
Message-ID: <378F2FDF.349381C0@ai.univie.ac.at>

I though I should let you all know of this:

Trying to build R-0.62.2 on a SunOS xxxx 4.1.4 2 sun4m machine
using gcc (gcc version egcs-2.91.57 19980901 (egcs-1.1 release)):

gnumake[2]: Entering directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
gcc -g -O2 -I../include -I../../src/include  -c Rsock.c -o Rsock.o
In file included from Rsock.c:8:
sock.h:21: parse error before `Sock_read'
sock.h:21: warning: data definition has no type or storage class
sock.h:22: parse error before `Sock_write'
sock.h:22: warning: data definition has no type or storage class
Rsock.c: In function `Rsockwrite':
Rsock.c:112: `ssize_t' undeclared (first use in this function)
Rsock.c:112: (Each undeclared identifier is reported only once
Rsock.c:112: for each function it appears in.)
Rsock.c:112: parse error before `n'
Rsock.c:125: `n' undeclared (first use in this function)
gnumake[2]: *** [Rsock.o] Error 1
gnumake[2]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
gnumake[1]: *** [R] Error 1
gnumake[1]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src'
gnumake: *** [R] Error 1

Adding a typedef like for Win32 seems to help ...

Johann

---
Johann Petrak                       Email: johann@ai.univie.ac.at
Austrian Research Institute for AI  Phone:     +43-1-533-61-12/13
Schottengasse 3                     Fax:       +43-1-532-61-12/77
A-1010 Vienna, AUSTRIA         http://www.ai.univie.ac.at/~johann
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 14:22:10 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 15:22:10 +0200 (CEST)
Subject: R-0.64.2 ssize_t not defined in src/unix/sock.h
In-Reply-To: <378F2FDF.349381C0@ai.univie.ac.at>
References: <378F2FDF.349381C0@ai.univie.ac.at>
Message-ID: <14223.12802.659507.724069@aragorn.ci.tuwien.ac.at>

>>>>> Johann Petrak writes:

> I though I should let you all know of this:
> Trying to build R-0.62.2 on a SunOS xxxx 4.1.4 2 sun4m machine
> using gcc (gcc version egcs-2.91.57 19980901 (egcs-1.1 release)):

> gnumake[2]: Entering directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
> gcc -g -O2 -I../include -I../../src/include  -c Rsock.c -o Rsock.o
> In file included from Rsock.c:8:
> sock.h:21: parse error before `Sock_read'
> sock.h:21: warning: data definition has no type or storage class
> sock.h:22: parse error before `Sock_write'
> sock.h:22: warning: data definition has no type or storage class
> Rsock.c: In function `Rsockwrite':
> Rsock.c:112: `ssize_t' undeclared (first use in this function)
> Rsock.c:112: (Each undeclared identifier is reported only once
> Rsock.c:112: for each function it appears in.)
> Rsock.c:112: parse error before `n'
> Rsock.c:125: `n' undeclared (first use in this function)
> gnumake[2]: *** [Rsock.o] Error 1
> gnumake[2]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
> gnumake[1]: *** [R] Error 1
> gnumake[1]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src'
> gnumake: *** [R] Error 1

> Adding a typedef like for Win32 seems to help ...

This is fixed in 0.65.  I'll also do it for r-release.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 15:58:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 16:58:54 +0200 (CEST)
Subject: 0.65/HPUX
Message-ID: <14223.18606.15426.849188@aragorn.ci.tuwien.ac.at>

After further elimination of sort-of-GNUish things in the Makefiles and
tweaking of configure, I can now successfully build on HPUX with
cc/f77/make (note: everything native).  make check still fails, but ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sat Jul 17 23:16:10 1999
From: bates@stat.wisc.edu (bates@stat.wisc.edu)
Date: Sun, 18 Jul 1999 00:16:10 +0200 (MET DST)
Subject: Use of lwd = 0, lty = 2 in segments. (PR#230)
Message-ID: <199907172216.AAA19732@pubhealth.ku.dk>

This may not be considered a bug but it is an incompatibility with S.

There was a convention in S that the graphics parameter setting 
 lwd = 0 
is supposed to use the minimum possible line width on the device.  It
is not clear what that means on modern graphics devices but there is
still code (like mine) that assumes something sensible happens with
 lwd = 0
It seems that R's postscript device driver does something reasonable
with that for some graphics functions but not others.  The abline
function seems ok but the segments function doesn't.

The following produces a PostScript output file "foo.ps" that causes
ghostscript to complain of an error.
R> postscript("foo.ps")
R> plot(1:10, 1:10, type = "n")
R> abline(h = 5, lty = 2, lwd = 0)   # works properly
R> segments(1, 1, 1, 3, lty = 2, lwd = 0)  # fails
R> dev.off()

The last part of the PostScript file is

0.75 setlinewidth
[ 3.00 3.00] 0 setdash
np
77.04 290.39 m
743.76 290.39 l
o
0.00 setlinewidth
[ 0.00 0.00] 0 setdash
np
101.73 107.87 m
101.73 199.13 l

It is the line "[ 0.00 0.00] 0 setdash" that causes the problems.

The error message from Ghostscript is

Error: /rangecheckAladdin Ghostscript: Unrecoverable error, exit code 1
 in --setdash--
Operand stack:
   --nostringval--   0
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1   3   %oparray_pop   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   2   3   %oparray_pop   --nostringval--   --nostringval--
Dictionary stack:
   --dict:874/941(G)--   --dict:0/20(G)--   --dict:75

I notice that in the C function PostScriptSetLineTexture in devPS.c,
the step lengths seem to be multiplied by something that may be the
line width before being written to the PostScript file.

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Jul 18 11:38:17 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 18 Jul 1999 12:38:17 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
 <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
 <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
 <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>
 <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
Message-ID: <14225.44697.457131.874849@elendil.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> On the system I have access to, I can compile only with
>> 
>> -D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
>> or
>> -D_ALL_SOURCE
>> 
>> In either case, we get the above.
>> 
>> I will hence use ALL_SOURCE for the time being.
>> 
>> Note that
>> 
>> > 1/0 - 1/0# NaN
>> [1]NaNQ
>> > is.nan(1/0 - 1/0)
>> [1] TRUE
>> 
>> so what is really going on here???

> Double "hmmmm"....

> Can you run this under gdb? If so, could you set a breakpoint in
> EncodeReal and step through it? 

> That'll be (roughly)

> R -d gdb
> (gdb) run
> ^C
> (gdb) break EncodeReal
> (gdb) continue
>> 1/0
> (gdb) next
> <etc.>

> I bet it never enters the "if (!R_FINITE(x))" branch as it should.
> This could happen if HAVE_FINITE and IEEE_754 are both undefined in
> Arith.h, or if finite(x) doesn't work in the IEEE way.

>> From what Martin has been telling us, AIX is using IEEE format numbers
> and arithmetic anyhow, so it should be fairly easy to fudge a better
> R_FINITE (and ISNAN too). I think we went through some of that last
> time we had R_FINITE/ISNAN and friends on the board, didn't we?
> Something pretty close to the following should work:

> #define R_FINITE(x) ({double y = x; \
> 	 *((int *) &y) & 0x7ff00000 != 0x7ff00000})

> #define ISNAN(x) ({double y = x; \
> 	*((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
> 	(*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

> Of course, that kind of code is pretty architecture dependent, etc...
> Perhaps one should first check what the status of IEEE macros in AIX
> really is.

Hmm ... I just realized that the AIX system I have access to has no gdb
(it does have dbx, but I never used it before ...).

Could anyone else try to do the above exercise?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@cmis.CSIRO.AU  Mon Jul 19 00:54:59 1999
From: Bill.Venables@cmis.CSIRO.AU (Venables, Bill (CMIS, Cleveland))
Date: Mon, 19 Jul 1999 09:54:59 +1000
Subject: vector()
Message-ID: <D16979FB73F3D11195510000F8030FB90528A1@roper.qld.cmis.csiro.au>

You might think about using structure()

fred <- structure(vector("list", length(happy)), names = names(happy))

and in fact you can add as many attributes as you like.  This seems a better
plan than tweaking vector() (where do you stop?) and maintains consistency
with S3 at this low level.

It must be said, though, this natural and innocent looking idiom that I once
used quite a lot in S3 code had nasty consequences in going from S3 to S4,
(as BDR frequently reminds me!)

Bill V.


-----Original Message-----
From: Jonathan Rougier [mailto:J.C.Rougier@durham.ac.uk]
Sent: Friday, July 16, 1999 11:13 PM
To: r-devel@stat.math.ethz.ch
Subject: vector()


Can I suggest that vector() has an additional names argument?  This would
make it more comparable with matrix() and array().  I frequently find
myself doing

	fred <- vector("list", length(happy))
	names(fred) <- names(happy)

when I would rather be doing

	fred <- vector("list", length(happy), names = names(happy))

Just a thought.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
_._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 08:18:33 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 08:18:33 +0100 (BST)
Subject: vector()
In-Reply-To: <D16979FB73F3D11195510000F8030FB90528A1@roper.qld.cmis.csiro.au>
Message-ID: <Pine.GSO.4.05.9907190817150.16539-100000@auk.stats>

On Mon, 19 Jul 1999, Venables, Bill (CMIS, Cleveland) wrote:

> You might think about using structure()
> 
> fred <- structure(vector("list", length(happy)), names = names(happy))
> 
> and in fact you can add as many attributes as you like.  This seems a better
> plan than tweaking vector() (where do you stop?) and maintains consistency
> with S3 at this low level.
> 
> It must be said, though, this natural and innocent looking idiom that I once
> used quite a lot in S3 code had nasty consequences in going from S3 to S4,
> (as BDR frequently reminds me!)

(When used for setting classes instead of class<-, that is.)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 19 08:25:09 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 19 Jul 1999 09:25:09 +0200 (CEST)
Subject: 0.65 HPUX|AIX make check
Message-ID: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>

Update (for me):

* On HPUX (cc/f77/make), make check passes the Examples but fails in
arith-true.R because

	is.infinite(.Machine$double.base ^ .Machine$double.max.exp)

gives FALSE.

Interestingly

> .Machine$double.base
[1] 2
> .Machine$double.max.exp
[1] 1024
> 2 ^ 1024
[1] 1.797693e+308
> 2 ^ 1025
[1] 1.797693e+308
> 2 ^ 2024
[1] 1.797693e+308

so I guess we need help here.

* On AIX (gcc/f77/make), make check fails in the contour example

contor> contour(x, x, z, col = "pink", add = TRUE)
Error: missing value where logical needed

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From brouard@ined.fr  Mon Jul 19 10:47:21 1999
From: brouard@ined.fr (Nicolas Brouard)
Date: Mon, 19 Jul 1999 11:47:21 +0200
Subject: R-0.64.2 on AIX
In-Reply-To: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>
Message-ID: <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>

I am new on your list...

S language source code again available and in the Public Domain was a great
hope for me.

I remember that parts of S code was written in Ratfor. Now there are still
Fortran routines. Would they stay as is? I have nothing against Fortran but
it adds another compiler which is not as available as C and which exists on
too various forms (g77, f2c at least). For example my g77 (2.7) compiler on
AIX 4.1 did not know what a "save" was.

I haven't found an history of the different sources which builds the actual
R. But looking at the sources themself gives you an idea. A former question
on this list asked for a easy access to the archives, so is there a Web
access to the archives?

I built 0.64.2 on Linux (4.1) without any difficulty (most of you work on
Linux I presume).
On AIX, ./configure used gcc and g77 and I got a working R executable
without too much difficulties.

I just received a first email from your list where
the IEEE standard of AIX was discussed; thus I presumed that my executable
is not working so well.

I am not sure to have the time necessary to compile 0.65 and to be "with
you" but at least I will look at your mailing list and give you information
on AIX if I can.

Thanks for your work. It is a big work.
When I was teaching Mathematical Demography in the Department of Statistics
of ANU for one semester in 1993 I was surprised by the overall S knowledge
of the students. Most of my exams where easily solved with S (Demography
uses a lot of data). Back to France I couldn't go as far with the students
who only had Excel. Now with the availability of R (on Windows mainly) I
will try to use it with my French students.


--
Nicolas Brouard
Institut national d'tudes dmographiques
Paris
mailto:brouard@ined.fr  http://sauvy.ined.fr/~brouard



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Jul 19 16:54:31 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 19 Jul 1999 17:54:31 +0200 (MET DST)
Subject: summary.default & is.recursive (PR#221)
Message-ID: <199907191554.RAA28084@pubhealth.ku.dk>

>>>>> On Thu, 8 Jul 1999 20:36, p.dalgaard@biostat.ku.dk said:

    PD> Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
    >> is.recursive(list(z, a=list(1:3)) )
    >> 
    >> R64.2:> [1] FALSE
    Splus3.3> [1] T

    PD> Yup, it's a bug. Cc'ed to r-bugs so that we don't forget.

    >> is.recursive(list(1,2))
    PD> [1] FALSE
    >> is.recursive(pairlist(1,2))
    PD> [1] TRUE

Now fixed.

    PD> [maybe Martin would want to add a check that is.whatever works
    PD> identically on lists and pairlists. Not is.pairlist, though...]

Added to tests/is-things.R (& .Rout.save).
Both should be in the snapshots (R-devel.tar.gz) shortly..

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul 19 17:30:34 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 19 Jul 1999 18:30:34 +0200
Subject: tseries
In-Reply-To: <XFMail.990715183012.plummer@iarc.fr> (message from Martyn
 Plummer on Thu, 15 Jul 1999 18:30:12 +0200 (CEST))
References: <XFMail.990715183012.plummer@iarc.fr>
Message-ID: <199907191630.SAA18378@sophie.ethz.ch>

>>>>> On Thu, 15 Jul 1999 18:30:12 +0200 (CEST), Martyn Plummer <plummer@iarc.fr> said:

    Martyn> On 15-Jul-99 Martin Maechler wrote:
    >> - Of course, it is *the wise thing* to use FFT for acf -- for the
    >> case of no NAs.. [and I think the NA case should be handled as well,
    >> and for small no-NA series that straightforward method will probably
    >> be faster than FFT as well ].

    Martyn> This reminds me of a request I have been meaning to make.

    Martyn> S-plus time series functions normally use only the longest
    Martyn> contiguous portion of the series with no missing values. I
    Martyn> think a good way to implement this would be to have an
    Martyn> "na.omit" method for time series, but this isn't a generic
    Martyn> function in R (It is in SPLUS 3.3). Could this be changed?

Yes.
Just committed (R-devel, i.e. pre 0.65); similarly for na.fail().

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 18:49:27 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 18:49:27 +0100 (BST)
Subject: time series in R
Message-ID: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>

Time Series functions in R
==========================

I think a good basic S-like functionality for library(ts) in base R
would include

ts class, tsp, is.ts, as.ts
plot methods
start end window frequency cycle deltat
lag diff aggregate
filter

spectrum, spec.pgram, spec.taper, cumulative periodogram, spec.ar?

ar -- at least univariate by Yule-Walker
arima -- sim, filter, mle, diag, forecast

stl


Of the first group we lack lag, deltat, cycle, filter. These are simple.
We have plot.ts, but might want lines.ts, for example.

Base R has nothing else, so I've taken a look at bats, tseries, dse
and timeslab.

bats
====

This is close to S(-PLUS) but lacks examples.
Its methods are often simple ones: it might benefit a lot from some
re-coding in C / Fortran.

It would give us 

ar.yw

acf and spectrum (spec.pgram, plot.spec).


tseries
=======

This has S-like function names, but does not, for example, accept
multiple time series in acf.  It has nice plots and nice examples.
(It would be better if the LIBNAME were tseries, when no Makefile
would be needed: as it is $(LD) should be $(SHLIBLD) and CFLAGS +=
-Wall is not a good idea being make and CC-specific.)

It would give us

acf/ccf/pacf (for acf in S)
spectrum/cross spectra/cumulative.periodogram


dse
===

As far as I can see (it is very complex) this handles state-space models,
and can handle ARMA models by converting them (approximately)
to state-space form.

dse is rather un-R-like, and did not compile for me without fixing 20
or so Fortran errors, and did not load for me even after an hour's
work fixing many more in the R code. I think the version in devel is
currently unusable, and has far, far too many conflicts. Given Paul's
claims of stability, I have spent a deeply frustrating afternoon.


timeslab
========

Rather self-contained, copyright position unclear (to me).



Suggestions:
===========

If Martyn and Adrian are agreeable, I will start a library(ts) in the
0.65 version. I will put in this:

the ts class and methods (maybe in due course these should be removed
from the base package?)

datasets from MASS, tseries

lag, deltat, cycle
filter

acf from bats, augmented by ideas from tseries.

spectrum, spec.pgram from bats  (after looking at tseries hard)
spec.taper
cpgram from MASS

ar.yw from bats  (although that probably needs to be moved to
C/Fortran, and I may special-case the univariate case to use code I
have for that).


That leaves

stl -- I believe the code for this is on netlib.

arima modelling.  I do have Fortran code for this, and will work on
  a simple R interface for it.  An elegant interface can come later.


One thing we do need to be very careful about is the odd constants
and signs that occur in time-series work. No two books I consulted
agree exactly on the definitions of the periodogram and spectrum!
I think we should follow S-PLUS unless there are compelling reasons
not to. I am bit worried that some of the fft usage actually
only computes approximations, and we need to assess how serious that is.


As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
ought to concentrate on getting the basic stuff (bats-like) in first.

How does that sound as a plan?

Brian


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul 19 21:42:09 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Jul 1999 16:42:09 -0400
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37938DA0.BBC19173@bank-banque-canada.ca>

>As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
>ought to concentrate on getting the basic stuff (bats-like) in first.
>How does that sound as a plan?

I think this is a good idea.

>ar -- at least univariate by Yule-Walker

I'd really like the multivariate one if possible. I'm quite sure ar.yw
in bats is multivariate.

>dse
Following is not important for the immediate goal, but I am surprize and
would also like to correct a couple of mis-conceptions.

>As far as I can see (it is very complex) this handles state-space
models,
>and can handle ARMA models by converting them (approximately)
>to state-space form.

No. It handles both ARMA models and state-space models without any
conversion. It can also convert between the representations. In theory
this is algebraic and not approximate, but it is of course subject to
the usual numerical approximations of computers. The tolerances I get
are typically as good as or better than the differences between Solaris
and Linux calculation. (for example, 1e-15 for differences in residuals,
with data having order of magnitude around 1.) Model roots also compare
to very tight tolerances.

>dse is rather un-R-like, and did not compile for me without fixing 20
>or so Fortran errors, and did not load for me even after an hour's
>work fixing many more in the R code.

This surprizes me very much as it has compiled for me in Solaris and
Linux since R 0.16 (although I had to compile directly into R in those
days). At one point there was a bug in the g77 compiler which caused a
problem, but that seems to be fixed now. In earlier versions of R I used
f2c, and at  one point there were some unresolved references which I
fixed (by something simple like changing ^2 to ^2.0). When I used the
Sun Fortran compiler it always worked, but I haven't used it in a long
time now.

>I think the version in devel is
>currently unusable, and has far, far too many conflicts.
The version on CRAN is fairly old (by Internet time). Although the code
has not changed much, R's installation procedures have. I am surprized
that there are conflicts, but am not surprized that there are install
problems with recent versions of R, given all the changes in the way R
installs packages.  I intend to update the CRAN version as soon as R's
installation procedures stabalize. In most respects I believe that has
happened now, but there is a pending change in the building of help
files which I have been waiting to use. I have tried to advertize that
the most recent version at <www.bank-banque-canada/pgilbert> should
install with the most recent versions of R. I guess it would be useful
to have some indication of this on CRAN. Perhaps it would be better not
to leave an old version on CRAN and instead just point to were the most
recent versions are located?

If others are having problems compiling this code please let me know.

Paul Gilbert




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon Jul 19 21:49:23 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 20 Jul 1999 08:49:23 +1200 (NZST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>

On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:

> Time Series functions in R

I agree with basically everything Brian says, and would add the
following thoughts:

    1.	Think carefully about defining interfaces before leaping
	into code.  By defining an interface independent of the
	particular code at hand we will make it easier to switch to
	new code.

    2.	Think multivariate even when implementing a function for
	univariate series.  If the interface is defined well, it
	should later be able to generalize to the multivariate case.
	I'd hate to see a second multivariate time-series package
	come along later.

    3.	On the definition question: The existing FFT implementation
	uses a particular definition for the discrete transform which
	is pretty standard.  (Edwards "Fourier Series", Brillinger
	"Time Series" etc.) Using another definition may complicate
	documentation.

    4.	The notation for ARMA models may well be the stuff that
	holy wars are made of, but my personal preference is
	    X[i] + phi[1] * X[i - 1] + ... + phi[p] * X[i - p]
	    = theta[0] + epsilon[i] + ... + theta[q] * epsilon[i - q]
	[ Man to judge: ``It was self defense - I thought he was
	  going to hit me, so I hit him first.'' ]

I'd also add a request for some flexible structural modelling code.
I've pretty much abandonded teaching ARIMA models in favour of
structural models.  (I've written some general code for this, but
there is probably better code about.  There are a couple of TOMS
algorithms for Kalman Filtering which should be checked out.)

Finally: Does anyone know Kitagawa?  He has some very nice time series
and smoothing code.  Could he be persuaded to make it available?

	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul 19 22:37:04 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Jul 1999 17:37:04 -0400
Subject: time series in R
References: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>
Message-ID: <37939A80.3BF10D12@bank-banque-canada.ca>

>    4.  The notation for ARMA models may well be the stuff that
>        holy wars are made of,
...
For this episode of the war perhaps we should stick with univariate
arima as in S, and use the same notation. For the multivariate episode I
like

A(L) y(t) = B(L) e(t) + C(L) u(t)

for ARMA models and

z(t) = F z(t-1) + G u(t) +K e(t-1)
y(t) = H z(t) + e(t)

for state-space models. I think it is important to think about
state-space and ARMA together, in order to try and have a consistent
approach.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 22:48:10 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 22:48:10 +0100 (BST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907192236250.4779-100000@auk.stats>

On Tue, 20 Jul 1999, Ross Ihaka wrote:

> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
> 
> > Time Series functions in R
> 
> I agree with basically everything Brian says, and would add the
> following thoughts:
> 
>     1.	Think carefully about defining interfaces before leaping
> 	into code.  By defining an interface independent of the
> 	particular code at hand we will make it easier to switch to
> 	new code.

Yes, but we also want (to some extent) back-compatibility with S(-PLUS).
I would like to get something in there, even if we discover it
is not right.  For example, I have been trying what is already there on
bivariate series, with a lot of surprises.

>     3.	On the definition question: The existing FFT implementation
> 	uses a particular definition for the discrete transform which
> 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> 	"Time Series" etc.) Using another definition may complicate
> 	documentation.

That's the simple part.  But what is the divisor in the periodogram? Which
way do lags go in acfs of bivariate series, and which sign is the phase for
bivariate spectra?

>     4.	The notation for ARMA models may well be the stuff that
> 	holy wars are made of, but my personal preference is
> 	    X[i] + phi[1] * X[i - 1] + ... + phi[p] * X[i - p]
> 	    = theta[0] + epsilon[i] + ... + theta[q] * epsilon[i - q]
> 	[ Man to judge: ``It was self defense - I thought he was
> 	  going to hit me, so I hit him first.'' ]

Well, that is not mine, and it is not S-PLUS's either.

I see the virtue of a grander plan, but would like to get the 
simpler parts in now. And having spent an hour writing ts.union and
ts.intersect, I realize the simpler parts are not so simple.  Bill and I
had planned a new ts package to go with V&R3, but the work seemed to
be too much (and seems to be too much before R 1.0, too).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Tue Jul 20 01:31:13 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 20 Jul 1999 12:31:13 +1200 (NZST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907192236250.4779-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9907201215490.18298-100000@stat1.stat.auckland.ac.nz>

On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:

> >     3.	On the definition question: The existing FFT implementation
> > 	uses a particular definition for the discrete transform which
> > 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> > 	"Time Series" etc.) Using another definition may complicate
> > 	documentation.
> 
> That's the simple part.  But what is the divisor in the periodogram? Which
> way do lags go in acfs of bivariate series, and which sign is the phase for
> bivariate spectra?

Once you settle the forward discrete transform much of this is settled.
No constant in the dft implies
	Periodogram = |dft|^2/(2*pi*T)
Phases in spectra also fall out if you take a +ve exponent in the dft.

I don't much mind about these choices, but its probably a good idea to
be consistent.
	
	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 02:23:09 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Mon, 19 Jul 1999 21:23:09 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "14 Jul 1999 00:12:48 EDT."
 <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907200123.VAA23498@infiniti.ece.cmu.edu>


"Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

Peter> Something pretty close to the following should work:
Peter> 
Peter> #define R_FINITE(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
Peter> 
Peter> #define ISNAN(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
see your point for the local var, but cc and gcc choke on it.

I've looked into /usr/include/fp.h which is included for AIX
platforms.  (Its version is 1.9)  There are defines for FINITE,
IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?
Does it make sense for configure to check, not only whether finite
exists but also whether it's broken?

BTW, if you step thru EncodeReal you see that !R_FINITE(x) if false
for 1/0 (i.e. 1/0 is not detected as not finite).

Here is first the C code to show what's working what's not.  (I picked
your stuff and added the calls to the macros.)  This is followed by
the output when compiled with cc and gcc.  I'm having major headaches
here with the -D_XOPEN_SOURCE_EXTENDED (details follow).  Maybe we can
dump finite in favor of FINITE?

Are  my assumptions about the return values are correct?

---> isfinite.c <---
#include <stdio.h>
#include <math.h>

#ifdef _AIX
# include <fp.h>
#endif

main() {
  double x,x2,x3;
  printf("finite(1.0)= %d (=1, hopefully)\n", finite(1.0));
  x=1./0.; x2= (-1.)/0.;  x3 = 0./0.;
  printf("Inf := 1/0 = %f;\t -Inf := -1/0 = %f;\t NaN:= 0/0 = %f\n",x,
         x2, x3);
  printf("finite(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
         finite(x),finite(x2),finite(x3));
  printf("Now the `bits':\n");
  printf(" Inf : %0x,%0x\n", ((int *) &x )[0], ((int *) &x )[1]);
  printf("-Inf : %0x,%0x\n", ((int *) &x2)[0], ((int *) &x2)[1]);
  printf(" NaN : %0x,%0x\n", ((int *) &x3)[0], ((int *) &x3)[1]);

#ifdef _AIX
  printf("FINITE(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
         FINITE(x),FINITE(x2),FINITE(x3));
  printf("IS_NAN(x), f.(x2), f.(x3): %d %d %d  (should be 0 0 1)\n",
         IS_NAN(x),IS_NAN(x2),IS_NAN(x3));
  printf("IS_INF(x), f.(x2), f.(x3): %d %d %d  (should be 1 1 0)\n",
         IS_INF(x),IS_INF(x2),IS_INF(x3));
#endif
}
---> end of isfinite.c <---

---> output <--
r-devel $ cc isfinite.c -o isfinite 2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7ff80000,0
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)
r-devel $ gcc -g -O2 isfinite.c -o isfinite 2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 1 1 1  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)
r-devel $ gcc -g -O2 isfinite.c -o isfinite -D_XOPEN_SOURCE_EXTENDED=1
2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 03:04:54 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Mon, 19 Jul 1999 22:04:54 -0400
Subject: R 0.65 and AIX: if it quacks like a duck...
Message-ID: <199907200204.WAA13374@infiniti.ece.cmu.edu>


Hi,

  this relates to R-devel of 1999/July/18.  I will outline what I had
to change to get R to compile with cc then with gcc.  Note that R
compiled with cc works, R compiled with gcc is broken.

--> Compile with cc:

1) Edit src/main/saveload.c: disable the undefine! With the #undef
_XOPEN_SOURCE_EXTENDED the compilation dies an untimely death.
(And the header files are not as badly broken for cc!)

2) Edit src/appl/sock.c: dto.

3) Edit src/unix/system.c: need a "break;" after default: in line 752
(yes, won't compile without)

4) Edit src/main/builtin.c: line 318 should read "#endif /* NOT_used */"
 (get rids of the warning)

5) CC=cc ../configure

Note this is broken for the dependency check (ld barfs the error
message to stdout instead of the log file?)
checking whether cc accepts -M for generating dependencies... ld:
0711-317 ERROR
: Undefined symbol: .main
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
no

Note 2 that configure leaves a file called "-fp-no-toc" behind.  Oops.

6) make && make check and everything looks ok.


--> Compile with gcc:

1) 2) 3) 4) like above

Additionally edit *sock.c:

5b) In appl/Rsock.c and appl/sock.c added `#include "Rconfig.h"'
(This doesn't hurt the cc compilation.)

6b) CC=gcc ../configure

Surprises:  this finds libcurses and libz.  I don't know where,
though.  So I manually remove -lreadline -lz -lcurses from the LIBS
line in Makeconf.  Note that I add my private readline with the help
of CPPFLAGS and LIBS in config.site (thanks, Kurt).

7b) edit Rconfig.h:
#ifdef __GNUC__
typedef long blkcnt_t;
#endif

Yes, I NEED this for gcc 2.8.1.  This is a gcc bug, because
gcc -I/usr/include will compile.  What I've learned is that it is
essential to verify which include files the compiler finds, these are
not always the ones in /usr/include!  Maybe configure can pick this up?

This gets you to a point where things will compile.  What remains is
the NaN and Inf problem.  I've tried to disable the finite function by
overriding the configure result (a la finite=no).  But then R core
dumps.  And uh, those ugly tick marks...

I'm afraid this all doesn't make too much sense, it's a mess.

Lemme know, if there is something you want me to try.  
-tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 20 07:22:12 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 20 Jul 1999 07:22:12 +0100 (BST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.10.9907201215490.18298-100000@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats>

On Tue, 20 Jul 1999, Ross Ihaka wrote:

> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
> 
> > >     3.	On the definition question: The existing FFT implementation
> > > 	uses a particular definition for the discrete transform which
> > > 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> > > 	"Time Series" etc.) Using another definition may complicate
> > > 	documentation.
> > 
> > That's the simple part.  But what is the divisor in the periodogram? Which
> > way do lags go in acfs of bivariate series, and which sign is the phase for
> > bivariate spectra?
> 
> Once you settle the forward discrete transform much of this is settled.

Isn't that the tail wagging the dog?

> No constant in the dft implies
> 	Periodogram = |dft|^2/(2*pi*T)

Why is the 2*pi there? It is in Bloomfield, but not Brockwell & Davis, for
example. And S-PLUS divides by the fequency to make the periodogram
estimate the spectral density.

> Phases in spectra also fall out if you take a +ve exponent in the dft.
>
But you have to decide which of series i and j gets the complex conjugate.
(Same issue with acfs: second relative to first or first relative to
second?  It's like defining `lags'.)

> I don't much mind about these choices, but its probably a good idea to
> be consistent.

Consistent with whom?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 20 07:37:27 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 20 Jul 1999 07:37:27 +0100 (BST)
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: <199907200204.WAA13374@infiniti.ece.cmu.edu>
Message-ID: <Pine.GSO.4.05.9907200725490.5672-100000@auk.stats>

On Mon, 19 Jul 1999, Thomas Vogels wrote:

> 
> Hi,
> 
>   this relates to R-devel of 1999/July/18.  I will outline what I had
> to change to get R to compile with cc then with gcc.  Note that R
> compiled with cc works, R compiled with gcc is broken.

> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
> (yes, won't compile without)

There is no longer a line 752, but this was added (by Kurt) in the current
sources (line 317). When I saw this I checked my books and all my lint-like
tools: the code I wrote does seem valid C according to all my checks.

Would just ";" satisfy your compiler?


> --> Compile with gcc:
> 
> 1) 2) 3) 4) like above

Will gcc really not accept 3) on your platform?  It does on all of mine,
in all the versions of gcc I tried. It would be a surprise for gcc's
parser to be platform-specific.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 09:50:18 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 08:50:18 +0000
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37943849.ACC16974@wu-wien.ac.at>

Prof Brian D Ripley wrote:

> Suggestions:
> ===========
>
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:

I agree with almost everything.

>
>
> the ts class and methods (maybe in due course these should be removed
> from the base package?)
>
> datasets from MASS, tseries
>
> lag, deltat, cycle
> filter
>
> acf from bats, augmented by ideas from tseries.
>
> spectrum, spec.pgram from bats  (after looking at tseries hard)

Concerning the normalization, definition of fft and so on, I just want to say how
it is done in tseries:

Periodogram: Normalizing by (2*pi*n) where n is the length of the original series,
i.e. it differs from Brockwell&Davies by the factor 2*pi. Furthermore, normalizing
by n (and not npad) preserves the shape and not the sum under/over the
periodogram. I also remove the mean before starting the main computation which
makes the correction (10.4.7) from B&D unnecessary(?).


>
> spec.taper
> cpgram from MASS
>
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

What about simple OLS estimator ar.ols?

>
>
> That leaves
>
> stl -- I believe the code for this is on netlib.
>
> arima modelling.  I do have Fortran code for this, and will work on
>   a simple R interface for it.  An elegant interface can come later.
>
>
> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.

I will wait until this first version is finished and then update the tseries
library to fit with the R ts.base library so we can use, e.g., the tests etc. What
about the name tseries. Should I change this name, so that it does not conflict
with the time series base?

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 09:57:45 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 08:57:45 +0000
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37943A08.F073CC2C@wu-wien.ac.at>

Prof Brian D Ripley wrote:

> Time Series functions in R
> ==========================
>
> I think a good basic S-like functionality for library(ts) in base R
> would include
>
> ts class, tsp, is.ts, as.ts
> plot methods
> start end window frequency cycle deltat
> lag diff aggregate
> filter
>

I forgot to suggest to add the "embed" routine from tseries to the above list? I
think it's a base routine. It works also for multivariate series and is useful for
many higher level routines.

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 10:17:51 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 11:17:51 +0200 (CEST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <XFMail.990720111751.plummer@iarc.fr>

On 19-Jul-99 Prof Brian D Ripley wrote:
> Time Series functions in R
> ==========================
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:
> 
> the ts class and methods (maybe in due course these should be removed
> from the base package?)

Some of the ts class stuff is implemented in the C code of the base
library. I'm not sure you can separate this.

I also suggested an "na.omit" method for time series - which would be
used by many of the time series functions. Martin has made na.omit()
and na.fail() generic so this is possible now.

> datasets from MASS, tseries
> 
> lag, deltat, cycle
> filter

I think there is some functional overlap between filter() and convolve(),
which now has a type="filter" option. I'm not sure convolve() needs this
if there is a filter() function.

> acf from bats, augmented by ideas from tseries.

I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
after seeing its rather embarrassing performance.

> spectrum, spec.pgram from bats  (after looking at tseries hard)

Adrian's spectrum() function allows a wider range of kernel smoothers
and it would be nice to keep this.  Since spectrum() is just a wrapper
function anyway, it should be possible to do this, while keeping the
S-PLUS compatible interface.

> spec.taper
> cpgram from MASS
> 
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

I haven't tried very hard to make my code efficient, as you can see,
concentrating instead on getting something that works like the S-PLUS
version. Much of the work involved trying to get the same answer as
S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
was doing wrong (see the COMPAT file).

I think the multivariate version would be harder to implement in C.
I will see if I can speed the R code up.

I have been looking at Burg's algorithm and I think I can implement
this now, if you want.

> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.
> 
> How does that sound as a plan?

Sounds good.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 10:22:49 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 11:22:49 +0200 (CEST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <XFMail.990720112249.plummer@iarc.fr>

On 19-Jul-99 Prof Brian D Ripley wrote:
> Time Series functions in R
> ==========================
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:
> 
> the ts class and methods (maybe in due course these should be removed
> from the base package?)

Some of the ts class stuff is implemented in the C code of the base
library. I'm not sure you can separate this.

I also suggested an "na.omit" method for time series, which would be
used by many of the time series functions. Martin has made na.omit()
and na.fail() generic so this is possible now.

> datasets from MASS, tseries
> 
> lag, deltat, cycle
> filter

I think there is some functional overlap between filter() and convolve(),
which now has a type="filter" option. I'm not sure convolve() needs this
if there is a filter() function.

> acf from bats, augmented by ideas from tseries.

I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
after seeing its rather embarrassing performance.

> spectrum, spec.pgram from bats  (after looking at tseries hard)

Adrian's spectrum() function allows a wider range of kernel smoothers
and it would be nice to keep this.  Since spectrum() is just a wrapper
function anyway, it should be possible to do this, while keeping the
S-PLUS compatible interface.

> spec.taper
> cpgram from MASS
> 
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

I haven't tried very hard to make my code efficient, as you can see,
concentrating instead on getting something that works like the S-PLUS
version. Much of the work involved trying to get the same answer as
S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
was doing wrong (see the COMPAT file).

I think the multivariate version would be harder to implement in C.
I will see if I can speed the R code up.

I have been looking at Burg's algorithm and I think I can implement
this now, if you want.

> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.
> 
> How does that sound as a plan?

Sounds good.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 20 10:32:37 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 20 Jul 1999 11:32:37 +0200
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats> (message from
 Prof Brian D Ripley on Tue, 20 Jul 1999 07:22:12 +0100 (BST))
References: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats>
Message-ID: <199907200932.LAA25315@sophie.ethz.ch>


    BDR> On Tue, 20 Jul 1999, Ross Ihaka wrote:
    >> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
    >> 
    >> > > 3. On the definition question: The existing FFT implementation >
    >> > uses a particular definition for the discrete transform which > >
    >> is pretty standard.  (Edwards "Fourier Series", Brillinger > > "Time
    >> Series" etc.) Using another definition may complicate > >
    >> documentation.
    >> > 
    >> > That's the simple part.  But what is the divisor in the
    >> periodogram? Which > way do lags go in acfs of bivariate series, and
    >> which sign is the phase for > bivariate spectra?
    >> 
    >> Once you settle the forward discrete transform much of this is
    >> settled.

    BDR> Isn't that the tail wagging the dog?

I think Ross meant to say that  fft()'s definition can't (shouldn't) be changed
anymore, and I agree on that [and that *is* S compatible anyway].

    >> No constant in the dft implies Periodogram = |dft|^2/(2*pi*T)

    BDR> Why is the 2*pi there? It is in Bloomfield, but not Brockwell &
    BDR> Davis, for example. And S-PLUS divides by the fequency to make the
    BDR> periodogram estimate the spectral density.

We have to decide if we go for S-plus compatibility here, see below.

    >> Phases in spectra also fall out if you take a +ve exponent in the
    >> dft.
    >> 
    BDR> But you have to decide which of series i and j gets the complex
    BDR> conjugate.  (Same issue with acfs: second relative to first or
    BDR> first relative to second?  It's like defining `lags'.)

    >> I don't much mind about these choices, but its probably a good idea
    >> to be consistent.

    BDR> Consistent with whom?

Mostly "with your own notation and definitions",
maybe even ``consistent with one book's author''.

I'd prefer Brockwell & Davis,
however I agree with Brian that S compatibility -- to some extent -- is a
goal here; on the other hand, S-plus uses definitions that are not widely
used in standard texts (my limited experience).

This really must must be settled now.
If nobody can show why S-plus definitions are `wrong by design' here,
I'd vote for adopting them, inspite of all...
[if only to keep V&R's chapter on time-series coherent :-)]

Something which should be discussed however is spectrum(0);
Several of us think that S-plus does the wrong thing, at least in some
cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
Another possibility would be to leave it NA
and maybe provide methods for estimating it specifically, if desired.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 20 10:50:01 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 20 Jul 1999 11:50:01 +0200
Subject: 0.65/AIX
In-Reply-To: Thomas Vogels's message of "Mon, 19 Jul 1999 21:23:09 -0400"
References: <199907200123.VAA23498@infiniti.ece.cmu.edu>
Message-ID: <x2r9m3fy5y.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:

> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> Peter> Something pretty close to the following should work:
> Peter> 
> Peter> #define R_FINITE(x) ({double y = x; \
> Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
> Peter> 
> Peter> #define ISNAN(x) ({double y = x; \
> Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
> Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}
> 
> Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
> see your point for the local var, but cc and gcc choke on it.

I take it that you fixed the missing ')' in ISNAN? Too bad. Perhaps it
can work without the local "y"? I put it in just to catch cases where
x might be in a register so that you cannot take its address.

> I've looked into /usr/include/fp.h which is included for AIX
> platforms.  (Its version is 1.9)  There are defines for FINITE,
> IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?

That would make very good sense. The code would probably have to go in
an "#if aix" type clause, but so would my suggestion.

> Does it make sense for configure to check, not only whether finite
> exists but also whether it's broken?

It certainly would.
 
> BTW, if you step thru EncodeReal you see that !R_FINITE(x) if false
> for 1/0 (i.e. 1/0 is not detected as not finite).

Yes. If you look at R_FINITE, you'll see that the logic is
essentially: If HAVE_FINITE use finite() else assume non-IEEE and only
check for the internal NA code. So if either finite() misbehaves or
doesn't exist, that will happen.

> Here is first the C code to show what's working what's not.  (I picked
> your stuff and added the calls to the macros.)  This is followed by
> the output when compiled with cc and gcc.  I'm having major headaches
> here with the -D_XOPEN_SOURCE_EXTENDED (details follow).  Maybe we can
> dump finite in favor of FINITE?
> 
> Are  my assumptions about the return values are correct?

They look fine. Would seem that only gcc without the -D_XOPENetc is
having trouble with finite() -- why? could that be a gcc bug?

What happens with isnan(), is that as buggy as finite()?

It looks quite feasible simply to put

#ifdef _AIX
	#define R_FINITE(x) FINITE(X)
	#define R_ISNAN(x)  IS_NAN(X)
#endif

or something like it in Arith.h
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Jul 20 12:10:06 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 20 Jul 1999 12:10:06 +0100 (BST)
Subject: time series in R
Message-ID: <199907201110.MAA04887@toucan.stats.ox.ac.uk>

> Date: Tue, 20 Jul 1999 11:17:51 +0200 (CEST)
> From: Martyn Plummer <plummer@iarc.fr>
> To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
> Subject: RE: time series in R
> 
> On 19-Jul-99 Prof Brian D Ripley wrote:

> > Time Series functions in R
> > ==========================
> > If Martyn and Adrian are agreeable, I will start a library(ts) in the
> > 0.65 version. I will put in this:
> > 
> > the ts class and methods (maybe in due course these should be removed
> > from the base package?)
> 
> Some of the ts class stuff is implemented in the C code of the base
> library. I'm not sure you can separate this.

Rather, in the C core of R (the base package has no C code).  I was not
intended to separate that. My aim was merely to allow some code to be
re-written without losing backwards compatibility, yet. For example,
print.ts does not do well with multiple series (and it breaks the 
cardinal rule of a print method returning its first argument unchanged).

> I also suggested an "na.omit" method for time series - which would be
> used by many of the time series functions. Martin has made na.omit()
> and na.fail() generic so this is possible now.

Good. What do you want na.omit.ts to do? 

> > filter
> 
> I think there is some functional overlap between filter() and convolve(),
> which now has a type="filter" option. I'm not sure convolve() needs this
> if there is a filter() function.

I'll take a look.

> 
> > acf from bats, augmented by ideas from tseries.
> 
> I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
> after seeing its rather embarrassing performance.

I have that. However, I am having a number of problems with it,
for example that pacf does not work, and acf does not work correctly
for multiple series.

> library(bats)
> data(presidents)
> acf(presidents, type="partial")
Error: Object "xb" not found

OK, fix that:
> acf(presidents, type="partial")
Error: NA/NaN/Inf in foreign function call (arg 1)

[The NA handling needs to be sorted out.]

A little later:

            var0 <- diag(acf[1, , ], nrow = nser)

is wrong: it gives a matrix and multivariate acfs fail. I used

            var0 <- if(nser > 1) diag(acf[1, , ]) else acf[1,1,1]

I think I will special-case the univariate code here.


> > spectrum, spec.pgram from bats  (after looking at tseries hard)
> 
> Adrian's spectrum() function allows a wider range of kernel smoothers
> and it would be nice to keep this.  Since spectrum() is just a wrapper
> function anyway, it should be possible to do this, while keeping the
> S-PLUS compatible interface.

Yes, I intend to look at that. For now, though, your code is not
giving the same results as S-PLUS, and I need to fix up at least the
confidence interval calculations.  (I think I know exactly how it
is done in S-PLUS: it uses Bloomfield's code.)  I believe that padding
needs to be optional.

> > ar.yw from bats  (although that probably needs to be moved to
> > C/Fortran, and I may special-case the univariate case to use code I
> > have for that).
> 
> I haven't tried very hard to make my code efficient, as you can see,
> concentrating instead on getting something that works like the S-PLUS
> version. Much of the work involved trying to get the same answer as
> S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
> was doing wrong (see the COMPAT file).
> 
> I think the multivariate version would be harder to implement in C.

I agree, but maybe it should be done.

> I will see if I can speed the R code up.
> 
> I have been looking at Burg's algorithm and I think I can implement
> this now, if you want.

Yes, please (even though I think it is in principle a bad idea).

> > As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> > ought to concentrate on getting the basic stuff (bats-like) in first.

Looking at where I am, that looks feasible

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 13:53:28 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 12:53:28 +0000
Subject: time series in R
Message-ID: <37947148.EB23277B@wu-wien.ac.at>

Martin Maechler wrote:

>
> Something which should be discussed however is spectrum(0);
> Several of us think that S-plus does the wrong thing, at least in some

> cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
> and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
> Another possibility would be to leave it NA
> and maybe provide methods for estimating it specifically, if desired.
>

I had a look at some of our Dep. books:

Brockwell&Davis: Periodogram normalization is n^{-1}, P(0)=0 for
demean=T.
spectrum(0) should be estimated by not using P(0) (Remark 2, p. 353). In
general
S(0) \neq 0.

Shiryaev, Probability: Per. norm. is (2*pi*n)^{-1}, P(0)=0 for demean=T.

Priestley, Spectral Analysis... : Periodogram normalization is
(n/2)^{-1}, P(0)=0
for demean=T, p. 395. For continuous spectra he defines a "modified
Periodogram",pp. 416, 417, where the normalization is as in Shiryaev.
All the
spectrum estimation is done with the mod. Period.

Hannan, Multiple Time Series: Normalization is (n/2)^{-1}.

Koopmans: Spectral Analysis of TS: Norm. is (2*pi*n)^{-1}.

It seems that (2*pi*n)^{-1} is the version which is mostly used, since
it makes no
further normalization necessary, e.g., for smoothing the periodogram.
P(0)=0 is
obvious. And \hat{spectrum}(0) = 0 is definitely a very bad estimator.

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 14:38:34 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 15:38:34 +0200 (CEST)
Subject: time series in R
In-Reply-To: <199907201110.MAA04887@toucan.stats.ox.ac.uk>
Message-ID: <XFMail.990720153834.plummer@iarc.fr>

On 20-Jul-99 Prof Brian Ripley wrote:
> 
>> I also suggested an "na.omit" method for time series - which would be
>> used by many of the time series functions. Martin has made na.omit()
>> and na.fail() generic so this is possible now.
> 
> Good. What do you want na.omit.ts to do? 

It would either
1) remove missing values only from the beginning or end of a time
   series, or
2) return the longest contiguous subseries with no missing values,
   e.g. presidents[32:110], or the first such subseries if there
   were multiple matches.
A lot of S-plus time series functions use option 1). Option 2) seems
more useful to me. There is no "na.omit.ts" in Splus 3.3 but  it
seems like a good way to implement this functionality.

>> I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
>> after seeing its rather embarrassing performance.
> 
> I have that. However, I am having a number of problems with it,
> for example that pacf does not work, and acf does not work correctly
> for multiple series.
> 
>> library(bats)
>> data(presidents)
>> acf(presidents, type="partial")
> Error: Object "xb" not found
> 
> OK, fix that:
>> acf(presidents, type="partial")
> Error: NA/NaN/Inf in foreign function call (arg 1)
> 
> [The NA handling needs to be sorted out.]

See above.

> A little later:
> 
>             var0 <- diag(acf[1, , ], nrow = nser)
> 
> is wrong: it gives a matrix and multivariate acfs fail. I used

This works for me!

> 
>             var0 <- if(nser > 1) diag(acf[1, , ]) else acf[1,1,1]
> 
> I think I will special-case the univariate code here.
> 
> 
>> > spectrum, spec.pgram from bats  (after looking at tseries hard)
>> 
>> Adrian's spectrum() function allows a wider range of kernel smoothers
>> and it would be nice to keep this.  Since spectrum() is just a wrapper
>> function anyway, it should be possible to do this, while keeping the
>> S-PLUS compatible interface.
> 
> Yes, I intend to look at that. For now, though, your code is not
> giving the same results as S-PLUS, and I need to fix up at least the
> confidence interval calculations.  (I think I know exactly how it
> is done in S-PLUS: it uses Bloomfield's code.)  

The main reason my confidence intervals are different is that I don't
have the correct expression for the degrees of freedom in the presence
of tapering (or padding, but that is trivial). Apart from that,
I deliberately chose different limits because I allow the user to
specify the coverage of the confidence interval in plot.spec, and if
one is allowed to do that, one needs to make sure that the confidence
interval contains the estimate, which would not always be the case with
the Splus behaviour.

> I believe that padding
> needs to be optional.

There seems to be two sorts of padding going on in Splus. One under
the control of the user, via the "pad" argument and the other
which is automatic, to aid the Fast Fourier Transform. I have
tried to reproduce this, but can't exactly match the Splus behaviour.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Tue Jul 20 15:26:35 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Tue, 20 Jul 1999 15:26:35 +0100 (BST)
Subject: tensor() function and sets
Message-ID: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>

Hi Everyone,

To complete the outer() and kronecker() functions in the base, may I
suggest the following tensor() function, which allows the multiplication
of arrays through sets of conformable dimensions.  I am happy to write a
help page if required. 

The code also needs a setdiff() function which prompts me to ask: what
about simple set functions?  I expect many of us have written our own
(Brian has a setdiff() in drop1.lm(), for example), which seems like a
good reason for putting versions in the base.  I would be happy to provide
mine for general scrutiny.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"setdiff" <-
function (x, y) x[!(x %in% y)]

"tensor" <-
function (A, B, da, db) 
{
    # tensor product of A and B through da and db
    no.na <- is.null(na <- dimnames(A <- as.array(A)))
    dima <- dim(A)
    no.nb <- is.null(nb <- dimnames(B <- as.array(B)))
    dimb <- dim(B)
    if (any(dima[da] != dimb[db])) 
        stop("Mismatched dimensions")
    kpa <- setdiff(seq(along = dima), da)
    kpb <- setdiff(seq(along = dimb), db)
    # fix up the dimnames (see outer)
    if (no.na && no.nb) 
        nms <- NULL
    else {
        if (no.na) 
            na <- vector("list", length(dima))
        else if (no.nb) 
            nb <- vector("list", length(dimb))
        nms <- c(na[kpa], nb[kpb])
    }
    A <- matrix(aperm(A, c(kpa, da)), ncol = prod(dima[da]))
    B <- matrix(aperm(B, c(db, kpb)), nrow = prod(dimb[db]))
    array(A %*% B, c(dima[kpa], dimb[kpb]), dimnames = nms)
}

# examples

A <- array(1:6, 2:3, list(LETTERS[1:2], LETTERS[3:5]))
B <- 1:3
tensor(A, B, 2, 1)			# same as drop(A %*% B)
A <- outer(A, B)			# A now 2 by 3 by 3
tensor(A, B, 2, 1); tensor(A, B, 3, 1)	# both 2 by 3 (nb dimnames)
B <- outer(1:2, B)			# B now 2 by 3
tensor(A, B, c(1, 3), 1:2)		# must be 3 vector
B <- outer(1:3, B)			# B now 3 by 2 by 3 
tensor(A, B, 1:3, c(2, 1, 3))		# must be a scalar
sum(A * aperm(B, c(2, 1, 3)))		# same scalar value


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 20:10:31 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 20 Jul 1999 15:10:31 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "20 Jul 1999 11:50:01 EDT."
 <x2r9m3fy5y.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907201910.PAA13352@infiniti.ece.cmu.edu>


(Note that I took the liberty of resequencing Peter's email.)

"Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

>> I've looked into /usr/include/fp.h which is included for AIX
>> platforms.  (Its version is 1.9)  There are defines for FINITE,
>> IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?

Peter> That would make very good sense. The code would probably have to go in
Peter> an "#if aix" type clause, but so would my suggestion.

Peter> It looks quite feasible simply to put
Peter> 
Peter> #ifdef _AIX
Peter> #define R_FINITE(x) FINITE(X)
Peter> #define R_ISNAN(x)  IS_NAN(X)
Peter> #endif
Peter> 
Peter> or something like it in Arith.h
 
With these changes, R crashes when compiled with gcc.  I may have
gotten something wrong with the ifdefs, however.  Shouldn't it be
possible to compile with HAVE_FINITE and HAVE_ISNAN undefined?

Peter> Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:
>> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
>> 
Peter> Something pretty close to the following should work:
Peter> 
Peter> #define R_FINITE(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
Peter> 
Peter> #define ISNAN(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}
>> 
>> Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
>> see your point for the local var, but cc and gcc choke on it.

Peter> I take it that you fixed the missing ')' in ISNAN? Too bad. Perhaps it
Peter> can work without the local "y"? I put it in just to catch cases where
Peter> x might be in a register so that you cannot take its address.

It's actually a missing semicolon before the closing brace.  Fixing it
makes it compile with gcc not cc.  (And I currently have to use cc to
get a working R.)

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 20:32:48 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 20 Jul 1999 15:32:48 -0400
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: Your message of "Tue, 20 Jul 1999 07:37:27 EDT."
 <Pine.GSO.4.05.9907200725490.5672-100000@auk.stats>
Message-ID: <199907201932.PAA13390@infiniti.ece.cmu.edu>



"Brian" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

>> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
>> (yes, won't compile without)

Brian> There is no longer a line 752, but this was added (by Kurt) in the current
Brian> sources (line 317). When I saw this I checked my books and all my lint-like
Brian> tools: the code I wrote does seem valid C according to all my checks.

Brian> Would just ";" satisfy your compiler?

Yes, I guess you can't have no statement after a case label, so either
"break;" or ";" is fine.  (K&R suggest always having a break after (at
least) the last label as a defensive porgramming strategy.)

--> Compile with gcc:
>> 
>> 1) 2) 3) 4) like above

Brian> Will gcc really not accept 3) on your platform?  It does on all of mine,
Brian> in all the versions of gcc I tried. It would be a surprise for gcc's
Brian> parser to be platform-specific.

Sorry, probably should have said: 3) doesn't hurt gcc.

 -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 21 11:19:35 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 21 Jul 1999 12:19:35 +0200
Subject: R-0.64.2 on AIX
In-Reply-To: <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>
References: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>
 <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>
Message-ID: <199907211019.MAA00723@aragorn.ci.tuwien.ac.at>

>>>>> Nicolas Brouard writes:

> I am new on your list...

> S language source code again available and in the Public Domain was a
> great hope for me.

> I remember that parts of S code was written in Ratfor. Now there are
> still Fortran routines. Would they stay as is? I have nothing against
> Fortran but it adds another compiler which is not as available as C
> and which exists on too various forms (g77, f2c at least). For example
> my g77 (2.7) compiler on AIX 4.1 did not know what a "save" was.

That's a long story, and I should maybe add something on this to my FAQ
eventually.  In a nutshell, the point was that whereas we could use f2c
for creating a C-only version and provide the necessary run-time version
of libf2c along with the base R distribution, the problem is that MANY
add-on packages, in particular the ones that can be ported from statlib
S versions, but also others, come with Fortran sources.  So eventually,
you either need a full-featured Fortran compiler or all of f2c.

And this is what we have now.

> ...

> I am not sure to have the time necessary to compile 0.65 and to be
> "with you" but at least I will look at your mailing list and give you
> information on AIX if I can.

That would be great.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 21 11:19:36 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 21 Jul 1999 12:19:36 +0200
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: <199907200204.WAA13374@infiniti.ece.cmu.edu>
References: <199907200204.WAA13374@infiniti.ece.cmu.edu>
Message-ID: <199907211019.MAA00733@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> Hi,

>   this relates to R-devel of 1999/July/18.  I will outline what I had
> to change to get R to compile with cc then with gcc.  Note that R
> compiled with cc works, R compiled with gcc is broken.

> --> Compile with cc:

> 1) Edit src/main/saveload.c: disable the undefine! With the #undef
> _XOPEN_SOURCE_EXTENDED the compilation dies an untimely death.
> (And the header files are not as badly broken for cc!)

> 2) Edit src/appl/sock.c: dto.

Done.

> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
> (yes, won't compile without)

Already taken care of

> 4) Edit src/main/builtin.c: line 318 should read "#endif /* NOT_used */"
>  (get rids of the warning)

???

> 5) CC=cc ../configure

> Note this is broken for the dependency check (ld barfs the error
> message to stdout instead of the log file?)
> checking whether cc accepts -M for generating dependencies... ld:
> 0711-317 ERROR
> : Undefined symbol: .main
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> no

Fixed, hopefully.

> Note 2 that configure leaves a file called "-fp-no-toc" behind.  Oops.

???

> 6) make && make check and everything looks ok.


> --> Compile with gcc:

> 1) 2) 3) 4) like above

> Additionally edit *sock.c:

> 5b) In appl/Rsock.c and appl/sock.c added `#include "Rconfig.h"'
> (This doesn't hurt the cc compilation.)

> 6b) CC=gcc ../configure

> Surprises:  this finds libcurses and libz.  I don't know where,
> though.  So I manually remove -lreadline -lz -lcurses from the LIBS
> line in Makeconf.  Note that I add my private readline with the help
> of CPPFLAGS and LIBS in config.site (thanks, Kurt).

:-)

> 7b) edit Rconfig.h:
> #ifdef __GNUC__
> typedef long blkcnt_t;
> #endif

> Yes, I NEED this for gcc 2.8.1.  This is a gcc bug, because gcc
> -I/usr/include will compile.  What I've learned is that it is
> essential to verify which include files the compiler finds, these are
> not always the ones in /usr/include!  Maybe configure can pick this
> up?

It does now.

> This gets you to a point where things will compile.  What remains is
> the NaN and Inf problem.  I've tried to disable the finite function by
> overriding the configure result (a la finite=no).  But then R core
> dumps.  And uh, those ugly tick marks...

> I'm afraid this all doesn't make too much sense, it's a mess.

> Lemme know, if there is something you want me to try.  

Work in progress ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 21 17:44:18 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 21 Jul 1999 18:44:18 +0200
Subject: tensor() function and sets
In-Reply-To: <Pine.GSO.3.96.990720143125.9359C-100000@laplace> (message from
 Jonathan Rougier on Tue, 20 Jul 1999 15:26:35 +0100 (BST))
References: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>
Message-ID: <199907211644.SAA01631@sophie.ethz.ch>

>>>>> On Tue, 20 Jul 1999 15:26:35 +0100 (BST), Jonathan Rougier <J.C.Rougier@durham.ac.uk> said:


    JonR> Hi Everyone,

    JonR> To complete the outer() and kronecker() functions in the base, may I
    JonR> suggest the following tensor() function, which allows the multiplication
    JonR> of arrays through sets of conformable dimensions.  I am happy to write a
    JonR> help page if required. 


    JonR> The code also needs a setdiff() function which prompts me to ask:
    JonR> what about simple set functions?  I expect many of us have written our own
    JonR> (Brian has a setdiff() in drop1.lm(), for example), which seems like a
    JonR> good reason for putting versions in the base.  I would be happy to provide
    JonR> mine for general scrutiny.

Actually your version of "setdiff" is in  
example("%in%")

    "%w/o%" <- function(x,y) x[!x %in% y] #--  x without y

Maybe we should make this part of core R, since it allows the nicer syntax
 (1:10) %w/o% c(3,7,12).

One problem with all these might be that you forget to think about efficiency 
{ %w/o% -> %in% -> match(.) }
but that might be ok.

    union
and
    intersect
are two other set functions, the first of which is also contained in
example(match) { == example("%in%") }:
    intersect <- function(x, y) y[match(x, y, nomatch = 0)]

What do others think?  Should (some of) these be put into "core R" ?


    JonR> Jonathan Rougier                       Science Laboratories
    JonR> Department of Mathematical Sciences    South Road
    JonR> University of Durham                   Durham DH1 3LE

    JonR> "setdiff" <-
    JonR> function (x, y) x[!(x %in% y)]

    JonR> "tensor" <-
    JonR> function (A, B, da, db) 
    JonR> {
    JonR> # tensor product of A and B through da and db
    JonR> no.na <- is.null(na <- dimnames(A <- as.array(A)))
    JonR> dima <- dim(A)
    JonR> no.nb <- is.null(nb <- dimnames(B <- as.array(B)))
    JonR> dimb <- dim(B)
    JonR> if (any(dima[da] != dimb[db])) 
    JonR> stop("Mismatched dimensions")
    JonR> kpa <- setdiff(seq(along = dima), da)
    JonR> kpb <- setdiff(seq(along = dimb), db)
    JonR> # fix up the dimnames (see outer)
    JonR> if (no.na && no.nb) 
    JonR> nms <- NULL
    JonR> else {
    JonR> if (no.na) 
    JonR> na <- vector("list", length(dima))
    JonR> else if (no.nb) 
    JonR> nb <- vector("list", length(dimb))
    JonR> nms <- c(na[kpa], nb[kpb])
    JonR> }
    JonR> A <- matrix(aperm(A, c(kpa, da)), ncol = prod(dima[da]))
    JonR> B <- matrix(aperm(B, c(db, kpb)), nrow = prod(dimb[db]))
    JonR> array(A %*% B, c(dima[kpa], dimb[kpb]), dimnames = nms)
    JonR> }

    JonR> # examples

    JonR> A <- array(1:6, 2:3, list(LETTERS[1:2], LETTERS[3:5]))
    JonR> B <- 1:3
    JonR> tensor(A, B, 2, 1)			# same as drop(A %*% B)
    JonR> A <- outer(A, B)			# A now 2 by 3 by 3
    JonR> tensor(A, B, 2, 1); tensor(A, B, 3, 1)	# both 2 by 3 (nb dimnames)
    JonR> B <- outer(1:2, B)			# B now 2 by 3
    JonR> tensor(A, B, c(1, 3), 1:2)		# must be 3 vector
    JonR> B <- outer(1:3, B)			# B now 3 by 2 by 3 
    JonR> tensor(A, B, 1:3, c(2, 1, 3))		# must be a scalar
    JonR> sum(A * aperm(B, c(2, 1, 3)))		# same scalar value

Looks interesting, however is it really useful
{for doing statistics, graphics, numerical computing, I mean} ?

Yes, if you'd provide a *.Rd help file  (use  ``prompt(tensor)''),
we'd be even more inclined to include the tensor function....
Also, I'd like to see a "real" use for it.

Is
	tensor(A, B, 1:3, c(2, 1, 3))
really easier than
        sum(A * aperm(B, c(2, 1, 3)))		

[probably yes, you have to think less, but still:
 couldn't  "da" and "db" (3rd and 4th arg) get reasonable default values ?]

----
Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 21 17:54:13 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 21 Jul 1999 18:54:13 +0200
Subject: tensor() function and sets
In-Reply-To: <199907211644.SAA01631@sophie.ethz.ch> (message from Martin
 Maechler on Wed, 21 Jul 1999 18:44:18 +0200)
References: <Pine.GSO.3.96.990720143125.9359C-100000@laplace> <199907211644.SAA01631@sophie.ethz.ch>
Message-ID: <199907211654.SAA01640@sophie.ethz.ch>

Excuse me Jonathan,
after looking a bit longer at your examples and some thinking,
I'm now quite convinced that  your tensor() function *IS* useful for us
and comes quite handy in several cases.
{real S/R hackers doing all this in their sleep, but most of us
 are not "real S/R hackers" in this sense ...}

I think it still would be nice to have reasonable default arguments da & db.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Wed Jul 21 18:34:36 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Wed, 21 Jul 1999 18:34:36 +0100 (BST)
Subject: tensor() function and sets
In-Reply-To: <199907211654.SAA01640@sophie.ethz.ch>
Message-ID: <Pine.GSO.3.96.990721181220.10355C-100000@laplace>

Hi Martin,

> after looking a bit longer at your examples and some thinking,
> I'm now quite convinced that  your tensor() function *IS* useful for us
> and comes quite handy in several cases.
> {real S/R hackers doing all this in their sleep, but most of us
>  are not "real S/R hackers" in this sense ...}

Well, I wrote it because I have to use it all the time!  A lot of the work
of our group at Durham involves means and variances of arrays rather than
vectors. I spent some time unzipping all the arrays into vectors and then
using matrix operations (hence I wrote the kronecker() function), before I
realised that the natural thing to do was to work in tensors and think of
variances as following from the expectations of outer products. 

> I think it still would be nice to have reasonable default arguments da & db.

I did consider this, but bitter experience has taught me to be
conservative and always specify explicitly the extents through which the
outer product collapses.  I think it is important to know and state
exactly what is required in these operations.  Furthermore, as I look
through the calculations I have done recently, no obvious pattern that
might be a reasonable default emerges.  However, I am open suggestions! 
In the meantime, I'll write a help page for the function as it stands
tomorrow morning and send it on to you. 

Regarding sets, might I suggest that if included in the base then
intersect() might be generalised to arbitrary numbers of arguments.  You
will probably howl with anguish at the recursion, but I use

"intersect" <-
function(x, ...)
    if (nargs() == 1) x else x[x %in% Recall(...)]

which seems to be effective.  

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Thu Jul 22 00:59:00 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Thu, 22 Jul 1999 01:59:00 +0200 (MET DST)
Subject: reluctant to read win95 directory (PR#231)
Message-ID: <199907212359.BAA14750@pubhealth.ku.dk>



Using rw0642 under win95, on executing from a directory on the c: drive:

   system("command.com /c dir", intern=T)

there is a whirring from drive a: (empty), then the message appears in a 
dos box:

   General failure reading device aLP!!?
   Abort, Retry, Fail?

Repeating the command a few times finally results in success with no 
whirring, after which there are no failures (even after restarting R) 
until the computer is rebooted. 

The computer is on a TCP/IP network with slow automounting, though the c:
drive is of course local.  It is set to try booting first from drive a:.

Could this be a timeout problem which could be fixed either in R or with
some setting in win95?

Thanks for R

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul 22 01:29:57 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 22 Jul 1999 02:29:57 +0200
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: John.Peters@tip.csiro.au's message of "Thu, 22 Jul 1999 01:59:00 +0200 (MET DST)"
References: <199907212359.BAA14750@pubhealth.ku.dk>
Message-ID: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk>

John.Peters@tip.csiro.au writes:

> Using rw0642 under win95, on executing from a directory on the c: drive:
> 
>    system("command.com /c dir", intern=T)
> 
> there is a whirring from drive a: (empty), then the message appears in a 
> dos box:
> 
>    General failure reading device aLP!!?
>    Abort, Retry, Fail?

Not that I know anything about Windows, but is there a chance that the
machine goes looking for command.com on the diskette? I.e. you want
c:\\windows\\command.com instead.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Thu Jul 22 06:17:43 1999
From: John.Peters@tip.csiro.au (John Peters)
Date: Thu, 22 Jul 1999 15:17:43 +1000 (EST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk> from Peter Dalgaard BSA at "Jul 22, 99 02:29:57 am"
Message-ID: <199907220517.PAA06830@dylan.tip.CSIRO.AU>

Peter Dalgaard BSA writes:

> John.Peters@tip.csiro.au writes:
> 
> > Using rw0642 under win95, on executing from a directory on the c: drive:
> > 
> >    system("command.com /c dir", intern=T)
> > 
> > there is a whirring from drive a: (empty), then the message appears in a 
> > dos box:
> > 
> >    General failure reading device aLP!!?
> >    Abort, Retry, Fail?
> 
> Not that I know anything about Windows, but is there a chance that the
> machine goes looking for command.com on the diskette? I.e. you want
> c:\\windows\\command.com instead.


I'm afraid not.  Even 

  system("c:\\windows\\command.com /c dir c:",intern=T)

behaves the same, ie fails several times with the above message, then 
works fine until the next reboot.  A further detail: the whirring on 
drive a: only occurs on the first attempt; thereafter the drive is silent 
as if the result is cached.

Maybe also relevant:

1. I'm starting R from a desktop shortcut with the opening directory 
   named in the "Start in:" box.  Exercising the R pulldown "File - 
   Change dir" doesn't help.
      
2. This also happened with rw0641, but not in an earlier version (not sure 
   which).

Thanks

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 22 07:43:02 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 22 Jul 1999 07:43:02 +0100 (BST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907220736550.3797-100000@auk.stats>

Why was this a bug report?  It does not seem to me to meet the requirements
of a bug given in the R FAQ.

On 22 Jul 1999, Peter Dalgaard BSA wrote:

> John.Peters@tip.csiro.au writes:
> 
> > Using rw0642 under win95, on executing from a directory on the c: drive:
> > 
> >    system("command.com /c dir", intern=T)
> > 
> > there is a whirring from drive a: (empty), then the message appears in a 
> > dos box:
> > 
> >    General failure reading device aLP!!?
> >    Abort, Retry, Fail?
> 
> Not that I know anything about Windows, but is there a chance that the
> machine goes looking for command.com on the diskette? I.e. you want
> c:\\windows\\command.com instead.

Not on my machine: that command works for me.

What do you (John) expect this command to do? In particular, what directory
does you expect it to list?  You have not told it, and Windows has quite
complicated rules for finding the current working directory. My guess
is that those rules are giving a: in your circumstances. Put a floppy
in and find out.

Tip:  using shell() would be much simpler. Try ?shell (on Windows only).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 22 08:56:44 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 22 Jul 1999 09:56:44 +0200 (CEST)
Subject: tensor() function and sets
In-Reply-To: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>
Message-ID: <XFMail.990722095644.plummer@iarc.fr>

On 20-Jul-99 Jonathan Rougier wrote:
> Hi Everyone,
> 
> To complete the outer() and kronecker() functions in the base, may I
> suggest the following tensor() function, which allows the multiplication
> of arrays through sets of conformable dimensions.  I am happy to write a
> help page if required. 

I have some code that could certainly be tidied up with the tensor()
function [1], but I wonder if "tensor" is the right name.
1) I would expect a function called "tensor" to construct a tensor object
   rather than multiply two arrays together.
2) The arguments aren't tensors. They are arrays.

How fast is it? It would be _really_ nice if this were done efficiently
in C code.

Martyn

[1] ar.yw in the "bats" package. I was just looking at this wondering how
    to speed it up before rewriting the whole thing in C or Fortran.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 22 11:26:41 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 22 Jul 1999 12:26:41 +0200 (CEST)
Subject: time series in R
In-Reply-To: <199907200932.LAA25315@sophie.ethz.ch>
Message-ID: <XFMail.990722122641.plummer@iarc.fr>

On 20-Jul-99 Martin Maechler wrote:
> 
> Something which should be discussed however is spectrum(0);
> Several of us think that S-plus does the wrong thing, at least in some
> cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
> and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
> Another possibility would be to leave it NA

[I'm repeating some private discussions with Martin here]

In my version of spec.pgram(), I chose to ignore frequency zero. This
seemed like the right thing to do since the periodogram at zero does
not estimate the spectral density at zero, but is a function of the
mean. It does not make much sense to use this value when smoothing the
periodogram to estimate frequencies near zero. This remains true if you
decide to set periodogram(0)=0.

> and maybe provide methods for estimating it specifically, if desired.

I'm going to do this in the next version of the coda package.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Thu Jul 22 10:11:50 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Thu, 22 Jul 1999 10:11:50 +0100 (BST)
Subject: tensor() function and sets
In-Reply-To: <XFMail.990722095644.plummer@iarc.fr>
Message-ID: <Pine.GSO.3.96.990722094020.10355D-100000@laplace>

On Thu, 22 Jul 1999, Martyn Plummer wrote:

> I have some code that could certainly be tidied up with the tensor()
> function [1], but I wonder if "tensor" is the right name.
> 1) I would expect a function called "tensor" to construct a tensor object
>    rather than multiply two arrays together.
> 2) The arguments aren't tensors. They are arrays.

You are right of course!  I used the name `tensor' because in my notation
I use the tensor convention of summing over repeated indices.  Hence the
arguments da and db in the function are matched pairs of repeated indices.
But the name `aprod' would do just as well (it's rather unattractive
though!).

> How fast is it? It would be _really_ nice if this were done efficiently
> in C code.

It's reasonably fast as is, because it is just two aperms (which may be
degenerate) on top of a matrix product.  We are about to do some large
calculations which are extensively `tensorised' -- the largest object will
be the variance of a 100 by 100 by 10 array, which we have to divide into
5000 operations on 100 by 10 by 100 by 10 arrays (this will take hours
rather than minutes): oh for a sparse array class!  In case you are
wondering, our work is on prediction for large physical systems, eg oil
reservoirs, the weather, contaminated ground water plumes. 

But you could definitely argue that `aprod' is the primitive operation
that should be realised in C code, and then A %*% B is simply aprod(A, B,
2, 1) and outer(A, B, "*") could be aprod(A, B, NULL, NULL). 

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul 23 08:15:03 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 23 Jul 1999 09:15:03 +0200
Subject: lapply( *, names) -- bug ?!
Message-ID: <199907230715.JAA04888@sophie.ethz.ch>

This came on S-news

The more direct test being

sapply(c(a=1,b=2), names)

Problem:  
	  R ("all" versions) 
	  behaves the same as S+5.1, which is wrong IMO.

{since some might disagree,  I didn't yet post to R-bugs ..}

------- Start of forwarded message -------
Date: Thu, 22 Jul 1999 23:14:57 -0230
From: "Paul Y. Peng" <ypeng@math.mun.ca>
To: s-news <s-news@wubios.wustl.edu>
Subject: [S] Feature or bug?

In S-PLUS 3.3 (DEC Alpha) and S-PLUS 2000,

> z <- c("a"=1, "b"=2)
> lapply(z, function(x)names(x))
$a:
[1] "a"

$b:
[1] "b"

But in S-PLUS 5.1 (Linux),

> z <- c("a"=1, "b"=2)
> lapply(z, function(x)names(x))
$a:
NULL

$b:
NULL

Is this a new feature of S-PLUS 5? Do I miss anything in
S-PLUS 5? Thank you for your help.
------- End of forwarded message -------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Jul 23 08:28:35 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 23 Jul 1999 08:28:35 +0100 (BST)
Subject: lapply( *, names) -- bug ?!
In-Reply-To: <199907230715.JAA04888@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats>

On Fri, 23 Jul 1999, Martin Maechler wrote:

> This came on S-news
> 
> The more direct test being
> 
> sapply(c(a=1,b=2), names)
> 
> Problem:  
> 	  R ("all" versions) 
> 	  behaves the same as S+5.1, which is wrong IMO.
> 
> {since some might disagree,  I didn't yet post to R-bugs ..}

I do.  the argument is not a list, and lapply applies to lists. So
> as.list(c(a=1,b=2))
$a
[1] 1

$b
[1] 2

Fine. Note the names of the components are NULL.


> 
> ------- Start of forwarded message -------
> Date: Thu, 22 Jul 1999 23:14:57 -0230
> From: "Paul Y. Peng" <ypeng@math.mun.ca>
> To: s-news <s-news@wubios.wustl.edu>
> Subject: [S] Feature or bug?
> 
> In S-PLUS 3.3 (DEC Alpha) and S-PLUS 2000,
> 
> > z <- c("a"=1, "b"=2)
> > lapply(z, function(x)names(x))
> $a:
> [1] "a"
> 
> $b:
> [1] "b"
> 
> But in S-PLUS 5.1 (Linux),
> 
> > z <- c("a"=1, "b"=2)
> > lapply(z, function(x)names(x))
> $a:
> NULL
> 
> $b:
> NULL
> 
> Is this a new feature of S-PLUS 5? Do I miss anything in
> S-PLUS 5? Thank you for your help.
> ------- End of forwarded message -------
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul 23 08:44:12 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 23 Jul 1999 09:44:12 +0200
Subject: lapply( *, names) -- bug ?!
In-Reply-To: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats> (message
 from Prof Brian D Ripley on Fri, 23 Jul 1999 08:28:35 +0100 (BST))
References: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats>
Message-ID: <199907230744.JAA05728@sophie.ethz.ch>

>>>>> On Fri, 23 Jul 1999 08:28:35 +0100 (BST), Prof Brian D Ripley <ripley@stats.ox.ac.uk> said:

    BDR> On Fri, 23 Jul 1999, Martin Maechler wrote:
    >> This came on S-news
    >> 
    >> The more direct test being
    >> 
    >> sapply(c(a=1,b=2), names)
    >> 
    >> Problem:  
    >> R ("all" versions) 
    >> behaves the same as S+5.1, which is wrong IMO.
    >> 
    >> {since some might disagree,  I didn't yet post to R-bugs ..}

    BDR> I do.  the argument is not a list, and lapply applies to lists.
that was not the point;
lapply() and sapply() are supposed to coerce to list()
    BDR> So
    >> as.list(c(a=1,b=2))
    BDR> $a
    BDR> [1] 1

    BDR> $b
    BDR> [1] 2

    BDR> Fine. Note the names of the components are NULL.

Yes, exactly.  

And therefore lapply(*, names) {or sapply(..)} should return NULLs
as it does [in R and S+5.x].
I was wrong all along.
It seems I need a longer warm-up time for my brain today...

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Fri Jul 23 09:51:48 1999
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 23 Jul 1999 18:51:48 +1000 (EST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <Pine.GSO.4.05.9907220736550.3797-100000@auk.stats> from Prof Brian D Ripley at "Jul 22, 99 07:43:02 am"
Message-ID: <199907230851.SAA05406@dylan.tip.CSIRO.AU>

Prof Brian D Ripley writes:

> Why was this a bug report?  It does not seem to me to meet the requirements
> of a bug given in the R FAQ.
> 
> On 22 Jul 1999, Peter Dalgaard BSA wrote:
> 
> > John.Peters@tip.csiro.au writes:
> > 
> > > Using rw0642 under win95, on executing from a directory on the c: drive:
> > > 
> > >    system("command.com /c dir", intern=T)
> > > 
> > > there is a whirring from drive a: (empty), then the message appears in a 
> > > dos box:
> > > 
> > >    General failure reading device aLP!!?
> > >    Abort, Retry, Fail?
> > 
> > Not that I know anything about Windows, but is there a chance that the
> > machine goes looking for command.com on the diskette? I.e. you want
> > c:\\windows\\command.com instead.
> 
> Not on my machine: that command works for me.
> 
> What do you (John) expect this command to do? In particular, what directory
> does you expect it to list?  You have not told it, and Windows has quite
> complicated rules for finding the current working directory. My guess
> is that those rules are giving a: in your circumstances. Put a floppy
> in and find out.
> 
> Tip:  using shell() would be much simpler. Try ?shell (on Windows only).


Firstly a workaround (fix?):

Disable McAfee VirusScan 4.0.2/4.0.4032.  If this means it could 
be described as more an incompatibility than a bug I apologise. 


Secondly to respond to the comments and suggestions (McAfee enabled):

What do I expect this command to do:
To read the names of the files in the current directory for assignment 
to a vector.  By current directory I mean the one named in the win95 
shortcut "Start in:" box, which is also the one initially offered by the 
Rgui pull down "File - Change dir".  It succeeds in this, but not on the 
first attempt.

Put a floppy in drive a:
Less whirring, but same result.  Hitting "a" gives the behaviour I 
described.  Hitting "f" succeeds after a few tries, but next time again 
needs a few tries before succeeding.  So far it seems exactly four "f"s 
or three "a"s are required.

Try shell():
Both the following cause the same behaviour as with "system()":
  shell("dir c:\\tmp\\9907","c:\\windows\\command.com",intern=T)
  shell("dir","command.com",intern=T)

Many thanks

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Jul 23 13:22:07 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 23 Jul 1999 14:22:07 +0200 (MET DST)
Subject: reluctant to read win95 directory (PR#231)
Message-ID: <199907231222.OAA26619@pubhealth.ku.dk>

On Fri, 23 Jul 1999, John Peters wrote:

> Firstly a workaround (fix?):
> 
> Disable McAfee VirusScan 4.0.2/4.0.4032.  If this means it could 
> be described as more an incompatibility than a bug I apologise. 

Yes, I would put that down to a system problem. The reason for being 
picky is that bug reports need to be written up, ...

It looks to me as if McAfee has replaced the Windows `search for
executables' routine and uses that to go for a virus search.
Not much we can do about that.


> Try shell():
> Both the following cause the same behaviour as with "system()":
>   shell("dir c:\\tmp\\9907","c:\\windows\\command.com",intern=T)
>   shell("dir","command.com",intern=T)


It will do as it too has to search for an executable.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 23 14:18:03 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 23 Jul 1999 15:18:03 +0200 (CEST)
Subject: 0.65 HPUX/AIX update
Message-ID: <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>

The current situation is as follows.

AIX:

* I still need f77 for linking.  Using ld with the suggested flags gives
  a binary with `exec format error'.  The problem seems to be with an
  unreferenced __start.

* The floating point (finite|isnan) stuff is strange, but under control,
  I think.  Plain cc works, gcc has a problem and seems to need having
  prototypes turned off for IEEE fp.  (More below.)

* Apart from that, make check goes all the way through at least for me
  under both cc/f77/make and gcc/f77/make.

HPUX:

* make check fails in arith-true.R.  The problem is that

        is.infinite(.Machine$double.base ^ .Machine$double.max.exp)

gives FALSE.

Interestingly

> .Machine$double.base
[1] 2
> .Machine$double.max.exp
[1] 1024
> 2 ^ 1024
[1] 1.797693e+308
> 2 ^ 1025
[1] 1.797693e+308
> 2 ^ 2024
[1] 1.797693e+308

****

Here are some observations re IEEE fp.  I have the following small test
program:

#include <math.h>
#include <stdio.h>

main () {
    printf("1/0: %lf 0/0: %lf\n", 1./0., 0./0.);
    printf("finite(1/0): %d\n", finite(1./0.));
    printf("isnan(0/0): %d\n", isnan(0./0.));
    printf("log(0.): %lf\n", log(0.));
    return(0);
}

Under Linux, this gives:

1/0: Inf 0/0: NaN
finite(1/0): 0
isnan(0/0): -1
log(0.): -Inf

Under HPUX:

1/0: ++.000000 0/0: ?.000000
finite(1/0): 0
isnan(0/0): 1
log(0.): -179769313486231571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.000000

This is also why log(0) is broken on HPUX.  See also the above why make
check fails.  However, the finite and isnan test is o.k.

Under AIX with cc:

1/0: INF 0/0: NaNQ
finite(1/0): 0
isnan(0/0): 1
log(0.): -INF

Under AIX with gcc:

1/0: INF 0/0: NaNQ
finite(1/0): 1
isnan(0/0): 1
log(0.): -INF

So there is a problem in the finite() test with gcc.  It somehow is
related to the use of ANSI C prototypes, and disappears if we define
_NO_PROTO.  I am in the process of adding this as a short term fix, but
we should think a bit more about that.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Jul 23 21:44:43 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Fri, 23 Jul 1999 16:44:43 -0400
Subject: 0.65 HPUX/AIX update
In-Reply-To: Your message of "Fri, 23 Jul 1999 15:18:03 EDT."
 <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>
Message-ID: <199907232044.QAA20966@infiniti.ece.cmu.edu>


Kurt,

  thanks for the changes.  I've downloaded the snapshot on July 22.
It looks like we are in good shape now for AIX:

"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

Kurt> The current situation is as follows.
Kurt> 
Kurt> AIX:
Kurt> 
Kurt> * I still need f77 for linking.  Using ld with the suggested flags gives
Kurt> a binary with `exec format error'.  The problem seems to be with an
Kurt> unreferenced __start.

I apologize for not seeing this earlier: "__start" is defined in
/lib/crt0.o.  So all you have to do is add /lib/crt0.o to the objects
when linking.  (You have to look carefully for that in the output from
gcc --verbose anything.o to learn what gcc is doing when linking an executable.)

Kurt> * The floating point (finite|isnan) stuff is strange, but under control,
Kurt> I think.  Plain cc works, gcc has a problem and seems to need having
Kurt> prototypes turned off for IEEE fp.  (More below.)

Quick fix and insanity check:  Add the following lines at the end of Arith.h
  #include <fp.h>
  static int finite (double x) {
        return FINITE (x);
  }
This will generate lots of warnings.  The resulting executable
(compiled with gcc) works wrt Inf and NaN!  My current assumption is
that there is a bug in gcc that generates the wrong inline version of
finite.  Overwriting it solves the problem.  A better fix would be to
ensure that finite is never called when configure finds that it is
buggy.  (I believe that the issue whether finite () exists is a
separate one.  So there should be two flags, like HAVE_FINITE and
HAVE_FINITE_THAT_STINKS... )

Kurt> So there is a problem in the finite() test with gcc.  It somehow is
Kurt> related to the use of ANSI C prototypes, and disappears if we define
Kurt> _NO_PROTO.  I am in the process of adding this as a short term fix, but
Kurt> we should think a bit more about that.

  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Mon Jul 26 03:41:12 1999
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Mon, 26 Jul 1999 04:41:12 +0200 (MET DST)
Subject: Bug in inequalities involving ordered factors (PR#232)
Message-ID: <199907260241.EAA04232@pubhealth.ku.dk>

> stress.level<-rep(c("low","medium","high"),2)
> ordf.stress<-ordered(stress.level, levels=c("low","medium","high"))
> ordf.stress
[1] low    medium high   low    medium high  
Levels:  low < medium < high 
> ordf.stress >= "medium"
[1] FALSE  TRUE FALSE FALSE  TRUE FALSE

#### Clearly the third and sixth values should be TRUE

--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Windows 9x 4.0 (build 1111)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon Jul 26 05:34:33 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 26 Jul 1999 16:34:33 +1200 (NZST)
Subject: Bug in inequalities involving ordered factors (PR#232)
Message-ID: <199907260434.QAA20417@stat1.stat.auckland.ac.nz>

Here is a QuickFix (TM) which probably needs more careful thought.
(It looks like Ops.ordered has only been partially implemented).

Ops.ordered <-
function (e1, e2)
{
    nas <- is.na(e1) | is.na(e2)
    ord1 <- FALSE
    ord2 <- FALSE
    if (nchar(.Method[1])) {
        l1 <- levels(e1)
        ord1 <- TRUE
    }
    if (nchar(.Method[2])) {
        l2 <- levels(e2)
        ord2 <- TRUE
    }
    if (all(nchar(.Method)) && (length(l1) != length(l2) ||
        !all(sort(l2) == sort(l1))))
        stop("Level sets of factors are different")
    if (ord1 && ord2) {
        e1 <- codes(e1)
        e2 <- codes(e2)
    }
    else if (!ord1) {
        e1 <- match(e1, l2)
        e2 <- codes(e2)
    }
    else if (!ord2) {
        e2 <- match(e2, l1)
        e1 <- codes(e1)
    }
    value <- get(.Generic, mode = "function")(e1, e2)
    value[nas] <- NA
    value
}

I have committed this in the development version, but it probably needs
more thought than I have time for at present.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Mon Jul 26 08:45:18 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Mon, 26 Jul 1999 15:45:18 +0800 (SST)
Subject: ESRI Shapefile reader (help with dlls)
Message-ID: <199907260745.PAA31048@decunx.iscs.nus.sg>

Hi,
I am working on a library of map functions for R and I have started
with code to read shapefiles (the format is not great but it is ubiquitous).
I am not a windows person, but where I am working I don't have access to
any UNIX machines easily. So here's the problem I wrote C code to read
the information out of the shapefile header and I compiled it using
the script given in Ripley and Veneables programming compliments for 
Cygwin tools. It seemed to work, however when I tried calling it from R
it didn't work (couldn't find the symbol).

here's what happend

> version
           _         
platform   Windows   
arch       x86       
os         Win32     
system     x86, Win32
status               
status.rev 0         
major      0         
minor      64.2      
year       1999      
month      July      
day        3         
language   R         
> dyn.load("D:/Nicholas/shapelib-1.2.5/Sshpopen.dll")
> read.shape("D:\Nicholas\jstuff\Geotools\examples\publands")
Error in .C("SHPOpen", as.character(shpname), as.character(shxname), as.character(access),  : C/Fortran function not in load table
> is.loaded(symbol.C("SHPOpen"))
[1] FALSE
> 

Am I doing something wrong when building the dll? here are the steps I used

gcc -mno-cygwin -O2 -c Sshpopen.c
echo LIBRARY Sshpopen > Sshpopen.def
echo EXPORTS >> Sshpopen.def
nm Sshpopen.o | \
sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" \
>> Sshpopen.def
gcc -mno-cygwin -mdll -Wl,--base-file,Sshpopen.b \
-o Sshpopen.dll Sshpopen.o
dlltool -k -D Sshpopen.dll -b Sshpopen.b -e Sshpopen.e -d Sshpopen.def
gcc -mno-cygwin -mdll -Wl,--base-file,Sshpopen.b \
-o Sshpopen.dll Sshpopen.e Sshpopen.o
dlltool -k -D Sshpopen.dll -b Sshpopen.b -e Sshpopen.e -d Sshpopen.def
gcc -mno-cygwin -mdll -o Sshpopen.dll Sshpopen.e Sshpopen.o
rm -f Sshpopen.b Sshpopen.e

Thanks for any insight

Nicholas
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Tue Jul 27 00:08:54 1999
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Tue, 27 Jul 1999 01:08:54 +0200 (MET DST)
Subject: deviance.lm() should calculate a weighted SS of residuals (PR#233)
Message-ID: <199907262308.BAA12862@pubhealth.ku.dk>


Here is a (slightly silly) example.  Surely deviance.lm()
should calculate a weighted sum of squares about the mean,
not a sum of squares.  deviance.glm() is correct.

> roller
   weight depression
1     1.9          2
2     3.1          1
3     3.3          5
4     4.8          5
5     5.3         20
6     6.1         20
7     6.4         23
8     7.6         10
9     9.8         30
10   12.4         25
> roller.lm<-lm(weight~depression,data=roller,weights=1:10)
> roller.glm<-glm(weight~depression,data=roller,weights=1:10)

> deviance(roller.lm)
[1] 35.493

> deviance(roller.glm)
[1] 240.67

> # Now change the definition of deviance.lm
> deviance.lm<-function(object, ...)sum(weighted.residuals(object)^2)
> deviance(roller.lm)
[1] 240.67
> 



--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Windows 9x 4.0 (build 1111)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Tue Jul 27 06:17:58 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Tue, 27 Jul 1999 17:17:58 +1200
Subject: Memory profiling/benchmarking
Message-ID: <19990727171758.A2622@stat1.stat.auckland.ac.nz>

Hi,

As a project for a computer performance analysis paper I am taking this semester,
I am going to look at the performance of the memory manager in R, with the aim of
determining how fast it is and which areas most need improvement.  The idea is
that I will compare various versions of R, starting with 0.64.2, and then at a
few stages in the implementation of the new memory management scheme (of which
the first step was the hash tables for environments).

I am looking for scripts to use as benchmarks for memory related activities.  As
a starting point I will use the tests distributed with R, but any other
contributions would be helpful.  I don't think the tests I have are particularly
aimed at performance, but they should give a reasonable indication of which
functions are the performance hogs.

Any other suggestions would be greatly appreciated.

Thanks,
Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Tue Jul 27 07:07:57 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Tue, 27 Jul 1999 14:07:57 +0800 (SST)
Subject: ESRI Shape reader
Message-ID: <199907270607.OAA04096@decunx.iscs.nus.sg>

Well Dr. Ripley helped me solve the first problem, next question
I need to do some debugging now that the function loads properly
into R. I checked the S documentation and to use the C I/O functions
you need to include newredef.h, this file doesn't exist in /src/include.
How does this work in R? under S3.4 on a dec station i could use

fprintf(stdout,..);
fflush(stdout);

thanks,

Nicholas

PS If I should be sending these questions to r-help instead let me know.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@hal.stat.unipd.it (Guido Masarotto)  Tue Jul 27 08:26:21 1999
From: guido@hal.stat.unipd.it (Guido Masarotto) (Guido Masarotto)
Date: Tue, 27 Jul 1999 08:26:21 +0100
Subject: ESRI Shape reader
In-Reply-To: <199907270607.OAA04096@decunx.iscs.nus.sg>; from Nicholas Lewin-Koh on Tue, Jul 27, 1999 at 02:07:57PM +0800
References: <199907270607.OAA04096@decunx.iscs.nus.sg>
Message-ID: <19990727082621.38191@hal.stat.unipd.it>

On Tue, Jul 27, 1999 at 02:07:57PM +0800, Nicholas Lewin-Koh wrote:
> Well Dr. Ripley helped me solve the first problem, next question
> I need to do some debugging now that the function loads properly
> into R. I checked the S documentation and to use the C I/O functions
> you need to include newredef.h, this file doesn't exist in /src/include.
> How does this work in R? under S3.4 on a dec station i could use
> 
> fprintf(stdout,..);
> fflush(stdout);
> 

  Previous lines works in Rterm but not in Rgui.
  For both, you can use 'REprintf', e.g.,

  REprintf("%s %d",aString,anInt);

  This is a function exported by R.dll. So to get it properly linked
  you have:
  (i) to install also the rwXXXsp.zip file;
  (ii) to regenerate libR.a (the import library for R.dll);
  (iii) to link your dll against libR.a (-L/path-to-libR.a -lR)

  Alternative: use 'gdb'; details on Brian's rw FAQ.

  guido
    






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 07:42:58 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 07:42:58 +0100 (BST)
Subject: Memory profiling/benchmarking
In-Reply-To: <19990727171758.A2622@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907270737001.29983-100000@auk.stats>

On Tue, 27 Jul 1999, Lyndon Drake wrote:

> Hi,
> 
> As a project for a computer performance analysis paper I am taking this semester,
> I am going to look at the performance of the memory manager in R, with the aim of
> determining how fast it is and which areas most need improvement.  The idea is
> that I will compare various versions of R, starting with 0.64.2, and then at a
> few stages in the implementation of the new memory management scheme (of which
> the first step was the hash tables for environments).
> 
> I am looking for scripts to use as benchmarks for memory related activities.  As
> a starting point I will use the tests distributed with R, but any other
> contributions would be helpful.  I don't think the tests I have are particularly
> aimed at performance, but they should give a reasonable indication of which
> functions are the performance hogs.

Currently the base package is treated specially (although less specially
than it was, now we have hashing). Also, many of the most time-intensive
things in R are done in compiled code. So some candidates for good tests
are things done in large packages almost entirely in R. I used the 
V&R3 ch06.R script in doing some timings, as repeated linear regression
(either stepwise selection or bootstrapping) looks like the right sort of
thing. And on that the latest (in 0.65) memory management gave a speed up
of around 50%.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 07:56:20 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 07:56:20 +0100 (BST)
Subject: ESRI Shape reader
In-Reply-To: <19990727082621.38191@hal.stat.unipd.it>
Message-ID: <Pine.GSO.4.05.9907270744040.29983-100000@auk.stats>

NB: from the previous message, this is about Windows.

On Tue, 27 Jul 1999, Guido Masarotto wrote:

> On Tue, Jul 27, 1999 at 02:07:57PM +0800, Nicholas Lewin-Koh wrote:
> > Well Dr. Ripley helped me solve the first problem, 

which was to use the makefiles for installing a package: it is much the 
easiest way to work with compiled code in R (on Unix too).

> > next question
> > I need to do some debugging now that the function loads properly
> > into R. I checked the S documentation and to use the C I/O functions
> > you need to include newredef.h, this file doesn't exist in /src/include.

That is only true in S-PLUS 4.x (not S), and only needed in the GUI
version (splus.exe not sqpe.exe) as the console has not stdout stream
(the same as Rgui.exe).

> > How does this work in R? under S3.4 on a dec station i could use
> > 
> > fprintf(stdout,..);
> > fflush(stdout);

It would be normal to use stderr for debugging.


>   Previous lines works in Rterm but not in Rgui.
>   For both, you can use 'REprintf', e.g.,
> 
>   REprintf("%s %d",aString,anInt);

An alternative, which I tend to use is,

char msg[1024];

sprintf(msg, ...);
askok(msg);

which puts the contents of the message up in a message dialog box.
The trouble with Rprintf and REprintf is that they depend on the console
running properly and the information written not getting over-written.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 08:06:23 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 08:06:23 +0100 (BST)
Subject: Preliminary version of ts package
Message-ID: <Pine.GSO.4.05.9907270756330.29983-100000@auk.stats>

There is now a preliminary version of a time series package in the R-devel
snapshots, and we would welcome feedback on it.  It is based in part on the
packages bats (Martyn Plummer) and tseries (Adrian Trapletti) and in part
on code I had or have written. (Thanks for the contributions, Martyn and
Adrian!) Some of the existing ts code has been changed, for example to plot
multiple time series, so the behaviour after library(ts) may differ from
that without it.

library(help=ts) gives something like the listing below.  It is intended
that ar.burg (univariate case) and preliminary arima fitting and
forecasting functions will be added in the next couple of weeks.  At 
present there is a fairly high degree of S-PLUS compatibility in the
interfaces, but not necessarily in the objects or algorithms.

----------------------

Preliminary time-series package for R 0.65
==========================================

This is a preliminary version of a time-series package; at present
the functionality is somewhat limited in that not all the options are
yet implemented or may be very slow.

Functions in base R:
-------------------

ts		Create a (univariate or multivariate) ts object
[.ts		Subsetting method for ts objects.
as.ts, is.ts	Coercion and membership functions
plot, print	Methods for plot and print

aggregate	Computes summaries (e.g. sum) over disjoint time intervals
diff		Lagged differences of a time series
end		Time of last observation
frequency	Number of observations per unit of time
start		Time of first observation
time		Create time series giving the times of observations
tsp, tsp<-	Get and set time-series attributes
window		Subset to a time window


Functions in package ts:
-----------------------

acf		Autocovariance and autocorrelation function
ar              Wrapper for autoregression estimation functions
ar.yw           Estimate autoregression model by solving Yule-Walker equations
Box.test	Box-Pierce and Ljung-Box tests of independence
ccf		Cross-covariance and cross-correlations for two series
cpgram		Plot cumulative periodogram of univariate time series
cycle		Create time series giving the positions in a cycle 
		   of a time series
deltat		Return time interval between observations
diffinv		Discrete integration, the inverse of diff()
embed           Embedding a time series
filter		Linear filtering on a time series
kernel          Smoothing kernel objects (and Daniell, Fejer and 
                   (modified) Dirichlet kernels)
lag		Compute lagged version of time series
na.contiguous	Find longest contiguous stretch of non-NAs
na.omit.ts	na.omit method for time series
pacf		Partial autocorrelation function
plot.acf        Plot autocorrelation function
plot.spec       Plot spectral density estimate
plot.spec.coherency
plot.spec.phase
PP.test		Phillips-Perron test for unit root
spec.ar	        Estimate spectral density by autoregression
spec.pgram      Estimate spectral density from periodogram
spec.taper      Taper by cosine bell
spectrum        Wrapper for spectral density estimation functions
stl		Seasonal decomposition using loess
toeplitz	Generate Toeplitz matrix
ts.intersect	Bind time series as multivariate ts over the common time base
ts.union	Bind time series as multivariate ts over their total time base

TO DO

ar.burg		maybe
arima fitting and forecasting.


Datasets in base R:
------------------

airmiles        Passenger-Miles on US Airlines 1937-1960
co2             Moana Loa Atmospheric CO2 Concentrations
nhtemp          Yearly Average Temperatures in New Haven CT
presidents      Quarterly Approval Ratings for US Presidents
sunspots        Monthly Mean Relative Sunspot Numbers
uspop		Populations Recorded by the US Census


Datasets in package ts:
----------------------

accdeaths       US accidental deaths 1973-8
beaver1         time series of body temperatures of two beavers
beaver2
deaths          time-series on UK lung deaths 1974-9 from Diggle (1990)
mdeaths, fdeaths  as above, for males and females
drivers         time series on UK road deaths of drivers from Harvey (1989)
finance         daily closing prices of major European stock indices, 1991-1998
lh              dataset on luteinizing hormone from Diggle (1990)
nottem		time-series of temperatures in Nottingham, 1920-1939
sales		sales data with leading indicator
sunspot.year	yearly sunspot data, 1700-1988
sunspot.month	monthly sunspot data, 1749-1997
treering	yearly tree ring data, -6000-1979


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 15:51:10 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 10:51:10 -0400
Subject: Memory profiling/benchmarking
References: <19990727171758.A2622@stat1.stat.auckland.ac.nz>
Message-ID: <379DC75D.DFFAFBC6@bank-banque-canada.ca>

Lyndon

There are several test scripts with my DSE library available at
<http://www.bank-banque-canada.ca/pgilbert>. (Please don't make the mistake of
trying to install the version on CRAN - it installs with  R 0.61 but there have
been a lot of changes to R since then.)

The library calls compiled fortran for the really loop intensive core
calculations, but this is fairly representative of R. With R (up to 0.64.2) the
shortest set of tests (test.dse.lite) takes 7-8 minutes on a Sparc Ultra 10.
(Splus 3.3 takes 4-5 minutes.) There are several longer tests, including some
curvature calculations which take many hours. (In some of the more complicated
tests there are a few things which do not work in R, but most things do.) I use
generic functions a lot, and also use a set of "kernel" functions to help
protect my code from ongoing changes in R and S. This means that function
dispatch gets heavily exercised.

Attached below are results from the light and medium test for 0.64.2 and the
development snapshot (0.65) from a month ago (June 11). These show the timing at
the bottom of each test. As I recall I had to make a small fix to 0.64.2 in
order to get things working - but I don't remember what it was. If you have a
problem, send me the error message and it will jog my memory. I don't see a
large difference in the times, but I don't know if hashing was already in the
snapshot I have.

The pending changes in the ts library will have some affect on what has to be
attached to run the tests. Hopefully I will get a chance to test the library
today or tomorrow.

I would like to see the results of your testing, even if you decide not to use
these test.

Paul Gilbert
_________


On a sparc Ultra 10
R-0.64.2/
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.lite
+++++++++++++++++++++++++++++++++++++++++++++++++
RLIBS set to /home/mfa5/gilp/dse/pub/Rdse/rlibs
>    library("dse")

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


 The following object(s) are masked from package:base :

  RNGkind rnorm runif


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts


Attaching Package "package:dse":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

>    library("dse2")

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

>    library("mva")
>    library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.lite.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Random number generator tests ...ok
All tframe tests ... OK
All dse1 (kernel) tests ... OK
All dse2 tests ... OK
All dse3 tests ... OK
All dse4 tests ...Warning: skipping test 4 (requires stepwise).
 OK
dse2 graphics tests ...Warning: Specified end later than end of data, end not
changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
completed
dse3 graphics tests ...completed
dse4 graphics tests ...completed
All Brief User Guide example part 1 tests ... OK
All dse juice tests ...juice graphics tests ... OK
 OK
>
>
=========================================
R test.lite.s timing:
start Tuesday July 27 09:27:11 EDT 1999
end   Tuesday July 27 09:34:59 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.medium
+++++++++++++++++++++++++++++++++++++++++++++++++
>   x11()
> library("dse", warn.conflicts=FALSE)

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


 The following object(s) are masked from package:base :

  RNGkind rnorm runif


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

> library("dse2", warn.conflicts=FALSE)

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

> library("opt")
> library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.medium.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Brief User Guide example part 2 tests ...Warning: Specified end later than end
of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
 OK
>
>
=========================================
R test.medium.s timing:
start Tuesday July 27 09:35:00 EDT 1999
end   Tuesday July 27 09:49:00 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================

########################################################################

Devel version R 0.65 June 11, 1999 snapshot

+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.lite
+++++++++++++++++++++++++++++++++++++++++++++++++
RLIBS set to /home/mfa5/gilp/dse/pub/Rdse/rlibs
>    library("dse")

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


Attaching Package "package:syskern":


 The following object(s) are masked from package:base :

  rnorm


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts


Attaching Package "package:dse":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

>    library("dse2")

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

>    library("mva")
>    library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.lite.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Random number generator tests ...ok
All tframe tests ... OK
All dse1 (kernel) tests ... OK
All dse2 tests ... OK
All dse3 tests ... OK
All dse4 tests ... OK
dse2 graphics tests ...completed
dse3 graphics tests ...completed
dse4 graphics tests ...completed
All Brief User Guide example part 1 tests ... OK
All dse juice tests ...juice graphics tests ... OK
 OK
Warning message:
skipping test 4 (requires stepwise). in: dse4.function.tests(verbose = F,
graphics = F)
>
>
=========================================
R test.lite.s timing:
start Tuesday July 27 09:59:15 EDT 1999
end   Tuesday July 27 10:06:57 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.medium
+++++++++++++++++++++++++++++++++++++++++++++++++
>   x11()
> library("dse", warn.conflicts=FALSE)

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


Attaching Package "package:syskern":


 The following object(s) are masked from package:base :

  rnorm


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

> library("dse2", warn.conflicts=FALSE)

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

> library("opt")
> library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.medium.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Brief User Guide example part 2 tests ... OK
>
>
=========================================
R test.medium.s timing:
start Tuesday July 27 10:06:57 EDT 1999
end   Tuesday July 27 10:20:47 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 18:55:57 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 13:55:57 -0400
Subject: Preliminary version of ts package
Message-ID: <379DF2AD.3A4DD91E@bank-banque-canada.ca>

Brian

I haven't got far, but here are some initial problems:

> start(1:10)
S:  [1] 1 1
ts: 1

> end(1:10)
S: [1] 10  1
ts: 10

window.ts  should handle NULL for default start and end values. If it is going
to print a warning then it needs warn=F to suppress the warning. Below is a copy
of my window.ts, but it would require a few minor changes to work without my
tframe library.

Paul
_______

 window.ts <- function (x, start = NULL, end = NULL, warn = T, eps =
.Options$ts.eps)
{
    f <- tsp(x)[3]
    if (is.null(start))
        start <- tsp(x)[1]
    if (is.null(end))
        end <- tsp(x)[2]
    if (2 == length(start))
        start <- start[1] + (start[2] - 1)/f
    if (2 == length(end))
        end <- end[1] + (end[2] - 1)/f
    if (start < tsp(x)[1]) {
        start <- tsp(x)[1]
        if (warn)
            warning("Specified start earlier than start of data, start not
changed.")
    }
    if (end > tsp(x)[2]) {
        end <- tsp(x)[2]
        if (warn)
            warning("Specified end later than end of data, end not changed.")
    }
    leave <- (time(x) >= (start - eps)) & (time(x) <= (end + eps))
    if (is.matrix(x))
        z <- unclass(x)[leave, , drop = F]
    else z <- x[leave]
    classed(ts(z, start = start, end = end, frequency = f), tfclass(x))
}


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 20:09:40 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 20:09:40 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379DF2AD.3A4DD91E@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907272003470.10800-100000@auk.stats>

On Tue, 27 Jul 1999, Paul Gilbert wrote:

> Brian
> 
> I haven't got far, but here are some initial problems:
> 
> > start(1:10)
> S:  [1] 1 1
> ts: 1
> 
> > end(1:10)
> S: [1] 10  1
> ts: 10

What's wrong with that?  S looks silly to me: you only need the second
component for seasonal series, and 1:10 is not seasonal.

In general, I am not trying to clone S, most notably as S-PLUS uses class
rts not ts, so very little code exists that uses S's class ts. Surely the
point of R is not _better_?  There are lots of detail improvements,
with more to come.

> window.ts  should handle NULL for default start and end values. If it is going
> to print a warning then it needs warn=F to suppress the warning. Below is a copy
> of my window.ts, but it would require a few minor changes to work without my
> tframe library.

I have not changed window.ts. I'll take a look.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 21:23:33 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 16:23:33 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907272003470.10800-100000@auk.stats>
Message-ID: <379E1545.4A37ECF8@bank-banque-canada.ca>

Brian

>In general, I am not trying to clone S, most notably as S-PLUS uses class
>rts not ts, so very little code exists that uses S's class ts. Surely the
>point of R is not _better_?  There are lots of detail improvements,
>with more to come.

Yes, hopefully there will be lots of improvements. But I think everyone has
agreed that we want S compatability for the default behaviour, so if  "ts" is
not going to be the default, then the default needs to be defined. Then, for
example, we cannot have

start.default <- function (x)  start.ts(ts(x))

as it is now.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 22:56:25 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 22:56:25 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379E1545.4A37ECF8@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907272252270.11135-100000@auk.stats>

On Tue, 27 Jul 1999, Paul Gilbert wrote:

> Brian
> 
> >In general, I am not trying to clone S, most notably as S-PLUS uses class
> >rts not ts, so very little code exists that uses S's class ts. Surely the
> >point of R is not _better_?  There are lots of detail improvements,
> >with more to come.
> 
> Yes, hopefully there will be lots of improvements. But I think everyone has
> agreed that we want S compatability for the default behaviour, so if  "ts" is

Not in my time with R: can you give me the reference to that agreement,
please. (If it is a generic comment, there are many, many exceptions.)

> not going to be the default, then the default needs to be defined. Then, for
> example, we cannot have
> 
> start.default <- function (x)  start.ts(ts(x))
>
> as it is now.

Why not?  S-PLUS thinks 1:10 has start=c(1,1), end=c(10,1), and would any
sane person think that?  (I might buy c(1,0)....)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Tue Jul 27 23:41:48 1999
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Jul 1999 17:41:48 -0500
Subject: Retaining comments when using `example'
Message-ID: <6rk8rl7m1f.fsf@verdi.stat.wisc.edu>

I find the `example' function, used to run the examples from a help
page, to be very useful.  It would be even more useful if I could find
a way to have the comments echoed along with the example code.

For example, the example section of col.Rd from the base library reads

 # extract an off-diagonal of a matrix
 ma <- matrix(1:12, 3,4)
 ma[row(ma)==col(ma) + 1]

 # create an identity 5-by-5 matrix
 x <- matrix(0,nr=5,nc=5)
 x[row(x)==col(x)] <- 1

but example(col) produces

 R> example(col)

 col> ma <- matrix(1:12, 3, 4)

 col> ma[row(ma) == col(ma) + 1]
 [1] 2 6

 col> x <- matrix(0, nr = 5, nc = 5)

 col> x[row(x) == col(x)] <- 1

Is there a way to retain the comments?  I notice that `example' ends up
calling the `source' function to do the actual running of the code.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul 28 00:38:00 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Jul 1999 01:38:00 +0200
Subject: Retaining comments when using `example'
In-Reply-To: Douglas Bates's message of "27 Jul 1999 17:41:48 -0500"
References: <6rk8rl7m1f.fsf@verdi.stat.wisc.edu>
Message-ID: <x23dy9d5pj.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> Is there a way to retain the comments?  I notice that `example' ends up
> calling the `source' function to do the actual running of the code.

Yeowch! This was not easy with the old comment-as-attribute model, and
it certainly did not get easier with the new keep-function-source
semantics.

The real trouble is - I suspect - an ancient one, inherited from S:

	source() doesn't

I.e. it does not work in the same way as the source command in a shell
would, interpreting a file as if it had been lines entered on the
command line, with some provision for skipping back to interactive
mode if there's an error. Rather, it parses the entire file (and
syntax checks it) and runs the resulting parsed expression. 

Perhaps we need a "real" source()?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 06:40:55 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 06:40:55 +0100 (BST)
Subject: Retaining comments when using `example'
In-Reply-To: <x23dy9d5pj.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907280626520.11506-100000@auk.stats>

On 28 Jul 1999, Peter Dalgaard BSA wrote:

> Douglas Bates <bates@stat.wisc.edu> writes:
> 
> > Is there a way to retain the comments?  I notice that `example' ends up
> > calling the `source' function to do the actual running of the code.
> 
> Yeowch! This was not easy with the old comment-as-attribute model, and
> it certainly did not get easier with the new keep-function-source
> semantics.
> 
> The real trouble is - I suspect - an ancient one, inherited from S:
> 
> 	source() doesn't
> 
> I.e. it does not work in the same way as the source command in a shell
> would, interpreting a file as if it had been lines entered on the
> command line, with some provision for skipping back to interactive
> mode if there's an error. Rather, it parses the entire file (and
> syntax checks it) and runs the resulting parsed expression. 

Ah, but S can use options(echo=T) to do the echoing, rather than the
complicated code R has, and if echo=T S's source runs a loop running dput
on the expressions. And S _does_ echo the comments.

> Perhaps we need a "real" source()?

Yes, but let's try smaller things first.

Why does options(echo=TRUE) do nothing in R?
Since if echoing is actually set (iff R thinks it is non-interactive)
comments are echoed, it seems we do have the mechanisms needed in place.

_If_ this worked Doug would have noticed that there are too many comments
in the R-ex files: running that example in S-PLUS gives

> options(echo=T, prompt="")
> source("/ext/R/R-devel/library/base/R-ex/col.R")
###--- >>> `col' <<<----- Column Indexes
## alias         help(col)
##___ Examples ___:
# extract an off-diagonal of a matrix
ma <- matrix(1:12, 3, 4)
ma[row(ma) == col(ma) + 1]
# create an identity 5-by-5 matrix
x <- matrix(0, nr = 5, nc = 5)
x[row(x) == col(x)] <- 1
## Keywords: 'array'.
vector("end.of.file",0)

so there is more to this than just echoing the comments (including echoing
the output).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Wed Jul 28 09:28:58 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Wed, 28 Jul 1999 16:28:58 +0800 (SST)
Subject: ESRI shapes --again
Message-ID: <199907280828.QAA23696@decunx.iscs.nus.sg>

thanks to all the help so far I have code now that works on windows
(albeit very clunky) that can read the pertinent info from the shape header
and return a list with all the necessary parameters to read info out of
the shape file. Now come the big design questions

1) I have considered building a map object, basically a list that would
hold the info from the shape file and a data frame as part of the list.
Should all of the vertices of a shape be stored in this structure? I can
see this getting big really fast. My idea was to store only offset and the
size of each record and whenever a shape needs to be plotted or accessed 
the vertices can be retrived from the .shp file through an access function.
the problem is if the user wants to project the map all projections will
have to be done on the fly as the vertices are accessed. 

for those who don't know shape files are stored in 3 files, .shp .shx and .dbf
the .shp file holds the geometric information, the .shx file holds the
ofsets and the record sizes for each shape, and the .dbf file holds the
attribute information.

which brings me to question 2

2) the .dbf file contains the attribute information, so I
basically nead to write another version of read.table to access the dbf
file and store it as a data frame (the natural equivalent of an ArcView
data table). Is there a way to extend or access the functions of read.table
to construct a data frame without using a lot of memory building seperate
vectors and factors etc. and binding them into a data frame.

3) I have been cheating. Dr. Ripley suggested I start compiling this as
a package, using the supplied make files. Very sensible advice, however I am 
not exactly sure how to do this on windows. I have checked the faq which
says there is a sample Makefile in the eda package, I assume this
is Unix only couldn't find it. So to do this as far as I can tell from the
dcumentation I could get my hands on I need to make a folder in 
\rw0642\src\library and put the subdirectories R, src, man and data and
then run make? Or am I missing something?
 

Thanks again for all the help.

Nicholas
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 10:09:36 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 10:09:36 +0100 (BST)
Subject: ESRI shapes --again
In-Reply-To: <199907280828.QAA23696@decunx.iscs.nus.sg>
Message-ID: <Pine.GSO.4.05.9907281006240.12748-100000@auk.stats>

On Wed, 28 Jul 1999, Nicholas Lewin-Koh wrote:

> 3) I have been cheating. Dr. Ripley suggested I start compiling this as
> a package, using the supplied make files. Very sensible advice, however I am 
> not exactly sure how to do this on windows. I have checked the faq which
> says there is a sample Makefile in the eda package, I assume this
> is Unix only couldn't find it. So to do this as far as I can tell from the
> dcumentation I could get my hands on I need to make a folder in 
> \rw0642\src\library and put the subdirectories R, src, man and data and
> then run make? Or am I missing something?

Try looking at the R for Windows FAQ or the Venables & Ripley R
complements.

Basically, to make package foo under Windows, set a standard R packages
source (with R, src, man and data) in ...\rw0642\src\library\foo, cd to 
..\rw0642\src\gnuwin32 and `make pkg-foo'.  You are very unlikely to need
a Makefile (under Windows or Unix).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Wed Jul 28 10:10:58 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Wed, 28 Jul 1999 17:10:58 +0800 (SST)
Subject: ESRI Shapefile again
Message-ID: <199907280911.RAA17340@decunx.iscs.nus.sg>

Hi again,
with my question 3) in my last post I think I answered my own question
of course generating a new one. I made the directory maptools in /src/library
and put the proper directories source and everything then from /src/gnuwin32

BASH$ make pkg-maptools

.......
------- Building maptools.dll from maptools.a --------
echo LIBRARY maptools > maptools.def
echo EXPORTS >> maptools.def
nm maptools.a > Defs
sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" Defs >> maptools.def
gcc -mno-cygwin -mdll -Wl,--base-file,maptools.b -s  -o maptools.dll  maptools.a
  -L../../../gnuwin32  -lg2c.mingw32 -lR
/CYGNUS/CYGWIN~1/H-I586~1/i586-cygwin32/bin/ld: cannot open -lg2c.mingw32: No such file or directory
collect2: ld returned 1 exit status
make[2]: *** [maptools.dll] Error 1
make[1]: *** [src/maptools.dll] Error 2
make: *** [pkg-maptools] Error 2

do i need to install -lg2c.mingw32 ? I am running Cygwin 20.1b on Windows 98

Nicholas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 28 12:42:40 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 28 Jul 1999 13:42:40 +0200 (CEST)
Subject: 0.65 HPUX/AIX update
In-Reply-To: <199907232044.QAA20966@infiniti.ece.cmu.edu>
References: <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>
 <199907232044.QAA20966@infiniti.ece.cmu.edu>
Message-ID: <14238.60592.356201.404321@fangorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> Kurt,

>   thanks for the changes.  I've downloaded the snapshot on July 22.
> It looks like we are in good shape now for AIX:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

Kurt> The current situation is as follows.
Kurt> 
Kurt> AIX:
Kurt> 
Kurt> * I still need f77 for linking.  Using ld with the suggested flags gives
Kurt> a binary with `exec format error'.  The problem seems to be with an
Kurt> unreferenced __start.

> I apologize for not seeing this earlier: "__start" is defined in
> /lib/crt0.o.  So all you have to do is add /lib/crt0.o to the objects
> when linking.  (You have to look carefully for that in the output from
> gcc --verbose anything.o to learn what gcc is doing when linking an
> executable.)

Thanks, done now.  `ld' now used for LDCMD and SHLIBLD, always use
/lib/crt0.o when linking the main binary.

Kurt> * The floating point (finite|isnan) stuff is strange, but under control,
Kurt> I think.  Plain cc works, gcc has a problem and seems to need having
Kurt> prototypes turned off for IEEE fp.  (More below.)

> Quick fix and insanity check:  Add the following lines at the end of Arith.h
>   #include <fp.h>
>   static int finite (double x) {
>         return FINITE (x);
>   }
> This will generate lots of warnings.  The resulting executable
> (compiled with gcc) works wrt Inf and NaN!  My current assumption is
> that there is a bug in gcc that generates the wrong inline version of
> finite.  Overwriting it solves the problem.  A better fix would be to
> ensure that finite is never called when configure finds that it is
> buggy.  (I believe that the issue whether finite () exists is a
> separate one.  So there should be two flags, like HAVE_FINITE and
> HAVE_FINITE_THAT_STINKS... )

Kurt> So there is a problem in the finite() test with gcc.  It somehow is
Kurt> related to the use of ANSI C prototypes, and disappears if we define
Kurt> _NO_PROTO.  I am in the process of adding this as a short term fix, but
Kurt> we should think a bit more about that.

Done, too.  I added a configure test for broken finite and in that case
we now do something special for AIX or the same as if finite was not
there otherwise.  (We can circumvent the warnings because what we really
need is R_FINITE(x), and that can be defined as you suggested.)

I consider AIX done now.  Any objections?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 17:04:16 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 12:04:16 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907272252270.11135-100000@auk.stats>
Message-ID: <379F29FE.B16ACFC8@bank-banque-canada.ca>

PG>> Yes, hopefully there will be lots of improvements. But I think
everyone has
PG>> agreed that we want S compatibility for the default behavior, so
if  "ts" is...

BDR>Not in my time with R: can you give me the reference to that
agreement,
BDR>please. (If it is a generic comment, there are many, many
exceptions.)

I think in general this has been agreed to several times, but also in
the discussion of Adrian Trapletti tseries library, which seemed to
initiate the ts library effort, there was general agreement on this
point. (See r-devel messages July 15 Re: tseries).

I am not trying to defend S's poor default treatment of time series. We
need other better time series classes, and perhaps ts should do that. In
fact, perhaps R does not even need a default time series representation
and methods for it.

What is important is that, if there is a time series default it should
be consistent with S. So, either ts should be consistent with S or it
should not be the default.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 18:41:36 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 13:41:36 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907281717080.14236-100000@auk.stats>
Message-ID: <379F40CE.52B3DFA@bank-banque-canada.ca>

PG>> I think in general this has been agreed to several times, but also
in
PG>> the discussion of Adrian Trapletti tseries library, which seemed to

PG>> initiate the ts library effort, there was general agreement on this

PG>> point. (See r-devel messages July 15 Re: tseries).

BDR>No, it did not! I promised to do this at the Vienna workshop in
March: the
BDR>end of the Oxford academic year precipitated this. And my reading of
that
BDR>correspondence is _not_ that there was agreement to follow all of
S's
BDR>quirks.  R-core does not think it has agreed to that: I had checked,

BDR>and the consensus is to improve.

There seems to be a general plan that was discussed by R-core and not
mentioned on R-devel, even when there were announcements about other
work being done on time series libraries. If S compatibility is no
longer a consideration then perhaps that should be communicated to
R-devel and even more widely. There are a number of users that have a
big investment in this.

BDR>Certainly we do not intend to get the same
BDR>wrong answers as S-PLUS!

I consider wrong answers to be special exceptions. Changing R's default
behavior for start() and end() is a design choice, not a wrong answer. I
think is is quiet reasonable to put these design choices in your own
library, but it should not be included as part of the default.

Paul



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 20:43:37 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 20:43:37 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379F40CE.52B3DFA@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907282038240.14583-100000@auk.stats>

On Wed, 28 Jul 1999, Paul Gilbert wrote:

Paul had just sent a public reply to part of a private reply, a practice I
deplore.

In the part he omitted was a challenge to supply a completely S compatible
lm and glm, plus the comment that I have _not_ changed start.ts nor end.ts
in base R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 29 15:18:09 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 29 Jul 1999 16:18:09 +0200 (MET DST)
Subject: round(numeric(0)) (PR#235)
Message-ID: <199907291418.QAA05728@pubhealth.ku.dk>

Try

> round(numeric(0))
[1] NA
> floor(numeric(0))
numeric(0)
> trunc(numeric(0))
numeric(0)

S has them all as numeric(0), and I think R is wrong.
This looks like a design error in the math2 group: it applies to 
signif too, and also to the complex cases, e.g.
> signif(complex(0))
[1] NA



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, package:ts, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 29 17:49:47 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 29 Jul 1999 18:49:47 +0200 (CEST)
Subject: round(numeric(0)) (PR#235)
In-Reply-To: <199907291418.QAA05728@pubhealth.ku.dk>
References: <199907291418.QAA05728@pubhealth.ku.dk>
Message-ID: <14240.34347.395426.27168@fangorn.ci.tuwien.ac.at>

>>>>> ripley  writes:

> Try
>> round(numeric(0))
> [1] NA
>> floor(numeric(0))
> numeric(0)
>> trunc(numeric(0))
> numeric(0)

> S has them all as numeric(0), and I think R is wrong.
> This looks like a design error in the math2 group: it applies to 
> signif too, and also to the complex cases, e.g.
>> signif(complex(0))
> [1] NA

In math2, we have

    if (na < 1 || nb < 1) {
        for (i = 0; i < n; i++)
            y[i] = NA_REAL;
    }

with

    na = LENGTH(sa);
    nb = LENGTH(sb);
    n = (na < nb) ? nb : na;

round(numeric(0)) really does round(numeric(0), 0) and hence we have na
= 0, n = nb = 1.  I think math2 is about right because you need that
sort of symmetry for recycling, but do_round() could know better.  Now

R> round(pi, 1:4)
[1] 3.1000 3.1400 3.1420 3.1416

is supposed to work so is it really clear what we want?  (if either arg
has length 0, does the result have length 0?  Should this be true for
any math2 type function?)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 29 17:58:14 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 29 Jul 1999 17:58:14 +0100 (BST)
Subject: round(numeric(0)) (PR#235)
In-Reply-To: <14240.34347.395426.27168@fangorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.9907291752410.10671-100000@auk.stats>

On Thu, 29 Jul 1999, Kurt Hornik wrote:

> >>>>> ripley  writes:
> 
> > Try
> >> round(numeric(0))
> > [1] NA
> >> floor(numeric(0))
> > numeric(0)
> >> trunc(numeric(0))
> > numeric(0)
> 
> > S has them all as numeric(0), and I think R is wrong.
> > This looks like a design error in the math2 group: it applies to 
> > signif too, and also to the complex cases, e.g.
> >> signif(complex(0))
> > [1] NA
> 
> In math2, we have
> 
>     if (na < 1 || nb < 1) {
>         for (i = 0; i < n; i++)
>             y[i] = NA_REAL;
>     }
> 
> with
> 
>     na = LENGTH(sa);
>     nb = LENGTH(sb);
>     n = (na < nb) ? nb : na;
> 
> round(numeric(0)) really does round(numeric(0), 0) and hence we have na
> = 0, n = nb = 1.  I think math2 is about right because you need that
> sort of symmetry for recycling, but do_round() could know better.  Now
> 
> R> round(pi, 1:4)
> [1] 3.1000 3.1400 3.1420 3.1416
> 
> is supposed to work so is it really clear what we want?  (if either arg
> has length 0, does the result have length 0?  Should this be true for
> any math2 type function?)

Yes, I think that is what Svr4 says is the correct behaviour: the recycling
rules have been changed to be consistent (JMC says somewhere in the Green 
book) and any zero-length vector immediately makes the result of zero
length.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 15:08:08 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 10:08:08 -0400
Subject: Memory profiling/benchmarking
References: <19990727171758.A2622@stat1.stat.auckland.ac.nz> <379DC75D.DFFAFBC6@bank-banque-canada.ca> <19990804093220.A14758@stat1.stat.auckland.ac.nz>
Message-ID: <379F0EC8.FAB681E4@bank-banque-canada.ca>

Lyndon

>The latest DSE tar.gz file seems to be corrupt.

I think I fixed that yesterday about 20:00 GMT (which was before your
email but possibly after you downloaded it). If you've tried since then
and are still having trouble please let me know. (Also, if you are still
having trouble, the uncompressed file was not corrupted.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bogus@does.not.exist.com  Fri Jul  2 08:37:58 1999
From: bogus@does.not.exist.com ()
Date: Fri, 02 Jul 1999 03:37:58 -0400 (EDT)
Subject: Win cash & a cruise!
Message-ID: <46448.16661@ccr.dsi.uanl.mx>

Raquel's Casino, Inc. is awarding a cruise + $300 to a lucky member.  No
purchase necessary to play!

Join before month end to participate.  (You will automatically be entered
into the next drawing.)You can join at
    http://www.raquelscasino.com  (casino)
    http://www.tobet.com (sportsbook)
Raquel's online casino provides guests with a state-of-the-art gaming
experience:
    - A chance to win a cruise and $300!
    - 10% sign-up bonus!
    - Free casino software!
    - 25 casino games!
    - International sportsbook!
    - Horse racing!
    - Play for fun, or for real!
Our casino is secure, audited, private, and insured.

Thank you for your time and consideration.





*********************************************
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Jul  2 16:24:04 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 02 Jul 1999 11:24:04 -0400
Subject: changing the RNG transformation
Message-ID: <377CD994.44D698F7@bank-banque-canada.ca>

I have just circulated some code on S-new which gives a general strategy for
defining different RNGs and (normal) transformations in Splus (and R). Most of
this is already built into R, but the strategy for defining the transformation
is not. (Although a quick look at the C code suggests someone has been thinking
about it).

I would appreciate comments, especially on the transformation strategy. I expect
the code would be faster if the transformation was done in C.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Fri Jul  2 17:22:38 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Fri, 02 Jul 1999 16:22:38 +0000
Subject: Problem with plot.ts, "["
Message-ID: <377CE74E.A742EB01@wu-wien.ac.at>

There seems to be a problem with plot.ts (R Version 0.64.2)

>x<-cbind(1:10,2:11)
>x<-as.ts(x)
>plot(x)
Error: subscript (20) out of bounds, should be at most 10
>

The problem is located in "[.ts":

> x<-cbind(1:10,2:11)
> x[is.finite(x)]
 [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> x<-as.ts(x)
> x[is.finite(x)]
Error: subscript (20) out of bounds, should be at most 10
>

and there (in "[.ts") the following statement gives the error:

Browse[1]>
debug: li <- length(ind <- (1:n)[i])

However I don't understand what this part exactly does?

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Jul  2 17:44:18 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 2 Jul 1999 18:44:18 +0200 (MET DST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["} (PR#216)
Message-ID: <199907021644.SAA21974@pubhealth.ku.dk>


>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> said:

    Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
    > x<-cbind(1:10,2:11)
    > x<-as.ts(x)
    > plot(x)
    Adrian> Error: subscript (20) out of bounds, should be at most 10

This is definitely a bug
--> CC: R-bugs

ALL NOTE : This is *not* new in 0.64.2



    Adrian> The problem is located in "[.ts":

    > x<-cbind(1:10,2:11)
    > x[is.finite(x)]
    Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
    > x<-as.ts(x)
    > x[is.finite(x)]
    Adrian> Error: subscript (20) out of bounds, should be at most 10


    Adrian> and there (in "[.ts") the following statement gives the error:

    Adrian> Browse[1]>
    Adrian> debug: li <- length(ind <- (1:n)[i])

    Adrian> However I don't understand what this part exactly does?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  2 17:53:31 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Jul 1999 18:53:31 +0200
Subject: Problem with plot.ts, "["
In-Reply-To: Adrian Trapletti's message of "Fri, 02 Jul 1999 16:22:38 +0000"
References: <377CE74E.A742EB01@wu-wien.ac.at>
Message-ID: <x2vhc3at84.fsf@blueberry.kubism.ku.dk>

Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> writes:

> There seems to be a problem with plot.ts (R Version 0.64.2)
> 
> >x<-cbind(1:10,2:11)
> >x<-as.ts(x)
> >plot(x)
> Error: subscript (20) out of bounds, should be at most 10
> >
> 

If it's any consolation to you, this didn't work in 0.64.1 and not in
0.65unstable either, although it gets a different error there...

> The problem is located in "[.ts":
> 
> > x<-cbind(1:10,2:11)
> > x[is.finite(x)]
>  [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> > x<-as.ts(x)
> > x[is.finite(x)]
> Error: subscript (20) out of bounds, should be at most 10
> >
> 
> and there (in "[.ts") the following statement gives the error:

Actually, I suspect that the mistake is to do  x[is.finite(x)] in the
first place. It is used to calculate ranges for plot limits, but one
might better have used range(x,finite=TRUE) for that. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 16:52:17 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 02 Jul 1999 17:52:17 +0200 (CEST)
Subject: segfault on Sparc Linux (RH6.0)
Message-ID: <XFMail.990702175217.plummer@iarc.fr>

We are having problems building R on Red Hat Linux 6.0/Sparc.
R compiles with no problem but then it fails "make tests".
Specifically, the line

eigen(cbind(-1,c(1:2,0),0:2)) # complex values

causes a segmentation fault. Previous versions of Red Hat Linux
did not give this problem.

The eigen() function is one of the rare cases in the base library where
Fortran code is called via the .Fortran interface, which suggests to me
that the problem lies in the Fortran installation or flags.

Vin Everett, who is actually doing the compiling, has provided output
from gdb, which is given below. Any help would be greatly appreciated.

Martyn

> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
0xb1dc8 in hqr2_ ()
(gdb) 

bt gives:-
(gdb) bt
#0  0xb1dc8 in hqr2_ ()
#1  0xb4bb4 in rg_ ()
#2  0x3909c in do_dotCode (call=0x70421f64, op=0x70421b90, args=0x70679f28, 
    env=0x7067791c) at dotcode.c:386
#3  0x3fc7c in eval (e=0x70421f64, rho=0x7067791c) at eval.c:180
#4  0x41118 in do_set (call=0x70421fa0, op=0x702d4828, args=0x70421f8c, 
    rho=0x7067791c) at eval.c:761
#5  0x3fc7c in eval (e=0x70421fa0, rho=0x7067791c) at eval.c:180
#6  0x40b58 in do_begin (call=0x70421fb4, op=0x702d48c8, args=0x70421fc8, 
    rho=0x7067791c) at eval.c:588
#7  0x3fc7c in eval (e=0x70421fb4, rho=0x7067791c) at eval.c:180
#8  0x40280 in do_if (call=0x70422ef0, op=0x702d44b8, args=0x70422edc, 
    rho=0x7067791c) at eval.c:379
#9  0x3fc7c in eval (e=0x70422ef0, rho=0x7067791c) at eval.c:180
#10 0x40b58 in do_begin (call=0x70422f04, op=0x702d48c8, args=0x70422f18, 
    rho=0x7067791c) at eval.c:588
#11 0x3fc7c in eval (e=0x70422f04, rho=0x7067791c) at eval.c:180
#12 0x40280 in do_if (call=0x70423120, op=0x702d44b8, args=0x7042310c, 
    rho=0x7067791c) at eval.c:379
#13 0x3fc7c in eval (e=0x70423120, rho=0x7067791c) at eval.c:180
#14 0x40b58 in do_begin (call=0x7041eddc, op=0x702d48c8, args=0x70423134, 
    rho=0x7067791c) at eval.c:588
#15 0x3fc7c in eval (e=0x7041eddc, rho=0x7067791c) at eval.c:180
#16 0x3ffcc in applyClosure (call=0x70677868, op=0x7042347c, 
    arglist=0x706778cc, rho=0x702dca50, suppliedenv=0x702d4008) at eval.c:293
#17 0x3fcf0 in eval (e=0x70677868, rho=0x702dca50) at eval.c:189
#18 0x5370c in R_ReplConsole (rho=0x702dca50, savestack=0, browselevel=0)
    at main.c:274
#19 0x53b74 in mainloop () at main.c:465
#20 0xa0adc in main (ac=0, av=0xeffffc84) at system.c:641
#21 0x701eb8d0 in __libc_start_main () at ../sysdeps/generic/libc-start.c:78




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 18:20:22 1999
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Fri, 2 Jul 1999 19:20:22 +0200 (MET DST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "[" (PR#217)
Message-ID: <199907021720.TAA22201@pubhealth.ku.dk>

This message is in MIME format
--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Type: text/plain; charset=us-ascii

There was some discussion a while back on R-devel between Ross Ihaka,
Paul Gilbert and myself about row subsetting in time series.  I think
the consensus was that "[.ts" should not try to coerce its result
back to a time series object (which is underlying the problem here).
If you really do want to take a subseries from a regular time series,
a modified version of window.ts would do. I am attaching my
suggested modifications.
Martyn


On 02-Jul-99 maechler@stat.math.ethz.ch wrote:
> 
>>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at>
>>>>>> said:
> 
>     Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
>     > x<-cbind(1:10,2:11)
>     > x<-as.ts(x)
>     > plot(x)
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> This is definitely a bug
> --> CC: R-bugs
> 
> ALL NOTE : This is *not* new in 0.64.2
> 
> 
> 
>     Adrian> The problem is located in "[.ts":
> 
>     > x<-cbind(1:10,2:11)
>     > x[is.finite(x)]
>     Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
>     > x<-as.ts(x)
>     > x[is.finite(x)]
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> 
>     Adrian> and there (in "[.ts") the following statement gives the error:
> 
>     Adrian> Browse[1]>
>     Adrian> debug: li <- length(ind <- (1:n)[i])
> 
>     Adrian> However I don't understand what this part exactly does?
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _

----------------------------------
E-Mail: Martyn Plummer <plummer@iarc.fr>
Date: 02-Jul-99
Time: 18:02:32

This message was sent by XFMail
----------------------------------

--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Disposition: attachment; filename="tsfix"
Content-Transfer-Encoding: 7bit
Content-Description: tsfix
Content-Type: text/plain; charset=us-ascii; name=tsfix; SizeOnDisk=1838

"[.ts" <- function (x, i, j, drop = TRUE) 
{
    y <- NextMethod("[")
    if (missing(i)) 
        ts(y, start = start(x), freq = frequency(x))
    else y
}

"window.ts" <-
function (x, start, end, frequency, deltat) 
{
    x <- as.ts(x)
    xtsp <- tsp(x)
    xfreq <- xtsp[3]
    xtime <- time(x)
    ts.eps <- .Options$ts.eps
    if (missing(frequency) && missing(deltat)) 
        yfreq <- xfreq
    else if (missing(deltat)) 
        yfreq <- frequency
    else if (missing(frequency)) 
        yfreq <- 1/deltat
    if (xfreq%%yfreq < ts.eps) {
        thin <- round(xfreq/yfreq)
        yfreq <- xfreq/thin
    }
    else {
        thin <- 1
        yfreq <- xfreq
        warning("Frequency not changed")
    }
    start <- if (missing(start)) 
        xtsp[1]
    else switch(length(start), start, start[1] + (start[2] - 
        1)/xfreq, stop("Bad value for start"))
    if (start < xtsp[1]) {
        start <- xtsp[1]
        warning("start value not changed")
    }
    end <- if (missing(end)) 
        xtsp[2]
    else switch(length(end), end, end[1] + (end[2] - 1)/xfreq, 
        stop("Bad value for end"))
    if (end > xtsp[2]) {
        end <- xtsp[2]
        warning("end value not changed")
    }
    if (start > end) 
        stop("start cannot be after end")
    if (all(abs(start - xtime) > abs(start) * ts.eps)) {
        start <- xtime[(xtime > start) & ((start + 1/xfreq) > 
            xtime)]
    }
    if (all(abs(end - xtime) > abs(end) * ts.eps)) {
        end <- xtime[(xtime < end) & ((end - 1/xfreq) < xtime)]
    }
    i <- seq(trunc((start - xtsp[1]) * xfreq + 1.5), trunc((end - 
        xtsp[1]) * xfreq + 1.5), by = thin)
    y <- if (is.matrix(x)) 
        x[i, , drop = FALSE]
    else x[i]
    ystart <- xtime[i[1]]
    yend <- xtime[i[length(i)]]
    tsp(y) <- c(ystart, yend, yfreq)
    y
}


--_=XFMail.1.3.p0.Linux:990702182137:16900=_--
End of MIME message

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 17:21:37 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 02 Jul 1999 18:21:37 +0200 (CEST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["
In-Reply-To: <199907021644.SAA21974@pubhealth.ku.dk>
Message-ID: <XFMail.990702182137.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Type: text/plain; charset=us-ascii

There was some discussion a while back on R-devel between Ross Ihaka,
Paul Gilbert and myself about row subsetting in time series.  I think
the consensus was that "[.ts" should not try to coerce its result
back to a time series object (which is underlying the problem here).
If you really do want to take a subseries from a regular time series,
a modified version of window.ts would do. I am attaching my
suggested modifications.
Martyn


On 02-Jul-99 maechler@stat.math.ethz.ch wrote:
> 
>>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at>
>>>>>> said:
> 
>     Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
>     > x<-cbind(1:10,2:11)
>     > x<-as.ts(x)
>     > plot(x)
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> This is definitely a bug
> --> CC: R-bugs
> 
> ALL NOTE : This is *not* new in 0.64.2
> 
> 
> 
>     Adrian> The problem is located in "[.ts":
> 
>     > x<-cbind(1:10,2:11)
>     > x[is.finite(x)]
>     Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
>     > x<-as.ts(x)
>     > x[is.finite(x)]
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> 
>     Adrian> and there (in "[.ts") the following statement gives the error:
> 
>     Adrian> Browse[1]>
>     Adrian> debug: li <- length(ind <- (1:n)[i])
> 
>     Adrian> However I don't understand what this part exactly does?
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _

----------------------------------
E-Mail: Martyn Plummer <plummer@iarc.fr>
Date: 02-Jul-99
Time: 18:02:32

This message was sent by XFMail
----------------------------------

--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Disposition: attachment; filename="tsfix"
Content-Transfer-Encoding: 7bit
Content-Description: tsfix
Content-Type: text/plain; charset=us-ascii; name=tsfix; SizeOnDisk=1838

"[.ts" <- function (x, i, j, drop = TRUE) 
{
    y <- NextMethod("[")
    if (missing(i)) 
        ts(y, start = start(x), freq = frequency(x))
    else y
}

"window.ts" <-
function (x, start, end, frequency, deltat) 
{
    x <- as.ts(x)
    xtsp <- tsp(x)
    xfreq <- xtsp[3]
    xtime <- time(x)
    ts.eps <- .Options$ts.eps
    if (missing(frequency) && missing(deltat)) 
        yfreq <- xfreq
    else if (missing(deltat)) 
        yfreq <- frequency
    else if (missing(frequency)) 
        yfreq <- 1/deltat
    if (xfreq%%yfreq < ts.eps) {
        thin <- round(xfreq/yfreq)
        yfreq <- xfreq/thin
    }
    else {
        thin <- 1
        yfreq <- xfreq
        warning("Frequency not changed")
    }
    start <- if (missing(start)) 
        xtsp[1]
    else switch(length(start), start, start[1] + (start[2] - 
        1)/xfreq, stop("Bad value for start"))
    if (start < xtsp[1]) {
        start <- xtsp[1]
        warning("start value not changed")
    }
    end <- if (missing(end)) 
        xtsp[2]
    else switch(length(end), end, end[1] + (end[2] - 1)/xfreq, 
        stop("Bad value for end"))
    if (end > xtsp[2]) {
        end <- xtsp[2]
        warning("end value not changed")
    }
    if (start > end) 
        stop("start cannot be after end")
    if (all(abs(start - xtime) > abs(start) * ts.eps)) {
        start <- xtime[(xtime > start) & ((start + 1/xfreq) > 
            xtime)]
    }
    if (all(abs(end - xtime) > abs(end) * ts.eps)) {
        end <- xtime[(xtime < end) & ((end - 1/xfreq) < xtime)]
    }
    i <- seq(trunc((start - xtsp[1]) * xfreq + 1.5), trunc((end - 
        xtsp[1]) * xfreq + 1.5), by = thin)
    y <- if (is.matrix(x)) 
        x[i, , drop = FALSE]
    else x[i]
    ystart <- xtime[i[1]]
    yend <- xtime[i[length(i)]]
    tsp(y) <- c(ystart, yend, yfreq)
    y
}


--_=XFMail.1.3.p0.Linux:990702182137:16900=_--
End of MIME message
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  2 18:27:58 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Jul 1999 19:27:58 +0200
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Martyn Plummer's message of "Fri, 02 Jul 1999 17:52:17 +0200 (CEST)"
References: <XFMail.990702175217.plummer@iarc.fr>
Message-ID: <x2u2rnarmp.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> Vin Everett, who is actually doing the compiling, has provided output
> from gdb, which is given below. Any help would be greatly appreciated.
> 
> Martyn
> 
> > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0xb1dc8 in hqr2_ ()
> (gdb) 
> 
> bt gives:-
> (gdb) bt
> #0  0xb1dc8 in hqr2_ ()
> #1  0xb4bb4 in rg_ ()

You kind of forgot to tell us which version of R and which
compiler.... 

The first thing I'd try would be to change the FFLAGS line in Makeconf
to -g and recompile eigen.o. That way gdb would at least tell you
exactly where it crashes.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Mon Jul  5 09:21:44 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Mon, 05 Jul 1999 08:21:44 +0000
Subject: Problem with plot.ts, "["
References: <377CE74E.A742EB01@wu-wien.ac.at> <x2vhc3at84.fsf@blueberry.kubism.ku.dk>
Message-ID: <37806B18.F08AFB2D@wu-wien.ac.at>

Peter Dalgaard BSA wrote:

> Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> writes:
>
> > There seems to be a problem with plot.ts (R Version 0.64.2)
> >
> > >x<-cbind(1:10,2:11)
> > >x<-as.ts(x)
> > >plot(x)
> > Error: subscript (20) out of bounds, should be at most 10
> > >
> >
>
> If it's any consolation to you, this didn't work in 0.64.1 and not in
> 0.65unstable either, although it gets a different error there...
>
> > The problem is located in "[.ts":
> >
> > > x<-cbind(1:10,2:11)
> > > x[is.finite(x)]
> >  [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> > > x<-as.ts(x)
> > > x[is.finite(x)]
> > Error: subscript (20) out of bounds, should be at most 10
> > >
> >
> > and there (in "[.ts") the following statement gives the error:
>
> Actually, I suspect that the mistake is to do  x[is.finite(x)] in the
> first place. It is used to calculate ranges for plot limits, but one
> might better have used range(x,finite=TRUE) for that.

In fact, that works fine and does not affect the "[.ts" method.

Concerning "[.ts" method, I think the user expects that it works
like the "[" for vectors and matrices with further setting the
tsp attributes correctly. Hence, also for me the actual behaviour
is more a bug than a feature...

thanks

Adrian

>
>
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul  5 14:27:12 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 05 Jul 1999 09:27:12 -0400
Subject: Problem with plot.ts, "["
References: <377CE74E.A742EB01@wu-wien.ac.at> <x2vhc3at84.fsf@blueberry.kubism.ku.dk> <37806B18.F08AFB2D@wu-wien.ac.at>
Message-ID: <3780B2AD.26375290@bank-banque-canada.ca>

>Concerning "[.ts" method, I think the user expects that it works
>like the "[" for vectors and matrices with further setting the
>tsp attributes correctly.

The problem is that for any complicated subset in the time dimesion it
becomes very difficult to decide what the correct tsp attributes should
be. I think after previous discussions we agreed that window should be
used to preserve attributes in the time dimension and "[.ts" should drop
any ts attributes. In the non-time dimension it makes more sense to
preserve ts attributes, but S does not, as I recall. I'm not sure what
the status of this change is, but I don't think the behaviour is the
same in 0.65 as it was in 0.64.1.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From vin.everett@mrc-bsu.cam.ac.uk  Mon Jul  5 16:56:12 1999
From: vin.everett@mrc-bsu.cam.ac.uk (Vin Everett)
Date: Mon, 05 Jul 1999 16:56:12 +0100
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Your message of "02 Jul 1999 19:27:58 +0200."
 <x2u2rnarmp.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907051556.QAA24294@bernstein.mrc-bsu.cam.ac.uk>


Hello Peter,

I hope this is more helpful ?

-g flag, using g77 version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release) (from FSF-g77 version 0.5.24-19981002)

And srpms R-base-0.64.1-6.src.rpm


Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) bt
#0  hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
#1  0xb4c10 in rg_ (nm=0x70d99fd0, n=0x70d99fc8, a=0x70d99f80, wr=0x70d99f68, 
    wi=0x70d99f50, matz=0x70d99f48, z=0x70d99f00, iv1=0x70d99ef0, 
    fv1=0x70d99ed8, ierr=0x70d99ed0) at eigen.f:3263
#2  0x3909c in do_dotCode (call=0x70421f64, op=0x70421b90, args=0x70679f28, 
    env=0x7067791c) at dotcode.c:386
#3  0x3fc7c in eval (e=0x70421f64, rho=0x7067791c) at eval.c:180
#4  0x41118 in do_set (call=0x70421fa0, op=0x702d4828, args=0x70421f8c, 
    rho=0x7067791c) at eval.c:761
#5  0x3fc7c in eval (e=0x70421fa0, rho=0x7067791c) at eval.c:180
#6  0x40b58 in do_begin (call=0x70421fb4, op=0x702d48c8, args=0x70421fc8, 
    rho=0x7067791c) at eval.c:588
#7  0x3fc7c in eval (e=0x70421fb4, rho=0x7067791c) at eval.c:180
#8  0x40280 in do_if (call=0x70422ef0, op=0x702d44b8, args=0x70422edc, 
    rho=0x7067791c) at eval.c:379
#9  0x3fc7c in eval (e=0x70422ef0, rho=0x7067791c) at eval.c:180
#10 0x40b58 in do_begin (call=0x70422f04, op=0x702d48c8, args=0x70422f18, 
    rho=0x7067791c) at eval.c:588
#11 0x3fc7c in eval (e=0x70422f04, rho=0x7067791c) at eval.c:180
#12 0x40280 in do_if (call=0x70423120, op=0x702d44b8, args=0x7042310c, 
    rho=0x7067791c) at eval.c:379
#13 0x3fc7c in eval (e=0x70423120, rho=0x7067791c) at eval.c:180
#14 0x40b58 in do_begin (call=0x7041eddc, op=0x702d48c8, args=0x70423134, 
    rho=0x7067791c) at eval.c:588
#15 0x3fc7c in eval (e=0x7041eddc, rho=0x7067791c) at eval.c:180
#16 0x3ffcc in applyClosure (call=0x70677868, op=0x7042347c, 
    arglist=0x706778cc, rho=0x702dca50, suppliedenv=0x702d4008) at eval.c:293
#17 0x3fcf0 in eval (e=0x70677868, rho=0x702dca50) at eval.c:189
#18 0x53768 in R_ReplConsole (rho=0x702dca50, savestack=0, browselevel=0)
    at main.c:274
#19 0x53bd0 in mainloop () at main.c:465
#20 0xa0b38 in main (ac=0, av=0xeffffc84) at system.c:641
#21 0x701eb8d0 in __libc_start_main () at ../sysdeps/generic/libc-start.c:78


Cheers Vin

-------------------------------------------------------------------
Vin Everett                   email:  vin.everett@mrc-bsu.cam.ac.uk
Medical Research Council      voice:  +44 (0) 1223 330381 
Biostatistics Unit            fax:    +44 (0) 1223 330383 
Cambridge                     mobile: +44 (0) 468 828238 
Key fingerprint =  69 CE C7 59 9B 7C AB 57  B0 B5 47 2A 1E 99 49 30
-------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Jul  5 17:43:20 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 05 Jul 1999 18:43:20 +0200
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Vin Everett's message of "Mon, 05 Jul 1999 16:56:12 +0100"
References: <199907051556.QAA24294@bernstein.mrc-bsu.cam.ac.uk>
Message-ID: <x2so73yrmf.fsf@blueberry.kubism.ku.dk>

Vin Everett <vin.everett@mrc-bsu.cam.ac.uk> writes:

> Hello Peter,
> 
> I hope this is more helpful ?
> 
> -g flag, using g77 version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release) (from FSF-g77 version 0.5.24-19981002)
> 
> And srpms R-base-0.64.1-6.src.rpm
> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
>     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
>     at eigen.f:2120
> 2120                   RA = RA + H(I,J) * H(J,NA)
> Current language:  auto; currently fortran
> (gdb) bt

Fine, now what is the value of i,j, and na at that point? (the p
function in gdb) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From vin.everett@mrc-bsu.cam.ac.uk  Tue Jul  6 10:53:59 1999
From: vin.everett@mrc-bsu.cam.ac.uk (Vin Everett)
Date: Tue, 06 Jul 1999 10:53:59 +0100
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Your message of "05 Jul 1999 18:43:20 +0200."
 <x2so73yrmf.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907060953.KAA01225@bernstein.mrc-bsu.cam.ac.uk>


Hi Peter, sorry for the tardiness, I have been in a meeting the gdb p option 
provides no history.

Cheers Vin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Wed Jul  7 06:15:02 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed, 7 Jul 1999 07:15:02 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199907070515.HAA10215@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 192 *
Subject: dev.print aspect ratio
From: wsi@gcal.ac.uk
Date: Tue, 11 May 1999 13:43:50 +0200 (MET DST)
--Difficulty getting a square plot.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.
* PR# 211 *
Subject: readline/history size
From: seniorr@teleport.com
Date: Tue, 15 Jun 1999 00:08:59 +0200 (MET DST)
--Limitation of history size. Kurt cannot reproduce. 
--Depends on libreadline version??

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 118 *
Subject: Function parsing
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 10 Feb 1999 13:42:01 +0000 (GMT)
--comment placement.

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

* PR# 21 *
Subject: Restoring large image files
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 21 Aug 1998 13:29:16 -0000 ()
--Request to change in error conditions in R_InitialData. Could be done, but
--at present initial loads are not distinguished from load("file") calls. 

Directory:  System-specific

* PR# 145 *
Subject: R-0.63.3 package on IRIX 6.5 machine
From: Jayshree Sarma <jsarma@cs.gmu.edu>
Date: Tue, 23 Mar 1999 16:54:20 -0500 (EST)
* PR# 163 *
Subject: IRIX compile
From: mtim@farm.ecs.umass.edu
Date: Sat, 10 Apr 1999 19:35:43 +0200
* PR# 196 *
Subject: R 0.64 and -release fails to build on DU4.0
From: Leif Johansson <leifj@matematik.su.se>
Date: Fri, 14 May 1999 12:32:14 +0200
* PR# 201 *
Subject: RedHat Linux 6.0 Problems
From: jacobm@magnet.drcmr.dk
Date: Wed, 2 Jun 1999 10:58:45 +0200 (MET DST)
* PR# 208 *
Subject: R correct g77 flags for Linux/Alpha
From: Naoki Takebayashi <ntakebay@bio.indiana.edu>
Date: Tue, 8 Jun 1999 19:12:03 -0500 (EST)
* PR# 209 *
Subject: Compilation fails
From: beimfohr@statistik.uni-dortmund.de
Date: Thu, 10 Jun 1999 13:52:01 +0200 (MET DST)
* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 216 *
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 2 Jul 1999 18:45:20 +0200
* PR# 217 *
Subject: RE: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 02 Jul 1999 18:21:37 +0200 (CEST)
Date: 02-Jul-99
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jperez@cesma.usb.ve  Wed Jul  7 15:23:54 1999
From: jperez@cesma.usb.ve (jperez@cesma.usb.ve)
Date: Wed, 7 Jul 1999 16:23:54 +0200 (MET DST)
Subject: Bug on sample (PR#219)
Message-ID: <199907071423.QAA19825@pubhealth.ku.dk>

Full_Name: Jose M. Perez
Version: 0.64.2
OS: Linux/x86
Submission from: (NULL) (159.90.200.68)


sample(1,1,prob=c(1))
Causes a core dump.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jperez@cesma.usb.ve  Wed Jul  7 15:23:33 1999
From: jperez@cesma.usb.ve (jperez@cesma.usb.ve)
Date: Wed, 7 Jul 1999 16:23:33 +0200 (MET DST)
Subject: Bug on sample (PR#218)
Message-ID: <199907071423.QAA19811@pubhealth.ku.dk>

Full_Name: Jose M. Perez
Version: 0.61.2
OS: Linux/x86
Submission from: (NULL) (159.90.200.68)


sample(1,1,prob=c(1))
Causes a core dump.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 15:45:41 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 16:45:41 +0200
Subject: Bug on sample (PR#219)
In-Reply-To: jperez@cesma.usb.ve's message of "Wed, 7 Jul 1999 16:23:54 +0200 (MET DST)"
References: <199907071423.QAA19825@pubhealth.ku.dk>
Message-ID: <x2oghobjsa.fsf@blueberry.kubism.ku.dk>

jperez@cesma.usb.ve writes:

> sample(1,1,prob=c(1))
> Causes a core dump.

...confirmed. prob=1 is not necessary, sample(1,1,,.1) crashes too.

Cause: revsort() does horrible things if n <= 1. Will fix.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Jul  7 17:35:36 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 7 Jul 1999 18:35:36 +0200 (CEST)
Subject: Almost succesfull build on AIX
Message-ID: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>


Hi,

Kurt Hornik and myself have an almost successful build of R on AIX 
including dynamic loading of libraries ... which fails make check :-(
Anyway, as we have no AIX experience at all, maybe somebody else knows
what's going on.

Here's the problem:

> 1/0
[1]INF
> is.finite(1/0)
[1] TRUE

R was built using the flags included below, gcc version is 2.7.2. Does
anybody with experience on AIX know what's going on (the all uppercase
INF looks somewhat suspicious).

If you want to give it a try, in tomorrow's devel snapshot from CRAN
all configure/make scripts should be sufficent for a usual compile,
i.e., simply say
	configure; make
using GNU make and the install-sh from the tools directory (the
installbsd on our AIX machine fails).

Best,
Fritz

**********************************************************

> version
           _                           
platform   rs6000-ibm-aix4.2.1.0       
arch       rs6000                      
os         aix4.2.1.0                  
system     rs6000, aix4.2.1.0          
status     Under development (unstable)
status.rev 0                           
major      0                           
minor      65.0                        
year       1999                        
month      July                        
day        08                          
language   R                           


**********************************************************


PACKAGE = R
VERSION = 0.65.0

AR = ar
BLAS = 
CC = gcc
CFLAGS = -g -O2
CPICFLAGS = -fPIC
CPPFLAGS = 
DEFS = -DHAVE_CONFIG_H
DLLFLAGS = -bdynamic -bE:$(top_builddir)/etc/R.exp -bM:SRE -lc -lm
DVIPS = /usr/local/bin/dvips
FC = f77
FFLAGS = 
FLIBS = -lblas  -L/usr/local/lib -lxlf90 -lxlf -lm
FPICFLAGS = -fPIC
F2C = 
F2CFLAGS = 
GNOMEUI_LIBS = 
GNOME_LIBDIR = 
GNOME_INCLUDEDIR = 
INSTALL = /tmp/fl/R/tools/install-sh -c
INSTALL_DATA = ${INSTALL} -m 644
INSTALL_PROGRAM = ${INSTALL}
INSTALL_DIR = ${INSTALL} -d
LATEX = /usr/local/bin/latex
LDCMD = f77
LDFLAGS = 
LIBS = -ldl -ltermcap -lm 
LN_S = ln -s
MAKEINDEX = /usr/local/bin/makeindex
MKINSTALLDIRS = $(top_srcdir)/tools/mkinstalldirs
R_XTRA_CFLAGS = 
R_XTRA_CPPFLAGS = -I. -I../include -I$(top_srcdir)/src/include
R_XTRA_FFLAGS = 
R_XTRA_LIBS = 
RANLIB = ranlib
SHELL = /bin/sh
SHLIBEXT = so
SHLIBLD = f77
SHLIBLDFLAGS = -bM:SRE -H512 -T512 -bnoentry -bexpall       -bI:$(R_HOME)/etc/R.
exp -lc -lm
TAR = tar
X_CFLAGS = 
X_LIBS =  -lX11
X_PRE_LIBS = 
X_EXTRA_LIBS = 
YACC = bison -y
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul  7 18:00:11 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Jul 1999 19:00:11 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>
References: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>
Message-ID: <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>

>>>>> Friedrich Leisch writes:

> Hi,

> Kurt Hornik and myself have an almost successful build of R on AIX 
> including dynamic loading of libraries ... which fails make check :-(
> Anyway, as we have no AIX experience at all, maybe somebody else knows
> what's going on.

> Here's the problem:

>> 1/0
> [1]INF
>> is.finite(1/0)
> [1] TRUE

> R was built using the flags included below, gcc version is 2.7.2. Does
> anybody with experience on AIX know what's going on (the all uppercase
> INF looks somewhat suspicious).

> If you want to give it a try, in tomorrow's devel snapshot from CRAN
> all configure/make scripts should be sufficent for a usual compile,
> i.e., simply say
> 	configure; make
> using GNU make and the install-sh from the tools directory (the
> installbsd on our AIX machine fails).

If I may add.  Building for me only works with LDCMD and SHLIBLD as

	f77
or
	cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

It did not work with

	ld (gives an exec format error in the main binary)
or
	gcc (cannot find libgcc.a???)

I am not sure up to what extend this is a problem with AIX in general or
the specific system Fritz and I have access to, which in particular has
gcc built 3 years ago for AIX 3.something.

Perhaps someone knows more about this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.princeton.edu  Wed Jul  7 20:43:33 1999
From: ben@eno.princeton.edu (Ben Bolker)
Date: Wed, 7 Jul 1999 15:43:33 -0400 (EDT)
Subject: superscript -,+?
Message-ID: <Pine.SUN.3.95.990707153807.18452A-100000@paca>


  In Version 0.64.1  (May 8, 1999), Solaris 2.5.1,

   expression(theta^{-})
      
      and

   expression(theta^{+})

 (and the equivalent subscripts) give syntax errors.

  (Superscript or subscripts of numbers, letters, or "+1" or "-1" all
work.)

  Anyone have a workaround or a patch?
  Or should I just use psfrag as god intended?

  Ben


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.princeton.edu  Wed Jul  7 20:52:47 1999
From: ben@eno.princeton.edu (Ben Bolker)
Date: Wed, 7 Jul 1999 15:52:47 -0400 (EDT)
Subject: answering my own question
Message-ID: <Pine.SUN.3.95.990707155129.18476A-100000@paca>


  expression(theta^{"+"})
  expression(theta^{"-"})
  expression({theta^{"+"}}(mu)})

  etc., work fine (once I actually *thought* about what the problem was)

 Ben B.

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Wed Jul  7 21:39:44 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Wed, 07 Jul 1999 16:39:44 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Wed, 07 Jul 1999 19:00:11 EDT."
 <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>
Message-ID: <199907072039.QAA29250@infiniti.ece.cmu.edu>


"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>> Here's the problem:
>>> 1/0
>> [1]INF
>>> is.finite(1/0)
>> [1] TRUE

Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
program.  Should this not result in a floating point exception?

>> R was built using the flags included below, gcc version is 2.7.2. Does
>> anybody with experience on AIX know what's going on (the all uppercase
>> INF looks somewhat suspicious).

Because it's a return value, not the R string "Inf".  Wild guess,
lemme think about it.

Kurt> If I may add.  Building for me only works with LDCMD and SHLIBLD as
Kurt> 
Kurt> f77
Kurt> or
Kurt> cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

Yes, there is still something wrong with the DLLFLAGS.  (Which also
shows up when you try to link local libraries (like a private copy of
the readline lib).)   I've played a little more with the way R.exp is
generated.  Let me try it on 64.2 and 65.

Kurt> It did not work with
Kurt> ld (gives an exec format error in the main binary)

My experience is that if I compile the main function with gcc then I
have to link with gcc, otherwise it can't find .__main.  Which leads
to:

Kurt> gcc (cannot find libgcc.a???)
Yep and hmm.  Arne found that you can say "gcc --print-libgcc-file-name" and
then gcc actually does that.  You can add the result of the command on
the link line.  (If however gcc never finds libgcc.a then you're in
deep trouble.  Check wether you can find gcc's spec file.)

Kurt> I am not sure up to what extend this is a problem with AIX in general or
Kurt> the specific system Fritz and I have access to, which in particular has
Kurt> gcc built 3 years ago for AIX 3.something.

Probably something with AIX in general.

BTW, do you not get compiler errors about blkcnt not being defined
when you compile with gcc?  So far, I had to patch most programs
because there is a bug with the standard include files.

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 22:17:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 23:17:55 +0200
Subject: [R] superscript -,+?
In-Reply-To: Ben Bolker's message of "Wed, 7 Jul 1999 15:43:33 -0400 (EDT)"
References: <Pine.SUN.3.95.990707153807.18452A-100000@paca>
Message-ID: <x2lncsupks.fsf@blueberry.kubism.ku.dk>

Ben Bolker <ben@eno.princeton.edu> writes:

>   In Version 0.64.1  (May 8, 1999), Solaris 2.5.1,
> 
>    expression(theta^{-})
>       
>       and
> 
>    expression(theta^{+})
> 
>  (and the equivalent subscripts) give syntax errors.
> 
>   (Superscript or subscripts of numbers, letters, or "+1" or "-1" all
> work.)
> 
>   Anyone have a workaround or a patch?
>   Or should I just use psfrag as god intended?
> 

Both theta^"+" and theta^+{} seem to work ok. The thing to remember is
that + is an operator so if it is used in an expression, it needs to
have something to operate on, or you need to explicitly use it as a
character.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 22:35:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 23:35:37 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: Thomas Vogels's message of "Wed, 07 Jul 1999 16:39:44 -0400"
References: <199907072039.QAA29250@infiniti.ece.cmu.edu>
Message-ID: <x2k8scuora.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 
> >> Here's the problem:
> >>> 1/0
> >> [1]INF
> >>> is.finite(1/0)
> >> [1] TRUE
> 
> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
> program.  Should this not result in a floating point exception?

Not according to IEEE specs (but integer divide by zero is generally
unmaskable). The interesting thing is that is.finite returns TRUE on
the result, and the printing also suggests that the infinite value is
not recognised internally (if it were, it would get printed as 
> 1/0
[1] Inf
)

It would be nice to see the actual bit pattern of 1/.0. Could one of
you do something like

	x = 1/.0;
	printf("%0x,%0x\n", ((int *) &x)[0], ((int *) &x)[1]);

or whatever other obfuscation works on AIX...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kriszti@a2a00996.direct.bconnected.net  Thu Jul  8 06:55:43 1999
From: kriszti@a2a00996.direct.bconnected.net (kriszti@a2a00996.direct.bconnected.net)
Date: Thu, 8 Jul 1999 07:55:43 +0200 (MET DST)
Subject: Bad Units Bug in barplot with pictex output device. (PR#220)
Message-ID: <199907080555.HAA22260@pubhealth.ku.dk>

Dear Bug Team:

I encountered a bug when trying to make a barplot with the pictex
output device.

The following commands demonstrate the bug:

-----------------------------------------------
> errors <- c(3.08, 35.38, 33.85, 20.00,  7.69)
> errors
[1]  3.08 35.38 33.85 20.00  7.69
> pictex()
> barplot(errors)
Error: Bad units specified in GConvert, please report!
> 
-----------------------------------------------

Here is my R version information:

-----------------------------------------------
> Version()
$platform
[1] "i386-unknown-freebsd2.2.7"

$arch
[1] "i386"

$os
[1] "freebsd2.2.7"

$system
[1] "i386, freebsd2.2.7"

$status
[1] ""

$status.rev
[1] "0"

$major
[1] "0"

$minor
[1] "62.2"

$year
[1] "1998"

$month
[1] "July"

$day
[1] "10"

$language
[1] "R"

---------------------------------------------------

Thank you very much for all your good work on R!

Best regards,

Krisztina Vasarhelyi
Anthropologisches Institut der
Universitaet Zuerich
krva@aim.unizh.ch

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul  8 07:34:00 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 8 Jul 1999 08:34:00 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907072039.QAA29250@infiniti.ece.cmu.edu>
References: <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>
 <199907072039.QAA29250@infiniti.ece.cmu.edu>
Message-ID: <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>> Here's the problem:
>>>> 1/0
>>> [1]INF
>>>> is.finite(1/0)
>>> [1] TRUE

Ah ... but FRITZ wrote that ...

> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
> program.  Should this not result in a floating point exception?

>>> R was built using the flags included below, gcc version is 2.7.2. Does
>>> anybody with experience on AIX know what's going on (the all uppercase
>>> INF looks somewhat suspicious).

> Because it's a return value, not the R string "Inf".  Wild guess,
> lemme think about it.

Kurt> If I may add.  Building for me only works with LDCMD and SHLIBLD as
Kurt> 
Kurt> f77
Kurt> or
Kurt> cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

> Yes, there is still something wrong with the DLLFLAGS.  (Which also
> shows up when you try to link local libraries (like a private copy of
> the readline lib).)   I've played a little more with the way R.exp is
> generated.  Let me try it on 64.2 and 65.

Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!

Kurt> It did not work with
Kurt> ld (gives an exec format error in the main binary)

> My experience is that if I compile the main function with gcc then I
> have to link with gcc, otherwise it can't find .__main.  Which leads
> to:

Kurt> gcc (cannot find libgcc.a???)

> Yep and hmm.  Arne found that you can say "gcc
> --print-libgcc-file-name" and then gcc actually does that.  You can
> add the result of the command on the link line.  (If however gcc never
> finds libgcc.a then you're in deep trouble.  Check wether you can find
> gcc's spec file.)

The specs file is fine.  My question is, is that a known gcc problem on
AIX or is that due to the rather outdated version of gcc we have?  If it
is a general problem, I can easily add to DLLFLAGS.

Kurt> I am not sure up to what extend this is a problem with AIX in general or
Kurt> the specific system Fritz and I have access to, which in particular has
Kurt> gcc built 3 years ago for AIX 3.something.

> Probably something with AIX in general.

> BTW, do you not get compiler errors about blkcnt not being defined
> when you compile with gcc?  So far, I had to patch most programs
> because there is a bug with the standard include files.

No.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 08:27:39 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 09:27:39 +0200
Subject: Bad Units Bug in barplot with pictex output device. (PR#220)
In-Reply-To: <199907080555.HAA22260@pubhealth.ku.dk>
 (kriszti@a2a00996.direct.bconnected.net)
References: <199907080555.HAA22260@pubhealth.ku.dk>
Message-ID: <199907080727.JAA21615@sophie.ethz.ch>

Dear Krisztina
The bug you reported has been fixed a while ago.

you "only" need to upgrade your version of R.
As you said it's 0.62.2 of July 1998.

Just get 0.64.2 of July 1999...
from any CRAN mirror, ie. in your case from  http://stat.ethz.ch/CRAN/

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 09:24:15 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 10:24:15 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: <x2k8scuora.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 07 Jul 1999 23:35:37 +0200)
References: <199907072039.QAA29250@infiniti.ece.cmu.edu> <x2k8scuora.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907080824.KAA26378@sophie.ethz.ch>

>>>>> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:
    >> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

      > >> Here's the problem:
      > >>> 1/0
      > >> [1]INF
      > >>> is.finite(1/0)
      > >> [1] TRUE

    >> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
    >> program.  Should this not result in a floating point exception?

    PD> Not according to IEEE specs (but integer divide by zero is
    PD> generally unmaskable). The interesting thing is that is.finite
    PD> returns TRUE on the result, and the printing also suggests that the
    PD> infinite value is not recognised internally (if it were, it would
    PD> get printed as
    >> 1/0
    PD> [1] Inf )

    PD> It would be nice to see the actual bit pattern of 1/.0. Could one
    PD> of you do something like

    PD>    x = 1/.0; printf("%0x,%0x\n", ((int *) &x)[0], ((int *) &x)[1]);

    PD> or whatever other obfuscation works on AIX...

I've done more than Peter requested;
namely, the "finite" probing has always been a big problem on AIX,
and I rediscovered my old testing code -- which I enhanced with Peter's HEX
dump proposal:
  [everything in  ftp://stat.ethz.ch/U/maechler/R/AIX-finite-tst.tar.gz !]

    #include <stdio.h>
    #include <math.h>

    #ifdef AIX
    # include <fp.h>
    #endif

    main() {
      double x,x2,x3;
      printf("finite(1.0)= %d (=1, hopefully)\n", finite(1.0));
      x=1./0.; x2= (-1.)/0.;  x3 = 0./0.;
      printf("Inf := 1/0 = %f;\t -Inf := -1/0 = %f;\t NaN:= 0/0 = %f\n",x, x2, x3);
      printf("finite(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
	     finite(x),finite(x2),finite(x3));
      printf("Now the `bits':\n");
      printf(" Inf : %0x,%0x\n", ((int *) &x )[0], ((int *) &x )[1]);
      printf("-Inf : %0x,%0x\n", ((int *) &x2)[0], ((int *) &x2)[1]);
      printf(" NaN : %0x,%0x\n", ((int *) &x3)[0], ((int *) &x3)[1]);

    #ifdef AIX
      printf("FINITE(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
	     FINITE(x),FINITE(x2),FINITE(x3));
    #endif
    }

------------
And I have this in my Makefile  [also available on Web, s.above]

    ## on AIX (percol)
    #CFLAGS = -D_XOPEN_SOURCE -DAIX
    # better for R (defines cosh(.)  AND fd_set(.) (sys/time.h):
    CFLAGS = -D_XOPEN_SOURCE_EXTENDED=1 -DAIX

My Conclusions: 

  - Only if I use these CFLAGS does  finite work properly.
  - The bit pattern are compiler-independent for +-Inf, but NOT for NaN :

Here is gcc [with above CFLAGS],  gcc version 2.7.2.3,  output:
----------------------------------
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;	 -Inf := -1/0 = -INF;	 NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
----------------------------------

xlc (the native AIX C compiler) gives the same BUT for the NaN bit pattern
where it has

 NaN : 7ff80000,0

------------------------

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 11:36:36 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 12:36:36 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: <199907080824.KAA26378@sophie.ethz.ch> (message from Martin
 Maechler on Thu, 8 Jul 1999 10:24:15 +0200)
References: <199907072039.QAA29250@infiniti.ece.cmu.edu> <x2k8scuora.fsf@blueberry.kubism.ku.dk> <199907080824.KAA26378@sophie.ethz.ch>
Message-ID: <199907081036.MAA02797@sophie.ethz.ch>

To add to my last E-mail  
where I said more-or-less

      ``we need  CFLAGS   -D_XOPEN_SOURCE_EXTENDED=1  

        for finite() and things to work ''

I now have put this into  config.site,
but then the compilation breaks when trying to compile 
src/unix/sock.c

it seems because of broken combination of header files 
   /usr/include/netinet/in_systm.h
   /usr/include/netinet/tcp.h
   /usr/include/netinet/ip.h

Maybe,  sock.c  {and further files?}
use other CFLAGS explicitly ?

Here the beginning of the long compilation error messages:

 gcc -I. -I../include -I../../src/include   -DHAVE_CONFIG_H  -g -O2 -D_XOPEN_SOURCE_EXTENDED=1 -c sock.c -o sock.o

 In file included from /usr/include/netinet/ip.h:75,
		  from /usr/include/netinet/tcp.h:72,
		  from sock.c:25:
 /usr/include/netinet/in_systm.h:79: parse error before `n_short'
 /usr/include/netinet/in_systm.h:79: warning: data definition has no type or storage class
 /usr/include/netinet/in_systm.h:80: parse error before `n_long'
 /usr/include/netinet/in_systm.h:80: warning: data definition has no type or storage class
 /usr/include/netinet/in_systm.h:82: parse error before `n_time'
 /usr/include/netinet/in_systm.h:82: warning: data definition has no type or storage class
 In file included from /usr/include/netinet/tcp.h:72,
		  from sock.c:25:
 /usr/include/netinet/ip.h:104: parse error before `u_long'
 /usr/include/netinet/ip.h:104: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:104: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:114: parse error before `ip_xhl'
 /usr/include/netinet/ip.h:114: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:119: warning: data definition has no type or storage class
 /usr/include/netinet/ip.h:120: parse error before `}'
 /usr/include/netinet/ip.h:120: warning: data definition has no type or storage class
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul  8 14:52:10 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Jul 1999 15:52:10 +0200
Subject: r-bugs going down temporarily (upgrade)
Message-ID: <x27lobw8ol.fsf@blueberry.kubism.ku.dk>

I'll start upgrading the computer running the r-bugs web server in a
moment (to RedHat 6.0). This *should* be a relatively painless
operation, but you never know... Email to r-bugs is handled by a
different machine and should remain unaffected.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Jul  8 19:05:43 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 08 Jul 1999 14:05:43 -0400
Subject: summary.default & is.recursive
References: <199907071321.PAA16206@sophie.ethz.ch> <378361E6.5BF86D8C@bank-banque-canada.ca> <199907080634.IAA21541@sophie.ethz.ch> <3784BC8C.6801672@bank-banque-canada.ca> <199907081615.SAA08660@sophie.ethz.ch>
Message-ID: <3784E877.40D25BE9@bank-banque-canada.ca>

I'm moving this part of an on-going discussion to r-devel because I think I've
uncovered a bug:

>summary.default :  How is yours different from R's (I didn't try to find out)
>       If it has an advantage you should post to R-devel as a proposal

I did propose  it along time ago, but ... The fix was for a bug that Splus 3.2
and 3.3 have. It does not work properly with lists having an object with class
length greater than 1. I reported it to StatSci and it was suppose to get fixed
in 3.3 but didn't. I'm not sure about later versions. Having now just checked R,
I see that R's summary.default has been changed. But the problem does not occur
because another more serious incompatibility occurs first:

z <- 1:3
class(z) <- c("a", "b")

is.recursive(list(z, a=list(1:3)) )

R64.2:>   [1] FALSE
Splus3.3> [1] T


My change to summary.default was to fix the following warning in Splus3.2 and
3.3:

> summary.default(list(z, a=list(1:3)))
  Length Class    Mode
  3      a     numeric
a 1            list
Warning messages:
  Replacement length not a multiple of number of elements to replace in: sumry[
 i, 2] <- class(ii)

and consisted simply of changing

      sumry[i, 2] <- if (is.object(ii))
           class(ii)
to
   sumry[i, 2] <- if (is.object(ii))
        paste(class(ii), collapse=" ")

This may not be necessary in the current R version, but because of the above
error in is.recursive, that part of summary.default is not used now.


Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul  8 19:36:47 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu, 8 Jul 1999 20:36:47 +0200 (MET DST)
Subject: summary.default & is.recursive (PR#221)
Message-ID: <199907081836.UAA28992@pubhealth.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> is.recursive(list(z, a=list(1:3)) )
> 
> R64.2:>   [1] FALSE
> Splus3.3> [1] T

Yup, it's a bug. Cc'ed to r-bugs so that we don't forget.

> is.recursive(list(1,2))
[1] FALSE
> is.recursive(pairlist(1,2))
[1] TRUE

[maybe Martin would want to add a check that is.whatever works
identically on lists and pairlists. Not is.pairlist, though...]
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Thu Jul  8 05:14:11 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Thu, 8 Jul 1999 16:14:11 +1200
Subject: Gnome interface status report
Message-ID: <19990708161411.A97838@r.stat.auckland.ac.nz>

Hi,

The Gnome version now compiles, and it should also be working (at least as much as it
ever has).  I've changed Makefile.in to the new system, which is very cool.  What I
want to work on now is:

- Graphics.  I want to move to the Gnome canvas for this, which should be reasonably
  easy.  This will give us rotated text (which I never got going properly before) and
  the option for antialiased graphics.  However, there are some unimplemented bits in
  the canvas (and the antialiasing is currently a bit buggy), so this may take a while
  to get going properly.

- Printing.  This will hopefully include chucking text (like the console and help
  pages) to the print spooler, and somehow making graphics windows spit out PS files.
  If the Gnome print architecture ever gets finished, we will be able to do really
  cool printing stuff, but that might be a while.

- Preferences.  I need to add a few more things, and make some of the existing prefs
  actually do something.  Some of this will be easier once Brian Ripley's stuff to do
  with the command line parameters is finished, I think.

- Syntax highlighting.  Someone has written a widget that can do syntax highlighting,
  so I would like to base the R console on it.  This could take a bit of work, but
  would look fantastic.

I've decided to use Glade (http://glade.pn.org) for laying out the dialog boxes from
now on.  This will mean fixing a couple of things in Glade, and including libglade in
the R source (this will only affect the gnome part of the source, of course).  The
time savings from using Glade are incredible; writing the GUI code in C was horrible.

Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Jul  9 04:35:58 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Thu, 08 Jul 1999 23:35:58 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Thu, 08 Jul 1999 08:34:00 EDT."
 <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>
Message-ID: <199907090335.XAA03774@infiniti.ece.cmu.edu>


(If you don't care about R on AIX, happily ignore this email...)

First about Martin's question (concerning /usr/bin/make):
  I took a quick look at the Makefile.  The problem is with the
Makedeps target.  Replacing $< with $? solves the problem.  Shouldn't
but does.  Will this break on other platforms?  Shouldn't but may.

"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>> Yes, there is still something wrong with the DLLFLAGS.  (Which also
>> shows up when you try to link local libraries (like a private copy of
>> the readline lib).)   I've played a little more with the way R.exp is
>> generated.  Let me try it on 64.2 and 65.

Kurt> Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!
I know, but I also need a stable version.

Kurt> gcc (cannot find libgcc.a???)

If gcc cannot find libgcc.a for any other compilation, I'd get worried
in your place.  I might even get scared.
For R.binary linking it's simple and necessary to search for
libgcc.a and put it in the DLLFLAGS.  If you want to link with ld
instead of cc/f77, you have to add default libs, like -lxlf90 -lxlf
-lc -lm.  Which ones exactly, you can find out by calling ld with the
nobind option.  Most instructive since this will result in the binder
commands being printed.  

Kurt> The specs file is fine.  My question is, is that a known gcc problem on
Kurt> AIX or is that due to the rather outdated version of gcc we have?  If it
Kurt> is a general problem, I can easily add to DLLFLAGS.

See above.  But we may not be talking about the same.  When is
libgcc.a not found?

>> BTW, do you not get compiler errors about blkcnt not being defined
>> when you compile with gcc?  So far, I had to patch most programs
>> because there is a bug with the standard include files.

Hmm, I have gcc 2.8.1 (for AIX 4.1) which barfs at sys/stat.h and
friends. Somehow somebody forgot sometime about "typedef long
blk_cnt".  Or something close to this effect.

About DLLFLAGS, SHLIBLD etc:  Currently you'll probably need to know
the libraries (-lm -lxlf ...) when linking a shared lib since the
fortran library code is currently not exported via ldAIX4.  Is this
"bad"?  Is it worth spending time to get this right, i.e. R.binary
exports all symbols that are actually linked in?  Or can we live with
the baggage of extra libs in SHLIBFLAGS and a little bit bigger shared
libs?

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 15:18:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Jul 1999 16:18:37 +0200
Subject: Those #"&/! comments
Message-ID: <x2emihvrcy.fsf@blueberry.kubism.ku.dk>


I promised R-core write-up of my understanding of the comment
placement nastiness, but I might as well increase the scope to
R-devel:

(R moves, mangles, or deletes comments in mysterious ways -- see for
instance PR#118)

One basic issue is that any R parse tree can have 0, 1, or more
textual representations. Examples

quote(x)                   # one, presumably...
substitute(+x,x=list(1:2)) # none
quote("+"(2,2))	           # two

This means that parse and deparse are not inverses in any sense, and
since you cannot reliably reproduce the textual input, you cannot
place comments correctly either. Of course, one might just say that if
people do sneaky things, then they deserve whatever they get. 

But there's another snag: parse trees can contain any R object and the
only way of placing comments in a parse tree is by attaching them to
one of the nodes. So we have fun with objects carrying the "blah"
comment attribute all over the place, as already happens with 

> f<-function()1#blah
> f()
[1] 1
> f
function () 
structure(1, comment = "#blah")
> dput(f())
structure(1, comment = "#blah")
> substitute(+x,list(x=f()))
+structure(1, comment = "#blah")

On top of that there's figuring out which entity should own a comment.
Probably the most viable scheme is that a comment belongs to the token
preceding it. But not all tokens are stored in the parse tree.
Consider

if  #1
( #2
x #3
) #4
    3 #5
else #6
    4 #7
#8

The parse tree is, however, equivalent to "if"(x, 3, 4)

To faithfully reproduce any "if" construct, one needs to store at
least four comment structures (for "if", "(", ")",and "else") with it.
General function calls have roughly three per actual argument (after
the ',' and before and after the '=').

As you may have gathered, if you set out to get it right this way,
things quickly get unwieldy.

An alternate suggestion (by Robert at the Vienna meeting) is to "store
the text with the function". I am more and more inclined to think that
this is the viable way to proceed. It takes up a bit of space, but so
what? There are several other questions coming up, though:

(1) can one be sure that the text and the parse tree is in sync?
(2) can we retain the automatic indentation when editing?
(3) what does one do with function definitions within functions?

(1) I don't think so. As long as there's a parse step involved in the
    definition, it is easy enough, but body()<- and formals()<- is
    bound to spoil the fun. One could adopt the convention that such
    operations destroy the comment structure (if a function has no
    stored text, just use the old deparsing technique). That would
    leave only direct manipulations of parse trees as a source for
    inconsistency, in which case it would be fair to let the user
    deserve what he gets.

(2) (and I think this is useful for debugging, etc.). One thing that
    one might do is to store the code in tokenized form more or less
    as the lexical analyser generates it. Then just add the
    indentation when printing.

(3) I think it is necessary to store the text *both* with the inner
    and the outer function. It is not too hard to think of schemes
    to keep track of which parts of a token stream are to be cut out
    and stored with the "function" tokens (and, when the definition is
    evaluated, with the resulting function object).


Comments? (Pardon the pun...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul  9 15:34:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 9 Jul 1999 16:34:54 +0200 (CEST)
Subject: platforms
Message-ID: <14214.2190.45310.941332@aragorn.ci.tuwien.ac.at>

As you may have noticed, the configure/make mechanism has undergone
further substantial changes.  The idea is that (maybe setting a few
shell variables) and then doing configure; make; make install should
work ``as much as possible''.

I don't have access to most platforms and cc/f77/make combinations.
What I am looking for is volunteers in r-devel, BUT NOT IN r-core, who
are willing to ``support'' certain
	cpu-vendor-os cc/f77/make
`platforms' in the sense that they regularly try to recompile the
current (devel and maybe also release) versions for their platform and
let me know whether everything is fine or what needs to be fixed.

Any volunteers?  (Note that the PLATFORMS file in the R distribution is
a good start, but I'd really like to keep the info in it as up-to-date
as possible ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul  9 16:13:29 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 9 Jul 1999 17:13:29 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907090335.XAA03774@infiniti.ece.cmu.edu>
References: <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>
 <199907090335.XAA03774@infiniti.ece.cmu.edu>
Message-ID: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> (If you don't care about R on AIX, happily ignore this email...)

> First about Martin's question (concerning /usr/bin/make):
>   I took a quick look at the Makefile.  The problem is with the
> Makedeps target.  Replacing $< with $? solves the problem.  Shouldn't
> but does.  Will this break on other platforms?  Shouldn't but may.

Actually, replacing it by an explicit `Makefile' is much better.  Sorry
for that.  I keep forgetting that $< does strange things with some make
programs ... fixed now.

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>> Yes, there is still something wrong with the DLLFLAGS.  (Which also
>>> shows up when you try to link local libraries (like a private copy of
>>> the readline lib).)   I've played a little more with the way R.exp is
>>> generated.  Let me try it on 64.2 and 65.

Kurt> Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!

> I know, but I also need a stable version.

:-)  (Actually, I think devel is more stable than release.  The major
difference is that configure/make changes are all in devel as they
typically are NOT bug fixes at all, so they must be in devel ...

Kurt> gcc (cannot find libgcc.a???)

> If gcc cannot find libgcc.a for any other compilation, I'd get worried
> in your place.  I might even get scared.
> For R.binary linking it's simple and necessary to search for
> libgcc.a and put it in the DLLFLAGS.  If you want to link with ld
> instead of cc/f77, you have to add default libs, like -lxlf90 -lxlf
> -lc -lm.  Which ones exactly, you can find out by calling ld with the
> nobind option.  Most instructive since this will result in the binder
> commands being printed.

How does this work exactly?

Kurt> The specs file is fine.  My question is, is that a known gcc problem on
Kurt> AIX or is that due to the rather outdated version of gcc we have?  If it
Kurt> is a general problem, I can easily add to DLLFLAGS.

> See above.  But we may not be talking about the same.  When is
> libgcc.a not found?

Here's what happens:

e8725245@fbma:/tmp/fl/build/src/main$ gmake LDCMD=gcc
gmake[1]: Entering directory `/tmp/fl/build/src/main'
gmake[1]: `Makedeps' is up to date.
gmake[1]: Leaving directory `/tmp/fl/build/src/main'
gmake[1]: Entering directory `/tmp/fl/build/src/main'
gcc -bdynamic -bE:../../etc/R.exp -bM:SRE -lc -lm -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a  -lX11  -lblas  -L/usr/local/lib -lxlf90 -lxlf -lm  -ldl -ltermcap -lm 
ld: 0706-005 Cannot find or open file: libgcc.a
        ld:open(): No such file or directory
ld: 0706-005 Cannot find or open file: libgcc.a
        ld:open(): No such file or directory
gmake[1]: *** [../../bin/R.X11] Error 1
gmake[1]: Leaving directory `/tmp/fl/build/src/main'
gmake: *** [R] Error 2

???  and interestingly, adding
-L/usr/local/lib/gcc-lib/rs6000-ibm-aix3.2.5/2.7.2/ does not help.

>>> BTW, do you not get compiler errors about blkcnt not being defined
>>> when you compile with gcc?  So far, I had to patch most programs
>>> because there is a bug with the standard include files.

> Hmm, I have gcc 2.8.1 (for AIX 4.1) which barfs at sys/stat.h and
> friends. Somehow somebody forgot sometime about "typedef long
> blk_cnt".  Or something close to this effect.

> About DLLFLAGS, SHLIBLD etc:  Currently you'll probably need to know
> the libraries (-lm -lxlf ...) when linking a shared lib since the
> fortran library code is currently not exported via ldAIX4.  Is this
> "bad"?  Is it worth spending time to get this right, i.e. R.binary
> exports all symbols that are actually linked in?  Or can we live with
> the baggage of extra libs in SHLIBFLAGS and a little bit bigger shared
> libs?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul  9 17:05:28 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 9 Jul 1999 18:05:28 +0200
Subject: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
Message-ID: <199907091605.SAA12966@sophie.ethz.ch>

I've (remote) access to a new Linux system which has some flavor of Rehat
installed.

Compiling R-0.64.2 fails -- at the end when  eda.so should be made.

    make[4]: Entering directory `/u/u2/maechler/Linux/R/R-0.64.2/src/library/eda/src'
    gcc -g -O2 -fpic -I../../../../include -c line.c -o line.o
    gcc -g -O2 -fpic -I../../../../include -c smooth.c -o smooth.o
    ld -shared -o eda.so line.o smooth.o
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:1414
    make[4]: *** [eda.so] Segmentation fault
    make[4]: *** Deleting file `eda.so'
    make[4]: Leaving directory `/u/u2/maechler/Linux/R/R-0.64.2/src/library/eda/src'
    <.....>
    make: *** [R] Error 1

---
Interestingly, "mva" {instead of "eda"} works fine...

Further, the number of
	 "ld: bfd assertion fail ..." 
lines is not constant.  Above we had 2 of them;
but I have also seen 5 :
    ld -shared -o eda.so line.o smooth.o
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:1414
or three....

-----------

mkellers{maechler}425% gcc --version
egcs-2.91.66
mkellers{maechler}426% ld --version
GNU ld 2.9.1
Copyright 1997 Free Software Foundation, Inc.
This program is free software; you may redistribute it under the terms of
the GNU General Public License.  This program has absolutely no warranty.
  Supported emulations:
   elf_i386
   i386linux

------------------

I'm guessing that the  gcc/ld/library combination hasn't been 
installed/configured properly... 
???

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri Jul  9 21:23:25 1999
From: bates@stat.wisc.edu (bates@stat.wisc.edu)
Date: Fri, 9 Jul 1999 22:23:25 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907092023.WAA06813@pubhealth.ku.dk>

..
R is now configured for sparc-sun-solaris2.6

  Source directory:         .
  Installation directory:   /unsup/R-0.64.2
  C compiler:               gcc -g -O2
  FORTRAN compiler:         g77 -O2
  Gnome support:            no

$ gcc --version
egcs-2.91.66
$ g77 --version
GNU Fortran 0.5.24-19981002

"make check" later fails.  The failure is in the test of the eigen()
function.  The specific example is:

> eigen(cbind( 1,3:1,1:3))
Segmentation Fault - core dumped

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Jul  9 21:32:15 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 9 Jul 1999 13:32:15 -0700 (PDT)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <199907092023.WAA06813@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.10.9907091329240.22928-100000@wompom.biostat.washington.edu>

On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:

> ..
> R is now configured for sparc-sun-solaris2.6
> 
>   Source directory:         .
>   Installation directory:   /unsup/R-0.64.2
>   C compiler:               gcc -g -O2
>   FORTRAN compiler:         g77 -O2
>   Gnome support:            no
> 
> $ gcc --version
> egcs-2.91.66
> $ g77 --version
> GNU Fortran 0.5.24-19981002

I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77

wompom% gcc --version
2.8.1
wompom% f77 -V
f77: WorkShop Compilers 4.2 30 Oct 1996 FORTRAN 77 4.2
> eigen(cbind( 1,3:1,1:3))
$values
[1] 5 1 0

$vectors
           [,1]  [,2]       [,3]
[1,] -0.8246211 -1.25 -0.9701425
[2,] -0.8246211 -0.25  0.2425356
[3,] -0.8246211  0.75  0.2425356


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 22:51:34 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Jul 1999 23:51:34 +0200
Subject: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
In-Reply-To: Martin Maechler's message of "Fri, 9 Jul 1999 18:05:28 +0200"
References: <199907091605.SAA12966@sophie.ethz.ch>
Message-ID: <x2oghlxzix.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> I've (remote) access to a new Linux system which has some flavor of Rehat
> installed.
> 
> Compiling R-0.64.2 fails -- at the end when  eda.so should be made.
.....> 
> mkellers{maechler}425% gcc --version
> egcs-2.91.66
> mkellers{maechler}426% ld --version
> GNU ld 2.9.1
> Copyright 1997 Free Software Foundation, Inc.
> This program is free software; you may redistribute it under the terms of
> the GNU General Public License.  This program has absolutely no warranty.
>   Supported emulations:
>    elf_i386
>    i386linux
> 
> ------------------
> 
> I'm guessing that the  gcc/ld/library combination hasn't been 
> installed/configured properly... 
> ???

Or hardware. I've been running that combination for a couple of
months on my home machine and since yesterday on the work machine,
including a compile from scratch of the official 0.64.2 as late as
today (the old binary broke due to the __setfpucw silliness).

But first check the install with 

rpm -V egcs binutils 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 23:04:38 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Jul 1999 00:04:38 +0200
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: Thomas Lumley's message of "Fri, 9 Jul 1999 13:32:15 -0700 (PDT)"
References: <Pine.GSO.4.10.9907091329240.22928-100000@wompom.biostat.washington.edu>
Message-ID: <x2n1x5xyx5.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> 
> > ..
> > R is now configured for sparc-sun-solaris2.6
> > 
> >   Source directory:         .
> >   Installation directory:   /unsup/R-0.64.2
> >   C compiler:               gcc -g -O2
> >   FORTRAN compiler:         g77 -O2
> >   Gnome support:            no
> > 
> > $ gcc --version
> > egcs-2.91.66
> > $ g77 --version
> > GNU Fortran 0.5.24-19981002
> 
> I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77
> 

This is very likely the same trouble that I just spent some time
analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
to something that looks suspiciously like a compiler error. I actually
considered asking around if anyone used same egcs version on Solaris,
but though "nah, probably not"....

Doug, could you 

- recompile eigen.o with -g 
- run it with -d gdb
- see if the crash resembles the one below

...
> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
h=0x70d99f80,
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) p j
$1 = 0
(gdb) p na
$2 = 0
(gdb) p en
$3 = 3
(gdb) p n
$4 = (PTR TO -> ( integer )) 0x70d99fc8
(gdb) p nm
$5 = (PTR TO -> ( integer )) 0x1


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Sat Jul 10 02:53:28 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Fri, 09 Jul 1999 21:53:28 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Fri, 09 Jul 1999 17:13:29 EDT."
 <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
Message-ID: <199907100153.VAA16542@infiniti.ece.cmu.edu>


These are some notes about compilation of R-devel (1999-July-08):

-- Compilation breaks when using gcc due to a bug in the include
files.  gcc is version 2.8.1.  In the files Defn.h, Rsock.c and
sock.c, I had to add "typedef long blkcnt_t" which somehow is not
found in sys/types.h.  This may be specific to my installation or to
this version of gcc.

-- The linking stage breaks because it can't find libz.a and
libncurses.a.  I can't quite figure out why R.X11 would want them.
This appears to be a new feature in configure.  BTW, for the readline 
lib I need -lcurses (note no n).

-- Sorry, I forgot to pass this on: You (Kurt) should try to link with
ld not with gcc.  (This will cover up that I have no clue why -L<path>
wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
-lgcc where path is taken from "gcc --print-libgcc-file-name"

Here is the deal with LDCMD/SHLIBLD as far as I understand it:

-- For the R binary (R.X11) we need:
   == LDCMD: ld (native linker)
   == DLLFLAGS: mainly the export symbol flags
	("-bdynamic -bE:${EXPORTFILE} -bM:SRE") and libraries ("-lc -lm
	-l<fortran libs>", if CC==gcc libgcc.a as well);
	but also the LDFLAGS (see buttom).

-- For shared libraries (like eda.so) we need:
   == SHLIBLD:  ld
   == SHLIBLDFLAGS: again the symbol stuff
	("-bM:SRE -bnoentry -bexpall -bI:${EXPORTFILE}"), maybe libraries

Below is some code that can figure out which libraries to use and
where they are.  "ld -bnobind" does the work, providing us wiht lines
like "i array.o" or "lib /usr/lib/libm.a".  This code would put all
symbols that are in R.X11 (not just all the .o and .a files) into the
export file.  Advantage:  If the shared libs don't need any more
libraries than R, we are set and don't need any libraries (-lm etc) in
SHLIBLDFLAGS.  Disadvantage:  We have to make sure that everything
from the libraries actually makes it into R.  Dunno.

-- warning shell script ahead, avert eyes --
ld -bnobind "$@" |
sed -n -e 's/^i /. /p' -e 's/^lib \(.*\)/\1 \1/p' |
(
        while read a b; do
                echo 1>&2 "$a $b"
                echo "#! $a" >> $mainexp
                $nm $nmopts $b |
                        awk '
$2 == "T" && $1 ~ /^\.[^_]/ { found[substr($1, 2)] = 1 }
$2 == "D" { text[$1] = 1 }
$2 == "B" && $1 ~ /^[^_]/ { bss[$1] = 1 }
END {
        for (x in text)
                if (found[x]) print x;
        for (b in bss)
                print b;
}' |
                        sort | uniq >> $mainexp
        done
)
-- you may now open your eyes again --

My suggestion would be: - fix ldAIX so that it helps finding all the
libs and we can use ld as the linker command.  (I can do this).  -
leave the libs in SHLIBLDFLAGS.  This makes the shared libs a little
bit bigger but we are on the save side.

This is new but may help:  If I want to have my local copy of
readline linked into R, I have to set in my config.site:
CPPFLAGS=-I/home/opt/share/include
LIBS=-lcurses
LDFLAGS=-L/home/opt/arch/lib

I can't put the path to my libreadline.a into LIBS, this would fail.
I need a seperate way of telling to the linker where to find local
libs, which is what LDFLAGS is meant for.  BUT DLLFLAGS does currently
not include the LDFLAGS.

It's still compiling the docs.  make check will have to wait till tomorrow.

  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Sat Jul 10 15:49:14 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Sat, 10 Jul 1999 16:49:14 +0200 (CEST)
Subject: who submitted ratetables to CRAN?
Message-ID: <14215.23914.834446.454221@galadriel.ci.tuwien.ac.at>


Hi,

the ratetables package on CRAN contains no author/maintainer
information whatsoever and I cannot remember who submitted it
... is the creator out there on this list?

The DESCRIPTION file is missing (otherwise I wouldn't have problems
with finding the author) ...

Fritz
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sat Jul 10 19:57:30 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 10 Jul 1999 11:57:30 -0700 (PDT)
Subject: who submitted ratetables to CRAN?
In-Reply-To: <14215.23914.834446.454221@galadriel.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.10.9907101152400.23215-100000@wompom.biostat.washington.edu>

On Sat, 10 Jul 1999, Friedrich Leisch wrote:

> 
> Hi,
> 
> the ratetables package on CRAN contains no author/maintainer
> information whatsoever and I cannot remember who submitted it
> ... is the creator out there on this list?

It was part of survival4, packaged separately because it was too big to
load routinely in the days before data() and autoload(). I would suggest
that survival4 and ratetables disappear when 0.65 is released. Survival5
requires 0.64.1 or better to install in the standard way, and there might
be (unwise) people out there who don't install the dot releases.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Jul 11 08:56:21 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 11 Jul 1999 09:56:21 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907110756.JAA09333@pubhealth.ku.dk>

On 10 Jul 1999, Peter Dalgaard BSA wrote:

> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> > 
> > > ..
> > > R is now configured for sparc-sun-solaris2.6
> > > 
> > >   Source directory:         .
> > >   Installation directory:   /unsup/R-0.64.2
> > >   C compiler:               gcc -g -O2
> > >   FORTRAN compiler:         g77 -O2
> > >   Gnome support:            no
> > > 
> > > $ gcc --version
> > > egcs-2.91.66
> > > $ g77 --version
> > > GNU Fortran 0.5.24-19981002
> > 
> > I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77
> > 
> 
> This is very likely the same trouble that I just spent some time
> analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
> to something that looks suspiciously like a compiler error. I actually
> considered asking around if anyone used same egcs version on Solaris,
> but though "nah, probably not"....

I do (see PLATFORMS) but unfortunately did my pre-tests of 0.64.2
at home, using egcs 1.1. That works fine, so I suspect a compiler bug.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Jul 11 16:31:13 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 11 Jul 1999 17:31:13 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907111531.RAA09876@pubhealth.ku.dk>

On 10 Jul 1999, Peter Dalgaard BSA wrote:

> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> > 
> > > ..
> > > R is now configured for sparc-sun-solaris2.6
> > > 
> > >   Source directory:         .
> > >   Installation directory:   /unsup/R-0.64.2
> > >   C compiler:               gcc -g -O2
> > >   FORTRAN compiler:         g77 -O2

(Why is the default to have -g for C but not Fortran? That has puzzled me
before now. At least for gcc/g77 we could be consistent.)

> > >   Gnome support:            no
> > > 
> > > $ gcc --version
> > > egcs-2.91.66
> > > $ g77 --version
> > > GNU Fortran 0.5.24-19981002
> 
> This is very likely the same trouble that I just spent some time
> analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
> to something that looks suspiciously like a compiler error. I actually
> considered asking around if anyone used same egcs version on Solaris,
> but though "nah, probably not"....

Solaris 2.6
Same gcc and g77 as above (egcs-1.1.2)

I get the same behaviour if eigen.f is compiled with -O2, but not if it
is compiled without optimization, nor if it is compiled with egcs-1.1
(and -O2) nor if it is compiled with SunPro SC4.x f77.

> Doug, could you 
> 
> - recompile eigen.o with -g 
> - run it with -d gdb
> - see if the crash resembles the one below
> 
> ...
> > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> 
> Program received signal SIGSEGV, Segmentation fault.
> hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> h=0x70d99f80,
>     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
>     at eigen.f:2120
> 2120                   RA = RA + H(I,J) * H(J,NA)
> Current language:  auto; currently fortran
> (gdb) p j
> $1 = 0
> (gdb) p na
> $2 = 0
> (gdb) p en
> $3 = 3
> (gdb) p n
> $4 = (PTR TO -> ( integer )) 0x70d99fc8
> (gdb) p nm
> $5 = (PTR TO -> ( integer )) 0x1

Does for me (modulo addresses, of course).

The remedy (as usual) seems to be not to optimize when compiling eigen.f
under egcs-1.1.2.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Jul 12 00:35:27 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Jul 1999 01:35:27 +0200
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Sun, 11 Jul 1999 17:31:13 +0200 (MET DST)"
References: <199907111531.RAA09876@pubhealth.ku.dk>
Message-ID: <x2673qiwu8.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> > Doug, could you 
> > 
> > - recompile eigen.o with -g 
> > - run it with -d gdb
> > - see if the crash resembles the one below
> > 
> > ...
> > > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> > 
> > Program received signal SIGSEGV, Segmentation fault.
> > hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> > h=0x70d99f80,
> >     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
> >     at eigen.f:2120
> > 2120                   RA = RA + H(I,J) * H(J,NA)
> > Current language:  auto; currently fortran
> > (gdb) p j
> > $1 = 0
> > (gdb) p na
> > $2 = 0
> > (gdb) p en
> > $3 = 3
> > (gdb) p n
> > $4 = (PTR TO -> ( integer )) 0x70d99fc8
> > (gdb) p nm
> > $5 = (PTR TO -> ( integer )) 0x1
> 
> Does for me (modulo addresses, of course).

Exactly the same?? (Doug's wasn't...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 12 07:49:34 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 12 Jul 1999 07:49:34 +0100 (BST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <x2673qiwu8.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907120745450.21920-100000@auk.stats>

On 12 Jul 1999, Peter Dalgaard BSA wrote:

> ripley@stats.ox.ac.uk writes:
> 
> > > Doug, could you 
> > > 
> > > - recompile eigen.o with -g 
> > > - run it with -d gdb
> > > - see if the crash resembles the one below
> > > 
> > > ...
> > > > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> > > 
> > > Program received signal SIGSEGV, Segmentation fault.
> > > hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> > > h=0x70d99f80,
> > >     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
> > >     at eigen.f:2120
> > > 2120                   RA = RA + H(I,J) * H(J,NA)
> > > Current language:  auto; currently fortran
> > > (gdb) p j
> > > $1 = 0
> > > (gdb) p na
> > > $2 = 0
> > > (gdb) p en
> > > $3 = 3
> > > (gdb) p n
> > > $4 = (PTR TO -> ( integer )) 0x70d99fc8
> > > (gdb) p nm
> > > $5 = (PTR TO -> ( integer )) 0x1
> > 
> > Does for me (modulo addresses, of course).
> 
> Exactly the same?? (Doug's wasn't...)

Modulo addresses as I said, yes:

> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0xbe0a58, low=0xefffe414, igh=0xefffe410, h=0xbe0a10, 
    wr=0xbe09f8, wi=0xbe09e0, z=0xbe0990, ierr=0xbe0960) at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) p j
$1 = 0
(gdb) p na
$2 = 0
(gdb) p en
$3 = 3
(gdb) p n
$4 = (PTR TO -> ( integer )) 0xbe0a58
(gdb) p nm
$5 = (PTR TO -> ( integer )) 0x1

which looks pretty much the same to me.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 07:53:12 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 08:53:12 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907100153.VAA16542@infiniti.ece.cmu.edu>
References: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
 <199907100153.VAA16542@infiniti.ece.cmu.edu>
Message-ID: <14217.37080.324259.602862@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> These are some notes about compilation of R-devel (1999-July-08):

> -- Compilation breaks when using gcc due to a bug in the include
> files.  gcc is version 2.8.1.  In the files Defn.h, Rsock.c and
> sock.c, I had to add "typedef long blkcnt_t" which somehow is not
> found in sys/types.h.  This may be specific to my installation or to
> this version of gcc.

I cannot confirm this with 2.7.1 (!).  I could add

	AC_CHECK_TYPE(blkcnt_t, long)

to configure.in but I'd want to be sure this is really needed.

> -- The linking stage breaks because it can't find libz.a and
> libncurses.a.  I can't quite figure out why R.X11 would want them.
> This appears to be a new feature in configure.

Very strange.  Are you saying that -lz and -lncurses are detected at
configure time but not found at compilation/link time?  (Could it be
that they are in /home/opt/arch/lib?)  Note (see also below) that you
really should use LIBS and not LDFLAGS for -L and -l stuff.

> BTW, for the readline lib I need -lcurses (note no n).

Need?  Better not ... any of ncurses, termcap or termlib would be o.k.
(See also above.)

> -- Sorry, I forgot to pass this on: You (Kurt) should try to link with
> ld not with gcc.  (This will cover up that I have no clue why -L<path>
> wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
> -lgcc where path is taken from "gcc --print-libgcc-file-name"

As I already wrote, I'd like to.  Problem is we need to know which libs
(such as -lc -lm) to link against ... I'll do something about DLLFLAGS
as suggested.

> Here is the deal with LDCMD/SHLIBLD as far as I understand it:

> -- For the R binary (R.X11) we need:
>    == LDCMD: ld (native linker)
>    == DLLFLAGS: mainly the export symbol flags
> 	("-bdynamic -bE:${EXPORTFILE} -bM:SRE") and libraries ("-lc -lm
> 	-l<fortran libs>", if CC==gcc libgcc.a as well);
> 	but also the LDFLAGS (see buttom).

The Fortran libs are not needed because they are in FLIBS anyway.  Is
`-lc' and maybe `-lgcc' if GCC really enough?

> -- For shared libraries (like eda.so) we need:
>    == SHLIBLD:  ld
>    == SHLIBLDFLAGS: again the symbol stuff
> 	("-bM:SRE -bnoentry -bexpall -bI:${EXPORTFILE}"), maybe libraries

> Below is some code that can figure out which libraries to use and
> where they are.  "ld -bnobind" does the work, providing us wiht lines
> like "i array.o" or "lib /usr/lib/libm.a".  This code would put all
> symbols that are in R.X11 (not just all the .o and .a files) into the
> export file.  Advantage:  If the shared libs don't need any more
> libraries than R, we are set and don't need any libraries (-lm etc) in
> SHLIBLDFLAGS.  Disadvantage:  We have to make sure that everything
> from the libraries actually makes it into R.  Dunno.

> -- warning shell script ahead, avert eyes --
> ld -bnobind "$@" |
> sed -n -e 's/^i /. /p' -e 's/^lib \(.*\)/\1 \1/p' |
> (
>         while read a b; do
>                 echo 1>&2 "$a $b"
>                 echo "#! $a" >> $mainexp
>                 $nm $nmopts $b |
>                         awk '
> $2 == "T" && $1 ~ /^\.[^_]/ { found[substr($1, 2)] = 1 }
> $2 == "D" { text[$1] = 1 }
> $2 == "B" && $1 ~ /^[^_]/ { bss[$1] = 1 }
> END {
>         for (x in text)
>                 if (found[x]) print x;
>         for (b in bss)
>                 print b;
> }' |
>                         sort | uniq >> $mainexp
>         done
> )
> -- you may now open your eyes again --

> My suggestion would be: - fix ldAIX so that it helps finding all the
> libs and we can use ld as the linker command.  (I can do this).  -
> leave the libs in SHLIBLDFLAGS.  This makes the shared libs a little
> bit bigger but we are on the save side.

Hmm ... we need to determine DLLFLAGS and SHLIBLDFLAGS at configure
time.  The above would only work at run time, right?  I can see that
this is not a problem with DLLFLAGS because we could wrap things into
the ldAIX script, but how could we do this with SHLIBLDFLAGS then?

> This is new but may help:  If I want to have my local copy of
> readline linked into R, I have to set in my config.site:
> CPPFLAGS=-I/home/opt/share/include
> LIBS=-lcurses
> LDFLAGS=-L/home/opt/arch/lib

> I can't put the path to my libreadline.a into LIBS, this would fail.
> I need a seperate way of telling to the linker where to find local
> libs, which is what LDFLAGS is meant for.  BUT DLLFLAGS does currently
> not include the LDFLAGS.

Maybe I should add LDFLAGS to the LD-like rules.

Re LIBS, why does this not work (as it should)?

> It's still compiling the docs.  make check will have to wait till
> tomorrow.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Mon Jul 12 09:54:43 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Mon, 12 Jul 1999 20:54:43 +1200
Subject: Gnome interface status report
Message-ID: <19990712205443.A4298@stat1.stat.auckland.ac.nz>

Hi,

First, the Find dialog now works.  Users can search backwards or forwards, from the top,
bottom or current cursor position.  Tomorrow I'm going to add regular expression searches
and the option to wrap searches.

I have also got command line arguments working.  I'd really like someone to test this out,
as I never use the command line arguments and so don't know what people generally use.

I have added support for the R_NSIZE, R_VSIZE, R_HISTFILE, and R_HISTSIZE environment
variables (cut'n'paste from unix/system.c :-).  If there are any other environment
variables lurking in the unix source code that I should know about, please let me know.

Given that things like NSize and VSize can be set via environment variable, command line
argument and GUI preferences, I have arbitrarily come up with a precedence (it's easy to
change if anyone disagrees).  Command line arguments have the highest precedence,
followed by the GUI prefs, followed by the environment variables.  Arguably the 
environment variables should take precedence over the GUI preferences; but I think that
it could be a bit confusing if a user sets the vsize using the preferences dialog, but
the setting never takes effect because of an environment variable in the system profile.
However, the GUI will use any environment variables as the default when creating the
preferences.

I have also split gnome/system.c into several files, because it was becoming to big for
easy navigation.  The files are: system.c, system-unix.c, system-choosefile.c,
system-console.c, and system-showfiles.c.  system.c has main, the argument parsing and
the cleanup stuff.  system-unix.c has all the code that I haven't touched, i.e. that is
(hopefully) identical to the corresponding functions in unix/system.c.

Lyndon

PS: I broke the Gnome graphics today, which is wierd because I didn't touch them.  I'll
figure it out tomorrow.  I've also noticed that several console control keys no longer
work (C-u in particular), which I will need to sort out.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:08:02 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:08:02 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907100153.VAA16542@infiniti.ece.cmu.edu>
References: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
 <199907100153.VAA16542@infiniti.ece.cmu.edu>
Message-ID: <14217.45170.691017.489081@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> These are some notes about compilation of R-devel (1999-July-08):

> -- Sorry, I forgot to pass this on: You (Kurt) should try to link with
> ld not with gcc.  (This will cover up that I have no clue why -L<path>
> wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
> -lgcc where path is taken from "gcc --print-libgcc-file-name"

When I use ld for linking the main, I get

  Could not load program /tmp/fl/build/bin/R.X11 
  Error was: Exec format error

The problem seems to be __start

(ld): resolve
ld: 0711-327 WARNING: Entry point not found: __start
ld: 0711-228 WARNING: Duplicate symbols were found while resolving symbols.
        The following duplicates were found:
 Symbol                    Source-File(Object) OR Import-File{Shared-object}
 ------------------------- -------------------------------------------------
 errno                     {/usr/lib/libc.a[shr.o]}
    ** Duplicate **        main.c(main.o)
 gc_inhibit_torture        memory.c(memory.o)
    ** Duplicate **        main.c(main.o)
RESOLVE: 7982 of 18361 symbols were kept.
RESOLVE: The return code is 4.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 171 symbols.
(ld): er full
ER: There are no unresolved symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.

I can fix this by linking with

	/usr/lib/crt0_r.o -lpthreads

but is this the right thing to do?

-k

PS.  Also, I get

e8725245@fbma:/usr/lib$ strings libxlf90.a | grep start
__start
__start

but

e8725245@fbma:/usr/lib$ nm libxlf90.a  | grep start
nm: libxlf90.a[_xlf_aix42sys.imp]: 0654-203 Specify an XCOFF object module.

What is this?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:22:17 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:22:17 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <199907111531.RAA09876@pubhealth.ku.dk>
References: <199907111531.RAA09876@pubhealth.ku.dk>
Message-ID: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>

>>>>> ripley  writes:

> On 10 Jul 1999, Peter Dalgaard BSA wrote:
>> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
>> > 
>> > > ..
>> > > R is now configured for sparc-sun-solaris2.6
>> > > 
>> > >   Source directory:         .
>> > >   Installation directory:   /unsup/R-0.64.2
>> > >   C compiler:               gcc -g -O2
>> > >   FORTRAN compiler:         g77 -O2

> (Why is the default to have -g for C but not Fortran? That has puzzled me
> before now. At least for gcc/g77 we could be consistent.)

Simply an omission.  Autoconf does almost everything for the C compiler
and basically nothing for the Fortran compiler.  R_PROG_F77 now sets
FFLAGS to "-g -O2" for g77 unless FFLAGS is already set.

> The remedy (as usual) seems to be not to optimize when compiling eigen.f
> under egcs-1.1.2.

Should we special-case this into configure?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:34:49 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:34:49 +0200 (CEST)
Subject: Gnome interface status report
In-Reply-To: <19990712205443.A4298@stat1.stat.auckland.ac.nz>
References: <19990712205443.A4298@stat1.stat.auckland.ac.nz>
Message-ID: <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>

>>>>> Lyndon Drake writes:

> Hi,

> First, the Find dialog now works.  Users can search backwards or
> forwards, from the top, bottom or current cursor position.  Tomorrow
> I'm going to add regular expression searches and the option to wrap
> searches.

> I have also got command line arguments working.  I'd really like
> someone to test this out, as I never use the command line arguments
> and so don't know what people generally use.

> I have added support for the R_NSIZE, R_VSIZE, R_HISTFILE, and
> R_HISTSIZE environment variables (cut'n'paste from unix/system.c :-).
> If there are any other environment variables lurking in the unix
> source code that I should know about, please let me know.

> Given that things like NSize and VSize can be set via environment
> variable, command line argument and GUI preferences, I have
> arbitrarily come up with a precedence (it's easy to change if anyone
> disagrees).  Command line arguments have the highest precedence,
> followed by the GUI prefs, followed by the environment variables.
> Arguably the environment variables should take precedence over the GUI
> preferences; but I think that it could be a bit confusing if a user
> sets the vsize using the preferences dialog, but the setting never
> takes effect because of an environment variable in the system profile.
> However, the GUI will use any environment variables as the default
> when creating the preferences.

> I have also split gnome/system.c into several files, because it was
> becoming to big for easy navigation.  The files are: system.c,
> system-unix.c, system-choosefile.c, system-console.c, and
> system-showfiles.c.  system.c has main, the argument parsing and the
> cleanup stuff.  system-unix.c has all the code that I haven't touched,
> i.e. that is (hopefully) identical to the corresponding functions in
> unix/system.c.

Committed yet?  I don't seem to get these with cvs update ...

Re X11/gnome: Last week I suggested that eventually we might have
something like

	unix/...
	unix/X11	=> libRX11.so
	unix/gnome	=> libRgnome.so
maybe also
	unix/kde
???

and at startup do

	LoadSharedLib("libR$GUI.so")

My impression was that the comments we received were all positive.  So,
maybe we should keep this in mind.

Even without the GUI DLL, the above organization would be a lot cleaner.
How easy would it be to accomplish that?  It seems that we can have

	*sock*
	dynload.c
	hpdlfcn.c

in common, and maybe we only need to take waitforActivity() out from
system.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Jul 12 11:09:40 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 12 Jul 1999 12:09:40 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>
Message-ID: <XFMail.990712120940.plummer@iarc.fr>

On 12-Jul-99 Kurt Hornik wrote:
>>>>>> ripley  writes:
>> The remedy (as usual) seems to be not to optimize when compiling eigen.f
>> under egcs-1.1.2.
> 
> Should we special-case this into configure?

To work around a compiler bug? The obvious disadvantage of this is that
you won't easily find out when the bug is fixed.  There was an egcs
optimization bug on Alpha which is now fixed, but that was never taken
care of by configure.

For Linux on Sparc, I have put the fix in the spec file for the RPM,
where it remains quite visible and can be tested periodically.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 14:56:15 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 15:56:15 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <XFMail.990712120940.plummer@iarc.fr>
References: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>
 <XFMail.990712120940.plummer@iarc.fr>
Message-ID: <14217.62463.450638.675680@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> On 12-Jul-99 Kurt Hornik wrote:
>>>>>>> ripley  writes:
>>> The remedy (as usual) seems to be not to optimize when compiling eigen.f
>>> under egcs-1.1.2.
>> 
>> Should we special-case this into configure?

> To work around a compiler bug? The obvious disadvantage of this is
> that you won't easily find out when the bug is fixed.  There was an
> egcs optimization bug on Alpha which is now fixed, but that was never
> taken care of by configure.

O.k., won't change configure then ...

> For Linux on Sparc, I have put the fix in the spec file for the RPM,
> where it remains quite visible and can be tested periodically.

:-)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Mon Jul 12 21:58:54 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Tue, 13 Jul 1999 08:58:54 +1200
Subject: Gnome interface status report
In-Reply-To: <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>; from Kurt Hornik on Mon, Jul 12, 1999 at 11:34:49AM +0200
References: <19990712205443.A4298@stat1.stat.auckland.ac.nz> <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>
Message-ID: <19990713085854.A25357@r.stat.auckland.ac.nz>

On Mon, Jul 12, 1999 at 11:34:49AM +0200, Kurt Hornik wrote:
> Committed yet?  I don't seem to get these with cvs update ...
> 

Oops.  Done now.

> Re X11/gnome: Last week I suggested that eventually we might have
> something like
> 
> 	unix/...
> 	unix/X11	=> libRX11.so
> 	unix/gnome	=> libRgnome.so
> maybe also
> 	unix/kde
> ???
> 
> and at startup do
> 
> 	LoadSharedLib("libR$GUI.so")
> 
> My impression was that the comments we received were all positive.  So,
> maybe we should keep this in mind.
> 
> Even without the GUI DLL, the above organization would be a lot cleaner.
> How easy would it be to accomplish that?  It seems that we can have
> 
> 	*sock*
> 	dynload.c
> 	hpdlfcn.c
> 
> in common, and maybe we only need to take waitforActivity() out from
> system.c?
> 

I like the idea of organising the files this way.  The shared library thing
could be a bit tricky, but I guess it could be done.

devPS.c 
devPicTeX.c 
dynload.c 
edit.c 
Rsock.c 
sock.c 

are already used directly from the unix directory by the Gnome interface.
We could easily split up system.c into a couple of files.  This would give
us:

unix
|-system.c, devPS.c, ..., sock.c
|-X11
| |-system-X11.c, edit.c, devX11.c, ...
|-gnome
| |-system-gnome.c, edit.c, devGnome.c, ...

Doing this as a source split (rather than turning things into shared
libraries) would mean putting main into system-X11.c and system-gnome.c,
but would make maintaining the source for the stuff that's share between
both interfaces much simpler.

Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@cmis.csiro.au  Tue Jul 13 06:13:46 1999
From: Bill.Venables@cmis.csiro.au (Bill.Venables@cmis.csiro.au)
Date: Tue, 13 Jul 1999 07:13:46 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907130513.HAA16802@pubhealth.ku.dk>

Peter,

There is a clear and simple bug in glm() that I have noticed in
0.64.2 (Windows and Unix) but may have been present in earlier
versions.

The function starts as follows:

> glm
function (formula, family = gaussian, data = list(), weights = NULL, 
    subset = NULL, na.action = na.fail, start = NULL, offset = NULL, 
    control = glm.control(...), model = TRUE, method = "glm.fit", 
    x = FALSE, y = TRUE, contrasts = NULL, ...) 
{
    call <- match.call(expand.dots = FALSE)	### <<<<----------------------------
    ## family
    if (is.character(family)) 
        family <- get(family)
    if (is.function(family)) 
        family <- family()
    ## extract x, y, etc from the model formula and frame
    if (is.null(family$family)) {
        print(family)
        stop("`family' not recognized")
    }
    mt <- terms(formula, data = data)
    if (missing(data)) 
        data <- sys.frame(sys.parent())
    mf <- match.call()				### <<<<----------------------------
    mf$family <- mf$start <- mf$control <- mf$maxit <- NULL
    mf$model <- mf$method <- mf$x <- mf$y <- mf$contrasts <- NULL
    mf$... <- NULL

######

The two marked lines should clearly be

    call <- match.call()

and

    mf <- match.call(expand.dots = FALSE)

The error in the first line can case problems with update() (I
suspect) but the error in the second line does not allow isolated
control arguments (like trace = T) to appear on the main call as
they get passed on to the call to model.frame, causing
pandemonium.  As a confirmation of the second change above,
unless you do have (expand.dots = FALSE) the last line quoted
above has no effect.

Regards,
Bill Venables.

-- 
-----------------------------------------------------------------
Bill Venables, Statistician, CMIS Environmetrics Project.

Physical address:                            Postal address:
CSIRO Marine Laboratories,                   PO Box 120,       
233 Middle St, Cleveland, Queensland         Cleveland, Qld, 4163
AUSTRALIA                                    AUSTRALIA

Telephone: +61 7 3826 7251     Email: Bill.Venables@cmis.csiro.au     
      Fax: +61 7 3826 7304

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:09:43 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:09:43 +0200 (CEST)
Subject: 0.65/AIX
Message-ID: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>

Martin:

With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I cannot get
artihmetic.c to compile---it dies because of undefined acosh etc.

Is this specific of the system that I have access to?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:12:16 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:12:16 +0200 (CEST)
Subject: 0.65/HPUX
Message-ID: <14218.55488.832244.223924@aragorn.ci.tuwien.ac.at>

I am trying to compile 0.65 on HPUX using c89/f77/make.  This dies with

        c89 -I. -I../include -I../../src/include   -DHAVE_CONFIG_H  -g -c Rsock.c -o Rsock.o
cc: "Rsock.c", line 135: error 1588: "WNOHANG" undefined.
cc: "Rsock.c", line 142: error 1000: Unexpected symbol: "pid".
cc: "Rsock.c", line 142: error 1588: "pid_t" undefined.
cc: "Rsock.c", line 144: error 1574: Unknown size for "sa".
cc: "Rsock.c", line 145: error 1530: Undefined struct or union.
cc: "Rsock.c", line 146: error 1530: Undefined struct or union.
cc: "Rsock.c", line 147: error 1588: "SIGCHLD" undefined.
cc: "Rsock.c", line 150: error 1588: "pid" undefined.
cc: "Rsock.c", line 151: error 1527: Incompatible types in cast: Must cast from scalar to scalar or to void type.
*** Error exit code 1

although WNOHANG is defined in sys/wait.h which gets included by
Rsock.c.  Does anyone have an idea what is going on?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 13 07:37:46 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 13 Jul 1999 08:37:46 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907130637.IAA17100@pubhealth.ku.dk>

On Tue, 13 Jul 1999 Bill.Venables@cmis.csiro.au wrote:

> Peter,

[Peter only fixes most of the bugs....]

> There is a clear and simple bug in glm() that I have noticed in
> 0.64.2 (Windows and Unix) but may have been present in earlier
> versions.

It has a long history: the expand.dots = FALSE was introduced in 0.63, 
but the second call has been wrong for longer.

> The two marked lines should clearly be
> 
>     call <- match.call()
> 
> and
> 
>     mf <- match.call(expand.dots = FALSE)

as in S.

I've committed this for 0.65.0.

We have had various discussions about glm: it is proving very hard to
maintain (that is, find the bugs) and is irritatingly different from S.
One option is to reimplement it.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:52:01 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:52:01 +0200 (CEST)
Subject: 0.65/AIX
Message-ID: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>

Another problem we encounter is that configure finds installbsd as a
usable install program which does not work correctly.  Has anyone else
experienced this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 10:53:54 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 11:53:54 +0200
Subject: 0.65/AIX
In-Reply-To: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:09:43 +0200 (CEST))
References: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>
Message-ID: <199907130953.LAA14607@sophie.ethz.ch>


    KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
    KH> cannot get artihmetic.c to compile---it dies because of undefined
    KH> acosh etc.

Compilation dies ??    

    KH> Is this specific of the system that I have access to?

Oh dear... the infinite story continues...

The AIX system I have acess to {uname -a ==> AIX percol 2 4 000333104600}
is fine here..
As a matter of fact, I can see in  /usr/include/math.h  that
acosh() is only declared when -D_XOPEN_SOURCE_EXTENDED(=1) !!!

this is what worked here

gcc -I. -I../include -I../../src/include  -DHAVE_CONFIG_H  -g -O2 -D_XOPEN_SOURCE_EXTENDED=1 -c arithmetic.c -o arithmetic.o

a few days ago (I kept the full ./configure; make  shell transcript).

---
I'm trying again with the July 12 snapshot..
+ my line 
======================================================
CFLAGS="-g -O2 -D_XOPEN_SOURCE_EXTENDED"
======================================================
in config.site
((to which configure now adds `` -mno-fp-in-toc ''))


Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 10:59:17 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 11:59:17 +0200
Subject: 0.65/AIX
In-Reply-To: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:52:01 +0200 (CEST))
References: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
Message-ID: <199907130959.LAA14609@sophie.ethz.ch>


    KH> Another problem we encounter is that configure finds installbsd as
    KH> a usable install program which does not work correctly.  Has anyone
    KH> else experienced this?

Well, for me configure gives (as its 2nd output line)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
checking for a BSD compatible install... /usr/bin/installbsd -c
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

But then, I install in the build directory and this may be the reason that
I don't see problems afterwards. 

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 13:40:08 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 14:40:08 +0200
Subject: 0.65/AIX  -D_XOPEN_SOURCE_EXTENDED
In-Reply-To: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:09:43 +0200 (CEST))
References: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>
Message-ID: <199907131240.OAA14751@sophie.ethz.ch>

>>>>> On Tue, 13 Jul 1999 08:09:43 +0200 (CEST), Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> said:

    KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
    KH> cannot get artihmetic.c to compile---it dies because of undefined
    KH> acosh etc.

    KH> Is this specific of the system that I have access to?

It seems, to some extent.
make went all smooth with the additional -D_XOPEN_SOURCE_EXTENDED
CFLAGS.

My few tests (graphic, dyn.load, Inf,...) completed well
including the  "make check" part till it comes to testing the
"specifics" in ./tests/ which dies when it tries to remake package `eda',
the problem being the already reported Problem when cp'ing libraries that
are already there..
    cp: ../../../../library/lqs/libs/lqs.so: Text file busy
[[that problem is being fixed as well..]]

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 13:52:11 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 14:52:11 +0200
Subject: Solution: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
In-Reply-To: <x2oghlxzix.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 09 Jul 1999 23:51:34 +0200)
References: <199907091605.SAA12966@sophie.ethz.ch> <x2oghlxzix.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907131252.OAA14759@sophie.ethz.ch>

>>>>> On 09 Jul 1999 23:51, Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> said:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> I've (remote) access to a new Linux system which has some flavor of Rehat
    >> installed.
    >> 
    >> Compiling R-0.64.2 fails -- at the end when  eda.so should be made.
    .....> 
    >> mkellers{maechler}425% gcc --version
    >> egcs-2.91.66
    >> mkellers{maechler}426% ld --version
    >> GNU ld 2.9.1
    >> Copyright 1997 Free Software Foundation, Inc.
    >> This program is free software; you may redistribute it under the terms of
    >> the GNU General Public License.  This program has absolutely no warranty.
    >> Supported emulations:
    >> elf_i386
    >> i386linux
    >> 
    >> ------------------
    >> 
    >> I'm guessing that the  gcc/ld/library combination hasn't been 
    >> installed/configured properly... 
    >> ???

    PD> Or hardware. I've been running that combination for a couple of
    PD> months on my home machine and since yesterday on the work machine,
    PD> including a compile from scratch of the official 0.64.2 as late as
    PD> today (the old binary broke due to the __setfpucw silliness).

    PD> But first check the install with 

    PD> rpm -V egcs binutils 

which showed that everything looked okay [by giving no output].

Peter, your guess with "hardware" was actually quite close :

Considering using some Linux clients with Solaris file- (and other)
servers, we still have user home directories (auto)mounted from the Solaris
File-server.
When I work in such a file-system, I get funny compiler and linker errors
such as above,
also, e.g. Splus 5.1 for Linux sometimes (not always!) can't find the
objects that I create -- when they reside on the mounted file system...

Alas, so much for system integration...

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 13 14:07:51 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 13 Jul 1999 09:07:51 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "Tue, 13 Jul 1999 11:53:54 EDT."
 <199907130953.LAA14607@sophie.ethz.ch>
Message-ID: <199907131307.JAA29236@infiniti.ece.cmu.edu>


"Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
KH> cannot get artihmetic.c to compile---it dies because of undefined
KH> acosh etc.

Martin> Compilation dies ??    

../../../src/main/arithmetic.c: In function `do_math1':
../../../src/main/arithmetic.c:868: `acosh' undeclared (first use in this function)

KH> Is this specific of the system that I have access to?

Martin> The AIX system I have acess to {uname -a ==> AIX percol 2 4 000333104600}
Martin> is fine here..

Uh, I'm afraid it's not the AIX version, it may be gcc vs. cc
Simply try (I compile in a separate build directory)
cc -E -I. -I../include -I../../../src/include -DHAVE_CONFIG_H  -g -O2 \
-D_XOPEN_SOURCE_EXTENDED=1 ../../../src/main/arithmetic.c | grep \
acosh
which should return "extern     double   acosh(double);"

Three cases, two compilers on an AIX 4.2 box:

-U_XOPEN_SOURCE_EXTENDED - gcc (2.8.1) and cc ok
-D_XOPEN_SOURCE_EXTENDED=1 - gcc fails (no declaration of acosh), cc ok
-D_XOPEN_SOURCE_EXTENDED=2 - gcc and cc ok, both with warnings about
					 redefining _XOPEN_SOURCE_EXTENDED

Sorry, but why do you need _XOPEN_SOURCE_EXTENDED to be defined?  And
why does -D_XOPEN_SOURCE_EXTENDED=2 work, albeit noisely?

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue Jul 13 16:21:34 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 13 Jul 1999 08:21:34 -0700 (PDT)
Subject: 0.65/AIX
In-Reply-To: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>

On Tue, 13 Jul 1999, Kurt Hornik wrote:

> Another problem we encounter is that configure finds installbsd as a
> usable install program which does not work correctly.  Has anyone else
> experienced this?
> 

No, but I had this problem with the Stata install script. configure
doesn't seem very fussy about what counts as an install program.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:02:41 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:02:41 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <199907131333.PAA14854@sophie.ethz.ch>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
Message-ID: <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

ToV> Sorry, but why do you need _XOPEN_SOURCE_EXTENDED to be defined?  And
ToV> why does -D_XOPEN_SOURCE_EXTENDED=2 work, albeit noisely?

> This is used to be the only flag (from the many I tried about a year ago) 
> for which
>      1/0  
>      is.finite(1)
>      atanh(1)
> worked .

Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
Now, this gives

> 1/0 + 1/0# Inf
[1]INF
> 1/0 - 1/0# NaN
[1]NaNQ

which is only sort of o.k.???

For the time being, I'll commit this version ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:09:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:09:54 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>
References: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
 <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>
Message-ID: <14219.25810.198731.567682@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 13 Jul 1999, Kurt Hornik wrote:
>> Another problem we encounter is that configure finds installbsd as a
>> usable install program which does not work correctly.  Has anyone else
>> experienced this?
>> 

> No, but I had this problem with the Stata install script. configure
> doesn't seem very fussy about what counts as an install program.

Hmm.  Guess I should hardwire the fix then into configure (if aix and
installbsd then use install-sh).

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 13 17:23:36 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 13 Jul 1999 18:23:36 +0200
Subject: 0.65/AIX
In-Reply-To: Kurt Hornik's message of "Tue, 13 Jul 1999 18:02:41 +0200 (CEST)"
References: <199907131307.JAA29236@infiniti.ece.cmu.edu> 	<199907131333.PAA14854@sophie.ethz.ch> <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
Message-ID: <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
> Now, this gives
> 
> > 1/0 + 1/0# Inf
> [1]INF
> > 1/0 - 1/0# NaN
> [1]NaNQ
> 
> which is only sort of o.k.???

No! ...which is patently WRONG. When this kind of printout, it shows
that the print routines in R are not able to recognize Inf and NaN
(using R_FINITE) which implies that they aren't properly recognized
anywhere else.

> For the time being, I'll commit this version ...

Not for long, I hope...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:36:57 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:36:57 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
 <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
 <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
Message-ID: <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
>> Now, this gives
>> 
>> > 1/0 + 1/0# Inf
>> [1]INF
>> > 1/0 - 1/0# NaN
>> [1]NaNQ
>> 
>> which is only sort of o.k.???

> No! ...which is patently WRONG. When this kind of printout, it shows
> that the print routines in R are not able to recognize Inf and NaN
> (using R_FINITE) which implies that they aren't properly recognized
> anywhere else.

>> For the time being, I'll commit this version ...

> Not for long, I hope...

Hmm.

On the system I have access to, I can compile only with

	-D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
or
	-D_ALL_SOURCE

In either case, we get the above.

I will hence use ALL_SOURCE for the time being.

Note that

> 1/0 - 1/0# NaN
[1]NaNQ
> is.nan(1/0 - 1/0)
[1] TRUE

so what is really going on here???

-k


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 13 23:12:48 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Jul 1999 00:12:48 +0200
Subject: 0.65/AIX
In-Reply-To: Kurt Hornik's message of "Tue, 13 Jul 1999 18:36:57 +0200 (CEST)"
References: <199907131307.JAA29236@infiniti.ece.cmu.edu> 	<199907131333.PAA14854@sophie.ethz.ch> 	<14219.25377.308702.802943@aragorn.ci.tuwien.ac.at> 	<x2vhbozfg7.fsf@blueberry.kubism.ku.dk> <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>
Message-ID: <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> On the system I have access to, I can compile only with
> 
> 	-D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
> or
> 	-D_ALL_SOURCE
> 
> In either case, we get the above.
> 
> I will hence use ALL_SOURCE for the time being.
> 
> Note that
> 
> > 1/0 - 1/0# NaN
> [1]NaNQ
> > is.nan(1/0 - 1/0)
> [1] TRUE
> 
> so what is really going on here???

Double "hmmmm"....

Can you run this under gdb? If so, could you set a breakpoint in
EncodeReal and step through it? 

That'll be (roughly)

R -d gdb
(gdb) run
^C
(gdb) break EncodeReal
(gdb) continue
> 1/0
(gdb) next
<etc.>

I bet it never enters the "if (!R_FINITE(x))" branch as it should.
This could happen if HAVE_FINITE and IEEE_754 are both undefined in
Arith.h, or if finite(x) doesn't work in the IEEE way.

>From what Martin has been telling us, AIX is using IEEE format numbers
and arithmetic anyhow, so it should be fairly easy to fudge a better
R_FINITE (and ISNAN too). I think we went through some of that last
time we had R_FINITE/ISNAN and friends on the board, didn't we?
Something pretty close to the following should work:

#define R_FINITE(x) ({double y = x; \
	 *((int *) &y) & 0x7ff00000 != 0x7ff00000})

#define ISNAN(x) ({double y = x; \
	*((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
	(*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

Of course, that kind of code is pretty architecture dependent, etc...
Perhaps one should first check what the status of IEEE macros in AIX
really is.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From 320098218774-0001@t-online.de  Wed Jul 14 01:01:47 1999
From: 320098218774-0001@t-online.de (320098218774-0001@t-online.de)
Date: Wed, 14 Jul 1999 02:01:47 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907140001.CAA25350@pubhealth.ku.dk>

ripley@stats.ox.ac.uk schrieb:
> On Tue, 13 Jul 1999 Bill.Venables@cmis.csiro.au wrote:
>
> > Peter,
>
> [Peter only fixes most of the bugs....]
>
> > There is a clear and simple bug in glm() that I have noticed in
> > 0.64.2 (Windows and Unix) but may have been present in earlier
> > versions.
>
> It has a long history: the expand.dots = FALSE was introduced in 0.63, 
> but the second call has been wrong for longer.
>
> > The two marked lines should clearly be
> > 
> >     call <- match.call()
> > 
> > and
> > 
> >     mf <- match.call(expand.dots = FALSE)
>
> as in S.
>
> I've committed this for 0.65.0.
>
> We have had various discussions about glm: it is proving very hard to
> maintain (that is, find the bugs) and is irritatingly different from S.
> One option is to reimplement it.

My opinion as a simple user ... reimplement glm is a very good idea!. Just
for the "cosmetic" point of view: please, take out all of these silly *`s 
indicating significant levels in the output. Also, if somebody needs the "null 
deviance" make it as optional, and not in the stardard output.

Best regards,
Pablo.



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 08:24:32 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 09:24:32 +0200
Subject: 0.65/HPUX
In-Reply-To: <9907131048.AA22896@nokomis.stat.umn.edu>
References: <14218.55488.832244.223924@aragorn.ci.tuwien.ac.at>
 <9907131048.AA22896@nokomis.stat.umn.edu>
Message-ID: <199907140724.JAA19840@aragorn.ci.tuwien.ac.at>

>>>>> Luke Tierney writes:

> On HPUX a lot of stuff like this is only available if you set the
> appropriate define, like HPUX_SOURCE_ or POSIX_SOURCE_.  Unless that
> is set in an include file, I suspect it is needed with the c89 command
> line.

Thanks.  Seems that c89 needs -D_HPUX_SOURCE so I now define this via
Platform.h.  We also seem to need -L/lib/pa1.1 in LIBS.

The problem I now seem to have is that alloca is not found when loading
the main binary ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 13:40:52 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 14:40:52 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
Message-ID: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>

I've made some more changes to configure/make which still don't solve
everything but I think I have to stop for now.

Status AIX:

* I can compile with gcc/f77/make.
* AIX make check fails (cannot build base-Ex.R).
* GNU make check fails in the contour example.
* Plotting is broken (tickmarks go all the way thru).
* IEEE fp stuff is strange (will look into this).
* I still need f77 for linking.  Using ld with the suggested flags gives
  a binary with `exec format error'.  The problem seems to be with an
  unreferenced __start.
* The basic add-ons seem to work, though.

Status HPUX:

* I can compile the main binary with c89/f77/make.
* Compilation fails in eda (syntax error in etc/Makeconf).  The problem
  disappears when the SHLIB target is commented ... but then building
  the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
* QUESTION: what about src/unix/hpdlfcn.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 15:56:23 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 16:56:23 +0200 (CEST)
Subject: docs: topic && availability
Message-ID: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>

I think that users quite often want to answers to questions like ``Is
there something to do FOO in R?'', where FOO might e.g. be ``isotonic
regression''.  The answer should be something like ``you can use BAR in
package BAZ, or ...''.

For this, full text search is not the right approach and the keywords
are not enough.  We could maybe search dedicated fields (like \title),
but I think what we really want is something like an \index{} entry.
(I am not sure whether we want concept/variable/function/... indices a
la Texinfo.)

Access/retrieval could even happen on the command line via something
like
	help(topic = "FOO")

However, I am not sure what the right back-end is.  We definitely do not
want to confine the search to the loaded packages.  But even the locally
available ones are not enough.  On the other hand, I don't think doing
all topic lookups via CRAN is the right thing, either.  So maybe

	help(topic = "FOO")

would use all topic indices in R_LIBS but there could be a message
indicating that one can also use CRAN for lookup via WWW.

Opinions?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 14 16:07:25 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 14 Jul 1999 17:07:25 +0200
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 14 Jul 1999 14:40:52 +0200 (CEST))
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
Message-ID: <199907141507.RAA27266@sophie.ethz.ch>


    KH> I've made some more changes to configure/make which still don't solve
    KH> everything but I think I have to stop for now.

too bad (the "stop for now").

    KH> Status AIX:

    KH> * I can compile with gcc/f77/make.
    KH> * AIX make check fails (cannot build base-Ex.R).
    KH> * GNU make check fails in the contour example.
    KH> * Plotting is broken (tickmarks go all the way thru).

This is exactly the typical result of the next item :
In my experience, whenever  is.finite(), finite()  1/0, 0/0 etc weren't ok
(and as Peter emphasized, they are *not at all* as long as you get
 "INF" and "NaNQ"  instead of "Inf" and "NaN")
then the graphics show the above symptome.

The way that I found that -D_XOPEN_SOURCE_EXTENDED
will save me, was by looking into /usr/include/math.h

It seems that you (and Thomas Vogels !) have a different one, than, even
though Thomas said that he had AIX 4.2 as well?
This is what I have :

    $ uname -a
    AIX percol 2 4 000333104600

    $ ls -l /usr/include/math.h
    -r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

What versions of AIX 4.2 are around?


    KH> * IEEE fp stuff is strange (will look into this).
    KH> * I still need f77 for linking.  Using ld with the suggested flags gives
    KH> a binary with `exec format error'.  The problem seems to be with an
    KH> unreferenced __start.
    KH> * The basic add-ons seem to work, though.


    KH> Status HPUX:

    KH> * I can compile the main binary with c89/f77/make.
    KH> * Compilation fails in eda (syntax error in etc/Makeconf).  The problem
    KH> disappears when the SHLIB target is commented ... but then building
    KH> the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
				       ~~~~~~~~~
				       sure about that ??

    KH> * QUESTION: what about src/unix/hpdlfcn.c?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 16:18:46 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 17:18:46 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <199907141507.RAA27266@sophie.ethz.ch>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
Message-ID: <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

KH> I've made some more changes to configure/make which still don't solve
KH> everything but I think I have to stop for now.

> too bad (the "stop for now").

(Well, the point is that the experimental approach is very inefficient.
We need someone who really knows about these platforms.)

KH> Status AIX:

KH> * I can compile with gcc/f77/make.
KH> * AIX make check fails (cannot build base-Ex.R).
KH> * GNU make check fails in the contour example.
KH> * Plotting is broken (tickmarks go all the way thru).

> This is exactly the typical result of the next item : In my
> experience, whenever is.finite(), finite() 1/0, 0/0 etc weren't ok
> (and as Peter emphasized, they are *not at all* as long as you get
> "INF" and "NaNQ" instead of "Inf" and "NaN") then the graphics show
> the above symptome.

Hmm.  Perhaps we can nail that down.  My impression was that the finite
et al tests I tried were o.k.  Do you know what exactly causes the
plotting problem?

> The way that I found that -D_XOPEN_SOURCE_EXTENDED
> will save me, was by looking into /usr/include/math.h

> It seems that you (and Thomas Vogels !) have a different one, than,
> even though Thomas said that he had AIX 4.2 as well?  This is what I
> have :

>     $ uname -a
>     AIX percol 2 4 000333104600

>     $ ls -l /usr/include/math.h
>     -r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

> What versions of AIX 4.2 are around?

I have

e8725245@fbma:/home2/e8725245$ uname -a
AIX fbma 2 4 000147825700
e8725245@fbma:/home2/e8725245$ ls -l /usr/include/math.h 
-r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

Also,

e8725245@fbma:/home2/e8725245$ ls -l /usr/bin/f77 
-rwxr-xr-x   3 bin      bin        99453 May  7 1998  /usr/bin/f77*
e8725245@fbma:/home2/e8725245$ gcc --version
2.7.2
e8725245@fbma:/home2/e8725245$ gmake --version
GNU Make version 3.77, by Richard Stallman and Roland McGrath.

KH> * IEEE fp stuff is strange (will look into this).
KH> * I still need f77 for linking.  Using ld with the suggested flags gives
KH> a binary with `exec format error'.  The problem seems to be with an
KH> unreferenced __start.
KH> * The basic add-ons seem to work, though.


KH> Status HPUX:

KH> * I can compile the main binary with c89/f77/make.
KH> * Compilation fails in eda (syntax error in etc/Makeconf).  The problem
KH> disappears when the SHLIB target is commented ... but then building
KH> the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
> 				       ~~~~~~~~~
> 				       sure about that ??

3-52-5 configure has

    *hpux*)
      FOREIGN_FILE="sysvr4-foreign.h"
      AC_DEFINE(HAVE_FOREIGN)
      AC_DEFINE(HAVE_DLOPEN)
      UCFLAGS="$UCFLAGS -Imachines/hpux/dlfcn"
      EXTRAOBJS="$EXTRAOBJS dlfcn.o"
      link_sources="$link_sources machines/hpux/dlfcn/dlfcn.c"
      link_targets="$link_targets dlfcn.c"
      EXTRALIBS="$EXTRALIBS -ldld"
      ULDFLAGS="$ULDFLAGS -Wl,-E"
      foreign=1


KH> * QUESTION: what about src/unix/hpdlfcn.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 14 16:41:50 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 14 Jul 1999 17:41:50 +0200
Subject: tseries package -- license
Message-ID: <199907141541.RAA27707@sophie.ethz.ch>


Thanks a lot for "tseries"!

The new (0.1-2) version of the tseries package
contains the following in ./README :

>> Author(s): A. Trapletti <A.Trapletti@ci.tuwien.ac.at>, 
>>         B. LeBaron ("./src/bdstest.c"),
>>         K. Krischer, and T. M. Kruel ("./src/muin2ser.f", 
>>         "./misc/mutinfo-1.21b.tar.gz")

>> License: "./src/muin2ser.f", "./misc/mutinfo-1.21b.tar.gz" are 
>>         free for non-commercial purposes. "./src/bdstest.c" is 
>>         free. The remainder is covered by GPL version 2 or 
>>         newer; see file COPYING

I think the ``free for non-commercial purposes''
is not good enough for us.

Could you try to contact K.Krischer und T.M.Kruel and ask if they would
release their software under GPL (or something similar)?

If not, it may be worth to separate your "tseries" package into a
free part (that can be put onto CD-ROMs !),
and a non-free part (that CAN'T be put onto CD-ROMs) for the "muin/mutinfo"
stuff.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 14 20:05:25 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 14 Jul 1999 15:05:25 -0400
Subject: docs: topic && availability
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
Message-ID: <378CDF72.5499BD27@bank-banque-canada.ca>

I've often thought that some sort of synonym dictionary would be useful,
especially for new users. That is, give the name of some procedure, say
in Matlab, SAS or SPSS, or even a statistical term, and get information
about possible procedures to consider in S/R (and the other way around
too). I think this might be much more broadly useful than just for R, so
I wouldn't tie it too closely to R help() or CRAN.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From s-harker@adfa.edu.au  Thu Jul 15 03:28:02 1999
From: s-harker@adfa.edu.au (s-harker@adfa.edu.au)
Date: Thu, 15 Jul 1999 04:28:02 +0200 (MET DST)
Subject: pch and mkh bug PR#225
Message-ID: <199907150228.EAA02869@pubhealth.ku.dk>

I am sorry about the problem caused by my first attempt at reporting a
bug.  This is a followup to my report PR#225, hopefully being more
useful.  By not I have a better understanding of the problems being
reported.

I wish to report one bug relating to plot character and to mention two
other possible bugs (these may relate to differences between R and S)
I have noticed with R.  We have recently installed R and I am
converting some scripts I had previously used with a very old version
of S (not Splus).  The R version information is:

platform   sparc-sun-solaris2.5.1
arch       sparc                 
os         solaris2.5.1          
system     sparc, solaris2.5.1   
status                           
status.rev 0                     
major      0                     
minor      64.2                  
year       1999                  
month      July                  
day        3                     
language   R  

In the following I will be quoting some extracts from R A Becker, J M
Chambers and A R Wilks _The New S Language_, Wadsworth & Brooks/Cole
1988, isbn 0-534-09192-X.  We have a copy of this book since, although
our departmental server did not update from S to Splus, the campus
server did.  I am using this as an authority to report some of the
following as being bugs.

(1)  First the boxes drawn using `points()' via the following example

Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15),type="n")
points(X,Y,pch=0,mkh=0.02)
points(X,Y,pch=0,mkh=1.0)
points(X,Y-1,pch=0,cex=4.0)
points(X,Y-1,pch=0,cex=0.02)

are of a size that indicated that the mkh value is being ignored (the
upper set of boxes).  This can be fixed by using cex (the lower set of
boxes).  However, the S manual states that `mkh' gives the height in
inches of mark symbols drawn when `pch' is given as a number.  This
comment is also made in the help for the `par' function within R.  This
would appear to be a bug, using `cex' is correct only when giving a
character.

(2)  The plotting of axis labels on an axis becomes confused if the
`at' vector is descending.  For exaample, consider the following:

labels <- c("A", "B", "C", "D")
Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15))
axis(side=4,at=Y,labels=labels)

According to the S manual `label[i]' is plotted at coordinate `at[i]'.
Although S (or R) plot the vector in ascending order this still worked
(in old S, anyway), it may have been a feature.  However, R appears to
sort `at[i]' but not do a corresponding sort on label[i].  The R help
does not make the statement about plotting `label[i]' at coordinate
`at[i]', so this may be a difference between S and R.  It can be
overcome by appropriate pre-sorting of the two vectors.

(3)  The use of `mtext' only works for a string, not for a vector of
strings.  For example, the following commands.

labels <- c("A", "B", "C", "D")
Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15))
mtext(text=labels, side=4, line=0.5, at=Y)

plots only the first of the elements of `labels'.  Again, this may
reflect a difference between S and R.  The S manual states that `text'
is a character vector to be plotted and `at' is an optional vector of
positions.  However, the R help states that `text' is a character
string and `at' gives the location in user coordiates.  This can be
overcome by plotting `labels[i]' at `at[i]' within a loop.

-- 
Stephen Harker                                        s-harker@adfa.edu.au
School of Physics               Baloney Baffles brains: Eric Frank Russell
University College                http://www.adfa.edu.au/physics/s-harker/
UNSW, ADFA

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 08:14:46 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 15 Jul 1999 09:14:46 +0200 (MET DST)
Subject: which() does not handle NAs in named vectors. (PR#226)
Message-ID: <199907150714.JAA03804@pubhealth.ku.dk>

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

-- It is unclear to me that the handling of NAs is desirable, and it
   has problems with names:

> z <- c(T,T,NA,F,T)
> names(z) <- letters[1:5]
> which(z)
Error: names attribute must be the same length as the vector
      
(Why do the vector and its names have different subscripts?  And while
you are correcting this,

Arguments:

       x: a logical vector or array.  `NA's are allowed an
          omitted.
  
has a typo, and the logic can be simplified: see below.)

On Thu, 15 Jul 1999, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
>     BDR> On Wed, 14 Jul 1999, Friedrich Leisch wrote:
>     >> >>>>> On Wed, 14 Jul 1999 04:09:21, >>>>> Peter B Mandeville (PBM)
>     >> wrote:
>     >> 
>     PBM> I have a vector Pes with 600 elements some of which are NA's. How
>     PBM> can I form a vector of the indices of the NA's.
>     >>
>     PBM> for(i in 1:600) if(is.na(Pes[i])) print(i)
>     >>
>     PBM> prints the indices of the NA's but I can't figure out how to put
>     PBM> the results in a vector.
>     >>  try this:
>     >> 
>     >> x <- (1:length(Pes))[is.na(Pes)]
> 
>     BDR> Tip: that sort of thing often fails for a length 0 vector. The
>     BDR> `approved' spell is
> 
>     BDR> seq(along=Pes)[is.na(Pes)]
> 
>     BDR> In this case it does not matter as the subscript is of length 0,
>     BDR> but it has floored enough library/package writers to be worth
>     BDR> thinking about.
> 
> Good teaching about seq() vs.  1:n 
> 
> However, the solution I gave 
> 
>      which(is.na(Pes))
> 
> is the one I stilly really recommend; 
> it does deal with 0-length objects, and it keeps names when there are some,
> and it has an `arr.ind = FALSE' argument to return array indices instead of
> vector indices when so desired.

Yes, but

-- It is not in S (so causing difficulty in porting from R to S)
-- It looks a relatively expensive operation.
-- Internally which could be simplified by using seq(along=) as it
   is a wrapper for this construct, but actually the separate
   handling of n == 0 is unnecessary (as logic & !is.na(logic) will have
   length zero.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Thu Jul 15 09:04:53 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Thu, 15 Jul 1999 08:04:53 +0000
Subject: tseries package -- license
References: <199907141541.RAA27707@sophie.ethz.ch>
Message-ID: <378D9625.50BB8F9F@wu-wien.ac.at>

Martin Maechler wrote:

> Thanks a lot for "tseries"!
>
> The new (0.1-2) version of the tseries package
> contains the following in ./README :
>
> >> Author(s): A. Trapletti <A.Trapletti@ci.tuwien.ac.at>,
> >>         B. LeBaron ("./src/bdstest.c"),
> >>         K. Krischer, and T. M. Kruel ("./src/muin2ser.f",
> >>         "./misc/mutinfo-1.21b.tar.gz")
>
> >> License: "./src/muin2ser.f", "./misc/mutinfo-1.21b.tar.gz" are
> >>         free for non-commercial purposes. "./src/bdstest.c" is
> >>         free. The remainder is covered by GPL version 2 or
> >>         newer; see file COPYING
>
> I think the ``free for non-commercial purposes''
> is not good enough for us.
>
> Could you try to contact K.Krischer und T.M.Kruel and ask if they would
> release their software under GPL (or something similar)?

I will try...

>
>
> If not, it may be worth to separate your "tseries" package into a
> free part (that can be put onto CD-ROMs !),
> and a non-free part (that CAN'T be put onto CD-ROMs) for the "muin/mutinfo"
> stuff.

The non-free part only contains the "amif" function. I think although the
"auto mutual information" is a nice toy, it is not a very big loss, if we
don't have it in the "free" tseries package.

Adrian

>
>
> Martin

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 10:28:13 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 15 Jul 1999 11:28:13 +0200 (MET DST)
Subject: .Last is usually not called (PR#227)
Message-ID: <199907150928.LAA05145@pubhealth.ku.dk>

R-0.64.2 and R-devel:

[I found this by looking at the code.]

A .Last function is _only_ called if the condition that causes termination
is EOF on the console or input:

> .Last <- function() cat("ran .Last\n")
> q("no")
returns to the shell.

> .Last <- function() cat("ran .Last\n")
> # I hit ^D here
ran .Last
Save workspace image? [y/n/c]: n

The problem is that .Last is handled in end_Rmainloop(), and that is
not called by q(). We need to move the handling to R_CleanUp (and
for some reason do_quit is system-dependent, so need not even call
R_CleanUp). I'll work on this.

I did check the documentation: ?quit does claim .Last should be called:

     Immediately before terminating, the function `.Last()'
     is executed if it exists.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul 15 12:53:54 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu, 15 Jul 1999 13:53:54 +0200 (MET DST)
Subject: [R] R: ts - objects (PR#228)
Message-ID: <199907151153.NAA06756@pubhealth.ku.dk>

Marcus Eger <marcus.eger@physik.uni-marburg.de> writes:

> > time(sqrt(arrts))
> Time Series:
> Start = c(1, 1) 
> End = c(5, 1) 
> Frequency = 1 
> [1] 1 2 3 4 5

Looks like a bug...

> ----------------------------------------------------------------------------
> 2. (At least) boolean indexing with matrices does not seem to work
> properly:
> ----------------------------------------------------------------------------
> > arrts[is.finite(arrts)]
> Error: subscript (10) out of bounds, should be at most 5
> > 
> > unclass(arrts)[is.finite(arrts)]
>  [1]  1  2  3  4  5  6  7  8  9 10

Yes, we discussed that a short while ago on R-devel. It's trying too
hard to retain the ts attributes in these cases.

> 
> ----------------------------------------------------------------------------
> This problem arose when I tried to plot my time series: > plot(arrts)
> It was easy to fix in plot.ts:
> ----------------------------------------------------------------------------
> ....
>   if (is.null(ylim)) 
>     ylim <- range(unclass(x)[is.finite(x)])  #by ME, 14-07-99
> #    ylim <- range(x[is.finite(x)])
>   plot.new()
> ....

...although range(x,finite=T) is probably a better fix.

> 
> -----------------------------------------------------------------------------
> 3. Another problem had to do with the value of delta and/or start:
> -----------------------------------------------------------------------------
> > time(ts(c(1,2,3,4),start=3,delta=1.5))
> Error: invalid start

or just: 

> ts(c(1,2,3,4),start=3,delta=1.5)
Time Series:
Start = c(3, 1) 
End = c(7, 1) 
Frequency = 0.666666666666667 
Error: invalid start

..which is pretty darn weird! CC'ed to R-bugs.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 13:57:22 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 14:57:22 +0200
Subject: which() does not handle NAs in named vectors. (PR#226)
In-Reply-To: <199907150714.JAA03804@pubhealth.ku.dk> (ripley@stats.ox.ac.uk)
References: <199907150714.JAA03804@pubhealth.ku.dk>
Message-ID: <199907151257.OAA06166@sophie.ethz.ch>

>>>>> On Thu, 15 Jul 1999 09:14, ripley@stats.ox.ac.uk (Brian D. Ripley) said:

Thank you for the bug report

    BDR> -- It is unclear to me that the handling of NAs is desirable, and
    BDR> it has problems with names:

{function which in its present form very much evolved out of user wishes...}

    BDR> z <- c(T,T,NA,F,T)
    BDR> names(z) <- letters[1:5]
    BDR> which(z)
    BDR> Error: names attribute must be the same length as the vector

fixed for release-patches [available in a day or two from CRAN src/devel/]
and hence every new release.

    BDR> (Why do the vector and its names have different subscripts?  And
    BDR> while you are correcting this,

    BDR> Arguments:

    BDR>        x: a logical vector or array.  `NA's are allowed an
    BDR>	   omitted.

is now

       x: a `logical' vector or array.  `NA's are allowed
          and omitted (treated as if `FALSE').

  
    BDR> has a typo, and the logic can be simplified: see below.)

    BDR> On Thu, 15 Jul 1999, Martin Maechler wrote:

    >> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
    >> 
    BDR> On Wed, 14 Jul 1999, Friedrich Leisch wrote:
    >> >> >>>>> On Wed, 14 Jul 1999 04:09:21, >>>>> Peter B Mandeville
    >> (PBM) >> wrote:
    >> >> 
    PBM> I have a vector Pes with 600 elements some of which are NA's. How
    PBM> can I form a vector of the indices of the NA's.
    >> >>
    PBM> for(i in 1:600) if(is.na(Pes[i])) print(i)
    >> >>
    PBM> prints the indices of the NA's but I can't figure out how to put
    PBM> the results in a vector.
    >> >> try this:
    >> >> 
    >> >> x <- (1:length(Pes))[is.na(Pes)]
    >> 
    BDR> Tip: that sort of thing often fails for a length 0 vector. The
    BDR> `approved' spell is
    >>
    BDR> seq(along=Pes)[is.na(Pes)]

BTW, currently  seq(along = x)  returns "numeric" ("double") 
whereas		1:length(x)     returns "integer".
I'm about to fix this...

    BDR> In this case it does not matter as the subscript is of length 0,
    BDR> but it has floored enough library/package writers to be worth
    BDR> thinking about.
    >>  Good teaching about seq() vs.  1:n
    >> 
    >> However, the solution I gave
    >> 
    >> which(is.na(Pes))
    >> 
    >> is the one I stilly really recommend; it does deal with 0-length
    >> objects, and it keeps names when there are some, and it has an
    >> `arr.ind = FALSE' argument to return array indices instead of vector
    >> indices when so desired.

    BDR> Yes, but

    BDR> -- It is not in S (so causing difficulty in porting from R to S)

Well, I know what you mean and your point is all well in the above case...
but anyway:
Our group here has been using this ("which" function) in S for quite a while and
eventually, someone will have to collect a library of things from R, missing in
S-plus and easily implementable.

And then, for quite a few R users, S-plus backward compatibility is not the
big issue. Locally, in our collection of S-plus add-ons, we've got already
quite a few of them.. 
And in other ways, R is so much nicer
    - math annotation in graphics
    - color, line types  {  plot(x,y, col="light blue", col.main = "blue") }
    - filled.contour
    - persp() with shading..

I think if you want to live in both worlds, I want (and recommend) to use

    if(is.R()) {

       ...R specific...

    } 
    else { ## S-plus ---

       ...S-plus specific...

    }

anyway, even within user written functions
and make sure (via .First or S_FIRST or ...)  that is.R() |--> FALSE in S-plus


    BDR> -- It looks a relatively expensive operation.

I don't think it is expensive (for arr.ind=FALSE !) if you want to do deal
with missings (NA) at all.  (Peter's example above is one of the few places 
where you are absolutely sure there are no missings...)
Assume x has some NAs, e.g.
    x <- rnorm(1000); x[1000*runif(rpois(1,lam=50))] <- NA
Then
    which( x < -2 )  

works how one would want;

    seq(along = x)[x < -2]

gives silly NA's (which make sense for the logical vector but not for the
		 extraction).

    BDR> -- Internally which could be simplified by using seq(along=) as it is a wrapper for
    BDR> this construct, but actually the separate handling of n == 0 is
    BDR> unnecessary (as logic & !is.na(logic) will have length zero.)

You are right, and that's part of the fix for `which' which is currently

which <- function(logic, arr.ind = FALSE)
{
    if(!is.logical(logic))
	stop("argument to \"which\" is not logical")
    wh <- seq(along=logic)[ll <- logic & !is.na(logic)]
    if ((m <- length(wh)) > 0) {
	dl <- dim(logic)
	if (is.null(dl) || !arr.ind) {
	    names(wh) <- names(logic)[ll]
	}
	else { ##-- return a matrix  length(wh) x rank
	    rank <- length(dl)
	    wh1 <- wh - 1
	    wh <- 1 + wh1 %% dl[1]
	    wh <- matrix(wh, nrow = m, ncol = rank,
			 dimnames =
			 list(dimnames(logic)[[1]][wh],
			      if(rank == 2) c("row", "col")# for matrices
			      else paste("dim", 1:rank, sep="")))
	    if(rank >= 2) {
		denom <- 1
		for (i in 2:rank) {
		    denom <- denom * dl[i-1]
		    nextd1 <- wh1 %/% denom# (next dim of elements) - 1
		    wh[,i] <- 1 + nextd1 %% dl[i]
		}
	    }
	    storage.mode(wh) <- "integer"
	}
    }
    wh
}
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 14:03:56 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 15:03:56 +0200 (CEST)
Subject: [R] R: ts - objects (PR#228)
In-Reply-To: <199907151153.NAA06756@pubhealth.ku.dk>
Message-ID: <XFMail.990715150356.plummer@iarc.fr>

> Marcus Eger <marcus.eger@physik.uni-marburg.de> writes:
>> 
>> -----------------------------------------------------------------------------
>> 3. Another problem had to do with the value of delta and/or start:
>> -----------------------------------------------------------------------------
>> > time(ts(c(1,2,3,4),start=3,delta=1.5))
>> Error: invalid start
> 
> or just: 
> 
>> ts(c(1,2,3,4),start=3,delta=1.5)
> Time Series:
> Start = c(3, 1) 
> End = c(7, 1) 
> Frequency = 0.666666666666667 
> Error: invalid start
> 
> ..which is pretty darn weird! CC'ed to R-bugs.

That's just the print method for ts objects calling
time().

The underlying problem is in start().
> start(x)
[1] 3 1

I think the 2-vector form of start and end only makes sense when the
frequency is an integer. If I am right then the following versions of
start.ts and end.ts (which check that tsp[3] is an integer) should solve
the problem.

M.

"start.ts" <- function (x) 
{
    ts.eps <- .Options$ts.eps
    ##if(is.null(ts.eps)) ts.eps <- 1.e-5
    tsp <- attr(as.ts(x), "tsp")
    is <- tsp[1] * tsp[3]
    if (abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < 
        ts.eps) {
        is <- floor(tsp[1])
        fs <- floor(tsp[3] * (tsp[1] - is) + 0.001)
        c(is, fs + 1)
    }
    else tsp[1]
}

"end.ts" <- function(x)
{
    ts.eps <- .Options$ts.eps
    ## if(is.null(ts.eps)) ts.eps <- 1.e-5
    tsp <- attr(as.ts(x), "tsp")
    is <- tsp[2] * tsp[3]
    if (abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < 
        ts.eps) {
        is <- floor(tsp[2])
        fs <- floor(tsp[3] * (tsp[2] - is) + 0.001)
        c(is, fs + 1)
    }
    else tsp[2]
}

M.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Thu Jul 15 16:19:22 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Thu, 15 Jul 1999 15:19:22 +0000
Subject: tseries
References: <XFMail.990715163125.plummer@iarc.fr>
Message-ID: <378DFBF9.FE784F5E@wu-wien.ac.at>

Martyn Plummer wrote:

> Dear Adrian,

Hi Martin

>
>
> Thank you for providing your time series library for R. I have been
> working on a time series package myself, with help from Paul Gilbert. It
> is called "bats" (doesn't stand for anything except possibly "basic time
> series") and can be found in the devel directory on CRAN.
>
> The "bats" library was a collection of S-PLUS compatibile functions
> that I needed for my "coda" package. With a little encouragement from
> Paul, I split these off into a separate package and developed them into
> more-or-less full clones of the S-PLUS functions. There are a couple of
> functions yet unwritten (autoregressive estimation via Burg's algorithm
> and spectral density estimation from fitting ar models) and this is the
> only reason why the package is in the "devel" directory.
>
> I am writing to ask if you would like to merge the two libraries
> together. The primary design goal of bats is compatibility with S-PLUS,

Even if I would like to, it would not be easy for me because I don't have
access to any S-PLUS.

To the R developpers: Is that a primary design goal?

>
> which may not be what you want. In any case, both libraries are GPL so
> you are free to use any of the code. Please have a look at bats and
> tell me what you think.
>
> Martyn

I compared the acf functions of both "bats" and "tseries":

> x<-rnorm(10000)
> library(bats)
> x<-rnorm(10000)
> system.time(a<-acf(x,1000))
[1] 15.70  0.02 31.00  0.00  0.00
> library(tseries)
> system.time(a<-acf(x,1000,pl=F))
[1] 0.29 0.00 1.00 0.00 0.00
>

I think, to achieve a better performance you should avoid loops of the
order of the length of a usual data set. It makes your routines very slow.

Though I think we should here some opinions about the design of a time
series library and then we can discuss about merging any parts or splitting
some programming work for THE R time series library.

Thanks

Adrian


--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 15 16:47:25 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 15 Jul 1999 17:47:25 +0200 (CEST)
Subject: docs: topic && availability
In-Reply-To: <378CDF72.5499BD27@bank-banque-canada.ca>
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
 <378CDF72.5499BD27@bank-banque-canada.ca>
Message-ID: <14222.653.137118.492844@balin.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> I've often thought that some sort of synonym dictionary would be
> useful, especially for new users. That is, give the name of some
> procedure, say in Matlab, SAS or SPSS, or even a statistical term, and
> get information about possible procedures to consider in S/R (and the
> other way around too). I think this might be much more broadly useful
> than just for R, so I wouldn't tie it too closely to R help() or CRAN.

Yes, it is much more broadly useful.

Nevertheless, using \index{} in Rd files would be one source for such
info, almost ``for free'' ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 16:51:04 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 15 Jul 1999 16:51:04 +0100 (BST)
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <Pine.GSO.4.05.9907151649240.26531-100000@auk.stats>

On Thu, 15 Jul 1999, Adrian Trapletti wrote:

> Martyn Plummer wrote:
> 
> > Dear Adrian,
> 
> Hi Martin
> 
> >
> >
> > Thank you for providing your time series library for R. I have been
> > working on a time series package myself, with help from Paul Gilbert. It
> > is called "bats" (doesn't stand for anything except possibly "basic time
> > series") and can be found in the devel directory on CRAN.
> >
> > The "bats" library was a collection of S-PLUS compatibile functions
> > that I needed for my "coda" package. With a little encouragement from
> > Paul, I split these off into a separate package and developed them into
> > more-or-less full clones of the S-PLUS functions. There are a couple of
> > functions yet unwritten (autoregressive estimation via Burg's algorithm
> > and spectral density estimation from fitting ar models) and this is the
> > only reason why the package is in the "devel" directory.
> >
> > I am writing to ask if you would like to merge the two libraries
> > together. The primary design goal of bats is compatibility with S-PLUS,
> 
> Even if I would like to, it would not be easy for me because I don't have
> access to any S-PLUS.
> 
> To the R developpers: Is that a primary design goal?

One design goal for one library.

> >
> > which may not be what you want. In any case, both libraries are GPL so
> > you are free to use any of the code. Please have a look at bats and
> > tell me what you think.
> >
> > Martyn
> 
> I compared the acf functions of both "bats" and "tseries":
> 
> > x<-rnorm(10000)
> > library(bats)
> > x<-rnorm(10000)
> > system.time(a<-acf(x,1000))
> [1] 15.70  0.02 31.00  0.00  0.00
> > library(tseries)
> > system.time(a<-acf(x,1000,pl=F))
> [1] 0.29 0.00 1.00 0.00 0.00
> >
> 
> I think, to achieve a better performance you should avoid loops of the
> order of the length of a usual data set. It makes your routines very slow.
> 
> Though I think we should here some opinions about the design of a time
> series library and then we can discuss about merging any parts or splitting
> some programming work for THE R time series library.

I have been promising to do this for some time (indeed, promised Adrian
to do so). Let me try to do some work on this and come to a proposal
shortly.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 17:04:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 18:04:09 +0200
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at> (message from Adrian Trapletti
 on Thu, 15 Jul 1999 15:19:22 +0000)
References: <XFMail.990715163125.plummer@iarc.fr> <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <199907151604.SAA10786@sophie.ethz.ch>

Dear Adrian (and everyone else),

to the same topic,
I've got a file "tseries-comments" five days old that I never got around
polishing before sending to you :

>> Thank you very much for the functionality !
>> 
>> - tsparam : not the best name for that class.. ???
>> 
>>    ybnd : should be allowed to have EITHER length 1 of length = length(x)
>> 
>>    --> my patched version
>> 
>> - plot.tsparam: 	use 'type = "h"'  as default!
>> 
>> - acf, pacf :
>> 
>> 	are *one* function in S-plus,
>> 
>> 	use 'plot = T', not 'pl = T'  as argument
>> 			(in line with several other R functions !)
>> 
>>   --> other small improvements...
>> 
>>   {including:  instead of  rep(0, nnn),  use numeric(nnn) }
>> 
>>    --> my version
>> [[ I'll send this in private to Adrian ]]

As you see, 
some of these 5day old comments are in line with Martyn's 
(he is Martyn, I am Martin). 

A few thoughts :

- Yes, we want to be S(-plus) compatible as long as it is not too hard or
  there are not good reasons against compatibility.
 
  Particularly,  acf(), spec.pgram(),  spectrum(), ar(), ar.yw()
  should have compatible argument names [at least for the important ones]
  to make it easy to many users moving from S to R (;-).

- Of course, it is *the wise thing* to use FFT for acf -- for the case of no
  NAs.. [and I think the NA case should be handled as well, and for small
        no-NA series that straightforward method will probably be faster
	than FFT as well ].

- I'd very much appreciate if Martyn and you and Paul G. 
  (and Brian and Ross and ... 
   and me, we also have a few improvements on S-plus laying around here)
  could coordinate to produce ``the real'' time series package for R.

- As a matter of fact, I hope that some of the functions would become part
  of "Core R" (such as e.g. "modreg" is base of "Core R"),
  since e.g., the availability of  acf()  should not depend on having a
  contributed package installed on top of "Core R".

Thanks once more to all the "time series" coders !
Martin

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 17:19:11 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 18:19:11 +0200 (CEST)
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <XFMail.990715181911.plummer@iarc.fr>

On 15-Jul-99 Adrian Trapletti wrote:
> Martyn Plummer wrote:
>> I am writing to ask if you would like to merge the two libraries
>> together. The primary design goal of bats is compatibility with S-PLUS,
> 
> Even if I would like to, it would not be easy for me because I don't have
> access to any S-PLUS.

Oh.
 
> To the R developpers: Is that a primary design goal?

A delicate question. Some people have strong views on compatibility, but
I think it is safe to say that compatibility with S considered a good thing
as it makes it easier to port existing S code to R, and that on that basis
incompatibilities are considered bugs, unless there is a good reason for
doing something differently.

However, here we are talking about the PLUS part of S-PLUS, for which there
are fewer precedents, and it may even be good politics to do things differently.

>>
>> which may not be what you want. In any case, both libraries are GPL so
>> you are free to use any of the code. Please have a look at bats and
>> tell me what you think.
>>
>> Martyn
> 
> I compared the acf functions of both "bats" and "tseries":
> 
>> x<-rnorm(10000)
>> library(bats)
>> x<-rnorm(10000)
>> system.time(a<-acf(x,1000))
> [1] 15.70  0.02 31.00  0.00  0.00
>> library(tseries)
>> system.time(a<-acf(x,1000,pl=F))
> [1] 0.29 0.00 1.00 0.00 0.00
>>
> 
> I think, to achieve a better performance you should avoid loops of the
> order of the length of a usual data set. It makes your routines very slow.

Ouch! I know that acf isn't very efficient, but on the other hand I have
never wanted to calculate the acf to this order, and if I did I would
certainly use fft too.
 
> Though I think we should here some opinions about the design of a time
> series library and then we can discuss about merging any parts or splitting
> some programming work for THE R time series library.
> 
> Thanks
> 
> Adrian

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 17:30:12 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 18:30:12 +0200 (CEST)
Subject: tseries
In-Reply-To: <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <XFMail.990715183012.plummer@iarc.fr>

On 15-Jul-99 Martin Maechler wrote:
> - Of course, it is *the wise thing* to use FFT for acf -- for the case of no
>   NAs.. [and I think the NA case should be handled as well, and for small
>         no-NA series that straightforward method will probably be faster
>       than FFT as well ].

This reminds me of a request I have been meaning to make.

S-plus time series functions normally use only the longest contiguous
portion of the series with no missing values. I think a good way to implement
this would be to have an "na.omit" method for time series, but this
isn't a generic function in R (It is in SPLUS 3.3). Could this be changed?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 17:36:48 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 18:36:48 +0200
Subject: docs: topic && availability
In-Reply-To: <14222.653.137118.492844@balin.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 15 Jul 1999 17:47:25 +0200 (CEST))
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
 <378CDF72.5499BD27@bank-banque-canada.ca> <14222.653.137118.492844@balin.ci.tuwien.ac.at>
Message-ID: <199907151636.SAA10972@sophie.ethz.ch>

Just to give my 5 Rp. in a very time constrained situation:

Yes, Kurt, 
yes, yes!

This *is* an urgent problem we should attack.

If someone doesn't find the Wilcoxon Test in R, {s}he must think we are all
nuts to use such a system at all .. until some crack tells him
``oh yeah, that's available in "ctest"...''.
and Joe User replies to the crack ``how on earth should I have guessed..''

[[and I **REALLY** think wilcoxon.test() should be moved to "Core R", even
  to the base:package !]]

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 15 17:38:03 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 15 Jul 1999 18:38:03 +0200 (CEST)
Subject: tseries
In-Reply-To: <199907151604.SAA10786@sophie.ethz.ch>
References: <XFMail.990715163125.plummer@iarc.fr>
 <378DFBF9.FE784F5E@wu-wien.ac.at>
 <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <14222.3691.526557.34151@balin.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> Dear Adrian (and everyone else), to the same topic, I've got a file
> "tseries-comments" five days old that I never got around polishing
> before sending to you :

>>> Thank you very much for the functionality !
>>> 
>>> - tsparam : not the best name for that class.. ???
>>> 
>>> ybnd : should be allowed to have EITHER length 1 of length = length(x)
>>> 
--> my patched version
>>> 
>>> - plot.tsparam: 	use 'type = "h"'  as default!
>>> 
>>> - acf, pacf :
>>> 
>>> are *one* function in S-plus,
>>> 
>>> use 'plot = T', not 'pl = T'  as argument
>>> (in line with several other R functions !)
>>> 
--> other small improvements...
>>> 
>>> {including:  instead of  rep(0, nnn),  use numeric(nnn) }
>>> 
--> my version
>>> [[ I'll send this in private to Adrian ]]

> As you see, 
> some of these 5day old comments are in line with Martyn's 
> (he is Martyn, I am Martin). 

> A few thoughts :

> - Yes, we want to be S(-plus) compatible as long as it is not too hard
>   or there are not good reasons against compatibility.

Agreed.
 
>   Particularly, acf(), spec.pgram(), spectrum(), ar(), ar.yw() should
>   have compatible argument names [at least for the important ones] to
>   make it easy to many users moving from S to R (;-).

Agreed.

> - Of course, it is *the wise thing* to use FFT for acf -- for the case
>   of no NAs.. [and I think the NA case should be handled as well, and
>   for small no-NA series that straightforward method will probably be
>   faster > than FFT as well ].

> - I'd very much appreciate if Martyn and you and Paul G.  (and Brian
>   and Ross and ...  and me, we also have a few improvements on S-plus
>   laying around here) could coordinate to produce ``the real'' time
>   series package for R.

> - As a matter of fact, I hope that some of the functions would become
>   part of "Core R" (such as e.g. "modreg" is base of "Core R"), since
>   e.g., the availability of acf() should not depend on having a
>   contributed package installed on top of "Core R".

Yes, definitely.

> Thanks once more to all the "time series" coders !

What I'd like to see in particular is some work going into model-style
interfaces.  Not sure exactly what it would be like, but something like

   armaxm(y ~ x, orderspecifications)

or maybe even

   armaxm(y ~ A(L) * y + B(L) * e + C(L) * x, ...)

Actually, creating an ARMA model could happen via the parameters or via
fitting data, so here is an extra challenge.

(A comment on tseries:  If possible, I'd prefer to use UC ini style
naming for data sets, such as TreeRing etc.  Name space etc ...)

-k



> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
> Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
> phone: x-41-1-632-3408		fax: ...-1086			<><
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From osman.buyukisik@ae.ge.com  Thu Jul 15 20:24:35 1999
From: osman.buyukisik@ae.ge.com (U-E59264-Osman F Buyukisik)
Date: Thu, 15 Jul 1999 15:24:35 -0400 (EDT)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
 <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
Message-ID: <14222.13284.386863.936325@c1186.ae.ge.com>

July 14 tarball.
In my case hpux 10.20 with gcc/f77/make (gnu make), The configure does 
not correctly pick the FPICFLAGS. It should be "+z". ALso the SHLIBLD
is incorrectly set as "gcc", it should be "ld". I fixed both in
Makeconf and etc/Makeconf and the build went OK. dynamic load stuff
seems to be working (eda loads OK and works).
I also have to hand fix "readline". It correctly picks that I have
readline but not history! Also the the readline lib location had to be 
corrected. Since it knows where to look up for the readline.h why
could it not find the lib location? in my case they are in
$prefix/include and $prefix/lib. 

Best Regards,
osman

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Jul 15 20:38:44 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 15 Jul 1999 15:38:44 -0400
Subject: ``the real'' time series package
References: <XFMail.990715163125.plummer@iarc.fr> <378DFBF9.FE784F5E@wu-wien.ac.at> <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <378E38C4.AF2B1803@bank-banque-canada.ca>

>- I'd very much appreciate if Martyn and you and Paul G.
>  (and Brian and Ross and ...
>   and me, we also have a few improvements on S-plus laying around here)
>  could coordinate to produce ``the real'' time series package for R.

I'd like to split this into pieces:

- Some core functions for Splus compatibility. (acf and ar are the important
ones for me right now, but the spectrum stuff is important too.) Name space
conflicts will be a problem if there are two versions of, for example, acf,
which take different arguments (and  give different results - although bats acf
purposely gives different results from Splus). The objective of "bats" was to
fill this gap.

- Programming tools for operating on the time dimension of data. My tframe
library tries to do most of that. The idea is that other programs should be able
to use window, start, end, trim.na, etc., and not need to worry about whether
the time series is an old S tsp series, a "ts", an "rts", a "cts", a "tf", or
anything else that might come along. The library seems to work well and provides
an extremely useful building block. (I always appreciate constructive comments.)
This is also related to the question of what "[.ts" should do.

- A convenient method for pulling time series data from other sources into R
(and S and Omega, etc.). My PADI library does that. It works well, but is
getting a bit dated. I've been thinking about a CORBA replacement. (Any
volunteers to work on that?)

- A library of optimization methods which can be used for maximizing
likelihood(data, model(parameters)) would be useful. This is not specific to
time series and there is a fair amount of stuff around, so the problem is really
just making sure it fits the time series context. I have DFP and non-linear
simplex, but I haven't used them in a while.

- General structures for time series analysis. I am relatively committed to the
structure I have been using for several years now, but I would always consider
improvements. It should at least be considered as a good starting point. The
main elements are:
    1/  an abstract data representation with a distinction between input
(exogenous or conditioning) data and output (endogenous) data. These are x and y
in y ~ f(x), but it seems useful to put them in one structure because time
alignment is important. Then for example, window can be applied to the two
together rather than separately.  Currently my code supports an internal
implementation (input and output are time series matrices) and a PADI
implementation (the data is on a remote database running the PADI interface).
    2/  an abstract model representation which can be applied to the data.
Currently my code supports multivariate ARMA and state space models, Troll
models, and some crude attempts with NN models. But the idea is that it should
be easy to add other representations.
    3/  an object which combines the above two and adds some statistics
(likelihood, residuals, etc.)

- Methods for operating on the general structures: estimation techniques,
simulation, conversion, information criteria, etc. This is the fun part. I have
a fair amount of this, but it should be easy to add more.

- "Superstructure" methods for studying estimation techniques and the
forecasting properties of models. For example, one can take a "true model"
(defined as in 2/), simulate it (to get data as in 1/), and examine the small
sample properties of different estimation techniques. Or, take a given data set
and examine the (out-of-sample) forecasting properties of different models. The
idea is that these superstructure methods do not need to be changed if new data
representations or new model representations are added. (e.g. they do not need a
specific method for a new kind of model, they just call "simulate" and there
needs to be a simulate method for the new model.) My library has a fair amount
of this too,  but there is always room to add more here.

There are several areas in which I think my library is good, and there are
several deficiencies. I've played a bit with frequency domain methods, but that
is a general weakness. I'm very happy to see Adrian's unit root stuff, as it has
been on my "to do" list for several years now. I also get regular requests for
ARCH and GARCH modeling.

I do hope people will work on new stuff rather than things which are already
done by someone else. It might be useful to put a "time series" bullet on CRAN
(in contrib/PACKAGES.html probably) giving a general outline of what is where. I
get pretty upset when I see references to the lack of time series functionality
in R. (My DSE package is in the development area of CRAN only because the
documentation is in HTML rather than R's .Rd format and R's installation
procedures have been changing. The code is not unstable or incomplete.  The
version on CRAN installed with 0.63? and the most recent version at
<http://www.bank-banque-canada.ca/pgilbert> installs with 0.64 and 0.65)

Paul Gilbert


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 23:25:16 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 15 Jul 1999 23:25:16 +0100 (BST)
Subject: ``the real'' time series package
In-Reply-To: <378E38C4.AF2B1803@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907152315160.6049-100000@auk.stats>

On Thu, 15 Jul 1999, Paul Gilbert wrote:

> >- I'd very much appreciate if Martyn and you and Paul G.
> >  (and Brian and Ross and ...
> >   and me, we also have a few improvements on S-plus laying around here)
> >  could coordinate to produce ``the real'' time series package for R.
> 
> I'd like to split this into pieces:
> 
> - Some core functions for Splus compatibility. (acf and ar are the important
> ones for me right now, but the spectrum stuff is important too.) Name space
> conflicts will be a problem if there are two versions of, for example, acf,
> which take different arguments (and  give different results - although bats acf
> purposely gives different results from Splus). The objective of "bats" was to
> fill this gap.

[...]

> I do hope people will work on new stuff rather than things which are already
> done by someone else. It might be useful to put a "time series" bullet on CRAN
> (in contrib/PACKAGES.html probably) giving a general outline of what is where. I
> get pretty upset when I see references to the lack of time series functionality
> in R. (My DSE package is in the development area of CRAN only because the
> documentation is in HTML rather than R's .Rd format and R's installation
> procedures have been changing. The code is not unstable or incomplete.  The
> version on CRAN installed with 0.63? and the most recent version at
> <http://www.bank-banque-canada.ca/pgilbert> installs with 0.64 and 0.65)

Paul:

you are taking a limited view of time series analysis: there _is_ a
lot missing from R (even if DSE is included, and as it lacks R
documentation and a Windows port, that is a moot point). In particular
there is no AFAIK

de-seasonalizing (e.g. X11-ARIMA or whatever, stl, sabl)
easy-to-use (seasonal) ARIMA fitting
flexible spectral analysis
GARCH etc
regression with autocorrelated errors and related econometric techniques
(there is now some in lme, but I still have problems with that under R).

Compared to S-PLUS (especially 5.1, including the add-on modules) I think
`the lack of time series functionality in R' is fair comment. Let's
change that. Some of it is easy to do: the S-PLUS spectral analysis stuff
is based on Bloomfield's code, and I already have a package based on that.
Similarly, I have easy-to-use (seasonal) ARIMA fitting to hand.

I'll try to review what we do have and the gaps and report to R-devel
on Monday.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Fri Jul 16 03:09:33 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Fri, 16 Jul 1999 04:09:33 +0200 (MET DST)
Subject: dev.print scaling bug? (PR#229)
Message-ID: <199907160209.EAA10314@pubhealth.ku.dk>


# demo of bug in dev.print()
# (trivial, but detracts from Rolls Royce feel of R and forces workarounds)
# seen in rw0642 and linux version of 0.64.1

# Verbal attempt at generalising the behaviour illustrated by this file:

# If "par(mfrow)" is used to set more than 2 graphs vertically or 
# horizontally on the page, then, in the file generated by "dev.print()", 
# the default size of the graph points created by "points()" differs from 
# the size created by "plot()", although it does not differ on the 
# screen display.

a_1:10
b_c(2:10,NA)

opar_par(mfrow=c(1,3))	# set up page for 1x3 graphs, bug
#opar_par(mfrow=c(3,1))	# set up page for 3x1 graphs, bug
#opar_par(mfrow=c(2,1))	# set up page for 2x1 graphs, OK

plot(a,a)
points(a,b)

plot(a,b)
points(a,a)

plot(a,a)
points(a,b)

par(opar)

dev.print(file="printdev.ps")

# gv or print "printdev.ps"

----------------------------------------------------------------------------

Thanks for R

John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 08:52:35 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 09:52:35 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14222.13284.386863.936325@c1186.ae.ge.com>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
 <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
 <14222.13284.386863.936325@c1186.ae.ge.com>
Message-ID: <14222.58563.920246.500172@aragorn.ci.tuwien.ac.at>

>>>>> U-E59264-Osman F Buyukisik writes:

> July 14 tarball.

> In my case hpux 10.20 with gcc/f77/make (gnu make), The configure does
> not correctly pick the FPICFLAGS. It should be "+z". ALso the SHLIBLD
> is incorrectly set as "gcc", it should be "ld". I fixed both in
> Makeconf and etc/Makeconf and the build went OK. dynamic load stuff
> seems to be working (eda loads OK and works).

A mental malfunction on my behalf ... sorry.  Should be fixed now.  

> I also have to hand fix "readline". It correctly picks that I have
> readline but not history! Also the the readline lib location had to be 
> corrected. Since it knows where to look up for the readline.h why
> could it not find the lib location? in my case they are in
> $prefix/include and $prefix/lib.

Don't know.  You say that you have /usr/local/lib/libreadline.a but it
is not found?  (by gcc?)  Very strange ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Fri Jul 16 14:12:30 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Fri, 16 Jul 1999 14:12:30 +0100 (BST)
Subject: vector()
Message-ID: <Pine.GSO.3.96.990716140337.4499A-100000@laplace>

Can I suggest that vector() has an additional names argument?  This would
make it more comparable with matrix() and array().  I frequently find
myself doing

	fred <- vector("list", length(happy))
	names(fred) <- names(happy)

when I would rather be doing

	fred <- vector("list", length(happy), names = names(happy))

Just a thought.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From johann@ai.univie.ac.at  Fri Jul 16 14:13:03 1999
From: johann@ai.univie.ac.at (Johann Petrak)
Date: Fri, 16 Jul 1999 15:13:03 +0200
Subject: R-0.64.2 ssize_t not defined in src/unix/sock.h
Message-ID: <378F2FDF.349381C0@ai.univie.ac.at>

I though I should let you all know of this:

Trying to build R-0.62.2 on a SunOS xxxx 4.1.4 2 sun4m machine
using gcc (gcc version egcs-2.91.57 19980901 (egcs-1.1 release)):

gnumake[2]: Entering directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
gcc -g -O2 -I../include -I../../src/include  -c Rsock.c -o Rsock.o
In file included from Rsock.c:8:
sock.h:21: parse error before `Sock_read'
sock.h:21: warning: data definition has no type or storage class
sock.h:22: parse error before `Sock_write'
sock.h:22: warning: data definition has no type or storage class
Rsock.c: In function `Rsockwrite':
Rsock.c:112: `ssize_t' undeclared (first use in this function)
Rsock.c:112: (Each undeclared identifier is reported only once
Rsock.c:112: for each function it appears in.)
Rsock.c:112: parse error before `n'
Rsock.c:125: `n' undeclared (first use in this function)
gnumake[2]: *** [Rsock.o] Error 1
gnumake[2]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
gnumake[1]: *** [R] Error 1
gnumake[1]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src'
gnumake: *** [R] Error 1

Adding a typedef like for Win32 seems to help ...

Johann

---
Johann Petrak                       Email: johann@ai.univie.ac.at
Austrian Research Institute for AI  Phone:     +43-1-533-61-12/13
Schottengasse 3                     Fax:       +43-1-532-61-12/77
A-1010 Vienna, AUSTRIA         http://www.ai.univie.ac.at/~johann
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 14:22:10 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 15:22:10 +0200 (CEST)
Subject: R-0.64.2 ssize_t not defined in src/unix/sock.h
In-Reply-To: <378F2FDF.349381C0@ai.univie.ac.at>
References: <378F2FDF.349381C0@ai.univie.ac.at>
Message-ID: <14223.12802.659507.724069@aragorn.ci.tuwien.ac.at>

>>>>> Johann Petrak writes:

> I though I should let you all know of this:
> Trying to build R-0.62.2 on a SunOS xxxx 4.1.4 2 sun4m machine
> using gcc (gcc version egcs-2.91.57 19980901 (egcs-1.1 release)):

> gnumake[2]: Entering directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
> gcc -g -O2 -I../include -I../../src/include  -c Rsock.c -o Rsock.o
> In file included from Rsock.c:8:
> sock.h:21: parse error before `Sock_read'
> sock.h:21: warning: data definition has no type or storage class
> sock.h:22: parse error before `Sock_write'
> sock.h:22: warning: data definition has no type or storage class
> Rsock.c: In function `Rsockwrite':
> Rsock.c:112: `ssize_t' undeclared (first use in this function)
> Rsock.c:112: (Each undeclared identifier is reported only once
> Rsock.c:112: for each function it appears in.)
> Rsock.c:112: parse error before `n'
> Rsock.c:125: `n' undeclared (first use in this function)
> gnumake[2]: *** [Rsock.o] Error 1
> gnumake[2]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
> gnumake[1]: *** [R] Error 1
> gnumake[1]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src'
> gnumake: *** [R] Error 1

> Adding a typedef like for Win32 seems to help ...

This is fixed in 0.65.  I'll also do it for r-release.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 15:58:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 16:58:54 +0200 (CEST)
Subject: 0.65/HPUX
Message-ID: <14223.18606.15426.849188@aragorn.ci.tuwien.ac.at>

After further elimination of sort-of-GNUish things in the Makefiles and
tweaking of configure, I can now successfully build on HPUX with
cc/f77/make (note: everything native).  make check still fails, but ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sat Jul 17 23:16:10 1999
From: bates@stat.wisc.edu (bates@stat.wisc.edu)
Date: Sun, 18 Jul 1999 00:16:10 +0200 (MET DST)
Subject: Use of lwd = 0, lty = 2 in segments. (PR#230)
Message-ID: <199907172216.AAA19732@pubhealth.ku.dk>

This may not be considered a bug but it is an incompatibility with S.

There was a convention in S that the graphics parameter setting 
 lwd = 0 
is supposed to use the minimum possible line width on the device.  It
is not clear what that means on modern graphics devices but there is
still code (like mine) that assumes something sensible happens with
 lwd = 0
It seems that R's postscript device driver does something reasonable
with that for some graphics functions but not others.  The abline
function seems ok but the segments function doesn't.

The following produces a PostScript output file "foo.ps" that causes
ghostscript to complain of an error.
R> postscript("foo.ps")
R> plot(1:10, 1:10, type = "n")
R> abline(h = 5, lty = 2, lwd = 0)   # works properly
R> segments(1, 1, 1, 3, lty = 2, lwd = 0)  # fails
R> dev.off()

The last part of the PostScript file is

0.75 setlinewidth
[ 3.00 3.00] 0 setdash
np
77.04 290.39 m
743.76 290.39 l
o
0.00 setlinewidth
[ 0.00 0.00] 0 setdash
np
101.73 107.87 m
101.73 199.13 l

It is the line "[ 0.00 0.00] 0 setdash" that causes the problems.

The error message from Ghostscript is

Error: /rangecheckAladdin Ghostscript: Unrecoverable error, exit code 1
 in --setdash--
Operand stack:
   --nostringval--   0
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1   3   %oparray_pop   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   2   3   %oparray_pop   --nostringval--   --nostringval--
Dictionary stack:
   --dict:874/941(G)--   --dict:0/20(G)--   --dict:75

I notice that in the C function PostScriptSetLineTexture in devPS.c,
the step lengths seem to be multiplied by something that may be the
line width before being written to the PostScript file.

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Jul 18 11:38:17 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 18 Jul 1999 12:38:17 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
 <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
 <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
 <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>
 <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
Message-ID: <14225.44697.457131.874849@elendil.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> On the system I have access to, I can compile only with
>> 
>> -D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
>> or
>> -D_ALL_SOURCE
>> 
>> In either case, we get the above.
>> 
>> I will hence use ALL_SOURCE for the time being.
>> 
>> Note that
>> 
>> > 1/0 - 1/0# NaN
>> [1]NaNQ
>> > is.nan(1/0 - 1/0)
>> [1] TRUE
>> 
>> so what is really going on here???

> Double "hmmmm"....

> Can you run this under gdb? If so, could you set a breakpoint in
> EncodeReal and step through it? 

> That'll be (roughly)

> R -d gdb
> (gdb) run
> ^C
> (gdb) break EncodeReal
> (gdb) continue
>> 1/0
> (gdb) next
> <etc.>

> I bet it never enters the "if (!R_FINITE(x))" branch as it should.
> This could happen if HAVE_FINITE and IEEE_754 are both undefined in
> Arith.h, or if finite(x) doesn't work in the IEEE way.

>> From what Martin has been telling us, AIX is using IEEE format numbers
> and arithmetic anyhow, so it should be fairly easy to fudge a better
> R_FINITE (and ISNAN too). I think we went through some of that last
> time we had R_FINITE/ISNAN and friends on the board, didn't we?
> Something pretty close to the following should work:

> #define R_FINITE(x) ({double y = x; \
> 	 *((int *) &y) & 0x7ff00000 != 0x7ff00000})

> #define ISNAN(x) ({double y = x; \
> 	*((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
> 	(*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

> Of course, that kind of code is pretty architecture dependent, etc...
> Perhaps one should first check what the status of IEEE macros in AIX
> really is.

Hmm ... I just realized that the AIX system I have access to has no gdb
(it does have dbx, but I never used it before ...).

Could anyone else try to do the above exercise?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@cmis.CSIRO.AU  Mon Jul 19 00:54:59 1999
From: Bill.Venables@cmis.CSIRO.AU (Venables, Bill (CMIS, Cleveland))
Date: Mon, 19 Jul 1999 09:54:59 +1000
Subject: vector()
Message-ID: <D16979FB73F3D11195510000F8030FB90528A1@roper.qld.cmis.csiro.au>

You might think about using structure()

fred <- structure(vector("list", length(happy)), names = names(happy))

and in fact you can add as many attributes as you like.  This seems a better
plan than tweaking vector() (where do you stop?) and maintains consistency
with S3 at this low level.

It must be said, though, this natural and innocent looking idiom that I once
used quite a lot in S3 code had nasty consequences in going from S3 to S4,
(as BDR frequently reminds me!)

Bill V.


-----Original Message-----
From: Jonathan Rougier [mailto:J.C.Rougier@durham.ac.uk]
Sent: Friday, July 16, 1999 11:13 PM
To: r-devel@stat.math.ethz.ch
Subject: vector()


Can I suggest that vector() has an additional names argument?  This would
make it more comparable with matrix() and array().  I frequently find
myself doing

	fred <- vector("list", length(happy))
	names(fred) <- names(happy)

when I would rather be doing

	fred <- vector("list", length(happy), names = names(happy))

Just a thought.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
_._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 08:18:33 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 08:18:33 +0100 (BST)
Subject: vector()
In-Reply-To: <D16979FB73F3D11195510000F8030FB90528A1@roper.qld.cmis.csiro.au>
Message-ID: <Pine.GSO.4.05.9907190817150.16539-100000@auk.stats>

On Mon, 19 Jul 1999, Venables, Bill (CMIS, Cleveland) wrote:

> You might think about using structure()
> 
> fred <- structure(vector("list", length(happy)), names = names(happy))
> 
> and in fact you can add as many attributes as you like.  This seems a better
> plan than tweaking vector() (where do you stop?) and maintains consistency
> with S3 at this low level.
> 
> It must be said, though, this natural and innocent looking idiom that I once
> used quite a lot in S3 code had nasty consequences in going from S3 to S4,
> (as BDR frequently reminds me!)

(When used for setting classes instead of class<-, that is.)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 19 08:25:09 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 19 Jul 1999 09:25:09 +0200 (CEST)
Subject: 0.65 HPUX|AIX make check
Message-ID: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>

Update (for me):

* On HPUX (cc/f77/make), make check passes the Examples but fails in
arith-true.R because

	is.infinite(.Machine$double.base ^ .Machine$double.max.exp)

gives FALSE.

Interestingly

> .Machine$double.base
[1] 2
> .Machine$double.max.exp
[1] 1024
> 2 ^ 1024
[1] 1.797693e+308
> 2 ^ 1025
[1] 1.797693e+308
> 2 ^ 2024
[1] 1.797693e+308

so I guess we need help here.

* On AIX (gcc/f77/make), make check fails in the contour example

contor> contour(x, x, z, col = "pink", add = TRUE)
Error: missing value where logical needed

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From brouard@ined.fr  Mon Jul 19 10:47:21 1999
From: brouard@ined.fr (Nicolas Brouard)
Date: Mon, 19 Jul 1999 11:47:21 +0200
Subject: R-0.64.2 on AIX
In-Reply-To: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>
Message-ID: <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>

I am new on your list...

S language source code again available and in the Public Domain was a great
hope for me.

I remember that parts of S code was written in Ratfor. Now there are still
Fortran routines. Would they stay as is? I have nothing against Fortran but
it adds another compiler which is not as available as C and which exists on
too various forms (g77, f2c at least). For example my g77 (2.7) compiler on
AIX 4.1 did not know what a "save" was.

I haven't found an history of the different sources which builds the actual
R. But looking at the sources themself gives you an idea. A former question
on this list asked for a easy access to the archives, so is there a Web
access to the archives?

I built 0.64.2 on Linux (4.1) without any difficulty (most of you work on
Linux I presume).
On AIX, ./configure used gcc and g77 and I got a working R executable
without too much difficulties.

I just received a first email from your list where
the IEEE standard of AIX was discussed; thus I presumed that my executable
is not working so well.

I am not sure to have the time necessary to compile 0.65 and to be "with
you" but at least I will look at your mailing list and give you information
on AIX if I can.

Thanks for your work. It is a big work.
When I was teaching Mathematical Demography in the Department of Statistics
of ANU for one semester in 1993 I was surprised by the overall S knowledge
of the students. Most of my exams where easily solved with S (Demography
uses a lot of data). Back to France I couldn't go as far with the students
who only had Excel. Now with the availability of R (on Windows mainly) I
will try to use it with my French students.


--
Nicolas Brouard
Institut national d'tudes dmographiques
Paris
mailto:brouard@ined.fr  http://sauvy.ined.fr/~brouard



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Jul 19 16:54:31 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 19 Jul 1999 17:54:31 +0200 (MET DST)
Subject: summary.default & is.recursive (PR#221)
Message-ID: <199907191554.RAA28084@pubhealth.ku.dk>

>>>>> On Thu, 8 Jul 1999 20:36, p.dalgaard@biostat.ku.dk said:

    PD> Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
    >> is.recursive(list(z, a=list(1:3)) )
    >> 
    >> R64.2:> [1] FALSE
    Splus3.3> [1] T

    PD> Yup, it's a bug. Cc'ed to r-bugs so that we don't forget.

    >> is.recursive(list(1,2))
    PD> [1] FALSE
    >> is.recursive(pairlist(1,2))
    PD> [1] TRUE

Now fixed.

    PD> [maybe Martin would want to add a check that is.whatever works
    PD> identically on lists and pairlists. Not is.pairlist, though...]

Added to tests/is-things.R (& .Rout.save).
Both should be in the snapshots (R-devel.tar.gz) shortly..

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul 19 17:30:34 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 19 Jul 1999 18:30:34 +0200
Subject: tseries
In-Reply-To: <XFMail.990715183012.plummer@iarc.fr> (message from Martyn
 Plummer on Thu, 15 Jul 1999 18:30:12 +0200 (CEST))
References: <XFMail.990715183012.plummer@iarc.fr>
Message-ID: <199907191630.SAA18378@sophie.ethz.ch>

>>>>> On Thu, 15 Jul 1999 18:30:12 +0200 (CEST), Martyn Plummer <plummer@iarc.fr> said:

    Martyn> On 15-Jul-99 Martin Maechler wrote:
    >> - Of course, it is *the wise thing* to use FFT for acf -- for the
    >> case of no NAs.. [and I think the NA case should be handled as well,
    >> and for small no-NA series that straightforward method will probably
    >> be faster than FFT as well ].

    Martyn> This reminds me of a request I have been meaning to make.

    Martyn> S-plus time series functions normally use only the longest
    Martyn> contiguous portion of the series with no missing values. I
    Martyn> think a good way to implement this would be to have an
    Martyn> "na.omit" method for time series, but this isn't a generic
    Martyn> function in R (It is in SPLUS 3.3). Could this be changed?

Yes.
Just committed (R-devel, i.e. pre 0.65); similarly for na.fail().

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 18:49:27 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 18:49:27 +0100 (BST)
Subject: time series in R
Message-ID: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>

Time Series functions in R
==========================

I think a good basic S-like functionality for library(ts) in base R
would include

ts class, tsp, is.ts, as.ts
plot methods
start end window frequency cycle deltat
lag diff aggregate
filter

spectrum, spec.pgram, spec.taper, cumulative periodogram, spec.ar?

ar -- at least univariate by Yule-Walker
arima -- sim, filter, mle, diag, forecast

stl


Of the first group we lack lag, deltat, cycle, filter. These are simple.
We have plot.ts, but might want lines.ts, for example.

Base R has nothing else, so I've taken a look at bats, tseries, dse
and timeslab.

bats
====

This is close to S(-PLUS) but lacks examples.
Its methods are often simple ones: it might benefit a lot from some
re-coding in C / Fortran.

It would give us 

ar.yw

acf and spectrum (spec.pgram, plot.spec).


tseries
=======

This has S-like function names, but does not, for example, accept
multiple time series in acf.  It has nice plots and nice examples.
(It would be better if the LIBNAME were tseries, when no Makefile
would be needed: as it is $(LD) should be $(SHLIBLD) and CFLAGS +=
-Wall is not a good idea being make and CC-specific.)

It would give us

acf/ccf/pacf (for acf in S)
spectrum/cross spectra/cumulative.periodogram


dse
===

As far as I can see (it is very complex) this handles state-space models,
and can handle ARMA models by converting them (approximately)
to state-space form.

dse is rather un-R-like, and did not compile for me without fixing 20
or so Fortran errors, and did not load for me even after an hour's
work fixing many more in the R code. I think the version in devel is
currently unusable, and has far, far too many conflicts. Given Paul's
claims of stability, I have spent a deeply frustrating afternoon.


timeslab
========

Rather self-contained, copyright position unclear (to me).



Suggestions:
===========

If Martyn and Adrian are agreeable, I will start a library(ts) in the
0.65 version. I will put in this:

the ts class and methods (maybe in due course these should be removed
from the base package?)

datasets from MASS, tseries

lag, deltat, cycle
filter

acf from bats, augmented by ideas from tseries.

spectrum, spec.pgram from bats  (after looking at tseries hard)
spec.taper
cpgram from MASS

ar.yw from bats  (although that probably needs to be moved to
C/Fortran, and I may special-case the univariate case to use code I
have for that).


That leaves

stl -- I believe the code for this is on netlib.

arima modelling.  I do have Fortran code for this, and will work on
  a simple R interface for it.  An elegant interface can come later.


One thing we do need to be very careful about is the odd constants
and signs that occur in time-series work. No two books I consulted
agree exactly on the definitions of the periodogram and spectrum!
I think we should follow S-PLUS unless there are compelling reasons
not to. I am bit worried that some of the fft usage actually
only computes approximations, and we need to assess how serious that is.


As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
ought to concentrate on getting the basic stuff (bats-like) in first.

How does that sound as a plan?

Brian


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul 19 21:42:09 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Jul 1999 16:42:09 -0400
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37938DA0.BBC19173@bank-banque-canada.ca>

>As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
>ought to concentrate on getting the basic stuff (bats-like) in first.
>How does that sound as a plan?

I think this is a good idea.

>ar -- at least univariate by Yule-Walker

I'd really like the multivariate one if possible. I'm quite sure ar.yw
in bats is multivariate.

>dse
Following is not important for the immediate goal, but I am surprize and
would also like to correct a couple of mis-conceptions.

>As far as I can see (it is very complex) this handles state-space
models,
>and can handle ARMA models by converting them (approximately)
>to state-space form.

No. It handles both ARMA models and state-space models without any
conversion. It can also convert between the representations. In theory
this is algebraic and not approximate, but it is of course subject to
the usual numerical approximations of computers. The tolerances I get
are typically as good as or better than the differences between Solaris
and Linux calculation. (for example, 1e-15 for differences in residuals,
with data having order of magnitude around 1.) Model roots also compare
to very tight tolerances.

>dse is rather un-R-like, and did not compile for me without fixing 20
>or so Fortran errors, and did not load for me even after an hour's
>work fixing many more in the R code.

This surprizes me very much as it has compiled for me in Solaris and
Linux since R 0.16 (although I had to compile directly into R in those
days). At one point there was a bug in the g77 compiler which caused a
problem, but that seems to be fixed now. In earlier versions of R I used
f2c, and at  one point there were some unresolved references which I
fixed (by something simple like changing ^2 to ^2.0). When I used the
Sun Fortran compiler it always worked, but I haven't used it in a long
time now.

>I think the version in devel is
>currently unusable, and has far, far too many conflicts.
The version on CRAN is fairly old (by Internet time). Although the code
has not changed much, R's installation procedures have. I am surprized
that there are conflicts, but am not surprized that there are install
problems with recent versions of R, given all the changes in the way R
installs packages.  I intend to update the CRAN version as soon as R's
installation procedures stabalize. In most respects I believe that has
happened now, but there is a pending change in the building of help
files which I have been waiting to use. I have tried to advertize that
the most recent version at <www.bank-banque-canada/pgilbert> should
install with the most recent versions of R. I guess it would be useful
to have some indication of this on CRAN. Perhaps it would be better not
to leave an old version on CRAN and instead just point to were the most
recent versions are located?

If others are having problems compiling this code please let me know.

Paul Gilbert




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon Jul 19 21:49:23 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 20 Jul 1999 08:49:23 +1200 (NZST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>

On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:

> Time Series functions in R

I agree with basically everything Brian says, and would add the
following thoughts:

    1.	Think carefully about defining interfaces before leaping
	into code.  By defining an interface independent of the
	particular code at hand we will make it easier to switch to
	new code.

    2.	Think multivariate even when implementing a function for
	univariate series.  If the interface is defined well, it
	should later be able to generalize to the multivariate case.
	I'd hate to see a second multivariate time-series package
	come along later.

    3.	On the definition question: The existing FFT implementation
	uses a particular definition for the discrete transform which
	is pretty standard.  (Edwards "Fourier Series", Brillinger
	"Time Series" etc.) Using another definition may complicate
	documentation.

    4.	The notation for ARMA models may well be the stuff that
	holy wars are made of, but my personal preference is
	    X[i] + phi[1] * X[i - 1] + ... + phi[p] * X[i - p]
	    = theta[0] + epsilon[i] + ... + theta[q] * epsilon[i - q]
	[ Man to judge: ``It was self defense - I thought he was
	  going to hit me, so I hit him first.'' ]

I'd also add a request for some flexible structural modelling code.
I've pretty much abandonded teaching ARIMA models in favour of
structural models.  (I've written some general code for this, but
there is probably better code about.  There are a couple of TOMS
algorithms for Kalman Filtering which should be checked out.)

Finally: Does anyone know Kitagawa?  He has some very nice time series
and smoothing code.  Could he be persuaded to make it available?

	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul 19 22:37:04 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Jul 1999 17:37:04 -0400
Subject: time series in R
References: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>
Message-ID: <37939A80.3BF10D12@bank-banque-canada.ca>

>    4.  The notation for ARMA models may well be the stuff that
>        holy wars are made of,
...
For this episode of the war perhaps we should stick with univariate
arima as in S, and use the same notation. For the multivariate episode I
like

A(L) y(t) = B(L) e(t) + C(L) u(t)

for ARMA models and

z(t) = F z(t-1) + G u(t) +K e(t-1)
y(t) = H z(t) + e(t)

for state-space models. I think it is important to think about
state-space and ARMA together, in order to try and have a consistent
approach.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 22:48:10 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 22:48:10 +0100 (BST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907192236250.4779-100000@auk.stats>

On Tue, 20 Jul 1999, Ross Ihaka wrote:

> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
> 
> > Time Series functions in R
> 
> I agree with basically everything Brian says, and would add the
> following thoughts:
> 
>     1.	Think carefully about defining interfaces before leaping
> 	into code.  By defining an interface independent of the
> 	particular code at hand we will make it easier to switch to
> 	new code.

Yes, but we also want (to some extent) back-compatibility with S(-PLUS).
I would like to get something in there, even if we discover it
is not right.  For example, I have been trying what is already there on
bivariate series, with a lot of surprises.

>     3.	On the definition question: The existing FFT implementation
> 	uses a particular definition for the discrete transform which
> 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> 	"Time Series" etc.) Using another definition may complicate
> 	documentation.

That's the simple part.  But what is the divisor in the periodogram? Which
way do lags go in acfs of bivariate series, and which sign is the phase for
bivariate spectra?

>     4.	The notation for ARMA models may well be the stuff that
> 	holy wars are made of, but my personal preference is
> 	    X[i] + phi[1] * X[i - 1] + ... + phi[p] * X[i - p]
> 	    = theta[0] + epsilon[i] + ... + theta[q] * epsilon[i - q]
> 	[ Man to judge: ``It was self defense - I thought he was
> 	  going to hit me, so I hit him first.'' ]

Well, that is not mine, and it is not S-PLUS's either.

I see the virtue of a grander plan, but would like to get the 
simpler parts in now. And having spent an hour writing ts.union and
ts.intersect, I realize the simpler parts are not so simple.  Bill and I
had planned a new ts package to go with V&R3, but the work seemed to
be too much (and seems to be too much before R 1.0, too).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Tue Jul 20 01:31:13 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 20 Jul 1999 12:31:13 +1200 (NZST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907192236250.4779-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9907201215490.18298-100000@stat1.stat.auckland.ac.nz>

On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:

> >     3.	On the definition question: The existing FFT implementation
> > 	uses a particular definition for the discrete transform which
> > 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> > 	"Time Series" etc.) Using another definition may complicate
> > 	documentation.
> 
> That's the simple part.  But what is the divisor in the periodogram? Which
> way do lags go in acfs of bivariate series, and which sign is the phase for
> bivariate spectra?

Once you settle the forward discrete transform much of this is settled.
No constant in the dft implies
	Periodogram = |dft|^2/(2*pi*T)
Phases in spectra also fall out if you take a +ve exponent in the dft.

I don't much mind about these choices, but its probably a good idea to
be consistent.
	
	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 02:23:09 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Mon, 19 Jul 1999 21:23:09 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "14 Jul 1999 00:12:48 EDT."
 <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907200123.VAA23498@infiniti.ece.cmu.edu>


"Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

Peter> Something pretty close to the following should work:
Peter> 
Peter> #define R_FINITE(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
Peter> 
Peter> #define ISNAN(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
see your point for the local var, but cc and gcc choke on it.

I've looked into /usr/include/fp.h which is included for AIX
platforms.  (Its version is 1.9)  There are defines for FINITE,
IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?
Does it make sense for configure to check, not only whether finite
exists but also whether it's broken?

BTW, if you step thru EncodeReal you see that !R_FINITE(x) if false
for 1/0 (i.e. 1/0 is not detected as not finite).

Here is first the C code to show what's working what's not.  (I picked
your stuff and added the calls to the macros.)  This is followed by
the output when compiled with cc and gcc.  I'm having major headaches
here with the -D_XOPEN_SOURCE_EXTENDED (details follow).  Maybe we can
dump finite in favor of FINITE?

Are  my assumptions about the return values are correct?

---> isfinite.c <---
#include <stdio.h>
#include <math.h>

#ifdef _AIX
# include <fp.h>
#endif

main() {
  double x,x2,x3;
  printf("finite(1.0)= %d (=1, hopefully)\n", finite(1.0));
  x=1./0.; x2= (-1.)/0.;  x3 = 0./0.;
  printf("Inf := 1/0 = %f;\t -Inf := -1/0 = %f;\t NaN:= 0/0 = %f\n",x,
         x2, x3);
  printf("finite(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
         finite(x),finite(x2),finite(x3));
  printf("Now the `bits':\n");
  printf(" Inf : %0x,%0x\n", ((int *) &x )[0], ((int *) &x )[1]);
  printf("-Inf : %0x,%0x\n", ((int *) &x2)[0], ((int *) &x2)[1]);
  printf(" NaN : %0x,%0x\n", ((int *) &x3)[0], ((int *) &x3)[1]);

#ifdef _AIX
  printf("FINITE(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
         FINITE(x),FINITE(x2),FINITE(x3));
  printf("IS_NAN(x), f.(x2), f.(x3): %d %d %d  (should be 0 0 1)\n",
         IS_NAN(x),IS_NAN(x2),IS_NAN(x3));
  printf("IS_INF(x), f.(x2), f.(x3): %d %d %d  (should be 1 1 0)\n",
         IS_INF(x),IS_INF(x2),IS_INF(x3));
#endif
}
---> end of isfinite.c <---

---> output <--
r-devel $ cc isfinite.c -o isfinite 2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7ff80000,0
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)
r-devel $ gcc -g -O2 isfinite.c -o isfinite 2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 1 1 1  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)
r-devel $ gcc -g -O2 isfinite.c -o isfinite -D_XOPEN_SOURCE_EXTENDED=1
2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 03:04:54 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Mon, 19 Jul 1999 22:04:54 -0400
Subject: R 0.65 and AIX: if it quacks like a duck...
Message-ID: <199907200204.WAA13374@infiniti.ece.cmu.edu>


Hi,

  this relates to R-devel of 1999/July/18.  I will outline what I had
to change to get R to compile with cc then with gcc.  Note that R
compiled with cc works, R compiled with gcc is broken.

--> Compile with cc:

1) Edit src/main/saveload.c: disable the undefine! With the #undef
_XOPEN_SOURCE_EXTENDED the compilation dies an untimely death.
(And the header files are not as badly broken for cc!)

2) Edit src/appl/sock.c: dto.

3) Edit src/unix/system.c: need a "break;" after default: in line 752
(yes, won't compile without)

4) Edit src/main/builtin.c: line 318 should read "#endif /* NOT_used */"
 (get rids of the warning)

5) CC=cc ../configure

Note this is broken for the dependency check (ld barfs the error
message to stdout instead of the log file?)
checking whether cc accepts -M for generating dependencies... ld:
0711-317 ERROR
: Undefined symbol: .main
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
no

Note 2 that configure leaves a file called "-fp-no-toc" behind.  Oops.

6) make && make check and everything looks ok.


--> Compile with gcc:

1) 2) 3) 4) like above

Additionally edit *sock.c:

5b) In appl/Rsock.c and appl/sock.c added `#include "Rconfig.h"'
(This doesn't hurt the cc compilation.)

6b) CC=gcc ../configure

Surprises:  this finds libcurses and libz.  I don't know where,
though.  So I manually remove -lreadline -lz -lcurses from the LIBS
line in Makeconf.  Note that I add my private readline with the help
of CPPFLAGS and LIBS in config.site (thanks, Kurt).

7b) edit Rconfig.h:
#ifdef __GNUC__
typedef long blkcnt_t;
#endif

Yes, I NEED this for gcc 2.8.1.  This is a gcc bug, because
gcc -I/usr/include will compile.  What I've learned is that it is
essential to verify which include files the compiler finds, these are
not always the ones in /usr/include!  Maybe configure can pick this up?

This gets you to a point where things will compile.  What remains is
the NaN and Inf problem.  I've tried to disable the finite function by
overriding the configure result (a la finite=no).  But then R core
dumps.  And uh, those ugly tick marks...

I'm afraid this all doesn't make too much sense, it's a mess.

Lemme know, if there is something you want me to try.  
-tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 20 07:22:12 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 20 Jul 1999 07:22:12 +0100 (BST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.10.9907201215490.18298-100000@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats>

On Tue, 20 Jul 1999, Ross Ihaka wrote:

> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
> 
> > >     3.	On the definition question: The existing FFT implementation
> > > 	uses a particular definition for the discrete transform which
> > > 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> > > 	"Time Series" etc.) Using another definition may complicate
> > > 	documentation.
> > 
> > That's the simple part.  But what is the divisor in the periodogram? Which
> > way do lags go in acfs of bivariate series, and which sign is the phase for
> > bivariate spectra?
> 
> Once you settle the forward discrete transform much of this is settled.

Isn't that the tail wagging the dog?

> No constant in the dft implies
> 	Periodogram = |dft|^2/(2*pi*T)

Why is the 2*pi there? It is in Bloomfield, but not Brockwell & Davis, for
example. And S-PLUS divides by the fequency to make the periodogram
estimate the spectral density.

> Phases in spectra also fall out if you take a +ve exponent in the dft.
>
But you have to decide which of series i and j gets the complex conjugate.
(Same issue with acfs: second relative to first or first relative to
second?  It's like defining `lags'.)

> I don't much mind about these choices, but its probably a good idea to
> be consistent.

Consistent with whom?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 20 07:37:27 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 20 Jul 1999 07:37:27 +0100 (BST)
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: <199907200204.WAA13374@infiniti.ece.cmu.edu>
Message-ID: <Pine.GSO.4.05.9907200725490.5672-100000@auk.stats>

On Mon, 19 Jul 1999, Thomas Vogels wrote:

> 
> Hi,
> 
>   this relates to R-devel of 1999/July/18.  I will outline what I had
> to change to get R to compile with cc then with gcc.  Note that R
> compiled with cc works, R compiled with gcc is broken.

> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
> (yes, won't compile without)

There is no longer a line 752, but this was added (by Kurt) in the current
sources (line 317). When I saw this I checked my books and all my lint-like
tools: the code I wrote does seem valid C according to all my checks.

Would just ";" satisfy your compiler?


> --> Compile with gcc:
> 
> 1) 2) 3) 4) like above

Will gcc really not accept 3) on your platform?  It does on all of mine,
in all the versions of gcc I tried. It would be a surprise for gcc's
parser to be platform-specific.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 09:50:18 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 08:50:18 +0000
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37943849.ACC16974@wu-wien.ac.at>

Prof Brian D Ripley wrote:

> Suggestions:
> ===========
>
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:

I agree with almost everything.

>
>
> the ts class and methods (maybe in due course these should be removed
> from the base package?)
>
> datasets from MASS, tseries
>
> lag, deltat, cycle
> filter
>
> acf from bats, augmented by ideas from tseries.
>
> spectrum, spec.pgram from bats  (after looking at tseries hard)

Concerning the normalization, definition of fft and so on, I just want to say how
it is done in tseries:

Periodogram: Normalizing by (2*pi*n) where n is the length of the original series,
i.e. it differs from Brockwell&Davies by the factor 2*pi. Furthermore, normalizing
by n (and not npad) preserves the shape and not the sum under/over the
periodogram. I also remove the mean before starting the main computation which
makes the correction (10.4.7) from B&D unnecessary(?).


>
> spec.taper
> cpgram from MASS
>
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

What about simple OLS estimator ar.ols?

>
>
> That leaves
>
> stl -- I believe the code for this is on netlib.
>
> arima modelling.  I do have Fortran code for this, and will work on
>   a simple R interface for it.  An elegant interface can come later.
>
>
> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.

I will wait until this first version is finished and then update the tseries
library to fit with the R ts.base library so we can use, e.g., the tests etc. What
about the name tseries. Should I change this name, so that it does not conflict
with the time series base?

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 09:57:45 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 08:57:45 +0000
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37943A08.F073CC2C@wu-wien.ac.at>

Prof Brian D Ripley wrote:

> Time Series functions in R
> ==========================
>
> I think a good basic S-like functionality for library(ts) in base R
> would include
>
> ts class, tsp, is.ts, as.ts
> plot methods
> start end window frequency cycle deltat
> lag diff aggregate
> filter
>

I forgot to suggest to add the "embed" routine from tseries to the above list? I
think it's a base routine. It works also for multivariate series and is useful for
many higher level routines.

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 10:17:51 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 11:17:51 +0200 (CEST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <XFMail.990720111751.plummer@iarc.fr>

On 19-Jul-99 Prof Brian D Ripley wrote:
> Time Series functions in R
> ==========================
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:
> 
> the ts class and methods (maybe in due course these should be removed
> from the base package?)

Some of the ts class stuff is implemented in the C code of the base
library. I'm not sure you can separate this.

I also suggested an "na.omit" method for time series - which would be
used by many of the time series functions. Martin has made na.omit()
and na.fail() generic so this is possible now.

> datasets from MASS, tseries
> 
> lag, deltat, cycle
> filter

I think there is some functional overlap between filter() and convolve(),
which now has a type="filter" option. I'm not sure convolve() needs this
if there is a filter() function.

> acf from bats, augmented by ideas from tseries.

I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
after seeing its rather embarrassing performance.

> spectrum, spec.pgram from bats  (after looking at tseries hard)

Adrian's spectrum() function allows a wider range of kernel smoothers
and it would be nice to keep this.  Since spectrum() is just a wrapper
function anyway, it should be possible to do this, while keeping the
S-PLUS compatible interface.

> spec.taper
> cpgram from MASS
> 
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

I haven't tried very hard to make my code efficient, as you can see,
concentrating instead on getting something that works like the S-PLUS
version. Much of the work involved trying to get the same answer as
S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
was doing wrong (see the COMPAT file).

I think the multivariate version would be harder to implement in C.
I will see if I can speed the R code up.

I have been looking at Burg's algorithm and I think I can implement
this now, if you want.

> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.
> 
> How does that sound as a plan?

Sounds good.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 10:22:49 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 11:22:49 +0200 (CEST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <XFMail.990720112249.plummer@iarc.fr>

On 19-Jul-99 Prof Brian D Ripley wrote:
> Time Series functions in R
> ==========================
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:
> 
> the ts class and methods (maybe in due course these should be removed
> from the base package?)

Some of the ts class stuff is implemented in the C code of the base
library. I'm not sure you can separate this.

I also suggested an "na.omit" method for time series, which would be
used by many of the time series functions. Martin has made na.omit()
and na.fail() generic so this is possible now.

> datasets from MASS, tseries
> 
> lag, deltat, cycle
> filter

I think there is some functional overlap between filter() and convolve(),
which now has a type="filter" option. I'm not sure convolve() needs this
if there is a filter() function.

> acf from bats, augmented by ideas from tseries.

I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
after seeing its rather embarrassing performance.

> spectrum, spec.pgram from bats  (after looking at tseries hard)

Adrian's spectrum() function allows a wider range of kernel smoothers
and it would be nice to keep this.  Since spectrum() is just a wrapper
function anyway, it should be possible to do this, while keeping the
S-PLUS compatible interface.

> spec.taper
> cpgram from MASS
> 
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

I haven't tried very hard to make my code efficient, as you can see,
concentrating instead on getting something that works like the S-PLUS
version. Much of the work involved trying to get the same answer as
S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
was doing wrong (see the COMPAT file).

I think the multivariate version would be harder to implement in C.
I will see if I can speed the R code up.

I have been looking at Burg's algorithm and I think I can implement
this now, if you want.

> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.
> 
> How does that sound as a plan?

Sounds good.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 20 10:32:37 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 20 Jul 1999 11:32:37 +0200
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats> (message from
 Prof Brian D Ripley on Tue, 20 Jul 1999 07:22:12 +0100 (BST))
References: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats>
Message-ID: <199907200932.LAA25315@sophie.ethz.ch>


    BDR> On Tue, 20 Jul 1999, Ross Ihaka wrote:
    >> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
    >> 
    >> > > 3. On the definition question: The existing FFT implementation >
    >> > uses a particular definition for the discrete transform which > >
    >> is pretty standard.  (Edwards "Fourier Series", Brillinger > > "Time
    >> Series" etc.) Using another definition may complicate > >
    >> documentation.
    >> > 
    >> > That's the simple part.  But what is the divisor in the
    >> periodogram? Which > way do lags go in acfs of bivariate series, and
    >> which sign is the phase for > bivariate spectra?
    >> 
    >> Once you settle the forward discrete transform much of this is
    >> settled.

    BDR> Isn't that the tail wagging the dog?

I think Ross meant to say that  fft()'s definition can't (shouldn't) be changed
anymore, and I agree on that [and that *is* S compatible anyway].

    >> No constant in the dft implies Periodogram = |dft|^2/(2*pi*T)

    BDR> Why is the 2*pi there? It is in Bloomfield, but not Brockwell &
    BDR> Davis, for example. And S-PLUS divides by the fequency to make the
    BDR> periodogram estimate the spectral density.

We have to decide if we go for S-plus compatibility here, see below.

    >> Phases in spectra also fall out if you take a +ve exponent in the
    >> dft.
    >> 
    BDR> But you have to decide which of series i and j gets the complex
    BDR> conjugate.  (Same issue with acfs: second relative to first or
    BDR> first relative to second?  It's like defining `lags'.)

    >> I don't much mind about these choices, but its probably a good idea
    >> to be consistent.

    BDR> Consistent with whom?

Mostly "with your own notation and definitions",
maybe even ``consistent with one book's author''.

I'd prefer Brockwell & Davis,
however I agree with Brian that S compatibility -- to some extent -- is a
goal here; on the other hand, S-plus uses definitions that are not widely
used in standard texts (my limited experience).

This really must must be settled now.
If nobody can show why S-plus definitions are `wrong by design' here,
I'd vote for adopting them, inspite of all...
[if only to keep V&R's chapter on time-series coherent :-)]

Something which should be discussed however is spectrum(0);
Several of us think that S-plus does the wrong thing, at least in some
cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
Another possibility would be to leave it NA
and maybe provide methods for estimating it specifically, if desired.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 20 10:50:01 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 20 Jul 1999 11:50:01 +0200
Subject: 0.65/AIX
In-Reply-To: Thomas Vogels's message of "Mon, 19 Jul 1999 21:23:09 -0400"
References: <199907200123.VAA23498@infiniti.ece.cmu.edu>
Message-ID: <x2r9m3fy5y.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:

> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> Peter> Something pretty close to the following should work:
> Peter> 
> Peter> #define R_FINITE(x) ({double y = x; \
> Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
> Peter> 
> Peter> #define ISNAN(x) ({double y = x; \
> Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
> Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}
> 
> Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
> see your point for the local var, but cc and gcc choke on it.

I take it that you fixed the missing ')' in ISNAN? Too bad. Perhaps it
can work without the local "y"? I put it in just to catch cases where
x might be in a register so that you cannot take its address.

> I've looked into /usr/include/fp.h which is included for AIX
> platforms.  (Its version is 1.9)  There are defines for FINITE,
> IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?

That would make very good sense. The code would probably have to go in
an "#if aix" type clause, but so would my suggestion.

> Does it make sense for configure to check, not only whether finite
> exists but also whether it's broken?

It certainly would.
 
> BTW, if you step thru EncodeReal you see that !R_FINITE(x) if false
> for 1/0 (i.e. 1/0 is not detected as not finite).

Yes. If you look at R_FINITE, you'll see that the logic is
essentially: If HAVE_FINITE use finite() else assume non-IEEE and only
check for the internal NA code. So if either finite() misbehaves or
doesn't exist, that will happen.

> Here is first the C code to show what's working what's not.  (I picked
> your stuff and added the calls to the macros.)  This is followed by
> the output when compiled with cc and gcc.  I'm having major headaches
> here with the -D_XOPEN_SOURCE_EXTENDED (details follow).  Maybe we can
> dump finite in favor of FINITE?
> 
> Are  my assumptions about the return values are correct?

They look fine. Would seem that only gcc without the -D_XOPENetc is
having trouble with finite() -- why? could that be a gcc bug?

What happens with isnan(), is that as buggy as finite()?

It looks quite feasible simply to put

#ifdef _AIX
	#define R_FINITE(x) FINITE(X)
	#define R_ISNAN(x)  IS_NAN(X)
#endif

or something like it in Arith.h
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Jul 20 12:10:06 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 20 Jul 1999 12:10:06 +0100 (BST)
Subject: time series in R
Message-ID: <199907201110.MAA04887@toucan.stats.ox.ac.uk>

> Date: Tue, 20 Jul 1999 11:17:51 +0200 (CEST)
> From: Martyn Plummer <plummer@iarc.fr>
> To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
> Subject: RE: time series in R
> 
> On 19-Jul-99 Prof Brian D Ripley wrote:

> > Time Series functions in R
> > ==========================
> > If Martyn and Adrian are agreeable, I will start a library(ts) in the
> > 0.65 version. I will put in this:
> > 
> > the ts class and methods (maybe in due course these should be removed
> > from the base package?)
> 
> Some of the ts class stuff is implemented in the C code of the base
> library. I'm not sure you can separate this.

Rather, in the C core of R (the base package has no C code).  I was not
intended to separate that. My aim was merely to allow some code to be
re-written without losing backwards compatibility, yet. For example,
print.ts does not do well with multiple series (and it breaks the 
cardinal rule of a print method returning its first argument unchanged).

> I also suggested an "na.omit" method for time series - which would be
> used by many of the time series functions. Martin has made na.omit()
> and na.fail() generic so this is possible now.

Good. What do you want na.omit.ts to do? 

> > filter
> 
> I think there is some functional overlap between filter() and convolve(),
> which now has a type="filter" option. I'm not sure convolve() needs this
> if there is a filter() function.

I'll take a look.

> 
> > acf from bats, augmented by ideas from tseries.
> 
> I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
> after seeing its rather embarrassing performance.

I have that. However, I am having a number of problems with it,
for example that pacf does not work, and acf does not work correctly
for multiple series.

> library(bats)
> data(presidents)
> acf(presidents, type="partial")
Error: Object "xb" not found

OK, fix that:
> acf(presidents, type="partial")
Error: NA/NaN/Inf in foreign function call (arg 1)

[The NA handling needs to be sorted out.]

A little later:

            var0 <- diag(acf[1, , ], nrow = nser)

is wrong: it gives a matrix and multivariate acfs fail. I used

            var0 <- if(nser > 1) diag(acf[1, , ]) else acf[1,1,1]

I think I will special-case the univariate code here.


> > spectrum, spec.pgram from bats  (after looking at tseries hard)
> 
> Adrian's spectrum() function allows a wider range of kernel smoothers
> and it would be nice to keep this.  Since spectrum() is just a wrapper
> function anyway, it should be possible to do this, while keeping the
> S-PLUS compatible interface.

Yes, I intend to look at that. For now, though, your code is not
giving the same results as S-PLUS, and I need to fix up at least the
confidence interval calculations.  (I think I know exactly how it
is done in S-PLUS: it uses Bloomfield's code.)  I believe that padding
needs to be optional.

> > ar.yw from bats  (although that probably needs to be moved to
> > C/Fortran, and I may special-case the univariate case to use code I
> > have for that).
> 
> I haven't tried very hard to make my code efficient, as you can see,
> concentrating instead on getting something that works like the S-PLUS
> version. Much of the work involved trying to get the same answer as
> S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
> was doing wrong (see the COMPAT file).
> 
> I think the multivariate version would be harder to implement in C.

I agree, but maybe it should be done.

> I will see if I can speed the R code up.
> 
> I have been looking at Burg's algorithm and I think I can implement
> this now, if you want.

Yes, please (even though I think it is in principle a bad idea).

> > As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> > ought to concentrate on getting the basic stuff (bats-like) in first.

Looking at where I am, that looks feasible

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 13:53:28 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 12:53:28 +0000
Subject: time series in R
Message-ID: <37947148.EB23277B@wu-wien.ac.at>

Martin Maechler wrote:

>
> Something which should be discussed however is spectrum(0);
> Several of us think that S-plus does the wrong thing, at least in some

> cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
> and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
> Another possibility would be to leave it NA
> and maybe provide methods for estimating it specifically, if desired.
>

I had a look at some of our Dep. books:

Brockwell&Davis: Periodogram normalization is n^{-1}, P(0)=0 for
demean=T.
spectrum(0) should be estimated by not using P(0) (Remark 2, p. 353). In
general
S(0) \neq 0.

Shiryaev, Probability: Per. norm. is (2*pi*n)^{-1}, P(0)=0 for demean=T.

Priestley, Spectral Analysis... : Periodogram normalization is
(n/2)^{-1}, P(0)=0
for demean=T, p. 395. For continuous spectra he defines a "modified
Periodogram",pp. 416, 417, where the normalization is as in Shiryaev.
All the
spectrum estimation is done with the mod. Period.

Hannan, Multiple Time Series: Normalization is (n/2)^{-1}.

Koopmans: Spectral Analysis of TS: Norm. is (2*pi*n)^{-1}.

It seems that (2*pi*n)^{-1} is the version which is mostly used, since
it makes no
further normalization necessary, e.g., for smoothing the periodogram.
P(0)=0 is
obvious. And \hat{spectrum}(0) = 0 is definitely a very bad estimator.

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 14:38:34 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 15:38:34 +0200 (CEST)
Subject: time series in R
In-Reply-To: <199907201110.MAA04887@toucan.stats.ox.ac.uk>
Message-ID: <XFMail.990720153834.plummer@iarc.fr>

On 20-Jul-99 Prof Brian Ripley wrote:
> 
>> I also suggested an "na.omit" method for time series - which would be
>> used by many of the time series functions. Martin has made na.omit()
>> and na.fail() generic so this is possible now.
> 
> Good. What do you want na.omit.ts to do? 

It would either
1) remove missing values only from the beginning or end of a time
   series, or
2) return the longest contiguous subseries with no missing values,
   e.g. presidents[32:110], or the first such subseries if there
   were multiple matches.
A lot of S-plus time series functions use option 1). Option 2) seems
more useful to me. There is no "na.omit.ts" in Splus 3.3 but  it
seems like a good way to implement this functionality.

>> I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
>> after seeing its rather embarrassing performance.
> 
> I have that. However, I am having a number of problems with it,
> for example that pacf does not work, and acf does not work correctly
> for multiple series.
> 
>> library(bats)
>> data(presidents)
>> acf(presidents, type="partial")
> Error: Object "xb" not found
> 
> OK, fix that:
>> acf(presidents, type="partial")
> Error: NA/NaN/Inf in foreign function call (arg 1)
> 
> [The NA handling needs to be sorted out.]

See above.

> A little later:
> 
>             var0 <- diag(acf[1, , ], nrow = nser)
> 
> is wrong: it gives a matrix and multivariate acfs fail. I used

This works for me!

> 
>             var0 <- if(nser > 1) diag(acf[1, , ]) else acf[1,1,1]
> 
> I think I will special-case the univariate code here.
> 
> 
>> > spectrum, spec.pgram from bats  (after looking at tseries hard)
>> 
>> Adrian's spectrum() function allows a wider range of kernel smoothers
>> and it would be nice to keep this.  Since spectrum() is just a wrapper
>> function anyway, it should be possible to do this, while keeping the
>> S-PLUS compatible interface.
> 
> Yes, I intend to look at that. For now, though, your code is not
> giving the same results as S-PLUS, and I need to fix up at least the
> confidence interval calculations.  (I think I know exactly how it
> is done in S-PLUS: it uses Bloomfield's code.)  

The main reason my confidence intervals are different is that I don't
have the correct expression for the degrees of freedom in the presence
of tapering (or padding, but that is trivial). Apart from that,
I deliberately chose different limits because I allow the user to
specify the coverage of the confidence interval in plot.spec, and if
one is allowed to do that, one needs to make sure that the confidence
interval contains the estimate, which would not always be the case with
the Splus behaviour.

> I believe that padding
> needs to be optional.

There seems to be two sorts of padding going on in Splus. One under
the control of the user, via the "pad" argument and the other
which is automatic, to aid the Fast Fourier Transform. I have
tried to reproduce this, but can't exactly match the Splus behaviour.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Tue Jul 20 15:26:35 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Tue, 20 Jul 1999 15:26:35 +0100 (BST)
Subject: tensor() function and sets
Message-ID: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>

Hi Everyone,

To complete the outer() and kronecker() functions in the base, may I
suggest the following tensor() function, which allows the multiplication
of arrays through sets of conformable dimensions.  I am happy to write a
help page if required. 

The code also needs a setdiff() function which prompts me to ask: what
about simple set functions?  I expect many of us have written our own
(Brian has a setdiff() in drop1.lm(), for example), which seems like a
good reason for putting versions in the base.  I would be happy to provide
mine for general scrutiny.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"setdiff" <-
function (x, y) x[!(x %in% y)]

"tensor" <-
function (A, B, da, db) 
{
    # tensor product of A and B through da and db
    no.na <- is.null(na <- dimnames(A <- as.array(A)))
    dima <- dim(A)
    no.nb <- is.null(nb <- dimnames(B <- as.array(B)))
    dimb <- dim(B)
    if (any(dima[da] != dimb[db])) 
        stop("Mismatched dimensions")
    kpa <- setdiff(seq(along = dima), da)
    kpb <- setdiff(seq(along = dimb), db)
    # fix up the dimnames (see outer)
    if (no.na && no.nb) 
        nms <- NULL
    else {
        if (no.na) 
            na <- vector("list", length(dima))
        else if (no.nb) 
            nb <- vector("list", length(dimb))
        nms <- c(na[kpa], nb[kpb])
    }
    A <- matrix(aperm(A, c(kpa, da)), ncol = prod(dima[da]))
    B <- matrix(aperm(B, c(db, kpb)), nrow = prod(dimb[db]))
    array(A %*% B, c(dima[kpa], dimb[kpb]), dimnames = nms)
}

# examples

A <- array(1:6, 2:3, list(LETTERS[1:2], LETTERS[3:5]))
B <- 1:3
tensor(A, B, 2, 1)			# same as drop(A %*% B)
A <- outer(A, B)			# A now 2 by 3 by 3
tensor(A, B, 2, 1); tensor(A, B, 3, 1)	# both 2 by 3 (nb dimnames)
B <- outer(1:2, B)			# B now 2 by 3
tensor(A, B, c(1, 3), 1:2)		# must be 3 vector
B <- outer(1:3, B)			# B now 3 by 2 by 3 
tensor(A, B, 1:3, c(2, 1, 3))		# must be a scalar
sum(A * aperm(B, c(2, 1, 3)))		# same scalar value


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 20:10:31 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 20 Jul 1999 15:10:31 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "20 Jul 1999 11:50:01 EDT."
 <x2r9m3fy5y.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907201910.PAA13352@infiniti.ece.cmu.edu>


(Note that I took the liberty of resequencing Peter's email.)

"Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

>> I've looked into /usr/include/fp.h which is included for AIX
>> platforms.  (Its version is 1.9)  There are defines for FINITE,
>> IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?

Peter> That would make very good sense. The code would probably have to go in
Peter> an "#if aix" type clause, but so would my suggestion.

Peter> It looks quite feasible simply to put
Peter> 
Peter> #ifdef _AIX
Peter> #define R_FINITE(x) FINITE(X)
Peter> #define R_ISNAN(x)  IS_NAN(X)
Peter> #endif
Peter> 
Peter> or something like it in Arith.h
 
With these changes, R crashes when compiled with gcc.  I may have
gotten something wrong with the ifdefs, however.  Shouldn't it be
possible to compile with HAVE_FINITE and HAVE_ISNAN undefined?

Peter> Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:
>> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
>> 
Peter> Something pretty close to the following should work:
Peter> 
Peter> #define R_FINITE(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
Peter> 
Peter> #define ISNAN(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}
>> 
>> Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
>> see your point for the local var, but cc and gcc choke on it.

Peter> I take it that you fixed the missing ')' in ISNAN? Too bad. Perhaps it
Peter> can work without the local "y"? I put it in just to catch cases where
Peter> x might be in a register so that you cannot take its address.

It's actually a missing semicolon before the closing brace.  Fixing it
makes it compile with gcc not cc.  (And I currently have to use cc to
get a working R.)

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 20:32:48 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 20 Jul 1999 15:32:48 -0400
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: Your message of "Tue, 20 Jul 1999 07:37:27 EDT."
 <Pine.GSO.4.05.9907200725490.5672-100000@auk.stats>
Message-ID: <199907201932.PAA13390@infiniti.ece.cmu.edu>



"Brian" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

>> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
>> (yes, won't compile without)

Brian> There is no longer a line 752, but this was added (by Kurt) in the current
Brian> sources (line 317). When I saw this I checked my books and all my lint-like
Brian> tools: the code I wrote does seem valid C according to all my checks.

Brian> Would just ";" satisfy your compiler?

Yes, I guess you can't have no statement after a case label, so either
"break;" or ";" is fine.  (K&R suggest always having a break after (at
least) the last label as a defensive porgramming strategy.)

--> Compile with gcc:
>> 
>> 1) 2) 3) 4) like above

Brian> Will gcc really not accept 3) on your platform?  It does on all of mine,
Brian> in all the versions of gcc I tried. It would be a surprise for gcc's
Brian> parser to be platform-specific.

Sorry, probably should have said: 3) doesn't hurt gcc.

 -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 21 11:19:35 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 21 Jul 1999 12:19:35 +0200
Subject: R-0.64.2 on AIX
In-Reply-To: <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>
References: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>
 <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>
Message-ID: <199907211019.MAA00723@aragorn.ci.tuwien.ac.at>

>>>>> Nicolas Brouard writes:

> I am new on your list...

> S language source code again available and in the Public Domain was a
> great hope for me.

> I remember that parts of S code was written in Ratfor. Now there are
> still Fortran routines. Would they stay as is? I have nothing against
> Fortran but it adds another compiler which is not as available as C
> and which exists on too various forms (g77, f2c at least). For example
> my g77 (2.7) compiler on AIX 4.1 did not know what a "save" was.

That's a long story, and I should maybe add something on this to my FAQ
eventually.  In a nutshell, the point was that whereas we could use f2c
for creating a C-only version and provide the necessary run-time version
of libf2c along with the base R distribution, the problem is that MANY
add-on packages, in particular the ones that can be ported from statlib
S versions, but also others, come with Fortran sources.  So eventually,
you either need a full-featured Fortran compiler or all of f2c.

And this is what we have now.

> ...

> I am not sure to have the time necessary to compile 0.65 and to be
> "with you" but at least I will look at your mailing list and give you
> information on AIX if I can.

That would be great.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 21 11:19:36 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 21 Jul 1999 12:19:36 +0200
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: <199907200204.WAA13374@infiniti.ece.cmu.edu>
References: <199907200204.WAA13374@infiniti.ece.cmu.edu>
Message-ID: <199907211019.MAA00733@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> Hi,

>   this relates to R-devel of 1999/July/18.  I will outline what I had
> to change to get R to compile with cc then with gcc.  Note that R
> compiled with cc works, R compiled with gcc is broken.

> --> Compile with cc:

> 1) Edit src/main/saveload.c: disable the undefine! With the #undef
> _XOPEN_SOURCE_EXTENDED the compilation dies an untimely death.
> (And the header files are not as badly broken for cc!)

> 2) Edit src/appl/sock.c: dto.

Done.

> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
> (yes, won't compile without)

Already taken care of

> 4) Edit src/main/builtin.c: line 318 should read "#endif /* NOT_used */"
>  (get rids of the warning)

???

> 5) CC=cc ../configure

> Note this is broken for the dependency check (ld barfs the error
> message to stdout instead of the log file?)
> checking whether cc accepts -M for generating dependencies... ld:
> 0711-317 ERROR
> : Undefined symbol: .main
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> no

Fixed, hopefully.

> Note 2 that configure leaves a file called "-fp-no-toc" behind.  Oops.

???

> 6) make && make check and everything looks ok.


> --> Compile with gcc:

> 1) 2) 3) 4) like above

> Additionally edit *sock.c:

> 5b) In appl/Rsock.c and appl/sock.c added `#include "Rconfig.h"'
> (This doesn't hurt the cc compilation.)

> 6b) CC=gcc ../configure

> Surprises:  this finds libcurses and libz.  I don't know where,
> though.  So I manually remove -lreadline -lz -lcurses from the LIBS
> line in Makeconf.  Note that I add my private readline with the help
> of CPPFLAGS and LIBS in config.site (thanks, Kurt).

:-)

> 7b) edit Rconfig.h:
> #ifdef __GNUC__
> typedef long blkcnt_t;
> #endif

> Yes, I NEED this for gcc 2.8.1.  This is a gcc bug, because gcc
> -I/usr/include will compile.  What I've learned is that it is
> essential to verify which include files the compiler finds, these are
> not always the ones in /usr/include!  Maybe configure can pick this
> up?

It does now.

> This gets you to a point where things will compile.  What remains is
> the NaN and Inf problem.  I've tried to disable the finite function by
> overriding the configure result (a la finite=no).  But then R core
> dumps.  And uh, those ugly tick marks...

> I'm afraid this all doesn't make too much sense, it's a mess.

> Lemme know, if there is something you want me to try.  

Work in progress ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 21 17:44:18 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 21 Jul 1999 18:44:18 +0200
Subject: tensor() function and sets
In-Reply-To: <Pine.GSO.3.96.990720143125.9359C-100000@laplace> (message from
 Jonathan Rougier on Tue, 20 Jul 1999 15:26:35 +0100 (BST))
References: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>
Message-ID: <199907211644.SAA01631@sophie.ethz.ch>

>>>>> On Tue, 20 Jul 1999 15:26:35 +0100 (BST), Jonathan Rougier <J.C.Rougier@durham.ac.uk> said:


    JonR> Hi Everyone,

    JonR> To complete the outer() and kronecker() functions in the base, may I
    JonR> suggest the following tensor() function, which allows the multiplication
    JonR> of arrays through sets of conformable dimensions.  I am happy to write a
    JonR> help page if required. 


    JonR> The code also needs a setdiff() function which prompts me to ask:
    JonR> what about simple set functions?  I expect many of us have written our own
    JonR> (Brian has a setdiff() in drop1.lm(), for example), which seems like a
    JonR> good reason for putting versions in the base.  I would be happy to provide
    JonR> mine for general scrutiny.

Actually your version of "setdiff" is in  
example("%in%")

    "%w/o%" <- function(x,y) x[!x %in% y] #--  x without y

Maybe we should make this part of core R, since it allows the nicer syntax
 (1:10) %w/o% c(3,7,12).

One problem with all these might be that you forget to think about efficiency 
{ %w/o% -> %in% -> match(.) }
but that might be ok.

    union
and
    intersect
are two other set functions, the first of which is also contained in
example(match) { == example("%in%") }:
    intersect <- function(x, y) y[match(x, y, nomatch = 0)]

What do others think?  Should (some of) these be put into "core R" ?


    JonR> Jonathan Rougier                       Science Laboratories
    JonR> Department of Mathematical Sciences    South Road
    JonR> University of Durham                   Durham DH1 3LE

    JonR> "setdiff" <-
    JonR> function (x, y) x[!(x %in% y)]

    JonR> "tensor" <-
    JonR> function (A, B, da, db) 
    JonR> {
    JonR> # tensor product of A and B through da and db
    JonR> no.na <- is.null(na <- dimnames(A <- as.array(A)))
    JonR> dima <- dim(A)
    JonR> no.nb <- is.null(nb <- dimnames(B <- as.array(B)))
    JonR> dimb <- dim(B)
    JonR> if (any(dima[da] != dimb[db])) 
    JonR> stop("Mismatched dimensions")
    JonR> kpa <- setdiff(seq(along = dima), da)
    JonR> kpb <- setdiff(seq(along = dimb), db)
    JonR> # fix up the dimnames (see outer)
    JonR> if (no.na && no.nb) 
    JonR> nms <- NULL
    JonR> else {
    JonR> if (no.na) 
    JonR> na <- vector("list", length(dima))
    JonR> else if (no.nb) 
    JonR> nb <- vector("list", length(dimb))
    JonR> nms <- c(na[kpa], nb[kpb])
    JonR> }
    JonR> A <- matrix(aperm(A, c(kpa, da)), ncol = prod(dima[da]))
    JonR> B <- matrix(aperm(B, c(db, kpb)), nrow = prod(dimb[db]))
    JonR> array(A %*% B, c(dima[kpa], dimb[kpb]), dimnames = nms)
    JonR> }

    JonR> # examples

    JonR> A <- array(1:6, 2:3, list(LETTERS[1:2], LETTERS[3:5]))
    JonR> B <- 1:3
    JonR> tensor(A, B, 2, 1)			# same as drop(A %*% B)
    JonR> A <- outer(A, B)			# A now 2 by 3 by 3
    JonR> tensor(A, B, 2, 1); tensor(A, B, 3, 1)	# both 2 by 3 (nb dimnames)
    JonR> B <- outer(1:2, B)			# B now 2 by 3
    JonR> tensor(A, B, c(1, 3), 1:2)		# must be 3 vector
    JonR> B <- outer(1:3, B)			# B now 3 by 2 by 3 
    JonR> tensor(A, B, 1:3, c(2, 1, 3))		# must be a scalar
    JonR> sum(A * aperm(B, c(2, 1, 3)))		# same scalar value

Looks interesting, however is it really useful
{for doing statistics, graphics, numerical computing, I mean} ?

Yes, if you'd provide a *.Rd help file  (use  ``prompt(tensor)''),
we'd be even more inclined to include the tensor function....
Also, I'd like to see a "real" use for it.

Is
	tensor(A, B, 1:3, c(2, 1, 3))
really easier than
        sum(A * aperm(B, c(2, 1, 3)))		

[probably yes, you have to think less, but still:
 couldn't  "da" and "db" (3rd and 4th arg) get reasonable default values ?]

----
Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 21 17:54:13 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 21 Jul 1999 18:54:13 +0200
Subject: tensor() function and sets
In-Reply-To: <199907211644.SAA01631@sophie.ethz.ch> (message from Martin
 Maechler on Wed, 21 Jul 1999 18:44:18 +0200)
References: <Pine.GSO.3.96.990720143125.9359C-100000@laplace> <199907211644.SAA01631@sophie.ethz.ch>
Message-ID: <199907211654.SAA01640@sophie.ethz.ch>

Excuse me Jonathan,
after looking a bit longer at your examples and some thinking,
I'm now quite convinced that  your tensor() function *IS* useful for us
and comes quite handy in several cases.
{real S/R hackers doing all this in their sleep, but most of us
 are not "real S/R hackers" in this sense ...}

I think it still would be nice to have reasonable default arguments da & db.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Wed Jul 21 18:34:36 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Wed, 21 Jul 1999 18:34:36 +0100 (BST)
Subject: tensor() function and sets
In-Reply-To: <199907211654.SAA01640@sophie.ethz.ch>
Message-ID: <Pine.GSO.3.96.990721181220.10355C-100000@laplace>

Hi Martin,

> after looking a bit longer at your examples and some thinking,
> I'm now quite convinced that  your tensor() function *IS* useful for us
> and comes quite handy in several cases.
> {real S/R hackers doing all this in their sleep, but most of us
>  are not "real S/R hackers" in this sense ...}

Well, I wrote it because I have to use it all the time!  A lot of the work
of our group at Durham involves means and variances of arrays rather than
vectors. I spent some time unzipping all the arrays into vectors and then
using matrix operations (hence I wrote the kronecker() function), before I
realised that the natural thing to do was to work in tensors and think of
variances as following from the expectations of outer products. 

> I think it still would be nice to have reasonable default arguments da & db.

I did consider this, but bitter experience has taught me to be
conservative and always specify explicitly the extents through which the
outer product collapses.  I think it is important to know and state
exactly what is required in these operations.  Furthermore, as I look
through the calculations I have done recently, no obvious pattern that
might be a reasonable default emerges.  However, I am open suggestions! 
In the meantime, I'll write a help page for the function as it stands
tomorrow morning and send it on to you. 

Regarding sets, might I suggest that if included in the base then
intersect() might be generalised to arbitrary numbers of arguments.  You
will probably howl with anguish at the recursion, but I use

"intersect" <-
function(x, ...)
    if (nargs() == 1) x else x[x %in% Recall(...)]

which seems to be effective.  

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Thu Jul 22 00:59:00 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Thu, 22 Jul 1999 01:59:00 +0200 (MET DST)
Subject: reluctant to read win95 directory (PR#231)
Message-ID: <199907212359.BAA14750@pubhealth.ku.dk>



Using rw0642 under win95, on executing from a directory on the c: drive:

   system("command.com /c dir", intern=T)

there is a whirring from drive a: (empty), then the message appears in a 
dos box:

   General failure reading device aLP!!?
   Abort, Retry, Fail?

Repeating the command a few times finally results in success with no 
whirring, after which there are no failures (even after restarting R) 
until the computer is rebooted. 

The computer is on a TCP/IP network with slow automounting, though the c:
drive is of course local.  It is set to try booting first from drive a:.

Could this be a timeout problem which could be fixed either in R or with
some setting in win95?

Thanks for R

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul 22 01:29:57 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 22 Jul 1999 02:29:57 +0200
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: John.Peters@tip.csiro.au's message of "Thu, 22 Jul 1999 01:59:00 +0200 (MET DST)"
References: <199907212359.BAA14750@pubhealth.ku.dk>
Message-ID: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk>

John.Peters@tip.csiro.au writes:

> Using rw0642 under win95, on executing from a directory on the c: drive:
> 
>    system("command.com /c dir", intern=T)
> 
> there is a whirring from drive a: (empty), then the message appears in a 
> dos box:
> 
>    General failure reading device aLP!!?
>    Abort, Retry, Fail?

Not that I know anything about Windows, but is there a chance that the
machine goes looking for command.com on the diskette? I.e. you want
c:\\windows\\command.com instead.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Thu Jul 22 06:17:43 1999
From: John.Peters@tip.csiro.au (John Peters)
Date: Thu, 22 Jul 1999 15:17:43 +1000 (EST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk> from Peter Dalgaard BSA at "Jul 22, 99 02:29:57 am"
Message-ID: <199907220517.PAA06830@dylan.tip.CSIRO.AU>

Peter Dalgaard BSA writes:

> John.Peters@tip.csiro.au writes:
> 
> > Using rw0642 under win95, on executing from a directory on the c: drive:
> > 
> >    system("command.com /c dir", intern=T)
> > 
> > there is a whirring from drive a: (empty), then the message appears in a 
> > dos box:
> > 
> >    General failure reading device aLP!!?
> >    Abort, Retry, Fail?
> 
> Not that I know anything about Windows, but is there a chance that the
> machine goes looking for command.com on the diskette? I.e. you want
> c:\\windows\\command.com instead.


I'm afraid not.  Even 

  system("c:\\windows\\command.com /c dir c:",intern=T)

behaves the same, ie fails several times with the above message, then 
works fine until the next reboot.  A further detail: the whirring on 
drive a: only occurs on the first attempt; thereafter the drive is silent 
as if the result is cached.

Maybe also relevant:

1. I'm starting R from a desktop shortcut with the opening directory 
   named in the "Start in:" box.  Exercising the R pulldown "File - 
   Change dir" doesn't help.
      
2. This also happened with rw0641, but not in an earlier version (not sure 
   which).

Thanks

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 22 07:43:02 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 22 Jul 1999 07:43:02 +0100 (BST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907220736550.3797-100000@auk.stats>

Why was this a bug report?  It does not seem to me to meet the requirements
of a bug given in the R FAQ.

On 22 Jul 1999, Peter Dalgaard BSA wrote:

> John.Peters@tip.csiro.au writes:
> 
> > Using rw0642 under win95, on executing from a directory on the c: drive:
> > 
> >    system("command.com /c dir", intern=T)
> > 
> > there is a whirring from drive a: (empty), then the message appears in a 
> > dos box:
> > 
> >    General failure reading device aLP!!?
> >    Abort, Retry, Fail?
> 
> Not that I know anything about Windows, but is there a chance that the
> machine goes looking for command.com on the diskette? I.e. you want
> c:\\windows\\command.com instead.

Not on my machine: that command works for me.

What do you (John) expect this command to do? In particular, what directory
does you expect it to list?  You have not told it, and Windows has quite
complicated rules for finding the current working directory. My guess
is that those rules are giving a: in your circumstances. Put a floppy
in and find out.

Tip:  using shell() would be much simpler. Try ?shell (on Windows only).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 22 08:56:44 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 22 Jul 1999 09:56:44 +0200 (CEST)
Subject: tensor() function and sets
In-Reply-To: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>
Message-ID: <XFMail.990722095644.plummer@iarc.fr>

On 20-Jul-99 Jonathan Rougier wrote:
> Hi Everyone,
> 
> To complete the outer() and kronecker() functions in the base, may I
> suggest the following tensor() function, which allows the multiplication
> of arrays through sets of conformable dimensions.  I am happy to write a
> help page if required. 

I have some code that could certainly be tidied up with the tensor()
function [1], but I wonder if "tensor" is the right name.
1) I would expect a function called "tensor" to construct a tensor object
   rather than multiply two arrays together.
2) The arguments aren't tensors. They are arrays.

How fast is it? It would be _really_ nice if this were done efficiently
in C code.

Martyn

[1] ar.yw in the "bats" package. I was just looking at this wondering how
    to speed it up before rewriting the whole thing in C or Fortran.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 22 11:26:41 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 22 Jul 1999 12:26:41 +0200 (CEST)
Subject: time series in R
In-Reply-To: <199907200932.LAA25315@sophie.ethz.ch>
Message-ID: <XFMail.990722122641.plummer@iarc.fr>

On 20-Jul-99 Martin Maechler wrote:
> 
> Something which should be discussed however is spectrum(0);
> Several of us think that S-plus does the wrong thing, at least in some
> cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
> and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
> Another possibility would be to leave it NA

[I'm repeating some private discussions with Martin here]

In my version of spec.pgram(), I chose to ignore frequency zero. This
seemed like the right thing to do since the periodogram at zero does
not estimate the spectral density at zero, but is a function of the
mean. It does not make much sense to use this value when smoothing the
periodogram to estimate frequencies near zero. This remains true if you
decide to set periodogram(0)=0.

> and maybe provide methods for estimating it specifically, if desired.

I'm going to do this in the next version of the coda package.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Thu Jul 22 10:11:50 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Thu, 22 Jul 1999 10:11:50 +0100 (BST)
Subject: tensor() function and sets
In-Reply-To: <XFMail.990722095644.plummer@iarc.fr>
Message-ID: <Pine.GSO.3.96.990722094020.10355D-100000@laplace>

On Thu, 22 Jul 1999, Martyn Plummer wrote:

> I have some code that could certainly be tidied up with the tensor()
> function [1], but I wonder if "tensor" is the right name.
> 1) I would expect a function called "tensor" to construct a tensor object
>    rather than multiply two arrays together.
> 2) The arguments aren't tensors. They are arrays.

You are right of course!  I used the name `tensor' because in my notation
I use the tensor convention of summing over repeated indices.  Hence the
arguments da and db in the function are matched pairs of repeated indices.
But the name `aprod' would do just as well (it's rather unattractive
though!).

> How fast is it? It would be _really_ nice if this were done efficiently
> in C code.

It's reasonably fast as is, because it is just two aperms (which may be
degenerate) on top of a matrix product.  We are about to do some large
calculations which are extensively `tensorised' -- the largest object will
be the variance of a 100 by 100 by 10 array, which we have to divide into
5000 operations on 100 by 10 by 100 by 10 arrays (this will take hours
rather than minutes): oh for a sparse array class!  In case you are
wondering, our work is on prediction for large physical systems, eg oil
reservoirs, the weather, contaminated ground water plumes. 

But you could definitely argue that `aprod' is the primitive operation
that should be realised in C code, and then A %*% B is simply aprod(A, B,
2, 1) and outer(A, B, "*") could be aprod(A, B, NULL, NULL). 

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul 23 08:15:03 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 23 Jul 1999 09:15:03 +0200
Subject: lapply( *, names) -- bug ?!
Message-ID: <199907230715.JAA04888@sophie.ethz.ch>

This came on S-news

The more direct test being

sapply(c(a=1,b=2), names)

Problem:  
	  R ("all" versions) 
	  behaves the same as S+5.1, which is wrong IMO.

{since some might disagree,  I didn't yet post to R-bugs ..}

------- Start of forwarded message -------
Date: Thu, 22 Jul 1999 23:14:57 -0230
From: "Paul Y. Peng" <ypeng@math.mun.ca>
To: s-news <s-news@wubios.wustl.edu>
Subject: [S] Feature or bug?

In S-PLUS 3.3 (DEC Alpha) and S-PLUS 2000,

> z <- c("a"=1, "b"=2)
> lapply(z, function(x)names(x))
$a:
[1] "a"

$b:
[1] "b"

But in S-PLUS 5.1 (Linux),

> z <- c("a"=1, "b"=2)
> lapply(z, function(x)names(x))
$a:
NULL

$b:
NULL

Is this a new feature of S-PLUS 5? Do I miss anything in
S-PLUS 5? Thank you for your help.
------- End of forwarded message -------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Jul 23 08:28:35 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 23 Jul 1999 08:28:35 +0100 (BST)
Subject: lapply( *, names) -- bug ?!
In-Reply-To: <199907230715.JAA04888@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats>

On Fri, 23 Jul 1999, Martin Maechler wrote:

> This came on S-news
> 
> The more direct test being
> 
> sapply(c(a=1,b=2), names)
> 
> Problem:  
> 	  R ("all" versions) 
> 	  behaves the same as S+5.1, which is wrong IMO.
> 
> {since some might disagree,  I didn't yet post to R-bugs ..}

I do.  the argument is not a list, and lapply applies to lists. So
> as.list(c(a=1,b=2))
$a
[1] 1

$b
[1] 2

Fine. Note the names of the components are NULL.


> 
> ------- Start of forwarded message -------
> Date: Thu, 22 Jul 1999 23:14:57 -0230
> From: "Paul Y. Peng" <ypeng@math.mun.ca>
> To: s-news <s-news@wubios.wustl.edu>
> Subject: [S] Feature or bug?
> 
> In S-PLUS 3.3 (DEC Alpha) and S-PLUS 2000,
> 
> > z <- c("a"=1, "b"=2)
> > lapply(z, function(x)names(x))
> $a:
> [1] "a"
> 
> $b:
> [1] "b"
> 
> But in S-PLUS 5.1 (Linux),
> 
> > z <- c("a"=1, "b"=2)
> > lapply(z, function(x)names(x))
> $a:
> NULL
> 
> $b:
> NULL
> 
> Is this a new feature of S-PLUS 5? Do I miss anything in
> S-PLUS 5? Thank you for your help.
> ------- End of forwarded message -------
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul 23 08:44:12 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 23 Jul 1999 09:44:12 +0200
Subject: lapply( *, names) -- bug ?!
In-Reply-To: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats> (message
 from Prof Brian D Ripley on Fri, 23 Jul 1999 08:28:35 +0100 (BST))
References: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats>
Message-ID: <199907230744.JAA05728@sophie.ethz.ch>

>>>>> On Fri, 23 Jul 1999 08:28:35 +0100 (BST), Prof Brian D Ripley <ripley@stats.ox.ac.uk> said:

    BDR> On Fri, 23 Jul 1999, Martin Maechler wrote:
    >> This came on S-news
    >> 
    >> The more direct test being
    >> 
    >> sapply(c(a=1,b=2), names)
    >> 
    >> Problem:  
    >> R ("all" versions) 
    >> behaves the same as S+5.1, which is wrong IMO.
    >> 
    >> {since some might disagree,  I didn't yet post to R-bugs ..}

    BDR> I do.  the argument is not a list, and lapply applies to lists.
that was not the point;
lapply() and sapply() are supposed to coerce to list()
    BDR> So
    >> as.list(c(a=1,b=2))
    BDR> $a
    BDR> [1] 1

    BDR> $b
    BDR> [1] 2

    BDR> Fine. Note the names of the components are NULL.

Yes, exactly.  

And therefore lapply(*, names) {or sapply(..)} should return NULLs
as it does [in R and S+5.x].
I was wrong all along.
It seems I need a longer warm-up time for my brain today...

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Fri Jul 23 09:51:48 1999
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 23 Jul 1999 18:51:48 +1000 (EST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <Pine.GSO.4.05.9907220736550.3797-100000@auk.stats> from Prof Brian D Ripley at "Jul 22, 99 07:43:02 am"
Message-ID: <199907230851.SAA05406@dylan.tip.CSIRO.AU>

Prof Brian D Ripley writes:

> Why was this a bug report?  It does not seem to me to meet the requirements
> of a bug given in the R FAQ.
> 
> On 22 Jul 1999, Peter Dalgaard BSA wrote:
> 
> > John.Peters@tip.csiro.au writes:
> > 
> > > Using rw0642 under win95, on executing from a directory on the c: drive:
> > > 
> > >    system("command.com /c dir", intern=T)
> > > 
> > > there is a whirring from drive a: (empty), then the message appears in a 
> > > dos box:
> > > 
> > >    General failure reading device aLP!!?
> > >    Abort, Retry, Fail?
> > 
> > Not that I know anything about Windows, but is there a chance that the
> > machine goes looking for command.com on the diskette? I.e. you want
> > c:\\windows\\command.com instead.
> 
> Not on my machine: that command works for me.
> 
> What do you (John) expect this command to do? In particular, what directory
> does you expect it to list?  You have not told it, and Windows has quite
> complicated rules for finding the current working directory. My guess
> is that those rules are giving a: in your circumstances. Put a floppy
> in and find out.
> 
> Tip:  using shell() would be much simpler. Try ?shell (on Windows only).


Firstly a workaround (fix?):

Disable McAfee VirusScan 4.0.2/4.0.4032.  If this means it could 
be described as more an incompatibility than a bug I apologise. 


Secondly to respond to the comments and suggestions (McAfee enabled):

What do I expect this command to do:
To read the names of the files in the current directory for assignment 
to a vector.  By current directory I mean the one named in the win95 
shortcut "Start in:" box, which is also the one initially offered by the 
Rgui pull down "File - Change dir".  It succeeds in this, but not on the 
first attempt.

Put a floppy in drive a:
Less whirring, but same result.  Hitting "a" gives the behaviour I 
described.  Hitting "f" succeeds after a few tries, but next time again 
needs a few tries before succeeding.  So far it seems exactly four "f"s 
or three "a"s are required.

Try shell():
Both the following cause the same behaviour as with "system()":
  shell("dir c:\\tmp\\9907","c:\\windows\\command.com",intern=T)
  shell("dir","command.com",intern=T)

Many thanks

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Jul 23 13:22:07 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 23 Jul 1999 14:22:07 +0200 (MET DST)
Subject: reluctant to read win95 directory (PR#231)
Message-ID: <199907231222.OAA26619@pubhealth.ku.dk>

On Fri, 23 Jul 1999, John Peters wrote:

> Firstly a workaround (fix?):
> 
> Disable McAfee VirusScan 4.0.2/4.0.4032.  If this means it could 
> be described as more an incompatibility than a bug I apologise. 

Yes, I would put that down to a system problem. The reason for being 
picky is that bug reports need to be written up, ...

It looks to me as if McAfee has replaced the Windows `search for
executables' routine and uses that to go for a virus search.
Not much we can do about that.


> Try shell():
> Both the following cause the same behaviour as with "system()":
>   shell("dir c:\\tmp\\9907","c:\\windows\\command.com",intern=T)
>   shell("dir","command.com",intern=T)


It will do as it too has to search for an executable.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 23 14:18:03 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 23 Jul 1999 15:18:03 +0200 (CEST)
Subject: 0.65 HPUX/AIX update
Message-ID: <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>

The current situation is as follows.

AIX:

* I still need f77 for linking.  Using ld with the suggested flags gives
  a binary with `exec format error'.  The problem seems to be with an
  unreferenced __start.

* The floating point (finite|isnan) stuff is strange, but under control,
  I think.  Plain cc works, gcc has a problem and seems to need having
  prototypes turned off for IEEE fp.  (More below.)

* Apart from that, make check goes all the way through at least for me
  under both cc/f77/make and gcc/f77/make.

HPUX:

* make check fails in arith-true.R.  The problem is that

        is.infinite(.Machine$double.base ^ .Machine$double.max.exp)

gives FALSE.

Interestingly

> .Machine$double.base
[1] 2
> .Machine$double.max.exp
[1] 1024
> 2 ^ 1024
[1] 1.797693e+308
> 2 ^ 1025
[1] 1.797693e+308
> 2 ^ 2024
[1] 1.797693e+308

****

Here are some observations re IEEE fp.  I have the following small test
program:

#include <math.h>
#include <stdio.h>

main () {
    printf("1/0: %lf 0/0: %lf\n", 1./0., 0./0.);
    printf("finite(1/0): %d\n", finite(1./0.));
    printf("isnan(0/0): %d\n", isnan(0./0.));
    printf("log(0.): %lf\n", log(0.));
    return(0);
}

Under Linux, this gives:

1/0: Inf 0/0: NaN
finite(1/0): 0
isnan(0/0): -1
log(0.): -Inf

Under HPUX:

1/0: ++.000000 0/0: ?.000000
finite(1/0): 0
isnan(0/0): 1
log(0.): -179769313486231571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.000000

This is also why log(0) is broken on HPUX.  See also the above why make
check fails.  However, the finite and isnan test is o.k.

Under AIX with cc:

1/0: INF 0/0: NaNQ
finite(1/0): 0
isnan(0/0): 1
log(0.): -INF

Under AIX with gcc:

1/0: INF 0/0: NaNQ
finite(1/0): 1
isnan(0/0): 1
log(0.): -INF

So there is a problem in the finite() test with gcc.  It somehow is
related to the use of ANSI C prototypes, and disappears if we define
_NO_PROTO.  I am in the process of adding this as a short term fix, but
we should think a bit more about that.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Jul 23 21:44:43 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Fri, 23 Jul 1999 16:44:43 -0400
Subject: 0.65 HPUX/AIX update
In-Reply-To: Your message of "Fri, 23 Jul 1999 15:18:03 EDT."
 <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>
Message-ID: <199907232044.QAA20966@infiniti.ece.cmu.edu>


Kurt,

  thanks for the changes.  I've downloaded the snapshot on July 22.
It looks like we are in good shape now for AIX:

"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

Kurt> The current situation is as follows.
Kurt> 
Kurt> AIX:
Kurt> 
Kurt> * I still need f77 for linking.  Using ld with the suggested flags gives
Kurt> a binary with `exec format error'.  The problem seems to be with an
Kurt> unreferenced __start.

I apologize for not seeing this earlier: "__start" is defined in
/lib/crt0.o.  So all you have to do is add /lib/crt0.o to the objects
when linking.  (You have to look carefully for that in the output from
gcc --verbose anything.o to learn what gcc is doing when linking an executable.)

Kurt> * The floating point (finite|isnan) stuff is strange, but under control,
Kurt> I think.  Plain cc works, gcc has a problem and seems to need having
Kurt> prototypes turned off for IEEE fp.  (More below.)

Quick fix and insanity check:  Add the following lines at the end of Arith.h
  #include <fp.h>
  static int finite (double x) {
        return FINITE (x);
  }
This will generate lots of warnings.  The resulting executable
(compiled with gcc) works wrt Inf and NaN!  My current assumption is
that there is a bug in gcc that generates the wrong inline version of
finite.  Overwriting it solves the problem.  A better fix would be to
ensure that finite is never called when configure finds that it is
buggy.  (I believe that the issue whether finite () exists is a
separate one.  So there should be two flags, like HAVE_FINITE and
HAVE_FINITE_THAT_STINKS... )

Kurt> So there is a problem in the finite() test with gcc.  It somehow is
Kurt> related to the use of ANSI C prototypes, and disappears if we define
Kurt> _NO_PROTO.  I am in the process of adding this as a short term fix, but
Kurt> we should think a bit more about that.

  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Mon Jul 26 03:41:12 1999
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Mon, 26 Jul 1999 04:41:12 +0200 (MET DST)
Subject: Bug in inequalities involving ordered factors (PR#232)
Message-ID: <199907260241.EAA04232@pubhealth.ku.dk>

> stress.level<-rep(c("low","medium","high"),2)
> ordf.stress<-ordered(stress.level, levels=c("low","medium","high"))
> ordf.stress
[1] low    medium high   low    medium high  
Levels:  low < medium < high 
> ordf.stress >= "medium"
[1] FALSE  TRUE FALSE FALSE  TRUE FALSE

#### Clearly the third and sixth values should be TRUE

--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Windows 9x 4.0 (build 1111)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon Jul 26 05:34:33 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 26 Jul 1999 16:34:33 +1200 (NZST)
Subject: Bug in inequalities involving ordered factors (PR#232)
Message-ID: <199907260434.QAA20417@stat1.stat.auckland.ac.nz>

Here is a QuickFix (TM) which probably needs more careful thought.
(It looks like Ops.ordered has only been partially implemented).

Ops.ordered <-
function (e1, e2)
{
    nas <- is.na(e1) | is.na(e2)
    ord1 <- FALSE
    ord2 <- FALSE
    if (nchar(.Method[1])) {
        l1 <- levels(e1)
        ord1 <- TRUE
    }
    if (nchar(.Method[2])) {
        l2 <- levels(e2)
        ord2 <- TRUE
    }
    if (all(nchar(.Method)) && (length(l1) != length(l2) ||
        !all(sort(l2) == sort(l1))))
        stop("Level sets of factors are different")
    if (ord1 && ord2) {
        e1 <- codes(e1)
        e2 <- codes(e2)
    }
    else if (!ord1) {
        e1 <- match(e1, l2)
        e2 <- codes(e2)
    }
    else if (!ord2) {
        e2 <- match(e2, l1)
        e1 <- codes(e1)
    }
    value <- get(.Generic, mode = "function")(e1, e2)
    value[nas] <- NA
    value
}

I have committed this in the development version, but it probably needs
more thought than I have time for at present.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Mon Jul 26 08:45:18 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Mon, 26 Jul 1999 15:45:18 +0800 (SST)
Subject: ESRI Shapefile reader (help with dlls)
Message-ID: <199907260745.PAA31048@decunx.iscs.nus.sg>

Hi,
I am working on a library of map functions for R and I have started
with code to read shapefiles (the format is not great but it is ubiquitous).
I am not a windows person, but where I am working I don't have access to
any UNIX machines easily. So here's the problem I wrote C code to read
the information out of the shapefile header and I compiled it using
the script given in Ripley and Veneables programming compliments for 
Cygwin tools. It seemed to work, however when I tried calling it from R
it didn't work (couldn't find the symbol).

here's what happend

> version
           _         
platform   Windows   
arch       x86       
os         Win32     
system     x86, Win32
status               
status.rev 0         
major      0         
minor      64.2      
year       1999      
month      July      
day        3         
language   R         
> dyn.load("D:/Nicholas/shapelib-1.2.5/Sshpopen.dll")
> read.shape("D:\Nicholas\jstuff\Geotools\examples\publands")
Error in .C("SHPOpen", as.character(shpname), as.character(shxname), as.character(access),  : C/Fortran function not in load table
> is.loaded(symbol.C("SHPOpen"))
[1] FALSE
> 

Am I doing something wrong when building the dll? here are the steps I used

gcc -mno-cygwin -O2 -c Sshpopen.c
echo LIBRARY Sshpopen > Sshpopen.def
echo EXPORTS >> Sshpopen.def
nm Sshpopen.o | \
sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" \
>> Sshpopen.def
gcc -mno-cygwin -mdll -Wl,--base-file,Sshpopen.b \
-o Sshpopen.dll Sshpopen.o
dlltool -k -D Sshpopen.dll -b Sshpopen.b -e Sshpopen.e -d Sshpopen.def
gcc -mno-cygwin -mdll -Wl,--base-file,Sshpopen.b \
-o Sshpopen.dll Sshpopen.e Sshpopen.o
dlltool -k -D Sshpopen.dll -b Sshpopen.b -e Sshpopen.e -d Sshpopen.def
gcc -mno-cygwin -mdll -o Sshpopen.dll Sshpopen.e Sshpopen.o
rm -f Sshpopen.b Sshpopen.e

Thanks for any insight

Nicholas
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Tue Jul 27 00:08:54 1999
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Tue, 27 Jul 1999 01:08:54 +0200 (MET DST)
Subject: deviance.lm() should calculate a weighted SS of residuals (PR#233)
Message-ID: <199907262308.BAA12862@pubhealth.ku.dk>


Here is a (slightly silly) example.  Surely deviance.lm()
should calculate a weighted sum of squares about the mean,
not a sum of squares.  deviance.glm() is correct.

> roller
   weight depression
1     1.9          2
2     3.1          1
3     3.3          5
4     4.8          5
5     5.3         20
6     6.1         20
7     6.4         23
8     7.6         10
9     9.8         30
10   12.4         25
> roller.lm<-lm(weight~depression,data=roller,weights=1:10)
> roller.glm<-glm(weight~depression,data=roller,weights=1:10)

> deviance(roller.lm)
[1] 35.493

> deviance(roller.glm)
[1] 240.67

> # Now change the definition of deviance.lm
> deviance.lm<-function(object, ...)sum(weighted.residuals(object)^2)
> deviance(roller.lm)
[1] 240.67
> 



--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Windows 9x 4.0 (build 1111)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Tue Jul 27 06:17:58 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Tue, 27 Jul 1999 17:17:58 +1200
Subject: Memory profiling/benchmarking
Message-ID: <19990727171758.A2622@stat1.stat.auckland.ac.nz>

Hi,

As a project for a computer performance analysis paper I am taking this semester,
I am going to look at the performance of the memory manager in R, with the aim of
determining how fast it is and which areas most need improvement.  The idea is
that I will compare various versions of R, starting with 0.64.2, and then at a
few stages in the implementation of the new memory management scheme (of which
the first step was the hash tables for environments).

I am looking for scripts to use as benchmarks for memory related activities.  As
a starting point I will use the tests distributed with R, but any other
contributions would be helpful.  I don't think the tests I have are particularly
aimed at performance, but they should give a reasonable indication of which
functions are the performance hogs.

Any other suggestions would be greatly appreciated.

Thanks,
Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Tue Jul 27 07:07:57 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Tue, 27 Jul 1999 14:07:57 +0800 (SST)
Subject: ESRI Shape reader
Message-ID: <199907270607.OAA04096@decunx.iscs.nus.sg>

Well Dr. Ripley helped me solve the first problem, next question
I need to do some debugging now that the function loads properly
into R. I checked the S documentation and to use the C I/O functions
you need to include newredef.h, this file doesn't exist in /src/include.
How does this work in R? under S3.4 on a dec station i could use

fprintf(stdout,..);
fflush(stdout);

thanks,

Nicholas

PS If I should be sending these questions to r-help instead let me know.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@hal.stat.unipd.it (Guido Masarotto)  Tue Jul 27 08:26:21 1999
From: guido@hal.stat.unipd.it (Guido Masarotto) (Guido Masarotto)
Date: Tue, 27 Jul 1999 08:26:21 +0100
Subject: ESRI Shape reader
In-Reply-To: <199907270607.OAA04096@decunx.iscs.nus.sg>; from Nicholas Lewin-Koh on Tue, Jul 27, 1999 at 02:07:57PM +0800
References: <199907270607.OAA04096@decunx.iscs.nus.sg>
Message-ID: <19990727082621.38191@hal.stat.unipd.it>

On Tue, Jul 27, 1999 at 02:07:57PM +0800, Nicholas Lewin-Koh wrote:
> Well Dr. Ripley helped me solve the first problem, next question
> I need to do some debugging now that the function loads properly
> into R. I checked the S documentation and to use the C I/O functions
> you need to include newredef.h, this file doesn't exist in /src/include.
> How does this work in R? under S3.4 on a dec station i could use
> 
> fprintf(stdout,..);
> fflush(stdout);
> 

  Previous lines works in Rterm but not in Rgui.
  For both, you can use 'REprintf', e.g.,

  REprintf("%s %d",aString,anInt);

  This is a function exported by R.dll. So to get it properly linked
  you have:
  (i) to install also the rwXXXsp.zip file;
  (ii) to regenerate libR.a (the import library for R.dll);
  (iii) to link your dll against libR.a (-L/path-to-libR.a -lR)

  Alternative: use 'gdb'; details on Brian's rw FAQ.

  guido
    






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 07:42:58 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 07:42:58 +0100 (BST)
Subject: Memory profiling/benchmarking
In-Reply-To: <19990727171758.A2622@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907270737001.29983-100000@auk.stats>

On Tue, 27 Jul 1999, Lyndon Drake wrote:

> Hi,
> 
> As a project for a computer performance analysis paper I am taking this semester,
> I am going to look at the performance of the memory manager in R, with the aim of
> determining how fast it is and which areas most need improvement.  The idea is
> that I will compare various versions of R, starting with 0.64.2, and then at a
> few stages in the implementation of the new memory management scheme (of which
> the first step was the hash tables for environments).
> 
> I am looking for scripts to use as benchmarks for memory related activities.  As
> a starting point I will use the tests distributed with R, but any other
> contributions would be helpful.  I don't think the tests I have are particularly
> aimed at performance, but they should give a reasonable indication of which
> functions are the performance hogs.

Currently the base package is treated specially (although less specially
than it was, now we have hashing). Also, many of the most time-intensive
things in R are done in compiled code. So some candidates for good tests
are things done in large packages almost entirely in R. I used the 
V&R3 ch06.R script in doing some timings, as repeated linear regression
(either stepwise selection or bootstrapping) looks like the right sort of
thing. And on that the latest (in 0.65) memory management gave a speed up
of around 50%.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 07:56:20 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 07:56:20 +0100 (BST)
Subject: ESRI Shape reader
In-Reply-To: <19990727082621.38191@hal.stat.unipd.it>
Message-ID: <Pine.GSO.4.05.9907270744040.29983-100000@auk.stats>

NB: from the previous message, this is about Windows.

On Tue, 27 Jul 1999, Guido Masarotto wrote:

> On Tue, Jul 27, 1999 at 02:07:57PM +0800, Nicholas Lewin-Koh wrote:
> > Well Dr. Ripley helped me solve the first problem, 

which was to use the makefiles for installing a package: it is much the 
easiest way to work with compiled code in R (on Unix too).

> > next question
> > I need to do some debugging now that the function loads properly
> > into R. I checked the S documentation and to use the C I/O functions
> > you need to include newredef.h, this file doesn't exist in /src/include.

That is only true in S-PLUS 4.x (not S), and only needed in the GUI
version (splus.exe not sqpe.exe) as the console has not stdout stream
(the same as Rgui.exe).

> > How does this work in R? under S3.4 on a dec station i could use
> > 
> > fprintf(stdout,..);
> > fflush(stdout);

It would be normal to use stderr for debugging.


>   Previous lines works in Rterm but not in Rgui.
>   For both, you can use 'REprintf', e.g.,
> 
>   REprintf("%s %d",aString,anInt);

An alternative, which I tend to use is,

char msg[1024];

sprintf(msg, ...);
askok(msg);

which puts the contents of the message up in a message dialog box.
The trouble with Rprintf and REprintf is that they depend on the console
running properly and the information written not getting over-written.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 08:06:23 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 08:06:23 +0100 (BST)
Subject: Preliminary version of ts package
Message-ID: <Pine.GSO.4.05.9907270756330.29983-100000@auk.stats>

There is now a preliminary version of a time series package in the R-devel
snapshots, and we would welcome feedback on it.  It is based in part on the
packages bats (Martyn Plummer) and tseries (Adrian Trapletti) and in part
on code I had or have written. (Thanks for the contributions, Martyn and
Adrian!) Some of the existing ts code has been changed, for example to plot
multiple time series, so the behaviour after library(ts) may differ from
that without it.

library(help=ts) gives something like the listing below.  It is intended
that ar.burg (univariate case) and preliminary arima fitting and
forecasting functions will be added in the next couple of weeks.  At 
present there is a fairly high degree of S-PLUS compatibility in the
interfaces, but not necessarily in the objects or algorithms.

----------------------

Preliminary time-series package for R 0.65
==========================================

This is a preliminary version of a time-series package; at present
the functionality is somewhat limited in that not all the options are
yet implemented or may be very slow.

Functions in base R:
-------------------

ts		Create a (univariate or multivariate) ts object
[.ts		Subsetting method for ts objects.
as.ts, is.ts	Coercion and membership functions
plot, print	Methods for plot and print

aggregate	Computes summaries (e.g. sum) over disjoint time intervals
diff		Lagged differences of a time series
end		Time of last observation
frequency	Number of observations per unit of time
start		Time of first observation
time		Create time series giving the times of observations
tsp, tsp<-	Get and set time-series attributes
window		Subset to a time window


Functions in package ts:
-----------------------

acf		Autocovariance and autocorrelation function
ar              Wrapper for autoregression estimation functions
ar.yw           Estimate autoregression model by solving Yule-Walker equations
Box.test	Box-Pierce and Ljung-Box tests of independence
ccf		Cross-covariance and cross-correlations for two series
cpgram		Plot cumulative periodogram of univariate time series
cycle		Create time series giving the positions in a cycle 
		   of a time series
deltat		Return time interval between observations
diffinv		Discrete integration, the inverse of diff()
embed           Embedding a time series
filter		Linear filtering on a time series
kernel          Smoothing kernel objects (and Daniell, Fejer and 
                   (modified) Dirichlet kernels)
lag		Compute lagged version of time series
na.contiguous	Find longest contiguous stretch of non-NAs
na.omit.ts	na.omit method for time series
pacf		Partial autocorrelation function
plot.acf        Plot autocorrelation function
plot.spec       Plot spectral density estimate
plot.spec.coherency
plot.spec.phase
PP.test		Phillips-Perron test for unit root
spec.ar	        Estimate spectral density by autoregression
spec.pgram      Estimate spectral density from periodogram
spec.taper      Taper by cosine bell
spectrum        Wrapper for spectral density estimation functions
stl		Seasonal decomposition using loess
toeplitz	Generate Toeplitz matrix
ts.intersect	Bind time series as multivariate ts over the common time base
ts.union	Bind time series as multivariate ts over their total time base

TO DO

ar.burg		maybe
arima fitting and forecasting.


Datasets in base R:
------------------

airmiles        Passenger-Miles on US Airlines 1937-1960
co2             Moana Loa Atmospheric CO2 Concentrations
nhtemp          Yearly Average Temperatures in New Haven CT
presidents      Quarterly Approval Ratings for US Presidents
sunspots        Monthly Mean Relative Sunspot Numbers
uspop		Populations Recorded by the US Census


Datasets in package ts:
----------------------

accdeaths       US accidental deaths 1973-8
beaver1         time series of body temperatures of two beavers
beaver2
deaths          time-series on UK lung deaths 1974-9 from Diggle (1990)
mdeaths, fdeaths  as above, for males and females
drivers         time series on UK road deaths of drivers from Harvey (1989)
finance         daily closing prices of major European stock indices, 1991-1998
lh              dataset on luteinizing hormone from Diggle (1990)
nottem		time-series of temperatures in Nottingham, 1920-1939
sales		sales data with leading indicator
sunspot.year	yearly sunspot data, 1700-1988
sunspot.month	monthly sunspot data, 1749-1997
treering	yearly tree ring data, -6000-1979


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 15:51:10 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 10:51:10 -0400
Subject: Memory profiling/benchmarking
References: <19990727171758.A2622@stat1.stat.auckland.ac.nz>
Message-ID: <379DC75D.DFFAFBC6@bank-banque-canada.ca>

Lyndon

There are several test scripts with my DSE library available at
<http://www.bank-banque-canada.ca/pgilbert>. (Please don't make the mistake of
trying to install the version on CRAN - it installs with  R 0.61 but there have
been a lot of changes to R since then.)

The library calls compiled fortran for the really loop intensive core
calculations, but this is fairly representative of R. With R (up to 0.64.2) the
shortest set of tests (test.dse.lite) takes 7-8 minutes on a Sparc Ultra 10.
(Splus 3.3 takes 4-5 minutes.) There are several longer tests, including some
curvature calculations which take many hours. (In some of the more complicated
tests there are a few things which do not work in R, but most things do.) I use
generic functions a lot, and also use a set of "kernel" functions to help
protect my code from ongoing changes in R and S. This means that function
dispatch gets heavily exercised.

Attached below are results from the light and medium test for 0.64.2 and the
development snapshot (0.65) from a month ago (June 11). These show the timing at
the bottom of each test. As I recall I had to make a small fix to 0.64.2 in
order to get things working - but I don't remember what it was. If you have a
problem, send me the error message and it will jog my memory. I don't see a
large difference in the times, but I don't know if hashing was already in the
snapshot I have.

The pending changes in the ts library will have some affect on what has to be
attached to run the tests. Hopefully I will get a chance to test the library
today or tomorrow.

I would like to see the results of your testing, even if you decide not to use
these test.

Paul Gilbert
_________


On a sparc Ultra 10
R-0.64.2/
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.lite
+++++++++++++++++++++++++++++++++++++++++++++++++
RLIBS set to /home/mfa5/gilp/dse/pub/Rdse/rlibs
>    library("dse")

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


 The following object(s) are masked from package:base :

  RNGkind rnorm runif


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts


Attaching Package "package:dse":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

>    library("dse2")

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

>    library("mva")
>    library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.lite.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Random number generator tests ...ok
All tframe tests ... OK
All dse1 (kernel) tests ... OK
All dse2 tests ... OK
All dse3 tests ... OK
All dse4 tests ...Warning: skipping test 4 (requires stepwise).
 OK
dse2 graphics tests ...Warning: Specified end later than end of data, end not
changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
completed
dse3 graphics tests ...completed
dse4 graphics tests ...completed
All Brief User Guide example part 1 tests ... OK
All dse juice tests ...juice graphics tests ... OK
 OK
>
>
=========================================
R test.lite.s timing:
start Tuesday July 27 09:27:11 EDT 1999
end   Tuesday July 27 09:34:59 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.medium
+++++++++++++++++++++++++++++++++++++++++++++++++
>   x11()
> library("dse", warn.conflicts=FALSE)

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


 The following object(s) are masked from package:base :

  RNGkind rnorm runif


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

> library("dse2", warn.conflicts=FALSE)

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

> library("opt")
> library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.medium.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Brief User Guide example part 2 tests ...Warning: Specified end later than end
of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
 OK
>
>
=========================================
R test.medium.s timing:
start Tuesday July 27 09:35:00 EDT 1999
end   Tuesday July 27 09:49:00 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================

########################################################################

Devel version R 0.65 June 11, 1999 snapshot

+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.lite
+++++++++++++++++++++++++++++++++++++++++++++++++
RLIBS set to /home/mfa5/gilp/dse/pub/Rdse/rlibs
>    library("dse")

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


Attaching Package "package:syskern":


 The following object(s) are masked from package:base :

  rnorm


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts


Attaching Package "package:dse":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

>    library("dse2")

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

>    library("mva")
>    library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.lite.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Random number generator tests ...ok
All tframe tests ... OK
All dse1 (kernel) tests ... OK
All dse2 tests ... OK
All dse3 tests ... OK
All dse4 tests ... OK
dse2 graphics tests ...completed
dse3 graphics tests ...completed
dse4 graphics tests ...completed
All Brief User Guide example part 1 tests ... OK
All dse juice tests ...juice graphics tests ... OK
 OK
Warning message:
skipping test 4 (requires stepwise). in: dse4.function.tests(verbose = F,
graphics = F)
>
>
=========================================
R test.lite.s timing:
start Tuesday July 27 09:59:15 EDT 1999
end   Tuesday July 27 10:06:57 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.medium
+++++++++++++++++++++++++++++++++++++++++++++++++
>   x11()
> library("dse", warn.conflicts=FALSE)

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


Attaching Package "package:syskern":


 The following object(s) are masked from package:base :

  rnorm


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

> library("dse2", warn.conflicts=FALSE)

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

> library("opt")
> library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.medium.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Brief User Guide example part 2 tests ... OK
>
>
=========================================
R test.medium.s timing:
start Tuesday July 27 10:06:57 EDT 1999
end   Tuesday July 27 10:20:47 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 18:55:57 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 13:55:57 -0400
Subject: Preliminary version of ts package
Message-ID: <379DF2AD.3A4DD91E@bank-banque-canada.ca>

Brian

I haven't got far, but here are some initial problems:

> start(1:10)
S:  [1] 1 1
ts: 1

> end(1:10)
S: [1] 10  1
ts: 10

window.ts  should handle NULL for default start and end values. If it is going
to print a warning then it needs warn=F to suppress the warning. Below is a copy
of my window.ts, but it would require a few minor changes to work without my
tframe library.

Paul
_______

 window.ts <- function (x, start = NULL, end = NULL, warn = T, eps =
.Options$ts.eps)
{
    f <- tsp(x)[3]
    if (is.null(start))
        start <- tsp(x)[1]
    if (is.null(end))
        end <- tsp(x)[2]
    if (2 == length(start))
        start <- start[1] + (start[2] - 1)/f
    if (2 == length(end))
        end <- end[1] + (end[2] - 1)/f
    if (start < tsp(x)[1]) {
        start <- tsp(x)[1]
        if (warn)
            warning("Specified start earlier than start of data, start not
changed.")
    }
    if (end > tsp(x)[2]) {
        end <- tsp(x)[2]
        if (warn)
            warning("Specified end later than end of data, end not changed.")
    }
    leave <- (time(x) >= (start - eps)) & (time(x) <= (end + eps))
    if (is.matrix(x))
        z <- unclass(x)[leave, , drop = F]
    else z <- x[leave]
    classed(ts(z, start = start, end = end, frequency = f), tfclass(x))
}


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 20:09:40 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 20:09:40 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379DF2AD.3A4DD91E@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907272003470.10800-100000@auk.stats>

On Tue, 27 Jul 1999, Paul Gilbert wrote:

> Brian
> 
> I haven't got far, but here are some initial problems:
> 
> > start(1:10)
> S:  [1] 1 1
> ts: 1
> 
> > end(1:10)
> S: [1] 10  1
> ts: 10

What's wrong with that?  S looks silly to me: you only need the second
component for seasonal series, and 1:10 is not seasonal.

In general, I am not trying to clone S, most notably as S-PLUS uses class
rts not ts, so very little code exists that uses S's class ts. Surely the
point of R is not _better_?  There are lots of detail improvements,
with more to come.

> window.ts  should handle NULL for default start and end values. If it is going
> to print a warning then it needs warn=F to suppress the warning. Below is a copy
> of my window.ts, but it would require a few minor changes to work without my
> tframe library.

I have not changed window.ts. I'll take a look.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 21:23:33 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 16:23:33 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907272003470.10800-100000@auk.stats>
Message-ID: <379E1545.4A37ECF8@bank-banque-canada.ca>

Brian

>In general, I am not trying to clone S, most notably as S-PLUS uses class
>rts not ts, so very little code exists that uses S's class ts. Surely the
>point of R is not _better_?  There are lots of detail improvements,
>with more to come.

Yes, hopefully there will be lots of improvements. But I think everyone has
agreed that we want S compatability for the default behaviour, so if  "ts" is
not going to be the default, then the default needs to be defined. Then, for
example, we cannot have

start.default <- function (x)  start.ts(ts(x))

as it is now.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 22:56:25 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 22:56:25 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379E1545.4A37ECF8@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907272252270.11135-100000@auk.stats>

On Tue, 27 Jul 1999, Paul Gilbert wrote:

> Brian
> 
> >In general, I am not trying to clone S, most notably as S-PLUS uses class
> >rts not ts, so very little code exists that uses S's class ts. Surely the
> >point of R is not _better_?  There are lots of detail improvements,
> >with more to come.
> 
> Yes, hopefully there will be lots of improvements. But I think everyone has
> agreed that we want S compatability for the default behaviour, so if  "ts" is

Not in my time with R: can you give me the reference to that agreement,
please. (If it is a generic comment, there are many, many exceptions.)

> not going to be the default, then the default needs to be defined. Then, for
> example, we cannot have
> 
> start.default <- function (x)  start.ts(ts(x))
>
> as it is now.

Why not?  S-PLUS thinks 1:10 has start=c(1,1), end=c(10,1), and would any
sane person think that?  (I might buy c(1,0)....)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Tue Jul 27 23:41:48 1999
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Jul 1999 17:41:48 -0500
Subject: Retaining comments when using `example'
Message-ID: <6rk8rl7m1f.fsf@verdi.stat.wisc.edu>

I find the `example' function, used to run the examples from a help
page, to be very useful.  It would be even more useful if I could find
a way to have the comments echoed along with the example code.

For example, the example section of col.Rd from the base library reads

 # extract an off-diagonal of a matrix
 ma <- matrix(1:12, 3,4)
 ma[row(ma)==col(ma) + 1]

 # create an identity 5-by-5 matrix
 x <- matrix(0,nr=5,nc=5)
 x[row(x)==col(x)] <- 1

but example(col) produces

 R> example(col)

 col> ma <- matrix(1:12, 3, 4)

 col> ma[row(ma) == col(ma) + 1]
 [1] 2 6

 col> x <- matrix(0, nr = 5, nc = 5)

 col> x[row(x) == col(x)] <- 1

Is there a way to retain the comments?  I notice that `example' ends up
calling the `source' function to do the actual running of the code.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul 28 00:38:00 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Jul 1999 01:38:00 +0200
Subject: Retaining comments when using `example'
In-Reply-To: Douglas Bates's message of "27 Jul 1999 17:41:48 -0500"
References: <6rk8rl7m1f.fsf@verdi.stat.wisc.edu>
Message-ID: <x23dy9d5pj.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> Is there a way to retain the comments?  I notice that `example' ends up
> calling the `source' function to do the actual running of the code.

Yeowch! This was not easy with the old comment-as-attribute model, and
it certainly did not get easier with the new keep-function-source
semantics.

The real trouble is - I suspect - an ancient one, inherited from S:

	source() doesn't

I.e. it does not work in the same way as the source command in a shell
would, interpreting a file as if it had been lines entered on the
command line, with some provision for skipping back to interactive
mode if there's an error. Rather, it parses the entire file (and
syntax checks it) and runs the resulting parsed expression. 

Perhaps we need a "real" source()?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 06:40:55 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 06:40:55 +0100 (BST)
Subject: Retaining comments when using `example'
In-Reply-To: <x23dy9d5pj.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907280626520.11506-100000@auk.stats>

On 28 Jul 1999, Peter Dalgaard BSA wrote:

> Douglas Bates <bates@stat.wisc.edu> writes:
> 
> > Is there a way to retain the comments?  I notice that `example' ends up
> > calling the `source' function to do the actual running of the code.
> 
> Yeowch! This was not easy with the old comment-as-attribute model, and
> it certainly did not get easier with the new keep-function-source
> semantics.
> 
> The real trouble is - I suspect - an ancient one, inherited from S:
> 
> 	source() doesn't
> 
> I.e. it does not work in the same way as the source command in a shell
> would, interpreting a file as if it had been lines entered on the
> command line, with some provision for skipping back to interactive
> mode if there's an error. Rather, it parses the entire file (and
> syntax checks it) and runs the resulting parsed expression. 

Ah, but S can use options(echo=T) to do the echoing, rather than the
complicated code R has, and if echo=T S's source runs a loop running dput
on the expressions. And S _does_ echo the comments.

> Perhaps we need a "real" source()?

Yes, but let's try smaller things first.

Why does options(echo=TRUE) do nothing in R?
Since if echoing is actually set (iff R thinks it is non-interactive)
comments are echoed, it seems we do have the mechanisms needed in place.

_If_ this worked Doug would have noticed that there are too many comments
in the R-ex files: running that example in S-PLUS gives

> options(echo=T, prompt="")
> source("/ext/R/R-devel/library/base/R-ex/col.R")
###--- >>> `col' <<<----- Column Indexes
## alias         help(col)
##___ Examples ___:
# extract an off-diagonal of a matrix
ma <- matrix(1:12, 3, 4)
ma[row(ma) == col(ma) + 1]
# create an identity 5-by-5 matrix
x <- matrix(0, nr = 5, nc = 5)
x[row(x) == col(x)] <- 1
## Keywords: 'array'.
vector("end.of.file",0)

so there is more to this than just echoing the comments (including echoing
the output).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Wed Jul 28 09:28:58 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Wed, 28 Jul 1999 16:28:58 +0800 (SST)
Subject: ESRI shapes --again
Message-ID: <199907280828.QAA23696@decunx.iscs.nus.sg>

thanks to all the help so far I have code now that works on windows
(albeit very clunky) that can read the pertinent info from the shape header
and return a list with all the necessary parameters to read info out of
the shape file. Now come the big design questions

1) I have considered building a map object, basically a list that would
hold the info from the shape file and a data frame as part of the list.
Should all of the vertices of a shape be stored in this structure? I can
see this getting big really fast. My idea was to store only offset and the
size of each record and whenever a shape needs to be plotted or accessed 
the vertices can be retrived from the .shp file through an access function.
the problem is if the user wants to project the map all projections will
have to be done on the fly as the vertices are accessed. 

for those who don't know shape files are stored in 3 files, .shp .shx and .dbf
the .shp file holds the geometric information, the .shx file holds the
ofsets and the record sizes for each shape, and the .dbf file holds the
attribute information.

which brings me to question 2

2) the .dbf file contains the attribute information, so I
basically nead to write another version of read.table to access the dbf
file and store it as a data frame (the natural equivalent of an ArcView
data table). Is there a way to extend or access the functions of read.table
to construct a data frame without using a lot of memory building seperate
vectors and factors etc. and binding them into a data frame.

3) I have been cheating. Dr. Ripley suggested I start compiling this as
a package, using the supplied make files. Very sensible advice, however I am 
not exactly sure how to do this on windows. I have checked the faq which
says there is a sample Makefile in the eda package, I assume this
is Unix only couldn't find it. So to do this as far as I can tell from the
dcumentation I could get my hands on I need to make a folder in 
\rw0642\src\library and put the subdirectories R, src, man and data and
then run make? Or am I missing something?
 

Thanks again for all the help.

Nicholas
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 10:09:36 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 10:09:36 +0100 (BST)
Subject: ESRI shapes --again
In-Reply-To: <199907280828.QAA23696@decunx.iscs.nus.sg>
Message-ID: <Pine.GSO.4.05.9907281006240.12748-100000@auk.stats>

On Wed, 28 Jul 1999, Nicholas Lewin-Koh wrote:

> 3) I have been cheating. Dr. Ripley suggested I start compiling this as
> a package, using the supplied make files. Very sensible advice, however I am 
> not exactly sure how to do this on windows. I have checked the faq which
> says there is a sample Makefile in the eda package, I assume this
> is Unix only couldn't find it. So to do this as far as I can tell from the
> dcumentation I could get my hands on I need to make a folder in 
> \rw0642\src\library and put the subdirectories R, src, man and data and
> then run make? Or am I missing something?

Try looking at the R for Windows FAQ or the Venables & Ripley R
complements.

Basically, to make package foo under Windows, set a standard R packages
source (with R, src, man and data) in ...\rw0642\src\library\foo, cd to 
..\rw0642\src\gnuwin32 and `make pkg-foo'.  You are very unlikely to need
a Makefile (under Windows or Unix).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Wed Jul 28 10:10:58 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Wed, 28 Jul 1999 17:10:58 +0800 (SST)
Subject: ESRI Shapefile again
Message-ID: <199907280911.RAA17340@decunx.iscs.nus.sg>

Hi again,
with my question 3) in my last post I think I answered my own question
of course generating a new one. I made the directory maptools in /src/library
and put the proper directories source and everything then from /src/gnuwin32

BASH$ make pkg-maptools

.......
------- Building maptools.dll from maptools.a --------
echo LIBRARY maptools > maptools.def
echo EXPORTS >> maptools.def
nm maptools.a > Defs
sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" Defs >> maptools.def
gcc -mno-cygwin -mdll -Wl,--base-file,maptools.b -s  -o maptools.dll  maptools.a
  -L../../../gnuwin32  -lg2c.mingw32 -lR
/CYGNUS/CYGWIN~1/H-I586~1/i586-cygwin32/bin/ld: cannot open -lg2c.mingw32: No such file or directory
collect2: ld returned 1 exit status
make[2]: *** [maptools.dll] Error 1
make[1]: *** [src/maptools.dll] Error 2
make: *** [pkg-maptools] Error 2

do i need to install -lg2c.mingw32 ? I am running Cygwin 20.1b on Windows 98

Nicholas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 28 12:42:40 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 28 Jul 1999 13:42:40 +0200 (CEST)
Subject: 0.65 HPUX/AIX update
In-Reply-To: <199907232044.QAA20966@infiniti.ece.cmu.edu>
References: <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>
 <199907232044.QAA20966@infiniti.ece.cmu.edu>
Message-ID: <14238.60592.356201.404321@fangorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> Kurt,

>   thanks for the changes.  I've downloaded the snapshot on July 22.
> It looks like we are in good shape now for AIX:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

Kurt> The current situation is as follows.
Kurt> 
Kurt> AIX:
Kurt> 
Kurt> * I still need f77 for linking.  Using ld with the suggested flags gives
Kurt> a binary with `exec format error'.  The problem seems to be with an
Kurt> unreferenced __start.

> I apologize for not seeing this earlier: "__start" is defined in
> /lib/crt0.o.  So all you have to do is add /lib/crt0.o to the objects
> when linking.  (You have to look carefully for that in the output from
> gcc --verbose anything.o to learn what gcc is doing when linking an
> executable.)

Thanks, done now.  `ld' now used for LDCMD and SHLIBLD, always use
/lib/crt0.o when linking the main binary.

Kurt> * The floating point (finite|isnan) stuff is strange, but under control,
Kurt> I think.  Plain cc works, gcc has a problem and seems to need having
Kurt> prototypes turned off for IEEE fp.  (More below.)

> Quick fix and insanity check:  Add the following lines at the end of Arith.h
>   #include <fp.h>
>   static int finite (double x) {
>         return FINITE (x);
>   }
> This will generate lots of warnings.  The resulting executable
> (compiled with gcc) works wrt Inf and NaN!  My current assumption is
> that there is a bug in gcc that generates the wrong inline version of
> finite.  Overwriting it solves the problem.  A better fix would be to
> ensure that finite is never called when configure finds that it is
> buggy.  (I believe that the issue whether finite () exists is a
> separate one.  So there should be two flags, like HAVE_FINITE and
> HAVE_FINITE_THAT_STINKS... )

Kurt> So there is a problem in the finite() test with gcc.  It somehow is
Kurt> related to the use of ANSI C prototypes, and disappears if we define
Kurt> _NO_PROTO.  I am in the process of adding this as a short term fix, but
Kurt> we should think a bit more about that.

Done, too.  I added a configure test for broken finite and in that case
we now do something special for AIX or the same as if finite was not
there otherwise.  (We can circumvent the warnings because what we really
need is R_FINITE(x), and that can be defined as you suggested.)

I consider AIX done now.  Any objections?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 17:04:16 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 12:04:16 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907272252270.11135-100000@auk.stats>
Message-ID: <379F29FE.B16ACFC8@bank-banque-canada.ca>

PG>> Yes, hopefully there will be lots of improvements. But I think
everyone has
PG>> agreed that we want S compatibility for the default behavior, so
if  "ts" is...

BDR>Not in my time with R: can you give me the reference to that
agreement,
BDR>please. (If it is a generic comment, there are many, many
exceptions.)

I think in general this has been agreed to several times, but also in
the discussion of Adrian Trapletti tseries library, which seemed to
initiate the ts library effort, there was general agreement on this
point. (See r-devel messages July 15 Re: tseries).

I am not trying to defend S's poor default treatment of time series. We
need other better time series classes, and perhaps ts should do that. In
fact, perhaps R does not even need a default time series representation
and methods for it.

What is important is that, if there is a time series default it should
be consistent with S. So, either ts should be consistent with S or it
should not be the default.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 18:41:36 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 13:41:36 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907281717080.14236-100000@auk.stats>
Message-ID: <379F40CE.52B3DFA@bank-banque-canada.ca>

PG>> I think in general this has been agreed to several times, but also
in
PG>> the discussion of Adrian Trapletti tseries library, which seemed to

PG>> initiate the ts library effort, there was general agreement on this

PG>> point. (See r-devel messages July 15 Re: tseries).

BDR>No, it did not! I promised to do this at the Vienna workshop in
March: the
BDR>end of the Oxford academic year precipitated this. And my reading of
that
BDR>correspondence is _not_ that there was agreement to follow all of
S's
BDR>quirks.  R-core does not think it has agreed to that: I had checked,

BDR>and the consensus is to improve.

There seems to be a general plan that was discussed by R-core and not
mentioned on R-devel, even when there were announcements about other
work being done on time series libraries. If S compatibility is no
longer a consideration then perhaps that should be communicated to
R-devel and even more widely. There are a number of users that have a
big investment in this.

BDR>Certainly we do not intend to get the same
BDR>wrong answers as S-PLUS!

I consider wrong answers to be special exceptions. Changing R's default
behavior for start() and end() is a design choice, not a wrong answer. I
think is is quiet reasonable to put these design choices in your own
library, but it should not be included as part of the default.

Paul



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 20:43:37 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 20:43:37 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379F40CE.52B3DFA@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907282038240.14583-100000@auk.stats>

On Wed, 28 Jul 1999, Paul Gilbert wrote:

Paul had just sent a public reply to part of a private reply, a practice I
deplore.

In the part he omitted was a challenge to supply a completely S compatible
lm and glm, plus the comment that I have _not_ changed start.ts nor end.ts
in base R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 29 15:18:09 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 29 Jul 1999 16:18:09 +0200 (MET DST)
Subject: round(numeric(0)) (PR#235)
Message-ID: <199907291418.QAA05728@pubhealth.ku.dk>

Try

> round(numeric(0))
[1] NA
> floor(numeric(0))
numeric(0)
> trunc(numeric(0))
numeric(0)

S has them all as numeric(0), and I think R is wrong.
This looks like a design error in the math2 group: it applies to 
signif too, and also to the complex cases, e.g.
> signif(complex(0))
[1] NA



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, package:ts, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 29 17:49:47 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 29 Jul 1999 18:49:47 +0200 (CEST)
Subject: round(numeric(0)) (PR#235)
In-Reply-To: <199907291418.QAA05728@pubhealth.ku.dk>
References: <199907291418.QAA05728@pubhealth.ku.dk>
Message-ID: <14240.34347.395426.27168@fangorn.ci.tuwien.ac.at>

>>>>> ripley  writes:

> Try
>> round(numeric(0))
> [1] NA
>> floor(numeric(0))
> numeric(0)
>> trunc(numeric(0))
> numeric(0)

> S has them all as numeric(0), and I think R is wrong.
> This looks like a design error in the math2 group: it applies to 
> signif too, and also to the complex cases, e.g.
>> signif(complex(0))
> [1] NA

In math2, we have

    if (na < 1 || nb < 1) {
        for (i = 0; i < n; i++)
            y[i] = NA_REAL;
    }

with

    na = LENGTH(sa);
    nb = LENGTH(sb);
    n = (na < nb) ? nb : na;

round(numeric(0)) really does round(numeric(0), 0) and hence we have na
= 0, n = nb = 1.  I think math2 is about right because you need that
sort of symmetry for recycling, but do_round() could know better.  Now

R> round(pi, 1:4)
[1] 3.1000 3.1400 3.1420 3.1416

is supposed to work so is it really clear what we want?  (if either arg
has length 0, does the result have length 0?  Should this be true for
any math2 type function?)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 29 17:58:14 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 29 Jul 1999 17:58:14 +0100 (BST)
Subject: round(numeric(0)) (PR#235)
In-Reply-To: <14240.34347.395426.27168@fangorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.9907291752410.10671-100000@auk.stats>

On Thu, 29 Jul 1999, Kurt Hornik wrote:

> >>>>> ripley  writes:
> 
> > Try
> >> round(numeric(0))
> > [1] NA
> >> floor(numeric(0))
> > numeric(0)
> >> trunc(numeric(0))
> > numeric(0)
> 
> > S has them all as numeric(0), and I think R is wrong.
> > This looks like a design error in the math2 group: it applies to 
> > signif too, and also to the complex cases, e.g.
> >> signif(complex(0))
> > [1] NA
> 
> In math2, we have
> 
>     if (na < 1 || nb < 1) {
>         for (i = 0; i < n; i++)
>             y[i] = NA_REAL;
>     }
> 
> with
> 
>     na = LENGTH(sa);
>     nb = LENGTH(sb);
>     n = (na < nb) ? nb : na;
> 
> round(numeric(0)) really does round(numeric(0), 0) and hence we have na
> = 0, n = nb = 1.  I think math2 is about right because you need that
> sort of symmetry for recycling, but do_round() could know better.  Now
> 
> R> round(pi, 1:4)
> [1] 3.1000 3.1400 3.1420 3.1416
> 
> is supposed to work so is it really clear what we want?  (if either arg
> has length 0, does the result have length 0?  Should this be true for
> any math2 type function?)

Yes, I think that is what Svr4 says is the correct behaviour: the recycling
rules have been changed to be consistent (JMC says somewhere in the Green 
book) and any zero-length vector immediately makes the result of zero
length.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 15:08:08 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 10:08:08 -0400
Subject: Memory profiling/benchmarking
References: <19990727171758.A2622@stat1.stat.auckland.ac.nz> <379DC75D.DFFAFBC6@bank-banque-canada.ca> <19990804093220.A14758@stat1.stat.auckland.ac.nz>
Message-ID: <379F0EC8.FAB681E4@bank-banque-canada.ca>

Lyndon

>The latest DSE tar.gz file seems to be corrupt.

I think I fixed that yesterday about 20:00 GMT (which was before your
email but possibly after you downloaded it). If you've tried since then
and are still having trouble please let me know. (Also, if you are still
having trouble, the uncompressed file was not corrupted.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bogus@does.not.exist.com  Fri Jul  2 08:37:58 1999
From: bogus@does.not.exist.com ()
Date: Fri, 02 Jul 1999 03:37:58 -0400 (EDT)
Subject: Win cash & a cruise!
Message-ID: <46448.16661@ccr.dsi.uanl.mx>

Raquel's Casino, Inc. is awarding a cruise + $300 to a lucky member.  No
purchase necessary to play!

Join before month end to participate.  (You will automatically be entered
into the next drawing.)You can join at
    http://www.raquelscasino.com  (casino)
    http://www.tobet.com (sportsbook)
Raquel's online casino provides guests with a state-of-the-art gaming
experience:
    - A chance to win a cruise and $300!
    - 10% sign-up bonus!
    - Free casino software!
    - 25 casino games!
    - International sportsbook!
    - Horse racing!
    - Play for fun, or for real!
Our casino is secure, audited, private, and insured.

Thank you for your time and consideration.





*********************************************
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Jul  2 16:24:04 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 02 Jul 1999 11:24:04 -0400
Subject: changing the RNG transformation
Message-ID: <377CD994.44D698F7@bank-banque-canada.ca>

I have just circulated some code on S-new which gives a general strategy for
defining different RNGs and (normal) transformations in Splus (and R). Most of
this is already built into R, but the strategy for defining the transformation
is not. (Although a quick look at the C code suggests someone has been thinking
about it).

I would appreciate comments, especially on the transformation strategy. I expect
the code would be faster if the transformation was done in C.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Fri Jul  2 17:22:38 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Fri, 02 Jul 1999 16:22:38 +0000
Subject: Problem with plot.ts, "["
Message-ID: <377CE74E.A742EB01@wu-wien.ac.at>

There seems to be a problem with plot.ts (R Version 0.64.2)

>x<-cbind(1:10,2:11)
>x<-as.ts(x)
>plot(x)
Error: subscript (20) out of bounds, should be at most 10
>

The problem is located in "[.ts":

> x<-cbind(1:10,2:11)
> x[is.finite(x)]
 [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> x<-as.ts(x)
> x[is.finite(x)]
Error: subscript (20) out of bounds, should be at most 10
>

and there (in "[.ts") the following statement gives the error:

Browse[1]>
debug: li <- length(ind <- (1:n)[i])

However I don't understand what this part exactly does?

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Jul  2 17:44:18 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 2 Jul 1999 18:44:18 +0200 (MET DST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["} (PR#216)
Message-ID: <199907021644.SAA21974@pubhealth.ku.dk>


>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> said:

    Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
    > x<-cbind(1:10,2:11)
    > x<-as.ts(x)
    > plot(x)
    Adrian> Error: subscript (20) out of bounds, should be at most 10

This is definitely a bug
--> CC: R-bugs

ALL NOTE : This is *not* new in 0.64.2



    Adrian> The problem is located in "[.ts":

    > x<-cbind(1:10,2:11)
    > x[is.finite(x)]
    Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
    > x<-as.ts(x)
    > x[is.finite(x)]
    Adrian> Error: subscript (20) out of bounds, should be at most 10


    Adrian> and there (in "[.ts") the following statement gives the error:

    Adrian> Browse[1]>
    Adrian> debug: li <- length(ind <- (1:n)[i])

    Adrian> However I don't understand what this part exactly does?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  2 17:53:31 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Jul 1999 18:53:31 +0200
Subject: Problem with plot.ts, "["
In-Reply-To: Adrian Trapletti's message of "Fri, 02 Jul 1999 16:22:38 +0000"
References: <377CE74E.A742EB01@wu-wien.ac.at>
Message-ID: <x2vhc3at84.fsf@blueberry.kubism.ku.dk>

Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> writes:

> There seems to be a problem with plot.ts (R Version 0.64.2)
> 
> >x<-cbind(1:10,2:11)
> >x<-as.ts(x)
> >plot(x)
> Error: subscript (20) out of bounds, should be at most 10
> >
> 

If it's any consolation to you, this didn't work in 0.64.1 and not in
0.65unstable either, although it gets a different error there...

> The problem is located in "[.ts":
> 
> > x<-cbind(1:10,2:11)
> > x[is.finite(x)]
>  [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> > x<-as.ts(x)
> > x[is.finite(x)]
> Error: subscript (20) out of bounds, should be at most 10
> >
> 
> and there (in "[.ts") the following statement gives the error:

Actually, I suspect that the mistake is to do  x[is.finite(x)] in the
first place. It is used to calculate ranges for plot limits, but one
might better have used range(x,finite=TRUE) for that. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 16:52:17 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 02 Jul 1999 17:52:17 +0200 (CEST)
Subject: segfault on Sparc Linux (RH6.0)
Message-ID: <XFMail.990702175217.plummer@iarc.fr>

We are having problems building R on Red Hat Linux 6.0/Sparc.
R compiles with no problem but then it fails "make tests".
Specifically, the line

eigen(cbind(-1,c(1:2,0),0:2)) # complex values

causes a segmentation fault. Previous versions of Red Hat Linux
did not give this problem.

The eigen() function is one of the rare cases in the base library where
Fortran code is called via the .Fortran interface, which suggests to me
that the problem lies in the Fortran installation or flags.

Vin Everett, who is actually doing the compiling, has provided output
from gdb, which is given below. Any help would be greatly appreciated.

Martyn

> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
0xb1dc8 in hqr2_ ()
(gdb) 

bt gives:-
(gdb) bt
#0  0xb1dc8 in hqr2_ ()
#1  0xb4bb4 in rg_ ()
#2  0x3909c in do_dotCode (call=0x70421f64, op=0x70421b90, args=0x70679f28, 
    env=0x7067791c) at dotcode.c:386
#3  0x3fc7c in eval (e=0x70421f64, rho=0x7067791c) at eval.c:180
#4  0x41118 in do_set (call=0x70421fa0, op=0x702d4828, args=0x70421f8c, 
    rho=0x7067791c) at eval.c:761
#5  0x3fc7c in eval (e=0x70421fa0, rho=0x7067791c) at eval.c:180
#6  0x40b58 in do_begin (call=0x70421fb4, op=0x702d48c8, args=0x70421fc8, 
    rho=0x7067791c) at eval.c:588
#7  0x3fc7c in eval (e=0x70421fb4, rho=0x7067791c) at eval.c:180
#8  0x40280 in do_if (call=0x70422ef0, op=0x702d44b8, args=0x70422edc, 
    rho=0x7067791c) at eval.c:379
#9  0x3fc7c in eval (e=0x70422ef0, rho=0x7067791c) at eval.c:180
#10 0x40b58 in do_begin (call=0x70422f04, op=0x702d48c8, args=0x70422f18, 
    rho=0x7067791c) at eval.c:588
#11 0x3fc7c in eval (e=0x70422f04, rho=0x7067791c) at eval.c:180
#12 0x40280 in do_if (call=0x70423120, op=0x702d44b8, args=0x7042310c, 
    rho=0x7067791c) at eval.c:379
#13 0x3fc7c in eval (e=0x70423120, rho=0x7067791c) at eval.c:180
#14 0x40b58 in do_begin (call=0x7041eddc, op=0x702d48c8, args=0x70423134, 
    rho=0x7067791c) at eval.c:588
#15 0x3fc7c in eval (e=0x7041eddc, rho=0x7067791c) at eval.c:180
#16 0x3ffcc in applyClosure (call=0x70677868, op=0x7042347c, 
    arglist=0x706778cc, rho=0x702dca50, suppliedenv=0x702d4008) at eval.c:293
#17 0x3fcf0 in eval (e=0x70677868, rho=0x702dca50) at eval.c:189
#18 0x5370c in R_ReplConsole (rho=0x702dca50, savestack=0, browselevel=0)
    at main.c:274
#19 0x53b74 in mainloop () at main.c:465
#20 0xa0adc in main (ac=0, av=0xeffffc84) at system.c:641
#21 0x701eb8d0 in __libc_start_main () at ../sysdeps/generic/libc-start.c:78




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 18:20:22 1999
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Fri, 2 Jul 1999 19:20:22 +0200 (MET DST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "[" (PR#217)
Message-ID: <199907021720.TAA22201@pubhealth.ku.dk>

This message is in MIME format
--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Type: text/plain; charset=us-ascii

There was some discussion a while back on R-devel between Ross Ihaka,
Paul Gilbert and myself about row subsetting in time series.  I think
the consensus was that "[.ts" should not try to coerce its result
back to a time series object (which is underlying the problem here).
If you really do want to take a subseries from a regular time series,
a modified version of window.ts would do. I am attaching my
suggested modifications.
Martyn


On 02-Jul-99 maechler@stat.math.ethz.ch wrote:
> 
>>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at>
>>>>>> said:
> 
>     Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
>     > x<-cbind(1:10,2:11)
>     > x<-as.ts(x)
>     > plot(x)
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> This is definitely a bug
> --> CC: R-bugs
> 
> ALL NOTE : This is *not* new in 0.64.2
> 
> 
> 
>     Adrian> The problem is located in "[.ts":
> 
>     > x<-cbind(1:10,2:11)
>     > x[is.finite(x)]
>     Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
>     > x<-as.ts(x)
>     > x[is.finite(x)]
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> 
>     Adrian> and there (in "[.ts") the following statement gives the error:
> 
>     Adrian> Browse[1]>
>     Adrian> debug: li <- length(ind <- (1:n)[i])
> 
>     Adrian> However I don't understand what this part exactly does?
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _

----------------------------------
E-Mail: Martyn Plummer <plummer@iarc.fr>
Date: 02-Jul-99
Time: 18:02:32

This message was sent by XFMail
----------------------------------

--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Disposition: attachment; filename="tsfix"
Content-Transfer-Encoding: 7bit
Content-Description: tsfix
Content-Type: text/plain; charset=us-ascii; name=tsfix; SizeOnDisk=1838

"[.ts" <- function (x, i, j, drop = TRUE) 
{
    y <- NextMethod("[")
    if (missing(i)) 
        ts(y, start = start(x), freq = frequency(x))
    else y
}

"window.ts" <-
function (x, start, end, frequency, deltat) 
{
    x <- as.ts(x)
    xtsp <- tsp(x)
    xfreq <- xtsp[3]
    xtime <- time(x)
    ts.eps <- .Options$ts.eps
    if (missing(frequency) && missing(deltat)) 
        yfreq <- xfreq
    else if (missing(deltat)) 
        yfreq <- frequency
    else if (missing(frequency)) 
        yfreq <- 1/deltat
    if (xfreq%%yfreq < ts.eps) {
        thin <- round(xfreq/yfreq)
        yfreq <- xfreq/thin
    }
    else {
        thin <- 1
        yfreq <- xfreq
        warning("Frequency not changed")
    }
    start <- if (missing(start)) 
        xtsp[1]
    else switch(length(start), start, start[1] + (start[2] - 
        1)/xfreq, stop("Bad value for start"))
    if (start < xtsp[1]) {
        start <- xtsp[1]
        warning("start value not changed")
    }
    end <- if (missing(end)) 
        xtsp[2]
    else switch(length(end), end, end[1] + (end[2] - 1)/xfreq, 
        stop("Bad value for end"))
    if (end > xtsp[2]) {
        end <- xtsp[2]
        warning("end value not changed")
    }
    if (start > end) 
        stop("start cannot be after end")
    if (all(abs(start - xtime) > abs(start) * ts.eps)) {
        start <- xtime[(xtime > start) & ((start + 1/xfreq) > 
            xtime)]
    }
    if (all(abs(end - xtime) > abs(end) * ts.eps)) {
        end <- xtime[(xtime < end) & ((end - 1/xfreq) < xtime)]
    }
    i <- seq(trunc((start - xtsp[1]) * xfreq + 1.5), trunc((end - 
        xtsp[1]) * xfreq + 1.5), by = thin)
    y <- if (is.matrix(x)) 
        x[i, , drop = FALSE]
    else x[i]
    ystart <- xtime[i[1]]
    yend <- xtime[i[length(i)]]
    tsp(y) <- c(ystart, yend, yfreq)
    y
}


--_=XFMail.1.3.p0.Linux:990702182137:16900=_--
End of MIME message

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Jul  2 17:21:37 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 02 Jul 1999 18:21:37 +0200 (CEST)
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["
In-Reply-To: <199907021644.SAA21974@pubhealth.ku.dk>
Message-ID: <XFMail.990702182137.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Type: text/plain; charset=us-ascii

There was some discussion a while back on R-devel between Ross Ihaka,
Paul Gilbert and myself about row subsetting in time series.  I think
the consensus was that "[.ts" should not try to coerce its result
back to a time series object (which is underlying the problem here).
If you really do want to take a subseries from a regular time series,
a modified version of window.ts would do. I am attaching my
suggested modifications.
Martyn


On 02-Jul-99 maechler@stat.math.ethz.ch wrote:
> 
>>>>>> On Fri, 02 Jul 1999, Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at>
>>>>>> said:
> 
>     Adrian> There seems to be a problem with plot.ts (R Version 0.64.2)
>     > x<-cbind(1:10,2:11)
>     > x<-as.ts(x)
>     > plot(x)
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> This is definitely a bug
> --> CC: R-bugs
> 
> ALL NOTE : This is *not* new in 0.64.2
> 
> 
> 
>     Adrian> The problem is located in "[.ts":
> 
>     > x<-cbind(1:10,2:11)
>     > x[is.finite(x)]
>     Adrian> [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
>     > x<-as.ts(x)
>     > x[is.finite(x)]
>     Adrian> Error: subscript (20) out of bounds, should be at most 10
> 
> 
>     Adrian> and there (in "[.ts") the following statement gives the error:
> 
>     Adrian> Browse[1]>
>     Adrian> debug: li <- length(ind <- (1:n)[i])
> 
>     Adrian> However I don't understand what this part exactly does?
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _

----------------------------------
E-Mail: Martyn Plummer <plummer@iarc.fr>
Date: 02-Jul-99
Time: 18:02:32

This message was sent by XFMail
----------------------------------

--_=XFMail.1.3.p0.Linux:990702182137:16900=_
Content-Disposition: attachment; filename="tsfix"
Content-Transfer-Encoding: 7bit
Content-Description: tsfix
Content-Type: text/plain; charset=us-ascii; name=tsfix; SizeOnDisk=1838

"[.ts" <- function (x, i, j, drop = TRUE) 
{
    y <- NextMethod("[")
    if (missing(i)) 
        ts(y, start = start(x), freq = frequency(x))
    else y
}

"window.ts" <-
function (x, start, end, frequency, deltat) 
{
    x <- as.ts(x)
    xtsp <- tsp(x)
    xfreq <- xtsp[3]
    xtime <- time(x)
    ts.eps <- .Options$ts.eps
    if (missing(frequency) && missing(deltat)) 
        yfreq <- xfreq
    else if (missing(deltat)) 
        yfreq <- frequency
    else if (missing(frequency)) 
        yfreq <- 1/deltat
    if (xfreq%%yfreq < ts.eps) {
        thin <- round(xfreq/yfreq)
        yfreq <- xfreq/thin
    }
    else {
        thin <- 1
        yfreq <- xfreq
        warning("Frequency not changed")
    }
    start <- if (missing(start)) 
        xtsp[1]
    else switch(length(start), start, start[1] + (start[2] - 
        1)/xfreq, stop("Bad value for start"))
    if (start < xtsp[1]) {
        start <- xtsp[1]
        warning("start value not changed")
    }
    end <- if (missing(end)) 
        xtsp[2]
    else switch(length(end), end, end[1] + (end[2] - 1)/xfreq, 
        stop("Bad value for end"))
    if (end > xtsp[2]) {
        end <- xtsp[2]
        warning("end value not changed")
    }
    if (start > end) 
        stop("start cannot be after end")
    if (all(abs(start - xtime) > abs(start) * ts.eps)) {
        start <- xtime[(xtime > start) & ((start + 1/xfreq) > 
            xtime)]
    }
    if (all(abs(end - xtime) > abs(end) * ts.eps)) {
        end <- xtime[(xtime < end) & ((end - 1/xfreq) < xtime)]
    }
    i <- seq(trunc((start - xtsp[1]) * xfreq + 1.5), trunc((end - 
        xtsp[1]) * xfreq + 1.5), by = thin)
    y <- if (is.matrix(x)) 
        x[i, , drop = FALSE]
    else x[i]
    ystart <- xtime[i[1]]
    yend <- xtime[i[length(i)]]
    tsp(y) <- c(ystart, yend, yfreq)
    y
}


--_=XFMail.1.3.p0.Linux:990702182137:16900=_--
End of MIME message
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  2 18:27:58 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Jul 1999 19:27:58 +0200
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Martyn Plummer's message of "Fri, 02 Jul 1999 17:52:17 +0200 (CEST)"
References: <XFMail.990702175217.plummer@iarc.fr>
Message-ID: <x2u2rnarmp.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> Vin Everett, who is actually doing the compiling, has provided output
> from gdb, which is given below. Any help would be greatly appreciated.
> 
> Martyn
> 
> > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0xb1dc8 in hqr2_ ()
> (gdb) 
> 
> bt gives:-
> (gdb) bt
> #0  0xb1dc8 in hqr2_ ()
> #1  0xb4bb4 in rg_ ()

You kind of forgot to tell us which version of R and which
compiler.... 

The first thing I'd try would be to change the FFLAGS line in Makeconf
to -g and recompile eigen.o. That way gdb would at least tell you
exactly where it crashes.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Mon Jul  5 09:21:44 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Mon, 05 Jul 1999 08:21:44 +0000
Subject: Problem with plot.ts, "["
References: <377CE74E.A742EB01@wu-wien.ac.at> <x2vhc3at84.fsf@blueberry.kubism.ku.dk>
Message-ID: <37806B18.F08AFB2D@wu-wien.ac.at>

Peter Dalgaard BSA wrote:

> Adrian Trapletti <Adrian.Trapletti@wu-wien.ac.at> writes:
>
> > There seems to be a problem with plot.ts (R Version 0.64.2)
> >
> > >x<-cbind(1:10,2:11)
> > >x<-as.ts(x)
> > >plot(x)
> > Error: subscript (20) out of bounds, should be at most 10
> > >
> >
>
> If it's any consolation to you, this didn't work in 0.64.1 and not in
> 0.65unstable either, although it gets a different error there...
>
> > The problem is located in "[.ts":
> >
> > > x<-cbind(1:10,2:11)
> > > x[is.finite(x)]
> >  [1]  1  2  3  4  5  6  7  8  9 10  2  3  4  5  6  7  8  9 10 11
> > > x<-as.ts(x)
> > > x[is.finite(x)]
> > Error: subscript (20) out of bounds, should be at most 10
> > >
> >
> > and there (in "[.ts") the following statement gives the error:
>
> Actually, I suspect that the mistake is to do  x[is.finite(x)] in the
> first place. It is used to calculate ranges for plot limits, but one
> might better have used range(x,finite=TRUE) for that.

In fact, that works fine and does not affect the "[.ts" method.

Concerning "[.ts" method, I think the user expects that it works
like the "[" for vectors and matrices with further setting the
tsp attributes correctly. Hence, also for me the actual behaviour
is more a bug than a feature...

thanks

Adrian

>
>
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul  5 14:27:12 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 05 Jul 1999 09:27:12 -0400
Subject: Problem with plot.ts, "["
References: <377CE74E.A742EB01@wu-wien.ac.at> <x2vhc3at84.fsf@blueberry.kubism.ku.dk> <37806B18.F08AFB2D@wu-wien.ac.at>
Message-ID: <3780B2AD.26375290@bank-banque-canada.ca>

>Concerning "[.ts" method, I think the user expects that it works
>like the "[" for vectors and matrices with further setting the
>tsp attributes correctly.

The problem is that for any complicated subset in the time dimesion it
becomes very difficult to decide what the correct tsp attributes should
be. I think after previous discussions we agreed that window should be
used to preserve attributes in the time dimension and "[.ts" should drop
any ts attributes. In the non-time dimension it makes more sense to
preserve ts attributes, but S does not, as I recall. I'm not sure what
the status of this change is, but I don't think the behaviour is the
same in 0.65 as it was in 0.64.1.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From vin.everett@mrc-bsu.cam.ac.uk  Mon Jul  5 16:56:12 1999
From: vin.everett@mrc-bsu.cam.ac.uk (Vin Everett)
Date: Mon, 05 Jul 1999 16:56:12 +0100
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Your message of "02 Jul 1999 19:27:58 +0200."
 <x2u2rnarmp.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907051556.QAA24294@bernstein.mrc-bsu.cam.ac.uk>


Hello Peter,

I hope this is more helpful ?

-g flag, using g77 version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release) (from FSF-g77 version 0.5.24-19981002)

And srpms R-base-0.64.1-6.src.rpm


Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) bt
#0  hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
#1  0xb4c10 in rg_ (nm=0x70d99fd0, n=0x70d99fc8, a=0x70d99f80, wr=0x70d99f68, 
    wi=0x70d99f50, matz=0x70d99f48, z=0x70d99f00, iv1=0x70d99ef0, 
    fv1=0x70d99ed8, ierr=0x70d99ed0) at eigen.f:3263
#2  0x3909c in do_dotCode (call=0x70421f64, op=0x70421b90, args=0x70679f28, 
    env=0x7067791c) at dotcode.c:386
#3  0x3fc7c in eval (e=0x70421f64, rho=0x7067791c) at eval.c:180
#4  0x41118 in do_set (call=0x70421fa0, op=0x702d4828, args=0x70421f8c, 
    rho=0x7067791c) at eval.c:761
#5  0x3fc7c in eval (e=0x70421fa0, rho=0x7067791c) at eval.c:180
#6  0x40b58 in do_begin (call=0x70421fb4, op=0x702d48c8, args=0x70421fc8, 
    rho=0x7067791c) at eval.c:588
#7  0x3fc7c in eval (e=0x70421fb4, rho=0x7067791c) at eval.c:180
#8  0x40280 in do_if (call=0x70422ef0, op=0x702d44b8, args=0x70422edc, 
    rho=0x7067791c) at eval.c:379
#9  0x3fc7c in eval (e=0x70422ef0, rho=0x7067791c) at eval.c:180
#10 0x40b58 in do_begin (call=0x70422f04, op=0x702d48c8, args=0x70422f18, 
    rho=0x7067791c) at eval.c:588
#11 0x3fc7c in eval (e=0x70422f04, rho=0x7067791c) at eval.c:180
#12 0x40280 in do_if (call=0x70423120, op=0x702d44b8, args=0x7042310c, 
    rho=0x7067791c) at eval.c:379
#13 0x3fc7c in eval (e=0x70423120, rho=0x7067791c) at eval.c:180
#14 0x40b58 in do_begin (call=0x7041eddc, op=0x702d48c8, args=0x70423134, 
    rho=0x7067791c) at eval.c:588
#15 0x3fc7c in eval (e=0x7041eddc, rho=0x7067791c) at eval.c:180
#16 0x3ffcc in applyClosure (call=0x70677868, op=0x7042347c, 
    arglist=0x706778cc, rho=0x702dca50, suppliedenv=0x702d4008) at eval.c:293
#17 0x3fcf0 in eval (e=0x70677868, rho=0x702dca50) at eval.c:189
#18 0x53768 in R_ReplConsole (rho=0x702dca50, savestack=0, browselevel=0)
    at main.c:274
#19 0x53bd0 in mainloop () at main.c:465
#20 0xa0b38 in main (ac=0, av=0xeffffc84) at system.c:641
#21 0x701eb8d0 in __libc_start_main () at ../sysdeps/generic/libc-start.c:78


Cheers Vin

-------------------------------------------------------------------
Vin Everett                   email:  vin.everett@mrc-bsu.cam.ac.uk
Medical Research Council      voice:  +44 (0) 1223 330381 
Biostatistics Unit            fax:    +44 (0) 1223 330383 
Cambridge                     mobile: +44 (0) 468 828238 
Key fingerprint =  69 CE C7 59 9B 7C AB 57  B0 B5 47 2A 1E 99 49 30
-------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Jul  5 17:43:20 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 05 Jul 1999 18:43:20 +0200
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Vin Everett's message of "Mon, 05 Jul 1999 16:56:12 +0100"
References: <199907051556.QAA24294@bernstein.mrc-bsu.cam.ac.uk>
Message-ID: <x2so73yrmf.fsf@blueberry.kubism.ku.dk>

Vin Everett <vin.everett@mrc-bsu.cam.ac.uk> writes:

> Hello Peter,
> 
> I hope this is more helpful ?
> 
> -g flag, using g77 version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release) (from FSF-g77 version 0.5.24-19981002)
> 
> And srpms R-base-0.64.1-6.src.rpm
> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90, h=0x70d99f80, 
>     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
>     at eigen.f:2120
> 2120                   RA = RA + H(I,J) * H(J,NA)
> Current language:  auto; currently fortran
> (gdb) bt

Fine, now what is the value of i,j, and na at that point? (the p
function in gdb) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From vin.everett@mrc-bsu.cam.ac.uk  Tue Jul  6 10:53:59 1999
From: vin.everett@mrc-bsu.cam.ac.uk (Vin Everett)
Date: Tue, 06 Jul 1999 10:53:59 +0100
Subject: segfault on Sparc Linux (RH6.0)
In-Reply-To: Your message of "05 Jul 1999 18:43:20 +0200."
 <x2so73yrmf.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907060953.KAA01225@bernstein.mrc-bsu.cam.ac.uk>


Hi Peter, sorry for the tardiness, I have been in a meeting the gdb p option 
provides no history.

Cheers Vin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Wed Jul  7 06:15:02 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed, 7 Jul 1999 07:15:02 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199907070515.HAA10215@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 192 *
Subject: dev.print aspect ratio
From: wsi@gcal.ac.uk
Date: Tue, 11 May 1999 13:43:50 +0200 (MET DST)
--Difficulty getting a square plot.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.
* PR# 211 *
Subject: readline/history size
From: seniorr@teleport.com
Date: Tue, 15 Jun 1999 00:08:59 +0200 (MET DST)
--Limitation of history size. Kurt cannot reproduce. 
--Depends on libreadline version??

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 118 *
Subject: Function parsing
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 10 Feb 1999 13:42:01 +0000 (GMT)
--comment placement.

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

* PR# 21 *
Subject: Restoring large image files
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 21 Aug 1998 13:29:16 -0000 ()
--Request to change in error conditions in R_InitialData. Could be done, but
--at present initial loads are not distinguished from load("file") calls. 

Directory:  System-specific

* PR# 145 *
Subject: R-0.63.3 package on IRIX 6.5 machine
From: Jayshree Sarma <jsarma@cs.gmu.edu>
Date: Tue, 23 Mar 1999 16:54:20 -0500 (EST)
* PR# 163 *
Subject: IRIX compile
From: mtim@farm.ecs.umass.edu
Date: Sat, 10 Apr 1999 19:35:43 +0200
* PR# 196 *
Subject: R 0.64 and -release fails to build on DU4.0
From: Leif Johansson <leifj@matematik.su.se>
Date: Fri, 14 May 1999 12:32:14 +0200
* PR# 201 *
Subject: RedHat Linux 6.0 Problems
From: jacobm@magnet.drcmr.dk
Date: Wed, 2 Jun 1999 10:58:45 +0200 (MET DST)
* PR# 208 *
Subject: R correct g77 flags for Linux/Alpha
From: Naoki Takebayashi <ntakebay@bio.indiana.edu>
Date: Tue, 8 Jun 1999 19:12:03 -0500 (EST)
* PR# 209 *
Subject: Compilation fails
From: beimfohr@statistik.uni-dortmund.de
Date: Thu, 10 Jun 1999 13:52:01 +0200 (MET DST)
* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 216 *
Subject: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 2 Jul 1999 18:45:20 +0200
* PR# 217 *
Subject: RE: Bug in "[.ts" for multivariate ts {Problem with plot.ts, "["
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 02 Jul 1999 18:21:37 +0200 (CEST)
Date: 02-Jul-99
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jperez@cesma.usb.ve  Wed Jul  7 15:23:54 1999
From: jperez@cesma.usb.ve (jperez@cesma.usb.ve)
Date: Wed, 7 Jul 1999 16:23:54 +0200 (MET DST)
Subject: Bug on sample (PR#219)
Message-ID: <199907071423.QAA19825@pubhealth.ku.dk>

Full_Name: Jose M. Perez
Version: 0.64.2
OS: Linux/x86
Submission from: (NULL) (159.90.200.68)


sample(1,1,prob=c(1))
Causes a core dump.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jperez@cesma.usb.ve  Wed Jul  7 15:23:33 1999
From: jperez@cesma.usb.ve (jperez@cesma.usb.ve)
Date: Wed, 7 Jul 1999 16:23:33 +0200 (MET DST)
Subject: Bug on sample (PR#218)
Message-ID: <199907071423.QAA19811@pubhealth.ku.dk>

Full_Name: Jose M. Perez
Version: 0.61.2
OS: Linux/x86
Submission from: (NULL) (159.90.200.68)


sample(1,1,prob=c(1))
Causes a core dump.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 15:45:41 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 16:45:41 +0200
Subject: Bug on sample (PR#219)
In-Reply-To: jperez@cesma.usb.ve's message of "Wed, 7 Jul 1999 16:23:54 +0200 (MET DST)"
References: <199907071423.QAA19825@pubhealth.ku.dk>
Message-ID: <x2oghobjsa.fsf@blueberry.kubism.ku.dk>

jperez@cesma.usb.ve writes:

> sample(1,1,prob=c(1))
> Causes a core dump.

...confirmed. prob=1 is not necessary, sample(1,1,,.1) crashes too.

Cause: revsort() does horrible things if n <= 1. Will fix.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Jul  7 17:35:36 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 7 Jul 1999 18:35:36 +0200 (CEST)
Subject: Almost succesfull build on AIX
Message-ID: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>


Hi,

Kurt Hornik and myself have an almost successful build of R on AIX 
including dynamic loading of libraries ... which fails make check :-(
Anyway, as we have no AIX experience at all, maybe somebody else knows
what's going on.

Here's the problem:

> 1/0
[1]INF
> is.finite(1/0)
[1] TRUE

R was built using the flags included below, gcc version is 2.7.2. Does
anybody with experience on AIX know what's going on (the all uppercase
INF looks somewhat suspicious).

If you want to give it a try, in tomorrow's devel snapshot from CRAN
all configure/make scripts should be sufficent for a usual compile,
i.e., simply say
	configure; make
using GNU make and the install-sh from the tools directory (the
installbsd on our AIX machine fails).

Best,
Fritz

**********************************************************

> version
           _                           
platform   rs6000-ibm-aix4.2.1.0       
arch       rs6000                      
os         aix4.2.1.0                  
system     rs6000, aix4.2.1.0          
status     Under development (unstable)
status.rev 0                           
major      0                           
minor      65.0                        
year       1999                        
month      July                        
day        08                          
language   R                           


**********************************************************


PACKAGE = R
VERSION = 0.65.0

AR = ar
BLAS = 
CC = gcc
CFLAGS = -g -O2
CPICFLAGS = -fPIC
CPPFLAGS = 
DEFS = -DHAVE_CONFIG_H
DLLFLAGS = -bdynamic -bE:$(top_builddir)/etc/R.exp -bM:SRE -lc -lm
DVIPS = /usr/local/bin/dvips
FC = f77
FFLAGS = 
FLIBS = -lblas  -L/usr/local/lib -lxlf90 -lxlf -lm
FPICFLAGS = -fPIC
F2C = 
F2CFLAGS = 
GNOMEUI_LIBS = 
GNOME_LIBDIR = 
GNOME_INCLUDEDIR = 
INSTALL = /tmp/fl/R/tools/install-sh -c
INSTALL_DATA = ${INSTALL} -m 644
INSTALL_PROGRAM = ${INSTALL}
INSTALL_DIR = ${INSTALL} -d
LATEX = /usr/local/bin/latex
LDCMD = f77
LDFLAGS = 
LIBS = -ldl -ltermcap -lm 
LN_S = ln -s
MAKEINDEX = /usr/local/bin/makeindex
MKINSTALLDIRS = $(top_srcdir)/tools/mkinstalldirs
R_XTRA_CFLAGS = 
R_XTRA_CPPFLAGS = -I. -I../include -I$(top_srcdir)/src/include
R_XTRA_FFLAGS = 
R_XTRA_LIBS = 
RANLIB = ranlib
SHELL = /bin/sh
SHLIBEXT = so
SHLIBLD = f77
SHLIBLDFLAGS = -bM:SRE -H512 -T512 -bnoentry -bexpall       -bI:$(R_HOME)/etc/R.
exp -lc -lm
TAR = tar
X_CFLAGS = 
X_LIBS =  -lX11
X_PRE_LIBS = 
X_EXTRA_LIBS = 
YACC = bison -y
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul  7 18:00:11 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 7 Jul 1999 19:00:11 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>
References: <14211.33240.951879.123516@galadriel.ci.tuwien.ac.at>
Message-ID: <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>

>>>>> Friedrich Leisch writes:

> Hi,

> Kurt Hornik and myself have an almost successful build of R on AIX 
> including dynamic loading of libraries ... which fails make check :-(
> Anyway, as we have no AIX experience at all, maybe somebody else knows
> what's going on.

> Here's the problem:

>> 1/0
> [1]INF
>> is.finite(1/0)
> [1] TRUE

> R was built using the flags included below, gcc version is 2.7.2. Does
> anybody with experience on AIX know what's going on (the all uppercase
> INF looks somewhat suspicious).

> If you want to give it a try, in tomorrow's devel snapshot from CRAN
> all configure/make scripts should be sufficent for a usual compile,
> i.e., simply say
> 	configure; make
> using GNU make and the install-sh from the tools directory (the
> installbsd on our AIX machine fails).

If I may add.  Building for me only works with LDCMD and SHLIBLD as

	f77
or
	cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

It did not work with

	ld (gives an exec format error in the main binary)
or
	gcc (cannot find libgcc.a???)

I am not sure up to what extend this is a problem with AIX in general or
the specific system Fritz and I have access to, which in particular has
gcc built 3 years ago for AIX 3.something.

Perhaps someone knows more about this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.princeton.edu  Wed Jul  7 20:43:33 1999
From: ben@eno.princeton.edu (Ben Bolker)
Date: Wed, 7 Jul 1999 15:43:33 -0400 (EDT)
Subject: superscript -,+?
Message-ID: <Pine.SUN.3.95.990707153807.18452A-100000@paca>


  In Version 0.64.1  (May 8, 1999), Solaris 2.5.1,

   expression(theta^{-})
      
      and

   expression(theta^{+})

 (and the equivalent subscripts) give syntax errors.

  (Superscript or subscripts of numbers, letters, or "+1" or "-1" all
work.)

  Anyone have a workaround or a patch?
  Or should I just use psfrag as god intended?

  Ben


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.princeton.edu  Wed Jul  7 20:52:47 1999
From: ben@eno.princeton.edu (Ben Bolker)
Date: Wed, 7 Jul 1999 15:52:47 -0400 (EDT)
Subject: answering my own question
Message-ID: <Pine.SUN.3.95.990707155129.18476A-100000@paca>


  expression(theta^{"+"})
  expression(theta^{"-"})
  expression({theta^{"+"}}(mu)})

  etc., work fine (once I actually *thought* about what the problem was)

 Ben B.

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Wed Jul  7 21:39:44 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Wed, 07 Jul 1999 16:39:44 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Wed, 07 Jul 1999 19:00:11 EDT."
 <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>
Message-ID: <199907072039.QAA29250@infiniti.ece.cmu.edu>


"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>> Here's the problem:
>>> 1/0
>> [1]INF
>>> is.finite(1/0)
>> [1] TRUE

Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
program.  Should this not result in a floating point exception?

>> R was built using the flags included below, gcc version is 2.7.2. Does
>> anybody with experience on AIX know what's going on (the all uppercase
>> INF looks somewhat suspicious).

Because it's a return value, not the R string "Inf".  Wild guess,
lemme think about it.

Kurt> If I may add.  Building for me only works with LDCMD and SHLIBLD as
Kurt> 
Kurt> f77
Kurt> or
Kurt> cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

Yes, there is still something wrong with the DLLFLAGS.  (Which also
shows up when you try to link local libraries (like a private copy of
the readline lib).)   I've played a little more with the way R.exp is
generated.  Let me try it on 64.2 and 65.

Kurt> It did not work with
Kurt> ld (gives an exec format error in the main binary)

My experience is that if I compile the main function with gcc then I
have to link with gcc, otherwise it can't find .__main.  Which leads
to:

Kurt> gcc (cannot find libgcc.a???)
Yep and hmm.  Arne found that you can say "gcc --print-libgcc-file-name" and
then gcc actually does that.  You can add the result of the command on
the link line.  (If however gcc never finds libgcc.a then you're in
deep trouble.  Check wether you can find gcc's spec file.)

Kurt> I am not sure up to what extend this is a problem with AIX in general or
Kurt> the specific system Fritz and I have access to, which in particular has
Kurt> gcc built 3 years ago for AIX 3.something.

Probably something with AIX in general.

BTW, do you not get compiler errors about blkcnt not being defined
when you compile with gcc?  So far, I had to patch most programs
because there is a bug with the standard include files.

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 22:17:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 23:17:55 +0200
Subject: [R] superscript -,+?
In-Reply-To: Ben Bolker's message of "Wed, 7 Jul 1999 15:43:33 -0400 (EDT)"
References: <Pine.SUN.3.95.990707153807.18452A-100000@paca>
Message-ID: <x2lncsupks.fsf@blueberry.kubism.ku.dk>

Ben Bolker <ben@eno.princeton.edu> writes:

>   In Version 0.64.1  (May 8, 1999), Solaris 2.5.1,
> 
>    expression(theta^{-})
>       
>       and
> 
>    expression(theta^{+})
> 
>  (and the equivalent subscripts) give syntax errors.
> 
>   (Superscript or subscripts of numbers, letters, or "+1" or "-1" all
> work.)
> 
>   Anyone have a workaround or a patch?
>   Or should I just use psfrag as god intended?
> 

Both theta^"+" and theta^+{} seem to work ok. The thing to remember is
that + is an operator so if it is used in an expression, it needs to
have something to operate on, or you need to explicitly use it as a
character.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul  7 22:35:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Jul 1999 23:35:37 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: Thomas Vogels's message of "Wed, 07 Jul 1999 16:39:44 -0400"
References: <199907072039.QAA29250@infiniti.ece.cmu.edu>
Message-ID: <x2k8scuora.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 
> >> Here's the problem:
> >>> 1/0
> >> [1]INF
> >>> is.finite(1/0)
> >> [1] TRUE
> 
> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
> program.  Should this not result in a floating point exception?

Not according to IEEE specs (but integer divide by zero is generally
unmaskable). The interesting thing is that is.finite returns TRUE on
the result, and the printing also suggests that the infinite value is
not recognised internally (if it were, it would get printed as 
> 1/0
[1] Inf
)

It would be nice to see the actual bit pattern of 1/.0. Could one of
you do something like

	x = 1/.0;
	printf("%0x,%0x\n", ((int *) &x)[0], ((int *) &x)[1]);

or whatever other obfuscation works on AIX...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kriszti@a2a00996.direct.bconnected.net  Thu Jul  8 06:55:43 1999
From: kriszti@a2a00996.direct.bconnected.net (kriszti@a2a00996.direct.bconnected.net)
Date: Thu, 8 Jul 1999 07:55:43 +0200 (MET DST)
Subject: Bad Units Bug in barplot with pictex output device. (PR#220)
Message-ID: <199907080555.HAA22260@pubhealth.ku.dk>

Dear Bug Team:

I encountered a bug when trying to make a barplot with the pictex
output device.

The following commands demonstrate the bug:

-----------------------------------------------
> errors <- c(3.08, 35.38, 33.85, 20.00,  7.69)
> errors
[1]  3.08 35.38 33.85 20.00  7.69
> pictex()
> barplot(errors)
Error: Bad units specified in GConvert, please report!
> 
-----------------------------------------------

Here is my R version information:

-----------------------------------------------
> Version()
$platform
[1] "i386-unknown-freebsd2.2.7"

$arch
[1] "i386"

$os
[1] "freebsd2.2.7"

$system
[1] "i386, freebsd2.2.7"

$status
[1] ""

$status.rev
[1] "0"

$major
[1] "0"

$minor
[1] "62.2"

$year
[1] "1998"

$month
[1] "July"

$day
[1] "10"

$language
[1] "R"

---------------------------------------------------

Thank you very much for all your good work on R!

Best regards,

Krisztina Vasarhelyi
Anthropologisches Institut der
Universitaet Zuerich
krva@aim.unizh.ch

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul  8 07:34:00 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 8 Jul 1999 08:34:00 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907072039.QAA29250@infiniti.ece.cmu.edu>
References: <14211.34715.669060.317780@aragorn.ci.tuwien.ac.at>
 <199907072039.QAA29250@infiniti.ece.cmu.edu>
Message-ID: <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>> Here's the problem:
>>>> 1/0
>>> [1]INF
>>>> is.finite(1/0)
>>> [1] TRUE

Ah ... but FRITZ wrote that ...

> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
> program.  Should this not result in a floating point exception?

>>> R was built using the flags included below, gcc version is 2.7.2. Does
>>> anybody with experience on AIX know what's going on (the all uppercase
>>> INF looks somewhat suspicious).

> Because it's a return value, not the R string "Inf".  Wild guess,
> lemme think about it.

Kurt> If I may add.  Building for me only works with LDCMD and SHLIBLD as
Kurt> 
Kurt> f77
Kurt> or
Kurt> cc with `-lc -lm' added to DLLFLAGS and SHLIBLDFLAGS

> Yes, there is still something wrong with the DLLFLAGS.  (Which also
> shows up when you try to link local libraries (like a private copy of
> the readline lib).)   I've played a little more with the way R.exp is
> generated.  Let me try it on 64.2 and 65.

Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!

Kurt> It did not work with
Kurt> ld (gives an exec format error in the main binary)

> My experience is that if I compile the main function with gcc then I
> have to link with gcc, otherwise it can't find .__main.  Which leads
> to:

Kurt> gcc (cannot find libgcc.a???)

> Yep and hmm.  Arne found that you can say "gcc
> --print-libgcc-file-name" and then gcc actually does that.  You can
> add the result of the command on the link line.  (If however gcc never
> finds libgcc.a then you're in deep trouble.  Check wether you can find
> gcc's spec file.)

The specs file is fine.  My question is, is that a known gcc problem on
AIX or is that due to the rather outdated version of gcc we have?  If it
is a general problem, I can easily add to DLLFLAGS.

Kurt> I am not sure up to what extend this is a problem with AIX in general or
Kurt> the specific system Fritz and I have access to, which in particular has
Kurt> gcc built 3 years ago for AIX 3.something.

> Probably something with AIX in general.

> BTW, do you not get compiler errors about blkcnt not being defined
> when you compile with gcc?  So far, I had to patch most programs
> because there is a bug with the standard include files.

No.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 08:27:39 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 09:27:39 +0200
Subject: Bad Units Bug in barplot with pictex output device. (PR#220)
In-Reply-To: <199907080555.HAA22260@pubhealth.ku.dk>
 (kriszti@a2a00996.direct.bconnected.net)
References: <199907080555.HAA22260@pubhealth.ku.dk>
Message-ID: <199907080727.JAA21615@sophie.ethz.ch>

Dear Krisztina
The bug you reported has been fixed a while ago.

you "only" need to upgrade your version of R.
As you said it's 0.62.2 of July 1998.

Just get 0.64.2 of July 1999...
from any CRAN mirror, ie. in your case from  http://stat.ethz.ch/CRAN/

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 09:24:15 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 10:24:15 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: <x2k8scuora.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 07 Jul 1999 23:35:37 +0200)
References: <199907072039.QAA29250@infiniti.ece.cmu.edu> <x2k8scuora.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907080824.KAA26378@sophie.ethz.ch>

>>>>> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:
    >> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

      > >> Here's the problem:
      > >>> 1/0
      > >> [1]INF
      > >>> is.finite(1/0)
      > >> [1] TRUE

    >> Much to my surprise, a 'printf ("%g", 1/.0)' prints INF in a C
    >> program.  Should this not result in a floating point exception?

    PD> Not according to IEEE specs (but integer divide by zero is
    PD> generally unmaskable). The interesting thing is that is.finite
    PD> returns TRUE on the result, and the printing also suggests that the
    PD> infinite value is not recognised internally (if it were, it would
    PD> get printed as
    >> 1/0
    PD> [1] Inf )

    PD> It would be nice to see the actual bit pattern of 1/.0. Could one
    PD> of you do something like

    PD>    x = 1/.0; printf("%0x,%0x\n", ((int *) &x)[0], ((int *) &x)[1]);

    PD> or whatever other obfuscation works on AIX...

I've done more than Peter requested;
namely, the "finite" probing has always been a big problem on AIX,
and I rediscovered my old testing code -- which I enhanced with Peter's HEX
dump proposal:
  [everything in  ftp://stat.ethz.ch/U/maechler/R/AIX-finite-tst.tar.gz !]

    #include <stdio.h>
    #include <math.h>

    #ifdef AIX
    # include <fp.h>
    #endif

    main() {
      double x,x2,x3;
      printf("finite(1.0)= %d (=1, hopefully)\n", finite(1.0));
      x=1./0.; x2= (-1.)/0.;  x3 = 0./0.;
      printf("Inf := 1/0 = %f;\t -Inf := -1/0 = %f;\t NaN:= 0/0 = %f\n",x, x2, x3);
      printf("finite(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
	     finite(x),finite(x2),finite(x3));
      printf("Now the `bits':\n");
      printf(" Inf : %0x,%0x\n", ((int *) &x )[0], ((int *) &x )[1]);
      printf("-Inf : %0x,%0x\n", ((int *) &x2)[0], ((int *) &x2)[1]);
      printf(" NaN : %0x,%0x\n", ((int *) &x3)[0], ((int *) &x3)[1]);

    #ifdef AIX
      printf("FINITE(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
	     FINITE(x),FINITE(x2),FINITE(x3));
    #endif
    }

------------
And I have this in my Makefile  [also available on Web, s.above]

    ## on AIX (percol)
    #CFLAGS = -D_XOPEN_SOURCE -DAIX
    # better for R (defines cosh(.)  AND fd_set(.) (sys/time.h):
    CFLAGS = -D_XOPEN_SOURCE_EXTENDED=1 -DAIX

My Conclusions: 

  - Only if I use these CFLAGS does  finite work properly.
  - The bit pattern are compiler-independent for +-Inf, but NOT for NaN :

Here is gcc [with above CFLAGS],  gcc version 2.7.2.3,  output:
----------------------------------
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;	 -Inf := -1/0 = -INF;	 NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
----------------------------------

xlc (the native AIX C compiler) gives the same BUT for the NaN bit pattern
where it has

 NaN : 7ff80000,0

------------------------

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  8 11:36:36 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 8 Jul 1999 12:36:36 +0200
Subject: Almost succesfull build on AIX
In-Reply-To: <199907080824.KAA26378@sophie.ethz.ch> (message from Martin
 Maechler on Thu, 8 Jul 1999 10:24:15 +0200)
References: <199907072039.QAA29250@infiniti.ece.cmu.edu> <x2k8scuora.fsf@blueberry.kubism.ku.dk> <199907080824.KAA26378@sophie.ethz.ch>
Message-ID: <199907081036.MAA02797@sophie.ethz.ch>

To add to my last E-mail  
where I said more-or-less

      ``we need  CFLAGS   -D_XOPEN_SOURCE_EXTENDED=1  

        for finite() and things to work ''

I now have put this into  config.site,
but then the compilation breaks when trying to compile 
src/unix/sock.c

it seems because of broken combination of header files 
   /usr/include/netinet/in_systm.h
   /usr/include/netinet/tcp.h
   /usr/include/netinet/ip.h

Maybe,  sock.c  {and further files?}
use other CFLAGS explicitly ?

Here the beginning of the long compilation error messages:

 gcc -I. -I../include -I../../src/include   -DHAVE_CONFIG_H  -g -O2 -D_XOPEN_SOURCE_EXTENDED=1 -c sock.c -o sock.o

 In file included from /usr/include/netinet/ip.h:75,
		  from /usr/include/netinet/tcp.h:72,
		  from sock.c:25:
 /usr/include/netinet/in_systm.h:79: parse error before `n_short'
 /usr/include/netinet/in_systm.h:79: warning: data definition has no type or storage class
 /usr/include/netinet/in_systm.h:80: parse error before `n_long'
 /usr/include/netinet/in_systm.h:80: warning: data definition has no type or storage class
 /usr/include/netinet/in_systm.h:82: parse error before `n_time'
 /usr/include/netinet/in_systm.h:82: warning: data definition has no type or storage class
 In file included from /usr/include/netinet/tcp.h:72,
		  from sock.c:25:
 /usr/include/netinet/ip.h:104: parse error before `u_long'
 /usr/include/netinet/ip.h:104: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:104: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:114: parse error before `ip_xhl'
 /usr/include/netinet/ip.h:114: warning: no semicolon at end of struct or union
 /usr/include/netinet/ip.h:119: warning: data definition has no type or storage class
 /usr/include/netinet/ip.h:120: parse error before `}'
 /usr/include/netinet/ip.h:120: warning: data definition has no type or storage class
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul  8 14:52:10 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Jul 1999 15:52:10 +0200
Subject: r-bugs going down temporarily (upgrade)
Message-ID: <x27lobw8ol.fsf@blueberry.kubism.ku.dk>

I'll start upgrading the computer running the r-bugs web server in a
moment (to RedHat 6.0). This *should* be a relatively painless
operation, but you never know... Email to r-bugs is handled by a
different machine and should remain unaffected.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Jul  8 19:05:43 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 08 Jul 1999 14:05:43 -0400
Subject: summary.default & is.recursive
References: <199907071321.PAA16206@sophie.ethz.ch> <378361E6.5BF86D8C@bank-banque-canada.ca> <199907080634.IAA21541@sophie.ethz.ch> <3784BC8C.6801672@bank-banque-canada.ca> <199907081615.SAA08660@sophie.ethz.ch>
Message-ID: <3784E877.40D25BE9@bank-banque-canada.ca>

I'm moving this part of an on-going discussion to r-devel because I think I've
uncovered a bug:

>summary.default :  How is yours different from R's (I didn't try to find out)
>       If it has an advantage you should post to R-devel as a proposal

I did propose  it along time ago, but ... The fix was for a bug that Splus 3.2
and 3.3 have. It does not work properly with lists having an object with class
length greater than 1. I reported it to StatSci and it was suppose to get fixed
in 3.3 but didn't. I'm not sure about later versions. Having now just checked R,
I see that R's summary.default has been changed. But the problem does not occur
because another more serious incompatibility occurs first:

z <- 1:3
class(z) <- c("a", "b")

is.recursive(list(z, a=list(1:3)) )

R64.2:>   [1] FALSE
Splus3.3> [1] T


My change to summary.default was to fix the following warning in Splus3.2 and
3.3:

> summary.default(list(z, a=list(1:3)))
  Length Class    Mode
  3      a     numeric
a 1            list
Warning messages:
  Replacement length not a multiple of number of elements to replace in: sumry[
 i, 2] <- class(ii)

and consisted simply of changing

      sumry[i, 2] <- if (is.object(ii))
           class(ii)
to
   sumry[i, 2] <- if (is.object(ii))
        paste(class(ii), collapse=" ")

This may not be necessary in the current R version, but because of the above
error in is.recursive, that part of summary.default is not used now.


Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul  8 19:36:47 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu, 8 Jul 1999 20:36:47 +0200 (MET DST)
Subject: summary.default & is.recursive (PR#221)
Message-ID: <199907081836.UAA28992@pubhealth.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> is.recursive(list(z, a=list(1:3)) )
> 
> R64.2:>   [1] FALSE
> Splus3.3> [1] T

Yup, it's a bug. Cc'ed to r-bugs so that we don't forget.

> is.recursive(list(1,2))
[1] FALSE
> is.recursive(pairlist(1,2))
[1] TRUE

[maybe Martin would want to add a check that is.whatever works
identically on lists and pairlists. Not is.pairlist, though...]
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Thu Jul  8 05:14:11 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Thu, 8 Jul 1999 16:14:11 +1200
Subject: Gnome interface status report
Message-ID: <19990708161411.A97838@r.stat.auckland.ac.nz>

Hi,

The Gnome version now compiles, and it should also be working (at least as much as it
ever has).  I've changed Makefile.in to the new system, which is very cool.  What I
want to work on now is:

- Graphics.  I want to move to the Gnome canvas for this, which should be reasonably
  easy.  This will give us rotated text (which I never got going properly before) and
  the option for antialiased graphics.  However, there are some unimplemented bits in
  the canvas (and the antialiasing is currently a bit buggy), so this may take a while
  to get going properly.

- Printing.  This will hopefully include chucking text (like the console and help
  pages) to the print spooler, and somehow making graphics windows spit out PS files.
  If the Gnome print architecture ever gets finished, we will be able to do really
  cool printing stuff, but that might be a while.

- Preferences.  I need to add a few more things, and make some of the existing prefs
  actually do something.  Some of this will be easier once Brian Ripley's stuff to do
  with the command line parameters is finished, I think.

- Syntax highlighting.  Someone has written a widget that can do syntax highlighting,
  so I would like to base the R console on it.  This could take a bit of work, but
  would look fantastic.

I've decided to use Glade (http://glade.pn.org) for laying out the dialog boxes from
now on.  This will mean fixing a couple of things in Glade, and including libglade in
the R source (this will only affect the gnome part of the source, of course).  The
time savings from using Glade are incredible; writing the GUI code in C was horrible.

Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Jul  9 04:35:58 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Thu, 08 Jul 1999 23:35:58 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Thu, 08 Jul 1999 08:34:00 EDT."
 <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>
Message-ID: <199907090335.XAA03774@infiniti.ece.cmu.edu>


(If you don't care about R on AIX, happily ignore this email...)

First about Martin's question (concerning /usr/bin/make):
  I took a quick look at the Makefile.  The problem is with the
Makedeps target.  Replacing $< with $? solves the problem.  Shouldn't
but does.  Will this break on other platforms?  Shouldn't but may.

"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>> Yes, there is still something wrong with the DLLFLAGS.  (Which also
>> shows up when you try to link local libraries (like a private copy of
>> the readline lib).)   I've played a little more with the way R.exp is
>> generated.  Let me try it on 64.2 and 65.

Kurt> Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!
I know, but I also need a stable version.

Kurt> gcc (cannot find libgcc.a???)

If gcc cannot find libgcc.a for any other compilation, I'd get worried
in your place.  I might even get scared.
For R.binary linking it's simple and necessary to search for
libgcc.a and put it in the DLLFLAGS.  If you want to link with ld
instead of cc/f77, you have to add default libs, like -lxlf90 -lxlf
-lc -lm.  Which ones exactly, you can find out by calling ld with the
nobind option.  Most instructive since this will result in the binder
commands being printed.  

Kurt> The specs file is fine.  My question is, is that a known gcc problem on
Kurt> AIX or is that due to the rather outdated version of gcc we have?  If it
Kurt> is a general problem, I can easily add to DLLFLAGS.

See above.  But we may not be talking about the same.  When is
libgcc.a not found?

>> BTW, do you not get compiler errors about blkcnt not being defined
>> when you compile with gcc?  So far, I had to patch most programs
>> because there is a bug with the standard include files.

Hmm, I have gcc 2.8.1 (for AIX 4.1) which barfs at sys/stat.h and
friends. Somehow somebody forgot sometime about "typedef long
blk_cnt".  Or something close to this effect.

About DLLFLAGS, SHLIBLD etc:  Currently you'll probably need to know
the libraries (-lm -lxlf ...) when linking a shared lib since the
fortran library code is currently not exported via ldAIX4.  Is this
"bad"?  Is it worth spending time to get this right, i.e. R.binary
exports all symbols that are actually linked in?  Or can we live with
the baggage of extra libs in SHLIBFLAGS and a little bit bigger shared
libs?

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 15:18:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Jul 1999 16:18:37 +0200
Subject: Those #"&/! comments
Message-ID: <x2emihvrcy.fsf@blueberry.kubism.ku.dk>


I promised R-core write-up of my understanding of the comment
placement nastiness, but I might as well increase the scope to
R-devel:

(R moves, mangles, or deletes comments in mysterious ways -- see for
instance PR#118)

One basic issue is that any R parse tree can have 0, 1, or more
textual representations. Examples

quote(x)                   # one, presumably...
substitute(+x,x=list(1:2)) # none
quote("+"(2,2))	           # two

This means that parse and deparse are not inverses in any sense, and
since you cannot reliably reproduce the textual input, you cannot
place comments correctly either. Of course, one might just say that if
people do sneaky things, then they deserve whatever they get. 

But there's another snag: parse trees can contain any R object and the
only way of placing comments in a parse tree is by attaching them to
one of the nodes. So we have fun with objects carrying the "blah"
comment attribute all over the place, as already happens with 

> f<-function()1#blah
> f()
[1] 1
> f
function () 
structure(1, comment = "#blah")
> dput(f())
structure(1, comment = "#blah")
> substitute(+x,list(x=f()))
+structure(1, comment = "#blah")

On top of that there's figuring out which entity should own a comment.
Probably the most viable scheme is that a comment belongs to the token
preceding it. But not all tokens are stored in the parse tree.
Consider

if  #1
( #2
x #3
) #4
    3 #5
else #6
    4 #7
#8

The parse tree is, however, equivalent to "if"(x, 3, 4)

To faithfully reproduce any "if" construct, one needs to store at
least four comment structures (for "if", "(", ")",and "else") with it.
General function calls have roughly three per actual argument (after
the ',' and before and after the '=').

As you may have gathered, if you set out to get it right this way,
things quickly get unwieldy.

An alternate suggestion (by Robert at the Vienna meeting) is to "store
the text with the function". I am more and more inclined to think that
this is the viable way to proceed. It takes up a bit of space, but so
what? There are several other questions coming up, though:

(1) can one be sure that the text and the parse tree is in sync?
(2) can we retain the automatic indentation when editing?
(3) what does one do with function definitions within functions?

(1) I don't think so. As long as there's a parse step involved in the
    definition, it is easy enough, but body()<- and formals()<- is
    bound to spoil the fun. One could adopt the convention that such
    operations destroy the comment structure (if a function has no
    stored text, just use the old deparsing technique). That would
    leave only direct manipulations of parse trees as a source for
    inconsistency, in which case it would be fair to let the user
    deserve what he gets.

(2) (and I think this is useful for debugging, etc.). One thing that
    one might do is to store the code in tokenized form more or less
    as the lexical analyser generates it. Then just add the
    indentation when printing.

(3) I think it is necessary to store the text *both* with the inner
    and the outer function. It is not too hard to think of schemes
    to keep track of which parts of a token stream are to be cut out
    and stored with the "function" tokens (and, when the definition is
    evaluated, with the resulting function object).


Comments? (Pardon the pun...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul  9 15:34:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 9 Jul 1999 16:34:54 +0200 (CEST)
Subject: platforms
Message-ID: <14214.2190.45310.941332@aragorn.ci.tuwien.ac.at>

As you may have noticed, the configure/make mechanism has undergone
further substantial changes.  The idea is that (maybe setting a few
shell variables) and then doing configure; make; make install should
work ``as much as possible''.

I don't have access to most platforms and cc/f77/make combinations.
What I am looking for is volunteers in r-devel, BUT NOT IN r-core, who
are willing to ``support'' certain
	cpu-vendor-os cc/f77/make
`platforms' in the sense that they regularly try to recompile the
current (devel and maybe also release) versions for their platform and
let me know whether everything is fine or what needs to be fixed.

Any volunteers?  (Note that the PLATFORMS file in the R distribution is
a good start, but I'd really like to keep the info in it as up-to-date
as possible ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul  9 16:13:29 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 9 Jul 1999 17:13:29 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907090335.XAA03774@infiniti.ece.cmu.edu>
References: <14212.18008.114422.127304@aragorn.ci.tuwien.ac.at>
 <199907090335.XAA03774@infiniti.ece.cmu.edu>
Message-ID: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> (If you don't care about R on AIX, happily ignore this email...)

> First about Martin's question (concerning /usr/bin/make):
>   I took a quick look at the Makefile.  The problem is with the
> Makedeps target.  Replacing $< with $? solves the problem.  Shouldn't
> but does.  Will this break on other platforms?  Shouldn't but may.

Actually, replacing it by an explicit `Makefile' is much better.  Sorry
for that.  I keep forgetting that $< does strange things with some make
programs ... fixed now.

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>> Yes, there is still something wrong with the DLLFLAGS.  (Which also
>>> shows up when you try to link local libraries (like a private copy of
>>> the readline lib).)   I've played a little more with the way R.exp is
>>> generated.  Let me try it on 64.2 and 65.

Kurt> Please, NOT with 0.64.2.  All my configure/make changes are in 0.65!

> I know, but I also need a stable version.

:-)  (Actually, I think devel is more stable than release.  The major
difference is that configure/make changes are all in devel as they
typically are NOT bug fixes at all, so they must be in devel ...

Kurt> gcc (cannot find libgcc.a???)

> If gcc cannot find libgcc.a for any other compilation, I'd get worried
> in your place.  I might even get scared.
> For R.binary linking it's simple and necessary to search for
> libgcc.a and put it in the DLLFLAGS.  If you want to link with ld
> instead of cc/f77, you have to add default libs, like -lxlf90 -lxlf
> -lc -lm.  Which ones exactly, you can find out by calling ld with the
> nobind option.  Most instructive since this will result in the binder
> commands being printed.

How does this work exactly?

Kurt> The specs file is fine.  My question is, is that a known gcc problem on
Kurt> AIX or is that due to the rather outdated version of gcc we have?  If it
Kurt> is a general problem, I can easily add to DLLFLAGS.

> See above.  But we may not be talking about the same.  When is
> libgcc.a not found?

Here's what happens:

e8725245@fbma:/tmp/fl/build/src/main$ gmake LDCMD=gcc
gmake[1]: Entering directory `/tmp/fl/build/src/main'
gmake[1]: `Makedeps' is up to date.
gmake[1]: Leaving directory `/tmp/fl/build/src/main'
gmake[1]: Entering directory `/tmp/fl/build/src/main'
gcc -bdynamic -bE:../../etc/R.exp -bM:SRE -lc -lm -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a  -lX11  -lblas  -L/usr/local/lib -lxlf90 -lxlf -lm  -ldl -ltermcap -lm 
ld: 0706-005 Cannot find or open file: libgcc.a
        ld:open(): No such file or directory
ld: 0706-005 Cannot find or open file: libgcc.a
        ld:open(): No such file or directory
gmake[1]: *** [../../bin/R.X11] Error 1
gmake[1]: Leaving directory `/tmp/fl/build/src/main'
gmake: *** [R] Error 2

???  and interestingly, adding
-L/usr/local/lib/gcc-lib/rs6000-ibm-aix3.2.5/2.7.2/ does not help.

>>> BTW, do you not get compiler errors about blkcnt not being defined
>>> when you compile with gcc?  So far, I had to patch most programs
>>> because there is a bug with the standard include files.

> Hmm, I have gcc 2.8.1 (for AIX 4.1) which barfs at sys/stat.h and
> friends. Somehow somebody forgot sometime about "typedef long
> blk_cnt".  Or something close to this effect.

> About DLLFLAGS, SHLIBLD etc:  Currently you'll probably need to know
> the libraries (-lm -lxlf ...) when linking a shared lib since the
> fortran library code is currently not exported via ldAIX4.  Is this
> "bad"?  Is it worth spending time to get this right, i.e. R.binary
> exports all symbols that are actually linked in?  Or can we live with
> the baggage of extra libs in SHLIBFLAGS and a little bit bigger shared
> libs?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul  9 17:05:28 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 9 Jul 1999 18:05:28 +0200
Subject: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
Message-ID: <199907091605.SAA12966@sophie.ethz.ch>

I've (remote) access to a new Linux system which has some flavor of Rehat
installed.

Compiling R-0.64.2 fails -- at the end when  eda.so should be made.

    make[4]: Entering directory `/u/u2/maechler/Linux/R/R-0.64.2/src/library/eda/src'
    gcc -g -O2 -fpic -I../../../../include -c line.c -o line.o
    gcc -g -O2 -fpic -I../../../../include -c smooth.c -o smooth.o
    ld -shared -o eda.so line.o smooth.o
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:1414
    make[4]: *** [eda.so] Segmentation fault
    make[4]: *** Deleting file `eda.so'
    make[4]: Leaving directory `/u/u2/maechler/Linux/R/R-0.64.2/src/library/eda/src'
    <.....>
    make: *** [R] Error 1

---
Interestingly, "mva" {instead of "eda"} works fine...

Further, the number of
	 "ld: bfd assertion fail ..." 
lines is not constant.  Above we had 2 of them;
but I have also seen 5 :
    ld -shared -o eda.so line.o smooth.o
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:621
    ld: bfd assertion fail elf32-i386.c:1414
or three....

-----------

mkellers{maechler}425% gcc --version
egcs-2.91.66
mkellers{maechler}426% ld --version
GNU ld 2.9.1
Copyright 1997 Free Software Foundation, Inc.
This program is free software; you may redistribute it under the terms of
the GNU General Public License.  This program has absolutely no warranty.
  Supported emulations:
   elf_i386
   i386linux

------------------

I'm guessing that the  gcc/ld/library combination hasn't been 
installed/configured properly... 
???

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri Jul  9 21:23:25 1999
From: bates@stat.wisc.edu (bates@stat.wisc.edu)
Date: Fri, 9 Jul 1999 22:23:25 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907092023.WAA06813@pubhealth.ku.dk>

..
R is now configured for sparc-sun-solaris2.6

  Source directory:         .
  Installation directory:   /unsup/R-0.64.2
  C compiler:               gcc -g -O2
  FORTRAN compiler:         g77 -O2
  Gnome support:            no

$ gcc --version
egcs-2.91.66
$ g77 --version
GNU Fortran 0.5.24-19981002

"make check" later fails.  The failure is in the test of the eigen()
function.  The specific example is:

> eigen(cbind( 1,3:1,1:3))
Segmentation Fault - core dumped

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Jul  9 21:32:15 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 9 Jul 1999 13:32:15 -0700 (PDT)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <199907092023.WAA06813@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.10.9907091329240.22928-100000@wompom.biostat.washington.edu>

On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:

> ..
> R is now configured for sparc-sun-solaris2.6
> 
>   Source directory:         .
>   Installation directory:   /unsup/R-0.64.2
>   C compiler:               gcc -g -O2
>   FORTRAN compiler:         g77 -O2
>   Gnome support:            no
> 
> $ gcc --version
> egcs-2.91.66
> $ g77 --version
> GNU Fortran 0.5.24-19981002

I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77

wompom% gcc --version
2.8.1
wompom% f77 -V
f77: WorkShop Compilers 4.2 30 Oct 1996 FORTRAN 77 4.2
> eigen(cbind( 1,3:1,1:3))
$values
[1] 5 1 0

$vectors
           [,1]  [,2]       [,3]
[1,] -0.8246211 -1.25 -0.9701425
[2,] -0.8246211 -0.25  0.2425356
[3,] -0.8246211  0.75  0.2425356


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 22:51:34 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Jul 1999 23:51:34 +0200
Subject: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
In-Reply-To: Martin Maechler's message of "Fri, 9 Jul 1999 18:05:28 +0200"
References: <199907091605.SAA12966@sophie.ethz.ch>
Message-ID: <x2oghlxzix.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> I've (remote) access to a new Linux system which has some flavor of Rehat
> installed.
> 
> Compiling R-0.64.2 fails -- at the end when  eda.so should be made.
.....> 
> mkellers{maechler}425% gcc --version
> egcs-2.91.66
> mkellers{maechler}426% ld --version
> GNU ld 2.9.1
> Copyright 1997 Free Software Foundation, Inc.
> This program is free software; you may redistribute it under the terms of
> the GNU General Public License.  This program has absolutely no warranty.
>   Supported emulations:
>    elf_i386
>    i386linux
> 
> ------------------
> 
> I'm guessing that the  gcc/ld/library combination hasn't been 
> installed/configured properly... 
> ???

Or hardware. I've been running that combination for a couple of
months on my home machine and since yesterday on the work machine,
including a compile from scratch of the official 0.64.2 as late as
today (the old binary broke due to the __setfpucw silliness).

But first check the install with 

rpm -V egcs binutils 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Jul  9 23:04:38 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Jul 1999 00:04:38 +0200
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: Thomas Lumley's message of "Fri, 9 Jul 1999 13:32:15 -0700 (PDT)"
References: <Pine.GSO.4.10.9907091329240.22928-100000@wompom.biostat.washington.edu>
Message-ID: <x2n1x5xyx5.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> 
> > ..
> > R is now configured for sparc-sun-solaris2.6
> > 
> >   Source directory:         .
> >   Installation directory:   /unsup/R-0.64.2
> >   C compiler:               gcc -g -O2
> >   FORTRAN compiler:         g77 -O2
> >   Gnome support:            no
> > 
> > $ gcc --version
> > egcs-2.91.66
> > $ g77 --version
> > GNU Fortran 0.5.24-19981002
> 
> I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77
> 

This is very likely the same trouble that I just spent some time
analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
to something that looks suspiciously like a compiler error. I actually
considered asking around if anyone used same egcs version on Solaris,
but though "nah, probably not"....

Doug, could you 

- recompile eigen.o with -g 
- run it with -d gdb
- see if the crash resembles the one below

...
> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
h=0x70d99f80,
    wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
    at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) p j
$1 = 0
(gdb) p na
$2 = 0
(gdb) p en
$3 = 3
(gdb) p n
$4 = (PTR TO -> ( integer )) 0x70d99fc8
(gdb) p nm
$5 = (PTR TO -> ( integer )) 0x1


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Sat Jul 10 02:53:28 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Fri, 09 Jul 1999 21:53:28 -0400
Subject: Almost succesfull build on AIX
In-Reply-To: Your message of "Fri, 09 Jul 1999 17:13:29 EDT."
 <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
Message-ID: <199907100153.VAA16542@infiniti.ece.cmu.edu>


These are some notes about compilation of R-devel (1999-July-08):

-- Compilation breaks when using gcc due to a bug in the include
files.  gcc is version 2.8.1.  In the files Defn.h, Rsock.c and
sock.c, I had to add "typedef long blkcnt_t" which somehow is not
found in sys/types.h.  This may be specific to my installation or to
this version of gcc.

-- The linking stage breaks because it can't find libz.a and
libncurses.a.  I can't quite figure out why R.X11 would want them.
This appears to be a new feature in configure.  BTW, for the readline 
lib I need -lcurses (note no n).

-- Sorry, I forgot to pass this on: You (Kurt) should try to link with
ld not with gcc.  (This will cover up that I have no clue why -L<path>
wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
-lgcc where path is taken from "gcc --print-libgcc-file-name"

Here is the deal with LDCMD/SHLIBLD as far as I understand it:

-- For the R binary (R.X11) we need:
   == LDCMD: ld (native linker)
   == DLLFLAGS: mainly the export symbol flags
	("-bdynamic -bE:${EXPORTFILE} -bM:SRE") and libraries ("-lc -lm
	-l<fortran libs>", if CC==gcc libgcc.a as well);
	but also the LDFLAGS (see buttom).

-- For shared libraries (like eda.so) we need:
   == SHLIBLD:  ld
   == SHLIBLDFLAGS: again the symbol stuff
	("-bM:SRE -bnoentry -bexpall -bI:${EXPORTFILE}"), maybe libraries

Below is some code that can figure out which libraries to use and
where they are.  "ld -bnobind" does the work, providing us wiht lines
like "i array.o" or "lib /usr/lib/libm.a".  This code would put all
symbols that are in R.X11 (not just all the .o and .a files) into the
export file.  Advantage:  If the shared libs don't need any more
libraries than R, we are set and don't need any libraries (-lm etc) in
SHLIBLDFLAGS.  Disadvantage:  We have to make sure that everything
from the libraries actually makes it into R.  Dunno.

-- warning shell script ahead, avert eyes --
ld -bnobind "$@" |
sed -n -e 's/^i /. /p' -e 's/^lib \(.*\)/\1 \1/p' |
(
        while read a b; do
                echo 1>&2 "$a $b"
                echo "#! $a" >> $mainexp
                $nm $nmopts $b |
                        awk '
$2 == "T" && $1 ~ /^\.[^_]/ { found[substr($1, 2)] = 1 }
$2 == "D" { text[$1] = 1 }
$2 == "B" && $1 ~ /^[^_]/ { bss[$1] = 1 }
END {
        for (x in text)
                if (found[x]) print x;
        for (b in bss)
                print b;
}' |
                        sort | uniq >> $mainexp
        done
)
-- you may now open your eyes again --

My suggestion would be: - fix ldAIX so that it helps finding all the
libs and we can use ld as the linker command.  (I can do this).  -
leave the libs in SHLIBLDFLAGS.  This makes the shared libs a little
bit bigger but we are on the save side.

This is new but may help:  If I want to have my local copy of
readline linked into R, I have to set in my config.site:
CPPFLAGS=-I/home/opt/share/include
LIBS=-lcurses
LDFLAGS=-L/home/opt/arch/lib

I can't put the path to my libreadline.a into LIBS, this would fail.
I need a seperate way of telling to the linker where to find local
libs, which is what LDFLAGS is meant for.  BUT DLLFLAGS does currently
not include the LDFLAGS.

It's still compiling the docs.  make check will have to wait till tomorrow.

  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Sat Jul 10 15:49:14 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Sat, 10 Jul 1999 16:49:14 +0200 (CEST)
Subject: who submitted ratetables to CRAN?
Message-ID: <14215.23914.834446.454221@galadriel.ci.tuwien.ac.at>


Hi,

the ratetables package on CRAN contains no author/maintainer
information whatsoever and I cannot remember who submitted it
... is the creator out there on this list?

The DESCRIPTION file is missing (otherwise I wouldn't have problems
with finding the author) ...

Fritz
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sat Jul 10 19:57:30 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 10 Jul 1999 11:57:30 -0700 (PDT)
Subject: who submitted ratetables to CRAN?
In-Reply-To: <14215.23914.834446.454221@galadriel.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.10.9907101152400.23215-100000@wompom.biostat.washington.edu>

On Sat, 10 Jul 1999, Friedrich Leisch wrote:

> 
> Hi,
> 
> the ratetables package on CRAN contains no author/maintainer
> information whatsoever and I cannot remember who submitted it
> ... is the creator out there on this list?

It was part of survival4, packaged separately because it was too big to
load routinely in the days before data() and autoload(). I would suggest
that survival4 and ratetables disappear when 0.65 is released. Survival5
requires 0.64.1 or better to install in the standard way, and there might
be (unwise) people out there who don't install the dot releases.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Jul 11 08:56:21 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 11 Jul 1999 09:56:21 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907110756.JAA09333@pubhealth.ku.dk>

On 10 Jul 1999, Peter Dalgaard BSA wrote:

> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> > 
> > > ..
> > > R is now configured for sparc-sun-solaris2.6
> > > 
> > >   Source directory:         .
> > >   Installation directory:   /unsup/R-0.64.2
> > >   C compiler:               gcc -g -O2
> > >   FORTRAN compiler:         g77 -O2
> > >   Gnome support:            no
> > > 
> > > $ gcc --version
> > > egcs-2.91.66
> > > $ g77 --version
> > > GNU Fortran 0.5.24-19981002
> > 
> > I don't have this problem under Solaris 2.7 using gcc and Sun Workshop f77
> > 
> 
> This is very likely the same trouble that I just spent some time
> analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
> to something that looks suspiciously like a compiler error. I actually
> considered asking around if anyone used same egcs version on Solaris,
> but though "nah, probably not"....

I do (see PLATFORMS) but unfortunately did my pre-tests of 0.64.2
at home, using egcs 1.1. That works fine, so I suspect a compiler bug.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Jul 11 16:31:13 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 11 Jul 1999 17:31:13 +0200 (MET DST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
Message-ID: <199907111531.RAA09876@pubhealth.ku.dk>

On 10 Jul 1999, Peter Dalgaard BSA wrote:

> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
> > 
> > > ..
> > > R is now configured for sparc-sun-solaris2.6
> > > 
> > >   Source directory:         .
> > >   Installation directory:   /unsup/R-0.64.2
> > >   C compiler:               gcc -g -O2
> > >   FORTRAN compiler:         g77 -O2

(Why is the default to have -g for C but not Fortran? That has puzzled me
before now. At least for gcc/g77 we could be consistent.)

> > >   Gnome support:            no
> > > 
> > > $ gcc --version
> > > egcs-2.91.66
> > > $ g77 --version
> > > GNU Fortran 0.5.24-19981002
> 
> This is very likely the same trouble that I just spent some time
> analyzing with Vin Everett on Sparc Linux (RedHat 6.0). We traced it
> to something that looks suspiciously like a compiler error. I actually
> considered asking around if anyone used same egcs version on Solaris,
> but though "nah, probably not"....

Solaris 2.6
Same gcc and g77 as above (egcs-1.1.2)

I get the same behaviour if eigen.f is compiled with -O2, but not if it
is compiled without optimization, nor if it is compiled with egcs-1.1
(and -O2) nor if it is compiled with SunPro SC4.x f77.

> Doug, could you 
> 
> - recompile eigen.o with -g 
> - run it with -d gdb
> - see if the crash resembles the one below
> 
> ...
> > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> 
> Program received signal SIGSEGV, Segmentation fault.
> hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> h=0x70d99f80,
>     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
>     at eigen.f:2120
> 2120                   RA = RA + H(I,J) * H(J,NA)
> Current language:  auto; currently fortran
> (gdb) p j
> $1 = 0
> (gdb) p na
> $2 = 0
> (gdb) p en
> $3 = 3
> (gdb) p n
> $4 = (PTR TO -> ( integer )) 0x70d99fc8
> (gdb) p nm
> $5 = (PTR TO -> ( integer )) 0x1

Does for me (modulo addresses, of course).

The remedy (as usual) seems to be not to optimize when compiling eigen.f
under egcs-1.1.2.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Jul 12 00:35:27 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Jul 1999 01:35:27 +0200
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Sun, 11 Jul 1999 17:31:13 +0200 (MET DST)"
References: <199907111531.RAA09876@pubhealth.ku.dk>
Message-ID: <x2673qiwu8.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> > Doug, could you 
> > 
> > - recompile eigen.o with -g 
> > - run it with -d gdb
> > - see if the crash resembles the one below
> > 
> > ...
> > > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> > 
> > Program received signal SIGSEGV, Segmentation fault.
> > hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> > h=0x70d99f80,
> >     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
> >     at eigen.f:2120
> > 2120                   RA = RA + H(I,J) * H(J,NA)
> > Current language:  auto; currently fortran
> > (gdb) p j
> > $1 = 0
> > (gdb) p na
> > $2 = 0
> > (gdb) p en
> > $3 = 3
> > (gdb) p n
> > $4 = (PTR TO -> ( integer )) 0x70d99fc8
> > (gdb) p nm
> > $5 = (PTR TO -> ( integer )) 0x1
> 
> Does for me (modulo addresses, of course).

Exactly the same?? (Doug's wasn't...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 12 07:49:34 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 12 Jul 1999 07:49:34 +0100 (BST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <x2673qiwu8.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907120745450.21920-100000@auk.stats>

On 12 Jul 1999, Peter Dalgaard BSA wrote:

> ripley@stats.ox.ac.uk writes:
> 
> > > Doug, could you 
> > > 
> > > - recompile eigen.o with -g 
> > > - run it with -d gdb
> > > - see if the crash resembles the one below
> > > 
> > > ...
> > > > eigen(cbind(-1,c(1:2,0),0:2)) # complex values
> > > 
> > > Program received signal SIGSEGV, Segmentation fault.
> > > hqr2_ (nm=0x1, n=0x70d99fc8, low=0xefffed94, igh=0xefffed90,
> > > h=0x70d99f80,
> > >     wr=0x70d99f68, wi=0x70d99f50, z=0x70d99f00, ierr=0x70d99ed0)
> > >     at eigen.f:2120
> > > 2120                   RA = RA + H(I,J) * H(J,NA)
> > > Current language:  auto; currently fortran
> > > (gdb) p j
> > > $1 = 0
> > > (gdb) p na
> > > $2 = 0
> > > (gdb) p en
> > > $3 = 3
> > > (gdb) p n
> > > $4 = (PTR TO -> ( integer )) 0x70d99fc8
> > > (gdb) p nm
> > > $5 = (PTR TO -> ( integer )) 0x1
> > 
> > Does for me (modulo addresses, of course).
> 
> Exactly the same?? (Doug's wasn't...)

Modulo addresses as I said, yes:

> eigen(cbind(-1,c(1:2,0),0:2)) # complex values

Program received signal SIGSEGV, Segmentation fault.
hqr2_ (nm=0x1, n=0xbe0a58, low=0xefffe414, igh=0xefffe410, h=0xbe0a10, 
    wr=0xbe09f8, wi=0xbe09e0, z=0xbe0990, ierr=0xbe0960) at eigen.f:2120
2120                   RA = RA + H(I,J) * H(J,NA)
Current language:  auto; currently fortran
(gdb) p j
$1 = 0
(gdb) p na
$2 = 0
(gdb) p en
$3 = 3
(gdb) p n
$4 = (PTR TO -> ( integer )) 0xbe0a58
(gdb) p nm
$5 = (PTR TO -> ( integer )) 0x1

which looks pretty much the same to me.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 07:53:12 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 08:53:12 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907100153.VAA16542@infiniti.ece.cmu.edu>
References: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
 <199907100153.VAA16542@infiniti.ece.cmu.edu>
Message-ID: <14217.37080.324259.602862@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> These are some notes about compilation of R-devel (1999-July-08):

> -- Compilation breaks when using gcc due to a bug in the include
> files.  gcc is version 2.8.1.  In the files Defn.h, Rsock.c and
> sock.c, I had to add "typedef long blkcnt_t" which somehow is not
> found in sys/types.h.  This may be specific to my installation or to
> this version of gcc.

I cannot confirm this with 2.7.1 (!).  I could add

	AC_CHECK_TYPE(blkcnt_t, long)

to configure.in but I'd want to be sure this is really needed.

> -- The linking stage breaks because it can't find libz.a and
> libncurses.a.  I can't quite figure out why R.X11 would want them.
> This appears to be a new feature in configure.

Very strange.  Are you saying that -lz and -lncurses are detected at
configure time but not found at compilation/link time?  (Could it be
that they are in /home/opt/arch/lib?)  Note (see also below) that you
really should use LIBS and not LDFLAGS for -L and -l stuff.

> BTW, for the readline lib I need -lcurses (note no n).

Need?  Better not ... any of ncurses, termcap or termlib would be o.k.
(See also above.)

> -- Sorry, I forgot to pass this on: You (Kurt) should try to link with
> ld not with gcc.  (This will cover up that I have no clue why -L<path>
> wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
> -lgcc where path is taken from "gcc --print-libgcc-file-name"

As I already wrote, I'd like to.  Problem is we need to know which libs
(such as -lc -lm) to link against ... I'll do something about DLLFLAGS
as suggested.

> Here is the deal with LDCMD/SHLIBLD as far as I understand it:

> -- For the R binary (R.X11) we need:
>    == LDCMD: ld (native linker)
>    == DLLFLAGS: mainly the export symbol flags
> 	("-bdynamic -bE:${EXPORTFILE} -bM:SRE") and libraries ("-lc -lm
> 	-l<fortran libs>", if CC==gcc libgcc.a as well);
> 	but also the LDFLAGS (see buttom).

The Fortran libs are not needed because they are in FLIBS anyway.  Is
`-lc' and maybe `-lgcc' if GCC really enough?

> -- For shared libraries (like eda.so) we need:
>    == SHLIBLD:  ld
>    == SHLIBLDFLAGS: again the symbol stuff
> 	("-bM:SRE -bnoentry -bexpall -bI:${EXPORTFILE}"), maybe libraries

> Below is some code that can figure out which libraries to use and
> where they are.  "ld -bnobind" does the work, providing us wiht lines
> like "i array.o" or "lib /usr/lib/libm.a".  This code would put all
> symbols that are in R.X11 (not just all the .o and .a files) into the
> export file.  Advantage:  If the shared libs don't need any more
> libraries than R, we are set and don't need any libraries (-lm etc) in
> SHLIBLDFLAGS.  Disadvantage:  We have to make sure that everything
> from the libraries actually makes it into R.  Dunno.

> -- warning shell script ahead, avert eyes --
> ld -bnobind "$@" |
> sed -n -e 's/^i /. /p' -e 's/^lib \(.*\)/\1 \1/p' |
> (
>         while read a b; do
>                 echo 1>&2 "$a $b"
>                 echo "#! $a" >> $mainexp
>                 $nm $nmopts $b |
>                         awk '
> $2 == "T" && $1 ~ /^\.[^_]/ { found[substr($1, 2)] = 1 }
> $2 == "D" { text[$1] = 1 }
> $2 == "B" && $1 ~ /^[^_]/ { bss[$1] = 1 }
> END {
>         for (x in text)
>                 if (found[x]) print x;
>         for (b in bss)
>                 print b;
> }' |
>                         sort | uniq >> $mainexp
>         done
> )
> -- you may now open your eyes again --

> My suggestion would be: - fix ldAIX so that it helps finding all the
> libs and we can use ld as the linker command.  (I can do this).  -
> leave the libs in SHLIBLDFLAGS.  This makes the shared libs a little
> bit bigger but we are on the save side.

Hmm ... we need to determine DLLFLAGS and SHLIBLDFLAGS at configure
time.  The above would only work at run time, right?  I can see that
this is not a problem with DLLFLAGS because we could wrap things into
the ldAIX script, but how could we do this with SHLIBLDFLAGS then?

> This is new but may help:  If I want to have my local copy of
> readline linked into R, I have to set in my config.site:
> CPPFLAGS=-I/home/opt/share/include
> LIBS=-lcurses
> LDFLAGS=-L/home/opt/arch/lib

> I can't put the path to my libreadline.a into LIBS, this would fail.
> I need a seperate way of telling to the linker where to find local
> libs, which is what LDFLAGS is meant for.  BUT DLLFLAGS does currently
> not include the LDFLAGS.

Maybe I should add LDFLAGS to the LD-like rules.

Re LIBS, why does this not work (as it should)?

> It's still compiling the docs.  make check will have to wait till
> tomorrow.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Mon Jul 12 09:54:43 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Mon, 12 Jul 1999 20:54:43 +1200
Subject: Gnome interface status report
Message-ID: <19990712205443.A4298@stat1.stat.auckland.ac.nz>

Hi,

First, the Find dialog now works.  Users can search backwards or forwards, from the top,
bottom or current cursor position.  Tomorrow I'm going to add regular expression searches
and the option to wrap searches.

I have also got command line arguments working.  I'd really like someone to test this out,
as I never use the command line arguments and so don't know what people generally use.

I have added support for the R_NSIZE, R_VSIZE, R_HISTFILE, and R_HISTSIZE environment
variables (cut'n'paste from unix/system.c :-).  If there are any other environment
variables lurking in the unix source code that I should know about, please let me know.

Given that things like NSize and VSize can be set via environment variable, command line
argument and GUI preferences, I have arbitrarily come up with a precedence (it's easy to
change if anyone disagrees).  Command line arguments have the highest precedence,
followed by the GUI prefs, followed by the environment variables.  Arguably the 
environment variables should take precedence over the GUI preferences; but I think that
it could be a bit confusing if a user sets the vsize using the preferences dialog, but
the setting never takes effect because of an environment variable in the system profile.
However, the GUI will use any environment variables as the default when creating the
preferences.

I have also split gnome/system.c into several files, because it was becoming to big for
easy navigation.  The files are: system.c, system-unix.c, system-choosefile.c,
system-console.c, and system-showfiles.c.  system.c has main, the argument parsing and
the cleanup stuff.  system-unix.c has all the code that I haven't touched, i.e. that is
(hopefully) identical to the corresponding functions in unix/system.c.

Lyndon

PS: I broke the Gnome graphics today, which is wierd because I didn't touch them.  I'll
figure it out tomorrow.  I've also noticed that several console control keys no longer
work (C-u in particular), which I will need to sort out.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:08:02 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:08:02 +0200 (CEST)
Subject: Almost succesfull build on AIX
In-Reply-To: <199907100153.VAA16542@infiniti.ece.cmu.edu>
References: <14214.4505.64293.902996@aragorn.ci.tuwien.ac.at>
 <199907100153.VAA16542@infiniti.ece.cmu.edu>
Message-ID: <14217.45170.691017.489081@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> These are some notes about compilation of R-devel (1999-July-08):

> -- Sorry, I forgot to pass this on: You (Kurt) should try to link with
> ld not with gcc.  (This will cover up that I have no clue why -L<path>
> wouldn't pick up libgcc.a.)  So the DLLFLAGS should contain -L<path>
> -lgcc where path is taken from "gcc --print-libgcc-file-name"

When I use ld for linking the main, I get

  Could not load program /tmp/fl/build/bin/R.X11 
  Error was: Exec format error

The problem seems to be __start

(ld): resolve
ld: 0711-327 WARNING: Entry point not found: __start
ld: 0711-228 WARNING: Duplicate symbols were found while resolving symbols.
        The following duplicates were found:
 Symbol                    Source-File(Object) OR Import-File{Shared-object}
 ------------------------- -------------------------------------------------
 errno                     {/usr/lib/libc.a[shr.o]}
    ** Duplicate **        main.c(main.o)
 gc_inhibit_torture        memory.c(memory.o)
    ** Duplicate **        main.c(main.o)
RESOLVE: 7982 of 18361 symbols were kept.
RESOLVE: The return code is 4.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 171 symbols.
(ld): er full
ER: There are no unresolved symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.

I can fix this by linking with

	/usr/lib/crt0_r.o -lpthreads

but is this the right thing to do?

-k

PS.  Also, I get

e8725245@fbma:/usr/lib$ strings libxlf90.a | grep start
__start
__start

but

e8725245@fbma:/usr/lib$ nm libxlf90.a  | grep start
nm: libxlf90.a[_xlf_aix42sys.imp]: 0654-203 Specify an XCOFF object module.

What is this?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:22:17 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:22:17 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <199907111531.RAA09876@pubhealth.ku.dk>
References: <199907111531.RAA09876@pubhealth.ku.dk>
Message-ID: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>

>>>>> ripley  writes:

> On 10 Jul 1999, Peter Dalgaard BSA wrote:
>> > On Fri, 9 Jul 1999 bates@stat.wisc.edu wrote:
>> > 
>> > > ..
>> > > R is now configured for sparc-sun-solaris2.6
>> > > 
>> > >   Source directory:         .
>> > >   Installation directory:   /unsup/R-0.64.2
>> > >   C compiler:               gcc -g -O2
>> > >   FORTRAN compiler:         g77 -O2

> (Why is the default to have -g for C but not Fortran? That has puzzled me
> before now. At least for gcc/g77 we could be consistent.)

Simply an omission.  Autoconf does almost everything for the C compiler
and basically nothing for the Fortran compiler.  R_PROG_F77 now sets
FFLAGS to "-g -O2" for g77 unless FFLAGS is already set.

> The remedy (as usual) seems to be not to optimize when compiling eigen.f
> under egcs-1.1.2.

Should we special-case this into configure?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 10:34:49 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 11:34:49 +0200 (CEST)
Subject: Gnome interface status report
In-Reply-To: <19990712205443.A4298@stat1.stat.auckland.ac.nz>
References: <19990712205443.A4298@stat1.stat.auckland.ac.nz>
Message-ID: <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>

>>>>> Lyndon Drake writes:

> Hi,

> First, the Find dialog now works.  Users can search backwards or
> forwards, from the top, bottom or current cursor position.  Tomorrow
> I'm going to add regular expression searches and the option to wrap
> searches.

> I have also got command line arguments working.  I'd really like
> someone to test this out, as I never use the command line arguments
> and so don't know what people generally use.

> I have added support for the R_NSIZE, R_VSIZE, R_HISTFILE, and
> R_HISTSIZE environment variables (cut'n'paste from unix/system.c :-).
> If there are any other environment variables lurking in the unix
> source code that I should know about, please let me know.

> Given that things like NSize and VSize can be set via environment
> variable, command line argument and GUI preferences, I have
> arbitrarily come up with a precedence (it's easy to change if anyone
> disagrees).  Command line arguments have the highest precedence,
> followed by the GUI prefs, followed by the environment variables.
> Arguably the environment variables should take precedence over the GUI
> preferences; but I think that it could be a bit confusing if a user
> sets the vsize using the preferences dialog, but the setting never
> takes effect because of an environment variable in the system profile.
> However, the GUI will use any environment variables as the default
> when creating the preferences.

> I have also split gnome/system.c into several files, because it was
> becoming to big for easy navigation.  The files are: system.c,
> system-unix.c, system-choosefile.c, system-console.c, and
> system-showfiles.c.  system.c has main, the argument parsing and the
> cleanup stuff.  system-unix.c has all the code that I haven't touched,
> i.e. that is (hopefully) identical to the corresponding functions in
> unix/system.c.

Committed yet?  I don't seem to get these with cvs update ...

Re X11/gnome: Last week I suggested that eventually we might have
something like

	unix/...
	unix/X11	=> libRX11.so
	unix/gnome	=> libRgnome.so
maybe also
	unix/kde
???

and at startup do

	LoadSharedLib("libR$GUI.so")

My impression was that the comments we received were all positive.  So,
maybe we should keep this in mind.

Even without the GUI DLL, the above organization would be a lot cleaner.
How easy would it be to accomplish that?  It seems that we can have

	*sock*
	dynload.c
	hpdlfcn.c

in common, and maybe we only need to take waitforActivity() out from
system.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Jul 12 11:09:40 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 12 Jul 1999 12:09:40 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>
Message-ID: <XFMail.990712120940.plummer@iarc.fr>

On 12-Jul-99 Kurt Hornik wrote:
>>>>>> ripley  writes:
>> The remedy (as usual) seems to be not to optimize when compiling eigen.f
>> under egcs-1.1.2.
> 
> Should we special-case this into configure?

To work around a compiler bug? The obvious disadvantage of this is that
you won't easily find out when the bug is fixed.  There was an egcs
optimization bug on Alpha which is now fixed, but that was never taken
care of by configure.

For Linux on Sparc, I have put the fix in the spec file for the RPM,
where it remains quite visible and can be tested periodically.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 12 14:56:15 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 12 Jul 1999 15:56:15 +0200 (CEST)
Subject: core dump on 0.64.2 SPARC/Solaris 2.6 in eigen (PR#223)
In-Reply-To: <XFMail.990712120940.plummer@iarc.fr>
References: <14217.46025.143410.742320@aragorn.ci.tuwien.ac.at>
 <XFMail.990712120940.plummer@iarc.fr>
Message-ID: <14217.62463.450638.675680@aragorn.ci.tuwien.ac.at>

>>>>> Martyn Plummer writes:

> On 12-Jul-99 Kurt Hornik wrote:
>>>>>>> ripley  writes:
>>> The remedy (as usual) seems to be not to optimize when compiling eigen.f
>>> under egcs-1.1.2.
>> 
>> Should we special-case this into configure?

> To work around a compiler bug? The obvious disadvantage of this is
> that you won't easily find out when the bug is fixed.  There was an
> egcs optimization bug on Alpha which is now fixed, but that was never
> taken care of by configure.

O.k., won't change configure then ...

> For Linux on Sparc, I have put the fix in the spec file for the RPM,
> where it remains quite visible and can be tested periodically.

:-)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Mon Jul 12 21:58:54 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Tue, 13 Jul 1999 08:58:54 +1200
Subject: Gnome interface status report
In-Reply-To: <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>; from Kurt Hornik on Mon, Jul 12, 1999 at 11:34:49AM +0200
References: <19990712205443.A4298@stat1.stat.auckland.ac.nz> <14217.46777.465134.108233@aragorn.ci.tuwien.ac.at>
Message-ID: <19990713085854.A25357@r.stat.auckland.ac.nz>

On Mon, Jul 12, 1999 at 11:34:49AM +0200, Kurt Hornik wrote:
> Committed yet?  I don't seem to get these with cvs update ...
> 

Oops.  Done now.

> Re X11/gnome: Last week I suggested that eventually we might have
> something like
> 
> 	unix/...
> 	unix/X11	=> libRX11.so
> 	unix/gnome	=> libRgnome.so
> maybe also
> 	unix/kde
> ???
> 
> and at startup do
> 
> 	LoadSharedLib("libR$GUI.so")
> 
> My impression was that the comments we received were all positive.  So,
> maybe we should keep this in mind.
> 
> Even without the GUI DLL, the above organization would be a lot cleaner.
> How easy would it be to accomplish that?  It seems that we can have
> 
> 	*sock*
> 	dynload.c
> 	hpdlfcn.c
> 
> in common, and maybe we only need to take waitforActivity() out from
> system.c?
> 

I like the idea of organising the files this way.  The shared library thing
could be a bit tricky, but I guess it could be done.

devPS.c 
devPicTeX.c 
dynload.c 
edit.c 
Rsock.c 
sock.c 

are already used directly from the unix directory by the Gnome interface.
We could easily split up system.c into a couple of files.  This would give
us:

unix
|-system.c, devPS.c, ..., sock.c
|-X11
| |-system-X11.c, edit.c, devX11.c, ...
|-gnome
| |-system-gnome.c, edit.c, devGnome.c, ...

Doing this as a source split (rather than turning things into shared
libraries) would mean putting main into system-X11.c and system-gnome.c,
but would make maintaining the source for the stuff that's share between
both interfaces much simpler.

Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@cmis.csiro.au  Tue Jul 13 06:13:46 1999
From: Bill.Venables@cmis.csiro.au (Bill.Venables@cmis.csiro.au)
Date: Tue, 13 Jul 1999 07:13:46 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907130513.HAA16802@pubhealth.ku.dk>

Peter,

There is a clear and simple bug in glm() that I have noticed in
0.64.2 (Windows and Unix) but may have been present in earlier
versions.

The function starts as follows:

> glm
function (formula, family = gaussian, data = list(), weights = NULL, 
    subset = NULL, na.action = na.fail, start = NULL, offset = NULL, 
    control = glm.control(...), model = TRUE, method = "glm.fit", 
    x = FALSE, y = TRUE, contrasts = NULL, ...) 
{
    call <- match.call(expand.dots = FALSE)	### <<<<----------------------------
    ## family
    if (is.character(family)) 
        family <- get(family)
    if (is.function(family)) 
        family <- family()
    ## extract x, y, etc from the model formula and frame
    if (is.null(family$family)) {
        print(family)
        stop("`family' not recognized")
    }
    mt <- terms(formula, data = data)
    if (missing(data)) 
        data <- sys.frame(sys.parent())
    mf <- match.call()				### <<<<----------------------------
    mf$family <- mf$start <- mf$control <- mf$maxit <- NULL
    mf$model <- mf$method <- mf$x <- mf$y <- mf$contrasts <- NULL
    mf$... <- NULL

######

The two marked lines should clearly be

    call <- match.call()

and

    mf <- match.call(expand.dots = FALSE)

The error in the first line can case problems with update() (I
suspect) but the error in the second line does not allow isolated
control arguments (like trace = T) to appear on the main call as
they get passed on to the call to model.frame, causing
pandemonium.  As a confirmation of the second change above,
unless you do have (expand.dots = FALSE) the last line quoted
above has no effect.

Regards,
Bill Venables.

-- 
-----------------------------------------------------------------
Bill Venables, Statistician, CMIS Environmetrics Project.

Physical address:                            Postal address:
CSIRO Marine Laboratories,                   PO Box 120,       
233 Middle St, Cleveland, Queensland         Cleveland, Qld, 4163
AUSTRALIA                                    AUSTRALIA

Telephone: +61 7 3826 7251     Email: Bill.Venables@cmis.csiro.au     
      Fax: +61 7 3826 7304

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:09:43 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:09:43 +0200 (CEST)
Subject: 0.65/AIX
Message-ID: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>

Martin:

With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I cannot get
artihmetic.c to compile---it dies because of undefined acosh etc.

Is this specific of the system that I have access to?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:12:16 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:12:16 +0200 (CEST)
Subject: 0.65/HPUX
Message-ID: <14218.55488.832244.223924@aragorn.ci.tuwien.ac.at>

I am trying to compile 0.65 on HPUX using c89/f77/make.  This dies with

        c89 -I. -I../include -I../../src/include   -DHAVE_CONFIG_H  -g -c Rsock.c -o Rsock.o
cc: "Rsock.c", line 135: error 1588: "WNOHANG" undefined.
cc: "Rsock.c", line 142: error 1000: Unexpected symbol: "pid".
cc: "Rsock.c", line 142: error 1588: "pid_t" undefined.
cc: "Rsock.c", line 144: error 1574: Unknown size for "sa".
cc: "Rsock.c", line 145: error 1530: Undefined struct or union.
cc: "Rsock.c", line 146: error 1530: Undefined struct or union.
cc: "Rsock.c", line 147: error 1588: "SIGCHLD" undefined.
cc: "Rsock.c", line 150: error 1588: "pid" undefined.
cc: "Rsock.c", line 151: error 1527: Incompatible types in cast: Must cast from scalar to scalar or to void type.
*** Error exit code 1

although WNOHANG is defined in sys/wait.h which gets included by
Rsock.c.  Does anyone have an idea what is going on?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 13 07:37:46 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 13 Jul 1999 08:37:46 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907130637.IAA17100@pubhealth.ku.dk>

On Tue, 13 Jul 1999 Bill.Venables@cmis.csiro.au wrote:

> Peter,

[Peter only fixes most of the bugs....]

> There is a clear and simple bug in glm() that I have noticed in
> 0.64.2 (Windows and Unix) but may have been present in earlier
> versions.

It has a long history: the expand.dots = FALSE was introduced in 0.63, 
but the second call has been wrong for longer.

> The two marked lines should clearly be
> 
>     call <- match.call()
> 
> and
> 
>     mf <- match.call(expand.dots = FALSE)

as in S.

I've committed this for 0.65.0.

We have had various discussions about glm: it is proving very hard to
maintain (that is, find the bugs) and is irritatingly different from S.
One option is to reimplement it.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 07:52:01 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 08:52:01 +0200 (CEST)
Subject: 0.65/AIX
Message-ID: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>

Another problem we encounter is that configure finds installbsd as a
usable install program which does not work correctly.  Has anyone else
experienced this?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 10:53:54 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 11:53:54 +0200
Subject: 0.65/AIX
In-Reply-To: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:09:43 +0200 (CEST))
References: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>
Message-ID: <199907130953.LAA14607@sophie.ethz.ch>


    KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
    KH> cannot get artihmetic.c to compile---it dies because of undefined
    KH> acosh etc.

Compilation dies ??    

    KH> Is this specific of the system that I have access to?

Oh dear... the infinite story continues...

The AIX system I have acess to {uname -a ==> AIX percol 2 4 000333104600}
is fine here..
As a matter of fact, I can see in  /usr/include/math.h  that
acosh() is only declared when -D_XOPEN_SOURCE_EXTENDED(=1) !!!

this is what worked here

gcc -I. -I../include -I../../src/include  -DHAVE_CONFIG_H  -g -O2 -D_XOPEN_SOURCE_EXTENDED=1 -c arithmetic.c -o arithmetic.o

a few days ago (I kept the full ./configure; make  shell transcript).

---
I'm trying again with the July 12 snapshot..
+ my line 
======================================================
CFLAGS="-g -O2 -D_XOPEN_SOURCE_EXTENDED"
======================================================
in config.site
((to which configure now adds `` -mno-fp-in-toc ''))


Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 10:59:17 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 11:59:17 +0200
Subject: 0.65/AIX
In-Reply-To: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:52:01 +0200 (CEST))
References: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
Message-ID: <199907130959.LAA14609@sophie.ethz.ch>


    KH> Another problem we encounter is that configure finds installbsd as
    KH> a usable install program which does not work correctly.  Has anyone
    KH> else experienced this?

Well, for me configure gives (as its 2nd output line)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
checking for a BSD compatible install... /usr/bin/installbsd -c
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

But then, I install in the build directory and this may be the reason that
I don't see problems afterwards. 

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 13:40:08 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 14:40:08 +0200
Subject: 0.65/AIX  -D_XOPEN_SOURCE_EXTENDED
In-Reply-To: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 13 Jul 1999 08:09:43 +0200 (CEST))
References: <14218.55335.10455.899343@aragorn.ci.tuwien.ac.at>
Message-ID: <199907131240.OAA14751@sophie.ethz.ch>

>>>>> On Tue, 13 Jul 1999 08:09:43 +0200 (CEST), Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> said:

    KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
    KH> cannot get artihmetic.c to compile---it dies because of undefined
    KH> acosh etc.

    KH> Is this specific of the system that I have access to?

It seems, to some extent.
make went all smooth with the additional -D_XOPEN_SOURCE_EXTENDED
CFLAGS.

My few tests (graphic, dyn.load, Inf,...) completed well
including the  "make check" part till it comes to testing the
"specifics" in ./tests/ which dies when it tries to remake package `eda',
the problem being the already reported Problem when cp'ing libraries that
are already there..
    cp: ../../../../library/lqs/libs/lqs.so: Text file busy
[[that problem is being fixed as well..]]

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 13 13:52:11 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 13 Jul 1999 14:52:11 +0200
Subject: Solution: "ld: bfd assertion fail" making eda.so on Linux (Redhat 6.0)
In-Reply-To: <x2oghlxzix.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 09 Jul 1999 23:51:34 +0200)
References: <199907091605.SAA12966@sophie.ethz.ch> <x2oghlxzix.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907131252.OAA14759@sophie.ethz.ch>

>>>>> On 09 Jul 1999 23:51, Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> said:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> I've (remote) access to a new Linux system which has some flavor of Rehat
    >> installed.
    >> 
    >> Compiling R-0.64.2 fails -- at the end when  eda.so should be made.
    .....> 
    >> mkellers{maechler}425% gcc --version
    >> egcs-2.91.66
    >> mkellers{maechler}426% ld --version
    >> GNU ld 2.9.1
    >> Copyright 1997 Free Software Foundation, Inc.
    >> This program is free software; you may redistribute it under the terms of
    >> the GNU General Public License.  This program has absolutely no warranty.
    >> Supported emulations:
    >> elf_i386
    >> i386linux
    >> 
    >> ------------------
    >> 
    >> I'm guessing that the  gcc/ld/library combination hasn't been 
    >> installed/configured properly... 
    >> ???

    PD> Or hardware. I've been running that combination for a couple of
    PD> months on my home machine and since yesterday on the work machine,
    PD> including a compile from scratch of the official 0.64.2 as late as
    PD> today (the old binary broke due to the __setfpucw silliness).

    PD> But first check the install with 

    PD> rpm -V egcs binutils 

which showed that everything looked okay [by giving no output].

Peter, your guess with "hardware" was actually quite close :

Considering using some Linux clients with Solaris file- (and other)
servers, we still have user home directories (auto)mounted from the Solaris
File-server.
When I work in such a file-system, I get funny compiler and linker errors
such as above,
also, e.g. Splus 5.1 for Linux sometimes (not always!) can't find the
objects that I create -- when they reside on the mounted file system...

Alas, so much for system integration...

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 13 14:07:51 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 13 Jul 1999 09:07:51 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "Tue, 13 Jul 1999 11:53:54 EDT."
 <199907130953.LAA14607@sophie.ethz.ch>
Message-ID: <199907131307.JAA29236@infiniti.ece.cmu.edu>


"Martin" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

KH> Martin: With the recent change of adding -D_XOPEN_SOURCE_EXTENDED I
KH> cannot get artihmetic.c to compile---it dies because of undefined
KH> acosh etc.

Martin> Compilation dies ??    

../../../src/main/arithmetic.c: In function `do_math1':
../../../src/main/arithmetic.c:868: `acosh' undeclared (first use in this function)

KH> Is this specific of the system that I have access to?

Martin> The AIX system I have acess to {uname -a ==> AIX percol 2 4 000333104600}
Martin> is fine here..

Uh, I'm afraid it's not the AIX version, it may be gcc vs. cc
Simply try (I compile in a separate build directory)
cc -E -I. -I../include -I../../../src/include -DHAVE_CONFIG_H  -g -O2 \
-D_XOPEN_SOURCE_EXTENDED=1 ../../../src/main/arithmetic.c | grep \
acosh
which should return "extern     double   acosh(double);"

Three cases, two compilers on an AIX 4.2 box:

-U_XOPEN_SOURCE_EXTENDED - gcc (2.8.1) and cc ok
-D_XOPEN_SOURCE_EXTENDED=1 - gcc fails (no declaration of acosh), cc ok
-D_XOPEN_SOURCE_EXTENDED=2 - gcc and cc ok, both with warnings about
					 redefining _XOPEN_SOURCE_EXTENDED

Sorry, but why do you need _XOPEN_SOURCE_EXTENDED to be defined?  And
why does -D_XOPEN_SOURCE_EXTENDED=2 work, albeit noisely?

Thanks,
  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue Jul 13 16:21:34 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 13 Jul 1999 08:21:34 -0700 (PDT)
Subject: 0.65/AIX
In-Reply-To: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>

On Tue, 13 Jul 1999, Kurt Hornik wrote:

> Another problem we encounter is that configure finds installbsd as a
> usable install program which does not work correctly.  Has anyone else
> experienced this?
> 

No, but I had this problem with the Stata install script. configure
doesn't seem very fussy about what counts as an install program.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:02:41 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:02:41 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <199907131333.PAA14854@sophie.ethz.ch>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
Message-ID: <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

ToV> Sorry, but why do you need _XOPEN_SOURCE_EXTENDED to be defined?  And
ToV> why does -D_XOPEN_SOURCE_EXTENDED=2 work, albeit noisely?

> This is used to be the only flag (from the many I tried about a year ago) 
> for which
>      1/0  
>      is.finite(1)
>      atanh(1)
> worked .

Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
Now, this gives

> 1/0 + 1/0# Inf
[1]INF
> 1/0 - 1/0# NaN
[1]NaNQ

which is only sort of o.k.???

For the time being, I'll commit this version ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:09:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:09:54 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>
References: <14218.57873.550843.696253@aragorn.ci.tuwien.ac.at>
 <Pine.GSO.4.10.9907130820160.17007-100000@wompom.biostat.washington.edu>
Message-ID: <14219.25810.198731.567682@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Tue, 13 Jul 1999, Kurt Hornik wrote:
>> Another problem we encounter is that configure finds installbsd as a
>> usable install program which does not work correctly.  Has anyone else
>> experienced this?
>> 

> No, but I had this problem with the Stata install script. configure
> doesn't seem very fussy about what counts as an install program.

Hmm.  Guess I should hardwire the fix then into configure (if aix and
installbsd then use install-sh).

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 13 17:23:36 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 13 Jul 1999 18:23:36 +0200
Subject: 0.65/AIX
In-Reply-To: Kurt Hornik's message of "Tue, 13 Jul 1999 18:02:41 +0200 (CEST)"
References: <199907131307.JAA29236@infiniti.ece.cmu.edu> 	<199907131333.PAA14854@sophie.ethz.ch> <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
Message-ID: <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
> Now, this gives
> 
> > 1/0 + 1/0# Inf
> [1]INF
> > 1/0 - 1/0# NaN
> [1]NaNQ
> 
> which is only sort of o.k.???

No! ...which is patently WRONG. When this kind of printout, it shows
that the print routines in R are not able to recognize Inf and NaN
(using R_FINITE) which implies that they aren't properly recognized
anywhere else.

> For the time being, I'll commit this version ...

Not for long, I hope...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul 13 17:36:57 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 13 Jul 1999 18:36:57 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
 <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
 <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
Message-ID: <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Hmm ... Compilation-wise it seems that -D_ALL_SOURCE works o.k. for me.
>> Now, this gives
>> 
>> > 1/0 + 1/0# Inf
>> [1]INF
>> > 1/0 - 1/0# NaN
>> [1]NaNQ
>> 
>> which is only sort of o.k.???

> No! ...which is patently WRONG. When this kind of printout, it shows
> that the print routines in R are not able to recognize Inf and NaN
> (using R_FINITE) which implies that they aren't properly recognized
> anywhere else.

>> For the time being, I'll commit this version ...

> Not for long, I hope...

Hmm.

On the system I have access to, I can compile only with

	-D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
or
	-D_ALL_SOURCE

In either case, we get the above.

I will hence use ALL_SOURCE for the time being.

Note that

> 1/0 - 1/0# NaN
[1]NaNQ
> is.nan(1/0 - 1/0)
[1] TRUE

so what is really going on here???

-k


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 13 23:12:48 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Jul 1999 00:12:48 +0200
Subject: 0.65/AIX
In-Reply-To: Kurt Hornik's message of "Tue, 13 Jul 1999 18:36:57 +0200 (CEST)"
References: <199907131307.JAA29236@infiniti.ece.cmu.edu> 	<199907131333.PAA14854@sophie.ethz.ch> 	<14219.25377.308702.802943@aragorn.ci.tuwien.ac.at> 	<x2vhbozfg7.fsf@blueberry.kubism.ku.dk> <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>
Message-ID: <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> On the system I have access to, I can compile only with
> 
> 	-D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
> or
> 	-D_ALL_SOURCE
> 
> In either case, we get the above.
> 
> I will hence use ALL_SOURCE for the time being.
> 
> Note that
> 
> > 1/0 - 1/0# NaN
> [1]NaNQ
> > is.nan(1/0 - 1/0)
> [1] TRUE
> 
> so what is really going on here???

Double "hmmmm"....

Can you run this under gdb? If so, could you set a breakpoint in
EncodeReal and step through it? 

That'll be (roughly)

R -d gdb
(gdb) run
^C
(gdb) break EncodeReal
(gdb) continue
> 1/0
(gdb) next
<etc.>

I bet it never enters the "if (!R_FINITE(x))" branch as it should.
This could happen if HAVE_FINITE and IEEE_754 are both undefined in
Arith.h, or if finite(x) doesn't work in the IEEE way.

>From what Martin has been telling us, AIX is using IEEE format numbers
and arithmetic anyhow, so it should be fairly easy to fudge a better
R_FINITE (and ISNAN too). I think we went through some of that last
time we had R_FINITE/ISNAN and friends on the board, didn't we?
Something pretty close to the following should work:

#define R_FINITE(x) ({double y = x; \
	 *((int *) &y) & 0x7ff00000 != 0x7ff00000})

#define ISNAN(x) ({double y = x; \
	*((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
	(*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

Of course, that kind of code is pretty architecture dependent, etc...
Perhaps one should first check what the status of IEEE macros in AIX
really is.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From 320098218774-0001@t-online.de  Wed Jul 14 01:01:47 1999
From: 320098218774-0001@t-online.de (320098218774-0001@t-online.de)
Date: Wed, 14 Jul 1999 02:01:47 +0200 (MET DST)
Subject: glm code bug (PR#224)
Message-ID: <199907140001.CAA25350@pubhealth.ku.dk>

ripley@stats.ox.ac.uk schrieb:
> On Tue, 13 Jul 1999 Bill.Venables@cmis.csiro.au wrote:
>
> > Peter,
>
> [Peter only fixes most of the bugs....]
>
> > There is a clear and simple bug in glm() that I have noticed in
> > 0.64.2 (Windows and Unix) but may have been present in earlier
> > versions.
>
> It has a long history: the expand.dots = FALSE was introduced in 0.63, 
> but the second call has been wrong for longer.
>
> > The two marked lines should clearly be
> > 
> >     call <- match.call()
> > 
> > and
> > 
> >     mf <- match.call(expand.dots = FALSE)
>
> as in S.
>
> I've committed this for 0.65.0.
>
> We have had various discussions about glm: it is proving very hard to
> maintain (that is, find the bugs) and is irritatingly different from S.
> One option is to reimplement it.

My opinion as a simple user ... reimplement glm is a very good idea!. Just
for the "cosmetic" point of view: please, take out all of these silly *`s 
indicating significant levels in the output. Also, if somebody needs the "null 
deviance" make it as optional, and not in the stardard output.

Best regards,
Pablo.



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 08:24:32 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 09:24:32 +0200
Subject: 0.65/HPUX
In-Reply-To: <9907131048.AA22896@nokomis.stat.umn.edu>
References: <14218.55488.832244.223924@aragorn.ci.tuwien.ac.at>
 <9907131048.AA22896@nokomis.stat.umn.edu>
Message-ID: <199907140724.JAA19840@aragorn.ci.tuwien.ac.at>

>>>>> Luke Tierney writes:

> On HPUX a lot of stuff like this is only available if you set the
> appropriate define, like HPUX_SOURCE_ or POSIX_SOURCE_.  Unless that
> is set in an include file, I suspect it is needed with the c89 command
> line.

Thanks.  Seems that c89 needs -D_HPUX_SOURCE so I now define this via
Platform.h.  We also seem to need -L/lib/pa1.1 in LIBS.

The problem I now seem to have is that alloca is not found when loading
the main binary ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 13:40:52 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 14:40:52 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
Message-ID: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>

I've made some more changes to configure/make which still don't solve
everything but I think I have to stop for now.

Status AIX:

* I can compile with gcc/f77/make.
* AIX make check fails (cannot build base-Ex.R).
* GNU make check fails in the contour example.
* Plotting is broken (tickmarks go all the way thru).
* IEEE fp stuff is strange (will look into this).
* I still need f77 for linking.  Using ld with the suggested flags gives
  a binary with `exec format error'.  The problem seems to be with an
  unreferenced __start.
* The basic add-ons seem to work, though.

Status HPUX:

* I can compile the main binary with c89/f77/make.
* Compilation fails in eda (syntax error in etc/Makeconf).  The problem
  disappears when the SHLIB target is commented ... but then building
  the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
* QUESTION: what about src/unix/hpdlfcn.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 15:56:23 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 16:56:23 +0200 (CEST)
Subject: docs: topic && availability
Message-ID: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>

I think that users quite often want to answers to questions like ``Is
there something to do FOO in R?'', where FOO might e.g. be ``isotonic
regression''.  The answer should be something like ``you can use BAR in
package BAZ, or ...''.

For this, full text search is not the right approach and the keywords
are not enough.  We could maybe search dedicated fields (like \title),
but I think what we really want is something like an \index{} entry.
(I am not sure whether we want concept/variable/function/... indices a
la Texinfo.)

Access/retrieval could even happen on the command line via something
like
	help(topic = "FOO")

However, I am not sure what the right back-end is.  We definitely do not
want to confine the search to the loaded packages.  But even the locally
available ones are not enough.  On the other hand, I don't think doing
all topic lookups via CRAN is the right thing, either.  So maybe

	help(topic = "FOO")

would use all topic indices in R_LIBS but there could be a message
indicating that one can also use CRAN for lookup via WWW.

Opinions?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 14 16:07:25 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 14 Jul 1999 17:07:25 +0200
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 14 Jul 1999 14:40:52 +0200 (CEST))
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
Message-ID: <199907141507.RAA27266@sophie.ethz.ch>


    KH> I've made some more changes to configure/make which still don't solve
    KH> everything but I think I have to stop for now.

too bad (the "stop for now").

    KH> Status AIX:

    KH> * I can compile with gcc/f77/make.
    KH> * AIX make check fails (cannot build base-Ex.R).
    KH> * GNU make check fails in the contour example.
    KH> * Plotting is broken (tickmarks go all the way thru).

This is exactly the typical result of the next item :
In my experience, whenever  is.finite(), finite()  1/0, 0/0 etc weren't ok
(and as Peter emphasized, they are *not at all* as long as you get
 "INF" and "NaNQ"  instead of "Inf" and "NaN")
then the graphics show the above symptome.

The way that I found that -D_XOPEN_SOURCE_EXTENDED
will save me, was by looking into /usr/include/math.h

It seems that you (and Thomas Vogels !) have a different one, than, even
though Thomas said that he had AIX 4.2 as well?
This is what I have :

    $ uname -a
    AIX percol 2 4 000333104600

    $ ls -l /usr/include/math.h
    -r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

What versions of AIX 4.2 are around?


    KH> * IEEE fp stuff is strange (will look into this).
    KH> * I still need f77 for linking.  Using ld with the suggested flags gives
    KH> a binary with `exec format error'.  The problem seems to be with an
    KH> unreferenced __start.
    KH> * The basic add-ons seem to work, though.


    KH> Status HPUX:

    KH> * I can compile the main binary with c89/f77/make.
    KH> * Compilation fails in eda (syntax error in etc/Makeconf).  The problem
    KH> disappears when the SHLIB target is commented ... but then building
    KH> the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
				       ~~~~~~~~~
				       sure about that ??

    KH> * QUESTION: what about src/unix/hpdlfcn.c?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 14 16:18:46 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 14 Jul 1999 17:18:46 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <199907141507.RAA27266@sophie.ethz.ch>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
Message-ID: <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

KH> I've made some more changes to configure/make which still don't solve
KH> everything but I think I have to stop for now.

> too bad (the "stop for now").

(Well, the point is that the experimental approach is very inefficient.
We need someone who really knows about these platforms.)

KH> Status AIX:

KH> * I can compile with gcc/f77/make.
KH> * AIX make check fails (cannot build base-Ex.R).
KH> * GNU make check fails in the contour example.
KH> * Plotting is broken (tickmarks go all the way thru).

> This is exactly the typical result of the next item : In my
> experience, whenever is.finite(), finite() 1/0, 0/0 etc weren't ok
> (and as Peter emphasized, they are *not at all* as long as you get
> "INF" and "NaNQ" instead of "Inf" and "NaN") then the graphics show
> the above symptome.

Hmm.  Perhaps we can nail that down.  My impression was that the finite
et al tests I tried were o.k.  Do you know what exactly causes the
plotting problem?

> The way that I found that -D_XOPEN_SOURCE_EXTENDED
> will save me, was by looking into /usr/include/math.h

> It seems that you (and Thomas Vogels !) have a different one, than,
> even though Thomas said that he had AIX 4.2 as well?  This is what I
> have :

>     $ uname -a
>     AIX percol 2 4 000333104600

>     $ ls -l /usr/include/math.h
>     -r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

> What versions of AIX 4.2 are around?

I have

e8725245@fbma:/home2/e8725245$ uname -a
AIX fbma 2 4 000147825700
e8725245@fbma:/home2/e8725245$ ls -l /usr/include/math.h 
-r--r--r--   1 bin      bin        14620 Oct 14 1996  /usr/include/math.h

Also,

e8725245@fbma:/home2/e8725245$ ls -l /usr/bin/f77 
-rwxr-xr-x   3 bin      bin        99453 May  7 1998  /usr/bin/f77*
e8725245@fbma:/home2/e8725245$ gcc --version
2.7.2
e8725245@fbma:/home2/e8725245$ gmake --version
GNU Make version 3.77, by Richard Stallman and Roland McGrath.

KH> * IEEE fp stuff is strange (will look into this).
KH> * I still need f77 for linking.  Using ld with the suggested flags gives
KH> a binary with `exec format error'.  The problem seems to be with an
KH> unreferenced __start.
KH> * The basic add-ons seem to work, though.


KH> Status HPUX:

KH> * I can compile the main binary with c89/f77/make.
KH> * Compilation fails in eda (syntax error in etc/Makeconf).  The problem
KH> disappears when the SHLIB target is commented ... but then building
KH> the shared lib fails.  I tried xlispstat -Wl,-E instead but no.
> 				       ~~~~~~~~~
> 				       sure about that ??

3-52-5 configure has

    *hpux*)
      FOREIGN_FILE="sysvr4-foreign.h"
      AC_DEFINE(HAVE_FOREIGN)
      AC_DEFINE(HAVE_DLOPEN)
      UCFLAGS="$UCFLAGS -Imachines/hpux/dlfcn"
      EXTRAOBJS="$EXTRAOBJS dlfcn.o"
      link_sources="$link_sources machines/hpux/dlfcn/dlfcn.c"
      link_targets="$link_targets dlfcn.c"
      EXTRALIBS="$EXTRALIBS -ldld"
      ULDFLAGS="$ULDFLAGS -Wl,-E"
      foreign=1


KH> * QUESTION: what about src/unix/hpdlfcn.c?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 14 16:41:50 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 14 Jul 1999 17:41:50 +0200
Subject: tseries package -- license
Message-ID: <199907141541.RAA27707@sophie.ethz.ch>


Thanks a lot for "tseries"!

The new (0.1-2) version of the tseries package
contains the following in ./README :

>> Author(s): A. Trapletti <A.Trapletti@ci.tuwien.ac.at>, 
>>         B. LeBaron ("./src/bdstest.c"),
>>         K. Krischer, and T. M. Kruel ("./src/muin2ser.f", 
>>         "./misc/mutinfo-1.21b.tar.gz")

>> License: "./src/muin2ser.f", "./misc/mutinfo-1.21b.tar.gz" are 
>>         free for non-commercial purposes. "./src/bdstest.c" is 
>>         free. The remainder is covered by GPL version 2 or 
>>         newer; see file COPYING

I think the ``free for non-commercial purposes''
is not good enough for us.

Could you try to contact K.Krischer und T.M.Kruel and ask if they would
release their software under GPL (or something similar)?

If not, it may be worth to separate your "tseries" package into a
free part (that can be put onto CD-ROMs !),
and a non-free part (that CAN'T be put onto CD-ROMs) for the "muin/mutinfo"
stuff.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 14 20:05:25 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 14 Jul 1999 15:05:25 -0400
Subject: docs: topic && availability
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
Message-ID: <378CDF72.5499BD27@bank-banque-canada.ca>

I've often thought that some sort of synonym dictionary would be useful,
especially for new users. That is, give the name of some procedure, say
in Matlab, SAS or SPSS, or even a statistical term, and get information
about possible procedures to consider in S/R (and the other way around
too). I think this might be much more broadly useful than just for R, so
I wouldn't tie it too closely to R help() or CRAN.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From s-harker@adfa.edu.au  Thu Jul 15 03:28:02 1999
From: s-harker@adfa.edu.au (s-harker@adfa.edu.au)
Date: Thu, 15 Jul 1999 04:28:02 +0200 (MET DST)
Subject: pch and mkh bug PR#225
Message-ID: <199907150228.EAA02869@pubhealth.ku.dk>

I am sorry about the problem caused by my first attempt at reporting a
bug.  This is a followup to my report PR#225, hopefully being more
useful.  By not I have a better understanding of the problems being
reported.

I wish to report one bug relating to plot character and to mention two
other possible bugs (these may relate to differences between R and S)
I have noticed with R.  We have recently installed R and I am
converting some scripts I had previously used with a very old version
of S (not Splus).  The R version information is:

platform   sparc-sun-solaris2.5.1
arch       sparc                 
os         solaris2.5.1          
system     sparc, solaris2.5.1   
status                           
status.rev 0                     
major      0                     
minor      64.2                  
year       1999                  
month      July                  
day        3                     
language   R  

In the following I will be quoting some extracts from R A Becker, J M
Chambers and A R Wilks _The New S Language_, Wadsworth & Brooks/Cole
1988, isbn 0-534-09192-X.  We have a copy of this book since, although
our departmental server did not update from S to Splus, the campus
server did.  I am using this as an authority to report some of the
following as being bugs.

(1)  First the boxes drawn using `points()' via the following example

Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15),type="n")
points(X,Y,pch=0,mkh=0.02)
points(X,Y,pch=0,mkh=1.0)
points(X,Y-1,pch=0,cex=4.0)
points(X,Y-1,pch=0,cex=0.02)

are of a size that indicated that the mkh value is being ignored (the
upper set of boxes).  This can be fixed by using cex (the lower set of
boxes).  However, the S manual states that `mkh' gives the height in
inches of mark symbols drawn when `pch' is given as a number.  This
comment is also made in the help for the `par' function within R.  This
would appear to be a bug, using `cex' is correct only when giving a
character.

(2)  The plotting of axis labels on an axis becomes confused if the
`at' vector is descending.  For exaample, consider the following:

labels <- c("A", "B", "C", "D")
Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15))
axis(side=4,at=Y,labels=labels)

According to the S manual `label[i]' is plotted at coordinate `at[i]'.
Although S (or R) plot the vector in ascending order this still worked
(in old S, anyway), it may have been a feature.  However, R appears to
sort `at[i]' but not do a corresponding sort on label[i].  The R help
does not make the statement about plotting `label[i]' at coordinate
`at[i]', so this may be a difference between S and R.  It can be
overcome by appropriate pre-sorting of the two vectors.

(3)  The use of `mtext' only works for a string, not for a vector of
strings.  For example, the following commands.

labels <- c("A", "B", "C", "D")
Y <- c(13.75, 10.50, 7.25, 4.0)
X <- c(1, 2, 3, 4)
plot(X,Y,
 xlim=c(0,5),ylim=c(0,15))
mtext(text=labels, side=4, line=0.5, at=Y)

plots only the first of the elements of `labels'.  Again, this may
reflect a difference between S and R.  The S manual states that `text'
is a character vector to be plotted and `at' is an optional vector of
positions.  However, the R help states that `text' is a character
string and `at' gives the location in user coordiates.  This can be
overcome by plotting `labels[i]' at `at[i]' within a loop.

-- 
Stephen Harker                                        s-harker@adfa.edu.au
School of Physics               Baloney Baffles brains: Eric Frank Russell
University College                http://www.adfa.edu.au/physics/s-harker/
UNSW, ADFA

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 08:14:46 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 15 Jul 1999 09:14:46 +0200 (MET DST)
Subject: which() does not handle NAs in named vectors. (PR#226)
Message-ID: <199907150714.JAA03804@pubhealth.ku.dk>

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

-- It is unclear to me that the handling of NAs is desirable, and it
   has problems with names:

> z <- c(T,T,NA,F,T)
> names(z) <- letters[1:5]
> which(z)
Error: names attribute must be the same length as the vector
      
(Why do the vector and its names have different subscripts?  And while
you are correcting this,

Arguments:

       x: a logical vector or array.  `NA's are allowed an
          omitted.
  
has a typo, and the logic can be simplified: see below.)

On Thu, 15 Jul 1999, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
>     BDR> On Wed, 14 Jul 1999, Friedrich Leisch wrote:
>     >> >>>>> On Wed, 14 Jul 1999 04:09:21, >>>>> Peter B Mandeville (PBM)
>     >> wrote:
>     >> 
>     PBM> I have a vector Pes with 600 elements some of which are NA's. How
>     PBM> can I form a vector of the indices of the NA's.
>     >>
>     PBM> for(i in 1:600) if(is.na(Pes[i])) print(i)
>     >>
>     PBM> prints the indices of the NA's but I can't figure out how to put
>     PBM> the results in a vector.
>     >>  try this:
>     >> 
>     >> x <- (1:length(Pes))[is.na(Pes)]
> 
>     BDR> Tip: that sort of thing often fails for a length 0 vector. The
>     BDR> `approved' spell is
> 
>     BDR> seq(along=Pes)[is.na(Pes)]
> 
>     BDR> In this case it does not matter as the subscript is of length 0,
>     BDR> but it has floored enough library/package writers to be worth
>     BDR> thinking about.
> 
> Good teaching about seq() vs.  1:n 
> 
> However, the solution I gave 
> 
>      which(is.na(Pes))
> 
> is the one I stilly really recommend; 
> it does deal with 0-length objects, and it keeps names when there are some,
> and it has an `arr.ind = FALSE' argument to return array indices instead of
> vector indices when so desired.

Yes, but

-- It is not in S (so causing difficulty in porting from R to S)
-- It looks a relatively expensive operation.
-- Internally which could be simplified by using seq(along=) as it
   is a wrapper for this construct, but actually the separate
   handling of n == 0 is unnecessary (as logic & !is.na(logic) will have
   length zero.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Thu Jul 15 09:04:53 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Thu, 15 Jul 1999 08:04:53 +0000
Subject: tseries package -- license
References: <199907141541.RAA27707@sophie.ethz.ch>
Message-ID: <378D9625.50BB8F9F@wu-wien.ac.at>

Martin Maechler wrote:

> Thanks a lot for "tseries"!
>
> The new (0.1-2) version of the tseries package
> contains the following in ./README :
>
> >> Author(s): A. Trapletti <A.Trapletti@ci.tuwien.ac.at>,
> >>         B. LeBaron ("./src/bdstest.c"),
> >>         K. Krischer, and T. M. Kruel ("./src/muin2ser.f",
> >>         "./misc/mutinfo-1.21b.tar.gz")
>
> >> License: "./src/muin2ser.f", "./misc/mutinfo-1.21b.tar.gz" are
> >>         free for non-commercial purposes. "./src/bdstest.c" is
> >>         free. The remainder is covered by GPL version 2 or
> >>         newer; see file COPYING
>
> I think the ``free for non-commercial purposes''
> is not good enough for us.
>
> Could you try to contact K.Krischer und T.M.Kruel and ask if they would
> release their software under GPL (or something similar)?

I will try...

>
>
> If not, it may be worth to separate your "tseries" package into a
> free part (that can be put onto CD-ROMs !),
> and a non-free part (that CAN'T be put onto CD-ROMs) for the "muin/mutinfo"
> stuff.

The non-free part only contains the "amif" function. I think although the
"auto mutual information" is a nice toy, it is not a very big loss, if we
don't have it in the "free" tseries package.

Adrian

>
>
> Martin

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 10:28:13 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 15 Jul 1999 11:28:13 +0200 (MET DST)
Subject: .Last is usually not called (PR#227)
Message-ID: <199907150928.LAA05145@pubhealth.ku.dk>

R-0.64.2 and R-devel:

[I found this by looking at the code.]

A .Last function is _only_ called if the condition that causes termination
is EOF on the console or input:

> .Last <- function() cat("ran .Last\n")
> q("no")
returns to the shell.

> .Last <- function() cat("ran .Last\n")
> # I hit ^D here
ran .Last
Save workspace image? [y/n/c]: n

The problem is that .Last is handled in end_Rmainloop(), and that is
not called by q(). We need to move the handling to R_CleanUp (and
for some reason do_quit is system-dependent, so need not even call
R_CleanUp). I'll work on this.

I did check the documentation: ?quit does claim .Last should be called:

     Immediately before terminating, the function `.Last()'
     is executed if it exists.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul 15 12:53:54 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu, 15 Jul 1999 13:53:54 +0200 (MET DST)
Subject: [R] R: ts - objects (PR#228)
Message-ID: <199907151153.NAA06756@pubhealth.ku.dk>

Marcus Eger <marcus.eger@physik.uni-marburg.de> writes:

> > time(sqrt(arrts))
> Time Series:
> Start = c(1, 1) 
> End = c(5, 1) 
> Frequency = 1 
> [1] 1 2 3 4 5

Looks like a bug...

> ----------------------------------------------------------------------------
> 2. (At least) boolean indexing with matrices does not seem to work
> properly:
> ----------------------------------------------------------------------------
> > arrts[is.finite(arrts)]
> Error: subscript (10) out of bounds, should be at most 5
> > 
> > unclass(arrts)[is.finite(arrts)]
>  [1]  1  2  3  4  5  6  7  8  9 10

Yes, we discussed that a short while ago on R-devel. It's trying too
hard to retain the ts attributes in these cases.

> 
> ----------------------------------------------------------------------------
> This problem arose when I tried to plot my time series: > plot(arrts)
> It was easy to fix in plot.ts:
> ----------------------------------------------------------------------------
> ....
>   if (is.null(ylim)) 
>     ylim <- range(unclass(x)[is.finite(x)])  #by ME, 14-07-99
> #    ylim <- range(x[is.finite(x)])
>   plot.new()
> ....

...although range(x,finite=T) is probably a better fix.

> 
> -----------------------------------------------------------------------------
> 3. Another problem had to do with the value of delta and/or start:
> -----------------------------------------------------------------------------
> > time(ts(c(1,2,3,4),start=3,delta=1.5))
> Error: invalid start

or just: 

> ts(c(1,2,3,4),start=3,delta=1.5)
Time Series:
Start = c(3, 1) 
End = c(7, 1) 
Frequency = 0.666666666666667 
Error: invalid start

..which is pretty darn weird! CC'ed to R-bugs.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 13:57:22 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 14:57:22 +0200
Subject: which() does not handle NAs in named vectors. (PR#226)
In-Reply-To: <199907150714.JAA03804@pubhealth.ku.dk> (ripley@stats.ox.ac.uk)
References: <199907150714.JAA03804@pubhealth.ku.dk>
Message-ID: <199907151257.OAA06166@sophie.ethz.ch>

>>>>> On Thu, 15 Jul 1999 09:14, ripley@stats.ox.ac.uk (Brian D. Ripley) said:

Thank you for the bug report

    BDR> -- It is unclear to me that the handling of NAs is desirable, and
    BDR> it has problems with names:

{function which in its present form very much evolved out of user wishes...}

    BDR> z <- c(T,T,NA,F,T)
    BDR> names(z) <- letters[1:5]
    BDR> which(z)
    BDR> Error: names attribute must be the same length as the vector

fixed for release-patches [available in a day or two from CRAN src/devel/]
and hence every new release.

    BDR> (Why do the vector and its names have different subscripts?  And
    BDR> while you are correcting this,

    BDR> Arguments:

    BDR>        x: a logical vector or array.  `NA's are allowed an
    BDR>	   omitted.

is now

       x: a `logical' vector or array.  `NA's are allowed
          and omitted (treated as if `FALSE').

  
    BDR> has a typo, and the logic can be simplified: see below.)

    BDR> On Thu, 15 Jul 1999, Martin Maechler wrote:

    >> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
    >> 
    BDR> On Wed, 14 Jul 1999, Friedrich Leisch wrote:
    >> >> >>>>> On Wed, 14 Jul 1999 04:09:21, >>>>> Peter B Mandeville
    >> (PBM) >> wrote:
    >> >> 
    PBM> I have a vector Pes with 600 elements some of which are NA's. How
    PBM> can I form a vector of the indices of the NA's.
    >> >>
    PBM> for(i in 1:600) if(is.na(Pes[i])) print(i)
    >> >>
    PBM> prints the indices of the NA's but I can't figure out how to put
    PBM> the results in a vector.
    >> >> try this:
    >> >> 
    >> >> x <- (1:length(Pes))[is.na(Pes)]
    >> 
    BDR> Tip: that sort of thing often fails for a length 0 vector. The
    BDR> `approved' spell is
    >>
    BDR> seq(along=Pes)[is.na(Pes)]

BTW, currently  seq(along = x)  returns "numeric" ("double") 
whereas		1:length(x)     returns "integer".
I'm about to fix this...

    BDR> In this case it does not matter as the subscript is of length 0,
    BDR> but it has floored enough library/package writers to be worth
    BDR> thinking about.
    >>  Good teaching about seq() vs.  1:n
    >> 
    >> However, the solution I gave
    >> 
    >> which(is.na(Pes))
    >> 
    >> is the one I stilly really recommend; it does deal with 0-length
    >> objects, and it keeps names when there are some, and it has an
    >> `arr.ind = FALSE' argument to return array indices instead of vector
    >> indices when so desired.

    BDR> Yes, but

    BDR> -- It is not in S (so causing difficulty in porting from R to S)

Well, I know what you mean and your point is all well in the above case...
but anyway:
Our group here has been using this ("which" function) in S for quite a while and
eventually, someone will have to collect a library of things from R, missing in
S-plus and easily implementable.

And then, for quite a few R users, S-plus backward compatibility is not the
big issue. Locally, in our collection of S-plus add-ons, we've got already
quite a few of them.. 
And in other ways, R is so much nicer
    - math annotation in graphics
    - color, line types  {  plot(x,y, col="light blue", col.main = "blue") }
    - filled.contour
    - persp() with shading..

I think if you want to live in both worlds, I want (and recommend) to use

    if(is.R()) {

       ...R specific...

    } 
    else { ## S-plus ---

       ...S-plus specific...

    }

anyway, even within user written functions
and make sure (via .First or S_FIRST or ...)  that is.R() |--> FALSE in S-plus


    BDR> -- It looks a relatively expensive operation.

I don't think it is expensive (for arr.ind=FALSE !) if you want to do deal
with missings (NA) at all.  (Peter's example above is one of the few places 
where you are absolutely sure there are no missings...)
Assume x has some NAs, e.g.
    x <- rnorm(1000); x[1000*runif(rpois(1,lam=50))] <- NA
Then
    which( x < -2 )  

works how one would want;

    seq(along = x)[x < -2]

gives silly NA's (which make sense for the logical vector but not for the
		 extraction).

    BDR> -- Internally which could be simplified by using seq(along=) as it is a wrapper for
    BDR> this construct, but actually the separate handling of n == 0 is
    BDR> unnecessary (as logic & !is.na(logic) will have length zero.)

You are right, and that's part of the fix for `which' which is currently

which <- function(logic, arr.ind = FALSE)
{
    if(!is.logical(logic))
	stop("argument to \"which\" is not logical")
    wh <- seq(along=logic)[ll <- logic & !is.na(logic)]
    if ((m <- length(wh)) > 0) {
	dl <- dim(logic)
	if (is.null(dl) || !arr.ind) {
	    names(wh) <- names(logic)[ll]
	}
	else { ##-- return a matrix  length(wh) x rank
	    rank <- length(dl)
	    wh1 <- wh - 1
	    wh <- 1 + wh1 %% dl[1]
	    wh <- matrix(wh, nrow = m, ncol = rank,
			 dimnames =
			 list(dimnames(logic)[[1]][wh],
			      if(rank == 2) c("row", "col")# for matrices
			      else paste("dim", 1:rank, sep="")))
	    if(rank >= 2) {
		denom <- 1
		for (i in 2:rank) {
		    denom <- denom * dl[i-1]
		    nextd1 <- wh1 %/% denom# (next dim of elements) - 1
		    wh[,i] <- 1 + nextd1 %% dl[i]
		}
	    }
	    storage.mode(wh) <- "integer"
	}
    }
    wh
}
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 14:03:56 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 15:03:56 +0200 (CEST)
Subject: [R] R: ts - objects (PR#228)
In-Reply-To: <199907151153.NAA06756@pubhealth.ku.dk>
Message-ID: <XFMail.990715150356.plummer@iarc.fr>

> Marcus Eger <marcus.eger@physik.uni-marburg.de> writes:
>> 
>> -----------------------------------------------------------------------------
>> 3. Another problem had to do with the value of delta and/or start:
>> -----------------------------------------------------------------------------
>> > time(ts(c(1,2,3,4),start=3,delta=1.5))
>> Error: invalid start
> 
> or just: 
> 
>> ts(c(1,2,3,4),start=3,delta=1.5)
> Time Series:
> Start = c(3, 1) 
> End = c(7, 1) 
> Frequency = 0.666666666666667 
> Error: invalid start
> 
> ..which is pretty darn weird! CC'ed to R-bugs.

That's just the print method for ts objects calling
time().

The underlying problem is in start().
> start(x)
[1] 3 1

I think the 2-vector form of start and end only makes sense when the
frequency is an integer. If I am right then the following versions of
start.ts and end.ts (which check that tsp[3] is an integer) should solve
the problem.

M.

"start.ts" <- function (x) 
{
    ts.eps <- .Options$ts.eps
    ##if(is.null(ts.eps)) ts.eps <- 1.e-5
    tsp <- attr(as.ts(x), "tsp")
    is <- tsp[1] * tsp[3]
    if (abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < 
        ts.eps) {
        is <- floor(tsp[1])
        fs <- floor(tsp[3] * (tsp[1] - is) + 0.001)
        c(is, fs + 1)
    }
    else tsp[1]
}

"end.ts" <- function(x)
{
    ts.eps <- .Options$ts.eps
    ## if(is.null(ts.eps)) ts.eps <- 1.e-5
    tsp <- attr(as.ts(x), "tsp")
    is <- tsp[2] * tsp[3]
    if (abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < 
        ts.eps) {
        is <- floor(tsp[2])
        fs <- floor(tsp[3] * (tsp[2] - is) + 0.001)
        c(is, fs + 1)
    }
    else tsp[2]
}

M.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Thu Jul 15 16:19:22 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Thu, 15 Jul 1999 15:19:22 +0000
Subject: tseries
References: <XFMail.990715163125.plummer@iarc.fr>
Message-ID: <378DFBF9.FE784F5E@wu-wien.ac.at>

Martyn Plummer wrote:

> Dear Adrian,

Hi Martin

>
>
> Thank you for providing your time series library for R. I have been
> working on a time series package myself, with help from Paul Gilbert. It
> is called "bats" (doesn't stand for anything except possibly "basic time
> series") and can be found in the devel directory on CRAN.
>
> The "bats" library was a collection of S-PLUS compatibile functions
> that I needed for my "coda" package. With a little encouragement from
> Paul, I split these off into a separate package and developed them into
> more-or-less full clones of the S-PLUS functions. There are a couple of
> functions yet unwritten (autoregressive estimation via Burg's algorithm
> and spectral density estimation from fitting ar models) and this is the
> only reason why the package is in the "devel" directory.
>
> I am writing to ask if you would like to merge the two libraries
> together. The primary design goal of bats is compatibility with S-PLUS,

Even if I would like to, it would not be easy for me because I don't have
access to any S-PLUS.

To the R developpers: Is that a primary design goal?

>
> which may not be what you want. In any case, both libraries are GPL so
> you are free to use any of the code. Please have a look at bats and
> tell me what you think.
>
> Martyn

I compared the acf functions of both "bats" and "tseries":

> x<-rnorm(10000)
> library(bats)
> x<-rnorm(10000)
> system.time(a<-acf(x,1000))
[1] 15.70  0.02 31.00  0.00  0.00
> library(tseries)
> system.time(a<-acf(x,1000,pl=F))
[1] 0.29 0.00 1.00 0.00 0.00
>

I think, to achieve a better performance you should avoid loops of the
order of the length of a usual data set. It makes your routines very slow.

Though I think we should here some opinions about the design of a time
series library and then we can discuss about merging any parts or splitting
some programming work for THE R time series library.

Thanks

Adrian


--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 15 16:47:25 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 15 Jul 1999 17:47:25 +0200 (CEST)
Subject: docs: topic && availability
In-Reply-To: <378CDF72.5499BD27@bank-banque-canada.ca>
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
 <378CDF72.5499BD27@bank-banque-canada.ca>
Message-ID: <14222.653.137118.492844@balin.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> I've often thought that some sort of synonym dictionary would be
> useful, especially for new users. That is, give the name of some
> procedure, say in Matlab, SAS or SPSS, or even a statistical term, and
> get information about possible procedures to consider in S/R (and the
> other way around too). I think this might be much more broadly useful
> than just for R, so I wouldn't tie it too closely to R help() or CRAN.

Yes, it is much more broadly useful.

Nevertheless, using \index{} in Rd files would be one source for such
info, almost ``for free'' ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 16:51:04 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 15 Jul 1999 16:51:04 +0100 (BST)
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <Pine.GSO.4.05.9907151649240.26531-100000@auk.stats>

On Thu, 15 Jul 1999, Adrian Trapletti wrote:

> Martyn Plummer wrote:
> 
> > Dear Adrian,
> 
> Hi Martin
> 
> >
> >
> > Thank you for providing your time series library for R. I have been
> > working on a time series package myself, with help from Paul Gilbert. It
> > is called "bats" (doesn't stand for anything except possibly "basic time
> > series") and can be found in the devel directory on CRAN.
> >
> > The "bats" library was a collection of S-PLUS compatibile functions
> > that I needed for my "coda" package. With a little encouragement from
> > Paul, I split these off into a separate package and developed them into
> > more-or-less full clones of the S-PLUS functions. There are a couple of
> > functions yet unwritten (autoregressive estimation via Burg's algorithm
> > and spectral density estimation from fitting ar models) and this is the
> > only reason why the package is in the "devel" directory.
> >
> > I am writing to ask if you would like to merge the two libraries
> > together. The primary design goal of bats is compatibility with S-PLUS,
> 
> Even if I would like to, it would not be easy for me because I don't have
> access to any S-PLUS.
> 
> To the R developpers: Is that a primary design goal?

One design goal for one library.

> >
> > which may not be what you want. In any case, both libraries are GPL so
> > you are free to use any of the code. Please have a look at bats and
> > tell me what you think.
> >
> > Martyn
> 
> I compared the acf functions of both "bats" and "tseries":
> 
> > x<-rnorm(10000)
> > library(bats)
> > x<-rnorm(10000)
> > system.time(a<-acf(x,1000))
> [1] 15.70  0.02 31.00  0.00  0.00
> > library(tseries)
> > system.time(a<-acf(x,1000,pl=F))
> [1] 0.29 0.00 1.00 0.00 0.00
> >
> 
> I think, to achieve a better performance you should avoid loops of the
> order of the length of a usual data set. It makes your routines very slow.
> 
> Though I think we should here some opinions about the design of a time
> series library and then we can discuss about merging any parts or splitting
> some programming work for THE R time series library.

I have been promising to do this for some time (indeed, promised Adrian
to do so). Let me try to do some work on this and come to a proposal
shortly.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 17:04:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 18:04:09 +0200
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at> (message from Adrian Trapletti
 on Thu, 15 Jul 1999 15:19:22 +0000)
References: <XFMail.990715163125.plummer@iarc.fr> <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <199907151604.SAA10786@sophie.ethz.ch>

Dear Adrian (and everyone else),

to the same topic,
I've got a file "tseries-comments" five days old that I never got around
polishing before sending to you :

>> Thank you very much for the functionality !
>> 
>> - tsparam : not the best name for that class.. ???
>> 
>>    ybnd : should be allowed to have EITHER length 1 of length = length(x)
>> 
>>    --> my patched version
>> 
>> - plot.tsparam: 	use 'type = "h"'  as default!
>> 
>> - acf, pacf :
>> 
>> 	are *one* function in S-plus,
>> 
>> 	use 'plot = T', not 'pl = T'  as argument
>> 			(in line with several other R functions !)
>> 
>>   --> other small improvements...
>> 
>>   {including:  instead of  rep(0, nnn),  use numeric(nnn) }
>> 
>>    --> my version
>> [[ I'll send this in private to Adrian ]]

As you see, 
some of these 5day old comments are in line with Martyn's 
(he is Martyn, I am Martin). 

A few thoughts :

- Yes, we want to be S(-plus) compatible as long as it is not too hard or
  there are not good reasons against compatibility.
 
  Particularly,  acf(), spec.pgram(),  spectrum(), ar(), ar.yw()
  should have compatible argument names [at least for the important ones]
  to make it easy to many users moving from S to R (;-).

- Of course, it is *the wise thing* to use FFT for acf -- for the case of no
  NAs.. [and I think the NA case should be handled as well, and for small
        no-NA series that straightforward method will probably be faster
	than FFT as well ].

- I'd very much appreciate if Martyn and you and Paul G. 
  (and Brian and Ross and ... 
   and me, we also have a few improvements on S-plus laying around here)
  could coordinate to produce ``the real'' time series package for R.

- As a matter of fact, I hope that some of the functions would become part
  of "Core R" (such as e.g. "modreg" is base of "Core R"),
  since e.g., the availability of  acf()  should not depend on having a
  contributed package installed on top of "Core R".

Thanks once more to all the "time series" coders !
Martin

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 17:19:11 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 18:19:11 +0200 (CEST)
Subject: tseries
In-Reply-To: <378DFBF9.FE784F5E@wu-wien.ac.at>
Message-ID: <XFMail.990715181911.plummer@iarc.fr>

On 15-Jul-99 Adrian Trapletti wrote:
> Martyn Plummer wrote:
>> I am writing to ask if you would like to merge the two libraries
>> together. The primary design goal of bats is compatibility with S-PLUS,
> 
> Even if I would like to, it would not be easy for me because I don't have
> access to any S-PLUS.

Oh.
 
> To the R developpers: Is that a primary design goal?

A delicate question. Some people have strong views on compatibility, but
I think it is safe to say that compatibility with S considered a good thing
as it makes it easier to port existing S code to R, and that on that basis
incompatibilities are considered bugs, unless there is a good reason for
doing something differently.

However, here we are talking about the PLUS part of S-PLUS, for which there
are fewer precedents, and it may even be good politics to do things differently.

>>
>> which may not be what you want. In any case, both libraries are GPL so
>> you are free to use any of the code. Please have a look at bats and
>> tell me what you think.
>>
>> Martyn
> 
> I compared the acf functions of both "bats" and "tseries":
> 
>> x<-rnorm(10000)
>> library(bats)
>> x<-rnorm(10000)
>> system.time(a<-acf(x,1000))
> [1] 15.70  0.02 31.00  0.00  0.00
>> library(tseries)
>> system.time(a<-acf(x,1000,pl=F))
> [1] 0.29 0.00 1.00 0.00 0.00
>>
> 
> I think, to achieve a better performance you should avoid loops of the
> order of the length of a usual data set. It makes your routines very slow.

Ouch! I know that acf isn't very efficient, but on the other hand I have
never wanted to calculate the acf to this order, and if I did I would
certainly use fft too.
 
> Though I think we should here some opinions about the design of a time
> series library and then we can discuss about merging any parts or splitting
> some programming work for THE R time series library.
> 
> Thanks
> 
> Adrian

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 15 17:30:12 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 15 Jul 1999 18:30:12 +0200 (CEST)
Subject: tseries
In-Reply-To: <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <XFMail.990715183012.plummer@iarc.fr>

On 15-Jul-99 Martin Maechler wrote:
> - Of course, it is *the wise thing* to use FFT for acf -- for the case of no
>   NAs.. [and I think the NA case should be handled as well, and for small
>         no-NA series that straightforward method will probably be faster
>       than FFT as well ].

This reminds me of a request I have been meaning to make.

S-plus time series functions normally use only the longest contiguous
portion of the series with no missing values. I think a good way to implement
this would be to have an "na.omit" method for time series, but this
isn't a generic function in R (It is in SPLUS 3.3). Could this be changed?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 15 17:36:48 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 15 Jul 1999 18:36:48 +0200
Subject: docs: topic && availability
In-Reply-To: <14222.653.137118.492844@balin.ci.tuwien.ac.at> (message from
 Kurt Hornik on Thu, 15 Jul 1999 17:47:25 +0200 (CEST))
References: <14220.42263.633620.65936@fangorn.ci.tuwien.ac.at>
 <378CDF72.5499BD27@bank-banque-canada.ca> <14222.653.137118.492844@balin.ci.tuwien.ac.at>
Message-ID: <199907151636.SAA10972@sophie.ethz.ch>

Just to give my 5 Rp. in a very time constrained situation:

Yes, Kurt, 
yes, yes!

This *is* an urgent problem we should attack.

If someone doesn't find the Wilcoxon Test in R, {s}he must think we are all
nuts to use such a system at all .. until some crack tells him
``oh yeah, that's available in "ctest"...''.
and Joe User replies to the crack ``how on earth should I have guessed..''

[[and I **REALLY** think wilcoxon.test() should be moved to "Core R", even
  to the base:package !]]

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 15 17:38:03 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 15 Jul 1999 18:38:03 +0200 (CEST)
Subject: tseries
In-Reply-To: <199907151604.SAA10786@sophie.ethz.ch>
References: <XFMail.990715163125.plummer@iarc.fr>
 <378DFBF9.FE784F5E@wu-wien.ac.at>
 <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <14222.3691.526557.34151@balin.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> Dear Adrian (and everyone else), to the same topic, I've got a file
> "tseries-comments" five days old that I never got around polishing
> before sending to you :

>>> Thank you very much for the functionality !
>>> 
>>> - tsparam : not the best name for that class.. ???
>>> 
>>> ybnd : should be allowed to have EITHER length 1 of length = length(x)
>>> 
--> my patched version
>>> 
>>> - plot.tsparam: 	use 'type = "h"'  as default!
>>> 
>>> - acf, pacf :
>>> 
>>> are *one* function in S-plus,
>>> 
>>> use 'plot = T', not 'pl = T'  as argument
>>> (in line with several other R functions !)
>>> 
--> other small improvements...
>>> 
>>> {including:  instead of  rep(0, nnn),  use numeric(nnn) }
>>> 
--> my version
>>> [[ I'll send this in private to Adrian ]]

> As you see, 
> some of these 5day old comments are in line with Martyn's 
> (he is Martyn, I am Martin). 

> A few thoughts :

> - Yes, we want to be S(-plus) compatible as long as it is not too hard
>   or there are not good reasons against compatibility.

Agreed.
 
>   Particularly, acf(), spec.pgram(), spectrum(), ar(), ar.yw() should
>   have compatible argument names [at least for the important ones] to
>   make it easy to many users moving from S to R (;-).

Agreed.

> - Of course, it is *the wise thing* to use FFT for acf -- for the case
>   of no NAs.. [and I think the NA case should be handled as well, and
>   for small no-NA series that straightforward method will probably be
>   faster > than FFT as well ].

> - I'd very much appreciate if Martyn and you and Paul G.  (and Brian
>   and Ross and ...  and me, we also have a few improvements on S-plus
>   laying around here) could coordinate to produce ``the real'' time
>   series package for R.

> - As a matter of fact, I hope that some of the functions would become
>   part of "Core R" (such as e.g. "modreg" is base of "Core R"), since
>   e.g., the availability of acf() should not depend on having a
>   contributed package installed on top of "Core R".

Yes, definitely.

> Thanks once more to all the "time series" coders !

What I'd like to see in particular is some work going into model-style
interfaces.  Not sure exactly what it would be like, but something like

   armaxm(y ~ x, orderspecifications)

or maybe even

   armaxm(y ~ A(L) * y + B(L) * e + C(L) * x, ...)

Actually, creating an ARMA model could happen via the parameters or via
fitting data, so here is an extra challenge.

(A comment on tseries:  If possible, I'd prefer to use UC ini style
naming for data sets, such as TreeRing etc.  Name space etc ...)

-k



> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
> Seminar fuer Statistik, ETH-Zentrum SOL G1	Sonneggstr.33
> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
> phone: x-41-1-632-3408		fax: ...-1086			<><
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From osman.buyukisik@ae.ge.com  Thu Jul 15 20:24:35 1999
From: osman.buyukisik@ae.ge.com (U-E59264-Osman F Buyukisik)
Date: Thu, 15 Jul 1999 15:24:35 -0400 (EDT)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
 <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
Message-ID: <14222.13284.386863.936325@c1186.ae.ge.com>

July 14 tarball.
In my case hpux 10.20 with gcc/f77/make (gnu make), The configure does 
not correctly pick the FPICFLAGS. It should be "+z". ALso the SHLIBLD
is incorrectly set as "gcc", it should be "ld". I fixed both in
Makeconf and etc/Makeconf and the build went OK. dynamic load stuff
seems to be working (eda loads OK and works).
I also have to hand fix "readline". It correctly picks that I have
readline but not history! Also the the readline lib location had to be 
corrected. Since it knows where to look up for the readline.h why
could it not find the lib location? in my case they are in
$prefix/include and $prefix/lib. 

Best Regards,
osman

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Jul 15 20:38:44 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 15 Jul 1999 15:38:44 -0400
Subject: ``the real'' time series package
References: <XFMail.990715163125.plummer@iarc.fr> <378DFBF9.FE784F5E@wu-wien.ac.at> <199907151604.SAA10786@sophie.ethz.ch>
Message-ID: <378E38C4.AF2B1803@bank-banque-canada.ca>

>- I'd very much appreciate if Martyn and you and Paul G.
>  (and Brian and Ross and ...
>   and me, we also have a few improvements on S-plus laying around here)
>  could coordinate to produce ``the real'' time series package for R.

I'd like to split this into pieces:

- Some core functions for Splus compatibility. (acf and ar are the important
ones for me right now, but the spectrum stuff is important too.) Name space
conflicts will be a problem if there are two versions of, for example, acf,
which take different arguments (and  give different results - although bats acf
purposely gives different results from Splus). The objective of "bats" was to
fill this gap.

- Programming tools for operating on the time dimension of data. My tframe
library tries to do most of that. The idea is that other programs should be able
to use window, start, end, trim.na, etc., and not need to worry about whether
the time series is an old S tsp series, a "ts", an "rts", a "cts", a "tf", or
anything else that might come along. The library seems to work well and provides
an extremely useful building block. (I always appreciate constructive comments.)
This is also related to the question of what "[.ts" should do.

- A convenient method for pulling time series data from other sources into R
(and S and Omega, etc.). My PADI library does that. It works well, but is
getting a bit dated. I've been thinking about a CORBA replacement. (Any
volunteers to work on that?)

- A library of optimization methods which can be used for maximizing
likelihood(data, model(parameters)) would be useful. This is not specific to
time series and there is a fair amount of stuff around, so the problem is really
just making sure it fits the time series context. I have DFP and non-linear
simplex, but I haven't used them in a while.

- General structures for time series analysis. I am relatively committed to the
structure I have been using for several years now, but I would always consider
improvements. It should at least be considered as a good starting point. The
main elements are:
    1/  an abstract data representation with a distinction between input
(exogenous or conditioning) data and output (endogenous) data. These are x and y
in y ~ f(x), but it seems useful to put them in one structure because time
alignment is important. Then for example, window can be applied to the two
together rather than separately.  Currently my code supports an internal
implementation (input and output are time series matrices) and a PADI
implementation (the data is on a remote database running the PADI interface).
    2/  an abstract model representation which can be applied to the data.
Currently my code supports multivariate ARMA and state space models, Troll
models, and some crude attempts with NN models. But the idea is that it should
be easy to add other representations.
    3/  an object which combines the above two and adds some statistics
(likelihood, residuals, etc.)

- Methods for operating on the general structures: estimation techniques,
simulation, conversion, information criteria, etc. This is the fun part. I have
a fair amount of this, but it should be easy to add more.

- "Superstructure" methods for studying estimation techniques and the
forecasting properties of models. For example, one can take a "true model"
(defined as in 2/), simulate it (to get data as in 1/), and examine the small
sample properties of different estimation techniques. Or, take a given data set
and examine the (out-of-sample) forecasting properties of different models. The
idea is that these superstructure methods do not need to be changed if new data
representations or new model representations are added. (e.g. they do not need a
specific method for a new kind of model, they just call "simulate" and there
needs to be a simulate method for the new model.) My library has a fair amount
of this too,  but there is always room to add more here.

There are several areas in which I think my library is good, and there are
several deficiencies. I've played a bit with frequency domain methods, but that
is a general weakness. I'm very happy to see Adrian's unit root stuff, as it has
been on my "to do" list for several years now. I also get regular requests for
ARCH and GARCH modeling.

I do hope people will work on new stuff rather than things which are already
done by someone else. It might be useful to put a "time series" bullet on CRAN
(in contrib/PACKAGES.html probably) giving a general outline of what is where. I
get pretty upset when I see references to the lack of time series functionality
in R. (My DSE package is in the development area of CRAN only because the
documentation is in HTML rather than R's .Rd format and R's installation
procedures have been changing. The code is not unstable or incomplete.  The
version on CRAN installed with 0.63? and the most recent version at
<http://www.bank-banque-canada.ca/pgilbert> installs with 0.64 and 0.65)

Paul Gilbert


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 15 23:25:16 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 15 Jul 1999 23:25:16 +0100 (BST)
Subject: ``the real'' time series package
In-Reply-To: <378E38C4.AF2B1803@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907152315160.6049-100000@auk.stats>

On Thu, 15 Jul 1999, Paul Gilbert wrote:

> >- I'd very much appreciate if Martyn and you and Paul G.
> >  (and Brian and Ross and ...
> >   and me, we also have a few improvements on S-plus laying around here)
> >  could coordinate to produce ``the real'' time series package for R.
> 
> I'd like to split this into pieces:
> 
> - Some core functions for Splus compatibility. (acf and ar are the important
> ones for me right now, but the spectrum stuff is important too.) Name space
> conflicts will be a problem if there are two versions of, for example, acf,
> which take different arguments (and  give different results - although bats acf
> purposely gives different results from Splus). The objective of "bats" was to
> fill this gap.

[...]

> I do hope people will work on new stuff rather than things which are already
> done by someone else. It might be useful to put a "time series" bullet on CRAN
> (in contrib/PACKAGES.html probably) giving a general outline of what is where. I
> get pretty upset when I see references to the lack of time series functionality
> in R. (My DSE package is in the development area of CRAN only because the
> documentation is in HTML rather than R's .Rd format and R's installation
> procedures have been changing. The code is not unstable or incomplete.  The
> version on CRAN installed with 0.63? and the most recent version at
> <http://www.bank-banque-canada.ca/pgilbert> installs with 0.64 and 0.65)

Paul:

you are taking a limited view of time series analysis: there _is_ a
lot missing from R (even if DSE is included, and as it lacks R
documentation and a Windows port, that is a moot point). In particular
there is no AFAIK

de-seasonalizing (e.g. X11-ARIMA or whatever, stl, sabl)
easy-to-use (seasonal) ARIMA fitting
flexible spectral analysis
GARCH etc
regression with autocorrelated errors and related econometric techniques
(there is now some in lme, but I still have problems with that under R).

Compared to S-PLUS (especially 5.1, including the add-on modules) I think
`the lack of time series functionality in R' is fair comment. Let's
change that. Some of it is easy to do: the S-PLUS spectral analysis stuff
is based on Bloomfield's code, and I already have a package based on that.
Similarly, I have easy-to-use (seasonal) ARIMA fitting to hand.

I'll try to review what we do have and the gaps and report to R-devel
on Monday.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Fri Jul 16 03:09:33 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Fri, 16 Jul 1999 04:09:33 +0200 (MET DST)
Subject: dev.print scaling bug? (PR#229)
Message-ID: <199907160209.EAA10314@pubhealth.ku.dk>


# demo of bug in dev.print()
# (trivial, but detracts from Rolls Royce feel of R and forces workarounds)
# seen in rw0642 and linux version of 0.64.1

# Verbal attempt at generalising the behaviour illustrated by this file:

# If "par(mfrow)" is used to set more than 2 graphs vertically or 
# horizontally on the page, then, in the file generated by "dev.print()", 
# the default size of the graph points created by "points()" differs from 
# the size created by "plot()", although it does not differ on the 
# screen display.

a_1:10
b_c(2:10,NA)

opar_par(mfrow=c(1,3))	# set up page for 1x3 graphs, bug
#opar_par(mfrow=c(3,1))	# set up page for 3x1 graphs, bug
#opar_par(mfrow=c(2,1))	# set up page for 2x1 graphs, OK

plot(a,a)
points(a,b)

plot(a,b)
points(a,a)

plot(a,a)
points(a,b)

par(opar)

dev.print(file="printdev.ps")

# gv or print "printdev.ps"

----------------------------------------------------------------------------

Thanks for R

John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 08:52:35 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 09:52:35 +0200 (CEST)
Subject: 0.65 && AIX|HPUX
In-Reply-To: <14222.13284.386863.936325@c1186.ae.ge.com>
References: <14220.34132.594207.790328@fangorn.ci.tuwien.ac.at>
 <199907141507.RAA27266@sophie.ethz.ch>
 <14220.43606.369121.740271@fangorn.ci.tuwien.ac.at>
 <14222.13284.386863.936325@c1186.ae.ge.com>
Message-ID: <14222.58563.920246.500172@aragorn.ci.tuwien.ac.at>

>>>>> U-E59264-Osman F Buyukisik writes:

> July 14 tarball.

> In my case hpux 10.20 with gcc/f77/make (gnu make), The configure does
> not correctly pick the FPICFLAGS. It should be "+z". ALso the SHLIBLD
> is incorrectly set as "gcc", it should be "ld". I fixed both in
> Makeconf and etc/Makeconf and the build went OK. dynamic load stuff
> seems to be working (eda loads OK and works).

A mental malfunction on my behalf ... sorry.  Should be fixed now.  

> I also have to hand fix "readline". It correctly picks that I have
> readline but not history! Also the the readline lib location had to be 
> corrected. Since it knows where to look up for the readline.h why
> could it not find the lib location? in my case they are in
> $prefix/include and $prefix/lib.

Don't know.  You say that you have /usr/local/lib/libreadline.a but it
is not found?  (by gcc?)  Very strange ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Fri Jul 16 14:12:30 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Fri, 16 Jul 1999 14:12:30 +0100 (BST)
Subject: vector()
Message-ID: <Pine.GSO.3.96.990716140337.4499A-100000@laplace>

Can I suggest that vector() has an additional names argument?  This would
make it more comparable with matrix() and array().  I frequently find
myself doing

	fred <- vector("list", length(happy))
	names(fred) <- names(happy)

when I would rather be doing

	fred <- vector("list", length(happy), names = names(happy))

Just a thought.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From johann@ai.univie.ac.at  Fri Jul 16 14:13:03 1999
From: johann@ai.univie.ac.at (Johann Petrak)
Date: Fri, 16 Jul 1999 15:13:03 +0200
Subject: R-0.64.2 ssize_t not defined in src/unix/sock.h
Message-ID: <378F2FDF.349381C0@ai.univie.ac.at>

I though I should let you all know of this:

Trying to build R-0.62.2 on a SunOS xxxx 4.1.4 2 sun4m machine
using gcc (gcc version egcs-2.91.57 19980901 (egcs-1.1 release)):

gnumake[2]: Entering directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
gcc -g -O2 -I../include -I../../src/include  -c Rsock.c -o Rsock.o
In file included from Rsock.c:8:
sock.h:21: parse error before `Sock_read'
sock.h:21: warning: data definition has no type or storage class
sock.h:22: parse error before `Sock_write'
sock.h:22: warning: data definition has no type or storage class
Rsock.c: In function `Rsockwrite':
Rsock.c:112: `ssize_t' undeclared (first use in this function)
Rsock.c:112: (Each undeclared identifier is reported only once
Rsock.c:112: for each function it appears in.)
Rsock.c:112: parse error before `n'
Rsock.c:125: `n' undeclared (first use in this function)
gnumake[2]: *** [Rsock.o] Error 1
gnumake[2]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
gnumake[1]: *** [R] Error 1
gnumake[1]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src'
gnumake: *** [R] Error 1

Adding a typedef like for Win32 seems to help ...

Johann

---
Johann Petrak                       Email: johann@ai.univie.ac.at
Austrian Research Institute for AI  Phone:     +43-1-533-61-12/13
Schottengasse 3                     Fax:       +43-1-532-61-12/77
A-1010 Vienna, AUSTRIA         http://www.ai.univie.ac.at/~johann
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 14:22:10 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 15:22:10 +0200 (CEST)
Subject: R-0.64.2 ssize_t not defined in src/unix/sock.h
In-Reply-To: <378F2FDF.349381C0@ai.univie.ac.at>
References: <378F2FDF.349381C0@ai.univie.ac.at>
Message-ID: <14223.12802.659507.724069@aragorn.ci.tuwien.ac.at>

>>>>> Johann Petrak writes:

> I though I should let you all know of this:
> Trying to build R-0.62.2 on a SunOS xxxx 4.1.4 2 sun4m machine
> using gcc (gcc version egcs-2.91.57 19980901 (egcs-1.1 release)):

> gnumake[2]: Entering directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
> gcc -g -O2 -I../include -I../../src/include  -c Rsock.c -o Rsock.o
> In file included from Rsock.c:8:
> sock.h:21: parse error before `Sock_read'
> sock.h:21: warning: data definition has no type or storage class
> sock.h:22: parse error before `Sock_write'
> sock.h:22: warning: data definition has no type or storage class
> Rsock.c: In function `Rsockwrite':
> Rsock.c:112: `ssize_t' undeclared (first use in this function)
> Rsock.c:112: (Each undeclared identifier is reported only once
> Rsock.c:112: for each function it appears in.)
> Rsock.c:112: parse error before `n'
> Rsock.c:125: `n' undeclared (first use in this function)
> gnumake[2]: *** [Rsock.o] Error 1
> gnumake[2]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src/unix'
> gnumake[1]: *** [R] Error 1
> gnumake[1]: Leaving directory `/tmp_mnt/xxxx/src/R-0.64.2/src'
> gnumake: *** [R] Error 1

> Adding a typedef like for Win32 seems to help ...

This is fixed in 0.65.  I'll also do it for r-release.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 16 15:58:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 16 Jul 1999 16:58:54 +0200 (CEST)
Subject: 0.65/HPUX
Message-ID: <14223.18606.15426.849188@aragorn.ci.tuwien.ac.at>

After further elimination of sort-of-GNUish things in the Makefiles and
tweaking of configure, I can now successfully build on HPUX with
cc/f77/make (note: everything native).  make check still fails, but ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sat Jul 17 23:16:10 1999
From: bates@stat.wisc.edu (bates@stat.wisc.edu)
Date: Sun, 18 Jul 1999 00:16:10 +0200 (MET DST)
Subject: Use of lwd = 0, lty = 2 in segments. (PR#230)
Message-ID: <199907172216.AAA19732@pubhealth.ku.dk>

This may not be considered a bug but it is an incompatibility with S.

There was a convention in S that the graphics parameter setting 
 lwd = 0 
is supposed to use the minimum possible line width on the device.  It
is not clear what that means on modern graphics devices but there is
still code (like mine) that assumes something sensible happens with
 lwd = 0
It seems that R's postscript device driver does something reasonable
with that for some graphics functions but not others.  The abline
function seems ok but the segments function doesn't.

The following produces a PostScript output file "foo.ps" that causes
ghostscript to complain of an error.
R> postscript("foo.ps")
R> plot(1:10, 1:10, type = "n")
R> abline(h = 5, lty = 2, lwd = 0)   # works properly
R> segments(1, 1, 1, 3, lty = 2, lwd = 0)  # fails
R> dev.off()

The last part of the PostScript file is

0.75 setlinewidth
[ 3.00 3.00] 0 setdash
np
77.04 290.39 m
743.76 290.39 l
o
0.00 setlinewidth
[ 0.00 0.00] 0 setdash
np
101.73 107.87 m
101.73 199.13 l

It is the line "[ 0.00 0.00] 0 setdash" that causes the problems.

The error message from Ghostscript is

Error: /rangecheckAladdin Ghostscript: Unrecoverable error, exit code 1
 in --setdash--
Operand stack:
   --nostringval--   0
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1   3   %oparray_pop   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   2   3   %oparray_pop   --nostringval--   --nostringval--
Dictionary stack:
   --dict:874/941(G)--   --dict:0/20(G)--   --dict:75

I notice that in the C function PostScriptSetLineTexture in devPS.c,
the step lengths seem to be multiplied by something that may be the
line width before being written to the PostScript file.

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Jul 18 11:38:17 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 18 Jul 1999 12:38:17 +0200 (CEST)
Subject: 0.65/AIX
In-Reply-To: <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
References: <199907131307.JAA29236@infiniti.ece.cmu.edu>
 <199907131333.PAA14854@sophie.ethz.ch>
 <14219.25377.308702.802943@aragorn.ci.tuwien.ac.at>
 <x2vhbozfg7.fsf@blueberry.kubism.ku.dk>
 <14219.27433.90420.114884@aragorn.ci.tuwien.ac.at>
 <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
Message-ID: <14225.44697.457131.874849@elendil.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> On the system I have access to, I can compile only with
>> 
>> -D_XOPEN_SOURCE_EXTENDED=2 (VERY noisy)
>> or
>> -D_ALL_SOURCE
>> 
>> In either case, we get the above.
>> 
>> I will hence use ALL_SOURCE for the time being.
>> 
>> Note that
>> 
>> > 1/0 - 1/0# NaN
>> [1]NaNQ
>> > is.nan(1/0 - 1/0)
>> [1] TRUE
>> 
>> so what is really going on here???

> Double "hmmmm"....

> Can you run this under gdb? If so, could you set a breakpoint in
> EncodeReal and step through it? 

> That'll be (roughly)

> R -d gdb
> (gdb) run
> ^C
> (gdb) break EncodeReal
> (gdb) continue
>> 1/0
> (gdb) next
> <etc.>

> I bet it never enters the "if (!R_FINITE(x))" branch as it should.
> This could happen if HAVE_FINITE and IEEE_754 are both undefined in
> Arith.h, or if finite(x) doesn't work in the IEEE way.

>> From what Martin has been telling us, AIX is using IEEE format numbers
> and arithmetic anyhow, so it should be fairly easy to fudge a better
> R_FINITE (and ISNAN too). I think we went through some of that last
> time we had R_FINITE/ISNAN and friends on the board, didn't we?
> Something pretty close to the following should work:

> #define R_FINITE(x) ({double y = x; \
> 	 *((int *) &y) & 0x7ff00000 != 0x7ff00000})

> #define ISNAN(x) ({double y = x; \
> 	*((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
> 	(*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

> Of course, that kind of code is pretty architecture dependent, etc...
> Perhaps one should first check what the status of IEEE macros in AIX
> really is.

Hmm ... I just realized that the AIX system I have access to has no gdb
(it does have dbx, but I never used it before ...).

Could anyone else try to do the above exercise?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Bill.Venables@cmis.CSIRO.AU  Mon Jul 19 00:54:59 1999
From: Bill.Venables@cmis.CSIRO.AU (Venables, Bill (CMIS, Cleveland))
Date: Mon, 19 Jul 1999 09:54:59 +1000
Subject: vector()
Message-ID: <D16979FB73F3D11195510000F8030FB90528A1@roper.qld.cmis.csiro.au>

You might think about using structure()

fred <- structure(vector("list", length(happy)), names = names(happy))

and in fact you can add as many attributes as you like.  This seems a better
plan than tweaking vector() (where do you stop?) and maintains consistency
with S3 at this low level.

It must be said, though, this natural and innocent looking idiom that I once
used quite a lot in S3 code had nasty consequences in going from S3 to S4,
(as BDR frequently reminds me!)

Bill V.


-----Original Message-----
From: Jonathan Rougier [mailto:J.C.Rougier@durham.ac.uk]
Sent: Friday, July 16, 1999 11:13 PM
To: r-devel@stat.math.ethz.ch
Subject: vector()


Can I suggest that vector() has an additional names argument?  This would
make it more comparable with matrix() and array().  I frequently find
myself doing

	fred <- vector("list", length(happy))
	names(fred) <- names(happy)

when I would rather be doing

	fred <- vector("list", length(happy), names = names(happy))

Just a thought.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
_._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 08:18:33 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 08:18:33 +0100 (BST)
Subject: vector()
In-Reply-To: <D16979FB73F3D11195510000F8030FB90528A1@roper.qld.cmis.csiro.au>
Message-ID: <Pine.GSO.4.05.9907190817150.16539-100000@auk.stats>

On Mon, 19 Jul 1999, Venables, Bill (CMIS, Cleveland) wrote:

> You might think about using structure()
> 
> fred <- structure(vector("list", length(happy)), names = names(happy))
> 
> and in fact you can add as many attributes as you like.  This seems a better
> plan than tweaking vector() (where do you stop?) and maintains consistency
> with S3 at this low level.
> 
> It must be said, though, this natural and innocent looking idiom that I once
> used quite a lot in S3 code had nasty consequences in going from S3 to S4,
> (as BDR frequently reminds me!)

(When used for setting classes instead of class<-, that is.)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 19 08:25:09 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 19 Jul 1999 09:25:09 +0200 (CEST)
Subject: 0.65 HPUX|AIX make check
Message-ID: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>

Update (for me):

* On HPUX (cc/f77/make), make check passes the Examples but fails in
arith-true.R because

	is.infinite(.Machine$double.base ^ .Machine$double.max.exp)

gives FALSE.

Interestingly

> .Machine$double.base
[1] 2
> .Machine$double.max.exp
[1] 1024
> 2 ^ 1024
[1] 1.797693e+308
> 2 ^ 1025
[1] 1.797693e+308
> 2 ^ 2024
[1] 1.797693e+308

so I guess we need help here.

* On AIX (gcc/f77/make), make check fails in the contour example

contor> contour(x, x, z, col = "pink", add = TRUE)
Error: missing value where logical needed

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From brouard@ined.fr  Mon Jul 19 10:47:21 1999
From: brouard@ined.fr (Nicolas Brouard)
Date: Mon, 19 Jul 1999 11:47:21 +0200
Subject: R-0.64.2 on AIX
In-Reply-To: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>
Message-ID: <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>

I am new on your list...

S language source code again available and in the Public Domain was a great
hope for me.

I remember that parts of S code was written in Ratfor. Now there are still
Fortran routines. Would they stay as is? I have nothing against Fortran but
it adds another compiler which is not as available as C and which exists on
too various forms (g77, f2c at least). For example my g77 (2.7) compiler on
AIX 4.1 did not know what a "save" was.

I haven't found an history of the different sources which builds the actual
R. But looking at the sources themself gives you an idea. A former question
on this list asked for a easy access to the archives, so is there a Web
access to the archives?

I built 0.64.2 on Linux (4.1) without any difficulty (most of you work on
Linux I presume).
On AIX, ./configure used gcc and g77 and I got a working R executable
without too much difficulties.

I just received a first email from your list where
the IEEE standard of AIX was discussed; thus I presumed that my executable
is not working so well.

I am not sure to have the time necessary to compile 0.65 and to be "with
you" but at least I will look at your mailing list and give you information
on AIX if I can.

Thanks for your work. It is a big work.
When I was teaching Mathematical Demography in the Department of Statistics
of ANU for one semester in 1993 I was surprised by the overall S knowledge
of the students. Most of my exams where easily solved with S (Demography
uses a lot of data). Back to France I couldn't go as far with the students
who only had Excel. Now with the availability of R (on Windows mainly) I
will try to use it with my French students.


--
Nicolas Brouard
Institut national d'tudes dmographiques
Paris
mailto:brouard@ined.fr  http://sauvy.ined.fr/~brouard



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Jul 19 16:54:31 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 19 Jul 1999 17:54:31 +0200 (MET DST)
Subject: summary.default & is.recursive (PR#221)
Message-ID: <199907191554.RAA28084@pubhealth.ku.dk>

>>>>> On Thu, 8 Jul 1999 20:36, p.dalgaard@biostat.ku.dk said:

    PD> Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
    >> is.recursive(list(z, a=list(1:3)) )
    >> 
    >> R64.2:> [1] FALSE
    Splus3.3> [1] T

    PD> Yup, it's a bug. Cc'ed to r-bugs so that we don't forget.

    >> is.recursive(list(1,2))
    PD> [1] FALSE
    >> is.recursive(pairlist(1,2))
    PD> [1] TRUE

Now fixed.

    PD> [maybe Martin would want to add a check that is.whatever works
    PD> identically on lists and pairlists. Not is.pairlist, though...]

Added to tests/is-things.R (& .Rout.save).
Both should be in the snapshots (R-devel.tar.gz) shortly..

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul 19 17:30:34 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 19 Jul 1999 18:30:34 +0200
Subject: tseries
In-Reply-To: <XFMail.990715183012.plummer@iarc.fr> (message from Martyn
 Plummer on Thu, 15 Jul 1999 18:30:12 +0200 (CEST))
References: <XFMail.990715183012.plummer@iarc.fr>
Message-ID: <199907191630.SAA18378@sophie.ethz.ch>

>>>>> On Thu, 15 Jul 1999 18:30:12 +0200 (CEST), Martyn Plummer <plummer@iarc.fr> said:

    Martyn> On 15-Jul-99 Martin Maechler wrote:
    >> - Of course, it is *the wise thing* to use FFT for acf -- for the
    >> case of no NAs.. [and I think the NA case should be handled as well,
    >> and for small no-NA series that straightforward method will probably
    >> be faster than FFT as well ].

    Martyn> This reminds me of a request I have been meaning to make.

    Martyn> S-plus time series functions normally use only the longest
    Martyn> contiguous portion of the series with no missing values. I
    Martyn> think a good way to implement this would be to have an
    Martyn> "na.omit" method for time series, but this isn't a generic
    Martyn> function in R (It is in SPLUS 3.3). Could this be changed?

Yes.
Just committed (R-devel, i.e. pre 0.65); similarly for na.fail().

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 18:49:27 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 18:49:27 +0100 (BST)
Subject: time series in R
Message-ID: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>

Time Series functions in R
==========================

I think a good basic S-like functionality for library(ts) in base R
would include

ts class, tsp, is.ts, as.ts
plot methods
start end window frequency cycle deltat
lag diff aggregate
filter

spectrum, spec.pgram, spec.taper, cumulative periodogram, spec.ar?

ar -- at least univariate by Yule-Walker
arima -- sim, filter, mle, diag, forecast

stl


Of the first group we lack lag, deltat, cycle, filter. These are simple.
We have plot.ts, but might want lines.ts, for example.

Base R has nothing else, so I've taken a look at bats, tseries, dse
and timeslab.

bats
====

This is close to S(-PLUS) but lacks examples.
Its methods are often simple ones: it might benefit a lot from some
re-coding in C / Fortran.

It would give us 

ar.yw

acf and spectrum (spec.pgram, plot.spec).


tseries
=======

This has S-like function names, but does not, for example, accept
multiple time series in acf.  It has nice plots and nice examples.
(It would be better if the LIBNAME were tseries, when no Makefile
would be needed: as it is $(LD) should be $(SHLIBLD) and CFLAGS +=
-Wall is not a good idea being make and CC-specific.)

It would give us

acf/ccf/pacf (for acf in S)
spectrum/cross spectra/cumulative.periodogram


dse
===

As far as I can see (it is very complex) this handles state-space models,
and can handle ARMA models by converting them (approximately)
to state-space form.

dse is rather un-R-like, and did not compile for me without fixing 20
or so Fortran errors, and did not load for me even after an hour's
work fixing many more in the R code. I think the version in devel is
currently unusable, and has far, far too many conflicts. Given Paul's
claims of stability, I have spent a deeply frustrating afternoon.


timeslab
========

Rather self-contained, copyright position unclear (to me).



Suggestions:
===========

If Martyn and Adrian are agreeable, I will start a library(ts) in the
0.65 version. I will put in this:

the ts class and methods (maybe in due course these should be removed
from the base package?)

datasets from MASS, tseries

lag, deltat, cycle
filter

acf from bats, augmented by ideas from tseries.

spectrum, spec.pgram from bats  (after looking at tseries hard)
spec.taper
cpgram from MASS

ar.yw from bats  (although that probably needs to be moved to
C/Fortran, and I may special-case the univariate case to use code I
have for that).


That leaves

stl -- I believe the code for this is on netlib.

arima modelling.  I do have Fortran code for this, and will work on
  a simple R interface for it.  An elegant interface can come later.


One thing we do need to be very careful about is the odd constants
and signs that occur in time-series work. No two books I consulted
agree exactly on the definitions of the periodogram and spectrum!
I think we should follow S-PLUS unless there are compelling reasons
not to. I am bit worried that some of the fft usage actually
only computes approximations, and we need to assess how serious that is.


As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
ought to concentrate on getting the basic stuff (bats-like) in first.

How does that sound as a plan?

Brian


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul 19 21:42:09 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Jul 1999 16:42:09 -0400
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37938DA0.BBC19173@bank-banque-canada.ca>

>As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
>ought to concentrate on getting the basic stuff (bats-like) in first.
>How does that sound as a plan?

I think this is a good idea.

>ar -- at least univariate by Yule-Walker

I'd really like the multivariate one if possible. I'm quite sure ar.yw
in bats is multivariate.

>dse
Following is not important for the immediate goal, but I am surprize and
would also like to correct a couple of mis-conceptions.

>As far as I can see (it is very complex) this handles state-space
models,
>and can handle ARMA models by converting them (approximately)
>to state-space form.

No. It handles both ARMA models and state-space models without any
conversion. It can also convert between the representations. In theory
this is algebraic and not approximate, but it is of course subject to
the usual numerical approximations of computers. The tolerances I get
are typically as good as or better than the differences between Solaris
and Linux calculation. (for example, 1e-15 for differences in residuals,
with data having order of magnitude around 1.) Model roots also compare
to very tight tolerances.

>dse is rather un-R-like, and did not compile for me without fixing 20
>or so Fortran errors, and did not load for me even after an hour's
>work fixing many more in the R code.

This surprizes me very much as it has compiled for me in Solaris and
Linux since R 0.16 (although I had to compile directly into R in those
days). At one point there was a bug in the g77 compiler which caused a
problem, but that seems to be fixed now. In earlier versions of R I used
f2c, and at  one point there were some unresolved references which I
fixed (by something simple like changing ^2 to ^2.0). When I used the
Sun Fortran compiler it always worked, but I haven't used it in a long
time now.

>I think the version in devel is
>currently unusable, and has far, far too many conflicts.
The version on CRAN is fairly old (by Internet time). Although the code
has not changed much, R's installation procedures have. I am surprized
that there are conflicts, but am not surprized that there are install
problems with recent versions of R, given all the changes in the way R
installs packages.  I intend to update the CRAN version as soon as R's
installation procedures stabalize. In most respects I believe that has
happened now, but there is a pending change in the building of help
files which I have been waiting to use. I have tried to advertize that
the most recent version at <www.bank-banque-canada/pgilbert> should
install with the most recent versions of R. I guess it would be useful
to have some indication of this on CRAN. Perhaps it would be better not
to leave an old version on CRAN and instead just point to were the most
recent versions are located?

If others are having problems compiling this code please let me know.

Paul Gilbert




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon Jul 19 21:49:23 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 20 Jul 1999 08:49:23 +1200 (NZST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>

On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:

> Time Series functions in R

I agree with basically everything Brian says, and would add the
following thoughts:

    1.	Think carefully about defining interfaces before leaping
	into code.  By defining an interface independent of the
	particular code at hand we will make it easier to switch to
	new code.

    2.	Think multivariate even when implementing a function for
	univariate series.  If the interface is defined well, it
	should later be able to generalize to the multivariate case.
	I'd hate to see a second multivariate time-series package
	come along later.

    3.	On the definition question: The existing FFT implementation
	uses a particular definition for the discrete transform which
	is pretty standard.  (Edwards "Fourier Series", Brillinger
	"Time Series" etc.) Using another definition may complicate
	documentation.

    4.	The notation for ARMA models may well be the stuff that
	holy wars are made of, but my personal preference is
	    X[i] + phi[1] * X[i - 1] + ... + phi[p] * X[i - p]
	    = theta[0] + epsilon[i] + ... + theta[q] * epsilon[i - q]
	[ Man to judge: ``It was self defense - I thought he was
	  going to hit me, so I hit him first.'' ]

I'd also add a request for some flexible structural modelling code.
I've pretty much abandonded teaching ARIMA models in favour of
structural models.  (I've written some general code for this, but
there is probably better code about.  There are a couple of TOMS
algorithms for Kalman Filtering which should be checked out.)

Finally: Does anyone know Kitagawa?  He has some very nice time series
and smoothing code.  Could he be persuaded to make it available?

	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Jul 19 22:37:04 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 19 Jul 1999 17:37:04 -0400
Subject: time series in R
References: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>
Message-ID: <37939A80.3BF10D12@bank-banque-canada.ca>

>    4.  The notation for ARMA models may well be the stuff that
>        holy wars are made of,
...
For this episode of the war perhaps we should stick with univariate
arima as in S, and use the same notation. For the multivariate episode I
like

A(L) y(t) = B(L) e(t) + C(L) u(t)

for ARMA models and

z(t) = F z(t-1) + G u(t) +K e(t-1)
y(t) = H z(t) + e(t)

for state-space models. I think it is important to think about
state-space and ARMA together, in order to try and have a consistent
approach.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Jul 19 22:48:10 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 19 Jul 1999 22:48:10 +0100 (BST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.10.9907200812190.9849-100000@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907192236250.4779-100000@auk.stats>

On Tue, 20 Jul 1999, Ross Ihaka wrote:

> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
> 
> > Time Series functions in R
> 
> I agree with basically everything Brian says, and would add the
> following thoughts:
> 
>     1.	Think carefully about defining interfaces before leaping
> 	into code.  By defining an interface independent of the
> 	particular code at hand we will make it easier to switch to
> 	new code.

Yes, but we also want (to some extent) back-compatibility with S(-PLUS).
I would like to get something in there, even if we discover it
is not right.  For example, I have been trying what is already there on
bivariate series, with a lot of surprises.

>     3.	On the definition question: The existing FFT implementation
> 	uses a particular definition for the discrete transform which
> 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> 	"Time Series" etc.) Using another definition may complicate
> 	documentation.

That's the simple part.  But what is the divisor in the periodogram? Which
way do lags go in acfs of bivariate series, and which sign is the phase for
bivariate spectra?

>     4.	The notation for ARMA models may well be the stuff that
> 	holy wars are made of, but my personal preference is
> 	    X[i] + phi[1] * X[i - 1] + ... + phi[p] * X[i - p]
> 	    = theta[0] + epsilon[i] + ... + theta[q] * epsilon[i - q]
> 	[ Man to judge: ``It was self defense - I thought he was
> 	  going to hit me, so I hit him first.'' ]

Well, that is not mine, and it is not S-PLUS's either.

I see the virtue of a grander plan, but would like to get the 
simpler parts in now. And having spent an hour writing ts.union and
ts.intersect, I realize the simpler parts are not so simple.  Bill and I
had planned a new ts package to go with V&R3, but the work seemed to
be too much (and seems to be too much before R 1.0, too).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Tue Jul 20 01:31:13 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 20 Jul 1999 12:31:13 +1200 (NZST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907192236250.4779-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9907201215490.18298-100000@stat1.stat.auckland.ac.nz>

On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:

> >     3.	On the definition question: The existing FFT implementation
> > 	uses a particular definition for the discrete transform which
> > 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> > 	"Time Series" etc.) Using another definition may complicate
> > 	documentation.
> 
> That's the simple part.  But what is the divisor in the periodogram? Which
> way do lags go in acfs of bivariate series, and which sign is the phase for
> bivariate spectra?

Once you settle the forward discrete transform much of this is settled.
No constant in the dft implies
	Periodogram = |dft|^2/(2*pi*T)
Phases in spectra also fall out if you take a +ve exponent in the dft.

I don't much mind about these choices, but its probably a good idea to
be consistent.
	
	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 02:23:09 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Mon, 19 Jul 1999 21:23:09 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "14 Jul 1999 00:12:48 EDT."
 <x2iu7o5hcv.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907200123.VAA23498@infiniti.ece.cmu.edu>


"Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

Peter> Something pretty close to the following should work:
Peter> 
Peter> #define R_FINITE(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
Peter> 
Peter> #define ISNAN(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}

Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
see your point for the local var, but cc and gcc choke on it.

I've looked into /usr/include/fp.h which is included for AIX
platforms.  (Its version is 1.9)  There are defines for FINITE,
IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?
Does it make sense for configure to check, not only whether finite
exists but also whether it's broken?

BTW, if you step thru EncodeReal you see that !R_FINITE(x) if false
for 1/0 (i.e. 1/0 is not detected as not finite).

Here is first the C code to show what's working what's not.  (I picked
your stuff and added the calls to the macros.)  This is followed by
the output when compiled with cc and gcc.  I'm having major headaches
here with the -D_XOPEN_SOURCE_EXTENDED (details follow).  Maybe we can
dump finite in favor of FINITE?

Are  my assumptions about the return values are correct?

---> isfinite.c <---
#include <stdio.h>
#include <math.h>

#ifdef _AIX
# include <fp.h>
#endif

main() {
  double x,x2,x3;
  printf("finite(1.0)= %d (=1, hopefully)\n", finite(1.0));
  x=1./0.; x2= (-1.)/0.;  x3 = 0./0.;
  printf("Inf := 1/0 = %f;\t -Inf := -1/0 = %f;\t NaN:= 0/0 = %f\n",x,
         x2, x3);
  printf("finite(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
         finite(x),finite(x2),finite(x3));
  printf("Now the `bits':\n");
  printf(" Inf : %0x,%0x\n", ((int *) &x )[0], ((int *) &x )[1]);
  printf("-Inf : %0x,%0x\n", ((int *) &x2)[0], ((int *) &x2)[1]);
  printf(" NaN : %0x,%0x\n", ((int *) &x3)[0], ((int *) &x3)[1]);

#ifdef _AIX
  printf("FINITE(x), f.(x2), f.(x3): %d %d %d  (should all be 0)\n",
         FINITE(x),FINITE(x2),FINITE(x3));
  printf("IS_NAN(x), f.(x2), f.(x3): %d %d %d  (should be 0 0 1)\n",
         IS_NAN(x),IS_NAN(x2),IS_NAN(x3));
  printf("IS_INF(x), f.(x2), f.(x3): %d %d %d  (should be 1 1 0)\n",
         IS_INF(x),IS_INF(x2),IS_INF(x3));
#endif
}
---> end of isfinite.c <---

---> output <--
r-devel $ cc isfinite.c -o isfinite 2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7ff80000,0
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)
r-devel $ gcc -g -O2 isfinite.c -o isfinite 2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 1 1 1  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)
r-devel $ gcc -g -O2 isfinite.c -o isfinite -D_XOPEN_SOURCE_EXTENDED=1
2>/dev/null && ./isfinite
finite(1.0)= 1 (=1, hopefully)
Inf := 1/0 = INF;        -Inf := -1/0 = -INF;    NaN:= 0/0 = NaNQ
finite(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
Now the `bits':
 Inf : 7ff00000,0
-Inf : fff00000,0
 NaN : 7fffffff,ffffffff
FINITE(x), f.(x2), f.(x3): 0 0 0  (should all be 0)
IS_NAN(x), f.(x2), f.(x3): 0 0 1  (should be 0 0 1)
IS_INF(x), f.(x2), f.(x3): 1 1 0  (should be 1 1 0)

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 03:04:54 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Mon, 19 Jul 1999 22:04:54 -0400
Subject: R 0.65 and AIX: if it quacks like a duck...
Message-ID: <199907200204.WAA13374@infiniti.ece.cmu.edu>


Hi,

  this relates to R-devel of 1999/July/18.  I will outline what I had
to change to get R to compile with cc then with gcc.  Note that R
compiled with cc works, R compiled with gcc is broken.

--> Compile with cc:

1) Edit src/main/saveload.c: disable the undefine! With the #undef
_XOPEN_SOURCE_EXTENDED the compilation dies an untimely death.
(And the header files are not as badly broken for cc!)

2) Edit src/appl/sock.c: dto.

3) Edit src/unix/system.c: need a "break;" after default: in line 752
(yes, won't compile without)

4) Edit src/main/builtin.c: line 318 should read "#endif /* NOT_used */"
 (get rids of the warning)

5) CC=cc ../configure

Note this is broken for the dependency check (ld barfs the error
message to stdout instead of the log file?)
checking whether cc accepts -M for generating dependencies... ld:
0711-317 ERROR
: Undefined symbol: .main
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
no

Note 2 that configure leaves a file called "-fp-no-toc" behind.  Oops.

6) make && make check and everything looks ok.


--> Compile with gcc:

1) 2) 3) 4) like above

Additionally edit *sock.c:

5b) In appl/Rsock.c and appl/sock.c added `#include "Rconfig.h"'
(This doesn't hurt the cc compilation.)

6b) CC=gcc ../configure

Surprises:  this finds libcurses and libz.  I don't know where,
though.  So I manually remove -lreadline -lz -lcurses from the LIBS
line in Makeconf.  Note that I add my private readline with the help
of CPPFLAGS and LIBS in config.site (thanks, Kurt).

7b) edit Rconfig.h:
#ifdef __GNUC__
typedef long blkcnt_t;
#endif

Yes, I NEED this for gcc 2.8.1.  This is a gcc bug, because
gcc -I/usr/include will compile.  What I've learned is that it is
essential to verify which include files the compiler finds, these are
not always the ones in /usr/include!  Maybe configure can pick this up?

This gets you to a point where things will compile.  What remains is
the NaN and Inf problem.  I've tried to disable the finite function by
overriding the configure result (a la finite=no).  But then R core
dumps.  And uh, those ugly tick marks...

I'm afraid this all doesn't make too much sense, it's a mess.

Lemme know, if there is something you want me to try.  
-tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 20 07:22:12 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 20 Jul 1999 07:22:12 +0100 (BST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.10.9907201215490.18298-100000@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats>

On Tue, 20 Jul 1999, Ross Ihaka wrote:

> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
> 
> > >     3.	On the definition question: The existing FFT implementation
> > > 	uses a particular definition for the discrete transform which
> > > 	is pretty standard.  (Edwards "Fourier Series", Brillinger
> > > 	"Time Series" etc.) Using another definition may complicate
> > > 	documentation.
> > 
> > That's the simple part.  But what is the divisor in the periodogram? Which
> > way do lags go in acfs of bivariate series, and which sign is the phase for
> > bivariate spectra?
> 
> Once you settle the forward discrete transform much of this is settled.

Isn't that the tail wagging the dog?

> No constant in the dft implies
> 	Periodogram = |dft|^2/(2*pi*T)

Why is the 2*pi there? It is in Bloomfield, but not Brockwell & Davis, for
example. And S-PLUS divides by the fequency to make the periodogram
estimate the spectral density.

> Phases in spectra also fall out if you take a +ve exponent in the dft.
>
But you have to decide which of series i and j gets the complex conjugate.
(Same issue with acfs: second relative to first or first relative to
second?  It's like defining `lags'.)

> I don't much mind about these choices, but its probably a good idea to
> be consistent.

Consistent with whom?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 20 07:37:27 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 20 Jul 1999 07:37:27 +0100 (BST)
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: <199907200204.WAA13374@infiniti.ece.cmu.edu>
Message-ID: <Pine.GSO.4.05.9907200725490.5672-100000@auk.stats>

On Mon, 19 Jul 1999, Thomas Vogels wrote:

> 
> Hi,
> 
>   this relates to R-devel of 1999/July/18.  I will outline what I had
> to change to get R to compile with cc then with gcc.  Note that R
> compiled with cc works, R compiled with gcc is broken.

> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
> (yes, won't compile without)

There is no longer a line 752, but this was added (by Kurt) in the current
sources (line 317). When I saw this I checked my books and all my lint-like
tools: the code I wrote does seem valid C according to all my checks.

Would just ";" satisfy your compiler?


> --> Compile with gcc:
> 
> 1) 2) 3) 4) like above

Will gcc really not accept 3) on your platform?  It does on all of mine,
in all the versions of gcc I tried. It would be a surprise for gcc's
parser to be platform-specific.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 09:50:18 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 08:50:18 +0000
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37943849.ACC16974@wu-wien.ac.at>

Prof Brian D Ripley wrote:

> Suggestions:
> ===========
>
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:

I agree with almost everything.

>
>
> the ts class and methods (maybe in due course these should be removed
> from the base package?)
>
> datasets from MASS, tseries
>
> lag, deltat, cycle
> filter
>
> acf from bats, augmented by ideas from tseries.
>
> spectrum, spec.pgram from bats  (after looking at tseries hard)

Concerning the normalization, definition of fft and so on, I just want to say how
it is done in tseries:

Periodogram: Normalizing by (2*pi*n) where n is the length of the original series,
i.e. it differs from Brockwell&Davies by the factor 2*pi. Furthermore, normalizing
by n (and not npad) preserves the shape and not the sum under/over the
periodogram. I also remove the mean before starting the main computation which
makes the correction (10.4.7) from B&D unnecessary(?).


>
> spec.taper
> cpgram from MASS
>
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

What about simple OLS estimator ar.ols?

>
>
> That leaves
>
> stl -- I believe the code for this is on netlib.
>
> arima modelling.  I do have Fortran code for this, and will work on
>   a simple R interface for it.  An elegant interface can come later.
>
>
> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.

I will wait until this first version is finished and then update the tseries
library to fit with the R ts.base library so we can use, e.g., the tests etc. What
about the name tseries. Should I change this name, so that it does not conflict
with the time series base?

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 09:57:45 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 08:57:45 +0000
Subject: time series in R
References: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <37943A08.F073CC2C@wu-wien.ac.at>

Prof Brian D Ripley wrote:

> Time Series functions in R
> ==========================
>
> I think a good basic S-like functionality for library(ts) in base R
> would include
>
> ts class, tsp, is.ts, as.ts
> plot methods
> start end window frequency cycle deltat
> lag diff aggregate
> filter
>

I forgot to suggest to add the "embed" routine from tseries to the above list? I
think it's a base routine. It works also for multivariate series and is useful for
many higher level routines.

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 10:17:51 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 11:17:51 +0200 (CEST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <XFMail.990720111751.plummer@iarc.fr>

On 19-Jul-99 Prof Brian D Ripley wrote:
> Time Series functions in R
> ==========================
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:
> 
> the ts class and methods (maybe in due course these should be removed
> from the base package?)

Some of the ts class stuff is implemented in the C code of the base
library. I'm not sure you can separate this.

I also suggested an "na.omit" method for time series - which would be
used by many of the time series functions. Martin has made na.omit()
and na.fail() generic so this is possible now.

> datasets from MASS, tseries
> 
> lag, deltat, cycle
> filter

I think there is some functional overlap between filter() and convolve(),
which now has a type="filter" option. I'm not sure convolve() needs this
if there is a filter() function.

> acf from bats, augmented by ideas from tseries.

I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
after seeing its rather embarrassing performance.

> spectrum, spec.pgram from bats  (after looking at tseries hard)

Adrian's spectrum() function allows a wider range of kernel smoothers
and it would be nice to keep this.  Since spectrum() is just a wrapper
function anyway, it should be possible to do this, while keeping the
S-PLUS compatible interface.

> spec.taper
> cpgram from MASS
> 
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

I haven't tried very hard to make my code efficient, as you can see,
concentrating instead on getting something that works like the S-PLUS
version. Much of the work involved trying to get the same answer as
S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
was doing wrong (see the COMPAT file).

I think the multivariate version would be harder to implement in C.
I will see if I can speed the R code up.

I have been looking at Burg's algorithm and I think I can implement
this now, if you want.

> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.
> 
> How does that sound as a plan?

Sounds good.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 10:22:49 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 11:22:49 +0200 (CEST)
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907191846330.29584-100000@auk.stats>
Message-ID: <XFMail.990720112249.plummer@iarc.fr>

On 19-Jul-99 Prof Brian D Ripley wrote:
> Time Series functions in R
> ==========================
> If Martyn and Adrian are agreeable, I will start a library(ts) in the
> 0.65 version. I will put in this:
> 
> the ts class and methods (maybe in due course these should be removed
> from the base package?)

Some of the ts class stuff is implemented in the C code of the base
library. I'm not sure you can separate this.

I also suggested an "na.omit" method for time series, which would be
used by many of the time series functions. Martin has made na.omit()
and na.fail() generic so this is possible now.

> datasets from MASS, tseries
> 
> lag, deltat, cycle
> filter

I think there is some functional overlap between filter() and convolve(),
which now has a type="filter" option. I'm not sure convolve() needs this
if there is a filter() function.

> acf from bats, augmented by ideas from tseries.

I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
after seeing its rather embarrassing performance.

> spectrum, spec.pgram from bats  (after looking at tseries hard)

Adrian's spectrum() function allows a wider range of kernel smoothers
and it would be nice to keep this.  Since spectrum() is just a wrapper
function anyway, it should be possible to do this, while keeping the
S-PLUS compatible interface.

> spec.taper
> cpgram from MASS
> 
> ar.yw from bats  (although that probably needs to be moved to
> C/Fortran, and I may special-case the univariate case to use code I
> have for that).

I haven't tried very hard to make my code efficient, as you can see,
concentrating instead on getting something that works like the S-PLUS
version. Much of the work involved trying to get the same answer as
S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
was doing wrong (see the COMPAT file).

I think the multivariate version would be harder to implement in C.
I will see if I can speed the R code up.

I have been looking at Burg's algorithm and I think I can implement
this now, if you want.

> As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> ought to concentrate on getting the basic stuff (bats-like) in first.
> 
> How does that sound as a plan?

Sounds good.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul 20 10:32:37 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 20 Jul 1999 11:32:37 +0200
Subject: time series in R
In-Reply-To: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats> (message from
 Prof Brian D Ripley on Tue, 20 Jul 1999 07:22:12 +0100 (BST))
References: <Pine.GSO.4.05.9907200716520.5672-100000@auk.stats>
Message-ID: <199907200932.LAA25315@sophie.ethz.ch>


    BDR> On Tue, 20 Jul 1999, Ross Ihaka wrote:
    >> On Mon, 19 Jul 1999, Prof Brian D Ripley wrote:
    >> 
    >> > > 3. On the definition question: The existing FFT implementation >
    >> > uses a particular definition for the discrete transform which > >
    >> is pretty standard.  (Edwards "Fourier Series", Brillinger > > "Time
    >> Series" etc.) Using another definition may complicate > >
    >> documentation.
    >> > 
    >> > That's the simple part.  But what is the divisor in the
    >> periodogram? Which > way do lags go in acfs of bivariate series, and
    >> which sign is the phase for > bivariate spectra?
    >> 
    >> Once you settle the forward discrete transform much of this is
    >> settled.

    BDR> Isn't that the tail wagging the dog?

I think Ross meant to say that  fft()'s definition can't (shouldn't) be changed
anymore, and I agree on that [and that *is* S compatible anyway].

    >> No constant in the dft implies Periodogram = |dft|^2/(2*pi*T)

    BDR> Why is the 2*pi there? It is in Bloomfield, but not Brockwell &
    BDR> Davis, for example. And S-PLUS divides by the fequency to make the
    BDR> periodogram estimate the spectral density.

We have to decide if we go for S-plus compatibility here, see below.

    >> Phases in spectra also fall out if you take a +ve exponent in the
    >> dft.
    >> 
    BDR> But you have to decide which of series i and j gets the complex
    BDR> conjugate.  (Same issue with acfs: second relative to first or
    BDR> first relative to second?  It's like defining `lags'.)

    >> I don't much mind about these choices, but its probably a good idea
    >> to be consistent.

    BDR> Consistent with whom?

Mostly "with your own notation and definitions",
maybe even ``consistent with one book's author''.

I'd prefer Brockwell & Davis,
however I agree with Brian that S compatibility -- to some extent -- is a
goal here; on the other hand, S-plus uses definitions that are not widely
used in standard texts (my limited experience).

This really must must be settled now.
If nobody can show why S-plus definitions are `wrong by design' here,
I'd vote for adopting them, inspite of all...
[if only to keep V&R's chapter on time-series coherent :-)]

Something which should be discussed however is spectrum(0);
Several of us think that S-plus does the wrong thing, at least in some
cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
Another possibility would be to leave it NA
and maybe provide methods for estimating it specifically, if desired.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Jul 20 10:50:01 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 20 Jul 1999 11:50:01 +0200
Subject: 0.65/AIX
In-Reply-To: Thomas Vogels's message of "Mon, 19 Jul 1999 21:23:09 -0400"
References: <199907200123.VAA23498@infiniti.ece.cmu.edu>
Message-ID: <x2r9m3fy5y.fsf@blueberry.kubism.ku.dk>

Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:

> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> Peter> Something pretty close to the following should work:
> Peter> 
> Peter> #define R_FINITE(x) ({double y = x; \
> Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
> Peter> 
> Peter> #define ISNAN(x) ({double y = x; \
> Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
> Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}
> 
> Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
> see your point for the local var, but cc and gcc choke on it.

I take it that you fixed the missing ')' in ISNAN? Too bad. Perhaps it
can work without the local "y"? I put it in just to catch cases where
x might be in a register so that you cannot take its address.

> I've looked into /usr/include/fp.h which is included for AIX
> platforms.  (Its version is 1.9)  There are defines for FINITE,
> IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?

That would make very good sense. The code would probably have to go in
an "#if aix" type clause, but so would my suggestion.

> Does it make sense for configure to check, not only whether finite
> exists but also whether it's broken?

It certainly would.
 
> BTW, if you step thru EncodeReal you see that !R_FINITE(x) if false
> for 1/0 (i.e. 1/0 is not detected as not finite).

Yes. If you look at R_FINITE, you'll see that the logic is
essentially: If HAVE_FINITE use finite() else assume non-IEEE and only
check for the internal NA code. So if either finite() misbehaves or
doesn't exist, that will happen.

> Here is first the C code to show what's working what's not.  (I picked
> your stuff and added the calls to the macros.)  This is followed by
> the output when compiled with cc and gcc.  I'm having major headaches
> here with the -D_XOPEN_SOURCE_EXTENDED (details follow).  Maybe we can
> dump finite in favor of FINITE?
> 
> Are  my assumptions about the return values are correct?

They look fine. Would seem that only gcc without the -D_XOPENetc is
having trouble with finite() -- why? could that be a gcc bug?

What happens with isnan(), is that as buggy as finite()?

It looks quite feasible simply to put

#ifdef _AIX
	#define R_FINITE(x) FINITE(X)
	#define R_ISNAN(x)  IS_NAN(X)
#endif

or something like it in Arith.h
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Tue Jul 20 12:10:06 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Tue, 20 Jul 1999 12:10:06 +0100 (BST)
Subject: time series in R
Message-ID: <199907201110.MAA04887@toucan.stats.ox.ac.uk>

> Date: Tue, 20 Jul 1999 11:17:51 +0200 (CEST)
> From: Martyn Plummer <plummer@iarc.fr>
> To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
> Subject: RE: time series in R
> 
> On 19-Jul-99 Prof Brian D Ripley wrote:

> > Time Series functions in R
> > ==========================
> > If Martyn and Adrian are agreeable, I will start a library(ts) in the
> > 0.65 version. I will put in this:
> > 
> > the ts class and methods (maybe in due course these should be removed
> > from the base package?)
> 
> Some of the ts class stuff is implemented in the C code of the base
> library. I'm not sure you can separate this.

Rather, in the C core of R (the base package has no C code).  I was not
intended to separate that. My aim was merely to allow some code to be
re-written without losing backwards compatibility, yet. For example,
print.ts does not do well with multiple series (and it breaks the 
cardinal rule of a print method returning its first argument unchanged).

> I also suggested an "na.omit" method for time series - which would be
> used by many of the time series functions. Martin has made na.omit()
> and na.fail() generic so this is possible now.

Good. What do you want na.omit.ts to do? 

> > filter
> 
> I think there is some functional overlap between filter() and convolve(),
> which now has a type="filter" option. I'm not sure convolve() needs this
> if there is a filter() function.

I'll take a look.

> 
> > acf from bats, augmented by ideas from tseries.
> 
> I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
> after seeing its rather embarrassing performance.

I have that. However, I am having a number of problems with it,
for example that pacf does not work, and acf does not work correctly
for multiple series.

> library(bats)
> data(presidents)
> acf(presidents, type="partial")
Error: Object "xb" not found

OK, fix that:
> acf(presidents, type="partial")
Error: NA/NaN/Inf in foreign function call (arg 1)

[The NA handling needs to be sorted out.]

A little later:

            var0 <- diag(acf[1, , ], nrow = nser)

is wrong: it gives a matrix and multivariate acfs fail. I used

            var0 <- if(nser > 1) diag(acf[1, , ]) else acf[1,1,1]

I think I will special-case the univariate code here.


> > spectrum, spec.pgram from bats  (after looking at tseries hard)
> 
> Adrian's spectrum() function allows a wider range of kernel smoothers
> and it would be nice to keep this.  Since spectrum() is just a wrapper
> function anyway, it should be possible to do this, while keeping the
> S-PLUS compatible interface.

Yes, I intend to look at that. For now, though, your code is not
giving the same results as S-PLUS, and I need to fix up at least the
confidence interval calculations.  (I think I know exactly how it
is done in S-PLUS: it uses Bloomfield's code.)  I believe that padding
needs to be optional.

> > ar.yw from bats  (although that probably needs to be moved to
> > C/Fortran, and I may special-case the univariate case to use code I
> > have for that).
> 
> I haven't tried very hard to make my code efficient, as you can see,
> concentrating instead on getting something that works like the S-PLUS
> version. Much of the work involved trying to get the same answer as
> S-PLUS, and when that wasn't possible, trying to work out what S-PLUS
> was doing wrong (see the COMPAT file).
> 
> I think the multivariate version would be harder to implement in C.

I agree, but maybe it should be done.

> I will see if I can speed the R code up.
> 
> I have been looking at Burg's algorithm and I think I can implement
> this now, if you want.

Yes, please (even though I think it is in principle a bad idea).

> > As the feature-freeze for 0.65 is probably about 2-3 weeks away, we
> > ought to concentrate on getting the basic stuff (bats-like) in first.

Looking at where I am, that looks feasible

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Tue Jul 20 13:53:28 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Tue, 20 Jul 1999 12:53:28 +0000
Subject: time series in R
Message-ID: <37947148.EB23277B@wu-wien.ac.at>

Martin Maechler wrote:

>
> Something which should be discussed however is spectrum(0);
> Several of us think that S-plus does the wrong thing, at least in some

> cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
> and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
> Another possibility would be to leave it NA
> and maybe provide methods for estimating it specifically, if desired.
>

I had a look at some of our Dep. books:

Brockwell&Davis: Periodogram normalization is n^{-1}, P(0)=0 for
demean=T.
spectrum(0) should be estimated by not using P(0) (Remark 2, p. 353). In
general
S(0) \neq 0.

Shiryaev, Probability: Per. norm. is (2*pi*n)^{-1}, P(0)=0 for demean=T.

Priestley, Spectral Analysis... : Periodogram normalization is
(n/2)^{-1}, P(0)=0
for demean=T, p. 395. For continuous spectra he defines a "modified
Periodogram",pp. 416, 417, where the normalization is as in Shiryaev.
All the
spectrum estimation is done with the mod. Period.

Hannan, Multiple Time Series: Normalization is (n/2)^{-1}.

Koopmans: Spectral Analysis of TS: Norm. is (2*pi*n)^{-1}.

It seems that (2*pi*n)^{-1} is the version which is mostly used, since
it makes no
further normalization necessary, e.g., for smoothing the periodogram.
P(0)=0 is
obvious. And \hat{spectrum}(0) = 0 is definitely a very bad estimator.

Adrian

--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Jul 20 14:38:34 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Tue, 20 Jul 1999 15:38:34 +0200 (CEST)
Subject: time series in R
In-Reply-To: <199907201110.MAA04887@toucan.stats.ox.ac.uk>
Message-ID: <XFMail.990720153834.plummer@iarc.fr>

On 20-Jul-99 Prof Brian Ripley wrote:
> 
>> I also suggested an "na.omit" method for time series - which would be
>> used by many of the time series functions. Martin has made na.omit()
>> and na.fail() generic so this is possible now.
> 
> Good. What do you want na.omit.ts to do? 

It would either
1) remove missing values only from the beginning or end of a time
   series, or
2) return the longest contiguous subseries with no missing values,
   e.g. presidents[32:110], or the first such subseries if there
   were multiple matches.
A lot of S-plus time series functions use option 1). Option 2) seems
more useful to me. There is no "na.omit.ts" in Splus 3.3 but  it
seems like a good way to implement this functionality.

>> I updated acf() in bats_0.1-3.tar.gz (now on CRAN) to use FFT instead,
>> after seeing its rather embarrassing performance.
> 
> I have that. However, I am having a number of problems with it,
> for example that pacf does not work, and acf does not work correctly
> for multiple series.
> 
>> library(bats)
>> data(presidents)
>> acf(presidents, type="partial")
> Error: Object "xb" not found
> 
> OK, fix that:
>> acf(presidents, type="partial")
> Error: NA/NaN/Inf in foreign function call (arg 1)
> 
> [The NA handling needs to be sorted out.]

See above.

> A little later:
> 
>             var0 <- diag(acf[1, , ], nrow = nser)
> 
> is wrong: it gives a matrix and multivariate acfs fail. I used

This works for me!

> 
>             var0 <- if(nser > 1) diag(acf[1, , ]) else acf[1,1,1]
> 
> I think I will special-case the univariate code here.
> 
> 
>> > spectrum, spec.pgram from bats  (after looking at tseries hard)
>> 
>> Adrian's spectrum() function allows a wider range of kernel smoothers
>> and it would be nice to keep this.  Since spectrum() is just a wrapper
>> function anyway, it should be possible to do this, while keeping the
>> S-PLUS compatible interface.
> 
> Yes, I intend to look at that. For now, though, your code is not
> giving the same results as S-PLUS, and I need to fix up at least the
> confidence interval calculations.  (I think I know exactly how it
> is done in S-PLUS: it uses Bloomfield's code.)  

The main reason my confidence intervals are different is that I don't
have the correct expression for the degrees of freedom in the presence
of tapering (or padding, but that is trivial). Apart from that,
I deliberately chose different limits because I allow the user to
specify the coverage of the confidence interval in plot.spec, and if
one is allowed to do that, one needs to make sure that the confidence
interval contains the estimate, which would not always be the case with
the Splus behaviour.

> I believe that padding
> needs to be optional.

There seems to be two sorts of padding going on in Splus. One under
the control of the user, via the "pad" argument and the other
which is automatic, to aid the Fast Fourier Transform. I have
tried to reproduce this, but can't exactly match the Splus behaviour.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Tue Jul 20 15:26:35 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Tue, 20 Jul 1999 15:26:35 +0100 (BST)
Subject: tensor() function and sets
Message-ID: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>

Hi Everyone,

To complete the outer() and kronecker() functions in the base, may I
suggest the following tensor() function, which allows the multiplication
of arrays through sets of conformable dimensions.  I am happy to write a
help page if required. 

The code also needs a setdiff() function which prompts me to ask: what
about simple set functions?  I expect many of us have written our own
(Brian has a setdiff() in drop1.lm(), for example), which seems like a
good reason for putting versions in the base.  I would be happy to provide
mine for general scrutiny.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"setdiff" <-
function (x, y) x[!(x %in% y)]

"tensor" <-
function (A, B, da, db) 
{
    # tensor product of A and B through da and db
    no.na <- is.null(na <- dimnames(A <- as.array(A)))
    dima <- dim(A)
    no.nb <- is.null(nb <- dimnames(B <- as.array(B)))
    dimb <- dim(B)
    if (any(dima[da] != dimb[db])) 
        stop("Mismatched dimensions")
    kpa <- setdiff(seq(along = dima), da)
    kpb <- setdiff(seq(along = dimb), db)
    # fix up the dimnames (see outer)
    if (no.na && no.nb) 
        nms <- NULL
    else {
        if (no.na) 
            na <- vector("list", length(dima))
        else if (no.nb) 
            nb <- vector("list", length(dimb))
        nms <- c(na[kpa], nb[kpb])
    }
    A <- matrix(aperm(A, c(kpa, da)), ncol = prod(dima[da]))
    B <- matrix(aperm(B, c(db, kpb)), nrow = prod(dimb[db]))
    array(A %*% B, c(dima[kpa], dimb[kpb]), dimnames = nms)
}

# examples

A <- array(1:6, 2:3, list(LETTERS[1:2], LETTERS[3:5]))
B <- 1:3
tensor(A, B, 2, 1)			# same as drop(A %*% B)
A <- outer(A, B)			# A now 2 by 3 by 3
tensor(A, B, 2, 1); tensor(A, B, 3, 1)	# both 2 by 3 (nb dimnames)
B <- outer(1:2, B)			# B now 2 by 3
tensor(A, B, c(1, 3), 1:2)		# must be 3 vector
B <- outer(1:3, B)			# B now 3 by 2 by 3 
tensor(A, B, 1:3, c(2, 1, 3))		# must be a scalar
sum(A * aperm(B, c(2, 1, 3)))		# same scalar value


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 20:10:31 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 20 Jul 1999 15:10:31 -0400
Subject: 0.65/AIX
In-Reply-To: Your message of "20 Jul 1999 11:50:01 EDT."
 <x2r9m3fy5y.fsf@blueberry.kubism.ku.dk>
Message-ID: <199907201910.PAA13352@infiniti.ece.cmu.edu>


(Note that I took the liberty of resequencing Peter's email.)

"Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

>> I've looked into /usr/include/fp.h which is included for AIX
>> platforms.  (Its version is 1.9)  There are defines for FINITE,
>> IS_INF, IS_NAN.  Can we use them?  Roll our own finite()?

Peter> That would make very good sense. The code would probably have to go in
Peter> an "#if aix" type clause, but so would my suggestion.

Peter> It looks quite feasible simply to put
Peter> 
Peter> #ifdef _AIX
Peter> #define R_FINITE(x) FINITE(X)
Peter> #define R_ISNAN(x)  IS_NAN(X)
Peter> #endif
Peter> 
Peter> or something like it in Arith.h
 
With these changes, R crashes when compiled with gcc.  I may have
gotten something wrong with the ifdefs, however.  Shouldn't it be
possible to compile with HAVE_FINITE and HAVE_ISNAN undefined?

Peter> Thomas Vogels <tov@infiniti.ece.cmu.edu> writes:
>> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
>> 
Peter> Something pretty close to the following should work:
Peter> 
Peter> #define R_FINITE(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 != 0x7ff00000})
Peter> 
Peter> #define ISNAN(x) ({double y = x; \
Peter> *((int *) &y) & 0x7ff00000 == 0x7ff00000 && \
Peter> (*((int *) &y) & 0x7fffffff != 0x7ff00000 || *((int *) &y + 1) != 0)}
>> 
>> Pretty but not close ;-)  Sorry, but I can't compile these macros.  I
>> see your point for the local var, but cc and gcc choke on it.

Peter> I take it that you fixed the missing ')' in ISNAN? Too bad. Perhaps it
Peter> can work without the local "y"? I put it in just to catch cases where
Peter> x might be in a register so that you cannot take its address.

It's actually a missing semicolon before the closing brace.  Fixing it
makes it compile with gcc not cc.  (And I currently have to use cc to
get a working R.)

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Tue Jul 20 20:32:48 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Tue, 20 Jul 1999 15:32:48 -0400
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: Your message of "Tue, 20 Jul 1999 07:37:27 EDT."
 <Pine.GSO.4.05.9907200725490.5672-100000@auk.stats>
Message-ID: <199907201932.PAA13390@infiniti.ece.cmu.edu>



"Brian" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

>> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
>> (yes, won't compile without)

Brian> There is no longer a line 752, but this was added (by Kurt) in the current
Brian> sources (line 317). When I saw this I checked my books and all my lint-like
Brian> tools: the code I wrote does seem valid C according to all my checks.

Brian> Would just ";" satisfy your compiler?

Yes, I guess you can't have no statement after a case label, so either
"break;" or ";" is fine.  (K&R suggest always having a break after (at
least) the last label as a defensive porgramming strategy.)

--> Compile with gcc:
>> 
>> 1) 2) 3) 4) like above

Brian> Will gcc really not accept 3) on your platform?  It does on all of mine,
Brian> in all the versions of gcc I tried. It would be a surprise for gcc's
Brian> parser to be platform-specific.

Sorry, probably should have said: 3) doesn't hurt gcc.

 -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 21 11:19:35 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 21 Jul 1999 12:19:35 +0200
Subject: R-0.64.2 on AIX
In-Reply-To: <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>
References: <14226.53973.189207.201686@aragorn.ci.tuwien.ac.at>
 <001e01bed1cb$b2f7c0a0$7b0c86c0@brouard.ined.fr>
Message-ID: <199907211019.MAA00723@aragorn.ci.tuwien.ac.at>

>>>>> Nicolas Brouard writes:

> I am new on your list...

> S language source code again available and in the Public Domain was a
> great hope for me.

> I remember that parts of S code was written in Ratfor. Now there are
> still Fortran routines. Would they stay as is? I have nothing against
> Fortran but it adds another compiler which is not as available as C
> and which exists on too various forms (g77, f2c at least). For example
> my g77 (2.7) compiler on AIX 4.1 did not know what a "save" was.

That's a long story, and I should maybe add something on this to my FAQ
eventually.  In a nutshell, the point was that whereas we could use f2c
for creating a C-only version and provide the necessary run-time version
of libf2c along with the base R distribution, the problem is that MANY
add-on packages, in particular the ones that can be ported from statlib
S versions, but also others, come with Fortran sources.  So eventually,
you either need a full-featured Fortran compiler or all of f2c.

And this is what we have now.

> ...

> I am not sure to have the time necessary to compile 0.65 and to be
> "with you" but at least I will look at your mailing list and give you
> information on AIX if I can.

That would be great.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 21 11:19:36 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 21 Jul 1999 12:19:36 +0200
Subject: R 0.65 and AIX: if it quacks like a duck...
In-Reply-To: <199907200204.WAA13374@infiniti.ece.cmu.edu>
References: <199907200204.WAA13374@infiniti.ece.cmu.edu>
Message-ID: <199907211019.MAA00733@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> Hi,

>   this relates to R-devel of 1999/July/18.  I will outline what I had
> to change to get R to compile with cc then with gcc.  Note that R
> compiled with cc works, R compiled with gcc is broken.

> --> Compile with cc:

> 1) Edit src/main/saveload.c: disable the undefine! With the #undef
> _XOPEN_SOURCE_EXTENDED the compilation dies an untimely death.
> (And the header files are not as badly broken for cc!)

> 2) Edit src/appl/sock.c: dto.

Done.

> 3) Edit src/unix/system.c: need a "break;" after default: in line 752
> (yes, won't compile without)

Already taken care of

> 4) Edit src/main/builtin.c: line 318 should read "#endif /* NOT_used */"
>  (get rids of the warning)

???

> 5) CC=cc ../configure

> Note this is broken for the dependency check (ld barfs the error
> message to stdout instead of the log file?)
> checking whether cc accepts -M for generating dependencies... ld:
> 0711-317 ERROR
> : Undefined symbol: .main
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> no

Fixed, hopefully.

> Note 2 that configure leaves a file called "-fp-no-toc" behind.  Oops.

???

> 6) make && make check and everything looks ok.


> --> Compile with gcc:

> 1) 2) 3) 4) like above

> Additionally edit *sock.c:

> 5b) In appl/Rsock.c and appl/sock.c added `#include "Rconfig.h"'
> (This doesn't hurt the cc compilation.)

> 6b) CC=gcc ../configure

> Surprises:  this finds libcurses and libz.  I don't know where,
> though.  So I manually remove -lreadline -lz -lcurses from the LIBS
> line in Makeconf.  Note that I add my private readline with the help
> of CPPFLAGS and LIBS in config.site (thanks, Kurt).

:-)

> 7b) edit Rconfig.h:
> #ifdef __GNUC__
> typedef long blkcnt_t;
> #endif

> Yes, I NEED this for gcc 2.8.1.  This is a gcc bug, because gcc
> -I/usr/include will compile.  What I've learned is that it is
> essential to verify which include files the compiler finds, these are
> not always the ones in /usr/include!  Maybe configure can pick this
> up?

It does now.

> This gets you to a point where things will compile.  What remains is
> the NaN and Inf problem.  I've tried to disable the finite function by
> overriding the configure result (a la finite=no).  But then R core
> dumps.  And uh, those ugly tick marks...

> I'm afraid this all doesn't make too much sense, it's a mess.

> Lemme know, if there is something you want me to try.  

Work in progress ...

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 21 17:44:18 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 21 Jul 1999 18:44:18 +0200
Subject: tensor() function and sets
In-Reply-To: <Pine.GSO.3.96.990720143125.9359C-100000@laplace> (message from
 Jonathan Rougier on Tue, 20 Jul 1999 15:26:35 +0100 (BST))
References: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>
Message-ID: <199907211644.SAA01631@sophie.ethz.ch>

>>>>> On Tue, 20 Jul 1999 15:26:35 +0100 (BST), Jonathan Rougier <J.C.Rougier@durham.ac.uk> said:


    JonR> Hi Everyone,

    JonR> To complete the outer() and kronecker() functions in the base, may I
    JonR> suggest the following tensor() function, which allows the multiplication
    JonR> of arrays through sets of conformable dimensions.  I am happy to write a
    JonR> help page if required. 


    JonR> The code also needs a setdiff() function which prompts me to ask:
    JonR> what about simple set functions?  I expect many of us have written our own
    JonR> (Brian has a setdiff() in drop1.lm(), for example), which seems like a
    JonR> good reason for putting versions in the base.  I would be happy to provide
    JonR> mine for general scrutiny.

Actually your version of "setdiff" is in  
example("%in%")

    "%w/o%" <- function(x,y) x[!x %in% y] #--  x without y

Maybe we should make this part of core R, since it allows the nicer syntax
 (1:10) %w/o% c(3,7,12).

One problem with all these might be that you forget to think about efficiency 
{ %w/o% -> %in% -> match(.) }
but that might be ok.

    union
and
    intersect
are two other set functions, the first of which is also contained in
example(match) { == example("%in%") }:
    intersect <- function(x, y) y[match(x, y, nomatch = 0)]

What do others think?  Should (some of) these be put into "core R" ?


    JonR> Jonathan Rougier                       Science Laboratories
    JonR> Department of Mathematical Sciences    South Road
    JonR> University of Durham                   Durham DH1 3LE

    JonR> "setdiff" <-
    JonR> function (x, y) x[!(x %in% y)]

    JonR> "tensor" <-
    JonR> function (A, B, da, db) 
    JonR> {
    JonR> # tensor product of A and B through da and db
    JonR> no.na <- is.null(na <- dimnames(A <- as.array(A)))
    JonR> dima <- dim(A)
    JonR> no.nb <- is.null(nb <- dimnames(B <- as.array(B)))
    JonR> dimb <- dim(B)
    JonR> if (any(dima[da] != dimb[db])) 
    JonR> stop("Mismatched dimensions")
    JonR> kpa <- setdiff(seq(along = dima), da)
    JonR> kpb <- setdiff(seq(along = dimb), db)
    JonR> # fix up the dimnames (see outer)
    JonR> if (no.na && no.nb) 
    JonR> nms <- NULL
    JonR> else {
    JonR> if (no.na) 
    JonR> na <- vector("list", length(dima))
    JonR> else if (no.nb) 
    JonR> nb <- vector("list", length(dimb))
    JonR> nms <- c(na[kpa], nb[kpb])
    JonR> }
    JonR> A <- matrix(aperm(A, c(kpa, da)), ncol = prod(dima[da]))
    JonR> B <- matrix(aperm(B, c(db, kpb)), nrow = prod(dimb[db]))
    JonR> array(A %*% B, c(dima[kpa], dimb[kpb]), dimnames = nms)
    JonR> }

    JonR> # examples

    JonR> A <- array(1:6, 2:3, list(LETTERS[1:2], LETTERS[3:5]))
    JonR> B <- 1:3
    JonR> tensor(A, B, 2, 1)			# same as drop(A %*% B)
    JonR> A <- outer(A, B)			# A now 2 by 3 by 3
    JonR> tensor(A, B, 2, 1); tensor(A, B, 3, 1)	# both 2 by 3 (nb dimnames)
    JonR> B <- outer(1:2, B)			# B now 2 by 3
    JonR> tensor(A, B, c(1, 3), 1:2)		# must be 3 vector
    JonR> B <- outer(1:3, B)			# B now 3 by 2 by 3 
    JonR> tensor(A, B, 1:3, c(2, 1, 3))		# must be a scalar
    JonR> sum(A * aperm(B, c(2, 1, 3)))		# same scalar value

Looks interesting, however is it really useful
{for doing statistics, graphics, numerical computing, I mean} ?

Yes, if you'd provide a *.Rd help file  (use  ``prompt(tensor)''),
we'd be even more inclined to include the tensor function....
Also, I'd like to see a "real" use for it.

Is
	tensor(A, B, 1:3, c(2, 1, 3))
really easier than
        sum(A * aperm(B, c(2, 1, 3)))		

[probably yes, you have to think less, but still:
 couldn't  "da" and "db" (3rd and 4th arg) get reasonable default values ?]

----
Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jul 21 17:54:13 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 21 Jul 1999 18:54:13 +0200
Subject: tensor() function and sets
In-Reply-To: <199907211644.SAA01631@sophie.ethz.ch> (message from Martin
 Maechler on Wed, 21 Jul 1999 18:44:18 +0200)
References: <Pine.GSO.3.96.990720143125.9359C-100000@laplace> <199907211644.SAA01631@sophie.ethz.ch>
Message-ID: <199907211654.SAA01640@sophie.ethz.ch>

Excuse me Jonathan,
after looking a bit longer at your examples and some thinking,
I'm now quite convinced that  your tensor() function *IS* useful for us
and comes quite handy in several cases.
{real S/R hackers doing all this in their sleep, but most of us
 are not "real S/R hackers" in this sense ...}

I think it still would be nice to have reasonable default arguments da & db.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Wed Jul 21 18:34:36 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Wed, 21 Jul 1999 18:34:36 +0100 (BST)
Subject: tensor() function and sets
In-Reply-To: <199907211654.SAA01640@sophie.ethz.ch>
Message-ID: <Pine.GSO.3.96.990721181220.10355C-100000@laplace>

Hi Martin,

> after looking a bit longer at your examples and some thinking,
> I'm now quite convinced that  your tensor() function *IS* useful for us
> and comes quite handy in several cases.
> {real S/R hackers doing all this in their sleep, but most of us
>  are not "real S/R hackers" in this sense ...}

Well, I wrote it because I have to use it all the time!  A lot of the work
of our group at Durham involves means and variances of arrays rather than
vectors. I spent some time unzipping all the arrays into vectors and then
using matrix operations (hence I wrote the kronecker() function), before I
realised that the natural thing to do was to work in tensors and think of
variances as following from the expectations of outer products. 

> I think it still would be nice to have reasonable default arguments da & db.

I did consider this, but bitter experience has taught me to be
conservative and always specify explicitly the extents through which the
outer product collapses.  I think it is important to know and state
exactly what is required in these operations.  Furthermore, as I look
through the calculations I have done recently, no obvious pattern that
might be a reasonable default emerges.  However, I am open suggestions! 
In the meantime, I'll write a help page for the function as it stands
tomorrow morning and send it on to you. 

Regarding sets, might I suggest that if included in the base then
intersect() might be generalised to arbitrary numbers of arguments.  You
will probably howl with anguish at the recursion, but I use

"intersect" <-
function(x, ...)
    if (nargs() == 1) x else x[x %in% Recall(...)]

which seems to be effective.  

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Thu Jul 22 00:59:00 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Thu, 22 Jul 1999 01:59:00 +0200 (MET DST)
Subject: reluctant to read win95 directory (PR#231)
Message-ID: <199907212359.BAA14750@pubhealth.ku.dk>



Using rw0642 under win95, on executing from a directory on the c: drive:

   system("command.com /c dir", intern=T)

there is a whirring from drive a: (empty), then the message appears in a 
dos box:

   General failure reading device aLP!!?
   Abort, Retry, Fail?

Repeating the command a few times finally results in success with no 
whirring, after which there are no failures (even after restarting R) 
until the computer is rebooted. 

The computer is on a TCP/IP network with slow automounting, though the c:
drive is of course local.  It is set to try booting first from drive a:.

Could this be a timeout problem which could be fixed either in R or with
some setting in win95?

Thanks for R

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Jul 22 01:29:57 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 22 Jul 1999 02:29:57 +0200
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: John.Peters@tip.csiro.au's message of "Thu, 22 Jul 1999 01:59:00 +0200 (MET DST)"
References: <199907212359.BAA14750@pubhealth.ku.dk>
Message-ID: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk>

John.Peters@tip.csiro.au writes:

> Using rw0642 under win95, on executing from a directory on the c: drive:
> 
>    system("command.com /c dir", intern=T)
> 
> there is a whirring from drive a: (empty), then the message appears in a 
> dos box:
> 
>    General failure reading device aLP!!?
>    Abort, Retry, Fail?

Not that I know anything about Windows, but is there a chance that the
machine goes looking for command.com on the diskette? I.e. you want
c:\\windows\\command.com instead.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Thu Jul 22 06:17:43 1999
From: John.Peters@tip.csiro.au (John Peters)
Date: Thu, 22 Jul 1999 15:17:43 +1000 (EST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk> from Peter Dalgaard BSA at "Jul 22, 99 02:29:57 am"
Message-ID: <199907220517.PAA06830@dylan.tip.CSIRO.AU>

Peter Dalgaard BSA writes:

> John.Peters@tip.csiro.au writes:
> 
> > Using rw0642 under win95, on executing from a directory on the c: drive:
> > 
> >    system("command.com /c dir", intern=T)
> > 
> > there is a whirring from drive a: (empty), then the message appears in a 
> > dos box:
> > 
> >    General failure reading device aLP!!?
> >    Abort, Retry, Fail?
> 
> Not that I know anything about Windows, but is there a chance that the
> machine goes looking for command.com on the diskette? I.e. you want
> c:\\windows\\command.com instead.


I'm afraid not.  Even 

  system("c:\\windows\\command.com /c dir c:",intern=T)

behaves the same, ie fails several times with the above message, then 
works fine until the next reboot.  A further detail: the whirring on 
drive a: only occurs on the first attempt; thereafter the drive is silent 
as if the result is cached.

Maybe also relevant:

1. I'm starting R from a desktop shortcut with the opening directory 
   named in the "Start in:" box.  Exercising the R pulldown "File - 
   Change dir" doesn't help.
      
2. This also happened with rw0641, but not in an earlier version (not sure 
   which).

Thanks

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 22 07:43:02 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 22 Jul 1999 07:43:02 +0100 (BST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <x2vhbdo7ay.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907220736550.3797-100000@auk.stats>

Why was this a bug report?  It does not seem to me to meet the requirements
of a bug given in the R FAQ.

On 22 Jul 1999, Peter Dalgaard BSA wrote:

> John.Peters@tip.csiro.au writes:
> 
> > Using rw0642 under win95, on executing from a directory on the c: drive:
> > 
> >    system("command.com /c dir", intern=T)
> > 
> > there is a whirring from drive a: (empty), then the message appears in a 
> > dos box:
> > 
> >    General failure reading device aLP!!?
> >    Abort, Retry, Fail?
> 
> Not that I know anything about Windows, but is there a chance that the
> machine goes looking for command.com on the diskette? I.e. you want
> c:\\windows\\command.com instead.

Not on my machine: that command works for me.

What do you (John) expect this command to do? In particular, what directory
does you expect it to list?  You have not told it, and Windows has quite
complicated rules for finding the current working directory. My guess
is that those rules are giving a: in your circumstances. Put a floppy
in and find out.

Tip:  using shell() would be much simpler. Try ?shell (on Windows only).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 22 08:56:44 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 22 Jul 1999 09:56:44 +0200 (CEST)
Subject: tensor() function and sets
In-Reply-To: <Pine.GSO.3.96.990720143125.9359C-100000@laplace>
Message-ID: <XFMail.990722095644.plummer@iarc.fr>

On 20-Jul-99 Jonathan Rougier wrote:
> Hi Everyone,
> 
> To complete the outer() and kronecker() functions in the base, may I
> suggest the following tensor() function, which allows the multiplication
> of arrays through sets of conformable dimensions.  I am happy to write a
> help page if required. 

I have some code that could certainly be tidied up with the tensor()
function [1], but I wonder if "tensor" is the right name.
1) I would expect a function called "tensor" to construct a tensor object
   rather than multiply two arrays together.
2) The arguments aren't tensors. They are arrays.

How fast is it? It would be _really_ nice if this were done efficiently
in C code.

Martyn

[1] ar.yw in the "bats" package. I was just looking at this wondering how
    to speed it up before rewriting the whole thing in C or Fortran.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu Jul 22 11:26:41 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 22 Jul 1999 12:26:41 +0200 (CEST)
Subject: time series in R
In-Reply-To: <199907200932.LAA25315@sophie.ethz.ch>
Message-ID: <XFMail.990722122641.plummer@iarc.fr>

On 20-Jul-99 Martin Maechler wrote:
> 
> Something which should be discussed however is spectrum(0);
> Several of us think that S-plus does the wrong thing, at least in some
> cases. If  demean=T (mean removed),  should have periodogram(0) = 0,
> and maybe even spectrum(0) = 0 [and hence dB-spec. = -Inf ..]
> Another possibility would be to leave it NA

[I'm repeating some private discussions with Martin here]

In my version of spec.pgram(), I chose to ignore frequency zero. This
seemed like the right thing to do since the periodogram at zero does
not estimate the spectral density at zero, but is a function of the
mean. It does not make much sense to use this value when smoothing the
periodogram to estimate frequencies near zero. This remains true if you
decide to set periodogram(0)=0.

> and maybe provide methods for estimating it specifically, if desired.

I'm going to do this in the next version of the coda package.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Thu Jul 22 10:11:50 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Thu, 22 Jul 1999 10:11:50 +0100 (BST)
Subject: tensor() function and sets
In-Reply-To: <XFMail.990722095644.plummer@iarc.fr>
Message-ID: <Pine.GSO.3.96.990722094020.10355D-100000@laplace>

On Thu, 22 Jul 1999, Martyn Plummer wrote:

> I have some code that could certainly be tidied up with the tensor()
> function [1], but I wonder if "tensor" is the right name.
> 1) I would expect a function called "tensor" to construct a tensor object
>    rather than multiply two arrays together.
> 2) The arguments aren't tensors. They are arrays.

You are right of course!  I used the name `tensor' because in my notation
I use the tensor convention of summing over repeated indices.  Hence the
arguments da and db in the function are matched pairs of repeated indices.
But the name `aprod' would do just as well (it's rather unattractive
though!).

> How fast is it? It would be _really_ nice if this were done efficiently
> in C code.

It's reasonably fast as is, because it is just two aperms (which may be
degenerate) on top of a matrix product.  We are about to do some large
calculations which are extensively `tensorised' -- the largest object will
be the variance of a 100 by 100 by 10 array, which we have to divide into
5000 operations on 100 by 10 by 100 by 10 arrays (this will take hours
rather than minutes): oh for a sparse array class!  In case you are
wondering, our work is on prediction for large physical systems, eg oil
reservoirs, the weather, contaminated ground water plumes. 

But you could definitely argue that `aprod' is the primitive operation
that should be realised in C code, and then A %*% B is simply aprod(A, B,
2, 1) and outer(A, B, "*") could be aprod(A, B, NULL, NULL). 

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul 23 08:15:03 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 23 Jul 1999 09:15:03 +0200
Subject: lapply( *, names) -- bug ?!
Message-ID: <199907230715.JAA04888@sophie.ethz.ch>

This came on S-news

The more direct test being

sapply(c(a=1,b=2), names)

Problem:  
	  R ("all" versions) 
	  behaves the same as S+5.1, which is wrong IMO.

{since some might disagree,  I didn't yet post to R-bugs ..}

------- Start of forwarded message -------
Date: Thu, 22 Jul 1999 23:14:57 -0230
From: "Paul Y. Peng" <ypeng@math.mun.ca>
To: s-news <s-news@wubios.wustl.edu>
Subject: [S] Feature or bug?

In S-PLUS 3.3 (DEC Alpha) and S-PLUS 2000,

> z <- c("a"=1, "b"=2)
> lapply(z, function(x)names(x))
$a:
[1] "a"

$b:
[1] "b"

But in S-PLUS 5.1 (Linux),

> z <- c("a"=1, "b"=2)
> lapply(z, function(x)names(x))
$a:
NULL

$b:
NULL

Is this a new feature of S-PLUS 5? Do I miss anything in
S-PLUS 5? Thank you for your help.
------- End of forwarded message -------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Jul 23 08:28:35 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 23 Jul 1999 08:28:35 +0100 (BST)
Subject: lapply( *, names) -- bug ?!
In-Reply-To: <199907230715.JAA04888@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats>

On Fri, 23 Jul 1999, Martin Maechler wrote:

> This came on S-news
> 
> The more direct test being
> 
> sapply(c(a=1,b=2), names)
> 
> Problem:  
> 	  R ("all" versions) 
> 	  behaves the same as S+5.1, which is wrong IMO.
> 
> {since some might disagree,  I didn't yet post to R-bugs ..}

I do.  the argument is not a list, and lapply applies to lists. So
> as.list(c(a=1,b=2))
$a
[1] 1

$b
[1] 2

Fine. Note the names of the components are NULL.


> 
> ------- Start of forwarded message -------
> Date: Thu, 22 Jul 1999 23:14:57 -0230
> From: "Paul Y. Peng" <ypeng@math.mun.ca>
> To: s-news <s-news@wubios.wustl.edu>
> Subject: [S] Feature or bug?
> 
> In S-PLUS 3.3 (DEC Alpha) and S-PLUS 2000,
> 
> > z <- c("a"=1, "b"=2)
> > lapply(z, function(x)names(x))
> $a:
> [1] "a"
> 
> $b:
> [1] "b"
> 
> But in S-PLUS 5.1 (Linux),
> 
> > z <- c("a"=1, "b"=2)
> > lapply(z, function(x)names(x))
> $a:
> NULL
> 
> $b:
> NULL
> 
> Is this a new feature of S-PLUS 5? Do I miss anything in
> S-PLUS 5? Thank you for your help.
> ------- End of forwarded message -------
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jul 23 08:44:12 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 23 Jul 1999 09:44:12 +0200
Subject: lapply( *, names) -- bug ?!
In-Reply-To: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats> (message
 from Prof Brian D Ripley on Fri, 23 Jul 1999 08:28:35 +0100 (BST))
References: <Pine.GSO.4.05.9907230823340.29439-100000@auk.stats>
Message-ID: <199907230744.JAA05728@sophie.ethz.ch>

>>>>> On Fri, 23 Jul 1999 08:28:35 +0100 (BST), Prof Brian D Ripley <ripley@stats.ox.ac.uk> said:

    BDR> On Fri, 23 Jul 1999, Martin Maechler wrote:
    >> This came on S-news
    >> 
    >> The more direct test being
    >> 
    >> sapply(c(a=1,b=2), names)
    >> 
    >> Problem:  
    >> R ("all" versions) 
    >> behaves the same as S+5.1, which is wrong IMO.
    >> 
    >> {since some might disagree,  I didn't yet post to R-bugs ..}

    BDR> I do.  the argument is not a list, and lapply applies to lists.
that was not the point;
lapply() and sapply() are supposed to coerce to list()
    BDR> So
    >> as.list(c(a=1,b=2))
    BDR> $a
    BDR> [1] 1

    BDR> $b
    BDR> [1] 2

    BDR> Fine. Note the names of the components are NULL.

Yes, exactly.  

And therefore lapply(*, names) {or sapply(..)} should return NULLs
as it does [in R and S+5.x].
I was wrong all along.
It seems I need a longer warm-up time for my brain today...

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Fri Jul 23 09:51:48 1999
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 23 Jul 1999 18:51:48 +1000 (EST)
Subject: reluctant to read win95 directory (PR#231)
In-Reply-To: <Pine.GSO.4.05.9907220736550.3797-100000@auk.stats> from Prof Brian D Ripley at "Jul 22, 99 07:43:02 am"
Message-ID: <199907230851.SAA05406@dylan.tip.CSIRO.AU>

Prof Brian D Ripley writes:

> Why was this a bug report?  It does not seem to me to meet the requirements
> of a bug given in the R FAQ.
> 
> On 22 Jul 1999, Peter Dalgaard BSA wrote:
> 
> > John.Peters@tip.csiro.au writes:
> > 
> > > Using rw0642 under win95, on executing from a directory on the c: drive:
> > > 
> > >    system("command.com /c dir", intern=T)
> > > 
> > > there is a whirring from drive a: (empty), then the message appears in a 
> > > dos box:
> > > 
> > >    General failure reading device aLP!!?
> > >    Abort, Retry, Fail?
> > 
> > Not that I know anything about Windows, but is there a chance that the
> > machine goes looking for command.com on the diskette? I.e. you want
> > c:\\windows\\command.com instead.
> 
> Not on my machine: that command works for me.
> 
> What do you (John) expect this command to do? In particular, what directory
> does you expect it to list?  You have not told it, and Windows has quite
> complicated rules for finding the current working directory. My guess
> is that those rules are giving a: in your circumstances. Put a floppy
> in and find out.
> 
> Tip:  using shell() would be much simpler. Try ?shell (on Windows only).


Firstly a workaround (fix?):

Disable McAfee VirusScan 4.0.2/4.0.4032.  If this means it could 
be described as more an incompatibility than a bug I apologise. 


Secondly to respond to the comments and suggestions (McAfee enabled):

What do I expect this command to do:
To read the names of the files in the current directory for assignment 
to a vector.  By current directory I mean the one named in the win95 
shortcut "Start in:" box, which is also the one initially offered by the 
Rgui pull down "File - Change dir".  It succeeds in this, but not on the 
first attempt.

Put a floppy in drive a:
Less whirring, but same result.  Hitting "a" gives the behaviour I 
described.  Hitting "f" succeeds after a few tries, but next time again 
needs a few tries before succeeding.  So far it seems exactly four "f"s 
or three "a"s are required.

Try shell():
Both the following cause the same behaviour as with "system()":
  shell("dir c:\\tmp\\9907","c:\\windows\\command.com",intern=T)
  shell("dir","command.com",intern=T)

Many thanks

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Jul 23 13:22:07 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 23 Jul 1999 14:22:07 +0200 (MET DST)
Subject: reluctant to read win95 directory (PR#231)
Message-ID: <199907231222.OAA26619@pubhealth.ku.dk>

On Fri, 23 Jul 1999, John Peters wrote:

> Firstly a workaround (fix?):
> 
> Disable McAfee VirusScan 4.0.2/4.0.4032.  If this means it could 
> be described as more an incompatibility than a bug I apologise. 

Yes, I would put that down to a system problem. The reason for being 
picky is that bug reports need to be written up, ...

It looks to me as if McAfee has replaced the Windows `search for
executables' routine and uses that to go for a virus search.
Not much we can do about that.


> Try shell():
> Both the following cause the same behaviour as with "system()":
>   shell("dir c:\\tmp\\9907","c:\\windows\\command.com",intern=T)
>   shell("dir","command.com",intern=T)


It will do as it too has to search for an executable.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 23 14:18:03 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 23 Jul 1999 15:18:03 +0200 (CEST)
Subject: 0.65 HPUX/AIX update
Message-ID: <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>

The current situation is as follows.

AIX:

* I still need f77 for linking.  Using ld with the suggested flags gives
  a binary with `exec format error'.  The problem seems to be with an
  unreferenced __start.

* The floating point (finite|isnan) stuff is strange, but under control,
  I think.  Plain cc works, gcc has a problem and seems to need having
  prototypes turned off for IEEE fp.  (More below.)

* Apart from that, make check goes all the way through at least for me
  under both cc/f77/make and gcc/f77/make.

HPUX:

* make check fails in arith-true.R.  The problem is that

        is.infinite(.Machine$double.base ^ .Machine$double.max.exp)

gives FALSE.

Interestingly

> .Machine$double.base
[1] 2
> .Machine$double.max.exp
[1] 1024
> 2 ^ 1024
[1] 1.797693e+308
> 2 ^ 1025
[1] 1.797693e+308
> 2 ^ 2024
[1] 1.797693e+308

****

Here are some observations re IEEE fp.  I have the following small test
program:

#include <math.h>
#include <stdio.h>

main () {
    printf("1/0: %lf 0/0: %lf\n", 1./0., 0./0.);
    printf("finite(1/0): %d\n", finite(1./0.));
    printf("isnan(0/0): %d\n", isnan(0./0.));
    printf("log(0.): %lf\n", log(0.));
    return(0);
}

Under Linux, this gives:

1/0: Inf 0/0: NaN
finite(1/0): 0
isnan(0/0): -1
log(0.): -Inf

Under HPUX:

1/0: ++.000000 0/0: ?.000000
finite(1/0): 0
isnan(0/0): 1
log(0.): -179769313486231571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.000000

This is also why log(0) is broken on HPUX.  See also the above why make
check fails.  However, the finite and isnan test is o.k.

Under AIX with cc:

1/0: INF 0/0: NaNQ
finite(1/0): 0
isnan(0/0): 1
log(0.): -INF

Under AIX with gcc:

1/0: INF 0/0: NaNQ
finite(1/0): 1
isnan(0/0): 1
log(0.): -INF

So there is a problem in the finite() test with gcc.  It somehow is
related to the use of ANSI C prototypes, and disappears if we define
_NO_PROTO.  I am in the process of adding this as a short term fix, but
we should think a bit more about that.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Jul 23 21:44:43 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Fri, 23 Jul 1999 16:44:43 -0400
Subject: 0.65 HPUX/AIX update
In-Reply-To: Your message of "Fri, 23 Jul 1999 15:18:03 EDT."
 <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>
Message-ID: <199907232044.QAA20966@infiniti.ece.cmu.edu>


Kurt,

  thanks for the changes.  I've downloaded the snapshot on July 22.
It looks like we are in good shape now for AIX:

"Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

Kurt> The current situation is as follows.
Kurt> 
Kurt> AIX:
Kurt> 
Kurt> * I still need f77 for linking.  Using ld with the suggested flags gives
Kurt> a binary with `exec format error'.  The problem seems to be with an
Kurt> unreferenced __start.

I apologize for not seeing this earlier: "__start" is defined in
/lib/crt0.o.  So all you have to do is add /lib/crt0.o to the objects
when linking.  (You have to look carefully for that in the output from
gcc --verbose anything.o to learn what gcc is doing when linking an executable.)

Kurt> * The floating point (finite|isnan) stuff is strange, but under control,
Kurt> I think.  Plain cc works, gcc has a problem and seems to need having
Kurt> prototypes turned off for IEEE fp.  (More below.)

Quick fix and insanity check:  Add the following lines at the end of Arith.h
  #include <fp.h>
  static int finite (double x) {
        return FINITE (x);
  }
This will generate lots of warnings.  The resulting executable
(compiled with gcc) works wrt Inf and NaN!  My current assumption is
that there is a bug in gcc that generates the wrong inline version of
finite.  Overwriting it solves the problem.  A better fix would be to
ensure that finite is never called when configure finds that it is
buggy.  (I believe that the issue whether finite () exists is a
separate one.  So there should be two flags, like HAVE_FINITE and
HAVE_FINITE_THAT_STINKS... )

Kurt> So there is a problem in the finite() test with gcc.  It somehow is
Kurt> related to the use of ANSI C prototypes, and disappears if we define
Kurt> _NO_PROTO.  I am in the process of adding this as a short term fix, but
Kurt> we should think a bit more about that.

  -tom

--
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Mon Jul 26 03:41:12 1999
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Mon, 26 Jul 1999 04:41:12 +0200 (MET DST)
Subject: Bug in inequalities involving ordered factors (PR#232)
Message-ID: <199907260241.EAA04232@pubhealth.ku.dk>

> stress.level<-rep(c("low","medium","high"),2)
> ordf.stress<-ordered(stress.level, levels=c("low","medium","high"))
> ordf.stress
[1] low    medium high   low    medium high  
Levels:  low < medium < high 
> ordf.stress >= "medium"
[1] FALSE  TRUE FALSE FALSE  TRUE FALSE

#### Clearly the third and sixth values should be TRUE

--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Windows 9x 4.0 (build 1111)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon Jul 26 05:34:33 1999
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 26 Jul 1999 16:34:33 +1200 (NZST)
Subject: Bug in inequalities involving ordered factors (PR#232)
Message-ID: <199907260434.QAA20417@stat1.stat.auckland.ac.nz>

Here is a QuickFix (TM) which probably needs more careful thought.
(It looks like Ops.ordered has only been partially implemented).

Ops.ordered <-
function (e1, e2)
{
    nas <- is.na(e1) | is.na(e2)
    ord1 <- FALSE
    ord2 <- FALSE
    if (nchar(.Method[1])) {
        l1 <- levels(e1)
        ord1 <- TRUE
    }
    if (nchar(.Method[2])) {
        l2 <- levels(e2)
        ord2 <- TRUE
    }
    if (all(nchar(.Method)) && (length(l1) != length(l2) ||
        !all(sort(l2) == sort(l1))))
        stop("Level sets of factors are different")
    if (ord1 && ord2) {
        e1 <- codes(e1)
        e2 <- codes(e2)
    }
    else if (!ord1) {
        e1 <- match(e1, l2)
        e2 <- codes(e2)
    }
    else if (!ord2) {
        e2 <- match(e2, l1)
        e1 <- codes(e1)
    }
    value <- get(.Generic, mode = "function")(e1, e2)
    value[nas] <- NA
    value
}

I have committed this in the development version, but it probably needs
more thought than I have time for at present.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Mon Jul 26 08:45:18 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Mon, 26 Jul 1999 15:45:18 +0800 (SST)
Subject: ESRI Shapefile reader (help with dlls)
Message-ID: <199907260745.PAA31048@decunx.iscs.nus.sg>

Hi,
I am working on a library of map functions for R and I have started
with code to read shapefiles (the format is not great but it is ubiquitous).
I am not a windows person, but where I am working I don't have access to
any UNIX machines easily. So here's the problem I wrote C code to read
the information out of the shapefile header and I compiled it using
the script given in Ripley and Veneables programming compliments for 
Cygwin tools. It seemed to work, however when I tried calling it from R
it didn't work (couldn't find the symbol).

here's what happend

> version
           _         
platform   Windows   
arch       x86       
os         Win32     
system     x86, Win32
status               
status.rev 0         
major      0         
minor      64.2      
year       1999      
month      July      
day        3         
language   R         
> dyn.load("D:/Nicholas/shapelib-1.2.5/Sshpopen.dll")
> read.shape("D:\Nicholas\jstuff\Geotools\examples\publands")
Error in .C("SHPOpen", as.character(shpname), as.character(shxname), as.character(access),  : C/Fortran function not in load table
> is.loaded(symbol.C("SHPOpen"))
[1] FALSE
> 

Am I doing something wrong when building the dll? here are the steps I used

gcc -mno-cygwin -O2 -c Sshpopen.c
echo LIBRARY Sshpopen > Sshpopen.def
echo EXPORTS >> Sshpopen.def
nm Sshpopen.o | \
sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" \
>> Sshpopen.def
gcc -mno-cygwin -mdll -Wl,--base-file,Sshpopen.b \
-o Sshpopen.dll Sshpopen.o
dlltool -k -D Sshpopen.dll -b Sshpopen.b -e Sshpopen.e -d Sshpopen.def
gcc -mno-cygwin -mdll -Wl,--base-file,Sshpopen.b \
-o Sshpopen.dll Sshpopen.e Sshpopen.o
dlltool -k -D Sshpopen.dll -b Sshpopen.b -e Sshpopen.e -d Sshpopen.def
gcc -mno-cygwin -mdll -o Sshpopen.dll Sshpopen.e Sshpopen.o
rm -f Sshpopen.b Sshpopen.e

Thanks for any insight

Nicholas
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Tue Jul 27 00:08:54 1999
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Tue, 27 Jul 1999 01:08:54 +0200 (MET DST)
Subject: deviance.lm() should calculate a weighted SS of residuals (PR#233)
Message-ID: <199907262308.BAA12862@pubhealth.ku.dk>


Here is a (slightly silly) example.  Surely deviance.lm()
should calculate a weighted sum of squares about the mean,
not a sum of squares.  deviance.glm() is correct.

> roller
   weight depression
1     1.9          2
2     3.1          1
3     3.3          5
4     4.8          5
5     5.3         20
6     6.1         20
7     6.4         23
8     7.6         10
9     9.8         30
10   12.4         25
> roller.lm<-lm(weight~depression,data=roller,weights=1:10)
> roller.glm<-glm(weight~depression,data=roller,weights=1:10)

> deviance(roller.lm)
[1] 35.493

> deviance(roller.glm)
[1] 240.67

> # Now change the definition of deviance.lm
> deviance.lm<-function(object, ...)sum(weighted.residuals(object)^2)
> deviance(roller.lm)
[1] 240.67
> 



--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Windows 9x 4.0 (build 1111)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Tue Jul 27 06:17:58 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Tue, 27 Jul 1999 17:17:58 +1200
Subject: Memory profiling/benchmarking
Message-ID: <19990727171758.A2622@stat1.stat.auckland.ac.nz>

Hi,

As a project for a computer performance analysis paper I am taking this semester,
I am going to look at the performance of the memory manager in R, with the aim of
determining how fast it is and which areas most need improvement.  The idea is
that I will compare various versions of R, starting with 0.64.2, and then at a
few stages in the implementation of the new memory management scheme (of which
the first step was the hash tables for environments).

I am looking for scripts to use as benchmarks for memory related activities.  As
a starting point I will use the tests distributed with R, but any other
contributions would be helpful.  I don't think the tests I have are particularly
aimed at performance, but they should give a reasonable indication of which
functions are the performance hogs.

Any other suggestions would be greatly appreciated.

Thanks,
Lyndon
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Tue Jul 27 07:07:57 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Tue, 27 Jul 1999 14:07:57 +0800 (SST)
Subject: ESRI Shape reader
Message-ID: <199907270607.OAA04096@decunx.iscs.nus.sg>

Well Dr. Ripley helped me solve the first problem, next question
I need to do some debugging now that the function loads properly
into R. I checked the S documentation and to use the C I/O functions
you need to include newredef.h, this file doesn't exist in /src/include.
How does this work in R? under S3.4 on a dec station i could use

fprintf(stdout,..);
fflush(stdout);

thanks,

Nicholas

PS If I should be sending these questions to r-help instead let me know.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@hal.stat.unipd.it (Guido Masarotto)  Tue Jul 27 08:26:21 1999
From: guido@hal.stat.unipd.it (Guido Masarotto) (Guido Masarotto)
Date: Tue, 27 Jul 1999 08:26:21 +0100
Subject: ESRI Shape reader
In-Reply-To: <199907270607.OAA04096@decunx.iscs.nus.sg>; from Nicholas Lewin-Koh on Tue, Jul 27, 1999 at 02:07:57PM +0800
References: <199907270607.OAA04096@decunx.iscs.nus.sg>
Message-ID: <19990727082621.38191@hal.stat.unipd.it>

On Tue, Jul 27, 1999 at 02:07:57PM +0800, Nicholas Lewin-Koh wrote:
> Well Dr. Ripley helped me solve the first problem, next question
> I need to do some debugging now that the function loads properly
> into R. I checked the S documentation and to use the C I/O functions
> you need to include newredef.h, this file doesn't exist in /src/include.
> How does this work in R? under S3.4 on a dec station i could use
> 
> fprintf(stdout,..);
> fflush(stdout);
> 

  Previous lines works in Rterm but not in Rgui.
  For both, you can use 'REprintf', e.g.,

  REprintf("%s %d",aString,anInt);

  This is a function exported by R.dll. So to get it properly linked
  you have:
  (i) to install also the rwXXXsp.zip file;
  (ii) to regenerate libR.a (the import library for R.dll);
  (iii) to link your dll against libR.a (-L/path-to-libR.a -lR)

  Alternative: use 'gdb'; details on Brian's rw FAQ.

  guido
    






-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 07:42:58 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 07:42:58 +0100 (BST)
Subject: Memory profiling/benchmarking
In-Reply-To: <19990727171758.A2622@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.9907270737001.29983-100000@auk.stats>

On Tue, 27 Jul 1999, Lyndon Drake wrote:

> Hi,
> 
> As a project for a computer performance analysis paper I am taking this semester,
> I am going to look at the performance of the memory manager in R, with the aim of
> determining how fast it is and which areas most need improvement.  The idea is
> that I will compare various versions of R, starting with 0.64.2, and then at a
> few stages in the implementation of the new memory management scheme (of which
> the first step was the hash tables for environments).
> 
> I am looking for scripts to use as benchmarks for memory related activities.  As
> a starting point I will use the tests distributed with R, but any other
> contributions would be helpful.  I don't think the tests I have are particularly
> aimed at performance, but they should give a reasonable indication of which
> functions are the performance hogs.

Currently the base package is treated specially (although less specially
than it was, now we have hashing). Also, many of the most time-intensive
things in R are done in compiled code. So some candidates for good tests
are things done in large packages almost entirely in R. I used the 
V&R3 ch06.R script in doing some timings, as repeated linear regression
(either stepwise selection or bootstrapping) looks like the right sort of
thing. And on that the latest (in 0.65) memory management gave a speed up
of around 50%.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 07:56:20 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 07:56:20 +0100 (BST)
Subject: ESRI Shape reader
In-Reply-To: <19990727082621.38191@hal.stat.unipd.it>
Message-ID: <Pine.GSO.4.05.9907270744040.29983-100000@auk.stats>

NB: from the previous message, this is about Windows.

On Tue, 27 Jul 1999, Guido Masarotto wrote:

> On Tue, Jul 27, 1999 at 02:07:57PM +0800, Nicholas Lewin-Koh wrote:
> > Well Dr. Ripley helped me solve the first problem, 

which was to use the makefiles for installing a package: it is much the 
easiest way to work with compiled code in R (on Unix too).

> > next question
> > I need to do some debugging now that the function loads properly
> > into R. I checked the S documentation and to use the C I/O functions
> > you need to include newredef.h, this file doesn't exist in /src/include.

That is only true in S-PLUS 4.x (not S), and only needed in the GUI
version (splus.exe not sqpe.exe) as the console has not stdout stream
(the same as Rgui.exe).

> > How does this work in R? under S3.4 on a dec station i could use
> > 
> > fprintf(stdout,..);
> > fflush(stdout);

It would be normal to use stderr for debugging.


>   Previous lines works in Rterm but not in Rgui.
>   For both, you can use 'REprintf', e.g.,
> 
>   REprintf("%s %d",aString,anInt);

An alternative, which I tend to use is,

char msg[1024];

sprintf(msg, ...);
askok(msg);

which puts the contents of the message up in a message dialog box.
The trouble with Rprintf and REprintf is that they depend on the console
running properly and the information written not getting over-written.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 08:06:23 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 08:06:23 +0100 (BST)
Subject: Preliminary version of ts package
Message-ID: <Pine.GSO.4.05.9907270756330.29983-100000@auk.stats>

There is now a preliminary version of a time series package in the R-devel
snapshots, and we would welcome feedback on it.  It is based in part on the
packages bats (Martyn Plummer) and tseries (Adrian Trapletti) and in part
on code I had or have written. (Thanks for the contributions, Martyn and
Adrian!) Some of the existing ts code has been changed, for example to plot
multiple time series, so the behaviour after library(ts) may differ from
that without it.

library(help=ts) gives something like the listing below.  It is intended
that ar.burg (univariate case) and preliminary arima fitting and
forecasting functions will be added in the next couple of weeks.  At 
present there is a fairly high degree of S-PLUS compatibility in the
interfaces, but not necessarily in the objects or algorithms.

----------------------

Preliminary time-series package for R 0.65
==========================================

This is a preliminary version of a time-series package; at present
the functionality is somewhat limited in that not all the options are
yet implemented or may be very slow.

Functions in base R:
-------------------

ts		Create a (univariate or multivariate) ts object
[.ts		Subsetting method for ts objects.
as.ts, is.ts	Coercion and membership functions
plot, print	Methods for plot and print

aggregate	Computes summaries (e.g. sum) over disjoint time intervals
diff		Lagged differences of a time series
end		Time of last observation
frequency	Number of observations per unit of time
start		Time of first observation
time		Create time series giving the times of observations
tsp, tsp<-	Get and set time-series attributes
window		Subset to a time window


Functions in package ts:
-----------------------

acf		Autocovariance and autocorrelation function
ar              Wrapper for autoregression estimation functions
ar.yw           Estimate autoregression model by solving Yule-Walker equations
Box.test	Box-Pierce and Ljung-Box tests of independence
ccf		Cross-covariance and cross-correlations for two series
cpgram		Plot cumulative periodogram of univariate time series
cycle		Create time series giving the positions in a cycle 
		   of a time series
deltat		Return time interval between observations
diffinv		Discrete integration, the inverse of diff()
embed           Embedding a time series
filter		Linear filtering on a time series
kernel          Smoothing kernel objects (and Daniell, Fejer and 
                   (modified) Dirichlet kernels)
lag		Compute lagged version of time series
na.contiguous	Find longest contiguous stretch of non-NAs
na.omit.ts	na.omit method for time series
pacf		Partial autocorrelation function
plot.acf        Plot autocorrelation function
plot.spec       Plot spectral density estimate
plot.spec.coherency
plot.spec.phase
PP.test		Phillips-Perron test for unit root
spec.ar	        Estimate spectral density by autoregression
spec.pgram      Estimate spectral density from periodogram
spec.taper      Taper by cosine bell
spectrum        Wrapper for spectral density estimation functions
stl		Seasonal decomposition using loess
toeplitz	Generate Toeplitz matrix
ts.intersect	Bind time series as multivariate ts over the common time base
ts.union	Bind time series as multivariate ts over their total time base

TO DO

ar.burg		maybe
arima fitting and forecasting.


Datasets in base R:
------------------

airmiles        Passenger-Miles on US Airlines 1937-1960
co2             Moana Loa Atmospheric CO2 Concentrations
nhtemp          Yearly Average Temperatures in New Haven CT
presidents      Quarterly Approval Ratings for US Presidents
sunspots        Monthly Mean Relative Sunspot Numbers
uspop		Populations Recorded by the US Census


Datasets in package ts:
----------------------

accdeaths       US accidental deaths 1973-8
beaver1         time series of body temperatures of two beavers
beaver2
deaths          time-series on UK lung deaths 1974-9 from Diggle (1990)
mdeaths, fdeaths  as above, for males and females
drivers         time series on UK road deaths of drivers from Harvey (1989)
finance         daily closing prices of major European stock indices, 1991-1998
lh              dataset on luteinizing hormone from Diggle (1990)
nottem		time-series of temperatures in Nottingham, 1920-1939
sales		sales data with leading indicator
sunspot.year	yearly sunspot data, 1700-1988
sunspot.month	monthly sunspot data, 1749-1997
treering	yearly tree ring data, -6000-1979


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 15:51:10 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 10:51:10 -0400
Subject: Memory profiling/benchmarking
References: <19990727171758.A2622@stat1.stat.auckland.ac.nz>
Message-ID: <379DC75D.DFFAFBC6@bank-banque-canada.ca>

Lyndon

There are several test scripts with my DSE library available at
<http://www.bank-banque-canada.ca/pgilbert>. (Please don't make the mistake of
trying to install the version on CRAN - it installs with  R 0.61 but there have
been a lot of changes to R since then.)

The library calls compiled fortran for the really loop intensive core
calculations, but this is fairly representative of R. With R (up to 0.64.2) the
shortest set of tests (test.dse.lite) takes 7-8 minutes on a Sparc Ultra 10.
(Splus 3.3 takes 4-5 minutes.) There are several longer tests, including some
curvature calculations which take many hours. (In some of the more complicated
tests there are a few things which do not work in R, but most things do.) I use
generic functions a lot, and also use a set of "kernel" functions to help
protect my code from ongoing changes in R and S. This means that function
dispatch gets heavily exercised.

Attached below are results from the light and medium test for 0.64.2 and the
development snapshot (0.65) from a month ago (June 11). These show the timing at
the bottom of each test. As I recall I had to make a small fix to 0.64.2 in
order to get things working - but I don't remember what it was. If you have a
problem, send me the error message and it will jog my memory. I don't see a
large difference in the times, but I don't know if hashing was already in the
snapshot I have.

The pending changes in the ts library will have some affect on what has to be
attached to run the tests. Hopefully I will get a chance to test the library
today or tomorrow.

I would like to see the results of your testing, even if you decide not to use
these test.

Paul Gilbert
_________


On a sparc Ultra 10
R-0.64.2/
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.lite
+++++++++++++++++++++++++++++++++++++++++++++++++
RLIBS set to /home/mfa5/gilp/dse/pub/Rdse/rlibs
>    library("dse")

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


 The following object(s) are masked from package:base :

  RNGkind rnorm runif


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts


Attaching Package "package:dse":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

>    library("dse2")

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

>    library("mva")
>    library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.lite.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Random number generator tests ...ok
All tframe tests ... OK
All dse1 (kernel) tests ... OK
All dse2 tests ... OK
All dse3 tests ... OK
All dse4 tests ...Warning: skipping test 4 (requires stepwise).
 OK
dse2 graphics tests ...Warning: Specified end later than end of data, end not
changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
completed
dse3 graphics tests ...completed
dse4 graphics tests ...completed
All Brief User Guide example part 1 tests ... OK
All dse juice tests ...juice graphics tests ... OK
 OK
>
>
=========================================
R test.lite.s timing:
start Tuesday July 27 09:27:11 EDT 1999
end   Tuesday July 27 09:34:59 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.medium
+++++++++++++++++++++++++++++++++++++++++++++++++
>   x11()
> library("dse", warn.conflicts=FALSE)

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


 The following object(s) are masked from package:base :

  RNGkind rnorm runif


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

> library("dse2", warn.conflicts=FALSE)

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

> library("opt")
> library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.medium.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Brief User Guide example part 2 tests ...Warning: Specified end later than end
of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
Warning: Specified end later than end of data, end not changed.
 OK
>
>
=========================================
R test.medium.s timing:
start Tuesday July 27 09:35:00 EDT 1999
end   Tuesday July 27 09:49:00 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================

########################################################################

Devel version R 0.65 June 11, 1999 snapshot

+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.lite
+++++++++++++++++++++++++++++++++++++++++++++++++
RLIBS set to /home/mfa5/gilp/dse/pub/Rdse/rlibs
>    library("dse")

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


Attaching Package "package:syskern":


 The following object(s) are masked from package:base :

  rnorm


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts


Attaching Package "package:dse":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

>    library("dse2")

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

>    library("mva")
>    library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.lite.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Random number generator tests ...ok
All tframe tests ... OK
All dse1 (kernel) tests ... OK
All dse2 tests ... OK
All dse3 tests ... OK
All dse4 tests ... OK
dse2 graphics tests ...completed
dse3 graphics tests ...completed
dse4 graphics tests ...completed
All Brief User Guide example part 1 tests ... OK
All dse juice tests ...juice graphics tests ... OK
 OK
Warning message:
skipping test 4 (requires stepwise). in: dse4.function.tests(verbose = F,
graphics = F)
>
>
=========================================
R test.lite.s timing:
start Tuesday July 27 09:59:15 EDT 1999
end   Tuesday July 27 10:06:57 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================
+++++++++++++++++++++++++++++++++++++++++++++++++
         running R  test.dse.medium
+++++++++++++++++++++++++++++++++++++++++++++++++
>   x11()
> library("dse", warn.conflicts=FALSE)

Attaching Package "package:syskern":


 The following object(s) are masked from package:dse :

  is.S is.Splus is.Svanilla rnorm


Attaching Package "package:syskern":


 The following object(s) are masked from package:base :

  rnorm


Attaching Package "package:tframe":


 The following object(s) are masked from package:base :

  [.ts summary.default ts tsp<- window.default window.ts

> library("dse2", warn.conflicts=FALSE)

Attaching Package "package:dsex1":


 The following object(s) are masked from package:base :

  curve

> library("opt")
> library("bats")

Attaching Package "package:bats":


 The following object(s) are masked from package:base :

  convolve

>
>    source("test.medium.s")
dse.1999.07alphaR Warning: This system is the by-product of on-going research.
It has not been completely tested.
Brief User Guide example part 2 tests ... OK
>
>
=========================================
R test.medium.s timing:
start Tuesday July 27 10:06:57 EDT 1999
end   Tuesday July 27 10:20:47 EDT 1999
SunOS mfa99551 5.6 Generic_105181-11 sun4u sparc SUNW,Ultra-5_10
=========================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 18:55:57 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 13:55:57 -0400
Subject: Preliminary version of ts package
Message-ID: <379DF2AD.3A4DD91E@bank-banque-canada.ca>

Brian

I haven't got far, but here are some initial problems:

> start(1:10)
S:  [1] 1 1
ts: 1

> end(1:10)
S: [1] 10  1
ts: 10

window.ts  should handle NULL for default start and end values. If it is going
to print a warning then it needs warn=F to suppress the warning. Below is a copy
of my window.ts, but it would require a few minor changes to work without my
tframe library.

Paul
_______

 window.ts <- function (x, start = NULL, end = NULL, warn = T, eps =
.Options$ts.eps)
{
    f <- tsp(x)[3]
    if (is.null(start))
        start <- tsp(x)[1]
    if (is.null(end))
        end <- tsp(x)[2]
    if (2 == length(start))
        start <- start[1] + (start[2] - 1)/f
    if (2 == length(end))
        end <- end[1] + (end[2] - 1)/f
    if (start < tsp(x)[1]) {
        start <- tsp(x)[1]
        if (warn)
            warning("Specified start earlier than start of data, start not
changed.")
    }
    if (end > tsp(x)[2]) {
        end <- tsp(x)[2]
        if (warn)
            warning("Specified end later than end of data, end not changed.")
    }
    leave <- (time(x) >= (start - eps)) & (time(x) <= (end + eps))
    if (is.matrix(x))
        z <- unclass(x)[leave, , drop = F]
    else z <- x[leave]
    classed(ts(z, start = start, end = end, frequency = f), tfclass(x))
}


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 20:09:40 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 20:09:40 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379DF2AD.3A4DD91E@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907272003470.10800-100000@auk.stats>

On Tue, 27 Jul 1999, Paul Gilbert wrote:

> Brian
> 
> I haven't got far, but here are some initial problems:
> 
> > start(1:10)
> S:  [1] 1 1
> ts: 1
> 
> > end(1:10)
> S: [1] 10  1
> ts: 10

What's wrong with that?  S looks silly to me: you only need the second
component for seasonal series, and 1:10 is not seasonal.

In general, I am not trying to clone S, most notably as S-PLUS uses class
rts not ts, so very little code exists that uses S's class ts. Surely the
point of R is not _better_?  There are lots of detail improvements,
with more to come.

> window.ts  should handle NULL for default start and end values. If it is going
> to print a warning then it needs warn=F to suppress the warning. Below is a copy
> of my window.ts, but it would require a few minor changes to work without my
> tframe library.

I have not changed window.ts. I'll take a look.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Jul 27 21:23:33 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 27 Jul 1999 16:23:33 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907272003470.10800-100000@auk.stats>
Message-ID: <379E1545.4A37ECF8@bank-banque-canada.ca>

Brian

>In general, I am not trying to clone S, most notably as S-PLUS uses class
>rts not ts, so very little code exists that uses S's class ts. Surely the
>point of R is not _better_?  There are lots of detail improvements,
>with more to come.

Yes, hopefully there will be lots of improvements. But I think everyone has
agreed that we want S compatability for the default behaviour, so if  "ts" is
not going to be the default, then the default needs to be defined. Then, for
example, we cannot have

start.default <- function (x)  start.ts(ts(x))

as it is now.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Jul 27 22:56:25 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 27 Jul 1999 22:56:25 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379E1545.4A37ECF8@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907272252270.11135-100000@auk.stats>

On Tue, 27 Jul 1999, Paul Gilbert wrote:

> Brian
> 
> >In general, I am not trying to clone S, most notably as S-PLUS uses class
> >rts not ts, so very little code exists that uses S's class ts. Surely the
> >point of R is not _better_?  There are lots of detail improvements,
> >with more to come.
> 
> Yes, hopefully there will be lots of improvements. But I think everyone has
> agreed that we want S compatability for the default behaviour, so if  "ts" is

Not in my time with R: can you give me the reference to that agreement,
please. (If it is a generic comment, there are many, many exceptions.)

> not going to be the default, then the default needs to be defined. Then, for
> example, we cannot have
> 
> start.default <- function (x)  start.ts(ts(x))
>
> as it is now.

Why not?  S-PLUS thinks 1:10 has start=c(1,1), end=c(10,1), and would any
sane person think that?  (I might buy c(1,0)....)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Tue Jul 27 23:41:48 1999
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Jul 1999 17:41:48 -0500
Subject: Retaining comments when using `example'
Message-ID: <6rk8rl7m1f.fsf@verdi.stat.wisc.edu>

I find the `example' function, used to run the examples from a help
page, to be very useful.  It would be even more useful if I could find
a way to have the comments echoed along with the example code.

For example, the example section of col.Rd from the base library reads

 # extract an off-diagonal of a matrix
 ma <- matrix(1:12, 3,4)
 ma[row(ma)==col(ma) + 1]

 # create an identity 5-by-5 matrix
 x <- matrix(0,nr=5,nc=5)
 x[row(x)==col(x)] <- 1

but example(col) produces

 R> example(col)

 col> ma <- matrix(1:12, 3, 4)

 col> ma[row(ma) == col(ma) + 1]
 [1] 2 6

 col> x <- matrix(0, nr = 5, nc = 5)

 col> x[row(x) == col(x)] <- 1

Is there a way to retain the comments?  I notice that `example' ends up
calling the `source' function to do the actual running of the code.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Jul 28 00:38:00 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Jul 1999 01:38:00 +0200
Subject: Retaining comments when using `example'
In-Reply-To: Douglas Bates's message of "27 Jul 1999 17:41:48 -0500"
References: <6rk8rl7m1f.fsf@verdi.stat.wisc.edu>
Message-ID: <x23dy9d5pj.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> Is there a way to retain the comments?  I notice that `example' ends up
> calling the `source' function to do the actual running of the code.

Yeowch! This was not easy with the old comment-as-attribute model, and
it certainly did not get easier with the new keep-function-source
semantics.

The real trouble is - I suspect - an ancient one, inherited from S:

	source() doesn't

I.e. it does not work in the same way as the source command in a shell
would, interpreting a file as if it had been lines entered on the
command line, with some provision for skipping back to interactive
mode if there's an error. Rather, it parses the entire file (and
syntax checks it) and runs the resulting parsed expression. 

Perhaps we need a "real" source()?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 06:40:55 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 06:40:55 +0100 (BST)
Subject: Retaining comments when using `example'
In-Reply-To: <x23dy9d5pj.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9907280626520.11506-100000@auk.stats>

On 28 Jul 1999, Peter Dalgaard BSA wrote:

> Douglas Bates <bates@stat.wisc.edu> writes:
> 
> > Is there a way to retain the comments?  I notice that `example' ends up
> > calling the `source' function to do the actual running of the code.
> 
> Yeowch! This was not easy with the old comment-as-attribute model, and
> it certainly did not get easier with the new keep-function-source
> semantics.
> 
> The real trouble is - I suspect - an ancient one, inherited from S:
> 
> 	source() doesn't
> 
> I.e. it does not work in the same way as the source command in a shell
> would, interpreting a file as if it had been lines entered on the
> command line, with some provision for skipping back to interactive
> mode if there's an error. Rather, it parses the entire file (and
> syntax checks it) and runs the resulting parsed expression. 

Ah, but S can use options(echo=T) to do the echoing, rather than the
complicated code R has, and if echo=T S's source runs a loop running dput
on the expressions. And S _does_ echo the comments.

> Perhaps we need a "real" source()?

Yes, but let's try smaller things first.

Why does options(echo=TRUE) do nothing in R?
Since if echoing is actually set (iff R thinks it is non-interactive)
comments are echoed, it seems we do have the mechanisms needed in place.

_If_ this worked Doug would have noticed that there are too many comments
in the R-ex files: running that example in S-PLUS gives

> options(echo=T, prompt="")
> source("/ext/R/R-devel/library/base/R-ex/col.R")
###--- >>> `col' <<<----- Column Indexes
## alias         help(col)
##___ Examples ___:
# extract an off-diagonal of a matrix
ma <- matrix(1:12, 3, 4)
ma[row(ma) == col(ma) + 1]
# create an identity 5-by-5 matrix
x <- matrix(0, nr = 5, nc = 5)
x[row(x) == col(x)] <- 1
## Keywords: 'array'.
vector("end.of.file",0)

so there is more to this than just echoing the comments (including echoing
the output).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Wed Jul 28 09:28:58 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Wed, 28 Jul 1999 16:28:58 +0800 (SST)
Subject: ESRI shapes --again
Message-ID: <199907280828.QAA23696@decunx.iscs.nus.sg>

thanks to all the help so far I have code now that works on windows
(albeit very clunky) that can read the pertinent info from the shape header
and return a list with all the necessary parameters to read info out of
the shape file. Now come the big design questions

1) I have considered building a map object, basically a list that would
hold the info from the shape file and a data frame as part of the list.
Should all of the vertices of a shape be stored in this structure? I can
see this getting big really fast. My idea was to store only offset and the
size of each record and whenever a shape needs to be plotted or accessed 
the vertices can be retrived from the .shp file through an access function.
the problem is if the user wants to project the map all projections will
have to be done on the fly as the vertices are accessed. 

for those who don't know shape files are stored in 3 files, .shp .shx and .dbf
the .shp file holds the geometric information, the .shx file holds the
ofsets and the record sizes for each shape, and the .dbf file holds the
attribute information.

which brings me to question 2

2) the .dbf file contains the attribute information, so I
basically nead to write another version of read.table to access the dbf
file and store it as a data frame (the natural equivalent of an ArcView
data table). Is there a way to extend or access the functions of read.table
to construct a data frame without using a lot of memory building seperate
vectors and factors etc. and binding them into a data frame.

3) I have been cheating. Dr. Ripley suggested I start compiling this as
a package, using the supplied make files. Very sensible advice, however I am 
not exactly sure how to do this on windows. I have checked the faq which
says there is a sample Makefile in the eda package, I assume this
is Unix only couldn't find it. So to do this as far as I can tell from the
dcumentation I could get my hands on I need to make a folder in 
\rw0642\src\library and put the subdirectories R, src, man and data and
then run make? Or am I missing something?
 

Thanks again for all the help.

Nicholas
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 10:09:36 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 10:09:36 +0100 (BST)
Subject: ESRI shapes --again
In-Reply-To: <199907280828.QAA23696@decunx.iscs.nus.sg>
Message-ID: <Pine.GSO.4.05.9907281006240.12748-100000@auk.stats>

On Wed, 28 Jul 1999, Nicholas Lewin-Koh wrote:

> 3) I have been cheating. Dr. Ripley suggested I start compiling this as
> a package, using the supplied make files. Very sensible advice, however I am 
> not exactly sure how to do this on windows. I have checked the faq which
> says there is a sample Makefile in the eda package, I assume this
> is Unix only couldn't find it. So to do this as far as I can tell from the
> dcumentation I could get my hands on I need to make a folder in 
> \rw0642\src\library and put the subdirectories R, src, man and data and
> then run make? Or am I missing something?

Try looking at the R for Windows FAQ or the Venables & Ripley R
complements.

Basically, to make package foo under Windows, set a standard R packages
source (with R, src, man and data) in ...\rw0642\src\library\foo, cd to 
..\rw0642\src\gnuwin32 and `make pkg-foo'.  You are very unlikely to need
a Makefile (under Windows or Unix).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Wed Jul 28 10:10:58 1999
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Wed, 28 Jul 1999 17:10:58 +0800 (SST)
Subject: ESRI Shapefile again
Message-ID: <199907280911.RAA17340@decunx.iscs.nus.sg>

Hi again,
with my question 3) in my last post I think I answered my own question
of course generating a new one. I made the directory maptools in /src/library
and put the proper directories source and everything then from /src/gnuwin32

BASH$ make pkg-maptools

.......
------- Building maptools.dll from maptools.a --------
echo LIBRARY maptools > maptools.def
echo EXPORTS >> maptools.def
nm maptools.a > Defs
sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" Defs >> maptools.def
gcc -mno-cygwin -mdll -Wl,--base-file,maptools.b -s  -o maptools.dll  maptools.a
  -L../../../gnuwin32  -lg2c.mingw32 -lR
/CYGNUS/CYGWIN~1/H-I586~1/i586-cygwin32/bin/ld: cannot open -lg2c.mingw32: No such file or directory
collect2: ld returned 1 exit status
make[2]: *** [maptools.dll] Error 1
make[1]: *** [src/maptools.dll] Error 2
make: *** [pkg-maptools] Error 2

do i need to install -lg2c.mingw32 ? I am running Cygwin 20.1b on Windows 98

Nicholas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 28 12:42:40 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 28 Jul 1999 13:42:40 +0200 (CEST)
Subject: 0.65 HPUX/AIX update
In-Reply-To: <199907232044.QAA20966@infiniti.ece.cmu.edu>
References: <14232.27531.722976.358200@fangorn.ci.tuwien.ac.at>
 <199907232044.QAA20966@infiniti.ece.cmu.edu>
Message-ID: <14238.60592.356201.404321@fangorn.ci.tuwien.ac.at>

>>>>> Thomas Vogels writes:

> Kurt,

>   thanks for the changes.  I've downloaded the snapshot on July 22.
> It looks like we are in good shape now for AIX:

> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

Kurt> The current situation is as follows.
Kurt> 
Kurt> AIX:
Kurt> 
Kurt> * I still need f77 for linking.  Using ld with the suggested flags gives
Kurt> a binary with `exec format error'.  The problem seems to be with an
Kurt> unreferenced __start.

> I apologize for not seeing this earlier: "__start" is defined in
> /lib/crt0.o.  So all you have to do is add /lib/crt0.o to the objects
> when linking.  (You have to look carefully for that in the output from
> gcc --verbose anything.o to learn what gcc is doing when linking an
> executable.)

Thanks, done now.  `ld' now used for LDCMD and SHLIBLD, always use
/lib/crt0.o when linking the main binary.

Kurt> * The floating point (finite|isnan) stuff is strange, but under control,
Kurt> I think.  Plain cc works, gcc has a problem and seems to need having
Kurt> prototypes turned off for IEEE fp.  (More below.)

> Quick fix and insanity check:  Add the following lines at the end of Arith.h
>   #include <fp.h>
>   static int finite (double x) {
>         return FINITE (x);
>   }
> This will generate lots of warnings.  The resulting executable
> (compiled with gcc) works wrt Inf and NaN!  My current assumption is
> that there is a bug in gcc that generates the wrong inline version of
> finite.  Overwriting it solves the problem.  A better fix would be to
> ensure that finite is never called when configure finds that it is
> buggy.  (I believe that the issue whether finite () exists is a
> separate one.  So there should be two flags, like HAVE_FINITE and
> HAVE_FINITE_THAT_STINKS... )

Kurt> So there is a problem in the finite() test with gcc.  It somehow is
Kurt> related to the use of ANSI C prototypes, and disappears if we define
Kurt> _NO_PROTO.  I am in the process of adding this as a short term fix, but
Kurt> we should think a bit more about that.

Done, too.  I added a configure test for broken finite and in that case
we now do something special for AIX or the same as if finite was not
there otherwise.  (We can circumvent the warnings because what we really
need is R_FINITE(x), and that can be defined as you suggested.)

I consider AIX done now.  Any objections?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 17:04:16 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 12:04:16 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907272252270.11135-100000@auk.stats>
Message-ID: <379F29FE.B16ACFC8@bank-banque-canada.ca>

PG>> Yes, hopefully there will be lots of improvements. But I think
everyone has
PG>> agreed that we want S compatibility for the default behavior, so
if  "ts" is...

BDR>Not in my time with R: can you give me the reference to that
agreement,
BDR>please. (If it is a generic comment, there are many, many
exceptions.)

I think in general this has been agreed to several times, but also in
the discussion of Adrian Trapletti tseries library, which seemed to
initiate the ts library effort, there was general agreement on this
point. (See r-devel messages July 15 Re: tseries).

I am not trying to defend S's poor default treatment of time series. We
need other better time series classes, and perhaps ts should do that. In
fact, perhaps R does not even need a default time series representation
and methods for it.

What is important is that, if there is a time series default it should
be consistent with S. So, either ts should be consistent with S or it
should not be the default.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 18:41:36 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 13:41:36 -0400
Subject: Preliminary version of ts package
References: <Pine.GSO.4.05.9907281717080.14236-100000@auk.stats>
Message-ID: <379F40CE.52B3DFA@bank-banque-canada.ca>

PG>> I think in general this has been agreed to several times, but also
in
PG>> the discussion of Adrian Trapletti tseries library, which seemed to

PG>> initiate the ts library effort, there was general agreement on this

PG>> point. (See r-devel messages July 15 Re: tseries).

BDR>No, it did not! I promised to do this at the Vienna workshop in
March: the
BDR>end of the Oxford academic year precipitated this. And my reading of
that
BDR>correspondence is _not_ that there was agreement to follow all of
S's
BDR>quirks.  R-core does not think it has agreed to that: I had checked,

BDR>and the consensus is to improve.

There seems to be a general plan that was discussed by R-core and not
mentioned on R-devel, even when there were announcements about other
work being done on time series libraries. If S compatibility is no
longer a consideration then perhaps that should be communicated to
R-devel and even more widely. There are a number of users that have a
big investment in this.

BDR>Certainly we do not intend to get the same
BDR>wrong answers as S-PLUS!

I consider wrong answers to be special exceptions. Changing R's default
behavior for start() and end() is a design choice, not a wrong answer. I
think is is quiet reasonable to put these design choices in your own
library, but it should not be included as part of the default.

Paul



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Jul 28 20:43:37 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 28 Jul 1999 20:43:37 +0100 (BST)
Subject: Preliminary version of ts package
In-Reply-To: <379F40CE.52B3DFA@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9907282038240.14583-100000@auk.stats>

On Wed, 28 Jul 1999, Paul Gilbert wrote:

Paul had just sent a public reply to part of a private reply, a practice I
deplore.

In the part he omitted was a challenge to supply a completely S compatible
lm and glm, plus the comment that I have _not_ changed start.ts nor end.ts
in base R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 29 15:18:09 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 29 Jul 1999 16:18:09 +0200 (MET DST)
Subject: round(numeric(0)) (PR#235)
Message-ID: <199907291418.QAA05728@pubhealth.ku.dk>

Try

> round(numeric(0))
[1] NA
> floor(numeric(0))
numeric(0)
> trunc(numeric(0))
numeric(0)

S has them all as numeric(0), and I think R is wrong.
This looks like a design error in the math2 group: it applies to 
signif too, and also to the complex cases, e.g.
> signif(complex(0))
[1] NA



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, package:ts, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul 29 17:49:47 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 29 Jul 1999 18:49:47 +0200 (CEST)
Subject: round(numeric(0)) (PR#235)
In-Reply-To: <199907291418.QAA05728@pubhealth.ku.dk>
References: <199907291418.QAA05728@pubhealth.ku.dk>
Message-ID: <14240.34347.395426.27168@fangorn.ci.tuwien.ac.at>

>>>>> ripley  writes:

> Try
>> round(numeric(0))
> [1] NA
>> floor(numeric(0))
> numeric(0)
>> trunc(numeric(0))
> numeric(0)

> S has them all as numeric(0), and I think R is wrong.
> This looks like a design error in the math2 group: it applies to 
> signif too, and also to the complex cases, e.g.
>> signif(complex(0))
> [1] NA

In math2, we have

    if (na < 1 || nb < 1) {
        for (i = 0; i < n; i++)
            y[i] = NA_REAL;
    }

with

    na = LENGTH(sa);
    nb = LENGTH(sb);
    n = (na < nb) ? nb : na;

round(numeric(0)) really does round(numeric(0), 0) and hence we have na
= 0, n = nb = 1.  I think math2 is about right because you need that
sort of symmetry for recycling, but do_round() could know better.  Now

R> round(pi, 1:4)
[1] 3.1000 3.1400 3.1420 3.1416

is supposed to work so is it really clear what we want?  (if either arg
has length 0, does the result have length 0?  Should this be true for
any math2 type function?)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Jul 29 17:58:14 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 29 Jul 1999 17:58:14 +0100 (BST)
Subject: round(numeric(0)) (PR#235)
In-Reply-To: <14240.34347.395426.27168@fangorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.9907291752410.10671-100000@auk.stats>

On Thu, 29 Jul 1999, Kurt Hornik wrote:

> >>>>> ripley  writes:
> 
> > Try
> >> round(numeric(0))
> > [1] NA
> >> floor(numeric(0))
> > numeric(0)
> >> trunc(numeric(0))
> > numeric(0)
> 
> > S has them all as numeric(0), and I think R is wrong.
> > This looks like a design error in the math2 group: it applies to 
> > signif too, and also to the complex cases, e.g.
> >> signif(complex(0))
> > [1] NA
> 
> In math2, we have
> 
>     if (na < 1 || nb < 1) {
>         for (i = 0; i < n; i++)
>             y[i] = NA_REAL;
>     }
> 
> with
> 
>     na = LENGTH(sa);
>     nb = LENGTH(sb);
>     n = (na < nb) ? nb : na;
> 
> round(numeric(0)) really does round(numeric(0), 0) and hence we have na
> = 0, n = nb = 1.  I think math2 is about right because you need that
> sort of symmetry for recycling, but do_round() could know better.  Now
> 
> R> round(pi, 1:4)
> [1] 3.1000 3.1400 3.1420 3.1416
> 
> is supposed to work so is it really clear what we want?  (if either arg
> has length 0, does the result have length 0?  Should this be true for
> any math2 type function?)

Yes, I think that is what Svr4 says is the correct behaviour: the recycling
rules have been changed to be consistent (JMC says somewhere in the Green 
book) and any zero-length vector immediately makes the result of zero
length.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Jul 28 15:08:08 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 28 Jul 1999 10:08:08 -0400
Subject: Memory profiling/benchmarking
References: <19990727171758.A2622@stat1.stat.auckland.ac.nz> <379DC75D.DFFAFBC6@bank-banque-canada.ca> <19990804093220.A14758@stat1.stat.auckland.ac.nz>
Message-ID: <379F0EC8.FAB681E4@bank-banque-canada.ca>

Lyndon

>The latest DSE tar.gz file seems to be corrupt.

I think I fixed that yesterday about 20:00 GMT (which was before your
email but possibly after you downloaded it). If you've tried since then
and are still having trouble please let me know. (Also, if you are still
having trouble, the uncompressed file was not corrupted.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

