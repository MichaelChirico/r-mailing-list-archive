From censix0 at gmail.com  Wed Apr  1 12:45:29 2015
From: censix0 at gmail.com (cen six)
Date: Wed, 1 Apr 2015 12:45:29 +0200
Subject: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
In-Reply-To: <20150121193804.28843@web005.roc2.bluetie.com>
References: <20150121193804.28843@web005.roc2.bluetie.com>
Message-ID: <CAOGDGTY5T47Xgv-2Y0kgWtaq7grxMTJoN-SQOH8oOBJ9s9MyKw@mail.gmail.com>

Hi, I realize it has been a while, but essentially the problem is that the
recent versions of the IB API (i.e. as per TWS build 9493) do require api
clients to identify themselves with at least client-version63.  Now, the
last I have seen of the IBrokers package however uses client-version47 or
49 which is why there are problems when R clients connect. i.e. they may
not be assigned the clientId that they were requesting from the server,
etc. etc.

One way to fix this is to update the 'IBrokers' package. But I am not sure
who the maintainer is at the moment.

A workaround that I have found works reasonably well for me, is to include
the following file into your R code, right after loading the 'IBrokers'
package. You can download it from my repository here:

https://github.com/censix/INTRADAY-PartAB/blob/master/INTRADAY-PartA/__IBapi-clientVer63-v002.r

i.e. do something like

*library(IBrokers)*
*source("__IBapi-clientVer63-v002.r")*

The file re-implements  some of the outdated IBrokers() function and
overwrites them. A word of warning however!  This is only a PARTIAL IB api
implementation. Only the most basic ordertypes have been implemented, so
only use this if you know what you are doing.

Regards

Soren



On Thu, Jan 22, 2015 at 1:38 AM, ce <zadig_1 at excite.com> wrote:

>
> I use stable version. I tried latest beta too, didn't help.
> Indeed downgrade fixed clientid problem but my main problem (
> https://groups.yahoo.com/neo/groups/TWSAPI/conversations/messages/33071 )
> ,  event handler returns garbled data persists, instead of correct 2100
> error I still get :
>
> paraml[[1]]= -1
> paraml[[2]]= NA
> paraml[[3]]= PF1
> paraml[[4]]= API client has been unsubscribed from account data..NA
>
> I guess I need to contact IBrokers maintainer , I can't think of what else
> to do .
> best
> ce
>
> -----Original Message-----
> From: "cen six" [censix0 at gmail.com]
> Date: 01/21/2015 11:24 AM
> To: "ce" <zadig_1 at excite.com>
> CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
>
> Well, for sure a downgrade of the TWS would fix it, but its obviously not
> a long term solution. Are you using a beta TWS version or a stable release ?
>
>
> On Wed, Jan 21, 2015 at 4:07 AM, ce <zadig_1 at excite.com> wrote:
>
> I downgraded IBrokers version to 0.9-10, while keeping TWS Build 948.3c,
> Jan 5, 2015 5:12:23 PM ,
> still I got the wrong clientid from TWS.
>
> Then I downgraded TWS to  Build 945.2b, Jun 3, 2014 11:11:57 AM and it
> worked correctly with IBrokers 0.9-10
>
> I see my clientid 96 is returned from TWS :
>
> TWS OpenOrder: orderId=2 clientId=96 conId=14321015 symbol=GBP
> status=Filled
>
>
> -----Original Message-----
> From: "ce" [zadig_1 at excite.com]
> Date: 01/20/2015 07:52 PM
> To: censix0 at gmail.com
> CC: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
>
>
> Hi Cen six,
>
> I am using IBrokers 0.9.12 from cran r web site.
> In fact I was testing the demo program from you emailed me. It was working
> fine but one or two weeks ago event handler started to fail ( maybe after
> IBrokers update )  as I explained in :
> https://groups.yahoo.com/neo/groups/TWSAPI/conversations/messages/33071
>
> then I upgraded TWS but now clientid returned by event handler is wrong.
> Maybe I should downgrade IBrokers or TWS ?
>
> ce
>
>
> -----Original Message-----
> From: "cen six" [censix0 at gmail.com]
> Date: 01/20/2015 03:04 PM
> To: "ce" <zadig_1 at excite.com>
> CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
>
> Are you using the IBrokers package version 0.9-10  or higher ? (from
> code.google.com)
>
>
> cheers
>
>
> On Tue, Jan 20, 2015 at 2:38 AM, ce <zadig_1 at excite.com> wrote:
>
> Dear all,
>
> I just upgraded TWS to Build 948.3c, Jan 5, 2015 5:12:23 PM
> My program that worked fine before started to return wrong clientid . I
> set client ID to 96. but after sending the order, In order status , or
> order execution events I get clientid 6  !!  Even I tried to set Master API
> Client ID to 96 in TWS -> Configuration -> API.  didnt work.
> If I set Clientid to 6,  TWS returns 0 as Clientid.
>
> Here is some piece of code :
>
> > ibClientId <- 96
> >
> >
> > #global: create the connection to IB  (this can probably not be stored
> anywhere, so
> > #we have to recreate it within "IBexecuteStrategy.r"
> > ibConnection<-NULL
> > if (!is.twsConnection(ibConnection)) {
> +    ibConnection<- twsConnect(clientId=ibClientId, host="localhost",
> +                                       port=7496, verbose=TRUE,
> +                                       timeout=15, filename=NULL)
> + }
> > print(ibConnection)
> <twsConnection,96 @ 20150119 20:25:19 EST, nextId=4>
>
> TWS OpenOrder: orderId=3 clientId=6 conId=12087807 symbol=EUR
> status=Submitted
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should g
>
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From zadig_1 at excite.com  Wed Apr  1 20:48:20 2015
From: zadig_1 at excite.com (ce)
Date: Wed, 01 Apr 2015 14:48:20 -0400
Subject: [R-SIG-Finance] help with chart.Histogram of PerformanceAnalytics ?
Message-ID: <20150401144820.18778@web003.roc2.bluetie.com>

Dear all,

Sorry for the dump question, my statistics knowledge is limited  My questions is how to interpret chart.Histogram diagram ? What is best to maximize returns and minimize risk of my backtesting ? 
My line is :

chart.Histogram(returns,methods = c("add.normal","add.density","add.centered","add.rug","add.risk","add.qqplot"))

- add.normal :  should be regular bell curve , fat tail,skewed, leptokurtic, mesokurtic, platykurtic ?
- add.density : should be regular bell curve , fat tail,skewed, leptokurtic, mesokurtic, platykurtic ?
- add.risk: Is it better  it be far from peak of the curves or close?    What is the difference between Var and ModVar ? Should they be close to each other, left, right of each other ? 
- add.qqplot: which shape is the best, all look the same to me? 

I had seen also R histogram help and related web site http://zoonek2.free.fr/UNIX/48_R/03.html 

I attach pdf file but if you cant see it there are similar examples on internet :

http://i2.wp.com/2.bp.blogspot.com/-BnYSdT3jHNg/UWbBo4Utd9I/AAAAAAAAAcQ/2bb8iWPXwtE/s1600/daxbhhisto.png
https://tradeblotter.wordpress.com/2013/01/18/visually-comparing-return-distributions/

Thanks for reading
ce
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hist.pdf
Type: application/pdf
Size: 35597 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150401/46bf2ff8/attachment.pdf>

From josh.m.ulrich at gmail.com  Thu Apr  2 01:56:56 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 1 Apr 2015 18:56:56 -0500
Subject: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
In-Reply-To: <CAOGDGTY5T47Xgv-2Y0kgWtaq7grxMTJoN-SQOH8oOBJ9s9MyKw@mail.gmail.com>
References: <20150121193804.28843@web005.roc2.bluetie.com>
	<CAOGDGTY5T47Xgv-2Y0kgWtaq7grxMTJoN-SQOH8oOBJ9s9MyKw@mail.gmail.com>
Message-ID: <CAPPM_gRAGEZZvRaGS4pBLV-92fgwSMeLhDxvh-N2ae=a0EmRmg@mail.gmail.com>

On Wed, Apr 1, 2015 at 5:45 AM, cen six <censix0 at gmail.com> wrote:
>
> Hi, I realize it has been a while, but essentially the problem is that the
> recent versions of the IB API (i.e. as per TWS build 9493) do require api
> clients to identify themselves with at least client-version63.  Now, the
> last I have seen of the IBrokers package however uses client-version47 or
> 49 which is why there are problems when R clients connect. i.e. they may
> not be assigned the clientId that they were requesting from the server,
> etc. etc.
>
> One way to fix this is to update the 'IBrokers' package. But I am not sure
> who the maintainer is at the moment.
>
R> packageDescription("IBrokers")[c("Version","Maintainer")]
$Version
[1] "0.9-12"

$Maintainer
[1] "Joshua M. Ulrich <josh.m.ulrich at gmail.com>"

The source is on GitHub.  Pull requests welcome.
https://github.com/joshuaulrich/IBrokers

> A workaround that I have found works reasonably well for me, is to include
> the following file into your R code, right after loading the 'IBrokers'
> package. You can download it from my repository here:
>
> https://github.com/censix/INTRADAY-PartAB/blob/master/INTRADAY-PartA/__IBapi-clientVer63-v002.r
>
> i.e. do something like
>
> *library(IBrokers)*
> *source("__IBapi-clientVer63-v002.r")*
>
> The file re-implements  some of the outdated IBrokers() function and
> overwrites them. A word of warning however!  This is only a PARTIAL IB api
> implementation. Only the most basic ordertypes have been implemented, so
> only use this if you know what you are doing.
>
> Regards
>
> Soren
>
>
>
> On Thu, Jan 22, 2015 at 1:38 AM, ce <zadig_1 at excite.com> wrote:
>
> >
> > I use stable version. I tried latest beta too, didn't help.
> > Indeed downgrade fixed clientid problem but my main problem (
> > https://groups.yahoo.com/neo/groups/TWSAPI/conversations/messages/33071 )
> > ,  event handler returns garbled data persists, instead of correct 2100
> > error I still get :
> >
> > paraml[[1]]= -1
> > paraml[[2]]= NA
> > paraml[[3]]= PF1
> > paraml[[4]]= API client has been unsubscribed from account data..NA
> >
> > I guess I need to contact IBrokers maintainer , I can't think of what else
> > to do .
> > best
> > ce
> >
> > -----Original Message-----
> > From: "cen six" [censix0 at gmail.com]
> > Date: 01/21/2015 11:24 AM
> > To: "ce" <zadig_1 at excite.com>
> > CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> > Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
> >
> > Well, for sure a downgrade of the TWS would fix it, but its obviously not
> > a long term solution. Are you using a beta TWS version or a stable release ?
> >
> >
> > On Wed, Jan 21, 2015 at 4:07 AM, ce <zadig_1 at excite.com> wrote:
> >
> > I downgraded IBrokers version to 0.9-10, while keeping TWS Build 948.3c,
> > Jan 5, 2015 5:12:23 PM ,
> > still I got the wrong clientid from TWS.
> >
> > Then I downgraded TWS to  Build 945.2b, Jun 3, 2014 11:11:57 AM and it
> > worked correctly with IBrokers 0.9-10
> >
> > I see my clientid 96 is returned from TWS :
> >
> > TWS OpenOrder: orderId=2 clientId=96 conId=14321015 symbol=GBP
> > status=Filled
> >
> >
> > -----Original Message-----
> > From: "ce" [zadig_1 at excite.com]
> > Date: 01/20/2015 07:52 PM
> > To: censix0 at gmail.com
> > CC: r-sig-finance at r-project.org
> > Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
> >
> >
> > Hi Cen six,
> >
> > I am using IBrokers 0.9.12 from cran r web site.
> > In fact I was testing the demo program from you emailed me. It was working
> > fine but one or two weeks ago event handler started to fail ( maybe after
> > IBrokers update )  as I explained in :
> > https://groups.yahoo.com/neo/groups/TWSAPI/conversations/messages/33071
> >
> > then I upgraded TWS but now clientid returned by event handler is wrong.
> > Maybe I should downgrade IBrokers or TWS ?
> >
> > ce
> >
> >
> > -----Original Message-----
> > From: "cen six" [censix0 at gmail.com]
> > Date: 01/20/2015 03:04 PM
> > To: "ce" <zadig_1 at excite.com>
> > CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> > Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
> >
> > Are you using the IBrokers package version 0.9-10  or higher ? (from
> > code.google.com)
> >
> >
> > cheers
> >
> >
> > On Tue, Jan 20, 2015 at 2:38 AM, ce <zadig_1 at excite.com> wrote:
> >
> > Dear all,
> >
> > I just upgraded TWS to Build 948.3c, Jan 5, 2015 5:12:23 PM
> > My program that worked fine before started to return wrong clientid . I
> > set client ID to 96. but after sending the order, In order status , or
> > order execution events I get clientid 6  !!  Even I tried to set Master API
> > Client ID to 96 in TWS -> Configuration -> API.  didnt work.
> > If I set Clientid to 6,  TWS returns 0 as Clientid.
> >
> > Here is some piece of code :
> >
> > > ibClientId <- 96
> > >
> > >
> > > #global: create the connection to IB  (this can probably not be stored
> > anywhere, so
> > > #we have to recreate it within "IBexecuteStrategy.r"
> > > ibConnection<-NULL
> > > if (!is.twsConnection(ibConnection)) {
> > +    ibConnection<- twsConnect(clientId=ibClientId, host="localhost",
> > +                                       port=7496, verbose=TRUE,
> > +                                       timeout=15, filename=NULL)
> > + }
> > > print(ibConnection)
> > <twsConnection,96 @ 20150119 20:25:19 EST, nextId=4>
> >
> > TWS OpenOrder: orderId=3 clientId=6 conId=12087807 symbol=EUR
> > status=Submitted
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should g
> >
> >
> >
> >
> >
> >
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.




-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From n-e-w at qtradr.net  Thu Apr  2 02:19:08 2015
From: n-e-w at qtradr.net (Nick White)
Date: Thu, 2 Apr 2015 11:19:08 +1100
Subject: [R-SIG-Finance] help with chart.Histogram of
	PerformanceAnalytics ?
In-Reply-To: <20150401144820.18778@web003.roc2.bluetie.com>
References: <20150401144820.18778@web003.roc2.bluetie.com>
Message-ID: <CAH+4RFsXB0SsFrqRAAuXXFTsjRpEWBXibZrYVNj41h96TmpciA@mail.gmail.com>

>From a quick look at your PDF, i'm willing to bet this is an intraday
strategy. So, before going on, I would ask whether this is a stock or
futures trade...if this is a stock trade (and you've presented gross
returns),  then your expectation is likely going to be eaten up by
transaction costs and slippage (unless you're paying rock-bottom execution
costs and you understand your model limits well).

But, for the general answer in lay terms and in the absence of numerical
data, you have a (literal) extreme leptokurtic distribution of returns with
what initially appears to be some positive skew. What this means is that
your average return clusters aggressively around a nominally positive
return (hooyah! you've found an effect!)...but you can have some big
outliers and tail events which will overwhelm your expectation from time to
time (bummer). I would also suspect that you've found an academically
'significant' effect if you were to measure it...but (1) in practical terms
it's probably not going to be nearly significant enough for the realities
of the market and (2) it might even not be significant given some of the
properties of what appears to happen with your negative returns...which
leads nicely to the quantile plot.

This is what the quantile plot shows...if your strategy's return was
normally distributed (and very few strategies are) then all the points
would lie along the diagonal line....what the quantile plot is showing you
is that the magnitude of your outliers increasingly deviates from normal
expectation as you go further out into the tails. I can't tell because the
quantile plot doesn't have scale, but eyeballing it looks like your
negative deviations from normal are more skewed than your positive
deviations. That is, your bad outliers are worse (and increasingly worsen
at a greater rate) than your good outliers do. Not a good sign.

So, without knowing details, this shows that you have a strategy where you
are probably nominally / implicitly "short vol". It shows you have the
foundation for probably having found some kind of effect, but you now need
to go and research to find the best way of exploiting the effect you've
discovered...and, most importantly, how to bet / size your trades on that
effect once you've optimized your signal. You might look at Maximum Adverse
Excursion data if this is intraday based.

But all of the above is moot if, in the real world, your execution costs
(explicit and implicit) outweigh your upside.

HTH

On Thu, Apr 2, 2015 at 5:48 AM, ce <zadig_1 at excite.com> wrote:

> Dear all,
>
> Sorry for the dump question, my statistics knowledge is limited  My
> questions is how to interpret chart.Histogram diagram ? What is best to
> maximize returns and minimize risk of my backtesting ?
> My line is :
>
> chart.Histogram(returns,methods =
> c("add.normal","add.density","add.centered","add.rug","add.risk","add.qqplot"))
>
> - add.normal :  should be regular bell curve , fat tail,skewed,
> leptokurtic, mesokurtic, platykurtic ?
> - add.density : should be regular bell curve , fat tail,skewed,
> leptokurtic, mesokurtic, platykurtic ?
> - add.risk: Is it better  it be far from peak of the curves or close?
> What is the difference between Var and ModVar ? Should they be close to
> each other, left, right of each other ?
> - add.qqplot: which shape is the best, all look the same to me?
>
> I had seen also R histogram help and related web site
> http://zoonek2.free.fr/UNIX/48_R/03.html
>
> I attach pdf file but if you cant see it there are similar examples on
> internet :
>
>
> http://i2.wp.com/2.bp.blogspot.com/-BnYSdT3jHNg/UWbBo4Utd9I/AAAAAAAAAcQ/2bb8iWPXwtE/s1600/daxbhhisto.png
>
> https://tradeblotter.wordpress.com/2013/01/18/visually-comparing-return-distributions/
>
> Thanks for reading
> ce
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From uelihofstetter at gmail.com  Thu Apr  2 03:41:34 2015
From: uelihofstetter at gmail.com (Ueli Hofstetter)
Date: Thu, 2 Apr 2015 03:41:34 +0200
Subject: [R-SIG-Finance] Questions regarding Cashflows in Blotter and
	hacking Quantstrat
Message-ID: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>

I have posted two questions regarding Blotter and Quantstrat on
Stackoverflow and appreciate any hints and suggestions:

Nr 1: ----------------------------------------------
http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter

How to implement rule based rebalancing strategy using QUANTSTRAT/BLOTTER
<http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter>
:

I am trying to implement a rulebased rebalancing strategy within the
QUANTSTRAT framework. Let's assume I want to base my rebalancing time for a
portfolio of instruments on some indicator which is not calculated from a
traded instrument but from some other time series (for instance GDP
figures) and whenever the signal based on that indicator is triggered
(let's say GDP drops by x% within some period z) I d'like rebalance my
portfolio according to some rebalancing algorithm (e.g. Markowitz).

My idea was to

   - create a dummy instrument for the non-instrument based timeseries so
   that I can define and indicator and rule based on it and
   - to write my own 'ruleSignal' implementation in order to do the
   algorithm based rebalancing.

So my question is: Is this a reasonable approach (is it even possible)? Or
would it be better to use BLOTTER directly (and thus not to rely on the
QUANTSTRAT abstraction)?


Nr 2: ----------------------------------------------
http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
How do blotter/quantstrat/quantmod/performanceanalytics handle internal
cashflows
<http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow>
?

I don't understand how internal cashflows are handled in
blotter/quantstrat/quantmod/performanceanalytics. This mainly concerns two
aspects: Regular cashflows like dividends, coupons etc. as well as
cashflows from expiring instruments (e.g. a cash settled in the money
option). For equities this seems not too much of an issue as one can always
use dividend adjusted prices and it is relatively rare that stocks get
delisted. For coupon bonds or options however, I don't get how this is
handled.

So my questions are:

   - Is there a generic mechanism to handle internal cashflows (dividends,
   coupons, repayments etc.) in these packages?
   - If so, is there some documentation for this and where can I find the
   relevant implementation in the source code (i.e. pointers to specific R
   files and/or functions would be great)?

Cheers

-- 
Ueli Hofstetter

	[[alternative HTML version deleted]]


From uelihofstetter at gmail.com  Thu Apr  2 03:47:11 2015
From: uelihofstetter at gmail.com (Ueli Hofstetter)
Date: Thu, 2 Apr 2015 03:47:11 +0200
Subject: [R-SIG-Finance] Problem using Quantmod and MySQL
In-Reply-To: <CAK2H+efJBJMhUFR5PT4Cxws2rZfSgGght9jj2meu4ojVoriHDw@mail.gmail.com>
References: <CA+fgw8QF7gGqZs=ks1HTvqBA-m-2Mw=mqGtXQ4kfM7f27ESXPQ@mail.gmail.com>
	<CAPPM_gR=B-fw6fZn2yMa-encND=Vno=aDTHt_HGP3SWhaqHDsQ@mail.gmail.com>
	<CAPPM_gQk-trahkccEXBavnf6p4am7uEVARZL4ASJpVVB0n2AcQ@mail.gmail.com>
	<CAK2H+efbW-HAm-UrqAKm8FRAVQ20OH4uXPJ9NzLVqB32Kp6bzQ@mail.gmail.com>
	<CAPPM_gQVCw7a3j3wcMdDSeud_J-3CR59i1j6__Nq5D_X81zNuw@mail.gmail.com>
	<CAK2H+efJBJMhUFR5PT4Cxws2rZfSgGght9jj2meu4ojVoriHDw@mail.gmail.com>
Message-ID: <CA+fgw8RHw32ZtrH3ED=aCqu+WVDQwcDAWJ7VtKMpi5bGpY9z=A@mail.gmail.com>

Has someone fixed/tested this in the meantime? Otherwise I will give it a
try.

Cheers

2015-03-30 19:02 GMT+02:00 Mark Knecht <markknecht at gmail.com>:

> On Mon, Mar 30, 2015 at 9:59 AM, Joshua Ulrich <josh.m.ulrich at gmail.com>
> wrote:
> > On Mon, Mar 30, 2015 at 11:49 AM, Mark Knecht <markknecht at gmail.com>
> wrote:
> >> On Mon, Mar 30, 2015 at 9:25 AM, Joshua Ulrich <josh.m.ulrich at gmail.com>
> wrote:
> >>> On Sun, Mar 29, 2015 at 5:37 PM, Joshua Ulrich <
> josh.m.ulrich at gmail.com> wrote:
> >>>> On Sun, Mar 29, 2015 at 1:50 PM, Ueli Hofstetter
> >>>> <uelihofstetter at gmail.com> wrote:
> >>>>> I have some problems loading symbols from an mysql db using
> getSymbols.
> >>>>>
> >>>>> Instead of repeating the issue, here is a link to the description on
> >>>>> stackoverflow
> >>>>>
> >>>>>
> http://stackoverflow.com/questions/29333330/quantmod-error-loading-symbols-from-mysql-db
> >>>>>
> >>>>> Any help is greatly appreciated
> >>>>>
> >>>> The "character" method for dbConnect was removed in the 0.10 release
> >>>> of RMySQL. I'm not sure whether or not this was intentional. It was
> >>>> not mentioned in the release notes.
> >>>>
> >>> It was removed intentionally.  I do not have a MySQL database
> >>> available for testing, so I would really appreciate some help from
> >>> those who use this functionality.  Can someone please try this
> >>> suggested edit:
> >>> https://github.com/rstats-db/RMySQL/issues/62#issuecomment-87692704
> >>>
> >>> And provide feedback at:
> https://github.com/joshuaulrich/quantmod/issues/45
> >>>
> >>> Thanks!
> >>> Josh
> >>>
> >>>
> >>> --
> >>> Joshua Ulrich  |  about.me/joshuaulrich
> >>> FOSS Trading  |  www.fosstrading.com
> >>>
> >>> _______________________________________________
> >>> R-SIG-Finance at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >>> -- Subscriber-posting only. If you want to post, subscribe first.
> >>> -- Also note that this is not the r-help list where general R
> questions should go.
> >>
> >>
> >>
> >> I'm happy to try it out but a little confused as to all the locations
> >> I need to edit. Help me clear this up and I'll try it out immediately.
> >>
> >> The failure is coming when I'm trying to get the data using the
> following code:
> >>
> >>> if (DownloadNewData){
> >> +   if (!UseMySQL){
> >> +     for (i in 1:length(TestSym)){
> >> +       print(paste("From ",SymbolSrc," -- ",TestSym[i]))
> >> +       getSymbolsCont(TestSym[i], from = DataStart, to = DataEnd,
> >> adjust = MyAdjust, src=SymbolSrc)
> >> +     }
> >> +   } else {
> >> +     for (i in 1:length(TestSym)){
> >> +       print(paste("From MySQL -- ",TestSym[i]))
> >> + #      getSymbols(TestSym[i], src="MySQL")
> >> +       getSymbols(TestSym[i], src="MySQL", user="mark",
> >> password="MyTempPassword", dbname=dbName)
> >> +       assign(TestSym[i],
> get(TestSym[i])[paste0(DataStart,"/",DataEnd)])
> >> +     }
> >> +     dbDisconnect(dbc)
> >> +   }
> >> + }
> >> [1] "From MySQL --  SPY"
> >>  Show Traceback
> >>
> >>  Rerun with Debug
> >>
> >> Error in (function (classes, fdef, mtable)  :
> >>   unable to find an inherited method for function ?dbConnect? for
> >> signature ?"character"?
> >>
> >>
> >> Am I correct that the suggestion is to edit two lines?
> >>
> >> First, I use
> >>
> >> library(RMySQL)
> >>
> >> Is the first edit to change this to
> >>
> >> requireNamespace("RMySQL", quietly = TRUE)
> >>
> >> or do I add this to my code somewhere and keep the library command?
> >>
> > No, you shouldn't need to change anything in your code.
> >
> >> Later in my code I have:
> >>
> >> if (UseMySQL){
> >>   if (MyAdjust) { dbName = paste0(dbName, "Adjust")}
> >>   dbc = dbConnect(MySQL(), dbname=dbName)
> >> #  setDefaults(getSymbols.MySQL, user="mark",
> >> password="MyTempPassword", dbname=dbName)
> >> }
> >>
> >> This would be where the second edit goes?
> >>
> >> dbConnect("MySQL", ...) to dbConnect(RMySQL::MySQL, ...)
> >>
> > No. Again, you shouldn't need to change your code.  The change
> > required is on L614 of getSymbols.R.
> >
> >> Thanks,
> >> Mark
> >
> >
> >
> > --
> > Joshua Ulrich  |  about.me/joshuaulrich
> > FOSS Trading  |  www.fosstrading.com
>
> In that case I'll leave it to someone else to test. I don't want to
> mess with non-production libraries. My skill set in this code isn't
> good.
>
> Good luck,
> Mark
>



-- 
Ueli Hofstetter

	[[alternative HTML version deleted]]


From ilya.kipnis at gmail.com  Thu Apr  2 03:50:34 2015
From: ilya.kipnis at gmail.com (Ilya Kipnis)
Date: Wed, 1 Apr 2015 21:50:34 -0400
Subject: [R-SIG-Finance] Questions regarding Cashflows in Blotter and
 hacking Quantstrat
In-Reply-To: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>
References: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>
Message-ID: <CA+oJuEFTLB-qC3hXGErKGOVa40kd_dfrsjRYj0GobnsHeWv=uw@mail.gmail.com>

Ueli,

Why don't you just append the indicator to the instruments before you
create the strategy? That is, you know how an instrument is usually defined
by OHLCV? Why not add another column called MyIndicator to your instruments
outside the strategy definition? The strategy will pick up the column in
the signals phase.

-Ilya

On Wed, Apr 1, 2015 at 9:41 PM, Ueli Hofstetter <uelihofstetter at gmail.com>
wrote:

> I have posted two questions regarding Blotter and Quantstrat on
> Stackoverflow and appreciate any hints and suggestions:
>
> Nr 1: ----------------------------------------------
>
> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>
> How to implement rule based rebalancing strategy using QUANTSTRAT/BLOTTER
> <
> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
> >
> :
>
> I am trying to implement a rulebased rebalancing strategy within the
> QUANTSTRAT framework. Let's assume I want to base my rebalancing time for a
> portfolio of instruments on some indicator which is not calculated from a
> traded instrument but from some other time series (for instance GDP
> figures) and whenever the signal based on that indicator is triggered
> (let's say GDP drops by x% within some period z) I d'like rebalance my
> portfolio according to some rebalancing algorithm (e.g. Markowitz).
>
> My idea was to
>
>    - create a dummy instrument for the non-instrument based timeseries so
>    that I can define and indicator and rule based on it and
>    - to write my own 'ruleSignal' implementation in order to do the
>    algorithm based rebalancing.
>
> So my question is: Is this a reasonable approach (is it even possible)? Or
> would it be better to use BLOTTER directly (and thus not to rely on the
> QUANTSTRAT abstraction)?
>
>
> Nr 2: ----------------------------------------------
>
> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
> How do blotter/quantstrat/quantmod/performanceanalytics handle internal
> cashflows
> <
> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
> >
> ?
>
> I don't understand how internal cashflows are handled in
> blotter/quantstrat/quantmod/performanceanalytics. This mainly concerns two
> aspects: Regular cashflows like dividends, coupons etc. as well as
> cashflows from expiring instruments (e.g. a cash settled in the money
> option). For equities this seems not too much of an issue as one can always
> use dividend adjusted prices and it is relatively rare that stocks get
> delisted. For coupon bonds or options however, I don't get how this is
> handled.
>
> So my questions are:
>
>    - Is there a generic mechanism to handle internal cashflows (dividends,
>    coupons, repayments etc.) in these packages?
>    - If so, is there some documentation for this and where can I find the
>    relevant implementation in the source code (i.e. pointers to specific R
>    files and/or functions would be great)?
>
> Cheers
>
> --
> Ueli Hofstetter
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From uelihofstetter at gmail.com  Thu Apr  2 04:04:14 2015
From: uelihofstetter at gmail.com (Ueli Hofstetter)
Date: Thu, 2 Apr 2015 04:04:14 +0200
Subject: [R-SIG-Finance] Questions regarding Cashflows in Blotter and
 hacking Quantstrat
In-Reply-To: <CA+oJuEFTLB-qC3hXGErKGOVa40kd_dfrsjRYj0GobnsHeWv=uw@mail.gmail.com>
References: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>
	<CA+oJuEFTLB-qC3hXGErKGOVa40kd_dfrsjRYj0GobnsHeWv=uw@mail.gmail.com>
Message-ID: <CA+fgw8QFdLwVE7sGKGMgBUMUNS2qXAAUjEO0u1OrHL6HeepueA@mail.gmail.com>

Hi Ilya, thanks for the reply.

Yes I guess this would eliminate the need to add a dummy instrument for the
non-instrument based timeseries. But than the problem is that the signal
gets triggered for all securities in the universe, but actually I need only
one signal to trigger the rebalancing  (again, the signal could be
something like the current lunar phase, i.e. not related to any securities
in the portfolio/universe)..... or did I miss your argument?

2015-04-02 3:50 GMT+02:00 Ilya Kipnis <ilya.kipnis at gmail.com>:

> Ueli,
>
> Why don't you just append the indicator to the instruments before you
> create the strategy? That is, you know how an instrument is usually defined
> by OHLCV? Why not add another column called MyIndicator to your instruments
> outside the strategy definition? The strategy will pick up the column in
> the signals phase.
>
> -Ilya
>
> On Wed, Apr 1, 2015 at 9:41 PM, Ueli Hofstetter <uelihofstetter at gmail.com>
> wrote:
>
>> I have posted two questions regarding Blotter and Quantstrat on
>> Stackoverflow and appreciate any hints and suggestions:
>>
>> Nr 1: ----------------------------------------------
>>
>> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>>
>> How to implement rule based rebalancing strategy using QUANTSTRAT/BLOTTER
>> <
>> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>> >
>> :
>>
>> I am trying to implement a rulebased rebalancing strategy within the
>> QUANTSTRAT framework. Let's assume I want to base my rebalancing time for
>> a
>> portfolio of instruments on some indicator which is not calculated from a
>> traded instrument but from some other time series (for instance GDP
>> figures) and whenever the signal based on that indicator is triggered
>> (let's say GDP drops by x% within some period z) I d'like rebalance my
>> portfolio according to some rebalancing algorithm (e.g. Markowitz).
>>
>> My idea was to
>>
>>    - create a dummy instrument for the non-instrument based timeseries so
>>    that I can define and indicator and rule based on it and
>>    - to write my own 'ruleSignal' implementation in order to do the
>>    algorithm based rebalancing.
>>
>> So my question is: Is this a reasonable approach (is it even possible)? Or
>> would it be better to use BLOTTER directly (and thus not to rely on the
>> QUANTSTRAT abstraction)?
>>
>>
>> Nr 2: ----------------------------------------------
>>
>> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
>> How do blotter/quantstrat/quantmod/performanceanalytics handle internal
>> cashflows
>> <
>> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
>> >
>> ?
>>
>> I don't understand how internal cashflows are handled in
>> blotter/quantstrat/quantmod/performanceanalytics. This mainly concerns two
>> aspects: Regular cashflows like dividends, coupons etc. as well as
>> cashflows from expiring instruments (e.g. a cash settled in the money
>> option). For equities this seems not too much of an issue as one can
>> always
>> use dividend adjusted prices and it is relatively rare that stocks get
>> delisted. For coupon bonds or options however, I don't get how this is
>> handled.
>>
>> So my questions are:
>>
>>    - Is there a generic mechanism to handle internal cashflows (dividends,
>>    coupons, repayments etc.) in these packages?
>>    - If so, is there some documentation for this and where can I find the
>>    relevant implementation in the source code (i.e. pointers to specific R
>>    files and/or functions would be great)?
>>
>> Cheers
>>
>> --
>> Ueli Hofstetter
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>


-- 
Ueli Hofstetter

	[[alternative HTML version deleted]]


From ilya.kipnis at gmail.com  Thu Apr  2 04:17:38 2015
From: ilya.kipnis at gmail.com (Ilya Kipnis)
Date: Wed, 1 Apr 2015 22:17:38 -0400
Subject: [R-SIG-Finance] Questions regarding Cashflows in Blotter and
 hacking Quantstrat
In-Reply-To: <CA+fgw8QFdLwVE7sGKGMgBUMUNS2qXAAUjEO0u1OrHL6HeepueA@mail.gmail.com>
References: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>
	<CA+oJuEFTLB-qC3hXGErKGOVa40kd_dfrsjRYj0GobnsHeWv=uw@mail.gmail.com>
	<CA+fgw8QFdLwVE7sGKGMgBUMUNS2qXAAUjEO0u1OrHL6HeepueA@mail.gmail.com>
Message-ID: <CA+oJuEHYRqs-DRc4v4vznVmrEacME5=QBfx4-iBS+W7d3r-EYA@mail.gmail.com>

Well, I'm not sure quantstrat is the tool for that, then. Quantstrat is a
signal-based backtesting system. If you want to rebalance a portfolio based
on a signal, you may want to do that in PerformanceAnalytics with
Return.Portfolio functionality. Is there a particular reason you want to
use quantstrat?

On Wed, Apr 1, 2015 at 10:04 PM, Ueli Hofstetter <uelihofstetter at gmail.com>
wrote:

> Hi Ilya, thanks for the reply.
>
> Yes I guess this would eliminate the need to add a dummy instrument for
> the non-instrument based timeseries. But than the problem is that the
> signal gets triggered for all securities in the universe, but actually I
> need only one signal to trigger the rebalancing  (again, the signal could
> be something like the current lunar phase, i.e. not related to any
> securities in the portfolio/universe)..... or did I miss your argument?
>
> 2015-04-02 3:50 GMT+02:00 Ilya Kipnis <ilya.kipnis at gmail.com>:
>
>> Ueli,
>>
>> Why don't you just append the indicator to the instruments before you
>> create the strategy? That is, you know how an instrument is usually defined
>> by OHLCV? Why not add another column called MyIndicator to your instruments
>> outside the strategy definition? The strategy will pick up the column in
>> the signals phase.
>>
>> -Ilya
>>
>> On Wed, Apr 1, 2015 at 9:41 PM, Ueli Hofstetter <uelihofstetter at gmail.com
>> > wrote:
>>
>>> I have posted two questions regarding Blotter and Quantstrat on
>>> Stackoverflow and appreciate any hints and suggestions:
>>>
>>> Nr 1: ----------------------------------------------
>>>
>>> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>>>
>>> How to implement rule based rebalancing strategy using QUANTSTRAT/BLOTTER
>>> <
>>> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>>> >
>>> :
>>>
>>> I am trying to implement a rulebased rebalancing strategy within the
>>> QUANTSTRAT framework. Let's assume I want to base my rebalancing time
>>> for a
>>> portfolio of instruments on some indicator which is not calculated from a
>>> traded instrument but from some other time series (for instance GDP
>>> figures) and whenever the signal based on that indicator is triggered
>>> (let's say GDP drops by x% within some period z) I d'like rebalance my
>>> portfolio according to some rebalancing algorithm (e.g. Markowitz).
>>>
>>> My idea was to
>>>
>>>    - create a dummy instrument for the non-instrument based timeseries so
>>>    that I can define and indicator and rule based on it and
>>>    - to write my own 'ruleSignal' implementation in order to do the
>>>    algorithm based rebalancing.
>>>
>>> So my question is: Is this a reasonable approach (is it even possible)?
>>> Or
>>> would it be better to use BLOTTER directly (and thus not to rely on the
>>> QUANTSTRAT abstraction)?
>>>
>>>
>>> Nr 2: ----------------------------------------------
>>>
>>> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
>>> How do blotter/quantstrat/quantmod/performanceanalytics handle internal
>>> cashflows
>>> <
>>> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
>>> >
>>> ?
>>>
>>> I don't understand how internal cashflows are handled in
>>> blotter/quantstrat/quantmod/performanceanalytics. This mainly concerns
>>> two
>>> aspects: Regular cashflows like dividends, coupons etc. as well as
>>> cashflows from expiring instruments (e.g. a cash settled in the money
>>> option). For equities this seems not too much of an issue as one can
>>> always
>>> use dividend adjusted prices and it is relatively rare that stocks get
>>> delisted. For coupon bonds or options however, I don't get how this is
>>> handled.
>>>
>>> So my questions are:
>>>
>>>    - Is there a generic mechanism to handle internal cashflows
>>> (dividends,
>>>    coupons, repayments etc.) in these packages?
>>>    - If so, is there some documentation for this and where can I find the
>>>    relevant implementation in the source code (i.e. pointers to specific
>>> R
>>>    files and/or functions would be great)?
>>>
>>> Cheers
>>>
>>> --
>>> Ueli Hofstetter
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
>
> --
> Ueli Hofstetter
>

	[[alternative HTML version deleted]]


From uelihofstetter at gmail.com  Thu Apr  2 04:50:55 2015
From: uelihofstetter at gmail.com (Ueli Hofstetter)
Date: Thu, 2 Apr 2015 04:50:55 +0200
Subject: [R-SIG-Finance] Questions regarding Cashflows in Blotter and
 hacking Quantstrat
In-Reply-To: <CA+oJuEHYRqs-DRc4v4vznVmrEacME5=QBfx4-iBS+W7d3r-EYA@mail.gmail.com>
References: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>
	<CA+oJuEFTLB-qC3hXGErKGOVa40kd_dfrsjRYj0GobnsHeWv=uw@mail.gmail.com>
	<CA+fgw8QFdLwVE7sGKGMgBUMUNS2qXAAUjEO0u1OrHL6HeepueA@mail.gmail.com>
	<CA+oJuEHYRqs-DRc4v4vznVmrEacME5=QBfx4-iBS+W7d3r-EYA@mail.gmail.com>
Message-ID: <CA+fgw8SHbkYL12xrWLbnS1FK=NcMwa_8iKDq2rfkirodNz_B2w@mail.gmail.com>

Thanks for the reply. Regarding the reason for using quantstrat: No, there
is no particular reason but that it seems to provide quite a lot of
functionality out of the box .... but unfortunately, as you pointed out, it
is not the functionality I actually need ;-). In this case, I guess I will
use blotter and performanceanalytics directly.

thanks a lot for the advise.

2015-04-02 4:17 GMT+02:00 Ilya Kipnis <ilya.kipnis at gmail.com>:

> Well, I'm not sure quantstrat is the tool for that, then. Quantstrat is a
> signal-based backtesting system. If you want to rebalance a portfolio based
> on a signal, you may want to do that in PerformanceAnalytics with
> Return.Portfolio functionality. Is there a particular reason you want to
> use quantstrat?
>
> On Wed, Apr 1, 2015 at 10:04 PM, Ueli Hofstetter <uelihofstetter at gmail.com
> > wrote:
>
>> Hi Ilya, thanks for the reply.
>>
>> Yes I guess this would eliminate the need to add a dummy instrument for
>> the non-instrument based timeseries. But than the problem is that the
>> signal gets triggered for all securities in the universe, but actually I
>> need only one signal to trigger the rebalancing  (again, the signal could
>> be something like the current lunar phase, i.e. not related to any
>> securities in the portfolio/universe)..... or did I miss your argument?
>>
>> 2015-04-02 3:50 GMT+02:00 Ilya Kipnis <ilya.kipnis at gmail.com>:
>>
>>> Ueli,
>>>
>>> Why don't you just append the indicator to the instruments before you
>>> create the strategy? That is, you know how an instrument is usually defined
>>> by OHLCV? Why not add another column called MyIndicator to your instruments
>>> outside the strategy definition? The strategy will pick up the column in
>>> the signals phase.
>>>
>>> -Ilya
>>>
>>> On Wed, Apr 1, 2015 at 9:41 PM, Ueli Hofstetter <
>>> uelihofstetter at gmail.com> wrote:
>>>
>>>> I have posted two questions regarding Blotter and Quantstrat on
>>>> Stackoverflow and appreciate any hints and suggestions:
>>>>
>>>> Nr 1: ----------------------------------------------
>>>>
>>>> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>>>>
>>>> How to implement rule based rebalancing strategy using
>>>> QUANTSTRAT/BLOTTER
>>>> <
>>>> http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter
>>>> >
>>>> :
>>>>
>>>> I am trying to implement a rulebased rebalancing strategy within the
>>>> QUANTSTRAT framework. Let's assume I want to base my rebalancing time
>>>> for a
>>>> portfolio of instruments on some indicator which is not calculated from
>>>> a
>>>> traded instrument but from some other time series (for instance GDP
>>>> figures) and whenever the signal based on that indicator is triggered
>>>> (let's say GDP drops by x% within some period z) I d'like rebalance my
>>>> portfolio according to some rebalancing algorithm (e.g. Markowitz).
>>>>
>>>> My idea was to
>>>>
>>>>    - create a dummy instrument for the non-instrument based timeseries
>>>> so
>>>>    that I can define and indicator and rule based on it and
>>>>    - to write my own 'ruleSignal' implementation in order to do the
>>>>    algorithm based rebalancing.
>>>>
>>>> So my question is: Is this a reasonable approach (is it even possible)?
>>>> Or
>>>> would it be better to use BLOTTER directly (and thus not to rely on the
>>>> QUANTSTRAT abstraction)?
>>>>
>>>>
>>>> Nr 2: ----------------------------------------------
>>>>
>>>> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
>>>> How do blotter/quantstrat/quantmod/performanceanalytics handle internal
>>>> cashflows
>>>> <
>>>> http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow
>>>> >
>>>> ?
>>>>
>>>> I don't understand how internal cashflows are handled in
>>>> blotter/quantstrat/quantmod/performanceanalytics. This mainly concerns
>>>> two
>>>> aspects: Regular cashflows like dividends, coupons etc. as well as
>>>> cashflows from expiring instruments (e.g. a cash settled in the money
>>>> option). For equities this seems not too much of an issue as one can
>>>> always
>>>> use dividend adjusted prices and it is relatively rare that stocks get
>>>> delisted. For coupon bonds or options however, I don't get how this is
>>>> handled.
>>>>
>>>> So my questions are:
>>>>
>>>>    - Is there a generic mechanism to handle internal cashflows
>>>> (dividends,
>>>>    coupons, repayments etc.) in these packages?
>>>>    - If so, is there some documentation for this and where can I find
>>>> the
>>>>    relevant implementation in the source code (i.e. pointers to
>>>> specific R
>>>>    files and/or functions would be great)?
>>>>
>>>> Cheers
>>>>
>>>> --
>>>> Ueli Hofstetter
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>
>>>
>>
>>
>> --
>> Ueli Hofstetter
>>
>
>


-- 
Ueli Hofstetter

	[[alternative HTML version deleted]]


From aschmid1 at stevens.edu  Sun Apr  5 02:31:22 2015
From: aschmid1 at stevens.edu (aschmid1)
Date: Sat, 04 Apr 2015 20:31:22 -0400
Subject: [R-SIG-Finance] auto.arima
Message-ID: <b2cf0d0e3de6575ee9c974d81fa25e01@stevens.edu>

I have a sample X with 2600 points and 18 external regressors (dummy 
variables). X is integrated according to KPSS test: auto.arima() gives 
(2,1,2) model with a few statistically significant coeff. for dummies. 
Then I run auto.arima for Y=diff(X) and... get (6,0,6) model with very 
different coeff for dummies. Shouldn't I get (2,0,2) model for Y or at 
least similar coeff for dummies? Also, arima(2,0,2) for Y is very 
different from  (2,1,2) model for X. Which model should I believe?
BTW, auto.arima with ADF (rather than KPSS) for X gives (2,0,3) model 
with ar1=1.8346 and ar2=-0.8351 but its coeff for external regressors 
are very close to those for (2,1,2) -and I'm interested primarily in 
them. Still such uncertainty in arma coeff troubles me and I'll greatly 
appreciate your comments.

Thanks! Alec


From zadig_1 at excite.com  Mon Apr  6 02:48:22 2015
From: zadig_1 at excite.com (ce)
Date: Sun, 05 Apr 2015 20:48:22 -0400
Subject: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?
Message-ID: <20150405204822.10624@web005.roc2.bluetie.com>


Thank you very much Soren. Your fix worked perfectly well and solved a lot of problems as well as client id.
I couldn't sent trailing orders with percentage because of low client version, now it works too.

ce

-----Original Message-----
From: "cen six" [censix0 at gmail.com]
Date: 04/01/2015 06:45 AM
To: "ce" <zadig_1 at excite.com>
CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?

Hi, I realize it has been a while, but essentially the problem is that the recent versions of the IB API (i.e. as per TWS build 9493) do require api clients to identify themselves with at least client-version63.? Now, the last I have seen of the IBrokers package however uses client-version47 or 49 which is why there are problems when R clients connect. i.e. they may not be assigned the clientId that they were requesting from the server, etc. etc.

One way to fix this is to update the 'IBrokers' package. But I am not sure who the maintainer is at the moment.


A workaround that I have found works reasonably well for me, is to include the following file into your R code, right after loading the 'IBrokers' package. You can download it from my repository here:


https://github.com/censix/INTRADAY-PartAB/blob/master/INTRADAY-PartA/__IBapi-clientVer63-v002.r



i.e. do something like


library(IBrokers)
source("__IBapi-clientVer63-v002.r")


The file re-implements ?some of the outdated IBrokers() function and overwrites them. A word of warning however!? This is only a PARTIAL IB api implementation. Only the most basic ordertypes have been implemented, so only use this if you know what you are doing.


Regards


Soren






On Thu, Jan 22, 2015 at 1:38 AM, ce <zadig_1 at excite.com> wrote:

I use stable version. I tried latest beta too, didn't help.
Indeed downgrade fixed clientid problem but my main problem (https://groups.yahoo.com/neo/groups/TWSAPI/conversations/messages/33071 ) ,? event handler returns garbled data persists, instead of correct 2100 error I still get :

paraml[[1]]= -1
paraml[[2]]= NA
paraml[[3]]= PF1
paraml[[4]]= API client has been unsubscribed from account data..NA

I guess I need to contact IBrokers maintainer , I can't think of what else to do .
best
ce

-----Original Message-----
From: "cen six" [censix0 at gmail.com]
Date: 01/21/2015 11:24 AM
To: "ce" <zadig_1 at excite.com>
CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?

Well, for sure a downgrade of the TWS would fix it, but its obviously not a long term solution. Are you using a beta TWS version or a stable release ?


On Wed, Jan 21, 2015 at 4:07 AM, ce <zadig_1 at excite.com> wrote:

I downgraded IBrokers version to 0.9-10, while keeping TWS Build 948.3c, Jan 5, 2015 5:12:23 PM ,
still I got the wrong clientid from TWS.

Then I downgraded TWS to? Build 945.2b, Jun 3, 2014 11:11:57 AM and it worked correctly with IBrokers 0.9-10

I see my clientid 96 is returned from TWS :

TWS OpenOrder: orderId=2 clientId=96 conId=14321015 symbol=GBP status=Filled


-----Original Message-----
From: "ce" [zadig_1 at excite.com]
Date: 01/20/2015 07:52 PM
To: censix0 at gmail.com
CC: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?


Hi Cen six,

I am using IBrokers 0.9.12 from cran r web site.
In fact I was testing the demo program from you emailed me. It was working fine but one or two weeks ago event handler started to fail ( maybe after IBrokers update )? as I explained in : https://groups.yahoo.com/neo/groups/TWSAPI/conversations/messages/33071

then I upgraded TWS but now clientid returned by event handler is wrong.
Maybe I should downgrade IBrokers or TWS ?

ce


-----Original Message-----
From: "cen six" [censix0 at gmail.com]
Date: 01/20/2015 03:04 PM
To: "ce" <zadig_1 at excite.com>
CC: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] IBrokers Package: wrong Clientid returns ?

Are you using the IBrokers package version 0.9-10? or higher ? (from code.google.com)


cheers


On Tue, Jan 20, 2015 at 2:38 AM, ce <zadig_1 at excite.com> wrote:

Dear all,

I just upgraded TWS to Build 948.3c, Jan 5, 2015 5:12:23 PM
My program that worked fine before started to return wrong clientid . I set client ID to 96. but after sending the order, In order status , or order execution events I get clientid 6? !!? Even I tried to set Master API Client ID to 96 in TWS -> Configuration -> API.? didnt work.
If I set Clientid to 6,? TWS returns 0 as Clientid.

Here is some piece of code :

> ibClientId <- 96
>
>
> #global: create the connection to IB? (this can probably not be stored anywhere, so
> #we have to recreate it within "IBexecuteStrategy.r"
> ibConnection<-NULL
> if (!is.twsConnection(ibConnection)) {
+? ? ibConnection<- twsConnect(clientId=ibClientId, host="localhost",
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?port=7496, verbose=TRUE,
+? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?timeout=15, filename=NULL)
+ }
> print(ibConnection)
<twsConnection,96 @ 20150119 20:25:19 EST, nextId=4>

TWS OpenOrder: orderId=3 clientId=6 conId=12087807 symbol=EUR status=Submitted

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should g


From peter at returnandrisk.com  Mon Apr  6 07:28:21 2015
From: peter at returnandrisk.com (Peter Chan)
Date: Mon, 06 Apr 2015 05:28:21 +0000
Subject: [R-SIG-Finance] Questions regarding Cashflows in Blotter and
 hacking Quantstrat
In-Reply-To: <CA+fgw8SHbkYL12xrWLbnS1FK=NcMwa_8iKDq2rfkirodNz_B2w@mail.gmail.com>
References: <CA+fgw8Tz6YerNSaKH6NF4oL7CxsA_cdd4trQSKicn25xNnDVpQ@mail.gmail.com>
	<CA+oJuEFTLB-qC3hXGErKGOVa40kd_dfrsjRYj0GobnsHeWv=uw@mail.gmail.com>
	<CA+fgw8QFdLwVE7sGKGMgBUMUNS2qXAAUjEO0u1OrHL6HeepueA@mail.gmail.com>
	<CA+oJuEHYRqs-DRc4v4vznVmrEacME5=QBfx4-iBS+W7d3r-EYA@mail.gmail.com>
	<CA+fgw8SHbkYL12xrWLbnS1FK=NcMwa_8iKDq2rfkirodNz_B2w@mail.gmail.com>
Message-ID: <14c8cedefb9.dd2939f2339662.5754810728863159499@returnandrisk.com>

Hi Ueli

One thing to bear in mind if you use the Return.portfolio function in PerfomanceAnalytics is that it doesn't take transaction costs into account.
In the help page you will see "That effectively provides a zero-transaction cost change to the position values as of that date to reflect the rebalance."


Transaction costs can have a material impact on your investment strategy's performance depending upon how frequently you rebalance and the magnitude of the weight changes. 


So be aware that your results using Return.portfolio will be biased upward. 


Thanks


Peter







---- On Thu, 02 Apr 2015 02:50:55 +0000 Ueli Hofstetter &lt;uelihofstetter at gmail.com&gt; wrote ---- 

Thanks for the reply. Regarding the reason for using quantstrat: No, there 
is no particular reason but that it seems to provide quite a lot of 
functionality out of the box .... but unfortunately, as you pointed out, it 
is not the functionality I actually need ;-). In this case, I guess I will 
use blotter and performanceanalytics directly. 
 
thanks a lot for the advise. 
 
2015-04-02 4:17 GMT+02:00 Ilya Kipnis &lt;ilya.kipnis at gmail.com&gt;: 
 
&gt; Well, I'm not sure quantstrat is the tool for that, then. Quantstrat is a 
&gt; signal-based backtesting system. If you want to rebalance a portfolio based 
&gt; on a signal, you may want to do that in PerformanceAnalytics with 
&gt; Return.Portfolio functionality. Is there a particular reason you want to 
&gt; use quantstrat? 
&gt; 
&gt; On Wed, Apr 1, 2015 at 10:04 PM, Ueli Hofstetter &lt;uelihofstetter at gmail.com 
&gt; &gt; wrote: 
&gt; 
&gt;&gt; Hi Ilya, thanks for the reply. 
&gt;&gt; 
&gt;&gt; Yes I guess this would eliminate the need to add a dummy instrument for 
&gt;&gt; the non-instrument based timeseries. But than the problem is that the 
&gt;&gt; signal gets triggered for all securities in the universe, but actually I 
&gt;&gt; need only one signal to trigger the rebalancing (again, the signal could 
&gt;&gt; be something like the current lunar phase, i.e. not related to any 
&gt;&gt; securities in the portfolio/universe)..... or did I miss your argument? 
&gt;&gt; 
&gt;&gt; 2015-04-02 3:50 GMT+02:00 Ilya Kipnis &lt;ilya.kipnis at gmail.com&gt;: 
&gt;&gt; 
&gt;&gt;&gt; Ueli, 
&gt;&gt;&gt; 
&gt;&gt;&gt; Why don't you just append the indicator to the instruments before you 
&gt;&gt;&gt; create the strategy? That is, you know how an instrument is usually defined 
&gt;&gt;&gt; by OHLCV? Why not add another column called MyIndicator to your instruments 
&gt;&gt;&gt; outside the strategy definition? The strategy will pick up the column in 
&gt;&gt;&gt; the signals phase. 
&gt;&gt;&gt; 
&gt;&gt;&gt; -Ilya 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Wed, Apr 1, 2015 at 9:41 PM, Ueli Hofstetter &lt; 
&gt;&gt;&gt; uelihofstetter at gmail.com&gt; wrote: 
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I have posted two questions regarding Blotter and Quantstrat on 
&gt;&gt;&gt;&gt; Stackoverflow and appreciate any hints and suggestions: 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Nr 1: ---------------------------------------------- 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; How to implement rule based rebalancing strategy using 
&gt;&gt;&gt;&gt; QUANTSTRAT/BLOTTER 
&gt;&gt;&gt;&gt; &lt; 
&gt;&gt;&gt;&gt; http://stackoverflow.com/questions/29403601/how-to-implement-rule-based-rebalancing-strategy-using-quantstrat-blotter 
&gt;&gt;&gt;&gt; &gt; 
&gt;&gt;&gt;&gt; : 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I am trying to implement a rulebased rebalancing strategy within the 
&gt;&gt;&gt;&gt; QUANTSTRAT framework. Let's assume I want to base my rebalancing time 
&gt;&gt;&gt;&gt; for a 
&gt;&gt;&gt;&gt; portfolio of instruments on some indicator which is not calculated from 
&gt;&gt;&gt;&gt; a 
&gt;&gt;&gt;&gt; traded instrument but from some other time series (for instance GDP 
&gt;&gt;&gt;&gt; figures) and whenever the signal based on that indicator is triggered 
&gt;&gt;&gt;&gt; (let's say GDP drops by x% within some period z) I d'like rebalance my 
&gt;&gt;&gt;&gt; portfolio according to some rebalancing algorithm (e.g. Markowitz). 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; My idea was to 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; - create a dummy instrument for the non-instrument based timeseries 
&gt;&gt;&gt;&gt; so 
&gt;&gt;&gt;&gt; that I can define and indicator and rule based on it and 
&gt;&gt;&gt;&gt; - to write my own 'ruleSignal' implementation in order to do the 
&gt;&gt;&gt;&gt; algorithm based rebalancing. 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; So my question is: Is this a reasonable approach (is it even possible)? 
&gt;&gt;&gt;&gt; Or 
&gt;&gt;&gt;&gt; would it be better to use BLOTTER directly (and thus not to rely on the 
&gt;&gt;&gt;&gt; QUANTSTRAT abstraction)? 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Nr 2: ---------------------------------------------- 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow 
&gt;&gt;&gt;&gt; How do blotter/quantstrat/quantmod/performanceanalytics handle internal 
&gt;&gt;&gt;&gt; cashflows 
&gt;&gt;&gt;&gt; &lt; 
&gt;&gt;&gt;&gt; http://stackoverflow.com/questions/29403028/how-do-blotter-quantstrat-quantmod-performanceanalytics-handle-internal-cashflow 
&gt;&gt;&gt;&gt; &gt; 
&gt;&gt;&gt;&gt; ? 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I don't understand how internal cashflows are handled in 
&gt;&gt;&gt;&gt; blotter/quantstrat/quantmod/performanceanalytics. This mainly concerns 
&gt;&gt;&gt;&gt; two 
&gt;&gt;&gt;&gt; aspects: Regular cashflows like dividends, coupons etc. as well as 
&gt;&gt;&gt;&gt; cashflows from expiring instruments (e.g. a cash settled in the money 
&gt;&gt;&gt;&gt; option). For equities this seems not too much of an issue as one can 
&gt;&gt;&gt;&gt; always 
&gt;&gt;&gt;&gt; use dividend adjusted prices and it is relatively rare that stocks get 
&gt;&gt;&gt;&gt; delisted. For coupon bonds or options however, I don't get how this is 
&gt;&gt;&gt;&gt; handled. 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; So my questions are: 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; - Is there a generic mechanism to handle internal cashflows 
&gt;&gt;&gt;&gt; (dividends, 
&gt;&gt;&gt;&gt; coupons, repayments etc.) in these packages? 
&gt;&gt;&gt;&gt; - If so, is there some documentation for this and where can I find 
&gt;&gt;&gt;&gt; the 
&gt;&gt;&gt;&gt; relevant implementation in the source code (i.e. pointers to 
&gt;&gt;&gt;&gt; specific R 
&gt;&gt;&gt;&gt; files and/or functions would be great)? 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Cheers 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; -- 
&gt;&gt;&gt;&gt; Ueli Hofstetter 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; [[alternative HTML version deleted]] 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; _______________________________________________ 
&gt;&gt;&gt;&gt; R-SIG-Finance at r-project.org mailing list 
&gt;&gt;&gt;&gt; https://stat.ethz.ch/mailman/listinfo/r-sig-finance 
&gt;&gt;&gt;&gt; -- Subscriber-posting only. If you want to post, subscribe first. 
&gt;&gt;&gt;&gt; -- Also note that this is not the r-help list where general R questions 
&gt;&gt;&gt;&gt; should go. 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -- 
&gt;&gt; Ueli Hofstetter 
&gt;&gt; 
&gt; 
&gt; 
 
 
-- 
Ueli Hofstetter 
 
    [[alternative HTML version deleted]] 
 
_______________________________________________ 
R-SIG-Finance at r-project.org mailing list 
https://stat.ethz.ch/mailman/listinfo/r-sig-finance 
-- Subscriber-posting only. If you want to post, subscribe first. 
-- Also note that this is not the r-help list where general R questions should go. 






	[[alternative HTML version deleted]]


From samuelcoltwilson at gmail.com  Mon Apr  6 18:59:28 2015
From: samuelcoltwilson at gmail.com (Samuel Wilson)
Date: Mon, 6 Apr 2015 09:59:28 -0700
Subject: [R-SIG-Finance] I know I should be able to figure this out...
Message-ID: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>

As an experienced R Programmer, I should be able to figure this out, but
I'm stuck.  I'm sure the answer is obvious, but for some reason I just
can't get my brain to wrap around the answer.

I'm trying to create a script that takes a list of equity tickers (60-80
tickers each day), and downloads their prices and puts them into
data.frames.  I usually use the getSymbols command, but here is the issue.
The I somehow need to be able to put the output of getSymbols to generic
variables.  For example, "stock[1]", "stock[2]", etc.  This way I can use a
generic loop to transform the data and output it to the next step.

When I traditionally use the getSymbols command, the return is the equity
ticker with the OLHC prices.  However, I want to build a generic engine
using for.next loops, because the list of tickers will change each day.

Is the issue I can't use getSymbols?  or is the issue that somehow I need
to use the upfront ticker list as a variable list and make it work, but
there is a class of variable I don't understand.  Because if I use a
variable call generically list[1], it does not return the stock prices.

tickers<-c("GLD","DBC", "EEM", "EFV",
"EFG","BND","TLT","SHY","IWF","IWD","IWC","IWO","IWN","VNQ")
getSymbols(tickers, from="2013-01-01")


For example, if I just do a tickers[1] in the console, I get "GLD" not the
OLHC prices for GLD.  How do I get tickers[1] as a variable I can use to
pull the prices out of?  Because tickers[1] will change everyday (this is
just a made up example).

As I said, I'm sure some is going to look at this and say, Really?  but for
some reason I just can't get my brain wrapped around it.

Sam

	[[alternative HTML version deleted]]


From michael.weylandt at gmail.com  Mon Apr  6 19:07:58 2015
From: michael.weylandt at gmail.com (Michael Weylandt)
Date: Mon, 6 Apr 2015 13:07:58 -0400
Subject: [R-SIG-Finance] I know I should be able to figure this out...
In-Reply-To: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>
References: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>
Message-ID: <C3676AF7-544C-45C1-996B-4CD44A1C7567@gmail.com>

I think you're overthinking. Look at the auto.assign arg to getSymbols. 

for(x in tickers){
   data <- getSymbols(x, auto.assign=FALSE)
   # Process `data` ...
}

Michael


> On Apr 6, 2015, at 12:59 PM, Samuel Wilson <samuelcoltwilson at gmail.com> wrote:
> 
> As an experienced R Programmer, I should be able to figure this out, but
> I'm stuck.  I'm sure the answer is obvious, but for some reason I just
> can't get my brain to wrap around the answer.
> 
> I'm trying to create a script that takes a list of equity tickers (60-80
> tickers each day), and downloads their prices and puts them into
> data.frames.  I usually use the getSymbols command, but here is the issue.
> The I somehow need to be able to put the output of getSymbols to generic
> variables.  For example, "stock[1]", "stock[2]", etc.  This way I can use a
> generic loop to transform the data and output it to the next step.
> 
> When I traditionally use the getSymbols command, the return is the equity
> ticker with the OLHC prices.  However, I want to build a generic engine
> using for.next loops, because the list of tickers will change each day.
> 
> Is the issue I can't use getSymbols?  or is the issue that somehow I need
> to use the upfront ticker list as a variable list and make it work, but
> there is a class of variable I don't understand.  Because if I use a
> variable call generically list[1], it does not return the stock prices.
> 
> tickers<-c("GLD","DBC", "EEM", "EFV",
> "EFG","BND","TLT","SHY","IWF","IWD","IWC","IWO","IWN","VNQ")
> getSymbols(tickers, from="2013-01-01")
> 
> 
> For example, if I just do a tickers[1] in the console, I get "GLD" not the
> OLHC prices for GLD.  How do I get tickers[1] as a variable I can use to
> pull the prices out of?  Because tickers[1] will change everyday (this is
> just a made up example).
> 
> As I said, I'm sure some is going to look at this and say, Really?  but for
> some reason I just can't get my brain wrapped around it.
> 
> Sam
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From samuelcoltwilson at gmail.com  Mon Apr  6 19:11:51 2015
From: samuelcoltwilson at gmail.com (Samuel Wilson)
Date: Mon, 06 Apr 2015 10:11:51 -0700 (PDT)
Subject: [R-SIG-Finance] I know I should be able to figure this out...
In-Reply-To: <C3676AF7-544C-45C1-996B-4CD44A1C7567@gmail.com>
References: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>
	<C3676AF7-544C-45C1-996B-4CD44A1C7567@gmail.com>
Message-ID: <17422F0F-666A-4400-BD6E-D96B0FCB44DC@gmail.com>

  DUH!!!


THANK YOU!


Sent with Unibox



> On Apr 6, 2015, at 10:07 AM, Michael Weylandt <michael.weylandt at gmail.com> wrote:
> 
> 
> I think you're overthinking. Look at the auto.assign arg to getSymbols.?
> 
> 
> for(x in tickers){
> data <- getSymbols(x, auto.assign=FALSE)
> # Process `data` ...
> }
> 
> 
> Michael
> 
> 
> 
> 
> 
>> On Apr 6, 2015, at 12:59 PM, Samuel Wilson <samuelcoltwilson at gmail.com> wrote:
>> 
>> 
>> As an experienced R Programmer, I should be able to figure this out, but
>> I'm stuck. I'm sure the answer is obvious, but for some reason I just
>> can't get my brain to wrap around the answer.
>> 
>> 
>> I'm trying to create a script that takes a list of equity tickers (60-80
>> tickers each day), and downloads their prices and puts them into
>> data.frames. I usually use the getSymbols command, but here is the issue.
>> The I somehow need to be able to put the output of getSymbols to generic
>> variables. For example, "stock[1]", "stock[2]", etc. This way I can use a
>> generic loop to transform the data and output it to the next step.
>> 
>> 
>> When I traditionally use the getSymbols command, the return is the equity
>> ticker with the OLHC prices. However, I want to build a generic engine
>> using for.next loops, because the list of tickers will change each day.
>> 
>> 
>> Is the issue I can't use getSymbols? or is the issue that somehow I need
>> to use the upfront ticker list as a variable list and make it work, but
>> there is a class of variable I don't understand. Because if I use a
>> variable call generically list[1], it does not return the stock prices.
>> 
>> 
>> tickers<-c("GLD","DBC", "EEM", "EFV",
>> "EFG","BND","TLT","SHY","IWF","IWD","IWC","IWO","IWN","VNQ")
>> getSymbols(tickers, from="2013-01-01")
>> 
>> 
>> 
>> 
>> 
>> For example, if I just do a tickers[1] in the console, I get "GLD" not the
>> OLHC prices for GLD. How do I get tickers[1] as a variable I can use to
>> pull the prices out of? Because tickers[1] will change everyday (this is
>> just a made up example).
>> 
>> 
>> As I said, I'm sure some is going to look at this and say, Really? but for
>> some reason I just can't get my brain wrapped around it.
>> 
>> 
>> Sam
>> 
>> 
>> [[alternative HTML version deleted]]
>> 
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>> 
>> 

	[[alternative HTML version deleted]]


From 1111938 at qq.com  Thu Apr  9 05:17:09 2015
From: 1111938 at qq.com (domodo)
Date: Wed, 8 Apr 2015 20:17:09 -0700 (PDT)
Subject: [R-SIG-Finance] Specify time segment to calculate indicator and
	trade ?
Message-ID: <1428549429045-4705639.post@n4.nabble.com>

hi,guys.
quantstrat is very powerful and convient when coding strategy and backtest
it with indicator and pre-define price pattern.but i'm not familiar with
specify the strategy to trade in a segment of trading-time,below are two
cases:
1)establish position from 10:00 to 14:00 only,and close position with
technical exits
2)get the highest and lowest price of the first hour of a day

for example,the strategy below is about price and single sma cross over.
for case 1,i should store price series' date&time in varible 'datetime' as:
[code]
datetime <- as.POSIXlt(index(C))
[/code]

set entry time segment as:
[code]
entrytime1 <- 10
entrytime2 <- 14
[/code]

and add some code below to judge whether the entry signal is in trading time
:
[code] 
signal <- ifelse(lag(C)>lag(MA) & lag(C,2)<lag(MA,2),1,
                 ifelse(lag(C)&lt;lag(MA) &amp; lag(C,2)>lag(MA,2),-1,0))

signal <- ifelse(signal>0 & datetime$hour>entrytime1 &
datetime$hour<entrytime2,1,0)
signal &lt;- ifelse(signal&lt;0 &amp; datetime$hour>entrytime1 &
datetime$hour<entrytime2,-1,0)
[/code]

but the code above is not so elegant at all,and low-efficient.

for the case 2,i should code a function to calculate the first hour's
highest &amp; lowest price of each day,my idea in this function is similiar
to code for case 1,that's, store price series's date&amp;time as a POSIXlt
variable 'datetime',and judge whether hour == 10,min == 15,sec==0,but this
idea is also rough and low-efficient.

any help or tips please ?

below is the example strategy

[code] 
library(blotter)
library(quantstrat)

#initialize environtments
currency(&quot;USD&quot;)
startdate &lt;- '2012-01-18 09:14:00'
finaldate &lt;- '2012-01-19 15:14:00'

future(&quot;if2&quot;, currency = &quot;USD&quot;, multiplier = 300,
tick_size = 0.2)
Sys.setenv(TZ = &quot;UTC&quot;) 
rm(list=ls(envir=.blotter),envir=.blotter)
b.strategy &lt;- &quot;strategy&quot;

try(rm(list=ls(pos=.blotter),pos=.blotter),silent=TRUE)
initPortf(b.strategy, &quot;if2&quot;, initDate = startdate)
initAcct(b.strategy, portfolios = b.strategy, initDate = startdate, initEq =
1000000) 

ifBAC2 &lt;- read.table(&quot;C:/ifBAC2.csv&quot;, head = F, sep =
&quot;,&quot;)
coredata &lt;- ifBAC2[3:6]
rownames(coredata) &lt;- as.POSIXlt(paste(ifBAC2[,1],ifBAC2[,2]))
ifxts &lt;- as.xts(coredata)
colnames(ifxts) &lt;-
c(&quot;open&quot;,&quot;high&quot;,&quot;low&quot;,&quot;close&quot;)
if2 &lt;- ifxts['2012-01-18 09:15:00/2012-01-19 15:14:00']
if2$SMA15 &lt;- SMA(Cl(if2),15)

#custom theme
myTheme &lt;- chart_theme()
myTheme$col$dn.col &lt;- &quot;lightgreen&quot;
myTheme$col$up.col &lt;- &quot;red&quot;
myTheme$col$dn.border &lt;- &quot;grey&quot;
myTheme$col$up.border &lt;- &quot;grey&quot;

MA &lt;- if2$SMA15
C &lt;- Cl(if2)
O &lt;- Op(if2)

#trading signal judgement
signal &lt;- ifelse(lag(C)>lag(MA) & lag(C,2)<lag(MA,2),1,
                 ifelse(lag(C)&lt;lag(MA) &amp; lag(C,2)>lag(MA,2),-1,0))
signal[is.na(signal)] <- 0

#Bar-by-bar treatment
for( i in 1:nrow(if2) )
{
  currentDate <- time(if2)[i]
  
  equity<-getEndEq(b.strategy, currentDate)
  Posn <- getPosQty(b.strategy, Symbol='if2', Date=currentDate)
  #cat(as.character(i),"position on current bar is ",Posn, append = FALSE)
  
  if(!is.na(MA[i])) 
  {
    if( Posn == 0 & signal[i] == 1 ) { #no marketposition, and long signal
occurs 
      #long entry        
      openprice <- as.double((Op(if2[currentDate])))
      unitsize <- abs(as.numeric(trunc(equity/(openprice*300*0.15))))
      addTxn(b.strategy, Symbol='if2', TxnDate=currentDate,
             TxnPrice=openprice, TxnQty = unitsize ,
TxnFees=-openprice*300*0.00005*unitsize, verbose = F) 
    } 
    else if( Posn != 0 & signal[i] == -1 ) {
      #exit position
      openprice <- as.double((Op(if2[currentDate])))
      unitsize  <- abs(getPosQty(b.strategy, Symbol='if2',
Date=currentDate))        
      addTxn(b.strategy, Symbol='if2', TxnDate=currentDate,
             TxnPrice=openprice, TxnQty = -unitsize ,
TxnFees=-openprice*300*0.00005*unitsize, verbose = F) 
    }
  }
  
  updatePortf(b.strategy, Dates = currentDate)
  updateAcct(b.strategy, Dates = currentDate)
  updateEndEq(b.strategy, Dates = currentDate)
}

chart.Posn(b.strategy, Symbol = "if2", theme = myTheme, TA =
"add_SMA(n=15,col=4)")

txns <- getTxns(Portfolio = b.strategy, Symbol = "if2")
tstats <- tradeStats(Portfolio = b.strategy, Symbol = "if2")
[/code]

data format is as below

[code]

2012/1/18	9:15:00	2577.6	2580.6	2573.6	2577.2
2012/1/18	9:16:00	2577.2	2583.6	2577	2583.2
2012/1/18	9:17:00	2583.4	2583.8	2580.6	2580.8
2012/1/18	9:18:00	2580.8	2581.4	2576.4	2577
2012/1/18	9:19:00	2577	2582	2576.6	2580.4
2012/1/18	9:20:00	2580.4	2581.4	2578.2	2581
2012/1/18	9:21:00	2580.8	2580.8	2578.8	2580
2012/1/18	9:22:00	2580.2	2581	2579.4	2579.8
2012/1/18	9:23:00	2580	2584.4	2579.8	2583.6
2012/1/18	9:24:00	2583.8	2585.2	2576	2576.2
2012/1/18	9:25:00	2577	2579.8	2576.8	2579
2012/1/18	9:26:00	2578.8	2584.2	2578.8	2581.2
2012/1/18	9:27:00	2581	2582.2	2580.6	2581.6
2012/1/18	9:28:00	2581.6	2581.6	2578.8	2579.4
2012/1/18	9:29:00	2580	2583	2579.8	2581.4

[/code]



--
View this message in context: http://r.789695.n4.nabble.com/Specify-time-segment-to-calculate-indicator-and-trade-tp4705639.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From peter at returnandrisk.com  Thu Apr  9 09:12:40 2015
From: peter at returnandrisk.com (Peter Chan)
Date: Thu, 09 Apr 2015 07:12:40 +0000
Subject: [R-SIG-Finance]
 =?utf-8?q?Specify_time_segment_to_calculate_indic?=
 =?utf-8?b?YXRvciBhbmTCoMKgwqDCoHRyYWRlID8=?=
In-Reply-To: <1428549429045-4705639.post@n4.nabble.com>
References: <1428549429045-4705639.post@n4.nabble.com>
Message-ID: <14c9d0609e1.10d4cae5d201678.209875277352161150@returnandrisk.com>

Hi there

There's a few ways to do this but the way that works for me (eg easy to debug) is to pre-process the data before letting quantstrat work its magic.

- create a custom indicator function that returns an xts object with same index as your price data
- add all your own indicators in columns eg if time between 10:00 and 14:00 --> Col1 = 1 otherwise 0
- once everything is correct and debugged you can use "add.indicator" to hook it up to quantstrat etc

I used this procedure in my blog on the FOMC cycle trading strategy.

If you have a lot of conditions, in the last column of your custom indicator you could multiply the appropriate binary (1, 0) cols together to get a "composite indicator" of when all indicators are true.
Then use that last column as your reference column in "add.signal" eg if ColComposite = 1, long entry

Thanks

Peter



---- On Thu, 09 Apr 2015 03:17:09 +0000 domodo<1111938 at qq.com> wrote ---- 
 > hi,guys. 
 > quantstrat is very powerful and convient when coding strategy and backtest 
 > it with indicator and pre-define price pattern.but i'm not familiar with 
 > specify the strategy to trade in a segment of trading-time,below are two 
 > cases: 
 > 1)establish position from 10:00 to 14:00 only,and close position with 
 > technical exits 
 > 2)get the highest and lowest price of the first hour of a day 
 >  
 > for example,the strategy below is about price and single sma cross over. 
 > for case 1,i should store price series' date&time in varible 'datetime' as: 
 > [code] 
 > datetime <- as.POSIXlt(index(C)) 
 > [/code] 
 >  
 > set entry time segment as: 
 > [code] 
 > entrytime1 <- 10 
 > entrytime2 <- 14 
 > [/code] 
 >  
 > and add some code below to judge whether the entry signal is in trading time 
 > : 
 > [code]  
 > signal <- ifelse(lag(C)>lag(MA) & lag(C,2)<lag(MA,2),1, 
 >                  ifelse(lag(C)&lt;lag(MA) &amp; lag(C,2)>lag(MA,2),-1,0)) 
 >  
 > signal <- ifelse(signal>0 & datetime$hour>entrytime1 & 
 > datetime$hour<entrytime2,1,0) 
 > signal &lt;- ifelse(signal&lt;0 &amp; datetime$hour>entrytime1 & 
 > datetime$hour<entrytime2,-1,0) 
 > [/code] 
 >  
 > but the code above is not so elegant at all,and low-efficient. 
 >  
 > for the case 2,i should code a function to calculate the first hour's 
 > highest &amp; lowest price of each day,my idea in this function is similiar 
 > to code for case 1,that's, store price series's date&amp;time as a POSIXlt 
 > variable 'datetime',and judge whether hour == 10,min == 15,sec==0,but this 
 > idea is also rough and low-efficient. 
 >  
 > any help or tips please ? 
 >  
 > below is the example strategy 
 >  
 > [code]  
 > library(blotter) 
 > library(quantstrat) 
 >  
 > #initialize environtments 
 > currency(&quot;USD&quot;) 
 > startdate &lt;- '2012-01-18 09:14:00' 
 > finaldate &lt;- '2012-01-19 15:14:00' 
 >  
 > future(&quot;if2&quot;, currency = &quot;USD&quot;, multiplier = 300, 
 > tick_size = 0.2) 
 > Sys.setenv(TZ = &quot;UTC&quot;)  
 > rm(list=ls(envir=.blotter),envir=.blotter) 
 > b.strategy &lt;- &quot;strategy&quot; 
 >  
 > try(rm(list=ls(pos=.blotter),pos=.blotter),silent=TRUE) 
 > initPortf(b.strategy, &quot;if2&quot;, initDate = startdate) 
 > initAcct(b.strategy, portfolios = b.strategy, initDate = startdate, initEq = 
 > 1000000)  
 >  
 > ifBAC2 &lt;- read.table(&quot;C:/ifBAC2.csv&quot;, head = F, sep = 
 > &quot;,&quot;) 
 > coredata &lt;- ifBAC2[3:6] 
 > rownames(coredata) &lt;- as.POSIXlt(paste(ifBAC2[,1],ifBAC2[,2])) 
 > ifxts &lt;- as.xts(coredata) 
 > colnames(ifxts) &lt;- 
 > c(&quot;open&quot;,&quot;high&quot;,&quot;low&quot;,&quot;close&quot;) 
 > if2 &lt;- ifxts['2012-01-18 09:15:00/2012-01-19 15:14:00'] 
 > if2$SMA15 &lt;- SMA(Cl(if2),15) 
 >  
 > #custom theme 
 > myTheme &lt;- chart_theme() 
 > myTheme$col$dn.col &lt;- &quot;lightgreen&quot; 
 > myTheme$col$up.col &lt;- &quot;red&quot; 
 > myTheme$col$dn.border &lt;- &quot;grey&quot; 
 > myTheme$col$up.border &lt;- &quot;grey&quot; 
 >  
 > MA &lt;- if2$SMA15 
 > C &lt;- Cl(if2) 
 > O &lt;- Op(if2) 
 >  
 > #trading signal judgement 
 > signal &lt;- ifelse(lag(C)>lag(MA) & lag(C,2)<lag(MA,2),1, 
 >                  ifelse(lag(C)&lt;lag(MA) &amp; lag(C,2)>lag(MA,2),-1,0)) 
 > signal[is.na(signal)] <- 0 
 >  
 > #Bar-by-bar treatment 
 > for( i in 1:nrow(if2) ) 
 > { 
 >   currentDate <- time(if2)[i] 
 >    
 >   equity<-getEndEq(b.strategy, currentDate) 
 >   Posn <- getPosQty(b.strategy, Symbol='if2', Date=currentDate) 
 >   #cat(as.character(i),"position on current bar is ",Posn, append = FALSE) 
 >    
 >   if(!is.na(MA[i]))  
 >   { 
 >     if( Posn == 0 & signal[i] == 1 ) { #no marketposition, and long signal 
 > occurs  
 >       #long entry         
 >       openprice <- as.double((Op(if2[currentDate]))) 
 >       unitsize <- abs(as.numeric(trunc(equity/(openprice*300*0.15)))) 
 >       addTxn(b.strategy, Symbol='if2', TxnDate=currentDate, 
 >              TxnPrice=openprice, TxnQty = unitsize , 
 > TxnFees=-openprice*300*0.00005*unitsize, verbose = F)  
 >     }  
 >     else if( Posn != 0 & signal[i] == -1 ) { 
 >       #exit position 
 >       openprice <- as.double((Op(if2[currentDate]))) 
 >       unitsize  <- abs(getPosQty(b.strategy, Symbol='if2', 
 > Date=currentDate))         
 >       addTxn(b.strategy, Symbol='if2', TxnDate=currentDate, 
 >              TxnPrice=openprice, TxnQty = -unitsize , 
 > TxnFees=-openprice*300*0.00005*unitsize, verbose = F)  
 >     } 
 >   } 
 >    
 >   updatePortf(b.strategy, Dates = currentDate) 
 >   updateAcct(b.strategy, Dates = currentDate) 
 >   updateEndEq(b.strategy, Dates = currentDate) 
 > } 
 >  
 > chart.Posn(b.strategy, Symbol = "if2", theme = myTheme, TA = 
 > "add_SMA(n=15,col=4)") 
 >  
 > txns <- getTxns(Portfolio = b.strategy, Symbol = "if2") 
 > tstats <- tradeStats(Portfolio = b.strategy, Symbol = "if2") 
 > [/code] 
 >  
 > data format is as below 
 >  
 > [code] 
 >  
 > 2012/1/18    9:15:00    2577.6    2580.6    2573.6    2577.2 
 > 2012/1/18    9:16:00    2577.2    2583.6    2577    2583.2 
 > 2012/1/18    9:17:00    2583.4    2583.8    2580.6    2580.8 
 > 2012/1/18    9:18:00    2580.8    2581.4    2576.4    2577 
 > 2012/1/18    9:19:00    2577    2582    2576.6    2580.4 
 > 2012/1/18    9:20:00    2580.4    2581.4    2578.2    2581 
 > 2012/1/18    9:21:00    2580.8    2580.8    2578.8    2580 
 > 2012/1/18    9:22:00    2580.2    2581    2579.4    2579.8 
 > 2012/1/18    9:23:00    2580    2584.4    2579.8    2583.6 
 > 2012/1/18    9:24:00    2583.8    2585.2    2576    2576.2 
 > 2012/1/18    9:25:00    2577    2579.8    2576.8    2579 
 > 2012/1/18    9:26:00    2578.8    2584.2    2578.8    2581.2 
 > 2012/1/18    9:27:00    2581    2582.2    2580.6    2581.6 
 > 2012/1/18    9:28:00    2581.6    2581.6    2578.8    2579.4 
 > 2012/1/18    9:29:00    2580    2583    2579.8    2581.4 
 >  
 > [/code] 
 >  
 >  
 >  
 > -- 
 > View this message in context: http://r.789695.n4.nabble.com/Specify-time-segment-to-calculate-indicator-and-trade-tp4705639.html 
 > Sent from the Rmetrics mailing list archive at Nabble.com. 
 >  
 > _______________________________________________ 
 > R-SIG-Finance at r-project.org mailing list 
 > https://stat.ethz.ch/mailman/listinfo/r-sig-finance 
 > -- Subscriber-posting only. If you want to post, subscribe first. 
 > -- Also note that this is not the r-help list where general R questions should go. 
 >


From davidshanabrook at icloud.com  Thu Apr  9 16:44:26 2015
From: davidshanabrook at icloud.com (david hilton shanabrook)
Date: Thu, 09 Apr 2015 10:44:26 -0400
Subject: [R-SIG-Finance] quantmod, getOptionChain update time/date
Message-ID: <0937B067-67F5-421A-95EF-E03A67E1C254@icloud.com>

Short explanation:
How can I tell when  getOptionChain was updated?

library(quantmod)
chain <- getOptionChain("AAPL?)

More detailed and wordy:

This code will return the option chain for Apple with the open interest.  open interest is updated on finance.yahoo sometimes after market close, but it can be as late as the next day??  
I want to be able to determine the data/time of when it was updated.  This is important because otherwise I have no idea if I am working with the previous day close or two days previous.

My solution was to sum all of the open interest, write this to a file.  Next time I run the code read that file and compare to the current sum to see if it has changed.  Messy, and unclear if it is working.  Also I use ?AAPL" to check and assume this applies to all data from getOptionChain


wasUpdatedToday <- function() {
	storedDay <- read.csv("storedDay.txt")
	txt <- paste("Open interest updated:", storedDay$x)
	chain <- getOptionChain("AAPL")
	currentOI <- sum(chain$puts$OI,chain$calls$OI)
	storedOI <- read.csv("storedOI.txt")
		if (currentOI != storedOI$x){
			write.csv(currentOI, "storedOI.txt")
			write.csv(format.Date(Sys.time(),"%b %d"),"storedDay.txt")
			txt <- paste("Open interest from", storedDay$x,"updated today")
		}
	return(txt)
	}


From james at jtoll.com  Thu Apr  9 22:52:31 2015
From: james at jtoll.com (James Toll)
Date: Thu, 9 Apr 2015 15:52:31 -0500
Subject: [R-SIG-Finance] quantmod, getOptionChain update time/date
In-Reply-To: <0937B067-67F5-421A-95EF-E03A67E1C254@icloud.com>
References: <0937B067-67F5-421A-95EF-E03A67E1C254@icloud.com>
Message-ID: <AF110480-B509-43FF-971A-D261D4772BA7@jtoll.com>


> On Apr 9, 2015, at 9:44 AM, david hilton shanabrook <davidshanabrook at icloud.com> wrote:
> 
> Short explanation:
> How can I tell when  getOptionChain was updated?

If you look at the code for getOptionChain (https://github.com/joshuaulrich/quantmod/blob/develop/R/getOptionChain.R) you will see that the data is retrieved from Yahoo?s web page.  In the case of your example that would be:

https://finance.yahoo.com/q/op?s=AAPL

Yahoo does not appear to provide any information on that page as to when the option data was last updated, although there does appear to be information regarding when the stock quote was updated.  If Yahoo doesn?t provide that information, the function obviously can?t as well.

If you?re really in need of higher quality data, you?re likely better off purchasing data.

As a side note, the getSymbols function provides information about when the data was last retrieved from Yahoo.  While a different issue, I wonder if it would be worth incorporating that into the list returned by the getOptionChain function as well.


James 


> 
> library(quantmod)
> chain <- getOptionChain("AAPL?)
> 
> More detailed and wordy:
> 
> This code will return the option chain for Apple with the open interest.  open interest is updated on finance.yahoo sometimes after market close, but it can be as late as the next day??  
> I want to be able to determine the data/time of when it was updated.  This is important because otherwise I have no idea if I am working with the previous day close or two days previous.
> 
> My solution was to sum all of the open interest, write this to a file.  Next time I run the code read that file and compare to the current sum to see if it has changed.  Messy, and unclear if it is working.  Also I use ?AAPL" to check and assume this applies to all data from getOptionChain
> 
> 
> wasUpdatedToday <- function() {
> 	storedDay <- read.csv("storedDay.txt")
> 	txt <- paste("Open interest updated:", storedDay$x)
> 	chain <- getOptionChain("AAPL")
> 	currentOI <- sum(chain$puts$OI,chain$calls$OI)
> 	storedOI <- read.csv("storedOI.txt")
> 		if (currentOI != storedOI$x){
> 			write.csv(currentOI, "storedOI.txt")
> 			write.csv(format.Date(Sys.time(),"%b %d"),"storedDay.txt")
> 			txt <- paste("Open interest from", storedDay$x,"updated today")
> 		}
> 	return(txt)
> 	}
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From james at jtoll.com  Thu Apr  9 23:25:37 2015
From: james at jtoll.com (James Toll)
Date: Thu, 9 Apr 2015 16:25:37 -0500
Subject: [R-SIG-Finance] I know I should be able to figure this out...
In-Reply-To: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>
References: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>
Message-ID: <902B9551-7665-46AB-BC52-EF957BF46233@jtoll.com>


> On Apr 6, 2015, at 11:59 AM, Samuel Wilson <samuelcoltwilson at gmail.com> wrote:
> 
> I'm trying to create a script that takes a list of equity tickers (60-80
> tickers each day), and downloads their prices and puts them into
> data.frames.

I realize your question was answered, but is there a particular reason you want to make this a data.frame?  If I?m not mistaken, the performance should be better if left as xts (i.e. matrix). Might I suggest creating a list of xts?

Given your tickers:

tickers<-c("GLD","DBC", "EEM", "EFV","EFG","BND","TLT","SHY","IWF","IWD","IWC","IWO","IWN","VNQ")

Something like:

library(parallel)
library(quantmod)
library(xts)

getData <- function (symbols, ...) {
  result <- mclapply(symbols, function(x) getSymbols(x, auto.assign = FALSE, ...))
  names(result) <- symbols
  return(result)
}

output <- getData(tickers)
output$GLD["2015-04?]

> However, I want to build a generic engine
> using for.next loops, because the list of tickers will change each day.

Rather than for loops, write functions to do what you need, and then you can take advantage of the parallel apply functions like mclapply.

mclapply(tickers, function(x) last(output[[x]]))

Just a suggestion.


James


From samuelcoltwilson at gmail.com  Fri Apr 10 04:00:02 2015
From: samuelcoltwilson at gmail.com (Samuel Wilson)
Date: Thu, 09 Apr 2015 19:00:02 -0700 (PDT)
Subject: [R-SIG-Finance] I know I should be able to figure this out...
In-Reply-To: <902B9551-7665-46AB-BC52-EF957BF46233@jtoll.com>
References: <CACCk-cHyXw7XzQ_E_D9MQ-v63RpV1yD6J2ZbGN4mgPJi-v+mqw@mail.gmail.com>
	<902B9551-7665-46AB-BC52-EF957BF46233@jtoll.com>
Message-ID: <FB2DAD25-50E6-498E-B0A6-9F9935286D0D@gmail.com>

  Wow, that?s a cool idea, I?ll try it!


I had already written them as function anyway.


Sam






Sent with Unibox



> On Apr 9, 2015, at 2:25 PM, James Toll <james at jtoll.com> wrote:
> 
> 
>> 
>> On Apr 6, 2015, at 11:59 AM, Samuel Wilson <samuelcoltwilson at gmail.com> wrote:
>> 
>> 
>> I'm trying to create a script that takes a list of equity tickers (60-80
>> tickers each day), and downloads their prices and puts them into
>> data.frames.
>> 
>> 
>> 
> 
> 
> I realize your question was answered, but is there a particular reason you want to make this a data.frame? If I?m not mistaken, the performance should be better if left as xts (i.e. matrix). Might I suggest creating a list of xts?
> 
> 
> Given your tickers:
> 
> 
> tickers<-c("GLD","DBC", "EEM", "EFV","EFG","BND","TLT","SHY","IWF","IWD","IWC","IWO","IWN","VNQ")
> 
> 
> Something like:
> 
> 
> library(parallel)
> library(quantmod)
> library(xts)
> 
> 
> getData <- function (symbols, ...) {
> result <- mclapply(symbols, function(x) getSymbols(x, auto.assign = FALSE, ...))
> names(result) <- symbols
> return(result)
> }
> 
> 
> output <- getData(tickers)
> output$GLD["2015-04?]
> 
> 
>> However, I want to build a generic engine
>> using for.next loops, because the list of tickers will change each day.
>> 
>> 
>> 
> 
> 
> Rather than for loops, write functions to do what you need, and then you can take advantage of the parallel apply functions like mclapply.
> 
> 
> mclapply(tickers, function(x) last(output[[x]]))
> 
> 
> Just a suggestion.
> 
> 
> 
> 
> 
> James
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 

	[[alternative HTML version deleted]]


From graham.ewen at bluecrestcapital.com  Fri Apr 10 18:54:46 2015
From: graham.ewen at bluecrestcapital.com (Graham Ewen)
Date: Fri, 10 Apr 2015 16:54:46 +0000
Subject: [R-SIG-Finance] Portfolio Min Variance Optimisation with Turnover
	Constraints
Message-ID: <B592266F4C58194D89CBE49E71512BC013C2F9DE@BRLVSEXMBP02.BlueCrest.local>

Hi,

I am new to using R for optimisation and I am trying to set up a simple portfolio minimum variance optimisation with turnover constraints, but am having some difficulty setting up the problem correctly. I would really appreciate any help. I am trying two approaches one using the Rsolnp library and the other using the the parma library, but am having trouble with both.

Using Rsolnp I am having trouble getting the optimisation to converge, but this may be that the problem is poorly conditioned but please advise if the formulation seems correct.

ineq.fun.turnover <- function (x, sigma, wInit)
{
  return(sum(abs(x - wInit)))
}

obj.fun <- function(x, sigma, wInit)
{
  return(as.numeric(x%*%sigma%*%x))
}

eq.fun <- function(x,sigma,wInit)
{
  return(sum(x))
}

tst <- solnp(initWeights, fun=obj.fun, eqfun=eq.fun, eqB = 1.0, ineqfun = ineq.fun.turnover,
             ineqLB = 0.0, ineqUB = 0.2, LB = rep(0,numberOfSecurities), UB = rep(0.1,numberOfSecurities),
             sigma = covarMatx, wInit = initWeights)


Where initWeights is a vector of length numberOfSecurities, and the covarMatx is a covariance Matrix (generated from a factor model) of dimensions numberOfSecurities by numberOfSecurities.

Using parma, I cannot seem to get parmaspec to recognise the turnover constraint inequality functions (using the custom ones in the library), so I am guessing I am using incompatible parameters.... ?

servars = list()
uservars$turnover <- 0.2
uservars$wold <- initWeights

spec2 <- parmaspec(S = covarMatx,  LB = lowerBounds, UB = upperBounds,
                  risk = "EV", riskType = "minrisk",
                  ineqfun = list(ineqfun.turnover.min), ineqgrad = list(ineqjac.turnover.min), uservars = uservars)


It simply tries to solve the QP min risk problem ignoring the turnover inequality.


Thank you,

Graham.



Graham Ewen
BlueCrest Capital Management (UK) LLP
40 Grosvenor Place, London, SW1X 7AW, United Kingdom
T  +44 20 3180 3530
graham.ewen at bluecrestcapital.com<mailto:graham.ewen at bluecrestcapital.com>
[Description: Description: Description: Description: Description: Description: Description: aaaBlueCrest Capital Management (UK) LLP Logo]


The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.

This communication is for informational purposes only. It is not intended as an offer or solicitation for the purchase or sale of any financial instrument or as an official confirmation of any transaction. Any market prices, data and other information are not warranted as to completeness or accuracy and are subject to change without notice. Any comments or statements made herein do not necessarily reflect those of BlueCrest Capital Management (UK) LLP, its subsidiaries or affiliates.

BlueCrest Capital Management (UK) LLP is authorised and regulated by the Financial Conduct Authority. BlueCrest Capital Management (UK) LLP is registered in England and Wales with registered number OC349662. Registered Office: 40 Grosvenor Place, London SW1X 7AW, United Kingdom.

Please see the important information at www.bluecrestcapital.com/disclaimer.

Tel: +44 (0)20 3180 3000 Fax: +44 (0)20 3180 3001 www.bluecrestcapital.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150410/30a104db/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 6616 bytes
Desc: image001.png
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150410/30a104db/attachment.png>

From alexios at 4dscape.com  Fri Apr 10 20:09:31 2015
From: alexios at 4dscape.com (alexios ghalanos)
Date: Fri, 10 Apr 2015 21:09:31 +0300
Subject: [R-SIG-Finance] Portfolio Min Variance Optimisation with
 Turnover Constraints
In-Reply-To: <B592266F4C58194D89CBE49E71512BC013C2F9DE@BRLVSEXMBP02.BlueCrest.local>
References: <B592266F4C58194D89CBE49E71512BC013C2F9DE@BRLVSEXMBP02.BlueCrest.local>
Message-ID: <552811DB.1010302@4dscape.com>

Hi Graham,

The reason it ignores the turnover constraint is because it is an NLP
constraint (scenario based), _not_ a QP constraint. From the documentation:

"Provides a number of custom constraints and their jacobians for use
with the NLP representation (both minimum risk and the fractional problem)."

As to the lack of convergence of the solnp formulation you describe,
I am guessing that it is because of the bounds placed on the ineqUB
(0.2) for the turnover constraint and the presence of the absolute
function which is not smooth. To solve this as a QP problem, the abs
function would require that you represent it as a second order cone
problem and solve it with an SOCP solver. Alternatively, if you can
write out the gradients of your functions, you _may_ have better luck
with the nloptr solver (see ineqjac.turnover.min for an example).

Regards,

Alexios



On 10/04/2015 19:54, Graham Ewen wrote:
> Hi,
> 
>  
> 
> I am new to using R for optimisation and I am trying to set up a simple
> portfolio minimum variance optimisation with turnover constraints, but
> am having some difficulty setting up the problem correctly. I would
> really appreciate any help. I am trying two approaches one using the
> Rsolnp library and the other using the the parma library, but am having
> trouble with both.
> 
>  
> 
> Using Rsolnp I am having trouble getting the optimisation to converge,
> but this may be that the problem is poorly conditioned but please advise
> if the formulation seems correct.
> 
>  
> 
> ineq.fun.turnover <- function (x, sigma, wInit)
> 
> {
> 
>   return(sum(abs(x - wInit)))
> 
> }
> 
>  
> 
> obj.fun <- function(x, sigma, wInit)
> 
> {
> 
>   return(as.numeric(x%*%sigma%*%x))
> 
> }
> 
>  
> 
> eq.fun <- function(x,sigma,wInit)
> 
> {
> 
>   return(sum(x))
> 
> }
> 
>  
> 
> tst <- solnp(initWeights, fun=obj.fun, eqfun=eq.fun, eqB = 1.0, ineqfun
> = ineq.fun.turnover,
> 
>              ineqLB = 0.0, ineqUB = 0.2, LB = rep(0,numberOfSecurities),
> UB = rep(0.1,numberOfSecurities),
> 
>              sigma = covarMatx, wInit = initWeights)
> 
>  
> 
>  
> 
> Where initWeights is a vector of length numberOfSecurities, and the
> covarMatx is a covariance Matrix (generated from a factor model) of
> dimensions numberOfSecurities by numberOfSecurities.
> 
>  
> 
> Using parma, I cannot seem to get parmaspec to recognise the turnover
> constraint inequality functions (using the custom ones in the library),
> so I am guessing I am using incompatible parameters?. ?
> 
>  
> 
> servars = list()
> 
> uservars$turnover <- 0.2
> 
> uservars$wold <- initWeights
> 
>  
> 
> spec2 <- parmaspec(S = covarMatx,  LB = lowerBounds, UB = upperBounds,
> 
>                   risk = "EV", riskType = "minrisk",
> 
>                   ineqfun = list(ineqfun.turnover.min), ineqgrad =
> list(ineqjac.turnover.min), uservars = uservars)
> 
>  
> 
>  
> 
> It simply tries to solve the QP min risk problem ignoring the turnover
> inequality.
> 
>  
> 
>  
> 
> Thank you,
> 
>  
> 
> Graham.
> 
>  
> 
>  
> 
>  
> 
> *Graham Ewen*
> BlueCrest Capital Management (UK) LLP
> 40 Grosvenor Place, London, SW1X 7AW, United Kingdom
> *T*  +44 20 3180 3530
> graham.ewen at bluecrestcapital.com <mailto:graham.ewen at bluecrestcapital.com> 
> 
> Description: Description: Description: Description: Description:
> Description: Description: aaaBlueCrest Capital Management (UK) LLP Logo 
> 
>  
> 
> 
> The information transmitted is intended only for the person or entity to
> which it is addressed and may contain confidential and/or privileged
> material. Any review, retransmission, dissemination or other use of, or
> taking of any action in reliance upon, this information by persons or
> entities other than the intended recipient is prohibited. If you
> received this in error, please contact the sender and delete the
> material from any computer.
> 
> This communication is for informational purposes only. It is not
> intended as an offer or solicitation for the purchase or sale of any
> financial instrument or as an official confirmation of any transaction.
> Any market prices, data and other information are not warranted as to
> completeness or accuracy and are subject to change without notice. Any
> comments or statements made herein do not necessarily reflect those of
> BlueCrest Capital Management (UK) LLP, its subsidiaries or affiliates.
> 
> BlueCrest Capital Management (UK) LLP is authorised and regulated by the
> Financial Conduct Authority. BlueCrest Capital Management (UK) LLP is
> registered in England and Wales with registered number OC349662.
> Registered Office: 40 Grosvenor Place, London SW1X 7AW, United Kingdom.
> 
> Please see the important information at
> www.bluecrestcapital.com/disclaimer.
> 
> Tel: +44 (0)20 3180 3000 Fax: +44 (0)20 3180 3001 www.bluecrestcapital.com
> 
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From ivan.popivanov at gmail.com  Wed Apr 15 01:33:14 2015
From: ivan.popivanov at gmail.com (Ivan Popivanov)
Date: Tue, 14 Apr 2015 23:33:14 +0000
Subject: [R-SIG-Finance] A bug in blotter?
Message-ID: <CAK7-yAgGd94s+xmc3yrtgDL1g2A5SEKZi=VAR0F8tcpk8gS=dw@mail.gmail.com>

Hello,

Looks like I found a bug in blotter while trying to use it to verify some
code of mine. :)

Here is the code that I question (from addTxn.r):

    # Compute transaction fees if a function was supplied
    if (is.function(TxnFees)) {
      txnfees <- TxnFees(TxnQty, TxnPrice, Symbol)
    } else {
      txnfees<- as.numeric(TxnFees)
    }

    if(is.null(txnfees) || is.na(txnfees))
        txnfees <- 0
    if(txnfees>0 && !isTRUE(allowRebates))
        stop('Positive Transaction Fees should only be used in the
case of broker/exchange rebates for TxnFees ',TxnFees,'. See
Documentation.')

    # split transactions that would cross through zero
    if(PrevPosQty!=0 && sign(PrevPosQty+TxnQty)!=sign(PrevPosQty) &&
PrevPosQty!=-TxnQty){
        txnFeeQty=txnfees/abs(TxnQty) # calculate fees pro-rata by quantity
        addTxn(Portfolio=pname, Symbol=Symbol, TxnDate=TxnDate,
TxnQty=-PrevPosQty, TxnPrice=TxnPrice, ...,
                TxnFees = txnFeeQty*abs(PrevPosQty), ConMult =
ConMult, verbose = verbose, eps=eps)
        TxnDate=TxnDate+2*eps #transactions need unique timestamps, so
increment a bit
        TxnQty=TxnQty+PrevPosQty
        PrevPosQty=0
        TxnFees=txnFeeQty*abs(TxnQty+PrevPosQty)
    }


This code is executed only when a transaction needs to be split in two -
for instance, we have two futures long, and add a transaction for going
short 3 futures.

The problem occurs because the code in the if-statement updates TxnFees,
while the rest of the code, before and after, has computed and used\s
txnfees. In other words, the last line should be:

txnfees=txnFeeQty*abs(TxnQty+PrevPosQty)

Regards,
Ivan

	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Wed Apr 15 04:34:01 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 14 Apr 2015 21:34:01 -0500
Subject: [R-SIG-Finance] A bug in blotter?
In-Reply-To: <CAK7-yAgGd94s+xmc3yrtgDL1g2A5SEKZi=VAR0F8tcpk8gS=dw@mail.gmail.com>
References: <CAK7-yAgGd94s+xmc3yrtgDL1g2A5SEKZi=VAR0F8tcpk8gS=dw@mail.gmail.com>
Message-ID: <CAPPM_gTeStke_VcDsN4MC5M4abJDVHBVL8xpVq4kfDPU5Qjf=g@mail.gmail.com>

Hi Ivan,

On Tue, Apr 14, 2015 at 6:33 PM, Ivan Popivanov
<ivan.popivanov at gmail.com> wrote:
> Hello,
>
> Looks like I found a bug in blotter while trying to use it to verify some
> code of mine. :)
>
> Here is the code that I question (from addTxn.r):
>
>     # Compute transaction fees if a function was supplied
>     if (is.function(TxnFees)) {
>       txnfees <- TxnFees(TxnQty, TxnPrice, Symbol)
>     } else {
>       txnfees<- as.numeric(TxnFees)
>     }
>
>     if(is.null(txnfees) || is.na(txnfees))
>         txnfees <- 0
>     if(txnfees>0 && !isTRUE(allowRebates))
>         stop('Positive Transaction Fees should only be used in the
> case of broker/exchange rebates for TxnFees ',TxnFees,'. See
> Documentation.')
>
>     # split transactions that would cross through zero
>     if(PrevPosQty!=0 && sign(PrevPosQty+TxnQty)!=sign(PrevPosQty) &&
> PrevPosQty!=-TxnQty){
>         txnFeeQty=txnfees/abs(TxnQty) # calculate fees pro-rata by quantity
>         addTxn(Portfolio=pname, Symbol=Symbol, TxnDate=TxnDate,
> TxnQty=-PrevPosQty, TxnPrice=TxnPrice, ...,
>                 TxnFees = txnFeeQty*abs(PrevPosQty), ConMult =
> ConMult, verbose = verbose, eps=eps)
>         TxnDate=TxnDate+2*eps #transactions need unique timestamps, so
> increment a bit
>         TxnQty=TxnQty+PrevPosQty
>         PrevPosQty=0
>         TxnFees=txnFeeQty*abs(TxnQty+PrevPosQty)
>     }
>
>
> This code is executed only when a transaction needs to be split in two -
> for instance, we have two futures long, and add a transaction for going
> short 3 futures.
>
> The problem occurs because the code in the if-statement updates TxnFees,
> while the rest of the code, before and after, has computed and used\s
> txnfees. In other words, the last line should be:
>
> txnfees=txnFeeQty*abs(TxnQty+PrevPosQty)
>
Thanks for the report and the fix.

This looks like something I missed in r1681 when fixing #5808:
https://r-forge.r-project.org/scm/viewvc.php/pkg/blotter/R/addTxn.R?root=blotter&r1=1666&r2=1681&pathrev=1681
https://r-forge.r-project.org/tracker/index.php?func=detail&aid=5808&group_id=316&atid=1269

Fixed in r1685.  Thanks for tracking this down.  It's a subtle issue
and I'm sure it took some work to uncover the root cause.

> Regards,
> Ivan
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From graham.ewen at bluecrestcapital.com  Wed Apr 15 11:11:01 2015
From: graham.ewen at bluecrestcapital.com (Graham Ewen)
Date: Wed, 15 Apr 2015 09:11:01 +0000
Subject: [R-SIG-Finance] Portfolio Min Variance Optimisation with
 Turnover Constraints
In-Reply-To: <552811DB.1010302@4dscape.com>
References: <B592266F4C58194D89CBE49E71512BC013C2F9DE@BRLVSEXMBP02.BlueCrest.local>
	<552811DB.1010302@4dscape.com>
Message-ID: <B592266F4C58194D89CBE49E71512BC013C348C0@BRLVSEXMBP02.BlueCrest.local>

Thanks for the reply Alexios.

I apologise I can see quite clearly in the documentation now, in Table 1, that the Covariance minrisk problem is not compatible with the NLP solver, so it should have been obvious to me why the NLP constraints were ignored.

I think the lack of convergence in the solnp formulation is potentially due to the initial weights being too far from the solution under the tight turnover constraint. I will take your advice and try to reformulate and solve as a QP problem.

Thank you,

Graham.

-----Original Message-----
From: alexios ghalanos [mailto:alexios at 4dscape.com]
Sent: 10 April 2015 19:10
To: Graham Ewen; r-sig-finance at r-project.org
Cc: alexios at 4dscape.com
Subject: Re: [R-SIG-Finance] Portfolio Min Variance Optimisation with Turnover Constraints

Hi Graham,

The reason it ignores the turnover constraint is because it is an NLP constraint (scenario based), _not_ a QP constraint. From the documentation:

"Provides a number of custom constraints and their jacobians for use with the NLP representation (both minimum risk and the fractional problem)."

As to the lack of convergence of the solnp formulation you describe, I am guessing that it is because of the bounds placed on the ineqUB
(0.2) for the turnover constraint and the presence of the absolute function which is not smooth. To solve this as a QP problem, the abs function would require that you represent it as a second order cone problem and solve it with an SOCP solver. Alternatively, if you can write out the gradients of your functions, you _may_ have better luck with the nloptr solver (see ineqjac.turnover.min for an example).

Regards,

Alexios



On 10/04/2015 19:54, Graham Ewen wrote:
> Hi,
>
>
>
> I am new to using R for optimisation and I am trying to set up a
> simple portfolio minimum variance optimisation with turnover
> constraints, but am having some difficulty setting up the problem
> correctly. I would really appreciate any help. I am trying two
> approaches one using the Rsolnp library and the other using the the
> parma library, but am having trouble with both.
>
>
>
> Using Rsolnp I am having trouble getting the optimisation to converge,
> but this may be that the problem is poorly conditioned but please
> advise if the formulation seems correct.
>
>
>
> ineq.fun.turnover <- function (x, sigma, wInit)
>
> {
>
>   return(sum(abs(x - wInit)))
>
> }
>
>
>
> obj.fun <- function(x, sigma, wInit)
>
> {
>
>   return(as.numeric(x%*%sigma%*%x))
>
> }
>
>
>
> eq.fun <- function(x,sigma,wInit)
>
> {
>
>   return(sum(x))
>
> }
>
>
>
> tst <- solnp(initWeights, fun=obj.fun, eqfun=eq.fun, eqB = 1.0,
> ineqfun = ineq.fun.turnover,
>
>              ineqLB = 0.0, ineqUB = 0.2, LB =
> rep(0,numberOfSecurities), UB = rep(0.1,numberOfSecurities),
>
>              sigma = covarMatx, wInit = initWeights)
>
>
>
>
>
> Where initWeights is a vector of length numberOfSecurities, and the
> covarMatx is a covariance Matrix (generated from a factor model) of
> dimensions numberOfSecurities by numberOfSecurities.
>
>
>
> Using parma, I cannot seem to get parmaspec to recognise the turnover
> constraint inequality functions (using the custom ones in the
> library), so I am guessing I am using incompatible parameters.... ?
>
>
>
> servars = list()
>
> uservars$turnover <- 0.2
>
> uservars$wold <- initWeights
>
>
>
> spec2 <- parmaspec(S = covarMatx,  LB = lowerBounds, UB = upperBounds,
>
>                   risk = "EV", riskType = "minrisk",
>
>                   ineqfun = list(ineqfun.turnover.min), ineqgrad =
> list(ineqjac.turnover.min), uservars = uservars)
>
>
>
>
>
> It simply tries to solve the QP min risk problem ignoring the turnover
> inequality.
>
>
>
>
>
> Thank you,
>
>
>
> Graham.
>
>
>
>
>
>
>
> *Graham Ewen*
> BlueCrest Capital Management (UK) LLP
> 40 Grosvenor Place, London, SW1X 7AW, United Kingdom
> *T*  +44 20 3180 3530
> graham.ewen at bluecrestcapital.com
> <mailto:graham.ewen at bluecrestcapital.com>
>
> Description: Description: Description: Description: Description:
> Description: Description: aaaBlueCrest Capital Management (UK) LLP
> Logo
>
>
>
>
> The information transmitted is intended only for the person or entity
> to which it is addressed and may contain confidential and/or
> privileged material. Any review, retransmission, dissemination or
> other use of, or taking of any action in reliance upon, this
> information by persons or entities other than the intended recipient
> is prohibited. If you received this in error, please contact the
> sender and delete the material from any computer.
>
> This communication is for informational purposes only. It is not
> intended as an offer or solicitation for the purchase or sale of any
> financial instrument or as an official confirmation of any transaction.
> Any market prices, data and other information are not warranted as to
> completeness or accuracy and are subject to change without notice. Any
> comments or statements made herein do not necessarily reflect those of
> BlueCrest Capital Management (UK) LLP, its subsidiaries or affiliates.
>
> BlueCrest Capital Management (UK) LLP is authorised and regulated by
> the Financial Conduct Authority. BlueCrest Capital Management (UK) LLP
> is registered in England and Wales with registered number OC349662.
> Registered Office: 40 Grosvenor Place, London SW1X 7AW, United Kingdom.
>
> Please see the important information at
> www.bluecrestcapital.com/disclaimer.
>
> Tel: +44 (0)20 3180 3000 Fax: +44 (0)20 3180 3001
> www.bluecrestcapital.com
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.

This communication is for informational purposes only. It is not intended as an offer or solicitation for the purchase or sale of any financial instrument or as an official confirmation of any transaction. Any market prices, data and other information are not warranted as to completeness or accuracy and are subject to change without notice. Any comments or statements made herein do not necessarily reflect those of BlueCrest Capital Management (UK) LLP, its subsidiaries or affiliates.

BlueCrest Capital Management (UK) LLP is authorised and regulated by the Financial Conduct Authority. BlueCrest Capital Management (UK) LLP is registered in England and Wales with registered number OC349662. Registered Office: 40 Grosvenor Place, London SW1X 7AW, United Kingdom.

Please see the important information at www.bluecrestcapital.com/disclaimer.

Tel: +44 (0)20 3180 3000 Fax: +44 (0)20 3180 3001 www.bluecrestcapital.com


From peter.michaels at gmail.com  Fri Apr 17 19:02:15 2015
From: peter.michaels at gmail.com (Peter)
Date: Fri, 17 Apr 2015 13:02:15 -0400
Subject: [R-SIG-Finance] PortfolioAnalytics Group Constraint
Message-ID: <CAL3bLicCErVK-h8KfsuoWouykSpkNNvnFYbZKpVrcyK=sjbLAA@mail.gmail.com>

Hi,

I am just starting to use PortfolioAnalytics and I am trying to set up a
group constraint that dynamically adjusts the min/max based on the date.

I want to constrain the portfolio sector weights to always be +/- 2% from
the benchmark sector weights.  Is it possible to set the constraint so that
I can provide a function which resets the min/max parameters?  I don't see
how the optimize.portfolio.rebalancing call can be used for a benchmark-ed
portfolio without changing the group constraint for every rebalance period.

Thank you for your help.
Peter

	[[alternative HTML version deleted]]


From rossbennett34 at gmail.com  Sat Apr 18 03:01:27 2015
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Fri, 17 Apr 2015 20:01:27 -0500
Subject: [R-SIG-Finance] PortfolioAnalytics Group Constraint
In-Reply-To: <CAL3bLicCErVK-h8KfsuoWouykSpkNNvnFYbZKpVrcyK=sjbLAA@mail.gmail.com>
References: <CAL3bLicCErVK-h8KfsuoWouykSpkNNvnFYbZKpVrcyK=sjbLAA@mail.gmail.com>
Message-ID: <CAEESW=Whe6QytcL6qNMEx3cG=ZAWtp3TWRKoXq0YjFVpmjugeQ@mail.gmail.com>

Hi Peter,

This can certainly be done with PortfolioAnalytics. One of the key aspects
of the package is the modular design that allows you to define your own
objective function. Here are two ways to accomplish this:
1. custom objective function - define a custom objective function to
penalize portfolio weights that violate benchmark weights
2. loop over the returns and benchmark weights, modifying the constraints
each iteration

Here is an example with box constraints. I know your question asks for
group constraints, but the same concept applies and doing this first with
box constraints should be easier to understand.

###########
library(PortfolioAnalytics)
data(edhec)
data(weights)

# Use the first 4 columns in edhec for a returns object
R <- edhec[, 1:4]
colnames(R) <- c("CA", "CTAG", "DS", "EM")
head(R, 5)

# benchmark weights
bweights <- weights[,1:4]
# normalize to sum to 1
bweights <- xts(t(apply(bweights, 1, function(x) x / sum(x))),
index(weights))
colnames(bweights) <- c("CA", "CTAG", "DS", "EM")
head(bweights)

# subset the returns object to begin after bweights
R <- R[paste(first(index(bweights)),"/")]

# Get a character vector of the fund names
funds <- colnames(R)

# Construct initial portfolio with basic constraints.
init.portf <- portfolio.spec(assets=funds)
init.portf <- add.constraint(portfolio=init.portf, type="weight_sum",
                             min_sum=0.99, max_sum=1.01)
init.portf <- add.constraint(portfolio=init.portf, type="long_only")

# objective to minimize portfolio standard deviation
init.portf <- add.objective(portfolio=init.portf, type="risk",
name="StdDev")

##### Solution 1: custom objective function #####
# objective function to penalize portfolio weights that violate benchmark
# weights by +/- 2%.
foo <- function(R, weights, benchmark_weights){
  idx <- index(last(R))

  # this will use the last observation before idx of weights in the
benchmark
  # if the index of the returns does not match the index of
benchmark_weights
  # e.g. annual benchmark weights and quarterly rebalancing period

  # should do some other checks in here to make sure you get valid weights
  bw <- as.numeric(last(benchmark_weights[paste("/",idx,sep="")]))

  # penalize weights that are outside of the benchmark weights +/- 2%
  out <- 0
  penalty <- 1e4
  N <- length(bw)

  bmax <- bw + 0.02
  # Only go to penalty term if any of the weights violate max
  if(any(weights > bmax)){
    out <- out + sum(weights[which(weights > bmax[1:N])] -
bmax[which(weights > bmax[1:N])]) * penalty
  }

  bmin <- bw - 0.02
  # Only go to penalty term if any of the weights violate min
  if(any(weights < bmin)){
    out <- out + sum(bmin[which(weights < bmin[1:N])] -
weights[which(weights < bmin[1:N])]) * penalty
  }

  # objective function must return a single value to minimize
  return(out)
}

# use type = "risk" because we want to minimize the penalty term for
# portfolio weights that are outside of the bounds of the benchmark weights
portf <- add.objective(portfolio=init.portf, type="risk", name="foo",
                            arguments=list(benchmark_weights=bweights))

rp <- random_portfolios(init.portf, 1000)
rebal <- "years"
train <- 36
opt <- optimize.portfolio.rebalancing(R, portf,
                                      training_period = train,
                                      rebalance_on = rebal,
                                      optimize_method="random", rp=rp,
                                      trace=TRUE)
opt
extractWeights(opt)
chart.Weights(opt)

##### Solution 2: loop over returns and change the constraints #####
library(foreach)
library(iterators)

ep.i <- endpoints(R, on = rebal)[which(endpoints(R, on = rebal) >= train)]
out_list<-foreach::foreach(ep=iterators::iter(ep.i), .errorhandling='pass',
.packages='PortfolioAnalytics') %dopar% {
  tmpR <- R[1:ep,]
  idx <- index(last(tmpR))

  # this will use the last observation before idx of weights in the
benchmark
  # if the index of the returns does not match the index of
benchmark_weights
  # e.g. annual benchmark weights and quarterly rebalancing period
  # should do some other checks in here to make sure you get valid weights
  bw <- as.numeric(last(bweights[paste("/",idx,sep="")]))
  init.portf$constraints[[2]]$min <- bw - 0.02
  init.portf$constraints[[2]]$max <- bw + 0.02
  optimize.portfolio(R[1:ep,], portfolio=init.portf,
                     optimize_method="random", trace=TRUE,
                     rp=rp, parallel=FALSE)
}

# extract the optimal weights
xts(do.call(rbind, lapply(out_list, function(x) x$weights)), index(R)[ep.i])

# optimal weights for solution 1 and 2 should be equal
all.equal(xts(do.call(rbind, lapply(out_list, function(x) x$weights)),
index(R)[ep.i]),
          extractWeights(opt), check.attributes = FALSE)
##########

Regards,
Ross

On Fri, Apr 17, 2015 at 12:02 PM, Peter <peter.michaels at gmail.com> wrote:

> Hi,
>
> I am just starting to use PortfolioAnalytics and I am trying to set up a
> group constraint that dynamically adjusts the min/max based on the date.
>
> I want to constrain the portfolio sector weights to always be +/- 2% from
> the benchmark sector weights.  Is it possible to set the constraint so that
> I can provide a function which resets the min/max parameters?  I don't see
> how the optimize.portfolio.rebalancing call can be used for a benchmark-ed
> portfolio without changing the group constraint for every rebalance period.
>
> Thank you for your help.
> Peter
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Sat Apr 18 19:05:27 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 18 Apr 2015 12:05:27 -0500
Subject: [R-SIG-Finance] Specify time segment to calculate indicator and
 trade ?
In-Reply-To: <1428549429045-4705639.post@n4.nabble.com>
References: <1428549429045-4705639.post@n4.nabble.com>
Message-ID: <CAPPM_gS2q556GLmwxd+bMqM7eGzJNqFjCyagsunskY-aG3c7SA@mail.gmail.com>

On Wed, Apr 8, 2015 at 10:17 PM, domodo <1111938 at qq.com> wrote:
> hi,guys.
> quantstrat is very powerful and convient when coding strategy and backtest
> it with indicator and pre-define price pattern.but i'm not familiar with
> specify the strategy to trade in a segment of trading-time,below are two
> cases:
> 1)establish position from 10:00 to 14:00 only,and close position with
> technical exits

Using quantstrat, you can limit rule execution to a specific time of
day via add.rule's timespan argument.  In this case you would set it
to timepan="T10:00/T14:00".

> 2)get the highest and lowest price of the first hour of a day
>
You can also do this with time-of-day subsetting.  For example:
apply.daily(xtsData["T09:30/T10:30", "Close"], range)

> for example,the strategy below is about price and single sma cross over.
> for case 1,i should store price series' date&time in varible 'datetime' as:
> [code]
> datetime <- as.POSIXlt(index(C))
> [/code]
>
> set entry time segment as:
> [code]
> entrytime1 <- 10
> entrytime2 <- 14
> [/code]
>
> and add some code below to judge whether the entry signal is in trading time
> :
> [code]
> signal <- ifelse(lag(C)>lag(MA) & lag(C,2)<lag(MA,2),1,
>                  ifelse(lag(C)&lt;lag(MA) &amp; lag(C,2)>lag(MA,2),-1,0))
>
> signal <- ifelse(signal>0 & datetime$hour>entrytime1 &
> datetime$hour<entrytime2,1,0)
> signal &lt;- ifelse(signal&lt;0 &amp; datetime$hour>entrytime1 &
> datetime$hour<entrytime2,-1,0)
> [/code]
>
> but the code above is not so elegant at all,and low-efficient.
>
> for the case 2,i should code a function to calculate the first hour's
> highest &amp; lowest price of each day,my idea in this function is similiar
> to code for case 1,that's, store price series's date&amp;time as a POSIXlt
> variable 'datetime',and judge whether hour == 10,min == 15,sec==0,but this
> idea is also rough and low-efficient.
>
> any help or tips please ?
>
> below is the example strategy
>
> [code]
> library(blotter)
> library(quantstrat)
>
> #initialize environtments
> currency(&quot;USD&quot;)
> startdate &lt;- '2012-01-18 09:14:00'
> finaldate &lt;- '2012-01-19 15:14:00'
>
> future(&quot;if2&quot;, currency = &quot;USD&quot;, multiplier = 300,
> tick_size = 0.2)
> Sys.setenv(TZ = &quot;UTC&quot;)
> rm(list=ls(envir=.blotter),envir=.blotter)
> b.strategy &lt;- &quot;strategy&quot;
>
> try(rm(list=ls(pos=.blotter),pos=.blotter),silent=TRUE)
> initPortf(b.strategy, &quot;if2&quot;, initDate = startdate)
> initAcct(b.strategy, portfolios = b.strategy, initDate = startdate, initEq =
> 1000000)
>
> ifBAC2 &lt;- read.table(&quot;C:/ifBAC2.csv&quot;, head = F, sep =
> &quot;,&quot;)
> coredata &lt;- ifBAC2[3:6]
> rownames(coredata) &lt;- as.POSIXlt(paste(ifBAC2[,1],ifBAC2[,2]))
> ifxts &lt;- as.xts(coredata)
> colnames(ifxts) &lt;-
> c(&quot;open&quot;,&quot;high&quot;,&quot;low&quot;,&quot;close&quot;)
> if2 &lt;- ifxts['2012-01-18 09:15:00/2012-01-19 15:14:00']
> if2$SMA15 &lt;- SMA(Cl(if2),15)
>
> #custom theme
> myTheme &lt;- chart_theme()
> myTheme$col$dn.col &lt;- &quot;lightgreen&quot;
> myTheme$col$up.col &lt;- &quot;red&quot;
> myTheme$col$dn.border &lt;- &quot;grey&quot;
> myTheme$col$up.border &lt;- &quot;grey&quot;
>
> MA &lt;- if2$SMA15
> C &lt;- Cl(if2)
> O &lt;- Op(if2)
>
> #trading signal judgement
> signal &lt;- ifelse(lag(C)>lag(MA) & lag(C,2)<lag(MA,2),1,
>                  ifelse(lag(C)&lt;lag(MA) &amp; lag(C,2)>lag(MA,2),-1,0))
> signal[is.na(signal)] <- 0
>
> #Bar-by-bar treatment
> for( i in 1:nrow(if2) )
> {
>   currentDate <- time(if2)[i]
>
>   equity<-getEndEq(b.strategy, currentDate)
>   Posn <- getPosQty(b.strategy, Symbol='if2', Date=currentDate)
>   #cat(as.character(i),"position on current bar is ",Posn, append = FALSE)
>
>   if(!is.na(MA[i]))
>   {
>     if( Posn == 0 & signal[i] == 1 ) { #no marketposition, and long signal
> occurs
>       #long entry
>       openprice <- as.double((Op(if2[currentDate])))
>       unitsize <- abs(as.numeric(trunc(equity/(openprice*300*0.15))))
>       addTxn(b.strategy, Symbol='if2', TxnDate=currentDate,
>              TxnPrice=openprice, TxnQty = unitsize ,
> TxnFees=-openprice*300*0.00005*unitsize, verbose = F)
>     }
>     else if( Posn != 0 & signal[i] == -1 ) {
>       #exit position
>       openprice <- as.double((Op(if2[currentDate])))
>       unitsize  <- abs(getPosQty(b.strategy, Symbol='if2',
> Date=currentDate))
>       addTxn(b.strategy, Symbol='if2', TxnDate=currentDate,
>              TxnPrice=openprice, TxnQty = -unitsize ,
> TxnFees=-openprice*300*0.00005*unitsize, verbose = F)
>     }
>   }
>
>   updatePortf(b.strategy, Dates = currentDate)
>   updateAcct(b.strategy, Dates = currentDate)
>   updateEndEq(b.strategy, Dates = currentDate)
> }
>
> chart.Posn(b.strategy, Symbol = "if2", theme = myTheme, TA =
> "add_SMA(n=15,col=4)")
>
> txns <- getTxns(Portfolio = b.strategy, Symbol = "if2")
> tstats <- tradeStats(Portfolio = b.strategy, Symbol = "if2")
> [/code]
>
> data format is as below
>
> [code]
>
> 2012/1/18       9:15:00 2577.6  2580.6  2573.6  2577.2
> 2012/1/18       9:16:00 2577.2  2583.6  2577    2583.2
> 2012/1/18       9:17:00 2583.4  2583.8  2580.6  2580.8
> 2012/1/18       9:18:00 2580.8  2581.4  2576.4  2577
> 2012/1/18       9:19:00 2577    2582    2576.6  2580.4
> 2012/1/18       9:20:00 2580.4  2581.4  2578.2  2581
> 2012/1/18       9:21:00 2580.8  2580.8  2578.8  2580
> 2012/1/18       9:22:00 2580.2  2581    2579.4  2579.8
> 2012/1/18       9:23:00 2580    2584.4  2579.8  2583.6
> 2012/1/18       9:24:00 2583.8  2585.2  2576    2576.2
> 2012/1/18       9:25:00 2577    2579.8  2576.8  2579
> 2012/1/18       9:26:00 2578.8  2584.2  2578.8  2581.2
> 2012/1/18       9:27:00 2581    2582.2  2580.6  2581.6
> 2012/1/18       9:28:00 2581.6  2581.6  2578.8  2579.4
> 2012/1/18       9:29:00 2580    2583    2579.8  2581.4
>
> [/code]
>
>
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Specify-time-segment-to-calculate-indicator-and-trade-tp4705639.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From peter.michaels at gmail.com  Mon Apr 20 01:19:19 2015
From: peter.michaels at gmail.com (Peter)
Date: Sun, 19 Apr 2015 19:19:19 -0400
Subject: [R-SIG-Finance] PortfolioAnalytics Group Constraint
In-Reply-To: <CAEESW=Whe6QytcL6qNMEx3cG=ZAWtp3TWRKoXq0YjFVpmjugeQ@mail.gmail.com>
References: <CAL3bLicCErVK-h8KfsuoWouykSpkNNvnFYbZKpVrcyK=sjbLAA@mail.gmail.com>
	<CAEESW=Whe6QytcL6qNMEx3cG=ZAWtp3TWRKoXq0YjFVpmjugeQ@mail.gmail.com>
Message-ID: <CAL3bLieCJs8PjiGfmTT9HH53U3YtRp2vwXxce491zZ6KOG=uyA@mail.gmail.com>

A non-text attachment was scrubbed...
Name: not available
Type: multipart/alternative
Size: 31 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150419/72afa721/attachment.bin>

From josh.m.ulrich at gmail.com  Mon Apr 20 04:21:22 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sun, 19 Apr 2015 21:21:22 -0500
Subject: [R-SIG-Finance] Dates not formatting properly for quarterly
 time series in xtsExtra
In-Reply-To: <CAAmySGPcDEzQt4LcvPN-jS6YhBWZgFFzt3bQ4HCdFMe0ukXN9w@mail.gmail.com>
References: <03c601cf0b3f$01f74060$05e5c120$@washington.edu>
	<CAAmySGPcDEzQt4LcvPN-jS6YhBWZgFFzt3bQ4HCdFMe0ukXN9w@mail.gmail.com>
Message-ID: <CAPPM_gTz9qjSF2hfvZ1yD5j+bhk=a0PUpf37d0jQU3dPgJ6n+w@mail.gmail.com>

To close the loop, this has been fixed:
https://github.com/joshuaulrich/xts/issues/75

On Mon, Jan 6, 2014 at 9:10 PM, R. Michael Weylandt
<michael.weylandt at gmail.com> wrote:
> On Mon, Jan 6, 2014 at 7:25 PM, Eric Zivot <ezivot at u.washington.edu> wrote:
>> I have been working on some examples of plotting time series for my new book
>> Modeling Financial Time Series with R and I noticed something funny with
>> plot.xts() from the R package xtsExtra when trying to plot quarterly time
>> series created from the xts function to.quarterly. Here is an example:
>>
>>> sessionInfo()
>>
>> R version 3.0.2 (2013-09-25)
>>
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>>> getSymbols("GS")
>>
>>> GS.Ad.xts = Ad(GS)
>>> GS.Ad.quarterly.xts = to.quarterly(GS.Ad.xts, OHLC=FALSE)
>>> periodicity(GS.Ad.quarterly.xts)
>> Quarterly periodicity from 2007 Q1 to 2014 Q1
>>> # Error in axis format for time plot
>>> plot(GS.Ad.quarterly.xts, lwd=2, col="blue")
>>
>> In the resulting plot, the format for the axis is not correct. Instead of
>> showing the date as "Q1 2007", I see "%b 2007".
>
> Hi Professor,
>
> Thanks for the great bug report. Very easy to track down exactly what happened.
>
> The issue is in xts, not xtsExtra: specifically, the axTicksByTime() function.
>
>> axTicksByTime(GS.Ad.quarterly.xts)[1:5]
> %n%b%n2007 %n%b%n2007 %n%b%n2007 %n%b%n2007 %n%b%n2008
>          1          2          3          4          5
>
> (I'm on a Unix system, hence the extra %n symbols)
>
> Looking at the source of axTicksByTime, one sees that the default
> formatting is "%b %Y" but that weekly, daily, minutely [1], hourly,
> secondly [1] periodicities are special-cased.
>
> Unfortunately, the "yearqtr" index object doesn't have anything which
> can be formatted at %b (month name in English in ?strptime), so the %b
> remains, giving the ugly axes you see.
>
> Adding this line to the source of axTicksByTime (say around L40) should fix it:
>
> if(time.scale == "quarterly") fmt <- "%Y-Q%q"
>
> I've pushed a commit to r-forge which adds this to a copy of
> axTicksByTime in xtsExtra which should fix it temporarily [r800]. I'll
> speak to Josh about putting in xts-proper.
>
> Hope it helps,
> Michael
>
> [1] Neither of those actually seem like the right word.
>
>>
>> Also, I notice a strange error related to timezones.
>>
> I think this is just a warning (at least on my system): shouldn't be a
> problem if you're on daily-or-lower data.
>
>>
>>
>>> Sys.timezone()
>> [1] "PST"
>>
>>
>>
>> Do I have to change my system timezone to UTC prior to downloading the data
>> to get rid of this error?
>>
>> Thanks for any help.
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From josh.m.ulrich at gmail.com  Mon Apr 20 19:36:58 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 20 Apr 2015 12:36:58 -0500
Subject: [R-SIG-Finance] RFC: plot.xts
Message-ID: <CAPPM_gSdHSSTQrh50FKCgD_1DPGoXgWMZwPUMktjr+e=Z2KYEw@mail.gmail.com>

We have been working on a new charting engine for xts::plot.xts for
the past couple years. It started with Michael Weylandt's work during
the 2012 Google Summer of Code, and Ross Bennett took up the torch
during the 2014 GSoC.

This new engine improves the functionality, modularity, and
flexibility of plot.xts by building off the framework Jeff Ryan began
with quantmod::chart_Series.  The modular framework allows users to
plot an xts object and incrementally build custom charts by adding
panels of new data (including transformations of the original xts
object).

The main objective was to provide functionality similar to chartSeries
and addTA for xts objects. The current code includes support for:
- basic time series plots with sensible defaults
- plotting xts objects by column "automagically" as separate panels
- small multiples with multiple pages
- "layout-safe" so multiple specifications/panels can be charted in a
single device
- Easily add data to an existing plot or add panels similar to quantmod::add*
- Event lines

The xts team would greatly appreciate any comments, feedback, and bug
reports before the upcoming CRAN release at the end of April.

The new version of plot.xts is in the main xts development code base,
which is available in the develop branch at:
https://github.com/joshuaulrich/xts

Bug reports and feature requests can be submitted at:
https://github.com/joshuaulrich/xts/issues

Note that the new plot.xts includes breaking changes to the original
(and rather limited) plot.xts.  However, we believe the new
functionality more than compensates for the potential one-time
inconvenience.

Thanks,
Josh


-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From rossbennett34 at gmail.com  Tue Apr 21 12:37:23 2015
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Tue, 21 Apr 2015 10:37:23 +0000
Subject: [R-SIG-Finance] PortfolioAnalytics Group Constraint
In-Reply-To: <CAL3bLieCJs8PjiGfmTT9HH53U3YtRp2vwXxce491zZ6KOG=uyA@mail.gmail.com>
References: <CAL3bLicCErVK-h8KfsuoWouykSpkNNvnFYbZKpVrcyK=sjbLAA@mail.gmail.com>
	<CAEESW=Whe6QytcL6qNMEx3cG=ZAWtp3TWRKoXq0YjFVpmjugeQ@mail.gmail.com>
	<CAL3bLieCJs8PjiGfmTT9HH53U3YtRp2vwXxce491zZ6KOG=uyA@mail.gmail.com>
Message-ID: <CAEESW=XV3FavHqtO2waXRoF6T7uPNb7ib6B7Su=Wx0FqpVPTYg@mail.gmail.com>

On Sun, Apr 19, 2015 at 11:19 PM, Peter <peter.michaels at gmail.com> wrote:

> Hi Ross,
>
> Thank you for the detailed response!
>
> I didn't think of incorporating the constraint as part of the objective
> function.  However, it makes sense since with the non-quadratic optimizers
> all of the constraints are expressed as penalties within the objective
> function, correct?
>

That is sort of correct. DEoptim provides a mapping function which
PortfolioAnalytics uses, for example for sum of weights, box, and group
constraints. So not all constraints for the global optimizers we support
are handled as "soft constraints" that are penalized in an objective
function. For global solvers that do not support a mapping function or a
specific constraint, then penalizing them in an objective function is the
general approach.


>
> Also, thank you for your contributions to the project.
>

You're welcome, thank you for the feedback.


>
> Regards,
> Peter
>
>
> On Fri, Apr 17, 2015 at 9:01 PM, Ross Bennett <rossbennett34 at gmail.com>
> wrote:
>
>> Hi Peter,
>>
>> This can certainly be done with PortfolioAnalytics. One of the key
>> aspects of the package is the modular design that allows you to define your
>> own objective function. Here are two ways to accomplish this:
>> 1. custom objective function - define a custom objective function to
>> penalize portfolio weights that violate benchmark weights
>> 2. loop over the returns and benchmark weights, modifying the constraints
>> each iteration
>>
>> Here is an example with box constraints. I know your question asks for
>> group constraints, but the same concept applies and doing this first with
>> box constraints should be easier to understand.
>>
>> ###########
>> library(PortfolioAnalytics)
>> data(edhec)
>> data(weights)
>>
>> # Use the first 4 columns in edhec for a returns object
>> R <- edhec[, 1:4]
>> colnames(R) <- c("CA", "CTAG", "DS", "EM")
>> head(R, 5)
>>
>> # benchmark weights
>> bweights <- weights[,1:4]
>> # normalize to sum to 1
>> bweights <- xts(t(apply(bweights, 1, function(x) x / sum(x))),
>> index(weights))
>> colnames(bweights) <- c("CA", "CTAG", "DS", "EM")
>> head(bweights)
>>
>> # subset the returns object to begin after bweights
>> R <- R[paste(first(index(bweights)),"/")]
>>
>> # Get a character vector of the fund names
>> funds <- colnames(R)
>>
>> # Construct initial portfolio with basic constraints.
>> init.portf <- portfolio.spec(assets=funds)
>> init.portf <- add.constraint(portfolio=init.portf, type="weight_sum",
>>                              min_sum=0.99, max_sum=1.01)
>> init.portf <- add.constraint(portfolio=init.portf, type="long_only")
>>
>> # objective to minimize portfolio standard deviation
>> init.portf <- add.objective(portfolio=init.portf, type="risk",
>> name="StdDev")
>>
>> ##### Solution 1: custom objective function #####
>> # objective function to penalize portfolio weights that violate benchmark
>> # weights by +/- 2%.
>> foo <- function(R, weights, benchmark_weights){
>>   idx <- index(last(R))
>>
>>   # this will use the last observation before idx of weights in the
>> benchmark
>>   # if the index of the returns does not match the index of
>> benchmark_weights
>>   # e.g. annual benchmark weights and quarterly rebalancing period
>>
>>   # should do some other checks in here to make sure you get valid weights
>>   bw <- as.numeric(last(benchmark_weights[paste("/",idx,sep="")]))
>>
>>   # penalize weights that are outside of the benchmark weights +/- 2%
>>   out <- 0
>>   penalty <- 1e4
>>   N <- length(bw)
>>
>>   bmax <- bw + 0.02
>>   # Only go to penalty term if any of the weights violate max
>>   if(any(weights > bmax)){
>>     out <- out + sum(weights[which(weights > bmax[1:N])] -
>> bmax[which(weights > bmax[1:N])]) * penalty
>>   }
>>
>>   bmin <- bw - 0.02
>>   # Only go to penalty term if any of the weights violate min
>>   if(any(weights < bmin)){
>>     out <- out + sum(bmin[which(weights < bmin[1:N])] -
>> weights[which(weights < bmin[1:N])]) * penalty
>>   }
>>
>>   # objective function must return a single value to minimize
>>   return(out)
>> }
>>
>> # use type = "risk" because we want to minimize the penalty term for
>> # portfolio weights that are outside of the bounds of the benchmark
>> weights
>> portf <- add.objective(portfolio=init.portf, type="risk", name="foo",
>>                             arguments=list(benchmark_weights=bweights))
>>
>> rp <- random_portfolios(init.portf, 1000)
>> rebal <- "years"
>> train <- 36
>> opt <- optimize.portfolio.rebalancing(R, portf,
>>                                       training_period = train,
>>                                       rebalance_on = rebal,
>>                                       optimize_method="random", rp=rp,
>>                                       trace=TRUE)
>> opt
>> extractWeights(opt)
>> chart.Weights(opt)
>>
>> ##### Solution 2: loop over returns and change the constraints #####
>> library(foreach)
>> library(iterators)
>>
>> ep.i <- endpoints(R, on = rebal)[which(endpoints(R, on = rebal) >= train)]
>> out_list<-foreach::foreach(ep=iterators::iter(ep.i),
>> .errorhandling='pass', .packages='PortfolioAnalytics') %dopar% {
>>   tmpR <- R[1:ep,]
>>   idx <- index(last(tmpR))
>>
>>   # this will use the last observation before idx of weights in the
>> benchmark
>>   # if the index of the returns does not match the index of
>> benchmark_weights
>>   # e.g. annual benchmark weights and quarterly rebalancing period
>>   # should do some other checks in here to make sure you get valid weights
>>   bw <- as.numeric(last(bweights[paste("/",idx,sep="")]))
>>   init.portf$constraints[[2]]$min <- bw - 0.02
>>   init.portf$constraints[[2]]$max <- bw + 0.02
>>   optimize.portfolio(R[1:ep,], portfolio=init.portf,
>>                      optimize_method="random", trace=TRUE,
>>                      rp=rp, parallel=FALSE)
>> }
>>
>> # extract the optimal weights
>> xts(do.call(rbind, lapply(out_list, function(x) x$weights)),
>> index(R)[ep.i])
>>
>> # optimal weights for solution 1 and 2 should be equal
>> all.equal(xts(do.call(rbind, lapply(out_list, function(x) x$weights)),
>> index(R)[ep.i]),
>>           extractWeights(opt), check.attributes = FALSE)
>> ##########
>>
>> Regards,
>> Ross
>>
>> On Fri, Apr 17, 2015 at 12:02 PM, Peter <peter.michaels at gmail.com> wrote:
>>
>>> Hi,
>>>
>>> I am just starting to use PortfolioAnalytics and I am trying to set up a
>>> group constraint that dynamically adjusts the min/max based on the date.
>>>
>>> I want to constrain the portfolio sector weights to always be +/- 2% from
>>> the benchmark sector weights.  Is it possible to set the constraint so
>>> that
>>> I can provide a function which resets the min/max parameters?  I don't
>>> see
>>> how the optimize.portfolio.rebalancing call can be used for a
>>> benchmark-ed
>>> portfolio without changing the group constraint for every rebalance
>>> period.
>>>
>>> Thank you for your help.
>>> Peter
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>

	[[alternative HTML version deleted]]


From Josh-CH.Chien at nanshan.com.tw  Wed Apr 22 04:15:59 2015
From: Josh-CH.Chien at nanshan.com.tw (Chien, Josh-CH)
Date: Wed, 22 Apr 2015 10:15:59 +0800
Subject: [R-SIG-Finance] RQuantLib - DiscountCurve Class
Message-ID: <A29A84E40742CB43BBAE51703694429A82A4D85A22@WNSP3NSLXMBV1.nsli.net>

Hi R-User,
I want to use Bond Function to price Fixed-rate bond by RQuantLib. But, I have own ZeroCurve data.
Now, It can instead of that is generated by discount curve function constructed from market quotes in RQuantLib ?
Is it possible or solution for that ?

______________________________________
JOSH CHIEN
Risk Analytics & Projects
Enterprise Risk Management (ERM) Dept.
Nan Shan Life Insurance Co.
Email: Josh-CH.Chien at NANSHAN.com.tw<mailto:%20Josh-CH.Chien at NANSHAN.com.tw>
DID: +886-2-8758-9522


________________________________
"NOTICE: The e-mail, and any attachments thereto, may co...{{dropped:12}}


From paulteetor at yahoo.com  Thu Apr 23 17:33:19 2015
From: paulteetor at yahoo.com (Paul Teetor)
Date: Thu, 23 Apr 2015 15:33:19 +0000 (UTC)
Subject: [R-SIG-Finance] RFC: plot.xts
In-Reply-To: <CAPPM_gSdHSSTQrh50FKCgD_1DPGoXgWMZwPUMktjr+e=Z2KYEw@mail.gmail.com>
References: <CAPPM_gSdHSSTQrh50FKCgD_1DPGoXgWMZwPUMktjr+e=Z2KYEw@mail.gmail.com>
Message-ID: <2127729524.3513265.1429803199084.JavaMail.yahoo@mail.yahoo.com>

Josh:
First, many thanks to everyone for this work. I've seen some preliminary results, and they look wonderful.
Second, some questions before I dive in:
Does this subsume the xtsExtra package of plotting functions? Do we still need xtsExtra, or is that toast?
How would you recommend installing this? By devtools::install_github, for example?
Finally, I depend critically on xts for daily work. Does this beta release impact the non-graphics code? What's the appropriate level of caution here?
Thank you!?Paul Teetor, Elgin, IL USAhttp://quantdevel.com/public
      From: Joshua Ulrich <josh.m.ulrich at gmail.com>
 To: r-sig-finance <r-sig-finance at r-project.org> 
 Sent: Monday, April 20, 2015 12:36 PM
 Subject: [R-SIG-Finance] RFC: plot.xts
   
We have been working on a new charting engine for xts::plot.xts for
the past couple years. It started with Michael Weylandt's work during
the 2012 Google Summer of Code, and Ross Bennett took up the torch
during the 2014 GSoC.

This new engine improves the functionality, modularity, and
flexibility of plot.xts by building off the framework Jeff Ryan began
with quantmod::chart_Series.? The modular framework allows users to
plot an xts object and incrementally build custom charts by adding
panels of new data (including transformations of the original xts
object).

The main objective was to provide functionality similar to chartSeries
and addTA for xts objects. The current code includes support for:
- basic time series plots with sensible defaults
- plotting xts objects by column "automagically" as separate panels
- small multiples with multiple pages
- "layout-safe" so multiple specifications/panels can be charted in a
single device
- Easily add data to an existing plot or add panels similar to quantmod::add*
- Event lines

The xts team would greatly appreciate any comments, feedback, and bug
reports before the upcoming CRAN release at the end of April.

The new version of plot.xts is in the main xts development code base,
which is available in the develop branch at:
https://github.com/joshuaulrich/xts

Bug reports and feature requests can be submitted at:
https://github.com/joshuaulrich/xts/issues

Note that the new plot.xts includes breaking changes to the original
(and rather limited) plot.xts.? However, we believe the new
functionality more than compensates for the potential one-time
inconvenience.

Thanks,
Josh


-- 
Joshua Ulrich? |? about.me/joshuaulrich
FOSS Trading? |? www.fosstrading.com
R/Finance 2015 | www.rinfinance.com

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


  
	[[alternative HTML version deleted]]


From brian at braverock.com  Thu Apr 23 17:52:27 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 23 Apr 2015 10:52:27 -0500
Subject: [R-SIG-Finance] RFC: plot.xts
In-Reply-To: <2127729524.3513265.1429803199084.JavaMail.yahoo@mail.yahoo.com>
References: <CAPPM_gSdHSSTQrh50FKCgD_1DPGoXgWMZwPUMktjr+e=Z2KYEw@mail.gmail.com>
	<2127729524.3513265.1429803199084.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1429804347.14129.48.camel@brian-rcg.priv.dvtrading.co>

On Thu, 2015-04-23 at 15:33 +0000, Paul Teetor via R-SIG-Finance wrote:
> Josh:
> First, many thanks to everyone for this work. I've seen some
> preliminary results, and they look wonderful.
> Second, some questions before I dive in:
> Does this subsume the xtsExtra package of plotting functions? Do we
> still need xtsExtra, or is that toast?

plot.xts will be removed from xtsExtra in the near future.  Yes,
plot.xts and supporting function now in xts-proper supercede the
plot.xts in xtsExtra.


> How would you recommend installing this? By devtools::install_github,
> for example?

install_github is a fine approach

install_github('joshuaulrich/xts')


> Finally, I depend critically on xts for daily work. Does this beta
> release impact the non-graphics code? 

We use this code for production-critical tasks every day.  

The core of xts has the usual smattering of optimizations and bug fixes,
and has not changed substantially from a user perspective.  

plot.xts is substantially different from the old plot.xts, but the old
plot.xts didn't do much, which is why most users used chartSeries or
plot.zoo.  
 
> What's the appropriate level of caution here?

As always, YMMV, but this code has been under development and in use for
over a year, and I at least consider it stable and ready for prime time.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From Andy.Tang at morningstar.com  Thu Apr 23 18:00:39 2015
From: Andy.Tang at morningstar.com (Andy Tang)
Date: Thu, 23 Apr 2015 16:00:39 +0000
Subject: [R-SIG-Finance] multi horizon forecast in rmgarch
Message-ID: <B02BF0AA835AD14DA16AB693135BAB590CD35B94@MSEXCHM83.morningstar.com>

Hi Alex,

Do you have any update  for multi-horizon forecast for GOGARCH model in rmgarch package?
Or do you have any recommendation on how to implement it?
I want to forecast the joint density for a weekly return, which is a sum of t+1 to t+5.

Thanks
Andy


	[[alternative HTML version deleted]]


From john.b.williams at gmail.com  Sat Apr 25 01:39:46 2015
From: john.b.williams at gmail.com (John Williams)
Date: Fri, 24 Apr 2015 19:39:46 -0400
Subject: [R-SIG-Finance] quantstrat mktdata subsetting
Message-ID: <CAEeDWyYpSKuVgKpebh+sfY=ko1Fd9XyPgLLGSRYuHrmmp3R+4A@mail.gmail.com>

Hi,

I am just starting to use quantstat.  To calculate quanstrat indicators, I
need access to multiple subsets (as granular as individual values) of the
mktdata object.

How can I subset mktdata for multiple variables/paramters to an indicator
function?

Thank you for your help.
John

	[[alternative HTML version deleted]]


From n-e-w at qtradr.net  Sat Apr 25 03:30:58 2015
From: n-e-w at qtradr.net (Nick White)
Date: Sat, 25 Apr 2015 11:30:58 +1000
Subject: [R-SIG-Finance] quantstrat mktdata subsetting
In-Reply-To: <CAEeDWyYpSKuVgKpebh+sfY=ko1Fd9XyPgLLGSRYuHrmmp3R+4A@mail.gmail.com>
References: <CAEeDWyYpSKuVgKpebh+sfY=ko1Fd9XyPgLLGSRYuHrmmp3R+4A@mail.gmail.com>
Message-ID: <CAH+4RFs05AOiWaM91VkR_E26Wy+T6au46dygufN_7XyC2oJH3g@mail.gmail.com>

I think this is an interesting question -- but I'm not sure what exactly it
is you're trying to achieve.

Perhaps you could try posting a detailed example of what your data is, how
you'd like the output to look and perhaps some code (even pseudo code) so
we don't have to guess at what you want.

On Sat, Apr 25, 2015 at 9:39 AM, John Williams <john.b.williams at gmail.com>
wrote:

> Hi,
>
> I am just starting to use quantstat.  To calculate quanstrat indicators, I
> need access to multiple subsets (as granular as individual values) of the
> mktdata object.
>
> How can I subset mktdata for multiple variables/paramters to an indicator
> function?
>
> Thank you for your help.
> John
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From john.b.williams at gmail.com  Sat Apr 25 05:01:55 2015
From: john.b.williams at gmail.com (John Williams)
Date: Fri, 24 Apr 2015 23:01:55 -0400
Subject: [R-SIG-Finance] quantstrat mktdata subsetting
In-Reply-To: <CAH+4RFs05AOiWaM91VkR_E26Wy+T6au46dygufN_7XyC2oJH3g@mail.gmail.com>
References: <CAEeDWyYpSKuVgKpebh+sfY=ko1Fd9XyPgLLGSRYuHrmmp3R+4A@mail.gmail.com>
	<CAH+4RFs05AOiWaM91VkR_E26Wy+T6au46dygufN_7XyC2oJH3g@mail.gmail.com>
Message-ID: <CAEeDWybdGcMF+5yDB1Vf2K-nFWZB+LDkdHewfGYrFwh2W6yLJg@mail.gmail.com>

Nick,

the strategy under test includes an indicator derived from yesterday's HLC:

x = (yesterday's high + yesteday's low + yesterday's close )/3
If (today's close > x)  {
...
} else {
...
}

Trying to figure out how to computer this x in a quantstrat indicator

Thanks for your help





On Fri, Apr 24, 2015 at 9:30 PM, Nick White <n-e-w at qtradr.net> wrote:

> I think this is an interesting question -- but I'm not sure what exactly
> it is you're trying to achieve.
>
> Perhaps you could try posting a detailed example of what your data is, how
> you'd like the output to look and perhaps some code (even pseudo code) so
> we don't have to guess at what you want.
>
> On Sat, Apr 25, 2015 at 9:39 AM, John Williams <john.b.williams at gmail.com>
> wrote:
>
>> Hi,
>>
>> I am just starting to use quantstat.  To calculate quanstrat indicators, I
>> need access to multiple subsets (as granular as individual values) of the
>> mktdata object.
>>
>> How can I subset mktdata for multiple variables/paramters to an indicator
>> function?
>>
>> Thank you for your help.
>> John
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>

	[[alternative HTML version deleted]]


From john.b.williams at gmail.com  Sat Apr 25 16:46:07 2015
From: john.b.williams at gmail.com (John Williams)
Date: Sat, 25 Apr 2015 10:46:07 -0400
Subject: [R-SIG-Finance] quantstrat mktdata subsetting
In-Reply-To: <CAEeDWybdGcMF+5yDB1Vf2K-nFWZB+LDkdHewfGYrFwh2W6yLJg@mail.gmail.com>
References: <CAEeDWyYpSKuVgKpebh+sfY=ko1Fd9XyPgLLGSRYuHrmmp3R+4A@mail.gmail.com>
	<CAH+4RFs05AOiWaM91VkR_E26Wy+T6au46dygufN_7XyC2oJH3g@mail.gmail.com>
	<CAEeDWybdGcMF+5yDB1Vf2K-nFWZB+LDkdHewfGYrFwh2W6yLJg@mail.gmail.com>
Message-ID: <CAEeDWybwbfwLxhoZGK7No1hhJXRMzXEtDjaq3fEm9v314-WxAw@mail.gmail.com>

    I am thinking that   TTR::lags() may do the trick ...   e.g.,
 lags(close,1)  would return yesterday's close?

	[[alternative HTML version deleted]]


From Steven.Greiner at Schwab.com  Tue Apr 28 00:01:04 2015
From: Steven.Greiner at Schwab.com (Greiner, Steven)
Date: Mon, 27 Apr 2015 22:01:04 +0000
Subject: [R-SIG-Finance] R consultants
Message-ID: <ABE8877B291FA34185D4F1F57766E4C22D1971BD@NEX3003BDC.us.global.schwab.com>

Hello World,
We have a need for an expert R programmer for a consulting gig at Schwab lasting ~6 months or so in Chicago.  If anybody has interest please contact me directly at:  steven.greiner at schwab.com<mailto:steven.greiner at schwab.com>
Best
Steve

Steven P. Greiner, Ph.D.
SVP | Schwab Equity Ratings Department

Tel  312 931-1520  |  Cell  585 261-7138  |  Fax  312 931-1399
150 S. Wacker Dr, Ste 14; Chicago, IL 60606

Charles Schwab & Co., Inc.
NOTICE: All email sent to or from the Charles Schwab corporate email system is subject to archiving, monitoring and/or review by Schwab personnel.


	[[alternative HTML version deleted]]


From ispy611 at yahoo.com  Tue Apr 28 10:15:26 2015
From: ispy611 at yahoo.com (spy sixoneone)
Date: Tue, 28 Apr 2015 01:15:26 -0700
Subject: [R-SIG-Finance] IBrokers: How to call eWrapper - updatePortfolio()
	??
Message-ID: <1430208926.22470.YahooMailBasic@web162906.mail.bf1.yahoo.com>

Does anyone have an example of how to call 
eWrapper - updatePortfolio() ??

So far I have this syntax working well inside my script:

library(IBrokers)

twsobj  = twsConnect(clientId=myconid, port=myport)

res1 = reqAccountUpdates(twsobj, subscribe = TRUE, acctCode = "1")

Sys.sleep(4)

mysymbol   = 'AUD'
mycurrency = 'USD'

mycntrct = twsCurrency(mysymbol,currency=mycurrency,exch="IDEALPRO",primary="",strike="0.0",right="",local="",multiplier="",include_expired="0",conId=myconid)

# I should call updatePortfolio() here using eWrapper

Sys.sleep(4)

res2 = reqAccountUpdates(twsobj, subscribe = FALSE, acctCode = "1")

twsDisconnect(twsobj)


From markknecht at gmail.com  Tue Apr 28 15:25:59 2015
From: markknecht at gmail.com (Mark Knecht)
Date: Tue, 28 Apr 2015 06:25:59 -0700
Subject: [R-SIG-Finance] RFC: quantmod::getSymbols.MySQL
In-Reply-To: <CAPPM_gTt=G_=gs3jBX7tT3Pd8BgHyV1Z56fC1M6E7htH75gLjQ@mail.gmail.com>
References: <CAPPM_gQfMOasAbgNbNTWHrQ0uwgtqoxokT1EJa_v8ARp40n61g@mail.gmail.com>
	<CAPPM_gTt=G_=gs3jBX7tT3Pd8BgHyV1Z56fC1M6E7htH75gLjQ@mail.gmail.com>
Message-ID: <CAK2H+ec4k6VgLsfC9GpKd5dJ4YHQN7HfePRsosn_E3GZ4EbMvQ@mail.gmail.com>

On Thu, Jan 1, 2015 at 9:48 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> To follow up with the solution I adopted in quantmod_0.4-3 (on CRAN as
> of 2014-12-15): I moved all the necessary Defaults functionality
> directly to quantmod.  This did not include Defaults' ability to
> modify other package's namespaces, since that was a big reason Jeff
> requested Defaults be archived.
>
> This means that getSymbols.MySQL should function as it did when
> quantmod depended on Defaults.  Also, any packages that depend on
> quantmod and use the ported Defaults functionality should be able to
> use quantmod_0.4-3 without losing functionality.  Packages that use
> Defaults' ability to modify other package's namespaces will need to be
> patched to work without that functionality.
>
> On Wed, Oct 29, 2014 at 7:25 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>> As many of you know, the Defaults package was removed from CRAN on
>> 2014-10-03 at Jeff's request.  This broke a fair bit of functionality
>> in quantmod, most of which I have addressed in recent commits on
>> R-Forge.
>>
>> One issue I have not resolved is how to adapt getSymbols.MySQL to the
>> new no-Defaults paradigm.  I will be taking over as maintainer of
>> quantmod, so I am soliciting input from getSymbols.MySQL users.
>>
>> My proposed solution to getSymbols.MySQL is to look for specific
>> option()s if certain arguments are missing.  I think this is the
>> cleanest and most obvious solution, but am open to alternatives.  I
>> would use the option structure below, with only the three arguments
>> listed.
>>
>> options(quantmod.defaults = list(
>>   getSymbols.MySQL = list(
>>     user="josh",
>>     password="secret",
>>     dbname="stocks")
>>   )
>> )
>>
>> Should I consider another option structure?  Should additional
>> arguments be supported?  Anything else I'm missing?
>>
>> Thanks,
>> --
>> Joshua Ulrich  |  about.me/joshuaulrich
>> FOSS Trading  |  www.fosstrading.com
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


Should all of the fixes for these MySQL issues have migrated to CRAN
by now? I'm still running
my old code daily without using MySQL due to messages like this:

[1] "From MySQL --  SPY"
Error in (function (classes, fdef, mtable)  :
  unable to find an inherited method for function ?dbConnect? for
signature ?"character"?

Thanks,
Mark


From josh.m.ulrich at gmail.com  Tue Apr 28 15:51:11 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 28 Apr 2015 08:51:11 -0500
Subject: [R-SIG-Finance] RFC: quantmod::getSymbols.MySQL
In-Reply-To: <CAK2H+ec4k6VgLsfC9GpKd5dJ4YHQN7HfePRsosn_E3GZ4EbMvQ@mail.gmail.com>
References: <CAPPM_gQfMOasAbgNbNTWHrQ0uwgtqoxokT1EJa_v8ARp40n61g@mail.gmail.com>
	<CAPPM_gTt=G_=gs3jBX7tT3Pd8BgHyV1Z56fC1M6E7htH75gLjQ@mail.gmail.com>
	<CAK2H+ec4k6VgLsfC9GpKd5dJ4YHQN7HfePRsosn_E3GZ4EbMvQ@mail.gmail.com>
Message-ID: <CAPPM_gTShJYWuZpMGj5d_xgrxza4jh1VL1qrDPy30rtYmUaOSA@mail.gmail.com>

On Tue, Apr 28, 2015 at 8:25 AM, Mark Knecht <markknecht at gmail.com> wrote:
> On Thu, Jan 1, 2015 at 9:48 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>> To follow up with the solution I adopted in quantmod_0.4-3 (on CRAN as
>> of 2014-12-15): I moved all the necessary Defaults functionality
>> directly to quantmod.  This did not include Defaults' ability to
>> modify other package's namespaces, since that was a big reason Jeff
>> requested Defaults be archived.
>>
>> This means that getSymbols.MySQL should function as it did when
>> quantmod depended on Defaults.  Also, any packages that depend on
>> quantmod and use the ported Defaults functionality should be able to
>> use quantmod_0.4-3 without losing functionality.  Packages that use
>> Defaults' ability to modify other package's namespaces will need to be
>> patched to work without that functionality.
>>
>> On Wed, Oct 29, 2014 at 7:25 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>>> As many of you know, the Defaults package was removed from CRAN on
>>> 2014-10-03 at Jeff's request.  This broke a fair bit of functionality
>>> in quantmod, most of which I have addressed in recent commits on
>>> R-Forge.
>>>
>>> One issue I have not resolved is how to adapt getSymbols.MySQL to the
>>> new no-Defaults paradigm.  I will be taking over as maintainer of
>>> quantmod, so I am soliciting input from getSymbols.MySQL users.
>>>
>>> My proposed solution to getSymbols.MySQL is to look for specific
>>> option()s if certain arguments are missing.  I think this is the
>>> cleanest and most obvious solution, but am open to alternatives.  I
>>> would use the option structure below, with only the three arguments
>>> listed.
>>>
>>> options(quantmod.defaults = list(
>>>   getSymbols.MySQL = list(
>>>     user="josh",
>>>     password="secret",
>>>     dbname="stocks")
>>>   )
>>> )
>>>
>>> Should I consider another option structure?  Should additional
>>> arguments be supported?  Anything else I'm missing?
>>>
>>> Thanks,
>>> --
>>> Joshua Ulrich  |  about.me/joshuaulrich
>>> FOSS Trading  |  www.fosstrading.com
>>
>>
>> --
>> Joshua Ulrich  |  about.me/joshuaulrich
>> FOSS Trading  |  www.fosstrading.com
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
> Should all of the fixes for these MySQL issues have migrated to CRAN
> by now? I'm still running
> my old code daily without using MySQL due to messages like this:
>
Yes, all the fixes mentioned above are on CRAN.

> [1] "From MySQL --  SPY"
> Error in (function (classes, fdef, mtable)  :
>   unable to find an inherited method for function ?dbConnect? for
> signature ?"character"?
>
This is a separate issue caused by changes to the RMySQL API.  I don't
use this functionality, so I've opened an issue and asked for people
to test the proposed solution.
https://github.com/joshuaulrich/quantmod/issues/45

As you can see, there's been one response in the past month from an
anonymous person.  I'd like more feedback before pushing to CRAN.
Feedback quantity doesn't matter as much as quality. I'd be
comfortable with feedback from just one person I know I can trust.

I just pushed the proposed fix to branch RMySQL_45.  Hopefully that
will make it easier for others to test.

Best,
-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From markknecht at gmail.com  Tue Apr 28 17:26:02 2015
From: markknecht at gmail.com (Mark Knecht)
Date: Tue, 28 Apr 2015 08:26:02 -0700
Subject: [R-SIG-Finance] RFC: quantmod::getSymbols.MySQL
In-Reply-To: <CAPPM_gTShJYWuZpMGj5d_xgrxza4jh1VL1qrDPy30rtYmUaOSA@mail.gmail.com>
References: <CAPPM_gQfMOasAbgNbNTWHrQ0uwgtqoxokT1EJa_v8ARp40n61g@mail.gmail.com>
	<CAPPM_gTt=G_=gs3jBX7tT3Pd8BgHyV1Z56fC1M6E7htH75gLjQ@mail.gmail.com>
	<CAK2H+ec4k6VgLsfC9GpKd5dJ4YHQN7HfePRsosn_E3GZ4EbMvQ@mail.gmail.com>
	<CAPPM_gTShJYWuZpMGj5d_xgrxza4jh1VL1qrDPy30rtYmUaOSA@mail.gmail.com>
Message-ID: <CAK2H+efyWete4nCniX+SZoUkGN4HstOr5QpfU-Q1YuqDs+825g@mail.gmail.com>

On Tue, Apr 28, 2015 at 6:51 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
<SNIP>
>> Should all of the fixes for these MySQL issues have migrated to CRAN
>> by now? I'm still running
>> my old code daily without using MySQL due to messages like this:
>>
> Yes, all the fixes mentioned above are on CRAN.
>
>> [1] "From MySQL --  SPY"
>> Error in (function (classes, fdef, mtable)  :
>>   unable to find an inherited method for function ?dbConnect? for
>> signature ?"character"?
>>
> This is a separate issue caused by changes to the RMySQL API.  I don't
> use this functionality, so I've opened an issue and asked for people
> to test the proposed solution.
> https://github.com/joshuaulrich/quantmod/issues/45
>
> As you can see, there's been one response in the past month from an
> anonymous person.  I'd like more feedback before pushing to CRAN.
> Feedback quantity doesn't matter as much as quality. I'd be
> comfortable with feedback from just one person I know I can trust.
>
> I just pushed the proposed fix to branch RMySQL_45.  Hopefully that
> will make it easier for others to test.
>
> Best,
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2015 | www.rinfinance.com

OK, well as an acknowledged dummy, in RStudio I see that quantmod-0.4-4 is
installed and nothing newer is showing up as a package update. I suspect I'd
need to either wait a bit longer or else install quantmod from some
other location
using some other method?


From wuertz at phys.ethz.ch  Wed Apr 29 12:26:32 2015
From: wuertz at phys.ethz.ch (Diethelm Wuertz)
Date: Wed, 29 Apr 2015 12:26:32 +0200
Subject: [R-SIG-Finance] 9th ETH/Rmetrics Workshop 25-27 June Zurich
Message-ID: <088F47BA-152B-4D69-8E85-9D3619744F9E@phys.ethz.ch>

It is a pleasure for us to bring to your attention the 9th Rmetrics Workshop in Zurich 25-27 June 2015.
We would very appreciate it to welcome you in Zurich 

For the organization committee
Diethelm Wuertz, ETH Zurich and Rmetrics Association
www.rmetrics.org <http://www.rmetrics.org/>




                    9th Rmetrics Summer Workshop 2015
                      Zurich, 25 June ? 27 June 2015
                              www.rmetrics.org <http://www.rmetrics.org/>

                     De-Risking Financial Instruments: 
  Mastering Vulnerabilities, Structural Instabilities, and Stress Sensitivity



The workshop consists of an open master class with summer school-like academic 
tutorial sessions and a seminar workshop presenting and discussing new concepts 
for de-risking financial investments in practice.

_______________________________________________________________________________________
Open Master Class Tutorials:

ETH Zurich, Main Building, Lecture Hall, 25 June 2015 

   Thursday Morning 9:00-12:30
      Tomas Sauer, University of Passau, Germany: Spectral Wavelet Analysis
      Rosangela Loschi, Univ. Belo Horizonte Brazil: Bayesian Change Point Analysis

   Thursday Afternoon 14:00-17:30
      Bernhard Pfaff, Invesco Frankfurt, Germany: Portfolio Diversification Strategies
      Maximilian Wimmer, University of Regensburg, Germany: Goal Programming

_______________________________________________________________________________________
Villa Hatt Seminar:

De-Risking Approaches for Financial Investments
ETH Zurich Villa Hatt, 26-27 June 2015

Selected Topics and Guest Speakers (among others):
* Goekhan Kula, Myra Capital Austria, Asset Exchange Indices with Margrabe Options
* Jan Witte, Record Manangement Windsor UK, FX Hedging Strategies
* N.N.: Parity Indexing and Smart Beta 2.0
* Diethelm Wuertz, ETH Zurich CH, Stability Concepts and Investment Strategies

Participation: 
The master class is free and limited to 100 participants, the seminar is limited 
to 30 participants. Early registration is highly recommended.

Call for Presentations: 
There is time left for a few presentations of innovations on exciting applications. 
We invite you for submissions (they are considered on a rolling admission basis, 
there is no definite deadline.) Please send your submission to: submissions at rmetrics.org <mailto:submissions at rmetrics.org>.

Organization: 
Swiss Federal Institute of Technology Zurich and Rmetrics Association Zurich.
Conference Chair: Professor Diethelm Wuertz ETH Zurich
Conference Office: Tobias Setz, ETH Zurich, and Viktoria Forgacs, Rmetrics Association. 

Further information: 
Please contact: info at rmetrics.org <mailto:info at rmetrics.org>
www.rmetrics.org/zurich2015 <http://www.rmetrics.org/zurich2015>


We would highly appreciate it to welcome you to the 9th Rmetrics Seminar

for the Organisation Committee
Diethelm Wuertz, ETH Zurich and Rmetrics Association
	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Fri May  1 15:07:31 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 1 May 2015 08:07:31 -0500
Subject: [R-SIG-Finance] R/Finance 2015 registration now open
In-Reply-To: <CAPPM_gQy6u02RwGWCb77MhUvN5v4w_rVEeHFwGwmJU9c=OtqLQ@mail.gmail.com>
References: <CAPPM_gQy6u02RwGWCb77MhUvN5v4w_rVEeHFwGwmJU9c=OtqLQ@mail.gmail.com>
Message-ID: <CAPPM_gTqmfKkJUCQJE0Qemc3b=2bygaEGMFsU=H9dG1KY+493g@mail.gmail.com>

A friendly reminder that early-bird registration ends in two weeks, on
Friday, May 15.  Make sure to register before then, when prices will
increase by 50%.

Also note that agenda details are available at:
  http://www.RinFinance.com/agenda/


On Tue, Mar 31, 2015 at 7:03 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> Registration for R/Finance 2015 is now open!
>
> The conference will take place on May 29 and 30, at UIC in Chicago.
> Building on the success of the previous conferences in 2009-2014, we
> expect more than 250 attendees from around the world. R users from
> industry, academia, and government will joining 30+ presenters
> covering all areas of finance with R.
>
> We are very excited about the four keynote presentations given by
> Emanuel Derman, Louis Marascio, Alexander McNeil, and Rishi Narang.
> The conference agenda (currently) includes 18 full presentations and
> 19 shorter "lightning talks".  As in previous years, several
> (optional) pre-conference seminars are offered on Friday morning.
>
> There is also an (optional) conference dinner at The Terrace at Trump
> Hotel. Overlooking the Chicago river and skyline, it is a perfect
> venue to continue conversations while dining and drinking.
>
> As they are finalized, agenda details are available at:
>   http://www.RinFinance.com/agenda/
>
> Registration information is available at:
>   http://www.RinFinance.com/register/
>
> and can also be directly accessed by going to:
>   http://www.cvent.com/d/94q27k
>
> We would to thank our 2015 Sponsors for the continued support enabling us
> to host such an exciting conference:
>
>   International Center for Futures and Derivatives at UIC
>
>   Revolution Analytics
>   MS-Computational Finance and Risk Management at University of Washington
>
>   Ketchum Trading
>   OneMarketData
>   RStudio
>   SYMMS
>
> On behalf of the committee and sponsors, we look forward to seeing you
> in Chicago!
>
>   Gib Bassett, Peter Carl, Dirk Eddelbuettel, Brian Peterson,
>   Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich
>


-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From Josh-CH.Chien at nanshan.com.tw  Fri May  8 02:50:34 2015
From: Josh-CH.Chien at nanshan.com.tw (Chien, Josh-CH)
Date: Fri, 8 May 2015 08:50:34 +0800
Subject: [R-SIG-Finance] Gaussian Copula Simulation
Message-ID: <A29A84E40742CB43BBAE51703694429A83D339E1CE@WNSP3NSLXMBV1.nsli.net>

Dear R-User,
Just confirm my idea that rmvnrom function from mvtnorm library is equal to function of Gaussian Copula Simulation with correlation matrix ? If not, which library has such function for Gaussian Copula Simulation ?
Thanks a lot.


______________________________________
JOSH CHIEN
Risk Analytics & Projects
Enterprise Risk Management (ERM) Dept.
Nan Shan Life Insurance Co.
Email: Josh-CH.Chien at NANSHAN.com.tw<mailto:%20Josh-CH.Chien at NANSHAN.com.tw>
DID: +886-2-8758-9522


________________________________
"NOTICE: The e-mail, and any attachments thereto, may co...{{dropped:12}}


From ntobiaskramer at gmail.com  Tue May 12 12:29:03 2015
From: ntobiaskramer at gmail.com (Nils Tobias Kramer)
Date: Tue, 12 May 2015 12:29:03 +0200
Subject: [R-SIG-Finance] assetsLPM from fAssets and 0.moment
Message-ID: <CADhgW1f_LiyrycHwRE5bwLXC4oB35rOH6JDOSc7ubSf94Eqrbg@mail.gmail.com>

Hi there,

I was wondering how to calculate LPMs in R. My interpretation of the
0.moment is somehow different from what I can see in fAssets:

#using quantmod to get just any data
getSymbols("IBM")
x <- weeklyReturn(IBM)
#using fAssets to calculate lpm, 0.order
tau <- 0 #to make things easier
assetsLPM(x,tau,0) #returns 1
$mu
weekly.returns
             1
$Sigma
     [,1]
[1,]    0
attr(,"control")
  a tau
  0   0

When I think of lpm 0 I think of the probability that my returns are below
tau. This is what I expect let's say from Matlab.

Code of assetsLPM:
TauX <- Tau - x #0-x in my case
X.max <- ((TauX) + abs(TauX))/2 #equals max(0,-returns), so either 0 for
positive returns and for negative returns the absolute value of that return
LPM <- colMeans(X.max^a)

Checking what R does by ^0:
> -1^0
[1] -1
> 0^0
[1] 1
> 1^0
[1] 1

I can see why the sum is expected to be 1 as there are only elements either
0 or positive which are taken to the power of 0 which equals 1 for each
entry.

Somehow I can't get my interpretation (probability) and the output of 1
together. Maybe someone can help me out?

Aside, this here confuses my a little:
getSymbols("IBM")
x <- weeklyReturn(IBM)
y <- -x
head(y^0)
           weekly.returns
2007-01-05              1
2007-01-12              1
2007-01-19              1
2007-01-26              1
2007-02-02              1
2007-02-09              1
> head(y)
           weekly.returns
2007-01-05   -0.002469644
2007-01-12   -0.019708479
2007-01-19    0.031910610
2007-01-26   -0.013309764
2007-02-02   -0.017650077
2007-02-09    0.006251891

Now all entries are 1 when taken to the power of 0 whereas I expected only
the positive numbers to turn to 1 and the negative ones to -1!?

Anyways, the first and second moments of assetsLPM are just what I
expected, so I was wondering why I can't figure out the reason for the
results of the 0. moment.

Any insights?

Thanks
Toby

	[[alternative HTML version deleted]]


From gmatysiak at gmail.com  Thu May 14 15:05:59 2015
From: gmatysiak at gmail.com (George Matysiak)
Date: Thu, 14 May 2015 06:05:59 -0700 (PDT)
Subject: [R-SIG-Finance] !SPAM: Re: Documentation and functions under
 tradesys, blotter, quantstrat etc?
In-Reply-To: <4C39F123.1080903@braverock.com>
References: <AANLkTin4fsUUqzVLzXAlwpPSOjNpOeBKeSMd0Z9215MW@mail.gmail.com>
	<4C39F123.1080903@braverock.com>
Message-ID: <1431608759319-4707190.post@n4.nabble.com>

I've just download quandtstrat and there is no PDF, just a HTML link. Anyone
located the located the PDF file? Thanks.



--
View this message in context: http://r.789695.n4.nabble.com/Documentation-and-functions-under-tradesys-blotter-quantstrat-etc-tp2285245p4707190.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From EBiceroglu at optrust.com  Thu May 14 15:27:19 2015
From: EBiceroglu at optrust.com (Erol Biceroglu)
Date: Thu, 14 May 2015 13:27:19 +0000
Subject: [R-SIG-Finance] !SPAM: Re: Documentation and functions under
 tradesys, blotter, quantstrat etc?
In-Reply-To: <1431608759319-4707190.post@n4.nabble.com>
References: <AANLkTin4fsUUqzVLzXAlwpPSOjNpOeBKeSMd0Z9215MW@mail.gmail.com>
	<4C39F123.1080903@braverock.com>
	<1431608759319-4707190.post@n4.nabble.com>
Message-ID: <70C28E80655BFC46978030281154E85803D3E7B4@EXCHMBOX001P.optrust.local>

Hi,

Documentation can be found on Guy Yollin's Page:
http://www.r-programming.org/papers

Also R in Finance
http://www.rinfinance.com/agenda/2013/workshop/Humme+Peterson.pdf

And Ilya Kipnis's Blog:
https://quantstrattrader.wordpress.com/


Erol Biceroglu, MFin
Senior Risk Analyst
OPSEU Pension Trust


-----Original Message-----
From: R-SIG-Finance [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of George Matysiak
Sent: Thursday, May 14, 2015 9:06 AM
To: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] !SPAM: Re: Documentation and functions under tradesys, blotter, quantstrat etc?

I've just download quandtstrat and there is no PDF, just a HTML link. Anyone located the located the PDF file? Thanks.



--
View this message in context: http://r.789695.n4.nabble.com/Documentation-and-functions-under-tradesys-blotter-quantstrat-etc-tp2285245p4707190.html
Sent from the Rmetrics mailing list archive at Nabble.com.

_______________________________________________
R-SIG-Finance at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


Disclaimer 
--------------- 
This e-mail and files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this in error, contact OPTrust by telephone toll free at 1-800-906-7738 and delete the email without making a paper or electronic copy. The recipient should check this e-mail and attachments for the presence of viruses. OPTrust accepts no liability for any damage caused by any virus transmitted by e-mail. 
Please consider the environment before printing this e-mail message.
 
Avis de non-responsabilit? 
-------------------------------------- 
Ce message et toutes les pi?ces jointes sont ?tablis ? l'intention exclusive de leur destinataire et sont confidentiels. Si vous recevez ce message par erreur, veuillez le d?truire sans produire de copie papier ou ?lectronique, et avertir imm?diatement OPTrust par t?l?phone ou sans frais au 1-800-906-7738. Le destinataire doit s?assurer que ce message et toutes les pi?ces jointes ne contiennent pas de virus. OPTrust n?accepte aucune responsabilit? pour les dommages caus?s par d??ventuels virus transmis par courriel. 
Pensez ? l?environnement avant d?imprimer ce message. 


From josh.m.ulrich at gmail.com  Fri May 15 15:28:57 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 15 May 2015 08:28:57 -0500
Subject: [R-SIG-Finance] R/Finance 2015 registration now open
In-Reply-To: <CAPPM_gTqmfKkJUCQJE0Qemc3b=2bygaEGMFsU=H9dG1KY+493g@mail.gmail.com>
References: <CAPPM_gQy6u02RwGWCb77MhUvN5v4w_rVEeHFwGwmJU9c=OtqLQ@mail.gmail.com>
	<CAPPM_gTqmfKkJUCQJE0Qemc3b=2bygaEGMFsU=H9dG1KY+493g@mail.gmail.com>
Message-ID: <CAPPM_gTWFVrBNyUyc_wk-mN-AL7b1yPFO6k64ZtyZ_Mv-u=OOQ@mail.gmail.com>

Early-bird registration ends today!

On Fri, May 1, 2015 at 8:07 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> A friendly reminder that early-bird registration ends in two weeks, on
> Friday, May 15.  Make sure to register before then, when prices will
> increase by 50%.
>
> Also note that agenda details are available at:
>   http://www.RinFinance.com/agenda/
>
>
> On Tue, Mar 31, 2015 at 7:03 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
>> Registration for R/Finance 2015 is now open!
>>
>> The conference will take place on May 29 and 30, at UIC in Chicago.
>> Building on the success of the previous conferences in 2009-2014, we
>> expect more than 250 attendees from around the world. R users from
>> industry, academia, and government will joining 30+ presenters
>> covering all areas of finance with R.
>>
>> We are very excited about the four keynote presentations given by
>> Emanuel Derman, Louis Marascio, Alexander McNeil, and Rishi Narang.
>> The conference agenda (currently) includes 18 full presentations and
>> 19 shorter "lightning talks".  As in previous years, several
>> (optional) pre-conference seminars are offered on Friday morning.
>>
>> There is also an (optional) conference dinner at The Terrace at Trump
>> Hotel. Overlooking the Chicago river and skyline, it is a perfect
>> venue to continue conversations while dining and drinking.
>>
>> As they are finalized, agenda details are available at:
>>   http://www.RinFinance.com/agenda/
>>
>> Registration information is available at:
>>   http://www.RinFinance.com/register/
>>
>> and can also be directly accessed by going to:
>>   http://www.cvent.com/d/94q27k
>>
>> We would to thank our 2015 Sponsors for the continued support enabling us
>> to host such an exciting conference:
>>
>>   International Center for Futures and Derivatives at UIC
>>
>>   Revolution Analytics
>>   MS-Computational Finance and Risk Management at University of Washington
>>
>>   Ketchum Trading
>>   OneMarketData
>>   RStudio
>>   SYMMS
>>
>> On behalf of the committee and sponsors, we look forward to seeing you
>> in Chicago!
>>
>>   Gib Bassett, Peter Carl, Dirk Eddelbuettel, Brian Peterson,
>>   Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich
>>
>


-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From kunalshah305 at gmail.com  Sun May 17 06:54:59 2015
From: kunalshah305 at gmail.com (Kunal Shah)
Date: Sun, 17 May 2015 10:24:59 +0530
Subject: [R-SIG-Finance] Finding the strike price of an option from all
	other data
Message-ID: <CAOPdpkY=2rMUWW5c45SDuYizc2nTfc369KdWup-p2XN8iQvQWA@mail.gmail.com>

Hello,

If I have all the other data and if I need to find the strike price of an
option, some numerical technique needs to be applied

Can someone guide me how to do this?
One possible solution is
1: Initialise with some random strike
2: Use Black Scholes and find the price
3:Increase/Decrease the strike accordingly and do steps 1 and 2 until you
reach at the answer

I think some numerical techniques must be there to dot his

Regards

	[[alternative HTML version deleted]]


From saji.ren at hotmail.com  Sun May 17 16:00:45 2015
From: saji.ren at hotmail.com (LiuRR)
Date: Sun, 17 May 2015 14:00:45 +0000
Subject: [R-SIG-Finance] TickData Backtesting in R, is it able now?
Message-ID: <BAY179-W838299C8266BCDCAF8D7DD89C50@phx.gbl>

Hello,all:?

I'm new to R, I know that there is a package called quantmod which can perform some basic application in trading.?

I just want to now that: until now, is this quantmod package be able to do tick data trading backtesting??

If yes, I'm planning using more time and effort to learn. If not, maybe just try to use an other platform.?

Hope someone can answer.?

Thanks

PS.And I just check the website for quantmod...?

in the "what's next", here is the information:?

{ what's next }?
June 10, 2008?

1?.......
2?.......
......
5?More high frequency testing - possibly tick data
6?......

So I guess we still can not do such backtesting in R....?

Can anyone expericenced conform that??

thanks 		 	   		  

From brian at braverock.com  Sun May 17 16:17:28 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 17 May 2015 09:17:28 -0500
Subject: [R-SIG-Finance] TickData Backtesting in R, is it able now?
In-Reply-To: <BAY179-W838299C8266BCDCAF8D7DD89C50@phx.gbl>
References: <BAY179-W838299C8266BCDCAF8D7DD89C50@phx.gbl>
Message-ID: <5558A2F8.90306@braverock.com>

On 05/17/2015 09:00 AM, LiuRR wrote:
> I'm new to R, I know that there is a package called quantmod which can perform some basic application in trading.
>
> I just want to now that: until now, is this quantmod package be able to do tick data trading backtesting?
>
> If yes, I'm planning using more time and effort to learn. If not, maybe just try to use an other platform.
<...>
> PS.And I just check the website for quantmod...
>
> in the "what's next", here is the information:
>
> June 10, 2008
> 5?More high frequency testing - possibly tick data
>
> So I guess we still can not do such backtesting in R....
>
> Can anyone expericenced conform that?

R is widely used for backtesting strategies on high frequency data.

The 'model' part of quantmod was never very useful, and was abandoned 
many years ago.  It remains for historical reasons more than anything 
else at this point.

quantmod remains widely used for getSymbols and its charting functions.

You'd need to tell us more about what classes of strategies you plan to 
test, and where you plan to get tick data, before anyone could comment 
on which packages might be appropriate for your needs.

You can be comfortable that there are many people doing strategy 
development on tick data in R though.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From rvince99 at gmail.com  Sun May 17 19:25:52 2015
From: rvince99 at gmail.com (R Vince)
Date: Sun, 17 May 2015 13:25:52 -0400
Subject: [R-SIG-Finance] Finding the strike price of an option from all
 other data
In-Reply-To: <CAOPdpkY=2rMUWW5c45SDuYizc2nTfc369KdWup-p2XN8iQvQWA@mail.gmail.com>
References: <CAOPdpkY=2rMUWW5c45SDuYizc2nTfc369KdWup-p2XN8iQvQWA@mail.gmail.com>
Message-ID: <CAAHNhKUV1EUfQoOGxK-HFp4ruetP9jyopJPNQ2V2RLDcyNQ1cA@mail.gmail.com>

This would probably work nidely:

http://www.inside-r.org/packages/cran/pracma/docs/muller


On Sun, May 17, 2015 at 12:54 AM, Kunal Shah <kunalshah305 at gmail.com> wrote:

> Hello,
>
> If I have all the other data and if I need to find the strike price of an
> option, some numerical technique needs to be applied
>
> Can someone guide me how to do this?
> One possible solution is
> 1: Initialise with some random strike
> 2: Use Black Scholes and find the price
> 3:Increase/Decrease the strike accordingly and do steps 1 and 2 until you
> reach at the answer
>
> I think some numerical techniques must be there to dot his
>
> Regards
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From es at enricoschumann.net  Sun May 17 22:14:48 2015
From: es at enricoschumann.net (Enrico Schumann)
Date: Sun, 17 May 2015 22:14:48 +0200
Subject: [R-SIG-Finance] Finding the strike price of an option from all
	other data
In-Reply-To: <CAOPdpkY=2rMUWW5c45SDuYizc2nTfc369KdWup-p2XN8iQvQWA@mail.gmail.com>
	(Kunal Shah's message of "Sun, 17 May 2015 10:24:59 +0530")
References: <CAOPdpkY=2rMUWW5c45SDuYizc2nTfc369KdWup-p2XN8iQvQWA@mail.gmail.com>
Message-ID: <87lhgn3qrr.fsf@enricoschumann.net>

On Sun, 17 May 2015, Kunal Shah <kunalshah305 at gmail.com> writes:

> Hello,
>
> If I have all the other data and if I need to find the strike price of an
> option, some numerical technique needs to be applied
>
> Can someone guide me how to do this?
> One possible solution is
> 1: Initialise with some random strike
> 2: Use Black Scholes and find the price
> 3:Increase/Decrease the strike accordingly and do steps 1 and 2 until you
> reach at the answer
>
> I think some numerical techniques must be there to dot his
>
> Regards

What you look for is called "root finding" or "zero
finding". See ?uniroot .

-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From saji.ren at hotmail.com  Mon May 18 05:29:14 2015
From: saji.ren at hotmail.com (LiuRR)
Date: Mon, 18 May 2015 11:29:14 +0800
Subject: [R-SIG-Finance] =?utf-8?b?5Zue5aSNOiBUaWNrRGF0YSBCYWNrdGVzdGlu?=
 =?utf-8?q?g_in_R=2C_is_it_able_now=3F?=
Message-ID: <BAY403-EAS29423BF09E67C683002CD8189C40@phx.gbl>

brian?thank you for your reply.

I am a MT4 user, and plan to convert some scapling strategies to be used in china stock and futures market, which are not very fancy systems.:)
Briefly speaking, it's about using some DSP algos to confirm the low frequency trend condition, and find the entry/exit point in the high frequency...

The logic is pretty simple, but since there are no market dealer in china financial markets, the spreads in many markets are quite suitable. All that should be concerned is the slippage, which i planned to test in the forward testing.

So all i needed is a package which is able to allow my system to give the trading signals in relative high frequncey(not tick time), and can test the strategy in the tickdata...

As to the data, i have the tickdata resource and need not to get it through R package...

thanks
Saji

Sent from Huawei MediaPad

From saji.ren at hotmail.com  Tue May 19 03:10:24 2015
From: saji.ren at hotmail.com (Saji Ren)
Date: Mon, 18 May 2015 18:10:24 -0700 (PDT)
Subject: [R-SIG-Finance] =?utf-8?b?5Zue5aSNOiBUaWNrRGF0YSBCYWNrdGVzdGlu?=
 =?utf-8?q?g_in_R=2C_is_it_able_now=3F?=
In-Reply-To: <BAY403-EAS29423BF09E67C683002CD8189C40@phx.gbl>
References: <BAY403-EAS29423BF09E67C683002CD8189C40@phx.gbl>
Message-ID: <1431997824282-4707398.post@n4.nabble.com>

Hello,all:

Really hope someone could give me an advice of which R PACKAGE should i use.

Thank you



-----
------------------------------------------------------------------
Saji Ren
from Shanghai China
GoldenHeart Investment Group
------------------------------------------------------------------
--
View this message in context: http://r.789695.n4.nabble.com/TickData-Backtesting-in-R-is-it-able-now-tp4707376p4707398.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From john.b.williams at gmail.com  Tue May 19 03:45:35 2015
From: john.b.williams at gmail.com (John Williams)
Date: Mon, 18 May 2015 21:45:35 -0400
Subject: [R-SIG-Finance] strategy classes supported by quanstrat
Message-ID: <CAEeDWybMf8zwBmrUO4Y=W1bzqDHbsG=312xQwPhG+fWsyKwAgg@mail.gmail.com>

Hi ...

Is Quantstrat effective for backtesting stat arb strategies?

What are the limitations of backtesting with quantstrat?

Thank you

	[[alternative HTML version deleted]]


From ilya.kipnis at gmail.com  Tue May 19 03:50:05 2015
From: ilya.kipnis at gmail.com (Ilya Kipnis)
Date: Mon, 18 May 2015 21:50:05 -0400
Subject: [R-SIG-Finance] =?utf-8?b?5Zue5aSNOiBUaWNrRGF0YSBCYWNrdGVzdGlu?=
	=?utf-8?q?g_in_R=2C_is_it_able_now=3F?=
In-Reply-To: <1431997824282-4707398.post@n4.nabble.com>
References: <BAY403-EAS29423BF09E67C683002CD8189C40@phx.gbl>
	<1431997824282-4707398.post@n4.nabble.com>
Message-ID: <CA+oJuEFxsi1sEZWyen3bWe-A1s6zNO+nNi2QN1HYM13d=Vs_2g@mail.gmail.com>

For portfolio rebalancing strategies, PerformanceAnalytics is sufficient.

For signal-based strategies (EG buy when SMA 10 crosses SMA 50), use
quantstrat.

And yes, quantstrat can do pairs trading. But it's often (almost always)
better to model the spread as one instrument.

And for the record, quantstrat is used in professional research
environments. The R financial library ecosystem is more than sufficient for
basic applications.

On Mon, May 18, 2015 at 9:10 PM, Saji Ren <saji.ren at hotmail.com> wrote:

> Hello,all:
>
> Really hope someone could give me an advice of which R PACKAGE should i
> use.
>
> Thank you
>
>
>
> -----
> ------------------------------------------------------------------
> Saji Ren
> from Shanghai China
> GoldenHeart Investment Group
> ------------------------------------------------------------------
> --
> View this message in context:
> http://r.789695.n4.nabble.com/TickData-Backtesting-in-R-is-it-able-now-tp4707376p4707398.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From es at enricoschumann.net  Tue May 19 07:54:22 2015
From: es at enricoschumann.net (Enrico Schumann)
Date: Tue, 19 May 2015 07:54:22 +0200
Subject: [R-SIG-Finance] assetsLPM from fAssets and 0.moment
In-Reply-To: <CADhgW1f_LiyrycHwRE5bwLXC4oB35rOH6JDOSc7ubSf94Eqrbg@mail.gmail.com>
	(Nils Tobias Kramer's message of "Tue, 12 May 2015 12:29:03 +0200")
References: <CADhgW1f_LiyrycHwRE5bwLXC4oB35rOH6JDOSc7ubSf94Eqrbg@mail.gmail.com>
Message-ID: <87vbfp2ju9.fsf@enricoschumann.net>

On Tue, 12 May 2015, Nils Tobias Kramer <ntobiaskramer at gmail.com> writes:

> Hi there,
>
> I was wondering how to calculate LPMs in R. My interpretation of the
> 0.moment is somehow different from what I can see in fAssets:
>
> #using quantmod to get just any data
> getSymbols("IBM")
> x <- weeklyReturn(IBM)
> #using fAssets to calculate lpm, 0.order
> tau <- 0 #to make things easier
> assetsLPM(x,tau,0) #returns 1
> $mu
> weekly.returns
>              1
> $Sigma
>      [,1]
> [1,]    0
> attr(,"control")
>   a tau
>   0   0
>
> When I think of lpm 0 I think of the probability that my returns are below
> tau. This is what I expect let's say from Matlab.
>
> Code of assetsLPM:
> TauX <- Tau - x #0-x in my case
> X.max <- ((TauX) + abs(TauX))/2 #equals max(0,-returns), so either 0 for
> positive returns and for negative returns the absolute value of that return
> LPM <- colMeans(X.max^a)
>
> Checking what R does by ^0:
>> -1^0
> [1] -1
>> 0^0
> [1] 1
>> 1^0
> [1] 1
>
> I can see why the sum is expected to be 1 as there are only elements either
> 0 or positive which are taken to the power of 0 which equals 1 for each
> entry.
>
> Somehow I can't get my interpretation (probability) and the output of 1
> together. Maybe someone can help me out?
>
> Aside, this here confuses my a little:
> getSymbols("IBM")
> x <- weeklyReturn(IBM)
> y <- -x
> head(y^0)
>            weekly.returns
> 2007-01-05              1
> 2007-01-12              1
> 2007-01-19              1
> 2007-01-26              1
> 2007-02-02              1
> 2007-02-09              1
>> head(y)
>            weekly.returns
> 2007-01-05   -0.002469644
> 2007-01-12   -0.019708479
> 2007-01-19    0.031910610
> 2007-01-26   -0.013309764
> 2007-02-02   -0.017650077
> 2007-02-09    0.006251891
>
> Now all entries are 1 when taken to the power of 0 whereas I expected only
> the positive numbers to turn to 1 and the negative ones to -1!?
>
> Anyways, the first and second moments of assetsLPM are just what I
> expected, so I was wondering why I can't figure out the reason for the
> results of the 0. moment.
>
> Any insights?
>
> Thanks
> Toby

I am not sure I understand your question, or your questions. Since no
one else answered, let me venture two remarks.

First, on partial moments. The standard way to compute a partial moment
from a sample is this:

  (i) sum over all returns below tau and raise them to zeroth power (in
      your case). Any number below tau will map to one, and any number
      above tau will map to zero.

 (ii) divide this sum by the total number of observations. So, for
      instance, with 10 observations and 5 of them below tau, you will
      get 5/10 = 0.5, which is the empirical frequency of returns below
      tau in your sample. Hence the interpretation of probability.

Second, on raising negative numbers to the zeroth power: you need to
consider operator precendence. The "^" binds more tightly than "-",
hence

  -1^0

is -1. But 

  (-1)^0

will give 1.


-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From ntobiaskramer at gmail.com  Tue May 19 09:22:30 2015
From: ntobiaskramer at gmail.com (Nils Tobias Kramer)
Date: Tue, 19 May 2015 09:22:30 +0200
Subject: [R-SIG-Finance] assetsLPM from fAssets and 0.moment
In-Reply-To: <87vbfp2ju9.fsf@enricoschumann.net>
References: <CADhgW1f_LiyrycHwRE5bwLXC4oB35rOH6JDOSc7ubSf94Eqrbg@mail.gmail.com>
	<87vbfp2ju9.fsf@enricoschumann.net>
Message-ID: <01FE8050-B844-4B93-BBEC-1434F66B251A@gmail.com>

Hi Enrico,

thanks a lot for your answer. The precedence is key and was causing my confusion.

Because of the precedence the vector X.max raised to the power equals always 1, right? That's why the result for LPM0 is always one using assetsLPM:

> Code of assetsLPM:
> TauX <- Tau - x #0-x in my case
> X.max <- ((TauX) + abs(TauX))/2 #equals max(0,-returns), so either 0 for
> positive returns and for negative returns the absolute value of that return
> LPM <- colMeans(X.max^a)

X.max is a vector (assuming a single time series) where the entries are 0 whenever the return is above tau and a positive return (the absolute return) whenever the return is below the threshold tau.

So now these numbers are taken to the power on 0 and every single entry results in beeing converted to 1 in assestLPM. At least the way I used it and I was expecting (and you confirmed this) that only the returns below tau should be counted.

Thanks again
Toby

> On 19.05.2015, at 07:54, Enrico Schumann <es at enricoschumann.net> wrote:
> 
> On Tue, 12 May 2015, Nils Tobias Kramer <ntobiaskramer at gmail.com> writes:
> 
>> Hi there,
>> 
>> I was wondering how to calculate LPMs in R. My interpretation of the
>> 0.moment is somehow different from what I can see in fAssets:
>> 
>> #using quantmod to get just any data
>> getSymbols("IBM")
>> x <- weeklyReturn(IBM)
>> #using fAssets to calculate lpm, 0.order
>> tau <- 0 #to make things easier
>> assetsLPM(x,tau,0) #returns 1
>> $mu
>> weekly.returns
>>             1
>> $Sigma
>>     [,1]
>> [1,]    0
>> attr(,"control")
>>  a tau
>>  0   0
>> 
>> When I think of lpm 0 I think of the probability that my returns are below
>> tau. This is what I expect let's say from Matlab.
>> 
>> Code of assetsLPM:
>> TauX <- Tau - x #0-x in my case
>> X.max <- ((TauX) + abs(TauX))/2 #equals max(0,-returns), so either 0 for
>> positive returns and for negative returns the absolute value of that return
>> LPM <- colMeans(X.max^a)
>> 
>> Checking what R does by ^0:
>>> -1^0
>> [1] -1
>>> 0^0
>> [1] 1
>>> 1^0
>> [1] 1
>> 
>> I can see why the sum is expected to be 1 as there are only elements either
>> 0 or positive which are taken to the power of 0 which equals 1 for each
>> entry.
>> 
>> Somehow I can't get my interpretation (probability) and the output of 1
>> together. Maybe someone can help me out?
>> 
>> Aside, this here confuses my a little:
>> getSymbols("IBM")
>> x <- weeklyReturn(IBM)
>> y <- -x
>> head(y^0)
>>           weekly.returns
>> 2007-01-05              1
>> 2007-01-12              1
>> 2007-01-19              1
>> 2007-01-26              1
>> 2007-02-02              1
>> 2007-02-09              1
>>> head(y)
>>           weekly.returns
>> 2007-01-05   -0.002469644
>> 2007-01-12   -0.019708479
>> 2007-01-19    0.031910610
>> 2007-01-26   -0.013309764
>> 2007-02-02   -0.017650077
>> 2007-02-09    0.006251891
>> 
>> Now all entries are 1 when taken to the power of 0 whereas I expected only
>> the positive numbers to turn to 1 and the negative ones to -1!?
>> 
>> Anyways, the first and second moments of assetsLPM are just what I
>> expected, so I was wondering why I can't figure out the reason for the
>> results of the 0. moment.
>> 
>> Any insights?
>> 
>> Thanks
>> Toby
> 
> I am not sure I understand your question, or your questions. Since no
> one else answered, let me venture two remarks.
> 
> First, on partial moments. The standard way to compute a partial moment
> from a sample is this:
> 
>  (i) sum over all returns below tau and raise them to zeroth power (in
>      your case). Any number below tau will map to one, and any number
>      above tau will map to zero.
> 
> (ii) divide this sum by the total number of observations. So, for
>      instance, with 10 observations and 5 of them below tau, you will
>      get 5/10 = 0.5, which is the empirical frequency of returns below
>      tau in your sample. Hence the interpretation of probability.
> 
> Second, on raising negative numbers to the zeroth power: you need to
> consider operator precendence. The "^" binds more tightly than "-",
> hence
> 
>  -1^0
> 
> is -1. But 
> 
>  (-1)^0
> 
> will give 1.
> 
> 
> -- 
> Enrico Schumann
> Lucerne, Switzerland
> http://enricoschumann.net

	[[alternative HTML version deleted]]


From brian at braverock.com  Tue May 19 10:25:36 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 19 May 2015 03:25:36 -0500
Subject: [R-SIG-Finance] strategy classes supported by quanstrat
In-Reply-To: <CAEeDWybMf8zwBmrUO4Y=W1bzqDHbsG=312xQwPhG+fWsyKwAgg@mail.gmail.com>
References: <CAEeDWybMf8zwBmrUO4Y=W1bzqDHbsG=312xQwPhG+fWsyKwAgg@mail.gmail.com>
Message-ID: <555AF380.7090803@braverock.com>

On 05/18/2015 08:45 PM, John Williams wrote:
> Hi ...
>
> Is Quantstrat effective for backtesting stat arb strategies?

Yes.

You'll need to be a bit more specific about what type of stat arb you're 
talking about if you want more guidance.

"statistical arbitrage" is an awfully large category.

> What are the limitations of backtesting with quantstrat?

Isn't this spelled out pretty clearly in the documentation?

Put another way, you'll get more useful answers if you ask better questions:

http://www.catb.org/esr/faqs/smart-questions.html

Briefly, guessing at what you may be asking...

quantstrat models signal-based strategies in a path-dependent manner.

quantstrat also models orders.

**What are the implications of these two statements?**

If you don't want to do what I've described above, you should probably 
use a different backtesting approach.

quantstrat's path-dependent performance will be a nearly linear function 
of the number of signals (and consequently, the number of orders).

Strategies that derive much of their performance from microstructure 
will not be well-modeled by quantstrat, or any other backtesting 
framework which is available in open source or commercially, because 
these types of microstructure processes are inherently stochastic, and 
require a huge amount of historical data both on the market and on your 
execution history to model.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From stefano.iacus at unimi.it  Wed May 20 14:48:36 2015
From: stefano.iacus at unimi.it (stefano iacus)
Date: Wed, 20 May 2015 14:48:36 +0200
Subject: [R-SIG-Finance] COGARCH(p,
	q): Simulation and Inference with Yuima package
Message-ID: <B0E6D3B6-C821-4DDD-A25C-9ED0AA367384@unimi.it>

For those interested in trying Kluppelberg's & Brockwell's COGARCH models (Continuous GARCH model with L?vy noise), here is a paper which explains the new class of COGARCH(p,q) models available in R through the yuima package (http://cran.r-project.org/web/packages/yuima/) with several examples: 

http://arxiv.org/abs/1505.03914

Any comment and/or bug report is welcome.

kind regards
Stefano, Lorenzo and Edit




****************
Per destinare il 5x1000 all'Universita' degli Studi di Milano: indicare nella dichiarazione dei redditi il codice fiscale 80012650158.

http://www.unimi.it/13084.htm?utm_source=firmaMail&utm_medium=email&utm_content=linkFirmaEmail&utm_campaign=5xmille


From christianborelli at gmail.com  Thu May 21 21:51:47 2015
From: christianborelli at gmail.com (=?UTF-8?Q?Christian_Borelli=2DKj=C3=A6r?=)
Date: Thu, 21 May 2015 21:51:47 +0200
Subject: [R-SIG-Finance] RUGARCH - non-negativity constraints on
 coefficients for exogenous variables in GARCH?
Message-ID: <CAGpQzGShxSG2ykbMT_q5Q_C9--YyPs=+DE_PqNRBNKwk9J2+Vg@mail.gmail.com>

Hi all,

I am using the RUGARCH package to fit a GARCH model with three exogenous
variables, but I can only get positive, insignificant parameter estimates
for the exogenous variables.

This troubles me, as I have a strong hypothesis that the exogenous
variables should somehow be "volatility-lowering" - and thus affect the
conditional volatility in a negative way.

Does the package constrain coefficients for exogenous variables to be ? 0,
just as alpha and beta, or does it relax this assumption, corresponding to
e.g. He & Ter?svirta (1997) ?

Please do request code and data, if needed.

Thank you for your time,

Christian Borelli, University of Copenhagen

	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Thu May 21 22:05:46 2015
From: alexios at 4dscape.com (alexios)
Date: Thu, 21 May 2015 21:05:46 +0100
Subject: [R-SIG-Finance] RUGARCH - non-negativity constraints on
 coefficients for exogenous variables in GARCH?
In-Reply-To: <CAGpQzGShxSG2ykbMT_q5Q_C9--YyPs=+DE_PqNRBNKwk9J2+Vg@mail.gmail.com>
References: <CAGpQzGShxSG2ykbMT_q5Q_C9--YyPs=+DE_PqNRBNKwk9J2+Vg@mail.gmail.com>
Message-ID: <555E3A9A.3020109@4dscape.com>

Hi,

1. if the exogenous variables are in the conditional variance equation 
use the "eGARCH" model
2. use setbounds(spec)<-list(vxreg1=c(lower1, 
upper1),vxreg2=c(lower2,upper2),vxreg3=c(lower3,upper3))

with lower1, upper1 etc your custom bounds.

If you continue to have problems send me the code/data offlist and I 
will investigate.

Best,

Alexios

On 21/05/2015 20:51, Christian Borelli-Kj?r wrote:
> Hi all,
>
> I am using the RUGARCH package to fit a GARCH model with three exogenous
> variables, but I can only get positive, insignificant parameter estimates
> for the exogenous variables.
>
> This troubles me, as I have a strong hypothesis that the exogenous
> variables should somehow be "volatility-lowering" - and thus affect the
> conditional volatility in a negative way.
>
> Does the package constrain coefficients for exogenous variables to be ? 0,
> just as alpha and beta, or does it relax this assumption, corresponding to
> e.g. He & Ter?svirta (1997) ?
>
> Please do request code and data, if needed.
>
> Thank you for your time,
>
> Christian Borelli, University of Copenhagen
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From wen.songqiao at gmail.com  Mon May 25 04:47:49 2015
From: wen.songqiao at gmail.com (WEN SONG-QIAO)
Date: Mon, 25 May 2015 10:47:49 +0800
Subject: [R-SIG-Finance] How to extract the standardized residuals tests
	from the summary report
Message-ID: <CAHtPTVERfJ_PrKu4X5FbYpSOJOCfWE7-fsDwU4X6wyZogDdeAg@mail.gmail.com>

I am using the Rmarkdown to produce a  html slides automatically, and I
want to known
How to extract the standardized residuals tests section from the summary
report?

Here are the R-code:

>library("fGarch")
>N = 200
>x.vec = as.vector(garchSim(garchSpec(rseed = 1985), n = N)[,1])
>fit=garchFit(~ garch(1,1), data = x.vec, trace = FALSE)

> summary(fit)

Title:
 GARCH Modelling

Call:
 garchFit(formula = ~garch(1, 1), data = x.vec, trace = FALSE)

Mean and Variance Equation:
 data ~ garch(1, 1)
<environment: 0x000000002df6b330>
 [data = x.vec]

Conditional Distribution:
 norm

Coefficient(s):
        mu       omega      alpha1       beta1
3.5418e-05  1.0819e-06  8.8855e-02  8.1200e-01

Std. Errors:
 based on Hessian

Error Analysis:
        Estimate  Std. Error  t value Pr(>|t|)
mu     3.542e-05   2.183e-04    0.162    0.871
omega  1.082e-06   1.051e-06    1.030    0.303
alpha1 8.885e-02   5.450e-02    1.630    0.103
beta1  8.120e-01   1.242e-01    6.538 6.25e-11 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Log Likelihood:
 861.9494    normalized:  4.309747

Description:
 Mon May 25 09:10:52 2015 by user: WENSQ


Standardised Residuals Tests:
                                Statistic p-Value
 Jarque-Bera Test   R    Chi^2  1.114092  0.5728988
 Shapiro-Wilk Test  R    W      0.9932317 0.4911085
 Ljung-Box Test     R    Q(10)  7.303961  0.6964713
 Ljung-Box Test     R    Q(15)  8.712829  0.8920477
 Ljung-Box Test     R    Q(20)  9.766984  0.972203
 Ljung-Box Test     R^2  Q(10)  11.88455  0.2928573
 Ljung-Box Test     R^2  Q(15)  14.93927  0.4558006
 Ljung-Box Test     R^2  Q(20)  20.08937  0.4523516
 LM Arch Test       R    TR^2   11.57234  0.480607

Information Criterion Statistics:
      AIC       BIC       SIC      HQIC
-8.579494 -8.513527 -8.580273 -8.552798

-- 
---------------------------------------------------------------------------
*Dr.  WEN SONG-QIAO*
SHENZHEN UNIVERSITY
SHENZHEN,CHINA
---------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From jean-claude.ton at epfl.ch  Wed May 27 14:41:52 2015
From: jean-claude.ton at epfl.ch (Ton Jean-Claude)
Date: Wed, 27 May 2015 12:41:52 +0000
Subject: [R-SIG-Finance] Quadratic programming solve.QP's Lagrangians
Message-ID: <DAA3A5CDB0CAB949B9510AC017B7F5E0776B64C5@REXMC.intranet.epfl.ch>

Hi I am currently playing a little with Markowitz's portfolio optimization problem and from my computations I get that if we start from the following problem :

$$    \underset{w}{\arg \max} \quad w'r - \frac{\gamma}{2} w' Q w \quad \text{s.t}  \sum_i w_i=1, \quad w_i \geq 0\quad
$$

Then $\gamma$ should be of the form :
$$\gamma = \frac{w'(r-\beta)-\alpha}{w' \Sigma w},$$

where $\alpha$ is the Lagrangian multiplier due to the sum of weights being equal to one and $\beta$ the Lagrangian multipliers due to the no short selling condition.
Using `solve.QP` from the package `quadprog` I have coded the mean-variance formulation. And the function `ComputeRho` which you may find attached below computes the $\gamma$ (Sorry for the bad notations)


My problem is the following
depending on the r.a (risk aversion that is $\gamma$ in my case), `ComputeRho` gets me the correct answer or not.

    rm(list=ls())
        ###################################### begin : packages      ####################################
        require(tseries)
        require(quantmod)
        require(quadprog)
        require(MASS)
        require(PerformanceAnalytics)
        require(corpcor)
        require(quantmod)
        require(parallel)
        require(ggplot2)
        #require(mvtnorm)
        ###################################### end : packages  ######################################
        LogRet <- function(x,lag=5){
                #require(quantmod)
                #return(na.omit(apply(x,2,function(x) Delt(x,k=lag))) )
                require(zoo)
                return(na.omit(diff(log(x),lag=lag)))
        }
        ##########################################################################
        # Input :        sol = solution from solve.qp
        #                lr = logreturns
        # Output :      rho
        ComputeRho<-function(sol,lr){
                lr<-as.matrix(lr)
                alpha<-sol$lagrange_mults[1] # Lagrangian due to normalizing constraint
                beta<-sol$lagrange_mults[2:length(sol$lagrange_mults)] # Lagrangians due to no short sell constraint

                weights<-sol$weights
                cov.mat<-cov(lr)
                # unconstrained form
                uncons <-(t(weights)%*%colMeans(lr))/(t(weights)%*%cov.mat%*%weights)
                # due to Lagrangian multipliers
                cons1 <- (t(weights)%*%beta)/(t(weights)%*%cov.mat%*%weights)
                cons2 <- alpha/(t(weights)%*%cov.mat%*%weights)
                cons<-cons1+cons2

                rho<-uncons+cons # lagrangians change sign...
                rho
        }


        ############################################################
        # Input :       data = usually logreturns
        #               r.aversion = risk aversion coefficient usually between 1 to 10
        # Output :      er = expected return
        #               sd = standard deviation
        #               weights = weights
        #               Lagrangians = Lagrange multipliers

        MeanVariance<-function(data,r.aversion=10,method="MeanVariance")
        {
                # compute probability beliefs mean and risk ( here sample covariance)
                er<-colMeans(data)
                cov.mat<-cov(data)
                # get length of data
                n_asset <- length(er)

                # quad problem
                Dmat <- r.aversion*as.matrix(cov.mat)
                dvec <- er
                meq <-  1

                bvec <- c(1, rep(0,n_asset))
                Amat <- matrix( c(rep(1,n_asset), diag(nrow=n_asset)), nrow=n_asset)

                sol<-solve.QP(Dmat, dvec,Amat, bvec=bvec, meq=meq)

                # fetch returns from solve.QP
                weights<-sol$solution
                exp.ret <- t(er)%*%weights
                std.dev <- sqrt(weights %*% cov.mat %*% weights)

                # return results
                ret <- list(er = as.vector(exp.ret),
                            sd = as.vector(std.dev),
                            weights = weights,
                            lagrange_mults=sol$Lagrangian,
                            weights2=sol$unconstrained.solution)

        }
        # load asset prices
        data <- read.table("~/data.csv", header=TRUE, quote="\"")
        # risk aversion
        r.a<- 17 # for values below 18 r.a is different from rho
        lr<-LogRet(as.matrix(data))

        sol<-MeanVariance(lr,r.aversion = r.a)
        rho<-ComputeRho(sol,lr)
        rho

        r.a2<- 18 # for values below 18 r.a is different from rho
        sol2<-MeanVariance(lr,r.aversion = r.a2)
        rho2<-ComputeRho(sol2,lr)
        rho2


I was able to cern the problem to the sign of the Lagranians (here `cons1` and `cons2` in `ComputeRho` ) which switch signs depending on the `r.a.` I choose.

Does someone knows how the Lagrangians are computed explicitly ? Since It seems that this is done in FORTRAN.

Best,
Jc

here is the data set
https://www.dropbox.com/s/ynlnmdgfm9w4rq0/data.csv?dl=0

	[[alternative HTML version deleted]]


From bobjansen at gmail.com  Wed May 27 16:49:01 2015
From: bobjansen at gmail.com (Bob Jansen)
Date: Wed, 27 May 2015 16:49:01 +0200
Subject: [R-SIG-Finance] Quadratic programming solve.QP's Lagrangians
In-Reply-To: <DAA3A5CDB0CAB949B9510AC017B7F5E0776B64C5@REXMC.intranet.epfl.ch>
References: <DAA3A5CDB0CAB949B9510AC017B7F5E0776B64C5@REXMC.intranet.epfl.ch>
Message-ID: <CACnz3bzSwdzm5Lw7U_d+FnhHFGM-xFyictJSKfWzfq31vyeffw@mail.gmail.com>

Hi,

Careful this does rm(list=ls()) and has been cross posted to Quant.SE:

http://quant.stackexchange.com/q/17997/848

On Wed, May 27, 2015 at 2:41 PM, Ton Jean-Claude <jean-claude.ton at epfl.ch>
wrote:

> Hi I am currently playing a little with Markowitz's portfolio optimization
> problem and from my computations I get that if we start from the following
> problem :
>
> $$    \underset{w}{\arg \max} \quad w'r - \frac{\gamma}{2} w' Q w \quad
> \text{s.t}  \sum_i w_i=1, \quad w_i \geq 0\quad
> $$
>
> Then $\gamma$ should be of the form :
> $$\gamma = \frac{w'(r-\beta)-\alpha}{w' \Sigma w},$$
>
> where $\alpha$ is the Lagrangian multiplier due to the sum of weights
> being equal to one and $\beta$ the Lagrangian multipliers due to the no
> short selling condition.
> Using `solve.QP` from the package `quadprog` I have coded the
> mean-variance formulation. And the function `ComputeRho` which you may find
> attached below computes the $\gamma$ (Sorry for the bad notations)
>
>
> My problem is the following
> depending on the r.a (risk aversion that is $\gamma$ in my case),
> `ComputeRho` gets me the correct answer or not.
>
>     rm(list=ls())
>         ###################################### begin : packages
> ####################################
>         require(tseries)
>         require(quantmod)
>         require(quadprog)
>         require(MASS)
>         require(PerformanceAnalytics)
>         require(corpcor)
>         require(quantmod)
>         require(parallel)
>         require(ggplot2)
>         #require(mvtnorm)
>         ###################################### end : packages
> ######################################
>         LogRet <- function(x,lag=5){
>                 #require(quantmod)
>                 #return(na.omit(apply(x,2,function(x) Delt(x,k=lag))) )
>                 require(zoo)
>                 return(na.omit(diff(log(x),lag=lag)))
>         }
>
> ##########################################################################
>         # Input :        sol = solution from solve.qp
>         #                lr = logreturns
>         # Output :      rho
>         ComputeRho<-function(sol,lr){
>                 lr<-as.matrix(lr)
>                 alpha<-sol$lagrange_mults[1] # Lagrangian due to
> normalizing constraint
>                 beta<-sol$lagrange_mults[2:length(sol$lagrange_mults)] #
> Lagrangians due to no short sell constraint
>
>                 weights<-sol$weights
>                 cov.mat<-cov(lr)
>                 # unconstrained form
>                 uncons
> <-(t(weights)%*%colMeans(lr))/(t(weights)%*%cov.mat%*%weights)
>                 # due to Lagrangian multipliers
>                 cons1 <-
> (t(weights)%*%beta)/(t(weights)%*%cov.mat%*%weights)
>                 cons2 <- alpha/(t(weights)%*%cov.mat%*%weights)
>                 cons<-cons1+cons2
>
>                 rho<-uncons+cons # lagrangians change sign...
>                 rho
>         }
>
>
>         ############################################################
>         # Input :       data = usually logreturns
>         #               r.aversion = risk aversion coefficient usually
> between 1 to 10
>         # Output :      er = expected return
>         #               sd = standard deviation
>         #               weights = weights
>         #               Lagrangians = Lagrange multipliers
>
>         MeanVariance<-function(data,r.aversion=10,method="MeanVariance")
>         {
>                 # compute probability beliefs mean and risk ( here sample
> covariance)
>                 er<-colMeans(data)
>                 cov.mat<-cov(data)
>                 # get length of data
>                 n_asset <- length(er)
>
>                 # quad problem
>                 Dmat <- r.aversion*as.matrix(cov.mat)
>                 dvec <- er
>                 meq <-  1
>
>                 bvec <- c(1, rep(0,n_asset))
>                 Amat <- matrix( c(rep(1,n_asset), diag(nrow=n_asset)),
> nrow=n_asset)
>
>                 sol<-solve.QP(Dmat, dvec,Amat, bvec=bvec, meq=meq)
>
>                 # fetch returns from solve.QP
>                 weights<-sol$solution
>                 exp.ret <- t(er)%*%weights
>                 std.dev <- sqrt(weights %*% cov.mat %*% weights)
>
>                 # return results
>                 ret <- list(er = as.vector(exp.ret),
>                             sd = as.vector(std.dev),
>                             weights = weights,
>                             lagrange_mults=sol$Lagrangian,
>                             weights2=sol$unconstrained.solution)
>
>         }
>         # load asset prices
>         data <- read.table("~/data.csv", header=TRUE, quote="\"")
>         # risk aversion
>         r.a<- 17 # for values below 18 r.a is different from rho
>         lr<-LogRet(as.matrix(data))
>
>         sol<-MeanVariance(lr,r.aversion = r.a)
>         rho<-ComputeRho(sol,lr)
>         rho
>
>         r.a2<- 18 # for values below 18 r.a is different from rho
>         sol2<-MeanVariance(lr,r.aversion = r.a2)
>         rho2<-ComputeRho(sol2,lr)
>         rho2
>
>
> I was able to cern the problem to the sign of the Lagranians (here `cons1`
> and `cons2` in `ComputeRho` ) which switch signs depending on the `r.a.` I
> choose.
>
> Does someone knows how the Lagrangians are computed explicitly ? Since It
> seems that this is done in FORTRAN.
>
> Best,
> Jc
>
> here is the data set
> https://www.dropbox.com/s/ynlnmdgfm9w4rq0/data.csv?dl=0
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Met vriendelijke groeten,

Bob Jansen

	[[alternative HTML version deleted]]


From student.northwestern at gmail.com  Sat May 30 03:47:25 2015
From: student.northwestern at gmail.com (E Pan)
Date: Fri, 29 May 2015 21:47:25 -0400
Subject: [R-SIG-Finance] chart_Series.R question
Message-ID: <CACAe89z40BfC2r72ncnr_QtBb+L7K6B6dfZzWsvw_QgSTreY7g@mail.gmail.com>

Dear list,
up.col=NA, is in the default argument for chart_theme,
this causes ohlc charts to be incorrectly drawn with chart_Series(up
bars won't show up)

any idea why it is set to NA as default?

I am exploring options to color each bar in ohlc charts per value of
technical indicators. am I in the right direction in exploring
chart_Series.R?

Thanks List!!
Jim


From daneedwards1 at hotmail.com  Mon Jun  1 23:00:29 2015
From: daneedwards1 at hotmail.com (bearwithme)
Date: Mon, 1 Jun 2015 14:00:29 -0700 (PDT)
Subject: [R-SIG-Finance] Quantstrat for backtesting on tickdata (and
 creating a spread from tick)
Message-ID: <1433192429030-4708020.post@n4.nabble.com>

Hi, could someone please point me in the right direction. It can be high
level and i can do the research (which have already done but i seem to be
going around in circles right now haha)

I have tick data for two instruments bid/vol & ask/vol.

Example data : Bid for BRN0615 (Brent june 2015)
20150421 175951;61.87;4
20150421 175955;61.87;3
20150421 175955;61.87;1

1) I would like create a spread between 2 instruments using this tick data.
(can fn_spreadbuilder do this?)

spread ask = BRN0615(ask) - (BRNS120615(bid) *3)
spread bid = BRN0615(bid) - (BRNS120615(ask) *3)

2) unfortunately in the tick data some of the date rows have duplicate time
stamps (i hope to get better data) is there a way of dealing with this
(without going to 1 second data).

3) once i have the spread, it will be in bid/ask format still, I know how to
access the columns in quanstrat using $columnname but what is the best way
to get it a certain format?


** my strategy will use the bid and ask of the resulting spread, when the
ask goes below a certain level i will long, when the bid goes above a
certain level i will go short (mean reversion). 

thanks!! 




--
View this message in context: http://r.789695.n4.nabble.com/Quantstrat-for-backtesting-on-tickdata-and-creating-a-spread-from-tick-tp4708020.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From gmonaie at gmail.com  Tue Jun  2 06:07:23 2015
From: gmonaie at gmail.com (Gei Lin)
Date: Tue, 2 Jun 2015 00:07:23 -0400
Subject: [R-SIG-Finance] RFC: plot.xts
In-Reply-To: <1429804347.14129.48.camel@brian-rcg.priv.dvtrading.co>
References: <CAPPM_gSdHSSTQrh50FKCgD_1DPGoXgWMZwPUMktjr+e=Z2KYEw@mail.gmail.com>
	<2127729524.3513265.1429803199084.JavaMail.yahoo@mail.yahoo.com>
	<1429804347.14129.48.camel@brian-rcg.priv.dvtrading.co>
Message-ID: <CAJFvkcdkCANkSxf3hEEQA3KFpjCjE8vDP_U8iZxQ1==yuYO3nA@mail.gmail.com>

Is there a method available to set a log axis in for a panels with
plot.xts? Like the PerformanceAnalytics::chart.TimeSeries call to
plot.window()

2015-04-23 11:52 GMT-04:00 Brian G. Peterson <brian at braverock.com>:

> On Thu, 2015-04-23 at 15:33 +0000, Paul Teetor via R-SIG-Finance wrote:
> > Josh:
> > First, many thanks to everyone for this work. I've seen some
> > preliminary results, and they look wonderful.
> > Second, some questions before I dive in:
> > Does this subsume the xtsExtra package of plotting functions? Do we
> > still need xtsExtra, or is that toast?
>
> plot.xts will be removed from xtsExtra in the near future.  Yes,
> plot.xts and supporting function now in xts-proper supercede the
> plot.xts in xtsExtra.
>
>
> > How would you recommend installing this? By devtools::install_github,
> > for example?
>
> install_github is a fine approach
>
> install_github('joshuaulrich/xts')
>
>
> > Finally, I depend critically on xts for daily work. Does this beta
> > release impact the non-graphics code?
>
> We use this code for production-critical tasks every day.
>
> The core of xts has the usual smattering of optimizations and bug fixes,
> and has not changed substantially from a user perspective.
>
> plot.xts is substantially different from the old plot.xts, but the old
> plot.xts didn't do much, which is why most users used chartSeries or
> plot.zoo.
>
> > What's the appropriate level of caution here?
>
> As always, YMMV, but this code has been under development and in use for
> over a year, and I at least consider it stable and ready for prime time.
>
> Regards,
>
> Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
*Don't quit. Suffer now and live the rest of your life as a champion.*
                                ? Muhammad Ali
*The world is full of obvious things which nobody by any chance observes.*
                                ? Sir Arthur Conan Doyle

	[[alternative HTML version deleted]]


From roger.bos at rothschild.com  Tue Jun  2 21:17:53 2015
From: roger.bos at rothschild.com (Bos, Roger)
Date: Tue, 2 Jun 2015 19:17:53 +0000
Subject: [R-SIG-Finance] Getting started with blotter (adding transactions)
Message-ID: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>

All,

I am trying to learn how to use the blotter package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second.
I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get:

> # Add some transactions
> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)
[1] "2015-05-13 00:00:00 EWJ 328 @ 30.51"
Warning messages:
1: In getInstrument(Symbol) :
  instrument EWJ not found, please create it first.
2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  :
  Instrument EWJ  not found, using contract multiplier of 1
> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)
Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
  unused argument (n = n)
>

****

require(xts)
require(quantmod)
require(blotter)

Sys.setenv(TZ="EST")

# xts object must be created with explicit index class:
initDate <- '2000-01-01'
getSymbols('SPY', from=initDate, index.class=c("POSIXt","POSIXct"))

portfolio <- "bos"
account <- "acct"
initEq <- 0

# When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this:
rm(list=ls(envir=.blotter), envir = .blotter)

# Add some symbols
sym <- c("EWJ","EWI")
initPortf(name=portfolio, sym, initDate = initDate)
initAcct(account,portfolios=c(portfolio), initDate = initDate, initEq = initEq)

# Add some transactions
addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)
addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)




***************************************************************
This message and any attachments are for the named person's use only.
This message may contain confidential, proprietary or legally privileged
information. No right to confidential or privileged treatment
of this message is waived or lost by an error in transmission.
If you have received this message in error, please immediately
notify the sender by e-mail, delete the message, any attachments and all
copies from your system and destroy any hard copies. You must
not, directly or indirectly, use, disclose, distribute,
print or copy any part of this message or any attachments if you are not
the intended recipient.



From peter at returnandrisk.com  Wed Jun  3 05:20:01 2015
From: peter at returnandrisk.com (Peter Chan)
Date: Wed, 03 Jun 2015 03:20:01 +0000
Subject: [R-SIG-Finance] Getting started with blotter (adding
 transactions)
In-Reply-To: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
Message-ID: <14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>

Hi Roger

There's an example in the help pages under the "blotter-package" entry.  You need to setup your instruments first eg

# Use the FinancialInstrument package to manage information about tradable 
# instruments
require(FinancialInstrument)
# Define a currency and a couple stocks
currency("USD")
symbols = c("EWJ","EWI")
for(symbol in symbols){ # establish tradable instruments
    stock(symbol, currency="USD", multiplier=1)
}

Thanks

Peter
www.returnandrisk.com



---- On Tue, 02 Jun 2015 19:17:53 +0000  Bos<roger.bos at rothschild.com> wrote ---- 
 > All, 
 >  
 > I am trying to learn how to use the blotter package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second. 
 > I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get: 
 >  
 > > # Add some transactions 
 > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE) 
 > [1] "2015-05-13 00:00:00 EWJ 328 @ 30.51" 
 > Warning messages: 
 > 1: In getInstrument(Symbol) : 
 >   instrument EWJ not found, please create it first. 
 > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  : 
 >   Instrument EWJ  not found, using contract multiplier of 1 
 > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE) 
 > Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) : 
 >   unused argument (n = n) 
 > > 
 >  
 > **** 
 >  
 > require(xts) 
 > require(quantmod) 
 > require(blotter) 
 >  
 > Sys.setenv(TZ="EST") 
 >  
 > # xts object must be created with explicit index class: 
 > initDate <- '2000-01-01' 
 > getSymbols('SPY', from=initDate, index.class=c("POSIXt","POSIXct")) 
 >  
 > portfolio <- "bos" 
 > account <- "acct" 
 > initEq <- 0 
 >  
 > # When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this: 
 > rm(list=ls(envir=.blotter), envir = .blotter) 
 >  
 > # Add some symbols 
 > sym <- c("EWJ","EWI") 
 > initPortf(name=portfolio, sym, initDate = initDate) 
 > initAcct(account,portfolios=c(portfolio), initDate = initDate, initEq = initEq) 
 >  
 > # Add some transactions 
 > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE) 
 > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE) 
 >  
 >  
 >  
 >  
 > *************************************************************** 
 > This message and any attachments are for the named person's use only. 
 > This message may contain confidential, proprietary or legally privileged 
 > information. No right to confidential or privileged treatment 
 > of this message is waived or lost by an error in transmission. 
 > If you have received this message in error, please immediately 
 > notify the sender by e-mail, delete the message, any attachments and all 
 > copies from your system and destroy any hard copies. You must 
 > not, directly or indirectly, use, disclose, distribute, 
 > print or copy any part of this message or any attachments if you are not 
 > the intended recipient. 
 >  
 >  
 > _______________________________________________ 
 > R-SIG-Finance at r-project.org mailing list 
 > https://stat.ethz.ch/mailman/listinfo/r-sig-finance 
 > -- Subscriber-posting only. If you want to post, subscribe first. 
 > -- Also note that this is not the r-help list where general R questions should go. 
 >


From bogaso.christofer at gmail.com  Wed Jun  3 05:55:07 2015
From: bogaso.christofer at gmail.com (Christofer Bogaso)
Date: Wed, 3 Jun 2015 09:25:07 +0530
Subject: [R-SIG-Finance] Portfolio VaR and Asset VaR
Message-ID: <CA+dpOJkagVCW+zKZucOE7V6KzC1No4SeuqMJs7qV56wCPOh2hA@mail.gmail.com>

Hi again,

Let say I have a diversified portfolio of 5 assets. The individual
Asset VaRs for them are $A, $B, $C, $D, & $E. And the overall
portfolio VaR is $P. Assumed all VaR numbers are reported in absolute
number

It appears that P is less than all 5 individual VaRs.

Can that happen? I know that P < (A+B+C+D+E). However here in my
calculation what happened is P is less than each asset VaR.

Appreciate your view.

Thanks and regards,


From jan.annaert at uantwerpen.be  Wed Jun  3 11:43:40 2015
From: jan.annaert at uantwerpen.be (Annaert Jan)
Date: Wed, 3 Jun 2015 09:43:40 +0000
Subject: [R-SIG-Finance] Portfolio VaR and Asset VaR
In-Reply-To: <CA+dpOJkagVCW+zKZucOE7V6KzC1No4SeuqMJs7qV56wCPOh2hA@mail.gmail.com>
References: <CA+dpOJkagVCW+zKZucOE7V6KzC1No4SeuqMJs7qV56wCPOh2hA@mail.gmail.com>
Message-ID: <D19498B2.2BE77%jan.annaert@ua.ac.be>

I think this is perfectly possible. For instance, if A to E are individual
stocks and P is, say, an equally weighted portfolio of these stocks. If
firm-specific risk is high relative to systematic risk (which is typical),
firm-specific risk may be to a large extent diversified away in P. As a
consequence, VaR of P may be (much) smaller than each of the individual
VaRs.
HTH,


Jan Annaert

UNIVERSITEITANTWERPEN | Faculty of Applied Economics (TEW) | Dept.
Accounting & Finance
Room  S.B.335 | Prinsstraat 13 | B-2000 Antwerp  | Belgium
Phone +32 32654163 |Fax +32 32654064
https://www.uantwerp.be/en/staff/jan-annaert/
http://ssrn.com/author=143473



From:  Christofer Bogaso <bogaso.christofer at gmail.com>
Date:  woensdag 3 juni 2015 05:55
To:  "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject:  [R-SIG-Finance] Portfolio VaR and Asset VaR


Hi again,

Let say I have a diversified portfolio of 5 assets. The individual
Asset VaRs for them are $A, $B, $C, $D, & $E. And the overall
portfolio VaR is $P. Assumed all VaR numbers are reported in absolute
number

It appears that P is less than all 5 individual VaRs.

Can that happen? I know that P < (A+B+C+D+E). However here in my
calculation what happened is P is less than each asset VaR.

Appreciate your view.

Thanks and regards,

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From brian at braverock.com  Wed Jun  3 12:00:48 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 03 Jun 2015 05:00:48 -0500
Subject: [R-SIG-Finance] Portfolio VaR and Asset VaR
In-Reply-To: <D19498B2.2BE77%jan.annaert@ua.ac.be>
References: <CA+dpOJkagVCW+zKZucOE7V6KzC1No4SeuqMJs7qV56wCPOh2hA@mail.gmail.com>
	<D19498B2.2BE77%jan.annaert@ua.ac.be>
Message-ID: <556ED050.1020406@braverock.com>

Jan is correct.  Value at Risk does not have the property of being 
'coherent' in the sense described in Artzner's papers.

R does have a coherent portfolio VaR available.  You can call 
portfolio_method='component' in the VaR function in PerformanceAnalytics 
which will give you the portfolio VaR and how much each asset 
contributes to the overall portfolio VaR.

Regards,

Brian


On 06/03/2015 04:43 AM, Annaert Jan wrote:
> I think this is perfectly possible. For instance, if A to E are individual
> stocks and P is, say, an equally weighted portfolio of these stocks. If
> firm-specific risk is high relative to systematic risk (which is typical),
> firm-specific risk may be to a large extent diversified away in P. As a
> consequence, VaR of P may be (much) smaller than each of the individual
> VaRs.
> HTH,
>
>
> Jan Annaert
>
> From:  Christofer Bogaso <bogaso.christofer at gmail.com>
> Date:  woensdag 3 juni 2015 05:55
>
> Let say I have a diversified portfolio of 5 assets. The individual
> Asset VaRs for them are $A, $B, $C, $D, & $E. And the overall
> portfolio VaR is $P. Assumed all VaR numbers are reported in absolute
> number
>
> It appears that P is less than all 5 individual VaRs.
>
> Can that happen? I know that P < (A+B+C+D+E). However here in my
> calculation what happened is P is less than each asset VaR.
>
> Appreciate your view.
>
> Thanks and regards,


From gttga2000 at yahoo.com  Wed Jun  3 12:20:24 2015
From: gttga2000 at yahoo.com (AIE ATUMA)
Date: Wed, 3 Jun 2015 10:20:24 +0000 (UTC)
Subject: [R-SIG-Finance] Portfolio VaR and Asset VaR
In-Reply-To: <556ED050.1020406@braverock.com>
References: <556ED050.1020406@braverock.com>
Message-ID: <63959132.2097386.1433326825022.JavaMail.yahoo@mail.yahoo.com>

Dear Brian,
The Portfolio VaR is expected to be lower than the sum of the individual asset VaRs. This is made possible due to correlation between the individual assets.?Thank You and Best Regards,

Emeka .I. A
Integrity is work your talk don't talk your work 


     On Wednesday, 3 June 2015, 11:03, Brian G. Peterson <brian at braverock.com> wrote:
   

 Jan is correct.? Value at Risk does not have the property of being 
'coherent' in the sense described in Artzner's papers.

R does have a coherent portfolio VaR available.? You can call 
portfolio_method='component' in the VaR function in PerformanceAnalytics 
which will give you the portfolio VaR and how much each asset 
contributes to the overall portfolio VaR.

Regards,

Brian


On 06/03/2015 04:43 AM, Annaert Jan wrote:
> I think this is perfectly possible. For instance, if A to E are individual
> stocks and P is, say, an equally weighted portfolio of these stocks. If
> firm-specific risk is high relative to systematic risk (which is typical),
> firm-specific risk may be to a large extent diversified away in P. As a
> consequence, VaR of P may be (much) smaller than each of the individual
> VaRs.
> HTH,
>
>
> Jan Annaert
>
> From:? Christofer Bogaso <bogaso.christofer at gmail.com>
> Date:? woensdag 3 juni 2015 05:55
>
> Let say I have a diversified portfolio of 5 assets. The individual
> Asset VaRs for them are $A, $B, $C, $D, & $E. And the overall
> portfolio VaR is $P. Assumed all VaR numbers are reported in absolute
> number
>
> It appears that P is less than all 5 individual VaRs.
>
> Can that happen? I know that P < (A+B+C+D+E). However here in my
> calculation what happened is P is less than each asset VaR.
>
> Appreciate your view.
>
> Thanks and regards,

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


  
	[[alternative HTML version deleted]]


From theseth.prashant at gmail.com  Wed Jun  3 12:34:09 2015
From: theseth.prashant at gmail.com (Prashant Sethi)
Date: Wed, 3 Jun 2015 16:04:09 +0530
Subject: [R-SIG-Finance] Portfolio VaR and Asset VaR
In-Reply-To: <63959132.2097386.1433326825022.JavaMail.yahoo@mail.yahoo.com>
References: <556ED050.1020406@braverock.com>
	<63959132.2097386.1433326825022.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAM04ykCr2yvp_zAh2e7YyhfOwrS8gJ_2_=hm9u27Lp9HMJA0QQ@mail.gmail.com>

Any portfolio on the efficient frontier will have the least variance for a
given expected return, however not necessarily less than each individual
asset.

One such efficient portfolio is known as the global minimum portfolio. This
global minimum portfolio has the portfolio variance (thus portfolio VaR) as
the lowest possible variance, which is less than each of the individual
assets in the portfolio, provided there is no restriction on short
condition of assets.

Thanks and regards,
Prashant Sethi
 On 3 Jun 2015 15:51, "AIE ATUMA via R-SIG-Finance" <
r-sig-finance at r-project.org> wrote:

> Dear Brian,
> The Portfolio VaR is expected to be lower than the sum of the individual
> asset VaRs. This is made possible due to correlation between the individual
> assets. Thank You and Best Regards,
>
> Emeka .I. A
> Integrity is work your talk don't talk your work
>
>
>      On Wednesday, 3 June 2015, 11:03, Brian G. Peterson <
> brian at braverock.com> wrote:
>
>
>  Jan is correct.  Value at Risk does not have the property of being
> 'coherent' in the sense described in Artzner's papers.
>
> R does have a coherent portfolio VaR available.  You can call
> portfolio_method='component' in the VaR function in PerformanceAnalytics
> which will give you the portfolio VaR and how much each asset
> contributes to the overall portfolio VaR.
>
> Regards,
>
> Brian
>
>
> On 06/03/2015 04:43 AM, Annaert Jan wrote:
> > I think this is perfectly possible. For instance, if A to E are
> individual
> > stocks and P is, say, an equally weighted portfolio of these stocks. If
> > firm-specific risk is high relative to systematic risk (which is
> typical),
> > firm-specific risk may be to a large extent diversified away in P. As a
> > consequence, VaR of P may be (much) smaller than each of the individual
> > VaRs.
> > HTH,
> >
> >
> > Jan Annaert
> >
> > From:  Christofer Bogaso <bogaso.christofer at gmail.com>
> > Date:  woensdag 3 juni 2015 05:55
> >
> > Let say I have a diversified portfolio of 5 assets. The individual
> > Asset VaRs for them are $A, $B, $C, $D, & $E. And the overall
> > portfolio VaR is $P. Assumed all VaR numbers are reported in absolute
> > number
> >
> > It appears that P is less than all 5 individual VaRs.
> >
> > Can that happen? I know that P < (A+B+C+D+E). However here in my
> > calculation what happened is P is less than each asset VaR.
> >
> > Appreciate your view.
> >
> > Thanks and regards,
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

	[[alternative HTML version deleted]]


From peter at returnandrisk.com  Wed Jun  3 12:48:03 2015
From: peter at returnandrisk.com (Peter Chan)
Date: Wed, 03 Jun 2015 10:48:03 +0000
Subject: [R-SIG-Finance] Portfolio VaR and Asset VaR
In-Reply-To: <63959132.2097386.1433326825022.JavaMail.yahoo@mail.yahoo.com>
References: <556ED050.1020406@braverock.com>
	<63959132.2097386.1433326825022.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <14db8ff8562.dffe2b7b200679.4965418265992617584@returnandrisk.com>

Actually in some cases portfolio VaR may be greater than the sum of the individual VaRs. Hence it doesn't have the property of being sub-additive, and is not a coherent risk measure.

There's an example on wikipedia

http://en.wikipedia.org/wiki/Coherent_risk_measure

Thanks

Peter
www.returnandrisk.com



---- On Wed, 03 Jun 2015 10:20:24 +0000 AIE ATUMA via R-SIG-Finance<r-sig-finance at r-project.org> wrote ---- 
 > Dear Brian,
 > The Portfolio VaR is expected to be lower than the sum of the individual asset VaRs. This is made possible due to correlation between the individual assets. Thank You and Best Regards,
 > 
 > Emeka .I. A
 > Integrity is work your talk don't talk your work 
 > 
 > 
 > On Wednesday, 3 June 2015, 11:03, Brian G. Peterson <brian at braverock.com> wrote:
 > 
 > 
 > Jan is correct. Value at Risk does not have the property of being 
 > 'coherent' in the sense described in Artzner's papers.
 > 
 > R does have a coherent portfolio VaR available. You can call 
 > portfolio_method='component' in the VaR function in PerformanceAnalytics 
 > which will give you the portfolio VaR and how much each asset 
 > contributes to the overall portfolio VaR.
 > 
 > Regards,
 > 
 > Brian
 > 
 > 
 > On 06/03/2015 04:43 AM, Annaert Jan wrote:
 > > I think this is perfectly possible. For instance, if A to E are individual
 > > stocks and P is, say, an equally weighted portfolio of these stocks. If
 > > firm-specific risk is high relative to systematic risk (which is typical),
 > > firm-specific risk may be to a large extent diversified away in P. As a
 > > consequence, VaR of P may be (much) smaller than each of the individual
 > > VaRs.
 > > HTH,
 > >
 > >
 > > Jan Annaert
 > >
 > > From: Christofer Bogaso <bogaso.christofer at gmail.com>
 > > Date: woensdag 3 juni 2015 05:55
 > >
 > > Let say I have a diversified portfolio of 5 assets. The individual
 > > Asset VaRs for them are $A, $B, $C, $D, & $E. And the overall
 > > portfolio VaR is $P. Assumed all VaR numbers are reported in absolute
 > > number
 > >
 > > It appears that P is less than all 5 individual VaRs.
 > >
 > > Can that happen? I know that P < (A+B+C+D+E). However here in my
 > > calculation what happened is P is less than each asset VaR.
 > >
 > > Appreciate your view.
 > >
 > > Thanks and regards,
 > 
 > _______________________________________________
 > R-SIG-Finance at r-project.org mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
 > -- Subscriber-posting only. If you want to post, subscribe first.
 > -- Also note that this is not the r-help list where general R questions should go.
 > 
 > 
 > 
 > [[alternative HTML version deleted]]
 > 
 > _______________________________________________
 > R-SIG-Finance at r-project.org mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
 > -- Subscriber-posting only. If you want to post, subscribe first.
 > -- Also note that this is not the r-help list where general R questions should go.


From josh.m.ulrich at gmail.com  Wed Jun  3 13:46:26 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 3 Jun 2015 06:46:26 -0500
Subject: [R-SIG-Finance] Getting started with blotter (adding
	transactions)
In-Reply-To: <14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
	<14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
Message-ID: <CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>

As Peter said, you need to create a currency and instruments to avoid
the warnings.  I cannot replicate the error using blotter from
revision 1688 on R-Forge.  What's your sessionInfo() output?

On Tue, Jun 2, 2015 at 10:20 PM, Peter Chan <peter at returnandrisk.com> wrote:
> Hi Roger
>
> There's an example in the help pages under the "blotter-package" entry.  You need to setup your instruments first eg
>
> # Use the FinancialInstrument package to manage information about tradable
> # instruments
> require(FinancialInstrument)
> # Define a currency and a couple stocks
> currency("USD")
> symbols = c("EWJ","EWI")
> for(symbol in symbols){ # establish tradable instruments
>     stock(symbol, currency="USD", multiplier=1)
> }
>
> Thanks
>
> Peter
> www.returnandrisk.com
>
>
>
> ---- On Tue, 02 Jun 2015 19:17:53 +0000  Bos<roger.bos at rothschild.com> wrote ----
>  > All,
>  >
>  > I am trying to learn how to use the blotter package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second.
>  > I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get:
>  >
>  > > # Add some transactions
>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)
>  > [1] "2015-05-13 00:00:00 EWJ 328 @ 30.51"
>  > Warning messages:
>  > 1: In getInstrument(Symbol) :
>  >   instrument EWJ not found, please create it first.
>  > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  :
>  >   Instrument EWJ  not found, using contract multiplier of 1
>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)
>  > Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
>  >   unused argument (n = n)
>  > >
>  >
>  > ****
>  >
>  > require(xts)
>  > require(quantmod)
>  > require(blotter)
>  >
>  > Sys.setenv(TZ="EST")
>  >
>  > # xts object must be created with explicit index class:
>  > initDate <- '2000-01-01'
>  > getSymbols('SPY', from=initDate, index.class=c("POSIXt","POSIXct"))
>  >
>  > portfolio <- "bos"
>  > account <- "acct"
>  > initEq <- 0
>  >
>  > # When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this:
>  > rm(list=ls(envir=.blotter), envir = .blotter)
>  >
>  > # Add some symbols
>  > sym <- c("EWJ","EWI")
>  > initPortf(name=portfolio, sym, initDate = initDate)
>  > initAcct(account,portfolios=c(portfolio), initDate = initDate, initEq = initEq)
>  >
>  > # Add some transactions
>  > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)
>  > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)
>  >
>  >
>  >
>  >
>  > _______________________________________________
>  > R-SIG-Finance at r-project.org mailing list
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > -- Subscriber-posting only. If you want to post, subscribe first.
>  > -- Also note that this is not the r-help list where general R questions should go.
>  >
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From roger.bos at rothschild.com  Wed Jun  3 20:21:32 2015
From: roger.bos at rothschild.com (Bos, Roger)
Date: Wed, 3 Jun 2015 18:21:32 +0000
Subject: [R-SIG-Finance] Getting started with blotter (adding
 transactions)
In-Reply-To: <CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
	<14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
	<CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>
Message-ID: <0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>

Peter, all,

I added the code for FInancialInstruments and I am fine with that, but re-installing blotter (to make sure I have the latest version) is giving me a lot of problems.  In the past I have always been successful running the following (on Windows):

> install.packages('blotter', repos="http://R-Forge.R-project.org", dependencies = TRUE)
Package which is only available in source form, and may need
  compilation of C/C++/Fortran: ?blotter?
  These will not be installed
>

So I tried building it from source, but that fails as well:
> install.packages('blotter', repos="http://R-Forge.R-project.org", dependencies = TRUE, type="source")
trying URL 'http://R-Forge.R-project.org/src/contrib/blotter_0.9.1666.tar.gz'
Content type 'application/x-gzip' length 72129 bytes (70 KB)
downloaded 70 KB

'\\rinnycs0051\research\R_HOME'
CMD.EXE was started with the above path as the current directory.
UNC paths are not supported.  Defaulting to Windows directory.
Loading required package: grDevices
Loading required package: graphics
Loading required package: stats
Loading required package: utils
Loading required package: XLConnectJars
XLConnect 0.2-11 by Mirai Solutions GmbH [aut],
  Martin Studer [cre],
  The Apache Software Foundation [ctb, cph] (Apache POI, Apache Commons
    Codec),
  Stephen Colebourne [ctb, cph] (Joda-Time Java library)
http://www.mirai-solutions.com ,
http://miraisolutions.wordpress.com
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric


Attaching package: 'ggplot2'

The following object is masked _by_ '.GlobalEnv':

    %+%


Attaching package: 'dplyr'

The following objects are masked from 'package:plyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize

The following objects are masked from 'package:xts':

    first, last

The following object is masked from 'package:MASS':

    select

The following object is masked from 'package:stats':

    filter

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union


Attaching package: 'lubridate'

The following object is masked from 'package:plyr':

    here


Attaching package: 'testthat'

The following object is masked from 'package:prettyR':

    describe

Loading required package: gsubfn
Loading required package: proto
Loading required package: RSQLite
Loading required package: DBI
* installing *source* package 'blotter' ...
** libs
Warning: running command 'make -f "C:/PROGRA~1/R/R-32~1.0PA/etc/x64/Makeconf" -f "C:/PROGRA~1/R/R-32~1.0PA/share/make/winshlib.mk" SHLIB="blotter.dll" WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
ERROR: compilation failed for package 'blotter'
* removing 'C:/Program Files/R/R-3.2.0patched/library/blotter'
Warning: closing unused RODBC handle 4
Warning: closing unused RODBC handle 3
Warning: closing unused RODBC handle 2
Warning: closing unused RODBC handle 1

The downloaded source packages are in
        ?C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W\downloaded_packages?
Warning messages:
1: running command '"C:/PROGRA~1/R/R-32~1.0PA/bin/x64/R" CMD INSTALL -l "C:\Program Files\R\R-3.2.0patched\library" C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W/downloaded_packages/blotter_0.9.1666.tar.gz' had status 1
2: In install.packages("blotter", repos = "http://R-Forge.R-project.org",  :
  installation of package ?blotter? had non-zero exit status
>





I do have Rtools version 3.3.0.1958 installed and can install any other package I have tried.  Finally, here is my sessionInfo()

> sessionInfo()
R version 3.2.0 Patched (2015-06-01 r68455)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] datasets  tools     utils     stats     graphics  grDevices methods
[8] base

other attached packages:
 [1] sqldf_0.4-10        RSQLite_1.0.0       DBI_0.3.1
 [4] gsubfn_0.6-6        proto_0.3-10        Rcpp_0.11.6
 [7] Quandl_2.6.0        testthat_0.10.0     lubridate_1.3.3
[10] sendmailR_1.2-1     rmarkdown_0.6.1     devtools_1.8.0
[13] Rpad_1.3.0          formatR_1.2         dplyr_0.4.1
[16] plyr_1.8.2          reshape2_1.4.1      ggplot2_1.0.1
[19] xts_0.9-7           zoo_1.7-12          XLConnect_0.2-11
[22] XLConnectJars_0.2-9 timeDate_3012.100   R2HTML_2.3.1
[25] RODBC_1.3-11        quadprog_1.5-5      prettyR_2.1-1
[28] MASS_7.3-40         fortunes_1.5-2      corpcor_1.6.7
[31] manipulate_1.0.1

loaded via a namespace (and not attached):
 [1] git2r_0.10.1     base64enc_0.1-2  bitops_1.0-6     digest_0.6.8
 [5] memoise_0.2.1    gtable_0.1.2     lattice_0.20-31  parallel_3.2.0
 [9] rJava_0.9-6      knitr_1.10.5     httr_0.6.1       stringr_1.0.0
[13] rversions_1.0.0  grid_3.2.0       tcltk_3.2.0      XML_3.98-1.2
[17] magrittr_1.5     htmltools_0.2.6  scales_0.2.4     assertthat_0.1
[21] colorspace_1.2-6 stringi_0.4-1    RCurl_1.95-4.6   munsell_0.4.2
[25] chron_2.3-45     crayon_1.2.1

Thanks,

Roger




***************************************************************
This message and any attachments are for the named person's use only.
This message may contain confidential, proprietary or legally privileged
information. No right to confidential or privileged treatment
of this message is waived or lost by an error in transmission.
If you have received this message in error, please immediately
notify the sender by e-mail, delete the message, any attachments and all
copies from your system and destroy any hard copies. You must
not, directly or indirectly, use, disclose, distribute,
print or copy any part of this message or any attachments if you are not
the intended recipient.



-----Original Message-----
From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com]
Sent: Wednesday, June 03, 2015 7:46 AM
To: Peter Chan
Cc: Bos, Roger; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Getting started with blotter (adding transactions)

As Peter said, you need to create a currency and instruments to avoid the warnings.  I cannot replicate the error using blotter from revision 1688 on R-Forge.  What's your sessionInfo() output?

On Tue, Jun 2, 2015 at 10:20 PM, Peter Chan <peter at returnandrisk.com> wrote:
> Hi Roger
>
> There's an example in the help pages under the "blotter-package"
> entry.  You need to setup your instruments first eg
>
> # Use the FinancialInstrument package to manage information about
> tradable # instruments
> require(FinancialInstrument)
> # Define a currency and a couple stocks
> currency("USD")
> symbols = c("EWJ","EWI")
> for(symbol in symbols){ # establish tradable instruments
>     stock(symbol, currency="USD", multiplier=1) }
>
> Thanks
>
> Peter
> www.returnandrisk.com
>
>
>
> ---- On Tue, 02 Jun 2015 19:17:53 +0000  Bos<roger.bos at rothschild.com>
> wrote ----  > All,  >  > I am trying to learn how to use the blotter
> package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second.
>  > I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get:
>  >
>  > > # Add some transactions
>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  > [1] "2015-05-13 00:00:00 EWJ 328 @ 30.51"
>  > Warning messages:
>  > 1: In getInstrument(Symbol) :
>  >   instrument EWJ not found, please create it first.
>  > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  :
>  >   Instrument EWJ  not found, using contract multiplier of 1
>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  > Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
>  >   unused argument (n = n)
>  > >
>  >
>  > ****
>  >
>  > require(xts)
>  > require(quantmod)
>  > require(blotter)
>  >
>  > Sys.setenv(TZ="EST")
>  >
>  > # xts object must be created with explicit index class:
>  > initDate <- '2000-01-01'
>  > getSymbols('SPY', from=initDate, index.class=c("POSIXt","POSIXct"))
>  >
>  > portfolio <- "bos"
>  > account <- "acct"
>  > initEq <- 0
>  >
>  > # When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this:
>  > rm(list=ls(envir=.blotter), envir = .blotter)  >  > # Add some
> symbols  > sym <- c("EWJ","EWI")  > initPortf(name=portfolio, sym,
> initDate = initDate)  > initAcct(account,portfolios=c(portfolio),
> initDate = initDate, initEq = initEq)  >  > # Add some transactions  >
> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51,
> TxnQty = 328, TxnFees=0, verbose=TRUE)  > addTxn(portfolio,
> Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328,
> TxnFees=0, verbose=TRUE)  >  >  >  >  >
> _______________________________________________
>  > R-SIG-Finance at r-project.org mailing list  >
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > -- Subscriber-posting only. If you want to post, subscribe first.
>  > -- Also note that this is not the r-help list where general R questions should go.
>  >
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com

From brian at braverock.com  Wed Jun  3 22:44:26 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 03 Jun 2015 15:44:26 -0500
Subject: [R-SIG-Finance] Getting started with blotter (adding
 transactions)
In-Reply-To: <0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
	<14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
	<CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>
	<0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>
Message-ID: <1433364266.2166.4.camel@brian-rcg>

On Wed, 2015-06-03 at 18:21 +0000, Bos, Roger wrote:
> > install.packages('blotter', repos="http://R-Forge.R-project.org",
> dependencies = TRUE)
> Package which is only available in source form, and may need
>   compilation of C/C++/Fortran: ?blotter?
>   These will not be installed
> >
> 
> So I tried building it from source, but that fails as well:

There is your hint.  You need to install Rtools on Windows.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From josh.m.ulrich at gmail.com  Thu Jun  4 14:08:00 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 4 Jun 2015 07:08:00 -0500
Subject: [R-SIG-Finance] Getting started with blotter (adding
	transactions)
In-Reply-To: <0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
	<14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
	<CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>
	<0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>
Message-ID: <CAPPM_gT9Oy0oJk4M5tBTuQXJed0nBEC55poOAx_UOYc5cy3HuQ@mail.gmail.com>

On Wed, Jun 3, 2015 at 1:21 PM, Bos, Roger <roger.bos at rothschild.com> wrote:
> Peter, all,
>
> I added the code for FInancialInstruments and I am fine with that, but re-installing blotter (to make sure I have the latest version) is giving me a lot of problems.  In the past I have always been successful running the following (on Windows):
>
>> install.packages('blotter', repos="http://R-Forge.R-project.org", dependencies = TRUE)
> Package which is only available in source form, and may need
>   compilation of C/C++/Fortran: 'blotter'
>   These will not be installed
>>
This seems to suggest something is wrong with your Rtools installation.  I get:

> install.packages('blotter', repos="http://R-Forge.R-project.org", dependencies = TRUE)
Warning: dependencies 'Hmisc', 'RUnit' are not available
Package which is only available in source form, and may need
compilation of C/C++/Fortran: 'blotter'
Do you want to attempt to install these from sources?
y/n:

>
> So I tried building it from source, but that fails as well:
>> install.packages('blotter', repos="http://R-Forge.R-project.org", dependencies = TRUE, type="source")
> trying URL 'http://R-Forge.R-project.org/src/contrib/blotter_0.9.1666.tar.gz'
> Content type 'application/x-gzip' length 72129 bytes (70 KB)
> downloaded 70 KB
>
> '\\rinnycs0051\research\R_HOME'
> CMD.EXE was started with the above path as the current directory.
> UNC paths are not supported.  Defaulting to Windows directory.
<snip package loading>
> * installing *source* package 'blotter' ...
> ** libs
> Warning: running command 'make -f "C:/PROGRA~1/R/R-32~1.0PA/etc/x64/Makeconf" -f "C:/PROGRA~1/R/R-32~1.0PA/share/make/winshlib.mk" SHLIB="blotter.dll" WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
> ERROR: compilation failed for package 'blotter'
> * removing 'C:/Program Files/R/R-3.2.0patched/library/blotter'
>
> The downloaded source packages are in
>         'C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W\downloaded_packages'
> Warning messages:
> 1: running command '"C:/PROGRA~1/R/R-32~1.0PA/bin/x64/R" CMD INSTALL -l "C:\Program Files\R\R-3.2.0patched\library" C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W/downloaded_packages/blotter_0.9.1666.tar.gz' had status 1
> 2: In install.packages("blotter", repos = "http://R-Forge.R-project.org",  :
>   installation of package 'blotter' had non-zero exit status
>>
>
> I do have Rtools version 3.3.0.1958 installed and can install any other package I have tried.  Finally, here is my sessionInfo()
>
I just installed R-3.2.0 and Rtools 3.3.0.1958 on 64-bit Windows 7,
and I have no issue installing blotter from source.  I do notice that
you're running R-patched.  Perhaps that has something to do with your
issue?

>> sessionInfo()
> R version 3.2.0 Patched (2015-06-01 r68455)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] datasets  tools     utils     stats     graphics  grDevices methods
> [8] base
>
> other attached packages:
>  [1] sqldf_0.4-10        RSQLite_1.0.0       DBI_0.3.1
>  [4] gsubfn_0.6-6        proto_0.3-10        Rcpp_0.11.6
>  [7] Quandl_2.6.0        testthat_0.10.0     lubridate_1.3.3
> [10] sendmailR_1.2-1     rmarkdown_0.6.1     devtools_1.8.0
> [13] Rpad_1.3.0          formatR_1.2         dplyr_0.4.1
> [16] plyr_1.8.2          reshape2_1.4.1      ggplot2_1.0.1
> [19] xts_0.9-7           zoo_1.7-12          XLConnect_0.2-11
> [22] XLConnectJars_0.2-9 timeDate_3012.100   R2HTML_2.3.1
> [25] RODBC_1.3-11        quadprog_1.5-5      prettyR_2.1-1
> [28] MASS_7.3-40         fortunes_1.5-2      corpcor_1.6.7
> [31] manipulate_1.0.1
>
> loaded via a namespace (and not attached):
>  [1] git2r_0.10.1     base64enc_0.1-2  bitops_1.0-6     digest_0.6.8
>  [5] memoise_0.2.1    gtable_0.1.2     lattice_0.20-31  parallel_3.2.0
>  [9] rJava_0.9-6      knitr_1.10.5     httr_0.6.1       stringr_1.0.0
> [13] rversions_1.0.0  grid_3.2.0       tcltk_3.2.0      XML_3.98-1.2
> [17] magrittr_1.5     htmltools_0.2.6  scales_0.2.4     assertthat_0.1
> [21] colorspace_1.2-6 stringi_0.4-1    RCurl_1.95-4.6   munsell_0.4.2
> [25] chron_2.3-45     crayon_1.2.1
>
> Thanks,
>
> Roger
>
>
>
>
> -----Original Message-----
> From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com]
> Sent: Wednesday, June 03, 2015 7:46 AM
> To: Peter Chan
> Cc: Bos, Roger; r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] Getting started with blotter (adding transactions)
>
> As Peter said, you need to create a currency and instruments to avoid the warnings.  I cannot replicate the error using blotter from revision 1688 on R-Forge.  What's your sessionInfo() output?
>
> On Tue, Jun 2, 2015 at 10:20 PM, Peter Chan <peter at returnandrisk.com> wrote:
>> Hi Roger
>>
>> There's an example in the help pages under the "blotter-package"
>> entry.  You need to setup your instruments first eg
>>
>> # Use the FinancialInstrument package to manage information about
>> tradable # instruments
>> require(FinancialInstrument)
>> # Define a currency and a couple stocks
>> currency("USD")
>> symbols = c("EWJ","EWI")
>> for(symbol in symbols){ # establish tradable instruments
>>     stock(symbol, currency="USD", multiplier=1) }
>>
>> Thanks
>>
>> Peter
>> www.returnandrisk.com
>>
>>
>>
>> ---- On Tue, 02 Jun 2015 19:17:53 +0000  Bos<roger.bos at rothschild.com>
>> wrote ----  > All,  >  > I am trying to learn how to use the blotter
>> package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second.
>>  > I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get:
>>  >
>>  > > # Add some transactions
>>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
>> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  > [1] "2015-05-13 00:00:00 EWJ 328 @ 30.51"
>>  > Warning messages:
>>  > 1: In getInstrument(Symbol) :
>>  >   instrument EWJ not found, please create it first.
>>  > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  :
>>  >   Instrument EWJ  not found, using contract multiplier of 1
>>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
>> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  > Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
>>  >   unused argument (n = n)
>>  > >
>>  >
>>  > ****
>>  >
>>  > require(xts)
>>  > require(quantmod)
>>  > require(blotter)
>>  >
>>  > Sys.setenv(TZ="EST")
>>  >
>>  > # xts object must be created with explicit index class:
>>  > initDate <- '2000-01-01'
>>  > getSymbols('SPY', from=initDate, index.class=c("POSIXt","POSIXct"))
>>  >
>>  > portfolio <- "bos"
>>  > account <- "acct"
>>  > initEq <- 0
>>  >
>>  > # When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this:
>>  > rm(list=ls(envir=.blotter), envir = .blotter)  >  > # Add some
>> symbols  > sym <- c("EWJ","EWI")  > initPortf(name=portfolio, sym,
>> initDate = initDate)  > initAcct(account,portfolios=c(portfolio),
>> initDate = initDate, initEq = initEq)  >  > # Add some transactions  >
>> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13', TxnPrice=30.51,
>> TxnQty = 328, TxnFees=0, verbose=TRUE)  > addTxn(portfolio,
>> Symbol='EWJ',  TxnDate='2015-05-15', TxnPrice=31.51, TxnQty = -328,
>> TxnFees=0, verbose=TRUE)  >  >  >  >  >
>> _______________________________________________
>>  > R-SIG-Finance at r-project.org mailing list  >
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>  > -- Subscriber-posting only. If you want to post, subscribe first.
>>  > -- Also note that this is not the r-help list where general R questions should go.
>>  >
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2015 | www.rinfinance.com



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From thomas.fuller at coherentlogic.com  Thu Jun  4 14:23:04 2015
From: thomas.fuller at coherentlogic.com (Thomas Fuller)
Date: Thu, 4 Jun 2015 08:23:04 -0400
Subject: [R-SIG-Finance] R Estimize API Package
Message-ID: <CAM0JZ3kw08OpaLgFu1uMe=x=-_ScVxdXBCidpsORvaPeu4gVpg@mail.gmail.com>

Hi Folks,

I'd like to announce the availability of the R Estimize API Package.

The R Estimize API package provides the user with functions to develop
their trading strategy, uncover actionable trading ideas, and monitor
consensus shifts with crowdsourced earnings and economic estimate data
directly from www.estimize.com.

The package can be found here:

http://cran.r-project.org/web/packages/restimizeapi/

I also have an example, including pictures of the results when the script
is executed, here:

https://coherentlogic.com/middleware-development/r-package-for-the-estimize-com-api/

Questions and comments are welcomed.

Tom

	[[alternative HTML version deleted]]


From roger.bos at rothschild.com  Thu Jun  4 16:00:05 2015
From: roger.bos at rothschild.com (Bos, Roger)
Date: Thu, 4 Jun 2015 14:00:05 +0000
Subject: [R-SIG-Finance] Getting started with blotter (adding
 transactions)
In-Reply-To: <CAPPM_gT9Oy0oJk4M5tBTuQXJed0nBEC55poOAx_UOYc5cy3HuQ@mail.gmail.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
	<14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
	<CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>
	<0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>
	<CAPPM_gT9Oy0oJk4M5tBTuQXJed0nBEC55poOAx_UOYc5cy3HuQ@mail.gmail.com>
Message-ID: <0765308CD028654885F30322557308D81EE75B17@NYCSM0208.rth.ad.rothschild.com>

Jushua, all,

I don't want to take up too much of anyone's time with this, but I want to tell you what I tried:

I installed R 3.2.0 (non-patched) and I uninstalled Rtools 3.3 and re-downloaded it and re-installed it.  I was able to install all my packages, be they from CRAN, R-Forge, or github, except blotter.

When I try to install blotter from source and error message seems to complain about calcPosAvgCost.o:

Warning: running command 'make -f "C:/PROGRA~1/R/R-32~1.0/etc/x64/Makeconf" -f "C:/PROGRA~1/R/R-32~1.0/share/make/winshlib.mk" SHLIB="blotter.dll" WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
ERROR: compilation failed for package 'blotter'

So I went to R-forge and found the zip file for blotter.  I downloaded it and used "Install packages from local zip file" and it seems to have worked.  I was wondering why I was able to install binaries before.  I see that the last windows binary was built on April 15th.  I will wait for the next binary, but if anything thinks of anything else I can try, I would appreciate it.

Thanks,

Roger



***************************************************************
This message and any attachments are for the named person's use only.
This message may contain confidential, proprietary or legally privileged
information. No right to confidential or privileged treatment
of this message is waived or lost by an error in transmission.
If you have received this message in error, please immediately
notify the sender by e-mail, delete the message, any attachments and all
copies from your system and destroy any hard copies. You must
not, directly or indirectly, use, disclose, distribute,
print or copy any part of this message or any attachments if you are not
the intended recipient.



-----Original Message-----
From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com]
Sent: Thursday, June 04, 2015 8:08 AM
To: Bos, Roger
Cc: Peter Chan; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Getting started with blotter (adding transactions)

On Wed, Jun 3, 2015 at 1:21 PM, Bos, Roger <roger.bos at rothschild.com> wrote:
> Peter, all,
>
> I added the code for FInancialInstruments and I am fine with that, but re-installing blotter (to make sure I have the latest version) is giving me a lot of problems.  In the past I have always been successful running the following (on Windows):
>
>> install.packages('blotter', repos="http://R-Forge.R-project.org",
>> dependencies = TRUE)
> Package which is only available in source form, and may need
>   compilation of C/C++/Fortran: 'blotter'
>   These will not be installed
>>
This seems to suggest something is wrong with your Rtools installation.  I get:

> install.packages('blotter', repos="http://R-Forge.R-project.org",
> dependencies = TRUE)
Warning: dependencies 'Hmisc', 'RUnit' are not available Package which is only available in source form, and may need compilation of C/C++/Fortran: 'blotter'
Do you want to attempt to install these from sources?
y/n:

>
> So I tried building it from source, but that fails as well:
>> install.packages('blotter', repos="http://R-Forge.R-project.org",
>> dependencies = TRUE, type="source")
> trying URL 'http://R-Forge.R-project.org/src/contrib/blotter_0.9.1666.tar.gz'
> Content type 'application/x-gzip' length 72129 bytes (70 KB)
> downloaded 70 KB
>
> '\\rinnycs0051\research\R_HOME'
> CMD.EXE was started with the above path as the current directory.
> UNC paths are not supported.  Defaulting to Windows directory.
<snip package loading>
> * installing *source* package 'blotter' ...
> ** libs
> Warning: running command 'make -f
> "C:/PROGRA~1/R/R-32~1.0PA/etc/x64/Makeconf" -f
> "C:/PROGRA~1/R/R-32~1.0PA/share/make/winshlib.mk" SHLIB="blotter.dll"
> WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
> ERROR: compilation failed for package 'blotter'
> * removing 'C:/Program Files/R/R-3.2.0patched/library/blotter'
>
> The downloaded source packages are in
>         'C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W\downloaded_packages'
> Warning messages:
> 1: running command '"C:/PROGRA~1/R/R-32~1.0PA/bin/x64/R" CMD INSTALL
> -l "C:\Program Files\R\R-3.2.0patched\library"
> C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W/downloaded_packages/blotte
> r_0.9.1666.tar.gz' had status 1
> 2: In install.packages("blotter", repos = "http://R-Forge.R-project.org",  :
>   installation of package 'blotter' had non-zero exit status
>>
>
> I do have Rtools version 3.3.0.1958 installed and can install any
> other package I have tried.  Finally, here is my sessionInfo()
>
I just installed R-3.2.0 and Rtools 3.3.0.1958 on 64-bit Windows 7, and I have no issue installing blotter from source.  I do notice that you're running R-patched.  Perhaps that has something to do with your issue?

>> sessionInfo()
> R version 3.2.0 Patched (2015-06-01 r68455)
> Platform: x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 7 x64
> (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=English_United States.1252 [2] LC_CTYPE=English_United
> States.1252 [3] LC_MONETARY=English_United States.1252 [4]
> LC_NUMERIC=C [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] datasets  tools     utils     stats     graphics  grDevices methods
> [8] base
>
> other attached packages:
>  [1] sqldf_0.4-10        RSQLite_1.0.0       DBI_0.3.1
>  [4] gsubfn_0.6-6        proto_0.3-10        Rcpp_0.11.6
>  [7] Quandl_2.6.0        testthat_0.10.0     lubridate_1.3.3
> [10] sendmailR_1.2-1     rmarkdown_0.6.1     devtools_1.8.0
> [13] Rpad_1.3.0          formatR_1.2         dplyr_0.4.1
> [16] plyr_1.8.2          reshape2_1.4.1      ggplot2_1.0.1
> [19] xts_0.9-7           zoo_1.7-12          XLConnect_0.2-11
> [22] XLConnectJars_0.2-9 timeDate_3012.100   R2HTML_2.3.1
> [25] RODBC_1.3-11        quadprog_1.5-5      prettyR_2.1-1
> [28] MASS_7.3-40         fortunes_1.5-2      corpcor_1.6.7
> [31] manipulate_1.0.1
>
> loaded via a namespace (and not attached):
>  [1] git2r_0.10.1     base64enc_0.1-2  bitops_1.0-6     digest_0.6.8
>  [5] memoise_0.2.1    gtable_0.1.2     lattice_0.20-31  parallel_3.2.0
>  [9] rJava_0.9-6      knitr_1.10.5     httr_0.6.1       stringr_1.0.0
> [13] rversions_1.0.0  grid_3.2.0       tcltk_3.2.0      XML_3.98-1.2
> [17] magrittr_1.5     htmltools_0.2.6  scales_0.2.4     assertthat_0.1
> [21] colorspace_1.2-6 stringi_0.4-1    RCurl_1.95-4.6   munsell_0.4.2
> [25] chron_2.3-45     crayon_1.2.1
>
> Thanks,
>
> Roger
>
>
>
>
> -----Original Message-----
> From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com]
> Sent: Wednesday, June 03, 2015 7:46 AM
> To: Peter Chan
> Cc: Bos, Roger; r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] Getting started with blotter (adding
> transactions)
>
> As Peter said, you need to create a currency and instruments to avoid the warnings.  I cannot replicate the error using blotter from revision 1688 on R-Forge.  What's your sessionInfo() output?
>
> On Tue, Jun 2, 2015 at 10:20 PM, Peter Chan <peter at returnandrisk.com> wrote:
>> Hi Roger
>>
>> There's an example in the help pages under the "blotter-package"
>> entry.  You need to setup your instruments first eg
>>
>> # Use the FinancialInstrument package to manage information about
>> tradable # instruments
>> require(FinancialInstrument)
>> # Define a currency and a couple stocks
>> currency("USD")
>> symbols = c("EWJ","EWI")
>> for(symbol in symbols){ # establish tradable instruments
>>     stock(symbol, currency="USD", multiplier=1) }
>>
>> Thanks
>>
>> Peter
>> www.returnandrisk.com
>>
>>
>>
>> ---- On Tue, 02 Jun 2015 19:17:53 +0000
>> Bos<roger.bos at rothschild.com> wrote ----  > All,  >  > I am trying to
>> learn how to use the blotter package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second.
>>  > I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get:
>>  >
>>  > > # Add some transactions
>>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
>> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  > [1] "2015-05-13 00:00:00 EWJ 328 @ 30.51"
>>  > Warning messages:
>>  > 1: In getInstrument(Symbol) :
>>  >   instrument EWJ not found, please create it first.
>>  > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  :
>>  >   Instrument EWJ  not found, using contract multiplier of 1
>>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
>> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  > Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
>>  >   unused argument (n = n)
>>  > >
>>  >
>>  > ****
>>  >
>>  > require(xts)
>>  > require(quantmod)
>>  > require(blotter)
>>  >
>>  > Sys.setenv(TZ="EST")
>>  >
>>  > # xts object must be created with explicit index class:
>>  > initDate <- '2000-01-01'
>>  > getSymbols('SPY', from=initDate,
>> index.class=c("POSIXt","POSIXct"))
>>  >
>>  > portfolio <- "bos"
>>  > account <- "acct"
>>  > initEq <- 0
>>  >
>>  > # When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this:
>>  > rm(list=ls(envir=.blotter), envir = .blotter)  >  > # Add some
>> symbols  > sym <- c("EWJ","EWI")  > initPortf(name=portfolio, sym,
>> initDate = initDate)  > initAcct(account,portfolios=c(portfolio),
>> initDate = initDate, initEq = initEq)  >  > # Add some transactions
>> > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
>> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  >
>> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
>> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  >  >  >  >
>> > _______________________________________________
>>  > R-SIG-Finance at r-project.org mailing list  >
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>  > -- Subscriber-posting only. If you want to post, subscribe first.
>>  > -- Also note that this is not the r-help list where general R questions should go.
>>  >
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich FOSS Trading  |
> www.fosstrading.com R/Finance 2015 | www.rinfinance.com



--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com

From bobjansen at gmail.com  Thu Jun  4 19:00:07 2015
From: bobjansen at gmail.com (Bob Jansen)
Date: Thu, 4 Jun 2015 19:00:07 +0200
Subject: [R-SIG-Finance] Getting started with blotter (adding
	transactions)
In-Reply-To: <0765308CD028654885F30322557308D81EE75B17@NYCSM0208.rth.ad.rothschild.com>
References: <0765308CD028654885F30322557308D81EE740AC@NYCSM0208.rth.ad.rothschild.com>
	<14db76ecb9b.b242ee93140691.4629430395534581351@returnandrisk.com>
	<CAPPM_gSu4PsAYbjhRvRQrY6oPkFuDYN+sLcw5=YH5tavav2bYg@mail.gmail.com>
	<0765308CD028654885F30322557308D81EE74F8C@NYCSM0208.rth.ad.rothschild.com>
	<CAPPM_gT9Oy0oJk4M5tBTuQXJed0nBEC55poOAx_UOYc5cy3HuQ@mail.gmail.com>
	<0765308CD028654885F30322557308D81EE75B17@NYCSM0208.rth.ad.rothschild.com>
Message-ID: <CACnz3bwW6mm1KsgePLn+h8zbdhZ1xNf7yTGPTO7KpC5aPjtJVg@mail.gmail.com>

Hi Roger,

It could be that it trips over the path your using which is mangled as you
can see. You might have better results if you install Rtools to the root of
a drive, e.g. C:. At the very least it's one less worry.

On Thu, Jun 4, 2015 at 4:00 PM, Bos, Roger <roger.bos at rothschild.com> wrote:

> Jushua, all,
>
> I don't want to take up too much of anyone's time with this, but I want to
> tell you what I tried:
>
> I installed R 3.2.0 (non-patched) and I uninstalled Rtools 3.3 and
> re-downloaded it and re-installed it.  I was able to install all my
> packages, be they from CRAN, R-Forge, or github, except blotter.
>
> When I try to install blotter from source and error message seems to
> complain about calcPosAvgCost.o:
>
> Warning: running command 'make -f
> "C:/PROGRA~1/R/R-32~1.0/etc/x64/Makeconf" -f
> "C:/PROGRA~1/R/R-32~1.0/share/make/winshlib.mk" SHLIB="blotter.dll"
> WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
> ERROR: compilation failed for package 'blotter'
>
> So I went to R-forge and found the zip file for blotter.  I downloaded it
> and used "Install packages from local zip file" and it seems to have
> worked.  I was wondering why I was able to install binaries before.  I see
> that the last windows binary was built on April 15th.  I will wait for the
> next binary, but if anything thinks of anything else I can try, I would
> appreciate it.
>
> Thanks,
>
> Roger
>
>
>
> ***************************************************************
> This message and any attachments are for the named person's use only.
> This message may contain confidential, proprietary or legally privileged
> information. No right to confidential or privileged treatment
> of this message is waived or lost by an error in transmission.
> If you have received this message in error, please immediately
> notify the sender by e-mail, delete the message, any attachments and all
> copies from your system and destroy any hard copies. You must
> not, directly or indirectly, use, disclose, distribute,
> print or copy any part of this message or any attachments if you are not
> the intended recipient.
>
>
>
> -----Original Message-----
> From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com]
> Sent: Thursday, June 04, 2015 8:08 AM
> To: Bos, Roger
> Cc: Peter Chan; r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] Getting started with blotter (adding
> transactions)
>
> On Wed, Jun 3, 2015 at 1:21 PM, Bos, Roger <roger.bos at rothschild.com>
> wrote:
> > Peter, all,
> >
> > I added the code for FInancialInstruments and I am fine with that, but
> re-installing blotter (to make sure I have the latest version) is giving me
> a lot of problems.  In the past I have always been successful running the
> following (on Windows):
> >
> >> install.packages('blotter', repos="http://R-Forge.R-project.org",
> >> dependencies = TRUE)
> > Package which is only available in source form, and may need
> >   compilation of C/C++/Fortran: 'blotter'
> >   These will not be installed
> >>
> This seems to suggest something is wrong with your Rtools installation.  I
> get:
>
> > install.packages('blotter', repos="http://R-Forge.R-project.org",
> > dependencies = TRUE)
> Warning: dependencies 'Hmisc', 'RUnit' are not available Package which is
> only available in source form, and may need compilation of C/C++/Fortran:
> 'blotter'
> Do you want to attempt to install these from sources?
> y/n:
>
> >
> > So I tried building it from source, but that fails as well:
> >> install.packages('blotter', repos="http://R-Forge.R-project.org",
> >> dependencies = TRUE, type="source")
> > trying URL '
> http://R-Forge.R-project.org/src/contrib/blotter_0.9.1666.tar.gz'
> > Content type 'application/x-gzip' length 72129 bytes (70 KB)
> > downloaded 70 KB
> >
> > '\\rinnycs0051\research\R_HOME'
> > CMD.EXE was started with the above path as the current directory.
> > UNC paths are not supported.  Defaulting to Windows directory.
> <snip package loading>
> > * installing *source* package 'blotter' ...
> > ** libs
> > Warning: running command 'make -f
> > "C:/PROGRA~1/R/R-32~1.0PA/etc/x64/Makeconf" -f
> > "C:/PROGRA~1/R/R-32~1.0PA/share/make/winshlib.mk" SHLIB="blotter.dll"
> > WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
> > ERROR: compilation failed for package 'blotter'
> > * removing 'C:/Program Files/R/R-3.2.0patched/library/blotter'
> >
> > The downloaded source packages are in
> >         'C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W\downloaded_packages'
> > Warning messages:
> > 1: running command '"C:/PROGRA~1/R/R-32~1.0PA/bin/x64/R" CMD INSTALL
> > -l "C:\Program Files\R\R-3.2.0patched\library"
> > C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W/downloaded_packages/blotte
> > r_0.9.1666.tar.gz' had status 1
> > 2: In install.packages("blotter", repos = "http://R-Forge.R-project.org",
> :
> >   installation of package 'blotter' had non-zero exit status
> >>
> >
> > I do have Rtools version 3.3.0.1958 installed and can install any
> > other package I have tried.  Finally, here is my sessionInfo()
> >
> I just installed R-3.2.0 and Rtools 3.3.0.1958 on 64-bit Windows 7, and I
> have no issue installing blotter from source.  I do notice that you're
> running R-patched.  Perhaps that has something to do with your issue?
>
> >> sessionInfo()
> > R version 3.2.0 Patched (2015-06-01 r68455)
> > Platform: x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 7 x64
> > (build 7601) Service Pack 1
> >
> > locale:
> > [1] LC_COLLATE=English_United States.1252 [2] LC_CTYPE=English_United
> > States.1252 [3] LC_MONETARY=English_United States.1252 [4]
> > LC_NUMERIC=C [5] LC_TIME=English_United States.1252
> >
> > attached base packages:
> > [1] datasets  tools     utils     stats     graphics  grDevices methods
> > [8] base
> >
> > other attached packages:
> >  [1] sqldf_0.4-10        RSQLite_1.0.0       DBI_0.3.1
> >  [4] gsubfn_0.6-6        proto_0.3-10        Rcpp_0.11.6
> >  [7] Quandl_2.6.0        testthat_0.10.0     lubridate_1.3.3
> > [10] sendmailR_1.2-1     rmarkdown_0.6.1     devtools_1.8.0
> > [13] Rpad_1.3.0          formatR_1.2         dplyr_0.4.1
> > [16] plyr_1.8.2          reshape2_1.4.1      ggplot2_1.0.1
> > [19] xts_0.9-7           zoo_1.7-12          XLConnect_0.2-11
> > [22] XLConnectJars_0.2-9 timeDate_3012.100   R2HTML_2.3.1
> > [25] RODBC_1.3-11        quadprog_1.5-5      prettyR_2.1-1
> > [28] MASS_7.3-40         fortunes_1.5-2      corpcor_1.6.7
> > [31] manipulate_1.0.1
> >
> > loaded via a namespace (and not attached):
> >  [1] git2r_0.10.1     base64enc_0.1-2  bitops_1.0-6     digest_0.6.8
> >  [5] memoise_0.2.1    gtable_0.1.2     lattice_0.20-31  parallel_3.2.0
> >  [9] rJava_0.9-6      knitr_1.10.5     httr_0.6.1       stringr_1.0.0
> > [13] rversions_1.0.0  grid_3.2.0       tcltk_3.2.0      XML_3.98-1.2
> > [17] magrittr_1.5     htmltools_0.2.6  scales_0.2.4     assertthat_0.1
> > [21] colorspace_1.2-6 stringi_0.4-1    RCurl_1.95-4.6   munsell_0.4.2
> > [25] chron_2.3-45     crayon_1.2.1
> >
> > Thanks,
> >
> > Roger
> >
> >
> >
> >
> > -----Original Message-----
> > From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com]
> > Sent: Wednesday, June 03, 2015 7:46 AM
> > To: Peter Chan
> > Cc: Bos, Roger; r-sig-finance at r-project.org
> > Subject: Re: [R-SIG-Finance] Getting started with blotter (adding
> > transactions)
> >
> > As Peter said, you need to create a currency and instruments to avoid
> the warnings.  I cannot replicate the error using blotter from revision
> 1688 on R-Forge.  What's your sessionInfo() output?
> >
> > On Tue, Jun 2, 2015 at 10:20 PM, Peter Chan <peter at returnandrisk.com>
> wrote:
> >> Hi Roger
> >>
> >> There's an example in the help pages under the "blotter-package"
> >> entry.  You need to setup your instruments first eg
> >>
> >> # Use the FinancialInstrument package to manage information about
> >> tradable # instruments
> >> require(FinancialInstrument)
> >> # Define a currency and a couple stocks
> >> currency("USD")
> >> symbols = c("EWJ","EWI")
> >> for(symbol in symbols){ # establish tradable instruments
> >>     stock(symbol, currency="USD", multiplier=1) }
> >>
> >> Thanks
> >>
> >> Peter
> >> www.returnandrisk.com
> >>
> >>
> >>
> >> ---- On Tue, 02 Jun 2015 19:17:53 +0000
> >> Bos<roger.bos at rothschild.com> wrote ----  > All,  >  > I am trying to
> >> learn how to use the blotter package.  I would eventually like to use
> it to calculate the P&L of a small portfolio.  In my (hopefully)
> reproducible example below it allows me to add the first transaction, but
> not the second.
> >>  > I also get a warning that the instrument is not found.  Could
> someone point me in the right direction here?  If I have overlooked a good
> tutorial on this, please let me know that as well.  Here is the error
> message I get:
> >>  >
> >>  > > # Add some transactions
> >>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
> >> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  > [1]
> "2015-05-13 00:00:00 EWJ 328 @ 30.51"
> >>  > Warning messages:
> >>  > 1: In getInstrument(Symbol) :
> >>  >   instrument EWJ not found, please create it first.
> >>  > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13",
> TxnPrice = 30.51,  :
> >>  >   Instrument EWJ  not found, using contract multiplier of 1
> >>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
> >> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  > Error in
> last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
> >>  >   unused argument (n = n)
> >>  > >
> >>  >
> >>  > ****
> >>  >
> >>  > require(xts)
> >>  > require(quantmod)
> >>  > require(blotter)
> >>  >
> >>  > Sys.setenv(TZ="EST")
> >>  >
> >>  > # xts object must be created with explicit index class:
> >>  > initDate <- '2000-01-01'
> >>  > getSymbols('SPY', from=initDate,
> >> index.class=c("POSIXt","POSIXct"))
> >>  >
> >>  > portfolio <- "bos"
> >>  > account <- "acct"
> >>  > initEq <- 0
> >>  >
> >>  > # When the test is conducted all blotter related values are written
> into .blotter environment. If you want repeat the same test, then you need
> to get rid of all .blotter values. So, you have to run something like this:
> >>  > rm(list=ls(envir=.blotter), envir = .blotter)  >  > # Add some
> >> symbols  > sym <- c("EWJ","EWI")  > initPortf(name=portfolio, sym,
> >> initDate = initDate)  > initAcct(account,portfolios=c(portfolio),
> >> initDate = initDate, initEq = initEq)  >  > # Add some transactions
> >> > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
> >> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  >
> >> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
> >> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  >  >  >  >
> >> > _______________________________________________
> >>  > R-SIG-Finance at r-project.org mailing list  >
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >>  > -- Subscriber-posting only. If you want to post, subscribe first.
> >>  > -- Also note that this is not the r-help list where general R
> questions should go.
> >>  >
> >>
> >> _______________________________________________
> >> R-SIG-Finance at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> -- Subscriber-posting only. If you want to post, subscribe first.
> >> -- Also note that this is not the r-help list where general R questions
> should go.
> >
> >
> >
> > --
> > Joshua Ulrich  |  about.me/joshuaulrich FOSS Trading  |
> > www.fosstrading.com R/Finance 2015 | www.rinfinance.com
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2015 | www.rinfinance.com
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Met vriendelijke groeten,

Bob Jansen

	[[alternative HTML version deleted]]


From roger.bos at rothschild.com  Thu Jun  4 23:03:42 2015
From: roger.bos at rothschild.com (Bos, Roger)
Date: Thu, 4 Jun 2015 21:03:42 +0000
Subject: [R-SIG-Finance] Getting started with blotter (adding
 transactions) SOLVED
Message-ID: <0765308CD028654885F30322557308D81EE762E7@NYCSM0208.rth.ad.rothschild.com>

All,


It turns out the problem was I didn?t have ?c:\Rtools\gcc-4.6.3\bin? in my PATH.  I recall Rtools used to pop up a window to let you edit the path and I didn?t see that the last.  The PATH to Rtools\bin was there, but not the compiler.  Once I fixed that I was able to install blotter from source just fine.  Thanks to everyone for the suggestions and apologies for taking up your time.

This page was very helpful for me:
https://github.com/stan-dev/rstan/wiki/Install-Rtools-for-Windows

Thanks,

Roger



***************************************************************

This message and any attachments are for the named person's use only.

This message may contain confidential, proprietary or legally privileged

information. No right to confidential or privileged treatment

of this message is waived or lost by an error in transmission.

If you have received this message in error, please immediately

notify the sender by e-mail, delete the message, any attachments and all

copies from your system and destroy any hard copies.  You must

not, directly or indirectly, use, disclose, distribute,

print or copy any part of this message or any attachments if you are not

the intended recipient.


From: Bob Jansen [mailto:bobjansen at gmail.com]
Sent: Thursday, June 04, 2015 1:00 PM
To: Bos, Roger
Cc: Joshua Ulrich; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Getting started with blotter (adding transactions)

Hi Roger,
It could be that it trips over the path your using which is mangled as you can see. You might have better results if you install Rtools to the root of a drive, e.g. C:. At the very least it's one less worry.

On Thu, Jun 4, 2015 at 4:00 PM, Bos, Roger <roger.bos at rothschild.com<mailto:roger.bos at rothschild.com>> wrote:
Jushua, all,

I don't want to take up too much of anyone's time with this, but I want to tell you what I tried:

I installed R 3.2.0 (non-patched) and I uninstalled Rtools 3.3 and re-downloaded it and re-installed it.  I was able to install all my packages, be they from CRAN, R-Forge, or github, except blotter.

When I try to install blotter from source and error message seems to complain about calcPosAvgCost.o:

Warning: running command 'make -f "C:/PROGRA~1/R/R-32~1.0/etc/x64/Makeconf" -f "C:/PROGRA~1/R/R-32~1.0/share/make/winshlib.mk<http://winshlib.mk>" SHLIB="blotter.dll" WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
ERROR: compilation failed for package 'blotter'

So I went to R-forge and found the zip file for blotter.  I downloaded it and used "Install packages from local zip file" and it seems to have worked.  I was wondering why I was able to install binaries before.  I see that the last windows binary was built on April 15th.  I will wait for the next binary, but if anything thinks of anything else I can try, I would appreciate it.

Thanks,

Roger



***************************************************************
This message and any attachments are for the named person's use only.
This message may contain confidential, proprietary or legally privileged
information. No right to confidential or privileged treatment
of this message is waived or lost by an error in transmission.
If you have received this message in error, please immediately
notify the sender by e-mail, delete the message, any attachments and all
copies from your system and destroy any hard copies. You must
not, directly or indirectly, use, disclose, distribute,
print or copy any part of this message or any attachments if you are not
the intended recipient.



-----Original Message-----
From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com<mailto:josh.m.ulrich at gmail.com>]
Sent: Thursday, June 04, 2015 8:08 AM
To: Bos, Roger
Cc: Peter Chan; r-sig-finance at r-project.org<mailto:r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Getting started with blotter (adding transactions)
On Wed, Jun 3, 2015 at 1:21 PM, Bos, Roger <roger.bos at rothschild.com<mailto:roger.bos at rothschild.com>> wrote:
> Peter, all,
>
> I added the code for FInancialInstruments and I am fine with that, but re-installing blotter (to make sure I have the latest version) is giving me a lot of problems.  In the past I have always been successful running the following (on Windows):
>
>> install.packages('blotter', repos="http://R-Forge.R-project.org",
>> dependencies = TRUE)
> Package which is only available in source form, and may need
>   compilation of C/C++/Fortran: 'blotter'
>   These will not be installed
>>
This seems to suggest something is wrong with your Rtools installation.  I get:

> install.packages('blotter', repos="http://R-Forge.R-project.org",
> dependencies = TRUE)
Warning: dependencies 'Hmisc', 'RUnit' are not available Package which is only available in source form, and may need compilation of C/C++/Fortran: 'blotter'
Do you want to attempt to install these from sources?
y/n:

>
> So I tried building it from source, but that fails as well:
>> install.packages('blotter', repos="http://R-Forge.R-project.org",
>> dependencies = TRUE, type="source")
> trying URL 'http://R-Forge.R-project.org/src/contrib/blotter_0.9.1666.tar.gz'
> Content type 'application/x-gzip' length 72129 bytes (70 KB)
> downloaded 70 KB
>
> '\\rinnycs0051\research\R_HOME'
> CMD.EXE was started with the above path as the current directory.
> UNC paths are not supported.  Defaulting to Windows directory.
<snip package loading>
> * installing *source* package 'blotter' ...
> ** libs
> Warning: running command 'make -f
> "C:/PROGRA~1/R/R-32~1.0PA/etc/x64/Makeconf" -f
> "C:/PROGRA~1/R/R-32~1.0PA/share/make/winshlib.mk<http://winshlib.mk>" SHLIB="blotter.dll"
> WIN=64 TCLBIN=64 OBJECTS="calcPosAvgCost.o"' had status 127
> ERROR: compilation failed for package 'blotter'
> * removing 'C:/Program Files/R/R-3.2.0patched/library/blotter'
>
> The downloaded source packages are in
>         'C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W\downloaded_packages'
> Warning messages:
> 1: running command '"C:/PROGRA~1/R/R-32~1.0PA/bin/x64/R" CMD INSTALL
> -l "C:\Program Files\R\R-3.2.0patched\library"
> C:\Users\bosr\AppData\Local\Temp\RtmpkzHy2W/downloaded_packages/blotte
> r_0.9.1666.tar.gz' had status 1
> 2: In install.packages("blotter", repos = "http://R-Forge.R-project.org",  :
>   installation of package 'blotter' had non-zero exit status
>>
>
> I do have Rtools version 3.3.0.1958 installed and can install any
> other package I have tried.  Finally, here is my sessionInfo()
>
I just installed R-3.2.0 and Rtools 3.3.0.1958 on 64-bit Windows 7, and I have no issue installing blotter from source.  I do notice that you're running R-patched.  Perhaps that has something to do with your issue?

>> sessionInfo()
> R version 3.2.0 Patched (2015-06-01 r68455)
> Platform: x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 7 x64
> (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=English_United States.1252 [2] LC_CTYPE=English_United
> States.1252 [3] LC_MONETARY=English_United States.1252 [4]
> LC_NUMERIC=C [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] datasets  tools     utils     stats     graphics  grDevices methods
> [8] base
>
> other attached packages:
>  [1] sqldf_0.4-10        RSQLite_1.0.0       DBI_0.3.1
>  [4] gsubfn_0.6-6        proto_0.3-10        Rcpp_0.11.6
>  [7] Quandl_2.6.0        testthat_0.10.0     lubridate_1.3.3
> [10] sendmailR_1.2-1     rmarkdown_0.6.1     devtools_1.8.0
> [13] Rpad_1.3.0          formatR_1.2         dplyr_0.4.1
> [16] plyr_1.8.2          reshape2_1.4.1      ggplot2_1.0.1
> [19] xts_0.9-7           zoo_1.7-12          XLConnect_0.2-11
> [22] XLConnectJars_0.2-9 timeDate_3012.100   R2HTML_2.3.1
> [25] RODBC_1.3-11        quadprog_1.5-5      prettyR_2.1-1
> [28] MASS_7.3-40         fortunes_1.5-2      corpcor_1.6.7
> [31] manipulate_1.0.1
>
> loaded via a namespace (and not attached):
>  [1] git2r_0.10.1     base64enc_0.1-2  bitops_1.0-6     digest_0.6.8
>  [5] memoise_0.2.1    gtable_0.1.2     lattice_0.20-31  parallel_3.2.0
>  [9] rJava_0.9-6      knitr_1.10.5     httr_0.6.1       stringr_1.0.0
> [13] rversions_1.0.0  grid_3.2.0       tcltk_3.2.0      XML_3.98-1.2
> [17] magrittr_1.5     htmltools_0.2.6  scales_0.2.4     assertthat_0.1
> [21] colorspace_1.2-6 stringi_0.4-1    RCurl_1.95-4.6   munsell_0.4.2
> [25] chron_2.3-45     crayon_1.2.1
>
> Thanks,
>
> Roger
>
>
>
>
> -----Original Message-----
> From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com<mailto:josh.m.ulrich at gmail.com>]
> Sent: Wednesday, June 03, 2015 7:46 AM
> To: Peter Chan
> Cc: Bos, Roger; r-sig-finance at r-project.org<mailto:r-sig-finance at r-project.org>
> Subject: Re: [R-SIG-Finance] Getting started with blotter (adding
> transactions)
>
> As Peter said, you need to create a currency and instruments to avoid the warnings.  I cannot replicate the error using blotter from revision 1688 on R-Forge.  What's your sessionInfo() output?
>
> On Tue, Jun 2, 2015 at 10:20 PM, Peter Chan <peter at returnandrisk.com<mailto:peter at returnandrisk.com>> wrote:
>> Hi Roger
>>
>> There's an example in the help pages under the "blotter-package"
>> entry.  You need to setup your instruments first eg
>>
>> # Use the FinancialInstrument package to manage information about
>> tradable # instruments
>> require(FinancialInstrument)
>> # Define a currency and a couple stocks
>> currency("USD")
>> symbols = c("EWJ","EWI")
>> for(symbol in symbols){ # establish tradable instruments
>>     stock(symbol, currency="USD", multiplier=1) }
>>
>> Thanks
>>
>> Peter
>> www.returnandrisk.com<http://www.returnandrisk.com>
>>
>>
>>
>> ---- On Tue, 02 Jun 2015 19:17:53 +0000
>> Bos<roger.bos at rothschild.com<mailto:roger.bos at rothschild.com>> wrote ----  > All,  >  > I am trying to
>> learn how to use the blotter package.  I would eventually like to use it to calculate the P&L of a small portfolio.  In my (hopefully) reproducible example below it allows me to add the first transaction, but not the second.
>>  > I also get a warning that the instrument is not found.  Could someone point me in the right direction here?  If I have overlooked a good tutorial on this, please let me know that as well.  Here is the error message I get:
>>  >
>>  > > # Add some transactions
>>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
>> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  > [1] "2015-05-13 00:00:00 EWJ 328 @ 30.51"
>>  > Warning messages:
>>  > 1: In getInstrument(Symbol) :
>>  >   instrument EWJ not found, please create it first.
>>  > 2: In addTxn(portfolio, Symbol = "EWJ", TxnDate = "2015-05-13", TxnPrice = 30.51,  :
>>  >   Instrument EWJ  not found, using contract multiplier of 1
>>  > > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
>> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  > Error in last(PosData[which(index(PosData) <= Date), ][, Columns], n = n) :
>>  >   unused argument (n = n)
>>  > >
>>  >
>>  > ****
>>  >
>>  > require(xts)
>>  > require(quantmod)
>>  > require(blotter)
>>  >
>>  > Sys.setenv(TZ="EST")
>>  >
>>  > # xts object must be created with explicit index class:
>>  > initDate <- '2000-01-01'
>>  > getSymbols('SPY', from=initDate,
>> index.class=c("POSIXt","POSIXct"))
>>  >
>>  > portfolio <- "bos"
>>  > account <- "acct"
>>  > initEq <- 0
>>  >
>>  > # When the test is conducted all blotter related values are written into .blotter environment. If you want repeat the same test, then you need to get rid of all .blotter values. So, you have to run something like this:
>>  > rm(list=ls(envir=.blotter), envir = .blotter)  >  > # Add some
>> symbols  > sym <- c("EWJ","EWI")  > initPortf(name=portfolio, sym,
>> initDate = initDate)  > initAcct(account,portfolios=c(portfolio),
>> initDate = initDate, initEq = initEq)  >  > # Add some transactions
>> > addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-13',
>> TxnPrice=30.51, TxnQty = 328, TxnFees=0, verbose=TRUE)  >
>> addTxn(portfolio, Symbol='EWJ',  TxnDate='2015-05-15',
>> TxnPrice=31.51, TxnQty = -328, TxnFees=0, verbose=TRUE)  >  >  >  >
>> > _______________________________________________
>>  > R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list  >
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>  > -- Subscriber-posting only. If you want to post, subscribe first.
>>  > -- Also note that this is not the r-help list where general R questions should go.
>>  >
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich<http://about.me/joshuaulrich> FOSS Trading  |
> www.fosstrading.com<http://www.fosstrading.com> R/Finance 2015 | www.rinfinance.com<http://www.rinfinance.com>



--
Joshua Ulrich  |  about.me/joshuaulrich<http://about.me/joshuaulrich>
FOSS Trading  |  www.fosstrading.com<http://www.fosstrading.com>
R/Finance 2015 | www.rinfinance.com<http://www.rinfinance.com>
_______________________________________________
R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.



--
Met vriendelijke groeten,

Bob Jansen

	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Fri Jun  5 01:52:23 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 4 Jun 2015 18:52:23 -0500
Subject: [R-SIG-Finance] Quantstrat for backtesting on tickdata (and
 creating a spread from tick)
In-Reply-To: <1433192429030-4708020.post@n4.nabble.com>
References: <1433192429030-4708020.post@n4.nabble.com>
Message-ID: <CAPPM_gSnbfiLcfcrjOgy4rFv8hXWzc_3tth_2=qWyS9hfszKKg@mail.gmail.com>

On Mon, Jun 1, 2015 at 4:00 PM, bearwithme <daneedwards1 at hotmail.com> wrote:
> Hi, could someone please point me in the right direction. It can be high
> level and i can do the research (which have already done but i seem to be
> going around in circles right now haha)
>
> I have tick data for two instruments bid/vol & ask/vol.
>
> Example data : Bid for BRN0615 (Brent june 2015)
> 20150421 175951;61.87;4
> 20150421 175955;61.87;3
> 20150421 175955;61.87;1
>
> 1) I would like create a spread between 2 instruments using this tick data.
> (can fn_spreadbuilder do this?)
>
> spread ask = BRN0615(ask) - (BRNS120615(bid) *3)
> spread bid = BRN0615(bid) - (BRNS120615(ask) *3)
>
I have some code that builds a similar spread like this:

syms <- c("BRN0615","BRNS120615")
currency('USD')
spread("BRNS","USD",syms,c(1,-3))
bid <- buildSpread("BRNS",onelot=FALSE,prefer="Bid",auto.assign=FALSE)
ask <- buildSpread("BRNS",onelot=FALSE,prefer="Ask",auto.assign=FALSE)
BRNS <- merge(bid, ask)

This code is a couple years old and I don't remember the precise
reason for constructing the spread that way... I think it had
something to do with not assuming you would be able to get the passive
price on both legs of the spread.  Hopefully someone else can
elaborate.

> 2) unfortunately in the tick data some of the date rows have duplicate time
> stamps (i hope to get better data) is there a way of dealing with this
> (without going to 1 second data).
>
xts objects don't need a unique index.  Did you actually encounter a
problem, or are you just guessing that there will be one?

> 3) once i have the spread, it will be in bid/ask format still, I know how to
> access the columns in quanstrat using $columnname but what is the best way
> to get it a certain format?
>
Use column names, Bid.Price and Ask.Price, respectively.  Then set
prefer = "Bid" or prefer = "Ask" in your quantstrat calls that care
about the side of the market (e.g. ruleSignal).

>
> ** my strategy will use the bid and ask of the resulting spread, when the
> ask goes below a certain level i will long, when the bid goes above a
> certain level i will go short (mean reversion).
>
> thanks!!
>
>
>
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Quantstrat-for-backtesting-on-tickdata-and-creating-a-spread-from-tick-tp4708020.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2015 | www.rinfinance.com


From C.W.Snell at eagle.clarion.edu  Fri Jun  5 04:16:06 2015
From: C.W.Snell at eagle.clarion.edu (Curtis Snell)
Date: Fri, 5 Jun 2015 02:16:06 +0000
Subject: [R-SIG-Finance] Harvesting Historical Data
Message-ID: <DM2PR01MB541B844D480E3D90A25F0BBFCB20@DM2PR01MB541.prod.exchangelabs.com>

?Looking for a little help here.


I harvest historical data for 200-500 stocks.  I remember there is an 'R' script that can pull the data from yahoo finance and compose it into a .txt file

Wondering if anyone knew where I could get a copy of the script.  I should be able to process the .txt file into excel without too much difficulty.


Grabbing this data individually is taking me 8-24 hours of work.  This should shorten that to 30 minutes or so.  I know this isn't really a technical question, but I could use some help/info.


Thank you,


Curt


	[[alternative HTML version deleted]]


From ilya.kipnis at gmail.com  Fri Jun  5 04:18:11 2015
From: ilya.kipnis at gmail.com (Ilya Kipnis)
Date: Thu, 4 Jun 2015 22:18:11 -0400
Subject: [R-SIG-Finance] Harvesting Historical Data
In-Reply-To: <DM2PR01MB541B844D480E3D90A25F0BBFCB20@DM2PR01MB541.prod.exchangelabs.com>
References: <DM2PR01MB541B844D480E3D90A25F0BBFCB20@DM2PR01MB541.prod.exchangelabs.com>
Message-ID: <CA+oJuEHacuEOoR7hvatnMtdh4RBQGU1VNJ84L0E5fohDQmm8fg@mail.gmail.com>

symbols <- c("Your", "Hundreds", "Of", "Symbols")
getSymbols(symbols, from = "1900-01-01")

On Thu, Jun 4, 2015 at 10:16 PM, Curtis Snell <C.W.Snell at eagle.clarion.edu>
wrote:

> ?Looking for a little help here.
>
>
> I harvest historical data for 200-500 stocks.  I remember there is an 'R'
> script that can pull the data from yahoo finance and compose it into a .txt
> file
>
> Wondering if anyone knew where I could get a copy of the script.  I should
> be able to process the .txt file into excel without too much difficulty.
>
>
> Grabbing this data individually is taking me 8-24 hours of work.  This
> should shorten that to 30 minutes or so.  I know this isn't really a
> technical question, but I could use some help/info.
>
>
> Thank you,
>
>
> Curt
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From cskmlui at comp.polyu.edu.hk  Fri Jun  5 04:19:43 2015
From: cskmlui at comp.polyu.edu.hk (KL)
Date: Fri, 05 Jun 2015 10:19:43 +0800
Subject: [R-SIG-Finance] =?utf-8?b?5Zue6KaGOiAgSGFydmVzdGluZyBIaXN0b3Jp?=
 =?utf-8?q?cal_Data?=
In-Reply-To: <DM2PR01MB541B844D480E3D90A25F0BBFCB20@DM2PR01MB541.prod.exchangelabs.com>
References: <DM2PR01MB541B844D480E3D90A25F0BBFCB20@DM2PR01MB541.prod.exchangelabs.com>
Message-ID: <6cgi34766dl7qmgo658f5j3g.1433470783161@email.android.com>

Use quantmod



- ???Xperia???????

---- Curtis Snell?? ----

>?Looking for a little help here.
>
>
>I harvest historical data for 200-500 stocks.  I remember there is an 'R' script that can pull the data from yahoo finance and compose it into a .txt file
>
>Wondering if anyone knew where I could get a copy of the script.  I should be able to process the .txt file into excel without too much difficulty.
>
>
>Grabbing this data individually is taking me 8-24 hours of work.  This should shorten that to 30 minutes or so.  I know this isn't really a technical question, but I could use some help/info.
>
>
>Thank you,
>
>
>Curt
>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-SIG-Finance at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>-- Subscriber-posting only. If you want to post, subscribe first.
>-- Also note that this is not the r-help list where general R questions should go.

	[[alternative HTML version deleted]]


From u0055 at wolke7.net  Fri Jun  5 07:19:36 2015
From: u0055 at wolke7.net (u0055 at wolke7.net)
Date: Fri, 05 Jun 2015 07:19:36 +0200
Subject: [R-SIG-Finance] Best simplex algorithm package ?
Message-ID: <55713168.5070806@wolke7.net>

Dear R-SIGs,

Would you please help me in finding
the best simplex algorithm package ?

It should be:
- stable,
- very fast and
- constraints include '=', '>=', '<='.

Thanks and all the best,
Uwe


From daneedwards1 at hotmail.com  Sat Jun  6 11:46:36 2015
From: daneedwards1 at hotmail.com (bearwithme)
Date: Sat, 6 Jun 2015 02:46:36 -0700 (PDT)
Subject: [R-SIG-Finance] Quantstrat for backtesting on tickdata (and
 creating a spread from tick)
In-Reply-To: <CAPPM_gSnbfiLcfcrjOgy4rFv8hXWzc_3tth_2=qWyS9hfszKKg@mail.gmail.com>
References: <1433192429030-4708020.post@n4.nabble.com>
	<CAPPM_gSnbfiLcfcrjOgy4rFv8hXWzc_3tth_2=qWyS9hfszKKg@mail.gmail.com>
Message-ID: <1433583996165-4708278.post@n4.nabble.com>

Thanks Joshua, 

I'll give that a go.. 
what i ended up doing was this.

****loaded the bid, ask separately from csv****

#transform form into xts object
outask <- as.xts(read.zoo(BRN.06.15.Ask,
                          tz='',   
                          format='%Y%m%d %H%M%S'))
outbid <- as.xts(read.zoo(BRN.06.15.Bid,
                          tz='',   
                          format='%Y%m%d %H%M%S'))
calask <- as.xts(read.zoo(BRNS12.12.15.Ask,
                          tz='',   
                          format='%Y%m%d %H%M%S'))
calbid <- as.xts(read.zoo(BRNS12.12.15.Bid,
                          tz='',   
                          format='%Y%m%d %H%M%S'))

#make.index.unique(outask)

#merge the xts files into one
strat  <- merge.xts(outask, outbid, calask, calbid)
head(strat)

#rename columns
names(strat)[names(strat)=="V2"] <- "outask"
names(strat)[names(strat)=="V3"] <- "outaskvol"
names(strat)[names(strat)=="V2.1"] <- "outbid"
names(strat)[names(strat)=="V3.1"] <- "outbidVol"
names(strat)[names(strat)=="V2.2"] <- "calask"
names(strat)[names(strat)=="V3.2"] <- "calaskvol"
names(strat)[names(strat)=="V2.3"] <- "calbid"
names(strat)[names(strat)=="V3.3"] <- "calbidVol"
tail(strat)

#fill down rows
strat  <- na.locf(strat)
tail(strat)

#create strat ask and bid
strat$stratask  <-  strat$outask - (strat$calbid*3)
strat$stratbid  <-  strat$outbid - (strat$calask*3)

which gave me a xts object with everything i need.. i haven't got to back
testing yet but i will let you know how it go.. maybe your way is easier
I'll try that too.

*i havn't had any issues with unique fields yet.



--
View this message in context: http://r.789695.n4.nabble.com/Quantstrat-for-backtesting-on-tickdata-and-creating-a-spread-from-tick-tp4708020p4708278.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From u0055 at wolke7.net  Mon Jun  8 10:18:22 2015
From: u0055 at wolke7.net (u0055 at wolke7.net)
Date: Mon, 08 Jun 2015 10:18:22 +0200
Subject: [R-SIG-Finance] Fastest simplex algorithm package (faster than
	linprog) ?
Message-ID: <55754FCE.3040300@wolke7.net>

Dear R-SIGs,

I would like to solve a simplex problem on a web server on the fly.
The simplex algorithm should be fast,
because the surfers are waiting.

I'm using linprog package right now.
It works well, but it takes ca. 4 minutes.

Does anybody know a very fast simplex algorithm package ?
It should understand constraints including '=', '>=' and '<='.
It should run natively under one of these Linux versions:
Cent OS 7.1
Cent OS 6.6
Debian 8
Debian 7
Ubuntu 15.04
Ubuntu 14.10
Ubuntu 14.04
Fedora 21
openSUSE 13.1
openSUSE 11.4

Thanks and all the best,
Uwe


From arne.henningsen at gmail.com  Mon Jun  8 10:39:58 2015
From: arne.henningsen at gmail.com (Arne Henningsen)
Date: Mon, 8 Jun 2015 10:39:58 +0200
Subject: [R-SIG-Finance] Fastest simplex algorithm package (faster than
 linprog) ?
In-Reply-To: <55754FCE.3040300@wolke7.net>
References: <55754FCE.3040300@wolke7.net>
Message-ID: <CAMTWbJjz4reYfkdPULFKbWQBiReUKkjgwqxjMhWyt-gnsRw4mg@mail.gmail.com>

Dear Uwe

I suggest to use "lpSolve" or "lpSolveAPI."

/Arne


On 8 June 2015 at 10:18,  <u0055 at wolke7.net> wrote:
> Dear R-SIGs,
>
> I would like to solve a simplex problem on a web server on the fly.
> The simplex algorithm should be fast,
> because the surfers are waiting.
>
> I'm using linprog package right now.
> It works well, but it takes ca. 4 minutes.
>
> Does anybody know a very fast simplex algorithm package ?
> It should understand constraints including '=', '>=' and '<='.
> It should run natively under one of these Linux versions:
> Cent OS 7.1
> Cent OS 6.6
> Debian 8
> Debian 7
> Ubuntu 15.04
> Ubuntu 14.10
> Ubuntu 14.04
> Fedora 21
> openSUSE 13.1
> openSUSE 11.4
>
> Thanks and all the best,
> Uwe
>

-- 
Arne Henningsen
http://www.arne-henningsen.name


From u0055 at wolke7.net  Mon Jun  8 12:26:43 2015
From: u0055 at wolke7.net (u0055 at wolke7.net)
Date: Mon, 08 Jun 2015 12:26:43 +0200
Subject: [R-SIG-Finance] Fastest simplex algorithm package (faster than
 linprog) ?
In-Reply-To: <CAMTWbJjz4reYfkdPULFKbWQBiReUKkjgwqxjMhWyt-gnsRw4mg@mail.gmail.com>
References: <55754FCE.3040300@wolke7.net>
	<CAMTWbJjz4reYfkdPULFKbWQBiReUKkjgwqxjMhWyt-gnsRw4mg@mail.gmail.com>
Message-ID: <55756DE3.9060704@wolke7.net>

Dear Arne,
Dear R-SIGs,

Thanks a lot for your suggestion.
I replaced "linprog" by "lpSolve".
The calculation time for my simplex problem
went down from 180 to 54 seconds :-)

54 seconds is still rel. long
for the surfers to wait for the server to respond.
Isn't there a faster way to calculate my simplex ?

I ported my simplex problem to windows and
calculated it with "whatsbest" from "LINDO SYSTEMS INC":
http://www.lindo.com/index.php?option=com_content&view=article&id=3&Itemid=11
Here it takes 1 second.
So there must be a faster way for calculating my problem.
Does anybody have any idea ?

Is the calculation time from "lpSolve"
depending on the OS (Linux or Windows) ?

Are there maybe any "preprocessors" out there,
which have a look to the simplex problem and
simplify it anyhow before running the simpex algo ?

Thanks and all the best,
Uwe


Am 08.06.2015 um 10:39 schrieb Arne Henningsen:

> Dear Uwe
>
> I suggest to use "lpSolve" or "lpSolveAPI."
>
> /Arne
>
>
> On 8 June 2015 at 10:18,  <u0055 at wolke7.net> wrote:
>> Dear R-SIGs,
>>
>> I would like to solve a simplex problem on a web server on the fly.
>> The simplex algorithm should be fast,
>> because the surfers are waiting.
>>
>> I'm using linprog package right now.
>> It works well, but it takes ca. 4 minutes.
>>
>> Does anybody know a very fast simplex algorithm package ?
>> It should understand constraints including '=', '>=' and '<='.
>> It should run natively under one of these Linux versions:
>> Cent OS 7.1
>> Cent OS 6.6
>> Debian 8
>> Debian 7
>> Ubuntu 15.04
>> Ubuntu 14.10
>> Ubuntu 14.04
>> Fedora 21
>> openSUSE 13.1
>> openSUSE 11.4
>>
>> Thanks and all the best,
>> Uwe


From rossbennett34 at gmail.com  Tue Jun  9 16:57:25 2015
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Tue, 9 Jun 2015 14:57:25 +0000
Subject: [R-SIG-Finance] RFC: plot.xts
In-Reply-To: <CAJFvkcdkCANkSxf3hEEQA3KFpjCjE8vDP_U8iZxQ1==yuYO3nA@mail.gmail.com>
References: <CAPPM_gSdHSSTQrh50FKCgD_1DPGoXgWMZwPUMktjr+e=Z2KYEw@mail.gmail.com>
	<2127729524.3513265.1429803199084.JavaMail.yahoo@mail.yahoo.com>
	<1429804347.14129.48.camel@brian-rcg.priv.dvtrading.co>
	<CAJFvkcdkCANkSxf3hEEQA3KFpjCjE8vDP_U8iZxQ1==yuYO3nA@mail.gmail.com>
Message-ID: <CAEESW=Uywnn1p8wRXOBwYsgDOLYk=3i2zb_4iAsS5vgVCZAHmQ@mail.gmail.com>

Gei,

Setting a log scale for the vertical axis is not currently implemented for
plotting the main panel in the call to plot.xts. I opened an issue at
https://github.com/joshuaulrich/xts/issues/103 to add support for a log
scale.

If you would like to add a panel with the log transformation of the data,
you can do the following
library(xts)
data(sample_matrix)
dat.xts <- as.xts(sample_matrix[,"Close"])
plot(dat.xts)
addPanel(log, main = 'log transformation')

Ross

On Tue, Jun 2, 2015 at 4:07 AM, Gei Lin <gmonaie at gmail.com> wrote:

> Is there a method available to set a log axis in for a panels with
> plot.xts? Like the PerformanceAnalytics::chart.TimeSeries call to
> plot.window()
>
> 2015-04-23 11:52 GMT-04:00 Brian G. Peterson <brian at braverock.com>:
>
> > On Thu, 2015-04-23 at 15:33 +0000, Paul Teetor via R-SIG-Finance wrote:
> > > Josh:
> > > First, many thanks to everyone for this work. I've seen some
> > > preliminary results, and they look wonderful.
> > > Second, some questions before I dive in:
> > > Does this subsume the xtsExtra package of plotting functions? Do we
> > > still need xtsExtra, or is that toast?
> >
> > plot.xts will be removed from xtsExtra in the near future.  Yes,
> > plot.xts and supporting function now in xts-proper supercede the
> > plot.xts in xtsExtra.
> >
> >
> > > How would you recommend installing this? By devtools::install_github,
> > > for example?
> >
> > install_github is a fine approach
> >
> > install_github('joshuaulrich/xts')
> >
> >
> > > Finally, I depend critically on xts for daily work. Does this beta
> > > release impact the non-graphics code?
> >
> > We use this code for production-critical tasks every day.
> >
> > The core of xts has the usual smattering of optimizations and bug fixes,
> > and has not changed substantially from a user perspective.
> >
> > plot.xts is substantially different from the old plot.xts, but the old
> > plot.xts didn't do much, which is why most users used chartSeries or
> > plot.zoo.
> >
> > > What's the appropriate level of caution here?
> >
> > As always, YMMV, but this code has been under development and in use for
> > over a year, and I at least consider it stable and ready for prime time.
> >
> > Regards,
> >
> > Brian
> >
> > --
> > Brian G. Peterson
> > http://braverock.com/brian/
> > Ph: 773-459-4973
> > IM: bgpbraverock
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
>
>
>
> --
> *Don't quit. Suffer now and live the rest of your life as a champion.*
>                                 ? Muhammad Ali
> *The world is full of obvious things which nobody by any chance observes.*
>                                 ? Sir Arthur Conan Doyle
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From gttga2000 at yahoo.com  Tue Jun  9 17:26:55 2015
From: gttga2000 at yahoo.com (AIE ATUMA)
Date: Tue, 9 Jun 2015 15:26:55 +0000 (UTC)
Subject: [R-SIG-Finance] Efficient Portfolio
Message-ID: <1819611316.4054955.1433863615785.JavaMail.yahoo@mail.yahoo.com>

Dear All,
I need help. Below is my 17 Assets portfolio code and the error message and I recieve the following error;?
Error in optimize(f = optim.callback, interval = c(ef$ret[max.sh - 1], ?:?? invalid 'xmin' valueIn addition: Warning messages:1: In min(interval) : no non-missing arguments to min; returning Inf2: In max(interval) : no non-missing arguments to max; returning -Inf
How can I resolve this error?

Attached also ie the data used.
return <- read.csv(file.choose(),header=T)head(return)exReturn <- read.csv(file.choose(),header=T)head(exReturn)exReturn <- exReturn[,-1]head(exReturn)
#exReturn <- exReturn[,-5]head(exReturn)Mean=sapply(exReturn,mean)SD=sapply(exReturn,sd)MSD=cbind(Mean,SD)MSDMSD=write.csv(MSD,"1.MSD.csv")EXCOV=cov(exReturn)head(EXCOV)muhat.vals = colMeans(exReturn)muhat.valsstd.vals=sapply(exReturn,sd)std.valscov=EXCOVaveret = as.matrix(exReturn)averetrcov = var(exReturn)rcovrcov=write.csv(rcov,"1rcov.csv")
ret.mat = as.matrix(averet) ?ret.matstd.vals=sapply(averet,sd)muhat.vals = colMeans(averet)muhat.valscov.mat = var(averet) ?cov.matbeta.vals = cov.mat[,1]/cov.mat[1,1]       alpha.vals = muhat.vals[-1] - beta.vals[-1]*muhat.vals["INDEX"]             beta.vals alpha.vals beta = rcov[,1]/rcov[1,1]betaalpha.vals = muhat.vals[-1] - beta[-1]*muhat.vals["INDEX"]alpha.valsexReturn <- exReturn[,-1]averet=matrix(c(-0.012651225, ?-0.033357407, -0.028047833, -0.025091085, -0.023927971, -0.027173414, -0.009168244, -0.042440445, -0.033081353, 0.029539516, -0.032630073, -0.032380113, -0.015888686, 0.011734781, -0.029664476, -0.026563804, -0.025612785,nrow=1))rcov=matrix(c(0.021619201, ?0.002879315, 0.006796186, 0.008391409, 0.007303084, 0.009429538, 0.00573083, 0.010721487, 0.008871943, 0.014952162, -0.003564898, 0.007847258, 0.007609481, 0.002344691, 0.004787781, 0.010340954, 0.004500699,? ? ? ? ? ? ? 0.002879315, 0.014408062, 0.002060355, 0.005357955, 0.004425948, 0.006323749, 0.003004733, 0.007581034, 0.0033889, 0.006163729, 0.00762899, 0.006048443, 0.006755555, 0.006579867, 0.001538254, 0.00535515, 0.00423201,? ? ? ? ? ? ? 0.006796186, 0.002060355, 0.015059936, 0.00891385, 0.005257287, 0.008325, 0.003395422, 0.009127993, 0.003691545, 0.010585709, 0.001536639, 0.007490256, 0.006343576, 0.008617788, 0.004600133, 0.006585048, 0.001828033,? ? ? ? ? ? ? 0.008391409, 0.005357955, 0.00891385, 0.02791027, 0.013095152, 0.016164161, 0.008256585, 0.012325478, 0.007432512, 0.014322006, 0.005322147, 0.017576018, 0.015498928, 0.015339811, 0.002455833, 0.008407568, 0.00653364,? ? ? ? ? ? ? 0.007303084, 0.004425948, 0.005257287, 0.013095152, 0.013055333, 0.011190138, 0.006119818, 0.010232633, 0.007234362, 0.015678921, 0.004607435, 0.010380325, 0.010131716, 0.016960135, 0.002122254, 0.006599095, 0.005009183,? ? ? ? ? ? ? 0.009429538, 0.006323749, 0.008325, 0.016164161, 0.011190138, 0.021004977, 0.006835194, 0.015059864, 0.010132806, 0.013964084, 0.004975523, 0.012950363, 0.013898241, 0.015876255, 0.002220538, 0.005983095, 0.006013043,? ? ? ? ? ? ? 0.00573083, 0.003004733, 0.003395422, 0.008256585, 0.006119818, 0.006835194, 0.01019401, 0.005233176, 0.002164439, 0.009700644, 0.003439956, 0.009572046, 0.00745657, 0.0038553, 0.00141304, 0.00217913, 0.002879114,? ? ? ? ? ? ? 0.010721487, 0.007581034, 0.009127993, 0.012325478, 0.010232633, 0.015059864, 0.005233176, 0.026000738, 0.010254279, 0.02294916, 0.003796425, 0.010711662, 0.012234193, 0.016874167, 0.003985803, 0.010581223, 0.003974903,? ? ? ? ? ? ? 0.008871943, 0.0033889, 0.003691545, 0.007432512, 0.007234362, 0.010132806, 0.002164439, 0.010254279, 0.015017643, 0.014692357, -0.000736742, 0.004488725, 0.00821531, 0.009904755, 0.002407663, 0.006487495, 0.001534648,? ? ? ? ? ? ? 0.014952162, 0.006163729, 0.010585709, 0.014322006, 0.015678921, 0.013964084, 0.009700644, 0.02294916, 0.014692357, 0.140827011, -0.001987559, 0.013425049, 0.017874043, 0.104137758, 0.023654807, 0.028920937, 0.0193293,? ? ? ? ? ? ? -0.003564898, 0.00762899, 0.001536639, 0.005322147, 0.004607435, 0.004975523, 0.003439956, 0.003796425, -0.000736742, -0.001987559, 0.038080975, 0.006497129, 0.002908321, 0.007966071, 0.000112123, 0.008822285, -0.0000721,? ? ? ? ? ? ? 0.007847258, 0.006048443, 0.007490256, 0.017576018, 0.010380325, 0.012950363, 0.009572046, 0.010711662, 0.004488725, 0.013425049, 0.006497129, 0.026641993, 0.015017809, 0.01686881, 0.00494474, 0.0038542, 0.007596542,? ? ? ? ? ? ? 0.007609481, 0.006755555, 0.006343576, 0.015498928, 0.010131716, 0.013898241, 0.00745657, 0.012234193, 0.00821531, 0.017874043, 0.002908321, 0.015017809, 0.019603086, 0.013108311, 0.003248666, 0.000507636, 0.004733304,? ? ? ? ? ? ? 0.002344691, 0.006579867, 0.008617788, 0.015339811, 0.016960135, 0.015876255, 0.0038553, 0.016874167, 0.009904755, 0.104137758, 0.007966071, 0.01686881, 0.013108311, 0.186943324, 0.023100834, 0.028316641, 0.025079888,? ? ? ? ? ? ? 0.004787781, 0.001538254, 0.004600133, 0.002455833, 0.002122254, 0.002220538, 0.00141304, 0.003985803, 0.002407663, 0.023654807, 0.000112123, 0.00494474, 0.003248666, 0.023100834, 0.021991544, 0.009805182, 0.010515751,? ? ? ? ? ? ? 0.0103409542, 0.00535515, 0.006585048, 0.008407568, 0.006599095, 0.005983095, 0.00217913, 0.010581223, 0.006487495, 0.028920937, 0.008822285, 0.0038542, 0.000507636, 0.028316641, 0.009805182, 0.051615239, 0.003343432,? ? ? ? ? ? ? 0.004500699, 0.00423201, 0.001828033, 0.00653364, 0.005009183, 0.006013043, 0.002879114, 0.003974903, 0.001534648, 0.0193293, -0.0000721, 0.007596542, 0.004733304, 0.025079888, 0.010515751, 0.003343432, 0.026693819),nrow=17,ncol=17)
library(tseries)
effFrontier = function (averet, cov.mat, nports = 10, shorts=T, wmax=1){? mxret = max(abs(averet))? mnret = -mxret? n.assets = ncol(averet)? reshigh = rep(wmax,n.assets)? if( shorts )? {? ? reslow = rep(-wmax,n.assets)? } else {? ? reslow = rep(0,n.assets)? }? min.rets = seq(mnret, mxret, len = nports)? vol = rep(NA, nports)? ret = rep(NA, nports)? for (k in 1:nports)? {? ? port.sol = NULL? ? try(port.sol <- portfolio.optim(x=averet, pm=min.rets[k], covmat=cov.mat,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? reshigh=reshigh, reslow=reslow,shorts=shorts),silent=T)? ? if ( !is.null(port.sol) )? ? {? ? ? vol[k] = sqrt(as.vector(port.sol$pw %*%cov.mat %*% port.sol$pw))? ? ? ret[k] = averet %*% port.sol$pw? ? }? }? return(list(vol = vol, ret = ret))}
maxSharpe = function (averet,cov.mat, shorts=T, wmax = 1){? optim.callback = function(param,averet,cov.mat,reshigh,reslow,shorts)? {? ? port.sol = NULL? ? try(port.sol <- portfolio.optim(x=averet, pm=param, covmat=cov.mat,? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? reshigh=reshigh, reslow=reslow, shorts=shorts), silent = T)? ? if (is.null(port.sol)) {? ? ? ratio = 10^9? ? } else {? ? ? m.return = averet %*% port.sol$pw? ? ? m.risk = sqrt(as.vector(port.sol$pw %*% cov.mat %*% port.sol$pw))? ? ? ratio = -m.return/m.risk? ? ? assign("w",port.sol$pw,inherits=T)? ? }? ? return(ratio)? }? ef = effFrontier(averet=averet, cov.mat=cov.mat, shorts=shorts, wmax=wmax, nports = 10)? n = ncol(averet)? reshigh = rep(wmax,n)? if( shorts ) {? ? reslow = -reshigh? } else {? ? reslow = rep(0,n)? }? max.sh = which.max(ef$ret/ef$vol)? w = rep(0,ncol(averet))? xmin = optimize(f=optim.callback, interval=c(ef$ret[max.sh-1], upper=ef$ret[max.sh+1]),? ? ? ? ? ? ? ? ? averet=averet,rcov=cov.mat,reshigh=reshigh,reslow=reslow,shorts=shorts)? return(w)??}


weights <- maxSharpe(averet,cov.mat,shorts=F)
weights

?Thank You and Best Regards,

Emeka .I. A
Integrity is work your talk don't talk your work
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150609/0a9211c4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1MPP.csv
Type: application/vnd.ms-excel
Size: 18917 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150609/0a9211c4/attachment.xlb>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1ppmexret.csv
Type: application/vnd.ms-excel
Size: 20994 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150609/0a9211c4/attachment-0001.xlb>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1.1rcov.csv
Type: application/vnd.ms-excel
Size: 9082 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20150609/0a9211c4/attachment-0002.xlb>

From jatwood at montana.edu  Tue Jun  9 20:01:36 2015
From: jatwood at montana.edu (Atwood, Joseph)
Date: Tue, 9 Jun 2015 12:01:36 -0600
Subject: [R-SIG-Finance] Fastest simplex algorithm package (faster than
	linprog) ?
Message-ID: <8140E9F1EFAA4547B6309D93101DDD6059CE8424F8@EXCMS.msu.montana.edu>

Uwe
I would suggest that you attempt to run your problem using R's API versions of:
lpSolveAPI, glpkAPI, and clpAPI.

You might also find the following report useful.

http://prod.sandia.gov/techlib/access-control.cgi/2013/138847.pdf

In the Sandia Labs test clp substantially outperformed both  lpSolve and glpk for most problems in their set of benchmark tests but you should probably compare their relative performance on your specific problem.

Joe Atwood
Montana State University




	[[alternative HTML version deleted]]


From peter.michaels at gmail.com  Thu Jun 11 17:53:17 2015
From: peter.michaels at gmail.com (Peter)
Date: Thu, 11 Jun 2015 11:53:17 -0400
Subject: [R-SIG-Finance] PortfolioAnalytics group constraints
Message-ID: <CAL3bLienp1O9LdC1ptp3GDZQYN1GtdPDpzPML6nJXt8kdXEetQ@mail.gmail.com>

Hi,

I am trying to set-up a group constraint within PortfolioAnalytics, but I
run into a problem if the current portfolio doesn't have weights in each of
the groups. As an example, if I set a +/- 5% sector constraint on all 10
sectors, but my current portfolio is only in 7 of the 10 sectors, the
optimization step fails.

The groups within the constraint is a list and the empty groups have an
index of 0, since an empty list can't be accepted.

ex.

sectiors <- c('s1','s2','s3','s4')
sector.weights.max <- list(s1 = 0.3, s2 = 0.25, s3 = 0.40, s4=0.25)
sector.weights.min <- list(s1 = 0.2, s2 = 0.15, s3 = 0.30, s4=0.15)
sector.groups <- list(s1 = list(1,2,5), s2=list(3,4), s3=list(0),
s4=list(6))

pspec <- add.constraint(portfolio = pspec,
                        type = 'group',
                        groups = sector.groups,
                        group_labels = sectors,
                        group_min = sector.weights.min,
                        group_max = sector.weights.max)

Depending on the optimization algorithm I try, a different problem arises.

When I try to generate a sequence of random portfolios, this is the error:
rp = random_portfolios(pspec, permutations = 2000, rp_method = 'sample',
eliminate = TRUE)
Error in seq.default(from = round(min, rounding), to = round(max,
rounding),  :
  'from' cannot be NA, NaN or infinite
In addition: Warning messages:
1: In min(min_box) : no non-missing arguments to min; returning Inf
2: In max(max_box) : no non-missing arguments to max; returning -Inf

How can I specify an empty group in the constraint, but still define a
min/max constraint since a rebalance may include a position within that
group.  Is that possible?

Thank you,
Peter

	[[alternative HTML version deleted]]


From u0055 at wolke7.net  Fri Jun 12 08:30:14 2015
From: u0055 at wolke7.net (u0055 at wolke7.net)
Date: Fri, 12 Jun 2015 08:30:14 +0200
Subject: [R-SIG-Finance] Fastest simplex algorithm package (faster than
 linprog) ?
In-Reply-To: <CAMTWbJjz4reYfkdPULFKbWQBiReUKkjgwqxjMhWyt-gnsRw4mg@mail.gmail.com>
References: <55754FCE.3040300@wolke7.net>
	<CAMTWbJjz4reYfkdPULFKbWQBiReUKkjgwqxjMhWyt-gnsRw4mg@mail.gmail.com>
Message-ID: <557A7C76.7050707@wolke7.net>

Dear Arne,
Dear Brian,
Dear Joe,
Dear R-SIGs,

Thanks a lot for all your help.
My problem is solved :-)

Problem:
My problem was that calculating a simplex was to slowly.
I didn't use R directly.
My program is written in NodeJS,
the library "RIO" puts data to Rserve and
Rserve is coupled with R.
My calculation was slowly,
because the simplex input data had to travel this way and
the result data takes the same way back.
Input data is ca.
1000 free variables * 3000 constraints = 3000000 values.
This data transfer costs me ca. 40 seconds per round trip.

Solution:
My solution is to use node-lp_solve without using R:
https://github.com/smremde/node-lp_solve
Now the 3000000 values are connected program intern
to the simplex algo.

Thanks again and all the best,
Uwe


From abhadani at gmail.com  Fri Jun 12 13:26:15 2015
From: abhadani at gmail.com (Abhay Bhadani)
Date: Fri, 12 Jun 2015 16:56:15 +0530
Subject: [R-SIG-Finance] Eman NN using RSNNS package
Message-ID: <CALV0wnoG=xsy_8tsRMTVPNz2__qoZMqSBZx59dgg8=RsEVvw6w@mail.gmail.com>

Dear all,

I am trying to use elman function in package RSNNS to train and test a
neural network model for stock price prediction.

Based on my limited understanding from the manual and a research article on
RSNNS package, I interpret that the network can be trained using

model <- elman(patterns$inputsTrain, patterns$targetsTrain,
size = c(8, 8), learnFuncParams = c(0.1), maxit = 1000,
inputsTest = patterns$inputsTest, targetsTest = patterns$targetsTest,
linOut = FALSE)

and the values for the new dataset can be obtained using prediction <-
predict(model, newdataset).

I am trying predict the future stock price using its past value as input (I
am considering the univariate case). How do I go about the case of
out-of-sample prediction? For instance, I have 400 data points. Suppose I
train and test the model using 300 and 100 data points, respectively. Now
how do I predict the 401th data point using elman function in RSNNS
package?

Your suggestions are much appreciated!

Thanks!

	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Fri Jun 12 15:24:23 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 12 Jun 2015 08:24:23 -0500
Subject: [R-SIG-Finance] Eman NN using RSNNS package
In-Reply-To: <CALV0wnoG=xsy_8tsRMTVPNz2__qoZMqSBZx59dgg8=RsEVvw6w@mail.gmail.com>
References: <CALV0wnoG=xsy_8tsRMTVPNz2__qoZMqSBZx59dgg8=RsEVvw6w@mail.gmail.com>
Message-ID: <CAPPM_gRa2cpGpkWRDjhoyORaiJZWpQ-4pGvFp5y-3nQNvrrVLw@mail.gmail.com>

Please do not cross-post, or at least tell people that you are
cross-posting and link to the other places you've posted:
http://stackoverflow.com/questions/30802910/out-of-sample-prediction-using-elman-in-rsnns-package
If someone does not follow all the sites you post to, they could spend
time answering your question that has already been answered on another
site.

On Fri, Jun 12, 2015 at 6:26 AM, Abhay Bhadani <abhadani at gmail.com> wrote:
> Dear all,
>
> I am trying to use elman function in package RSNNS to train and test a
> neural network model for stock price prediction.
>
> Based on my limited understanding from the manual and a research article on
> RSNNS package, I interpret that the network can be trained using
>
> model <- elman(patterns$inputsTrain, patterns$targetsTrain,
> size = c(8, 8), learnFuncParams = c(0.1), maxit = 1000,
> inputsTest = patterns$inputsTest, targetsTest = patterns$targetsTest,
> linOut = FALSE)
>
> and the values for the new dataset can be obtained using prediction <-
> predict(model, newdataset).
>
> I am trying predict the future stock price using its past value as input (I
> am considering the univariate case). How do I go about the case of
> out-of-sample prediction? For instance, I have 400 data points. Suppose I
> train and test the model using 300 and 100 data points, respectively. Now
> how do I predict the 401th data point using elman function in RSNNS
> package?
>
> Your suggestions are much appreciated!
>
> Thanks!
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From pgilbert902 at gmail.com  Fri Jun 12 23:43:08 2015
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 12 Jun 2015 17:43:08 -0400
Subject: [R-SIG-Finance] TSdbi time series database interface
Message-ID: <557B526C.4080205@gmail.com>

I have recently released several updated and some new packages using the 
TSdbi API for interfacing R to time series databases. The vignette in 
the package TSdata 
(http://cran.at.r-project.org/web/packages/TSdata/vignettes/Guide.pdf) 
gives an overview and usage examples for all the packages. The table in 
section 1 gives an indication of which package can be used for which 
source. In addition to the SQL databases originally supported by the 
API, the list of Internet data sources now includes: ABS (Australia), 
ECB, EuroStat, ILO, IMF, INEGI (Mexico), ISTAT (Italy), NBB (Belgium), 
OECD, UIS, Unesco, World Bank, BIS, FRED, Statistics Canada, Yahoo, 
Oanda, PiTrading, Quandl, Bloomberg. In most cases the TSdbi interface 
is a wrapper to other R packages and only provides a common API. The 
underlying packages are indicated in the vignette. Some of these sources 
should be considered beta, as indicated in the vignette. Details in 
addition to the vignette are available at 
http://tsdbi.r-forge.r-project.org/.

The TSdata vignette is the paper that would have been nice to have for 
my R/Finance 2012 presentation. The packages now provide several things 
promised at that time. The main breakthrough has been the package RJSDMX 
by Attilio Mattiocco, Diana Nicoletti, and Gianpaolo Lopez at the Banca 
d'Italia  (https://github.com/amattioc/SDMX/wiki).

If you are aware of other organizations supporting the SDMX/REST 
standard then please let me know so they can be added. If you would like 
to encourage your favourite data organization to use the SDMX/REST 
standard there are useful lists of working group representatives at
http://sdmx.org/wp-content/uploads/2011/03/SDMX-Statistical-Working-Group-members.pdf 
and 
http://sdmx.org/wp-content/uploads/2012/08/SDMX-Technical-Standards-Working-Group-members-2.pdf.

Constructive feedback is always appreciated.

Paul Gilbert


From rossbennett34 at gmail.com  Sat Jun 13 13:34:01 2015
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Sat, 13 Jun 2015 07:34:01 -0400
Subject: [R-SIG-Finance] PortfolioAnalytics group constraints
In-Reply-To: <CAL3bLienp1O9LdC1ptp3GDZQYN1GtdPDpzPML6nJXt8kdXEetQ@mail.gmail.com>
References: <CAL3bLienp1O9LdC1ptp3GDZQYN1GtdPDpzPML6nJXt8kdXEetQ@mail.gmail.com>
Message-ID: <CAEESW=VksbTZdhZ8ricrgxYj-UF0mTKjWeg9GccxDpvB9G2kog@mail.gmail.com>

On Thu, Jun 11, 2015 at 11:53 AM, Peter <peter.michaels at gmail.com> wrote:

> Hi,
>
> I am trying to set-up a group constraint within PortfolioAnalytics, but I
> run into a problem if the current portfolio doesn't have weights in each of
> the groups. As an example, if I set a +/- 5% sector constraint on all 10
> sectors, but my current portfolio is only in 7 of the 10 sectors, the
> optimization step fails.
>
> The groups within the constraint is a list and the empty groups have an
> index of 0, since an empty list can't be accepted.
>
> ex.
>
> sectiors <- c('s1','s2','s3','s4')
> sector.weights.max <- list(s1 = 0.3, s2 = 0.25, s3 = 0.40, s4=0.25)
> sector.weights.min <- list(s1 = 0.2, s2 = 0.15, s3 = 0.30, s4=0.15)
>

Your sector.weights.max and sector.weights.min objects should be vectors,
not named lists.
sector.weights.max <- c(0.3, 0.25, 0.40, 0.25)
sector.weights.min <- c(0.2, 0.15, 0.30, 0.15)


> sector.groups <- list(s1 = list(1,2,5), s2=list(3,4), s3=list(0),
> s4=list(6))
>

Your sector.groups object should be a list of vectors. The groups should be
a list of vectors of the *index* of the assets. Recall that R has 1-based
indexing so defining a vector with an index of 0 will fail. See
?group_constraint for a few examples.


>
> pspec <- add.constraint(portfolio = pspec,
>                         type = 'group',
>                         groups = sector.groups,
>                         group_labels = sectors,
>                         group_min = sector.weights.min,
>                         group_max = sector.weights.max)
>
> Depending on the optimization algorithm I try, a different problem arises.
>
> When I try to generate a sequence of random portfolios, this is the error:
> rp = random_portfolios(pspec, permutations = 2000, rp_method = 'sample',
> eliminate = TRUE)
> Error in seq.default(from = round(min, rounding), to = round(max,
> rounding),  :
>   'from' cannot be NA, NaN or infinite
> In addition: Warning messages:
> 1: In min(min_box) : no non-missing arguments to min; returning Inf
> 2: In max(max_box) : no non-missing arguments to max; returning -Inf
>
> How can I specify an empty group in the constraint, but still define a
> min/max constraint since a rebalance may include a position within that
> group.  Is that possible?
>

I'm not sure I entirely understand the question. By defining an empty
group, you are stating that no assets belong in that group so how can a
rebalance include a position in an undefined group? Do you have a more
complete minimal reproducible example?

Regards,
Ross


>
> Thank you,
> Peter
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Sat Jun 13 20:27:50 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 13 Jun 2015 13:27:50 -0500
Subject: [R-SIG-Finance] chart_Series.R question
In-Reply-To: <CACAe89z40BfC2r72ncnr_QtBb+L7K6B6dfZzWsvw_QgSTreY7g@mail.gmail.com>
References: <CACAe89z40BfC2r72ncnr_QtBb+L7K6B6dfZzWsvw_QgSTreY7g@mail.gmail.com>
Message-ID: <CAPPM_gTSN_aiFjvFmOdVBgbA4Q=CTeuU+zGuNv6QmMppe8wPOA@mail.gmail.com>

On Fri, May 29, 2015 at 8:47 PM, E Pan <student.northwestern at gmail.com> wrote:
> Dear list,
> up.col=NA, is in the default argument for chart_theme,
> this causes ohlc charts to be incorrectly drawn with chart_Series(up
> bars won't show up)
>
That's not true.  The 'up bars' are present in the following chart:
getSymbols("SPY")
chart_Series(SPY, subset="2015")

If they're not present in a chart you create, please provide a
reproducible example.

> any idea why it is set to NA as default?
>
I'm not sure of the reason, but it's been that way since the first
chart_Series commit.

> I am exploring options to color each bar in ohlc charts per value of
> technical indicators. am I in the right direction in exploring
> chart_Series.R?
>
Possibly, though you will need to write some very custom code,
possibly changing chart_Series itself, in ordre to be able to set the
color of individual candlesticks based on the value of another series.

> Thanks List!!
> Jim
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From robsch at robsch.eu  Tue Jun 16 21:19:49 2015
From: robsch at robsch.eu (Robert Schien)
Date: Tue, 16 Jun 2015 21:19:49 +0200
Subject: [R-SIG-Finance] IBrokers package: checking order status
Message-ID: <20150616191949.GA9575@robsch.eu>

Hello,

Is there a possibility in the IBrokers package t0 check the
status of orders or executions?

I searched around and found some old posts in this list
which described a reqExecutions function.
But is not documented in the vignette!
Is this function unreliable?

What else can I do the check order status?

Thnaks in advance.
Robert


From steelsteel25 at outlook.com  Wed Jun 17 14:10:09 2015
From: steelsteel25 at outlook.com (Phil Steel)
Date: Wed, 17 Jun 2015 12:10:09 +0000
Subject: [R-SIG-Finance] Monthly Midpoint return
Message-ID: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>

Hi Phil here,
Sorry for bothering you all with this idiotic question but I can't find a simple way to go forward.
I can't manage to get the midpoint monthly returns from an daily price xts object.I know how to get monthly endpoints by using "to.monthly()"  but I can't figure how to transform the daily object to monthly midpoint. Lets say the midpoint is the first day trading day around the 15:th in a month or every 30:th day.
Anybody have encounter this "problem" and/or have a solution.
Have a great evening/afternoon/morning!
Cheers,Student  		 	   		  
	[[alternative HTML version deleted]]


From brian at braverock.com  Wed Jun 17 14:37:31 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 17 Jun 2015 07:37:31 -0500
Subject: [R-SIG-Finance] Monthly Midpoint return
In-Reply-To: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>
References: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>
Message-ID: <1434544651.23914.67.camel@brian-rcg.priv.dvtrading.co>

On Wed, 2015-06-17 at 12:10 +0000, Phil Steel wrote:
> Sorry for bothering you all with this idiotic question but I can't find a simple way to go forward.
> I can't manage to get the midpoint monthly returns from an daily price xts object.I know how to get monthly endpoints by using "to.monthly()"  but I can't figure how to transform the daily object to monthly midpoint. Lets say the midpoint is the first day trading day around the 15:th in a month or every 30:th day.
> Anybody have encounter this "problem" and/or have a solution.

I'm not entirely sure I understand your question.  

If you want the mean/median of the monthly series, or any other
calculable stat, you can use period.apply.

If you want a particular point in time, like the 15th of each month,
then use 'endpoints' or subset the index to get the points you're
looking for.

Regards,

Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From steelsteel25 at outlook.com  Wed Jun 17 16:23:02 2015
From: steelsteel25 at outlook.com (Phil Steel)
Date: Wed, 17 Jun 2015 14:23:02 +0000
Subject: [R-SIG-Finance] Monthly Midpoint return
In-Reply-To: <1434544651.23914.67.camel@brian-rcg.priv.dvtrading.co>
References: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>,
	<1434544651.23914.67.camel@brian-rcg.priv.dvtrading.co>
Message-ID: <COL130-W82625BEAE7E97973CE007ADBA60@phx.gbl>




Hi Brian and everybody else, 
its downloaded stock prices I want to transform to middle of month stock price.
endpoints give end of month doesn't it?if Im using endpoints I get a really strange result with a lot of NA:s My Data starts with the 15:th som my idea it transforming the data to.monthly somehow
My function is ("provided" by Ulrich): 
monthly = function(x){  sym <- sub("\\..*$", "", names(x)[1])  Ad(to.monthly(x, indexAt = 'lastof', drop.time = TRUE, name = sym))}

best regards,Phillip
> Subject: Re: [R-SIG-Finance] Monthly Midpoint return
> From: brian at braverock.com
> To: steelsteel25 at outlook.com
> CC: r-sig-finance at r-project.org
> Date: Wed, 17 Jun 2015 07:37:31 -0500
> 
> On Wed, 2015-06-17 at 12:10 +0000, Phil Steel wrote:
> > Sorry for bothering you all with this idiotic question but I can't find a simple way to go forward.
> > I can't manage to get the midpoint monthly returns from an daily price xts object.I know how to get monthly endpoints by using "to.monthly()"  but I can't figure how to transform the daily object to monthly midpoint. Lets say the midpoint is the first day trading day around the 15:th in a month or every 30:th day.
> > Anybody have encounter this "problem" and/or have a solution.
> 
> I'm not entirely sure I understand your question.  
> 
> If you want the mean/median of the monthly series, or any other
> calculable stat, you can use period.apply.
> 
> If you want a particular point in time, like the 15th of each month,
> then use 'endpoints' or subset the index to get the points you're
> looking for.
> 
> Regards,
> 
> Brian
> 
> 
> -- 
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
> 

 		 	   		  
	[[alternative HTML version deleted]]


From ilya.kipnis at gmail.com  Wed Jun 17 16:25:50 2015
From: ilya.kipnis at gmail.com (Ilya Kipnis)
Date: Wed, 17 Jun 2015 10:25:50 -0400
Subject: [R-SIG-Finance] Monthly Midpoint return
In-Reply-To: <COL130-W82625BEAE7E97973CE007ADBA60@phx.gbl>
References: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>
	<1434544651.23914.67.camel@brian-rcg.priv.dvtrading.co>
	<COL130-W82625BEAE7E97973CE007ADBA60@phx.gbl>
Message-ID: <CA+oJuEGDMxUSTmWRdxjZiQ5nufA-4O4Pe29Un4BYhA+KBUGPHA@mail.gmail.com>

If you're going strictly for mid-month, 2/7ths of the time, that's a
weekend, and don't forget holidays.
On Jun 17, 2015 10:23 AM, "Phil Steel" <steelsteel25 at outlook.com> wrote:

>
>
>
> Hi Brian and everybody else,
> its downloaded stock prices I want to transform to middle of month stock
> price.
> endpoints give end of month doesn't it?if Im using endpoints I get a
> really strange result with a lot of NA:s My Data starts with the 15:th som
> my idea it transforming the data to.monthly somehow
> My function is ("provided" by Ulrich):
> monthly = function(x){  sym <- sub("\\..*$", "", names(x)[1])
> Ad(to.monthly(x, indexAt = 'lastof', drop.time = TRUE, name = sym))}
>
> best regards,Phillip
> > Subject: Re: [R-SIG-Finance] Monthly Midpoint return
> > From: brian at braverock.com
> > To: steelsteel25 at outlook.com
> > CC: r-sig-finance at r-project.org
> > Date: Wed, 17 Jun 2015 07:37:31 -0500
> >
> > On Wed, 2015-06-17 at 12:10 +0000, Phil Steel wrote:
> > > Sorry for bothering you all with this idiotic question but I can't
> find a simple way to go forward.
> > > I can't manage to get the midpoint monthly returns from an daily price
> xts object.I know how to get monthly endpoints by using "to.monthly()"  but
> I can't figure how to transform the daily object to monthly midpoint. Lets
> say the midpoint is the first day trading day around the 15:th in a month
> or every 30:th day.
> > > Anybody have encounter this "problem" and/or have a solution.
> >
> > I'm not entirely sure I understand your question.
> >
> > If you want the mean/median of the monthly series, or any other
> > calculable stat, you can use period.apply.
> >
> > If you want a particular point in time, like the 15th of each month,
> > then use 'endpoints' or subset the index to get the points you're
> > looking for.
> >
> > Regards,
> >
> > Brian
> >
> >
> > --
> > Brian G. Peterson
> > http://braverock.com/brian/
> > Ph: 773-459-4973
> > IM: bgpbraverock
> >
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From markknecht at gmail.com  Wed Jun 17 16:30:01 2015
From: markknecht at gmail.com (Mark Knecht)
Date: Wed, 17 Jun 2015 07:30:01 -0700
Subject: [R-SIG-Finance] Monthly Midpoint return
In-Reply-To: <COL130-W82625BEAE7E97973CE007ADBA60@phx.gbl>
References: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>
	<1434544651.23914.67.camel@brian-rcg.priv.dvtrading.co>
	<COL130-W82625BEAE7E97973CE007ADBA60@phx.gbl>
Message-ID: <CAK2H+efMQr_QBgEwE4iXtgTHhdkwmupzSwfWFZ6upVN6crqEoQ@mail.gmail.com>

On Wed, Jun 17, 2015 at 7:23 AM, Phil Steel <steelsteel25 at outlook.com> wrote:
>
>
>
> Hi Brian and everybody else,
> its downloaded stock prices I want to transform to middle of month stock price.
> endpoints give end of month doesn't it?if Im using endpoints I get a really strange result with a lot of NA:s My Data starts with the 15:th som my idea it transforming the data to.monthly somehow
> My function is ("provided" by Ulrich):
> monthly = function(x){  sym <- sub("\\..*$", "", names(x)[1])  Ad(to.monthly(x, indexAt = 'lastof', drop.time = TRUE, name = sym))}
>

Possibly put the month in an array, determine the size of the array
and then take the price/returns at the midpoint of the array? That way
number of days in the month, holidays, etc. wouldn't matter much?

- Mark


From gsee000 at gmail.com  Wed Jun 17 16:37:23 2015
From: gsee000 at gmail.com (G See)
Date: Wed, 17 Jun 2015 09:37:23 -0500
Subject: [R-SIG-Finance] Monthly Midpoint return
In-Reply-To: <CAK2H+efMQr_QBgEwE4iXtgTHhdkwmupzSwfWFZ6upVN6crqEoQ@mail.gmail.com>
References: <COL130-W80DB633683481D5AA2CCA6DBA60@phx.gbl>
	<1434544651.23914.67.camel@brian-rcg.priv.dvtrading.co>
	<COL130-W82625BEAE7E97973CE007ADBA60@phx.gbl>
	<CAK2H+efMQr_QBgEwE4iXtgTHhdkwmupzSwfWFZ6upVN6crqEoQ@mail.gmail.com>
Message-ID: <CA+xi=qbZzDvQhcW+gzRffNE6zJnuhETi9xpB2Gx0-07Lsmojiw@mail.gmail.com>

Try this

    data(sample_matrix) # load sample data first
    x <- as.xts(sample_matrix)

    do.call(rbind, lapply(split(x, "months"),
                          function(xx) xx[ceiling(nrow(xx)/2)]))

This code splits the object by months, then uses lapply() to loop over
each month and apply a function which selects the row that is in the
middle of the month.  (you could replace ceiling() with floor() or
round()).

Once you have the subsetted data, you can calculate returns however
you normally would (ROC(), Delt(), dailyReturn(), etc.)

HTH,
Garrett


On Wed, Jun 17, 2015 at 9:30 AM, Mark Knecht <markknecht at gmail.com> wrote:
> On Wed, Jun 17, 2015 at 7:23 AM, Phil Steel <steelsteel25 at outlook.com> wrote:
>>
>>
>>
>> Hi Brian and everybody else,
>> its downloaded stock prices I want to transform to middle of month stock price.
>> endpoints give end of month doesn't it?if Im using endpoints I get a really strange result with a lot of NA:s My Data starts with the 15:th som my idea it transforming the data to.monthly somehow
>> My function is ("provided" by Ulrich):
>> monthly = function(x){  sym <- sub("\\..*$", "", names(x)[1])  Ad(to.monthly(x, indexAt = 'lastof', drop.time = TRUE, name = sym))}
>>
>
> Possibly put the month in an array, determine the size of the array
> and then take the price/returns at the midpoint of the array? That way
> number of days in the month, holidays, etc. wouldn't matter much?
>
> - Mark
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From francesco_mantovani at ymail.com  Thu Jun 18 15:55:22 2015
From: francesco_mantovani at ymail.com (Francesco Mantovani)
Date: Thu, 18 Jun 2015 13:55:22 +0000 (UTC)
Subject: [R-SIG-Finance] UGARCHSIM
Message-ID: <1546410315.1885036.1434635722757.JavaMail.yahoo@mail.yahoo.com>

Hello, I'm trying to simulate with ugarchsim a AR(3)-GARCH(1,1) process with external regressors in conditional mean.The external regressors I used in ugarchfit are 2 vectors, each of size 2920-by-1, namely sm[,1] and sm[,2].?I tried to include them into ugarchsim via mexsimdata, but I always get:

Error in .simregressors(model, mexsimdata, vexsimdata, N, n, m.sim, m) :?ugarchsim-->error: mexsimdata should be a list of length m.sim
I tried to list them as well, but it does not work. I tried the following commands:
sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=c(sm[,1],sm[,2]))
sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=list(c(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=as.list(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=as.list(c(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=sm[,1])
sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=c(list(sm[,1],sm[,2]))...etc.
Please help me out.Thank you for your kind cooperation and best regards

	[[alternative HTML version deleted]]


From francesco_mantovani at ymail.com  Thu Jun 18 15:57:28 2015
From: francesco_mantovani at ymail.com (Francesco Mantovani)
Date: Thu, 18 Jun 2015 13:57:28 +0000 (UTC)
Subject: [R-SIG-Finance] UGARCHSIM
Message-ID: <383194252.1890512.1434635848261.JavaMail.yahoo@mail.yahoo.com>

Hello, can someone explain me, if I digit:
> sim=ugarchsim(fit,n.sim=2920,m.sim=2,startMethod='sample')> plot(sim)
Make a plot selection (or 0 to exit):?
1: ? Conditional SD Simulation Path2: ? Return Series Simulation Path3: ? Conditional SD Simulation Density4: ? Return Series Simulation Path Density
Selection: 1
why do I get this
Error in convert.dates(dates., format = fmt, origin. = origin.) :?? format m/d/y may be incorrectIn addition: Warning message:In unpaste(dates., sep = fmt$sep, fnames = fmt$periods, nfields = 3) :? wrong number of fields in entry(ies) 1
?


	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Thu Jun 18 16:06:10 2015
From: alexios at 4dscape.com (alexios)
Date: Thu, 18 Jun 2015 15:06:10 +0100
Subject: [R-SIG-Finance] UGARCHSIM
In-Reply-To: <1546410315.1885036.1434635722757.JavaMail.yahoo@mail.yahoo.com>
References: <1546410315.1885036.1434635722757.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <5582D052.8090307@4dscape.com>

You have set m.sim=2 so you need a list of regressor matrices (the 
simulated values) of the same length i.e.
sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=list(sm,sm))

Regards,

Alexios


On 18/06/2015 14:55, Francesco Mantovani wrote:
> Hello, I'm trying to simulate with ugarchsim a AR(3)-GARCH(1,1) process with external regressors in conditional mean.The external regressors I used in ugarchfit are 2 vectors, each of size 2920-by-1, namely sm[,1] and sm[,2]. I tried to include them into ugarchsim via mexsimdata, but I always get:
>
> Error in .simregressors(model, mexsimdata, vexsimdata, N, n, m.sim, m) : ugarchsim-->error: mexsimdata should be a list of length m.sim
> I tried to list them as well, but it does not work. I tried the following commands:
> sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=c(sm[,1],sm[,2]))
> sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=list(c(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=as.list(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=as.list(c(sm[,1],sm[,2]))sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=sm[,1])
> sim=ugarchsim(fit,n.sim=2920,m.sim=2,mexsimdata=c(list(sm[,1],sm[,2]))...etc.
> Please help me out.Thank you for your kind cooperation and best regards
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From da_melendez at yahoo.com  Fri Jun 19 00:10:42 2015
From: da_melendez at yahoo.com (daniel melendez)
Date: Thu, 18 Jun 2015 22:10:42 +0000 (UTC)
Subject: [R-SIG-Finance] fscenario in rmgarch package
Message-ID: <437599606.1826919.1434665442192.JavaMail.yahoo@mail.yahoo.com>

?Hello - ?I selected to keep 4 of the 10 components associated with my series for modeling purposes.? However, when trying to generate scenarios using fscenario I get a warning as follows:?Error in tail(preresiduals, mx) %*% t(A) : non-conformable arguments
In addition: Warning messages:
1: In matrix(fit at mfit$Y[(T - p + i):(T - 1 + i), , drop = FALSE], ncol = m,? :
? data length [4] is not a sub-multiple or multiple of the number of columns [10]
2: In matrix(filt at mfilter$factor.sigmas[(T - p + i):(T - 1 + i), ,? :
? data length [4] is not a sub-multiple or multiple of the number of columns [10]?Any help would be greatly appreciated.? Does this message mean that I must use all 10 components for generating a scenario??Regards 
DA Melendez
	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Fri Jun 19 02:11:32 2015
From: alexios at 4dscape.com (alexios)
Date: Fri, 19 Jun 2015 01:11:32 +0100
Subject: [R-SIG-Finance] fscenario in rmgarch package
In-Reply-To: <437599606.1826919.1434665442192.JavaMail.yahoo@mail.yahoo.com>
References: <437599606.1826919.1434665442192.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <55835E34.8010202@4dscape.com>

Hi Daniel,

That's a bug...I've upload a patch to my development repo. You can 
install as follows:

library(devtools)
install_bitbucket("alexiosg/rmgarch")

This should now work:
library(rmgarch)
data(dji30ret)
library(xts)
dj<-xts(dji30ret, as.Date(rownames(dji30ret)))
spec<-gogarchspec(mean.model=list(model="AR"))
scen<-fscenario(dj[,1:10], sim=1000, roll=1, model="gogarch", spec = 
spec, n.comp=3, gfun="tanh", solver.control=list(trace=1))
dim(fitted(scen))
[1] 1000 10 2

Best,

Alexios

On 18/06/2015 23:10, daniel melendez via R-SIG-Finance wrote:
>   Hello -  I selected to keep 4 of the 10 components associated with my series for modeling purposes.  However, when trying to generate scenarios using fscenario I get a warning as follows: Error in tail(preresiduals, mx) %*% t(A) : non-conformable arguments
> In addition: Warning messages:
> 1: In matrix(fit at mfit$Y[(T - p + i):(T - 1 + i), , drop = FALSE], ncol = m,  :
>    data length [4] is not a sub-multiple or multiple of the number of columns [10]
> 2: In matrix(filt at mfilter$factor.sigmas[(T - p + i):(T - 1 + i), ,  :
>    data length [4] is not a sub-multiple or multiple of the number of columns [10] Any help would be greatly appreciated.  Does this message mean that I must use all 10 components for generating a scenario? Regards
> DA Melendez
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From da_melendez at yahoo.com  Fri Jun 19 03:08:28 2015
From: da_melendez at yahoo.com (da_melendez at yahoo.com)
Date: Thu, 18 Jun 2015 20:08:28 -0500
Subject: [R-SIG-Finance] fscenario in rmgarch package
In-Reply-To: <55835E34.8010202@4dscape.com>
References: <437599606.1826919.1434665442192.JavaMail.yahoo@mail.yahoo.com>
	<55835E34.8010202@4dscape.com>
Message-ID: <A915FFDE-FA03-4BE0-94EA-10137DE3DE9B@yahoo.com>

Great!  Thanks a lot for the quick response and I'll download the newer version.  Cheers!

Sent from my iPhone so please excuse any typos 

> On Jun 18, 2015, at 7:11 PM, alexios <alexios at 4dscape.com> wrote:
> 
> Hi Daniel,
> 
> That's a bug...I've upload a patch to my development repo. You can install as follows:
> 
> library(devtools)
> install_bitbucket("alexiosg/rmgarch")
> 
> This should now work:
> library(rmgarch)
> data(dji30ret)
> library(xts)
> dj<-xts(dji30ret, as.Date(rownames(dji30ret)))
> spec<-gogarchspec(mean.model=list(model="AR"))
> scen<-fscenario(dj[,1:10], sim=1000, roll=1, model="gogarch", spec = spec, n.comp=3, gfun="tanh", solver.control=list(trace=1))
> dim(fitted(scen))
> [1] 1000 10 2
> 
> Best,
> 
> Alexios
> 
>> On 18/06/2015 23:10, daniel melendez via R-SIG-Finance wrote:
>>  Hello -  I selected to keep 4 of the 10 components associated with my series for modeling purposes.  However, when trying to generate scenarios using fscenario I get a warning as follows: Error in tail(preresiduals, mx) %*% t(A) : non-conformable arguments
>> In addition: Warning messages:
>> 1: In matrix(fit at mfit$Y[(T - p + i):(T - 1 + i), , drop = FALSE], ncol = m,  :
>>   data length [4] is not a sub-multiple or multiple of the number of columns [10]
>> 2: In matrix(filt at mfilter$factor.sigmas[(T - p + i):(T - 1 + i), ,  :
>>   data length [4] is not a sub-multiple or multiple of the number of columns [10] Any help would be greatly appreciated.  Does this message mean that I must use all 10 components for generating a scenario? Regards
>> DA Melendez
>>    [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
> 


From thomas.fuller at coherentlogic.com  Fri Jun 19 15:10:50 2015
From: thomas.fuller at coherentlogic.com (Thomas Fuller)
Date: Fri, 19 Jun 2015 09:10:50 -0400
Subject: [R-SIG-Finance] Coherent Datafeed: Thomson Reuters Enterprise
 Edition available under the LGPL
Message-ID: <CAM0JZ3kNn4vu4DuSfbMAbaNnWdvuntmp+2eVG1jLHgo9_AyovQ@mail.gmail.com>

Hi Folks,

This announcement relates to the Thomson Reuters Enterprise Platform (TREP)
and *not Eikon*.

It is my pleasure to announce that the *Coherent Datafeed*: *Thomson
Reuters Enterprise Edition* is available under the LGPL open source license.

Product details, including links to the full project source code and Java
documentation, can be found here:

https://coherentlogic.com/middleware-development/solutions-for-traders-using-thomson-reuters-market-data/

The package itself is not yet available on CRAN as there are a few things I
need to do before it can be uploaded. The package does work however, so
feel free to contact me directly if you'd like to use it and I can guide
you through the process of setting it up.

Questions and comments are welcomed.

Tom

	[[alternative HTML version deleted]]


From kunalshah305 at gmail.com  Sat Jun 20 13:58:44 2015
From: kunalshah305 at gmail.com (Kunal Shah)
Date: Sat, 20 Jun 2015 17:28:44 +0530
Subject: [R-SIG-Finance] How to use RExcel using Macro Approach for real
	time market data
Message-ID: <CAOPdpkaTbJAgUN+-vCZXiub7ZqJKOevZskrj+oO8qR6k4TWT9Q@mail.gmail.com>

Hello,

I do the following things
1: Import real time market data from my brokers terminal to Excel
2: I have written a small macro to export that data to R using RExcel
package
3: R performs all the computations and outputs the result
4: I display back R's output to the Excel Sheet

How to make VBA understand that this process needs to be continuously done
with every refresh of stock market data.

Also, since I have just started using RExcel, I would appreciate any
feedback about the package.

Regards

	[[alternative HTML version deleted]]


From kunalshah305 at gmail.com  Sat Jun 20 14:04:51 2015
From: kunalshah305 at gmail.com (Kunal Shah)
Date: Sat, 20 Jun 2015 17:34:51 +0530
Subject: [R-SIG-Finance] Basic question regarding Mailer list
Message-ID: <CAOPdpka9qg6cuMOcqiXXS2fZxWE+ORkvsx9WJ90YLbsU-DH89A@mail.gmail.com>

Hello,

I am getting all the posts to this forum compressed in just one mail. So
all the topics are just covered in one mail

I want separate mails TopicWise. How to do that?

Regards

	[[alternative HTML version deleted]]


From ntobiaskramer at gmail.com  Sat Jun 20 14:31:12 2015
From: ntobiaskramer at gmail.com (Nils Tobias Kramer)
Date: Sat, 20 Jun 2015 14:31:12 +0200
Subject: [R-SIG-Finance] Basic question regarding Mailer list
In-Reply-To: <CAOPdpka9qg6cuMOcqiXXS2fZxWE+ORkvsx9WJ90YLbsU-DH89A@mail.gmail.com>
References: <CAOPdpka9qg6cuMOcqiXXS2fZxWE+ORkvsx9WJ90YLbsU-DH89A@mail.gmail.com>
Message-ID: <F58B8C8A-C3A3-4984-9DD3-4EAE22D02553@gmail.com>

https://stat.ethz.ch/mailman/options/r-sig-finance/kunalshah305%40gmail.com

> On 20.06.2015, at 14:04, Kunal Shah <kunalshah305 at gmail.com> wrote:
> 
> Hello,
> 
> I am getting all the posts to this forum compressed in just one mail. So
> all the topics are just covered in one mail
> 
> I want separate mails TopicWise. How to do that?
> 
> Regards
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From kunalshah305 at gmail.com  Tue Jun 23 08:19:22 2015
From: kunalshah305 at gmail.com (Kunal Shah)
Date: Tue, 23 Jun 2015 11:49:22 +0530
Subject: [R-SIG-Finance] Using excel.link package in Real Time Environment
Message-ID: <CAOPdpkapr03HyiV4UYP7VKmk7F3uOwyc70+k4rB6RmxRw-TCQw@mail.gmail.com>

I used excel.link package in *R*

   1. Imported data *D* from excel using xl[[MyRange]]
   2. Done some manipulations on the data
   3. Exported data ModifiedD from *R* to Excel using the same
function xl[[MyNewRange]]


It is working fine. Results are displayed properly but sometimes it gives
the following error
Error in xls[["Visible"]] : Cannot locate 0 name(s) Visible in COM object
(status = -2147418111)

Then when I again run R, it works properly
Regards

	[[alternative HTML version deleted]]


From kw1958 at gmail.com  Wed Jun 24 16:13:10 2015
From: kw1958 at gmail.com (Keith S Weintraub)
Date: Wed, 24 Jun 2015 10:13:10 -0400
Subject: [R-SIG-Finance] Yield calculation for a bond or loan gives complex
	result.
Message-ID: <1E79096D-4CA0-4463-9127-22238972A47D@gmail.com>

Folks,

There are times when a bond or loan calculation will return a complex result.

I know this is an open ended question but what is the best practice in this case and what R tools (if any) would you use?


Thanks for your time,
Best,
KW


From diego.acuna at usm.cl  Thu Jun 25 22:11:51 2015
From: diego.acuna at usm.cl (=?ISO-8859-1?Q?Diego_Ignacio_Acu=F1a_Rozas?=)
Date: Thu, 25 Jun 2015 17:11:51 -0300
Subject: [R-SIG-Finance] Rugarch package using external regressors,
	a forecasting doubt
In-Reply-To: <558C2A6D.5020609@usm.cl>
References: <558C2A6D.5020609@usm.cl>
Message-ID: <558C6087.8030504@usm.cl>

Hi all, I'm using the rugarch package (which is btw an excellent piece of software). I'm 

using the A-PARCH(1,1) model with an external regressor (the Yang-Zhang
volatility proxy) and I've a doubt about how to perform forecasting
using the model:

  * Suppose I've n observations for the returns of a financial serie and
for the external regressor
  * Then, I use ugarchspec with an A-PARCH(0,1) model with the external
regressor, the ugarchspec and ugarchfit steps work pretty well.
  * Now I want to do forecasting. I don't quite fully understand the
limitation of this process. When I use ugarchforecast, the main
limitation is that I only can forecast 1-step ahead due to the external
regressor data limitation (I don't have more than n data for the
external regressor)???

Now, if I fit a model with the n external regressor data and if I do a
1-step ahead forecast for t+1, then the next day I recieve new data for
the external regressor, how to use the rugarch package to use this new
data and generate a new 1-step ahead forecast from t+1 to t+2? is this
possible?

Thanks in advance, I've read a lot of the rugarch documentation and from this mailing list, but I'm a bit lost regarding to my doubts. 

Any help will be really appreciated.

Best,


-- 
Diego Ignacio Acu?a Rozas
Mg. (c) Ciencias de la Ingenier?a Inform?tica
Universidad T?cnica Federico Santa Mar?a


From alexios at 4dscape.com  Thu Jun 25 22:21:04 2015
From: alexios at 4dscape.com (alexios)
Date: Thu, 25 Jun 2015 21:21:04 +0100
Subject: [R-SIG-Finance] Rugarch package using external regressors,
 a forecasting doubt
In-Reply-To: <558C6087.8030504@usm.cl>
References: <558C2A6D.5020609@usm.cl> <558C6087.8030504@usm.cl>
Message-ID: <558C62B0.3050900@4dscape.com>

As this appears to be a general point of confusion, see below a
commented example:

#########################
library(rugarch)
library(xts)
data(sp500ret)
spx<-xts(sp500ret, as.Date(rownames(sp500ret)))
xreg<-xts(rnorm(nrow(spx)), index(spx))
colnames(xreg)<-"xreg"
# assume xreg is an actual series, so we lag it
# as we would do in a real application
xreg = lag(xreg,1)
inputs<-na.omit(cbind(spx, xreg, join="left"))
# real time forecasting
spec<-ugarchspec(mean.model=list(external.regressors=inputs[1:2000,2]))
fit<-ugarchfit(spec, inputs[1:2000,1])
# 2 ways to do real-time forecasting (ugarchforecast and ugarchfilter)
# Example: forecast points 2001:2020
xforc = xts(matrix(NA, ncol=2, nrow=20), index(inputs[2001:2020]))
sforc = xts(matrix(NA, ncol=2, nrow=20), index(inputs[2001:2020]))
for(i in 1:20){
   # Forecast(T+1)|Information(T)
   # 1. Create a similar spec as you used in estimation
   # and add the lagged regressor upto time T
specf1<-ugarchspec(mean.model=list(external.regressors=inputs[1:(2000+i-1),2]))
   # Pass the estimated coefficients from the estimation upto time 2000
   setfixed(specf1)<-as.list(coef(fit))
   # 2. Forecast using ugarchforecast on a specification with fixed
parameters
   # where n.old is used in order to recreate the correct start-up
conditions
   # used in the fitting routine
   f1<-ugarchforecast(specf1, inputs[1:(2000+i-1),1], n.ahead=1, n.old=2000)
   # 3. Forecast using ugarchfilter on a specification with fixed 
parameters.
   # For this method, append a new row to the end of the data with zeros,
   # as you would do with related filters. This forces the routine to
   # output the value at time T+1
   newdat<-rbind(inputs[1:(2000+i-1),],xts(matrix(0, nrow=1, ncol=2),
tail(move(index(inputs[1:(2000+i-1)])),1)))
   specf2<-ugarchspec(mean.model=list(external.regressors=newdat[,2]))
   setfixed(specf2)<-as.list(coef(fit))
   f2<-ugarchfilter(specf2, newdat[,1], n.old=2000)
   # fitted = estimated conditional mean values for uGARCHfit objects
   # fitted = forecast/filtered conditional mean values for
uGARCHforecast/uGARCHfilter objects
   xforc[i,1] = as.numeric(fitted(f1))
   xforc[i,2] = as.numeric(tail(fitted(f2),1))
   # sigma = conditional sigma values (fitted/forecast etc)
   sforc[i,1] = as.numeric(sigma(f1))
   sforc[i,2] = as.numeric(tail(sigma(f2),1))
}
# check
all.equal(xforc[,1], xforc[,2])
all.equal(sforc[,1], sforc[,2])
# check that the 1-ahead forecast directly from the fitted object is also
# the same
all.equal(as.numeric(xforc[1,1]), as.numeric(fitted(ugarchforecast(fit,
n.ahead=1))))
all.equal(as.numeric(sforc[1,1]), as.numeric(sigma(ugarchforecast(fit,
n.ahead=1))))
# check the filter values vs the fitted values (i.e. why we use the
n.old argument)
all.equal(fitted(fit), fitted(f2)[1:2000])
all.equal(sigma(fit), sigma(f2)[1:2000])
#########################


Regards,

Alexios

On 25/06/2015 21:11, Diego Ignacio Acu?a Rozas wrote:
> Hi all, I'm using the rugarch package (which is btw an excellent piece
> of software). I'm
> using the A-PARCH(1,1) model with an external regressor (the Yang-Zhang
> volatility proxy) and I've a doubt about how to perform forecasting
> using the model:
>
>   * Suppose I've n observations for the returns of a financial serie and
> for the external regressor
>   * Then, I use ugarchspec with an A-PARCH(0,1) model with the external
> regressor, the ugarchspec and ugarchfit steps work pretty well.
>   * Now I want to do forecasting. I don't quite fully understand the
> limitation of this process. When I use ugarchforecast, the main
> limitation is that I only can forecast 1-step ahead due to the external
> regressor data limitation (I don't have more than n data for the
> external regressor)???
>
> Now, if I fit a model with the n external regressor data and if I do a
> 1-step ahead forecast for t+1, then the next day I recieve new data for
> the external regressor, how to use the rugarch package to use this new
> data and generate a new 1-step ahead forecast from t+1 to t+2? is this
> possible?
>
> Thanks in advance, I've read a lot of the rugarch documentation and from
> this mailing list, but I'm a bit lost regarding to my doubts.
> Any help will be really appreciated.
>
> Best,
>
>


From da_melendez at yahoo.com  Thu Jun 25 22:27:00 2015
From: da_melendez at yahoo.com (daniel melendez)
Date: Thu, 25 Jun 2015 20:27:00 +0000 (UTC)
Subject: [R-SIG-Finance] Question rmgarch package
Message-ID: <199816021.1582252.1435264020618.JavaMail.yahoo@mail.yahoo.com>

Hello All?- ?I am trying to?complete a?simulation based off of given information from a gogarchfit object but I seem?to be obtaining really low VaR numbers.??Can?anyone help explain this???Also I saw on a previous post from the?r-sig-finance mailing list that the?standardized residuals can be obtain?by taking the square?root of the?covariance matrix, however, I seem to be getting rather large numbers.? Can anyone help explain this too???Any help would greatly appreciated.? ?The code snippets are below:?# specs for GO-GARCH model
#----------------------------------------------------------------------------
spec = gogarchspec(mean.model = list(model = 'constant'),
? variance.model = list(model = 'eGARCH', 
? garchOrder = c(1, 1), variance.targeting = TRUE), 
? distribution = 'manig', ica = 'fastica', 
???????? ica.fix = list(A = est_mixing_matrix, K = whitening_matrix,
??????????????????????? W = est_unmixing_matrix, U = est_rotation_matrix,
??????????????????????? Kinv = dewhitening_matrix, Y = est_indep_components_matrix))?# GO-GARCH Fit
#----------------------------------------------------------------------------
cl <- makePSOCKcluster(3)
mod2 = gogarchfit(spec = spec, data = garchSeries, gfun = 'tanh', cluster = cl, 
????????????????? solver = "hybrid", firstEig = 1, lastEig = 4, 
????????????????? solver.control = list(trace = 1), 
????????????????? maxiter1 = 40000, epsilon = 1e-08, rseed = 972,
???fit.control = list(stationarity = 1)) 
??????????????????????????????????????????????????????? 
stopCluster(cl)??# Simulation Generation
# --------------------------------------------------------------------------------
cl <- makePSOCKcluster(3)
sim1 <- gogarchsim(mod2, n.sim = 50, n.start = 0, 
???m.sim = 5000, 
???rseed = 214, cluster = cl)
stopCluster(cl)?cf = convolution(sim1, weights = matrix(rep(1/10, 10), ncol = 10, nrow = 50)) 
VaR = matrix(NA, ncol = 2, nrow = 50)
colnames(VaR) = c('qfft[0.9999]', 'qfft[0.0001]')
for (i in 1:50){
??? qfx = qfft(cf, index = i)
??? VaR[i, 1] = qfx(0.9999)
??? VaR[i, 2] = qfx(0.0001)
}
matplot(VaR, type = 'l')??#----------------------------------------------------------------------# Calculate the standardized residuals for?the model
# ---------------------------------------------------------------------
residualsModel <- residuals(mod2)
cov.sq <- rcov(mod2)
sq.cov <- array(NA, dim = c(dim(cov.sq)[1],
??????????????????????????? dim(cov.sq)[2],
??????????????????????????? dim(cov.sq)[3]))
sq.cov.mat <- function (x){
??? tmp = svd(x)
??? sqrtx = tmp$u %*% sqrt(diag(tmp$d)) %*% t(tmp$u)
??? return(sqrtx)
}
for(i in 1:dim(cov.sq)[3]){
??? sq.cov[,,i] <- solve(sq.cov.mat(cov.sq[,,i]))
}
stand.resid <- matrix(NA, ncol = ncol(residualsModel), nrow = nrow(residualsModel))
for(i in 1:dim(sq.cov)[3]){
??? stand.resid[i,] <- t(sq.cov[,,i] %*% as.numeric(residualsModel[i,]))? 
}?????Regards 
Daniel Melendez
	[[alternative HTML version deleted]]


From diego.acuna at usm.cl  Fri Jun 26 03:22:39 2015
From: diego.acuna at usm.cl (=?windows-1252?Q?Diego_Ignacio_Acu=F1a_Rozas?=)
Date: Thu, 25 Jun 2015 22:22:39 -0300
Subject: [R-SIG-Finance] Rugarch package using external regressors,
 a forecasting doubt
In-Reply-To: <558C62B0.3050900@4dscape.com>
References: <558C2A6D.5020609@usm.cl> <558C6087.8030504@usm.cl>
	<558C62B0.3050900@4dscape.com>
Message-ID: <558CA95F.8040607@usm.cl>

Thanks alexios, your example was a tremendous help to my case.

Best,

alexios wrote:
>
> As this appears to be a general point of confusion, see below a
> commented example:
>
> #########################
> library(rugarch)
> library(xts)
> data(sp500ret)
> spx<-xts(sp500ret, as.Date(rownames(sp500ret)))
> xreg<-xts(rnorm(nrow(spx)), index(spx))
> colnames(xreg)<-"xreg"
> # assume xreg is an actual series, so we lag it
> # as we would do in a real application
> xreg = lag(xreg,1)
> inputs<-na.omit(cbind(spx, xreg, join="left"))
> # real time forecasting
> spec<-ugarchspec(mean.model=list(external.regressors=inputs[1:2000,2]))
> fit<-ugarchfit(spec, inputs[1:2000,1])
> # 2 ways to do real-time forecasting (ugarchforecast and ugarchfilter)
> # Example: forecast points 2001:2020
> xforc = xts(matrix(NA, ncol=2, nrow=20), index(inputs[2001:2020]))
> sforc = xts(matrix(NA, ncol=2, nrow=20), index(inputs[2001:2020]))
> for(i in 1:20){
> # Forecast(T+1)|Information(T)
> # 1. Create a similar spec as you used in estimation
> # and add the lagged regressor upto time T
> specf1<-ugarchspec(mean.model=list(external.regressors=inputs[1:(2000+i-1),2])) 
>
>
> # Pass the estimated coefficients from the estimation upto time 2000
> setfixed(specf1)<-as.list(coef(fit))
> # 2. Forecast using ugarchforecast on a specification with fixed
> parameters
> # where n.old is used in order to recreate the correct start-up
> conditions
> # used in the fitting routine
> f1<-ugarchforecast(specf1, inputs[1:(2000+i-1),1], n.ahead=1, n.old=2000)
> # 3. Forecast using ugarchfilter on a specification with fixed
> parameters.
> # For this method, append a new row to the end of the data with zeros,
> # as you would do with related filters. This forces the routine to
> # output the value at time T+1
> newdat<-rbind(inputs[1:(2000+i-1),],xts(matrix(0, nrow=1, ncol=2),
> tail(move(index(inputs[1:(2000+i-1)])),1)))
> specf2<-ugarchspec(mean.model=list(external.regressors=newdat[,2]))
> setfixed(specf2)<-as.list(coef(fit))
> f2<-ugarchfilter(specf2, newdat[,1], n.old=2000)
> # fitted = estimated conditional mean values for uGARCHfit objects
> # fitted = forecast/filtered conditional mean values for
> uGARCHforecast/uGARCHfilter objects
> xforc[i,1] = as.numeric(fitted(f1))
> xforc[i,2] = as.numeric(tail(fitted(f2),1))
> # sigma = conditional sigma values (fitted/forecast etc)
> sforc[i,1] = as.numeric(sigma(f1))
> sforc[i,2] = as.numeric(tail(sigma(f2),1))
> }
> # check
> all.equal(xforc[,1], xforc[,2])
> all.equal(sforc[,1], sforc[,2])
> # check that the 1-ahead forecast directly from the fitted object is also
> # the same
> all.equal(as.numeric(xforc[1,1]), as.numeric(fitted(ugarchforecast(fit,
> n.ahead=1))))
> all.equal(as.numeric(sforc[1,1]), as.numeric(sigma(ugarchforecast(fit,
> n.ahead=1))))
> # check the filter values vs the fitted values (i.e. why we use the
> n.old argument)
> all.equal(fitted(fit), fitted(f2)[1:2000])
> all.equal(sigma(fit), sigma(f2)[1:2000])
> #########################
>
>
> Regards,
>
> Alexios
>
> On 25/06/2015 21:11, Diego Ignacio Acu?a Rozas wrote:
>>
>> Hi all, I'm using the rugarch package (which is btw an excellent piece
>> of software). I'm
>> using the A-PARCH(1,1) model with an external regressor (the Yang-Zhang
>> volatility proxy) and I've a doubt about how to perform forecasting
>> using the model:
>>
>> * Suppose I've n observations for the returns of a financial serie and
>> for the external regressor
>> * Then, I use ugarchspec with an A-PARCH(0,1) model with the external
>> regressor, the ugarchspec and ugarchfit steps work pretty well.
>> * Now I want to do forecasting. I don't quite fully understand the
>> limitation of this process. When I use ugarchforecast, the main
>> limitation is that I only can forecast 1-step ahead due to the external
>> regressor data limitation (I don't have more than n data for the
>> external regressor)???
>>
>> Now, if I fit a model with the n external regressor data and if I do a
>> 1-step ahead forecast for t+1, then the next day I recieve new data for
>> the external regressor, how to use the rugarch package to use this new
>> data and generate a new 1-step ahead forecast from t+1 to t+2? is this
>> possible?
>>
>> Thanks in advance, I've read a lot of the rugarch documentation and from
>> this mailing list, but I'm a bit lost regarding to my doubts.
>> Any help will be really appreciated.
>>
>> Best,
>>
>>
>


alexios wrote:
> As this appears to be a general point of confusion, see below a
> commented example:
>
> #########################
> library(rugarch)
> library(xts)
> data(sp500ret)
> spx<-xts(sp500ret, as.Date(rownames(sp500ret)))
> xreg<-xts(rnorm(nrow(spx)), index(spx))
> colnames(xreg)<-"xreg"
> # assume xreg is an actual series, so we lag it
> # as we would do in a real application
> xreg = lag(xreg,1)
> inputs<-na.omit(cbind(spx, xreg, join="left"))
> # real time forecasting
> spec<-ugarchspec(mean.model=list(external.regressors=inputs[1:2000,2]))
> fit<-ugarchfit(spec, inputs[1:2000,1])
> # 2 ways to do real-time forecasting (ugarchforecast and ugarchfilter)
> # Example: forecast points 2001:2020
> xforc = xts(matrix(NA, ncol=2, nrow=20), index(inputs[2001:2020]))
> sforc = xts(matrix(NA, ncol=2, nrow=20), index(inputs[2001:2020]))
> for(i in 1:20){
>   # Forecast(T+1)|Information(T)
>   # 1. Create a similar spec as you used in estimation
>   # and add the lagged regressor upto time T
> specf1<-ugarchspec(mean.model=list(external.regressors=inputs[1:(2000+i-1),2])) 
>
>   # Pass the estimated coefficients from the estimation upto time 2000
>   setfixed(specf1)<-as.list(coef(fit))
>   # 2. Forecast using ugarchforecast on a specification with fixed
> parameters
>   # where n.old is used in order to recreate the correct start-up
> conditions
>   # used in the fitting routine
>   f1<-ugarchforecast(specf1, inputs[1:(2000+i-1),1], n.ahead=1, 
> n.old=2000)
>   # 3. Forecast using ugarchfilter on a specification with fixed 
> parameters.
>   # For this method, append a new row to the end of the data with zeros,
>   # as you would do with related filters. This forces the routine to
>   # output the value at time T+1
>   newdat<-rbind(inputs[1:(2000+i-1),],xts(matrix(0, nrow=1, ncol=2),
> tail(move(index(inputs[1:(2000+i-1)])),1)))
>   specf2<-ugarchspec(mean.model=list(external.regressors=newdat[,2]))
>   setfixed(specf2)<-as.list(coef(fit))
>   f2<-ugarchfilter(specf2, newdat[,1], n.old=2000)
>   # fitted = estimated conditional mean values for uGARCHfit objects
>   # fitted = forecast/filtered conditional mean values for
> uGARCHforecast/uGARCHfilter objects
>   xforc[i,1] = as.numeric(fitted(f1))
>   xforc[i,2] = as.numeric(tail(fitted(f2),1))
>   # sigma = conditional sigma values (fitted/forecast etc)
>   sforc[i,1] = as.numeric(sigma(f1))
>   sforc[i,2] = as.numeric(tail(sigma(f2),1))
> }
> # check
> all.equal(xforc[,1], xforc[,2])
> all.equal(sforc[,1], sforc[,2])
> # check that the 1-ahead forecast directly from the fitted object is also
> # the same
> all.equal(as.numeric(xforc[1,1]), as.numeric(fitted(ugarchforecast(fit,
> n.ahead=1))))
> all.equal(as.numeric(sforc[1,1]), as.numeric(sigma(ugarchforecast(fit,
> n.ahead=1))))
> # check the filter values vs the fitted values (i.e. why we use the
> n.old argument)
> all.equal(fitted(fit), fitted(f2)[1:2000])
> all.equal(sigma(fit), sigma(f2)[1:2000])
> #########################
>
>
> Regards,
>
> Alexios
>
> On 25/06/2015 21:11, Diego Ignacio Acu?a Rozas wrote:
>> Hi all, I'm using the rugarch package (which is btw an excellent piece
>> of software). I'm
>> using the A-PARCH(1,1) model with an external regressor (the Yang-Zhang
>> volatility proxy) and I've a doubt about how to perform forecasting
>> using the model:
>>
>>   * Suppose I've n observations for the returns of a financial serie and
>> for the external regressor
>>   * Then, I use ugarchspec with an A-PARCH(0,1) model with the external
>> regressor, the ugarchspec and ugarchfit steps work pretty well.
>>   * Now I want to do forecasting. I don't quite fully understand the
>> limitation of this process. When I use ugarchforecast, the main
>> limitation is that I only can forecast 1-step ahead due to the external
>> regressor data limitation (I don't have more than n data for the
>> external regressor)???
>>
>> Now, if I fit a model with the n external regressor data and if I do a
>> 1-step ahead forecast for t+1, then the next day I recieve new data for
>> the external regressor, how to use the rugarch package to use this new
>> data and generate a new 1-step ahead forecast from t+1 to t+2? is this
>> possible?
>>
>> Thanks in advance, I've read a lot of the rugarch documentation and from
>> this mailing list, but I'm a bit lost regarding to my doubts.
>> Any help will be really appreciated.
>>
>> Best,
>>
>>
>

-- 
Diego Ignacio Acu?a Rozas
Mg. (c) Ciencias de la Ingenier?a Inform?tica
Universidad T?cnica Federico Santa Mar?a


From alexios at 4dscape.com  Fri Jun 26 10:00:00 2015
From: alexios at 4dscape.com (alexios ghalanos)
Date: Fri, 26 Jun 2015 09:00:00 +0100
Subject: [R-SIG-Finance] Question rmgarch package
In-Reply-To: <199816021.1582252.1435264020618.JavaMail.yahoo@mail.yahoo.com>
References: <199816021.1582252.1435264020618.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <558D0680.8060603@4dscape.com>

There could be any number of reasons this is happening, but I just can't
tell from the information you've provided. I suggest you try to
eliminate some possibilities as a first pass:

1. Use: startMethod = "sample" (in gogarchsim)
2. You're providing your own ICA decomposition matrices in the spec.
Try using the default estimation first (and set n.comp=4) without
providing your own matrices.
3. Try without dimensionality reduction.
4. The convolution method has additional fine tuning parameters. You may
need to adjust those (fft.step, fft.by etc).
5. For comparison, try a Cornish-Fisher expansion as explained here:
http://unstarched.net/r-examples/rmgarch/var-and-approximate-var-in-the-go-garch-nig-model/

Regards,

Alexios

On 25/06/2015 21:27, daniel melendez via R-SIG-Finance wrote:
> Hello All -  I am trying to complete a simulation based off of given information from a gogarchfit object but I seem to be obtaining really low VaR numbers.  Can anyone help explain this?  Also I saw on a previous post from the r-sig-finance mailing list that the standardized residuals can be obtain by taking the square root of the covariance matrix, however, I seem to be getting rather large numbers.  Can anyone help explain this too?  Any help would greatly appreciated.   The code snippets are below: # specs for GO-GARCH model
> #----------------------------------------------------------------------------
> spec = gogarchspec(mean.model = list(model = 'constant'),
>   variance.model = list(model = 'eGARCH', 
>   garchOrder = c(1, 1), variance.targeting = TRUE), 
>   distribution = 'manig', ica = 'fastica', 
>          ica.fix = list(A = est_mixing_matrix, K = whitening_matrix,
>                         W = est_unmixing_matrix, U = est_rotation_matrix,
>                         Kinv = dewhitening_matrix, Y = est_indep_components_matrix)) # GO-GARCH Fit
> #----------------------------------------------------------------------------
> cl <- makePSOCKcluster(3)
> mod2 = gogarchfit(spec = spec, data = garchSeries, gfun = 'tanh', cluster = cl, 
>                   solver = "hybrid", firstEig = 1, lastEig = 4, 
>                   solver.control = list(trace = 1), 
>                   maxiter1 = 40000, epsilon = 1e-08, rseed = 972,
>    fit.control = list(stationarity = 1)) 
>                                                         
> stopCluster(cl)  # Simulation Generation
> # --------------------------------------------------------------------------------
> cl <- makePSOCKcluster(3)
> sim1 <- gogarchsim(mod2, n.sim = 50, n.start = 0, 
>    m.sim = 5000, 
>    rseed = 214, cluster = cl)
> stopCluster(cl) cf = convolution(sim1, weights = matrix(rep(1/10, 10), ncol = 10, nrow = 50)) 
> VaR = matrix(NA, ncol = 2, nrow = 50)
> colnames(VaR) = c('qfft[0.9999]', 'qfft[0.0001]')
> for (i in 1:50){
>     qfx = qfft(cf, index = i)
>     VaR[i, 1] = qfx(0.9999)
>     VaR[i, 2] = qfx(0.0001)
> }
> matplot(VaR, type = 'l')  #----------------------------------------------------------------------# Calculate the standardized residuals for the model
> # ---------------------------------------------------------------------
> residualsModel <- residuals(mod2)
> cov.sq <- rcov(mod2)
> sq.cov <- array(NA, dim = c(dim(cov.sq)[1],
>                             dim(cov.sq)[2],
>                             dim(cov.sq)[3]))
> sq.cov.mat <- function (x){
>     tmp = svd(x)
>     sqrtx = tmp$u %*% sqrt(diag(tmp$d)) %*% t(tmp$u)
>     return(sqrtx)
> }
> for(i in 1:dim(cov.sq)[3]){
>     sq.cov[,,i] <- solve(sq.cov.mat(cov.sq[,,i]))
> }
> stand.resid <- matrix(NA, ncol = ncol(residualsModel), nrow = nrow(residualsModel))
> for(i in 1:dim(sq.cov)[3]){
>     stand.resid[i,] <- t(sq.cov[,,i] %*% as.numeric(residualsModel[i,]))  
> }     Regards 
> Daniel Melendez
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From zadig_1 at excite.com  Fri Jun 26 15:25:16 2015
From: zadig_1 at excite.com (ce)
Date: Fri, 26 Jun 2015 09:25:16 -0400
Subject: [R-SIG-Finance] IBrokers package: checking order status
Message-ID: <20150626092516.10276@web001.roc2.bluetie.com>


order status is sent by TWS . You need to set up a eWrapper function to read them. 
there is an example of ReqExecution in http://r.789695.n4.nabble.com/file/n4619486/example.r 
but I couldn't make it work . 
yahoo group twsapi is more active you can ask there but there is not many R programmers there. 
https://groups.yahoo.com/neo/groups/twsapi/conversations/messages

last there is a working example in http://censix.com/downloads.html


-----Original Message-----
From: "Robert Schien" [robsch at robsch.eu]
Date: 06/16/2015 03:20 PM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] IBrokers package: checking order status

Hello,

Is there a possibility in the IBrokers package t0 check the
status of orders or executions?

I searched around and found some old posts in this list
which described a reqExecutions function.
But is not documented in the vignette!
Is this function unreliable?

What else can I do the check order status?

Thnaks in advance.
Robert

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From danielmelendez at alum.northwestern.edu  Mon Jun 29 21:31:40 2015
From: danielmelendez at alum.northwestern.edu (Daniel Melendez)
Date: Mon, 29 Jun 2015 14:31:40 -0500
Subject: [R-SIG-Finance] Question RMGARCH
Message-ID: <CAEjpDDpXJOJRMS2+jM+c2pTdibd7BaNoWRzA=zh+FstHcXy8Vw@mail.gmail.com>

Hello All -

Perhaps I am overlooking something but can anyone tell me what the
following relates to in the rmgarch package?

rcov( [object], type = 2 )

-- 
Regards

Daniel Melendez

=========================================================================

	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Mon Jun 29 21:38:05 2015
From: alexios at 4dscape.com (alexios)
Date: Mon, 29 Jun 2015 20:38:05 +0100
Subject: [R-SIG-Finance] Question RMGARCH
In-Reply-To: <CAEjpDDpXJOJRMS2+jM+c2pTdibd7BaNoWRzA=zh+FstHcXy8Vw@mail.gmail.com>
References: <CAEjpDDpXJOJRMS2+jM+c2pTdibd7BaNoWRzA=zh+FstHcXy8Vw@mail.gmail.com>
Message-ID: <55919E9D.50104@4dscape.com>

Returns the diagonal factor covariance matrix (i.e. the conditional 
variances of the independent factors). The H_t matrix in equation 33 of 
the vignette.

-Alexios

On 29/06/2015 20:31, Daniel Melendez wrote:
> Hello All -
>
> Perhaps I am overlooking something but can anyone tell me what the
> following relates to in the rmgarch package?
>
> rcov( [object], type = 2 )
>


From danielmelendez at alum.northwestern.edu  Mon Jun 29 21:41:08 2015
From: danielmelendez at alum.northwestern.edu (Daniel Melendez)
Date: Mon, 29 Jun 2015 14:41:08 -0500
Subject: [R-SIG-Finance] Question RMGARCH
In-Reply-To: <55919E9D.50104@4dscape.com>
References: <CAEjpDDpXJOJRMS2+jM+c2pTdibd7BaNoWRzA=zh+FstHcXy8Vw@mail.gmail.com>
	<55919E9D.50104@4dscape.com>
Message-ID: <CAEjpDDo1MXUUY8eqR9KV_iWzXPeorbvPniUWLzOvnUCFxE7VeQ@mail.gmail.com>

Thank you very much Alexios, that's what I figured it was but wanted to
confirm.  Cheers

On Mon, Jun 29, 2015 at 2:38 PM, alexios <alexios at 4dscape.com> wrote:

> Returns the diagonal factor covariance matrix (i.e. the conditional
> variances of the independent factors). The H_t matrix in equation 33 of the
> vignette.
>
> -Alexios
>
>
> On 29/06/2015 20:31, Daniel Melendez wrote:
>
>> Hello All -
>>
>> Perhaps I am overlooking something but can anyone tell me what the
>> following relates to in the rmgarch package?
>>
>> rcov( [object], type = 2 )
>>
>>
>


-- 
Regards

Daniel Melendez

=========================================================================

	[[alternative HTML version deleted]]


