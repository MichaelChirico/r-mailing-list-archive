From edd at debian.org  Sat Jan  1 00:40:14 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 31 Dec 2010 17:40:14 -0600
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
	<AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>
	<6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <19742.27102.191985.671720@max.nulle.part>


On 31 December 2010 at 20:53, Paul Gilbert wrote:
| Perhaps there would be too much overlap with R-SIG-Finance, but does anyone think
| an  R-SIG-MacroEcon list would be useful?

Speaking with listowner hat on, you are most certainly welcome to start such
discussions here.  If and when it becomes to dominant, we can still review
splitting up.  

Happy New Year to all.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From michael at velocity-trading.com  Sat Jan  1 12:59:49 2011
From: michael at velocity-trading.com (Michael Berman)
Date: Sat, 1 Jan 2011 22:59:49 +1100
Subject: [R-SIG-Finance] Forum for Macro-economics discussion
In-Reply-To: <mailman.3.1293879602.20065.r-sig-finance@r-project.org>
References: <mailman.3.1293879602.20065.r-sig-finance@r-project.org>
Message-ID: <042601cba9ab$668b7b70$33a27250$@com>

Hi Paul,

I think it would be great to see more Macro-economic R coding discussion in
this forum.

Mike

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of
r-sig-finance-request at r-project.org
Sent: Saturday, 1 January 2011 10:00 PM
To: r-sig-finance at r-project.org
Subject: R-SIG-Finance Digest, Vol 80, Issue 1

Send R-SIG-Finance mailing list submissions to
	r-sig-finance at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-finance
or, via email, send a message with subject or body 'help' to
	r-sig-finance-request at r-project.org

You can reach the person managing the list at
	r-sig-finance-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-SIG-Finance digest..."


Today's Topics:

   1. Re: [off-topic] Forum for Macro-economics discussion
      (Paul Gilbert)
   2. Re: [off-topic] Forum for Macro-economics discussion
      (Dirk Eddelbuettel)


----------------------------------------------------------------------

Message: 1
Date: Fri, 31 Dec 2010 20:53:23 +0000
From: Paul Gilbert <pgilbert at bank-banque-canada.ca>
To: Michael Dothan <mdothan at gmail.com>, Christofer Bogaso
	<bogaso.christofer at gmail.com>, Eric Zivot <ezivot at u.washington.edu>
Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] [off-topic] Forum for Macro-economics
	discussion
Message-ID:
	
<6441154A9FF1CD4386AF4ABF141A056D01F63C at WMEXOSCD2-N1.bocad.bank-banque-canad
a.ca>
	
Content-Type: text/plain; charset="utf-8"

Perhaps there would be too much overlap with R-SIG-Finance, but does anyone
think
an  R-SIG-MacroEcon list would be useful?

Paul

>-----Original Message-----
>From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-
>bounces at r-project.org] On Behalf Of Michael Dothan
>Sent: December 20, 2010 7:23 PM
>To: Christofer Bogaso
>Cc: r-sig-finance at r-project.org
>Subject: Re: [R-SIG-Finance] [off-topic] Forum for Macro-economics
>discussion
>
>Check out these sites:
>
>http://baselinescenario.com/
>
>http://www.nakedcapitalism.com/
>
>http://www.voxeu.org/
>
>http://modelsagents.blogspot.com/
>
>http://krugman.blogs.nytimes.com/
>
>Best,
>
>Michael
>
>On 12/20/10, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
>> Hi friends, I am looking for some good and well active forums for
>> Macro-economics related discussions. Can people here name a few on
>that?
>>
>> Thanks and regards,
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
>questions
>> should go.
>>
>
>_______________________________________________
>R-SIG-Finance at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>-- Subscriber-posting only. If you want to post, subscribe first.
>-- Also note that this is not the r-help list where general R questions
>should go.
============================================================================
========

La version fran?aise suit le texte anglais.

----------------------------------------------------------------------------
--------

This email may contain privileged and/or confidential information, and the
Bank of
Canada does not waive any related rights. Any distribution, use, or copying
of this
email or the information it contains by other than the intended recipient is
unauthorized. If you received this email in error please delete it
immediately from
your system and notify the sender promptly by email that you have done so. 

----------------------------------------------------------------------------
--------

Le pr?sent courriel peut contenir de l'information privil?gi?e ou
confidentielle.
La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute
diffusion,
utilisation ou copie de ce courriel ou des renseignements qu'il contient par
une
personne autre que le ou les destinataires d?sign?s est interdite. Si vous
recevez
ce courriel par erreur, veuillez le supprimer imm?diatement et envoyer sans
d?lai ?
l'exp?diteur un message ?lectronique pour l'aviser que vous avez ?limin? de
votre
ordinateur toute copie du courriel re?u.

------------------------------

Message: 2
Date: Fri, 31 Dec 2010 17:40:14 -0600
From: Dirk Eddelbuettel <edd at debian.org>
To: Paul Gilbert <pgilbert at bank-banque-canada.ca>
Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] [off-topic] Forum for Macro-economics
	discussion
Message-ID: <19742.27102.191985.671720 at max.nulle.part>
Content-Type: text/plain; charset=us-ascii


On 31 December 2010 at 20:53, Paul Gilbert wrote:
| Perhaps there would be too much overlap with R-SIG-Finance, but does
anyone think
| an  R-SIG-MacroEcon list would be useful?

Speaking with listowner hat on, you are most certainly welcome to start such
discussions here.  If and when it becomes to dominant, we can still review
splitting up.  

Happy New Year to all.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com



------------------------------

_______________________________________________
R-SIG-Finance mailing list
R-SIG-Finance at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-finance


End of R-SIG-Finance Digest, Vol 80, Issue 1


From wlmr at zhaw.ch  Sat Jan  1 13:45:45 2011
From: wlmr at zhaw.ch (Wildi Marc (wlmr))
Date: Sat, 1 Jan 2011 12:45:45 +0000
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <19742.27102.191985.671720@max.nulle.part>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
	<AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>
	<6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>,
	<19742.27102.191985.671720@max.nulle.part>
Message-ID: <E2339A3600811248AB525B8FAB3A1BCE13DAB280@srv-mail-101.zhaw.ch>

Happy new-year to everybody.

I'd happily contribute to the topic:

http://www.idp.zhaw.ch/usri
http://www.idp.zhaw.ch/MDFA-XT
http://blog.zhaw.ch/idp/sefblog

Marc
________________________________________
Von: r-sig-finance-bounces at r-project.org [r-sig-finance-bounces at r-project.org]&quot; im Auftrag von &quot;Dirk Eddelbuettel [edd at debian.org]
Gesendet: Samstag, 1. Januar 2011 00:40
Bis: Paul Gilbert
Cc: r-sig-finance at r-project.org
Betreff: Re: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion

On 31 December 2010 at 20:53, Paul Gilbert wrote:
| Perhaps there would be too much overlap with R-SIG-Finance, but does anyone think
| an  R-SIG-MacroEcon list would be useful?

Speaking with listowner hat on, you are most certainly welcome to start such
discussions here.  If and when it becomes to dominant, we can still review
splitting up.

Happy New Year to all.

Dirk

--
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

From gero.schwenk at web.de  Sat Jan  1 18:23:57 2011
From: gero.schwenk at web.de (Gero Schwenk)
Date: Sat, 01 Jan 2011 18:23:57 +0100
Subject: [R-SIG-Finance] PerformanceAnalytics: Error computing component-VaR
	using method="kernel"
Message-ID: <4D1F632D.80209@web.de>

Hi there and a happy new year!
I've got a question regarding the VaR-function from the 
PerformanceAnalytics-package. When I call it in order to compute VaR 
contributions using the nonparametric kernel estimator, I get an error 
report. Obviously this is independent of my data, because I can 
replicate it using the edhec example data, as shown below. Does anybody 
have a hint how to deal with this problem?

Cheers,
Gero

###

library(PerformanceAnalytics)
data(edhec)
VaR(R=edhec, method="kernel", portfolio_method = "component")

###

 > VaR(R=edhec, method="kernel", portfolio_method = "component")
no weights passed in, assuming equal weighted portfolio
Fehler in `colnames<-`(`*tmp*`, value = c("Convertible Arbitrage", "CTA 
Global",  :
  attempt to set colnames on object with less than two dimensions


From brian at braverock.com  Sat Jan  1 19:25:32 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 01 Jan 2011 12:25:32 -0600
Subject: [R-SIG-Finance] PerformanceAnalytics: Error computing
 component-VaR using method="kernel"
In-Reply-To: <4D1F632D.80209@web.de>
References: <4D1F632D.80209@web.de>
Message-ID: <4D1F719C.3040702@braverock.com>

On 01/01/2011 11:23 AM, Gero Schwenk wrote:
> I've got a question regarding the VaR-function from the
> PerformanceAnalytics-package. When I call it in order to compute VaR
> contributions using the nonparametric kernel estimator, I get an error
> report. Obviously this is independent of my data, because I can
> replicate it using the edhec example data, as shown below. Does anybody
> have a hint how to deal with this problem?

Looks like a bug, I can replicate it here.  Not sure what's broken yet, 
as this all had to work when we sent it to CRAN recently.  We'll debug 
and patch.  ES is broken too with method='kernel'

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From whitneybroach at gmail.com  Sat Jan  1 21:39:39 2011
From: whitneybroach at gmail.com (Whitney Broach)
Date: Sat, 1 Jan 2011 13:39:39 -0700
Subject: [R-SIG-Finance] More general list?
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAALle0KqvRYJIkiggmtMX/W6CgQAAEAAAACuvM/t5G3RJodj4V4v3di0BAAAAAA==@gmail.com>

Happy New Year!
Where is a more general R list?  I might need to work on the basics there
before continuing here.
Best regards,


Checked by AVG - www.avg.com 

00:34:00


From josh.m.ulrich at gmail.com  Sat Jan  1 21:46:47 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 1 Jan 2011 14:46:47 -0600
Subject: [R-SIG-Finance] More general list?
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAALle0KqvRYJIkiggmtMX/W6CgQAAEAAAACuvM/t5G3RJodj4V4v3di0BAAAAAA==@gmail.com>
References: <!&!AAAAAAAAAAAYAAAAAAAAALle0KqvRYJIkiggmtMX/W6CgQAAEAAAACuvM/t5G3RJodj4V4v3di0BAAAAAA==@gmail.com>
Message-ID: <AANLkTin_e-7Z7uqRF+hSPOBbGoPNydyfe3DNM7c2J01X@mail.gmail.com>

Whitney,

Please search before posting.  A search for "general mailing list" on
www.rseek.org yielded
http://www.r-project.org/mail.html
as the first result.

The tools below are better than just using Google to search:
http://www.r-project.org/search.html

You want R-help.  Make sure to read the posting guide.
https://stat.ethz.ch/mailman/listinfo/r-help

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Sat, Jan 1, 2011 at 2:39 PM, Whitney Broach <whitneybroach at gmail.com> wrote:
> Happy New Year!
> Where is a more general R list? ?I might need to work on the basics there
> before continuing here.
> Best regards,
>
>
> Checked by AVG - www.avg.com
>
> 00:34:00
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From jctoll at gmail.com  Sun Jan  2 03:19:28 2011
From: jctoll at gmail.com (jctoll)
Date: Sat, 1 Jan 2011 20:19:28 -0600
Subject: [R-SIG-Finance] yahooKeystats broken?
In-Reply-To: <AANLkTi=VpR_c7MgAHJSaSUzpYpZosfHCuz2GHvcFbQ5e@mail.gmail.com>
References: <AANLkTi=VpR_c7MgAHJSaSUzpYpZosfHCuz2GHvcFbQ5e@mail.gmail.com>
Message-ID: <AANLkTi=pvpOQoyNQPxpuY5PUHh=EbvnRtG7pXqoq=cKA@mail.gmail.com>

On Thu, Dec 23, 2010 at 9:29 AM, jctoll <jctoll at gmail.com> wrote:
> Hi,
>
> I've been trying to use the yahooKeystats function from fImport, but I
> think it may be broken.
>
>> yahooKeystats("IBM", try=FALSE)
> trying URL 'http://finance.yahoo.com/q/ks?s=IBM'
> Content type 'text/html; charset=utf-8' length unknown
> opened URL
> .......... .......... .......... ...
> downloaded 33 Kb
>
> Read 151 items
> Error in matrix(unlist(strsplit(x, "@")), byrow = TRUE, ncol = 2) :
> ?attempt to set an attribute on NULL
>
> I tried to check out the code and the problem is that x is basically
> empty when it gets passed to matrix().
>
> I think the problem is with this earlier section of code:
>
> if (length(Index) > 0)
> ? ? ? ? ? ?x = x[-Index]
>
> I'm not sure what they were trying to do with that code, but this
> looks like the problem.
>
> I was hoping someone could confirm whether yahooKeystats is working or
> not for them.
>
> Thanks,
>
>
> James
>
>
>
>> sessionInfo()
> R version 2.12.1 (2010-12-16)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] graphics ?grDevices utils ? ? datasets ?stats ? ? methods ? base
>
> other attached packages:
> [1] fImport_2110.79 ? ? ? ? ? ? ?timeSeries_2130.90
> timeDate_2130.91 ? ? ? ? ? ? PerformanceAnalytics_1.0.3.2
> [5] quantmod_0.3-15 ? ? ? ? ? ? ?Defaults_1.1-1
> TTR_0.20-2 ? ? ? ? ? ? ? ? ? xts_0.7-5
> [9] zoo_1.6-4
>
> loaded via a namespace (and not attached):
> [1] grid_2.12.1 ? ? lattice_0.19-13
>

Hi,

In case anyone else needs to use yahooKeystats, I am including the
edited code I used to get it working.  It appears Yahoo has changed
their page format again.  Additionally, there is a typographical error
within the html that requires a temporary work-around until it is
fixed.  It's not pretty but it works for me.

James



function (query, file = "tempfile", source = NULL, save = FALSE,
    try = TRUE)
{
    if (is.null(source))
        source = "http://finance.yahoo.com/q/ks?s="
    if (try) {
        z = try(yahooKeystats(query, file, source, save, try = FALSE))
        if (class(z) == "try-error" || class(z) == "Error") {
            return("No Internet Access")
        }
        else {
            return(z)
        }
    }
    else {
        url = paste(source, query, sep = "")
        download.file(url = url, destfile = file)
        x = scan(file, what = "", sep = "\n")
        x = x[grep("datamodoutline1", x)]
        if (!length(x))
            return(NA)
        x = gsub("/", "", x, perl = TRUE)
        x = gsub(" class=.yfnc_\\w+.", "", x, perl = TRUE)
             # added
        x = gsub(" colspan=.2.", "", x, perl = TRUE)
        x = gsub(" cell.......=...", "", x, perl = TRUE)
        x = gsub(" border=...", "", x, perl = TRUE)
        x = gsub(" align=.\\w+.", "", x, perl = TRUE)
                 # added
        x = gsub(".nbsp.", "", x, perl = TRUE)
                   # added
        x = gsub("Financial Highlights", "", x, perl = TRUE)
              # added
        x = gsub(" style=.display.block. height.10px.", "", x, perl =
TRUE)   # added
        x = gsub(" id=.yfs_j10_\\w+.", "", x, perl = TRUE)
              # added
        x = gsub(" width=.74%.>", "", x, perl = TRUE)
              # edited
        x = gsub(" width=.100%.", "", x, perl = TRUE)
        x = gsub(" size=.-1.", "", x, perl = TRUE)
        x = gsub("<.>", "", x, perl = TRUE)
        x = gsub("<..>", "", x, perl = TRUE)
        x = gsub("<....>", "", x, perl = TRUE)
        x = gsub("<table>", "", x, perl = TRUE)
        x = gsub("<sup>.<sup>", "", x, perl = TRUE)
        x = gsub("&amp;", "&", x, perl = TRUE)
        x = gsub("<td", " @ ", x, perl = TRUE)
        x = gsub(",", "", x, perl = TRUE)
        x = unlist(strsplit(x, "@"))
        x = x[grep(":", x)]
        x = gsub("^ ", "", x, perl = TRUE)
        Index = grep("^ ", x)
        if (length(Index) > 0)
            x = x[-Index]
        x = gsub(" $", "", x, perl = TRUE)
        x = gsub(":$", ":NA", x, perl = TRUE)
        x = sub(":", "@", x)
        x = sub(":", "/", x)
        x = matrix(unlist(strsplit(x, "@")), byrow = TRUE, ncol = 2)
        stats = as.character(Sys.Date())
        x = rbind(c("Symbol", query), c("Date", stats), x)
        x[53,1] <- "Trailing Annual Dividend Rate"
 # added temporary kludge to fix yahoo typo
        X = as.data.frame(x[, 2])
        rownames(X) = x[, 1]
        colnames(X) = "Value"
    }
    X
}


From ajayshah at mayin.org  Sat Jan  1 05:09:20 2011
From: ajayshah at mayin.org (Ajay Shah)
Date: Sat, 1 Jan 2011 09:39:20 +0530
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
	<AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>
	<6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <20110101040920.GA1026@Ajay-Shahs-MacBook-Pro-3.local>

On Fri, Dec 31, 2010 at 08:53:23PM +0000, Paul Gilbert wrote:
> Perhaps there would be too much overlap with R-SIG-Finance, but does anyone think
> an  R-SIG-MacroEcon list would be useful?
> 
> Paul

I think it's time to start this.

-- 
Ajay Shah                                      http://www.mayin.org/ajayshah  
ajayshah at mayin.org                             http://ajayshahblog.blogspot.com
<*(:-? - wizard who doesn't know the answer.


From matthieu.stigler at gmail.com  Sun Jan  2 14:45:04 2011
From: matthieu.stigler at gmail.com (mat)
Date: Sun, 02 Jan 2011 14:45:04 +0100
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <E2339A3600811248AB525B8FAB3A1BCE13DAB280@srv-mail-101.zhaw.ch>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>	<AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>	<6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>,
	<19742.27102.191985.671720@max.nulle.part>
	<E2339A3600811248AB525B8FAB3A1BCE13DAB280@srv-mail-101.zhaw.ch>
Message-ID: <4D208160.1010106@gmail.com>

Hi

I think the idea is definitely good, but I don't know how much 
interest/public a purely Macro Economic R mailing list would have. Maybe 
should be linked to broader "Macro Econometrics" list including 
explicitely VAR/VECM, TS Factor Analysis & so? Or even simply an 
"econometrics" list that we are in my opinion still missing?

Best

Mat

Le 01. 01. 11 13:45, Wildi Marc (wlmr) a ?crit :
> Happy new-year to everybody.
>
> I'd happily contribute to the topic:
>
> http://www.idp.zhaw.ch/usri
> http://www.idp.zhaw.ch/MDFA-XT
> http://blog.zhaw.ch/idp/sefblog
>
> Marc
> ________________________________________
> Von: r-sig-finance-bounces at r-project.org [r-sig-finance-bounces at r-project.org]&quot; im Auftrag von&quot;Dirk Eddelbuettel [edd at debian.org]
> Gesendet: Samstag, 1. Januar 2011 00:40
> Bis: Paul Gilbert
> Cc: r-sig-finance at r-project.org
> Betreff: Re: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
>
> On 31 December 2010 at 20:53, Paul Gilbert wrote:
> | Perhaps there would be too much overlap with R-SIG-Finance, but does anyone think
> | an  R-SIG-MacroEcon list would be useful?
>
> Speaking with listowner hat on, you are most certainly welcome to start such
> discussions here.  If and when it becomes to dominant, we can still review
> splitting up.
>
> Happy New Year to all.
>
> Dirk
>
> --
> Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From brian at braverock.com  Sun Jan  2 15:26:34 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 02 Jan 2011 08:26:34 -0600
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <4D208160.1010106@gmail.com>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>	<AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>	<6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>,
	<19742.27102.191985.671720@max.nulle.part>	<E2339A3600811248AB525B8FAB3A1BCE13DAB280@srv-mail-101.zhaw.ch>
	<4D208160.1010106@gmail.com>
Message-ID: <4D208B1A.8040504@braverock.com>

On 01/02/2011 07:45 AM, mat wrote:
> I think the idea is definitely good, but I don't know how much
> interest/public a purely Macro Economic R mailing list would have. Maybe
> should be linked to broader "Macro Econometrics" list including
> explicitely VAR/VECM, TS Factor Analysis & so? Or even simply an
> "econometrics" list that we are in my opinion still missing?

I second Dirk's suggestion of having those discussions here on 
R-SIG-Finance until there is too much volume and it makes sense to split.

Regards,

   - Brian


From whitneybroach at gmail.com  Mon Jan  3 02:28:39 2011
From: whitneybroach at gmail.com (Whitney Broach)
Date: Sun, 2 Jan 2011 18:28:39 -0700
Subject: [R-SIG-Finance] More general list?
In-Reply-To: <AANLkTin_e-7Z7uqRF+hSPOBbGoPNydyfe3DNM7c2J01X@mail.gmail.com>
References: <!&!AAAAAAAAAAAYAAAAAAAAALle0KqvRYJIkiggmtMX/W6CgQAAEAAAACuvM/t5G3RJodj4V4v3di0BAAAAAA==@gmail.com>
	<AANLkTin_e-7Z7uqRF+hSPOBbGoPNydyfe3DNM7c2J01X@mail.gmail.com>
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAALle0KqvRYJIkiggmtMX/W6CgQAAEAAAAI13r9nTKtlAktA4SzUG2P0BAAAAAA==@gmail.com>

Happy New Year!

Doh!  Don't ask how I didn't know about rseek.org.  This is what I deserve
for crawling in the basement window instead of walking through the front
door.

Best,
Whitney

-----Original Message-----
From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com] 
Sent: Saturday, January 01, 2011 1:47 PM
To: whitneybroach at gmail.com
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] More general list?

Whitney,

Please search before posting.  A search for "general mailing list" on
www.rseek.org yielded
http://www.r-project.org/mail.html
as the first result.

The tools below are better than just using Google to search:
http://www.r-project.org/search.html

You want R-help.  Make sure to read the posting guide.
https://stat.ethz.ch/mailman/listinfo/r-help

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Sat, Jan 1, 2011 at 2:39 PM, Whitney Broach <whitneybroach at gmail.com>
wrote:
> Happy New Year!
> Where is a more general R list? ?I might need to work on the basics there
> before continuing here.
> Best regards,
>
>
> Checked by AVG - www.avg.com
>
> 00:34:00
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
should go.
>


Checked by AVG - www.avg.com 

00:34:00


From milano_amy at yahoo.com  Tue Jan  4 09:59:55 2011
From: milano_amy at yahoo.com (Amy Milano)
Date: Tue, 4 Jan 2011 00:59:55 -0800 (PST)
Subject: [R-SIG-Finance] Loss Given Default (LGD) using Beta estimation and
	Kernel Density
Message-ID: <105481.4077.qm@web114414.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110104/42ffe81a/attachment.pl>

From atul10201 at gmail.com  Tue Jan  4 12:43:40 2011
From: atul10201 at gmail.com (Atul)
Date: Tue, 4 Jan 2011 17:13:40 +0530
Subject: [R-SIG-Finance] R-SIG-Finance Digest, Vol 80, Issue 4
In-Reply-To: <mailman.1.1294138801.23930.r-sig-finance@r-project.org>
References: <mailman.1.1294138801.23930.r-sig-finance@r-project.org>
Message-ID: <AANLkTinsM0SGqgXu7nj+HwsFCC20dSxFojogOeycmbHm@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110104/9980310e/attachment.pl>

From bogaso.christofer at gmail.com  Tue Jan  4 14:20:37 2011
From: bogaso.christofer at gmail.com (Bogaso Christofer)
Date: Tue, 4 Jan 2011 18:50:37 +0530
Subject: [R-SIG-Finance] Applying function on rolling window basis ** not
	rollapply() function in zoo
Message-ID: <015f01cbac12$30753e90$915fbbb0$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110104/bbcd20d4/attachment.pl>

From brian at braverock.com  Tue Jan  4 14:07:14 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 04 Jan 2011 07:07:14 -0600
Subject: [R-SIG-Finance] Applying function on rolling window basis **
 not	rollapply() function in zoo
In-Reply-To: <015f01cbac12$30753e90$915fbbb0$@gmail.com>
References: <015f01cbac12$30753e90$915fbbb0$@gmail.com>
Message-ID: <4D231B82.4080307@braverock.com>

On 01/04/2011 07:20 AM, Bogaso Christofer wrote:
> Hi all, in the zoo package there is a function rollapply() to apply some
> fixed function on rolling window basis. I am looking for some same sort of
> function on **temporal sampling basis** means, I would like to apply a
> function say mean() for data window of length 30 like observations for 1:30,
> 31:60, . so on.


?period.apply  # for time series based apply

?apply.rolling # to apply with a fixed (rolling) width

or maybe the 'by' argument of rollapply.

   - Brian


From bogaso.christofer at gmail.com  Tue Jan  4 14:52:37 2011
From: bogaso.christofer at gmail.com (Bogaso Christofer)
Date: Tue, 4 Jan 2011 19:22:37 +0530
Subject: [R-SIG-Finance] Applying function on rolling window basis **
	not	rollapply() function in zoo
In-Reply-To: <4D231B82.4080307@braverock.com>
References: <015f01cbac12$30753e90$915fbbb0$@gmail.com>
	<4D231B82.4080307@braverock.com>
Message-ID: <018501cbac16$a8395a20$f8ac0e60$@gmail.com>

I was trying the example given in apply.rolling() function, however it is
not that what I wanted. Let me simulate it here:

> head(get(data(managers)), 20)
              HAM1    HAM2    HAM3    HAM4 HAM5 HAM6 EDHEC LS EQ SP500 TR US
10Y TR US 3m TR
1996-01-31  0.0074      NA  0.0349  0.0222   NA   NA          NA   0.0340
0.00380  0.00456
1996-02-29  0.0193      NA  0.0351  0.0195   NA   NA          NA   0.0093
-0.03532  0.00398
1996-03-31  0.0155      NA  0.0258 -0.0098   NA   NA          NA   0.0096
-0.01057  0.00371
1996-04-30 -0.0091      NA  0.0449  0.0236   NA   NA          NA   0.0147
-0.01739  0.00428
1996-05-31  0.0076      NA  0.0353  0.0028   NA   NA          NA   0.0258
-0.00543  0.00443
1996-06-30 -0.0039      NA -0.0303 -0.0019   NA   NA          NA   0.0038
0.01507  0.00412
1996-07-31 -0.0231      NA -0.0337 -0.0446   NA   NA          NA  -0.0442
-0.00100  0.00454
1996-08-31  0.0395 -0.0001  0.0461  0.0351   NA   NA          NA   0.0211
-0.00448  0.00451
1996-09-30  0.0147  0.1002  0.0653  0.0757   NA   NA          NA   0.0563
0.02229  0.00470
1996-10-31  0.0288  0.0338  0.0395 -0.0180   NA   NA          NA   0.0276
0.02869  0.00428
1996-11-30  0.0156  0.0737  0.0666  0.0458   NA   NA          NA   0.0756
0.02797  0.00427
1996-12-31  0.0176  0.0298  0.0214  0.0439   NA   NA          NA  -0.0198
-0.02094  0.00442
1997-01-31  0.0212  0.0794  0.0771  0.0437   NA   NA      0.0281   0.0625
-0.00055  0.00457
1997-02-28  0.0022 -0.0082 -0.0374  0.0312   NA   NA     -0.0006   0.0078
-0.00167  0.00390
1997-03-31  0.0094 -0.0269 -0.0336  0.0113   NA   NA     -0.0084  -0.0411
-0.01958  0.00422
1997-04-30  0.0126 -0.0061  0.0286  0.0354   NA   NA      0.0084   0.0597
0.01954  0.00477
1997-05-31  0.0438  0.0539  0.0759  0.0789   NA   NA      0.0394   0.0609
0.01033  0.00513
1997-06-30  0.0231  0.0552  0.0054  0.0412   NA   NA      0.0223   0.0448
0.01665  0.00365
1997-07-31  0.0154  0.1150  0.1081  0.0794   NA   NA      0.0454   0.0796
0.04161  0.00450
1997-08-31  0.0237 -0.0197 -0.0028  0.0143   NA   NA      0.0107  -0.0560
-0.02148  0.00428

> head(apply.rolling(managers[,1,drop=FALSE], FUN="mean", width=3), 10)
                  calcs
1996-01-31           NA
1996-02-29           NA
1996-03-31  0.014066667
1996-04-30  0.008566667
1996-05-31  0.004666667
1996-06-30 -0.001800000
1996-07-31 -0.006466667
1996-08-31  0.004166667
1996-09-30  0.010366667
1996-10-31  0.027666667

What I wanted to have is (0.0074+0.0193+0.0155)/3,
(-0.0091+0.0076+-0.0039)/3 (with window size 3) etc... Do I need to put any
further argument in that function?

Thanks,

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Brian G. Peterson
Sent: 04 January 2011 18:37
To: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Applying function on rolling window basis **
not rollapply() function in zoo

On 01/04/2011 07:20 AM, Bogaso Christofer wrote:
> Hi all, in the zoo package there is a function rollapply() to apply 
> some fixed function on rolling window basis. I am looking for some 
> same sort of function on **temporal sampling basis** means, I would 
> like to apply a function say mean() for data window of length 30 like 
> observations for 1:30, 31:60, . so on.


?period.apply  # for time series based apply

?apply.rolling # to apply with a fixed (rolling) width

or maybe the 'by' argument of rollapply.

   - Brian

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From brian at braverock.com  Tue Jan  4 14:41:14 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 04 Jan 2011 07:41:14 -0600
Subject: [R-SIG-Finance] Applying function on rolling window basis **
 not	rollapply() function in zoo
In-Reply-To: <018501cbac16$a8395a20$f8ac0e60$@gmail.com>
References: <015f01cbac12$30753e90$915fbbb0$@gmail.com>
	<4D231B82.4080307@braverock.com>
	<018501cbac16$a8395a20$f8ac0e60$@gmail.com>
Message-ID: <4D23237A.1050500@braverock.com>

On 01/04/2011 07:52 AM, Bogaso Christofer wrote:
> I was trying the example given in apply.rolling() function, however it is
> not that what I wanted. Let me simulate it here:
<...>
> What I wanted to have is (0.0074+0.0193+0.0155)/3,
> (-0.0091+0.0076+-0.0039)/3 (with window size 3) etc... Do I need to put any
> further argument in that function?

apply.rolling will use a fixed width and *roll* which is what you 
subject says you want.

?period apply

will apply on a endpoints(time)-based period, like days, months, and 
years, using 'periodicity' in xts.  so, quarterly mean, for example, 
would be period.apply with endpoints on quarters or use apply.quarterly. 
  With period.apply, you can also send in a vector of endpoints, which 
can be arbitrary.

So, I think I already gave you all the information you need to do what 
you want.

  - Brian


From ggrothendieck at gmail.com  Tue Jan  4 15:20:42 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 4 Jan 2011 09:20:42 -0500
Subject: [R-SIG-Finance] Applying function on rolling window basis **
 not rollapply() function in zoo
In-Reply-To: <015f01cbac12$30753e90$915fbbb0$@gmail.com>
References: <015f01cbac12$30753e90$915fbbb0$@gmail.com>
Message-ID: <AANLkTimaOSuSW1u2CDtK9JhiVe2+nJbGdetB5FJRSgDo@mail.gmail.com>

On Tue, Jan 4, 2011 at 8:20 AM, Bogaso Christofer
<bogaso.christofer at gmail.com> wrote:
> Hi all, in the zoo package there is a function rollapply() to apply some
> fixed function on rolling window basis. I am looking for some same sort of
> function on **temporal sampling basis** means, I would like to apply a
> function say mean() for data window of length 30 like observations for 1:30,
> 31:60, . so on.
>
>
>
> Is there any facility to doing that directly?
>

The by= argument of rollapply does that:

> library(zoo)
> z <- zoo(1:9)
> rollapply(z, 3, by = 3, mean)
2 5 8
2 5 8

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From markknecht at gmail.com  Tue Jan  4 19:28:50 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Tue, 4 Jan 2011 10:28:50 -0800
Subject: [R-SIG-Finance] Trading system correlation?
Message-ID: <AANLkTikLQDSs-7pKneYrdNgau-YOu+23HnMLrO=XHFdp@mail.gmail.com>

Hi,
   Sorry that I don't have any R code just yet but basically I'm
searching around a bit for some initial ideas. Please keep in mind
that I'm not a statistician or mathematician so it will be easy to go
over my head. Thanks in advance.

   Assume that I have 1 trading system and that I trade this system on
multiple markets, or the same market using different time frames. As a
futures oriented example:

@ES.D - 1 minute bars
@ES.D - 3 minute bars
@TF.D - 8 minute bars
@NQ.D - 5 minute bars

   My work flow optimizes the system for each market, then executes
Walk Forward processing to determine a reasonable set of weekly setups
for each system/market pair. I trade the systems for a week or two,
depending on the WFP results, and then update. In the end I generate a
set of trades for each pair over many years and save the trades to
files.

   I know the markets are correlated to a high degree most of the time
so I might logically expect the results to be correlated also. How can
I measure this?

Thoughts:

1) Create minute-by-minute equity curves and do correlation on those.
Downside is really too much data and therefore somewhat slow. Also it
doesn't really focus on entries and exits as much as both systems just
being in or out.

2) Somehow evaluate entry and exit times setting some sort of time
window. If the two enter & exit within a few minutes of each other
then call them correlated. (Is there some name for this sort of test?)

   My goal here is to find interesting sets of market/system pairs
that actually have lower correlation under the assumption that if both
make money but have low correlation then it would result in less
drawdown in the sum of equity curves. (I.e. - one system losing when
another is winning...) I'd like to test that assumption.

   Note that there are special time cases for entry and exit, such as
all systems exiting at the end-of-day market that I'd likely want/need
to filter.

   Thanks in advance for any ideas.

Cheers,
Mark


From myotistwo at gmail.com  Tue Jan  4 19:54:45 2011
From: myotistwo at gmail.com (Graham Smith)
Date: Tue, 4 Jan 2011 18:54:45 +0000
Subject: [R-SIG-Finance] Cost-benefit/value for money analysis
Message-ID: <AANLkTim++fS_ODQk7oL+xTTw2nELRAdtYydfW=_N6SqN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110104/4d61966c/attachment.pl>

From josh.m.ulrich at gmail.com  Tue Jan  4 20:45:34 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 4 Jan 2011 13:45:34 -0600
Subject: [R-SIG-Finance] Cost-benefit/value for money analysis
In-Reply-To: <AANLkTim++fS_ODQk7oL+xTTw2nELRAdtYydfW=_N6SqN@mail.gmail.com>
References: <AANLkTim++fS_ODQk7oL+xTTw2nELRAdtYydfW=_N6SqN@mail.gmail.com>
Message-ID: <AANLkTinvXtd81wLnRqXkomoeo8dUZk_SngonGOmSC4GM@mail.gmail.com>

This really doesn't have anything to do with finance, but I was bored
waiting for something to run.  Please direct any questions to me
off-list or to R-help, since this is not on-topic for this list.

On Tue, Jan 4, 2011 at 12:54 PM, Graham Smith <myotistwo at gmail.com> wrote:
> Posted on R-help, but it has been suggested that I also post here.
>
> I assume this has a "proper" name, but I don't know what it is and wondered
> if anyone knew of a package that might do the following, or something
> similar.
>
> As an example, assume I have borrowed and read 10 books on R , and ?I have
> subjectively given each of them a "value" score in terms of how useful I
> think they are. I also know how much each costs in terms of money.
>
set.seed(21)
p <- trunc(runif(10)*100) # prices
v <- trunc(runif(10)*10)  # values

> What I would like to do is to calculate the costs of every possible
> combination of the 10 books, and plot the total monetary value for each of
> these possible combination ?with their associated subjective value totals,
> to help decide which combination of books represents the best value for
> money.
>
bk <- letters[1:10]    # books
nb <- 3                # number of books to choose
pc <- combn(p,nb,sum)  # price combinations of 3 books
vc <- combn(v,nb,sum)  # value combinations of 3 books
bc <- combn(bk,nb)     # books in each combination

plot(vc/pc)            # value for money
bc[,which.max(vc/pc)]  # best combination of value for money

> I know that some specialist decision analysis software does this sort of
> thing, but was hoping R might have an appropriate package.
>
Everything above was done with the base R packages.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


> Many thanks,
>
> Graham
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From devaneymark at gmail.com  Tue Jan  4 23:28:43 2011
From: devaneymark at gmail.com (Mark Devaney)
Date: Tue, 4 Jan 2011 17:28:43 -0500
Subject: [R-SIG-Finance] job posting in New Jersey
Message-ID: <AANLkTi=DY3+r2PRf81TTm1V-NY196BL-VmMhrV8R-Lgd@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110104/02d70572/attachment.pl>

From dstjohn at math.uic.edu  Wed Jan  5 18:21:54 2011
From: dstjohn at math.uic.edu (David St John)
Date: Wed, 5 Jan 2011 11:21:54 -0600
Subject: [R-SIG-Finance] Trading system correlation?
Message-ID: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110105/bc62e3fc/attachment.pl>

From markknecht at gmail.com  Wed Jan  5 18:57:59 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Wed, 5 Jan 2011 09:57:59 -0800
Subject: [R-SIG-Finance] Trading system correlation?
In-Reply-To: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>
References: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>
Message-ID: <AANLkTin-QzKvO0UY_VVA-2T+w3WsYvpagW8x6hyBRHz+@mail.gmail.com>

On Wed, Jan 5, 2011 at 9:21 AM, David St John <dstjohn at math.uic.edu> wrote:
> Mark,
>
> I would suggest thinking about correlation between the returns. ?For
> example, using daily data for SPY, DJI, QQQQ, I see the correlation in the
> returns using the following calls:
>
>> library(quantmod)
>
>> getSymbols(c('SPY','^DJI','QQQQ'))
>
> [1] "SPY" "DJI" "QQQQ"
>
>> x1 <- log(as.vector(as.matrix(SPY)[,4])/(as.vector(as.matrix(SPY)[,1])))
>
>> x2 <- log(as.vector(as.matrix(QQQQ)[,4])/(as.vector(as.matrix(QQQQ)[,1])))
>
>
>> x3 <- log(as.vector(as.matrix(DJI)[,4])/(as.vector(as.matrix(DJI)[,1])))
>
>> data <- cbind(x1,x2,x3)
>
>> cor(data)
>
> x1 x2 x3
>
> x1 1.0000000 0.9067068 0.8284568
>
> x2 0.9067068 1.0000000 0.7556838
>
> x3 0.8284568 0.7556838 1.0000000
>
> In this example I just used log(close/open) as the one-period return.
>
> So, if you want to see if your systems are correlated, I would suggest
> defining the systems' return series by multiplying the one period returns
> with the position indicated by the system.
>
> I generated a random 'system' as a sequence of -1, 0, and 1 values as an
> example:
>
>> z1 <- rnorm(length(x1))
>
>> z2 <- rnorm(length(x2))
>
>> z3 <- rnorm(length(x3))
>
>> s1 <- ifelse(z1>1,1,0)-ifelse(z1<-1,1,0)
>
>> s2 <- ifelse(z2>1,1,0)-ifelse(z2<-1,1,0)
>
>> s3 <- ifelse(z3>1,1,0)-ifelse(z3<-1,1,0)
>
>> signal <- cbind(s1,s2,s3)
>
> ?> cor(data*signal)
>
> x1 x2 x3
>
> x1 1.0000000 0.7682398 0.6788077
>
> x2 0.7682398 1.0000000 0.6088950
>
> x3 0.6788077 0.6088950 1.0000000
>
> As you can see, even if you were just randomly buying and selling these
> contracts at odd times, but most of the time had no position (68% of the
> time in my example), then the systems will still be very strongly
> correlated. Since you are trying to find comparatively lower correlation
> between market/system pairs, I think this would be as fine a measure as
> any. ?Just look for the smallest entries in your correlation matrix.
>
>
> Hope this helps,
> -David

David,
   Thanks. It helps a lot. I like it because it's simple, the amount
of data being correlated isn't huge (daily returns for a few years, in
sample, out of sample, etc.) and could easily scale to hourly or some
other time scale fairly easily. I'll likely set up my data to take a
cut at this method in the next day or two and post back some results.
Thanks.

   The one thing I don't have yet is how to pick the 'best' 5 out of
50, where 'best' implies something I'm interested in. (Profit, low
drawdowns, etc.) I can write a fitness function for what interests me.
The next step is finding a good solution for maximizing what I
consider 'best'. I currently have maybe a hundred trading systems to
poke around with in this manner. I'd like to find 5 that work well
together, doing different things to earn their keep, one making money
when another isn't.

   There is a thread on the main R-users list right now called
"Cost-benefit/value for money analysis" that might be appropriate if I
let the value be how these respond to a custom fitness function and
limit the number chosen to 5.

Cheers,
Mark


From dstjohn at math.uic.edu  Wed Jan  5 20:16:44 2011
From: dstjohn at math.uic.edu (David St John)
Date: Wed, 5 Jan 2011 13:16:44 -0600
Subject: [R-SIG-Finance] Trading system correlation?
Message-ID: <AANLkTimBZxGr7gzTB_TOaRwkAgw2KrbkqniP4PiBvfq8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110105/569a3ac7/attachment.pl>

From brightonbrentford at gmail.com  Thu Jan  6 01:07:38 2011
From: brightonbrentford at gmail.com (Brighton Brentford)
Date: Thu, 6 Jan 2011 00:07:38 +0000
Subject: [R-SIG-Finance] Alternative Investments: Professional Gambling on
	Major League Sports
Message-ID: <AANLkTikAKYuhhU+DizXa4KFM7KRgNJ=J9cRh7ScznNXt@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110106/fb257f0f/attachment.pl>

From Giuseppe.Milicia at makoglobal.com  Thu Jan  6 11:34:51 2011
From: Giuseppe.Milicia at makoglobal.com (Giuseppe Milicia)
Date: Thu, 6 Jan 2011 10:34:51 +0000
Subject: [R-SIG-Finance] Zoo: na.locf,
 na.approx behaviour changes between versions 1.6.3 and 1.6.4
Message-ID: <9C9CE11E37400A41849B75A646601367885EF8972D@uk-mail-a.mako.uk.makoglobal.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110106/f6eb94bc/attachment.pl>

From megh700004 at gmail.com  Thu Jan  6 12:26:26 2011
From: megh700004 at gmail.com (Megh Dal)
Date: Thu, 6 Jan 2011 16:56:26 +0530
Subject: [R-SIG-Finance] A question on portfolio value calculation
Message-ID: <AANLkTikkt4o3Z9KfwNo8PGSjRTQwo289Wo5fHc7UKa+r@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110106/170308f9/attachment.pl>

From guygreen at netvigator.com  Thu Jan  6 13:28:10 2011
From: guygreen at netvigator.com (Guy Green)
Date: Thu, 6 Jan 2011 04:28:10 -0800 (PST)
Subject: [R-SIG-Finance] A question on portfolio value calculation
In-Reply-To: <AANLkTikkt4o3Z9KfwNo8PGSjRTQwo289Wo5fHc7UKa+r@mail.gmail.com>
References: <AANLkTikkt4o3Z9KfwNo8PGSjRTQwo289Wo5fHc7UKa+r@mail.gmail.com>
Message-ID: <1294316890155-3177324.post@n4.nabble.com>


In any realistic portfolio you will have some starting equity, and you would
also have the costs/proceeds of your long & short positions.  The portfolio
value would then be:

Starting equity + $(m1-m2-m3) -cost(pos1) +proceeds(pos2) +proceeds(pos2)

or to put it another way:

Starting equity +/- unrealised gains/losses on your positions.

Your position sizes will be linked to your starting equity, both in the
sense that your starting equity is a real-world constraint on the sizes of
the positions that your broker will allow you to enter into, and also in the
more theoretical (but still real-world) sense that the relative sizes of
your starting equity and your positions contribute to the likelihood of your
strategy exhausting all your equity at some point in the future, even if it
is a winning one over the long term.

Guy


Megh Dal wrote:
> 
> Hi all, can somebody suggest me on what is the correct way to calculate
> value of a portfolio (i.e. mark-to-market value) with having both long and
> short position? For example, suppose I have 3 positions in my portfolio
> pos1, po2, and pos3 and type of transaction is long, short, short
> respectively.
> 
> Say, m2m value of those 3 positions are m1, m2 and m3 in money term. Then
> should m2m value of this portfolio be $(m1-m2-m3)?
> 
> If this is correct I feel there are some practical problem with this
> approach. Let say I calculated the volatility of this portfolio assuming
> some normal distribution of return, let say it is $X. Then if I want to
> answer, what is the volatility for per unit value of my entire portfolio
> the
> answer would be : $X/$(m1-m2-m3). However if it happenes that $(m1-m2-m3)
> =
> 0 then above calculation becomes undefined.
> 
> This approach also may be problametic if I have all short, in this case
> unit
> SD for my portfolio becomes obviously negative.
> 
> Or should I go with $(abs(m1)+abs(m2)+abs(m3)) to avoid above scenario?
> 
> Any explanation would be highly appreciated.
> 
> Thanks
> 

-- 
View this message in context: http://r.789695.n4.nabble.com/A-question-on-portfolio-value-calculation-tp3177254p3177324.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From david.ardia at unifr.ch  Thu Jan  6 13:50:46 2011
From: david.ardia at unifr.ch (ArdiaD)
Date: Thu, 06 Jan 2011 13:50:46 +0100
Subject: [R-SIG-Finance] A question on portfolio value calculation
In-Reply-To: <1294316890155-3177324.post@n4.nabble.com>
References: <AANLkTikkt4o3Z9KfwNo8PGSjRTQwo289Wo5fHc7UKa+r@mail.gmail.com>
	<1294316890155-3177324.post@n4.nabble.com>
Message-ID: <4D25BAA6.805@unifr.ch>

Have a look at this note:
http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1675067
This may help
Dave

On 01/06/2011 01:28 PM, Guy Green wrote:
> In any realistic portfolio you will have some starting equity, and you would
> also have the costs/proceeds of your long & short positions.  The portfolio
> value would then be:
>
> Starting equity + $(m1-m2-m3) -cost(pos1) +proceeds(pos2) +proceeds(pos2)
>
> or to put it another way:
>
> Starting equity +/- unrealised gains/losses on your positions.
>
> Your position sizes will be linked to your starting equity, both in the
> sense that your starting equity is a real-world constraint on the sizes of
> the positions that your broker will allow you to enter into, and also in the
> more theoretical (but still real-world) sense that the relative sizes of
> your starting equity and your positions contribute to the likelihood of your
> strategy exhausting all your equity at some point in the future, even if it
> is a winning one over the long term.
>
> Guy
>
>
> Megh Dal wrote:
>> Hi all, can somebody suggest me on what is the correct way to calculate
>> value of a portfolio (i.e. mark-to-market value) with having both long and
>> short position? For example, suppose I have 3 positions in my portfolio
>> pos1, po2, and pos3 and type of transaction is long, short, short
>> respectively.
>>
>> Say, m2m value of those 3 positions are m1, m2 and m3 in money term. Then
>> should m2m value of this portfolio be $(m1-m2-m3)?
>>
>> If this is correct I feel there are some practical problem with this
>> approach. Let say I calculated the volatility of this portfolio assuming
>> some normal distribution of return, let say it is $X. Then if I want to
>> answer, what is the volatility for per unit value of my entire portfolio
>> the
>> answer would be : $X/$(m1-m2-m3). However if it happenes that $(m1-m2-m3)
>> =
>> 0 then above calculation becomes undefined.
>>
>> This approach also may be problametic if I have all short, in this case
>> unit
>> SD for my portfolio becomes obviously negative.
>>
>> Or should I go with $(abs(m1)+abs(m2)+abs(m3)) to avoid above scenario?
>>
>> Any explanation would be highly appreciated.
>>
>> Thanks
>>


From brian at braverock.com  Thu Jan  6 14:01:50 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 06 Jan 2011 07:01:50 -0600
Subject: [R-SIG-Finance] A question on portfolio value calculation
In-Reply-To: <AANLkTikkt4o3Z9KfwNo8PGSjRTQwo289Wo5fHc7UKa+r@mail.gmail.com>
References: <AANLkTikkt4o3Z9KfwNo8PGSjRTQwo289Wo5fHc7UKa+r@mail.gmail.com>
Message-ID: <4D25BD3E.5020501@braverock.com>

On 01/06/2011 05:26 AM, Megh Dal wrote:
> Hi all, can somebody suggest me on what is the correct way to calculate
> value of a portfolio (i.e. mark-to-market value) with having both long and
> short position? For example, suppose I have 3 positions in my portfolio
> pos1, po2, and pos3 and type of transaction is long, short, short
> respectively.
>
> Say, m2m value of those 3 positions are m1, m2 and m3 in money term. Then
> should m2m value of this portfolio be $(m1-m2-m3)?
>
> If this is correct I feel there are some practical problem with this
> approach. Let say I calculated the volatility of this portfolio assuming
> some normal distribution of return, let say it is $X. Then if I want to
> answer, what is the volatility for per unit value of my entire portfolio the
> answer would be : $X/$(m1-m2-m3). However if it happenes that $(m1-m2-m3) =
> 0 then above calculation becomes undefined.
>
> This approach also may be problametic if I have all short, in this case unit
> SD for my portfolio becomes obviously negative.
>
> Or should I go with $(abs(m1)+abs(m2)+abs(m3)) to avoid above scenario?
>
> Any explanation would be highly appreciated.

See the CFTC's guidelines and calculations for the '13 column report'. 
This is a widely used and copied format for portfolio reporting.

Typically, both net and gross exposures are calculated.

Regards,

   - Brian



-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From ggrothendieck at gmail.com  Thu Jan  6 14:05:27 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 6 Jan 2011 08:05:27 -0500
Subject: [R-SIG-Finance] Zoo: na.locf,
 na.approx behaviour changes between versions 1.6.3 and 1.6.4
In-Reply-To: <9C9CE11E37400A41849B75A646601367885EF8972D@uk-mail-a.mako.uk.makoglobal.com>
References: <9C9CE11E37400A41849B75A646601367885EF8972D@uk-mail-a.mako.uk.makoglobal.com>
Message-ID: <AANLkTinHZ4JacQEcXX2sk8VupsePOuXCZ2VNG6iXnLNu@mail.gmail.com>

On Thu, Jan 6, 2011 at 5:34 AM, Giuseppe Milicia
<Giuseppe.Milicia at makoglobal.com> wrote:
> Guys,
>
> I'd like to point out a behavior change in na.locf (and na.approx) from the zoo package between versions 1.6.3 and 1.6.4
>
> If na.rm=T (it is by default) in 1.6.3 na.omit would be used to remove the leading NAa, in 1.6.4 na.trim is used instead. In zoo 1.6.4
>
> tmp = zoo(as.matrix(1, ncol=1, nrow=100), 1:100)
> colnames(tmp)="TEST"
> class(coredata(tmp))
> [1] "matrix"
> colnames(tmp)
> [1] "TEST"
> colnames(na.locf(tmp))
> NULL
> class(coredata(na.locf(tmp)))
> [1] "numeric"
> class(tmp) = c("Test",class(tmp))
> class(na.locf(tmp))
> [1] "zoo"
>
> Whilst with zoo 1.6.3 the univariate zoo series keep the matrix coredata and the colnames :(, it also kept the class of the original.
>
> Unfortunately this breaks my code :(
>
> Any particular motivation between this change? I'm downgrading to 1.6.3 for the time being :(
>
> Cheers,
>

There seems to be referring to two different things here:

1. It drops a dimension if the input is a zoo matrix with one column
and na.rm = TRUE. That is a bug in na.trim.  Its fixed in the
development version of zoo:

>   library(zoo)
>   source("http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/zoo/R/na.trim.R?revision=816&root=zoo")
>   z <- zoo(cbind(x = c(NA, 1, NA, 3)))
>   na.locf(z)
  x
2 1
3 1
4 3

Alternately here is a workaround that would work if maxgap= is not used:

> z <- zoo(cbind(x = c(NA, 1, NA, 3)))
> na.omit(na.locf(z, na.rm = FALSE))
  x
2 1
3 1
4 3
attr(,"na.action")
[1] 1
attr(,"class")
[1] "omit"

2. na.trim is used instead of na.omit.  How is this a problem since
na.locf fills in NAs so there will be no NAs in the result anyways
unless possibly if you use the new maxgap argument (and in that case
you don't want certain internal NAs removed)?

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From Giuseppe.Milicia at makoglobal.com  Thu Jan  6 14:40:24 2011
From: Giuseppe.Milicia at makoglobal.com (Giuseppe Milicia)
Date: Thu, 6 Jan 2011 13:40:24 +0000
Subject: [R-SIG-Finance] Zoo: na.locf,
 na.approx behaviour changes between versions 1.6.3 and 1.6.4
In-Reply-To: <AANLkTinHZ4JacQEcXX2sk8VupsePOuXCZ2VNG6iXnLNu@mail.gmail.com>
References: <9C9CE11E37400A41849B75A646601367885EF8972D@uk-mail-a.mako.uk.makoglobal.com>
	<AANLkTinHZ4JacQEcXX2sk8VupsePOuXCZ2VNG6iXnLNu@mail.gmail.com>
Message-ID: <9C9CE11E37400A41849B75A646601367885EF8972E@uk-mail-a.mako.uk.makoglobal.com>

> There seems to be referring to two different things here:
>
> 1. It drops a dimension if the input is a zoo matrix with one column
> and na.rm = TRUE. That is a bug in na.trim.  Its fixed in the
> development version of zoo:

Cheers, I'll wait for the next release then :)

>2. na.trim is used instead of na.omit.  How is this a problem since
>na.locf fills in NAs so there will be no NAs in the result anyways
>unless possibly if you use the new maxgap argument (and in that case
>you don't want certain internal NAs removed)?

No problem at all but as said in point 1, na.trim has a bug and na.omit doesn't. I didn't know whether the na.trim behaviour was a bug or a feature...

Thanks!

//Giuseppe

---- MAKO ----
This email and any files transmitted with it are confide...{{dropped:14}}


From markknecht at gmail.com  Thu Jan  6 18:18:54 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Thu, 6 Jan 2011 09:18:54 -0800
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
Message-ID: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>

Hi,
   I think I'm going to have a couple of questions but I figured I'd
start with (I hope) a very simple one. I've not worked with time
series objects before so I'm trying to learn them. I've been looking
at things like ?xts, ?zoo as well as Phil Proctor's book but so far no
luck.

   Starting from this little code stub I'd like to create a Monday
through Friday time series into which I can eventually place trading
system results.

   Here's the stub:

TStoDate = function (TSDate) {
	X = strptime(TSDate + 19e6L, "%Y%m%d")
	return(as.Date(X))
}

# TradeStation date format
FirstDate = 1100401
LastDate = 1100601

#Dates
StartDate = TStoDate(FirstDate)
EndDate = TStoDate(LastDate)

StartDate
EndDate

   How can I do this, and (if possible and easy) is there a way to
exclude U.S. holidays?

   I did discover

R1 <- as.zoo(StartDate:EndDate )

does create an object, but the values are numbers which I don't
understand but suspect are some internal R code for a date, and it
appears to have enough entries to include weekends.

   Anyway, hopefully this is clear enough to describe what I'm trying
to do and where I'm stuck.

Thanks,
Mark


From Murali.Menon at avivainvestors.com  Thu Jan  6 18:29:15 2011
From: Murali.Menon at avivainvestors.com (Murali.Menon at avivainvestors.com)
Date: Thu, 6 Jan 2011 17:29:15 +0000
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
Message-ID: <05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>

Hi,

For US holidays, the timeDate package in Rmetrics has a function holidayNYSE() to which you pass a numeric range for years, e.g. holidayNYSE(1980:1990).

Cheers,
Murali

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Mark Knecht
Sent: 06 January 2011 17:19
To: R-Finance
Subject: [R-SIG-Finance] Create a Monday-Friday time series?

Hi,
   I think I'm going to have a couple of questions but I figured I'd
start with (I hope) a very simple one. I've not worked with time
series objects before so I'm trying to learn them. I've been looking
at things like ?xts, ?zoo as well as Phil Proctor's book but so far no
luck.

   Starting from this little code stub I'd like to create a Monday
through Friday time series into which I can eventually place trading
system results.

   Here's the stub:

TStoDate = function (TSDate) {
	X = strptime(TSDate + 19e6L, "%Y%m%d")
	return(as.Date(X))
}

# TradeStation date format
FirstDate = 1100401
LastDate = 1100601

#Dates
StartDate = TStoDate(FirstDate)
EndDate = TStoDate(LastDate)

StartDate
EndDate

   How can I do this, and (if possible and easy) is there a way to
exclude U.S. holidays?

   I did discover

R1 <- as.zoo(StartDate:EndDate )

does create an object, but the values are numbers which I don't
understand but suspect are some internal R code for a date, and it
appears to have enough entries to include weekends.

   Anyway, hopefully this is clear enough to describe what I'm trying
to do and where I'm stuck.

Thanks,
Mark

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From markknecht at gmail.com  Thu Jan  6 18:51:42 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Thu, 6 Jan 2011 09:51:42 -0800
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
Message-ID: <AANLkTikc+-NPy-dvcBSxgN1tNdg3bTb2fh64NMWb7fyS@mail.gmail.com>

On Thu, Jan 6, 2011 at 9:29 AM,  <Murali.Menon at avivainvestors.com> wrote:
> Hi,
>
> For US holidays, the timeDate package in Rmetrics has a function holidayNYSE() to which you pass a numeric range for years, e.g. holidayNYSE(1980:1990).
>
> Cheers,
> Murali
>

Thanks Murali. I'd not check out Rmetrics before so the install
procedure threw me a little bit, but I got it installed and it looks
helpful on the holiday part of my problem.

Cheers,
Mark


From ggrothendieck at gmail.com  Thu Jan  6 18:55:40 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 6 Jan 2011 12:55:40 -0500
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
Message-ID: <AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>

> Cheers,
> Murali
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Mark Knecht
> Sent: 06 January 2011 17:19
> To: R-Finance
> Subject: [R-SIG-Finance] Create a Monday-Friday time series?
>
> Hi,
> ? I think I'm going to have a couple of questions but I figured I'd
> start with (I hope) a very simple one. I've not worked with time
> series objects before so I'm trying to learn them. I've been looking
> at things like ?xts, ?zoo as well as Phil Proctor's book but so far no
> luck.
>
> ? Starting from this little code stub I'd like to create a Monday
> through Friday time series into which I can eventually place trading
> system results.
>
> ? Here's the stub:
>
> TStoDate = function (TSDate) {
> ? ? ? ?X = strptime(TSDate + 19e6L, "%Y%m%d")
> ? ? ? ?return(as.Date(X))
> }
>
> # TradeStation date format
> FirstDate = 1100401
> LastDate = 1100601
>
> #Dates
> StartDate = TStoDate(FirstDate)
> EndDate = TStoDate(LastDate)
>
> StartDate
> EndDate
>
> ? How can I do this, and (if possible and easy) is there a way to
> exclude U.S. holidays?
>
> ? I did discover
>
> R1 <- as.zoo(StartDate:EndDate )
>
> does create an object, but the values are numbers which I don't
> understand but suspect are some internal R code for a date, and it
> appears to have enough entries to include weekends.
>
> ? Anyway, hopefully this is clear enough to describe what I'm trying
> to do and where I'm stuck.
>
On Thu, Jan 6, 2011 at 12:29 PM,  <Murali.Menon at avivainvestors.com> wrote:
> Hi,
>
> For US holidays, the timeDate package in Rmetrics has a function holidayNYSE() to which you pass a numeric range for years, e.g. holidayNYSE(1980:1990).
>

To add to this try:

library(timeDate) # holidayNYSE
library(chron) # .Holidays / is.holiday / is.weekend

# this will be used by is.holiday
.Holidays <- chron(as.Date(holidayNYSE(year = 2010)))

StartDate <- as.Date("2010-01-01")
EndDate <- as.Date("2010-04-01")

dd <- seq(StartDate, EndDate, by = "day")

dd[!is.weekend(dd) & !is.holiday(dd)]


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From markknecht at gmail.com  Thu Jan  6 20:51:43 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Thu, 6 Jan 2011 11:51:43 -0800
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
	<AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>
Message-ID: <AANLkTikOUnRgDvPLFzsJaNw1nyEwrKz-e4ej6eNE30oC@mail.gmail.com>

Thanks Gabor. That seems to work nicely.

What is chron trying to tell me about the origin? Is that specific to
my machine or did you see it also?

I am using 2.12.1.

Also, what's the command to package up some real data from a
data.frame so that it survives being emailed? When I respond back
later I want to include a few real trades so you can recreate whatever
I'm seeing.

Cheers,
Mark

On Thu, Jan 6, 2011 at 9:55 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
<SNIP>
> To add to this try:
>
> library(timeDate) # holidayNYSE
> library(chron) # .Holidays / is.holiday / is.weekend
>
> # this will be used by is.holiday
> .Holidays <- chron(as.Date(holidayNYSE(year = 2010)))
>
> StartDate <- as.Date("2010-01-01")
> EndDate <- as.Date("2010-04-01")
>
> dd <- seq(StartDate, EndDate, by = "day")
>
> dd[!is.weekend(dd) & !is.holiday(dd)]
>

<SNIP>

> library(timeDate) # holidayNYSE
> library(chron) # .Holidays / is.holiday / is.weekend
>
> # this will be used by is.holiday
> .Holidays <- chron(as.Date(holidayNYSE(year = 2010)))
Error in convert.dates(dates., format = fmt, origin. = origin.) :
  object dates. must be numeric or character
>
> StartDate <- as.Date("2010-01-01")
> EndDate <- as.Date("2010-04-01")
>
> dd <- seq(StartDate, EndDate, by = "day")
>
> dd[!is.weekend(dd) & !is.holiday(dd)]
 [1] "2010-01-01" "2010-01-04" "2010-01-05" "2010-01-06" "2010-01-07"
 [6] "2010-01-08" "2010-01-11" "2010-01-12" "2010-01-13" "2010-01-14"
[11] "2010-01-15" "2010-01-18" "2010-01-19" "2010-01-20" "2010-01-21"
[16] "2010-01-22" "2010-01-25" "2010-01-26" "2010-01-27" "2010-01-28"
[21] "2010-01-29" "2010-02-01" "2010-02-02" "2010-02-03" "2010-02-04"
[26] "2010-02-05" "2010-02-08" "2010-02-09" "2010-02-10" "2010-02-11"
[31] "2010-02-12" "2010-02-15" "2010-02-16" "2010-02-17" "2010-02-18"
[36] "2010-02-19" "2010-02-22" "2010-02-23" "2010-02-24" "2010-02-25"
[41] "2010-02-26" "2010-03-01" "2010-03-02" "2010-03-03" "2010-03-04"
[46] "2010-03-05" "2010-03-08" "2010-03-09" "2010-03-10" "2010-03-11"
[51] "2010-03-12" "2010-03-15" "2010-03-16" "2010-03-17" "2010-03-18"
[56] "2010-03-19" "2010-03-22" "2010-03-23" "2010-03-24" "2010-03-25"
[61] "2010-03-26" "2010-03-29" "2010-03-30" "2010-03-31" "2010-04-01"
>


From stephen at organicfoodmarkets.com.au  Thu Jan  6 20:52:16 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Fri, 07 Jan 2011 06:52:16 +1100
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <4D1A45FE.6070007@braverock.com>
References: <4D124B20.80401@organicfoodmarkets.com.au>	<4D124C41.60106@braverock.com>	<4D1272A6.6060502@organicfoodmarkets.com.au>	<f5255610624f16b9615507cbb55aecfb@braverock.com>	<4D198E41.3080802@organicfoodmarkets.com.au>	<ad29406d0c73eaeb9a6513afb1820c6a@braverock.com>	<4D1A3A76.9010406@organicfoodmarkets.com.au>
	<4D1A45FE.6070007@braverock.com>
Message-ID: <4D261D70.5000007@organicfoodmarkets.com.au>

Hi

One thing that I want to understand is the effect of stop-loss activity 
on results and employing more complex rules.  The two examples I am 
looking at have fairly simple rules like:

# three days higher close, high and open than on previous day

#one day before
lag1<-lag((SPY),1)

#two days defore
lag2<-lag((SPY),2)

signal<-ifelse( (Cl(lag2)>Cl(lag1) & Cl(lag1)>Cl(SPY))&
             (Hi(lag2)>Hi(lag1) & Hi(lag1)>Hi(SPY)) &
             (Op(lag2)>Op(lag1) & Op(lag1)>Op(SPY)),
             1,0
)

and

# if today's low is higher than yesterday's close 1, else 0

signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
signal[1]<-0

First on more complex rules: I have tried looking at vector operations 
but trying to write a rule for spreads like this:

[rule for opening]
if !not_open(yesterday(last_spread > 2 * standard deviation) and 
today(last_spread < 2 * standard deviation)) -> open short spread )(and 
vica versa)

[rule for stop loss]
if open(last_spread > opening_spread * 1.05 [stop loss]) -> close short 
(and vica versa)

[rule for closing]

if open(last_spread < moving average) -> close short (and vica versa)

defeated me and I ending up writing some code like this (notice that I 
haven't got the stop loss rule in it):

i <- 1
long = 0
short = 0
for (i in seq(from=1,to=length(spread.data$Close),by=1)) {
     # lets get the data in more usable names
     close.today <- spread.data[i,1]
     close.yesterday <- spread.data[i-1,1]
     # just to deal with the first period when there is no yesterday
     if(i == 1) close.yesterday <- close.today
     mean.today <- spread.data[i,2]
     mean.yesterday <- spread.data[i-1,2]
     # just to deal with the first period when there is no yesterday
     if(i == 1) mean.yesterday <- mean.today
     upper.boundary.today <- spread.data[i,3]
     upper.boundary.yesterday <- spread.data[i-1,3]
     # just to deal with the first period when there is no yesterday
     if(i == 1) upper.boundary.yesterday <- upper.boundary.today
     lower.boundary.today <- spread.data[i,4]
     lower.boundary.yesterday <- spread.data[i-1,4]
     # just to deal with the first period when there is no yesterday
     if(i == 1) lower.boundary.yesterday <- lower.boundary.today
     # lets try and find if we have a long signal
         #print(c(i, 
-close.yesterday,lower.boundary.yesterday,close.today,lower.boundary.today))
         ################## RULES FROM HERE ##################
         # spread$Close - spread$Close.1
         ####### FIRST FOR A LONG #####
         ####### first find lower boundary crossings #####
         if(long == 0) position = 0
         if(close.yesterday <= lower.boundary.yesterday && close.today > 
lower.boundary.today) long = 1
         ####### find mean crossings #####
     if (long == 1 && close.today > mean.today) long = 0
     sigup[i] <- long
     #print(c(i, long, 
close.yesterday,lower.boundary.yesterday,close.today,lower.boundary.today))
     ####### THEN FOR A SHORT #####
     ####### first find upper boundary crossings #####
     if(close.yesterday >= upper.boundary.yesterday && close.today < 
upper.boundary.today) short = -1
     ####### find mean crossings #####
     if (short == -1 && close.today < mean.today) short = 0
     sigdn[i] <- short

}

So I put it all in a loop and carry forward my positions/triggers from 
one day to the next which is sort of the way I would normally program.

Can you write rules such as I am trying to using vector operations and 
does blotter lend itself to this?

Second: on  more general note this whole question of stop loss is very 
significant to results.  I find that most back testing is based upon not 
adopting such a policy, but prudence would almost always insist on one 
doing so.   If you have no real option but to adopt a stop loss policy 
then the most important question is what is the correct level of 
protection.  I get very annoyed when my strategy works without a stop 
loss and then the first time I take a position I get closed out by my 
stop loss and lose money and then the next day or the day after I find 
the figures put me back in the black.   Anyway, I guess this is just an 
iterative process using a binary search but, again, are there any useful 
ideas about how one can go about this sort of optimisation re-using 
existing packages/code?

Stephen Choularton Ph.D., FIoD


On 29/12/2010 7:18 AM, Brian G. Peterson wrote:
> On 12/28/2010 01:28 PM, Stephen Choularton wrote:
>> My apologies.
>>
>> I did not realize the script worked so slowly.  I reduced the time scale
>> it covered so it commenced at the beginning of the year and it did run
>> to completion.  I will try the full term and see if it produces the same
>> graphs as the original example.
> >
>> I'm always a bit worried about warnings as they often mean something is
>> going wrong and it might be useful if kafta had warned one not to worry
>> about them.  Mind you I think he did say it all took a long time ;-)
>
>
> The reason this script runs slowly is that it is calling updatePortf, 
> updateAcct, and updateEndEq after each and every observation to do 
> order sizing.
>
> As a matter of practice, if you can 'cheat' and say 'I've got $1000000 
> to invest, and I don't mind being a little leveraged', you don't need 
> to do that, and things are *much* faster.  For example, we can 
> typically run a strategy backtest on *tick* data (millions of 
> observations) in less than a minute per day.
>
> The reason for this divergent length of time is that the blotter 
> update* functions do a *lot* of calculations, and all of those take 
> time, even though they are vectorized where possible.
>
> Perhaps a middle ground would be to call the update* functions 
> monthly, or something similar.
>
> I found his example script to be slower than I am used to, but not 
> unbearable, and believe that it finished in a couple minutes, though 
> its been a while since I ran it...
>
>
>> I can assure you I do try and read man before I ask for help but dealing
>> with other people's code is not always easy particularly when working
>> with a programming system that uses a different paradigm like R with its
>> emphasis on operations on vectors and the like. and the extensive use of
>> calls to functions each of which often require a wet towel and cup of
>> coffee to understand.
>>
>> I added the parameter definitions you suggest:
>>
>> currency("USD")
>> stock("SPY",currency="USD",multiplier=1)
>>
>> and the warnings reduced to one:
>
> Good.
>
>> Warning messages:
>> 1: In updatePortf(ltportfolio, Dates = currentDate) :
>>    Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
> <...>
>
>> "Ops.Date", "Ops.POSIXt" don't appear in the function call so they must
>> be somewhere deeper.  I'm afraid I'm currently a windows user so grep is
>> not available and the windows native text search didn't reveal much.
>> However, I did find some references in the documentation (Date-Time
>> Classes, Operators on the Date Class & S3 Group Generic Functions) but
>> Ops.POSIXt doesn't appear therein only POSIXlt and Ops.POSIXct.  Is
>> there a typo somewhere ?
>
> It's likely not a typo, but rather an incompatible index between one 
> time series and another.  You'd need to check the indices of each of 
> the input series, or of the custom order sizing function from the 
> script to see what's going on.  If the output from your run and the 
> blog post agree, I wouldn't bother.
>
>> It would be nice to get rid of the warnings.
>
>


From peter at braverock.com  Thu Jan  6 21:11:13 2011
From: peter at braverock.com (Peter Carl)
Date: Thu, 6 Jan 2011 14:11:13 -0600
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <4D261D70.5000007@organicfoodmarkets.com.au>
References: <4D124B20.80401@organicfoodmarkets.com.au>
	<4D124C41.60106@braverock.com>
	<4D1272A6.6060502@organicfoodmarkets.com.au>
	<f5255610624f16b9615507cbb55aecfb@braverock.com>
	<4D198E41.3080802@organicfoodmarkets.com.au>
	<ad29406d0c73eaeb9a6513afb1820c6a@braverock.com>
	<4D1A3A76.9010406@organicfoodmarkets.com.au>
	<4D1A45FE.6070007@braverock.com>
	<4D261D70.5000007@organicfoodmarkets.com.au>
Message-ID: <cf5a236e07346944d1487f239e8f51b4.squirrel@mail.braverock.com>

Stephen,

Blotter is just portfolio infrastructure, and has nothing to do with rules
or strategy development.  You can address those issues either with custom
code that sends trades into blotter, or using a package like quantstrat.

Quantstrat is a framework for specifying trading strategies that uses
blotter underneath.  It is in active development, and is available on
R-forge.

pcc
-- 
Peter Carl
http://www.braverock.com/~peter

> Hi
>
> One thing that I want to understand is the effect of stop-loss activity
> on results and employing more complex rules.  The two examples I am
> looking at have fairly simple rules like:
>
> # three days higher close, high and open than on previous day
>
> #one day before
> lag1<-lag((SPY),1)
>
> #two days defore
> lag2<-lag((SPY),2)
>
> signal<-ifelse( (Cl(lag2)>Cl(lag1) & Cl(lag1)>Cl(SPY))&
>              (Hi(lag2)>Hi(lag1) & Hi(lag1)>Hi(SPY)) &
>              (Op(lag2)>Op(lag1) & Op(lag1)>Op(SPY)),
>              1,0
> )
>
> and
>
> # if today's low is higher than yesterday's close 1, else 0
>
> signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
> signal[1]<-0
>
> First on more complex rules: I have tried looking at vector operations
> but trying to write a rule for spreads like this:
>
> [rule for opening]
> if !not_open(yesterday(last_spread > 2 * standard deviation) and
> today(last_spread < 2 * standard deviation)) -> open short spread )(and
> vica versa)
>
> [rule for stop loss]
> if open(last_spread > opening_spread * 1.05 [stop loss]) -> close short
> (and vica versa)
>
> [rule for closing]
>
> if open(last_spread < moving average) -> close short (and vica versa)
>
> defeated me and I ending up writing some code like this (notice that I
> haven't got the stop loss rule in it):
>
> i <- 1
> long = 0
> short = 0
> for (i in seq(from=1,to=length(spread.data$Close),by=1)) {
>      # lets get the data in more usable names
>      close.today <- spread.data[i,1]
>      close.yesterday <- spread.data[i-1,1]
>      # just to deal with the first period when there is no yesterday
>      if(i == 1) close.yesterday <- close.today
>      mean.today <- spread.data[i,2]
>      mean.yesterday <- spread.data[i-1,2]
>      # just to deal with the first period when there is no yesterday
>      if(i == 1) mean.yesterday <- mean.today
>      upper.boundary.today <- spread.data[i,3]
>      upper.boundary.yesterday <- spread.data[i-1,3]
>      # just to deal with the first period when there is no yesterday
>      if(i == 1) upper.boundary.yesterday <- upper.boundary.today
>      lower.boundary.today <- spread.data[i,4]
>      lower.boundary.yesterday <- spread.data[i-1,4]
>      # just to deal with the first period when there is no yesterday
>      if(i == 1) lower.boundary.yesterday <- lower.boundary.today
>      # lets try and find if we have a long signal
>          #print(c(i,
> -close.yesterday,lower.boundary.yesterday,close.today,lower.boundary.today))
>          ################## RULES FROM HERE ##################
>          # spread$Close - spread$Close.1
>          ####### FIRST FOR A LONG #####
>          ####### first find lower boundary crossings #####
>          if(long == 0) position = 0
>          if(close.yesterday <= lower.boundary.yesterday && close.today >
> lower.boundary.today) long = 1
>          ####### find mean crossings #####
>      if (long == 1 && close.today > mean.today) long = 0
>      sigup[i] <- long
>      #print(c(i, long,
> close.yesterday,lower.boundary.yesterday,close.today,lower.boundary.today))
>      ####### THEN FOR A SHORT #####
>      ####### first find upper boundary crossings #####
>      if(close.yesterday >= upper.boundary.yesterday && close.today <
> upper.boundary.today) short = -1
>      ####### find mean crossings #####
>      if (short == -1 && close.today < mean.today) short = 0
>      sigdn[i] <- short
>
> }
>
> So I put it all in a loop and carry forward my positions/triggers from
> one day to the next which is sort of the way I would normally program.
>
> Can you write rules such as I am trying to using vector operations and
> does blotter lend itself to this?
>
> Second: on  more general note this whole question of stop loss is very
> significant to results.  I find that most back testing is based upon not
> adopting such a policy, but prudence would almost always insist on one
> doing so.   If you have no real option but to adopt a stop loss policy
> then the most important question is what is the correct level of
> protection.  I get very annoyed when my strategy works without a stop
> loss and then the first time I take a position I get closed out by my
> stop loss and lose money and then the next day or the day after I find
> the figures put me back in the black.   Anyway, I guess this is just an
> iterative process using a binary search but, again, are there any useful
> ideas about how one can go about this sort of optimisation re-using
> existing packages/code?
>
> Stephen Choularton Ph.D., FIoD
>
>
> On 29/12/2010 7:18 AM, Brian G. Peterson wrote:
>> On 12/28/2010 01:28 PM, Stephen Choularton wrote:
>>> My apologies.
>>>
>>> I did not realize the script worked so slowly.  I reduced the time
>>> scale
>>> it covered so it commenced at the beginning of the year and it did run
>>> to completion.  I will try the full term and see if it produces the
>>> same
>>> graphs as the original example.
>> >
>>> I'm always a bit worried about warnings as they often mean something is
>>> going wrong and it might be useful if kafta had warned one not to worry
>>> about them.  Mind you I think he did say it all took a long time ;-)
>>
>>
>> The reason this script runs slowly is that it is calling updatePortf,
>> updateAcct, and updateEndEq after each and every observation to do
>> order sizing.
>>
>> As a matter of practice, if you can 'cheat' and say 'I've got $1000000
>> to invest, and I don't mind being a little leveraged', you don't need
>> to do that, and things are *much* faster.  For example, we can
>> typically run a strategy backtest on *tick* data (millions of
>> observations) in less than a minute per day.
>>
>> The reason for this divergent length of time is that the blotter
>> update* functions do a *lot* of calculations, and all of those take
>> time, even though they are vectorized where possible.
>>
>> Perhaps a middle ground would be to call the update* functions
>> monthly, or something similar.
>>
>> I found his example script to be slower than I am used to, but not
>> unbearable, and believe that it finished in a couple minutes, though
>> its been a while since I ran it...
>>
>>
>>> I can assure you I do try and read man before I ask for help but
>>> dealing
>>> with other people's code is not always easy particularly when working
>>> with a programming system that uses a different paradigm like R with
>>> its
>>> emphasis on operations on vectors and the like. and the extensive use
>>> of
>>> calls to functions each of which often require a wet towel and cup of
>>> coffee to understand.
>>>
>>> I added the parameter definitions you suggest:
>>>
>>> currency("USD")
>>> stock("SPY",currency="USD",multiplier=1)
>>>
>>> and the warnings reduced to one:
>>
>> Good.
>>
>>> Warning messages:
>>> 1: In updatePortf(ltportfolio, Dates = currentDate) :
>>>    Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
>> <...>
>>
>>> "Ops.Date", "Ops.POSIXt" don't appear in the function call so they must
>>> be somewhere deeper.  I'm afraid I'm currently a windows user so grep
>>> is
>>> not available and the windows native text search didn't reveal much.
>>> However, I did find some references in the documentation (Date-Time
>>> Classes, Operators on the Date Class & S3 Group Generic Functions) but
>>> Ops.POSIXt doesn't appear therein only POSIXlt and Ops.POSIXct.  Is
>>> there a typo somewhere ?
>>
>> It's likely not a typo, but rather an incompatible index between one
>> time series and another.  You'd need to check the indices of each of
>> the input series, or of the custom order sizing function from the
>> script to see what's going on.  If the output from your run and the
>> blog post agree, I wouldn't bother.
>>
>>> It would be nice to get rid of the warnings.
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From ggrothendieck at gmail.com  Thu Jan  6 22:33:17 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 6 Jan 2011 16:33:17 -0500
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
	<AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>
Message-ID: <AANLkTi=R45GT-Os5k+zSgX1d8y9cBRLzBL6hbiE64-2d@mail.gmail.com>

On Thu, Jan 6, 2011 at 12:55 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
>> Cheers,
>> Murali
>>
>> -----Original Message-----
>> From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Mark Knecht
>> Sent: 06 January 2011 17:19
>> To: R-Finance
>> Subject: [R-SIG-Finance] Create a Monday-Friday time series?
>>
>> Hi,
>> ? I think I'm going to have a couple of questions but I figured I'd
>> start with (I hope) a very simple one. I've not worked with time
>> series objects before so I'm trying to learn them. I've been looking
>> at things like ?xts, ?zoo as well as Phil Proctor's book but so far no
>> luck.
>>
>> ? Starting from this little code stub I'd like to create a Monday
>> through Friday time series into which I can eventually place trading
>> system results.
>>
>> ? Here's the stub:
>>
>> TStoDate = function (TSDate) {
>> ? ? ? ?X = strptime(TSDate + 19e6L, "%Y%m%d")
>> ? ? ? ?return(as.Date(X))
>> }
>>
>> # TradeStation date format
>> FirstDate = 1100401
>> LastDate = 1100601
>>
>> #Dates
>> StartDate = TStoDate(FirstDate)
>> EndDate = TStoDate(LastDate)
>>
>> StartDate
>> EndDate
>>
>> ? How can I do this, and (if possible and easy) is there a way to
>> exclude U.S. holidays?
>>
>> ? I did discover
>>
>> R1 <- as.zoo(StartDate:EndDate )
>>
>> does create an object, but the values are numbers which I don't
>> understand but suspect are some internal R code for a date, and it
>> appears to have enough entries to include weekends.
>>
>> ? Anyway, hopefully this is clear enough to describe what I'm trying
>> to do and where I'm stuck.
>>
> On Thu, Jan 6, 2011 at 12:29 PM, ?<Murali.Menon at avivainvestors.com> wrote:
>> Hi,
>>
>> For US holidays, the timeDate package in Rmetrics has a function holidayNYSE() to which you pass a numeric range for years, e.g. holidayNYSE(1980:1990).
>>
>
> To add to this try:
>
> library(timeDate) # holidayNYSE
> library(chron) # .Holidays / is.holiday / is.weekend
>
> # this will be used by is.holiday
> .Holidays <- chron(as.Date(holidayNYSE(year = 2010)))

That should as.chron, rather than chron, i.e.

.Holidays <- as.chron(as.Date(holidayNYSE(year = 2010)))


>
> StartDate <- as.Date("2010-01-01")
> EndDate <- as.Date("2010-04-01")
>
> dd <- seq(StartDate, EndDate, by = "day")
>
> dd[!is.weekend(dd) & !is.holiday(dd)]
>
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From markknecht at gmail.com  Thu Jan  6 22:40:43 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Thu, 6 Jan 2011 13:40:43 -0800
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <AANLkTi=R45GT-Os5k+zSgX1d8y9cBRLzBL6hbiE64-2d@mail.gmail.com>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
	<AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>
	<AANLkTi=R45GT-Os5k+zSgX1d8y9cBRLzBL6hbiE64-2d@mail.gmail.com>
Message-ID: <AANLkTin5zA4nj_5osf_K7e34K+v6CokAvip--RHXEOQc@mail.gmail.com>

On Thu, Jan 6, 2011 at 1:33 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
<SNIP>
>
> That should as.chron, rather than chron, i.e.
>
> .Holidays <- as.chron(as.Date(holidayNYSE(year = 2010)))
>

Thanks.

- Mark


From ggrothendieck at gmail.com  Thu Jan  6 22:42:24 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 6 Jan 2011 16:42:24 -0500
Subject: [R-SIG-Finance] Create a Monday-Friday time series?
In-Reply-To: <AANLkTikOUnRgDvPLFzsJaNw1nyEwrKz-e4ej6eNE30oC@mail.gmail.com>
References: <AANLkTi=wuxH_n8Bog=it2u6UzsaiSN1xM=yUmP=HaN5w@mail.gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619F5E45C49@SWVLONCUEXDP01.im.root-domain.net>
	<AANLkTi=cMmUA165+6OujUN0p--nhe_YLtpoJO81NM4wZ@mail.gmail.com>
	<AANLkTikOUnRgDvPLFzsJaNw1nyEwrKz-e4ej6eNE30oC@mail.gmail.com>
Message-ID: <AANLkTikgeaKYqTv-+GDi5z6Xb_X1A6FFjUVNjpBmDOJR@mail.gmail.com>

On Thu, Jan 6, 2011 at 2:51 PM, Mark Knecht <markknecht at gmail.com> wrote:
> Also, what's the command to package up some real data from a
> data.frame so that it survives being emailed? When I respond back
> later I want to include a few real trades so you can recreate whatever
> I'm seeing.
>

See ?dput

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From risk2009 at ath.forthnet.gr  Fri Jan  7 14:13:32 2011
From: risk2009 at ath.forthnet.gr (Costas)
Date: Fri, 07 Jan 2011 15:13:32 +0200
Subject: [R-SIG-Finance] blotter
Message-ID: <4D27117C.9000007@ath.forthnet.gr>

I can't seem to be able to donwload/install this library/package.

Anyone knows its whereabouts?

 > install.packages("blotter", repos="http://R-Forge.R-project.org")
Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
package ?blotter? is not available
 >


From brian at braverock.com  Fri Jan  7 14:25:49 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 07 Jan 2011 07:25:49 -0600
Subject: [R-SIG-Finance] blotter
In-Reply-To: <4D27117C.9000007@ath.forthnet.gr>
References: <4D27117C.9000007@ath.forthnet.gr>
Message-ID: <4D27145D.4010400@braverock.com>

On 01/07/2011 07:13 AM, Costas wrote:
> I can't seem to be able to donwload/install this library/package.
>
> Anyone knows its whereabouts?
>
>  > install.packages("blotter", repos="http://R-Forge.R-project.org")
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
> package ?blotter? is not available

Your install line is correct.

It is likely that you need to upgrade to R 2.12.x, though you didn't 
provide your R version (likely older) or operating system (likely 
Windows) per the posting guide (please read this before posting again).

R-Forge only provides binary packages for the current major R release, 
which is at this point R 2.12.x

Alternately, on Windows, install Duncan's Rtools, and build from source.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From josh.m.ulrich at gmail.com  Fri Jan  7 15:04:14 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 7 Jan 2011 08:04:14 -0600
Subject: [R-SIG-Finance] blotter
In-Reply-To: <4D27145D.4010400@braverock.com>
References: <4D27117C.9000007@ath.forthnet.gr> <4D27145D.4010400@braverock.com>
Message-ID: <AANLkTi=B=zpLgubr5hVoqq3b4S6RD=KmqO1x3zQfNCXY@mail.gmail.com>

Looks like the Windows binary of blotter is not currently available.
https://r-forge.r-project.org/R/?group_id=316&log=build_win64&pkg=blotter&flavor=patched

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Fri, Jan 7, 2011 at 7:25 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 01/07/2011 07:13 AM, Costas wrote:
>>
>> I can't seem to be able to donwload/install this library/package.
>>
>> Anyone knows its whereabouts?
>>
>> ?> install.packages("blotter", repos="http://R-Forge.R-project.org")
>> Warning message:
>> In getDependencies(pkgs, dependencies, available, lib) :
>> package ?blotter? is not available
>
> Your install line is correct.
>
> It is likely that you need to upgrade to R 2.12.x, though you didn't provide
> your R version (likely older) or operating system (likely Windows) per the
> posting guide (please read this before posting again).
>
> R-Forge only provides binary packages for the current major R release, which
> is at this point R 2.12.x
>
> Alternately, on Windows, install Duncan's Rtools, and build from source.
>
> Regards,
>
> ?- Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From bjorn.hertzberg at gmail.com  Sat Jan  8 18:07:07 2011
From: bjorn.hertzberg at gmail.com (=?utf-8?Q?Bj=C3=B6rn_Hertzberg?=)
Date: Sat, 8 Jan 2011 18:07:07 +0100
Subject: [R-SIG-Finance] kyle.r?
Message-ID: <75425379-6EA0-4803-8CDA-EAE2F0DC9369@gmail.com>

I've been trying to find the code for simulating the Kyle 1985 model that Dale Rosenthal presented on his R/Finance 2009 market microstructure tutorial, but can't find it. Does anyone have a copy of it?

Regards,

Bjorn

From josh.m.ulrich at gmail.com  Sat Jan  8 18:50:00 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 8 Jan 2011 11:50:00 -0600
Subject: [R-SIG-Finance] kyle.r?
In-Reply-To: <75425379-6EA0-4803-8CDA-EAE2F0DC9369@gmail.com>
References: <75425379-6EA0-4803-8CDA-EAE2F0DC9369@gmail.com>
Message-ID: <AANLkTimNOhW04Zb1ZL8ZyMXK6PpmwDxcMexXjvR8wcVm@mail.gmail.com>

I attended that presentation and I'm fairly certain Dale asked that we
not share his code.  Have you asked him for it?
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



2011/1/8 Bj?rn Hertzberg <bjorn.hertzberg at gmail.com>:
> I've been trying to find the code for simulating the Kyle 1985 model that Dale Rosenthal presented on his R/Finance 2009 market microstructure tutorial, but can't find it. Does anyone have a copy of it?
>
> Regards,
>
> Bjorn
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From bjorn.hertzberg at gmail.com  Sat Jan  8 19:28:13 2011
From: bjorn.hertzberg at gmail.com (=?utf-8?Q?Bj=C3=B6rn_Hertzberg?=)
Date: Sat, 8 Jan 2011 19:28:13 +0100
Subject: [R-SIG-Finance] kyle.r?
In-Reply-To: <AANLkTimNOhW04Zb1ZL8ZyMXK6PpmwDxcMexXjvR8wcVm@mail.gmail.com>
References: <75425379-6EA0-4803-8CDA-EAE2F0DC9369@gmail.com>
	<AANLkTimNOhW04Zb1ZL8ZyMXK6PpmwDxcMexXjvR8wcVm@mail.gmail.com>
Message-ID: <65165AF7-8EC7-4150-970C-6D95D2726A07@gmail.com>

No, havn't spoken with him. If he wishes to keep it out of distribution, then I agree we should respect his wishes. Just need to check some things to know if it's worth spending more time on the (Kyle) model.

Do you know if there are any papers on the price distribution characteristics of the Kyle model?


Regards,


Bjorn




8 jan 2011 kl. 18:50 skrev Joshua Ulrich <josh.m.ulrich at gmail.com>:

> I attended that presentation and I'm fairly certain Dale asked that we
> not share his code.  Have you asked him for it?
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
> 
> 
> 
> 2011/1/8 Bj?rn Hertzberg <bjorn.hertzberg at gmail.com>:
>> I've been trying to find the code for simulating the Kyle 1985 model that Dale Rosenthal presented on his R/Finance 2009 market microstructure tutorial, but can't find it. Does anyone have a copy of it?
>> 
>> Regards,
>> 
>> Bjorn
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>> 


From josh.m.ulrich at gmail.com  Sat Jan  8 19:31:58 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 8 Jan 2011 12:31:58 -0600
Subject: [R-SIG-Finance] kyle.r?
In-Reply-To: <65165AF7-8EC7-4150-970C-6D95D2726A07@gmail.com>
References: <75425379-6EA0-4803-8CDA-EAE2F0DC9369@gmail.com>
	<AANLkTimNOhW04Zb1ZL8ZyMXK6PpmwDxcMexXjvR8wcVm@mail.gmail.com>
	<65165AF7-8EC7-4150-970C-6D95D2726A07@gmail.com>
Message-ID: <AANLkTikXnexpFqmOrQsJ6+a__fbYmEfTSprWjy4GRf4B@mail.gmail.com>

Bj?rn,

2011/1/8 Bj?rn Hertzberg <bjorn.hertzberg at gmail.com>:
> No, havn't spoken with him. If he wishes to keep it out of distribution, then I agree we should respect his wishes. Just need to check some things to know if it's worth spending more time on the (Kyle) model.
>
I spoke with Dale off-list and he said he's working the code into a
manuscript, so he wants to keep it out of distribution.

> Do you know if there are any papers on the price distribution characteristics of the Kyle model?
>
I don't, but Dale probably would.  That's another reason to contact
him directly.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


>
> Regards,
>
>
> Bjorn
>
>
>
>
> 8 jan 2011 kl. 18:50 skrev Joshua Ulrich <josh.m.ulrich at gmail.com>:
>
>> I attended that presentation and I'm fairly certain Dale asked that we
>> not share his code. ?Have you asked him for it?
>> --
>> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>>
>>
>>
>> 2011/1/8 Bj?rn Hertzberg <bjorn.hertzberg at gmail.com>:
>>> I've been trying to find the code for simulating the Kyle 1985 model that Dale Rosenthal presented on his R/Finance 2009 market microstructure tutorial, but can't find it. Does anyone have a copy of it?
>>>
>>> Regards,
>>>
>>> Bjorn
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>>
>


From bjorn.hertzberg at gmail.com  Sat Jan  8 20:19:00 2011
From: bjorn.hertzberg at gmail.com (=?utf-8?Q?Bj=C3=B6rn_Hertzberg?=)
Date: Sat, 8 Jan 2011 20:19:00 +0100
Subject: [R-SIG-Finance] kyle.r?
In-Reply-To: <AANLkTikXnexpFqmOrQsJ6+a__fbYmEfTSprWjy4GRf4B@mail.gmail.com>
References: <75425379-6EA0-4803-8CDA-EAE2F0DC9369@gmail.com>
	<AANLkTimNOhW04Zb1ZL8ZyMXK6PpmwDxcMexXjvR8wcVm@mail.gmail.com>
	<65165AF7-8EC7-4150-970C-6D95D2726A07@gmail.com>
	<AANLkTikXnexpFqmOrQsJ6+a__fbYmEfTSprWjy4GRf4B@mail.gmail.com>
Message-ID: <CE3F5F7C-5B0D-4457-B743-506A8842FDB1@gmail.com>

Ok, I'll speak with him directly.

Thanks!

/bjorn



Skickat fr?n min iPhone

8 jan 2011 kl. 19:31 skrev Joshua Ulrich <josh.m.ulrich at gmail.com>:

> Bj?rn,
> 
> 2011/1/8 Bj?rn Hertzberg <bjorn.hertzberg at gmail.com>:
>> No, havn't spoken with him. If he wishes to keep it out of distribution, then I agree we should respect his wishes. Just need to check some things to know if it's worth spending more time on the (Kyle) model.
>> 
> I spoke with Dale off-list and he said he's working the code into a
> manuscript, so he wants to keep it out of distribution.
> 
>> Do you know if there are any papers on the price distribution characteristics of the Kyle model?
>> 
> I don't, but Dale probably would.  That's another reason to contact
> him directly.
> 
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
> 
> 
>> 
>> Regards,
>> 
>> 
>> Bjorn
>> 
>> 
>> 
>> 
>> 8 jan 2011 kl. 18:50 skrev Joshua Ulrich <josh.m.ulrich at gmail.com>:
>> 
>>> I attended that presentation and I'm fairly certain Dale asked that we
>>> not share his code.  Have you asked him for it?
>>> --
>>> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>>> 
>>> 
>>> 
>>> 2011/1/8 Bj?rn Hertzberg <bjorn.hertzberg at gmail.com>:
>>>> I've been trying to find the code for simulating the Kyle 1985 model that Dale Rosenthal presented on his R/Finance 2009 market microstructure tutorial, but can't find it. Does anyone have a copy of it?
>>>> 
>>>> Regards,
>>>> 
>>>> Bjorn
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions should go.
>>>> 
>> 


From stephen at organicfoodmarkets.com.au  Sat Jan  8 22:54:47 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sun, 09 Jan 2011 08:54:47 +1100
Subject: [R-SIG-Finance] quantstrat
Message-ID: <4D28DD27.4050902@organicfoodmarkets.com.au>

Hi

I'm trying to money the bbands demo to by it on the S&P/ ASX 200.

  I think the Symbol is ^AXJO and I can get the info I want using it.

  I have amended the code as follows:

# bbands



  require(quantstrat)

  try(rm("order_book.bbands",pos=.strategy),silent=TRUE)

  try(rm("account.bbands","portfolio.bbands",pos=.blotter),silent=TRUE)

  try(rm("account.st","portfolio.st","stock.str","stratBBands","initDate","initEq",'start_t','end_t'),silent=TRUE)

  # some things to set up here
  stock.str='^AXJO' # what are we trying it on

  # we'll pass these
  SD = 2 # how many standard deviations, traditionally 2

  N = 20 # how many periods for the moving average, traditionally 20

  currency('AUD')

  stock(stock.str,currency='AUD',multiplier=1)

  initDate='2006-12-31'

  initEq=1000000

  portfolio.st='bbands'

  account.st='bbands'

  initPortf(portfolio.st,symbols=stock.str, initDate=initDate)

  initAcct(account.st,portfolios='bbands', initDate=initDate)

  initOrders(portfolio=portfolio.st,initDate=initDate)

  stratBBands <- strategy("bbands")

  #one indicator
  stratBBands <- add.indicator(strategy = stratBBands, name = "BBands", 
arguments = list(HLC = quote(HLC(mktdata)), maType='SMA'))

  #add signals:
  stratBBands <- add.signal(stratBBands,name="sigCrossover",arguments = 
list(columns=c("Close","up"),relationship="gt"),label="Cl.gt.UpperBand")

  stratBBands <- add.signal(stratBBands,name="sigCrossover",arguments = 
list(columns=c("Close","dn"),relationship="lt"),label="Cl.lt.LowerBand")

  stratBBands <- add.signal(stratBBands,name="sigCrossover",arguments = 
list(columns=c("High","Low","mavg"),relationship="op"),label="Cross.Mid")

  # lets add some rules
  stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(sigcol="Cl.gt.UpperBand",sigval=TRUE, orderqty=-100, 
ordertype='market', orderside=NULL, threshold=NULL),type='enter')

  stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(sigcol="Cl.lt.LowerBand",sigval=TRUE, orderqty= 100, 
ordertype='market', orderside=NULL, threshold=NULL),type='enter')

  stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(sigcol="Cross.Mid",sigval=TRUE, orderqty= 'all', 
ordertype='market', orderside=NULL, threshold=NULL),type='exit')

  #alternately, to exit at the opposite band, the rules would be...
  #stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(data=quote(mktdata),sigcol="Lo.gt.UpperBand",sigval=TRUE, orderqty= 
'all', ordertype='market', orderside=NULL, threshold=NULL),type='exit')
  #stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(data=quote(mktdata),sigcol="Hi.lt.LowerBand",sigval=TRUE, orderqty= 
'all', ordertype='market', orderside=NULL, threshold=NULL),type='exit')

  #TODO add thresholds and stop-entry and stop-exit handling to test

  getSymbols(stock.str,from=initDate)

  start_t<-Sys.time()

  out<-try(applyStrategy(strategy=stratBBands , 
portfolios='bbands',mktdata='AXJO', 
parameters=list(sd=SD,n=N),verbose=TRUE) )


  # look at the order book
  #getOrderBook('bbands')
  end_t<-Sys.time()

  print("strat execution time:")

  print(end_t-start_t)
Time difference of 32.271 secs

  start_t<-Sys.time()

  updatePortf(Portfolio='bbands',Dates=paste('::',as.Date(Sys.time()),sep=''))

  end_t<-Sys.time()

  print("updatePortf execution time:")

  print(end_t-start_t)

  chart.Posn(Portfolio='bbands',Symbol=stock.str)

  plot(add_BBands(on=1,sd=SD,n=N))

  ###############################################################################
  # R (http://r-project.org/) Quantitative Strategy Model Framework
  #
  # Copyright (c) 2009-2010
  # Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and 
Joshua Ulrich
  #
  # This library is distributed under the terms of the GNU Public 
License (GPL)
  # for full details see the file COPYING
  #
  # $Id: bbands.R 374 2010-08-17 18:43:35Z braverock $
  #
  ###############################################################################


I get my prices with thus


 >  getSymbols(stock.str,from=initDate)
[1] "AXJO"


but note the hat has been dropped!

and just afterwards I get thIs:

rategy=stratBBands , portfolios='bbands', 
parameters=list(sd=SD,n=N),verbose=TRUE) )
Error in get(symbol) : object '^AXJO' not found

I've looked at the notes for applyStrategy and I've tried specifically 
referring to AXJO like this:
 >
 >  out<-try(applyStrategy(strategy=stratBBands , 
portfolios='bbands',mktdata='AXJO', 
parameters=list(sd=SD,n=N),verbose=TRUE) )
Error in get(symbol) : object '^AXJO' not found

but I still get the message.

Can anyone advise me how to resolve this?

-- 
Stephen Choularton Ph.D., FIoD


From brian at braverock.com  Sat Jan  8 23:05:20 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 08 Jan 2011 16:05:20 -0600
Subject: [R-SIG-Finance] quantstrat
In-Reply-To: <4D28DD27.4050902@organicfoodmarkets.com.au>
References: <4D28DD27.4050902@organicfoodmarkets.com.au>
Message-ID: <4D28DFA0.4020004@braverock.com>

On 01/08/2011 03:54 PM, Stephen Choularton wrote:
> Can anyone advise me how to resolve this?

try this:

stock.str <- getSymbols(stock.str,from=initDate+1)

which should drop the hat for you.

the hat isn't a valid R variable name.

Also note, per the blotter documentation, that your first trade should 
occur *after* the initDate.

Cheers,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From vegaderivatives at gmail.com  Sun Jan  9 20:12:26 2011
From: vegaderivatives at gmail.com (Edgar Vega)
Date: Sun, 9 Jan 2011 14:12:26 -0500
Subject: [R-SIG-Finance] Technical and Fundamental Analysis
Message-ID: <AANLkTikhPEoXerP5C_H2f8UycrBbWiKWA958oKh47dDG@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110109/63779301/attachment.pl>

From marco.zanella at inbox.com  Sun Jan  9 14:22:23 2011
From: marco.zanella at inbox.com (Zanella Marco)
Date: Sun, 9 Jan 2011 05:22:23 -0800
Subject: [R-SIG-Finance] Ranks of Spearman's rank correlation coefficient
Message-ID: <DD454A7EADC.0000017Fmarco.zanella@inbox.com>

Dear Sirs,
I'm using cor() funcion with Spearman method to analyse correlation of timeseries. As you know Spearman method is based on ranks of timeseries, instead of their value. 

Well, what I'm not able to do is to extract the ranks of the timeseries used from cor() to compute the Spearman correlation coefficient (also called rho). 

For instance if I have this two timeseries
> a = c(-0.10, -0.21, -0.35, -0.38, -0.19)
> b = c(-0.53, -0.42, -0.59, -0.55, -0.35)

I obtain rho in this way
> cor(a,b, method="spearman")
>[1] 0.6

but how can I obtain ranks for the two timeseries? Of course, the same computed and used by previous cor().

Best,

Marco

____________________________________________________________
GET FREE 5GB EMAIL - Check out spam free email with many cool features!
Visit http://www.inbox.com/email to find out more!


From cedrick at cedrickjohnson.com  Sun Jan  9 20:25:28 2011
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Sun, 09 Jan 2011 14:25:28 -0500
Subject: [R-SIG-Finance] Technical and Fundamental Analysis
In-Reply-To: <AANLkTikhPEoXerP5C_H2f8UycrBbWiKWA958oKh47dDG@mail.gmail.com>
References: <AANLkTikhPEoXerP5C_H2f8UycrBbWiKWA958oKh47dDG@mail.gmail.com>
Message-ID: <4D2A0BA8.7020407@cedrickjohnson.com>

you can try the quantmod and TTR packages (along with the associated 
docs/vignettes)

-c

On 01/09/2011 02:12 PM, Edgar Vega wrote:
> Do you know any document on Fundamental and technical analysis in R?
> Can you provide with that type of resource?
> Thank You,
>
> Ed
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From stephen at organicfoodmarkets.com.au  Sun Jan  9 20:34:57 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Mon, 10 Jan 2011 06:34:57 +1100
Subject: [R-SIG-Finance] quantstrat
In-Reply-To: <4D28DFA0.4020004@braverock.com>
References: <4D28DD27.4050902@organicfoodmarkets.com.au>
	<4D28DFA0.4020004@braverock.com>
Message-ID: <4D2A0DE1.8040802@organicfoodmarkets.com.au>

Thanks.

I still got some problems with that but in the end I used

  stock.str='AXJO'

but when I got the data referred to it correctly with:

  getSymbols('^AXJO',from=initDate)

and it all seemed to work.

Couple of questions though:

1.  First initDate+1.  I tried this but R didn't want to do the 
addition.  Do you mean that I should increment it outside and then use 
it such as:

nextDate='2007-01-01'
getSymbols('^AXJO',from=nextDate)

2.  I turned to the MACROSS code.  I edited it to refer to the aussie SPI:


  #########################################################################################################################################################################
  #A simple moving average strategy to evaluate trade efficiency
  #checks on SMA of 50 days and SMA of 200 days
  #Author: R. Raghuraman("raghu"), Brian Peterson
  #########################################################################################################################################################################

  require(quantstrat)

  try(rm("order_book.macross",pos=.strategy),silent=TRUE)

  try(rm("account.macross","portfolio.macross",pos=.blotter),silent=TRUE)

  try(rm("account.st","portfolio.st","stock.str","stratMACROSS","initDate","initEq",'start_t','end_t'),silent=TRUE)

  stock.str='AXJO' # what are we trying it on

  currency('AUD')

  stock(stock.str,currency='AUD',multiplier=1)

  initDate='1999-12-31'

  initEq=1000000

  portfolio.st='macross'

  account.st='macross'

  initPortf(portfolio.st,symbols=stock.str, initDate=initDate)

  initAcct(account.st,portfolios=portfolio.st, initDate=initDate)

  initOrders(portfolio=portfolio.st,initDate=initDate)

  stratMACROSS<- strategy(portfolio.st)

  stratMACROSS <- add.indicator(strategy = stratMACROSS, name = "SMA", 
arguments = list(x=quote(Cl(mktdata)), n=50),label= "ma50" )

  stratMACROSS <- add.indicator(strategy = stratMACROSS, name = "SMA", 
arguments = list(x=quote(Cl(mktdata)), n=200),label= "ma200")

  stratMACROSS <- add.signal(strategy = 
stratMACROSS,name="sigCrossover",arguments = 
list(columns=c("ma50","ma200"),relationship="gt"),label="ma50.gt.ma200")

  stratMACROSS <- add.signal(strategy = 
stratMACROSS,name="sigCrossover",arguments = 
list(column=c("ma50","ma200"),relationship="lt"),label="ma50.lt.ma200")

  stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal', 
arguments = list(sigcol="ma50.gt.ma200",sigval=TRUE, orderqty=100, 
ordertype='market', orderside='long'),type='enter')

  stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal', 
arguments = list(sigcol="ma50.lt.ma200",sigval=TRUE, orderqty=-100, 
ordertype='market', orderside='long'),type='exit')

  # if you want a long/short Stops and Reverse MA cross strategy, you'd 
add two more rules for the short side:

  stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal', 
arguments = list(sigcol="ma50.lt.ma200",sigval=TRUE, orderqty=-100, 
ordertype='market', orderside='short'),type='enter')

  stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal', 
arguments = list(sigcol="ma50.gt.ma200",sigval=TRUE, orderqty=100, 
ordertype='market', orderside='short'),type='exit')

  getSymbols('^AXJO',from=initDate)

  start_t<-Sys.time()

  out<-try(applyStrategy(strategy=stratMACROSS , portfolios=portfolio.st))

  end_t<-Sys.time()

  print(end_t-start_t)

  start_t<-Sys.time()

  updatePortf(Portfolio='macross',Dates=paste('::',as.Date(Sys.time()),sep=''))
  end_t<-Sys.time()

  print("trade blotter portfolio update:")

  print(end_t-start_t)

  chart.Posn(Portfolio='macross',Symbol=stock.str)

  add_SMA(n=50 , on=1,col='blue')

  add_SMA(n=200, on=1)

  ###############################################################################
  # R (http://r-project.org/) Quantitative Strategy Model Framework
  #
  # Copyright (c) 2009-2010
  # Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and 
Joshua Ulrich
  #
  # This library is distributed under the terms of the GNU Public 
License (GPL)
  # for full details see the file COPYING
  #
  # $Id: maCross.R 374 2010-08-17 18:43:35Z braverock $
  #
  ###############################################################################


Basically that was to refer to the AXJO and to put the AUD in.  Also I 
wanted to run a short rule as well so I removed the comment outs from 
those two lines.  I got some problems:

a. As you can see I get some warnings:


 >  out<-try(applyStrategy(strategy=stratMACROSS , portfolios=portfolio.st))
[1] "2003-06-12 AXJO 100 @ 3084.8"
[1] "2008-01-22 AXJO -100 @ 5186.8"
[1] "2009-06-17 AXJO 100 @ 3904.1"
[1] "2010-06-07 AXJO -100 @ 4325.9"
[1] "2010-11-02 AXJO 100 @ 4701.4"
Warning messages:
1: In match.names(columns, colnames(data)) :
   all columns not located in ma50 ma200 for AXJO.Open AXJO.High 
AXJO.Low AXJO.Close AXJO.Volume AXJO.Adjusted ma50 ma200 ma50.gt.ma200
2: In max(i) : no non-missing arguments to max; returning -Inf
3: In ruleOrderProc(portfolio = portfolio, symbol = symbol, mktdata = 
mktdata,  :
   orderQty of-100would cross through zero, reducing qty to0
4: In ruleOrderProc(portfolio = portfolio, symbol = symbol, mktdata = 
mktdata,  :
   orderQty of-100would cross through zero, reducing qty to0
5: In ruleOrderProc(portfolio = portfolio, symbol = symbol, mktdata = 
mktdata,  :
   orderQty of-100would cross through zero, reducing qty to0
6: In ruleOrderProc(portfolio = portfolio, symbol = symbol, mktdata = 
mktdata,  :
   orderQty of-100would cross through zero, reducing qty to0
7: In min(dindex[dindex > curIndex]) :
   no non-missing arguments to min; returning Inf

I am trying to make sense of them:

1. I cannot find any object called data so I'm a bit at a loss there.
3 - 6 Obviously these are to do with short sales violating some rule, 
but I cannot see such a rule so how do I make sure that shorts are allowed?

b.  A little later I get this:


 >  
updatePortf(Portfolio='macross',Dates=paste('::',as.Date(Sys.time()),sep=''))
Error in get(FXrate.str) : object 'AUDUSD' not found
Error in get(FXrate.str) : object 'USDAUD' not found
[1] "macross"
Warning message:
In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  :
   Exchange RateUSDAUD not found for symbol,',Symbol,' using currency 
multiplier of 1
 >

but again I cannot find any reference left to the USD.  I tried to 
specify AUD in getSymbols like this:

   getSymbols('^AXJO',currency='AUD', from=initDate)

but it made no difference.

Finally, is there anywhere I can read more/see more examples of 
add.indicator, add.rules other than ?add.indicator,  ?add.rules.

Thanks



Stephen Choularton Ph.D., FIoD

9999 2226
0413 545 182



On 09/01/2011 9:05 AM, Brian G. Peterson wrote:
> On 01/08/2011 03:54 PM, Stephen Choularton wrote:
>> Can anyone advise me how to resolve this?
>
> try this:
>
> stock.str <- getSymbols(stock.str,from=initDate+1)
>
> which should drop the hat for you.
>
> the hat isn't a valid R variable name.
>
> Also note, per the blotter documentation, that your first trade should 
> occur *after* the initDate.
>
> Cheers,
>
>   - Brian
>


From vegaderivatives at gmail.com  Sun Jan  9 21:03:49 2011
From: vegaderivatives at gmail.com (Edgar Vega)
Date: Sun, 9 Jan 2011 15:03:49 -0500
Subject: [R-SIG-Finance] quantmod for futures
Message-ID: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110109/9bf67057/attachment.pl>

From markknecht at gmail.com  Sun Jan  9 20:22:24 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Sun, 9 Jan 2011 11:22:24 -0800
Subject: [R-SIG-Finance] Technical and Fundamental Analysis
In-Reply-To: <AANLkTikhPEoXerP5C_H2f8UycrBbWiKWA958oKh47dDG@mail.gmail.com>
References: <AANLkTikhPEoXerP5C_H2f8UycrBbWiKWA958oKh47dDG@mail.gmail.com>
Message-ID: <AANLkTinx-tW6euUN4n7k16-RNp_9nZx4tdYWXEw33BE_@mail.gmail.com>

On Sun, Jan 9, 2011 at 11:12 AM, Edgar Vega <vegaderivatives at gmail.com> wrote:
> Do you know any document on Fundamental and technical analysis in R?
> Can you provide with that type of resource?
> Thank You,
>
> Ed

Have you discovered QuantMod?

If not here's a link:

http://www.quantmod.com/

Cheers,
Mark


From brian at braverock.com  Sun Jan  9 21:33:37 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 9 Jan 2011 14:33:37 -0600
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
Message-ID: <201101091433.37993.brian@braverock.com>

On Sunday, January 09, 2011 02:03:49 pm Edgar Vega wrote:
> getSymbols("ZC ",src="cmegroup")
> I am trying to get futures symbols from cme.

I'm not aware of a getSymbols.cmegroup function for source 'cmegroup'.

Did you write one?

 - Brian


From ggrothendieck at gmail.com  Sun Jan  9 21:02:10 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 9 Jan 2011 15:02:10 -0500
Subject: [R-SIG-Finance] Ranks of Spearman's rank correlation coefficient
In-Reply-To: <DD454A7EADC.0000017Fmarco.zanella@inbox.com>
References: <DD454A7EADC.0000017Fmarco.zanella@inbox.com>
Message-ID: <AANLkTikCZ=tmjGUgpH4ytvUB7qkc+Yjj79RkjBznKhUi@mail.gmail.com>

On Sun, Jan 9, 2011 at 8:22 AM, Zanella Marco <marco.zanella at inbox.com> wrote:
> Dear Sirs,
> I'm using cor() funcion with Spearman method to analyse correlation of timeseries. As you know Spearman method is based on ranks of timeseries, instead of their value.
>
> Well, what I'm not able to do is to extract the ranks of the timeseries used from cor() to compute the Spearman correlation coefficient (also called rho).
>
> For instance if I have this two timeseries
>> a = c(-0.10, -0.21, -0.35, -0.38, -0.19)
>> b = c(-0.53, -0.42, -0.59, -0.55, -0.35)
>
> I obtain rho in this way
>> cor(a,b, method="spearman")
>>[1] 0.6
>
> but how can I obtain ranks for the two timeseries? Of course, the same computed and used by previous cor().
>

Try this:

> cor(rank(a), rank(b))
[1] 0.6


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From noah at smartmediacorp.com  Mon Jan 10 09:05:27 2011
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 10 Jan 2011 00:05:27 -0800
Subject: [R-SIG-Finance] Boot samples from correlated time series.
Message-ID: <4D2ABDC7.9080603@smartmediacorp.com>

Hi,

I'm looking at about 20 assets returns for the past 50 periods.  They
returns are correlated (some more than others.)

I'm interested in trying some monte carlo techniques for determining an
optimal portfolio.  The "usual" method I seen uses a multivariate norm
to sample possible data (rmvnorm function in R.)

The returns are definitely not normally distributed.  So, my goal is to
duplicate the same functionality of using a rmvnorm, but for unknown
distributions that are partially correlated.  It was suggested to me
that I might look at the boot function in R, however this appears to
generate a summary statistic which isn't what I want.

What I'd really like to do is simulate possible "alternate paths" for
the assets based on their historical data.  The paths are random, but
follow the same distribution as the real assets and the same
correlation.  I can't seem to find a way to do this.  Does anyone have
any suggestions?

Thanks,

--
Noah


From Zeno.Adams at ebs.edu  Mon Jan 10 09:59:24 2011
From: Zeno.Adams at ebs.edu (Adams, Zeno)
Date: Mon, 10 Jan 2011 09:59:24 +0100
Subject: [R-SIG-Finance] Boot samples from correlated time series.
References: <4D2ABDC7.9080603@smartmediacorp.com>
Message-ID: <9064522880125945B98983BBAECBA1CC0101BDBC@exchsrv001.ebs.local>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110110/e84b5e16/attachment.pl>

From hela_fessi at yahoo.fr  Mon Jan 10 10:04:14 2011
From: hela_fessi at yahoo.fr (hela fessi)
Date: Mon, 10 Jan 2011 09:04:14 +0000 (GMT)
Subject: [R-SIG-Finance] panel cointegration test
Message-ID: <987695.94508.qm@web24001.mail.ird.yahoo.com>

hi 
how to perform panel cointegration test especially pedroni test on R 

best regards





From matthieu.stigler at gmail.com  Mon Jan 10 11:18:01 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Mon, 10 Jan 2011 11:18:01 +0100
Subject: [R-SIG-Finance] panel cointegration test
In-Reply-To: <987695.94508.qm@web24001.mail.ird.yahoo.com>
References: <987695.94508.qm@web24001.mail.ird.yahoo.com>
Message-ID: <4D2ADCD9.7030701@gmail.com>

As far as I know, this is not available till now. Have a look however on 
the plm package.

Best

Mat

Le 10. 01. 11 10:04, hela fessi a ?crit :
> hi
> how to perform panel cointegration test especially pedroni test on R
>
> best regards
>
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From fandrieu at mango-solutions.com  Mon Jan 10 16:26:56 2011
From: fandrieu at mango-solutions.com (Frederic Andrieu)
Date: Mon, 10 Jan 2011 15:26:56 -0000
Subject: [R-SIG-Finance] R for Finance Training course London - 23rd to 25th
	February
Message-ID: <3CBFCFB1FEFFA841BA83ADF2F2A9C6FA0103BD99@mango-data1.Mango.local>

Dear all,

 

This is a reminder to notify that Mango Solutions will be running a training course dedicated to the Financial Industry in February in London.

 

Introduction to R for Financial Data Analysis - 23/24/25 February 2011 in London. 

 

The Introduction to R for Finance course provides a practical introduction to the R environment for users in finance related industries allowing them to quickly become proficient and competent in their usage of the R language.

 

Who Should Attend?

 

This course is suitable for beginners and improvers in the R Language working in the finance industry. It is ideal for those wanting an all round introduction to the R language.

 

The cost of the training is ?1,200 for commercial attendees and ?700 for academics. 10% discount will be offered for multiple bookings from the same organisation.

 

For more details please see www.mango-solutions.com/training or contact training at mango-solutions.com 

 

Furthermore, Mango Solutions will also be hosting LondonR on 8th March 2011; LondonR is a free R networking event open to all R enthusiasts and users. Venue: The Shooting Star, 125-129 Middlesex St, London E1, 6-9pm for more info see www.londonr.org or contact londonr at mango-solutions.com

 

Regards,

Frederic Andrieu

  

T: +44 (0)1249 767700
F: +44 (0)1249 767707
M: +44 (0)7813526123
www.mango-solutions.com <http://www.mango-solutions.com> 

 

LEGAL NOTICE
This message is intended for the use of the named recipient(s) only and may contain confidential and / or privileged information. If you are not the intended recipient, please contact the sender and delete this message. Any unauthorised use of the information contained in this message is prohibited.
Mango Business Solutions Limited is registered in England under No. 4560258 with its registered office at Suite 3, Middlesex House, Rutherford Close, Stevenage, Herts, SG1 2EF, UK.

PLEASE CONSIDER THE ENVIRONMENT BEFORE PRINTING THIS EMAIL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110110/20b8fd72/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 4253 bytes
Desc: image001.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110110/20b8fd72/attachment.jpe>

From marco.zanella at inbox.com  Mon Jan 10 23:37:10 2011
From: marco.zanella at inbox.com (Zanella Marco)
Date: Mon, 10 Jan 2011 14:37:10 -0800
Subject: [R-SIG-Finance] Ranks of Spearman's rank correlation coefficient
In-Reply-To: <AANLkTikCZ=tmjGUgpH4ytvUB7qkc+Yjj79RkjBznKhUi@mail.gmail.com>
References: <dd454a7eadc.0000017fmarco.zanella@inbox.com>
Message-ID: <EEAFFA3A14E.000001CCmarco.zanella@inbox.com>

Dear Gabor,
thank you for your suggestion. I've already verified the result via computation of cor() on ranked timeseries with rank(), and as you report the result is the same of cor() with spearman method on simple timeseries.

But, aren't there a way to extract the rank directly form cor() function, that of course computes ranks in order to give the result. I'm tinking in a way like "cor$ranks".

Tanks.

Marco



> -----Original Message-----
> From: ggrothendieck at gmail.com
> Sent: Sun, 9 Jan 2011 15:02:10 -0500
> To: marco.zanella at inbox.com
> Subject: Re: [R-SIG-Finance] Ranks of Spearman's rank correlation
> coefficient
> 
> On Sun, Jan 9, 2011 at 8:22 AM, Zanella Marco <marco.zanella at inbox.com>
> wrote:
>> Dear Sirs,
>> I'm using cor() funcion with Spearman method to analyse correlation of
>> timeseries. As you know Spearman method is based on ranks of timeseries,
>> instead of their value.
>> 
>> Well, what I'm not able to do is to extract the ranks of the timeseries
>> used from cor() to compute the Spearman correlation coefficient (also
>> called rho).
>> 
>> For instance if I have this two timeseries
>>> a = c(-0.10, -0.21, -0.35, -0.38, -0.19)
>>> b = c(-0.53, -0.42, -0.59, -0.55, -0.35)
>> 
>> I obtain rho in this way
>>> cor(a,b, method="spearman")
> >>[1] 0.6
>> 
>> but how can I obtain ranks for the two timeseries? Of course, the same
>> computed and used by previous cor().
>> 
> 
> Try this:
> 
>> cor(rank(a), rank(b))
> [1] 0.6
> 
> 
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com

____________________________________________________________
Send your photos by email in seconds...
TRY FREE IM TOOLPACK at http://www.imtoolpack.com/default.aspx?rc=if3
Works in all emails, instant messengers, blogs, forums and social networks.


From ggrothendieck at gmail.com  Tue Jan 11 00:02:06 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 10 Jan 2011 18:02:06 -0500
Subject: [R-SIG-Finance] Ranks of Spearman's rank correlation coefficient
In-Reply-To: <EEAFFA3A14E.000001CCmarco.zanella@inbox.com>
References: <dd454a7eadc.0000017fmarco.zanella@inbox.com>
	<AANLkTikCZ=tmjGUgpH4ytvUB7qkc+Yjj79RkjBznKhUi@mail.gmail.com>
	<EEAFFA3A14E.000001CCmarco.zanella@inbox.com>
Message-ID: <AANLkTi=gcniaV6SsYa8X-MoH8kwJEfGF=a6V=Z+_NVEY@mail.gmail.com>

On Mon, Jan 10, 2011 at 5:37 PM, Zanella Marco <marco.zanella at inbox.com> wrote:
> Dear Gabor,
> thank you for your suggestion. I've already verified the result via computation of cor() on ranked timeseries with rank(), and as you report the result is the same of cor() with spearman method on simple timeseries.
>
> But, aren't there a way to extract the rank directly form cor() function, that of course computes ranks in order to give the result. I'm tinking in a way like "cor$ranks".
>

You can write your own version of cor.


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ggrothendieck at gmail.com  Tue Jan 11 00:02:06 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 10 Jan 2011 18:02:06 -0500
Subject: [R-SIG-Finance] Ranks of Spearman's rank correlation coefficient
In-Reply-To: <EEAFFA3A14E.000001CCmarco.zanella@inbox.com>
References: <dd454a7eadc.0000017fmarco.zanella@inbox.com>
	<AANLkTikCZ=tmjGUgpH4ytvUB7qkc+Yjj79RkjBznKhUi@mail.gmail.com>
	<EEAFFA3A14E.000001CCmarco.zanella@inbox.com>
Message-ID: <AANLkTi=gcniaV6SsYa8X-MoH8kwJEfGF=a6V=Z+_NVEY@mail.gmail.com>

On Mon, Jan 10, 2011 at 5:37 PM, Zanella Marco <marco.zanella at inbox.com> wrote:
> Dear Gabor,
> thank you for your suggestion. I've already verified the result via computation of cor() on ranked timeseries with rank(), and as you report the result is the same of cor() with spearman method on simple timeseries.
>
> But, aren't there a way to extract the rank directly form cor() function, that of course computes ranks in order to give the result. I'm tinking in a way like "cor$ranks".
>

You can write your own version of cor.


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From markknecht at gmail.com  Tue Jan 11 00:46:04 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Mon, 10 Jan 2011 15:46:04 -0800
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <201101091433.37993.brian@braverock.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
Message-ID: <AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>

On Sun, Jan 9, 2011 at 12:33 PM, Brian G. Peterson <brian at braverock.com> wrote:
> On Sunday, January 09, 2011 02:03:49 pm Edgar Vega wrote:
>> getSymbols("ZC ",src="cmegroup")
>> I am trying to get futures symbols from cme.
>
> I'm not aware of a getSymbols.cmegroup function for source 'cmegroup'.
>
> Did you write one?
>
> ?- Brian

Do any of the current methods support the lookup of futures symbols
like the Emini?

- Mark


From mathprosperity at gmail.com  Tue Jan 11 05:17:33 2011
From: mathprosperity at gmail.com (xiangji ma)
Date: Mon, 10 Jan 2011 20:17:33 -0800
Subject: [R-SIG-Finance] Help:SV-Jump model using R?
Message-ID: <AANLkTi=rYsWWc4vufp2oUsahApQAsjAxV1rd+qPqUDpp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110110/3d5dfd83/attachment.pl>

From stephen at organicfoodmarkets.com.au  Tue Jan 11 06:19:15 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 11 Jan 2011 16:19:15 +1100
Subject: [R-SIG-Finance] quantstrat
Message-ID: <4D2BE853.3020803@organicfoodmarkets.com.au>

Hi

OK, I have found this in the manual:

For the purposes of backtesting, and compatibility with the trade 
accounting in blotter, this function will not allow a transaction to 
cross your current position through zero. The accounting rules for 
realizing gains in such cases are more complicated than we wish to 
support. Also, many brokers will break, revise, or split such 
transactions for the same reason. If you wish to do a "stop and reverse" 
system, first stop (flatten), and then reverse (initiate a new position).

So now I know why I couldn't model short positions.  is this correct? 
Being able to go short is a pretty common sort of action.

I had a look at the bbands demo and it appeared to go long and short and 
specified NULL as the ordertype rather than long or short.  That got rid 
of my warning that I was going short, but it didn't produce any short 
trades.

Any help most welcome.

##########################################################

Original posting:


Hi

I'm trying to money the bbands demo to by it on the S&P/ ASX 200.

  I think the Symbol is ^AXJO and I can get the info I want using it.

  I have amended the code as follows:

# bbands



  require(quantstrat)

  try(rm("order_book.bbands",pos=.strategy),silent=TRUE)

  try(rm("account.bbands","portfolio.bbands",pos=.blotter),silent=TRUE)

 
try(rm("account.st","portfolio.st","stock.str","stratBBands","initDate","initEq",'start_t','end_t'),silent=TRUE)

  # some things to set up here
  stock.str='^AXJO' # what are we trying it on

  # we'll pass these
  SD = 2 # how many standard deviations, traditionally 2

  N = 20 # how many periods for the moving average, traditionally 20

  currency('AUD')

  stock(stock.str,currency='AUD',multiplier=1)

  initDate='2006-12-31'

  initEq=1000000

  portfolio.st='bbands'

  account.st='bbands'

  initPortf(portfolio.st,symbols=stock.str, initDate=initDate)

  initAcct(account.st,portfolios='bbands', initDate=initDate)

  initOrders(portfolio=portfolio.st,initDate=initDate)

  stratBBands <- strategy("bbands")

  #one indicator
  stratBBands <- add.indicator(strategy = stratBBands, name = "BBands", 
arguments = list(HLC = quote(HLC(mktdata)), maType='SMA'))

  #add signals:
  stratBBands <- add.signal(stratBBands,name="sigCrossover",arguments = 
list(columns=c("Close","up"),relationship="gt"),label="Cl.gt.UpperBand")

  stratBBands <- add.signal(stratBBands,name="sigCrossover",arguments = 
list(columns=c("Close","dn"),relationship="lt"),label="Cl.lt.LowerBand")

  stratBBands <- add.signal(stratBBands,name="sigCrossover",arguments = 
list(columns=c("High","Low","mavg"),relationship="op"),label="Cross.Mid")

  # lets add some rules
  stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(sigcol="Cl.gt.UpperBand",sigval=TRUE, orderqty=-100, 
ordertype='market', orderside=NULL, threshold=NULL),type='enter')

  stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(sigcol="Cl.lt.LowerBand",sigval=TRUE, orderqty= 100, 
ordertype='market', orderside=NULL, threshold=NULL),type='enter')

  stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(sigcol="Cross.Mid",sigval=TRUE, orderqty= 'all', 
ordertype='market', orderside=NULL, threshold=NULL),type='exit')

  #alternately, to exit at the opposite band, the rules would be...
  #stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(data=quote(mktdata),sigcol="Lo.gt.UpperBand",sigval=TRUE, orderqty= 
'all', ordertype='market', orderside=NULL, threshold=NULL),type='exit')
  #stratBBands <- add.rule(stratBBands,name='ruleSignal', arguments = 
list(data=quote(mktdata),sigcol="Hi.lt.LowerBand",sigval=TRUE, orderqty= 
'all', ordertype='market', orderside=NULL, threshold=NULL),type='exit')

  #TODO add thresholds and stop-entry and stop-exit handling to test

  getSymbols(stock.str,from=initDate)

  start_t<-Sys.time()

  out<-try(applyStrategy(strategy=stratBBands , 
portfolios='bbands',mktdata='AXJO', 
parameters=list(sd=SD,n=N),verbose=TRUE) )


  # look at the order book
  #getOrderBook('bbands')
  end_t<-Sys.time()

  print("strat execution time:")

  print(end_t-start_t)
Time difference of 32.271 secs

  start_t<-Sys.time()

 
updatePortf(Portfolio='bbands',Dates=paste('::',as.Date(Sys.time()),sep=''))

  end_t<-Sys.time()

  print("updatePortf execution time:")

  print(end_t-start_t)

  chart.Posn(Portfolio='bbands',Symbol=stock.str)

  plot(add_BBands(on=1,sd=SD,n=N))

 
###############################################################################
  # R (http://r-project.org/) Quantitative Strategy Model Framework
  #
  # Copyright (c) 2009-2010
  # Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and 
Joshua Ulrich
  #
  # This library is distributed under the terms of the GNU Public 
License (GPL)
  # for full details see the file COPYING
  #
  # $Id: bbands.R 374 2010-08-17 18:43:35Z braverock $
  #
 
###############################################################################


I get my prices with thus


>  getSymbols(stock.str,from=initDate)
[1] "AXJO"


but note the hat has been dropped!

and just afterwards I get thIs:

rategy=stratBBands , portfolios='bbands', 
parameters=list(sd=SD,n=N),verbose=TRUE) )
Error in get(symbol) : object '^AXJO' not found

I've looked at the notes for applyStrategy and I've tried specifically 
referring to AXJO like this:
>
>  out<-try(applyStrategy(strategy=stratBBands ,
portfolios='bbands',mktdata='AXJO', 
parameters=list(sd=SD,n=N),verbose=TRUE) )
Error in get(symbol) : object '^AXJO' not found

but I still get the message.

Can anyone advise me how to resolve this?

-- 
Stephen Choularton Ph.D., FIoD


From breman.mark at gmail.com  Tue Jan 11 07:49:55 2011
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 11 Jan 2011 07:49:55 +0100
Subject: [R-SIG-Finance] Help:SV-Jump model using R?
In-Reply-To: <AANLkTi=rYsWWc4vufp2oUsahApQAsjAxV1rd+qPqUDpp@mail.gmail.com>
References: <AANLkTi=rYsWWc4vufp2oUsahApQAsjAxV1rd+qPqUDpp@mail.gmail.com>
Message-ID: <AANLkTin37wZy03gOr5XMUAxp1T3CjNJAhKh7O+ZptU-i@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/b4a1ae58/attachment.pl>

From breman.mark at gmail.com  Tue Jan 11 07:39:28 2011
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 11 Jan 2011 07:39:28 +0100
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
Message-ID: <AANLkTiku6g64Z-kBcJV73pMV7rjJVgERwUNS4S1W9Fjo@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/cc77c845/attachment.pl>

From breman.mark at gmail.com  Tue Jan 11 07:39:28 2011
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 11 Jan 2011 07:39:28 +0100
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
Message-ID: <AANLkTiku6g64Z-kBcJV73pMV7rjJVgERwUNS4S1W9Fjo@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/cc77c845/attachment-0001.pl>

From brian at braverock.com  Tue Jan 11 13:40:05 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 11 Jan 2011 06:40:05 -0600
Subject: [R-SIG-Finance] quantstrat
In-Reply-To: <4D2BE853.3020803@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
Message-ID: <4D2C4FA5.2020304@braverock.com>

On 01/10/2011 11:19 PM, Stephen Choularton wrote:
> OK, I have found this in the manual:

Thanks for reading the manual.

> 'For the purposes of backtesting, and compatibility with the trade
> accounting in blotter, this function will not allow a transaction to
> cross your current position through zero. The accounting rules for
> realizing gains in such cases are more complicated than we wish to
> support. Also, many brokers will break, revise, or split such
> transactions for the same reason. If you wish to do a "stop and reverse"
> system, first stop (flatten), and then reverse (initiate a new position).'
>
> So now I know why I couldn't model short positions.  is this correct?
> Being able to go short is a pretty common sort of action.

Yes, being able to go short is a pretty 'common sort of action'.  I do 
it every day across multiple instrument classes, currencies, and 
millions of dollars of net portfolio position (after converting back to 
USD).

Note that the bbands demo *as written* initiates short positions without 
any problem.  See attached pdf. That would likely suggest to anyone 
writing code that modified the working demo that the problem was likely 
in their code, not the package...

Do you not understand the documentation?

First flatten your position (get to zero) then initiate a short 
position.  stop. then reverse.

So, in the bbands demo, you would set up:

- a long entry entry at the lower band
- a long exit at the mid or upper band
- a short entry at the upper band
- a short exit at the mid or the lower band

The demo does that with three rules and using the orderside=NULL 
convenience, but I could easily have left only the mid-cross rule as 
orderside NULL and the other appropriate rules as 'long' and 'short'.

In a non-toy strategy, you'd probably also want to do something like 
addPosLimit to set how many signals you'll respond to.  Try one long and 
one short to start.

> I had a look at the bbands demo and it appeared to go long and short and
> specified NULL as the ordertype rather than long or short.  That got rid
> of my warning that I was going short, but it didn't produce any short
> trades.
>
> Any help most welcome.

See above.

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bbands.pdf
Type: application/pdf
Size: 213670 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/82621f61/attachment.pdf>

From rajesh.kona at gmail.com  Tue Jan 11 13:42:21 2011
From: rajesh.kona at gmail.com (rajesh kona)
Date: Tue, 11 Jan 2011 18:12:21 +0530
Subject: [R-SIG-Finance] Analyzing data using quantmod:
Message-ID: <AANLkTikuLMF4s5kiHZxCuRGpuHr63TGmDnsdDejv-KNC@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/4179d979/attachment.pl>

From brian at braverock.com  Tue Jan 11 13:53:42 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 11 Jan 2011 06:53:42 -0600
Subject: [R-SIG-Finance] quantstrat
In-Reply-To: <4D2BE853.3020803@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
Message-ID: <4D2C52D6.4060301@braverock.com>

On 01/10/2011 11:19 PM, Stephen Choularton wrote:
> I had a look at the bbands demo and it appeared to go long and short and
> specified NULL as the ordertype rather than long or short.  That got rid
> of my warning that I was going short, but it didn't produce any short
> trades.

I've modified your broken code.  Updated R code and PDF attached.  It 
goes short, as expected.  The P&L is awful, also as expected.

Please take more time to debug your code in the future.

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SC.bbands.pdf
Type: application/pdf
Size: 217686 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/f379952d/attachment.pdf>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: SC.bbands.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/f379952d/attachment.pl>

From brian at braverock.com  Tue Jan 11 14:01:34 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 11 Jan 2011 07:01:34 -0600
Subject: [R-SIG-Finance] Analyzing data using quantmod:
In-Reply-To: <AANLkTikuLMF4s5kiHZxCuRGpuHr63TGmDnsdDejv-KNC@mail.gmail.com>
References: <AANLkTikuLMF4s5kiHZxCuRGpuHr63TGmDnsdDejv-KNC@mail.gmail.com>
Message-ID: <4D2C54AE.8030201@braverock.com>

On 01/11/2011 06:42 AM, rajesh kona wrote:
> I have recently started using R and i am interested in back-testing historic
> data related to Indian commodity market. I am using quantmod for the
> analysis. Can any body explain me how to use buildModel and how to train it
> for forecasting.

There are many posts on the quantmod website, in the quantmod 
documentation, and in the list archives for this list about using 
buildModel.  After you've reviewed these, perhaps you would be so kind 
as to follow the admonition in the posting guide and prepare a 
reproducible example that demonstrates what you are trying to do.

Assuming that you are trying to use a formula-class linear regression 
model (or similar), buildModel is quite elegant.  If you're trying to do 
something more complex, you'll need a different tool (but quantmod 
remains invaluable for many other time series manipulation and charting 
tasks).

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From paulteetor at yahoo.com  Tue Jan 11 14:13:01 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Tue, 11 Jan 2011 05:13:01 -0800 (PST)
Subject: [R-SIG-Finance] Help:SV-Jump model using R?
In-Reply-To: <AANLkTi=rYsWWc4vufp2oUsahApQAsjAxV1rd+qPqUDpp@mail.gmail.com>
References: <AANLkTi=rYsWWc4vufp2oUsahApQAsjAxV1rd+qPqUDpp@mail.gmail.com>
Message-ID: <833382.32596.qm@web56003.mail.re3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/c206f88a/attachment.pl>

From brian at braverock.com  Tue Jan 11 14:17:37 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 11 Jan 2011 07:17:37 -0600
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
Message-ID: <4D2C5871.9070202@braverock.com>

On 01/10/2011 05:46 PM, Mark Knecht wrote:
> On Sun, Jan 9, 2011 at 12:33 PM, Brian G. Peterson<brian at braverock.com>  wrote:
>> On Sunday, January 09, 2011 02:03:49 pm Edgar Vega wrote:
>>> getSymbols("ZC ",src="cmegroup")
>>> I am trying to get futures symbols from cme.
>>
>> I'm not aware of a getSymbols.cmegroup function for source 'cmegroup'.
>>
>> Did you write one?
>>
>>   - Brian
>
> Do any of the current methods support the lookup of futures symbols
> like the Emini?

The CME Group, like most exchanges, charges for their data.

http://www.cmegroup.com/market-data/datamine-historical-data/

We get historical futures data from Reuters or CQG, but many other 
sources are available.  As Mark Breman has pointed out, none of them, to 
the best of my knowledge, are free.  The exception may be your broker. 
Brokers that cater to individual traders will often provide some 
historical data.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From markknecht at gmail.com  Tue Jan 11 15:30:51 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Tue, 11 Jan 2011 06:30:51 -0800
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <4D2C5871.9070202@braverock.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
	<4D2C5871.9070202@braverock.com>
Message-ID: <AANLkTim-oX3YgpVa-jVPs8+A4GBVUbAyjacWtc3LR960@mail.gmail.com>

On Tue, Jan 11, 2011 at 5:17 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 01/10/2011 05:46 PM, Mark Knecht wrote:
>>
>> On Sun, Jan 9, 2011 at 12:33 PM, Brian G. Peterson<brian at braverock.com>
>> ?wrote:
>>>
>>> On Sunday, January 09, 2011 02:03:49 pm Edgar Vega wrote:
>>>>
>>>> getSymbols("ZC ",src="cmegroup")
>>>> I am trying to get futures symbols from cme.
>>>
>>> I'm not aware of a getSymbols.cmegroup function for source 'cmegroup'.
>>>
>>> Did you write one?
>>>
>>> ?- Brian
>>
>> Do any of the current methods support the lookup of futures symbols
>> like the Emini?
>
> The CME Group, like most exchanges, charges for their data.
>
> http://www.cmegroup.com/market-data/datamine-historical-data/
>
> We get historical futures data from Reuters or CQG, but many other sources
> are available. ?As Mark Breman has pointed out, none of them, to the best of
> my knowledge, are free. ?The exception may be your broker. Brokers that
> cater to individual traders will often provide some historical data.
>
> Regards,
>
> ?- Brian

Thanks for the info Brian. I have access to historical and real-time
futures data through TradeStation. It's just a little more work to get
it into R. (export/import)  I just wanted to make sure I wasn't
missing something free and easier to do.

Cheers,
Mark


From shane.conway at gmail.com  Tue Jan 11 16:13:17 2011
From: shane.conway at gmail.com (Shane Conway)
Date: Tue, 11 Jan 2011 10:13:17 -0500
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTim-oX3YgpVa-jVPs8+A4GBVUbAyjacWtc3LR960@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
	<4D2C5871.9070202@braverock.com>
	<AANLkTim-oX3YgpVa-jVPs8+A4GBVUbAyjacWtc3LR960@mail.gmail.com>
Message-ID: <AANLkTimswfjDRTHxzghbnUB-a67=5VqCthOMybKL+gB4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/e9367fc7/attachment.pl>

From jeffrey.ryan at lemnica.com  Tue Jan 11 16:30:50 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 11 Jan 2011 09:30:50 -0600
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTimswfjDRTHxzghbnUB-a67=5VqCthOMybKL+gB4@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
	<4D2C5871.9070202@braverock.com>
	<AANLkTim-oX3YgpVa-jVPs8+A4GBVUbAyjacWtc3LR960@mail.gmail.com>
	<AANLkTimswfjDRTHxzghbnUB-a67=5VqCthOMybKL+gB4@mail.gmail.com>
Message-ID: <AANLkTinTX+=QGmGjT_OyEeb4QsOe=8nAjzTxXnHZBhUS@mail.gmail.com>

getSymbols needs a backend for the data you are getting, the ones
shipped in quantmod are just examples of what you can do (though
useful in their own right)

Futures data, as well as other EOD style data, can also be had from
CSI: http://www.csidata.com/ or EODdata: http://www.eoddata.com/

They seem reasonably clean and very reasonably priced.  Both are
simple .csv files, and I think both have APIs available depending on
your subscription. I've subscribed to the latter, not the former.

CSI even has a package on R-forge that could be of use, though haven't
used myself.

https://r-forge.r-project.org/projects/rcsi/

HTH
Jeff

On Tue, Jan 11, 2011 at 9:13 AM, Shane Conway <shane.conway at gmail.com> wrote:
> Just to note:
>
> The schwartz97 package, for the Schwartz 1997 two-factor commodity model,
> contains some commodities futures data for those wanting to use it:
> http://cran.r-project.org/web/packages/schwartz97/. ?It also includes
> vingettes that are worth reading.
>
>> library(schwartz97)
> Loading required package: FKF
> Loading required package: mvtnorm
>> data(futures)
>> names(futures)
> ?[1] "corn" ? ? ? ? "wheat" ? ? ? ?"soybean" ? ? ?"soybean.meal"
> "soybean.oil" ?"lumber" ? ? ? "live.cattle" ?"coffee" ? ? ? "heating.oil"
> ?"copper"
>> futuresplot(futures$lumber, type = "forward.curve")
>
>
> On Tue, Jan 11, 2011 at 9:30 AM, Mark Knecht <markknecht at gmail.com> wrote:
>
>> On Tue, Jan 11, 2011 at 5:17 AM, Brian G. Peterson <brian at braverock.com>
>> wrote:
>> > On 01/10/2011 05:46 PM, Mark Knecht wrote:
>> >>
>> >> On Sun, Jan 9, 2011 at 12:33 PM, Brian G. Peterson<brian at braverock.com>
>> >> ?wrote:
>> >>>
>> >>> On Sunday, January 09, 2011 02:03:49 pm Edgar Vega wrote:
>> >>>>
>> >>>> getSymbols("ZC ",src="cmegroup")
>> >>>> I am trying to get futures symbols from cme.
>> >>>
>> >>> I'm not aware of a getSymbols.cmegroup function for source 'cmegroup'.
>> >>>
>> >>> Did you write one?
>> >>>
>> >>> ?- Brian
>> >>
>> >> Do any of the current methods support the lookup of futures symbols
>> >> like the Emini?
>> >
>> > The CME Group, like most exchanges, charges for their data.
>> >
>> > http://www.cmegroup.com/market-data/datamine-historical-data/
>> >
>> > We get historical futures data from Reuters or CQG, but many other
>> sources
>> > are available. ?As Mark Breman has pointed out, none of them, to the best
>> of
>> > my knowledge, are free. ?The exception may be your broker. Brokers that
>> > cater to individual traders will often provide some historical data.
>> >
>> > Regards,
>> >
>> > ?- Brian
>>
>> Thanks for the info Brian. I have access to historical and real-time
>> futures data through TradeStation. It's just a little more work to get
>> it into R. (export/import) ?I just wanted to make sure I wasn't
>> missing something free and easier to do.
>>
>> Cheers,
>> Mark
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From jeff.a.ryan at gmail.com  Tue Jan 11 16:32:01 2011
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 11 Jan 2011 09:32:01 -0600
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTimswfjDRTHxzghbnUB-a67=5VqCthOMybKL+gB4@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
	<4D2C5871.9070202@braverock.com>
	<AANLkTim-oX3YgpVa-jVPs8+A4GBVUbAyjacWtc3LR960@mail.gmail.com>
	<AANLkTimswfjDRTHxzghbnUB-a67=5VqCthOMybKL+gB4@mail.gmail.com>
Message-ID: <AANLkTi=p6iUDvEH0+Jxpahdny9f1K1EA0X=81P0M6sM4@mail.gmail.com>

getSymbols needs a backend for the data you are getting, the ones
shipped in quantmod are just examples of what you can do (though
useful in their own right)

Futures data, as well as other EOD style data, can also be had from
CSI: http://www.csidata.com/ or EODdata: http://www.eoddata.com/

They seem reasonably clean and very reasonably priced.  Both are
simple .csv files, and I think both have APIs available depending on
your subscription. I've subscribed to the latter, not the former.

CSI even has a package on R-forge that could be of use, though haven't
used myself.

https://r-forge.r-project.org/projects/rcsi/

HTH
Jeff

-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com

modity model,
> contains some commodities futures data for those wanting to use it:
> http://cran.r-project.org/web/packages/schwartz97/. ?It also includes
> vingettes that are worth reading.
>
>> library(schwartz97)
> Loading required package: FKF
> Loading required package: mvtnorm
>> data(futures)
>> names(futures)
> ?[1] "corn" ? ? ? ? "wheat" ? ? ? ?"soybean" ? ? ?"soybean.meal"
> "soybean.oil" ?"lumber" ? ? ? "live.cattle" ?"coffee" ? ? ? "heating.oil"
> ?"copper"
>> futuresplot(futures$lumber, type = "forward.curve")
>
>
> On Tue, Jan 11, 2011 at 9:30 AM, Mark Knecht <markknecht at gmail.com> wrote:
>
>> On Tue, Jan 11, 2011 at 5:17 AM, Brian G. Peterson <brian at braverock.com>
>> wrote:
>> > On 01/10/2011 05:46 PM, Mark Knecht wrote:
>> >>
>> >> On Sun, Jan 9, 2011 at 12:33 PM, Brian G. Peterson<brian at braverock.com>
>> >> ?wrote:
>> >>>
>> >>> On Sunday, January 09, 2011 02:03:49 pm Edgar Vega wrote:
>> >>>>
>> >>>> getSymbols("ZC ",src="cmegroup")
>> >>>> I am trying to get futures symbols from cme.
>> >>>
>> >>> I'm not aware of a getSymbols.cmegroup function for source 'cmegroup'.
>> >>>
>> >>> Did you write one?
>> >>>
>> >>> ?- Brian
>> >>
>> >> Do any of the current methods support the lookup of futures symbols
>> >> like the Emini?
>> >
>> > The CME Group, like most exchanges, charges for their data.
>> >
>> > http://www.cmegroup.com/market-data/datamine-historical-data/
>> >
>> > We get historical futures data from Reuters or CQG, but many other
>> sources
>> > are available. ?As Mark Breman has pointed out, none of them, to the best
>> of
>> > my knowledge, are free. ?The exception may be your broker. Brokers that
>> > cater to individual traders will often provide some historical data.
>> >
>> > Regards,
>> >
>> > ?- Brian
>>
>> Thanks for the info Brian. I have access to historical and real-time
>> futures data through TradeStation. It's just a little more work to get
>> it into R. (export/import) ?I just wanted to make sure I wasn't
>> missing something free and easier to do.
>>
>> Cheers,
>> Mark
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From j_cuisinier at hotmail.com  Tue Jan 11 16:53:21 2011
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Tue, 11 Jan 2011 16:53:21 +0100
Subject: [R-SIG-Finance] R & Factset
Message-ID: <COL102-W569EED9AE62D35DBDA93EA8F0F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110111/e3e41810/attachment.pl>

From adam at mycostech.com  Thu Jan 13 04:49:11 2011
From: adam at mycostech.com (BSanders)
Date: Wed, 12 Jan 2011 19:49:11 -0800 (PST)
Subject: [R-SIG-Finance] Time series indexing,
 how can I index a series that's not a constant increase?
Message-ID: <1294890551697-3215199.post@n4.nabble.com>



I have missing data in my time series, but I have the appropriate date.  How
do I pass on the time index to R? 

For example, my days look like this 
"291 292 293 295 296 297"    (I'm missing 294)


Sorry if this is a newb question.

-- 
View this message in context: http://r.789695.n4.nabble.com/Time-series-indexing-how-can-I-index-a-series-that-s-not-a-constant-increase-tp3215199p3215199.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From ggrothendieck at gmail.com  Thu Jan 13 06:53:23 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 13 Jan 2011 00:53:23 -0500
Subject: [R-SIG-Finance] Time series indexing,
 how can I index a series that's not a constant increase?
In-Reply-To: <1294890551697-3215199.post@n4.nabble.com>
References: <1294890551697-3215199.post@n4.nabble.com>
Message-ID: <AANLkTikFnDPCksi7_tDZih5shLWwPUkKJbf2cGEVbFLu@mail.gmail.com>

On Wed, Jan 12, 2011 at 10:49 PM, BSanders <adam at mycostech.com> wrote:
>
>
> I have missing data in my time series, but I have the appropriate date. ?How
> do I pass on the time index to R?
>
> For example, my days look like this
> "291 292 293 295 296 297" ? ?(I'm missing 294)

Try this:

> library(zoo)
> v <- c(291, 292, 293, 295, 296, 297)
> z <- as.zoo(as.ts(zoo(v, v)))
> z
291 292 293 294 295 296 297
291 292 293  NA 295 296 297
>
>
> time(z)
[1] 291 292 293 294 295 296 297
> coredata(z)
[1] 291 292 293  NA 295 296 297


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ustaudinger at gmail.com  Thu Jan 13 07:12:01 2011
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Thu, 13 Jan 2011 07:12:01 +0100
Subject: [R-SIG-Finance] Time series indexing,
 how can I index a series that's not a constant increase?
In-Reply-To: <AANLkTikFnDPCksi7_tDZih5shLWwPUkKJbf2cGEVbFLu@mail.gmail.com>
References: <1294890551697-3215199.post@n4.nabble.com>
	<AANLkTikFnDPCksi7_tDZih5shLWwPUkKJbf2cGEVbFLu@mail.gmail.com>
Message-ID: <AANLkTinPEV=8nbnN+MXyAccwt1jmmU0rZrz7c76MPoUj@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110113/c75f27b9/attachment.pl>

From eric.thungstrom at gmail.com  Fri Jan 14 03:13:31 2011
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Thu, 13 Jan 2011 21:13:31 -0500
Subject: [R-SIG-Finance] quantmod for futures
In-Reply-To: <AANLkTi=p6iUDvEH0+Jxpahdny9f1K1EA0X=81P0M6sM4@mail.gmail.com>
References: <AANLkTimaO_=29KZ55rqnYrbtGvA9Kbr9tMvn4sufpx=U@mail.gmail.com>
	<201101091433.37993.brian@braverock.com>
	<AANLkTi=U4RcnTmnz3iV0Re6NuVuKy5Lmuc3a1Lgsy3qF@mail.gmail.com>
	<4D2C5871.9070202@braverock.com>
	<AANLkTim-oX3YgpVa-jVPs8+A4GBVUbAyjacWtc3LR960@mail.gmail.com>
	<AANLkTimswfjDRTHxzghbnUB-a67=5VqCthOMybKL+gB4@mail.gmail.com>
	<AANLkTi=p6iUDvEH0+Jxpahdny9f1K1EA0X=81P0M6sM4@mail.gmail.com>
Message-ID: <AANLkTinJQrfZqu5XnKjnz+4kizdheLUpgTfY1EehJW3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110113/cd0f8aea/attachment.pl>

From dengyishuo at 163.com  Sun Jan 16 02:53:00 2011
From: dengyishuo at 163.com (deng yishuo)
Date: Sun, 16 Jan 2011 01:53:00 +0000 (UTC)
Subject: [R-SIG-Finance] deng yishuo wants to stay in touch on LinkedIn
Message-ID: <1430650775.17111334.1295142780003.JavaMail.app@ela4-bed34.prod>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110116/5eab3fd6/attachment.pl>

From adam at mycostech.com  Mon Jan 17 05:42:14 2011
From: adam at mycostech.com (BSanders)
Date: Sun, 16 Jan 2011 20:42:14 -0800 (PST)
Subject: [R-SIG-Finance] I want to find the best arima model using AIC
 criterion, but having problems
Message-ID: <1295239334494-3220695.post@n4.nabble.com>


I'm running a loop for trying to find the best ARIMA seasonal model.  I'm
experimenting with different orders of AR, MA and differencing.., but when I
run my loops, I'm getting an error such as
"Error in optim(init[mask], armafn, method = optim.method, hessian = TRUE, 
: 
  non-finite finite-difference value [3]
"
and R exits the loop, however, it isn't finished.  Is there a way to make R
continuing what it should?

My code looks like this below :

count = 0
for(i in 0:7){
for(j in 0:2) {
for(k in 0:1)  {
for(l in 0:1)   {
for(m in 0:2)    {
for(n in 0:1)  {
for(o in 1:2)   {
model = arima(y, order=c(i,j,k), seasonal=list(order=c(l,m,n), period=7*o))
if (count == 0){
     aicmin = model$aic
     bestmodel = model
     }
if ((count != 0)&& (model$aic < aicmin)){
     aicmin = model$aic
     bestmodel = model
     diff1 = j
     diff2 = m
     seas = o*7
     }

count = count+1
}
}
}
}
}
}
}
print(bestmodel)
print(count)
print(diff1)
print(diff2)
print(seas)

-- 
View this message in context: http://r.789695.n4.nabble.com/I-want-to-find-the-best-arima-model-using-AIC-criterion-but-having-problems-tp3220695p3220695.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From paulteetor at yahoo.com  Mon Jan 17 13:26:11 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Mon, 17 Jan 2011 04:26:11 -0800 (PST)
Subject: [R-SIG-Finance] I want to find the best arima model using AIC
	criterion, but having problems
In-Reply-To: <1295239334494-3220695.post@n4.nabble.com>
References: <1295239334494-3220695.post@n4.nabble.com>
Message-ID: <619266.71171.qm@web56006.mail.re3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110117/4cd15548/attachment.pl>

From matthieu.stigler at gmail.com  Mon Jan 17 14:40:58 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Mon, 17 Jan 2011 14:40:58 +0100
Subject: [R-SIG-Finance] I want to find the best arima model using AIC
 criterion, but having problems
In-Reply-To: <619266.71171.qm@web56006.mail.re3.yahoo.com>
References: <1295239334494-3220695.post@n4.nabble.com>
	<619266.71171.qm@web56006.mail.re3.yahoo.com>
Message-ID: <4D3446EA.3090007@gmail.com>

HI think too for this purpose auto.arima model might be good.

Concerning your loop, the problem is not in your loop I believe, but 
simply that numerical procedure in arima() does not converge (i have 
seen this problem quite often). You might try using rather method=CSS 
(the usual least square).

Le 17. 01. 11 13:26, Paul Teetor a ?crit :
> Have you considered using the auto.arima function in the 'forecast' package? It
> searches for the best ARIMA model using the AIC, AICc, or BIC criteria. It might
> save you a lot of aggravation.
>
>   Paul Teetor, Elgin, IL  USA
> http://quanttrader.info/public
>
>
>
>
> ________________________________
> From: BSanders<adam at mycostech.com>
> To: r-sig-finance at stat.math.ethz.ch
> Sent: Sun, January 16, 2011 10:42:14 PM
> Subject: [R-SIG-Finance] I want to find the best arima model using AIC
> criterion, but having problems
>
>
> I'm running a loop for trying to find the best ARIMA seasonal model.  I'm
> experimenting with different orders of AR, MA and differencing.., but when I
> run my loops, I'm getting an error such as
> "Error in optim(init[mask], armafn, method = optim.method, hessian = TRUE,
> :
>    non-finite finite-difference value [3]
> "
> and R exits the loop, however, it isn't finished.  Is there a way to make R
> continuing what it should?
>
> My code looks like this below :
>
> count = 0
> for(i in 0:7){
> for(j in 0:2) {
> for(k in 0:1)  {
> for(l in 0:1)   {
> for(m in 0:2)    {
> for(n in 0:1)  {
> for(o in 1:2)   {
> model = arima(y, order=c(i,j,k), seasonal=list(order=c(l,m,n), period=7*o))
> if (count == 0){
>       aicmin = model$aic
>       bestmodel = model
>       }
> if ((count != 0)&&  (model$aic<  aicmin)){
>       aicmin = model$aic
>       bestmodel = model
>       diff1 = j
>       diff2 = m
>       seas = o*7
>       }
>
> count = count+1
> }
> }
> }
> }
> }
> }
> }
> print(bestmodel)
> print(count)
> print(diff1)
> print(diff2)
> print(seas)
>


From eric.thungstrom at gmail.com  Tue Jan 18 04:55:02 2011
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Mon, 17 Jan 2011 22:55:02 -0500
Subject: [R-SIG-Finance] Adjusting for dividends
Message-ID: <AANLkTinb-Z0ggg7bZNfQdhPzhdJB95XLRQ0hiAsRvbiQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110117/305cb8bd/attachment.pl>

From cidiel at yahoo.com  Tue Jan 18 05:09:20 2011
From: cidiel at yahoo.com (Brian Leidich)
Date: Mon, 17 Jan 2011 20:09:20 -0800 (PST)
Subject: [R-SIG-Finance] Adjusting for dividends
In-Reply-To: <AANLkTinb-Z0ggg7bZNfQdhPzhdJB95XLRQ0hiAsRvbiQ@mail.gmail.com>
References: <AANLkTinb-Z0ggg7bZNfQdhPzhdJB95XLRQ0hiAsRvbiQ@mail.gmail.com>
Message-ID: <846860.66594.qm@web162007.mail.bf1.yahoo.com>

not knowing which fund it is, (somewhat irrelevant) but impact should be made on 
ex-div date at open... i think i would just take div. schedule and match that 
days open price and subtract accordingly to open price at that date and then use 
relative changes via diff function to calc the balance data? 

just a guess but my hunch is that whatever patch you put in place will be temp, 
data will likely be fixed soon enough. i guess a nice idea would be the ability 
to append custom dividends ourselves...  


----- Original Message ----
From: Eric Thungstom <eric.thungstrom at gmail.com>
To: r-sig-finance at r-project.org
Sent: Mon, January 17, 2011 10:55:02 PM
Subject: [R-SIG-Finance] Adjusting for dividends

I'm working with some mutual fund data and want to adjust for 2010
distributions. There were two payouts for this fund in Dec 2010. Looks like
Yahoo has not picked them up yet. I tried getDividends in quantmod.  All
historical dividends came through except the Dec 2010. I can go to the
actual fund website and find out the distribution amounts. Wondering if I
have the 2010 distribution amount how I might do the adjustment. I've used
adjustOHLC in quantmod be sure but only with the assumption that all
dividends were coming through. So I'm not sure how to handle these last two
payouts.

(getDividends("fund") )

2004-12-21 0.587
2005-08-09 0.012
2005-12-09 0.695
2006-09-29 0.000
2006-12-14 0.415
2007-12-19 0.698
2008-12-17 0.541
2009-12-16 0.267

Nothing coming through for 2010.

First ex-dividend date was 2010-12-16 for $ 2.00347 per share with NAV of
$34.04.
Second ex-dividend date was 2010-12-31 for $.07529 per share with NAV of
$35.58

Thanks in advance for any advice.

    [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should 
go.


From lui.r.project at googlemail.com  Tue Jan 18 06:31:30 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Tue, 18 Jan 2011 00:31:30 -0500
Subject: [R-SIG-Finance] fPortfolio library - Risk and Return not annualized?
Message-ID: <AANLkTime8CnLcrZeNwo=J-hubaf+OSRac=26Cuatv4d0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110118/3f431d32/attachment.pl>

From adam at mycostech.com  Tue Jan 18 08:49:14 2011
From: adam at mycostech.com (BSanders)
Date: Mon, 17 Jan 2011 23:49:14 -0800 (PST)
Subject: [R-SIG-Finance] I want to find the best arima model using AIC
 criterion, but having problems
In-Reply-To: <619266.71171.qm@web56006.mail.re3.yahoo.com>
References: <1295239334494-3220695.post@n4.nabble.com>
	<619266.71171.qm@web56006.mail.re3.yahoo.com>
Message-ID: <1295336954303-3221289.post@n4.nabble.com>



I hadn't used the auto.arima. Thanks for showing me that.  I'm having
troubles with including an xreg variable, and when it does accept the xreg
variable, it won't accept the newxreg for predictions.  

auto.arima isnt' really tailored for handling seasonal models.  I have to
save my data as a time series with frequency 7, but then when I do this, I
can't include xreg, I get the following error : 

Error in attr(x, "tsp") <- value : 
  invalid time series parameters specified



In some ways, I like my own code better if it would just keep plugging
along...


-- 
View this message in context: http://r.789695.n4.nabble.com/I-want-to-find-the-best-arima-model-using-AIC-criterion-but-having-problems-tp3220695p3221289.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jjnavarroabellan at gmail.com  Tue Jan 18 12:55:55 2011
From: jjnavarroabellan at gmail.com (Javier Navarro)
Date: Tue, 18 Jan 2011 03:55:55 -0800 (PST)
Subject: [R-SIG-Finance] Update on Limit Orderbook Package
In-Reply-To: <4C46A37A.9010600@gmail.com>
References: <4C2E4351.3030307@williams.edu> <4C46A37A.9010600@gmail.com>
Message-ID: <1295351755914-3221316.post@n4.nabble.com>


Hi,

I find the package very useful for simulating user trades (add.order
function) but I don't know if it allows to analyse these trades (execution
price, execution time, execution volume ...). I've tried it with
view.trade(ob, tradenum = ) and attr(ob,"trade.data") but I only get the
original trades, those in the data file. I think it's a key feature to add
if it hasn't been done yet.

thanks
-- 
View this message in context: http://r.789695.n4.nabble.com/Update-on-Limit-Orderbook-Package-tp2276856p3221316.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Tue Jan 18 13:44:43 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 18 Jan 2011 06:44:43 -0600
Subject: [R-SIG-Finance] Adjusting for dividends
In-Reply-To: <846860.66594.qm@web162007.mail.bf1.yahoo.com>
References: <AANLkTinb-Z0ggg7bZNfQdhPzhdJB95XLRQ0hiAsRvbiQ@mail.gmail.com>
	<846860.66594.qm@web162007.mail.bf1.yahoo.com>
Message-ID: <4D358B3B.8030907@braverock.com>

Your comments on manually adjusting for dividends are correct, and I 
haven't copied them here.

On 01/17/2011 10:09 PM, Brian Leidich wrote:
> just a guess but my hunch is that whatever patch you put in place will be temp,
> data will likely be fixed soon enough. i guess a nice idea would be the ability
> to append custom dividends ourselves...

It is unlikely that such a patch will be added.  getSymbols and 
get.hist.quote are 'easy' utility functions, but are really only 
indicative of how to build data retrieval mechanisms for other data 
sources (brokers, exchanges, fund managers, etc). Professional investors 
pay for their data, or get it from their counter-parties, and have a 
support line to call when things like dividend payments don't show up.

Also, using adjusted series rarely makes sense in any realistic context. 
  If you're doing portfolio optimization, you need to do it on a 
'walk-forward' basis, looking at prices as they existed at the time. 
Dividend distributions are just cash flows that are added later, and do 
not affect the prices.  They can obviously be added to return 
information separately, but historical *fund* returns, as per the 
original post, typically include *returns* from dividends anyway.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From sunduck at gmail.com  Tue Jan 18 16:15:43 2011
From: sunduck at gmail.com (Alex Bird)
Date: Tue, 18 Jan 2011 18:15:43 +0300
Subject: [R-SIG-Finance] Parameters for equally weighted sums of bivariate
	normals via MCMC
Message-ID: <AANLkTinrsRyYKkDj3SkTHdM=boJ1hEvcgg+60joqvTqp@mail.gmail.com>

Hello there,

  sorry in advance if this mailing list is not appropriate for my question.
  I want to estimate parameters for the following model
	Y[t] = 1/2 * X1[t] + 1/2 * X2[t] + e[t]
	e[t] ~ NORMAL(0,0.0001)
	(X1[t],X2[t]) ~ MULTIVARIATE_NORMAL(mu,varcov)
	mu = c(mu1,mu2)
	varcov = matrix(c(vol1,rho,rho,vol2),ncol=2)

  where the vector of unknown parameters is c(mu1,mu2,rho,vol1,vol2)
and the data is given by Y[] and latent X1[],X2[].

  What I tried to do:
  1. simulated 1000 (X1[t],X2[t]) with known parameters from the
multivarite normal (as in the R code below).
  2. got equally weighted sums of (X1[t],X2[t]) to calculate Y[t]
without adding any extra noise
  3. tried to estimate two models:
		- first model is where I tried to estimate paramaters just for the
initial (latent) (X1[t],X2[t]) vector
		- second model is where I tried to estimate the same vector of
parameters via Y[t] having actual (X1[t],X2[t]) vector as an inital
guess for the latents
		
  I estimated the first model via MLE and MCMC (2000 iterations and
1000 burnin) and the parameters estimated are very similar.
  But I was not able to fit the second model even by using 100000 iterations.
  The following table shows actual and estimated parameters
                    mu[1]         mu[2]       rho       vol1       vol2
Actual       0.0005000000  0.0002000000 0.5600000 0.01400000 0.01300000
MLE          0.0001276392  0.0001626320 0.5973657 0.01395924 0.01315293
Model#1 MCMC 0.0001282419  0.0001742142 0.5973248 0.01396082 0.01316128
Model#2 MCMC 0.1106152802 -0.1103177229 0.4215964 0.01464065 0.01429678


  What can be wrong with my model/assumptions/bugs_specification/etc?
What can be the reason why MCMC doesn't converge to the actual
parameters?

  The code used to simulate the data (X1[t],X2[t] and Y[t]) and to
estimate parameters is below.

Thanks in advance!

Kind regards,
Alex

'
require(dclone)
require(QRMlib)

#initial parameters
vol1<-0.014
vol2<-0.013
rho<-0.56

varcov<-diag(c(vol1,vol2)) %*% matrix(c(1,rho,rho,1),2) %*% diag(c(vol1,vol2))
mu<-c(5e-4,2e-4)

#sampling from bivariate normal
set.seed(1234)
rets<-rmnorm(1000,varcov,mu)
wrets<-1/2*rets[,1]+1/2*rets[,2]

#MLE fit
mlefit<-fit.norm(rets)

#BUGS|model#1 model/data/inits/fit
jfun1<-function(){
	for(i in 1:T) {	
		X[i,1:N] ~ dmnorm(mu[],prec[,])
	}	
	prec[1:N,1:N] ~ dwish(varcov[,],2)
	mu[1:N] ~ dmnorm(mu.mu[],mu.prec[,])
	vc[1:N,1:N]<-inverse(prec[,])
	vol1<-pow(vc[1,1],1/2)
	vol2<-pow(vc[2,2],1/2)
	rho<-vc[1,2]/(vol1*vol2)
}
jdata1<-list(T=1000,N=2,X=rets,varcov=varcov,mu.prec=diag(1e-6,2),mu.mu=mu)
jinits1<-list(prec=inv(varcov),mu=mu)
jpara1<-c('mu[1]','mu[2]','vol1','vol2','rho')
jfit1<-jags.fit(jdata1,jpara1,jfun1,jinits1,n.chains=1,n.iter=2000)
jsummary1<-summary(window(jfit1,1000))

#BUGS|model#2 model/data/inits/fit
jfun2<-function(){
	for(i in 1:T) {
		Y[i] ~ dnorm(wmu[i],1E6)
		wmu[i]<-1/2*X[i,1]+1/2*X[i,2]
		X[i,1:N] ~ dmnorm(mu[],prec[,])
	}	
	prec[1:N,1:N] ~ dwish(varcov[,],2)
	mu[1:N] ~ dmnorm(mu.mu[],mu.prec[,])
	vc[1:N,1:N]<-inverse(prec[,])
	vol1<-pow(vc[1,1],1/2)
	vol2<-pow(vc[2,2],1/2)
	rho<-vc[1,2]/(vol1*vol2)
}
jdata2<-list(T=1000,N=2,Y=wrets,varcov=varcov,mu.prec=diag(1e-6,2),mu.mu=mu)
jinits2<-list(prec=inv(varcov),mu=mu,X=rets)
jpara2<-c('mu[1]','mu[2]','vol1','vol2','rho')
jfit2<-jags.fit(jdata2,jpara2,jfun2,jinits2,n.chains=1,n.iter=100000)
jsummary2<-summary(window(jfit2,90000))
#here I get the following warnings
#Warning messages:
#1: glm.fit: algorithm did not converge
#2: glm.fit: algorithm did not converge

#comparative statistics
cmprstats<-rbind(
				c(mu,rho,vol1,vol2),
				c(mlefit$mu,mlefit$cor[1,2],sqrt(mlefit$Sigma[1,1]),sqrt(mlefit$Sigma[2,2])),
				as.numeric(jsummary1[[1]][,1]),
				as.numeric(jsummary2[[1]][,1]))
colnames(cmprstats)<-rownames(jsummary1[[1]])
rownames(cmprstats)<-c('Actual','MLE','Model#1 MCMC','Model#2 MCMC')


From megh700004 at gmail.com  Tue Jan 18 17:40:32 2011
From: megh700004 at gmail.com (Megh Dal)
Date: Tue, 18 Jan 2011 22:10:32 +0530
Subject: [R-SIG-Finance] Problem in SVEC estimation, please help
In-Reply-To: <AANLkTintStWgRG=-fK-FYnP-Oh4vnLYZ3QB405eSd2qz@mail.gmail.com>
References: <AANLkTintStWgRG=-fK-FYnP-Oh4vnLYZ3QB405eSd2qz@mail.gmail.com>
Message-ID: <AANLkTinnuYh86R+RkF-cN8=KPc9Y03_RzbBY0hB4fn1O@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110118/0f30b06b/attachment.pl>

From jjnavarroabellan at gmail.com  Tue Jan 18 17:54:16 2011
From: jjnavarroabellan at gmail.com (Javier Navarro)
Date: Tue, 18 Jan 2011 08:54:16 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1290590097787-3056941.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
	<1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
	<4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
	<4CEBEEC8.5080309@cedrickjohnson.com>
	<1290533699383-3055860.post@n4.nabble.com>
	<1290590097787-3056941.post@n4.nabble.com>
Message-ID: <1295369656600-3223471.post@n4.nabble.com>


Hello,

i'm also interested in these windows 32 bit compiled packages. Can anybody
help me?
And how is it solved the  "not installed for 'arch=i386'" problem?

Thank you all
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3223471.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Tue Jan 18 18:41:43 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 18 Jan 2011 11:41:43 -0600
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1295369656600-3223471.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>	<1289208688226-3031671.post@n4.nabble.com>	<1290511892635-3055244.post@n4.nabble.com>	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>	<4CEBE3B8.9050806@cedrickjohnson.com>	<1290529779031-3055758.post@n4.nabble.com>	<4CEBEEC8.5080309@cedrickjohnson.com>	<1290533699383-3055860.post@n4.nabble.com>	<1290590097787-3056941.post@n4.nabble.com>
	<1295369656600-3223471.post@n4.nabble.com>
Message-ID: <4D35D0D7.8050208@braverock.com>

On 01/18/2011 10:54 AM, Javier Navarro wrote:
>
> Hello,
>
> i'm also interested in these windows 32 bit compiled packages. Can anybody
> help me?
> And how is it solved the  "not installed for 'arch=i386'" problem?

32 and 64 bit Windows binaries are available on R-Forge for R 2.12.x

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From alain.ledonwong at baml.com  Tue Jan 18 18:59:30 2011
From: alain.ledonwong at baml.com (Ledon, Alain - Eqty NY)
Date: Tue, 18 Jan 2011 12:59:30 -0500
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <4D35D0D7.8050208@braverock.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
	<1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
	<4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
	<4CEBEEC8.5080309@cedrickjohnson.com>
	<1290533699383-3055860.post@n4.nabble.com>
	<1290590097787-3056941.post@n4.nabble.com>
	<1295369656600-3223471.post@n4.nabble.com>
	<4D35D0D7.8050208@braverock.com>
Message-ID: <A5C0E998EFB71249AEF11C6F6D501D0202028C4C@ex2k.bankofamerica.com>

Hi Javier,

If you can't install it directly from R-Forge (from inside R):

> install.packages("blotter", repos="http://R-Forge.R-project.org")

You can try to install everything from source. Here is what I did in XP.


1) Install R-Tools from here http://www.murdoch-sutherland.com/Rtools/

2) Download latest source version of xts from R-Forge
https://r-forge.r-project.org/R/?group_id=118

3) Download latest source version of blotter, FinancilInstrument and
quantstrat from R-Forge https://r-forge.r-project.org/R/?group_id=316

4) From the command line, go to the directory where you downloaded the
previous packages:

> R CMD INSTALL xts_0.7-6.13.tar.gz

> R CMD INSTALL FinancialInstrument_0.4.tar.gz

> R CMD INSTALL blotter_0.7.4.2.tar.gz

> R CMD INSTALL quantstrat_0.3.2.tar.gz 


Regards

Alain

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Brian G.
Peterson
Sent: Tuesday, January 18, 2011 12:42 PM
To: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] blotter package

On 01/18/2011 10:54 AM, Javier Navarro wrote:
>
> Hello,
>
> i'm also interested in these windows 32 bit compiled packages. Can
anybody
> help me?
> And how is it solved the  "not installed for 'arch=i386'" problem?

32 and 64 bit Windows binaries are available on R-Forge for R 2.12.x

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.

----------------------------------------------------------------------
This message w/attachments (message) is intended solely ...{{dropped:7}}


From jkaprich at gmail.com  Tue Jan 18 23:20:15 2011
From: jkaprich at gmail.com (John E. Kaprich)
Date: Tue, 18 Jan 2011 16:20:15 -0600
Subject: [R-SIG-Finance] Q-Q Plot of a Generalized Pareto Distribution
Message-ID: <000001cbb75d$e27a0480$a76e0d80$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110118/cf6a3368/attachment.pl>

From breman.mark at gmail.com  Wed Jan 19 11:38:56 2011
From: breman.mark at gmail.com (Mark Breman)
Date: Wed, 19 Jan 2011 11:38:56 +0100
Subject: [R-SIG-Finance] Howto test for true stationarity with adfTest()
Message-ID: <AANLkTikOk1Bxgd-ha9x4KhT=XV3pjhRYtyF63N0rmepE@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110119/a31c901c/attachment.pl>

From jjnavarroabellan at gmail.com  Wed Jan 19 12:08:39 2011
From: jjnavarroabellan at gmail.com (Javier Navarro)
Date: Wed, 19 Jan 2011 03:08:39 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <A5C0E998EFB71249AEF11C6F6D501D0202028C4C@ex2k.bankofamerica.com>
References: <1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
	<4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
	<4CEBEEC8.5080309@cedrickjohnson.com>
	<1290533699383-3055860.post@n4.nabble.com>
	<1290590097787-3056941.post@n4.nabble.com>
	<1295369656600-3223471.post@n4.nabble.com>
	<4D35D0D7.8050208@braverock.com>
	<A5C0E998EFB71249AEF11C6F6D501D0202028C4C@ex2k.bankofamerica.com>
Message-ID: <1295435319797-3225056.post@n4.nabble.com>


That's true Brian, i've installed most of the packages that i need from
R-Forge.
However, RMySQL package it's not available in R-Forge. Windows binaries
aren't available either in CRAN.
So I've tried to build it for windows following Alain's instructions but i
get an "unknown command" error when i type  R CMD INSTALL
RMySQL_0.7-5.tar.gz . I've installed R-Tools and fixed my path as it is
supposed.
Any intuition about what i might be doing wrong?

Thank you all 
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3225056.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From cedrick at cedrickjohnson.com  Wed Jan 19 12:50:42 2011
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Wed, 19 Jan 2011 06:50:42 -0500
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1295435319797-3225056.post@n4.nabble.com>
References: <1290511892635-3055244.post@n4.nabble.com>	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>	<4CEBE3B8.9050806@cedrickjohnson.com>	<1290529779031-3055758.post@n4.nabble.com>	<4CEBEEC8.5080309@cedrickjohnson.com>	<1290533699383-3055860.post@n4.nabble.com>	<1290590097787-3056941.post@n4.nabble.com>	<1295369656600-3223471.post@n4.nabble.com>	<4D35D0D7.8050208@braverock.com>	<A5C0E998EFB71249AEF11C6F6D501D0202028C4C@ex2k.bankofamerica.com>
	<1295435319797-3225056.post@n4.nabble.com>
Message-ID: <4D36D012.6050702@cedrickjohnson.com>

Couple things I can think of:

1) is R itself in your path? (i.e.) set R_HOME=c:\Program 
Files\R\R2.12.1 and then in the PATH (at the end, don't interfere with 
the r-tools mod at the front) add in: %R_HOME%\bin
Also if it compiled on Windows, it shouldn't generate a .tar.gz file (I 
get *.zip files on Windows when building)

2) Also have you looked at this site? : 
http://biostat.mc.vanderbilt.edu/wiki/Main/RMySQL

HTH.. If you can't get it working, I have a windows build I can throw up 
on my server ( I need to check which version of mysql i compiled it 
against when I get in front of that computer later today)

Regards,
Cedrick


From paulteetor at yahoo.com  Wed Jan 19 13:35:55 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Wed, 19 Jan 2011 04:35:55 -0800 (PST)
Subject: [R-SIG-Finance] Howto test for true stationarity with adfTest()
In-Reply-To: <AANLkTikOk1Bxgd-ha9x4KhT=XV3pjhRYtyF63N0rmepE@mail.gmail.com>
References: <AANLkTikOk1Bxgd-ha9x4KhT=XV3pjhRYtyF63N0rmepE@mail.gmail.com>
Message-ID: <771928.92039.qm@web56002.mail.re3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110119/1c0f9791/attachment.pl>

From ryan.sheftel at credit-suisse.com  Wed Jan 19 14:08:26 2011
From: ryan.sheftel at credit-suisse.com (Sheftel, Ryan)
Date: Wed, 19 Jan 2011 08:08:26 -0500
Subject: [R-SIG-Finance] Performance comparison xts v. zoo
Message-ID: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110119/6a5f301f/attachment.pl>

From ggrothendieck at gmail.com  Wed Jan 19 14:18:48 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 19 Jan 2011 08:18:48 -0500
Subject: [R-SIG-Finance] Performance comparison xts v. zoo
In-Reply-To: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
References: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
Message-ID: <AANLkTi=haj1FnojVSf10hF2q3fvdeLortzhEhtdtw48k@mail.gmail.com>

On Wed, Jan 19, 2011 at 8:08 AM, Sheftel, Ryan
<ryan.sheftel at credit-suisse.com> wrote:
>
> I am looking for a comparison of the performance speed between xts and
> zoo on time series. I remember once seeing this in a pdf document,
> perhaps a magazine article?, but after extensive google-ing I have come
> up blank.
>
> Any direction would be helpful before I reproduce the results myself.
> Thanks.
>

At this point in time xts is mostly written in C while zoo is mostly
written in R so xts should be substantially faster.  There is an
objective of merging the backends of xts and zoo at which point they
should run at about the same speed.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From edd at debian.org  Wed Jan 19 14:32:18 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 19 Jan 2011 07:32:18 -0600
Subject: [R-SIG-Finance] Performance comparison xts v. zoo
In-Reply-To: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
References: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
Message-ID: <19766.59362.191245.945242@max.nulle.part>


Hi Ryan,

On 19 January 2011 at 08:08, Sheftel, Ryan wrote:
| I am looking for a comparison of the performance speed between xts and
| zoo on time series. I remember once seeing this in a pdf document,
| perhaps a magazine article?, but after extensive google-ing I have come
| up blank.
| 
| Any direction would be helpful before I reproduce the results myself.

xts is faster, period, as zoo started as more general (than just financial
time series: "ordered objects") and is still R-code only. And as Gabor just
restated, that is bound to change with some xts code expected to merge over
to zoo at some point---though we have been told that for years.

Xts on the other hand has compiled C and Fortran code for key operations
making it very fast (and generally faster than zoo), as well as powerful.
One example is the ISO8601 date parsing which can subset based on
human-readable strings such as "2011-01-18 10:00/2011-01-19 10:30" getting
you just that half-hour interval yesterday on intra-day data in an xts
object. So in short, I usually start projects with xts.

As for blazing fast, Jeff also has the 'indexing' package (as well as 'mmap')
which go even further, and both together are competitive in access time with
commercial offerings. Maybe you recall a writeup Jeff did for that?  I can't
recall a xts-vs-zoo horse race but maybe I missed it.

Hope this helps,  Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From shane.conway at gmail.com  Wed Jan 19 15:07:25 2011
From: shane.conway at gmail.com (Shane Conway)
Date: Wed, 19 Jan 2011 09:07:25 -0500
Subject: [R-SIG-Finance] Performance comparison xts v. zoo
In-Reply-To: <19766.59362.191245.945242@max.nulle.part>
References: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
	<19766.59362.191245.945242@max.nulle.part>
Message-ID: <AANLkTikkKi+fWHf_iOvPoONXsb0k8ZUkcBCNqTKArtgG@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110119/023fd8c5/attachment.pl>

From ggrothendieck at gmail.com  Wed Jan 19 15:10:11 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 19 Jan 2011 09:10:11 -0500
Subject: [R-SIG-Finance] Performance comparison xts v. zoo
In-Reply-To: <19766.59362.191245.945242@max.nulle.part>
References: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
	<19766.59362.191245.945242@max.nulle.part>
Message-ID: <AANLkTimpO+YgbU=7Jsy-hFt+vuLGuvTjr0T-UjfTc_CV@mail.gmail.com>

On Wed, Jan 19, 2011 at 8:32 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> Hi Ryan,
>
> On 19 January 2011 at 08:08, Sheftel, Ryan wrote:
> | I am looking for a comparison of the performance speed between xts and
> | zoo on time series. I remember once seeing this in a pdf document,
> | perhaps a magazine article?, but after extensive google-ing I have come
> | up blank.
> |
> | Any direction would be helpful before I reproduce the results myself.
>
> Xts on the other hand has compiled C and Fortran code for key operations
> making it very fast (and generally faster than zoo), as well as powerful.

> One example is the ISO8601 date parsing which can subset based on
> human-readable strings such as "2011-01-18 10:00/2011-01-19 10:30" getting
> you just that half-hour interval yesterday on intra-day data in an xts
> object.

That is not truly an example.

A true example would be that xts has C code for merge whereas zoo has
R code.  Thus merges and functionality depending on merges could be
expected to be faster in xts.

On the other hand, comparing time operations is not a good example.
Parsing times are not a part of zoo nor are time operations in
general.  zoo defines an API that allows it to use any time class that
supports certain time/date methods (and all popular ones and most
lesser known ones do as do many classes that are not ordinarily
thought of as time classes) whereas xts hard codes these so the
"example" is really comparing particular time class methods, not part
of zoo, with hard coded functionality in xts.   Relative speeds would
depend on the particular time class and its implementation.

The one implication for speed is that if a new faster time class comes
along then zoo could likely use it without modifying zoo whereas xts
would have to be modified to handle it.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From salmajj at softhome.net  Wed Jan 19 20:00:08 2011
From: salmajj at softhome.net (salmajj)
Date: Wed, 19 Jan 2011 19:00:08 +0000 (UTC)
Subject: [R-SIG-Finance] Copula Package
References: <courier.4CD9BB2C.000008A2@softhome.net>
	<6A27F013-64EE-46A5-B7FB-50735639E053@gmail.com>
Message-ID: <loom.20110119T195809-461@post.gmane.org>

Christophe Dutang <dutangc <at> gmail.com> writes:

> 
> Hello,
> 
> I think what you need to look at is the log-likelihood. Something like sum
(log(dcopula(gumbelCopula(3),
> x)). 
> 
> By the way, there is also the gumbel package available on CRAN where some 
classic fitting methods are available.
> 
> Regards
> 
> Christophe
> 
> Le 9 nov. 2010 ? 22:20, salmajj <at> softhome.net a ?crit :
> 
> > Hi I tried a lot of time to send this message hope it works this time!
> > Hi everybody,
> > my objective is to find the corresponding parameter of the gumbel copula 
that best fit my empirical
> dependancy structure. i.e I already know that the gumbel copula is the best 
family but i want to decide on
> the best parameter ? 
> > in other words
> > let
> > x <- rcopula(gumbelCopula(3), 100) 
> > suppose we do not know that alpha=3 is the right value and we are 
wondering if the gumbel copula with alpha
> equal to 2 is a good fit
> > let test :
> > gofEVCopula(gumbelCopula(2), x)
> > this returns
> > Parameter estimate(s): 3.044912
> > Cramer-von Mises statistic: 0.0004143588 with p-value 0.8616384 
> > let test :
> > gofEVCopula(gumbelCopula(3), x)
> > this returns:
> > arameter estimate(s): 3.044912
> > Cramer-von Mises statistic: 0.0004143588 with p-value 0.8556444 
> > So if I well understand this function gofCopula only indicate that the 
gumbel family is a good fit and we can
> not decide on the best parameter of the gumbel copula as the results were 
the same!
> > So which test we could use to know that actually the gumbal copula with 
parameter 3 and not 2 fit best the dependancy?
> > Thanks a lot!
> > 
> > _______________________________________________
> > R-SIG-Finance <at> stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions 
should go.
> 
> --
> Christophe Dutang
> Ph.D. student at ISFA, Lyon, France
> website: http://dutangc.free.fr
> 
> 


Hi all, 
I understand that rmvdc generates random number from mvdc object. But the mvdc 
object can only be used if we define the marginals! So my question is suppose 
we don't find any distribution which fit marginals so we use the Canonical 
Maximum Likelihood method (This approach uses the empirical CDF of each 
marginal distribution to transform the observations into pseudo observations 
with uniform margins) SO after finding the copula which fit the dependancy HOW 
i can generate random number which mimic the data? 
Hope my question is clear, please if someone have an idea help me!


From salmajj at softhome.net  Wed Jan 19 21:50:06 2011
From: salmajj at softhome.net (salmajj)
Date: Wed, 19 Jan 2011 12:50:06 -0800 (PST)
Subject: [R-SIG-Finance] Copula and Multivariate distribution
Message-ID: <1295470206311-3225448.post@n4.nabble.com>


Hi all, 
I understand that rmvdc generates random number from mvdc object. But the
mvdc object can only be used if we define the marginals! So my question is
suppose we don't find any distribution which fit marginals so we use the
Canonical Maximum Likelihood method (This approach uses the empirical CDF of
each marginal distribution to transform the observations into pseudo
observations with uniform margins) SO after finding the copula which fit the
dependancy HOW i can generate random number which mimic the data? 
Hope my question is clear, please if someone have an idea help me! 
THANKS 

-- 
View this message in context: http://r.789695.n4.nabble.com/Copula-and-Multivariate-distribution-tp3225448p3225448.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From breman.mark at gmail.com  Thu Jan 20 07:48:10 2011
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 20 Jan 2011 07:48:10 +0100
Subject: [R-SIG-Finance] Howto test for true stationarity with adfTest()
In-Reply-To: <771928.92039.qm@web56002.mail.re3.yahoo.com>
References: <AANLkTikOk1Bxgd-ha9x4KhT=XV3pjhRYtyF63N0rmepE@mail.gmail.com>
	<771928.92039.qm@web56002.mail.re3.yahoo.com>
Message-ID: <AANLkTi=xMfCX2Y94sZ-BrBEzRNR5sMqytWCru+_yjJAO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110120/41cc9d10/attachment.pl>

From dutangc at gmail.com  Thu Jan 20 07:57:39 2011
From: dutangc at gmail.com (Christophe Dutang)
Date: Thu, 20 Jan 2011 07:57:39 +0100
Subject: [R-SIG-Finance] Copula and Multivariate distribution
In-Reply-To: <1295470206311-3225448.post@n4.nabble.com>
References: <1295470206311-3225448.post@n4.nabble.com>
Message-ID: <AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>

Hello,

you can use something like that

eqf <- function(x, sampleMarg) as.numeric(quantile(sampleMarg, probs=x))

and apply eqf on each marginal after the copula fit if you want to generate random samples or directly ecdf if you want to compute multivariate distribution function.

Christophe

--
Christophe Dutang
Ph.D. student at ISFA, Lyon, France
website: http://dutangc.free.fr

Le 19 janv. 2011 ? 21:50, salmajj a ?crit :

> 
> Hi all, 
> I understand that rmvdc generates random number from mvdc object. But the
> mvdc object can only be used if we define the marginals! So my question is
> suppose we don't find any distribution which fit marginals so we use the
> Canonical Maximum Likelihood method (This approach uses the empirical CDF of
> each marginal distribution to transform the observations into pseudo
> observations with uniform margins) SO after finding the copula which fit the
> dependancy HOW i can generate random number which mimic the data? 
> Hope my question is clear, please if someone have an idea help me! 
> THANKS 
> 
> -- 
> View this message in context: http://r.789695.n4.nabble.com/Copula-and-Multivariate-distribution-tp3225448p3225448.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From matthieu.stigler at gmail.com  Thu Jan 20 09:18:49 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Thu, 20 Jan 2011 09:18:49 +0100
Subject: [R-SIG-Finance] Howto test for true stationarity with adfTest()
In-Reply-To: <AANLkTi=xMfCX2Y94sZ-BrBEzRNR5sMqytWCru+_yjJAO@mail.gmail.com>
References: <AANLkTikOk1Bxgd-ha9x4KhT=XV3pjhRYtyF63N0rmepE@mail.gmail.com>	<771928.92039.qm@web56002.mail.re3.yahoo.com>
	<AANLkTi=xMfCX2Y94sZ-BrBEzRNR5sMqytWCru+_yjJAO@mail.gmail.com>
Message-ID: <4D37EFE9.5070602@gmail.com>

I would suggest:

1 test for unit root:
     if unit root: stochastic trend
     if not: 2

2 test for trend in normal AR(MA) model
     if not trend: "pure stationary" as you call
     if trend: trend stationary

Note if just the question of trend is of interest for you, you might be 
interested in using a test for trend indeopendeant of I(1)/I(0). Such a 
test has been developed in:

David I. Harvey, Stephen J. Leybourne, A.M. Robert Taylor
A simple, robust and powerful test of the trend hypothesis, J 
Econometrics 2007, 1302-1330

Mat



Le 20. 01. 11 07:48, Mark Breman a ?crit :
> Thanks Paul, you are right; if the trend is stronger it's revealed by the
> adfTest.
>
> As a follow-up question:
> Does anyone know if a test exists that would reveal a weaker trend in the
> data?
>
> Regards,
>
> -Mark-
>
> 2011/1/19 Paul Teetor<paulteetor at yahoo.com>
>
>> Mark,
>>
>> The adfTest with type="nc" works for me. I think your trend time series is
>> not "trendy" enough. When I change the assignment statement to this:
>>
>>      trend=notrend+(row(notrend)*.4)         # Change 0.04 to 0.4
>>
>> and execute this:
>>
>>      adfTest(coredata(trend), lag=0, type='nc')@test$p.value
>>
>> I get a p-value of 0.98.
>>
>>
>> Paul Teetor, Elgin, IL USA
>> http://quanttrader.info/public
>>
>>
>> ------------------------------
>> *From:* Mark Breman<breman.mark at gmail.com>
>> *To:* r-sig-finance at r-project.org
>> *Sent:* Wed, January 19, 2011 4:38:56 AM
>> *Subject:* [R-SIG-Finance] Howto test for true stationarity with adfTest()
>>
>> Hi everyone,
>>
>> I want to test for true stationarity (not trend-stationarity) in my
>> timeseries. I understand that i can't use the adf.test(), because it
>> de-trends the series.
>> Indeed, i can verify this:
>>
>>> notrend=xts(rnorm(100), Sys.Date()-100:1)
>>> trend=notrend+(row(notrend)*.04)
>>> adf.test(coredata(notrend), alternative="stationary", k=0)$p.value
>> [1] 0.01
>>> adf.test(coredata(trend), alternative="stationary", k=0)$p.value
>> [1] 0.01
>>
>> The p-values are the same so it's not usable for my purpose.
>>
>> I'm told i can use the adfTest() from package fUnitRoots instead because
>> this test does not de-trend the series.
>> So i try:
>>
>> library(fUnitRoots)
>>
>>> adfTest(coredata(notrend), lag=0, type='c')@test$p.value
>> 0.01
>>> adfTest(coredata(trend), lag=0, type='c')@test$p.value
>> 0.01
>>
>> Again, the p-values are the same!? Changing the type parameter (to 'ct' or
>> 'nc') does not help either (it gives the same p-values).
>> What am i doing wrong here?
>>
>> Thanks,
>>
>> -Mark-
>>
>>      [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jjnavarroabellan at gmail.com  Thu Jan 20 10:36:23 2011
From: jjnavarroabellan at gmail.com (Javier Navarro)
Date: Thu, 20 Jan 2011 01:36:23 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <4D36D012.6050702@cedrickjohnson.com>
References: <4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
	<4CEBEEC8.5080309@cedrickjohnson.com>
	<1290533699383-3055860.post@n4.nabble.com>
	<1290590097787-3056941.post@n4.nabble.com>
	<1295369656600-3223471.post@n4.nabble.com>
	<4D35D0D7.8050208@braverock.com>
	<A5C0E998EFB71249AEF11C6F6D501D0202028C4C@ex2k.bankofamerica.com>
	<1295435319797-3225056.post@n4.nabble.com>
	<4D36D012.6050702@cedrickjohnson.com>
Message-ID: <1295516183847-3225489.post@n4.nabble.com>


Cedrick, it helped! I did what it's said in that site and it worked. I had to
reinstall mysql with client header and library files but it worked.
Thank you so much

Regards
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3225489.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From Samuel.Le at srlglobal.com  Thu Jan 20 15:45:39 2011
From: Samuel.Le at srlglobal.com (Samuel Le)
Date: Thu, 20 Jan 2011 14:45:39 +0000
Subject: [R-SIG-Finance] Copula and Multivariate distribution
In-Reply-To: <1295470206311-3225448.post@n4.nabble.com>
References: <1295470206311-3225448.post@n4.nabble.com>
Message-ID: <ECBDD2620D45F74C9B4AA3DBA750C580169597E6@Exchange>

Hello,

The copula function will give you random numbers that are marginally following a uniform distribution on [0,1]. Then you need to apply to those numbers the inverse of the cumulative distribution you think that mimic the best your data.
For example, if you want to simulate n reduced centred normal distribution using a non Gaussian copula -i.e each variable follows a normal distribution of mean 0 and variance 1 but their joint distribution isn't the Gaussian copula but something else (it can be Clayton, Gumbel, etc.)- you need to apply to each random variable the function R qnorm.

HTH,

Samuel

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of salmajj
Sent: 19 January 2011 20:50
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] Copula and Multivariate distribution


Hi all,
I understand that rmvdc generates random number from mvdc object. But the
mvdc object can only be used if we define the marginals! So my question is
suppose we don't find any distribution which fit marginals so we use the
Canonical Maximum Likelihood method (This approach uses the empirical CDF of
each marginal distribution to transform the observations into pseudo
observations with uniform margins) SO after finding the copula which fit the
dependancy HOW i can generate random number which mimic the data?
Hope my question is clear, please if someone have an idea help me!
THANKS

--
View this message in context: http://r.789695.n4.nabble.com/Copula-and-Multivariate-distribution-tp3225448p3225448.html
Sent from the Rmetrics mailing list archive at Nabble.com.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


__________ Information from ESET NOD32 Antivirus, version of virus signature database 5801 (20110119) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com



__________ Information from ESET NOD32 Antivirus, version of virus signature database 5803 (20110120) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com


From iron.arty at gmail.com  Thu Jan 20 15:51:18 2011
From: iron.arty at gmail.com (Artyom Kharitonov)
Date: Thu, 20 Jan 2011 16:51:18 +0200
Subject: [R-SIG-Finance]  Kalman and regression model
Message-ID: <AANLkTikDyZeNhKfncNdC7hp_CveXSafbxmM89V-pTMER@mail.gmail.com>

Hi everyone. I have a question about the Kalman filter and DLM package.
I have Initial data:
regression : y = bx
Purpose: make adaptive b
Decision:
After MLE define the unknown parameter V, W.
Define state-space model dlmRegr (...) with V,W
Than we implement dlmFilter and dlmSmooth (As i know, on this period
dlmFilter estimates b). This method works well for in-sample area.
How  I can implement this approach to adapt b  for future data, using
results obtaining at previous steps?
Thanks


From Danilo.Mercurio at Sparinvest.com  Fri Jan 21 15:42:17 2011
From: Danilo.Mercurio at Sparinvest.com (Mercurio Danilo 1850 SPI)
Date: Fri, 21 Jan 2011 15:42:17 +0100
Subject: [R-SIG-Finance] colMeans(x) <> colStats(x, mean)
Message-ID: <F15AA09E242F834FA21B03F1590005BE1C013C9F26@M0173.s-mxs.net>

Hi!

first I would like to say that I am an enthusiastic user of the Rmetrics libraries and I am very greatful to all the developpers.
I would really appreciate  a few comments on the following problem though. As the example below shows the function "colMeans" (package base) treats Nas
differently from the function "colStats" (package timeSeires). In order to have the same tretment of Nas I could not find a better solution as to write a new function: "colSdsNAs" instead of "colSds". I need this because I want to use the function im "applySeries" and my data is similar to the "x" in the example.

Is this the only way or I can use the functions "colStats", "colSds" in some way that suits my problem?

Thank you for your help!

-------
require(timeSeries)
require(fAssets)

a = c(rep(NA, 5), 6:12)
b = c(rep(NA, 3), 4:12)
x = cbind(a, b)

x = as.timeSeries(x)
dt0  = as.timeDate("20000101")
dt1 =  as.timeDate("20001201")
tStamps = timeSequence(from = dt0, to = dt1, by = "1 month")
time(x) = tStamps
colMeans(x)
colSds(x)
colStats(x, mean)
#
colMeans(x, na.rm = TRUE)
colSds(x, na.rm = TRUE)

by = periods(time(x), "3m", "1m")
applySeries(x, from = by$from, to = by$to, FUN = "colMeans")
applySeries(x, from = by$from, to = by$to, FUN = "colSds")

colSdsNAs <- function(x) apply(x, 2, "sd")
applySeries(x, from = by$from, to = by$to, FUN = "colSdsNAs")
------

Dr. Danilo Mercurio
ERSTE-SPARINVEST Kapitalanlagegesellschaft m.b.H
Quantitative Analyst, Global Strategies and Research

AT00951850 Global Strategies & Research
Sitz des Unternehmens: 1010 Wien, Habsburgergasse 1a
Tel.:   +43 (0) 50100 - 19957
Fax.:  +43 (0) 50100 9 - 19957
Mob.: +43 (0) 50100 6 - 19957

www.sparinvest.com
Handelsgericht Wien - FN 81876 g

ERSTE-SPARINVEST Kapitalanlagegesellschaft m.b.H. - Member of Erste Group


From nick.torenvliet at gmail.com  Sat Jan 22 20:01:04 2011
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Sat, 22 Jan 2011 14:01:04 -0500
Subject: [R-SIG-Finance] Plotting by factor with xts
In-Reply-To: <AANLkTinofYc05uXA5JdD0+43HVxqOdEsfVQ3FA+XW4f6@mail.gmail.com>
References: <AANLkTinofYc05uXA5JdD0+43HVxqOdEsfVQ3FA+XW4f6@mail.gmail.com>
Message-ID: <AANLkTi=vPZbZav_Br4FMubCoKZ3bzywXZ4Ng5urHWbt1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110122/cc967b66/attachment.pl>

From lui.r.project at googlemail.com  Sat Jan 22 23:33:09 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Sat, 22 Jan 2011 17:33:09 -0500
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
Message-ID: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>

Dear group,

I was just wondering whether some of you have some experience with the
package "rgenoud" which does provide genetic algorithms for complex
optimization problems. How did you efficiently solve the constraints
(sum of all weights <1, variance < target)? Setting the solution
"infeasible" through if-clauses did not seem to be so promising ...
The example below shows what I mean:

(penalty-term)

if (variance > targetvariance){
penatly = -999999
}

"result" is to be maximized, the variance should not exceed a certain
threeshold. To me, it seemed much better to add a penalty term like

penalty = ( (abs(variance-targetvariance)/targetvariance)*100)^50

What is your general experience? Did you ever try solving the
Markowitz portfolio with the rgenoud package?
I know that there are good solvers around for the qudratic programming
problem of the markowitz portfolio, but I want to go into a different
direction which translates into a quadratic problem with quadratic
constraints (and I havent found a good solver for that...).

I am interested in your replies! Have a good weekend!

Lui


From jeff.a.ryan at gmail.com  Sat Jan 22 23:52:40 2011
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sat, 22 Jan 2011 16:52:40 -0600
Subject: [R-SIG-Finance] Plotting by factor with xts
In-Reply-To: <AANLkTi=vPZbZav_Br4FMubCoKZ3bzywXZ4Ng5urHWbt1@mail.gmail.com>
References: <AANLkTinofYc05uXA5JdD0+43HVxqOdEsfVQ3FA+XW4f6@mail.gmail.com>
	<AANLkTi=vPZbZav_Br4FMubCoKZ3bzywXZ4Ng5urHWbt1@mail.gmail.com>
Message-ID: <37258C64-0F83-4E0B-B15C-899437FA3D25@gmail.com>

Don't use "long format". That is, run the symbols across columns - one symbol per column i.e. "wide format".  

Since xts is a matrix, you'll nee to make sure to keep the coredata numeric - mixing symbols into columns assures it isn't. 

From there you can either plot with plot.xts and lines or plot.zoo.

Best,
Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Jan 22, 2011, at 1:01 PM, Nick Torenvliet <nick.torenvliet at gmail.com> wrote:

> Hi all,
> 
> I may have double posted this, so apologies, for some reason R-help doesn't
> seem to be posting for me.
> 
> I've got an xts time series of stock symbols and closing prices.
> 
>> head(x)
>           symbol close
> 2010-01-04 "AFB"  "13.46"
> 2010-01-04 "AKP"  "12.80"
> 2010-01-04 "APX"  " 8.78"
> 2010-01-04 "AYN"  "13.15"
> 2010-01-04 "BAF"  "13.50"
> 2010-01-04 "BBF"  "12.86"
>> tail(x)
>           symbol close
> 2011-01-21 "VMO"  "12.35"
> 2011-01-21 "VOQ"  "13.77"
> 2011-01-21 "VPV"  "11.97"
> 2011-01-21 "VTJ"  "14.74"
> 2011-01-21 "VTN"  "13.16"
> 2011-01-21 "XAA"  "12.82"
> 
>> is.xts(x)
> [1] TRUE
> 
> I've made the symbols a factor
> 
>> head(xFactor)
> symbol   <NA>   <NA>   <NA>   <NA>   <NA>
>   AFB    AKP    APX    AYN    BAF    BBF
> 154 Levels: AFB AKP APX AYN BAF BBF BBK BFK BFO BFZ BIE BJZ BKK BKN BLH ...
> XAA
> 
> Each factor represent a time series on closing prices.
> 
> I would like to plot those 154 time series on a single plot...
> 
> Any ideas?
> 
> Regards,
> 
> Nick
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From guillaume.yziquel at citycable.ch  Sat Jan 22 23:52:36 2011
From: guillaume.yziquel at citycable.ch (Guillaume Yziquel)
Date: Sat, 22 Jan 2011 23:52:36 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
Message-ID: <20110122225235.GQ4195@localhost>

Le Saturday 22 Jan 2011 ? 17:33:09 (-0500), Lui ## a ?crit :
> Dear group,
> 
> What is your general experience? Did you ever try solving the
> Markowitz portfolio with the rgenoud package?
> I know that there are good solvers around for the qudratic programming
> problem of the markowitz portfolio, but I want to go into a different
> direction which translates into a quadratic problem with quadratic
> constraints (and I havent found a good solver for that...).
> 
> I am interested in your replies! Have a good weekend!
> 
> Lui

Any semidefinite programming solver should do the trick for quadratic 
problem with quadratic constraints. I suggest you have a look at SDPA, 
but there a lot of such solvers available if you look well.

(Well not every quadratic constraints, but reasonable ones, yes.)

The trick is how you get to reformulate your problem into a semidefinite
one. SDPs may not be the fastest solver for your problem if it has a 
specific structure, but as a general solution or prototype, it works,
and is
adequately fast.

But I'm not so sure as what is available in R for SDPs.

-- 
     Guillaume Yziquel
http://yziquel.homelinux.org


From daniel.cegielka at gmail.com  Sun Jan 23 00:20:23 2011
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Sun, 23 Jan 2011 00:20:23 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
Message-ID: <AANLkTi=YUfmW_zFW+2ZaCCt9A2cCpF+zQwDG3tc1g+8s@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110123/94949824/attachment.pl>

From nick.torenvliet at gmail.com  Sun Jan 23 02:05:19 2011
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Sat, 22 Jan 2011 20:05:19 -0500
Subject: [R-SIG-Finance] Plotting by factor with xts
In-Reply-To: <37258C64-0F83-4E0B-B15C-899437FA3D25@gmail.com>
References: <AANLkTinofYc05uXA5JdD0+43HVxqOdEsfVQ3FA+XW4f6@mail.gmail.com>
	<AANLkTi=vPZbZav_Br4FMubCoKZ3bzywXZ4Ng5urHWbt1@mail.gmail.com>
	<37258C64-0F83-4E0B-B15C-899437FA3D25@gmail.com>
Message-ID: <AANLkTinVP3Gb395kNEM2M6N2uXxiY7DD6qafp29ZfCNJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110122/a30f26f8/attachment.pl>

From nick.torenvliet at gmail.com  Sun Jan 23 02:06:30 2011
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Sat, 22 Jan 2011 20:06:30 -0500
Subject: [R-SIG-Finance] Plotting by factor with xts
In-Reply-To: <AANLkTinVP3Gb395kNEM2M6N2uXxiY7DD6qafp29ZfCNJ@mail.gmail.com>
References: <AANLkTinofYc05uXA5JdD0+43HVxqOdEsfVQ3FA+XW4f6@mail.gmail.com>
	<AANLkTi=vPZbZav_Br4FMubCoKZ3bzywXZ4Ng5urHWbt1@mail.gmail.com>
	<37258C64-0F83-4E0B-B15C-899437FA3D25@gmail.com>
	<AANLkTinVP3Gb395kNEM2M6N2uXxiY7DD6qafp29ZfCNJ@mail.gmail.com>
Message-ID: <AANLkTin2ysB4_0QvP_DxbEBZT6vTUS+Wmncup0dJzrtp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110122/86c753aa/attachment.pl>

From guillaume.yziquel at citycable.ch  Sun Jan 23 15:31:13 2011
From: guillaume.yziquel at citycable.ch (Guillaume Yziquel)
Date: Sun, 23 Jan 2011 15:31:13 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <20110122225235.GQ4195@localhost>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<20110122225235.GQ4195@localhost>
Message-ID: <20110123143112.GN4195@localhost>

Le Saturday 22 Jan 2011 ? 23:52:36 (+0100), Guillaume Yziquel a ?crit :
> Le Saturday 22 Jan 2011 ? 17:33:09 (-0500), Lui ## a ?crit :
> 
> But I'm not so sure as what is available in R for SDPs.

Just had a look at the following webpage:

http://cran.r-project.org/web/views/Optimization.html

You have an R binding for CSDP:

http://cran.r-project.org/web/packages/Rcsdp/index.html

Best regards,

-- 
     Guillaume Yziquel
http://yziquel.homelinux.org


From brian at braverock.com  Sun Jan 23 22:56:40 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 23 Jan 2011 15:56:40 -0600
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
Message-ID: <201101231556.41133.brian@braverock.com>

On Saturday, January 22, 2011 04:33:09 pm Lui ## wrote:
> Dear group,
> 
> I was just wondering whether some of you have some experience with the
> package "rgenoud" which does provide genetic algorithms for complex
> optimization problems. 

<...>

> What is your general experience? Did you ever try solving the
> Markowitz portfolio with the rgenoud package?
> I know that there are good solvers around for the qudratic programming
> problem of the markowitz portfolio, but I want to go into a different
> direction which translates into a quadratic problem with quadratic
> constraints (and I havent found a good solver for that...).
> 
> I am interested in your replies! Have a good weekend!

As others have already said, for a quadtratic problem with quadratic 
constraints, there is an exact analytical solution.

In these cases, you will be much better off both from a performance and 
accuracy perspective in using a quadratic solver (quadprog is most often 
applied in R, see list archives and many packages for examples).

Other portfolio problems may be stated in terms of linear solvers, which will 
likewise be faster than a global optimizer for finding an exact analytical 
solution.

If, however, your portfolio problem is non-convex and non-smooth, then a 
genetic algorithm, a migration algorithm, grid search, or random portfolios 
may be a good option for finding a near-optimal portfolio.  If this is your 
true goal, perhaps you can say a little more about your actual constraints and 
objectives (and use assets that are outside of your true area of interest, 
such as the S&P sector indices).

Regards,

  - Brian 

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From guillaume.yziquel at citycable.ch  Sun Jan 23 23:15:43 2011
From: guillaume.yziquel at citycable.ch (Guillaume Yziquel)
Date: Sun, 23 Jan 2011 23:15:43 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <201101231556.41133.brian@braverock.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<201101231556.41133.brian@braverock.com>
Message-ID: <20110123221543.GK4195@localhost>

Le Sunday 23 Jan 2011 ? 15:56:40 (-0600), Brian G. Peterson a ?crit :
> On Saturday, January 22, 2011 04:33:09 pm Lui ## wrote:
> > Dear group,
> > 
> > I was just wondering whether some of you have some experience with the
> > package "rgenoud" which does provide genetic algorithms for complex
> > optimization problems. 
> 
> <...>
> 
> > What is your general experience? Did you ever try solving the
> > Markowitz portfolio with the rgenoud package?
> > I know that there are good solvers around for the qudratic programming
> > problem of the markowitz portfolio, but I want to go into a different
> > direction which translates into a quadratic problem with quadratic
> > constraints (and I havent found a good solver for that...).
> > 
> > I am interested in your replies! Have a good weekend!
> 
> As others have already said, for a quadtratic problem with quadratic 
> constraints, there is an exact analytical solution.

I wouldn't qualify dual interior point methods as an "exact" solution, but,
yes, that's the basic idea: they're better suited for that.
 
> In these cases, you will be much better off both from a performance and 
> accuracy perspective in using a quadratic solver (quadprog is most often 
> applied in R, see list archives and many packages for examples).

Is quadprog a second-order cone programming solver? If that is the case,
yes, it probably solves quadratic objective function with quadratic
constraints faster and with more accuracy than a full-fledged SDP
solver.

> Other portfolio problems may be stated in terms of linear solvers, which will 
> likewise be faster than a global optimizer for finding an exact analytical 
> solution.
> 
> If, however, your portfolio problem is non-convex and non-smooth, then a 
> genetic algorithm, a migration algorithm, grid search, or random portfolios 
> may be a good option for finding a near-optimal portfolio.  If this is your 
> true goal, perhaps you can say a little more about your actual constraints and 
> objectives (and use assets that are outside of your true area of interest, 
> such as the S&P sector indices).

Yes, the problem structure often gives good insight as to which method
to apply. It may be noted, however, that quite a lot of non-convex
problems may be transformed into convex ones. And using some relaxation
methods, you can often use SDPs to optimise multivariate polynomial
objective under multivariate polynomial constraints, without too many
convexity hypothesis.

SDPs are not always easy to manipulate, but they do solve a broad range
of optimisation problems.

> Regards,
> 
>   - Brian 

Best regards,

-- 
     Guillaume Yziquel
http://yziquel.homelinux.org


From ustaudinger at gmail.com  Sun Jan 23 23:23:44 2011
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Sun, 23 Jan 2011 23:23:44 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <20110123221543.GK4195@localhost>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<201101231556.41133.brian@braverock.com>
	<20110123221543.GK4195@localhost>
Message-ID: <AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110123/48049bb4/attachment.pl>

From david.ardia at unifr.ch  Sun Jan 23 23:32:40 2011
From: david.ardia at unifr.ch (ArdiaD)
Date: Sun, 23 Jan 2011 23:32:40 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>	<201101231556.41133.brian@braverock.com>	<20110123221543.GK4195@localhost>
	<AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>
Message-ID: <4D3CAC88.7010104@unifr.ch>

This might be of interest:
http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1584905
Regards
Dave

On 01/23/2011 11:23 PM, Ulrich Staudinger wrote:
> Lui,
>
> you can also have a look at
> http://aqr.activequant.org/index.php/2010/08/genetically-optimizing-a-trading-system/for
> inspiration on how to genetically optimize a trading system, whether
> it's quadratic or not. It's just some snipplet but exemplifies it pretty
> well ...
>
> Regards,
> Ulrich
>
>
> On Sun, Jan 23, 2011 at 11:15 PM, Guillaume Yziquel <
> guillaume.yziquel at citycable.ch> wrote:
>
>> Le Sunday 23 Jan 2011 ?  15:56:40 (-0600), Brian G. Peterson a ??crit :
>>> On Saturday, January 22, 2011 04:33:09 pm Lui ## wrote:
>>>> Dear group,
>>>>
>>>> I was just wondering whether some of you have some experience with the
>>>> package "rgenoud" which does provide genetic algorithms for complex
>>>> optimization problems.
>>> <...>
>>>
>>>> What is your general experience? Did you ever try solving the
>>>> Markowitz portfolio with the rgenoud package?
>>>> I know that there are good solvers around for the qudratic programming
>>>> problem of the markowitz portfolio, but I want to go into a different
>>>> direction which translates into a quadratic problem with quadratic
>>>> constraints (and I havent found a good solver for that...).
>>>>
>>>> I am interested in your replies! Have a good weekend!
>>> As others have already said, for a quadtratic problem with quadratic
>>> constraints, there is an exact analytical solution.
>> I wouldn't qualify dual interior point methods as an "exact" solution, but,
>> yes, that's the basic idea: they're better suited for that.
>>
>>> In these cases, you will be much better off both from a performance and
>>> accuracy perspective in using a quadratic solver (quadprog is most often
>>> applied in R, see list archives and many packages for examples).
>> Is quadprog a second-order cone programming solver? If that is the case,
>> yes, it probably solves quadratic objective function with quadratic
>> constraints faster and with more accuracy than a full-fledged SDP
>> solver.
>>
>>> Other portfolio problems may be stated in terms of linear solvers, which
>> will
>>> likewise be faster than a global optimizer for finding an exact
>> analytical
>>> solution.
>>>
>>> If, however, your portfolio problem is non-convex and non-smooth, then a
>>> genetic algorithm, a migration algorithm, grid search, or random
>> portfolios
>>> may be a good option for finding a near-optimal portfolio.  If this is
>> your
>>> true goal, perhaps you can say a little more about your actual
>> constraints and
>>> objectives (and use assets that are outside of your true area of
>> interest,
>>> such as the S&P sector indices).
>> Yes, the problem structure often gives good insight as to which method
>> to apply. It may be noted, however, that quite a lot of non-convex
>> problems may be transformed into convex ones. And using some relaxation
>> methods, you can often use SDPs to optimise multivariate polynomial
>> objective under multivariate polynomial constraints, without too many
>> convexity hypothesis.
>>
>> SDPs are not always easy to manipulate, but they do solve a broad range
>> of optimisation problems.
>>
>>> Regards,
>>>
>>>   - Brian
>> Best regards,
>>
>> --
>>     Guillaume Yziquel
>> http://yziquel.homelinux.org
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>


From lui.r.project at googlemail.com  Mon Jan 24 06:23:14 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Mon, 24 Jan 2011 00:23:14 -0500
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <4D3CAC88.7010104@unifr.ch>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<201101231556.41133.brian@braverock.com>
	<20110123221543.GK4195@localhost>
	<AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>
	<4D3CAC88.7010104@unifr.ch>
Message-ID: <AANLkTi=umShDNa5Qmb_tpBtzMgC5adDpgo4et4_mXUC6@mail.gmail.com>

First of all: Thank you very much everybody for the vast number of
replies! I really appreciate your help! I didn't expect so many
responses!

@ Guillaume Yziquel: Thank you very much for your quick responses and
keeping track of the answers! I have to admit that I know very little
about SDPs, so please excuse my stupid question: am I able to solve
the Markowitz portfolio (at given risk, so w x Cov x w' with target
function w x E(r)) ? Especially when my covariance matrix is changing
and I need to have an optimizer that just uses the vektor E(r) and the
matrix (Cov) as Input. Is that still possible when the my target
function (maximize) is also in a quadratic form ( e.g. w x MATRIX x w)
- without having to transform the problem manually? Thanks again for
your great help!

@ Daniel & Dave: Thank you very much for your links! The paper is
really great and I have already started implementing the DE
algorithm... Do you have any experience with the parameters with
respect to PF optimization? The portfolio I am looking at is quite
large (400+ stocks) and the algorithm is converging quite slowly (e.g.
for the minimum risk portfolio). I tried NP = 6000, iterations at
2000.

@Pat: Thank you very much for the link! I will take a look at it after
"playing around with GAs and DEs a little". The reason is that I
currently have a quadratic program and quadratic constraints but the
constraints might become a little bit "ugly" (hold portfolio turnover
in a certain range, assets from certain asset classes should only have
a certain weight,...), so I want to be a little bit flexible...

@Brian: I actually had troubles finding a solver for quadratic
problems and quadratic constraints. I think quadprog was intended for
quadratic problems with linear constraints or am I mistaken? I tried
to get Rscop run but had problems installing the library. The solvers
for linear problems and quadratic constraints as described in the
fPortfolio package did not work out the way I wanted them either
(there were some threads in R-Sig-Finance on that topic... But as my
constraints will probably get more complex, or I will want to try out
new ideas quickly I think I will go with the GAs/DEs first (unless you
have a good recommendation for a flexible / easy to modify solver that
is even aimed a little at portfolio problems

@Ulrich: Thanks for the link! I see that genoud was used here - do you
have any suggestions in terms of penalty functions for portfolio
problems?


Just to give you an overview on what I am trying to achieve:

I am working on an investment strategy and want to compare it to
Markowitz (with the risk level being the same...) Therefore I am
currently trying implement Markowitz with GAs or Deoptim. I found
going the "dirty" way in solving min w x Cov x w' with a target return
saves me the pain from quadratic constraints but leaves me with many
points on the efficient frontier to calculate - if I want to find an
optimal E(r) for a given sigma (which I currently find most suitable,
as both portfolios should have the same risk). That approach is not
very "lean" and nice. My investment strategy leaves me (in the
simplest form) with a quadratic problem (and the quadratic constraints
still remain - since I am interested in the Variance).
As there is lots of "try and try again" I appreciate the flexibility
of "more general complex problem solvers" as the problem may get more
complex with the constraints.

I currently face the problem that the target sigma I want to achieve
is kind of far from what the algorithms give me... I suspect the
penalty function is the "problem". Do you have suggestions for good
penalty function?
I already "cut out" the sum(w) = 1 constraint by adding w <- w /
sum(w) (see DEoptim paper). Currently, my penalty function looks like
this:

return <- return(w)
variance <- variance (w)

penalty_faktor = 20
penalty <- max((variance - targetvariance)/targetvariance,0)
	
if (((variance - targetvariance)/targetvariance) < 0.1){
	penalty_faktor = 1
	penalty = 0
	}
		

	ret <-  (penalty*100)^penalty_faktor - return

I dont care so much if the true variance is little bigger (10%) and
found if-then routines "spitting" out 99999 values if the constraints
are not met to be very inefficient... If somebody has suggestions for
good penalty function - please let me know!

Have a great weekend!
Lui
On Sun, Jan 23, 2011 at 5:32 PM, ArdiaD <david.ardia at unifr.ch> wrote:
> This might be of interest:
> http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1584905
> Regards
> Dave
>
> On 01/23/2011 11:23 PM, Ulrich Staudinger wrote:
>> Lui,
>>
>> you can also have a look at
>> http://aqr.activequant.org/index.php/2010/08/genetically-optimizing-a-trading-system/for
>> inspiration on how to genetically optimize a trading system, whether
>> it's quadratic or not. It's just some snipplet but exemplifies it pretty
>> well ...
>>
>> Regards,
>> Ulrich
>>
>>
>> On Sun, Jan 23, 2011 at 11:15 PM, Guillaume Yziquel <
>> guillaume.yziquel at citycable.ch> wrote:
>>
>>> Le Sunday 23 Jan 2011 ? ?15:56:40 (-0600), Brian G. Peterson a ??crit :
>>>> On Saturday, January 22, 2011 04:33:09 pm Lui ## wrote:
>>>>> Dear group,
>>>>>
>>>>> I was just wondering whether some of you have some experience with the
>>>>> package "rgenoud" which does provide genetic algorithms for complex
>>>>> optimization problems.
>>>> <...>
>>>>
>>>>> What is your general experience? Did you ever try solving the
>>>>> Markowitz portfolio with the rgenoud package?
>>>>> I know that there are good solvers around for the qudratic programming
>>>>> problem of the markowitz portfolio, but I want to go into a different
>>>>> direction which translates into a quadratic problem with quadratic
>>>>> constraints (and I havent found a good solver for that...).
>>>>>
>>>>> I am interested in your replies! Have a good weekend!
>>>> As others have already said, for a quadtratic problem with quadratic
>>>> constraints, there is an exact analytical solution.
>>> I wouldn't qualify dual interior point methods as an "exact" solution, but,
>>> yes, that's the basic idea: they're better suited for that.
>>>
>>>> In these cases, you will be much better off both from a performance and
>>>> accuracy perspective in using a quadratic solver (quadprog is most often
>>>> applied in R, see list archives and many packages for examples).
>>> Is quadprog a second-order cone programming solver? If that is the case,
>>> yes, it probably solves quadratic objective function with quadratic
>>> constraints faster and with more accuracy than a full-fledged SDP
>>> solver.
>>>
>>>> Other portfolio problems may be stated in terms of linear solvers, which
>>> will
>>>> likewise be faster than a global optimizer for finding an exact
>>> analytical
>>>> solution.
>>>>
>>>> If, however, your portfolio problem is non-convex and non-smooth, then a
>>>> genetic algorithm, a migration algorithm, grid search, or random
>>> portfolios
>>>> may be a good option for finding a near-optimal portfolio. ?If this is
>>> your
>>>> true goal, perhaps you can say a little more about your actual
>>> constraints and
>>>> objectives (and use assets that are outside of your true area of
>>> interest,
>>>> such as the S&P sector indices).
>>> Yes, the problem structure often gives good insight as to which method
>>> to apply. It may be noted, however, that quite a lot of non-convex
>>> problems may be transformed into convex ones. And using some relaxation
>>> methods, you can often use SDPs to optimise multivariate polynomial
>>> objective under multivariate polynomial constraints, without too many
>>> convexity hypothesis.
>>>
>>> SDPs are not always easy to manipulate, but they do solve a broad range
>>> of optimisation problems.
>>>
>>>> Regards,
>>>>
>>>> ? - Brian
>>> Best regards,
>>>
>>> --
>>> ? ? Guillaume Yziquel
>>> http://yziquel.homelinux.org
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From daniel.cegielka at gmail.com  Mon Jan 24 06:57:31 2011
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Mon, 24 Jan 2011 06:57:31 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTi=umShDNa5Qmb_tpBtzMgC5adDpgo4et4_mXUC6@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<201101231556.41133.brian@braverock.com>
	<20110123221543.GK4195@localhost>
	<AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>
	<4D3CAC88.7010104@unifr.ch>
	<AANLkTi=umShDNa5Qmb_tpBtzMgC5adDpgo4et4_mXUC6@mail.gmail.com>
Message-ID: <AANLkTin_jm9mwqNcrHyVFG+s=VDqbBMw-ZO3V4MLfhV6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110124/2e737334/attachment.pl>

From guillaume.yziquel at citycable.ch  Mon Jan 24 13:53:54 2011
From: guillaume.yziquel at citycable.ch (Guillaume Yziquel)
Date: Mon, 24 Jan 2011 13:53:54 +0100
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTi=umShDNa5Qmb_tpBtzMgC5adDpgo4et4_mXUC6@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<201101231556.41133.brian@braverock.com>
	<20110123221543.GK4195@localhost>
	<AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>
	<4D3CAC88.7010104@unifr.ch>
	<AANLkTi=umShDNa5Qmb_tpBtzMgC5adDpgo4et4_mXUC6@mail.gmail.com>
Message-ID: <20110124125354.GD4195@localhost>

Le Monday 24 Jan 2011 ? 00:23:14 (-0500), Lui ## a ?crit :
> First of all: Thank you very much everybody for the vast number of
> replies! I really appreciate your help! I didn't expect so many
> responses!
> 
> @ Guillaume Yziquel: Thank you very much for your quick responses and
> keeping track of the answers! I have to admit that I know very little
> about SDPs, so please excuse my stupid question: am I able to solve
> the Markowitz portfolio (at given risk, so w x Cov x w' with target
> function w x E(r)) ? Especially when my covariance matrix is changing
> and I need to have an optimizer that just uses the vektor E(r) and the
> matrix (Cov) as Input. Is that still possible when the my target
> function (maximize) is also in a quadratic form ( e.g. w x MATRIX x w)
> - without having to transform the problem manually? Thanks again for
> your great help!

Suppose you have to maximise some quadratic objective f(x), where x are
multivariate variables. Introduce another 'free' variable h.

Then, maximising f(x) under constraints C(x) is the same as maximising h
under the constraints C(x) and h <= f(x).

That's a simple relaxation method allowing you to convert a quadratic
objective into a linear objective by introducing a free relaxation
variable.

As to how to formulate your problem into an SDP, there is literature on
the web about that. Do not have any links handy, but google for Schur
complement along with semidefinite programming and relaxation.

More suited mailing-lists for these questions may be the one for CVXOPT,
Coinor mailing lists such as for IPOPT, and generally mailing lists for
SDPs solvers. For your specific case, I'd google for second-order cone
programming.
 
> @Brian: I actually had troubles finding a solver for quadratic
> problems and quadratic constraints. I think quadprog was intended for
> quadratic problems with linear constraints or am I mistaken?

As mentioned earlier, add a free variable, and your quadratic objective
becomes a linear objective.

> But as my
> constraints will probably get more complex, or I will want to try out
> new ideas quickly I think I will go with the GAs/DEs first (unless you
> have a good recommendation for a flexible / easy to modify solver that
> is even aimed a little at portfolio problems

You have a tradeoff between speed/accuracy and flexibility.

Depends what your constraints really are. Quadratic? Use second-order
cone programming. Multivariate polynomials? Use semi-definite
programming. Some convex constraints, or quasi-convex, or can be turned
into convex constraints? Interior-point methods (IPOPT, for instance)?
Anything else? Well, DEOptim, GAs, simulated annealing or whatever you
find experimentally handy.

Best regards,

-- 
     Guillaume Yziquel
http://yziquel.homelinux.org


From lui.r.project at googlemail.com  Mon Jan 24 15:45:42 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Mon, 24 Jan 2011 09:45:42 -0500
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <AANLkTin_jm9mwqNcrHyVFG+s=VDqbBMw-ZO3V4MLfhV6@mail.gmail.com>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<201101231556.41133.brian@braverock.com>
	<20110123221543.GK4195@localhost>
	<AANLkTi=vtsBrGw8JuLj=uegAHgWgnNwqgvfOisstA=tu@mail.gmail.com>
	<4D3CAC88.7010104@unifr.ch>
	<AANLkTi=umShDNa5Qmb_tpBtzMgC5adDpgo4et4_mXUC6@mail.gmail.com>
	<AANLkTin_jm9mwqNcrHyVFG+s=VDqbBMw-ZO3V4MLfhV6@mail.gmail.com>
Message-ID: <AANLkTikDB=fXd2RWPxd8pw3dah+urQbmOWUGq3zM_mpO@mail.gmail.com>

@Brian: Sorry, I realized a little bit too late that you are also
involved in developing DEoptim. Thanks a lot for this great tool!

@Daniel: Thanks :-)

2011/1/24 Daniel Cegie?ka <daniel.cegielka at gmail.com>:
>
>
> 2011/1/24 Lui ## <lui.r.project at googlemail.com>
>>
>> First of all: Thank you very much everybody for the vast number of
>> replies! I really appreciate your help! I didn't expect so many
>> responses!
>>
>> @ Guillaume Yziquel: Thank you very much for your quick responses and
>> keeping track of the answers! I have to admit that I know very little
>> about SDPs, so please excuse my stupid question: am I able to solve
>> the Markowitz portfolio (at given risk, so w x Cov x w' with target
>> function w x E(r)) ? Especially when my covariance matrix is changing
>> and I need to have an optimizer that just uses the vektor E(r) and the
>> matrix (Cov) as Input. Is that still possible when the my target
>> function (maximize) is also in a quadratic form ( e.g. w x MATRIX x w)
>> - without having to transform the problem manually? Thanks again for
>> your great help!
>>
>> @ Daniel & Dave: Thank you very much for your links! The paper is
>> really great and I have already started implementing the DE
>> algorithm...
>
> DEoptim is co-developed by Brian,?so he is probably one of the first person
> we should send our?THX :)
> best regards,
> daniel
>
>>
>> Do you have any experience with the parameters with
>> respect to PF optimization? The portfolio I am looking at is quite
>> large (400+ stocks) and the algorithm is converging quite slowly (e.g.
>> for the minimum risk portfolio). I tried NP = 6000, iterations at
>> 2000.
>>
>> @Pat: Thank you very much for the link! I will take a look at it after
>> "playing around with GAs and DEs a little". The reason is that I
>> currently have a quadratic program and quadratic constraints but the
>> constraints might become a little bit "ugly" (hold portfolio turnover
>> in a certain range, assets from certain asset classes should only have
>> a certain weight,...), so I want to be a little bit flexible...
>>
>> @Brian: I actually had troubles finding a solver for quadratic
>> problems and quadratic constraints. I think quadprog was intended for
>> quadratic problems with linear constraints or am I mistaken? I tried
>> to get Rscop run but had problems installing the library. The solvers
>> for linear problems and quadratic constraints as described in the
>> fPortfolio package did not work out the way I wanted them either
>> (there were some threads in R-Sig-Finance on that topic... But as my
>> constraints will probably get more complex, or I will want to try out
>> new ideas quickly I think I will go with the GAs/DEs first (unless you
>> have a good recommendation for a flexible / easy to modify solver that
>> is even aimed a little at portfolio problems
>>
>> @Ulrich: Thanks for the link! I see that genoud was used here - do you
>> have any suggestions in terms of penalty functions for portfolio
>> problems?
>>
>>
>> Just to give you an overview on what I am trying to achieve:
>>
>> I am working on an investment strategy and want to compare it to
>> Markowitz (with the risk level being the same...) Therefore I am
>> currently trying implement Markowitz with GAs or Deoptim. I found
>> going the "dirty" way in solving min w x Cov x w' with a target return
>> saves me the pain from quadratic constraints but leaves me with many
>> points on the efficient frontier to calculate - if I want to find an
>> optimal E(r) for a given sigma (which I currently find most suitable,
>> as both portfolios should have the same risk). That approach is not
>> very "lean" and nice. My investment strategy leaves me (in the
>> simplest form) with a quadratic problem (and the quadratic constraints
>> still remain - since I am interested in the Variance).
>> As there is lots of "try and try again" I appreciate the flexibility
>> of "more general complex problem solvers" as the problem may get more
>> complex with the constraints.
>>
>> I currently face the problem that the target sigma I want to achieve
>> is kind of far from what the algorithms give me... I suspect the
>> penalty function is the "problem". Do you have suggestions for good
>> penalty function?
>> I already "cut out" the sum(w) = 1 constraint by adding w <- w /
>> sum(w) (see DEoptim paper). Currently, my penalty function looks like
>> this:
>>
>> return <- return(w)
>> variance <- variance (w)
>>
>> penalty_faktor = 20
>> penalty <- max((variance - targetvariance)/targetvariance,0)
>>
>> if (((variance - targetvariance)/targetvariance) < 0.1){
>> ? ? ? ?penalty_faktor = 1
>> ? ? ? ?penalty = 0
>> ? ? ? ?}
>>
>>
>> ? ? ? ?ret <- ?(penalty*100)^penalty_faktor - return
>>
>> I dont care so much if the true variance is little bigger (10%) and
>> found if-then routines "spitting" out 99999 values if the constraints
>> are not met to be very inefficient... If somebody has suggestions for
>> good penalty function - please let me know!
>>
>> Have a great weekend!
>> Lui
>> On Sun, Jan 23, 2011 at 5:32 PM, ArdiaD <david.ardia at unifr.ch> wrote:
>> > This might be of interest:
>> > http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1584905
>> > Regards
>> > Dave
>> >
>> > On 01/23/2011 11:23 PM, Ulrich Staudinger wrote:
>> >> Lui,
>> >>
>> >> you can also have a look at
>> >>
>> >> http://aqr.activequant.org/index.php/2010/08/genetically-optimizing-a-trading-system/for
>> >> inspiration on how to genetically optimize a trading system, whether
>> >> it's quadratic or not. It's just some snipplet but exemplifies it
>> >> pretty
>> >> well ...
>> >>
>> >> Regards,
>> >> Ulrich
>> >>
>> >>
>> >> On Sun, Jan 23, 2011 at 11:15 PM, Guillaume Yziquel <
>> >> guillaume.yziquel at citycable.ch> wrote:
>> >>
>> >>> Le Sunday 23 Jan 2011 ? ?15:56:40 (-0600), Brian G. Peterson a ??crit
>> >>> :
>> >>>> On Saturday, January 22, 2011 04:33:09 pm Lui ## wrote:
>> >>>>> Dear group,
>> >>>>>
>> >>>>> I was just wondering whether some of you have some experience with
>> >>>>> the
>> >>>>> package "rgenoud" which does provide genetic algorithms for complex
>> >>>>> optimization problems.
>> >>>> <...>
>> >>>>
>> >>>>> What is your general experience? Did you ever try solving the
>> >>>>> Markowitz portfolio with the rgenoud package?
>> >>>>> I know that there are good solvers around for the qudratic
>> >>>>> programming
>> >>>>> problem of the markowitz portfolio, but I want to go into a
>> >>>>> different
>> >>>>> direction which translates into a quadratic problem with quadratic
>> >>>>> constraints (and I havent found a good solver for that...).
>> >>>>>
>> >>>>> I am interested in your replies! Have a good weekend!
>> >>>> As others have already said, for a quadtratic problem with quadratic
>> >>>> constraints, there is an exact analytical solution.
>> >>> I wouldn't qualify dual interior point methods as an "exact" solution,
>> >>> but,
>> >>> yes, that's the basic idea: they're better suited for that.
>> >>>
>> >>>> In these cases, you will be much better off both from a performance
>> >>>> and
>> >>>> accuracy perspective in using a quadratic solver (quadprog is most
>> >>>> often
>> >>>> applied in R, see list archives and many packages for examples).
>> >>> Is quadprog a second-order cone programming solver? If that is the
>> >>> case,
>> >>> yes, it probably solves quadratic objective function with quadratic
>> >>> constraints faster and with more accuracy than a full-fledged SDP
>> >>> solver.
>> >>>
>> >>>> Other portfolio problems may be stated in terms of linear solvers,
>> >>>> which
>> >>> will
>> >>>> likewise be faster than a global optimizer for finding an exact
>> >>> analytical
>> >>>> solution.
>> >>>>
>> >>>> If, however, your portfolio problem is non-convex and non-smooth,
>> >>>> then a
>> >>>> genetic algorithm, a migration algorithm, grid search, or random
>> >>> portfolios
>> >>>> may be a good option for finding a near-optimal portfolio. ?If this
>> >>>> is
>> >>> your
>> >>>> true goal, perhaps you can say a little more about your actual
>> >>> constraints and
>> >>>> objectives (and use assets that are outside of your true area of
>> >>> interest,
>> >>>> such as the S&P sector indices).
>> >>> Yes, the problem structure often gives good insight as to which method
>> >>> to apply. It may be noted, however, that quite a lot of non-convex
>> >>> problems may be transformed into convex ones. And using some
>> >>> relaxation
>> >>> methods, you can often use SDPs to optimise multivariate polynomial
>> >>> objective under multivariate polynomial constraints, without too many
>> >>> convexity hypothesis.
>> >>>
>> >>> SDPs are not always easy to manipulate, but they do solve a broad
>> >>> range
>> >>> of optimisation problems.
>> >>>
>> >>>> Regards,
>> >>>>
>> >>>> ? - Brian
>> >>> Best regards,
>> >>>
>> >>> --
>> >>> ? ? Guillaume Yziquel
>> >>> http://yziquel.homelinux.org
>> >>>
>> >>> _______________________________________________
>> >>> R-SIG-Finance at r-project.org mailing list
>> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >>> -- Subscriber-posting only. If you want to post, subscribe first.
>> >>> -- Also note that this is not the r-help list where general R
>> >>> questions
>> >>> should go.
>> >>>
>> >>
>> >>
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>> >
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
>


From lui.r.project at googlemail.com  Mon Jan 24 15:47:41 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Mon, 24 Jan 2011 09:47:41 -0500
Subject: [R-SIG-Finance] Genetic Algorithms & Portfolio Optimization
In-Reply-To: <20110124125541.GE4195@localhost>
References: <AANLkTimjw2_CPE71pA+up+BwDuAOiTKiQPxDcHjB14CK@mail.gmail.com>
	<20110122225235.GQ4195@localhost>
	<AANLkTin4kUpP24VXUxhaZ472DhxUZ04kvcP9PriO0smb@mail.gmail.com>
	<20110123141621.GJ4195@localhost> <20110124125541.GE4195@localhost>
Message-ID: <AANLkTin5XqrypHT6Hb0CEBz0yc6VG9q6Z3yVsnASiTzo@mail.gmail.com>

Dear Guillaume Yziquel,

thank you very much again for your long answer! I will try how far I get :-)
I am not working for professional purposes on it, only for academic
(unfortunately ;-) )... I'm currently writing my master thesis.
Thank you very much again!
Have a nice sunday!

Lui

On Mon, Jan 24, 2011 at 7:55 AM, Guillaume Yziquel
<guillaume.yziquel at citycable.ch> wrote:
> Le Sunday 23 Jan 2011 ? 15:16:21 (+0100), Guillaume Yziquel a ?crit :
>> Le Saturday 22 Jan 2011 ? 22:20:15 (-0500), Lui ## a ?crit :
>>
>> Are you doing this for professional purposes?
>
> Didn't get an answer to this question, by the way.
>
> --
> ? ? Guillaume Yziquel
> http://yziquel.homelinux.org
>


From matthieu.stigler at gmail.com  Mon Jan 24 17:51:02 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Mon, 24 Jan 2011 17:51:02 +0100
Subject: [R-SIG-Finance] zoo plot without box?
Message-ID: <4D3DADF6.3000604@gmail.com>

Hi

I'm trying to create a zoo plot without the box surrounding it. If it 
was a simple data, I woudl do:
plot(1:100, bty="n")

but with zoo, the argument bty does not seem to work?
library(zoo)
plot(zoo(1:100), bty="n")

I thought nervertheless that par arguments are allowed in plot.zoo... 
Any idea about a workaround?

Thanks!!

Matthieu


From ggrothendieck at gmail.com  Mon Jan 24 18:15:08 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 24 Jan 2011 12:15:08 -0500
Subject: [R-SIG-Finance] zoo plot without box?
In-Reply-To: <4D3DADF6.3000604@gmail.com>
References: <4D3DADF6.3000604@gmail.com>
Message-ID: <AANLkTikBxo5xM2vQR+692Tb5xMj17Ys9TCwSPiV-vvB3@mail.gmail.com>

On Mon, Jan 24, 2011 at 11:51 AM, Matthieu Stigler
<matthieu.stigler at gmail.com> wrote:
> Hi
>
> I'm trying to create a zoo plot without the box surrounding it. If it was a
> simple data, I woudl do:
> plot(1:100, bty="n")
>
> but with zoo, the argument bty does not seem to work?
> library(zoo)
> plot(zoo(1:100), bty="n")
>
> I thought nervertheless that par arguments are allowed in plot.zoo... Any
> idea about a workaround?
>

That's a bug. Try the development version.

library(zoo)
source("http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/zoo/R/plot.zoo.R?revision=822&root=zoo")
plot(zoo(1:100), bty = "n")


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From pierrelap at gmail.com  Mon Jan 24 18:22:37 2011
From: pierrelap at gmail.com (Pierre Lapointe)
Date: Mon, 24 Jan 2011 12:22:37 -0500
Subject: [R-SIG-Finance] zoo plot without box?
In-Reply-To: <AANLkTikBxo5xM2vQR+692Tb5xMj17Ys9TCwSPiV-vvB3@mail.gmail.com>
References: <4D3DADF6.3000604@gmail.com>
	<AANLkTikBxo5xM2vQR+692Tb5xMj17Ys9TCwSPiV-vvB3@mail.gmail.com>
Message-ID: <AANLkTi=H1DnMtfXYmMbT-XTTfa7GHT-whvcyUTrxEweF@mail.gmail.com>

Or you could change you par(),

library(zoo)
opar <-par() #put original settings in memory
par(bty="n")
plot(zoo(1:100))
par(opar) #go back to original par



On Mon, Jan 24, 2011 at 12:15 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Mon, Jan 24, 2011 at 11:51 AM, Matthieu Stigler
> <matthieu.stigler at gmail.com> wrote:
>> Hi
>>
>> I'm trying to create a zoo plot without the box surrounding it. If it was a
>> simple data, I woudl do:
>> plot(1:100, bty="n")
>>
>> but with zoo, the argument bty does not seem to work?
>> library(zoo)
>> plot(zoo(1:100), bty="n")
>>
>> I thought nervertheless that par arguments are allowed in plot.zoo... Any
>> idea about a workaround?
>>
>
> That's a bug. Try the development version.
>
> library(zoo)
> source("http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/zoo/R/plot.zoo.R?revision=822&root=zoo")
> plot(zoo(1:100), bty = "n")
>
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From matthieu.stigler at gmail.com  Mon Jan 24 18:26:55 2011
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Mon, 24 Jan 2011 18:26:55 +0100
Subject: [R-SIG-Finance] [Solved] Re:  zoo plot without box?
In-Reply-To: <AANLkTi=H1DnMtfXYmMbT-XTTfa7GHT-whvcyUTrxEweF@mail.gmail.com>
References: <4D3DADF6.3000604@gmail.com>	<AANLkTikBxo5xM2vQR+692Tb5xMj17Ys9TCwSPiV-vvB3@mail.gmail.com>
	<AANLkTi=H1DnMtfXYmMbT-XTTfa7GHT-whvcyUTrxEweF@mail.gmail.com>
Message-ID: <4D3DB65F.9070503@gmail.com>

Hello

Thanks Gabor for the info about newer version, and thanks Pierre for the 
workaround!!

matthieu

Le 24. 01. 11 18:22, Pierre Lapointe a ?crit :
> Or you could change you par(),
>
> library(zoo)
> opar<-par() #put original settings in memory
> par(bty="n")
> plot(zoo(1:100))
> par(opar) #go back to original par
>
>
>
> On Mon, Jan 24, 2011 at 12:15 PM, Gabor Grothendieck
> <ggrothendieck at gmail.com>  wrote:
>> On Mon, Jan 24, 2011 at 11:51 AM, Matthieu Stigler
>> <matthieu.stigler at gmail.com>  wrote:
>>> Hi
>>>
>>> I'm trying to create a zoo plot without the box surrounding it. If it was a
>>> simple data, I woudl do:
>>> plot(1:100, bty="n")
>>>
>>> but with zoo, the argument bty does not seem to work?
>>> library(zoo)
>>> plot(zoo(1:100), bty="n")
>>>
>>> I thought nervertheless that par arguments are allowed in plot.zoo... Any
>>> idea about a workaround?
>>>
>> That's a bug. Try the development version.
>>
>> library(zoo)
>> source("http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/zoo/R/plot.zoo.R?revision=822&root=zoo")
>> plot(zoo(1:100), bty = "n")
>>
>>
>> --
>> Statistics&  Software Consulting
>> GKX Group, GKX Associates Inc.
>> tel: 1-877-GKX-GROUP
>> email: ggrothendieck at gmail.com
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>


From shekhardk at gmail.com  Mon Jan 24 18:48:26 2011
From: shekhardk at gmail.com (Shekhar Gupta)
Date: Mon, 24 Jan 2011 11:48:26 -0600
Subject: [R-SIG-Finance] Quantitative Researcher looking for a full-time job
	opportunity!!
Message-ID: <AANLkTi=nx4r5Torf8wH3pV0UA+br7ukbhCJpnBBw=WKq@mail.gmail.com>

Hi Everyone,

I have worked as a Quantitative Researcher and Trader before and am
now looking for a full-time job opportunity. I have strong programming
skills.
It would be great if anyone in this list can contact me about job
opportunities that they know of. I would really appreciate the help.

Thank you for your time.


From lui.r.project at googlemail.com  Mon Jan 24 19:58:04 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Mon, 24 Jan 2011 13:58:04 -0500
Subject: [R-SIG-Finance] [R] Find the sign
In-Reply-To: <201101241927.30889.Rainer.Schuermann@gmx.net>
References: <924459.23638.qm@web120109.mail.ne1.yahoo.com>
	<201101241927.30889.Rainer.Schuermann@gmx.net>
Message-ID: <AANLkTikhMnkCxyW9hHZG4LxJTwMQ=t9zSY2hOBqkszRj@mail.gmail.com>

...or
if( (x*y) > 0 ){ }

Regards
Lui

On Mon, Jan 24, 2011 at 1:27 PM, Rainer Schuermann
<Rainer.Schuermann at gmx.net> wrote:
> On Monday, January 24, 2011 07:18:03 pm Alaios wrote:
>> Hello :)
>> I wanted to right an expression to check when x and y have the same sign
>> and I wrote the following:
>>
>> ?if ((x<0 && y<0) || (x>0 && y>0))
>>
>> which looks pretty ugly to me.
>>
>> Can you please suggest me a better way for that?
>>
>> Regards
>> Alex
>>
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>
> if( sign( x ) == sign( y ) )
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From curt at hagenlocher.org  Mon Jan 24 20:15:39 2011
From: curt at hagenlocher.org (Curt Hagenlocher)
Date: Mon, 24 Jan 2011 11:15:39 -0800
Subject: [R-SIG-Finance] [R] Find the sign
In-Reply-To: <AANLkTikhMnkCxyW9hHZG4LxJTwMQ=t9zSY2hOBqkszRj@mail.gmail.com>
References: <924459.23638.qm@web120109.mail.ne1.yahoo.com>
	<201101241927.30889.Rainer.Schuermann@gmx.net>
	<AANLkTikhMnkCxyW9hHZG4LxJTwMQ=t9zSY2hOBqkszRj@mail.gmail.com>
Message-ID: <AANLkTimCoLqGwsaMfisNwbHMUTa-sAtzNK0=d7XCBAwx@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110124/0ad4e9a6/attachment.pl>

From salmajj at softhome.net  Mon Jan 24 20:18:19 2011
From: salmajj at softhome.net (salmajj)
Date: Mon, 24 Jan 2011 11:18:19 -0800 (PST)
Subject: [R-SIG-Finance] Copula and Multivariate distribution
In-Reply-To: <AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>
References: <1295470206311-3225448.post@n4.nabble.com>
	<AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>
Message-ID: <1295896699022-3234744.post@n4.nabble.com>


Hi Christophe,
thanks a lot for your response,
Actually i do not well understand this point "apply eqf on each marginal" !
please could you give me more insight?
-- 
View this message in context: http://r.789695.n4.nabble.com/Copula-and-Multivariate-distribution-tp3225448p3234744.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From neil.gup at gmail.com  Mon Jan 24 20:27:44 2011
From: neil.gup at gmail.com (Neil Gupta)
Date: Mon, 24 Jan 2011 13:27:44 -0600
Subject: [R-SIG-Finance] Finding Correlation on Spreads
Message-ID: <AANLkTimeZGGT8uk4RgZ+RaQe-2GnVccN0J9CURB7G=RN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110124/526192d1/attachment.pl>

From andres.susrud at gmail.com  Mon Jan 24 20:39:40 2011
From: andres.susrud at gmail.com (Andres Susrud)
Date: Mon, 24 Jan 2011 20:39:40 +0100
Subject: [R-SIG-Finance] R to common lisp translator
Message-ID: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110124/63538fe3/attachment.pl>

From paulteetor at yahoo.com  Mon Jan 24 23:34:40 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Mon, 24 Jan 2011 14:34:40 -0800 (PST)
Subject: [R-SIG-Finance] R to common lisp translator
In-Reply-To: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
Message-ID: <868024.12401.qm@web56008.mail.re3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110124/20233867/attachment.pl>

From lui.r.project at googlemail.com  Tue Jan 25 06:28:42 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Tue, 25 Jan 2011 00:28:42 -0500
Subject: [R-SIG-Finance] [R] Defining an objective function in fPortfolio
In-Reply-To: <AANLkTikeua-fWUyq8CqKTf2Kiw3Mf13hTm3L2zgHns9S@mail.gmail.com>
References: <AANLkTikeua-fWUyq8CqKTf2Kiw3Mf13hTm3L2zgHns9S@mail.gmail.com>
Message-ID: <AANLkTikfksJDpmh0qvhcj08F5JX9Q4fkV12JjXz2v+fn@mail.gmail.com>

Hello Felipe,

I am not an expert in fPortfolio, so I can't tell you with 100%
certainty if its working or not. I tried for a while and didn't get it
running with the portfolio package. Maximizing the return is more
complex than the min Variance program...

I have two suggestions:

1. Create efficient frontier (with lets say 1000 or 2000 points) and
then determine a portfolio on that frontier which is closest to your
target sigma. The function could be

portspec <- portfolioSpec()
setNFrontierPoints (portspec) <- 2000
portfolio <- portfolioFrontier(DATA,portspec,"LongOnly")

Remember that you don't want to end up in the lower branch... :-)

2. Solve it with a heuristic (e.g. DEoptim - see my last thread). But
I just started using it.

Lui


On Mon, Jan 24, 2011 at 10:52 PM, Luis Felipe Parra
<felipe.parra at quantil.com.co> wrote:
> Hello I am using the fPortfolio package and I see there is the option in the
> model slot "objRisk" which permits the user to define its own objective
> function. I have the ebook Portfolio Optimization with Rmetrics and there it
> says examples on this option are on the advanced version of the book, which
> I looked on the Rmetrics webpage and apparently it doesn't exist yet. Does
> anybody have an example or knows where can I find an example of the usage of
> this option. How can I define my own objective function to optimize? Thank
> you
>
> Felipe Parra*
> *
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From robert at sanctumfi.com  Tue Jan 25 14:15:25 2011
From: robert at sanctumfi.com (Robert Sams)
Date: Tue, 25 Jan 2011 13:15:25 -0000
Subject: [R-SIG-Finance] R to common lisp translator
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
Message-ID: <3ABD97F82224D64A81DB6860B40E506C8B8C1C@blommbergmds>

I think we can make an exception here. There are areas in finance where
one would like to use R but the performance of its interpreted execution
is too poor. I too would be interested to know if anyone on this list
has had success with R/CL translation, especially in the context of
computing on big time series. Anyone?

R

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Paul Teetor
Sent: 24 January 2011 22:35
To: Andres Susrud; r-sig-finance at stat.math.ethz.ch
Subject: Re: [R-SIG-Finance] R to common lisp translator

Andres,

Can you explain the connection between your question and finance?

With a question such as this, you may have better luck using the general
R-help 
mailing list.

Paul


 Paul Teetor, Elgin, IL  USA
http://quanttrader.info/public




________________________________
From: Andres Susrud <andres.susrud at gmail.com>
To: r-sig-finance at stat.math.ethz.ch
Sent: Mon, January 24, 2011 1:39:40 PM
Subject: [R-SIG-Finance] R to common lisp translator

Hi,

just a question regarding common lisp translator, anyone know of a
stable
translator?

http://dan.corlan.net/R_to_common_lisp_translator/

http://common-lisp.net/project/rcl/

http://common-lisp.net/project/rclg/

I found three sources.

Any experience with it?

    [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should 
go.

	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From andres.susrud at gmail.com  Tue Jan 25 15:16:25 2011
From: andres.susrud at gmail.com (Andres Susrud)
Date: Tue, 25 Jan 2011 15:16:25 +0100
Subject: [R-SIG-Finance] Fwd:  R to common lisp translator
In-Reply-To: <FCE0E99E-0AC0-42CF-8412-EE0541809765@gmail.com>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
	<FCE0E99E-0AC0-42CF-8412-EE0541809765@gmail.com>
Message-ID: <AANLkTim9qVJmyS4TGK-s0+f4HDBtJjreBAMjYGobOaQc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110125/3f6b6df2/attachment.pl>

From daniel.cegielka at gmail.com  Tue Jan 25 15:16:12 2011
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Tue, 25 Jan 2011 15:16:12 +0100
Subject: [R-SIG-Finance] R to common lisp translator
In-Reply-To: <3ABD97F82224D64A81DB6860B40E506C8B8C1C@blommbergmds>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
	<3ABD97F82224D64A81DB6860B40E506C8B8C1C@blommbergmds>
Message-ID: <AANLkTimFgSekHaxgP_-kdvgwDfGnYBXba8BRskXsM7_D@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110125/20c19c29/attachment.pl>

From david at revolutionanalytics.com  Tue Jan 25 16:31:32 2011
From: david at revolutionanalytics.com (David Smith)
Date: Tue, 25 Jan 2011 07:31:32 -0800
Subject: [R-SIG-Finance] Webinar on portfolio optimiziation,
 optimization and stability analysis with Rmetrics, Jan 26
Message-ID: <AANLkTins7vaV10GuQER9UDrdfrMjb0+pWEWiuKkk32Dh@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110125/8aac9078/attachment.pl>

From josh.m.ulrich at gmail.com  Tue Jan 25 16:53:48 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 25 Jan 2011 09:53:48 -0600
Subject: [R-SIG-Finance] Fwd: R to common lisp translator
In-Reply-To: <AANLkTim9qVJmyS4TGK-s0+f4HDBtJjreBAMjYGobOaQc@mail.gmail.com>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
	<FCE0E99E-0AC0-42CF-8412-EE0541809765@gmail.com>
	<AANLkTim9qVJmyS4TGK-s0+f4HDBtJjreBAMjYGobOaQc@mail.gmail.com>
Message-ID: <AANLkTimRkczJXMUvLKWi2haUv7oTsAq7RM11KzQSrd0b@mail.gmail.com>

Hi Andres,

On Tue, Jan 25, 2011 at 8:16 AM, Andres Susrud <andres.susrud at gmail.com> wrote:
> ---------- Forwarded message ----------
> From: Andres Susrud <andres.susrud at gmail.com>
> Date: Tue, Jan 25, 2011 at 12:21 AM
> Subject: Re: [R-SIG-Finance] R to common lisp translator
> To: Paul Teetor <paulteetor at yahoo.com>
>
>
> Hi,
>
> Sorry to be a bit general in my question. But my concern is regarding
> packages such as ibroker, quantmod, ttr etc.
>
> BR
>
> Andres
>

Your question on Nuclear Phynance indicates you're trying to increase
calculation speed.
http://www.nuclearphynance.com/Show%20Post.aspx?PostIDKey=148722

What bottlenecks are you running into?  Nearly all the heavy lifting
in quantmod, TTR, xts, etc. is done in C, so moving to LISP probably
wouldn't be much faster.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> On Jan 24, 2011, at 11:34 PM, Paul Teetor <paulteetor at yahoo.com> wrote:
>
> Andres,
>
> Can you explain the connection between your question and finance?
>
> With a question such as this, you may have better luck using the general
> R-help mailing list.
>
> Paul
>
>
> Paul Teetor, Elgin, IL USA
> <http://quanttrader.info/public>http://quanttrader.info/public
>
>
> ------------------------------
> *From:* Andres Susrud <andres.susrud at gmail.com>
> *To:* <r-sig-finance at stat.math.ethz.ch>r-sig-finance at stat.math.ethz.ch
> *Sent:* Mon, January 24, 2011 1:39:40 PM
> *Subject:* [R-SIG-Finance] R to common lisp translator
>
> Hi,
>
> just a question regarding common lisp translator, anyone know of a stable
> translator?
>
> <http://dan.corlan.net/R_to_common_lisp_translator/>
> http://dan.corlan.net/R_to_common_lisp_translator/
>
> <http://common-lisp.net/project/rcl/>http://common-lisp.net/project/rcl/
>
> <http://common-lisp.net/project/rclg/>http://common-lisp.net/project/rclg/
>
> I found three sources.
>
> Any experience with it?
>
> ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> <R-SIG-Finance at r-project.org>R-SIG-Finance at r-project.org mailing list
> <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From andres.susrud at gmail.com  Tue Jan 25 17:01:04 2011
From: andres.susrud at gmail.com (Andres Susrud)
Date: Tue, 25 Jan 2011 17:01:04 +0100
Subject: [R-SIG-Finance] Fwd: R to common lisp translator
In-Reply-To: <AANLkTimRkczJXMUvLKWi2haUv7oTsAq7RM11KzQSrd0b@mail.gmail.com>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
	<FCE0E99E-0AC0-42CF-8412-EE0541809765@gmail.com>
	<AANLkTim9qVJmyS4TGK-s0+f4HDBtJjreBAMjYGobOaQc@mail.gmail.com>
	<AANLkTimRkczJXMUvLKWi2haUv7oTsAq7RM11KzQSrd0b@mail.gmail.com>
Message-ID: <AANLkTim0_QQn67pOw8Ey+N18sS8h882j6bf3iY+UL2OV@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110125/73913733/attachment.pl>

From arun.kumar.saha at gmail.com  Tue Jan 25 17:04:37 2011
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Tue, 25 Jan 2011 08:04:37 -0800 (PST)
Subject: [R-SIG-Finance] Finding Correlation on Spreads
In-Reply-To: <AANLkTimeZGGT8uk4RgZ+RaQe-2GnVccN0J9CURB7G=RN@mail.gmail.com>
References: <AANLkTimeZGGT8uk4RgZ+RaQe-2GnVccN0J9CURB7G=RN@mail.gmail.com>
Message-ID: <1295971477183-3236416.post@n4.nabble.com>


In most case you might be calculating the correlation between that spread
which is stationary in nature (quite logical to assume the
stability/stationarity of a spread series) with some other price which may
often be realization from some unit root process. In such case you might
think the joint evolution of that bivariate system as a bivariate integrated
VAR process (with the maximum order of integration of that system is 1).
Assuming there is no co-movement exist between them, you need to take just
the 1st difference of the entire system i.e. you are differentiating once
both price and spread series. And estimate the correlation between them from
the estimated VCV matrix of the Residuals.

On the other way, if that spread is not actually just tradable then, you can
think that spread as a portfolio of 2 non-stationary asset series. Hence in
such case you will have a trivariate VAR system with all variables are
non-stationary, unlike the 1st case. Here again you can estimate the
required correlation from estimated VCV matrix (which is of order 3 now)
with little straightforward mathematics.

Hence if you think your problem of estimating correlation from a VAR system
perspective, your problem will become quite simplified.

HTH

_____________________________________________________

Arun Kumar Saha, FRM
QUANTITATIVE RISK AND HEDGE CONSULTING SPECIALIST
Visit me at: http://in.linkedin.com/in/ArunFRM
_____________________________________________________
-- 
View this message in context: http://r.789695.n4.nabble.com/Finding-Correlation-on-Spreads-tp3234774p3236416.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Tue Jan 25 17:09:41 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 25 Jan 2011 10:09:41 -0600
Subject: [R-SIG-Finance] Fwd: R to common lisp translator
In-Reply-To: <AANLkTim0_QQn67pOw8Ey+N18sS8h882j6bf3iY+UL2OV@mail.gmail.com>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>	<868024.12401.qm@web56008.mail.re3.yahoo.com>	<FCE0E99E-0AC0-42CF-8412-EE0541809765@gmail.com>	<AANLkTim9qVJmyS4TGK-s0+f4HDBtJjreBAMjYGobOaQc@mail.gmail.com>	<AANLkTimRkczJXMUvLKWi2haUv7oTsAq7RM11KzQSrd0b@mail.gmail.com>
	<AANLkTim0_QQn67pOw8Ey+N18sS8h882j6bf3iY+UL2OV@mail.gmail.com>
Message-ID: <4D3EF5C5.9040106@braverock.com>

On 01/25/2011 10:01 AM, Andres Susrud wrote:
> The bottlenecks is when running backtests for larger datasets.I'm also
> looking at some other functions that are updated for every new timestep.

We run backtests in R on complex indicators on tick data where the 
indicator updates every tick.  These complete backtests, including the 
path dependent trade generation rules run (for us) in seconds to a few 
minutes per day of tick data per instrument.  All our code is R (mostly) 
or C/C++ (either implied, like with TTR, or specific to our proprietary 
indicators).

> for(i in 1:length(dataset)){
> function(dataset[1:i])}

This is a known performance bottleneck in R, and there is quite a lot of 
literature about either reworking this to a vectorized formulation, or 
moving such calculations which *must* be looped to C, Fortran, Java, or 
C++ (for which good integration options already exist in R).


> When generating BM's also for comparisons, I also find the speed in R a bit
> slow, and that's why I'm looking for the bridge that gives more speed.

R-help would be a better place to see if people are doing Lisp in R in 
any repeatable, scalable, manner.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From lui.r.project at googlemail.com  Tue Jan 25 17:16:59 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Tue, 25 Jan 2011 11:16:59 -0500
Subject: [R-SIG-Finance] [R] Problems plotting the efficient frontier
	with fPortfolio
In-Reply-To: <AANLkTikHQKEVb3_7KesRTFyPQeGajTNK5Qg6CVCPsQK8@mail.gmail.com>
References: <AANLkTikHQKEVb3_7KesRTFyPQeGajTNK5Qg6CVCPsQK8@mail.gmail.com>
Message-ID: <AANLkTi=M75Q8DVcm3rFed8Kk8axop6-SEFrJH2xiyy=X@mail.gmail.com>

Hello Felipe,

again, I am not a great expert with fPortfolio, but I think the
problem lies in your Dataset (not the numbers themselves, but the
structure of the dataset - eg. colnames, rownames,...) Did you try
building the efficient portfolio with a sample set of data that works
(e.g. with the sample data provided in the fPortfolio package)? I
would use print(Data[1:10,1:10]) to check what the data looks like in
both cases and then see whether the problem lies there. I would also
suggest just using parts of your data (maybe there are some missing
rows,... in between that cause trouble) - you can then locate the
problem more efficient.
Good luck!

Lui


On Tue, Jan 25, 2011 at 3:46 AM, Luis Felipe Parra
<felipe.parra at quantil.com.co> wrote:
> Hello, I have some simulations of financial data, I have 17 variables
> simulated 1000 times to three horizons. I am tring to plot the efficient
> frontier which I already obtained ?using th fPortfolio package. I am using
> the following commands:
>
> Data=timeSeries(X[1,,])
> lppSpec <- portfolioSpec()
> longFrontier <- portfolioFrontier(Data, lppSpec)
> plot(longFrontier)
> Selecci?n: 1
> Error en dimnames(x) <- dn :
> ?la longitud de 'dimnames' [1] no es igual a la extensi?n del arreglo
>> tailoredFrontierPlot(object = longFrontier, mText = "MV Portfolio -
> LongOnlyConstraints",risk = "Cov")
> Error en dimnames(x) <- dn :
> ?la longitud de 'dimnames' [1] no es igual a la extensi?n del arreglo
>
> and getting the error that appears. I also tried to do the same with the
> same data changing the solver to "solveRshortExact" and using the "Short"
> constraints and got the same error. Does anybody know what might be going
> on? Thank you
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>


From djsamperi at gmail.com  Tue Jan 25 17:17:45 2011
From: djsamperi at gmail.com (Dominick Samperi)
Date: Tue, 25 Jan 2011 11:17:45 -0500
Subject: [R-SIG-Finance] R to common lisp translator
In-Reply-To: <3ABD97F82224D64A81DB6860B40E506C8B8C1C@blommbergmds>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
	<3ABD97F82224D64A81DB6860B40E506C8B8C1C@blommbergmds>
Message-ID: <AANLkTi=4P_qvH8VUQAyeHb4YeRC7dPjhRu3gspiO4gju@mail.gmail.com>

On Tue, Jan 25, 2011 at 8:15 AM, Robert Sams <robert at sanctumfi.com> wrote:
> I think we can make an exception here. There are areas in finance where
> one would like to use R but the performance of its interpreted execution
> is too poor. I too would be interested to know if anyone on this list
> has had success with R/CL translation, especially in the context of
> computing on big time series. Anyone?

The paper by Ross Ihaka and Duncan Temple Lang titled "Back to the
Future: Lisp as a Base for a Statistical Computing System" discusses
building a new foundation for R on top of Common Lisp, but I don't know
if any work is being done in this direction. The idea is to leverage the
progress that has been made in the Common Lisp community while
maintaining much of the syntax and convenience of R.

But as has been pointed out in this thread, if most of the work is
already being done in C, then this will not help much.

Dominick

>
> R
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org
> [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Paul Teetor
> Sent: 24 January 2011 22:35
> To: Andres Susrud; r-sig-finance at stat.math.ethz.ch
> Subject: Re: [R-SIG-Finance] R to common lisp translator
>
> Andres,
>
> Can you explain the connection between your question and finance?
>
> With a question such as this, you may have better luck using the general
> R-help
> mailing list.
>
> Paul
>
>
> ?Paul Teetor, Elgin, IL ?USA
> http://quanttrader.info/public
>
>
>
>
> ________________________________
> From: Andres Susrud <andres.susrud at gmail.com>
> To: r-sig-finance at stat.math.ethz.ch
> Sent: Mon, January 24, 2011 1:39:40 PM
> Subject: [R-SIG-Finance] R to common lisp translator
>
> Hi,
>
> just a question regarding common lisp translator, anyone know of a
> stable
> translator?
>
> http://dan.corlan.net/R_to_common_lisp_translator/
>
> http://common-lisp.net/project/rcl/
>
> http://common-lisp.net/project/rclg/
>
> I found three sources.
>
> Any experience with it?
>
> ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should
> go.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From jeffrey.ryan at lemnica.com  Tue Jan 25 18:08:00 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 25 Jan 2011 11:08:00 -0600
Subject: [R-SIG-Finance] Fwd: R to common lisp translator
In-Reply-To: <4D3EF5C5.9040106@braverock.com>
References: <AANLkTi=uqV9Hw5AjpJ2bDkazrb1SkVRzZKVeObWc4WQL@mail.gmail.com>
	<868024.12401.qm@web56008.mail.re3.yahoo.com>
	<FCE0E99E-0AC0-42CF-8412-EE0541809765@gmail.com>
	<AANLkTim9qVJmyS4TGK-s0+f4HDBtJjreBAMjYGobOaQc@mail.gmail.com>
	<AANLkTimRkczJXMUvLKWi2haUv7oTsAq7RM11KzQSrd0b@mail.gmail.com>
	<AANLkTim0_QQn67pOw8Ey+N18sS8h882j6bf3iY+UL2OV@mail.gmail.com>
	<4D3EF5C5.9040106@braverock.com>
Message-ID: <AANLkTin7KW3SjZh-BE54eE-vyNo4E-ULB2zsP2ri70ft@mail.gmail.com>

One aside that Brian didn't mention is that 'quantstrat' (on R-forge,
and discussed heavily on this list) is making serious strides in
getting the backtesting times down.  Coupled with further xts
optimizations we've been making you are able to do many orders of
magnitude better than na?ve loops in R.

Vectorizing code isn't easy, but it generally means you are running in
C at that point.  One of the critical issues about 'faster than R' is
that you are going to miss 'R'.  You could code the fastest
implementation in Fortran, but are you "able to" really ---  from top
to bottom?  Fortran is the extreme case, but LISP is pretty close in
terms of nowhere near complete.  Plus you'll suffer from miserable
adoption rates - no offense to the language or its enthusiasts (I am
one), but if it hasn't met with success yet... I'm not putting much
money or time into it.

Use R for prototyping, spool up some more machines to backtest if need
be, and if you really need to, write some faster bits in
C/C++/Fortran2003 ;-).  The idea of xts 'speed at all costs' is to
make the bits we all use over and over as fast as possible, and to let
the R-based logic have a bit more breathing room.

Migrating to another language in search of the holy grail of speed
isn't probably the best route at the end of the day.

My 2c,
Jeff



On Tue, Jan 25, 2011 at 10:09 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 01/25/2011 10:01 AM, Andres Susrud wrote:
>>
>> The bottlenecks is when running backtests for larger datasets.I'm also
>> looking at some other functions that are updated for every new timestep.
>
> We run backtests in R on complex indicators on tick data where the indicator
> updates every tick. ?These complete backtests, including the path dependent
> trade generation rules run (for us) in seconds to a few minutes per day of
> tick data per instrument. ?All our code is R (mostly) or C/C++ (either
> implied, like with TTR, or specific to our proprietary indicators).
>
>> for(i in 1:length(dataset)){
>> function(dataset[1:i])}
>
> This is a known performance bottleneck in R, and there is quite a lot of
> literature about either reworking this to a vectorized formulation, or
> moving such calculations which *must* be looped to C, Fortran, Java, or C++
> (for which good integration options already exist in R).
>
>
>> When generating BM's also for comparisons, I also find the speed in R a
>> bit
>> slow, and that's why I'm looking for the bridge that gives more speed.
>
> R-help would be a better place to see if people are doing Lisp in R in any
> repeatable, scalable, manner.
>
> Regards,
>
> ? - Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From stephen at organicfoodmarkets.com.au  Tue Jan 25 21:54:39 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 26 Jan 2011 07:54:39 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D3CB144.3090402@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
	<4D2C4FA5.2020304@braverock.com>
	<4D2EC7A5.80808@organicfoodmarkets.com.au>
	<4D2F0112.2020206@braverock.com>
	<4D2F7F72.60208@organicfoodmarkets.com.au>
	<4D332470.7080305@braverock.com>
	<4D33498F.70705@organicfoodmarkets.com.au>
	<4D334FFA.7060908@braverock.com>
	<4D335C67.1010400@organicfoodmarkets.com.au>
	<4D34C4B6.3050703@organicfoodmarkets.com.au>
	<4D365F37.6020608@organicfoodmarkets.com.au>
	<4D36E08B.9000000@braverock.com>
	<4D373600.9010101@organicfoodmarkets.com.au>
	<4D3CB144.3090402@organicfoodmarkets.com.au>
Message-ID: <4D3F388F.3010209@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110126/0ffa169f/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: maCross-SPI.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110126/0ffa169f/attachment.pl>

From worik.stanton at gmail.com  Tue Jan 25 22:21:49 2011
From: worik.stanton at gmail.com (Worik)
Date: Wed, 26 Jan 2011 10:21:49 +1300
Subject: [R-SIG-Finance] Error in "blotter-package" example
Message-ID: <4D3F3EED.6000604@gmail.com>

I installed blotter


install.packages("blotter",repos="http://R-Forge.R-project.org")


R version 2.11.1

And when I ran the example from blotter-package I got the error \:

 > updatePortf(Portfolio="p",Dates='2007-01')
Error in .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  :
   could not find function "getPrice"

I thought this might be useful.   Is this the correct place to send such 
emails or should I send them direct to Brian or somewhere else?

cheers
Worik

-- 
If we amplify everything, we hear nothing.
--


From josh.m.ulrich at gmail.com  Tue Jan 25 22:27:48 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 25 Jan 2011 15:27:48 -0600
Subject: [R-SIG-Finance] Error in "blotter-package" example
In-Reply-To: <4D3F3EED.6000604@gmail.com>
References: <4D3F3EED.6000604@gmail.com>
Message-ID: <AANLkTinDoXxMb38nSU109kQUuD_59nGkeJ3iH+hN=fRu@mail.gmail.com>

getPrice doesn't exist in quantmod until 0.3-14.  Please update
quantmod manually.  I'll change the blotter DESCRIPTION file to
reflect the dependency.
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Tue, Jan 25, 2011 at 3:21 PM, Worik <worik.stanton at gmail.com> wrote:
> I installed blotter
>
>
> install.packages("blotter",repos="http://R-Forge.R-project.org")
>
>
> R version 2.11.1
>
> And when I ran the example from blotter-package I got the error \:
>
>> updatePortf(Portfolio="p",Dates='2007-01')
> Error in .updatePosPL(Portfolio = pname, Symbol = as.character(symbol), ?:
> ?could not find function "getPrice"
>
> I thought this might be useful. ? Is this the correct place to send such
> emails or should I send them direct to Brian or somewhere else?
>
> cheers
> Worik
>
> --
> If we amplify everything, we hear nothing.
> --
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From josh.m.ulrich at gmail.com  Tue Jan 25 22:58:59 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 25 Jan 2011 15:58:59 -0600
Subject: [R-SIG-Finance] Error in "blotter-package" example
In-Reply-To: <AANLkTinDoXxMb38nSU109kQUuD_59nGkeJ3iH+hN=fRu@mail.gmail.com>
References: <4D3F3EED.6000604@gmail.com>
	<AANLkTinDoXxMb38nSU109kQUuD_59nGkeJ3iH+hN=fRu@mail.gmail.com>
Message-ID: <AANLkTinFnWFWiqa8qSHs-3b6LvZx7oZvpkWYA3hO1ncf@mail.gmail.com>

On Tue, Jan 25, 2011 at 3:27 PM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> getPrice doesn't exist in quantmod until 0.3-14. ?Please update
> quantmod manually. ?I'll change the blotter DESCRIPTION file to
> reflect the dependency.

blotter already depends on quantmod_0.3-14.  R-forge only creates
binary builds for the most recent major version of R (2.12.x).  Since
you're using 2.11.1, I'm guessing you're building from source.
Apparently the dependency isn't being picked up for some reason.

> --
> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>
>
>
> On Tue, Jan 25, 2011 at 3:21 PM, Worik <worik.stanton at gmail.com> wrote:
>> I installed blotter
>>
>>
>> install.packages("blotter",repos="http://R-Forge.R-project.org")
>>
>>
>> R version 2.11.1
>>
>> And when I ran the example from blotter-package I got the error \:
>>
>>> updatePortf(Portfolio="p",Dates='2007-01')
>> Error in .updatePosPL(Portfolio = pname, Symbol = as.character(symbol), ?:
>> ?could not find function "getPrice"
>>
>> I thought this might be useful. ? Is this the correct place to send such
>> emails or should I send them direct to Brian or somewhere else?
>>
>> cheers
>> Worik
>>
>> --
>> If we amplify everything, we hear nothing.
>> --
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>


From jeffrey.ryan at lemnica.com  Wed Jan 26 00:07:14 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 25 Jan 2011 17:07:14 -0600
Subject: [R-SIG-Finance] Performance comparison xts v. zoo
In-Reply-To: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
References: <A34510F36803B84A982BD217A1F8F84204B6FC80@EPRI17P32005A.csfb.cs-group.com>
Message-ID: <AANLkTim9g9zLFXKW+pqhyHU=FwTRrvK=zgbD9u1cfBFm@mail.gmail.com>

Hi Ryan,

Sorry for the late reply.

The slides you are thinking about are from a talk I gave at Columbia
back in 2008, so they are a bit outdated.

http://www.quantmod.com/Columbia2008/ColumbiaDec4.pdf

In general, xts has gotten substantially faster since then.  Some
things in xts are now even faster than using raw matrices for data.

x <- .xts(1:1e6L, 1:1e6L)
system.time( x[,1] )
   user  system elapsed
  0.002   0.000   0.002

m <- coredata(x) # a matrix, no 'time' index, so not really a time series
system.time( m[,1] )
   user  system elapsed
  0.015   0.000   0.015

I haven't put together a comparison in a while, but repeating the
benchmarks in the slides have xts with a substantial edge, often times
an order of magnitude better (even 2 or 3 orders of magnitude)

Most of the differences in xts vs. zoo come from the C in xts of
course.  But as Gabor noted, the effort is under way to move many of
the core C functions back up into zoo.  The limits here are that while
xts and zoo are very, very compatible - some xts functionality differs
- and we can't realistically break anything in zoo in the process.
The other limit is with respect to time.  Some of the code is in zoo
already, though not 'switched on' yet. Subsetting and basic Ops are
really the primary target for the migration.

My 2c is that xts is as fast as it can be, as it is all highly
optimized C --- 10x faster than all the other ts classes at a minimum
--- but that zoo will be brought up to speed "soon". ;-)

The other part of xts is that it does make "development" speedier by
way of the ISO8601 subsetting and related to.period aggregation code.
Not sure if that counts for 'performance speed' as your original post
requests though.

Best,
Jeff

P.S. The timeSeries values in the slides are _much_ improved as of
current implementations - though still much slower than xts.

On Wed, Jan 19, 2011 at 7:08 AM, Sheftel, Ryan
<ryan.sheftel at credit-suisse.com> wrote:
>
> I am looking for a comparison of the performance speed between xts and
> zoo on time series. I remember once seeing this in a pdf document,
> perhaps a magazine article?, but after extensive google-ing I have come
> up blank.
>
> Any direction would be helpful before I reproduce the results myself.
> Thanks.
>
> ===============================================================================
> Please access the attached hyperlink for an important el...{{dropped:8}}
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From worik.stanton at gmail.com  Wed Jan 26 02:26:03 2011
From: worik.stanton at gmail.com (Worik)
Date: Wed, 26 Jan 2011 14:26:03 +1300
Subject: [R-SIG-Finance] Error in "blotter-package" example
In-Reply-To: <AANLkTinDoXxMb38nSU109kQUuD_59nGkeJ3iH+hN=fRu@mail.gmail.com>
References: <4D3F3EED.6000604@gmail.com>
	<AANLkTinDoXxMb38nSU109kQUuD_59nGkeJ3iH+hN=fRu@mail.gmail.com>
Message-ID: <4D3F782B.1080303@gmail.com>

On 26/01/11 10:27, Joshua Ulrich wrote:
>   Please update
> quantmod manually.
That did it

W

-- 
If we amplify everything, we hear nothing.
--


From alex.rudnev at gmail.com  Wed Jan 26 04:47:22 2011
From: alex.rudnev at gmail.com (Aleksandr Rudnev)
Date: Tue, 25 Jan 2011 22:47:22 -0500
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D3F388F.3010209@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
	<4D2C4FA5.2020304@braverock.com>
	<4D2EC7A5.80808@organicfoodmarkets.com.au>
	<4D2F0112.2020206@braverock.com>
	<4D2F7F72.60208@organicfoodmarkets.com.au>
	<4D332470.7080305@braverock.com>
	<4D33498F.70705@organicfoodmarkets.com.au>
	<4D334FFA.7060908@braverock.com>
	<4D335C67.1010400@organicfoodmarkets.com.au>
	<4D34C4B6.3050703@organicfoodmarkets.com.au>
	<4D365F37.6020608@organicfoodmarkets.com.au>
	<4D36E08B.9000000@braverock.com>
	<4D373600.9010101@organicfoodmarkets.com.au>
	<4D3CB144.3090402@organicfoodmarkets.com.au>
	<4D3F388F.3010209@organicfoodmarkets.com.au>
Message-ID: <AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>

On Tue, Jan 25, 2011 at 3:54 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
>
> ...
>
> The rules will be executed by type, in the order listed above.
> ...
> Has anyone got this problem and solved it?

I have seen similar thing, but never had time to trace it before today...

It seems like a defect in applyRules (if we take mentioned note as a
spec) or in add.rule, or in ruleOrderProc, depending on how you look
at it, but I guess authors will coment on that.
Basically, what's happening is that "rules" list in strategy?is
populated with lists of rules of different type, each of such lists
("order", "entry", "exit", etc) is created and added to "rules" when
add.rule is invoked first time for such type (lazy initialization). In
applyRules "rules" are iterated in order corresponding to how
different types of rules were added. In your case you start with
"enter" type, then add "exit".
Workaround would to first add "exit" rule(s), then "enter" rule(s).

To get better understanding you can do the following:

options(warn = 1)
trace(addOrder, quote(cat("addOrder(", qty, side,
as.character(timestamp), ")\n")), print = FALSE)

Then, when you run it, you get the following output, that shows that
"short enter" order is added first, followed by "long exit" order on
2008-01-22, which causes ruleOrderProc to skip that second order that
is supposed to be on long side, but has qty = -100 at the time when
current posQty = 0 after "short entry" order:
...
addOrder( 100 long 2003-06-12 )
[1] "2003-06-12 AXJO 100 @ 3084.8"
addOrder( -100 short 2008-01-22 )
addOrder( -100 long 2008-01-22 )
[1] "2008-01-22 AXJO -100 @ 5186.8"
Warning in ruleOrderProc(portfolio = portfolio, symbol = symbol,
mktdata = mktdata,  :
  orderQty of-100would cross through zero, reducing qty to0
Warning in ruleOrderProc(portfolio = portfolio, symbol = symbol,
mktdata = mktdata,  :
  orderQty of-100would cross through zero, reducing qty to0
addOrder( 100 long 2009-06-17 )
Warning in ruleOrderProc(portfolio = portfolio, symbol = symbol,
mktdata = mktdata,  :
  orderQty of-100would cross through zero, reducing qty to0
...

If you revert order of first two add.rule lines to have it as the following:

 stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal',
arguments = list(sigcol="shortMA.lt.longMA",sigval=TRUE,
orderqty=-100, ordertype='market', orderside='long', threshold=NULL,
replace=FALSE ),type='exit')
 stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal',
arguments = list(sigcol="shortMA.gt.longMA",sigval=TRUE, orderqty=100,
ordertype='market', orderside='long', threshold=NULL, replace=FALSE
),type='enter')


You most probably get what you expected:

...
addOrder( 100 long 2003-06-12 )
[1] "2003-06-12 AXJO 100 @ 3084.8"
addOrder( -100 long 2008-01-22 )
addOrder( -100 short 2008-01-22 )
[1] "2008-01-22 AXJO -100 @ 5186.8"
[1] "2008-01-22 AXJO -100 @ 5186.8"
addOrder( 100 short 2009-06-17 )
addOrder( 100 long 2009-06-17 )
[1] "2009-06-17 AXJO 100 @ 3904.1"
[1] "2009-06-17 AXJO 100 @ 3904.1"
...

Also, you probably want to init currency, as "AUD" is not default one
and causes additional warning and probably some errors in
calculations.

I guess in any case logic in ruleOrderProc that prevents crossing
through zero should be refined.

Regards,
--
Alexander Rudnev
Cell: 1 (202) 904 7569
E-Mail: alex.rudnev at gmail.com


From stephen at organicfoodmarkets.com.au  Wed Jan 26 07:52:44 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 26 Jan 2011 17:52:44 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2C4FA5.2020304@braverock.com>	<4D2EC7A5.80808@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>
	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
Message-ID: <4D3FC4BC.90106@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110126/0b2c1021/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110126/0b2c1021/attachment.jpe>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: maCross-SPI.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110126/0b2c1021/attachment.ksh>

From brian at braverock.com  Wed Jan 26 13:42:25 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 26 Jan 2011 06:42:25 -0600
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2C4FA5.2020304@braverock.com>	<4D2EC7A5.80808@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>
	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
Message-ID: <4D4016B1.6050707@braverock.com>

On 01/25/2011 09:47 PM, Aleksandr Rudnev wrote:
> On Tue, Jan 25, 2011 at 3:54 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>>
>> ...
>>
>> The rules will be executed by type, in the order listed above.
>> ...
>> Has anyone got this problem and solved it?
>
> I have seen similar thing, but never had time to trace it before today...
>
> It seems like a defect in applyRules (if we take mentioned note as a
> spec) or in add.rule, or in ruleOrderProc, depending on how you look
> at it, but I guess authors will comment on that.
> Basically, what's happening is that "rules" list in strategy is
> populated with lists of rules of different type, each of such lists
> ("order", "entry", "exit", etc) is created and added to "rules" when
> add.rule is invoked first time for such type (lazy initialization). In
> applyRules "rules" are iterated in order corresponding to how
> different types of rules were added. In your case you start with
> "enter" type, then add "exit".
> Workaround would to first add "exit" rule(s), then "enter" rule(s).

This is correct.  Thank You for the detailed examination of the code.

The lines in question in applyRules() are a loop around a switch:

l506 and following:

for ( type in names(strategy$rules)){
	switch( type ,

I'll need to think about an alternate formulation in applyRules() that 
would work the rule types in order as described in the documentation 
(which was our intent).

Any input on fixes gladly accepted.

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From atp at piskorski.com  Wed Jan 26 16:28:43 2011
From: atp at piskorski.com (Andrew Piskorski)
Date: Wed, 26 Jan 2011 10:28:43 -0500
Subject: [R-SIG-Finance] Lisp as a Base for a Statistical Computing System
In-Reply-To: <AANLkTi=3D4P_qvH8VUQAyeHb4YeRC7dPjhRu3gspiO4gju@mail.gmail.com>
References: <AANLkTi=3D4P_qvH8VUQAyeHb4YeRC7dPjhRu3gspiO4gju@mail.gmail.com>
Message-ID: <20110126152843.GA7451@piskorski.com>

On Tue, Jan 25, 2011 at 11:17:45AM -0500, Dominick Samperi wrote:
Subject: Re: [R-SIG-Finance] R to common lisp translator

> The paper by Ross Ihaka and Duncan Temple Lang titled "Back to the
> Future: Lisp as a Base for a Statistical Computing System" discusses
> building a new foundation for R on top of Common Lisp, but I don't know
> if any work is being done in this direction.

Btw, when I read that paper a few years ago, it was interesting, but
it also sounded a lot like its authors largely picked their solution
(Lisp) first, and then thought about how to justify it.  Lisp probably
WOULD be a pretty good base for building a next-generation R-like
tool, but their discussion of possible alternatives seemed quite
cursory, as did their "Backward's compatibility?" section.

  http://lambda-the-ultimate.org/node/3726

If I had both the time (a lot of time!) and a real mandate to do R&D
on something like that, I'd also look into LuaJIT, Erlang, and SciDB,
and think hard about what R problems I really want to solve and what I
could learn about solving them from those other tools.  However,
despite these criticisms, I do hope that Ihaka and Lang proceed
further with their ideas, and look forward to reading more about it.

Of course, this is all pretty much off topic...

For the original poster who sparked this thread:  Trying to speed up
your R code by auto-translating it to Lisp is a crazy, totally
impractical idea.  You are confusing someone's brief dead-end R&D
exploration with something you could actually use for real.  Profile
your R code and figure out what is really slowing it down, then
proceed from there.  There isn't any magic Lisp bullet to solve things
for you.

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/


From edd at debian.org  Wed Jan 26 16:51:23 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 26 Jan 2011 09:51:23 -0600
Subject: [R-SIG-Finance] Lisp as a Base for a Statistical Computing
	System
In-Reply-To: <20110126152843.GA7451@piskorski.com>
References: <AANLkTi=3D4P_qvH8VUQAyeHb4YeRC7dPjhRu3gspiO4gju@mail.gmail.com>
	<20110126152843.GA7451@piskorski.com>
Message-ID: <19776.17147.276909.462634@max.nulle.part>


On 26 January 2011 at 10:28, Andrew Piskorski wrote:
| On Tue, Jan 25, 2011 at 11:17:45AM -0500, Dominick Samperi wrote:
| Subject: Re: [R-SIG-Finance] R to common lisp translator
| 
| > The paper by Ross Ihaka and Duncan Temple Lang titled "Back to the
| > Future: Lisp as a Base for a Statistical Computing System" discusses
| > building a new foundation for R on top of Common Lisp, but I don't know
| > if any work is being done in this direction.
| 
| Btw, when I read that paper a few years ago, it was interesting, but
| it also sounded a lot like its authors largely picked their solution
| (Lisp) first, and then thought about how to justify it.  Lisp probably
| WOULD be a pretty good base for building a next-generation R-like
| tool, but their discussion of possible alternatives seemed quite
| cursory, as did their "Backward's compatibility?" section.
| 
|   http://lambda-the-ultimate.org/node/3726
| 
| If I had both the time (a lot of time!) and a real mandate to do R&D
| on something like that, I'd also look into LuaJIT, Erlang, and SciDB,
| and think hard about what R problems I really want to solve and what I
| could learn about solving them from those other tools.  However,
| despite these criticisms, I do hope that Ihaka and Lang proceed
| further with their ideas, and look forward to reading more about it.
| 
| Of course, this is all pretty much off topic...
| 
| For the original poster who sparked this thread:  Trying to speed up
| your R code by auto-translating it to Lisp is a crazy, totally
| impractical idea.  You are confusing someone's brief dead-end R&D
| exploration with something you could actually use for real.  Profile
| your R code and figure out what is really slowing it down, then
| proceed from there.  There isn't any magic Lisp bullet to solve things
| for you.

Well put.  I don't often feel the need for an old-fashioned AOL-style 'me
too' but this is one of those cases.

R gives you more analytical fire power than any other tool we know, and it
also gives you well-tested means to accelerate your code.  I gave a few
tutorials on introducing HPC with R that illustrate a some of those means.
Reimplementing in another language nobody on the street uses is not one of
them.

Dirk

| -- 
| Andrew Piskorski <atp at piskorski.com>
| http://www.piskorski.com/
| 
| _______________________________________________
| R-SIG-Finance at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From djsamperi at gmail.com  Thu Jan 27 00:53:12 2011
From: djsamperi at gmail.com (Dominick Samperi)
Date: Wed, 26 Jan 2011 18:53:12 -0500
Subject: [R-SIG-Finance] Lisp as a Base for a Statistical Computing
	System
In-Reply-To: <20110126152843.GA7451@piskorski.com>
References: <AANLkTi=3D4P_qvH8VUQAyeHb4YeRC7dPjhRu3gspiO4gju@mail.gmail.com>
	<20110126152843.GA7451@piskorski.com>
Message-ID: <AANLkTi=MdECVGA0Hc5rB4hQjFoR3n+EUsnFm5_CbB-Cy@mail.gmail.com>

On Wed, Jan 26, 2011 at 10:28 AM, Andrew Piskorski <atp at piskorski.com> wrote:
> On Tue, Jan 25, 2011 at 11:17:45AM -0500, Dominick Samperi wrote:
> Subject: Re: [R-SIG-Finance] R to common lisp translator
>
>> The paper by Ross Ihaka and Duncan Temple Lang titled "Back to the
>> Future: Lisp as a Base for a Statistical Computing System" discusses
>> building a new foundation for R on top of Common Lisp, but I don't know
>> if any work is being done in this direction.
>
> Btw, when I read that paper a few years ago, it was interesting, but
> it also sounded a lot like its authors largely picked their solution
> (Lisp) first, and then thought about how to justify it. ?Lisp probably
> WOULD be a pretty good base for building a next-generation R-like
> tool, but their discussion of possible alternatives seemed quite
> cursory, as did their "Backward's compatibility?" section.

The solution (Lisp/Scheme) was picked a long time ago and
led to what we call R today. At its core R is still Lisp-based,
with some optimizations like replacing lists with vectors. The
Lisp-based foundation is well-hidden by the R language, a kind
of syntactic sugar for Lisp (according to the original creators of R).

What this paper suggests is that statisticians (and Wall Street
quants) could spend more time solving problems if they didn't have
to spend so much time reinventing the wheel by building and
tweaking a home-grown Lisp-like platform.

They were arguing for an engine replacement, not for a new car.

Dominick

>
> ?http://lambda-the-ultimate.org/node/3726
>
> If I had both the time (a lot of time!) and a real mandate to do R&D
> on something like that, I'd also look into LuaJIT, Erlang, and SciDB,
> and think hard about what R problems I really want to solve and what I
> could learn about solving them from those other tools. ?However,
> despite these criticisms, I do hope that Ihaka and Lang proceed
> further with their ideas, and look forward to reading more about it.
>
> Of course, this is all pretty much off topic...
>
> For the original poster who sparked this thread: ?Trying to speed up
> your R code by auto-translating it to Lisp is a crazy, totally
> impractical idea. ?You are confusing someone's brief dead-end R&D
> exploration with something you could actually use for real. ?Profile
> your R code and figure out what is really slowing it down, then
> proceed from there. ?There isn't any magic Lisp bullet to solve things
> for you.
>
> --
> Andrew Piskorski <atp at piskorski.com>
> http://www.piskorski.com/
>


From lui.r.project at googlemail.com  Thu Jan 27 04:51:12 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Wed, 26 Jan 2011 22:51:12 -0500
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix D not
	positive definite
Message-ID: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>

Dear Group,

I have  a large set of stocks and want to determine the efficient
frontier. The data set covers approx. 1.5 years and S&P 500 companies
(nothing weird). portfolio.optim from the PerformanceAnalytics package
works very well and fast. However, whenever I decrease the number of
stocks in the portfolio (to 10 or 400), I receive an error message:

"solve.QP(Dmat, dvec, Amat, bvec = b0, meq = 2) :
  matrix D in quadratic function is not positive definite!"

My command settings for portfolio.optim were:

seed <- portfolio.optim(t(x), pm = current_er, riskless = FALSE,
shorts = FALSE, rf = 0.0)

Even when I tried it with shorts = TRUE the error would still remain.
x is the set of stocks (stocks in columns, time in rows), current_er
is the target return (lies between the minimal mean and the maximum
mean of a long only portfolio).
I can not post the stock data here - so maybe you have some general
suggestions for me of what could have gone wrong... The covariance
matrix is positive definite. What could cause the problem? It works
fine with the large data set but does not work at all with the small
one...
Thanks a lot for your suggestions!

Lui


From arun.kumar.saha at gmail.com  Thu Jan 27 05:30:40 2011
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Wed, 26 Jan 2011 20:30:40 -0800 (PST)
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix D
 not positive definite
In-Reply-To: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
References: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
Message-ID: <1296102640088-3241453.post@n4.nabble.com>


Hi Lui, I never worked with such kind of portfolio optimization problem but
in Risk management practice it often comes as estimated VCV matrix is not a
PD, hence it is not a truly VCV matrix. Root of this problem might be many,
most importantly, it is incomplete and inconsistent return values.

In such case, common practice is to disturb this estimated VCV matrix
slightly, so that you would get **nearest** VCV matrix which is PD. Here you
might be interested in:

http://eprints.ma.man.ac.uk/232/01/covered/MIMS_ep2006_70.pdf

Therefore I guess, what you need to do is perhaps debug the underlying codes
and do some reverse-engineering to modify the underlying matrix to a nearest
PD.

HTH

_____________________________________________________

Arun Kumar Saha, FRM
QUANTITATIVE RISK AND HEDGE CONSULTING SPECIALIST
Visit me at: http://in.linkedin.com/in/ArunFRM
_____________________________________________________
-- 
View this message in context: http://r.789695.n4.nabble.com/portfolio-optim-and-error-in-solve-QP-matrix-D-not-positive-definite-tp3241430p3241453.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From josh.m.ulrich at gmail.com  Thu Jan 27 16:55:24 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 27 Jan 2011 09:55:24 -0600
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D4016B1.6050707@braverock.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
	<4D2C4FA5.2020304@braverock.com>
	<4D2EC7A5.80808@organicfoodmarkets.com.au>
	<4D2F0112.2020206@braverock.com>
	<4D2F7F72.60208@organicfoodmarkets.com.au>
	<4D332470.7080305@braverock.com>
	<4D33498F.70705@organicfoodmarkets.com.au>
	<4D334FFA.7060908@braverock.com>
	<4D335C67.1010400@organicfoodmarkets.com.au>
	<4D34C4B6.3050703@organicfoodmarkets.com.au>
	<4D365F37.6020608@organicfoodmarkets.com.au>
	<4D36E08B.9000000@braverock.com>
	<4D373600.9010101@organicfoodmarkets.com.au>
	<4D3CB144.3090402@organicfoodmarkets.com.au>
	<4D3F388F.3010209@organicfoodmarkets.com.au>
	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
	<4D4016B1.6050707@braverock.com>
Message-ID: <AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>

On Wed, Jan 26, 2011 at 6:42 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 01/25/2011 09:47 PM, Aleksandr Rudnev wrote:
>>
>> On Tue, Jan 25, 2011 at 3:54 PM, Stephen Choularton
>> <stephen at organicfoodmarkets.com.au> ?wrote:
>>>
>>> ...
>>>
>>> The rules will be executed by type, in the order listed above.
>>> ...
>>> Has anyone got this problem and solved it?
>>
>> I have seen similar thing, but never had time to trace it before today...
>>
>> It seems like a defect in applyRules (if we take mentioned note as a
>> spec) or in add.rule, or in ruleOrderProc, depending on how you look
>> at it, but I guess authors will comment on that.
>> Basically, what's happening is that "rules" list in strategy is
>> populated with lists of rules of different type, each of such lists
>> ("order", "entry", "exit", etc) is created and added to "rules" when
>> add.rule is invoked first time for such type (lazy initialization). In
>> applyRules "rules" are iterated in order corresponding to how
>> different types of rules were added. In your case you start with
>> "enter" type, then add "exit".
>> Workaround would to first add "exit" rule(s), then "enter" rule(s).
>
> This is correct. ?Thank You for the detailed examination of the code.
>
I second that.  Aleksandr did most of the work, which made it very
easy to patch.

> The lines in question in applyRules() are a loop around a switch:
>
> l506 and following:
>
> for ( type in names(strategy$rules)){
> ? ? ? ?switch( type ,
>
> I'll need to think about an alternate formulation in applyRules() that would
> work the rule types in order as described in the documentation (which was
> our intent).
>
> Any input on fixes gladly accepted.
>
I've committed the patch below.  Rather than looping over
names(strategy$rules), I create a factor that will sort in the same
order as described in the documentation.  Obviously, if a new new rule
type is created, it must be added to this list.

types <- sort(factor(names(strategy$rules),
  levels=c("pre","risk","order","rebalance",
               "exit","enter","entry","post")))
for ( type in types ) {
  switch( type ,

The maCross demo now works correctly when the short rules are uncommented.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


> Regards,
>
> ?- Brian
>
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From gyollin at r-programming.org  Thu Jan 27 18:03:16 2011
From: gyollin at r-programming.org (Guy Yollin)
Date: Thu, 27 Jan 2011 09:03:16 -0800
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix D
 not positive definite
In-Reply-To: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
References: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
Message-ID: <4D41A554.8090906@r-programming.org>

Hi Lui,

Without seeing the data this is just speculation but...

Are you sure you want t(x)? If you're mixing up your observations versus 
your assets this may explain the error.

The first parameter of portfolio.optim (in the tseries package) is a 
returns matrix, one column for each asset and one row for each day 
(assuming daily returns).  If you have this wrong then for your small 
datasets you'd have more columns than rows and this could produce that 
error.

Also, you don't have to pass the entire returns matrix to 
portfolio.optim, you could pass just the covariance matrix you calculate 
yourself and a vector (1-row matrix) of mean returns as follows:


library(tseries)
set.seed(2)
R <- matrix(rnorm(100*10),nrow=100,ncol=10) # 10 assets, 100 observations
averet <- matrix(apply(R,2,mean),nrow=1)
rcov <- cov(R)
current_er <- 0.05
(op <- portfolio.optim(x=averet,pm=current_er,covmat=rcov,riskless = 
FALSE,shorts = FALSE, rf = 0.0))

Hope this helps.

Best,

Guy


On 1/26/2011 7:51 PM, Lui ## wrote:
> Dear Group,
>
> I have  a large set of stocks and want to determine the efficient
> frontier. The data set covers approx. 1.5 years and S&P 500 companies
> (nothing weird). portfolio.optim from the PerformanceAnalytics package
> works very well and fast. However, whenever I decrease the number of
> stocks in the portfolio (to 10 or 400), I receive an error message:
>
> "solve.QP(Dmat, dvec, Amat, bvec = b0, meq = 2) :
>    matrix D in quadratic function is not positive definite!"
>
> My command settings for portfolio.optim were:
>
> seed<- portfolio.optim(t(x), pm = current_er, riskless = FALSE,
> shorts = FALSE, rf = 0.0)
>
> Even when I tried it with shorts = TRUE the error would still remain.
> x is the set of stocks (stocks in columns, time in rows), current_er
> is the target return (lies between the minimal mean and the maximum
> mean of a long only portfolio).
> I can not post the stock data here - so maybe you have some general
> suggestions for me of what could have gone wrong... The covariance
> matrix is positive definite. What could cause the problem? It works
> fine with the large data set but does not work at all with the small
> one...
> Thanks a lot for your suggestions!
>
> Lui
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From stephen at organicfoodmarkets.com.au  Thu Jan 27 19:53:20 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Fri, 28 Jan 2011 05:53:20 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2C4FA5.2020304@braverock.com>	<4D2EC7A5.80808@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>	<4D4016B1.6050707@braverock.com>
	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>
Message-ID: <4D41BF20.9080303@organicfoodmarkets.com.au>

I note that the list

"pre","risk","order","rebalance",
                "exit","enter","entry","post"

Contains types that are not in the notes.  Can I find some further info 
on what they are for?

When Joshua says he has 'committed' the changes, does that mean if I 
download quadstrat the amendments will be incorporated in it?

And finally (for the moment ;-) thanks for the way you all have helped 
me solve my problems.

Stephen Choularton Ph.D., FIoD


On 28/01/2011 2:55 AM, Joshua Ulrich wrote:
> On Wed, Jan 26, 2011 at 6:42 AM, Brian G. Peterson<brian at braverock.com>  wrote:
>> On 01/25/2011 09:47 PM, Aleksandr Rudnev wrote:
>>> On Tue, Jan 25, 2011 at 3:54 PM, Stephen Choularton
>>> <stephen at organicfoodmarkets.com.au>    wrote:
>>>> ...
>>>>
>>>> The rules will be executed by type, in the order listed above.
>>>> ...
>>>> Has anyone got this problem and solved it?
>>> I have seen similar thing, but never had time to trace it before today...
>>>
>>> It seems like a defect in applyRules (if we take mentioned note as a
>>> spec) or in add.rule, or in ruleOrderProc, depending on how you look
>>> at it, but I guess authors will comment on that.
>>> Basically, what's happening is that "rules" list in strategy is
>>> populated with lists of rules of different type, each of such lists
>>> ("order", "entry", "exit", etc) is created and added to "rules" when
>>> add.rule is invoked first time for such type (lazy initialization). In
>>> applyRules "rules" are iterated in order corresponding to how
>>> different types of rules were added. In your case you start with
>>> "enter" type, then add "exit".
>>> Workaround would to first add "exit" rule(s), then "enter" rule(s).
>> This is correct.  Thank You for the detailed examination of the code.
>>
> I second that.  Aleksandr did most of the work, which made it very
> easy to patch.
>
>> The lines in question in applyRules() are a loop around a switch:
>>
>> l506 and following:
>>
>> for ( type in names(strategy$rules)){
>>         switch( type ,
>>
>> I'll need to think about an alternate formulation in applyRules() that would
>> work the rule types in order as described in the documentation (which was
>> our intent).
>>
>> Any input on fixes gladly accepted.
>>
> I've committed the patch below.  Rather than looping over
> names(strategy$rules), I create a factor that will sort in the same
> order as described in the documentation.  Obviously, if a new new rule
> type is created, it must be added to this list.
>
> types<- sort(factor(names(strategy$rules),
>    levels=c("pre","risk","order","rebalance",
>                 "exit","enter","entry","post")))
> for ( type in types ) {
>    switch( type ,
>
> The maCross demo now works correctly when the short rules are uncommented.
>
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>> Regards,
>>
>>   - Brian
>>
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1204 / Virus Database: 1435/3405 - Release Date: 01/26/11
>
>
>


From exshovelrydr at gmail.com  Fri Jan 28 20:23:11 2011
From: exshovelrydr at gmail.com (Dan N.)
Date: Fri, 28 Jan 2011 14:23:11 -0500
Subject: [R-SIG-Finance] What's Wrong with this Chart?
Message-ID: <AANLkTinZvQpCDX7U_1+AMhBdr8+ML1_kzW8Dtgom_RsH@mail.gmail.com>

Notice the numbers running up the left hand side of the graph, covering the
y-axis.

 - using Python rpy2.
 - create charts using Quantmod, example code below

robjects.r['pdf'](file=filename)
robjects.r['chartSeries'](dataf, subset=subset, theme="white", TA=TA)
robjects.r['dev.off']()

Any ideas?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110128/c6f37248/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: VZ_3mo.pdf
Type: application/pdf
Size: 29697 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110128/c6f37248/attachment.pdf>

From jeffrey.ryan at lemnica.com  Fri Jan 28 21:41:27 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 28 Jan 2011 14:41:27 -0600
Subject: [R-SIG-Finance] What's Wrong with this Chart?
In-Reply-To: <AANLkTinZvQpCDX7U_1+AMhBdr8+ML1_kzW8Dtgom_RsH@mail.gmail.com>
References: <AANLkTinZvQpCDX7U_1+AMhBdr8+ML1_kzW8Dtgom_RsH@mail.gmail.com>
Message-ID: <AANLkTinfk++7XXaM_oBA9ZpXwouqFPqo5wBzunegNv2J@mail.gmail.com>

Dan N.

You'll need to provide something to make this reproducible.

Typically that would be a very **small** example created with random
data or dput your data.  In addition you'd need to explain what TA is,
since I think that might be the issue.  Also some additional info like
platform, additional things you tried (e.g. running in R - to remove
the potential for Rpy to be a cause).

You can also try using chart_Series, add_TA, add_BBands and add_Vo to
see if that fixes your issue.  That is the new version of chartSeries
that isn't 'complete', but it is much nicer for most basic things.

In general the 'is this broken?' is a non-starter for help, since it
places the additional burden of recreating your environment on the
helper.  In this case, the helper is also the person who helped the
first time by writing and providing the code that you are using.  Of
course all of this is in the posting guide(s).

Best,
Jeff

On Fri, Jan 28, 2011 at 1:23 PM, Dan N. <exshovelrydr at gmail.com> wrote:
> Notice the numbers running up the left hand side of the graph, covering the
> y-axis.
>
> ?- using Python rpy2.
> ?- create charts using Quantmod, example code below
>
> robjects.r['pdf'](file=filename)
> robjects.r['chartSeries'](dataf, subset=subset, theme="white", TA=TA)
> robjects.r['dev.off']()
>
> Any ideas?
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From kriskumar at earthlink.net  Fri Jan 28 21:51:55 2011
From: kriskumar at earthlink.net (krishna)
Date: Fri, 28 Jan 2011 15:51:55 -0500
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix D
	not positive definite
In-Reply-To: <4D41A554.8090906@r-programming.org>
References: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
	<4D41A554.8090906@r-programming.org>
Message-ID: <80B252D1-7695-45AE-A24E-336F7B1A4F8A@earthlink.net>

Also the link below might help with a large number of assets this is a  
common problem.

https://stat.ethz.ch/pipermail/r-sig-finance/2008q3/002854.html


Cheers
Krishna


On Jan 27, 2011, at 12:03 PM, Guy Yollin <gyollin at r-programming.org>  
wrote:

> Hi Lui,
>
> Without seeing the data this is just speculation but...
>
> Are you sure you want t(x)? If you're mixing up your observations  
> versus your assets this may explain the error.
>
> The first parameter of portfolio.optim (in the tseries package) is a  
> returns matrix, one column for each asset and one row for each day  
> (assuming daily returns).  If you have this wrong then for your  
> small datasets you'd have more columns than rows and this could  
> produce that error.
>
> Also, you don't have to pass the entire returns matrix to  
> portfolio.optim, you could pass just the covariance matrix you  
> calculate yourself and a vector (1-row matrix) of mean returns as  
> follows:
>
>
> library(tseries)
> set.seed(2)
> R <- matrix(rnorm(100*10),nrow=100,ncol=10) # 10 assets, 100  
> observations
> averet <- matrix(apply(R,2,mean),nrow=1)
> rcov <- cov(R)
> current_er <- 0.05
> (op <- portfolio.optim(x=averet,pm=current_er,covmat=rcov,riskless =  
> FALSE,shorts = FALSE, rf = 0.0))
>
> Hope this helps.
>
> Best,
>
> Guy
>
>
> On 1/26/2011 7:51 PM, Lui ## wrote:
>> Dear Group,
>>
>> I have  a large set of stocks and want to determine the efficient
>> frontier. The data set covers approx. 1.5 years and S&P 500 companies
>> (nothing weird). portfolio.optim from the PerformanceAnalytics  
>> package
>> works very well and fast. However, whenever I decrease the number of
>> stocks in the portfolio (to 10 or 400), I receive an error message:
>>
>> "solve.QP(Dmat, dvec, Amat, bvec = b0, meq = 2) :
>>   matrix D in quadratic function is not positive definite!"
>>
>> My command settings for portfolio.optim were:
>>
>> seed<- portfolio.optim(t(x), pm = current_er, riskless = FALSE,
>> shorts = FALSE, rf = 0.0)
>>
>> Even when I tried it with shorts = TRUE the error would still remain.
>> x is the set of stocks (stocks in columns, time in rows), current_er
>> is the target return (lies between the minimal mean and the maximum
>> mean of a long only portfolio).
>> I can not post the stock data here - so maybe you have some general
>> suggestions for me of what could have gone wrong... The covariance
>> matrix is positive definite. What could cause the problem? It works
>> fine with the large data set but does not work at all with the small
>> one...
>> Thanks a lot for your suggestions!
>>
>> Lui
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R  
>> questions should go.
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R  
> questions should go.


From exshovelrydr at gmail.com  Fri Jan 28 22:09:12 2011
From: exshovelrydr at gmail.com (Dan N.)
Date: Fri, 28 Jan 2011 16:09:12 -0500
Subject: [R-SIG-Finance] What's Wrong with this Chart?
In-Reply-To: <AANLkTinfk++7XXaM_oBA9ZpXwouqFPqo5wBzunegNv2J@mail.gmail.com>
References: <AANLkTinZvQpCDX7U_1+AMhBdr8+ML1_kzW8Dtgom_RsH@mail.gmail.com>
	<AANLkTinfk++7XXaM_oBA9ZpXwouqFPqo5wBzunegNv2J@mail.gmail.com>
Message-ID: <AANLkTikosifPZXP+fos7sdvk4jbE2BbQz43ZOCqRop3J@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110128/5d12da42/attachment.pl>

From jeffrey.ryan at lemnica.com  Fri Jan 28 22:19:32 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 28 Jan 2011 15:19:32 -0600
Subject: [R-SIG-Finance] What's Wrong with this Chart?
In-Reply-To: <AANLkTikosifPZXP+fos7sdvk4jbE2BbQz43ZOCqRop3J@mail.gmail.com>
References: <AANLkTinZvQpCDX7U_1+AMhBdr8+ML1_kzW8Dtgom_RsH@mail.gmail.com>
	<AANLkTinfk++7XXaM_oBA9ZpXwouqFPqo5wBzunegNv2J@mail.gmail.com>
	<AANLkTikosifPZXP+fos7sdvk4jbE2BbQz43ZOCqRop3J@mail.gmail.com>
Message-ID: <AANLkTikD7OLA5PXX9m3o-6cR5Bdav3S_br5sS-RDdZmC@mail.gmail.com>

On Fri, Jan 28, 2011 at 3:09 PM, Dan N. <exshovelrydr at gmail.com> wrote:
> Dear Jeffery Ryan,

It's Jeffrey.
>
> I was simply asking if anyone had ideas on why the chart looked this way.
> Have you seen this before or not? ?I was not asking for a lecture on mailing
> list protocol, how to recreate my environment, or any other such nonsense.

To answer your question --- yes, I have seen it before.

HTH
Jeff
>
> On Fri, Jan 28, 2011 at 3:41 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>
>> Dan N.
>>
>> You'll need to provide something to make this reproducible.
>>
>> Typically that would be a very **small** example created with random
>> data or dput your data. ?In addition you'd need to explain what TA is,
>> since I think that might be the issue. ?Also some additional info like
>> platform, additional things you tried (e.g. running in R - to remove
>> the potential for Rpy to be a cause).
>>
>> You can also try using chart_Series, add_TA, add_BBands and add_Vo to
>> see if that fixes your issue. ?That is the new version of chartSeries
>> that isn't 'complete', but it is much nicer for most basic things.
>>
>> In general the 'is this broken?' is a non-starter for help, since it
>> places the additional burden of recreating your environment on the
>> helper. ?In this case, the helper is also the person who helped the
>> first time by writing and providing the code that you are using. ?Of
>> course all of this is in the posting guide(s).
>>
>> Best,
>> Jeff
>>
>> On Fri, Jan 28, 2011 at 1:23 PM, Dan N. <exshovelrydr at gmail.com> wrote:
>> > Notice the numbers running up the left hand side of the graph, covering
>> the
>> > y-axis.
>> >
>> > ?- using Python rpy2.
>> > ?- create charts using Quantmod, example code below
>> >
>> > robjects.r['pdf'](file=filename)
>> > robjects.r['chartSeries'](dataf, subset=subset, theme="white", TA=TA)
>> > robjects.r['dev.off']()
>> >
>> > Any ideas?
>> >
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>> >
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From exshovelrydr at gmail.com  Fri Jan 28 22:27:31 2011
From: exshovelrydr at gmail.com (Dan N.)
Date: Fri, 28 Jan 2011 16:27:31 -0500
Subject: [R-SIG-Finance] What's Wrong with this Chart?
In-Reply-To: <AANLkTikD7OLA5PXX9m3o-6cR5Bdav3S_br5sS-RDdZmC@mail.gmail.com>
References: <AANLkTinZvQpCDX7U_1+AMhBdr8+ML1_kzW8Dtgom_RsH@mail.gmail.com>
	<AANLkTinfk++7XXaM_oBA9ZpXwouqFPqo5wBzunegNv2J@mail.gmail.com>
	<AANLkTikosifPZXP+fos7sdvk4jbE2BbQz43ZOCqRop3J@mail.gmail.com>
	<AANLkTikD7OLA5PXX9m3o-6cR5Bdav3S_br5sS-RDdZmC@mail.gmail.com>
Message-ID: <634C3A7F-B151-4E3E-9AE9-CFD68D520FF6@gmail.com>

Lol.  Jeff you are one bitter person.

Sent from my iPhone

On Jan 28, 2011, at 4:19 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:

> On Fri, Jan 28, 2011 at 3:09 PM, Dan N. <exshovelrydr at gmail.com> wrote:
>> Dear Jeffery Ryan,
> 
> It's Jeffrey.
>> 
>> I was simply asking if anyone had ideas on why the chart looked this way.
>> Have you seen this before or not?  I was not asking for a lecture on mailing
>> list protocol, how to recreate my environment, or any other such nonsense.
> 
> To answer your question --- yes, I have seen it before.
> 
> HTH
> Jeff
>> 
>> On Fri, Jan 28, 2011 at 3:41 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>> 
>>> Dan N.
>>> 
>>> You'll need to provide something to make this reproducible.
>>> 
>>> Typically that would be a very **small** example created with random
>>> data or dput your data.  In addition you'd need to explain what TA is,
>>> since I think that might be the issue.  Also some additional info like
>>> platform, additional things you tried (e.g. running in R - to remove
>>> the potential for Rpy to be a cause).
>>> 
>>> You can also try using chart_Series, add_TA, add_BBands and add_Vo to
>>> see if that fixes your issue.  That is the new version of chartSeries
>>> that isn't 'complete', but it is much nicer for most basic things.
>>> 
>>> In general the 'is this broken?' is a non-starter for help, since it
>>> places the additional burden of recreating your environment on the
>>> helper.  In this case, the helper is also the person who helped the
>>> first time by writing and providing the code that you are using.  Of
>>> course all of this is in the posting guide(s).
>>> 
>>> Best,
>>> Jeff
>>> 
>>> On Fri, Jan 28, 2011 at 1:23 PM, Dan N. <exshovelrydr at gmail.com> wrote:
>>>> Notice the numbers running up the left hand side of the graph, covering
>>> the
>>>> y-axis.
>>>> 
>>>>  - using Python rpy2.
>>>>  - create charts using Quantmod, example code below
>>>> 
>>>> robjects.r['pdf'](file=filename)
>>>> robjects.r['chartSeries'](dataf, subset=subset, theme="white", TA=TA)
>>>> robjects.r['dev.off']()
>>>> 
>>>> Any ideas?
>>>> 
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>> 
>>> 
>>> 
>>> 
>>> --
>>> Jeffrey Ryan
>>> jeffrey.ryan at lemnica.com
>>> 
>>> www.lemnica.com
>>> 
>> 
>>        [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>> 
> 
> 
> 
> -- 
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
> 
> www.lemnica.com


From eburgene at gmail.com  Sat Jan 29 17:51:06 2011
From: eburgene at gmail.com (Emanuel Burgener)
Date: Sat, 29 Jan 2011 17:51:06 +0100
Subject: [R-SIG-Finance] HEAVY volatility model
Message-ID: <AANLkTimAVKeOUPqJckN8nsgSDXmQ4NFxq7wnMDiQ+W5Y@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110129/776b6069/attachment.pl>

From lui.r.project at googlemail.com  Sat Jan 29 21:52:57 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Sat, 29 Jan 2011 15:52:57 -0500
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix D
 not positive definite
In-Reply-To: <80B252D1-7695-45AE-A24E-336F7B1A4F8A@earthlink.net>
References: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
	<4D41A554.8090906@r-programming.org>
	<80B252D1-7695-45AE-A24E-336F7B1A4F8A@earthlink.net>
Message-ID: <AANLkTikxTmU=aCXGPBuf=gKrrBaFi42zekeamsJ9sBmQ@mail.gmail.com>

Hello everybody,

sorry for my delayed "thanks" note - I was travelling.

@Arun: Debugging the underlying code is a little bit difficult since
the optimizer was written in FORTRAN. I think going for the nearest PD
(as Krishna also suggested) might be the best way. However, I honestly
don't understand why it is not PD... Does anybody have an explanation
for that?
@Guy: The weird thing is that I got the error code without the t(x) in
the first place. t(x) solved the problem (for some assets) and the
result indicated that it took a look at the assets and not the
observations... I am going to give it a try with the covariance matrix
again and let you know if it worked out... strange though.
@Krishna: Thanks for your link! I think that really helps... I am
going to try it out! Do you have an explanation why this is a common
problem with a large number of assets?

Thank you! Have a nice weekend!

Lui

On Fri, Jan 28, 2011 at 3:51 PM, krishna <kriskumar at earthlink.net> wrote:
> Also the link below might help with a large number of assets this is a
> common problem.
>
> https://stat.ethz.ch/pipermail/r-sig-finance/2008q3/002854.html
>
>
> Cheers
> Krishna
>
>
> On Jan 27, 2011, at 12:03 PM, Guy Yollin <gyollin at r-programming.org> wrote:
>
>> Hi Lui,
>>
>> Without seeing the data this is just speculation but...
>>
>> Are you sure you want t(x)? If you're mixing up your observations versus
>> your assets this may explain the error.
>>
>> The first parameter of portfolio.optim (in the tseries package) is a
>> returns matrix, one column for each asset and one row for each day (assuming
>> daily returns). ?If you have this wrong then for your small datasets you'd
>> have more columns than rows and this could produce that error.
>>
>> Also, you don't have to pass the entire returns matrix to portfolio.optim,
>> you could pass just the covariance matrix you calculate yourself and a
>> vector (1-row matrix) of mean returns as follows:
>>
>>
>> library(tseries)
>> set.seed(2)
>> R <- matrix(rnorm(100*10),nrow=100,ncol=10) # 10 assets, 100 observations
>> averet <- matrix(apply(R,2,mean),nrow=1)
>> rcov <- cov(R)
>> current_er <- 0.05
>> (op <- portfolio.optim(x=averet,pm=current_er,covmat=rcov,riskless =
>> FALSE,shorts = FALSE, rf = 0.0))
>>
>> Hope this helps.
>>
>> Best,
>>
>> Guy
>>
>>
>> On 1/26/2011 7:51 PM, Lui ## wrote:
>>>
>>> Dear Group,
>>>
>>> I have ?a large set of stocks and want to determine the efficient
>>> frontier. The data set covers approx. 1.5 years and S&P 500 companies
>>> (nothing weird). portfolio.optim from the PerformanceAnalytics package
>>> works very well and fast. However, whenever I decrease the number of
>>> stocks in the portfolio (to 10 or 400), I receive an error message:
>>>
>>> "solve.QP(Dmat, dvec, Amat, bvec = b0, meq = 2) :
>>> ?matrix D in quadratic function is not positive definite!"
>>>
>>> My command settings for portfolio.optim were:
>>>
>>> seed<- portfolio.optim(t(x), pm = current_er, riskless = FALSE,
>>> shorts = FALSE, rf = 0.0)
>>>
>>> Even when I tried it with shorts = TRUE the error would still remain.
>>> x is the set of stocks (stocks in columns, time in rows), current_er
>>> is the target return (lies between the minimal mean and the maximum
>>> mean of a long only portfolio).
>>> I can not post the stock data here - so maybe you have some general
>>> suggestions for me of what could have gone wrong... The covariance
>>> matrix is positive definite. What could cause the problem? It works
>>> fine with the large data set but does not work at all with the small
>>> one...
>>> Thanks a lot for your suggestions!
>>>
>>> Lui
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From kriskumar at earthlink.net  Sat Jan 29 22:32:26 2011
From: kriskumar at earthlink.net (krishna)
Date: Sat, 29 Jan 2011 16:32:26 -0500
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix D
	not positive definite
In-Reply-To: <AANLkTikxTmU=aCXGPBuf=gKrrBaFi42zekeamsJ9sBmQ@mail.gmail.com>
References: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>
	<4D41A554.8090906@r-programming.org>
	<80B252D1-7695-45AE-A24E-336F7B1A4F8A@earthlink.net>
	<AANLkTikxTmU=aCXGPBuf=gKrrBaFi42zekeamsJ9sBmQ@mail.gmail.com>
Message-ID: <415B149F-DE9D-44D1-B95B-B14C56C14B3E@earthlink.net>

The problem could be due to few reasons the papers by Higham &  
Rebonato are a good read as to what the recipe does. The simplest  
recipe is to set the negative eigenvalues to a small positive number  
and rescale the matrix.

There are a few causes for this if you create corr matrices from  
bivariate estimation and slap them together that may not be PD. In  
some cases  in derivative pricing the matrix is hand glued together  
from implied correlations between two assets. Now a matrix of such  
implied corrs does not have to be PD and fails.

Sample corr matrices are by definition PD however often times if you  
have a lot of missing data(illiquid names in your universe?) and if  
you do a  na.locf (creating a const asset) this could do it as well.

It might be useful to do multivariate imputation with some o the R  
packages rather than deletion or carrying fwd on your data.

There are other reasons besides all of the above for your corr matrix  
being non PD. I think if you are working with such a large universe it  
might be easier to have factor corr matrices using PCA or ICA. This  
way if you manage to label the factors then you can see what bets your  
optimizer is taking.


HTH

Best
Krishna



On Jan 29, 2011, at 3:52 PM, "Lui ##" <lui.r.project at googlemail.com>  
wrote:

> Hello everybody,
>
> sorry for my delayed "thanks" note - I was travelling.
>
> @Arun: Debugging the underlying code is a little bit difficult since
> the optimizer was written in FORTRAN. I think going for the nearest PD
> (as Krishna also suggested) might be the best way. However, I honestly
> don't understand why it is not PD... Does anybody have an explanation
> for that?
> @Guy: The weird thing is that I got the error code without the t(x) in
> the first place. t(x) solved the problem (for some assets) and the
> result indicated that it took a look at the assets and not the
> observations... I am going to give it a try with the covariance matrix
> again and let you know if it worked out... strange though.
> @Krishna: Thanks for your link! I think that really helps... I am
> going to try it out! Do you have an explanation why this is a common
> problem with a large number of assets?
>
> Thank you! Have a nice weekend!
>
> Lui
>
> On Fri, Jan 28, 2011 at 3:51 PM, krishna <kriskumar at earthlink.net>  
> wrote:
>> Also the link below might help with a large number of assets this  
>> is a
>> common problem.
>>
>> https://stat.ethz.ch/pipermail/r-sig-finance/2008q3/002854.html
>>
>>
>> Cheers
>> Krishna
>>
>>
>> On Jan 27, 2011, at 12:03 PM, Guy Yollin <gyollin at r- 
>> programming.org> wrote:
>>
>>> Hi Lui,
>>>
>>> Without seeing the data this is just speculation but...
>>>
>>> Are you sure you want t(x)? If you're mixing up your observations  
>>> versus
>>> your assets this may explain the error.
>>>
>>> The first parameter of portfolio.optim (in the tseries package) is a
>>> returns matrix, one column for each asset and one row for each day  
>>> (assuming
>>> daily returns).  If you have this wrong then for your small  
>>> datasets you'd
>>> have more columns than rows and this could produce that error.
>>>
>>> Also, you don't have to pass the entire returns matrix to  
>>> portfolio.optim,
>>> you could pass just the covariance matrix you calculate yourself  
>>> and a
>>> vector (1-row matrix) of mean returns as follows:
>>>
>>>
>>> library(tseries)
>>> set.seed(2)
>>> R <- matrix(rnorm(100*10),nrow=100,ncol=10) # 10 assets, 100  
>>> observations
>>> averet <- matrix(apply(R,2,mean),nrow=1)
>>> rcov <- cov(R)
>>> current_er <- 0.05
>>> (op <- portfolio.optim(x=averet,pm=current_er,covmat=rcov,riskless =
>>> FALSE,shorts = FALSE, rf = 0.0))
>>>
>>> Hope this helps.
>>>
>>> Best,
>>>
>>> Guy
>>>
>>>
>>> On 1/26/2011 7:51 PM, Lui ## wrote:
>>>>
>>>> Dear Group,
>>>>
>>>> I have  a large set of stocks and want to determine the efficient
>>>> frontier. The data set covers approx. 1.5 years and S&P 500  
>>>> companies
>>>> (nothing weird). portfolio.optim from the PerformanceAnalytics  
>>>> package
>>>> works very well and fast. However, whenever I decrease the number  
>>>> of
>>>> stocks in the portfolio (to 10 or 400), I receive an error message:
>>>>
>>>> "solve.QP(Dmat, dvec, Amat, bvec = b0, meq = 2) :
>>>>  matrix D in quadratic function is not positive definite!"
>>>>
>>>> My command settings for portfolio.optim were:
>>>>
>>>> seed<- portfolio.optim(t(x), pm = current_er, riskless = FALSE,
>>>> shorts = FALSE, rf = 0.0)
>>>>
>>>> Even when I tried it with shorts = TRUE the error would still  
>>>> remain.
>>>> x is the set of stocks (stocks in columns, time in rows),  
>>>> current_er
>>>> is the target return (lies between the minimal mean and the maximum
>>>> mean of a long only portfolio).
>>>> I can not post the stock data here - so maybe you have some general
>>>> suggestions for me of what could have gone wrong... The covariance
>>>> matrix is positive definite. What could cause the problem? It works
>>>> fine with the large data set but does not work at all with the  
>>>> small
>>>> one...
>>>> Thanks a lot for your suggestions!
>>>>
>>>> Lui
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R  
>>>> questions
>>>> should go.
>>>>
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R  
>>> questions
>>> should go.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R  
>> questions
>> should go.
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R  
> questions should go.


From patrick at burns-stat.com  Sun Jan 30 10:34:20 2011
From: patrick at burns-stat.com (Patrick Burns)
Date: Sun, 30 Jan 2011 09:34:20 +0000
Subject: [R-SIG-Finance] portfolio.optim and error in solve.QP: matrix
 D	not positive definite
In-Reply-To: <415B149F-DE9D-44D1-B95B-B14C56C14B3E@earthlink.net>
References: <AANLkTimNoSypsvuK2CusHDX_A_4aDKKZbUi4nJ0bJc=W@mail.gmail.com>	<4D41A554.8090906@r-programming.org>	<80B252D1-7695-45AE-A24E-336F7B1A4F8A@earthlink.net>	<AANLkTikxTmU=aCXGPBuf=gKrrBaFi42zekeamsJ9sBmQ@mail.gmail.com>
	<415B149F-DE9D-44D1-B95B-B14C56C14B3E@earthlink.net>
Message-ID: <4D45309C.2080708@burns-stat.com>

Krishna has a good point.  Getting the
variance matrix to be barely positive
definite is still not a good thing for
optimization.

An eigenvalue that is essentially zero
says that there is a portfolio that is
essentially riskless.  And we haven't
had any of those since subprime mortgages
fell out of favor.

As Krishna says a factor model will give
you a better result.  A good (possibly
better) alternative is a Ledoit-Wolf
shrinkage estimate.

Functions to estimate either of those are
in the 'BurStFin' package which still hasn't
arrived in CRAN.  But you can get it with:

install.packages('BurStFin', repos="http://www.burns-stat.com/R")


The 'tawny' package has a function for
Ledoit-Wolf.


On 29/01/2011 21:32, krishna wrote:
> The problem could be due to few reasons the papers by Higham & Rebonato
> are a good read as to what the recipe does. The simplest recipe is to
> set the negative eigenvalues to a small positive number and rescale the
> matrix.
>
> There are a few causes for this if you create corr matrices from
> bivariate estimation and slap them together that may not be PD. In some
> cases in derivative pricing the matrix is hand glued together from
> implied correlations between two assets. Now a matrix of such implied
> corrs does not have to be PD and fails.
>
> Sample corr matrices are by definition PD however often times if you
> have a lot of missing data(illiquid names in your universe?) and if you
> do a na.locf (creating a const asset) this could do it as well.
>
> It might be useful to do multivariate imputation with some o the R
> packages rather than deletion or carrying fwd on your data.
>
> There are other reasons besides all of the above for your corr matrix
> being non PD. I think if you are working with such a large universe it
> might be easier to have factor corr matrices using PCA or ICA. This way
> if you manage to label the factors then you can see what bets your
> optimizer is taking.
>
>
> HTH
>
> Best
> Krishna
>
>
>
> On Jan 29, 2011, at 3:52 PM, "Lui ##" <lui.r.project at googlemail.com> wrote:
>
>> Hello everybody,
>>
>> sorry for my delayed "thanks" note - I was travelling.
>>
>> @Arun: Debugging the underlying code is a little bit difficult since
>> the optimizer was written in FORTRAN. I think going for the nearest PD
>> (as Krishna also suggested) might be the best way. However, I honestly
>> don't understand why it is not PD... Does anybody have an explanation
>> for that?
>> @Guy: The weird thing is that I got the error code without the t(x) in
>> the first place. t(x) solved the problem (for some assets) and the
>> result indicated that it took a look at the assets and not the
>> observations... I am going to give it a try with the covariance matrix
>> again and let you know if it worked out... strange though.
>> @Krishna: Thanks for your link! I think that really helps... I am
>> going to try it out! Do you have an explanation why this is a common
>> problem with a large number of assets?
>>
>> Thank you! Have a nice weekend!
>>
>> Lui
>>
>> On Fri, Jan 28, 2011 at 3:51 PM, krishna <kriskumar at earthlink.net> wrote:
>>> Also the link below might help with a large number of assets this is a
>>> common problem.
>>>
>>> https://stat.ethz.ch/pipermail/r-sig-finance/2008q3/002854.html
>>>
>>>
>>> Cheers
>>> Krishna
>>>
>>>
>>> On Jan 27, 2011, at 12:03 PM, Guy Yollin <gyollin at r-programming.org>
>>> wrote:
>>>
>>>> Hi Lui,
>>>>
>>>> Without seeing the data this is just speculation but...
>>>>
>>>> Are you sure you want t(x)? If you're mixing up your observations
>>>> versus
>>>> your assets this may explain the error.
>>>>
>>>> The first parameter of portfolio.optim (in the tseries package) is a
>>>> returns matrix, one column for each asset and one row for each day
>>>> (assuming
>>>> daily returns). If you have this wrong then for your small datasets
>>>> you'd
>>>> have more columns than rows and this could produce that error.
>>>>
>>>> Also, you don't have to pass the entire returns matrix to
>>>> portfolio.optim,
>>>> you could pass just the covariance matrix you calculate yourself and a
>>>> vector (1-row matrix) of mean returns as follows:
>>>>
>>>>
>>>> library(tseries)
>>>> set.seed(2)
>>>> R <- matrix(rnorm(100*10),nrow=100,ncol=10) # 10 assets, 100
>>>> observations
>>>> averet <- matrix(apply(R,2,mean),nrow=1)
>>>> rcov <- cov(R)
>>>> current_er <- 0.05
>>>> (op <- portfolio.optim(x=averet,pm=current_er,covmat=rcov,riskless =
>>>> FALSE,shorts = FALSE, rf = 0.0))
>>>>
>>>> Hope this helps.
>>>>
>>>> Best,
>>>>
>>>> Guy
>>>>
>>>>
>>>> On 1/26/2011 7:51 PM, Lui ## wrote:
>>>>>
>>>>> Dear Group,
>>>>>
>>>>> I have a large set of stocks and want to determine the efficient
>>>>> frontier. The data set covers approx. 1.5 years and S&P 500 companies
>>>>> (nothing weird). portfolio.optim from the PerformanceAnalytics package
>>>>> works very well and fast. However, whenever I decrease the number of
>>>>> stocks in the portfolio (to 10 or 400), I receive an error message:
>>>>>
>>>>> "solve.QP(Dmat, dvec, Amat, bvec = b0, meq = 2) :
>>>>> matrix D in quadratic function is not positive definite!"
>>>>>
>>>>> My command settings for portfolio.optim were:
>>>>>
>>>>> seed<- portfolio.optim(t(x), pm = current_er, riskless = FALSE,
>>>>> shorts = FALSE, rf = 0.0)
>>>>>
>>>>> Even when I tried it with shorts = TRUE the error would still remain.
>>>>> x is the set of stocks (stocks in columns, time in rows), current_er
>>>>> is the target return (lies between the minimal mean and the maximum
>>>>> mean of a long only portfolio).
>>>>> I can not post the stock data here - so maybe you have some general
>>>>> suggestions for me of what could have gone wrong... The covariance
>>>>> matrix is positive definite. What could cause the problem? It works
>>>>> fine with the large data set but does not work at all with the small
>>>>> one...
>>>>> Thanks a lot for your suggestions!
>>>>>
>>>>> Lui
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Finance at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R
>>>>> questions
>>>>> should go.
>>>>>
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
>> questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From worik.stanton at gmail.com  Mon Jan 31 07:55:03 2011
From: worik.stanton at gmail.com (Worik)
Date: Mon, 31 Jan 2011 19:55:03 +1300
Subject: [R-SIG-Finance] XTS with unique time stamps?
Message-ID: <4D465CC7.8010603@gmail.com>

I am having trouble with non-unique time stamps in an xts.

My underlying data has some repeated rows (in a csv file).

How can I easily get rid of the duplicates?

I feel I must be missing something simple.  If not I can concoct an 
example to illustrate my problem.

cheers
Worik

-- 
If we amplify everything, we hear nothing.
--


From brian at braverock.com  Mon Jan 31 13:05:16 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 31 Jan 2011 06:05:16 -0600
Subject: [R-SIG-Finance] XTS with unique time stamps?
In-Reply-To: <4D465CC7.8010603@gmail.com>
References: <4D465CC7.8010603@gmail.com>
Message-ID: <201101310605.17274.brian@braverock.com>

On Monday, January 31, 2011 12:55:03 am Worik wrote:
> I am having trouble with non-unique time stamps in an xts.
> 
> My underlying data has some repeated rows (in a csv file).
> 
> How can I easily get rid of the duplicates?
> 
> I feel I must be missing something simple.  If not I can concoct an
> example to illustrate my problem.

Worik,

It depends on what you need.

If you can remove the rows with duplicated indices, then a construction such 
as:

myxts<-myxts[!duplicated(index(myxts))]

should work.

If you need all of the observations, and need to artificially make them unique 
(as is a common problem with tick data), then you will see discussion in the 
list archives here and other places regarding adding artificial indices to high 
frequency data while preserving order. You will need the latest xts from R-
Forge and use a construction like this:

myxts<-make.unique.index(myxts)

which will (by default) add .00001 sec to each non-unique index after the 
first, preserving order, and providing every observation with a unique index.  
Note that this presumes that the original order of the observations was 
correct in the first place, no provision has been made if you have different 
circumstances.

Thanks to Jeff Ryan for (very) recently adding this second method.

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jeffrey.ryan at lemnica.com  Mon Jan 31 16:37:02 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 31 Jan 2011 09:37:02 -0600
Subject: [R-SIG-Finance] XTS with unique time stamps?
In-Reply-To: <201101310605.17274.brian@braverock.com>
References: <4D465CC7.8010603@gmail.com>
	<201101310605.17274.brian@braverock.com>
Message-ID: <AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>

Brian, Worik

w.r.t the new functionality in xts.

It is so bleeding edge that Brian gave you the wrong name ;-) think
"make [the] index unique".  It probably will also be extended to do
the former removal of subsequent non-unique observations/times as
well.

HTH,
Jeff


?make.index.unique

make.index.unique             package:xts              R Documentation

Force Time Values To Be Unique

Description:

     A generic function to force sorted time vectors to be unique.
     Useful for high-frequency time-series where original time-stamps
     may have identical values. For the case of xts objects, the
     default ?eps? is set to one-hundred microseconds. In practice this
     advances each subsequent identical time by ?eps? over the previous
     (possibly also advanced) value.

Usage:

     make.index.unique(x, eps = 1e-05, ...)

     make.time.unique(x, eps = 1e-05, ...)

Arguments:

       x: An xts object, or POSIXct vector.

     eps: value to add to force uniqueness.

     ...: unused

Details:

     The returned time-series object will have new time-stamps so that
     ?isOrdered( .index(x) )? evaluates to TRUE.

Value:

     A modified version of x.

Note:

     Incoming values must be pre-sorted, and no check is done to make
     sure that this is the case.  If the index values are of
     storage.mode ?integer?, they will be coerced to ?double?.

Author(s):

     Jeffrey A. Ryan

See Also:

     ?align.time?

Examples:

     ds <- options(digits.secs=6) # so we can see the change

     x <- xts(1:10, as.POSIXct("2011-01-21") + c(1,1,1,2:8)/1e3)
     x
     make.index.unique(x)

     options(ds)



On Mon, Jan 31, 2011 at 6:05 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Monday, January 31, 2011 12:55:03 am Worik wrote:
>> I am having trouble with non-unique time stamps in an xts.
>>
>> My underlying data has some repeated rows (in a csv file).
>>
>> How can I easily get rid of the duplicates?
>>
>> I feel I must be missing something simple. ?If not I can concoct an
>> example to illustrate my problem.
>
> Worik,
>
> It depends on what you need.
>
> If you can remove the rows with duplicated indices, then a construction such
> as:
>
> myxts<-myxts[!duplicated(index(myxts))]
>
> should work.
>
> If you need all of the observations, and need to artificially make them unique
> (as is a common problem with tick data), then you will see discussion in the
> list archives here and other places regarding adding artificial indices to high
> frequency data while preserving order. You will need the latest xts from R-
> Forge and use a construction like this:
>
> myxts<-make.unique.index(myxts)
>
> which will (by default) add .00001 sec to each non-unique index after the
> first, preserving order, and providing every observation with a unique index.
> Note that this presumes that the original order of the observations was
> correct in the first place, no provision has been made if you have different
> circumstances.
>
> Thanks to Jeff Ryan for (very) recently adding this second method.
>
> Regards,
>
> ?- Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From edd at debian.org  Mon Jan 31 17:09:55 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 31 Jan 2011 10:09:55 -0600
Subject: [R-SIG-Finance] XTS with unique time stamps?
In-Reply-To: <AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>
References: <4D465CC7.8010603@gmail.com>
	<201101310605.17274.brian@braverock.com>
	<AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>
Message-ID: <19782.57043.358097.779979@max.nulle.part>


On 31 January 2011 at 09:37, Jeffrey Ryan wrote:
| Brian, Worik
| 
| w.r.t the new functionality in xts.
| 
| It is so bleeding edge that Brian gave you the wrong name ;-) think
| "make [the] index unique".  It probably will also be extended to do
| the former removal of subsequent non-unique observations/times as
| well.
| 
| HTH,
| Jeff
| 
| 
| ?make.index.unique
| 
| make.index.unique             package:xts              R Documentation
| 
| Force Time Values To Be Unique
| 
| Description:
| 
|      A generic function to force sorted time vectors to be unique.
|      Useful for high-frequency time-series where original time-stamps
|      may have identical values. For the case of xts objects, the
|      default ?eps? is set to one-hundred microseconds. In practice this
|      advances each subsequent identical time by ?eps? over the previous
|      (possibly also advanced) value.
| 
| Usage:
| 
|      make.index.unique(x, eps = 1e-05, ...)
| 
|      make.time.unique(x, eps = 1e-05, ...)

Why eps=1e-05?  I wrote variants of this in-house and use 

    incrementTimestamps <- function(times, incr=1.0e-6, ...) {
       ...
    }

Dirk

| 
| Arguments:
| 
|        x: An xts object, or POSIXct vector.
| 
|      eps: value to add to force uniqueness.
| 
|      ...: unused
| 
| Details:
| 
|      The returned time-series object will have new time-stamps so that
|      ?isOrdered( .index(x) )? evaluates to TRUE.
| 
| Value:
| 
|      A modified version of x.
| 
| Note:
| 
|      Incoming values must be pre-sorted, and no check is done to make
|      sure that this is the case.  If the index values are of
|      storage.mode ?integer?, they will be coerced to ?double?.
| 
| Author(s):
| 
|      Jeffrey A. Ryan
| 
| See Also:
| 
|      ?align.time?
| 
| Examples:
| 
|      ds <- options(digits.secs=6) # so we can see the change
| 
|      x <- xts(1:10, as.POSIXct("2011-01-21") + c(1,1,1,2:8)/1e3)
|      x
|      make.index.unique(x)
| 
|      options(ds)
| 
| 
| 
| On Mon, Jan 31, 2011 at 6:05 AM, Brian G. Peterson <brian at braverock.com> wrote:
| > On Monday, January 31, 2011 12:55:03 am Worik wrote:
| >> I am having trouble with non-unique time stamps in an xts.
| >>
| >> My underlying data has some repeated rows (in a csv file).
| >>
| >> How can I easily get rid of the duplicates?
| >>
| >> I feel I must be missing something simple. ?If not I can concoct an
| >> example to illustrate my problem.
| >
| > Worik,
| >
| > It depends on what you need.
| >
| > If you can remove the rows with duplicated indices, then a construction such
| > as:
| >
| > myxts<-myxts[!duplicated(index(myxts))]
| >
| > should work.
| >
| > If you need all of the observations, and need to artificially make them unique
| > (as is a common problem with tick data), then you will see discussion in the
| > list archives here and other places regarding adding artificial indices to high
| > frequency data while preserving order. You will need the latest xts from R-
| > Forge and use a construction like this:
| >
| > myxts<-make.unique.index(myxts)
| >
| > which will (by default) add .00001 sec to each non-unique index after the
| > first, preserving order, and providing every observation with a unique index.
| > Note that this presumes that the original order of the observations was
| > correct in the first place, no provision has been made if you have different
| > circumstances.
| >
| > Thanks to Jeff Ryan for (very) recently adding this second method.
| >
| > Regards,
| >
| > ?- Brian
| >
| > --
| > Brian G. Peterson
| > http://braverock.com/brian/
| > Ph: 773-459-4973
| > IM: bgpbraverock
| >
| > _______________________________________________
| > R-SIG-Finance at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| > -- Subscriber-posting only. If you want to post, subscribe first.
| > -- Also note that this is not the r-help list where general R questions should go.
| >
| 
| 
| 
| -- 
| Jeffrey Ryan
| jeffrey.ryan at lemnica.com
| 
| www.lemnica.com
| 
| _______________________________________________
| R-SIG-Finance at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From jeffrey.ryan at lemnica.com  Mon Jan 31 17:23:39 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 31 Jan 2011 10:23:39 -0600
Subject: [R-SIG-Finance] XTS with unique time stamps?
In-Reply-To: <19782.57043.358097.779979@max.nulle.part>
References: <4D465CC7.8010603@gmail.com>
	<201101310605.17274.brian@braverock.com>
	<AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>
	<19782.57043.358097.779979@max.nulle.part>
Message-ID: <AANLkTimWg5w73Hnfq4A5_2bJRNUeShOq5oiQ4zkMdRef@mail.gmail.com>

On Mon, Jan 31, 2011 at 10:09 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 31 January 2011 at 09:37, Jeffrey Ryan wrote:
> | Brian, Worik
> |
> | w.r.t the new functionality in xts.
> |
> | It is so bleeding edge that Brian gave you the wrong name ;-) think
> | "make [the] index unique". ?It probably will also be extended to do
> | the former removal of subsequent non-unique observations/times as
> | well.
> |
> | HTH,
> | Jeff
> |
> |
> | ?make.index.unique
> |
> | make.index.unique ? ? ? ? ? ? package:xts ? ? ? ? ? ? ?R Documentation
> |
> | Force Time Values To Be Unique
> |
> | Description:
> |
> | ? ? ?A generic function to force sorted time vectors to be unique.
> | ? ? ?Useful for high-frequency time-series where original time-stamps
> | ? ? ?may have identical values. For the case of xts objects, the
> | ? ? ?default ?eps? is set to one-hundred microseconds. In practice this
> | ? ? ?advances each subsequent identical time by ?eps? over the previous
> | ? ? ?(possibly also advanced) value.
> |
> | Usage:
> |
> | ? ? ?make.index.unique(x, eps = 1e-05, ...)
> |
> | ? ? ?make.time.unique(x, eps = 1e-05, ...)
>
> Why eps=1e-05? ?I wrote variants of this in-house and use
>
> ? ?incrementTimestamps <- function(times, incr=1.0e-6, ...) {
> ? ? ? ...
> ? ?}
>

Why not.  ;-)

On the topic of semantics, why 1.0e-6:  1.0 is redundant, given that a
negative exponent will assure you a mode of "double".

All kidding aside, Brian told me to.  And it is user settable of course.

Cuique suum
Jeff


> Dirk
>
> |
> | Arguments:
> |
> | ? ? ? ?x: An xts object, or POSIXct vector.
> |
> | ? ? ?eps: value to add to force uniqueness.
> |
> | ? ? ?...: unused
> |
> | Details:
> |
> | ? ? ?The returned time-series object will have new time-stamps so that
> | ? ? ??isOrdered( .index(x) )? evaluates to TRUE.
> |
> | Value:
> |
> | ? ? ?A modified version of x.
> |
> | Note:
> |
> | ? ? ?Incoming values must be pre-sorted, and no check is done to make
> | ? ? ?sure that this is the case. ?If the index values are of
> | ? ? ?storage.mode ?integer?, they will be coerced to ?double?.
> |
> | Author(s):
> |
> | ? ? ?Jeffrey A. Ryan
> |
> | See Also:
> |
> | ? ? ??align.time?
> |
> | Examples:
> |
> | ? ? ?ds <- options(digits.secs=6) # so we can see the change
> |
> | ? ? ?x <- xts(1:10, as.POSIXct("2011-01-21") + c(1,1,1,2:8)/1e3)
> | ? ? ?x
> | ? ? ?make.index.unique(x)
> |
> | ? ? ?options(ds)
> |
> |
> |
> | On Mon, Jan 31, 2011 at 6:05 AM, Brian G. Peterson <brian at braverock.com> wrote:
> | > On Monday, January 31, 2011 12:55:03 am Worik wrote:
> | >> I am having trouble with non-unique time stamps in an xts.
> | >>
> | >> My underlying data has some repeated rows (in a csv file).
> | >>
> | >> How can I easily get rid of the duplicates?
> | >>
> | >> I feel I must be missing something simple. ?If not I can concoct an
> | >> example to illustrate my problem.
> | >
> | > Worik,
> | >
> | > It depends on what you need.
> | >
> | > If you can remove the rows with duplicated indices, then a construction such
> | > as:
> | >
> | > myxts<-myxts[!duplicated(index(myxts))]
> | >
> | > should work.
> | >
> | > If you need all of the observations, and need to artificially make them unique
> | > (as is a common problem with tick data), then you will see discussion in the
> | > list archives here and other places regarding adding artificial indices to high
> | > frequency data while preserving order. You will need the latest xts from R-
> | > Forge and use a construction like this:
> | >
> | > myxts<-make.unique.index(myxts)
> | >
> | > which will (by default) add .00001 sec to each non-unique index after the
> | > first, preserving order, and providing every observation with a unique index.
> | > Note that this presumes that the original order of the observations was
> | > correct in the first place, no provision has been made if you have different
> | > circumstances.
> | >
> | > Thanks to Jeff Ryan for (very) recently adding this second method.
> | >
> | > Regards,
> | >
> | > ?- Brian
> | >
> | > --
> | > Brian G. Peterson
> | > http://braverock.com/brian/
> | > Ph: 773-459-4973
> | > IM: bgpbraverock
> | >
> | > _______________________________________________
> | > R-SIG-Finance at r-project.org mailing list
> | > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> | > -- Subscriber-posting only. If you want to post, subscribe first.
> | > -- Also note that this is not the r-help list where general R questions should go.
> | >
> |
> |
> |
> | --
> | Jeffrey Ryan
> | jeffrey.ryan at lemnica.com
> |
> | www.lemnica.com
> |
> | _______________________________________________
> | R-SIG-Finance at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> | -- Subscriber-posting only. If you want to post, subscribe first.
> | -- Also note that this is not the r-help list where general R questions should go.
>
> --
> Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From brian at braverock.com  Mon Jan 31 17:31:53 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 31 Jan 2011 10:31:53 -0600
Subject: [R-SIG-Finance] XTS with unique time stamps?
In-Reply-To: <AANLkTimWg5w73Hnfq4A5_2bJRNUeShOq5oiQ4zkMdRef@mail.gmail.com>
References: <4D465CC7.8010603@gmail.com>	<201101310605.17274.brian@braverock.com>	<AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>	<19782.57043.358097.779979@max.nulle.part>
	<AANLkTimWg5w73Hnfq4A5_2bJRNUeShOq5oiQ4zkMdRef@mail.gmail.com>
Message-ID: <4D46E3F9.6020107@braverock.com>

|      make.time.unique(x, eps = 1e-05, ...)
 >>
>> > On 01/31/2011 10:09 AM, Dirk Eddelbuettel wrote:
>> >  Why eps=1e-05?  I wrote variants of this in-house and use
>> >
>> >      incrementTimestamps<- function(times, incr=1.0e-6, ...) {
>> >         ...
>> >      }
>> >
On 01/31/2011 10:23 AM, Jeffrey Ryan wrote:
> Why not.;-)
>
> On the topic of semantics, why 1.0e-6:  1.0 is redundant, given that a
> negative exponent will assure you a mode of "double".

I recall (hazy, I'm suspect there was beer involved) that we did some 
testing a year or so ago on multiple different R installations and found 
that 1e-5 was reliable even on 32 bit architectures, and 1e-6 was 
(potentially) in the precision wiggle.  My recollection could easily be 
incorrect, and I'm sure that any precision issue like this is highly 
compiler dependent.

As ?s (microsecond, 1e-6) timestamped data becomes increasingly 
available, this functionality should become less necessary.  For now, 
I'm happy that it's in xts.

Cheers,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From David.Reiner at xrtrading.com  Mon Jan 31 18:13:04 2011
From: David.Reiner at xrtrading.com (David Reiner)
Date: Mon, 31 Jan 2011 11:13:04 -0600
Subject: [R-SIG-Finance] [SPAM] - Re: XTS with unique time stamps? -
 Email found in subject
In-Reply-To: <AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>
References: <4D465CC7.8010603@gmail.com><201101310605.17274.brian@braverock.com>
	<AANLkTi=pfN=_15koE7_SmvA8iOVb1MO_kXiqji2w62z3@mail.gmail.com>
Message-ID: <9DE405308A6AA24AA794B76282C6C00F0B4CE275@HQ-POST1>

Jeff,
When you do extend it to remove duplicates, you might want to
give a choice whether to keep the first or last duplicated value.
I know I've used both for various reasons.
Thanks for such a great set of packages!
-- David

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Jeffrey Ryan
Sent: Monday, January 31, 2011 9:37 AM
To: Brian G. Peterson
Cc: r-sig-finance at r-project.org
Subject: [SPAM] - Re: [R-SIG-Finance] XTS with unique time stamps? - Email found in subject

Brian, Worik

w.r.t the new functionality in xts.

It is so bleeding edge that Brian gave you the wrong name ;-) think
"make [the] index unique".  It probably will also be extended to do
the former removal of subsequent non-unique observations/times as
well.

HTH,
Jeff


?make.index.unique

make.index.unique             package:xts              R Documentation

Force Time Values To Be Unique

Description:

     A generic function to force sorted time vectors to be unique.
     Useful for high-frequency time-series where original time-stamps
     may have identical values. For the case of xts objects, the
     default 'eps' is set to one-hundred microseconds. In practice this
     advances each subsequent identical time by 'eps' over the previous
     (possibly also advanced) value.

Usage:

     make.index.unique(x, eps = 1e-05, ...)

     make.time.unique(x, eps = 1e-05, ...)

Arguments:

       x: An xts object, or POSIXct vector.

     eps: value to add to force uniqueness.

     ...: unused

Details:

     The returned time-series object will have new time-stamps so that
     'isOrdered( .index(x) )' evaluates to TRUE.

Value:

     A modified version of x.

Note:

     Incoming values must be pre-sorted, and no check is done to make
     sure that this is the case.  If the index values are of
     storage.mode 'integer', they will be coerced to 'double'.

Author(s):

     Jeffrey A. Ryan

See Also:

     'align.time'

Examples:

     ds <- options(digits.secs=6) # so we can see the change

     x <- xts(1:10, as.POSIXct("2011-01-21") + c(1,1,1,2:8)/1e3)
     x
     make.index.unique(x)

     options(ds)



On Mon, Jan 31, 2011 at 6:05 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Monday, January 31, 2011 12:55:03 am Worik wrote:
>> I am having trouble with non-unique time stamps in an xts.
>>
>> My underlying data has some repeated rows (in a csv file).
>>
>> How can I easily get rid of the duplicates?
>>
>> I feel I must be missing something simple.  If not I can concoct an
>> example to illustrate my problem.
>
> Worik,
>
> It depends on what you need.
>
> If you can remove the rows with duplicated indices, then a construction such
> as:
>
> myxts<-myxts[!duplicated(index(myxts))]
>
> should work.
>
> If you need all of the observations, and need to artificially make them unique
> (as is a common problem with tick data), then you will see discussion in the
> list archives here and other places regarding adding artificial indices to high
> frequency data while preserving order. You will need the latest xts from R-
> Forge and use a construction like this:
>
> myxts<-make.unique.index(myxts)
>
> which will (by default) add .00001 sec to each non-unique index after the
> first, preserving order, and providing every observation with a unique index.
> Note that this presumes that the original order of the observations was
> correct in the first place, no provision has been made if you have different
> circumstances.
>
> Thanks to Jeff Ryan for (very) recently adding this second method.
>
> Regards,
>
>  - Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



--
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


This e-mail and any materials attached hereto, including, without limitation, all content hereof and thereof (collectively, "XR Content") are confidential and proprietary to XR Trading, LLC ("XR") and/or its affiliates, and are protected by intellectual property laws.  Without the prior written consent of XR, the XR Content may not (i) be disclosed to any third party or (ii) be reproduced or otherwise used by anyone other than current employees of XR or its affiliates, on behalf of XR or its affiliates.

THE XR CONTENT IS PROVIDED AS IS, WITHOUT REPRESENTATIONS OR WARRANTIES OF ANY KIND.  TO THE MAXIMUM EXTENT PERMISSIBLE UNDER APPLICABLE LAW, XR HEREBY DISCLAIMS ANY AND ALL WARRANTIES, EXPRESS AND IMPLIED, RELATING TO THE XR CONTENT, AND NEITHER XR NOR ANY OF ITS AFFILIATES SHALL IN ANY EVENT BE LIABLE FOR ANY DAMAGES OF ANY NATURE WHATSOEVER, INCLUDING, BUT NOT LIMITED TO, DIRECT, INDIRECT, CONSEQUENTIAL, SPECIAL AND PUNITIVE DAMAGES, LOSS OF PROFITS AND TRADING LOSSES, RESULTING FROM ANY PERSON'S USE OR RELIANCE UPON, OR INABILITY TO USE, ANY XR CONTENT, EVEN IF XR IS ADVISED OF THE POSSIBILITY OF SUCH DAMAGES OR IF SUCH DAMAGES WERE FORESEEABLE.


From megh700004 at gmail.com  Mon Jan 31 18:51:15 2011
From: megh700004 at gmail.com (Megh Dal)
Date: Mon, 31 Jan 2011 23:21:15 +0530
Subject: [R-SIG-Finance] Question on zoo time series
Message-ID: <AANLkTikErds3djaaSqYrTS+MDhYG_CnrYecwpP49ZjdE@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110131/faa57ca4/attachment.pl>

From ggrothendieck at gmail.com  Mon Jan 31 19:21:27 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 31 Jan 2011 13:21:27 -0500
Subject: [R-SIG-Finance] Question on zoo time series
In-Reply-To: <AANLkTikErds3djaaSqYrTS+MDhYG_CnrYecwpP49ZjdE@mail.gmail.com>
References: <AANLkTikErds3djaaSqYrTS+MDhYG_CnrYecwpP49ZjdE@mail.gmail.com>
Message-ID: <AANLkTim98NUjOs_8vJt9WD_bgNBzyYjgrKCVbr9H93na@mail.gmail.com>

On Mon, Jan 31, 2011 at 12:51 PM, Megh Dal <megh700004 at gmail.com> wrote:
> Hi, let say, I have following execution:
>
> ?> library(zoo)
>> library(quantmod)
>> PriceDat <- as.zoo(get(getSymbols("APL"))[,4])
>> is.numeric(PriceDat)
> [1] TRUE
>> PriceDat <- zoo(data.frame(Price=coredata(PriceDat), Others="APL"),
> index(PriceDat))
>> is.numeric(PriceDat$Price)
> [1] FALSE
>>
>
>
> Here surpricingly, once I create a data-frame I see that "Price"
> observations become non-numeric. Can someone please explain this, why it is
> so? Shouldn't I expect it will remain Numeric?
>

What you have actually done is create a data frame in which one column
is c("APL", "APL", ..., "APL") and then tried to convert that to zoo.

What you intended was likely:

merge(PriceDat, APL)


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From stephen at organicfoodmarkets.com.au  Tue Feb  1 00:14:14 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 01 Feb 2011 10:14:14 +1100
Subject: [R-SIG-Finance] IBrokers - problems getting prices with reqMktData
Message-ID: <4D474246.7000003@organicfoodmarkets.com.au>

Hi

I am running on windows using an IB workstation with R talking to it.

It all seems to work, but I find that when running my own callback (code 
attached):

   1. I have to make sure I start a clean (new) command windows or
      something goes wrong with the allocation of a transaction id via
      reqIds (Ok I just work around by opening a new command prompt and
   2. (big problem) I don't always get the prices back so the algorithms
      don't always work.  For example this is the output of that code:

[1] "Existing Position: JBH " "18.51"
[3] "MYR "                    "3.65"
[5] "Spread "                 "14.86"
2 -1 2103 Market data farm connection is broken:aufarm
[1] "I HAVE TRADED AT AVERAGE CLOSING SHORT. SELL"
[2] "52"
[3] "JBH. BUY"
[4] "280"
[5] "MYR"
[1] "Time"                    "2011-01-31 15:34:02.373"
[1] "LEI "                                NA
[3] "WOR "                                NA
[5] "Spread "                             NA
[7] "The boundaries are 4.46697721920205" "lower 2.44602278079795"
[9] " mean is 3.4565"
[1] "QBE "                                NA
[3] "AMP "                                NA
[5] "Spread "                             NA
[7] "The boundaries are 13.3779288310757" "lower 12.2030711689243"
[9] " mean is 12.7905"
[1] "QBE "                                NA
[3] "AXA "                                NA
[5] "Spread "                             NA
[7] "The boundaries are 12.1631661762672" "lower 11.1048338237328"
[9] " mean is 11.634"

I'm getting the prices for JBH and MYR but not for the other stocks.  
The boundary/mean figures are hard coded in my function but were 
obtained in a previous IB call but that was a different call 
reqHistoricalData where as this is reqMktData.  My perl code to manage 
that part of the exercise is attached.

One thing I have noticed is that if I get my trader work station to show 
the price and stop and restart my trading.R code I do get a price.  Does 
anyone else have experience of reqMktData not showing prices if they are 
not live on the TWS?
-- 
Stephen Choularton Ph.D., FIoD


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: trading.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110201/48e63050/attachment.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: make.pl
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110201/48e63050/attachment-0001.pl>

From josh.m.ulrich at gmail.com  Tue Feb  1 02:23:13 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 31 Jan 2011 19:23:13 -0600
Subject: [R-SIG-Finance] IBrokers - problems getting prices with
	reqMktData
In-Reply-To: <4D474246.7000003@organicfoodmarkets.com.au>
References: <4D474246.7000003@organicfoodmarkets.com.au>
Message-ID: <AANLkTi=2XTfMyogCkp0Mo2+pWdsHx=Fu6KL84snR2YjC@mail.gmail.com>

Stephen,

You're asking others to do an awful lot of work for you for free and
in their spare time.  You're asking others to help debug ~800 lines of
your code (not just R, but Perl as well!).  I would be surprised if
anyone helps you with this (unless the issue is obvious to them).

I don't say this to chide, but to help you ask questions that are more
likely to be answered.  Someone will be much more likely to help you
if you create a minimal example (without Perl) that replicates this
issue with your callback code.

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Mon, Jan 31, 2011 at 5:14 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Hi
>
> I am running on windows using an IB workstation with R talking to it.
>
> It all seems to work, but I find that when running my own callback (code
> attached):
>
> ?1. I have to make sure I start a clean (new) command windows or
> ? ? something goes wrong with the allocation of a transaction id via
> ? ? reqIds (Ok I just work around by opening a new command prompt and
> ?2. (big problem) I don't always get the prices back so the algorithms
> ? ? don't always work. ?For example this is the output of that code:
>
> [1] "Existing Position: JBH " "18.51"
> [3] "MYR " ? ? ? ? ? ? ? ? ? ?"3.65"
> [5] "Spread " ? ? ? ? ? ? ? ? "14.86"
> 2 -1 2103 Market data farm connection is broken:aufarm
> [1] "I HAVE TRADED AT AVERAGE CLOSING SHORT. SELL"
> [2] "52"
> [3] "JBH. BUY"
> [4] "280"
> [5] "MYR"
> [1] "Time" ? ? ? ? ? ? ? ? ? ?"2011-01-31 15:34:02.373"
> [1] "LEI " ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?NA
> [3] "WOR " ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?NA
> [5] "Spread " ? ? ? ? ? ? ? ? ? ? ? ? ? ? NA
> [7] "The boundaries are 4.46697721920205" "lower 2.44602278079795"
> [9] " mean is 3.4565"
> [1] "QBE " ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?NA
> [3] "AMP " ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?NA
> [5] "Spread " ? ? ? ? ? ? ? ? ? ? ? ? ? ? NA
> [7] "The boundaries are 13.3779288310757" "lower 12.2030711689243"
> [9] " mean is 12.7905"
> [1] "QBE " ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?NA
> [3] "AXA " ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?NA
> [5] "Spread " ? ? ? ? ? ? ? ? ? ? ? ? ? ? NA
> [7] "The boundaries are 12.1631661762672" "lower 11.1048338237328"
> [9] " mean is 11.634"
>
> I'm getting the prices for JBH and MYR but not for the other stocks. ?The
> boundary/mean figures are hard coded in my function but were obtained in a
> previous IB call but that was a different call reqHistoricalData where as
> this is reqMktData. ?My perl code to manage that part of the exercise is
> attached.
>
> One thing I have noticed is that if I get my trader work station to show the
> price and stop and restart my trading.R code I do get a price. ?Does anyone
> else have experience of reqMktData not showing prices if they are not live
> on the TWS?
> --
> Stephen Choularton Ph.D., FIoD
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From stephen at organicfoodmarkets.com.au  Tue Feb  1 03:05:45 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 01 Feb 2011 13:05:45 +1100
Subject: [R-SIG-Finance] IBrokers - problems getting prices with
	reqMktData
In-Reply-To: <AANLkTi=2XTfMyogCkp0Mo2+pWdsHx=Fu6KL84snR2YjC@mail.gmail.com>
References: <4D474246.7000003@organicfoodmarkets.com.au>
	<AANLkTi=2XTfMyogCkp0Mo2+pWdsHx=Fu6KL84snR2YjC@mail.gmail.com>
Message-ID: <4D476A79.3070105@organicfoodmarkets.com.au>

Hi Joshua

No, I should have said I don't expect anyone to debug this - indeed I 
think it is probably something to do with TWS and how current market 
data rather than historic market data is managed and solving that might 
be getting rather outside the scope of the forum.

However, I was just wondering if someone else had a similar problem 
which would be likely if it is a 'system' type problem as likely as lots 
of people must be using reqMktData.

I once got into trouble with my lecturer when doing a 3rd year unit 
taking apart an emulation of the unix operating system.  He always said 
look at man, etc but this misses the well used technique of looking at 
your friend on the work bench and saying 'has that ever happened to 
you'.  You don't expect a free lunch, but a response often makes things 
a lot clearer.

I actually think the sort of help that web based groups (and 
particularly those associated with R) give is fantastic.

I had better make it clear in future posts that I don't want someone to 
work on an issue when all I want is a reaction if it has also happened 
to them.

Stephen Choularton Ph.D., FIoD


On 01/02/2011 12:23 PM, Joshua Ulrich wrote:
> Stephen,
>
> You're asking others to do an awful lot of work for you for free and
> in their spare time.  You're asking others to help debug ~800 lines of
> your code (not just R, but Perl as well!).  I would be surprised if
> anyone helps you with this (unless the issue is obvious to them).
>
> I don't say this to chide, but to help you ask questions that are more
> likely to be answered.  Someone will be much more likely to help you
> if you create a minimal example (without Perl) that replicates this
> issue with your callback code.
>
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
> On Mon, Jan 31, 2011 at 5:14 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>> Hi
>>
>> I am running on windows using an IB workstation with R talking to it.
>>
>> It all seems to work, but I find that when running my own callback (code
>> attached):
>>
>>   1. I have to make sure I start a clean (new) command windows or
>>      something goes wrong with the allocation of a transaction id via
>>      reqIds (Ok I just work around by opening a new command prompt and
>>   2. (big problem) I don't always get the prices back so the algorithms
>>      don't always work.  For example this is the output of that code:
>>
>> [1] "Existing Position: JBH " "18.51"
>> [3] "MYR "                    "3.65"
>> [5] "Spread "                 "14.86"
>> 2 -1 2103 Market data farm connection is broken:aufarm
>> [1] "I HAVE TRADED AT AVERAGE CLOSING SHORT. SELL"
>> [2] "52"
>> [3] "JBH. BUY"
>> [4] "280"
>> [5] "MYR"
>> [1] "Time"                    "2011-01-31 15:34:02.373"
>> [1] "LEI "                                NA
>> [3] "WOR "                                NA
>> [5] "Spread "                             NA
>> [7] "The boundaries are 4.46697721920205" "lower 2.44602278079795"
>> [9] " mean is 3.4565"
>> [1] "QBE "                                NA
>> [3] "AMP "                                NA
>> [5] "Spread "                             NA
>> [7] "The boundaries are 13.3779288310757" "lower 12.2030711689243"
>> [9] " mean is 12.7905"
>> [1] "QBE "                                NA
>> [3] "AXA "                                NA
>> [5] "Spread "                             NA
>> [7] "The boundaries are 12.1631661762672" "lower 11.1048338237328"
>> [9] " mean is 11.634"
>>
>> I'm getting the prices for JBH and MYR but not for the other stocks.  The
>> boundary/mean figures are hard coded in my function but were obtained in a
>> previous IB call but that was a different call reqHistoricalData where as
>> this is reqMktData.  My perl code to manage that part of the exercise is
>> attached.
>>
>> One thing I have noticed is that if I get my trader work station to show the
>> price and stop and restart my trading.R code I do get a price.  Does anyone
>> else have experience of reqMktData not showing prices if they are not live
>> on the TWS?
>> --
>> Stephen Choularton Ph.D., FIoD
>>
>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1204 / Virus Database: 1435/3414 - Release Date: 01/31/11
>
>
>


From worik.stanton at gmail.com  Tue Feb  1 06:02:56 2011
From: worik.stanton at gmail.com (Worik)
Date: Tue, 01 Feb 2011 18:02:56 +1300
Subject: [R-SIG-Finance] Interesting failure in getSymbols src=oanda
Message-ID: <4D479400.9030009@gmail.com>

 > getSymbols("USD/AUD", src = "oanda", auto.assign = FALSE, from = 
as.Date("1992-01-01"), to=as.Date("1992-12-31"))
Error in (grep("PRE", fr)[1]):(grep("PRE", fr)[2]) : NA/NaN argument

It seems that for all years before 1992 I get the error.

Not for other currencies though.

cheers
Worik

-- 
If we amplify everything, we hear nothing.
--


From megh700004 at gmail.com  Tue Feb  1 20:56:29 2011
From: megh700004 at gmail.com (Megh Dal)
Date: Wed, 2 Feb 2011 01:26:29 +0530
Subject: [R-SIG-Finance] Selecting a subset of date range
Message-ID: <AANLkTi=QG5QNbsKjkChqqvFWBx+hPQui5LcWcz6e+fQb@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110202/d70cc132/attachment.pl>

From brian at braverock.com  Tue Feb  1 21:02:30 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 01 Feb 2011 14:02:30 -0600
Subject: [R-SIG-Finance] Selecting a subset of date range
In-Reply-To: <AANLkTi=QG5QNbsKjkChqqvFWBx+hPQui5LcWcz6e+fQb@mail.gmail.com>
References: <AANLkTi=QG5QNbsKjkChqqvFWBx+hPQui5LcWcz6e+fQb@mail.gmail.com>
Message-ID: <4D4866D6.1040506@braverock.com>

On 02/01/2011 01:56 PM, Megh Dal wrote:
> If I have a sequence of dates then how can I select a subset of this
> sequence? For example suppose, I have following sequence of dates:
>
> dat_seq<- seq(as.Date("2000-01-01"), as.Date("2010-01-01"), by="1 day")
>
> Now I want to select all dates of above sequence (this sequence may not be
> continuous like above!) from "as.Date("2007-01-01")" to
> "as.Date("2007-12-01"))", how can I achieve that? I have tried following
> without any success:

As has been said many times on this list and elsewhere, use xts for 
financial time series.  Subsetting is intuitive, fast, and reliable:

# starting from your sequence
dat_seq <- seq(as.Date("2000-01-01"), as.Date("2010-01-01"), by="1 day")
#create some dummy data, it need not be continuous
x<-xts(rnorm(length(dat_seq)),order.by=dat_seq)
#subset using ISO date subsetting
x['2007-01-01::2007-12-01']

Cheers,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jeffrey.ryan at lemnica.com  Tue Feb  1 21:07:49 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 1 Feb 2011 14:07:49 -0600
Subject: [R-SIG-Finance] Selecting a subset of date range
In-Reply-To: <4D4866D6.1040506@braverock.com>
References: <AANLkTi=QG5QNbsKjkChqqvFWBx+hPQui5LcWcz6e+fQb@mail.gmail.com>
	<4D4866D6.1040506@braverock.com>
Message-ID: <AANLkTi=m8hqpq1-wRSzCLsbZnR2j63GEtp=4yGYi9C4X@mail.gmail.com>

You can also use the subsetting in xts without using xts per se
(though a proper time-series is really the best idea)

> library(xts)
Loading required package: zoo
> x <- timeBasedSeq("20000101/20100101")
> x <- xts(rep(1, length(x)), x)

> str( x['20070101/200712'] )
An ?xts? object from 2007-01-01 to 2007-12-31 containing:
  Data: num [1:365, 1] 1 1 1 1 1 1 1 1 1 1 ...
  Indexed by objects of class: [Date] TZ: America/Chicago
  xts Attributes:
 NULL

> str( x['20070101/20071201'] )
An ?xts? object from 2007-01-01 to 2007-12-01 containing:
  Data: num [1:335, 1] 1 1 1 1 1 1 1 1 1 1 ...
  Indexed by objects of class: [Date] TZ: America/Chicago
  xts Attributes:
 NULL

> str( index(x['20070101/20071201']) )
Class 'Date'  num [1:335] 13514 13515 13516 13517 13518 ...


Lots more in the xts vignette and in the archives here.

In addition to the ISO8601 semantics which make it easier to
read/understand, you also benefit from a very fast binary search and C
memcpy - effectively the fastest way to subset possible.  The column
extraction alone is 10x faster than an R matrix.  And the binary
search is O(log n) - so even billions of observations are able to be
subset with precision, and nearly instantly (well, linear in time with
the length of the resultant subset)

Best,
Jeff

On Tue, Feb 1, 2011 at 2:02 PM, Brian G. Peterson <brian at braverock.com> wrote:
> On 02/01/2011 01:56 PM, Megh Dal wrote:
>>
>> If I have a sequence of dates then how can I select a subset of this
>> sequence? For example suppose, I have following sequence of dates:
>>
>> dat_seq<- seq(as.Date("2000-01-01"), as.Date("2010-01-01"), by="1 day")
>>
>> Now I want to select all dates of above sequence (this sequence may not be
>> continuous like above!) from "as.Date("2007-01-01")" to
>> "as.Date("2007-12-01"))", how can I achieve that? I have tried following
>> without any success:
>
> As has been said many times on this list and elsewhere, use xts for
> financial time series. ?Subsetting is intuitive, fast, and reliable:
>
> # starting from your sequence
> dat_seq <- seq(as.Date("2000-01-01"), as.Date("2010-01-01"), by="1 day")
> #create some dummy data, it need not be continuous
> x<-xts(rnorm(length(dat_seq)),order.by=dat_seq)
> #subset using ISO date subsetting
> x['2007-01-01::2007-12-01']
>
> Cheers,
>
> ?- Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From Peter.Brecknock at bp.com  Tue Feb  1 22:59:57 2011
From: Peter.Brecknock at bp.com (Pete Brecknock)
Date: Tue, 1 Feb 2011 13:59:57 -0800
Subject: [R-SIG-Finance] Selecting a subset of date range
In-Reply-To: <AANLkTi=QG5QNbsKjkChqqvFWBx+hPQui5LcWcz6e+fQb@mail.gmail.com>
References: <AANLkTi=QG5QNbsKjkChqqvFWBx+hPQui5LcWcz6e+fQb@mail.gmail.com>
Message-ID: <1296597597703-3253045.post@n4.nabble.com>


... or, if you are wedded to the window() approach, you could use the match
function ....

dat_seq <- seq(as.Date("2000-01-01"), as.Date("2010-01-01"), by="1 day")

window(dat_seq, start= match(as.Date("2000-01-01"), dat_seq),
                        end = match(as.Date("2007-01-01"), dat_seq))

HTH

Pete


-- 
View this message in context: http://r.789695.n4.nabble.com/Selecting-a-subset-of-date-range-tp3252845p3253045.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From lui.r.project at googlemail.com  Wed Feb  2 00:33:34 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Tue, 1 Feb 2011 18:33:34 -0500
Subject: [R-SIG-Finance] Free Stock Quotes - Yahoo Finance & Adjusted
	Closing Prices
Message-ID: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>

Dear Group,

I am looking for some freely available stock data on an adjusted basis
(as the stock data I got from other costly sources are neither
corrected for stock splits and dividends...).
I tried Yahoo and had the following code retrieve quotes for the DAX
and its companies (except BASF):

library(fImport)
library(its)

Daxstocks <- c("ADS.DE","ALV.DE","BAYN.DE","BEI.DE","BMW.DE","CBK.DE","DAI.DE","DBK.DE","DB1.DE","LHA.DE","DPW.DE","DTE.DE","EOAN.DE","FME.DE","FRE.DE","HEI.DE","HEN3.DE","IFX.DE","SDF.DE","LIN.DE","MAN.DE","MEO.DE","MRK.DE","MUV2.DE","RWE.DE","SAP.DE","SIE.DE","TKA.DE","VOW3.DE")
StockData <- yahooSeries(Daxstocks, from = "2003-01-01", to = "2011-02-01")

Reihen <- ncol(StockData) %/% 6
StockData.adj <- cbind(StockData[,6])
for (i in 2:Reihen){
StockData.adj <- cbind(StockData.adj,StockData[,6*i])
}

write.csv(StockData.adj,"Yahoo_DataImport.csv")
stocks <- its(StockData.adj)
plot(stocks)

The dataimport works well - however the adjustments do not always seem
reasonable to me... Several companies (e.g. Adidas - ADS.DE,
Beiersdorf - BEI.DE) have had a stock split - but its not reflected in
the adjusted price (only in the UNADJUSTED closing price). Did anybody
have a similar problem? Were the adjustments for splits are not made
for the quoted adjusted prices but seemingly for the unadjusted? I
thought that Yahoo might have mixed up the columns, but the
"unadjusted closing prices" sometimes is indeed unadjusted...
Does anybody have experience with Yahoo Finance data?
Or even better: Does anybody have a more reliable source of stock data
(preferably german stocks).
Thank you very much!
Have a nice week!

Lui


From guygreen at netvigator.com  Wed Feb  2 01:21:00 2011
From: guygreen at netvigator.com (Guy Green)
Date: Tue, 1 Feb 2011 16:21:00 -0800
Subject: [R-SIG-Finance] Free Stock Quotes - Yahoo Finance & Adjusted
	Closing Prices
In-Reply-To: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
References: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
Message-ID: <1296606060376-3253230.post@n4.nabble.com>


The short answer is that Yahoo sometimes has mistakes, including the issue of
splits/bonus issues being improperly reflected.  You will on occasions see
the same thing with every data provider, including the best known paid
providers.  As far as I know, the Yahoo price data is not their own - I
think they get it from a wholesale data provider.

I would suggest that you contact Yahoo.  They will fix it if you explain the
error - it might take a couple of days.  Use their "
http://help.yahoo.com/l/us/yahoo/finance/dataissues.html Yahoo! Finance Data
Inaccuracy Form "

Guy


Lui ## wrote:
> 
> The dataimport works well - however the adjustments do not always seem
> reasonable to me... Several companies (e.g. Adidas - ADS.DE,
> Beiersdorf - BEI.DE) have had a stock split - but its not reflected in
> the adjusted price (only in the UNADJUSTED closing price). Did anybody
> have a similar problem? Were the adjustments for splits are not made
> for the quoted adjusted prices but seemingly for the unadjusted? I
> thought that Yahoo might have mixed up the columns, but the
> "unadjusted closing prices" sometimes is indeed unadjusted...
> Does anybody have experience with Yahoo Finance data?
> Or even better: Does anybody have a more reliable source of stock data
> (preferably german stocks).
> Thank you very much!
> Have a nice week!
> 
> Lui
> 

-- 
View this message in context: http://r.789695.n4.nabble.com/Free-Stock-Quotes-Yahoo-Finance-Adjusted-Closing-Prices-tp3253189p3253230.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From lui.r.project at googlemail.com  Wed Feb  2 01:25:11 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Tue, 1 Feb 2011 19:25:11 -0500
Subject: [R-SIG-Finance] Free Stock Quotes - Yahoo Finance & Adjusted
 Closing Prices
In-Reply-To: <1296606060376-3253230.post@n4.nabble.com>
References: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
	<1296606060376-3253230.post@n4.nabble.com>
Message-ID: <AANLkTikz-_Jfwi2ftnK1-XCoiSdQ9HiLUMKUEZwadg8Y@mail.gmail.com>

Hello Guy,

thank you very much for your quick response... I will submit the
"inaccuracies" I found.
Any other good stock data provider at hand?
Thanks a lot!

Lui

On Tue, Feb 1, 2011 at 7:21 PM, Guy Green <guygreen at netvigator.com> wrote:
>
> The short answer is that Yahoo sometimes has mistakes, including the issue of
> splits/bonus issues being improperly reflected. ?You will on occasions see
> the same thing with every data provider, including the best known paid
> providers. ?As far as I know, the Yahoo price data is not their own - I
> think they get it from a wholesale data provider.
>
> I would suggest that you contact Yahoo. ?They will fix it if you explain the
> error - it might take a couple of days. ?Use their "
> http://help.yahoo.com/l/us/yahoo/finance/dataissues.html Yahoo! Finance Data
> Inaccuracy Form "
>
> Guy
>
>
> Lui ## wrote:
>>
>> The dataimport works well - however the adjustments do not always seem
>> reasonable to me... Several companies (e.g. Adidas - ADS.DE,
>> Beiersdorf - BEI.DE) have had a stock split - but its not reflected in
>> the adjusted price (only in the UNADJUSTED closing price). Did anybody
>> have a similar problem? Were the adjustments for splits are not made
>> for the quoted adjusted prices but seemingly for the unadjusted? I
>> thought that Yahoo might have mixed up the columns, but the
>> "unadjusted closing prices" sometimes is indeed unadjusted...
>> Does anybody have experience with Yahoo Finance data?
>> Or even better: Does anybody have a more reliable source of stock data
>> (preferably german stocks).
>> Thank you very much!
>> Have a nice week!
>>
>> Lui
>>
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Free-Stock-Quotes-Yahoo-Finance-Adjusted-Closing-Prices-tp3253189p3253230.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From edd at debian.org  Wed Feb  2 01:49:54 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 1 Feb 2011 18:49:54 -0600
Subject: [R-SIG-Finance] Free Stock Quotes - Yahoo Finance &
	Adjusted	Closing Prices
In-Reply-To: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
References: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
Message-ID: <19784.43570.631952.425698@max.nulle.part>


On 1 February 2011 at 18:33, Lui ## wrote:
| Dear Group,
| 
| I am looking for some freely available stock data on an adjusted basis
| (as the stock data I got from other costly sources are neither
| corrected for stock splits and dividends...).

R> library(quantmod)
Loading required package: Defaults
Loading required package: xts
Loading required package: TTR
R> head(getSymbols("IBM", auto.assign=FALSE))
           IBM.Open IBM.High IBM.Low IBM.Close IBM.Volume IBM.Adjusted
2007-01-03    97.18    98.40   96.26     97.27    9196800        90.69
2007-01-04    97.25    98.79   96.88     98.31   10524500        91.66
2007-01-05    97.60    97.95   96.91     97.42    7221300        90.83
2007-01-08    98.50    99.50   98.35     98.90   10340000        92.21
2007-01-09    99.08   100.33   99.07    100.07   11108200        93.30
2007-01-10    98.50    99.05   97.93     98.89    8744800        92.20
R> 

Note the last column above. At it seems to work the same way for German
stocks, modulo possible errors on holidays -- here is Siemens for you:

R> head(getSymbols("SIE.DE", auto.assign=FALSE))
           SIE.DE.Open SIE.DE.High SIE.DE.Low SIE.DE.Close SIE.DE.Volume SIE.DE.Adjusted
2007-01-01       75.14       75.14      75.14        75.14             0           67.40
2007-01-02       76.15       76.25      75.51        75.93       3112300           68.11
2007-01-03       75.85       75.99      75.29        75.51       3612800           67.74
2007-01-04       75.20       75.95      74.98        75.55       4653500           67.77
2007-01-05       75.23       76.40      75.20        75.32       5660700           67.56
2007-01-08       75.78       76.25      74.96        75.45       4412500           67.68
R> 

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From guygreen at netvigator.com  Wed Feb  2 03:34:06 2011
From: guygreen at netvigator.com (Guy Green)
Date: Tue, 1 Feb 2011 18:34:06 -0800
Subject: [R-SIG-Finance] Free Stock Quotes - Yahoo Finance & Adjusted
	Closing Prices
In-Reply-To: <AANLkTikz-_Jfwi2ftnK1-XCoiSdQ9HiLUMKUEZwadg8Y@mail.gmail.com>
References: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
	<1296606060376-3253230.post@n4.nabble.com>
	<AANLkTikz-_Jfwi2ftnK1-XCoiSdQ9HiLUMKUEZwadg8Y@mail.gmail.com>
Message-ID: <1296614046904-3253340.post@n4.nabble.com>


For paid, but non exorbitant, data, other people have previously suggested
www.eoddata.com (I've seen www.csidata.com suggested on other non-R forums
too, but that doesn't cover Germany).

For free and especially for non-US, I haven't found a better source than
Yahoo: in some respects I think Yahoo is better than some of the paid
providers.

Guy


Lui ## wrote:
> 
> Hello Guy,
> 
> thank you very much for your quick response... I will submit the
> "inaccuracies" I found.
> Any other good stock data provider at hand?
> Thanks a lot!
> 
> Lui
> 

-- 
View this message in context: http://r.789695.n4.nabble.com/Free-Stock-Quotes-Yahoo-Finance-Adjusted-Closing-Prices-tp3253189p3253340.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From dutangc at gmail.com  Wed Feb  2 07:17:35 2011
From: dutangc at gmail.com (Christophe Dutang)
Date: Wed, 2 Feb 2011 07:17:35 +0100
Subject: [R-SIG-Finance] Copula and Multivariate distribution
In-Reply-To: <1295896699022-3234744.post@n4.nabble.com>
References: <1295470206311-3225448.post@n4.nabble.com>
	<AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>
	<1295896699022-3234744.post@n4.nabble.com>
Message-ID: <AANLkTi=dFuWejGYKYDq2E9F2UoaX_HNUoWSKqT1qrOBF@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110202/31fa3711/attachment.pl>

From josh.m.ulrich at gmail.com  Wed Feb  2 20:16:32 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 2 Feb 2011 13:16:32 -0600
Subject: [R-SIG-Finance] R/Finance 2011: Call for Papers: Now with
 prices and travel money
In-Reply-To: <19732.50779.560330.531348@max.nulle.part>
References: <19732.50779.560330.531348@max.nulle.part>
Message-ID: <AANLkTimhf+6s-XufB7+w-uxwQeVD1B4+BWiKAp05ZLyB@mail.gmail.com>

A friendly reminder that the call for papers submission deadline is in
approximately two weeks.

On behalf of the committee,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Fri, Dec 24, 2010 at 10:12 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> Dear R / Finance community,
>
> The preparations for R/Finance 2011 are progressing, and due to favourable
> responses from the different sponsors we contacted, we are now able to offer
>
> ?a) a competition for best paper, which given the focus of the conference
> ? ? will award for both an 'academic' paper and an 'industry' paper
>
> ?b) availability of travel grants for up to two graduate students provided
> ? ? suitable papers were accepted for presentations
>
> More details are below in the updated Call for Papers. Please feel free to
> re-circulate this Call for Papers with collegues, students and other
> associations.
>
> Cheers, and Season's Greeting,
>
> Dirk (on behalf of the organizing / program committee)
>
>
>
>
> Call for Papers:
>
> R/Finance 2011: Applied Finance with R
> April 29 and 30, 2011
> Chicago, IL, USA
>
>
> The third annual R/Finance conference for applied finance using R will be
> held this spring in Chicago, IL, USA on April 29 and 30, 2011. ?The two-day
> conference will cover topics including portfolio management, time series
> analysis, advanced risk tools, high-performance computing, market
> microstructure and econometrics. All will be discussed within the context of
> using R as a primary tool for financial risk management, portfolio
> construction, and trading.
>
> Complete papers or one-page abstracts (in txt or pdf format) are invited to
> be submitted for consideration. Academic and practitioner proposals related
> to R are encouraged. We welcome submissions for full talks, abbreviated
> "lightning talks", and for a limited number of pre-conference (longer)
> seminar sessions.
>
>
> Presenters are strongly encouraged to provide working R code to accompany the
> presentation/paper. ?Data sets should also be made public for the purposes of
> reproducibility (though we realize this may be limited due to contracts with
> data vendors). Preference may be given to presenters who have released R
> packages.
>
> The conference will award two $1000 prizes for best paper: one for best
> practitioner-oriented paper and one for best academic-oriented paper.
> Further, to defray costs for graduate students, two travel and expense grants
> of up to $500 each will be awarded to graduate students whose papers are
> accepted. ?To be eligible, a submission must be a full paper; extended
> abstracts are not eligible.
>
> Please send submissions to: committee "at" RinFinance.com
>
> The submission deadline is February 15th, 2011. ?Early submissions may
> receive early acceptance and scheduling. ?The graduate student grant winners
> will be notified by February 23rd, 2011.
>
> Submissions will be evaluated and submitters notified via email on a rolling
> basis. Determination of whether a presentation will be a long presentation or
> a lightning talk will be made once the full list of presenters is known.
>
>
> R/Finance 2009 and 2010 included attendees from around the world and featured
> keynote presentations from prominent academics and practitioners. 2009-2010
> presenters names and presentations are online at the conference website. We
> anticipate another exciting line-up for 2011---including keynote
> presentations from John Bollinger, Mebane Faber, Stefano Iacus, and Louis
> Kates. ?Additional details will be announced via the conference website
> http://www.RinFinance.com/ as they become available.
>
>
> For the program committee:
>
> ? ? ? ?Gib Bassett, Peter Carl, Dirk Eddelbuettel, Brian Peterson,
> ? ? ? ?Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich
>
>
> --
> Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From stephen at organicfoodmarkets.com.au  Thu Feb  3 04:44:53 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 3 Feb 2011 14:44:53 +1100
Subject: [R-SIG-Finance] IBrokers - problems getting prices with
	reqMktData
In-Reply-To: <AANLkTi=2XTfMyogCkp0Mo2+pWdsHx=Fu6KL84snR2YjC@mail.gmail.com>
References: <4D474246.7000003@organicfoodmarkets.com.au>
	<AANLkTi=2XTfMyogCkp0Mo2+pWdsHx=Fu6KL84snR2YjC@mail.gmail.com>
Message-ID: <4D4A24B5.6010909@organicfoodmarkets.com.au>

OK, I have had the opportunity to do some testing and it appears that 
Ibrokers will only pick up reqMktData (at least on ASX stocks) when they 
are also being monitored in the TWS.  I had already established that 
transaction ids are difficult to come by unless you commence a new 
process (at least in windows) so the take home from that, until I or 
someone else has the time to look into it, is that you should always 
start a new command prompt to run R at if you want to deal and also you 
should have any stocks you want to get the prices of into R being 
monitored in the TWS on your computer.  Hope that helps anyone trying to 
set up on a windows machine maybe its the same on other os's.

Stephen Choularton Ph.D., FIoD


On 01/02/2011 12:23 PM, Joshua Ulrich wrote:
> Stephen,
>
> You're asking others to do an awful lot of work for you for free and
> in their spare time.  You're asking others to help debug ~800 lines of
> your code (not just R, but Perl as well!).  I would be surprised if
> anyone helps you with this (unless the issue is obvious to them).
>
> I don't say this to chide, but to help you ask questions that are more
> likely to be answered.  Someone will be much more likely to help you
> if you create a minimal example (without Perl) that replicates this
> issue with your callback code.
>
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
> On Mon, Jan 31, 2011 at 5:14 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>> Hi
>>
>> I am running on windows using an IB workstation with R talking to it.
>>
>> It all seems to work, but I find that when running my own callback (code
>> attached):
>>
>>   1. I have to make sure I start a clean (new) command windows or
>>      something goes wrong with the allocation of a transaction id via
>>      reqIds (Ok I just work around by opening a new command prompt and
>>   2. (big problem) I don't always get the prices back so the algorithms
>>      don't always work.  For example this is the output of that code:
>>
>> [1] "Existing Position: JBH " "18.51"
>> [3] "MYR "                    "3.65"
>> [5] "Spread "                 "14.86"
>> 2 -1 2103 Market data farm connection is broken:aufarm
>> [1] "I HAVE TRADED AT AVERAGE CLOSING SHORT. SELL"
>> [2] "52"
>> [3] "JBH. BUY"
>> [4] "280"
>> [5] "MYR"
>> [1] "Time"                    "2011-01-31 15:34:02.373"
>> [1] "LEI "                                NA
>> [3] "WOR "                                NA
>> [5] "Spread "                             NA
>> [7] "The boundaries are 4.46697721920205" "lower 2.44602278079795"
>> [9] " mean is 3.4565"
>> [1] "QBE "                                NA
>> [3] "AMP "                                NA
>> [5] "Spread "                             NA
>> [7] "The boundaries are 13.3779288310757" "lower 12.2030711689243"
>> [9] " mean is 12.7905"
>> [1] "QBE "                                NA
>> [3] "AXA "                                NA
>> [5] "Spread "                             NA
>> [7] "The boundaries are 12.1631661762672" "lower 11.1048338237328"
>> [9] " mean is 11.634"
>>
>> I'm getting the prices for JBH and MYR but not for the other stocks.  The
>> boundary/mean figures are hard coded in my function but were obtained in a
>> previous IB call but that was a different call reqHistoricalData where as
>> this is reqMktData.  My perl code to manage that part of the exercise is
>> attached.
>>
>> One thing I have noticed is that if I get my trader work station to show the
>> price and stop and restart my trading.R code I do get a price.  Does anyone
>> else have experience of reqMktData not showing prices if they are not live
>> on the TWS?
>> --
>> Stephen Choularton Ph.D., FIoD
>>
>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1204 / Virus Database: 1435/3414 - Release Date: 01/31/11
>
>
>


From ravis at ambaresearch.com  Thu Feb  3 11:34:37 2011
From: ravis at ambaresearch.com (Ravi S. Shankar)
Date: Thu, 3 Feb 2011 16:04:37 +0530
Subject: [R-SIG-Finance] Help in generalizing code
Message-ID: <884B4FEAC5A34B4C91B01D3DFF3D0F2B0E1F5D@BAN-MAILSRV02.Amba.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110203/467c6bd2/attachment.pl>

From paulteetor at yahoo.com  Thu Feb  3 14:54:34 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Thu, 3 Feb 2011 05:54:34 -0800 (PST)
Subject: [R-SIG-Finance] Help in generalizing code
In-Reply-To: <884B4FEAC5A34B4C91B01D3DFF3D0F2B0E1F5D@BAN-MAILSRV02.Amba.com>
References: <884B4FEAC5A34B4C91B01D3DFF3D0F2B0E1F5D@BAN-MAILSRV02.Amba.com>
Message-ID: <20197.96378.qm@web56007.mail.re3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110203/3dab5745/attachment.pl>

From ravis at ambaresearch.com  Thu Feb  3 15:13:37 2011
From: ravis at ambaresearch.com (Ravi S. Shankar)
Date: Thu, 3 Feb 2011 19:43:37 +0530
Subject: [R-SIG-Finance] Help in generalizing code
References: <884B4FEAC5A34B4C91B01D3DFF3D0F2B0E1F5D@BAN-MAILSRV02.Amba.com>
	<20197.96378.qm@web56007.mail.re3.yahoo.com>
Message-ID: <884B4FEAC5A34B4C91B01D3DFF3D0F2B0E1F7D@BAN-MAILSRV02.Amba.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110203/6c55f48d/attachment.pl>

From lui.r.project at googlemail.com  Thu Feb  3 21:15:34 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Thu, 3 Feb 2011 21:15:34 +0100
Subject: [R-SIG-Finance] Free Stock Quotes - Yahoo Finance & Adjusted
 Closing Prices
In-Reply-To: <AANLkTi=QtN6yq_0+nJLxrjNzGjb1oE0cC-LumwLYPHvt@mail.gmail.com>
References: <AANLkTim7ZxJvaP9LWK4WoGz_960jdGC2NJaStihD==Fj@mail.gmail.com>
	<AANLkTi=QtN6yq_0+nJLxrjNzGjb1oE0cC-LumwLYPHvt@mail.gmail.com>
Message-ID: <AANLkTi=hHftMqF1Yo6Uq_Or-XmjQeOk++NbD0stJSHRR@mail.gmail.com>

@Dirk: Thank you very much for the suggestion! I am currently trying it out!

@Mark: Unfortunately they dont (XETRA). And it is quite expensive for
my budget (600 Euro for one year of data)

@Guy: Thank you for the suggestion! But as by now they do not have the
german market...

Thanks for your help! Seems like there is SOME free lunch :-)
Have a nice week!

Lui

On Wed, Feb 2, 2011 at 7:43 AM, Mark Breman <breman.mark at gmail.com> wrote:
> Have you checked the website of the exchange. Sometimes they offer
> historical data downloads...
>
> 2011/2/2 Lui ## <lui.r.project at googlemail.com>
>>
>> Dear Group,
>>
>> I am looking for some freely available stock data on an adjusted basis
>> (as the stock data I got from other costly sources are neither
>> corrected for stock splits and dividends...).
>> I tried Yahoo and had the following code retrieve quotes for the DAX
>> and its companies (except BASF):
>>
>> library(fImport)
>> library(its)
>>
>> Daxstocks <-
>> c("ADS.DE","ALV.DE","BAYN.DE","BEI.DE","BMW.DE","CBK.DE","DAI.DE","DBK.DE","DB1.DE","LHA.DE","DPW.DE","DTE.DE","EOAN.DE","FME.DE","FRE.DE","HEI.DE","HEN3.DE","IFX.DE","SDF.DE","LIN.DE","MAN.DE","MEO.DE","MRK.DE","MUV2.DE","RWE.DE","SAP.DE","SIE.DE","TKA.DE","VOW3.DE")
>> StockData <- yahooSeries(Daxstocks, from = "2003-01-01", to =
>> "2011-02-01")
>>
>> Reihen <- ncol(StockData) %/% 6
>> StockData.adj <- cbind(StockData[,6])
>> for (i in 2:Reihen){
>> StockData.adj <- cbind(StockData.adj,StockData[,6*i])
>> }
>>
>> write.csv(StockData.adj,"Yahoo_DataImport.csv")
>> stocks <- its(StockData.adj)
>> plot(stocks)
>>
>> The dataimport works well - however the adjustments do not always seem
>> reasonable to me... Several companies (e.g. Adidas - ADS.DE,
>> Beiersdorf - BEI.DE) have had a stock split - but its not reflected in
>> the adjusted price (only in the UNADJUSTED closing price). Did anybody
>> have a similar problem? Were the adjustments for splits are not made
>> for the quoted adjusted prices but seemingly for the unadjusted? I
>> thought that Yahoo might have mixed up the columns, but the
>> "unadjusted closing prices" sometimes is indeed unadjusted...
>> Does anybody have experience with Yahoo Finance data?
>> Or even better: Does anybody have a more reliable source of stock data
>> (preferably german stocks).
>> Thank you very much!
>> Have a nice week!
>>
>> Lui
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
>


From corwinjoy at gmail.com  Sat Feb  5 01:46:44 2011
From: corwinjoy at gmail.com (Corwin Joy)
Date: Fri, 4 Feb 2011 16:46:44 -0800
Subject: [R-SIG-Finance] Point and Figure Charting
Message-ID: <AANLkTi=PMVoHS=d1R9kykgBSEL237uaMtRnyVyT34zVv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110204/98bcd08f/attachment.pl>

From bkheijonathan at gmail.com  Sat Feb  5 20:31:00 2011
From: bkheijonathan at gmail.com (B. Jonathan B. Jonathan)
Date: Sun, 6 Feb 2011 01:01:00 +0530
Subject: [R-SIG-Finance] I have a problem with zoo object
Message-ID: <AANLkTimXu9uU5KheG_2sr9uYd26XNwD-=CBf19f3er9J@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110206/02fe52ad/attachment.pl>

From brian at braverock.com  Sat Feb  5 20:51:04 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 05 Feb 2011 13:51:04 -0600
Subject: [R-SIG-Finance] I have a problem with zoo object
In-Reply-To: <AANLkTimXu9uU5KheG_2sr9uYd26XNwD-=CBf19f3er9J@mail.gmail.com>
References: <AANLkTimXu9uU5KheG_2sr9uYd26XNwD-=CBf19f3er9J@mail.gmail.com>
Message-ID: <4D4DAA28.70601@braverock.com>

On 02/05/2011 01:31 PM, B. Jonathan B. Jonathan wrote:
> Hi all, can somebody correct me where I was wrong in following set of codes?
> I have a list where each element is zoo object and I want to call a
> particular zoo object through some assigned name, as follows:
>
>> library(zoo)
>> List<- vector("list", length=2)
>> names(List)<- LETTERS[1:2]
>> List[[1]]<- zooreg(rnorm(10), start=as.Date("2000-01-01"), frequency=1)
>> List[[2]]<- zooreg(rnorm(20), start=as.Date("2000-01-01"), frequency=11)
>> #List
>> namess<- "A"
>> window(List$namess, start=as.Date("2000-01-01"),
> end=as.Date("2000-01-01"))
> Error in attr(x, "tsp")<- c(1, NROW(x), 1) :
>    attempt to set an attribute on NULL

This is a general question that should have gone to R-help, not here.

you don't have a slot called 'namess'

You have a string called 'namess'

So,

List[[namess]]

will work.

Please direct non-finance-specific queries to R-help in the future.

    - Brian


From ggrothendieck at gmail.com  Sat Feb  5 22:44:07 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 5 Feb 2011 16:44:07 -0500
Subject: [R-SIG-Finance] I have a problem with zoo object
In-Reply-To: <AANLkTimXu9uU5KheG_2sr9uYd26XNwD-=CBf19f3er9J@mail.gmail.com>
References: <AANLkTimXu9uU5KheG_2sr9uYd26XNwD-=CBf19f3er9J@mail.gmail.com>
Message-ID: <AANLkTinwo1jzNkJiYaNOeeCYAMekpxdGVXrbmYFt+TrJ@mail.gmail.com>

On Sat, Feb 5, 2011 at 2:31 PM, B. Jonathan B. Jonathan
<bkheijonathan at gmail.com> wrote:
> Hi all, can somebody correct me where I was wrong in following set of codes?
> I have a list where each element is zoo object and I want to call a
> particular zoo object through some assigned name, as follows:
>
>> library(zoo)
>> List <- vector("list", length=2)
>> names(List) <- LETTERS[1:2]
>> List[[1]] <- zooreg(rnorm(10), start=as.Date("2000-01-01"), frequency=1)
>> List[[2]] <- zooreg(rnorm(20), start=as.Date("2000-01-01"), frequency=11)
>> #List
>> namess <- "A"
>> window(List$namess, start=as.Date("2000-01-01"),
> end=as.Date("2000-01-01"))
> Error in attr(x, "tsp") <- c(1, NROW(x), 1) :
> ?attempt to set an attribute on NULL

List$namess is the same as List[["namess"]] and there is no "namess"
component of List. You probably wanted:

window(List[[namess]], start=as.Date("2000-01-01"), end=as.Date("2000-01-01"))

or just

List[[namess]][as.Date("2000-01-01")]

or

start(List[[namess]])

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ggrothendieck at gmail.com  Sat Feb  5 22:46:14 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 5 Feb 2011 16:46:14 -0500
Subject: [R-SIG-Finance] I have a problem with zoo object
In-Reply-To: <4D4DAA28.70601@braverock.com>
References: <AANLkTimXu9uU5KheG_2sr9uYd26XNwD-=CBf19f3er9J@mail.gmail.com>
	<4D4DAA28.70601@braverock.com>
Message-ID: <AANLkTin+-D_1CDpwqG-sGCKENrpdxwXpzeEtwe5fGQXA@mail.gmail.com>

On Sat, Feb 5, 2011 at 2:51 PM, Brian G. Peterson <brian at braverock.com> wrote:
> On 02/05/2011 01:31 PM, B. Jonathan B. Jonathan wrote:
>>
>> Hi all, can somebody correct me where I was wrong in following set of
>> codes?
>> I have a list where each element is zoo object and I want to call a
>> particular zoo object through some assigned name, as follows:
>>
>>> library(zoo)
>>> List<- vector("list", length=2)
>>> names(List)<- LETTERS[1:2]
>>> List[[1]]<- zooreg(rnorm(10), start=as.Date("2000-01-01"), frequency=1)
>>> List[[2]]<- zooreg(rnorm(20), start=as.Date("2000-01-01"), frequency=11)
>>> #List
>>> namess<- "A"
>>> window(List$namess, start=as.Date("2000-01-01"),
>>
>> end=as.Date("2000-01-01"))
>> Error in attr(x, "tsp")<- c(1, NROW(x), 1) :
>> ? attempt to set an attribute on NULL
>
> This is a general question that should have gone to R-help, not here.
>
> you don't have a slot called 'namess'
>
> You have a string called 'namess'
>
> So,
>
> List[[namess]]
>
> will work.
>
> Please direct non-finance-specific queries to R-help in the future.
>


r-sig-finance has always been a primary place for zoo questions so
this question seems appropriate for the list to me.  In fact it turns
out that the problem is unrelated to zoo but rather to how lists work
in R but to know that you would have to know the answer.


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From stephen at organicfoodmarkets.com.au  Mon Feb  7 09:15:59 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Mon, 7 Feb 2011 19:15:59 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D41C27A.9030109@braverock.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2C4FA5.2020304@braverock.com>	<4D2EC7A5.80808@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>	<4D4016B1.6050707@braverock.com>
	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>
	<4D41BF20.9080303@organicfoodmarkets.com.au>
	<4D41C27A.9030109@braverock.com>
Message-ID: <4D4FAA3F.5010006@organicfoodmarkets.com.au>

Hi

I just downloaded what I thought was the latest quatstrat and then the 
xts update as I got this:


Failed with error: ?package 'xts' 0.7-6.11 was found, but >= 0.7.6.15 is 
required by 'quantstrat'?
 >

but when I ordered my long rules 'enter' then 'exit' the problem of 
running into that crossing zero problem was still there. When I turned 
the order back to 'exit' then 'enter' it worked again.

I downloaded this zip and installed locally on windows:

	

Specify, build, and back-test quantitative financial trading and 
portfolio strategies

------------------------------------------------------------------------
*Download: * 	
	
	*Package source (.tar.gz) 
<http://r-forge.r-project.org/src/contrib/quantstrat_0.4.0.tar.gz>* | 
*Windows multi-arch binary (.zip) 
<http://r-forge.r-project.org/bin/windows/contrib/latest/quantstrat_0.4.0.zip>* 
| *MacOS X leopard binary (.tgz) 
<http://r-forge.r-project.org/bin/macosx/leopard/contrib/latest/quantstrat_0.4.0.tgz>* 


------------------------------------------------------------------------
*Logs: * 	Linux x86_32 	Linux x86_64 	Windows x86_32/x86_64 	MacOS X 
Leopard
Daily build: 	patched 
<http://r-forge.r-project.org/R/?group_id=316&log=build_src&pkg=quantstrat&flavor=patched> 
	patched 
<http://r-forge.r-project.org/R/?group_id=316&log=build_src&pkg=quantstrat&flavor=patched> 
	patched 
<http://r-forge.r-project.org/R/?group_id=316&log=build_win64&pkg=quantstrat&flavor=patched> 
| devel 
<http://r-forge.r-project.org/R/?group_id=316&log=build_win64&pkg=quantstrat&flavor=devel> 
	patched 
<http://r-forge.r-project.org/R/?group_id=316&log=build_mac&pkg=quantstrat&flavor=patched> 
| devel (N/A)
Daily check: 	offline* 	patched 
<http://r-forge.r-project.org/R/?group_id=316&log=check_x86_64_linux&pkg=quantstrat&flavor=patched> 
| devel 
<http://r-forge.r-project.org/R/?group_id=316&log=check_x86_64_linux&pkg=quantstrat&flavor=devel> 
	offline* 	patched 
<http://r-forge.r-project.org/R/?group_id=316&log=check_x86_64_mac&pkg=quantstrat&flavor=patched> 
| devel (N/A)

------------------------------------------------------------------------

To install this package directly within R type: 
*|install.packages("quantstrat", repos="http://R-Forge.R-project.org")|*

Version: *0.4.0* | Last change: *2011-02-04 23:07:03+01* | Rev.: *548*

	



Have I got the wrong quantstrat?

Stephen Choularton Ph.D., FIoD


On 28/01/2011 6:07 AM, Brian G. Peterson wrote:
> On 01/27/2011 12:53 PM, Stephen Choularton wrote:
>> I note that the list
>>
>> "pre","risk","order","rebalance",
>> "exit","enter","entry","post"
>>
>> Contains types that are not in the notes. Can I find some further info
>> on what they are for?
>
> Well, with the exception of 'order', they all (currently) call 
> RuleProc by default, as described in the documentation.
>
> In that regard, they are all 'the same', but will be accessed in the 
> stated order. Since the rule functions themselves are composed of 
> *any* R function, you could do just about anything with a given slot.
>
> That said, the names should be pretty evident, 'pre' and 'post' for 
> pre and post processing at a given observation (we occasionally use a 
> function in these slots to set or remove hold, for example), 
> 'rebalance' for portfolio rules (you'd need to write custom 
> rebalancing functions, 'enter' and 'entry' are synonyms for each other 
> because I mistyped one as the other a couple times and puzzled over 
> why things weren't working.
>
> Per the documentation (thanks to the Stephen's report, Aleksandr's 
> sleuthing, and Josh's patch), for each observation, rules will be 
> evaluated by type, in the order they were declared within that type. 
> 'Stacking' of rules is possible, as is having one rule cancel orders 
> placed by another rule before they have the opportunity to be worked 
> by the 'order' slot. The 'order' slot, by default, also per the 
> documentation, will call ruleOrderProc, though this may be changed by 
> the user to call custom order processing.
>
>> When Joshua says he has 'committed' the changes, does that mean if I
>> download quantstrat the amendments will be incorporated in it?
>
> R-Forge builds changes from SVN daily, so within 24 hours it should 
> show up in the tarball or binary package.
>
>> And finally (for the moment ;-) thanks for the way you all have helped
>> me solve my problems.
>
> Regards,
>
> - Brian
>


From r.jeudy at abc-arbitrage.com  Mon Feb  7 09:58:15 2011
From: r.jeudy at abc-arbitrage.com (Raphael Jeudy)
Date: Mon, 7 Feb 2011 09:58:15 +0100
Subject: [R-SIG-Finance] Gumbel Clayton copula mixture??
Message-ID: <3BC56299C1B27B4FA2FF39164EE02087E50187@vm-abcexch2003.abc-arbitrage.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110207/7a651396/attachment.pl>

From brian at braverock.com  Mon Feb  7 19:40:53 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 07 Feb 2011 12:40:53 -0600
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D4FAA3F.5010006@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2C4FA5.2020304@braverock.com>	<4D2EC7A5.80808@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>	<4D4016B1.6050707@braverock.com>	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>	<4D41BF20.9080303@organicfoodmarkets.com.au>	<4D41C27A.9030109@braverock.com>
	<4D4FAA3F.5010006@organicfoodmarkets.com.au>
Message-ID: <4D503CB5.9060603@braverock.com>

On 02/07/2011 02:15 AM, Stephen Choularton wrote:
> Failed with error: ?package 'xts' 0.7-6.11 was found, but >= 0.7.6.15 is
> required by 'quantstrat'?

This is most likely your error.  Update xts first, then quantstrat. 
Other changes in xts fix a subsetting bug, and I think they were 
significant enough that I bumped the requirement for quantstrat as well.

Alternately, use Rtools to build the binary package, and you can edit 
the DESCRIPTION file as needed to relax the constraints.

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From lui.r.project at googlemail.com  Mon Feb  7 20:37:32 2011
From: lui.r.project at googlemail.com (Lui ##)
Date: Mon, 7 Feb 2011 20:37:32 +0100
Subject: [R-SIG-Finance] [R] Creating a list of lists / hclust elements
In-Reply-To: <493F0B58-BEE1-4030-972C-9C5B84F818EA@comcast.net>
References: <AANLkTim8bghTAubqJnXMHNLgF-Bv4grmPu14CdXBHAtF@mail.gmail.com>
	<493F0B58-BEE1-4030-972C-9C5B84F818EA@comcast.net>
Message-ID: <AANLkTikrO8Gxu_63V4J1hCXcJUdSfv5=xZ+ACyicYZfg@mail.gmail.com>

Hi David, I tried this one, but unfortunately it didn't solve the
problem (same result as append).
Thank you very much for your suggestion!

Lui

On Mon, Feb 7, 2011 at 5:14 PM, David Winsemius <dwinsemius at comcast.net> wrote:
>
> On Feb 7, 2011, at 10:45 AM, Lui ## wrote:
>
>> Dear group,
>>
>> I am currently struggling with the following problem for a while:
>>
>> I want to create a list whose elements consists of lists themselves.
>> More concise: The list elements are HCLUST objects. However, when I
>> try to append the HCLUST objects to my list via:
>>
>> cluster_list <- append(cluster_list, HCLUSTobject)
>
> Why not?:
>
> cluster_list <- c(cluster_list, HCLUSTobject)
>
> --
> David Winsemius, MD
> West Hartford, CT
>
>


From stephen at organicfoodmarkets.com.au  Mon Feb  7 21:38:34 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 08 Feb 2011 07:38:34 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D503CB5.9060603@braverock.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2C4FA5.2020304@braverock.com>	<4D2EC7A5.80808@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>	<4D4016B1.6050707@braverock.com>	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>	<4D41BF20.9080303@organicfoodmarkets.com.au>	<4D41C27A.9030109@braverock.com>	<4D4FAA3F.5010006@organicfoodmarkets.com.au>
	<4D503CB5.9060603@braverock.com>
Message-ID: <4D50584A.8050908@organicfoodmarkets.com.au>

Sorry must not have made my question clear.  I downloaded the new 
quantstrat and when I tried to run it I got the error message.  Then I 
downloaded the new xts and it all worked again, but I thought that 
quantstrat had been fixed for the problem I ran into and have written 
about in this string.  If you put the rules in the order of long enter 
then long exit, short enter and short exit the way the rules are 
processed the long open gets closed by the short open and the short 
close never gets found because of the crossing zero rule.

Alexander Rudnev got to the bottom of the problem and Joshua Ulrich made the amendments and said they were committed.   However, when I downloaded the current quantstrat I still found the problem.  I wondered if the current quantstrat does solve the problem, or if somehow the amendments have not got in their?

Thanks.

Stephen Choularton Ph.D., FIoD
On 08/02/2011 5:40 AM, Brian G. Peterson wrote:
> On 02/07/2011 02:15 AM, Stephen Choularton wrote:
>> Failed with error: ?package 'xts' 0.7-6.11 was found, but >= 0.7.6.15 is
>> required by 'quantstrat'?
>
> This is most likely your error.  Update xts first, then quantstrat. 
> Other changes in xts fix a subsetting bug, and I think they were 
> significant enough that I bumped the requirement for quantstrat as well.
>
> Alternately, use Rtools to build the binary package, and you can edit 
> the DESCRIPTION file as needed to relax the constraints.
>
>   - Brian
>


From jeffrey.ryan at lemnica.com  Mon Feb  7 21:57:29 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 7 Feb 2011 14:57:29 -0600
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D50584A.8050908@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
	<4D2C4FA5.2020304@braverock.com>
	<4D2EC7A5.80808@organicfoodmarkets.com.au>
	<4D2F0112.2020206@braverock.com>
	<4D2F7F72.60208@organicfoodmarkets.com.au>
	<4D332470.7080305@braverock.com>
	<4D33498F.70705@organicfoodmarkets.com.au>
	<4D334FFA.7060908@braverock.com>
	<4D335C67.1010400@organicfoodmarkets.com.au>
	<4D34C4B6.3050703@organicfoodmarkets.com.au>
	<4D365F37.6020608@organicfoodmarkets.com.au>
	<4D36E08B.9000000@braverock.com>
	<4D373600.9010101@organicfoodmarkets.com.au>
	<4D3CB144.3090402@organicfoodmarkets.com.au>
	<4D3F388F.3010209@organicfoodmarkets.com.au>
	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
	<4D4016B1.6050707@braverock.com>
	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>
	<4D41BF20.9080303@organicfoodmarkets.com.au>
	<4D41C27A.9030109@braverock.com>
	<4D4FAA3F.5010006@organicfoodmarkets.com.au>
	<4D503CB5.9060603@braverock.com>
	<4D50584A.8050908@organicfoodmarkets.com.au>
Message-ID: <AANLkTi=AXgygy86jUCLmyQQKcEKEKE-nwT6FXxT8aFeU@mail.gmail.com>

The issue is likely in the timing of your downloads.

You can't install software that hasn't had its dependencies met.
Likely your 'install' of quantstrat wasn't an install, failing when
xts wasn't the right version.

Getting the xts version required by quantstrat was what likely let the
install (or load?) proceed. (btw, the xts bug was in the new column
subsetting that was in .14 -- a quick patch - and didn't concern any
other versions of xts)

All works now?

HTH
Jeff

On Mon, Feb 7, 2011 at 2:38 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Sorry must not have made my question clear. ?I downloaded the new quantstrat
> and when I tried to run it I got the error message. ?Then I downloaded the
> new xts and it all worked again, but I thought that quantstrat had been
> fixed for the problem I ran into and have written about in this string. ?If
> you put the rules in the order of long enter then long exit, short enter and
> short exit the way the rules are processed the long open gets closed by the
> short open and the short close never gets found because of the crossing zero
> rule.
>
> Alexander Rudnev got to the bottom of the problem and Joshua Ulrich made the
> amendments and said they were committed. ? However, when I downloaded the
> current quantstrat I still found the problem. ?I wondered if the current
> quantstrat does solve the problem, or if somehow the amendments have not got
> in their?
>
> Thanks.
>
> Stephen Choularton Ph.D., FIoD
> On 08/02/2011 5:40 AM, Brian G. Peterson wrote:
>>
>> On 02/07/2011 02:15 AM, Stephen Choularton wrote:
>>>
>>> Failed with error: ?package 'xts' 0.7-6.11 was found, but >= 0.7.6.15 is
>>> required by 'quantstrat'?
>>
>> This is most likely your error. ?Update xts first, then quantstrat. Other
>> changes in xts fix a subsetting bug, and I think they were significant
>> enough that I bumped the requirement for quantstrat as well.
>>
>> Alternately, use Rtools to build the binary package, and you can edit the
>> DESCRIPTION file as needed to relax the constraints.
>>
>> ?- Brian
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From stephen at organicfoodmarkets.com.au  Mon Feb  7 22:23:51 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 08 Feb 2011 08:23:51 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <AANLkTi=AXgygy86jUCLmyQQKcEKEKE-nwT6FXxT8aFeU@mail.gmail.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D2F0112.2020206@braverock.com>	<4D2F7F72.60208@organicfoodmarkets.com.au>	<4D332470.7080305@braverock.com>	<4D33498F.70705@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>	<4D4016B1.6050707@braverock.com>	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>	<4D41BF20.9080303@organicfoodmarkets.com.au>	<4D41C27A.9030109@braverock.com>	<4D4FAA3F.5010006@organicfoodmarkets.com.au>	<4D503CB5.9060603@braverock.com>	<4D50584A.8050908@organicfoodmarkets.com.au>
	<AANLkTi=AXgygy86jUCLmyQQKcEKEKE-nwT6FXxT8aFeU@mail.gmail.com>
Message-ID: <4D5062E7.9070509@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/7eec8d7c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/7eec8d7c/attachment.jpe>

From josh.m.ulrich at gmail.com  Mon Feb  7 22:36:07 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 7 Feb 2011 15:36:07 -0600
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D5062E7.9070509@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
	<4D2F0112.2020206@braverock.com>
	<4D2F7F72.60208@organicfoodmarkets.com.au>
	<4D332470.7080305@braverock.com>
	<4D33498F.70705@organicfoodmarkets.com.au>
	<4D334FFA.7060908@braverock.com>
	<4D335C67.1010400@organicfoodmarkets.com.au>
	<4D34C4B6.3050703@organicfoodmarkets.com.au>
	<4D365F37.6020608@organicfoodmarkets.com.au>
	<4D36E08B.9000000@braverock.com>
	<4D373600.9010101@organicfoodmarkets.com.au>
	<4D3CB144.3090402@organicfoodmarkets.com.au>
	<4D3F388F.3010209@organicfoodmarkets.com.au>
	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
	<4D4016B1.6050707@braverock.com>
	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>
	<4D41BF20.9080303@organicfoodmarkets.com.au>
	<4D41C27A.9030109@braverock.com>
	<4D4FAA3F.5010006@organicfoodmarkets.com.au>
	<4D503CB5.9060603@braverock.com>
	<4D50584A.8050908@organicfoodmarkets.com.au>
	<AANLkTi=AXgygy86jUCLmyQQKcEKEKE-nwT6FXxT8aFeU@mail.gmail.com>
	<4D5062E7.9070509@organicfoodmarkets.com.au>
Message-ID: <AANLkTi=pwy36JCjEHyqOCBoz=kkYL6wP9d17yFDeHvy_@mail.gmail.com>

I just installed the most current versions of xts, blotter, and
quantstrat from R-forge.  I then ran the maCross.R demo after
uncommenting the two lines for short entries / exits.  I don't receive
any "cross through zero" warnings.  I can't replicate your issue.
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


On Mon, Feb 7, 2011 at 3:23 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
>
> Sorry, I must still not be making myself clear for which I apologiese.? I have downloaded current versions of xts and quantstrat and it all appears to be working.
>
> But it appears it is working just the same as before, that is with the ordering problem still in place.? I shouldn't have mentioned xts.? I guess the real question is has quantstrat been updated to sort out the problem:
>
> If you put the rules in the order of long enter then long exit, short enter and short exit the way the rules are processed the long open gets closed by the short open and the short close never gets found because of the crossing zero rule.
>
> Alexander Rudnev got to the bottom of the problem and Joshua Ulrich made the amendments and said they were committed but I still found the problem.
>
>
> Stephen Choularton Ph.D., FIoD
>
> 9999 2226
> 0413 545 182
>
>
> for insurance go to www.netinsure.com.au
> for markets go to www.organicfoodmarkets.com.au
>
> On 08/02/2011 7:57 AM, Jeffrey Ryan wrote:
>
> The issue is likely in the timing of your downloads.
>
> You can't install software that hasn't had its dependencies met.
> Likely your 'install' of quantstrat wasn't an install, failing when
> xts wasn't the right version.
>
> Getting the xts version required by quantstrat was what likely let the
> install (or load?) proceed. (btw, the xts bug was in the new column
> subsetting that was in .14 -- a quick patch - and didn't concern any
> other versions of xts)
>
> All works now?
>
> HTH
> Jeff
>
> On Mon, Feb 7, 2011 at 2:38 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au> wrote:
>
> Sorry must not have made my question clear. ?I downloaded the new quantstrat
> and when I tried to run it I got the error message. ?Then I downloaded the
> new xts and it all worked again, but I thought that quantstrat had been
> fixed for the problem I ran into and have written about in this string. ?If
> you put the rules in the order of long enter then long exit, short enter and
> short exit the way the rules are processed the long open gets closed by the
> short open and the short close never gets found because of the crossing zero
> rule.
>
> Alexander Rudnev got to the bottom of the problem and Joshua Ulrich made the
> amendments and said they were committed. ? However, when I downloaded the
> current quantstrat I still found the problem. ?I wondered if the current
> quantstrat does solve the problem, or if somehow the amendments have not got
> in their?
>
> Thanks.
>
> Stephen Choularton Ph.D., FIoD
> On 08/02/2011 5:40 AM, Brian G. Peterson wrote:
>
> On 02/07/2011 02:15 AM, Stephen Choularton wrote:
>
> Failed with error: ?package 'xts' 0.7-6.11 was found, but >= 0.7.6.15 is
> required by 'quantstrat'?
>
> This is most likely your error. ?Update xts first, then quantstrat. Other
> changes in xts fix a subsetting bug, and I think they were significant
> enough that I bumped the requirement for quantstrat as well.
>
> Alternately, use Rtools to build the binary package, and you can edit the
> DESCRIPTION file as needed to relax the constraints.
>
> ?- Brian
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From stephen at organicfoodmarkets.com.au  Tue Feb  8 00:54:20 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 08 Feb 2011 10:54:20 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <AANLkTi=pwy36JCjEHyqOCBoz=kkYL6wP9d17yFDeHvy_@mail.gmail.com>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>
	<4D33498F.70705@organicfoodmarkets.com.au>
	<4D334FFA.7060908@braverock.com>
	<4D335C67.1010400@organicfoodmarkets.com.au>
	<4D34C4B6.3050703@organicfoodmarkets.com.au>
	<4D365F37.6020608@organicfoodmarkets.com.au>
	<4D36E08B.9000000@braverock.com>
	<4D373600.9010101@organicfoodmarkets.com.au>
	<4D3CB144.3090402@organicfoodmarkets.com.au>
	<4D3F388F.3010209@organicfoodmarkets.com.au>
	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>
	<4D4016B1.6050707@braverock.com>
	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>
	<4D41BF20.9080303@organicfoodmarkets.com.au>
	<4D41C27A.9030109@braverock.com>
	<4D4FAA3F.5010006@organicfoodmarkets.com.au>
	<4D503CB5.9060603@braverock.com>
	<4D50584A.8050908@organicfoodmarkets.com.au>
	<AANLkTi=AXgygy86jUCLmyQQKcEKEKE-nwT6FXxT8aFeU@mail.gmail.com>
	<4D5062E7.9070509@organicfoodmarkets.com.au>
	<AANLkTi=pwy36JCjEHyqOCBoz=kkYL6wP9d17yFDeHvy_@mail.gmail.com>
Message-ID: <4D50862C.9020101@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/0387025a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/0387025a/attachment.jpe>

From stephen at organicfoodmarkets.com.au  Tue Feb  8 04:02:44 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 08 Feb 2011 14:02:44 +1100
Subject: [R-SIG-Finance] quantstrat - macross demo problem
In-Reply-To: <4D50862C.9020101@organicfoodmarkets.com.au>
References: <4D2BE853.3020803@organicfoodmarkets.com.au>	<4D334FFA.7060908@braverock.com>	<4D335C67.1010400@organicfoodmarkets.com.au>	<4D34C4B6.3050703@organicfoodmarkets.com.au>	<4D365F37.6020608@organicfoodmarkets.com.au>	<4D36E08B.9000000@braverock.com>	<4D373600.9010101@organicfoodmarkets.com.au>	<4D3CB144.3090402@organicfoodmarkets.com.au>	<4D3F388F.3010209@organicfoodmarkets.com.au>	<AANLkTiksDUVnMPQEvyE6v6c8aAqeOS4Q6SMmh48gsw5=@mail.gmail.com>	<4D4016B1.6050707@braverock.com>	<AANLkTin9UawhpMa6rbfoh=-xixdUFhN=PeAFA8PSAzvC@mail.gmail.com>	<4D41BF20.9080303@organicfoodmarkets.com.au>	<4D41C27A.9030109@braverock.com>	<4D4FAA3F.5010006@organicfoodmarkets.com.au>	<4D503CB5.9060603@braverock.com>	<4D50584A.8050908@organicfoodmarkets.com.au>	<AANLkTi=AXgygy86jUCLmyQQKcEKEKE-nwT6FXxT8aFeU@mail.gmail.com>	<4D5062E7.9070509@organicfoodmarkets.com.au>	<AANLkTi=pwy36JCjEHyqOCBoz=kkYL6wP9d17yFDeHvy_@mail.gmail.com>
	<4D50862C.9020101@organicfoodmarkets.com.au>
Message-ID: <4D50B254.8060106@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/74b28a42/attachment.html>

From matteo.fornasier at gmail.com  Tue Feb  8 10:37:36 2011
From: matteo.fornasier at gmail.com (Matteo Fornasier)
Date: Tue, 8 Feb 2011 10:37:36 +0100
Subject: [R-SIG-Finance] R in batch mode - RBloomberg
Message-ID: <AANLkTi=8djk5QFDDy5bwEJQ4KwTnXWJj9usj1zW25wd3@mail.gmail.com>

Hi all,
I've a problem with R.
I'm using R in batch mode calling it trought php:
exec("C:\Program\R\R-2.7.1\bin\R.exe CMD BATCH blablabla\.txt");

It's function very well and I did a lot of interesting application.
In the webserver there is Bloomberg so I want download some time
series to analyse and so on.
If I launch the script in R it run and do all calculation but if I
call the script in batch mode in the output I see that the script stop
just when should start the connection with bloomberg:

R version 2.7.1 (2008-06-23)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
[...]

[Previously saved workspace restored]

> library(RODBC)
Warning message:
package 'RODBC' was built under R version 2.7.2
> library(RBloomberg)
Loading required package: RDCOMClient
Loading required package: zoo

Attaching package: 'zoo'


	The following object(s) are masked from package:base :

	 rapply

Loading required package: chron
Contents of bbfields have been stored in .bbfields in the current workspace
Warning message:
package 'RBloomberg' was built under R version 2.7.2

> ticker = "G IM Equity"
> ticker
[1] "G IM Equity"
>
>

Any ideas?
Maybe is a permission problem but I don't know which file I've to autorize.

Thanks a lot,

Matteo


From nelson.ana at gmail.com  Tue Feb  8 16:31:14 2011
From: nelson.ana at gmail.com (Ana Nelson)
Date: Tue, 8 Feb 2011 15:31:14 +0000
Subject: [R-SIG-Finance] R in batch mode - RBloomberg
In-Reply-To: <AANLkTi=8djk5QFDDy5bwEJQ4KwTnXWJj9usj1zW25wd3@mail.gmail.com>
References: <AANLkTi=8djk5QFDDy5bwEJQ4KwTnXWJj9usj1zW25wd3@mail.gmail.com>
Message-ID: <AANLkTi=7VKDyW8WtmtnkjNukod9xL3OmwPVy9MB+nNje@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/300604c4/attachment.pl>

From matteo.fornasier at gmail.com  Tue Feb  8 17:40:39 2011
From: matteo.fornasier at gmail.com (Matteo Fornasier)
Date: Tue, 8 Feb 2011 17:40:39 +0100
Subject: [R-SIG-Finance] R in batch mode - RBloomberg
In-Reply-To: <AANLkTi=7VKDyW8WtmtnkjNukod9xL3OmwPVy9MB+nNje@mail.gmail.com>
References: <AANLkTi=8djk5QFDDy5bwEJQ4KwTnXWJj9usj1zW25wd3@mail.gmail.com>
	<AANLkTi=7VKDyW8WtmtnkjNukod9xL3OmwPVy9MB+nNje@mail.gmail.com>
Message-ID: <AANLkTi=GgdG-0e0xMFnP1n6df1Y2NRzL=9T1gy4cVhy+@mail.gmail.com>

Hi,
thanks for the reply. I updated the version of R and install the package.
If I test the script via command line here's the output:

> library(RBloomberg)
Loading required package: rJava
> con = blpConnect()
R version 2.12.1 (2010-12-16)
rJava Version 0.8-8
RBloomberg Version 0.4-146
Java environment initialized successfully.
Looking for most recent blpapi3.jar file...
Adding C:\blp\API\APIv3\JavaAPI\v3.4.1.3\lib\blpapi3.jar to Java classpath
Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) :
org.findata.blpwrapper.WrapperException: Session not started. See
logs. Please report this to blpwrapper maintainer.


If I test the script via PHP, here's the output:
> bl = blpConnect()

R version 2.12.1 (2010-12-16)

rJava Version 0.8-8

RBloomberg Version 0.4-146
Java environment initialized successfully.
Looking for most recent blpapi3.jar file...
Adding C:\blp\API\APIv3\JavaAPI\v3.4.1.3\lib\blpapi3.jar to Java classpath
Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) :
java.io.IOException: Couldn't get lock for
%h/org.findata.blpwrapper.%g.log
Calls: blpConnect ... eval -> eval -> blpConnect.Java -> .jnew -> .External
Execution halted


Now I try to understand why happeneds these error. Have you or any
others any idea.
Many thanks and best regards,

Matteo



On Tue, Feb 8, 2011 at 4:31 PM, Ana Nelson <nelson.ana at gmail.com> wrote:
> Hi, Matteo,
>
> Can you update to the Java-based version of RBloomberg available from
> findata.org? You are also running a very old version of R.
>
> Can you test your script just from the command line rather than via PHP?
>
> -Ana
>
>
>
> On Tue, Feb 8, 2011 at 9:37 AM, Matteo Fornasier
> <matteo.fornasier at gmail.com> wrote:
>>
>> Hi all,
>> I've a problem with R.
>> I'm using R in batch mode calling it trought php:
>> exec("C:\Program\R\R-2.7.1\bin\R.exe CMD BATCH blablabla\.txt");
>>
>> It's function very well and I did a lot of interesting application.
>> In the webserver there is Bloomberg so I want download some time
>> series to analyse and so on.
>> If I launch the script in R it run and do all calculation but if I
>> call the script in batch mode in the output I see that the script stop
>> just when should start the connection with bloomberg:
>>
>> R version 2.7.1 (2008-06-23)
>> Copyright (C) 2008 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>> [...]
>>
>> [Previously saved workspace restored]
>>
>> > library(RODBC)
>> Warning message:
>> package 'RODBC' was built under R version 2.7.2
>> > library(RBloomberg)
>> Loading required package: RDCOMClient
>> Loading required package: zoo
>>
>> Attaching package: 'zoo'
>>
>>
>> ? ? ? ?The following object(s) are masked from package:base :
>>
>> ? ? ? ? rapply
>>
>> Loading required package: chron
>> Contents of bbfields have been stored in .bbfields in the current
>> workspace
>> Warning message:
>> package 'RBloomberg' was built under R version 2.7.2
>>
>> > ticker = "G IM Equity"
>> > ticker
>> [1] "G IM Equity"
>> >
>> >
>>
>> Any ideas?
>> Maybe is a permission problem but I don't know which file I've to
>> autorize.
>>
>> Thanks a lot,
>>
>> Matteo
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
>


From nelson.ana at gmail.com  Tue Feb  8 18:22:11 2011
From: nelson.ana at gmail.com (Ana Nelson)
Date: Tue, 8 Feb 2011 17:22:11 +0000
Subject: [R-SIG-Finance] R in batch mode - RBloomberg
In-Reply-To: <AANLkTi=GgdG-0e0xMFnP1n6df1Y2NRzL=9T1gy4cVhy+@mail.gmail.com>
References: <AANLkTi=8djk5QFDDy5bwEJQ4KwTnXWJj9usj1zW25wd3@mail.gmail.com>
	<AANLkTi=7VKDyW8WtmtnkjNukod9xL3OmwPVy9MB+nNje@mail.gmail.com>
	<AANLkTi=GgdG-0e0xMFnP1n6df1Y2NRzL=9T1gy4cVhy+@mail.gmail.com>
Message-ID: <AANLkTikGho8sNs7O4UXgfF-BytsbHXnZ8cL-bKXVt9x8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110208/4e5cfee9/attachment.pl>

From paulteetor at yahoo.com  Tue Feb  8 19:37:39 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Tue, 8 Feb 2011 10:37:39 -0800 (PST)
Subject: [R-SIG-Finance] Quantitative Finance on Stack Exchange
Message-ID: <490033.89774.qm@web56004.mail.re3.yahoo.com>

All:

In case you don't know, there is a new Quantitative Finance area on Stack 
Exchange, and the area is now open to the general public:

    http://quant.stackexchange.com/

This is a Q&A site many good questions (and answers!) regarding quant finance. I 
think it would interest most members of the R-SIG-Finance list. Check it out.

Paul


PS - If someone already posted about this, I apologize for the duplicate 
mailing. I don't recall seeing this new SE area mentioned here recently.


Paul Teetor, Elgin, IL  USA
http://quanttrader.info/public


From matteo.fornasier at gmail.com  Tue Feb  8 20:45:55 2011
From: matteo.fornasier at gmail.com (Matteo Fornasier)
Date: Tue, 8 Feb 2011 20:45:55 +0100
Subject: [R-SIG-Finance] R in batch mode - RBloomberg
In-Reply-To: <AANLkTikGho8sNs7O4UXgfF-BytsbHXnZ8cL-bKXVt9x8@mail.gmail.com>
References: <AANLkTi=8djk5QFDDy5bwEJQ4KwTnXWJj9usj1zW25wd3@mail.gmail.com>
	<AANLkTi=7VKDyW8WtmtnkjNukod9xL3OmwPVy9MB+nNje@mail.gmail.com>
	<AANLkTi=GgdG-0e0xMFnP1n6df1Y2NRzL=9T1gy4cVhy+@mail.gmail.com>
	<AANLkTikGho8sNs7O4UXgfF-BytsbHXnZ8cL-bKXVt9x8@mail.gmail.com>
Message-ID: <AANLkTi=Eizxd=fTQAAKJRPp3A56uMG+btxRdacie9G_o@mail.gmail.com>

Hi,
thanks for your reply. For the first point I check but I think I've to
check better!

For the second point here's the error:

Feb 8, 2011 8:39:31 PM org.findata.blpwrapper.Connection
processSessionStatusEvent
WARNING: SessionConnectionUp = {
    server = localhost/127.0.0.1:8194
}

Kindly,

Matteo


On Tue, Feb 8, 2011 at 6:22 PM, Ana Nelson <nelson.ana at gmail.com> wrote:
> Matteo,
>
> the %h says that RBloomberg is trying to write logs to the user's home
> directory but under PHP this might be somewhere unexpected, you might look
> for how to disable logging or write the logfile somewhere that PHP has
> permission to write to.
>
> The WrapperException error is different, I will look into this tomorrow.
> That looks like a new version of RBloomberg which might have introduced an
> error. It would be helpful if you could look in the logs for any useful
> information about the error. (check your home directory, like Documents and
> Settings/Your Name)
>
> -Ana
>
>
> On Tue, Feb 8, 2011 at 4:40 PM, Matteo Fornasier
> <matteo.fornasier at gmail.com> wrote:
>>
>> Hi,
>> thanks for the reply. I updated the version of R and install the package.
>> If I test the script via command line here's the output:
>>
>> > library(RBloomberg)
>> Loading required package: rJava
>> > con = blpConnect()
>> R version 2.12.1 (2010-12-16)
>> rJava Version 0.8-8
>> RBloomberg Version 0.4-146
>> Java environment initialized successfully.
>> Looking for most recent blpapi3.jar file...
>> Adding C:\blp\API\APIv3\JavaAPI\v3.4.1.3\lib\blpapi3.jar to Java classpath
>> Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) :
>> org.findata.blpwrapper.WrapperException: Session not started. See
>> logs. Please report this to blpwrapper maintainer.
>>
>>
>> If I test the script via PHP, here's the output:
>> > bl = blpConnect()
>>
>> R version 2.12.1 (2010-12-16)
>>
>> rJava Version 0.8-8
>>
>> RBloomberg Version 0.4-146
>> Java environment initialized successfully.
>> Looking for most recent blpapi3.jar file...
>> Adding C:\blp\API\APIv3\JavaAPI\v3.4.1.3\lib\blpapi3.jar to Java classpath
>> Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) :
>> java.io.IOException: Couldn't get lock for
>> %h/org.findata.blpwrapper.%g.log
>> Calls: blpConnect ... eval -> eval -> blpConnect.Java -> .jnew ->
>> .External
>> Execution halted
>>
>>
>> Now I try to understand why happeneds these error. Have you or any
>> others any idea.
>> Many thanks and best regards,
>>
>> Matteo
>>
>>
>>
>> On Tue, Feb 8, 2011 at 4:31 PM, Ana Nelson <nelson.ana at gmail.com> wrote:
>> > Hi, Matteo,
>> >
>> > Can you update to the Java-based version of RBloomberg available from
>> > findata.org? You are also running a very old version of R.
>> >
>> > Can you test your script just from the command line rather than via PHP?
>> >
>> > -Ana
>> >
>> >
>> >
>> > On Tue, Feb 8, 2011 at 9:37 AM, Matteo Fornasier
>> > <matteo.fornasier at gmail.com> wrote:
>> >>
>> >> Hi all,
>> >> I've a problem with R.
>> >> I'm using R in batch mode calling it trought php:
>> >> exec("C:\Program\R\R-2.7.1\bin\R.exe CMD BATCH blablabla\.txt");
>> >>
>> >> It's function very well and I did a lot of interesting application.
>> >> In the webserver there is Bloomberg so I want download some time
>> >> series to analyse and so on.
>> >> If I launch the script in R it run and do all calculation but if I
>> >> call the script in batch mode in the output I see that the script stop
>> >> just when should start the connection with bloomberg:
>> >>
>> >> R version 2.7.1 (2008-06-23)
>> >> Copyright (C) 2008 The R Foundation for Statistical Computing
>> >> ISBN 3-900051-07-0
>> >> [...]
>> >>
>> >> [Previously saved workspace restored]
>> >>
>> >> > library(RODBC)
>> >> Warning message:
>> >> package 'RODBC' was built under R version 2.7.2
>> >> > library(RBloomberg)
>> >> Loading required package: RDCOMClient
>> >> Loading required package: zoo
>> >>
>> >> Attaching package: 'zoo'
>> >>
>> >>
>> >> ? ? ? ?The following object(s) are masked from package:base :
>> >>
>> >> ? ? ? ? rapply
>> >>
>> >> Loading required package: chron
>> >> Contents of bbfields have been stored in .bbfields in the current
>> >> workspace
>> >> Warning message:
>> >> package 'RBloomberg' was built under R version 2.7.2
>> >>
>> >> > ticker = "G IM Equity"
>> >> > ticker
>> >> [1] "G IM Equity"
>> >> >
>> >> >
>> >>
>> >> Any ideas?
>> >> Maybe is a permission problem but I don't know which file I've to
>> >> autorize.
>> >>
>> >> Thanks a lot,
>> >>
>> >> Matteo
>> >>
>> >> _______________________________________________
>> >> R-SIG-Finance at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>> >> -- Also note that this is not the r-help list where general R questions
>> >> should go.
>> >
>> >
>
>


From vegorin at yahoo.com  Wed Feb  9 19:24:11 2011
From: vegorin at yahoo.com (Vladimir Egorin)
Date: Wed, 9 Feb 2011 10:24:11 -0800 (PST)
Subject: [R-SIG-Finance] quantstrat and nonstandard column names in the
	price series
Message-ID: <531118.79336.qm@web113202.mail.gq1.yahoo.com>

Does anyone have a short demo for quantstrat that does not use standard column 
names for price data in mktdata?  I am curious what the syntax would be in case, 
for example, when xts price series has a column named "XXX".
I figured so far that I need to provide a "prefer" value for the getPrice 
function to indicate the column name with the price, but the running backtest 
fails, apparently when parsing the orders.

Thanks, Vladimir


From brian at braverock.com  Wed Feb  9 19:30:20 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 09 Feb 2011 12:30:20 -0600
Subject: [R-SIG-Finance] quantstrat and nonstandard column names in the
 price series
In-Reply-To: <531118.79336.qm@web113202.mail.gq1.yahoo.com>
References: <531118.79336.qm@web113202.mail.gq1.yahoo.com>
Message-ID: <4D52DD3C.7030408@braverock.com>

On 02/09/2011 12:24 PM, Vladimir Egorin wrote:
> Does anyone have a short demo for quantstrat that does not use standard column
> names for price data in mktdata?  I am curious what the syntax would be in case,
> for example, when xts price series has a column named "XXX".
> I figured so far that I need to provide a "prefer" value for the getPrice
> function to indicate the column name with the price, but the running backtest
> fails, apparently when parsing the orders.
>
> Thanks, Vladimir

The 'prefer' argument should work.

We use quantstrat on tick data all the time.  However, this is also in 
'standard' format as recognized by is.BBO is quantmod (the tick 
equivalent of is.OHLC).

The fallback guess in quantstrat if is.OHLC and is.BBO fail calls for a 
column named for the symbol.  This works for multicolumn series, e.g. in 
a portfolio strategy, where each column is named for the symbol in question.

However, as I said initially, tyhe prefer= argument should be handled 
and passed through everywhere.  So please provide a minimal example and 
we'll investigate.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From vegorin at yahoo.com  Wed Feb  9 20:08:28 2011
From: vegorin at yahoo.com (Vladimir Egorin)
Date: Wed, 9 Feb 2011 11:08:28 -0800 (PST)
Subject: [R-SIG-Finance] quantstrat and nonstandard column names in the
	price series
Message-ID: <916506.26727.qm@web113210.mail.gq1.yahoo.com>

Here is a hopefully small standalone example (a hacked script from one of the 
demos.).
Running it produces an error:
[1] "setup completed"
Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1), .indexFORMAT = 
indexFormat(e1),  : 

  index length must match number of observations

In general, how would you specify the name of the underlying when 
adding rules, in case, for example, the signal is on the underlying X
and the order is on underlying Y.

Thank you.


try(rm("order_book.RSI",pos=.strategy),silent=TRUE)
try(rm("account.RSI","portfolio.RSI",pos=.blotter),silent=TRUE)
try(rm("account.st","portfolio.st","stock.str","stratRSI","initDate","initEq",'start_t','end_t'),silent=TRUE)


library('xts')
library('quantstrat')
alldates <- c("2011-01-03","2011-01-04","2011-01-05","2011-01-06","2011-01-07",
"2011-01-10","2011-01-11","2011-01-12","2011-01-13","2011-01-14",
"2011-01-18","2011-01-19","2011-01-20","2011-01-21","2011-01-24",
"2011-01-25","2011-01-26","2011-01-27","2011-01-28","2011-01-31",
"2011-02-01","2011-02-02","2011-02-03","2011-02-04","2011-02-07",
"2011-02-08")
values <- 
c(117.6562,117.6875,117.0156,117.3359,117.9922,118.1172,117.9531,117.9531,
118.2734,118.1719,118.1016,118.2344,117.6562,117.8438,117.8672,118.2422,
117.9688,118.2891,118.5547,118.4141,118.0703,117.6875,117.3984,116.8516,
116.8828,116.3438)

FV = xts(values, as.POSIXct(alldates, format="%Y-%m-%d"))
colnames(FV) <- 'FV'

# Initialize a strategy object
stratRSI <- strategy("RSI")

# Add an indicator
stratRSI <- add.indicator(strategy = stratRSI, name = "RSI", arguments = 
list(price = quote(getPrice(mktdata, prefer='FV'))), label="RSI")

# There are two signals:
# The first is when RSI is greater than 90
stratRSI <- add.signal(strategy = stratRSI, name="sigThreshold",arguments = 
list(threshold=70, column="RSI",relationship="gt", 
cross=TRUE),label="RSI.gt.70")
# The second is when RSI is less than 10
stratRSI <- add.signal(strategy = stratRSI, name="sigThreshold",arguments = 
list(threshold=30, column="RSI",relationship="lt",cross=TRUE),label="RSI.lt.30")

# There are two rules:
#'## we would Use osMaxPos to put trade on in layers, or to a maximum position. 
# The first is to sell when the RSI crosses above the threshold
stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments = 
list(data=quote(getPrice(mktdata, prefer='FV')), sigcol="RSI.gt.70", 
sigval=TRUE, orderqty=-1000, ordertype='market', orderside='short', 
pricemethod='market', replace=FALSE), type='enter', path.dep=TRUE)
stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments = 
list(data=quote(getPrice(mktdata, prefer='FV')), sigcol="RSI.lt.30", 
sigval=TRUE, orderqty='all', ordertype='market', orderside='short', 
pricemethod='market', replace=FALSE), type='exit', path.dep=TRUE)
# The second is to buy when the RSI crosses below the threshold
stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments = 
list(data=quote(getPrice(mktdata, prefer='FV')), sigcol="RSI.lt.30", 
sigval=TRUE, orderqty= 1000, ordertype='market', orderside='long', 
pricemethod='market', replace=FALSE), type='enter', path.dep=TRUE)
stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments = 
list(data=quote(getPrice(mktdata, prefer='FV')),sigcol="RSI.gt.70", sigval=TRUE, 
orderqty='all', ordertype='market', orderside='long', pricemethod='market', 
replace=FALSE), type='exit', path.dep=TRUE)

currency("USD")
symbols = c("FV")
for(symbol in symbols){ # establish trade-able instruments
    stock(symbol, currency="USD",multiplier=1)
}
initDate='2011-01-02'
initEq=100000
port.st<-'RSI' #use a string here for easier changing of parameters and 
re-trying

initPortf(port.st, symbols=symbols, initDate=initDate)
initAcct(port.st, portfolios=port.st, initDate=initDate)
initOrders(portfolio=port.st, initDate=initDate)

print("setup completed")

# Process the indicators and generate trades
start_t<-Sys.time()
out<-try(applyStrategy(strategy=stratRSI , portfolios=port.st, 
parameters=list(n=2) ) )
end_t<-Sys.time()
print("Strategy Loop:")
print(end_t-start_t)




----- Original Message ----
From: Vladimir Egorin <vegorin at yahoo.com>
To: r-sig-finance at r-project.org
Sent: Wed, February 9, 2011 12:24:11 PM
Subject: quantstrat and nonstandard column names in the price series

Does anyone have a short demo for quantstrat that does not use standard column 
names for price data in mktdata?  I am curious what the syntax would be in case, 

for example, when xts price series has a column named "XXX".
I figured so far that I need to provide a "prefer" value for the getPrice 
function to indicate the column name with the price, but the running backtest 
fails, apparently when parsing the orders.

Thanks, Vladimir


From brian at braverock.com  Wed Feb  9 21:33:47 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 09 Feb 2011 14:33:47 -0600
Subject: [R-SIG-Finance] quantstrat and nonstandard column names in the
 price series
In-Reply-To: <916506.26727.qm@web113210.mail.gq1.yahoo.com>
References: <916506.26727.qm@web113210.mail.gq1.yahoo.com>
Message-ID: <4D52FA2B.6080308@braverock.com>

On 02/09/2011 01:08 PM, Vladimir Egorin wrote:
> Here is a hopefully small standalone example (a hacked script from one of the
> demos.).
> Running it produces an error:
> [1] "setup completed"
> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1), .indexFORMAT =
> indexFormat(e1),  :
>
>    index length must match number of observations

There were a few problems with your example.  A corrected version is 
attached.

The first and most serious was that you were doing this in the add.rule 
commands:

data=quote(getPrice(mktdata, prefer='FV'))

This basically took your signal columns *out* of the data object, 
returning only the price column.  That would never work, as there is no 
column for ruleSignal to match on.

The prefer='FV' argument belongs more reasonably in ... in 
applyStrategy.  I also placed it in the arguments= list for ruleSignal 
in add.rule, for clarity, but it shouldn't be strictly necessary there.

A second, and more minor error, is in the construction of your index.

You used POSIXct for daily data, which creates problems even after 
fixing the data object in the calls to ruleSignal.  I modified your 
construction to use as.Date for the index, so that the periodicity 
checks and handling will work properly inside quantstrat.

With these changes, your example works, and generates trades.

 > out<-try(applyStrategy(strategy=stratRSI , portfolios=port.st, 
parameters=list(n=2), prefer='FV' ) )
[1] "2011-01-07 FV -1000 @ 117.9922"
[1] "2011-01-13 FV 1000 @ 118.2734"
[1] "2011-01-13 FV -1000 @ 118.2734"
[1] "2011-01-19 FV 1000 @ 118.2344"
[1] "2011-01-19 FV -1000 @ 118.2344"
[1] "2011-01-20 FV 1000 @ 117.6562"
[1] "2011-01-20 FV 1000 @ 117.6562"
[1] "2011-01-25 FV -1000 @ 118.2422"
[1] "2011-01-25 FV -1000 @ 118.2422"
[1] "2011-01-27 FV 1000 @ 118.2891"
[1] "2011-01-27 FV -1000 @ 118.2891"
[1] "2011-02-01 FV 1000 @ 118.0703"
[1] "2011-02-01 FV 1000 @ 118.0703"

examine the 'out' variable to see what gets added at each step of 
indicators and signals, and the order book to see the orders generated 
from the signals.

> In general, how would you specify the name of the underlying when
> adding rules, in case, for example, the signal is on the underlying X
> and the order is on underlying Y.

In strategies like this, you'd probably be writing custom indicator 
and/or signal functions that took parameters such as Prod1, Prod2 and 
knew the structure of your data, such as columns named for Prod1 and 
Prod2.

The standard functions are there to provide for common, simple, 
strategies, but for proprietary indicators you'll still need proprietary 
functions. ;)

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vladimir.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110209/e2a925d0/attachment.pl>

From vegorin at yahoo.com  Wed Feb  9 22:19:21 2011
From: vegorin at yahoo.com (Vladimir Egorin)
Date: Wed, 9 Feb 2011 13:19:21 -0800 (PST)
Subject: [R-SIG-Finance] quantstrat and nonstandard column names in the
	price series
In-Reply-To: <4D52FA2B.6080308@braverock.com>
References: <916506.26727.qm@web113210.mail.gq1.yahoo.com>
	<4D52FA2B.6080308@braverock.com>
Message-ID: <720492.48943.qm@web113216.mail.gq1.yahoo.com>

Brian,

thank you very much for your kind help with this, everything is clear now.


  Vladimir


----- Original Message ----
From: Brian G. Peterson <brian at braverock.com>
To: r-sig-finance at r-project.org
Sent: Wed, February 9, 2011 2:33:47 PM
Subject: Re: [R-SIG-Finance] quantstrat and nonstandard column names in the 
price series

On 02/09/2011 01:08 PM, Vladimir Egorin wrote:
> Here is a hopefully small standalone example (a hacked script from one of the
> demos.).
> Running it produces an error:
> [1] "setup completed"
> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1), .indexFORMAT =
> indexFormat(e1),  :
> 
>    index length must match number of observations

There were a few problems with your example.  A corrected version is attached.

The first and most serious was that you were doing this in the add.rule 
commands:

data=quote(getPrice(mktdata, prefer='FV'))

This basically took your signal columns *out* of the data object, returning only 
the price column.  That would never work, as there is no column for ruleSignal 
to match on.

The prefer='FV' argument belongs more reasonably in ... in applyStrategy.  I 
also placed it in the arguments= list for ruleSignal in add.rule, for clarity, 
but it shouldn't be strictly necessary there.

A second, and more minor error, is in the construction of your index.

You used POSIXct for daily data, which creates problems even after fixing the 
data object in the calls to ruleSignal.  I modified your construction to use 
as.Date for the index, so that the periodicity checks and handling will work 
properly inside quantstrat.

With these changes, your example works, and generates trades.

> out<-try(applyStrategy(strategy=stratRSI , portfolios=port.st, 
>parameters=list(n=2), prefer='FV' ) )
[1] "2011-01-07 FV -1000 @ 117.9922"
[1] "2011-01-13 FV 1000 @ 118.2734"
[1] "2011-01-13 FV -1000 @ 118.2734"
[1] "2011-01-19 FV 1000 @ 118.2344"
[1] "2011-01-19 FV -1000 @ 118.2344"
[1] "2011-01-20 FV 1000 @ 117.6562"
[1] "2011-01-20 FV 1000 @ 117.6562"
[1] "2011-01-25 FV -1000 @ 118.2422"
[1] "2011-01-25 FV -1000 @ 118.2422"
[1] "2011-01-27 FV 1000 @ 118.2891"
[1] "2011-01-27 FV -1000 @ 118.2891"
[1] "2011-02-01 FV 1000 @ 118.0703"
[1] "2011-02-01 FV 1000 @ 118.0703"

examine the 'out' variable to see what gets added at each step of indicators and 
signals, and the order book to see the orders generated from the signals.

> In general, how would you specify the name of the underlying when
> adding rules, in case, for example, the signal is on the underlying X
> and the order is on underlying Y.

In strategies like this, you'd probably be writing custom indicator and/or 
signal functions that took parameters such as Prod1, Prod2 and knew the 
structure of your data, such as columns named for Prod1 and Prod2.

The standard functions are there to provide for common, simple, strategies, but 
for proprietary indicators you'll still need proprietary functions. ;)

Regards,

  - Brian

-- Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock



 
____________________________________________________________________________________
Finding fabulous fares is fun.  
[[elided Yahoo spam]]


From markknecht at gmail.com  Thu Feb 10 00:09:10 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Wed, 9 Feb 2011 15:09:10 -0800
Subject: [R-SIG-Finance] Trading system correlation?
In-Reply-To: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>
References: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>
Message-ID: <AANLkTimrb8XEUDrrJA2FShh6RewRVj_jEDQrQYwVUTuO@mail.gmail.com>

On Wed, Jan 5, 2011 at 9:21 AM, David St John <dstjohn at math.uic.edu> wrote:
<SNIP>
>
> x1 x2 x3
>
> x1 1.0000000 0.7682398 0.6788077
>
> x2 0.7682398 1.0000000 0.6088950
>
> x3 0.6788077 0.6088950 1.0000000
>
> As you can see, even if you were just randomly buying and selling these
> contracts at odd times, but most of the time had no position (68% of the
> time in my example), then the systems will still be very strongly
> correlated. Since you are trying to find comparatively lower correlation
> between market/system pairs, I think this would be as fine a measure as
> any. ?Just look for the smallest entries in your correlation matrix.
>
>
> Hope this helps,
> -David

Hi all,
   Back from oblivion. I finally got some time over the last few days
to try and put some shape to this problem. Most of this is background.
Skip to the bottom to get the question about R.

REVUE: I have saved historical trade results from a large set of
systems. (In this case 30) Every file used as input to this R program
comes from a completely different trading system operating on the same
market. (In this case about 15 months trading the Russell futures
market - TF.D in TradeStation) I have aggregated the data into
results/day and placed them in a large array. Looking at just the
first 10 systems for the first 20 days the results look like this:
(unlikely to survive email very well...)

> MyResults[1:20,1:11]
   TradingDate PL1  PL2  PL3   PL4   PL5  PL6  PL7  PL8  PL9 PL10
1   2009-06-01   0    0    0     0     0    0    0    0    0    0
2   2009-06-02   0    0    0     0     0    0    0    0    0    0
3   2009-06-03   0    0    0     0     0    0    0    0    0    0
4   2009-06-04   0  341    0     0   -89 -609    0    0 1001    0
5   2009-06-05   0 -569 -569  -299   333  161    0  151    0 -109
6   2009-06-08   0   12 -189  -189   471 -189    0  251    0    0
7   2009-06-09   0   81 -149   -79     0 -159 -379    0    0    0
8   2009-06-10  91 -799 -119  -999     0   11    0    0  401    0
9   2009-06-11   0 -249  191     0   271 -289 -979  571  -49 -639
10  2009-06-12   0  391 -449     0     0  391    0    0  741    0
11  2009-06-15 582  351  591   343     0  581    0    0  291  351
12  2009-06-16   0 -109    0 -1137   612  941    0 1201 1291    0
13  2009-06-17   0  171  151  -329   401 -339    0  451  581    0
14  2009-06-18   0  531 -169   -19     0  552 -109    0    0    0
15  2009-06-19   0 -429 -429  -309   352  271    0 -309  401   -9
16  2009-06-22 592 1342  621   504     0 1222    0    0    0  301
17  2009-06-23   0    0    0   564     0 -429    0    0    0    0
18  2009-06-24  61 -379  -59     0   401   81    0  401    0    0
19  2009-06-25   0 1811    0     0 -1029 1782  801  381 -559  261
20  2009-06-26   0   71   71    71   241    0  241  441   -9   91
>

Here's an idea of the system results from a returns point of view:

> colSums(CorData)
  PL1   PL2   PL3   PL4   PL5   PL6   PL7   PL8   PL9  PL10  PL11
PL12  PL13  PL14  PL15  PL16  PL17  PL18  PL19  PL20  PL21  PL22  PL23
 PL24  PL25
24065 35073 36471 18273 19257 30939 19296 24073 27412 20512 29211
28338 29093 23487 36062 18125 21926 34095 30921 32945 30546 18295
30707 27885 15864
 PL26  PL27  PL28  PL29  PL30
23497 34502 31098 28028 30616

> mean(colSums(CorData))
[1] 27020

> sd(colSums(CorData))
[1] 6054

(Not sure mean and sd make sense for this, but that's about the limit
to my understanding about statistics...) ;-)

OK, so here's the R question. Let's say I'm willing to trade 5 systems
at one time and I have to pick 5. How do I pick?

1) Find the 5 with the largest equity. Too easy. Don't need R to do that.

2) Find some sort of 'optimized' choice...

Looking at the correlation of just the first 10 systems I get this:

> CorResults[1:10,1:10]
         PL1    PL2    PL3     PL4     PL5    PL6     PL7     PL8    PL9    PL10
PL1   1.0000  0.199 -0.030 -0.1534 -0.0433 -0.047 -0.0017 -0.0542  0.052  0.0079
PL2   0.1991  1.000  0.090  0.1306 -0.0398  0.029  0.4504 -0.1713 -0.310  0.5159
PL3  -0.0299  0.090  1.000  0.1848  0.2170  0.157  0.1718  0.3185  0.083  0.4330
PL4  -0.1534  0.131  0.185  1.0000  0.0063  0.170  0.2640  0.0639 -0.178  0.2653
PL5  -0.0433 -0.040  0.217  0.0063  1.0000  0.075 -0.0168  0.1581  0.116  0.1855
PL6  -0.0470  0.029  0.157  0.1700  0.0751  1.000  0.0145  0.1401  0.011  0.0912
PL7  -0.0017  0.450  0.172  0.2640 -0.0168  0.014  1.0000 -0.0666 -0.207  0.5081
PL8  -0.0542 -0.171  0.319  0.0639  0.1581  0.140 -0.0666  1.0000  0.220  0.0098
PL9   0.0520 -0.310  0.083 -0.1781  0.1157  0.011 -0.2071  0.2195  1.000 -0.2296
PL10  0.0079  0.516  0.433  0.2653  0.1855  0.091  0.5081  0.0098 -0.230  1.0000

I'd like to take this to the next level where I pick a group of 5 that
has the lowest overall correlation, and a second group of 5 that has
the highest overall correlation. From that I'll calculate an aggregate
equity curve and then look at things like ROA on the totals as a way
to evaluate how I feel about the groups.

QUESTION:
How can I find the 5 systems in the correlation matrix that when
summed together again all possible combinations of the 5 gives me the
largest or smallest value?

Thanks,
Mark


From brian at braverock.com  Thu Feb 10 00:38:55 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 09 Feb 2011 17:38:55 -0600
Subject: [R-SIG-Finance] Trading system correlation?
In-Reply-To: <AANLkTimrb8XEUDrrJA2FShh6RewRVj_jEDQrQYwVUTuO@mail.gmail.com>
References: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>
	<AANLkTimrb8XEUDrrJA2FShh6RewRVj_jEDQrQYwVUTuO@mail.gmail.com>
Message-ID: <4D53258F.7070800@braverock.com>

On 02/09/2011 05:09 PM, Mark Knecht wrote:
> On Wed, Jan 5, 2011 at 9:21 AM, David St John<dstjohn at math.uic.edu>  wrote:
> <SNIP>
>>
>> x1 x2 x3
>>
>> x1 1.0000000 0.7682398 0.6788077
>>
>> x2 0.7682398 1.0000000 0.6088950
>>
>> x3 0.6788077 0.6088950 1.0000000
>>
>> As you can see, even if you were just randomly buying and selling these
>> contracts at odd times, but most of the time had no position (68% of the
>> time in my example), then the systems will still be very strongly
>> correlated. Since you are trying to find comparatively lower correlation
>> between market/system pairs, I think this would be as fine a measure as
>> any.  Just look for the smallest entries in your correlation matrix.
>>
>>
>> Hope this helps,
>> -David
>
> Hi all,
>     Back from oblivion. I finally got some time over the last few days
> to try and put some shape to this problem. Most of this is background.
> Skip to the bottom to get the question about R.
>
> REVUE: I have saved historical trade results from a large set of
> systems. (In this case 30) Every file used as input to this R program
> comes from a completely different trading system operating on the same
> market. (In this case about 15 months trading the Russell futures
> market - TF.D in TradeStation) I have aggregated the data into
> results/day and placed them in a large array. Looking at just the
> first 10 systems for the first 20 days the results look like this:
> (unlikely to survive email very well...)
>
>> MyResults[1:20,1:11]
>     TradingDate PL1  PL2  PL3   PL4   PL5  PL6  PL7  PL8  PL9 PL10
> 1   2009-06-01   0    0    0     0     0    0    0    0    0    0
> 2   2009-06-02   0    0    0     0     0    0    0    0    0    0
> 3   2009-06-03   0    0    0     0     0    0    0    0    0    0
> 4   2009-06-04   0  341    0     0   -89 -609    0    0 1001    0
> 5   2009-06-05   0 -569 -569  -299   333  161    0  151    0 -109
> 6   2009-06-08   0   12 -189  -189   471 -189    0  251    0    0
> 7   2009-06-09   0   81 -149   -79     0 -159 -379    0    0    0
> 8   2009-06-10  91 -799 -119  -999     0   11    0    0  401    0
> 9   2009-06-11   0 -249  191     0   271 -289 -979  571  -49 -639
> 10  2009-06-12   0  391 -449     0     0  391    0    0  741    0
> 11  2009-06-15 582  351  591   343     0  581    0    0  291  351
> 12  2009-06-16   0 -109    0 -1137   612  941    0 1201 1291    0
> 13  2009-06-17   0  171  151  -329   401 -339    0  451  581    0
> 14  2009-06-18   0  531 -169   -19     0  552 -109    0    0    0
> 15  2009-06-19   0 -429 -429  -309   352  271    0 -309  401   -9
> 16  2009-06-22 592 1342  621   504     0 1222    0    0    0  301
> 17  2009-06-23   0    0    0   564     0 -429    0    0    0    0
> 18  2009-06-24  61 -379  -59     0   401   81    0  401    0    0
> 19  2009-06-25   0 1811    0     0 -1029 1782  801  381 -559  261
> 20  2009-06-26   0   71   71    71   241    0  241  441   -9   91
>>
>
> Here's an idea of the system results from a returns point of view:
>
>> colSums(CorData)
>    PL1   PL2   PL3   PL4   PL5   PL6   PL7   PL8   PL9  PL10  PL11
> PL12  PL13  PL14  PL15  PL16  PL17  PL18  PL19  PL20  PL21  PL22  PL23
>   PL24  PL25
> 24065 35073 36471 18273 19257 30939 19296 24073 27412 20512 29211
> 28338 29093 23487 36062 18125 21926 34095 30921 32945 30546 18295
> 30707 27885 15864
>   PL26  PL27  PL28  PL29  PL30
> 23497 34502 31098 28028 30616
>
>> mean(colSums(CorData))
> [1] 27020
>
>> sd(colSums(CorData))
> [1] 6054
>
> (Not sure mean and sd make sense for this, but that's about the limit
> to my understanding about statistics...) ;-)
>
> OK, so here's the R question. Let's say I'm willing to trade 5 systems
> at one time and I have to pick 5. How do I pick?
>
> 1) Find the 5 with the largest equity. Too easy. Don't need R to do that.
>
> 2) Find some sort of 'optimized' choice...
>
> Looking at the correlation of just the first 10 systems I get this:
>
>> CorResults[1:10,1:10]
>           PL1    PL2    PL3     PL4     PL5    PL6     PL7     PL8    PL9    PL10
> PL1   1.0000  0.199 -0.030 -0.1534 -0.0433 -0.047 -0.0017 -0.0542  0.052  0.0079
> PL2   0.1991  1.000  0.090  0.1306 -0.0398  0.029  0.4504 -0.1713 -0.310  0.5159
> PL3  -0.0299  0.090  1.000  0.1848  0.2170  0.157  0.1718  0.3185  0.083  0.4330
> PL4  -0.1534  0.131  0.185  1.0000  0.0063  0.170  0.2640  0.0639 -0.178  0.2653
> PL5  -0.0433 -0.040  0.217  0.0063  1.0000  0.075 -0.0168  0.1581  0.116  0.1855
> PL6  -0.0470  0.029  0.157  0.1700  0.0751  1.000  0.0145  0.1401  0.011  0.0912
> PL7  -0.0017  0.450  0.172  0.2640 -0.0168  0.014  1.0000 -0.0666 -0.207  0.5081
> PL8  -0.0542 -0.171  0.319  0.0639  0.1581  0.140 -0.0666  1.0000  0.220  0.0098
> PL9   0.0520 -0.310  0.083 -0.1781  0.1157  0.011 -0.2071  0.2195  1.000 -0.2296
> PL10  0.0079  0.516  0.433  0.2653  0.1855  0.091  0.5081  0.0098 -0.230  1.0000
>
> I'd like to take this to the next level where I pick a group of 5 that
> has the lowest overall correlation, and a second group of 5 that has
> the highest overall correlation. From that I'll calculate an aggregate
> equity curve and then look at things like ROA on the totals as a way
> to evaluate how I feel about the groups.
>
> QUESTION:
> How can I find the 5 systems in the correlation matrix that when
> summed together again all possible combinations of the 5 gives me the
> largest or smallest value?

I would ask a different question.

I assume that the P&L distribution of your strategies is not normally 
distributed, so minimizing covariances would also minimize positive 
skew, which is likely not the outcome that you want.

Here's a simplified/modified version of a process I've used in the past 
to choose among 'similar' systems (in this case similar in all operating 
on the same market).

1. first eliminate the ones with 'bad' performance based on criteria you 
set (drawdowns, worst day, percent winning/losing days, etc.)

2. take your two 'best' performers.  this may be just P&L or may be in 
combination with other statistics.

3. pick the other 3 by looking for low/inverse correlations to your two 
best, or alternately just pick the five best

4. run a portfolio optimization to decide 'how much' to allocate to each 
system.  I use an objective like 'maximize return subject to minimizing 
drawdowns and minimizing risk concentration (component ES) while keeping 
my total drawdown and 1-day (95%, 1 in 20, about 1 day per month) ES 
below a specific threshold.

5. trade your five systems using those portfolio weights converted 
backwards to maximum position sizes.

If you have the capital, I'd skip steps 2 & 3 entirely, and let the 
optimizer decide 'how much'.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From happy.jw.kim at gmail.com  Thu Feb 10 07:42:53 2011
From: happy.jw.kim at gmail.com (Jiwon Kim)
Date: Thu, 10 Feb 2011 15:42:53 +0900
Subject: [R-SIG-Finance] Inhomogeneous Time Series Operator
Message-ID: <AANLkTikBSvAUvU2Fz0LgALzAnPQyhho_xYu5HrnFfmcZ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110210/3dbcd44f/attachment.pl>

From ggrothendieck at gmail.com  Thu Feb 10 14:02:05 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 10 Feb 2011 08:02:05 -0500
Subject: [R-SIG-Finance] Inhomogeneous Time Series Operator
In-Reply-To: <AANLkTikBSvAUvU2Fz0LgALzAnPQyhho_xYu5HrnFfmcZ@mail.gmail.com>
References: <AANLkTikBSvAUvU2Fz0LgALzAnPQyhho_xYu5HrnFfmcZ@mail.gmail.com>
Message-ID: <AANLkTim5+s6rmQDMFTQULWSt9+VzayM=DoTfHO3v-YSW@mail.gmail.com>

On Thu, Feb 10, 2011 at 1:42 AM, Jiwon Kim <happy.jw.kim at gmail.com> wrote:
> Hello everyone,
>
> I'm wondering if operators for irregulary-spaced time series are available.
> Examples are those inhomogenous operators introduced in "Operators on
> *inhomogeneous
> time series*<http://www.bilokon.co.uk/archive/academic/papers/finance/Zumbach2000.pdf>"
> by G. Zumbach et. al.
> It seems that all of those operators are included in S+FinMetrics for
> S-Plus, but cannot find any resources for R.
> I was thinking of reading S+FinMetrics implementation, but I don't have an
> access to S-Plus so don't know how I should proceed.
> If no package is yet available, it would be nice to get some advice from you
> experts where I should start.
>

You can calculate various rolling quantities using rollapply in the zoo package.


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From brian at braverock.com  Thu Feb 10 14:58:22 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 10 Feb 2011 07:58:22 -0600
Subject: [R-SIG-Finance] Inhomogeneous Time Series Operator
In-Reply-To: <AANLkTikBSvAUvU2Fz0LgALzAnPQyhho_xYu5HrnFfmcZ@mail.gmail.com>
References: <AANLkTikBSvAUvU2Fz0LgALzAnPQyhho_xYu5HrnFfmcZ@mail.gmail.com>
Message-ID: <4D53EEFE.4000108@braverock.com>

On 02/10/2011 12:42 AM, Jiwon Kim wrote:
> Hello everyone,
>
> I'm wondering if operators for irregulary-spaced time series are available.
> Examples are those inhomogenous operators introduced in "Operators on
> *inhomogeneous
> time series*<http://www.bilokon.co.uk/archive/academic/papers/finance/Zumbach2000.pdf>"
> by G. Zumbach et. al.
> It seems that all of those operators are included in S+FinMetrics for
> S-Plus, but cannot find any resources for R.
> I was thinking of reading S+FinMetrics implementation, but I don't have an
> access to S-Plus so don't know how I should proceed.
> If no package is yet available, it would be nice to get some advice from you
> experts where I should start.

It seems from a quick glance at the paper that all the metrics are 
calculated not directly over irregular time series but rather some other 
period is chosen to make them regular so that more traditional methods 
may be applied.

xts has very good support for high frequency irregular series.

period.apply and to.period should allow you to homogenize (regularize) 
the series in any way that is appropriate to your needs.

Most of the technical indicators (including EMA, used heavily by the 
paper) are in the TTR package.

The kernel estimators look pretty simple, and proceed from the above. 
there are also many kernel functions available in various R packages. I 
didn't read the paper closely enough, nor did I search on places like 
r-seek or RSiteSearch , for the specific kernel estimator used by the 
authors of the paper.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From vegorin at yahoo.com  Thu Feb 10 15:58:10 2011
From: vegorin at yahoo.com (Vladimir Egorin)
Date: Thu, 10 Feb 2011 06:58:10 -0800 (PST)
Subject: [R-SIG-Finance] quantstrat and nonstandard column names in the
	price series
In-Reply-To: <4D52FA2B.6080308@braverock.com>
References: <916506.26727.qm@web113210.mail.gq1.yahoo.com>
	<4D52FA2B.6080308@braverock.com>
Message-ID: <956865.71774.qm@web113210.mail.gq1.yahoo.com>

I continued with your example to see if I could figure out
how to add another symbol to the portfolio, and generate
orders for that symbol from a signal that is based on a
different symbol.  I didn't get far unfortunately; in the
context of the previous example, I created a different
time series :
# copy the original series and create a second ticker
TU = xts(values, as.Date(alldates))
colnames(TU) <- 'TU'

# Then added it to the portfolio
currency("USD")                                                                                                                            
 
symbols = 
c("FV","TU")                                                                                                                     
 
for(symbol in symbols){ # establish trade-able 
instruments                                                                                 
 
    stock(symbol, currency="USD",multiplier=1)
}


Then I sourced the resulting script in R. It went through some dates
apparently, and then died:


[1] "setup completed"
Warning in max(i) : no non-missing arguments to max; returning -Inf
[1] "2011-01-07 FV -1000 @ 117.9922"
[1] "2011-01-13 FV 1000 @ 118.2734"
[1] "2011-01-13 FV -1000 @ 118.2734"
[1] "2011-01-19 FV 1000 @ 118.2344"
[1] "2011-01-19 FV -1000 @ 118.2344"
[1] "2011-01-20 FV 1000 @ 117.6562"
[1] "2011-01-20 FV 1000 @ 117.6562"
[1] "2011-01-25 FV -1000 @ 118.2422"
[1] "2011-01-25 FV -1000 @ 118.2422"
[1] "2011-01-27 FV 1000 @ 118.2891"
[1] "2011-01-27 FV -1000 @ 118.2891"
[1] "2011-02-01 FV 1000 @ 118.0703"
[1] "2011-02-01 FV 1000 @ 118.0703"
Warning in min(dindex[dindex > curIndex]) :
  no non-missing arguments to min; returning Inf
Error in getPrice(mktdata, prefer = "FV") : 
  subscript out of bounds, no price was discernible from the data


--
Thanks, Vladimir


From jeffrey.ryan at lemnica.com  Thu Feb 10 18:19:35 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 10 Feb 2011 11:19:35 -0600
Subject: [R-SIG-Finance] Inhomogeneous Time Series Operator
In-Reply-To: <4D53EEFE.4000108@braverock.com>
References: <AANLkTikBSvAUvU2Fz0LgALzAnPQyhho_xYu5HrnFfmcZ@mail.gmail.com>
	<4D53EEFE.4000108@braverock.com>
Message-ID: <AANLkTinOgCAcZMuU5pfNLWfOiRf+D_hdn5M6uzp2ysp1@mail.gmail.com>

A few years back I wrote an iEMA.kernel  function in R to attempt to
get the inhomgenous stuff into R.  Josh (TTR) and I discussed adding
it in, and had chatted with Eric Zivot about it (2009??)  -- since, if
I recall, he authored the original S+ version.

My issue was a lack of data to compare output.  I think I was trying
to use the limited output from Eric's book and the user manual - and
that wasn't really the best way to go.

If someone has the interest to test output from R functions against
the known output from S+Finmetrics or some other software
implementation, I'd could likely dig up the code I wrote.

I'd likely aim to add this into TTR or some offshoot package.  There
are some other issues that may make this a non-starter, but anyone
interested can certainly contact me.

Best,
Jeff

On Thu, Feb 10, 2011 at 7:58 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 02/10/2011 12:42 AM, Jiwon Kim wrote:
>>
>> Hello everyone,
>>
>> I'm wondering if operators for irregulary-spaced time series are
>> available.
>> Examples are those inhomogenous operators introduced in "Operators on
>> *inhomogeneous
>> time
>> series*<http://www.bilokon.co.uk/archive/academic/papers/finance/Zumbach2000.pdf>"
>> by G. Zumbach et. al.
>> It seems that all of those operators are included in S+FinMetrics for
>> S-Plus, but cannot find any resources for R.
>> I was thinking of reading S+FinMetrics implementation, but I don't have an
>> access to S-Plus so don't know how I should proceed.
>> If no package is yet available, it would be nice to get some advice from
>> you
>> experts where I should start.
>
> It seems from a quick glance at the paper that all the metrics are
> calculated not directly over irregular time series but rather some other
> period is chosen to make them regular so that more traditional methods may
> be applied.
>
> xts has very good support for high frequency irregular series.
>
> period.apply and to.period should allow you to homogenize (regularize) the
> series in any way that is appropriate to your needs.
>
> Most of the technical indicators (including EMA, used heavily by the paper)
> are in the TTR package.
>
> The kernel estimators look pretty simple, and proceed from the above. there
> are also many kernel functions available in various R packages. I didn't
> read the paper closely enough, nor did I search on places like r-seek or
> RSiteSearch , for the specific kernel estimator used by the authors of the
> paper.
>
> Regards,
>
> ? - Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From risk2009 at ath.forthnet.gr  Fri Feb 11 12:06:21 2011
From: risk2009 at ath.forthnet.gr (Costas)
Date: Fri, 11 Feb 2011 13:06:21 +0200
Subject: [R-SIG-Finance] EIKON REUTERS
Message-ID: <4D55182D.10502@ath.forthnet.gr>

Has anybody worked R with Reuters' new platform EIKON?


From brian at braverock.com  Fri Feb 11 13:35:40 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 11 Feb 2011 06:35:40 -0600
Subject: [R-SIG-Finance] EIKON REUTERS
In-Reply-To: <4D55182D.10502@ath.forthnet.gr>
References: <4D55182D.10502@ath.forthnet.gr>
Message-ID: <4D552D1C.5030900@braverock.com>

On 02/11/2011 05:06 AM, Costas wrote:
> Has anybody worked R with Reuters' new platform EIKON?

EIKON seems to be a much-needed update to the old Reuters 3000 Xtra desktop.

There was some work presented here:

http://www.theresearchkitchen.com/blog/archives/287

on connecting thew prior version to R.  You likely want to start there. 
  Please report any progress (or failure) back to the list so others can 
benefit.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From markknecht at gmail.com  Fri Feb 11 16:55:10 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Fri, 11 Feb 2011 07:55:10 -0800
Subject: [R-SIG-Finance] Trading system correlation?
In-Reply-To: <4D53258F.7070800@braverock.com>
References: <AANLkTinvxkPNpq4Xa-kzk0u1AdSdHSPwdkM4d+9n3JF2@mail.gmail.com>
	<AANLkTimrb8XEUDrrJA2FShh6RewRVj_jEDQrQYwVUTuO@mail.gmail.com>
	<4D53258F.7070800@braverock.com>
Message-ID: <AANLkTimPYvX01A_Zm8Wt-x+PT4N0VQN3uq=m=w6ZBw-u@mail.gmail.com>

On Wed, Feb 9, 2011 at 3:38 PM, Brian G. Peterson <brian at braverock.com> wrote:
> On 02/09/2011 05:09 PM, Mark Knecht wrote:
<SNIP>
>> I'd like to take this to the next level where I pick a group of 5 that
>> has the lowest overall correlation, and a second group of 5 that has
>> the highest overall correlation. From that I'll calculate an aggregate
>> equity curve and then look at things like ROA on the totals as a way
>> to evaluate how I feel about the groups.
>>
>> QUESTION:
>> How can I find the 5 systems in the correlation matrix that when
>> summed together again all possible combinations of the 5 gives me the
>> largest or smallest value?
>
> I would ask a different question.
>
> I assume that the P&L distribution of your strategies is not normally
> distributed, so minimizing covariances would also minimize positive skew,
> which is likely not the outcome that you want.
>
> Here's a simplified/modified version of a process I've used in the past to
> choose among 'similar' systems (in this case similar in all operating on the
> same market).
>
> 1. first eliminate the ones with 'bad' performance based on criteria you set
> (drawdowns, worst day, percent winning/losing days, etc.)
>
> 2. take your two 'best' performers. ?this may be just P&L or may be in
> combination with other statistics.
>
> 3. pick the other 3 by looking for low/inverse correlations to your two
> best, or alternately just pick the five best
>
> 4. run a portfolio optimization to decide 'how much' to allocate to each
> system. ?I use an objective like 'maximize return subject to minimizing
> drawdowns and minimizing risk concentration (component ES) while keeping my
> total drawdown and 1-day (95%, 1 in 20, about 1 day per month) ES below a
> specific threshold.
>
> 5. trade your five systems using those portfolio weights converted backwards
> to maximum position sizes.
>
> If you have the capital, I'd skip steps 2 & 3 entirely, and let the
> optimizer decide 'how much'.
>
> Regards,
>
> ?- Brian

Brian,
   Thanks for the detailed response. It's good info and if I was
building a portfolio of these systems to trade then I'd likely do
something similar.

   None the less, off of StackOverflow I received a nice enough
solution, shown below in case it helps others looking for similar
solutions. (I take no credit other than for asking the question.) ;-)

Cheers,
Mark

x<-matrix(runif(100),10,10)
cor<-cor(x)
l <- length(cor)
l1 <- length(cor[cor<1])

#the actual high and low correlation indexes
corHigh <- order(cor)[(l1-4):l1]
corLow <- order(cor)[1:5]
#(if you just want to view the correlations cor[corLow] or
cor[corHigh] works fine)

#isolate them in the matrix so you can see where they came from easily
corHighView <- cor
corHighView[!1:l %in% corHigh] <- NA
corLowView <- cor
corLowView[!1:l %in% corLow] <- NA

#look at your matrix with your target correlations sticking out like a
sore thumb
options(digits=2)
cor

corLowView

corHighView


From markknecht at gmail.com  Fri Feb 11 17:09:21 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Fri, 11 Feb 2011 08:09:21 -0800
Subject: [R-SIG-Finance] date range when using getSymbols?
Message-ID: <AANLkTi=s1=9iO2AQhVBqf0nYk5rMOpSmBO8P+OVPxey3@mail.gmail.com>

Hi,
   I cannot spot what controls the date range for daily data
downloaded from Yahoo. Is that something out of my control & decided
by Yahoo or is there a way for me to ask for more data?

   If it matters I'm focused on ETFs at the moment.

Thanks,
Mark


From brian at braverock.com  Fri Feb 11 17:14:18 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 11 Feb 2011 10:14:18 -0600
Subject: [R-SIG-Finance] date range when using getSymbols?
In-Reply-To: <AANLkTi=s1=9iO2AQhVBqf0nYk5rMOpSmBO8P+OVPxey3@mail.gmail.com>
References: <AANLkTi=s1=9iO2AQhVBqf0nYk5rMOpSmBO8P+OVPxey3@mail.gmail.com>
Message-ID: <4D55605A.40007@braverock.com>

On 02/11/2011 10:09 AM, Mark Knecht wrote:
> Hi,
>     I cannot spot what controls the date range for daily data
> downloaded from Yahoo. Is that something out of my control&  decided
> by Yahoo or is there a way for me to ask for more data?
>
>     If it matters I'm focused on ETFs at the moment.

?getSymbols.yahoo
?getSymbols.google

see parameters 'from' and 'to'

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From markknecht at gmail.com  Fri Feb 11 17:41:59 2011
From: markknecht at gmail.com (Mark Knecht)
Date: Fri, 11 Feb 2011 08:41:59 -0800
Subject: [R-SIG-Finance] date range when using getSymbols?
In-Reply-To: <4D55605A.40007@braverock.com>
References: <AANLkTi=s1=9iO2AQhVBqf0nYk5rMOpSmBO8P+OVPxey3@mail.gmail.com>
	<4D55605A.40007@braverock.com>
Message-ID: <AANLkTinrAzpfjZtRfzn6KHMoFG6E+Fju8zWFZNxevKZm@mail.gmail.com>

On Fri, Feb 11, 2011 at 8:14 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 02/11/2011 10:09 AM, Mark Knecht wrote:
>>
>> Hi,
>> ? ?I cannot spot what controls the date range for daily data
>> downloaded from Yahoo. Is that something out of my control& ?decided
>> by Yahoo or is there a way for me to ask for more data?
>>
>> ? ?If it matters I'm focused on ETFs at the moment.
>
> ?getSymbols.yahoo
> ?getSymbols.google
>
> see parameters 'from' and 'to'
>
> ?- Brian

Stupid me. I didn't think to go look at the sub-function.

Thanks!

Cheers,
Mark


From rory.winston at gmail.com  Mon Feb 14 04:09:11 2011
From: rory.winston at gmail.com (Rory Winston)
Date: Mon, 14 Feb 2011 14:09:11 +1100
Subject: [R-SIG-Finance] EIKON REUTERS
Message-ID: <AANLkTinW8ewOzXVB83RXAj7PxnL=1619i--XeHYuNJjm@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110214/08e75f28/attachment.pl>

From aidan.corcoran11 at gmail.com  Mon Feb 14 17:04:15 2011
From: aidan.corcoran11 at gmail.com (Aidan Corcoran)
Date: Mon, 14 Feb 2011 16:04:15 +0000
Subject: [R-SIG-Finance] Datastream Interface
Message-ID: <AANLkTikHvBb+NBTWHrQTXjP9C_MEoaiNMBay7Gs4jg+t@mail.gmail.com>

Dear all,

I was just wondering if anyone knows of a way to download data from
Thomson Reuters Datastream to R?

thanks in advance
Aidan


From brian at braverock.com  Mon Feb 14 17:12:51 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 14 Feb 2011 10:12:51 -0600
Subject: [R-SIG-Finance] Datastream Interface
In-Reply-To: <AANLkTikHvBb+NBTWHrQTXjP9C_MEoaiNMBay7Gs4jg+t@mail.gmail.com>
References: <AANLkTikHvBb+NBTWHrQTXjP9C_MEoaiNMBay7Gs4jg+t@mail.gmail.com>
Message-ID: <4D595483.7070401@braverock.com>

On 02/14/2011 10:04 AM, Aidan Corcoran wrote:
> I was just wondering if anyone knows of a way to download data from
> Thomson Reuters Datastream to R?

I don't believe that Datastream still exists as a product.

Are you talking about Thomson Reuters Tick History? (TRTH)

or about their newswire?

If TRTH, we have code that does this, but it's not packages up with a 
neat little bow, and assumes a *nix infrastructure with access to curl 
and awk.

The Web Services API for dynamic requests is super-buggy, and imo they 
should have stayed with the very stable FTP request API (now turned off, 
alas)

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From Scott.Hixon at invesco.com  Mon Feb 14 17:21:31 2011
From: Scott.Hixon at invesco.com (Hixon, Scott R.)
Date: Mon, 14 Feb 2011 10:21:31 -0600
Subject: [R-SIG-Finance] Datastream Interface
Message-ID: <4261DB6D019EB04B998F47B6220944F9056CCCDA@USHOUXMAIL02.corp.amvescap.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110214/701c75a8/attachment.pl>

From pierrelap at gmail.com  Mon Feb 14 19:24:04 2011
From: pierrelap at gmail.com (Pierre Lapointe)
Date: Mon, 14 Feb 2011 13:24:04 -0500
Subject: [R-SIG-Finance] Datastream Interface
In-Reply-To: <4261DB6D019EB04B998F47B6220944F9056CCCDA@USHOUXMAIL02.corp.amvescap.net>
References: <4261DB6D019EB04B998F47B6220944F9056CCCDA@USHOUXMAIL02.corp.amvescap.net>
Message-ID: <AANLkTinrBZRrfEcsktDWutKdpR+7N=j5bJvo+iURRxnc@mail.gmail.com>

There is now way to access Datastream from R at this time. It used to
be accessible through a free interface called zappy (XML). But
Datastream discontinued it.

Matlab has an API to Datastream, but you have to pay a fee to
Datastream for it.
http://www.mathworks.com/help/toolbox/datafeed/datastream.fetch.html

The last time I spoke to my Datastream rep., there was no plan to
offer 1) a free API and 2) a way to connect through R.

This is why I try to work as much as possible using the Bloomberg API
(through RBloomberg).

For Datastream data, I have several Excel request tables that I update
with the "AFO Index.xlsx" file at night. Everything  runs
automatically using Scheduler (Windows program). My R programs then
read the excel data through read.xlsx.

Pierre Lapointe
Global Macro Strategist

Brockhouse Cooper


On Mon, Feb 14, 2011 at 11:21 AM, Hixon, Scott R.
<Scott.Hixon at invesco.com> wrote:
> Datastream does indeed still exist as a product. ?However, to my
> knowledge there is not a way to directly access it using R.
>
>
>
> ________________________________________
>
> Scott Hixon, CFA
>
> Head of Investment Research
>
> Portfolio Manager
>
> Global Asset Allocation
>
>
>
> 404.439.3123 direct
>
> 404.892.0896 main
>
> 404.439.4918 facsimile
>
> scott.hixon at invesco.com
>
>
>
> Invesco Global Strategies
>
> Two Peachtree Pointe
>
> 1555 Peachtree Street, NE
>
> Atlanta, Georgia 30309
>
>
>
>
>
>
>
> ****************************************************************
> Confidentiality Note: The information contained in this ...{{dropped:12}}
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From Scott.Hixon at invesco.com  Mon Feb 14 19:29:47 2011
From: Scott.Hixon at invesco.com (Hixon, Scott R.)
Date: Mon, 14 Feb 2011 12:29:47 -0600
Subject: [R-SIG-Finance] Datastream Interface
Message-ID: <4261DB6D019EB04B998F47B6220944F90142F59B@USHOUXMAIL02.corp.amvescap.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110214/ca3f182b/attachment.pl>

From riccardovisca at yahoo.it  Tue Feb 15 12:43:53 2011
From: riccardovisca at yahoo.it (riccardo visca)
Date: Tue, 15 Feb 2011 11:43:53 +0000 (GMT)
Subject: [R-SIG-Finance] Datastream Interface
In-Reply-To: <mailman.3.1297767601.14425.r-sig-finance@r-project.org>
References: <mailman.3.1297767601.14425.r-sig-finance@r-project.org>
Message-ID: <361993.93086.qm@web27304.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110215/813448d5/attachment.pl>

From aidan.corcoran11 at gmail.com  Tue Feb 15 19:18:48 2011
From: aidan.corcoran11 at gmail.com (Aidan Corcoran)
Date: Tue, 15 Feb 2011 18:18:48 +0000
Subject: [R-SIG-Finance] Datastream Interface
In-Reply-To: <361993.93086.qm@web27304.mail.ukl.yahoo.com>
References: <mailman.3.1297767601.14425.r-sig-finance@r-project.org>
	<361993.93086.qm@web27304.mail.ukl.yahoo.com>
Message-ID: <AANLkTikynm+LrYCECb-xeOZ4E9XafOzY1e+iD=VG+Y6Q@mail.gmail.com>

Thanks to all for the suggestions.

Pierre's approach (using Excel to read from datastream then R to read
from Excel) seems like the most practical way, assuming one stays
within the Excel spreadsheet size limits (I'm mainly interested in
economic data series, so this shouldn't be a constraint).


From simon7199 at gmail.com  Wed Feb 16 06:40:43 2011
From: simon7199 at gmail.com (Simon)
Date: Wed, 16 Feb 2011 18:40:43 +1300
Subject: [R-SIG-Finance] how to plot shade area with quantmod in log scale
Message-ID: <AANLkTikZG40UnmYMhCh+tJd_d0w0rDqbmJJABKobGPW4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110216/418360a3/attachment.pl>

From bogaso.christofer at gmail.com  Wed Feb 16 15:48:22 2011
From: bogaso.christofer at gmail.com (Bogaso Christofer)
Date: Wed, 16 Feb 2011 20:18:22 +0530
Subject: [R-SIG-Finance] Omiting some observation of a zoo object
Message-ID: <004201cbcde8$91fcc640$b5f652c0$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110216/06996618/attachment.pl>

From ggrothendieck at gmail.com  Wed Feb 16 15:39:10 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 16 Feb 2011 09:39:10 -0500
Subject: [R-SIG-Finance] Omiting some observation of a zoo object
In-Reply-To: <004201cbcde8$91fcc640$b5f652c0$@gmail.com>
References: <004201cbcde8$91fcc640$b5f652c0$@gmail.com>
Message-ID: <AANLkTi=FRHpvk_R4SwUY=6Yc3gc2kSuLSmx6HOzQw407@mail.gmail.com>

On Wed, Feb 16, 2011 at 9:48 AM, Bogaso Christofer
<bogaso.christofer at gmail.com> wrote:
> Hi there, I would like to omit some observations of a zoo vector
> corresponding with some defined dates. So I wrote following codes:
>
>
>
>> set.seed(1)
>
>> dates <- seq(as.Date("2011-01-01"), as.Date("2011-01-31"), by="1
> day")[-c(7,8,9,20,21,22)]
>
>> mySeries <- zoo(rnorm(25), dates)
>
>> mySeries
>
> 2011-01-01 ?2011-01-02 ?2011-01-03 ?2011-01-04 ?2011-01-05 ?2011-01-06
> 2011-01-10 ?2011-01-11 ?2011-01-12 ?2011-01-13 ?2011-01-14 ?2011-01-15
>
> -0.62645381 ?0.18364332 -0.83562861 ?1.59528080 ?0.32950777 -0.82046838
> 0.48742905 ?0.73832471 ?0.57578135 -0.30538839 ?1.51178117 ?0.38984324
>
> ?2011-01-16 ?2011-01-17 ?2011-01-18 ?2011-01-19 ?2011-01-23 ?2011-01-24
> 2011-01-25 ?2011-01-26 ?2011-01-27 ?2011-01-28 ?2011-01-29 ?2011-01-30
>
> -0.62124058 -2.21469989 ?1.12493092 -0.04493361 -0.01619026 ?0.94383621
> 0.82122120 ?0.59390132 ?0.91897737 ?0.78213630 ?0.07456498 -1.98935170
>
> ?2011-01-31
>
> ?0.61982575
>
>> toOmit <- as.Date(c("2011-01-07", "2011-01-08", "2011-01-09"))
>
>> mySeries[-toOmit]
>
> Error in `-.Date`(toOmit) : unary - is not defined for Date objects
>

Here are three ways:

library(zoo)

## set up input data
set.seed(1)
mySeries <- zooreg(rnorm(25), as.Date("2011-01-01"))
toOmit <- as.Date(c("2011-01-07", "2011-01-08", "2011-01-09"))

## method 1. window.zoo
window(mySeries, setdiff(time(mySeries), toOmit))

## method 2. %in%
mySeries[! time(mySeries) %in% toOmit ]

## method 3. na.omit - if mySeries has no NAs
na.omit(replace(mySeries, toOmit, NA))

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From bogaso.christofer at gmail.com  Wed Feb 16 16:11:04 2011
From: bogaso.christofer at gmail.com (Bogaso Christofer)
Date: Wed, 16 Feb 2011 20:41:04 +0530
Subject: [R-SIG-Finance] Omiting some observation of a zoo object
In-Reply-To: <AANLkTi=FRHpvk_R4SwUY=6Yc3gc2kSuLSmx6HOzQw407@mail.gmail.com>
References: <004201cbcde8$91fcc640$b5f652c0$@gmail.com>
	<AANLkTi=FRHpvk_R4SwUY=6Yc3gc2kSuLSmx6HOzQw407@mail.gmail.com>
Message-ID: <006801cbcdeb$bd8527a0$388f76e0$@gmail.com>

Thanks Gabor for your solution. However I was expecting some more elegant
solution that is based on the Indexing system like (0, negative etc) in R.
Anyway I am happy with your solution.

Thanks and regards,

-----Original Message-----
From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com] 
Sent: 16 February 2011 20:09
To: Bogaso Christofer
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Omiting some observation of a zoo object

On Wed, Feb 16, 2011 at 9:48 AM, Bogaso Christofer
<bogaso.christofer at gmail.com> wrote:
> Hi there, I would like to omit some observations of a zoo vector 
> corresponding with some defined dates. So I wrote following codes:
>
>
>
>> set.seed(1)
>
>> dates <- seq(as.Date("2011-01-01"), as.Date("2011-01-31"), by="1
> day")[-c(7,8,9,20,21,22)]
>
>> mySeries <- zoo(rnorm(25), dates)
>
>> mySeries
>
> 2011-01-01 ?2011-01-02 ?2011-01-03 ?2011-01-04 ?2011-01-05 ?2011-01-06
> 2011-01-10 ?2011-01-11 ?2011-01-12 ?2011-01-13 ?2011-01-14 ?2011-01-15
>
> -0.62645381 ?0.18364332 -0.83562861 ?1.59528080 ?0.32950777 
> -0.82046838
> 0.48742905 ?0.73832471 ?0.57578135 -0.30538839 ?1.51178117 ?0.38984324
>
> ?2011-01-16 ?2011-01-17 ?2011-01-18 ?2011-01-19 ?2011-01-23 ?
> 2011-01-24
> 2011-01-25 ?2011-01-26 ?2011-01-27 ?2011-01-28 ?2011-01-29 ?2011-01-30
>
> -0.62124058 -2.21469989 ?1.12493092 -0.04493361 -0.01619026 ?
> 0.94383621
> 0.82122120 ?0.59390132 ?0.91897737 ?0.78213630 ?0.07456498 -1.98935170
>
> ?2011-01-31
>
> ?0.61982575
>
>> toOmit <- as.Date(c("2011-01-07", "2011-01-08", "2011-01-09"))
>
>> mySeries[-toOmit]
>
> Error in `-.Date`(toOmit) : unary - is not defined for Date objects
>

Here are three ways:

library(zoo)

## set up input data
set.seed(1)
mySeries <- zooreg(rnorm(25), as.Date("2011-01-01")) toOmit <-
as.Date(c("2011-01-07", "2011-01-08", "2011-01-09"))

## method 1. window.zoo
window(mySeries, setdiff(time(mySeries), toOmit))

## method 2. %in%
mySeries[! time(mySeries) %in% toOmit ]

## method 3. na.omit - if mySeries has no NAs na.omit(replace(mySeries,
toOmit, NA))

--
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ggrothendieck at gmail.com  Wed Feb 16 16:12:16 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 16 Feb 2011 10:12:16 -0500
Subject: [R-SIG-Finance] Omiting some observation of a zoo object
In-Reply-To: <006801cbcdeb$bd8527a0$388f76e0$@gmail.com>
References: <004201cbcde8$91fcc640$b5f652c0$@gmail.com>
	<AANLkTi=FRHpvk_R4SwUY=6Yc3gc2kSuLSmx6HOzQw407@mail.gmail.com>
	<006801cbcdeb$bd8527a0$388f76e0$@gmail.com>
Message-ID: <AANLkTinVL20hYwh_JSFmwx=syVCH3y6ehP78LCRMZidF@mail.gmail.com>

On Wed, Feb 16, 2011 at 10:11 AM, Bogaso Christofer
<bogaso.christofer at gmail.com> wrote:
> Thanks Gabor for your solution. However I was expecting some more elegant
> solution that is based on the Indexing system like (0, negative etc) in R.
> Anyway I am happy with your solution.

zoo supports negative indexing in those situations that R does.  For
example, these work:

mySeries[-(7:9)]

z <- zoo(cbind(a = 1:3, b = 4:6))
subset(z, select = -b)

The xts package does have certain extended indexing facilities.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From johannes.lips at googlemail.com  Fri Feb 18 11:05:06 2011
From: johannes.lips at googlemail.com (Johannes Lips)
Date: Fri, 18 Feb 2011 11:05:06 +0100
Subject: [R-SIG-Finance] Estimation of an GARCH model with conditional
	skewness and kurtosis
In-Reply-To: <4D5B6D43.8010504@googlemail.com>
References: <4D5B6D43.8010504@googlemail.com>
Message-ID: <AANLkTinoS4LG0=eK8U-8fPVqpGchxe7exfHb5JoRkFTz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110218/18f3e168/attachment.pl>

From chalabi at phys.ethz.ch  Fri Feb 18 11:57:30 2011
From: chalabi at phys.ethz.ch (Yohan Chalabi)
Date: Fri, 18 Feb 2011 11:57:30 +0100
Subject: [R-SIG-Finance] Estimation of an GARCH model with conditional
	skewness and kurtosis
In-Reply-To: <AANLkTinoS4LG0=eK8U-8fPVqpGchxe7exfHb5JoRkFTz@mail.gmail.com>
References: <4D5B6D43.8010504@googlemail.com>
	<AANLkTinoS4LG0=eK8U-8fPVqpGchxe7exfHb5JoRkFTz@mail.gmail.com>
Message-ID: <FFBE77CF-8469-4FD4-B6B5-D4C9EDC6EED5@phys.ethz.ch>

Hi Johannes,

You can start with the code I sent you on R-help  https://stat.ethz.ch/pipermail/r-help/2011-February/268953.html and

 * add the definition of skewness and kurtosis in the likelihood function
 * modify the conditional variance as defined in the paper
 * replace the normal probability function by the one defined in the paper.

You might get more help if you show us what you have tried.

HTH,
Yohan

On Feb 18, 2011, at 11:05 AM, Johannes Lips wrote:

> Hello,
> 
> I'm quite new to R but tried to learn as much as possible in the last
> few months.
> My problem is that I would like to estimate the model of Leon et al. (2005).
> I have shortly summarised the most important equations in the following
> pdf file:
> http://hannes.fedorapeople.org/leon2005.pdf
> 
> My main question is now how could I introduce these two additional terms
> into the Likelihood function of a(n) (existing) GARCH method.
> 
> I looked into some GARCH packages but wasn't really sure where to start.
> I know that this is not really an easy task but I would be very grateful
> if you could help me out by giving me some hints on how to solve this
> problem.
> 
> Thanks in advance!
> 
> Johannes Lips
> 
> P.S. I sent this e-mail also to the R-help mailing list but was told I
> should better send it to the finance-sig.
> https://stat.ethz.ch/pipermail/r-help/2011-February/268871.html
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> 

--
PhD candidate
Swiss Federal Institute of Technology
Zurich

www.ethz.ch


From johannes.lips at googlemail.com  Fri Feb 18 13:04:58 2011
From: johannes.lips at googlemail.com (Johannes Lips)
Date: Fri, 18 Feb 2011 13:04:58 +0100
Subject: [R-SIG-Finance] Estimation of an GARCH model with conditional
 skewness and kurtosis
In-Reply-To: <FFBE77CF-8469-4FD4-B6B5-D4C9EDC6EED5@phys.ethz.ch>
References: <4D5B6D43.8010504@googlemail.com>
	<AANLkTinoS4LG0=eK8U-8fPVqpGchxe7exfHb5JoRkFTz@mail.gmail.com>
	<FFBE77CF-8469-4FD4-B6B5-D4C9EDC6EED5@phys.ethz.ch>
Message-ID: <AANLkTi=4-nzL8M+mkabKj0rsDi17zYz-B+5=qie8izc2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110218/5dc2d398/attachment.pl>

From johannes.lips at googlemail.com  Sat Feb 19 15:14:13 2011
From: johannes.lips at googlemail.com (Johannes Lips)
Date: Sat, 19 Feb 2011 15:14:13 +0100
Subject: [R-SIG-Finance] Estimation of an GARCH model with conditional
 skewness and kurtosis
In-Reply-To: <FFBE77CF-8469-4FD4-B6B5-D4C9EDC6EED5@phys.ethz.ch>
References: <4D5B6D43.8010504@googlemail.com>
	<AANLkTinoS4LG0=eK8U-8fPVqpGchxe7exfHb5JoRkFTz@mail.gmail.com>
	<FFBE77CF-8469-4FD4-B6B5-D4C9EDC6EED5@phys.ethz.ch>
Message-ID: <4D5FD035.9090200@googlemail.com>

Hi,

I managed to advance a bit. So far the GARCHSK method looks like this:
llhGarchSK11N <- function(par, x)
{
mu		<- par[1];
omega 	<- par[2];
alpha 	<- par[3];
beta 	<- par[4];
gamma0	<- par[5];
gamma1	<- par[6];
delta0	<- par[7];
delta1	<- par[8];
eta		<- par[9];
numrowx <- nrow(x)
#Error
e <- x - mu
eta=e/e2t
e2 <- e^2
#Skewness
sk <- (((x - mu)^3) / length(x))/ sd(x)^3
#Kurtosis
ku <- (((x - mu)^4 / length(x))/ sd(x)^4) - 3

#Conditional Skewness
#st = ?0 + ?1 ?t?1 + ?2 st?1
skt <- gamma0 + gamma1*c(mean(sk),sk[-length(x)])
# Conditional Kurtosis
#kt = ?0 + ?1 ?t?1 + ?kt?1
kut=delta0 + delta1*c(mean(ku),ku[-length(x)])
#Conditional Variance
e2t <- omega + alpha*c(mean(e2),e2[-length(x)])


s2 <- filter(e2t, beta, "recursive", init = mean(e2))
sk <-filter(skt, gamma, "recursive", init = mean(skt))
ku <- filter(kut, delta, "recursive", init = mean(kut))

#Likelihood function
# -sum(log(dnorm(e, mean = 0, sd = sqrt(abs(s2)))))
  #Augmented Likelihood function
  -sum( -0.5*(log(h) - 0.5*(eta)^2 + 
log(1+(sk/6)*(eta^3-3*eta)+((ku-3)/24)*(eta^4-6*eta^2+3))^2-log(1+((sk^2)/6)+(ku-3)^2/24)))
}

If I execute the function with the following command:
	mu	<- mean(x) ;omega <- 0.1*var(x); alpha <- 0.1; beta 	<- 0.1; gamma0 
<- 0; gamma1	<-0; delta0	<- 0; delta1	<- 0; eta<- 0
parNSK <- c(mu,omega, alpha, beta, gamma0, gamma1, delta0, delta1, eta)
llhGarchSK11N (parNSK,x)

I only get the following error:
   cannot coerce type 'builtin' to vector of type 'double'
In addition: Warning message:
In is.na(filter) :
   is.na() applied to non-(list or vector) of type 'builtin'

I don't really know if the method is working somehow and would be 
grateful to any hints.

Thanks in advance!

Johannes

On 02/18/2011 11:57 AM, Yohan Chalabi wrote:
> Hi Johannes,
>
> You can start with the code I sent you on R-help  https://stat.ethz.ch/pipermail/r-help/2011-February/268953.html and
>
>   * add the definition of skewness and kurtosis in the likelihood function
>   * modify the conditional variance as defined in the paper
>   * replace the normal probability function by the one defined in the paper.
>
> You might get more help if you show us what you have tried.
>
> HTH,
> Yohan
>
> On Feb 18, 2011, at 11:05 AM, Johannes Lips wrote:
>
>> Hello,
>>
>> I'm quite new to R but tried to learn as much as possible in the last
>> few months.
>> My problem is that I would like to estimate the model of Leon et al. (2005).
>> I have shortly summarised the most important equations in the following
>> pdf file:
>> http://hannes.fedorapeople.org/leon2005.pdf
>>
>> My main question is now how could I introduce these two additional terms
>> into the Likelihood function of a(n) (existing) GARCH method.
>>
>> I looked into some GARCH packages but wasn't really sure where to start.
>> I know that this is not really an easy task but I would be very grateful
>> if you could help me out by giving me some hints on how to solve this
>> problem.
>>
>> Thanks in advance!
>>
>> Johannes Lips
>>
>> P.S. I sent this e-mail also to the R-help mailing list but was told I
>> should better send it to the finance-sig.
>> https://stat.ethz.ch/pipermail/r-help/2011-February/268871.html
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>
> --
> PhD candidate
> Swiss Federal Institute of Technology
> Zurich
>
> www.ethz.ch
>


From me at censix.com  Mon Feb 21 10:22:52 2011
From: me at censix.com (me at censix.com)
Date: Mon, 21 Feb 2011 10:22:52 +0100 (CET)
Subject: [R-SIG-Finance] quantstrat for live trading - some questions
Message-ID: <10980.109.164.245.89.1298280172.squirrel@censix.com>

Hi all

this is mainly directed to the developers of the great "quantstrat"
package. I am happy to continue this conversation with any of them
individually.

I have been backtesting some strategies on quantstrat. In order to take
them live (through the ibrokers package) I have recently begun to write my
own versions of some key quantstrat functions, i.e. applyStrategy,
applyRules and ruleOrderProc (addOrder is to follow)

One thing I have been looking at is how to make the "applyRules" function
process only one timestamp at a time (process all rules only for one
specific marketdata timestamp). I consider my solution to this problem to
be a rather ugly fix that I would really like to avoid, since essentially
it looks like the "applyRules" function has already been designed for that
sort of thing, but the implementation seems to be buggy or I just don't
understand it.

I am asking for some help from the list. I have attached my slightly
modified version of "applyRules" and am hoping to get some comments that
will make me "see the light" here.

Thanks and best regards

Soren








-------------- next part --------------
A non-text attachment was scrubbed...
Name: IBapplyRules.r
Type: application/octet-stream
Size: 15789 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110221/4f3f0c73/attachment.obj>

From stephen at organicfoodmarkets.com.au  Tue Feb 22 09:16:55 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 22 Feb 2011 19:16:55 +1100
Subject: [R-SIG-Finance] quantstrat - stop loss and stop trailing:
Message-ID: <4D6370F7.1070609@organicfoodmarkets.com.au>

Hi

Can anyone point me to examples of  using  stop loss and stop trailing 
with maCross?

-- 
Stephen Choularton Ph.D., FIoD


From slzimine at gmail.com  Tue Feb 22 10:39:44 2011
From: slzimine at gmail.com (slava zimine)
Date: Tue, 22 Feb 2011 10:39:44 +0100
Subject: [R-SIG-Finance] showing more ticks in quantmod charting
Message-ID: <AANLkTikbZVwRhWLYmPG8acv10aLFJCSe_Oom-r7heuig@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/09e2da8a/attachment.pl>

From slzimine at gmail.com  Tue Feb 22 12:36:07 2011
From: slzimine at gmail.com (slava zimine)
Date: Tue, 22 Feb 2011 12:36:07 +0100
Subject: [R-SIG-Finance] showing more ticks in quantmod charting
In-Reply-To: <AANLkTikbZVwRhWLYmPG8acv10aLFJCSe_Oom-r7heuig@mail.gmail.com>
References: <AANLkTikbZVwRhWLYmPG8acv10aLFJCSe_Oom-r7heuig@mail.gmail.com>
Message-ID: <AANLkTik5pxv_kzc5xK7cXy-Y4xjJ2YaQbSNxMY=YFsXc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/d58387f5/attachment.pl>

From babel at centrum.sk  Tue Feb 22 15:32:58 2011
From: babel at centrum.sk (babel at centrum.sk)
Date: Tue, 22 Feb 2011 15:32:58 +0100
Subject: [R-SIG-Finance] Lags in ArchTest
In-Reply-To: <AANLkTik5pxv_kzc5xK7cXy-Y4xjJ2YaQbSNxMY=YFsXc@mail.gmail.com>
References: <AANLkTikbZVwRhWLYmPG8acv10aLFJCSe_Oom-r7heuig@mail.gmail.com>
	<AANLkTik5pxv_kzc5xK7cXy-Y4xjJ2YaQbSNxMY=YFsXc@mail.gmail.com>
Message-ID: <20110222143258.D870D177AF@mail1004.cent>


Dear researchers

I would like to ask you, what is the correct number of Lags in ARCH LM Test?  I am referring to ArchTest in FinTS package, but other ArchTest (such as the one in Eviews) provide same results. In many time series, when I choose Lags between 1:5 the p.value is usually higher than 0.05, but with increasing of Lags, p.value becomes smaller. So how to do the correct decision if for lag=1, the time series looks homoscedastic(NO ARCH Effects), but for lags=5 and lags=12 result is heteroscedastic (presence of ACH) or reverse?
Thank you

Sincerely Jan



#Example code
library(quantmod) 
library(FinTS)
getSymbols("XPT/USD",src="oanda")
ret_xptusd<-as.numeric(diff(log(XPTUSD)))
ones<-rep(1,500)
ols<-lm(ts(ret_xptusd)~ones);ols
residuals<-ols$residuals

ArchTest(residuals,lags=1)   # p-value = 0.008499
ArchTest(residuals,lags=5)   # p-value = 0.08166
ArchTest(residuals,lags=12)  #p-value = 0.2317


From brian at braverock.com  Tue Feb 22 15:44:40 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 22 Feb 2011 08:44:40 -0600
Subject: [R-SIG-Finance] quantstrat - stop loss and stop trailing:
In-Reply-To: <4D6370F7.1070609@organicfoodmarkets.com.au>
References: <4D6370F7.1070609@organicfoodmarkets.com.au>
Message-ID: <4D63CBD8.5010805@braverock.com>

On 02/22/2011 02:16 AM, Stephen Choularton wrote:
> Hi
>
> Can anyone point me to examples of using stop loss and stop trailing
> with maCross?
>

There are examples of both 'stoplimit' and 'stoptrailing' orders in the 
'macd' demo.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Tue Feb 22 16:15:35 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 22 Feb 2011 09:15:35 -0600
Subject: [R-SIG-Finance] quantstrat for live trading - some questions
In-Reply-To: <10980.109.164.245.89.1298280172.squirrel@censix.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
Message-ID: <4D63D317.7060907@braverock.com>

On 02/21/2011 03:22 AM, me at censix.com wrote:
> this is mainly directed to the developers of the great "quantstrat"
> package. I am happy to continue this conversation with any of them
> individually.
>
> I have been backtesting some strategies on quantstrat. In order to take
> them live (through the ibrokers package) I have recently begun to write my
> own versions of some key quantstrat functions, i.e. applyStrategy,
> applyRules and ruleOrderProc (addOrder is to follow)
>
> One thing I have been looking at is how to make the "applyRules" function
> process only one timestamp at a time (process all rules only for one
> specific marketdata timestamp). I consider my solution to this problem to
> be a rather ugly fix that I would really like to avoid, since essentially
> it looks like the "applyRules" function has already been designed for that
> sort of thing, but the implementation seems to be buggy or I just don't
> understand it.
>
> I am asking for some help from the list. I have attached my slightly
> modified version of "applyRules" and am hoping to get some comments that
> will make me "see the light" here.
>
> Thanks and best regards

Soren,

Probably best a discussion for off-list.  I'll send this initial 
response to the list, since I think others might find it useful, but the 
technical discussion likely to follow should probably happen off-list.

The biggest difficulty is that basically everything needs to change a 
little to be handled with streaming data.

Let's assume for the moment that your indicator and signal generators 
are fast enough that you can get data from IB and run them using 
'applyIndicators' and 'applySignals' basically unchanged in your event 
loop.  This seems like a reasonable enough assumption, given that we can 
backtest strategies on tick data (millions of timestamps) in about a 
minute per day

In this case, you'd start by modifying/replacing applyStrategy with your 
IB event loop that will get data for the instrument(s) you're 
monitoring, and calculate your indicators and signals.

As you've noted, and as is mentioned in the quantstrat documentation, 
'ruleOrderProc', 'addOrder', and 'applyRules' also need to change.

'ruleOrderProc' probably goes away entirely in this mode.  it exists in 
the quantstrat package basically as the 'fill simulator' container for 
turning open orders into transactions in the trade blotter.  If you 
still wanted to keep a 'blotter' of fills, rather than or in addition to 
simply querying IB whenever you need your position, then it would make 
sense to modify rather than replace ruleOrderProc.

'addOrder' should in all likelihood be replaced (or overloaded) by a 
wrapper for the IB order functions.

Quickly, I'll talk about dindex in applyRules.  It's there predominantly 
for handling tick data, and can be seen as short for a 'dimension 
reduction' index.  By looking at places where we *might* have to do 
something, we routinely reduce millions of timestamps to a few hundred 
on a day of tick data, which, as one might imagine, massively improves 
the total time it takes to do a backtest. For streaming/periodic data, 
there is indeed no reason to use dindex, and curIndex can be set to FALSE.

It seems that technical implementation details will probably be best 
hand;ed off-list.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From henry.ward at me.com  Tue Feb 22 17:17:19 2011
From: henry.ward at me.com (Henry Ward)
Date: Tue, 22 Feb 2011 08:17:19 -0800
Subject: [R-SIG-Finance] PerformanceAnalytics Marginal VaR
In-Reply-To: <4D63D317.7060907@braverock.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
	<4D63D317.7060907@braverock.com>
Message-ID: <E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/5fb809e4/attachment.pl>

From jeffrey.ryan at lemnica.com  Tue Feb 22 17:24:42 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 22 Feb 2011 10:24:42 -0600
Subject: [R-SIG-Finance] PerformanceAnalytics Marginal VaR
In-Reply-To: <E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
	<4D63D317.7060907@braverock.com>
	<E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>
Message-ID: <AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/1852f7d4/attachment.pl>

From henry.ward at me.com  Tue Feb 22 18:13:29 2011
From: henry.ward at me.com (Henry Ward)
Date: Tue, 22 Feb 2011 09:13:29 -0800
Subject: [R-SIG-Finance] PerformanceAnalytics Marginal VaR
In-Reply-To: <AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
	<4D63D317.7060907@braverock.com>
	<E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>
	<AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
Message-ID: <42DFB789-C82D-481E-9F94-942553AB183A@me.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/b7035ef5/attachment.pl>

From brian at braverock.com  Tue Feb 22 18:27:02 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 22 Feb 2011 11:27:02 -0600
Subject: [R-SIG-Finance] PerformanceAnalytics Marginal VaR
In-Reply-To: <42DFB789-C82D-481E-9F94-942553AB183A@me.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>	<4D63D317.7060907@braverock.com>	<E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>	<AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
	<42DFB789-C82D-481E-9F94-942553AB183A@me.com>
Message-ID: <4D63F1E6.3070902@braverock.com>

On 02/22/2011 11:13 AM, Henry Ward wrote:
> Hi Jeff,
> Thank you for your assistance.  Below is my configuration before updating from R-Forge.  After updating xts from R-Forge with
>
>> >  install.packages("xts", repos="http://R-Forge.R-project.org")
> I restart R and it tells me that xts was built under R 2.12.2 which I don't have.  I've updated to the latest 2.12.1 but can't seem to find an xts repository between the cutting edge R-Forge and the older CRAN.
>
> Thank you for posting the update on CRAN.  If you could shoot me a quick email letting me know when you might be able to do it I'd appreciate.  My project requires the marginal VaR calculation.  Thanks.

You should be able to use the R-Forge version on R 2.12.1 (with a 
warning on load).

If it won't load the new xts, let us know.  But the marginal VaR calc 
works for me with the latest xts.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From henry.ward at me.com  Tue Feb 22 19:02:59 2011
From: henry.ward at me.com (Henry Ward)
Date: Tue, 22 Feb 2011 10:02:59 -0800
Subject: [R-SIG-Finance] XTS R-Forge Installation Error
In-Reply-To: <AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
	<4D63D317.7060907@braverock.com>
	<E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>
	<AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
Message-ID: <91918B68-3CC6-4BD2-A140-E1FA3E57DB71@me.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/cafcb338/attachment.pl>

From jeffrey.ryan at lemnica.com  Tue Feb 22 20:17:52 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 22 Feb 2011 13:17:52 -0600
Subject: [R-SIG-Finance] PerformanceAnalytics Marginal VaR
In-Reply-To: <42DFB789-C82D-481E-9F94-942553AB183A@me.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
	<4D63D317.7060907@braverock.com>
	<E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>
	<AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
	<42DFB789-C82D-481E-9F94-942553AB183A@me.com>
Message-ID: <AANLkTi=ecrWNq9yESxXbk7QezTr90B3qrUhM2rkq=r-_@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/d554e746/attachment.pl>

From henry.ward at me.com  Tue Feb 22 21:16:13 2011
From: henry.ward at me.com (Henry Ward)
Date: Tue, 22 Feb 2011 12:16:13 -0800
Subject: [R-SIG-Finance] RESOLVED: Re:  XTS R-Forge Installation Error
In-Reply-To: <91918B68-3CC6-4BD2-A140-E1FA3E57DB71@me.com>
References: <10980.109.164.245.89.1298280172.squirrel@censix.com>
	<4D63D317.7060907@braverock.com>
	<E79AFD77-7059-4381-9BF6-47D58D8DF9DD@me.com>
	<AANLkTimG6MReeNxWQ-rDftUK_Fc_pEyH5cgBW_F0HQMD@mail.gmail.com>
	<91918B68-3CC6-4BD2-A140-E1FA3E57DB71@me.com>
Message-ID: <3FE15A43-844D-4AAC-BC04-B47FD65216D4@me.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110222/4332fed0/attachment.pl>

From worik.stanton at gmail.com  Wed Feb 23 04:01:08 2011
From: worik.stanton at gmail.com (Worik Stanton)
Date: Wed, 23 Feb 2011 16:01:08 +1300
Subject: [R-SIG-Finance] Strange troubles with sub-setting xts
Message-ID: <AANLkTikueAuYD6EbWRbdiYGHJFWTrtNgwfZzbkQXBqdg@mail.gmail.com>

I cannot get a small example to illustrate this, as the problem
disappears in strange ways.  So this email will have a lot of text.

I do not know how to get xts version but here is the R version

 > R.version
               _
platform       i686-pc-linux-gnu
arch           i686
os             linux-gnu
system         i686, linux-gnu
status
major          2
minor          11.1
year           2010
month          05
day            31
svn rev        52157
language       R
version.string R version 2.11.1 (2010-05-31)


I have a xts caled A.x

> class(A.x)
[1] "xts" "zoo"
> names(A.x)
[1] "Lev"   "200MA" "RF"    "Ret"
>> c(start(A.x), end(A.x))
[1] "1928-01-31" "2010-07-31"
>

(It is a processed version of S&P500 monthly index)

When I subset A.x by date the 4th column (Ret) gets mangled.

Below are screeds of data, sorry, but if I shrink these the problem disappears.

cheers
Worik

> Z <- merge(A.x["1929::2010",4], A.x[,4])
> Y <- merge(Z, Z[,1]-Z[,2])
> Y
1928-01-31            NA            NA            NA
1928-02-29            NA -1.764371e-02            NA
1928-03-31            NA  1.083430e-01            NA
1928-04-30            NA  3.240983e-02            NA
1928-05-31            NA  1.265823e-02            NA
1928-06-30            NA -4.050000e-02            NA
1928-07-31            NA  1.250651e-02            NA
1928-08-31            NA  7.411220e-02            NA
1928-09-30            NA  2.395783e-02            NA
1928-10-31            NA  1.450632e-02            NA
1928-11-30            NA  1.199262e-01            NA
1928-12-31            NA  2.883031e-03            NA
1929-01-31  1.720000e+00  5.708419e-02  1.662916e+00
1929-02-28  1.130000e+00 -5.827506e-03  1.135828e+00
1929-03-31  6.700000e-01 -2.344666e-03  6.723447e-01
1929-04-30  1.900000e-01  1.605954e-02  1.739405e-01
1929-05-31  3.000000e-02 -4.279106e-02  7.279106e-02
1929-06-30  1.300000e-01  1.123641e-01  1.763592e-02
1929-07-31  3.000000e-01  4.561912e-02  2.543809e-01
1929-08-31  2.100000e-01  9.799169e-02  1.120083e-01
1929-09-30  1.600000e-01 -4.888048e-02  2.088805e-01
1929-10-31  1.800000e-01 -1.992706e-01  3.792706e-01
1929-11-30  1.800000e-01 -1.337474e-01  3.137474e-01
1929-12-31  1.800000e-01  2.533461e-02  1.546654e-01
1930-01-31  1.700000e-01  6.247086e-02  1.075291e-01
1930-02-28  1.200000e-01  2.150066e-02  9.849934e-02
1930-03-31  7.000000e-02  7.989691e-02 -9.896907e-03
1930-04-30  5.000000e-02 -9.546539e-03  5.954654e-02
1930-05-31  5.000000e-02 -1.646586e-02  6.646586e-02
1930-06-30  6.000000e-02 -1.645570e-01  2.245570e-01
1930-07-31  1.100000e-01  3.665689e-02  7.334311e-02
1930-08-31  1.500000e-01  7.543612e-03  1.424564e-01
1930-09-30  1.600000e-01 -1.300889e-01  2.900889e-01
1930-10-31  1.600000e-01 -8.875740e-02  2.487574e-01
1930-11-30  1.200000e-01 -2.184179e-02  1.418418e-01
1930-12-31  1.600000e-01 -7.423054e-02  2.342305e-01
1931-01-31            NA  4.889179e-02            NA
1931-02-28 -1.764371e-02  1.143567e-01 -1.320005e-01
1931-03-31  1.083430e-01 -6.915784e-02  1.775008e-01
1931-04-30  3.240983e-02 -9.586579e-02  1.282756e-01
1931-05-31  1.265823e-02 -1.371769e-01  1.498352e-01
1931-06-30 -4.050000e-02  1.390169e-01 -1.795169e-01
1931-07-31  1.250651e-02 -7.417397e-02  8.668049e-02
1931-08-31  7.411220e-02  9.468318e-03  6.464388e-02
1931-09-30  2.395783e-02 -2.994228e-01  3.233806e-01
1931-10-31  1.450632e-02  8.444902e-02 -6.994270e-02
1931-11-30  1.199262e-01 -9.781576e-02  2.177420e-01
1931-12-31  2.883031e-03 -1.452632e-01  1.481462e-01
1932-01-31  5.708419e-02 -2.832512e-02  8.540931e-02
1932-02-29 -5.827506e-03  5.069708e-02 -5.652459e-02
1932-03-31 -2.344666e-03 -1.182147e-01  1.158701e-01
1932-04-30  1.605954e-02 -2.024624e-01  2.185219e-01
1932-05-31 -4.279106e-02 -2.332762e-01  1.904851e-01
1932-06-30  1.123641e-01 -8.948546e-03  1.213126e-01
1932-07-31  4.561912e-02  3.769752e-01 -3.313561e-01
1932-08-31  9.799169e-02  3.754098e-01 -2.774181e-01
1932-09-30 -4.888048e-02 -3.694875e-02 -1.193173e-02
1932-10-31 -1.992706e-01 -1.386139e-01 -6.065670e-02
1932-11-30 -1.337474e-01 -5.890805e-02 -7.483937e-02
1932-12-31  2.533461e-02  5.190840e-02 -2.657379e-02
1933-01-31  6.247086e-02  7.256894e-03  5.521397e-02
1933-02-28  2.150066e-02 -1.844380e-01  2.059387e-01
1933-03-31  7.989691e-02  3.356890e-02  4.632800e-02
1933-04-30 -9.546539e-03  4.222222e-01 -4.317688e-01
  :
  :
  :
2001-09-30  6.406681e-02 -8.074556e-02  1.448124e-01
2001-10-31  8.126906e-02  1.907934e-02  6.218972e-02
2001-11-30  6.058320e-02  7.668909e-02 -1.610589e-02
2001-12-31  5.758811e-02  8.766631e-03  4.882148e-02
2002-01-31  4.180194e-02 -1.458492e-02  5.638686e-02
2002-02-28 -3.106290e-02 -1.928891e-02 -1.177399e-02
2002-03-31  3.999836e-02  3.761344e-02  2.384916e-03
2002-04-30  3.872519e-02 -6.060114e-02  9.932633e-02
2002-05-31 -2.358079e-02 -7.341115e-03 -1.623967e-02
2002-06-30  5.545330e-02 -7.120423e-02  1.266575e-01
2002-07-31 -3.119457e-02 -7.792881e-02  4.673424e-02
2002-08-31 -4.948639e-03  6.546929e-03 -1.149557e-02
2002-09-30 -2.738231e-02 -1.085825e-01  8.120014e-02
2002-10-31  6.325486e-02  8.793250e-02 -2.467764e-02
2002-11-30  2.032765e-02  5.880188e-02 -3.847423e-02
2002-12-31  5.885990e-02 -5.871740e-02  1.175773e-01
2003-01-31 -5.023653e-02 -2.614587e-02 -2.409065e-02
2003-02-28 -1.891104e-02 -1.502581e-02 -3.885236e-03
2003-03-31  9.776745e-02  9.682245e-03  8.808521e-02
2003-04-30 -3.007423e-02  8.233138e-02 -1.124056e-01
2003-05-31 -2.052851e-02  5.263665e-02 -7.316516e-02
2003-06-30  2.465663e-02  1.277463e-02  1.188200e-02
2003-07-31 -1.562116e-02  1.763946e-02 -3.326062e-02
2003-08-31  6.207876e-02  1.946365e-02  4.261511e-02
2003-09-30 -5.278210e-02 -1.058773e-02 -4.219437e-02
2003-10-31 -4.240781e-03  5.654044e-02 -6.078122e-02
2003-11-30 -7.878209e-02  8.787858e-03 -8.756995e-02
2003-12-31  4.905010e-03  5.240762e-02 -4.750261e-02
2004-01-31  3.545729e-02  1.835153e-02  1.710576e-02
2004-02-29 -9.112422e-02  1.389535e-02 -1.050196e-01
2004-03-31 -6.331616e-02 -1.508434e-02 -4.823182e-02
2004-04-30  7.764807e-02 -1.567786e-02  9.332593e-02
2004-05-31  6.710015e-03  1.369499e-02 -6.984975e-03
2004-06-30 -2.433036e-02  1.943932e-02 -4.376967e-02
2004-07-31 -9.849356e-03 -3.314085e-02  2.329149e-02
2004-08-31 -6.253705e-02  4.016675e-03 -6.655372e-02
2004-09-30 -8.074556e-02  1.082333e-02 -9.156889e-02
2004-10-31  1.907934e-02  1.527709e-02  3.802254e-03
2004-11-30  7.668909e-02  4.044818e-02  3.624091e-02
2004-12-31  8.766631e-03  3.401843e-02 -2.525180e-02
2005-01-31 -1.458492e-02 -2.437486e-02  9.789944e-03
2005-02-28 -1.928891e-02  2.103283e-02 -4.032173e-02
2005-03-31  3.761344e-02 -1.768947e-02  5.530291e-02
2005-04-30 -6.060114e-02 -1.895654e-02 -4.164460e-02
2005-05-31 -7.341115e-03  3.179020e-02 -3.913132e-02
2005-06-30 -7.120423e-02  1.433108e-03 -7.263733e-02
2005-07-31 -7.792881e-02  3.717322e-02 -1.151020e-01
2005-08-31  6.546929e-03 -9.129511e-03  1.567644e-02
2005-09-30 -1.085825e-01  8.095481e-03 -1.166779e-01
2005-10-31  8.793250e-02 -1.667949e-02  1.046120e-01
2005-11-30  5.880188e-02  3.778370e-02  2.101818e-02
2005-12-31 -5.871740e-02  3.544358e-04 -5.907184e-02
2006-01-31 -2.614587e-02  2.647700e-02 -5.262287e-02
2006-02-28 -1.502581e-02  2.705295e-03 -1.773110e-02
2006-03-31  9.682245e-03  1.244575e-02 -2.763504e-03
2006-04-30  8.233138e-02  1.341893e-02  6.891245e-02
2006-05-31  5.263665e-02 -2.874538e-02  8.138203e-02
2006-06-30  1.277463e-02  1.327710e-03  1.144692e-02
2006-07-31  1.763946e-02  6.163661e-03  1.147580e-02
2006-08-31  1.946365e-02  2.375707e-02 -4.293421e-03
2006-09-30 -1.058773e-02  2.575373e-02 -3.634146e-02
2006-10-31  5.654044e-02  3.256648e-02  2.397396e-02
2006-11-30  8.787858e-03  1.898470e-02 -1.019684e-02
2006-12-31  5.240762e-02  1.402475e-02  3.838287e-02
2007-01-31  1.835153e-02  1.510802e-02  3.243511e-03
2007-02-28  1.389535e-02 -1.950030e-02  3.339565e-02
2007-03-31 -1.508434e-02  1.115994e-02 -2.624428e-02
2007-04-30 -1.567786e-02  4.428216e-02 -5.996002e-02
2007-05-31  1.369499e-02  3.485995e-02 -2.116496e-02
2007-06-30  1.943932e-02 -1.660254e-02  3.604186e-02
2007-07-31 -3.314085e-02 -3.096746e-02 -2.173394e-03
2007-08-31  4.016675e-03  1.496826e-02 -1.095158e-02
2007-09-30  1.082333e-02  3.735960e-02 -2.653627e-02
2007-10-31  1.527709e-02  1.590409e-02 -6.270021e-04
2007-11-30  4.044818e-02 -4.182397e-02  8.227215e-02
2007-12-31  3.401843e-02 -6.920090e-03  4.093852e-02
2008-01-31 -2.437486e-02 -5.997385e-02  3.559899e-02
2008-02-29  2.103283e-02 -3.245979e-02  5.349262e-02
2008-03-31 -1.768947e-02 -4.327525e-03 -1.336194e-02
2008-04-30 -1.895654e-02  4.869178e-02 -6.764832e-02
2008-05-31  3.179020e-02  1.295084e-02  1.883936e-02
2008-06-30  1.433108e-03 -8.422389e-02  8.565700e-02
2008-07-31  3.717322e-02 -8.409418e-03  4.558264e-02
2008-08-31 -9.129511e-03  1.447345e-02 -2.360296e-02
2008-09-30  8.095481e-03 -8.900728e-02  9.710276e-02
2008-10-31 -1.667949e-02 -1.679282e-01  1.512487e-01
2008-11-30  3.778370e-02 -7.177816e-02  1.095619e-01
2008-12-31  3.544358e-04  1.053659e-02 -1.018215e-02
2009-01-31  2.647700e-02 -8.418612e-02  1.106631e-01
2009-02-28  2.705295e-03 -1.061347e-01  1.088400e-01
2009-03-31  1.244575e-02  8.743881e-02 -7.499306e-02
2009-04-30  1.341893e-02  9.562540e-02 -8.220646e-02
2009-05-31 -2.874538e-02  5.586690e-02 -8.461228e-02
2009-06-30  1.327710e-03  1.997108e-03 -6.693984e-04
2009-07-31  6.163661e-03  7.553988e-02 -6.937622e-02
2009-08-31  2.375707e-02  3.605340e-02 -1.229633e-02
2009-09-30  2.575373e-02  3.728858e-02 -1.153485e-02
2009-10-31  3.256648e-02 -1.855341e-02  5.111988e-02
2009-11-30  1.898470e-02  5.996658e-02 -4.098189e-02
2009-12-31  1.402475e-02  1.930693e-02 -5.282174e-03
2010-01-31  1.510802e-02 -3.591852e-02  5.102654e-02
2010-02-28 -1.950030e-02  3.093380e-02 -5.043410e-02
2010-03-31  1.115994e-02  6.032170e-02 -4.916176e-02
2010-04-30  4.428216e-02  1.579164e-02  2.849052e-02
2010-05-31  3.485995e-02 -7.976831e-02  1.146283e-01
2010-06-30 -1.660254e-02 -5.227779e-02  3.567525e-02
2010-07-31 -3.096746e-02  7.003093e-02 -1.009984e-01
> sum(na.omit(Y[,3]))
[1] 6.994696
>


It is not a problem with merge as illustrated below...
> A.x[,4]
                     Ret
1928-01-31            NA
1928-02-29 -1.764371e-02
1928-03-31  1.083430e-01
1928-04-30  3.240983e-02
1928-05-31  1.265823e-02
1928-06-30 -4.050000e-02
1928-07-31  1.250651e-02
1928-08-31  7.411220e-02
1928-09-30  2.395783e-02
1928-10-31  1.450632e-02
1928-11-30  1.199262e-01
1928-12-31  2.883031e-03
1929-01-31  5.708419e-02
1929-02-28 -5.827506e-03
1929-03-31 -2.344666e-03
1929-04-30  1.605954e-02
1929-05-31 -4.279106e-02
  :
  :
  :
1970-02-28  5.575161e-02
1970-03-31  4.357730e-03
1970-04-30 -8.747074e-02
1970-05-31 -5.777728e-02
1970-06-30 -4.663631e-02
1970-07-31  7.687028e-02
1970-08-31  4.778998e-02
1970-09-30  3.618744e-02
1970-10-31 -8.312546e-03
1970-11-30  5.057046e-02
1970-12-31  5.974776e-02
1971-01-31  4.319049e-02
1971-02-28  1.168123e-02
1971-03-31  3.937983e-02
1971-04-30  3.887935e-02
1971-05-31 -3.905711e-02
1971-06-30  3.312228e-03
1971-07-31 -3.871620e-02
1971-08-31  3.880526e-02
1971-09-30 -4.433059e-03
1971-10-31 -3.914985e-02
1971-11-30  2.120870e-04
1971-12-31  8.883940e-02
1972-01-31  2.057011e-02
1972-02-29  2.770806e-02
1972-03-31  8.257537e-03
1972-04-30  6.809705e-03
  :
  :
  :
2009-03-31  8.743881e-02
2009-04-30  9.562540e-02
2009-05-31  5.586690e-02
2009-06-30  1.997108e-03
2009-07-31  7.553988e-02
2009-08-31  3.605340e-02
2009-09-30  3.728858e-02
2009-10-31 -1.855341e-02
2009-11-30  5.996658e-02
2009-12-31  1.930693e-02
2010-01-31 -3.591852e-02
2010-02-28  3.093380e-02
2010-03-31  6.032170e-02
2010-04-30  1.579164e-02
2010-05-31 -7.976831e-02
2010-06-30 -5.227779e-02
2010-07-31  7.003093e-02

> A.x["1929::2010",4]
                     Ret
1929-01-31  1.720000e+00
1929-02-28  1.130000e+00
1929-03-31  6.700000e-01
1929-04-30  1.900000e-01
1929-05-31  3.000000e-02
1929-06-30  1.300000e-01
1929-07-31  3.000000e-01
1929-08-31  2.100000e-01
1929-09-30  1.600000e-01
1929-10-31  1.800000e-01
1929-11-30  1.800000e-01
1929-12-31  1.800000e-01
1930-01-31  1.700000e-01
1930-02-28  1.200000e-01
1930-03-31  7.000000e-02
1930-04-30  5.000000e-02
1930-05-31  5.000000e-02
1930-06-30  6.000000e-02
1930-07-31  1.100000e-01
  :
  :
  :
2003-03-31  9.776745e-02
2003-04-30 -3.007423e-02
2003-05-31 -2.052851e-02
2003-06-30  2.465663e-02
2003-07-31 -1.562116e-02
2003-08-31  6.207876e-02
2003-09-30 -5.278210e-02
2003-10-31 -4.240781e-03
2003-11-30 -7.878209e-02
2003-12-31  4.905010e-03
2004-01-31  3.545729e-02
2004-02-29 -9.112422e-02
2004-03-31 -6.331616e-02
2004-04-30  7.764807e-02
2004-05-31  6.710015e-03
2004-06-30 -2.433036e-02
2004-07-31 -9.849356e-03
2004-08-31 -6.253705e-02
2004-09-30 -8.074556e-02
2004-10-31  1.907934e-02
2004-11-30  7.668909e-02
2004-12-31  8.766631e-03
2005-01-31 -1.458492e-02
2005-02-28 -1.928891e-02
2005-03-31  3.761344e-02
2005-04-30 -6.060114e-02
2005-05-31 -7.341115e-03
2005-06-30 -7.120423e-02
2005-07-31 -7.792881e-02
2005-08-31  6.546929e-03
2005-09-30 -1.085825e-01
2005-10-31  8.793250e-02
2005-11-30  5.880188e-02
2005-12-31 -5.871740e-02
2006-01-31 -2.614587e-02
2006-02-28 -1.502581e-02
2006-03-31  9.682245e-03
2006-04-30  8.233138e-02
2006-05-31  5.263665e-02
2006-06-30  1.277463e-02
2006-07-31  1.763946e-02
2006-08-31  1.946365e-02
2006-09-30 -1.058773e-02
2006-10-31  5.654044e-02
2006-11-30  8.787858e-03
2006-12-31  5.240762e-02
2007-01-31  1.835153e-02
2007-02-28  1.389535e-02
2007-03-31 -1.508434e-02
2007-04-30 -1.567786e-02
2007-05-31  1.369499e-02
2007-06-30  1.943932e-02
2007-07-31 -3.314085e-02
2007-08-31  4.016675e-03
2007-09-30  1.082333e-02
2007-10-31  1.527709e-02
2007-11-30  4.044818e-02
2007-12-31  3.401843e-02
2008-01-31 -2.437486e-02
2008-02-29  2.103283e-02
2008-03-31 -1.768947e-02
2008-04-30 -1.895654e-02
2008-05-31  3.179020e-02
2008-06-30  1.433108e-03
2008-07-31  3.717322e-02
2008-08-31 -9.129511e-03
2008-09-30  8.095481e-03
2008-10-31 -1.667949e-02
2008-11-30  3.778370e-02
2008-12-31  3.544358e-04
2009-01-31  2.647700e-02
2009-02-28  2.705295e-03
2009-03-31  1.244575e-02
2009-04-30  1.341893e-02
2009-05-31 -2.874538e-02
2009-06-30  1.327710e-03
2009-07-31  6.163661e-03
2009-08-31  2.375707e-02
2009-09-30  2.575373e-02
2009-10-31  3.256648e-02
2009-11-30  1.898470e-02
2009-12-31  1.402475e-02
2010-01-31  1.510802e-02
2010-02-28 -1.950030e-02
2010-03-31  1.115994e-02
2010-04-30  4.428216e-02
2010-05-31  3.485995e-02
2010-06-30 -1.660254e-02
2010-07-31 -3.096746e-02

-- 
Dig it out of the ground
Melt it down
Bury it
Guard it


From jeff.a.ryan at gmail.com  Wed Feb 23 05:31:50 2011
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 22 Feb 2011 22:31:50 -0600
Subject: [R-SIG-Finance] Strange troubles with sub-setting xts
In-Reply-To: <AANLkTikueAuYD6EbWRbdiYGHJFWTrtNgwfZzbkQXBqdg@mail.gmail.com>
References: <AANLkTikueAuYD6EbWRbdiYGHJFWTrtNgwfZzbkQXBqdg@mail.gmail.com>
Message-ID: <BFBDC7FF-ED87-4C7E-AA96-0C3F9C45EDEA@gmail.com>

It's likely you caught one of the interim xts R-Forge releases with a (known) bug in subsetting. 

The sessionInfo() call would show you the version in question, but the answer/fix is to update to either the latest on R-forge, or the new version 0.8-0 making its way to CRAN mirrors now. 

Best,
Jeff




On Feb 22, 2011, at 9:01 PM, Worik Stanton <worik.stanton at gmail.com> wrote:

> I cannot get a small example to illustrate this, as the problem
> disappears in strange ways.  So this email will have a lot of text.
> 
> I do not know how to get xts version but here is the R version
> 
>> R.version
>              _
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status
> major          2
> minor          11.1
> year           2010
> month          05
> day            31
> svn rev        52157
> language       R
> version.string R version 2.11.1 (2010-05-31)
> 
> 
> I have a xts caled A.x
> 
>> class(A.x)
> [1] "xts" "zoo"
>> names(A.x)
> [1] "Lev"   "200MA" "RF"    "Ret"
>>> c(start(A.x), end(A.x))
> [1] "1928-01-31" "2010-07-31"
>> 
> 
> (It is a processed version of S&P500 monthly index)
> 
> When I subset A.x by date the 4th column (Ret) gets mangled.
> 
> Below are screeds of data, sorry, but if I shrink these the problem disappears.
> 
> cheers
> Worik
> 
>> Z <- merge(A.x["1929::2010",4], A.x[,4])
>> Y <- merge(Z, Z[,1]-Z[,2])
>> Y
> 1928-01-31            NA            NA            NA
> 1928-02-29            NA -1.764371e-02            NA
> 1928-03-31            NA  1.083430e-01            NA
> 1928-04-30            NA  3.240983e-02            NA
> 1928-05-31            NA  1.265823e-02            NA
> 1928-06-30            NA -4.050000e-02            NA
> 1928-07-31            NA  1.250651e-02            NA
> 1928-08-31            NA  7.411220e-02            NA
> 1928-09-30            NA  2.395783e-02            NA
> 1928-10-31            NA  1.450632e-02            NA
> 1928-11-30            NA  1.199262e-01            NA
> 1928-12-31            NA  2.883031e-03            NA
> 1929-01-31  1.720000e+00  5.708419e-02  1.662916e+00
> 1929-02-28  1.130000e+00 -5.827506e-03  1.135828e+00
> 1929-03-31  6.700000e-01 -2.344666e-03  6.723447e-01
> 1929-04-30  1.900000e-01  1.605954e-02  1.739405e-01
> 1929-05-31  3.000000e-02 -4.279106e-02  7.279106e-02
> 1929-06-30  1.300000e-01  1.123641e-01  1.763592e-02
> 1929-07-31  3.000000e-01  4.561912e-02  2.543809e-01
> 1929-08-31  2.100000e-01  9.799169e-02  1.120083e-01
> 1929-09-30  1.600000e-01 -4.888048e-02  2.088805e-01
> 1929-10-31  1.800000e-01 -1.992706e-01  3.792706e-01
> 1929-11-30  1.800000e-01 -1.337474e-01  3.137474e-01
> 1929-12-31  1.800000e-01  2.533461e-02  1.546654e-01
> 1930-01-31  1.700000e-01  6.247086e-02  1.075291e-01
> 1930-02-28  1.200000e-01  2.150066e-02  9.849934e-02
> 1930-03-31  7.000000e-02  7.989691e-02 -9.896907e-03
> 1930-04-30  5.000000e-02 -9.546539e-03  5.954654e-02
> 1930-05-31  5.000000e-02 -1.646586e-02  6.646586e-02
> 1930-06-30  6.000000e-02 -1.645570e-01  2.245570e-01
> 1930-07-31  1.100000e-01  3.665689e-02  7.334311e-02
> 1930-08-31  1.500000e-01  7.543612e-03  1.424564e-01
> 1930-09-30  1.600000e-01 -1.300889e-01  2.900889e-01
> 1930-10-31  1.600000e-01 -8.875740e-02  2.487574e-01
> 1930-11-30  1.200000e-01 -2.184179e-02  1.418418e-01
> 1930-12-31  1.600000e-01 -7.423054e-02  2.342305e-01
> 1931-01-31            NA  4.889179e-02            NA
> 1931-02-28 -1.764371e-02  1.143567e-01 -1.320005e-01
> 1931-03-31  1.083430e-01 -6.915784e-02  1.775008e-01
> 1931-04-30  3.240983e-02 -9.586579e-02  1.282756e-01
> 1931-05-31  1.265823e-02 -1.371769e-01  1.498352e-01
> 1931-06-30 -4.050000e-02  1.390169e-01 -1.795169e-01
> 1931-07-31  1.250651e-02 -7.417397e-02  8.668049e-02
> 1931-08-31  7.411220e-02  9.468318e-03  6.464388e-02
> 1931-09-30  2.395783e-02 -2.994228e-01  3.233806e-01
> 1931-10-31  1.450632e-02  8.444902e-02 -6.994270e-02
> 1931-11-30  1.199262e-01 -9.781576e-02  2.177420e-01
> 1931-12-31  2.883031e-03 -1.452632e-01  1.481462e-01
> 1932-01-31  5.708419e-02 -2.832512e-02  8.540931e-02
> 1932-02-29 -5.827506e-03  5.069708e-02 -5.652459e-02
> 1932-03-31 -2.344666e-03 -1.182147e-01  1.158701e-01
> 1932-04-30  1.605954e-02 -2.024624e-01  2.185219e-01
> 1932-05-31 -4.279106e-02 -2.332762e-01  1.904851e-01
> 1932-06-30  1.123641e-01 -8.948546e-03  1.213126e-01
> 1932-07-31  4.561912e-02  3.769752e-01 -3.313561e-01
> 1932-08-31  9.799169e-02  3.754098e-01 -2.774181e-01
> 1932-09-30 -4.888048e-02 -3.694875e-02 -1.193173e-02
> 1932-10-31 -1.992706e-01 -1.386139e-01 -6.065670e-02
> 1932-11-30 -1.337474e-01 -5.890805e-02 -7.483937e-02
> 1932-12-31  2.533461e-02  5.190840e-02 -2.657379e-02
> 1933-01-31  6.247086e-02  7.256894e-03  5.521397e-02
> 1933-02-28  2.150066e-02 -1.844380e-01  2.059387e-01
> 1933-03-31  7.989691e-02  3.356890e-02  4.632800e-02
> 1933-04-30 -9.546539e-03  4.222222e-01 -4.317688e-01
> :
> :
> :
> 2001-09-30  6.406681e-02 -8.074556e-02  1.448124e-01
> 2001-10-31  8.126906e-02  1.907934e-02  6.218972e-02
> 2001-11-30  6.058320e-02  7.668909e-02 -1.610589e-02
> 2001-12-31  5.758811e-02  8.766631e-03  4.882148e-02
> 2002-01-31  4.180194e-02 -1.458492e-02  5.638686e-02
> 2002-02-28 -3.106290e-02 -1.928891e-02 -1.177399e-02
> 2002-03-31  3.999836e-02  3.761344e-02  2.384916e-03
> 2002-04-30  3.872519e-02 -6.060114e-02  9.932633e-02
> 2002-05-31 -2.358079e-02 -7.341115e-03 -1.623967e-02
> 2002-06-30  5.545330e-02 -7.120423e-02  1.266575e-01
> 2002-07-31 -3.119457e-02 -7.792881e-02  4.673424e-02
> 2002-08-31 -4.948639e-03  6.546929e-03 -1.149557e-02
> 2002-09-30 -2.738231e-02 -1.085825e-01  8.120014e-02
> 2002-10-31  6.325486e-02  8.793250e-02 -2.467764e-02
> 2002-11-30  2.032765e-02  5.880188e-02 -3.847423e-02
> 2002-12-31  5.885990e-02 -5.871740e-02  1.175773e-01
> 2003-01-31 -5.023653e-02 -2.614587e-02 -2.409065e-02
> 2003-02-28 -1.891104e-02 -1.502581e-02 -3.885236e-03
> 2003-03-31  9.776745e-02  9.682245e-03  8.808521e-02
> 2003-04-30 -3.007423e-02  8.233138e-02 -1.124056e-01
> 2003-05-31 -2.052851e-02  5.263665e-02 -7.316516e-02
> 2003-06-30  2.465663e-02  1.277463e-02  1.188200e-02
> 2003-07-31 -1.562116e-02  1.763946e-02 -3.326062e-02
> 2003-08-31  6.207876e-02  1.946365e-02  4.261511e-02
> 2003-09-30 -5.278210e-02 -1.058773e-02 -4.219437e-02
> 2003-10-31 -4.240781e-03  5.654044e-02 -6.078122e-02
> 2003-11-30 -7.878209e-02  8.787858e-03 -8.756995e-02
> 2003-12-31  4.905010e-03  5.240762e-02 -4.750261e-02
> 2004-01-31  3.545729e-02  1.835153e-02  1.710576e-02
> 2004-02-29 -9.112422e-02  1.389535e-02 -1.050196e-01
> 2004-03-31 -6.331616e-02 -1.508434e-02 -4.823182e-02
> 2004-04-30  7.764807e-02 -1.567786e-02  9.332593e-02
> 2004-05-31  6.710015e-03  1.369499e-02 -6.984975e-03
> 2004-06-30 -2.433036e-02  1.943932e-02 -4.376967e-02
> 2004-07-31 -9.849356e-03 -3.314085e-02  2.329149e-02
> 2004-08-31 -6.253705e-02  4.016675e-03 -6.655372e-02
> 2004-09-30 -8.074556e-02  1.082333e-02 -9.156889e-02
> 2004-10-31  1.907934e-02  1.527709e-02  3.802254e-03
> 2004-11-30  7.668909e-02  4.044818e-02  3.624091e-02
> 2004-12-31  8.766631e-03  3.401843e-02 -2.525180e-02
> 2005-01-31 -1.458492e-02 -2.437486e-02  9.789944e-03
> 2005-02-28 -1.928891e-02  2.103283e-02 -4.032173e-02
> 2005-03-31  3.761344e-02 -1.768947e-02  5.530291e-02
> 2005-04-30 -6.060114e-02 -1.895654e-02 -4.164460e-02
> 2005-05-31 -7.341115e-03  3.179020e-02 -3.913132e-02
> 2005-06-30 -7.120423e-02  1.433108e-03 -7.263733e-02
> 2005-07-31 -7.792881e-02  3.717322e-02 -1.151020e-01
> 2005-08-31  6.546929e-03 -9.129511e-03  1.567644e-02
> 2005-09-30 -1.085825e-01  8.095481e-03 -1.166779e-01
> 2005-10-31  8.793250e-02 -1.667949e-02  1.046120e-01
> 2005-11-30  5.880188e-02  3.778370e-02  2.101818e-02
> 2005-12-31 -5.871740e-02  3.544358e-04 -5.907184e-02
> 2006-01-31 -2.614587e-02  2.647700e-02 -5.262287e-02
> 2006-02-28 -1.502581e-02  2.705295e-03 -1.773110e-02
> 2006-03-31  9.682245e-03  1.244575e-02 -2.763504e-03
> 2006-04-30  8.233138e-02  1.341893e-02  6.891245e-02
> 2006-05-31  5.263665e-02 -2.874538e-02  8.138203e-02
> 2006-06-30  1.277463e-02  1.327710e-03  1.144692e-02
> 2006-07-31  1.763946e-02  6.163661e-03  1.147580e-02
> 2006-08-31  1.946365e-02  2.375707e-02 -4.293421e-03
> 2006-09-30 -1.058773e-02  2.575373e-02 -3.634146e-02
> 2006-10-31  5.654044e-02  3.256648e-02  2.397396e-02
> 2006-11-30  8.787858e-03  1.898470e-02 -1.019684e-02
> 2006-12-31  5.240762e-02  1.402475e-02  3.838287e-02
> 2007-01-31  1.835153e-02  1.510802e-02  3.243511e-03
> 2007-02-28  1.389535e-02 -1.950030e-02  3.339565e-02
> 2007-03-31 -1.508434e-02  1.115994e-02 -2.624428e-02
> 2007-04-30 -1.567786e-02  4.428216e-02 -5.996002e-02
> 2007-05-31  1.369499e-02  3.485995e-02 -2.116496e-02
> 2007-06-30  1.943932e-02 -1.660254e-02  3.604186e-02
> 2007-07-31 -3.314085e-02 -3.096746e-02 -2.173394e-03
> 2007-08-31  4.016675e-03  1.496826e-02 -1.095158e-02
> 2007-09-30  1.082333e-02  3.735960e-02 -2.653627e-02
> 2007-10-31  1.527709e-02  1.590409e-02 -6.270021e-04
> 2007-11-30  4.044818e-02 -4.182397e-02  8.227215e-02
> 2007-12-31  3.401843e-02 -6.920090e-03  4.093852e-02
> 2008-01-31 -2.437486e-02 -5.997385e-02  3.559899e-02
> 2008-02-29  2.103283e-02 -3.245979e-02  5.349262e-02
> 2008-03-31 -1.768947e-02 -4.327525e-03 -1.336194e-02
> 2008-04-30 -1.895654e-02  4.869178e-02 -6.764832e-02
> 2008-05-31  3.179020e-02  1.295084e-02  1.883936e-02
> 2008-06-30  1.433108e-03 -8.422389e-02  8.565700e-02
> 2008-07-31  3.717322e-02 -8.409418e-03  4.558264e-02
> 2008-08-31 -9.129511e-03  1.447345e-02 -2.360296e-02
> 2008-09-30  8.095481e-03 -8.900728e-02  9.710276e-02
> 2008-10-31 -1.667949e-02 -1.679282e-01  1.512487e-01
> 2008-11-30  3.778370e-02 -7.177816e-02  1.095619e-01
> 2008-12-31  3.544358e-04  1.053659e-02 -1.018215e-02
> 2009-01-31  2.647700e-02 -8.418612e-02  1.106631e-01
> 2009-02-28  2.705295e-03 -1.061347e-01  1.088400e-01
> 2009-03-31  1.244575e-02  8.743881e-02 -7.499306e-02
> 2009-04-30  1.341893e-02  9.562540e-02 -8.220646e-02
> 2009-05-31 -2.874538e-02  5.586690e-02 -8.461228e-02
> 2009-06-30  1.327710e-03  1.997108e-03 -6.693984e-04
> 2009-07-31  6.163661e-03  7.553988e-02 -6.937622e-02
> 2009-08-31  2.375707e-02  3.605340e-02 -1.229633e-02
> 2009-09-30  2.575373e-02  3.728858e-02 -1.153485e-02
> 2009-10-31  3.256648e-02 -1.855341e-02  5.111988e-02
> 2009-11-30  1.898470e-02  5.996658e-02 -4.098189e-02
> 2009-12-31  1.402475e-02  1.930693e-02 -5.282174e-03
> 2010-01-31  1.510802e-02 -3.591852e-02  5.102654e-02
> 2010-02-28 -1.950030e-02  3.093380e-02 -5.043410e-02
> 2010-03-31  1.115994e-02  6.032170e-02 -4.916176e-02
> 2010-04-30  4.428216e-02  1.579164e-02  2.849052e-02
> 2010-05-31  3.485995e-02 -7.976831e-02  1.146283e-01
> 2010-06-30 -1.660254e-02 -5.227779e-02  3.567525e-02
> 2010-07-31 -3.096746e-02  7.003093e-02 -1.009984e-01
>> sum(na.omit(Y[,3]))
> [1] 6.994696
>> 
> 
> 
> It is not a problem with merge as illustrated below...
>> A.x[,4]
>                    Ret
> 1928-01-31            NA
> 1928-02-29 -1.764371e-02
> 1928-03-31  1.083430e-01
> 1928-04-30  3.240983e-02
> 1928-05-31  1.265823e-02
> 1928-06-30 -4.050000e-02
> 1928-07-31  1.250651e-02
> 1928-08-31  7.411220e-02
> 1928-09-30  2.395783e-02
> 1928-10-31  1.450632e-02
> 1928-11-30  1.199262e-01
> 1928-12-31  2.883031e-03
> 1929-01-31  5.708419e-02
> 1929-02-28 -5.827506e-03
> 1929-03-31 -2.344666e-03
> 1929-04-30  1.605954e-02
> 1929-05-31 -4.279106e-02
> :
> :
> :
> 1970-02-28  5.575161e-02
> 1970-03-31  4.357730e-03
> 1970-04-30 -8.747074e-02
> 1970-05-31 -5.777728e-02
> 1970-06-30 -4.663631e-02
> 1970-07-31  7.687028e-02
> 1970-08-31  4.778998e-02
> 1970-09-30  3.618744e-02
> 1970-10-31 -8.312546e-03
> 1970-11-30  5.057046e-02
> 1970-12-31  5.974776e-02
> 1971-01-31  4.319049e-02
> 1971-02-28  1.168123e-02
> 1971-03-31  3.937983e-02
> 1971-04-30  3.887935e-02
> 1971-05-31 -3.905711e-02
> 1971-06-30  3.312228e-03
> 1971-07-31 -3.871620e-02
> 1971-08-31  3.880526e-02
> 1971-09-30 -4.433059e-03
> 1971-10-31 -3.914985e-02
> 1971-11-30  2.120870e-04
> 1971-12-31  8.883940e-02
> 1972-01-31  2.057011e-02
> 1972-02-29  2.770806e-02
> 1972-03-31  8.257537e-03
> 1972-04-30  6.809705e-03
> :
> :
> :
> 2009-03-31  8.743881e-02
> 2009-04-30  9.562540e-02
> 2009-05-31  5.586690e-02
> 2009-06-30  1.997108e-03
> 2009-07-31  7.553988e-02
> 2009-08-31  3.605340e-02
> 2009-09-30  3.728858e-02
> 2009-10-31 -1.855341e-02
> 2009-11-30  5.996658e-02
> 2009-12-31  1.930693e-02
> 2010-01-31 -3.591852e-02
> 2010-02-28  3.093380e-02
> 2010-03-31  6.032170e-02
> 2010-04-30  1.579164e-02
> 2010-05-31 -7.976831e-02
> 2010-06-30 -5.227779e-02
> 2010-07-31  7.003093e-02
> 
>> A.x["1929::2010",4]
>                    Ret
> 1929-01-31  1.720000e+00
> 1929-02-28  1.130000e+00
> 1929-03-31  6.700000e-01
> 1929-04-30  1.900000e-01
> 1929-05-31  3.000000e-02
> 1929-06-30  1.300000e-01
> 1929-07-31  3.000000e-01
> 1929-08-31  2.100000e-01
> 1929-09-30  1.600000e-01
> 1929-10-31  1.800000e-01
> 1929-11-30  1.800000e-01
> 1929-12-31  1.800000e-01
> 1930-01-31  1.700000e-01
> 1930-02-28  1.200000e-01
> 1930-03-31  7.000000e-02
> 1930-04-30  5.000000e-02
> 1930-05-31  5.000000e-02
> 1930-06-30  6.000000e-02
> 1930-07-31  1.100000e-01
> :
> :
> :
> 2003-03-31  9.776745e-02
> 2003-04-30 -3.007423e-02
> 2003-05-31 -2.052851e-02
> 2003-06-30  2.465663e-02
> 2003-07-31 -1.562116e-02
> 2003-08-31  6.207876e-02
> 2003-09-30 -5.278210e-02
> 2003-10-31 -4.240781e-03
> 2003-11-30 -7.878209e-02
> 2003-12-31  4.905010e-03
> 2004-01-31  3.545729e-02
> 2004-02-29 -9.112422e-02
> 2004-03-31 -6.331616e-02
> 2004-04-30  7.764807e-02
> 2004-05-31  6.710015e-03
> 2004-06-30 -2.433036e-02
> 2004-07-31 -9.849356e-03
> 2004-08-31 -6.253705e-02
> 2004-09-30 -8.074556e-02
> 2004-10-31  1.907934e-02
> 2004-11-30  7.668909e-02
> 2004-12-31  8.766631e-03
> 2005-01-31 -1.458492e-02
> 2005-02-28 -1.928891e-02
> 2005-03-31  3.761344e-02
> 2005-04-30 -6.060114e-02
> 2005-05-31 -7.341115e-03
> 2005-06-30 -7.120423e-02
> 2005-07-31 -7.792881e-02
> 2005-08-31  6.546929e-03
> 2005-09-30 -1.085825e-01
> 2005-10-31  8.793250e-02
> 2005-11-30  5.880188e-02
> 2005-12-31 -5.871740e-02
> 2006-01-31 -2.614587e-02
> 2006-02-28 -1.502581e-02
> 2006-03-31  9.682245e-03
> 2006-04-30  8.233138e-02
> 2006-05-31  5.263665e-02
> 2006-06-30  1.277463e-02
> 2006-07-31  1.763946e-02
> 2006-08-31  1.946365e-02
> 2006-09-30 -1.058773e-02
> 2006-10-31  5.654044e-02
> 2006-11-30  8.787858e-03
> 2006-12-31  5.240762e-02
> 2007-01-31  1.835153e-02
> 2007-02-28  1.389535e-02
> 2007-03-31 -1.508434e-02
> 2007-04-30 -1.567786e-02
> 2007-05-31  1.369499e-02
> 2007-06-30  1.943932e-02
> 2007-07-31 -3.314085e-02
> 2007-08-31  4.016675e-03
> 2007-09-30  1.082333e-02
> 2007-10-31  1.527709e-02
> 2007-11-30  4.044818e-02
> 2007-12-31  3.401843e-02
> 2008-01-31 -2.437486e-02
> 2008-02-29  2.103283e-02
> 2008-03-31 -1.768947e-02
> 2008-04-30 -1.895654e-02
> 2008-05-31  3.179020e-02
> 2008-06-30  1.433108e-03
> 2008-07-31  3.717322e-02
> 2008-08-31 -9.129511e-03
> 2008-09-30  8.095481e-03
> 2008-10-31 -1.667949e-02
> 2008-11-30  3.778370e-02
> 2008-12-31  3.544358e-04
> 2009-01-31  2.647700e-02
> 2009-02-28  2.705295e-03
> 2009-03-31  1.244575e-02
> 2009-04-30  1.341893e-02
> 2009-05-31 -2.874538e-02
> 2009-06-30  1.327710e-03
> 2009-07-31  6.163661e-03
> 2009-08-31  2.375707e-02
> 2009-09-30  2.575373e-02
> 2009-10-31  3.256648e-02
> 2009-11-30  1.898470e-02
> 2009-12-31  1.402475e-02
> 2010-01-31  1.510802e-02
> 2010-02-28 -1.950030e-02
> 2010-03-31  1.115994e-02
> 2010-04-30  4.428216e-02
> 2010-05-31  3.485995e-02
> 2010-06-30 -1.660254e-02
> 2010-07-31 -3.096746e-02
> 
> -- 
> Dig it out of the ground
> Melt it down
> Bury it
> Guard it
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From nelson.ana at gmail.com  Wed Feb 23 10:50:36 2011
From: nelson.ana at gmail.com (Ana Nelson)
Date: Wed, 23 Feb 2011 09:50:36 +0000
Subject: [R-SIG-Finance] RBloomberg and Bloomberg API 3.4.1.3
Message-ID: <AANLkTimFrki-H9ynOzFOOnB5M6srj-3TkrMNy=1Fg1DU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110223/f7d0c589/attachment.pl>

From minkymorgan at gmail.com  Thu Feb 24 01:32:53 2011
From: minkymorgan at gmail.com (andrew morgan)
Date: Thu, 24 Feb 2011 00:32:53 +0000
Subject: [R-SIG-Finance]  runMax and DonchianChannel()
Message-ID: <AANLkTin9Uw2Fk6Z9POvJ01qdQ=ujWM7PV6YGVHTgt3L+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110224/c28a0005/attachment.pl>

From stephen at organicfoodmarkets.com.au  Thu Feb 24 10:31:26 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 24 Feb 2011 20:31:26 +1100
Subject: [R-SIG-Finance] quantstrat - stop loss and stop trailing:
In-Reply-To: <4D63CBD8.5010805@braverock.com>
References: <4D6370F7.1070609@organicfoodmarkets.com.au>
	<4D63CBD8.5010805@braverock.com>
Message-ID: <4D66256E.2070606@organicfoodmarkets.com.au>

Hi and thanks.

  I had noticed these but I am having difficulty in understand the 
'mechanics'.

  I notice the column names in mktdata are:

AAPL.Open 	AAPL.High 	AAPL.Low 	AAPL.Close 	AAPL.Volume 	AAPL.Adjusted 
macd 	signal 	signal.gt.zero 	signal.lt.zero


when I have stoplimit live.     I can see where everything but 'signal' 
comes from.  Can anyone advise what puts it there ?  I was guessing 
add.signal calls did this.

macd.R attached

Stephen Choularton Ph.D., FIoD

On 23/02/2011 1:44 AM, Brian G. Peterson wrote:
> On 02/22/2011 02:16 AM, Stephen Choularton wrote:
>> Hi
>>
>> Can anyone point me to examples of using stop loss and stop trailing
>> with maCross?
>>
>
> There are examples of both 'stoplimit' and 'stoptrailing' orders in 
> the 'macd' demo.
>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: macd.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110224/d46980fb/attachment.pl>

From johannes.lips at googlemail.com  Thu Feb 24 11:45:44 2011
From: johannes.lips at googlemail.com (Johannes Lips)
Date: Thu, 24 Feb 2011 11:45:44 +0100
Subject: [R-SIG-Finance] Estimation of an GARCH model with conditional
	skewness and kurtosis
In-Reply-To: <4D5B6D43.8010504@googlemail.com>
References: <4D5B6D43.8010504@googlemail.com>
Message-ID: <AANLkTimANa08hjD=LfFW4f-Hd2TRsc3d1urxQ0-n1MgP@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110224/20803102/attachment.pl>

From mane.desk at googlemail.com  Sat Feb 26 13:50:27 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Sat, 26 Feb 2011 13:50:27 +0100
Subject: [R-SIG-Finance] blotter update MM & weights without recalculation
	all
Message-ID: <4D68F713.8060904@gmail.com>

Hello all,

I just had a first glimpse at the blotter package and
found it quite amazing. The demos are great to understand
the basic principles but it would be great I some of the experts
could give me advice on how to approach the following.


1) use blotter to run one trading system on differed symbols
2) use P/L per trade to calculate optimal position size per symbol
3) rerun blotter with optimal position size.
4) use returns per symbol, to calculate weights for each symbol
(Markowitz on trading system equity curves)
5) rerun blotter using weights to calculate portfolio return.

The steps I'm not sure how to accomplish are:

3) do I need to run the whole trade creation process again, or can
I somehow update the trade records to the new position size rules
5) I don't know how to do that at all

any advice is very much appreciated!

regards,
Immanuel


From brian at braverock.com  Sat Feb 26 14:15:32 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 26 Feb 2011 07:15:32 -0600
Subject: [R-SIG-Finance] blotter update MM & weights without
 recalculation all
In-Reply-To: <4D68F713.8060904@gmail.com>
References: <4D68F713.8060904@gmail.com>
Message-ID: <4D68FCF4.9020206@braverock.com>

On 02/26/2011 06:50 AM, Immanuel wrote:
> Hello all,
>
> I just had a first glimpse at the blotter package and
> found it quite amazing. The demos are great to understand
> the basic principles but it would be great I some of the experts
> could give me advice on how to approach the following.

Note that blotter is designed to be used for trade P&L, it is really 
just a trade blotter.  Strategy creation is outside the scope of the 
blotter package.  The demos are there to demonstrate how it can be used, 
but this isn't the way I would recommend building strategies.

We are aware that some users of the package are taking trades from other 
scripts or systems and using blotter for P&L.  This makes sense, and is 
in line with its intended purpose.  I do not use blotter for strategy 
development, and hide it behind a real strategy framework. The package 
we wrote to be 'in front' of blotter for strategy testing is 
'quantstrat'. Other approaches are possible, of course, but I use 
quantstrat 'at the office', and my personal development effort in this 
direction is focused here.


> 1) use blotter to run one trading system on differed symbols
> 2) use P/L per trade to calculate optimal position size per symbol

Aren't 2> and 5> trying to accomplish the same thing?  See below.

> 3) rerun blotter with optimal position size.
> 4) use returns per symbol, to calculate weights for each symbol
> (Markowitz on trading system equity curves)
> 5) rerun blotter using weights to calculate portfolio return.
>
> The steps I'm not sure how to accomplish are:
>
> 3) do I need to run the whole trade creation process again, or can
> I somehow update the trade records to the new position size rules

You should probably run the trade creation process again.  Per the 
documentation, blotter does not allow trades to be entered out of order, 
or to be modified after the fact.  updatePortf and updateAcct may be run 
multiple times, but they throw out all prior calculations.

You can likely improve performance if you keep indicators and signals 
that would be invariant to position sizing. So think about how to 
separate that part from the rest.

> 5) I don't know how to do that at all

blotter is a transaction/P&L based framework, not a weights/returns 
framework. (there are several other packages for that in R)

You can extract returns from blotter that will be return on account 
equity.  These may be used as inputs for a more traditional returns 
based portfolio optimization.

Typically, I will backtest strategies on 'one lots', the smallest unit 
that may be reasonably bought/sold in a given 'product' (this term is 
intentionally loose, and may include synthetics).  Another approach 
which has merit is to backtest a 'neutral allocation' where all 
positions taken across products have the same notional size.  When 
converted to returns, this would create an 'equal weight' portfolio.

Now that you have returns from the 'equal weight' portfolio, you can 
apply traditional portfolio optimization. For example, with twenty 
products, each product in the equal weight portfolio would have a 
portfolio weight of 5%.  If the optimization suggests an ideal weight of 
20%, you would take your equal weight position sizing and make it four 
times larger.

I'll note that Markowitz optimization is not likely what you want.  It 
will penalize positive skew and a long right tail on the distribution, 
which are precisely the features you would want to emphasize in a 
portfolio of trading strategies or products traded in a single strategy.

> any advice is very much appreciated!

Hope this helps,

    - Brian


From mane.desk at googlemail.com  Sat Feb 26 18:03:03 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Sat, 26 Feb 2011 18:03:03 +0100
Subject: [R-SIG-Finance] quantstrat example stragey error
Message-ID: <4D693247.9040908@gmail.com>

Hello all,

I just run the examples from the quantstrat package and
received following error for every example:
----------
[1] "2007-02-26 IBM 100 @ 96.91"
Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
timestamp) ==  :
  argument is of length zero
In addition: Warning messages:
1: In max(i) : no non-missing arguments to max; returning -Inf
2: In `[.xts`(PosData, index(PosData) < Date) :
  Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
[1] "strat execution time:"
Time difference of 0.2813089 secs
[1] "updatePortf execution time:"
Time difference of 0.2385919 secs
Warning message:
In max(i) : no non-missing arguments to max; returning -Inf
----------

any ideas?

thanks,
Immanuel


From brian at braverock.com  Sat Feb 26 18:07:22 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 26 Feb 2011 11:07:22 -0600
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D693247.9040908@gmail.com>
References: <4D693247.9040908@gmail.com>
Message-ID: <4D69334A.7000306@braverock.com>

On 02/26/2011 11:03 AM, Immanuel wrote:
> I just run the examples from the quantstrat package and
> received following error for every example:
> ----------
<...>

> 2: In `[.xts`(PosData, index(PosData)<  Date) :
>    Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"

> any ideas?

Try upgrading xts to the latest version (0.8) from R-Forge or CRAN


From mane.desk at googlemail.com  Sat Feb 26 19:34:23 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Sat, 26 Feb 2011 19:34:23 +0100
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D69334A.7000306@braverock.com>
References: <4D693247.9040908@gmail.com> <4D69334A.7000306@braverock.com>
Message-ID: <4D6947AF.6030807@gmail.com>

hello,
seems to be already installed:
----------
[1] "2001-06-26 AAPL 100 @ 11.88"
Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
timestamp) ==  :
  argument is of length zero
In addition: Warning messages:
1: In match.names(columns, colnames(data)) :
  all columns not located in ma50 ma200 for AAPL.Open AAPL.High AAPL.Low
AAPL.Close AAPL.Volume AAPL.Adjusted ma50 ma200 ma50.gt.ma200
2: In max(i) : no non-missing arguments to max; returning -Inf
3: In `[.xts`(PosData, index(PosData) < Date) :
  Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
Time difference of 0.387223 secs
[1] "trade blotter portfolio update:"
Time difference of 0.7028229 secs
Warning message:
In max(i) : no non-missing arguments to max; returning -Inf
> sessionInfo()
R version 2.12.1 (2010-12-16)
Platform: i486-pc-linux-gnu (32-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C                
 [3] LC_TIME=en_US.UTF-8           LC_COLLATE=en_US.UTF-8      
 [5] LC_MONETARY=en_US.UTF-8       LC_MESSAGES=en_US.UTF-8     
 [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8         
 [9] LC_ADDRESS=en_US.UTF-8        LC_TELEPHONE=en_US.UTF-8    
[11] LC_MEASUREMENT=en_US.UTF-8    LC_IDENTIFICATION=en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    

other attached packages:
[1] quantstrat_0.4.0        blotter_0.8             FinancialInstrument_0.4
[4] quantmod_0.3-15         Defaults_1.1-1          TTR_0.20-2            
[7] xts_0.8-0               zoo_1.6-4               rj_0.5.0-5            

loaded via a namespace (and not attached):
[1] grid_2.12.1     lattice_0.19-17 rJava_0.8-7     tools_2.12.1  
------------------

On 02/26/2011 06:07 PM, Brian G. Peterson wrote:
> On 02/26/2011 11:03 AM, Immanuel wrote:
>> I just run the examples from the quantstrat package and
>> received following error for every example:
>> ----------
> <...>
>
>> 2: In `[.xts`(PosData, index(PosData)<  Date) :
>>    Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>
>> any ideas?
>
> Try upgrading xts to the latest version (0.8) from R-Forge or CRAN
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R
> questions should go.
>


From mane.desk at googlemail.com  Sat Feb 26 19:35:26 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Sat, 26 Feb 2011 19:35:26 +0100
Subject: [R-SIG-Finance] blotter update MM & weights without
 recalculation all
In-Reply-To: <4D68FCF4.9020206@braverock.com>
References: <4D68F713.8060904@gmail.com> <4D68FCF4.9020206@braverock.com>
Message-ID: <4D6947EE.6060107@gmail.com>

Hello Brian,

thanks for helping to clear thinks up!
This is how I understand things now.

I create an strategy object using quantstrat and use blotter to manage
portfolios and accounts.
I ran the strategy on a fix unit basis and can then obtain (from
blotter) a list of trades for each strategy & underlying.
Using this trades I can calculate position sizing rules (optimal f)
independent for each strategy and then rerun the strategies
using costumized position sizing rules for each strategy.

Now I pull the returns for each strategy & underlying from blotter, and
calculate the optimal weights (using portfolio.optim(),
the weights tell me how much money gets allocated to each individual
strategy.)
A weighted sum over all strategy returns will now give me the return for
the portfolio of trading strategies.
If I want to accomplish this in blotter I would have to adjust the
position sizing rules for each strategy to the weights.
Finally I would run the strategies again. The account results would now
be the results of the portfolio of strategies using optimal position
sizing and optimal allocation to each strategy. (well, optimal in the
sens how I decided to optimize).

> I'll note that Markowitz optimization is not likely what you want.  It
> will penalize positive skew and a long right tail on the distribution,
> which are precisely the features you would want to emphasize in a
> portfolio of trading strategies or products traded in a single strategy.
>
I was planing to calculate the covariances that go into the Markowitz
optimization only on the pairwise loosing returns, since there is no point
in penalizing variation at the points where both strategies make profit.
I want to penalize variation in pairwise loosing returns especially
large variations.
I'm aware that the Markowitz optimization might not be the right
approximation for my real objective , but for educational reasons
I have to use Markowitz first bevor I move on to other methods. (I'm
planing to look into LSPM)

regards,
Immanuel


From stephen at organicfoodmarkets.com.au  Sat Feb 26 20:30:01 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sun, 27 Feb 2011 06:30:01 +1100
Subject: [R-SIG-Finance] quantstrat - stop loss and stop trailing:
In-Reply-To: <4D663935.20609@braverock.com>
References: <4D6370F7.1070609@organicfoodmarkets.com.au>
	<4D63CBD8.5010805@braverock.com>
	<4D66256E.2070606@organicfoodmarkets.com.au>
	<4D663935.20609@braverock.com>
Message-ID: <4D6954B9.9090806@organicfoodmarkets.com.au>

Hi Brian

Thanks for that.

Still trying to make sure I have a handle on this.   I am working on the 
macd.R demo example but have started from 31/12/2010 to make the data 
easier to eyeball.

Obviously I am trying to see the stop work  and I notice that a 95% 
threshold should do this in August when it produces a stop figure of 
$255.30375 and it can be seen below the closing price falls below this 
on 2010-08-11

2010-08-02    260.44    262.59   259.62     261.85    15287700        
261.85  0.33850430
2010-08-03    261.01    263.26   259.42     261.93    14916200        
261.93  0.42744640
2010-08-04    262.84    264.28   260.31     262.98    15013400        
262.98  0.52431485
2010-08-05    261.73    263.18   260.55     261.70    10324900        
261.70  0.55460413
2010-08-06    259.78    261.49   257.63     260.09    15889200        
260.09  0.52246936
2010-08-09    261.48    262.15   259.57     261.75    10826000        
261.75  0.54227647
2010-08-10    259.85    260.45   257.55     259.41    16140000        
259.41  0.47975631
2010-08-11    255.40    255.69   249.81     250.19    22144800        
250.19  0.14151831
2010-08-12    246.69    253.10   246.12     251.79    19104300        
251.79 -0.07671837
2010-08-13    251.65    251.88   249.09     249.10    12673900        
249.10 -0.33112468
2010-08-16    247.58    250.01   246.62     247.64    11372500        
247.64 -0.57338811

The order book looks like this:


 > getOrderBook(portfolio.st)
$macd
$macd$AAPL
            Order.Qty Order.Price Order.Type  Order.Side Order.Threshold
2009-12-31 "0"       NA          "init"      "long"     "0"
2010-03-08 "-100"    "213.603"   "stoplimit" "long"     "0.975"
2010-03-08 "100"     "219.08"    "market"    "long"     NA
2010-07-15 "-100"    "251.45"    "market"    "long"     NA
2010-08-02 "-100"    "255.30375" "stoplimit" "long"     "0.975"
2010-08-02 "100"     "261.85"    "market"    "long"     NA
2010-08-16 "-100"    "247.64"    "market"    "long"     NA
2010-09-14 "-100"    "261.3585"  "stoplimit" "long"     "0.975"
2010-09-14 "100"     "268.06"    "market"    "long"     NA
            Order.Status Order.StatusTime Order.Set Txn.Fees
2009-12-31 "closed"     "2009-12-31"     "1"       "0"
2010-03-08 "replaced"   "2010-08-02"     NA        "0"
2010-03-08 "closed"     "2010-03-09"     NA        "0"
2010-07-15 "closed"     "2010-07-16"     NA        "0"
2010-08-02 "replaced"   "2010-09-14"     NA        "0"
2010-08-02 "closed"     "2010-08-03"     NA        "0"
2010-08-16 "closed"     "2010-08-17"     NA        "0"
2010-09-14 "open"       NA               NA        "0"
2010-09-14 "closed"     "2010-09-15"     NA        "0"

but the actual transactions like this:


 > getTxns(Portfolio=portfolio.st, Symbol=stock.str)
            Txn.Qty Txn.Price Txn.Fees Txn.Value Txn.Avg.Cost
2009-12-31       0      0.00        0         0         0.00
2010-03-08     100    219.08        0     21908       219.08
2010-07-15    -100    251.45        0    -25145       251.45
2010-08-02     100    261.85        0     26185       261.85
2010-08-16    -100    247.64        0    -24764       247.64
2010-09-14     100    268.06        0     26806       268.06
            Net.Txn.Realized.PL
2009-12-31                   0
2010-03-08                   0
2010-07-15                3237
2010-08-02                   0
2010-08-16               -1421
2010-09-14

Can anyone tell me what I am doing wrong?



Stephen Choularton Ph.D., FIoD


On 24/02/2011 9:55 PM, Brian G. Peterson wrote:
> On 02/24/2011 03:31 AM, Stephen Choularton wrote:
>> Hi and thanks.
>>
>>   I had noticed these but I am having difficulty in understand the
>> 'mechanics'.
>>
>>   I notice the column names in mktdata are:
>>
>> AAPL.Open     AAPL.High     AAPL.Low     AAPL.Close     AAPL.Volume
>> AAPL.Adjusted macd     signal     signal.gt.zero     signal.lt.zero
>>
>>
>> when I have stoplimit live.     I can see where everything but 'signal'
>> comes from.  Can anyone advise what puts it there ?  I was guessing
>> add.signal calls did this.
>
> It would be more appropriate to say that these columns are added when 
> applySignals is called inside applyStrategy, and in turn executes the 
> signal function sigThreshold.  For porting to a moving average 
> strategy, you'd probably want to use sigCrossover-based signals 
> instead, because the value of the MA is not known beforehand.
>
> As should be obvious from the demo code and the documentation, the 
> columns you asked about are are the label= parameters from your signals.
>
> In the indicator function, we do not specify a label, because the 
> MACD() function from TTR adds the labels 'macd' and 'signal' to its 
> output.
>
> In the signal generators, we specify a label as 'signal.gt.zero' and 
> 'signal.lt.zero' when we define the signals with add.signal so that we 
> know what the 'sigcol' will be for our later rules.  These labels aer 
> arbitrary, and were chosen to indicate what the signal stands for, but 
> could just as easily have been called 'blue' and 'brown'.
>
> As the documents describe, what you are doing up front with all the 
> add.* functions is just building the strategy object, nothing is 
> 'added to mktdata' until you've called applyStrategy on a portfolio 
> (which in turn calls applyIndicators and applySignals in a vectorized 
> way and applyRules in a path-dependent manner).
>
>   - Brian
>
>
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1204 / Virus Database: 1435/3464 - Release Date: 02/23/11
>
>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: macd.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110227/e4d16e3f/attachment.pl>

From jeffrey.ryan at lemnica.com  Sat Feb 26 21:48:00 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Sat, 26 Feb 2011 14:48:00 -0600
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D6947AF.6030807@gmail.com>
References: <4D693247.9040908@gmail.com> <4D69334A.7000306@braverock.com>
	<4D6947AF.6030807@gmail.com>
Message-ID: <AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110226/b4fe7d9d/attachment.pl>

From mane.desk at googlemail.com  Sun Feb 27 22:13:09 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Sun, 27 Feb 2011 22:13:09 +0100
Subject: [R-SIG-Finance] blotter getting getEndEq(account,
	CurrentDate) by Symbol
Message-ID: <4D6ABE65.5080900@gmail.com>

Hello all,

I'm desperedly trying to getEndEq(account, CurrentDate) for
one symbol. I found that .getBySymbol() internal is used by
PortfReturns() but I only got:

> .getBySymbol(Portfolio = Portfolio, Attribute = "Net.Trading.PL",Dates
= CurrentDate)
Error: could not find function ".getBySymbol"

which I don't understand since ?.getBySymol shows the R Help

can anyone help me out?

thanks & regards,
Immanuel


From brian at braverock.com  Sun Feb 27 22:19:57 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 27 Feb 2011 15:19:57 -0600
Subject: [R-SIG-Finance] blotter getting getEndEq(account,
 CurrentDate) by Symbol
In-Reply-To: <4D6ABE65.5080900@gmail.com>
References: <4D6ABE65.5080900@gmail.com>
Message-ID: <4D6ABFFD.6080208@braverock.com>

On 02/27/2011 03:13 PM, Immanuel wrote:
> Hello all,
>
> I'm desperedly trying to getEndEq(account, CurrentDate) for
> one symbol. I found that .getBySymbol() internal is used by
> PortfReturns() but I only got:
>
>> .getBySymbol(Portfolio = Portfolio, Attribute = "Net.Trading.PL",Dates
> = CurrentDate)
> Error: could not find function ".getBySymbol"
>
> which I don't understand since ?.getBySymol shows the R Help
>
> can anyone help me out?
>
> thanks&  regards,
> Immanuel

the .functions are not exported, so you need to call it explicitly

blotter:::.getBySymbol


From mane.desk at googlemail.com  Mon Feb 28 01:13:04 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Mon, 28 Feb 2011 01:13:04 +0100
Subject: [R-SIG-Finance] blotter getting getEndEq(account,
 CurrentDate) by Symbol
In-Reply-To: <4D6ABFFD.6080208@braverock.com>
References: <4D6ABE65.5080900@gmail.com> <4D6ABFFD.6080208@braverock.com>
Message-ID: <4D6AE890.60109@gmail.com>

Hello again,

I'm still trying to get the current end equity for one symbol.
What is the smartest way to accomplished that?
I figured out that:
getPortfolio("turtles")$symbol[symbol]
produces the output below. So I was hoping that
sum(getPortfolio("turtles")$symbol[symbol]$posPL$Net.Trading.PL)
would give me what I want but I got only "NULL" .

Any suggestions? Or is there a simpler way to accomplish
what I want?

I need the end quity for each symbol to calculate the
UnitSize for the next trade since I want to trade each
symbol on its own equity.

regards

--------

Browse[1]> getPortfolio("turtles")$symbol[symbol]
$XLE
$XLE$txn
           Txn.Qty Txn.Price  Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
2008-01-01       0      0.00       0.00         0.00       0         0.00
2008-03-13   10825     76.15  824323.75        76.15   10825        76.15
2008-03-24  -10825     72.05 -779941.25        72.05       0         0.00
2008-03-25     385     72.77   28016.45        72.77     385        72.77
           Gross.Txn.Realized.PL Txn.Fees Net.Txn.Realized.PL Con.Mult
2008-01-01                   0.0        0                 0.0        0
2008-03-13                   0.0        0                 0.0        1
2008-03-24              -44382.5        0            -44382.5        1
2008-03-25                   0.0        0                 0.0        1

$XLE$posPL
           Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost Txn.Value
2008-01-01       0        1        1       0.0         0.00       0.0
2008-03-13   10825        1        1  824323.8        76.15  824323.8
2008-03-14   10825        1        1  809277.0        76.15       0.0
2008-03-17   10825        1        1  781023.8        76.15       0.0
2008-03-18   10825        1        1  815122.5        76.15       0.0
2008-03-19   10825        1        1  765327.5        76.15       0.0
2008-03-20   10825        1        1  766518.2        76.15       0.0
2008-03-24       0        1        1       0.0         0.00 -779941.2
           Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL Txn.Fees
2008-01-01                0.0                 0.00             0.00        0
2008-03-13                0.0                 0.00             0.00        0
2008-03-14                0.0            -15046.75        -15046.75        0
2008-03-17                0.0            -28253.25        -28253.25        0
2008-03-18                0.0             34098.75         34098.75        0
2008-03-19                0.0            -49795.00        -49795.00        0
2008-03-20                0.0              1190.75          1190.75        0
2008-03-24           -44382.5             57805.50         13423.00        0
           Net.Trading.PL
2008-01-01           0.00
2008-03-13           0.00
2008-03-14      -15046.75
2008-03-17      -28253.25
2008-03-18       34098.75
2008-03-19      -49795.00
2008-03-20        1190.75
2008-03-24       13423.00

$XLE$posPL.USD
           Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost Txn.Value
2008-01-01       0        1        1       0.0         0.00       0.0
2008-03-13   10825        1        1  824323.8        76.15  824323.8
2008-03-14   10825        1        1  809277.0        76.15       0.0
2008-03-17   10825        1        1  781023.8        76.15       0.0
2008-03-18   10825        1        1  815122.5        76.15       0.0
2008-03-19   10825        1        1  765327.5        76.15       0.0
2008-03-20   10825        1        1  766518.2        76.15       0.0
2008-03-24       0        1        1       0.0         0.00 -779941.2
           Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL Txn.Fees
2008-01-01                0.0                 0.00             0.00        0
2008-03-13                0.0                 0.00             0.00        0
2008-03-14                0.0            -15046.75        -15046.75        0
2008-03-17                0.0            -28253.25        -28253.25        0
2008-03-18                0.0             34098.75         34098.75        0
2008-03-19                0.0            -49795.00        -49795.00        0
2008-03-20                0.0              1190.75          1190.75        0
2008-03-24           -44382.5             57805.50         13423.00        0
           Net.Trading.PL
2008-01-01           0.00
2008-03-13           0.00
2008-03-14      -15046.75
2008-03-17      -28253.25
2008-03-18       34098.75
2008-03-19      -49795.00
2008-03-20        1190.75
2008-03-24       13423.00
----------------------

On 02/27/2011 10:19 PM, Brian G. Peterson wrote:
> On 02/27/2011 03:13 PM, Immanuel wrote:
>> Hello all,
>>
>> I'm desperedly trying to getEndEq(account, CurrentDate) for
>> one symbol. I found that .getBySymbol() internal is used by
>> PortfReturns() but I only got:
>>
>>> .getBySymbol(Portfolio = Portfolio, Attribute = "Net.Trading.PL",Dates
>> = CurrentDate)
>> Error: could not find function ".getBySymbol"
>>
>> which I don't understand since ?.getBySymol shows the R Help
>>
>> can anyone help me out?
>>
>> thanks&  regards,
>> Immanuel
>
> the .functions are not exported, so you need to call it explicitly
>
> blotter:::.getBySymbol
>
>


From brian at braverock.com  Mon Feb 28 01:21:00 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 27 Feb 2011 18:21:00 -0600
Subject: [R-SIG-Finance] blotter getting getEndEq(account,
 CurrentDate) by Symbol
In-Reply-To: <4D6AE890.60109@gmail.com>
References: <4D6ABE65.5080900@gmail.com> <4D6ABFFD.6080208@braverock.com>
	<4D6AE890.60109@gmail.com>
Message-ID: <4D6AEA6C.9000409@braverock.com>

The list slot is

$symbols

as described in the documentation,

*not*

$symbol

as in your non-reproducible example,

*so*

getPortfolio(portfolio.str)$symbols[[symbol.str]]$posPL$Net.Trading.PL

should work where portfolio.str and symbol.str are character strings.


On 02/27/2011 06:13 PM, Immanuel wrote:
> Hello again,
>
> I'm still trying to get the current end equity for one symbol.
> What is the smartest way to accomplished that?
> I figured out that:
> getPortfolio("turtles")$symbol[symbol]
> produces the output below. So I was hoping that
> sum(getPortfolio("turtles")$symbol[symbol]$posPL$Net.Trading.PL)
> would give me what I want but I got only "NULL" .
>
> Any suggestions? Or is there a simpler way to accomplish
> what I want?
>
> I need the end quity for each symbol to calculate the
> UnitSize for the next trade since I want to trade each
> symbol on its own equity.
>
> regards
>
> --------
>
> Browse[1]>  getPortfolio("turtles")$symbol[symbol]
> $XLE
> $XLE$txn
>             Txn.Qty Txn.Price  Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
> 2008-01-01       0      0.00       0.00         0.00       0         0.00
> 2008-03-13   10825     76.15  824323.75        76.15   10825        76.15
> 2008-03-24  -10825     72.05 -779941.25        72.05       0         0.00
> 2008-03-25     385     72.77   28016.45        72.77     385        72.77
>             Gross.Txn.Realized.PL Txn.Fees Net.Txn.Realized.PL Con.Mult
> 2008-01-01                   0.0        0                 0.0        0
> 2008-03-13                   0.0        0                 0.0        1
> 2008-03-24              -44382.5        0            -44382.5        1
> 2008-03-25                   0.0        0                 0.0        1
>
> $XLE$posPL
>             Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost Txn.Value
> 2008-01-01       0        1        1       0.0         0.00       0.0
> 2008-03-13   10825        1        1  824323.8        76.15  824323.8
> 2008-03-14   10825        1        1  809277.0        76.15       0.0
> 2008-03-17   10825        1        1  781023.8        76.15       0.0
> 2008-03-18   10825        1        1  815122.5        76.15       0.0
> 2008-03-19   10825        1        1  765327.5        76.15       0.0
> 2008-03-20   10825        1        1  766518.2        76.15       0.0
> 2008-03-24       0        1        1       0.0         0.00 -779941.2
>             Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL Txn.Fees
> 2008-01-01                0.0                 0.00             0.00        0
> 2008-03-13                0.0                 0.00             0.00        0
> 2008-03-14                0.0            -15046.75        -15046.75        0
> 2008-03-17                0.0            -28253.25        -28253.25        0
> 2008-03-18                0.0             34098.75         34098.75        0
> 2008-03-19                0.0            -49795.00        -49795.00        0
> 2008-03-20                0.0              1190.75          1190.75        0
> 2008-03-24           -44382.5             57805.50         13423.00        0
>             Net.Trading.PL
> 2008-01-01           0.00
> 2008-03-13           0.00
> 2008-03-14      -15046.75
> 2008-03-17      -28253.25
> 2008-03-18       34098.75
> 2008-03-19      -49795.00
> 2008-03-20        1190.75
> 2008-03-24       13423.00
>
> $XLE$posPL.USD
>             Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost Txn.Value
> 2008-01-01       0        1        1       0.0         0.00       0.0
> 2008-03-13   10825        1        1  824323.8        76.15  824323.8
> 2008-03-14   10825        1        1  809277.0        76.15       0.0
> 2008-03-17   10825        1        1  781023.8        76.15       0.0
> 2008-03-18   10825        1        1  815122.5        76.15       0.0
> 2008-03-19   10825        1        1  765327.5        76.15       0.0
> 2008-03-20   10825        1        1  766518.2        76.15       0.0
> 2008-03-24       0        1        1       0.0         0.00 -779941.2
>             Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL Txn.Fees
> 2008-01-01                0.0                 0.00             0.00        0
> 2008-03-13                0.0                 0.00             0.00        0
> 2008-03-14                0.0            -15046.75        -15046.75        0
> 2008-03-17                0.0            -28253.25        -28253.25        0
> 2008-03-18                0.0             34098.75         34098.75        0
> 2008-03-19                0.0            -49795.00        -49795.00        0
> 2008-03-20                0.0              1190.75          1190.75        0
> 2008-03-24           -44382.5             57805.50         13423.00        0
>             Net.Trading.PL
> 2008-01-01           0.00
> 2008-03-13           0.00
> 2008-03-14      -15046.75
> 2008-03-17      -28253.25
> 2008-03-18       34098.75
> 2008-03-19      -49795.00
> 2008-03-20        1190.75
> 2008-03-24       13423.00
> ----------------------
>
> On 02/27/2011 10:19 PM, Brian G. Peterson wrote:
>> On 02/27/2011 03:13 PM, Immanuel wrote:
>>> Hello all,
>>>
>>> I'm desperedly trying to getEndEq(account, CurrentDate) for
>>> one symbol. I found that .getBySymbol() internal is used by
>>> PortfReturns() but I only got:
>>>
>>>> .getBySymbol(Portfolio = Portfolio, Attribute = "Net.Trading.PL",Dates
>>> = CurrentDate)
>>> Error: could not find function ".getBySymbol"
>>>
>>> which I don't understand since ?.getBySymol shows the R Help
>>>
>>> can anyone help me out?
>>>
>>> thanks&   regards,
>>> Immanuel
>>
>> the .functions are not exported, so you need to call it explicitly
>>
>> blotter:::.getBySymbol
>>
>>
>


From zhang.beiting at gmail.com  Mon Feb 28 03:26:30 2011
From: zhang.beiting at gmail.com (Zhang Beiting)
Date: Sun, 27 Feb 2011 21:26:30 -0500
Subject: [R-SIG-Finance] Solving Constrained Quadratic Programming Problem w
	An Absolute Value "Headache"
Message-ID: <AANLkTi=uNBy8hCWTzdYTg14KczjCaf2Aw5MFLWS=jPzf@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110227/d0717a6e/attachment.pl>

From zhang.beiting at gmail.com  Mon Feb 28 03:37:21 2011
From: zhang.beiting at gmail.com (Zhang, Beiting)
Date: Sun, 27 Feb 2011 21:37:21 -0500
Subject: [R-SIG-Finance] Solving Constrained Quadratic Programming
 Problem w An Absolute Value "Headache"
In-Reply-To: <AANLkTi=uNBy8hCWTzdYTg14KczjCaf2Aw5MFLWS=jPzf@mail.gmail.com>
References: <AANLkTi=uNBy8hCWTzdYTg14KczjCaf2Aw5MFLWS=jPzf@mail.gmail.com>
Message-ID: <AANLkTimcxfDNLc8wNtnrW-cTEpWMYkHObHxJS2GwRSSx@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110227/62ed0248/attachment.pl>

From zhang.beiting at gmail.com  Mon Feb 28 03:51:18 2011
From: zhang.beiting at gmail.com (Zhang, Beiting)
Date: Sun, 27 Feb 2011 21:51:18 -0500
Subject: [R-SIG-Finance] Solving Constrained Quadratic Programming Problem w
 An Absolute Value "Headache" (corrected version)
Message-ID: <AANLkTinBZpEcrwiOixahyOp_XUByYGmzjE_tKpaCWx6S@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110227/e858869e/attachment.pl>

From nelson.ana at gmail.com  Mon Feb 28 16:15:48 2011
From: nelson.ana at gmail.com (Ana Nelson)
Date: Mon, 28 Feb 2011 15:15:48 +0000
Subject: [R-SIG-Finance] RBloomberg and Bloomberg API 3.4.1.3
In-Reply-To: <AANLkTimFrki-H9ynOzFOOnB5M6srj-3TkrMNy=1Fg1DU@mail.gmail.com>
References: <AANLkTimFrki-H9ynOzFOOnB5M6srj-3TkrMNy=1Fg1DU@mail.gmail.com>
Message-ID: <AANLkTinLL3z34XtU=qA_64YJ6zz+hZ+45V_cr587agmo@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110228/39b86d0d/attachment.pl>

From aidan.corcoran11 at gmail.com  Mon Feb 28 18:36:04 2011
From: aidan.corcoran11 at gmail.com (Aidan Corcoran)
Date: Mon, 28 Feb 2011 17:36:04 +0000
Subject: [R-SIG-Finance] re-indexing data under the zoo package
Message-ID: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>

Dear all,

I was hoping someone could help me to generate an index based on data
in zooreg format. The data are of the form

> head(dq)
        sphsxs eunrfi irhont
1995(1)  670.8   82.9     NA
1995(2)  686.0   82.9     NA
1995(3)  682.6   83.0     NA
1995(4)  692.7   82.7     NA
1996(1)  686.0   81.5   33.6
1996(2)  697.8   82.0   34.6

and I would like to index each of the three variables to 100 in
1996(1). I have made a few failed attempts based on extracting the
values at that date

> dq[index(dq)==1996.00]
        sphsxs eunrfi irhont
1996(1)    686   81.5   33.6

and then trying to divide the series by those values

> dq/dq[index(dq)==1996.00]
     sphsxs eunrfi irhont
1996      1      1      1

but this results in a single row. One option might be to replicate the
1996 row using rep, but

> rep(dq[index(dq)==1996.00],2)
[1] 686.0  81.5  33.6 686.0  81.5  33.6

seems to repeat the data within a single vector, and I'm not sure how
to get it to repeat the row down through a zoo object (and suspect
there might be an easier way).

Any help much appreciated.

thanks
Aidan


From arun.kumar.saha at gmail.com  Mon Feb 28 18:49:39 2011
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Mon, 28 Feb 2011 09:49:39 -0800
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
Message-ID: <1298915379567-3328397.post@n4.nabble.com>

Hi Aiden, is this what you wanted?


library(zoo)
dat <- as.matrix(zooreg(matrix(rnorm(18), 6), start=as.Date("2011-01-01"),
frequency=1))
colnames(dat) <- paste("column", 1:3, sep="")
dat
dat1 <- t(apply(dat, 1, function(x) return(x/dat[1,]*100)))
dat1

Thanks,

-- 
View this message in context: http://r.789695.n4.nabble.com/re-indexing-data-under-the-zoo-package-tp3328376p3328397.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From singularitaet at gmx.net  Mon Feb 28 19:05:34 2011
From: singularitaet at gmx.net (Stefan Grosse)
Date: Mon, 28 Feb 2011 19:05:34 +0100
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
Message-ID: <4D6BE3EE.5060400@gmx.net>

Am 28.02.2011 18:36, schrieb Aidan Corcoran:

>> head(dq)
>         sphsxs eunrfi irhont
> 1995(1)  670.8   82.9     NA
> 1995(2)  686.0   82.9     NA
> 1995(3)  682.6   83.0     NA
> 1995(4)  692.7   82.7     NA
> 1996(1)  686.0   81.5   33.6
> 1996(2)  697.8   82.0   34.6
> 

>> dq/dq[index(dq)==1996.00]
>      sphsxs eunrfi irhont
> 1996      1      1      1


dq2<-zooreg(t(t(dq)/as.numeric(dq[index(dq)==1996.00]))*100,start=c(1995,1),frequency=4)

Stefan


From jeffrey.ryan at lemnica.com  Mon Feb 28 19:17:58 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 28 Feb 2011 12:17:58 -0600
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
Message-ID: <AANLkTi=i11UGvx2R+_ADvE4_esRgnexcDGhZcyD_JUZz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110228/e660356c/attachment.pl>

From aidan.corcoran11 at gmail.com  Mon Feb 28 19:58:13 2011
From: aidan.corcoran11 at gmail.com (Aidan Corcoran)
Date: Mon, 28 Feb 2011 18:58:13 +0000
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTi=i11UGvx2R+_ADvE4_esRgnexcDGhZcyD_JUZz@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
	<AANLkTi=i11UGvx2R+_ADvE4_esRgnexcDGhZcyD_JUZz@mail.gmail.com>
Message-ID: <AANLkTikAaKvwt8GZzmQaVPOFGB4-rvUNAHyH2o8bbXz9@mail.gmail.com>

thanks very much Jeffrey and Stefan, this is just what I wanted. It's
a neat answer (just a pity zoo doesn't provide some utility for this).

cheers
Aidan

On Mon, Feb 28, 2011 at 6:17 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
> Haven't checked the math per se, but this is probably what you want:
> z <- zooreg(matrix(rnorm(18),nc=3), start=1995, freq=4)
> z[index(z)==1996]
> 1996(1) -1.274160 0.6255354 0.4150378
> t(t(z)/as.numeric(z[index(z)==1996]))
> ?? ? ? ? ? ? ? x.1 ? ? ? ? ?x.2 ? ? ? ?x.3
> 1995(1) ?0.9233051 0.2428291171 ?0.1960831
> 1995(2) ?0.6585486 1.2370305821 -0.7346616
> 1995(3) -0.6777132 0.0009999497 -2.6567196
> 1995(4) ?0.3662096 1.3125214482 -0.6704602
> 1996(1) ?1.0000000 1.0000000000 ?1.0000000
> 1996(2) -0.2993159 1.9259156026 ?1.5291669
> The trick is zoo (and xts) merge by time first before doing basic Ops. ?So
> you are essentially left with only one row if you don't get rid of the
> 'zoo'-ness of one of your objects.
> All the t()'s are just to get things looking like they did at the beginning.
> Best,
> Jeff
>
> On Mon, Feb 28, 2011 at 11:36 AM, Aidan Corcoran
> <aidan.corcoran11 at gmail.com> wrote:
>>
>> Dear all,
>>
>> I was hoping someone could help me to generate an index based on data
>> in zooreg format. The data are of the form
>>
>> > head(dq)
>> ? ? ? ?sphsxs eunrfi irhont
>> 1995(1) ?670.8 ? 82.9 ? ? NA
>> 1995(2) ?686.0 ? 82.9 ? ? NA
>> 1995(3) ?682.6 ? 83.0 ? ? NA
>> 1995(4) ?692.7 ? 82.7 ? ? NA
>> 1996(1) ?686.0 ? 81.5 ? 33.6
>> 1996(2) ?697.8 ? 82.0 ? 34.6
>>
>> and I would like to index each of the three variables to 100 in
>> 1996(1). I have made a few failed attempts based on extracting the
>> values at that date
>>
>> > dq[index(dq)==1996.00]
>> ? ? ? ?sphsxs eunrfi irhont
>> 1996(1) ? ?686 ? 81.5 ? 33.6
>>
>> and then trying to divide the series by those values
>>
>> > dq/dq[index(dq)==1996.00]
>> ? ? sphsxs eunrfi irhont
>> 1996 ? ? ?1 ? ? ?1 ? ? ?1
>>
>> but this results in a single row. One option might be to replicate the
>> 1996 row using rep, but
>>
>> > rep(dq[index(dq)==1996.00],2)
>> [1] 686.0 ?81.5 ?33.6 686.0 ?81.5 ?33.6
>>
>> seems to repeat the data within a single vector, and I'm not sure how
>> to get it to repeat the row down through a zoo object (and suspect
>> there might be an easier way).
>>
>> Any help much appreciated.
>>
>> thanks
>> Aidan
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
>
>


From ggrothendieck at gmail.com  Mon Feb 28 20:38:10 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 28 Feb 2011 14:38:10 -0500
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
Message-ID: <AANLkTi=D=2Tq69BokGyw+XpWhbF5f1_deX9jGusS-yhb@mail.gmail.com>

On Mon, Feb 28, 2011 at 12:36 PM, Aidan Corcoran
<aidan.corcoran11 at gmail.com> wrote:
> Dear all,
>
> I was hoping someone could help me to generate an index based on data
> in zooreg format. The data are of the form
>
>> head(dq)
> ? ? ? ?sphsxs eunrfi irhont
> 1995(1) ?670.8 ? 82.9 ? ? NA
> 1995(2) ?686.0 ? 82.9 ? ? NA
> 1995(3) ?682.6 ? 83.0 ? ? NA
> 1995(4) ?692.7 ? 82.7 ? ? NA
> 1996(1) ?686.0 ? 81.5 ? 33.6
> 1996(2) ?697.8 ? 82.0 ? 34.6
>
> and I would like to index each of the three variables to 100 in
> 1996(1). I have made a few failed attempts based on extracting the
> values at that date
>
>> dq[index(dq)==1996.00]
> ? ? ? ?sphsxs eunrfi irhont
> 1996(1) ? ?686 ? 81.5 ? 33.6
>
> and then trying to divide the series by those values
>
>> dq/dq[index(dq)==1996.00]
> ? ? sphsxs eunrfi irhont
> 1996 ? ? ?1 ? ? ?1 ? ? ?1
>
> but this results in a single row. One option might be to replicate the
> 1996 row using rep, but
>
>> rep(dq[index(dq)==1996.00],2)
> [1] 686.0 ?81.5 ?33.6 686.0 ?81.5 ?33.6
>
> seems to repeat the data within a single vector, and I'm not sure how
> to get it to repeat the row down through a zoo object (and suspect
> there might be an easier way).
>
> Any help much appreciated.
>

Any of these will refer to the data at 1996:

library(zoo)
# dq <- ... shown at end ...

dq[ I(1996) ]
dq[ "1996" ]
window(dq, 1996, 1996)

1. Here is a slight variation of Arun.stat's solution that will
produce values relative to 1996:

dq100 <- dq
dq100[] <- t(apply(dq, 1, "/", coredata(dq["1996"])))

> dq100
           sphsxs   eunrfi   irhont
1995(1) 0.9778426 1.017178       NA
1995(2) 1.0000000 1.017178       NA
1995(3) 0.9950437 1.018405       NA
1995(4) 1.0097668 1.014724       NA
1996(1) 1.0000000 1.000000 1.000000
1996(2) 1.0172012 1.006135 1.029762

2. Another thing you might consider would be to use "yearqtr" class for dq:

# convert time to yearqtr
dq.yq <- dq
time(dq.yq) <- as.yearqtr(time(dq.ym))

# index relative to 1996 Q1
dq.yq100 <- dq.ym
dq.yq100 <- t(apply(dq.yq, 1, "/", coredata(dq[as.yearqtr("1996 Q1")])))

> dq.yq100
             [,1]     [,2]     [,3]
1995 Q1 0.9778426 1.017178       NA
1995 Q2 1.0000000 1.017178       NA
1995 Q3 0.9950437 1.018405       NA
1995 Q4 1.0097668 1.014724       NA
1996 Q1 1.0000000 1.000000 1.000000
1996 Q2 1.0172012 1.006135 1.029762

3. ts class would work here too since its regularly spaced:

tt <- as.ts(dq)
tt[] <- t(apply(tt, 1, "/", window(tt, 1996, 1996)))
tt

Here is the dq used above:

dq <-
structure(c(670.8, 686, 682.6, 692.7, 686, 697.8, 82.9, 82.9,
83, 82.7, 81.5, 82, NA, NA, NA, NA, 33.6, 34.6), .Dim = c(6L,
3L), .Dimnames = list(NULL, c("sphsxs", "eunrfi", "irhont")), index = c(1995,
1995.25, 1995.5, 1995.75, 1996, 1996.25), class = c("zooreg",
"zoo"), frequency = 4)

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From shoot.spam at gmail.com  Mon Feb 28 21:40:11 2011
From: shoot.spam at gmail.com (Vishal Belsare)
Date: Tue, 1 Mar 2011 02:10:11 +0530
Subject: [R-SIG-Finance] fPortfolio: Extracting Weight Vectors for Frontier
	Points?
In-Reply-To: <AANLkTi=1_v+1y5NOV6eD6EYzSoDkDX12sjvGv_EZjMWL@mail.gmail.com>
References: <AANLkTi=1_v+1y5NOV6eD6EYzSoDkDX12sjvGv_EZjMWL@mail.gmail.com>
Message-ID: <AANLkTin75Y-7p7pCPK7yEReGUx1xMo3MwUvT-LkD35ku@mail.gmail.com>

Experimenting with the fPortfolio package, and computing the frontier
using some asset returns, a portfolio specification and some
constraints, I save that to an object, presumably of fPortfolio class.
I can print it,
summarize it, and plot it. However, I cannot figure out how to EXTRACT
the weight assigned to each asset on the many frontier points. If I
set the number of frontier points to compute at 50, the print and
summary will show only 5.

The 'getWeights' method will show only one vector and I don't know
which point it is for. Can you please enlighten about how to extract
the weight vector when there are say, 50 or 100 frontier points we
have computedr? I went through the the documentation for fPortfolio,
fAssets and other packages, but they don't have any information about
this.

The information is definitely in the object because I can plot the
weights across the assets in the risk-return space. I want to get
something like, a list of weight vectors, each vector corresponding to
the 'n' frontier points.


Thanks,
Vishal Belsare


From ggrothendieck at gmail.com  Mon Feb 28 21:59:55 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 28 Feb 2011 15:59:55 -0500
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTi=D=2Tq69BokGyw+XpWhbF5f1_deX9jGusS-yhb@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
	<AANLkTi=D=2Tq69BokGyw+XpWhbF5f1_deX9jGusS-yhb@mail.gmail.com>
Message-ID: <AANLkTimAe_e+pT5PeJK4U7nbq+s_MF6oiO2vQZECBfvP@mail.gmail.com>

On Mon, Feb 28, 2011 at 2:38 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Mon, Feb 28, 2011 at 12:36 PM, Aidan Corcoran
> <aidan.corcoran11 at gmail.com> wrote:
>> Dear all,
>>
>> I was hoping someone could help me to generate an index based on data
>> in zooreg format. The data are of the form
>>
>>> head(dq)
>> ? ? ? ?sphsxs eunrfi irhont
>> 1995(1) ?670.8 ? 82.9 ? ? NA
>> 1995(2) ?686.0 ? 82.9 ? ? NA
>> 1995(3) ?682.6 ? 83.0 ? ? NA
>> 1995(4) ?692.7 ? 82.7 ? ? NA
>> 1996(1) ?686.0 ? 81.5 ? 33.6
>> 1996(2) ?697.8 ? 82.0 ? 34.6
>>
>> and I would like to index each of the three variables to 100 in
>> 1996(1). I have made a few failed attempts based on extracting the
>> values at that date
>>
>>> dq[index(dq)==1996.00]
>> ? ? ? ?sphsxs eunrfi irhont
>> 1996(1) ? ?686 ? 81.5 ? 33.6
>>
>> and then trying to divide the series by those values
>>
>>> dq/dq[index(dq)==1996.00]
>> ? ? sphsxs eunrfi irhont
>> 1996 ? ? ?1 ? ? ?1 ? ? ?1
>>
>> but this results in a single row. One option might be to replicate the
>> 1996 row using rep, but
>>
>>> rep(dq[index(dq)==1996.00],2)
>> [1] 686.0 ?81.5 ?33.6 686.0 ?81.5 ?33.6
>>
>> seems to repeat the data within a single vector, and I'm not sure how
>> to get it to repeat the row down through a zoo object (and suspect
>> there might be an easier way).
>>
>> Any help much appreciated.
>>
>
> Any of these will refer to the data at 1996:
>
> library(zoo)
> # dq <- ... shown at end ...
>
> dq[ I(1996) ]
> dq[ "1996" ]
> window(dq, 1996, 1996)
>
> 1. Here is a slight variation of Arun.stat's solution that will
> produce values relative to 1996:
>
> dq100 <- dq
> dq100[] <- t(apply(dq, 1, "/", coredata(dq["1996"])))
>
>> dq100
> ? ? ? ? ? sphsxs ? eunrfi ? irhont
> 1995(1) 0.9778426 1.017178 ? ? ? NA
> 1995(2) 1.0000000 1.017178 ? ? ? NA
> 1995(3) 0.9950437 1.018405 ? ? ? NA
> 1995(4) 1.0097668 1.014724 ? ? ? NA
> 1996(1) 1.0000000 1.000000 1.000000
> 1996(2) 1.0172012 1.006135 1.029762
>
> 2. Another thing you might consider would be to use "yearqtr" class for dq:
>
> # convert time to yearqtr
> dq.yq <- dq
> time(dq.yq) <- as.yearqtr(time(dq.ym))
>
> # index relative to 1996 Q1
> dq.yq100 <- dq.ym
> dq.yq100 <- t(apply(dq.yq, 1, "/", coredata(dq[as.yearqtr("1996 Q1")])))
>
>> dq.yq100
> ? ? ? ? ? ? [,1] ? ? [,2] ? ? [,3]
> 1995 Q1 0.9778426 1.017178 ? ? ? NA
> 1995 Q2 1.0000000 1.017178 ? ? ? NA
> 1995 Q3 0.9950437 1.018405 ? ? ? NA
> 1995 Q4 1.0097668 1.014724 ? ? ? NA
> 1996 Q1 1.0000000 1.000000 1.000000
> 1996 Q2 1.0172012 1.006135 1.029762
>
> 3. ts class would work here too since its regularly spaced:
>
> tt <- as.ts(dq)
> tt[] <- t(apply(tt, 1, "/", window(tt, 1996, 1996)))
> tt
>
> Here is the dq used above:
>
> dq <-
> structure(c(670.8, 686, 682.6, 692.7, 686, 697.8, 82.9, 82.9,
> 83, 82.7, 81.5, 82, NA, NA, NA, NA, 33.6, 34.6), .Dim = c(6L,
> 3L), .Dimnames = list(NULL, c("sphsxs", "eunrfi", "irhont")), index = c(1995,
> 1995.25, 1995.5, 1995.75, 1996, 1996.25), class = c("zooreg",
> "zoo"), frequency = 4)

4. and here is one more solution that is slightly simpler as it avoids
the transposition:

dq2 <- dq
dq2[] <- mapply("/", as.data.frame(dq), coredata(dq["1996"]))

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From alain.ledonwong at baml.com  Mon Feb 28 22:25:40 2011
From: alain.ledonwong at baml.com (Ledon, Alain - Eqty NY)
Date: Mon, 28 Feb 2011 16:25:40 -0500
Subject: [R-SIG-Finance] fPortfolio: Extracting Weight Vectors for
	FrontierPoints?
In-Reply-To: <AANLkTin75Y-7p7pCPK7yEReGUx1xMo3MwUvT-LkD35ku@mail.gmail.com>
References: <AANLkTi=1_v+1y5NOV6eD6EYzSoDkDX12sjvGv_EZjMWL@mail.gmail.com>
	<AANLkTin75Y-7p7pCPK7yEReGUx1xMo3MwUvT-LkD35ku@mail.gmail.com>
Message-ID: <A5C0E998EFB71249AEF11C6F6D501D0202028CE6@ex2k.bankofamerica.com>

Try this example:

> library(fPortfolio)
> returnData <- 100 * LPP2005.RET[, 1:6]
> portfSpec <- portfolioSpec()
> setNFrontierPoints(portfSpec) <- 5
> longFrontier <- portfolioFrontier(returnData, portfSpec)
> longFrontier at portfolio

The portfolio slot has all the information you are looking for

Alain


-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Vishal Belsare
Sent: Monday, February 28, 2011 3:40 PM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] fPortfolio: Extracting Weight Vectors for
FrontierPoints?

Experimenting with the fPortfolio package, and computing the frontier
using some asset returns, a portfolio specification and some
constraints, I save that to an object, presumably of fPortfolio class.
I can print it,
summarize it, and plot it. However, I cannot figure out how to EXTRACT
the weight assigned to each asset on the many frontier points. If I
set the number of frontier points to compute at 50, the print and
summary will show only 5.

The 'getWeights' method will show only one vector and I don't know
which point it is for. Can you please enlighten about how to extract
the weight vector when there are say, 50 or 100 frontier points we
have computedr? I went through the the documentation for fPortfolio,
fAssets and other packages, but they don't have any information about
this.

The information is definitely in the object because I can plot the
weights across the assets in the risk-return space. I want to get
something like, a list of weight vectors, each vector corresponding to
the 'n' frontier points.


Thanks,
Vishal Belsare

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.

----------------------------------------------------------------------
This message w/attachments (message) is intended solely ...{{dropped:7}}


From mirko.luedde at sap.com  Tue Mar  1 13:26:40 2011
From: mirko.luedde at sap.com (Luedde, Mirko)
Date: Tue, 1 Mar 2011 13:26:40 +0100
Subject: [R-SIG-Finance] fPortfolio: Extracting Weight Vectors
	for	FrontierPoints?
In-Reply-To: <mailman.3.1298977201.8711.r-sig-finance@r-project.org>
References: <mailman.3.1298977201.8711.r-sig-finance@r-project.org>
Message-ID: <8114345E47541748A416B7EA55839E17032BB0C9AE@DEWDFECCR05.wdf.sap.corp>

Hi Vishal, 

> ...
> Can you please enlighten about how to extract the weight vector when
> there are say, 50 or 100 frontier points we have computedr?
> ...

try out the stuff below and try to find some docs on S4 data types.

Best, Mirko

> getSlots("fPORTFOLIO")
         call          data          spec   constraints     portfolio 
       "call" "fPFOLIODATA" "fPFOLIOSPEC"  "fPFOLIOCON"  "fPFOLIOVAL" 
        title   description 
  "character"   "character" 

> mcd.frontier at portfolio # assuming you have variable "mcd.frontier" assigned
An object of class "fPFOLIOVAL"
Slot "portfolio":
$weights
            [,1]         [,2]       [,3]       [,4]       [,5]       [,6]
 [1,] 1.00000000 0.000000e+00 0.00000000 0.00000000 0.00000000 0.00000000
 [2,] 0.52257150 0.000000e+00 0.02614403 0.42493162 0.02635285 0.00000000
 [3,] 0.37250582 2.787466e-03 0.07108968 0.49202435 0.03324219 0.02835049
 [4,] 0.30331052 1.826008e-02 0.09057481 0.50545722 0.00000000 0.08239738
 [5,] 0.20880735 2.934532e-02 0.11067892 0.53447093 0.00000000 0.11669749
 [6,] 0.11430418 4.043056e-02 0.13078302 0.56348463 0.00000000 0.15099759
 [7,] 0.01980102 5.151581e-02 0.15088713 0.59249834 0.00000000 0.18529770
 [8,] 0.00000000 6.487394e-02 0.16800366 0.54395652 0.00000000 0.22316588
 [9,] 0.00000000 7.883454e-02 0.18432828 0.47485735 0.00000000 0.26197983
[10,] 0.00000000 9.279513e-02 0.20065290 0.40575818 0.00000000 0.30079379
...


-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Vishal Belsare
Sent: Monday, February 28, 2011 3:40 PM
To: r-sig-finance at r-project.org
Subject: 

Experimenting with the fPortfolio package, and computing the frontier
using some asset returns, a portfolio specification and some
constraints, I save that to an object, presumably of fPortfolio class.
I can print it,
summarize it, and plot it. However, I cannot figure out how to EXTRACT
the weight assigned to each asset on the many frontier points. If I
set the number of frontier points to compute at 50, the print and
summary will show only 5.

The 'getWeights' method will show only one vector and I don't know
which point it is for. Can you please enlighten about how to extract
the weight vector when there are say, 50 or 100 frontier points we
have computedr? I went through the the documentation for fPortfolio,
fAssets and other packages, but they don't have any information about
this.

The information is definitely in the object because I can plot the
weights across the assets in the risk-return space. I want to get
something like, a list of weight vectors, each vector corresponding to
the 'n' frontier points.


Thanks,
Vishal Belsare

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.

----------------------------------------------------------------------
This message w/attachments (message) is intended solely ...{{dropped:7}}



------------------------------

_______________________________________________
R-SIG-Finance mailing list
R-SIG-Finance at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-finance


End of R-SIG-Finance Digest, Vol 82, Issue 1
********************************************

From mane.desk at googlemail.com  Tue Mar  1 13:52:00 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Tue, 01 Mar 2011 13:52:00 +0100
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>
References: <4D693247.9040908@gmail.com>	<4D69334A.7000306@braverock.com>	<4D6947AF.6030807@gmail.com>
	<AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>
Message-ID: <4D6CEBF0.4010702@gmail.com>

Hello,

what are the implications of this error, is there a workaround?
I'm just starting with quantstrat and really like the idea to implement
strategies not directly with blotter anymore.

regards,
Immanuel

On 02/26/2011 09:48 PM, Jeffrey Ryan wrote:
> Yes, that isn't an xts issue - just happens to be taking place during a
> subset.
>
> The issue is somewhere else
>
> 3: In `[.xts`(PosData, index(PosData) < Date) :
>  Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
> Time difference of 0.387223 secs
>
> The lhs [index(PosData)] is POSIX and the rhs is Date, which R can't compare
> correctly.  The warning is happening - and probably resulting in all TRUE
> values - which isn't likely the desired outcome.
>
> I'm not looking at the code at the moment, but you can rule out xts.  There
> are likely better ways to do this with xts, and I'll see what I can do to
> make the quantstrat code use more of the built-in xts functionality.
>
> Jeff
>
>
> On Sat, Feb 26, 2011 at 12:34 PM, Immanuel <mane.desk at googlemail.com> wrote:
>
>> hello,
>> seems to be already installed:
>> ----------
>> [1] "2001-06-26 AAPL 100 @ 11.88"
>> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
>> timestamp) ==  :
>>  argument is of length zero
>> In addition: Warning messages:
>> 1: In match.names(columns, colnames(data)) :
>>  all columns not located in ma50 ma200 for AAPL.Open AAPL.High AAPL.Low
>> AAPL.Close AAPL.Volume AAPL.Adjusted ma50 ma200 ma50.gt.ma200
>> 2: In max(i) : no non-missing arguments to max; returning -Inf
>> 3: In `[.xts`(PosData, index(PosData) < Date) :
>>  Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>> Time difference of 0.387223 secs
>> [1] "trade blotter portfolio update:"
>> Time difference of 0.7028229 secs
>> Warning message:
>> In max(i) : no non-missing arguments to max; returning -Inf
>>> sessionInfo()
>> R version 2.12.1 (2010-12-16)
>> Platform: i486-pc-linux-gnu (32-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C
>>  [3] LC_TIME=en_US.UTF-8           LC_COLLATE=en_US.UTF-8
>>  [5] LC_MONETARY=en_US.UTF-8       LC_MESSAGES=en_US.UTF-8
>>  [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8
>>  [9] LC_ADDRESS=en_US.UTF-8        LC_TELEPHONE=en_US.UTF-8
>> [11] LC_MEASUREMENT=en_US.UTF-8    LC_IDENTIFICATION=en_US.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] quantstrat_0.4.0        blotter_0.8             FinancialInstrument_0.4
>> [4] quantmod_0.3-15         Defaults_1.1-1          TTR_0.20-2
>> [7] xts_0.8-0               zoo_1.6-4               rj_0.5.0-5
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.12.1     lattice_0.19-17 rJava_0.8-7     tools_2.12.1
>> ------------------
>>
>> On 02/26/2011 06:07 PM, Brian G. Peterson wrote:
>>> On 02/26/2011 11:03 AM, Immanuel wrote:
>>>> I just run the examples from the quantstrat package and
>>>> received following error for every example:
>>>> ----------
>>> <...>
>>>
>>>> 2: In `[.xts`(PosData, index(PosData)<  Date) :
>>>>    Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>> any ideas?
>>> Try upgrading xts to the latest version (0.8) from R-Forge or CRAN
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R
>>> questions should go.
>>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>


From aidan.corcoran11 at gmail.com  Tue Mar  1 14:21:37 2011
From: aidan.corcoran11 at gmail.com (Aidan Corcoran)
Date: Tue, 1 Mar 2011 13:21:37 +0000
Subject: [R-SIG-Finance] re-indexing data under the zoo package
In-Reply-To: <AANLkTimAe_e+pT5PeJK4U7nbq+s_MF6oiO2vQZECBfvP@mail.gmail.com>
References: <AANLkTinf_2+sBxzerzFV3S5SnrsAFtZN77T3SFGTuxZr@mail.gmail.com>
	<AANLkTi=D=2Tq69BokGyw+XpWhbF5f1_deX9jGusS-yhb@mail.gmail.com>
	<AANLkTimAe_e+pT5PeJK4U7nbq+s_MF6oiO2vQZECBfvP@mail.gmail.com>
Message-ID: <AANLkTi=5a-R45m9yS_+2hVn5=6m3wZswzz56V2h_0=UC@mail.gmail.com>

Thanks Gabor for the solution and the general tips. As this is a
common task for me answer no. 4 will save a lot of typing.

Aidan

On Mon, Feb 28, 2011 at 8:59 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Mon, Feb 28, 2011 at 2:38 PM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>> On Mon, Feb 28, 2011 at 12:36 PM, Aidan Corcoran
>> <aidan.corcoran11 at gmail.com> wrote:
>>> Dear all,
>>>
>>> I was hoping someone could help me to generate an index based on data
>>> in zooreg format. The data are of the form
>>>
>>>> head(dq)
>>> ? ? ? ?sphsxs eunrfi irhont
>>> 1995(1) ?670.8 ? 82.9 ? ? NA
>>> 1995(2) ?686.0 ? 82.9 ? ? NA
>>> 1995(3) ?682.6 ? 83.0 ? ? NA
>>> 1995(4) ?692.7 ? 82.7 ? ? NA
>>> 1996(1) ?686.0 ? 81.5 ? 33.6
>>> 1996(2) ?697.8 ? 82.0 ? 34.6
>>>
>>> and I would like to index each of the three variables to 100 in
>>> 1996(1). I have made a few failed attempts based on extracting the
>>> values at that date
>>>
>>>> dq[index(dq)==1996.00]
>>> ? ? ? ?sphsxs eunrfi irhont
>>> 1996(1) ? ?686 ? 81.5 ? 33.6
>>>
>>> and then trying to divide the series by those values
>>>
>>>> dq/dq[index(dq)==1996.00]
>>> ? ? sphsxs eunrfi irhont
>>> 1996 ? ? ?1 ? ? ?1 ? ? ?1
>>>
>>> but this results in a single row. One option might be to replicate the
>>> 1996 row using rep, but
>>>
>>>> rep(dq[index(dq)==1996.00],2)
>>> [1] 686.0 ?81.5 ?33.6 686.0 ?81.5 ?33.6
>>>
>>> seems to repeat the data within a single vector, and I'm not sure how
>>> to get it to repeat the row down through a zoo object (and suspect
>>> there might be an easier way).
>>>
>>> Any help much appreciated.
>>>
>>
>> Any of these will refer to the data at 1996:
>>
>> library(zoo)
>> # dq <- ... shown at end ...
>>
>> dq[ I(1996) ]
>> dq[ "1996" ]
>> window(dq, 1996, 1996)
>>
>> 1. Here is a slight variation of Arun.stat's solution that will
>> produce values relative to 1996:
>>
>> dq100 <- dq
>> dq100[] <- t(apply(dq, 1, "/", coredata(dq["1996"])))
>>
>>> dq100
>> ? ? ? ? ? sphsxs ? eunrfi ? irhont
>> 1995(1) 0.9778426 1.017178 ? ? ? NA
>> 1995(2) 1.0000000 1.017178 ? ? ? NA
>> 1995(3) 0.9950437 1.018405 ? ? ? NA
>> 1995(4) 1.0097668 1.014724 ? ? ? NA
>> 1996(1) 1.0000000 1.000000 1.000000
>> 1996(2) 1.0172012 1.006135 1.029762
>>
>> 2. Another thing you might consider would be to use "yearqtr" class for dq:
>>
>> # convert time to yearqtr
>> dq.yq <- dq
>> time(dq.yq) <- as.yearqtr(time(dq.ym))
>>
>> # index relative to 1996 Q1
>> dq.yq100 <- dq.ym
>> dq.yq100 <- t(apply(dq.yq, 1, "/", coredata(dq[as.yearqtr("1996 Q1")])))
>>
>>> dq.yq100
>> ? ? ? ? ? ? [,1] ? ? [,2] ? ? [,3]
>> 1995 Q1 0.9778426 1.017178 ? ? ? NA
>> 1995 Q2 1.0000000 1.017178 ? ? ? NA
>> 1995 Q3 0.9950437 1.018405 ? ? ? NA
>> 1995 Q4 1.0097668 1.014724 ? ? ? NA
>> 1996 Q1 1.0000000 1.000000 1.000000
>> 1996 Q2 1.0172012 1.006135 1.029762
>>
>> 3. ts class would work here too since its regularly spaced:
>>
>> tt <- as.ts(dq)
>> tt[] <- t(apply(tt, 1, "/", window(tt, 1996, 1996)))
>> tt
>>
>> Here is the dq used above:
>>
>> dq <-
>> structure(c(670.8, 686, 682.6, 692.7, 686, 697.8, 82.9, 82.9,
>> 83, 82.7, 81.5, 82, NA, NA, NA, NA, 33.6, 34.6), .Dim = c(6L,
>> 3L), .Dimnames = list(NULL, c("sphsxs", "eunrfi", "irhont")), index = c(1995,
>> 1995.25, 1995.5, 1995.75, 1996, 1996.25), class = c("zooreg",
>> "zoo"), frequency = 4)
>
> 4. and here is one more solution that is slightly simpler as it avoids
> the transposition:
>
> dq2 <- dq
> dq2[] <- mapply("/", as.data.frame(dq), coredata(dq["1996"]))
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>


From stuart.snell at gmail.com  Tue Mar  1 22:55:01 2011
From: stuart.snell at gmail.com (Stuart Snell)
Date: Tue, 1 Mar 2011 21:55:01 +0000
Subject: [R-SIG-Finance] Linear Regression on data from FRED
Message-ID: <AANLkTikHGC4oN14Xp=5xJQR6XOSJhe4ikYmJfasjYfFX@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110301/b560175e/attachment.pl>

From josh.m.ulrich at gmail.com  Wed Mar  2 00:19:20 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 1 Mar 2011 17:19:20 -0600
Subject: [R-SIG-Finance] Linear Regression on data from FRED
In-Reply-To: <AANLkTikHGC4oN14Xp=5xJQR6XOSJhe4ikYmJfasjYfFX@mail.gmail.com>
References: <AANLkTikHGC4oN14Xp=5xJQR6XOSJhe4ikYmJfasjYfFX@mail.gmail.com>
Message-ID: <AANLkTikwUqwR0ux3S5n_gZZP4Snoihx059_17x+x=+1D@mail.gmail.com>

Hi Stuart,

For future reference, this isn't really a finance question and would
be better suited for the R-help list.

There are no columns named "secA" or "secB" in your data.frame "t".
Looking at str(t) probably would have given you enough information to
solve this issue yourself.  Since "secA" and "secB" aren't in "t",
lm() has to search for them and finds them in your global environment.
 Those objects don't have the same length, hence the error.

You're also doing a lot of unnecessary steps.  All you need is:
> require(quantmod)
> getSymbols("DEXUSEU;DEXUSUK",src="FRED")
[1] "DEXUSEU" "DEXUSUK"
> Data <- merge(DEXUSEU, DEXUSUK, all=FALSE)
> (m <- lm(DEXUSEU ~ DEXUSUK + 0, data=Data))

Call:
lm(formula = DEXUSEU ~ DEXUSUK + 0, data = Data)

Coefficients:
DEXUSUK
  0.709

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Tue, Mar 1, 2011 at 3:55 PM, Stuart Snell <stuart.snell at gmail.com> wrote:
> I cannot see why the code below produces this error:-
> ? Error in model.frame.default(formula = secA ~ secB + 0, data = t,
> drop.unused.levels = TRUE) :
> ? variable lengths differ (found for 'secB')*
>
> I thought the merge would match up dates in secA and secB, therefore making
> the different lengths of secA and secB irrelevant.
>
> Any ideas.
>
> library(zoo)
> library(tseries)
> library(quantmod) ? #for access to FRED
> require(quantmod)
> require(TTR)
> secA <- getSymbols("DEXUSEU",src="FRED") secB <-
> getSymbols("DEXUSUK",src="FRED")
> secA <- zoo(DEXUSEU[,1])
> secB <- zoo(DEXUSUK[,1])
> t.zoo <- merge(secA, secB, all=FALSE)
> t <- as.data.frame(t.zoo)
> cat("Date range is", format(start(t.zoo)), "to", format(end(t.zoo)), "\n")
> m <- lm(secA ~ secB + 0, data=t)
>
>
> Thanks
> Stuart
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From petri.totterman at hanken.fi  Tue Mar  1 13:50:31 2011
From: petri.totterman at hanken.fi (Petri =?iso-8859-1?b?VPZ0dGVybWFu?=)
Date: Tue, 01 Mar 2011 14:50:31 +0200
Subject: [R-SIG-Finance] Factor models and SDF with gmm
Message-ID: <20110301145031.vsb5vfrisswc0cso@webmail1.hanken.fi>

Dear all,

do you have experiences about estimating CAPM, Fama-French etc model  
parameters in SDF form using gmm? I am trying to follow Cochrane  
(Asset Pricing, 2005) chapter 13, where he suggests estimating the SDF

1 = E[mR]

where m is defined by factors f (1...N)

m = b1 * f1 + ... + bN * fN

Significant f factors would imply that they participate in pricing.  
However, moment conditions should also be met, which is my main concern.

There is a good introduction in the gmm vignette, which I have used as  
baseline. My code is

---
g <- function(Theta, x) {
       gmat <- (Theta[1] * x[,1] + Theta[2] * x[,2] + Theta[3] *  
x[,3]) * x[,4:ncol(n)] -1
       return(gmat)
}

# z = portfolio excess return
# zm = market excess return
# zhml = high-low B/M portfolio excess return
# zsmb = small-big firm portfolio excess return

sdf <- gmm(g, x = as.matrix(cbind(z, zm, zhml, zsmb)), c(0, 0, 0))
summary(sdf)
---

but, using different datasets from Dr. French's homepage, either J  
values from specTest() are very high, implying the moment conditions  
do not hold, or the factors are not significantly different from zero.  
Obviously, in both cases the model is rejected.

Any suggestions, how should the model and the moment conditions be expressed?



Best regards
/petri

-- 
Petri T?tterman


From wwl_mok at yahoo.co.uk  Wed Mar  2 17:33:37 2011
From: wwl_mok at yahoo.co.uk (William Mok)
Date: Wed, 2 Mar 2011 16:33:37 +0000 (GMT)
Subject: [R-SIG-Finance] apply.rolling to a multi column timeSeries
Message-ID: <997990.24303.qm@web27907.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110302/5b963d23/attachment.pl>

From josh.m.ulrich at gmail.com  Wed Mar  2 19:17:35 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 2 Mar 2011 12:17:35 -0600
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D6CEBF0.4010702@gmail.com>
References: <4D693247.9040908@gmail.com> <4D69334A.7000306@braverock.com>
	<4D6947AF.6030807@gmail.com>
	<AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>
	<4D6CEBF0.4010702@gmail.com>
Message-ID: <AANLkTi=invHEBgLd5ix3+emxWucbfxV-9Yu7RmggPrAQ@mail.gmail.com>

Have you tried converting the indexes of your xts objects to POSIXct?
You haven't provided any code, but my guess is that one of xts objects
you're using as input has a Date-classed index.
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Tue, Mar 1, 2011 at 6:52 AM, Immanuel <mane.desk at googlemail.com> wrote:
> Hello,
>
> what are the implications of this error, is there a workaround?
> I'm just starting with quantstrat and really like the idea to implement
> strategies not directly with blotter anymore.
>
> regards,
> Immanuel
>
> On 02/26/2011 09:48 PM, Jeffrey Ryan wrote:
>> Yes, that isn't an xts issue - just happens to be taking place during a
>> subset.
>>
>> The issue is somewhere else
>>
>> 3: In `[.xts`(PosData, index(PosData) < Date) :
>> ?Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>> Time difference of 0.387223 secs
>>
>> The lhs [index(PosData)] is POSIX and the rhs is Date, which R can't compare
>> correctly. ?The warning is happening - and probably resulting in all TRUE
>> values - which isn't likely the desired outcome.
>>
>> I'm not looking at the code at the moment, but you can rule out xts. ?There
>> are likely better ways to do this with xts, and I'll see what I can do to
>> make the quantstrat code use more of the built-in xts functionality.
>>
>> Jeff
>>
>>
>> On Sat, Feb 26, 2011 at 12:34 PM, Immanuel <mane.desk at googlemail.com> wrote:
>>
>>> hello,
>>> seems to be already installed:
>>> ----------
>>> [1] "2001-06-26 AAPL 100 @ 11.88"
>>> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
>>> timestamp) == ?:
>>> ?argument is of length zero
>>> In addition: Warning messages:
>>> 1: In match.names(columns, colnames(data)) :
>>> ?all columns not located in ma50 ma200 for AAPL.Open AAPL.High AAPL.Low
>>> AAPL.Close AAPL.Volume AAPL.Adjusted ma50 ma200 ma50.gt.ma200
>>> 2: In max(i) : no non-missing arguments to max; returning -Inf
>>> 3: In `[.xts`(PosData, index(PosData) < Date) :
>>> ?Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>> Time difference of 0.387223 secs
>>> [1] "trade blotter portfolio update:"
>>> Time difference of 0.7028229 secs
>>> Warning message:
>>> In max(i) : no non-missing arguments to max; returning -Inf
>>>> sessionInfo()
>>> R version 2.12.1 (2010-12-16)
>>> Platform: i486-pc-linux-gnu (32-bit)
>>>
>>> locale:
>>> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? ? ?LC_NUMERIC=C
>>> ?[3] LC_TIME=en_US.UTF-8 ? ? ? ? ? LC_COLLATE=en_US.UTF-8
>>> ?[5] LC_MONETARY=en_US.UTF-8 ? ? ? LC_MESSAGES=en_US.UTF-8
>>> ?[7] LC_PAPER=en_US.UTF-8 ? ? ? ? ?LC_NAME=en_US.UTF-8
>>> ?[9] LC_ADDRESS=en_US.UTF-8 ? ? ? ?LC_TELEPHONE=en_US.UTF-8
>>> [11] LC_MEASUREMENT=en_US.UTF-8 ? ?LC_IDENTIFICATION=en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>>
>>> other attached packages:
>>> [1] quantstrat_0.4.0 ? ? ? ?blotter_0.8 ? ? ? ? ? ? FinancialInstrument_0.4
>>> [4] quantmod_0.3-15 ? ? ? ? Defaults_1.1-1 ? ? ? ? ?TTR_0.20-2
>>> [7] xts_0.8-0 ? ? ? ? ? ? ? zoo_1.6-4 ? ? ? ? ? ? ? rj_0.5.0-5
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.12.1 ? ? lattice_0.19-17 rJava_0.8-7 ? ? tools_2.12.1
>>> ------------------
>>>
>>> On 02/26/2011 06:07 PM, Brian G. Peterson wrote:
>>>> On 02/26/2011 11:03 AM, Immanuel wrote:
>>>>> I just run the examples from the quantstrat package and
>>>>> received following error for every example:
>>>>> ----------
>>>> <...>
>>>>
>>>>> 2: In `[.xts`(PosData, index(PosData)< ?Date) :
>>>>> ? ?Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>> any ideas?
>>>> Try upgrading xts to the latest version (0.8) from R-Forge or CRAN
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R
>>>> questions should go.
>>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From mane.desk at googlemail.com  Wed Mar  2 20:26:18 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Wed, 2 Mar 2011 20:26:18 +0100
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <AANLkTi=invHEBgLd5ix3+emxWucbfxV-9Yu7RmggPrAQ@mail.gmail.com>
References: <4D693247.9040908@gmail.com> <4D69334A.7000306@braverock.com>
	<4D6947AF.6030807@gmail.com>
	<AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>
	<4D6CEBF0.4010702@gmail.com>
	<AANLkTi=invHEBgLd5ix3+emxWucbfxV-9Yu7RmggPrAQ@mail.gmail.com>
Message-ID: <4D6E99DA.6020007@gmail.com>

Hello,

since I'm talking about the demo examples that come with quantstrat
saw no point in attaching them. I assumed that the error comes
from one of the quantstrat internal functions thank's for looking into it.

regards,
Immanuel

here the error & code

----------
Loading required package: quantstrat
Loading required package: xts
Loading required package: zoo
Loading required package: TTR
Loading required package: blotter
Loading required package: quantmod
Loading required package: Defaults
Loading required package: FinancialInstrument
[1] "2007-03-15 AAPL 100 @ 89.57"
Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date = 
timestamp) ==  :
   argument is of length zero
In addition: There were 15 warnings (use warnings() to see them)
Time difference of 0.2658639 secs
[1] "trade blotter portfolio update:"
Time difference of 0.2728000 secs
Warning message:
In max(i) : no non-missing arguments to max; returning -Inf
 > sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: i486-pc-linux-gnu (32-bit)

locale:
  [1] LC_CTYPE=en_US.utf8          LC_NUMERIC=C
  [3] LC_TIME=en_US.utf8           LC_COLLATE=en_US.utf8
  [5] LC_MONETARY=en_US.utf8       LC_MESSAGES=en_US.utf8
  [7] LC_PAPER=en_US.utf8          LC_NAME=en_US.utf8
  [9] LC_ADDRESS=en_US.utf8        LC_TELEPHONE=en_US.utf8
[11] LC_MEASUREMENT=en_US.utf8    LC_IDENTIFICATION=en_US.utf8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] quantstrat_0.4.0        blotter_0.8             FinancialInstrument_0.4
[4] quantmod_0.3-14         Defaults_1.1-1          TTR_0.20-2
[7] xts_0.8-0               zoo_1.6-3               rj_0.5.0-5

loaded via a namespace (and not attached):
[1] grid_2.12.0     lattice_0.19-13 rJava_0.8-7     tools_2.12.0
---------------------------------------

# Simple MACD strategy
#
# MACD may be used in many ways, this will demonstrate a trend indicator.
#
# traditionally, when the MACD signal crosses zero, this indicated a 
establishment of a positive trend
#
# we'll buy on positive treshold crossover of the 'signal' column, and 
sell on negative threshold crossover
#
# Author: brian
###############################################################################


require(quantstrat)
try(rm("order_book.macd",pos=.strategy),silent=TRUE)
try(rm("account.macd","portfolio.macd",pos=.blotter),silent=TRUE)
try(rm("account.st","portfolio.st","stock.str","stratMACD","initDate","initEq",'start_t','end_t'),silent=TRUE)

stock.str='AAPL' # what are we trying it on

#MA parameters for MACD
fastMA = 12
slowMA = 26
signalMA = 9
maType="EMA"

currency('USD')
stock(stock.str,currency='USD',multiplier=1)

#or use fake data
#stock.str='sample_matrix' # what are we trying it on
#data(sample_matrix)                 # data included in package xts
#sample_matrix<-as.xts(sample_matrix)


initDate='2006-12-31'
initEq=1000000
portfolio.st='macd'
account.st='macd'

initPortf(portfolio.st,symbols=stock.str, initDate=initDate)
initAcct(account.st,portfolios=portfolio.st, initDate=initDate)
initOrders(portfolio=portfolio.st,initDate=initDate)


stratMACD <- strategy(portfolio.st)

stratMACD <- add.indicator(strategy = stratMACD, name = "MACD", 
arguments = list(x=quote(Cl(mktdata))) )

stratMACD <- add.signal(strategy = 
stratMACD,name="sigThreshold",arguments = 
list(column="signal",relationship="gt",threshold=0,cross=TRUE),label="signal.gt.zero")
stratMACD <- add.signal(strategy = 
stratMACD,name="sigThreshold",arguments = 
list(column="signal",relationship="lt",threshold=0,cross=TRUE),label="signal.lt.zero")

stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments 
= list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=100, 
ordertype='market', orderside='long', threshold=NULL),type='enter')
stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments 
= list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=-100, 
ordertype='stoplimit', orderside='long', 
threshold=.85,tmult=TRUE),type='risk')
# alternately, use a trailing order
# stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', 
arguments = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=-100, 
ordertype='stoptrailing', orderside='long', 
threshold=.9,tmult=TRUE),type='risk')
stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments 
= list(sigcol="signal.lt.zero",sigval=TRUE, orderqty='all', 
ordertype='market', orderside='long', threshold=NULL),type='exit')

getSymbols(stock.str,from=initDate)
start_t<-Sys.time()
out<-try(applyStrategy(strategy=stratMACD , 
portfolios=portfolio.st,parameters=list(nFast=fastMA, nSlow=slowMA, 
nSig=signalMA,maType=maType)))
end_t<-Sys.time()
print(end_t-start_t)

start_t<-Sys.time()
updatePortf(Portfolio=portfolio.st,Dates=paste('::',as.Date(Sys.time()),sep=''))
end_t<-Sys.time()
print("trade blotter portfolio update:")
print(end_t-start_t)

chart.Posn(Portfolio=portfolio.st,Symbol=stock.str)
plot(add_MACD(fast=fastMA, slow=slowMA, signal=signalMA,maType="EMA"))

#look at the order book
getOrderBook('macd')

###############################################################################
# R (http://r-project.org/) Quantitative Strategy Model Framework
#
# Copyright (c) 2009-2010
# Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and 
Joshua Ulrich
#
# This library is distributed under the terms of the GNU Public License 
(GPL)
# for full details see the file COPYING
#
# $Id: macd.R 450 2010-11-13 18:30:40Z braverock $
#
##############################################################################
-----------


On 03/02/2011 07:17 PM, Joshua Ulrich wrote:
> Have you tried converting the indexes of your xts objects to POSIXct?
> You haven't provided any code, but my guess is that one of xts objects
> you're using as input has a Date-classed index.
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
> On Tue, Mar 1, 2011 at 6:52 AM, Immanuel<mane.desk at googlemail.com>  wrote:
>> Hello,
>>
>> what are the implications of this error, is there a workaround?
>> I'm just starting with quantstrat and really like the idea to implement
>> strategies not directly with blotter anymore.
>>
>> regards,
>> Immanuel
>>
>> On 02/26/2011 09:48 PM, Jeffrey Ryan wrote:
>>> Yes, that isn't an xts issue - just happens to be taking place during a
>>> subset.
>>>
>>> The issue is somewhere else
>>>
>>> 3: In `[.xts`(PosData, index(PosData)<  Date) :
>>>   Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>> Time difference of 0.387223 secs
>>>
>>> The lhs [index(PosData)] is POSIX and the rhs is Date, which R can't compare
>>> correctly.  The warning is happening - and probably resulting in all TRUE
>>> values - which isn't likely the desired outcome.
>>>
>>> I'm not looking at the code at the moment, but you can rule out xts.  There
>>> are likely better ways to do this with xts, and I'll see what I can do to
>>> make the quantstrat code use more of the built-in xts functionality.
>>>
>>> Jeff
>>>
>>>
>>> On Sat, Feb 26, 2011 at 12:34 PM, Immanuel<mane.desk at googlemail.com>  wrote:
>>>
>>>> hello,
>>>> seems to be already installed:
>>>> ----------
>>>> [1] "2001-06-26 AAPL 100 @ 11.88"
>>>> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
>>>> timestamp) ==  :
>>>>   argument is of length zero
>>>> In addition: Warning messages:
>>>> 1: In match.names(columns, colnames(data)) :
>>>>   all columns not located in ma50 ma200 for AAPL.Open AAPL.High AAPL.Low
>>>> AAPL.Close AAPL.Volume AAPL.Adjusted ma50 ma200 ma50.gt.ma200
>>>> 2: In max(i) : no non-missing arguments to max; returning -Inf
>>>> 3: In `[.xts`(PosData, index(PosData)<  Date) :
>>>>   Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>> Time difference of 0.387223 secs
>>>> [1] "trade blotter portfolio update:"
>>>> Time difference of 0.7028229 secs
>>>> Warning message:
>>>> In max(i) : no non-missing arguments to max; returning -Inf
>>>>> sessionInfo()
>>>> R version 2.12.1 (2010-12-16)
>>>> Platform: i486-pc-linux-gnu (32-bit)
>>>>
>>>> locale:
>>>>   [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C
>>>>   [3] LC_TIME=en_US.UTF-8           LC_COLLATE=en_US.UTF-8
>>>>   [5] LC_MONETARY=en_US.UTF-8       LC_MESSAGES=en_US.UTF-8
>>>>   [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8
>>>>   [9] LC_ADDRESS=en_US.UTF-8        LC_TELEPHONE=en_US.UTF-8
>>>> [11] LC_MEASUREMENT=en_US.UTF-8    LC_IDENTIFICATION=en_US.UTF-8
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>> other attached packages:
>>>> [1] quantstrat_0.4.0        blotter_0.8             FinancialInstrument_0.4
>>>> [4] quantmod_0.3-15         Defaults_1.1-1          TTR_0.20-2
>>>> [7] xts_0.8-0               zoo_1.6-4               rj_0.5.0-5
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] grid_2.12.1     lattice_0.19-17 rJava_0.8-7     tools_2.12.1
>>>> ------------------
>>>>
>>>> On 02/26/2011 06:07 PM, Brian G. Peterson wrote:
>>>>> On 02/26/2011 11:03 AM, Immanuel wrote:
>>>>>> I just run the examples from the quantstrat package and
>>>>>> received following error for every example:
>>>>>> ----------
>>>>> <...>
>>>>>
>>>>>> 2: In `[.xts`(PosData, index(PosData)<    Date) :
>>>>>>     Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>>> any ideas?
>>>>> Try upgrading xts to the latest version (0.8) from R-Forge or CRAN
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Finance at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R
>>>>> questions should go.
>>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>


From jeffrey.ryan at lemnica.com  Wed Mar  2 20:46:15 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Wed, 2 Mar 2011 13:46:15 -0600
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D6E99DA.6020007@gmail.com>
References: <4D693247.9040908@gmail.com> <4D69334A.7000306@braverock.com>
	<4D6947AF.6030807@gmail.com>
	<AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>
	<4D6CEBF0.4010702@gmail.com>
	<AANLkTi=invHEBgLd5ix3+emxWucbfxV-9Yu7RmggPrAQ@mail.gmail.com>
	<4D6E99DA.6020007@gmail.com>
Message-ID: <AANLkTi=L1vd5n+wQUVHx3kXaKmU-tKXLvZ+rDwSrBAfX@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110302/bb0aa81c/attachment.pl>

From brian at braverock.com  Wed Mar  2 20:56:14 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 02 Mar 2011 13:56:14 -0600
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D6E99DA.6020007@gmail.com>
References: <4D693247.9040908@gmail.com>
	<4D69334A.7000306@braverock.com>	<4D6947AF.6030807@gmail.com>	<AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>	<4D6CEBF0.4010702@gmail.com>	<AANLkTi=invHEBgLd5ix3+emxWucbfxV-9Yu7RmggPrAQ@mail.gmail.com>
	<4D6E99DA.6020007@gmail.com>
Message-ID: <4D6EA0DE.4050301@braverock.com>

Fixed in R-Forge svn r565.  Thanks for the report.

Thanks also to Josh and Jeff for helping track it down.

Regards,

    - Brian

On 03/02/2011 01:26 PM, Immanuel wrote:
> Hello,
>
> since I'm talking about the demo examples that come with quantstrat
> saw no point in attaching them. I assumed that the error comes
> from one of the quantstrat internal functions thank's for looking into it.
>
> regards,
> Immanuel
>
> here the error & code
>
> ----------
> Loading required package: quantstrat
> Loading required package: xts
> Loading required package: zoo
> Loading required package: TTR
> Loading required package: blotter
> Loading required package: quantmod
> Loading required package: Defaults
> Loading required package: FinancialInstrument
> [1] "2007-03-15 AAPL 100 @ 89.57"
> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
> timestamp) == :
> argument is of length zero
> In addition: There were 15 warnings (use warnings() to see them)
> Time difference of 0.2658639 secs
> [1] "trade blotter portfolio update:"
> Time difference of 0.2728000 secs
> Warning message:
> In max(i) : no non-missing arguments to max; returning -Inf
>  > sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: i486-pc-linux-gnu (32-bit)
>
> locale:
> [1] LC_CTYPE=en_US.utf8 LC_NUMERIC=C
> [3] LC_TIME=en_US.utf8 LC_COLLATE=en_US.utf8
> [5] LC_MONETARY=en_US.utf8 LC_MESSAGES=en_US.utf8
> [7] LC_PAPER=en_US.utf8 LC_NAME=en_US.utf8
> [9] LC_ADDRESS=en_US.utf8 LC_TELEPHONE=en_US.utf8
> [11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=en_US.utf8
>
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
>
> other attached packages:
> [1] quantstrat_0.4.0 blotter_0.8 FinancialInstrument_0.4
> [4] quantmod_0.3-14 Defaults_1.1-1 TTR_0.20-2
> [7] xts_0.8-0 zoo_1.6-3 rj_0.5.0-5
>
> loaded via a namespace (and not attached):
> [1] grid_2.12.0 lattice_0.19-13 rJava_0.8-7 tools_2.12.0
> ---------------------------------------
>
> # Simple MACD strategy
> #
> # MACD may be used in many ways, this will demonstrate a trend indicator.
> #
> # traditionally, when the MACD signal crosses zero, this indicated a
> establishment of a positive trend
> #
> # we'll buy on positive treshold crossover of the 'signal' column, and
> sell on negative threshold crossover
> #
> # Author: brian
> ###############################################################################
>
>
>
> require(quantstrat)
> try(rm("order_book.macd",pos=.strategy),silent=TRUE)
> try(rm("account.macd","portfolio.macd",pos=.blotter),silent=TRUE)
> try(rm("account.st","portfolio.st","stock.str","stratMACD","initDate","initEq",'start_t','end_t'),silent=TRUE)
>
>
> stock.str='AAPL' # what are we trying it on
>
> #MA parameters for MACD
> fastMA = 12
> slowMA = 26
> signalMA = 9
> maType="EMA"
>
> currency('USD')
> stock(stock.str,currency='USD',multiplier=1)
>
> #or use fake data
> #stock.str='sample_matrix' # what are we trying it on
> #data(sample_matrix) # data included in package xts
> #sample_matrix<-as.xts(sample_matrix)
>
>
> initDate='2006-12-31'
> initEq=1000000
> portfolio.st='macd'
> account.st='macd'
>
> initPortf(portfolio.st,symbols=stock.str, initDate=initDate)
> initAcct(account.st,portfolios=portfolio.st, initDate=initDate)
> initOrders(portfolio=portfolio.st,initDate=initDate)
>
>
> stratMACD <- strategy(portfolio.st)
>
> stratMACD <- add.indicator(strategy = stratMACD, name = "MACD",
> arguments = list(x=quote(Cl(mktdata))) )
>
> stratMACD <- add.signal(strategy =
> stratMACD,name="sigThreshold",arguments =
> list(column="signal",relationship="gt",threshold=0,cross=TRUE),label="signal.gt.zero")
>
> stratMACD <- add.signal(strategy =
> stratMACD,name="sigThreshold",arguments =
> list(column="signal",relationship="lt",threshold=0,cross=TRUE),label="signal.lt.zero")
>
>
> stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments
> = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=100,
> ordertype='market', orderside='long', threshold=NULL),type='enter')
> stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments
> = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=-100,
> ordertype='stoplimit', orderside='long',
> threshold=.85,tmult=TRUE),type='risk')
> # alternately, use a trailing order
> # stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal',
> arguments = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=-100,
> ordertype='stoptrailing', orderside='long',
> threshold=.9,tmult=TRUE),type='risk')
> stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments
> = list(sigcol="signal.lt.zero",sigval=TRUE, orderqty='all',
> ordertype='market', orderside='long', threshold=NULL),type='exit')
>
> getSymbols(stock.str,from=initDate)
> start_t<-Sys.time()
> out<-try(applyStrategy(strategy=stratMACD ,
> portfolios=portfolio.st,parameters=list(nFast=fastMA, nSlow=slowMA,
> nSig=signalMA,maType=maType)))
> end_t<-Sys.time()
> print(end_t-start_t)
>
> start_t<-Sys.time()
> updatePortf(Portfolio=portfolio.st,Dates=paste('::',as.Date(Sys.time()),sep=''))
>
> end_t<-Sys.time()
> print("trade blotter portfolio update:")
> print(end_t-start_t)
>
> chart.Posn(Portfolio=portfolio.st,Symbol=stock.str)
> plot(add_MACD(fast=fastMA, slow=slowMA, signal=signalMA,maType="EMA"))
>
> #look at the order book
> getOrderBook('macd')
>
> ###############################################################################
>
> # R (http://r-project.org/) Quantitative Strategy Model Framework
> #
> # Copyright (c) 2009-2010
> # Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and
> Joshua Ulrich
> #
> # This library is distributed under the terms of the GNU Public License
> (GPL)
> # for full details see the file COPYING
> #
> # $Id: macd.R 450 2010-11-13 18:30:40Z braverock $
> #
> ##############################################################################
>
> -----------
>
>
> On 03/02/2011 07:17 PM, Joshua Ulrich wrote:
>> Have you tried converting the indexes of your xts objects to POSIXct?
>> You haven't provided any code, but my guess is that one of xts objects
>> you're using as input has a Date-classed index.
>> --
>> Joshua Ulrich | FOSS Trading: www.fosstrading.com
>>
>>
>>
>> On Tue, Mar 1, 2011 at 6:52 AM, Immanuel<mane.desk at googlemail.com> wrote:
>>> Hello,
>>>
>>> what are the implications of this error, is there a workaround?
>>> I'm just starting with quantstrat and really like the idea to implement
>>> strategies not directly with blotter anymore.
>>>
>>> regards,
>>> Immanuel
>>>
>>> On 02/26/2011 09:48 PM, Jeffrey Ryan wrote:
>>>> Yes, that isn't an xts issue - just happens to be taking place during a
>>>> subset.
>>>>
>>>> The issue is somewhere else
>>>>
>>>> 3: In `[.xts`(PosData, index(PosData)< Date) :
>>>> Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>> Time difference of 0.387223 secs
>>>>
>>>> The lhs [index(PosData)] is POSIX and the rhs is Date, which R can't
>>>> compare
>>>> correctly. The warning is happening - and probably resulting in all
>>>> TRUE
>>>> values - which isn't likely the desired outcome.
>>>>
>>>> I'm not looking at the code at the moment, but you can rule out xts.
>>>> There
>>>> are likely better ways to do this with xts, and I'll see what I can
>>>> do to
>>>> make the quantstrat code use more of the built-in xts functionality.
>>>>
>>>> Jeff
>>>>
>>>>
>>>> On Sat, Feb 26, 2011 at 12:34 PM, Immanuel<mane.desk at googlemail.com>
>>>> wrote:
>>>>
>>>>> hello,
>>>>> seems to be already installed:
>>>>> ----------
>>>>> [1] "2001-06-26 AAPL 100 @ 11.88"
>>>>> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
>>>>> timestamp) == :
>>>>> argument is of length zero
>>>>> In addition: Warning messages:
>>>>> 1: In match.names(columns, colnames(data)) :
>>>>> all columns not located in ma50 ma200 for AAPL.Open AAPL.High AAPL.Low
>>>>> AAPL.Close AAPL.Volume AAPL.Adjusted ma50 ma200 ma50.gt.ma200
>>>>> 2: In max(i) : no non-missing arguments to max; returning -Inf
>>>>> 3: In `[.xts`(PosData, index(PosData)< Date) :
>>>>> Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>> Time difference of 0.387223 secs
>>>>> [1] "trade blotter portfolio update:"
>>>>> Time difference of 0.7028229 secs
>>>>> Warning message:
>>>>> In max(i) : no non-missing arguments to max; returning -Inf
>>>>>> sessionInfo()
>>>>> R version 2.12.1 (2010-12-16)
>>>>> Platform: i486-pc-linux-gnu (32-bit)
>>>>>
>>>>> locale:
>>>>> [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C
>>>>> [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8
>>>>> [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8
>>>>> [7] LC_PAPER=en_US.UTF-8 LC_NAME=en_US.UTF-8
>>>>> [9] LC_ADDRESS=en_US.UTF-8 LC_TELEPHONE=en_US.UTF-8
>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=en_US.UTF-8
>>>>>
>>>>> attached base packages:
>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>
>>>>> other attached packages:
>>>>> [1] quantstrat_0.4.0 blotter_0.8 FinancialInstrument_0.4
>>>>> [4] quantmod_0.3-15 Defaults_1.1-1 TTR_0.20-2
>>>>> [7] xts_0.8-0 zoo_1.6-4 rj_0.5.0-5
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] grid_2.12.1 lattice_0.19-17 rJava_0.8-7 tools_2.12.1
>>>>> ------------------
>>>>>
>>>>> On 02/26/2011 06:07 PM, Brian G. Peterson wrote:
>>>>>> On 02/26/2011 11:03 AM, Immanuel wrote:
>>>>>>> I just run the examples from the quantstrat package and
>>>>>>> received following error for every example:
>>>>>>> ----------
>>>>>> <...>
>>>>>>
>>>>>>> 2: In `[.xts`(PosData, index(PosData)< Date) :
>>>>>>> Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>>>> any ideas?
>>>>>> Try upgrading xts to the latest version (0.8) from R-Forge or CRAN
>>>>>>


From josh.m.ulrich at gmail.com  Thu Mar  3 05:13:46 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 2 Mar 2011 22:13:46 -0600
Subject: [R-SIG-Finance] runMax and DonchianChannel()
In-Reply-To: <AANLkTin9Uw2Fk6Z9POvJ01qdQ=ujWM7PV6YGVHTgt3L+@mail.gmail.com>
References: <AANLkTin9Uw2Fk6Z9POvJ01qdQ=ujWM7PV6YGVHTgt3L+@mail.gmail.com>
Message-ID: <AANLkTimtGP48QyOmneDCGkHce_CF9abvFH3rax0Oc3nZ@mail.gmail.com>

Hi Andrew,

On Wed, Feb 23, 2011 at 6:32 PM, andrew morgan <minkymorgan at gmail.com> wrote:
> Hi all,
>
> can anyone point me in the right direction?
> I'm not particularly strong at R but use quantmod to do a lot of charting -
> so apologize in advance if there's a simple answer to this I've missed.
>
> I am trying to modify DonchianChannel() in TTR so that I can draw the
> channel, but not for the last n days.
> Instead, I'd like to draw it for a trailing n day period, meaning to draw
> the highs/lows over the period from 20 days ago to 10 days ago.
>
> After reviewing the ?DonchianChannel() code, it makes use of runMax and
> runMin in TTR that evaluate moving windows of n-days. Is there a similar
> runMax runMin function I can use (or reuse) to build a version of these that
> accept a richer set of parameters, for example nstart=20, nend=10
>
> thanks
>
> Andrew
>

You don't need to modify the function.  Just lag the results appropriately.

require(quantmod)
getSymbols("SPY")
dc <- DonchianChannel(cbind(Hi(SPY),Lo(SPY)), n=10)
# DonchianChannel results from t-20 through t-10
dcLag <- lag(dc,10)

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From mane.desk at googlemail.com  Thu Mar  3 11:07:40 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Thu, 03 Mar 2011 11:07:40 +0100
Subject: [R-SIG-Finance] quantstrat example stragey error
In-Reply-To: <4D6EA0DE.4050301@braverock.com>
References: <4D693247.9040908@gmail.com>	<4D69334A.7000306@braverock.com>	<4D6947AF.6030807@gmail.com>	<AANLkTinsjtwp1gy1BpwzGC-Xrm7UAjAo9TYBEUb2PrvP@mail.gmail.com>	<4D6CEBF0.4010702@gmail.com>	<AANLkTi=invHEBgLd5ix3+emxWucbfxV-9Yu7RmggPrAQ@mail.gmail.com>	<4D6E99DA.6020007@gmail.com>
	<4D6EA0DE.4050301@braverock.com>
Message-ID: <4D6F686C.5030004@gmail.com>

Hello,

works like a charm now. Thank's to all involved.

On 03/02/2011 08:56 PM, Brian G. Peterson wrote:
> Fixed in R-Forge svn r565.  Thanks for the report.
>
> Thanks also to Josh and Jeff for helping track it down.
>
> Regards,
>
>    - Brian
>
> On 03/02/2011 01:26 PM, Immanuel wrote:
>> Hello,
>>
>> since I'm talking about the demo examples that come with quantstrat
>> saw no point in attaching them. I assumed that the error comes
>> from one of the quantstrat internal functions thank's for looking 
>> into it.
>>
>> regards,
>> Immanuel
>>
>> here the error & code
>>
>> ----------
>> Loading required package: quantstrat
>> Loading required package: xts
>> Loading required package: zoo
>> Loading required package: TTR
>> Loading required package: blotter
>> Loading required package: quantmod
>> Loading required package: Defaults
>> Loading required package: FinancialInstrument
>> [1] "2007-03-15 AAPL 100 @ 89.57"
>> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, Date =
>> timestamp) == :
>> argument is of length zero
>> In addition: There were 15 warnings (use warnings() to see them)
>> Time difference of 0.2658639 secs
>> [1] "trade blotter portfolio update:"
>> Time difference of 0.2728000 secs
>> Warning message:
>> In max(i) : no non-missing arguments to max; returning -Inf
>> > sessionInfo()
>> R version 2.12.0 (2010-10-15)
>> Platform: i486-pc-linux-gnu (32-bit)
>>
>> locale:
>> [1] LC_CTYPE=en_US.utf8 LC_NUMERIC=C
>> [3] LC_TIME=en_US.utf8 LC_COLLATE=en_US.utf8
>> [5] LC_MONETARY=en_US.utf8 LC_MESSAGES=en_US.utf8
>> [7] LC_PAPER=en_US.utf8 LC_NAME=en_US.utf8
>> [9] LC_ADDRESS=en_US.utf8 LC_TELEPHONE=en_US.utf8
>> [11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=en_US.utf8
>>
>> attached base packages:
>> [1] stats graphics grDevices utils datasets methods base
>>
>> other attached packages:
>> [1] quantstrat_0.4.0 blotter_0.8 FinancialInstrument_0.4
>> [4] quantmod_0.3-14 Defaults_1.1-1 TTR_0.20-2
>> [7] xts_0.8-0 zoo_1.6-3 rj_0.5.0-5
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.12.0 lattice_0.19-13 rJava_0.8-7 tools_2.12.0
>> ---------------------------------------
>>
>> # Simple MACD strategy
>> #
>> # MACD may be used in many ways, this will demonstrate a trend 
>> indicator.
>> #
>> # traditionally, when the MACD signal crosses zero, this indicated a
>> establishment of a positive trend
>> #
>> # we'll buy on positive treshold crossover of the 'signal' column, and
>> sell on negative threshold crossover
>> #
>> # Author: brian
>> ############################################################################### 
>>
>>
>>
>>
>> require(quantstrat)
>> try(rm("order_book.macd",pos=.strategy),silent=TRUE)
>> try(rm("account.macd","portfolio.macd",pos=.blotter),silent=TRUE)
>> try(rm("account.st","portfolio.st","stock.str","stratMACD","initDate","initEq",'start_t','end_t'),silent=TRUE) 
>>
>>
>>
>> stock.str='AAPL' # what are we trying it on
>>
>> #MA parameters for MACD
>> fastMA = 12
>> slowMA = 26
>> signalMA = 9
>> maType="EMA"
>>
>> currency('USD')
>> stock(stock.str,currency='USD',multiplier=1)
>>
>> #or use fake data
>> #stock.str='sample_matrix' # what are we trying it on
>> #data(sample_matrix) # data included in package xts
>> #sample_matrix<-as.xts(sample_matrix)
>>
>>
>> initDate='2006-12-31'
>> initEq=1000000
>> portfolio.st='macd'
>> account.st='macd'
>>
>> initPortf(portfolio.st,symbols=stock.str, initDate=initDate)
>> initAcct(account.st,portfolios=portfolio.st, initDate=initDate)
>> initOrders(portfolio=portfolio.st,initDate=initDate)
>>
>>
>> stratMACD <- strategy(portfolio.st)
>>
>> stratMACD <- add.indicator(strategy = stratMACD, name = "MACD",
>> arguments = list(x=quote(Cl(mktdata))) )
>>
>> stratMACD <- add.signal(strategy =
>> stratMACD,name="sigThreshold",arguments =
>> list(column="signal",relationship="gt",threshold=0,cross=TRUE),label="signal.gt.zero") 
>>
>>
>> stratMACD <- add.signal(strategy =
>> stratMACD,name="sigThreshold",arguments =
>> list(column="signal",relationship="lt",threshold=0,cross=TRUE),label="signal.lt.zero") 
>>
>>
>>
>> stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments
>> = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=100,
>> ordertype='market', orderside='long', threshold=NULL),type='enter')
>> stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments
>> = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=-100,
>> ordertype='stoplimit', orderside='long',
>> threshold=.85,tmult=TRUE),type='risk')
>> # alternately, use a trailing order
>> # stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal',
>> arguments = list(sigcol="signal.gt.zero",sigval=TRUE, orderqty=-100,
>> ordertype='stoptrailing', orderside='long',
>> threshold=.9,tmult=TRUE),type='risk')
>> stratMACD <- add.rule(strategy = stratMACD,name='ruleSignal', arguments
>> = list(sigcol="signal.lt.zero",sigval=TRUE, orderqty='all',
>> ordertype='market', orderside='long', threshold=NULL),type='exit')
>>
>> getSymbols(stock.str,from=initDate)
>> start_t<-Sys.time()
>> out<-try(applyStrategy(strategy=stratMACD ,
>> portfolios=portfolio.st,parameters=list(nFast=fastMA, nSlow=slowMA,
>> nSig=signalMA,maType=maType)))
>> end_t<-Sys.time()
>> print(end_t-start_t)
>>
>> start_t<-Sys.time()
>> updatePortf(Portfolio=portfolio.st,Dates=paste('::',as.Date(Sys.time()),sep='')) 
>>
>>
>> end_t<-Sys.time()
>> print("trade blotter portfolio update:")
>> print(end_t-start_t)
>>
>> chart.Posn(Portfolio=portfolio.st,Symbol=stock.str)
>> plot(add_MACD(fast=fastMA, slow=slowMA, signal=signalMA,maType="EMA"))
>>
>> #look at the order book
>> getOrderBook('macd')
>>
>> ############################################################################### 
>>
>>
>> # R (http://r-project.org/) Quantitative Strategy Model Framework
>> #
>> # Copyright (c) 2009-2010
>> # Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and
>> Joshua Ulrich
>> #
>> # This library is distributed under the terms of the GNU Public License
>> (GPL)
>> # for full details see the file COPYING
>> #
>> # $Id: macd.R 450 2010-11-13 18:30:40Z braverock $
>> #
>> ############################################################################## 
>>
>>
>> -----------
>>
>>
>> On 03/02/2011 07:17 PM, Joshua Ulrich wrote:
>>> Have you tried converting the indexes of your xts objects to POSIXct?
>>> You haven't provided any code, but my guess is that one of xts objects
>>> you're using as input has a Date-classed index.
>>> -- 
>>> Joshua Ulrich | FOSS Trading: www.fosstrading.com
>>>
>>>
>>>
>>> On Tue, Mar 1, 2011 at 6:52 AM, Immanuel<mane.desk at googlemail.com> 
>>> wrote:
>>>> Hello,
>>>>
>>>> what are the implications of this error, is there a workaround?
>>>> I'm just starting with quantstrat and really like the idea to 
>>>> implement
>>>> strategies not directly with blotter anymore.
>>>>
>>>> regards,
>>>> Immanuel
>>>>
>>>> On 02/26/2011 09:48 PM, Jeffrey Ryan wrote:
>>>>> Yes, that isn't an xts issue - just happens to be taking place 
>>>>> during a
>>>>> subset.
>>>>>
>>>>> The issue is somewhere else
>>>>>
>>>>> 3: In `[.xts`(PosData, index(PosData)< Date) :
>>>>> Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>> Time difference of 0.387223 secs
>>>>>
>>>>> The lhs [index(PosData)] is POSIX and the rhs is Date, which R can't
>>>>> compare
>>>>> correctly. The warning is happening - and probably resulting in all
>>>>> TRUE
>>>>> values - which isn't likely the desired outcome.
>>>>>
>>>>> I'm not looking at the code at the moment, but you can rule out xts.
>>>>> There
>>>>> are likely better ways to do this with xts, and I'll see what I can
>>>>> do to
>>>>> make the quantstrat code use more of the built-in xts functionality.
>>>>>
>>>>> Jeff
>>>>>
>>>>>
>>>>> On Sat, Feb 26, 2011 at 12:34 PM, Immanuel<mane.desk at googlemail.com>
>>>>> wrote:
>>>>>
>>>>>> hello,
>>>>>> seems to be already installed:
>>>>>> ----------
>>>>>> [1] "2001-06-26 AAPL 100 @ 11.88"
>>>>>> Error in if (getPosQty(Portfolio = portfolio, Symbol = symbol, 
>>>>>> Date =
>>>>>> timestamp) == :
>>>>>> argument is of length zero
>>>>>> In addition: Warning messages:
>>>>>> 1: In match.names(columns, colnames(data)) :
>>>>>> all columns not located in ma50 ma200 for AAPL.Open AAPL.High 
>>>>>> AAPL.Low
>>>>>> AAPL.Close AAPL.Volume AAPL.Adjusted ma50 ma200 ma50.gt.ma200
>>>>>> 2: In max(i) : no non-missing arguments to max; returning -Inf
>>>>>> 3: In `[.xts`(PosData, index(PosData)< Date) :
>>>>>> Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>>> Time difference of 0.387223 secs
>>>>>> [1] "trade blotter portfolio update:"
>>>>>> Time difference of 0.7028229 secs
>>>>>> Warning message:
>>>>>> In max(i) : no non-missing arguments to max; returning -Inf
>>>>>>> sessionInfo()
>>>>>> R version 2.12.1 (2010-12-16)
>>>>>> Platform: i486-pc-linux-gnu (32-bit)
>>>>>>
>>>>>> locale:
>>>>>> [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C
>>>>>> [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8
>>>>>> [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8
>>>>>> [7] LC_PAPER=en_US.UTF-8 LC_NAME=en_US.UTF-8
>>>>>> [9] LC_ADDRESS=en_US.UTF-8 LC_TELEPHONE=en_US.UTF-8
>>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=en_US.UTF-8
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>
>>>>>> other attached packages:
>>>>>> [1] quantstrat_0.4.0 blotter_0.8 FinancialInstrument_0.4
>>>>>> [4] quantmod_0.3-15 Defaults_1.1-1 TTR_0.20-2
>>>>>> [7] xts_0.8-0 zoo_1.6-4 rj_0.5.0-5
>>>>>>
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] grid_2.12.1 lattice_0.19-17 rJava_0.8-7 tools_2.12.1
>>>>>> ------------------
>>>>>>
>>>>>> On 02/26/2011 06:07 PM, Brian G. Peterson wrote:
>>>>>>> On 02/26/2011 11:03 AM, Immanuel wrote:
>>>>>>>> I just run the examples from the quantstrat package and
>>>>>>>> received following error for every example:
>>>>>>>> ----------
>>>>>>> <...>
>>>>>>>
>>>>>>>> 2: In `[.xts`(PosData, index(PosData)< Date) :
>>>>>>>> Incompatible methods ("Ops.POSIXt", "Ops.Date") for "<"
>>>>>>>> any ideas?
>>>>>>> Try upgrading xts to the latest version (0.8) from R-Forge or CRAN
>>>>>>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.
>


From mane.desk at googlemail.com  Thu Mar  3 11:18:28 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Thu, 3 Mar 2011 11:18:28 +0100
Subject: [R-SIG-Finance] quantstrat & flexible orderqty
Message-ID: <4D6F6AF4.2030509@gmail.com>

Hello,

looking at the quantstrat demos I realized that the only use fixed orderqty.
---
stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal', 
arguments = list(sigcol="ma50.gt.ma200",sigval=TRUE, orderqty=100, 
ordertype='market', orderside='long'),type='enter')
---
By now I kow how to implement flexible orderqtys depending on account / 
portfolio equity in blotter.
But if I use quantstrat the create trades loop is hidden, is there a way 
to use flexible orderqty anyway?

regards,
Immanuel


From brian at braverock.com  Thu Mar  3 13:38:38 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 3 Mar 2011 06:38:38 -0600
Subject: [R-SIG-Finance] quantstrat & flexible orderqty
In-Reply-To: <4D6F6AF4.2030509@gmail.com>
References: <4D6F6AF4.2030509@gmail.com>
Message-ID: <4D6F8BCE.1020301@braverock.com>

On 03/03/2011 04:18 AM, Immanuel wrote:
> Hello,
>
> looking at the quantstrat demos I realized that the only use fixed
> orderqty.
> ---
> stratMACROSS <- add.rule(strategy = stratMACROSS,name='ruleSignal',
> arguments = list(sigcol="ma50.gt.ma200",sigval=TRUE, orderqty=100,
> ordertype='market', orderside='long'),type='enter')
> ---
> By now I kow how to implement flexible orderqtys depending on account /
> portfolio equity in blotter.
> But if I use quantstrat the create trades loop is hidden, is there a way
> to use flexible orderqty anyway?

There are multiple ways of doing this.  If you look at:

?ruleSignal

you'll see the argument 'osFUN'.

This allows you to write a custom order sizing rule for your strategy.

The default behavior is osNoOp.  We've also provided osMaxPos as an 
example.  We commonly write custom order sizing functions for our 
proprietary strategies that make decisions based on start of day equity, 
leveling in/out of a position, current market volatility, custom risk 
rule order sizing, etc.

You can also put some time based loop around your evaluation of the 
strategy, if for whatever reason you require this.  Understand that this 
second approach involves potentially significant performance trade offs, 
as you are  introducing additional looping and dependencies between 
strategy backtest evaluations that could otherwise be parallelized.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From junzhu98 at yahoo.com  Fri Mar  4 00:38:14 2011
From: junzhu98 at yahoo.com (Jun Zhu)
Date: Thu, 3 Mar 2011 15:38:14 -0800 (PST)
Subject: [R-SIG-Finance] Help on error message: Too many file open files
Message-ID: <430335.10488.qm@web30604.mail.mud.yahoo.com>

Hi,

I use getSymbols many times in my program and the program crash with the following message:


Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m,  : 
  cannot open destfile 'C:\Users\jzhu\AppData\Local\Temp\RtmpfA54zb\file4d90a4b', reason 'Too many open files'

What should I do to fix this problem?  

thanks,


From josh.m.ulrich at gmail.com  Fri Mar  4 02:38:05 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 3 Mar 2011 19:38:05 -0600
Subject: [R-SIG-Finance] Help on error message: Too many file open files
In-Reply-To: <430335.10488.qm@web30604.mail.mud.yahoo.com>
References: <430335.10488.qm@web30604.mail.mud.yahoo.com>
Message-ID: <AANLkTi=DqSdLFf+OB6nEALB4D-Y2n4b4ec4a-LTixC9g@mail.gmail.com>

Hi Jun,

This is not a question related to finance.  You will get more help
posting to the R-help mailing list.  If you do, be sure to include the
minimum information requested in the "Surprising behavior and bugs"
section of the posting guide
(http://www.r-project.org/posting-guide.html).  I would also recommend
looking through the results of a search for "too many open files" on
www.rseek.org before posting.

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Thu, Mar 3, 2011 at 5:38 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
> Hi,
>
> I use getSymbols many times in my program and the program crash with the following message:
>
>
> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
> ?cannot open destfile 'C:\Users\jzhu\AppData\Local\Temp\RtmpfA54zb\file4d90a4b', reason 'Too many open files'
>
> What should I do to fix this problem?
>
> thanks,
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From bogaso.christofer at gmail.com  Fri Mar  4 12:10:08 2011
From: bogaso.christofer at gmail.com (Bogaso)
Date: Fri, 4 Mar 2011 03:10:08 -0800
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
Message-ID: <1299237008213-3335062.post@n4.nabble.com>

Hi all, I having some problem in replacing some observation of a zoo object
with NA. Here I have tries followings:

> MyData <- zooreg(rnorm(60), start=as.Date("2011-01-01"))[-2]
> MyData[as.Date(c("2011-01-01", "2011-01-02", "2011-01-03"))] <- NA  ## I
> like to replace values with those indices with 'NA'
> MyData
Error in dimnames(x) <- dn : 
  length of 'dimnames' [1] not equal to array extent

Can somebody point me on the correct approach?

Thanks,

--
View this message in context: http://r.789695.n4.nabble.com/Replacing-some-observation-of-a-zoo-object-tp3335062p3335062.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From ggrothendieck at gmail.com  Fri Mar  4 14:57:10 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 4 Mar 2011 08:57:10 -0500
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
In-Reply-To: <1299237008213-3335062.post@n4.nabble.com>
References: <1299237008213-3335062.post@n4.nabble.com>
Message-ID: <AANLkTi=PVbzjbP8x133=zyFS0dPtXGRUyhW-L4-KJdHr@mail.gmail.com>

On Fri, Mar 4, 2011 at 6:10 AM, Bogaso <bogaso.christofer at gmail.com> wrote:
> Hi all, I having some problem in replacing some observation of a zoo object
> with NA. Here I have tries followings:
>
>> MyData <- zooreg(rnorm(60), start=as.Date("2011-01-01"))[-2]
>> MyData[as.Date(c("2011-01-01", "2011-01-02", "2011-01-03"))] <- NA ?## I
>> like to replace values with those indices with 'NA'
>> MyData
> Error in dimnames(x) <- dn :
> ?length of 'dimnames' [1] not equal to array extent
>
> Can somebody point me on the correct approach?

This is a bug that has been fixed in the development version of zoo. Try this:

library(zoo)
source("http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/zoo/R/zoo.R?revision=807&root=zoo")
MyData <- zooreg(rnorm(60), start=as.Date("2011-01-01"))[-2]
MyData[as.Date(c("2011-01-01", "2011-01-02", "2011-01-03"))] <- NA

This gives:

> MyData
 2011-01-01  2011-01-02  2011-01-03  2011-01-04  2011-01-05  2011-01-06
         NA          NA          NA -1.34805886 -1.91697046  1.25480605
 2011-01-07  2011-01-08  2011-01-09  2011-01-10  2011-01-11  2011-01-12
-1.11093108 -0.09022114 -1.48167745  0.09454079  0.14537740  3.20595170
 2011-01-13  2011-01-14  2011-01-15  2011-01-16  2011-01-17  2011-01-18
 1.76102208  0.30314129  0.80446039 -0.44131485  0.30540308 -0.06544116
 2011-01-19  2011-01-20  2011-01-21  2011-01-22  2011-01-23  2011-01-24
 0.51936876  1.09788586 -0.44658700  0.34662045 -0.90035035  0.70918434
 2011-01-25  2011-01-26  2011-01-27  2011-01-28  2011-01-29  2011-01-30
-1.48424386  0.03681397 -1.41516001 -0.57138922  0.73444079  1.11011085
 2011-01-31  2011-02-01  2011-02-02  2011-02-03  2011-02-04  2011-02-05
-0.15998173  0.95090759  0.30755803  0.26189967  1.16055471 -0.67093163
 2011-02-06  2011-02-07  2011-02-08  2011-02-09  2011-02-10  2011-02-11
-0.42165283 -0.88252925 -2.77272381 -0.64737290 -0.68938798 -0.86060754
 2011-02-12  2011-02-13  2011-02-14  2011-02-15  2011-02-16  2011-02-17
-0.59200348 -1.52368460 -0.93473316 -0.04775729  0.29883692 -1.09869497
 2011-02-18  2011-02-19  2011-02-20  2011-02-21  2011-02-22  2011-02-23
-0.09645265 -1.46670669 -0.58237332  0.71437046  2.18060192 -1.24251170
 2011-02-24  2011-02-25  2011-02-26  2011-02-27  2011-02-28  2011-03-01
-0.60004701  0.76253189 -0.33870264  0.43248596  0.80008573  0.37263523

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From bogaso.christofer at gmail.com  Fri Mar  4 15:30:06 2011
From: bogaso.christofer at gmail.com (Bogaso)
Date: Fri, 4 Mar 2011 06:30:06 -0800
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
In-Reply-To: <AANLkTi=PVbzjbP8x133=zyFS0dPtXGRUyhW-L4-KJdHr@mail.gmail.com>
References: <1299237008213-3335062.post@n4.nabble.com>
	<AANLkTi=PVbzjbP8x133=zyFS0dPtXGRUyhW-L4-KJdHr@mail.gmail.com>
Message-ID: <1299249006995-3335323.post@n4.nabble.com>

Thanks Gabor for this fix. However I was expecting that the index
'2011-01-02' would not be there in final "MyData" because in the original
"MyData" that was not there.

Any idea on how to make this thing better?

Thanks and regards,

--
View this message in context: http://r.789695.n4.nabble.com/Replacing-some-observation-of-a-zoo-object-tp3335062p3335323.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From ggrothendieck at gmail.com  Fri Mar  4 15:56:40 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 4 Mar 2011 09:56:40 -0500
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
In-Reply-To: <1299249006995-3335323.post@n4.nabble.com>
References: <1299237008213-3335062.post@n4.nabble.com>
	<AANLkTi=PVbzjbP8x133=zyFS0dPtXGRUyhW-L4-KJdHr@mail.gmail.com>
	<1299249006995-3335323.post@n4.nabble.com>
Message-ID: <AANLkTi=KzGvLJFwdEh4Cmqjx6wNQ4Rry0Gqqfisz0Fih@mail.gmail.com>

On Fri, Mar 4, 2011 at 9:30 AM, Bogaso <bogaso.christofer at gmail.com> wrote:
> Thanks Gabor for this fix. However I was expecting that the index
> '2011-01-02' would not be there in final "MyData" because in the original
> "MyData" that was not there.
>

I don't think most people would expect that since that is not how R
works, in general.  Consider this example that does not involve zoo.
Here we see that index 11 was assigned to even though its not in the
original object:

> x <- 1:10
> x[8:11] <- NA
> x
 [1]  1  2  3  4  5  6  7 NA NA NA NA

At any rate to set those dates that exist within a window you can use
window like this:

> library(zoo)
> MyData <- zooreg(rnorm(60), start=as.Date("2011-01-01"))[-2]
> window(MyData, start = "2011-01-01", end = "2011-01-03") <- NA
> head(MyData)
2011-01-01 2011-01-03 2011-01-04 2011-01-05 2011-01-06 2011-01-07
        NA         NA  0.8294499 -1.2468697 -0.4004666  1.3487024



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From brian at braverock.com  Fri Mar  4 15:58:44 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 04 Mar 2011 08:58:44 -0600
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
In-Reply-To: <1299249006995-3335323.post@n4.nabble.com>
References: <1299237008213-3335062.post@n4.nabble.com>	<AANLkTi=PVbzjbP8x133=zyFS0dPtXGRUyhW-L4-KJdHr@mail.gmail.com>
	<1299249006995-3335323.post@n4.nabble.com>
Message-ID: <4D70FE24.8030307@braverock.com>

On 03/04/2011 08:30 AM, Bogaso wrote:
> Thanks Gabor for this fix. However I was expecting that the index
> '2011-01-02' would not be there in final "MyData" because in the original
> "MyData" that was not there.
>
> Any idea on how to make this thing better?
>
> Thanks and regards,

You create an index, and force it to NA.  how is R supposed to know that 
you didn't mean to do precisely what you tell it to do?


From jeffrey.ryan at lemnica.com  Fri Mar  4 16:19:15 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 4 Mar 2011 09:19:15 -0600
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
In-Reply-To: <1299237008213-3335062.post@n4.nabble.com>
References: <1299237008213-3335062.post@n4.nabble.com>
Message-ID: <AANLkTinhENAF+9r-KY0x2dagZwKfQ-MzROvu1XFzBYoT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110304/2a6ca3c4/attachment.pl>

From jeffrey.ryan at lemnica.com  Fri Mar  4 16:23:19 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 4 Mar 2011 09:23:19 -0600
Subject: [R-SIG-Finance] Replacing some observation of a zoo object
In-Reply-To: <AANLkTinhENAF+9r-KY0x2dagZwKfQ-MzROvu1XFzBYoT@mail.gmail.com>
References: <1299237008213-3335062.post@n4.nabble.com>
	<AANLkTinhENAF+9r-KY0x2dagZwKfQ-MzROvu1XFzBYoT@mail.gmail.com>
Message-ID: <AANLkTimsTN1H-yMXHYaNP-PduEu7KjWBUu2argPh5=cB@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110304/0b7c8f86/attachment.pl>

From wjlee2002 at naver.com  Sun Mar  6 06:11:27 2011
From: wjlee2002 at naver.com (=?UTF-8?B?7J207JuQ7J6s?=)
Date: Sun, 6 Mar 2011 14:11:27 +0900
Subject: [R-SIG-Finance] =?utf-8?q?How_to_disable_multi-lanuage_functional?=
	=?utf-8?q?ity?=
In-Reply-To: <AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>
References: <1295470206311-3225448.post@n4.nabble.com>
	<AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>
Message-ID: <9c0e0bca8a6a96117ed3445a330c132d@tweb12-2.nm>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110306/48b2f71c/attachment.pl>

From matthieu.stigler at gmail.com  Sun Mar  6 11:43:46 2011
From: matthieu.stigler at gmail.com (mat)
Date: Sun, 6 Mar 2011 11:43:46 +0100
Subject: [R-SIG-Finance] How to disable multi-lanuage functionality
In-Reply-To: <9c0e0bca8a6a96117ed3445a330c132d@tweb12-2.nm>
References: <1295470206311-3225448.post@n4.nabble.com>	<AC7102C5-FDCE-4670-B582-7EA1C9D83E7A@gmail.com>
	<9c0e0bca8a6a96117ed3445a330c132d@tweb12-2.nm>
Message-ID: <4D736562.5090101@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110306/975aee36/attachment.pl>

From judy0302 at yeah.net  Sun Mar  6 14:09:21 2011
From: judy0302 at yeah.net (Judy PENG)
Date: Sun, 6 Mar 2011 21:09:21 +0800 (CST)
Subject: [R-SIG-Finance] R-SIG-Finance Digest, Vol 82,
 Issue 6 + How to disable multi-lanuage functionality
In-Reply-To: <mailman.3.1299409201.2799.r-sig-finance@r-project.org>
References: <mailman.3.1299409201.2799.r-sig-finance@r-project.org>
Message-ID: <66d3ae60.1cf5.12e8b49533a.Coremail.judy0302@yeah.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110306/5ef40446/attachment.pl>

From eric.thungstrom at gmail.com  Tue Mar  8 04:50:09 2011
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Mon, 7 Mar 2011 22:50:09 -0500
Subject: [R-SIG-Finance] Quantmod question
Message-ID: <AANLkTin_-C=y9wSHJRb+o_28wnBajWGOJDyXOVMTc3W=@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110307/bee42da3/attachment.pl>

From jeffrey.ryan at lemnica.com  Tue Mar  8 04:57:39 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 7 Mar 2011 21:57:39 -0600
Subject: [R-SIG-Finance] Quantmod question
In-Reply-To: <AANLkTin_-C=y9wSHJRb+o_28wnBajWGOJDyXOVMTc3W=@mail.gmail.com>
References: <AANLkTin_-C=y9wSHJRb+o_28wnBajWGOJDyXOVMTc3W=@mail.gmail.com>
Message-ID: <AANLkTimvAg4fn==fA9eN91Oau31K=CsU6wtqdu+xKvT-@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110307/b5c6abee/attachment.pl>

From daniel.cegielka at gmail.com  Tue Mar  8 11:54:11 2011
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Tue, 8 Mar 2011 11:54:11 +0100
Subject: [R-SIG-Finance] Quantmod question
In-Reply-To: <AANLkTin_-C=y9wSHJRb+o_28wnBajWGOJDyXOVMTc3W=@mail.gmail.com>
References: <AANLkTin_-C=y9wSHJRb+o_28wnBajWGOJDyXOVMTc3W=@mail.gmail.com>
Message-ID: <AANLkTi=+++NdVKAmmHRq_c3iYE_70qNBQrWrthntnW0M@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110308/305bde25/attachment.pl>

From mane.desk at googlemail.com  Tue Mar  8 18:24:38 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Tue, 8 Mar 2011 18:24:38 +0100
Subject: [R-SIG-Finance] basket of trading systems (blotter, quantstrat)
Message-ID: <4D766656.1080701@gmail.com>

Hello all,

I'm wondering what the best portfolio / account structure would be if 
one works with a basket of trading
systems.  I'm not sure the term "trading system" is clearly defined, so 
for me the
following are different trading systems (TS):

* strategy_A + Financialnstrument_A + frequency_A
* strategy_B + Financialnstrument_A + frequency_A
* strategy_A + Financialnstrument_B + frequency_A
* strategy_A + Financialnstrument_A + frequency_B

I want to access endEq, trades individually for each TS. I need access 
during the execution of the
TS to adjust orderqty etc.
What is the best way to do this in blotter / quantstrat?
Should I construct a portfolio object for each TS or are there other 
options?

thanks & regards,
Immanuel


From mjazzr at cfl.rr.com  Wed Mar  9 13:29:55 2011
From: mjazzr at cfl.rr.com (Michael Radi)
Date: Wed, 9 Mar 2011 07:29:55 -0500
Subject: [R-SIG-Finance] How can you align a timeSeries so that only the
	last day of each month appears without weekends?
Message-ID: <007f01cbde55$b2759d70$1760d850$@rr.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110309/e9fc4979/attachment.pl>

From pcavatore at gmail.com  Thu Mar 10 10:37:46 2011
From: pcavatore at gmail.com (Paolo Cavatore)
Date: Thu, 10 Mar 2011 10:37:46 +0100
Subject: [R-SIG-Finance] getting percentiles by factor
Message-ID: <AANLkTimzf13Ehxt-A2NHUramYM-tQH-rn7zSfrTCm0ZD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110310/9d39ad2d/attachment.pl>

From hesen.peng at gmail.com  Thu Mar 10 15:29:09 2011
From: hesen.peng at gmail.com (Hesen Peng)
Date: Thu, 10 Mar 2011 09:29:09 -0500
Subject: [R-SIG-Finance] getting percentiles by factor
In-Reply-To: <AANLkTimzf13Ehxt-A2NHUramYM-tQH-rn7zSfrTCm0ZD@mail.gmail.com>
References: <AANLkTimzf13Ehxt-A2NHUramYM-tQH-rn7zSfrTCm0ZD@mail.gmail.com>
Message-ID: <AANLkTik44UhGGp3PwvNa1EPXp2vN44p4ZmQs6QurTQPv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110310/c8acdf13/attachment.pl>

From pcavatore at gmail.com  Thu Mar 10 17:09:26 2011
From: pcavatore at gmail.com (Paolo Cavatore)
Date: Thu, 10 Mar 2011 17:09:26 +0100
Subject: [R-SIG-Finance] getting percentiles by factor
In-Reply-To: <AANLkTik44UhGGp3PwvNa1EPXp2vN44p4ZmQs6QurTQPv@mail.gmail.com>
References: <AANLkTimzf13Ehxt-A2NHUramYM-tQH-rn7zSfrTCm0ZD@mail.gmail.com>
	<AANLkTik44UhGGp3PwvNa1EPXp2vN44p4ZmQs6QurTQPv@mail.gmail.com>
Message-ID: <AANLkTinkSPfPzA=vFOC4=ee7iCcawrb6MRJePFuBusY3@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110310/cd21994e/attachment.pl>

From pcavatore at gmail.com  Thu Mar 10 17:11:13 2011
From: pcavatore at gmail.com (Paolo Cavatore)
Date: Thu, 10 Mar 2011 17:11:13 +0100
Subject: [R-SIG-Finance] getting percentiles by factor
In-Reply-To: <AANLkTinkSPfPzA=vFOC4=ee7iCcawrb6MRJePFuBusY3@mail.gmail.com>
References: <AANLkTimzf13Ehxt-A2NHUramYM-tQH-rn7zSfrTCm0ZD@mail.gmail.com>
	<AANLkTik44UhGGp3PwvNa1EPXp2vN44p4ZmQs6QurTQPv@mail.gmail.com>
	<AANLkTinkSPfPzA=vFOC4=ee7iCcawrb6MRJePFuBusY3@mail.gmail.com>
Message-ID: <AANLkTi=SZs1TFJ3t=s+ho=KPpBQ22Cv8mOQg2bZcx15B@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110310/e6eaf4e0/attachment.pl>

From hesen.peng at gmail.com  Thu Mar 10 18:19:07 2011
From: hesen.peng at gmail.com (Hesen Peng)
Date: Thu, 10 Mar 2011 12:19:07 -0500
Subject: [R-SIG-Finance] getting percentiles by factor
In-Reply-To: <AANLkTinkSPfPzA=vFOC4=ee7iCcawrb6MRJePFuBusY3@mail.gmail.com>
References: <AANLkTimzf13Ehxt-A2NHUramYM-tQH-rn7zSfrTCm0ZD@mail.gmail.com>
	<AANLkTik44UhGGp3PwvNa1EPXp2vN44p4ZmQs6QurTQPv@mail.gmail.com>
	<AANLkTinkSPfPzA=vFOC4=ee7iCcawrb6MRJePFuBusY3@mail.gmail.com>
Message-ID: <AANLkTimZJUjX3G6ps_SbHWOH5a2Bkn5Z01wM7jS5Mt_9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110310/ad165762/attachment.pl>

From eric.thungstrom at gmail.com  Fri Mar 11 03:34:33 2011
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Thu, 10 Mar 2011 21:34:33 -0500
Subject: [R-SIG-Finance] Generating Monthly Return Info
Message-ID: <AANLkTikFYQe9OEHXxb6EJcT35zKdUYh16M-W4KseCi9-@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110310/f2db6b71/attachment.pl>

From peter at braverock.com  Fri Mar 11 05:43:46 2011
From: peter at braverock.com (Peter Carl)
Date: Thu, 10 Mar 2011 22:43:46 -0600
Subject: [R-SIG-Finance] Generating Monthly Return Info
In-Reply-To: <AANLkTikFYQe9OEHXxb6EJcT35zKdUYh16M-W4KseCi9-@mail.gmail.com>
References: <AANLkTikFYQe9OEHXxb6EJcT35zKdUYh16M-W4KseCi9-@mail.gmail.com>
Message-ID: <4a86956418ce152efe18994fe2b79cc2.squirrel@mail.braverock.com>

?to.monthly
-- 
Peter Carl
http://www.braverock.com/~peter

> Newbie just learning.
>
> Trying to figure out how I generate monthly returns information. I have
> daily returns and daily equity for a trading system over a 10 year period
> in
> an xts format. I'd like to collapse the daily data into monthly data. In
> addition, I'd like to be able to create a table of monthly returns by
> year.
> I tried table.CalendarReturns() in the PerfomanceAnalytics package but it
> seems like it needs monthly returns as the input.
>
> Suggestions ?
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From jeff.a.ryan at gmail.com  Fri Mar 11 06:40:46 2011
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 10 Mar 2011 23:40:46 -0600
Subject: [R-SIG-Finance] Generating Monthly Return Info
In-Reply-To: <4a86956418ce152efe18994fe2b79cc2.squirrel@mail.braverock.com>
References: <AANLkTikFYQe9OEHXxb6EJcT35zKdUYh16M-W4KseCi9-@mail.gmail.com>
	<4a86956418ce152efe18994fe2b79cc2.squirrel@mail.braverock.com>
Message-ID: <998AE70F-0635-429E-8E2D-D3101912A4A1@gmail.com>

See also ?periodReturn and monthlyReturn in the quantmod package.

Best,
Jeff



On Mar 10, 2011, at 10:43 PM, "Peter Carl" <peter at braverock.com> wrote:

> ?to.monthly
> -- 
> Peter Carl
> http://www.braverock.com/~peter
> 
>> Newbie just learning.
>> 
>> Trying to figure out how I generate monthly returns information. I have
>> daily returns and daily equity for a trading system over a 10 year period
>> in
>> an xts format. I'd like to collapse the daily data into monthly data. In
>> addition, I'd like to be able to create a table of monthly returns by
>> year.
>> I tried table.CalendarReturns() in the PerfomanceAnalytics package but it
>> seems like it needs monthly returns as the input.
>> 
>> Suggestions ?
>> 
>>    [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>> 
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From eric.thungstrom at gmail.com  Sat Mar 12 02:05:24 2011
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Fri, 11 Mar 2011 20:05:24 -0500
Subject: [R-SIG-Finance] Generating Monthly Return Info
In-Reply-To: <4a86956418ce152efe18994fe2b79cc2.squirrel@mail.braverock.com>
References: <AANLkTikFYQe9OEHXxb6EJcT35zKdUYh16M-W4KseCi9-@mail.gmail.com>
	<4a86956418ce152efe18994fe2b79cc2.squirrel@mail.braverock.com>
Message-ID: <AANLkTimaBYs=hKb=0hmDXFdrRwtbntjWTLoEjYDtD+io@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110311/92500738/attachment.pl>

From johnmu at uj.ac.za  Sat Mar 12 14:37:14 2011
From: johnmu at uj.ac.za (johnmwamba)
Date: Sat, 12 Mar 2011 05:37:14 -0800
Subject: [R-SIG-Finance] R Package for Backtesing VaR Estimates
Message-ID: <1299937034536-3350219.post@n4.nabble.com>

Hi everybody'
I have VaR estimates computed with different methodologies using
PerformanceAnalytics package. I divided my sample space into two - the
in-sample and the out-sample. I now want to backtest my VaR estimates in the
out-sample space; using for example the number of exceedances (i.e. truely
observed losses that are greater than the VaR estimates in that out-sample
space). Is there any package I can use? 
Thank you very much for helping


--
View this message in context: http://r.789695.n4.nabble.com/R-Package-for-Backtesing-VaR-Estimates-tp3350219p3350219.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From peter at braverock.com  Sat Mar 12 14:57:01 2011
From: peter at braverock.com (Peter Carl)
Date: Sat, 12 Mar 2011 07:57:01 -0600
Subject: [R-SIG-Finance] Generating Monthly Return Info
In-Reply-To: <AANLkTimaBYs=hKb=0hmDXFdrRwtbntjWTLoEjYDtD+io@mail.gmail.com>
References: <AANLkTikFYQe9OEHXxb6EJcT35zKdUYh16M-W4KseCi9-@mail.gmail.com>
	<4a86956418ce152efe18994fe2b79cc2.squirrel@mail.braverock.com>
	<AANLkTimaBYs=hKb=0hmDXFdrRwtbntjWTLoEjYDtD+io@mail.gmail.com>
Message-ID: <36a6d63734ed577781335b9d697ce09a.squirrel@mail.braverock.com>

Right, you have to convert the daily returns to a cumulative series or
"wealth index" before using to.monthly on that index.  Then you can
calculate monthly returns using the 'Close' column.

HTH,

pcc
-- 
Peter Carl
http://www.braverock.com/~peter

> I tried to.monthly but it simply outputs the OHLC of the daily returns for
> the month. I'm looking for the consolidated monthly return. For example,
> f1
> is the xls object. f1$Rtrns is the daily returns. Here are the daily
> returns
> for March:
>
> 2011-03-01 -0.01573
> 2011-03-02  0.00159
> 2011-03-03  0.01722
> 2011-03-04 -0.00737
> 2011-03-07 -0.00832
> 2011-03-08  0.00892
> 2011-03-09 -0.00136
> 2011-03-10 -0.01885
>
> So, if I try to.monthly(f1$Rtrns), the march values I get back are:
>
> Mar 2011        -0.01573         0.01722       -0.01885         -0.01885
>
> Those numbers are simply the OHLC of the daily returns. I'm looking for
> the
> total return for March. Actually, I'm looking for a consolidated table of
> total returns by month. I'm just using march as an example.
>
>
>
> On Thu, Mar 10, 2011 at 11:43 PM, Peter Carl <peter at braverock.com> wrote:
>
>> ?to.monthly
>> --
>> Peter Carl
>> http://www.braverock.com/~peter
>>
>> > Newbie just learning.
>> >
>> > Trying to figure out how I generate monthly returns information. I
>> have
>> > daily returns and daily equity for a trading system over a 10 year
>> period
>> > in
>> > an xts format. I'd like to collapse the daily data into monthly data.
>> In
>> > addition, I'd like to be able to create a table of monthly returns by
>> > year.
>> > I tried table.CalendarReturns() in the PerfomanceAnalytics package but
>> it
>> > seems like it needs monthly returns as the input.
>> >
>> > Suggestions ?
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R
>> questions
>> > should go.
>> >
>>
>>
>>
>


From alexios at 4dscape.com  Sat Mar 12 15:35:12 2011
From: alexios at 4dscape.com (alexios ghalanos)
Date: Sat, 12 Mar 2011 14:35:12 +0000
Subject: [R-SIG-Finance] R Package for Backtesing VaR Estimates
In-Reply-To: <1299937034536-3350219.post@n4.nabble.com>
References: <1299937034536-3350219.post@n4.nabble.com>
Message-ID: <1299940512.12336.9.camel@Metis>

The rgarch package (on r-forge) implements (but does not export) the
exceedance tests of Kupiec ( unconditional ) and Christoffersen
( conditional ).

You can call it as follows:
rgarch:::.VaRreport("", "", "", p, actual, VaR, conf.level = 0.95)

where "p" is the quantile used (e.g. 0.05), "VaR" the actual predicted
VaR vector, and "actual" the realized returns vector.

For a more general test on the predictive distribution have a look at
the 'BerkowitzLR' function which is exported.

Regards,

Alexios Ghalanos



On Sat, 2011-03-12 at 05:37 -0800, johnmwamba wrote:
> Hi everybody'
> I have VaR estimates computed with different methodologies using
> PerformanceAnalytics package. I divided my sample space into two - the
> in-sample and the out-sample. I now want to backtest my VaR estimates in the
> out-sample space; using for example the number of exceedances (i.e. truely
> observed losses that are greater than the VaR estimates in that out-sample
> space). Is there any package I can use? 
> Thank you very much for helping
> 
> 
> --
> View this message in context: http://r.789695.n4.nabble.com/R-Package-for-Backtesing-VaR-Estimates-tp3350219p3350219.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From tmuhlhof at indiana.edu  Sat Mar 12 18:02:30 2011
From: tmuhlhof at indiana.edu (Tobias Muhlhofer)
Date: Sat, 12 Mar 2011 12:02:30 -0500
Subject: [R-SIG-Finance] Generating Monthly Return Info (Eric Thungstom)
In-Reply-To: <AANLkTinHQfSv+Unvo3nP+eWcK8DjK+N=wpPQ5dRyZDgB@mail.gmail.com>
References: <AANLkTinHQfSv+Unvo3nP+eWcK8DjK+N=wpPQ5dRyZDgB@mail.gmail.com>
Message-ID: <AANLkTikfv2iwLvXzNhu3TpK4Dmvw3VsGEZLL_ObTYNPq@mail.gmail.com>

Eric:

Why not do it by hand, using aggregate()? Let's say dset is your
data.frame of daily returns, with the return variable called ret and
the date variable called date. Make sure the date variable has class
Date.

> dset$month <- format(dset$date, format="%m")  ## This generates a month variable
> dset$year <- format(dset$date, format="%Y") ## This generates a year variable
> dset.monthly <- aggregate(1+dset$ret, by=list(year=dset$year, month=dset$month), FUN=prod, na.rm=TRUE)
> dset.monthly$x <- dset.monthly$x - 1

Done!

I do digest only for this list, so may be slow responding to further questions.

Best,
   Toby


From stewart.david.w at gmail.com  Sun Mar 13 19:07:59 2011
From: stewart.david.w at gmail.com (David Stewart)
Date: Sun, 13 Mar 2011 14:07:59 -0400
Subject: [R-SIG-Finance] PerformanceAnalytics Figure 13
Message-ID: <002201cbe1a9$96da4280$c48ec780$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110313/0c2680c7/attachment.pl>

From gmonaie at gmail.com  Mon Mar 14 16:02:03 2011
From: gmonaie at gmail.com (Gei Lin)
Date: Mon, 14 Mar 2011 11:02:03 -0400
Subject: [R-SIG-Finance] Dealing with the futures roll in quantstrat and
	blotter
Message-ID: <AANLkTinoGgLFe9=tv75H6HCOXN8mPyJCvL2r6HkWiTT5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110314/70a3ba33/attachment.pl>

From brian at braverock.com  Mon Mar 14 16:35:24 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 14 Mar 2011 10:35:24 -0500
Subject: [R-SIG-Finance] Dealing with the futures roll in quantstrat and
 blotter
In-Reply-To: <AANLkTinoGgLFe9=tv75H6HCOXN8mPyJCvL2r6HkWiTT5@mail.gmail.com>
References: <AANLkTinoGgLFe9=tv75H6HCOXN8mPyJCvL2r6HkWiTT5@mail.gmail.com>
Message-ID: <4D7E35BC.7020409@braverock.com>

On 03/14/2011 10:02 AM, Gei Lin wrote:
> Has anyone dealt with rolling futures in the quantstrat and blotter
> framework?

Yes,  we roll products manually.

The 'best' approach is probably to construct some sort of continuous 
series that implements whatever rules you use (roll calendar, volume 
cross, whatever).

Robert Sams wrote splicing functions, but they assume univariate data, 
and have not been ported to handle multi-column data (e.g. OHLC or TBBO 
data) for each instrument.

Any assistance or contributions on the splicing front would be gladly 
accepted.

> I am working on an event based strategy -- the eventIndicators function just
> returns a whole list of events in xts format (values = 1) that coincide with
> the index datetimes of the mktdata
>
> # add the event indicators
> stratEvent<- add.indicator(strategy = stratEvent, name = "eventIndicators",
> arguments = list(price = quote(getPrice(mktdata))))
>
> I then add rules for entry and exit based on the event column being true:
>
> stratEvent<- add.rule(stratEvent, name='ruleSignal', arguments =
> list(sigcol="MEm1"),sigval=TRUE, orderqty=100, ordertype= 'market',
> orderside=NULL, threshold=NULL),type='enter')
>
> I would like to have this strategy applied to a futures contract based on a
> specified rolling convention (e.g. if<  2 days before first notice of
> delivery, trade the 2nd contract, otherwise trade the 1st e.g. TY2 Comdty
> versus TY1 Comdty).
>
> I would like to apply this strategy to 1 portfolio covering multiple decades
> of data of closing price data with the whole futures chain.  I'm not sure
> how to call applyStrategy to get the result I want when the instrument the
> strategy is trading changes over time.

I would construct a continuous series first, then add an instrument for 
that continuous series to your portfolio, and test your strategy using 
the continuous series information.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From gmonaie at gmail.com  Mon Mar 14 16:56:45 2011
From: gmonaie at gmail.com (Gei Lin)
Date: Mon, 14 Mar 2011 11:56:45 -0400
Subject: [R-SIG-Finance] Dealing with the futures roll in quantstrat and
	blotter
In-Reply-To: <4D7E35BC.7020409@braverock.com>
References: <AANLkTinoGgLFe9=tv75H6HCOXN8mPyJCvL2r6HkWiTT5@mail.gmail.com>
	<4D7E35BC.7020409@braverock.com>
Message-ID: <AANLkTinXD+aeLQU9W4JvHyOSyd0qN53g6Zw=B8XH7__j@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110314/c2efe473/attachment.pl>

From brian at braverock.com  Mon Mar 14 18:06:14 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 14 Mar 2011 12:06:14 -0500
Subject: [R-SIG-Finance] Dealing with the futures roll in quantstrat and
 blotter
In-Reply-To: <AANLkTinXD+aeLQU9W4JvHyOSyd0qN53g6Zw=B8XH7__j@mail.gmail.com>
References: <AANLkTinoGgLFe9=tv75H6HCOXN8mPyJCvL2r6HkWiTT5@mail.gmail.com>	<4D7E35BC.7020409@braverock.com>
	<AANLkTinXD+aeLQU9W4JvHyOSyd0qN53g6Zw=B8XH7__j@mail.gmail.com>
Message-ID: <4D7E4B06.2050206@braverock.com>

On 03/14/2011 10:56 AM, Gei Lin wrote:
> My issue with one continuous series is that the spliced series does not
> reflect actual performance on the roll date.  There is an inherent drop in
> price from one contract to the next that if the strategy holds over the
> roll.  What's need is a rolled performance series, and but in that case,
> rolled performance is what is being traded and not prices, resulting in an
> orderBook this can't be directly piped to or compared to a real life order
> management system.
>
> I would like to actually simulate trading the roll within the blotter rather
> than mask it away with a shortcut.  I suppose this can be done by setting up
> different portfolios with the set of tradeable symbols for each time frame
> and lopping calls to applyStrategy for each portfolio?

Sorry, I didn't understand what you were getting at, specifically.

Yes.  You've got the right idea.  You don't need to separate them into 
different portfolios if you subset your price data first, wince 
quantstrat will loop over symbols anyway.

I'd probably do something like this:
- create all the future_series instruments

- create a portfolio with all these instruments in it,
   in order of expiration

- construct your roll calendar

- subset your data for each instrument based on the roll calendar

- build your strategy

- make sure the strategy knows to 'get flat' on
   the last day of the data series for each instrument

- call applyStrategy

There are other ways to do this, but this seems the simplest, and 
doesn't require any code changes.

Regards,

    - Brian


> On Mon, Mar 14, 2011 at 11:35 AM, Brian G. Peterson<brian at braverock.com>wrote:
>
>> On 03/14/2011 10:02 AM, Gei Lin wrote:
>>
>>> Has anyone dealt with rolling futures in the quantstrat and blotter
>>> framework?
>>>
>>
>> Yes,  we roll products manually.
>>
>> The 'best' approach is probably to construct some sort of continuous series
>> that implements whatever rules you use (roll calendar, volume cross,
>> whatever).
>>
>> Robert Sams wrote splicing functions, but they assume univariate data, and
>> have not been ported to handle multi-column data (e.g. OHLC or TBBO data)
>> for each instrument.
>>
>> Any assistance or contributions on the splicing front would be gladly
>> accepted.
>>
>>
>>   I am working on an event based strategy -- the eventIndicators function
>>> just
>>> returns a whole list of events in xts format (values = 1) that coincide
>>> with
>>> the index datetimes of the mktdata
>>>
>>> # add the event indicators
>>> stratEvent<- add.indicator(strategy = stratEvent, name =
>>> "eventIndicators",
>>> arguments = list(price = quote(getPrice(mktdata))))
>>>
>>> I then add rules for entry and exit based on the event column being true:
>>>
>>> stratEvent<- add.rule(stratEvent, name='ruleSignal', arguments =
>>> list(sigcol="MEm1"),sigval=TRUE, orderqty=100, ordertype= 'market',
>>> orderside=NULL, threshold=NULL),type='enter')
>>>
>>> I would like to have this strategy applied to a futures contract based on
>>> a
>>> specified rolling convention (e.g. if<   2 days before first notice of
>>> delivery, trade the 2nd contract, otherwise trade the 1st e.g. TY2 Comdty
>>> versus TY1 Comdty).
>>>
>>> I would like to apply this strategy to 1 portfolio covering multiple
>>> decades
>>> of data of closing price data with the whole futures chain.  I'm not sure
>>> how to call applyStrategy to get the result I want when the instrument the
>>> strategy is trading changes over time.
>>>
>>
>> I would construct a continuous series first, then add an instrument for
>> that continuous series to your portfolio, and test your strategy using the
>> continuous series information.
>>
>> Regards,
>>
>>   - Brian
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph:<773-459-4973>773-459-4973
>> IM: bgpbraverock
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jeff.a.ryan at gmail.com  Mon Mar 14 22:04:42 2011
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 14 Mar 2011 16:04:42 -0500
Subject: [R-SIG-Finance] R/Finance 2011 Registration Now Open!
Message-ID: <AANLkTinAw5OkB9dvJJJMzvnrZS0+XqqJS-zfRVMy+xVB@mail.gmail.com>

The registration for R/Finance 2011---which will take place April 29
and 30 in Chicago--is NOW OPEN!

Building on the success of the two previous conferences in 2009 and
2010, we are expecting more than 250 attendees from around the world
representing both industry and academia to join a record 30+
presentations covering all areas of finance with R.

This year we are excited to have longer tutorial sessions and an
optional full-day workshop on the Thursday before the conference. In
addition, we have worked hard to extend the great networking
opportunities on both days with longer breaks and more hallway time
between sessions.

New for 2011 is a special conference dinner that is held on Friday
evening. Overlooking the river from the famed Chicago Mercantile
Exchange, we have designed it to be a great way to continue the
conversations from the first day, as well as offering a chance to dine
and drink in Chicago style.

More details of the agenda are available at:

 http://www.RinFinance.com

Registration can be directly accessed by going to

 http://www.regonline.com/RinFinance2011

On behalf of the committee and sponsors, we look forward to seeing you
in Chicago!

 Gib Bassett, Peter Carl, Dirk Eddelbuettel, Brian Peterson,
 Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich

Sponsors:
International Center for Futures and Derivatives at UIC
Revolution Analytics

Rstudio
One Market Data
lemnica


From yilihome at gmail.com  Tue Mar 15 11:14:19 2011
From: yilihome at gmail.com (Li Yi)
Date: Tue, 15 Mar 2011 18:14:19 +0800
Subject: [R-SIG-Finance] RBloomberg -- Error in dimnames(x) <- dn :
	'dimnames' applied to non-array
Message-ID: <AANLkTik=Ao59nR8sXD4BiSuQn-cXjyZbmdCkFPAj9--5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110315/0e8c0d36/attachment.pl>

From mane.desk at googlemail.com  Tue Mar 15 11:23:16 2011
From: mane.desk at googlemail.com (Immanuel)
Date: Tue, 15 Mar 2011 11:23:16 +0100
Subject: [R-SIG-Finance] basket of trading systems (blotter, quantstrat)
Message-ID: <4D7F3E14.6090902@gmail.com>

Hello all,

I'm wondering what the best portfolio / account structure would be if 
one works with a basket of trading
systems.  I'm not sure the term "trading system" is clearly defined, so 
for me the
following are different trading systems (TS):

* strategy_A + Financialnstrument_A + frequency_A
* strategy_B + Financialnstrument_A + frequency_A
* strategy_A + Financialnstrument_B + frequency_A
* strategy_A + Financialnstrument_A + frequency_B

I want to access endEq, trades P/L individually for each TS. I need 
access to this information during the execution of the
TS to adjust orderqty etc.
What is the best way to do this in blotter / quantstrat?
Should I construct a portfolio object for each TS or are there other 
options? (I'm not asking for code, just the big picture on how to 
approach this)

thanks & regards,
Immanuel


From brian at braverock.com  Tue Mar 15 12:49:02 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 15 Mar 2011 06:49:02 -0500
Subject: [R-SIG-Finance] basket of trading systems (blotter, quantstrat)
In-Reply-To: <4D7F3E14.6090902@gmail.com>
References: <4D7F3E14.6090902@gmail.com>
Message-ID: <4D7F522E.5020306@braverock.com>

On 03/15/2011 05:23 AM, Immanuel wrote:
> Hello all,
>
> I'm wondering what the best portfolio / account structure would be if
> one works with a basket of trading
> systems. I'm not sure the term "trading system" is clearly defined, so
> for me the
> following are different trading systems (TS):
>
> * strategy_A + Financialnstrument_A + frequency_A
> * strategy_B + Financialnstrument_A + frequency_A
> * strategy_A + Financialnstrument_B + frequency_A
> * strategy_A + Financialnstrument_A + frequency_B
>
> I want to access endEq, trades P/L individually for each TS. I need
> access to this information during the execution of the
> TS to adjust orderqty etc.
> What is the best way to do this in blotter / quantstrat?
> Should I construct a portfolio object for each TS or are there other
> options? (I'm not asking for code, just the big picture on how to
> approach this)

Looks like I missed this one a week or so ago.

You are correct that the term 'trading system' is not well defined, in R 
or anywhere else...

If you intend to share account equity across your various 'systems', 
then put them all in the same account.  This mirrors the way your broker 
will calculate account margin.

I can imply from your example that your systems need a combination of 
strategy, instrument, and frequency to make a unique set.  It seems like 
you're over-complicating things here.  'frequency' suggests itself as 
something that should be a parameter for your strategy, but you don't 
provide enough details for me to be sure.

quantstrat will loop over all instruments in a single portfolio by 
default when you call applyStrategy.  If you truly have different sets 
of strategy rules (and not just different parameters to the same 
strategy), then you'll apply these strategies to different portfolios by 
strategy.

At the lowest level, you can put each instrument in its own portfolio. 
We often do this when we are looking for instrument and parameter 
combinations that will work well with a given strategy.

When I see people adjusting order sizing based on account equity, I'm 
always concerned that they don't really understand the risk profile of 
the strategy involved, and are 'betting' capital rather than 'applying' 
capital to a strategy with a known risk profile.  I feel it is better to 
trade a system at the maximum size you can without market impact, 
possibly reduced by periodic *portfolio* rebalancing based on the risks 
of the strategy on each instrument. As such, I tend to discount 
'systems' that need to do account equity based rebalancing frequently.

If you need to do this, then wrap your calls to applyStrategy inside a 
time loop, calling applyStrategy repeatedly (like every day or every 
week or every month) based on your periodic rebalancing frequency.

We will add this type of periodic rebalancing to quantstrat eventually, 
but it's not super high on my priority list.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From worik.stanton at gmail.com  Wed Mar 16 03:47:11 2011
From: worik.stanton at gmail.com (Worik)
Date: Wed, 16 Mar 2011 15:47:11 +1300
Subject: [R-SIG-Finance] plotting vertical lines on months in xyplot
In-Reply-To: <6640D837-86EA-4D86-9419-FA41B5CA395F@moneytree.com>
References: <6640D837-86EA-4D86-9419-FA41B5CA395F@moneytree.com>
Message-ID: <4D8024AF.1000201@gmail.com>

I have a similar problem as Jeff had back in the day.  I want to put a 
vertical line on a plot

There must be a way....

Simple example:

library(xts)
v <- vector()
v[1] <- 10
for(i in 2:100){
   v[i] <- v[i-1]+rnorm(1, 0, 0.01)
}
X <- xts(v, seq(as.Date("2009-01-01"), by=1, length.out=100))
plot(X)

## Try to put a vertical line in....
abline(v=X[50,])
abline(v=50)
abline(v=index(X)[50])



-- 
If we amplify everything, we hear nothing.
--


From jeffrey.ryan at lemnica.com  Wed Mar 16 04:11:37 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 15 Mar 2011 22:11:37 -0500
Subject: [R-SIG-Finance] plotting vertical lines on months in xyplot
In-Reply-To: <4D8024AF.1000201@gmail.com>
References: <6640D837-86EA-4D86-9419-FA41B5CA395F@moneytree.com>
	<4D8024AF.1000201@gmail.com>
Message-ID: <AANLkTinHv337X0SjHaTML+rFcyvnhKSyPwwf0Js9iFT5@mail.gmail.com>

Hi Worik, Jeff,

Try,

abline(v=.index(X)[50], col="red")

Note the "dot" in .index.  The fact is that xts uses the internal
POSIXct(like) time for the x-axis, so you need to access it that way.

HTH
Jeff

On Tue, Mar 15, 2011 at 9:47 PM, Worik <worik.stanton at gmail.com> wrote:
> I have a similar problem as Jeff had back in the day. ?I want to put a
> vertical line on a plot
>
> There must be a way....
>
> Simple example:
>
> library(xts)
> v <- vector()
> v[1] <- 10
> for(i in 2:100){
> ?v[i] <- v[i-1]+rnorm(1, 0, 0.01)
> }
> X <- xts(v, seq(as.Date("2009-01-01"), by=1, length.out=100))
> plot(X)
>
> ## Try to put a vertical line in....
> abline(v=X[50,])
> abline(v=50)
> abline(v=index(X)[50])
>
>
>
> --
> If we amplify everything, we hear nothing.
> --
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com

R/Finance 2011 April 29th and 30th in Chicago
www.RinFinance.com


From josh.m.ulrich at gmail.com  Wed Mar 16 04:27:38 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 15 Mar 2011 22:27:38 -0500
Subject: [R-SIG-Finance] plotting vertical lines on months in xyplot
In-Reply-To: <4D8024AF.1000201@gmail.com>
References: <6640D837-86EA-4D86-9419-FA41B5CA395F@moneytree.com>
	<4D8024AF.1000201@gmail.com>
Message-ID: <AANLkTi=XRwrza6qikiZ9H_qNNx9P16ucb=X5uReVSTNW@mail.gmail.com>

Hi Worik,

I hope this doesn't come across as picky, but I cannot restrain myself
from improving your simple example.

On Tue, Mar 15, 2011 at 9:47 PM, Worik <worik.stanton at gmail.com> wrote:
> I have a similar problem as Jeff had back in the day. ?I want to put a
> vertical line on a plot
>
> There must be a way....
>
> Simple example:
>
> library(xts)
> v <- vector()
> v[1] <- 10
> for(i in 2:100){
> ?v[i] <- v[i-1]+rnorm(1, 0, 0.01)
> }

Growing vectors like this is slow.  rnorm() is vectorized.  Take
advantage of that.
V <- cumsum(c(10,rnorm(99,0,0.01)))

> X <- xts(v, seq(as.Date("2009-01-01"), by=1, length.out=100))
> plot(X)
>
> ## Try to put a vertical line in....
> abline(v=X[50,])
> abline(v=50)
> abline(v=index(X)[50])
>
>
>
> --
> If we amplify everything, we hear nothing.
> --
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


From vlad32 at gmail.com  Wed Mar 16 11:16:40 2011
From: vlad32 at gmail.com (Vladimir Vladimirov)
Date: Wed, 16 Mar 2011 10:16:40 +0000
Subject: [R-SIG-Finance] fOptions and RQuantlib give different vanilla
	option premiums
Message-ID: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>

Dear all,

I was wondering if someone has had similar experience with plain
vanilla European option pricing. I try to compare results using both
package fOptions and RQuantLib for a plain vanilla European option. I
use the example in Haug's Option book given in his intro chapter, it's
also shown in the fOptions package. So fOption gives me the correct
answer, but the EuropeanOption is off by a factor of three and
correspondingly the greeks are off (see below). The interesting thing
is that the wolfram alpha call option valuation gives me the same
result as RQuantlib (i.e. not correct)

http://www.wolframalpha.com/input/?i=call+option

I've tried this with other currency options and Bloomberg and
Superderivatives give me option premiums in line with what I get from
fOptions, don't understand how could I be getting different results
from RQuantLib and Wolfram Alpha. These are closed-form solutions for
plain vanilla, how come there be so much discrepancy in the results.
What am I missing?

Thank you in advance for the help.

-Vlad


library(fOptions)
library(RQuantLib)

> EuropeanOption(type="call", underlying=1.56, strike=1.6, dividendYield=0.06-0.08, riskFreeRate=0.06, maturity=1/2, volatility=0.12)
Concise summary of valuation for EuropeanOption
  value   delta   gamma    vega   theta     rho  divRho
 0.0652  0.5912  2.9743  0.4343 -0.1220  0.4285 -0.4611

> GBSCharacteristics(TypeFlag = "c", S = 1.5600, X = 1.6000,  Time = 1/2, r = 0.06, b = 0.06-0.08, sigma = 0.12)
$premium
[1] 0.02909931
$delta
[1] 0.3403860
$theta
[1] -0.03494785
$vega
[1] 0.3942821
$rho
[1] 0.2509514
$lambda
[1] 18.24793
$gamma
[1] 2.700266


From adrian at trapletti.org  Wed Mar 16 12:10:23 2011
From: adrian at trapletti.org (Adrian Trapletti)
Date: Wed, 16 Mar 2011 12:10:23 +0100
Subject: [R-SIG-Finance] get.hist.quote
In-Reply-To: <4CDC3BB7-6D09-4C52-85CE-3ED343E9B2E1@datamininglab.com>
References: <4CDC3BB7-6D09-4C52-85CE-3ED343E9B2E1@datamininglab.com>
Message-ID: <4D809A9F.3050305@trapletti.org>

Hi William,

Thank you for you report. I am using get.hist.quote only very 
infrequently. I don't know the difference between chart and ichart. 
Maybe somebody from the R community may help?

Best regards
Adrian

William Proffitt wrote:
> Hello Adrian,
>
> I was using get.hist.quote to download some historical stock data from 
> Yahoo, and I encountered a problem when trying to get data on the 
> stock SBAY. R was trying to download a .csv from this 
> <http://chart.yahoo.com/table.csv?s=SBAY&a=0&b=02&c=1991&d=2&e=14&f=2011&g=d&q=q&y=0&z=SBAY&x=.csv> link 
> and was failing with a 404 for no apparent reason. 
>
> Yahoo has data on SBAY, and it can be accessed by going to 
> finance.yahoo.com <http://finance.yahoo.com>, typing in SBAY, then 
> clicking on "historical prices," where it can then be downloaded as a 
> csv. The domain of the URL for this csv is ichart.finance.yahoo.com 
> <http://ichart.finance.yahoo.com> rather than chart.yahoo.com 
> <http://chart.yahoo.com>, though.
>
> I changed get.hist.quote to use this domain for its links and it 
> performed just as well as before on every other stock I tried, and it 
> also worked correctly on SBAY. Do you know if there is any difference 
> between the two URL formats aside from SBAY not working on 
> chart.yahoo.com <http://chart.yahoo.com>? Should get.hist.quote use 
> ichart.finance.yahoo.com <http://ichart.finance.yahoo.com> instead?
>
> William Proffitt
> www.datamininglab.com <http://www.datamininglab.com>

-- 
Adrian Trapletti
Steinstrasse 9b
8610 Uster
Switzerland

Phone : +41 (0) 44 9945630
Mobile : +41 (0) 76 3705631

Email : adrian at trapletti.org


From enricoschumann at yahoo.de  Wed Mar 16 12:26:51 2011
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Wed, 16 Mar 2011 12:26:51 +0100
Subject: [R-SIG-Finance] fOptions and RQuantlib give different
	vanillaoption premiums
In-Reply-To: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>
References: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>
Message-ID: <9B23AF73DE7F48CCAB72BE59D7CD7822@EnricosPC>

the cost-of-carry b in fOptions/Haug's book is not the same as the dividend
yield. try with a dividend yield of 0.08 in RQuantLib.

regards,
enrico



> -----Urspr?ngliche Nachricht-----
> Von: r-sig-finance-bounces at r-project.org 
> [mailto:r-sig-finance-bounces at r-project.org] Im Auftrag von 
> Vladimir Vladimirov
> Gesendet: Mittwoch, 16. M?rz 2011 11:17
> An: r-sig-finance at r-project.org
> Betreff: [R-SIG-Finance] fOptions and RQuantlib give 
> different vanillaoption premiums
> 
> Dear all,
> 
> I was wondering if someone has had similar experience with 
> plain vanilla European option pricing. I try to compare 
> results using both package fOptions and RQuantLib for a plain 
> vanilla European option. I use the example in Haug's Option 
> book given in his intro chapter, it's also shown in the 
> fOptions package. So fOption gives me the correct answer, but 
> the EuropeanOption is off by a factor of three and 
> correspondingly the greeks are off (see below). The 
> interesting thing is that the wolfram alpha call option 
> valuation gives me the same result as RQuantlib (i.e. not correct)
> 
> http://www.wolframalpha.com/input/?i=call+option
> 
> I've tried this with other currency options and Bloomberg and 
> Superderivatives give me option premiums in line with what I 
> get from fOptions, don't understand how could I be getting 
> different results from RQuantLib and Wolfram Alpha. These are 
> closed-form solutions for plain vanilla, how come there be so 
> much discrepancy in the results.
> What am I missing?
> 
> Thank you in advance for the help.
> 
> -Vlad
> 
> 
> library(fOptions)
> library(RQuantLib)
> 
> > EuropeanOption(type="call", underlying=1.56, strike=1.6, 
> > dividendYield=0.06-0.08, riskFreeRate=0.06, maturity=1/2, 
> > volatility=0.12)
> Concise summary of valuation for EuropeanOption
>   value   delta   gamma    vega   theta     rho  divRho
>  0.0652  0.5912  2.9743  0.4343 -0.1220  0.4285 -0.4611
> 
> > GBSCharacteristics(TypeFlag = "c", S = 1.5600, X = 1.6000,  Time = 
> > 1/2, r = 0.06, b = 0.06-0.08, sigma = 0.12)
> $premium
> [1] 0.02909931
> $delta
> [1] 0.3403860
> $theta
> [1] -0.03494785
> $vega
> [1] 0.3942821
> $rho
> [1] 0.2509514
> $lambda
> [1] 18.24793
> $gamma
> [1] 2.700266
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.


From Thomas.Schwiertz at gutmark.net  Wed Mar 16 13:13:29 2011
From: Thomas.Schwiertz at gutmark.net (Thomas Schwiertz)
Date: Wed, 16 Mar 2011 13:13:29 +0100
Subject: [R-SIG-Finance] fOptions and RQuantlib give different
	vanillaoption premiums
References: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>
Message-ID: <6BC17AB6B99BC441ABC83269178375A33BA84C@grcserver.gutmark.de>

Hello Vladimir,
some input data are different!
Try:

> EuropeanOption(type="call", underlying=49, strike=50, dividendYield=0.01, riskFreeRate=0.0009, maturity=1/4, volatility=0.2)

Concise summary of valuation for EuropeanOption 
  value   delta   gamma    vega   theta     rho  divRho 
 1.4653  0.4296  0.0800  9.6019 -3.6479  4.8957 -5.2620

Then the results are similar...

Regards,
Thomas



-----Urspr?ngliche Nachricht-----
Von: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] Im Auftrag von Vladimir Vladimirov
Gesendet: Mittwoch, 16. M?rz 2011 11:17
An: r-sig-finance at r-project.org
Betreff: [R-SIG-Finance] fOptions and RQuantlib give different vanillaoption premiums

Dear all,

I was wondering if someone has had similar experience with plain
vanilla European option pricing. I try to compare results using both
package fOptions and RQuantLib for a plain vanilla European option. I
use the example in Haug's Option book given in his intro chapter, it's
also shown in the fOptions package. So fOption gives me the correct
answer, but the EuropeanOption is off by a factor of three and
correspondingly the greeks are off (see below). The interesting thing
is that the wolfram alpha call option valuation gives me the same
result as RQuantlib (i.e. not correct)

http://www.wolframalpha.com/input/?i=call+option

I've tried this with other currency options and Bloomberg and
Superderivatives give me option premiums in line with what I get from
fOptions, don't understand how could I be getting different results
from RQuantLib and Wolfram Alpha. These are closed-form solutions for
plain vanilla, how come there be so much discrepancy in the results.
What am I missing?

Thank you in advance for the help.

-Vlad


library(fOptions)
library(RQuantLib)

> EuropeanOption(type="call", underlying=1.56, strike=1.6, dividendYield=0.06-0.08, riskFreeRate=0.06, maturity=1/2, volatility=0.12)
Concise summary of valuation for EuropeanOption
  value   delta   gamma    vega   theta     rho  divRho
 0.0652  0.5912  2.9743  0.4343 -0.1220  0.4285 -0.4611

> GBSCharacteristics(TypeFlag = "c", S = 1.5600, X = 1.6000,  Time = 1/2, r = 0.06, b = 0.06-0.08, sigma = 0.12)
$premium
[1] 0.02909931
$delta
[1] 0.3403860
$theta
[1] -0.03494785
$vega
[1] 0.3942821
$rho
[1] 0.2509514
$lambda
[1] 18.24793
$gamma
[1] 2.700266

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From edd at debian.org  Wed Mar 16 13:21:28 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 16 Mar 2011 07:21:28 -0500
Subject: [R-SIG-Finance] fOptions and RQuantlib give different
	vanilla	option premiums
In-Reply-To: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>
References: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>
Message-ID: <19840.43848.884138.494180@max.nulle.part>


On 16 March 2011 at 10:16, Vladimir Vladimirov wrote:
| library(fOptions)
| library(RQuantLib)
| 
| > EuropeanOption(type="call", underlying=1.56, strike=1.6, dividendYield=0.06-0.08, riskFreeRate=0.06, maturity=1/2, volatility=0.12)
| Concise summary of valuation for EuropeanOption
|   value   delta   gamma    vega   theta     rho  divRho
|  0.0652  0.5912  2.9743  0.4343 -0.1220  0.4285 -0.4611
| 
| > GBSCharacteristics(TypeFlag = "c", S = 1.5600, X = 1.6000,  Time = 1/2, r = 0.06, b = 0.06-0.08, sigma = 0.12)
| $premium
| [1] 0.02909931
| $delta
| [1] 0.3403860
| $theta
| [1] -0.03494785
| $vega
| [1] 0.3942821
| $rho
| [1] 0.2509514
| $lambda
| [1] 18.24793
| $gamma
| [1] 2.700266

As Vladimir already said, you get indentical results if you call
EuropeanOption with *separate* values for divident yield and short rate:

R> EuropeanOption(type="call", underlying=1.56, strike=1.6, dividendYield=0.08, riskFreeRate=0.06, maturity=1/2, volatility=0.12)
Concise summary of valuation for EuropeanOption 
  value   delta   gamma    vega   theta     rho  divRho 
 0.0291  0.3404  2.7003  0.3943 -0.0349  0.2510 -0.2655 
R> 

Evidently both packages vary in whether the divident yield is given outright
(RQuantLib) or as a delta to the short term rate (fOptions).

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From gmonaie at gmail.com  Wed Mar 16 23:50:24 2011
From: gmonaie at gmail.com (Gei Lin)
Date: Wed, 16 Mar 2011 18:50:24 -0400
Subject: [R-SIG-Finance] Passing Transaction costs from quantstrat to blotter
Message-ID: <AANLkTinocfMDrGY_m7BptVHFN_Z1Q+tXV9QfGcvx0LdB@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110316/eb0deb73/attachment.pl>

From vlad32 at gmail.com  Thu Mar 17 11:26:17 2011
From: vlad32 at gmail.com (Vladimir Vladimirov)
Date: Thu, 17 Mar 2011 10:26:17 +0000
Subject: [R-SIG-Finance] fOptions and RQuantlib give different vanilla
 option premiums
In-Reply-To: <19840.43848.884138.494180@max.nulle.part>
References: <AANLkTinw4Faaqncy5ydwjQVkJ7xwN5S_CxmDoT9LBW8i@mail.gmail.com>
	<19840.43848.884138.494180@max.nulle.part>
Message-ID: <AANLkTim-ayHrEcUUYONp=u-u+w+EPZwQ398dkWDmAEsW@mail.gmail.com>

Enrico, Thomas, Dirk thank you for the help. I love the r-sig finance community.

On Wed, Mar 16, 2011 at 12:21 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 16 March 2011 at 10:16, Vladimir Vladimirov wrote:
> | library(fOptions)
> | library(RQuantLib)
> |
> | > EuropeanOption(type="call", underlying=1.56, strike=1.6, dividendYield=0.06-0.08, riskFreeRate=0.06, maturity=1/2, volatility=0.12)
> | Concise summary of valuation for EuropeanOption
> | ? value ? delta ? gamma ? ?vega ? theta ? ? rho ?divRho
> | ?0.0652 ?0.5912 ?2.9743 ?0.4343 -0.1220 ?0.4285 -0.4611
> |
> | > GBSCharacteristics(TypeFlag = "c", S = 1.5600, X = 1.6000, ?Time = 1/2, r = 0.06, b = 0.06-0.08, sigma = 0.12)
> | $premium
> | [1] 0.02909931
> | $delta
> | [1] 0.3403860
> | $theta
> | [1] -0.03494785
> | $vega
> | [1] 0.3942821
> | $rho
> | [1] 0.2509514
> | $lambda
> | [1] 18.24793
> | $gamma
> | [1] 2.700266
>
> As Vladimir already said, you get indentical results if you call
> EuropeanOption with *separate* values for divident yield and short rate:
>
> R> EuropeanOption(type="call", underlying=1.56, strike=1.6, dividendYield=0.08, riskFreeRate=0.06, maturity=1/2, volatility=0.12)
> Concise summary of valuation for EuropeanOption
> ?value ? delta ? gamma ? ?vega ? theta ? ? rho ?divRho
> ?0.0291 ?0.3404 ?2.7003 ?0.3943 -0.0349 ?0.2510 -0.2655
> R>
>
> Evidently both packages vary in whether the divident yield is given outright
> (RQuantLib) or as a delta to the short term rate (fOptions).
>
> Dirk
>
> --
> Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com
>


From brian at braverock.com  Thu Mar 17 16:42:50 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 17 Mar 2011 10:42:50 -0500
Subject: [R-SIG-Finance] Passing Transaction costs from quantstrat to
 blotter
In-Reply-To: <AANLkTinocfMDrGY_m7BptVHFN_Z1Q+tXV9QfGcvx0LdB@mail.gmail.com>
References: <AANLkTinocfMDrGY_m7BptVHFN_Z1Q+tXV9QfGcvx0LdB@mail.gmail.com>
Message-ID: <4D822BFA.2040803@braverock.com>

On 03/16/2011 05:50 PM, Gei Lin wrote:
> Is there a way to pass transaction costs from quantstrat in a rule down to
> blotter in the tool chain?
>
> I haven't found any example of this yet.  Been digging down through the code
> from applyStrategy ->  applyRules ->  ruleOrderProc but haven't found it yet.

You see the TxnFees argument to addOrder and addTxn?

Basically, in your call to addOrder, you'll include TxnFees.  This 
should be passable in dots when you call applyStrategy as well (if for 
example you're using ruleSignal with simple order logic)

TxnFees can be a custom function, if your fees are not a simple numeric. 
  Simplistic example of fees per share are included in blotter.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From me at censix.com  Thu Mar 17 18:40:27 2011
From: me at censix.com (me at censix.com)
Date: Thu, 17 Mar 2011 18:40:27 +0100
Subject: [R-SIG-Finance] xts timeseries as shared-memory objects with
	bigmemory package ?
Message-ID: <38299.78.234.67.201.1300383627.squirrel@censix.com>

Hi to the list

I am looking into inter-process communication between one or more
instances of R (i.e. one process to receive marketdata, the other one to
execute a strategy and place orders)

I have seen that, with the 'bigmemory' package, a matrix defined as

shared <- big.matrix(....)

can be accessed by several different R processes, quite easily. Is there
an easy way to used this mechanism for sharing an xts timeseries ? I
havent seen how to do that.

My best guess would be to define the shared matrix as type='double' and
every time I need to read from or write to it, make the corresponding
matrix<==>xts conversion.  That would probably work since the matrix
itself is not huge, but it would be a bit more elegant if I could share
the actual xts object.

Thankful for any ideas

regards

Soren

http://censix.com


From jeffrey.ryan at lemnica.com  Thu Mar 17 19:09:55 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 17 Mar 2011 13:09:55 -0500
Subject: [R-SIG-Finance] xts timeseries as shared-memory objects with
 bigmemory package ?
In-Reply-To: <38299.78.234.67.201.1300383627.squirrel@censix.com>
References: <38299.78.234.67.201.1300383627.squirrel@censix.com>
Message-ID: <AANLkTikE1pckZO_idWRXmm+68OGZgVzN_SLLAb3twi2Z@mail.gmail.com>

Hi Soren,

There are a couple alternatives that are closer to the 'metal' if you
will.  The first, and (maybe) recommended way would be to use the mmap
package and a struct.  mmap doesn't support dimensioned data (yet),
but the struct is quite useful in that you can have different types
embedded in something of a list format.

I'll be giving a short lightning talk on this at R/Finance 2011 that
we are hosting in Chicago next month - which I hope to see everyone at
;-)  In case anyone missed the emails
http://www.RinFinance.com/register

For now, the free, quick, incomplete and ugly version:

> library(mmap)
> library(xts)
Loading required package: zoo
> x <- xts(1:10,Sys.time()+1:10)
> x
                    [,1]
2011-03-17 12:48:16    1
2011-03-17 12:48:17    2
2011-03-17 12:48:18    3
2011-03-17 12:48:19    4
2011-03-17 12:48:20    5
2011-03-17 12:48:21    6
2011-03-17 12:48:22    7
2011-03-17 12:48:23    8
2011-03-17 12:48:24    9
2011-03-17 12:48:25   10

# create an on disk object of the correct size
> tmp <- tempfile()
> length(coredata(x)) * sizeof(double) + length(.index(x)) * sizeof(double)
[1] 160
> writeBin(raw(160),tmp)

# create a mapping to it using the struct() construct in mmap

> m <- mmap(tmp, struct(double(),double()))

# assign the components, keeping in mind that you'd need a multiple
columns to handle multiple xts columns
> m[,1] <- .index(x)
> m[,2] <- coredata(x)[,1]

# the raw on disk data
> m[]
[[1]]
 [1] 1300384097 1300384098 1300384099 1300384100 1300384101 1300384102
 [7] 1300384103 1300384104 1300384105 1300384106

[[2]]
 [1]  1  2  3  4  5  6  7  8  9 10

# the 'magic'
> extractFUN(m) <- function(x) .xts(x[[2]],x[[1]])
> m[]
                    [,1]
2011-03-17 12:48:16    1
2011-03-17 12:48:17    2
2011-03-17 12:48:18    3
2011-03-17 12:48:19    4
2011-03-17 12:48:20    5
2011-03-17 12:48:21    6
2011-03-17 12:48:22    7
2011-03-17 12:48:23    8
2011-03-17 12:48:24    9
2011-03-17 12:48:25   10

Some things lost will be tz, time class, colnames, and misc
attributes. (same as bigmemory, ff of course)

All of the above is admittedly very, very ugly .. but will work across
processes.  You just need to know the name of the file that is being
mmapped/shared.  (i.e. don't use tempfile() ... make your own name).
The advantage of a struct is that we can find rows/columns without
loading the whole into memory. The disadvantage in some cases will be
that a struct in mmap is like a row-major db, whereas xts is like a
col-major one.  If that doesn't make sense to you, pretend I didn't
say it. ;-)

By the conference I'll have some simple wrappers to make this as easy
as the rest of xts - e.g. as.mmap will likely get an xts method.  I'll
also talk more about sharing objects across sessions in my Friday
morning workshop at the conference.

Another alternate approach that works well is using a key-value db -
something like RBerkeley from R.  This is incredibly fast and very
simple (see the vignette in the package) - with the only caveat being
that I can't get Oracle's BDB to compile using the R windows
toolchain, so RBerkeley gets nothing to link against if you are one of
the luckless souls bound to the Redmond OS.  If someone solves that
problem for the community (read: won't likely be me), it too will be a
solid cross-platform solution.

Jeff

On Thu, Mar 17, 2011 at 12:40 PM,  <me at censix.com> wrote:
> Hi to the list
>
> I am looking into inter-process communication between one or more
> instances of R (i.e. one process to receive marketdata, the other one to
> execute a strategy and place orders)
>
> I have seen that, with the 'bigmemory' package, a matrix defined as
>
> shared <- big.matrix(....)
>
> can be accessed by several different R processes, quite easily. Is there
> an easy way to used this mechanism for sharing an xts timeseries ? I
> havent seen how to do that.
>
> My best guess would be to define the shared matrix as type='double' and
> every time I need to read from or write to it, make the corresponding
> matrix<==>xts conversion. ?That would probably work since the matrix
> itself is not huge, but it would be a bit more elegant if I could share
> the actual xts object.
>
> Thankful for any ideas
>
> regards
>
> Soren
>
> http://censix.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com

R/Finance 2011 April 29th and 30th in Chicago
www.RinFinance.com


From stephen at organicfoodmarkets.com.au  Thu Mar 17 21:46:16 2011
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Fri, 18 Mar 2011 07:46:16 +1100
Subject: [R-SIG-Finance] modeling using the derivative or underlying
Message-ID: <4D827318.1030900@organicfoodmarkets.com.au>

Hi

I am working on using AI to build models to decide whether or not you 
should be long/short/out of the market.  I am playing with logistic 
models and neural networks at this time, but there are a number of other 
tree based or Bayesian models I could try in due course.

However, I was just wondering if anyone had any comments on which data 
you are best using to build your models on.  Say one is interested in 
the SPI (or SPY): are you better using the index data even though you 
will end up dealing in the future or some other derivative?  What I have 
in mind is that these things don't move in lock-step so there may be 
different information in the data concerning the index and that 
concerning the future of CFD, etc.

If anyone is interested in making a comment I would love to hear it.
-- 
Stephen Choularton Ph.D., FIoD


From me at censix.com  Fri Mar 18 06:40:22 2011
From: me at censix.com (me at censix.com)
Date: Fri, 18 Mar 2011 06:40:22 +0100
Subject: [R-SIG-Finance] xts timeseries as shared-memory objects with
 bigmemory package ?
In-Reply-To: <AANLkTikE1pckZO_idWRXmm+68OGZgVzN_SLLAb3twi2Z@mail.gmail.com>
References: <38299.78.234.67.201.1300383627.squirrel@censix.com>
	<AANLkTikE1pckZO_idWRXmm+68OGZgVzN_SLLAb3twi2Z@mail.gmail.com>
Message-ID: <33039.78.234.67.201.1300426822.squirrel@censix.com>

Jeff, that's amazing. Thanks for sharing!!


> Hi Soren,
>
> There are a couple alternatives that are closer to the 'metal' if you
> will.  The first, and (maybe) recommended way would be to use the mmap
> package and a struct.  mmap doesn't support dimensioned data (yet),
> but the struct is quite useful in that you can have different types
> embedded in something of a list format.
>
> I'll be giving a short lightning talk on this at R/Finance 2011 that
> we are hosting in Chicago next month - which I hope to see everyone at
> ;-)  In case anyone missed the emails
> http://www.RinFinance.com/register
>
> For now, the free, quick, incomplete and ugly version:
>
>> library(mmap)
>> library(xts)
> Loading required package: zoo
>> x <- xts(1:10,Sys.time()+1:10)
>> x
>                     [,1]
> 2011-03-17 12:48:16    1
> 2011-03-17 12:48:17    2
> 2011-03-17 12:48:18    3
> 2011-03-17 12:48:19    4
> 2011-03-17 12:48:20    5
> 2011-03-17 12:48:21    6
> 2011-03-17 12:48:22    7
> 2011-03-17 12:48:23    8
> 2011-03-17 12:48:24    9
> 2011-03-17 12:48:25   10
>
> # create an on disk object of the correct size
>> tmp <- tempfile()
>> length(coredata(x)) * sizeof(double) + length(.index(x)) *
>> sizeof(double)
> [1] 160
>> writeBin(raw(160),tmp)
>
> # create a mapping to it using the struct() construct in mmap
>
>> m <- mmap(tmp, struct(double(),double()))
>
> # assign the components, keeping in mind that you'd need a multiple
> columns to handle multiple xts columns
>> m[,1] <- .index(x)
>> m[,2] <- coredata(x)[,1]
>
> # the raw on disk data
>> m[]
> [[1]]
>  [1] 1300384097 1300384098 1300384099 1300384100 1300384101 1300384102
>  [7] 1300384103 1300384104 1300384105 1300384106
>
> [[2]]
>  [1]  1  2  3  4  5  6  7  8  9 10
>
> # the 'magic'
>> extractFUN(m) <- function(x) .xts(x[[2]],x[[1]])
>> m[]
>                     [,1]
> 2011-03-17 12:48:16    1
> 2011-03-17 12:48:17    2
> 2011-03-17 12:48:18    3
> 2011-03-17 12:48:19    4
> 2011-03-17 12:48:20    5
> 2011-03-17 12:48:21    6
> 2011-03-17 12:48:22    7
> 2011-03-17 12:48:23    8
> 2011-03-17 12:48:24    9
> 2011-03-17 12:48:25   10
>
> Some things lost will be tz, time class, colnames, and misc
> attributes. (same as bigmemory, ff of course)
>
> All of the above is admittedly very, very ugly .. but will work across
> processes.  You just need to know the name of the file that is being
> mmapped/shared.  (i.e. don't use tempfile() ... make your own name).
> The advantage of a struct is that we can find rows/columns without
> loading the whole into memory. The disadvantage in some cases will be
> that a struct in mmap is like a row-major db, whereas xts is like a
> col-major one.  If that doesn't make sense to you, pretend I didn't
> say it. ;-)
>
> By the conference I'll have some simple wrappers to make this as easy
> as the rest of xts - e.g. as.mmap will likely get an xts method.  I'll
> also talk more about sharing objects across sessions in my Friday
> morning workshop at the conference.
>
> Another alternate approach that works well is using a key-value db -
> something like RBerkeley from R.  This is incredibly fast and very
> simple (see the vignette in the package) - with the only caveat being
> that I can't get Oracle's BDB to compile using the R windows
> toolchain, so RBerkeley gets nothing to link against if you are one of
> the luckless souls bound to the Redmond OS.  If someone solves that
> problem for the community (read: won't likely be me), it too will be a
> solid cross-platform solution.
>
> Jeff
>
> On Thu, Mar 17, 2011 at 12:40 PM,  <me at censix.com> wrote:
>> Hi to the list
>>
>> I am looking into inter-process communication between one or more
>> instances of R (i.e. one process to receive marketdata, the other one to
>> execute a strategy and place orders)
>>
>> I have seen that, with the 'bigmemory' package, a matrix defined as
>>
>> shared <- big.matrix(....)
>>
>> can be accessed by several different R processes, quite easily. Is there
>> an easy way to used this mechanism for sharing an xts timeseries ? I
>> havent seen how to do that.
>>
>> My best guess would be to define the shared matrix as type='double' and
>> every time I need to read from or write to it, make the corresponding
>> matrix<==>xts conversion. ?That would probably work since the matrix
>> itself is not huge, but it would be a bit more elegant if I could share
>> the actual xts object.
>>
>> Thankful for any ideas
>>
>> regards
>>
>> Soren
>>
>> http://censix.com
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
>
> R/Finance 2011 April 29th and 30th in Chicago
> www.RinFinance.com
>


From arun.kumar.saha at gmail.com  Fri Mar 18 07:46:45 2011
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Thu, 17 Mar 2011 23:46:45 -0700
Subject: [R-SIG-Finance] modeling using the derivative or underlying
In-Reply-To: <4D827318.1030900@organicfoodmarkets.com.au>
References: <4D827318.1030900@organicfoodmarkets.com.au>
Message-ID: <1300430805872-3386399.post@n4.nabble.com>

Hi Stephen, I think it actually depends on the purpose of your analysis. If I
am into fair pricing and want to look the strength of deviation in the
traded price of some derivative as compared to that fair price then I would
go for modelling the underlying. Also for Risk management I would rather
model the underlying. However if my goal is just to understand the market
moves (hence prediction) for some derivative then I think directly modelling
those historical derivative prices would be better as in actual trading lot
of other noises generally involved in the traded price. However in this
approach you may occasionally find less data points especially near to the
inception of that derivative.

Best,


--
View this message in context: http://r.789695.n4.nabble.com/modeling-using-the-derivative-or-underlying-tp3385619p3386399.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From kb2qzv at poczta.wp.pl  Fri Mar 18 13:39:55 2011
From: kb2qzv at poczta.wp.pl (BeBa)
Date: Fri, 18 Mar 2011 13:39:55 +0100
Subject: [R-SIG-Finance] quotes from cvs file, how to?
Message-ID: <20110318133955.2f40186f@poczta.wp.pl>

Hi,
I need help with using chartSeries from the quantmod package.
The file that is to be used has this structure:


> str(wig20)
'data.frame':	4200 obs. of  7 variables:
 $ X.TICKER.    : Factor w/ 1 level "WIG20": 1 1 1 1 1 1 1 1 1 1 ...
 $ X.DTYYYYMMDD.: int  19940414 19940418  19940509 ...
 $ X.OPEN.      : num  1000 1050 1125 1305 1350 ...
 $ X.HIGH.      : num  1000 1050 1125 1305 1350 ...
 $ X.LOW.       : num  1000 1050 1125 1305 1350 ...
 $ X.CLOSE.     : num  1000 1050 1125 1305 1350 ...
 $ X.VOL.       : num  35800 49975 69030 77076 114219 ...


and here is what it looks like:

> head(wig20)
  X.TICKER. X.DTYYYYMMDD. X.OPEN. X.HIGH. X.LOW. X.CLOSE.   X.VOL.
1     WIG20      19940414  1000.0  1000.0 1000.0   1000.0  35800.0
2     WIG20      19940418  1050.5  1050.5 1050.5   1050.5  49975.0
3     WIG20      19940419  1124.9  1124.9 1124.9   1124.9  69029.5
4     WIG20      19940421  1304.8  1304.8 1304.8   1304.8  77075.5
5     WIG20      19940425  1350.1  1350.1 1350.1   1350.1 114219.0
6     WIG20      19940426  1216.2  1216.2 1216.2   1216.2   8309.0


Since I do not need the TICKER column I chose to proceed as follows:

wig20skipped <- read.table(file="WIG20.mst", colClasses=c("NULL",
"integer", "numeric", "numeric", "numeric", "numeric", "numeric"),
col.names=c("NULL", "date", "o", "h", "l", "c", "vol"), sep=",",
header=T)


Ok, now wig20skipped looks similar to what yahoo finance site provides:
head(wig20skipped)
      date      o      h      l      c      vol
1 19940414 1000.0 1000.0 1000.0 1000.0  35800.0
2 19940418 1050.5 1050.5 1050.5 1050.5  49975.0
3 19940419 1124.9 1124.9 1124.9 1124.9  69029.5
4 19940421 1304.8 1304.8 1304.8 1304.8  77075.5
5 19940425 1350.1 1350.1 1350.1 1350.1 114219.0
6 19940426 1216.2 1216.2 1216.2 1216.2   8309.0




In order for the chartSeries() to draw the data they need to be xtsible.
So:

wig20zoo <- read.zoo(wig20skipped, format="%Y%m%d")
wig20asxts <- as.xts(wig20zoo)

Just to confirm that I do things right:
is.xts(wig20asxts)
[1] TRUE


and Now the problem: neither chartSeries(wig20asxts) nor candleCharts(wig20asxts) can display candlisticks.
I don't know why. Also:
addVolatility() results in
addVolatility()
Error in dim(data) <- dim : attempt to set an attribute on NULL

Perhaps this could help someone to diagnose the problem:

str(wig20asxts)
An ?xts? object from 1994-04-14 to 2011-03-09 containing:
  Data: num [1:4200, 1:5] 1000 1050 1125 1305 1350 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:5] "o" "h" "l" "c" ...
  Indexed by objects of class: [Date] TZ: 
  xts Attributes:  
 NULL



Thanks for any help.

BeBa


From daniel.cegielka at gmail.com  Fri Mar 18 14:33:21 2011
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Fri, 18 Mar 2011 14:33:21 +0100
Subject: [R-SIG-Finance] quotes from cvs file, how to?
In-Reply-To: <20110318133955.2f40186f@poczta.wp.pl>
References: <20110318133955.2f40186f@poczta.wp.pl>
Message-ID: <AANLkTimMbB6jzcXfJdMtkWTzZDW0JU4viqSk4L0XZdEy@mail.gmail.com>

Hi Benedict! :)

There is getSymbols.csv function in getSymbols.R code:

https://r-forge.r-project.org/scm/viewvc.php/pkg/R/getSymbols.R?view=markup&revision=560&root=quantmod

try:

?getSymbols.csv

Best regards,
daniel



2011/3/18 BeBa <kb2qzv at poczta.wp.pl>:
> Hi,
> I need help with using chartSeries from the quantmod package.
> The file that is to be used has this structure:
>
>
>> str(wig20)
> 'data.frame': ? 4200 obs. of ?7 variables:
> ?$ X.TICKER. ? ?: Factor w/ 1 level "WIG20": 1 1 1 1 1 1 1 1 1 1 ...
> ?$ X.DTYYYYMMDD.: int ?19940414 19940418 ?19940509 ...
> ?$ X.OPEN. ? ? ?: num ?1000 1050 1125 1305 1350 ...
> ?$ X.HIGH. ? ? ?: num ?1000 1050 1125 1305 1350 ...
> ?$ X.LOW. ? ? ? : num ?1000 1050 1125 1305 1350 ...
> ?$ X.CLOSE. ? ? : num ?1000 1050 1125 1305 1350 ...
> ?$ X.VOL. ? ? ? : num ?35800 49975 69030 77076 114219 ...
>
>
> and here is what it looks like:
>
>> head(wig20)
> ?X.TICKER. X.DTYYYYMMDD. X.OPEN. X.HIGH. X.LOW. X.CLOSE. ? X.VOL.
> 1 ? ? WIG20 ? ? ?19940414 ?1000.0 ?1000.0 1000.0 ? 1000.0 ?35800.0
> 2 ? ? WIG20 ? ? ?19940418 ?1050.5 ?1050.5 1050.5 ? 1050.5 ?49975.0
> 3 ? ? WIG20 ? ? ?19940419 ?1124.9 ?1124.9 1124.9 ? 1124.9 ?69029.5
> 4 ? ? WIG20 ? ? ?19940421 ?1304.8 ?1304.8 1304.8 ? 1304.8 ?77075.5
> 5 ? ? WIG20 ? ? ?19940425 ?1350.1 ?1350.1 1350.1 ? 1350.1 114219.0
> 6 ? ? WIG20 ? ? ?19940426 ?1216.2 ?1216.2 1216.2 ? 1216.2 ? 8309.0
>
>
> Since I do not need the TICKER column I chose to proceed as follows:
>
> wig20skipped <- read.table(file="WIG20.mst", colClasses=c("NULL",
> "integer", "numeric", "numeric", "numeric", "numeric", "numeric"),
> col.names=c("NULL", "date", "o", "h", "l", "c", "vol"), sep=",",
> header=T)
>
>
> Ok, now wig20skipped looks similar to what yahoo finance site provides:
> head(wig20skipped)
> ? ? ?date ? ? ?o ? ? ?h ? ? ?l ? ? ?c ? ? ?vol
> 1 19940414 1000.0 1000.0 1000.0 1000.0 ?35800.0
> 2 19940418 1050.5 1050.5 1050.5 1050.5 ?49975.0
> 3 19940419 1124.9 1124.9 1124.9 1124.9 ?69029.5
> 4 19940421 1304.8 1304.8 1304.8 1304.8 ?77075.5
> 5 19940425 1350.1 1350.1 1350.1 1350.1 114219.0
> 6 19940426 1216.2 1216.2 1216.2 1216.2 ? 8309.0
>
>
>
>
> In order for the chartSeries() to draw the data they need to be xtsible.
> So:
>
> wig20zoo <- read.zoo(wig20skipped, format="%Y%m%d")
> wig20asxts <- as.xts(wig20zoo)
>
> Just to confirm that I do things right:
> is.xts(wig20asxts)
> [1] TRUE
>
>
> and Now the problem: neither chartSeries(wig20asxts) nor candleCharts(wig20asxts) can display candlisticks.
> I don't know why. Also:
> addVolatility() results in
> addVolatility()
> Error in dim(data) <- dim : attempt to set an attribute on NULL
>
> Perhaps this could help someone to diagnose the problem:
>
> str(wig20asxts)
> An ?xts? object from 1994-04-14 to 2011-03-09 containing:
> ?Data: num [1:4200, 1:5] 1000 1050 1125 1305 1350 ...
> ?- attr(*, "dimnames")=List of 2
> ?..$ : NULL
> ?..$ : chr [1:5] "o" "h" "l" "c" ...
> ?Indexed by objects of class: [Date] TZ:
> ?xts Attributes:
> ?NULL
>
>
>
> Thanks for any help.
>
> BeBa
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From josh.m.ulrich at gmail.com  Sat Mar 19 17:25:25 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 19 Mar 2011 11:25:25 -0500
Subject: [R-SIG-Finance] quotes from cvs file, how to?
In-Reply-To: <20110318133955.2f40186f@poczta.wp.pl>
References: <20110318133955.2f40186f@poczta.wp.pl>
Message-ID: <AANLkTinHQJOt2ucr24vJyUOTgVroGOSh-h7izBZQ+L6M@mail.gmail.com>

On Fri, Mar 18, 2011 at 7:39 AM, BeBa <kb2qzv at poczta.wp.pl> wrote:
> Hi,
> I need help with using chartSeries from the quantmod package.
> The file that is to be used has this structure:
>
>
>> str(wig20)
> 'data.frame': ? 4200 obs. of ?7 variables:
> ?$ X.TICKER. ? ?: Factor w/ 1 level "WIG20": 1 1 1 1 1 1 1 1 1 1 ...
> ?$ X.DTYYYYMMDD.: int ?19940414 19940418 ?19940509 ...
> ?$ X.OPEN. ? ? ?: num ?1000 1050 1125 1305 1350 ...
> ?$ X.HIGH. ? ? ?: num ?1000 1050 1125 1305 1350 ...
> ?$ X.LOW. ? ? ? : num ?1000 1050 1125 1305 1350 ...
> ?$ X.CLOSE. ? ? : num ?1000 1050 1125 1305 1350 ...
> ?$ X.VOL. ? ? ? : num ?35800 49975 69030 77076 114219 ...
>
>
> and here is what it looks like:
>
>> head(wig20)
> ?X.TICKER. X.DTYYYYMMDD. X.OPEN. X.HIGH. X.LOW. X.CLOSE. ? X.VOL.
> 1 ? ? WIG20 ? ? ?19940414 ?1000.0 ?1000.0 1000.0 ? 1000.0 ?35800.0
> 2 ? ? WIG20 ? ? ?19940418 ?1050.5 ?1050.5 1050.5 ? 1050.5 ?49975.0
> 3 ? ? WIG20 ? ? ?19940419 ?1124.9 ?1124.9 1124.9 ? 1124.9 ?69029.5
> 4 ? ? WIG20 ? ? ?19940421 ?1304.8 ?1304.8 1304.8 ? 1304.8 ?77075.5
> 5 ? ? WIG20 ? ? ?19940425 ?1350.1 ?1350.1 1350.1 ? 1350.1 114219.0
> 6 ? ? WIG20 ? ? ?19940426 ?1216.2 ?1216.2 1216.2 ? 1216.2 ? 8309.0
>
>
> Since I do not need the TICKER column I chose to proceed as follows:
>
> wig20skipped <- read.table(file="WIG20.mst", colClasses=c("NULL",
> "integer", "numeric", "numeric", "numeric", "numeric", "numeric"),
> col.names=c("NULL", "date", "o", "h", "l", "c", "vol"), sep=",",
> header=T)
>
>
> Ok, now wig20skipped looks similar to what yahoo finance site provides:
> head(wig20skipped)
> ? ? ?date ? ? ?o ? ? ?h ? ? ?l ? ? ?c ? ? ?vol
> 1 19940414 1000.0 1000.0 1000.0 1000.0 ?35800.0
> 2 19940418 1050.5 1050.5 1050.5 1050.5 ?49975.0
> 3 19940419 1124.9 1124.9 1124.9 1124.9 ?69029.5
> 4 19940421 1304.8 1304.8 1304.8 1304.8 ?77075.5
> 5 19940425 1350.1 1350.1 1350.1 1350.1 114219.0
> 6 19940426 1216.2 1216.2 1216.2 1216.2 ? 8309.0
>
>
>
>
> In order for the chartSeries() to draw the data they need to be xtsible.
> So:
>
> wig20zoo <- read.zoo(wig20skipped, format="%Y%m%d")
> wig20asxts <- as.xts(wig20zoo)
>
> Just to confirm that I do things right:
> is.xts(wig20asxts)
> [1] TRUE
>
>
> and Now the problem: neither chartSeries(wig20asxts) nor candleCharts(wig20asxts) can display candlisticks.
> I don't know why. Also:
> addVolatility() results in
> addVolatility()
> Error in dim(data) <- dim : attempt to set an attribute on NULL
>

O=H=L=C in your sample data, so there won't be any candlesticks.  You
may also need to set your column names to
c("Open","High","Low","Close","Volume").

Hope that helps,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> Perhaps this could help someone to diagnose the problem:
>
> str(wig20asxts)
> An ?xts? object from 1994-04-14 to 2011-03-09 containing:
> ?Data: num [1:4200, 1:5] 1000 1050 1125 1305 1350 ...
> ?- attr(*, "dimnames")=List of 2
> ?..$ : NULL
> ?..$ : chr [1:5] "o" "h" "l" "c" ...
> ?Indexed by objects of class: [Date] TZ:
> ?xts Attributes:
> ?NULL
>
>
>
> Thanks for any help.
>
> BeBa
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From vrramnath at gmail.com  Mon Mar 21 14:58:39 2011
From: vrramnath at gmail.com (Ramnath R)
Date: Mon, 21 Mar 2011 19:28:39 +0530
Subject: [R-SIG-Finance] (no subject)
Message-ID: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>

can u sent me some of the major routines used in R,especially from
which package,it would be helpful
Ram


From brian at braverock.com  Mon Mar 21 15:02:28 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 21 Mar 2011 09:02:28 -0500
Subject: [R-SIG-Finance] (no subject)
In-Reply-To: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>
References: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>
Message-ID: <4D875A74.2020800@braverock.com>

On 03/21/2011 08:58 AM, Ramnath R wrote:
> can u sent me some of the major routines used in R,especially from
> which package,it would be helpful
> Ram

While it is clear from your message that your first language is not 
English, it would help us if you let us know what you are trying to do.

The ecosystem of R packages is rather large, so guessing what you're 
trying to do will likely not get us close.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Mon Mar 21 15:36:34 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 21 Mar 2011 09:36:34 -0500
Subject: [R-SIG-Finance] (no subject)
In-Reply-To: <AANLkTinYrZrAYPkh3sDFPK2f5ObA3SS5qqf6eZh8mBtD@mail.gmail.com>
References: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>	<4D875A74.2020800@braverock.com>
	<AANLkTinYrZrAYPkh3sDFPK2f5ObA3SS5qqf6eZh8mBtD@mail.gmail.com>
Message-ID: <4D876272.4090704@braverock.com>

>> On 03/21/2011 08:58 AM, Ramnath R wrote:
>>>
>>> can u sent me some of the major routines used in R,especially from
>>> which package,it would be helpful
>>> Ram
>>
> On Mon, Mar 21, 2011 at 7:32 PM, Brian G. Peterson<brian at braverock.com>  wrote:
>> While it is clear from your message that your first language is not English,
>> it would help us if you let us know what you are trying to do.
>>
>> The ecosystem of R packages is rather large, so guessing what you're trying
>> to do will likely not get us close.

On 03/21/2011 09:07 AM, Ramnath R wrote:
 > well i need to know what are the most probable routines used in R that
 > can also be used in analyzing astronomical data....
 > Ram
 >

This is the *Finance* list, not the astronomy list.  Please direct your 
query to the R-help list instead.

Before posting, I suggest that you read (and follow) the posting guide:

http://www.r-project.org/posting-guide.html

and do a bit of searching, for example using rseek:

http://www.rseek.org/

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Tue Mar 22 18:06:51 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 22 Mar 2011 12:06:51 -0500
Subject: [R-SIG-Finance] R GSOC 2011
Message-ID: <4D88D72B.8040305@braverock.com>

The R project has been selected again this year to participate in the 
Google Summer of Code.

There are many excellent R project proposals here:

http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2011

Where potential participants can look at the proposals and start 
communicating with project mentors.

The one most directly linked to R in Finance is the TradeAnalytics proposal:

http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2011:tradeanalytics

Interested parties should consult the R-Wiki, and potentially join the 
GSOC-R mailing list.

Please let interested students and faculty know that R is again 
participating in GSOC, so that we get lots of good student applications.

Regards,

   - Brian


From matteo.fornasier at gmail.com  Tue Mar 22 20:12:49 2011
From: matteo.fornasier at gmail.com (Matteo Fornasier)
Date: Tue, 22 Mar 2011 20:12:49 +0100
Subject: [R-SIG-Finance] RBloomberg and Bloomberg API 3.4.1.3
In-Reply-To: <AANLkTinLL3z34XtU=qA_64YJ6zz+hZ+45V_cr587agmo@mail.gmail.com>
References: <AANLkTimFrki-H9ynOzFOOnB5M6srj-3TkrMNy=1Fg1DU@mail.gmail.com>
	<AANLkTinLL3z34XtU=qA_64YJ6zz+hZ+45V_cr587agmo@mail.gmail.com>
Message-ID: <AANLkTikDNPPtfBTsFmsVFWfu2s4BMEYBFrdk2k07Zhuj@mail.gmail.com>

Hi all,
I've the following problem:

> bl = blpConnect(iface="Java")
R version 2.12.1 (2010-12-16)
rJava Version 0.8-8
RBloomberg Version 0.4-145
Java environment initialized successfully.
Looking for most recent blpapi3.jar file...
Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) :
java.io.IOException: Couldn't get lock for %h/org.findata.blpwrapper.%g.log
Calls: blpConnect ... eval -> eval -> blpConnect.Java -> .jnew -> .External

I don't understand how's possible. Any idea?

Many thanks in advance,

Matteo


On Mon, Feb 28, 2011 at 4:15 PM, Ana Nelson <nelson.ana at gmail.com> wrote:
> I have now uploaded what should be a fix, although unfortunately I have
> managed to mess up the version numbering, so you may have to uninstall your
> existing RBloomberg then install the new one... and that may mean I've
> missed a bug fix.
>
> If possible back up your current installation of RBloomberg before
> uninstalling/reinstalling.
>
> I'll have a proper in-sequence build up within a few days.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From nelson.ana at gmail.com  Tue Mar 22 21:43:28 2011
From: nelson.ana at gmail.com (Ana Nelson)
Date: Tue, 22 Mar 2011 20:43:28 +0000
Subject: [R-SIG-Finance] RBloomberg and Bloomberg API 3.4.1.3
In-Reply-To: <AANLkTikDNPPtfBTsFmsVFWfu2s4BMEYBFrdk2k07Zhuj@mail.gmail.com>
References: <AANLkTimFrki-H9ynOzFOOnB5M6srj-3TkrMNy=1Fg1DU@mail.gmail.com>
	<AANLkTinLL3z34XtU=qA_64YJ6zz+hZ+45V_cr587agmo@mail.gmail.com>
	<AANLkTikDNPPtfBTsFmsVFWfu2s4BMEYBFrdk2k07Zhuj@mail.gmail.com>
Message-ID: <AANLkTiku_BRcj5Y-r=w-58uP0aioEhfO=Lp5QY4Nf0oY@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110322/b3b678f9/attachment.pl>

From worik.stanton at gmail.com  Tue Mar 22 22:55:46 2011
From: worik.stanton at gmail.com (Worik)
Date: Wed, 23 Mar 2011 10:55:46 +1300
Subject: [R-SIG-Finance] Possible bug in findDrawdowns
Message-ID: <4D891AE2.20704@gmail.com>

Given a very short series with a draw down one period from "from" to 
"trough" findDrawdowns seems to find the "from" and "trough" in the same 
place, but the wrong place.

For example:


 > Z
                  Y   returns.Y.
1936-02-29 14.5500  0.016632400
1936-03-31 14.9600  0.027788979
1936-04-30 13.8069 -0.080211505
1936-05-31 14.4386  0.044736709
1936-06-30 15.0402  0.040821440
1936-07-31 16.0638  0.065841677
1936-08-31 16.2057  0.008794739
1936-09-30 16.4794  0.016748084
1936-10-31 17.7146  0.072278042
1936-11-30 17.7866  0.004056206
1936-12-31 17.9616  0.009790781

 > findDrawdowns(Z[,2])
$return
[1]  0.0000000 -0.0802115  0.0000000

$from
[1] 1 3 5

$trough
[1] 1 3 5

$to
[1]  3  5 12

$length
[1] 3 3 8

$peaktotrough
[1] 1 1 1

$recovery
[1] 2 2 7

There is a draw down from position 2 to trough at 3 and regains its 
level in 4.  But that is missed.

Either I missunderstand or this is a bug

cheers
Worik

-- 
If we amplify everything, we hear nothing.
--


From joshchien at yahoo.com  Wed Mar 23 03:27:43 2011
From: joshchien at yahoo.com (JOSH CHIEN)
Date: Tue, 22 Mar 2011 19:27:43 -0700 (PDT)
Subject: [R-SIG-Finance] Error Message using RBloomberg
Message-ID: <411414.79494.qm@web113112.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110322/5bd55c31/attachment.pl>

From josh.andersen10 at yahoo.com  Wed Mar 23 11:13:13 2011
From: josh.andersen10 at yahoo.com (Josh Andersen)
Date: Wed, 23 Mar 2011 03:13:13 -0700 (PDT)
Subject: [R-SIG-Finance] FamaFrench Carhart models
Message-ID: <35248.2021.qm@web121220.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110323/6bbbcbe6/attachment.pl>

From nelson.ana at gmail.com  Wed Mar 23 12:10:40 2011
From: nelson.ana at gmail.com (Ana Nelson)
Date: Wed, 23 Mar 2011 11:10:40 +0000
Subject: [R-SIG-Finance] Error Message using RBloomberg
In-Reply-To: <411414.79494.qm@web113112.mail.gq1.yahoo.com>
References: <411414.79494.qm@web113112.mail.gq1.yahoo.com>
Message-ID: <AANLkTinkHBr_p4NdTzQe8jNHDct0-XW_5Vd1hBjhQrkH@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110323/42886933/attachment.pl>

From brian at braverock.com  Wed Mar 23 13:43:51 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 23 Mar 2011 07:43:51 -0500
Subject: [R-SIG-Finance] Possible bug in findDrawdowns
In-Reply-To: <4D891AE2.20704@gmail.com>
References: <4D891AE2.20704@gmail.com>
Message-ID: <4D89EB07.7020601@braverock.com>

On 03/22/2011 04:55 PM, Worik wrote:
> Given a very short series with a draw down one period from "from" to
> "trough" findDrawdowns seems to find the "from" and "trough" in the same
> place, but the wrong place.
>
> For example:
>
>
>  > Z
> Y returns.Y.
> 1936-02-29 14.5500 0.016632400
> 1936-03-31 14.9600 0.027788979
> 1936-04-30 13.8069 -0.080211505
> 1936-05-31 14.4386 0.044736709
> 1936-06-30 15.0402 0.040821440
> 1936-07-31 16.0638 0.065841677
> 1936-08-31 16.2057 0.008794739
> 1936-09-30 16.4794 0.016748084
> 1936-10-31 17.7146 0.072278042
> 1936-11-30 17.7866 0.004056206
> 1936-12-31 17.9616 0.009790781
>
>  > findDrawdowns(Z[,2])
> $return
> [1] 0.0000000 -0.0802115 0.0000000
>
> $from
> [1] 1 3 5
>
> $trough
> [1] 1 3 5
>
> $to
> [1] 3 5 12
>
> $length
> [1] 3 3 8
>
> $peaktotrough
> [1] 1 1 1
>
> $recovery
> [1] 2 2 7
>
> There is a draw down from position 2 to trough at 3 and regains its
> level in 4. But that is missed.
>
> Either I missunderstand or this is a bug

There may be bug here, but it is not the bug you think it is.

The answer can be seen by looking at the Drawdowns time series:

 > x<-read.csv('worik.csv',stringsAsFactors=FALSE)
 > Z<-as.xts(x[,3,drop=FALSE],order.by=as.Date(x[,1]))

 > Drawdowns(Z)
             returns.Y.
1936-02-29  0.00000000
1936-03-31  0.00000000
1936-04-30 -0.08021150
1936-05-31 -0.03906319
1936-06-30  0.00000000
1936-07-31  0.00000000
1936-08-31  0.00000000
1936-09-30  0.00000000
1936-10-31  0.00000000
1936-11-30  0.00000000
1936-12-31  0.00000000

Note that the -0.08021150 return on period 3 (1936-04-30) creates a 
drawdown that is not resolved until row 5. This would also work without 
geometric returns, but the answer would be the same in terms of length 
of drawdown.

 > findDrawdowns(Z)
$return
[1]  0.0000000 -0.0802115  0.0000000

$from
[1] 1 3 5

$trough
[1] 1 3 5

$to
[1]  3  5 12

$length
[1] 3 3 8

$peaktotrough
[1] 1 1 1

$recovery
[1] 2 2 7

All the stats for the second drawdown reported (the only real one) are 
correct.

The drawdown starts on row 3 (from), has a trough at row 3, and is not 
fully recovered until row 5, for a length of 3.  The peak to trough is 1 
period, and the recovery is two periods.

Typically, the function more likely to be used by a user is the 
table.Drawdowns function, which gives results you're more likely to 
immediately agree with.

 > table.Drawdowns(Z)
         From     Trough         To   Depth Length To Trough Recovery
1 1936-04-30 1936-04-30 1936-06-30 -0.0802      3         1        2

findDrawdowns is really more of a utility function.  if you want to use 
it directly, you'd need to filter out the 0 drawdowns (which basically 
cover the periods of the time series not in drawdown).

For reproducibility, I attach the csv file.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock
-------------- next part --------------
A non-text attachment was scrubbed...
Name: worik.csv
Type: text/csv
Size: 381 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110323/6a442842/attachment.bin>

From swtzang at gmail.com  Thu Mar 24 03:03:12 2011
From: swtzang at gmail.com (ShyhWeir Tzang)
Date: Thu, 24 Mar 2011 10:03:12 +0800
Subject: [R-SIG-Finance] rgarch and GH
Message-ID: <AANLkTikp_bP4VseY+LAFgcP3Pvrst55FwmxsWObCbuzL@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110324/f722f41b/attachment.pl>

From alexios at 4dscape.com  Thu Mar 24 03:52:19 2011
From: alexios at 4dscape.com (alexios)
Date: Thu, 24 Mar 2011 02:52:19 +0000
Subject: [R-SIG-Finance] rgarch and GH
In-Reply-To: <AANLkTikp_bP4VseY+LAFgcP3Pvrst55FwmxsWObCbuzL@mail.gmail.com>
References: <AANLkTikp_bP4VseY+LAFgcP3Pvrst55FwmxsWObCbuzL@mail.gmail.com>
Message-ID: <4D8AB1E3.5080407@4dscape.com>

The skew and shape parameters are the (\rho, \zeta) parametrization 
standardized for use in the (0, 1) GARCH process. The 'dlambda' 
represents the second shape parameter from the GIG mixing distribution 
(where dlambda = -0.5 is the Normal Inverse Gaussian distribution, 
dlambda=1 the Hypebolic, etc). For details see for example Prauss (1999)

The function:

ghyptransform(mu = 0, sigma = 1,  skew = 0, shape = 3, lambda = -0.5)

will transform (and scale by sigma) the returned parameters to the 
standard (\alpha,\beta,\delta,\mu) parametrization (ignore the returned 
parameter names...needs fixing. The returned values represent mu, delta, 
beta, alpha).

For VaR, you can use directly (without having to transform) the function:

qdist(distribution = "ghyp", p, mu = 0, sigma = 1, lambda = -0.5, skew = 
1, shape = 5).

where 'mu' would be the conditional mean (use the 'fitted' method to 
extract from fit object), and sigma the conditional sd (extracted using 
the 'sigma' method).

Hope that helps.

Regards,

Alexios Ghalanos


On 24/03/2011 02:03, ShyhWeir Tzang wrote:
> Dear Sir:
> Sorry for bothering you all. I am working on garch estimation using
> rgarch package assuming a generalized hyperbolic distribution. As I
> know, the number of estimated parameters of GH should have five
> paramters. However, I checked the output and found only three paramters:
> dlambda, skew and shape. Is it because the standardization of the GH by
> letting the mean and variance to be 0 and 1? To meet these two
> requirements, those paramters should at least have some values
> there. How can I extract the estimated values for all five parameters?
> What does dlambda represent? I want to extract those values as I need to
> calculate the VaR values by the model, which is still unclear to me how
> to use rgarch to calculate VaR. Enclosed is the code for testing.
> Appreciate for any help from you.
> Best regards,
> Shyh-Weir Tzang
> #
> library(rgarch)
> data(dji30ret)
> spec = ugarchspec(mean.model = list(armaOrder = c(0,0), include.mean =
> TRUE), variance.model = list(model = "sGARCH"), distribution.model = "ghyp")
> fit.dji=ugarchfit(spec,data=dji30ret[,"AA"], out.sample=1000)
>  > coef(fit.dji)
>             mu         omega        alpha1         beta1
> dlambda          skew         shape
>   5.218311e-04  2.906185e-06  3.720127e-02  9.555983e-01 -3.553546e+00
> 6.324228e-01  2.500494e-01
> #####
>
>
>
>


From matteo.fornasier at gmail.com  Thu Mar 24 10:00:53 2011
From: matteo.fornasier at gmail.com (Matteo Fornasier)
Date: Thu, 24 Mar 2011 10:00:53 +0100
Subject: [R-SIG-Finance] RBloomberg and Bloomberg API 3.4.1.3
In-Reply-To: <AANLkTiku_BRcj5Y-r=w-58uP0aioEhfO=Lp5QY4Nf0oY@mail.gmail.com>
References: <AANLkTimFrki-H9ynOzFOOnB5M6srj-3TkrMNy=1Fg1DU@mail.gmail.com>
	<AANLkTinLL3z34XtU=qA_64YJ6zz+hZ+45V_cr587agmo@mail.gmail.com>
	<AANLkTikDNPPtfBTsFmsVFWfu2s4BMEYBFrdk2k07Zhuj@mail.gmail.com>
	<AANLkTiku_BRcj5Y-r=w-58uP0aioEhfO=Lp5QY4Nf0oY@mail.gmail.com>
Message-ID: <AANLkTimQY0JK36FMQVFNLfZ-r=4+-6jeY8Xta8cS13oN@mail.gmail.com>

Hi al,
I'm sorry but there are no errors in blpwrapper files.
I try to set the full path of Java api but the problem persist!
I don't understand how's possible!

I get the old version of API but there isn't the java version...

Matteo


On Tue, Mar 22, 2011 at 9:43 PM, Ana Nelson <nelson.ana at gmail.com> wrote:
> There is a problem creating the log file in your home directory.
>
> Some ideas: this might be a permissions issue, you might have 2 instances
> trying to access the same log location, or the directory it's trying to
> write to may be missing.
>
> Do you have anything unusual about your Windows setup that you know of? Can
> you look in your home directory (something like Documents and
> Settings/yourwindowsusername) and see if anything looks strange there? Are
> there any log files there from blp or blpwrapper?
>
>
>
> On Tue, Mar 22, 2011 at 7:12 PM, Matteo Fornasier
> <matteo.fornasier at gmail.com> wrote:
>>
>> Hi all,
>> I've the following problem:
>>
>> > bl = blpConnect(iface="Java")
>> R version 2.12.1 (2010-12-16)
>> rJava Version 0.8-8
>> RBloomberg Version 0.4-145
>> Java environment initialized successfully.
>> Looking for most recent blpapi3.jar file...
>> Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) :
>> java.io.IOException: Couldn't get lock for
>> %h/org.findata.blpwrapper.%g.log
>> Calls: blpConnect ... eval -> eval -> blpConnect.Java -> .jnew ->
>> .External
>>
>> I don't understand how's possible. Any idea?
>>
>> Many thanks in advance,
>>
>> Matteo
>>
>>
>> On Mon, Feb 28, 2011 at 4:15 PM, Ana Nelson <nelson.ana at gmail.com> wrote:
>> > I have now uploaded what should be a fix, although unfortunately I have
>> > managed to mess up the version numbering, so you may have to uninstall
>> > your
>> > existing RBloomberg then install the new one... and that may mean I've
>> > missed a bug fix.
>> >
>> > If possible back up your current installation of RBloomberg before
>> > uninstalling/reinstalling.
>> >
>> > I'll have a proper in-sequence build up within a few days.
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>> >
>
>


From wwl_mok at yahoo.co.uk  Fri Mar 25 14:34:11 2011
From: wwl_mok at yahoo.co.uk (William Mok)
Date: Fri, 25 Mar 2011 13:34:11 +0000 (GMT)
Subject: [R-SIG-Finance] multiple plots with QQplot of PerformanceAnalytics
Message-ID: <529793.83559.qm@web27904.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110325/9bb62e97/attachment.pl>

From josh.m.ulrich at gmail.com  Fri Mar 25 14:37:05 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 25 Mar 2011 08:37:05 -0500
Subject: [R-SIG-Finance] multiple plots with QQplot of
	PerformanceAnalytics
In-Reply-To: <529793.83559.qm@web27904.mail.ukl.yahoo.com>
References: <529793.83559.qm@web27904.mail.ukl.yahoo.com>
Message-ID: <AANLkTikQOeiac6yyEubNnJi03AwZmWgGi98Gkyg81VyR@mail.gmail.com>

Please don't cross-post.
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Fri, Mar 25, 2011 at 8:34 AM, William Mok <wwl_mok at yahoo.co.uk> wrote:
> Hi All,
>
>
> I am trying to plot 4 graphs on to 1 page using layout(...), or par(mfcol =
> c(...)); with the function QQplot from the package PerformanceAnalytics.
> The problem is that, no matter what order I use, it only plots 3 graphs on to 1
> page and the last QQplot is shunted to the next page.
> Also, this only happens to the QQplot, i.e. there is no problem with 4
> Histograms.
>
>
> set.seed(1033)
> data <- matrix(rnorm(240), 240, 2)
> data[,2] <- rt(240, df = 7)
>
> tm <- ts(data, start = c(1990, 1), frequency = 12)
> ret.ts <- as.timeSeries(tm)
>
> layout(rbind(c(1, 2), c(3, 4)))
> #par(mfcol = c(2, 2))
> chart.Histogram(ret.ts[, 1], main = "Density", breaks = 30, methods =
> "add.density")
> chart.Histogram(ret.ts[, 2], main = "Density", breaks = 30, ?methods =
> "add.density")
> chart.QQPlot(ret.ts[, 1])
> chart.QQPlot(ret.ts[, 2])
>
> Any suggestion please. Many thx.
>
> Rgds.,
>
> Will
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From rbali at ufmg.br  Fri Mar 25 15:40:26 2011
From: rbali at ufmg.br (Robert Iquiapaza)
Date: Fri, 25 Mar 2011 11:40:26 -0300
Subject: [R-SIG-Finance] multiple plots with QQplot of
	PerformanceAnalytics
In-Reply-To: <529793.83559.qm@web27904.mail.ukl.yahoo.com>
References: <529793.83559.qm@web27904.mail.ukl.yahoo.com>
Message-ID: <467E6DA0595348D1ACA4E6AD603C217D@DellPC>

William,
There must be some issue with chart.QQPlot, apparently every plot after this 
function goes to another page.
chart.QQPlot(ret.ts[, 1])
chart.Histogram(ret.ts[, 2], main = "Density", breaks = 30,  methods =
"add.density")

Insteat you could use:
qqnorm(ret.ts[, 1])
qqline(ret.ts[, 1], col="blue")

qqnorm(ret.ts[, 2])
qqline(ret.ts[, 2], col="blue")

Good luck

Robert

-----Mensagem Original----- 
From: William Mok
Sent: Friday, March 25, 2011 10:34 AM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] multiple plots with QQplot of PerformanceAnalytics

Hi All,


I am trying to plot 4 graphs on to 1 page using layout(...), or par(mfcol =
c(...)); with the function QQplot from the package PerformanceAnalytics.
The problem is that, no matter what order I use, it only plots 3 graphs on 
to 1
page and the last QQplot is shunted to the next page.
Also, this only happens to the QQplot, i.e. there is no problem with 4
Histograms.


set.seed(1033)
data <- matrix(rnorm(240), 240, 2)
data[,2] <- rt(240, df = 7)

tm <- ts(data, start = c(1990, 1), frequency = 12)
ret.ts <- as.timeSeries(tm)

layout(rbind(c(1, 2), c(3, 4)))
#par(mfcol = c(2, 2))
chart.Histogram(ret.ts[, 1], main = "Density", breaks = 30, methods =
"add.density")
chart.Histogram(ret.ts[, 2], main = "Density", breaks = 30,  methods =
"add.density")
chart.QQPlot(ret.ts[, 1])
chart.QQPlot(ret.ts[, 2])

Any suggestion please. Many thx.

Rgds.,

Will

[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions 
should go.


From johnny.jp.22 at gmail.com  Fri Mar 25 18:40:20 2011
From: johnny.jp.22 at gmail.com (Johnny Paulo)
Date: Fri, 25 Mar 2011 17:40:20 +0000
Subject: [R-SIG-Finance] IBrokers R package: issue with class twsconn (R)
Message-ID: <BANLkTim1Pc6A2YN9fYZ4tQps41AU5ONGOQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110325/a6fe2988/attachment.pl>

From jeffrey.ryan at lemnica.com  Fri Mar 25 19:18:33 2011
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 25 Mar 2011 13:18:33 -0500
Subject: [R-SIG-Finance] IBrokers R package: issue with class twsconn (R)
In-Reply-To: <BANLkTim1Pc6A2YN9fYZ4tQps41AU5ONGOQ@mail.gmail.com>
References: <BANLkTim1Pc6A2YN9fYZ4tQps41AU5ONGOQ@mail.gmail.com>
Message-ID: <AANLkTi=8sHdr=nbDkUjy3CO=7pu-_WgnE2cWDJM1h=aR@mail.gmail.com>

Hi Johnny,

Not a fan of S4 or Stack Overflow, so thanks for posting here!

The issue is S3 in S4.  This should work:

setOldClass("twsconn")  # this is what you are missing
setClass( "MktAsset",
  representation( IB.id = "character",
                          asset.type = "factor",
              ccy = "factor",
              IB.conn = "twsconn") )

# [1] "MktAsset"

a <- new("MktAsset")

ibg <- ibgConnect() # connect to IB Gateway

a at IB.conn <- ibg
a

An object of class "MktAsset"
Slot "IB.id":
character(0)

Slot "asset.type":
factor(0)
Levels:

Slot "ccy":
factor(0)
Levels:

Slot "IB.conn":
<twsConnection,1 @ 20110325 13:15:22 CST, nextId=1>

If you're able to come to R/Finance in Chicago next month
www.RinFinance.com, I'll be doing a two-hour workshop on Friday
morning regarding IBrokers (and algorithmic trading in general with R)
that would be of interest I suspect.

Best,
Jeff



On Fri, Mar 25, 2011 at 12:40 PM, Johnny Paulo <johnny.jp.22 at gmail.com> wrote:
> Hello,
>
> At the moment, I am switching from Python to R and I am trying to write some
> simple code to price a portfolio, using Jeff Ryan's Ibrokers package. I
> would like to have a field of class twsconn in one of my objects
>
> setClass( "MktAsset",
> ?representation( IB.id = "character",
> ? ? ? ? ? ? ? ? ? ? ? ? ?asset.type = "factor",
> ? ? ? ? ? ? ?ccy = "factor",
> ? ? ? ? ? ? ?IB.conn = "twsconn") )
>
> but the system does not seem happy about it
>
> Msg is
>
> In .completeClassSlots(ClassDef, where) : undefined slot classes in
> definition of "MktAsset": IB.connection(class "twsconn")
>
> but when I ask the class of tws (initialized with tws <- twsConnect(), it
> returns
>
> [1] "twsconn" "environment"
>
> I tried to go through the code to check for the existence of a class twsconn
> but, I found nothing.
>
> Can someone help?
>
> Thanks a lot
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com

R/Finance 2011 April 29th and 30th in Chicago | www.RinFinance.com


From brian at braverock.com  Mon Mar 28 13:27:23 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 28 Mar 2011 06:27:23 -0500
Subject: [R-SIG-Finance] Fwd: GSOC 2011 Students: please get ready
Message-ID: <4D90709B.9000906@braverock.com>

R-SIG-Finance Members:

If you or any of your students are interested in participating in the 
Google Summer of code, please join the gsoc-r Google group.

Claudia Beleites sent this to the GSOC-R group earlier today, but I 
suspect that not everyone who might want to participate has joined there 
yet.

Regards,

    - Brian

-------- Original Message --------
Subject: Students: please get ready
Date: Mon, 28 Mar 2011 12:42:14 +0200
From: Claudia Beleites <cbeleites at units.it>
To: gsoc-r at googlegroups.com

Dear students,

this evening the student application will open. So please get your first 
version of the proposal ready.

You'll be able to edit the uploaded proposals after uploading and we
mentors will comment on your proposals in order to improve them. The
final proposal will be the outcome of several iterations between student 
proposal and mentor comments/questions.

It is important that you start immediately getting your proposal online
as we'll need the time to arrive at good project plans.

Claudia


From worik.stanton at gmail.com  Mon Mar 28 23:33:21 2011
From: worik.stanton at gmail.com (Worik)
Date: Tue, 29 Mar 2011 10:33:21 +1300
Subject: [R-SIG-Finance] Sullivan, Timmerman and  White 1999:  TA rules,
	and R
Message-ID: <4D90FEA1.2030800@gmail.com>

[Apologies if I have sent this multiple times.  I have been struggling 
with SMTP sewrvers and I have not seen my message appear on the list]

Friends

I am trying to save myself some tedious work.

I am processing a paper from  "The Journal Of Finance * Vol. LIV, No. 5  
October 1999" by Sullivan,  Timmerman and  White.  "Data-Snooping, 
Technical Trading Rule Performance, and the Bootstrap"

I am aiming to reproduce their results using the same  TA rules as they 
used.

They describe the rules they use in English and I am in the process of 
trying to programme them into R.  But if some one has already done this 
it would save me a pile of work.

It would be nice to just grab some rules from the TTR package, but 
because of the way STW describe the rules it is quite a lot of work to 
calculate what parameters to use.

So I am clutching at a straw here:  If anybody could point me in a 
better direction than slogging through the English text and trying to 
match that with the TTR docs I would be grateful

cheers
Worik

PS Here is an example of their text.  Not that it is bad, just quite a 
bit of work....

     A. Filter Rules
Filter rules are used in Alexander (1961) to assess the efficiency of stock
price movements. Fama and Blume (1966) explain the standard filter rule:
An x per cent filter is defined as follows: If the daily closing price of a
particular security moves up at least x per cent, buy and hold the se-
curity until its price moves down at least x per cent from a subsequent
high, at which time simultaneously sell and go short. The short position
is maintained until the daily closing price rises at least x per cent above
a subsequent low at which time one covers and buys. Moves less than x
per cent in either direction are ignored. (p. 227)
The first item of consideration is how to define subsequent lows and highs.
We will do this in two ways. As the above excerpt suggests, a subsequent
high is the highest closing price achieved while holding a particular long
position. Likewise, a subsequent low is the lowest closing price achieved
while holding a particular short position. Alternatively, a low (high) 
can be
defined as the most recent closing price that is less (greater) than the e
previous closing prices. Next, we will expand the universe of filter 
rules by
allowing a neutral position to be imposed. This is accomplished by 
liquidat-
ing a long position when the price decreases y percent from the previous
high, and covering a short position when the price increases y percent from
the previous low. Following BLL, we also consider holding a given long or
short position for a prespecified number of days, c, effectively 
ignoring all
other signals generated during that time.

-- 
If we amplify everything, we hear nothing.
--


From josh.m.ulrich at gmail.com  Tue Mar 29 08:24:11 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 29 Mar 2011 01:24:11 -0500
Subject: [R-SIG-Finance] Sullivan, Timmerman and White 1999: TA rules,
	and R
In-Reply-To: <4D90FEA1.2030800@gmail.com>
References: <4D90FEA1.2030800@gmail.com>
Message-ID: <AANLkTikuLF=h-hzxrKrFPcmWJ7MSVke7zPLZBk9nLZ3A@mail.gmail.com>

Hi Worik,

There are 5 types of rules: filter rules, moving averages, support and
resistance, channel break-outs, and on-balance volume averages.  TTR
contains what you need for moving averages, channel break-outs
(DonchianChannel) and on-balance volume (OBV).

I coded filter rules in another language a few years ago, so I could
help you write them in R.  I don't understand how the support and
resistance rules differ from the channel break-outs, but that could be
due to the time of day and my lack of sleep.  Regardless, I doubt they
would be difficult to code.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



On Mon, Mar 28, 2011 at 4:33 PM, Worik <worik.stanton at gmail.com> wrote:
> [Apologies if I have sent this multiple times. ?I have been struggling with
> SMTP sewrvers and I have not seen my message appear on the list]
>
> Friends
>
> I am trying to save myself some tedious work.
>
> I am processing a paper from ?"The Journal Of Finance * Vol. LIV, No. 5
> ?October 1999" by Sullivan, ?Timmerman and ?White. ?"Data-Snooping,
> Technical Trading Rule Performance, and the Bootstrap"
>
> I am aiming to reproduce their results using the same ?TA rules as they
> used.
>
> They describe the rules they use in English and I am in the process of
> trying to programme them into R. ?But if some one has already done this it
> would save me a pile of work.
>
> It would be nice to just grab some rules from the TTR package, but because
> of the way STW describe the rules it is quite a lot of work to calculate
> what parameters to use.
>
> So I am clutching at a straw here: ?If anybody could point me in a better
> direction than slogging through the English text and trying to match that
> with the TTR docs I would be grateful
>
> cheers
> Worik
>
> PS Here is an example of their text. ?Not that it is bad, just quite a bit
> of work....
>
> ? ?A. Filter Rules
> Filter rules are used in Alexander (1961) to assess the efficiency of stock
> price movements. Fama and Blume (1966) explain the standard filter rule:
> An x per cent filter is defined as follows: If the daily closing price of a
> particular security moves up at least x per cent, buy and hold the se-
> curity until its price moves down at least x per cent from a subsequent
> high, at which time simultaneously sell and go short. The short position
> is maintained until the daily closing price rises at least x per cent above
> a subsequent low at which time one covers and buys. Moves less than x
> per cent in either direction are ignored. (p. 227)
> The first item of consideration is how to define subsequent lows and highs.
> We will do this in two ways. As the above excerpt suggests, a subsequent
> high is the highest closing price achieved while holding a particular long
> position. Likewise, a subsequent low is the lowest closing price achieved
> while holding a particular short position. Alternatively, a low (high) can
> be
> defined as the most recent closing price that is less (greater) than the e
> previous closing prices. Next, we will expand the universe of filter rules
> by
> allowing a neutral position to be imposed. This is accomplished by liquidat-
> ing a long position when the price decreases y percent from the previous
> high, and covering a short position when the price increases y percent from
> the previous low. Following BLL, we also consider holding a given long or
> short position for a prespecified number of days, c, effectively ignoring
> all
> other signals generated during that time.
>
> --
> If we amplify everything, we hear nothing.
> --
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From jond at hi.is  Tue Mar 29 11:24:09 2011
From: jond at hi.is (jond)
Date: Tue, 29 Mar 2011 09:24:09 +0000
Subject: [R-SIG-Finance] risk forecasting book with R code
Message-ID: <760855d555de9eec36d9d2137853db16@hi.is>

I just published a book on financial risk forecasting with the R (and
Matlab) code to implement all the procedures in the book available on
http://www.financialriskforecasting.com/


From brian at braverock.com  Tue Mar 29 13:50:39 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 29 Mar 2011 06:50:39 -0500
Subject: [R-SIG-Finance] Sullivan, Timmerman and  White 1999:  TA rules,
 and R
In-Reply-To: <4D90FEA1.2030800@gmail.com>
References: <4D90FEA1.2030800@gmail.com>
Message-ID: <4D91C78F.8010905@braverock.com>

On 03/28/2011 04:33 PM, Worik wrote:
> [Apologies if I have sent this multiple times. I have been struggling
> with SMTP sewrvers and I have not seen my message appear on the list]
>
> Friends
>
> I am trying to save myself some tedious work.
>
> I am processing a paper from "The Journal Of Finance * Vol. LIV, No. 5
> October 1999" by Sullivan, Timmerman and White. "Data-Snooping,
> Technical Trading Rule Performance, and the Bootstrap"
>
> I am aiming to reproduce their results using the same TA rules as they
> used.
>
> They describe the rules they use in English and I am in the process of
> trying to programme them into R. But if some one has already done this
> it would save me a pile of work.
>
> It would be nice to just grab some rules from the TTR package, but
> because of the way STW describe the rules it is quite a lot of work to
> calculate what parameters to use.
>
> So I am clutching at a straw here: If anybody could point me in a better
> direction than slogging through the English text and trying to match
> that with the TTR docs I would be grateful
>
> cheers
> Worik
>
> PS Here is an example of their text. Not that it is bad, just quite a
> bit of work....
>
> A. Filter Rules
> Filter rules are used in Alexander (1961) to assess the efficiency of stock
> price movements. Fama and Blume (1966) explain the standard filter rule:
> An x per cent filter is defined as follows: If the daily closing price of a
> particular security moves up at least x per cent, buy and hold the se-
> curity until its price moves down at least x per cent from a subsequent
> high, at which time simultaneously sell and go short. The short position
> is maintained until the daily closing price rises at least x per cent above
> a subsequent low at which time one covers and buys. Moves less than x
> per cent in either direction are ignored. (p. 227)
> The first item of consideration is how to define subsequent lows and highs.
> We will do this in two ways. As the above excerpt suggests, a subsequent
> high is the highest closing price achieved while holding a particular long
> position. Likewise, a subsequent low is the lowest closing price achieved
> while holding a particular short position. Alternatively, a low (high)
> can be defined as the most recent closing
> price that is less (greater) than the e
> previous closing prices. Next, we will expand the universe of filter
> rules by allowing a neutral position to be imposed.
> This is accomplished by liquidating a long position when
> the price decreases y percent from the previous
> high, and covering a short position when the price increases y percent from
> the previous low. Following BLL, we also consider holding a given long or
> short position for a prespecified number of days, c, effectively
> ignoring all other signals generated during that time.

I've read this paper, though it's been quite a while, and considered 
replicating parts of it.  I don't recall there being anything there that 
would really be taken out of TTR though.  As I recall, and as your 
example shows, the paper is really more concerned with pattern 
recognition and then having simple entry/exit signals and rules.  I 
would probably use quantstrat to program each signal/rule pair.

Again, assuming my recollection of the paper is correct, you would not 
need any indicators (which is predominantly what TTR provides), but 
rather need to construct signal generating procedures for entry and 
exit.  For the example above, you'd need to convert the price series 
into a return series as well, and I think this is your only 'indicator' 
(i.e. transformation of the data required before you may generate signals).

So, for example, you would use the signal generator functions 
sigCrossover sigThreshold, sigPeak, and maybe sigFormula to generate 
your entry and exit signals.  Then, rule generation for entry and exit 
rules proceeds as normal using ruleSignal.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Tue Mar 29 14:15:05 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 29 Mar 2011 07:15:05 -0500
Subject: [R-SIG-Finance] Sullivan, Timmerman and White 1999: TA rules,
 and R
In-Reply-To: <AANLkTikuLF=h-hzxrKrFPcmWJ7MSVke7zPLZBk9nLZ3A@mail.gmail.com>
References: <4D90FEA1.2030800@gmail.com>
	<AANLkTikuLF=h-hzxrKrFPcmWJ7MSVke7zPLZBk9nLZ3A@mail.gmail.com>
Message-ID: <4D91CD49.4070203@braverock.com>

OK, so Josh actually reviewed the paper rather than relying on hazy 
recollection (my bad).

Based on this, you'd apply the relevant indicators for MA periods, 
DonchianChannel, or OBV, es needed.  Channel Break-outs are also often 
called pivots.  We have some code for this, and will endeavor to 
document it and get it into TTR.

After any indicators are applied, as required, you'll then generate 
signals as I described in my prior email.

Regards,

   - Brian

On 03/29/2011 01:24 AM, Joshua Ulrich wrote:
> Hi Worik,
>
> There are 5 types of rules: filter rules, moving averages, support and
> resistance, channel break-outs, and on-balance volume averages.  TTR
> contains what you need for moving averages, channel break-outs
> (DonchianChannel) and on-balance volume (OBV).
>
> I coded filter rules in another language a few years ago, so I could
> help you write them in R.  I don't understand how the support and
> resistance rules differ from the channel break-outs, but that could be
> due to the time of day and my lack of sleep.  Regardless, I doubt they
> would be difficult to code.
>
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
> On Mon, Mar 28, 2011 at 4:33 PM, Worik<worik.stanton at gmail.com>  wrote:
>> [Apologies if I have sent this multiple times.  I have been struggling with
>> SMTP sewrvers and I have not seen my message appear on the list]
>>
>> Friends
>>
>> I am trying to save myself some tedious work.
>>
>> I am processing a paper from  "The Journal Of Finance * Vol. LIV, No. 5
>>   October 1999" by Sullivan,  Timmerman and  White.  "Data-Snooping,
>> Technical Trading Rule Performance, and the Bootstrap"
>>
>> I am aiming to reproduce their results using the same  TA rules as they
>> used.
>>
>> They describe the rules they use in English and I am in the process of
>> trying to programme them into R.  But if some one has already done this it
>> would save me a pile of work.
>>
>> It would be nice to just grab some rules from the TTR package, but because
>> of the way STW describe the rules it is quite a lot of work to calculate
>> what parameters to use.
>>
>> So I am clutching at a straw here:  If anybody could point me in a better
>> direction than slogging through the English text and trying to match that
>> with the TTR docs I would be grateful
>>
>> cheers
>> Worik
>>
>> PS Here is an example of their text.  Not that it is bad, just quite a bit
>> of work....
>>
>>     A. Filter Rules
>> Filter rules are used in Alexander (1961) to assess the efficiency of stock
>> price movements. Fama and Blume (1966) explain the standard filter rule:
>> An x per cent filter is defined as follows: If the daily closing price of a
>> particular security moves up at least x per cent, buy and hold the se-
>> curity until its price moves down at least x per cent from a subsequent
>> high, at which time simultaneously sell and go short. The short position
>> is maintained until the daily closing price rises at least x per cent above
>> a subsequent low at which time one covers and buys. Moves less than x
>> per cent in either direction are ignored. (p. 227)
>> The first item of consideration is how to define subsequent lows and highs.
>> We will do this in two ways. As the above excerpt suggests, a subsequent
>> high is the highest closing price achieved while holding a particular long
>> position. Likewise, a subsequent low is the lowest closing price achieved
>> while holding a particular short position. Alternatively, a low (high) can
>> be
>> defined as the most recent closing price that is less (greater) than the e
>> previous closing prices. Next, we will expand the universe of filter rules
>> by
>> allowing a neutral position to be imposed. This is accomplished by liquidat-
>> ing a long position when the price decreases y percent from the previous
>> high, and covering a short position when the price increases y percent from
>> the previous low. Following BLL, we also consider holding a given long or
>> short position for a prespecified number of days, c, effectively ignoring
>> all
>> other signals generated during that time.


From WangYu at thisisnoble.com  Tue Mar 29 18:54:42 2011
From: WangYu at thisisnoble.com (Wang Yu)
Date: Tue, 29 Mar 2011 12:54:42 -0400
Subject: [R-SIG-Finance] Noble America Summer Internship 2011 Announcement
Message-ID: <9530A3E1599DBD4AA061423EEDCF7E9D0CA957@USXLXEXC100.NG.CORP>

#####################################################

Noble America Announcement for Summer Internship 2011 

######################################################

Organization Name: Noble America, http://www.thisisnoble.com/   

Location: Stamford, Connecticut, USA 

Period: 10-12 Weeks for Summer 2011 starting May/June 2011

Brief Description of work: 


The summer intern will work on building tools for the Trading/Risk groups, and would require:

1. Strong knowledge of R and C# programming
2. Strong knowledge of time series (more generally mathematical and statistical knowledge is welcome but not strictly necessary)
3. Financial engineering knowledge, specifically in the area of derivative pricing, is a great plus.  General Finance knowledge is _not_ required.

Typical tasks include:

1. Helping with the testing and building of new systems, tools, models, etc for commodity trading desks
2. Documentation of existing tools, models, etc

The typical intern may expect to work closely with Risk and Trading and gain some valuable experience in the makings of tools and analysis pertaining to commodities trading (especially Natural Gas and Power)

======================================================

Application: Please send CV by email

For information please address :

Wang Yu (WangYu at thisisnoble.com) and Yannis Tzamouranis (yct at thisisnoble.com)


From johnny.jp.22 at gmail.com  Tue Mar 29 20:20:15 2011
From: johnny.jp.22 at gmail.com (Johnny Paulo)
Date: Tue, 29 Mar 2011 19:20:15 +0100
Subject: [R-SIG-Finance] reqMktData in IBrokers
Message-ID: <BANLkTi=B52YxctD_Vpr6fqXKEYuuAYqqAA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110329/4a785f38/attachment.pl>

From algotr8der at gmail.com  Wed Mar 30 01:39:48 2011
From: algotr8der at gmail.com (algotr8der)
Date: Tue, 29 Mar 2011 16:39:48 -0700
Subject: [R-SIG-Finance] Interpreting cointegration - ur.df() and ad.test()
Message-ID: <1301441988233-3416574.post@n4.nabble.com>

Hello folks,

I have read several posts on here regarding cointegration and the various
tests that check for this. 

Here is what I have done - where securityA and securityB are time series
price data.

series <- merge(securityA, securityB,  all=FALSE)
series <- as.data.frame(series)
m <- lm(securityA ~ securityB+ 0, data=series)
beta1 <- coef(m)[1]
sprd = series$securityA - beta1*series$securityB

> adf.test(sprd, alternative="stationary",k=1) 

Augmented Dickey-Fuller Test

data:  sprd 
Dickey-Fuller = -3.9226, Lag order = 1, p-value = 0.01281
alternative hypothesis: stationary 

> summary(ur.df(sprd, type="trend", lag=1))

############################################### 
# Augmented Dickey-Fuller Test Unit Root Test # 
############################################### 

Test regression trend 


Call:
lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.91172 -0.02737 -0.00097  0.02553  0.98989 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.434e-02  6.790e-03  -3.584 0.000340 ***
z.lag.1     -5.309e-03  1.353e-03  -3.923 8.85e-05 ***
tt           8.143e-06  2.134e-06   3.816 0.000137 ***
z.diff.lag  -5.345e-02  1.226e-02  -4.360 1.32e-05 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

Residual standard error: 0.05266 on 6624 degrees of freedom
Multiple R-squared: 0.005505,	Adjusted R-squared: 0.005055 
F-statistic: 12.22 on 3 and 6624 DF,  p-value: 5.676e-08 


Value of test-statistic is: -3.9226 6.7405 7.7586 

Critical values for test statistics: 
      1pct  5pct 10pct
tau3 -3.96 -3.41 -3.12
phi2  6.09  4.68  4.03
phi3  8.27  6.25  5.34


Both results indicate that the time series 'sprd' is cointegrated and thus
mean reverting. However looking at the plot one can clearly see that the
series is trending and is not mean reverting. Any thoughts would be greatly
appreciated.

>plot(sprd, type="l")

http://r.789695.n4.nabble.com/file/n3416574/Screen_shot_2011-03-29_at_7.37.39_PM.png 


--
View this message in context: http://r.789695.n4.nabble.com/Interpreting-cointegration-ur-df-and-ad-test-tp3416574p3416574.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From algotr8der at gmail.com  Wed Mar 30 03:01:07 2011
From: algotr8der at gmail.com (algotr8der)
Date: Tue, 29 Mar 2011 18:01:07 -0700
Subject: [R-SIG-Finance] Interpreting cointegration - ur.df() and
	ad.test()
In-Reply-To: <1301441988233-3416574.post@n4.nabble.com>
References: <1301441988233-3416574.post@n4.nabble.com>
Message-ID: <1301446867001-3416732.post@n4.nabble.com>

I just attached the time series source data to the original post. The data is
1 minute data.

--
View this message in context: http://r.789695.n4.nabble.com/Interpreting-cointegration-ur-df-and-ad-test-tp3416574p3416732.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From renoirvieira at gmail.com  Wed Mar 30 04:34:00 2011
From: renoirvieira at gmail.com (renoir vieira)
Date: Tue, 29 Mar 2011 23:34:00 -0300
Subject: [R-SIG-Finance] CAPM Wavelets
Message-ID: <AANLkTi=1x_TAy2nr1bp28WLZssBSHJ7TtUdCxKxyAs89@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110329/ee8c5df1/attachment.pl>

From paulteetor at yahoo.com  Wed Mar 30 06:35:56 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Tue, 29 Mar 2011 21:35:56 -0700
Subject: [R-SIG-Finance] Interpreting cointegration - ur.df() and
	ad.test()
In-Reply-To: <1301441988233-3416574.post@n4.nabble.com>
References: <1301441988233-3416574.post@n4.nabble.com>
Message-ID: <756707.62207.qm@web65909.mail.ac4.yahoo.com>

algotr8der:

The adf.test function essentially detrends your data before performing the ADF 
test. (That's what the help page means when it says, "The general regression 
equation which incorporates a constant and a linear trend is used.")  The data 
plot may appear to be trending upward, but the function removes that trend 
first. If you plot the detrended data, you'll see the data that the function is 
testing. It should be going "sideways" compared to your original, trendy data.

The ur.df function performs a similar detrending when you specify type="trend". 
(OK, more precisely: it detrends in conjunction with performing the ADF test.)

HTH,

Paul


 
Paul Teetor, Elgin, IL  USA
http://quanttrader.info/public



----- Original Message ----
From: algotr8der <algotr8der at gmail.com>
To: r-sig-finance at stat.math.ethz.ch
Sent: Tue, March 29, 2011 6:39:48 PM
Subject: [R-SIG-Finance] Interpreting cointegration - ur.df() and ad.test()

Hello folks,

I have read several posts on here regarding cointegration and the various
tests that check for this. 

Here is what I have done - where securityA and securityB are time series
price data.

series <- merge(securityA, securityB,  all=FALSE)
series <- as.data.frame(series)
m <- lm(securityA ~ securityB+ 0, data=series)
beta1 <- coef(m)[1]
sprd = series$securityA - beta1*series$securityB

> adf.test(sprd, alternative="stationary",k=1) 

Augmented Dickey-Fuller Test

data:  sprd 
Dickey-Fuller = -3.9226, Lag order = 1, p-value = 0.01281
alternative hypothesis: stationary 

> summary(ur.df(sprd, type="trend", lag=1))

############################################### 
# Augmented Dickey-Fuller Test Unit Root Test # 
############################################### 

Test regression trend 


Call:
lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.91172 -0.02737 -0.00097  0.02553  0.98989 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.434e-02  6.790e-03  -3.584 0.000340 ***
z.lag.1     -5.309e-03  1.353e-03  -3.923 8.85e-05 ***
tt           8.143e-06  2.134e-06   3.816 0.000137 ***
z.diff.lag  -5.345e-02  1.226e-02  -4.360 1.32e-05 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

Residual standard error: 0.05266 on 6624 degrees of freedom
Multiple R-squared: 0.005505,    Adjusted R-squared: 0.005055 
F-statistic: 12.22 on 3 and 6624 DF,  p-value: 5.676e-08 


Value of test-statistic is: -3.9226 6.7405 7.7586 

Critical values for test statistics: 
      1pct  5pct 10pct
tau3 -3.96 -3.41 -3.12
phi2  6.09  4.68  4.03
phi3  8.27  6.25  5.34


Both results indicate that the time series 'sprd' is cointegrated and thus
mean reverting. However looking at the plot one can clearly see that the
series is trending and is not mean reverting. Any thoughts would be greatly
appreciated.

>plot(sprd, type="l")

http://r.789695.n4.nabble.com/file/n3416574/Screen_shot_2011-03-29_at_7.37.39_PM.png
 


--
View this message in context: 
http://r.789695.n4.nabble.com/Interpreting-cointegration-ur-df-and-ad-test-tp3416574p3416574.html

Sent from the Rmetrics mailing list archive at Nabble.com.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should 
go.


From breman.mark at gmail.com  Wed Mar 30 08:12:35 2011
From: breman.mark at gmail.com (Mark Breman)
Date: Wed, 30 Mar 2011 08:12:35 +0200
Subject: [R-SIG-Finance] Interpreting cointegration - ur.df() and
	ad.test()
In-Reply-To: <1301446867001-3416732.post@n4.nabble.com>
References: <1301441988233-3416574.post@n4.nabble.com>
	<1301446867001-3416732.post@n4.nabble.com>
Message-ID: <AANLkTikXX34wEz7WbzkFZ8uGyHtVVT0BYnqeconUgm+6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110330/516ef78e/attachment.pl>

From Danilo.Mercurio at Sparinvest.com  Wed Mar 30 10:12:52 2011
From: Danilo.Mercurio at Sparinvest.com (Mercurio Danilo 1850 SPI)
Date: Wed, 30 Mar 2011 10:12:52 +0200
Subject: [R-SIG-Finance] fPortfolioSolver
In-Reply-To: <1301441988233-3416574.post@n4.nabble.com>
References: <1301441988233-3416574.post@n4.nabble.com>
Message-ID: <F15AA09E242F834FA21B03F1590005BE1C05AD4522@M0173.s-mxs.net>

Hi!

I would like to test portfolio optimization by maximizing the return for given risk.
I have been trying with fPortfolio and solveRsocp.

However it seems that the required solver is not in the CRAN release of Rmetrics 
(a wonderful package anyway, praise the developpers !!!).

I have tried on R-Forge (see Below). But I even did not find the package.

Can anybody help me?

many thanks 

danilo

-------------------------------------------------
install.packages("fPortfolioSolver", repos="http://R-Forge.R-project.org")
Warnmeldung:
In getDependencies(pkgs, dependencies, available, lib) :
  package 'fPortfolioSolver' is not available

From brian at braverock.com  Wed Mar 30 13:18:59 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 30 Mar 2011 06:18:59 -0500
Subject: [R-SIG-Finance] fPortfolioSolver
In-Reply-To: <F15AA09E242F834FA21B03F1590005BE1C05AD4522@M0173.s-mxs.net>
References: <1301441988233-3416574.post@n4.nabble.com>
	<F15AA09E242F834FA21B03F1590005BE1C05AD4522@M0173.s-mxs.net>
Message-ID: <4D9311A3.3050804@braverock.com>

You can look at the code on R-Forge easily enough.  Many of the Rmetrics 
packages have been renamed and rearranged over time.

Also, there is a custom Rmetrics installer similar to the BioC 
installers along with installation instructions available on the 
Rmetrics website.

Regards,

    - Brian

On 03/30/2011 03:12 AM, Mercurio Danilo 1850 SPI wrote:
> Hi!
>
> I would like to test portfolio optimization by maximizing the return for given risk.
> I have been trying with fPortfolio and solveRsocp.
>
> However it seems that the required solver is not in the CRAN release of Rmetrics
> (a wonderful package anyway, praise the developpers !!!).
>
> I have tried on R-Forge (see Below). But I even did not find the package.
>
> Can anybody help me?
>
> many thanks
>
> danilo
>
> -------------------------------------------------
> install.packages("fPortfolioSolver", repos="http://R-Forge.R-project.org")
> Warnmeldung:
> In getDependencies(pkgs, dependencies, available, lib) :
>    package 'fPortfolioSolver' is not available
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From alex.rudnev at gmail.com  Wed Mar 30 14:18:55 2011
From: alex.rudnev at gmail.com (alex.rudnev at gmail.com)
Date: Wed, 30 Mar 2011 12:18:55 +0000
Subject: [R-SIG-Finance] fPortfolioSolver
In-Reply-To: <4D9311A3.3050804@braverock.com>
References: <1301441988233-3416574.post@n4.nabble.com><F15AA09E242F834FA21B03F1590005BE1C05AD4522@M0173.s-mxs.net><4D9311A3.3050804@braverock.com>
Message-ID: <793523183-1301487535-cardhu_decombobulator_blackberry.rim.net-237855112-@bda834.bisx.prod.on.blackberry>

fPortfolioSolver depends on Rsymphony, and Rsymphony can not be installed on Windows anymore, even from source. Last available build for it was for 2.11 (which works with Revolution R 4.0 for example).

Sent via BlackBerry by AT&T

-----Original Message-----
From: "Brian G. Peterson" <brian at braverock.com>
Sender: r-sig-finance-bounces at r-project.orgDate: Wed, 30 Mar 2011 06:18:59 
To: <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] fPortfolioSolver

You can look at the code on R-Forge easily enough.  Many of the Rmetrics 
packages have been renamed and rearranged over time.

Also, there is a custom Rmetrics installer similar to the BioC 
installers along with installation instructions available on the 
Rmetrics website.

Regards,

    - Brian

On 03/30/2011 03:12 AM, Mercurio Danilo 1850 SPI wrote:
> Hi!
>
> I would like to test portfolio optimization by maximizing the return for given risk.
> I have been trying with fPortfolio and solveRsocp.
>
> However it seems that the required solver is not in the CRAN release of Rmetrics
> (a wonderful package anyway, praise the developpers !!!).
>
> I have tried on R-Forge (see Below). But I even did not find the package.
>
> Can anybody help me?
>
> many thanks
>
> danilo
>
> -------------------------------------------------
> install.packages("fPortfolioSolver", repos="http://R-Forge.R-project.org")
> Warnmeldung:
> In getDependencies(pkgs, dependencies, available, lib) :
>    package 'fPortfolioSolver' is not available
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

From karlavhv142 at hotmail.com  Wed Mar 30 17:37:33 2011
From: karlavhv142 at hotmail.com (karla hernandez villafuerte)
Date: Wed, 30 Mar 2011 09:37:33 -0600
Subject: [R-SIG-Finance] change class: cajolst and cajorls
Message-ID: <COL124-W2089C3FD85217F397F2B82E5BC0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110330/7f1e485f/attachment.pl>

From karlavhv142 at hotmail.com  Wed Mar 30 17:39:23 2011
From: karlavhv142 at hotmail.com (karla hernandez villafuerte)
Date: Wed, 30 Mar 2011 09:39:23 -0600
Subject: [R-SIG-Finance] change class: cajolst and cajorls
In-Reply-To: <COL124-W2089C3FD85217F397F2B82E5BC0@phx.gbl>
References: <COL124-W2089C3FD85217F397F2B82E5BC0@phx.gbl>
Message-ID: <COL124-W41A4F4C00E1B38C760F4E9E5BC0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110330/c176be44/attachment.pl>

From henry.ward at me.com  Wed Mar 30 19:19:00 2011
From: henry.ward at me.com (Henry Ward)
Date: Wed, 30 Mar 2011 10:19:00 -0700
Subject: [R-SIG-Finance] fPortfolio inverse VaR function
In-Reply-To: <4D876272.4090704@braverock.com>
References: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>
	<4D875A74.2020800@braverock.com>
	<AANLkTinYrZrAYPkh3sDFPK2f5ObA3SS5qqf6eZh8mBtD@mail.gmail.com>
	<4D876272.4090704@braverock.com>
Message-ID: <1A2E2912-7DB7-43E7-97B7-93276097915A@me.com>

Hi members,

I am using fPortfolio (great package) to do Cornish Fisher VaR calculations.  I'm interested in also using the inverse function.  So instead of calculating the p=95% -> VaR = 2.4% I'd like to assign a VaR threshold of VaR = 2.4% -> p=95%. 

This is the simple qnorm function for gaussian distributions but I want to use Brian's implementation of the Cornish Fisher distribution.  Any help on a simple way I can write or find this function?

Henry


From brian at braverock.com  Wed Mar 30 19:34:45 2011
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 30 Mar 2011 12:34:45 -0500
Subject: [R-SIG-Finance] fPortfolio inverse VaR function
In-Reply-To: <1A2E2912-7DB7-43E7-97B7-93276097915A@me.com>
References: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>	<4D875A74.2020800@braverock.com>	<AANLkTinYrZrAYPkh3sDFPK2f5ObA3SS5qqf6eZh8mBtD@mail.gmail.com>	<4D876272.4090704@braverock.com>
	<1A2E2912-7DB7-43E7-97B7-93276097915A@me.com>
Message-ID: <4D9369B5.8000700@braverock.com>

On 03/30/2011 12:19 PM, Henry Ward wrote:
> Hi members,
>
> I am using fPortfolio (great package) to do Cornish Fisher VaR calculations.  I'm interested in also using the inverse function.  So instead of calculating the p=95% ->  VaR = 2.4% I'd like to assign a VaR threshold of VaR = 2.4% ->  p=95%.
>
> This is the simple qnorm function for gaussian distributions but I want to use Brian's implementation of the Cornish Fisher distribution.  Any help on a simple way I can write or find this function?

There are functions in PerformanceAnalytics that are not yet documented 
and exported to do this.

These are available in this source file here:

https://r-forge.r-project.org/scm/viewvc.php/pkg/PerformanceAnalytics/R/valueAtRiskFunctions.r?view=markup&root=returnanalytics

Given a specific shape (mean, variance, skewness, kurtosis) the full 
quantile and density functions for the Cornish Fisher distribution may 
be calculated via the bootstrap.  If you really just want the opposite 
quantile, you can calculate it like this:

   zc = qnorm(tail.prob)
   Zcf = zc + (((zc^2 - 1) * skew)/6) + (((zc^3 - 3 * zc) *
                 kurt)/24) - ((((2 * zc^3) - 5 * zc) * skew^2)/36)
   mVaR = mu + sigma*Zcf

where tail.prob is the usual 1-confidence, so for 95% VaR (loss) you'd 
use .05, and for the opposite end of the distribution you would use .95

We don't allow this in the VaR function because we got too many confused 
emails, instead we document it as not allowed. ;)

Cheers,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From henry.ward at me.com  Wed Mar 30 19:42:59 2011
From: henry.ward at me.com (Henry Ward)
Date: Wed, 30 Mar 2011 10:42:59 -0700
Subject: [R-SIG-Finance] fPortfolio inverse VaR function
In-Reply-To: <4D9369B5.8000700@braverock.com>
References: <AANLkTinLMbzgnbWECOXCd3VQQtDb=39mHLOdTeEep3qX@mail.gmail.com>
	<4D875A74.2020800@braverock.com>
	<AANLkTinYrZrAYPkh3sDFPK2f5ObA3SS5qqf6eZh8mBtD@mail.gmail.com>
	<4D876272.4090704@braverock.com>
	<1A2E2912-7DB7-43E7-97B7-93276097915A@me.com>
	<4D9369B5.8000700@braverock.com>
Message-ID: <E3B75139-5511-4BE7-ABFD-7617347D81C5@me.com>

Brian,

Thank you, this is exactly what I need.  I had a sneaking suspicion you had already done this. :)  Another shout-out for your very useful package.  Thanks.

Henry




On Mar 30, 2011, at 10:34 AM, Brian G. Peterson wrote:

> On 03/30/2011 12:19 PM, Henry Ward wrote:
>> Hi members,
>> 
>> I am using fPortfolio (great package) to do Cornish Fisher VaR calculations.  I'm interested in also using the inverse function.  So instead of calculating the p=95% ->  VaR = 2.4% I'd like to assign a VaR threshold of VaR = 2.4% ->  p=95%.
>> 
>> This is the simple qnorm function for gaussian distributions but I want to use Brian's implementation of the Cornish Fisher distribution.  Any help on a simple way I can write or find this function?
> 
> There are functions in PerformanceAnalytics that are not yet documented and exported to do this.
> 
> These are available in this source file here:
> 
> https://r-forge.r-project.org/scm/viewvc.php/pkg/PerformanceAnalytics/R/valueAtRiskFunctions.r?view=markup&root=returnanalytics
> 
> Given a specific shape (mean, variance, skewness, kurtosis) the full quantile and density functions for the Cornish Fisher distribution may be calculated via the bootstrap.  If you really just want the opposite quantile, you can calculate it like this:
> 
>  zc = qnorm(tail.prob)
>  Zcf = zc + (((zc^2 - 1) * skew)/6) + (((zc^3 - 3 * zc) *
>                kurt)/24) - ((((2 * zc^3) - 5 * zc) * skew^2)/36)
>  mVaR = mu + sigma*Zcf
> 
> where tail.prob is the usual 1-confidence, so for 95% VaR (loss) you'd use .05, and for the opposite end of the distribution you would use .95
> 
> We don't allow this in the VaR function because we got too many confused emails, instead we document it as not allowed. ;)
> 
> Cheers,
> 
>  - Brian
> 
> -- 
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock


From hgaronfolo at gmail.com  Thu Mar 31 16:52:18 2011
From: hgaronfolo at gmail.com (Herbert Julius Garonfolo)
Date: Thu, 31 Mar 2011 10:52:18 -0400
Subject: [R-SIG-Finance] Vector Autoregression on Panel Data
Message-ID: <AANLkTi=djMSX03iHXBnDOw=mMTEKXXpewOaWFYFFvaJn@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20110331/75589bcd/attachment.pl>

From paulteetor at yahoo.com  Thu Mar 31 20:39:01 2011
From: paulteetor at yahoo.com (Paul Teetor)
Date: Thu, 31 Mar 2011 11:39:01 -0700 (PDT)
Subject: [R-SIG-Finance] Vector Autoregression on Panel Data
In-Reply-To: <AANLkTi=djMSX03iHXBnDOw=mMTEKXXpewOaWFYFFvaJn@mail.gmail.com>
References: <AANLkTi=djMSX03iHXBnDOw=mMTEKXXpewOaWFYFFvaJn@mail.gmail.com>
Message-ID: <553003.17530.qm@web65909.mail.ac4.yahoo.com>

Herbert,

(1) Did you try searching at http://www.rseek.org? When I searched on "vector 
autoregression", it returned hundreds of results.

(2) What is the difference between VAR on panel data versus VAR on multivariate 
time series? I apologize if this is a stupid question, but I don't understand 
the difference. The task view page for Time Series Analysis 
(http://cran.r-project.org/web/views/TimeSeries.html) lists several packages for 
multivariate time series analysis.

HTH,
Paul


 
Paul Teetor, Elgin, IL  USA
http://quanttrader.info/public



----- Original Message ----
From: Herbert Julius Garonfolo <hgaronfolo at gmail.com>
To: r-sig-finance at r-project.org
Sent: Thu, March 31, 2011 9:52:18 AM
Subject: [R-SIG-Finance] Vector Autoregression on Panel Data

Hi

I would like to do a Vector Autoregression model on panel data. Is this
possible in R? and are there any built in functionality to perform this kind
of model?

Thank you very much for your time.

Herbert

    [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should 
go.


From ezivot at u.washington.edu  Thu Mar 31 21:13:43 2011
From: ezivot at u.washington.edu (Eric Zivot)
Date: Thu, 31 Mar 2011 12:13:43 -0700
Subject: [R-SIG-Finance] Vector Autoregression on Panel Data
In-Reply-To: <553003.17530.qm@web65909.mail.ac4.yahoo.com>
References: <AANLkTi=djMSX03iHXBnDOw=mMTEKXXpewOaWFYFFvaJn@mail.gmail.com>
	<553003.17530.qm@web65909.mail.ac4.yahoo.com>
Message-ID: <00cb01cbefd7$c057d5a0$410780e0$@washington.edu>

A VAR on panel data is probably one where you want to have a error
components representation for the error term. That is, the usual error e(it)
is broken into an unobserved individual fixed effect a(i) and an
idiosyncratic term n(i,t). My guess is that a VAR with panel data is
essentially a dynamic panel data model (see the plm package). The error
components structure means that you have to use some technique to deal with
the endogeneity created by having lagged dependent variables with an error
components structure. For example, you could use the Arellano-Bond type GMM
estimator.
Thoughts?
ez

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Paul Teetor
Sent: Thursday, March 31, 2011 11:39 AM
To: Herbert Julius Garonfolo; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Vector Autoregression on Panel Data

Herbert,

(1) Did you try searching at http://www.rseek.org? When I searched on
"vector 
autoregression", it returned hundreds of results.

(2) What is the difference between VAR on panel data versus VAR on
multivariate 
time series? I apologize if this is a stupid question, but I don't
understand 
the difference. The task view page for Time Series Analysis 
(http://cran.r-project.org/web/views/TimeSeries.html) lists several packages
for 
multivariate time series analysis.

HTH,
Paul


 
Paul Teetor, Elgin, IL  USA
http://quanttrader.info/public



----- Original Message ----
From: Herbert Julius Garonfolo <hgaronfolo at gmail.com>
To: r-sig-finance at r-project.org
Sent: Thu, March 31, 2011 9:52:18 AM
Subject: [R-SIG-Finance] Vector Autoregression on Panel Data

Hi

I would like to do a Vector Autoregression model on panel data. Is this
possible in R? and are there any built in functionality to perform this kind
of model?

Thank you very much for your time.

Herbert

    [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should 
go.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


