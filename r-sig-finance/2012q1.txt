From jbreit at nexgo.de  Mon Jan  2 09:08:20 2012
From: jbreit at nexgo.de (Joachim Breit)
Date: Mon, 02 Jan 2012 09:08:20 +0100
Subject: [R-SIG-Finance] Determine the number of trading days for XETRA
 or EUREX in a given period
In-Reply-To: <CAEaVHoKUrUrLbRnrrgbSD5WKu8K6oM7Ji4+r1t1TTvkZr5FUAw@mail.gmail.com>
References: <4EFDD0C2.6050104@nexgo.de>
	<CAEaVHoKUrUrLbRnrrgbSD5WKu8K6oM7Ji4+r1t1TTvkZr5FUAw@mail.gmail.com>
Message-ID: <4F0165F4.803@nexgo.de>

Mark, I was hoping that somebody else had done that job already... :-) 
After all, I should not be the only person interested in the problem.
Besides, function holidayNYSE looks intimidating for an R newbie.

Regards,
Joachim

Am 31.12.2011 10:37, schrieb Mark Breman:
> Hello Joachim,
>
> Why not create a holidayEUREX yourself? Look at holidayNYSE for an
> example and it should not be too difficult.
>
> Regards,
>
> -Mark-
>
>
> 2011/12/30 Joachim Breit <jbreit at nexgo.de <mailto:jbreit at nexgo.de>>
>
>     Hello,
>
>     say you want to determine the number of trading days for DAX options
>     on EUREX from now til day x.
>
>     I am looking for a function for this task.
>
>     Looked in package timeDate but found nothing for the german exchanges.
>
>     Can somebody help, please?
>
>     Joachim
>
>     _________________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>


From enricoschumann at yahoo.de  Mon Jan  2 17:55:27 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Mon, 02 Jan 2012 17:55:27 +0100
Subject: [R-SIG-Finance] Determine the number of trading days for XETRA
 or EUREX in a given period
In-Reply-To: <4F0165F4.803@nexgo.de>
References: <4EFDD0C2.6050104@nexgo.de>
	<CAEaVHoKUrUrLbRnrrgbSD5WKu8K6oM7Ji4+r1t1TTvkZr5FUAw@mail.gmail.com>
	<4F0165F4.803@nexgo.de>
Message-ID: <4F01E17F.3020307@yahoo.de>


Hi Joachim,

I don't think you need much experience with R to count the days; but it 
may take some work to tabulate the holidays.

You could do something like this:

start <- as.Date("2012-01-01")
end <- as.Date("2012-12-31")

## define a list of holidays
holidays <- as.Date(c("2012-01-01","2012-12-25"))

## create date sequence
allDates <- seq(start, end, by = "day")

## remove weekends
dayofweek <- as.POSIXlt(allDates)$wday
isweekend <- dayofweek==0L | dayofweek==6L
allDates <- allDates[!isweekend]

## delete holidays
allDates <- allDates[-match(holidays, allDates, nomatch = 0L)]

## count (including 'start' and 'end')
length(allDates)


Quite a lot of this seems already implemented in package RQuantLib. I 
say 'seems' because I do not use these functions, so I cannot guarantee 
that the package gives you what you need. Try this:


require("RQuantLib")
allDates <- seq(start, end, by = "day")
istradingday <- !isHoliday("Germany/Eurex", allDates)
length(allDates[istradingday])

## or ...
businessDaysBetween(calendar = "Germany/Eurex",
                     from = start,
                     to = end,
                     includeFirst = 1, includeLast = 1)

Regards,
Enrico


-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/

Am 02.01.2012 09:08, schrieb Joachim Breit:
> Mark, I was hoping that somebody else had done that job already... :-)
> After all, I should not be the only person interested in the problem.
> Besides, function holidayNYSE looks intimidating for an R newbie.
>
> Regards,
> Joachim
>
> Am 31.12.2011 10:37, schrieb Mark Breman:
>> Hello Joachim,
>>
>> Why not create a holidayEUREX yourself? Look at holidayNYSE for an
>> example and it should not be too difficult.
>>
>> Regards,
>>
>> -Mark-
>>
>>
>> 2011/12/30 Joachim Breit <jbreit at nexgo.de <mailto:jbreit at nexgo.de>>
>>
>> Hello,
>>
>> say you want to determine the number of trading days for DAX options
>> on EUREX from now til day x.
>>
>> I am looking for a function for this task.
>>
>> Looked in package timeDate but found nothing for the german exchanges.
>>
>> Can somebody help, please?
>>
>> Joachim
>>
>> _________________________________________________
>> R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>> mailing list
>> https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>> <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
>> questions should go.
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


From nerotulip at gmail.com  Mon Jan  2 22:48:34 2012
From: nerotulip at gmail.com (Nero Tulip)
Date: Mon, 2 Jan 2012 21:48:34 +0000
Subject: [R-SIG-Finance] RBloomberg on R 2.14.0
Message-ID: <CAD8CxKBQyZFs+bu_y0hiXvhXYsyjtVqNH2SWbogmmgw=xQMamw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120102/98b33317/attachment.pl>

From john.laing at gmail.com  Tue Jan  3 02:50:48 2012
From: john.laing at gmail.com (John Laing)
Date: Mon, 2 Jan 2012 20:50:48 -0500
Subject: [R-SIG-Finance] RBloomberg on R 2.14.0
In-Reply-To: <CAD8CxKBQyZFs+bu_y0hiXvhXYsyjtVqNH2SWbogmmgw=xQMamw@mail.gmail.com>
References: <CAD8CxKBQyZFs+bu_y0hiXvhXYsyjtVqNH2SWbogmmgw=xQMamw@mail.gmail.com>
Message-ID: <CAA3Wa=v=2z5GyZWW33XpCHtYBgwCXCQFk2tTbxEft5n_S9M_1g@mail.gmail.com>

It appears you are using a Mac. RBloomberg is only available for
Windows, since it connects through the Bloomberg software which is
also Windows-only.

On Mon, Jan 2, 2012 at 4:48 PM, Nero Tulip <nerotulip at gmail.com> wrote:
> When trying to install RBloomberg on R 2.14.0, I get this:
>
>> install.packages("RBloomberg", repos = "http://r.findata.org")
> Warning: unable to access index for repository
> http://r.findata.org/bin/macosx/leopard/contrib/2.14
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
> ?package ?RBloomberg? is not available (for R version 2.14.0)
>
> What am I doing wrong?
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From fin_engr at hotmail.com  Tue Jan  3 04:16:43 2012
From: fin_engr at hotmail.com (financial engineer)
Date: Mon, 2 Jan 2012 22:16:43 -0500
Subject: [R-SIG-Finance] fitdist in R
Message-ID: <COL118-W25109C3055344A8BAFD3AFEF960@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120102/4f318a8a/attachment.pl>

From josh.m.ulrich at gmail.com  Tue Jan  3 04:39:47 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 2 Jan 2012 21:39:47 -0600
Subject: [R-SIG-Finance] fitdist in R
In-Reply-To: <COL118-W25109C3055344A8BAFD3AFEF960@phx.gbl>
References: <COL118-W25109C3055344A8BAFD3AFEF960@phx.gbl>
Message-ID: <CAPPM_gQRAVoz2T1=fOzmHGe5NkArJqwVW1c7mcvPnYN+c9+AAA@mail.gmail.com>

If you're going to cross-post
(http://stackoverflow.com/q/8707562/271616), please have the courtesy
to explicitly say so.  Otherwise, answers to your question may be
scattered across multiple sites.

On Mon, Jan 2, 2012 at 9:16 PM, financial engineer <fin_engr at hotmail.com> wrote:
>
> apologies if this should be a general R question, but if someone has any suggestions to fix the problem, I'd certainly appreciate it.
>
If you feel the need to start your email with an apology, you are
probably doing something wrong.  You're correct, this isn't a finance
question and is therefore off-topic.

> I am using the fitdist function in the package fitdistrplus in R.
>
> I have the following data that I read using
> A<-read.table("test.dat")`
> this is the entire dataset
>> A
> ? ? ? ? ? ? V1
> 1 ?-0.007077170
> 2 ?-0.000947418
> 3 ?-0.001897530
> 4 ?-0.000474947
> 5 ?-0.001902050
> 6 ?-0.000476077
> 7 ? 0.002378120
> 8 ? 0.000949668
> 9 ? 0.000474496
> 10 ?0.002842260
> 11 -0.000473149
> 12 -0.000473373
> 13 ?0.000000000
> 14 ?0.000000000
> 15 ?0.002836880
> 16 -0.003784300
> 17 -0.004750600
> 18 -0.002383790
> 19 -0.002868070
> 20 ?0.000478583
> 21 ?0.000478354
> 22 -0.001435750
> 23 ?0.001435750
> 24 ?0.002388350
> 25 ?0.004284700
> 26 ?0.002372480
> 27 -0.001422810
> 28 -0.001424840
> 29 ?0.000000000
> 30 ?0.001424840
> 31 ?0.000948767
> 32 ?0.003786090
> 33 -0.000472478
> 34 ?0.000472478
> 35 -0.001418100
> 36 ?0.000000000
> 37 -0.000946522
> 38 -0.002844950
> 39 ?0.000000000
> 40 ?0.003318320
> 41 ?0.002835540
> 42 ?0.001414760
> 43 -0.001414760
> 44 -0.001889470
> 45 ?0.001417430
> 46 -0.002363510
> 47 ?0.002363510
> 48 ?0.002357940
> 49 ?0.002352390
> 50 -0.000940292
> 51 -0.001412100
> 52 -0.002830190
> 53 ?0.000472255
> 54 ?0.000472032
> 55 ?0.000471809
> 56 -0.001416100
> 57 ?0.001416100
> 58 -0.000943842
> 59 ?0.000472032
> 60 -0.000944287
> 61 -0.000945180
> 62 -0.001893040
> 63 -0.000473821
> 64 -0.000474046
> 65 ?0.003313610
> 66 -0.000472701
> 67 -0.000946074
> 68 ?0.001418780
> 69 -0.000945627
> 70 -0.001893940
> 71 -0.001897530
> 72 -0.005714300
> 73 -0.001433690
> 74 -0.003833260
> 75 ?0.001439190
> 76 ?0.000479272
> 77 -0.001918470
> 78 -0.000480192
> 79 ?0.000960154
> 80 ?0.000479731
> 81 ?0.000000000
> 82 ?0.000479501
> 83 ?0.000958313
> 84 -0.003838780
> 85 -0.002406740
> 86 ?0.000963391
> 87 ?0.000962464
> 88 -0.001925860
> 89 ?0.000481812
> 90 -0.002411380
> 91 -0.001449630
> `
> I ran the following command:
>
>>fitdist(A$V1,"norm",method="mge",gof="CvM")`
>
> and it generates the following:
> Fitting of the distribution ' norm ' by maximum goodness-of-fit
> Parameters:
> ?estimate
> 1 ? ? ? NA
> 2 ? ? ? NA
> Warning message:
> In pnorm(q, mean, sd, lower.tail, log.p) : NaNs produced
>
> given the above error message, I ran the below:
>> mu=mean(A$V1)
>> sigma=sd(A$V1)
>> mu
> [1] -0.0003091273
>> sigma
> [1] 0.002051825
>> pnorm(A$V1,mu,sigma)
> ?[1] 0.0004859313 0.3778682282 0.2194235651 0.4677942525 0.2187728328
> ?[6] 0.4675752645 0.9048490462 0.7302272325 0.6487379052 0.9377179215
> [11] 0.4681427154 0.4680993016 0.5598779146 0.5598779146 0.9373956798
> [16] 0.0451612910 0.0152074342 0.1559769817 0.1061704134 0.6494763806
> [21] 0.6494350178 0.2914741494 0.8024493726 0.9056899734 0.9874187360
> [26] 0.9043830715 0.2936417791 0.2933012328 0.5598779146 0.8009684336
> [31] 0.7300820807 0.9770270687 0.4682727654 0.6483730677 0.2944326177
> [36] 0.5598779146 0.3780342225 0.1082503682 0.5598779146 0.9614622560
> [41] 0.9373152170 0.7995942319 0.2949940199 0.2205866970 0.7999587855
> [46] 0.1583537921 0.9036385181 0.9031740418 0.9027096003 0.3791890228
> [51] 0.2954414771 0.1095934742 0.6483327428 0.6482924162 0.6482520879
> [56] 0.2947687275 0.7997772412 0.3785308577 0.6482924162 0.3784483801
> [61] 0.3782828856 0.2200710780 0.4680124750 0.4679688685 0.9612699580
> [66] 0.4682295443 0.3781172281 0.8001429585 0.3782000541 0.2199411992
> [71] 0.2194235651 0.0042152418 0.2918187280 0.0429384302 0.8029149383
> [76] 0.6496008197 0.2164182554 0.4667778828 0.7319136560 0.6496837100
> [81] 0.5598779146 0.6496421754 0.7316179594 0.0426934572 0.1533157552
> [86] 0.7324331764 0.7322844499 0.2153633562 0.6500594259 0.1527813896
> [91] 0.2891573876
>
> now I am confused why I am getting an error message about NaN's.......anyone have any suggestions what might be the reason....thanks, Bobby
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jbreit at nexgo.de  Tue Jan  3 15:13:16 2012
From: jbreit at nexgo.de (Joachim Breit)
Date: Tue, 03 Jan 2012 15:13:16 +0100
Subject: [R-SIG-Finance] Determine the number of trading days for XETRA
 or EUREX in a given period
In-Reply-To: <4F01E17F.3020307@yahoo.de>
References: <4EFDD0C2.6050104@nexgo.de>
	<CAEaVHoKUrUrLbRnrrgbSD5WKu8K6oM7Ji4+r1t1TTvkZr5FUAw@mail.gmail.com>
	<4F0165F4.803@nexgo.de> <4F01E17F.3020307@yahoo.de>
Message-ID: <4F030CFC.9010002@nexgo.de>

Thank you, Enrico. I wasn't aware of the RQuantLib functions. Looks good...

Regards,
Joachim

Am 02.01.2012 17:55, schrieb Enrico Schumann:
>
> Hi Joachim,
>
> I don't think you need much experience with R to count the days; but it
> may take some work to tabulate the holidays.
>
> You could do something like this:
>
> start <- as.Date("2012-01-01")
> end <- as.Date("2012-12-31")
>
> ## define a list of holidays
> holidays <- as.Date(c("2012-01-01","2012-12-25"))
>
> ## create date sequence
> allDates <- seq(start, end, by = "day")
>
> ## remove weekends
> dayofweek <- as.POSIXlt(allDates)$wday
> isweekend <- dayofweek==0L | dayofweek==6L
> allDates <- allDates[!isweekend]
>
> ## delete holidays
> allDates <- allDates[-match(holidays, allDates, nomatch = 0L)]
>
> ## count (including 'start' and 'end')
> length(allDates)
>
>
> Quite a lot of this seems already implemented in package RQuantLib. I
> say 'seems' because I do not use these functions, so I cannot guarantee
> that the package gives you what you need. Try this:
>
>
> require("RQuantLib")
> allDates <- seq(start, end, by = "day")
> istradingday <- !isHoliday("Germany/Eurex", allDates)
> length(allDates[istradingday])
>
> ## or ...
> businessDaysBetween(calendar = "Germany/Eurex",
> from = start,
> to = end,
> includeFirst = 1, includeLast = 1)
>
> Regards,
> Enrico
>
>


From julien.hebng at gmail.com  Tue Jan  3 19:06:04 2012
From: julien.hebng at gmail.com (=?ISO-8859-1?Q?Julien_H=E9bert_Nguyen?=)
Date: Tue, 3 Jan 2012 13:06:04 -0500
Subject: [R-SIG-Finance] Blotter Package Installation
Message-ID: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120103/e290c5e6/attachment.pl>

From jeffrey.ryan at lemnica.com  Tue Jan  3 19:10:50 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 3 Jan 2012 12:10:50 -0600
Subject: [R-SIG-Finance] Blotter Package Installation
In-Reply-To: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
References: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
Message-ID: <CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>

The exact commands you run are required for us to help.

That said, the package is on R-forge, not CRAN so adjust accordingly.
Additionally, binaries may or may not be available - so having
developer tools is recommended (always) to build from sources.

HTH
Jeff

On Tue, Jan 3, 2012 at 12:06 PM, Julien H?bert Nguyen
<julien.hebng at gmail.com> wrote:
> Hi,
>
> I'm sorry if I should direct my post to a more appropriate forum, but I'm
> at loss.
> I've recently reinstalled R on my computer(s) and can't seem to install the
> blotter package on any of them.
>
> My Windows computers are running R 2.14.1
> My Mac computer is running R 2.14.0
> All are using Rstudio.
>
> I've tried installing the package, but I get the following error message:
>
> Installing package(s) into
> ?/Library/Frameworks/R.framework/Versions/2.14/Resources/library?
> (as ?lib? is unspecified)
> Warning in install.packages :
> package ?blotter? is not available (for R version 2.14.0)
>
> Could someone guide me on how to resolve this issue. I've searched past
> blotter discussions but can't seem to find what to do to address this
> particular issue.
>
> Thanks!
>
> J.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com


From daniel.cegielka at gmail.com  Tue Jan  3 19:14:37 2012
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Tue, 3 Jan 2012 19:14:37 +0100
Subject: [R-SIG-Finance] Blotter Package Installation
In-Reply-To: <CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>
References: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
	<CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>
Message-ID: <CAPLrYEQnS7zVaTHFH+BUnMKxJHFTppJObhGD4h7AJQo8BFZ1dA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120103/532848c0/attachment.pl>

From Alain.Ledon at ally.com  Tue Jan  3 19:22:07 2012
From: Alain.Ledon at ally.com (Ledon, Alain)
Date: Tue, 3 Jan 2012 13:22:07 -0500
Subject: [R-SIG-Finance] Blotter Package Installation
In-Reply-To: <CAPLrYEQnS7zVaTHFH+BUnMKxJHFTppJObhGD4h7AJQo8BFZ1dA@mail.gmail.com>
References: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
	<CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>
	<CAPLrYEQnS7zVaTHFH+BUnMKxJHFTppJObhGD4h7AJQo8BFZ1dA@mail.gmail.com>
Message-ID: <AC7014A33F40A747946F6CA7BB5DF0A8015BF922C4@USABHEM0GNAO03.NAO.global.gmacfs.com>

You will need Mac toolset if you want to build the all the packages in OSX. The easiest way achieve this is to install XCode.

For Windows, you will need Rtools. You can get it here:

http://www.murdoch-sutherland.com/Rtools/

FWIW, I have done this multiple times and it works like a charm. Thanks to all involved.

Take care,

Alain

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Daniel Cegielka
Sent: Tuesday, January 03, 2012 1:15 PM
To: Jeffrey Ryan
Cc: r-sig-finance at r-project.org; Julien H?bert Nguyen
Subject: Re: [R-SIG-Finance] Blotter Package Installation

similar problem:

http://r.789695.n4.nabble.com/Package-quot-quantstrat-quot-td3599657.html

regards,
daniel



2012/1/3 Jeffrey Ryan <jeffrey.ryan at lemnica.com>

> The exact commands you run are required for us to help.
>
> That said, the package is on R-forge, not CRAN so adjust accordingly.
> Additionally, binaries may or may not be available - so having
> developer tools is recommended (always) to build from sources.
>
> HTH
> Jeff
>
> On Tue, Jan 3, 2012 at 12:06 PM, Julien H?bert Nguyen
> <julien.hebng at gmail.com> wrote:
> > Hi,
> >
> > I'm sorry if I should direct my post to a more appropriate forum, but I'm
> > at loss.
> > I've recently reinstalled R on my computer(s) and can't seem to install
> the
> > blotter package on any of them.
> >
> > My Windows computers are running R 2.14.1
> > My Mac computer is running R 2.14.0
> > All are using Rstudio.
> >
> > I've tried installing the package, but I get the following error message:
> >
> > Installing package(s) into
> > '/Library/Frameworks/R.framework/Versions/2.14/Resources/library'
> > (as 'lib' is unspecified)
> > Warning in install.packages :
> > package 'blotter' is not available (for R version 2.14.0)
> >
> > Could someone guide me on how to resolve this issue. I've searched past
> > blotter discussions but can't seem to find what to do to address this
> > particular issue.
> >
> > Thanks!
> >
> > J.
> >
> >        [[alternative HTML version deleted]]
> >
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
> www.esotericR.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From julien.hebng at gmail.com  Tue Jan  3 21:51:02 2012
From: julien.hebng at gmail.com (=?ISO-8859-1?Q?Julien_H=E9bert_Nguyen?=)
Date: Tue, 3 Jan 2012 15:51:02 -0500
Subject: [R-SIG-Finance] Blotter Package Installation
In-Reply-To: <AC7014A33F40A747946F6CA7BB5DF0A8015BF922C4@USABHEM0GNAO03.NAO.global.gmacfs.com>
References: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
	<CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>
	<CAPLrYEQnS7zVaTHFH+BUnMKxJHFTppJObhGD4h7AJQo8BFZ1dA@mail.gmail.com>
	<AC7014A33F40A747946F6CA7BB5DF0A8015BF922C4@USABHEM0GNAO03.NAO.global.gmacfs.com>
Message-ID: <CAKrheHyBqRMs+n6RJwo7+WgmPEdWADCMeGC+a_NBEQ_xLjyJ_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120103/6d1bf58c/attachment.pl>

From julien.hebng at gmail.com  Tue Jan  3 23:16:31 2012
From: julien.hebng at gmail.com (=?ISO-8859-1?Q?Julien_H=E9bert_Nguyen?=)
Date: Tue, 3 Jan 2012 17:16:31 -0500
Subject: [R-SIG-Finance] Blotter Package Installation
In-Reply-To: <CAKrheHyBqRMs+n6RJwo7+WgmPEdWADCMeGC+a_NBEQ_xLjyJ_g@mail.gmail.com>
References: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
	<CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>
	<CAPLrYEQnS7zVaTHFH+BUnMKxJHFTppJObhGD4h7AJQo8BFZ1dA@mail.gmail.com>
	<AC7014A33F40A747946F6CA7BB5DF0A8015BF922C4@USABHEM0GNAO03.NAO.global.gmacfs.com>
	<CAKrheHyBqRMs+n6RJwo7+WgmPEdWADCMeGC+a_NBEQ_xLjyJ_g@mail.gmail.com>
Message-ID: <CAKrheHz3NODz-pS46Dorc36q5Mr-z178Wg87hxqG7hdmQRusnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120103/b0ac875d/attachment.pl>

From daniel.cegielka at gmail.com  Tue Jan  3 23:44:58 2012
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Tue, 3 Jan 2012 23:44:58 +0100
Subject: [R-SIG-Finance] Blotter Package Installation
In-Reply-To: <CAKrheHz3NODz-pS46Dorc36q5Mr-z178Wg87hxqG7hdmQRusnw@mail.gmail.com>
References: <CAKrheHzt0ZgwhVk9wZ=YuOVG9rh8DJS8N5fD9QTMLWWBSFziDA@mail.gmail.com>
	<CABDUZc_JGUqAmTESeDxxX7-ipYgg3ySdrH4Cmw=qZ-=9XrN6=g@mail.gmail.com>
	<CAPLrYEQnS7zVaTHFH+BUnMKxJHFTppJObhGD4h7AJQo8BFZ1dA@mail.gmail.com>
	<AC7014A33F40A747946F6CA7BB5DF0A8015BF922C4@USABHEM0GNAO03.NAO.global.gmacfs.com>
	<CAKrheHyBqRMs+n6RJwo7+WgmPEdWADCMeGC+a_NBEQ_xLjyJ_g@mail.gmail.com>
	<CAKrheHz3NODz-pS46Dorc36q5Mr-z178Wg87hxqG7hdmQRusnw@mail.gmail.com>
Message-ID: <CAPLrYESmJsBC3yYLaR-nZNANObwH218i+ofj3a2U1F7eX1_0QA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120103/00cd2edc/attachment.pl>

From j_cuisinier at hotmail.com  Wed Jan  4 13:24:52 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Wed, 4 Jan 2012 13:24:52 +0100
Subject: [R-SIG-Finance] List index constituents of an index in R? quantmod?
Message-ID: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/39ae8090/attachment.pl>

From zoonek at gmail.com  Wed Jan  4 13:47:31 2012
From: zoonek at gmail.com (Vincent Zoonekynd)
Date: Wed, 4 Jan 2012 21:47:31 +0900
Subject: [R-SIG-Finance] List index constituents of an index in R?
	quantmod?
In-Reply-To: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>
References: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>
Message-ID: <CAMS6tpfn721AC10w1DQbYYSXbjaDByUqtkaxt21XH3m1RoD8TA@mail.gmail.com>

You can use the XML package to parse the page and extract the contents
of the table:
  library(XML)
  index <- "^DJI"
  url <- paste("http://uk.finance.yahoo.com/q/cp?s=", index, sep="")
  symbols <- readHTMLTable(url, as.data.frame=FALSE)[[10]]$Symbol

You should check the size of the result: large indices may be split
across several pages, and the layout of the page may change.

-- Vincent

On 4 January 2012 21:24, julien cuisinier <j_cuisinier at hotmail.com> wrote:
> Is anyone aware of an existing function to download from yahoo finance
> the list of an index constituents?


From j_cuisinier at hotmail.com  Wed Jan  4 14:50:46 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Wed, 4 Jan 2012 14:50:46 +0100
Subject: [R-SIG-Finance] List index constituents of an index in R?
 quantmod?
In-Reply-To: <CAMS6tpfn721AC10w1DQbYYSXbjaDByUqtkaxt21XH3m1RoD8TA@mail.gmail.com>
References: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>,
	<CAMS6tpfn721AC10w1DQbYYSXbjaDByUqtkaxt21XH3m1RoD8TA@mail.gmail.com>
Message-ID: <COL102-W4876C99A9D01E5C24E8FDA8F970@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/841b7090/attachment.pl>

From gsee000 at gmail.com  Wed Jan  4 15:24:40 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 4 Jan 2012 08:24:40 -0600
Subject: [R-SIG-Finance] List index constituents of an index in R?
	quantmod?
In-Reply-To: <COL102-W4876C99A9D01E5C24E8FDA8F970@phx.gbl>
References: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>
	<CAMS6tpfn721AC10w1DQbYYSXbjaDByUqtkaxt21XH3m1RoD8TA@mail.gmail.com>
	<COL102-W4876C99A9D01E5C24E8FDA8F970@phx.gbl>
Message-ID: <CA+xi=qYSTx8XaSRoM6x7QacF50e7jM+Lr2so6o2hbpKrB+8f_A@mail.gmail.com>

Julien,

I did this for an example with the Dow Jones Industrial average.
It should be in this directory on your computer:
blotter/pkg/FinancialInstrument/inst/parser/DJIA.index.R

It's also available here:
http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/FinancialInstrument/inst/parser/DJIA.index.R?revision=834&root=blotter

If you're interested in getting the holdings of an iShare ETR or a
Sector SPDR ETF, you can use a function called "getHoldings" from the
package "qmao"

Regards,
Garrett

On Wed, Jan 4, 2012 at 7:50 AM, julien cuisinier
<j_cuisinier at hotmail.com> wrote:
>
> Many thanks Vincent. It does run on several pages and layout seems to be constant so your route might be very useful..
>
> I was hoping it should be possible to request that data using http get method as for historical prices, I will also try to look down that route
>
> If / when I get around this I will keep the list posted
>
>
> Rgds,
> Julien
>
>
>
>> Date: Wed, 4 Jan 2012 21:47:31 +0900
>> Subject: Re: [R-SIG-Finance] List index constituents of an index in R? quantmod?
>> From: zoonek at gmail.com
>> To: r-sig-finance at r-project.org
>> CC: j_cuisinier at hotmail.com
>>
>> You can use the XML package to parse the page and extract the contents
>> of the table:
>> ? library(XML)
>> ? index <- "^DJI"
>> ? url <- paste("http://uk.finance.yahoo.com/q/cp?s=", index, sep="")
>> ? symbols <- readHTMLTable(url, as.data.frame=FALSE)[[10]]$Symbol
>>
>> You should check the size of the result: large indices may be split
>> across several pages, and the layout of the page may change.
>>
>> -- Vincent
>>
>> On 4 January 2012 21:24, julien cuisinier <j_cuisinier at hotmail.com> wrote:
>> > Is anyone aware of an existing function to download from yahoo finance
>> > the list of an index constituents?
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From Alain.Ledon at ally.com  Wed Jan  4 15:24:46 2012
From: Alain.Ledon at ally.com (Ledon, Alain)
Date: Wed, 4 Jan 2012 09:24:46 -0500
Subject: [R-SIG-Finance] List index constituents of an index in R?
 quantmod?
In-Reply-To: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>
References: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>
Message-ID: <AC7014A33F40A747946F6CA7BB5DF0A8015BF92ED9@USABHEM0GNAO03.NAO.global.gmacfs.com>

Hi

The package tawny includes a function to get the index composition using yahoo. It is not perfect but it could be a start:

> library(tawny)
> getIndexComposition('^DJI')
 [1] "AA"   "AXP"  "BA"   "BAC"  "CAT"  "CSCO" "CVX"  "DD"   "DIS"  "GE"   "HD"   "HPQ"  "IBM"  "INTC" "JNJ"  "JPM"  "KFT"  "KO"   "MCD"  "MMM"  "MRK"  "MSFT" "PFE"  "PG"   "T"    "TRV"  "UTX"  "VZ"   "WMT"  "XOM"
> getIndexComposition('^FTSE')
  [1] "AAL.L"  "ABF.L"  "ADM.L"  "AGK.L"  "AMEC.L" "ANTO.L" "ARM.L"  "ASHM.L" "AV.L"   "AZN.L"  "BA.L"   "BARC.L" "BATS.L" "BG.L"   "BLND.L" "BLT.L"  "BNZL.L" "BP.L"   "BRBY.L" "BSY.L"  "BT-A.L" "CCL.L"  "CNA.L"  "CNE.L"  "CPG.L" 
 [26] "CPI.L"  "CRH.L"  "CSCG.L" "DGE.L"  "EMG.L"  "ENRC.L" "ESSR.L" "EXPN.L" "FRES.L" "GFS.L"  "GKN.L"  "GLEN.L" "GSK.L"  "HL.L"   "HMSO.L" "HSBA.L" "IAG.L"  "IAP.L"  "IHG.L"  "IMI.L"  "IMT.L"  "IPR.L"  "ITRK.L" "ITV.L"  "JMAT.L"
 [51] "KAZ.L"  "KAZ.L"  "KGF.L"  "LAND.L" "LGEN.L" "LLOY.L" "MGGT.L" "MKS.L"  "MRW.L"  "NG.L"   "NXT.L"  "OML.L"  "PFC.L"  "POLY.L" "PRU.L"  "PSON.L" "RB.L"   "RBS.L"  "RDSA.L" "RDSB.L" "REL.L"  "REX.L"  "RIO.L"  "RR.L"   "RRS.L" 
 [76] "RSA.L"  "RSL.L"  "SAB.L"  "SBRY.L" "SDR.L"  "SDRC.L" "SGE.L"  "SHP.L"  "SL.L"   "SMIN.L" "SN.L"   "SRP.L"  "SSE.L"  "STAN.L" "SVT.L"  "TATE.L" "TLW.L"  "TSCO.L" "ULVR.L" "UU.L"   "VED.L"  "VOD.L"  "WEIR.L" "WOS.L"  "WPP.L" 
[101] "WTB.L"

Regards

Alain

(646)781-2698

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of julien cuisinier
Sent: Wednesday, January 04, 2012 7:25 AM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] List index constituents of an index in R? quantmod?


Hi List,


I know, I know not really following the posting guidelines...Is anyone aware of an existing function to download from yahoo finance the list of an index constituents? 

Could not find anything googling, hope I haven't missed an obvious thread...

I am still on R 2.13 but I guess that would not really matter here, Windows 7

I am learning quantstrat package like many of us & hoping to use that list of constituents to calculate cross sectional volatility & use it as a signal as exercise (some way between the list of constituent & this but I hope you get the point)

Any hint / redirection appreciated - if my take is that it should not be too hard & it could be a great addition to quantmod


Rgds,
Julien




Many thanks




 		 	   		  
	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From j_cuisinier at hotmail.com  Wed Jan  4 15:54:40 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Wed, 4 Jan 2012 15:54:40 +0100
Subject: [R-SIG-Finance] List index constituents of an index in R?
 quantmod?
In-Reply-To: <CA+xi=qYSTx8XaSRoM6x7QacF50e7jM+Lr2so6o2hbpKrB+8f_A@mail.gmail.com>
References: <COL102-W14C1CC4D7A6EAC49DA9288F970@phx.gbl>,
	<CAMS6tpfn721AC10w1DQbYYSXbjaDByUqtkaxt21XH3m1RoD8TA@mail.gmail.com>,
	<COL102-W4876C99A9D01E5C24E8FDA8F970@phx.gbl>,
	<CA+xi=qYSTx8XaSRoM6x7QacF50e7jM+Lr2so6o2hbpKrB+8f_A@mail.gmail.com>
Message-ID: <COL102-W31B4D0F1D2301ED36ECDE08F970@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/063920ab/attachment.pl>

From Jsacks at russell.com  Wed Jan  4 16:38:48 2012
From: Jsacks at russell.com (Sacks, John)
Date: Wed, 4 Jan 2012 07:38:48 -0800
Subject: [R-SIG-Finance] R Bloomberg for intraday prices
Message-ID: <DF1623355387884DB119F5C8AF0CA922114B3B17@TAC-CMS001.prod.ds.russell.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/a3762655/attachment.pl>

From brian at braverock.com  Wed Jan  4 16:47:57 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 04 Jan 2012 09:47:57 -0600
Subject: [R-SIG-Finance] R Bloomberg for intraday prices
In-Reply-To: <DF1623355387884DB119F5C8AF0CA922114B3B17@TAC-CMS001.prod.ds.russell.com>
References: <DF1623355387884DB119F5C8AF0CA922114B3B17@TAC-CMS001.prod.ds.russell.com>
Message-ID: <1325692077.16398.13.camel@brian-rcg>

You can subset by time from the xts object you get out of RBloomberg.

On Wed, 2012-01-04 at 07:38 -0800, Sacks, John wrote:
> I was wondering if anyone has any luck additional information on the bar function in  RBloomberg.  My main issue is that it accepts/returns the data with GMT time stamp and has no feature to only show data during the trading hours for multiple days.
> 
> The Excel API allows you to use bdh function setting BarTp and BarSz but could not find this exposed in  RBloomberg. Anyone have a work around?
> 
> # Does not work
> bdh(conn, "SPY US Equity", "PX_LAST", "2011-12-29 6:30:00.000" , "2011-12-29 11:30:00.000", override_fields =
>         c("BarType", "BarSize") , override_values = c("B","60"))
> 
> I included the R ouput below.
> 
> > Sys.timezone()
> [1] "PST"
> >
> > bar(conn, c("CSCO US Equity"), "BID", "2011-12-29 06:00:00.000" , "2011-12-30 13:00:00.000", "60")
>                                            time  open  high   low close
> 2011-12-29T09:00:00.000 2011-12-29T09:00:00.000 18.03 18.04 18.03 18.03
> 2011-12-29T10:00:00.000 2011-12-29T10:00:00.000 18.04 18.04 18.03 18.04
> 2011-12-29T11:00:00.000 2011-12-29T11:00:00.000 18.04 18.05 18.04 18.05
> 2011-12-29T12:00:00.000 2011-12-29T12:00:00.000 18.05 18.15 18.05 18.15
> 2011-12-29T13:00:00.000 2011-12-29T13:00:00.000 18.18 18.19 18.15 18.18
> 2011-12-29T14:00:00.000 2011-12-29T14:00:00.000 18.17 18.23 18.10 18.16
> 2011-12-29T15:00:00.000 2011-12-29T15:00:00.000 18.16 18.24 18.15 18.21
> 2011-12-29T16:00:00.000 2011-12-29T16:00:00.000 18.21 18.21 18.18 18.21
> 2011-12-29T17:00:00.000 2011-12-29T17:00:00.000 18.21 18.21 18.17 18.20
> 2011-12-29T18:00:00.000 2011-12-29T18:00:00.000 18.20 18.26 18.20 18.22
> 2011-12-29T19:00:00.000 2011-12-29T19:00:00.000 18.22 18.23 18.20 18.22
> 2011-12-29T20:00:00.000 2011-12-29T20:00:00.000 18.22 18.26 18.20 18.26
> 2011-12-29T21:00:00.000 2011-12-29T21:00:00.000 18.25 18.26 18.21 18.23
> 2011-12-29T22:00:00.000 2011-12-29T22:00:00.000 18.23 18.23 18.22 18.23
> 2011-12-29T23:00:00.000 2011-12-29T23:00:00.000 18.22 18.22 18.22 18.22
> 2011-12-30T00:00:00.000 2011-12-30T00:00:00.000 18.23 18.23 18.22 18.23
> 2011-12-30T08:30:00.000 2011-12-30T08:30:00.000 18.15 18.15 18.15 18.15
> 2011-12-30T09:30:00.000 2011-12-30T09:30:00.000 18.15 18.16 18.15 18.15
> 2011-12-30T10:30:00.000 2011-12-30T10:30:00.000 18.16 18.20 18.15 18.20
> 2011-12-30T11:30:00.000 2011-12-30T11:30:00.000 18.21 18.21 18.20 18.20
> 2011-12-30T12:30:00.000 2011-12-30T12:30:00.000 18.20 18.22 18.20 18.22
>                         numEvents  volume
> 2011-12-29T09:00:00.000         3      16
> 2011-12-29T10:00:00.000        10      57
> 2011-12-29T11:00:00.000         6      54
> 2011-12-29T12:00:00.000         8      97
> 2011-12-29T13:00:00.000        39     348
> 2011-12-29T14:00:00.000      7689  903201
> 2011-12-29T15:00:00.000     11117 2921269
> 2011-12-29T16:00:00.000      7043 2013271
> 2011-12-29T17:00:00.000      4849 1806055
> 2011-12-29T18:00:00.000      5662 2076844
> 2011-12-29T19:00:00.000      4092  991536
> 2011-12-29T20:00:00.000      9049 5146568
> 2011-12-29T21:00:00.000        47    2118
> 2011-12-29T22:00:00.000         8     132
> 2011-12-29T23:00:00.000         9     374
> 2011-12-30T00:00:00.000         7     117
> 2011-12-30T08:30:00.000         2      12
> 2011-12-30T09:30:00.000         5      18
> 2011-12-30T10:30:00.000         4      16
> 2011-12-30T11:30:00.000         2       8
> 2011-12-30T12:30:00.000         2      25
> > (start.data <- as.POSIXct("2011-12-29 10:30:00.000"))
> [1] "2011-12-29 10:30:00 PST"
> > (end.data <- as.POSIXct("2011-12-29 12:00:00.000"))
> [1] "2011-12-29 12:00:00 PST"
> > bar(conn, c("CSCO US Equity"), "BID", start.data , end.data, "60")
> Error in FUN(X[[3L]], ...) :
>   Sorry, parameter type `NA' is ambiguous or not supported.
> > # Does not work
> > bdh(conn, "SPY US Equity", "PX_LAST", "2011-12-29 6:30:00.000" , "2011-12-29 11:30:00.000", override_fields =
> +       c("BarType", "BarSize") , override_values = c("B","60"))
> Error in .jcall("RJavaTools", "Ljava/lang/Object;", "invokeMethod", cl,  :
>   org.findata.blpwrapper.WrapperException: response error: Invalid override field id specified [nid:809]
> 
> 
> 
> Regards,
> John
> ___________________________________________
> John J. Sacks, CFA
> Director, Quantitative Analysis
> Russell Implementation Services Inc.
> 1301 Second Ave., 18th Floor  I  Seattle, WA 98101
> Ph: 206-505-1545  I  Fx: 253-779-1074  I  Email:  jsacks at russell.com
> SEVENTY-FIVE YEARS of Russell Innovation
> Russell Implementation Services Inc. is a part of Russell Investments and is a member of FINRA and SIPC.
> The information contained in this message is intended on...{{dropped:17}}
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From john.kerpel at gmail.com  Wed Jan  4 17:15:14 2012
From: john.kerpel at gmail.com (John Kerpel)
Date: Wed, 4 Jan 2012 10:15:14 -0600
Subject: [R-SIG-Finance] can't load rJava via RBloomberg
Message-ID: <CAALU2ht-pip46W3QW_Dmj9XM9h3ce0+zqMdspJJYzG8gm=zTrg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/840867d2/attachment.pl>

From john.kerpel at gmail.com  Wed Jan  4 17:48:36 2012
From: john.kerpel at gmail.com (John Kerpel)
Date: Wed, 4 Jan 2012 10:48:36 -0600
Subject: [R-SIG-Finance] Fwd: can't load rJava via RBloomberg: FOLLOW UP
Message-ID: <CAALU2htx3g8VSWcbbzsNijj9UqHPzuOH9HDj=MXuN2M=JeFo+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/e067c468/attachment.pl>

From wotuzu17 at gmail.com  Wed Jan  4 18:07:08 2012
From: wotuzu17 at gmail.com (Andreas Voellenklee)
Date: Wed, 4 Jan 2012 18:07:08 +0100
Subject: [R-SIG-Finance] logical AND of all columns in a xts object
Message-ID: <CAKC0BhmhxZxG6xP4qfOM1jum=fOJbHs89SPGScHR8nrJ8mxMww@mail.gmail.com>

I am working on a function to filter a OHLC timeseries for n
consecutive long white/black candles in a row.

In the example below the xts- object "LAGLWCB" looks like this:
> tail(LAGLWCB,n=10)
           Lag.0 Lag.1 Lag.2
2011-12-19  TRUE FALSE FALSE
2011-12-20 FALSE  TRUE FALSE
2011-12-21 FALSE FALSE  TRUE
2011-12-22 FALSE FALSE FALSE
2011-12-23 FALSE FALSE FALSE
2011-12-27 FALSE FALSE FALSE
2011-12-28 FALSE FALSE FALSE
2011-12-29  TRUE FALSE FALSE
2011-12-30  TRUE  TRUE FALSE
2012-01-03  TRUE  TRUE  TRUE

The condition "Three consecutive long white candle bodies" is true
when the logical- AND of all columns equals true:

  eval(LAGLWCB[,1] & LAGLWCB[,2] & LAGLWCB[,3])

is there a way to perform logical operations on all columns of a xts
object, without having to explicitly code all columns like in the
command above?

Thanks,
Andreas



# ---example---

require("quantmod")
getSymbols("GLBS", adjust=TRUE)

CSPLongCandleBody <- function(TS, n=20, threshold=1.5) {
  CBL <- 2*(abs(Op(TS)-Cl(TS))) / (Op(TS)+Cl(TS))
  CBLMedian <- runMedian(CBL, n=n)
  LongWhiteCandleBody <- eval (CBL >= CBLMedian*threshold & Cl(TS) > Op(TS))
  LongBlackCandleBody <- eval (CBL >= CBLMedian*threshold & Op(TS) > Cl(TS))
  result <- cbind(LongWhiteCandleBody, LongBlackCandleBody)
  colnames(result) <- c("LongWhiteCandleBody", "LongBlackCandleBody")
  return(result)
}

# LongWhiteCandleBody
LWCB <- CSPLongCandleBody(GLBS)[,1]
tail(LWCB,n=10)

# Lag LongWhiteCandleBody 0 to 2 periods
LAGLWCB <- Lag(LWCB, k=0:2)
tail(LAGLWCB,n=10)

# Three consecutive Long White Candle Bodies
ThreeLWCB <- eval(LAGLWCB[,1] & LAGLWCB[,2] & LAGLWCB[,3])
tail(ThreeLWCB,n=10)

# ---end of example---


From josh.m.ulrich at gmail.com  Wed Jan  4 18:29:17 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 4 Jan 2012 11:29:17 -0600
Subject: [R-SIG-Finance] logical AND of all columns in a xts object
In-Reply-To: <CAKC0BhmhxZxG6xP4qfOM1jum=fOJbHs89SPGScHR8nrJ8mxMww@mail.gmail.com>
References: <CAKC0BhmhxZxG6xP4qfOM1jum=fOJbHs89SPGScHR8nrJ8mxMww@mail.gmail.com>
Message-ID: <CAPPM_gTn_CsU-o60TUEJ6kxC1PP_JtN-BJOaNn1XbeUQ7fibnw@mail.gmail.com>

Use apply() and convert the result to xts:

> as.xts(apply(tail(LAGLWCB,10),1,all))
            [,1]
2011-12-19 FALSE
2011-12-20 FALSE
2011-12-21 FALSE
2011-12-22 FALSE
2011-12-23 FALSE
2011-12-27 FALSE
2011-12-28 FALSE
2011-12-29 FALSE
2011-12-30 FALSE
2012-01-03  TRUE

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Wed, Jan 4, 2012 at 11:07 AM, Andreas Voellenklee <wotuzu17 at gmail.com> wrote:
> I am working on a function to filter a OHLC timeseries for n
> consecutive long white/black candles in a row.
>
> In the example below the xts- object "LAGLWCB" looks like this:
>> tail(LAGLWCB,n=10)
> ? ? ? ? ? Lag.0 Lag.1 Lag.2
> 2011-12-19 ?TRUE FALSE FALSE
> 2011-12-20 FALSE ?TRUE FALSE
> 2011-12-21 FALSE FALSE ?TRUE
> 2011-12-22 FALSE FALSE FALSE
> 2011-12-23 FALSE FALSE FALSE
> 2011-12-27 FALSE FALSE FALSE
> 2011-12-28 FALSE FALSE FALSE
> 2011-12-29 ?TRUE FALSE FALSE
> 2011-12-30 ?TRUE ?TRUE FALSE
> 2012-01-03 ?TRUE ?TRUE ?TRUE
>
> The condition "Three consecutive long white candle bodies" is true
> when the logical- AND of all columns equals true:
>
> ?eval(LAGLWCB[,1] & LAGLWCB[,2] & LAGLWCB[,3])
>
> is there a way to perform logical operations on all columns of a xts
> object, without having to explicitly code all columns like in the
> command above?
>
> Thanks,
> Andreas
>
>
>
> # ---example---
>
> require("quantmod")
> getSymbols("GLBS", adjust=TRUE)
>
> CSPLongCandleBody <- function(TS, n=20, threshold=1.5) {
> ?CBL <- 2*(abs(Op(TS)-Cl(TS))) / (Op(TS)+Cl(TS))
> ?CBLMedian <- runMedian(CBL, n=n)
> ?LongWhiteCandleBody <- eval (CBL >= CBLMedian*threshold & Cl(TS) > Op(TS))
> ?LongBlackCandleBody <- eval (CBL >= CBLMedian*threshold & Op(TS) > Cl(TS))
> ?result <- cbind(LongWhiteCandleBody, LongBlackCandleBody)
> ?colnames(result) <- c("LongWhiteCandleBody", "LongBlackCandleBody")
> ?return(result)
> }
>
> # LongWhiteCandleBody
> LWCB <- CSPLongCandleBody(GLBS)[,1]
> tail(LWCB,n=10)
>
> # Lag LongWhiteCandleBody 0 to 2 periods
> LAGLWCB <- Lag(LWCB, k=0:2)
> tail(LAGLWCB,n=10)
>
> # Three consecutive Long White Candle Bodies
> ThreeLWCB <- eval(LAGLWCB[,1] & LAGLWCB[,2] & LAGLWCB[,3])
> tail(ThreeLWCB,n=10)
>
> # ---end of example---
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From twmeggs at gmail.com  Wed Jan  4 21:49:49 2012
From: twmeggs at gmail.com (Tim Meggs)
Date: Wed, 4 Jan 2012 20:49:49 +0000
Subject: [R-SIG-Finance] Quantstrat using sigFormula
Message-ID: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/c46b2d17/attachment.pl>

From nerotulip at gmail.com  Wed Jan  4 22:15:11 2012
From: nerotulip at gmail.com (Nero Tulip)
Date: Wed, 4 Jan 2012 21:15:11 +0000
Subject: [R-SIG-Finance] RBloomberg on R 2.14.0
In-Reply-To: <CAA3Wa=v=2z5GyZWW33XpCHtYBgwCXCQFk2tTbxEft5n_S9M_1g@mail.gmail.com>
References: <CAD8CxKBQyZFs+bu_y0hiXvhXYsyjtVqNH2SWbogmmgw=xQMamw@mail.gmail.com>
	<CAA3Wa=v=2z5GyZWW33XpCHtYBgwCXCQFk2tTbxEft5n_S9M_1g@mail.gmail.com>
Message-ID: <CAD8CxKDAK9=QqxHmwzXCUhDF6+pEfXbr1Sgf_zkT9s=aW2vLXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/144f19da/attachment.pl>

From J_Cuisinier at hotmail.com  Wed Jan  4 22:49:41 2012
From: J_Cuisinier at hotmail.com (julien cuisinier)
Date: Wed, 4 Jan 2012 21:49:41 +0000
Subject: [R-SIG-Finance] Quantstrat using sigFormula
In-Reply-To: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
References: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
Message-ID: <BLU0-SMTP3587EEF3F0ACA64A732F4F38F970@phx.gbl>

Hi Tim,


Welcome to R!

Another good reading is the posting guide ;-)
http://www.r-project.org/posting-guide.html

I am learning quantstrat as well so could be interested to have a  
crack at it but to be helped the community needs more info such as  
what OS you are running on, what version of R, what version of the  
packages but more importantly a self-contained & reproducible example  
explaining what you trying to do & where the error shows up. That  
would allow people to test it easily & if they do not have the error  
you have it is where OS, version or R etc can come handy...

sorry hope i do not sound lecturing, just think you will have more  
feedback & interaction by making life easier for people trying to help


HTH,
Julien



On Jan 4, 2012, at 8:49 PM, Tim Meggs wrote:

> Hi - I'm fairly new to R.  Have been reading up a lot and am  
> impressed with
> the language's versatility and hope to spend much time getting to  
> grips
> with it.  (I'd like to thank those that have built out the really  
> useful
> Quantmod, Quantstrat, TTR, PerformanceAnalytics, Blotter packages  
> for all
> their hard work meaning I, and those with similar interests, dont  
> have to
> reinvent the wheel!)
>
> Having a problem with my understanding of how to use sigFornula, as  
> my code
> has started to throw an error after I'd tried to implement it - any  
> help or
> guidance would be greatly appreciated - thanks!:
>
> Getting the following error:
>
>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>
> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1),
> .indexFORMAT = indexFormat(e1),  :
>
>  index length must match number of observations
>
>> updatePortf("RSI4")
>
> [1] "RSI4"
>
>
> when running the following adaption of one of the Quantstrat demos:
>
> # This code is an attempt to backtest Connor's RSI(4) filter for  
> long trades
>
> #http://forums.stockfetcher.com/sfforums/?q=view&tid=93830&start=0
>
> #install.packages(c("quantstrat","blotter","FinancialInstrument"),  
> repos="
> http://r-forge.r-project.org")
>
> require(quantstrat)
>
> require(PerformanceAnalytics)
>
>
>
> # Set initial values
>
> initDate <- "2006-07-31"
>
> endDate <- "2011-10-31"
>
> initEq <- 100000
>
>
>
>
>
> # Pull Yahoo Finance data
>
> symbols <- c("SPY")
>
> getSymbols(symbols, from=initDate, to=endDate,
> index.class=c("POSIXt","POSIXct"))
>
>
>
> # Set up instruments with FinancialInstruments package
>
> currency("USD")
>
> for(symbol in symbols) {
>
>  stock(symbol, currency="USD", multiplier=1)
>
> }
>
>
>
> # Delete portfolio, account, and order book if they already exist
>
> suppressWarnings(rm("account.RSI4","portfolio.RSI4",pos=.blotter))
>
> suppressWarnings(rm("order_book.RSI4",pos=.strategy))
>
>
>
>
>
> # Initialize portfolio and account
>
> initPortf("RSI4", symbols=symbols, initDate=initDate)
>
> initAcct("RSI4", portfolios="RSI4", initDate=initDate, initEq=initEq)
>
> initOrders(portfolio="RSI4", initDate=initDate)
>
>
>
> # Initialize a strategy object
>
> stratRSI4 <- strategy("RSI4")
>
>
>
>
>
> ####INDICATORS####
>
> # Add the 200-day SMA indicator
>
> stratRSI4 <- add.indicator(strategy=stratRSI4, name="SMA", arguments =
> list(x=quote(Cl(mktdata)), n=200), label="SMA200")
>
> # Add the RSI4 indicator
>
> stratRSI4 <- add.indicator(strategy=stratRSI4, name="RSI", arguments =
> list(price = quote(getPrice(mktdata)), n=4), label="RSI")
>
>
>
>
>
> ####SIGNALS####
>
> # There are two signals:
>
> # The first is when close price is above the 200 day moving average  
> and
> RSI4 is below 25
>
> stratRSI4 <- add.signal(stratRSI4, name="sigFormula", arguments =  
> list(data
> = columns=c("Close","SMA200","RSI"), formula = "(Close > SMA200) &  
> (RSI <
> 25)", label="trigger"), cross=TRUE), label="Cl.gt.SMA")
>
> # The second is when the RSI4 closes above 55
>
> stratRSI4 <- add.signal(stratRSI4,
> name="sigThreshold",arguments=list(threshold=55, column="RSI",
> relationship="lt", cross=TRUE), label="Cl.lt.RSI")
>
>
>
>
>
> ####RULES####
>
> # There are two rules:
>
> # The first is to buy when the price is above the SMA and RSI4 below  
> 25
> (the first signal)
>
> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
> arguments=list(sigcol="Cl.gt.SMA", sigval=TRUE, orderqty=1000,
> ordertype="market", orderside="long", pricemethod="market",  
> TxnFees=-5,
> osFUN=osMaxPos), type="enter", path.dep=TRUE)
>
> # The second is to sell when the RSI climbs above 55
>
> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
> arguments=list(sigcol="Cl.lt.RSI", sigval=TRUE, orderqty="all",
> ordertype="market", orderside="long", pricemethod="market",  
> TxnFees=-5),
> type="exit", path.dep=TRUE)
>
>
>
>
>
> # Set position limits so we don't add to the position every month  
> Close >
> SMA10
>
> addPosLimit("RSI4", "SPY", timestamp=initDate, maxpos=1000, minpos=0)
>
>
>
> # Process the indicators and generate trades
>
> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>
> updatePortf("RSI4")
>
>
>
> # Evaluate results
>
> portRet <- PortfReturns("RSI4")
>
> portRet$Total <- rowSums(portRet, na.rm=TRUE)
>
> charts.PerformanceSummary(portRet$Total)
>
> tradeStats("RSI4")[,c("Symbol","Num.Trades","Net.Trading.PL<http://net.trading.pl/ 
> >
> ","maxDrawdown")]
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R  
> questions should go.
>


From junzhu98 at yahoo.com  Wed Jan  4 22:59:15 2012
From: junzhu98 at yahoo.com (Jun Zhu)
Date: Wed, 4 Jan 2012 13:59:15 -0800 (PST)
Subject: [R-SIG-Finance] List index constituents of an index in R?
	quantmod?
In-Reply-To: <AC7014A33F40A747946F6CA7BB5DF0A8015BF92ED9@USABHEM0GNAO03.NAO.global.gmacfs.com>
Message-ID: <1325714355.60249.YahooMailClassic@web30602.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120104/78351519/attachment.pl>

From gsee000 at gmail.com  Wed Jan  4 23:03:37 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 4 Jan 2012 16:03:37 -0600
Subject: [R-SIG-Finance] List index constituents of an index in R?
	quantmod?
In-Reply-To: <1325714355.60249.YahooMailClassic@web30602.mail.mud.yahoo.com>
References: <AC7014A33F40A747946F6CA7BB5DF0A8015BF92ED9@USABHEM0GNAO03.NAO.global.gmacfs.com>
	<1325714355.60249.YahooMailClassic@web30602.mail.mud.yahoo.com>
Message-ID: <CA+xi=qax9dqm73rEx8Ar-0sU2713gjtYWYBjVBibNaFoOeLw2Q@mail.gmail.com>

Yahoo doesn't provide that data as far as I'm aware.

Look at how there is a link for "Components" for DJI, but not for GSPC
http://finance.yahoo.com/q?s=^dji
http://finance.yahoo.com/q?s=^gspc

Garrett

On Wed, Jan 4, 2012 at 3:59 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
> Hi,
> I tried other indexes like S&P500 and it does not give the correct results:
>> getIndexComposition('^GSPC')?[1] "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ?[11] "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ? "@^GSPC" NA ? ? ? "@^GSPC">
> Anything wrong here ?
> Thanks,
> Jun
> --- On Wed, 1/4/12, Ledon, Alain <Alain.Ledon at ally.com> wrote:
>
> From: Ledon, Alain <Alain.Ledon at ally.com>
> Subject: Re: [R-SIG-Finance] List index constituents of an index in R? quantmod?
> To: "julien cuisinier" <j_cuisinier at hotmail.com>, "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> Date: Wednesday, January 4, 2012, 8:24 AM
>
> Hi
>
> The package tawny includes a function to get the index composition using yahoo. It is not perfect but it could be a start:
>
>> library(tawny)
>> getIndexComposition('^DJI')
> ?[1] "AA"???"AXP"? "BA"???"BAC"? "CAT"? "CSCO" "CVX"? "DD"???"DIS"? "GE"???"HD"???"HPQ"? "IBM"? "INTC" "JNJ"? "JPM"? "KFT"? "KO"???"MCD"? "MMM"? "MRK"? "MSFT" "PFE"? "PG"???"T"? ? "TRV"? "UTX"? "VZ"???"WMT"? "XOM"
>> getIndexComposition('^FTSE')
> ? [1] "AAL.L"? "ABF.L"? "ADM.L"? "AGK.L"? "AMEC.L" "ANTO.L" "ARM.L"? "ASHM.L" "AV.L"???"AZN.L"? "BA.L"???"BARC.L" "BATS.L" "BG.L"???"BLND.L" "BLT.L"? "BNZL.L" "BP.L"???"BRBY.L" "BSY.L"? "BT-A.L" "CCL.L"? "CNA.L"? "CNE.L"? "CPG.L"
> ?[26] "CPI.L"? "CRH.L"? "CSCG.L" "DGE.L"? "EMG.L"? "ENRC.L" "ESSR.L" "EXPN.L" "FRES.L" "GFS.L"? "GKN.L"? "GLEN.L" "GSK.L"? "HL.L"???"HMSO.L" "HSBA.L" "IAG.L"? "IAP.L"? "IHG.L"? "IMI.L"? "IMT.L"? "IPR.L"? "ITRK.L" "ITV.L"? "JMAT.L"
> ?[51] "KAZ.L"? "KAZ.L"? "KGF.L"? "LAND.L" "LGEN.L" "LLOY.L" "MGGT.L" "MKS.L"? "MRW.L"? "NG.L"???"NXT.L"? "OML.L"? "PFC.L"? "POLY.L" "PRU.L"? "PSON.L" "RB.L"???"RBS.L"? "RDSA.L" "RDSB.L" "REL.L"? "REX.L"? "RIO.L"? "RR.L"???"RRS.L"
> ?[76] "RSA.L"? "RSL.L"? "SAB.L"? "SBRY.L" "SDR.L"? "SDRC.L" "SGE.L"? "SHP.L"? "SL.L"???"SMIN.L" "SN.L"???"SRP.L"? "SSE.L"? "STAN.L" "SVT.L"? "TATE.L" "TLW.L"? "TSCO.L" "ULVR.L" "UU.L"???"VED.L"? "VOD.L"? "WEIR.L" "WOS.L"? "WPP.L"
> [101] "WTB.L"
>
> Regards
>
> Alain
>
> (646)781-2698
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of julien cuisinier
> Sent: Wednesday, January 04, 2012 7:25 AM
> To: r-sig-finance at r-project.org
> Subject: [R-SIG-Finance] List index constituents of an index in R? quantmod?
>
>
> Hi List,
>
>
> I know, I know not really following the posting guidelines...Is anyone aware of an existing function to download from yahoo finance the list of an index constituents?
>
> Could not find anything googling, hope I haven't missed an obvious thread...
>
> I am still on R 2.13 but I guess that would not really matter here, Windows 7
>
> I am learning quantstrat package like many of us & hoping to use that list of constituents to calculate cross sectional volatility & use it as a signal as exercise (some way between the list of constituent & this but I hope you get the point)
>
> Any hint / redirection appreciated - if my take is that it should not be too hard & it could be a great addition to quantmod
>
>
> Rgds,
> Julien
>
>
>
>
> Many thanks
>
>
>
>
>
> ??? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From gsee000 at gmail.com  Wed Jan  4 23:05:09 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 4 Jan 2012 16:05:09 -0600
Subject: [R-SIG-Finance] Quantstrat using sigFormula
In-Reply-To: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
References: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
Message-ID: <CA+xi=qaAzEYUq7T++=BNBUV7nLNSSGm4VyeCBNTDDXcNPapg-g@mail.gmail.com>

Do you still have a problem if you use Date as the index class?

i.e. instead of:
getSymbols(symbols, from=initDate, to=endDate,
index.class=c("POSIXt","POSIXct"))

simply do this:
getSymbols(symbols, from=initDate, to=endDate)

HTH,
Garrett

On Wed, Jan 4, 2012 at 2:49 PM, Tim Meggs <twmeggs at gmail.com> wrote:
> Hi - I'm fairly new to R. ?Have been reading up a lot and am impressed with
> the language's versatility and hope to spend much time getting to grips
> with it. ?(I'd like to thank those that have built out the really useful
> Quantmod, Quantstrat, TTR, PerformanceAnalytics, Blotter packages for all
> their hard work meaning I, and those with similar interests, dont have to
> reinvent the wheel!)
>
> Having a problem with my understanding of how to use sigFornula, as my code
> has started to throw an error after I'd tried to implement it - any help or
> guidance would be greatly appreciated - thanks!:
>
> Getting the following error:
>
>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>
> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1),
> .indexFORMAT = indexFormat(e1), ?:
>
> ?index length must match number of observations
>
>> updatePortf("RSI4")
>
> [1] "RSI4"
>
>
> when running the following adaption of one of the Quantstrat demos:
>
> # This code is an attempt to backtest Connor's RSI(4) filter for long trades
>
> #http://forums.stockfetcher.com/sfforums/?q=view&tid=93830&start=0
>
> #install.packages(c("quantstrat","blotter","FinancialInstrument"), repos="
> http://r-forge.r-project.org")
>
> require(quantstrat)
>
> require(PerformanceAnalytics)
>
>
>
> # Set initial values
>
> initDate <- "2006-07-31"
>
> endDate <- "2011-10-31"
>
> initEq <- 100000
>
>
>
>
>
> # Pull Yahoo Finance data
>
> symbols <- c("SPY")
>
> getSymbols(symbols, from=initDate, to=endDate,
> index.class=c("POSIXt","POSIXct"))
>
>
>
> # Set up instruments with FinancialInstruments package
>
> currency("USD")
>
> for(symbol in symbols) {
>
> ?stock(symbol, currency="USD", multiplier=1)
>
> }
>
>
>
> # Delete portfolio, account, and order book if they already exist
>
> suppressWarnings(rm("account.RSI4","portfolio.RSI4",pos=.blotter))
>
> suppressWarnings(rm("order_book.RSI4",pos=.strategy))
>
>
>
>
>
> # Initialize portfolio and account
>
> initPortf("RSI4", symbols=symbols, initDate=initDate)
>
> initAcct("RSI4", portfolios="RSI4", initDate=initDate, initEq=initEq)
>
> initOrders(portfolio="RSI4", initDate=initDate)
>
>
>
> # Initialize a strategy object
>
> stratRSI4 <- strategy("RSI4")
>
>
>
>
>
> ####INDICATORS####
>
> # Add the 200-day SMA indicator
>
> stratRSI4 <- add.indicator(strategy=stratRSI4, name="SMA", arguments =
> list(x=quote(Cl(mktdata)), n=200), label="SMA200")
>
> # Add the RSI4 indicator
>
> stratRSI4 <- add.indicator(strategy=stratRSI4, name="RSI", arguments =
> list(price = quote(getPrice(mktdata)), n=4), label="RSI")
>
>
>
>
>
> ####SIGNALS####
>
> # There are two signals:
>
> # The first is when close price is above the 200 day moving average and
> RSI4 is below 25
>
> stratRSI4 <- add.signal(stratRSI4, name="sigFormula", arguments = list(data
> = columns=c("Close","SMA200","RSI"), formula = "(Close > SMA200) & (RSI <
> 25)", label="trigger"), cross=TRUE), label="Cl.gt.SMA")
>
> # The second is when the RSI4 closes above 55
>
> stratRSI4 <- add.signal(stratRSI4,
> name="sigThreshold",arguments=list(threshold=55, column="RSI",
> relationship="lt", cross=TRUE), label="Cl.lt.RSI")
>
>
>
>
>
> ####RULES####
>
> # There are two rules:
>
> # The first is to buy when the price is above the SMA and RSI4 below 25
> (the first signal)
>
> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
> arguments=list(sigcol="Cl.gt.SMA", sigval=TRUE, orderqty=1000,
> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5,
> osFUN=osMaxPos), type="enter", path.dep=TRUE)
>
> # The second is to sell when the RSI climbs above 55
>
> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
> arguments=list(sigcol="Cl.lt.RSI", sigval=TRUE, orderqty="all",
> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5),
> type="exit", path.dep=TRUE)
>
>
>
>
>
> # Set position limits so we don't add to the position every month Close >
> SMA10
>
> addPosLimit("RSI4", "SPY", timestamp=initDate, maxpos=1000, minpos=0)
>
>
>
> # Process the indicators and generate trades
>
> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>
> updatePortf("RSI4")
>
>
>
> # Evaluate results
>
> portRet <- PortfReturns("RSI4")
>
> portRet$Total <- rowSums(portRet, na.rm=TRUE)
>
> charts.PerformanceSummary(portRet$Total)
>
> tradeStats("RSI4")[,c("Symbol","Num.Trades","Net.Trading.PL<http://net.trading.pl/>
> ","maxDrawdown")]
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Thu Jan  5 15:30:11 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 5 Jan 2012 08:30:11 -0600
Subject: [R-SIG-Finance] exponentially weighted linear regression
Message-ID: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/47207be7/attachment.pl>

From zach.mayer at gmail.com  Thu Jan  5 15:40:28 2012
From: zach.mayer at gmail.com (Zachary Mayer)
Date: Thu, 5 Jan 2012 09:40:28 -0500
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
Message-ID: <CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/ddfbcd69/attachment.pl>

From comtech.usa at gmail.com  Thu Jan  5 16:16:36 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 5 Jan 2012 09:16:36 -0600
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
Message-ID: <CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/c05124cc/attachment.pl>

From zach.mayer at gmail.com  Thu Jan  5 16:22:01 2012
From: zach.mayer at gmail.com (Zachary Mayer)
Date: Thu, 5 Jan 2012 10:22:01 -0500
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
Message-ID: <CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/0bd9a2f3/attachment.pl>

From comtech.usa at gmail.com  Thu Jan  5 16:37:51 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 5 Jan 2012 09:37:51 -0600
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
Message-ID: <CAPNjSFYiHyydT2bN7S-R1P62-e7ViY40v=KFB8HhCOiRUxYh8w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/a2792eac/attachment.pl>

From comtech.usa at gmail.com  Thu Jan  5 16:40:18 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 5 Jan 2012 09:40:18 -0600
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAPNjSFYiHyydT2bN7S-R1P62-e7ViY40v=KFB8HhCOiRUxYh8w@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
	<CAPNjSFYiHyydT2bN7S-R1P62-e7ViY40v=KFB8HhCOiRUxYh8w@mail.gmail.com>
Message-ID: <CAPNjSFYs_=_eJi1RUveao_6CVnM6bnLeZ4w_PbHNdxpugJX8Vw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/d55bbf8b/attachment.pl>

From riccardovisca at yahoo.it  Thu Jan  5 16:44:20 2012
From: riccardovisca at yahoo.it (riccardo visca)
Date: Thu, 5 Jan 2012 15:44:20 +0000
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
Message-ID: <1325778260.44939.YahooMailNeo@web132203.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/b8d87abb/attachment.pl>

From zach.mayer at gmail.com  Thu Jan  5 16:47:23 2012
From: zach.mayer at gmail.com (Zachary Mayer)
Date: Thu, 5 Jan 2012 10:47:23 -0500
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <CAPNjSFYs_=_eJi1RUveao_6CVnM6bnLeZ4w_PbHNdxpugJX8Vw@mail.gmail.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
	<CAPNjSFYiHyydT2bN7S-R1P62-e7ViY40v=KFB8HhCOiRUxYh8w@mail.gmail.com>
	<CAPNjSFYs_=_eJi1RUveao_6CVnM6bnLeZ4w_PbHNdxpugJX8Vw@mail.gmail.com>
Message-ID: <CAEr64e8RMBbKUE4A+SZyFLyU2pr4kPhzutVU_9CHna=xhWGOjQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/eda1d77e/attachment.pl>

From comtech.usa at gmail.com  Thu Jan  5 17:20:00 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 5 Jan 2012 10:20:00 -0600
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <1325778260.44939.YahooMailNeo@web132203.mail.ird.yahoo.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
	<1325778260.44939.YahooMailNeo@web132203.mail.ird.yahoo.com>
Message-ID: <CAPNjSFagc7kd4=VscCD6=Y2F77EjC9dDpN0YZG4N36fPqCkyKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/8bf32eed/attachment.pl>

From Bauermartin at gmx.at  Thu Jan  5 17:31:08 2012
From: Bauermartin at gmx.at (Martin Bauer)
Date: Thu, 05 Jan 2012 17:31:08 +0100
Subject: [R-SIG-Finance] holding period quant mod ?
Message-ID: <20120105163108.293560@gmx.net>

Hello,

here is my code


require(quantmod)
require(PerformanceAnalytics)
sym=getSymbols("SPY",from="1900-01-01")
ma=SMA(Ad(SPY),20)
sigl=ifelse(Ad(SPY)>ma, 1, 0)
ret=lag(sigl,1)*ROC(Ad(SPY),type="discrete",n=1)
re=merge(ret,ROC(SPY[,6],type="discrete",n=1))
table.Drawdowns(ret, top=10)
table.DownsideRisk(ret)

What is missing here - after two days of investment the position should be close

Any ideas ? - any library available to use ?

Looking for support

Many thanks in advance


--


From roger.bos at rothschild.com  Thu Jan  5 21:43:24 2012
From: roger.bos at rothschild.com (Bos, Roger)
Date: Thu, 5 Jan 2012 15:43:24 -0500
Subject: [R-SIG-Finance] Latest version of R for blotter
In-Reply-To: <20120105163108.293560@gmx.net>
References: <20120105163108.293560@gmx.net>
Message-ID: <D8C95B444AD6EE4AAD638D818A9CFD3406226D9A@RINNYCSE000.rth.ad.rothschild.com>

I am getting an error that blotter is not available for R version
2.14.1patched and 2.14.0. 

Here is my command:
install.packages("blotter",repos="http://R-Forge.R-project.org") 

I get the following error:

Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
  package 'blotter' is not available (for R version 2.14.0)
> 

Here is my sessionInfo():

> sessionInfo()
R version 2.14.0 (2011-10-31)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United
States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


loaded via a namespace (and not attached):
[1] tools_2.14.0
> 

***************************************************************
This message is for the named person's use only. It may\...{{dropped:11}}


From josh.m.ulrich at gmail.com  Thu Jan  5 22:00:45 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 5 Jan 2012 15:00:45 -0600
Subject: [R-SIG-Finance] Latest version of R for blotter
In-Reply-To: <D8C95B444AD6EE4AAD638D818A9CFD3406226D9A@RINNYCSE000.rth.ad.rothschild.com>
References: <20120105163108.293560@gmx.net>
	<D8C95B444AD6EE4AAD638D818A9CFD3406226D9A@RINNYCSE000.rth.ad.rothschild.com>
Message-ID: <CAPPM_gTNAEATF3o2FGyMtX_=OO1wrmnxnBPvujEG89=DD4barw@mail.gmail.com>

Roger,

To be specific, the _binary_ is not available.  As always, you could
have installed the source yourself.

There was an issue that prevented the binaries from being built.  I
fixed it yesterday, but it must have been after the R-Forge daily
build cycle.  The binaries should be available in less than 24 hours.

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Thu, Jan 5, 2012 at 2:43 PM, Bos, Roger <roger.bos at rothschild.com> wrote:
> I am getting an error that blotter is not available for R version
> 2.14.1patched and 2.14.0.
>
> Here is my command:
> install.packages("blotter",repos="http://R-Forge.R-project.org")
>
> I get the following error:
>
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
> ?package 'blotter' is not available (for R version 2.14.0)
>>
>
> Here is my sessionInfo():
>
>> sessionInfo()
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
> States.1252 ? ?LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C ? ? ? ? ? ? ? ? ? ? ? ? ? LC_TIME=English_United
> States.1252
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
>
> loaded via a namespace (and not attached):
> [1] tools_2.14.0
>>
>
> ***************************************************************
> This message is for the named person's use only. It may\...{{dropped:11}}
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From roger.bos at rothschild.com  Thu Jan  5 22:20:16 2012
From: roger.bos at rothschild.com (Bos, Roger)
Date: Thu, 5 Jan 2012 16:20:16 -0500
Subject: [R-SIG-Finance] Latest version of R for blotter
In-Reply-To: <CAPPM_gTNAEATF3o2FGyMtX_=OO1wrmnxnBPvujEG89=DD4barw@mail.gmail.com>
References: <20120105163108.293560@gmx.net>
	<D8C95B444AD6EE4AAD638D818A9CFD3406226D9A@RINNYCSE000.rth.ad.rothschild.com>
	<CAPPM_gTNAEATF3o2FGyMtX_=OO1wrmnxnBPvujEG89=DD4barw@mail.gmail.com>
Message-ID: <D8C95B444AD6EE4AAD638D818A9CFD3406226DAC@RINNYCSE000.rth.ad.rothschild.com>

Thanks Josh!  I guess I am just lazy in that respect.  Linux users are used to building everything, but the R-maintainers really spoils all of us windows users by providing binaries of everything.

 

-----Original Message-----
From: Joshua Ulrich [mailto:josh.m.ulrich at gmail.com] 
Sent: Thursday, January 05, 2012 4:01 PM
To: Bos, Roger
Cc: R Sig Finance
Subject: Re: [R-SIG-Finance] Latest version of R for blotter

Roger,

To be specific, the _binary_ is not available.  As always, you could have installed the source yourself.

There was an issue that prevented the binaries from being built.  I fixed it yesterday, but it must have been after the R-Forge daily build cycle.  The binaries should be available in less than 24 hours.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



On Thu, Jan 5, 2012 at 2:43 PM, Bos, Roger <roger.bos at rothschild.com> wrote:
> I am getting an error that blotter is not available for R version 
> 2.14.1patched and 2.14.0.
>
> Here is my command:
> install.packages("blotter",repos="http://R-Forge.R-project.org")
>
> I get the following error:
>
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
>  package 'blotter' is not available (for R version 2.14.0)
>>
>
> Here is my sessionInfo():
>
>> sessionInfo()
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252    LC_MONETARY=English_United States.1252 [4] LC_NUMERIC=C                           
> LC_TIME=English_United
> States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> loaded via a namespace (and not attached):
> [1] tools_2.14.0
>>
>
> ***************************************************************
> This message is for the named person's use only. It ...{{dropped:25}}


From brian at braverock.com  Thu Jan  5 22:37:23 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 05 Jan 2012 15:37:23 -0600
Subject: [R-SIG-Finance] Latest version of R for blotter
In-Reply-To: <D8C95B444AD6EE4AAD638D818A9CFD3406226DAC@RINNYCSE000.rth.ad.rothschild.com>
References: <20120105163108.293560@gmx.net>
	<D8C95B444AD6EE4AAD638D818A9CFD3406226D9A@RINNYCSE000.rth.ad.rothschild.com>
	<CAPPM_gTNAEATF3o2FGyMtX_=OO1wrmnxnBPvujEG89=DD4barw@mail.gmail.com>
	<D8C95B444AD6EE4AAD638D818A9CFD3406226DAC@RINNYCSE000.rth.ad.rothschild.com>
Message-ID: <1325799443.16398.45.camel@brian-rcg>

On Thu, 2012-01-05 at 16:20 -0500, Bos, Roger wrote:
> Thanks Josh!  I guess I am just lazy in that respect.  Linux users are
> used to building everything, but the R-maintainers really spoils all
> of us windows users by providing binaries of everything.

Clearly true.

Unfortunately, when you're using code from R-Forge such as
blotter/FinancialInstrument/quantstrat, those packages are changing
multiple times per week, and sometimes multiple times per day...

... so building from source, even on Windows, using Rtools to install
the source package is the best way to keep up.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From nerotulip at gmail.com  Thu Jan  5 23:10:18 2012
From: nerotulip at gmail.com (Nero Tulip)
Date: Thu, 5 Jan 2012 22:10:18 +0000
Subject: [R-SIG-Finance] RBloomberg on R 2.14.0
In-Reply-To: <CAA3Wa=viNraACT5KvfX8MshGfe941n8-tfTTvfKQzZ-NPdpETQ@mail.gmail.com>
References: <CAD8CxKBQyZFs+bu_y0hiXvhXYsyjtVqNH2SWbogmmgw=xQMamw@mail.gmail.com>
	<CAA3Wa=v=2z5GyZWW33XpCHtYBgwCXCQFk2tTbxEft5n_S9M_1g@mail.gmail.com>
	<CAD8CxKDAK9=QqxHmwzXCUhDF6+pEfXbr1Sgf_zkT9s=aW2vLXg@mail.gmail.com>
	<CAA3Wa=viNraACT5KvfX8MshGfe941n8-tfTTvfKQzZ-NPdpETQ@mail.gmail.com>
Message-ID: <CAD8CxKAnM1or7BBJmVjv5LXg1HT_6svD4oii70WKveVK=4EqSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/85228c75/attachment.pl>

From comtech.usa at gmail.com  Fri Jan  6 01:59:55 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 5 Jan 2012 18:59:55 -0600
Subject: [R-SIG-Finance] arima estimation - how many data points are needed?
Message-ID: <CAPNjSFZyL=mGvXn6qP2mfsn96gWnRVPuqPZakBtauoSgRBvBQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120105/9db0dc70/attachment.pl>

From alexios at 4dscape.com  Fri Jan  6 02:25:20 2012
From: alexios at 4dscape.com (alexios)
Date: Fri, 6 Jan 2012 01:25:20 +0000
Subject: [R-SIG-Finance] arima estimation - how many data points are
	needed?
In-Reply-To: <CAPNjSFZyL=mGvXn6qP2mfsn96gWnRVPuqPZakBtauoSgRBvBQA@mail.gmail.com>
References: <CAPNjSFZyL=mGvXn6qP2mfsn96gWnRVPuqPZakBtauoSgRBvBQA@mail.gmail.com>
Message-ID: <4F064D80.6080107@4dscape.com>

Depends...but you might want to read this:

http://en.wikipedia.org/wiki/Estimator

and see section under "Asymptotic normality" (sqrt(n)).

If you want a direct proof for ARMA see this:
http://eprints.lse.ac.uk/5825/1/Gaussian_maximum_likelihood_estimation_for_ARMA_models_I%28LSERO%29.pdf


Regards,
Alexios

On 06/01/2012 00:59, Michael wrote:
> Hi all,
>
> In arima model estimation in R, what's the minimal number of data points
> that's needed for a meaningful statistically sound estimation for, say,
> ARMA(1, 1) model?
>
> Is there a rule-of-thumb?
>
> Thanks a lot!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From breman.mark at gmail.com  Fri Jan  6 21:08:52 2012
From: breman.mark at gmail.com (Mark Breman)
Date: Fri, 6 Jan 2012 21:08:52 +0100
Subject: [R-SIG-Finance] Where is my hedge ratio when testing for
 cointegration with Phillips-Ouliaris test?
Message-ID: <CAEaVHoL7pu5Zu-asd+zKMgSDM5E3eDzzb44fem0oxGFQw1b5jA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120106/20492fc3/attachment.pl>

From michael.weylandt at gmail.com  Fri Jan  6 21:15:22 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 6 Jan 2012 14:15:22 -0600
Subject: [R-SIG-Finance] Where is my hedge ratio when testing for
 cointegration with Phillips-Ouliaris test?
In-Reply-To: <CAEaVHoL7pu5Zu-asd+zKMgSDM5E3eDzzb44fem0oxGFQw1b5jA@mail.gmail.com>
References: <CAEaVHoL7pu5Zu-asd+zKMgSDM5E3eDzzb44fem0oxGFQw1b5jA@mail.gmail.com>
Message-ID: <CAAmySGMCqn3KHg+ckZjyKw7J63sEZ+m1Aa5RAhfyMLGDg4LEnA@mail.gmail.com>

Slightly beyond the scope of your question, but this might be of
interest: http://quanttrader.info/public/betterHedgeRatios.pdf

Michael

On Fri, Jan 6, 2012 at 2:08 PM, Mark Breman <breman.mark at gmail.com> wrote:
> Hello List,
>
> I'm testing multivariate timeseries for cointegration using the
> Phillips-Ouliaris test from package urca (ca.po) i.e:
>
> ############################################# start example
> ################################
>> library(quantmod)
>> library(urca)
>>
>> getSymbols(c('GLD', 'GDX'), from="2006-01-01")
> [1] "GLD" "GDX"
>>
>> prices=na.omit(cbind(Ad(GLD), Ad(GDX)))
>>
>> summary(ca.po(coredata(prices), type='Pz'))
>
> ########################################
> # Phillips and Ouliaris Unit Root Test #
> ########################################
>
> Test of type Pz
> detrending of series none
>
> Response GLD.Adjusted :
>
> Call:
> lm(formula = GLD.Adjusted ~ zr - 1)
>
> Residuals:
> ? ?Min ? ? ?1Q ?Median ? ? ?3Q ? ? Max
> -9.3422 -0.6212 ?0.0540 ?0.7783 ?8.6275
>
> Coefficients:
> ? ? ? ? ? ? ? ?Estimate Std. Error t value Pr(>|t|)
> zrGLD.Adjusted 1.0004786 ?0.0020531 487.295 ? <2e-16 ***
> zrGDX.Adjusted 0.0001917 ?0.0047246 ? 0.041 ? ?0.968
> ---
> Signif. codes: ?0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
>
> Residual standard error: 1.44 on 1414 degrees of freedom
> Multiple R-squared: 0.9998, Adjusted R-squared: 0.9998
> F-statistic: 3.78e+06 on 2 and 1414 DF, ?p-value: < 2.2e-16
>
>
> Response GDX.Adjusted :
>
> Call:
> lm(formula = GDX.Adjusted ~ zr - 1)
>
> Residuals:
> ? ?Min ? ? ?1Q ?Median ? ? ?3Q ? ? Max
> -5.0164 -0.6497 ?0.0160 ?0.7325 ?4.7142
>
> Coefficients:
> ? ? ? ? ? ? ? Estimate Std. Error t value Pr(>|t|)
> zrGLD.Adjusted 0.001727 ? 0.001608 ? 1.074 ? ?0.283
> zrGDX.Adjusted 0.996047 ? 0.003701 269.116 ? <2e-16 ***
> ---
> Signif. codes: ?0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
>
> Residual standard error: 1.128 on 1414 degrees of freedom
> Multiple R-squared: 0.9994, Adjusted R-squared: 0.9994
> F-statistic: 1.162e+06 on 2 and 1414 DF, ?p-value: < 2.2e-16
>
>
>
> Value of test-statistic is: 11.1864
>
> Critical values of Pz are:
> ? ? ? ? ? ? ? ? ?10pct ? ?5pct ? ?1pct
> critical values 33.9267 40.8217 55.1911
>
> ########################## end example ################################
>
> Now my question is where is my hedge ratio? The estimates (coefficients)
> don't look at all usable.
> Do i have to do a manual OLS regression to get the hedge ratio or is it
> hidden somewhere in the ca.po test results?
>
> Thanks,
>
> -Mark-
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Sat Jan  7 01:50:33 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 6 Jan 2012 18:50:33 -0600
Subject: [R-SIG-Finance] frequency in the xts object...
Message-ID: <CAPNjSFZS_bt_R34_h_unmRofkA76XJy1bK7pLcZrM-3+8=5D6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120106/b92eb5ca/attachment.pl>

From thomas.xue at gmail.com  Sun Jan  8 16:41:49 2012
From: thomas.xue at gmail.com (Thomas X)
Date: Sun, 8 Jan 2012 07:41:49 -0800 (PST)
Subject: [R-SIG-Finance] half life are different when applying diff
 frequencies to mean reverting time series
Message-ID: <1326037309413-4275915.post@n4.nabble.com>

Hi, All

I try to calculate the lengths of the half life of a mean reverting time
series by applying different frequencies (1 second, 1 minutes, 1 hour, etc)
to the same time series in its format (using to.period). I use the adfTest
to calculate the p-value. For different frequencies, the p-values of the
time series are all below 0.01.  However, the values of half-life confuse
me. For example.

In the frequency of 10 seconds, half-life is 0.25, which is equivalent to
2.5 seconds.
In the frequency of 1 hour, half-life is 0.15, which is equivalent to 9
minutes.

The values of the half life are different.

Any clue? Thanks.

-Thomas

--
View this message in context: http://r.789695.n4.nabble.com/half-life-are-different-when-applying-diff-frequencies-to-mean-reverting-time-series-tp4275915p4275915.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From belmont.lounge at yahoo.com  Mon Jan  9 01:52:48 2012
From: belmont.lounge at yahoo.com (Belmont)
Date: Sun, 8 Jan 2012 16:52:48 -0800 (PST)
Subject: [R-SIG-Finance] 60/40 Backtest
Message-ID: <1326070368.24332.YahooMailNeo@web44705.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120108/e6771b6e/attachment.pl>

From kent.russell at live.com  Mon Jan  9 03:23:04 2012
From: kent.russell at live.com (Kenton Russell)
Date: Sun, 8 Jan 2012 20:23:04 -0600
Subject: [R-SIG-Finance] 60/40 Backtest
In-Reply-To: <1326070368.24332.YahooMailNeo@web44705.mail.sp1.yahoo.com>
References: <1326070368.24332.YahooMailNeo@web44705.mail.sp1.yahoo.com>
Message-ID: <COL124-W492C706333E9E874D228DAFB980@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120108/050e8f0e/attachment.pl>

From kent.russell at live.com  Mon Jan  9 03:30:58 2012
From: kent.russell at live.com (Kenton Russell)
Date: Sun, 8 Jan 2012 20:30:58 -0600
Subject: [R-SIG-Finance] 60/40 Backtest
In-Reply-To: <COL124-W492C706333E9E874D228DAFB980@phx.gbl>
References: <1326070368.24332.YahooMailNeo@web44705.mail.sp1.yahoo.com>,
	<COL124-W492C706333E9E874D228DAFB980@phx.gbl>
Message-ID: <COL124-W17F514FB3EAAC7AA1FBCCAFB980@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120108/f53558be/attachment.pl>

From christian.langkamp at gmxpro.de  Mon Jan  9 13:12:40 2012
From: christian.langkamp at gmxpro.de (clangkamp)
Date: Mon, 9 Jan 2012 04:12:40 -0800 (PST)
Subject: [R-SIG-Finance] Calculating Hasbrouck's information share and
 Gonzalo-Granger weights on R
In-Reply-To: <AANLkTinWNEvAVUjk8TYVd_28mEUS_dKnezCPtX64v4Lo@mail.gmail.com>
References: <AANLkTinWNEvAVUjk8TYVd_28mEUS_dKnezCPtX64v4Lo@mail.gmail.com>
Message-ID: <1326111160519-4278272.post@n4.nabble.com>

Dear Nidhi
how did you fare in the end with the information share and the
Gonzalo-Granger weights ? Did you finalize the code ?
Do you by any chance know whether code for these items is available within a
standard R econometrics packages ?

Best wishes
Christian

-----
Christian Langkamp
christian.langkamp-at-gmxpro.de

--
View this message in context: http://r.789695.n4.nabble.com/Calculating-Hasbrouck-s-information-share-and-Gonzalo-Granger-weights-on-R-tp2395838p4278272.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From twmeggs at gmail.com  Mon Jan  9 15:46:18 2012
From: twmeggs at gmail.com (Tim Meggs)
Date: Mon, 9 Jan 2012 14:46:18 +0000
Subject: [R-SIG-Finance] Quantstrat using sigFormula
In-Reply-To: <CA+xi=qaAzEYUq7T++=BNBUV7nLNSSGm4VyeCBNTDDXcNPapg-g@mail.gmail.com>
References: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
	<CA+xi=qaAzEYUq7T++=BNBUV7nLNSSGm4VyeCBNTDDXcNPapg-g@mail.gmail.com>
Message-ID: <95775231-3B5F-4B51-BD70-957C80E645FA@gmail.com>

Hi Garrat. Thanks for the tip. Unfortunately it still throws the same error.

Hi Julien,
Thank you for the pointer to the posting guide. I will endeavour to follow it as best I can. 

I'm running Windows XP, R version 2.14.0 which I access trough the current version of R Studio. All my packages are up to date. 

In terms of examples, the exact code segment I am running starts at "# This code is an attempt to..." and ends at the call to the tradeStats() function. If you copy out that block from the below you should be able to replicate the same error. 

I can get the code to run fine before I introduce the addition of the signal that uses sigFormula. As there are no direct examples of how to use sigFormula, I am someway guessing the syntax. 

Given I'm sure this is where the problem lies, perhaps someone could provide a full example of how to build a custom indicator using the sigFormula functionally available in Quantstrat?

Thanks



Sent from my iPhone

On 4 Jan 2012, at 22:05, G See <gsee000 at gmail.com> wrote:

> Do you still have a problem if you use Date as the index class?
> 
> i.e. instead of:
> getSymbols(symbols, from=initDate, to=endDate,
> index.class=c("POSIXt","POSIXct"))
> 
> simply do this:
> getSymbols(symbols, from=initDate, to=endDate)
> 
> HTH,
> Garrett
> 
> On Wed, Jan 4, 2012 at 2:49 PM, Tim Meggs <twmeggs at gmail.com> wrote:
>> Hi - I'm fairly new to R.  Have been reading up a lot and am impressed with
>> the language's versatility and hope to spend much time getting to grips
>> with it.  (I'd like to thank those that have built out the really useful
>> Quantmod, Quantstrat, TTR, PerformanceAnalytics, Blotter packages for all
>> their hard work meaning I, and those with similar interests, dont have to
>> reinvent the wheel!)
>> 
>> Having a problem with my understanding of how to use sigFornula, as my code
>> has started to throw an error after I'd tried to implement it - any help or
>> guidance would be greatly appreciated - thanks!:
>> 
>> Getting the following error:
>> 
>>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>> 
>> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1),
>> .indexFORMAT = indexFormat(e1),  :
>> 
>> index length must match number of observations
>> 
>>> updatePortf("RSI4")
>> 
>> [1] "RSI4"
>> 
>> 
>> when running the following adaption of one of the Quantstrat demos:
>> 
>> # This code is an attempt to backtest Connor's RSI(4) filter for long trades
>> 
>> #http://forums.stockfetcher.com/sfforums/?q=view&tid=93830&start=0
>> 
>> #install.packages(c("quantstrat","blotter","FinancialInstrument"), repos="
>> http://r-forge.r-project.org")
>> 
>> require(quantstrat)
>> 
>> require(PerformanceAnalytics)
>> 
>> 
>> 
>> # Set initial values
>> 
>> initDate <- "2006-07-31"
>> 
>> endDate <- "2011-10-31"
>> 
>> initEq <- 100000
>> 
>> 
>> 
>> 
>> 
>> # Pull Yahoo Finance data
>> 
>> symbols <- c("SPY")
>> 
>> getSymbols(symbols, from=initDate, to=endDate,
>> index.class=c("POSIXt","POSIXct"))
>> 
>> 
>> 
>> # Set up instruments with FinancialInstruments package
>> 
>> currency("USD")
>> 
>> for(symbol in symbols) {
>> 
>> stock(symbol, currency="USD", multiplier=1)
>> 
>> }
>> 
>> 
>> 
>> # Delete portfolio, account, and order book if they already exist
>> 
>> suppressWarnings(rm("account.RSI4","portfolio.RSI4",pos=.blotter))
>> 
>> suppressWarnings(rm("order_book.RSI4",pos=.strategy))
>> 
>> 
>> 
>> 
>> 
>> # Initialize portfolio and account
>> 
>> initPortf("RSI4", symbols=symbols, initDate=initDate)
>> 
>> initAcct("RSI4", portfolios="RSI4", initDate=initDate, initEq=initEq)
>> 
>> initOrders(portfolio="RSI4", initDate=initDate)
>> 
>> 
>> 
>> # Initialize a strategy object
>> 
>> stratRSI4 <- strategy("RSI4")
>> 
>> 
>> 
>> 
>> 
>> ####INDICATORS####
>> 
>> # Add the 200-day SMA indicator
>> 
>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="SMA", arguments =
>> list(x=quote(Cl(mktdata)), n=200), label="SMA200")
>> 
>> # Add the RSI4 indicator
>> 
>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="RSI", arguments =
>> list(price = quote(getPrice(mktdata)), n=4), label="RSI")
>> 
>> 
>> 
>> 
>> 
>> ####SIGNALS####
>> 
>> # There are two signals:
>> 
>> # The first is when close price is above the 200 day moving average and
>> RSI4 is below 25
>> 
>> stratRSI4 <- add.signal(stratRSI4, name="sigFormula", arguments = list(data
>> = columns=c("Close","SMA200","RSI"), formula = "(Close > SMA200) & (RSI <
>> 25)", label="trigger"), cross=TRUE), label="Cl.gt.SMA")
>> 
>> # The second is when the RSI4 closes above 55
>> 
>> stratRSI4 <- add.signal(stratRSI4,
>> name="sigThreshold",arguments=list(threshold=55, column="RSI",
>> relationship="lt", cross=TRUE), label="Cl.lt.RSI")
>> 
>> 
>> 
>> 
>> 
>> ####RULES####
>> 
>> # There are two rules:
>> 
>> # The first is to buy when the price is above the SMA and RSI4 below 25
>> (the first signal)
>> 
>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
>> arguments=list(sigcol="Cl.gt.SMA", sigval=TRUE, orderqty=1000,
>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5,
>> osFUN=osMaxPos), type="enter", path.dep=TRUE)
>> 
>> # The second is to sell when the RSI climbs above 55
>> 
>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
>> arguments=list(sigcol="Cl.lt.RSI", sigval=TRUE, orderqty="all",
>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5),
>> type="exit", path.dep=TRUE)
>> 
>> 
>> 
>> 
>> 
>> # Set position limits so we don't add to the position every month Close >
>> SMA10
>> 
>> addPosLimit("RSI4", "SPY", timestamp=initDate, maxpos=1000, minpos=0)
>> 
>> 
>> 
>> # Process the indicators and generate trades
>> 
>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>> 
>> updatePortf("RSI4")
>> 
>> 
>> 
>> # Evaluate results
>> 
>> portRet <- PortfReturns("RSI4")
>> 
>> portRet$Total <- rowSums(portRet, na.rm=TRUE)
>> 
>> charts.PerformanceSummary(portRet$Total)
>> 
>> tradeStats("RSI4")[,c("Symbol","Num.Trades","Net.Trading.PL<http://net.trading.pl/>
>> ","maxDrawdown")]
>> 
>>       [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.


From gsee000 at gmail.com  Mon Jan  9 16:09:45 2012
From: gsee000 at gmail.com (G See)
Date: Mon, 9 Jan 2012 09:09:45 -0600
Subject: [R-SIG-Finance] Quantstrat using sigFormula
In-Reply-To: <95775231-3B5F-4B51-BD70-957C80E645FA@gmail.com>
References: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
	<CA+xi=qaAzEYUq7T++=BNBUV7nLNSSGm4VyeCBNTDDXcNPapg-g@mail.gmail.com>
	<95775231-3B5F-4B51-BD70-957C80E645FA@gmail.com>
Message-ID: <CA+xi=qZfLw7uRiAPGhcox9HxguGurOOXExTxeO7PqUMiM5QY4Q@mail.gmail.com>

Tim,

Try this syntax:

###
stratRSI4 <-
add.signal(stratRSI4,
    name="sigFormula",
    arguments = list(columns=c("Close","SMA200","RSI"),
                     formula = "(SPY.Close > SMA200) & (RSI < 25)",
                     label="trigger",
                     cross=TRUE),
    label="Cl.gt.SMA")

###
At least, that will not throw an errror.  But, I've never used
sigFormula, so hopefully someone that has will chime in if it's wrong.

HTH,
Garrett

On Mon, Jan 9, 2012 at 8:46 AM, Tim Meggs <twmeggs at gmail.com> wrote:
> Hi Garrat. Thanks for the tip. Unfortunately it still throws the same error.
>
> Hi Julien,
> Thank you for the pointer to the posting guide. I will endeavour to follow it as best I can.
>
> I'm running Windows XP, R version 2.14.0 which I access trough the current version of R Studio. All my packages are up to date.
>
> In terms of examples, the exact code segment I am running starts at "# This code is an attempt to..." and ends at the call to the tradeStats() function. If you copy out that block from the below you should be able to replicate the same error.
>
> I can get the code to run fine before I introduce the addition of the signal that uses sigFormula. As there are no direct examples of how to use sigFormula, I am someway guessing the syntax.
>
> Given I'm sure this is where the problem lies, perhaps someone could provide a full example of how to build a custom indicator using the sigFormula functionally available in Quantstrat?
>
> Thanks
>
>
>
> Sent from my iPhone
>
> On 4 Jan 2012, at 22:05, G See <gsee000 at gmail.com> wrote:
>
>> Do you still have a problem if you use Date as the index class?
>>
>> i.e. instead of:
>> getSymbols(symbols, from=initDate, to=endDate,
>> index.class=c("POSIXt","POSIXct"))
>>
>> simply do this:
>> getSymbols(symbols, from=initDate, to=endDate)
>>
>> HTH,
>> Garrett
>>
>> On Wed, Jan 4, 2012 at 2:49 PM, Tim Meggs <twmeggs at gmail.com> wrote:
>>> Hi - I'm fairly new to R. ?Have been reading up a lot and am impressed with
>>> the language's versatility and hope to spend much time getting to grips
>>> with it. ?(I'd like to thank those that have built out the really useful
>>> Quantmod, Quantstrat, TTR, PerformanceAnalytics, Blotter packages for all
>>> their hard work meaning I, and those with similar interests, dont have to
>>> reinvent the wheel!)
>>>
>>> Having a problem with my understanding of how to use sigFornula, as my code
>>> has started to throw an error after I'd tried to implement it - any help or
>>> guidance would be greatly appreciated - thanks!:
>>>
>>> Getting the following error:
>>>
>>>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>>>
>>> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1),
>>> .indexFORMAT = indexFormat(e1), ?:
>>>
>>> index length must match number of observations
>>>
>>>> updatePortf("RSI4")
>>>
>>> [1] "RSI4"
>>>
>>>
>>> when running the following adaption of one of the Quantstrat demos:
>>>
>>> # This code is an attempt to backtest Connor's RSI(4) filter for long trades
>>>
>>> #http://forums.stockfetcher.com/sfforums/?q=view&tid=93830&start=0
>>>
>>> #install.packages(c("quantstrat","blotter","FinancialInstrument"), repos="
>>> http://r-forge.r-project.org")
>>>
>>> require(quantstrat)
>>>
>>> require(PerformanceAnalytics)
>>>
>>>
>>>
>>> # Set initial values
>>>
>>> initDate <- "2006-07-31"
>>>
>>> endDate <- "2011-10-31"
>>>
>>> initEq <- 100000
>>>
>>>
>>>
>>>
>>>
>>> # Pull Yahoo Finance data
>>>
>>> symbols <- c("SPY")
>>>
>>> getSymbols(symbols, from=initDate, to=endDate,
>>> index.class=c("POSIXt","POSIXct"))
>>>
>>>
>>>
>>> # Set up instruments with FinancialInstruments package
>>>
>>> currency("USD")
>>>
>>> for(symbol in symbols) {
>>>
>>> stock(symbol, currency="USD", multiplier=1)
>>>
>>> }
>>>
>>>
>>>
>>> # Delete portfolio, account, and order book if they already exist
>>>
>>> suppressWarnings(rm("account.RSI4","portfolio.RSI4",pos=.blotter))
>>>
>>> suppressWarnings(rm("order_book.RSI4",pos=.strategy))
>>>
>>>
>>>
>>>
>>>
>>> # Initialize portfolio and account
>>>
>>> initPortf("RSI4", symbols=symbols, initDate=initDate)
>>>
>>> initAcct("RSI4", portfolios="RSI4", initDate=initDate, initEq=initEq)
>>>
>>> initOrders(portfolio="RSI4", initDate=initDate)
>>>
>>>
>>>
>>> # Initialize a strategy object
>>>
>>> stratRSI4 <- strategy("RSI4")
>>>
>>>
>>>
>>>
>>>
>>> ####INDICATORS####
>>>
>>> # Add the 200-day SMA indicator
>>>
>>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="SMA", arguments =
>>> list(x=quote(Cl(mktdata)), n=200), label="SMA200")
>>>
>>> # Add the RSI4 indicator
>>>
>>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="RSI", arguments =
>>> list(price = quote(getPrice(mktdata)), n=4), label="RSI")
>>>
>>>
>>>
>>>
>>>
>>> ####SIGNALS####
>>>
>>> # There are two signals:
>>>
>>> # The first is when close price is above the 200 day moving average and
>>> RSI4 is below 25
>>>
>>> stratRSI4 <- add.signal(stratRSI4, name="sigFormula", arguments = list(data
>>> = columns=c("Close","SMA200","RSI"), formula = "(Close > SMA200) & (RSI <
>>> 25)", label="trigger"), cross=TRUE), label="Cl.gt.SMA")
>>>
>>> # The second is when the RSI4 closes above 55
>>>
>>> stratRSI4 <- add.signal(stratRSI4,
>>> name="sigThreshold",arguments=list(threshold=55, column="RSI",
>>> relationship="lt", cross=TRUE), label="Cl.lt.RSI")
>>>
>>>
>>>
>>>
>>>
>>> ####RULES####
>>>
>>> # There are two rules:
>>>
>>> # The first is to buy when the price is above the SMA and RSI4 below 25
>>> (the first signal)
>>>
>>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
>>> arguments=list(sigcol="Cl.gt.SMA", sigval=TRUE, orderqty=1000,
>>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5,
>>> osFUN=osMaxPos), type="enter", path.dep=TRUE)
>>>
>>> # The second is to sell when the RSI climbs above 55
>>>
>>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
>>> arguments=list(sigcol="Cl.lt.RSI", sigval=TRUE, orderqty="all",
>>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5),
>>> type="exit", path.dep=TRUE)
>>>
>>>
>>>
>>>
>>>
>>> # Set position limits so we don't add to the position every month Close >
>>> SMA10
>>>
>>> addPosLimit("RSI4", "SPY", timestamp=initDate, maxpos=1000, minpos=0)
>>>
>>>
>>>
>>> # Process the indicators and generate trades
>>>
>>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>>>
>>> updatePortf("RSI4")
>>>
>>>
>>>
>>> # Evaluate results
>>>
>>> portRet <- PortfReturns("RSI4")
>>>
>>> portRet$Total <- rowSums(portRet, na.rm=TRUE)
>>>
>>> charts.PerformanceSummary(portRet$Total)
>>>
>>> tradeStats("RSI4")[,c("Symbol","Num.Trades","Net.Trading.PL<http://net.trading.pl/>
>>> ","maxDrawdown")]
>>>
>>> ? ? ? [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>


From brian at braverock.com  Mon Jan  9 16:23:47 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 09 Jan 2012 09:23:47 -0600
Subject: [R-SIG-Finance] Quantstrat using sigFormula
In-Reply-To: <CA+xi=qZfLw7uRiAPGhcox9HxguGurOOXExTxeO7PqUMiM5QY4Q@mail.gmail.com>
References: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
	<CA+xi=qaAzEYUq7T++=BNBUV7nLNSSGm4VyeCBNTDDXcNPapg-g@mail.gmail.com>
	<95775231-3B5F-4B51-BD70-957C80E645FA@gmail.com>
	<CA+xi=qZfLw7uRiAPGhcox9HxguGurOOXExTxeO7PqUMiM5QY4Q@mail.gmail.com>
Message-ID: <1326122627.16398.85.camel@brian-rcg>

sigFormula uses an R syntax feature that allows you to use column names
directly as variables in a formula.  It does no partial matching, since
the columns *become* the formula variables.

Garrett's proposed formulation looks correct.

I will warn you that while sigFormula is very flexible, R isn't very
fast using this methodology.  It seems to be a side effect of the way
data.frames are stored as lists, and of the way that the
eval(parse(text=formula),x) syntax is managed internally by R.

For daily or lower-frequency data, that's probably fine, but for higher
frequencies I usually find it makes sense to write a custom indicator of
signal function for more complex comparisons.

Please let us know if Garrett's formulation works for you.  If not, I'll
try to look into it this week.

Regards,

   - Brian

On Mon, 2012-01-09 at 09:09 -0600, G See wrote:
> Tim,
> 
> Try this syntax:
> 
> ###
> stratRSI4 <-
> add.signal(stratRSI4,
>     name="sigFormula",
>     arguments = list(columns=c("Close","SMA200","RSI"),
>                      formula = "(SPY.Close > SMA200) & (RSI < 25)",
>                      label="trigger",
>                      cross=TRUE),
>     label="Cl.gt.SMA")
> 
> ###
> At least, that will not throw an errror.  But, I've never used
> sigFormula, so hopefully someone that has will chime in if it's wrong.
> 
> HTH,
> Garrett
> 
> On Mon, Jan 9, 2012 at 8:46 AM, Tim Meggs <twmeggs at gmail.com> wrote:
> > Hi Garrat. Thanks for the tip. Unfortunately it still throws the same error.
> >
> > Hi Julien,
> > Thank you for the pointer to the posting guide. I will endeavour to follow it as best I can.
> >
> > I'm running Windows XP, R version 2.14.0 which I access trough the current version of R Studio. All my packages are up to date.
> >
> > In terms of examples, the exact code segment I am running starts at "# This code is an attempt to..." and ends at the call to the tradeStats() function. If you copy out that block from the below you should be able to replicate the same error.
> >
> > I can get the code to run fine before I introduce the addition of the signal that uses sigFormula. As there are no direct examples of how to use sigFormula, I am someway guessing the syntax.
> >
> > Given I'm sure this is where the problem lies, perhaps someone could provide a full example of how to build a custom indicator using the sigFormula functionally available in Quantstrat?
> >
> > Thanks
> >
> >
> >
> > Sent from my iPhone
> >
> > On 4 Jan 2012, at 22:05, G See <gsee000 at gmail.com> wrote:
> >
> >> Do you still have a problem if you use Date as the index class?
> >>
> >> i.e. instead of:
> >> getSymbols(symbols, from=initDate, to=endDate,
> >> index.class=c("POSIXt","POSIXct"))
> >>
> >> simply do this:
> >> getSymbols(symbols, from=initDate, to=endDate)
> >>
> >> HTH,
> >> Garrett
> >>
> >> On Wed, Jan 4, 2012 at 2:49 PM, Tim Meggs <twmeggs at gmail.com> wrote:
> >>> Hi - I'm fairly new to R.  Have been reading up a lot and am impressed with
> >>> the language's versatility and hope to spend much time getting to grips
> >>> with it.  (I'd like to thank those that have built out the really useful
> >>> Quantmod, Quantstrat, TTR, PerformanceAnalytics, Blotter packages for all
> >>> their hard work meaning I, and those with similar interests, dont have to
> >>> reinvent the wheel!)
> >>>
> >>> Having a problem with my understanding of how to use sigFornula, as my code
> >>> has started to throw an error after I'd tried to implement it - any help or
> >>> guidance would be greatly appreciated - thanks!:
> >>>
> >>> Getting the following error:
> >>>
> >>>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
> >>>
> >>> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1),
> >>> .indexFORMAT = indexFormat(e1),  :
> >>>
> >>> index length must match number of observations
> >>>
> >>>> updatePortf("RSI4")
> >>>
> >>> [1] "RSI4"
> >>>
> >>>
> >>> when running the following adaption of one of the Quantstrat demos:
> >>>
> >>> # This code is an attempt to backtest Connor's RSI(4) filter for long trades
> >>>
> >>> #http://forums.stockfetcher.com/sfforums/?q=view&tid=93830&start=0
> >>>
> >>> #install.packages(c("quantstrat","blotter","FinancialInstrument"), repos="
> >>> http://r-forge.r-project.org")
> >>>
> >>> require(quantstrat)
> >>>
> >>> require(PerformanceAnalytics)
> >>>
> >>>
> >>>
> >>> # Set initial values
> >>>
> >>> initDate <- "2006-07-31"
> >>>
> >>> endDate <- "2011-10-31"
> >>>
> >>> initEq <- 100000
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> # Pull Yahoo Finance data
> >>>
> >>> symbols <- c("SPY")
> >>>
> >>> getSymbols(symbols, from=initDate, to=endDate,
> >>> index.class=c("POSIXt","POSIXct"))
> >>>
> >>>
> >>>
> >>> # Set up instruments with FinancialInstruments package
> >>>
> >>> currency("USD")
> >>>
> >>> for(symbol in symbols) {
> >>>
> >>> stock(symbol, currency="USD", multiplier=1)
> >>>
> >>> }
> >>>
> >>>
> >>>
> >>> # Delete portfolio, account, and order book if they already exist
> >>>
> >>> suppressWarnings(rm("account.RSI4","portfolio.RSI4",pos=.blotter))
> >>>
> >>> suppressWarnings(rm("order_book.RSI4",pos=.strategy))
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> # Initialize portfolio and account
> >>>
> >>> initPortf("RSI4", symbols=symbols, initDate=initDate)
> >>>
> >>> initAcct("RSI4", portfolios="RSI4", initDate=initDate, initEq=initEq)
> >>>
> >>> initOrders(portfolio="RSI4", initDate=initDate)
> >>>
> >>>
> >>>
> >>> # Initialize a strategy object
> >>>
> >>> stratRSI4 <- strategy("RSI4")
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> ####INDICATORS####
> >>>
> >>> # Add the 200-day SMA indicator
> >>>
> >>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="SMA", arguments =
> >>> list(x=quote(Cl(mktdata)), n=200), label="SMA200")
> >>>
> >>> # Add the RSI4 indicator
> >>>
> >>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="RSI", arguments =
> >>> list(price = quote(getPrice(mktdata)), n=4), label="RSI")
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> ####SIGNALS####
> >>>
> >>> # There are two signals:
> >>>
> >>> # The first is when close price is above the 200 day moving average and
> >>> RSI4 is below 25
> >>>
> >>> stratRSI4 <- add.signal(stratRSI4, name="sigFormula", arguments = list(data
> >>> = columns=c("Close","SMA200","RSI"), formula = "(Close > SMA200) & (RSI <
> >>> 25)", label="trigger"), cross=TRUE), label="Cl.gt.SMA")
> >>>
> >>> # The second is when the RSI4 closes above 55
> >>>
> >>> stratRSI4 <- add.signal(stratRSI4,
> >>> name="sigThreshold",arguments=list(threshold=55, column="RSI",
> >>> relationship="lt", cross=TRUE), label="Cl.lt.RSI")
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> ####RULES####
> >>>
> >>> # There are two rules:
> >>>
> >>> # The first is to buy when the price is above the SMA and RSI4 below 25
> >>> (the first signal)
> >>>
> >>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
> >>> arguments=list(sigcol="Cl.gt.SMA", sigval=TRUE, orderqty=1000,
> >>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5,
> >>> osFUN=osMaxPos), type="enter", path.dep=TRUE)
> >>>
> >>> # The second is to sell when the RSI climbs above 55
> >>>
> >>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
> >>> arguments=list(sigcol="Cl.lt.RSI", sigval=TRUE, orderqty="all",
> >>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5),
> >>> type="exit", path.dep=TRUE)
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> # Set position limits so we don't add to the position every month Close >
> >>> SMA10
> >>>
> >>> addPosLimit("RSI4", "SPY", timestamp=initDate, maxpos=1000, minpos=0)
> >>>
> >>>
> >>>
> >>> # Process the indicators and generate trades
> >>>
> >>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
> >>>
> >>> updatePortf("RSI4")
> >>>
> >>>
> >>>
> >>> # Evaluate results
> >>>
> >>> portRet <- PortfReturns("RSI4")
> >>>
> >>> portRet$Total <- rowSums(portRet, na.rm=TRUE)
> >>>
> >>> charts.PerformanceSummary(portRet$Total)
> >>>
> >>> tradeStats("RSI4")[,c("Symbol","Num.Trades","Net.Trading.PL<http://net.trading.pl/>
> >>> ","maxDrawdown")]
> >>>
> >>>       [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-SIG-Finance at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >>> -- Subscriber-posting only. If you want to post, subscribe first.
> >>> -- Also note that this is not the r-help list where general R questions should go.
> >
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From twmeggs at gmail.com  Mon Jan  9 21:57:23 2012
From: twmeggs at gmail.com (Tim Meggs)
Date: Mon, 9 Jan 2012 20:57:23 +0000
Subject: [R-SIG-Finance] Quantstrat using sigFormula
In-Reply-To: <CA+xi=qZfLw7uRiAPGhcox9HxguGurOOXExTxeO7PqUMiM5QY4Q@mail.gmail.com>
References: <CALevmT4OUrmLaNqp9HTNdVOiwaK8R1HnMCnr8gXEb5BEdLVTMg@mail.gmail.com>
	<CA+xi=qaAzEYUq7T++=BNBUV7nLNSSGm4VyeCBNTDDXcNPapg-g@mail.gmail.com>
	<95775231-3B5F-4B51-BD70-957C80E645FA@gmail.com>
	<CA+xi=qZfLw7uRiAPGhcox9HxguGurOOXExTxeO7PqUMiM5QY4Q@mail.gmail.com>
Message-ID: <2BAAE2EE-BF93-4562-A334-74658A724038@gmail.com>

Hi Garrett,

Thanks very much, that syntax has removed the error and has allowed me to continue. 

Thanks also Brian for the explanation. 

Thanks,
Tim



On 9 Jan 2012, at 15:09, G See <gsee000 at gmail.com> wrote:

> Tim,
> 
> Try this syntax:
> 
> ###
> stratRSI4 <-
> add.signal(stratRSI4,
>    name="sigFormula",
>    arguments = list(columns=c("Close","SMA200","RSI"),
>                     formula = "(SPY.Close > SMA200) & (RSI < 25)",
>                     label="trigger",
>                     cross=TRUE),
>    label="Cl.gt.SMA")
> 
> ###
> At least, that will not throw an errror.  But, I've never used
> sigFormula, so hopefully someone that has will chime in if it's wrong.
> 
> HTH,
> Garrett
> 
> On Mon, Jan 9, 2012 at 8:46 AM, Tim Meggs <twmeggs at gmail.com> wrote:
>> Hi Garrat. Thanks for the tip. Unfortunately it still throws the same error.
>> 
>> Hi Julien,
>> Thank you for the pointer to the posting guide. I will endeavour to follow it as best I can.
>> 
>> I'm running Windows XP, R version 2.14.0 which I access trough the current version of R Studio. All my packages are up to date.
>> 
>> In terms of examples, the exact code segment I am running starts at "# This code is an attempt to..." and ends at the call to the tradeStats() function. If you copy out that block from the below you should be able to replicate the same error.
>> 
>> I can get the code to run fine before I introduce the addition of the signal that uses sigFormula. As there are no direct examples of how to use sigFormula, I am someway guessing the syntax.
>> 
>> Given I'm sure this is where the problem lies, perhaps someone could provide a full example of how to build a custom indicator using the sigFormula functionally available in Quantstrat?
>> 
>> Thanks
>> 
>> 
>> 
>> Sent from my iPhone
>> 
>> On 4 Jan 2012, at 22:05, G See <gsee000 at gmail.com> wrote:
>> 
>>> Do you still have a problem if you use Date as the index class?
>>> 
>>> i.e. instead of:
>>> getSymbols(symbols, from=initDate, to=endDate,
>>> index.class=c("POSIXt","POSIXct"))
>>> 
>>> simply do this:
>>> getSymbols(symbols, from=initDate, to=endDate)
>>> 
>>> HTH,
>>> Garrett
>>> 
>>> On Wed, Jan 4, 2012 at 2:49 PM, Tim Meggs <twmeggs at gmail.com> wrote:
>>>> Hi - I'm fairly new to R.  Have been reading up a lot and am impressed with
>>>> the language's versatility and hope to spend much time getting to grips
>>>> with it.  (I'd like to thank those that have built out the really useful
>>>> Quantmod, Quantstrat, TTR, PerformanceAnalytics, Blotter packages for all
>>>> their hard work meaning I, and those with similar interests, dont have to
>>>> reinvent the wheel!)
>>>> 
>>>> Having a problem with my understanding of how to use sigFornula, as my code
>>>> has started to throw an error after I'd tried to implement it - any help or
>>>> guidance would be greatly appreciated - thanks!:
>>>> 
>>>> Getting the following error:
>>>> 
>>>>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>>>> 
>>>> Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1),
>>>> .indexFORMAT = indexFormat(e1),  :
>>>> 
>>>> index length must match number of observations
>>>> 
>>>>> updatePortf("RSI4")
>>>> 
>>>> [1] "RSI4"
>>>> 
>>>> 
>>>> when running the following adaption of one of the Quantstrat demos:
>>>> 
>>>> # This code is an attempt to backtest Connor's RSI(4) filter for long trades
>>>> 
>>>> #http://forums.stockfetcher.com/sfforums/?q=view&tid=93830&start=0
>>>> 
>>>> #install.packages(c("quantstrat","blotter","FinancialInstrument"), repos="
>>>> http://r-forge.r-project.org")
>>>> 
>>>> require(quantstrat)
>>>> 
>>>> require(PerformanceAnalytics)
>>>> 
>>>> 
>>>> 
>>>> # Set initial values
>>>> 
>>>> initDate <- "2006-07-31"
>>>> 
>>>> endDate <- "2011-10-31"
>>>> 
>>>> initEq <- 100000
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> # Pull Yahoo Finance data
>>>> 
>>>> symbols <- c("SPY")
>>>> 
>>>> getSymbols(symbols, from=initDate, to=endDate,
>>>> index.class=c("POSIXt","POSIXct"))
>>>> 
>>>> 
>>>> 
>>>> # Set up instruments with FinancialInstruments package
>>>> 
>>>> currency("USD")
>>>> 
>>>> for(symbol in symbols) {
>>>> 
>>>> stock(symbol, currency="USD", multiplier=1)
>>>> 
>>>> }
>>>> 
>>>> 
>>>> 
>>>> # Delete portfolio, account, and order book if they already exist
>>>> 
>>>> suppressWarnings(rm("account.RSI4","portfolio.RSI4",pos=.blotter))
>>>> 
>>>> suppressWarnings(rm("order_book.RSI4",pos=.strategy))
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> # Initialize portfolio and account
>>>> 
>>>> initPortf("RSI4", symbols=symbols, initDate=initDate)
>>>> 
>>>> initAcct("RSI4", portfolios="RSI4", initDate=initDate, initEq=initEq)
>>>> 
>>>> initOrders(portfolio="RSI4", initDate=initDate)
>>>> 
>>>> 
>>>> 
>>>> # Initialize a strategy object
>>>> 
>>>> stratRSI4 <- strategy("RSI4")
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> ####INDICATORS####
>>>> 
>>>> # Add the 200-day SMA indicator
>>>> 
>>>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="SMA", arguments =
>>>> list(x=quote(Cl(mktdata)), n=200), label="SMA200")
>>>> 
>>>> # Add the RSI4 indicator
>>>> 
>>>> stratRSI4 <- add.indicator(strategy=stratRSI4, name="RSI", arguments =
>>>> list(price = quote(getPrice(mktdata)), n=4), label="RSI")
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> ####SIGNALS####
>>>> 
>>>> # There are two signals:
>>>> 
>>>> # The first is when close price is above the 200 day moving average and
>>>> RSI4 is below 25
>>>> 
>>>> stratRSI4 <- add.signal(stratRSI4, name="sigFormula", arguments = list(data
>>>> = columns=c("Close","SMA200","RSI"), formula = "(Close > SMA200) & (RSI <
>>>> 25)", label="trigger"), cross=TRUE), label="Cl.gt.SMA")
>>>> 
>>>> # The second is when the RSI4 closes above 55
>>>> 
>>>> stratRSI4 <- add.signal(stratRSI4,
>>>> name="sigThreshold",arguments=list(threshold=55, column="RSI",
>>>> relationship="lt", cross=TRUE), label="Cl.lt.RSI")
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> ####RULES####
>>>> 
>>>> # There are two rules:
>>>> 
>>>> # The first is to buy when the price is above the SMA and RSI4 below 25
>>>> (the first signal)
>>>> 
>>>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
>>>> arguments=list(sigcol="Cl.gt.SMA", sigval=TRUE, orderqty=1000,
>>>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5,
>>>> osFUN=osMaxPos), type="enter", path.dep=TRUE)
>>>> 
>>>> # The second is to sell when the RSI climbs above 55
>>>> 
>>>> stratRSI4 <- add.rule(stratRSI4, name="ruleSignal",
>>>> arguments=list(sigcol="Cl.lt.RSI", sigval=TRUE, orderqty="all",
>>>> ordertype="market", orderside="long", pricemethod="market", TxnFees=-5),
>>>> type="exit", path.dep=TRUE)
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> # Set position limits so we don't add to the position every month Close >
>>>> SMA10
>>>> 
>>>> addPosLimit("RSI4", "SPY", timestamp=initDate, maxpos=1000, minpos=0)
>>>> 
>>>> 
>>>> 
>>>> # Process the indicators and generate trades
>>>> 
>>>> out <- try(applyStrategy(strategy=stratRSI4, portfolios="RSI4"))
>>>> 
>>>> updatePortf("RSI4")
>>>> 
>>>> 
>>>> 
>>>> # Evaluate results
>>>> 
>>>> portRet <- PortfReturns("RSI4")
>>>> 
>>>> portRet$Total <- rowSums(portRet, na.rm=TRUE)
>>>> 
>>>> charts.PerformanceSummary(portRet$Total)
>>>> 
>>>> tradeStats("RSI4")[,c("Symbol","Num.Trades","Net.Trading.PL<http://net.trading.pl/>
>>>> ","maxDrawdown")]
>>>> 
>>>>       [[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions should go.
>> 


From ezivot at u.washington.edu  Mon Jan  9 23:35:51 2012
From: ezivot at u.washington.edu (Eric Zivot)
Date: Mon, 9 Jan 2012 14:35:51 -0800
Subject: [R-SIG-Finance] Where is my hedge ratio when testing for
	cointegration with Phillips-Ouliaris test?
In-Reply-To: <CAEaVHoL7pu5Zu-asd+zKMgSDM5E3eDzzb44fem0oxGFQw1b5jA@mail.gmail.com>
References: <CAEaVHoL7pu5Zu-asd+zKMgSDM5E3eDzzb44fem0oxGFQw1b5jA@mail.gmail.com>
Message-ID: <008901cccf1f$0ae09d10$20a1d730$@washington.edu>

For the hedge ratio, you need an estimate of the cointegrating vector
between the two series. When you use the PO cointegration test, the
cointegrating vector is estimated by ordinary least squares. However, except
in special cases the OLS estimate of the cointegrating vector has a finite
sample bias due to the dynamics in the data. It is preferred to use an
estimate of the cointegrating vector that is not subject to strong biases in
finite samples, such as the Stock-Watson dynamic OLS lead-lag estimator or
the Johansen MLE based on the VECM. The Johansen MLE has the advantage that
it is invariant to the normalization of the cointegrating vector (a subject
that Paul Teetor has discussed with his PCA estimator). OlS is not invariant
to normalization. You get different estimates of you regress y1 on y2 versus
if you regress y2 on y1. For Johansen, it doesn't matter.


Eric Zivot                  			               
Robert Richards Chaired Professor of Economics and Director of Outreach
Adjunct Professor of Finance                            
Adjunct Professor of Statistics
Adjunct Professor of Applied Mathematics 
Department of Economics
Box 353330                  email:  ezivot at u.washington.edu 
University of Washington    phone:  206-543-6715            
Seattle, WA 98195-3330
www:  http://faculty.washington.edu/ezivot                  



-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Mark Breman
Sent: Friday, January 06, 2012 12:09 PM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] Where is my hedge ratio when testing for
cointegration with Phillips-Ouliaris test?

Hello List,

I'm testing multivariate timeseries for cointegration using the
Phillips-Ouliaris test from package urca (ca.po) i.e:

############################################# start example
################################
> library(quantmod)
> library(urca)
>
> getSymbols(c('GLD', 'GDX'), from="2006-01-01")
[1] "GLD" "GDX"
>
> prices=na.omit(cbind(Ad(GLD), Ad(GDX)))
>
> summary(ca.po(coredata(prices), type='Pz'))

########################################
# Phillips and Ouliaris Unit Root Test #
########################################

Test of type Pz
detrending of series none

Response GLD.Adjusted :

Call:
lm(formula = GLD.Adjusted ~ zr - 1)

Residuals:
    Min      1Q  Median      3Q     Max
-9.3422 -0.6212  0.0540  0.7783  8.6275

Coefficients:
                Estimate Std. Error t value Pr(>|t|)
zrGLD.Adjusted 1.0004786  0.0020531 487.295   <2e-16 ***
zrGDX.Adjusted 0.0001917  0.0047246   0.041    0.968
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1

Residual standard error: 1.44 on 1414 degrees of freedom Multiple R-squared:
0.9998, Adjusted R-squared: 0.9998
F-statistic: 3.78e+06 on 2 and 1414 DF,  p-value: < 2.2e-16


Response GDX.Adjusted :

Call:
lm(formula = GDX.Adjusted ~ zr - 1)

Residuals:
    Min      1Q  Median      3Q     Max
-5.0164 -0.6497  0.0160  0.7325  4.7142

Coefficients:
               Estimate Std. Error t value Pr(>|t|)
zrGLD.Adjusted 0.001727   0.001608   1.074    0.283
zrGDX.Adjusted 0.996047   0.003701 269.116   <2e-16 ***
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1

Residual standard error: 1.128 on 1414 degrees of freedom Multiple
R-squared: 0.9994, Adjusted R-squared: 0.9994
F-statistic: 1.162e+06 on 2 and 1414 DF,  p-value: < 2.2e-16



Value of test-statistic is: 11.1864

Critical values of Pz are:
                  10pct    5pct    1pct
critical values 33.9267 40.8217 55.1911

########################## end example ################################

Now my question is where is my hedge ratio? The estimates (coefficients)
don't look at all usable.
Do i have to do a manual OLS regression to get the hedge ratio or is it
hidden somewhere in the ca.po test results?

Thanks,

-Mark-

	[[alternative HTML version deleted]]


From ezivot at u.washington.edu  Tue Jan 10 00:00:52 2012
From: ezivot at u.washington.edu (Eric Zivot)
Date: Mon, 9 Jan 2012 15:00:52 -0800
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <1325778260.44939.YahooMailNeo@web132203.mail.ird.yahoo.com>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
	<1325778260.44939.YahooMailNeo@web132203.mail.ird.yahoo.com>
Message-ID: <00a901cccf22$89396720$9bac3560$@washington.edu>

It seems like this can be easily solved using rollApply or period.apply and
lm with exponentially declining weights (in the w option). BTW, regression
on exponentially weighted data is often called "discounted least squares"
and is what I would call a "poor man's" kalman filter. In fact there have
been a few papers in the engineering literature which shows that discounted
least squares is equivalent to a certain type of filtered estimated from a
state space regression model with time varying parameters. I've used
discounted least squares for modeling hedge fund data and found it to work
quite nicely. Also, the time varying parameter state-space model may work
well with a few explanatory variables (1 or 2) but it often does not perform
well if there are many (say 5+ predictors). For each regression parameter,
you have to estimate an AR(1) smoothing parameter plus a transition equation
error term. With many predictors, you run into numerical stability problems
very quickly and the likelihood function can have many local minima. For
this reason, discounted least squares is an attractive alternative. Finally,
it is very difficult to do model selection with the state space kalman
filter. How do you choose the variables to enter the regression equation? I
have not seen anyone do a systematic study of model selection in time
varying parameter models. Perhaps, this is where a Bayesian approach might
be useful. This is an important but neglected topic. I would be happy is
someone pointed me to some research on this topic.


Eric Zivot                  			               
Robert Richards Chaired Professor of Economics and Director of Outreach
Adjunct Professor of Finance                            
Adjunct Professor of Statistics
Adjunct Professor of Applied Mathematics 
Department of Economics
Box 353330                  email:  ezivot at u.washington.edu 
University of Washington    phone:  206-543-6715            
Seattle, WA 98195-3330
www:  http://faculty.washington.edu/ezivot                  




-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of riccardo visca
Sent: Thursday, January 05, 2012 7:44 AM
To: Zachary Mayer; Michael
Cc: r-sig-finance
Subject: Re: [R-SIG-Finance] exponentially weighted linear regression

I think you should use a time varying parameter model (look at dlm package)
or if you do not have time to learn try to smooth the predictors first then
run the rolling window regression maybe robustified.

If you use the Kalman filter use an AR(1) for the parameter in the state
equation like

yt = bt * Xt-1
bt = c * bt-1

c will do the smoothing (it is your (1-lambda))

>From my point of view there is no cheap and dirty solution to this problem.




________________________________
 Da: Zachary Mayer <zach.mayer at gmail.com>
A: Michael <comtech.usa at gmail.com>
Cc: r-sig-finance <r-sig-finance at stat.math.ethz.ch>
Inviato: Giovedl 5 Gennaio 2012 15:22
Oggetto: Re: [R-SIG-Finance] exponentially weighted linear regression

I'm not following you.  What do you mean by "a divided trunk of data?"  As
far as I know, lm and glm will take as much data as you give them, until you
run out of memory.  Why not run the lm on the whole time series?

Perhaps you could post a reproducible example, so we can see what you're
trying to do.

On Thu, Jan 5, 2012 at 10:16 AM, Michael <comtech.usa at gmail.com> wrote:

>
> Thanks Zach.
>
> The problem with these functions (e.g. lm or glm with weights 
> argument) is that they still do it on a divided trunk of data... i.e. 
> block by block, not the whole time series...
>
> If we think about the exponential moving average estimate of 
> volatility with a decay factor lamda, it is actually on the whole time 
> series... not divided trunk of data.
> Any thoughts?
>
> On Thu, Jan 5, 2012 at 8:40 AM, Zachary Mayer <zach.mayer at gmail.com>wrote:
>
>> Hi Michael,
>>
>> R has lots of functions for exponential smoothing.  
>> ets<http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=forecast:forecast.e
>> ts> in the forecast 
>> package<http://cran.r-project.org/web/packages/forecast/index.html> 
>> is particularly useful.  Additionally, many models in R (including lm and
glm) have a weights argument.  You can come up with any weighting scheme you
wish, and pass it to your model as a weights argument.
>>
>> There may be more useful references on the CRAN time-series task 
>> view<http://cran.r-project.org/web/views/TimeSeries.html>
>> .
>>
>> Regards,
>>
>> Zach
>>
>>  On Thu, Jan 5, 2012 at 9:30 AM, Michael <comtech.usa at gmail.com> wrote:
>>
[[elided Yahoo spam]]
>>>
>>> Is there a function for exponentially weighted linear regression in R?
>>>
>>> Usually, a linear regression is on a trunk of data...
>>>
>>> And if I run linear regression on time series, I divide the time 
>>> series into "overlapped/rolling" windows and run linear regression 
>>> on each rolling chunk of data...
>>>
>>> Is there a way to turn the rolling linear regression on the whole 
>>> time series into an exponentially weighted one, i.e. using a decay 
>>> factor lambda to give more weights to the newer observations...?
>>>
>>> Are there packages in R which can do that?
>>>
>>> Thanks a lot!
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list 
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R 
>>> questions should go.
>>>
>>
>>
>

    [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.
	[[alternative HTML version deleted]]


From Scott.Lyden at instinet.com  Tue Jan 10 22:56:27 2012
From: Scott.Lyden at instinet.com (Scott.Lyden at instinet.com)
Date: Tue, 10 Jan 2012 16:56:27 -0500
Subject: [R-SIG-Finance] RBloomberg: Error in process.result(result,
	"first.column")
Message-ID: <OFC88A5AD5.37F654BA-ON85257981.0074DB23-85257981.00788E88@americas.corp.local>


Hi, folks.

First,  I'd like to take this opportunity to thank the many people on this
list who have contributed so much to R.

I've been using RBloomberg happily for a few weeks now. Today, with no
change in my environment that I'm aware of, I've encountered a strange
error.

The following self-contained example reproduces the error at will in my
environment ...

library(RBloomberg)
conn<-blpConnect()
d81<-"2011-11-01"
sTime<-"00:00:00.000"
eTime<-"23:59:00.000"
barLen<-"60"
# works ...
bar(conn, "TD CN Equity", "BID", paste(d81,sTime), paste(d81,eTime),
barLen)
# change date ...
d81<-"2011-06-01"
# Error in process.result(result, "first.column") : subscript out of
bounds ...
bar(conn, "TD CN Equity", "BID", paste(d81,sTime), paste(d81,eTime),
barLen)


> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United
States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] RBloomberg_0.4-150 rJava_0.9-2

loaded via a namespace (and not attached):
[1] tools_2.13.1


Any help would be greatly appreciated.

Thanks,

Scott





----------------------------------------------------------------
Scott Lyden
Global Trading Research
Instinet
San Francisco, CA USA
*****************************************************************
<<<Disclaimer>>>

In compliance with applicable rules and regulations, Instinet
reviews and archives incoming and outgoing email communications,
copies of which may be produced at the request of regulators.
This message is intended only for the personal and confidential
use of the recipients named above.  If the reader of this email
is not the intended recipient, you have received this email in
error and any review, dissemination, distribution or copying is
strictly prohibited. If you have received this email in error,
please notify the sender immediately by return email and
permanently delete the copy you received.  

Instinet accepts no liability for any content contained in the
email, or any errors or omissions arising as a result of email
transmission. Any opinions contained in this email constitute
the sender's best judgment at this time and are subject to change
without notice.   Instinet does not make recommendations of a
particular security and the information contained in this email
should not be considered as a recommendation, an offer or a
solicitation of an offer to buy and sell securities.

*****************************************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120110/4cf1b3ec/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 13579080.gif
Type: image/gif
Size: 2661 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120110/4cf1b3ec/attachment.gif>

From ktdservices01 at gmail.com  Wed Jan 11 05:30:33 2012
From: ktdservices01 at gmail.com (KTD Services)
Date: Tue, 10 Jan 2012 22:30:33 -0600
Subject: [R-SIG-Finance] data manipulation to for quantmod function
Message-ID: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120110/960940d0/attachment.pl>

From j_cuisinier at hotmail.com  Wed Jan 11 10:22:20 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Wed, 11 Jan 2012 10:22:20 +0100
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
Message-ID: <COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/44c55c38/attachment.pl>

From yuanhangw.sg at gmail.com  Wed Jan 11 15:48:59 2012
From: yuanhangw.sg at gmail.com (Yuanhang Wang)
Date: Wed, 11 Jan 2012 22:48:59 +0800
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
Message-ID: <CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/d3f8791e/attachment.pl>

From michael.weylandt at gmail.com  Wed Jan 11 15:49:59 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt <michael.weylandt@gmail.com>)
Date: Wed, 11 Jan 2012 09:49:59 -0500
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
Message-ID: <7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>

If you have tick/high(-ish) frequency data, you'll have to transform it to OHLC; there's no way to keep the frequency you have and to make an OHLC object out of it, since those metrics are by definition aggregates. The easiest way to do so is to read it in as an xts object then use one of the to.period() functions. 

Michael

On Jan 11, 2012, at 4:22 AM, julien cuisinier <j_cuisinier at hotmail.com> wrote:

> 
> Hi,
> 
> 
> Always nice to have a name on those email. 
> 
> quantmod "format" is xts format, you might try as.xts but i guess you will need to give it all the needed columns to fit the XTS object
> 
> OR use quantmod getSymbols function to download the data straight into the right format if possible
> 
> 
> HTH,
> Julien
> 
> 
> 
>> From: ktdservices01 at gmail.com
>> To: r-sig-finance at r-project.org
>> Date: Tue, 10 Jan 2012 22:30:33 -0600
>> Subject: [R-SIG-Finance] data manipulation to for quantmod function
>> 
>> I need some help with data manipulation so I can use quantmod.
>> 
>> I have a data frame with three columns: time, price, volume.  This  
>> data frame is all the trades of a product for about 15 days.  What I  
>> want to do is modify the data so that it is in a format that quantmod  
>> can read.  Quantmod needs data to be in columns: Open, High, Low,  
>> Close, and Volume.
>> 
>> I wanted to see if anyone had some suggestions to easily modify the  
>> data into the quantmod format.
>> 
>> Quantmod: http://www.quantmod.com/
>> Data (.csv, 21.67KB) can be downloaded at http://www.mediafire.com/?fyunce685ekuyo3
>>    [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>                         
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From j_cuisinier at hotmail.com  Wed Jan 11 16:03:50 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Wed, 11 Jan 2012 16:03:50 +0100
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>,
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>,
	<CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>
Message-ID: <COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/893833dd/attachment.pl>

From brian at braverock.com  Wed Jan 11 16:10:57 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 11 Jan 2012 09:10:57 -0600
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	<7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>
Message-ID: <1326294657.16398.113.camel@brian-rcg>

On Wed, 2012-01-11 at 09:49 -0500, R. Michael Weylandt wrote:
> If you have tick/high(-ish) frequency data, you'll have to 
> transform it to OHLC; there's no way to keep the frequency 
> you have and to make an OHLC object out of it, since those 
> metrics are by definition aggregates. The easiest way to 
> do so is to read it in as an xts object then use one of the to.period() functions. 


Whoa.  Not (Completely) True.

getSymbols, xts, and quantmod are perfectly comfortable with tick data
of millions and even billions of rows.

chart_Series and chartSeries have built-in charting mechanisms for OHLC
data, and you may wish to transform higher freqency data to lower
frequency OHLC before charting, but this is by no means required.

Some indicator/TA methods also require OHLC data or equivalent, but many
will work fine on univariate series or on tick.

To the original poster's question, I usually use read.table or read.csv
and then as.xts to convert to an xts object.  How to do these steps has
been covered many times on this list, so please search the archives.

With the linked csv file in the original poster's messages,
see ?strftime and the list archives for information on formatting.

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

> On Jan 11, 2012, at 4:22 AM, julien cuisinier <j_cuisinier at hotmail.com> wrote:
> 
> > 
> > Hi,
> > 
> > 
> > Always nice to have a name on those email. 
> > 
> > quantmod "format" is xts format, you might try as.xts but i guess you will need to give it all the needed columns to fit the XTS object
> > 
> > OR use quantmod getSymbols function to download the data straight into the right format if possible
> > 
> > 
> > HTH,
> > Julien
> > 
> > 
> > 
> >> From: ktdservices01 at gmail.com
> >> To: r-sig-finance at r-project.org
> >> Date: Tue, 10 Jan 2012 22:30:33 -0600
> >> Subject: [R-SIG-Finance] data manipulation to for quantmod function
> >> 
> >> I need some help with data manipulation so I can use quantmod.
> >> 
> >> I have a data frame with three columns: time, price, volume.  This  
> >> data frame is all the trades of a product for about 15 days.  What I  
> >> want to do is modify the data so that it is in a format that quantmod  
> >> can read.  Quantmod needs data to be in columns: Open, High, Low,  
> >> Close, and Volume.
> >> 
> >> I wanted to see if anyone had some suggestions to easily modify the  
> >> data into the quantmod format.
> >> 
> >> Quantmod: http://www.quantmod.com/
> >> Data (.csv, 21.67KB) can be downloaded at http://www.mediafire.com/?fyunce685ekuyo3
> >>    [[alternative HTML version deleted]]


From michael.weylandt at gmail.com  Wed Jan 11 16:22:15 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt <michael.weylandt@gmail.com>)
Date: Wed, 11 Jan 2012 10:22:15 -0500
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <1326294657.16398.113.camel@brian-rcg>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	<7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>
	<1326294657.16398.113.camel@brian-rcg>
Message-ID: <4EA24529-47D8-4B55-852C-3F9026A0E86C@gmail.com>

Brian,

You are (of course) absolutely right about quantmod/quantstrat functionality - and you, Jeff, Josh, Dirk & anyone else I'm forgetting can't be thanked enough for your work. I was only directing the OP on how to get OHLC as he asked but he should be rightly informed that quantmod easily handles tick data. 

Michael

On Jan 11, 2012, at 10:10 AM, "Brian G. Peterson" <brian at braverock.com> wrote:

> On Wed, 2012-01-11 at 09:49 -0500, R. Michael Weylandt wrote:
>> If you have tick/high(-ish) frequency data, you'll have to 
>> transform it to OHLC; there's no way to keep the frequency 
>> you have and to make an OHLC object out of it, since those 
>> metrics are by definition aggregates. The easiest way to 
>> do so is to read it in as an xts object then use one of the to.period() functions. 
> 
> 
> Whoa.  Not (Completely) True.
> 
> getSymbols, xts, and quantmod are perfectly comfortable with tick data
> of millions and even billions of rows.
> 
> chart_Series and chartSeries have built-in charting mechanisms for OHLC
> data, and you may wish to transform higher freqency data to lower
> frequency OHLC before charting, but this is by no means required.
> 
> Some indicator/TA methods also require OHLC data or equivalent, but many
> will work fine on univariate series or on tick.
> 
> To the original poster's question, I usually use read.table or read.csv
> and then as.xts to convert to an xts object.  How to do these steps has
> been covered many times on this list, so please search the archives.
> 
> With the linked csv file in the original poster's messages,
> see ?strftime and the list archives for information on formatting.
> 
> Regards,
> 
>   - Brian
> 
> 
> -- 
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
> 
>> On Jan 11, 2012, at 4:22 AM, julien cuisinier <j_cuisinier at hotmail.com> wrote:
>> 
>>> 
>>> Hi,
>>> 
>>> 
>>> Always nice to have a name on those email. 
>>> 
>>> quantmod "format" is xts format, you might try as.xts but i guess you will need to give it all the needed columns to fit the XTS object
>>> 
>>> OR use quantmod getSymbols function to download the data straight into the right format if possible
>>> 
>>> 
>>> HTH,
>>> Julien
>>> 
>>> 
>>> 
>>>> From: ktdservices01 at gmail.com
>>>> To: r-sig-finance at r-project.org
>>>> Date: Tue, 10 Jan 2012 22:30:33 -0600
>>>> Subject: [R-SIG-Finance] data manipulation to for quantmod function
>>>> 
>>>> I need some help with data manipulation so I can use quantmod.
>>>> 
>>>> I have a data frame with three columns: time, price, volume.  This  
>>>> data frame is all the trades of a product for about 15 days.  What I  
>>>> want to do is modify the data so that it is in a format that quantmod  
>>>> can read.  Quantmod needs data to be in columns: Open, High, Low,  
>>>> Close, and Volume.
>>>> 
>>>> I wanted to see if anyone had some suggestions to easily modify the  
>>>> data into the quantmod format.
>>>> 
>>>> Quantmod: http://www.quantmod.com/
>>>> Data (.csv, 21.67KB) can be downloaded at http://www.mediafire.com/?fyunce685ekuyo3
>>>>   [[alternative HTML version deleted]]
> 
> 


From gsee000 at gmail.com  Wed Jan 11 16:27:33 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 11 Jan 2012 09:27:33 -0600
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	<CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>
	<COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>
Message-ID: <CA+xi=qZz0pD-jfPtvf=+z76g2gLKXacvhRpsFgPioKPMSwJ4RA@mail.gmail.com>

There is a getSymbols.Bloomberg method.  It's just commented out
because it is not platform independent.

Look here:
https://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/R/getSymbols.R?revision=572&root=quantmod

-Garrett


On Wed, Jan 11, 2012 at 9:03 AM, julien cuisinier
<j_cuisinier at hotmail.com> wrote:
>
> Hi,
>
>
> As you can see from latest quantmod package doc there is no such function, up to the developer to say if they intend to do one.
>
> RBloomberg will be your way to access BBG data from R... Then convert the data object is uses (I am not familiar with it) into an xts object quantmod (& the subsequent tools such as quantstrat) can read / use
>
> Thanks to update the list with your findings - especially if I am wrong
>
>
> Rgds,
> Julien
>
>
>
> From: yuanhangw.sg at gmail.com
> Date: Wed, 11 Jan 2012 22:48:59 +0800
> To: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] data manipulation to for quantmod function
>
> Hi,
>
> ? ?Not sure if this is the right way to seek assistance, but I'm looking
> for an implementation of getSymbols.bloomberg , could anyone direct me to
> the right place?
>
>
>
> Regards,
> Yuanhang
>
> On Wed, Jan 11, 2012 at 5:22 PM, julien cuisinier
> <j_cuisinier at hotmail.com>wrote:
>
>>
>> Hi,
>>
>>
>> Always nice to have a name on those email.
>>
>> quantmod "format" is xts format, you might try as.xts but i guess you will
>> need to give it all the needed columns to fit the XTS object
>>
>> OR use quantmod getSymbols function to download the data straight into the
>> right format if possible
>>
>>
>> HTH,
>> Julien
>>
>>
>>
>> > From: ktdservices01 at gmail.com
>> > To: r-sig-finance at r-project.org
>> > Date: Tue, 10 Jan 2012 22:30:33 -0600
>> > Subject: [R-SIG-Finance] data manipulation to for quantmod function
>> >
>> > I need some help with data manipulation so I can use quantmod.
>> >
>> > I have a data frame with three columns: time, price, volume. ?This
>> > data frame is all the trades of a product for about 15 days. ?What I
>> > want to do is modify the data so that it is in a format that quantmod
>> > can read. ?Quantmod needs data to be in columns: Open, High, Low,
>> > Close, and Volume.
>> >
>> > I wanted to see if anyone had some suggestions to easily modify the
>> > data into the quantmod format.
>> >
>> > Quantmod: http://www.quantmod.com/
>> > Data (.csv, 21.67KB) can be downloaded at
>> http://www.mediafire.com/?fyunce685ekuyo3
>> > ? ? ? [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
>
> --
> ?????
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From brian at braverock.com  Wed Jan 11 16:32:21 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 11 Jan 2012 09:32:21 -0600
Subject: [R-SIG-Finance] getSymbols.Bloomberg (was Re: data manipulation
 to for quantmod function)
In-Reply-To: <COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	, <COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	, <CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>
	<COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>
Message-ID: <1326295941.24988.5.camel@brian-rcg>

Yuanhang,

Next time, please start a new thread rather than just replying to
another post.

Julien is correct that there is no exposed function for
getSymbols.Bloomberg, and that the RBloomberg package is the right place
to go to get data out of the Bloomberg terminal.

There is, however, a (start?) of a getSymbols.Bloomberg function in
quantmod, the code is commented out, and (at best) not completely
tested, as Jeff (and I right now) don't have easy access to Bloomberg
terminals.

You can find the code here:

https://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/R/getSymbols.R?root=quantmod

see commented lines 93-187

We would of course welcome testing and patches from someone who has
access to both a Bloomberg terminal and RBloomberg.

Regards,

   - Brian


On Wed, 2012-01-11 at 16:03 +0100, julien cuisinier wrote:
> Hi,
> 
> 
> As you can see from latest quantmod package doc there is no such function, up to the developer to say if they intend to do one. 
> 
> RBloomberg will be your way to access BBG data from R... Then convert the data object is uses (I am not familiar with it) into an xts object quantmod (& the subsequent tools such as quantstrat) can read / use
> 
> Thanks to update the list with your findings - especially if I am wrong
> 
> 
> Rgds,
> Julien
> 
> 
> 
> From: yuanhangw.sg at gmail.com
> Date: Wed, 11 Jan 2012 22:48:59 +0800
> To: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] data manipulation to for quantmod function
> 
> Hi,
>  
>     Not sure if this is the right way to seek assistance, but I'm looking
> for an implementation of getSymbols.bloomberg , could anyone direct me to
> the right place?
>  
> 
> 
> Regards,
> Yuanhang
>  
> On Wed, Jan 11, 2012 at 5:22 PM, julien cuisinier
> <j_cuisinier at hotmail.com>wrote:
>  
> >
> > Hi,
> >
> >
> > Always nice to have a name on those email.
> >
> > quantmod "format" is xts format, you might try as.xts but i guess you will
> > need to give it all the needed columns to fit the XTS object
> >
> > OR use quantmod getSymbols function to download the data straight into the
> > right format if possible
> >
> >
> > HTH,
> > Julien
> >
> >
> >
> > > From: ktdservices01 at gmail.com
> > > To: r-sig-finance at r-project.org
> > > Date: Tue, 10 Jan 2012 22:30:33 -0600
> > > Subject: [R-SIG-Finance] data manipulation to for quantmod function
> > >
> > > I need some help with data manipulation so I can use quantmod.
> > >
> > > I have a data frame with three columns: time, price, volume.  This
> > > data frame is all the trades of a product for about 15 days.  What I
> > > want to do is modify the data so that it is in a format that quantmod
> > > can read.  Quantmod needs data to be in columns: Open, High, Low,
> > > Close, and Volume.
> > >
> > > I wanted to see if anyone had some suggestions to easily modify the
> > > data into the quantmod format.
> > >
> > > Quantmod: http://www.quantmod.com/
> > > Data (.csv, 21.67KB) can be downloaded at
> > http://www.mediafire.com/?fyunce685ekuyo3
> > >       [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-SIG-Finance at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> >        [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
>  
> 
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From comtech.usa at gmail.com  Wed Jan 11 18:08:38 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 11 Jan 2012 11:08:38 -0600
Subject: [R-SIG-Finance] exponentially weighted linear regression
In-Reply-To: <00a901cccf22$89396720$9bac3560$@washington.edu>
References: <CAPNjSFYnynimsoUzJA7A7QQ+i-wxfp==kvbj16AVFM9HSRnJ9g@mail.gmail.com>
	<CAEr64e91-x1P12aVE1NxayCs_Vp4eUiDiRX7pYXmadn=wFvSVA@mail.gmail.com>
	<CAPNjSFarJjRT+COQ5ooeza=OvehNMq4A3=irfhZ4TQ+BmWnfSA@mail.gmail.com>
	<CAEr64e_ibyaJoN=iCcmtDkA8Xe0WPdnimd35hnfZCT6XHMtxew@mail.gmail.com>
	<1325778260.44939.YahooMailNeo@web132203.mail.ird.yahoo.com>
	<00a901cccf22$89396720$9bac3560$@washington.edu>
Message-ID: <CAPNjSFYNAgYXxrHDP-1bvirr5T0Ff4f+rdo-oADhHiiqjfbO3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/b64d2dea/attachment.pl>

From comtech.usa at gmail.com  Wed Jan 11 18:11:12 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 11 Jan 2012 11:11:12 -0600
Subject: [R-SIG-Finance] dynamic window size in rolling linear regression?
Message-ID: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/15f0eb52/attachment.pl>

From patrick at burns-stat.com  Wed Jan 11 18:35:16 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Wed, 11 Jan 2012 17:35:16 +0000
Subject: [R-SIG-Finance] dynamic window size in rolling linear
	regression?
In-Reply-To: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>
References: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>
Message-ID: <4F0DC854.3020404@burns-stat.com>

Let's think about what you are asking for.

You want to change the window size in order
(I presume) to get better predictions.  So
it seems to me that you would need a variable
that has information about the pertinence of
past data to the future.

I could imagine volatility being such a variable
in some circumstances.  I don't know of any
work along those lines -- I'd be interested to
hear of any.

My usual practice is to have weights that descend
linearly.  In comparison to exponentially decaying
weights this puts more weight on the older data,
and hence is often a more stable estimate.  It has
the advantage over equal weighting that the window
size is of less importance.

On 11/01/2012 17:11, Michael wrote:
> Hi all,
>
> In application of linear regression to financial time series, we always
> have a parameter which is the window size.
>
> It's clear that a lot of results are sensitive to this parameter...
>
> Is there a way to make this parameter dynamic, or are there statistical
> procedures to select such parameter dynamically and/or "optimally"?
>
>  From a trading strategy perspective, is there a way to make this parameter
> dynamically chosen?
>
> Thanks a lot!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From riccardovisca at yahoo.it  Wed Jan 11 19:08:13 2012
From: riccardovisca at yahoo.it (riccardo visca)
Date: Wed, 11 Jan 2012 18:08:13 +0000 (GMT)
Subject: [R-SIG-Finance] dynamic window size in rolling linear
	regression?
In-Reply-To: <4F0DC854.3020404@burns-stat.com>
References: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>
	<4F0DC854.3020404@burns-stat.com>
Message-ID: <1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/7dabc3f2/attachment.pl>

From ezivot at u.washington.edu  Wed Jan 11 19:31:05 2012
From: ezivot at u.washington.edu (Eric Zivot)
Date: Wed, 11 Jan 2012 10:31:05 -0800
Subject: [R-SIG-Finance] dynamic window size in rolling
	linear	regression?
In-Reply-To: <1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>
References: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>	<4F0DC854.3020404@burns-stat.com>
	<1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>
Message-ID: <000601ccd08f$2dfc4530$89f4cf90$@washington.edu>

How to pick an optimal window depends, of course, on what optimal means.
Peseran and Timmermann have numerous articles related to this topic,
although they tend to focus on optimal forecasting in the presence of
structural change (just search on their names in SSRN and you will see a ton
of papers). Here is a recent paper:
http://www.econ.cam.ac.uk/faculty/pesaran/wp11/PPP-30-Oct-2011.pdf  Their
analysis clearly defines what "optimal" means and they derive optimal
weights for the data to satisfy their optimality criteria. 

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of riccardo visca
Sent: Wednesday, January 11, 2012 10:08 AM
To: Patrick Burns; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] dynamic window size in rolling linear
regression?

What about using an expanding window with exponential weights to make the
coefficients more adaptive? Throwing away data is not good.
Still you need to have weights that are inverse of conditional variance to
correct eteroschedasticity.

It could be a lot more efficient computationally than Kalman and one could
use robust or lasso, ridge, pls... 
Food for thoughts...




________________________________
 Da: Patrick Burns <patrick at burns-stat.com>
A: r-sig-finance at r-project.org
Inviato: Mercoledl 11 Gennaio 2012 17:35
Oggetto: Re: [R-SIG-Finance] dynamic window size in rolling linear
regression?

Let's think about what you are asking for.

You want to change the window size in order (I presume) to get better
predictions.  So it seems to me that you would need a variable that has
information about the pertinence of past data to the future.

I could imagine volatility being such a variable in some circumstances.  I
don't know of any work along those lines -- I'd be interested to hear of
any.

My usual practice is to have weights that descend linearly.  In comparison
to exponentially decaying weights this puts more weight on the older data,
and hence is often a more stable estimate.  It has the advantage over equal
weighting that the window size is of less importance.

On 11/01/2012 17:11, Michael wrote:
> Hi all,
>
> In application of linear regression to financial time series, we 
> always have a parameter which is the window size.
>
> It's clear that a lot of results are sensitive to this parameter...
>
> Is there a way to make this parameter dynamic, or are there 
> statistical procedures to select such parameter dynamically and/or
"optimally"?
>
>  From a trading strategy perspective, is there a way to make this 
> parameter dynamically chosen?
>
> Thanks a lot!
>
>     [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
should go.
>

--
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.
	[[alternative HTML version deleted]]


From David.Reiner at xrtrading.com  Wed Jan 11 23:00:59 2012
From: David.Reiner at xrtrading.com (David Reiner)
Date: Wed, 11 Jan 2012 16:00:59 -0600
Subject: [R-SIG-Finance] [SPAM] - RBloomberg: Error in
 process.result(result, "first.column") - Email found in subject
In-Reply-To: <OFC88A5AD5.37F654BA-ON85257981.0074DB23-85257981.00788E88@americas.corp.local>
References: <OFC88A5AD5.37F654BA-ON85257981.0074DB23-85257981.00788E88@americas.corp.local>
Message-ID: <9DE405308A6AA24AA794B76282C6C00F0DEAA9391A@HQ-POST1>

Bloomberg allows going only so far in the past for intraday data
(50 trading days, I thought, although your query works for any date after 2001-09-11.)
HTH,
-- David

From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Scott.Lyden at instinet.com
Sent: Tuesday, January 10, 2012 3:56 PM
To: r-sig-finance at r-project.org
Subject: [SPAM] - [R-SIG-Finance] RBloomberg: Error in process.result(result,"first.column") - Email found in subject


Hi, folks.

First, I'd like to take this opportunity to thank the many people on this list who have contributed so much to R.

I've been using RBloomberg happily for a few weeks now. Today, with no change in my environment that I'm aware of, I've encountered a strange error.

The following self-contained example reproduces the error at will in my environment ...

library(RBloomberg)
conn<-blpConnect()
d81<-"2011-11-01"
sTime<-"00:00:00.000"
eTime<-"23:59:00.000"
barLen<-"60"
# works ...
bar(conn, "TD CN Equity", "BID", paste(d81,sTime), paste(d81,eTime), barLen)
# change date ...
d81<-"2011-06-01"
# Error in process.result(result, "first.column") : subscript out of bounds ...
bar(conn, "TD CN Equity", "BID", paste(d81,sTime), paste(d81,eTime), barLen)


> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252 LC_CTYPE=English_United States.1252 LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C LC_TIME=English_United States.1252

attached base packages:
[1] stats graphics grDevices utils datasets methods base

other attached packages:
[1] RBloomberg_0.4-150 rJava_0.9-2

loaded via a namespace (and not attached):
[1] tools_2.13.1


Any help would be greatly appreciated.

Thanks,

Scott


----------------------------------------------------------------
Scott Lyden
Global Trading Research
Instinet
San Francisco, CA USA
[cid:image001.gif at 01CCD078.F3138F20]

*****************************************************************

<<<Disclaimer>>>



In compliance with applicable rules and regulations, Instinet

reviews and archives incoming and outgoing email communications,

copies of which may be produced at the request of regulators.

This message is intended only for the personal and confidential

use of the recipients named above. If the reader of this email

is not the intended recipient, you have received this email in

error and any review, dissemination, distribution or copying is

strictly prohibited. If you have received this email in error,

please notify the sender immediately by return email and

permanently delete the copy you received.



Instinet accepts no liability for any content contained in the

email, or any errors or omissions arising as a result of email

transmission. Any opinions contained in this email constitute

the sender's best judgment at this time and are subject to change

without notice. Instinet does not make recommendations of a

particular security and the information contained in this email

should not be considered as a recommendation, an offer or a

solicitation of an offer to buy and sell securities.



*****************************************************************




This e-mail and any materials attached hereto, including, without limitation, all content hereof and thereof (collectively, "XR Content") are confidential and proprietary to XR Trading LLC ("XR") and/or its affiliates, and are protected by intellectual property laws.  Without the prior written consent of XR, the XR Content may not (i) be disclosed to any third party or (ii) be reproduced or otherwise used by anyone other than current employees of XR or its affiliates, on behalf of XR or its affiliates.

THE XR CONTENT IS PROVIDED AS IS, WITHOUT REPRESENTATIONS OR WARRANTIES OF ANY KIND.  TO THE MAXIMUM EXTENT PERMISSIBLE UNDER APPLICABLE LAW, XR HEREBY DISCLAIMS ANY AND ALL WARRANTIES, EXPRESS AND IMPLIED, RELATING TO THE XR CONTENT, AND NEITHER XR NOR ANY OF ITS AFFILIATES SHALL IN ANY EVENT BE LIABLE FOR ANY DAMAGES OF ANY NATURE WHATSOEVER, INCLUDING, BUT NOT LIMITED TO, DIRECT, INDIRECT, CONSEQUENTIAL, SPECIAL AND PUNITIVE DAMAGES, LOSS OF PROFITS AND TRADING LOSSES, RESULTING FROM ANY PERSON'S USE OR RELIANCE UPON, OR INABILITY TO USE, ANY XR CONTENT, EVEN IF XR IS ADVISED OF THE POSSIBILITY OF SUCH DAMAGES OR IF SUCH DAMAGES WERE FORESEEABLE.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/b4b833b2/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.gif
Type: image/gif
Size: 2661 bytes
Desc: image001.gif
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120111/b4b833b2/attachment.gif>

From patrick at burns-stat.com  Thu Jan 12 10:09:04 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 12 Jan 2012 09:09:04 +0000
Subject: [R-SIG-Finance] dynamic window size in rolling linear
	regression?
In-Reply-To: <1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>
References: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>
	<4F0DC854.3020404@burns-stat.com>
	<1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>
Message-ID: <4F0EA330.5000807@burns-stat.com>

Throwing away data *is* good if the
process changes and that data is not
applicable to the future.

Exponential weights throw away lots of
data -- though they leave a very small
amount of weight (at least) for all
datapoints.

Pat

On 11/01/2012 18:08, riccardo visca wrote:
> What about using an expanding window with exponential weights to make
> the coefficients more adaptive? Throwing away data is not good.
> Still you need to have weights that are inverse of conditional variance
> to correct eteroschedasticity.
>
> It could be a lot more efficient computationally than Kalman and one
> could use robust or lasso, ridge, pls...
> Food for thoughts...
>
>
> ------------------------------------------------------------------------
> *Da:* Patrick Burns <patrick at burns-stat.com>
> *A:* r-sig-finance at r-project.org
> *Inviato:* Mercoled? 11 Gennaio 2012 17:35
> *Oggetto:* Re: [R-SIG-Finance] dynamic window size in rolling linear
> regression?
>
> Let's think about what you are asking for.
>
> You want to change the window size in order
> (I presume) to get better predictions. So
> it seems to me that you would need a variable
> that has information about the pertinence of
> past data to the future.
>
> I could imagine volatility being such a variable
> in some circumstances. I don't know of any
> work along those lines -- I'd be interested to
> hear of any.
>
> My usual practice is to have weights that descend
> linearly. In comparison to exponentially decaying
> weights this puts more weight on the older data,
> and hence is often a more stable estimate. It has
> the advantage over equal weighting that the window
> size is of less importance.
>
> On 11/01/2012 17:11, Michael wrote:
>  > Hi all,
>  >
>  > In application of linear regression to financial time series, we always
>  > have a parameter which is the window size.
>  >
>  > It's clear that a lot of results are sensitive to this parameter...
>  >
>  > Is there a way to make this parameter dynamic, or are there statistical
>  > procedures to select such parameter dynamically and/or "optimally"?
>  >
>  > From a trading strategy perspective, is there a way to make this
> parameter
>  > dynamically chosen?
>  >
>  > Thanks a lot!
>  >
>  > [[alternative HTML version deleted]]
>  >
>  > _______________________________________________
>  > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
> mailing list
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > -- Subscriber-posting only. If you want to post, subscribe first.
>  > -- Also note that this is not the r-help list where general R
> questions should go.
>  >
>
> --
> Patrick Burns
> patrick at burns-stat.com <mailto:patrick at burns-stat.com>
> http://www.burns-stat.com
> http://www.portfolioprobe.com/blog
> twitter: @portfolioprobe
>
> _______________________________________________
> R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org> mailing
> list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From riccardovisca at yahoo.it  Thu Jan 12 11:05:21 2012
From: riccardovisca at yahoo.it (riccardo visca)
Date: Thu, 12 Jan 2012 10:05:21 +0000 (GMT)
Subject: [R-SIG-Finance] dynamic window size in rolling linear
	regression?
In-Reply-To: <4F0EA330.5000807@burns-stat.com>
References: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>
	<4F0DC854.3020404@burns-stat.com>
	<1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>
	<4F0EA330.5000807@burns-stat.com>
Message-ID: <1326362721.83434.YahooMailNeo@web132204.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120112/5e4889cb/attachment.pl>

From patrick at burns-stat.com  Thu Jan 12 11:32:19 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 12 Jan 2012 10:32:19 +0000
Subject: [R-SIG-Finance] dynamic window size in rolling linear
	regression?
In-Reply-To: <1326362721.83434.YahooMailNeo@web132204.mail.ird.yahoo.com>
References: <CAPNjSFZffsuYiLa-1pOpZgngMrV3j8-G2Hx50m+R5DzOQhZRhA@mail.gmail.com>
	<4F0DC854.3020404@burns-stat.com>
	<1326305293.83852.YahooMailNeo@web132202.mail.ird.yahoo.com>
	<4F0EA330.5000807@burns-stat.com>
	<1326362721.83434.YahooMailNeo@web132204.mail.ird.yahoo.com>
Message-ID: <4F0EB6B3.6040309@burns-stat.com>

On 12/01/2012 10:05, riccardo visca wrote:

[...]

> So I think you are right and wrong ...

I absolutely agree.  Though we may
still have a discussion on which is which.

Pat

>
>
>
> ------------------------------------------------------------------------
> *Da:* Patrick Burns <patrick at burns-stat.com>
> *A:* riccardo visca <riccardovisca at yahoo.it>
> *Cc:* "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> *Inviato:* Gioved? 12 Gennaio 2012 9:09
> *Oggetto:* Re: [R-SIG-Finance] dynamic window size in rolling linear
> regression?
>
> Throwing away data *is* good if the
> process changes and that data is not
> applicable to the future.
>
> Exponential weights throw away lots of
> data -- though they leave a very small
> amount of weight (at least) for all
> datapoints.
>
> Pat
>
> On 11/01/2012 18:08, riccardo visca wrote:
>  > What about using an expanding window with exponential weights to make
>  > the coefficients more adaptive? Throwing away data is not good.
>  > Still you need to have weights that are inverse of conditional variance
>  > to correct eteroschedasticity.
>  >
>  > It could be a lot more efficient computationally than Kalman and one
>  > could use robust or lasso, ridge, pls...
>  > Food for thoughts...
>  >
>  >
>  > ------------------------------------------------------------------------
>  > *Da:* Patrick Burns <patrick at burns-stat.com
> <mailto:patrick at burns-stat.com>>
>  > *A:* r-sig-finance at r-project.org <mailto:r-sig-finance at r-project.org>
>  > *Inviato:* Mercoled? 11 Gennaio 2012 17:35
>  > *Oggetto:* Re: [R-SIG-Finance] dynamic window size in rolling linear
>  > regression?
>  >
>  > Let's think about what you are asking for.
>  >
>  > You want to change the window size in order
>  > (I presume) to get better predictions. So
>  > it seems to me that you would need a variable
>  > that has information about the pertinence of
>  > past data to the future.
>  >
>  > I could imagine volatility being such a variable
>  > in some circumstances. I don't know of any
>  > work along those lines -- I'd be interested to
>  > hear of any.
>  >
>  > My usual practice is to have weights that descend
>  > linearly. In comparison to exponentially decaying
>  > weights this puts more weight on the older data,
>  > and hence is often a more stable estimate. It has
>  > the advantage over equal weighting that the window
>  > size is of less importance.
>  >
>  > On 11/01/2012 17:11, Michael wrote:
>  > > Hi all,
>  > >
>  > > In application of linear regression to financial time series, we always
>  > > have a parameter which is the window size.
>  > >
>  > > It's clear that a lot of results are sensitive to this parameter...
>  > >
>  > > Is there a way to make this parameter dynamic, or are there statistical
>  > > procedures to select such parameter dynamically and/or "optimally"?
>  > >
>  > > From a trading strategy perspective, is there a way to make this
>  > parameter
>  > > dynamically chosen?
>  > >
>  > > Thanks a lot!
>  > >
>  > > [[alternative HTML version deleted]]
>  > >
>  > > _______________________________________________
>  > > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
> <mailto:R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>>
>  > mailing list
>  > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > > -- Subscriber-posting only. If you want to post, subscribe first.
>  > > -- Also note that this is not the r-help list where general R
>  > questions should go.
>  > >
>  >
>  > --
>  > Patrick Burns
>  > patrick at burns-stat.com <mailto:patrick at burns-stat.com>
> <mailto:patrick at burns-stat.com <mailto:patrick at burns-stat.com>>
>  > http://www.burns-stat.com
>  > http://www.portfolioprobe.com/blog
>  > twitter: @portfolioprobe
>  >
>  > _______________________________________________
>  > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
> <mailto:R-SIG-Finance at r-project.org
> <mailto:R-SIG-Finance at r-project.org>> mailing
>  > list
>  > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > -- Subscriber-posting only. If you want to post, subscribe first.
>  > -- Also note that this is not the r-help list where general R questions
>  > should go.
>  >
>  >
>
> --
> Patrick Burns
> patrick at burns-stat.com <mailto:patrick at burns-stat.com>
> http://www.burns-stat.com
> http://www.portfolioprobe.com/blog
> twitter: @portfolioprobe
>
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From comtech.usa at gmail.com  Thu Jan 12 15:38:19 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 12 Jan 2012 08:38:19 -0600
Subject: [R-SIG-Finance] how do I make a movie out of a timeseries of 2D
	data?
Message-ID: <CAPNjSFZNpz-KEupmBweSW3ftxOyTnQ-HXK_+OKEO_Aq6m-9CrQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120112/8498b675/attachment.pl>

From gsee000 at gmail.com  Thu Jan 12 15:41:07 2012
From: gsee000 at gmail.com (G See)
Date: Thu, 12 Jan 2012 08:41:07 -0600
Subject: [R-SIG-Finance] how do I make a movie out of a timeseries of 2D
	data?
In-Reply-To: <CAPNjSFZNpz-KEupmBweSW3ftxOyTnQ-HXK_+OKEO_Aq6m-9CrQ@mail.gmail.com>
References: <CAPNjSFZNpz-KEupmBweSW3ftxOyTnQ-HXK_+OKEO_Aq6m-9CrQ@mail.gmail.com>
Message-ID: <CA+xi=qbW7-Y=sC-_x9JPRA7acwKi3KLD-ezMHQd746P6t5eYCQ@mail.gmail.com>

Michael,

Please don't cross post to both lists.  If it doesn't have to do with
finance, don't send it it r-sig-finance.

Thanks,
Garrett

On Thu, Jan 12, 2012 at 8:38 AM, Michael <comtech.usa at gmail.com> wrote:
> Hi all,
>
> I have an array of 10000 x 200 x 200 numbers... which is a time-series of
> 200x200 2D data...
>
> The 1st dimension is the time index.
>
> Is there a way to make a movie out of these data - i.e. playback 10000
> frames(200x200) at a playback rate per second?
>
> Thanks a lot!
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From public at gabrielevivinetto.it  Thu Jan 12 19:46:28 2012
From: public at gabrielevivinetto.it (Gabriele Vivinetto [Public address])
Date: Thu, 12 Jan 2012 19:46:28 +0100
Subject: [R-SIG-Finance] Dealing with large dataset in quantmod
Message-ID: <4F0F2A84.1080603@gabrielevivinetto.it>

Hello to the mailing list.
I'm a newbie in R, and this is my first post.
I've evaluated quantmod using EOD data from yahoo, and everything went fine.
I have a mysql database containing tick by tick data (in a format
suitable for quantmod getSymbols.MySQL) and I have tried to use these data.
Using a table with a small subset of the data (1000 rows) there is no
problem.
But if I try to use a table with all the record (~6 millions rows), R is
very slow and memory hungry (simply speaking it crashes all the times
after loading the data...).
As a workaround I've modified the getSymbols.MySQL R function to accept
from= and to= parameters, so the sql SELECT gives to R a desired subset
of data, but using more than 100k records is a pain.
Someone has a workaround or suggestions for using large datasets with
quantmod ?

Thank you !
-- 
Gabriele Vivinetto
http://www.gabrielevivinetto.it


From brian at braverock.com  Thu Jan 12 20:14:00 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 12 Jan 2012 13:14:00 -0600
Subject: [R-SIG-Finance] Dealing with large dataset in quantmod
In-Reply-To: <4F0F2A84.1080603@gabrielevivinetto.it>
References: <4F0F2A84.1080603@gabrielevivinetto.it>
Message-ID: <1326395640.24988.25.camel@brian-rcg>

On Thu, 2012-01-12 at 19:46 +0100, Gabriele Vivinetto [Public address]
wrote:
> Hello to the mailing list.
> I'm a newbie in R, and this is my first post.
> I've evaluated quantmod using EOD data from yahoo, and everything went fine.
> I have a mysql database containing tick by tick data (in a format
> suitable for quantmod getSymbols.MySQL) and I have tried to use these data.
> Using a table with a small subset of the data (1000 rows) there is no
> problem.
> But if I try to use a table with all the record (~6 millions rows), R is
> very slow and memory hungry (simply speaking it crashes all the times
> after loading the data...).
> As a workaround I've modified the getSymbols.MySQL R function to accept
> from= and to= parameters, so the sql SELECT gives to R a desired subset
> of data, but using more than 100k records is a pain.
> Someone has a workaround or suggestions for using large datasets with
> quantmod ?
> 
> Thank you !

I routinely use xts on tick data series with tens or hundreds of
millions of rows.  I also have a lot of RAM (16-48GB) per machine. 

Some things that will affect how much ram the xts object uses are the
number of columns in your data, and whether you are using a numeric or
character xts object.  

We just ran a little test here and 17.5M rows on one column take about a
third of a GB of RAM.

In a 32 bit environment, R is limited to 3GB of RAM, so this may be part
of your problem.

Last, you don't say what functions you are calling which respond slowly.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From pgilbert902 at gmail.com  Thu Jan 12 20:34:14 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Thu, 12 Jan 2012 14:34:14 -0500
Subject: [R-SIG-Finance] Dealing with large dataset in quantmod
In-Reply-To: <4F0F2A84.1080603@gabrielevivinetto.it>
References: <4F0F2A84.1080603@gabrielevivinetto.it>
Message-ID: <4F0F35B6.7010801@gmail.com>



On 12-01-12 01:46 PM, Gabriele Vivinetto [Public address] wrote:
> Hello to the mailing list.
> I'm a newbie in R, and this is my first post.
> I've evaluated quantmod using EOD data from yahoo, and everything went fine.
> I have a mysql database containing tick by tick data (in a format
> suitable for quantmod getSymbols.MySQL) and I have tried to use these data.
> Using a table with a small subset of the data (1000 rows) there is no
> problem.
> But if I try to use a table with all the record (~6 millions rows), R is
> very slow and memory hungry (simply speaking it crashes all the times
> after loading the data...).

You need to first determine if this is the Mysql connection, or your 
memory/OS/and R version. If you are not running a 64 bit version of R 
you may be simply hitting the limit of 32 bit machines. If you are not 
running on a machine with a lot of physical memory then you will be 
using swap, which will be slow. (These limits might also bite on the 
server side.) You should probably monitor with something like top to 
have a better idea what is going wrong. If it really is the mysql 
connection that is the problem then you may need to look at the size of 
the chunks returned in the request.

Regards,
Paul

> As a workaround I've modified the getSymbols.MySQL R function to accept
> from= and to= parameters, so the sql SELECT gives to R a desired subset
> of data, but using more than 100k records is a pain.
> Someone has a workaround or suggestions for using large datasets with
> quantmod ?
>
> Thank you !


From gmonaie at gmail.com  Fri Jan 13 02:56:54 2012
From: gmonaie at gmail.com (G Lin)
Date: Thu, 12 Jan 2012 20:56:54 -0500
Subject: [R-SIG-Finance] getSymbols.Bloomberg (was Re: data manipulation
 to for quantmod function)
In-Reply-To: <1326295941.24988.5.camel@brian-rcg>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	<CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>
	<COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>
	<1326295941.24988.5.camel@brian-rcg>
Message-ID: <CAJFvkcdmxA_euz-askpFbOroGaC+7-cj4a1rtc5mzH2KYm46mQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120112/5c0adfc0/attachment.pl>

From comtech.usa at gmail.com  Fri Jan 13 17:27:34 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 13 Jan 2012 10:27:34 -0600
Subject: [R-SIG-Finance] in xts plot,
	how do I remove the hour and min info in the x axis labels?
Message-ID: <CAPNjSFa3RU15Of+C0dPMSY+6c+JVgtK-71ch3yBVN+38hbzVhg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120113/8ad0175f/attachment.pl>

From brian at braverock.com  Fri Jan 13 17:47:45 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 13 Jan 2012 10:47:45 -0600
Subject: [R-SIG-Finance] in xts plot,
 how do I remove the hour and min info in the x axis labels?
In-Reply-To: <CAPNjSFa3RU15Of+C0dPMSY+6c+JVgtK-71ch3yBVN+38hbzVhg@mail.gmail.com>
References: <CAPNjSFa3RU15Of+C0dPMSY+6c+JVgtK-71ch3yBVN+38hbzVhg@mail.gmail.com>
Message-ID: <1326473265.24988.35.camel@brian-rcg>

There is no 'xts plot'

You need to be very specific, following the posting guide, about what
you tried, what you expected, and what happened.

Generally speaking, 'format' is a parameter you can set by formatting
the index of your data.  see ?strftime

But without knowing what plot function you called, and how you called
it, no one can answer your squestion in anything other than
generalities.  So please provide a reproducible example next time, or
you are simply wasting everyone's time.

 - Brian

On Fri, 2012-01-13 at 10:27 -0600, Michael wrote:
> Hi all,
> 
> Although my time series is in 5 min bins...  I would like to show only the
> YYMMDD on the x axis as labels...
> 
> Currently it shows like the following:
> 
> "Jan 02 06:15"  "Jul 02 06:15" "Jan 02 06:15" "Jul01 06:15" ...
> 
> which doesn't show "year" and the "06:15" is really redundant...
> 
> How to make the lables better?
> 
> Thanks a lot!


From nidhi at igidr.ac.in  Fri Jan 13 18:32:12 2012
From: nidhi at igidr.ac.in (Nidhi Aggrawal)
Date: Fri, 13 Jan 2012 09:32:12 -0800 (PST)
Subject: [R-SIG-Finance] Calculating Hasbrouck's information share and
 Gonzalo-Granger weights on R
In-Reply-To: <1326111160519-4278272.post@n4.nabble.com>
References: <AANLkTinWNEvAVUjk8TYVd_28mEUS_dKnezCPtX64v4Lo@mail.gmail.com>
	<1326111160519-4278272.post@n4.nabble.com>
Message-ID: <CAP48nPaECC7pGJW=BVH4cwkWjgge+tJrZH6WouHWV0uiPrEsuQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120113/96ea005a/attachment.pl>

From comtech.usa at gmail.com  Fri Jan 13 20:30:32 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 13 Jan 2012 13:30:32 -0600
Subject: [R-SIG-Finance] price channel
Message-ID: <CAPNjSFbS5u026aOT9cq7c7-605x3x26LCuNGDy1Mow2hCbWL1Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120113/ce733813/attachment.pl>

From michael.weylandt at gmail.com  Sat Jan 14 02:37:43 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 13 Jan 2012 20:37:43 -0500
Subject: [R-SIG-Finance] price channel
In-Reply-To: <CAPNjSFbS5u026aOT9cq7c7-605x3x26LCuNGDy1Mow2hCbWL1Q@mail.gmail.com>
References: <CAPNjSFbS5u026aOT9cq7c7-605x3x26LCuNGDy1Mow2hCbWL1Q@mail.gmail.com>
Message-ID: <CAAmySGNOcayAcCPMhYU9tk=T=z1mXCK2NVnpLOYHKTOMLmDhQA@mail.gmail.com>

Perhaps runMax() and runMin() in TTR would let you code this up easily.

Michael

On Fri, Jan 13, 2012 at 2:30 PM, Michael <comtech.usa at gmail.com> wrote:
> Hi all,
>
> I am looking for the command/functions for defining price channel:
>
> A price channel is defined by the highest high and lowest low over some
> past number of bars. A trade is signaled when the market breaks out above
> or below the channel.
>
> Could you please point me to the right places?
>
> Thanks a lot!
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From kent.russell at live.com  Sat Jan 14 04:39:09 2012
From: kent.russell at live.com (Kent Russell)
Date: Fri, 13 Jan 2012 21:39:09 -0600
Subject: [R-SIG-Finance] price channel
In-Reply-To: <CAAmySGNOcayAcCPMhYU9tk=T=z1mXCK2NVnpLOYHKTOMLmDhQA@mail.gmail.com>
References: <CAPNjSFbS5u026aOT9cq7c7-605x3x26LCuNGDy1Mow2hCbWL1Q@mail.gmail.com>
	<CAAmySGNOcayAcCPMhYU9tk=T=z1mXCK2NVnpLOYHKTOMLmDhQA@mail.gmail.com>
Message-ID: <BLU0-SMTP1517E64CAC85CEE4C5B0DB3FB9D0@phx.gbl>

Do search on donchian channel. Lots of good code snippets out there.

Kent

On Jan 13, 2012, at 7:37 PM, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:

> Perhaps runMax() and runMin() in TTR would let you code this up easily.
> 
> Michael
> 
> On Fri, Jan 13, 2012 at 2:30 PM, Michael <comtech.usa at gmail.com> wrote:
>> Hi all,
>> 
>> I am looking for the command/functions for defining price channel:
>> 
>> A price channel is defined by the highest high and lowest low over some
>> past number of bars. A trade is signaled when the market breaks out above
>> or below the channel.
>> 
>> Could you please point me to the right places?
>> 
>> Thanks a lot!
>> 
>>       [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> 


From jeffrey.ryan at lemnica.com  Sat Jan 14 14:23:32 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Sat, 14 Jan 2012 07:23:32 -0600
Subject: [R-SIG-Finance] price channel
In-Reply-To: <BLU0-SMTP1517E64CAC85CEE4C5B0DB3FB9D0@phx.gbl>
References: <CAPNjSFbS5u026aOT9cq7c7-605x3x26LCuNGDy1Mow2hCbWL1Q@mail.gmail.com>
	<CAAmySGNOcayAcCPMhYU9tk=T=z1mXCK2NVnpLOYHKTOMLmDhQA@mail.gmail.com>
	<BLU0-SMTP1517E64CAC85CEE4C5B0DB3FB9D0@phx.gbl>
Message-ID: <CABDUZc_yeVkD=yv55jWdE6XKYE9EnvmfTsR=kJZDZtxPRzdOuw@mail.gmail.com>

library(TTR)

?DonchianChannel

Jeff

On Fri, Jan 13, 2012 at 9:39 PM, Kent Russell <kent.russell at live.com> wrote:
> Do search on donchian channel. Lots of good code snippets out there.
>
> Kent
>
> On Jan 13, 2012, at 7:37 PM, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:
>
>> Perhaps runMax() and runMin() in TTR would let you code this up easily.
>>
>> Michael
>>
>> On Fri, Jan 13, 2012 at 2:30 PM, Michael <comtech.usa at gmail.com> wrote:
>>> Hi all,
>>>
>>> I am looking for the command/functions for defining price channel:
>>>
>>> A price channel is defined by the highest high and lowest low over some
>>> past number of bars. A trade is signaled when the market breaks out above
>>> or below the channel.
>>>
>>> Could you please point me to the right places?
>>>
>>> Thanks a lot!
>>>
>>> ? ? ? [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com


From fin_engr at hotmail.com  Mon Jan 16 18:50:26 2012
From: fin_engr at hotmail.com (financial engineer)
Date: Mon, 16 Jan 2012 12:50:26 -0500
Subject: [R-SIG-Finance] OHLC and volume data analysis using quantmod
In-Reply-To: <1326294657.16398.113.camel@brian-rcg>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>,
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>,
	<7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>,
	<1326294657.16398.113.camel@brian-rcg>
Message-ID: <COL118-W151153641356A4D35DF8EDEF830@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120116/328f9a3b/attachment.pl>

From gsee000 at gmail.com  Mon Jan 16 20:06:56 2012
From: gsee000 at gmail.com (G See)
Date: Mon, 16 Jan 2012 13:06:56 -0600
Subject: [R-SIG-Finance] OHLC and volume data analysis using quantmod
In-Reply-To: <COL118-W151153641356A4D35DF8EDEF830@phx.gbl>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	<7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>
	<1326294657.16398.113.camel@brian-rcg>
	<COL118-W151153641356A4D35DF8EDEF830@phx.gbl>
Message-ID: <CA+xi=qZ3N-H5PY1o-CU-qdkG9LAU+_16g1vvj-DynK4nUd3-7A@mail.gmail.com>

If you apply to.minutes3 to an object that has volume, the volume will
be summed for you.

I think the following should work for you, although I didn't test your
specific example:

z <- xts(y[, 2:3], y[, 1])
to.minutes3(z, OHLC=TRUE)

HTH,
Garrett

On Mon, Jan 16, 2012 at 11:50 AM, financial engineer
<fin_engr at hotmail.com> wrote:
>
>
> hi,
>
> I have a time series of tick data and I am trying to get the aggregate volume for every 3-minutes for the tick data that I have converted into OHLC format (so I can use some of the nice functionalities of quantmod for my analysis).
>
> I have written the following code, but do
> ?not know how to get the aggregate volume for the 3-minutes in that OHLC for some
> volume analysis (so I can use aggregate(Vo(x)) etc.).
>
> library(tseries)
> library(xts)
> library(quantmod)
>
>
> x = read.table("tick.dat", header = FALSE, sep="\t", skip=0)
> x
> ? ? ? ? ? ? V1 ? ?V2 ? ? ? ? ? ? ? V3 ? ?V4 ? ?V5 ? ?V6 ? ? ? V7 V8 ?V9
> 11107 ?U10 2010-07-01 ?1 ? ? ?1453 9160 TRUE ?N ?N ? 2
> 11108 ?U10 2010-07-01 ?1 ? ? ?1453 9160 TRUE ?N ?N ? 1
> 11109 ?U10 2010-07-01 ?1 ? ? ?1454 9155 TRUE ?N ?N ? 4
> 11110 ?U10 2010-07-01 ?1 ? ? ?1455 9155 TRUE ?N ?N ? 3
> 11111 ?U10 2010-07-01 ?1 ? ? ?1455 9155 TRUE ?N ?N ? 1
>
> dt<-sprintf("%s %04d",x$V2,x$V4)
> dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
>
> y <- data.frame(dt,x$V5,x$V9)
> colnames(y) <- c("Date","Price","Volume")
> str(y)
>
> z <- xts(y[,2], y[,1])
>
> tickmin <- to.minutes3(z, OHLC=TRUE)
>
> Can anyone please suggest how I get the aggregate volume by 3-minutes into my OHLC series.
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From fin_engr at hotmail.com  Mon Jan 16 20:21:06 2012
From: fin_engr at hotmail.com (financial engineer)
Date: Mon, 16 Jan 2012 14:21:06 -0500
Subject: [R-SIG-Finance] OHLC and volume data analysis using quantmod
In-Reply-To: <CA+xi=qZ3N-H5PY1o-CU-qdkG9LAU+_16g1vvj-DynK4nUd3-7A@mail.gmail.com>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>,
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>,
	<7DD86548-CDE3-460F-9D36-295BFF05CC2B@gmail.com>,
	<1326294657.16398.113.camel@brian-rcg>,
	<COL118-W151153641356A4D35DF8EDEF830@phx.gbl>,
	<CA+xi=qZ3N-H5PY1o-CU-qdkG9LAU+_16g1vvj-DynK4nUd3-7A@mail.gmail.com>
Message-ID: <COL118-W57E3D6718CFFFF67539488EF830@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120116/470225db/attachment.pl>

From fin_engr at hotmail.com  Mon Jan 16 21:03:06 2012
From: fin_engr at hotmail.com (financial engineer)
Date: Mon, 16 Jan 2012 15:03:06 -0500
Subject: [R-SIG-Finance] plotting stl with time series data
Message-ID: <COL118-W33BA61F6939542C672D77EF830@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120116/ef480e8d/attachment.pl>

From josh.m.ulrich at gmail.com  Tue Jan 17 03:14:17 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 16 Jan 2012 20:14:17 -0600
Subject: [R-SIG-Finance] plotting stl with time series data
In-Reply-To: <COL118-W33BA61F6939542C672D77EF830@phx.gbl>
References: <COL118-W33BA61F6939542C672D77EF830@phx.gbl>
Message-ID: <CAPPM_gTn=E-JVXb206rBEwFv8=pznvozXrzdzMJujJJ9nhXDJw@mail.gmail.com>

Please don't cross-post:
http://stackoverflow.com/questions/8888237/plotting-stl-with-time-series-data
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Mon, Jan 16, 2012 at 2:03 PM, financial engineer
<fin_engr at hotmail.com> wrote:
>
> hi,
>
> I am trying to use stl to get a breakdown of the seasonal and trend in my timeseries data. I have tick data, and I have created a ts object.
>
> I ran a SQL query to get the data in the below form
>>x
> ? ? ? ? ? ?V1 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? V2
> 49995 ?2010-07-09 1341 ? ? ? ?9610
> 49996 ?2010-07-09 1341 ? ? ? ?9610
> 49997 ?2010-07-09 1342 ? ? ? ?9615
> 49998 ?2010-07-09 1342 ? ? ? ?9615
> 49999 ?2010-07-09 1342 ? ? ? ?9615
>
> and I converted it into ts by running the following:
>> xt<-ts(x[,2])
>>xt
> [99975] 9285 9285 9285 9285 9290 9290 9290 9290 9290 9290 9290 9290 9290 9290
> [99989] 9290 9290 9290 9290 9285 9285 9290 9290 9290 9290 9290
>
>> is.ts(xt)
> [1] TRUE
>
> now, when I try to plot the stl, I get the following error:
>>require(graphics)
>> plot(drg<-stl(log(xt), "per"))
> Error in plot(drg <- stl(log(xt), "per")) :
> ?error in evaluating the argument 'x' in selecting a method for function 'plot'
>
> I even tried the following:
>> plot(drg<-stl(log(xt), s.window=21))
> Error in plot(drg <- stl(log(xt), s.window = 21)) :
> ?error in evaluating the argument 'x' in selecting a method for function 'plot'
>>
>
> any suggestion on how I can fix the error, to be able to see the breakdown of the different trend components...I suspect I need to create the ts object differently, but I am not quite clear how to do it.....I can create the xts object but I realize that doesn't work with stl.
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Tue Jan 17 04:59:24 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 16 Jan 2012 21:59:24 -0600
Subject: [R-SIG-Finance] price channel
In-Reply-To: <CABDUZc_yeVkD=yv55jWdE6XKYE9EnvmfTsR=kJZDZtxPRzdOuw@mail.gmail.com>
References: <CAPNjSFbS5u026aOT9cq7c7-605x3x26LCuNGDy1Mow2hCbWL1Q@mail.gmail.com>
	<CAAmySGNOcayAcCPMhYU9tk=T=z1mXCK2NVnpLOYHKTOMLmDhQA@mail.gmail.com>
	<BLU0-SMTP1517E64CAC85CEE4C5B0DB3FB9D0@phx.gbl>
	<CABDUZc_yeVkD=yv55jWdE6XKYE9EnvmfTsR=kJZDZtxPRzdOuw@mail.gmail.com>
Message-ID: <CAPNjSFbJNnMD+UOCkzvxqUxfCZFm3RpnF-VekcsaDHAaVzcuYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120116/ed975faf/attachment.pl>

From varcovar at live.com  Tue Jan 17 11:55:31 2012
From: varcovar at live.com (varcovar)
Date: Tue, 17 Jan 2012 02:55:31 -0800 (PST)
Subject: [R-SIG-Finance] Defining many future_series() at once in
	FinancialInstruments
Message-ID: <1326797731918-4302922.post@n4.nabble.com>

Hi guys, 

I have 100 Futures symbols that are defined using the future() function from
the FinancialInstrument package. I want to define their respective contracts
using the future_series() function. I have about 15000 contracts to define.
The problem here is that the time needed to define a contract with
future_series() increases exponentially with the number of contracts defined
(it is very fast for the first contract, and then goes slower and slower).  

Here is a reproducible example. I build a vector of 104 market symbols and
then a vector of 19136 contracts (184 contracts for each market symbol).
Then I calculate the time needed to define the first 200 contracts, and then
600 contracts. While it takes about 2.76 seconds on my desktop to define the
first 200 contracts, it takes more than 23 seconds for the next 600
contracts. At this increasing rate, it would take an eternity to define all
those 19136 contracts. 

library(quantstrat)
## create a vector of 104 symbols
symbols <- NULL
for (i in 1:4)
    symbols <- c(symbols, paste(LETTERS[(2 * i):26], LETTERS[1:26], sep =
""))
currency("USD")
## create a vector containing all contracts for the 104 symbols (thus 19136
contracts)
all_contracts <- NULL
for (i in 1:length(symbols)) {
    ## define futures
    future(primary_id = symbols[i], currency = "USD", multiplier = 100, 
        tick_size = 0.1, month_cycle = "F,G,H,J,M,Q,V,Z")
    ## create contracts series
    contracts <- build_series_symbols(
        roots = data.frame(
            primary_id  = getInstrument(symbols[i])$primary_id, 
            month_cycle = getInstrument(symbols[i])$month_cycle), 
        yearlist = 1990:2012)
    ## format contracts symbols
    contracts <- format_id(contracts, format = "CYY")
    ## append new contracts to all contracts
    all_contracts <- c(all_contracts, contracts)
}
## calculate time needed to define contracts 
system.time(future_series(all_contracts[1:200]))
system.time(future_series(all_contracts[201:800]))

Once all the future_series are defined, I expect to save them using the
saveInstruments() function for later use. Any suggestion for making this
process faster? I really appreciate your help! Thank you. 

Markus Douglas

--
View this message in context: http://r.789695.n4.nabble.com/Defining-many-future-series-at-once-in-FinancialInstruments-tp4302922p4302922.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Tue Jan 17 19:58:24 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 17 Jan 2012 12:58:24 -0600
Subject: [R-SIG-Finance] R/Finance 2012 -- Call for Papers - deadline 31
	January, 2012
Message-ID: <1326826704.24988.71.camel@brian-rcg>

Only two weeks left to submit abstracts or full papers for R/Finance 2012!

Call for Papers:

R/Finance 2012: Applied Finance with R 
May 11 and 12, 2012 
University of Illinois at Chicago

The fourth annual R/Finance conference for applied finance using R
will be held on May 11 and 12, 2012 in Chicago, IL, USA on the campus
of the University of Illinois at Chicago.  The two-day conference will
cover topics including portfolio management, time series analysis,
advanced risk tools, high-performance computing, market
microstructure, and econometrics. All will be discussed within the
context of using R as a primary tool for financial risk management,
portfolio construction, and trading.

Over the past three years, R/Finance has included attendees from
around the world and featured keynote presentations from prominent
academics and practitioners. We anticipate another exciting line-up
for 2012 --- including keynote presentations from Blair Hull, 
Paul Gilbert, Rob McCulloch, and Simon Urbanek.

We invite you to submit complete papers or one-page abstracts (in txt
or pdf format) for consideration. Academic and practitioner proposals
related to R are encouraged. We welcome submissions for full talks,
abbreviated "lightning talks", and for a limited number of (longer)
pre-conference seminar sessions.

Presenters are strongly encouraged to provide working R code to
accompany the presentation/paper.  Data sets should also be made
public for the purposes of reproducibility (though we realize this may
be limited due to contracts with data vendors). Preference may be
given to presenters who have released R packages. 

Travel and accommodation grants may be available for selected
presenters at the committee?s discretion.  In addition, the conference
will award prizes for best papers. To be eligible for a best paper
award, a submission must be a full paper.  Extended abstracts, even if
a full paper by conference time, are not eligible for a best paper
award.

Please send submissions to: committee <at> RinFinance.com

The submission deadline is January 31, 2012.  Submitters will be
notified of acceptance via email by February 28, 2012. Notification of
whether a presentation will be a long presentation or a lightning talk
will also be made at that time.

Additional details will be announced via the conference website

	   http://www.RinFinance.com

as they become available. Information on previous years' presenters and their
presentations are also at the conference website. 

For the program committee: 

    Gib Bassett, Peter Carl, Dirk Eddelbuettel,
    Brian Peterson, Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich


From gsee000 at gmail.com  Wed Jan 18 07:23:16 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 18 Jan 2012 00:23:16 -0600
Subject: [R-SIG-Finance] Defining many future_series() at once in
	FinancialInstruments
In-Reply-To: <1326797731918-4302922.post@n4.nabble.com>
References: <1326797731918-4302922.post@n4.nabble.com>
Message-ID: <CA+xi=qar4vhWyisvzNtuR9guzarUYWYfEg+TPKSnFa2pSQmu6Q@mail.gmail.com>

Markus,

Thanks for the report.

The part that is slow is when it is searching the instrument
environment to see if the future_series you are trying to define has
already been defined.  I managed to more than double the speed of that
search following a suggestion from Brian to use unlist and regular
expressions.

However, the real speed up is to skip that step.  So, I added an
"overwrite" argument.  Now, future_series will not check to see if
there is already a future_series defined unless you call it with
overwrite=FALSE.

Patched at Rev 913.

Timings of your test below.

## Before patch
> system.time(future_series(all_contracts[1:200]))
   user  system elapsed
  2.600   0.000   2.595
> system.time(future_series(all_contracts[201:800]))
   user  system elapsed
 21.330   0.000  21.351
> system.time(future_series(all_contracts[801:2000]))
   user  system elapsed
104.950   0.000 105.041

> ## Update 1: unlist and regexpr instead of for loop
> system.time(future_series(all_contracts[1:200]))
   user  system elapsed
  1.160   0.000   1.158

> system.time(future_series(all_contracts[201:800]))
   user  system elapsed
  8.810   0.000   8.816

> system.time(future_series(all_contracts[801:2000]))
   user  system elapsed
 44.030   0.000  44.071

> ## New version
> system.time(future_series(all_contracts[1:200]))
   user  system elapsed
  0.180   0.000   0.176

> system.time(future_series(all_contracts[201:800]))
   user  system elapsed
  0.520   0.000   0.522

> system.time(future_series(all_contracts[801:2000]))
   user  system elapsed
  1.050   0.000   1.054


Regards,
Garrett


On Tue, Jan 17, 2012 at 4:55 AM, varcovar <varcovar at live.com> wrote:
> Hi guys,
>
> I have 100 Futures symbols that are defined using the future() function from
> the FinancialInstrument package. I want to define their respective contracts
> using the future_series() function. I have about 15000 contracts to define.
> The problem here is that the time needed to define a contract with
> future_series() increases exponentially with the number of contracts defined
> (it is very fast for the first contract, and then goes slower and slower).
>
> Here is a reproducible example. I build a vector of 104 market symbols and
> then a vector of 19136 contracts (184 contracts for each market symbol).
> Then I calculate the time needed to define the first 200 contracts, and then
> 600 contracts. While it takes about 2.76 seconds on my desktop to define the
> first 200 contracts, it takes more than 23 seconds for the next 600
> contracts. At this increasing rate, it would take an eternity to define all
> those 19136 contracts.
>
> library(quantstrat)
> ## create a vector of 104 symbols
> symbols <- NULL
> for (i in 1:4)
> ? ?symbols <- c(symbols, paste(LETTERS[(2 * i):26], LETTERS[1:26], sep =
> ""))
> currency("USD")
> ## create a vector containing all contracts for the 104 symbols (thus 19136
> contracts)
> all_contracts <- NULL
> for (i in 1:length(symbols)) {
> ? ?## define futures
> ? ?future(primary_id = symbols[i], currency = "USD", multiplier = 100,
> ? ? ? ?tick_size = 0.1, month_cycle = "F,G,H,J,M,Q,V,Z")
> ? ?## create contracts series
> ? ?contracts <- build_series_symbols(
> ? ? ? ?roots = data.frame(
> ? ? ? ? ? ?primary_id ?= getInstrument(symbols[i])$primary_id,
> ? ? ? ? ? ?month_cycle = getInstrument(symbols[i])$month_cycle),
> ? ? ? ?yearlist = 1990:2012)
> ? ?## format contracts symbols
> ? ?contracts <- format_id(contracts, format = "CYY")
> ? ?## append new contracts to all contracts
> ? ?all_contracts <- c(all_contracts, contracts)
> }
> ## calculate time needed to define contracts
> system.time(future_series(all_contracts[1:200]))
> system.time(future_series(all_contracts[201:800]))
>
> Once all the future_series are defined, I expect to save them using the
> saveInstruments() function for later use. Any suggestion for making this
> process faster? I really appreciate your help! Thank you.
>
> Markus Douglas
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Defining-many-future-series-at-once-in-FinancialInstruments-tp4302922p4302922.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From sam.bousquet at gmail.com  Wed Jan 18 12:07:01 2012
From: sam.bousquet at gmail.com (Samuel de Bousquet)
Date: Wed, 18 Jan 2012 12:07:01 +0100
Subject: [R-SIG-Finance] stop and reverse strategy not behaving as I expected
Message-ID: <CACBLjKTCSjVO8Z13j1PsD7aW6AfyWrWJShXus6jtP5Umnd=EHQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120118/c9a7386f/attachment.pl>

From khoxsey at gmail.com  Wed Jan 18 16:50:09 2012
From: khoxsey at gmail.com (Kent Hoxsey)
Date: Wed, 18 Jan 2012 07:50:09 -0800
Subject: [R-SIG-Finance] stop and reverse strategy not behaving as I
	expected
In-Reply-To: <CACBLjKTCSjVO8Z13j1PsD7aW6AfyWrWJShXus6jtP5Umnd=EHQ@mail.gmail.com>
References: <CACBLjKTCSjVO8Z13j1PsD7aW6AfyWrWJShXus6jtP5Umnd=EHQ@mail.gmail.com>
Message-ID: <A3051948-BD4B-45E4-B593-1662521A4A3C@gmail.com>

Argh, forgot to include the list as well.
---
Sam- the behavior you describe is precisely how channel-breakout strategies are expected to operate, with a stable no-trade zone between the upper and lower breakout levels (the "channel") to keep you from getting whipsawed during consolidation periods.

If you want a strategy that is always in the market, you might choose a moving average or other index indicator rather than a channel indicator.

Kent


On Jan 18, 2012, at 3:07 AM, Samuel de Bousquet wrote:

> Hello,
> 
> I am a little bit surprised by the behaviour of the below strategy, a
> simple 40 day Donchian Breakout (do not pay attention to the portfolio
> being named Faber).
> 
> Passed the initialization, I would have expected the strategy to be either
> long +1000 contracts or short 1000 contracts as it suppose to stop and
> reverse on the same rule. But is sometimes goes cash.
> 
> Would you understand why ?
> 
> Sam
> 
> Code:
> 
> 
> require(quantstrat)
> require(PerformanceAnalytics)
> 
> 
> 
> # Set initial values
> initDate <- "2010-04-30"
> endDate <- "2012-01-13"
> initEq <- 1000000
> 
> # Pull Yahoo Finance data
> symbols <- c("IEF", "SPY")
> getSymbols(symbols, from=initDate, to=endDate,
> index.class=c("POSIXt","POSIXct"), src='yahoo')
> 
> # Set up instruments with FinancialInstruments package
> currency("USD")
> for(symbol in symbols) {
>  stock(symbol, currency="USD", multiplier=1)
> }
> 
> # Delete portfolio, account, and order book if they already exist
> suppressWarnings(rm("account.faber","portfolio.faber",pos=.blotter))
> suppressWarnings(rm("order_book.faber",pos=.strategy))
> 
> # Initialize portfolio and account
> initPortf("faber", symbols=symbols, initDate=initDate)
> initAcct("faber", portfolios="faber", initDate=initDate, initEq=initEq)
> initOrders(portfolio="faber", initDate=initDate)
> 
> # Initialize a strategy object
> stratFaber <- strategy("faber")
> 
> # Add the 40-day Donchian indicator
> stratFaber <- add.indicator(strategy=stratFaber,
>                            name="DonchianChannel",
> 
> arguments=list(HL=quote(cbind(Hi(mktdata),Lo(mktdata))), n=40),
>                            label="Donchian40")
> 
> # There are two signals:
> # The first is when monthly price crosses over the 40-days Donchian
> stratFaber <- add.signal(stratFaber,
>                         name="sigComparison",
> 
> arguments=list(columns=c("High","Donchian40.high"),relationship="gte"),
>                         label="Hi.gt.Donchian40")
> # The second is when the monthly price crosses under the 40-days Donchian
> stratFaber <- add.signal(stratFaber,
>                         name="sigComparison",
>                         arguments=list(columns=c("Low","Donchian40.low"),
> relationship="lte"),
>                         label="Lo.lt.Donchian40")
> 
> # There are two rules:
> # The first is to buy when the price crosses above the Donchian
> stratFaber <- add.rule(stratFaber,
>                       name="ruleSignal",
>                       arguments=list(sigcol="Hi.gt.Donchian40",
>                                      sigval=TRUE,
>                                      orderqty=1000,
>                                      ordertype="market",
>                                      orderside="long",
>                                      pricemethod="market",
>                                      TxnFees=-5,
>                                      osFUN=osMaxPos),
>                       type="enter",
>                       path.dep=TRUE)
> # The second is to sell when the price crosses below the Donchian
> stratFaber <- add.rule(stratFaber,
>                       name="ruleSignal",
>                       arguments=list(sigcol="Lo.lt.Donchian40",
>                                      sigval=TRUE,
>                                      orderqty=-1000,
>                                      ordertype="market",
>                                      orderside="short",
>                                      pricemethod="market",
>                                      TxnFees=-5,
>                                      osFUN=osMaxPos),
>                       type="exit",
>                       path.dep=TRUE)
> 
> stratFaber <- add.rule(stratFaber,
>                       name="ruleSignal",
>                       arguments=list(sigcol="Lo.lt.Donchian40",
>                                      sigval=TRUE,
>                                      orderqty=-1000,
>                                      ordertype="market",
>                                      orderside="short",
>                                      pricemethod="market",
>                                      TxnFees=-5,
>                                      osFUN=osMaxPos),
>                       type="enter",
>                       path.dep=TRUE)
> 
> stratFaber <- add.rule(stratFaber,
>                       name="ruleSignal",
>                       arguments=list(sigcol="Hi.gt.Donchian40",
>                                      sigval=TRUE,
>                                      orderqty=1000,
>                                      ordertype="market",
>                                      orderside="long",
>                                      pricemethod="market",
>                                      TxnFees=-5,
>                                      osFUN=osMaxPos),
>                       type="exit",
>                       path.dep=TRUE)
> 
> 
> 
> # Set position limits so we don't add to the position every month Close >
> Donchian40
> addPosLimit("faber", "SPY", timestamp=initDate, maxpos=1000, minpos=-1000)
> addPosLimit("faber", "IEF", timestamp=initDate, maxpos=1000, minpos=-1000)
> 
> # Process the indicators and generate trades
> out <- try(applyStrategy(strategy=stratFaber, portfolios="faber"))
> updatePortf(Portfolio = "faber",
> Dates=paste('::',as.Date("2012-01-13"),sep=''))
> 
> # Evaluate results
> portRet <- PortfReturns("faber")
> portRet$Total <- rowSums(portRet, na.rm=TRUE)
> charts.PerformanceSummary(portRet$Total)
> tradeStats("faber")[,c("Symbol","Num.Trades","Net.Trading.PL
> ","maxDrawdown")]
> 
> 
> themelist<-chart_theme()
> themelist$col$up.col<-'green'
> themelist$col$dn.col<-'pink'
> chart.Posn(Portfolio="faber",Symbol="SPY",theme=themelist,log=TRUE, TA =
> "Donchian40")
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From fabercastellsince1761 at gmail.com  Wed Jan 18 17:21:04 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Wed, 18 Jan 2012 17:21:04 +0100
Subject: [R-SIG-Finance]  portfolios vs strategies in quantstrat
Message-ID: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120118/f487e69c/attachment.pl>

From papa.senyo at yahoo.it  Wed Jan 18 17:39:28 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Wed, 18 Jan 2012 16:39:28 +0000 (GMT)
Subject: [R-SIG-Finance] Garch Bootstrap forecast
Message-ID: <1326904768.71944.YahooMailNeo@web132310.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120118/e9c4f99b/attachment.pl>

From sam.bousquet at gmail.com  Wed Jan 18 17:40:39 2012
From: sam.bousquet at gmail.com (Samuel de Bousquet)
Date: Wed, 18 Jan 2012 17:40:39 +0100
Subject: [R-SIG-Finance] stop and reverse strategy not behaving as I
	expected
In-Reply-To: <A3051948-BD4B-45E4-B593-1662521A4A3C@gmail.com>
References: <CACBLjKTCSjVO8Z13j1PsD7aW6AfyWrWJShXus6jtP5Umnd=EHQ@mail.gmail.com>
	<A3051948-BD4B-45E4-B593-1662521A4A3C@gmail.com>
Message-ID: <CACBLjKT9=WbcP0JgyMrvQuvNNvrQAGpyG-ogwqKhpKB6YBXY1g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120118/aeba53d7/attachment.pl>

From brian at braverock.com  Wed Jan 18 18:02:13 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 18 Jan 2012 11:02:13 -0600
Subject: [R-SIG-Finance] stop and reverse strategy not behaving as I
 expected
In-Reply-To: <CACBLjKT9=WbcP0JgyMrvQuvNNvrQAGpyG-ogwqKhpKB6YBXY1g@mail.gmail.com>
References: <CACBLjKTCSjVO8Z13j1PsD7aW6AfyWrWJShXus6jtP5Umnd=EHQ@mail.gmail.com>
	<A3051948-BD4B-45E4-B593-1662521A4A3C@gmail.com>
	<CACBLjKT9=WbcP0JgyMrvQuvNNvrQAGpyG-ogwqKhpKB6YBXY1g@mail.gmail.com>
Message-ID: <1326906133.24988.107.camel@brian-rcg>

Check the order of your rules.

Exit rules will be processed before entries, per the documentation.

So, if you want to stop and reverse, you need to exit first, then enter
the new position, and not violate your max position on either side.

I'll take a look at your code when I get a chance, but hopefully this
helps.

  - Brian
 

On Wed, 2012-01-18 at 17:40 +0100, Samuel de Bousquet wrote:
> Yes, that's correct. But the signal I use to exit the long position is the
> same that the one I use to go short. Same thing when I go from short to
> long. That is not a typical Donchian breakout trading, but a "stop and
> reverse strategy".
> 
> Looking at the code, I have twice 2 rules looking at the same indicator.
> However, only one will trigger a trade the same day.
> 
> S.
> 
> 
> 
> On Wed, Jan 18, 2012 at 4:50 PM, Kent Hoxsey <khoxsey at gmail.com> wrote:
> 
> > Argh, forgot to include the list as well.
> > ---
> > Sam- the behavior you describe is precisely how channel-breakout
> > strategies are expected to operate, with a stable no-trade zone between the
> > upper and lower breakout levels (the "channel") to keep you from getting
> > whipsawed during consolidation periods.
> >
> > If you want a strategy that is always in the market, you might choose a
> > moving average or other index indicator rather than a channel indicator.
> >
> > Kent
> >
> >
> > On Jan 18, 2012, at 3:07 AM, Samuel de Bousquet wrote:
> >
> > > Hello,
> > >
> > > I am a little bit surprised by the behaviour of the below strategy, a
> > > simple 40 day Donchian Breakout (do not pay attention to the portfolio
> > > being named Faber).
> > >
> > > Passed the initialization, I would have expected the strategy to be
> > either
> > > long +1000 contracts or short 1000 contracts as it suppose to stop and
> > > reverse on the same rule. But is sometimes goes cash.
> > >
> > > Would you understand why ?
> > >
> > > Sam
> > >
> > > Code:
> > >
> > >
> > > require(quantstrat)
> > > require(PerformanceAnalytics)
> > >
> > >
> > >
> > > # Set initial values
> > > initDate <- "2010-04-30"
> > > endDate <- "2012-01-13"
> > > initEq <- 1000000
> > >
> > > # Pull Yahoo Finance data
> > > symbols <- c("IEF", "SPY")
> > > getSymbols(symbols, from=initDate, to=endDate,
> > > index.class=c("POSIXt","POSIXct"), src='yahoo')
> > >
> > > # Set up instruments with FinancialInstruments package
> > > currency("USD")
> > > for(symbol in symbols) {
> > >  stock(symbol, currency="USD", multiplier=1)
> > > }
> > >
> > > # Delete portfolio, account, and order book if they already exist
> > > suppressWarnings(rm("account.faber","portfolio.faber",pos=.blotter))
> > > suppressWarnings(rm("order_book.faber",pos=.strategy))
> > >
> > > # Initialize portfolio and account
> > > initPortf("faber", symbols=symbols, initDate=initDate)
> > > initAcct("faber", portfolios="faber", initDate=initDate, initEq=initEq)
> > > initOrders(portfolio="faber", initDate=initDate)
> > >
> > > # Initialize a strategy object
> > > stratFaber <- strategy("faber")
> > >
> > > # Add the 40-day Donchian indicator
> > > stratFaber <- add.indicator(strategy=stratFaber,
> > >                            name="DonchianChannel",
> > >
> > > arguments=list(HL=quote(cbind(Hi(mktdata),Lo(mktdata))), n=40),
> > >                            label="Donchian40")
> > >
> > > # There are two signals:
> > > # The first is when monthly price crosses over the 40-days Donchian
> > > stratFaber <- add.signal(stratFaber,
> > >                         name="sigComparison",
> > >
> > > arguments=list(columns=c("High","Donchian40.high"),relationship="gte"),
> > >                         label="Hi.gt.Donchian40")
> > > # The second is when the monthly price crosses under the 40-days Donchian
> > > stratFaber <- add.signal(stratFaber,
> > >                         name="sigComparison",
> > >                         arguments=list(columns=c("Low","Donchian40.low"),
> > > relationship="lte"),
> > >                         label="Lo.lt.Donchian40")
> > >
> > > # There are two rules:
> > > # The first is to buy when the price crosses above the Donchian
> > > stratFaber <- add.rule(stratFaber,
> > >                       name="ruleSignal",
> > >                       arguments=list(sigcol="Hi.gt.Donchian40",
> > >                                      sigval=TRUE,
> > >                                      orderqty=1000,
> > >                                      ordertype="market",
> > >                                      orderside="long",
> > >                                      pricemethod="market",
> > >                                      TxnFees=-5,
> > >                                      osFUN=osMaxPos),
> > >                       type="enter",
> > >                       path.dep=TRUE)
> > > # The second is to sell when the price crosses below the Donchian
> > > stratFaber <- add.rule(stratFaber,
> > >                       name="ruleSignal",
> > >                       arguments=list(sigcol="Lo.lt.Donchian40",
> > >                                      sigval=TRUE,
> > >                                      orderqty=-1000,
> > >                                      ordertype="market",
> > >                                      orderside="short",
> > >                                      pricemethod="market",
> > >                                      TxnFees=-5,
> > >                                      osFUN=osMaxPos),
> > >                       type="exit",
> > >                       path.dep=TRUE)
> > >
> > > stratFaber <- add.rule(stratFaber,
> > >                       name="ruleSignal",
> > >                       arguments=list(sigcol="Lo.lt.Donchian40",
> > >                                      sigval=TRUE,
> > >                                      orderqty=-1000,
> > >                                      ordertype="market",
> > >                                      orderside="short",
> > >                                      pricemethod="market",
> > >                                      TxnFees=-5,
> > >                                      osFUN=osMaxPos),
> > >                       type="enter",
> > >                       path.dep=TRUE)
> > >
> > > stratFaber <- add.rule(stratFaber,
> > >                       name="ruleSignal",
> > >                       arguments=list(sigcol="Hi.gt.Donchian40",
> > >                                      sigval=TRUE,
> > >                                      orderqty=1000,
> > >                                      ordertype="market",
> > >                                      orderside="long",
> > >                                      pricemethod="market",
> > >                                      TxnFees=-5,
> > >                                      osFUN=osMaxPos),
> > >                       type="exit",
> > >                       path.dep=TRUE)
> > >
> > >
> > >
> > > # Set position limits so we don't add to the position every month Close >
> > > Donchian40
> > > addPosLimit("faber", "SPY", timestamp=initDate, maxpos=1000,
> > minpos=-1000)
> > > addPosLimit("faber", "IEF", timestamp=initDate, maxpos=1000,
> > minpos=-1000)
> > >
> > > # Process the indicators and generate trades
> > > out <- try(applyStrategy(strategy=stratFaber, portfolios="faber"))
> > > updatePortf(Portfolio = "faber",
> > > Dates=paste('::',as.Date("2012-01-13"),sep=''))
> > >
> > > # Evaluate results
> > > portRet <- PortfReturns("faber")
> > > portRet$Total <- rowSums(portRet, na.rm=TRUE)
> > > charts.PerformanceSummary(portRet$Total)
> > > tradeStats("faber")[,c("Symbol","Num.Trades","Net.Trading.PL
> > > ","maxDrawdown")]
> > >
> > >
> > > themelist<-chart_theme()
> > > themelist$col$up.col<-'green'
> > > themelist$col$dn.col<-'pink'
> > > chart.Posn(Portfolio="faber",Symbol="SPY",theme=themelist,log=TRUE, TA =
> > > "Donchian40")
> > >
> > >       [[alternative HTML version deleted]]


From brian at braverock.com  Wed Jan 18 18:58:18 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 18 Jan 2012 11:58:18 -0600
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
Message-ID: <1326909498.24988.129.camel@brian-rcg>

On Wed, 2012-01-18 at 17:21 +0100, Faber Castell wrote:
> Hello,
> 
> I am trying to determine what is the proper way to organize my work :
> 
> I have several model (moving average, bollinger bands...) that I run using
> sevral set of lookback periods.
> 
> Within quantstrat, should I have:
> - a strategy per unique combination of (model, lookback period) ?
> - a strategy per unique combination of model, so a strategy would be a
> model applied to a set of lookback period ?
> - something else ?
> 
> Or am I mixing strategies and portfolios ? As I can read that
> "applyStrategy()" will run one strategies in one or many portfolios.
> 
> Would it be possible for one of you to clarify what is the role of
> portfolios versus strategies and their link to models and look back period?
> 
> In the end, my goal is to backtest my set of model x lookback period to see
> what is the result at an aggregated level.

A strategy in quantstrat is *only* a 'model'.

It is the unique combination of indicators, signals, and rules.

There is no explicit concept for 'look back period', and you didn't
follow the posting guide to provide reproducible code, so I'm just
guessing.  I would guess, given the limited context, that lookback
period is a *parameter*.  See both the simple parameters= named list
argument to applyStrategy and the more complicated and more powerful
applyParameters and related functions.

Now, how does all this relate to portfolios?  

Answer: That depends on how you want to use it.

the blotter package, which is used by quantstrat for all the transaction
accounting, was made intentionally flexible in the organization, only
requiring that portfolios aggregate to an account, and that the same
account may only contain one copy of a given portfolio (but different
accounts may contain the same portfolio, allowing you to do different
slicing and dicing, if you're careful).  quantstrat doesn't care about
any of this, just needing to know which portfolio to place trades into
for a specific instrument.

Most (all?) of the quantstrat demo scripts that trade more than one
instrument create one single portfolio that contains all the instruments
in the demo, which makes it a little easier to aggregate performance for
the entire 'portfolio' of instruments.  This type of aggregation would
also be required if you, for example, used some of the functions Guy
Yollin talked about in his UW quantstrat lectures[1] to do things like
capital-aware trade sizing.

applyParameters will create a separate portfolio for each unique
combination of strategy and parameter sets (with one or more instruments
tested per portfolio), which may create hundreds or thousands of
portfolios, depending on how many combinations you test.  This is useful
for evaluating the 'parameter robustness' of your strategy, and keeping
the results of different parameter combinations.

When I am comparing a mature strategy to the production trading logs I
use one portfolio per instrument (or group of instruments traded
together, as with an automated spreader).  This lets me use
reconciliation features built into the blotter package to evaluate the
differences between the model and the reality of our production trades.

That said, these are only three examples.  How you choose to subset your
instruments and parameters into portfolios and accounts may vary based
on how you want to use the resulting data.

Hopefully, this clears things up a little.

..and next time, please do everyone the courtesy of using your name[2].
I don't much like answering questions from pencils.  You get a hall pass
this time because it was a reasonable and intelligent question.[2] ;)

Regards,

   - Brian

Ref:
[1] http://www.r-programming.org/papers
[2] http://catb.org/~esr/faqs/smart-questions.html


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From rharlow86 at gmail.com  Wed Jan 18 19:08:11 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Wed, 18 Jan 2012 13:08:11 -0500
Subject: [R-SIG-Finance] Garch Bootstrap forecast
In-Reply-To: <1326904768.71944.YahooMailNeo@web132310.mail.ird.yahoo.com>
References: <1326904768.71944.YahooMailNeo@web132310.mail.ird.yahoo.com>
Message-ID: <CAHdfS960y8dj+DOQmOxLk3RJrnT7gJ=TYJGnz4Z=7kX+tKFrEg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120118/a577beb0/attachment.pl>

From krishna at primps.com.sg  Thu Jan 19 03:35:31 2012
From: krishna at primps.com.sg (SNV Krishna)
Date: Thu, 19 Jan 2012 10:35:31 +0800
Subject: [R-SIG-Finance] getSymbol error to download data from FRED
Message-ID: <008a01ccd653$039619a0$0ac24ce0$@com.sg>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/1aaf7570/attachment.pl>

From sankalp.upadhyay at gmail.com  Thu Jan 19 04:32:51 2012
From: sankalp.upadhyay at gmail.com (Sankalp Upadhyay)
Date: Wed, 18 Jan 2012 21:32:51 -0600
Subject: [R-SIG-Finance] getSymbol error to download data from FRED
In-Reply-To: <008a01ccd653$039619a0$0ac24ce0$@com.sg>
References: <008a01ccd653$039619a0$0ac24ce0$@com.sg>
Message-ID: <CA+9EQxsrswNKD+H2kg3GsuV=yH8YQADNSbSMou32m3CLP8B-NA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120118/06f4949e/attachment.pl>

From patrick at burns-stat.com  Thu Jan 19 10:17:15 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 19 Jan 2012 09:17:15 +0000
Subject: [R-SIG-Finance] How to search the archives
Message-ID: <4F17DF9B.6000501@burns-stat.com>

There is now a blog post:

http://www.portfolioprobe.com/2012/01/19/how-to-search-the-r-sig-finance-archives/

on searching the list archives.

If you are unsure about how to do that,
then you can read it.

If you have a different method of searching
that others might benefit from, then please
leave a comment about it.


-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From fabercastellsince1761 at gmail.com  Thu Jan 19 11:19:24 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Thu, 19 Jan 2012 11:19:24 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <1326909498.24988.129.camel@brian-rcg>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
Message-ID: <CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/2f8eab54/attachment.pl>

From papa.senyo at yahoo.it  Thu Jan 19 14:02:24 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Thu, 19 Jan 2012 13:02:24 +0000 (GMT)
Subject: [R-SIG-Finance] Backtesting
Message-ID: <1326978144.19060.YahooMailNeo@web132304.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/011d24c2/attachment.pl>

From alexios at 4dscape.com  Thu Jan 19 14:24:57 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Thu, 19 Jan 2012 13:24:57 +0000
Subject: [R-SIG-Finance] Backtesting
In-Reply-To: <1326978144.19060.YahooMailNeo@web132304.mail.ird.yahoo.com>
References: <1326978144.19060.YahooMailNeo@web132304.mail.ird.yahoo.com>
Message-ID: <1326979497.5267.5.camel@Metis>

What one can do is take more care when submitting what is meant to be 
a reproducible example: You are passing an undefined "spec3" when in
fact you want to pass "spec" as defined by yourself below (which when I
try it works just fine and returns the eGARCH-sstd rolling model).

Regards,
Alexios

On Thu, 2012-01-19 at 13:02 +0000, Papa Senyo wrote:
> Dear ALL.
> Please, find the code below;
> spec = ugarchspec(variance.model = list(model = "eGARCH"),
> distribution.model ="sstd")
>  roll = ugarchroll(spec3, data = xx, n.ahead = 1, forecast.length =
> 875,
>  refit.every = 100, refit.window = "recursive", parallel = TRUE,
>  parallel.control = list(pkg = "snowfall", cores = 10), solver =
> "solnp",
>  solver.control = list(tol = 1e-05, delta = 1e-06, trace = 0),
>  calculate.VaR = TRUE, VaR.alpha = c(0.01, 0.05))
>  report(roll, type = "VaR", n.ahead = 1, VaR.alpha = 0.01, conf.level
> = 0.99)
> xx is a univariate time series.
> The problem is the even though the distribution.model="sstd" it
> reports EGARCH-norm
> and also changing the backtest length  have no effect.
> Also when for the VaR report both the conditional average and the
> unconditional average are rejected, what esle can one do and what does
> it imply.
> Kind regards
> Papa
>


From fabercastellsince1761 at gmail.com  Thu Jan 19 17:09:30 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Thu, 19 Jan 2012 17:09:30 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
Message-ID: <CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/e69b7d39/attachment.pl>

From comtech.usa at gmail.com  Thu Jan 19 19:43:30 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 19 Jan 2012 12:43:30 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute the
	medians in the bins?
Message-ID: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/b43a03eb/attachment.pl>

From jeffrey.ryan at lemnica.com  Thu Jan 19 19:51:43 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 19 Jan 2012 12:51:43 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
Message-ID: <CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>

Use a time series class.  This has all been solved thousands of times
before in private and on the lists.

Jeff

On Thu, Jan 19, 2012 at 12:43 PM, Michael <comtech.usa at gmail.com> wrote:
> Hi all,
>
> I have data in the following format:
>
> How do I bucket the data into 5 min bins and then compute the median of
> quotes in the bins?
>
> Currently the "DateTimeStamps" are "factors" in the data frame and I
> ordered the rows according to these DateTimeStamps
>
> Thanks a lot!
>
> Bid ? ? ? ? ? Offer ? ? ?DateTimeStamps
>
> 46.00 ? ? ? 46.10 ? ? 2006-06-16 12:12:00.082225
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com


From comtech.usa at gmail.com  Thu Jan 19 19:54:43 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 19 Jan 2012 12:54:43 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
Message-ID: <CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/cbb40b5f/attachment.pl>

From michael.weylandt at gmail.com  Thu Jan 19 19:56:08 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 19 Jan 2012 13:56:08 -0500
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
Message-ID: <CAAmySGO5ZHRSKTOVp_F9A3aYzk3we=6U6+9vRpCZBusSi=hzmw@mail.gmail.com>

Use something like:

period.apply(X, endpoints(X, "minutes", 5), median)

Michael Weylandt


On Thu, Jan 19, 2012 at 1:54 PM, Michael <comtech.usa at gmail.com> wrote:
> I have also searched "crazily"... and read into both "xts" and "zoo"... but
> couldn't find a solution...
>
> My questions are:
>
> 1. How to handle the ".082225" part in "xts" and "zoo"?
>
> 2. The "xts/zoo" interval arithmatic only handles OHLC of an interval, not
> median of an interval, right?
>
> Thanks a lot!
>
> On Thu, Jan 19, 2012 at 12:51 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>
>> Use a time series class. ?This has all been solved thousands of times
>> before in private and on the lists.
>>
>> Jeff
>>
>> On Thu, Jan 19, 2012 at 12:43 PM, Michael <comtech.usa at gmail.com> wrote:
>> > Hi all,
>> >
>> > I have data in the following format:
>> >
>> > How do I bucket the data into 5 min bins and then compute the median of
>> > quotes in the bins?
>> >
>> > Currently the "DateTimeStamps" are "factors" in the data frame and I
>> > ordered the rows according to these DateTimeStamps
>> >
>> > Thanks a lot!
>> >
>> > Bid ? ? ? ? ? Offer ? ? ?DateTimeStamps
>> >
>> > 46.00 ? ? ? 46.10 ? ? 2006-06-16 12:12:00.082225
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>> www.esotericR.com <http://www.esotericr.com/>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jeffrey.ryan at lemnica.com  Thu Jan 19 20:01:20 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 19 Jan 2012 13:01:20 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
Message-ID: <CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>

You should lead with what you have tried, it lets everyone have a
better idea of what you are looking for.

That said, the .082225 is perfectly acceptable to xts, though
precision-wise you are near the limit of floating point precision on
many platforms.  The previous post in this thread is on target to what
you want.

Take a good look at ?endpoints and to a lesser extend ?period.apply.

HTH
Jeff

On Thu, Jan 19, 2012 at 12:54 PM, Michael <comtech.usa at gmail.com> wrote:
> I have also searched "crazily"... and read into both "xts" and "zoo"... but
> couldn't find a solution...
>
> My questions are:
>
> 1. How to handle the ".082225" part in "xts" and "zoo"?
>
> 2. The "xts/zoo" interval arithmatic only handles OHLC of an interval, not
> median of an interval, right?
>
> Thanks a lot!
>
> On Thu, Jan 19, 2012 at 12:51 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>
>> Use a time series class. ?This has all been solved thousands of times
>> before in private and on the lists.
>>
>> Jeff
>>
>> On Thu, Jan 19, 2012 at 12:43 PM, Michael <comtech.usa at gmail.com> wrote:
>> > Hi all,
>> >
>> > I have data in the following format:
>> >
>> > How do I bucket the data into 5 min bins and then compute the median of
>> > quotes in the bins?
>> >
>> > Currently the "DateTimeStamps" are "factors" in the data frame and I
>> > ordered the rows according to these DateTimeStamps
>> >
>> > Thanks a lot!
>> >
>> > Bid ? ? ? ? ? Offer ? ? ?DateTimeStamps
>> >
>> > 46.00 ? ? ? 46.10 ? ? 2006-06-16 12:12:00.082225
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>> www.esotericR.com <http://www.esotericr.com/>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com


From gsee000 at gmail.com  Thu Jan 19 20:07:44 2012
From: gsee000 at gmail.com (G See)
Date: Thu, 19 Jan 2012 13:07:44 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
Message-ID: <CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>

Michael comtech,

You might also consider reading one of the 2 e-mails that Brian sent
you on-list in the last month that say to look at
?strftime

For example ... the second example on that page
format(Sys.time(), "%H:%M:%OS3")


On Thu, Jan 19, 2012 at 1:01 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
> You should lead with what you have tried, it lets everyone have a
> better idea of what you are looking for.
>
> That said, the .082225 is perfectly acceptable to xts, though
> precision-wise you are near the limit of floating point precision on
> many platforms. ?The previous post in this thread is on target to what
> you want.
>
> Take a good look at ?endpoints and to a lesser extend ?period.apply.
>
> HTH
> Jeff
>
> On Thu, Jan 19, 2012 at 12:54 PM, Michael <comtech.usa at gmail.com> wrote:
>> I have also searched "crazily"... and read into both "xts" and "zoo"... but
>> couldn't find a solution...
>>
>> My questions are:
>>
>> 1. How to handle the ".082225" part in "xts" and "zoo"?
>>
>> 2. The "xts/zoo" interval arithmatic only handles OHLC of an interval, not
>> median of an interval, right?
>>
>> Thanks a lot!
>>
>> On Thu, Jan 19, 2012 at 12:51 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>>
>>> Use a time series class. ?This has all been solved thousands of times
>>> before in private and on the lists.
>>>
>>> Jeff
>>>
>>> On Thu, Jan 19, 2012 at 12:43 PM, Michael <comtech.usa at gmail.com> wrote:
>>> > Hi all,
>>> >
>>> > I have data in the following format:
>>> >
>>> > How do I bucket the data into 5 min bins and then compute the median of
>>> > quotes in the bins?
>>> >
>>> > Currently the "DateTimeStamps" are "factors" in the data frame and I
>>> > ordered the rows according to these DateTimeStamps
>>> >
>>> > Thanks a lot!
>>> >
>>> > Bid ? ? ? ? ? Offer ? ? ?DateTimeStamps
>>> >
>>> > 46.00 ? ? ? 46.10 ? ? 2006-06-16 12:12:00.082225
>>> >
>>> > ? ? ? ?[[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-SIG-Finance at r-project.org mailing list
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> > -- Subscriber-posting only. If you want to post, subscribe first.
>>> > -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>>
>>>
>>> --
>>> Jeffrey Ryan
>>> jeffrey.ryan at lemnica.com
>>>
>>> www.lemnica.com
>>> www.esotericR.com <http://www.esotericr.com/>
>>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
> www.esotericR.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Thu Jan 19 20:32:54 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 19 Jan 2012 13:32:54 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
Message-ID: <CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/7337b2e3/attachment.pl>

From comtech.usa at gmail.com  Thu Jan 19 20:36:57 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 19 Jan 2012 13:36:57 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
	<CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
Message-ID: <CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/371eba0e/attachment.pl>

From jeffrey.ryan at lemnica.com  Thu Jan 19 21:14:09 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 19 Jan 2012 14:14:09 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
	<CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
	<CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>
Message-ID: <CABDUZc9rJW_FQdxKHSOb0+kMuzwq2hUvsELDMuSJ3TMS0jbPow@mail.gmail.com>

It is preserved, just not displayed.

options(digits.secs=6)

HTH
Jeff

On Thu, Jan 19, 2012 at 1:36 PM, Michael <comtech.usa at gmail.com> wrote:
> So is there a way to convert into xts object while preserving the ".082225"
> part?
>
> Thx
>
> On Thu, Jan 19, 2012 at 1:32 PM, Michael <comtech.usa at gmail.com> wrote:
>
>> Thank you! But it doesn't work...
>>
>> >
>> g1
>>
>> [1] 46.00 46.00 46.00 45.75 45.75
>>
>>
>> >
>> g2
>>
>> [1] "2006-06-16 12:12:00.082225" "2006-06-16 12:12:00.082225"
>>
>> [3] "2006-06-16 12:12:00.082225" "2006-06-16 12:07:00.082225"
>>
>> [5] "2006-06-16 12:12:00.082225"
>>
>> It doesn't work:
>>
>> g3=xts(g1, order.by=as.POSIXct(strptime(g2, "%Y-%m-%d %H:%M:%OS3")))
>>
>> >
>> g3
>>
>> [,1]
>>
>> <NA> 46.00
>>
>> <NA> 46.00
>>
>> <NA> 46.00
>>
>> <NA> 45.75
>>
>> <NA> 45.75
>>
>>
>>
>> But the following worked:
>>
>> >
>> g3=xts(g1, order.by=as.POSIXct(strptime(g2, "%Y-%m-%d %H:%M:%OS")))
>>
>> >
>>
>> >
>>
>> >
>> g3
>>
>> [,1]
>>
>> 2006-06-16 12:07:00 45.75
>>
>> 2006-06-16 12:12:00 46.00
>>
>> 2006-06-16 12:12:00 46.00
>>
>> 2006-06-16 12:12:00 46.00
>>
>> 2006-06-16 12:12:00 45.75
>>
>>
>>
>> On Thu, Jan 19, 2012 at 1:07 PM, G See <gsee000 at gmail.com> wrote:
>>
>>> Michael comtech,
>>>
>>> You might also consider reading one of the 2 e-mails that Brian sent
>>> you on-list in the last month that say to look at
>>> ?strftime
>>>
>>> For example ... the second example on that page
>>> format(Sys.time(), "%H:%M:%OS3")
>>>
>>>
>>> On Thu, Jan 19, 2012 at 1:01 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>
>>> wrote:
>>> > You should lead with what you have tried, it lets everyone have a
>>> > better idea of what you are looking for.
>>> >
>>> > That said, the .082225 is perfectly acceptable to xts, though
>>> > precision-wise you are near the limit of floating point precision on
>>> > many platforms. ?The previous post in this thread is on target to what
>>> > you want.
>>> >
>>> > Take a good look at ?endpoints and to a lesser extend ?period.apply.
>>> >
>>> > HTH
>>> > Jeff
>>> >
>>> > On Thu, Jan 19, 2012 at 12:54 PM, Michael <comtech.usa at gmail.com>
>>> wrote:
>>> >> I have also searched "crazily"... and read into both "xts" and
>>> "zoo"... but
>>> >> couldn't find a solution...
>>> >>
>>> >> My questions are:
>>> >>
>>> >> 1. How to handle the ".082225" part in "xts" and "zoo"?
>>> >>
>>> >> 2. The "xts/zoo" interval arithmatic only handles OHLC of an interval,
>>> not
>>> >> median of an interval, right?
>>> >>
>>> >> Thanks a lot!
>>> >>
>>> >> On Thu, Jan 19, 2012 at 12:51 PM, Jeffrey Ryan <
>>> jeffrey.ryan at lemnica.com>wrote:
>>> >>
>>> >>> Use a time series class. ?This has all been solved thousands of times
>>> >>> before in private and on the lists.
>>> >>>
>>> >>> Jeff
>>> >>>
>>> >>> On Thu, Jan 19, 2012 at 12:43 PM, Michael <comtech.usa at gmail.com>
>>> wrote:
>>> >>> > Hi all,
>>> >>> >
>>> >>> > I have data in the following format:
>>> >>> >
>>> >>> > How do I bucket the data into 5 min bins and then compute the
>>> median of
>>> >>> > quotes in the bins?
>>> >>> >
>>> >>> > Currently the "DateTimeStamps" are "factors" in the data frame and I
>>> >>> > ordered the rows according to these DateTimeStamps
>>> >>> >
>>> >>> > Thanks a lot!
>>> >>> >
>>> >>> > Bid ? ? ? ? ? Offer ? ? ?DateTimeStamps
>>> >>> >
>>> >>> > 46.00 ? ? ? 46.10 ? ? 2006-06-16 12:12:00.082225
>>> >>> >
>>> >>> > ? ? ? ?[[alternative HTML version deleted]]
>>> >>> >
>>> >>> > _______________________________________________
>>> >>> > R-SIG-Finance at r-project.org mailing list
>>> >>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> >>> > -- Subscriber-posting only. If you want to post, subscribe first.
>>> >>> > -- Also note that this is not the r-help list where general R
>>> questions
>>> >>> should go.
>>> >>>
>>> >>>
>>> >>>
>>> >>> --
>>> >>> Jeffrey Ryan
>>> >>> jeffrey.ryan at lemnica.com
>>> >>>
>>> >>> www.lemnica.com
>>> >>> www.esotericR.com <http://www.esotericr.com/> <
>>> http://www.esotericr.com/>
>>> >>>
>>> >>
>>> >> ? ? ? ?[[alternative HTML version deleted]]
>>> >>
>>> >> _______________________________________________
>>> >> R-SIG-Finance at r-project.org mailing list
>>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>>> >> -- Also note that this is not the r-help list where general R
>>> questions should go.
>>> >
>>> >
>>> >
>>> > --
>>> > Jeffrey Ryan
>>> > jeffrey.ryan at lemnica.com
>>> >
>>> > www.lemnica.com
>>> > www.esotericR.com <http://www.esotericr.com/>
>>> >
>>> > _______________________________________________
>>> > R-SIG-Finance at r-project.org mailing list
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> > -- Subscriber-posting only. If you want to post, subscribe first.
>>> > -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com


From comtech.usa at gmail.com  Thu Jan 19 21:38:55 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 19 Jan 2012 14:38:55 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CABDUZc9rJW_FQdxKHSOb0+kMuzwq2hUvsELDMuSJ3TMS0jbPow@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
	<CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
	<CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>
	<CABDUZc9rJW_FQdxKHSOb0+kMuzwq2hUvsELDMuSJ3TMS0jbPow@mail.gmail.com>
Message-ID: <CAPNjSFafWcyth7cHmhmkBhbySSGqnyFy8DcaXZ+AjP02smeF1Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120119/538691e0/attachment.pl>

From brian at braverock.com  Thu Jan 19 23:38:07 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 19 Jan 2012 16:38:07 -0600
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
Message-ID: <1327012687.24988.146.camel@brian-rcg>

On Thu, 2012-01-19 at 17:09 +0100, Faber Castell wrote:
> I am struggling with both demos 'parameterTest' and 'parameterTestMACD'. Do
> you manage to run them ? I did run 'bbands' and 'macd' as asked in comments.

> Error in as.list(.instrument) : object '.instrument' cannot be found

The .instrument environment was recently moved out of the .GlobalEnv and
into the FinancialInstrument namespace. (any FinancialInstrument version
newer than 0.10 has this change)

Looks like we missed the change here.

I'll take a look at the parameter code in quantstrat tomorrow and patch.
Thanks for the report.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From krishna at primps.com.sg  Fri Jan 20 05:38:59 2012
From: krishna at primps.com.sg (SNV Krishna)
Date: Fri, 20 Jan 2012 12:38:59 +0800
Subject: [R-SIG-Finance] getSymbol error to download data from FRED
In-Reply-To: <CA+9EQxsrswNKD+H2kg3GsuV=yH8YQADNSbSMou32m3CLP8B-NA@mail.gmail.com>
References: <008a01ccd653$039619a0$0ac24ce0$@com.sg>
	<CA+9EQxsrswNKD+H2kg3GsuV=yH8YQADNSbSMou32m3CLP8B-NA@mail.gmail.com>
Message-ID: <000301ccd72d$6d2f7a70$478e6f50$@com.sg>

Hi,

I reinstalled R and it still showing the same error. Any other thoughts
please.

Thanks and Best regards,

S.N.V. Krishna

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Sankalp Upadhyay
Sent: Thursday, January 19, 2012 11:33 AM
To: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] getSymbol error to download data from FRED

Hi,

It works fine for me. The error that you got suggests that the data file
could not be parsed properly. Maybe a problem with your R installation? Or
internet access from R? Or default format for date?
The data file it downloads from the fred website only has two columns - a
date and a value. Like this:
DATE,VALUE
1919-01-01,4.8502
1919-02-01,4.6358
1919-03-01,4.5019
...

> library(quantmod)
> getSymbols("INDPRO", src = "FRED")
[1] "INDPRO"
> INDPRO
             INDPRO
1919-01-01   4.8502
1919-02-01   4.6358
1919-03-01   4.5019
1919-04-01   4.5822
1919-05-01   4.6090
....

> sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United
States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] quantmod_0.3-17 TTR_0.21-0      xts_0.8-2       zoo_1.7-6
Defaults_1.1-1

loaded via a namespace (and not attached):
[1] grid_2.14.1    lattice_0.20-0 tools_2.14.1


Regards

On Wed, Jan 18, 2012 at 8:35 PM, SNV Krishna <krishna at primps.com.sg> wrote:

> Hi,
>
>
>
> Could anyone help me with the following error. I did post a similar
message
> in the past, but could'nt get the solution.
>
>
>
> > getSymbols("INDPRO", src = "FRED")
>
> Error in as.POSIXlt.character(x, tz, ...) :
>
>  character string is not in a standard unambiguous format
>
>
>
> > sessionInfo()
>
> R version 2.14.0 (2011-10-31)
>
> Platform: i386-pc-mingw32/i386 (32-bit)
>
>
>
> locale:
>
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
>
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>
>
> [5] LC_TIME=English_United States.1252
>
>
>
> attached base packages:
>
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>
> other attached packages:
>
> [1] quantmod_0.3-17 TTR_0.21-0      xts_0.8-2       zoo_1.7-6
> Defaults_1.1-1
>
>
>
> loaded via a namespace (and not attached):
>
> [1] grid_2.14.0    lattice_0.20-0 tools_2.14.0
>
>
>
> Thanks in advance for the attention and help
>
>
>
> S.N.V. Krishna
>
>
>
>
>
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
--
Sankalp Upadhyay

	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From papa.senyo at yahoo.it  Fri Jan 20 11:19:50 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Fri, 20 Jan 2012 10:19:50 +0000 (GMT)
Subject: [R-SIG-Finance] Comparing Forcasts
Message-ID: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/7f06a38a/attachment.pl>

From papa.senyo at yahoo.it  Fri Jan 20 11:21:54 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Fri, 20 Jan 2012 10:21:54 +0000 (GMT)
Subject: [R-SIG-Finance] : Comparing Forcasts
In-Reply-To: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>
References: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>
Message-ID: <1327054914.70671.YahooMailNeo@web132306.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/31eb2931/attachment.pl>

From zach.mayer at gmail.com  Fri Jan 20 14:15:20 2012
From: zach.mayer at gmail.com (Zachary Mayer)
Date: Fri, 20 Jan 2012 08:15:20 -0500
Subject: [R-SIG-Finance] : Comparing Forcasts
In-Reply-To: <1327054914.70671.YahooMailNeo@web132306.mail.ird.yahoo.com>
References: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>
	<1327054914.70671.YahooMailNeo@web132306.mail.ird.yahoo.com>
Message-ID: <CAEr64e-Ae-iFakZ70=CjCDrZweT7t3Kz-qXbqb5nNGUFaDo+Sg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/09069c00/attachment.pl>

From comtech.usa at gmail.com  Fri Jan 20 16:49:26 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 20 Jan 2012 09:49:26 -0600
Subject: [R-SIG-Finance] question about time-stamp comparison?
Message-ID: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/497270ec/attachment.pl>

From comtech.usa at gmail.com  Fri Jan 20 16:51:47 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 20 Jan 2012 09:51:47 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFafWcyth7cHmhmkBhbySSGqnyFy8DcaXZ+AjP02smeF1Q@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
	<CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
	<CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>
	<CABDUZc9rJW_FQdxKHSOb0+kMuzwq2hUvsELDMuSJ3TMS0jbPow@mail.gmail.com>
	<CAPNjSFafWcyth7cHmhmkBhbySSGqnyFy8DcaXZ+AjP02smeF1Q@mail.gmail.com>
Message-ID: <CAPNjSFYRi9bV+fxe7+9PkrgZSLeHP1VPdXiC4350pnFcaJH-EQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/2990d4b0/attachment.pl>

From michael.weylandt at gmail.com  Fri Jan 20 16:59:17 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 20 Jan 2012 10:59:17 -0500
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
Message-ID: <CAAmySGP31RWDaF=mPDKWDbaAw+U4ZOeihSgDE5twCwUnB7MRdA@mail.gmail.com>

storage.mode(as.POSIXct(123757, origin = "1970-01-01")) # POSIXct
sapply(strptime("1970-01-01 03:43:32.345", format = "%Y-%m-%d
%H:%M:%OS"), storage.mode) #POSIXlt

They are numeric, not character.

Michael Weylandt

On Fri, Jan 20, 2012 at 10:49 AM, Michael <comtech.usa at gmail.com> wrote:
> ?Good morning all!
>
> Just wanted to confirm - how do I compare two date-time stamps in the
> following format?
>
> I tried the following and they seem to work fine...
>
> But I am not so sure whether these comparisons are treated as char strings
> and based on alphabetic ordering, or actually R is smart enough to
> auto-recognize these strings and compare based on calendar ordering?
>
> Or maybe calendar ordering is coincidental with alphabetic ordering? I am
> trying to conceive a counter-example...
>
>
> To make it absolutely correct, maybe I should use
>
>
> strptime(date-time-stamp1, "%Y-%m-%d %H:%M:%OS")
>
> vs.
>
> strptime(date-time-stamp2, "%Y-%m-%d %H:%M:%OS")
>
> ? Will that be definitely correct?
>
> Thanks a lot!
>
>> "2011-09-20 12:01:33.386168"< "2011-09-20 12:01:33.386169"
>
> [1] TRUE
>
>> "2011-09-20 12:01:33.386168"< "2012-09-20 12:01:32.386169"
>
> [1] TRUE
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From brian at braverock.com  Fri Jan 20 17:02:00 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 20 Jan 2012 10:02:00 -0600
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
Message-ID: <1327075320.24988.155.camel@brian-rcg>

On Fri, 2012-01-20 at 09:49 -0600, Michael wrote:
> Good morning all!
> 
> Just wanted to confirm - how do I compare two date-time stamps in the
> following format?

> > "2011-09-20 12:01:33.386168"< "2011-09-20 12:01:33.386169"
> 
> [1] TRUE

You don't tell us what class those timestamps are.

Assuming you're using xts objects for your time series (which you should
be), then the index is POSIXct, and < > = , etc are defined for the
POSIXct class.

It won't care about the string format.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From comtech.usa at gmail.com  Fri Jan 20 17:32:57 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 20 Jan 2012 10:32:57 -0600
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <1327075320.24988.155.camel@brian-rcg>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
	<1327075320.24988.155.camel@brian-rcg>
Message-ID: <CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/33f303d1/attachment.pl>

From comtech.usa at gmail.com  Fri Jan 20 17:35:03 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 20 Jan 2012 10:35:03 -0600
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFYRi9bV+fxe7+9PkrgZSLeHP1VPdXiC4350pnFcaJH-EQ@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
	<CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
	<CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>
	<CABDUZc9rJW_FQdxKHSOb0+kMuzwq2hUvsELDMuSJ3TMS0jbPow@mail.gmail.com>
	<CAPNjSFafWcyth7cHmhmkBhbySSGqnyFy8DcaXZ+AjP02smeF1Q@mail.gmail.com>
	<CAPNjSFYRi9bV+fxe7+9PkrgZSLeHP1VPdXiC4350pnFcaJH-EQ@mail.gmail.com>
Message-ID: <CAPNjSFZa9kB9_mty1rtK7HM_GUR_mpGx=gGfefY2aqRqF=C3XA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/219501ab/attachment.pl>

From michael.weylandt at gmail.com  Fri Jan 20 17:44:11 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 20 Jan 2012 11:44:11 -0500
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
	<1327075320.24988.155.camel@brian-rcg>
	<CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>
Message-ID: <CAAmySGN_oc6RKMz50TqnUO_0wf_pvFeHN09MOAk5DvKcYHzvqg@mail.gmail.com>

I can't immediately come up with an counter-example where lexical
ordering and calendar ordering are different if you have a consistent
amount of digits, but wouldn't it just be easier (and more
computationally efficient) to convert your character to a POSIXct
before doing the comparison?

Or (if you actually read the xts documentation!) there's a (much) better trick:

? `[.xts`
tmp1["::20110920 12:01:33.386168"]

Michael Weylandt

On Fri, Jan 20, 2012 at 11:32 AM, Michael <comtech.usa at gmail.com> wrote:
> These are char strings:
> "2011-09-20 12:01:33.386168"
> In fact,
> I want to do subsetting of xts objects:
> lets say tmp1 is an xts object:
> tmp2 = tmp1[index(tmp1)< "2011-09-20 12:01:33.386168"]
> Will it work?
> Thanks again!
>
> On Fri, Jan 20, 2012 at 10:02 AM, Brian G. Peterson <brian at braverock.com>wrote:
>
>> On Fri, 2012-01-20 at 09:49 -0600, Michael wrote:
>> > Good morning all!
>> >
>> > Just wanted to confirm - how do I compare two date-time stamps in the
>> > following format?
>>
>> > > "2011-09-20 12:01:33.386168"< "2011-09-20 12:01:33.386169"
>> >
>> > [1] TRUE
>>
>> You don't tell us what class those timestamps are.
>>
>> Assuming you're using xts objects for your time series (which you should
>> be), then the index is POSIXct, and < > = , etc are defined for the
>> POSIXct class.
>>
>> It won't care about the string format.
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From michael.weylandt at gmail.com  Fri Jan 20 17:45:51 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 20 Jan 2012 11:45:51 -0500
Subject: [R-SIG-Finance] How do I bin data into 5 min bins and compute
 the medians in the bins?
In-Reply-To: <CAPNjSFZa9kB9_mty1rtK7HM_GUR_mpGx=gGfefY2aqRqF=C3XA@mail.gmail.com>
References: <CAPNjSFZBoB91=-X7NGKUA0jknJfs39qE3Ch6cHvc70c7a8YzCA@mail.gmail.com>
	<CABDUZc91pWT8m0VkOw8Oi-PU+DcWr=efz1E2zSxzyZ3Dp=++sg@mail.gmail.com>
	<CAPNjSFbXEvFpoW6CRsZCOrDa=qM3J3Yd9Yt8syiPSEghchRtBA@mail.gmail.com>
	<CABDUZc81er87hsA3UyHNJk8McDg-FJy7hDKt+pLxSN9t1L9xaQ@mail.gmail.com>
	<CA+xi=qYfpH2if-n-LcqwHmgahV_E_F2cYnDz=iMRkOiK7Fefxg@mail.gmail.com>
	<CAPNjSFYTamrgOoK2e5So7VCkjUzCwwDnxiqXV6y5bfNE4RNL8g@mail.gmail.com>
	<CAPNjSFZJwFSy7FB=ZyJRNJdEDK0M8tFME2cTm=NFzVpZKXVkiA@mail.gmail.com>
	<CABDUZc9rJW_FQdxKHSOb0+kMuzwq2hUvsELDMuSJ3TMS0jbPow@mail.gmail.com>
	<CAPNjSFafWcyth7cHmhmkBhbySSGqnyFy8DcaXZ+AjP02smeF1Q@mail.gmail.com>
	<CAPNjSFYRi9bV+fxe7+9PkrgZSLeHP1VPdXiC4350pnFcaJH-EQ@mail.gmail.com>
	<CAPNjSFZa9kB9_mty1rtK7HM_GUR_mpGx=gGfefY2aqRqF=C3XA@mail.gmail.com>
Message-ID: <CAAmySGMOcdtEcsoD_tzHAJHxf2QE2-GXvAwDtDsLGvRXStACxg@mail.gmail.com>

It's remarkable how often people's R problems are actually Excel problems.

:-)

Michael Weylandt

On Fri, Jan 20, 2012 at 11:35 AM, Michael <comtech.usa at gmail.com> wrote:
> I followed the "period.apply" advice given previously and it worked...
>
> And the write.zoo problem is just an artifact of Excel displaying
> dates/times...
>
> ? Index 17:00.1 49:00.1 00:00.1 03:00.1
>
> On Fri, Jan 20, 2012 at 9:51 AM, Michael <comtech.usa at gmail.com> wrote:
>
>> I finally got it work based on you guys' suggestions... Thanks so much
>> guys!
>>
>>
>> On Thu, Jan 19, 2012 at 2:38 PM, Michael <comtech.usa at gmail.com> wrote:
>>
>>> Okay I can see it displays the .082225 part...
>>>
>>> But when I used:
>>>
>>>
>>> write.zoo
>>>
>>> It doesn't write out the correct DateTimeStamp...
>>>
>>>
>>>
>>> Instead, the csv file has the 1st column:
>>>
>>> ? ?Index 17:00.1 49:00.1 00:00.1 03:00.1
>>>
>>>
>>>
>>>
>>> ? On Thu, Jan 19, 2012 at 2:14 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com
>>> > wrote:
>>>
>>>> It is preserved, just not displayed.
>>>>
>>>> options(digits.secs=6)
>>>>
>>>> HTH
>>>> Jeff
>>>>
>>>> On Thu, Jan 19, 2012 at 1:36 PM, Michael <comtech.usa at gmail.com> wrote:
>>>> > So is there a way to convert into xts object while preserving the
>>>> ".082225"
>>>> > part?
>>>> >
>>>> > Thx
>>>> >
>>>> > On Thu, Jan 19, 2012 at 1:32 PM, Michael <comtech.usa at gmail.com>
>>>> wrote:
>>>> >
>>>> >> Thank you! But it doesn't work...
>>>> >>
>>>> >> >
>>>> >> g1
>>>> >>
>>>> >> [1] 46.00 46.00 46.00 45.75 45.75
>>>> >>
>>>> >>
>>>> >> >
>>>> >> g2
>>>> >>
>>>> >> [1] "2006-06-16 12:12:00.082225" "2006-06-16 12:12:00.082225"
>>>> >>
>>>> >> [3] "2006-06-16 12:12:00.082225" "2006-06-16 12:07:00.082225"
>>>> >>
>>>> >> [5] "2006-06-16 12:12:00.082225"
>>>> >>
>>>> >> It doesn't work:
>>>> >>
>>>> >> g3=xts(g1, order.by=as.POSIXct(strptime(g2, "%Y-%m-%d %H:%M:%OS3")))
>>>> >>
>>>> >> >
>>>> >> g3
>>>> >>
>>>> >> [,1]
>>>> >>
>>>> >> <NA> 46.00
>>>> >>
>>>> >> <NA> 46.00
>>>> >>
>>>> >> <NA> 46.00
>>>> >>
>>>> >> <NA> 45.75
>>>> >>
>>>> >> <NA> 45.75
>>>> >>
>>>> >>
>>>> >>
>>>> >> But the following worked:
>>>> >>
>>>> >> >
>>>> >> g3=xts(g1, order.by=as.POSIXct(strptime(g2, "%Y-%m-%d %H:%M:%OS")))
>>>> >>
>>>> >> >
>>>> >>
>>>> >> >
>>>> >>
>>>> >> >
>>>> >> g3
>>>> >>
>>>> >> [,1]
>>>> >>
>>>> >> 2006-06-16 12:07:00 45.75
>>>> >>
>>>> >> 2006-06-16 12:12:00 46.00
>>>> >>
>>>> >> 2006-06-16 12:12:00 46.00
>>>> >>
>>>> >> 2006-06-16 12:12:00 46.00
>>>> >>
>>>> >> 2006-06-16 12:12:00 45.75
>>>> >>
>>>> >>
>>>> >>
>>>> >> On Thu, Jan 19, 2012 at 1:07 PM, G See <gsee000 at gmail.com> wrote:
>>>> >>
>>>> >>> Michael comtech,
>>>> >>>
>>>> >>> You might also consider reading one of the 2 e-mails that Brian sent
>>>> >>> you on-list in the last month that say to look at
>>>> >>> ?strftime
>>>> >>>
>>>> >>> For example ... the second example on that page
>>>> >>> format(Sys.time(), "%H:%M:%OS3")
>>>> >>>
>>>> >>>
>>>> >>> On Thu, Jan 19, 2012 at 1:01 PM, Jeffrey Ryan <
>>>> jeffrey.ryan at lemnica.com>
>>>> >>> wrote:
>>>> >>> > You should lead with what you have tried, it lets everyone have a
>>>> >>> > better idea of what you are looking for.
>>>> >>> >
>>>> >>> > That said, the .082225 is perfectly acceptable to xts, though
>>>> >>> > precision-wise you are near the limit of floating point precision
>>>> on
>>>> >>> > many platforms. ?The previous post in this thread is on target to
>>>> what
>>>> >>> > you want.
>>>> >>> >
>>>> >>> > Take a good look at ?endpoints and to a lesser extend
>>>> ?period.apply.
>>>> >>> >
>>>> >>> > HTH
>>>> >>> > Jeff
>>>> >>> >
>>>> >>> > On Thu, Jan 19, 2012 at 12:54 PM, Michael <comtech.usa at gmail.com>
>>>> >>> wrote:
>>>> >>> >> I have also searched "crazily"... and read into both "xts" and
>>>> >>> "zoo"... but
>>>> >>> >> couldn't find a solution...
>>>> >>> >>
>>>> >>> >> My questions are:
>>>> >>> >>
>>>> >>> >> 1. How to handle the ".082225" part in "xts" and "zoo"?
>>>> >>> >>
>>>> >>> >> 2. The "xts/zoo" interval arithmatic only handles OHLC of an
>>>> interval,
>>>> >>> not
>>>> >>> >> median of an interval, right?
>>>> >>> >>
>>>> >>> >> Thanks a lot!
>>>> >>> >>
>>>> >>> >> On Thu, Jan 19, 2012 at 12:51 PM, Jeffrey Ryan <
>>>> >>> jeffrey.ryan at lemnica.com>wrote:
>>>> >>> >>
>>>> >>> >>> Use a time series class. ?This has all been solved thousands of
>>>> times
>>>> >>> >>> before in private and on the lists.
>>>> >>> >>>
>>>> >>> >>> Jeff
>>>> >>> >>>
>>>> >>> >>> On Thu, Jan 19, 2012 at 12:43 PM, Michael <comtech.usa at gmail.com
>>>> >
>>>> >>> wrote:
>>>> >>> >>> > Hi all,
>>>> >>> >>> >
>>>> >>> >>> > I have data in the following format:
>>>> >>> >>> >
>>>> >>> >>> > How do I bucket the data into 5 min bins and then compute the
>>>> >>> median of
>>>> >>> >>> > quotes in the bins?
>>>> >>> >>> >
>>>> >>> >>> > Currently the "DateTimeStamps" are "factors" in the data frame
>>>> and I
>>>> >>> >>> > ordered the rows according to these DateTimeStamps
>>>> >>> >>> >
>>>> >>> >>> > Thanks a lot!
>>>> >>> >>> >
>>>> >>> >>> > Bid ? ? ? ? ? Offer ? ? ?DateTimeStamps
>>>> >>> >>> >
>>>> >>> >>> > 46.00 ? ? ? 46.10 ? ? 2006-06-16 12:12:00.082225
>>>> >>> >>> >
>>>> >>> >>> > ? ? ? ?[[alternative HTML version deleted]]
>>>> >>> >>> >
>>>> >>> >>> > _______________________________________________
>>>> >>> >>> > R-SIG-Finance at r-project.org mailing list
>>>> >>> >>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> >>> >>> > -- Subscriber-posting only. If you want to post, subscribe
>>>> first.
>>>> >>> >>> > -- Also note that this is not the r-help list where general R
>>>> >>> questions
>>>> >>> >>> should go.
>>>> >>> >>>
>>>> >>> >>>
>>>> >>> >>>
>>>> >>> >>> --
>>>> >>> >>> Jeffrey Ryan
>>>> >>> >>> jeffrey.ryan at lemnica.com
>>>> >>> >>>
>>>> >>> >>> www.lemnica.com
>>>> >>> >>> www.esotericR.com <http://www.esotericr.com/> <
>>>> http://www.esotericr.com/> <
>>>> >>> http://www.esotericr.com/>
>>>> >>> >>>
>>>> >>> >>
>>>> >>> >> ? ? ? ?[[alternative HTML version deleted]]
>>>> >>> >>
>>>> >>> >> _______________________________________________
>>>> >>> >> R-SIG-Finance at r-project.org mailing list
>>>> >>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> >>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> >>> >> -- Also note that this is not the r-help list where general R
>>>> >>> questions should go.
>>>> >>> >
>>>> >>> >
>>>> >>> >
>>>> >>> > --
>>>> >>> > Jeffrey Ryan
>>>> >>> > jeffrey.ryan at lemnica.com
>>>> >>> >
>>>> >>> > www.lemnica.com
>>>> >>> > www.esotericR.com <http://www.esotericr.com/> <
>>>> http://www.esotericr.com/>
>>>> ?>>> >
>>>> >>> > _______________________________________________
>>>> >>> > R-SIG-Finance at r-project.org mailing list
>>>> >>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> >>> > -- Subscriber-posting only. If you want to post, subscribe first.
>>>> >>> > -- Also note that this is not the r-help list where general R
>>>> questions
>>>> >>> should go.
>>>> >>>
>>>> >>
>>>> >>
>>>> >
>>>> > ? ? ? ?[[alternative HTML version deleted]]
>>>> >
>>>> > _______________________________________________
>>>> > R-SIG-Finance at r-project.org mailing list
>>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> > -- Subscriber-posting only. If you want to post, subscribe first.
>>>> > -- Also note that this is not the r-help list where general R
>>>> questions should go.
>>>>
>>>>
>>>>
>>>> --
>>>> Jeffrey Ryan
>>>> jeffrey.ryan at lemnica.com
>>>>
>>>> www.lemnica.com
>>>> www.esotericR.com <http://www.esotericr.com/>
>>>>
>>>
>>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ezivot at u.washington.edu  Fri Jan 20 20:07:00 2012
From: ezivot at u.washington.edu (Eric Zivot)
Date: Fri, 20 Jan 2012 11:07:00 -0800
Subject: [R-SIG-Finance] : Comparing Forcasts
In-Reply-To: <CAEr64e-Ae-iFakZ70=CjCDrZweT7t3Kz-qXbqb5nNGUFaDo+Sg@mail.gmail.com>
References: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>	<1327054914.70671.YahooMailNeo@web132306.mail.ird.yahoo.com>
	<CAEr64e-Ae-iFakZ70=CjCDrZweT7t3Kz-qXbqb5nNGUFaDo+Sg@mail.gmail.com>
Message-ID: <001201ccd7a6$b04310f0$10c932d0$@washington.edu>

The easiest test of predictive accuracy is the Diebold-Mariano test (see
http://faculty.washington.edu/ezivot/econ584/dieboldMariano.pdf and
http://faculty.washington.edu/ezivot/econ582/econ512forecastevaluationSlides
.pdf ). This can be implemented via simple regression with a standard error
correction for serial correlation (e.g. Newey-West std errors). This theory
for this test is based on known coefficients in your forecasting models and
non-nested models. There have been many improvements to this test over the
years. See the many papers by Todd E. Clark and Michael McCracken and Ken
West. The tests implemented in the ttrTests are in the class of predictive
accuracy tests.


Eric Zivot                  			               
Robert Richards Chaired Professor of Economics and Director of Outreach
Adjunct Professor of Finance                            
Adjunct Professor of Statistics
Adjunct Professor of Applied Mathematics 
Department of Economics
Box 353330                  email:  ezivot at u.washington.edu 
University of Washington    phone:  206-543-6715            
Seattle, WA 98195-3330
www:  http://faculty.washington.edu/ezivot                  



-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Zachary Mayer
Sent: Friday, January 20, 2012 5:15 AM
To: Papa Senyo
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] : Comparing Forcasts

Hi Papa,

I've never used an SPA test, so I don't know if it's implemented in R.
 Could you point to an article describing it, or an implementation in
another language?  One idea would be to compare the MAE of your forecast to
the MAE of a naive forecast (where each value in a time-series is predicted
to be the same as the previous value).

Whatever you do, it's probably a good idea to make your comparisons
out-of-sample, and an even better idea to cross-validate.  You can find
some example code for time series cross-validation here and here:
http://robjhyndman.com/researchtips/tscvexample/
http://moderntoolmaking.blogspot.com/2011/12/time-series-cross-validation-3.
html

-Zach

On Fri, Jan 20, 2012 at 5:21 AM, Papa Senyo <papa.senyo at yahoo.it> wrote:

>
>
>
>
> Dear all,
> Please, I would like to know if the test for superior predictive
> ability(SPA) is implemented in R
>
> Also how can we get the forecast of volatility of return series. Just an
> information, the SPA compares different forecast and the select the best
> performance measure. Can this be done using rugarch as it only reports
MSE,
> MAE, DAC,
> I hope to hearing from you all.
> Kind regards
> Papa
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From comtech.usa at gmail.com  Fri Jan 20 21:17:26 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 20 Jan 2012 14:17:26 -0600
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <CAAmySGN_oc6RKMz50TqnUO_0wf_pvFeHN09MOAk5DvKcYHzvqg@mail.gmail.com>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
	<1327075320.24988.155.camel@brian-rcg>
	<CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>
	<CAAmySGN_oc6RKMz50TqnUO_0wf_pvFeHN09MOAk5DvKcYHzvqg@mail.gmail.com>
Message-ID: <CAPNjSFaKR-aYt62j1HK95XjoCRVWCSU_RaobDPRF=gMuwePRSg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/bfe0bf44/attachment.pl>

From brian at braverock.com  Fri Jan 20 21:30:49 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 20 Jan 2012 14:30:49 -0600
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <CAPNjSFaKR-aYt62j1HK95XjoCRVWCSU_RaobDPRF=gMuwePRSg@mail.gmail.com>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
	<1327075320.24988.155.camel@brian-rcg>
	<CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>
	<CAAmySGN_oc6RKMz50TqnUO_0wf_pvFeHN09MOAk5DvKcYHzvqg@mail.gmail.com>
	<CAPNjSFaKR-aYt62j1HK95XjoCRVWCSU_RaobDPRF=gMuwePRSg@mail.gmail.com>
Message-ID: <1327091449.24988.159.camel@brian-rcg>

On Fri, 2012-01-20 at 14:17 -0600, Michael wrote:
> And what if I am not dealing with xts/zoo objects?

If you are using anything other than xts for micorsecond time series
data, you're doing it wrong.  Period.

Put your data.frame into xts, which will order it automagically, and
makes available all the wonders of xts subsetting.

You can't help reading data into a data.frame at least temporarily
(though read.zoo hides this), but you should get out of the wrong format
and into a real time series format as close to instantly as possible.

-- 
Brian


From michael.weylandt at gmail.com  Fri Jan 20 21:49:59 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 20 Jan 2012 15:49:59 -0500
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <CAPNjSFaKR-aYt62j1HK95XjoCRVWCSU_RaobDPRF=gMuwePRSg@mail.gmail.com>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
	<1327075320.24988.155.camel@brian-rcg>
	<CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>
	<CAAmySGN_oc6RKMz50TqnUO_0wf_pvFeHN09MOAk5DvKcYHzvqg@mail.gmail.com>
	<CAPNjSFaKR-aYt62j1HK95XjoCRVWCSU_RaobDPRF=gMuwePRSg@mail.gmail.com>
Message-ID: <CAAmySGP1evhQg-8NK8fyOt=0stBj3J9YE9+2Xick4pGO6EDuBQ@mail.gmail.com>

In addition to what Brian said:

"But converting to POSIXct I need to supply an origin something like
1970-01-01 which is weird and unintuitive..."

Simply not true...
as.POSIXct("1985-01-01", format = "%Y-%m-%d") # Works just fine

Going out on a limb, it sounds like your troubles are coming from not
understanding what factors are or how they are stored internally in R.

Michael

On Fri, Jan 20, 2012 at 3:17 PM, Michael <comtech.usa at gmail.com> wrote:
> But converting to POSIXct I need to supply an origin something like
> 1970-01-01 which is weird and unintuitive...
>
> And what if I am not dealing with xts/zoo objects?
>
> For example,
>
>
> ss=tt
>
> [with(tt, order(DateTimeStamps)),]
>
>
> where "tt" is a data.frame read from csv file.
>
> My goal was to order the rows of the data.frame based on the DateTimeStamps
> (in the previously discussed formatting)... I found the tt$DateTimeStamps is
> actually "factor" ...
>
> So my question is: ordering them like the one I did above,
>
> is it correct?
>
> Thanks a lot!
>
>
>
>
> On Fri, Jan 20, 2012 at 10:44 AM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>>
>> I can't immediately come up with an counter-example where lexical
>> ordering and calendar ordering are different if you have a consistent
>> amount of digits, but wouldn't it just be easier (and more
>> computationally efficient) to convert your character to a POSIXct
>> before doing the comparison?
>>
>> Or (if you actually read the xts documentation!) there's a (much) better
>> trick:
>>
>> ? `[.xts`
>> tmp1["::20110920 12:01:33.386168"]
>>
>> Michael Weylandt
>>
>> On Fri, Jan 20, 2012 at 11:32 AM, Michael <comtech.usa at gmail.com> wrote:
>> > These are char strings:
>> > "2011-09-20 12:01:33.386168"
>> > In fact,
>> > I want to do subsetting of xts objects:
>> > lets say tmp1 is an xts object:
>> > tmp2 = tmp1[index(tmp1)< "2011-09-20 12:01:33.386168"]
>> > Will it work?
>> > Thanks again!
>> >
>> > On Fri, Jan 20, 2012 at 10:02 AM, Brian G. Peterson
>> > <brian at braverock.com>wrote:
>> >
>> >> On Fri, 2012-01-20 at 09:49 -0600, Michael wrote:
>> >> > Good morning all!
>> >> >
>> >> > Just wanted to confirm - how do I compare two date-time stamps in the
>> >> > following format?
>> >>
>> >> > > "2011-09-20 12:01:33.386168"< "2011-09-20 12:01:33.386169"
>> >> >
>> >> > [1] TRUE
>> >>
>> >> You don't tell us what class those timestamps are.
>> >>
>> >> Assuming you're using xts objects for your time series (which you
>> >> should
>> >> be), then the index is POSIXct, and < > = , etc are defined for the
>> >> POSIXct class.
>> >>
>> >> It won't care about the string format.
>> >>
>> >> --
>> >> Brian G. Peterson
>> >> http://braverock.com/brian/
>> >> Ph: 773-459-4973
>> >> IM: bgpbraverock
>> >>
>> >>
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>
>


From comtech.usa at gmail.com  Fri Jan 20 22:25:36 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 20 Jan 2012 15:25:36 -0600
Subject: [R-SIG-Finance] question about time-stamp comparison?
In-Reply-To: <1327091449.24988.159.camel@brian-rcg>
References: <CAPNjSFYNaNsgfibrWN3x632MtmmAEb8u77Q6_ydxOs-m9y19ig@mail.gmail.com>
	<1327075320.24988.155.camel@brian-rcg>
	<CAPNjSFY4t6wzAkx9mQ2odUX+4zirmg1Ah3sfsM778zaGDtn+eQ@mail.gmail.com>
	<CAAmySGN_oc6RKMz50TqnUO_0wf_pvFeHN09MOAk5DvKcYHzvqg@mail.gmail.com>
	<CAPNjSFaKR-aYt62j1HK95XjoCRVWCSU_RaobDPRF=gMuwePRSg@mail.gmail.com>
	<1327091449.24988.159.camel@brian-rcg>
Message-ID: <CAPNjSFaHkY7V0_+Yws+Tqs=ziwCL17_Sx8sBouOUiWhTZ_uBGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/a53163bd/attachment.pl>

From bennfine at gmail.com  Sat Jan 21 00:17:17 2012
From: bennfine at gmail.com (benn fine)
Date: Fri, 20 Jan 2012 18:17:17 -0500
Subject: [R-SIG-Finance] help with monthlyReturn command
Message-ID: <CALghxgTQ_ZyoKNL7HUQW4eOEoWRDDw00fObFx21JJXd7iisrZQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/20f440c6/attachment.pl>

From bennfine at gmail.com  Sat Jan 21 00:30:53 2012
From: bennfine at gmail.com (benn fine)
Date: Fri, 20 Jan 2012 18:30:53 -0500
Subject: [R-SIG-Finance] Help with monthlyReturn command
Message-ID: <CALghxgR6MCsgrwgXpEKmotU9xJ6sZJ=iboobeJ7TTF2M2EFvRQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/18cdbf5b/attachment.pl>

From josh.m.ulrich at gmail.com  Sat Jan 21 01:11:22 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 20 Jan 2012 18:11:22 -0600
Subject: [R-SIG-Finance] help with monthlyReturn command
In-Reply-To: <CALghxgTQ_ZyoKNL7HUQW4eOEoWRDDw00fObFx21JJXd7iisrZQ@mail.gmail.com>
References: <CALghxgTQ_ZyoKNL7HUQW4eOEoWRDDw00fObFx21JJXd7iisrZQ@mail.gmail.com>
Message-ID: <CAPPM_gTcMwdhCc5=90n7SYyBCi6-4VDurqcXZmafYtwuMBFKNQ@mail.gmail.com>

On Fri, Jan 20, 2012 at 5:17 PM, benn fine <bennfine at gmail.com> wrote:
> I am having trouble figuring out what the monthlyReturn command is doing.
>
> That is, consider SPY
>
> getSymbols("SPY")
>
> I then do monthlyReturn(SPY)
>
> 2011-10-31 ? ? 0.109147150
> 2011-11-30 ? ?-0.004063745
> 2011-12-30 ? ? 0.004080326
> 2012-01-19 ? ? 0.047490040
>
> hmmm. November is negative.....
> On Nov 1, Spy closed at 121.23 (adjusted close)
> On Nov 30, Spy closed at 124.20 (adjusted close)
>
> This gives a return for November of (124.2/121.23)-1 = 2.45%
>
> For October
> Oct 3, SPY = 109.24
> OCT 31, SPY = 124.71
>
> This gives a return for October of (124.71/109.24)-1 = 14.17%
>
> Can anyone please explain the discrepancy? Am I defining monthly returns
> incorrectly?
>
Yes.  You're omitting the return that occurs on the first day of the
month (between 10/31 and 11/1 in your first example).
121.23/124.71-1 = -0.02790474
124.20/124.71-1 = -0.004089488

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


From fin_engr at hotmail.com  Sat Jan 21 01:24:46 2012
From: fin_engr at hotmail.com (financial engineer)
Date: Fri, 20 Jan 2012 19:24:46 -0500
Subject: [R-SIG-Finance] Garch Bootstrap forecast
In-Reply-To: <CAHdfS960y8dj+DOQmOxLk3RJrnT7gJ=TYJGnz4Z=7kX+tKFrEg@mail.gmail.com>
References: <1326904768.71944.YahooMailNeo@web132310.mail.ird.yahoo.com>,
	<CAHdfS960y8dj+DOQmOxLk3RJrnT7gJ=TYJGnz4Z=7kX+tKFrEg@mail.gmail.com>
Message-ID: <COL118-W60176D40CDD107D350FDB0EF840@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120120/836decf1/attachment.pl>

From alexios at 4dscape.com  Sat Jan 21 01:38:39 2012
From: alexios at 4dscape.com (alexios)
Date: Sat, 21 Jan 2012 00:38:39 +0000
Subject: [R-SIG-Finance] : Comparing Forcasts
In-Reply-To: <001201ccd7a6$b04310f0$10c932d0$@washington.edu>
References: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>	<1327054914.70671.YahooMailNeo@web132306.mail.ird.yahoo.com>
	<CAEr64e-Ae-iFakZ70=CjCDrZweT7t3Kz-qXbqb5nNGUFaDo+Sg@mail.gmail.com>
	<001201ccd7a6$b04310f0$10c932d0$@washington.edu>
Message-ID: <4F1A090F.4070108@4dscape.com>

For the SPD test of Hansen you'll need to provide a loss series, which 
means you'll need a measure of realized volatility to compare the vol 
forecast to. Alternative approaches would be to use forecast VaR to 
construct a loss series as in Gonzalez-Rivera, Lee, and Mishra (2004) 
who adopt a loss function used in quantile estimation.

You might find the recent model confidence set (mcs) of Hansen, Lunde 
and Nason (2011)  more suitable.

Forecasts from a ugarchforecast object may be extracted through a number 
of methods including as.data.frame, as.array etc  (read the documentation).

Regards,
Alexios

On 20/01/12 19:07, Eric Zivot wrote:
> The easiest test of predictive accuracy is the Diebold-Mariano test (see
> http://faculty.washington.edu/ezivot/econ584/dieboldMariano.pdf and
> http://faculty.washington.edu/ezivot/econ582/econ512forecastevaluationSlides
> .pdf ). This can be implemented via simple regression with a standard error
> correction for serial correlation (e.g. Newey-West std errors). This theory
> for this test is based on known coefficients in your forecasting models and
> non-nested models. There have been many improvements to this test over the
> years. See the many papers by Todd E. Clark and Michael McCracken and Ken
> West. The tests implemented in the ttrTests are in the class of predictive
> accuracy tests.
>
>
> Eric Zivot                  			
> Robert Richards Chaired Professor of Economics and Director of Outreach
> Adjunct Professor of Finance
> Adjunct Professor of Statistics
> Adjunct Professor of Applied Mathematics
> Department of Economics
> Box 353330                  email:  ezivot at u.washington.edu
> University of Washington    phone:  206-543-6715
> Seattle, WA 98195-3330
> www:  http://faculty.washington.edu/ezivot
>
>
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org
> [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Zachary Mayer
> Sent: Friday, January 20, 2012 5:15 AM
> To: Papa Senyo
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] : Comparing Forcasts
>
> Hi Papa,
>
> I've never used an SPA test, so I don't know if it's implemented in R.
>   Could you point to an article describing it, or an implementation in
> another language?  One idea would be to compare the MAE of your forecast to
> the MAE of a naive forecast (where each value in a time-series is predicted
> to be the same as the previous value).
>
> Whatever you do, it's probably a good idea to make your comparisons
> out-of-sample, and an even better idea to cross-validate.  You can find
> some example code for time series cross-validation here and here:
> http://robjhyndman.com/researchtips/tscvexample/
> http://moderntoolmaking.blogspot.com/2011/12/time-series-cross-validation-3.
> html
>
> -Zach
>
> On Fri, Jan 20, 2012 at 5:21 AM, Papa Senyo<papa.senyo at yahoo.it>  wrote:
>
>>
>>
>>
>> Dear all,
>> Please, I would like to know if the test for superior predictive
>> ability(SPA) is implemented in R
>>
>> Also how can we get the forecast of volatility of return series. Just an
>> information, the SPA compares different forecast and the select the best
>> performance measure. Can this be done using rugarch as it only reports
> MSE,
>> MAE, DAC,
>> I hope to hearing from you all.
>> Kind regards
>> Papa
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Sun Jan 22 01:13:05 2012
From: comtech.usa at gmail.com (Michael)
Date: Sat, 21 Jan 2012 18:13:05 -0600
Subject: [R-SIG-Finance] Removing a row in an xts object in place?
Message-ID: <CAPNjSFakjmYGdrnJWi1mnciDGFhEyxfaYA1DPhnZNWB09v+NWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120121/2c92a8d6/attachment.pl>

From comtech.usa at gmail.com  Sun Jan 22 01:13:43 2012
From: comtech.usa at gmail.com (Michael)
Date: Sat, 21 Jan 2012 18:13:43 -0600
Subject: [R-SIG-Finance] Removing a row in an xts object in place?
In-Reply-To: <CAPNjSFakjmYGdrnJWi1mnciDGFhEyxfaYA1DPhnZNWB09v+NWQ@mail.gmail.com>
References: <CAPNjSFakjmYGdrnJWi1mnciDGFhEyxfaYA1DPhnZNWB09v+NWQ@mail.gmail.com>
Message-ID: <CAPNjSFYde1zapZsfCWPCgbvW6qXsECn9DyV4=5Wi_2UFRtLasA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120121/dcdb2f70/attachment.pl>

From michael.weylandt at gmail.com  Sun Jan 22 03:03:48 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sat, 21 Jan 2012 21:03:48 -0500
Subject: [R-SIG-Finance] Removing a row in an xts object in place?
In-Reply-To: <CAPNjSFYde1zapZsfCWPCgbvW6qXsECn9DyV4=5Wi_2UFRtLasA@mail.gmail.com>
References: <CAPNjSFakjmYGdrnJWi1mnciDGFhEyxfaYA1DPhnZNWB09v+NWQ@mail.gmail.com>
	<CAPNjSFYde1zapZsfCWPCgbvW6qXsECn9DyV4=5Wi_2UFRtLasA@mail.gmail.com>
Message-ID: <CAAmySGOzajkgT_Q7yBSwPEtPj69UDxuW7zx_xtLEjbk4yShFcA@mail.gmail.com>

Short answer: I'm pretty sure it's impossible to remove elements "in place".

Medium answer: If you are worried about memory usage, I might suggest
using the data.table() package. It's pretty efficient for most things,
though you'll loose xts specific time-functionality. You might be able
to wedge time stamps in though smart use of the keys. (I'm not
familiar enough with the package to say for sure.) Pondering aloud,
merging data.table and xts functionalities sounds like an
exceptionally fun project and a new package idea. I might do that when
life gets 80% less busy....

Long answer: it *may* be possible using the .Call() interface and
playing very deeply with the internals (I haven't looked at them
recently enough to say one way or the other) but it's exceptionally
dangerous since R uses copy-on-change semantics. If you are determined
enough, I think I can see a way that it's doable, but it's such a
non-R thing to do that I don't think you'll get much help.

Michael

On Sat, Jan 21, 2012 at 7:13 PM, Michael <comtech.usa at gmail.com> wrote:
> I hope I can do:
>
> x[ !Conditions, ] = NULL
>
> or something like this...
>
> On Sat, Jan 21, 2012 at 6:13 PM, Michael <comtech.usa at gmail.com> wrote:
>
>> Hi all,
>>
>> How do I remove a row in an xts object and the operation has to be in
>> place?
>>
>> I knew I can do
>>
>> y=x[ Conditions, ]
>>
>> where x is the original time series xts object...
>>
>> But if x and y both are huge,
>>
>> this operation can consume a lot of memory...
>>
>> Any thoughts?
>>
>> Thanks a lot!
>>
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Sun Jan 22 05:56:20 2012
From: comtech.usa at gmail.com (Michael)
Date: Sat, 21 Jan 2012 22:56:20 -0600
Subject: [R-SIG-Finance] Removing a row in an xts object in place?
In-Reply-To: <CAAmySGOzajkgT_Q7yBSwPEtPj69UDxuW7zx_xtLEjbk4yShFcA@mail.gmail.com>
References: <CAPNjSFakjmYGdrnJWi1mnciDGFhEyxfaYA1DPhnZNWB09v+NWQ@mail.gmail.com>
	<CAPNjSFYde1zapZsfCWPCgbvW6qXsECn9DyV4=5Wi_2UFRtLasA@mail.gmail.com>
	<CAAmySGOzajkgT_Q7yBSwPEtPj69UDxuW7zx_xtLEjbk4yShFcA@mail.gmail.com>
Message-ID: <CAPNjSFaz8QogOLF8m2F=t=P7Jip_nLyv6-7fmivXpMd7E5Y9rA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120121/0e009aa0/attachment.pl>

From papa.senyo at yahoo.it  Sun Jan 22 11:46:42 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Sun, 22 Jan 2012 10:46:42 +0000 (GMT)
Subject: [R-SIG-Finance] : Comparing Forcasts
In-Reply-To: <001201ccd7a6$b04310f0$10c932d0$@washington.edu>
References: <1327054790.83575.YahooMailNeo@web132304.mail.ird.yahoo.com>
	<1327054914.70671.YahooMailNeo@web132306.mail.ird.yahoo.com>
	<CAEr64e-Ae-iFakZ70=CjCDrZweT7t3Kz-qXbqb5nNGUFaDo+Sg@mail.gmail.com>
	<001201ccd7a6$b04310f0$10c932d0$@washington.edu>
Message-ID: <1327229202.26576.YahooMailNeo@web132304.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120122/1656d93d/attachment.pl>

From papa.senyo at yahoo.it  Sun Jan 22 17:25:11 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Sun, 22 Jan 2012 16:25:11 +0000 (GMT)
Subject: [R-SIG-Finance] Best fit Model
Message-ID: <1327249511.73324.YahooMailNeo@web132302.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120122/8fddff35/attachment.pl>

From fabercastellsince1761 at gmail.com  Mon Jan 23 11:50:15 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Mon, 23 Jan 2012 11:50:15 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <1327012687.24988.146.camel@brian-rcg>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
Message-ID: <CACBLjKS=rwUjhRKnR-=X8J7udJ00+dXe1qo+wZ6setAQ9f+Ahg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/777d5598/attachment.pl>

From papa.senyo at yahoo.it  Mon Jan 23 12:17:49 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Mon, 23 Jan 2012 11:17:49 +0000 (GMT)
Subject: [R-SIG-Finance] Best fit Model
In-Reply-To: <1327249511.73324.YahooMailNeo@web132302.mail.ird.yahoo.com>
References: <1327249511.73324.YahooMailNeo@web132302.mail.ird.yahoo.com>
Message-ID: <1327317469.836.YahooMailNeo@web132304.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/cb732808/attachment.pl>

From comtech.usa at gmail.com  Mon Jan 23 15:06:36 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 23 Jan 2012 08:06:36 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
Message-ID: <CAPNjSFa4RdpZFuGbOkfx9CKcjD=S==voHSLjQ_ckQ+RphhPsfg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/2b718e05/attachment.pl>

From brian at braverock.com  Mon Jan 23 15:25:01 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 23 Jan 2012 08:25:01 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFa4RdpZFuGbOkfx9CKcjD=S==voHSLjQ_ckQ+RphhPsfg@mail.gmail.com>
References: <CAPNjSFa4RdpZFuGbOkfx9CKcjD=S==voHSLjQ_ckQ+RphhPsfg@mail.gmail.com>
Message-ID: <1327328701.24988.162.camel@brian-rcg>

On Mon, 2012-01-23 at 08:06 -0600, Michael wrote:
> I have two xts objects...and they have coulmns with the same names.ie
> their column represent the same variables.
> 
> The only difference is that the values in the rows may be different.
> At
> precisely the same timestamps the observations can be exactly the
> same.
> 
> How do I find the intersection of these two time series ie the rows
> where
> the observations are identical including the time stamps?
> 
> How do I find intersection where a few specified coulmns are identical
> including the time stamps?
> 
> Thanks a lot! 

?merge

?ifelse

merge is amply covered in the xts documentation, and ifelse is covered
in many write-ups on vectorized operations in R.


From junzhu98 at yahoo.com  Mon Jan 23 19:35:53 2012
From: junzhu98 at yahoo.com (Jun Zhu)
Date: Mon, 23 Jan 2012 10:35:53 -0800
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <1327328701.24988.162.camel@brian-rcg>
Message-ID: <1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/13b765ba/attachment.pl>

From jeffrey.ryan at lemnica.com  Mon Jan 23 20:24:44 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 23 Jan 2012 13:24:44 -0600
Subject: [R-SIG-Finance] Removing a row in an xts object in place?
In-Reply-To: <CAAmySGOzajkgT_Q7yBSwPEtPj69UDxuW7zx_xtLEjbk4yShFcA@mail.gmail.com>
References: <CAPNjSFakjmYGdrnJWi1mnciDGFhEyxfaYA1DPhnZNWB09v+NWQ@mail.gmail.com>
	<CAPNjSFYde1zapZsfCWPCgbvW6qXsECn9DyV4=5Wi_2UFRtLasA@mail.gmail.com>
	<CAAmySGOzajkgT_Q7yBSwPEtPj69UDxuW7zx_xtLEjbk4yShFcA@mail.gmail.com>
Message-ID: <CABDUZc_E4XE4tzyxXM=WEw6J4GvEGKmP_=3ofs530i6JhV7bHQ@mail.gmail.com>

On Sat, Jan 21, 2012 at 8:03 PM, R. Michael Weylandt
<michael.weylandt at gmail.com> wrote:
> Short answer: I'm pretty sure it's impossible to remove elements "in place".

Not impossible, just not likely ;-)

>
> Medium answer: If you are worried about memory usage, I might suggest
> using the data.table() package. It's pretty efficient for most things,
> though you'll loose xts specific time-functionality. You might be able
> to wedge time stamps in though smart use of the keys. (I'm not
> familiar enough with the package to say for sure.) Pondering aloud,
> merging data.table and xts functionalities sounds like an
> exceptionally fun project and a new package idea. I might do that when
> life gets 80% less busy....

The indexing/mmap package (by me) is an aim at this.  data.table,
while a stellar replacement for an in-memory db (and data.frames),
isn't going to save you anything here.  What you need to do is keep
things _out of core_, search on disk and then pull in what you need.
(this is what indexing project does).

>
> Long answer: it *may* be possible using the .Call() interface and
> playing very deeply with the internals (I haven't looked at them
> recently enough to say one way or the other) but it's exceptionally
> dangerous since R uses copy-on-change semantics. If you are determined
> enough, I think I can see a way that it's doable, but it's such a
> non-R thing to do that I don't think you'll get much help.

The only thing that could be done here differently in the belly of xts
would be to assign back to the object that is passed in.  I think
"eek" is how some of R-core would respond to that proposal.  Of
course, that doesn't mean it isn't done in some 'non-published' code
from time to time ;-)

Jeff
>
> Michael
>
> On Sat, Jan 21, 2012 at 7:13 PM, Michael <comtech.usa at gmail.com> wrote:
>> I hope I can do:
>>
>> x[ !Conditions, ] = NULL
>>
>> or something like this...
>>
>> On Sat, Jan 21, 2012 at 6:13 PM, Michael <comtech.usa at gmail.com> wrote:
>>
>>> Hi all,
>>>
>>> How do I remove a row in an xts object and the operation has to be in
>>> place?
>>>
>>> I knew I can do
>>>
>>> y=x[ Conditions, ]
>>>
>>> where x is the original time series xts object...
>>>
>>> But if x and y both are huge,
>>>
>>> this operation can consume a lot of memory...
>>>
>>> Any thoughts?
>>>
>>> Thanks a lot!
>>>
>>>
>>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com


From comtech.usa at gmail.com  Tue Jan 24 00:00:51 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 23 Jan 2012 17:00:51 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
Message-ID: <CAPNjSFZ=8o4oxHzG0YCFb2GTHhHQ=JnK78ivpn8PnOiyTKJuXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/ac7a8a83/attachment.pl>

From comtech.usa at gmail.com  Tue Jan 24 00:53:58 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 23 Jan 2012 17:53:58 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
Message-ID: <CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/15072dd1/attachment.pl>

From brian at braverock.com  Tue Jan 24 01:47:11 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 23 Jan 2012 18:47:11 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
Message-ID: <1327366031.4697.3.camel@brian-desktop>

I will repeat my earlier advice:

?merge




On Mon, 2012-01-23 at 17:53 -0600, Michael wrote:
> Oh I forgot one thing:
> 
> xts_one and xts_two are not neccessarily the same length...
> 
> In effect, I was looking for a time series set-operation "intersect"....
> 
> Thank you!
> 
> On Mon, Jan 23, 2012 at 12:35 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
> 
> >   Assume you are testing the first column
> >
> > l_result <- ifelse(l_xts_one[,1] == l_xts_two[,1], l_xts_one[,1],NA)
> >
> >
> >
> >
> > --- On *Mon, 1/23/12, Brian G. Peterson <brian at braverock.com>* wrote:
> >
> >
> > From: Brian G. Peterson <brian at braverock.com>
> > Subject: Re: [R-SIG-Finance] How do I intersecttwo time series?
> > To: "Michael" <comtech.usa at gmail.com>
> > Cc: "r-sig-finance" <r-sig-finance at stat.math.ethz.ch>
> > Date: Monday, January 23, 2012, 8:25 AM
> >
> >   On Mon, 2012-01-23 at 08:06 -0600, Michael wrote:
> > > I have two xts objects...and they have coulmns with the same names.ie
> > > their column represent the same variables.
> > >
> > > The only difference is that the values in the rows may be different.
> > > At
> > > precisely the same timestamps the observations can be exactly the
> > > same.
> > >
> > > How do I find the intersection of these two time series ie the rows
> > > where
> > > the observations are identical including the time stamps?
> > >
> > > How do I find intersection where a few specified coulmns are identical
> > > including the time stamps?
> > >
> > > Thanks a lot!
> >
> > ?merge
> >
> > ?ifelse
> >
> > merge is amply covered in the xts documentation, and ifelse is covered
> > in many write-ups on vectorized operations in R.
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org<http://mc/compose?to=R-SIG-Finance at r-project.org>mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> >
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From comtech.usa at gmail.com  Tue Jan 24 01:58:37 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 23 Jan 2012 18:58:37 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <1327366031.4697.3.camel@brian-desktop>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
	<1327366031.4697.3.camel@brian-desktop>
Message-ID: <CAPNjSFaFY9PAn=t4D4EgCjEdjxVGDjNU3n9vTECHHFUOPUnzsQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/7dff6b6d/attachment.pl>

From brian at braverock.com  Tue Jan 24 02:02:36 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 23 Jan 2012 19:02:36 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFaFY9PAn=t4D4EgCjEdjxVGDjNU3n9vTECHHFUOPUnzsQ@mail.gmail.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
	<1327366031.4697.3.camel@brian-desktop>
	<CAPNjSFaFY9PAn=t4D4EgCjEdjxVGDjNU3n9vTECHHFUOPUnzsQ@mail.gmail.com>
Message-ID: <1327366956.4697.5.camel@brian-desktop>

On Mon, 2012-01-23 at 18:58 -0600, Michael wrote:
> Yes, but merge creates a bunch of "NA"s ... and we are not merging but
> doing "intersections"?   I cannot seem to find a way to use "merge" to
> do "intersections"...   I have searched/googled numerous times...
> Maybe there is something I am missing and a trick? 

Those NA's exist because one series has a timestamp and the other
doesn't.  Normally, that's what you want.

na.omit(merge(x,y))


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jeff.a.ryan at gmail.com  Tue Jan 24 03:32:27 2012
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 23 Jan 2012 20:32:27 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <1327366956.4697.5.camel@brian-desktop>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
	<1327366031.4697.3.camel@brian-desktop>
	<CAPNjSFaFY9PAn=t4D4EgCjEdjxVGDjNU3n9vTECHHFUOPUnzsQ@mail.gmail.com>
	<1327366956.4697.5.camel@brian-desktop>
Message-ID: <E5A8E470-B5BA-45F9-A13F-0273A7506E8D@gmail.com>

Try:

?merge.xts

You want join="inner" if I have been following this. 

Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Jan 23, 2012, at 7:02 PM, "Brian G. Peterson" <brian at braverock.com> wrote:

> On Mon, 2012-01-23 at 18:58 -0600, Michael wrote:
>> Yes, but merge creates a bunch of "NA"s ... and we are not merging but
>> doing "intersections"?   I cannot seem to find a way to use "merge" to
>> do "intersections"...   I have searched/googled numerous times...
>> Maybe there is something I am missing and a trick? 
> 
> Those NA's exist because one series has a timestamp and the other
> doesn't.  Normally, that's what you want.
> 
> na.omit(merge(x,y))
> 
> 
> -- 
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From junzhu98 at yahoo.com  Tue Jan 24 04:07:12 2012
From: junzhu98 at yahoo.com (Jun Zhu)
Date: Mon, 23 Jan 2012 19:07:12 -0800
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
Message-ID: <1327374432.87663.YahooMailClassic@web30607.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/8223d228/attachment.pl>

From junzhu98 at yahoo.com  Tue Jan 24 04:38:01 2012
From: junzhu98 at yahoo.com (Jun Zhu)
Date: Mon, 23 Jan 2012 19:38:01 -0800
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFaFY9PAn=t4D4EgCjEdjxVGDjNU3n9vTECHHFUOPUnzsQ@mail.gmail.com>
Message-ID: <1327376281.80700.YahooMailClassic@web30603.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120123/1a9192e2/attachment.pl>

From gsee000 at gmail.com  Tue Jan 24 09:53:57 2012
From: gsee000 at gmail.com (G See)
Date: Tue, 24 Jan 2012 02:53:57 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
Message-ID: <CA+xi=qb+TPhxgt=yE689S0qB1YUL2yG8f8h4UabQ+YP6p513EQ@mail.gmail.com>

Michael,

Maybe you do not realize that when someone writes a word with a
question mark in front of it, it means that you should look at the
help page for that function. ?For example, if you type "?merge" in an
R terminal (without the quotes) it will open the help page for that
function. ?Another option is to type help(merge)

Hope this makes it easier for you to find answers in the future,
Garrett

On Mon, Jan 23, 2012 at 5:53 PM, Michael <comtech.usa at gmail.com> wrote:
> Oh I forgot one thing:
>
> xts_one and xts_two are not neccessarily the same length...
>
> In effect, I was looking for a time series set-operation "intersect"....
>
> Thank you!
>
> On Mon, Jan 23, 2012 at 12:35 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
>
>> ? Assume you are testing the first column
>>
>> l_result <- ifelse(l_xts_one[,1] == l_xts_two[,1], l_xts_one[,1],NA)
>>
>>
>>
>>
>> --- On *Mon, 1/23/12, Brian G. Peterson <brian at braverock.com>* wrote:
>>
>>
>> From: Brian G. Peterson <brian at braverock.com>
>> Subject: Re: [R-SIG-Finance] How do I intersecttwo time series?
>> To: "Michael" <comtech.usa at gmail.com>
>> Cc: "r-sig-finance" <r-sig-finance at stat.math.ethz.ch>
>> Date: Monday, January 23, 2012, 8:25 AM
>>
>> ? On Mon, 2012-01-23 at 08:06 -0600, Michael wrote:
>> > I have two xts objects...and they have coulmns with the same names.ie
>> > their column represent the same variables.
>> >
>> > The only difference is that the values in the rows may be different.
>> > At
>> > precisely the same timestamps the observations can be exactly the
>> > same.
>> >
>> > How do I find the intersection of these two time series ie the rows
>> > where
>> > the observations are identical including the time stamps?
>> >
>> > How do I find intersection where a few specified coulmns are identical
>> > including the time stamps?
>> >
>> > Thanks a lot!
>>
>> ?merge
>>
>> ?ifelse
>>
>> merge is amply covered in the xts documentation, and ifelse is covered
>> in many write-ups on vectorized operations in R.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org<http://mc/compose?to=R-SIG-Finance at r-project.org>mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From twmeggs at gmail.com  Tue Jan 24 13:20:24 2012
From: twmeggs at gmail.com (Tim Meggs)
Date: Tue, 24 Jan 2012 04:20:24 -0800 (PST)
Subject: [R-SIG-Finance] Quantstrat - Error while applying strategy
In-Reply-To: <1303733217149-3473009.post@n4.nabble.com>
References: <1303695984905-3472438.post@n4.nabble.com>
	<1303733217149-3473009.post@n4.nabble.com>
Message-ID: <1327407624493-4323625.post@n4.nabble.com>

Hi Soren, 
Your example below also helped me, as I have been trying return a vector
from a custom indicator function I have built.
Could you explain the use of the variable "i" that is given as an argument
in the internal fucntion .randPos you define below? What part of the
function provides "i"?  Is this somehow linked to the internal control flow
of the sapply you invoke later?
Thank you in advance.
Tim

--
View this message in context: http://r.789695.n4.nabble.com/Quantstrat-Error-while-applying-strategy-tp3472438p4323625.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From comtech.usa at gmail.com  Tue Jan 24 15:55:23 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 24 Jan 2012 08:55:23 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CA+xi=qb+TPhxgt=yE689S0qB1YUL2yG8f8h4UabQ+YP6p513EQ@mail.gmail.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
	<CA+xi=qb+TPhxgt=yE689S0qB1YUL2yG8f8h4UabQ+YP6p513EQ@mail.gmail.com>
Message-ID: <CAPNjSFY+0NYwURb48QbvJs82v07-y183x983SPQ+05uxGi4f1Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120124/952ceb51/attachment.pl>

From gsee000 at gmail.com  Tue Jan 24 16:10:02 2012
From: gsee000 at gmail.com (G See)
Date: Tue, 24 Jan 2012 09:10:02 -0600
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CAPNjSFY+0NYwURb48QbvJs82v07-y183x983SPQ+05uxGi4f1Q@mail.gmail.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
	<CA+xi=qb+TPhxgt=yE689S0qB1YUL2yG8f8h4UabQ+YP6p513EQ@mail.gmail.com>
	<CAPNjSFY+0NYwURb48QbvJs82v07-y183x983SPQ+05uxGi4f1Q@mail.gmail.com>
Message-ID: <CA+xi=qYFaNKjpTnY_BgG=BBe8fFs6GtCQRdOvAKa4U5GWfZVfw@mail.gmail.com>

Well, it was just a guess since it seemed as if you didn't try it.
Maybe next time you could show us what you tried and why it didn't do
what you wanted.  Then, provide a sample dataset and desired outcome.
Those types of questions are much easier for us to answer, which is
why it is suggested here: http://www.r-project.org/posting-guide.html

Thanks for your understanding,
Garrett

On Tue, Jan 24, 2012 at 8:55 AM, Michael <comtech.usa at gmail.com> wrote:
> Hi G See,
>
> Thanks but I have been watching "?merge" hundreds of times...
>
> It's very terse and there are lots of hidden tricks...
>
> Thanks a lot any way!
>
> And thanks a lot for all the help folks!
>
> On Tue, Jan 24, 2012 at 2:53 AM, G See <gsee000 at gmail.com> wrote:
>>
>> Michael,
>>
>> Maybe you do not realize that when someone writes a word with a
>> question mark in front of it, it means that you should look at the
>> help page for that function. ?For example, if you type "?merge" in an
>> R terminal (without the quotes) it will open the help page for that
>> function. ?Another option is to type help(merge)
>>
>> Hope this makes it easier for you to find answers in the future,
>> Garrett
>>
>> On Mon, Jan 23, 2012 at 5:53 PM, Michael <comtech.usa at gmail.com> wrote:
>> > Oh I forgot one thing:
>> >
>> > xts_one and xts_two are not neccessarily the same length...
>> >
>> > In effect, I was looking for a time series set-operation "intersect"....
>> >
>> > Thank you!
>> >
>> > On Mon, Jan 23, 2012 at 12:35 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
>> >
>> >> ? Assume you are testing the first column
>> >>
>> >> l_result <- ifelse(l_xts_one[,1] == l_xts_two[,1], l_xts_one[,1],NA)
>> >>
>> >>
>> >>
>> >>
>> >> --- On *Mon, 1/23/12, Brian G. Peterson <brian at braverock.com>* wrote:
>> >>
>> >>
>> >> From: Brian G. Peterson <brian at braverock.com>
>> >> Subject: Re: [R-SIG-Finance] How do I intersecttwo time series?
>> >> To: "Michael" <comtech.usa at gmail.com>
>> >> Cc: "r-sig-finance" <r-sig-finance at stat.math.ethz.ch>
>> >> Date: Monday, January 23, 2012, 8:25 AM
>> >>
>> >> ? On Mon, 2012-01-23 at 08:06 -0600, Michael wrote:
>> >> > I have two xts objects...and they have coulmns with the same names.ie
>> >> > their column represent the same variables.
>> >> >
>> >> > The only difference is that the values in the rows may be different.
>> >> > At
>> >> > precisely the same timestamps the observations can be exactly the
>> >> > same.
>> >> >
>> >> > How do I find the intersection of these two time series ie the rows
>> >> > where
>> >> > the observations are identical including the time stamps?
>> >> >
>> >> > How do I find intersection where a few specified coulmns are
>> >> > identical
>> >> > including the time stamps?
>> >> >
>> >> > Thanks a lot!
>> >>
>> >> ?merge
>> >>
>> >> ?ifelse
>> >>
>> >> merge is amply covered in the xts documentation, and ifelse is covered
>> >> in many write-ups on vectorized operations in R.
>> >>
>> >> _______________________________________________
>> >>
>> >> R-SIG-Finance at r-project.org<http://mc/compose?to=R-SIG-Finance at r-project.org>mailing
>> >> list
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>> >> -- Also note that this is not the r-help list where general R questions
>> >> should go.
>> >>
>> >>
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>
>


From michael.weylandt at gmail.com  Tue Jan 24 16:23:04 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Tue, 24 Jan 2012 10:23:04 -0500
Subject: [R-SIG-Finance] How do I intersecttwo time series?
In-Reply-To: <CA+xi=qYFaNKjpTnY_BgG=BBe8fFs6GtCQRdOvAKa4U5GWfZVfw@mail.gmail.com>
References: <1327328701.24988.162.camel@brian-rcg>
	<1327343753.97646.YahooMailClassic@web30606.mail.mud.yahoo.com>
	<CAPNjSFYOer=Ou7FOjaCVzUgYpk3VYNw3Z0ps2f-k5DVZahmdDQ@mail.gmail.com>
	<CA+xi=qb+TPhxgt=yE689S0qB1YUL2yG8f8h4UabQ+YP6p513EQ@mail.gmail.com>
	<CAPNjSFY+0NYwURb48QbvJs82v07-y183x983SPQ+05uxGi4f1Q@mail.gmail.com>
	<CA+xi=qYFaNKjpTnY_BgG=BBe8fFs6GtCQRdOvAKa4U5GWfZVfw@mail.gmail.com>
Message-ID: <CAAmySGNsNfFisb2xSwMv7DZv8gNGCjZGt8-yDpP8n_fceHfeOw@mail.gmail.com>

The OP's confusion might also stem from the fact that

?merge

doesn't actually lead to

 ?merge.xts

which would have been much more helpful here.

I think it's a suboptimal consequence of method dispatch that there
are no pointers to documented methods...I'll try to work up a small
patch to `?` and put it on Rd to see if it gets any traction.

Perhaps something like

> ?merge # pops up merge's help page, but also cat()s
There are documented methods for:
merge.xts
merge.dendrogram
merge.zoo
You may wish to check these as well.

Or something like that. Feel free to send me thoughts off-list

Michael

On Tue, Jan 24, 2012 at 10:10 AM, G See <gsee000 at gmail.com> wrote:
> Well, it was just a guess since it seemed as if you didn't try it.
> Maybe next time you could show us what you tried and why it didn't do
> what you wanted. ?Then, provide a sample dataset and desired outcome.
> Those types of questions are much easier for us to answer, which is
> why it is suggested here: http://www.r-project.org/posting-guide.html
>
> Thanks for your understanding,
> Garrett
>
> On Tue, Jan 24, 2012 at 8:55 AM, Michael <comtech.usa at gmail.com> wrote:
>> Hi G See,
>>
>> Thanks but I have been watching "?merge" hundreds of times...
>>
>> It's very terse and there are lots of hidden tricks...
>>
>> Thanks a lot any way!
>>
>> And thanks a lot for all the help folks!
>>
>> On Tue, Jan 24, 2012 at 2:53 AM, G See <gsee000 at gmail.com> wrote:
>>>
>>> Michael,
>>>
>>> Maybe you do not realize that when someone writes a word with a
>>> question mark in front of it, it means that you should look at the
>>> help page for that function. ?For example, if you type "?merge" in an
>>> R terminal (without the quotes) it will open the help page for that
>>> function. ?Another option is to type help(merge)
>>>
>>> Hope this makes it easier for you to find answers in the future,
>>> Garrett
>>>
>>> On Mon, Jan 23, 2012 at 5:53 PM, Michael <comtech.usa at gmail.com> wrote:
>>> > Oh I forgot one thing:
>>> >
>>> > xts_one and xts_two are not neccessarily the same length...
>>> >
>>> > In effect, I was looking for a time series set-operation "intersect"....
>>> >
>>> > Thank you!
>>> >
>>> > On Mon, Jan 23, 2012 at 12:35 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
>>> >
>>> >> ? Assume you are testing the first column
>>> >>
>>> >> l_result <- ifelse(l_xts_one[,1] == l_xts_two[,1], l_xts_one[,1],NA)
>>> >>
>>> >>
>>> >>
>>> >>
>>> >> --- On *Mon, 1/23/12, Brian G. Peterson <brian at braverock.com>* wrote:
>>> >>
>>> >>
>>> >> From: Brian G. Peterson <brian at braverock.com>
>>> >> Subject: Re: [R-SIG-Finance] How do I intersecttwo time series?
>>> >> To: "Michael" <comtech.usa at gmail.com>
>>> >> Cc: "r-sig-finance" <r-sig-finance at stat.math.ethz.ch>
>>> >> Date: Monday, January 23, 2012, 8:25 AM
>>> >>
>>> >> ? On Mon, 2012-01-23 at 08:06 -0600, Michael wrote:
>>> >> > I have two xts objects...and they have coulmns with the same names.ie
>>> >> > their column represent the same variables.
>>> >> >
>>> >> > The only difference is that the values in the rows may be different.
>>> >> > At
>>> >> > precisely the same timestamps the observations can be exactly the
>>> >> > same.
>>> >> >
>>> >> > How do I find the intersection of these two time series ie the rows
>>> >> > where
>>> >> > the observations are identical including the time stamps?
>>> >> >
>>> >> > How do I find intersection where a few specified coulmns are
>>> >> > identical
>>> >> > including the time stamps?
>>> >> >
>>> >> > Thanks a lot!
>>> >>
>>> >> ?merge
>>> >>
>>> >> ?ifelse
>>> >>
>>> >> merge is amply covered in the xts documentation, and ifelse is covered
>>> >> in many write-ups on vectorized operations in R.
>>> >>
>>> >> _______________________________________________
>>> >>
>>> >> R-SIG-Finance at r-project.org<http://mc/compose?to=R-SIG-Finance at r-project.org>mailing
>>> >> list
>>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>>> >> -- Also note that this is not the r-help list where general R questions
>>> >> should go.
>>> >>
>>> >>
>>> >
>>> > ? ? ? ?[[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-SIG-Finance at r-project.org mailing list
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> > -- Subscriber-posting only. If you want to post, subscribe first.
>>> > -- Also note that this is not the r-help list where general R questions
>>> > should go.
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Tue Jan 24 17:44:38 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 24 Jan 2012 10:44:38 -0600
Subject: [R-SIG-Finance] Questions about high frequency data and overnight
	jumps...
Message-ID: <CAPNjSFaxRK-k7wFM6dsGwYRTsEBSibwYemY+=4wGBvzhh0uMZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120124/0eacda6c/attachment.pl>

From twmeggs at gmail.com  Tue Jan 24 17:59:21 2012
From: twmeggs at gmail.com (Tim Meggs)
Date: Tue, 24 Jan 2012 16:59:21 +0000
Subject: [R-SIG-Finance] custom indicator that returns results of backtest
	on subset of data
Message-ID: <0BCDB4B5-6B8E-4838-8A8C-334767F4CABD@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120124/6e87d918/attachment.pl>

From drseergio at gmail.com  Tue Jan 24 23:02:38 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Tue, 24 Jan 2012 23:02:38 +0100
Subject: [R-SIG-Finance] quantmod getSymbols executes MySQL queries without
 escaping symbol/ticker data
Message-ID: <CAEGu7FvhPnUJm1GibUbHo+zvCkhB7BLg2VC0zjW3E5sbw5drWQ@mail.gmail.com>

Hi fellow R programmers,

I am using quantmod to retrieve historic price data for a range of
stocks. The issue is that the program fails at certain points because
apparently the values that are sent to MySQL are not escaped properly
when quantmod executes sql queries. For example, following stocks will
cause issues: "ABV.C" (because of dot MySQL will think we are trying
to access table C), "ALL" (MySQL thinks this is a reserved sequence).

Here's the code I have:

# code omitted
..
tickers <- dbListTables(con)  # con is connection to MySQL db where
tables with stock data exist

for (ticker in tickers) {
  bars <- getSymbols(ticker, src="MySQL", auto.assign=FALSE)  # it
fails here when data contains special characters
}

Is this expected behavior and is there something I can do about it?

I have tried using "try" and "tryCatch" but the execution breaks anyway.

/Sergey


From drseergio at gmail.com  Wed Jan 25 07:02:46 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 25 Jan 2012 07:02:46 +0100
Subject: [R-SIG-Finance] quantmod getSymbols executes MySQL queries
 without escaping symbol/ticker data
In-Reply-To: <CAEGu7FsB2aUD4JZFpp=zbF8MLP2xMn5qCxpGeEUVQOSbUqvZ_A@mail.gmail.com>
References: <CAEGu7FvhPnUJm1GibUbHo+zvCkhB7BLg2VC0zjW3E5sbw5drWQ@mail.gmail.com>
	<CAEGu7FsB2aUD4JZFpp=zbF8MLP2xMn5qCxpGeEUVQOSbUqvZ_A@mail.gmail.com>
Message-ID: <CAEGu7FszZ6SdUoiwVEB62WBQwLUdex_XkOspOGfNFHrG=0hBhg@mail.gmail.com>

Hi,

For anyone interested here's the change (it's a trivial fix) for getSymbols.R:

357c357
<             query <- paste("SELECT
",paste(db.fields,collapse=','),paste(" FROM `",Symbols[[i]],"`",
sep='')," ORDER BY date")
---
>             query <- paste("SELECT ",paste(db.fields,collapse=',')," FROM ",Symbols[[i]]," ORDER BY date")

Works fine afterwards.

/Sergey

On Wed, Jan 25, 2012 at 6:38 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi,
>
> I have opened the source of getSymbols.R and indeed there is no
> escaping going on. I will modify the source and add escaping. I will
> then test and submit a patch.
>
> /Sergey
>
> On Tue, Jan 24, 2012 at 11:02 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Hi fellow R programmers,
>>
>> I am using quantmod to retrieve historic price data for a range of
>> stocks. The issue is that the program fails at certain points because
>> apparently the values that are sent to MySQL are not escaped properly
>> when quantmod executes sql queries. For example, following stocks will
>> cause issues: "ABV.C" (because of dot MySQL will think we are trying
>> to access table C), "ALL" (MySQL thinks this is a reserved sequence).
>>
>> Here's the code I have:
>>
>> # code omitted
>> ..
>> tickers <- dbListTables(con) ?# con is connection to MySQL db where
>> tables with stock data exist
>>
>> for (ticker in tickers) {
>> ?bars <- getSymbols(ticker, src="MySQL", auto.assign=FALSE) ?# it
>> fails here when data contains special characters
>> }
>>
>> Is this expected behavior and is there something I can do about it?
>>
>> I have tried using "try" and "tryCatch" but the execution breaks anyway.
>>
>> /Sergey


From drseergio at gmail.com  Wed Jan 25 06:38:54 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 25 Jan 2012 06:38:54 +0100
Subject: [R-SIG-Finance] quantmod getSymbols executes MySQL queries
 without escaping symbol/ticker data
In-Reply-To: <CAEGu7FvhPnUJm1GibUbHo+zvCkhB7BLg2VC0zjW3E5sbw5drWQ@mail.gmail.com>
References: <CAEGu7FvhPnUJm1GibUbHo+zvCkhB7BLg2VC0zjW3E5sbw5drWQ@mail.gmail.com>
Message-ID: <CAEGu7FsB2aUD4JZFpp=zbF8MLP2xMn5qCxpGeEUVQOSbUqvZ_A@mail.gmail.com>

Hi,

I have opened the source of getSymbols.R and indeed there is no
escaping going on. I will modify the source and add escaping. I will
then test and submit a patch.

/Sergey

On Tue, Jan 24, 2012 at 11:02 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi fellow R programmers,
>
> I am using quantmod to retrieve historic price data for a range of
> stocks. The issue is that the program fails at certain points because
> apparently the values that are sent to MySQL are not escaped properly
> when quantmod executes sql queries. For example, following stocks will
> cause issues: "ABV.C" (because of dot MySQL will think we are trying
> to access table C), "ALL" (MySQL thinks this is a reserved sequence).
>
> Here's the code I have:
>
> # code omitted
> ..
> tickers <- dbListTables(con) ?# con is connection to MySQL db where
> tables with stock data exist
>
> for (ticker in tickers) {
> ?bars <- getSymbols(ticker, src="MySQL", auto.assign=FALSE) ?# it
> fails here when data contains special characters
> }
>
> Is this expected behavior and is there something I can do about it?
>
> I have tried using "try" and "tryCatch" but the execution breaks anyway.
>
> /Sergey


From me at censix.com  Wed Jan 25 10:00:55 2012
From: me at censix.com (soren wilkening)
Date: Wed, 25 Jan 2012 01:00:55 -0800 (PST)
Subject: [R-SIG-Finance] Quantstrat - Error while applying strategy
In-Reply-To: <1327407624493-4323625.post@n4.nabble.com>
References: <1303695984905-3472438.post@n4.nabble.com>
	<1303733217149-3473009.post@n4.nabble.com>
	<1327407624493-4323625.post@n4.nabble.com>
Message-ID: <1327482055007-4326718.post@n4.nabble.com>

Hi

what the randPos() function does is apply the .randPos() function
"nrow(x)" times so the result is a vector of the same length as x. Of
that result, only the last value is used in the strategy, i think. All
the results are the same. so "i" is just a counter that the 'sapply'
function needs. It does not do anything else.

Looking at it agin now, I am thinking that this is a particularly ugly
way of doing this. maybe just use "rep" instead of "sapply".

see ?rep and ?sapply


-----
http://censix.com
--
View this message in context: http://r.789695.n4.nabble.com/Quantstrat-Error-while-applying-strategy-tp3472438p4326718.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From twmeggs at gmail.com  Wed Jan 25 10:36:17 2012
From: twmeggs at gmail.com (Tim Meggs)
Date: Wed, 25 Jan 2012 09:36:17 +0000
Subject: [R-SIG-Finance] custom indicator that returns results of
	backtest on subset of data
In-Reply-To: <0BCDB4B5-6B8E-4838-8A8C-334767F4CABD@gmail.com>
References: <0BCDB4B5-6B8E-4838-8A8C-334767F4CABD@gmail.com>
Message-ID: <519FD18C-CF62-49BD-9E8A-C33BC5296CBD@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120125/dad34b59/attachment.pl>

From yuanhangw.sg at gmail.com  Thu Jan 26 15:58:34 2012
From: yuanhangw.sg at gmail.com (Yuanhang Wang)
Date: Thu, 26 Jan 2012 22:58:34 +0800
Subject: [R-SIG-Finance] How to make quantstrat demo work with intraday data
Message-ID: <CAJ_D839qwpR2Cp=aSTj-9me=Pt3ygvyqo-YfUT+1fW9-wP0_7A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120126/63466e66/attachment.pl>

From sune.gaulsh at barclayscapital.com  Thu Jan 26 19:03:02 2012
From: sune.gaulsh at barclayscapital.com (Sune Gaulsh)
Date: Thu, 26 Jan 2012 10:03:02 -0800 (PST)
Subject: [R-SIG-Finance] RBloomberg update on "Error in dimnames(x) <-
 dn : 'dimnames' applied to non-array"
In-Reply-To: <1311090762818-3678480.post@n4.nabble.com>
References: <CAJOva6FDMY9ik=QT4MZ+z53Urcbg=+p1Hk0OJOXUMJ6aaBJTEg@mail.gmail.com>
	<1311090762818-3678480.post@n4.nabble.com>
Message-ID: <1327600982179-4331214.post@n4.nabble.com>

Hi Larry,

Did you find a solution?  I have the same issue:

> tick(conn, "RYA ID Equity", "TRADE", "2010-09-21 09:00:00.000",
> "2010-09-21 09:10:00.000")
Error in `colnames<-`(`*tmp*`, value = c("time", "type", "value", "size" : 
  length of 'dimnames' [2] not equal to array extent

Thanks

--
View this message in context: http://r.789695.n4.nabble.com/RBloomberg-update-on-Error-in-dimnames-x-dn-dimnames-applied-to-non-array-tp3660756p4331214.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From r.ted.byers at gmail.com  Thu Jan 26 19:32:02 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Thu, 26 Jan 2012 13:32:02 -0500
Subject: [R-SIG-Finance] rugarch and missing data
Message-ID: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120126/b58e6348/attachment.pl>

From john.laing at gmail.com  Thu Jan 26 19:39:06 2012
From: john.laing at gmail.com (John Laing)
Date: Thu, 26 Jan 2012 13:39:06 -0500
Subject: [R-SIG-Finance] RBloomberg update on "Error in dimnames(x) <-
 dn : 'dimnames' applied to non-array"
In-Reply-To: <1327600982179-4331214.post@n4.nabble.com>
References: <CAJOva6FDMY9ik=QT4MZ+z53Urcbg=+p1Hk0OJOXUMJ6aaBJTEg@mail.gmail.com>
	<1311090762818-3678480.post@n4.nabble.com>
	<1327600982179-4331214.post@n4.nabble.com>
Message-ID: <CAA3Wa=seL0rxS9Suo8aNR-fLXpzhmUs5JSgdkZTOmPFy4M1Fsw@mail.gmail.com>

Sune,

This issue has been answered; you can find it in the archives. To
reiterate, part of the problem (the obscure error message) stems from
an RBloomberg bug, but the larger part of the problem is that
Bloomberg does not provide intraday trade data that far back.

John

On Thu, Jan 26, 2012 at 1:03 PM, Sune Gaulsh
<sune.gaulsh at barclayscapital.com> wrote:
> Hi Larry,
>
> Did you find a solution? ?I have the same issue:
>
>> tick(conn, "RYA ID Equity", "TRADE", "2010-09-21 09:00:00.000",
>> "2010-09-21 09:10:00.000")
> Error in `colnames<-`(`*tmp*`, value = c("time", "type", "value", "size" :
> ?length of 'dimnames' [2] not equal to array extent
>
> Thanks
>
> --
> View this message in context: http://r.789695.n4.nabble.com/RBloomberg-update-on-Error-in-dimnames-x-dn-dimnames-applied-to-non-array-tp3660756p4331214.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From alexios at 4dscape.com  Thu Jan 26 19:48:24 2012
From: alexios at 4dscape.com (alexios)
Date: Thu, 26 Jan 2012 18:48:24 +0000
Subject: [R-SIG-Finance] rugarch and missing data
In-Reply-To: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
References: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
Message-ID: <4F219FF8.5080904@4dscape.com>

Hi Ted,

1. rugarch does not handle missing values.
2. you should pass tick/intraday data as unnamed numeric (rugarch does 
not specifically handle intraday formatted data, so unnamed numeric is 
the the best option).
3. rmgarch is available from r-forge under the rgarch project.
and can be installed by stating that in the 'repos' argument of the
install.packages i.e.
install.packages("rmgarch",repos="http://r-forge.r-project.org")
You'll need to manually install some of the required dependencies.

Regards,
Alexios


On 26/01/2012 18:32, Ted Byers wrote:
> Hi all,
>
>
>
> I seek enlightenment.
>
>
>
> I am beginning to study rugarch, to get a better sense of what it can do.
>
>
>
> The data I am tying first is tick data for futures contracts, but I suppose
> any tick data will have similar issues.
>
>
>
> Here is how I am setting up my data:
>
>
>
> x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
>
> dt<-sprintf("%s %04d",x$V2,x$V4)
>
> dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
>
> y<- data.frame(dt,x$V5)
>
> colnames(y)<- c("tickdate","price")
>
> z<- xts(y[,2],y[,1])
>
> alpha<- to.minutes(z, OHLC=TRUE)
>
> colnames(alpha)<- c("Open","High","Low","Close")
>
>
>
> So, x has the raw tick data.  NB: I can get the same data, with the same
> structure, using SQL from my DB, but didn't want to complicate things.  This
> data file has but a small subsample of all the data I can work with.
>
>
>
> dt gets the date and time data into a single field, as a datetime object
> that to.minutes will accept.
>
>
>
> y gets a data.frame in which the first column is the datetime and the second
> is the price, and z gets an xts object from that.
>
>
>
>
>
> Finally, alpha gets one minute  OHLC data.  Not surprisingly, alpha does not
> have values for every minute of every day for which there is data in
> quotes_M11.dat
>
>
>
> I use alpha successfully for an analysis I do using rollapply.  That works
> great, and it doesn't seem to care that there are minutes without values.
> (I don't know that package well enough to know why, so a little
> enlightenment would be great).
>
>
>
> The problem I have is this.
>
>
>
> spec = ugarchspec(variance.model = list(model = "eGARCH", garchOrder = c(1,
> 1)), mean.model = list(armaOrder = c(1, 1), arfima = FALSE),
> distribution.model = "std")
>
> fit = ugarchfit(spec = spec, data = alpha$Close, out.sample = 0, solver =
> "solnp", solver.control = list(trace = 0))
>
> Error in if (all(dte[, i]<= 12)) m = i :
>
>    missing value where TRUE/FALSE needed
>
> In addition: There were 50 or more warnings (use warnings() to see the first
> 50)
>
>
>
> My reaction to this is, well of course there's missing values.  The warnings
> are about NAs being produced (In FUN(newX[, i], ...) : NAs introduced by
> coercion).
>
>
>
> So, I understand the error message and why it happens.  The question is,
> "What can I do about it?"
>
>
>
> Are any of the steps I show in my data manipulation unnecessary?  (I expect
> that they can be condensed into fewer statements, but I like to see
> precisely what each step does before I condense the code.)
>
>
>
> Is there another step in my data manipulation that I need to add?
>
>
>
> Can any of the methods in the rugarch handle raw tick data directly?
>
>
>
> As an aside, I saw mention of rmgarch in the documentation, but when I
> select "Install packages" from the Packages submenu, I do not see it listed.
> Is it not yet available?  If so, is rgarch the principle alternative for
> multivariate analyses (and if so, with what caveats)?
>
>
>
> Any enlightenment beyond what I found in the manual would be greatly
> appreciated.
>
>
>
> Thanks
>
>
>
> Ted
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From john.kerpel at gmail.com  Thu Jan 26 19:50:36 2012
From: john.kerpel at gmail.com (John Kerpel)
Date: Thu, 26 Jan 2012 12:50:36 -0600
Subject: [R-SIG-Finance] rugarch and missing data
In-Reply-To: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
References: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
Message-ID: <CAALU2hvtvLhcvd6xT23aBKxU_jgGqVWV1eRwHTGEW8EHH-yE5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120126/1d045fe1/attachment.pl>

From r.ted.byers at gmail.com  Thu Jan 26 19:53:15 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Thu, 26 Jan 2012 13:53:15 -0500
Subject: [R-SIG-Finance] rugarch and missing data
In-Reply-To: <4F219FF8.5080904@4dscape.com>
References: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
	<4F219FF8.5080904@4dscape.com>
Message-ID: <c45801ccdc5b$c3d91420$4b8b3c60$@gmail.com>

Thanks Alexios

It is easy enough to extract a vector of unnamed numeric values.

But that leaves the question, what is the best option for filling in missing
values with some suitable default value (which obviously will have to change
through the day).  

Is there something in a related package that will provide a suitable
interpolation?

Thanks again,

Ted

> -----Original Message-----
> From: alexios [mailto:alexios at 4dscape.com]
> Sent: January-26-12 1:48 PM
> To: Ted Byers
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] rugarch and missing data
> 
> Hi Ted,
> 
> 1. rugarch does not handle missing values.
> 2. you should pass tick/intraday data as unnamed numeric (rugarch does not
> specifically handle intraday formatted data, so unnamed numeric is the the
> best option).
> 3. rmgarch is available from r-forge under the rgarch project.
> and can be installed by stating that in the 'repos' argument of the
> install.packages i.e.
> install.packages("rmgarch",repos="http://r-forge.r-project.org")
> You'll need to manually install some of the required dependencies.
> 
> Regards,
> Alexios
> 
> 
> On 26/01/2012 18:32, Ted Byers wrote:
> > Hi all,
> >
> >
> >
> > I seek enlightenment.
> >
> >
> >
> > I am beginning to study rugarch, to get a better sense of what it can
do.
> >
> >
> >
> > The data I am tying first is tick data for futures contracts, but I
> > suppose any tick data will have similar issues.
> >
> >
> >
> > Here is how I am setting up my data:
> >
> >
> >
> > x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
> >
> > dt<-sprintf("%s %04d",x$V2,x$V4)
> >
> > dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
> >
> > y<- data.frame(dt,x$V5)
> >
> > colnames(y)<- c("tickdate","price")
> >
> > z<- xts(y[,2],y[,1])
> >
> > alpha<- to.minutes(z, OHLC=TRUE)
> >
> > colnames(alpha)<- c("Open","High","Low","Close")
> >
> >
> >
> > So, x has the raw tick data.  NB: I can get the same data, with the
> > same structure, using SQL from my DB, but didn't want to complicate
> > things.  This data file has but a small subsample of all the data I can
work
> with.
> >
> >
> >
> > dt gets the date and time data into a single field, as a datetime
> > object that to.minutes will accept.
> >
> >
> >
> > y gets a data.frame in which the first column is the datetime and the
> > second is the price, and z gets an xts object from that.
> >
> >
> >
> >
> >
> > Finally, alpha gets one minute  OHLC data.  Not surprisingly, alpha
> > does not have values for every minute of every day for which there is
> > data in quotes_M11.dat
> >
> >
> >
> > I use alpha successfully for an analysis I do using rollapply.  That
> > works great, and it doesn't seem to care that there are minutes without
> values.
> > (I don't know that package well enough to know why, so a little
> > enlightenment would be great).
> >
> >
> >
> > The problem I have is this.
> >
> >
> >
> > spec = ugarchspec(variance.model = list(model = "eGARCH", garchOrder =
> > c(1, 1)), mean.model = list(armaOrder = c(1, 1), arfima = FALSE),
> > distribution.model = "std")
> >
> > fit = ugarchfit(spec = spec, data = alpha$Close, out.sample = 0,
> > solver = "solnp", solver.control = list(trace = 0))
> >
> > Error in if (all(dte[, i]<= 12)) m = i :
> >
> >    missing value where TRUE/FALSE needed
> >
> > In addition: There were 50 or more warnings (use warnings() to see the
> > first
> > 50)
> >
> >
> >
> > My reaction to this is, well of course there's missing values.  The
> > warnings are about NAs being produced (In FUN(newX[, i], ...) : NAs
> > introduced by coercion).
> >
> >
> >
> > So, I understand the error message and why it happens.  The question
> > is, "What can I do about it?"
> >
> >
> >
> > Are any of the steps I show in my data manipulation unnecessary?  (I
> > expect that they can be condensed into fewer statements, but I like to
> > see precisely what each step does before I condense the code.)
> >
> >
> >
> > Is there another step in my data manipulation that I need to add?
> >
> >
> >
> > Can any of the methods in the rugarch handle raw tick data directly?
> >
> >
> >
> > As an aside, I saw mention of rmgarch in the documentation, but when I
> > select "Install packages" from the Packages submenu, I do not see it
listed.
> > Is it not yet available?  If so, is rgarch the principle alternative
> > for multivariate analyses (and if so, with what caveats)?
> >
> >
> >
> > Any enlightenment beyond what I found in the manual would be greatly
> > appreciated.
> >
> >
> >
> > Thanks
> >
> >
> >
> > Ted
> >
> >
> > 	[[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
should
> go.
> >


From patrick at burns-stat.com  Thu Jan 26 20:12:15 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 26 Jan 2012 19:12:15 +0000
Subject: [R-SIG-Finance] rugarch and missing data
In-Reply-To: <c45801ccdc5b$c3d91420$4b8b3c60$@gmail.com>
References: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
	<4F219FF8.5080904@4dscape.com>
	<c45801ccdc5b$c3d91420$4b8b3c60$@gmail.com>
Message-ID: <4F21A58F.8010902@burns-stat.com>

I would think that the thing to do
would be 'locf' last observation
carried forward (on prices).  If there
is no activity, then presume that the
price hasn't changed.  You then want to
get returns.  So you'll end up with a
number of zeros.

There are other issues that make intraday
garch modeling "interesting".  There is
typical seasonality of the volatility
through the day.  Doing it "right" is hard.
Doing it well enough to add value, might
not be terribly hard.

Pat


On 26/01/2012 18:53, Ted Byers wrote:
> Thanks Alexios
>
> It is easy enough to extract a vector of unnamed numeric values.
>
> But that leaves the question, what is the best option for filling in missing
> values with some suitable default value (which obviously will have to change
> through the day).
>
> Is there something in a related package that will provide a suitable
> interpolation?
>
> Thanks again,
>
> Ted
>
>> -----Original Message-----
>> From: alexios [mailto:alexios at 4dscape.com]
>> Sent: January-26-12 1:48 PM
>> To: Ted Byers
>> Cc: r-sig-finance at r-project.org
>> Subject: Re: [R-SIG-Finance] rugarch and missing data
>>
>> Hi Ted,
>>
>> 1. rugarch does not handle missing values.
>> 2. you should pass tick/intraday data as unnamed numeric (rugarch does not
>> specifically handle intraday formatted data, so unnamed numeric is the the
>> best option).
>> 3. rmgarch is available from r-forge under the rgarch project.
>> and can be installed by stating that in the 'repos' argument of the
>> install.packages i.e.
>> install.packages("rmgarch",repos="http://r-forge.r-project.org")
>> You'll need to manually install some of the required dependencies.
>>
>> Regards,
>> Alexios
>>
>>
>> On 26/01/2012 18:32, Ted Byers wrote:
>>> Hi all,
>>>
>>>
>>>
>>> I seek enlightenment.
>>>
>>>
>>>
>>> I am beginning to study rugarch, to get a better sense of what it can
> do.
>>>
>>>
>>>
>>> The data I am tying first is tick data for futures contracts, but I
>>> suppose any tick data will have similar issues.
>>>
>>>
>>>
>>> Here is how I am setting up my data:
>>>
>>>
>>>
>>> x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
>>>
>>> dt<-sprintf("%s %04d",x$V2,x$V4)
>>>
>>> dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
>>>
>>> y<- data.frame(dt,x$V5)
>>>
>>> colnames(y)<- c("tickdate","price")
>>>
>>> z<- xts(y[,2],y[,1])
>>>
>>> alpha<- to.minutes(z, OHLC=TRUE)
>>>
>>> colnames(alpha)<- c("Open","High","Low","Close")
>>>
>>>
>>>
>>> So, x has the raw tick data.  NB: I can get the same data, with the
>>> same structure, using SQL from my DB, but didn't want to complicate
>>> things.  This data file has but a small subsample of all the data I can
> work
>> with.
>>>
>>>
>>>
>>> dt gets the date and time data into a single field, as a datetime
>>> object that to.minutes will accept.
>>>
>>>
>>>
>>> y gets a data.frame in which the first column is the datetime and the
>>> second is the price, and z gets an xts object from that.
>>>
>>>
>>>
>>>
>>>
>>> Finally, alpha gets one minute  OHLC data.  Not surprisingly, alpha
>>> does not have values for every minute of every day for which there is
>>> data in quotes_M11.dat
>>>
>>>
>>>
>>> I use alpha successfully for an analysis I do using rollapply.  That
>>> works great, and it doesn't seem to care that there are minutes without
>> values.
>>> (I don't know that package well enough to know why, so a little
>>> enlightenment would be great).
>>>
>>>
>>>
>>> The problem I have is this.
>>>
>>>
>>>
>>> spec = ugarchspec(variance.model = list(model = "eGARCH", garchOrder =
>>> c(1, 1)), mean.model = list(armaOrder = c(1, 1), arfima = FALSE),
>>> distribution.model = "std")
>>>
>>> fit = ugarchfit(spec = spec, data = alpha$Close, out.sample = 0,
>>> solver = "solnp", solver.control = list(trace = 0))
>>>
>>> Error in if (all(dte[, i]<= 12)) m = i :
>>>
>>>     missing value where TRUE/FALSE needed
>>>
>>> In addition: There were 50 or more warnings (use warnings() to see the
>>> first
>>> 50)
>>>
>>>
>>>
>>> My reaction to this is, well of course there's missing values.  The
>>> warnings are about NAs being produced (In FUN(newX[, i], ...) : NAs
>>> introduced by coercion).
>>>
>>>
>>>
>>> So, I understand the error message and why it happens.  The question
>>> is, "What can I do about it?"
>>>
>>>
>>>
>>> Are any of the steps I show in my data manipulation unnecessary?  (I
>>> expect that they can be condensed into fewer statements, but I like to
>>> see precisely what each step does before I condense the code.)
>>>
>>>
>>>
>>> Is there another step in my data manipulation that I need to add?
>>>
>>>
>>>
>>> Can any of the methods in the rugarch handle raw tick data directly?
>>>
>>>
>>>
>>> As an aside, I saw mention of rmgarch in the documentation, but when I
>>> select "Install packages" from the Packages submenu, I do not see it
> listed.
>>> Is it not yet available?  If so, is rgarch the principle alternative
>>> for multivariate analyses (and if so, with what caveats)?
>>>
>>>
>>>
>>> Any enlightenment beyond what I found in the manual would be greatly
>>> appreciated.
>>>
>>>
>>>
>>> Thanks
>>>
>>>
>>>
>>> Ted
>>>
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
> should
>> go.
>>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From alexios at 4dscape.com  Thu Jan 26 20:35:26 2012
From: alexios at 4dscape.com (alexios)
Date: Thu, 26 Jan 2012 19:35:26 +0000
Subject: [R-SIG-Finance] rugarch and missing data
In-Reply-To: <4F21A58F.8010902@burns-stat.com>
References: <c3c701ccdc58$cd3c36d0$67b4a470$@gmail.com>
	<4F219FF8.5080904@4dscape.com>
	<c45801ccdc5b$c3d91420$4b8b3c60$@gmail.com>
	<4F21A58F.8010902@burns-stat.com>
Message-ID: <4F21AAFE.2070004@4dscape.com>

I have to agree with Pat that you need to be very careful in the presence of
lots of zeros...perhaps try aggregating to the 5-min level instead.

You might also find the timeSeries package useful: it provides
the 'interpNA', 'removeNA' and 'substituteNA' functions.

Regards,
Alexios

On 26/01/12 19:12, Patrick Burns wrote:
> I would think that the thing to do
> would be 'locf' last observation
> carried forward (on prices).  If there
> is no activity, then presume that the
> price hasn't changed.  You then want to
> get returns.  So you'll end up with a
> number of zeros.
>
> There are other issues that make intraday
> garch modeling "interesting".  There is
> typical seasonality of the volatility
> through the day.  Doing it "right" is hard.
> Doing it well enough to add value, might
> not be terribly hard.
>
> Pat
>
>
> On 26/01/2012 18:53, Ted Byers wrote:
>> Thanks Alexios
>>
>> It is easy enough to extract a vector of unnamed numeric values.
>>
>> But that leaves the question, what is the best option for filling in 
>> missing
>> values with some suitable default value (which obviously will have to 
>> change
>> through the day).
>>
>> Is there something in a related package that will provide a suitable
>> interpolation?
>>
>> Thanks again,
>>
>> Ted
>>
>>> -----Original Message-----
>>> From: alexios [mailto:alexios at 4dscape.com]
>>> Sent: January-26-12 1:48 PM
>>> To: Ted Byers
>>> Cc: r-sig-finance at r-project.org
>>> Subject: Re: [R-SIG-Finance] rugarch and missing data
>>>
>>> Hi Ted,
>>>
>>> 1. rugarch does not handle missing values.
>>> 2. you should pass tick/intraday data as unnamed numeric (rugarch 
>>> does not
>>> specifically handle intraday formatted data, so unnamed numeric is 
>>> the the
>>> best option).
>>> 3. rmgarch is available from r-forge under the rgarch project.
>>> and can be installed by stating that in the 'repos' argument of the
>>> install.packages i.e.
>>> install.packages("rmgarch",repos="http://r-forge.r-project.org")
>>> You'll need to manually install some of the required dependencies.
>>>
>>> Regards,
>>> Alexios
>>>
>>>
>>> On 26/01/2012 18:32, Ted Byers wrote:
>>>> Hi all,
>>>>
>>>>
>>>>
>>>> I seek enlightenment.
>>>>
>>>>
>>>>
>>>> I am beginning to study rugarch, to get a better sense of what it can
>> do.
>>>>
>>>>
>>>>
>>>> The data I am tying first is tick data for futures contracts, but I
>>>> suppose any tick data will have similar issues.
>>>>
>>>>
>>>>
>>>> Here is how I am setting up my data:
>>>>
>>>>
>>>>
>>>> x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
>>>>
>>>> dt<-sprintf("%s %04d",x$V2,x$V4)
>>>>
>>>> dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
>>>>
>>>> y<- data.frame(dt,x$V5)
>>>>
>>>> colnames(y)<- c("tickdate","price")
>>>>
>>>> z<- xts(y[,2],y[,1])
>>>>
>>>> alpha<- to.minutes(z, OHLC=TRUE)
>>>>
>>>> colnames(alpha)<- c("Open","High","Low","Close")
>>>>
>>>>
>>>>
>>>> So, x has the raw tick data.  NB: I can get the same data, with the
>>>> same structure, using SQL from my DB, but didn't want to complicate
>>>> things.  This data file has but a small subsample of all the data I 
>>>> can
>> work
>>> with.
>>>>
>>>>
>>>>
>>>> dt gets the date and time data into a single field, as a datetime
>>>> object that to.minutes will accept.
>>>>
>>>>
>>>>
>>>> y gets a data.frame in which the first column is the datetime and the
>>>> second is the price, and z gets an xts object from that.
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> Finally, alpha gets one minute  OHLC data.  Not surprisingly, alpha
>>>> does not have values for every minute of every day for which there is
>>>> data in quotes_M11.dat
>>>>
>>>>
>>>>
>>>> I use alpha successfully for an analysis I do using rollapply.  That
>>>> works great, and it doesn't seem to care that there are minutes 
>>>> without
>>> values.
>>>> (I don't know that package well enough to know why, so a little
>>>> enlightenment would be great).
>>>>
>>>>
>>>>
>>>> The problem I have is this.
>>>>
>>>>
>>>>
>>>> spec = ugarchspec(variance.model = list(model = "eGARCH", garchOrder =
>>>> c(1, 1)), mean.model = list(armaOrder = c(1, 1), arfima = FALSE),
>>>> distribution.model = "std")
>>>>
>>>> fit = ugarchfit(spec = spec, data = alpha$Close, out.sample = 0,
>>>> solver = "solnp", solver.control = list(trace = 0))
>>>>
>>>> Error in if (all(dte[, i]<= 12)) m = i :
>>>>
>>>>     missing value where TRUE/FALSE needed
>>>>
>>>> In addition: There were 50 or more warnings (use warnings() to see the
>>>> first
>>>> 50)
>>>>
>>>>
>>>>
>>>> My reaction to this is, well of course there's missing values.  The
>>>> warnings are about NAs being produced (In FUN(newX[, i], ...) : NAs
>>>> introduced by coercion).
>>>>
>>>>
>>>>
>>>> So, I understand the error message and why it happens.  The question
>>>> is, "What can I do about it?"
>>>>
>>>>
>>>>
>>>> Are any of the steps I show in my data manipulation unnecessary?  (I
>>>> expect that they can be condensed into fewer statements, but I like to
>>>> see precisely what each step does before I condense the code.)
>>>>
>>>>
>>>>
>>>> Is there another step in my data manipulation that I need to add?
>>>>
>>>>
>>>>
>>>> Can any of the methods in the rugarch handle raw tick data directly?
>>>>
>>>>
>>>>
>>>> As an aside, I saw mention of rmgarch in the documentation, but when I
>>>> select "Install packages" from the Packages submenu, I do not see it
>> listed.
>>>> Is it not yet available?  If so, is rgarch the principle alternative
>>>> for multivariate analyses (and if so, with what caveats)?
>>>>
>>>>
>>>>
>>>> Any enlightenment beyond what I found in the manual would be greatly
>>>> appreciated.
>>>>
>>>>
>>>>
>>>> Thanks
>>>>
>>>>
>>>>
>>>> Ted
>>>>
>>>>
>>>>     [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R 
>>>> questions
>> should
>>> go.
>>>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R 
>> questions should go.
>>
>


From josh.m.ulrich at gmail.com  Fri Jan 27 05:41:34 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 26 Jan 2012 22:41:34 -0600
Subject: [R-SIG-Finance] How to make quantstrat demo work with intraday
	data
In-Reply-To: <CAJ_D839qwpR2Cp=aSTj-9me=Pt3ygvyqo-YfUT+1fW9-wP0_7A@mail.gmail.com>
References: <CAJ_D839qwpR2Cp=aSTj-9me=Pt3ygvyqo-YfUT+1fW9-wP0_7A@mail.gmail.com>
Message-ID: <CAPPM_gTCaPH2UqopF=ad-jU7T5stgz6MKBjjYRVKvU=SSEFtsg@mail.gmail.com>

On Thu, Jan 26, 2012 at 8:58 AM, Yuanhang Wang <yuanhangw.sg at gmail.com> wrote:
> Hi listers,
>
> ? ?I'm having some trouble to get quantstrat work on intraday data I'm
> pulling out of Bloomberg. The orginal demo (rsi.R) came with quantstrat.pkg
> works fine on daily data, but ?when I try to replace the daily time series
> with intraday data (30min OHLC):
>
> currency("USD")
> currency("EUR")
> symbols = c("GCA" )#, "XAGUSD", "XPTUSD", "XPDUSD")
> for(symbol in symbols){ # establish trade-able instruments
> ? ?stock(symbol, currency="USD",multiplier=1)
> ?getSymbols(symbol,src="Bloomberg", *bb.interval = "30"*,
> bb.suffix="Curncy",*from=as.POSIXlt(Sys.time()-60*4000,"GMT"),*
> * *
> *to=as.POSIXlt(Sys.time(),"GMT")*)
> }
>
>> head(GCA)
> ? ? ? ? ? ? ? ? ? ?GCA.Open GCA.High GCA.Low GCA.Close GCA.Volume
> 2012-01-23 20:07:00 ? 1678.8 ? 1681.1 ?1678.3 ? ?1679.9 ? ? ? ? 65
> 2012-01-23 20:37:00 ? 1680.0 ? 1681.5 ?1680.0 ? ?1680.3 ? ? ? ? 84
> 2012-01-23 21:07:00 ? 1680.6 ? 1680.6 ?1679.7 ? ?1679.7 ? ? ? ? 15
> 2012-01-23 21:37:00 ? 1680.3 ? 1680.6 ?1680.3 ? ?1680.4 ? ? ? ? ?4
> 2012-01-23 22:07:00 ? 1679.7 ? 1681.1 ?1679.3 ? ?1681.1 ? ? ? ? ?3
> 2012-01-23 23:00:00 ? 1680.6 ? 1680.6 ?1680.4 ? ?1680.6 ? ? ? ? ?3
>
> applyStrategy() seems generating bogus pnl even though applySignals and
> applyRules seems working properly. Anyone can tell me how I can work around
> with this and get it works around intraday data?
>
> Regards,
> Yuanhang
>
Many people use quantstrat with intraday (even tick) data without
errors.  You only provide a vague description of the problem ("bogus
pnl") and do not provide the versions of R and the packages you're
using.

In short, you need to provide much more detail for anyone to be able
to help.  Start by ensuring you're using the most up-to-date versions
of quantstrat, blotter, FinancialInstrument, xts, etc. and show us
what makes the P&L "bogus".  The output from sessionInfo() would also
be helpful.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> [code]
>
> require(quantstrat)
> require(RBloomberg)
> suppressWarnings(rm("order_book.RSI",pos=.strategy))
> suppressWarnings(rm("account.RSI","portfolio.RSI",pos=.blotter))
> suppressWarnings(rm("account.st","portfolio.st
> ","stock.str","stratRSI","initDate","initEq",'start_t','end_t'))
>
> # Initialize a strategy object
> stratRSI <- strategy("RSI")
>
> # Add an indicator
> stratRSI <- add.indicator(strategy = stratRSI, name = "RSI", arguments =
> list(price = quote(getPrice(mktdata)),n=2), ?label="RSI")
>
>
>
> # There are two signals:
>
> stratRSI <- add.signal(strategy = stratRSI, name="sigThreshold",arguments =
> list(threshold=55, column="RSI",relationship="gt",
> cross=TRUE),label="RSI.gt.55")
>
> stratRSI <- add.signal(strategy = stratRSI, name="sigThreshold",arguments =
> list(threshold=55,
> column="RSI",relationship="lt",cross=TRUE),label="RSI.lt.55")
>
> stratRSI <- add.signal(strategy = stratRSI, name="sigThreshold",arguments =
> list(threshold=45, column="RSI",relationship="gt",
> cross=TRUE),label="RSI.gt.45")
> # The second is when RSI is less than 10
> stratRSI <- add.signal(strategy = stratRSI, name="sigThreshold",arguments =
> list(threshold=45,
> column="RSI",relationship="lt",cross=TRUE),label="RSI.lt.45")
>
>
> # There are two rules:
> #'## we would Use osMaxPos to put trade on in layers, or to a maximum
> position.
> # The first is to sell when the RSI crosses above the threshold
> stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments =
> list(sigcol="RSI.gt.55", sigval=TRUE, orderqty=-1000, ordertype='market',
> orderside='short', pricemethod='market', replace=FALSE), type='enter',
> path.dep=TRUE)
> stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments =
> list(sigcol="RSI.lt.55", sigval=TRUE, orderqty='all', ordertype='market',
> orderside='short', pricemethod='market', replace=FALSE), type='exit',
> path.dep=TRUE)
>
>
> stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments =
> list(sigcol="RSI.lt.45", sigval=TRUE, orderqty=1000, ordertype='market',
> orderside='long', pricemethod='market', replace=FALSE), type='enter',
> path.dep=TRUE)
> stratRSI <- add.rule(strategy = stratRSI, name='ruleSignal', arguments =
> list(sigcol="RSI.gt.45", sigval=TRUE, orderqty='all', ordertype='market',
> orderside='short', pricemethod='market', replace=FALSE), type='exit',
> path.dep=TRUE)
> #add changeable parameters
>
>
> currency("USD")
> currency("EUR")
> symbols = c("GCA" )#, "XAGUSD", "XPTUSD", "XPDUSD")
> for(symbol in symbols){ # establish trade-able instruments
> ? ?stock(symbol, currency="USD",multiplier=1)
> getSymbols(symbol,src="Bloomberg", bb.interval = "30",
> bb.suffix="Curncy",from=as.POSIXlt(Sys.time()-60*4000,"GMT"),
> ?to=as.POSIXlt(Sys.time(),"GMT"))
> }
>
> # you can test with something like this:
> # applySignals(strategy=stratRSI,
> mktdata=applyIndicators(strategy=stratRSI, mktdata=symbols[1]))
>
>
> initDate=Sys.Date()-1
> initEq=100000
> port.st<-'RSI' #use a string here for easier changing of parameters and
> re-trying
>
> initPortf(port.st, symbols=symbols, initDate=initDate)
> initAcct(port.st, portfolios=port.st, initDate=initDate)
> initOrders(portfolio=port.st, initDate=initDate)
>
> print("setup completed")
>
> # Process the indicators and generate trades
> start_t<-Sys.time()
> out<-try(applyStrategy(strategy=stratRSI , portfolios=port.st,
> parameters=list(n=2), verbose =FALSE ) )
> end_t<-Sys.time()
> print("Strategy Loop:")
> print(end_t-start_t)
>
> # look at the order book
> #print(getOrderBook(port.st))
>
> start_t<-Sys.time()
> updatePortf(Portfolio=port.st,Dates=paste('::',as.Date(Sys.time()),sep=''))
> end_t<-Sys.time()
> print("trade blotter portfolio update:")
> print(end_t-start_t)
>
> # hack for new quantmod graphics, remove later
> themelist<-chart_theme()
> themelist$col$up.col<-'lightgreen'
> themelist$col$dn.col<-'pink'
> for(symbol in symbols){
> ? ?dev.new()
> ? ?chart.Posn(Portfolio=port.st,Symbol=symbol,theme=themelist)
> ? ?plot(add_RSI(n=2,RSIup=55,RSIdn=45))
> }
>
> ###############################################################################
> # R (http://r-project.org/) Quantitative Strategy Model Framework
> #
> # Copyright (c) 2009-2010
> # Peter Carl, Dirk Eddelbuettel, Brian G. Peterson, Jeffrey Ryan, and
> Joshua Ulrich
> #
> # This library is distributed under the terms of the GNU Public License
> (GPL)
> # for full details see the file COPYING
> #
> # $Id: rsi.R 621 2011-06-09 23:18:04Z gsee $
> #
> ###############################################################################
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From papa.senyo at yahoo.it  Fri Jan 27 17:05:55 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Fri, 27 Jan 2012 16:05:55 +0000 (GMT)
Subject: [R-SIG-Finance] Negative Estimate of EGARCH model
Message-ID: <1327680355.14549.YahooMailNeo@web132304.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120127/52ab2e5f/attachment.pl>

From alexios at 4dscape.com  Fri Jan 27 17:23:39 2012
From: alexios at 4dscape.com (alexios)
Date: Fri, 27 Jan 2012 16:23:39 +0000
Subject: [R-SIG-Finance] Negative Estimate of EGARCH model
In-Reply-To: <1327680355.14549.YahooMailNeo@web132304.mail.ird.yahoo.com>
References: <1327680355.14549.YahooMailNeo@web132304.mail.ird.yahoo.com>
Message-ID: <4F22CF8B.3080907@4dscape.com>

"Correcting" the possibility of negative parameter estimates implies an 
error in the model. This is not so, and I
suggest you try to read some of the references cited in the package 
about how GARCH models work.

The point of eGARCH is that we work with  the log of the variance so we 
do not have to worry about positivity.
The parameters therefore, for the intercept (\omega),  shock (\alpha) 
and asymmetry (\gamma) are 'unrestricted' while the
parameter on the lagged variance (\beta) is constrained (for 
stationarity) to be less than 1 and positive.
Thus, it is NOT a correction you are seeking but a customization to suit 
your own beliefs on the model. You are free to
go into the code and change these restrictions to suit your purpose. The 
restrictions may be found in the "rugarch-startpars.R" file
in the source installation and the function is ".egarchstart".

Regards,
Alexios

On 27/01/12 16:05, Papa Senyo wrote:
> Dear All,
> Using the rugarch package, how can you correct the possibility of negative estimates for instance in EGARCH parameters being negative?
> Is it possible to put a restriction on it in order to get positive estimates especially for the ARCH AND GARCH PARAMETER
>
> Kind regards,
> Papa
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From papa.senyo at yahoo.it  Fri Jan 27 17:54:49 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Fri, 27 Jan 2012 16:54:49 +0000 (GMT)
Subject: [R-SIG-Finance] Negative Estimate of EGARCH model
In-Reply-To: <4F22CF8B.3080907@4dscape.com>
References: <1327680355.14549.YahooMailNeo@web132304.mail.ird.yahoo.com>
	<4F22CF8B.3080907@4dscape.com>
Message-ID: <1327683289.33832.YahooMailNeo@web132306.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120127/9f4ed1bb/attachment.pl>

From papa.senyo at yahoo.it  Fri Jan 27 18:28:04 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Fri, 27 Jan 2012 17:28:04 +0000 (GMT)
Subject: [R-SIG-Finance] Negative Estimate of EGARCH model
In-Reply-To: <1327683289.33832.YahooMailNeo@web132306.mail.ird.yahoo.com>
References: <1327680355.14549.YahooMailNeo@web132304.mail.ird.yahoo.com>
	<4F22CF8B.3080907@4dscape.com>
	<1327683289.33832.YahooMailNeo@web132306.mail.ird.yahoo.com>
Message-ID: <1327685284.70317.YahooMailNeo@web132302.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120127/d59a189f/attachment.pl>

From matt at considine.net  Fri Jan 27 21:29:10 2012
From: matt at considine.net (matt at considine.net)
Date: Fri, 27 Jan 2012 14:29:10 -0600
Subject: [R-SIG-Finance] Help with portfolioData/fPortfolio?
Message-ID: <20120127142910.74211i6lar1oeqe8@webmail.considine.net>

I am trying to run some Rmetrics code (e.g. feasiblePortfolio,  
frontierPortfolio) using data that is already set up as expected  
returns and a variance/covariance matrix.

The fPortfolio documentation suggests that the "data" argument to  
portfolioData
is

"a time series or a named list, containing either a series of returns or named
entries ?mu? and ?Sigma? being mean and covariance matrix."

Yet when I try to run this on code like this (example in mail archives) :
  #install.packages("MBESS") #for cor2cov
  mu <- c( 0.1, 0.08, 0.065)
  sigma <- c( 0.18, 0.12, 0.09 )

  correlationMatrix <- rbind( c( 1, 0.8, 0.9 ),
                              c( 0.8, 1, 0.75),
                              c( 0.9, 0.75, 1) )

  covarianceMatrix <- cor2cov(correlationMatrix, sigma )

  data = list( mu = mu, Sigma = covarianceMatrix )
  frontier<-portfolioFrontier(data)

I get the message
   Error: class(data) == "timeSeries" is not TRUE

Now obviously I know what the error message means.  But it suggests  
that I am overlooking something such as a parameter or that the doc is  
wrong.  Further down in the documentation there is a description of  
this dataset

Simulated Mean-Cov Data Set:
This data is taken from chapter 1.3.2 in Scherer, M., Martin, R.D.  
(2005); Introduction To Modern Portfolio Optimization with NuOPT,  
S-PLUS and S+Bayes, Springer, Berlin. It is a list of covariance  
matrix and the return means of imaginary assets. It is an example set  
for learning about optimization.

which suggests to mean that I am missing something.

Can anyone tell me
   a) can I run the Rmetrics codes above using mu and Sigma and if so  
what parameters do I need to use or what do I need to do differently?
   b) where can I find the "Simulated Mean-Cov" dataset so that I can  
play with it and otherwise see if I have misformatted my inputs?  Is  
there an example available that I can be pointed to which would show  
how it is used (and which would presumably answer question (a)?

Thank you in advance for any advice, pointers, code, etc.  And  
patience - most of all!

Regards,
Matt Considine


From junzhu98 at yahoo.com  Sat Jan 28 02:40:50 2012
From: junzhu98 at yahoo.com (Jun Zhu)
Date: Fri, 27 Jan 2012 17:40:50 -0800 (PST)
Subject: [R-SIG-Finance] Help with getSymbols from csv data file
In-Reply-To: <20120127142910.74211i6lar1oeqe8@webmail.considine.net>
Message-ID: <1327714850.26516.YahooMailClassic@web30603.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120127/5a96f6cb/attachment.pl>

From josh.m.ulrich at gmail.com  Sat Jan 28 02:58:07 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 27 Jan 2012 19:58:07 -0600
Subject: [R-SIG-Finance] Help with getSymbols from csv data file
In-Reply-To: <1327714850.26516.YahooMailClassic@web30603.mail.mud.yahoo.com>
References: <20120127142910.74211i6lar1oeqe8@webmail.considine.net>
	<1327714850.26516.YahooMailClassic@web30603.mail.mud.yahoo.com>
Message-ID: <CAPPM_gTKFcwVe9NMhQ55PvX9syRtGL6NKN29RDt21k2RiJKZuQ@mail.gmail.com>

Hi Jun,

Specifying the date format via setSymbolLookup fixes it.  I'm not sure
if there is a more general solution.

setSymbolLookup(test=list(src="csv",format="%Y-%m-%d"))
getSymbols('test',src='csv')

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Fri, Jan 27, 2012 at 7:40 PM, Jun Zhu <junzhu98 at yahoo.com> wrote:
> I did a simple test to read from csv file using the following commands:
> getSymbols('GOOG')write.csv(file='test.csv', data.frame(GOOG) )getSymbols('test',src='csv')head(TEST)
> I am puzzled by the result that always show the same date which is 'today'.Any help on this will be greatly appreciated.
> thanks,
> Jun
> ===== result ===============2012-01-27 ? ?646.50 ? ?647.00 ? 621.23 ? ? 622.46 ? ? 5822600 ? ? ? ?622.462012-01-27 ? ?629.75 ? ?633.80 ? 616.91 ? ? 623.14 ? ? 4395600 ? ? ? ?623.142012-01-27 ? ?623.50 ? ?629.39 ? 621.12 ? ? 625.96 ? ? 2400000 ? ? ? ?625.962012-01-27 ? ?631.22 ? ?632.89 ? 626.50 ? ? 629.64 ? ? 1875200 ? ? ? ?629.642012-01-27 ? ?626.26 ? ?626.95 ? 621.06 ? ? 624.99 ? ? 2307300 ? ? ? ?624.992012-01-27 ? ?631.98 ? ?631.98 ? 625.68 ? ? 628.58 ? ? 1909300 ? ? ? ?628.582012-01-27 ? ?626.63 ? ?634.00 ? 622.12 ? ? 632.91 ? ? 2761700 ? ? ? ?632.912012-01-27 ? ?640.99 ? ?640.99 ? 631.46 ? ? 639.57 ? ? 6276500 ? ? ? ?639.572012-01-27 ? ?590.53 ? ?591.00 ? 581.70 ? ? 585.99 ? ?10576300 ? ? ? ?585.992012-01-27 ? ?586.00 ? ?588.66 ? 583.16 ? ? 585.52 ? ? 3412900 ? ? ? ?585.522012-01-27 ? ?586.32 ? ?587.68 ? 578.00
> ?580.93 ? ? 3055800 ? ? ? ?580.932012-01-27 ? ?577.51 ? ?578.71 ? 566.38 ? ? 569.49 ? ? 4987700 ? ? ? ?569.492012-01-27 ? ?571.98 ? ?574.48 ? 564.55 ? ? 568.10 ? ? 3226200 ? ? ? ?568.10
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ropo.sadler at gmail.com  Sat Jan 28 06:42:37 2012
From: ropo.sadler at gmail.com (Rohan Sadler)
Date: Sat, 28 Jan 2012 13:42:37 +0800
Subject: [R-SIG-Finance] tawny: deriving
Message-ID: <CAJ_iHncroeOvcGY8f9X==GGTxK_obz-cpsrj05sJFHm-7Vw2cg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120128/db72c30d/attachment.pl>

From patrick at burns-stat.com  Sat Jan 28 10:47:49 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Sat, 28 Jan 2012 09:47:49 +0000
Subject: [R-SIG-Finance] tawny: deriving
In-Reply-To: <CAJ_iHncroeOvcGY8f9X==GGTxK_obz-cpsrj05sJFHm-7Vw2cg@mail.gmail.com>
References: <CAJ_iHncroeOvcGY8f9X==GGTxK_obz-cpsrj05sJFHm-7Vw2cg@mail.gmail.com>
Message-ID: <4F23C445.60806@burns-stat.com>

Rohan,

I'm a little confused about what you really
want, but perhaps 'var.shrink.eqcor' from
the 'BurStFin' package can help.

The package is not yet on CRAN (but it's
getting closer), get it from:

install.packages('BurStFin',
    repos="http://www.burns-stat.com/R")

(which doesn't work under 2.14.x because it
doesn't have a namespace).

'var.shrink.eqcor' returns the shrinkage that
it uses as an attribute.

To get estimates that are trying to mimic the
original Ledoit-Wolf code, you need to set the
weights to be all equal and the 'compatible'
argument to TRUE.

The shrinkage parameter is slightly different
from that estimated in 'tawny'.  I have a sample
size of one that suggests I get the value that
Ledoit and Wolf's Matlab code gets.  I couldn't
see where the difference comes from in the little
time I spent trying.

Pat

On 28/01/2012 05:42, Rohan Sadler wrote:
> Hi All,
>
> newbie question: I am interested in acquiring the value of Ledoit&  Wolf's
> (2003) optimal shrinkage estimate from the tawny package (or other). Having
> read the paper, and then had a look at tawny, then I can derive the
> shrinkage intensity (intensity.shrinkage, see below code). However, as the
> value of the intensity is larger than one then I wanted to confirm whether
> the L&W shrinkage parameter  is not tawny's intensity/T, where T is the
> length of the time series (i.e., rows of the returns matrix). That is,
> confirm whether tawny's shrinkage.intensity function returns what L&W
> termed as the 'optimal constant' kappa (p611), rather than L&W's optimal
> shrinkage intensity alpha.
>
>    sample.vcov<-cov.sample(returns.zoo)
>    F<- cov.prior.cc(sample.vcov)
>    k<- shrinkage.intensity(returns.zoo, F, sample.vcov)
>    shrunk.vcov<-cov.shrink(returns.zoo,prior.fun = cov.prior.cc)
>
> The output from Brian's site:
> http://nurometic.com/quantitative-finance/tawny/exploring-shrinkage-estimation
> doesn't
> seem
> to hold for the latest R/tawny version. It would be nice to acquire that
> information somehow, perhaps embedded in one of the shrunk objects, or at
> least one or two more lines of documentation in the associated help pages
> (apologies for being demanding!!). Packages fPortfolio and corpcor didn't
> seem to provide any of this information either for the newbie crowd.
>
>> S.hat<- cov.shrink(h)
> Got intensity k = 146.8918 and coefficient d = 0.9792788
>
>
> Regards
> Rohan Sadler
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From r.ted.byers at gmail.com  Sat Jan 28 19:36:32 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Sat, 28 Jan 2012 13:36:32 -0500
Subject: [R-SIG-Finance] Constructing suitable temporal subsamples using zoo
	and/or xts
Message-ID: <d12b01ccddeb$c2c97f20$485c7d60$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120128/767a5d8d/attachment.pl>

From ggrothendieck at gmail.com  Sat Jan 28 20:04:24 2012
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 28 Jan 2012 14:04:24 -0500
Subject: [R-SIG-Finance] Constructing suitable temporal subsamples using
 zoo and/or xts
In-Reply-To: <d12b01ccddeb$c2c97f20$485c7d60$@gmail.com>
References: <d12b01ccddeb$c2c97f20$485c7d60$@gmail.com>
Message-ID: <CAP01uRmUQRDkQ48hgBxGSz1F0CW=x3P3sghmQ5kyondWnW3=zg@mail.gmail.com>

On Sat, Jan 28, 2012 at 1:36 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
> I am managing to confuse myself with what I am seeing in the docs, and
> results returned by Google, so I hope someone here can provide me a bit of
> clarity.
>
>
>
> I am working with tick data, from which ?I have been constructing an xts
> object with a datetime field and a price field, from which I then construct
> one minute OHLC data. ?I know I have to use zoo's function to interpolate
> missing data (since there are a few minutes through the data when nothing
> was traded, even for a high volume futures contract).
>
>
>
> I want to use rollapply on daily data to apply my analysis to daily data
> between 9:30AM EST and 4:30PM EST as that is when most of the trading of
> these contracts happen, but there I sporadic trading of these contracts
> outside those times which I would like to ignore.
>
>
>
> I have found rollapply easy to use (and that is why I need zoo's
> interpolation capability so it doesn't fail because of missing data), and
> have seen apply.daily.
>
>
>
> I thus expect I need two functions: 1) to do my analysis (already done and
> working fine - this returns a data.frame with all the variables I require in
> my output); 2) a function to invoke rollapply on a daily sample, and which I
> can pass to apply.daily in order to get results for all the days for which I
> have data.
>
>
>
> What I don't know how to do is how to tell rollapply that it is to work only
> on values with times between my start and end times, for whatever date's
> data it happens to get, or how to combine the results for each day into a
> single data.frame or zoo or xts object.
>
>
>
> I guess my question amounts to how I can do this in R, with the capabilities
> of zoo and/or xts, or do I have to resort to using a mix of SQL, Perl and R
> to get it done (i.e. make a driver script in Perl that gets a day's worth of
> data between the right times from my DB using SQL, and then passes that data
> to ?my R script).
>

See ?window.zoo

or perhaps depending on specifics:

hm <- as.numeric(format(time(z), "%H%M"))
z[hm >= 930 & hm <= 1600)]

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From jeffrey.ryan at lemnica.com  Sat Jan 28 20:13:53 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Sat, 28 Jan 2012 13:13:53 -0600
Subject: [R-SIG-Finance] Constructing suitable temporal subsamples using
 zoo and/or xts
In-Reply-To: <CAP01uRmUQRDkQ48hgBxGSz1F0CW=x3P3sghmQ5kyondWnW3=zg@mail.gmail.com>
References: <d12b01ccddeb$c2c97f20$485c7d60$@gmail.com>
	<CAP01uRmUQRDkQ48hgBxGSz1F0CW=x3P3sghmQ5kyondWnW3=zg@mail.gmail.com>
Message-ID: <CABDUZc8RqW9=Mmhr=ewjFkrLz977Z4tpR1ZBWRoCA5Y-DqPSyw@mail.gmail.com>

Not entirely sure what you mean by 'rolling' analysis.  If you mean
apply by day then this will do the trick:

do.call(rbind, lapply( split(x['T09:30/T16:00'], "days"),  function(x)
do_something(x)))

If you mean just filter out the extraneous times you only need:

x['T09:30/T16:00']

Sample code (small, reproducible) is always requested for the sake of
clarity and getting the answer you are expecting from the list.  When
asking for help of the list or authors, remember that other's time is
worth more than yours for that small moment.

If that isn't what you are looking for, see above - but whatever you
do don't resort to perl ;-)

Best,
Jeff

On Sat, Jan 28, 2012 at 1:04 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Sat, Jan 28, 2012 at 1:36 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
>> I am managing to confuse myself with what I am seeing in the docs, and
>> results returned by Google, so I hope someone here can provide me a bit of
>> clarity.
>>
>>
>>
>> I am working with tick data, from which ?I have been constructing an xts
>> object with a datetime field and a price field, from which I then construct
>> one minute OHLC data. ?I know I have to use zoo's function to interpolate
>> missing data (since there are a few minutes through the data when nothing
>> was traded, even for a high volume futures contract).
>>
>>
>>
>> I want to use rollapply on daily data to apply my analysis to daily data
>> between 9:30AM EST and 4:30PM EST as that is when most of the trading of
>> these contracts happen, but there I sporadic trading of these contracts
>> outside those times which I would like to ignore.
>>
>>
>>
>> I have found rollapply easy to use (and that is why I need zoo's
>> interpolation capability so it doesn't fail because of missing data), and
>> have seen apply.daily.
>>
>>
>>
>> I thus expect I need two functions: 1) to do my analysis (already done and
>> working fine - this returns a data.frame with all the variables I require in
>> my output); 2) a function to invoke rollapply on a daily sample, and which I
>> can pass to apply.daily in order to get results for all the days for which I
>> have data.
>>
>>
>>
>> What I don't know how to do is how to tell rollapply that it is to work only
>> on values with times between my start and end times, for whatever date's
>> data it happens to get, or how to combine the results for each day into a
>> single data.frame or zoo or xts object.
>>
>>
>>
>> I guess my question amounts to how I can do this in R, with the capabilities
>> of zoo and/or xts, or do I have to resort to using a mix of SQL, Perl and R
>> to get it done (i.e. make a driver script in Perl that gets a day's worth of
>> data between the right times from my DB using SQL, and then passes that data
>> to ?my R script).
>>
>
> See ?window.zoo
>
> or perhaps depending on specifics:
>
> hm <- as.numeric(format(time(z), "%H%M"))
> z[hm >= 930 & hm <= 1600)]
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From eric.thungstrom at gmail.com  Sat Jan 28 21:16:58 2012
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Sat, 28 Jan 2012 15:16:58 -0500
Subject: [R-SIG-Finance] PerfomanceAnalytics
Message-ID: <CACv3XECKvukE8j7th6Wxnr9a64+zZ4Jn1qDiwRdx7_GM-2DL=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120128/7a31eecc/attachment.pl>

From brian at braverock.com  Sat Jan 28 22:41:59 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 28 Jan 2012 15:41:59 -0600
Subject: [R-SIG-Finance] PerfomanceAnalytics
In-Reply-To: <CACv3XECKvukE8j7th6Wxnr9a64+zZ4Jn1qDiwRdx7_GM-2DL=g@mail.gmail.com>
References: <CACv3XECKvukE8j7th6Wxnr9a64+zZ4Jn1qDiwRdx7_GM-2DL=g@mail.gmail.com>
Message-ID: <1327786919.24988.214.camel@brian-rcg>


On Sat, 2012-01-28 at 15:16 -0500, Eric Thungstom wrote:
> I'm having a little trouble understanding why my calculated values are not
> matching up with what's being shown on the PerformanceAnalytics chart and
> drawdown table:
> 
> My calculated equity = 2.83
> Cumulative return on the PerformanceAnalytics chart shows about 2.05
> 
> table.Drawdowns shows the worst drawdown as about 23%
> Drawdown chart shows worst drawdown at about 13%
> 
> table.Drawdown shows the worst drawdown beginning on Nov 01, 2011
> If I look at the cumulative return chart, it seem to start around July 2007
> 
> My code is as follows:
<... snip ...>

You're mixing simple and log returns.

require(quantmod)
require(PerformanceAnalytics)

getSymbols("FAIRX", from='2000-01-01', to=Sys.Date())
FAIRX  <-na.locf(FAIRX )

ind <- EMA(Ad(FAIRX),100)

sig <- Lag(ifelse(ind > Lag(ind,30), 1, 0))

#ret <- diff(log(Ad(FAIRX )))*sig
ret <- Delt(Ad(FAIRX ))*sig
bh.ret <- Delt(Ad(FAIRX ))
#bh.ret <- Delt(Ad(FAIRX ), type='log')
ret[is.na(ret)] <- 0

eq <- exp(cumsum(ret))

table <- na.omit(merge.xts(Ad(FAIRX ), round(ind,3), sig, round(ret,3),
                           round(bh.ret,3),round(eq,3)))
names(table) <-c("SP5", "ind", "sig", "rtn", "bhrtn", "equity")

table.Drawdowns(ret, top=5)
table.DownsideRisk(ret)
charts.PerformanceSummary(table[,c("rtn","bhrtn")], wealth.index=TRUE,
                          colorset=rich6equal, lwd=1, ylog=FALSE,
geometric=TRUE)
print(tail(table))


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From r.ted.byers at gmail.com  Sun Jan 29 18:51:32 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Sun, 29 Jan 2012 12:51:32 -0500
Subject: [R-SIG-Finance] troubles with apply.daily
Message-ID: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120129/79b04eca/attachment.pl>

From michael.weylandt at gmail.com  Mon Jan 30 05:02:10 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sun, 29 Jan 2012 23:02:10 -0500
Subject: [R-SIG-Finance] troubles with apply.daily
In-Reply-To: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>
References: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>
Message-ID: <CAAmySGMpN1N1cjDLkuEnfdLmcAHCNU=jWMG4jFvVgNm2FSjKrg@mail.gmail.com>

I'm not sure time() is very good for what you want to do. It's tied to
R's builtin ts class, which, and it pains me to say this about R,
really isn't very good (at least for finance-y things). I think all
your problems come from that...

Perhaps construct your new index sequence as:

seq(start(alpha), end(alpha), by = "min")

Since you didn't supply example data, let's try this (admittedly
absurd) analysis to showcase how these techniques should work:

library(quantmod)
getSymbols("AAPL")
AAPL <- Cl(AAPL)

## Force to have daily (including non-trading days) points
AAPL <- na.approx(AAPL, xout = seq(start(AAPL), end(AAPL), by = "day"))

# check that it worked
head(AAPL, 20)

# Now we aggregate to weekly
AAPL.w <- to.weekly(AAPL)

# and now we apply a function monthly
apply.monthly(AAPL.w, max)

So everything seems to be in order. Does this help?

Michael


On Sun, Jan 29, 2012 at 12:51 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
> I do not understand this, either to figure out the cause, let alone the fix.
>
>
>
> Here is what I tried:
>
>
>
> myfun <- function(d) {
>
> ?str(d)
>
> }
>
> apply.daily(alpha,myfun)
>
>
>
> And here are what the beginning and end of alpha (an xts object created by
> to.minute()):
>
>
>
>> head(alpha)
>
> ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low Close
>
> 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360
>
> 2011-03-10 00:00:01 10350.06 10364.97 10350.06 10360
>
> 2011-03-10 00:00:02 10350.11 10364.94 10350.11 10360
>
> 2011-03-10 00:00:03 10350.17 10364.92 10350.17 10360
>
> 2011-03-10 00:00:04 10350.22 10364.89 10350.22 10360
>
> 2011-03-10 00:00:05 10350.28 10364.86 10350.28 10360
>
>> tail(alpha)
>
> ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
>
> 2011-06-08 23:55:55 9430 9430 9430 ?9430
>
> 2011-06-08 23:55:56 9430 9430 9430 ?9430
>
> 2011-06-08 23:55:57 9430 9430 9430 ?9430
>
> 2011-06-08 23:55:58 9430 9430 9430 ?9430
>
> 2011-06-08 23:55:59 9430 9430 9430 ?9430
>
> 2011-06-08 23:56:00 9430 9430 9430 ?9430
>
>>
>
>
>
> There is almost three months of tick data here, converted to one minute OHLC
> data.
>
>
>
> I had apparently successfully used the following to ensure I had an even
> time series with values for every minute from start to end:
>
>
>
> tseq <- seq(start(alpha),end(alpha), by = time("00:01:00"))
>
> alpha <- na.approx(alpha, xout = tseq)
>
>
>
> But there is something weird here. ?How is it that alpha appears to have
> rows for every second from the start to the end, rather than 'just' for
> every minute?
>
>
>
> Now here is what the output looks like:
>
>
>
> An 'xts' object from 2011-06-05 to 2011-06-05 23:59:59 containing:
>
> ?Data: num [1:86400, 1:4] 9437 9437 9437 9437 9437 ...
>
> - attr(*, "dimnames")=List of 2
>
> ?..$ : NULL
>
> ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>
> ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>
> ?xts Attributes:
>
> ?NULL
>
> An 'xts' object from 2011-06-06 to 2011-06-06 23:59:59 containing:
>
> ?Data: num [1:86400, 1:4] 9420 9420 9420 9420 9420 ...
>
> - attr(*, "dimnames")=List of 2
>
> ?..$ : NULL
>
> ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>
> ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>
> ?xts Attributes:
>
> ?NULL
>
> An 'xts' object from 2011-06-07 to 2011-06-07 23:59:59 containing:
>
> ?Data: num [1:86400, 1:4] 9428 9428 9428 9428 9428 ...
>
> - attr(*, "dimnames")=List of 2
>
> ?..$ : NULL
>
> ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>
> ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>
> ?xts Attributes:
>
> ?NULL
>
> An 'xts' object from 2011-06-08 to 2011-06-08 23:56:00 containing:
>
> ?Data: num [1:86161, 1:4] 9435 9435 9435 9435 9435 ...
>
> - attr(*, "dimnames")=List of 2
>
> ?..$ : NULL
>
> ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>
> ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>
> ?xts Attributes:
>
> ?NULL
>
> Error in coredata.xts(x) : currently unsupported data type
>
>
>
> Now, I do not understand what is happening here. ?The data seem consistent
> throughout, so why would it crash and burn on the very last day, and only on
> that day, of the three months of data
>
>
>
> Any insight would be greatly appreciated.
>
>
>
> Thanks
>
>
>
> Ted
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From r.ted.byers at gmail.com  Mon Jan 30 05:50:52 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Sun, 29 Jan 2012 23:50:52 -0500
Subject: [R-SIG-Finance] troubles with apply.daily
In-Reply-To: <CAAmySGMpN1N1cjDLkuEnfdLmcAHCNU=jWMG4jFvVgNm2FSjKrg@mail.gmail.com>
References: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>
	<CAAmySGMpN1N1cjDLkuEnfdLmcAHCNU=jWMG4jFvVgNm2FSjKrg@mail.gmail.com>
Message-ID: <dca201ccdf0a$bf326640$3d9732c0$@gmail.com>

Hi Michael,

Thanks for your help.

Yes, your example works fine for me.

Example data is a problem because of the quantity of data needed to produce
the problem.  I have, for example, a file of a few hundred kilobyes, for
tick data for less than a day, and the problem does not materialize with it.
I have another file of many tens of megabytes on which it invariably
happens.  I don't know how large a data file is needed to produce he
problem.  I really don't think you want me sending such a large dataset...

I have been investigating, and have progressed to a state where I am not
mixing types of time objects.

One of the curiousities is that it does not affect the processing of
relatively tiny files, but I see it only on larger files (representing 3
months of data)

Now the steps I use to prepare my data are:

x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
str(x)

dt<-sprintf("%s %04d",x$V2,x$V4)
dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
dt <- as.POSIXct(dt)
y <- data.frame(dt,x$V5)
colnames(y) <- c("tickdate","price")
z <- xts(y[,2],y[,1])
#alpha <- to.minutes3(z, OHLC=TRUE)
alpha <- to.minutes(z, OHLC=TRUE, drop.time=FALSE)
colnames(alpha) <- c("Open","High","Low","Close")
#tseq <- seq(start(alpha),end(alpha), by = 60)
tseq <- seq(start(alpha),end(alpha), by = "min")
alpha <- na.approx(alpha, xout = tseq)
head(alpha)
tail(alpha)

The latter two calls produce:

> head(alpha)
                        Open     High      Low   Close
2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360.0
2011-03-10 00:01:00 10353.33 10363.33 10353.33 10360.0
2011-03-10 00:02:00 10356.67 10361.67 10356.67 10360.0
2011-03-10 00:03:00 10360.00 10360.00 10360.00 10360.0
2011-03-10 00:04:00 10360.00 10360.00 10360.00 10360.0
2011-03-10 00:05:00 10361.50 10361.50 10361.50 10361.5
> tail(alpha)
                    Open High  Low Close
2011-06-08 23:51:00 9430 9430 9430  9430
2011-06-08 23:52:00 9430 9430 9430  9430
2011-06-08 23:53:00 9430 9430 9430  9430
2011-06-08 23:54:00 9430 9430 9430  9430
2011-06-08 23:55:00 9430 9430 9430  9430
2011-06-08 23:56:00 9430 9430 9430  9430


Aas you can see, the data look fine.

Alas, it seems neither rollapply nor apply.daily like it, yet.

> tr <- rollapply(alpha,width=20,FUN=rollRegFun,by.column=FALSE,
align="right")
Error in if (b < 1e-07) { : missing value where TRUE/FALSE needed

And the following:

myfun <- function(d) {
  str(d)
}
apply.daily(alpha,myfun)

Produces output right to the last day, but then dies (the output from the
last day processed successfully and the error):

An ?xts? object from 2011-06-08 to 2011-06-08 23:56:00 containing:
  Data: num [1:1437, 1:4] 9435 9435 9440 9445 9450 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:4] "Open" "High" "Low" "Close"
  Indexed by objects of class: [POSIXct,POSIXt] TZ: 
  xts Attributes:  
 NULL
Error in coredata.xts(x) : currently unsupported data type
>

As you can see, all of the data from the last day for which there was data
in the file was processed (in this case by str()), but then it looks like
apply.data() tries to apply myfun on data for the day after the last day for
which there is data, and not surprisingly doesn't find any.  I gues, the
questin becomes why does apply.daily try to go past the last date in the
data?

I do hope that the problem I am seeing in rollapply and that I see when
using apply.daily are related, as that would mean that I fix one and the
other gets fixed.

Any other ideas?

Thanks

Ted

> -----Original Message-----
> From: R. Michael Weylandt [mailto:michael.weylandt at gmail.com]
> Sent: January-29-12 11:02 PM
> To: Ted Byers
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] troubles with apply.daily
> 
> I'm not sure time() is very good for what you want to do. It's tied to R's
builtin ts
> class, which, and it pains me to say this about R, really isn't very good
(at least
> for finance-y things). I think all your problems come from that...
> 
> Perhaps construct your new index sequence as:
> 
> seq(start(alpha), end(alpha), by = "min")
> 
> Since you didn't supply example data, let's try this (admittedly
> absurd) analysis to showcase how these techniques should work:
> 
> library(quantmod)
> getSymbols("AAPL")
> AAPL <- Cl(AAPL)
> 
> ## Force to have daily (including non-trading days) points AAPL <-
> na.approx(AAPL, xout = seq(start(AAPL), end(AAPL), by = "day"))
> 
> # check that it worked
> head(AAPL, 20)
> 
> # Now we aggregate to weekly
> AAPL.w <- to.weekly(AAPL)
> 
> # and now we apply a function monthly
> apply.monthly(AAPL.w, max)
> 
> So everything seems to be in order. Does this help?
> 
> Michael
> 
> 
> On Sun, Jan 29, 2012 at 12:51 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
> > I do not understand this, either to figure out the cause, let alone the
fix.
> >
> >
> >
> > Here is what I tried:
> >
> >
> >
> > myfun <- function(d) {
> >
> > ?str(d)
> >
> > }
> >
> > apply.daily(alpha,myfun)
> >
> >
> >
> > And here are what the beginning and end of alpha (an xts object
> > created by
> > to.minute()):
> >
> >
> >
> >> head(alpha)
> >
> > ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low Close
> >
> > 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360
> >
> > 2011-03-10 00:00:01 10350.06 10364.97 10350.06 10360
> >
> > 2011-03-10 00:00:02 10350.11 10364.94 10350.11 10360
> >
> > 2011-03-10 00:00:03 10350.17 10364.92 10350.17 10360
> >
> > 2011-03-10 00:00:04 10350.22 10364.89 10350.22 10360
> >
> > 2011-03-10 00:00:05 10350.28 10364.86 10350.28 10360
> >
> >> tail(alpha)
> >
> > ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
> >
> > 2011-06-08 23:55:55 9430 9430 9430 ?9430
> >
> > 2011-06-08 23:55:56 9430 9430 9430 ?9430
> >
> > 2011-06-08 23:55:57 9430 9430 9430 ?9430
> >
> > 2011-06-08 23:55:58 9430 9430 9430 ?9430
> >
> > 2011-06-08 23:55:59 9430 9430 9430 ?9430
> >
> > 2011-06-08 23:56:00 9430 9430 9430 ?9430
> >
> >>
> >
> >
> >
> > There is almost three months of tick data here, converted to one
> > minute OHLC data.
> >
> >
> >
> > I had apparently successfully used the following to ensure I had an
> > even time series with values for every minute from start to end:
> >
> >
> >
> > tseq <- seq(start(alpha),end(alpha), by = time("00:01:00"))
> >
> > alpha <- na.approx(alpha, xout = tseq)
> >
> >
> >
> > But there is something weird here. ?How is it that alpha appears to
> > have rows for every second from the start to the end, rather than
> > 'just' for every minute?
> >
> >
> >
> > Now here is what the output looks like:
> >
> >
> >
> > An 'xts' object from 2011-06-05 to 2011-06-05 23:59:59 containing:
> >
> > ?Data: num [1:86400, 1:4] 9437 9437 9437 9437 9437 ...
> >
> > - attr(*, "dimnames")=List of 2
> >
> > ?..$ : NULL
> >
> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >
> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >
> > ?xts Attributes:
> >
> > ?NULL
> >
> > An 'xts' object from 2011-06-06 to 2011-06-06 23:59:59 containing:
> >
> > ?Data: num [1:86400, 1:4] 9420 9420 9420 9420 9420 ...
> >
> > - attr(*, "dimnames")=List of 2
> >
> > ?..$ : NULL
> >
> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >
> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >
> > ?xts Attributes:
> >
> > ?NULL
> >
> > An 'xts' object from 2011-06-07 to 2011-06-07 23:59:59 containing:
> >
> > ?Data: num [1:86400, 1:4] 9428 9428 9428 9428 9428 ...
> >
> > - attr(*, "dimnames")=List of 2
> >
> > ?..$ : NULL
> >
> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >
> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >
> > ?xts Attributes:
> >
> > ?NULL
> >
> > An 'xts' object from 2011-06-08 to 2011-06-08 23:56:00 containing:
> >
> > ?Data: num [1:86161, 1:4] 9435 9435 9435 9435 9435 ...
> >
> > - attr(*, "dimnames")=List of 2
> >
> > ?..$ : NULL
> >
> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >
> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >
> > ?xts Attributes:
> >
> > ?NULL
> >
> > Error in coredata.xts(x) : currently unsupported data type
> >
> >
> >
> > Now, I do not understand what is happening here. ?The data seem
> > consistent throughout, so why would it crash and burn on the very last
> > day, and only on that day, of the three months of data
> >
> >
> >
> > Any insight would be greatly appreciated.
> >
> >
> >
> > Thanks
> >
> >
> >
> > Ted
> >
> >
> > ? ? ? ?[[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
should
> go.


From michael.weylandt at gmail.com  Mon Jan 30 05:59:00 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sun, 29 Jan 2012 23:59:00 -0500
Subject: [R-SIG-Finance] troubles with apply.daily
In-Reply-To: <dca201ccdf0a$bf326640$3d9732c0$@gmail.com>
References: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>
	<CAAmySGMpN1N1cjDLkuEnfdLmcAHCNU=jWMG4jFvVgNm2FSjKrg@mail.gmail.com>
	<dca201ccdf0a$bf326640$3d9732c0$@gmail.com>
Message-ID: <CAAmySGMh_cf6Jfxs8tLou27cRuoMU3jCyvypDt4Jpyv4SZA=kQ@mail.gmail.com>

I think I've got it now: consider the following:

x <- xts(1:500, Sys.Date() + 1:500)

apply.weekly(x, max)
apply.weekly(x, str)

The error message is a little subtle: the problem isn't in
apply.weekly() but rather in coredata, which means it's actually in
the function being used to construct the return value. Specifically,
your problem comes from the fact that str() is one of those rare
functions called for its side-effects not its return value. str()
actually always returns NULL invisibly (the printed stuff is a side
effect) and it's impossible to have a NULL (or actually lots of them)
in the values for an xts object. I believe if you run apply.weekly
with a "real function" like max or Hi() or mean() or whatnot, it
should work fine. Can you test this?

I don't know if this explains your problems with rollapply as you
don't define what your function is in the code you share.

Does that work?

Michael

On Sun, Jan 29, 2012 at 11:50 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
> Hi Michael,
>
> Thanks for your help.
>
> Yes, your example works fine for me.
>
> Example data is a problem because of the quantity of data needed to produce
> the problem. ?I have, for example, a file of a few hundred kilobyes, for
> tick data for less than a day, and the problem does not materialize with it.
> I have another file of many tens of megabytes on which it invariably
> happens. ?I don't know how large a data file is needed to produce he
> problem. ?I really don't think you want me sending such a large dataset...
>
> I have been investigating, and have progressed to a state where I am not
> mixing types of time objects.
>
> One of the curiousities is that it does not affect the processing of
> relatively tiny files, but I see it only on larger files (representing 3
> months of data)
>
> Now the steps I use to prepare my data are:
>
> x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
> str(x)
>
> dt<-sprintf("%s %04d",x$V2,x$V4)
> dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M")
> dt <- as.POSIXct(dt)
> y <- data.frame(dt,x$V5)
> colnames(y) <- c("tickdate","price")
> z <- xts(y[,2],y[,1])
> #alpha <- to.minutes3(z, OHLC=TRUE)
> alpha <- to.minutes(z, OHLC=TRUE, drop.time=FALSE)
> colnames(alpha) <- c("Open","High","Low","Close")
> #tseq <- seq(start(alpha),end(alpha), by = 60)
> tseq <- seq(start(alpha),end(alpha), by = "min")
> alpha <- na.approx(alpha, xout = tseq)
> head(alpha)
> tail(alpha)
>
> The latter two calls produce:
>
>> head(alpha)
> ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low ? Close
> 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360.0
> 2011-03-10 00:01:00 10353.33 10363.33 10353.33 10360.0
> 2011-03-10 00:02:00 10356.67 10361.67 10356.67 10360.0
> 2011-03-10 00:03:00 10360.00 10360.00 10360.00 10360.0
> 2011-03-10 00:04:00 10360.00 10360.00 10360.00 10360.0
> 2011-03-10 00:05:00 10361.50 10361.50 10361.50 10361.5
>> tail(alpha)
> ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
> 2011-06-08 23:51:00 9430 9430 9430 ?9430
> 2011-06-08 23:52:00 9430 9430 9430 ?9430
> 2011-06-08 23:53:00 9430 9430 9430 ?9430
> 2011-06-08 23:54:00 9430 9430 9430 ?9430
> 2011-06-08 23:55:00 9430 9430 9430 ?9430
> 2011-06-08 23:56:00 9430 9430 9430 ?9430
>
>
> Aas you can see, the data look fine.
>
> Alas, it seems neither rollapply nor apply.daily like it, yet.
>
>> tr <- rollapply(alpha,width=20,FUN=rollRegFun,by.column=FALSE,
> align="right")
> Error in if (b < 1e-07) { : missing value where TRUE/FALSE needed
>
> And the following:
>
> myfun <- function(d) {
> ?str(d)
> }
> apply.daily(alpha,myfun)
>
> Produces output right to the last day, but then dies (the output from the
> last day processed successfully and the error):
>
> An ?xts? object from 2011-06-08 to 2011-06-08 23:56:00 containing:
> ?Data: num [1:1437, 1:4] 9435 9435 9440 9445 9450 ...
> ?- attr(*, "dimnames")=List of 2
> ?..$ : NULL
> ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> ?xts Attributes:
> ?NULL
> Error in coredata.xts(x) : currently unsupported data type
>>
>
> As you can see, all of the data from the last day for which there was data
> in the file was processed (in this case by str()), but then it looks like
> apply.data() tries to apply myfun on data for the day after the last day for
> which there is data, and not surprisingly doesn't find any. ?I gues, the
> questin becomes why does apply.daily try to go past the last date in the
> data?
>
> I do hope that the problem I am seeing in rollapply and that I see when
> using apply.daily are related, as that would mean that I fix one and the
> other gets fixed.
>
> Any other ideas?
>
> Thanks
>
> Ted
>
>> -----Original Message-----
>> From: R. Michael Weylandt [mailto:michael.weylandt at gmail.com]
>> Sent: January-29-12 11:02 PM
>> To: Ted Byers
>> Cc: r-sig-finance at r-project.org
>> Subject: Re: [R-SIG-Finance] troubles with apply.daily
>>
>> I'm not sure time() is very good for what you want to do. It's tied to R's
> builtin ts
>> class, which, and it pains me to say this about R, really isn't very good
> (at least
>> for finance-y things). I think all your problems come from that...
>>
>> Perhaps construct your new index sequence as:
>>
>> seq(start(alpha), end(alpha), by = "min")
>>
>> Since you didn't supply example data, let's try this (admittedly
>> absurd) analysis to showcase how these techniques should work:
>>
>> library(quantmod)
>> getSymbols("AAPL")
>> AAPL <- Cl(AAPL)
>>
>> ## Force to have daily (including non-trading days) points AAPL <-
>> na.approx(AAPL, xout = seq(start(AAPL), end(AAPL), by = "day"))
>>
>> # check that it worked
>> head(AAPL, 20)
>>
>> # Now we aggregate to weekly
>> AAPL.w <- to.weekly(AAPL)
>>
>> # and now we apply a function monthly
>> apply.monthly(AAPL.w, max)
>>
>> So everything seems to be in order. Does this help?
>>
>> Michael
>>
>>
>> On Sun, Jan 29, 2012 at 12:51 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
>> > I do not understand this, either to figure out the cause, let alone the
> fix.
>> >
>> >
>> >
>> > Here is what I tried:
>> >
>> >
>> >
>> > myfun <- function(d) {
>> >
>> > ?str(d)
>> >
>> > }
>> >
>> > apply.daily(alpha,myfun)
>> >
>> >
>> >
>> > And here are what the beginning and end of alpha (an xts object
>> > created by
>> > to.minute()):
>> >
>> >
>> >
>> >> head(alpha)
>> >
>> > ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low Close
>> >
>> > 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360
>> >
>> > 2011-03-10 00:00:01 10350.06 10364.97 10350.06 10360
>> >
>> > 2011-03-10 00:00:02 10350.11 10364.94 10350.11 10360
>> >
>> > 2011-03-10 00:00:03 10350.17 10364.92 10350.17 10360
>> >
>> > 2011-03-10 00:00:04 10350.22 10364.89 10350.22 10360
>> >
>> > 2011-03-10 00:00:05 10350.28 10364.86 10350.28 10360
>> >
>> >> tail(alpha)
>> >
>> > ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
>> >
>> > 2011-06-08 23:55:55 9430 9430 9430 ?9430
>> >
>> > 2011-06-08 23:55:56 9430 9430 9430 ?9430
>> >
>> > 2011-06-08 23:55:57 9430 9430 9430 ?9430
>> >
>> > 2011-06-08 23:55:58 9430 9430 9430 ?9430
>> >
>> > 2011-06-08 23:55:59 9430 9430 9430 ?9430
>> >
>> > 2011-06-08 23:56:00 9430 9430 9430 ?9430
>> >
>> >>
>> >
>> >
>> >
>> > There is almost three months of tick data here, converted to one
>> > minute OHLC data.
>> >
>> >
>> >
>> > I had apparently successfully used the following to ensure I had an
>> > even time series with values for every minute from start to end:
>> >
>> >
>> >
>> > tseq <- seq(start(alpha),end(alpha), by = time("00:01:00"))
>> >
>> > alpha <- na.approx(alpha, xout = tseq)
>> >
>> >
>> >
>> > But there is something weird here. ?How is it that alpha appears to
>> > have rows for every second from the start to the end, rather than
>> > 'just' for every minute?
>> >
>> >
>> >
>> > Now here is what the output looks like:
>> >
>> >
>> >
>> > An 'xts' object from 2011-06-05 to 2011-06-05 23:59:59 containing:
>> >
>> > ?Data: num [1:86400, 1:4] 9437 9437 9437 9437 9437 ...
>> >
>> > - attr(*, "dimnames")=List of 2
>> >
>> > ?..$ : NULL
>> >
>> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>> >
>> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>> >
>> > ?xts Attributes:
>> >
>> > ?NULL
>> >
>> > An 'xts' object from 2011-06-06 to 2011-06-06 23:59:59 containing:
>> >
>> > ?Data: num [1:86400, 1:4] 9420 9420 9420 9420 9420 ...
>> >
>> > - attr(*, "dimnames")=List of 2
>> >
>> > ?..$ : NULL
>> >
>> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>> >
>> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>> >
>> > ?xts Attributes:
>> >
>> > ?NULL
>> >
>> > An 'xts' object from 2011-06-07 to 2011-06-07 23:59:59 containing:
>> >
>> > ?Data: num [1:86400, 1:4] 9428 9428 9428 9428 9428 ...
>> >
>> > - attr(*, "dimnames")=List of 2
>> >
>> > ?..$ : NULL
>> >
>> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>> >
>> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>> >
>> > ?xts Attributes:
>> >
>> > ?NULL
>> >
>> > An 'xts' object from 2011-06-08 to 2011-06-08 23:56:00 containing:
>> >
>> > ?Data: num [1:86161, 1:4] 9435 9435 9435 9435 9435 ...
>> >
>> > - attr(*, "dimnames")=List of 2
>> >
>> > ?..$ : NULL
>> >
>> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
>> >
>> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
>> >
>> > ?xts Attributes:
>> >
>> > ?NULL
>> >
>> > Error in coredata.xts(x) : currently unsupported data type
>> >
>> >
>> >
>> > Now, I do not understand what is happening here. ?The data seem
>> > consistent throughout, so why would it crash and burn on the very last
>> > day, and only on that day, of the three months of data
>> >
>> >
>> >
>> > Any insight would be greatly appreciated.
>> >
>> >
>> >
>> > Thanks
>> >
>> >
>> >
>> > Ted
>> >
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
> should
>> go.
>


From r.ted.byers at gmail.com  Mon Jan 30 06:13:52 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Mon, 30 Jan 2012 00:13:52 -0500
Subject: [R-SIG-Finance] troubles with apply.daily
In-Reply-To: <CAAmySGMh_cf6Jfxs8tLou27cRuoMU3jCyvypDt4Jpyv4SZA=kQ@mail.gmail.com>
References: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>
	<CAAmySGMpN1N1cjDLkuEnfdLmcAHCNU=jWMG4jFvVgNm2FSjKrg@mail.gmail.com>
	<dca201ccdf0a$bf326640$3d9732c0$@gmail.com>
	<CAAmySGMh_cf6Jfxs8tLou27cRuoMU3jCyvypDt4Jpyv4SZA=kQ@mail.gmail.com>
Message-ID: <dcd501ccdf0d$f60b3400$e2219c00$@gmail.com>

Hi Michael,

Thanks

With:

> x <- xts(1:500, Sys.Date() + 1:500)
> 
> apply.weekly(x, max)
> apply.weekly(x, str)

apply.weekly(x,max) works fine.

apply.weekly(x,str) generates the same error that I was seeing with my data.

Alas, that means the error I am getting with rollapply is due to a different
cause.  :-(

Here are the functions involved in rollapply:

rootFun <- function(pr) {
  rv = 100000000000000000000
  n = length(pr)
  for (i in 1:n) {
    a = Re(pr[i])
    b = abs(Im(pr[i]))
    if (b < 0.0000001) {
      if (abs(a) < 0.25) {
        rv = a
      } else {
        if ((a < 0) && (a > rv)) {
          rv = a
        } else {
          if (rv > a) {
            rv = a
          }
        }
      }
    }
  }
  rv
}

rollRegFun <- function(d) {
  cmultiplier <- 5
  d <- data.frame(d, rt=seq(1-nrow(d),0));
  polyfit <- lm(Close ~ poly(rt,4),d)
  z <- summary(polyfit)
  r2 <- z$r.squared
  confint(polyfit)
  p <- coef(polyfit)
  pr <- polyroot(c(p[2],2*p[3],3*p[4],4*p[5]))
  dd <- function(x) {  rv = 2*p[3]+6*p[4]*x+12*p[5]*x*x;rv;}
  r <- as.double(rootFun(pr))
  acc <- dd(r)
  sig <- 'U'
  n <- nrow(d)
  sigprice <- d$Close[n]
  ub <- 0
  lb <- 0
  stopprice <- 0
  ci <- confint(polyfit, level=0.999)
  if (abs(r) < 0.25) {
    lb <- ci[1]
    ub <- ci[6]
#    sigprice <- as.double(p[1])
    sigprice <- d$Close[n]
    if (acc > 0) {
      sig <- 'B'
      sigprice <- floor(sigprice/cmultiplier)*cmultiplier
      stopprice <- floor(lb/cmultiplier)*cmultiplier
      if ((sigprice - stopprice) < 15) {
        stopprice = sigprice - 15
      }
    } else {
      sig <- 'S'
      sigprice <- ceiling(sigprice/cmultiplier)*cmultiplier
      stopprice <- ceiling(ub/cmultiplier)*cmultiplier
      if ((stopprice - sigprice) < 15) {
        stopprice = sigprice + 15
      }
    }
  }
  rv <- data.frame(r,acc,sig,sigprice,lb,ub,stopprice, r2)
  rv
}

Do these tell you anything about what may be awry with my use of rollapply?
And is there a way to get R to give more detail about what it is that it
doesn't like, and what part of my code is to blame?

Thanks again

Ted


> -----Original Message-----
> From: R. Michael Weylandt [mailto:michael.weylandt at gmail.com]
> Sent: January-29-12 11:59 PM
> To: Ted Byers
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] troubles with apply.daily
> 
> I think I've got it now: consider the following:
> 
> x <- xts(1:500, Sys.Date() + 1:500)
> 
> apply.weekly(x, max)
> apply.weekly(x, str)
> 
> The error message is a little subtle: the problem isn't in
> apply.weekly() but rather in coredata, which means it's actually in the
function
> being used to construct the return value. Specifically, your problem comes
from
> the fact that str() is one of those rare functions called for its
side-effects not its
> return value. str() actually always returns NULL invisibly (the printed
stuff is a
> side
> effect) and it's impossible to have a NULL (or actually lots of them) in
the
> values for an xts object. I believe if you run apply.weekly with a "real
function"
> like max or Hi() or mean() or whatnot, it should work fine. Can you test
this?
> 
> I don't know if this explains your problems with rollapply as you don't
define
> what your function is in the code you share.
> 
> Does that work?
> 
> Michael
> 
> On Sun, Jan 29, 2012 at 11:50 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
> > Hi Michael,
> >
> > Thanks for your help.
> >
> > Yes, your example works fine for me.
> >
> > Example data is a problem because of the quantity of data needed to
> > produce the problem. ?I have, for example, a file of a few hundred
> > kilobyes, for tick data for less than a day, and the problem does not
> materialize with it.
> > I have another file of many tens of megabytes on which it invariably
> > happens. ?I don't know how large a data file is needed to produce he
> > problem. ?I really don't think you want me sending such a large
dataset...
> >
> > I have been investigating, and have progressed to a state where I am
> > not mixing types of time objects.
> >
> > One of the curiousities is that it does not affect the processing of
> > relatively tiny files, but I see it only on larger files (representing
> > 3 months of data)
> >
> > Now the steps I use to prepare my data are:
> >
> > x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
> > str(x)
> >
> > dt<-sprintf("%s %04d",x$V2,x$V4)
> > dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M") dt <- as.POSIXct(dt) y <-
> > data.frame(dt,x$V5)
> > colnames(y) <- c("tickdate","price")
> > z <- xts(y[,2],y[,1])
> > #alpha <- to.minutes3(z, OHLC=TRUE)
> > alpha <- to.minutes(z, OHLC=TRUE, drop.time=FALSE)
> > colnames(alpha) <- c("Open","High","Low","Close") #tseq <-
> > seq(start(alpha),end(alpha), by = 60) tseq <-
> > seq(start(alpha),end(alpha), by = "min") alpha <- na.approx(alpha,
> > xout = tseq)
> > head(alpha)
> > tail(alpha)
> >
> > The latter two calls produce:
> >
> >> head(alpha)
> > ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low ? Close
> > 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360.0
> > 2011-03-10 00:01:00 10353.33 10363.33 10353.33 10360.0
> > 2011-03-10 00:02:00 10356.67 10361.67 10356.67 10360.0
> > 2011-03-10 00:03:00 10360.00 10360.00 10360.00 10360.0
> > 2011-03-10 00:04:00 10360.00 10360.00 10360.00 10360.0
> > 2011-03-10 00:05:00 10361.50 10361.50 10361.50 10361.5
> >> tail(alpha)
> > ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
> > 2011-06-08 23:51:00 9430 9430 9430 ?9430
> > 2011-06-08 23:52:00 9430 9430 9430 ?9430
> > 2011-06-08 23:53:00 9430 9430 9430 ?9430
> > 2011-06-08 23:54:00 9430 9430 9430 ?9430
> > 2011-06-08 23:55:00 9430 9430 9430 ?9430
> > 2011-06-08 23:56:00 9430 9430 9430 ?9430
> >
> >
> > Aas you can see, the data look fine.
> >
> > Alas, it seems neither rollapply nor apply.daily like it, yet.
> >
> >> tr <- rollapply(alpha,width=20,FUN=rollRegFun,by.column=FALSE,
> > align="right")
> > Error in if (b < 1e-07) { : missing value where TRUE/FALSE needed
> >
> > And the following:
> >
> > myfun <- function(d) {
> > ?str(d)
> > }
> > apply.daily(alpha,myfun)
> >
> > Produces output right to the last day, but then dies (the output from
> > the last day processed successfully and the error):
> >
> > An ?xts? object from 2011-06-08 to 2011-06-08 23:56:00 containing:
> > ?Data: num [1:1437, 1:4] 9435 9435 9440 9445 9450 ...
> > ?- attr(*, "dimnames")=List of 2
> > ?..$ : NULL
> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> > ?xts Attributes:
> > ?NULL
> > Error in coredata.xts(x) : currently unsupported data type
> >>
> >
> > As you can see, all of the data from the last day for which there was
> > data in the file was processed (in this case by str()), but then it
> > looks like
> > apply.data() tries to apply myfun on data for the day after the last
> > day for which there is data, and not surprisingly doesn't find any. ?I
> > gues, the questin becomes why does apply.daily try to go past the last
> > date in the data?
> >
> > I do hope that the problem I am seeing in rollapply and that I see
> > when using apply.daily are related, as that would mean that I fix one
> > and the other gets fixed.
> >
> > Any other ideas?
> >
> > Thanks
> >
> > Ted
> >
> >> -----Original Message-----
> >> From: R. Michael Weylandt [mailto:michael.weylandt at gmail.com]
> >> Sent: January-29-12 11:02 PM
> >> To: Ted Byers
> >> Cc: r-sig-finance at r-project.org
> >> Subject: Re: [R-SIG-Finance] troubles with apply.daily
> >>
> >> I'm not sure time() is very good for what you want to do. It's tied
> >> to R's
> > builtin ts
> >> class, which, and it pains me to say this about R, really isn't very
> >> good
> > (at least
> >> for finance-y things). I think all your problems come from that...
> >>
> >> Perhaps construct your new index sequence as:
> >>
> >> seq(start(alpha), end(alpha), by = "min")
> >>
> >> Since you didn't supply example data, let's try this (admittedly
> >> absurd) analysis to showcase how these techniques should work:
> >>
> >> library(quantmod)
> >> getSymbols("AAPL")
> >> AAPL <- Cl(AAPL)
> >>
> >> ## Force to have daily (including non-trading days) points AAPL <-
> >> na.approx(AAPL, xout = seq(start(AAPL), end(AAPL), by = "day"))
> >>
> >> # check that it worked
> >> head(AAPL, 20)
> >>
> >> # Now we aggregate to weekly
> >> AAPL.w <- to.weekly(AAPL)
> >>
> >> # and now we apply a function monthly apply.monthly(AAPL.w, max)
> >>
> >> So everything seems to be in order. Does this help?
> >>
> >> Michael
> >>
> >>
> >> On Sun, Jan 29, 2012 at 12:51 PM, Ted Byers <r.ted.byers at gmail.com>
> wrote:
> >> > I do not understand this, either to figure out the cause, let alone
> >> > the
> > fix.
> >> >
> >> >
> >> >
> >> > Here is what I tried:
> >> >
> >> >
> >> >
> >> > myfun <- function(d) {
> >> >
> >> > ?str(d)
> >> >
> >> > }
> >> >
> >> > apply.daily(alpha,myfun)
> >> >
> >> >
> >> >
> >> > And here are what the beginning and end of alpha (an xts object
> >> > created by
> >> > to.minute()):
> >> >
> >> >
> >> >
> >> >> head(alpha)
> >> >
> >> > ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low Close
> >> >
> >> > 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360
> >> >
> >> > 2011-03-10 00:00:01 10350.06 10364.97 10350.06 10360
> >> >
> >> > 2011-03-10 00:00:02 10350.11 10364.94 10350.11 10360
> >> >
> >> > 2011-03-10 00:00:03 10350.17 10364.92 10350.17 10360
> >> >
> >> > 2011-03-10 00:00:04 10350.22 10364.89 10350.22 10360
> >> >
> >> > 2011-03-10 00:00:05 10350.28 10364.86 10350.28 10360
> >> >
> >> >> tail(alpha)
> >> >
> >> > ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
> >> >
> >> > 2011-06-08 23:55:55 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:56 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:57 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:58 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:59 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:56:00 9430 9430 9430 ?9430
> >> >
> >> >>
> >> >
> >> >
> >> >
> >> > There is almost three months of tick data here, converted to one
> >> > minute OHLC data.
> >> >
> >> >
> >> >
> >> > I had apparently successfully used the following to ensure I had an
> >> > even time series with values for every minute from start to end:
> >> >
> >> >
> >> >
> >> > tseq <- seq(start(alpha),end(alpha), by = time("00:01:00"))
> >> >
> >> > alpha <- na.approx(alpha, xout = tseq)
> >> >
> >> >
> >> >
> >> > But there is something weird here. ?How is it that alpha appears to
> >> > have rows for every second from the start to the end, rather than
> >> > 'just' for every minute?
> >> >
> >> >
> >> >
> >> > Now here is what the output looks like:
> >> >
> >> >
> >> >
> >> > An 'xts' object from 2011-06-05 to 2011-06-05 23:59:59 containing:
> >> >
> >> > ?Data: num [1:86400, 1:4] 9437 9437 9437 9437 9437 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > An 'xts' object from 2011-06-06 to 2011-06-06 23:59:59 containing:
> >> >
> >> > ?Data: num [1:86400, 1:4] 9420 9420 9420 9420 9420 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > An 'xts' object from 2011-06-07 to 2011-06-07 23:59:59 containing:
> >> >
> >> > ?Data: num [1:86400, 1:4] 9428 9428 9428 9428 9428 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > An 'xts' object from 2011-06-08 to 2011-06-08 23:56:00 containing:
> >> >
> >> > ?Data: num [1:86161, 1:4] 9435 9435 9435 9435 9435 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > Error in coredata.xts(x) : currently unsupported data type
> >> >
> >> >
> >> >
> >> > Now, I do not understand what is happening here. ?The data seem
> >> > consistent throughout, so why would it crash and burn on the very
> >> > last day, and only on that day, of the three months of data
> >> >
> >> >
> >> >
> >> > Any insight would be greatly appreciated.
> >> >
> >> >
> >> >
> >> > Thanks
> >> >
> >> >
> >> >
> >> > Ted
> >> >
> >> >
> >> > ? ? ? ?[[alternative HTML version deleted]]
> >> >
> >> > _______________________________________________
> >> > R-SIG-Finance at r-project.org mailing list
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> > -- Subscriber-posting only. If you want to post, subscribe first.
> >> > -- Also note that this is not the r-help list where general R
> >> > questions
> > should
> >> go.
> >


From r.ted.byers at gmail.com  Mon Jan 30 06:30:04 2012
From: r.ted.byers at gmail.com (Ted Byers)
Date: Mon, 30 Jan 2012 00:30:04 -0500
Subject: [R-SIG-Finance] troubles with apply.daily
In-Reply-To: <CAAmySGMh_cf6Jfxs8tLou27cRuoMU3jCyvypDt4Jpyv4SZA=kQ@mail.gmail.com>
References: <d74301ccdeae$a42844c0$ec78ce40$@gmail.com>
	<CAAmySGMpN1N1cjDLkuEnfdLmcAHCNU=jWMG4jFvVgNm2FSjKrg@mail.gmail.com>
	<dca201ccdf0a$bf326640$3d9732c0$@gmail.com>
	<CAAmySGMh_cf6Jfxs8tLou27cRuoMU3jCyvypDt4Jpyv4SZA=kQ@mail.gmail.com>
Message-ID: <dcea01ccdf10$395def70$ac19ce50$@gmail.com>

I just managed to make a function that applies rollapply to the data passed
as an argument, and that apply.daily then applies to alpha that you saw me
construct.

It now occurs to me that by doing the interpolation as I do, to ensure I
have records for every minute, it will be producing an interpolation for the
weekends too.  Is there a way to tell apply.daily to apply the function
provided only to those days when the market was open?

> -----Original Message-----
> From: R. Michael Weylandt [mailto:michael.weylandt at gmail.com]
> Sent: January-29-12 11:59 PM
> To: Ted Byers
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] troubles with apply.daily
> 
> I think I've got it now: consider the following:
> 
> x <- xts(1:500, Sys.Date() + 1:500)
> 
> apply.weekly(x, max)
> apply.weekly(x, str)
> 
> The error message is a little subtle: the problem isn't in
> apply.weekly() but rather in coredata, which means it's actually in the
function
> being used to construct the return value. Specifically, your problem comes
from
> the fact that str() is one of those rare functions called for its
side-effects not its
> return value. str() actually always returns NULL invisibly (the printed
stuff is a
> side
> effect) and it's impossible to have a NULL (or actually lots of them) in
the
> values for an xts object. I believe if you run apply.weekly with a "real
function"
> like max or Hi() or mean() or whatnot, it should work fine. Can you test
this?
> 
> I don't know if this explains your problems with rollapply as you don't
define
> what your function is in the code you share.
> 
> Does that work?
> 
> Michael
> 
> On Sun, Jan 29, 2012 at 11:50 PM, Ted Byers <r.ted.byers at gmail.com> wrote:
> > Hi Michael,
> >
> > Thanks for your help.
> >
> > Yes, your example works fine for me.
> >
> > Example data is a problem because of the quantity of data needed to
> > produce the problem. ?I have, for example, a file of a few hundred
> > kilobyes, for tick data for less than a day, and the problem does not
> materialize with it.
> > I have another file of many tens of megabytes on which it invariably
> > happens. ?I don't know how large a data file is needed to produce he
> > problem. ?I really don't think you want me sending such a large
dataset...
> >
> > I have been investigating, and have progressed to a state where I am
> > not mixing types of time objects.
> >
> > One of the curiousities is that it does not affect the processing of
> > relatively tiny files, but I see it only on larger files (representing
> > 3 months of data)
> >
> > Now the steps I use to prepare my data are:
> >
> > x = read.table("quotes_M11.dat", header = FALSE, sep="\t", skip=0)
> > str(x)
> >
> > dt<-sprintf("%s %04d",x$V2,x$V4)
> > dt<-as.POSIXlt(dt,format="%Y-%m-%d %H%M") dt <- as.POSIXct(dt) y <-
> > data.frame(dt,x$V5)
> > colnames(y) <- c("tickdate","price")
> > z <- xts(y[,2],y[,1])
> > #alpha <- to.minutes3(z, OHLC=TRUE)
> > alpha <- to.minutes(z, OHLC=TRUE, drop.time=FALSE)
> > colnames(alpha) <- c("Open","High","Low","Close") #tseq <-
> > seq(start(alpha),end(alpha), by = 60) tseq <-
> > seq(start(alpha),end(alpha), by = "min") alpha <- na.approx(alpha,
> > xout = tseq)
> > head(alpha)
> > tail(alpha)
> >
> > The latter two calls produce:
> >
> >> head(alpha)
> > ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low ? Close
> > 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360.0
> > 2011-03-10 00:01:00 10353.33 10363.33 10353.33 10360.0
> > 2011-03-10 00:02:00 10356.67 10361.67 10356.67 10360.0
> > 2011-03-10 00:03:00 10360.00 10360.00 10360.00 10360.0
> > 2011-03-10 00:04:00 10360.00 10360.00 10360.00 10360.0
> > 2011-03-10 00:05:00 10361.50 10361.50 10361.50 10361.5
> >> tail(alpha)
> > ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
> > 2011-06-08 23:51:00 9430 9430 9430 ?9430
> > 2011-06-08 23:52:00 9430 9430 9430 ?9430
> > 2011-06-08 23:53:00 9430 9430 9430 ?9430
> > 2011-06-08 23:54:00 9430 9430 9430 ?9430
> > 2011-06-08 23:55:00 9430 9430 9430 ?9430
> > 2011-06-08 23:56:00 9430 9430 9430 ?9430
> >
> >
> > Aas you can see, the data look fine.
> >
> > Alas, it seems neither rollapply nor apply.daily like it, yet.
> >
> >> tr <- rollapply(alpha,width=20,FUN=rollRegFun,by.column=FALSE,
> > align="right")
> > Error in if (b < 1e-07) { : missing value where TRUE/FALSE needed
> >
> > And the following:
> >
> > myfun <- function(d) {
> > ?str(d)
> > }
> > apply.daily(alpha,myfun)
> >
> > Produces output right to the last day, but then dies (the output from
> > the last day processed successfully and the error):
> >
> > An ?xts? object from 2011-06-08 to 2011-06-08 23:56:00 containing:
> > ?Data: num [1:1437, 1:4] 9435 9435 9440 9445 9450 ...
> > ?- attr(*, "dimnames")=List of 2
> > ?..$ : NULL
> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> > ?xts Attributes:
> > ?NULL
> > Error in coredata.xts(x) : currently unsupported data type
> >>
> >
> > As you can see, all of the data from the last day for which there was
> > data in the file was processed (in this case by str()), but then it
> > looks like
> > apply.data() tries to apply myfun on data for the day after the last
> > day for which there is data, and not surprisingly doesn't find any. ?I
> > gues, the questin becomes why does apply.daily try to go past the last
> > date in the data?
> >
> > I do hope that the problem I am seeing in rollapply and that I see
> > when using apply.daily are related, as that would mean that I fix one
> > and the other gets fixed.
> >
> > Any other ideas?
> >
> > Thanks
> >
> > Ted
> >
> >> -----Original Message-----
> >> From: R. Michael Weylandt [mailto:michael.weylandt at gmail.com]
> >> Sent: January-29-12 11:02 PM
> >> To: Ted Byers
> >> Cc: r-sig-finance at r-project.org
> >> Subject: Re: [R-SIG-Finance] troubles with apply.daily
> >>
> >> I'm not sure time() is very good for what you want to do. It's tied
> >> to R's
> > builtin ts
> >> class, which, and it pains me to say this about R, really isn't very
> >> good
> > (at least
> >> for finance-y things). I think all your problems come from that...
> >>
> >> Perhaps construct your new index sequence as:
> >>
> >> seq(start(alpha), end(alpha), by = "min")
> >>
> >> Since you didn't supply example data, let's try this (admittedly
> >> absurd) analysis to showcase how these techniques should work:
> >>
> >> library(quantmod)
> >> getSymbols("AAPL")
> >> AAPL <- Cl(AAPL)
> >>
> >> ## Force to have daily (including non-trading days) points AAPL <-
> >> na.approx(AAPL, xout = seq(start(AAPL), end(AAPL), by = "day"))
> >>
> >> # check that it worked
> >> head(AAPL, 20)
> >>
> >> # Now we aggregate to weekly
> >> AAPL.w <- to.weekly(AAPL)
> >>
> >> # and now we apply a function monthly apply.monthly(AAPL.w, max)
> >>
> >> So everything seems to be in order. Does this help?
> >>
> >> Michael
> >>
> >>
> >> On Sun, Jan 29, 2012 at 12:51 PM, Ted Byers <r.ted.byers at gmail.com>
> wrote:
> >> > I do not understand this, either to figure out the cause, let alone
> >> > the
> > fix.
> >> >
> >> >
> >> >
> >> > Here is what I tried:
> >> >
> >> >
> >> >
> >> > myfun <- function(d) {
> >> >
> >> > ?str(d)
> >> >
> >> > }
> >> >
> >> > apply.daily(alpha,myfun)
> >> >
> >> >
> >> >
> >> > And here are what the beginning and end of alpha (an xts object
> >> > created by
> >> > to.minute()):
> >> >
> >> >
> >> >
> >> >> head(alpha)
> >> >
> >> > ? ? ? ? ? ? ? ? ? ? ? ?Open ? ? High ? ? ?Low Close
> >> >
> >> > 2011-03-10 00:00:00 10350.00 10365.00 10350.00 10360
> >> >
> >> > 2011-03-10 00:00:01 10350.06 10364.97 10350.06 10360
> >> >
> >> > 2011-03-10 00:00:02 10350.11 10364.94 10350.11 10360
> >> >
> >> > 2011-03-10 00:00:03 10350.17 10364.92 10350.17 10360
> >> >
> >> > 2011-03-10 00:00:04 10350.22 10364.89 10350.22 10360
> >> >
> >> > 2011-03-10 00:00:05 10350.28 10364.86 10350.28 10360
> >> >
> >> >> tail(alpha)
> >> >
> >> > ? ? ? ? ? ? ? ? ? ?Open High ?Low Close
> >> >
> >> > 2011-06-08 23:55:55 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:56 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:57 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:58 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:55:59 9430 9430 9430 ?9430
> >> >
> >> > 2011-06-08 23:56:00 9430 9430 9430 ?9430
> >> >
> >> >>
> >> >
> >> >
> >> >
> >> > There is almost three months of tick data here, converted to one
> >> > minute OHLC data.
> >> >
> >> >
> >> >
> >> > I had apparently successfully used the following to ensure I had an
> >> > even time series with values for every minute from start to end:
> >> >
> >> >
> >> >
> >> > tseq <- seq(start(alpha),end(alpha), by = time("00:01:00"))
> >> >
> >> > alpha <- na.approx(alpha, xout = tseq)
> >> >
> >> >
> >> >
> >> > But there is something weird here. ?How is it that alpha appears to
> >> > have rows for every second from the start to the end, rather than
> >> > 'just' for every minute?
> >> >
> >> >
> >> >
> >> > Now here is what the output looks like:
> >> >
> >> >
> >> >
> >> > An 'xts' object from 2011-06-05 to 2011-06-05 23:59:59 containing:
> >> >
> >> > ?Data: num [1:86400, 1:4] 9437 9437 9437 9437 9437 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > An 'xts' object from 2011-06-06 to 2011-06-06 23:59:59 containing:
> >> >
> >> > ?Data: num [1:86400, 1:4] 9420 9420 9420 9420 9420 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > An 'xts' object from 2011-06-07 to 2011-06-07 23:59:59 containing:
> >> >
> >> > ?Data: num [1:86400, 1:4] 9428 9428 9428 9428 9428 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > An 'xts' object from 2011-06-08 to 2011-06-08 23:56:00 containing:
> >> >
> >> > ?Data: num [1:86161, 1:4] 9435 9435 9435 9435 9435 ...
> >> >
> >> > - attr(*, "dimnames")=List of 2
> >> >
> >> > ?..$ : NULL
> >> >
> >> > ?..$ : chr [1:4] "Open" "High" "Low" "Close"
> >> >
> >> > ?Indexed by objects of class: [POSIXct,POSIXt] TZ:
> >> >
> >> > ?xts Attributes:
> >> >
> >> > ?NULL
> >> >
> >> > Error in coredata.xts(x) : currently unsupported data type
> >> >
> >> >
> >> >
> >> > Now, I do not understand what is happening here. ?The data seem
> >> > consistent throughout, so why would it crash and burn on the very
> >> > last day, and only on that day, of the three months of data
> >> >
> >> >
> >> >
> >> > Any insight would be greatly appreciated.
> >> >
> >> >
> >> >
> >> > Thanks
> >> >
> >> >
> >> >
> >> > Ted
> >> >
> >> >
> >> > ? ? ? ?[[alternative HTML version deleted]]
> >> >
> >> > _______________________________________________
> >> > R-SIG-Finance at r-project.org mailing list
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> > -- Subscriber-posting only. If you want to post, subscribe first.
> >> > -- Also note that this is not the r-help list where general R
> >> > questions
> > should
> >> go.
> >


From comtech.usa at gmail.com  Mon Jan 30 17:48:18 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 30 Jan 2012 10:48:18 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R that
 takes care of day-light saving?
Message-ID: <CAPNjSFYz1ORPZbhmDuRrW6i2Z9cTpO3bkbfT1xuPOt5xs8TmEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120130/90b41ac2/attachment.pl>

From brian at braverock.com  Mon Jan 30 17:58:28 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 30 Jan 2012 10:58:28 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CAPNjSFYz1ORPZbhmDuRrW6i2Z9cTpO3bkbfT1xuPOt5xs8TmEA@mail.gmail.com>
References: <CAPNjSFYz1ORPZbhmDuRrW6i2Z9cTpO3bkbfT1xuPOt5xs8TmEA@mail.gmail.com>
Message-ID: <1327942708.24988.216.camel@brian-rcg>

On Mon, 2012-01-30 at 10:48 -0600, Michael wrote:
> We have data in GMT/UTC, how can we convert them into EST NEW YORK
> time
> taking into account for the day-light savings?
> 
> We are working mainly using "xts" objects, so we could find
> "xts"-compatible functions? 

?indexTZ


-- 
Brian


From jeffrey.ryan at lemnica.com  Mon Jan 30 18:01:07 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 30 Jan 2012 11:01:07 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CAPNjSFYz1ORPZbhmDuRrW6i2Z9cTpO3bkbfT1xuPOt5xs8TmEA@mail.gmail.com>
References: <CAPNjSFYz1ORPZbhmDuRrW6i2Z9cTpO3bkbfT1xuPOt5xs8TmEA@mail.gmail.com>
Message-ID: <CABDUZc9KCtJ1gMMYoZKQuovZatsT=--=tOdj22qq1B211CSihg@mail.gmail.com>

?indexTZ

Please, please, please, read the documentation.

Jeff

On Mon, Jan 30, 2012 at 10:48 AM, Michael <comtech.usa at gmail.com> wrote:
> Hi all,
>
> We have data in GMT/UTC, how can we convert them into EST NEW YORK time
> taking into account for the day-light savings?
>
> We are working mainly using "xts" objects, so we could find
> "xts"-compatible functions?
>
> Thanks a lot!
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From comtech.usa at gmail.com  Mon Jan 30 18:31:34 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 30 Jan 2012 11:31:34 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
Message-ID: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120130/09c1dd87/attachment.pl>

From jeffrey.ryan at lemnica.com  Mon Jan 30 18:59:33 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 30 Jan 2012 11:59:33 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>
References: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>
Message-ID: <CABDUZc_Fawcexm77On-PBU9OFmd8gdAPVu7DqtKrkxY_6Ec6EQ@mail.gmail.com>

Take a look at the notion of TZ in R (and in general).  The basic idea
is offset from UTC.  The POSIXct [R] representation is _always_ UTC
internally.  The stuff you 'see' is merely an adjustment on print.

You are confounding TZ and OS behavior likely.  Some systems (wonder
which ones?) really screw up TZ handling.

A search of the list archives, the internals of POSIXct, OS
documentation for TZ, etc will get you thinking clearly I hope.  It
isn't easy though - xts abstracts away a lot of very very painful
ugliness.

> ?indexTZ
> x <- xts(NA, Sys.time())
> x
                    [,1]
2012-01-30 11:57:53   NA
> indexTZ(x)
[1] "America/Chicago"
> Sys.setenv(TZ="America/New_York")
> x
                    [,1]
2012-01-30 11:57:53   NA
Warning message:
timezone of object (America/Chicago) is different than current
timezone (America/New_York).
> indexTZ(x)
[1] "America/Chicago"
> .index(x)
[1] 1327946273
attr(,"tzone")
[1] "America/Chicago"
attr(,"tclass")
[1] "POSIXct" "POSIXt"
> indexTZ(x) <- "America/New_York"
> indexTZ(x)
                TZ
"America/New_York"
> x
                    [,1]
2012-01-30 12:57:53   NA
> .index(x)
[1] 1327946273
attr(,"tzone")
                TZ
"America/New_York"
attr(,"tclass")
[1] "POSIXct" "POSIXt"

HTH
Jeff

On Mon, Jan 30, 2012 at 11:31 AM, Michael <comtech.usa at gmail.com> wrote:
> I have certainly read the doc before I asked.
>
> But I guess it doesnt do what I want and I should have made myself clear...
> sorry for that:
>
> I created someintraday ?timeseries with notime zone initially.
>
> And then we would like to treat the time series as GMT and convert all the
> timestamps into EST/EDT, taking into account of daylight saving stuff.
>
> And then we will do some subsetting and get a new time series.
>
> And the we will remove the time zone attributes and from then on treat the
> series as under GMT.
>
> I have played with indexTZ yesterday but couldnt find a way to physically
> change the time stamps to the correct one - the index should be adjusted by
> -5hours in winters and -4hours in summers... but my index just didnot
> change at all...
>
> What could be the problem? There must be some tricks I didnt know... Please
> shed lights on me Thanks a lot!
> On Jan 30, 2012 11:01 AM, "Jeffrey Ryan" <jeffrey.ryan at lemnica.com> wrote:
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From comtech.usa at gmail.com  Mon Jan 30 19:07:25 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 30 Jan 2012 12:07:25 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CABDUZc_Fawcexm77On-PBU9OFmd8gdAPVu7DqtKrkxY_6Ec6EQ@mail.gmail.com>
References: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>
	<CABDUZc_Fawcexm77On-PBU9OFmd8gdAPVu7DqtKrkxY_6Ec6EQ@mail.gmail.com>
Message-ID: <CAPNjSFbLyDRrqNcLUvwLJdbsBot=dUz949X-aPP1NFg44v8Vcw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120130/ead1b922/attachment.pl>

From jeffrey.ryan at lemnica.com  Mon Jan 30 19:30:19 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 30 Jan 2012 12:30:19 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CAPNjSFbLyDRrqNcLUvwLJdbsBot=dUz949X-aPP1NFg44v8Vcw@mail.gmail.com>
References: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>
	<CABDUZc_Fawcexm77On-PBU9OFmd8gdAPVu7DqtKrkxY_6Ec6EQ@mail.gmail.com>
	<CAPNjSFbLyDRrqNcLUvwLJdbsBot=dUz949X-aPP1NFg44v8Vcw@mail.gmail.com>
Message-ID: <CABDUZc9O2w4vkEPNt-FyuMaraud6Sk2Zmxm6gK8tAxfoeTi9cQ@mail.gmail.com>

This won't immediately "help" per se, but what you are asking about
*is* possible:

> unclass(as.POSIXct("1970-01-01", tz="UTC"))
[1] 0
attr(,"tzone")
[1] "UTC"
> unclass(as.POSIXct("1970-01-01", tz="America/Chicago"))
[1] 21600
attr(,"tzone")
[1] "America/Chicago"
> unclass(as.POSIXct("1970-01-01", tz="Europe/London"))
[1] -3600
attr(,"tzone")
[1] "Europe/London"
> unclass(as.POSIXct("1970-01-01", tz="Asia/Hong_Kong"))
[1] -28800
attr(,"tzone")
[1] "Asia/Hong_Kong"


The 'trick' is the conversion from string representation initially.
The OS facilities are where the conversion is happening, and you can
effectively trick the system by setting the environment variable for
the duration of the C level call.  Don't ask for details, as they
aren't "R" per se and far too complex for me to explain succinctly,
but note that it is possible.

In fact, that is one way that xts can manipulate times so well, even
with objects that have different TZs assigned.

HTH
Jeff
On Mon, Jan 30, 2012 at 12:07 PM, Michael <comtech.usa at gmail.com> wrote:
> Thanks a lot for the nice example! I should have used that to make a
> reproducible example. I always had trouble making reproducible example.
>
> Basically it explains why I couldn't physically change the index/timestamps
> by either -5 or -4 hours...
>
> The indices are always in GMT/UTC internally...
>
> So the only way to physically change the timestamps is to manipulate them
> by hand or programmatically and externally.
>
> If there is no day-light saving stuff, I could just do align.time by
> 5*60*60; but the day-light saving complicated things... I could no longer
> do 5*60*60 universally to all data in the time series...
>
> Too bad...
>
> On Mon, Jan 30, 2012 at 11:59 AM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>
>> Take a look at the notion of TZ in R (and in general). ?The basic idea
>> is offset from UTC. ?The POSIXct [R] representation is _always_ UTC
>> internally. ?The stuff you 'see' is merely an adjustment on print.
>>
>> You are confounding TZ and OS behavior likely. ?Some systems (wonder
>> which ones?) really screw up TZ handling.
>>
>> A search of the list archives, the internals of POSIXct, OS
>> documentation for TZ, etc will get you thinking clearly I hope. ?It
>> isn't easy though - xts abstracts away a lot of very very painful
>> ugliness.
>>
>> > ?indexTZ
>> > x <- xts(NA, Sys.time())
>> > x
>> ? ? ? ? ? ? ? ? ? ?[,1]
>> 2012-01-30 11:57:53 ? NA
>> > indexTZ(x)
>> [1] "America/Chicago"
>> > Sys.setenv(TZ="America/New_York")
>> > x
>> ? ? ? ? ? ? ? ? ? ?[,1]
>> 2012-01-30 11:57:53 ? NA
>> Warning message:
>> timezone of object (America/Chicago) is different than current
>> timezone (America/New_York).
>> > indexTZ(x)
>> [1] "America/Chicago"
>> > .index(x)
>> [1] 1327946273
>> attr(,"tzone")
>> [1] "America/Chicago"
>> attr(,"tclass")
>> [1] "POSIXct" "POSIXt"
>> > indexTZ(x) <- "America/New_York"
>> > indexTZ(x)
>> ? ? ? ? ? ? ? ?TZ
>> "America/New_York"
>> > x
>> ? ? ? ? ? ? ? ? ? ?[,1]
>> 2012-01-30 12:57:53 ? NA
>> > .index(x)
>> [1] 1327946273
>> attr(,"tzone")
>> ? ? ? ? ? ? ? ?TZ
>> "America/New_York"
>> attr(,"tclass")
>> [1] "POSIXct" "POSIXt"
>>
>> HTH
>> Jeff
>>
>> On Mon, Jan 30, 2012 at 11:31 AM, Michael <comtech.usa at gmail.com> wrote:
>> ?> I have certainly read the doc before I asked.
>> >
>> > But I guess it doesnt do what I want and I should have made myself
>> clear...
>> > sorry for that:
>> >
>> > I created someintraday ?timeseries with notime zone initially.
>> >
>> > And then we would like to treat the time series as GMT and convert all
>> the
>> > timestamps into EST/EDT, taking into account of daylight saving stuff.
>> >
>> > And then we will do some subsetting and get a new time series.
>> >
>> > And the we will remove the time zone attributes and from then on treat
>> the
>> > series as under GMT.
>> >
>> > I have played with indexTZ yesterday but couldnt find a way to physically
>> > change the time stamps to the correct one - the index should be adjusted
>> by
>> > -5hours in winters and -4hours in summers... but my index just didnot
>> > change at all...
>> >
>> > What could be the problem? There must be some tricks I didnt know...
>> Please
>> > shed lights on me Thanks a lot!
>> > On Jan 30, 2012 11:01 AM, "Jeffrey Ryan" <jeffrey.ryan at lemnica.com>
>> wrote:
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>>
>> ?--
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>> www.esotericR.com <http://www.esotericr.com/>
>>
>> R/Finance 2012: Applied Finance with R
>> www.RinFinance.com <http://www.rinfinance.com/>
>>
>> See you in Chicago!!!!
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From comtech.usa at gmail.com  Mon Jan 30 19:48:55 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 30 Jan 2012 12:48:55 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CABDUZc9O2w4vkEPNt-FyuMaraud6Sk2Zmxm6gK8tAxfoeTi9cQ@mail.gmail.com>
References: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>
	<CABDUZc_Fawcexm77On-PBU9OFmd8gdAPVu7DqtKrkxY_6Ec6EQ@mail.gmail.com>
	<CAPNjSFbLyDRrqNcLUvwLJdbsBot=dUz949X-aPP1NFg44v8Vcw@mail.gmail.com>
	<CABDUZc9O2w4vkEPNt-FyuMaraud6Sk2Zmxm6gK8tAxfoeTi9cQ@mail.gmail.com>
Message-ID: <CAPNjSFYW28ouOB5CTB1Fv0k9FcbpouAPOc42_HsFswjtF6MemA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120130/f82618b6/attachment.pl>

From daniel_krizian at tam.sk  Mon Jan 30 20:04:48 2012
From: daniel_krizian at tam.sk (daniel_krizian at tam.sk)
Date: Mon, 30 Jan 2012 20:04:48 +0100
Subject: [R-SIG-Finance] Rotational Trading Strategy in quantstrat
Message-ID: <OFB2A2749E.1F077753-ONC1257995.005FAC6C-C1257995.0068D09E@tatrabanka.sk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120130/0db3409d/attachment.pl>

From jeffrey.ryan at lemnica.com  Mon Jan 30 20:06:05 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 30 Jan 2012 13:06:05 -0600
Subject: [R-SIG-Finance] is there a time-zone adjustment function in R
 that takes care of day-light saving?
In-Reply-To: <CAPNjSFYW28ouOB5CTB1Fv0k9FcbpouAPOc42_HsFswjtF6MemA@mail.gmail.com>
References: <CAPNjSFYk7e16PVEvww95wiLKYJCa+UnZoi2CD7z_KjxihTD3UA@mail.gmail.com>
	<CABDUZc_Fawcexm77On-PBU9OFmd8gdAPVu7DqtKrkxY_6Ec6EQ@mail.gmail.com>
	<CAPNjSFbLyDRrqNcLUvwLJdbsBot=dUz949X-aPP1NFg44v8Vcw@mail.gmail.com>
	<CABDUZc9O2w4vkEPNt-FyuMaraud6Sk2Zmxm6gK8tAxfoeTi9cQ@mail.gmail.com>
	<CAPNjSFYW28ouOB5CTB1Fv0k9FcbpouAPOc42_HsFswjtF6MemA@mail.gmail.com>
Message-ID: <CABDUZc_Ep-yMg1q2Sy--e1OuUknkk5GO+BC83tKFgtiTXzGqJg@mail.gmail.com>

The catch is that you are really taking your life into your own hands,
but you should be ok.

The one real downside is all of that format(index()) stuff is going to
be costly from a systems standpoint, but is likely the only way to
solve your immediate request.

I'd advise more to think about normalizing to some consistent
timezone, and avoid the overhead and potential for confusion though.

Jeff

On Mon, Jan 30, 2012 at 12:48 PM, Michael <comtech.usa at gmail.com> wrote:
> Okay thanks a lot Jeff!
>
> Following your ideas and after some googling - ?I've explored the following:
>
>> aaa
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?Bid
> 2001-01-03 06:00:00 109.92727
>> indexTZ(aaa)
> [1] ""
>> pb.date <- as.POSIXct(format(index(aaa), "%Y-%m-%d %H:%M:%OS"), tz="GMT")
>>
>> pb.date
> [1] "2001-01-03 06:00:00 GMT"
>> format(pb.date, tz="America/New_York", usetz=T)
> [1] "2001-01-03 01:00:00 EST"
>> index(aaa)=as.POSIXct(format(pb.date, tz="America/New_York", usetz=T))
>>
>> aaa
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?Bid
> 2001-01-03 01:00:00 109.92727
>> indexTZ(aaa)
> [1] ""
> Looks okay now? The indices/timestamps had been physically and permanently
> changed...
>
> Could you guys please help reminder if there is any catch doing it this way
> and is it universally correct?
>
> Thanks a lot again!
>
>
>
>
> On Mon, Jan 30, 2012 at 12:30 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>wrote:
>
>> This won't immediately "help" per se, but what you are asking about
>> *is* possible:
>>
>> > unclass(as.POSIXct("1970-01-01", tz="UTC"))
>> [1] 0
>> attr(,"tzone")
>> [1] "UTC"
>> > unclass(as.POSIXct("1970-01-01", tz="America/Chicago"))
>> [1] 21600
>> attr(,"tzone")
>> [1] "America/Chicago"
>> > unclass(as.POSIXct("1970-01-01", tz="Europe/London"))
>> [1] -3600
>> attr(,"tzone")
>> [1] "Europe/London"
>> > unclass(as.POSIXct("1970-01-01", tz="Asia/Hong_Kong"))
>> [1] -28800
>> attr(,"tzone")
>> [1] "Asia/Hong_Kong"
>>
>>
>> The 'trick' is the conversion from string representation initially.
>> The OS facilities are where the conversion is happening, and you can
>> effectively trick the system by setting the environment variable for
>> the duration of the C level call. ?Don't ask for details, as they
>> aren't "R" per se and far too complex for me to explain succinctly,
>> but note that it is possible.
>>
>> In fact, that is one way that xts can manipulate times so well, even
>> with objects that have different TZs assigned.
>>
>> HTH
>> Jeff
>> ?On Mon, Jan 30, 2012 at 12:07 PM, Michael <comtech.usa at gmail.com> wrote:
>> > Thanks a lot for the nice example! I should have used that to make a
>> > reproducible example. I always had trouble making reproducible example.
>> >
>> > Basically it explains why I couldn't physically change the
>> index/timestamps
>> > by either -5 or -4 hours...
>> >
>> > The indices are always in GMT/UTC internally...
>> >
>> > So the only way to physically change the timestamps is to manipulate them
>> > by hand or programmatically and externally.
>> >
>> > If there is no day-light saving stuff, I could just do align.time by
>> > 5*60*60; but the day-light saving complicated things... I could no longer
>> > do 5*60*60 universally to all data in the time series...
>> >
>> > Too bad...
>> >
>> > On Mon, Jan 30, 2012 at 11:59 AM, Jeffrey Ryan <jeffrey.ryan at lemnica.com
>> >wrote:
>> >
>> >> Take a look at the notion of TZ in R (and in general). ?The basic idea
>> >> is offset from UTC. ?The POSIXct [R] representation is _always_ UTC
>> >> internally. ?The stuff you 'see' is merely an adjustment on print.
>> >>
>> >> You are confounding TZ and OS behavior likely. ?Some systems (wonder
>> >> which ones?) really screw up TZ handling.
>> >>
>> >> A search of the list archives, the internals of POSIXct, OS
>> >> documentation for TZ, etc will get you thinking clearly I hope. ?It
>> >> isn't easy though - xts abstracts away a lot of very very painful
>> >> ugliness.
>> >>
>> >> > ?indexTZ
>> >> > x <- xts(NA, Sys.time())
>> >> > x
>> >> ? ? ? ? ? ? ? ? ? ?[,1]
>> >> 2012-01-30 11:57:53 ? NA
>> >> > indexTZ(x)
>> >> [1] "America/Chicago"
>> >> > Sys.setenv(TZ="America/New_York")
>> >> > x
>> >> ? ? ? ? ? ? ? ? ? ?[,1]
>> >> 2012-01-30 11:57:53 ? NA
>> >> Warning message:
>> >> timezone of object (America/Chicago) is different than current
>> >> timezone (America/New_York).
>> >> > indexTZ(x)
>> >> [1] "America/Chicago"
>> >> > .index(x)
>> >> [1] 1327946273
>> >> attr(,"tzone")
>> >> [1] "America/Chicago"
>> >> attr(,"tclass")
>> >> [1] "POSIXct" "POSIXt"
>> >> > indexTZ(x) <- "America/New_York"
>> >> > indexTZ(x)
>> >> ? ? ? ? ? ? ? ?TZ
>> >> "America/New_York"
>> >> > x
>> >> ? ? ? ? ? ? ? ? ? ?[,1]
>> >> 2012-01-30 12:57:53 ? NA
>> >> > .index(x)
>> >> [1] 1327946273
>> >> attr(,"tzone")
>> >> ? ? ? ? ? ? ? ?TZ
>> >> "America/New_York"
>> >> attr(,"tclass")
>> >> [1] "POSIXct" "POSIXt"
>> >>
>> >> HTH
>> >> Jeff
>> >>
>> >> On Mon, Jan 30, 2012 at 11:31 AM, Michael <comtech.usa at gmail.com>
>> wrote:
>> >> ?> I have certainly read the doc before I asked.
>> >> >
>> >> > But I guess it doesnt do what I want and I should have made myself
>> >> clear...
>> >> > sorry for that:
>> >> >
>> >> > I created someintraday ?timeseries with notime zone initially.
>> >> >
>> >> > And then we would like to treat the time series as GMT and convert all
>> >> the
>> >> > timestamps into EST/EDT, taking into account of daylight saving stuff.
>> >> >
>> >> > And then we will do some subsetting and get a new time series.
>> >> >
>> >> > And the we will remove the time zone attributes and from then on treat
>> >> the
>> >> > series as under GMT.
>> >> >
>> >> > I have played with indexTZ yesterday but couldnt find a way to
>> physically
>> >> > change the time stamps to the correct one - the index should be
>> adjusted
>> >> by
>> >> > -5hours in winters and -4hours in summers... but my index just didnot
>> >> > change at all...
>> >> >
>> >> > What could be the problem? There must be some tricks I didnt know...
>> >> Please
>> >> > shed lights on me Thanks a lot!
>> >> > On Jan 30, 2012 11:01 AM, "Jeffrey Ryan" <jeffrey.ryan at lemnica.com>
>> >> wrote:
>> >> >
>> >> > ? ? ? ?[[alternative HTML version deleted]]
>> >> >
>> >> > _______________________________________________
>> >> > R-SIG-Finance at r-project.org mailing list
>> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> > -- Subscriber-posting only. If you want to post, subscribe first.
>> >> > -- Also note that this is not the r-help list where general R
>> questions
>> >> should go.
>> >>
>> >>
>> >>
>> >> ?--
>> >> Jeffrey Ryan
>> >> jeffrey.ryan at lemnica.com
>> >>
>> >> www.lemnica.com
>> >> www.esotericR.com <http://www.esotericr.com/> <
>> http://www.esotericr.com/>
>> >>
>> >> R/Finance 2012: Applied Finance with R
>> >> www.RinFinance.com <http://www.rinfinance.com/> <
>> http://www.rinfinance.com/>
>> >>
>> >> See you in Chicago!!!!
>> ?>>
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>> www.esotericR.com <http://www.esotericr.com/>
>>
>> R/Finance 2012: Applied Finance with R
>> www.RinFinance.com <http://www.rinfinance.com/>
>>
>> See you in Chicago!!!!
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From papa.senyo at yahoo.it  Tue Jan 31 13:36:47 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Tue, 31 Jan 2012 12:36:47 +0000 (GMT)
Subject: [R-SIG-Finance] Forecasting
Message-ID: <1328013407.21232.YahooMailNeo@web132302.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/23e90415/attachment.pl>

From rharlow86 at gmail.com  Tue Jan 31 14:30:06 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Tue, 31 Jan 2012 08:30:06 -0500
Subject: [R-SIG-Finance] Forecasting
In-Reply-To: <1328013407.21232.YahooMailNeo@web132302.mail.ird.yahoo.com>
References: <1328013407.21232.YahooMailNeo@web132302.mail.ird.yahoo.com>
Message-ID: <CAHdfS97baBzXX3zNe3VwkGHb_iUYXAi3_z0dzqkPDSHX8UQTZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/e8f97b41/attachment.pl>

From stigkorsnes at gmail.com  Tue Jan 31 15:10:30 2012
From: stigkorsnes at gmail.com (Stig Korsnes)
Date: Tue, 31 Jan 2012 15:10:30 +0100
Subject: [R-SIG-Finance] RBloomberg and "tick"
Message-ID: <CAEYE6pU0BuKWrWyP=chmnLvhXJt9MgsRfATzP8-s+Oq2wjsonQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/c2372c82/attachment.pl>

From john.laing at gmail.com  Tue Jan 31 15:34:45 2012
From: john.laing at gmail.com (John Laing)
Date: Tue, 31 Jan 2012 09:34:45 -0500
Subject: [R-SIG-Finance] RBloomberg and "tick"
In-Reply-To: <CAEYE6pU0BuKWrWyP=chmnLvhXJt9MgsRfATzP8-s+Oq2wjsonQ@mail.gmail.com>
References: <CAEYE6pU0BuKWrWyP=chmnLvhXJt9MgsRfATzP8-s+Oq2wjsonQ@mail.gmail.com>
Message-ID: <CAA3Wa=vAA7Vhmu1QqdNf9urkQyK0mx4Y78VhydajAtOtL3bURQ@mail.gmail.com>

Stig,

The Bloomberg API Developer guide lists acceptable values. They are
not (yet) anywhere in the RBloomberg package. For tick data, you can
request: TRADE, BID, ASK, BID_BEST, ASK_BEST, MID_PRICE, AT_TRADE,
BEST_BID, BEST_ASK. As far as I'm aware none of these return yield.

John

On Tue, Jan 31, 2012 at 9:10 AM, Stig Korsnes <stigkorsnes at gmail.com> wrote:
> Is there such a thing as a list of available fields somewhere (for the
> tick-func)?
> I`m trying to get yields on government securities and swaps, but
> on govies "TRADE" returns prices. I can approximate by using RISK/DUR,
> but I was hoping there is a field that returns yields instead. "FLDS" on
> bloomberg
> does not help as mnemonics for realtime fields does not compute with R`s
> "tick".
>
> I.e
>> tick(pconn,c("912828RR Govt"),c("BID_YLD"),"2012-01-30
> 15:00:00.0","2012-01-30 15:05:00.0")
> Error in .jcall("RJavaTools", "Ljava/lang/Object;", "invokeMethod", cl, ?:
> ?com.bloomberglp.blpapi.InvalidConversionException: Cannot convert String
> to Enumeration
>
> Stig
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From rharlow86 at gmail.com  Tue Jan 31 15:37:48 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Tue, 31 Jan 2012 09:37:48 -0500
Subject: [R-SIG-Finance] Forecasting
In-Reply-To: <1328017779.9337.YahooMailNeo@web132302.mail.ird.yahoo.com>
References: <1328013407.21232.YahooMailNeo@web132302.mail.ird.yahoo.com>
	<CAHdfS97baBzXX3zNe3VwkGHb_iUYXAi3_z0dzqkPDSHX8UQTZw@mail.gmail.com>
	<1328017779.9337.YahooMailNeo@web132302.mail.ird.yahoo.com>
Message-ID: <CAHdfS96fv_3VjgQ3k-G0AF7pBQ_w5F2qPKxCJ0NeNF715=s_kw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/467053b9/attachment.pl>

From stigkorsnes at gmail.com  Tue Jan 31 15:52:27 2012
From: stigkorsnes at gmail.com (Stig Korsnes)
Date: Tue, 31 Jan 2012 15:52:27 +0100
Subject: [R-SIG-Finance] RBloomberg and "tick"
In-Reply-To: <CAA3Wa=vAA7Vhmu1QqdNf9urkQyK0mx4Y78VhydajAtOtL3bURQ@mail.gmail.com>
References: <CAEYE6pU0BuKWrWyP=chmnLvhXJt9MgsRfATzP8-s+Oq2wjsonQ@mail.gmail.com>
	<CAA3Wa=vAA7Vhmu1QqdNf9urkQyK0mx4Y78VhydajAtOtL3bURQ@mail.gmail.com>
Message-ID: <CAEYE6pV_ebQdZhg7kxp_KSuKnZ6ktj6TObJ23yjHEG5i7RNGDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/a7c1067d/attachment.pl>

From comtech.usa at gmail.com  Tue Jan 31 17:09:57 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 31 Jan 2012 10:09:57 -0600
Subject: [R-SIG-Finance] Blotter package not available for 2.14.0?
Message-ID: <CAPNjSFZaYNw1M+utP85W2uA=e5QtoFhrprZc+dbfPaMi7EZoPA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/26517294/attachment.pl>

From michael.weylandt at gmail.com  Tue Jan 31 17:16:40 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Tue, 31 Jan 2012 11:16:40 -0500
Subject: [R-SIG-Finance] Blotter package not available for 2.14.0?
In-Reply-To: <CAPNjSFZaYNw1M+utP85W2uA=e5QtoFhrprZc+dbfPaMi7EZoPA@mail.gmail.com>
References: <CAPNjSFZaYNw1M+utP85W2uA=e5QtoFhrprZc+dbfPaMi7EZoPA@mail.gmail.com>
Message-ID: <CAAmySGOGX7QSgQUy2PT9ToFbG6rooq_=-OopomxyBK9ahhpY_A@mail.gmail.com>

R-Forge doesn't build for outdated versions of R. You'll need to
upgrade your R or simply build it from source. I believe it has no
compiled code so it shouldn't be hard.

Michael

On Tue, Jan 31, 2012 at 11:09 AM, Michael <comtech.usa at gmail.com> wrote:
> ?Hi all, good morning and good evening!
>
> Could you please help me with this? I couldn't find the "blotter" package...
>
> Thanks so much!
>
> ----------------------------------
>
>> install.packages("blotter", repos=" http://R-Forge.R-project.org") Installing
> package(s) into ?C:/My Softwares/R/R-2.14.0/library? (as ?lib? is
> unspecified)Warning in install.packages : unable to access index for
> repository http://R-Forge.R-project.org/bin/windows/contrib/2.14 Warning in
> install.packages : package ?blotter? is not available (for R version 2.14.0)
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From gsee000 at gmail.com  Tue Jan 31 17:18:48 2012
From: gsee000 at gmail.com (G See)
Date: Tue, 31 Jan 2012 10:18:48 -0600
Subject: [R-SIG-Finance] Blotter package not available for 2.14.0?
In-Reply-To: <CAAmySGOGX7QSgQUy2PT9ToFbG6rooq_=-OopomxyBK9ahhpY_A@mail.gmail.com>
References: <CAPNjSFZaYNw1M+utP85W2uA=e5QtoFhrprZc+dbfPaMi7EZoPA@mail.gmail.com>
	<CAAmySGOGX7QSgQUy2PT9ToFbG6rooq_=-OopomxyBK9ahhpY_A@mail.gmail.com>
Message-ID: <CA+xi=qYWm4+AQWjjAwn4LPdZ7APO6ECmRtv_RBGRw-=5i7AK9g@mail.gmail.com>

Also, R-forge has been down all day

On Tue, Jan 31, 2012 at 10:16 AM, R. Michael Weylandt
<michael.weylandt at gmail.com> wrote:
> R-Forge doesn't build for outdated versions of R. You'll need to
> upgrade your R or simply build it from source. I believe it has no
> compiled code so it shouldn't be hard.
>
> Michael
>
> On Tue, Jan 31, 2012 at 11:09 AM, Michael <comtech.usa at gmail.com> wrote:
>> ?Hi all, good morning and good evening!
>>
>> Could you please help me with this? I couldn't find the "blotter" package...
>>
>> Thanks so much!
>>
>> ----------------------------------
>>
>>> install.packages("blotter", repos=" http://R-Forge.R-project.org") Installing
>> package(s) into ?C:/My Softwares/R/R-2.14.0/library? (as ?lib? is
>> unspecified)Warning in install.packages : unable to access index for
>> repository http://R-Forge.R-project.org/bin/windows/contrib/2.14 Warning in
>> install.packages : package ?blotter? is not available (for R version 2.14.0)
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Tue Jan 31 17:32:22 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 31 Jan 2012 10:32:22 -0600
Subject: [R-SIG-Finance] Blotter package not available for 2.14.0?
In-Reply-To: <CAAmySGOGX7QSgQUy2PT9ToFbG6rooq_=-OopomxyBK9ahhpY_A@mail.gmail.com>
References: <CAPNjSFZaYNw1M+utP85W2uA=e5QtoFhrprZc+dbfPaMi7EZoPA@mail.gmail.com>
	<CAAmySGOGX7QSgQUy2PT9ToFbG6rooq_=-OopomxyBK9ahhpY_A@mail.gmail.com>
Message-ID: <CAPNjSFaP9Hr963O-K4u1vaPFT8-+=qmbM8eicfX8SnF3OogwhA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/636ce745/attachment.pl>

From john.laing at gmail.com  Tue Jan 31 17:47:04 2012
From: john.laing at gmail.com (John Laing)
Date: Tue, 31 Jan 2012 11:47:04 -0500
Subject: [R-SIG-Finance] RBloomberg and "tick"
In-Reply-To: <CAEYE6pV_ebQdZhg7kxp_KSuKnZ6ktj6TObJ23yjHEG5i7RNGDg@mail.gmail.com>
References: <CAEYE6pU0BuKWrWyP=chmnLvhXJt9MgsRfATzP8-s+Oq2wjsonQ@mail.gmail.com>
	<CAA3Wa=vAA7Vhmu1QqdNf9urkQyK0mx4Y78VhydajAtOtL3bURQ@mail.gmail.com>
	<CAEYE6pV_ebQdZhg7kxp_KSuKnZ6ktj6TObJ23yjHEG5i7RNGDg@mail.gmail.com>
Message-ID: <CAA3Wa=v9N5pp+96exabLhruvAkkThcyquRD1Fa7f2FM4vwWeNw@mail.gmail.com>

The 290-pager is the one I'm referring to (DOCS 2041121 <GO> for
anyone else interested). The Schemas appendix (A) lays out exact specs
for each request type. You're looking for the eventType field for
IntradayTickRequest on page 120.

John

On Tue, Jan 31, 2012 at 9:52 AM, Stig Korsnes <stigkorsnes at gmail.com> wrote:
> Ok, thanks. Which developer guide are you reffering to? I have only found
> the 290-pager "Bloomberg API Developer`s Guide for? New Libraries" which
> does not list acceptable values (if I have not overlooked), and the field
> finder (FLDS)?on the terminal does not list any mnemonic called "TRADE".
>
> Cheers,
> Stig
>
> 2012/1/31 John Laing <john.laing at gmail.com>
>>
>> Stig,
>>
>> The Bloomberg API Developer guide lists acceptable values. They are
>> not (yet) anywhere in the RBloomberg package. For tick data, you can
>> request: TRADE, BID, ASK, BID_BEST, ASK_BEST, MID_PRICE, AT_TRADE,
>> BEST_BID, BEST_ASK. As far as I'm aware none of these return yield.
>>
>> John
>>
>> On Tue, Jan 31, 2012 at 9:10 AM, Stig Korsnes <stigkorsnes at gmail.com>
>> wrote:
>> > Is there such a thing as a list of available fields somewhere (for the
>> > tick-func)?
>> > I`m trying to get yields on government securities and swaps, but
>> > on govies "TRADE" returns prices. I can approximate by using RISK/DUR,
>> > but I was hoping there is a field that returns yields instead. "FLDS" on
>> > bloomberg
>> > does not help as mnemonics for realtime fields does not compute with R`s
>> > "tick".
>> >
>> > I.e
>> >> tick(pconn,c("912828RR Govt"),c("BID_YLD"),"2012-01-30
>> > 15:00:00.0","2012-01-30 15:05:00.0")
>> > Error in .jcall("RJavaTools", "Ljava/lang/Object;", "invokeMethod", cl,
>> > ?:
>> > ?com.bloomberglp.blpapi.InvalidConversionException: Cannot convert
>> > String
>> > to Enumeration
>> >
>> > Stig
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>
>


From tmrsg11 at gmail.com  Tue Jan 31 20:09:06 2012
From: tmrsg11 at gmail.com (C W)
Date: Tue, 31 Jan 2012 14:09:06 -0500
Subject: [R-SIG-Finance] question on implementing trading strategy
Message-ID: <CAE2FW2mko5HL-A85+fyab3u2X9pcKF_dqpn61rAVCp0mTJaH4Q@mail.gmail.com>

Dear all,
I am trying to implement and compare several trading strategies against
kelly criterion, the idea is the following

[image: image.png]

k: is the year, so, the summation is like a moving window
Google: historical price of Google

And this is the kelly criterion, I am comparing against.
[image: image.png]
In, this case, I simply let [image: image.png].

My goal is:
1. calculate value at risk, look at the variance: (E-X)-sqrt(var)=alpha
2. For each fixed [image: image.png], compare different stocks.
3. Compare for different stocks, and have say, 0.99 in stock, 0.01 in cash.
 Or, 0.9 in stock, 0.1 in cash.

I was wondering if any experts could let me know what and how I can do it?
 Anyone know the name or key term of this strategy, and how to implement it
in R?

Feel free to send me any message, thanks in advance.

Colin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/920af7d4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 4379 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/920af7d4/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 419 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/920af7d4/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 3798 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/920af7d4/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 205 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120131/920af7d4/attachment-0003.png>

From brian at braverock.com  Tue Jan 31 20:23:55 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 31 Jan 2012 13:23:55 -0600
Subject: [R-SIG-Finance] question on implementing trading strategy
In-Reply-To: <CAE2FW2mko5HL-A85+fyab3u2X9pcKF_dqpn61rAVCp0mTJaH4Q@mail.gmail.com>
References: <CAE2FW2mko5HL-A85+fyab3u2X9pcKF_dqpn61rAVCp0mTJaH4Q@mail.gmail.com>
Message-ID: <1328037835.24988.235.camel@brian-rcg>

Many methods for Calculating VaR/ES are implemented in the package
PerformanceAnalytics

The Kelly criterion is also implemented in PerformanceAnalytics, but you
may want to check out the newer derived Leverage Space Model which
extends the Kelly criterion to a portfolio context.  See package LSPM.

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock



On Tue, 2012-01-31 at 14:09 -0500, C W wrote:
> Dear all,
> I am trying to implement and compare several trading strategies
> against kelly criterion, the idea is the following
> 
> 
> image.png
> 
> 
> k: is the year, so, the summation is like a moving window
> Google: historical price of Google
> 
> 
> And this is the kelly criterion, I am comparing against.
> image.png
> In, this case, I simply let image.png.
> 
> 
> My goal is:
> 1. calculate value at risk, look at the variance:
> (E-X)-sqrt(var)=alpha
> 2. For each fixed image.png, compare different stocks.
> 3. Compare for different stocks, and have say, 0.99 in stock, 0.01 in
> cash.  Or, 0.9 in stock, 0.1 in cash.
> 
> 
> I was wondering if any experts could let me know what and how I can do
> it?  Anyone know the name or key term of this strategy, and how to
> implement it in R?
> 
> 
> Feel free to send me any message, thanks in advance.
> 
> 
> Colin


From stigkorsnes at gmail.com  Wed Feb  1 12:26:20 2012
From: stigkorsnes at gmail.com (Stig Korsnes)
Date: Wed, 1 Feb 2012 12:26:20 +0100
Subject: [R-SIG-Finance] RBloomberg and "tick"
In-Reply-To: <CAA3Wa=v9N5pp+96exabLhruvAkkThcyquRD1Fa7f2FM4vwWeNw@mail.gmail.com>
References: <CAEYE6pU0BuKWrWyP=chmnLvhXJt9MgsRfATzP8-s+Oq2wjsonQ@mail.gmail.com>
	<CAA3Wa=vAA7Vhmu1QqdNf9urkQyK0mx4Y78VhydajAtOtL3bURQ@mail.gmail.com>
	<CAEYE6pV_ebQdZhg7kxp_KSuKnZ6ktj6TObJ23yjHEG5i7RNGDg@mail.gmail.com>
	<CAA3Wa=v9N5pp+96exabLhruvAkkThcyquRD1Fa7f2FM4vwWeNw@mail.gmail.com>
Message-ID: <CAEYE6pWcGkid-pZbcXzhPPBdKqEdmWYdR3MnJMpN+EjKXJ06ng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120201/73dcf430/attachment.pl>

From calvin.lists at gmail.com  Wed Feb  1 20:16:00 2012
From: calvin.lists at gmail.com (Calvin)
Date: Wed, 1 Feb 2012 14:16:00 -0500
Subject: [R-SIG-Finance] RBloomberg hanging on blpConnect()
Message-ID: <CAP+u5JKF+M_7oi1s-EkPQTVww_ygd82UH=V_K5GtAVsyB3gYWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120201/7e80fa04/attachment.pl>

From john.laing at gmail.com  Wed Feb  1 23:05:05 2012
From: john.laing at gmail.com (John Laing)
Date: Wed, 1 Feb 2012 17:05:05 -0500
Subject: [R-SIG-Finance] RBloomberg hanging on blpConnect()
In-Reply-To: <CAP+u5JKF+M_7oi1s-EkPQTVww_ygd82UH=V_K5GtAVsyB3gYWA@mail.gmail.com>
References: <CAP+u5JKF+M_7oi1s-EkPQTVww_ygd82UH=V_K5GtAVsyB3gYWA@mail.gmail.com>
Message-ID: <CAA3Wa=u-veFTQtXTjUixxOZmoOZcQ6bSzJb5g70yUcRVqZ=ndw@mail.gmail.com>

There are numerous threads here on this issue. Please make sure that
your Bloomberg API is up-to-date (WAPI <GO>) and that you have a
current version of Java installed.

John

On Wed, Feb 1, 2012 at 2:16 PM, Calvin <calvin.lists at gmail.com> wrote:
> Hi all,
>
> I am trying to get RBloomberg working with R version 2.14.1. ?Here are my
> current package versions:
>
> ?R version 2.14.1
> ?rJava version 0.9-3
> ?RBloomberg Version 0.4-150
>
> When I call blpConnect (no arguments), then R basically hangs until I shut
> it down. ?I had RBloomberg working with a much older version (pre: Java
> dependency), but I am having trouble with the latest version. ?Also, I
> believe I have the latest versions of the Bloomberg API installed.
>
> Are there any further steps I can take to debug this issue?
>
> Thank you very much for any help!
>
> -Calvin
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From daniel.cegielka at gmail.com  Wed Feb  1 23:12:51 2012
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Wed, 1 Feb 2012 23:12:51 +0100
Subject: [R-SIG-Finance] RBloomberg hanging on blpConnect()
In-Reply-To: <CAA3Wa=u-veFTQtXTjUixxOZmoOZcQ6bSzJb5g70yUcRVqZ=ndw@mail.gmail.com>
References: <CAP+u5JKF+M_7oi1s-EkPQTVww_ygd82UH=V_K5GtAVsyB3gYWA@mail.gmail.com>
	<CAA3Wa=u-veFTQtXTjUixxOZmoOZcQ6bSzJb5g70yUcRVqZ=ndw@mail.gmail.com>
Message-ID: <CAPLrYEQd9De_ZHs54NkXi8g16NVax6_k0tLR2DM7mTfswvvGJQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120201/e05308ed/attachment.pl>

From Darko.Roupell at cba.com.au  Thu Feb  2 07:44:10 2012
From: Darko.Roupell at cba.com.au (Roupell, Darko)
Date: Thu, 2 Feb 2012 17:44:10 +1100
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula
Message-ID: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120202/4424f26b/attachment.pl>

From enricoschumann at yahoo.de  Thu Feb  2 10:45:18 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Thu, 02 Feb 2012 10:45:18 +0100
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula
In-Reply-To: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
References: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
Message-ID: <4F2A5B2E.8020502@yahoo.de>


Hi, Darko,

Am 02.02.2012 07:44, schrieb Roupell, Darko:
> Hi All,
>
> I am trying to cross check option implied employee option price that was derived using Monte Carlo simulation. Below is code and parameter used and after accounting for dividend yield ( 1.46%) the derived option price is 206.8843 using the code snippet provided. Approx 1 cent below 207.95 that is listed in company prospect using their Monte Carlo simulation and below parameters.
>
> As we all know number of iteration can also slightly impact the average price, but am I rightly concerned that my methodology may not be correct?

Hm, I have not really looked at your programme so I cannot comment 
whether it is correct. But we are talking about a difference of about 
half a percentage point here. Which is not much. I just ran you script 
20 times.

 > summary(results)
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   205.6   206.0   206.3   206.3   206.8   206.9

Admittedly, all results are all below the company's price, but 
nevertheless: they vary.

There are details that they might have done differently. For instance, 
you do not compound (if I see correctly). What if you replaced

riskFreeRate*timeToExpiry

with

(1+riskFreeRate)*timeToExpiry-1

But even if that gives you the price: from a practical point of view, 
the difference is small, really.

(Much better would be to check what would happen if the div did not turn 
out as expected, if the vol were different, etc)

Regards,
Enrico


>
> Any feedback will be appreciated.
>
>
> exercisePrice   = 0;
> timeToExpiry    = 3;        #% in years
> underlyingPrice = 490;      #% underlying in cents
> expectedVol     = 0.5;      #% expected volatility
> expectedDiv     = 0.0146;        #% expected dividend in cents
> riskFreeRate    = 0.0425;   #% interest rate
> itr = 500000              #% number of iterations
> delS = 0*array(0,itr)
>
> for( i in (1:itr))
> {
>      eps = rnorm(1)         #% random number generator
>      dS = expectedDiv*underlyingPrice+underlyingPrice*(riskFreeRate*timeToExpiry) + (underlyingPrice*expectedVol*eps*sqrt(timeToExpiry))
>      mv = dS - exercisePrice;
>
>      delS[i] = max(mv,0);
> }
>
> mean(delS)
>
> __________________________________________________
> Commonwealth Bank
> Darko Roupell
> Associate Quantitative Analyst
> Institutional Banking&  Markets
> Equities Research
> Darling Park Tower 1
> Level 23, 201 Sussex Street
> Sydney, NSW 2000
> P:  +61 2 9117 1254
> F:  +61 2 9118 1000
> M: +61 400 170 515
> E: Darko.Roupell at cba.com.au

[...]
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


From comtech.usa at gmail.com  Thu Feb  2 16:09:31 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 2 Feb 2012 09:09:31 -0600
Subject: [R-SIG-Finance] time series regime detection in R?
Message-ID: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120202/91e6fb4f/attachment.pl>

From brian at braverock.com  Thu Feb  2 16:18:48 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 2 Feb 2012 09:18:48 -0600
Subject: [R-SIG-Finance] time series regime detection in R?
In-Reply-To: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
References: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
Message-ID: <1328195928.24988.262.camel@brian-rcg>

Please Please Please search before posting.

http://www.rseek.org/?cx=010923144343702598753%
3Aboaz1reyxd4&newwindow=1&q=regime+model&sa=Search+functions%2C+lists%2C
+and+more&cof=FORID%3A11&siteurl=www.rseek.org%2F



On Thu, 2012-02-02 at 09:09 -0600, Michael wrote:
> Hi all, good morning and good evening!
> 
> Could you please point me to some commands/functions/packages in R
> commutity that can do regime detection for time series?
> 
> For example, giving a times series of SP500, and maybe other covariates and
> macro data, we can answer the following questions:
> 
> 1. How many regimes are there?
> 2. Are we currently in a new regime and since when?
> 
> Thank you!
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From Achim.Zeileis at uibk.ac.at  Thu Feb  2 16:25:42 2012
From: Achim.Zeileis at uibk.ac.at (Achim Zeileis)
Date: Thu, 2 Feb 2012 16:25:42 +0100
Subject: [R-SIG-Finance] time series regime detection in R?
In-Reply-To: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
References: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
Message-ID: <alpine.DEB.2.02.1202021620590.23261@paninaro.uibk.ac.at>

On Thu, 2 Feb 2012, Michael wrote:

> Hi all, good morning and good evening!
>
> Could you please point me to some commands/functions/packages in R
> commutity that can do regime detection for time series?

The "strucchange" and "segmented" packages provide functionality in this 
direction. The former considers abrupt shifts (including jumps) in 
parameters whereas the latter has the additional restriction of looking at 
continuous segmented functions.

If you are in a setting without covariates, the packages "changepoint" and 
"bcp" may also be of interest.

> For example, giving a times series of SP500, and maybe other covariates and
> macro data, we can answer the following questions:
>
> 1. How many regimes are there?
> 2. Are we currently in a new regime and since when?

A specific application that may be of interest in this direction is 
implemented in the "fxregime" package (built on top of "strucchange"). See 
also the accompanying paper:

   Achim Zeileis, Ajay Shah, Ila Patnaik (2010). Testing, Monitoring,
   and Dating Structural Changes in Exchange Rate Regimes. Computational
   Statistics & Data Analysis, 54(6), 1696-1706.
   doi:10.1016/j.csda.2009.12.005

hth,
Z

> Thank you!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From matthieu.stigler at gmail.com  Thu Feb  2 16:49:14 2012
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Thu, 2 Feb 2012 16:49:14 +0100
Subject: [R-SIG-Finance] time series regime detection in R?
In-Reply-To: <alpine.DEB.2.02.1202021620590.23261@paninaro.uibk.ac.at>
References: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
	<alpine.DEB.2.02.1202021620590.23261@paninaro.uibk.ac.at>
Message-ID: <4F2AB07A.2020204@gmail.com>

Michael

While strucchange and segmented look at regime switches triggered by 
time, tsDyn package investigates regime change triggered by covariate. 
These are the smooth and threshold AR models, where the regimes will 
change depending on the past values of the variables, or levels of any 
other variables. The threshold models are also available in multivariate 
case, and in the cointegration case.

One should also mention in the same vein Markov Models, where regime 
changes are based on an unobserved Markov process. There is 
unfortunately no package on CRAN to offer this, but some packages in 
development on R forge.

Matthieu


Le 02/02/2012 16:25, Achim Zeileis a ?crit :
> On Thu, 2 Feb 2012, Michael wrote:
>
>> Hi all, good morning and good evening!
>>
>> Could you please point me to some commands/functions/packages in R
>> commutity that can do regime detection for time series?
>
> The "strucchange" and "segmented" packages provide functionality in 
> this direction. The former considers abrupt shifts (including jumps) 
> in parameters whereas the latter has the additional restriction of 
> looking at continuous segmented functions.
>
> If you are in a setting without covariates, the packages "changepoint" 
> and "bcp" may also be of interest.
>
>> For example, giving a times series of SP500, and maybe other 
>> covariates and
>> macro data, we can answer the following questions:
>>
>> 1. How many regimes are there?
>> 2. Are we currently in a new regime and since when?
>
> A specific application that may be of interest in this direction is 
> implemented in the "fxregime" package (built on top of "strucchange"). 
> See also the accompanying paper:
>
>   Achim Zeileis, Ajay Shah, Ila Patnaik (2010). Testing, Monitoring,
>   and Dating Structural Changes in Exchange Rate Regimes. Computational
>   Statistics & Data Analysis, 54(6), 1696-1706.
>   doi:10.1016/j.csda.2009.12.005
>
> hth,
> Z
>
>> Thank you!
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R 
>> questions should go.
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.


From comtech.usa at gmail.com  Thu Feb  2 18:08:33 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 2 Feb 2012 11:08:33 -0600
Subject: [R-SIG-Finance] time series regime detection in R?
In-Reply-To: <1328195928.24988.262.camel@brian-rcg>
References: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
	<1328195928.24988.262.camel@brian-rcg>
Message-ID: <CAPNjSFa+fLq5HBZPoggTaK52d0Xs8vEayBhcyZJZoxYMJwxE-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120202/c74fb27a/attachment.pl>

From jeffrey.ryan at lemnica.com  Thu Feb  2 19:10:13 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 2 Feb 2012 12:10:13 -0600
Subject: [R-SIG-Finance] time series regime detection in R?
In-Reply-To: <CAPNjSFa+fLq5HBZPoggTaK52d0Xs8vEayBhcyZJZoxYMJwxE-g@mail.gmail.com>
References: <CAPNjSFa3eH5xvyck08TwL0zLxbDFAqZNgsdiCvXR809L3UYmXw@mail.gmail.com>
	<1328195928.24988.262.camel@brian-rcg>
	<CAPNjSFa+fLq5HBZPoggTaK52d0Xs8vEayBhcyZJZoxYMJwxE-g@mail.gmail.com>
Message-ID: <CABDUZc9ca1ECe8XH=jbFS-m4cEunhxROeReaRt1ibgaM35Gk9w@mail.gmail.com>

Just as an aside, the 'list' sees posts like this differently.

The general feel is that you don't provide any set of facts that show
you have tried looking yourself, and it begins to feel like we are the
'start' of the search, and not the final 'expert' distiller of
results.

"show your work" applies equally here as it does in 4th grade.  It matters.

Jeff

On Thu, Feb 2, 2012 at 11:08 AM, Michael <comtech.usa at gmail.com> wrote:
> Thanks Brian.
>
> I just wanted to explain a bit:
>
> Here is how I view it: "searching" is like "google" and
> "word-of-mouth"/"reviews" are like Amazon ...
>
> I of course had done lots of search; but I would like also to hear some
> sort of "latest review" and "latest word-of-mouth" recommendations...
> that's why I posted my question here where I could consult with a large R
> experts...
>
> Thanks again!
>
> On Thu, Feb 2, 2012 at 9:18 AM, Brian G. Peterson <brian at braverock.com>wrote:
>
>> Please Please Please search before posting.
>>
>> http://www.rseek.org/?cx=010923144343702598753%
>> 3Aboaz1reyxd4&newwindow=1&q=regime+model&sa=Search+functions%2C+lists%2C
>> +and+more&cof=FORID%3A11&siteurl=www.rseek.org%2F
>>
>>
>>
>> On Thu, 2012-02-02 at 09:09 -0600, Michael wrote:
>> > Hi all, good morning and good evening!
>> >
>> > Could you please point me to some commands/functions/packages in R
>> > commutity that can do regime detection for time series?
>> >
>> > For example, giving a times series of SP500, and maybe other covariates
>> and
>> > macro data, we can answer the following questions:
>> >
>> > 1. How many regimes are there?
>> > 2. Are we currently in a new regime and since when?
>> >
>> > Thank you!
>> >
>> > ? ? ? [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From Darko.Roupell at cba.com.au  Fri Feb  3 00:36:14 2012
From: Darko.Roupell at cba.com.au (Roupell, Darko)
Date: Fri, 3 Feb 2012 10:36:14 +1100
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula R code vs
 Matlab
In-Reply-To: <4F2A5B2E.8020502@yahoo.de>
References: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
	<4F2A5B2E.8020502@yahoo.de>
Message-ID: <7BFB9D627A159649BC6C30B6406E3A4813F32F9B82@VAUNSW141.au.cbainet.com>

Thanks Enrico,

To test if the code structure is correct I googled for alternative samples of Monte Carlo Option pricing coded in Matlab.

What I find the most puzzling is that even if I re-code using sample from matlab the results obtained in R are very different to those obtained by matlab, despite using the same parameters apart of Rnorm(). As I am at loss I am hoping that you or someone else in R-SIG may spot the difference that explains it.

########################################## R code ###########################################################

exercisePrice   = 100;
timeToExpiry    = 5;        #% in years
underlyingPrice = 100;      #% underlying in cents
expectedVol     = 0.2;      #% expected volatility
expectedDiv     = 0;        # expected dividend 
riskFreeRate    = 0.06;   #% interest rate
itr = 10000              #% number of iterations
delS = 0*array(0,itr)

dt = 1/252
nudt = (riskFreeRate - expectedDiv - 0.5 * expectedVol^ 2)* dt
sigsdt = expectedVol * sqrt(dt)
itr = 10000
delS = array(0,itr)
drifts = 255 * timeToExpiry

for( i in (1:itr))
{
dS =  underlyingPrice

    for (j in (1:drifts))
    {
    eps = rnorm(1, mean = 0, sd = 1)
    dS  = dS * exp(nudt +sigsdt*eps)
    }
delS[i] =dS
}

payoff = max(delS - exercisePrice, 0);
cal=mean(payoff) * exp(-riskFreeRate*timeToExpiry)

results:
> cal
[1] 396.2675

################################################## MATLAB ###########################################

S0=100; K=100; r=0.06; sig=0.2; T=5; div=0;

dt = 1/252;
nudt = (r - div - 0.5 * sig ^ 2) * dt;
sigsdt = sig * sqrt(dt)
sim=10000;
Si=zeros(1,sim);

drifts=255*T
for i=1:sim
S=S0;
for j=1:drifts;
z=randn(1,1); 

S = S* exp(nudt + sigsdt * z);
end
Si(i)=S;
end

payoff = max(Si - K, 0);
cal=mean(payoff) * exp(-r* T)

calbs=blsprice(S0,K,r,T,sig,div) <---B&S 

results: 

cal = 32.0173


calbs = 31.6150

http://www.quantnet.com/forum/threads/accuracy-of-monte-carlo-simulation-for-option-pricing.2224/

__________________________________________________
Commonwealth Bank 
Darko Roupell 
Associate Quantitative Analyst 
Institutional Banking & Markets
Equities Research
Darling Park Tower 1
Level 23, 201 Sussex Street
Sydney, NSW 2000
P:  +61 2 9117 1254
F:  +61 2 9118 1000
M: +61 400 170 515
E: Darko.Roupell at cba.com.au 
Our vision is to be Australia's finest financial services organisation through excelling in customer service.

Email Security
This email is sent solely for informational purposes. Hoax emails, commonly referred to as phishing, can appear to be from the Commonwealth Bank and ask you to update or confirm details such as client numbers, passwords, personal identification questions, contact details or account numbers. The Commonwealth Bank will never send you an email asking you to confirm, update or reveal your confidential banking information. 
Important Information
Produced by Global Markets Research, a business unit of Commonwealth Bank of Australia ABN 48 123 123 124 - AFSL 234945 (Commonwealth Bank). This publication is based on information available at the time of publishing.? We believe that the information in this communication is correct and any opinions, conclusions or recommendations are reasonably held or made as at the time of its compilation, but no warranty is made as to accuracy, reliability or completeness.? To the extent permitted by law, neither Commonwealth Bank nor any of its subsidiaries accept liability to any person for loss or damage arising from the use of this communication. This communication does not purport to be a complete statement or summary.? 
The information provided has been prepared without considering your objectives, financial situation or needs, and before acting on the information, you should consider its appropriateness to your circumstances. No person should act on the basis of this report without considering and if necessary taking appropriate professional advice upon their own particular circumstances.? 
Commonwealth Bank of Australia, as a provider of investment, borrowing and other financial services undertakes financial transactions with many corporate entities in Australia. This may include any corporate issuer referred to in this communication. Commonwealth Bank and its subsidiaries have effected or may effect transactions for their own account in any investments or related investments referred to herein. In the case of certain securities Commonwealth Bank is or may be the only market maker.

-----Original Message-----
From: Enrico Schumann [mailto:enricoschumann at yahoo.de] 
Sent: Thursday, 2 February 2012 8:45 PM
To: Roupell, Darko
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Monte Carlo Option Pricing formula


Hi, Darko,

Am 02.02.2012 07:44, schrieb Roupell, Darko:
> Hi All,
>
> I am trying to cross check option implied employee option price that was derived using Monte Carlo simulation. Below is code and parameter used and after accounting for dividend yield ( 1.46%) the derived option price is 206.8843 using the code snippet provided. Approx 1 cent below 207.95 that is listed in company prospect using their Monte Carlo simulation and below parameters.
>
> As we all know number of iteration can also slightly impact the average price, but am I rightly concerned that my methodology may not be correct?

Hm, I have not really looked at your programme so I cannot comment 
whether it is correct. But we are talking about a difference of about 
half a percentage point here. Which is not much. I just ran you script 
20 times.

 > summary(results)
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   205.6   206.0   206.3   206.3   206.8   206.9

Admittedly, all results are all below the company's price, but 
nevertheless: they vary.

There are details that they might have done differently. For instance, 
you do not compound (if I see correctly). What if you replaced

riskFreeRate*timeToExpiry

with

(1+riskFreeRate)*timeToExpiry-1

But even if that gives you the price: from a practical point of view, 
the difference is small, really.

(Much better would be to check what would happen if the div did not turn 
out as expected, if the vol were different, etc)

Regards,
Enrico


>
> Any feedback will be appreciated.
>
>
> exercisePrice   = 0;
> timeToExpiry    = 3;        #% in years
> underlyingPrice = 490;      #% underlying in cents
> expectedVol     = 0.5;      #% expected volatility
> expectedDiv     = 0.0146;        #% expected dividend in cents
> riskFreeRate    = 0.0425;   #% interest rate
> itr = 500000              #% number of iterations
> delS = 0*array(0,itr)
>
> for( i in (1:itr))
> {
>      eps = rnorm(1)         #% random number generator
>      dS = expectedDiv*underlyingPrice+underlyingPrice*(riskFreeRate*timeToExpiry) + (underlyingPrice*expectedVol*eps*sqrt(timeToExpiry))
>      mv = dS - exercisePrice;
>
>      delS[i] = max(mv,0);
> }
>
> mean(delS)
>
> __________________________________________________
> Commonwealth Bank
> Darko Roupell
> Associate Quantitative Analyst
> Institutional Banking&  Markets
> Equities Research
> Darling Park Tower 1
> Level 23, 201 Sussex Street
> Sydney, NSW 2000
> P:  +61 2 9117 1254
> F:  +61 2 9118 1000
> M: +61 400 170 515
> E: Darko.Roupell at cba.com.au

[...]
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/

************** IMPORTANT MESSAGE *****************************       
This e-mail message is intended only for the addressee(s) and contains information which may be
confidential. 
If you are not the intended recipient please advise the sender by return email, do not use or
disclose the contents, and delete the message and any attachments from your system. Unless
specifically indicated, this email does not constitute formal advice or commitment by the sender
or the Commonwealth Bank of Australia (ABN 48 123 123 124) or its subsidiaries. 
We can be contacted through our web site: commbank.com.au. 
If you no longer wish to receive commercial electronic messages from us, please reply to this
e-mail by typing Unsubscribe in the subject line. 


From rex at nosyntax.net  Fri Feb  3 04:12:50 2012
From: rex at nosyntax.net (rex)
Date: Thu, 2 Feb 2012 19:12:50 -0800
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula
In-Reply-To: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
References: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
Message-ID: <20120203031250.GG9399@ninja.nosyntax.net>

Roupell, Darko <Darko.Roupell at cba.com.au> [2012-02-01 22:45]:
>
>I am trying to cross check option implied employee option price that
>was derived using Monte Carlo simulation. Below is code and parameter
>used and after accounting for dividend yield ( 1.46%) the derived
>option price is 206.8843 using the code snippet provided. Approx 1
>cent below 207.95 that is listed in company prospect using their
>Monte Carlo simulation and below parameters.
>
>As we all know number of iteration can also slightly impact the
>average price, but am I rightly concerned that my methodology may not
>be correct?

Hi Darko,

Yes -- or at least different from the company's assumptions. Enrico
has informally shown that there is a statistically significant
difference in the two means. Conceptually, it may be important, but
practically, the difference is insignificant.

I have 3 other observations: first, your code uses a "for" loop which
should be avoided in code that takes a significant amount of time to
run in R, if possible. rnorm() can obviously be moved out of the loop
and called once to generate the eps vector, but delS[i] = max(mv,0) can
also be moved out of the loop, and then there's no need for a loop.

To see the difference eliminating the loop makes, let's compare your
code to a no-loop version:

start = Sys.time()
exercisePrice   = 0;
timeToExpiry    = 3;        #% in years
underlyingPrice = 490;      #% underlying in cents
expectedVol     = 0.5;      #% expected volatility
expectedDiv     = 0.0146;   #% expected dividend in cents
riskFreeRate    = 0.0425;   #% interest rate
itr = 500000                #% number of iterations
delS = 0*array(0,itr)

for( i in (1:itr))
{
      eps = rnorm(1)          #% random number generator
      dS = expectedDiv*underlyingPrice+underlyingPrice*(riskFreeRate*timeToExpiry) + (underlyingPrice*expectedVol*eps*sqrt(timeToExpiry))
      mv = dS - exercisePrice;

      delS[i] = max(mv,0);
}
mean(delS)
#206.3257
Sys.time - start
Time difference of 36.64036 secs

BTW, you multiply the dividend by the stock price, which is
inconsistent with your"expected dividend in cents" code comment. Plus,
it's a percentage per year, right? If so, I think the first term in
your dS expression should be: expectedDiv*underlyingPrice*timeToExpiry.

I'm going to rewrite your code using short variable names; long 
names make the math itself more difficult for me to immediately see.

start <- Sys.time()
E   <- 0             #exercise price
t   <- 3             #option life (years)
S   <- 490           #stock price (cents)
v   <- 0.5           #est. future annual volatility
d   <- 0.0146        #dividend (code suggests this is a percentage of S)
r   <- 0.0425        #annual interest rate
N   <- 5000000
z   <- S*(d+r*t + rnorm(N, 0, v*sqrt(t)))
sum(z[z > E])/N
#206.203
Sys.time() - start
Time difference of 0.5397904 secs

The loop code takes 68 times as long to run.

Second, why are you using a normal distribution? The usual rough
approximation is to assume a lognormal distribution for stock prices,
but that's flawed, too.

Third, what is the annual interest rate? From your code, it appears to
be the drift rate of the process driving the stock price, which has
nothing to do with interest rates. A more realistic model will
estimate the future drift rate, and using that plus the other
parameters, will calculate a future value for the option. The present
value is that future value discounted at the rate you choose (which is
unlikely to be the riskless rate). The Black-Scholes-Merton derivation
has confused many people on this point.

HTH,

-rex
-- 
For every complex problem there is an answer that is clear, simple, 
and wrong. --H. L. Mencken


From enricoschumann at yahoo.de  Fri Feb  3 09:08:46 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Fri, 03 Feb 2012 09:08:46 +0100
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula R code vs
 Matlab
In-Reply-To: <7BFB9D627A159649BC6C30B6406E3A4813F32F9B82@VAUNSW141.au.cbainet.com>
References: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
	<4F2A5B2E.8020502@yahoo.de>
	<7BFB9D627A159649BC6C30B6406E3A4813F32F9B82@VAUNSW141.au.cbainet.com>
Message-ID: <4F2B960E.3080305@yahoo.de>


Hi Darko,

R's 'max' function behaves differently from MATLAB's. You probably don't 
want

payoff = max(delS - exercisePrice, 0);

but

payoff = pmax(delS - exercisePrice, 0)

(and you should settle on one number of time steps per year; either 255 
or 252).

If you only work with European options and use the 
Black--Scholes--Merton SDE for the underlier, then there is no need to 
simulate the paths of the SDEs; you can do one time step and "jump from 
0 to T".

And as rex has pointed out, there would indeed be a substantial speedup 
if you rewrote your code in a vectorised fashion. (This is also true for 
MATLAB, though the speedup is typically much smaller than in R.)

Regards,
Enrico



Am 03.02.2012 00:36, schrieb Roupell, Darko:
> Thanks Enrico,
>
> To test if the code structure is correct I googled for alternative samples of Monte Carlo Option pricing coded in Matlab.
>
> What I find the most puzzling is that even if I re-code using sample from matlab the results obtained in R are very different to those obtained by matlab, despite using the same parameters apart of Rnorm(). As I am at loss I am hoping that you or someone else in R-SIG may spot the difference that explains it.
>
> ########################################## R code ###########################################################
>
> exercisePrice   = 100;
> timeToExpiry    = 5;        #% in years
> underlyingPrice = 100;      #% underlying in cents
> expectedVol     = 0.2;      #% expected volatility
> expectedDiv     = 0;        # expected dividend
> riskFreeRate    = 0.06;   #% interest rate
> itr = 10000              #% number of iterations
> delS = 0*array(0,itr)
>
> dt = 1/252
> nudt = (riskFreeRate - expectedDiv - 0.5 * expectedVol^ 2)* dt
> sigsdt = expectedVol * sqrt(dt)
> itr = 10000
> delS = array(0,itr)
> drifts = 255 * timeToExpiry
>
> for( i in (1:itr))
> {
> dS =  underlyingPrice
>
>      for (j in (1:drifts))
>      {
>      eps = rnorm(1, mean = 0, sd = 1)
>      dS  = dS * exp(nudt +sigsdt*eps)
>      }
> delS[i] =dS
> }
>
> payoff = max(delS - exercisePrice, 0);
> cal=mean(payoff) * exp(-riskFreeRate*timeToExpiry)
>
> results:
>> cal
> [1] 396.2675
>
> ################################################## MATLAB ###########################################
>
> S0=100; K=100; r=0.06; sig=0.2; T=5; div=0;
>
> dt = 1/252;
> nudt = (r - div - 0.5 * sig ^ 2) * dt;
> sigsdt = sig * sqrt(dt)
> sim=10000;
> Si=zeros(1,sim);
>
> drifts=255*T
> for i=1:sim
> S=S0;
> for j=1:drifts;
> z=randn(1,1);
>
> S = S* exp(nudt + sigsdt * z);
> end
> Si(i)=S;
> end
>
> payoff = max(Si - K, 0);
> cal=mean(payoff) * exp(-r* T)
>
> calbs=blsprice(S0,K,r,T,sig,div)<---B&S
>
> results:
>
> cal = 32.0173
>
>
> calbs = 31.6150
>
> http://www.quantnet.com/forum/threads/accuracy-of-monte-carlo-simulation-for-option-pricing.2224/
>
> __________________________________________________
> Commonwealth Bank
> Darko Roupell
> Associate Quantitative Analyst
> Institutional Banking&  Markets
> Equities Research
> Darling Park Tower 1
> Level 23, 201 Sussex Street
> Sydney, NSW 2000
> P:  +61 2 9117 1254
> F:  +61 2 9118 1000
> M: +61 400 170 515
> E: Darko.Roupell at cba.com.au
> Our vision is to be Australia's finest financial services organisation through excelling in customer service.
>
> Email Security
> This email is sent solely for informational purposes. Hoax emails, commonly referred to as phishing, can appear to be from the Commonwealth Bank and ask you to update or confirm details such as client numbers, passwords, personal identification questions, contact details or account numbers. The Commonwealth Bank will never send you an email asking you to confirm, update or reveal your confidential banking information.
> Important Information
> Produced by Global Markets Research, a business unit of Commonwealth Bank of Australia ABN 48 123 123 124 - AFSL 234945 (Commonwealth Bank). This publication is based on information available at the time of publishing.  We believe that the information in this communication is correct and any opinions, conclusions or recommendations are reasonably held or made as at the time of its compilation, but no warranty is made as to accuracy, reliability or completeness.  To the extent permitted by law, neither Commonwealth Bank nor any of its subsidiaries accept liability to any person for loss or damage arising from the use of this communication. This communication does not purport to be a complete statement or summary.
> The information provided has been prepared without considering your objectives, financial situation or needs, and before acting on the information, you should consider its appropriateness to your circumstances. No person should act on the basis of this report without considering and if necessary taking appropriate professional advice upon their own particular circumstances.
> Commonwealth Bank of Australia, as a provider of investment, borrowing and other financial services undertakes financial transactions with many corporate entities in Australia. This may include any corporate issuer referred to in this communication. Commonwealth Bank and its subsidiaries have effected or may effect transactions for their own account in any investments or related investments referred to herein. In the case of certain securities Commonwealth Bank is or may be the only market maker.
>
> -----Original Message-----
> From: Enrico Schumann [mailto:enricoschumann at yahoo.de]
> Sent: Thursday, 2 February 2012 8:45 PM
> To: Roupell, Darko
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] Monte Carlo Option Pricing formula
>
>
> Hi, Darko,
>
> Am 02.02.2012 07:44, schrieb Roupell, Darko:
>> Hi All,
>>
>> I am trying to cross check option implied employee option price that was derived using Monte Carlo simulation. Below is code and parameter used and after accounting for dividend yield ( 1.46%) the derived option price is 206.8843 using the code snippet provided. Approx 1 cent below 207.95 that is listed in company prospect using their Monte Carlo simulation and below parameters.
>>
>> As we all know number of iteration can also slightly impact the average price, but am I rightly concerned that my methodology may not be correct?
>
> Hm, I have not really looked at your programme so I cannot comment
> whether it is correct. But we are talking about a difference of about
> half a percentage point here. Which is not much. I just ran you script
> 20 times.
>
>   >  summary(results)
>      Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>     205.6   206.0   206.3   206.3   206.8   206.9
>
> Admittedly, all results are all below the company's price, but
> nevertheless: they vary.
>
> There are details that they might have done differently. For instance,
> you do not compound (if I see correctly). What if you replaced
>
> riskFreeRate*timeToExpiry
>
> with
>
> (1+riskFreeRate)*timeToExpiry-1
>
> But even if that gives you the price: from a practical point of view,
> the difference is small, really.
>
> (Much better would be to check what would happen if the div did not turn
> out as expected, if the vol were different, etc)
>
> Regards,
> Enrico
>
>
>>
>> Any feedback will be appreciated.
>>
>>
>> exercisePrice   = 0;
>> timeToExpiry    = 3;        #% in years
>> underlyingPrice = 490;      #% underlying in cents
>> expectedVol     = 0.5;      #% expected volatility
>> expectedDiv     = 0.0146;        #% expected dividend in cents
>> riskFreeRate    = 0.0425;   #% interest rate
>> itr = 500000              #% number of iterations
>> delS = 0*array(0,itr)
>>
>> for( i in (1:itr))
>> {
>>       eps = rnorm(1)         #% random number generator
>>       dS = expectedDiv*underlyingPrice+underlyingPrice*(riskFreeRate*timeToExpiry) + (underlyingPrice*expectedVol*eps*sqrt(timeToExpiry))
>>       mv = dS - exercisePrice;
>>
>>       delS[i] = max(mv,0);
>> }
>>
>> mean(delS)
>>
>> __________________________________________________
>> Commonwealth Bank
>> Darko Roupell
>> Associate Quantitative Analyst
>> Institutional Banking&   Markets
>> Equities Research
>> Darling Park Tower 1
>> Level 23, 201 Sussex Street
>> Sydney, NSW 2000
>> P:  +61 2 9117 1254
>> F:  +61 2 9118 1000
>> M: +61 400 170 515
>> E: Darko.Roupell at cba.com.au
>
> [...]
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


From markleeds2 at gmail.com  Fri Feb  3 13:10:02 2012
From: markleeds2 at gmail.com (Mark Leeds)
Date: Fri, 3 Feb 2012 07:10:02 -0500
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula R code vs
	Matlab
In-Reply-To: <4F2B960E.3080305@yahoo.de>
References: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
	<4F2A5B2E.8020502@yahoo.de>
	<7BFB9D627A159649BC6C30B6406E3A4813F32F9B82@VAUNSW141.au.cbainet.com>
	<4F2B960E.3080305@yahoo.de>
Message-ID: <CAHz+bWbD-F4SgSPG4xBT6_VxvHUBJovZ1LVNPz9myJrdK3SkKw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120203/b4441c16/attachment.pl>

From calvin.lists at gmail.com  Fri Feb  3 20:48:22 2012
From: calvin.lists at gmail.com (Calvin)
Date: Fri, 3 Feb 2012 14:48:22 -0500
Subject: [R-SIG-Finance] RBloomberg hanging on blpConnect()
In-Reply-To: <CAA3Wa=u-veFTQtXTjUixxOZmoOZcQ6bSzJb5g70yUcRVqZ=ndw@mail.gmail.com>
References: <CAP+u5JKF+M_7oi1s-EkPQTVww_ygd82UH=V_K5GtAVsyB3gYWA@mail.gmail.com>
	<CAA3Wa=u-veFTQtXTjUixxOZmoOZcQ6bSzJb5g70yUcRVqZ=ndw@mail.gmail.com>
Message-ID: <CAP+u5JKrmGHYSsgcxB8n8FwT6Rwj_kkQ5Q7xnvcW4DKfqrSYWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120203/5f01550c/attachment.pl>

From rex at nosyntax.net  Fri Feb  3 23:38:29 2012
From: rex at nosyntax.net (rex)
Date: Fri, 3 Feb 2012 14:38:29 -0800
Subject: [R-SIG-Finance] Monte Carlo Option Pricing formula R code vs
 Matlab
In-Reply-To: <7BFB9D627A159649BC6C30B6406E3A4813F32F9B82@VAUNSW141.au.cbainet.com>
References: <7BFB9D627A159649BC6C30B6406E3A4813F32F9550@VAUNSW141.au.cbainet.com>
	<4F2A5B2E.8020502@yahoo.de>
	<7BFB9D627A159649BC6C30B6406E3A4813F32F9B82@VAUNSW141.au.cbainet.com>
Message-ID: <20120203223829.GH26289@ninja.nosyntax.net>

Roupell, Darko <Darko.Roupell at cba.com.au> [2012-02-02 15:37]:

>What I find the most puzzling is that even if I re-code using sample from matlab the results obtained in R are very different to those obtained by matlab, despite using the same parameters apart of Rnorm(). As I am at loss I am hoping that you or someone else in R-SIG may spot the difference that explains it.

As Enrico pointed out, you want pmax, not max, and the final price is
all that matters, not the path, so you don't need the inner loop. And,
you don't need the outer loop, either. Here, your code runs in 38.9
seconds with itr = 10000.

large nested loops in R are an abomination; using the language
effectively requires learning to avoid them whenever possible. In this
case, your code takes 18702(!) times as long to run as a vectorized
Monte Carlo version.

For possible pedagogical value, here's a vectorized MC approach:

start = Sys.time()
E    = 100                            #exercise price
S    = 100                            #initial stock price
t    = 5                              #time to expiration (years)
sd   = 0.2                            #annual volatility
d    = 0.0                            #annual dividend rate 
r    = 0.06                           #riskless interest rate
N    = 1000000                        #number of random walks
mu   = (r - d - 0.5*sd^2)*t           #total drift
SD   = sd*sqrt(t)                     #total volatility
z    = as.vector(rlnorm(N, mu, SD))   #generate all lognormal randoms
endS = S*z                            #ending stock prices
fv   = pmax(0, endS-E)                #future option values
opt  = fv*exp(-r*t)                   #present option values
mean(opt)
#31.6
Sys.time() - start
Time difference of 0.2075577 secs

Note that N is 100 times as large in the above, so the nested loop
version takes 100*38.9/0.208 = 18702 times as long as the vectorized
version does.

HTH,

-rex
--
"In the real world, this would be a problem.  But in mathematics, we
can just define a place where this problem doesn't exist.  So we'll go
ahead and do that now..."


From tanini at qq.com  Sat Feb  4 09:57:40 2012
From: tanini at qq.com (=?gbk?B?4Krqx+rH?=)
Date: Sat, 4 Feb 2012 16:57:40 +0800
Subject: [R-SIG-Finance] quantmod newTA
Message-ID: <tencent_0CEAF86620681C1B698923EB@qq.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120204/efe2a761/attachment.pl>

From jbherman at gmail.com  Sun Feb  5 15:19:00 2012
From: jbherman at gmail.com (kidA)
Date: Sun, 5 Feb 2012 06:19:00 -0800 (PST)
Subject: [R-SIG-Finance] bug in updatePortf
Message-ID: <1328451540135-4359010.post@n4.nabble.com>

summary: *think* i've found a bug in blotter's updatePortf which only arises
in the context of transactions priced from ticks that are not in the Symbols
pricing (OHLC daily for instance)

As you can see below, the posPL tables are correct. They list the
transactions and the Close prices and provide PL measurement for periods
between days UNLESS there is a transaction in which case the PL is broken up
into intraday segments.

THE PROBLEM is in calculating the p$summary table the following call:

	table = .getBySymbol(Portfolio = Portfolio, Attribute = "Pos.Value", Dates
= Dates, Symbols = Symbols)

returns a table defined by:

 for (symbol in symbols) {
        tmp_col =
Portfolio$symbols[[symbol]][[namePosPL]][Dates,Attribute,drop=FALSE]
        if(is.null(table)) table = tmp_col
        else table = merge(table, tmp_col)
}

which uses whatever "Dates" you called updatePortf with or if nothing is
specified grabs price and transaction time stamps from the first symbol's
posPL list (which is an admitted bug):

if(is.null(Dates)) Dates <- time(Portfolio$symbols[[1]]$posPL)  #not quite
right, only using first symbol...

So the only way it can work is with a "Dates" argument that includes every
transaction time in addition to whatever regular bar (5min, daily) you'd
like. If any transaction times are not included in the Dates argument to
updatePortf the intraday piece of PnL marked in symbol$posPL will not be
included in portfolio$summary (as seen below: specifically compare the rows
in p$symbols$`AAPL-US`$posPL with a time component in date index 2008-09-30
15:03:12.137 or 2008-10-01 16:00:00.000  to the rows in p$summary. The
p$summary table has a Net.Trading.PL entry corresponding to every line in
A-US and AAPL-US $posPL tables EXCEPT these two lines. *In summary:
-15558.27 and  -10342.47 of Net.Trading.PL don't make it into the summary
calculations because they don't join to the time index as based upon the
price and transaction times of the arbitrarily first symbols's posPL table*


Also, given a hi-freq portfolio with many trades in many securities marking
the entire portfolio at every transaction time (which the above implies)
could become quite burdensome. It's one thing to mark any given symbol on
all it's transactions. But I would suggest it's more sensible to then
aggregate the symbol PnL to a regularized time signature defined as a
portfolio attribute.

I'm new to R and blotter so please let me know if I misunderstood something.
thoughts?

best, J


reproducible example:
initDate = '1950-01-01'
startDate = '2008-01-09'
endDate = '2010-10-28'
symbols<-c("A-US", "AAPL-US") # note: i'm loading proprietary Closing price
data from RData files

initPortf("p", symbols=symbols, initDate=initDate, currency="USD")

> extractTxns("p")
[1] "addTxn(Portfolio ='p', Symbol ='A-US', TxnDate = '2008-09-30
11:27:38.586', TxnQty =34400, TxnPrice =29.05, TxnFees =-1498.98, ConMult
=1)"     
[2] "addTxn(Portfolio ='p', Symbol ='A-US', TxnDate = '2008-10-06 16:00:00',
TxnQty =-34400, TxnPrice =26.7802, TxnFees =-1381.858, ConMult =1)"     
[3] "addTxn(Portfolio ='p', Symbol ='AAPL-US', TxnDate = '2008-09-30
15:03:12.137', TxnQty =-8900, TxnPrice =112.08, TxnFees =-1496.268, ConMult
=1)"
[4] "addTxn(Portfolio ='p', Symbol ='AAPL-US', TxnDate = '2008-10-01
16:00:00', TxnQty =8900, TxnPrice =110.1169, TxnFees =-1470.061, ConMult
=1)"   

updatePortf(Portfolio="p")  
p <- getPortfolio("p") # make a local copy of the portfolio object
p$summary['2008-09-28/2008-10-8']
p$symbols$`A-US`$txn
p$symbols$`AAPL-US`$txn
p$symbols$`A-US`$posPL['2008-09-28/2008-10-8']
p$symbols$`AAPL-US`$posPL['2008-09-28/2008-10-8']

> updatePortf(Portfolio="p")  
[1] "p"
> 
> p <- getPortfolio("p") # make a local copy of the portfolio object
> 
> p$summary['2008-09-28/2008-10-8']
                        Long.Value Short.Value Net.Value Gross.Value
Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL  Txn.Fees
Net.Trading.PL
2008-09-29 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
2008-09-30 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
2008-09-30 11:27:38.586    1020304           0   1020304     1020304              
0.00                20984         20984.00 -1498.980      19485.020
2008-10-01 00:00:00.000    1020648     -971168     49480     1991816              
0.00                40750         40750.00     0.000      40750.000
2008-10-02 00:00:00.000     968016           0    968016      968016              
0.00               -52632        -52632.00     0.000     -52632.000
2008-10-03 00:00:00.000     972832           0    972832      972832              
0.00                 4816          4816.00     0.000       4816.000
2008-10-06 00:00:00.000     928456           0    928456      928456              
0.00               -44376        -44376.00     0.000     -44376.000
2008-10-06 16:00:00.000          0           0         0           0         
-78081.12                70864         -7217.12 -1381.858      -8598.978
2008-10-07 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
2008-10-08 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
> 
> p$symbols$`A-US`$txn
                        Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty
Pos.Avg.Cost Gross.Txn.Realized.PL  Txn.Fees Net.Txn.Realized.PL Con.Mult
1950-01-01 00:00:00.000       0    0.0000       0.0       0.0000       0        
0.00                  0.00     0.000                0.00        0
2008-09-30 11:27:38.586   34400   29.0500  999320.0      29.0500   34400       
29.05                  0.00 -1498.980            -1498.98        1
2008-10-06 16:00:00.000  -34400   26.7802 -921238.9      26.7802       0        
0.00             -78081.12 -1381.858           -79462.98        1
> p$symbols$`AAPL-US`$txn
                        Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty
Pos.Avg.Cost Gross.Txn.Realized.PL  Txn.Fees Net.Txn.Realized.PL Con.Mult
1950-01-01 00:00:00.000       0    0.0000       0.0       0.0000       0        
0.00                  0.00     0.000               0.000        0
2008-09-30 15:03:12.137   -8900  112.0800 -997512.0     112.0800   -8900      
112.08                  0.00 -1496.268           -1496.268        1
2008-10-01 16:00:00.000    8900  110.1169  980040.4     110.1169       0        
0.00              17471.59 -1470.061           16001.529        1
> 
> p$symbols$`A-US`$posPL['2008-09-28/2008-10-8']
                        Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost
Txn.Value Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL  Txn.Fees
Net.Trading.PL
2008-09-29 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
2008-09-30 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
2008-09-30 11:27:38.586   34400        1        1   1020304        29.05 
999320.0               0.00                20984         20984.00 -1498.980     
19485.020
2008-10-01 00:00:00.000   34400        1        1   1020648         0.00      
0.0               0.00                  344           344.00     0.000       
344.000
2008-10-02 00:00:00.000   34400        1        1    968016         0.00      
0.0               0.00               -52632        -52632.00     0.000    
-52632.000
2008-10-03 00:00:00.000   34400        1        1    972832         0.00      
0.0               0.00                 4816          4816.00     0.000      
4816.000
2008-10-06 00:00:00.000   34400        1        1    928456         0.00      
0.0               0.00               -44376        -44376.00     0.000    
-44376.000
2008-10-06 16:00:00.000       0        1        1         0         0.00
-921238.9          -78081.12                70864         -7217.12 -1381.858     
-8598.978
2008-10-07 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
2008-10-08 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
> p$symbols$`AAPL-US`$posPL['2008-09-28/2008-10-8']
                        Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost
Txn.Value Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL  Txn.Fees
Net.Trading.PL
2008-09-29 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-09-30 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-09-30 15:03:12.137   -8900        1        1  -1011574       112.08
-997512.0               0.00               -14062        -14062.00 -1496.268     
-15558.27
2008-10-01 00:00:00.000   -8900        1        1   -971168         0.00      
0.0               0.00                40406         40406.00     0.000      
40406.00
2008-10-01 16:00:00.000       0        1        1         0         0.00 
980040.4           17471.59               -26344         -8872.41 -1470.061     
-10342.47
2008-10-02 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-03 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-06 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-07 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-08 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00



--
View this message in context: http://r.789695.n4.nabble.com/bug-in-updatePortf-tp4359010p4359010.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jbherman at gmail.com  Sun Feb  5 16:57:06 2012
From: jbherman at gmail.com (kidA)
Date: Sun, 5 Feb 2012 07:57:06 -0800 (PST)
Subject: [R-SIG-Finance] bug in updatePortf
In-Reply-To: <1328451540135-4359010.post@n4.nabble.com>
References: <1328451540135-4359010.post@n4.nabble.com>
Message-ID: <1328457426666-4359140.post@n4.nabble.com>

ALSO: If I call updatePortf with "Dates=paste(startDate,endDate,"::"))" the
p$summary table has all the roles corresponding to intraday PnL, but those
rows have incorrect Long/Short/Net/Gross values which only account for the
exposure of the individual transactions. Note the Long.Value of 1020304 on
2008-09-30 11:27:38.586 that "skips a beat" on the next row (which comes
from a different symbols posPL table) only to return on the next common end
of day price stamp at 2008-10-01 1020648. *So PnLs are complete, while
exposures are not reliable.*

> p$summary['2008-09-28/2008-10-8']
                        Long.Value Short.Value Net.Value Gross.Value
Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL  Txn.Fees
Net.Trading.PL
2008-09-29 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
2008-09-30 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
2008-09-30 11:27:38.586    1020304           0   1020304     1020304              
0.00                20984         20984.00 -1498.980      19485.020
2008-09-30 15:03:12.137          0    -1011574  -1011574     1011574              
0.00               -14062        -14062.00 -1496.268     -15558.268
2008-10-01 00:00:00.000    1020648     -971168     49480     1991816              
0.00                40750         40750.00     0.000      40750.000
2008-10-01 16:00:00.000          0           0         0           0          
17471.59               -26344         -8872.41 -1470.061     -10342.471
2008-10-02 00:00:00.000     968016           0    968016      968016              
0.00               -52632        -52632.00     0.000     -52632.000
2008-10-03 00:00:00.000     972832           0    972832      972832              
0.00                 4816          4816.00     0.000       4816.000
2008-10-06 00:00:00.000     928456           0    928456      928456              
0.00               -44376        -44376.00     0.000     -44376.000
2008-10-06 16:00:00.000          0           0         0           0         
-78081.12                70864         -7217.12 -1381.858      -8598.978
2008-10-07 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
2008-10-08 00:00:00.000          0           0         0           0              
0.00                    0             0.00     0.000          0.000
> p$symbols$`A-US`$txn
                        Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty
Pos.Avg.Cost Gross.Txn.Realized.PL  Txn.Fees Net.Txn.Realized.PL Con.Mult
1950-01-01 00:00:00.000       0    0.0000       0.0       0.0000       0        
0.00                  0.00     0.000                0.00        0
2008-09-30 11:27:38.586   34400   29.0500  999320.0      29.0500   34400       
29.05                  0.00 -1498.980            -1498.98        1
2008-10-06 16:00:00.000  -34400   26.7802 -921238.9      26.7802       0        
0.00             -78081.12 -1381.858           -79462.98        1
> p$symbols$`AAPL-US`$txn
                        Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty
Pos.Avg.Cost Gross.Txn.Realized.PL  Txn.Fees Net.Txn.Realized.PL Con.Mult
1950-01-01 00:00:00.000       0    0.0000       0.0       0.0000       0        
0.00                  0.00     0.000               0.000        0
2008-09-30 15:03:12.137   -8900  112.0800 -997512.0     112.0800   -8900      
112.08                  0.00 -1496.268           -1496.268        1
2008-10-01 16:00:00.000    8900  110.1169  980040.4     110.1169       0        
0.00              17471.59 -1470.061           16001.529        1
> p$symbols$`A-US`$posPL['2008-09-28/2008-10-8']
                        Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost
Txn.Value Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL  Txn.Fees
Net.Trading.PL
2008-09-29 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
2008-09-30 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
2008-09-30 11:27:38.586   34400        1        1   1020304        29.05 
999320.0               0.00                20984         20984.00 -1498.980     
19485.020
2008-10-01 00:00:00.000   34400        1        1   1020648         0.00      
0.0               0.00                  344           344.00     0.000       
344.000
2008-10-02 00:00:00.000   34400        1        1    968016         0.00      
0.0               0.00               -52632        -52632.00     0.000    
-52632.000
2008-10-03 00:00:00.000   34400        1        1    972832         0.00      
0.0               0.00                 4816          4816.00     0.000      
4816.000
2008-10-06 00:00:00.000   34400        1        1    928456         0.00      
0.0               0.00               -44376        -44376.00     0.000    
-44376.000
2008-10-06 16:00:00.000       0        1        1         0         0.00
-921238.9          -78081.12                70864         -7217.12 -1381.858     
-8598.978
2008-10-07 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
2008-10-08 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000         
0.000
> p$symbols$`AAPL-US`$posPL['2008-09-28/2008-10-8']
                        Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost
Txn.Value Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL  Txn.Fees
Net.Trading.PL
2008-09-29 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-09-30 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-09-30 15:03:12.137   -8900        1        1  -1011574       112.08
-997512.0               0.00               -14062        -14062.00 -1496.268     
-15558.27
2008-10-01 00:00:00.000   -8900        1        1   -971168         0.00      
0.0               0.00                40406         40406.00     0.000      
40406.00
2008-10-01 16:00:00.000       0        1        1         0         0.00 
980040.4           17471.59               -26344         -8872.41 -1470.061     
-10342.47
2008-10-02 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-03 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-06 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-07 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
2008-10-08 00:00:00.000       0        1        1         0         0.00      
0.0               0.00                    0             0.00     0.000          
0.00
> 


--
View this message in context: http://r.789695.n4.nabble.com/bug-in-updatePortf-tp4359010p4359140.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From papa.senyo at yahoo.it  Mon Feb  6 13:42:09 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Mon, 6 Feb 2012 12:42:09 +0000 (GMT)
Subject: [R-SIG-Finance] Volatility forecast
Message-ID: <1328532129.67245.YahooMailNeo@web132301.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120206/b6d81246/attachment.pl>

From alexios at 4dscape.com  Mon Feb  6 13:45:03 2012
From: alexios at 4dscape.com (alexios)
Date: Mon, 06 Feb 2012 12:45:03 +0000
Subject: [R-SIG-Finance] Volatility forecast
In-Reply-To: <1328532129.67245.YahooMailNeo@web132301.mail.ird.yahoo.com>
References: <1328532129.67245.YahooMailNeo@web132301.mail.ird.yahoo.com>
Message-ID: <4F2FCB4F.4090202@4dscape.com>

By reading the documentation.
Alexios

On 06/02/2012 12:42, Papa Senyo wrote:
> Dear ALL,
> Please, how does one get volatility forecast using rugarch package?
> kind regards
> Papa
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From papa.senyo at yahoo.it  Mon Feb  6 14:35:14 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Mon, 6 Feb 2012 13:35:14 +0000 (GMT)
Subject: [R-SIG-Finance] Volatility forecast
In-Reply-To: <4F2FCB4F.4090202@4dscape.com>
References: <1328532129.67245.YahooMailNeo@web132301.mail.ird.yahoo.com>
	<4F2FCB4F.4090202@4dscape.com>
Message-ID: <1328535314.32659.YahooMailNeo@web132303.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120206/37b0942c/attachment.pl>

From alexios at 4dscape.com  Mon Feb  6 14:50:28 2012
From: alexios at 4dscape.com (alexios)
Date: Mon, 06 Feb 2012 13:50:28 +0000
Subject: [R-SIG-Finance] Volatility forecast
In-Reply-To: <1328535314.32659.YahooMailNeo@web132303.mail.ird.yahoo.com>
References: <1328532129.67245.YahooMailNeo@web132301.mail.ird.yahoo.com>
	<4F2FCB4F.4090202@4dscape.com>
	<1328535314.32659.YahooMailNeo@web132303.mail.ird.yahoo.com>
Message-ID: <4F2FDAA4.7060204@4dscape.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120206/118af701/attachment.pl>

From jonny.so at gmail.com  Wed Feb  8 18:22:31 2012
From: jonny.so at gmail.com (Jonny So)
Date: Wed, 8 Feb 2012 17:22:31 +0000
Subject: [R-SIG-Finance] rbloomberg includeConditionCodes
Message-ID: <CAMEiyUGZ-tFSaPPy26En11k31dj4B4gtzzQLSMenOokMYgw2PQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120208/28b3b875/attachment.pl>

From linusholtermann at gmx.de  Wed Feb  8 23:30:00 2012
From: linusholtermann at gmx.de (Lin23)
Date: Wed, 8 Feb 2012 14:30:00 -0800 (PST)
Subject: [R-SIG-Finance] Hessian in GARCH-Models (rugarch-package)
Message-ID: <1328740200776-4371133.post@n4.nabble.com>

Hello,

i wrote a code for a GJR-GARCH-Model. With my current data and model there
is something wrong with the robust standard errors and the p-value. I use
maxLik-package with BHHH-algorithm. The coefficients in my model are equal
to those in the rugarch-package or EViews. But the p-value for the intercept
in the variance-equation is way too high in my model. When i estimate my
model with non-robust standard errors (-crossprod(fit$gradientObs))
everything is all right. So I think there is something wrong with the
hessian that is computed by the maxLik-package. I want to compute my own
hessian. I used the code for the hessian from the rugarch-package
(rugarch-numderiv.R). But I failed.  Maybe someone can help me with my
problem. I would appreciate it very much.

My GARCH-code:

garch<-function(y,Di,Mi,Do,Fr,x1,x2,x3,x4,Dum,backcast){
	
      n<-length(y)	
									
	reg <- lm(y ~ Di + Mi + Do + Fr + x1 + x2 + x3 + x4+(Dum:x3)+(Dum:x4))	
#Start Values

	exp.smooth <- function(lambda){
	smooth <- as.vector(1:n-1)
	init.hh <- lambda^n*mean(reg$res^2)+(1-lambda)*sum(lambda^smooth*reg$res^2) 
# Backcast initial variance
	return(init.hh)
	}
	init.hh <- exp.smooth(lambda=backcast)


LLH <- function(par){     										# Log.Likelihood								
     a <-par[1]								
     di <- par[2]		
     mi <- par[3]
     do <- par[4]
     fr <- par[5]
     b1 <- par[6]		
     b2 <- par[7]		
     b3 <- par[8]		
     b4 <- par[9]	
     b5 <- par[10]
     b6 <- par[11]			
     omega <- par[12]	
     alpha <- par[13]
     beta <- par[14]
     gjr <- par[15]
     dummy <- par[16]

     res<-array(n)
     hh<-array(n)
     ll<-numeric(n)
     
     for (i in 1:n){
    
res[i]<-y[i]-a-di*Di[i]-mi*Mi[i]-do*Do[i]-fr*Fr[i]-b1*x1[i]-b2*x2[i]-b3*x3[i]-b4*x4[i]-b5*Dum[i]*x3[i]-b6*Dum[i]*x4[i]
#Mean-Equation
     }
	
     hh[1] <- init.hh
     for(i in 2:n){
     hh[i] <-
(omega+alpha*res[i-1]^2+beta*(hh[i-1]-omega)+ifelse(res[i-1]<0,
gjr*res[i-1]^2, 0))*(1+dummy*Dum[i])		#Variance-Equation
     }
 																		
       for (i in 1:n){
     ll[i] <- -1/2*log(2*pi*hh[i]) - 1/2*res[i]^2/hh[i] 												#
Log.Likelihood
      }
	ll

    	}
  
     	param <- c(reg$coef, omega = 0.1*mean(reg$res^2),alpha = 0.15, beta =
0.6,gjr=0.05,dummy=0)			
    	fit<-maxLik(start=param,
logLik=LLH,method="BHHH",finalHessian=TRUE,iterlim=2500)							# fit with
maxLik-package
									

	grad <- fit$gradientObs
      robust.vcov <-
solve(fit$hessian)%*%t(grad)%*%grad%*%solve(fit$hessian)
	se.coef <- sqrt(diag(robust.vcov))															# robust standard errors
	tval <- fit$estimate/se.coef
	matcoef <- cbind(fit$estimate, se.coef, tval, 2*(1-pnorm(abs(tval))))
	dimnames(matcoef) <- list(names(tval), c("Estimate", "Std. Error","t
value", "Pr(>|t|)"))


cat("\n---------------------------------------------------------------------\n")				
#Output
	cat("\nKoeffizienten\n")

cat("\n---------------------------------------------------------------------\n")
	printCoefmat(matcoef, digits = 6, signif.stars=TRUE)
}
EST1 <-
garch(y=dat2$r_csi,Di=dat2$Di,Mi=dat2$Mi,Do=dat2$Do,Fr=dat2$Fr,x1=dat2$r_t,x2=dat2$r_sp_l,x3=dat2$r_csi_l,x4=dat2$r_csi_l_3,Dum=dat2$f,backcast=0.7)

See below for the hessian-code from the rugarch-package. I dont know what I
to enter for x and for ... in my case. I hope someone can help.

hessian-code from rugarch-package:

.hessian2sided = function(f, x, ...)
{
	n = length(x)
	fx = f(x, ...)
	eps = .Machine$double.eps
	
	# Compute the stepsize (h)
	h = eps^(1/3)*apply(as.data.frame(x), 1,FUN = function(z) max(abs(z),
1e-2))
	xh = x+h
	h = xh-x
	if(length(h) == 1) ee = matrix(h, ncol = 1, nrow = 1) else ee =
as.matrix(diag(h))
	
	# Compute forward and backward steps
	gp = vector(mode = "numeric", length = n)
	gp = apply(ee, 2, FUN = function(z) f(x+z, ...))
	gm = vector(mode="numeric",length=n)
	gm = apply(ee, 2, FUN = function(z) f(x-z, ...))
	H = h%*%t(h)
	Hm = H
	Hp = H
	# Compute "double" forward and backward steps
	for(i in 1:n){
		for(j in  i:n){
			Hp[i,j] = f(x+ee[,i]+ee[,j], ...)
			Hp[j,i] = Hp[i,j]
			Hm[i,j] = f(x-ee[,i]-ee[,j], ...)
			Hm[j,i] = Hm[i,j]
		}
	}
	#Compute the hessian
	for(i in 1:n){
		for(j in  i:n){
			H[i,j] = ( (Hp[i,j]-gp[i]-gp[j]+fx+fx-gm[i]-gm[j]+Hm[i,j]) /H[i,j] )/2
			H[j,i] = H[i,j]
		}
	}
	return(H)
}

Thank you all!!!

--
View this message in context: http://r.789695.n4.nabble.com/Hessian-in-GARCH-Models-rugarch-package-tp4371133p4371133.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From BAVayin at uclan.ac.uk  Thu Feb  9 07:30:36 2012
From: BAVayin at uclan.ac.uk (Baranzan Alhamdu Vayin)
Date: Thu, 9 Feb 2012 06:30:36 +0000
Subject: [R-SIG-Finance] assistance please
Message-ID: <7A8CC04960D0F542B25192E38F02289D0D1F7BA1@AMSPRD0302MB103.eurprd03.prod.outlook.com>

Download data for the same period for FTSE all shares (^FTAS) as well as the
gilts index BG06.L. Using the last two as proxies for the overall market return and the riskfree
return, calculate the appropriate continuously compounded (logarithmic) returns.
1. Provide the appropriate time series regression tests for the CAPM.
2. Estimate the Single Index model for your stock and discuss the differences to the CAPM
estimates.
3. Provide a rolling analysis of the time series CAPM regression. Select appropriate window
and briefly justify your choice. Draw appropriate conclusions from your analysis. pls, could you help me with some clue on how to go about this work. thanks for your anticipated response
________________________________________
From: r-sig-finance-bounces at r-project.org [r-sig-finance-bounces at r-project.org] on behalf of r-sig-finance-request at r-project.org [r-sig-finance-request at r-project.org]
Sent: 07 February 2012 11:00
To: r-sig-finance at r-project.org
Subject: R-SIG-Finance Digest, Vol 93, Issue 6

Send R-SIG-Finance mailing list submissions to
        r-sig-finance at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
        https://stat.ethz.ch/mailman/listinfo/r-sig-finance
or, via email, send a message with subject or body 'help' to
        r-sig-finance-request at r-project.org

You can reach the person managing the list at
        r-sig-finance-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-SIG-Finance digest..."


Today's Topics:

   1. Volatility forecast (Papa Senyo)
   2. Re: Volatility forecast (alexios)
   3. Re: Volatility forecast (Papa Senyo)
   4. Re: Volatility forecast (alexios)


----------------------------------------------------------------------

Message: 1
Date: Mon, 6 Feb 2012 12:42:09 +0000 (GMT)
From: Papa Senyo <papa.senyo at yahoo.it>
To: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: [R-SIG-Finance] Volatility forecast
Message-ID:
        <1328532129.67245.YahooMailNeo at web132301.mail.ird.yahoo.com>
Content-Type: text/plain

Dear ALL,
Please, how does one get volatility forecast using rugarch package?
kind regards
Papa
        [[alternative HTML version deleted]]



------------------------------

Message: 2
Date: Mon, 06 Feb 2012 12:45:03 +0000
From: alexios <alexios at 4dscape.com>
To: Papa Senyo <papa.senyo at yahoo.it>
Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Volatility forecast
Message-ID: <4F2FCB4F.4090202 at 4dscape.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

By reading the documentation.
Alexios

On 06/02/2012 12:42, Papa Senyo wrote:
> Dear ALL,
> Please, how does one get volatility forecast using rugarch package?
> kind regards
> Papa
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



------------------------------

Message: 3
Date: Mon, 6 Feb 2012 13:35:14 +0000 (GMT)
From: Papa Senyo <papa.senyo at yahoo.it>
To: alexios <alexios at 4dscape.com>
Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Volatility forecast
Message-ID:
        <1328535314.32659.YahooMailNeo at web132303.mail.ird.yahoo.com>
Content-Type: text/plain

Please, keep in mind that I have cannot do anything without the documentation. It is a nice package and trying to know the nitty gritty ?of it. There is a forecast for GARCH model and also the report on the loss functions. What i really want to understand is if the loss function are calculated based on the volatility or the mean returns.
kind regards,
papa


________________________________
 Da: alexios <alexios at 4dscape.com>

Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Inviato: Luned? 6 Febbraio 2012 13:45
Oggetto: Re: [R-SIG-Finance] Volatility forecast

By reading the documentation.
Alexios

On 06/02/2012 12:42, Papa Senyo wrote:
> Dear ALL,
> Please, how does one get volatility forecast using rugarch package?
> kind regards
> Papa
> ??? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
        [[alternative HTML version deleted]]



------------------------------

Message: 4
Date: Mon, 06 Feb 2012 13:50:28 +0000
From: alexios <alexios at 4dscape.com>
To: Papa Senyo <papa.senyo at yahoo.it>
Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Volatility forecast
Message-ID: <4F2FDAA4.7060204 at 4dscape.com>
Content-Type: text/plain

But that is not what you asked in your original email!

The 'fpm' method (I assume this is what you refer to as 'report')
returns some summary
forecast performance measures on the fitted return series AND assuming
you have used
the out.sample option in the fit routine (the 'fpm' requires at least 6
out.sample points to
compute the statistics). Because forecasts can be a combination of both
rolling and unconditional
type, the extractor methods (as.array, as.data.frame etc) have a host of
options to indicate
what exactly you want to extract from the object. If you go through the
tests in the 'inst' folder
of the source package, you will see many examples of how this works.

Finally, it would not be possible to return such measures on the
volatility as that is not observed (although
you could very roughly proxy it with abs or squared returns...).
However, if you have your own realized volatility series then surely it
is quite simple to compute
those yourself.

Alexios

On 06/02/12 13:35, Papa Senyo wrote:
> Please, keep in mind that I have cannot do anything without the
> documentation. It is a nice package and trying to know the nitty
> gritty  of it. There is a forecast for GARCH model and also the report
> on the loss functions. What i really want to understand is if the loss
> function are calculated based on the volatility or the mean returns.
> kind regards,
> papa
>
> ------------------------------------------------------------------------
> *Da:* alexios <alexios at 4dscape.com>
> *A:* Papa Senyo <papa.senyo at yahoo.it>
> *Cc:* "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> *Inviato:* Luned? 6 Febbraio 2012 13:45
> *Oggetto:* Re: [R-SIG-Finance] Volatility forecast
>
> By reading the documentation.
> Alexios
>
> On 06/02/2012 12:42, Papa Senyo wrote:
> > Dear ALL,
> > Please, how does one get volatility forecast using rugarch package?
> > kind regards
> > Papa
> >     [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R
> questions should go.
> >
>
>
>


        [[alternative HTML version deleted]]



------------------------------

_______________________________________________
R-SIG-Finance mailing list
R-SIG-Finance at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-finance


End of R-SIG-Finance Digest, Vol 93, Issue 6
********************************************



From alexios at 4dscape.com  Thu Feb  9 13:28:37 2012
From: alexios at 4dscape.com (alexios)
Date: Thu, 09 Feb 2012 12:28:37 +0000
Subject: [R-SIG-Finance] Hessian in GARCH-Models (rugarch-package)
In-Reply-To: <1328740200776-4371133.post@n4.nabble.com>
References: <1328740200776-4371133.post@n4.nabble.com>
Message-ID: <4F33BBF5.3090301@4dscape.com>

Dear Linus,

If you want to calculate the robust covariance matrix of the parameters 
you should look at the 'robustvcv' function in the 'rugarch-numderiv.R' 
file.
It is based on White's (1982) method and descibed in the Vignette 
(original coding is due to K.Sheppard and translated from matlab into 
R). You will need to enable the returning of the "non-summed" vector of 
likelihoods from your function (just use a switch as I do in my code).
To answer your other question, "x" is the vector of parameters at the
optimum, "f" the likelihood function (returning the scalar likelihood),
"..." any additional parameters required by your likelihood function.

HTH.

Regards,
Alexios

On 08/02/2012 22:30, Lin23 wrote:
> Hello,
>
> i wrote a code for a GJR-GARCH-Model. With my current data and model there
> is something wrong with the robust standard errors and the p-value. I use
> maxLik-package with BHHH-algorithm. The coefficients in my model are equal
> to those in the rugarch-package or EViews. But the p-value for the intercept
> in the variance-equation is way too high in my model. When i estimate my
> model with non-robust standard errors (-crossprod(fit$gradientObs))
> everything is all right. So I think there is something wrong with the
> hessian that is computed by the maxLik-package. I want to compute my own
> hessian. I used the code for the hessian from the rugarch-package
> (rugarch-numderiv.R). But I failed.  Maybe someone can help me with my
> problem. I would appreciate it very much.
>
> My GARCH-code:
>
> garch<-function(y,Di,Mi,Do,Fr,x1,x2,x3,x4,Dum,backcast){
> 	
>        n<-length(y)	
> 									
> 	reg<- lm(y ~ Di + Mi + Do + Fr + x1 + x2 + x3 + x4+(Dum:x3)+(Dum:x4))	
> #Start Values
>
> 	exp.smooth<- function(lambda){
> 	smooth<- as.vector(1:n-1)
> 	init.hh<- lambda^n*mean(reg$res^2)+(1-lambda)*sum(lambda^smooth*reg$res^2)
> # Backcast initial variance
> 	return(init.hh)
> 	}
> 	init.hh<- exp.smooth(lambda=backcast)
>
>
> LLH<- function(par){     										# Log.Likelihood								
>       a<-par[1]								
>       di<- par[2]		
>       mi<- par[3]
>       do<- par[4]
>       fr<- par[5]
>       b1<- par[6]		
>       b2<- par[7]		
>       b3<- par[8]		
>       b4<- par[9]	
>       b5<- par[10]
>       b6<- par[11]			
>       omega<- par[12]	
>       alpha<- par[13]
>       beta<- par[14]
>       gjr<- par[15]
>       dummy<- par[16]
>
>       res<-array(n)
>       hh<-array(n)
>       ll<-numeric(n)
>
>       for (i in 1:n){
>
> res[i]<-y[i]-a-di*Di[i]-mi*Mi[i]-do*Do[i]-fr*Fr[i]-b1*x1[i]-b2*x2[i]-b3*x3[i]-b4*x4[i]-b5*Dum[i]*x3[i]-b6*Dum[i]*x4[i]
> #Mean-Equation
>       }
> 	
>       hh[1]<- init.hh
>       for(i in 2:n){
>       hh[i]<-
> (omega+alpha*res[i-1]^2+beta*(hh[i-1]-omega)+ifelse(res[i-1]<0,
> gjr*res[i-1]^2, 0))*(1+dummy*Dum[i])		#Variance-Equation
>       }
>   																		
>         for (i in 1:n){
>       ll[i]<- -1/2*log(2*pi*hh[i]) - 1/2*res[i]^2/hh[i] 												#
> Log.Likelihood
>        }
> 	ll
>
>      	}
>
>       	param<- c(reg$coef, omega = 0.1*mean(reg$res^2),alpha = 0.15, beta =
> 0.6,gjr=0.05,dummy=0)			
>      	fit<-maxLik(start=param,
> logLik=LLH,method="BHHH",finalHessian=TRUE,iterlim=2500)							# fit with
> maxLik-package
> 									
>
> 	grad<- fit$gradientObs
>        robust.vcov<-
> solve(fit$hessian)%*%t(grad)%*%grad%*%solve(fit$hessian)
> 	se.coef<- sqrt(diag(robust.vcov))															# robust standard errors
> 	tval<- fit$estimate/se.coef
> 	matcoef<- cbind(fit$estimate, se.coef, tval, 2*(1-pnorm(abs(tval))))
> 	dimnames(matcoef)<- list(names(tval), c("Estimate", "Std. Error","t
> value", "Pr(>|t|)"))
>
>
> cat("\n---------------------------------------------------------------------\n")				
> #Output
> 	cat("\nKoeffizienten\n")
>
> cat("\n---------------------------------------------------------------------\n")
> 	printCoefmat(matcoef, digits = 6, signif.stars=TRUE)
> }
> EST1<-
> garch(y=dat2$r_csi,Di=dat2$Di,Mi=dat2$Mi,Do=dat2$Do,Fr=dat2$Fr,x1=dat2$r_t,x2=dat2$r_sp_l,x3=dat2$r_csi_l,x4=dat2$r_csi_l_3,Dum=dat2$f,backcast=0.7)
>
> See below for the hessian-code from the rugarch-package. I dont know what I
> to enter for x and for ... in my case. I hope someone can help.
>
> hessian-code from rugarch-package:
>
> .hessian2sided = function(f, x, ...)
> {
> 	n = length(x)
> 	fx = f(x, ...)
> 	eps = .Machine$double.eps
> 	
> 	# Compute the stepsize (h)
> 	h = eps^(1/3)*apply(as.data.frame(x), 1,FUN = function(z) max(abs(z),
> 1e-2))
> 	xh = x+h
> 	h = xh-x
> 	if(length(h) == 1) ee = matrix(h, ncol = 1, nrow = 1) else ee =
> as.matrix(diag(h))
> 	
> 	# Compute forward and backward steps
> 	gp = vector(mode = "numeric", length = n)
> 	gp = apply(ee, 2, FUN = function(z) f(x+z, ...))
> 	gm = vector(mode="numeric",length=n)
> 	gm = apply(ee, 2, FUN = function(z) f(x-z, ...))
> 	H = h%*%t(h)
> 	Hm = H
> 	Hp = H
> 	# Compute "double" forward and backward steps
> 	for(i in 1:n){
> 		for(j in  i:n){
> 			Hp[i,j] = f(x+ee[,i]+ee[,j], ...)
> 			Hp[j,i] = Hp[i,j]
> 			Hm[i,j] = f(x-ee[,i]-ee[,j], ...)
> 			Hm[j,i] = Hm[i,j]
> 		}
> 	}
> 	#Compute the hessian
> 	for(i in 1:n){
> 		for(j in  i:n){
> 			H[i,j] = ( (Hp[i,j]-gp[i]-gp[j]+fx+fx-gm[i]-gm[j]+Hm[i,j]) /H[i,j] )/2
> 			H[j,i] = H[i,j]
> 		}
> 	}
> 	return(H)
> }
>
> Thank you all!!!
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Hessian-in-GARCH-Models-rugarch-package-tp4371133p4371133.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From brian at braverock.com  Thu Feb  9 13:30:20 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 09 Feb 2012 06:30:20 -0600
Subject: [R-SIG-Finance] CAPM homework (was RE: assistance please)
In-Reply-To: <7A8CC04960D0F542B25192E38F02289D0D1F7BA1@AMSPRD0302MB103.eurprd03.prod.outlook.com>
References: <7A8CC04960D0F542B25192E38F02289D0D1F7BA1@AMSPRD0302MB103.eurprd03.prod.outlook.com>
Message-ID: <1328790620.3743.21.camel@brian-rcg>

On Thu, 2012-02-09 at 06:30 +0000, Baranzan Alhamdu Vayin wrote:
> Download data for the same period for FTSE all shares (^FTAS) as well as the
> gilts index BG06.L. Using the last two as proxies for the overall market return and the riskfree
> return, calculate the appropriate continuously compounded (logarithmic) returns.
> 1. Provide the appropriate time series regression tests for the CAPM.
> 2. Estimate the Single Index model for your stock and discuss the differences to the CAPM
> estimates.
> 3. Provide a rolling analysis of the time series CAPM regression. Select appropriate window
> and briefly justify your choice. Draw appropriate conclusions from your analysis. 

> pls, could you help me with some clue on how to go about this work. thanks for your anticipated response

It's not polite to hit 'reply' to a digest post.  If your email reader
can't handle digests correctly (as Microsoft Outlook and many others
cannot), then change your list preferences to receive individual emails,
and use your mail client's filter capabilities to move posts from this
list into a folder.

This looks shockingly like a homework question, so I'm not going to give
you the answers, only a bit of direction.

>From the R console:

install.packages(quantmod)
install.packages(PerformanceAnalytics)
require(quantmod)
require(PerformanceAnalytics)
?getSymbols
?Return.calculate
?CAPM.utils
?chart.RollingRegression

In the future, please follow the posting guide[1] and esr[2] and *try*
first.  Search on rseek.org, which would likely have found all the
functions described above.  Try some things.  *Then* post on r-help or
here (depending on whether your question is general to R or specific to
finance, respectively) showing what you've already tried, and being
specific about where you are having difficulty.

Regards,

    - Brian

Ref: 
[1] http://www.r-project.org/posting-guide.html
[2] http://catb.org/esr/faqs/smart-questions.html

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Thu Feb  9 13:57:00 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 09 Feb 2012 06:57:00 -0600
Subject: [R-SIG-Finance] [Fwd: CAPM homework]
Message-ID: <1328792220.3743.24.camel@brian-rcg>

to the list


-------- Forwarded Message --------
From: Baranzan Alhamdu Vayin <BAVayin at uclan.ac.uk>
To: Brian G. Peterson <brian at braverock.com>
Subject: CAPM homework
Date: Thu, 9 Feb 2012 12:45:06 +0000

many thanks brian. so sorry for violating your procedure. it was not intentional.i am not aware. please pardon me. i just posted the complete question with my R.code (the code i wrote), before your response came. my company is Whitbread PLC. the ticker symbol is "WBT". 
A table detailing company data allocation for each student has been attached with this
assignment. All these companies are included in the FTSE100 index. Download daily data for
the last five years (subject to availability) for the particular stock, allocated to you. You need
to identify the particular ticker (symbol) for the company you are given. Pay particular
attention to the fact that some companies can be traded on different markets. You need the
British shares of any such companies. Up to 5 points can be rewarded if you explain why this
is the case in this assignment.
It is up to you how you download this data (but please note the source and mention it in your
assignment). Download data for the same period for FTSE all shares (^FTAS) as well as the
gilts index BG06.L. Using the last two as proxies for the overall market return and the riskfree
return, calculate the appropriate continuously compounded (logarithmic) returns.
1. Provide the appropriate time series regression tests for the CAPM.
2. Estimate the Single Index model for your stock and discuss the differences to the CAPM
estimates.
3. Provide a rolling analysis of the time series CAPM regression. Select appropriate window
and briefly justify your choice. Draw appropriate conclusions from your analysis
Presentation and marking guidelines:
This assignment involves four (1, 2, 3) practical tasks that carry equal weighting. For each of
the above you need to present a computer output demonstrating you have accomplished the
task. This should consist of both computer code and output from the execution of the code.
Please provide details and explanations for any relevant estimation procedures and fully
explain them. No marks will be rewarded if you provide correct results but fail to explain
them (since you may copy the answers from someone else without properly understanding it).
It should be clear to a third party reader, what you have done and more importantly why you
have done it. Aim to provide self-contained explanations that contain enough detail that
allows one to replicate your results (provided they use different estimation software).
Furthermore if they are calculation mistakes, it should be clear of whether you got the
principles right and simply obtained the wrong results because of typing errors, or did not
understood the task. If details are missing, or they are insufficient, the latter will be assumed
resulting in lower marks.
When explaining, refer to background theory, but do not replicate textbooks material. This
assignment is designed to test understanding (alongside practical skills) rather than ability to
rephrase teaching material.
below is my R.code. i do not really really understand the question, so not too sure of what i have done. i shall be most grateful, if you respond swiftly like you did. please, help me with a clearer explanation. many thanks for your quick response, vayin. i equally attached my R.code to this mail.
library("TSA")
library("tseries")
library("zoo")

AvivaDailyPrices = get.hist.quote(instrument="AV.L", start="2007-01-22",
                             end="2012-01-20", quote="AdjClose",
                             provider="yahoo", origin="1970-01-01",
                             compression="d", retclass="zoo")
class(AvivaDailyPrices)
colnames(AvivaDailyPrices)
start(AvivaDailyPrices)
end(AvivaDailyPrices)
nrow(AvivaDailyPrices)
colnames(AvivaDailyPrices) = "AVIVA"

FTSEDailyPrices = get.hist.quote(instrument="^ftas", start="2007-01-22",
                             end="2012-01-20", quote="AdjClose",
                             provider="yahoo", origin="1970-01-01",
                             compression="d", retclass="zoo")
colnames(FTSEDailyPrices) = "FTSE"

GiltDailyPrices = get.hist.quote(instrument="BG06.L", start="2007-01-22",
                             end="2012-01-20", quote="AdjClose",
                             provider="yahoo", origin="1970-01-01",
                             compression="d", retclass="zoo")
colnames(GiltDailyPrices) = "GILT"
# compute daily cc returns
#

AvivaDailyReturns = diff(log(AvivaDailyPrices))
Aviva.df = as.data.frame(coredata(AvivaDailyPrices))
FTSEDailyReturns = diff(log(FTSEDailyPrices))
FTSE.df = as.data.frame(coredata(AvivaDailyPrices))
GILTDailyReturns = diff(log(GiltDailyPrices))
GILT.df = as.data.frame(coredata(GILTDailyPrices))
DailyReturns = merge(AvivaDailyReturns, FTSEDailyReturns,GILTDailyReturns)
DailyReturns = merge(AvivaDailyReturns, FTSEDailyReturns,GILTDailyReturns, by=?date?, all=T)
# create matrix data 
AvivaDailyReturns.mat = coredata(AvivaDailyReturns)
FTSEDailyReturns.mat = coredata(FTSEDailyReturns)
GILTDailyReturns.mat = coredata(GILTDailyReturns)
DailyReturns.mat = coredata(DailyReturns)

# create excess returns by subtracting off risk free rate
# note: coredata() function extracts data from zoo object
DailyReturns.mat = as.matrix(coredata(DailyReturns))
excessReturns.mat = DailyReturns.mat - DailyReturns.mat[,"GILT"]
excessReturns.df = as.data.frame(excessReturns.mat)

# CAPM regression for Aviva (AVIVA) using 5 years of data
capm.fit = lm(AVIVA~FTSE,data=excessReturns.df)
capm.fit = lm(AVIVA~FTSE,data=excessReturns.df)
summary(capm.fit)

# plot data and regression line
plot(excessReturns.df$FTSE,excessReturns.df$AVIVA,
main="CAPM regression for AVIVA",
ylab="Excess returns on AVIVA",
xlab="Excess returns on FTSE")
abline(capm.fit)					# plot regression line
abline(h=0,v=0)					# plot horizontal and vertical lines at 0

 
________________________________________
From: r-sig-finance-bounces at r-project.org [r-sig-finance-bounces at r-project.org] on behalf of r-sig-finance-request at r-project.org [r-sig-finance-request at r-project.org]
Sent: 09 February 2012 11:00
To: r-sig-finance at r-project.org
Subject: R-SIG-Finance Digest, Vol 93, Issue 7

Send R-SIG-Finance mailing list submissions to
        r-sig-finance at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
        https://stat.ethz.ch/mailman/listinfo/r-sig-finance
or, via email, send a message with subject or body 'help' to
        r-sig-finance-request at r-project.org

You can reach the person managing the list at
        r-sig-finance-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-SIG-Finance digest..."


Today's Topics:

   1. rbloomberg includeConditionCodes (Jonny So)
   2. Hessian in GARCH-Models (rugarch-package) (Lin23)
   3. assistance please (Baranzan Alhamdu Vayin)


----------------------------------------------------------------------

Message: 1
Date: Wed, 8 Feb 2012 17:22:31 +0000
From: Jonny So <jonny.so at gmail.com>
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] rbloomberg includeConditionCodes
Message-ID:
        <CAMEiyUGZ-tFSaPPy26En11k31dj4B4gtzzQLSMenOokMYgw2PQ at mail.gmail.com>
Content-Type: text/plain

I'm trying to get trade tick data with condition codes but the
includeConditionCodes option doesn't seem to do anything.

tick(con, "BP/ LN Equity", "TRADE", "2012-01-19 16:29:50.000", "2012-01-19
16:29:59.000", option_names="includeConditionCodes", option_values="TRUE")

Clearly I'm missing something - can anyone tell me what it is?

        [[alternative HTML version deleted]]



------------------------------

Message: 2
Date: Wed, 8 Feb 2012 14:30:00 -0800 (PST)
From: Lin23 <linusholtermann at gmx.de>
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] Hessian in GARCH-Models (rugarch-package)
Message-ID: <1328740200776-4371133.post at n4.nabble.com>
Content-Type: text/plain; charset=us-ascii

Hello,

i wrote a code for a GJR-GARCH-Model. With my current data and model there
is something wrong with the robust standard errors and the p-value. I use
maxLik-package with BHHH-algorithm. The coefficients in my model are equal
to those in the rugarch-package or EViews. But the p-value for the intercept
in the variance-equation is way too high in my model. When i estimate my
model with non-robust standard errors (-crossprod(fit$gradientObs))
everything is all right. So I think there is something wrong with the
hessian that is computed by the maxLik-package. I want to compute my own
hessian. I used the code for the hessian from the rugarch-package
(rugarch-numderiv.R). But I failed.  Maybe someone can help me with my
problem. I would appreciate it very much.

My GARCH-code:

garch<-function(y,Di,Mi,Do,Fr,x1,x2,x3,x4,Dum,backcast){

      n<-length(y)

        reg <- lm(y ~ Di + Mi + Do + Fr + x1 + x2 + x3 + x4+(Dum:x3)+(Dum:x4))
#Start Values

        exp.smooth <- function(lambda){
        smooth <- as.vector(1:n-1)
        init.hh <- lambda^n*mean(reg$res^2)+(1-lambda)*sum(lambda^smooth*reg$res^2)
# Backcast initial variance
        return(init.hh)
        }
        init.hh <- exp.smooth(lambda=backcast)


LLH <- function(par){                                                                                   # Log.Likelihood
     a <-par[1]
     di <- par[2]
     mi <- par[3]
     do <- par[4]
     fr <- par[5]
     b1 <- par[6]
     b2 <- par[7]
     b3 <- par[8]
     b4 <- par[9]
     b5 <- par[10]
     b6 <- par[11]
     omega <- par[12]
     alpha <- par[13]
     beta <- par[14]
     gjr <- par[15]
     dummy <- par[16]

     res<-array(n)
     hh<-array(n)
     ll<-numeric(n)

     for (i in 1:n){

res[i]<-y[i]-a-di*Di[i]-mi*Mi[i]-do*Do[i]-fr*Fr[i]-b1*x1[i]-b2*x2[i]-b3*x3[i]-b4*x4[i]-b5*Dum[i]*x3[i]-b6*Dum[i]*x4[i]
#Mean-Equation
     }

     hh[1] <- init.hh
     for(i in 2:n){
     hh[i] <-
(omega+alpha*res[i-1]^2+beta*(hh[i-1]-omega)+ifelse(res[i-1]<0,
gjr*res[i-1]^2, 0))*(1+dummy*Dum[i])            #Variance-Equation
     }

       for (i in 1:n){
     ll[i] <- -1/2*log(2*pi*hh[i]) - 1/2*res[i]^2/hh[i]                                                                                                 #
Log.Likelihood
      }
        ll

        }

        param <- c(reg$coef, omega = 0.1*mean(reg$res^2),alpha = 0.15, beta =
0.6,gjr=0.05,dummy=0)
        fit<-maxLik(start=param,
logLik=LLH,method="BHHH",finalHessian=TRUE,iterlim=2500)                                                        # fit with
maxLik-package


        grad <- fit$gradientObs
      robust.vcov <-
solve(fit$hessian)%*%t(grad)%*%grad%*%solve(fit$hessian)
        se.coef <- sqrt(diag(robust.vcov))                                                                                                                      # robust standard errors
        tval <- fit$estimate/se.coef
        matcoef <- cbind(fit$estimate, se.coef, tval, 2*(1-pnorm(abs(tval))))
        dimnames(matcoef) <- list(names(tval), c("Estimate", "Std. Error","t
value", "Pr(>|t|)"))


cat("\n---------------------------------------------------------------------\n")
#Output
        cat("\nKoeffizienten\n")

cat("\n---------------------------------------------------------------------\n")
        printCoefmat(matcoef, digits = 6, signif.stars=TRUE)
}
EST1 <-
garch(y=dat2$r_csi,Di=dat2$Di,Mi=dat2$Mi,Do=dat2$Do,Fr=dat2$Fr,x1=dat2$r_t,x2=dat2$r_sp_l,x3=dat2$r_csi_l,x4=dat2$r_csi_l_3,Dum=dat2$f,backcast=0.7)

See below for the hessian-code from the rugarch-package. I dont know what I
to enter for x and for ... in my case. I hope someone can help.

hessian-code from rugarch-package:

.hessian2sided = function(f, x, ...)
{
        n = length(x)
        fx = f(x, ...)
        eps = .Machine$double.eps

        # Compute the stepsize (h)
        h = eps^(1/3)*apply(as.data.frame(x), 1,FUN = function(z) max(abs(z),
1e-2))
        xh = x+h
        h = xh-x
        if(length(h) == 1) ee = matrix(h, ncol = 1, nrow = 1) else ee =
as.matrix(diag(h))

        # Compute forward and backward steps
        gp = vector(mode = "numeric", length = n)
        gp = apply(ee, 2, FUN = function(z) f(x+z, ...))
        gm = vector(mode="numeric",length=n)
        gm = apply(ee, 2, FUN = function(z) f(x-z, ...))
        H = h%*%t(h)
        Hm = H
        Hp = H
        # Compute "double" forward and backward steps
        for(i in 1:n){
                for(j in  i:n){
                        Hp[i,j] = f(x+ee[,i]+ee[,j], ...)
                        Hp[j,i] = Hp[i,j]
                        Hm[i,j] = f(x-ee[,i]-ee[,j], ...)
                        Hm[j,i] = Hm[i,j]
                }
        }
        #Compute the hessian
        for(i in 1:n){
                for(j in  i:n){
                        H[i,j] = ( (Hp[i,j]-gp[i]-gp[j]+fx+fx-gm[i]-gm[j]+Hm[i,j]) /H[i,j] )/2
                        H[j,i] = H[i,j]
                }
        }
        return(H)
}

Thank you all!!!

--
View this message in context: http://r.789695.n4.nabble.com/Hessian-in-GARCH-Models-rugarch-package-tp4371133p4371133.html
Sent from the Rmetrics mailing list archive at Nabble.com.



------------------------------

Message: 3
Date: Thu, 9 Feb 2012 06:30:36 +0000
From: Baranzan Alhamdu Vayin <BAVayin at uclan.ac.uk>
To: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: [R-SIG-Finance] assistance please
Message-ID:
        <7A8CC04960D0F542B25192E38F02289D0D1F7BA1 at AMSPRD0302MB103.eurprd03.prod.outlook.com>

Content-Type: text/plain; charset="us-ascii"

Download data for the same period for FTSE all shares (^FTAS) as well as the
gilts index BG06.L. Using the last two as proxies for the overall market return and the riskfree
return, calculate the appropriate continuously compounded (logarithmic) returns.
1. Provide the appropriate time series regression tests for the CAPM.
2. Estimate the Single Index model for your stock and discuss the differences to the CAPM
estimates.
3. Provide a rolling analysis of the time series CAPM regression. Select appropriate window
and briefly justify your choice. Draw appropriate conclusions from your analysis. pls, could you help me with some clue on how to go about this work. thanks for your anticipated response
________________________________________
From: r-sig-finance-bounces at r-project.org [r-sig-finance-bounces at r-project.org] on behalf of r-sig-finance-request at r-project.org [r-sig-finance-request at r-project.org]
Sent: 07 February 2012 11:00
To: r-sig-finance at r-project.org
Subject: R-SIG-Finance Digest, Vol 93, Issue 6

Send R-SIG-Finance mailing list submissions to
        r-sig-finance at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
        https://stat.ethz.ch/mailman/listinfo/r-sig-finance
or, via email, send a message with subject or body 'help' to
        r-sig-finance-request at r-project.org

You can reach the person managing the list at
        r-sig-finance-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-SIG-Finance digest..."


Today's Topics:

   1. Volatility forecast (Papa Senyo)
   2. Re: Volatility forecast (alexios)
   3. Re: Volatility forecast (Papa Senyo)
   4. Re: Volatility forecast (alexios)


----------------------------------------------------------------------

Message: 1
Date: Mon, 6 Feb 2012 12:42:09 +0000 (GMT)
From: Papa Senyo <papa.senyo at yahoo.it>
To: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: [R-SIG-Finance] Volatility forecast
Message-ID:
        <1328532129.67245.YahooMailNeo at web132301.mail.ird.yahoo.com>
Content-Type: text/plain

Dear ALL,
Please, how does one get volatility forecast using rugarch package?
kind regards
Papa
        [[alternative HTML version deleted]]



------------------------------

Message: 2
Date: Mon, 06 Feb 2012 12:45:03 +0000
From: alexios <alexios at 4dscape.com>

Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Volatility forecast
Message-ID: <4F2FCB4F.4090202 at 4dscape.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

By reading the documentation.
Alexios

On 06/02/2012 12:42, Papa Senyo wrote:
> Dear ALL,
> Please, how does one get volatility forecast using rugarch package?
> kind regards
> Papa
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



------------------------------

Message: 3
Date: Mon, 6 Feb 2012 13:35:14 +0000 (GMT)

To: alexios <alexios at 4dscape.com>
Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Volatility forecast
Message-ID:
        <1328535314.32659.YahooMailNeo at web132303.mail.ird.yahoo.com>
Content-Type: text/plain

Please, keep in mind that I have cannot do anything without the documentation. It is a nice package and trying to know the nitty gritty ?of it. There is a forecast for GARCH model and also the report on the loss functions. What i really want to understand is if the loss function are calculated based on the volatility or the mean returns.
kind regards,
papa


________________________________
 Da: alexios <alexios at 4dscape.com>

Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Inviato: Luned? 6 Febbraio 2012 13:45
Oggetto: Re: [R-SIG-Finance] Volatility forecast

By reading the documentation.
Alexios

On 06/02/2012 12:42, Papa Senyo wrote:
> Dear ALL,
> Please, how does one get volatility forecast using rugarch package?
> kind regards
> Papa
> ??? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
        [[alternative HTML version deleted]]



------------------------------

Message: 4
Date: Mon, 06 Feb 2012 13:50:28 +0000
From: alexios <alexios at 4dscape.com>

Cc: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] Volatility forecast
Message-ID: <4F2FDAA4.7060204 at 4dscape.com>
Content-Type: text/plain

[[elided Yahoo spam]]

The 'fpm' method (I assume this is what you refer to as 'report')
returns some summary
forecast performance measures on the fitted return series AND assuming
you have used
the out.sample option in the fit routine (the 'fpm' requires at least 6
out.sample points to
compute the statistics). Because forecasts can be a combination of both
rolling and unconditional
type, the extractor methods (as.array, as.data.frame etc) have a host of
options to indicate
what exactly you want to extract from the object. If you go through the
tests in the 'inst' folder
of the source package, you will see many examples of how this works.

Finally, it would not be possible to return such measures on the
volatility as that is not observed (although
you could very roughly proxy it with abs or squared returns...).
However, if you have your own realized volatility series then surely it
is quite simple to compute
those yourself.

Alexios

On 06/02/12 13:35, Papa Senyo wrote:
> Please, keep in mind that I have cannot do anything without the
> documentation. It is a nice package and trying to know the nitty
> gritty  of it. There is a forecast for GARCH model and also the report
> on the loss functions. What i really want to understand is if the loss
> function are calculated based on the volatility or the mean returns.
> kind regards,
> papa
>
> ------------------------------------------------------------------------
> *Da:* alexios <alexios at 4dscape.com>

> *Cc:* "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
> *Inviato:* Luned? 6 Febbraio 2012 13:45
> *Oggetto:* Re: [R-SIG-Finance] Volatility forecast
>
> By reading the documentation.
> Alexios
>
> On 06/02/2012 12:42, Papa Senyo wrote:
> > Dear ALL,
> > Please, how does one get volatility forecast using rugarch package?
> > kind regards
> > Papa
> >     [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R
> questions should go.
> >
>
>
>


        [[alternative HTML version deleted]]



------------------------------

_______________________________________________
R-SIG-Finance mailing list
R-SIG-Finance at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-finance


End of R-SIG-Finance Digest, Vol 93, Issue 6
********************************************




------------------------------

_______________________________________________
R-SIG-Finance mailing list
R-SIG-Finance at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-finance


End of R-SIG-Finance Digest, Vol 93, Issue 7
********************************************


________________________________________
From: Brian G. Peterson [brian at braverock.com]
Sent: 09 February 2012 12:30
To: Baranzan Alhamdu Vayin
Cc: r-sig-finance at r-project.org
Subject: Re: CAPM homework (was RE: assistance please)

On Thu, 2012-02-09 at 06:30 +0000, Baranzan Alhamdu Vayin wrote:
> Download data for the same period for FTSE all shares (^FTAS) as well as the
> gilts index BG06.L. Using the last two as proxies for the overall market return and the riskfree
> return, calculate the appropriate continuously compounded (logarithmic) returns.
> 1. Provide the appropriate time series regression tests for the CAPM.
> 2. Estimate the Single Index model for your stock and discuss the differences to the CAPM
> estimates.
> 3. Provide a rolling analysis of the time series CAPM regression. Select appropriate window
> and briefly justify your choice. Draw appropriate conclusions from your analysis.

> pls, could you help me with some clue on how to go about this work. thanks for your anticipated response

It's not polite to hit 'reply' to a digest post.  If your email reader
can't handle digests correctly (as Microsoft Outlook and many others
cannot), then change your list preferences to receive individual emails,
and use your mail client's filter capabilities to move posts from this
list into a folder.

This looks shockingly like a homework question, so I'm not going to give
you the answers, only a bit of direction.

>From the R console:

install.packages(quantmod)
install.packages(PerformanceAnalytics)
require(quantmod)
require(PerformanceAnalytics)
?getSymbols
?Return.calculate
?CAPM.utils
?chart.RollingRegression

In the future, please follow the posting guide[1] and esr[2] and *try*
first.  Search on rseek.org, which would likely have found all the
functions described above.  Try some things.  *Then* post on r-help or
here (depending on whether your question is general to R or specific to
finance, respectively) showing what you've already tried, and being
specific about where you are having difficulty.

Regards,

    - Brian

Ref:
[1] http://www.r-project.org/posting-guide.html
[2] http://catb.org/esr/faqs/smart-questions.html

--
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock




-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jctoll at gmail.com  Fri Feb 10 00:06:38 2012
From: jctoll at gmail.com (J Toll)
Date: Thu, 9 Feb 2012 17:06:38 -0600
Subject: [R-SIG-Finance] American option sensitivities
Message-ID: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>

Hi,

I'd like to calculate sensitivities on American options.  I was hoping
somebody might be able to summarize of the current state of that
functionality within the various R packages.  It's my understanding
that the fOptions package can calculate greeks for European options
but not American.  RQuantLib appears to have had the ability to
calculate greeks for American options at one point, but it appears
that functionality was removed in Release 0.1.8 sometime around
2003-11-28.

http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html

Additionally, from RQuantLib ?AmericanOptions says,

"Note that under the new pricing framework used in QuantLib, binary
pricers do not provide analytics for 'Greeks'. This is expected to be
addressed in future releases of QuantLib."

I haven't found any other packages for calculating option
sensitivities.  Are there any other packages?

Regarding RQuantLib, is the issue that that functionality hasn't been
implemented in R yet, or is it QuantLib that's broken?

Thanks for any clarification.

Best,


James


From edd at debian.org  Fri Feb 10 00:17:05 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 9 Feb 2012 17:17:05 -0600
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
Message-ID: <20276.21489.182245.149592@max.nulle.part>


On 9 February 2012 at 17:06, J Toll wrote:
| Hi,
| 
| I'd like to calculate sensitivities on American options.  I was hoping
| somebody might be able to summarize of the current state of that
| functionality within the various R packages.  It's my understanding
| that the fOptions package can calculate greeks for European options
| but not American.  RQuantLib appears to have had the ability to
| calculate greeks for American options at one point, but it appears
| that functionality was removed in Release 0.1.8 sometime around
| 2003-11-28.

... because that functionality was removed upstream by QuantLib.

| 
| http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
| 
| Additionally, from RQuantLib ?AmericanOptions says,
| 
| "Note that under the new pricing framework used in QuantLib, binary
| pricers do not provide analytics for 'Greeks'. This is expected to be
| addressed in future releases of QuantLib."
| 
| I haven't found any other packages for calculating option
| sensitivities.  Are there any other packages?
| 
| Regarding RQuantLib, is the issue that that functionality hasn't been
| implemented in R yet, or is it QuantLib that's broken?

There is a third door behind which you find the price: "numerical shocks".

Evaluate your american option, then shift the various parameters (spot, vol,
int.rate, time to mat, ...) each by a small amount and calculate the change
in option price -- voila for the approximate change in option value for
change input.  You can also compute twice at  'x - eps' and 'x + eps' etc.

Dirk

| 
| Thanks for any clarification.
| 
| Best,
| 
| 
| James
| 
| _______________________________________________
| R-SIG-Finance at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From harrisonmark1 at gmail.com  Fri Feb 10 00:19:54 2012
From: harrisonmark1 at gmail.com (Mark Harrison)
Date: Thu, 9 Feb 2012 17:19:54 -0600
Subject: [R-SIG-Finance] BuildIBContract odd behavior
Message-ID: <CAHFhaq9xJgd=qQ6WfjE_4f6Xi-be6Z-a7Ge3KVE15bpzwzCOBg@mail.gmail.com>

I am using Interactive Brokers and R to download and maintain forex
data in addition to doing some analytics on each currency pair.  I
have setup Financial Instrument per Garrett's instructions and have
edited my rProfile site file to define all the available currencies
and exchange rate pairs.

Each day I run a script that connects to TWS using iBrokers and loop
through all the currency pairs defining a contract for each using
twsInstrument.  The script then requests data from IB and saves the
data into each currency pairs folder in my home directory.

The issue I am having is that for the Norwegian Krone I get a message
when I grab data for GBPNOK - the first Norwegian currency in my
symbol list - which is "Checking to see if other 'type's have a
pre-defined currency."  I am getting data for this pair as well as all
the other NOK currency pairs.

When my script completes I get the warning: "In
buildIBcontract(symbol) : Creating currency  NOK"

I have looked through my rProfile and script and can find no reason
why I should get this message and warning since I have both defined
the currency "NOK" and exchange rates using NOK - i.e. GBPNOK, EURNOK,
NOKSEK, etc..  I also get data for each 'NOK' pair so everything seems
like it is working.

I realize I am only getting a warning and I am still able to get the
data I am after but this is bugging me because I cannot figure it out
and it is making me think I have a bigger problem.

Any help would be appreciated.  By the way, I have been digging
through the support lists but finding no answer.

# Session Info
R version 2.14.0 (2011-10-31)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] datasets  grDevices utils     graphics  stats     methods   base

other attached packages:
 [1] fTrading_2100.76           fBasics_2110.79            MASS_7.3-16
 [4] timeSeries_2130.92         timeDate_2131.00
twsInstrument_1.2-9
 [7] IBrokers_0.9-3             qmao_1.1.6
FinancialInstrument_0.9.20
[10] quantmod_0.3-17            TTR_0.21-0                 xts_0.8-2
[13] zoo_1.7-6                  Defaults_1.1-1

loaded via a namespace (and not attached):
[1] blotter_0.8.4    grid_2.14.0      lattice_0.20-0
quantstrat_0.6.1 tools_2.14.0


#  rProfile
# Packages to load at startup
require(quantmod)
require(qmao)
require(IBrokers)
require(FinancialInstrument)
require(twsInstrument)
require(fTrading)

#Define Currencies
currency(c("AUD", "CAD", "CHF", "CZK", "DKK", "EUR", "GBP", "HKD",
"HUF", "ILS", "JPY", "KRW", "MXN", "NOK", "NZD", "PLN", "RUB", "SEK",
"SGD", "USD"))

#Define British Pound Based Exchange Rates
exchange_rate(c("GBPAUD", "GBPCAD", "GBPCHF", "GBPHKD", "GBPJPY",
"GBPNOK", "GBPNZD", "GBPUSD"))

--------------------------------------------------------


# Script code examples
symbols <- c("GBPJPY", "GBPMXN", "GBPNOK", "GBPNZD", "GBPUSD")

for(symbol in symbols){
# Build Contract
contract <- buildIBcontract(symbol)

# at this point I request data and save the files...I can provide the
code if needed.


From gsee000 at gmail.com  Fri Feb 10 00:39:40 2012
From: gsee000 at gmail.com (G See)
Date: Thu, 9 Feb 2012 17:39:40 -0600
Subject: [R-SIG-Finance] BuildIBContract odd behavior
In-Reply-To: <CAHFhaq9xJgd=qQ6WfjE_4f6Xi-be6Z-a7Ge3KVE15bpzwzCOBg@mail.gmail.com>
References: <CAHFhaq9xJgd=qQ6WfjE_4f6Xi-be6Z-a7Ge3KVE15bpzwzCOBg@mail.gmail.com>
Message-ID: <CA+xi=qYgRZzEoHP0LyXZACAGcEs3+UraLjOaavrhnHqvvpykXA@mail.gmail.com>

Mark,

Please update FinancialInstrument and twsInstrument.

I cannot reproduce your warning with the current code.  Usually you
get that warning if you request a stock and the first one that is
found is denominated in a currency that is not defined.
And, you shouldn't get the warning that NOK was defined for you unless
it was not defined.

In version 0.10 of FinancialInstrument I moved the .instrument
environment from .GlobalEnv to FinancialInstrument:::.instrument.  It
sounds like buildIBcontract is looking in the wrong place for the
currency.

If this is still repeatable after you update, let me know.

HTH,
Garrett

On Thu, Feb 9, 2012 at 5:19 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
> I am using Interactive Brokers and R to download and maintain forex
> data in addition to doing some analytics on each currency pair. ?I
> have setup Financial Instrument per Garrett's instructions and have
> edited my rProfile site file to define all the available currencies
> and exchange rate pairs.
>
> Each day I run a script that connects to TWS using iBrokers and loop
> through all the currency pairs defining a contract for each using
> twsInstrument. ?The script then requests data from IB and saves the
> data into each currency pairs folder in my home directory.
>
> The issue I am having is that for the Norwegian Krone I get a message
> when I grab data for GBPNOK - the first Norwegian currency in my
> symbol list - which is "Checking to see if other 'type's have a
> pre-defined currency." ?I am getting data for this pair as well as all
> the other NOK currency pairs.
>
> When my script completes I get the warning: "In
> buildIBcontract(symbol) : Creating currency ?NOK"
>
> I have looked through my rProfile and script and can find no reason
> why I should get this message and warning since I have both defined
> the currency "NOK" and exchange rates using NOK - i.e. GBPNOK, EURNOK,
> NOKSEK, etc.. ?I also get data for each 'NOK' pair so everything seems
> like it is working.
>
> I realize I am only getting a warning and I am still able to get the
> data I am after but this is bugging me because I cannot figure it out
> and it is making me think I have a bigger problem.
>
> Any help would be appreciated. ?By the way, I have been digging
> through the support lists but finding no answer.
>
> # Session Info
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] datasets ?grDevices utils ? ? graphics ?stats ? ? methods ? base
>
> other attached packages:
> ?[1] fTrading_2100.76 ? ? ? ? ? fBasics_2110.79 ? ? ? ? ? ?MASS_7.3-16
> ?[4] timeSeries_2130.92 ? ? ? ? timeDate_2131.00
> twsInstrument_1.2-9
> ?[7] IBrokers_0.9-3 ? ? ? ? ? ? qmao_1.1.6
> FinancialInstrument_0.9.20
> [10] quantmod_0.3-17 ? ? ? ? ? ?TTR_0.21-0 ? ? ? ? ? ? ? ? xts_0.8-2
> [13] zoo_1.7-6 ? ? ? ? ? ? ? ? ?Defaults_1.1-1
>
> loaded via a namespace (and not attached):
> [1] blotter_0.8.4 ? ?grid_2.14.0 ? ? ?lattice_0.20-0
> quantstrat_0.6.1 tools_2.14.0
>
>
> # ?rProfile
> # Packages to load at startup
> require(quantmod)
> require(qmao)
> require(IBrokers)
> require(FinancialInstrument)
> require(twsInstrument)
> require(fTrading)
>
> #Define Currencies
> currency(c("AUD", "CAD", "CHF", "CZK", "DKK", "EUR", "GBP", "HKD",
> "HUF", "ILS", "JPY", "KRW", "MXN", "NOK", "NZD", "PLN", "RUB", "SEK",
> "SGD", "USD"))
>
> #Define British Pound Based Exchange Rates
> exchange_rate(c("GBPAUD", "GBPCAD", "GBPCHF", "GBPHKD", "GBPJPY",
> "GBPNOK", "GBPNZD", "GBPUSD"))
>
> --------------------------------------------------------
>
>
> # Script code examples
> symbols <- c("GBPJPY", "GBPMXN", "GBPNOK", "GBPNZD", "GBPUSD")
>
> for(symbol in symbols){
> # Build Contract
> contract <- buildIBcontract(symbol)
>
> # at this point I request data and save the files...I can provide the
> code if needed.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From Thomas.Schwiertz at gutmark.net  Fri Feb 10 00:40:37 2012
From: Thomas.Schwiertz at gutmark.net (Thomas Schwiertz)
Date: Thu, 9 Feb 2012 23:40:37 +0000
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
Message-ID: <526900C3-3B3C-4608-893E-37F8C86B34D8@gutmark.net>

Hi James,
binary pricers means you go up or down in a tree. This is kind of Monte-Carlo Method. In an european option framework you can use black- scholes i. e. you can really calculate (analytics) sensitivities. Of course you can define a sensitivity, which result is the answer to "what amount does my option move if the the underlying changes e.g. 1%?" BTW usual definitions for interest rates or traders... You should define your underlying, Definition of your sensitivity... Does that help?
R,
Thomas

Von meinem iPhone gesendet

Am 10.02.2012 um 00:08 schrieb "J Toll" <jctoll at gmail.com>:

> Hi,
> 
> I'd like to calculate sensitivities on American options.  I was hoping
> somebody might be able to summarize of the current state of that
> functionality within the various R packages.  It's my understanding
> that the fOptions package can calculate greeks for European options
> but not American.  RQuantLib appears to have had the ability to
> calculate greeks for American options at one point, but it appears
> that functionality was removed in Release 0.1.8 sometime around
> 2003-11-28.
> 
> http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
> 
> Additionally, from RQuantLib ?AmericanOptions says,
> 
> "Note that under the new pricing framework used in QuantLib, binary
> pricers do not provide analytics for 'Greeks'. This is expected to be
> addressed in future releases of QuantLib."
> 
> I haven't found any other packages for calculating option
> sensitivities.  Are there any other packages?
> 
> Regarding RQuantLib, is the issue that that functionality hasn't been
> implemented in R yet, or is it QuantLib that's broken?
> 
> Thanks for any clarification.
> 
> Best,
> 
> 
> James
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jctoll at gmail.com  Fri Feb 10 01:02:01 2012
From: jctoll at gmail.com (J Toll)
Date: Thu, 9 Feb 2012 18:02:01 -0600
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <20276.21489.182245.149592@max.nulle.part>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
	<20276.21489.182245.149592@max.nulle.part>
Message-ID: <CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>

On Thu, Feb 9, 2012 at 5:17 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 9 February 2012 at 17:06, J Toll wrote:
> | Hi,
> |
> | I'd like to calculate sensitivities on American options. ?I was hoping
> | somebody might be able to summarize of the current state of that
> | functionality within the various R packages. ?It's my understanding
> | that the fOptions package can calculate greeks for European options
> | but not American. ?RQuantLib appears to have had the ability to
> | calculate greeks for American options at one point, but it appears
> | that functionality was removed in Release 0.1.8 sometime around
> | 2003-11-28.
>
> ... because that functionality was removed upstream by QuantLib.
>
> |
> | http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
> |
> | Additionally, from RQuantLib ?AmericanOptions says,
> |
> | "Note that under the new pricing framework used in QuantLib, binary
> | pricers do not provide analytics for 'Greeks'. This is expected to be
> | addressed in future releases of QuantLib."
> |
> | I haven't found any other packages for calculating option
> | sensitivities. ?Are there any other packages?
> |
> | Regarding RQuantLib, is the issue that that functionality hasn't been
> | implemented in R yet, or is it QuantLib that's broken?
>
> There is a third door behind which you find the price: "numerical shocks".
>
> Evaluate your american option, then shift the various parameters (spot, vol,
> int.rate, time to mat, ...) each by a small amount and calculate the change
> in option price -- voila for the approximate change in option value for
> change input. ?You can also compute twice at ?'x - eps' and 'x + eps' etc.
>
> Dirk

Dirk,

Thank you for your response.  I was hoping you might reply.

I understand the concept of your suggestion, although I don't have any
practical experience implementing it.  I'm guessing this is what's
generally referred to as finite difference methods.  In theory, the
first order greeks should be simple enough, although my impression is
the second or third order greeks may be a bit more challenging.

I hate to trouble you for more information, but I'm curious why?  Is
this the "standard" method of calculating greeks for American options?
 Has QuantLib decided not to implement this calculation? Just curious.

Thanks again,


James



>
> |
> | Thanks for any clarification.
> |
> | Best,
> |
> |
> | James
> |
> | _______________________________________________
> | R-SIG-Finance at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> | -- Subscriber-posting only. If you want to post, subscribe first.
> | -- Also note that this is not the r-help list where general R questions should go.
>
> --
> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
> dark to read." -- Groucho Marx


From edd at debian.org  Fri Feb 10 02:17:46 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 9 Feb 2012 19:17:46 -0600
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
	<20276.21489.182245.149592@max.nulle.part>
	<CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
Message-ID: <20276.28730.663668.732463@max.nulle.part>


Hi James,

On 9 February 2012 at 18:02, J Toll wrote:
| I understand the concept of your suggestion, although I don't have any
| practical experience implementing it.  I'm guessing this is what's
| generally referred to as finite difference methods.  In theory, the

More like "Numerical Differentiation".

| first order greeks should be simple enough, although my impression is
| the second or third order greeks may be a bit more challenging.
| 
| I hate to trouble you for more information, but I'm curious why?  Is
| this the "standard" method of calculating greeks for American options?
|  Has QuantLib decided not to implement this calculation? Just curious.

You'd have to ask on quantlib-devel.  My memory is a little foggy but I think
that question had in fact been asked on the list. If memory serves, Luigi
essentially said that it was always 'just an approximation' and it is better
to let the user control it.  If you read up on numerical differentiation you
will learn about shifting just one side, or shifting on both (as I mentioned
in my earlier reply), by how much to shift etc pp.  

Just write up a nice R-level function and contribute it back to RQuantLib :)

Dirk
 

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From comtech.usa at gmail.com  Fri Feb 10 03:56:32 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 9 Feb 2012 20:56:32 -0600
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
Message-ID: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120209/f50662a0/attachment.pl>

From michael.weylandt at gmail.com  Fri Feb 10 04:00:58 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 9 Feb 2012 22:00:58 -0500
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
Message-ID: <CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>

It looks like you need to wrap coredata() because some funny
arithmetic is happening when the xts-ness is preserved.

e.g.

findPeaks(coredata(Ad(SPY)), 5)

But this is perhaps a less-than-desirable feature. I'll patch it and
send it to Josh.

Michael

On Thu, Feb 9, 2012 at 9:56 PM, Michael <comtech.usa at gmail.com> wrote:
> ?Hi all,
>
> I am having trouble using the function "findPeaks":
>
> tickers="SPY"
>
> data *<-* new.env()
>
> getSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data,
> auto.assign = T)
>
> p=findPeaks(data$SPY[, 6], 5)
>
> plot(data$SPY[, 6], type="l")
>
> points(p, data$SPY[, 6][p])
>
> My goal is to implement a trailing-stop on a buy-and-hold strategy using
> findPeaks...
>
> I wanted to detect whenever SPY falls 5 points from the local peak...
>
> The above example failed in finding the peaks (p == NULL).
>
> Am I missing anything here?
>
> Thanks a lot!
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jeffrey.ryan at lemnica.com  Fri Feb 10 04:40:15 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 9 Feb 2012 21:40:15 -0600
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
	<CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
Message-ID: <CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>

On Thu, Feb 9, 2012 at 9:00 PM, R. Michael Weylandt
<michael.weylandt at gmail.com> wrote:
> It looks like you need to wrap coredata() because some funny
> arithmetic is happening when the xts-ness is preserved.
>
> e.g.
>
> findPeaks(coredata(Ad(SPY)), 5)
>
> But this is perhaps a less-than-desirable feature. I'll patch it and
> send it to Josh.

Proper procedure is indeed to blame Josh for all undesirable
functionality, even in code he didn't write ;-)

Patched in R-forge rev 577. Thanks.

Jeff
>
> Michael
>
> On Thu, Feb 9, 2012 at 9:56 PM, Michael <comtech.usa at gmail.com> wrote:
>> ?Hi all,
>>
>> I am having trouble using the function "findPeaks":
>>
>> tickers="SPY"
>>
>> data *<-* new.env()
>>
>> getSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data,
>> auto.assign = T)
>>
>> p=findPeaks(data$SPY[, 6], 5)
>>
>> plot(data$SPY[, 6], type="l")
>>
>> points(p, data$SPY[, 6][p])
>>
>> My goal is to implement a trailing-stop on a buy-and-hold strategy using
>> findPeaks...
>>
>> I wanted to detect whenever SPY falls 5 points from the local peak...
>>
>> The above example failed in finding the peaks (p == NULL).
>>
>> Am I missing anything here?
>>
>> Thanks a lot!
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From michael.weylandt at gmail.com  Fri Feb 10 04:55:38 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 9 Feb 2012 22:55:38 -0500
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
	<CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
	<CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>
Message-ID: <CAAmySGNCig-FRYWqgvATc+GFZELOEkR8QASPEs87FM07XmQ=rg@mail.gmail.com>

Happy to follow procedure.

Thanks for jumping on it so quickly.

Michael Weylandt

On Thu, Feb 9, 2012 at 10:40 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
> On Thu, Feb 9, 2012 at 9:00 PM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>> It looks like you need to wrap coredata() because some funny
>> arithmetic is happening when the xts-ness is preserved.
>>
>> e.g.
>>
>> findPeaks(coredata(Ad(SPY)), 5)
>>
>> But this is perhaps a less-than-desirable feature. I'll patch it and
>> send it to Josh.
>
> Proper procedure is indeed to blame Josh for all undesirable
> functionality, even in code he didn't write ;-)
>
> Patched in R-forge rev 577. Thanks.
>
> Jeff
>>
>> Michael
>>
>> On Thu, Feb 9, 2012 at 9:56 PM, Michael <comtech.usa at gmail.com> wrote:
>>> ?Hi all,
>>>
>>> I am having trouble using the function "findPeaks":
>>>
>>> tickers="SPY"
>>>
>>> data *<-* new.env()
>>>
>>> getSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data,
>>> auto.assign = T)
>>>
>>> p=findPeaks(data$SPY[, 6], 5)
>>>
>>> plot(data$SPY[, 6], type="l")
>>>
>>> points(p, data$SPY[, 6][p])
>>>
>>> My goal is to implement a trailing-stop on a buy-and-hold strategy using
>>> findPeaks...
>>>
>>> I wanted to detect whenever SPY falls 5 points from the local peak...
>>>
>>> The above example failed in finding the peaks (p == NULL).
>>>
>>> Am I missing anything here?
>>>
>>> Thanks a lot!
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
> www.esotericR.com
>
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
>
> See you in Chicago!!!!


From enricoschumann at yahoo.de  Fri Feb 10 10:18:08 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Fri, 10 Feb 2012 10:18:08 +0100
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
	<20276.21489.182245.149592@max.nulle.part>
	<CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
Message-ID: <4F34E0D0.3000307@yahoo.de>


Hi all,

(comments below)

Am 10.02.2012 01:02, schrieb J Toll:
> On Thu, Feb 9, 2012 at 5:17 PM, Dirk Eddelbuettel<edd at debian.org>  wrote:
>>
>> On 9 February 2012 at 17:06, J Toll wrote:
>> | Hi,
>> |
>> | I'd like to calculate sensitivities on American options.  I was hoping
>> | somebody might be able to summarize of the current state of that
>> | functionality within the various R packages.  It's my understanding
>> | that the fOptions package can calculate greeks for European options
>> | but not American.  RQuantLib appears to have had the ability to
>> | calculate greeks for American options at one point, but it appears
>> | that functionality was removed in Release 0.1.8 sometime around
>> | 2003-11-28.
>>
>> ... because that functionality was removed upstream by QuantLib.
>>
>> |
>> | http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
>> |
>> | Additionally, from RQuantLib ?AmericanOptions says,
>> |
>> | "Note that under the new pricing framework used in QuantLib, binary
>> | pricers do not provide analytics for 'Greeks'. This is expected to be
>> | addressed in future releases of QuantLib."
>> |
>> | I haven't found any other packages for calculating option
>> | sensitivities.  Are there any other packages?
>> |
>> | Regarding RQuantLib, is the issue that that functionality hasn't been
>> | implemented in R yet, or is it QuantLib that's broken?
>>
>> There is a third door behind which you find the price: "numerical shocks".
>>
>> Evaluate your american option, then shift the various parameters (spot, vol,
>> int.rate, time to mat, ...) each by a small amount and calculate the change
>> in option price -- voila for the approximate change in option value for
>> change input.  You can also compute twice at  'x - eps' and 'x + eps' etc.
>>
>> Dirk
>
> Dirk,
>
> Thank you for your response.  I was hoping you might reply.
>
> I understand the concept of your suggestion, although I don't have any
> practical experience implementing it.  I'm guessing this is what's
> generally referred to as finite difference methods.  In theory, the
> first order greeks should be simple enough, although my impression is
> the second or third order greeks may be a bit more challenging.
>
> I hate to trouble you for more information, but I'm curious why?  Is
> this the "standard" method of calculating greeks for American options?
>   Has QuantLib decided not to implement this calculation? Just curious.
>
> Thanks again,
>

A simple forward difference is

[f(x + h) - f(x)] / h

'f' is the option pricing formula; 'x' are the arguments to the formula, 
and 'h' is a small offset.

Numerically, 'h' should not be made too small:

(1) Even for smooth functions, we trade off truncation error (which is 
large when 'h' is large) against roundoff-error (in the extreme, 'x + h' 
may still be 'x' for a very small 'h').

(2) American options are typically valued via finite-difference or tree 
methods, and hence 'f' is not smooth and any 'bumps' in the function 
will be magnified by dividing by a very small 'h'. So when 'h' is too 
small, the results will become nonsensical.

Here is an example. As a first test, I use a European option.

require("RQuantLib")
h <- 1e-4
S <- 100
K <- 100
tau <- 0.5
vol <- 0.3
C0 <- EuropeanOption(type = "call",
                      underlying = S, strike = K,
                      dividendYield = 0.0,
                      riskFreeRate = 0.03, maturity = tau,
                      volatility = 0.3)
Cplus <- EuropeanOption(type="call",
                         underlying = S + h, strike = K,
                         dividendYield = 0.0,
                         riskFreeRate=0.03, maturity=tau,
                         volatility=0.3)
Cminus <- EuropeanOption(type="call",
                          underlying = S - h, strike=K,
                          dividendYield=0.0,
                          riskFreeRate=0.03, maturity=tau,
                          volatility=0.3)

## a first-order difference: delta
(Cplus$value-C0$value)/h
## [1] 0.570159
C0$delta
## [1] 0.5701581


## a second-order difference
(Cplus$delta-C0$delta)/h
## [1] 0.01851474
C0$gamma
## [1] 0.01851475




Now for an American option. Here we don't have the delta, so we first 
need to compute it as well.

C0 <- AmericanOption(type="put",
                      underlying = S, strike=K,
                      dividendYield=0.0,
                      riskFreeRate=0.03, maturity=tau,
                      volatility=vol)
Cplus <- AmericanOption(type="put",
                         underlying = S + h, strike=K,
                         dividendYield=0.0,
                         riskFreeRate=0.03, maturity=tau,
                         volatility=vol)
Cminus <- AmericanOption(type="put",
                          underlying = S - h, strike=K,
                          dividendYield=0.0,
                          riskFreeRate=0.03, maturity=tau,
                          volatility=vol)

## a first-order difference: delta
(dplus <- (Cplus$value - C0$value)/h)
(dminus <-(C0$value - Cminus$value)/h)

## a second-order difference
(dplus - dminus)/h
## [1] 0.01905605

I ran a little a experiment with different levels of 'h', where you can 
clearly see when the gamma diverges.

|    h |      gamma |
|    1 | 0.01905385 |
| 0.01 | 0.01905612 |
| 1e-4 | 0.01905605 |
| 1e-5 | 0.01915801 |
| 1e-6 | 0.03463896 |
| 1e-8 |   8.881784 |


In the literatur, you find a number of tricks to smooth the function, 
but in my experience, you are fine if you make 'h' small with respect to 
'x' -- small, not tiny. So if the stock price is 100, a change of 1 or 
0.1 is small. (And think of it: even if we found that a change of 
one-thousandth of a cent led to a meaningful numerical difference; if 
the stock price never moves by such an amount, such a computation would 
not be empirically meaningful.)


Regards,
Enrico


>
> James
>
>
>
>>
>> |
>> | Thanks for any clarification.
>> |
>> | Best,
>> |
>> |
>> | James
>> |
>> | _______________________________________________
>> | R-SIG-Finance at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> | -- Subscriber-posting only. If you want to post, subscribe first.
>> | -- Also note that this is not the r-help list where general R questions should go.
>>
>> --
>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
>> dark to read." -- Groucho Marx
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


From jctoll at gmail.com  Fri Feb 10 15:24:51 2012
From: jctoll at gmail.com (J Toll)
Date: Fri, 10 Feb 2012 08:24:51 -0600
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <4F34E0D0.3000307@yahoo.de>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
	<20276.21489.182245.149592@max.nulle.part>
	<CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
	<4F34E0D0.3000307@yahoo.de>
Message-ID: <CA+nJqYMQqicT-dqOU=X=2QxbkjzFvGAyGeKv5n6+Ud7Qk13h2g@mail.gmail.com>

On Fri, Feb 10, 2012 at 3:18 AM, Enrico Schumann
<enricoschumann at yahoo.de> wrote:
>
> Hi all,
>
> (comments below)
>
> Am 10.02.2012 01:02, schrieb J Toll:
>
>> On Thu, Feb 9, 2012 at 5:17 PM, Dirk Eddelbuettel<edd at debian.org> ?wrote:
>>>
>>>
>>> On 9 February 2012 at 17:06, J Toll wrote:
>>> | Hi,
>>> |
>>> | I'd like to calculate sensitivities on American options. ?I was hoping
>>> | somebody might be able to summarize of the current state of that
>>> | functionality within the various R packages. ?It's my understanding
>>> | that the fOptions package can calculate greeks for European options
>>> | but not American. ?RQuantLib appears to have had the ability to
>>> | calculate greeks for American options at one point, but it appears
>>> | that functionality was removed in Release 0.1.8 sometime around
>>> | 2003-11-28.
>>>
>>> ... because that functionality was removed upstream by QuantLib.
>>>
>>> |
>>> |
>>> http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
>>> |
>>> | Additionally, from RQuantLib ?AmericanOptions says,
>>> |
>>> | "Note that under the new pricing framework used in QuantLib, binary
>>> | pricers do not provide analytics for 'Greeks'. This is expected to be
>>> | addressed in future releases of QuantLib."
>>> |
>>> | I haven't found any other packages for calculating option
>>> | sensitivities. ?Are there any other packages?
>>> |
>>> | Regarding RQuantLib, is the issue that that functionality hasn't been
>>> | implemented in R yet, or is it QuantLib that's broken?
>>>
>>> There is a third door behind which you find the price: "numerical
>>> shocks".
>>>
>>> Evaluate your american option, then shift the various parameters (spot,
>>> vol,
>>> int.rate, time to mat, ...) each by a small amount and calculate the
>>> change
>>> in option price -- voila for the approximate change in option value for
>>> change input. ?You can also compute twice at ?'x - eps' and 'x + eps'
>>> etc.
>>>
>>> Dirk
>>
>>
>> Dirk,
>>
>> Thank you for your response. ?I was hoping you might reply.
>>
>> I understand the concept of your suggestion, although I don't have any
>> practical experience implementing it. ?I'm guessing this is what's
>> generally referred to as finite difference methods. ?In theory, the
>> first order greeks should be simple enough, although my impression is
>> the second or third order greeks may be a bit more challenging.
>>
>> I hate to trouble you for more information, but I'm curious why? ?Is
>> this the "standard" method of calculating greeks for American options?
>> ?Has QuantLib decided not to implement this calculation? Just curious.
>>
>> Thanks again,
>>
>
> A simple forward difference is
>
> [f(x + h) - f(x)] / h
>
> 'f' is the option pricing formula; 'x' are the arguments to the formula, and
> 'h' is a small offset.
>
> Numerically, 'h' should not be made too small:
>
> (1) Even for smooth functions, we trade off truncation error (which is large
> when 'h' is large) against roundoff-error (in the extreme, 'x + h' may still
> be 'x' for a very small 'h').
>
> (2) American options are typically valued via finite-difference or tree
> methods, and hence 'f' is not smooth and any 'bumps' in the function will be
> magnified by dividing by a very small 'h'. So when 'h' is too small, the
> results will become nonsensical.
>
> Here is an example. As a first test, I use a European option.
>
> require("RQuantLib")
> h <- 1e-4
> S <- 100
> K <- 100
> tau <- 0.5
> vol <- 0.3
> C0 <- EuropeanOption(type = "call",
> ? ? ? ? ? ? ? ? ? ? underlying = S, strike = K,
> ? ? ? ? ? ? ? ? ? ? dividendYield = 0.0,
> ? ? ? ? ? ? ? ? ? ? riskFreeRate = 0.03, maturity = tau,
> ? ? ? ? ? ? ? ? ? ? volatility = 0.3)
> Cplus <- EuropeanOption(type="call",
> ? ? ? ? ? ? ? ? ? ? ? ?underlying = S + h, strike = K,
> ? ? ? ? ? ? ? ? ? ? ? ?dividendYield = 0.0,
> ? ? ? ? ? ? ? ? ? ? ? ?riskFreeRate=0.03, maturity=tau,
> ? ? ? ? ? ? ? ? ? ? ? ?volatility=0.3)
> Cminus <- EuropeanOption(type="call",
> ? ? ? ? ? ? ? ? ? ? ? ? underlying = S - h, strike=K,
> ? ? ? ? ? ? ? ? ? ? ? ? dividendYield=0.0,
> ? ? ? ? ? ? ? ? ? ? ? ? riskFreeRate=0.03, maturity=tau,
> ? ? ? ? ? ? ? ? ? ? ? ? volatility=0.3)
>
> ## a first-order difference: delta
> (Cplus$value-C0$value)/h
> ## [1] 0.570159
> C0$delta
> ## [1] 0.5701581
>
>
> ## a second-order difference
> (Cplus$delta-C0$delta)/h
> ## [1] 0.01851474
> C0$gamma
> ## [1] 0.01851475
>
>
>
>
> Now for an American option. Here we don't have the delta, so we first need
> to compute it as well.
>
> C0 <- AmericanOption(type="put",
> ? ? ? ? ? ? ? ? ? ? underlying = S, strike=K,
> ? ? ? ? ? ? ? ? ? ? dividendYield=0.0,
> ? ? ? ? ? ? ? ? ? ? riskFreeRate=0.03, maturity=tau,
> ? ? ? ? ? ? ? ? ? ? volatility=vol)
> Cplus <- AmericanOption(type="put",
> ? ? ? ? ? ? ? ? ? ? ? ?underlying = S + h, strike=K,
> ? ? ? ? ? ? ? ? ? ? ? ?dividendYield=0.0,
> ? ? ? ? ? ? ? ? ? ? ? ?riskFreeRate=0.03, maturity=tau,
> ? ? ? ? ? ? ? ? ? ? ? ?volatility=vol)
> Cminus <- AmericanOption(type="put",
> ? ? ? ? ? ? ? ? ? ? ? ? underlying = S - h, strike=K,
> ? ? ? ? ? ? ? ? ? ? ? ? dividendYield=0.0,
> ? ? ? ? ? ? ? ? ? ? ? ? riskFreeRate=0.03, maturity=tau,
> ? ? ? ? ? ? ? ? ? ? ? ? volatility=vol)
>
> ## a first-order difference: delta
> (dplus <- (Cplus$value - C0$value)/h)
> (dminus <-(C0$value - Cminus$value)/h)
>
> ## a second-order difference
> (dplus - dminus)/h
> ## [1] 0.01905605
>
> I ran a little a experiment with different levels of 'h', where you can
> clearly see when the gamma diverges.
>
> | ? ?h | ? ? ?gamma |
> | ? ?1 | 0.01905385 |
> | 0.01 | 0.01905612 |
> | 1e-4 | 0.01905605 |
> | 1e-5 | 0.01915801 |
> | 1e-6 | 0.03463896 |
> | 1e-8 | ? 8.881784 |
>
>
> In the literatur, you find a number of tricks to smooth the function, but in
> my experience, you are fine if you make 'h' small with respect to 'x' --
> small, not tiny. So if the stock price is 100, a change of 1 or 0.1 is
> small. (And think of it: even if we found that a change of one-thousandth of
> a cent led to a meaningful numerical difference; if the stock price never
> moves by such an amount, such a computation would not be empirically
> meaningful.)
>
>
> Regards,
> Enrico
>

Enrico,

Thank you so much for such a detailed and helpful example.  I had
found an article on Wikipedia mentioning many of the issues you write
about regarding selection of h.  In that article, the author/s
suggest:

"A choice for h which is small without producing a large rounding
error is sqrt(?  x) where the machine epsilon ? is typically of the
order 2.2?10-16."

http://en.wikipedia.org/wiki/Numerical_differentiation

So for R, I suppose that would equate to:

h <- sqrt(.Machine$double.eps * x)

Thanks again for your really helpful example.

Best,


James



>
>
>>
>> James
>>
>>
>>
>>>
>>> |
>>> | Thanks for any clarification.
>>> |
>>> | Best,
>>> |
>>> |
>>> | James
>>> |
>>> | _______________________________________________
>>> | R-SIG-Finance at r-project.org mailing list
>>> | https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> | -- Subscriber-posting only. If you want to post, subscribe first.
>>> | -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>> --
>>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is
>>> too
>>> dark to read." -- Groucho Marx
>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
>
> --
> Enrico Schumann
> Lucerne, Switzerland
> http://nmof.net/


From drseergio at gmail.com  Fri Feb 10 17:26:52 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Fri, 10 Feb 2012 08:26:52 -0800
Subject: [R-SIG-Finance] Using quantstrat indicators against columns other
	than "Close"
Message-ID: <CAEGu7Fso3aizzsDKVXQ=rP9SFp5wEX3ZxJk-YFgFCO3Yi+4_2Q@mail.gmail.com>

Hi,

I have started using 'quantstrat' to model strategies and cannot
figure out a way to add an indicator that would be calculated against
a column other than "Close". For example, in the code below I create a
5-day SMA:

s ? ? ? ? <- add.indicator(strategy=s, name='SMA',
arguments=list(x=quote(Cl(mktdata)), n=5), label='SMA5')

This creates a column with 5-day SMA calculated for the closing price
of the instrument. What is the correct approach of using indicators
against other columns, such as "Volume"?

Appreciate your help.

--
Kindest Regards,
Sergey Pisarenko.


From pgilbert902 at gmail.com  Fri Feb 10 17:32:32 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 10 Feb 2012 11:32:32 -0500
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <CA+nJqYMQqicT-dqOU=X=2QxbkjzFvGAyGeKv5n6+Ud7Qk13h2g@mail.gmail.com>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
	<20276.21489.182245.149592@max.nulle.part>
	<CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
	<4F34E0D0.3000307@yahoo.de>
	<CA+nJqYMQqicT-dqOU=X=2QxbkjzFvGAyGeKv5n6+Ud7Qk13h2g@mail.gmail.com>
Message-ID: <4F3546A0.1060608@gmail.com>

I may be missing some of the finer points in this discussion, but if you 
are thinking about numerical differentiation and are concerned about 
accuracy, you might want to consider functions grad, hessian, and 
jacobian in package numDeriv. In addition to finite differences, it 
offers Richardson extrapolation, which generally provides a better result.

Paul


On 12-02-10 09:24 AM, J Toll wrote:
> On Fri, Feb 10, 2012 at 3:18 AM, Enrico Schumann
> <enricoschumann at yahoo.de>  wrote:
>>
>> Hi all,
>>
>> (comments below)
>>
>> Am 10.02.2012 01:02, schrieb J Toll:
>>
>>> On Thu, Feb 9, 2012 at 5:17 PM, Dirk Eddelbuettel<edd at debian.org>    wrote:
>>>>
>>>>
>>>> On 9 February 2012 at 17:06, J Toll wrote:
>>>> | Hi,
>>>> |
>>>> | I'd like to calculate sensitivities on American options.  I was hoping
>>>> | somebody might be able to summarize of the current state of that
>>>> | functionality within the various R packages.  It's my understanding
>>>> | that the fOptions package can calculate greeks for European options
>>>> | but not American.  RQuantLib appears to have had the ability to
>>>> | calculate greeks for American options at one point, but it appears
>>>> | that functionality was removed in Release 0.1.8 sometime around
>>>> | 2003-11-28.
>>>>
>>>> ... because that functionality was removed upstream by QuantLib.
>>>>
>>>> |
>>>> |
>>>> http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
>>>> |
>>>> | Additionally, from RQuantLib ?AmericanOptions says,
>>>> |
>>>> | "Note that under the new pricing framework used in QuantLib, binary
>>>> | pricers do not provide analytics for 'Greeks'. This is expected to be
>>>> | addressed in future releases of QuantLib."
>>>> |
>>>> | I haven't found any other packages for calculating option
>>>> | sensitivities.  Are there any other packages?
>>>> |
>>>> | Regarding RQuantLib, is the issue that that functionality hasn't been
>>>> | implemented in R yet, or is it QuantLib that's broken?
>>>>
>>>> There is a third door behind which you find the price: "numerical
>>>> shocks".
>>>>
>>>> Evaluate your american option, then shift the various parameters (spot,
>>>> vol,
>>>> int.rate, time to mat, ...) each by a small amount and calculate the
>>>> change
>>>> in option price -- voila for the approximate change in option value for
>>>> change input.  You can also compute twice at  'x - eps' and 'x + eps'
>>>> etc.
>>>>
>>>> Dirk
>>>
>>>
>>> Dirk,
>>>
>>> Thank you for your response.  I was hoping you might reply.
>>>
>>> I understand the concept of your suggestion, although I don't have any
>>> practical experience implementing it.  I'm guessing this is what's
>>> generally referred to as finite difference methods.  In theory, the
>>> first order greeks should be simple enough, although my impression is
>>> the second or third order greeks may be a bit more challenging.
>>>
>>> I hate to trouble you for more information, but I'm curious why?  Is
>>> this the "standard" method of calculating greeks for American options?
>>>   Has QuantLib decided not to implement this calculation? Just curious.
>>>
>>> Thanks again,
>>>
>>
>> A simple forward difference is
>>
>> [f(x + h) - f(x)] / h
>>
>> 'f' is the option pricing formula; 'x' are the arguments to the formula, and
>> 'h' is a small offset.
>>
>> Numerically, 'h' should not be made too small:
>>
>> (1) Even for smooth functions, we trade off truncation error (which is large
>> when 'h' is large) against roundoff-error (in the extreme, 'x + h' may still
>> be 'x' for a very small 'h').
>>
>> (2) American options are typically valued via finite-difference or tree
>> methods, and hence 'f' is not smooth and any 'bumps' in the function will be
>> magnified by dividing by a very small 'h'. So when 'h' is too small, the
>> results will become nonsensical.
>>
>> Here is an example. As a first test, I use a European option.
>>
>> require("RQuantLib")
>> h<- 1e-4
>> S<- 100
>> K<- 100
>> tau<- 0.5
>> vol<- 0.3
>> C0<- EuropeanOption(type = "call",
>>                      underlying = S, strike = K,
>>                      dividendYield = 0.0,
>>                      riskFreeRate = 0.03, maturity = tau,
>>                      volatility = 0.3)
>> Cplus<- EuropeanOption(type="call",
>>                         underlying = S + h, strike = K,
>>                         dividendYield = 0.0,
>>                         riskFreeRate=0.03, maturity=tau,
>>                         volatility=0.3)
>> Cminus<- EuropeanOption(type="call",
>>                          underlying = S - h, strike=K,
>>                          dividendYield=0.0,
>>                          riskFreeRate=0.03, maturity=tau,
>>                          volatility=0.3)
>>
>> ## a first-order difference: delta
>> (Cplus$value-C0$value)/h
>> ## [1] 0.570159
>> C0$delta
>> ## [1] 0.5701581
>>
>>
>> ## a second-order difference
>> (Cplus$delta-C0$delta)/h
>> ## [1] 0.01851474
>> C0$gamma
>> ## [1] 0.01851475
>>
>>
>>
>>
>> Now for an American option. Here we don't have the delta, so we first need
>> to compute it as well.
>>
>> C0<- AmericanOption(type="put",
>>                      underlying = S, strike=K,
>>                      dividendYield=0.0,
>>                      riskFreeRate=0.03, maturity=tau,
>>                      volatility=vol)
>> Cplus<- AmericanOption(type="put",
>>                         underlying = S + h, strike=K,
>>                         dividendYield=0.0,
>>                         riskFreeRate=0.03, maturity=tau,
>>                         volatility=vol)
>> Cminus<- AmericanOption(type="put",
>>                          underlying = S - h, strike=K,
>>                          dividendYield=0.0,
>>                          riskFreeRate=0.03, maturity=tau,
>>                          volatility=vol)
>>
>> ## a first-order difference: delta
>> (dplus<- (Cplus$value - C0$value)/h)
>> (dminus<-(C0$value - Cminus$value)/h)
>>
>> ## a second-order difference
>> (dplus - dminus)/h
>> ## [1] 0.01905605
>>
>> I ran a little a experiment with different levels of 'h', where you can
>> clearly see when the gamma diverges.
>>
>> |    h |      gamma |
>> |    1 | 0.01905385 |
>> | 0.01 | 0.01905612 |
>> | 1e-4 | 0.01905605 |
>> | 1e-5 | 0.01915801 |
>> | 1e-6 | 0.03463896 |
>> | 1e-8 |   8.881784 |
>>
>>
>> In the literatur, you find a number of tricks to smooth the function, but in
>> my experience, you are fine if you make 'h' small with respect to 'x' --
>> small, not tiny. So if the stock price is 100, a change of 1 or 0.1 is
>> small. (And think of it: even if we found that a change of one-thousandth of
>> a cent led to a meaningful numerical difference; if the stock price never
>> moves by such an amount, such a computation would not be empirically
>> meaningful.)
>>
>>
>> Regards,
>> Enrico
>>
>
> Enrico,
>
> Thank you so much for such a detailed and helpful example.  I had
> found an article on Wikipedia mentioning many of the issues you write
> about regarding selection of h.  In that article, the author/s
> suggest:
>
> "A choice for h which is small without producing a large rounding
> error is sqrt(?  x) where the machine epsilon ? is typically of the
> order 2.2?10-16."
>
> http://en.wikipedia.org/wiki/Numerical_differentiation
>
> So for R, I suppose that would equate to:
>
> h<- sqrt(.Machine$double.eps * x)
>
> Thanks again for your really helpful example.
>
> Best,
>
>
> James
>
>
>
>>
>>
>>>
>>> James
>>>
>>>
>>>
>>>>
>>>> |
>>>> | Thanks for any clarification.
>>>> |
>>>> | Best,
>>>> |
>>>> |
>>>> | James
>>>> |
>>>> | _______________________________________________
>>>> | R-SIG-Finance at r-project.org mailing list
>>>> | https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> | -- Subscriber-posting only. If you want to post, subscribe first.
>>>> | -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>> --
>>>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is
>>>> too
>>>> dark to read." -- Groucho Marx
>>>
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>
>>
>> --
>> Enrico Schumann
>> Lucerne, Switzerland
>> http://nmof.net/
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From brian at braverock.com  Fri Feb 10 17:37:58 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 10 Feb 2012 10:37:58 -0600
Subject: [R-SIG-Finance] Using quantstrat indicators against columns
 other than "Close"
In-Reply-To: <CAEGu7Fso3aizzsDKVXQ=rP9SFp5wEX3ZxJk-YFgFCO3Yi+4_2Q@mail.gmail.com>
References: <CAEGu7Fso3aizzsDKVXQ=rP9SFp5wEX3ZxJk-YFgFCO3Yi+4_2Q@mail.gmail.com>
Message-ID: <1328891878.3743.86.camel@brian-rcg>

On Fri, 2012-02-10 at 08:26 -0800, Sergey Pisarenko wrote:
> Hi,
> 
> I have started using 'quantstrat' to model strategies and cannot
> figure out a way to add an indicator that would be calculated against
> a column other than "Close". For example, in the code below I create a
> 5-day SMA:
> 
> s         <- add.indicator(strategy=s, name='SMA',
> arguments=list(x=quote(Cl(mktdata)), n=5), label='SMA5')
> 
> This creates a column with 5-day SMA calculated for the closing price
> of the instrument. What is the correct approach of using indicators
> against other columns, such as "Volume"?

the Cl() function there should be the clue...

Cl(), Op(), Vo(), etc are all utility functions provided by quantmod to
extract specific columns by common name.  You could also use standard R
subsetting to get any column you want out of your data.

Regards,

   - Brian
 
-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From enricoschumann at yahoo.de  Fri Feb 10 18:05:04 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Fri, 10 Feb 2012 18:05:04 +0100
Subject: [R-SIG-Finance] American option sensitivities
In-Reply-To: <CA+nJqYMQqicT-dqOU=X=2QxbkjzFvGAyGeKv5n6+Ud7Qk13h2g@mail.gmail.com>
References: <CA+nJqYOO_8jaDOKj0CATVDDZ+rwHUK8a_GG=pW8gTyxxDusazQ@mail.gmail.com>
	<20276.21489.182245.149592@max.nulle.part>
	<CA+nJqYPwBt65pHR7+ZWQJU_a8eBweyH5Gk=Oc_sxJ4z1fQoKgA@mail.gmail.com>
	<4F34E0D0.3000307@yahoo.de>
	<CA+nJqYMQqicT-dqOU=X=2QxbkjzFvGAyGeKv5n6+Ud7Qk13h2g@mail.gmail.com>
Message-ID: <4F354E40.7000103@yahoo.de>



Am 10.02.2012 15:24, schrieb J Toll:
> On Fri, Feb 10, 2012 at 3:18 AM, Enrico Schumann
> <enricoschumann at yahoo.de>  wrote:
>>
>> Hi all,
>>
>> (comments below)
>>
>> Am 10.02.2012 01:02, schrieb J Toll:
>>
>>> On Thu, Feb 9, 2012 at 5:17 PM, Dirk Eddelbuettel<edd at debian.org>    wrote:
>>>>
>>>>
>>>> On 9 February 2012 at 17:06, J Toll wrote:
>>>> | Hi,
>>>> |
>>>> | I'd like to calculate sensitivities on American options.  I was hoping
>>>> | somebody might be able to summarize of the current state of that
>>>> | functionality within the various R packages.  It's my understanding
>>>> | that the fOptions package can calculate greeks for European options
>>>> | but not American.  RQuantLib appears to have had the ability to
>>>> | calculate greeks for American options at one point, but it appears
>>>> | that functionality was removed in Release 0.1.8 sometime around
>>>> | 2003-11-28.
>>>>
>>>> ... because that functionality was removed upstream by QuantLib.
>>>>
>>>> |
>>>> |
>>>> http://lists.r-forge.r-project.org/pipermail/rquantlib-commits/2010-August/000117.html
>>>> |
>>>> | Additionally, from RQuantLib ?AmericanOptions says,
>>>> |
>>>> | "Note that under the new pricing framework used in QuantLib, binary
>>>> | pricers do not provide analytics for 'Greeks'. This is expected to be
>>>> | addressed in future releases of QuantLib."
>>>> |
>>>> | I haven't found any other packages for calculating option
>>>> | sensitivities.  Are there any other packages?
>>>> |
>>>> | Regarding RQuantLib, is the issue that that functionality hasn't been
>>>> | implemented in R yet, or is it QuantLib that's broken?
>>>>
>>>> There is a third door behind which you find the price: "numerical
>>>> shocks".
>>>>
>>>> Evaluate your american option, then shift the various parameters (spot,
>>>> vol,
>>>> int.rate, time to mat, ...) each by a small amount and calculate the
>>>> change
>>>> in option price -- voila for the approximate change in option value for
>>>> change input.  You can also compute twice at  'x - eps' and 'x + eps'
>>>> etc.
>>>>
>>>> Dirk
>>>
>>>
>>> Dirk,
>>>
>>> Thank you for your response.  I was hoping you might reply.
>>>
>>> I understand the concept of your suggestion, although I don't have any
>>> practical experience implementing it.  I'm guessing this is what's
>>> generally referred to as finite difference methods.  In theory, the
>>> first order greeks should be simple enough, although my impression is
>>> the second or third order greeks may be a bit more challenging.
>>>
>>> I hate to trouble you for more information, but I'm curious why?  Is
>>> this the "standard" method of calculating greeks for American options?
>>>   Has QuantLib decided not to implement this calculation? Just curious.
>>>
>>> Thanks again,
>>>
>>
>> A simple forward difference is
>>
>> [f(x + h) - f(x)] / h
>>
>> 'f' is the option pricing formula; 'x' are the arguments to the formula, and
>> 'h' is a small offset.
>>
>> Numerically, 'h' should not be made too small:
>>
>> (1) Even for smooth functions, we trade off truncation error (which is large
>> when 'h' is large) against roundoff-error (in the extreme, 'x + h' may still
>> be 'x' for a very small 'h').
>>
>> (2) American options are typically valued via finite-difference or tree
>> methods, and hence 'f' is not smooth and any 'bumps' in the function will be
>> magnified by dividing by a very small 'h'. So when 'h' is too small, the
>> results will become nonsensical.
>>
>> Here is an example. As a first test, I use a European option.
>>
>> require("RQuantLib")
>> h<- 1e-4
>> S<- 100
>> K<- 100
>> tau<- 0.5
>> vol<- 0.3
>> C0<- EuropeanOption(type = "call",
>>                      underlying = S, strike = K,
>>                      dividendYield = 0.0,
>>                      riskFreeRate = 0.03, maturity = tau,
>>                      volatility = 0.3)
>> Cplus<- EuropeanOption(type="call",
>>                         underlying = S + h, strike = K,
>>                         dividendYield = 0.0,
>>                         riskFreeRate=0.03, maturity=tau,
>>                         volatility=0.3)
>> Cminus<- EuropeanOption(type="call",
>>                          underlying = S - h, strike=K,
>>                          dividendYield=0.0,
>>                          riskFreeRate=0.03, maturity=tau,
>>                          volatility=0.3)
>>
>> ## a first-order difference: delta
>> (Cplus$value-C0$value)/h
>> ## [1] 0.570159
>> C0$delta
>> ## [1] 0.5701581
>>
>>
>> ## a second-order difference
>> (Cplus$delta-C0$delta)/h
>> ## [1] 0.01851474
>> C0$gamma
>> ## [1] 0.01851475
>>
>>
>>
>>
>> Now for an American option. Here we don't have the delta, so we first need
>> to compute it as well.
>>
>> C0<- AmericanOption(type="put",
>>                      underlying = S, strike=K,
>>                      dividendYield=0.0,
>>                      riskFreeRate=0.03, maturity=tau,
>>                      volatility=vol)
>> Cplus<- AmericanOption(type="put",
>>                         underlying = S + h, strike=K,
>>                         dividendYield=0.0,
>>                         riskFreeRate=0.03, maturity=tau,
>>                         volatility=vol)
>> Cminus<- AmericanOption(type="put",
>>                          underlying = S - h, strike=K,
>>                          dividendYield=0.0,
>>                          riskFreeRate=0.03, maturity=tau,
>>                          volatility=vol)
>>
>> ## a first-order difference: delta
>> (dplus<- (Cplus$value - C0$value)/h)
>> (dminus<-(C0$value - Cminus$value)/h)
>>
>> ## a second-order difference
>> (dplus - dminus)/h
>> ## [1] 0.01905605
>>
>> I ran a little a experiment with different levels of 'h', where you can
>> clearly see when the gamma diverges.
>>
>> |    h |      gamma |
>> |    1 | 0.01905385 |
>> | 0.01 | 0.01905612 |
>> | 1e-4 | 0.01905605 |
>> | 1e-5 | 0.01915801 |
>> | 1e-6 | 0.03463896 |
>> | 1e-8 |   8.881784 |
>>
>>
>> In the literatur, you find a number of tricks to smooth the function, but in
>> my experience, you are fine if you make 'h' small with respect to 'x' --
>> small, not tiny. So if the stock price is 100, a change of 1 or 0.1 is
>> small. (And think of it: even if we found that a change of one-thousandth of
>> a cent led to a meaningful numerical difference; if the stock price never
>> moves by such an amount, such a computation would not be empirically
>> meaningful.)
>>
>>
>> Regards,
>> Enrico
>>
>
> Enrico,
>
> Thank you so much for such a detailed and helpful example.  I had
> found an article on Wikipedia mentioning many of the issues you write
> about regarding selection of h.  In that article, the author/s
> suggest:
>
> "A choice for h which is small without producing a large rounding
> error is sqrt(?  x) where the machine epsilon ? is typically of the
> order 2.2?10-16."
>
> http://en.wikipedia.org/wiki/Numerical_differentiation
>
> So for R, I suppose that would equate to:
>
> h<- sqrt(.Machine$double.eps * x)
>
> Thanks again for your really helpful example.
>
> Best,
>

I am glad if it helped. The value for 'h' that the Wikipedia article 
cites is very likely for a forward difference; this is not generally 
appropriate for other differences (eg, central  or higher-order 
differences) -- it will be too small then.

Here is again the example I gave, slightly modified to directly compute 
the second-order derivative.

require("RQuantLib")
h <- 10^(-(0:10))  ## a vector of values
S <- 100
K <- 100
tau <- 0.5
vol <- 0.3
C0 <- EuropeanOption(type = "call",
                      underlying = S, strike = K,
                      dividendYield = 0.0,
                      riskFreeRate = 0.03, maturity = tau,
                      volatility = vol)

gammaVec <- numeric(length(h))
for (i in seq(along.with = h)) {
     Cplus <- EuropeanOption(type="call",
                             underlying = S + h[i], strike = K,
                             dividendYield = 0.0,
                             riskFreeRate = 0.03,
                             maturity = tau,
                             volatility = vol)
     Cminus <- EuropeanOption(type="call",
                              underlying = S - h[i], strike = K,
                              dividendYield = 0.0,
                              riskFreeRate = 0.03, maturity = tau,
                              volatility = vol)

     ## a central difference
     gammaVec[i] <- (Cplus$value + Cminus$value - 2*C0$value)/h[i]^2
}


## the analytic solution
C0$gamma
## [1] 0.01851475

data.frame(h = h, gamma = gammaVec)

        h         gamma
1  1e+00  1.851213e-02
2  1e-01  1.851473e-02
3  1e-02  1.851475e-02
4  1e-03  1.851475e-02
5  1e-04  1.851461e-02
6  1e-05  1.861622e-02
7  1e-06  1.421085e-02
8  1e-07  0.000000e+00
9  1e-08  7.105427e+01
10 1e-09 -1.421085e+04
11 1e-10 -7.105427e+05


The goal in choosing 'h' is to find the 'sweet spot' where the 
approximation error (which is a combination of truncation and roundoff 
error) is smallest. My suggestion is that, if in doubt, to use a larger 
value for 'h' than prescribed on Wikipedia or the literature. (Or, even 
better, to run experiments to determine a good value for 'h' for your 
implementation.)


Regards,
Enrico


>
> James
>
>

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


From harrisonmark1 at gmail.com  Fri Feb 10 18:42:40 2012
From: harrisonmark1 at gmail.com (Mark Harrison)
Date: Fri, 10 Feb 2012 11:42:40 -0600
Subject: [R-SIG-Finance] BuildIBContract odd behavior
In-Reply-To: <CA+xi=qYgRZzEoHP0LyXZACAGcEs3+UraLjOaavrhnHqvvpykXA@mail.gmail.com>
References: <CAHFhaq9xJgd=qQ6WfjE_4f6Xi-be6Z-a7Ge3KVE15bpzwzCOBg@mail.gmail.com>
	<CA+xi=qYgRZzEoHP0LyXZACAGcEs3+UraLjOaavrhnHqvvpykXA@mail.gmail.com>
Message-ID: <CAHFhaq_jfK-TP+YUtBCPBJvo0FrM_B7fvJ4fO=ffyo-xHrELXQ@mail.gmail.com>

Upgrading did the trick.  Thanks Garrett.

On Thu, Feb 9, 2012 at 5:39 PM, G See <gsee000 at gmail.com> wrote:
> Mark,
>
> Please update FinancialInstrument and twsInstrument.
>
> I cannot reproduce your warning with the current code. ?Usually you
> get that warning if you request a stock and the first one that is
> found is denominated in a currency that is not defined.
> And, you shouldn't get the warning that NOK was defined for you unless
> it was not defined.
>
> In version 0.10 of FinancialInstrument I moved the .instrument
> environment from .GlobalEnv to FinancialInstrument:::.instrument. ?It
> sounds like buildIBcontract is looking in the wrong place for the
> currency.
>
> If this is still repeatable after you update, let me know.
>
> HTH,
> Garrett
>
> On Thu, Feb 9, 2012 at 5:19 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
>> I am using Interactive Brokers and R to download and maintain forex
>> data in addition to doing some analytics on each currency pair. ?I
>> have setup Financial Instrument per Garrett's instructions and have
>> edited my rProfile site file to define all the available currencies
>> and exchange rate pairs.
>>
>> Each day I run a script that connects to TWS using iBrokers and loop
>> through all the currency pairs defining a contract for each using
>> twsInstrument. ?The script then requests data from IB and saves the
>> data into each currency pairs folder in my home directory.
>>
>> The issue I am having is that for the Norwegian Krone I get a message
>> when I grab data for GBPNOK - the first Norwegian currency in my
>> symbol list - which is "Checking to see if other 'type's have a
>> pre-defined currency." ?I am getting data for this pair as well as all
>> the other NOK currency pairs.
>>
>> When my script completes I get the warning: "In
>> buildIBcontract(symbol) : Creating currency ?NOK"
>>
>> I have looked through my rProfile and script and can find no reason
>> why I should get this message and warning since I have both defined
>> the currency "NOK" and exchange rates using NOK - i.e. GBPNOK, EURNOK,
>> NOKSEK, etc.. ?I also get data for each 'NOK' pair so everything seems
>> like it is working.
>>
>> I realize I am only getting a warning and I am still able to get the
>> data I am after but this is bugging me because I cannot figure it out
>> and it is making me think I have a bigger problem.
>>
>> Any help would be appreciated. ?By the way, I have been digging
>> through the support lists but finding no answer.
>>
>> # Session Info
>> R version 2.14.0 (2011-10-31)
>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] datasets ?grDevices utils ? ? graphics ?stats ? ? methods ? base
>>
>> other attached packages:
>> ?[1] fTrading_2100.76 ? ? ? ? ? fBasics_2110.79 ? ? ? ? ? ?MASS_7.3-16
>> ?[4] timeSeries_2130.92 ? ? ? ? timeDate_2131.00
>> twsInstrument_1.2-9
>> ?[7] IBrokers_0.9-3 ? ? ? ? ? ? qmao_1.1.6
>> FinancialInstrument_0.9.20
>> [10] quantmod_0.3-17 ? ? ? ? ? ?TTR_0.21-0 ? ? ? ? ? ? ? ? xts_0.8-2
>> [13] zoo_1.7-6 ? ? ? ? ? ? ? ? ?Defaults_1.1-1
>>
>> loaded via a namespace (and not attached):
>> [1] blotter_0.8.4 ? ?grid_2.14.0 ? ? ?lattice_0.20-0
>> quantstrat_0.6.1 tools_2.14.0
>>
>>
>> # ?rProfile
>> # Packages to load at startup
>> require(quantmod)
>> require(qmao)
>> require(IBrokers)
>> require(FinancialInstrument)
>> require(twsInstrument)
>> require(fTrading)
>>
>> #Define Currencies
>> currency(c("AUD", "CAD", "CHF", "CZK", "DKK", "EUR", "GBP", "HKD",
>> "HUF", "ILS", "JPY", "KRW", "MXN", "NOK", "NZD", "PLN", "RUB", "SEK",
>> "SGD", "USD"))
>>
>> #Define British Pound Based Exchange Rates
>> exchange_rate(c("GBPAUD", "GBPCAD", "GBPCHF", "GBPHKD", "GBPJPY",
>> "GBPNOK", "GBPNZD", "GBPUSD"))
>>
>> --------------------------------------------------------
>>
>>
>> # Script code examples
>> symbols <- c("GBPJPY", "GBPMXN", "GBPNOK", "GBPNZD", "GBPUSD")
>>
>> for(symbol in symbols){
>> # Build Contract
>> contract <- buildIBcontract(symbol)
>>
>> # at this point I request data and save the files...I can provide the
>> code if needed.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.


From drseergio at gmail.com  Fri Feb 10 18:51:36 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Fri, 10 Feb 2012 09:51:36 -0800
Subject: [R-SIG-Finance] Using quantstrat indicators against columns
 other than "Close"
In-Reply-To: <1328891878.3743.86.camel@brian-rcg>
References: <CAEGu7Fso3aizzsDKVXQ=rP9SFp5wEX3ZxJk-YFgFCO3Yi+4_2Q@mail.gmail.com>
	<1328891878.3743.86.camel@brian-rcg>
Message-ID: <CAEGu7FvXnmX+3rqdNQaY8PVrpMAWb9X-1VK2WxyeNSfpiR1P=Q@mail.gmail.com>

Thank you, Brian. This all makes sense now.

/Sergey

On Fri, Feb 10, 2012 at 8:37 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Fri, 2012-02-10 at 08:26 -0800, Sergey Pisarenko wrote:
>> Hi,
>>
>> I have started using 'quantstrat' to model strategies and cannot
>> figure out a way to add an indicator that would be calculated against
>> a column other than "Close". For example, in the code below I create a
>> 5-day SMA:
>>
>> s ? ? ? ? <- add.indicator(strategy=s, name='SMA',
>> arguments=list(x=quote(Cl(mktdata)), n=5), label='SMA5')
>>
>> This creates a column with 5-day SMA calculated for the closing price
>> of the instrument. What is the correct approach of using indicators
>> against other columns, such as "Volume"?
>
> the Cl() function there should be the clue...
>
> Cl(), Op(), Vo(), etc are all utility functions provided by quantmod to
> extract specific columns by common name. ?You could also use standard R
> subsetting to get any column you want out of your data.
>
> Regards,
>
> ? - Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>


From harrisonmark1 at gmail.com  Sat Feb 11 00:04:35 2012
From: harrisonmark1 at gmail.com (Mark Harrison)
Date: Fri, 10 Feb 2012 17:04:35 -0600
Subject: [R-SIG-Finance] Interactive Brokers Compatibility
Message-ID: <CAHFhaq9nhs85AD3fHcXYhMWN-Du_zNYkvj0EEOCGqDJFoehnaA@mail.gmail.com>

I am using R with Interactive Brokers TWS version 916.5.  The TWS
software has been warning me that I need to upgrade as my version is
going off support or will no longer be supported.

Since this is my first upgrade of TWS since I started using R with TWS
I thought I would ask if there were any issues with any of the latest
version of TWS and the API.  And if so, is there a specific version of
TWS & the API that I should stick with?

I figured it made sense to check the support lists - both archive and
email - before I upgrade.

Thanks,
Mark

# Session Info
R version 2.14.0 (2011-10-31)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] datasets  grDevices utils     graphics  stats     methods   base

other attached packages:
 [1] fTrading_2110.77           fBasics_2110.79            MASS_7.3-16
 [4] timeSeries_2140.93         timeDate_2150.95
twsInstrument_1.3-1
 [7] IBrokers_0.9-3             qmao_1.1.6
FinancialInstrument_0.10.9
[10] quantmod_0.3-17            TTR_0.21-0                 xts_0.8-4
[13] zoo_1.7-7                  Defaults_1.1-1

loaded via a namespace (and not attached):
[1] blotter_0.8.4    grid_2.14.0      lattice_0.20-3
quantstrat_0.6.1 tools_2.14.0


From jeffrey.ryan at lemnica.com  Sat Feb 11 01:00:49 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 10 Feb 2012 18:00:49 -0600
Subject: [R-SIG-Finance] Interactive Brokers Compatibility
In-Reply-To: <CAHFhaq9nhs85AD3fHcXYhMWN-Du_zNYkvj0EEOCGqDJFoehnaA@mail.gmail.com>
References: <CAHFhaq9nhs85AD3fHcXYhMWN-Du_zNYkvj0EEOCGqDJFoehnaA@mail.gmail.com>
Message-ID: <CABDUZc8UEY-xpgX5v+WFowZ9cA6C5POx4fOCwErkwiQzYdri8g@mail.gmail.com>

In general the releases of IBrokers are always in step with the most
recent production version of the API.  That is, not the beta, though
some features may be supported from the beta from time to time.

Not always released in lock step though.

Of course, being OSS software you can general patch any differences
that may arise.  They official API moves at a glacial pace these days,
so a real problem is rare.  Often it is only improvements that come
from the new releases.

If you do have patches, just send them to me and I'll see what I can
do about including in an upcoming release.

HTH
Jeff

On Fri, Feb 10, 2012 at 5:04 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
> I am using R with Interactive Brokers TWS version 916.5. ?The TWS
> software has been warning me that I need to upgrade as my version is
> going off support or will no longer be supported.
>
> Since this is my first upgrade of TWS since I started using R with TWS
> I thought I would ask if there were any issues with any of the latest
> version of TWS and the API. ?And if so, is there a specific version of
> TWS & the API that I should stick with?
>
> I figured it made sense to check the support lists - both archive and
> email - before I upgrade.
>
> Thanks,
> Mark
>
> # Session Info
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] datasets ?grDevices utils ? ? graphics ?stats ? ? methods ? base
>
> other attached packages:
> ?[1] fTrading_2110.77 ? ? ? ? ? fBasics_2110.79 ? ? ? ? ? ?MASS_7.3-16
> ?[4] timeSeries_2140.93 ? ? ? ? timeDate_2150.95
> twsInstrument_1.3-1
> ?[7] IBrokers_0.9-3 ? ? ? ? ? ? qmao_1.1.6
> FinancialInstrument_0.10.9
> [10] quantmod_0.3-17 ? ? ? ? ? ?TTR_0.21-0 ? ? ? ? ? ? ? ? xts_0.8-4
> [13] zoo_1.7-7 ? ? ? ? ? ? ? ? ?Defaults_1.1-1
>
> loaded via a namespace (and not attached):
> [1] blotter_0.8.4 ? ?grid_2.14.0 ? ? ?lattice_0.20-3
> quantstrat_0.6.1 tools_2.14.0
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From ecsniffer at hotmail.com  Sat Feb 11 09:21:04 2012
From: ecsniffer at hotmail.com (=?gb2312?B?ZWNzbmlmZmVywda+6g==?=)
Date: Sat, 11 Feb 2012 08:21:04 +0000
Subject: [R-SIG-Finance] rugarch package
Message-ID: <SNT118-W6D0AB1DE1763C463F1687AA790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/113cc5b9/attachment.pl>

From alexios at 4dscape.com  Sat Feb 11 10:25:28 2012
From: alexios at 4dscape.com (alexios)
Date: Sat, 11 Feb 2012 09:25:28 +0000
Subject: [R-SIG-Finance] rugarch package
In-Reply-To: <SNT118-W6D0AB1DE1763C463F1687AA790@phx.gbl>
References: <SNT118-W6D0AB1DE1763C463F1687AA790@phx.gbl>
Message-ID: <4F363408.70403@4dscape.com>

The only way to achieve this is to set the coefficients of lags 2 and 3 
to zero using the 'fixed.pars' option,
i.e. ugarchspec(mean.model = list(armaOrder=c(4,0)), 
fixed.pars=list(ar2=0,ar3=0)).
Fixed parameters are excluded during the calculation of standard errors 
unless you specify otherwise
in the ugarchfit 'fit.control' option.

In future please observe some measure of mail etiquette by signing your 
email with your name.

Regards,
Alexios

On 11/02/12 08:21, ecsniffer?? wrote:
> In mean.model of ugarchspec function, if I set armaOrder=c(4,0), it will include all of the 4 lags in the AR model. My question is whether I can just include the first lag and the fourth lag? that is, Is it O.K. for me to spefify the given lag terms?
>    		 	   		
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ecsniffer at hotmail.com  Sat Feb 11 11:44:19 2012
From: ecsniffer at hotmail.com (=?gb2312?B?ZWNzbmlmZmVywda+6g==?=)
Date: Sat, 11 Feb 2012 10:44:19 +0000
Subject: [R-SIG-Finance] ARMAX, t-GARCH estimation(RUGARCH package)
Message-ID: <SNT118-W15F4D38CC48C41F8533B6CAA790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/79f61b43/attachment.pl>

From alexios at 4dscape.com  Sat Feb 11 12:13:16 2012
From: alexios at 4dscape.com (Alexios Ghalanos)
Date: Sat, 11 Feb 2012 11:13:16 +0000
Subject: [R-SIG-Finance] ARMAX, t-GARCH estimation(RUGARCH package)
In-Reply-To: <SNT118-W15F4D38CC48C41F8533B6CAA790@phx.gbl>
References: <SNT118-W15F4D38CC48C41F8533B6CAA790@phx.gbl>
Message-ID: <BB5D0AFF-7E2B-48B2-AD9F-11617E8ABB99@4dscape.com>

It means that the standard errors could not be calculated as a result of not being able to invert the hessian during the post-estimation phase. As explained in the manual and vignette, general failures in the final optimization/post-estimation can generally be approached by changing the solver and/or tweaking the solver.
Other suggestions:
- DO use model 'sGARCH' rather than the 'GARCH' model of 'fGARCH' for estimation.
- Because you include regressors in the variance equation, try to provide a starting parameter for those and also try eGARCH where positivity is guaranteed  (possibly the source of the problem).

Regards,
Alexios


On Feb 11, 2012, at 10:44, ecsniffer?? <ecsniffer at hotmail.com> wrote:

> 
> I use ARMA(4,0), t-GARCH(1,1) model to estimate the volatility series(y_t). In the model, I add rate ( r_t ) and lagged rate( r_{t -1} ) to the conditional mean function and conditional variance function as the exogenous variables.
> 
> Here is my code:
> 
> data<-read.csv("...")
> volatility<-data$volatility;
> volatility.lag<-embed(volatility,2);
> volatility<-as.matrix(volatility.lag[,1]);
> rate<-data$diff_rate;
> rate.lag<-embed(rate,2);
> spec=ugarchspec(variance.model=list(model="fGARCH",garchOrder=c(1,1),submodel="GARCH", 
> external.regressors=as.matrix(rate.lag), variance.targeting = FALSE),
> mean.model = list(armaOrder = c(4,0), include.mean = TRUE, garchInMean = FALSE,
> inMeanType = 1, arfima = FALSE, external.regressors =as.matrix(rate.lag)), distribution.model = "std",
> start.pars = list(), fixed.pars = list())
> fit=ugarchfit(spec,data=volatility)
> fit
> 
> I got some errors and can't figure out the reason. Thanks!
> 
> Iter: 1 fn: 2986.4841    Pars:   -0.211418971918   0.097905377888  -0.084512900004  -0.053448303895  -0.071041833756 -22.798457638632  16.379426108878   1.626051893520   0.206719227655   0.747514215831   0.000000009905   0.000000009905   4.008451660273
> Iter: 2 fn: 2986.4841    Pars:   -0.211418971919   0.097906631452  -0.084513745760  -0.053447443169  -0.071041878730 -22.797651046488  16.377961083304   1.626059793075   0.206723362776   0.747509647714   0.000000009905   0.000000009905   4.008479595008
> solnp--> Completed in 2 iterations
> Warning:
> In .makefitmodel(garchmodel = "fGARCH", f = .fgarchLLH, data = data,  : 
> rugarch-->warning: failed to invert hessian
> 
> Errors in t.default(grad) : Parameters are not the matrix.                         
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ecsniffer at hotmail.com  Sat Feb 11 13:28:39 2012
From: ecsniffer at hotmail.com (=?gb2312?B?ZWNzbmlmZmVywda+6g==?=)
Date: Sat, 11 Feb 2012 12:28:39 +0000
Subject: [R-SIG-Finance] ARMAX, t-GARCH estimation(RUGARCH package)
In-Reply-To: <BB5D0AFF-7E2B-48B2-AD9F-11617E8ABB99@4dscape.com>
References: <SNT118-W15F4D38CC48C41F8533B6CAA790@phx.gbl>,
	<BB5D0AFF-7E2B-48B2-AD9F-11617E8ABB99@4dscape.com>
Message-ID: <SNT118-W402412DBC496B230F6CC4FAA790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/7cda297d/attachment.pl>

From ecsniffer at hotmail.com  Sat Feb 11 15:18:13 2012
From: ecsniffer at hotmail.com (=?gb2312?B?ZWNzbmlmZmVywda+6g==?=)
Date: Sat, 11 Feb 2012 14:18:13 +0000
Subject: [R-SIG-Finance] ugarchfit and arima seem contradictory?
Message-ID: <SNT118-W271DDC2256C5B22558C21AAA790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/f59601d3/attachment.pl>

From alexios at 4dscape.com  Sat Feb 11 15:29:36 2012
From: alexios at 4dscape.com (alexios)
Date: Sat, 11 Feb 2012 14:29:36 +0000
Subject: [R-SIG-Finance] ugarchfit and arima seem contradictory?
In-Reply-To: <SNT118-W271DDC2256C5B22558C21AAA790@phx.gbl>
References: <SNT118-W271DDC2256C5B22558C21AAA790@phx.gbl>
Message-ID: <4F367B50.2020405@4dscape.com>

1. Read the documentation of Box.test, and in particular on the option 
"fitdf" which needs to be adjusted when passing the
residuals of an ARMA filtration.
2. rugarch uses: type = "Ljung-Box"
3. Observe email etiquette by using your name when posting (this is your 
third email without one).

Alexios




On 11/02/12 14:18, ecsniffer?? wrote:
>
> I use ARMAX(4,1) model to estimate the volatility and include interest rate r_t as the exogenous variable. I use the arima function and ugarchfit function from RUGARCH package, respectively. The results seem to contradict with each other.
>
> If I use arima function,
> my code is as follows,
> data<-read.csv("...")
> volatility<-ts(data$volatility);
> rate<-ts(data$diff_rate);
> result=arima(volatility,order=c(4,0,1),xreg=rate)
> Box.test(result$residuals, lag =10, type = c("Box-Pierce", "Ljung-Box"))
>
> The output is as follows,
>   Box-Pierce test
> data:  result$residuals
> X-squared = 13.1749, df = 10, p-value = 0.2141
> which means no correlation among the residuals.
>
> However, if I use RUPACKAGE,
> my code is as follows,
> spec=ugarchspec(variance.model=list(model="sGARCH",garchOrder=c(1,1),submodel=NULL,
> + external.regressors=as.matrix(rate), variance.targeting = FALSE),
> + mean.model = list(armaOrder = c(4,1), include.mean = TRUE, garchInMean = FALSE,
> + inMeanType = 1, arfima = FALSE, external.regressors =as.matrix(rate)), distribution.model = "std",
> + start.pars = list(), fixed.pars = list())
> fit=ugarchfit(spec,data=as.matrix(volatility))
> fit
>
> The output is as follows,
> Q-Statistics on Standardized Residuals
> ------------------------------------
>                 statistic   p-value
> Lag10     15.76      0.0075508
> Lag15     21.98      0.0152135
> Lag20     42.29      0.0002031
> H0 : No serial correlation
> which means there exisits correlation among the residuals.
>
>
>
>    		 	   		
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ecsniffer at hotmail.com  Sat Feb 11 15:42:01 2012
From: ecsniffer at hotmail.com (=?gb2312?B?ZWNzbmlmZmVywda+6g==?=)
Date: Sat, 11 Feb 2012 14:42:01 +0000
Subject: [R-SIG-Finance] ugarchfit and arima seem contradictory?
In-Reply-To: <4F367B50.2020405@4dscape.com>
References: <SNT118-W271DDC2256C5B22558C21AAA790@phx.gbl>,
	<4F367B50.2020405@4dscape.com>
Message-ID: <SNT118-W380C8418D8D0B94E603C35AA790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/1ed39c69/attachment.pl>

From brian at braverock.com  Sat Feb 11 15:58:29 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 11 Feb 2012 08:58:29 -0600
Subject: [R-SIG-Finance] ugarchfit and arima seem contradictory?
In-Reply-To: <SNT118-W380C8418D8D0B94E603C35AA790@phx.gbl>
References: <SNT118-W271DDC2256C5B22558C21AAA790@phx.gbl>
	, <4F367B50.2020405@4dscape.com>
	<SNT118-W380C8418D8D0B94E603C35AA790@phx.gbl>
Message-ID: <1328972309.22152.71.camel@brian-desktop>

On Sat, 2012-02-11 at 14:42 +0000, ecsniffer?? wrote:
> Did I do something wrong?

Of course the mailing list knows who you are.

We see you only as ecsniffer? @hotmail.com

Note that most list members sign their emails with their real name.  It
is only polite, as Alexios pointed out.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From ecsniffer at hotmail.com  Sat Feb 11 16:50:32 2012
From: ecsniffer at hotmail.com (=?gb2312?B?ZWNzbmlmZmVywda+6g==?=)
Date: Sat, 11 Feb 2012 15:50:32 +0000
Subject: [R-SIG-Finance] ugarchfit and arima seem contradictory?
In-Reply-To: <1328972309.22152.71.camel@brian-desktop>
References: <SNT118-W271DDC2256C5B22558C21AAA790@phx.gbl>,,
	<4F367B50.2020405@4dscape.com>,
	<SNT118-W380C8418D8D0B94E603C35AA790@phx.gbl>,
	<1328972309.22152.71.camel@brian-desktop>
Message-ID: <SNT118-W47B0FBBB75844910FF7BEFAA790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/e0c68dce/attachment.pl>

From linusholtermann at gmx.de  Sat Feb 11 17:34:05 2012
From: linusholtermann at gmx.de (Lin23)
Date: Sat, 11 Feb 2012 08:34:05 -0800 (PST)
Subject: [R-SIG-Finance] Hessian in GARCH-Models (rugarch-package)
In-Reply-To: <4F33BBF5.3090301@4dscape.com>
References: <1328740200776-4371133.post@n4.nabble.com>
	<4F33BBF5.3090301@4dscape.com>
Message-ID: <1328978045544-4379242.post@n4.nabble.com>

There are two options for the robust covariance in the  'robustvcv' -code.
The first way to calculate the robust covariance is the sandwich-estimator :
B = cov(scores)
vcv = (Ainv%*%B%*%Ainv)/n
The second way uses the NeweyWest-Weights 
B = neweywestcv(scores, nlag)
vcv = (Ainv%*%B%*%Ainv)/n
When do I use the sandwich-estimator and when do I use the
NeweyWest-Weights?
In the literature on GARCH-models you often find "p-values based on
Bollerslev and Wooldridge
(1992) robust standard errors" or " p-values based on Bollerslev and
Wooldridge
(1992) robust standard errors with six lags". I guess in this case they use
the first option.
My model takes into account first-order and third-order autocorrelation in
stock returns, a structural change in the autoregressive structure,
international interdependence of the U.S. stock market, and a
day-of-the-week-effect.
I guess I should use the first option to calculate my robust covariance.
I adopt your "box.test".  Do I have to change des df (degrees of freedom) in
the Ljung-Box-test? By default they are zero. I use GJR-GARCH(1,1) and a
complex mean-equation (see above). If I am not mistaken there is no need to
change the default-setting for the box.test.
Thank you

--
View this message in context: http://r.789695.n4.nabble.com/Hessian-in-GARCH-Models-rugarch-package-tp4371133p4379242.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From baskins89 at gmail.com  Sat Feb 11 21:50:19 2012
From: baskins89 at gmail.com (Brian Askins)
Date: Sat, 11 Feb 2012 12:50:19 -0800
Subject: [R-SIG-Finance] ugarchfit() ARCH LM tests contradict ArchTest()?
Message-ID: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/bed22815/attachment.pl>

From brian at braverock.com  Sat Feb 11 22:14:38 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 11 Feb 2012 15:14:38 -0600
Subject: [R-SIG-Finance] ugarchfit() ARCH LM tests contradict ArchTest()?
In-Reply-To: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>
References: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>
Message-ID: <1328994878.3743.93.camel@brian-rcg>

On Sat, 2012-02-11 at 12:50 -0800, Brian Askins wrote:
> Hello all,
> 
> My name is Brian Askins and I'm a student at the University of Washington
> currently working on an M.S. in computational finance. Our current homework
> is to fit a few GARCH models and do some diagnostic tests on them, one of
> which is an LM test on the residuals to make sure there is no more
> autocorrelation among them. If I use the ArchTest() function from the FinTS
> package the results make sense and match (to a degree of error) a manual
> test that I coded to check this. However, the results from that are
> completely different from the results shown in the output of ugarchfit()
> under the section "ARCH LM Tests." This also confused other people in the
> class, including the TA. So can anyone tell me a little more information
> about this discrepancy? I can't find any information on the LM test
> performed in ugarchfit() from any of the documentation in the rugarch
> package. Any help or pointers on where to find this information would be
> greatly appreciated! Thanks!

Brian,

It would help everyone out if you followed the posting guide and took
some time to create a reproducible example that demonstrates what you're
talking about.  From your question, you've obviously already written the
code, and the data is probably readily available, so roll it up, comment
it, and be specific about the differences that are confusing you.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From alexios at 4dscape.com  Sat Feb 11 22:45:50 2012
From: alexios at 4dscape.com (alexios)
Date: Sat, 11 Feb 2012 21:45:50 +0000
Subject: [R-SIG-Finance] ugarchfit() ARCH LM tests contradict ArchTest()?
In-Reply-To: <1328994878.3743.93.camel@brian-rcg>
References: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>
	<1328994878.3743.93.camel@brian-rcg>
Message-ID: <4F36E18E.1060608@4dscape.com>

I find that they agree completely:

library(rugarch)
data(dji30ret)
fit = ugarchfit(ugarchspec(),dji30ret[,1])

# The ARCH LM Test on the squared standardized residuals shows:
ARCH LM Tests
------------------------------------
              Statistic DoF P-Value
ARCH Lag[2]     0.6795   2  0.7119
ARCH Lag[5]     1.9091   5  0.8616
ARCH Lag[10]    4.2709  10  0.9343

z = residuals(fit)/sigma(fit)

library(FinTS)
ArchTest(z, 2)
Chi-squared = 0.6795, df = 2, p-value = 0.7119
ArchTest(z, 10)
Chi-squared = 4.2709, df = 10, p-value = 0.9343

i.e. EXACTLY the same.

Regards,
Alexios

On 11/02/2012 21:14, Brian G. Peterson wrote:
> On Sat, 2012-02-11 at 12:50 -0800, Brian Askins wrote:
>> Hello all,
>>
>> My name is Brian Askins and I'm a student at the University of Washington
>> currently working on an M.S. in computational finance. Our current homework
>> is to fit a few GARCH models and do some diagnostic tests on them, one of
>> which is an LM test on the residuals to make sure there is no more
>> autocorrelation among them. If I use the ArchTest() function from the FinTS
>> package the results make sense and match (to a degree of error) a manual
>> test that I coded to check this. However, the results from that are
>> completely different from the results shown in the output of ugarchfit()
>> under the section "ARCH LM Tests." This also confused other people in the
>> class, including the TA. So can anyone tell me a little more information
>> about this discrepancy? I can't find any information on the LM test
>> performed in ugarchfit() from any of the documentation in the rugarch
>> package. Any help or pointers on where to find this information would be
>> greatly appreciated! Thanks!
>
> Brian,
>
> It would help everyone out if you followed the posting guide and took
> some time to create a reproducible example that demonstrates what you're
> talking about.  From your question, you've obviously already written the
> code, and the data is probably readily available, so roll it up, comment
> it, and be specific about the differences that are confusing you.
>
> Regards,
>
>     - Brian
>


From baskins89 at gmail.com  Sat Feb 11 22:58:23 2012
From: baskins89 at gmail.com (Brian Askins)
Date: Sat, 11 Feb 2012 13:58:23 -0800
Subject: [R-SIG-Finance] ugarchfit() ARCH LM tests contradict ArchTest()?
In-Reply-To: <4F36E18E.1060608@4dscape.com>
References: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>
	<1328994878.3743.93.camel@brian-rcg> <4F36E18E.1060608@4dscape.com>
Message-ID: <CAPRJdNOCcB2GaEFgWiaUsgxLDnbB48zUV2zhzEG0A3zO43Ut4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120211/663df17b/attachment.pl>

From alexios at 4dscape.com  Sat Feb 11 23:07:22 2012
From: alexios at 4dscape.com (alexios)
Date: Sat, 11 Feb 2012 22:07:22 +0000
Subject: [R-SIG-Finance] ugarchfit() ARCH LM tests contradict ArchTest()?
In-Reply-To: <CAPRJdNOCcB2GaEFgWiaUsgxLDnbB48zUV2zhzEG0A3zO43Ut4w@mail.gmail.com>
References: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>
	<1328994878.3743.93.camel@brian-rcg> <4F36E18E.1060608@4dscape.com>
	<CAPRJdNOCcB2GaEFgWiaUsgxLDnbB48zUV2zhzEG0A3zO43Ut4w@mail.gmail.com>
Message-ID: <4F36E69A.5080907@4dscape.com>

Hi Brian,

Testing on the ARMA (or other filtration) residuals should be done prior 
to the estimation to test for the presence of ARCH effects. Once a GARCH 
model is fitted, then you need to incorporate this information by using 
the residuals standardized by the conditional sigma of the GARCH model. 
The details of all tests used in the rugarch package are detailed in the 
vignette.

Regards,
Alexios

On 11/02/2012 21:58, Brian Askins wrote:
> Thank you for posting that, Alexios. I was working on code for an
> example (because my current code is homework code so I cannot post it)
> but you showed me what was different. I was doing the ArchTest on the
> residuals, not the standardized residuals. This makes much more sense now.
>
> My apologies for not including code in the first post, I'll be sure to
> include a working example in all future posts.
>
> Thanks again everyone, I'll let the other people in my class know what
> was going on with this.
>
> --Brian
>
> On Sat, Feb 11, 2012 at 1:45 PM, alexios <alexios at 4dscape.com
> <mailto:alexios at 4dscape.com>> wrote:
>
>     I find that they agree completely:
>
>     library(rugarch)
>     data(dji30ret)
>     fit = ugarchfit(ugarchspec(),__dji30ret[,1])
>
>     # The ARCH LM Test on the squared standardized residuals shows:
>     ARCH LM Tests
>     ------------------------------__------
>                  Statistic DoF P-Value
>     ARCH Lag[2]     0.6795   2  0.7119
>     ARCH Lag[5]     1.9091   5  0.8616
>     ARCH Lag[10]    4.2709  10  0.9343
>
>     z = residuals(fit)/sigma(fit)
>
>     library(FinTS)
>     ArchTest(z, 2)
>     Chi-squared = 0.6795, df = 2, p-value = 0.7119
>     ArchTest(z, 10)
>     Chi-squared = 4.2709, df = 10, p-value = 0.9343
>
>     i.e. EXACTLY the same.
>
>     Regards,
>     Alexios
>
>
>     On 11/02/2012 21:14, Brian G. Peterson wrote:
>
>         On Sat, 2012-02-11 at 12:50 -0800, Brian Askins wrote:
>
>             Hello all,
>
>             My name is Brian Askins and I'm a student at the University
>             of Washington
>             currently working on an M.S. in computational finance. Our
>             current homework
>             is to fit a few GARCH models and do some diagnostic tests on
>             them, one of
>             which is an LM test on the residuals to make sure there is
>             no more
>             autocorrelation among them. If I use the ArchTest() function
>             from the FinTS
>             package the results make sense and match (to a degree of
>             error) a manual
>             test that I coded to check this. However, the results from
>             that are
>             completely different from the results shown in the output of
>             ugarchfit()
>             under the section "ARCH LM Tests." This also confused other
>             people in the
>             class, including the TA. So can anyone tell me a little more
>             information
>             about this discrepancy? I can't find any information on the
>             LM test
>             performed in ugarchfit() from any of the documentation in
>             the rugarch
>             package. Any help or pointers on where to find this
>             information would be
>             greatly appreciated! Thanks!
>
>
>         Brian,
>
>         It would help everyone out if you followed the posting guide and
>         took
>         some time to create a reproducible example that demonstrates
>         what you're
>         talking about.  From your question, you've obviously already
>         written the
>         code, and the data is probably readily available, so roll it up,
>         comment
>         it, and be specific about the differences that are confusing you.
>
>         Regards,
>
>             - Brian
>
>
>


From ecsniffer at hotmail.com  Sun Feb 12 04:36:05 2012
From: ecsniffer at hotmail.com (LINJUAN)
Date: Sun, 12 Feb 2012 03:36:05 +0000
Subject: [R-SIG-Finance] ugarchfit() ARCH LM tests contradict ArchTest()?
In-Reply-To: <4F36E69A.5080907@4dscape.com>
References: <CAPRJdNNCpkgjT-WFLGDbkjUKMz6Vqq+b=GhHBpL=UtM=UF=T9Q@mail.gmail.com>,
	<1328994878.3743.93.camel@brian-rcg>
	<4F36E18E.1060608@4dscape.com>,
	<CAPRJdNOCcB2GaEFgWiaUsgxLDnbB48zUV2zhzEG0A3zO43Ut4w@mail.gmail.com>,
	<4F36E69A.5080907@4dscape.com>
Message-ID: <SNT118-W12B72968A6BDE5B724611AAA7E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120212/63f237f2/attachment.pl>

From horstrwolf at msn.com  Sun Feb 12 16:48:28 2012
From: horstrwolf at msn.com (Horst R. Wolf)
Date: Sun, 12 Feb 2012 16:48:28 +0100
Subject: [R-SIG-Finance] rugarch
Message-ID: <DUB107-W4633ADD65FA9D442F2CC00D77E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120212/d1d6eb65/attachment.pl>

From john.laing at gmail.com  Sun Feb 12 22:11:04 2012
From: john.laing at gmail.com (John Laing)
Date: Sun, 12 Feb 2012 16:11:04 -0500
Subject: [R-SIG-Finance] rbloomberg includeConditionCodes
In-Reply-To: <CAMEiyUGZ-tFSaPPy26En11k31dj4B4gtzzQLSMenOokMYgw2PQ@mail.gmail.com>
References: <CAMEiyUGZ-tFSaPPy26En11k31dj4B4gtzzQLSMenOokMYgw2PQ@mail.gmail.com>
Message-ID: <CAA3Wa=tCu51mX_Mg9Q7N1o8r6F2bM8DfGNqQzY82c2yXreoq=A@mail.gmail.com>

Jonny,

Presently the condition codes are being dropped by RBloomberg. I will
work to have this fixed in an upcoming release.

John

On Wed, Feb 8, 2012 at 12:22 PM, Jonny So <jonny.so at gmail.com> wrote:
> I'm trying to get trade tick data with condition codes but the
> includeConditionCodes option doesn't seem to do anything.
>
> tick(con, "BP/ LN Equity", "TRADE", "2012-01-19 16:29:50.000", "2012-01-19
> 16:29:59.000", option_names="includeConditionCodes", option_values="TRUE")
>
> Clearly I'm missing something - can anyone tell me what it is?
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From sashinali79 at hotmail.com  Mon Feb 13 13:27:47 2012
From: sashinali79 at hotmail.com (Sash Ali)
Date: Mon, 13 Feb 2012 12:27:47 +0000
Subject: [R-SIG-Finance] IBrokers reqOpenOrders
Message-ID: <DUB103-W28EE932F42A34567C2CE6EAB7F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120213/2c09921f/attachment.pl>

From jonny.so at gmail.com  Mon Feb 13 13:29:28 2012
From: jonny.so at gmail.com (Jonny So)
Date: Mon, 13 Feb 2012 12:29:28 +0000
Subject: [R-SIG-Finance] rbloomberg includeConditionCodes
In-Reply-To: <CAA3Wa=tCu51mX_Mg9Q7N1o8r6F2bM8DfGNqQzY82c2yXreoq=A@mail.gmail.com>
References: <CAMEiyUGZ-tFSaPPy26En11k31dj4B4gtzzQLSMenOokMYgw2PQ@mail.gmail.com>
	<CAA3Wa=tCu51mX_Mg9Q7N1o8r6F2bM8DfGNqQzY82c2yXreoq=A@mail.gmail.com>
Message-ID: <CAMEiyUFBPQETsqRut5jEMvSHdCWVifhcX3ggKEibKK1UJC602Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120213/507641c3/attachment.pl>

From me at censix.com  Mon Feb 13 18:09:34 2012
From: me at censix.com (me)
Date: Mon, 13 Feb 2012 18:09:34 +0100
Subject: [R-SIG-Finance] IBrokers reqOpenOrders
In-Reply-To: <DUB103-W28EE932F42A34567C2CE6EAB7F0@phx.gbl>
References: <DUB103-W28EE932F42A34567C2CE6EAB7F0@phx.gbl>
Message-ID: <20120213180934.0c9cb49c@desktop1>

I am guessing, but this error looks like it is related to the actual
connection you are trying to establish with the TWS. 

I have been using reqOpenOrders() without problems for a
while now.

Cheers

Soren



On Mon, 13 Feb 2012 12:27:47 +0000
Sash Ali <sashinali79 at hotmail.com> wrote:

> 
> 
> 
> 
> 
> 
> 
> Hi folks,
> 
> I've been using the IBrokers package to automate placing market,
> stop, and limit orders into my trading account. However, I have a
> number of stop and limit orders that have not been hit and would like
> to automate the canceling of these.
> 
> I am unable to find the required tools in the IBrokers documentation
> or on forums. However, I have discovered a brief mention on this
> forum on the 'reqOpenOrders' function but I can find only limited
> information on how to use it. 
> 
> I have tried the following,
> 
> tws <- twsConnect(clientId=1);
> IBrokers::reqOpenOrders(tws)
> 
> However, the output is 
> 
> Error in e_tick_size(NULL, msg, timestamp, file, symbols, ...) : 
>   argument "file" is missing, with no default
> 
> - which I do not understand.
> 
> I would be grateful for any help.
> 
> Sash
> 
> 
>  		 	   		  
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R
> questions should go.


From sashinali79 at hotmail.com  Mon Feb 13 18:59:55 2012
From: sashinali79 at hotmail.com (Sash Ali)
Date: Mon, 13 Feb 2012 17:59:55 +0000
Subject: [R-SIG-Finance] IBrokers reqOpenOrders
In-Reply-To: <20120213180934.0c9cb49c@desktop1>
References: <DUB103-W28EE932F42A34567C2CE6EAB7F0@phx.gbl>,
	<20120213180934.0c9cb49c@desktop1>
Message-ID: <DUB103-W502FD25491036547D1137FAB7F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120213/8e4f75ee/attachment.pl>

From me at censix.com  Mon Feb 13 19:16:12 2012
From: me at censix.com (me)
Date: Mon, 13 Feb 2012 19:16:12 +0100
Subject: [R-SIG-Finance] IBrokers reqOpenOrders
In-Reply-To: <DUB103-W502FD25491036547D1137FAB7F0@phx.gbl>
References: <DUB103-W28EE932F42A34567C2CE6EAB7F0@phx.gbl>
	<20120213180934.0c9cb49c@desktop1>
	<DUB103-W502FD25491036547D1137FAB7F0@phx.gbl>
Message-ID: <20120213191612.29b96ce1@desktop1>

Sasha

type 'reqOpenOrders' at the R prompt and you will see that the
function enters an infinite 'while (TRUE)' loop where it reads the
responses from the TWS. This uses the default eWrapper object, which
will print the TWS messages using a 'cat' command. If you want to
do some proper processing of the TWS messages, you at least need to:

1. run the while loop only for a finite amount of time, i.e. 1 minute
or so

2. define your own eWrapper object that is able to 'do something' with
the open_order events coming back from the TWS, i.e. 'cat' them to a
file. The 'cat' command accepts a filename as argument, if I am not
mistaken.

S.


On Mon, 13 Feb 2012 17:59:55 +0000
Sash Ali <sashinali79 at hotmail.com> wrote:

> 
> Yes, thank you Soren - I think you were on the right lines. 
> 
> I was using the same TWS object to request live data through
> 
> reqMktData(tws, Contract=assets,
> eventWrapper=eWrapper.MktData.CSV(n.mkts), file=files)
> 
> and I think as a result of this, I was returned the aforementioned
> error.
> 
> Now I declare a separate TWS object through
> 
> tws2 <- twsConnect(clientId=2);
> 
> and use tws2 to place orders through placeOrders(tws2..... ), and
> then request open orders through
> 
> IBrokers::reqOpenOrders(tws2)
> 
> 
> the correct output is returned directly to the console but which then
> hangs..... Only escaping then allows me to use to console again.
> 
> Would you be able to advise of a way to output the data to say a text
> file, such that my R console is not affected ?
> 
> Many thanks again & Kind Regards,
> 
> Sash
> 
> 
> 
> > Date: Mon, 13 Feb 2012 18:09:34 +0100
> > From: me at censix.com
> > To: sashinali79 at hotmail.com
> > CC: r-sig-finance at r-project.org
> > Subject: Re: [R-SIG-Finance] IBrokers reqOpenOrders
> > 
> > I am guessing, but this error looks like it is related to the actual
> > connection you are trying to establish with the TWS. 
> > 
> > I have been using reqOpenOrders() without problems for a
> > while now.
> > 
> > Cheers
> > 
> > Soren
> > 
> > 
> > 
> > On Mon, 13 Feb 2012 12:27:47 +0000
> > Sash Ali <sashinali79 at hotmail.com> wrote:
> > 
> > > 
> > > 
> > > 
> > > 
> > > 
> > > 
> > > 
> > > Hi folks,
> > > 
> > > I've been using the IBrokers package to automate placing market,
> > > stop, and limit orders into my trading account. However, I have a
> > > number of stop and limit orders that have not been hit and would
> > > like to automate the canceling of these.
> > > 
> > > I am unable to find the required tools in the IBrokers
> > > documentation or on forums. However, I have discovered a brief
> > > mention on this forum on the 'reqOpenOrders' function but I can
> > > find only limited information on how to use it. 
> > > 
> > > I have tried the following,
> > > 
> > > tws <- twsConnect(clientId=1);
> > > IBrokers::reqOpenOrders(tws)
> > > 
> > > However, the output is 
> > > 
> > > Error in e_tick_size(NULL, msg, timestamp, file, symbols, ...) : 
> > >   argument "file" is missing, with no default
> > > 
> > > - which I do not understand.
> > > 
> > > I would be grateful for any help.
> > > 
> > > Sash
> > > 
> > > 
> > >  		 	   		  
> > > 	[[alternative HTML version deleted]]
> > > 
> > > _______________________________________________
> > > R-SIG-Finance at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > -- Also note that this is not the r-help list where general R
> > > questions should go.
> > 
>  		 	   		  
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R
> questions should go.


From drseergio at gmail.com  Wed Feb 15 07:14:12 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Tue, 14 Feb 2012 22:14:12 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
Message-ID: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>

Hi,

I have been working with quantstrat and for the most part have been
able to re-write my existing code to fit within the framework. I see
that "buy" signals work and "enter" rules are triggered.

I currently do not grasp how to implement sell rules. I would like to
create 2 sell rules:
 1. when profit for a specific position reaches 15%
 2. when a position is kept for a year

>From what I have read from the examples the correct method to use is
"add.rule". Here's something I have already:

seller <- function(data, timestamp, portfolio, symbol) {
  posn <- getPosQty(portfolio, symbol, timestamp)
  if (posn != 0) {
  }
}
...
s         <- strategy('s')
s         <- add.indicator(strategy=s, name='SMA',
arguments=list(x=quote(Cl(mktdata)), n=shortSMA), label='SMA5')
s         <- add.signal(strategy=s, name='buySig',
arguments=list(data=quote(mktdata)), label='buySig')
s         <- add.rule(strategy=s, name='ruleSignal',
arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
orderqty=1000, ordertype='market', orderside=NULL, threshold=NULL,
osFUN='sizer'), type='enter')
s         <- add.rule(strategy=s, name='seller',
arguments=list(data=quote(mktdata)), type='exit')
...

It is clear that the code must go in the "seller" function. I also
understand that sell order is created by using "addOrder" function. I
am not sure how to check current profit inside of the function,
though.

What would be the correct approach to check the current profit for a
position inside of the rule function?

Appreciate your help.

--
Kind Regards,
Sergey Pisarenko.


From brian at braverock.com  Wed Feb 15 12:11:50 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 15 Feb 2012 05:11:50 -0600
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
Message-ID: <1329304310.12375.15.camel@brian-desktop>

On Tue, 2012-02-14 at 22:14 -0800, Sergey Pisarenko wrote:
> Hi,
> 
> I have been working with quantstrat and for the most part have been
> able to re-write my existing code to fit within the framework. I see
> that "buy" signals work and "enter" rules are triggered.
> 
> I currently do not grasp how to implement sell rules. I would like to
> create 2 sell rules:
>  1. when profit for a specific position reaches 15%
>  2. when a position is kept for a year
> 
> >From what I have read from the examples the correct method to use is
> "add.rule". Here's something I have already:
> 
> seller <- function(data, timestamp, portfolio, symbol) {
>   posn <- getPosQty(portfolio, symbol, timestamp)
>   if (posn != 0) {
>   }
> }
<...>
> It is clear that the code must go in the "seller" function. I also
> understand that sell order is created by using "addOrder" function. I
> am not sure how to check current profit inside of the function,
> though.
> 
> What would be the correct approach to check the current profit for a
> position inside of the rule function?

In your *entry* rule, you enter at market, so you're guaranteed a
fill.  

Your 'exit' rule for the profit taker order is then clear.  Enter it at
the same time as a stoplimit for 15% more than your entry signal price.
This won't be precisely 15% more than the close price on the next bar,
but is likely fine for a backtest (you could also look ahead, but I
don't recommend adding these kinds of biases).  It is certainly easier
than running all the calculation to check net profit on every bar after
entering a position.

A timed rule could certainly be done in your 'seller' function, but for
efficiency I would probably add an indicator function that would check
my entry indicator, and place a new 'signal' one year later.  Then you
put an entry rule to exit then if you have a position.

If you haven't already done so, find Guy Yollin's lecture slides on
quantstrat from UW.  He demonstrates some interesting custom order
sizing functions that could also give you ideas.

Regards,

   - Brian  

 


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From drseergio at gmail.com  Wed Feb 15 16:19:48 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 15 Feb 2012 07:19:48 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <1329304310.12375.15.camel@brian-desktop>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
Message-ID: <CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>

Thank you for useful ideas, Brian. These are helpful and I'll check
the slides you have mentioned.

--
Kind Regards,
Sergey Pisarenko.

On Wed, Feb 15, 2012 at 3:11 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Tue, 2012-02-14 at 22:14 -0800, Sergey Pisarenko wrote:
>> Hi,
>>
>> I have been working with quantstrat and for the most part have been
>> able to re-write my existing code to fit within the framework. I see
>> that "buy" signals work and "enter" rules are triggered.
>>
>> I currently do not grasp how to implement sell rules. I would like to
>> create 2 sell rules:
>> ?1. when profit for a specific position reaches 15%
>> ?2. when a position is kept for a year
>>
>> >From what I have read from the examples the correct method to use is
>> "add.rule". Here's something I have already:
>>
>> seller <- function(data, timestamp, portfolio, symbol) {
>> ? posn <- getPosQty(portfolio, symbol, timestamp)
>> ? if (posn != 0) {
>> ? }
>> }
> <...>
>> It is clear that the code must go in the "seller" function. I also
>> understand that sell order is created by using "addOrder" function. I
>> am not sure how to check current profit inside of the function,
>> though.
>>
>> What would be the correct approach to check the current profit for a
>> position inside of the rule function?
>
> In your *entry* rule, you enter at market, so you're guaranteed a
> fill.
>
> Your 'exit' rule for the profit taker order is then clear. ?Enter it at
> the same time as a stoplimit for 15% more than your entry signal price.
> This won't be precisely 15% more than the close price on the next bar,
> but is likely fine for a backtest (you could also look ahead, but I
> don't recommend adding these kinds of biases). ?It is certainly easier
> than running all the calculation to check net profit on every bar after
> entering a position.
>
> A timed rule could certainly be done in your 'seller' function, but for
> efficiency I would probably add an indicator function that would check
> my entry indicator, and place a new 'signal' one year later. ?Then you
> put an entry rule to exit then if you have a position.
>
> If you haven't already done so, find Guy Yollin's lecture slides on
> quantstrat from UW. ?He demonstrates some interesting custom order
> sizing functions that could also give you ideas.
>
> Regards,
>
> ? - Brian
>
>
>
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>


From drseergio at gmail.com  Wed Feb 15 17:35:47 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 15 Feb 2012 08:35:47 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
Message-ID: <CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>

I have put two rules to capture the profit, one for buy and one for sell:

s <- add.rule(strategy=s, name='ruleSignal',
arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
orderqty=1000, ordertype='market', orderside=NULL, threshold=NULL,
osFUN='osMaxPos', ruletype='enter'), type='enter')

s <- add.rule(strategy=s, name='ruleSignal',
arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
orderqty=-1000, ordertype='stoplimit', orderside=NULL, threshold=1.15,
tmult=TRUE, osFUN='osMaxPos'), type='exit')

The max position is set to 1000 using addMaxPos. The sell should
trigger on at least 15% gain. This creates the following transactions:

> p$symbols$BP$txn
           Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
2009-01-01       0     0.000         0        0.000       0         0.00
2010-07-07    1000    33.190     33190       33.190    1000        33.19
2010-07-09   -1000    38.801    -38801       38.801       0         0.00
2010-07-09    1000    34.050     34050       34.050    1000        34.05
2010-07-14   -1000    42.412    -42412       42.412       0         0.00
2010-07-14    1000    36.180     36180       36.180    1000        36.18
2010-07-27   -1000    42.665    -42665       42.665       0         0.00
2010-07-27    1000    38.000     38000       38.000    1000        38.00

For some reason the sell rule triggers too quick. For example, you can
see that a sell transaction is created on 2010-07-09 @ 38.801.
However, the closing price is not that high at that moment. Here are
the closing prices for the scenario:

2010-07-08   33.74
2010-07-09   34.05
2010-07-12   36.76
2010-07-13   36.88
2010-07-14   36.18
2010-07-15   38.92

Consequently, this also causes multiple buy transactions to trigger. I
would expect the stoplimit orders execute only when the closing price
reaches the stoplimit order.

What am I doing wrong in this case?

Thank you for your help.

/Sergey

On Wed, Feb 15, 2012 at 7:19 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Thank you for useful ideas, Brian. These are helpful and I'll check
> the slides you have mentioned.
>
> --
> Kind Regards,
> Sergey Pisarenko.
>
> On Wed, Feb 15, 2012 at 3:11 AM, Brian G. Peterson <brian at braverock.com> wrote:
>> On Tue, 2012-02-14 at 22:14 -0800, Sergey Pisarenko wrote:
>>> Hi,
>>>
>>> I have been working with quantstrat and for the most part have been
>>> able to re-write my existing code to fit within the framework. I see
>>> that "buy" signals work and "enter" rules are triggered.
>>>
>>> I currently do not grasp how to implement sell rules. I would like to
>>> create 2 sell rules:
>>> ?1. when profit for a specific position reaches 15%
>>> ?2. when a position is kept for a year
>>>
>>> >From what I have read from the examples the correct method to use is
>>> "add.rule". Here's something I have already:
>>>
>>> seller <- function(data, timestamp, portfolio, symbol) {
>>> ? posn <- getPosQty(portfolio, symbol, timestamp)
>>> ? if (posn != 0) {
>>> ? }
>>> }
>> <...>
>>> It is clear that the code must go in the "seller" function. I also
>>> understand that sell order is created by using "addOrder" function. I
>>> am not sure how to check current profit inside of the function,
>>> though.
>>>
>>> What would be the correct approach to check the current profit for a
>>> position inside of the rule function?
>>
>> In your *entry* rule, you enter at market, so you're guaranteed a
>> fill.
>>
>> Your 'exit' rule for the profit taker order is then clear. ?Enter it at
>> the same time as a stoplimit for 15% more than your entry signal price.
>> This won't be precisely 15% more than the close price on the next bar,
>> but is likely fine for a backtest (you could also look ahead, but I
>> don't recommend adding these kinds of biases). ?It is certainly easier
>> than running all the calculation to check net profit on every bar after
>> entering a position.
>>
>> A timed rule could certainly be done in your 'seller' function, but for
>> efficiency I would probably add an indicator function that would check
>> my entry indicator, and place a new 'signal' one year later. ?Then you
>> put an entry rule to exit then if you have a position.
>>
>> If you haven't already done so, find Guy Yollin's lecture slides on
>> quantstrat from UW. ?He demonstrates some interesting custom order
>> sizing functions that could also give you ideas.
>>
>> Regards,
>>
>> ? - Brian
>>
>>
>>
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>


From brian at braverock.com  Wed Feb 15 17:41:22 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 15 Feb 2012 10:41:22 -0600
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
	<CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
Message-ID: <1329324082.8901.51.camel@brian-rcg>

On Wed, 2012-02-15 at 08:35 -0800, Sergey Pisarenko wrote:
> Consequently, this also causes multiple buy transactions to trigger. I
> would expect the stoplimit orders execute only when the closing price
> reaches the stoplimit order.
> 
I'll look at it more closely when I have time, but if the High goes
through your limit, you will execute at the limit.  

Regards,

   - Brian
> 
-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From drseergio at gmail.com  Wed Feb 15 18:30:58 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 15 Feb 2012 09:30:58 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <1329324082.8901.51.camel@brian-rcg>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
	<CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
	<1329324082.8901.51.camel@brian-rcg>
Message-ID: <CAEGu7FsP7TjhNyL5mEyhT21ao7QOi2333+o2Fptm50J4512w_w@mail.gmail.com>

Thanks, that's a good idea. I have checked the high prices and I see
that the price does not reach that level. To further troubleshoot I
have changed the profit target to 50% (threshold=1.5). With that in
place I still got very similar results:

> p<-getPortfolio('p')
> p$symbols$B$txn
           Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
2009-01-01       0      0.00         0         0.00       0         0.00
2010-07-07    1000     33.19     33190        33.19    1000        33.19
2010-07-09   -1000     50.61    -50610        50.61       0         0.00
2010-07-09    1000     34.05     34050        34.05    1000        34.05
2010-07-14   -1000     55.32    -55320        55.32       0         0.00
2010-07-14    1000     36.18     36180        36.18    1000        36.18
2010-07-27   -1000     55.65    -55650        55.65       0         0.00
2010-07-27    1000     38.00     38000        38.00    1000        38.00

Prices of 50 are nowhere close to the prices for that time period:
                   Open   High    Low      Close  Volume          Adjusted
2010-07-07   32.73   33.22  32.19    33.19  54388300       31.95
2010-07-08   33.79   33.90  32.95    33.74  47070000       32.48
2010-07-09   33.28   34.17  32.12    34.05  48454800       32.78
2010-07-12   35.64   37.00  35.42    36.76  72391600       35.39
2010-07-13   37.72   37.76  35.71    36.88  85975400       35.51
2010-07-14   36.23   36.85  35.70    36.18  45008600       34.83
2010-07-15   36.68   39.81  36.52    38.92  75737600       37.47
2010-07-16   38.52   38.54  37.07    37.10  50505300       35.72
2010-07-19   36.00   36.08  34.58    35.75  55491300       34.42

/Sergey

On Wed, Feb 15, 2012 at 8:41 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Wed, 2012-02-15 at 08:35 -0800, Sergey Pisarenko wrote:
>> Consequently, this also causes multiple buy transactions to trigger. I
>> would expect the stoplimit orders execute only when the closing price
>> reaches the stoplimit order.
>>
> I'll look at it more closely when I have time, but if the High goes
> through your limit, you will execute at the limit.
>
> Regards,
>
> ? - Brian
>>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>


From rharlow86 at gmail.com  Wed Feb 15 22:05:04 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Wed, 15 Feb 2012 16:05:04 -0500
Subject: [R-SIG-Finance] Efficient CVaR Scenario Optimization for a Large
	number of Scenarios
Message-ID: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120215/c8b6e46b/attachment.pl>

From alexios at 4dscape.com  Wed Feb 15 23:11:57 2012
From: alexios at 4dscape.com (alexios)
Date: Wed, 15 Feb 2012 22:11:57 +0000
Subject: [R-SIG-Finance] Efficient CVaR Scenario Optimization for a
 Large number of Scenarios
In-Reply-To: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>
References: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>
Message-ID: <4F3C2DAD.8070601@4dscape.com>

Hi Bob,

There is a way to work with nonlinear solvers to solve this type of 
problem (without resorting to expensive global optimization approaches), 
once you work out the derivatives and decide on how to deal with the 
min/max type functions so that the problem is 'made convex'.

A complete example follows:

# We work with a smooth approximation to the max function:
epsilon = 1e-8

.max.smooth = function(x)
{
	(sqrt(x*x + epsilon ) + x) / 2
}

# the objective function (CVaR)
func.cvar = function(w, Data, alpha, mu, rmin)
{
	# we reverse the sign since we are minimizing
	-w[1] + mean( .max.smooth(w[1] - Data %*% w[-1]) )/alpha
}

# the gradient of the objective function
grad.cvar = function(w, Data, alpha, mu, rmin)
{
	epsilon2 = epsilon^2
	m = length(w)
	N = dim(Data)[1]
	g = vector(mode = "numeric", length = m)
	port = Data %*% w[-1]
	# first the derivative wrt to VaR
	g[1] = ( sum( ( port - w[1] )/( 2*N * sqrt( epsilon2 + ( port - w[1] 
)^2 ) ) ) - 0.5 )/alpha + 1
	for(i in 2:m){
		g[i] =  ( sum(Data[,i-1]/(2*N)) - sum( (Data[,i-1] * ( port - w[1]) 
)/( ( 2*N ) * (epsilon2 + ( port - w[1] )^2 )^0.5 ) ) )/alpha
	}
	# reverse the sign since we are minimizing
	return(-1 * g)
}

# the budget constraint:
func.eq = function(w, Data, alpha, mu, rmin){
	sum(w[-1]) - 1
}
# gradient of equality
grad.eq = function(w, Data, alpha, mu, rmin){
	m = length(w)-1
	return( matrix(c(0, rep(1, m)), ncol = m+1, nrow = 1) )
}

# Your inequality (weighted forecast >= rmin)
# but the solver we will use, sets: g(x) <= 0
# so we set: (rmin - weighted forecast) <= 0
func.ineq = function(w, Data, alpha, mu, rmin){
	wM = sum( mu * w[-1] )
	return( rmin - wM )
}
# gradient inequality
grad.ineq = function(w, Data, alpha, mu, rmin){
	m = length(w)
	Mu = matrix( c(0, mu), ncol = m )
	return(-Mu)
}


## Main Program Example (replicating your data)
library(mvtnorm)
mu <- c(.04, .06, .1)
sig <- c(.04, .09, .2)
cor.mat <- rbind(c( 1, .6, .2),
                  c(.6, 1, .1),
                  c(.2, .1, 1)
                  )
v.cov <- sig%o%sig*cor.mat
set.seed(100)
n <- 10000
samps <- rmvnorm(n, mean = mu, sigma = v.cov)
rmin = .08
alpha = 0.05
wmin = 0
wmax = 1

# I am going to use the nloptr solver (get it from CRAN)
library(nloptr)

.slsqp.ctrl = function(control = list())
{
	ctrl = list()
	ctrl$algorithm = "NLOPT_LD_SLSQP"
	if( is.null(control$ftol_rel) ) ctrl$ftol_rel = 1e-12 else 
ctrl$ftol_rel = control$ftol_rel
	if( is.null(control$xtol_rel) ) ctrl$xtol_rel = 1e-10 else 
ctrl$xtol_rel = control$xtol_rel	
	if( is.null(control$maxeval) ) ctrl$maxeval = 5000 else  ctrl$maxeval = 
as.integer( control$maxeval )
	if( is.null(control$maxtime) ) ctrl$maxtime = 10000 else  ctrl$maxtime 
= control$maxtime
	if( is.null(control$print_level) ) ctrl$print_level =0 else 
ctrl$print_level = as.integer( control$print_level )
	if( is.null(control$local_opts$algorithm) ) ctrl$local_opts$algorithm = 
"NLOPT_LD_MMA"
	if( is.null(control$local_opts$ftol_rel) ) ctrl$local_opts$ftol_rel = 
1e-12 else  ctrl$local_opts$ftol_rel = control$local_opts$ftol_rel
	if( is.null(control$local_opts$xtol_rel) ) ctrl$local_opts$xtol_rel = 
1e-10 else  ctrl$local_opts$xtol_rel = control$local_opts$xtol_rel	
	if( is.null(control$local_opts$print_level) ) 
ctrl$local_opts$print_level = 0 else  ctrl$local_opts$print_level = 
as.integer( control$local_opts$print_level )
	return(ctrl)
}

# set control parameters and subsolvers (use SQP)
ctrl = .slsqp.ctrl(control = list())

# set starting values
q1 = quantile(samps %*% rep(1/3,3), alpha)
# we are estimating [VaR AND the weights]
sol = nloptr(
x0 = c(q1,rep(1/3,3)),
eval_f = func.cvar,
eval_grad_f = grad.cvar,
lb = c(-1, rep( wmin, 3) ),
ub = c( 0, rep( wmax, 3) ),
opts = ctrl,
eval_g_ineq = func.ineq,
eval_jac_g_ineq = grad.ineq,
eval_g_eq = func.eq,
eval_jac_g_eq = grad.eq,
Data = samps, alpha = 0.05, mu = colMeans(samps), rmin = 0.08)

# [VaR w1 w2 w3]
# nloptr[-0.1125099 1.104523e-14 0.480181 0.519819]
# glpk[0.1125283 0.000000 0.480181 0.519819]
# end example

HTH.

Regards,

Alexios




On 15/02/2012 21:05, Robert Harlow wrote:
> Hi,
>     I am running into a memory issue when I try to run a mean-CVaR
> optimization on a large number of scenarios.  I am running R 32-bit on
> windows (see sessionInfo() output below).  I have attached code to display
> the problem below (using a sample from a random multi-variate normal
> distribution as an example, though that is not what I am actually doing.)
> I am using the methodology proposed by Uryasev (thanks to  Guy Yollin for
> the cvarOpt function) to formulate the problem as an LP.  When I have a
> small number of asset classes, I can arrive at good (though sometimes non
> "optimal" for a given set of scenarios) solutions using different
> optimizers (DEoptim, BBoptim, Rsolnp) where I don't run into the scenario
> size constraint.  However, when I increase the number of asset classes, the
> non-LP solvers do a worse and worse job of finding a stable "global"
> optimum, with the exception of DEoptim which will arrive at a good
> solution, but will take a very long time for, say, 25 asset classes and
> 10,000 scenarios.  The LP, on the other hand, seems much more sensitive to
> number of scenarios than to the number of asset classes.
> Thanks in advance,
> -Bob
>
> ## Code
> library(Rglpk)
> library(mvtnorm)
> mu<- c(.04, .06, .1)
> sig<- c(.04, .09, .2)
> cor.mat<- rbind(c( 1, .6, .2),
>                   c(.6, 1, .1),
>                   c(.2, .1, 1)
>                   )
> v.cov<- sig%o%sig*cor.mat
> set.seed(100)
> n<- 1000 ##works
> n<- 10000##doesn't work due to memory error
> samps<- rmvnorm(n, mean = mu, sigma = v.cov)
> cvarOpt<- function(rmat, alpha = .05, rmin = .05, wmin = 0, wmax = 1,
> weight.sum =1){
>      nAss = ncol(rmat) # number of assets
>      s = nrow(rmat) # number of scenarios i.e. periods
>      averet = colMeans(rmat)
>      ##create objective vector, constraint matrix, constraint rhs
>      Amat =
> rbind(cbind(rbind(1,averet),matrix(data=0,nrow=2,ncol=s+1)),cbind(rmat,diag(s),1))
>
>      objL = c(rep(0,nAss), rep(-1/(alpha*s), s), -1)
>      bvec = c(weight.sum,rmin,rep(0,s))
>      ##direction vector
>      dir.vec = c("==",">=",rep(">=",s))
>      ##bounds on weights
>      bounds = list(lower = list(ind = 1:nAss, val = rep(wmin,nAss)),upper =
> list(ind = 1:nAss, val = rep(wmax,nAss)))
>      res = Rglpk_solve_LP(obj=objL, mat=Amat, dir=dir.vec, rhs=bvec,
> types=rep("C",length(objL)), max=T, bounds=bounds)
>      w = as.numeric(res$solution[1:nAss])
>      return(list(w=w,status=res$status))
> }
> ans.cvar<- cvarOpt(rmat = samps, rmin = .08)
>
> ## session info
>
> R version 2.13.2 (2011-09-30)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] mvtnorm_0.9-9991 Rglpk_0.3-5      slam_0.1-22
>
> loaded via a namespace (and not attached):
> [1] tools_2.13.2
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From rharlow86 at gmail.com  Thu Feb 16 00:01:14 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Wed, 15 Feb 2012 18:01:14 -0500
Subject: [R-SIG-Finance] Efficient CVaR Scenario Optimization for a
 Large number of Scenarios
In-Reply-To: <4F3C2DAD.8070601@4dscape.com>
References: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>
	<4F3C2DAD.8070601@4dscape.com>
Message-ID: <CAHdfS97t8pucoZ6mO+Dh21C8ndHu_uU_h5ZknLpitWVgzgskpQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120215/730267bb/attachment.pl>

From drseergio at gmail.com  Thu Feb 16 05:16:22 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 15 Feb 2012 20:16:22 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7FsP7TjhNyL5mEyhT21ao7QOi2333+o2Fptm50J4512w_w@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
	<CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
	<1329324082.8901.51.camel@brian-rcg>
	<CAEGu7FsP7TjhNyL5mEyhT21ao7QOi2333+o2Fptm50J4512w_w@mail.gmail.com>
Message-ID: <CAEGu7FuHD8DgeA0NYXVqJbBmZ8a2v20Pog3xMcpSvB=xZShhbw@mail.gmail.com>

Brian,

I think this has to do with the fact that stop-limit order triggers
whenever the price is below the threshold. In other words, if I buy
shares for 30 and set a stop-limit order at 50 the stop-limit order
will trigger next day because the price is already below 50. It seems
that the stop-limit in its current implementation is not designed for
the case of gains. Instead, it works only for losses. When I set
threshold to say 0.9 (10% loss) I see that it behaves as expected and
the order is executed only when the price goes down 10%.

/Sergey

On Wed, Feb 15, 2012 at 9:30 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Thanks, that's a good idea. I have checked the high prices and I see
> that the price does not reach that level. To further troubleshoot I
> have changed the profit target to 50% (threshold=1.5). With that in
> place I still got very similar results:
>
>> p<-getPortfolio('p')
>> p$symbols$B$txn
> ? ? ? ? ? Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
> 2009-01-01 ? ? ? 0 ? ? ?0.00 ? ? ? ? 0 ? ? ? ? 0.00 ? ? ? 0 ? ? ? ? 0.00
> 2010-07-07 ? ?1000 ? ? 33.19 ? ? 33190 ? ? ? ?33.19 ? ?1000 ? ? ? ?33.19
> 2010-07-09 ? -1000 ? ? 50.61 ? ?-50610 ? ? ? ?50.61 ? ? ? 0 ? ? ? ? 0.00
> 2010-07-09 ? ?1000 ? ? 34.05 ? ? 34050 ? ? ? ?34.05 ? ?1000 ? ? ? ?34.05
> 2010-07-14 ? -1000 ? ? 55.32 ? ?-55320 ? ? ? ?55.32 ? ? ? 0 ? ? ? ? 0.00
> 2010-07-14 ? ?1000 ? ? 36.18 ? ? 36180 ? ? ? ?36.18 ? ?1000 ? ? ? ?36.18
> 2010-07-27 ? -1000 ? ? 55.65 ? ?-55650 ? ? ? ?55.65 ? ? ? 0 ? ? ? ? 0.00
> 2010-07-27 ? ?1000 ? ? 38.00 ? ? 38000 ? ? ? ?38.00 ? ?1000 ? ? ? ?38.00
>
> Prices of 50 are nowhere close to the prices for that time period:
> ? ? ? ? ? ? ? ? ? Open ? High ? ?Low ? ? ?Close ?Volume ? ? ? ? ?Adjusted
> 2010-07-07 ? 32.73 ? 33.22 ?32.19 ? ?33.19 ?54388300 ? ? ? 31.95
> 2010-07-08 ? 33.79 ? 33.90 ?32.95 ? ?33.74 ?47070000 ? ? ? 32.48
> 2010-07-09 ? 33.28 ? 34.17 ?32.12 ? ?34.05 ?48454800 ? ? ? 32.78
> 2010-07-12 ? 35.64 ? 37.00 ?35.42 ? ?36.76 ?72391600 ? ? ? 35.39
> 2010-07-13 ? 37.72 ? 37.76 ?35.71 ? ?36.88 ?85975400 ? ? ? 35.51
> 2010-07-14 ? 36.23 ? 36.85 ?35.70 ? ?36.18 ?45008600 ? ? ? 34.83
> 2010-07-15 ? 36.68 ? 39.81 ?36.52 ? ?38.92 ?75737600 ? ? ? 37.47
> 2010-07-16 ? 38.52 ? 38.54 ?37.07 ? ?37.10 ?50505300 ? ? ? 35.72
> 2010-07-19 ? 36.00 ? 36.08 ?34.58 ? ?35.75 ?55491300 ? ? ? 34.42
>
> /Sergey
>
> On Wed, Feb 15, 2012 at 8:41 AM, Brian G. Peterson <brian at braverock.com> wrote:
>> On Wed, 2012-02-15 at 08:35 -0800, Sergey Pisarenko wrote:
>>> Consequently, this also causes multiple buy transactions to trigger. I
>>> would expect the stoplimit orders execute only when the closing price
>>> reaches the stoplimit order.
>>>
>> I'll look at it more closely when I have time, but if the High goes
>> through your limit, you will execute at the limit.
>>
>> Regards,
>>
>> ? - Brian
>>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>


From drseergio at gmail.com  Thu Feb 16 05:24:10 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 15 Feb 2012 20:24:10 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7FuHD8DgeA0NYXVqJbBmZ8a2v20Pog3xMcpSvB=xZShhbw@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
	<CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
	<1329324082.8901.51.camel@brian-rcg>
	<CAEGu7FsP7TjhNyL5mEyhT21ao7QOi2333+o2Fptm50J4512w_w@mail.gmail.com>
	<CAEGu7FuHD8DgeA0NYXVqJbBmZ8a2v20Pog3xMcpSvB=xZShhbw@mail.gmail.com>
Message-ID: <CAEGu7Ft7eZrKU9Tp9R=1h7Yshqp-WLHJMUG-Mp0Vs6JpE17dng@mail.gmail.com>

I also realized a logic fault. The stop-limit order I had created used
the buy signal which is obviously not correct. The sell should occur
anytime price reaches a certain point regardless of the buy signal.

I will re-implement the same thing using a combination of a rule and
an indicator (separate column with price that is 15% higher than
purchase price).

Thanks for your help!

/Sergey

On Wed, Feb 15, 2012 at 8:16 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Brian,
>
> I think this has to do with the fact that stop-limit order triggers
> whenever the price is below the threshold. In other words, if I buy
> shares for 30 and set a stop-limit order at 50 the stop-limit order
> will trigger next day because the price is already below 50. It seems
> that the stop-limit in its current implementation is not designed for
> the case of gains. Instead, it works only for losses. When I set
> threshold to say 0.9 (10% loss) I see that it behaves as expected and
> the order is executed only when the price goes down 10%.
>
> /Sergey
>
> On Wed, Feb 15, 2012 at 9:30 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Thanks, that's a good idea. I have checked the high prices and I see
>> that the price does not reach that level. To further troubleshoot I
>> have changed the profit target to 50% (threshold=1.5). With that in
>> place I still got very similar results:
>>
>>> p<-getPortfolio('p')
>>> p$symbols$B$txn
>> ? ? ? ? ? Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
>> 2009-01-01 ? ? ? 0 ? ? ?0.00 ? ? ? ? 0 ? ? ? ? 0.00 ? ? ? 0 ? ? ? ? 0.00
>> 2010-07-07 ? ?1000 ? ? 33.19 ? ? 33190 ? ? ? ?33.19 ? ?1000 ? ? ? ?33.19
>> 2010-07-09 ? -1000 ? ? 50.61 ? ?-50610 ? ? ? ?50.61 ? ? ? 0 ? ? ? ? 0.00
>> 2010-07-09 ? ?1000 ? ? 34.05 ? ? 34050 ? ? ? ?34.05 ? ?1000 ? ? ? ?34.05
>> 2010-07-14 ? -1000 ? ? 55.32 ? ?-55320 ? ? ? ?55.32 ? ? ? 0 ? ? ? ? 0.00
>> 2010-07-14 ? ?1000 ? ? 36.18 ? ? 36180 ? ? ? ?36.18 ? ?1000 ? ? ? ?36.18
>> 2010-07-27 ? -1000 ? ? 55.65 ? ?-55650 ? ? ? ?55.65 ? ? ? 0 ? ? ? ? 0.00
>> 2010-07-27 ? ?1000 ? ? 38.00 ? ? 38000 ? ? ? ?38.00 ? ?1000 ? ? ? ?38.00
>>
>> Prices of 50 are nowhere close to the prices for that time period:
>> ? ? ? ? ? ? ? ? ? Open ? High ? ?Low ? ? ?Close ?Volume ? ? ? ? ?Adjusted
>> 2010-07-07 ? 32.73 ? 33.22 ?32.19 ? ?33.19 ?54388300 ? ? ? 31.95
>> 2010-07-08 ? 33.79 ? 33.90 ?32.95 ? ?33.74 ?47070000 ? ? ? 32.48
>> 2010-07-09 ? 33.28 ? 34.17 ?32.12 ? ?34.05 ?48454800 ? ? ? 32.78
>> 2010-07-12 ? 35.64 ? 37.00 ?35.42 ? ?36.76 ?72391600 ? ? ? 35.39
>> 2010-07-13 ? 37.72 ? 37.76 ?35.71 ? ?36.88 ?85975400 ? ? ? 35.51
>> 2010-07-14 ? 36.23 ? 36.85 ?35.70 ? ?36.18 ?45008600 ? ? ? 34.83
>> 2010-07-15 ? 36.68 ? 39.81 ?36.52 ? ?38.92 ?75737600 ? ? ? 37.47
>> 2010-07-16 ? 38.52 ? 38.54 ?37.07 ? ?37.10 ?50505300 ? ? ? 35.72
>> 2010-07-19 ? 36.00 ? 36.08 ?34.58 ? ?35.75 ?55491300 ? ? ? 34.42
>>
>> /Sergey
>>
>> On Wed, Feb 15, 2012 at 8:41 AM, Brian G. Peterson <brian at braverock.com> wrote:
>>> On Wed, 2012-02-15 at 08:35 -0800, Sergey Pisarenko wrote:
>>>> Consequently, this also causes multiple buy transactions to trigger. I
>>>> would expect the stoplimit orders execute only when the closing price
>>>> reaches the stoplimit order.
>>>>
>>> I'll look at it more closely when I have time, but if the High goes
>>> through your limit, you will execute at the limit.
>>>
>>> Regards,
>>>
>>> ? - Brian
>>>>
>>> --
>>> Brian G. Peterson
>>> http://braverock.com/brian/
>>> Ph: 773-459-4973
>>> IM: bgpbraverock
>>>


From drseergio at gmail.com  Thu Feb 16 06:19:34 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Wed, 15 Feb 2012 21:19:34 -0800
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7Ft7eZrKU9Tp9R=1h7Yshqp-WLHJMUG-Mp0Vs6JpE17dng@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
	<CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
	<1329324082.8901.51.camel@brian-rcg>
	<CAEGu7FsP7TjhNyL5mEyhT21ao7QOi2333+o2Fptm50J4512w_w@mail.gmail.com>
	<CAEGu7FuHD8DgeA0NYXVqJbBmZ8a2v20Pog3xMcpSvB=xZShhbw@mail.gmail.com>
	<CAEGu7Ft7eZrKU9Tp9R=1h7Yshqp-WLHJMUG-Mp0Vs6JpE17dng@mail.gmail.com>
Message-ID: <CAEGu7FsjEJ3oARUx=ktMB=6V_b4PVtv56LpekR1=qjSQnwm5=A@mail.gmail.com>

I have developed a rather clumsy solution but which works for my goals:

seller <- function(data, timestamp, portfolio, symbol) {
  posn <- getPosQty(portfolio, symbol, timestamp)
  if (posn != 0) {
    pos         <- getPos(portfolio, symbol, timestamp)
    holdPeriod  <- as.POSIXlt(timestamp) - index(pos)

    orderprice <- as.vector(Cl(data[timestamp]))
    qty        <- as.vector(pos[, 1])

    if (holdPeriod > maxHold) {
      addOrder(portfolio=portfolio, symbol=symbol,
timestamp=timestamp, qty=-qty, price=as.numeric(orderprice),
ordertype='market', side='long')
    }

    buy_price   <- as.vector(pos[, 2])
    close_price <- as.vector(Cl(data[timestamp]))
    profit      <- (close_price - buy_price) / buy_price

    if (profit > prfTarget) {
      addOrder(portfolio=portfolio, symbol=symbol,
timestamp=timestamp, qty=-qty, price=as.numeric(orderprice),
ordertype='market', side='long')
    }
  }
}

...

s <- add.rule(strategy=s, name='seller',
arguments=list(data=quote(mktdata)), type='exit')

I am not yet concerned about performance and efficiency. I am still on
my way of making a whole strategy to execute correctly and completely.

/Sergey

On Wed, Feb 15, 2012 at 8:24 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> I also realized a logic fault. The stop-limit order I had created used
> the buy signal which is obviously not correct. The sell should occur
> anytime price reaches a certain point regardless of the buy signal.
>
> I will re-implement the same thing using a combination of a rule and
> an indicator (separate column with price that is 15% higher than
> purchase price).
>
> Thanks for your help!
>
> /Sergey
>
> On Wed, Feb 15, 2012 at 8:16 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Brian,
>>
>> I think this has to do with the fact that stop-limit order triggers
>> whenever the price is below the threshold. In other words, if I buy
>> shares for 30 and set a stop-limit order at 50 the stop-limit order
>> will trigger next day because the price is already below 50. It seems
>> that the stop-limit in its current implementation is not designed for
>> the case of gains. Instead, it works only for losses. When I set
>> threshold to say 0.9 (10% loss) I see that it behaves as expected and
>> the order is executed only when the price goes down 10%.
>>
>> /Sergey
>>
>> On Wed, Feb 15, 2012 at 9:30 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>> Thanks, that's a good idea. I have checked the high prices and I see
>>> that the price does not reach that level. To further troubleshoot I
>>> have changed the profit target to 50% (threshold=1.5). With that in
>>> place I still got very similar results:
>>>
>>>> p<-getPortfolio('p')
>>>> p$symbols$B$txn
>>> ? ? ? ? ? Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
>>> 2009-01-01 ? ? ? 0 ? ? ?0.00 ? ? ? ? 0 ? ? ? ? 0.00 ? ? ? 0 ? ? ? ? 0.00
>>> 2010-07-07 ? ?1000 ? ? 33.19 ? ? 33190 ? ? ? ?33.19 ? ?1000 ? ? ? ?33.19
>>> 2010-07-09 ? -1000 ? ? 50.61 ? ?-50610 ? ? ? ?50.61 ? ? ? 0 ? ? ? ? 0.00
>>> 2010-07-09 ? ?1000 ? ? 34.05 ? ? 34050 ? ? ? ?34.05 ? ?1000 ? ? ? ?34.05
>>> 2010-07-14 ? -1000 ? ? 55.32 ? ?-55320 ? ? ? ?55.32 ? ? ? 0 ? ? ? ? 0.00
>>> 2010-07-14 ? ?1000 ? ? 36.18 ? ? 36180 ? ? ? ?36.18 ? ?1000 ? ? ? ?36.18
>>> 2010-07-27 ? -1000 ? ? 55.65 ? ?-55650 ? ? ? ?55.65 ? ? ? 0 ? ? ? ? 0.00
>>> 2010-07-27 ? ?1000 ? ? 38.00 ? ? 38000 ? ? ? ?38.00 ? ?1000 ? ? ? ?38.00
>>>
>>> Prices of 50 are nowhere close to the prices for that time period:
>>> ? ? ? ? ? ? ? ? ? Open ? High ? ?Low ? ? ?Close ?Volume ? ? ? ? ?Adjusted
>>> 2010-07-07 ? 32.73 ? 33.22 ?32.19 ? ?33.19 ?54388300 ? ? ? 31.95
>>> 2010-07-08 ? 33.79 ? 33.90 ?32.95 ? ?33.74 ?47070000 ? ? ? 32.48
>>> 2010-07-09 ? 33.28 ? 34.17 ?32.12 ? ?34.05 ?48454800 ? ? ? 32.78
>>> 2010-07-12 ? 35.64 ? 37.00 ?35.42 ? ?36.76 ?72391600 ? ? ? 35.39
>>> 2010-07-13 ? 37.72 ? 37.76 ?35.71 ? ?36.88 ?85975400 ? ? ? 35.51
>>> 2010-07-14 ? 36.23 ? 36.85 ?35.70 ? ?36.18 ?45008600 ? ? ? 34.83
>>> 2010-07-15 ? 36.68 ? 39.81 ?36.52 ? ?38.92 ?75737600 ? ? ? 37.47
>>> 2010-07-16 ? 38.52 ? 38.54 ?37.07 ? ?37.10 ?50505300 ? ? ? 35.72
>>> 2010-07-19 ? 36.00 ? 36.08 ?34.58 ? ?35.75 ?55491300 ? ? ? 34.42
>>>
>>> /Sergey
>>>
>>> On Wed, Feb 15, 2012 at 8:41 AM, Brian G. Peterson <brian at braverock.com> wrote:
>>>> On Wed, 2012-02-15 at 08:35 -0800, Sergey Pisarenko wrote:
>>>>> Consequently, this also causes multiple buy transactions to trigger. I
>>>>> would expect the stoplimit orders execute only when the closing price
>>>>> reaches the stoplimit order.
>>>>>
>>>> I'll look at it more closely when I have time, but if the High goes
>>>> through your limit, you will execute at the limit.
>>>>
>>>> Regards,
>>>>
>>>> ? - Brian
>>>>>
>>>> --
>>>> Brian G. Peterson
>>>> http://braverock.com/brian/
>>>> Ph: 773-459-4973
>>>> IM: bgpbraverock
>>>>


From patrick at burns-stat.com  Thu Feb 16 11:08:13 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 16 Feb 2012 10:08:13 +0000
Subject: [R-SIG-Finance] BurStFin now on CRAN
Message-ID: <4F3CD58D.8010208@burns-stat.com>

The 'BurStFin' package has managed to
crawl its way onto CRAN.  There are a
few changes to the functionality.

Details at:

http://www.portfolioprobe.com/2012/02/16/the-burstfin-r-package/


-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From lunamoonmoon at gmail.com  Thu Feb 16 16:13:01 2012
From: lunamoonmoon at gmail.com (Luna)
Date: Thu, 16 Feb 2012 09:13:01 -0600
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CAAmySGNCig-FRYWqgvATc+GFZELOEkR8QASPEs87FM07XmQ=rg@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
	<CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
	<CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>
	<CAAmySGNCig-FRYWqgvATc+GFZELOEkR8QASPEs87FM07XmQ=rg@mail.gmail.com>
Message-ID: <CAPNjSFb-b8TyrSAsxHDZCy+H9_+emfqKk5KGJ5itcBwQ_sH5Mw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120216/d5972bcf/attachment.pl>

From michael.weylandt at gmail.com  Thu Feb 16 16:17:17 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 16 Feb 2012 10:17:17 -0500
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CAPNjSFb-b8TyrSAsxHDZCy+H9_+emfqKk5KGJ5itcBwQ_sH5Mw@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
	<CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
	<CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>
	<CAAmySGNCig-FRYWqgvATc+GFZELOEkR8QASPEs87FM07XmQ=rg@mail.gmail.com>
	<CAPNjSFb-b8TyrSAsxHDZCy+H9_+emfqKk5KGJ5itcBwQ_sH5Mw@mail.gmail.com>
Message-ID: <CAAmySGNPDRn9f-JVn82Ua66vsEmbXwG2q-6oMVstcq_d7=uonQ@mail.gmail.com>

You'll get more if you lower your threshold value (the 5)

Michael

On Thu, Feb 16, 2012 at 10:13 AM, Luna <lunamoonmoon at gmail.com> wrote:
> Hi friends,
>
> Thanks for your help!
>
> I just did a new test:
>
> aa=100:1
> bb=sin(aa/3)
> cc=aa*bb
> plot(cc, type="l")
> p=findPeaks(cc, 5)
> points(p, cc[p])
> points(p, cc[p])
>
>>
>
> p
>
> [1] 3 22 41
>
>
>
> It only picks up 3 peaks, which is obviously wrong, am I correct?
>
> Thanks a lot!
>
> On Thu, Feb 9, 2012 at 9:55 PM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>>
>> Happy to follow procedure.
>>
>> Thanks for jumping on it so quickly.
>>
>> Michael Weylandt
>>
>> On Thu, Feb 9, 2012 at 10:40 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>
>> wrote:
>> > On Thu, Feb 9, 2012 at 9:00 PM, R. Michael Weylandt
>> > <michael.weylandt at gmail.com> wrote:
>> >> It looks like you need to wrap coredata() because some funny
>> >> arithmetic is happening when the xts-ness is preserved.
>> >>
>> >> e.g.
>> >>
>> >> findPeaks(coredata(Ad(SPY)), 5)
>> >>
>> >> But this is perhaps a less-than-desirable feature. I'll patch it and
>> >> send it to Josh.
>> >
>> > Proper procedure is indeed to blame Josh for all undesirable
>> > functionality, even in code he didn't write ;-)
>> >
>> > Patched in R-forge rev 577. Thanks.
>> >
>> > Jeff
>> >>
>> >> Michael
>> >>
>> >> On Thu, Feb 9, 2012 at 9:56 PM, Michael <comtech.usa at gmail.com> wrote:
>> >>> ?Hi all,
>> >>>
>> >>> I am having trouble using the function "findPeaks":
>> >>>
>> >>> tickers="SPY"
>> >>>
>> >>> data *<-* new.env()
>> >>>
>> >>> getSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data,
>> >>> auto.assign = T)
>> >>>
>> >>> p=findPeaks(data$SPY[, 6], 5)
>> >>>
>> >>> plot(data$SPY[, 6], type="l")
>> >>>
>> >>> points(p, data$SPY[, 6][p])
>> >>>
>> >>> My goal is to implement a trailing-stop on a buy-and-hold strategy
>> >>> using
>> >>> findPeaks...
>> >>>
>> >>> I wanted to detect whenever SPY falls 5 points from the local peak...
>> >>>
>> >>> The above example failed in finding the peaks (p == NULL).
>> >>>
>> >>> Am I missing anything here?
>> >>>
>> >>> Thanks a lot!
>> >>>
>> >>> ? ? ? ?[[alternative HTML version deleted]]
>> >>>
>> >>> _______________________________________________
>> >>> R-SIG-Finance at r-project.org mailing list
>> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >>> -- Subscriber-posting only. If you want to post, subscribe first.
>> >>> -- Also note that this is not the r-help list where general R
>> >>> questions should go.
>> >>
>> >> _______________________________________________
>> >> R-SIG-Finance at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>> >> -- Also note that this is not the r-help list where general R questions
>> >> should go.
>> >
>> >
>> >
>> > --
>> > Jeffrey Ryan
>> > jeffrey.ryan at lemnica.com
>> >
>> > www.lemnica.com
>> > www.esotericR.com
>> >
>> > R/Finance 2012: Applied Finance with R
>> > www.RinFinance.com
>> >
>> > See you in Chicago!!!!
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
>


From lunamoonmoon at gmail.com  Thu Feb 16 16:18:51 2012
From: lunamoonmoon at gmail.com (Luna)
Date: Thu, 16 Feb 2012 09:18:51 -0600
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CAAmySGNPDRn9f-JVn82Ua66vsEmbXwG2q-6oMVstcq_d7=uonQ@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
	<CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
	<CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>
	<CAAmySGNCig-FRYWqgvATc+GFZELOEkR8QASPEs87FM07XmQ=rg@mail.gmail.com>
	<CAPNjSFb-b8TyrSAsxHDZCy+H9_+emfqKk5KGJ5itcBwQ_sH5Mw@mail.gmail.com>
	<CAAmySGNPDRn9f-JVn82Ua66vsEmbXwG2q-6oMVstcq_d7=uonQ@mail.gmail.com>
Message-ID: <CAPNjSFbat-TWwd9L60_P_Zba7QqHGiKbDkmJy2ZHj6evdDzf4g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120216/9ebb556b/attachment.pl>

From michael.weylandt at gmail.com  Thu Feb 16 16:28:40 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 16 Feb 2012 10:28:40 -0500
Subject: [R-SIG-Finance] using findPeaks in designing railing-stops?
In-Reply-To: <CAPNjSFbat-TWwd9L60_P_Zba7QqHGiKbDkmJy2ZHj6evdDzf4g@mail.gmail.com>
References: <CAPNjSFb6Rzh4t7qxZXD5naCW_AdS6HY0xfgx_9-fEmYkT0Xv=Q@mail.gmail.com>
	<CAAmySGPUeGSti_ZKD3NjDq6KO-53yi+zqprd0Y-DdD1NumJjvQ@mail.gmail.com>
	<CABDUZc87fz2TmZ81xmiCNuKCQj1NUmiNsw2-urqtRf1eAgJWPA@mail.gmail.com>
	<CAAmySGNCig-FRYWqgvATc+GFZELOEkR8QASPEs87FM07XmQ=rg@mail.gmail.com>
	<CAPNjSFb-b8TyrSAsxHDZCy+H9_+emfqKk5KGJ5itcBwQ_sH5Mw@mail.gmail.com>
	<CAAmySGNPDRn9f-JVn82Ua66vsEmbXwG2q-6oMVstcq_d7=uonQ@mail.gmail.com>
	<CAPNjSFbat-TWwd9L60_P_Zba7QqHGiKbDkmJy2ZHj6evdDzf4g@mail.gmail.com>
Message-ID: <CAAmySGM=JphSfhnLwxFNgObyWsBhG8ZPog2XQUt8AW0mDyv6vg@mail.gmail.com>

No....perhaps you misunderstand what the "threshold" means? It means
the point of interest has to be x greater than its neighbor, not the
amount by which it has to exceed the valley. If you look in the
neighborhood of ~55:65 (the "next peak" on your graph) you'll see no
point is that far above its predecessor so there's no peak (so to
speak). Type findPeaks without parentheses and try to understand the
code used and the implicit definition of what a peak is. There's also
a lag convention you should be aware of.

What do you mean you cannot change the number 5?

Michael

On Thu, Feb 16, 2012 at 10:18 AM, Luna <lunamoonmoon at gmail.com> wrote:
> But using my eye from the plot it should have more local peaks?even with
> tolerance 5... no?
>
> I cannot change the number 5....
>
> On Thu, Feb 16, 2012 at 9:17 AM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>>
>> You'll get more if you lower your threshold value (the 5)
>>
>> Michael
>>
>> On Thu, Feb 16, 2012 at 10:13 AM, Luna <lunamoonmoon at gmail.com> wrote:
>> > Hi friends,
>> >
>> > Thanks for your help!
>> >
>> > I just did a new test:
>> >
>> > aa=100:1
>> > bb=sin(aa/3)
>> > cc=aa*bb
>> > plot(cc, type="l")
>> > p=findPeaks(cc, 5)
>> > points(p, cc[p])
>> > points(p, cc[p])
>> >
>> >>
>> >
>> > p
>> >
>> > [1] 3 22 41
>> >
>> >
>> >
>> > It only picks up 3 peaks, which is obviously wrong, am I correct?
>> >
>> > Thanks a lot!
>> >
>> > On Thu, Feb 9, 2012 at 9:55 PM, R. Michael Weylandt
>> > <michael.weylandt at gmail.com> wrote:
>> >>
>> >> Happy to follow procedure.
>> >>
>> >> Thanks for jumping on it so quickly.
>> >>
>> >> Michael Weylandt
>> >>
>> >> On Thu, Feb 9, 2012 at 10:40 PM, Jeffrey Ryan
>> >> <jeffrey.ryan at lemnica.com>
>> >> wrote:
>> >> > On Thu, Feb 9, 2012 at 9:00 PM, R. Michael Weylandt
>> >> > <michael.weylandt at gmail.com> wrote:
>> >> >> It looks like you need to wrap coredata() because some funny
>> >> >> arithmetic is happening when the xts-ness is preserved.
>> >> >>
>> >> >> e.g.
>> >> >>
>> >> >> findPeaks(coredata(Ad(SPY)), 5)
>> >> >>
>> >> >> But this is perhaps a less-than-desirable feature. I'll patch it and
>> >> >> send it to Josh.
>> >> >
>> >> > Proper procedure is indeed to blame Josh for all undesirable
>> >> > functionality, even in code he didn't write ;-)
>> >> >
>> >> > Patched in R-forge rev 577. Thanks.
>> >> >
>> >> > Jeff
>> >> >>
>> >> >> Michael
>> >> >>
>> >> >> On Thu, Feb 9, 2012 at 9:56 PM, Michael <comtech.usa at gmail.com>
>> >> >> wrote:
>> >> >>> ?Hi all,
>> >> >>>
>> >> >>> I am having trouble using the function "findPeaks":
>> >> >>>
>> >> >>> tickers="SPY"
>> >> >>>
>> >> >>> data *<-* new.env()
>> >> >>>
>> >> >>> getSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data,
>> >> >>> auto.assign = T)
>> >> >>>
>> >> >>> p=findPeaks(data$SPY[, 6], 5)
>> >> >>>
>> >> >>> plot(data$SPY[, 6], type="l")
>> >> >>>
>> >> >>> points(p, data$SPY[, 6][p])
>> >> >>>
>> >> >>> My goal is to implement a trailing-stop on a buy-and-hold strategy
>> >> >>> using
>> >> >>> findPeaks...
>> >> >>>
>> >> >>> I wanted to detect whenever SPY falls 5 points from the local
>> >> >>> peak...
>> >> >>>
>> >> >>> The above example failed in finding the peaks (p == NULL).
>> >> >>>
>> >> >>> Am I missing anything here?
>> >> >>>
>> >> >>> Thanks a lot!
>> >> >>>
>> >> >>> ? ? ? ?[[alternative HTML version deleted]]
>> >> >>>
>> >> >>> _______________________________________________
>> >> >>> R-SIG-Finance at r-project.org mailing list
>> >> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> >>> -- Subscriber-posting only. If you want to post, subscribe first.
>> >> >>> -- Also note that this is not the r-help list where general R
>> >> >>> questions should go.
>> >> >>
>> >> >> _______________________________________________
>> >> >> R-SIG-Finance at r-project.org mailing list
>> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> >> -- Subscriber-posting only. If you want to post, subscribe first.
>> >> >> -- Also note that this is not the r-help list where general R
>> >> >> questions
>> >> >> should go.
>> >> >
>> >> >
>> >> >
>> >> > --
>> >> > Jeffrey Ryan
>> >> > jeffrey.ryan at lemnica.com
>> >> >
>> >> > www.lemnica.com
>> >> > www.esotericR.com
>> >> >
>> >> > R/Finance 2012: Applied Finance with R
>> >> > www.RinFinance.com
>> >> >
>> >> > See you in Chicago!!!!
>> >>
>> >> _______________________________________________
>> >> R-SIG-Finance at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >> -- Subscriber-posting only. If you want to post, subscribe first.
>> >> -- Also note that this is not the r-help list where general R questions
>> >> should go.
>> >
>> >
>
>


From rharlow86 at gmail.com  Thu Feb 16 16:55:41 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Thu, 16 Feb 2012 10:55:41 -0500
Subject: [R-SIG-Finance] Efficient CVaR Scenario Optimization for a
 Large number of Scenarios
In-Reply-To: <CAHdfS97t8pucoZ6mO+Dh21C8ndHu_uU_h5ZknLpitWVgzgskpQ@mail.gmail.com>
References: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>
	<4F3C2DAD.8070601@4dscape.com>
	<CAHdfS97t8pucoZ6mO+Dh21C8ndHu_uU_h5ZknLpitWVgzgskpQ@mail.gmail.com>
Message-ID: <CAHdfS97u1NHa0D3pc5LT1iYK6aipoaaHT=wptHWkY3UuntpX-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120216/9f262238/attachment.pl>

From drseergio at gmail.com  Thu Feb 16 18:23:20 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Thu, 16 Feb 2012 09:23:20 -0800
Subject: [R-SIG-Finance] quantstrat executes trades that are more worth than
	total equity
Message-ID: <CAEGu7FvDow+i_WirO9fU9fB4zJqf81dc0e2hg8owAcBch3avLw@mail.gmail.com>

Hi R programmers,

I am seeing strange behavior with quanstrat transactions. The problem
is that it triggers orders that are larger than the total equity. For
example, if I create an account with initial equity of 100 000 I see
that rules that exceed the total equity are still executed and
reported.

Is this the intended behavior? Do I need to write my own sizing
function which will take care of this?

To reproduce this I have set "maxpos" to very high value which cannot
be successfully executed with available equity (100000). The
"add.rule" and related parts of the code:

...
initPortf('p', symbols=watched, currency=curr, initDate=from)
initAcct(name='a', portfolios='p', initEq=equity, currency=curr, initDate=from)
initOrders(portfolio='p', symbols=watched, initDate=from)
...

s <- add.rule(strategy=s, name='ruleSignal',
arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
orderqty=100000, ordertype='market', orderside=NULL, threshold=NULL,
osFUN='osMaxPos', ruletype='enter'), type='enter', path.dep=TRUE)

for (symbol in symbols) {
  ubars    <- getSymbols(symbol, src='yahoo', auto.assign=FALSE)
  bars     <- ubars[index(ubars) >= as.Date(from)]
  assign(symbol, bars)
  addPosLimit(portfolio='p', symbol, from, maxpos=100000)
}

applyStrategy(strategy='s', portfolios='p')
updatePortf(Portfolio='p')
updateAcct('a')

The R output for getTxns:
> getTxns(Portfolio='p', Symbol='BP')
           Txn.Qty Txn.Price Txn.Fees Txn.Value Txn.Avg.Cost
2009-01-01   0e+00      0.00        0         0         0.00
2010-07-08   1e+05     33.74        0   3374000        33.74
           Net.Txn.Realized.PL
2009-01-01                   0
2010-07-08                   0

I have attached the whole runnable sample script to this e-mail. I
have removed all the code which is not relevant to the issue.

--
Kind Regards,
Sergey Pisarenko.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tainted.R
Type: application/octet-stream
Size: 1985 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120216/adea2f80/attachment.obj>

From alexios at 4dscape.com  Thu Feb 16 18:55:26 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Thu, 16 Feb 2012 17:55:26 +0000
Subject: [R-SIG-Finance] Efficient CVaR Scenario Optimization for a
 Large number of Scenarios
In-Reply-To: <CAHdfS97u1NHa0D3pc5LT1iYK6aipoaaHT=wptHWkY3UuntpX-g@mail.gmail.com>
References: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>
	<4F3C2DAD.8070601@4dscape.com>
	<CAHdfS97t8pucoZ6mO+Dh21C8ndHu_uU_h5ZknLpitWVgzgskpQ@mail.gmail.com>
	<CAHdfS97u1NHa0D3pc5LT1iYK6aipoaaHT=wptHWkY3UuntpX-g@mail.gmail.com>
Message-ID: <4F3D430E.6060402@4dscape.com>

Not sure but this sounds to me like the Lower Partial Moment problem 
(but i could be mistaken)...if it is, you should read up on the 
literature on this measure as it has been extensively covered (for the 
problem of the partial moment to the power 1 there is an LP 
representation, for the power 2 a QP representation, and for the rest or 
general LPM problem you can definitely represent it as a proper NLP).

Regards,
Alexios

On 16/02/2012 15:55, Robert Harlow wrote:
> Alexios,
>     I have one more question on this topic.  With CVaR, one generally
> knows the percentile, and then has to find the quantile that that
> percentile corresponds to (VaR). Suppose that my objective function is
> slightly different.  In the following case, I have a fixed hurdle
> return, and I would like to minimize the average return that is less
> than that hurdle return multiplied by the likelihood of having a return
> that is lower than the hurdle.  Basically, this is just the expected
> value of the return from -Inf to the hurdle (rather than -Inf to
> positive Inf for the total expected value).  This seems like it should
> be an easier problem to solve than the CVaR one, but for some reason I
> find it difficult.  Is there a better way to write my objective function
> (cvarStar) such that it nicely follows the process you already laid out
> in the CVaR case?
> Thanks again,
> -Bob
>
>   library(mvtnorm)
> mu <- c(.04, .06, .1)
> sig <- c(.04, .09, .2)
> cor.mat <- rbind(c( 1, .6, .2),
>                  c(.6, 1, .1),
>                  c(.2, .1, 1)
>                  )
> v.cov <- sig%o%sig*cor.mat
> set.seed(100)
> n <- 1000
> samps <- rmvnorm(n, mean = mu, sigma = v.cov)
> cvarStar <- function(w, samps, hurd){
>      z <- samps %*%w
>      tail.v <- z[z<=hurd]
>      if(length(tail.v) == 0) tail.v <- 0
>      -(length(tail.v)/length(z))*mean(tail.v)
> }
> cvarStar(rep(1/3,3), samps, -.05)
>
> On Wed, Feb 15, 2012 at 6:01 PM, Robert Harlow <rharlow86 at gmail.com
> <mailto:rharlow86 at gmail.com>> wrote:
>
>     Wow, this is fantastic Alexios.  Thank you very much.
>     -Bob
>
>
>     On Wed, Feb 15, 2012 at 5:11 PM, alexios <alexios at 4dscape.com
>     <mailto:alexios at 4dscape.com>> wrote:
>
>         Hi Bob,
>
>         There is a way to work with nonlinear solvers to solve this type
>         of problem (without resorting to expensive global optimization
>         approaches), once you work out the derivatives and decide on how
>         to deal with the min/max type functions so that the problem is
>         'made convex'.
>
>         A complete example follows:
>
>         # We work with a smooth approximation to the max function:
>         epsilon = 1e-8
>
>         .max.smooth = function(x)
>         {
>                 (sqrt(x*x + epsilon ) + x) / 2
>         }
>
>         # the objective function (CVaR)
>         func.cvar = function(w, Data, alpha, mu, rmin)
>         {
>                 # we reverse the sign since we are minimizing
>                 -w[1] + mean( .max.smooth(w[1] - Data %*% w[-1]) )/alpha
>         }
>
>         # the gradient of the objective function
>         grad.cvar = function(w, Data, alpha, mu, rmin)
>         {
>                 epsilon2 = epsilon^2
>                 m = length(w)
>                 N = dim(Data)[1]
>                 g = vector(mode = "numeric", length = m)
>                 port = Data %*% w[-1]
>                 # first the derivative wrt to VaR
>                 g[1] = ( sum( ( port - w[1] )/( 2*N * sqrt( epsilon2 + (
>         port - w[1] )^2 ) ) ) - 0.5 )/alpha + 1
>                 for(i in 2:m){
>                         g[i] =  ( sum(Data[,i-1]/(2*N)) - sum(
>         (Data[,i-1] * ( port - w[1]) )/( ( 2*N ) * (epsilon2 + ( port -
>         w[1] )^2 )^0.5 ) ) )/alpha
>                 }
>                 # reverse the sign since we are minimizing
>                 return(-1 * g)
>         }
>
>         # the budget constraint:
>         func.eq = function(w, Data, alpha, mu, rmin){
>                 sum(w[-1]) - 1
>         }
>         # gradient of equality
>         grad.eq = function(w, Data, alpha, mu, rmin){
>                 m = length(w)-1
>                 return( matrix(c(0, rep(1, m)), ncol = m+1, nrow = 1) )
>         }
>
>         # Your inequality (weighted forecast >= rmin)
>         # but the solver we will use, sets: g(x) <= 0
>         # so we set: (rmin - weighted forecast) <= 0
>         func.ineq = function(w, Data, alpha, mu, rmin){
>                 wM = sum( mu * w[-1] )
>                 return( rmin - wM )
>         }
>         # gradient inequality
>         grad.ineq = function(w, Data, alpha, mu, rmin){
>                 m = length(w)
>                 Mu = matrix( c(0, mu), ncol = m )
>                 return(-Mu)
>         }
>
>
>         ## Main Program Example (replicating your data)
>
>         library(mvtnorm)
>         mu <- c(.04, .06, .1)
>         sig <- c(.04, .09, .2)
>         cor.mat <- rbind(c( 1, .6, .2),
>                          c(.6, 1, .1),
>                          c(.2, .1, 1)
>                          )
>         v.cov <- sig%o%sig*cor.mat
>         set.seed(100)
>         n <- 10000
>
>         samps <- rmvnorm(n, mean = mu, sigma = v.cov)
>         rmin = .08
>         alpha = 0.05
>         wmin = 0
>         wmax = 1
>
>         # I am going to use the nloptr solver (get it from CRAN)
>         library(nloptr)
>
>         .slsqp.ctrl = function(control = list())
>         {
>                 ctrl = list()
>                 ctrl$algorithm = "NLOPT_LD_SLSQP"
>                 if( is.null(control$ftol_rel) ) ctrl$ftol_rel = 1e-12
>         else ctrl$ftol_rel = control$ftol_rel
>                 if( is.null(control$xtol_rel) ) ctrl$xtol_rel = 1e-10
>         else ctrl$xtol_rel = control$xtol_rel
>                 if( is.null(control$maxeval) ) ctrl$maxeval = 5000 else
>           ctrl$maxeval = as.integer( control$maxeval )
>                 if( is.null(control$maxtime) ) ctrl$maxtime = 10000 else
>           ctrl$maxtime = control$maxtime
>                 if( is.null(control$print_level) ) ctrl$print_level =0
>         else ctrl$print_level = as.integer( control$print_level )
>                 if( is.null(control$local_opts$__algorithm) )
>         ctrl$local_opts$algorithm = "NLOPT_LD_MMA"
>                 if( is.null(control$local_opts$__ftol_rel) )
>         ctrl$local_opts$ftol_rel = 1e-12 else  ctrl$local_opts$ftol_rel
>         = control$local_opts$ftol_rel
>                 if( is.null(control$local_opts$__xtol_rel) )
>         ctrl$local_opts$xtol_rel = 1e-10 else  ctrl$local_opts$xtol_rel
>         = control$local_opts$xtol_rel
>                 if( is.null(control$local_opts$__print_level) )
>         ctrl$local_opts$print_level = 0 else
>           ctrl$local_opts$print_level = as.integer(
>         control$local_opts$print_level )
>                 return(ctrl)
>         }
>
>         # set control parameters and subsolvers (use SQP)
>         ctrl = .slsqp.ctrl(control = list())
>
>         # set starting values
>         q1 = quantile(samps %*% rep(1/3,3), alpha)
>         # we are estimating [VaR AND the weights]
>         sol = nloptr(
>         x0 = c(q1,rep(1/3,3)),
>         eval_f = func.cvar,
>         eval_grad_f = grad.cvar,
>         lb = c(-1, rep( wmin, 3) ),
>         ub = c( 0, rep( wmax, 3) ),
>         opts = ctrl,
>         eval_g_ineq = func.ineq,
>         eval_jac_g_ineq = grad.ineq,
>         eval_g_eq = func.eq,
>         eval_jac_g_eq = grad.eq,
>         Data = samps, alpha = 0.05, mu = colMeans(samps), rmin = 0.08)
>
>         # [VaR w1 w2 w3]
>         # nloptr[-0.1125099 1.104523e-14 0.480181 0.519819]
>         # glpk[0.1125283 0.000000 0.480181 0.519819]
>         # end example
>
>         HTH.
>
>         Regards,
>
>         Alexios
>
>
>
>
>
>         On 15/02/2012 21:05, Robert Harlow wrote:
>
>             Hi,
>                 I am running into a memory issue when I try to run a
>             mean-CVaR
>             optimization on a large number of scenarios.  I am running R
>             32-bit on
>             windows (see sessionInfo() output below).  I have attached
>             code to display
>             the problem below (using a sample from a random
>             multi-variate normal
>             distribution as an example, though that is not what I am
>             actually doing.)
>             I am using the methodology proposed by Uryasev (thanks to
>               Guy Yollin for
>             the cvarOpt function) to formulate the problem as an LP.
>               When I have a
>             small number of asset classes, I can arrive at good (though
>             sometimes non
>             "optimal" for a given set of scenarios) solutions using
>             different
>             optimizers (DEoptim, BBoptim, Rsolnp) where I don't run into
>             the scenario
>             size constraint.  However, when I increase the number of
>             asset classes, the
>             non-LP solvers do a worse and worse job of finding a stable
>             "global"
>             optimum, with the exception of DEoptim which will arrive at
>             a good
>             solution, but will take a very long time for, say, 25 asset
>             classes and
>             10,000 scenarios.  The LP, on the other hand, seems much
>             more sensitive to
>             number of scenarios than to the number of asset classes.
>             Thanks in advance,
>             -Bob
>
>             ## Code
>             library(Rglpk)
>             library(mvtnorm)
>             mu<- c(.04, .06, .1)
>             sig<- c(.04, .09, .2)
>             cor.mat<- rbind(c( 1, .6, .2),
>                               c(.6, 1, .1),
>                               c(.2, .1, 1)
>                               )
>             v.cov<- sig%o%sig*cor.mat
>             set.seed(100)
>             n<- 1000 ##works
>             n<- 10000##doesn't work due to memory error
>             samps<- rmvnorm(n, mean = mu, sigma = v.cov)
>             cvarOpt<- function(rmat, alpha = .05, rmin = .05, wmin = 0,
>             wmax = 1,
>             weight.sum =1){
>                  nAss = ncol(rmat) # number of assets
>                  s = nrow(rmat) # number of scenarios i.e. periods
>                  averet = colMeans(rmat)
>                  ##create objective vector, constraint matrix,
>             constraint rhs
>                  Amat =
>             rbind(cbind(rbind(1,averet),__matrix(data=0,nrow=2,ncol=s+1)__),cbind(rmat,diag(s),1))
>
>                  objL = c(rep(0,nAss), rep(-1/(alpha*s), s), -1)
>                  bvec = c(weight.sum,rmin,rep(0,s))
>                  ##direction vector
>                  dir.vec = c("==",">=",rep(">=",s))
>                  ##bounds on weights
>                  bounds = list(lower = list(ind = 1:nAss, val =
>             rep(wmin,nAss)),upper =
>             list(ind = 1:nAss, val = rep(wmax,nAss)))
>                  res = Rglpk_solve_LP(obj=objL, mat=Amat, dir=dir.vec,
>             rhs=bvec,
>             types=rep("C",length(objL)), max=T, bounds=bounds)
>                  w = as.numeric(res$solution[1:__nAss])
>                  return(list(w=w,status=res$__status))
>             }
>             ans.cvar<- cvarOpt(rmat = samps, rmin = .08)
>
>             ## session info
>
>             R version 2.13.2 (2011-09-30)
>             Platform: i386-pc-mingw32/i386 (32-bit)
>
>             locale:
>             [1] LC_COLLATE=English_United States.1252
>             [2] LC_CTYPE=English_United States.1252
>             [3] LC_MONETARY=English_United States.1252
>             [4] LC_NUMERIC=C
>             [5] LC_TIME=English_United States.1252
>
>             attached base packages:
>             [1] stats     graphics  grDevices utils     datasets
>               methods   base
>
>             other attached packages:
>             [1] mvtnorm_0.9-9991 Rglpk_0.3-5      slam_0.1-22
>
>             loaded via a namespace (and not attached):
>             [1] tools_2.13.2
>
>                     [[alternative HTML version deleted]]
>
>             _________________________________________________
>             R-SIG-Finance at r-project.org
>             <mailto:R-SIG-Finance at r-project.org> mailing list
>             https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>             <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>             -- Subscriber-posting only. If you want to post, subscribe
>             first.
>             -- Also note that this is not the r-help list where general
>             R questions should go.
>
>
>
>


From brian at braverock.com  Thu Feb 16 19:25:41 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 16 Feb 2012 12:25:41 -0600
Subject: [R-SIG-Finance] quantstrat executes trades that are more worth
 than total equity
In-Reply-To: <CAEGu7FvDow+i_WirO9fU9fB4zJqf81dc0e2hg8owAcBch3avLw@mail.gmail.com>
References: <CAEGu7FvDow+i_WirO9fU9fB4zJqf81dc0e2hg8owAcBch3avLw@mail.gmail.com>
Message-ID: <1329416741.8901.60.camel@brian-rcg>

On Thu, 2012-02-16 at 09:23 -0800, Sergey Pisarenko wrote:
> Hi R programmers,
> 
> I am seeing strange behavior with quanstrat transactions. The problem
> is that it triggers orders that are larger than the total equity. For
> example, if I create an account with initial equity of 100 000 I see
> that rules that exceed the total equity are still executed and
> reported.
> 
> Is this the intended behavior? Do I need to write my own sizing
> function which will take care of this?

Yes.

Most institutional and many personal trading accounts use leverage.

See Guy Yollin's UW lecture slides for an example of equity-aware order sizing rules. Your order sizing function will likely be different, of course.

When I get a chance I will try to add more information to the
documentation to make this more clear.

> I have attached the whole runnable sample script to this e-mail. I
> have removed all the code which is not relevant to the issue.

THANK YOU for providing reproducible code.  It makes the task of
understanding a questions, debugging a problem, and communicating from
the same position so much easier.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From drseergio at gmail.com  Thu Feb 16 20:22:53 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Thu, 16 Feb 2012 11:22:53 -0800
Subject: [R-SIG-Finance] quantstrat executes trades that are more worth
 than total equity
In-Reply-To: <1329416741.8901.60.camel@brian-rcg>
References: <CAEGu7FvDow+i_WirO9fU9fB4zJqf81dc0e2hg8owAcBch3avLw@mail.gmail.com>
	<1329416741.8901.60.camel@brian-rcg>
Message-ID: <CAEGu7FuY5x4SqJmmD189BN+=Cd0op1eGpPkaKaoz-TEaWKHF9w@mail.gmail.com>

Thank you, Brian. I have read Guy Yollin's lecture yesterday and found
them really useful. I recall seeing the sizing function that
calculated trade size based on current equity. I will use a similar
approach in my custom sizing function.

/Sergey

On Thu, Feb 16, 2012 at 10:25 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Thu, 2012-02-16 at 09:23 -0800, Sergey Pisarenko wrote:
>> Hi R programmers,
>>
>> I am seeing strange behavior with quanstrat transactions. The problem
>> is that it triggers orders that are larger than the total equity. For
>> example, if I create an account with initial equity of 100 000 I see
>> that rules that exceed the total equity are still executed and
>> reported.
>>
>> Is this the intended behavior? Do I need to write my own sizing
>> function which will take care of this?
>
> Yes.
>
> Most institutional and many personal trading accounts use leverage.
>
> See Guy Yollin's UW lecture slides for an example of equity-aware order sizing rules. Your order sizing function will likely be different, of course.
>
> When I get a chance I will try to add more information to the
> documentation to make this more clear.
>
>> I have attached the whole runnable sample script to this e-mail. I
>> have removed all the code which is not relevant to the issue.
>
> THANK YOU for providing reproducible code. ?It makes the task of
> understanding a questions, debugging a problem, and communicating from
> the same position so much easier.
>
> Regards,
>
> ? - Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>


From rharlow86 at gmail.com  Fri Feb 17 02:00:33 2012
From: rharlow86 at gmail.com (Robert Harlow)
Date: Thu, 16 Feb 2012 20:00:33 -0500
Subject: [R-SIG-Finance] Efficient CVaR Scenario Optimization for a
	Large number of Scenarios
In-Reply-To: <4F3D430E.6060402@4dscape.com>
References: <CAHdfS97sZWB2S-EMqnNe3GpAfe_y9_8JnoFdRSurffEzVZ0DSw@mail.gmail.com>
	<4F3C2DAD.8070601@4dscape.com>
	<CAHdfS97t8pucoZ6mO+Dh21C8ndHu_uU_h5ZknLpitWVgzgskpQ@mail.gmail.com>
	<CAHdfS97u1NHa0D3pc5LT1iYK6aipoaaHT=wptHWkY3UuntpX-g@mail.gmail.com>
	<4F3D430E.6060402@4dscape.com>
Message-ID: <6272EDDF-EC37-45D6-921B-80B2313737ED@gmail.com>

Great- Thanks again for all of your help



On Feb 16, 2012, at 12:55 PM, alexios ghalanos <alexios at 4dscape.com> wrote:

> Not sure but this sounds to me like the Lower Partial Moment problem (but i could be mistaken)...if it is, you should read up on the literature on this measure as it has been extensively covered (for the problem of the partial moment to the power 1 there is an LP representation, for the power 2 a QP representation, and for the rest or general LPM problem you can definitely represent it as a proper NLP).
> 
> Regards,
> Alexios
> 
> On 16/02/2012 15:55, Robert Harlow wrote:
>> Alexios,
>>    I have one more question on this topic.  With CVaR, one generally
>> knows the percentile, and then has to find the quantile that that
>> percentile corresponds to (VaR). Suppose that my objective function is
>> slightly different.  In the following case, I have a fixed hurdle
>> return, and I would like to minimize the average return that is less
>> than that hurdle return multiplied by the likelihood of having a return
>> that is lower than the hurdle.  Basically, this is just the expected
>> value of the return from -Inf to the hurdle (rather than -Inf to
>> positive Inf for the total expected value).  This seems like it should
>> be an easier problem to solve than the CVaR one, but for some reason I
>> find it difficult.  Is there a better way to write my objective function
>> (cvarStar) such that it nicely follows the process you already laid out
>> in the CVaR case?
>> Thanks again,
>> -Bob
>> 
>>  library(mvtnorm)
>> mu <- c(.04, .06, .1)
>> sig <- c(.04, .09, .2)
>> cor.mat <- rbind(c( 1, .6, .2),
>>                 c(.6, 1, .1),
>>                 c(.2, .1, 1)
>>                 )
>> v.cov <- sig%o%sig*cor.mat
>> set.seed(100)
>> n <- 1000
>> samps <- rmvnorm(n, mean = mu, sigma = v.cov)
>> cvarStar <- function(w, samps, hurd){
>>     z <- samps %*%w
>>     tail.v <- z[z<=hurd]
>>     if(length(tail.v) == 0) tail.v <- 0
>>     -(length(tail.v)/length(z))*mean(tail.v)
>> }
>> cvarStar(rep(1/3,3), samps, -.05)
>> 
>> On Wed, Feb 15, 2012 at 6:01 PM, Robert Harlow <rharlow86 at gmail.com
>> <mailto:rharlow86 at gmail.com>> wrote:
>> 
>>    Wow, this is fantastic Alexios.  Thank you very much.
>>    -Bob
>> 
>> 
>>    On Wed, Feb 15, 2012 at 5:11 PM, alexios <alexios at 4dscape.com
>>    <mailto:alexios at 4dscape.com>> wrote:
>> 
>>        Hi Bob,
>> 
>>        There is a way to work with nonlinear solvers to solve this type
>>        of problem (without resorting to expensive global optimization
>>        approaches), once you work out the derivatives and decide on how
>>        to deal with the min/max type functions so that the problem is
>>        'made convex'.
>> 
>>        A complete example follows:
>> 
>>        # We work with a smooth approximation to the max function:
>>        epsilon = 1e-8
>> 
>>        .max.smooth = function(x)
>>        {
>>                (sqrt(x*x + epsilon ) + x) / 2
>>        }
>> 
>>        # the objective function (CVaR)
>>        func.cvar = function(w, Data, alpha, mu, rmin)
>>        {
>>                # we reverse the sign since we are minimizing
>>                -w[1] + mean( .max.smooth(w[1] - Data %*% w[-1]) )/alpha
>>        }
>> 
>>        # the gradient of the objective function
>>        grad.cvar = function(w, Data, alpha, mu, rmin)
>>        {
>>                epsilon2 = epsilon^2
>>                m = length(w)
>>                N = dim(Data)[1]
>>                g = vector(mode = "numeric", length = m)
>>                port = Data %*% w[-1]
>>                # first the derivative wrt to VaR
>>                g[1] = ( sum( ( port - w[1] )/( 2*N * sqrt( epsilon2 + (
>>        port - w[1] )^2 ) ) ) - 0.5 )/alpha + 1
>>                for(i in 2:m){
>>                        g[i] =  ( sum(Data[,i-1]/(2*N)) - sum(
>>        (Data[,i-1] * ( port - w[1]) )/( ( 2*N ) * (epsilon2 + ( port -
>>        w[1] )^2 )^0.5 ) ) )/alpha
>>                }
>>                # reverse the sign since we are minimizing
>>                return(-1 * g)
>>        }
>> 
>>        # the budget constraint:
>>        func.eq = function(w, Data, alpha, mu, rmin){
>>                sum(w[-1]) - 1
>>        }
>>        # gradient of equality
>>        grad.eq = function(w, Data, alpha, mu, rmin){
>>                m = length(w)-1
>>                return( matrix(c(0, rep(1, m)), ncol = m+1, nrow = 1) )
>>        }
>> 
>>        # Your inequality (weighted forecast >= rmin)
>>        # but the solver we will use, sets: g(x) <= 0
>>        # so we set: (rmin - weighted forecast) <= 0
>>        func.ineq = function(w, Data, alpha, mu, rmin){
>>                wM = sum( mu * w[-1] )
>>                return( rmin - wM )
>>        }
>>        # gradient inequality
>>        grad.ineq = function(w, Data, alpha, mu, rmin){
>>                m = length(w)
>>                Mu = matrix( c(0, mu), ncol = m )
>>                return(-Mu)
>>        }
>> 
>> 
>>        ## Main Program Example (replicating your data)
>> 
>>        library(mvtnorm)
>>        mu <- c(.04, .06, .1)
>>        sig <- c(.04, .09, .2)
>>        cor.mat <- rbind(c( 1, .6, .2),
>>                         c(.6, 1, .1),
>>                         c(.2, .1, 1)
>>                         )
>>        v.cov <- sig%o%sig*cor.mat
>>        set.seed(100)
>>        n <- 10000
>> 
>>        samps <- rmvnorm(n, mean = mu, sigma = v.cov)
>>        rmin = .08
>>        alpha = 0.05
>>        wmin = 0
>>        wmax = 1
>> 
>>        # I am going to use the nloptr solver (get it from CRAN)
>>        library(nloptr)
>> 
>>        .slsqp.ctrl = function(control = list())
>>        {
>>                ctrl = list()
>>                ctrl$algorithm = "NLOPT_LD_SLSQP"
>>                if( is.null(control$ftol_rel) ) ctrl$ftol_rel = 1e-12
>>        else ctrl$ftol_rel = control$ftol_rel
>>                if( is.null(control$xtol_rel) ) ctrl$xtol_rel = 1e-10
>>        else ctrl$xtol_rel = control$xtol_rel
>>                if( is.null(control$maxeval) ) ctrl$maxeval = 5000 else
>>          ctrl$maxeval = as.integer( control$maxeval )
>>                if( is.null(control$maxtime) ) ctrl$maxtime = 10000 else
>>          ctrl$maxtime = control$maxtime
>>                if( is.null(control$print_level) ) ctrl$print_level =0
>>        else ctrl$print_level = as.integer( control$print_level )
>>                if( is.null(control$local_opts$__algorithm) )
>>        ctrl$local_opts$algorithm = "NLOPT_LD_MMA"
>>                if( is.null(control$local_opts$__ftol_rel) )
>>        ctrl$local_opts$ftol_rel = 1e-12 else  ctrl$local_opts$ftol_rel
>>        = control$local_opts$ftol_rel
>>                if( is.null(control$local_opts$__xtol_rel) )
>>        ctrl$local_opts$xtol_rel = 1e-10 else  ctrl$local_opts$xtol_rel
>>        = control$local_opts$xtol_rel
>>                if( is.null(control$local_opts$__print_level) )
>>        ctrl$local_opts$print_level = 0 else
>>          ctrl$local_opts$print_level = as.integer(
>>        control$local_opts$print_level )
>>                return(ctrl)
>>        }
>> 
>>        # set control parameters and subsolvers (use SQP)
>>        ctrl = .slsqp.ctrl(control = list())
>> 
>>        # set starting values
>>        q1 = quantile(samps %*% rep(1/3,3), alpha)
>>        # we are estimating [VaR AND the weights]
>>        sol = nloptr(
>>        x0 = c(q1,rep(1/3,3)),
>>        eval_f = func.cvar,
>>        eval_grad_f = grad.cvar,
>>        lb = c(-1, rep( wmin, 3) ),
>>        ub = c( 0, rep( wmax, 3) ),
>>        opts = ctrl,
>>        eval_g_ineq = func.ineq,
>>        eval_jac_g_ineq = grad.ineq,
>>        eval_g_eq = func.eq,
>>        eval_jac_g_eq = grad.eq,
>>        Data = samps, alpha = 0.05, mu = colMeans(samps), rmin = 0.08)
>> 
>>        # [VaR w1 w2 w3]
>>        # nloptr[-0.1125099 1.104523e-14 0.480181 0.519819]
>>        # glpk[0.1125283 0.000000 0.480181 0.519819]
>>        # end example
>> 
>>        HTH.
>> 
>>        Regards,
>> 
>>        Alexios
>> 
>> 
>> 
>> 
>> 
>>        On 15/02/2012 21:05, Robert Harlow wrote:
>> 
>>            Hi,
>>                I am running into a memory issue when I try to run a
>>            mean-CVaR
>>            optimization on a large number of scenarios.  I am running R
>>            32-bit on
>>            windows (see sessionInfo() output below).  I have attached
>>            code to display
>>            the problem below (using a sample from a random
>>            multi-variate normal
>>            distribution as an example, though that is not what I am
>>            actually doing.)
>>            I am using the methodology proposed by Uryasev (thanks to
>>              Guy Yollin for
>>            the cvarOpt function) to formulate the problem as an LP.
>>              When I have a
>>            small number of asset classes, I can arrive at good (though
>>            sometimes non
>>            "optimal" for a given set of scenarios) solutions using
>>            different
>>            optimizers (DEoptim, BBoptim, Rsolnp) where I don't run into
>>            the scenario
>>            size constraint.  However, when I increase the number of
>>            asset classes, the
>>            non-LP solvers do a worse and worse job of finding a stable
>>            "global"
>>            optimum, with the exception of DEoptim which will arrive at
>>            a good
>>            solution, but will take a very long time for, say, 25 asset
>>            classes and
>>            10,000 scenarios.  The LP, on the other hand, seems much
>>            more sensitive to
>>            number of scenarios than to the number of asset classes.
>>            Thanks in advance,
>>            -Bob
>> 
>>            ## Code
>>            library(Rglpk)
>>            library(mvtnorm)
>>            mu<- c(.04, .06, .1)
>>            sig<- c(.04, .09, .2)
>>            cor.mat<- rbind(c( 1, .6, .2),
>>                              c(.6, 1, .1),
>>                              c(.2, .1, 1)
>>                              )
>>            v.cov<- sig%o%sig*cor.mat
>>            set.seed(100)
>>            n<- 1000 ##works
>>            n<- 10000##doesn't work due to memory error
>>            samps<- rmvnorm(n, mean = mu, sigma = v.cov)
>>            cvarOpt<- function(rmat, alpha = .05, rmin = .05, wmin = 0,
>>            wmax = 1,
>>            weight.sum =1){
>>                 nAss = ncol(rmat) # number of assets
>>                 s = nrow(rmat) # number of scenarios i.e. periods
>>                 averet = colMeans(rmat)
>>                 ##create objective vector, constraint matrix,
>>            constraint rhs
>>                 Amat =
>>            rbind(cbind(rbind(1,averet),__matrix(data=0,nrow=2,ncol=s+1)__),cbind(rmat,diag(s),1))
>> 
>>                 objL = c(rep(0,nAss), rep(-1/(alpha*s), s), -1)
>>                 bvec = c(weight.sum,rmin,rep(0,s))
>>                 ##direction vector
>>                 dir.vec = c("==",">=",rep(">=",s))
>>                 ##bounds on weights
>>                 bounds = list(lower = list(ind = 1:nAss, val =
>>            rep(wmin,nAss)),upper =
>>            list(ind = 1:nAss, val = rep(wmax,nAss)))
>>                 res = Rglpk_solve_LP(obj=objL, mat=Amat, dir=dir.vec,
>>            rhs=bvec,
>>            types=rep("C",length(objL)), max=T, bounds=bounds)
>>                 w = as.numeric(res$solution[1:__nAss])
>>                 return(list(w=w,status=res$__status))
>>            }
>>            ans.cvar<- cvarOpt(rmat = samps, rmin = .08)
>> 
>>            ## session info
>> 
>>            R version 2.13.2 (2011-09-30)
>>            Platform: i386-pc-mingw32/i386 (32-bit)
>> 
>>            locale:
>>            [1] LC_COLLATE=English_United States.1252
>>            [2] LC_CTYPE=English_United States.1252
>>            [3] LC_MONETARY=English_United States.1252
>>            [4] LC_NUMERIC=C
>>            [5] LC_TIME=English_United States.1252
>> 
>>            attached base packages:
>>            [1] stats     graphics  grDevices utils     datasets
>>              methods   base
>> 
>>            other attached packages:
>>            [1] mvtnorm_0.9-9991 Rglpk_0.3-5      slam_0.1-22
>> 
>>            loaded via a namespace (and not attached):
>>            [1] tools_2.13.2
>> 
>>                    [[alternative HTML version deleted]]
>> 
>>            _________________________________________________
>>            R-SIG-Finance at r-project.org
>>            <mailto:R-SIG-Finance at r-project.org> mailing list
>>            https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>>            <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>>            -- Subscriber-posting only. If you want to post, subscribe
>>            first.
>>            -- Also note that this is not the r-help list where general
>>            R questions should go.
>> 
>> 
>> 
>> 
> 


From sunduck at gmail.com  Fri Feb 17 13:15:51 2012
From: sunduck at gmail.com (Alex Bird)
Date: Fri, 17 Feb 2012 16:15:51 +0400
Subject: [R-SIG-Finance] HF strategy style change detection based on txn data
Message-ID: <CAJ3qPLD30=GJorHOAJ+=y1oXkgVY7UXO5GcSdVBSsLfxayg7OQ@mail.gmail.com>

Hi there!

  I have a problem described in short below but don't know where to start from.
  If you have any ideas about possible solutions could you please
point me to some working papers, R packages or your thoughts.

  The problem is as follows: let's suppose there's some high frequency
trading strategy with long enough track record for which I have all
the transactions data (trades, fees, additions/withdrawals, etc) and
where I would like to test a null hypothesis of at least one trading
style change during the strategy lifetime. The style change here is
defined in a broad manner and can mean almost anything like execution
change, trading frequency change, change of mutual dynamics between
traded instruments, money management style change, etc.
  From top-down point of view I would like to solve a fund of funds
problem, i.e. hiring asset managers who come with their pr?t-?-porter
strategies but with some hidden risks which I intend to reveal.

  The only solution I see for the time being is to try to apply a
price discovery techniques which intend to find a mapping functions of
txn data to actual return earned and then track stability of the
models parameters for a structural breaks.

Thanks in advance for any help!

Kind regards,
Alex


From brian at braverock.com  Fri Feb 17 13:55:00 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 17 Feb 2012 06:55:00 -0600
Subject: [R-SIG-Finance] HF strategy style change detection based on txn
 data
In-Reply-To: <CAJ3qPLD30=GJorHOAJ+=y1oXkgVY7UXO5GcSdVBSsLfxayg7OQ@mail.gmail.com>
References: <CAJ3qPLD30=GJorHOAJ+=y1oXkgVY7UXO5GcSdVBSsLfxayg7OQ@mail.gmail.com>
Message-ID: <1329483300.8901.84.camel@brian-rcg>

On Fri, 2012-02-17 at 16:15 +0400, Alex Bird wrote:
> Hi there!
> 
>   I have a problem described in short below but don't know where to start from.
>   If you have any ideas about possible solutions could you please
> point me to some working papers, R packages or your thoughts.
> 
>   The problem is as follows: let's suppose there's some high frequency
> trading strategy with long enough track record for which I have all
> the transactions data (trades, fees, additions/withdrawals, etc) and
> where I would like to test a null hypothesis of at least one trading
> style change during the strategy lifetime. The style change here is
> defined in a broad manner and can mean almost anything like execution
> change, trading frequency change, change of mutual dynamics between
> traded instruments, money management style change, etc.
>   From top-down point of view I would like to solve a fund of funds
> problem, i.e. hiring asset managers who come with their pr?t-?-porter
> strategies but with some hidden risks which I intend to reveal.
> 
>   The only solution I see for the time being is to try to apply a
> price discovery techniques which intend to find a mapping functions of
> txn data to actual return earned and then track stability of the
> models parameters for a structural breaks.
> 
> Thanks in advance for any help!

I think you're mixing a couple of ideas up together here.  Not that that
mixing is a bad idea in and of itself, but that it will likely not help
you find resources to solve your problem.

In the first case, analyzing a strategy transaction (or return) track
record for shifts in style, there is a literature, broadly cited in the
ttrTests package, for analyzing trading decisions to separate 'luck'
from skill[1].  Pat Burns has also written pretty extensively on this
topic[2].

In the second case, actual 'style analysis' for manager returns has been
covered in the literature by everyone from Sharpe on down the road.
I'll broadly categorize these style analysis approaches as falling into
two main classes.  

The first is 'factor analysis', where you fit mutliple observed market
factors onto the manager, and monitor their factor exposures for change
over time, which likely signifies some sort of shift in investing
strategy or style.  See, for example, R-Forge package factorAnalytics[3]
or Eric Zivot's related seminar presentation from the 2011 R/Finance
conference [4] or his 2009 presetnation at [5].

The second main category is that of detecting so-called 'regime shifts',
and may be combined with factor models to give you automated warnings.
David Ardia has written extensively on this topic, see for example [6]
and [7], as have others.

Regards,

   - Brian

Ref:
[1] St. John, David ttrTests: Standard Backtests for 
	Technical Trading Rules in Financial Data
http://cran.r-project.org/web/packages/ttrTests/index.html

[2] Burns, Patrick Random portfolios for Evaluating Trading Strategies
	http://papers.ssrn.com/sol3/papers.cfm?abstract_id=881735

[3] http://r-forge.r-project.org/projects/factoranalytics/

[4] Zivot, Eric. Financial Risk Models in R
	Factor Models for Asset Returns. R/Finance 2011
http://faculty.washington.edu/ezivot/research/factorModelTutorial_handout.pdf

[5] Zivot, Eric. Using R for Hedge Fund of Funds 
	Risk Management. R/Finance 2009
http://www.rinfinance.com/RinFinance2009/presentations/PresentationChicago24_04_2009.pdf

[6] Ardia, David. Efficient Bayesian Estimation and 
	Combination of GARCH-type Models.
        http://repub.eur.nl/res/pub/19380/401D94D6d01.pdf

[7] Ardia, David. Financial Risk Estimation with Bayesian Estimation of
GARCH models.
http://www.scribd.com/doc/46504267/Financial-Risk-Management-With-Bayesian-Estimation-of-GARCH-Models

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Fri Feb 17 13:57:29 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 17 Feb 2012 06:57:29 -0600
Subject: [R-SIG-Finance] Writing sell rules with quantstrat
In-Reply-To: <CAEGu7FuHD8DgeA0NYXVqJbBmZ8a2v20Pog3xMcpSvB=xZShhbw@mail.gmail.com>
References: <CAEGu7Fs3Y6suXh8ntbUWjPuL3-fC+n-hn7rbFJk=9Hf1mrs3jg@mail.gmail.com>
	<1329304310.12375.15.camel@brian-desktop>
	<CAEGu7FvD9uC=2c7hi5Vp0TXEcoAu2adUofjrFV=YX0pHeG13uw@mail.gmail.com>
	<CAEGu7FuYn=zjf5+NgC42QycM7TLb8t8tWUQBfGnV_vHX9y8MfA@mail.gmail.com>
	<1329324082.8901.51.camel@brian-rcg>
	<CAEGu7FsP7TjhNyL5mEyhT21ao7QOi2333+o2Fptm50J4512w_w@mail.gmail.com>
	<CAEGu7FuHD8DgeA0NYXVqJbBmZ8a2v20Pog3xMcpSvB=xZShhbw@mail.gmail.com>
Message-ID: <1329483449.8901.86.camel@brian-rcg>

On Wed, 2012-02-15 at 20:16 -0800, Sergey Pisarenko wrote:
> I think this has to do with the fact that stop-limit order triggers
> whenever the price is below the threshold. In other words, if I buy
> shares for 30 and set a stop-limit order at 50 the stop-limit order
> will trigger next day because the price is already below 50. It seems
> that the stop-limit in its current implementation is not designed for
> the case of gains. Instead, it works only for losses. When I set
> threshold to say 0.9 (10% loss) I see that it behaves as expected and
> the order is executed only when the price goes down 10%.

I should have seen this yesterday...  A regular 'limit' order can be
used for gains, as your resting order will be on the 'correct' side of
the market for a resting limit.  A 'stoplimit' order may be used when
your order is on the 'wrong' side of the market, and could not rest in
the order book as a normal limit order.

Regards,

   - Brian
> 
> 
-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From sunduck at gmail.com  Fri Feb 17 14:51:46 2012
From: sunduck at gmail.com (Alex Bird)
Date: Fri, 17 Feb 2012 17:51:46 +0400
Subject: [R-SIG-Finance] HF strategy style change detection based on txn
	data
In-Reply-To: <1329483300.8901.84.camel@brian-rcg>
References: <CAJ3qPLD30=GJorHOAJ+=y1oXkgVY7UXO5GcSdVBSsLfxayg7OQ@mail.gmail.com>
	<1329483300.8901.84.camel@brian-rcg>
Message-ID: <CAJ3qPLA7HAZm5X8qJOyXyYcHms3Dh-pTEGUY5y_AEb20crDqgw@mail.gmail.com>

Hi Brian,

  thanks a lot for your help!!
  I think it's a very promising idea to combine factor analysis (to be
more precisely latent factor analysis) + regime shifts. The latent
factor (-s) I guess could capture the intrinsic dymanics of a strategy
at any desirable frequency and then be analysed for structural breaks.
I don't think it's somehow possible to apply standard factor analysis
as there are no readily available market factors for high frequency
strategies at any desirable frequency, because all these strategies
are very different in their nature and have very different intraday
statistical properties to be able to be comparable with some factor
(-s).

  As of the trading decisions analysis it's assumed (intrinsically
implied) that all the decisions made inside the strategies are already
optimal because they have all the desired statistical properties
needed to be included in the fund of funds portfolio and are in the
responsibility of the 3rd-party asset managers.

Thanks once time again Brian!

Kind regards,
Alex
2012/2/17 Brian G. Peterson <brian at braverock.com>:
> vid Ardia has written extensivel


From momop540 at yahoo.com  Fri Feb 17 15:17:39 2012
From: momop540 at yahoo.com (Momop Momop)
Date: Fri, 17 Feb 2012 06:17:39 -0800 (PST)
Subject: [R-SIG-Finance] (no subject)
Message-ID: <1329488259.8449.YahooMailMobile@web44713.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120217/f533d35f/attachment.pl>

From momop540 at yahoo.com  Fri Feb 17 20:52:32 2012
From: momop540 at yahoo.com (Momop Momop)
Date: Fri, 17 Feb 2012 11:52:32 -0800 (PST)
Subject: [R-SIG-Finance] (no subject)
Message-ID: <1329508352.82698.YahooMailMobile@web44713.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120217/9c4acdbe/attachment.pl>

From drseergio at gmail.com  Fri Feb 17 21:01:12 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Fri, 17 Feb 2012 12:01:12 -0800
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
Message-ID: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>

Greetings to the R finance community,

I have written a sizing function (pretty much a slight modification of
a function from Guy Yollin's slides). The problem is that it fails
whenever I use many symbols. It works fine for one or few symbols.

The problem manifests itself inside of the sizing function, when
updatePortf is run. The error I get is:
> source('tainted_2.R')
Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
parse.side(intervals[1]))) :
  argument is of length zero

Traceback:
> traceback()
13: xts:::.parseISO8601(Dates)
12: first(xts:::.parseISO8601(Dates))
11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
        Dates = Dates, Prices = Prices, ... = ...)
10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
        sep = "")) at tainted_2.R#100
9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
       orderqty = orderqty, ordertype = ordertype, orderside = orderside,
       portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
       orderprice = as.numeric(orderprice))
8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
       ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
       replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
c("market",
           "opside", "active"), portfolio, symbol, ..., ruletype,
       TxnFees = 0, prefer = NULL, sethold = FALSE)
...
7: do.call(fun, .formals)
6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
       mktdata = mktdata, portfolio = portfolio, symbol = symbol,
       ruletype = type, mktinstr = mktinstr, ...)
5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
       mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
       signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
4: applyStrategy(strategy = "s", portfolios = "p")
3: eval.with.vis(expr, envir, enclos)
2: eval.with.vis(ei, envir)
1: source("tainted_2.R")

The sizing function looks like:

osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
ruletype, ...) {
  posn <- getPosQty(portfolio, symbol, timestamp)
  if (posn == 0) {
    tempPortfolio <- getPortfolio(portfolio)
    dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
as.Date(timestamp), sep=''))     # <<<<<< this is where it fails
    trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
    assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
    total.equity <- equity + trading.pl
    tradeSize <- total.equity * prcTrade
    ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
    orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
    return(orderqty)
  }
}

The add.rule looks like:
s <- add.rule(strategy=s, name='ruleSignal',
arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
osFUN='osPercentEquity', ruletype='enter'), type='enter')

Traceback suggests that there is a problem with the date format. I
have inserted print statements and verified that the date itself is
fine. It is also weird that the issue does not occur when using few
symbols.

I have attached runnable code that reproduces the problem. Please
excuse any apparent inefficiencies you see. I would like to get
strategy working first and then optimize for performance.

Is there something wrong with the approach I have taken? Once the
number of symbols is reduced the problem does not trigger.

Truly appreciate your help.

--
Kind Regards,
Sergey Pisarenko.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tainted_2.R
Type: application/octet-stream
Size: 5148 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120217/c842422f/attachment.obj>

From gsee000 at gmail.com  Fri Feb 17 21:08:26 2012
From: gsee000 at gmail.com (G See)
Date: Fri, 17 Feb 2012 14:08:26 -0600
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
Message-ID: <CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>

I've been having trouble with yahoo over the last 24 hours or so.
Sometimes, it returns data; sometimes it doesn't

> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
> getSymbols(watched, src='yahoo', verbose=FALSE)
pausing 1 second between requests for more than 5 symbols
pausing 1 second between requests for more than 5 symbols
[1] "A"   "AA"  "AAN" "AAP" "AAT" "AAV"
> getSymbols(watched, src='yahoo', verbose=FALSE)
Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m,  :
  cannot open URL
'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
In addition: Warning message:
In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m,  :
  cannot open: HTTP status was '404 Not Found'


HTH,
Garrett

On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Greetings to the R finance community,
>
> I have written a sizing function (pretty much a slight modification of
> a function from Guy Yollin's slides). The problem is that it fails
> whenever I use many symbols. It works fine for one or few symbols.
>
> The problem manifests itself inside of the sizing function, when
> updatePortf is run. The error I get is:
>> source('tainted_2.R')
> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
> parse.side(intervals[1]))) :
> ?argument is of length zero
>
> Traceback:
>> traceback()
> 13: xts:::.parseISO8601(Dates)
> 12: first(xts:::.parseISO8601(Dates))
> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
> ? ? ? ?sep = "")) at tainted_2.R#100
> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
> ? ? ? orderprice = as.numeric(orderprice))
> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
> c("market",
> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
> ...
> 7: do.call(fun, .formals)
> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
> 4: applyStrategy(strategy = "s", portfolios = "p")
> 3: eval.with.vis(expr, envir, enclos)
> 2: eval.with.vis(ei, envir)
> 1: source("tainted_2.R")
>
> The sizing function looks like:
>
> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
> ruletype, ...) {
> ?posn <- getPosQty(portfolio, symbol, timestamp)
> ?if (posn == 0) {
> ? ?tempPortfolio <- getPortfolio(portfolio)
> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
> ? ?total.equity <- equity + trading.pl
> ? ?tradeSize <- total.equity * prcTrade
> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
> ? ?return(orderqty)
> ?}
> }
>
> The add.rule looks like:
> s <- add.rule(strategy=s, name='ruleSignal',
> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>
> Traceback suggests that there is a problem with the date format. I
> have inserted print statements and verified that the date itself is
> fine. It is also weird that the issue does not occur when using few
> symbols.
>
> I have attached runnable code that reproduces the problem. Please
> excuse any apparent inefficiencies you see. I would like to get
> strategy working first and then optimize for performance.
>
> Is there something wrong with the approach I have taken? Once the
> number of symbols is reduced the problem does not trigger.
>
> Truly appreciate your help.
>
> --
> Kind Regards,
> Sergey Pisarenko.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From drseergio at gmail.com  Fri Feb 17 21:11:09 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Fri, 17 Feb 2012 12:11:09 -0800
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
Message-ID: <CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>

Garett,

Thank you for the response and looking into this. The same is observed
when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
have data for all symbols as well so this might explain some of the
404s.

/Sergey

On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
> I've been having trouble with yahoo over the last 24 hours or so.
> Sometimes, it returns data; sometimes it doesn't
>
>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>> getSymbols(watched, src='yahoo', verbose=FALSE)
> pausing 1 second between requests for more than 5 symbols
> pausing 1 second between requests for more than 5 symbols
> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>> getSymbols(watched, src='yahoo', verbose=FALSE)
> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
> ?cannot open URL
> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
> In addition: Warning message:
> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
> ?cannot open: HTTP status was '404 Not Found'
>
>
> HTH,
> Garrett
>
> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Greetings to the R finance community,
>>
>> I have written a sizing function (pretty much a slight modification of
>> a function from Guy Yollin's slides). The problem is that it fails
>> whenever I use many symbols. It works fine for one or few symbols.
>>
>> The problem manifests itself inside of the sizing function, when
>> updatePortf is run. The error I get is:
>>> source('tainted_2.R')
>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>> parse.side(intervals[1]))) :
>> ?argument is of length zero
>>
>> Traceback:
>>> traceback()
>> 13: xts:::.parseISO8601(Dates)
>> 12: first(xts:::.parseISO8601(Dates))
>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>> ? ? ? ?sep = "")) at tainted_2.R#100
>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>> ? ? ? orderprice = as.numeric(orderprice))
>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>> c("market",
>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>> ...
>> 7: do.call(fun, .formals)
>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>> 4: applyStrategy(strategy = "s", portfolios = "p")
>> 3: eval.with.vis(expr, envir, enclos)
>> 2: eval.with.vis(ei, envir)
>> 1: source("tainted_2.R")
>>
>> The sizing function looks like:
>>
>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>> ruletype, ...) {
>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>> ?if (posn == 0) {
>> ? ?tempPortfolio <- getPortfolio(portfolio)
>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>> ? ?total.equity <- equity + trading.pl
>> ? ?tradeSize <- total.equity * prcTrade
>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>> ? ?return(orderqty)
>> ?}
>> }
>>
>> The add.rule looks like:
>> s <- add.rule(strategy=s, name='ruleSignal',
>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>
>> Traceback suggests that there is a problem with the date format. I
>> have inserted print statements and verified that the date itself is
>> fine. It is also weird that the issue does not occur when using few
>> symbols.
>>
>> I have attached runnable code that reproduces the problem. Please
>> excuse any apparent inefficiencies you see. I would like to get
>> strategy working first and then optimize for performance.
>>
>> Is there something wrong with the approach I have taken? Once the
>> number of symbols is reduced the problem does not trigger.
>>
>> Truly appreciate your help.
>>
>> --
>> Kind Regards,
>> Sergey Pisarenko.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.


From kryp33 at yahoo.com  Sat Feb 18 23:20:41 2012
From: kryp33 at yahoo.com (SW)
Date: Sat, 18 Feb 2012 14:20:41 -0800 (PST)
Subject: [R-SIG-Finance] Stock Total Returns?
Message-ID: <1329603641.24965.YahooMailClassic@web161204.mail.bf1.yahoo.com>

Hello All,


I am relatively new to R and I am still not very comfortable with syntactic and libraries. Is there are any nice way to calculate and plot total returns for stocks which I would define as change in price and paid dividends? I made a code to do that but the loop that constructs prices+dividends looks ugly(see code below). Any suggestions to do it more efficiently? Thanks. Sergey 

##############  CODE  ##################################
library(quantmod)
library(PerformanceAnalytics)

#Time frame
dt.end = "2010-01-01"
dt.start =  "2007-01-01"

tickers = c('SPY',
            'XLY',
            'XLP',
            'XLE',
            'XLF',
            'XLV',
            'XLI',
            'XLB',
            'XLK',
            'XLU')
tickers.desc = c('SNP500',
                 'ConsumerCyclicals',
                 'ConsumerStaples',
                 'Energy',
                 'Financials',
                 'HealthCare',
                 'Industrials',
                 'Materials',
                 'Technology',
                 'Utilities')

############              Get prices        ###############################
setDefaults(getSymbols, warnings=FALSE,auto.assign=FALSE)
fnPx <- function(i) { return(Ad(getSymbols(tickers[i], from=dt.start,to=dt.end))) }
ts = lapply(1:length(tickers), fnPx)
###########################################################################

############              Get Dividends     ################################
fnDiv<- function(i) { return(getDividends(tickers[i], from=dt.start,to=dt.end,auto.assign=FALSE)) }
div = lapply(1:length(tickers), fnDiv)
###########################################################################

###########    Create Prices + Dividends (UGLY !!!!)  #####################
fnTotPx <- function(i) 
  { 
    ret = ts[[i]]
    for(j in 1:length(div[[i]]))
    {
      row  = div[[i]][j,]
      tm   = time(row)
      val  = as.double(row[1,1])
      iFwd = paste(tm,"::",sep='')
      iBk  = paste("::",tm-1,sep='')
      unch = ret[iBk]
      chg  = ret[iFwd]+val
      ret = rbind(unch,chg)
    }
    return(ret)
  }
totPx = lapply(1:length(tickers), fnTotPx)
############################################################################


################          Calc Total Returns     ##########################
fnRet <- function(i) { return(periodReturn(totPx[[i]],period='daily')) }
ts.ret = lapply(1:length(tickers), fnRet)

################          Plot Total Returns     ##########################
ts.ret.df = as.data.frame(ts.ret)
colnames(ts.ret.df)=tickers.desc
chart.CumReturns(ts.ret.df, main="Cumulative Returns",geometric=FALSE,legend.loc="bottomleft")
############################################################################


From michael.weylandt at gmail.com  Sat Feb 18 23:27:59 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sat, 18 Feb 2012 17:27:59 -0500
Subject: [R-SIG-Finance] Stock Total Returns?
In-Reply-To: <1329603641.24965.YahooMailClassic@web161204.mail.bf1.yahoo.com>
References: <1329603641.24965.YahooMailClassic@web161204.mail.bf1.yahoo.com>
Message-ID: <CAAmySGN47UYdcnsJEcvx4wbLK=hMiGXh=iFc8UNQNmOaH-cRzQ@mail.gmail.com>

I think you're over-thinking this: if you have adjusted prices, they
already incorporate splits+dividends --- so the return in adjusted
price *is* the total return. (Up to some fuzziness in how that
adjustment should be done)

Michael

On Sat, Feb 18, 2012 at 5:20 PM, SW <kryp33 at yahoo.com> wrote:
> Hello All,
>
>
> I am relatively new to R and I am still not very comfortable with syntactic and libraries. Is there are any nice way to calculate and plot total returns for stocks which I would define as change in price and paid dividends? I made a code to do that but the loop that constructs prices+dividends looks ugly(see code below). Any suggestions to do it more efficiently? Thanks. Sergey
>
> ############## ?CODE ?##################################
> library(quantmod)
> library(PerformanceAnalytics)
>
> #Time frame
> dt.end = "2010-01-01"
> dt.start = ?"2007-01-01"
>
> tickers = c('SPY',
> ? ? ? ? ? ?'XLY',
> ? ? ? ? ? ?'XLP',
> ? ? ? ? ? ?'XLE',
> ? ? ? ? ? ?'XLF',
> ? ? ? ? ? ?'XLV',
> ? ? ? ? ? ?'XLI',
> ? ? ? ? ? ?'XLB',
> ? ? ? ? ? ?'XLK',
> ? ? ? ? ? ?'XLU')
> tickers.desc = c('SNP500',
> ? ? ? ? ? ? ? ? 'ConsumerCyclicals',
> ? ? ? ? ? ? ? ? 'ConsumerStaples',
> ? ? ? ? ? ? ? ? 'Energy',
> ? ? ? ? ? ? ? ? 'Financials',
> ? ? ? ? ? ? ? ? 'HealthCare',
> ? ? ? ? ? ? ? ? 'Industrials',
> ? ? ? ? ? ? ? ? 'Materials',
> ? ? ? ? ? ? ? ? 'Technology',
> ? ? ? ? ? ? ? ? 'Utilities')
>
> ############ ? ? ? ? ? ? ?Get prices ? ? ? ?###############################
> setDefaults(getSymbols, warnings=FALSE,auto.assign=FALSE)
> fnPx <- function(i) { return(Ad(getSymbols(tickers[i], from=dt.start,to=dt.end))) }
> ts = lapply(1:length(tickers), fnPx)
> ###########################################################################
>
> ############ ? ? ? ? ? ? ?Get Dividends ? ? ################################
> fnDiv<- function(i) { return(getDividends(tickers[i], from=dt.start,to=dt.end,auto.assign=FALSE)) }
> div = lapply(1:length(tickers), fnDiv)
> ###########################################################################
>
> ########### ? ?Create Prices + Dividends (UGLY !!!!) ?#####################
> fnTotPx <- function(i)
> ?{
> ? ?ret = ts[[i]]
> ? ?for(j in 1:length(div[[i]]))
> ? ?{
> ? ? ?row ?= div[[i]][j,]
> ? ? ?tm ? = time(row)
> ? ? ?val ?= as.double(row[1,1])
> ? ? ?iFwd = paste(tm,"::",sep='')
> ? ? ?iBk ?= paste("::",tm-1,sep='')
> ? ? ?unch = ret[iBk]
> ? ? ?chg ?= ret[iFwd]+val
> ? ? ?ret = rbind(unch,chg)
> ? ?}
> ? ?return(ret)
> ?}
> totPx = lapply(1:length(tickers), fnTotPx)
> ############################################################################
>
>
> ################ ? ? ? ? ?Calc Total Returns ? ? ##########################
> fnRet <- function(i) { return(periodReturn(totPx[[i]],period='daily')) }
> ts.ret = lapply(1:length(tickers), fnRet)
>
> ################ ? ? ? ? ?Plot Total Returns ? ? ##########################
> ts.ret.df = as.data.frame(ts.ret)
> colnames(ts.ret.df)=tickers.desc
> chart.CumReturns(ts.ret.df, main="Cumulative Returns",geometric=FALSE,legend.loc="bottomleft")
> ############################################################################
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From bennfine at gmail.com  Sat Feb 18 23:37:29 2012
From: bennfine at gmail.com (benn fine)
Date: Sat, 18 Feb 2012 17:37:29 -0500
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
Message-ID: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120218/65a0ac44/attachment.pl>

From kryp33 at yahoo.com  Sat Feb 18 23:44:19 2012
From: kryp33 at yahoo.com (SW)
Date: Sat, 18 Feb 2012 14:44:19 -0800 (PST)
Subject: [R-SIG-Finance] Stock Total Returns?
In-Reply-To: <CAAmySGN47UYdcnsJEcvx4wbLK=hMiGXh=iFc8UNQNmOaH-cRzQ@mail.gmail.com>
Message-ID: <1329605059.58029.YahooMailClassic@web161205.mail.bf1.yahoo.com>

Hi Michael,

Thanks a lot! You are right. The adjusted prices will give me the correct numbers for total returns. I kind of overlooked it. 

Best regards,
Sergey




--- On Sat, 2/18/12, R. Michael Weylandt <michael.weylandt at gmail.com> wrote:

> From: R. Michael Weylandt <michael.weylandt at gmail.com>
> Subject: Re: [R-SIG-Finance] Stock Total Returns?
> To: "SW" <kryp33 at yahoo.com>
> Cc: r-sig-finance at r-project.org
> Date: Saturday, February 18, 2012, 5:27 PM
> I think you're over-thinking this: if
> you have adjusted prices, they
> already incorporate splits+dividends --- so the return in
> adjusted
> price *is* the total return. (Up to some fuzziness in how
> that
> adjustment should be done)
> 
> Michael
> 
> On Sat, Feb 18, 2012 at 5:20 PM, SW <kryp33 at yahoo.com>
> wrote:
> > Hello All,
> >
> >
> > I am relatively new to R and I am still not very
> comfortable with syntactic and libraries. Is there are any
> nice way to calculate and plot total returns for stocks
> which I would define as change in price and paid dividends?
> I made a code to do that but the loop that constructs
> prices+dividends looks ugly(see code below). Any suggestions
> to do it more efficiently? Thanks. Sergey
> >
> > ############## ?CODE
> ?##################################
> > library(quantmod)
> > library(PerformanceAnalytics)
> >
> > #Time frame
> > dt.end = "2010-01-01"
> > dt.start = ?"2007-01-01"
> >
> > tickers = c('SPY',
> > ? ? ? ? ? ?'XLY',
> > ? ? ? ? ? ?'XLP',
> > ? ? ? ? ? ?'XLE',
> > ? ? ? ? ? ?'XLF',
> > ? ? ? ? ? ?'XLV',
> > ? ? ? ? ? ?'XLI',
> > ? ? ? ? ? ?'XLB',
> > ? ? ? ? ? ?'XLK',
> > ? ? ? ? ? ?'XLU')
> > tickers.desc = c('SNP500',
> > ? ? ? ? ? ? ? ? 'ConsumerCyclicals',
> > ? ? ? ? ? ? ? ? 'ConsumerStaples',
> > ? ? ? ? ? ? ? ? 'Energy',
> > ? ? ? ? ? ? ? ? 'Financials',
> > ? ? ? ? ? ? ? ? 'HealthCare',
> > ? ? ? ? ? ? ? ? 'Industrials',
> > ? ? ? ? ? ? ? ? 'Materials',
> > ? ? ? ? ? ? ? ? 'Technology',
> > ? ? ? ? ? ? ? ? 'Utilities')
> >
> > ############ ? ? ? ? ? ? ?Get prices ? ? ?
> ?###############################
> > setDefaults(getSymbols,
> warnings=FALSE,auto.assign=FALSE)
> > fnPx <- function(i) {
> return(Ad(getSymbols(tickers[i], from=dt.start,to=dt.end)))
> }
> > ts = lapply(1:length(tickers), fnPx)
> >
> ###########################################################################
> >
> > ############ ? ? ? ? ? ? ?Get Dividends ? ?
> ################################
> > fnDiv<- function(i) {
> return(getDividends(tickers[i],
> from=dt.start,to=dt.end,auto.assign=FALSE)) }
> > div = lapply(1:length(tickers), fnDiv)
> >
> ###########################################################################
> >
> > ########### ? ?Create Prices + Dividends (UGLY !!!!)
> ?#####################
> > fnTotPx <- function(i)
> > ?{
> > ? ?ret = ts[[i]]
> > ? ?for(j in 1:length(div[[i]]))
> > ? ?{
> > ? ? ?row ?= div[[i]][j,]
> > ? ? ?tm ? = time(row)
> > ? ? ?val ?= as.double(row[1,1])
> > ? ? ?iFwd = paste(tm,"::",sep='')
> > ? ? ?iBk ?= paste("::",tm-1,sep='')
> > ? ? ?unch = ret[iBk]
> > ? ? ?chg ?= ret[iFwd]+val
> > ? ? ?ret = rbind(unch,chg)
> > ? ?}
> > ? ?return(ret)
> > ?}
> > totPx = lapply(1:length(tickers), fnTotPx)
> >
> ############################################################################
> >
> >
> > ################ ? ? ? ? ?Calc Total Returns ? ?
> ##########################
> > fnRet <- function(i) {
> return(periodReturn(totPx[[i]],period='daily')) }
> > ts.ret = lapply(1:length(tickers), fnRet)
> >
> > ################ ? ? ? ? ?Plot Total Returns ? ?
> ##########################
> > ts.ret.df = as.data.frame(ts.ret)
> > colnames(ts.ret.df)=tickers.desc
> > chart.CumReturns(ts.ret.df, main="Cumulative
> Returns",geometric=FALSE,legend.loc="bottomleft")
> >
> ############################################################################
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post,
> subscribe first.
> > -- Also note that this is not the r-help list where
> general R questions should go.
>


From brian at braverock.com  Sun Feb 19 00:08:25 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 18 Feb 2012 17:08:25 -0600
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
In-Reply-To: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
References: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
Message-ID: <1329606505.6665.24.camel@brian-desktop>

On Sat, 2012-02-18 at 17:37 -0500, benn fine wrote:
> I realize this topic has been hashed to death but i think the multitude of
> answers is confusing me.
> 
> I have mu,hat and cov.hat and a time series object of returns.
> I want the minimum variance portfolio without short sales
> 
> Is there a basic function somewhere that does that? I'm finding
> minvariancePortfolio in Fportfolio a little tricky to use.

'a little tricky to use' is hardly reproducible.

> I am trying the optimizeportfolio routine in PortfolioAnalytics. But the
> results seem a bit odd.

PortfolioAnalytics will give the correct result given the correct
objective function, but in any event I wouldn't use a global solver when
a simple closed form solution is available.  Portfolioanalytics, as
stated in the documentation or our seminar slides, is designed for much
more complex objectives for which no closed form solution exists.
 
> I have some code from Eric Zivot's website to compute the global minimum
> variance portfolio (see below).
> When I run it on a simple 4 asset example, I don't get the same result as
> optimize.portfolio, and in
> fact the optimize.portfolio weights give a larger portfolio variance.
>
> Here is the call for optimize.portoflio:
> 
> myconstr=constraint(assets=4, min_sum=1, max_sum=1, min=-100,
> max=100,weight_seq=generatesequence())
> optimize.portfolio(myrets,myconstr)

ouch.  weights are PERCENTAGES.  This is clearly stated in the
documentation, and in all the examples and lecture slides.

You said *without short sales*, yet this is 100x leveraged long/short
portfolio.

> Has someone written a nice wrapper to easily get the min variance portfolio
> wo short sales?

I don't know how much nicer you expect than three lines of code...

> Any ideas why Eric's code (which I trust) gives a different answer from
> opitimize.portfolio?

You put in the wrong constraints.

You also don't show the rest of your objective function here.

Right now, you're using a 100x leveraged long/short portfolio and no
objective...

You'll want to fix your min and max arguments, and have at least one
add.objective call.

Please look at the seminar slides from R/Finance 

http://www.rinfinance.com/agenda/2010/Carl+Peterson+Boudt_Tutorial.pdf

 - Brian

> 
> Thanks! Sorry for the cluelessness.
> 
> globalMin.portfolio <-
> function(er, cov.mat)
> {
>   # Compute global minimum variance portfolio
>   #
>   # inputs:
>   # er				N x 1 vector of expected returns
>   # cov.mat		N x N return covariance matrix
>   #
>   # output is portfolio object with the following elements
>   # call			original function call
>   # er				portfolio expected return
>   # sd				portfolio standard deviation
>   # weights		N x 1 vector of portfolio weights
>   call <- match.call()
> 
>   #
>   # check for valid inputs
>   #
>   asset.names <- names(er)
>   er <- as.vector(er)					# assign names if none exist
>   cov.mat <- as.matrix(cov.mat)
>   if(length(er) != nrow(cov.mat))
>     stop("invalid inputs")
>   if(any(diag(chol(cov.mat)) <= 0))
>     stop("Covariance matrix not positive definite")
>   # remark: could use generalized inverse if cov.mat is positive semi-definite
> 
>   #
>   # compute global minimum portfolio
>   #
>   cov.mat.inv <- solve(cov.mat)
>   one.vec <- rep(1,length(er))
> #  w.gmin <- cov.mat.inv %*% one.vec/as.vector(one.vec %*% cov.mat.inv
> %*% one.vec)
>   w.gmin <- rowSums(cov.mat.inv) / sum(cov.mat.inv)
>   w.gmin <- as.vector(w.gmin)
>   names(w.gmin) <- asset.names
>   er.gmin <- crossprod(w.gmin,er)
>   sd.gmin <- sqrt(t(w.gmin) %*% cov.mat %*% w.gmin)
>   gmin.port <- list("call" = call,
> 		    "er" = as.vector(er.gmin),
> 		    "sd" = as.vector(sd.gmin),
> 		    "weights" = w.gmin)
>   class(gmin.port) <- "portfolio"
>   gmin.port
> }
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From bennfine at gmail.com  Sun Feb 19 00:48:10 2012
From: bennfine at gmail.com (benn fine)
Date: Sat, 18 Feb 2012 18:48:10 -0500
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
In-Reply-To: <1329606505.6665.24.camel@brian-desktop>
References: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
	<1329606505.6665.24.camel@brian-desktop>
Message-ID: <CALghxgRYp0=Be-ww3j3x6OC14ywr5uaJW5_ZFC0b_QgYaET3EA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120218/119bccc5/attachment.pl>

From stergios_marinopoulos at yahoo.com  Sun Feb 19 00:52:56 2012
From: stergios_marinopoulos at yahoo.com (Stergios Marinopoulos)
Date: Sat, 18 Feb 2012 15:52:56 -0800 (PST)
Subject: [R-SIG-Finance] Interesting behaviour in BBands
Message-ID: <1329609176.75020.YahooMailNeo@web30808.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120218/14a42d96/attachment.pl>

From brian at braverock.com  Sun Feb 19 01:15:13 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 18 Feb 2012 18:15:13 -0600
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
In-Reply-To: <CALghxgRYp0=Be-ww3j3x6OC14ywr5uaJW5_ZFC0b_QgYaET3EA@mail.gmail.com>
References: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
	<1329606505.6665.24.camel@brian-desktop>
	<CALghxgRYp0=Be-ww3j3x6OC14ywr5uaJW5_ZFC0b_QgYaET3EA@mail.gmail.com>
Message-ID: <1329610513.29235.10.camel@brian-desktop>

On Sat, 2012-02-18 at 18:48 -0500, benn fine wrote:
> Thank you for your swift response:
> 
> 
> For other newbies who might have a similar issue, can you review the
> following lines of code? 
> 
> 
> for background, I have three assets and want to find the minimum
> vairance portfolio allowing short sales (once I confirm I get the same
> as from Zivot's code and excel I will work with long only).

Long only is much easier than long short... you'd be much better off
starting there to make sure you understand what you're doing.

If you really only want a minimum variance objective, used the closed
form solution provided by Eric.  Using a global optimizer when a closed
form exists is a waste of computational power, and will have decreased
accuracy unless you do a large global search.

> Here are the weights I am expecting:
> 
> 
> > foo=globalMin.portfolio(mu.hat,cov.hat)
> > foo
> Call:
> globalMin.portfolio(er = mu.hat, cov.mat = cov.hat)

You never say, but I assume that these are sample means and variances,
and not some 

> Portfolio expected return:     0.005188703 
> Portfolio standard deviation:  0.04135499 
> Portfolio weights:
>   monthly.returns monthly.returns.1 monthly.returns.2 
>           -0.5894            0.3976            1.1918 
> 
> 
> I think I am getting close with optimize.portfolio but I am getting
> error messages about risk over 100%.
> Can you please comment on any errors you see below?
> 
> 
> myconstr=constraint(assets=3, min_sum=1, max_sum=1, min=-1.5,
> max=1.5,weight_seq=generatesequence())

So, now you're now saying that you want a long/short portfolio where the
weights sum to 1, but the minimum or maximum weight may be 150% of
capital.  Is this what you want?  This will create a portfolio that is
not 'long/short neutral' which is usually what people want when they say
they want long/short (weights sum to approximately zero, not 1).

As noted in the documentation and our seminar slides, min_sum and
max_sum should probably have some delta around your desired sum, so that
generatesequence() will be faster.

> aConstraintObj = add.objective(constraints =  
>  myconstr, 
>  type="risk",
>  name="var", 
>  enabled=TRUE)
> 
> 
> optimize.portfolio(myrets,aConstraintObj,optimize_method="DEoptim")

You probably want to start with random portfolios until you get some
intuition for what you're doing, as I've said many times before, DEoptim
will be more accurate and slower.

 - Brian

> 
> On Sat, Feb 18, 2012 at 6:08 PM, Brian G. Peterson
> <brian at braverock.com> wrote:
>         On Sat, 2012-02-18 at 17:37 -0500, benn fine wrote:
>         > I realize this topic has been hashed to death but i think
>         the multitude of
>         > answers is confusing me.
>         >
>         > I have mu,hat and cov.hat and a time series object of
>         returns.
>         > I want the minimum variance portfolio without short sales
>         >
>         > Is there a basic function somewhere that does that? I'm
>         finding
>         > minvariancePortfolio in Fportfolio a little tricky to use.
>         
>         
>         'a little tricky to use' is hardly reproducible.
>         
>         > I am trying the optimizeportfolio routine in
>         PortfolioAnalytics. But the
>         > results seem a bit odd.
>         
>         
>         PortfolioAnalytics will give the correct result given the
>         correct
>         objective function, but in any event I wouldn't use a global
>         solver when
>         a simple closed form solution is available.
>          Portfolioanalytics, as
>         stated in the documentation or our seminar slides, is designed
>         for much
>         more complex objectives for which no closed form solution
>         exists.
>         
>         > I have some code from Eric Zivot's website to compute the
>         global minimum
>         > variance portfolio (see below).
>         > When I run it on a simple 4 asset example, I don't get the
>         same result as
>         > optimize.portfolio, and in
>         > fact the optimize.portfolio weights give a larger portfolio
>         variance.
>         >
>         > Here is the call for optimize.portoflio:
>         >
>         > myconstr=constraint(assets=4, min_sum=1, max_sum=1,
>         min=-100,
>         > max=100,weight_seq=generatesequence())
>         > optimize.portfolio(myrets,myconstr)
>         
>         
>         ouch.  weights are PERCENTAGES.  This is clearly stated in the
>         documentation, and in all the examples and lecture slides.
>         
>         You said *without short sales*, yet this is 100x leveraged
>         long/short
>         portfolio.
>         
>         > Has someone written a nice wrapper to easily get the min
>         variance portfolio
>         > wo short sales?
>         
>         
>         I don't know how much nicer you expect than three lines of
>         code...
>         
>         > Any ideas why Eric's code (which I trust) gives a different
>         answer from
>         > opitimize.portfolio?
>         
>         
>         You put in the wrong constraints.
>         
>         You also don't show the rest of your objective function here.
>         
>         Right now, you're using a 100x leveraged long/short portfolio
>         and no
>         objective...
>         
>         You'll want to fix your min and max arguments, and have at
>         least one
>         add.objective call.
>         
>         Please look at the seminar slides from R/Finance
>         
>         http://www.rinfinance.com/agenda/2010/Carl+Peterson
>         +Boudt_Tutorial.pdf
>         
>          - Brian
>         
>         >
>         > Thanks! Sorry for the cluelessness.
>         >
>         > globalMin.portfolio <-
>         > function(er, cov.mat)
>         > {
>         >   # Compute global minimum variance portfolio
>         >   #
>         >   # inputs:
>         >   # er                                N x 1 vector of
>         expected returns
>         >   # cov.mat           N x N return covariance matrix
>         >   #
>         >   # output is portfolio object with the following elements
>         >   # call                      original function call
>         >   # er                                portfolio expected
>         return
>         >   # sd                                portfolio standard
>         deviation
>         >   # weights           N x 1 vector of portfolio weights
>         >   call <- match.call()
>         >
>         >   #
>         >   # check for valid inputs
>         >   #
>         >   asset.names <- names(er)
>         >   er <- as.vector(er)                                 #
>         assign names if none exist
>         >   cov.mat <- as.matrix(cov.mat)
>         >   if(length(er) != nrow(cov.mat))
>         >     stop("invalid inputs")
>         >   if(any(diag(chol(cov.mat)) <= 0))
>         >     stop("Covariance matrix not positive definite")
>         >   # remark: could use generalized inverse if cov.mat is
>         positive semi-definite
>         >
>         >   #
>         >   # compute global minimum portfolio
>         >   #
>         >   cov.mat.inv <- solve(cov.mat)
>         >   one.vec <- rep(1,length(er))
>         > #  w.gmin <- cov.mat.inv %*% one.vec/as.vector(one.vec %*%
>         cov.mat.inv
>         > %*% one.vec)
>         >   w.gmin <- rowSums(cov.mat.inv) / sum(cov.mat.inv)
>         >   w.gmin <- as.vector(w.gmin)
>         >   names(w.gmin) <- asset.names
>         >   er.gmin <- crossprod(w.gmin,er)
>         >   sd.gmin <- sqrt(t(w.gmin) %*% cov.mat %*% w.gmin)
>         >   gmin.port <- list("call" = call,
>         >                   "er" = as.vector(er.gmin),
>         >                   "sd" = as.vector(sd.gmin),
>         >                   "weights" = w.gmin)
>         >   class(gmin.port) <- "portfolio"
>         >   gmin.port
>         > }
>         >
>         
>         >       [[alternative HTML version deleted]]
>         >
>         > _______________________________________________
>         > R-SIG-Finance at r-project.org mailing list
>         > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>         > -- Subscriber-posting only. If you want to post, subscribe
>         first.
>         > -- Also note that this is not the r-help list where general
>         R questions should go.
>         
>         --
>         Brian G. Peterson
>         http://braverock.com/brian/
>         Ph: 773-459-4973
>         IM: bgpbraverock
>         
> 
> 

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From bennfine at gmail.com  Sun Feb 19 01:32:18 2012
From: bennfine at gmail.com (benn fine)
Date: Sat, 18 Feb 2012 19:32:18 -0500
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
In-Reply-To: <1329610513.29235.10.camel@brian-desktop>
References: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
	<1329606505.6665.24.camel@brian-desktop>
	<CALghxgRYp0=Be-ww3j3x6OC14ywr5uaJW5_ZFC0b_QgYaET3EA@mail.gmail.com>
	<1329610513.29235.10.camel@brian-desktop>
Message-ID: <CALghxgSvRHWAEG4HJQwLC4XrccNRtqajD3oTgCZ86t0PMDaE4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120218/bece9023/attachment.pl>

From brian at braverock.com  Sun Feb 19 01:42:15 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 18 Feb 2012 18:42:15 -0600
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
In-Reply-To: <CALghxgSvRHWAEG4HJQwLC4XrccNRtqajD3oTgCZ86t0PMDaE4w@mail.gmail.com>
References: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
	<1329606505.6665.24.camel@brian-desktop>
	<CALghxgRYp0=Be-ww3j3x6OC14ywr5uaJW5_ZFC0b_QgYaET3EA@mail.gmail.com>
	<1329610513.29235.10.camel@brian-desktop>
	<CALghxgSvRHWAEG4HJQwLC4XrccNRtqajD3oTgCZ86t0PMDaE4w@mail.gmail.com>
Message-ID: <1329612136.29235.12.camel@brian-desktop>

the largest problem I still see here is that you want to minimize 'sd',
not 'var'

I suspect that will do what you want it to do, and the 'weights-aware'
version is already inside the package for this, so you shouldn't need to
do anything else.

It would be much easier for people to help you if you used publicly
available data to construct a fully reproducible example...

On Sat, 2012-02-18 at 19:32 -0500, benn fine wrote:
> The thinking was to see how optimize.portfolio works by having it give
> me (approximately) the same weights I get from the closed form
> solution. Then I would be satisfied it would work for long only. When
> I say short, I simply mean that the weights can be negative or
> positive.
> 
> 
> So yes, using the sample mean and sample covariance matrix, I get
> asset weights of    -0.5894, 0.3976, and  1.1918 based on the closed
> form solution.
> 
> 
> I still can't get optimize.portfolio to work, even when using random
> portfolios.
> 
> 
> Is my thinking correct that I need to write a "portfolio aware"
> variance function as mentioned in your slides for your CVaR example?
> That is, I am doing the following by just putting "var" in for the
> objective function, but is that enough or do I need to write my own
> function that takes portfolio weights and covariance matrix and
> returns the variance?
> 
> 
> > aConstraintObj = add.objective(constraints =
> >  myconstr,
> >  type="risk",
> >  name="var",
> >  enabled=TRUE) 
> 
> The following just does not work:
> 
> 
> myconstr=constraint(assets=3, min_sum=.99, max_sum=1.01, min= -2,
> max=2,weight_seq=generatesequence())
> 
> 
> aConstraintObj = add.objective(constraints =  
>  myconstr, 
>  type="risk",
>  name="var", 
>  enabled=TRUE)
> 
> 
> 
> 
> optimize.portfolio(myrets,aConstraintObj,optimize_method="random")
> 
> 
> 
> 
> 
> 
> On Sat, Feb 18, 2012 at 7:15 PM, Brian G. Peterson
> <brian at braverock.com> wrote:
>         On Sat, 2012-02-18 at 18:48 -0500, benn fine wrote:
>         > Thank you for your swift response:
>         >
>         >
>         > For other newbies who might have a similar issue, can you
>         review the
>         > following lines of code?
>         >
>         >
>         > for background, I have three assets and want to find the
>         minimum
>         > vairance portfolio allowing short sales (once I confirm I
>         get the same
>         > as from Zivot's code and excel I will work with long only).
>         
>         
>         Long only is much easier than long short... you'd be much
>         better off
>         starting there to make sure you understand what you're doing.
>         
>         If you really only want a minimum variance objective, used the
>         closed
>         form solution provided by Eric.  Using a global optimizer when
>         a closed
>         form exists is a waste of computational power, and will have
>         decreased
>         accuracy unless you do a large global search.
>         
>         > Here are the weights I am expecting:
>         >
>         >
>         > > foo=globalMin.portfolio(mu.hat,cov.hat)
>         > > foo
>         > Call:
>         > globalMin.portfolio(er = mu.hat, cov.mat = cov.hat)
>         
>         
>         You never say, but I assume that these are sample means and
>         variances,
>         and not some
>         
>         > Portfolio expected return:     0.005188703
>         > Portfolio standard deviation:  0.04135499
>         > Portfolio weights:
>         >   monthly.returns monthly.returns.1 monthly.returns.2
>         >           -0.5894            0.3976            1.1918
>         >
>         >
>         > I think I am getting close with optimize.portfolio but I am
>         getting
>         > error messages about risk over 100%.
>         > Can you please comment on any errors you see below?
>         >
>         >
>         > myconstr=constraint(assets=3, min_sum=1, max_sum=1,
>         min=-1.5,
>         > max=1.5,weight_seq=generatesequence())
>         
>         
>         So, now you're now saying that you want a long/short portfolio
>         where the
>         weights sum to 1, but the minimum or maximum weight may be
>         150% of
>         capital.  Is this what you want?  This will create a portfolio
>         that is
>         not 'long/short neutral' which is usually what people want
>         when they say
>         they want long/short (weights sum to approximately zero, not
>         1).
>         
>         As noted in the documentation and our seminar slides, min_sum
>         and
>         max_sum should probably have some delta around your desired
>         sum, so that
>         generatesequence() will be faster.
>         
>         > aConstraintObj = add.objective(constraints =
>         >  myconstr,
>         >  type="risk",
>         >  name="var",
>         >  enabled=TRUE)
>         >
>         >
>         >
>         optimize.portfolio(myrets,aConstraintObj,optimize_method="DEoptim")
>         
>         
>         You probably want to start with random portfolios until you
>         get some
>         intuition for what you're doing, as I've said many times
>         before, DEoptim
>         will be more accurate and slower.
>         
>          - Brian
>         
>         >
>         > On Sat, Feb 18, 2012 at 6:08 PM, Brian G. Peterson
>         > <brian at braverock.com> wrote:
>         >         On Sat, 2012-02-18 at 17:37 -0500, benn fine wrote:
>         >         > I realize this topic has been hashed to death but
>         i think
>         >         the multitude of
>         >         > answers is confusing me.
>         >         >
>         >         > I have mu,hat and cov.hat and a time series object
>         of
>         >         returns.
>         >         > I want the minimum variance portfolio without
>         short sales
>         >         >
>         >         > Is there a basic function somewhere that does
>         that? I'm
>         >         finding
>         >         > minvariancePortfolio in Fportfolio a little tricky
>         to use.
>         >
>         >
>         >         'a little tricky to use' is hardly reproducible.
>         >
>         >         > I am trying the optimizeportfolio routine in
>         >         PortfolioAnalytics. But the
>         >         > results seem a bit odd.
>         >
>         >
>         >         PortfolioAnalytics will give the correct result
>         given the
>         >         correct
>         >         objective function, but in any event I wouldn't use
>         a global
>         >         solver when
>         >         a simple closed form solution is available.
>         >          Portfolioanalytics, as
>         >         stated in the documentation or our seminar slides,
>         is designed
>         >         for much
>         >         more complex objectives for which no closed form
>         solution
>         >         exists.
>         >
>         >         > I have some code from Eric Zivot's website to
>         compute the
>         >         global minimum
>         >         > variance portfolio (see below).
>         >         > When I run it on a simple 4 asset example, I don't
>         get the
>         >         same result as
>         >         > optimize.portfolio, and in
>         >         > fact the optimize.portfolio weights give a larger
>         portfolio
>         >         variance.
>         >         >
>         >         > Here is the call for optimize.portoflio:
>         >         >
>         >         > myconstr=constraint(assets=4, min_sum=1,
>         max_sum=1,
>         >         min=-100,
>         >         > max=100,weight_seq=generatesequence())
>         >         > optimize.portfolio(myrets,myconstr)
>         >
>         >
>         >         ouch.  weights are PERCENTAGES.  This is clearly
>         stated in the
>         >         documentation, and in all the examples and lecture
>         slides.
>         >
>         >         You said *without short sales*, yet this is 100x
>         leveraged
>         >         long/short
>         >         portfolio.
>         >
>         >         > Has someone written a nice wrapper to easily get
>         the min
>         >         variance portfolio
>         >         > wo short sales?
>         >
>         >
>         >         I don't know how much nicer you expect than three
>         lines of
>         >         code...
>         >
>         >         > Any ideas why Eric's code (which I trust) gives a
>         different
>         >         answer from
>         >         > opitimize.portfolio?
>         >
>         >
>         >         You put in the wrong constraints.
>         >
>         >         You also don't show the rest of your objective
>         function here.
>         >
>         >         Right now, you're using a 100x leveraged long/short
>         portfolio
>         >         and no
>         >         objective...
>         >
>         >         You'll want to fix your min and max arguments, and
>         have at
>         >         least one
>         >         add.objective call.
>         >
>         >         Please look at the seminar slides from R/Finance
>         >
>         >         http://www.rinfinance.com/agenda/2010/Carl+Peterson
>         >         +Boudt_Tutorial.pdf
>         >
>         >          - Brian
>         >
>         >         >
>         >         > Thanks! Sorry for the cluelessness.
>         >         >
>         >         > globalMin.portfolio <-
>         >         > function(er, cov.mat)
>         >         > {
>         >         >   # Compute global minimum variance portfolio
>         >         >   #
>         >         >   # inputs:
>         >         >   # er                                N x 1 vector
>         of
>         >         expected returns
>         >         >   # cov.mat           N x N return covariance
>         matrix
>         >         >   #
>         >         >   # output is portfolio object with the following
>         elements
>         >         >   # call                      original function
>         call
>         >         >   # er                                portfolio
>         expected
>         >         return
>         >         >   # sd                                portfolio
>         standard
>         >         deviation
>         >         >   # weights           N x 1 vector of portfolio
>         weights
>         >         >   call <- match.call()
>         >         >
>         >         >   #
>         >         >   # check for valid inputs
>         >         >   #
>         >         >   asset.names <- names(er)
>         >         >   er <- as.vector(er)
>         #
>         >         assign names if none exist
>         >         >   cov.mat <- as.matrix(cov.mat)
>         >         >   if(length(er) != nrow(cov.mat))
>         >         >     stop("invalid inputs")
>         >         >   if(any(diag(chol(cov.mat)) <= 0))
>         >         >     stop("Covariance matrix not positive
>         definite")
>         >         >   # remark: could use generalized inverse if
>         cov.mat is
>         >         positive semi-definite
>         >         >
>         >         >   #
>         >         >   # compute global minimum portfolio
>         >         >   #
>         >         >   cov.mat.inv <- solve(cov.mat)
>         >         >   one.vec <- rep(1,length(er))
>         >         > #  w.gmin <- cov.mat.inv %*%
>         one.vec/as.vector(one.vec %*%
>         >         cov.mat.inv
>         >         > %*% one.vec)
>         >         >   w.gmin <- rowSums(cov.mat.inv) /
>         sum(cov.mat.inv)
>         >         >   w.gmin <- as.vector(w.gmin)
>         >         >   names(w.gmin) <- asset.names
>         >         >   er.gmin <- crossprod(w.gmin,er)
>         >         >   sd.gmin <- sqrt(t(w.gmin) %*% cov.mat %*%
>         w.gmin)
>         >         >   gmin.port <- list("call" = call,
>         >         >                   "er" = as.vector(er.gmin),
>         >         >                   "sd" = as.vector(sd.gmin),
>         >         >                   "weights" = w.gmin)
>         >         >   class(gmin.port) <- "portfolio"
>         >         >   gmin.port
>         >         > }
>         >         >
>         >
>         >         >       [[alternative HTML version deleted]]
>         >         >
>         >         > _______________________________________________
>         >         > R-SIG-Finance at r-project.org mailing list
>         >         >
>         https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>         >         > -- Subscriber-posting only. If you want to post,
>         subscribe
>         >         first.
>         >         > -- Also note that this is not the r-help list
>         where general
>         >         R questions should go.
>         >
>         >         --
>         >         Brian G. Peterson
>         >         http://braverock.com/brian/
>         >         Ph: 773-459-4973
>         >         IM: bgpbraverock
>         >
>         >
>         >
>         
>         --
>         Brian G. Peterson
>         http://braverock.com/brian/
>         Ph: 773-459-4973
>         IM: bgpbraverock
>         
>         
> 
> 

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Sun Feb 19 02:11:16 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 18 Feb 2012 19:11:16 -0600
Subject: [R-SIG-Finance] minimum variance portfolio (no shorts)
In-Reply-To: <1329612136.29235.12.camel@brian-desktop>
References: <CALghxgSnJPZF2_SeHmaWBfEMC9sjKYgONsLt+Ub+1HvXUwC0pA@mail.gmail.com>
	<1329606505.6665.24.camel@brian-desktop>
	<CALghxgRYp0=Be-ww3j3x6OC14ywr5uaJW5_ZFC0b_QgYaET3EA@mail.gmail.com>
	<1329610513.29235.10.camel@brian-desktop>
	<CALghxgSvRHWAEG4HJQwLC4XrccNRtqajD3oTgCZ86t0PMDaE4w@mail.gmail.com>
	<1329612136.29235.12.camel@brian-desktop>
Message-ID: <1329613876.29235.16.camel@brian-desktop>

One more thing...

This:
https://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/PortfolioAnalytics/sandbox/script.workshop2010.R?root=returnanalytics

is the script code I used when preparing the seminar slides I linked to
earlier.

If you look at line 332 and following, you'll see a Markowitz
mean/variance example.  If all you want is to minimize portfolio
standard deviation (the "minimum variance" portfolio has the minimum
portfolio standard deviation) you only need to change enabled=TRUE to
enabled=FALSE in the 'mean' objective.  Leaving it in the objectives,
but disabled, means that the 'plot' method will work on the output
results, which would likely help your intuition about what's going on.


On Sat, 2012-02-18 at 18:42 -0600, Brian G. Peterson wrote:
> the largest problem I still see here is that you want to minimize 'sd',
> not 'var'
> 
> I suspect that will do what you want it to do, and the 'weights-aware'
> version is already inside the package for this, so you shouldn't need to
> do anything else.
> 
> It would be much easier for people to help you if you used publicly
> available data to construct a fully reproducible example...
> 
> On Sat, 2012-02-18 at 19:32 -0500, benn fine wrote:
> > The thinking was to see how optimize.portfolio works by having it give
> > me (approximately) the same weights I get from the closed form
> > solution. Then I would be satisfied it would work for long only. When
> > I say short, I simply mean that the weights can be negative or
> > positive.
> > 
> > 
> > So yes, using the sample mean and sample covariance matrix, I get
> > asset weights of    -0.5894, 0.3976, and  1.1918 based on the closed
> > form solution.
> > 
> > 
> > I still can't get optimize.portfolio to work, even when using random
> > portfolios.
> > 
> > 
> > Is my thinking correct that I need to write a "portfolio aware"
> > variance function as mentioned in your slides for your CVaR example?
> > That is, I am doing the following by just putting "var" in for the
> > objective function, but is that enough or do I need to write my own
> > function that takes portfolio weights and covariance matrix and
> > returns the variance?
> > 
> > 
> > > aConstraintObj = add.objective(constraints =
> > >  myconstr,
> > >  type="risk",
> > >  name="var",
> > >  enabled=TRUE) 
> > 
> > The following just does not work:
> > 
> > 
> > myconstr=constraint(assets=3, min_sum=.99, max_sum=1.01, min= -2,
> > max=2,weight_seq=generatesequence())
> > 
> > 
> > aConstraintObj = add.objective(constraints =  
> >  myconstr, 
> >  type="risk",
> >  name="var", 
> >  enabled=TRUE)
> > 
> > 
> > 
> > 
> > optimize.portfolio(myrets,aConstraintObj,optimize_method="random")
> > 
> > 
> > 
> > 
> > 
> > 
> > On Sat, Feb 18, 2012 at 7:15 PM, Brian G. Peterson
> > <brian at braverock.com> wrote:
> >         On Sat, 2012-02-18 at 18:48 -0500, benn fine wrote:
> >         > Thank you for your swift response:
> >         >
> >         >
> >         > For other newbies who might have a similar issue, can you
> >         review the
> >         > following lines of code?
> >         >
> >         >
> >         > for background, I have three assets and want to find the
> >         minimum
> >         > vairance portfolio allowing short sales (once I confirm I
> >         get the same
> >         > as from Zivot's code and excel I will work with long only).
> >         
> >         
> >         Long only is much easier than long short... you'd be much
> >         better off
> >         starting there to make sure you understand what you're doing.
> >         
> >         If you really only want a minimum variance objective, used the
> >         closed
> >         form solution provided by Eric.  Using a global optimizer when
> >         a closed
> >         form exists is a waste of computational power, and will have
> >         decreased
> >         accuracy unless you do a large global search.
> >         
> >         > Here are the weights I am expecting:
> >         >
> >         >
> >         > > foo=globalMin.portfolio(mu.hat,cov.hat)
> >         > > foo
> >         > Call:
> >         > globalMin.portfolio(er = mu.hat, cov.mat = cov.hat)
> >         
> >         
> >         You never say, but I assume that these are sample means and
> >         variances,
> >         and not some
> >         
> >         > Portfolio expected return:     0.005188703
> >         > Portfolio standard deviation:  0.04135499
> >         > Portfolio weights:
> >         >   monthly.returns monthly.returns.1 monthly.returns.2
> >         >           -0.5894            0.3976            1.1918
> >         >
> >         >
> >         > I think I am getting close with optimize.portfolio but I am
> >         getting
> >         > error messages about risk over 100%.
> >         > Can you please comment on any errors you see below?
> >         >
> >         >
> >         > myconstr=constraint(assets=3, min_sum=1, max_sum=1,
> >         min=-1.5,
> >         > max=1.5,weight_seq=generatesequence())
> >         
> >         
> >         So, now you're now saying that you want a long/short portfolio
> >         where the
> >         weights sum to 1, but the minimum or maximum weight may be
> >         150% of
> >         capital.  Is this what you want?  This will create a portfolio
> >         that is
> >         not 'long/short neutral' which is usually what people want
> >         when they say
> >         they want long/short (weights sum to approximately zero, not
> >         1).
> >         
> >         As noted in the documentation and our seminar slides, min_sum
> >         and
> >         max_sum should probably have some delta around your desired
> >         sum, so that
> >         generatesequence() will be faster.
> >         
> >         > aConstraintObj = add.objective(constraints =
> >         >  myconstr,
> >         >  type="risk",
> >         >  name="var",
> >         >  enabled=TRUE)
> >         >
> >         >
> >         >
> >         optimize.portfolio(myrets,aConstraintObj,optimize_method="DEoptim")
> >         
> >         
> >         You probably want to start with random portfolios until you
> >         get some
> >         intuition for what you're doing, as I've said many times
> >         before, DEoptim
> >         will be more accurate and slower.
> >         
> >          - Brian
> >         
> >         >
> >         > On Sat, Feb 18, 2012 at 6:08 PM, Brian G. Peterson
> >         > <brian at braverock.com> wrote:
> >         >         On Sat, 2012-02-18 at 17:37 -0500, benn fine wrote:
> >         >         > I realize this topic has been hashed to death but
> >         i think
> >         >         the multitude of
> >         >         > answers is confusing me.
> >         >         >
> >         >         > I have mu,hat and cov.hat and a time series object
> >         of
> >         >         returns.
> >         >         > I want the minimum variance portfolio without
> >         short sales
> >         >         >
> >         >         > Is there a basic function somewhere that does
> >         that? I'm
> >         >         finding
> >         >         > minvariancePortfolio in Fportfolio a little tricky
> >         to use.
> >         >
> >         >
> >         >         'a little tricky to use' is hardly reproducible.
> >         >
> >         >         > I am trying the optimizeportfolio routine in
> >         >         PortfolioAnalytics. But the
> >         >         > results seem a bit odd.
> >         >
> >         >
> >         >         PortfolioAnalytics will give the correct result
> >         given the
> >         >         correct
> >         >         objective function, but in any event I wouldn't use
> >         a global
> >         >         solver when
> >         >         a simple closed form solution is available.
> >         >          Portfolioanalytics, as
> >         >         stated in the documentation or our seminar slides,
> >         is designed
> >         >         for much
> >         >         more complex objectives for which no closed form
> >         solution
> >         >         exists.
> >         >
> >         >         > I have some code from Eric Zivot's website to
> >         compute the
> >         >         global minimum
> >         >         > variance portfolio (see below).
> >         >         > When I run it on a simple 4 asset example, I don't
> >         get the
> >         >         same result as
> >         >         > optimize.portfolio, and in
> >         >         > fact the optimize.portfolio weights give a larger
> >         portfolio
> >         >         variance.
> >         >         >
> >         >         > Here is the call for optimize.portoflio:
> >         >         >
> >         >         > myconstr=constraint(assets=4, min_sum=1,
> >         max_sum=1,
> >         >         min=-100,
> >         >         > max=100,weight_seq=generatesequence())
> >         >         > optimize.portfolio(myrets,myconstr)
> >         >
> >         >
> >         >         ouch.  weights are PERCENTAGES.  This is clearly
> >         stated in the
> >         >         documentation, and in all the examples and lecture
> >         slides.
> >         >
> >         >         You said *without short sales*, yet this is 100x
> >         leveraged
> >         >         long/short
> >         >         portfolio.
> >         >
> >         >         > Has someone written a nice wrapper to easily get
> >         the min
> >         >         variance portfolio
> >         >         > wo short sales?
> >         >
> >         >
> >         >         I don't know how much nicer you expect than three
> >         lines of
> >         >         code...
> >         >
> >         >         > Any ideas why Eric's code (which I trust) gives a
> >         different
> >         >         answer from
> >         >         > opitimize.portfolio?
> >         >
> >         >
> >         >         You put in the wrong constraints.
> >         >
> >         >         You also don't show the rest of your objective
> >         function here.
> >         >
> >         >         Right now, you're using a 100x leveraged long/short
> >         portfolio
> >         >         and no
> >         >         objective...
> >         >
> >         >         You'll want to fix your min and max arguments, and
> >         have at
> >         >         least one
> >         >         add.objective call.
> >         >
> >         >         Please look at the seminar slides from R/Finance
> >         >
> >         >         http://www.rinfinance.com/agenda/2010/Carl+Peterson
> >         >         +Boudt_Tutorial.pdf
> >         >
> >         >          - Brian
> >         >
> >         >         >
> >         >         > Thanks! Sorry for the cluelessness.
> >         >         >
> >         >         > globalMin.portfolio <-
> >         >         > function(er, cov.mat)
> >         >         > {
> >         >         >   # Compute global minimum variance portfolio
> >         >         >   #
> >         >         >   # inputs:
> >         >         >   # er                                N x 1 vector
> >         of
> >         >         expected returns
> >         >         >   # cov.mat           N x N return covariance
> >         matrix
> >         >         >   #
> >         >         >   # output is portfolio object with the following
> >         elements
> >         >         >   # call                      original function
> >         call
> >         >         >   # er                                portfolio
> >         expected
> >         >         return
> >         >         >   # sd                                portfolio
> >         standard
> >         >         deviation
> >         >         >   # weights           N x 1 vector of portfolio
> >         weights
> >         >         >   call <- match.call()
> >         >         >
> >         >         >   #
> >         >         >   # check for valid inputs
> >         >         >   #
> >         >         >   asset.names <- names(er)
> >         >         >   er <- as.vector(er)
> >         #
> >         >         assign names if none exist
> >         >         >   cov.mat <- as.matrix(cov.mat)
> >         >         >   if(length(er) != nrow(cov.mat))
> >         >         >     stop("invalid inputs")
> >         >         >   if(any(diag(chol(cov.mat)) <= 0))
> >         >         >     stop("Covariance matrix not positive
> >         definite")
> >         >         >   # remark: could use generalized inverse if
> >         cov.mat is
> >         >         positive semi-definite
> >         >         >
> >         >         >   #
> >         >         >   # compute global minimum portfolio
> >         >         >   #
> >         >         >   cov.mat.inv <- solve(cov.mat)
> >         >         >   one.vec <- rep(1,length(er))
> >         >         > #  w.gmin <- cov.mat.inv %*%
> >         one.vec/as.vector(one.vec %*%
> >         >         cov.mat.inv
> >         >         > %*% one.vec)
> >         >         >   w.gmin <- rowSums(cov.mat.inv) /
> >         sum(cov.mat.inv)
> >         >         >   w.gmin <- as.vector(w.gmin)
> >         >         >   names(w.gmin) <- asset.names
> >         >         >   er.gmin <- crossprod(w.gmin,er)
> >         >         >   sd.gmin <- sqrt(t(w.gmin) %*% cov.mat %*%
> >         w.gmin)
> >         >         >   gmin.port <- list("call" = call,
> >         >         >                   "er" = as.vector(er.gmin),
> >         >         >                   "sd" = as.vector(sd.gmin),
> >         >         >                   "weights" = w.gmin)
> >         >         >   class(gmin.port) <- "portfolio"
> >         >         >   gmin.port
> >         >         > }
> >         >         >
> >         >
> >         >         >       [[alternative HTML version deleted]]
> >         >         >
> >         >         > _______________________________________________
> >         >         > R-SIG-Finance at r-project.org mailing list
> >         >         >
> >         https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >         >         > -- Subscriber-posting only. If you want to post,
> >         subscribe
> >         >         first.
> >         >         > -- Also note that this is not the r-help list
> >         where general
> >         >         R questions should go.
> >         >
> >         >         --
> >         >         Brian G. Peterson
> >         >         http://braverock.com/brian/
> >         >         Ph: 773-459-4973
> >         >         IM: bgpbraverock
> >         >
> >         >
> >         >
> >         
> >         --
> >         Brian G. Peterson
> >         http://braverock.com/brian/
> >         Ph: 773-459-4973
> >         IM: bgpbraverock
> >         
> >         
> > 
> > 
> 

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From josh.m.ulrich at gmail.com  Mon Feb 20 00:22:01 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sun, 19 Feb 2012 17:22:01 -0600
Subject: [R-SIG-Finance] Stock Total Returns?
In-Reply-To: <1329605059.58029.YahooMailClassic@web161205.mail.bf1.yahoo.com>
References: <CAAmySGN47UYdcnsJEcvx4wbLK=hMiGXh=iFc8UNQNmOaH-cRzQ@mail.gmail.com>
	<1329605059.58029.YahooMailClassic@web161205.mail.bf1.yahoo.com>
Message-ID: <CAPPM_gROH+RcgFM-LwfHX7ZoB6g30tHysckmoyoA2U2wajGzYg@mail.gmail.com>

There is also quantmod::adjustOHLC, which will provide better adjusted
OHL prices than using the Close / Adjusted Close ratio.
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com



On Sat, Feb 18, 2012 at 4:44 PM, SW <kryp33 at yahoo.com> wrote:
> Hi Michael,
>
> Thanks a lot! You are right. The adjusted prices will give me the correct numbers for total returns. I kind of overlooked it.
>
> Best regards,
> Sergey
>
>
>
>
> --- On Sat, 2/18/12, R. Michael Weylandt <michael.weylandt at gmail.com> wrote:
>
>> From: R. Michael Weylandt <michael.weylandt at gmail.com>
>> Subject: Re: [R-SIG-Finance] Stock Total Returns?
>> To: "SW" <kryp33 at yahoo.com>
>> Cc: r-sig-finance at r-project.org
>> Date: Saturday, February 18, 2012, 5:27 PM
>> I think you're over-thinking this: if
>> you have adjusted prices, they
>> already incorporate splits+dividends --- so the return in
>> adjusted
>> price *is* the total return. (Up to some fuzziness in how
>> that
>> adjustment should be done)
>>
>> Michael
>>
>> On Sat, Feb 18, 2012 at 5:20 PM, SW <kryp33 at yahoo.com>
>> wrote:
>> > Hello All,
>> >
>> >
>> > I am relatively new to R and I am still not very
>> comfortable with syntactic and libraries. Is there are any
>> nice way to calculate and plot total returns for stocks
>> which I would define as change in price and paid dividends?
>> I made a code to do that but the loop that constructs
>> prices+dividends looks ugly(see code below). Any suggestions
>> to do it more efficiently? Thanks. Sergey
>> >
>> > ############## ?CODE
>> ?##################################
>> > library(quantmod)
>> > library(PerformanceAnalytics)
>> >
>> > #Time frame
>> > dt.end = "2010-01-01"
>> > dt.start = ?"2007-01-01"
>> >
>> > tickers = c('SPY',
>> > ? ? ? ? ? ?'XLY',
>> > ? ? ? ? ? ?'XLP',
>> > ? ? ? ? ? ?'XLE',
>> > ? ? ? ? ? ?'XLF',
>> > ? ? ? ? ? ?'XLV',
>> > ? ? ? ? ? ?'XLI',
>> > ? ? ? ? ? ?'XLB',
>> > ? ? ? ? ? ?'XLK',
>> > ? ? ? ? ? ?'XLU')
>> > tickers.desc = c('SNP500',
>> > ? ? ? ? ? ? ? ? 'ConsumerCyclicals',
>> > ? ? ? ? ? ? ? ? 'ConsumerStaples',
>> > ? ? ? ? ? ? ? ? 'Energy',
>> > ? ? ? ? ? ? ? ? 'Financials',
>> > ? ? ? ? ? ? ? ? 'HealthCare',
>> > ? ? ? ? ? ? ? ? 'Industrials',
>> > ? ? ? ? ? ? ? ? 'Materials',
>> > ? ? ? ? ? ? ? ? 'Technology',
>> > ? ? ? ? ? ? ? ? 'Utilities')
>> >
>> > ############ ? ? ? ? ? ? ?Get prices
>> ?###############################
>> > setDefaults(getSymbols,
>> warnings=FALSE,auto.assign=FALSE)
>> > fnPx <- function(i) {
>> return(Ad(getSymbols(tickers[i], from=dt.start,to=dt.end)))
>> }
>> > ts = lapply(1:length(tickers), fnPx)
>> >
>> ###########################################################################
>> >
>> > ############ ? ? ? ? ? ? ?Get Dividends
>> ################################
>> > fnDiv<- function(i) {
>> return(getDividends(tickers[i],
>> from=dt.start,to=dt.end,auto.assign=FALSE)) }
>> > div = lapply(1:length(tickers), fnDiv)
>> >
>> ###########################################################################
>> >
>> > ########### ? ?Create Prices + Dividends (UGLY !!!!)
>> ?#####################
>> > fnTotPx <- function(i)
>> > ?{
>> > ? ?ret = ts[[i]]
>> > ? ?for(j in 1:length(div[[i]]))
>> > ? ?{
>> > ? ? ?row ?= div[[i]][j,]
>> > ? ? ?tm ? = time(row)
>> > ? ? ?val ?= as.double(row[1,1])
>> > ? ? ?iFwd = paste(tm,"::",sep='')
>> > ? ? ?iBk ?= paste("::",tm-1,sep='')
>> > ? ? ?unch = ret[iBk]
>> > ? ? ?chg ?= ret[iFwd]+val
>> > ? ? ?ret = rbind(unch,chg)
>> > ? ?}
>> > ? ?return(ret)
>> > ?}
>> > totPx = lapply(1:length(tickers), fnTotPx)
>> >
>> ############################################################################
>> >
>> >
>> > ################ ? ? ? ? ?Calc Total Returns
>> ##########################
>> > fnRet <- function(i) {
>> return(periodReturn(totPx[[i]],period='daily')) }
>> > ts.ret = lapply(1:length(tickers), fnRet)
>> >
>> > ################ ? ? ? ? ?Plot Total Returns
>> ##########################
>> > ts.ret.df = as.data.frame(ts.ret)
>> > colnames(ts.ret.df)=tickers.desc
>> > chart.CumReturns(ts.ret.df, main="Cumulative
>> Returns",geometric=FALSE,legend.loc="bottomleft")
>> >
>> ############################################################################
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org
>> mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post,
>> subscribe first.
>> > -- Also note that this is not the r-help list where
>> general R questions should go.
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From josh.m.ulrich at gmail.com  Mon Feb 20 14:52:58 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 20 Feb 2012 07:52:58 -0600
Subject: [R-SIG-Finance] Interesting behaviour in BBands
In-Reply-To: <1329609176.75020.YahooMailNeo@web30808.mail.mud.yahoo.com>
References: <1329609176.75020.YahooMailNeo@web30808.mail.mud.yahoo.com>
Message-ID: <CAPPM_gSM+9212sC-cOHmY_1Z0NfnjX6JYz=S4BYxef8th=g2Jg@mail.gmail.com>

Hi Stergios,

On Sat, Feb 18, 2012 at 5:52 PM, Stergios Marinopoulos
<stergios_marinopoulos at yahoo.com> wrote:
> There's an interesting behavior in BBands when dn, mavg, and up are the same
> value.? Here's an example:
>
'dn' and 'up' are functions of 'mavg' and the rolling standard
deviation of the series.  So the real problem is that the standard
deviation is zero for some observations.

>
> library(quantmod);
>
> getSymbols("SPY", from="1993-01-31", to="1996-01-01" ) ;
> bb <- BBands(Cl(SPY), n=3, sd=0.3, maType=EMA) ;
>
>
> bb[bb$pctB==Inf,]
> ??????????????? dn???? mavg?????? up pctB
> 1993-04-16 44.92297 44.92297 44.92297? Inf
> 1995-02-09 48.25296 48.25296 48.25296? Inf
>
>
> And here's the graphic display for the fist Inf occurrence:
>
>
> chartSeries(SPY["1993-04-10::1993-04-20",])
> addTA(bb,on=1)
>
>
> Notice pctB is Inf when the dn & up are coincident with mavg.? I don't think
> Inf is the right interpretation here, as the mavg line is not Inf % between
> the up and down.? Would zero be a better interpretation here?
>
First, _thank_you_ for the reproducible example.  That makes it much
easier for me to investigate and help.

This is a direct result of how Bollinger Bands and pctB are calculated:
    sdev <- runSD(HLC, n, sample = FALSE)
    up <- mavg + sd * sdev
    dn <- mavg - sd * sdev
    pctB <- (HLC - dn)/(up - dn)

Where HLC=Cl(SPY) in your example.  I'm not aware of any special
methods to handle cases when the past 'n' days have the same price and
cause the standard deviation to be zero.  Note that this wouldn't be
an issue if you actually provide HLC data to the function, instead of
only close prices.

>
> Thanks for your thoughts.
>
> --
> Stergios Marinopoulos
>

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com


From kryp33 at yahoo.com  Mon Feb 20 17:31:20 2012
From: kryp33 at yahoo.com (SW)
Date: Mon, 20 Feb 2012 08:31:20 -0800 (PST)
Subject: [R-SIG-Finance] Stock Total Returns?
In-Reply-To: <mailman.1.1329735601.7452.r-sig-finance@r-project.org>
Message-ID: <1329755480.43319.YahooMailClassic@web161206.mail.bf1.yahoo.com>

Joshua,
Thank you for taking the trouble to recalculate adjustment factors based on actual dividends and splits data in quantmod::adjustOHLC function. I guess that the real meat of this function hidden in TTR::adjRatios (Is it native(C/C++) call?)

My original question was based on my incomplete perception of the adjustment process. I always thought that the adjustment is done in order to keep historical prices continues to avoid ex-dividend date drop. To my surprise it also works to produce the correct total returns series. The bigger surprise was that it looks like that it gives the correct calculations not only for simple returns but also for logarithmic returns. I never thought about that before Michael's remark.

Best Regards,
Sergey
 

======================
        .~.      
        /v\      Sergey W. Andreyev
       // \\     kryp33 at yahoo.com
      /(   )\
       ^`~'^
======================
======================


--- On Mon, 2/20/12, r-sig-finance-request at r-project.org <r-sig-finance-request at r-project.org> wrote:

> From: r-sig-finance-request at r-project.org <r-sig-finance-request at r-project.org>
> Subject: R-SIG-Finance Digest, Vol 93, Issue 18
> To: r-sig-finance at r-project.org
> Date: Monday, February 20, 2012, 6:00 AM
> Send R-SIG-Finance mailing list
> submissions to
> ??? r-sig-finance at r-project.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
> ??? https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> or, via email, send a message with subject or body 'help'
> to
> ??? r-sig-finance-request at r-project.org
> 
> You can reach the person managing the list at
> ??? r-sig-finance-owner at r-project.org
> 
> When replying, please edit your Subject line so it is more
> specific
> than "Re: Contents of R-SIG-Finance digest..."
> 
> 
> Today's Topics:
> 
> ???1. Re: Stock Total Returns? (Joshua
> Ulrich)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Sun, 19 Feb 2012 17:22:01 -0600
> From: Joshua Ulrich <josh.m.ulrich at gmail.com>
> To: SW <kryp33 at yahoo.com>
> Cc: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] Stock Total Returns?
> Message-ID:
> ??? <CAPPM_gROH+RcgFM-LwfHX7ZoB6g30tHysckmoyoA2U2wajGzYg at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> There is also quantmod::adjustOHLC, which will provide
> better adjusted
> OHL prices than using the Close / Adjusted Close ratio.
> --
> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
> 
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
> 
> 
> 
> On Sat, Feb 18, 2012 at 4:44 PM, SW <kryp33 at yahoo.com>
> wrote:
> > Hi Michael,
> >
> > Thanks a lot! You are right. The adjusted prices will
> give me the correct numbers for total returns. I kind of
> overlooked it.
> >
> > Best regards,
> > Sergey
> >
> >
> >
> >
> > --- On Sat, 2/18/12, R. Michael Weylandt <michael.weylandt at gmail.com>
> wrote:
> >
> >> From: R. Michael Weylandt <michael.weylandt at gmail.com>
> >> Subject: Re: [R-SIG-Finance] Stock Total Returns?
> >> To: "SW" <kryp33 at yahoo.com>
> >> Cc: r-sig-finance at r-project.org
> >> Date: Saturday, February 18, 2012, 5:27 PM
> >> I think you're over-thinking this: if
> >> you have adjusted prices, they
> >> already incorporate splits+dividends --- so the
> return in
> >> adjusted
> >> price *is* the total return. (Up to some fuzziness
> in how
> >> that
> >> adjustment should be done)
> >>
> >> Michael
> >>
> >> On Sat, Feb 18, 2012 at 5:20 PM, SW <kryp33 at yahoo.com>
> >> wrote:
> >> > Hello All,
> >> >
> >> >
> >> > I am relatively new to R and I am still not
> very
> >> comfortable with syntactic and libraries. Is there
> are any
> >> nice way to calculate and plot total returns for
> stocks
> >> which I would define as change in price and paid
> dividends?
> >> I made a code to do that but the loop that
> constructs
> >> prices+dividends looks ugly(see code below). Any
> suggestions
> >> to do it more efficiently? Thanks. Sergey
> >> >
> >> > ############## ?CODE
> >> ?##################################
> >> > library(quantmod)
> >> > library(PerformanceAnalytics)
> >> >
> >> > #Time frame
> >> > dt.end = "2010-01-01"
> >> > dt.start = ?"2007-01-01"
> >> >
> >> > tickers = c('SPY',
> >> > ? ? ? ? ? ?'XLY',
> >> > ? ? ? ? ? ?'XLP',
> >> > ? ? ? ? ? ?'XLE',
> >> > ? ? ? ? ? ?'XLF',
> >> > ? ? ? ? ? ?'XLV',
> >> > ? ? ? ? ? ?'XLI',
> >> > ? ? ? ? ? ?'XLB',
> >> > ? ? ? ? ? ?'XLK',
> >> > ? ? ? ? ? ?'XLU')
> >> > tickers.desc = c('SNP500',
> >> > ? ? ? ? ? ? ? ? 'ConsumerCyclicals',
> >> > ? ? ? ? ? ? ? ? 'ConsumerStaples',
> >> > ? ? ? ? ? ? ? ? 'Energy',
> >> > ? ? ? ? ? ? ? ? 'Financials',
> >> > ? ? ? ? ? ? ? ? 'HealthCare',
> >> > ? ? ? ? ? ? ? ? 'Industrials',
> >> > ? ? ? ? ? ? ? ? 'Materials',
> >> > ? ? ? ? ? ? ? ? 'Technology',
> >> > ? ? ? ? ? ? ? ? 'Utilities')
> >> >
> >> > ############ ? ? ? ? ? ? ?Get prices
> >> ?###############################
> >> > setDefaults(getSymbols,
> >> warnings=FALSE,auto.assign=FALSE)
> >> > fnPx <- function(i) {
> >> return(Ad(getSymbols(tickers[i],
> from=dt.start,to=dt.end)))
> >> }
> >> > ts = lapply(1:length(tickers), fnPx)
> >> >
> >>
> ###########################################################################
> >> >
> >> > ############ ? ? ? ? ? ? ?Get Dividends
> >> ################################
> >> > fnDiv<- function(i) {
> >> return(getDividends(tickers[i],
> >> from=dt.start,to=dt.end,auto.assign=FALSE)) }
> >> > div = lapply(1:length(tickers), fnDiv)
> >> >
> >>
> ###########################################################################
> >> >
> >> > ########### ? ?Create Prices + Dividends (UGLY
> !!!!)
> >> ?#####################
> >> > fnTotPx <- function(i)
> >> > ?{
> >> > ? ?ret = ts[[i]]
> >> > ? ?for(j in 1:length(div[[i]]))
> >> > ? ?{
> >> > ? ? ?row ?= div[[i]][j,]
> >> > ? ? ?tm ? = time(row)
> >> > ? ? ?val ?= as.double(row[1,1])
> >> > ? ? ?iFwd = paste(tm,"::",sep='')
> >> > ? ? ?iBk ?= paste("::",tm-1,sep='')
> >> > ? ? ?unch = ret[iBk]
> >> > ? ? ?chg ?= ret[iFwd]+val
> >> > ? ? ?ret = rbind(unch,chg)
> >> > ? ?}
> >> > ? ?return(ret)
> >> > ?}
> >> > totPx = lapply(1:length(tickers), fnTotPx)
> >> >
> >>
> ############################################################################
> >> >
> >> >
> >> > ################ ? ? ? ? ?Calc Total Returns
> >> ##########################
> >> > fnRet <- function(i) {
> >> return(periodReturn(totPx[[i]],period='daily')) }
> >> > ts.ret = lapply(1:length(tickers), fnRet)
> >> >
> >> > ################ ? ? ? ? ?Plot Total Returns
> >> ##########################
> >> > ts.ret.df = as.data.frame(ts.ret)
> >> > colnames(ts.ret.df)=tickers.desc
> >> > chart.CumReturns(ts.ret.df, main="Cumulative
> >> Returns",geometric=FALSE,legend.loc="bottomleft")
> >> >
> >>
> ############################################################################
> >> >
> >> >
> _______________________________________________
> >> > R-SIG-Finance at r-project.org
> >> mailing list
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> > -- Subscriber-posting only. If you want to
> post,
> >> subscribe first.
> >> > -- Also note that this is not the r-help list
> where
> >> general R questions should go.
> >>
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post,
> subscribe first.
> > -- Also note that this is not the r-help list where
> general R questions should go.
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-SIG-Finance mailing list
> R-SIG-Finance at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> 
> 
> End of R-SIG-Finance Digest, Vol 93, Issue 18
> *********************************************
>


From ccquant at gmail.com  Mon Feb 20 19:25:44 2012
From: ccquant at gmail.com (Ben quant)
Date: Mon, 20 Feb 2012 11:25:44 -0700
Subject: [R-SIG-Finance] yahoo data request policy - quantstrat/quantmod
Message-ID: <CAG2PC+cf234Ey+odfQukpWMiNYD-zJ7Lo7CCcJWEM7NuaRCUUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120220/8e3a1304/attachment.pl>

From jeff.a.ryan at gmail.com  Mon Feb 20 19:51:48 2012
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 20 Feb 2012 12:51:48 -0600
Subject: [R-SIG-Finance] yahoo data request policy - quantstrat/quantmod
In-Reply-To: <CAG2PC+cf234Ey+odfQukpWMiNYD-zJ7Lo7CCcJWEM7NuaRCUUg@mail.gmail.com>
References: <CAG2PC+cf234Ey+odfQukpWMiNYD-zJ7Lo7CCcJWEM7NuaRCUUg@mail.gmail.com>
Message-ID: <7A96C404-597E-4765-B815-1ADA43B25146@gmail.com>

The code itself (getSymbols) uses a 1s between request convention. If you pass a request of less than 5 symbols at a time the request has no delay. 

I general, 1s between requests seems like a reasonable number, but entirely arbitrary. You can of course modify the internals if you want, but it isn't just a parameter to somewhat force quantmod users to be friendly toward the free providers. 

Best,
Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Feb 20, 2012, at 12:25 PM, Ben quant <ccquant at gmail.com> wrote:

> Re-posting as a (new) member this time...
> 
> Hello,
> 
> For testing I am requesting data via the quantstrat/quantmod package using
> getSymbols() via the default settings. It uses Yahoo Finance as the data
> provider by default. I assume that the data is sourced directly from Yahoo
> each request (because of this sentence from ?getSymbols: "The ?sourcing? of
> data is managed internally through a complex lookup procedure.").
> 
> What is yahoo's data request frequency policy? How often and how much data
> can I request from Yahoo (and/or other available sources) without hearing
> from the Yahoo data team? I'm use to using our internal sources so I am not
> very familiar with external sources.
> 
> PS - I have an email out to Yahoo support already, but would like to get
> the "in practice" feedback from the community.
> 
> Regards,
> 
> Ben
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From varcovar at live.com  Tue Feb 21 11:54:22 2012
From: varcovar at live.com (varcovar)
Date: Tue, 21 Feb 2012 02:54:22 -0800 (PST)
Subject: [R-SIG-Finance] Quantstrat: buy at tomorrow open
Message-ID: <1329821662880-4406666.post@n4.nabble.com>

Hi, 

I am working on a weekly strategy in quantstrat. I use weekly bars that end
on Friday and I want to place trades on Monday at the open. My question is:
Where can I tell quantstrat which column it should use for placing trades? 

My first idea was to put the next Monday Open into the Friday Close column
and use another column name for the Friday Close so that quantstrat would
calculate the indicators and apply the rules I want, but it can become
confusing. 

Any idea? Thanks! 

Markus Douglas

--
View this message in context: http://r.789695.n4.nabble.com/Quantstrat-buy-at-tomorrow-open-tp4406666p4406666.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From varcovar at live.com  Tue Feb 21 11:54:22 2012
From: varcovar at live.com (varcovar)
Date: Tue, 21 Feb 2012 02:54:22 -0800 (PST)
Subject: [R-SIG-Finance] Quantstrat: buy at tomorrow open
Message-ID: <1329821662783-4406665.post@n4.nabble.com>

Hi, 

I am working on a weekly strategy in quantstrat. I use weekly bars that end
on Friday and I want to place trades on Monday at the open. My question is:
Where can I tell quantstrat which column it should use for placing trades? 

My first idea was to put the next Monday Open into the Friday Close column
and use another column name for the Friday Close so that quantstrat would
calculate the indicators and apply the rules I want, but it can become
confusing. 

Any idea? Thanks! 

Markus Douglas

--
View this message in context: http://r.789695.n4.nabble.com/Quantstrat-buy-at-tomorrow-open-tp4406665p4406665.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From papa.senyo at yahoo.it  Tue Feb 21 16:24:44 2012
From: papa.senyo at yahoo.it (Papa Senyo)
Date: Tue, 21 Feb 2012 15:24:44 +0000 (GMT)
Subject: [R-SIG-Finance] Getting different days ahead forecast apart from of
	1-day ahead using rugarch
Message-ID: <1329837884.23428.YahooMailNeo@web132305.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120221/5dbb654d/attachment.pl>

From comtech.usa at gmail.com  Tue Feb 21 22:05:59 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 21 Feb 2012 15:05:59 -0600
Subject: [R-SIG-Finance] correlation based time series clustering?
Message-ID: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120221/899f3688/attachment.pl>

From stergios_marinopoulos at yahoo.com  Tue Feb 21 22:28:00 2012
From: stergios_marinopoulos at yahoo.com (Stergios Marinopoulos)
Date: Tue, 21 Feb 2012 13:28:00 -0800 (PST)
Subject: [R-SIG-Finance] Interesting behaviour in BBands
In-Reply-To: <CAPPM_gSM+9212sC-cOHmY_1Z0NfnjX6JYz=S4BYxef8th=g2Jg@mail.gmail.com>
References: <1329609176.75020.YahooMailNeo@web30808.mail.mud.yahoo.com>
	<CAPPM_gSM+9212sC-cOHmY_1Z0NfnjX6JYz=S4BYxef8th=g2Jg@mail.gmail.com>
Message-ID: <1329859680.56129.YahooMailNeo@web30802.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120221/ea065389/attachment.pl>

From Mishuk.Chowdhury at tdameritrade.com  Tue Feb 21 23:23:28 2012
From: Mishuk.Chowdhury at tdameritrade.com (Mishuk.Chowdhury at tdameritrade.com)
Date: Tue, 21 Feb 2012 22:23:28 +0000
Subject: [R-SIG-Finance] Imaginary root / complex number in a Gamma function
Message-ID: <4EA3586A73F78E45A9019A1A7B75D45FF89E2C@PRDCTWPEMLMB01.prod-am.ameritrade.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120221/e963ba9b/attachment.pl>

From dhruv.maheshwari at blackrock.com  Tue Feb 21 23:56:24 2012
From: dhruv.maheshwari at blackrock.com (Maheshwari, Dhruv)
Date: Tue, 21 Feb 2012 17:56:24 -0500
Subject: [R-SIG-Finance] Imaginary root / complex number in a Gamma
	function
In-Reply-To: <4EA3586A73F78E45A9019A1A7B75D45FF89E2C@PRDCTWPEMLMB01.prod-am.ameritrade.com>
References: <4EA3586A73F78E45A9019A1A7B75D45FF89E2C@PRDCTWPEMLMB01.prod-am.ameritrade.com>
Message-ID: <736BD99954017349AA38025412DA2A8644B585CC7D@EXCHAMRS04.na.blkint.com>

This question is not directly finance-related, and is better suited for R-help.

But to quickly answer your question: see packages fAsianOptions and gsl. cgamma in the former, and you'll need to read the documentation more closely for the latter (try ?gsl::gamma)

- Dhruv

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Mishuk.Chowdhury at tdameritrade.com
Sent: Tuesday, February 21, 2012 17:23
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] Imaginary root / complex number in a Gamma function

Hi all,

I am trying to calculate the value of a gamma function with a complex number.

I'm getting this error:

> testfunc = function(d,z)
+ {
+   gamma(complex(real = d, imaginary = z)) }
>
> testfunc(1,2)


Error in gamma(complex(real = d, imaginary = z)) :
  unimplemented complex function



Is there a package that allows complex numbers within Gamma functions? Any other alternatives?

Thanks!

-Mishuk




	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

THIS MESSAGE AND ANY ATTACHMENTS ARE CONFIDENTIAL, PROPRIETARY, AND MAY BE PRIVILEGED.  If this message was misdirected, BlackRock, Inc. and its subsidiaries, ("BlackRock") does not waive any confidentiality or privilege.  If you are not the intended recipient, please notify us immediately and destroy the message without disclosing its contents to anyone.  Any distribution, use or copying of this e-mail or the information it contains by other than an intended recipient is unauthorized.  The views and opinions expressed in this e-mail message are the author's own and may not reflect the views and opinions of BlackRock, unless the author is authorized by BlackRock to express such views or opinions on its behalf.  All email sent to or from this address is subject to electronic storage and review by BlackRock.  Although BlackRock operates anti-virus programs, it does not accept responsibility for any damage whatsoever caused by viruses being passed.


From paul.ramer at gmail.com  Wed Feb 22 00:08:19 2012
From: paul.ramer at gmail.com (Paul Ramer)
Date: Tue, 21 Feb 2012 16:08:19 -0700
Subject: [R-SIG-Finance] customizing format of yaxis annotation Performance
	Analytics
Message-ID: <CAGr519qocKfeE1RUst547dDK2Rbpb-iP1n+XT+aT8DmGzzDvWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120221/324d80f7/attachment.pl>

From peter at braverock.com  Wed Feb 22 01:24:50 2012
From: peter at braverock.com (Peter Carl)
Date: Tue, 21 Feb 2012 18:24:50 -0600
Subject: [R-SIG-Finance] customizing format of yaxis annotation
 Performance Analytics
In-Reply-To: <CAGr519qocKfeE1RUst547dDK2Rbpb-iP1n+XT+aT8DmGzzDvWQ@mail.gmail.com>
References: <CAGr519qocKfeE1RUst547dDK2Rbpb-iP1n+XT+aT8DmGzzDvWQ@mail.gmail.com>
Message-ID: <5241e2334877c3c6dd208ce8e24660ed.squirrel@mail.braverock.com>

Paul,

In the future, please post a reproducible example.

> ?chart.TimeSeries
> data(managers)
> chart.TimeSeries(managers[,1]) # Normal plot
> chart.TimeSeries(managers[,1], yaxis=FALSE)
> axis(2, at=pretty(managers[,1]), labels=sprintf("%s%%",
pretty(managers[,1]) * 100))

Is this what you're looking for?

pcc
-- 
Peter Carl
http://www.braverock.com/~peter

> I am trying to change the format of my yaxis annotation for
> chart.TimeSeries (really chart.CumReturns and chart.Drawdown) from numeric
> decimal to a percentage.
>
> Something like:
>
> axis(2, at=pretty(y), labels=sprintf("%s%%", pretty(y) * 100)
>
>
> I have been looking for a solution all afternoon with no success. I saw
> nothing in the PerformanceAnalytics documentation. I tried suppressing the
> y-axis (yaxt='n') in chart.TimeSeries and then add my own custom y-axis.
> For my final effort,I copied the code from chart.TimeSeries and created my
> own custom.chart.TimeSeries by tweaking the yaxis code to accomplish my
> goals.
>
> I would like to know if there is any elegant solution I am missing before
> I
> pursue a more brute force method.
>
> Thanks,
> Paul
> ----
> Paul Ramer, CAIA
> PJR Investment Strategies, ltd.
> paul.ramer at gmail.com
> (303) 359-4192
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From alexios at 4dscape.com  Wed Feb 22 16:19:45 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Wed, 22 Feb 2012 15:19:45 +0000
Subject: [R-SIG-Finance] Getting different days ahead forecast apart
 from of 1-day ahead using rugarch
In-Reply-To: <1329837884.23428.YahooMailNeo@web132305.mail.ird.yahoo.com>
References: <1329837884.23428.YahooMailNeo@web132305.mail.ird.yahoo.com>
Message-ID: <4F450791.4090107@4dscape.com>

Once again Emmanuel you are not reading the documentation.

library(rugarch)
data(sp500ret)
spec = ugarchspec(variance.model = list(model = "eGARCH"), 
distribution.model = "norm")
rollD = ugarchroll(spec, data = sp500ret, n.ahead = 3, forecast.length = 
500,
refit.every = 25, refit.window = "recursive", calculate.VaR = TRUE, 
VaR.alpha = c(0.01, 0.05))

class(rollD)
"uGARCHroll"
attr(,"package")
[1] "rugarch"

?'uGARCHroll-class'
Where it is clearly stated what each method on the returned object does, 
and how to extract exactly what you need. Every class and method
in rugarch is documented.

The extractor method (as.data.frame) clearly states how you can pass the 
'n.ahead' as an option to extract that particular series, and the 
'which' option indicates what you want to extract from the object:

e.g.

n2d = as.data.frame(rollD, which = "density",n.ahead = 2)
head(n2d,3)
          fdate           fmu      fsigma         fskew fshape
roll-1   2007-02-06  2.421884e-04 0.005658718     0      0
roll-2   2007-02-07  2.331122e-04 0.005582674     0      0
roll-3   2007-02-08  2.364455e-04 0.005379911     0      0

head(n3d,3)
n3d = as.data.frame(rollD, which = "density",n.ahead = 3)

          fdate           fmu      fsigma        fskew fshape
roll-1   2007-02-07  2.366104e-04 0.005728963     0      0
roll-2   2007-02-08  2.351039e-04 0.005653518     0      0
roll-3   2007-02-09  2.356572e-04 0.005452251     0      0

The returned density is the forecasted values produced by the model 
(conditional mean, sigma, skew[constant] and shape[constant]). It even 
returns the dates for you so that you can clearly see the horizon 
involved (assuming the original data you passed had dates).

Given the forecasted density parameters you can then calculate any 
measure from the distribution e.g.
qdist("norm",p=0.05,mu = n2d[1,"fmu"],sigma = n2d[1,"fsigma"])
or simpler still (in this case):
n2d[1,"fmu"]+ n2d[1,"fsigma"]*qnorm(0.05)

Finally keep in mind that when n.ahead>1, this represents the 
unconditional forecast.

Regards,
Alexios

On 21/02/2012 15:24, Papa Senyo wrote:
> Dear All,
> Please, how can we get different days ahead forecast using rugarch package.
> I used the commands below to get the 1.day ahead forecast but change the n.ahead forecast in the code below has no effect as it still report one day ahead forecast. Hope to hear from you all. Thanks papa
> spece = ugarchspec(variance.model = list(model = "eGARCH"), distribution.model = "norm")
>   rollD = ugarchroll(spece, data = as.numeric(E.rtdm), n.ahead = 1, forecast.length = 500,
> +  refit.every = 25, refit.window = "recursive", parallel = TRUE,
> +  parallel.control = list(pkg = "snowfall", cores = 10), solver = "solnp",
> +  solver.control = list(tol = 1e-05, delta = 1e-06, trace = 0),
> +  calculate.VaR = TRUE, VaR.alpha = c(0.01, 0.05))
>
>
>   report(rollD, type="fpm")
>
> GARCH Roll Mean Forecast Performance Measures
> ---------------------------------------------
> Model : eGARCH
> no.refits : 20
> n.ahead   : 1
> n.rolls   : 500
>
>      n.ahead.1
>
> 	[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From j_cuisinier at hotmail.com  Thu Feb 23 10:29:08 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Thu, 23 Feb 2012 10:29:08 +0100
Subject: [R-SIG-Finance] correlation based time series clustering?
In-Reply-To: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>
References: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>
Message-ID: <COL102-W19145890EDF363AF0666CB8F650@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120223/4c830018/attachment.pl>

From Murali.Menon at avivainvestors.com  Thu Feb 23 10:47:52 2012
From: Murali.Menon at avivainvestors.com (Murali.Menon at avivainvestors.com)
Date: Thu, 23 Feb 2012 09:47:52 +0000
Subject: [R-SIG-Finance] correlation based time series clustering?
In-Reply-To: <COL102-W19145890EDF363AF0666CB8F650@phx.gbl>
References: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>
	<COL102-W19145890EDF363AF0666CB8F650@phx.gbl>
Message-ID: <05C1ABBB41112A4DB61380AD45F18EB61E879B379D@SWVLONCUEXDP01.im.root-domain.net>

Folks,

There's been quite a bit of work on clustering in finance:

http://www.mendeley.com/research/correlation-based-hierarchical-clustering-in-financial-time-series/

I think many of Mantegna's works are available for download.

Very simply, though, you can calculate a correlation matrix given your time series of returns, and then apply, say, a medoid-clustering scheme (e.g. the pam function in package 'cluster') and see what happens. According to Mantegna, if you do this on the components of the Dow Jones, the various industrial types very naturally form individual clusters.

Hope this helps.

Murali

-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of julien cuisinier
Sent: 23 February 2012 09:29
To: comtech.usa at gmail.com; r-sig-finance at stat.math.ethz.ch
Subject: Re: [R-SIG-Finance] correlation based time series clustering?


Hi Michael,



A very general question here with little input from you...I am not surprised to see little feedback

I have been looking for something similar & same result so I do not think it exist yet. I am a complete newbie in clustering but looking around there are plenty of R function available, nothing that I could find as simple as using correlation per se. 

Thinking about it Im not sure how it would work & anything I can think of would be quite sensitive to the starting point (e.g. calculate pair-wise correls within a market, then start by one stock & cluster with it all other stocks with corrells higher than a certain threshold?) May be some recursive function trying many different starting points? But then what to do with the resulting different cluster structure? 

Could you share with the list what reference (not in R) you found on the topic? That would be great if you could share / bring something to the list as well & then see if we can build that in? (very very ambitious of me here =)



Thanks & regards,
Julien









> Date: Tue, 21 Feb 2012 15:05:59 -0600
> From: comtech.usa at gmail.com
> To: r-sig-finance at stat.math.ethz.ch
> Subject: [R-SIG-Finance] correlation based time series clustering?
> 
> Hi all,
> 
> I am looking for a function for correlation based time-series clustering in
> R... I have googled for quite a while and couldn't find any in R...
> 
> Could you please help me?
> 
> Thanks a lot!
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
 		 	   		  
	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From j_cuisinier at hotmail.com  Thu Feb 23 10:58:46 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Thu, 23 Feb 2012 10:58:46 +0100
Subject: [R-SIG-Finance] correlation based time series clustering?
In-Reply-To: <05C1ABBB41112A4DB61380AD45F18EB61E879B379D@SWVLONCUEXDP01.im.root-domain.net>
References: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>,
	<COL102-W19145890EDF363AF0666CB8F650@phx.gbl>,
	<05C1ABBB41112A4DB61380AD45F18EB61E879B379D@SWVLONCUEXDP01.im.root-domain.net>
Message-ID: <COL102-W656FB6999208C3CCFCD4E8F650@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120223/31c97189/attachment.pl>

From patrick at burns-stat.com  Thu Feb 23 10:59:20 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 23 Feb 2012 09:59:20 +0000
Subject: [R-SIG-Finance] correlation based time series clustering?
In-Reply-To: <05C1ABBB41112A4DB61380AD45F18EB61E879B379D@SWVLONCUEXDP01.im.root-domain.net>
References: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>
	<COL102-W19145890EDF363AF0666CB8F650@phx.gbl>
	<05C1ABBB41112A4DB61380AD45F18EB61E879B379D@SWVLONCUEXDP01.im.root-domain.net>
Message-ID: <4F460DF8.3010803@burns-stat.com>

You can just use:

1 - cor.matrix

as your distance matrix in the clustering
(there are lots of choices in R).

You can see how stable your results are by
using bootstrap estimates of the correlation.

Pat

On 23/02/2012 09:47, Murali.Menon at avivainvestors.com wrote:
> Folks,
>
> There's been quite a bit of work on clustering in finance:
>
> http://www.mendeley.com/research/correlation-based-hierarchical-clustering-in-financial-time-series/
>
> I think many of Mantegna's works are available for download.
>
> Very simply, though, you can calculate a correlation matrix given your time series of returns, and then apply, say, a medoid-clustering scheme (e.g. the pam function in package 'cluster') and see what happens. According to Mantegna, if you do this on the components of the Dow Jones, the various industrial types very naturally form individual clusters.
>
> Hope this helps.
>
> Murali
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of julien cuisinier
> Sent: 23 February 2012 09:29
> To: comtech.usa at gmail.com; r-sig-finance at stat.math.ethz.ch
> Subject: Re: [R-SIG-Finance] correlation based time series clustering?
>
>
> Hi Michael,
>
>
>
> A very general question here with little input from you...I am not surprised to see little feedback
>
> I have been looking for something similar&  same result so I do not think it exist yet. I am a complete newbie in clustering but looking around there are plenty of R function available, nothing that I could find as simple as using correlation per se.
>
> Thinking about it Im not sure how it would work&  anything I can think of would be quite sensitive to the starting point (e.g. calculate pair-wise correls within a market, then start by one stock&  cluster with it all other stocks with corrells higher than a certain threshold?) May be some recursive function trying many different starting points? But then what to do with the resulting different cluster structure?
>
> Could you share with the list what reference (not in R) you found on the topic? That would be great if you could share / bring something to the list as well&  then see if we can build that in? (very very ambitious of me here =)
>
>
>
> Thanks&  regards,
> Julien
>
>
>
>
>
>
>
>
>
>> Date: Tue, 21 Feb 2012 15:05:59 -0600
>> From: comtech.usa at gmail.com
>> To: r-sig-finance at stat.math.ethz.ch
>> Subject: [R-SIG-Finance] correlation based time series clustering?
>>
>> Hi all,
>>
>> I am looking for a function for correlation based time-series clustering in
>> R... I have googled for quite a while and couldn't find any in R...
>>
>> Could you please help me?
>>
>> Thanks a lot!
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>   		 	   		
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From zoonek at gmail.com  Thu Feb 23 11:17:17 2012
From: zoonek at gmail.com (Vincent Zoonekynd)
Date: Thu, 23 Feb 2012 19:17:17 +0900
Subject: [R-SIG-Finance] correlation based time series clustering?
In-Reply-To: <COL102-W19145890EDF363AF0666CB8F650@phx.gbl>
References: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>
	<COL102-W19145890EDF363AF0666CB8F650@phx.gbl>
Message-ID: <CAMS6tpe5j5oJ16e44XjYeHK_TJq_C+cTzPONN97QSi40-ygjSA@mail.gmail.com>

Here are a few ideas to cluster time series,
with more references.

1. Build the minimum spanning tree on the correlation
matrix. The result is usually very noisy: you may
want to resample the data to see how the trees
change.
This usually gives acceptable results: for
instance, you can often recognise industry groups
from daily or weekly stock returns.
A few references:
  An introduction to econophysics, Correlations and complexity in
finance, R.N. Mantegna and H.E. Stanley (2000)
  http://arxiv.org/abs/cond-mat/0302546
  http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1617257
  http://arxiv.org/abs/0806.4714
  http://arxiv.org/abs/0708.0562
  http://arxiv.org/abs/cond-mat/0412411

2. Threshold the correlation matrix and consider the
result as the incidence matrix of a graph: its
connected components can be interpreted as
clusters.

3. Convert the correlation matrix to a distance
matrix, and apply the standard clustering
algorithms: k-means, hierarchical clustering,
Kohonen networks, etc.  You may want to try these
with various estimators of the correlation matrix:
for instance, shrinkage estimators should help
reduce the noise in the data.

4. If you accept methods not based on correlation,
you can model your times series, e.g., with
econometric models (ARMA, GARCH, etc.), stochastic
differential equations (the "Markov operator
distance" at the end of "Option pricing and
estimation of financial models with R", by
S.M. Iacus), wavelet decomposition, iSAX
(http://www.cs.ucr.edu/~eamonn/iSAX/iSAX.html),
etc., and cluster the coefficients of those
models.

-- Vincent

On 23 February 2012 18:29, julien cuisinier <j_cuisinier at hotmail.com> wrote:
>
> Hi Michael,
>
>
>
> A very general question here with little input from you...I am not surprised to see little feedback
>
> I have been looking for something similar & same result so I do not think it exist yet. I am a complete newbie in clustering but looking around there are plenty of R function available, nothing that I could find as simple as using correlation per se.
>
> Thinking about it Im not sure how it would work & anything I can think of would be quite sensitive to the starting point (e.g. calculate pair-wise correls within a market, then start by one stock & cluster with it all other stocks with corrells higher than a certain threshold?) May be some recursive function trying many different starting points? But then what to do with the resulting different cluster structure?
>
> Could you share with the list what reference (not in R) you found on the topic? That would be great if you could share / bring something to the list as well & then see if we can build that in? (very very ambitious of me here =)
>
>
>
> Thanks & regards,
> Julien


From sethy.anmol at gmail.com  Thu Feb 23 12:32:56 2012
From: sethy.anmol at gmail.com (anmol sethy)
Date: Thu, 23 Feb 2012 19:32:56 +0800
Subject: [R-SIG-Finance] correlation based time series clustering?
In-Reply-To: <CAMS6tpe5j5oJ16e44XjYeHK_TJq_C+cTzPONN97QSi40-ygjSA@mail.gmail.com>
References: <CAPNjSFaRup3p6ZAY=RAcM06rR_epzpMYprdb0Vd-zV2-Wu1xHg@mail.gmail.com>
	<COL102-W19145890EDF363AF0666CB8F650@phx.gbl>
	<CAMS6tpe5j5oJ16e44XjYeHK_TJq_C+cTzPONN97QSi40-ygjSA@mail.gmail.com>
Message-ID: <CAMRMz7K0VrLKMVfmTXUUU21enVRZdRRqAgCpYX4MFaeBY62Bdg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120223/646c53c9/attachment.pl>

From vnatanelov at gmail.com  Thu Feb 23 17:22:29 2012
From: vnatanelov at gmail.com (vnatanel)
Date: Thu, 23 Feb 2012 08:22:29 -0800 (PST)
Subject: [R-SIG-Finance] how to substract one matrix from other with
 respect to each element (according to same position)
In-Reply-To: <1328971773709-4379068.post@n4.nabble.com>
References: <1328971773709-4379068.post@n4.nabble.com>
Message-ID: <1330014149799-4414337.post@n4.nabble.com>

quite simple...  *z-m*  should do the trick


--
View this message in context: http://r.789695.n4.nabble.com/how-to-substract-one-matrix-from-other-with-respect-to-each-element-according-to-same-position-tp4379068p4414337.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From devinlnewman at gmail.com  Thu Feb 23 19:49:39 2012
From: devinlnewman at gmail.com (Devin Newman)
Date: Thu, 23 Feb 2012 13:49:39 -0500
Subject: [R-SIG-Finance] Quantmod's getFin() functionality broken?
Message-ID: <CALA=y+f8eFCdF_j3qk04W0e5xkhOPUmanEa39CQvDD6EJESEBg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120223/0e0d8388/attachment.pl>

From jeffrey.ryan at lemnica.com  Thu Feb 23 19:52:16 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 23 Feb 2012 12:52:16 -0600
Subject: [R-SIG-Finance] Quantmod's getFin() functionality broken?
In-Reply-To: <CALA=y+f8eFCdF_j3qk04W0e5xkhOPUmanEa39CQvDD6EJESEBg@mail.gmail.com>
References: <CALA=y+f8eFCdF_j3qk04W0e5xkhOPUmanEa39CQvDD6EJESEBg@mail.gmail.com>
Message-ID: <CABDUZc8=kx6CmW8=_+MKCeqw6NmP9DT9Z5K5HNoHxQ5dW2txnw@mail.gmail.com>

Warning != Error

This is a result of google not using the correct end of line in the
page, and/or R stripping/missing it.

Either way, it doesn't matter - as it is a harmless warning.

HTH
Jeff

On Thu, Feb 23, 2012 at 12:49 PM, Devin Newman <devinlnewman at gmail.com> wrote:
> Hello r-sig-finance!
>
> This is my first post to the list, so I hope you can bear what might be a
> silly question. Previously, I've had no trouble using quantmod's getFin()
> function to pull data. However, lately it hasn't been working. I think one
> of the functions called within getFin to clean up the data isn't working as
> intended.
>
>> AAPL <- getFin('AAPL', src="google")
> Warning message:
> In readLines(tmp) :
> ?incomplete final line found on
> '/var/folders/rf/pz5jmyzd1q9833s7h6r5lpzr0000gn/T//RtmpwUJi6G/file2e051531243'
>
>> AAPL <- getFin('AAPL', src="yahoo")
> Warning message:
> In readLines(tmp) :
> ?incomplete final line found on
> '/var/folders/rf/pz5jmyzd1q9833s7h6r5lpzr0000gn/T//RtmpwUJi6G/file2e024d4166b'
>
> Regardless of 'src' I get equivalent errors, "incomplete final line".
> Rather than immediately dive in and troubleshoot the code (although
> perusing through it was a great lesson in how to write R), I was hoping to
> share my issue here to see if others had similar problems, as I don't think
> this is merely the result of a formatting change on google/yahoo finance.
>
> Any help would be appreciated.
>
> Kind regards,
> Devin Newman
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From jeffrey.ryan at lemnica.com  Thu Feb 23 20:16:03 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Thu, 23 Feb 2012 13:16:03 -0600
Subject: [R-SIG-Finance] Quantmod's getFin() functionality broken?
In-Reply-To: <CALA=y+c+NrOX=23psZDPefgAA8U_s2Gt-OJRUpBjkOHBrnqrqg@mail.gmail.com>
References: <CALA=y+f8eFCdF_j3qk04W0e5xkhOPUmanEa39CQvDD6EJESEBg@mail.gmail.com>
	<CABDUZc8=kx6CmW8=_+MKCeqw6NmP9DT9Z5K5HNoHxQ5dW2txnw@mail.gmail.com>
	<CALA=y+c+NrOX=23psZDPefgAA8U_s2Gt-OJRUpBjkOHBrnqrqg@mail.gmail.com>
Message-ID: <CABDUZc_U_1g4TQdQJquyQhi-nY0ZoFCscXavaBKgt_Jy7JOscg@mail.gmail.com>

Hi Devin (cc'ing the list back in),

On Thu, Feb 23, 2012 at 1:07 PM, Devin Newman <devinlnewman at gmail.com> wrote:
> Jeffrey,
>
> I would agree except that what is assigned to the variable is only a string
> of characters. Is there something I am doing wrong?
>
>> getSymbols("GS")
> [1] "GS"
>> str(GS)
> An ?xts? object from 2007-01-03 to 2012-02-22 containing:
> ? Data: num [1:1295, 1:6] 201 200 198 199 204 ...
> ?- attr(*, "dimnames")=List of 2
> ? ..$ : NULL
> ? ..$ : chr [1:6] "GS.Open" "GS.High" "GS.Low" "GS.Close" ...
> ? Indexed by objects of class: [Date] TZ:
> ? xts Attributes:
> List of 2
> ?$ src ? ?: chr "yahoo"
> ?$ updated: POSIXct[1:1], format: "2012-02-23 14:02:41"
>
>
>> GS.f <- getFinancials('GS')
> Warning message:
> In readLines(tmp) :
> ? incomplete final line found on
> '/var/folders/rf/pz5jmyzd1q9833s7h6r5lpzr0000gn/T//RtmpwUJi6G/file2e02463e31e'
>> GS.f
> [1] "GS.f"
>> str(GS.f)
> ?chr "GS.f"
>> viewFin(GS.f)
> Error in viewFin(GS.f) : ?x? must be of type ?financials?
>

Ah, the 'real' error you saw but didn't pass along the first time.
Likely an older version of quantmod - as the one I am using (the one
from R-forge) is working.

Try install.packages("quantmod", repos="http://r-forge.r-project.org")

Best,
Jeff

> getFin("GS")
[1] "GS.f"
Warning message:
In readLines(tmp) :
  incomplete final line found on
'/var/folders/vk/vk7l7h-xFauxrClyj6pEJU+++TI/-Tmp-//Rtmpulwo2L/file3e652376'
> viewFin(GS.f)
Annual Balance Sheet for GS
                                             2010-12-31 2009-12-31 2008-12-26
Cash & Equivalents                             34038.00   33841.00   13805.00
Short Term Investments                               NA         NA         NA
Cash and Short Term Investments                39788.00   38291.00   13805.00
Accounts Receivable - Trade, Net               78140.00   67900.00   86377.00
Receivables - Other                                  NA         NA         NA
Total Receivables, Net                         78140.00   67900.00   86377.00
Total Inventory                                      NA         NA         NA
Prepaid Expenses                                     NA         NA         NA
Other Current Assets, Total                          NA         NA         NA
Total Current Assets                                 NA         NA         NA
Property/Plant/Equipment, Total - Gross        18976.00   18660.00   19209.00
Accumulated Depreciation, Total                -7870.00   -7280.00   -6620.00
Goodwill, Net                                   3495.00    3543.00    3526.00
Intangibles, Net                                2027.00    1377.00    1620.00
Long Term Investments                         713059.00  678104.00  869279.00
Other Long Term Assets, Total                  59970.00   44600.00  121890.00
Total Assets                                  911332.00  848942.00 1112225.00
Accounts Payable                              190504.00  185634.00  245725.00
Accrued Expenses                                9089.00   11170.00    4968.00
Notes Payable/Short Term Debt                  80680.00   60681.00   68675.00
Current Port. of LT Debt/Capital Leases        25396.00   17928.00   24274.00
Other Current liabilities, Total               40611.00   43440.00   35249.00
Total Current Liabilities                            NA         NA         NA
Long Term Debt                                188247.00  196288.00  203977.00
Capital Lease Obligations                            NA         NA         NA
Total Long Term Debt                          188247.00  196288.00  203977.00
Total Debt                                    294323.00  274897.00  296926.00
Deferred Income Tax                                  NA         NA         NA
Minority Interest                                872.00     960.00    1102.00
Other Liabilities, Total                      293927.00  257284.00  459324.00
Total Liabilities                             833976.00  778228.00 1049171.00
Redeemable Preferred Stock, Total                    NA         NA         NA
Preferred Stock - Non Redeemable, Net           6957.00    6957.00   16483.00
Common Stock, Total                             7714.00    6253.00    9470.00
Additional Paid-In Capital                     42103.00   39770.00   31070.00
Retained Earnings (Accumulated Deficit)        57163.00   50252.00   38579.00
Treasury Stock - Common                       -36295.00  -32156.00  -32176.00
Other Equity, Total                             -286.00    -362.00    -372.00
Total Equity                                   77356.00   70714.00   63054.00
Total Liabilities & Shareholders&#39; Equity  911332.00  848942.00 1112225.00
Shares Outs - Common Stock Primary Issue             NA         NA         NA
Total Common Shares Outstanding                  507.53     515.11     442.55
                                             2008-11-28
Cash & Equivalents                             15740.00
Short Term Investments                               NA
Cash and Short Term Investments                15740.00
Accounts Receivable - Trade, Net               90564.00
Receivables - Other                                  NA
Total Receivables, Net                         90564.00
Total Inventory                                      NA
Prepaid Expenses                                     NA
Other Current Assets, Total                          NA
Total Current Assets                                 NA
Property/Plant/Equipment, Total - Gross        17343.00
Accumulated Depreciation, Total                -6550.00
Goodwill, Net                                   3523.00
Intangibles, Net                                1529.00
Long Term Investments                         642595.00
Other Long Term Assets, Total                 115023.00
Total Assets                                  884547.00
Accounts Payable                              253843.00
Accrued Expenses                                4646.00
Notes Payable/Short Term Debt                  68877.00
Current Port. of LT Debt/Capital Leases        26281.00
Other Current liabilities, Total               30508.00
Total Current Liabilities                            NA
Long Term Debt                                185678.00
Capital Lease Obligations                            NA
Total Long Term Debt                          185678.00
Total Debt                                    280836.00
Deferred Income Tax                                  NA
Minority Interest                               1127.00
Other Liabilities, Total                      244830.00
Total Liabilities                             820178.00
Redeemable Preferred Stock, Total                    NA
Preferred Stock - Non Redeemable, Net          16471.00
Common Stock, Total                             9291.00
Additional Paid-In Capital                     31071.00
Retained Earnings (Accumulated Deficit)        39913.00
Treasury Stock - Common                       -32175.00
Other Equity, Total                             -202.00
Total Equity                                   64369.00
Total Liabilities & Shareholders&#39; Equity  884547.00
Shares Outs - Common Stock Primary Issue             NA
Total Common Shares Outstanding                  442.54
attr(,"col_desc")
[1] "As of 2010-12-31" "As of 2009-12-31" "As of 2008-12-26" "As of 2008-11-28"


> The errors I get when trying to view the data that getFinancials is supposed
> to provide makes me think the function isn't working properly.
>
> Kind regards,
> Devin
>
> On Thu, Feb 23, 2012 at 1:52 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com>
> wrote:
>>
>> Warning != Error
>>
>> This is a result of google not using the correct end of line in the
>> page, and/or R stripping/missing it.
>>
>> Either way, it doesn't matter - as it is a harmless warning.
>>
>> HTH
>> Jeff
>>
>> On Thu, Feb 23, 2012 at 12:49 PM, Devin Newman <devinlnewman at gmail.com>
>> wrote:
>> > Hello r-sig-finance!
>> >
>> > This is my first post to the list, so I hope you can bear what might be
>> > a
>> > silly question. Previously, I've had no trouble using quantmod's
>> > getFin()
>> > function to pull data. However, lately it hasn't been working. I think
>> > one
>> > of the functions called within getFin to clean up the data isn't working
>> > as
>> > intended.
>> >
>> >> AAPL <- getFin('AAPL', src="google")
>> > Warning message:
>> > In readLines(tmp) :
>> > ?incomplete final line found on
>> >
>> > '/var/folders/rf/pz5jmyzd1q9833s7h6r5lpzr0000gn/T//RtmpwUJi6G/file2e051531243'
>> >
>> >> AAPL <- getFin('AAPL', src="yahoo")
>> > Warning message:
>> > In readLines(tmp) :
>> > ?incomplete final line found on
>> >
>> > '/var/folders/rf/pz5jmyzd1q9833s7h6r5lpzr0000gn/T//RtmpwUJi6G/file2e024d4166b'
>> >
>> > Regardless of 'src' I get equivalent errors, "incomplete final line".
>> > Rather than immediately dive in and troubleshoot the code (although
>> > perusing through it was a great lesson in how to write R), I was hoping
>> > to
>> > share my issue here to see if others had similar problems, as I don't
>> > think
>> > this is merely the result of a formatting change on google/yahoo
>> > finance.
>> >
>> > Any help would be appreciated.
>> >
>> > Kind regards,
>> > Devin Newman
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>> www.esotericR.com
>>
>> R/Finance 2012: Applied Finance with R
>> www.RinFinance.com
>>
>> See you in Chicago!!!!
>
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From devinlnewman at gmail.com  Thu Feb 23 20:22:16 2012
From: devinlnewman at gmail.com (Devin Newman)
Date: Thu, 23 Feb 2012 14:22:16 -0500
Subject: [R-SIG-Finance] Quantmod's getFin() functionality broken?
In-Reply-To: <CABDUZc_U_1g4TQdQJquyQhi-nY0ZoFCscXavaBKgt_Jy7JOscg@mail.gmail.com>
References: <CALA=y+f8eFCdF_j3qk04W0e5xkhOPUmanEa39CQvDD6EJESEBg@mail.gmail.com>
	<CABDUZc8=kx6CmW8=_+MKCeqw6NmP9DT9Z5K5HNoHxQ5dW2txnw@mail.gmail.com>
	<CALA=y+c+NrOX=23psZDPefgAA8U_s2Gt-OJRUpBjkOHBrnqrqg@mail.gmail.com>
	<CABDUZc_U_1g4TQdQJquyQhi-nY0ZoFCscXavaBKgt_Jy7JOscg@mail.gmail.com>
Message-ID: <CALA=y+f9KrLUwm86-4==wiYeRPSZu_Ajj7tpMqLAe69T6nhxmA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120223/772ad9e6/attachment.pl>

From fabercastellsince1761 at gmail.com  Fri Feb 24 17:52:21 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Fri, 24 Feb 2012 17:52:21 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <1327012687.24988.146.camel@brian-rcg>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
Message-ID: <CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120224/024edf43/attachment.pl>

From brian at braverock.com  Fri Feb 24 18:45:50 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Feb 2012 11:45:50 -0600
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
	<CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>
Message-ID: <1330105550.8901.224.camel@brian-rcg>

Sorry about that.  THis dropped off my priority list (or never made it
on).  Patched in SVN r945 of quantstrat file parameters.R

Regards,

   - Brian

On Fri, 2012-02-24 at 17:52 +0100, Faber Castell wrote:
> By any chance, does anyone of you manages to run applyParameter demos ?
> I checked the latest packages available by svn but I have the error "Error
> in as.list(.instrument) : object '.instrument' cannot be found" mentionned
> below.
> 
> Samuel
> 
> On Thu, Jan 19, 2012 at 11:38 PM, Brian G. Peterson <brian at braverock.com>wrote:
> 
> > On Thu, 2012-01-19 at 17:09 +0100, Faber Castell wrote:
> > > I am struggling with both demos 'parameterTest' and 'parameterTestMACD'.
> > Do
> > > you manage to run them ? I did run 'bbands' and 'macd' as asked in
> > comments.
> >
> > > Error in as.list(.instrument) : object '.instrument' cannot be found
> >
> > The .instrument environment was recently moved out of the .GlobalEnv and
> > into the FinancialInstrument namespace. (any FinancialInstrument version
> > newer than 0.10 has this change)
> >
> > Looks like we missed the change here.
> >
> > I'll take a look at the parameter code in quantstrat tomorrow and patch.
> > Thanks for the report.
> >
> > Regards,
> >
> >    - Brian
> >
> > --
> > Brian G. Peterson
> > http://braverock.com/brian/
> > Ph: 773-459-4973
> > IM: bgpbraverock
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From comtech.usa at gmail.com  Fri Feb 24 22:39:46 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 24 Feb 2012 15:39:46 -0600
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel Smoothing in
	R?
Message-ID: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120224/6f1c2b84/attachment.pl>

From brian at braverock.com  Fri Feb 24 23:41:47 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Feb 2012 16:41:47 -0600
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
Message-ID: <1330123307.13240.9.camel@brian-desktop>

On Fri, 2012-02-24 at 15:39 -0600, Michael wrote:
> Hi all,
> 
> I am reading a paper talking about extracting low frequency trend in FX
> markets and then devising trading strategies based on those low frequency
> trends.
> 
> I was wondering if there are Causal version of HP filter and kernel
> Smoothing functions in R, as mentioned in that paper?
> 
> I did quite some search but couldn't find any ... Could you please help me?

It would be easier for people to decide whether to help you if you
actually provided the reference to the paper you are looking to
replicate.  

There are many kernel smoothing methods in various R packages, which
your 'quite some search' I am sure uncovered, *and* kernel smoothing
mechanisms are typically rather trivial to code.  So without the
reference it is hard to even begin to evaluate which of them might do
what you are looking for.  Also, it would be polite for you to indicate
in what way the kernel smoothing mechanisms provided by specific
packages do not match the methodology you desire.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From comtech.usa at gmail.com  Fri Feb 24 23:47:19 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 24 Feb 2012 16:47:19 -0600
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <1330123307.13240.9.camel@brian-desktop>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
Message-ID: <CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120224/4a6c7623/attachment.pl>

From brian at braverock.com  Sat Feb 25 00:00:27 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Feb 2012 17:00:27 -0600
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
Message-ID: <1330124427.13240.18.camel@brian-desktop>

As usual, it helps to use the correct terminology.


The term usually employed is not 'causal' but 'one sided' or 'two sided'
filters.  In classic state space models, the two sided filter is often
called a 'smoother', and the one-sided version is called a 'filter'.
See any introduction to Kalman filters for examples, since the Kalman
may easily by one sided or two sided.

High pass filters are also quite trivial, as equation 4 in your
reference demonstrates.

I may be incorrect, having spent only a few moments on it, but I see
nothing in this paper to indicate that the kernel smoothing in equation
6 is not equally trivial.

Marc Wildi has written extensively on the topic of real time (one-sided)
filters, and his R code is public.

On Fri, 2012-02-24 at 16:47 -0600, Michael wrote:
> Thanks Brian.
>  
> http://xfi.exeter.ac.uk/workingpapers/0804.pdf
>  
> My understanding is that those kernel smoothers and HP filters are all
> non-causal...
>  
> i.e. they peek into future from time-series point-of-view...
>  
> Therefore, I am looking for the Causal version.
>  
> Thank you!
> 
> 
> On Fri, Feb 24, 2012 at 4:41 PM, Brian G. Peterson
> <brian at braverock.com> wrote:
>         
>         On Fri, 2012-02-24 at 15:39 -0600, Michael wrote:
>         > Hi all,
>         >
>         > I am reading a paper talking about extracting low frequency
>         trend in FX
>         > markets and then devising trading strategies based on those
>         low frequency
>         > trends.
>         >
>         > I was wondering if there are Causal version of HP filter and
>         kernel
>         > Smoothing functions in R, as mentioned in that paper?
>         >
>         > I did quite some search but couldn't find any ... Could you
>         please help me?
>         
>         
>         It would be easier for people to decide whether to help you if
>         you
>         actually provided the reference to the paper you are looking
>         to
>         replicate.
>         
>         There are many kernel smoothing methods in various R packages,
>         which
>         your 'quite some search' I am sure uncovered, *and* kernel
>         smoothing
>         mechanisms are typically rather trivial to code.  So without
>         the
>         reference it is hard to even begin to evaluate which of them
>         might do
>         what you are looking for.  Also, it would be polite for you to
>         indicate
>         in what way the kernel smoothing mechanisms provided by
>         specific
>         packages do not match the methodology you desire.
>         
>         --
>         Brian G. Peterson
>         http://braverock.com/brian/
>         Ph: 773-459-4973
>         IM: bgpbraverock
>         
> 

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From pgilbert902 at gmail.com  Sat Feb 25 01:04:41 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 24 Feb 2012 19:04:41 -0500
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <1330124427.13240.18.camel@brian-desktop>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>
Message-ID: <4F482599.3020109@gmail.com>

Some pedantic points regarding correct terminology:

On 12-02-24 06:00 PM, Brian G. Peterson wrote:
> As usual, it helps to use the correct terminology.
>
>
> The term usually employed is not 'causal' but 'one sided' or 'two sided'
> filters.

Economists usually employ the terms 'one sided' and 'two sided'. In 
engineering, physics, and mathematics, I think the terms 'filter' and 
'smoother' are still used. (But yes, 'causal' usually has to do with 
something else.)

> In classic state space models, the two sided filter is often
> called a 'smoother', and the one-sided version is called a 'filter'.
> See any introduction to Kalman filters for examples, since the Kalman
> may easily by one sided or two sided.

Even in the classic case this is not specific to state-space models. The 
term filter meant it could be used to filter incoming signals without 
knowledge of the future, while a smoother needs future information. So, 
a filter could be used to do realtime control, while a smoother could not.
>
> High pass filters are also quite trivial, as equation 4 in your
> reference demonstrates.
>
> I may be incorrect, having spent only a few moments on it, but I see
> nothing in this paper to indicate that the kernel smoothing in equation
> 6 is not equally trivial.
>
> Marc Wildi has written extensively on the topic of real time (one-sided)
> filters, and his R code is public.
>
Engineers use the term 'realtime data' to mean what I think most people 
would understand as 'look at the data as it is arriving', which implies 
using a (one-sided) filter.  Economists use the term 'realtime data' to 
mean 'look at the data as it arrived'. That is, the vintages of the data 
that were available at different points in time. Thus a realtime 
analysis for an economist is a consideration of the revisions in the 
data. I think Marc Wildi uses the term as an economist, not as an engineer.

(I warned you this is pedantic.)
Paul

> On Fri, 2012-02-24 at 16:47 -0600, Michael wrote:
>> Thanks Brian.
>>
>> http://xfi.exeter.ac.uk/workingpapers/0804.pdf
>>
>> My understanding is that those kernel smoothers and HP filters are all
>> non-causal...
>>
>> i.e. they peek into future from time-series point-of-view...
>>
>> Therefore, I am looking for the Causal version.
>>
>> Thank you!
>>
>>
>> On Fri, Feb 24, 2012 at 4:41 PM, Brian G. Peterson
>> <brian at braverock.com>  wrote:
>>
>>          On Fri, 2012-02-24 at 15:39 -0600, Michael wrote:
>>          >  Hi all,
>>          >
>>          >  I am reading a paper talking about extracting low frequency
>>          trend in FX
>>          >  markets and then devising trading strategies based on those
>>          low frequency
>>          >  trends.
>>          >
>>          >  I was wondering if there are Causal version of HP filter and
>>          kernel
>>          >  Smoothing functions in R, as mentioned in that paper?
>>          >
>>          >  I did quite some search but couldn't find any ... Could you
>>          please help me?
>>
>>
>>          It would be easier for people to decide whether to help you if
>>          you
>>          actually provided the reference to the paper you are looking
>>          to
>>          replicate.
>>
>>          There are many kernel smoothing methods in various R packages,
>>          which
>>          your 'quite some search' I am sure uncovered, *and* kernel
>>          smoothing
>>          mechanisms are typically rather trivial to code.  So without
>>          the
>>          reference it is hard to even begin to evaluate which of them
>>          might do
>>          what you are looking for.  Also, it would be polite for you to
>>          indicate
>>          in what way the kernel smoothing mechanisms provided by
>>          specific
>>          packages do not match the methodology you desire.
>>
>>          --
>>          Brian G. Peterson
>>          http://braverock.com/brian/
>>          Ph: 773-459-4973
>>          IM: bgpbraverock
>>
>>
>


From johnzli at comcast.net  Sat Feb 25 07:27:39 2012
From: johnzli at comcast.net (johnzli at comcast.net)
Date: Sat, 25 Feb 2012 06:27:39 +0000 (UTC)
Subject: [R-SIG-Finance] really puzzled by this R script
Message-ID: <243222137.1717320.1330151259147.JavaMail.root@sz0053a.emeryville.ca.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120225/513535ad/attachment.pl>

From wlmr at zhaw.ch  Sat Feb 25 08:48:22 2012
From: wlmr at zhaw.ch (Wildi Marc (wlmr))
Date: Sat, 25 Feb 2012 07:48:22 +0000
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <4F482599.3020109@gmail.com>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>, <4F482599.3020109@gmail.com>
Message-ID: <E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>

I'm using the term as an `economist' and/or as an `engineer', hopefully without adding confusion to the topic. Specifically, a real-time filter is one-sided (which might sound redundant to some): it is also called concurrent filter in time series analysis (where target signals are considered to be outputs of bi-infinite symmetric filters: not smoothers...). Real-time data means: data as it arrives (possibly being revised in later vintages). A paper constructing real-time filters in the case of real-time data (mixing both concepts) is proposed in http://blog.zhaw.ch/idp/sefblog/index.php?/archives/205-7th-Annual-CIRANO-Workshop-on-Data-Revision-in-Macroeconomic-Forecasting-and-Policy.html

Marc

________________________________________
Von: r-sig-finance-bounces at r-project.org [r-sig-finance-bounces at r-project.org]&quot; im Auftrag von &quot;Paul Gilbert [pgilbert902 at gmail.com]
Gesendet: Samstag, 25. Februar 2012 01:04
Bis: r-sig-finance at r-project.org
Betreff: Re: [R-SIG-Finance] Causal version of HP filter and Kernel Smoothing in R?

Some pedantic points regarding correct terminology:

On 12-02-24 06:00 PM, Brian G. Peterson wrote:
> As usual, it helps to use the correct terminology.
>
>
> The term usually employed is not 'causal' but 'one sided' or 'two sided'
> filters.

Economists usually employ the terms 'one sided' and 'two sided'. In
engineering, physics, and mathematics, I think the terms 'filter' and
'smoother' are still used. (But yes, 'causal' usually has to do with
something else.)

> In classic state space models, the two sided filter is often
> called a 'smoother', and the one-sided version is called a 'filter'.
> See any introduction to Kalman filters for examples, since the Kalman
> may easily by one sided or two sided.

Even in the classic case this is not specific to state-space models. The
term filter meant it could be used to filter incoming signals without
knowledge of the future, while a smoother needs future information. So,
a filter could be used to do realtime control, while a smoother could not.
>
> High pass filters are also quite trivial, as equation 4 in your
> reference demonstrates.
>
> I may be incorrect, having spent only a few moments on it, but I see
> nothing in this paper to indicate that the kernel smoothing in equation
> 6 is not equally trivial.
>
> Marc Wildi has written extensively on the topic of real time (one-sided)
> filters, and his R code is public.
>
Engineers use the term 'realtime data' to mean what I think most people
would understand as 'look at the data as it is arriving', which implies
using a (one-sided) filter.  Economists use the term 'realtime data' to
mean 'look at the data as it arrived'. That is, the vintages of the data
that were available at different points in time. Thus a realtime
analysis for an economist is a consideration of the revisions in the
data. I think Marc Wildi uses the term as an economist, not as an engineer.

(I warned you this is pedantic.)
Paul

> On Fri, 2012-02-24 at 16:47 -0600, Michael wrote:
>> Thanks Brian.
>>
>> http://xfi.exeter.ac.uk/workingpapers/0804.pdf
>>
>> My understanding is that those kernel smoothers and HP filters are all
>> non-causal...
>>
>> i.e. they peek into future from time-series point-of-view...
>>
>> Therefore, I am looking for the Causal version.
>>
>> Thank you!
>>
>>
>> On Fri, Feb 24, 2012 at 4:41 PM, Brian G. Peterson
>> <brian at braverock.com>  wrote:
>>
>>          On Fri, 2012-02-24 at 15:39 -0600, Michael wrote:
>>          >  Hi all,
>>          >
>>          >  I am reading a paper talking about extracting low frequency
>>          trend in FX
>>          >  markets and then devising trading strategies based on those
>>          low frequency
>>          >  trends.
>>          >
>>          >  I was wondering if there are Causal version of HP filter and
>>          kernel
>>          >  Smoothing functions in R, as mentioned in that paper?
>>          >
>>          >  I did quite some search but couldn't find any ... Could you
>>          please help me?
>>
>>
>>          It would be easier for people to decide whether to help you if
>>          you
>>          actually provided the reference to the paper you are looking
>>          to
>>          replicate.
>>
>>          There are many kernel smoothing methods in various R packages,
>>          which
>>          your 'quite some search' I am sure uncovered, *and* kernel
>>          smoothing
>>          mechanisms are typically rather trivial to code.  So without
>>          the
>>          reference it is hard to even begin to evaluate which of them
>>          might do
>>          what you are looking for.  Also, it would be polite for you to
>>          indicate
>>          in what way the kernel smoothing mechanisms provided by
>>          specific
>>          packages do not match the methodology you desire.
>>
>>          --
>>          Brian G. Peterson
>>          http://braverock.com/brian/
>>          Ph: 773-459-4973
>>          IM: bgpbraverock
>>
>>
>

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

From comtech.usa at gmail.com  Sat Feb 25 18:09:21 2012
From: comtech.usa at gmail.com (Michael)
Date: Sat, 25 Feb 2012 11:09:21 -0600
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>
	<4F482599.3020109@gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>
Message-ID: <CAPNjSFbOQOGGe4P592Qj5W9q4CU4HP9c-0kQXYMHhpawW_9eZw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120225/2aec4d6d/attachment.pl>

From markleeds2 at gmail.com  Sat Feb 25 18:25:04 2012
From: markleeds2 at gmail.com (Mark Leeds)
Date: Sat, 25 Feb 2012 12:25:04 -0500
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <CAPNjSFbOQOGGe4P592Qj5W9q4CU4HP9c-0kQXYMHhpawW_9eZw@mail.gmail.com>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>
	<4F482599.3020109@gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>
	<CAPNjSFbOQOGGe4P592Qj5W9q4CU4HP9c-0kQXYMHhpawW_9eZw@mail.gmail.com>
Message-ID: <CAHz+bWZ2sW5PfQD0JDTYh_XRNUydTEUMwzVmxuQTbXiQ_QPgDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120225/1391a2aa/attachment.pl>

From michael.weylandt at gmail.com  Sun Feb 26 02:25:21 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sat, 25 Feb 2012 20:25:21 -0500
Subject: [R-SIG-Finance] really puzzled by this R script
In-Reply-To: <243222137.1717320.1330151259147.JavaMail.root@sz0053a.emeryville.ca.mail.comcast.net>
References: <243222137.1717320.1330151259147.JavaMail.root@sz0053a.emeryville.ca.mail.comcast.net>
Message-ID: <CAAmySGN+dYTq-_DokOiwFX2pOb-b7DOqMXPbV5RVBcewRsOJUA@mail.gmail.com>

This isn't really a finance question...

Your problem is that you use names() instead of just getting the row
numbers from outlierTest but then, when you convert the names to an
integer, your attempts to remove the row by that number and so doesn't
actually get the right row, then an outlier remains and the infinite
loop is triggered.

To put it concretely, add a browser() at the top of the while loop and
note this:

x <- 1:20
y <- x; y[c(3, 14)] <- 1000*c(1, 1.05); y <- jitter(y);

dat <- data.frame(x = x, y = y)

rmOutlier(y ~ x, dat[-1,])


## Once in browser note this:
ret # should give "14" because the 14th spot is a problem by construction
fullData[ - ret, ] # Still has the outlier at "14" because it's not in
the 14th row!

If you just use the names and index appropriately, you should be fine.
Further help is more suited to R-help though as this isn't very
financial...just a heads up though: you'll also probably get told off
for mentioning outlier removal on R-help: it's something of a rite of
passage

Michael

On Sat, Feb 25, 2012 at 1:27 AM,  <johnzli at comcast.net> wrote:
> Dear all,
>
> I wrote a R script that basically trying to identify outliers, and returns a non-empty vector containing the index to the outliers or a NULL object if there is no outliers.
> I have been puzzled by the strange behavior of this function. Let's say we have 10 outliers in a data frame of 1000 row samples.
> 1) If I run rmOutlier(y ~ x1 + x2, xyData), where xyData is a data frame with column names "y", "x1", "x2". The program runs fine, and returns the indices of those 10 outliers.
> 2) If I run rmOutlier(y ~ x1 + x2, xyData[1:200, ]), or any subset starts from the first row (i.e., 1:xx), the program runs fine.
> 3) If I run the script start from subsets of data not starting from the first row, e.g., rumOutlier
> (y ~ x1 + x2, xyData[100:1000, ] ), if there is no outlier falls within xyData[100:1000, ], the program runs fine.
>
> However, in case 3), if there is any outlier falls within xyData[100:1000, ], the program runs in infinite loop (the "while" loop in the script). Trouble shooting indicates that outlierTest( lm(lm_form, data = fullData[-ret, ]) will always return the same set of outliers index, and fullData[-ret, ] seems have no effects.
>
> What went wrong here? Any help will be greatly appreciated.
>
> Thank you.
>
>
> John Li
>
>
> This is the script:
>
>
> ?"rmOutlier" <- function(lm_form, fullData) {
> # Find and return Outliers indices based on Bonferroni Outlier Test
> # The program returns a non-empty vector or a NULL object
>
>
> # AUTHOR:
> # John Li
> # Date: Feb 17, 2012
> # Revised: Feb 24, 2012
> #
>
> ?require(car, quietly = TRUE)
>
> ?#sanity check
> ?stopifnot(is.data.frame(fullData), ncol(fullData) > 1, length(names(fullData)) == ncol(fullData))
>
> ?outlier <- outlierTest( lm(lm_form, data = fullData), n.max = Inf)
> ?if ( outlier$signif ) {
> ? ?ex <- c(as.numeric(names(outlier$rstudent)))
> ? ?ret <- ex
> ?}
> ?else {
> ? ?ret <- NULL
> ? ?return(ret)
> ?}
>
> ?while( outlier$signif ) {
> ? ?outlier <- outlierTest( lm(lm_form, data = fullData[-ret, ]), n.max = Inf) # fullData[-ret, ] seems not work
> ? ?if ( outlier$signif ) {
> ? ? ?ex <- as.numeric(names(outlier$rstudent))
> ? ? ?ret <- c(ret, ex)
> ? ?}
> ?}
> ?return(ret)
> ?}
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From wlmr at zhaw.ch  Sun Feb 26 14:20:36 2012
From: wlmr at zhaw.ch (Wildi Marc (wlmr))
Date: Sun, 26 Feb 2012 13:20:36 +0000
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <CAHz+bWZ2sW5PfQD0JDTYh_XRNUydTEUMwzVmxuQTbXiQ_QPgDg@mail.gmail.com>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>	<4F482599.3020109@gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>
	<CAPNjSFbOQOGGe4P592Qj5W9q4CU4HP9c-0kQXYMHhpawW_9eZw@mail.gmail.com>,
	<CAHz+bWZ2sW5PfQD0JDTYh_XRNUydTEUMwzVmxuQTbXiQ_QPgDg@mail.gmail.com>
Message-ID: <E2339A3600811248AB525B8FAB3A1BCE68EAB092@srv-mail-101.zhaw.ch>

Being interpellated I provide cursory feedback on the topic. R-code illustrating the HP filter (symmetric or real-time) is proposed below.



Modern (traditional) filter design goes back to early work by Wiener and Kolmogorov (WK). State-space models (Kalman-filter/smoothing) is an alternative formulation - parameterization - of the problem which is found more convenient/appealing by proponents: Harvey has highlighted some of the natural appeal in economic applications. In general, both approaches could replicate each other by suitable reformulation (parameterization) of models. So ultimately it is a matter of taste which is to be preferred. I frequently use state-space for didactical purposes (not that the filter is `simpler'; but `outputs' are appealing to non-experts).



HP-filter goes back to ideas proposed by Whittaker: it is ultimately a tradeoff between `fit' and `smoothness'. One can derive an ARIMA-model which replicates HP perfectly (it is a model with a double unit-root in frequency zero).



All these approaches are pure mean-square incarnations: real-time filter minimize the mean-square error between concurrent and final (symmetric) filters assuming that the (implicit or explicit) data-model is `true'.



My filter-design emphasizes a more general `customized' perspective: one can replicate ordinary mean-square designs (WK, Kalman, HP). But one can also emphasize alternative research priorities such as `timeliness', `noise suppression', `accuracy'. Depending on your priorities these aspects might be more relevant - to you -.  customization means that the user can tweak the optimization criterion in order to match his individual priorities. My experience is that practitioners frequently assign priorities (in forecasting) differently than assumed by the `mean-square' paradigm.



HP-filter can be implemented in R as follows:



library(mFilter)

# articial data: white noise (not very clever because HP assumes a double unit-root)
set.seed(1)
len<-201
eps<-rnorm(len)

# lambda=1600 is a typical setting for working with quarterly GDP

lambda_hp<-1600
eps.hp <- hpfilter(eps,type="lambda", freq=lambda_hp)
# plot data (here noise) and HP-trend

plot(eps.hp$x)
lines(eps.hp$trend,col=2)



# Here is the coefficient matrix: it is a full revision sequence.

parm<-eps.hp$fmatrix-diag(rep(1,len)
parm<--parm

# And a plot of the HP-filter coefficients: symmetric and real-time (concurrent) trend filters

ts.plot(cbind(parm[,c(length(parm[1,])/2,length(parm[1,]))]),lty=1:2)



Marc



________________________________
Von: Mark Leeds [markleeds2 at gmail.com]
Gesendet: Samstag, 25. Februar 2012 18:25
Bis: Michael
Cc: Wildi Marc (wlmr); r-sig-finance at r-project.org
Betreff: Re: [R-SIG-Finance] Causal version of HP filter and Kernel Smoothing in R?

Hi: I'm not familar with Prof. Wildi's filters or the HP filter but the standard kalman
filtering/smoothing algorithms are in dse, sspir and dlm. Well, definitely dlm has
smoothing but I bet sspir and dse have them also.

I'm most familiar with the notation in  dlm so I've only used that
package. note that the kalman filtering notation can be extremely confusing because the parameter symbols change from one KF setup to another  and even the time subscripting notation can vary  depending on whether t is shifted in the observation equation or not. but, if you're not used to one notation, then any of them can probably help you to some degree. paul didn't mention dse probably because he didn't want to self-promote !!!!!! It's also appreciated if Prof Wildi wants to comment because maybe
his filters are very different from the ones in the packages I mentioned and I could
be leading you astray.

                                                                                     mark


On Sat, Feb 25, 2012 at 12:09 PM, Michael <comtech.usa at gmail.com<mailto:comtech.usa at gmail.com>> wrote:
Using you guys' term, I suspect the paper used "2-sided" filter, which
"peeks" into the future, so the result in that paper is bogus...

I want to find the "1-sided" version of HP filter and Kernel Smoother, and
see if they work...

Any thoughts and pointers?

Thanks!

On Sat, Feb 25, 2012 at 1:48 AM, Wildi Marc (wlmr) <wlmr at zhaw.ch<mailto:wlmr at zhaw.ch>> wrote:

> I'm using the term as an `economist' and/or as an `engineer', hopefully
> without adding confusion to the topic. Specifically, a real-time filter is
> one-sided (which might sound redundant to some): it is also called
> concurrent filter in time series analysis (where target signals are
> considered to be outputs of bi-infinite symmetric filters: not
> smoothers...). Real-time data means: data as it arrives (possibly being
> revised in later vintages). A paper constructing real-time filters in the
> case of real-time data (mixing both concepts) is proposed in
> http://blog.zhaw.ch/idp/sefblog/index.php?/archives/205-7th-Annual-CIRANO-Workshop-on-Data-Revision-in-Macroeconomic-Forecasting-and-Policy.html
>
> Marc
>
> ________________________________________
> Von: r-sig-finance-bounces at r-project.org<mailto:r-sig-finance-bounces at r-project.org> [
> r-sig-finance-bounces at r-project.org<mailto:r-sig-finance-bounces at r-project.org>]&quot; im Auftrag von &quot;Paul
> Gilbert [pgilbert902 at gmail.com<mailto:pgilbert902 at gmail.com>]
> Gesendet: Samstag, 25. Februar 2012 01:04
> Bis: r-sig-finance at r-project.org<mailto:r-sig-finance at r-project.org>
> Betreff: Re: [R-SIG-Finance] Causal version of HP filter and Kernel
> Smoothing in R?
>
> Some pedantic points regarding correct terminology:
>
> On 12-02-24 06:00 PM, Brian G. Peterson wrote:
> > As usual, it helps to use the correct terminology.
> >
> >
> > The term usually employed is not 'causal' but 'one sided' or 'two sided'
> > filters.
>
> Economists usually employ the terms 'one sided' and 'two sided'. In
> engineering, physics, and mathematics, I think the terms 'filter' and
> 'smoother' are still used. (But yes, 'causal' usually has to do with
> something else.)
>
> > In classic state space models, the two sided filter is often
> > called a 'smoother', and the one-sided version is called a 'filter'.
> > See any introduction to Kalman filters for examples, since the Kalman
> > may easily by one sided or two sided.
>
> Even in the classic case this is not specific to state-space models. The
> term filter meant it could be used to filter incoming signals without
> knowledge of the future, while a smoother needs future information. So,
> a filter could be used to do realtime control, while a smoother could not.
> >
> > High pass filters are also quite trivial, as equation 4 in your
> > reference demonstrates.
> >
> > I may be incorrect, having spent only a few moments on it, but I see
> > nothing in this paper to indicate that the kernel smoothing in equation
> > 6 is not equally trivial.
> >
> > Marc Wildi has written extensively on the topic of real time (one-sided)
> > filters, and his R code is public.
> >
> Engineers use the term 'realtime data' to mean what I think most people
> would understand as 'look at the data as it is arriving', which implies
> using a (one-sided) filter.  Economists use the term 'realtime data' to
> mean 'look at the data as it arrived'. That is, the vintages of the data
> that were available at different points in time. Thus a realtime
> analysis for an economist is a consideration of the revisions in the
> data. I think Marc Wildi uses the term as an economist, not as an engineer.
>
> (I warned you this is pedantic.)
> Paul
>
> > On Fri, 2012-02-24 at 16:47 -0600, Michael wrote:
> >> Thanks Brian.
> >>
> >> http://xfi.exeter.ac.uk/workingpapers/0804.pdf
> >>
> >> My understanding is that those kernel smoothers and HP filters are all
> >> non-causal...
> >>
> >> i.e. they peek into future from time-series point-of-view...
> >>
> >> Therefore, I am looking for the Causal version.
> >>
> >> Thank you!
> >>
> >>
> >> On Fri, Feb 24, 2012 at 4:41 PM, Brian G. Peterson
> >> <brian at braverock.com<mailto:brian at braverock.com>>  wrote:
> >>
> >>          On Fri, 2012-02-24 at 15:39 -0600, Michael wrote:
> >>          >  Hi all,
> >>          >
> >>          >  I am reading a paper talking about extracting low frequency
> >>          trend in FX
> >>          >  markets and then devising trading strategies based on those
> >>          low frequency
> >>          >  trends.
> >>          >
> >>          >  I was wondering if there are Causal version of HP filter and
> >>          kernel
> >>          >  Smoothing functions in R, as mentioned in that paper?
> >>          >
> >>          >  I did quite some search but couldn't find any ... Could you
> >>          please help me?
> >>
> >>
> >>          It would be easier for people to decide whether to help you if
> >>          you
> >>          actually provided the reference to the paper you are looking
> >>          to
> >>          replicate.
> >>
> >>          There are many kernel smoothing methods in various R packages,
> >>          which
> >>          your 'quite some search' I am sure uncovered, *and* kernel
> >>          smoothing
> >>          mechanisms are typically rather trivial to code.  So without
> >>          the
> >>          reference it is hard to even begin to evaluate which of them
> >>          might do
> >>          what you are looking for.  Also, it would be polite for you to
> >>          indicate
> >>          in what way the kernel smoothing mechanisms provided by
> >>          specific
> >>          packages do not match the methodology you desire.
> >>
> >>          --
> >>          Brian G. Peterson
> >>          http://braverock.com/brian/
> >>          Ph: 773-459-4973<tel:773-459-4973>
> >>          IM: bgpbraverock
> >>
> >>
> >
>
> _______________________________________________
> R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
> _______________________________________________
> R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

       [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From ecsniffer at hotmail.com  Mon Feb 27 04:10:19 2012
From: ecsniffer at hotmail.com (LINJUAN)
Date: Mon, 27 Feb 2012 03:10:19 +0000
Subject: [R-SIG-Finance] test for the change in the parameters in t-GARCH
	model
Message-ID: <SNT118-W48C784923BA3960E540F1FAA690@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120227/4598c62d/attachment.pl>

From drseergio at gmail.com  Mon Feb 27 06:41:15 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Mon, 27 Feb 2012 06:41:15 +0100
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
Message-ID: <CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>

Hi,

Sorry for not following up sooner as I had been away for a week. I
have been able to further narrow down the problem. It occurs in the
sizing function and only when there are too many symbols. I have
further trimmed down the sample code.

I will continue troubleshooting this function. Do you have any ideas
that would point me in the right direction?

/Sergey

On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Garett,
>
> Thank you for the response and looking into this. The same is observed
> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
> have data for all symbols as well so this might explain some of the
> 404s.
>
> /Sergey
>
> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>> I've been having trouble with yahoo over the last 24 hours or so.
>> Sometimes, it returns data; sometimes it doesn't
>>
>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>> pausing 1 second between requests for more than 5 symbols
>> pausing 1 second between requests for more than 5 symbols
>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>> ?cannot open URL
>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>> In addition: Warning message:
>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>> ?cannot open: HTTP status was '404 Not Found'
>>
>>
>> HTH,
>> Garrett
>>
>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>> Greetings to the R finance community,
>>>
>>> I have written a sizing function (pretty much a slight modification of
>>> a function from Guy Yollin's slides). The problem is that it fails
>>> whenever I use many symbols. It works fine for one or few symbols.
>>>
>>> The problem manifests itself inside of the sizing function, when
>>> updatePortf is run. The error I get is:
>>>> source('tainted_2.R')
>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>> parse.side(intervals[1]))) :
>>> ?argument is of length zero
>>>
>>> Traceback:
>>>> traceback()
>>> 13: xts:::.parseISO8601(Dates)
>>> 12: first(xts:::.parseISO8601(Dates))
>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>> ? ? ? orderprice = as.numeric(orderprice))
>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>> c("market",
>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>> ...
>>> 7: do.call(fun, .formals)
>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>> 3: eval.with.vis(expr, envir, enclos)
>>> 2: eval.with.vis(ei, envir)
>>> 1: source("tainted_2.R")
>>>
>>> The sizing function looks like:
>>>
>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>> ruletype, ...) {
>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>> ?if (posn == 0) {
>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>> ? ?total.equity <- equity + trading.pl
>>> ? ?tradeSize <- total.equity * prcTrade
>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>> ? ?return(orderqty)
>>> ?}
>>> }
>>>
>>> The add.rule looks like:
>>> s <- add.rule(strategy=s, name='ruleSignal',
>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>
>>> Traceback suggests that there is a problem with the date format. I
>>> have inserted print statements and verified that the date itself is
>>> fine. It is also weird that the issue does not occur when using few
>>> symbols.
>>>
>>> I have attached runnable code that reproduces the problem. Please
>>> excuse any apparent inefficiencies you see. I would like to get
>>> strategy working first and then optimize for performance.
>>>
>>> Is there something wrong with the approach I have taken? Once the
>>> number of symbols is reduced the problem does not trigger.
>>>
>>> Truly appreciate your help.
>>>
>>> --
>>> Kind Regards,
>>> Sergey Pisarenko.
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tainted_2.R
Type: application/octet-stream
Size: 3003 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120227/70ed653e/attachment.obj>

From drseergio at gmail.com  Mon Feb 27 06:51:06 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Mon, 27 Feb 2012 06:51:06 +0100
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
	<CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
Message-ID: <CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>

Hi,

The specific line this occurs at is:

    dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
as.Date(timestamp), sep=''))

The function is inside of the sizing function. I have checked that
timestamp is valid when this function is called so the problem has to
do with some sort of a state problem in the portfolio.

/Sergey

On Mon, Feb 27, 2012 at 6:41 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi,
>
> Sorry for not following up sooner as I had been away for a week. I
> have been able to further narrow down the problem. It occurs in the
> sizing function and only when there are too many symbols. I have
> further trimmed down the sample code.
>
> I will continue troubleshooting this function. Do you have any ideas
> that would point me in the right direction?
>
> /Sergey
>
> On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Garett,
>>
>> Thank you for the response and looking into this. The same is observed
>> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
>> have data for all symbols as well so this might explain some of the
>> 404s.
>>
>> /Sergey
>>
>> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>>> I've been having trouble with yahoo over the last 24 hours or so.
>>> Sometimes, it returns data; sometimes it doesn't
>>>
>>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>> pausing 1 second between requests for more than 5 symbols
>>> pausing 1 second between requests for more than 5 symbols
>>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>> ?cannot open URL
>>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>>> In addition: Warning message:
>>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>> ?cannot open: HTTP status was '404 Not Found'
>>>
>>>
>>> HTH,
>>> Garrett
>>>
>>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>> Greetings to the R finance community,
>>>>
>>>> I have written a sizing function (pretty much a slight modification of
>>>> a function from Guy Yollin's slides). The problem is that it fails
>>>> whenever I use many symbols. It works fine for one or few symbols.
>>>>
>>>> The problem manifests itself inside of the sizing function, when
>>>> updatePortf is run. The error I get is:
>>>>> source('tainted_2.R')
>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>> parse.side(intervals[1]))) :
>>>> ?argument is of length zero
>>>>
>>>> Traceback:
>>>>> traceback()
>>>> 13: xts:::.parseISO8601(Dates)
>>>> 12: first(xts:::.parseISO8601(Dates))
>>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>>> ? ? ? orderprice = as.numeric(orderprice))
>>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>>> c("market",
>>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>>> ...
>>>> 7: do.call(fun, .formals)
>>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>>> 3: eval.with.vis(expr, envir, enclos)
>>>> 2: eval.with.vis(ei, envir)
>>>> 1: source("tainted_2.R")
>>>>
>>>> The sizing function looks like:
>>>>
>>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>>> ruletype, ...) {
>>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>>> ?if (posn == 0) {
>>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>>> ? ?total.equity <- equity + trading.pl
>>>> ? ?tradeSize <- total.equity * prcTrade
>>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>>> ? ?return(orderqty)
>>>> ?}
>>>> }
>>>>
>>>> The add.rule looks like:
>>>> s <- add.rule(strategy=s, name='ruleSignal',
>>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>>
>>>> Traceback suggests that there is a problem with the date format. I
>>>> have inserted print statements and verified that the date itself is
>>>> fine. It is also weird that the issue does not occur when using few
>>>> symbols.
>>>>
>>>> I have attached runnable code that reproduces the problem. Please
>>>> excuse any apparent inefficiencies you see. I would like to get
>>>> strategy working first and then optimize for performance.
>>>>
>>>> Is there something wrong with the approach I have taken? Once the
>>>> number of symbols is reduced the problem does not trigger.
>>>>
>>>> Truly appreciate your help.
>>>>
>>>> --
>>>> Kind Regards,
>>>> Sergey Pisarenko.
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions should go.


From drseergio at gmail.com  Mon Feb 27 07:18:18 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Mon, 27 Feb 2012 07:18:18 +0100
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
	<CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
	<CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>
Message-ID: <CAEGu7FtjNOw+w5OQ3xkVKu90xWfsEPp==BwT-57hx3fzfwTK7Q@mail.gmail.com>

Hi,

Going even deeper I see that the problem occurs inside of .updatePosPL
function (blotter) where dates are extracted:

> updatePortf(Portfolio='p', Dates=paste('2009-01-01', '::', '2009-04-06', sep=''))
Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
parse.side(intervals[1]))) :
  argument is of length zero
> traceback()
4: xts:::.parseISO8601(Dates)
3: first(xts:::.parseISO8601(Dates))
2: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
       Dates = Dates, Prices = Prices, ... = ...)
1: updatePortf(Portfolio = "p", Dates = paste("2009-01-01", "::",
       "2009-04-06", sep = ""))

I have looked in source code  blotter / R / updatePortf.R and I see
the following lines:
	startDate = first(xts:::.parseISO8601(Dates))$first.time-1 #does this
need to be a smaller/larger delta for millisecond data?
	endDate   = last(xts:::.parseISO8601(Dates))$last.time

Apparently, the problem occurs in the "startDate" calculation. I tried
manually calling xts:::.parseISO8601('2009-04-06') and
xts:::.parseISO8601('::2009-04-06') and it works OK.

Any ideas why xts:::.parse would be failing during script execution?

--
Kind Regards,
Sergey Pisarenko.

On Mon, Feb 27, 2012 at 6:51 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi,
>
> The specific line this occurs at is:
>
> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
> as.Date(timestamp), sep=''))
>
> The function is inside of the sizing function. I have checked that
> timestamp is valid when this function is called so the problem has to
> do with some sort of a state problem in the portfolio.
>
> /Sergey
>
> On Mon, Feb 27, 2012 at 6:41 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Hi,
>>
>> Sorry for not following up sooner as I had been away for a week. I
>> have been able to further narrow down the problem. It occurs in the
>> sizing function and only when there are too many symbols. I have
>> further trimmed down the sample code.
>>
>> I will continue troubleshooting this function. Do you have any ideas
>> that would point me in the right direction?
>>
>> /Sergey
>>
>> On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>> Garett,
>>>
>>> Thank you for the response and looking into this. The same is observed
>>> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
>>> have data for all symbols as well so this might explain some of the
>>> 404s.
>>>
>>> /Sergey
>>>
>>> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>>>> I've been having trouble with yahoo over the last 24 hours or so.
>>>> Sometimes, it returns data; sometimes it doesn't
>>>>
>>>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>> pausing 1 second between requests for more than 5 symbols
>>>> pausing 1 second between requests for more than 5 symbols
>>>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>> ?cannot open URL
>>>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>>>> In addition: Warning message:
>>>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>> ?cannot open: HTTP status was '404 Not Found'
>>>>
>>>>
>>>> HTH,
>>>> Garrett
>>>>
>>>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>> Greetings to the R finance community,
>>>>>
>>>>> I have written a sizing function (pretty much a slight modification of
>>>>> a function from Guy Yollin's slides). The problem is that it fails
>>>>> whenever I use many symbols. It works fine for one or few symbols.
>>>>>
>>>>> The problem manifests itself inside of the sizing function, when
>>>>> updatePortf is run. The error I get is:
>>>>>> source('tainted_2.R')
>>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>>> parse.side(intervals[1]))) :
>>>>> ?argument is of length zero
>>>>>
>>>>> Traceback:
>>>>>> traceback()
>>>>> 13: xts:::.parseISO8601(Dates)
>>>>> 12: first(xts:::.parseISO8601(Dates))
>>>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>>>> ? ? ? orderprice = as.numeric(orderprice))
>>>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>>>> c("market",
>>>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>>>> ...
>>>>> 7: do.call(fun, .formals)
>>>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>>>> 3: eval.with.vis(expr, envir, enclos)
>>>>> 2: eval.with.vis(ei, envir)
>>>>> 1: source("tainted_2.R")
>>>>>
>>>>> The sizing function looks like:
>>>>>
>>>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>>>> ruletype, ...) {
>>>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>>>> ?if (posn == 0) {
>>>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>>>> ? ?total.equity <- equity + trading.pl
>>>>> ? ?tradeSize <- total.equity * prcTrade
>>>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>>>> ? ?return(orderqty)
>>>>> ?}
>>>>> }
>>>>>
>>>>> The add.rule looks like:
>>>>> s <- add.rule(strategy=s, name='ruleSignal',
>>>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>>>
>>>>> Traceback suggests that there is a problem with the date format. I
>>>>> have inserted print statements and verified that the date itself is
>>>>> fine. It is also weird that the issue does not occur when using few
>>>>> symbols.
>>>>>
>>>>> I have attached runnable code that reproduces the problem. Please
>>>>> excuse any apparent inefficiencies you see. I would like to get
>>>>> strategy working first and then optimize for performance.
>>>>>
>>>>> Is there something wrong with the approach I have taken? Once the
>>>>> number of symbols is reduced the problem does not trigger.
>>>>>
>>>>> Truly appreciate your help.
>>>>>
>>>>> --
>>>>> Kind Regards,
>>>>> Sergey Pisarenko.
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Finance at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R questions should go.


From gsee000 at gmail.com  Mon Feb 27 09:45:18 2012
From: gsee000 at gmail.com (G See)
Date: Mon, 27 Feb 2012 02:45:18 -0600
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7FtjNOw+w5OQ3xkVKu90xWfsEPp==BwT-57hx3fzfwTK7Q@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
	<CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
	<CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>
	<CAEGu7FtjNOw+w5OQ3xkVKu90xWfsEPp==BwT-57hx3fzfwTK7Q@mail.gmail.com>
Message-ID: <CA+xi=qbrgMS5oZFUWpdWgk7GOWgYAgYixDYBOWeqRmKGJwj5mQ@mail.gmail.com>

Sergey,

Do you have data for 2009 for AAT, because yahoo doesn't.

> start(AAT)
[1] "2011-01-13"

HTH,
Garrett


On Mon, Feb 27, 2012 at 12:18 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi,
>
> Going even deeper I see that the problem occurs inside of .updatePosPL
> function (blotter) where dates are extracted:
>
>> updatePortf(Portfolio='p', Dates=paste('2009-01-01', '::', '2009-04-06', sep=''))
> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
> parse.side(intervals[1]))) :
> ?argument is of length zero
>> traceback()
> 4: xts:::.parseISO8601(Dates)
> 3: first(xts:::.parseISO8601(Dates))
> 2: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
> ? ? ? Dates = Dates, Prices = Prices, ... = ...)
> 1: updatePortf(Portfolio = "p", Dates = paste("2009-01-01", "::",
> ? ? ? "2009-04-06", sep = ""))
>
> I have looked in source code ?blotter / R / updatePortf.R and I see
> the following lines:
> ? ? ? ?startDate = first(xts:::.parseISO8601(Dates))$first.time-1 #does this
> need to be a smaller/larger delta for millisecond data?
> ? ? ? ?endDate ? = last(xts:::.parseISO8601(Dates))$last.time
>
> Apparently, the problem occurs in the "startDate" calculation. I tried
> manually calling xts:::.parseISO8601('2009-04-06') and
> xts:::.parseISO8601('::2009-04-06') and it works OK.
>
> Any ideas why xts:::.parse would be failing during script execution?
>
> --
> Kind Regards,
> Sergey Pisarenko.
>
> On Mon, Feb 27, 2012 at 6:51 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Hi,
>>
>> The specific line this occurs at is:
>>
>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>> as.Date(timestamp), sep=''))
>>
>> The function is inside of the sizing function. I have checked that
>> timestamp is valid when this function is called so the problem has to
>> do with some sort of a state problem in the portfolio.
>>
>> /Sergey
>>
>> On Mon, Feb 27, 2012 at 6:41 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>> Hi,
>>>
>>> Sorry for not following up sooner as I had been away for a week. I
>>> have been able to further narrow down the problem. It occurs in the
>>> sizing function and only when there are too many symbols. I have
>>> further trimmed down the sample code.
>>>
>>> I will continue troubleshooting this function. Do you have any ideas
>>> that would point me in the right direction?
>>>
>>> /Sergey
>>>
>>> On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>> Garett,
>>>>
>>>> Thank you for the response and looking into this. The same is observed
>>>> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
>>>> have data for all symbols as well so this might explain some of the
>>>> 404s.
>>>>
>>>> /Sergey
>>>>
>>>> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>>>>> I've been having trouble with yahoo over the last 24 hours or so.
>>>>> Sometimes, it returns data; sometimes it doesn't
>>>>>
>>>>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>> pausing 1 second between requests for more than 5 symbols
>>>>> pausing 1 second between requests for more than 5 symbols
>>>>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>> ?cannot open URL
>>>>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>>>>> In addition: Warning message:
>>>>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>> ?cannot open: HTTP status was '404 Not Found'
>>>>>
>>>>>
>>>>> HTH,
>>>>> Garrett
>>>>>
>>>>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>> Greetings to the R finance community,
>>>>>>
>>>>>> I have written a sizing function (pretty much a slight modification of
>>>>>> a function from Guy Yollin's slides). The problem is that it fails
>>>>>> whenever I use many symbols. It works fine for one or few symbols.
>>>>>>
>>>>>> The problem manifests itself inside of the sizing function, when
>>>>>> updatePortf is run. The error I get is:
>>>>>>> source('tainted_2.R')
>>>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>>>> parse.side(intervals[1]))) :
>>>>>> ?argument is of length zero
>>>>>>
>>>>>> Traceback:
>>>>>>> traceback()
>>>>>> 13: xts:::.parseISO8601(Dates)
>>>>>> 12: first(xts:::.parseISO8601(Dates))
>>>>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>>>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>>>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>>>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>>>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>>>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>>>>> ? ? ? orderprice = as.numeric(orderprice))
>>>>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>>>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>>>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>>>>> c("market",
>>>>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>>>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>>>>> ...
>>>>>> 7: do.call(fun, .formals)
>>>>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>>>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>>>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>>>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>>>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>>>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>>>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>>>>> 3: eval.with.vis(expr, envir, enclos)
>>>>>> 2: eval.with.vis(ei, envir)
>>>>>> 1: source("tainted_2.R")
>>>>>>
>>>>>> The sizing function looks like:
>>>>>>
>>>>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>>>>> ruletype, ...) {
>>>>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>>>>> ?if (posn == 0) {
>>>>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>>>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>>>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>>>>> ? ?total.equity <- equity + trading.pl
>>>>>> ? ?tradeSize <- total.equity * prcTrade
>>>>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>>>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>>>>> ? ?return(orderqty)
>>>>>> ?}
>>>>>> }
>>>>>>
>>>>>> The add.rule looks like:
>>>>>> s <- add.rule(strategy=s, name='ruleSignal',
>>>>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>>>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>>>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>>>>
>>>>>> Traceback suggests that there is a problem with the date format. I
>>>>>> have inserted print statements and verified that the date itself is
>>>>>> fine. It is also weird that the issue does not occur when using few
>>>>>> symbols.
>>>>>>
>>>>>> I have attached runnable code that reproduces the problem. Please
>>>>>> excuse any apparent inefficiencies you see. I would like to get
>>>>>> strategy working first and then optimize for performance.
>>>>>>
>>>>>> Is there something wrong with the approach I have taken? Once the
>>>>>> number of symbols is reduced the problem does not trigger.
>>>>>>
>>>>>> Truly appreciate your help.
>>>>>>
>>>>>> --
>>>>>> Kind Regards,
>>>>>> Sergey Pisarenko.
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-SIG-Finance at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>> -- Also note that this is not the r-help list where general R questions should go.


From drseergio at gmail.com  Mon Feb 27 09:55:44 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Mon, 27 Feb 2012 09:55:44 +0100
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CA+xi=qbrgMS5oZFUWpdWgk7GOWgYAgYixDYBOWeqRmKGJwj5mQ@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
	<CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
	<CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>
	<CAEGu7FtjNOw+w5OQ3xkVKu90xWfsEPp==BwT-57hx3fzfwTK7Q@mail.gmail.com>
	<CA+xi=qbrgMS5oZFUWpdWgk7GOWgYAgYixDYBOWeqRmKGJwj5mQ@mail.gmail.com>
Message-ID: <CAEGu7FuxdMHN_53j-V4fuGuR7EMiNqB4cp9usbs_UEizsWKeeQ@mail.gmail.com>

Garett,

Thanks, great point. Total blunder on my side. I will look into this further.

/Sergey

On Mon, Feb 27, 2012 at 9:45 AM, G See <gsee000 at gmail.com> wrote:
> Sergey,
>
> Do you have data for 2009 for AAT, because yahoo doesn't.
>
>> start(AAT)
> [1] "2011-01-13"
>
> HTH,
> Garrett
>
>
> On Mon, Feb 27, 2012 at 12:18 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Hi,
>>
>> Going even deeper I see that the problem occurs inside of .updatePosPL
>> function (blotter) where dates are extracted:
>>
>>> updatePortf(Portfolio='p', Dates=paste('2009-01-01', '::', '2009-04-06', sep=''))
>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>> parse.side(intervals[1]))) :
>> ?argument is of length zero
>>> traceback()
>> 4: xts:::.parseISO8601(Dates)
>> 3: first(xts:::.parseISO8601(Dates))
>> 2: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>> ? ? ? Dates = Dates, Prices = Prices, ... = ...)
>> 1: updatePortf(Portfolio = "p", Dates = paste("2009-01-01", "::",
>> ? ? ? "2009-04-06", sep = ""))
>>
>> I have looked in source code ?blotter / R / updatePortf.R and I see
>> the following lines:
>> ? ? ? ?startDate = first(xts:::.parseISO8601(Dates))$first.time-1 #does this
>> need to be a smaller/larger delta for millisecond data?
>> ? ? ? ?endDate ? = last(xts:::.parseISO8601(Dates))$last.time
>>
>> Apparently, the problem occurs in the "startDate" calculation. I tried
>> manually calling xts:::.parseISO8601('2009-04-06') and
>> xts:::.parseISO8601('::2009-04-06') and it works OK.
>>
>> Any ideas why xts:::.parse would be failing during script execution?
>>
>> --
>> Kind Regards,
>> Sergey Pisarenko.
>>
>> On Mon, Feb 27, 2012 at 6:51 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>> Hi,
>>>
>>> The specific line this occurs at is:
>>>
>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>> as.Date(timestamp), sep=''))
>>>
>>> The function is inside of the sizing function. I have checked that
>>> timestamp is valid when this function is called so the problem has to
>>> do with some sort of a state problem in the portfolio.
>>>
>>> /Sergey
>>>
>>> On Mon, Feb 27, 2012 at 6:41 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>> Hi,
>>>>
>>>> Sorry for not following up sooner as I had been away for a week. I
>>>> have been able to further narrow down the problem. It occurs in the
>>>> sizing function and only when there are too many symbols. I have
>>>> further trimmed down the sample code.
>>>>
>>>> I will continue troubleshooting this function. Do you have any ideas
>>>> that would point me in the right direction?
>>>>
>>>> /Sergey
>>>>
>>>> On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>> Garett,
>>>>>
>>>>> Thank you for the response and looking into this. The same is observed
>>>>> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
>>>>> have data for all symbols as well so this might explain some of the
>>>>> 404s.
>>>>>
>>>>> /Sergey
>>>>>
>>>>> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>>>>>> I've been having trouble with yahoo over the last 24 hours or so.
>>>>>> Sometimes, it returns data; sometimes it doesn't
>>>>>>
>>>>>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>>> pausing 1 second between requests for more than 5 symbols
>>>>>> pausing 1 second between requests for more than 5 symbols
>>>>>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>>> ?cannot open URL
>>>>>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>>>>>> In addition: Warning message:
>>>>>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>>> ?cannot open: HTTP status was '404 Not Found'
>>>>>>
>>>>>>
>>>>>> HTH,
>>>>>> Garrett
>>>>>>
>>>>>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>>> Greetings to the R finance community,
>>>>>>>
>>>>>>> I have written a sizing function (pretty much a slight modification of
>>>>>>> a function from Guy Yollin's slides). The problem is that it fails
>>>>>>> whenever I use many symbols. It works fine for one or few symbols.
>>>>>>>
>>>>>>> The problem manifests itself inside of the sizing function, when
>>>>>>> updatePortf is run. The error I get is:
>>>>>>>> source('tainted_2.R')
>>>>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>>>>> parse.side(intervals[1]))) :
>>>>>>> ?argument is of length zero
>>>>>>>
>>>>>>> Traceback:
>>>>>>>> traceback()
>>>>>>> 13: xts:::.parseISO8601(Dates)
>>>>>>> 12: first(xts:::.parseISO8601(Dates))
>>>>>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>>>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>>>>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>>>>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>>>>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>>>>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>>>>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>>>>>> ? ? ? orderprice = as.numeric(orderprice))
>>>>>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>>>>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>>>>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>>>>>> c("market",
>>>>>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>>>>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>>>>>> ...
>>>>>>> 7: do.call(fun, .formals)
>>>>>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>>>>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>>>>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>>>>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>>>>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>>>>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>>>>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>>>>>> 3: eval.with.vis(expr, envir, enclos)
>>>>>>> 2: eval.with.vis(ei, envir)
>>>>>>> 1: source("tainted_2.R")
>>>>>>>
>>>>>>> The sizing function looks like:
>>>>>>>
>>>>>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>>>>>> ruletype, ...) {
>>>>>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>>>>>> ?if (posn == 0) {
>>>>>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>>>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>>>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>>>>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>>>>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>>>>>> ? ?total.equity <- equity + trading.pl
>>>>>>> ? ?tradeSize <- total.equity * prcTrade
>>>>>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>>>>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>>>>>> ? ?return(orderqty)
>>>>>>> ?}
>>>>>>> }
>>>>>>>
>>>>>>> The add.rule looks like:
>>>>>>> s <- add.rule(strategy=s, name='ruleSignal',
>>>>>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>>>>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>>>>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>>>>>
>>>>>>> Traceback suggests that there is a problem with the date format. I
>>>>>>> have inserted print statements and verified that the date itself is
>>>>>>> fine. It is also weird that the issue does not occur when using few
>>>>>>> symbols.
>>>>>>>
>>>>>>> I have attached runnable code that reproduces the problem. Please
>>>>>>> excuse any apparent inefficiencies you see. I would like to get
>>>>>>> strategy working first and then optimize for performance.
>>>>>>>
>>>>>>> Is there something wrong with the approach I have taken? Once the
>>>>>>> number of symbols is reduced the problem does not trigger.
>>>>>>>
>>>>>>> Truly appreciate your help.
>>>>>>>
>>>>>>> --
>>>>>>> Kind Regards,
>>>>>>> Sergey Pisarenko.
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-SIG-Finance at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>>> -- Also note that this is not the r-help list where general R questions should go.


From brian at braverock.com  Mon Feb 27 12:49:41 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 27 Feb 2012 05:49:41 -0600
Subject: [R-SIG-Finance] test for the change in the parameters in
 t-GARCH model
In-Reply-To: <SNT118-W48C784923BA3960E540F1FAA690@phx.gbl>
References: <SNT118-W48C784923BA3960E540F1FAA690@phx.gbl>
Message-ID: <1330343381.13240.62.camel@brian-desktop>

On Mon, 2012-02-27 at 03:10 +0000, LINJUAN wrote:
> I fit a AR(1), t-GARCH(1,1) model to the Yen-USD exchange rate from
> 1995 to 2004. 
>  
> I add a dummy variable to the model, which  takes the value zero in
> the pre-euro sample and one in the post-euro sample.
>  
> My question is how can I test whether the degree of freedom parameter
> changes following the introduction of euro?
> 
> Thanks,
> Juan Lin 

Since there is clearly no 'secret sauce' in this question, it would make
things easier for everyone else to help you if you posted a
*reproducible example*.


-- 
Brian


From fabercastellsince1761 at gmail.com  Mon Feb 27 16:58:28 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Mon, 27 Feb 2012 16:58:28 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <1330105550.8901.224.camel@brian-rcg>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
	<CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>
	<1330105550.8901.224.camel@brian-rcg>
Message-ID: <CACBLjKSM+L1YUv+05sE_U0gNWdOb7XFQjwv9t-unVzrncVB0zA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120227/6927fdca/attachment.pl>

From brian at braverock.com  Mon Feb 27 19:28:33 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 27 Feb 2012 12:28:33 -0600
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKSM+L1YUv+05sE_U0gNWdOb7XFQjwv9t-unVzrncVB0zA@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
	<CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>
	<1330105550.8901.224.camel@brian-rcg>
	<CACBLjKSM+L1YUv+05sE_U0gNWdOb7XFQjwv9t-unVzrncVB0zA@mail.gmail.com>
Message-ID: <1330367313.8901.245.camel@brian-rcg>

I can't replicate your error. The demos all work for me.  Also, it
shouldn't matter for anything other than applyParameters (which is the
only place I made changes to fix the issue you described).

Have you checked to make sure you're using current versions of xts,
FinancialInstrument, and blotter?  (though the error you report is from
inside applyRules in quantstrat).

Regards,

  - Brian

On Mon, 2012-02-27 at 16:58 +0100, Faber Castell wrote:
> Thanks a lot Brian.
> 
> I just tried to SVN the latest commits of
> Blotter/Quantstrat/FinancialInstrument/RTAQ. I managed to check, build and
> install them fine under Windows 7 in order to give a try at your patch 945.
> That was actually my first try at building a package.
> 
> However, I am now unable to run the macd demo :
> 
> out<-try(applyStrategy(strategy=stratMACD ,
> portfolios=portfolio.st,parameters=list(nFast=fastMA,
> nSlow=slowMA, nSig=signalMA,maType=maType)))
> 
> *Error in if (!is.na(timestamp) && !is.na(data[timestamp][, sigcol]) &&  : *
> *  missing value where TRUE / FALSE is required*
> 
> 
> I have the same issue with the bband demo. As I said, it is my first
> attempt at building packages, it is very possible I did something wrong
> there, although the only warning was :
> 
> cygwin warning:
>   MS-DOS style path detected:
> G:/ANALYSE/Sam/blotter/blotter/pkg/blotter_0.8.4.t
> ar.gz
>   Preferred POSIX equivalent is:
> /cygdrive/g/ANALYSE/Sam/blotter/blotter/pkg/blo
> tter_0.8.4.tar.gz
>   CYGWIN environment variable option "nodosfilewarning" turns off this
> warning.
>   Consult the user's guide for more details about POSIX paths:
>     http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
> 
> 
> Regards,
> Charles
> 
> 
> 
> 
> On Fri, Feb 24, 2012 at 6:45 PM, Brian G. Peterson <brian at braverock.com>wrote:
> 
> > Sorry about that.  THis dropped off my priority list (or never made it
> > on).  Patched in SVN r945 of quantstrat file parameters.R
> >
> > Regards,
> >
> >   - Brian
> >
> > On Fri, 2012-02-24 at 17:52 +0100, Faber Castell wrote:
> > > By any chance, does anyone of you manages to run applyParameter demos ?
> > > I checked the latest packages available by svn but I have the error
> > "Error
> > > in as.list(.instrument) : object '.instrument' cannot be found"
> > mentionned
> > > below.
> > >
> > > Samuel
> > >
> > > On Thu, Jan 19, 2012 at 11:38 PM, Brian G. Peterson <brian at braverock.com
> > >wrote:
> > >
> > > > On Thu, 2012-01-19 at 17:09 +0100, Faber Castell wrote:
> > > > > I am struggling with both demos 'parameterTest' and
> > 'parameterTestMACD'.
> > > > Do
> > > > > you manage to run them ? I did run 'bbands' and 'macd' as asked in
> > > > comments.
> > > >
> > > > > Error in as.list(.instrument) : object '.instrument' cannot be found
> > > >
> > > > The .instrument environment was recently moved out of the .GlobalEnv
> > and
> > > > into the FinancialInstrument namespace. (any FinancialInstrument
> > version
> > > > newer than 0.10 has this change)
> > > >
> > > > Looks like we missed the change here.
> > > >
> > > > I'll take a look at the parameter code in quantstrat tomorrow and
> > patch.
> > > > Thanks for the report.
> > > >
> > > > Regards,
> > > >
> > > >    - Brian
> > > >
> > > > --
> > > > Brian G. Peterson
> > > > http://braverock.com/brian/
> > > > Ph: 773-459-4973
> > > > IM: bgpbraverock
> > > >
> > > > _______________________________________________
> > > > R-SIG-Finance at r-project.org mailing list
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > > -- Also note that this is not the r-help list where general R questions
> > > > should go.
> > > >
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-SIG-Finance at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> > --
> > Brian G. Peterson
> > http://braverock.com/brian/
> > Ph: 773-459-4973
> > IM: bgpbraverock
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From drseergio at gmail.com  Mon Feb 27 20:28:27 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Mon, 27 Feb 2012 20:28:27 +0100
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7FuxdMHN_53j-V4fuGuR7EMiNqB4cp9usbs_UEizsWKeeQ@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
	<CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
	<CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>
	<CAEGu7FtjNOw+w5OQ3xkVKu90xWfsEPp==BwT-57hx3fzfwTK7Q@mail.gmail.com>
	<CA+xi=qbrgMS5oZFUWpdWgk7GOWgYAgYixDYBOWeqRmKGJwj5mQ@mail.gmail.com>
	<CAEGu7FuxdMHN_53j-V4fuGuR7EMiNqB4cp9usbs_UEizsWKeeQ@mail.gmail.com>
Message-ID: <CAEGu7FuQFp_8QdXwZ1vGDptx1a1-2GJ5pnXYkv+-fGFtkcPPjg@mail.gmail.com>

Garrett,

Thanks for your insight on this issue. This was totally the problem
here. The different symbols had data for different date spans. For
some symbols there were NAs during certain spans (e.g. stock did not
exist yet). The right solution to me seems to either use data that
overlaps (alignSymbols from qmao does that) or skip transactions for
those symbols that have a gap on the particular dates.

/Sergey

On Mon, Feb 27, 2012 at 9:55 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Garett,
>
> Thanks, great point. Total blunder on my side. I will look into this further.
>
> /Sergey
>
> On Mon, Feb 27, 2012 at 9:45 AM, G See <gsee000 at gmail.com> wrote:
>> Sergey,
>>
>> Do you have data for 2009 for AAT, because yahoo doesn't.
>>
>>> start(AAT)
>> [1] "2011-01-13"
>>
>> HTH,
>> Garrett
>>
>>
>> On Mon, Feb 27, 2012 at 12:18 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>> Hi,
>>>
>>> Going even deeper I see that the problem occurs inside of .updatePosPL
>>> function (blotter) where dates are extracted:
>>>
>>>> updatePortf(Portfolio='p', Dates=paste('2009-01-01', '::', '2009-04-06', sep=''))
>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>> parse.side(intervals[1]))) :
>>> ?argument is of length zero
>>>> traceback()
>>> 4: xts:::.parseISO8601(Dates)
>>> 3: first(xts:::.parseISO8601(Dates))
>>> 2: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>> ? ? ? Dates = Dates, Prices = Prices, ... = ...)
>>> 1: updatePortf(Portfolio = "p", Dates = paste("2009-01-01", "::",
>>> ? ? ? "2009-04-06", sep = ""))
>>>
>>> I have looked in source code ?blotter / R / updatePortf.R and I see
>>> the following lines:
>>> ? ? ? ?startDate = first(xts:::.parseISO8601(Dates))$first.time-1 #does this
>>> need to be a smaller/larger delta for millisecond data?
>>> ? ? ? ?endDate ? = last(xts:::.parseISO8601(Dates))$last.time
>>>
>>> Apparently, the problem occurs in the "startDate" calculation. I tried
>>> manually calling xts:::.parseISO8601('2009-04-06') and
>>> xts:::.parseISO8601('::2009-04-06') and it works OK.
>>>
>>> Any ideas why xts:::.parse would be failing during script execution?
>>>
>>> --
>>> Kind Regards,
>>> Sergey Pisarenko.
>>>
>>> On Mon, Feb 27, 2012 at 6:51 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>> Hi,
>>>>
>>>> The specific line this occurs at is:
>>>>
>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>> as.Date(timestamp), sep=''))
>>>>
>>>> The function is inside of the sizing function. I have checked that
>>>> timestamp is valid when this function is called so the problem has to
>>>> do with some sort of a state problem in the portfolio.
>>>>
>>>> /Sergey
>>>>
>>>> On Mon, Feb 27, 2012 at 6:41 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>> Hi,
>>>>>
>>>>> Sorry for not following up sooner as I had been away for a week. I
>>>>> have been able to further narrow down the problem. It occurs in the
>>>>> sizing function and only when there are too many symbols. I have
>>>>> further trimmed down the sample code.
>>>>>
>>>>> I will continue troubleshooting this function. Do you have any ideas
>>>>> that would point me in the right direction?
>>>>>
>>>>> /Sergey
>>>>>
>>>>> On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>> Garett,
>>>>>>
>>>>>> Thank you for the response and looking into this. The same is observed
>>>>>> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
>>>>>> have data for all symbols as well so this might explain some of the
>>>>>> 404s.
>>>>>>
>>>>>> /Sergey
>>>>>>
>>>>>> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>>>>>>> I've been having trouble with yahoo over the last 24 hours or so.
>>>>>>> Sometimes, it returns data; sometimes it doesn't
>>>>>>>
>>>>>>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>>>> pausing 1 second between requests for more than 5 symbols
>>>>>>> pausing 1 second between requests for more than 5 symbols
>>>>>>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>>>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>>>> ?cannot open URL
>>>>>>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>>>>>>> In addition: Warning message:
>>>>>>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>>>> ?cannot open: HTTP status was '404 Not Found'
>>>>>>>
>>>>>>>
>>>>>>> HTH,
>>>>>>> Garrett
>>>>>>>
>>>>>>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>>>> Greetings to the R finance community,
>>>>>>>>
>>>>>>>> I have written a sizing function (pretty much a slight modification of
>>>>>>>> a function from Guy Yollin's slides). The problem is that it fails
>>>>>>>> whenever I use many symbols. It works fine for one or few symbols.
>>>>>>>>
>>>>>>>> The problem manifests itself inside of the sizing function, when
>>>>>>>> updatePortf is run. The error I get is:
>>>>>>>>> source('tainted_2.R')
>>>>>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>>>>>> parse.side(intervals[1]))) :
>>>>>>>> ?argument is of length zero
>>>>>>>>
>>>>>>>> Traceback:
>>>>>>>>> traceback()
>>>>>>>> 13: xts:::.parseISO8601(Dates)
>>>>>>>> 12: first(xts:::.parseISO8601(Dates))
>>>>>>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>>>>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>>>>>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>>>>>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>>>>>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>>>>>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>>>>>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>>>>>>> ? ? ? orderprice = as.numeric(orderprice))
>>>>>>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>>>>>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>>>>>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>>>>>>> c("market",
>>>>>>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>>>>>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>>>>>>> ...
>>>>>>>> 7: do.call(fun, .formals)
>>>>>>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>>>>>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>>>>>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>>>>>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>>>>>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>>>>>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>>>>>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>>>>>>> 3: eval.with.vis(expr, envir, enclos)
>>>>>>>> 2: eval.with.vis(ei, envir)
>>>>>>>> 1: source("tainted_2.R")
>>>>>>>>
>>>>>>>> The sizing function looks like:
>>>>>>>>
>>>>>>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>>>>>>> ruletype, ...) {
>>>>>>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>>>>>>> ?if (posn == 0) {
>>>>>>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>>>>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>>>>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>>>>>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>>>>>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>>>>>>> ? ?total.equity <- equity + trading.pl
>>>>>>>> ? ?tradeSize <- total.equity * prcTrade
>>>>>>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>>>>>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>>>>>>> ? ?return(orderqty)
>>>>>>>> ?}
>>>>>>>> }
>>>>>>>>
>>>>>>>> The add.rule looks like:
>>>>>>>> s <- add.rule(strategy=s, name='ruleSignal',
>>>>>>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>>>>>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>>>>>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>>>>>>
>>>>>>>> Traceback suggests that there is a problem with the date format. I
>>>>>>>> have inserted print statements and verified that the date itself is
>>>>>>>> fine. It is also weird that the issue does not occur when using few
>>>>>>>> symbols.
>>>>>>>>
>>>>>>>> I have attached runnable code that reproduces the problem. Please
>>>>>>>> excuse any apparent inefficiencies you see. I would like to get
>>>>>>>> strategy working first and then optimize for performance.
>>>>>>>>
>>>>>>>> Is there something wrong with the approach I have taken? Once the
>>>>>>>> number of symbols is reduced the problem does not trigger.
>>>>>>>>
>>>>>>>> Truly appreciate your help.
>>>>>>>>
>>>>>>>> --
>>>>>>>> Kind Regards,
>>>>>>>> Sergey Pisarenko.
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> R-SIG-Finance at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>>>> -- Also note that this is not the r-help list where general R questions should go.


From diego.jara at quantil.com.co  Mon Feb 27 22:48:10 2012
From: diego.jara at quantil.com.co (Diego Jara)
Date: Mon, 27 Feb 2012 16:48:10 -0500
Subject: [R-SIG-Finance] Creating a DLL from R code
Message-ID: <CACYR6b_sT+ZbLY2-EzReXNiHRnFPoq8ihFHa2b6dC4PJ5ZZCLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120227/a5bb5901/attachment.pl>

From ecsniffer at hotmail.com  Tue Feb 28 03:59:36 2012
From: ecsniffer at hotmail.com (LINJUAN)
Date: Tue, 28 Feb 2012 02:59:36 +0000
Subject: [R-SIG-Finance] test for the change in the parameters in
 t-GARCH model
In-Reply-To: <1330343381.13240.62.camel@brian-desktop>
References: <SNT118-W48C784923BA3960E540F1FAA690@phx.gbl>,
	<1330343381.13240.62.camel@brian-desktop>
Message-ID: <SNT118-W54064F3E7325C9FE977456AA6E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/0c6de8ba/attachment.pl>

From fabercastellsince1761 at gmail.com  Tue Feb 28 10:04:19 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Tue, 28 Feb 2012 10:04:19 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <1330367313.8901.245.camel@brian-rcg>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
	<CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>
	<1330105550.8901.224.camel@brian-rcg>
	<CACBLjKSM+L1YUv+05sE_U0gNWdOb7XFQjwv9t-unVzrncVB0zA@mail.gmail.com>
	<1330367313.8901.245.camel@brian-rcg>
Message-ID: <CACBLjKTAHi7Aya4fqK8jn9X0KX1dibvq9mCXzDJEreOYhVhYXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/6ad79568/attachment.pl>

From gsee000 at gmail.com  Tue Feb 28 12:45:25 2012
From: gsee000 at gmail.com (G See)
Date: Tue, 28 Feb 2012 05:45:25 -0600
Subject: [R-SIG-Finance] quantstrat: getting an error when using many
 symbols and %-based order sizing function
In-Reply-To: <CAEGu7FuQFp_8QdXwZ1vGDptx1a1-2GJ5pnXYkv+-fGFtkcPPjg@mail.gmail.com>
References: <CAEGu7FvSgVD=Dq0ksZyRS+XVS4KAwMSaCTcdQiiYB8ry-7BuVQ@mail.gmail.com>
	<CA+xi=qaG9xP0+kP0MonvGi_1foP6jAQA+POZBC1ncFLYTLMF=w@mail.gmail.com>
	<CAEGu7FstAdCH5U6fGSLdmacYdqmQaD4XN5QKgna3G0an83TY0Q@mail.gmail.com>
	<CAEGu7Fv_8-+-zxMn9aQGZLMtee2GXMM_tnYyh=fnMtaUGayckw@mail.gmail.com>
	<CAEGu7FtZaK6Uv_EEzYSzFhUBM=JaLzOOAQh4MyPxgq4+fnkvig@mail.gmail.com>
	<CAEGu7FtjNOw+w5OQ3xkVKu90xWfsEPp==BwT-57hx3fzfwTK7Q@mail.gmail.com>
	<CA+xi=qbrgMS5oZFUWpdWgk7GOWgYAgYixDYBOWeqRmKGJwj5mQ@mail.gmail.com>
	<CAEGu7FuxdMHN_53j-V4fuGuR7EMiNqB4cp9usbs_UEizsWKeeQ@mail.gmail.com>
	<CAEGu7FuQFp_8QdXwZ1vGDptx1a1-2GJ5pnXYkv+-fGFtkcPPjg@mail.gmail.com>
Message-ID: <CA+xi=qZ_AQM3O19CbCPmSCDnAxWyZm6YKnz2SiV1XFXc1=pE0A@mail.gmail.com>

You could also just ignore stocks that don't have enough rows
(whatever that means to you).  Maybe something like:

watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
nonIncompleteStocks <- function(Symbols, n=1000) {
    # Symbols is vector of names of stocks
    # n is an arbitrary number.  Only stocks that have at least as many rows as
    #   the median minus n will be kept.  A larger value will keep more stocks
    require(qmao)
    mypf <- makePriceFrame(getSymbols(Symbols, src='yahoo'),
                                          na.omit=FALSE, notional=FALSE)
    lengths <- sort(apply(mypf, 2, function(x) length(x[!is.na(x)])))
    names(lengths)[lengths >= median(lengths) - n]
}

nonIncompleteStocks(watched)

#####################################################

-Garrett


On Mon, Feb 27, 2012 at 1:28 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Garrett,
>
> Thanks for your insight on this issue. This was totally the problem
> here. The different symbols had data for different date spans. For
> some symbols there were NAs during certain spans (e.g. stock did not
> exist yet). The right solution to me seems to either use data that
> overlaps (alignSymbols from qmao does that) or skip transactions for
> those symbols that have a gap on the particular dates.
>
> /Sergey
>
> On Mon, Feb 27, 2012 at 9:55 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Garett,
>>
>> Thanks, great point. Total blunder on my side. I will look into this further.
>>
>> /Sergey
>>
>> On Mon, Feb 27, 2012 at 9:45 AM, G See <gsee000 at gmail.com> wrote:
>>> Sergey,
>>>
>>> Do you have data for 2009 for AAT, because yahoo doesn't.
>>>
>>>> start(AAT)
>>> [1] "2011-01-13"
>>>
>>> HTH,
>>> Garrett
>>>
>>>
>>> On Mon, Feb 27, 2012 at 12:18 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>> Hi,
>>>>
>>>> Going even deeper I see that the problem occurs inside of .updatePosPL
>>>> function (blotter) where dates are extracted:
>>>>
>>>>> updatePortf(Portfolio='p', Dates=paste('2009-01-01', '::', '2009-04-06', sep=''))
>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>> parse.side(intervals[1]))) :
>>>> ?argument is of length zero
>>>>> traceback()
>>>> 4: xts:::.parseISO8601(Dates)
>>>> 3: first(xts:::.parseISO8601(Dates))
>>>> 2: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>> ? ? ? Dates = Dates, Prices = Prices, ... = ...)
>>>> 1: updatePortf(Portfolio = "p", Dates = paste("2009-01-01", "::",
>>>> ? ? ? "2009-04-06", sep = ""))
>>>>
>>>> I have looked in source code ?blotter / R / updatePortf.R and I see
>>>> the following lines:
>>>> ? ? ? ?startDate = first(xts:::.parseISO8601(Dates))$first.time-1 #does this
>>>> need to be a smaller/larger delta for millisecond data?
>>>> ? ? ? ?endDate ? = last(xts:::.parseISO8601(Dates))$last.time
>>>>
>>>> Apparently, the problem occurs in the "startDate" calculation. I tried
>>>> manually calling xts:::.parseISO8601('2009-04-06') and
>>>> xts:::.parseISO8601('::2009-04-06') and it works OK.
>>>>
>>>> Any ideas why xts:::.parse would be failing during script execution?
>>>>
>>>> --
>>>> Kind Regards,
>>>> Sergey Pisarenko.
>>>>
>>>> On Mon, Feb 27, 2012 at 6:51 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>> Hi,
>>>>>
>>>>> The specific line this occurs at is:
>>>>>
>>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>>> as.Date(timestamp), sep=''))
>>>>>
>>>>> The function is inside of the sizing function. I have checked that
>>>>> timestamp is valid when this function is called so the problem has to
>>>>> do with some sort of a state problem in the portfolio.
>>>>>
>>>>> /Sergey
>>>>>
>>>>> On Mon, Feb 27, 2012 at 6:41 AM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>> Hi,
>>>>>>
>>>>>> Sorry for not following up sooner as I had been away for a week. I
>>>>>> have been able to further narrow down the problem. It occurs in the
>>>>>> sizing function and only when there are too many symbols. I have
>>>>>> further trimmed down the sample code.
>>>>>>
>>>>>> I will continue troubleshooting this function. Do you have any ideas
>>>>>> that would point me in the right direction?
>>>>>>
>>>>>> /Sergey
>>>>>>
>>>>>> On Fri, Feb 17, 2012 at 9:11 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>>> Garett,
>>>>>>>
>>>>>>> Thank you for the response and looking into this. The same is observed
>>>>>>> when I use MySQL (I keep a copy of data on a local DB). Yahoo does not
>>>>>>> have data for all symbols as well so this might explain some of the
>>>>>>> 404s.
>>>>>>>
>>>>>>> /Sergey
>>>>>>>
>>>>>>> On Fri, Feb 17, 2012 at 12:08 PM, G See <gsee000 at gmail.com> wrote:
>>>>>>>> I've been having trouble with yahoo over the last 24 hours or so.
>>>>>>>> Sometimes, it returns data; sometimes it doesn't
>>>>>>>>
>>>>>>>>> watched <- c("A", "AA", "AAN", "AAP", "AAT", "AAV")
>>>>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>>>>> pausing 1 second between requests for more than 5 symbols
>>>>>>>> pausing 1 second between requests for more than 5 symbols
>>>>>>>> [1] "A" ? "AA" ?"AAN" "AAP" "AAT" "AAV"
>>>>>>>>> getSymbols(watched, src='yahoo', verbose=FALSE)
>>>>>>>> Error in download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>>>>> ?cannot open URL
>>>>>>>> 'http://chart.yahoo.com/table.csv?s=AAT&a=0&b=01&c=2007&d=1&e=17&f=2012&g=d&q=q&y=0&z=AAT&x=.csv'
>>>>>>>> In addition: Warning message:
>>>>>>>> In download.file(paste(yahoo.URL, "s=", Symbols.name, "&a=", from.m, ?:
>>>>>>>> ?cannot open: HTTP status was '404 Not Found'
>>>>>>>>
>>>>>>>>
>>>>>>>> HTH,
>>>>>>>> Garrett
>>>>>>>>
>>>>>>>> On Fri, Feb 17, 2012 at 2:01 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>>>>>>>>> Greetings to the R finance community,
>>>>>>>>>
>>>>>>>>> I have written a sizing function (pretty much a slight modification of
>>>>>>>>> a function from Guy Yollin's slides). The problem is that it fails
>>>>>>>>> whenever I use many symbols. It works fine for one or few symbols.
>>>>>>>>>
>>>>>>>>> The problem manifests itself inside of the sizing function, when
>>>>>>>>> updatePortf is run. The error I get is:
>>>>>>>>>> source('tainted_2.R')
>>>>>>>>> Error in if (nzchar(intervals[1])) s <- as.POSIXlt(do.call(firstof,
>>>>>>>>> parse.side(intervals[1]))) :
>>>>>>>>> ?argument is of length zero
>>>>>>>>>
>>>>>>>>> Traceback:
>>>>>>>>>> traceback()
>>>>>>>>> 13: xts:::.parseISO8601(Dates)
>>>>>>>>> 12: first(xts:::.parseISO8601(Dates))
>>>>>>>>> 11: .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
>>>>>>>>> ? ? ? ?Dates = Dates, Prices = Prices, ... = ...)
>>>>>>>>> 10: updatePortf(Portfolio = portfolio, Dates = paste("::", as.Date(timestamp),
>>>>>>>>> ? ? ? ?sep = "")) at tainted_2.R#100
>>>>>>>>> 9: osFUN(strategy = strategy, data = data, timestamp = timestamp,
>>>>>>>>> ? ? ? orderqty = orderqty, ordertype = ordertype, orderside = orderside,
>>>>>>>>> ? ? ? portfolio = portfolio, symbol = symbol, ... = ..., ruletype = ruletype,
>>>>>>>>> ? ? ? orderprice = as.numeric(orderprice))
>>>>>>>>> 8: function (data = mktdata, timestamp, sigcol, sigval, orderqty = 0,
>>>>>>>>> ? ? ? ordertype, orderside = NULL, threshold = NULL, tmult = FALSE,
>>>>>>>>> ? ? ? replace = TRUE, delay = 1e-04, osFUN = "osNoOp", pricemethod =
>>>>>>>>> c("market",
>>>>>>>>> ? ? ? ? ? "opside", "active"), portfolio, symbol, ..., ruletype,
>>>>>>>>> ? ? ? TxnFees = 0, prefer = NULL, sethold = FALSE)
>>>>>>>>> ...
>>>>>>>>> 7: do.call(fun, .formals)
>>>>>>>>> 6: ruleProc(strategy$rules[[type]], timestamp = timestamp, path.dep = path.dep,
>>>>>>>>> ? ? ? mktdata = mktdata, portfolio = portfolio, symbol = symbol,
>>>>>>>>> ? ? ? ruletype = type, mktinstr = mktinstr, ...)
>>>>>>>>> 5: applyRules(portfolio = portfolio, symbol = symbol, strategy = strategy,
>>>>>>>>> ? ? ? mktdata = mktdata, Dates = NULL, indicators = sret$indicators,
>>>>>>>>> ? ? ? signals = sret$signals, parameters = parameters, ..., path.dep = TRUE)
>>>>>>>>> 4: applyStrategy(strategy = "s", portfolios = "p")
>>>>>>>>> 3: eval.with.vis(expr, envir, enclos)
>>>>>>>>> 2: eval.with.vis(ei, envir)
>>>>>>>>> 1: source("tainted_2.R")
>>>>>>>>>
>>>>>>>>> The sizing function looks like:
>>>>>>>>>
>>>>>>>>> osPercentEquity <- function(timestamp, orderqty, portfolio, symbol,
>>>>>>>>> ruletype, ...) {
>>>>>>>>> ?posn <- getPosQty(portfolio, symbol, timestamp)
>>>>>>>>> ?if (posn == 0) {
>>>>>>>>> ? ?tempPortfolio <- getPortfolio(portfolio)
>>>>>>>>> ? ?dummy <- updatePortf(Portfolio=portfolio, Dates=paste('::',
>>>>>>>>> as.Date(timestamp), sep='')) ? ? # <<<<<< this is where it fails
>>>>>>>>> ? ?trading.pl <- sum(getPortfolio(portfolio)$summary$Net.Trading.PL)
>>>>>>>>> ? ?assign(paste("portfolio.", portfolio, sep=""), tempPortfolio, pos=.blotter)
>>>>>>>>> ? ?total.equity <- equity + trading.pl
>>>>>>>>> ? ?tradeSize <- total.equity * prcTrade
>>>>>>>>> ? ?ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>>>>>>>>> ? ?orderqty <- sign(orderqty) * round(tradeSize / ClosePrice)
>>>>>>>>> ? ?return(orderqty)
>>>>>>>>> ?}
>>>>>>>>> }
>>>>>>>>>
>>>>>>>>> The add.rule looks like:
>>>>>>>>> s <- add.rule(strategy=s, name='ruleSignal',
>>>>>>>>> arguments=list(data=quote(mktdata), sigcol='buySig', sigval=TRUE,
>>>>>>>>> orderqty=qtyDef, ordertype='market', orderside=NULL, threshold=NULL,
>>>>>>>>> osFUN='osPercentEquity', ruletype='enter'), type='enter')
>>>>>>>>>
>>>>>>>>> Traceback suggests that there is a problem with the date format. I
>>>>>>>>> have inserted print statements and verified that the date itself is
>>>>>>>>> fine. It is also weird that the issue does not occur when using few
>>>>>>>>> symbols.
>>>>>>>>>
>>>>>>>>> I have attached runnable code that reproduces the problem. Please
>>>>>>>>> excuse any apparent inefficiencies you see. I would like to get
>>>>>>>>> strategy working first and then optimize for performance.
>>>>>>>>>
>>>>>>>>> Is there something wrong with the approach I have taken? Once the
>>>>>>>>> number of symbols is reduced the problem does not trigger.
>>>>>>>>>
>>>>>>>>> Truly appreciate your help.
>>>>>>>>>
>>>>>>>>> --
>>>>>>>>> Kind Regards,
>>>>>>>>> Sergey Pisarenko.
>>>>>>>>>
>>>>>>>>> _______________________________________________
>>>>>>>>> R-SIG-Finance at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>>>>> -- Also note that this is not the r-help list where general R questions should go.


From sergio.bizzotto at reechaim.com  Tue Feb 28 17:05:47 2012
From: sergio.bizzotto at reechaim.com (sergio)
Date: Tue, 28 Feb 2012 08:05:47 -0800 (PST)
Subject: [R-SIG-Finance] RBloomberg download - findata.org disappeared
Message-ID: <1330445147871-4428593.post@n4.nabble.com>

Hi,

Its seems like the the site http://findata.org/rbloomberg is not longer
existing. Where else can I download the latest version of the RBloomberg
package?

Thanks.

--
View this message in context: http://r.789695.n4.nabble.com/RBloomberg-download-findata-org-disappeared-tp4428593p4428593.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jeffrey.ryan at lemnica.com  Tue Feb 28 17:14:26 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 28 Feb 2012 10:14:26 -0600
Subject: [R-SIG-Finance] RBloomberg download - findata.org disappeared
In-Reply-To: <1330445147871-4428593.post@n4.nabble.com>
References: <1330445147871-4428593.post@n4.nabble.com>
Message-ID: <CABDUZc9S2STSjSn7kspMCTGUFFWJ5s6017ie=VYAZ9XESdvmNA@mail.gmail.com>

The domain expired on Feb 24th, so the maintainer may have just
forgotten to renew.

Jeff

On Tue, Feb 28, 2012 at 10:05 AM, sergio <sergio.bizzotto at reechaim.com> wrote:
> Hi,
>
> Its seems like the the site http://findata.org/rbloomberg is not longer
> existing. Where else can I download the latest version of the RBloomberg
> package?
>
> Thanks.
>
> --
> View this message in context: http://r.789695.n4.nabble.com/RBloomberg-download-findata-org-disappeared-tp4428593p4428593.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From jeffrey.ryan at lemnica.com  Tue Feb 28 17:15:47 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 28 Feb 2012 10:15:47 -0600
Subject: [R-SIG-Finance] RBloomberg download - findata.org disappeared
In-Reply-To: <CABDUZc9S2STSjSn7kspMCTGUFFWJ5s6017ie=VYAZ9XESdvmNA@mail.gmail.com>
References: <1330445147871-4428593.post@n4.nabble.com>
	<CABDUZc9S2STSjSn7kspMCTGUFFWJ5s6017ie=VYAZ9XESdvmNA@mail.gmail.com>
Message-ID: <CABDUZc_vAQUdSYx-UHj2geA3NimjoNxh7VXGCwWEbjrnizFoHA@mail.gmail.com>

Actually, doesn't expire until 2013, my mistake. That makes it more of
a problem/concern.

Jeff

On Tue, Feb 28, 2012 at 10:14 AM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
> The domain expired on Feb 24th, so the maintainer may have just
> forgotten to renew.
>
> Jeff
>
> On Tue, Feb 28, 2012 at 10:05 AM, sergio <sergio.bizzotto at reechaim.com> wrote:
>> Hi,
>>
>> Its seems like the the site http://findata.org/rbloomberg is not longer
>> existing. Where else can I download the latest version of the RBloomberg
>> package?
>>
>> Thanks.
>>
>> --
>> View this message in context: http://r.789695.n4.nabble.com/RBloomberg-download-findata-org-disappeared-tp4428593p4428593.html
>> Sent from the Rmetrics mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
> www.esotericR.com
>
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
>
> See you in Chicago!!!!



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From jeff.davis at gmail.com  Tue Feb 28 18:00:28 2012
From: jeff.davis at gmail.com (Jeff Davis)
Date: Tue, 28 Feb 2012 12:00:28 -0500
Subject: [R-SIG-Finance] RBloomberg download - findata.org disappeared
In-Reply-To: <CABDUZc_vAQUdSYx-UHj2geA3NimjoNxh7VXGCwWEbjrnizFoHA@mail.gmail.com>
References: <1330445147871-4428593.post@n4.nabble.com>
	<CABDUZc9S2STSjSn7kspMCTGUFFWJ5s6017ie=VYAZ9XESdvmNA@mail.gmail.com>
	<CABDUZc_vAQUdSYx-UHj2geA3NimjoNxh7VXGCwWEbjrnizFoHA@mail.gmail.com>
Message-ID: <CAHx6z=iRuFtBZ-JNm1sZqL+zbyid_O7TD1wXiqnBW1KA8CU-7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/65adf3d3/attachment.pl>

From Sergio.Bizzotto at reechaim.com  Tue Feb 28 18:13:36 2012
From: Sergio.Bizzotto at reechaim.com (Sergio Bizzotto)
Date: Tue, 28 Feb 2012 17:13:36 +0000
Subject: [R-SIG-Finance] RBloomberg download - findata.org disappeared
In-Reply-To: <CAHx6z=iRuFtBZ-JNm1sZqL+zbyid_O7TD1wXiqnBW1KA8CU-7w@mail.gmail.com>
References: <1330445147871-4428593.post@n4.nabble.com>
	<CABDUZc9S2STSjSn7kspMCTGUFFWJ5s6017ie=VYAZ9XESdvmNA@mail.gmail.com>
	<CABDUZc_vAQUdSYx-UHj2geA3NimjoNxh7VXGCwWEbjrnizFoHA@mail.gmail.com>
	<CAHx6z=iRuFtBZ-JNm1sZqL+zbyid_O7TD1wXiqnBW1KA8CU-7w@mail.gmail.com>
Message-ID: <DA69F6A76F562947A10AB226CC218DBF1579E71C@SRV-HH-EX01.Reech.local>

Does anyone have a link for the actual original .zip RBloomberg package?


From: Jeff Davis [mailto:jeff.davis at gmail.com]
Sent: 28 February 2012 17:00
To: Jeffrey Ryan
Cc: Sergio Bizzotto; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] RBloomberg download - findata.org disappeared

I have a fork of the code at https://github.com/jcdny/RBloomberg if anyone needs it.

I added roxygen api documentation and modified the code to support SAPI.  I think it works
on R 2.14 though I am not 100% sure as I was still using 2.13 last time I touched the code.

--Jeff

On Tue, Feb 28, 2012 at 11:15 AM, Jeffrey Ryan <jeffrey.ryan at lemnica.com<mailto:jeffrey.ryan at lemnica.com>> wrote:
Actually, doesn't expire until 2013, my mistake. That makes it more of
a problem/concern.

Jeff

On Tue, Feb 28, 2012 at 10:14 AM, Jeffrey Ryan <jeffrey.ryan at lemnica.com<mailto:jeffrey.ryan at lemnica.com>> wrote:
> The domain expired on Feb 24th, so the maintainer may have just
> forgotten to renew.
>
> Jeff
>
> On Tue, Feb 28, 2012 at 10:05 AM, sergio <sergio.bizzotto at reechaim.com<mailto:sergio.bizzotto at reechaim.com>> wrote:
>> Hi,
>>
>> Its seems like the the site http://findata.org/rbloomberg is not longer
>> existing. Where else can I download the latest version of the RBloomberg
>> package?
>>
>> Thanks.
>>
>> --
>> View this message in context: http://r.789695.n4.nabble.com/RBloomberg-download-findata-org-disappeared-tp4428593p4428593.html
>> Sent from the Rmetrics mailing list archive at Nabble.com.
>>
>>



Sergio Bizzotto

Risk Manager



[cid:image8f47de.JPG at d9eadb84.45bcd3f5]

Reech AiM Partners LLP, Henrietta House, 8 Henrietta Place,London,W1G 0NB,United Kingdom

DDI:+44 20 7399 3665;Mobile:+444 77 8033 6538;

Fax:+44 20 7399 3698;Switchboard: +44 20 7399 3650  www.reechaim.com<http://www.reechaim.com>



Reech AiM Partners LLP, Registered Office: 4th Floor, Reading Bridge House, George Street, Reading RG1 8LS.  Registered in England and Wales No. OC321436.  Authorised and regulated by the Financial Services Authority. Reech CBRE Alternative Real Estate LLP, Registered Office: 4th Floor, Reading Bridge House, George Street, Reading RG1 8LS.  Registered in England and Wales No. OC322313.  Authorised and regulated by the Financial Services Authority. This message and any attachments (the "message") is intended solely for the addressees and is confidential.


_______________________________________________
>> R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com<mailto:jeffrey.ryan at lemnica.com>
>
> www.lemnica.com<http://www.lemnica.com>
> www.esotericR.com<http://www.esotericR.com>
>
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com<http://www.RinFinance.com>
>
> See you in Chicago!!!!



--
Jeffrey Ryan
jeffrey.ryan at lemnica.com<mailto:jeffrey.ryan at lemnica.com>

www.lemnica.com<http://www.lemnica.com>
www.esotericR.com<http://www.esotericR.com>

R/Finance 2012: Applied Finance with R
www.RinFinance.com<http://www.RinFinance.com>

See you in Chicago!!!!

_______________________________________________
R-SIG-Finance at r-project.org<mailto:R-SIG-Finance at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/c82e639a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image8f47de.JPG
Type: image/jpeg
Size: 20254 bytes
Desc: image8f47de.JPG
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/c82e639a/attachment.jpe>

From john.laing at gmail.com  Tue Feb 28 18:51:05 2012
From: john.laing at gmail.com (John Laing)
Date: Tue, 28 Feb 2012 12:51:05 -0500
Subject: [R-SIG-Finance] RBloomberg download - findata.org disappeared
In-Reply-To: <DA69F6A76F562947A10AB226CC218DBF1579E71C@SRV-HH-EX01.Reech.local>
References: <1330445147871-4428593.post@n4.nabble.com>
	<CABDUZc9S2STSjSn7kspMCTGUFFWJ5s6017ie=VYAZ9XESdvmNA@mail.gmail.com>
	<CABDUZc_vAQUdSYx-UHj2geA3NimjoNxh7VXGCwWEbjrnizFoHA@mail.gmail.com>
	<CAHx6z=iRuFtBZ-JNm1sZqL+zbyid_O7TD1wXiqnBW1KA8CU-7w@mail.gmail.com>
	<DA69F6A76F562947A10AB226CC218DBF1579E71C@SRV-HH-EX01.Reech.local>
Message-ID: <CAA3Wa=u7YyVPpSnAWYHsHfw3PA+t_w-WA2_ds0GpGUW0w2-+rQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/350e83be/attachment.pl>

From comtech.usa at gmail.com  Tue Feb 28 18:55:02 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 28 Feb 2012 11:55:02 -0600
Subject: [R-SIG-Finance] Splitting time series into blocks/regimes?
Message-ID: <CAPNjSFZzyebaBt7gwMq0fR7qN-Qh-VEA8cQoDjkpuZ_zyYyzBA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/891b7882/attachment.pl>

From comtech.usa at gmail.com  Wed Feb 29 06:29:06 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 28 Feb 2012 23:29:06 -0600
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <E2339A3600811248AB525B8FAB3A1BCE68EAB092@srv-mail-101.zhaw.ch>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>
	<4F482599.3020109@gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>
	<CAPNjSFbOQOGGe4P592Qj5W9q4CU4HP9c-0kQXYMHhpawW_9eZw@mail.gmail.com>
	<CAHz+bWZ2sW5PfQD0JDTYh_XRNUydTEUMwzVmxuQTbXiQ_QPgDg@mail.gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAB092@srv-mail-101.zhaw.ch>
Message-ID: <CAPNjSFZ=tmqdJ7_O--N_MUhyQR7N7Kvxxr1i75ZAnHysEdx6gA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120228/f99e9718/attachment.pl>

From ustaudinger at activequant.com  Wed Feb 29 09:37:32 2012
From: ustaudinger at activequant.com (Ulrich Staudinger)
Date: Wed, 29 Feb 2012 09:37:32 +0100
Subject: [R-SIG-Finance] Causal version of HP filter and Kernel
 Smoothing in R?
In-Reply-To: <CAPNjSFZ=tmqdJ7_O--N_MUhyQR7N7Kvxxr1i75ZAnHysEdx6gA@mail.gmail.com>
References: <CAPNjSFat9re=5NyJ4Wg3cgRmnwu46prFiRQ_=6ARURiNjAjQdQ@mail.gmail.com>
	<1330123307.13240.9.camel@brian-desktop>
	<CAPNjSFbDPgLnbq3LK3uB1WCm9A0GD3NqNLG1AKqYiZtLLZ79sA@mail.gmail.com>
	<1330124427.13240.18.camel@brian-desktop>
	<4F482599.3020109@gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAAFF6@srv-mail-101.zhaw.ch>
	<CAPNjSFbOQOGGe4P592Qj5W9q4CU4HP9c-0kQXYMHhpawW_9eZw@mail.gmail.com>
	<CAHz+bWZ2sW5PfQD0JDTYh_XRNUydTEUMwzVmxuQTbXiQ_QPgDg@mail.gmail.com>
	<E2339A3600811248AB525B8FAB3A1BCE68EAB092@srv-mail-101.zhaw.ch>
	<CAPNjSFZ=tmqdJ7_O--N_MUhyQR7N7Kvxxr1i75ZAnHysEdx6gA@mail.gmail.com>
Message-ID: <CAMrz3D2TaeoZvwbRF3z0=ZbpatKLWU6hxuon6MJfp2+g3d+jRg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120229/ba512a2a/attachment.pl>

From wobwu22 at gmail.com  Wed Feb 29 10:58:18 2012
From: wobwu22 at gmail.com (Wolfgang Wu)
Date: Wed, 29 Feb 2012 09:58:18 +0000
Subject: [R-SIG-Finance] Update price data on disk using mmap package
Message-ID: <4F4DF6BA.7070904@gmail.com>

Hello everyone,

I am currently storing my price data for fast access as a mmap file on 
disk. This works great and is super fast. All data is in one big file 
which I subset to get the data I need into memory.

Now I will need to update that data that is stored on disk on a daily 
basis to store new data. The solution I currently have is to load all 
data into memory, append the new data to the data in memory and then 
store everything again as mmap on disk. Unfortunately I am running into 
memory problems now when loading all of the data into memory.

So my question is:  Is it possible to append new prices directly into my 
file on disk without loading everything into memory? And if, how?

Any help is appreciated!!


Here is an example of what I am trying to do:

library(quantmod)
library(mmap)

#Just for setting up the example
getSymbols('SPY')
xtsPrices <- SPY[1:(nrow(SPY)-1), ];
xtsNewPrice <- last(SPY);

#Save prices in mmap on disk
cFile <- 'C:/temp/PriceData.mmap'
nPrices <- as.numeric(xtsPrices);
mmapPrices <- as.mmap(nPrices, mode=double(), file=cFile);
munmap(mmapPrices);

#Now I would like to append the new prices directly to the mmap object 
on disk
mmapPrices <- mmap(file=cFile, mode=double());
nNewPrice <- as.numeric(xtsNewPrice);
mmapPrices <- c(mmapPrices, nNewPrice); #This line does not work how I 
hoped it would.




Regards,

Wolfgang


From michael.weylandt at gmail.com  Wed Feb 29 13:24:29 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Wed, 29 Feb 2012 07:24:29 -0500
Subject: [R-SIG-Finance] Splitting time series into blocks/regimes?
In-Reply-To: <CAPNjSFZzyebaBt7gwMq0fR7qN-Qh-VEA8cQoDjkpuZ_zyYyzBA@mail.gmail.com>
References: <CAPNjSFZzyebaBt7gwMq0fR7qN-Qh-VEA8cQoDjkpuZ_zyYyzBA@mail.gmail.com>
Message-ID: <CAAmySGMvFuHEBWcUgjxvJvcFPHNe9iT2yRb2fH1wNjnYG86t1w@mail.gmail.com>

I find this idea methodologically iffy, but perhaps you could do a
little bit to make it a well posed question:

i) Are you picking these periods as relatively equal divisions or time
or as ex-post artifacts of "all that mess"

ii) What is "the clustering algorithm"? Aren't there quite a few?

iii) What does this mean: "the 3 big blocks/regimes need to be
contiguous within each block/regime itself..."

Perhaps you should look into reformulating your idea in terms of
regime switching models.

Michael Weylandt

On Tue, Feb 28, 2012 at 12:55 PM, Michael <comtech.usa at gmail.com> wrote:
> Hi all,
>
> I have a time series of historical SP500 returns.
> How do I split it into a few non-overlapping blocks(regimes) in time in an
> automated fashion?
> For example, given a prespecified number N which is the number of
> blocks/regimes, lets say 3.
> And given 5 year history of SP500 time series and returns.
> Manually, the period before Sept. 2008 is one regime. The period in-between
> Sept. 2008 and arguably May 2010 is the 2nd regime.
> Then the third regime is from May 2010 until today.
> So then we have three blocks/regimes splitted.
> Is there a way to split automatically?
> I have been thinking about using clustering algorithm on the returns.
> However, what is needed is a constrained version of the clustering
> algorithm, i.e. the 3 big blocks/regimes need to be contiguous within each
> block/regime itself...
> I am looking for a way to do this in R...
> Any thoughts are highly appreciated!
> Thanks a lot!
>
> FYI: I have asked a similar question before on this list but somehow I felt
> it's probably better to renew the question with my newer and more concrete
> examples. Also I've listed my question here so the answers to my question
> could be reference for fellow statisticians in the future...
> http://stats.stackexchange.com/questions/23817/splitting-time-series-data-into-blocks-regimes
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ecsniffer at hotmail.com  Wed Feb 29 13:26:54 2012
From: ecsniffer at hotmail.com (LINJUAN)
Date: Wed, 29 Feb 2012 12:26:54 +0000
Subject: [R-SIG-Finance] test for the change in the parameters in
 t-GARCH model
In-Reply-To: <SNT118-W54064F3E7325C9FE977456AA6E0@phx.gbl>
References: <SNT118-W48C784923BA3960E540F1FAA690@phx.gbl>, ,
	<1330343381.13240.62.camel@brian-desktop>,
	<SNT118-W54064F3E7325C9FE977456AA6E0@phx.gbl>
Message-ID: <SNT118-W11F50A837347A187DEFEB0AA6F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120229/2b73f4b8/attachment.pl>

From ecsniffer at hotmail.com  Wed Feb 29 13:34:25 2012
From: ecsniffer at hotmail.com (LINJUAN)
Date: Wed, 29 Feb 2012 12:34:25 +0000
Subject: [R-SIG-Finance] test for the change in the parameters in
 t-GARCH model
In-Reply-To: <SNT118-W11F50A837347A187DEFEB0AA6F0@phx.gbl>
References: <SNT118-W48C784923BA3960E540F1FAA690@phx.gbl>,
	, , <1330343381.13240.62.camel@brian-desktop>, ,
	<SNT118-W54064F3E7325C9FE977456AA6E0@phx.gbl>,
	<SNT118-W11F50A837347A187DEFEB0AA6F0@phx.gbl>
Message-ID: <SNT118-W4508766AFCACEDD1BA1363AA6F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120229/e4f5e8a7/attachment.pl>

From armstrong.whit at gmail.com  Wed Feb 29 13:55:58 2012
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Wed, 29 Feb 2012 07:55:58 -0500
Subject: [R-SIG-Finance] Splitting time series into blocks/regimes?
In-Reply-To: <CAAmySGMvFuHEBWcUgjxvJvcFPHNe9iT2yRb2fH1wNjnYG86t1w@mail.gmail.com>
References: <CAPNjSFZzyebaBt7gwMq0fR7qN-Qh-VEA8cQoDjkpuZ_zyYyzBA@mail.gmail.com>
	<CAAmySGMvFuHEBWcUgjxvJvcFPHNe9iT2yRb2fH1wNjnYG86t1w@mail.gmail.com>
Message-ID: <CAMi=pg6bzbNq9_9yKR0=tFcVwow_OEPGwBFD8pyTxisMM+9+mQ@mail.gmail.com>

It's not easy to do this.

http://dss.ucsd.edu/~jhamilto/palgrav1.pdf
http://www.econ.washington.edu/user/cnelson/markov/prgmlist.htm

Most people use gibbs sampling or other mcmc methods.

as it happens, I have some software you can use if you don't mind
getting your hands dirty.
https://github.com/armstrtw/CppBugs

or you can just use BUGS/JAGS.

also, some code is here:
http://faculty.chicagobooth.edu/hedibert.lopes/teaching/sa2011/sa2011.html

-Whit



On Wed, Feb 29, 2012 at 7:24 AM, R. Michael Weylandt
<michael.weylandt at gmail.com> wrote:
> I find this idea methodologically iffy, but perhaps you could do a
> little bit to make it a well posed question:
>
> i) Are you picking these periods as relatively equal divisions or time
> or as ex-post artifacts of "all that mess"
>
> ii) What is "the clustering algorithm"? Aren't there quite a few?
>
> iii) What does this mean: "the 3 big blocks/regimes need to be
> contiguous within each block/regime itself..."
>
> Perhaps you should look into reformulating your idea in terms of
> regime switching models.
>
> Michael Weylandt
>
> On Tue, Feb 28, 2012 at 12:55 PM, Michael <comtech.usa at gmail.com> wrote:
>> Hi all,
>>
>> I have a time series of historical SP500 returns.
>> How do I split it into a few non-overlapping blocks(regimes) in time in an
>> automated fashion?
>> For example, given a prespecified number N which is the number of
>> blocks/regimes, lets say 3.
>> And given 5 year history of SP500 time series and returns.
>> Manually, the period before Sept. 2008 is one regime. The period in-between
>> Sept. 2008 and arguably May 2010 is the 2nd regime.
>> Then the third regime is from May 2010 until today.
>> So then we have three blocks/regimes splitted.
>> Is there a way to split automatically?
>> I have been thinking about using clustering algorithm on the returns.
>> However, what is needed is a constrained version of the clustering
>> algorithm, i.e. the 3 big blocks/regimes need to be contiguous within each
>> block/regime itself...
>> I am looking for a way to do this in R...
>> Any thoughts are highly appreciated!
>> Thanks a lot!
>>
>> FYI: I have asked a similar question before on this list but somehow I felt
>> it's probably better to renew the question with my newer and more concrete
>> examples. Also I've listed my question here so the answers to my question
>> could be reference for fellow statisticians in the future...
>> http://stats.stackexchange.com/questions/23817/splitting-time-series-data-into-blocks-regimes
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ecsniffer at hotmail.com  Wed Feb 29 19:54:32 2012
From: ecsniffer at hotmail.com (LINJUAN)
Date: Wed, 29 Feb 2012 18:54:32 +0000
Subject: [R-SIG-Finance] How to add the dummy variable in GARCH
	model(RUGARCH package)
Message-ID: <SNT118-W29CE6F5EE67831AF095D11AA6F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120229/0c6acc19/attachment.pl>

From sethy.anmol at gmail.com  Thu Mar  1 01:25:47 2012
From: sethy.anmol at gmail.com (Anmol Sethy)
Date: Thu, 1 Mar 2012 08:25:47 +0800
Subject: [R-SIG-Finance] Splitting time series into blocks/regimes?
In-Reply-To: <CAMi=pg6bzbNq9_9yKR0=tFcVwow_OEPGwBFD8pyTxisMM+9+mQ@mail.gmail.com>
References: <CAPNjSFZzyebaBt7gwMq0fR7qN-Qh-VEA8cQoDjkpuZ_zyYyzBA@mail.gmail.com>
	<CAAmySGMvFuHEBWcUgjxvJvcFPHNe9iT2yRb2fH1wNjnYG86t1w@mail.gmail.com>
	<CAMi=pg6bzbNq9_9yKR0=tFcVwow_OEPGwBFD8pyTxisMM+9+mQ@mail.gmail.com>
Message-ID: <17517CF8-ED18-4043-BB50-2F5528F67B2D@gmail.com>

It is a difficult task and results will invariably do not match with what one's intuition might be suggesting.

You can have a look at strucchange package as well and explore topics related to distance measurements in correlation matrices.

Regards
Anmol 



On 29 Feb, 2012, at 20:55, Whit Armstrong <armstrong.whit at gmail.com> wrote:

> It's not easy to do this.
> 
> http://dss.ucsd.edu/~jhamilto/palgrav1.pdf
> http://www.econ.washington.edu/user/cnelson/markov/prgmlist.htm
> 
> Most people use gibbs sampling or other mcmc methods.
> 
> as it happens, I have some software you can use if you don't mind
> getting your hands dirty.
> https://github.com/armstrtw/CppBugs
> 
> or you can just use BUGS/JAGS.
> 
> also, some code is here:
> http://faculty.chicagobooth.edu/hedibert.lopes/teaching/sa2011/sa2011.html
> 
> -Whit
> 
> 
> 
> On Wed, Feb 29, 2012 at 7:24 AM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>> I find this idea methodologically iffy, but perhaps you could do a
>> little bit to make it a well posed question:
>> 
>> i) Are you picking these periods as relatively equal divisions or time
>> or as ex-post artifacts of "all that mess"
>> 
>> ii) What is "the clustering algorithm"? Aren't there quite a few?
>> 
>> iii) What does this mean: "the 3 big blocks/regimes need to be
>> contiguous within each block/regime itself..."
>> 
>> Perhaps you should look into reformulating your idea in terms of
>> regime switching models.
>> 
>> Michael Weylandt
>> 
>> On Tue, Feb 28, 2012 at 12:55 PM, Michael <comtech.usa at gmail.com> wrote:
>>> Hi all,
>>> 
>>> I have a time series of historical SP500 returns.
>>> How do I split it into a few non-overlapping blocks(regimes) in time in an
>>> automated fashion?
>>> For example, given a prespecified number N which is the number of
>>> blocks/regimes, lets say 3.
>>> And given 5 year history of SP500 time series and returns.
>>> Manually, the period before Sept. 2008 is one regime. The period in-between
>>> Sept. 2008 and arguably May 2010 is the 2nd regime.
>>> Then the third regime is from May 2010 until today.
>>> So then we have three blocks/regimes splitted.
>>> Is there a way to split automatically?
>>> I have been thinking about using clustering algorithm on the returns.
>>> However, what is needed is a constrained version of the clustering
>>> algorithm, i.e. the 3 big blocks/regimes need to be contiguous within each
>>> block/regime itself...
>>> I am looking for a way to do this in R...
>>> Any thoughts are highly appreciated!
>>> Thanks a lot!
>>> 
>>> FYI: I have asked a similar question before on this list but somehow I felt
>>> it's probably better to renew the question with my newer and more concrete
>>> examples. Also I've listed my question here so the answers to my question
>>> could be reference for fellow statisticians in the future...
>>> http://stats.stackexchange.com/questions/23817/splitting-time-series-data-into-blocks-regimes
>>> 
>>>        [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ccquant at gmail.com  Thu Mar  1 04:06:52 2012
From: ccquant at gmail.com (Ben quant)
Date: Wed, 29 Feb 2012 20:06:52 -0700
Subject: [R-SIG-Finance] quantstrat - 1) iceberg, 2) trailing entry examples,
 and 3) fundamental data indicator
Message-ID: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120229/6394bf46/attachment.pl>

From drseergio at gmail.com  Thu Mar  1 06:46:26 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Thu, 1 Mar 2012 06:46:26 +0100
Subject: [R-SIG-Finance] Potential bug in quantstrat in how it handles "F"
	symbol
Message-ID: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>

Hi,

I have been running a strategy against a large selection of market
symbols and stumbled across of what appears to be a bug in how
quanstrat gets market data in "applyStrategy" method.

The problem lies in the strategy.R file, in the applyStrategy method:

applyStrategy <- function(strategy , portfolios, mktdata=NULL ,
parameters=NULL, ..., verbose=TRUE, symbols=NULL, initStrat=FALSE,
updateStrat=FALSE ) {
..
        for (symbol in symbols){
            if(isTRUE(load.mktdata)) mktdata <- get(symbol)

The issue here is that get('F') will return FALSE because F is defined
as FALSE in R. This will obviously cause a failure down the road where
market data is read and manipulated.

Perhaps it should be looking in a specific environment instead of
using get against all environments.

/Sergey


From rex at nosyntax.net  Thu Mar  1 08:53:43 2012
From: rex at nosyntax.net (rex)
Date: Wed, 29 Feb 2012 23:53:43 -0800
Subject: [R-SIG-Finance] Potential bug in quantstrat in how it handles
 "F" symbol
In-Reply-To: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>
References: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>
Message-ID: <20120301075343.GP30530@ninja.nosyntax.net>

Sergey Pisarenko <drseergio at gmail.com> [2012-02-29 22:29]:
>
>The issue here is that get('F') will return FALSE because F is defined
>as FALSE in R. This will obviously cause a failure down the road where
>market data is read and manipulated.

Hello Sergey,

Easy fix:

> if (F == FALSE) print('F == FALSE')
[1] "F == FALSE"
> F <- 'F'
> if (F == FALSE) print('F == FALSE')
>

-rex
--


From brian at braverock.com  Thu Mar  1 15:04:00 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 01 Mar 2012 08:04:00 -0600
Subject: [R-SIG-Finance] Potential bug in quantstrat in how it handles
 "F" symbol
In-Reply-To: <20120301075343.GP30530@ninja.nosyntax.net>
References: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>
	<20120301075343.GP30530@ninja.nosyntax.net>
Message-ID: <1330610640.28362.56.camel@brian-rcg>

On Wed, 2012-02-29 at 23:53 -0800, rex wrote:
> Sergey Pisarenko <drseergio at gmail.com> [2012-02-29 22:29]:
> >
> >The issue here is that get('F') will return FALSE because F is defined
> >as FALSE in R. This will obviously cause a failure down the road where
> >market data is read and manipulated.
> 
> Hello Sergey,
> 
> Easy fix:
> 
> > if (F == FALSE) print('F == FALSE')
> [1] "F == FALSE"
> > F <- 'F'
> > if (F == FALSE) print('F == FALSE')
> >

According to the R FAQ[1]:
"In R, T and F are just variables being set to TRUE and FALSE,
respectively, but are not reserved words as in S and hence can be
overwritten by the user. (This helps e.g. when you have factors with
levels "T" or "F".) Hence, when writing code you should always use TRUE
and FALSE."

I think you'll find that blotter, quantstrat, FinancialInstrument all
use TRUE and FALSE correctly.

If you are trying to load data for Ford, you would already have locally
overwritten the F variable with your data for Ford.

> require(quantmod, quietly=TRUE)
> getSymbols('F')
[1] "F"
> head(F)
           F.Open F.High F.Low F.Close F.Volume F.Adjusted
2007-01-03   7.56   7.67  7.44    7.51 78652200       7.48
2007-01-04   7.56   7.72  7.43    7.70 63454900       7.67
2007-01-05   7.72   7.75  7.57    7.62 40562100       7.59
2007-01-08   7.63   7.75  7.62    7.73 48938500       7.70
2007-01-09   7.75   7.86  7.73    7.79 56732200       7.76
2007-01-10   7.79   7.79  7.67    7.73 42397100       7.70
> head(get('F'))
           F.Open F.High F.Low F.Close F.Volume F.Adjusted
2007-01-03   7.56   7.67  7.44    7.51 78652200       7.48
2007-01-04   7.56   7.72  7.43    7.70 63454900       7.67
2007-01-05   7.72   7.75  7.57    7.62 40562100       7.59
2007-01-08   7.63   7.75  7.62    7.73 48938500       7.70
2007-01-09   7.75   7.86  7.73    7.79 56732200       7.76
2007-01-10   7.79   7.79  7.67    7.73 42397100       7.70

so, get('F') will only return FALSE if you don't have any data loaded.  

That is a problem on your end, I think, and not a problem in the
package.

Regards,

   - Brian

Ref:
[1]
http://sites.stat.psu.edu/~dhunter/R/doc/manual/R-FAQ.html#What-are-the-differences-between-R-and-S_003f
(see section 3.3.3)

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From ccquant at gmail.com  Thu Mar  1 17:31:38 2012
From: ccquant at gmail.com (Ben quant)
Date: Thu, 1 Mar 2012 09:31:38 -0700
Subject: [R-SIG-Finance] quantstrat - 1) iceberg,
 2) trailing entry examples, and 3) fundamental data indicator
In-Reply-To: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>
References: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>
Message-ID: <CAG2PC+d-Y2AGj3R+Pue4CZJKJtXB3F9OKss999beK=knAjtaAA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120301/c19f28ea/attachment.pl>

From brian at braverock.com  Thu Mar  1 17:51:47 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 01 Mar 2012 10:51:47 -0600
Subject: [R-SIG-Finance] quantstrat - 1) iceberg,
 2) trailing entry examples, and 3) fundamental data indicator
In-Reply-To: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>
References: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>
Message-ID: <1330620707.28362.64.camel@brian-rcg>

On Wed, 2012-02-29 at 20:06 -0700, Ben quant wrote:
> Hello,
> 
> I've search all of the demo scripts (I think) and quite a bit online, but I
> have not seen an example of an 'iceberg' order or a trailing entry. The
> iceberg is listed as a supported ordertype so I suspect there is an example
> out there somewhere. For the trailing entry, I was just hoping there was an
> example I could see out there somewhere.

Not that I know of (at least, I haven't written one)

Icebergs, as documented, will ack like a limit order at your shown
quantity, when filled, they will enter a new order for the same shown
quantity at the same price.  When I wrote them, I had access to a better
(proprietary) fill simulator, so I'm not sure how much use they would be
with the default quantstrat fill simulation, YMMV.

For trailing orders, all I can say is 'try them'.
 
> On a different note, my company has quite a bit of historical fundamental
> data I can use. I was thinking if I put the fundamental data in the same
> format as the other indicators I could make rules based on the fundamental
> data and backtest price and fundamental data. Or is this not possible?

Sure you can, just add columns to your market data objects, then
inidcator and signal functions will be able to utilize them.
Alternately, have your custom indicator and signal functions look things
up in whatever repository you have locally.  

> I'm brand new to the quantstrat package. Still getting my head around it.
> Cool package so far.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From ccquant at gmail.com  Thu Mar  1 18:05:54 2012
From: ccquant at gmail.com (Ben quant)
Date: Thu, 1 Mar 2012 10:05:54 -0700
Subject: [R-SIG-Finance] quantstrat - 1) iceberg,
 2) trailing entry examples, and 3) fundamental data indicator
In-Reply-To: <1330620707.28362.64.camel@brian-rcg>
References: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>
	<1330620707.28362.64.camel@brian-rcg>
Message-ID: <CAG2PC+dGCz7W0WUzPtjcg9-Vfcvb+RQMHmY5+60awmbGzK273Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120301/d426bab9/attachment.pl>

From brian at braverock.com  Thu Mar  1 18:15:49 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 01 Mar 2012 11:15:49 -0600
Subject: [R-SIG-Finance] quantstrat - 1) iceberg,
 2) trailing entry examples, and 3) fundamental data indicator
In-Reply-To: <CAG2PC+dGCz7W0WUzPtjcg9-Vfcvb+RQMHmY5+60awmbGzK273Q@mail.gmail.com>
References: <CAG2PC+dk8dDg0PpHKvRxhWh+3fVbt0OtmzVvJM_WVw14aBYpYA@mail.gmail.com>
	<1330620707.28362.64.camel@brian-rcg>
	<CAG2PC+dGCz7W0WUzPtjcg9-Vfcvb+RQMHmY5+60awmbGzK273Q@mail.gmail.com>
Message-ID: <1330622149.28362.65.camel@brian-rcg>

On Thu, 2012-03-01 at 10:05 -0700, Ben quant wrote:
> Thanks Brian,
> 
> What is the dev status on the package? I see some recent activity (by
> you and gsee) here:
> https://r-forge.r-project.org/scm/viewvc.php/pkg/quantstrat/R/?root=blotter
> 
> Are things full steam ahead, stalled or plugging along etc? 

Still under active development and maintenance.


-- 
Brian


From drseergio at gmail.com  Thu Mar  1 18:35:48 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Thu, 1 Mar 2012 18:35:48 +0100
Subject: [R-SIG-Finance] Potential bug in quantstrat in how it handles
	"F" symbol
In-Reply-To: <1330610640.28362.56.camel@brian-rcg>
References: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>
	<20120301075343.GP30530@ninja.nosyntax.net>
	<1330610640.28362.56.camel@brian-rcg>
Message-ID: <CAEGu7FtrX13ZGPyPJ9+DX1qj68W-1QnGOLQnPUZHZg8-j6EfMQ@mail.gmail.com>

Hi Brian and rex,

Thank you for looking into this. This is strange because that's
exactly what's happening. Here's how I load the data:

watched   <- c('F')

symbols <- vector()
for (symbol in watched) {
  ubars    <- tryCatch(getSymbols(symbol, src='MySQL',
auto.assign=FALSE), error=function(e) NULL)
  # skip if we don't have enough data
  if (is.null(ubars) || nrow(ubars) < startDay) next
  symbols  <- c(symbols, symbol)
  bars     <- ubars[index(ubars) >= as.Date(from)]
  assign(symbol, bars)
}

When I do:
> F

I get the data but "get" inside of applyStrategy still fails with an
error. It fails with:
Error in mktdata[, keep] : incorrect number of dimensions

I attach a sample runnable script to this e-mail.

--
Kind Regards,
Sergey Pisarenko.

On Thu, Mar 1, 2012 at 3:04 PM, Brian G. Peterson <brian at braverock.com> wrote:
> On Wed, 2012-02-29 at 23:53 -0800, rex wrote:
>> Sergey Pisarenko <drseergio at gmail.com> [2012-02-29 22:29]:
>> >
>> >The issue here is that get('F') will return FALSE because F is defined
>> >as FALSE in R. This will obviously cause a failure down the road where
>> >market data is read and manipulated.
>>
>> Hello Sergey,
>>
>> Easy fix:
>>
>> > if (F == FALSE) print('F == FALSE')
>> [1] "F == FALSE"
>> > F <- 'F'
>> > if (F == FALSE) print('F == FALSE')
>> >
>
> According to the R FAQ[1]:
> "In R, T and F are just variables being set to TRUE and FALSE,
> respectively, but are not reserved words as in S and hence can be
> overwritten by the user. (This helps e.g. when you have factors with
> levels "T" or "F".) Hence, when writing code you should always use TRUE
> and FALSE."
>
> I think you'll find that blotter, quantstrat, FinancialInstrument all
> use TRUE and FALSE correctly.
>
> If you are trying to load data for Ford, you would already have locally
> overwritten the F variable with your data for Ford.
>
>> require(quantmod, quietly=TRUE)
>> getSymbols('F')
> [1] "F"
>> head(F)
> ? ? ? ? ? F.Open F.High F.Low F.Close F.Volume F.Adjusted
> 2007-01-03 ? 7.56 ? 7.67 ?7.44 ? ?7.51 78652200 ? ? ? 7.48
> 2007-01-04 ? 7.56 ? 7.72 ?7.43 ? ?7.70 63454900 ? ? ? 7.67
> 2007-01-05 ? 7.72 ? 7.75 ?7.57 ? ?7.62 40562100 ? ? ? 7.59
> 2007-01-08 ? 7.63 ? 7.75 ?7.62 ? ?7.73 48938500 ? ? ? 7.70
> 2007-01-09 ? 7.75 ? 7.86 ?7.73 ? ?7.79 56732200 ? ? ? 7.76
> 2007-01-10 ? 7.79 ? 7.79 ?7.67 ? ?7.73 42397100 ? ? ? 7.70
>> head(get('F'))
> ? ? ? ? ? F.Open F.High F.Low F.Close F.Volume F.Adjusted
> 2007-01-03 ? 7.56 ? 7.67 ?7.44 ? ?7.51 78652200 ? ? ? 7.48
> 2007-01-04 ? 7.56 ? 7.72 ?7.43 ? ?7.70 63454900 ? ? ? 7.67
> 2007-01-05 ? 7.72 ? 7.75 ?7.57 ? ?7.62 40562100 ? ? ? 7.59
> 2007-01-08 ? 7.63 ? 7.75 ?7.62 ? ?7.73 48938500 ? ? ? 7.70
> 2007-01-09 ? 7.75 ? 7.86 ?7.73 ? ?7.79 56732200 ? ? ? 7.76
> 2007-01-10 ? 7.79 ? 7.79 ?7.67 ? ?7.73 42397100 ? ? ? 7.70
>
> so, get('F') will only return FALSE if you don't have any data loaded.
>
> That is a problem on your end, I think, and not a problem in the
> package.
>
> Regards,
>
> ? - Brian
>
> Ref:
> [1]
> http://sites.stat.psu.edu/~dhunter/R/doc/manual/R-FAQ.html#What-are-the-differences-between-R-and-S_003f
> (see section 3.3.3)
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tainted_2.R
Type: application/octet-stream
Size: 2989 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120301/fc757d2a/attachment.obj>

From drseergio at gmail.com  Thu Mar  1 18:47:11 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Thu, 1 Mar 2012 18:47:11 +0100
Subject: [R-SIG-Finance] Potential bug in quantstrat in how it handles
	"F" symbol
In-Reply-To: <CAEGu7FtrX13ZGPyPJ9+DX1qj68W-1QnGOLQnPUZHZg8-j6EfMQ@mail.gmail.com>
References: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>
	<20120301075343.GP30530@ninja.nosyntax.net>
	<1330610640.28362.56.camel@brian-rcg>
	<CAEGu7FtrX13ZGPyPJ9+DX1qj68W-1QnGOLQnPUZHZg8-j6EfMQ@mail.gmail.com>
Message-ID: <CAEGu7FvW1koSTzRUZaH553zNvjjvuhs96xzv5Us-tAJ1rhymjw@mail.gmail.com>

Hi,

Just a follow-up. When I step through applyStrategy with a debugger
and I get to the lines:

    for (symbol in symbols) {
        if (isTRUE(load.mktdata))
            mktdata <- get(symbol)


"get(symbol)" returns FALSE

"get(symbol, envir=.GlobalEnv)" returns market data for Ford.

/Sergey

On Thu, Mar 1, 2012 at 6:35 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi Brian and rex,
>
> Thank you for looking into this. This is strange because that's
> exactly what's happening. Here's how I load the data:
>
> watched ? <- c('F')
>
> symbols <- vector()
> for (symbol in watched) {
> ?ubars ? ?<- tryCatch(getSymbols(symbol, src='MySQL',
> auto.assign=FALSE), error=function(e) NULL)
> ?# skip if we don't have enough data
> ?if (is.null(ubars) || nrow(ubars) < startDay) next
> ?symbols ?<- c(symbols, symbol)
> ?bars ? ? <- ubars[index(ubars) >= as.Date(from)]
> ?assign(symbol, bars)
> }
>
> When I do:
>> F
>
> I get the data but "get" inside of applyStrategy still fails with an
> error. It fails with:
> Error in mktdata[, keep] : incorrect number of dimensions
>
> I attach a sample runnable script to this e-mail.
>
> --
> Kind Regards,
> Sergey Pisarenko.
>
> On Thu, Mar 1, 2012 at 3:04 PM, Brian G. Peterson <brian at braverock.com> wrote:
>> On Wed, 2012-02-29 at 23:53 -0800, rex wrote:
>>> Sergey Pisarenko <drseergio at gmail.com> [2012-02-29 22:29]:
>>> >
>>> >The issue here is that get('F') will return FALSE because F is defined
>>> >as FALSE in R. This will obviously cause a failure down the road where
>>> >market data is read and manipulated.
>>>
>>> Hello Sergey,
>>>
>>> Easy fix:
>>>
>>> > if (F == FALSE) print('F == FALSE')
>>> [1] "F == FALSE"
>>> > F <- 'F'
>>> > if (F == FALSE) print('F == FALSE')
>>> >
>>
>> According to the R FAQ[1]:
>> "In R, T and F are just variables being set to TRUE and FALSE,
>> respectively, but are not reserved words as in S and hence can be
>> overwritten by the user. (This helps e.g. when you have factors with
>> levels "T" or "F".) Hence, when writing code you should always use TRUE
>> and FALSE."
>>
>> I think you'll find that blotter, quantstrat, FinancialInstrument all
>> use TRUE and FALSE correctly.
>>
>> If you are trying to load data for Ford, you would already have locally
>> overwritten the F variable with your data for Ford.
>>
>>> require(quantmod, quietly=TRUE)
>>> getSymbols('F')
>> [1] "F"
>>> head(F)
>> ? ? ? ? ? F.Open F.High F.Low F.Close F.Volume F.Adjusted
>> 2007-01-03 ? 7.56 ? 7.67 ?7.44 ? ?7.51 78652200 ? ? ? 7.48
>> 2007-01-04 ? 7.56 ? 7.72 ?7.43 ? ?7.70 63454900 ? ? ? 7.67
>> 2007-01-05 ? 7.72 ? 7.75 ?7.57 ? ?7.62 40562100 ? ? ? 7.59
>> 2007-01-08 ? 7.63 ? 7.75 ?7.62 ? ?7.73 48938500 ? ? ? 7.70
>> 2007-01-09 ? 7.75 ? 7.86 ?7.73 ? ?7.79 56732200 ? ? ? 7.76
>> 2007-01-10 ? 7.79 ? 7.79 ?7.67 ? ?7.73 42397100 ? ? ? 7.70
>>> head(get('F'))
>> ? ? ? ? ? F.Open F.High F.Low F.Close F.Volume F.Adjusted
>> 2007-01-03 ? 7.56 ? 7.67 ?7.44 ? ?7.51 78652200 ? ? ? 7.48
>> 2007-01-04 ? 7.56 ? 7.72 ?7.43 ? ?7.70 63454900 ? ? ? 7.67
>> 2007-01-05 ? 7.72 ? 7.75 ?7.57 ? ?7.62 40562100 ? ? ? 7.59
>> 2007-01-08 ? 7.63 ? 7.75 ?7.62 ? ?7.73 48938500 ? ? ? 7.70
>> 2007-01-09 ? 7.75 ? 7.86 ?7.73 ? ?7.79 56732200 ? ? ? 7.76
>> 2007-01-10 ? 7.79 ? 7.79 ?7.67 ? ?7.73 42397100 ? ? ? 7.70
>>
>> so, get('F') will only return FALSE if you don't have any data loaded.
>>
>> That is a problem on your end, I think, and not a problem in the
>> package.
>>
>> Regards,
>>
>> ? - Brian
>>
>> Ref:
>> [1]
>> http://sites.stat.psu.edu/~dhunter/R/doc/manual/R-FAQ.html#What-are-the-differences-between-R-and-S_003f
>> (see section 3.3.3)
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.


From drseergio at gmail.com  Thu Mar  1 20:10:58 2012
From: drseergio at gmail.com (Sergey Pisarenko)
Date: Thu, 1 Mar 2012 20:10:58 +0100
Subject: [R-SIG-Finance] Potential bug in quantstrat in how it handles
	"F" symbol
In-Reply-To: <CAEGu7FvW1koSTzRUZaH553zNvjjvuhs96xzv5Us-tAJ1rhymjw@mail.gmail.com>
References: <CAEGu7FvoUN1gsr+DU1zt5bWNeQ5Ojxpp7zmiQKSGH9Aw=hNwjw@mail.gmail.com>
	<20120301075343.GP30530@ninja.nosyntax.net>
	<1330610640.28362.56.camel@brian-rcg>
	<CAEGu7FtrX13ZGPyPJ9+DX1qj68W-1QnGOLQnPUZHZg8-j6EfMQ@mail.gmail.com>
	<CAEGu7FvW1koSTzRUZaH553zNvjjvuhs96xzv5Us-tAJ1rhymjw@mail.gmail.com>
Message-ID: <CAEGu7FvwaNvKAYS-WPdq-xybS_vVrBb0PZFUzyX_iB9_bud-1g@mail.gmail.com>

Hi,

I have modified quantstrat to use ".GlobalEnv" and it works fine so
far. Not sure if this is something that should be considered to be
changed permanently.

/Sergey

On Thu, Mar 1, 2012 at 6:47 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
> Hi,
>
> Just a follow-up. When I step through applyStrategy with a debugger
> and I get to the lines:
>
> ? ?for (symbol in symbols) {
> ? ? ? ?if (isTRUE(load.mktdata))
> ? ? ? ? ? ?mktdata <- get(symbol)
>
>
> "get(symbol)" returns FALSE
>
> "get(symbol, envir=.GlobalEnv)" returns market data for Ford.
>
> /Sergey
>
> On Thu, Mar 1, 2012 at 6:35 PM, Sergey Pisarenko <drseergio at gmail.com> wrote:
>> Hi Brian and rex,
>>
>> Thank you for looking into this. This is strange because that's
>> exactly what's happening. Here's how I load the data:
>>
>> watched ? <- c('F')
>>
>> symbols <- vector()
>> for (symbol in watched) {
>> ?ubars ? ?<- tryCatch(getSymbols(symbol, src='MySQL',
>> auto.assign=FALSE), error=function(e) NULL)
>> ?# skip if we don't have enough data
>> ?if (is.null(ubars) || nrow(ubars) < startDay) next
>> ?symbols ?<- c(symbols, symbol)
>> ?bars ? ? <- ubars[index(ubars) >= as.Date(from)]
>> ?assign(symbol, bars)
>> }
>>
>> When I do:
>>> F
>>
>> I get the data but "get" inside of applyStrategy still fails with an
>> error. It fails with:
>> Error in mktdata[, keep] : incorrect number of dimensions
>>
>> I attach a sample runnable script to this e-mail.
>>
>> --
>> Kind Regards,
>> Sergey Pisarenko.
>>
>> On Thu, Mar 1, 2012 at 3:04 PM, Brian G. Peterson <brian at braverock.com> wrote:
>>> On Wed, 2012-02-29 at 23:53 -0800, rex wrote:
>>>> Sergey Pisarenko <drseergio at gmail.com> [2012-02-29 22:29]:
>>>> >
>>>> >The issue here is that get('F') will return FALSE because F is defined
>>>> >as FALSE in R. This will obviously cause a failure down the road where
>>>> >market data is read and manipulated.
>>>>
>>>> Hello Sergey,
>>>>
>>>> Easy fix:
>>>>
>>>> > if (F == FALSE) print('F == FALSE')
>>>> [1] "F == FALSE"
>>>> > F <- 'F'
>>>> > if (F == FALSE) print('F == FALSE')
>>>> >
>>>
>>> According to the R FAQ[1]:
>>> "In R, T and F are just variables being set to TRUE and FALSE,
>>> respectively, but are not reserved words as in S and hence can be
>>> overwritten by the user. (This helps e.g. when you have factors with
>>> levels "T" or "F".) Hence, when writing code you should always use TRUE
>>> and FALSE."
>>>
>>> I think you'll find that blotter, quantstrat, FinancialInstrument all
>>> use TRUE and FALSE correctly.
>>>
>>> If you are trying to load data for Ford, you would already have locally
>>> overwritten the F variable with your data for Ford.
>>>
>>>> require(quantmod, quietly=TRUE)
>>>> getSymbols('F')
>>> [1] "F"
>>>> head(F)
>>> ? ? ? ? ? F.Open F.High F.Low F.Close F.Volume F.Adjusted
>>> 2007-01-03 ? 7.56 ? 7.67 ?7.44 ? ?7.51 78652200 ? ? ? 7.48
>>> 2007-01-04 ? 7.56 ? 7.72 ?7.43 ? ?7.70 63454900 ? ? ? 7.67
>>> 2007-01-05 ? 7.72 ? 7.75 ?7.57 ? ?7.62 40562100 ? ? ? 7.59
>>> 2007-01-08 ? 7.63 ? 7.75 ?7.62 ? ?7.73 48938500 ? ? ? 7.70
>>> 2007-01-09 ? 7.75 ? 7.86 ?7.73 ? ?7.79 56732200 ? ? ? 7.76
>>> 2007-01-10 ? 7.79 ? 7.79 ?7.67 ? ?7.73 42397100 ? ? ? 7.70
>>>> head(get('F'))
>>> ? ? ? ? ? F.Open F.High F.Low F.Close F.Volume F.Adjusted
>>> 2007-01-03 ? 7.56 ? 7.67 ?7.44 ? ?7.51 78652200 ? ? ? 7.48
>>> 2007-01-04 ? 7.56 ? 7.72 ?7.43 ? ?7.70 63454900 ? ? ? 7.67
>>> 2007-01-05 ? 7.72 ? 7.75 ?7.57 ? ?7.62 40562100 ? ? ? 7.59
>>> 2007-01-08 ? 7.63 ? 7.75 ?7.62 ? ?7.73 48938500 ? ? ? 7.70
>>> 2007-01-09 ? 7.75 ? 7.86 ?7.73 ? ?7.79 56732200 ? ? ? 7.76
>>> 2007-01-10 ? 7.79 ? 7.79 ?7.67 ? ?7.73 42397100 ? ? ? 7.70
>>>
>>> so, get('F') will only return FALSE if you don't have any data loaded.
>>>
>>> That is a problem on your end, I think, and not a problem in the
>>> package.
>>>
>>> Regards,
>>>
>>> ? - Brian
>>>
>>> Ref:
>>> [1]
>>> http://sites.stat.psu.edu/~dhunter/R/doc/manual/R-FAQ.html#What-are-the-differences-between-R-and-S_003f
>>> (see section 3.3.3)
>>>
>>> --
>>> Brian G. Peterson
>>> http://braverock.com/brian/
>>> Ph: 773-459-4973
>>> IM: bgpbraverock
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.


From me at censix.com  Thu Mar  1 21:26:14 2012
From: me at censix.com (me)
Date: Thu, 1 Mar 2012 21:26:14 +0100
Subject: [R-SIG-Finance] Update price data on disk using mmap package
In-Reply-To: <4F4DF6BA.7070904@gmail.com>
References: <4F4DF6BA.7070904@gmail.com>
Message-ID: <20120301212614.58d3598f@desktop1>

Hi

if you  set

mmapPrices <- mmap(file=cFile, mode=double());

then mmapPrices is a ONE dimeansional array of double()'s. I think it
is easier to do the following, assuming you are working with a
univariate xts object. Define:

mmapPrices <- mmap(file=cFile,
struct(timestamp=double(),price=double()) )

Now assume that you have initialized mmapPrices with NA's, like this:

mmapPrices[,1] <-NA
mmapPrices[,2] <-NA

Now you can append a new xts row 'newbar' like so:

newbar <- xts(12.3, order.by=sometimestamp)

find the first free (timestamp==NA) row in mmapPrices

idxcol<-mmapPrices[,1]
iifree<-match(NA, idxcol[[1]] )

fill it with the data from newbar

mmapPrices[iifree,1] <- .index(newbar)
mmapPrices[iifree,2] <- coredata(newbar)[1,1]


This has been working fine for me.

Cheers

Soren

censix.com



On Wed, 29 Feb 2012 09:58:18 +0000
Wolfgang Wu <wobwu22 at gmail.com> wrote:

> Hello everyone,
> 
> I am currently storing my price data for fast access as a mmap file
> on disk. This works great and is super fast. All data is in one big
> file which I subset to get the data I need into memory.
> 
> Now I will need to update that data that is stored on disk on a daily 
> basis to store new data. The solution I currently have is to load all 
> data into memory, append the new data to the data in memory and then 
> store everything again as mmap on disk. Unfortunately I am running
> into memory problems now when loading all of the data into memory.
> 
> So my question is:  Is it possible to append new prices directly into
> my file on disk without loading everything into memory? And if, how?
> 
> Any help is appreciated!!
> 
> 
> Here is an example of what I am trying to do:
> 
> library(quantmod)
> library(mmap)
> 
> #Just for setting up the example
> getSymbols('SPY')
> xtsPrices <- SPY[1:(nrow(SPY)-1), ];
> xtsNewPrice <- last(SPY);
> 
> #Save prices in mmap on disk
> cFile <- 'C:/temp/PriceData.mmap'
> nPrices <- as.numeric(xtsPrices);
> mmapPrices <- as.mmap(nPrices, mode=double(), file=cFile);
> munmap(mmapPrices);
> 
> #Now I would like to append the new prices directly to the mmap
> object on disk
> mmapPrices <- mmap(file=cFile, mode=double());
> nNewPrice <- as.numeric(xtsNewPrice);
> mmapPrices <- c(mmapPrices, nNewPrice); #This line does not work how
> I hoped it would.
> 
> 
> 
> 
> Regards,
> 
> Wolfgang
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R
> questions should go.


From fabercastellsince1761 at gmail.com  Fri Mar  2 14:03:43 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Fri, 2 Mar 2012 14:03:43 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKTAHi7Aya4fqK8jn9X0KX1dibvq9mCXzDJEreOYhVhYXQ@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
	<1326909498.24988.129.camel@brian-rcg>
	<CACBLjKQvapXCdMHpVwp18Lv1z5SrBPf8O_qBfiCBz4RU-Mnp5w@mail.gmail.com>
	<CACBLjKSoYih7oDwCjnVgoXh3PyL54gMESvX-r7PavTNbSjL3zg@mail.gmail.com>
	<1327012687.24988.146.camel@brian-rcg>
	<CACBLjKQSqF7zaNhPZ0skEn_RtN-o1LohXacNMMpFS6GsBvUr+g@mail.gmail.com>
	<1330105550.8901.224.camel@brian-rcg>
	<CACBLjKSM+L1YUv+05sE_U0gNWdOb7XFQjwv9t-unVzrncVB0zA@mail.gmail.com>
	<1330367313.8901.245.camel@brian-rcg>
	<CACBLjKTAHi7Aya4fqK8jn9X0KX1dibvq9mCXzDJEreOYhVhYXQ@mail.gmail.com>
Message-ID: <CACBLjKRmykKr13YM=H6gALm1TUmmOT6B4on4wR2=eByKxaMyww@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120302/c8e4edaa/attachment.pl>

From azege at yahoo.com  Fri Mar  2 20:20:11 2012
From: azege at yahoo.com (Andre Zege)
Date: Fri, 2 Mar 2012 11:20:11 -0800 (PST)
Subject: [R-SIG-Finance] using getQuote with subscription to yahoo real-time
	data?
Message-ID: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120302/f9f6becd/attachment.pl>

From josh.m.ulrich at gmail.com  Fri Mar  2 20:23:32 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 2 Mar 2012 13:23:32 -0600
Subject: [R-SIG-Finance] using getQuote with subscription to yahoo
 real-time data?
In-Reply-To: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
Message-ID: <CAPPM_gSskj4t1QwA-_MzBY0NV3+RwLs2_PwsNgEroZiVDVkNDg@mail.gmail.com>

On Fri, Mar 2, 2012 at 1:20 PM, Andre Zege <azege at yahoo.com> wrote:
> Hi, i suppose things similar to my question were discussed before. I understand how to run getQuote in quantmod to get delayed real-time yahoo data.
>
>
> Is there a way to point getQuote to non-delayed real-time data once i have paid real-time account with yahoo? I tried to look at the package code but it doesn't seem to come with the source code either in R or C, so I cannot see if it is possible to simply hack it. Would appreciate some comment here.
>
You can easily find the source code for any package on its CRAN page:
http://cran.r-project.org/web/packages/quantmod/index.html

> Regards
> Andre Zege
>

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com


From brian at braverock.com  Fri Mar  2 20:25:36 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 02 Mar 2012 13:25:36 -0600
Subject: [R-SIG-Finance] using getQuote with subscription to yahoo
 real-time data?
In-Reply-To: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
Message-ID: <1330716336.28362.125.camel@brian-rcg>

On Fri, 2012-03-02 at 11:20 -0800, Andre Zege wrote:
> Hi, i suppose things similar to my question were discussed before. I
> understand how to run getQuote in quantmod to get delayed real-time
> yahoo data. 
> 
> 
> Is there a way to point getQuote to non-delayed real-time data once i
> have paid real-time account with yahoo? I tried to look at the package
> code but it doesn't seem to come with the source code either in R or
> C, so I cannot see if it is possible to simply hack it. Would
> appreciate some comment here.

Andre, 

All R packages come with source code in the .tar.gz format.

That aside, the code for quantmod is all on R-Forge here:

https://r-forge.r-project.org/scm/viewvc.php/?root=quantmod
> 
> 
-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From azege at yahoo.com  Fri Mar  2 21:01:05 2012
From: azege at yahoo.com (Andre Zege)
Date: Fri, 2 Mar 2012 12:01:05 -0800 (PST)
Subject: [R-SIG-Finance] using getQuote with subscription to yahoo
	real-time data?
In-Reply-To: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
Message-ID: <1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120302/70a6d7e9/attachment.pl>

From michael.weylandt at gmail.com  Fri Mar  2 21:19:04 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt <michael.weylandt@gmail.com>)
Date: Fri, 2 Mar 2012 15:19:04 -0500
Subject: [R-SIG-Finance] using getQuote with subscription to yahoo
	real-time data?
In-Reply-To: <1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
Message-ID: <55073595-ACE7-44A4-8779-DED3454571AE@gmail.com>

You can write your own getQuote "method" and use the Defaults package to change from src="yahoo" to "yahoopaid" or whatever you decide to call it. I don't have a paid subscription so I can't really help with writing it. 

Michael

On Mar 2, 2012, at 3:01 PM, Andre Zege <azege at yahoo.com> wrote:

> Sorry, my bad. I was looking for sources in package installation directory, used to finding them there. In any case, what's your take on my main question. It doesn't seem easy to me to hack getQuote.yahoo to get real-time. It seems it just loads a csv file. Does anyone know if there is maybe a similar page for non-delayed real-time or it all involves reading and writing to sockets? I don't care about a couple of seconds of latency, i just don't want to have 15 minutes latency and using getQuote would be uber nice.
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jeffrey.ryan at lemnica.com  Fri Mar  2 21:23:15 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 2 Mar 2012 14:23:15 -0600
Subject: [R-SIG-Finance] using getQuote with subscription to yahoo
 real-time data?
In-Reply-To: <1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
Message-ID: <CABDUZc8zyZKa0rcc1agkDSodqhFwgrFwk244E2pgem0bn_dZvQ@mail.gmail.com>

Yahoo and other free providers don't typically offer http request
style 'real time' per se.

The interface that Yahoo exposes is only available on Windows, so it
won't ever be supported in quantmod by default.

If your purpose is to automate the requests, and have it effectively
'poll', then it wouldn't be that difficult to screen scrape some other
source.  Something less painful than HTTP would be best though,
websockets or BOSH/XMPP come to mind, but that would have to map to
the protocol the server side offers.

Lots of options, but not are rolled for you unless you have an account
with Interactive Brokers (IBrokers) or Bloomberg (RBloomberg)

Best,
Jeff

On Fri, Mar 2, 2012 at 2:01 PM, Andre Zege <azege at yahoo.com> wrote:
> Sorry, my bad. I was looking for sources in package installation directory, used to finding them there. In any case, what's your take on my main question. It doesn't seem easy to me to hack getQuote.yahoo to get real-time. It seems it just loads a csv file. Does anyone know if there is maybe a similar page for non-delayed real-time or it all involves reading and writing to sockets? I don't care about a couple of seconds of latency, i just don't want to have 15 minutes latency and using getQuote would be uber nice.
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From amitmisra1960 at gmail.com  Sat Mar  3 18:20:17 2012
From: amitmisra1960 at gmail.com (Amit Mishra)
Date: Sat, 3 Mar 2012 11:20:17 -0600
Subject: [R-SIG-Finance] Question reg rbloomberg
Message-ID: <CAAhDd_q7Sf1MLm=SDzjHb2HZB1LuG6f+jbcnZi0kVsYaH3Kimw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120303/b341ebd2/attachment.pl>

From stergios_marinopoulos at yahoo.com  Sun Mar  4 07:06:29 2012
From: stergios_marinopoulos at yahoo.com (Stergios Marinopoulos)
Date: Sat, 3 Mar 2012 22:06:29 -0800 (PST)
Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
Message-ID: <1330841189.80225.YahooMailNeo@web30807.mail.mud.yahoo.com>

I having trouble getting getSymbols() to work with a CSV file.? I am not sure
if this is a bug report, or my lack of understanding on how to pass the format
argument to getSymbols.csv().? Please read on.

I am running R-2.14.1 on WinXp, xts 0.8-2 and zoo 1.7-6

I noticed the docs mentioned this not being tested on windows, so I went ahead
dug into the problem a little bit.

getSymbols() reads the file in, but the dates for every row are all set to
todays date.? Now the data I am working with is from 1999, so that's the heart
of the problem; why is the date getting lost? 

Here is a log of my work, mostly reproduceable:

# Data as found in file EURUSD.csv: (see attached for full file)
#
# Date,Open,High,Low,Close,Volume,Adjusted
# 1999-01-04,1.174,1.189,1.174,1.177,1,0
# 1999-01-05,1.183,1.183,1.175,1.177,1,0
#? .... rows snipped
# 1999-01-28,1.1441,1.1468,1.1383,1.1412,1,0
# 1999-01-29,1.1413,1.143,1.1343,1.1357,1,0

library(quantmod) ;
setwd("C:/storage") ; # set as necessary
getSymbols("EURUSD", src='csv') ;


# How did the dates get mangled???
tail(EURUSD) 

?????????? EURUSD.Open EURUSD.High EURUSD.Low EURUSD.Close EURUSD.Volume EURUSD.Adjusted
2012-03-03????? 1.1593????? 1.1625???? 1.1562?????? 1.1585???????????? 1?????????????? 0
2012-03-03????? 1.1585????? 1.1609???? 1.1549?????? 1.1549???????????? 1?????????????? 0
2012-03-03????? 1.1551????? 1.1588???? 1.1551?????? 1.1560???????????? 1?????????????? 0
2012-03-03????? 1.1561????? 1.1561???? 1.1411?????? 1.1423???????????? 1?????????????? 0
2012-03-03????? 1.1441????? 1.1468???? 1.1383?????? 1.1412???????????? 1?????????????? 0
2012-03-03????? 1.1413????? 1.1430???? 1.1343?????? 1.1357???????????? 1?????????????? 0




So I dug into getSymbols.csv() a little bit and managed to get the data file
loaded fine by parroting the guts of getSymbols.csv() as follows:



############################################################
## THIS WORKS
library(quantmod) ;
setwd("C:/storage") ; # set as necessary
EURUSD <-read.csv("C:/storage/EURUSD.csv") ;


EURUSD <- xts(EURUSD[, -1], as.Date(EURUSD[, 1]) , src = "csv", updated = Sys.time())


colnames(EURUSD) <- paste(toupper(gsub("\\^", "", "EURUSD"? )), 
??????????? c("Open", "High", "Low", "Close", "Volume", "Adjusted"), 
??????????? sep = ".")

> tail(EURUSD)
?????????? EURUSD.Open EURUSD.High EURUSD.Low EURUSD.Close EURUSD.Volume EURUSD.Adjusted
1999-01-22????? 1.1593????? 1.1625???? 1.1562?????? 1.1585???????????? 1?????????????? 0
1999-01-25????? 1.1585????? 1.1609???? 1.1549?????? 1.1549???????????? 1?????????????? 0
1999-01-26????? 1.1551????? 1.1588???? 1.1551?????? 1.1560???????????? 1?????????????? 0
1999-01-27????? 1.1561????? 1.1561???? 1.1411?????? 1.1423???????????? 1?????????????? 0
1999-01-28????? 1.1441????? 1.1468???? 1.1383?????? 1.1412???????????? 1?????????????? 0
1999-01-29????? 1.1413????? 1.1430???? 1.1343?????? 1.1357???????????? 1?????????????? 0

Now EURUSD looks as expected.

############################################################


One difference from my parroted code and that found in getSymbols.csv() is I did
not use the format argument when constructing the xts object from the data.frame.

getSymbols.csv() uses this code:

fr <- xts(fr[, -1], as.Date(fr[, 1], format = format, 
??? ..., origin = "1970-01-01"), src = "csv", updated = Sys.time())


while I did this:

EURUSD <- xts(EURUSD[, -1], as.Date(EURUSD[, 1]) , src = "csv", updated = Sys.time())

?From what I could follow in the getSymbols.csv() code the format is getting
set to the empty string ""

Now if I plug in an empty format to my code as follows I get the same screwy munging of the dates:

EURUSD <- xts(EURUSD[, -1], as.Date(EURUSD[, 1], format = "", 
??????????? , origin = "1970-01-01"), src = "csv", updated = Sys.time())


> tail(EURUSD)
???????????? Open?? High??? Low? Close Volume Adjusted
2012-03-03 1.1593 1.1625 1.1562 1.1585????? 1??????? 0
2012-03-03 1.1585 1.1609 1.1549 1.1549????? 1??????? 0
2012-03-03 1.1551 1.1588 1.1551 1.1560????? 1??????? 0
2012-03-03 1.1561 1.1561 1.1411 1.1423????? 1??????? 0
2012-03-03 1.1441 1.1468 1.1383 1.1412????? 1??????? 0
2012-03-03 1.1413 1.1430 1.1343 1.1357????? 1??????? 0

Ah, ha! Seems like format is the key.

And if I use a proper format (or no format at all) to the xts call it seems to
work as expected:

EURUSD <- xts(EURUSD[, -1], as.Date(EURUSD[, 1], format = "%Y-%m-%d", 
??????????? , origin = "1970-01-01"), src = "csv", updated = Sys.time())

> tail(EURUSD)
???????????? Open?? High??? Low? Close Volume Adjusted
1999-01-22 1.1593 1.1625 1.1562 1.1585????? 1??????? 0
1999-01-25 1.1585 1.1609 1.1549 1.1549????? 1??????? 0
1999-01-26 1.1551 1.1588 1.1551 1.1560????? 1??????? 0
1999-01-27 1.1561 1.1561 1.1411 1.1423????? 1??????? 0
1999-01-28 1.1441 1.1468 1.1383 1.1412????? 1??????? 0
1999-01-29 1.1413 1.1430 1.1343 1.1357????? 1??????? 0


That looks good.

One last note.?? I tried adding the format argument to getSymbols() thinking it would get passed along to getSymbols.csv() but the following error message was produced:

getSymbols("EURUSD", src='csv', format = "%Y-%m-%d" ) ;

Error in list(...)[["format"]] <- NULL : 
? '...' used in an incorrect context


?
Any guidance offered would be greatly appreciated.


--
Stergios Marinopoulos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120303/2d33d959/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: EURUSD.csv
Type: application/octet-stream
Size: 941 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120303/2d33d959/attachment.obj>

From matt at considine.net  Mon Mar  5 17:07:26 2012
From: matt at considine.net (Matt Considine)
Date: Mon, 05 Mar 2012 11:07:26 -0500
Subject: [R-SIG-Finance] RollingStyle in PApages?
Message-ID: <4F54E4BE.504@considine.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120305/41d24dd7/attachment.pl>

From clhis_alberty at yahoo.com.br  Mon Mar  5 18:15:39 2012
From: clhis_alberty at yahoo.com.br (Clhis Alberty)
Date: Mon, 5 Mar 2012 09:15:39 -0800 (PST)
Subject: [R-SIG-Finance] :  using yahooSeries fo dowload Historical data?
In-Reply-To: <CABDUZc8zyZKa0rcc1agkDSodqhFwgrFwk244E2pgem0bn_dZvQ@mail.gmail.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<CABDUZc8zyZKa0rcc1agkDSodqhFwgrFwk244E2pgem0bn_dZvQ@mail.gmail.com>
Message-ID: <1330967739.8754.YahooMailNeo@web120706.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120305/7e057c9c/attachment.pl>

From clhis_alberty at yahoo.com.br  Mon Mar  5 18:59:22 2012
From: clhis_alberty at yahoo.com.br (Clhis Alberty)
Date: Mon, 5 Mar 2012 09:59:22 -0800 (PST)
Subject: [R-SIG-Finance] : using yahooSeries fo dowload Historical data?
In-Reply-To: <1330967739.8754.YahooMailNeo@web120706.mail.ne1.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<CABDUZc8zyZKa0rcc1agkDSodqhFwgrFwk244E2pgem0bn_dZvQ@mail.gmail.com>
	<1330967739.8754.YahooMailNeo@web120706.mail.ne1.yahoo.com>
Message-ID: <1330970362.90905.YahooMailNeo@web120704.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120305/6e1a25f0/attachment.pl>

From clhis_alberty at yahoo.com.br  Mon Mar  5 18:59:22 2012
From: clhis_alberty at yahoo.com.br (Clhis Alberty)
Date: Mon, 5 Mar 2012 09:59:22 -0800 (PST)
Subject: [R-SIG-Finance] : using yahooSeries fo dowload Historical data?
In-Reply-To: <1330967739.8754.YahooMailNeo@web120706.mail.ne1.yahoo.com>
References: <1330716011.16718.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<1330718465.81487.YahooMailNeo@web39306.mail.mud.yahoo.com>
	<CABDUZc8zyZKa0rcc1agkDSodqhFwgrFwk244E2pgem0bn_dZvQ@mail.gmail.com>
	<1330967739.8754.YahooMailNeo@web120706.mail.ne1.yahoo.com>
Message-ID: <1330970362.90905.YahooMailNeo@web120704.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120305/6e1a25f0/attachment-0001.pl>

From harrisonmark1 at gmail.com  Mon Mar  5 20:36:15 2012
From: harrisonmark1 at gmail.com (Mark Harrison)
Date: Mon, 5 Mar 2012 13:36:15 -0600
Subject: [R-SIG-Finance] Quantmod SMA not working
Message-ID: <CAHFhaq-Pj=__mrdjEVdFstAmx=w_f4PJLu1gitKCELcNZF4bow@mail.gmail.com>

I am trying to do some data comparisons and want to use quantmod and
the addSMA feature.  However, I keep getting errors when I try the
addSMA command.  I did try the email but nothing I saw answered or
fixed this issue.

When I run addSMA(20) on my data - examples below - I get the following error:

Error in matrix(ma.tmp[lchob at xsubset, ], nc = NCOL(ma.tmp)) :
  subscript out of bounds

If I just grab Apple data from Yahoo and run:

chartSeries(AAPL, subset='last 6 months')
addSMA(20)

The first command works and the chart appears but the addSMA command
gives me the same error as above.

MyData Example:
             Open   High    Low  Close
2010-12-31 63.270 63.535 63.120 63.425
2011-01-03 63.310 63.670 63.085 63.620
2011-01-04 63.615 64.040 63.365 63.740
2011-01-05 63.770 64.495 63.430 64.415
2011-01-06 64.405 64.530 64.070 64.340
2011-01-07 64.325 64.490 63.950 64.280

Session Info:

R version 2.14.0 (2011-10-31)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] datasets  grDevices utils     graphics  stats     methods   base

other attached packages:
 [1] blotter_0.8.4              fTrading_2110.77
fBasics_2110.79
 [4] MASS_7.3-16                timeSeries_2140.93
timeDate_2150.95
 [7] twsInstrument_1.3-1        IBrokers_0.9-3             qmao_1.1.6
[10] FinancialInstrument_0.10.9 quantmod_0.3-17            TTR_0.21-0
[13] xts_0.8-4                  zoo_1.7-7
Defaults_1.1-1

loaded via a namespace (and not attached):
[1] grid_2.14.0      lattice_0.20-3   quantstrat_0.6.1 tools_2.14.0


From jeffrey.ryan at lemnica.com  Mon Mar  5 20:47:16 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 5 Mar 2012 13:47:16 -0600
Subject: [R-SIG-Finance] Quantmod SMA not working
In-Reply-To: <CAHFhaq-Pj=__mrdjEVdFstAmx=w_f4PJLu1gitKCELcNZF4bow@mail.gmail.com>
References: <CAHFhaq-Pj=__mrdjEVdFstAmx=w_f4PJLu1gitKCELcNZF4bow@mail.gmail.com>
Message-ID: <CABDUZc8Kt6GWi3cxYBnFet5ib8CyuUZ=9YjUoTpmyzWC0jgO2w@mail.gmail.com>

The problem is that fTrading also has an SMA function.  You can either
load it before loading quantmod/TTR or ... not use it??

Note the conflict when you call library(fTrading) _after_ you load quantmod/TTR

Is there a function in fTrading that you need that isn't in TTR

Jeff

On Mon, Mar 5, 2012 at 1:36 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
> I am trying to do some data comparisons and want to use quantmod and
> the addSMA feature. ?However, I keep getting errors when I try the
> addSMA command. ?I did try the email but nothing I saw answered or
> fixed this issue.
>
> When I run addSMA(20) on my data - examples below - I get the following error:
>
> Error in matrix(ma.tmp[lchob at xsubset, ], nc = NCOL(ma.tmp)) :
> ?subscript out of bounds
>
> If I just grab Apple data from Yahoo and run:
>
> chartSeries(AAPL, subset='last 6 months')
> addSMA(20)
>
> The first command works and the chart appears but the addSMA command
> gives me the same error as above.
>
> MyData Example:
> ? ? ? ? ? ? Open ? High ? ?Low ?Close
> 2010-12-31 63.270 63.535 63.120 63.425
> 2011-01-03 63.310 63.670 63.085 63.620
> 2011-01-04 63.615 64.040 63.365 63.740
> 2011-01-05 63.770 64.495 63.430 64.415
> 2011-01-06 64.405 64.530 64.070 64.340
> 2011-01-07 64.325 64.490 63.950 64.280
>
> Session Info:
>
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] datasets ?grDevices utils ? ? graphics ?stats ? ? methods ? base
>
> other attached packages:
> ?[1] blotter_0.8.4 ? ? ? ? ? ? ?fTrading_2110.77
> fBasics_2110.79
> ?[4] MASS_7.3-16 ? ? ? ? ? ? ? ?timeSeries_2140.93
> timeDate_2150.95
> ?[7] twsInstrument_1.3-1 ? ? ? ?IBrokers_0.9-3 ? ? ? ? ? ? qmao_1.1.6
> [10] FinancialInstrument_0.10.9 quantmod_0.3-17 ? ? ? ? ? ?TTR_0.21-0
> [13] xts_0.8-4 ? ? ? ? ? ? ? ? ?zoo_1.7-7
> Defaults_1.1-1
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.0 ? ? ?lattice_0.20-3 ? quantstrat_0.6.1 tools_2.14.0
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From harrisonmark1 at gmail.com  Mon Mar  5 21:29:58 2012
From: harrisonmark1 at gmail.com (Mark Harrison)
Date: Mon, 5 Mar 2012 14:29:58 -0600
Subject: [R-SIG-Finance] Quantmod SMA not working
In-Reply-To: <CABDUZc8Kt6GWi3cxYBnFet5ib8CyuUZ=9YjUoTpmyzWC0jgO2w@mail.gmail.com>
References: <CAHFhaq-Pj=__mrdjEVdFstAmx=w_f4PJLu1gitKCELcNZF4bow@mail.gmail.com>
	<CABDUZc8Kt6GWi3cxYBnFet5ib8CyuUZ=9YjUoTpmyzWC0jgO2w@mail.gmail.com>
Message-ID: <CAHFhaq8ve+fdvLcxjGrvGSbKFrxZ4mMr6EqpBhgFp=1RmGSVWQ@mail.gmail.com>

I will try switching the load order...

I have been using the EMA from fTrading because I can assign where the
values start and I do not get 'NAs'.  I was trying to recreate an EMA
formula that I had been using in excel.  It always did what I needed
so I just stuck with it.

I added two columns using the fTrading EMA and TTR EMA labled for the
package so you can see the difference.  Probably too much
information....

                   Open    High     Low   Close   fTrading TTR
2010-12-31 63.270 63.535 63.120 63.425 63.42500  NA
2011-01-03 63.310 63.670 63.085 63.620 63.44357  NA
2011-01-04 63.615 64.040 63.365 63.740 63.47180  NA
2011-01-05 63.770 64.495 63.430 64.415 63.56163  NA
2011-01-06 64.405 64.530 64.070 64.340 63.63576  NA
2011-01-07 64.325 64.490 63.950 64.280 63.69712  NA

On Mon, Mar 5, 2012 at 1:47 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
> The problem is that fTrading also has an SMA function. ?You can either
> load it before loading quantmod/TTR or ... not use it??
>
> Note the conflict when you call library(fTrading) _after_ you load quantmod/TTR
>
> Is there a function in fTrading that you need that isn't in TTR
>
> Jeff
>
> On Mon, Mar 5, 2012 at 1:36 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
>> I am trying to do some data comparisons and want to use quantmod and
>> the addSMA feature. ?However, I keep getting errors when I try the
>> addSMA command. ?I did try the email but nothing I saw answered or
>> fixed this issue.
>>
>> When I run addSMA(20) on my data - examples below - I get the following error:
>>
>> Error in matrix(ma.tmp[lchob at xsubset, ], nc = NCOL(ma.tmp)) :
>> ?subscript out of bounds
>>
>> If I just grab Apple data from Yahoo and run:
>>
>> chartSeries(AAPL, subset='last 6 months')
>> addSMA(20)
>>
>> The first command works and the chart appears but the addSMA command
>> gives me the same error as above.
>>
>> MyData Example:
>> ? ? ? ? ? ? Open ? High ? ?Low ?Close
>> 2010-12-31 63.270 63.535 63.120 63.425
>> 2011-01-03 63.310 63.670 63.085 63.620
>> 2011-01-04 63.615 64.040 63.365 63.740
>> 2011-01-05 63.770 64.495 63.430 64.415
>> 2011-01-06 64.405 64.530 64.070 64.340
>> 2011-01-07 64.325 64.490 63.950 64.280
>>
>> Session Info:
>>
>> R version 2.14.0 (2011-10-31)
>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] datasets ?grDevices utils ? ? graphics ?stats ? ? methods ? base
>>
>> other attached packages:
>> ?[1] blotter_0.8.4 ? ? ? ? ? ? ?fTrading_2110.77
>> fBasics_2110.79
>> ?[4] MASS_7.3-16 ? ? ? ? ? ? ? ?timeSeries_2140.93
>> timeDate_2150.95
>> ?[7] twsInstrument_1.3-1 ? ? ? ?IBrokers_0.9-3 ? ? ? ? ? ? qmao_1.1.6
>> [10] FinancialInstrument_0.10.9 quantmod_0.3-17 ? ? ? ? ? ?TTR_0.21-0
>> [13] xts_0.8-4 ? ? ? ? ? ? ? ? ?zoo_1.7-7
>> Defaults_1.1-1
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.14.0 ? ? ?lattice_0.20-3 ? quantstrat_0.6.1 tools_2.14.0
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
> www.esotericR.com
>
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
>
> See you in Chicago!!!!


From josh.m.ulrich at gmail.com  Mon Mar  5 22:11:56 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 5 Mar 2012 15:11:56 -0600
Subject: [R-SIG-Finance] Quantmod SMA not working
In-Reply-To: <CAHFhaq8ve+fdvLcxjGrvGSbKFrxZ4mMr6EqpBhgFp=1RmGSVWQ@mail.gmail.com>
References: <CAHFhaq-Pj=__mrdjEVdFstAmx=w_f4PJLu1gitKCELcNZF4bow@mail.gmail.com>
	<CABDUZc8Kt6GWi3cxYBnFet5ib8CyuUZ=9YjUoTpmyzWC0jgO2w@mail.gmail.com>
	<CAHFhaq8ve+fdvLcxjGrvGSbKFrxZ4mMr6EqpBhgFp=1RmGSVWQ@mail.gmail.com>
Message-ID: <CAPPM_gQfY4+L3tCCB9uj2hPY2k5-tvHVT5guPyGCzn0p91YmAQ@mail.gmail.com>

Hi Mark,

On Mon, Mar 5, 2012 at 2:29 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
> I will try switching the load order...
>
> I have been using the EMA from fTrading because I can assign where the
> values start and I do not get 'NAs'. ?I was trying to recreate an EMA
> formula that I had been using in excel. ?It always did what I needed
> so I just stuck with it.
>
> I added two columns using the fTrading EMA and TTR EMA labled for the
> package so you can see the difference. ?Probably too much
> information....
>
> ? ? ? ? ? ? ? ? ? Open ? ?High ? ? Low ? Close ? fTrading TTR
> 2010-12-31 63.270 63.535 63.120 63.425 63.42500 ?NA
> 2011-01-03 63.310 63.670 63.085 63.620 63.44357 ?NA
> 2011-01-04 63.615 64.040 63.365 63.740 63.47180 ?NA
> 2011-01-05 63.770 64.495 63.430 64.415 63.56163 ?NA
> 2011-01-06 64.405 64.530 64.070 64.340 63.63576 ?NA
> 2011-01-07 64.325 64.490 63.950 64.280 63.69712 ?NA
>
TTR::EMA doesn't provide values for the first n-1 observations because
they shouldn't be relied on.  You need ~3n observations before the EMA
results start to stabilize.  See the Warning and Examples section of
?MA.

You can 'trick' EMA to provide numbers where it usually provides NA by
setting n=1 and ratio=2/(n+1), but these numbers are still meaningless
for all practical purposes.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com


> On Mon, Mar 5, 2012 at 1:47 PM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
>> The problem is that fTrading also has an SMA function. ?You can either
>> load it before loading quantmod/TTR or ... not use it??
>>
>> Note the conflict when you call library(fTrading) _after_ you load quantmod/TTR
>>
>> Is there a function in fTrading that you need that isn't in TTR
>>
>> Jeff
>>
>> On Mon, Mar 5, 2012 at 1:36 PM, Mark Harrison <harrisonmark1 at gmail.com> wrote:
>>> I am trying to do some data comparisons and want to use quantmod and
>>> the addSMA feature. ?However, I keep getting errors when I try the
>>> addSMA command. ?I did try the email but nothing I saw answered or
>>> fixed this issue.
>>>
>>> When I run addSMA(20) on my data - examples below - I get the following error:
>>>
>>> Error in matrix(ma.tmp[lchob at xsubset, ], nc = NCOL(ma.tmp)) :
>>> ?subscript out of bounds
>>>
>>> If I just grab Apple data from Yahoo and run:
>>>
>>> chartSeries(AAPL, subset='last 6 months')
>>> addSMA(20)
>>>
>>> The first command works and the chart appears but the addSMA command
>>> gives me the same error as above.
>>>
>>> MyData Example:
>>> ? ? ? ? ? ? Open ? High ? ?Low ?Close
>>> 2010-12-31 63.270 63.535 63.120 63.425
>>> 2011-01-03 63.310 63.670 63.085 63.620
>>> 2011-01-04 63.615 64.040 63.365 63.740
>>> 2011-01-05 63.770 64.495 63.430 64.415
>>> 2011-01-06 64.405 64.530 64.070 64.340
>>> 2011-01-07 64.325 64.490 63.950 64.280
>>>
>>> Session Info:
>>>
>>> R version 2.14.0 (2011-10-31)
>>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
>>> States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] datasets ?grDevices utils ? ? graphics ?stats ? ? methods ? base
>>>
>>> other attached packages:
>>> ?[1] blotter_0.8.4 ? ? ? ? ? ? ?fTrading_2110.77
>>> fBasics_2110.79
>>> ?[4] MASS_7.3-16 ? ? ? ? ? ? ? ?timeSeries_2140.93
>>> timeDate_2150.95
>>> ?[7] twsInstrument_1.3-1 ? ? ? ?IBrokers_0.9-3 ? ? ? ? ? ? qmao_1.1.6
>>> [10] FinancialInstrument_0.10.9 quantmod_0.3-17 ? ? ? ? ? ?TTR_0.21-0
>>> [13] xts_0.8-4 ? ? ? ? ? ? ? ? ?zoo_1.7-7
>>> Defaults_1.1-1
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.14.0 ? ? ?lattice_0.20-3 ? quantstrat_0.6.1 tools_2.14.0
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>> www.esotericR.com
>>
>> R/Finance 2012: Applied Finance with R
>> www.RinFinance.com
>>
>> See you in Chicago!!!!
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ccquant at gmail.com  Tue Mar  6 05:02:50 2012
From: ccquant at gmail.com (Ben quant)
Date: Mon, 5 Mar 2012 21:02:50 -0700
Subject: [R-SIG-Finance] adjusting for report date (removing look-ahead) -
	zoo, xts
Message-ID: <CAG2PC+cWvk4VFP2Jnsr2_x=jqWEPAEWGmgh9YFnn9AYJSDNhLg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120305/252a7588/attachment.pl>

From arsenio.star at gmail.com  Tue Mar  6 06:47:26 2012
From: arsenio.star at gmail.com (Arsenio)
Date: Mon, 5 Mar 2012 21:47:26 -0800
Subject: [R-SIG-Finance] Return calculation for panel data structure
Message-ID: <2510733673.20120305214726@gmail.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120305/a778dfab/attachment.html>

From rbali at ufmg.br  Tue Mar  6 14:24:35 2012
From: rbali at ufmg.br (Robert Iquiapaza)
Date: Tue, 6 Mar 2012 10:24:35 -0300
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <2510733673.20120305214726@gmail.com>
References: <2510733673.20120305214726@gmail.com>
Message-ID: <8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120306/8367f988/attachment.pl>

From rossbennett34 at gmail.com  Tue Mar  6 15:29:48 2012
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Tue, 6 Mar 2012 08:29:48 -0600
Subject: [R-SIG-Finance]  Does getSymbols.csv() take a "format" argument?
Message-ID: <CAEESW=XG+xGHeK_zi1UVULoUPhW7vdYVd1wKiU-7TZjkmjXfsQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120306/f4adb05c/attachment.pl>

From stergios_marinopoulos at yahoo.com  Tue Mar  6 16:47:11 2012
From: stergios_marinopoulos at yahoo.com (Stergios Marinopoulos)
Date: Tue, 6 Mar 2012 07:47:11 -0800 (PST)
Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
In-Reply-To: <CAEESW=XG+xGHeK_zi1UVULoUPhW7vdYVd1wKiU-7TZjkmjXfsQ@mail.gmail.com>
References: <CAEESW=XG+xGHeK_zi1UVULoUPhW7vdYVd1wKiU-7TZjkmjXfsQ@mail.gmail.com>
Message-ID: <1331048831.93378.YahooMailNeo@web30807.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120306/4e0ab05d/attachment.pl>

From jeffrey.ryan at lemnica.com  Tue Mar  6 16:53:58 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Tue, 6 Mar 2012 09:53:58 -0600
Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
In-Reply-To: <1331048831.93378.YahooMailNeo@web30807.mail.mud.yahoo.com>
References: <CAEESW=XG+xGHeK_zi1UVULoUPhW7vdYVd1wKiU-7TZjkmjXfsQ@mail.gmail.com>
	<1331048831.93378.YahooMailNeo@web30807.mail.mud.yahoo.com>
Message-ID: <CABDUZc8Tt_GYXj760iEczrBumTjx8+LVG4nhpz+_CHJdfwWszg@mail.gmail.com>

I'll take a look at improving the getSymbols.csv, but the general
notion of quantmod is as a framework to extend to the data *you* have,
not provide complete coverage for all possible scenarios.

That said, I'll see what can be modified to make things more robust.
Thanks for the suggestions.

Best,
Jeff

On Tue, Mar 6, 2012 at 9:47 AM, Stergios Marinopoulos
<stergios_marinopoulos at yahoo.com> wrote:
> Hi Ross,
>
> Thanks for the alternative ideas. ?While I did manage to get the csv loaded properly by looking at the source code to getSymbols.csv(), my primary motivation for posting the bug report was to help improve the quantmod package by offering feedback. ?One of the downsides of getSymbols.csv() not working besides the obvious is that one cannot then use saveSymbols() as it only works with data loaded via getSymbols() ( I think this is enforced via attribute setting in getSymbols() )
>
> I'll look into using quantstrat's loading and saving.
>
> Thanks again Ross,
>
>
> --
> Stergios Marinopoulos
>
>
> ________________________________
> ?From: Ross Bennett <rossbennett34 at gmail.com>
>
> Cc: r-sig-finance at r-project.org
> Sent: Tuesday, March 6, 2012 6:29 AM
> Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
>
>
> Stergios,
>
> Saw your question on the R-SIG-Finance mailing list. I use FX pairs in testing that I have saved on my computer and ran into a similar problem. I have found the GetSymbols.csv to be unreliable, as mentioned in the help documentation, to load the data files into R for use in quantstrat.
>
> The easiest way to do this is using the read.zoo function
>
> My data is stored in a directory such as C:\fxdata\EURUSD.csv
>
>
> Step 1: use read.zoo to load the file into R
> EURUSDzoo <- read.zoo("C:\\fxdata\\EURUSD.csv", header = TRUE, sep=",", format = '%Y-%m-%d')
>
> Step 2: coerce to xts format
> EURUSD <- as.xts(EURUSDzoo)
>
> You could also just do
> EURUSD <- as.xts(read.zoo("C:\\fxdata\\EURUSD.csv", header = TRUE, sep=",", format = '%Y-%m-%d'))
>
> Let me know if this works.
>
> Ross
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From gsee000 at gmail.com  Tue Mar  6 17:09:13 2012
From: gsee000 at gmail.com (G See)
Date: Tue, 6 Mar 2012 10:09:13 -0600
Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
In-Reply-To: <CABDUZc8Tt_GYXj760iEczrBumTjx8+LVG4nhpz+_CHJdfwWszg@mail.gmail.com>
References: <CAEESW=XG+xGHeK_zi1UVULoUPhW7vdYVd1wKiU-7TZjkmjXfsQ@mail.gmail.com>
	<1331048831.93378.YahooMailNeo@web30807.mail.mud.yahoo.com>
	<CABDUZc8Tt_GYXj760iEczrBumTjx8+LVG4nhpz+_CHJdfwWszg@mail.gmail.com>
Message-ID: <CA+xi=qbuO9FtpYFEyxJsBSy2XwXQC+RnpNvw6kYyPf+foqJEHA@mail.gmail.com>

saveSymbols will save your data as .RData files.

If you have .RData files, then FinancialInstrument:::getSymbols.FI is
probably a better way to read them as getSymbols.RData is really an
alias for getSymbols.rda which causes problems because the "rda"
extension is hardcoded in a couple places.

If you want to save your data as RData or rda files, then the
functions saveSymbols.days and saveSymbols.common (also from the
FinancialInstrument package) may be better solutions... at least they
don't require that the data were read using getSymbols.

HTH,
Garrett

On Tue, Mar 6, 2012 at 9:53 AM, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:
> I'll take a look at improving the getSymbols.csv, but the general
> notion of quantmod is as a framework to extend to the data *you* have,
> not provide complete coverage for all possible scenarios.
>
> That said, I'll see what can be modified to make things more robust.
> Thanks for the suggestions.
>
> Best,
> Jeff
>
> On Tue, Mar 6, 2012 at 9:47 AM, Stergios Marinopoulos
> <stergios_marinopoulos at yahoo.com> wrote:
>> Hi Ross,
>>
>> Thanks for the alternative ideas. ?While I did manage to get the csv loaded properly by looking at the source code to getSymbols.csv(), my primary motivation for posting the bug report was to help improve the quantmod package by offering feedback. ?One of the downsides of getSymbols.csv() not working besides the obvious is that one cannot then use saveSymbols() as it only works with data loaded via getSymbols() ( I think this is enforced via attribute setting in getSymbols() )
>>
>> I'll look into using quantstrat's loading and saving.
>>
>> Thanks again Ross,
>>
>>
>> --
>> Stergios Marinopoulos
>>
>>
>> ________________________________
>> ?From: Ross Bennett <rossbennett34 at gmail.com>
>>
>> Cc: r-sig-finance at r-project.org
>> Sent: Tuesday, March 6, 2012 6:29 AM
>> Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
>>
>>
>> Stergios,
>>
>> Saw your question on the R-SIG-Finance mailing list. I use FX pairs in testing that I have saved on my computer and ran into a similar problem. I have found the GetSymbols.csv to be unreliable, as mentioned in the help documentation, to load the data files into R for use in quantstrat.
>>
>> The easiest way to do this is using the read.zoo function
>>
>> My data is stored in a directory such as C:\fxdata\EURUSD.csv
>>
>>
>> Step 1: use read.zoo to load the file into R
>> EURUSDzoo <- read.zoo("C:\\fxdata\\EURUSD.csv", header = TRUE, sep=",", format = '%Y-%m-%d')
>>
>> Step 2: coerce to xts format
>> EURUSD <- as.xts(EURUSDzoo)
>>
>> You could also just do
>> EURUSD <- as.xts(read.zoo("C:\\fxdata\\EURUSD.csv", header = TRUE, sep=",", format = '%Y-%m-%d'))
>>
>> Let me know if this works.
>>
>> Ross
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
> www.esotericR.com
>
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
>
> See you in Chicago!!!!
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From rossbennett34 at gmail.com  Tue Mar  6 17:23:20 2012
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Tue, 6 Mar 2012 10:23:20 -0600
Subject: [R-SIG-Finance] Does getSymbols.csv() take a "format" argument?
In-Reply-To: <1331048831.93378.YahooMailNeo@web30807.mail.mud.yahoo.com>
References: <CAEESW=XG+xGHeK_zi1UVULoUPhW7vdYVd1wKiU-7TZjkmjXfsQ@mail.gmail.com>
	<1331048831.93378.YahooMailNeo@web30807.mail.mud.yahoo.com>
Message-ID: <CAEESW=UCZSM5i4t2HvreWAdYej4Le1UwwTH93rkW1fuBgUC3xQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120306/6c554a9c/attachment.pl>

From matt at considine.net  Tue Mar  6 20:28:26 2012
From: matt at considine.net (Matt Considine)
Date: Tue, 06 Mar 2012 14:28:26 -0500
Subject: [R-SIG-Finance] RollingStyle in PApages?
Message-ID: <4F56655A.50301@considine.net>

FWIW, this was the code that I eventually got to work 
(table.RollingStyle code was helpful here) :

page.RollingStyle2 <- function (R.fund, R.style, method = 
c("constrained", "unconstrained",
     "normalized"), leverage = FALSE, selection = "none", width = 12,
     main = paste(colnames(R.fund)[1], " Rolling ", width, "-Month Style 
Weights",
         sep = ""), space = 0, ...)
{
     R.fund = checkData(R.fund[, 1, drop = FALSE], method = "zoo")
     R.style = checkData(R.style, method = "zoo")
     method = method[1]
     columns.fund = ncol(R.fund)
     columns.style = ncol(R.style)
     columnnames.fund = colnames(R.fund)
     columnnames.style = colnames(R.style)
     merged.assets = na.omit(merge(R.fund, R.style))

     styleR <- function(x, method, leverage, selection) 
{t(style.fit(R.fund = x[, 1, drop = FALSE],
                                                 R.style = x[, -1, drop 
= FALSE],
                                                 method = method,
                                                 leverage = leverage,
                                                 selection = 
selection)$weights)}

     result = xts:::rollapply.xts(data = merged.assets,
                                 FUN = styleR,
                                 width = width,
                                 method = method,
                                 leverage = leverage,
                                 selection = selection,
                                 by = 1,
                                 by.column = FALSE,
                                 align = "right")

     styleRfit <- function(x, method, leverage, selection) 
{t(style.fit(R.fund = x[, 1, drop = FALSE],
                                                 R.style = x[, -1, drop 
= FALSE],
                                                 method = method,
                                                 leverage = leverage,
                                                 selection = 
selection)$R.squared)}

     fit = xts:::rollapply.xts(data = merged.assets,
                         FUN = styleRfit,
                         width = width,
                         method = method,
                         leverage = leverage,
                         selection = selection,
                         by = 1,
                         by.column = FALSE,
                         na.pad = FALSE,
                         align = "right")

     colnames(result) = columnnames.style
     rows = nrow(result)
     ymax = max(c(1, result))
     ymin = min(c(-1, result))
     op <- par(oma = c(2, 0, 4, 0), mar = c(0, 4, 0, 4))
     layout(matrix(c(1:columns.style, columns.style + 1, columns.style +
         2), nc = 1, byrow = TRUE))
     for (i in 1:columns.style) {
         if (even(i))
             yaxis.right = TRUE
         else yaxis.right = FALSE
         chart.TimeSeries(result[, i, drop = FALSE], type = "h", lend = 
"butt",
             xaxis = FALSE, main = "", ylab = colnames(result)[i],
             ylim = c(ymin, ymax), yaxis.right = yaxis.right,
             ...)
     }
     positives = result
     for (column in 1:ncol(result)) {
         for (row in 1:nrow(result)) {
             positives[row, column] = max(0, result[row, column])
         }
     }
     negatives = result
     for (column in 1:ncol(result)) {
         for (row in 1:nrow(result)) {
             negatives[row, column] = min(0, result[row, column])
         }
     }
     sumpositives = zoo(apply(positives, 1, sum), order.by = 
index(positives))
     sumnegatives = zoo(apply(negatives, 1, sum), order.by = 
index(negatives))
     net = apply(result, 1, sum)
     if (even(columns.style + 1))
         yaxis.right = TRUE
     else yaxis.right = FALSE
     chart.TimeSeries(cbind(sumpositives, sumnegatives), type = "h",
         lend = "butt", xaxis = FALSE, main = "", ylab = "Total",
         yaxis.right = yaxis.right, ...)
     lines(1:rows, net)
     if (even(columns.style + 2))
         yaxis.right = TRUE
     else yaxis.right = FALSE
     chart.TimeSeries(fit, type = "l", xaxis = TRUE, main = "",
         ylab = "AdjR^2", ylim = c(0, 1), yaxis.right = yaxis.right,
         ...)
     mtext(main, side = 3, outer = TRUE, font = 2, cex = 1.2,
         line = 1)
     par(op)
}

Regards,
Matt


From arsenio.star at gmail.com  Wed Mar  7 01:03:53 2012
From: arsenio.star at gmail.com (Arsenio)
Date: Tue, 6 Mar 2012 16:03:53 -0800
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
Message-ID: <1746887843.20120306160353@gmail.com>

Robert,

Thanks for the reply. I tried plm approach but apparently it only accepts one individual id and one time id, because this fails

> zz=pdata.frame(z, c("Stock","Fund","Date"))
Error in match(x, table, nomatch = 0L) : 
  'match' requires vector arguments

Any approach that accepts several individual observation identifiers? I will take a look at the econometrics view on CRAN

Btw, sorry if the post came out mangled due to HTML, didn't check.

Thanks,

Arsenio

Tuesday, March 6, 2012, 5:24:35 AM, you wrote:


Use diff and lag from plm:
 
Lines="ticker date_f  date prc iticker 
A 20-Jun-03  15876 19.06 IXT 
A 23-Jun-03  15879 18.89 IXT 
A 24-Jun-03  15880 18.75 IXT 
A 25-Jun-03  15881 18.92 IXT 
A 26-Jun-03  15882 19.35 IXT 
A 27-Jun-03  15883 19.55 IXT 
AA 20-Jun-03 15876 26.24 IXB 
AA 23-Jun-03 15879 25.07 IXB 
AA 24-Jun-03 15880 24.96 IXB 
AA 25-Jun-03 15881 24.51 IXB 
AA 26-Jun-03 15882 25.24 IXB 
AA 27-Jun-03 15883 25.09 IXB 
AA 30-Jun-03 15886 25.5 IXB 
"
z <- read.table(textConnection(Lines), header = TRUE)
library(plm)
zz=pdata.frame(z, c("ticker","date"))
pr=zz$prc; str(pr)
zz$return=diff(pr)/lag(pr)
zz
 
Good luck!
 
Robert
 
From: Arsenio
Sent: Tuesday, March 06, 2012 2:47 AM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] Return calculation for panel data structure
 
Dear all,

I have a very simple question and i haven't been able to code it out. It's a simple return calculation of a form:
R(t)=(P(t)-P(t-1))/P(t-1) or the same as ratio of prices minus one. However it's in the panel data, where stocks belong to say a fund or some other grouping variable.


ticker
date_f

date
prc
iticker
A
20-Jun-03

15876
19.06
IXT
A
23-Jun-03

15879
18.89
IXT
A
24-Jun-03

15880
18.75
IXT
A
25-Jun-03

15881
18.92
IXT
A
26-Jun-03

15882
19.35
IXT
A
27-Jun-03

15883
19.55
IXT
AA
20-Jun-03

15876
26.24
IXB
AA
23-Jun-03

15879
25.07
IXB
AA
24-Jun-03

15880
24.96
IXB
AA
25-Jun-03

15881
24.51
IXB
AA
26-Jun-03

15882
25.24
IXB
AA
27-Jun-03

15883
25.09
IXB
AA
30-Jun-03

15886
25.5
IXB



In  SAS, I would do it this way:

data work.1; /* This Calcs the excluded index return for INDEX constructed with PRICES (PR)!!!! */
       set work.1;
       by ticker iticker date_f ; /*sorting by stock, fund and date */

       lag_prc=lag(prc); /* creating the lagged price variable

       if first.iticker then /* if the it's a first date for the grouped unit then.. */
               lag_prc= . ; /* setting the first lagged value to missing if the first date for the grouped unit */
       return = (prc - lag_prc)/ lag_prc;
       drop lag_prc;
run;

The end result would be the same dataset with just one more column for returns for each stock, fund, date combination with the first return for the date set to missing.
I tried Return.calculate type of funcs from performance analytics and other solutions using plyr or loops, but they are all too bulky.

Any ideas how to accomplish this? Would appreciate any hints,

Arsenio 

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.




-- 
Best regards,
 Arsenio                            mailto:arsenio.star at gmail.com


From matthewcleggphd at gmail.com  Wed Mar  7 02:38:47 2012
From: matthewcleggphd at gmail.com (Matthew Clegg)
Date: Tue, 6 Mar 2012 20:38:47 -0500
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <1746887843.20120306160353@gmail.com>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
	<1746887843.20120306160353@gmail.com>
Message-ID: <CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120306/651ca4fe/attachment.pl>

From kent.russell at live.com  Wed Mar  7 05:52:50 2012
From: kent.russell at live.com (Kenton Russell)
Date: Tue, 6 Mar 2012 22:52:50 -0600
Subject: [R-SIG-Finance] RollingStyle in PApages?
In-Reply-To: <4F54E4BE.504@considine.net>
References: <4F54E4BE.504@considine.net>
Message-ID: <COL124-W650F0582665E61E80A7C38FB560@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120306/184a5584/attachment.pl>

From peter at braverock.com  Wed Mar  7 13:01:42 2012
From: peter at braverock.com (Peter Carl)
Date: Wed, 7 Mar 2012 06:01:42 -0600
Subject: [R-SIG-Finance] RollingStyle in PApages?
In-Reply-To: <4F56655A.50301@considine.net>
References: <4F56655A.50301@considine.net>
Message-ID: <c0e6fbf73fd4eb83ece357633e19a52d.squirrel@mail.braverock.com>

Matt,

Thanks for this.  The package description notes that this code is
"considered EXPERIMENTAL CODE and WILL NOT BE SUPPORTED."  The shouting
parts of that statement should probably be interpreted as "much of it is
broken and is not being worked on or maintained currently."

Specifically, the style analysis parts are deprecated and will eventually
be replaced by functionality in FactorAnalytics.  The current style code
is proof of concept and should be taken with a large grain of salt.

Still, I appreciate your interest.  Feel free to contact me offline and
I'd be happy to discuss how to move forward.

pcc
-- 
Peter Carl
http://www.braverock.com/~peter

> FWIW, this was the code that I eventually got to work
> (table.RollingStyle code was helpful here) :
>
> page.RollingStyle2 <- function (R.fund, R.style, method =
> c("constrained", "unconstrained",
>      "normalized"), leverage = FALSE, selection = "none", width = 12,
>      main = paste(colnames(R.fund)[1], " Rolling ", width, "-Month Style
> Weights",
>          sep = ""), space = 0, ...)
> {
>      R.fund = checkData(R.fund[, 1, drop = FALSE], method = "zoo")
>      R.style = checkData(R.style, method = "zoo")
>      method = method[1]
>      columns.fund = ncol(R.fund)
>      columns.style = ncol(R.style)
>      columnnames.fund = colnames(R.fund)
>      columnnames.style = colnames(R.style)
>      merged.assets = na.omit(merge(R.fund, R.style))
>
>      styleR <- function(x, method, leverage, selection)
> {t(style.fit(R.fund = x[, 1, drop = FALSE],
>                                                  R.style = x[, -1, drop
> = FALSE],
>                                                  method = method,
>                                                  leverage = leverage,
>                                                  selection =
> selection)$weights)}
>
>      result = xts:::rollapply.xts(data = merged.assets,
>                                  FUN = styleR,
>                                  width = width,
>                                  method = method,
>                                  leverage = leverage,
>                                  selection = selection,
>                                  by = 1,
>                                  by.column = FALSE,
>                                  align = "right")
>
>      styleRfit <- function(x, method, leverage, selection)
> {t(style.fit(R.fund = x[, 1, drop = FALSE],
>                                                  R.style = x[, -1, drop
> = FALSE],
>                                                  method = method,
>                                                  leverage = leverage,
>                                                  selection =
> selection)$R.squared)}
>
>      fit = xts:::rollapply.xts(data = merged.assets,
>                          FUN = styleRfit,
>                          width = width,
>                          method = method,
>                          leverage = leverage,
>                          selection = selection,
>                          by = 1,
>                          by.column = FALSE,
>                          na.pad = FALSE,
>                          align = "right")
>
>      colnames(result) = columnnames.style
>      rows = nrow(result)
>      ymax = max(c(1, result))
>      ymin = min(c(-1, result))
>      op <- par(oma = c(2, 0, 4, 0), mar = c(0, 4, 0, 4))
>      layout(matrix(c(1:columns.style, columns.style + 1, columns.style +
>          2), nc = 1, byrow = TRUE))
>      for (i in 1:columns.style) {
>          if (even(i))
>              yaxis.right = TRUE
>          else yaxis.right = FALSE
>          chart.TimeSeries(result[, i, drop = FALSE], type = "h", lend =
> "butt",
>              xaxis = FALSE, main = "", ylab = colnames(result)[i],
>              ylim = c(ymin, ymax), yaxis.right = yaxis.right,
>              ...)
>      }
>      positives = result
>      for (column in 1:ncol(result)) {
>          for (row in 1:nrow(result)) {
>              positives[row, column] = max(0, result[row, column])
>          }
>      }
>      negatives = result
>      for (column in 1:ncol(result)) {
>          for (row in 1:nrow(result)) {
>              negatives[row, column] = min(0, result[row, column])
>          }
>      }
>      sumpositives = zoo(apply(positives, 1, sum), order.by =
> index(positives))
>      sumnegatives = zoo(apply(negatives, 1, sum), order.by =
> index(negatives))
>      net = apply(result, 1, sum)
>      if (even(columns.style + 1))
>          yaxis.right = TRUE
>      else yaxis.right = FALSE
>      chart.TimeSeries(cbind(sumpositives, sumnegatives), type = "h",
>          lend = "butt", xaxis = FALSE, main = "", ylab = "Total",
>          yaxis.right = yaxis.right, ...)
>      lines(1:rows, net)
>      if (even(columns.style + 2))
>          yaxis.right = TRUE
>      else yaxis.right = FALSE
>      chart.TimeSeries(fit, type = "l", xaxis = TRUE, main = "",
>          ylab = "AdjR^2", ylim = c(0, 1), yaxis.right = yaxis.right,
>          ...)
>      mtext(main, side = 3, outer = TRUE, font = 2, cex = 1.2,
>          line = 1)
>      par(op)
> }
>
> Regards,
> Matt
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From fabien.azoulay at gmail.com  Wed Mar  7 16:23:15 2012
From: fabien.azoulay at gmail.com (fabien azoulay)
Date: Wed, 7 Mar 2012 10:23:15 -0500
Subject: [R-SIG-Finance] Hierarchical clustering and time series
Message-ID: <CAJsDZUej3-2sukqFuW03QzOSa-haqzEKD3ENfTVSP2pAVSqmxQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120307/bca181f6/attachment.pl>

From comtech.usa at gmail.com  Wed Mar  7 16:30:20 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 7 Mar 2012 09:30:20 -0600
Subject: [R-SIG-Finance] Are there genetic algorithm for trading strategy
	evolution in R?
Message-ID: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120307/34323f91/attachment.pl>

From jeffrey.ryan at lemnica.com  Wed Mar  7 17:14:31 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Wed, 7 Mar 2012 10:14:31 -0600
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
	<1746887843.20120306160353@gmail.com>
	<CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
Message-ID: <CABDUZc9xR7qanzzzdfVRzUaq9FOTziqrf74Lys3sJ=kLgj7vtA@mail.gmail.com>

Built into R is ?split or ?aggregate and ?lapply which should serve you well.

Using base R is often the fastest way to skin the cat, if not the prettiest ;-)


> library(quantmod)   # for Delt
> cbind(z,do.call(rbind,lapply(split(z,z$ticker), function(x) Delt(x$prc))))

 ticker    date_f  date   prc iticker Delt.1.arithmetic
1       A 20-Jun-03 15876 19.06     IXT                NA
2       A 23-Jun-03 15879 18.89     IXT      -0.008919203
3       A 24-Jun-03 15880 18.75     IXT      -0.007411329
4       A 25-Jun-03 15881 18.92     IXT       0.009066667
5       A 26-Jun-03 15882 19.35     IXT       0.022727273
6       A 27-Jun-03 15883 19.55     IXT       0.010335917
7      AA 20-Jun-03 15876 26.24     IXB                NA
8      AA 23-Jun-03 15879 25.07     IXB      -0.044588415
9      AA 24-Jun-03 15880 24.96     IXB      -0.004387714
10     AA 25-Jun-03 15881 24.51     IXB      -0.018028846
11     AA 26-Jun-03 15882 25.24     IXB       0.029783762
12     AA 27-Jun-03 15883 25.09     IXB      -0.005942948
13     AA 30-Jun-03 15886 25.50     IXB       0.016341172

See ?split for details on multiple identifiers ( just a list, but your
example didn't include it so I won't either)

The do.call(rbind/cbind stuff is just to get the original data.frame
back - there are more verbose ways to do the same thing.

Jeff


On Tue, Mar 6, 2012 at 7:38 PM, Matthew Clegg <matthewcleggphd at gmail.com> wrote:
> Here is another approach that might work for you.
>
> apply_by_groups <- function (T, cols, F, ...) {
> ?# On input, T is a dataframe, and cols is a list of column names.
> ?# Groups the dataframe T into groups according to the specified
> ?# column names, e.g., all rows in a given group will have identical
> ?# values in the specified columns. ?Within each group, applies the
> ?# function F to the dataframe representing that group. ?Returns the
> ?# list of results.
>
> ?NT <- T[do.call("order", lapply(cols, function(c) { T[,c]})),]
> ?change <- function(k) { !all(NT[k-1,cols] == NT[k, cols]) }
> ?starts <- which(c(TRUE, sapply(2:nrow(NT), change)))
> ?ends <- c(starts[2:length(starts)]-1, nrow(NT))
> ?lapply(1:length(starts), function(k) {
> F(NT[starts[k]:ends[k],,drop=FALSE], ...) })
> }
> ret <- function(X) { c(NA, X[2:length(X)]/X[1:(length(X)-1)]-1)}
>
>> do.call("rbind", apply_by_groups(z, "ticker", function(df) { df$ret <-
> ret(df$prc); df} ))
> ? ticker ? ?date_f ?date ? prc iticker ? ? ? ? ?ret
> 1 ? ? ? A 20-Jun-03 15876 19.06 ? ? IXT ? ? ? ? ? NA
> 2 ? ? ? A 23-Jun-03 15879 18.89 ? ? IXT -0.008919203
> 3 ? ? ? A 24-Jun-03 15880 18.75 ? ? IXT -0.007411329
> 4 ? ? ? A 25-Jun-03 15881 18.92 ? ? IXT ?0.009066667
> 5 ? ? ? A 26-Jun-03 15882 19.35 ? ? IXT ?0.022727273
> 6 ? ? ? A 27-Jun-03 15883 19.55 ? ? IXT ?0.010335917
> 7 ? ? ?AA 20-Jun-03 15876 26.24 ? ? IXB ? ? ? ? ? NA
> 8 ? ? ?AA 23-Jun-03 15879 25.07 ? ? IXB -0.044588415
> 9 ? ? ?AA 24-Jun-03 15880 24.96 ? ? IXB -0.004387714
> 10 ? ? AA 25-Jun-03 15881 24.51 ? ? IXB -0.018028846
> 11 ? ? AA 26-Jun-03 15882 25.24 ? ? IXB ?0.029783762
> 12 ? ? AA 27-Jun-03 15883 25.09 ? ? IXB -0.005942948
> 13 ? ? AA 30-Jun-03 15886 25.50 ? ? IXB ?0.016341172
>
> In the call to apply_by_groups, you can replace "ticker" with a list of
> names, e.g., c("ticker","fund","manager"), etc.
>
> Matthew Clegg
>
> On Tue, Mar 6, 2012 at 7:03 PM, Arsenio <arsenio.star at gmail.com> wrote:
>
>> Robert,
>>
>> Thanks for the reply. I tried plm approach but apparently it only accepts
>> one individual id and one time id, because this fails
>>
>> > zz=pdata.frame(z, c("Stock","Fund","Date"))
>> Error in match(x, table, nomatch = 0L) :
>> ?'match' requires vector arguments
>>
>> Any approach that accepts several individual observation identifiers? I
>> will take a look at the econometrics view on CRAN
>>
>> Btw, sorry if the post came out mangled due to HTML, didn't check.
>>
>> Thanks,
>>
>> Arsenio
>>
>> Tuesday, March 6, 2012, 5:24:35 AM, you wrote:
>>
>>
>> Use diff and lag from plm:
>>
>> Lines="ticker date_f ?date prc iticker
>> A 20-Jun-03 ?15876 19.06 IXT
>> A 23-Jun-03 ?15879 18.89 IXT
>> A 24-Jun-03 ?15880 18.75 IXT
>> A 25-Jun-03 ?15881 18.92 IXT
>> A 26-Jun-03 ?15882 19.35 IXT
>> A 27-Jun-03 ?15883 19.55 IXT
>> AA 20-Jun-03 15876 26.24 IXB
>> AA 23-Jun-03 15879 25.07 IXB
>> AA 24-Jun-03 15880 24.96 IXB
>> AA 25-Jun-03 15881 24.51 IXB
>> AA 26-Jun-03 15882 25.24 IXB
>> AA 27-Jun-03 15883 25.09 IXB
>> AA 30-Jun-03 15886 25.5 IXB
>> "
>> z <- read.table(textConnection(Lines), header = TRUE)
>> library(plm)
>> zz=pdata.frame(z, c("ticker","date"))
>> pr=zz$prc; str(pr)
>> zz$return=diff(pr)/lag(pr)
>> zz
>>
>> Good luck!
>>
>> Robert
>>
>> From: Arsenio
>> Sent: Tuesday, March 06, 2012 2:47 AM
>> To: r-sig-finance at r-project.org
>> Subject: [R-SIG-Finance] Return calculation for panel data structure
>>
>> Dear all,
>>
>> I have a very simple question and i haven't been able to code it out. It's
>> a simple return calculation of a form:
>> R(t)=(P(t)-P(t-1))/P(t-1) or the same as ratio of prices minus one.
>> However it's in the panel data, where stocks belong to say a fund or some
>> other grouping variable.
>>
>>
>> ticker
>> date_f
>>
>> date
>> prc
>> iticker
>> A
>> 20-Jun-03
>>
>> 15876
>> 19.06
>> IXT
>> A
>> 23-Jun-03
>>
>> 15879
>> 18.89
>> IXT
>> A
>> 24-Jun-03
>>
>> 15880
>> 18.75
>> IXT
>> A
>> 25-Jun-03
>>
>> 15881
>> 18.92
>> IXT
>> A
>> 26-Jun-03
>>
>> 15882
>> 19.35
>> IXT
>> A
>> 27-Jun-03
>>
>> 15883
>> 19.55
>> IXT
>> AA
>> 20-Jun-03
>>
>> 15876
>> 26.24
>> IXB
>> AA
>> 23-Jun-03
>>
>> 15879
>> 25.07
>> IXB
>> AA
>> 24-Jun-03
>>
>> 15880
>> 24.96
>> IXB
>> AA
>> 25-Jun-03
>>
>> 15881
>> 24.51
>> IXB
>> AA
>> 26-Jun-03
>>
>> 15882
>> 25.24
>> IXB
>> AA
>> 27-Jun-03
>>
>> 15883
>> 25.09
>> IXB
>> AA
>> 30-Jun-03
>>
>> 15886
>> 25.5
>> IXB
>>
>>
>>
>> In ?SAS, I would do it this way:
>>
>> data work.1; /* This Calcs the excluded index return for INDEX constructed
>> with PRICES (PR)!!!! */
>> ? ? ? set work.1;
>> ? ? ? by ticker iticker date_f ; /*sorting by stock, fund and date */
>>
>> ? ? ? lag_prc=lag(prc); /* creating the lagged price variable
>>
>> ? ? ? if first.iticker then /* if the it's a first date for the grouped
>> unit then.. */
>> ? ? ? ? ? ? ? lag_prc= . ; /* setting the first lagged value to missing if
>> the first date for the grouped unit */
>> ? ? ? return = (prc - lag_prc)/ lag_prc;
>> ? ? ? drop lag_prc;
>> run;
>>
>> The end result would be the same dataset with just one more column for
>> returns for each stock, fund, date combination with the first return for
>> the date set to missing.
>> I tried Return.calculate type of funcs from performance analytics and
>> other solutions using plyr or loops, but they are all too bulky.
>>
>> Any ideas how to accomplish this? Would appreciate any hints,
>>
>> Arsenio
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>>
>>
>> --
>> Best regards,
>> ?Arsenio ? ? ? ? ? ? ? ? ? ? ? ? ? ?mailto:arsenio.star at gmail.com
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
>
> --
> Matthew Clegg
> matthewcleggphd at gmail.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From nands31 at gmail.com  Wed Mar  7 20:09:50 2012
From: nands31 at gmail.com (Subhrangshu Nandi)
Date: Wed, 7 Mar 2012 13:09:50 -0600
Subject: [R-SIG-Finance] quantmod/addTA/.GlobalEnv question
Message-ID: <CANz8_-4w+Lyrrov+a8farpBn7mrtzhyZmV2kPtSUPWW6_O10KA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120307/2488757d/attachment.pl>

From plni at yahoo.com  Wed Mar  7 22:04:09 2012
From: plni at yahoo.com (Patrick Leoni)
Date: Wed, 7 Mar 2012 21:04:09 +0000 (GMT)
Subject: [R-SIG-Finance] Re :  quantmod/addTA/.GlobalEnv question
In-Reply-To: <CANz8_-4w+Lyrrov+a8farpBn7mrtzhyZmV2kPtSUPWW6_O10KA@mail.gmail.com>
References: <CANz8_-4w+Lyrrov+a8farpBn7mrtzhyZmV2kPtSUPWW6_O10KA@mail.gmail.com>
Message-ID: <1331154249.83332.YahooMailNeo@web132401.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120307/a5fe611f/attachment.pl>

From belmont.lounge at yahoo.com  Thu Mar  8 02:58:23 2012
From: belmont.lounge at yahoo.com (Belmont)
Date: Wed, 7 Mar 2012 17:58:23 -0800 (PST)
Subject: [R-SIG-Finance] Commodity prices
Message-ID: <1331171903.48478.YahooMailNeo@web44709.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120307/13908487/attachment.pl>

From gsee000 at gmail.com  Thu Mar  8 03:08:22 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 7 Mar 2012 20:08:22 -0600
Subject: [R-SIG-Finance] Commodity prices
In-Reply-To: <1331171903.48478.YahooMailNeo@web44709.mail.sp1.yahoo.com>
References: <1331171903.48478.YahooMailNeo@web44709.mail.sp1.yahoo.com>
Message-ID: <CA+xi=qbV7nNFR87=0Ri=52yfi_a9-jrz2Y20mHbobbjbY6nbCg@mail.gmail.com>

Look in the FinancialInstrument package in the directory
FinancialInstrument/inst/parser the following files:
download.tblox.R
download.pitrader.R
download.goldPrices.R
https://r-forge.r-project.org/scm/viewvc.php/pkg/FinancialInstrument/inst/parser/?root=blotter

Below is an example of getting "CL" and "GC" data from tradingblox.com

Garrett

> source("http://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/FinancialInstrument/inst/parser/download.tblox.R?root=blotter")
> getSymbols(c("CL", "GC"), src='tblox')
trying URL 'http://www.tradingblox.com/Data/DataOnly.zip'
Content type 'application/zip' length 3865871 bytes (3.7 Mb)
opened URL
==================================================
downloaded 3.7 Mb

[1] "CL" "GC"
> tail(CL)
           CL.Adj.Open CL.Adj.High CL.Adj.Low CL.Adj.Close CL.Volume CL.OpInt
2012-02-28      109.17      109.45     107.15       107.49    614103  1517833
2012-02-29      107.54      108.39     105.71       107.86    691115  1543447
2012-03-01      107.77      110.25     107.10       109.19    864500  1563716
2012-03-02      109.17      109.30     106.83       107.71    625949  1559219
2012-03-05      107.42      108.19     106.32       107.83    511740  1560593
2012-03-06      108.10      108.10     106.13       106.44    737509  1560593
           CL.ExpMth CL.Unadj.Close
2012-02-28    201212         107.49
2012-02-29    201212         107.86
2012-03-01    201212         109.19
2012-03-02    201212         107.71
2012-03-05    201212         107.83
2012-03-06    201212         106.44
> tail(GC)
           GC.Adj.Open GC.Adj.High GC.Adj.Low GC.Adj.Close GC.Volume GC.OpInt
2012-02-28      1770.2      1792.7     1767.0       1788.4    172415   479044
2012-02-29      1786.2      1792.3     1688.4       1711.3    366754   461741
2012-03-01      1695.6      1727.3     1695.1       1722.2    259338   456944
2012-03-02      1719.7      1725.4     1705.4       1709.8    163519   446068
2012-03-05      1712.4      1718.0     1694.4       1703.9    176224   444415
2012-03-06      1707.4      1709.8     1663.4       1672.1    251061   444415
           GC.ExpMth GC.Unadj.Close
2012-02-28    201204         1788.4
2012-02-29    201204         1711.3
2012-03-01    201204         1722.2
2012-03-02    201204         1709.8
2012-03-05    201204         1703.9
2012-03-06    201204         1672.1
>


On Wed, Mar 7, 2012 at 7:58 PM, Belmont <belmont.lounge at yahoo.com> wrote:
> Is anyone aware of a free source for commodity prices that can be downloaded through R (e.g. from Yahoo! or FRED)? ?In particular, I'm hoping to get Crude and Gold.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From reztinpeace at gmail.com  Thu Mar  8 06:43:15 2012
From: reztinpeace at gmail.com (Sofian Hadiwijaya)
Date: Thu, 8 Mar 2012 12:43:15 +0700
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
Message-ID: <CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/191c362c/attachment.pl>

From tallent_e at lycos.com  Thu Mar  8 12:53:55 2012
From: tallent_e at lycos.com (Edouard Tallent)
Date: Thu, 8 Mar 2012 11:53:55 +0000 (GMT)
Subject: [R-SIG-Finance] Message 7 Subject:  Commodity prices
References: <mailman.1.1331204401.23711.r-sig-finance@r-project.org>
Message-ID: <759114067.817725.1331207635532.JavaMail.mail@webmail20>

for an outter R solution, be aware that various commodities time series are downloadable from Wikiposit.
besides, daily/wkly times series for different crude oils are available on the EIA website 

best,
?douard
--
http://quantcorner.wordpress.com


Message: 7
Date: Wed, 7 Mar 2012 17:58:23 -0800 (PST)
From: Belmont <belmont.lounge at yahoo.com>
To: "r-sig-finance at r-project.org" <r-sig-finance at r-project.org>
Subject: [R-SIG-Finance] Commodity prices
Message-ID:
<1331171903.48478.YahooMailNeo at web44709.mail.sp1.yahoo.com>
Content-Type: text/plain

Is anyone aware of a free source for commodity prices that can be downloaded through R (e.g. from Yahoo! or FRED)?  In particular, I'm hoping to get Crude and Gold.


From zach.mayer at gmail.com  Thu Mar  8 15:25:13 2012
From: zach.mayer at gmail.com (Zachary Mayer)
Date: Thu, 8 Mar 2012 09:25:13 -0500
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
Message-ID: <CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/06fa2a8c/attachment.pl>

From brian at braverock.com  Thu Mar  8 15:41:30 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 8 Mar 2012 08:41:30 -0600
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
Message-ID: <1331217690.28362.223.camel@brian-rcg>


On Thu, 2012-03-08 at 09:25 -0500, Zachary Mayer wrote:
> There is the DEoptim<http://cran.r-project.org/web/packages/DEoptim/index.html>library
> in r, which is an excellent library for differential evolution.  If
> you can define your trading strategy in terms of a bunch of parameters to
> adjust and an objective function (i.e. turn it into an optimization
> problem), DEoptim will help you find the minimum (or maximum).
> 
> DEoptim works well on non-differentiable problems with many local minima.
>  Here is an example of using it to solve a portfolio optimization problem:
> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf

Certainly DEoptim can be used for parameter optimization of a trading
strategy.  Of course focusing on genetic algorithms to the exclusion of
other global optimization algorithms may miss the larger challenges of
optimizing trading system parameters.

I think one of the biggest challenges in this space is the definition of
an objective function to give to the optimizer.  What constitutes
success? (and I'm sure your answer will vary widely from other answers
to this question, not one size fits all).

Another major challenge here is that parameter optimization gets into
two 'hard' optimization problems: mixed integer problems, and
multi-objective optimization.

Most global optimizers use some random/directed selection in continuous
floating point numbers.  Trading system parameters may be integers,
factors, floating point, etc.  This poses some difficulty in fitting the
optimizer's floating point parameters to the trading system.

Also, you may actually have multiple objectives.  Maximize Returns and
minimize risk, subject to some maximum drawdown.  This means that you
need to optimize for all these objectives simultaneously.  In portfolio
problems, this is reasonably well understood, see for example
PortfolioAnalytics on R-Forge.  In trading system optimization, it is
not nearly so clear how to create an appropriate penalized objective for
the optimizer to work on.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From fabercastellsince1761 at gmail.com  Thu Mar  8 18:23:30 2012
From: fabercastellsince1761 at gmail.com (Faber Castell)
Date: Thu, 8 Mar 2012 18:23:30 +0100
Subject: [R-SIG-Finance] portfolios vs strategies in quantstrat
In-Reply-To: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
References: <CACBLjKQPTNt=x-YhkC-Fanm9KbDeGQo0_CjzCYa1x4V-AZXt3g@mail.gmail.com>
Message-ID: <CACBLjKSpUcvFBxD345nkP=LRXjwHDXm3SOK2bR367izip3sf6A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/a73139c6/attachment.pl>

From comtech.usa at gmail.com  Thu Mar  8 19:16:42 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 8 Mar 2012 12:16:42 -0600
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
Message-ID: <CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/b8cd01b1/attachment.pl>

From lunamoonmoon at gmail.com  Thu Mar  8 19:25:26 2012
From: lunamoonmoon at gmail.com (Luna)
Date: Thu, 8 Mar 2012 12:25:26 -0600
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <1331217690.28362.223.camel@brian-rcg>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<1331217690.28362.223.camel@brian-rcg>
Message-ID: <CAPNjSFZ1MSt9RBJrRBGFZ+DqePRWGmc92MzwMGp3tWMb2oCroQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/42fb9edd/attachment.pl>

From worik.stanton at gmail.com  Thu Mar  8 19:47:20 2012
From: worik.stanton at gmail.com (Worik Stanton)
Date: Fri, 09 Mar 2012 07:47:20 +1300
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
Message-ID: <4F58FEB8.2070503@gmail.com>

On 09/03/12 07:16, Michael wrote:
> Thanks folks!
>
> After digging further on the Internet, I have the following questions:
>
> Q1: I read the following article:
>
> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf
>
> It seems that there are a bunch of parameters in this optimizer and the
> results are sensitive to these parameters.
>
> So there is another layer of optimization with respect to these optimizer
> parameters.
>
> Is the "tweaking" of these optimizer parameters data-mining, which will
> lead to data-snooping bias?
Yes.  But that is the same as any sort of parameter search.

I had a *brief* look at that paper just now and they seem to be using 
monthly returns.  So they will have ~240 data points over 20 years.  
Ignoring the fact that optimisation 15 years ago may well not be the 
same as now (markets may change) that is still not much data once you 
embark on parameter optimisation.

To avoid data snooping there is really no replacement for more data, (or 
avoid search!)
> Q2: Due to the random nature of the optimizer, each time you run the
> backtest, you will have different performance.
>
> What do you do in that case?
?set.seed

cheers
Worik


> So for out-of-sample real-trading, we are trading a random strategy?
>
> Q3: It's pretty easy to understand using Genetic Algorithms to serve as a
> replacement for regular optimizers;
>
> but using Genetic Algorithms to evolve trading strategies seem to be
> different. Anywhere we could find such an example in R?
>
>
>
>
> On Thu, Mar 8, 2012 at 8:25 AM, Zachary Mayer<zach.mayer at gmail.com>  wrote:
>
>> There is the DEoptim<http://cran.r-project.org/web/packages/DEoptim/index.html>library in r, which is an excellent library for differential evolution.  If
>> you can define your trading strategy in terms of a bunch of parameters to
>> adjust and an objective function (i.e. turn it into an optimization
>> problem), DEoptim will help you find the minimum (or maximum).
>>
>> DEoptim works well on non-differentiable problems with many local minima.
>>   Here is an example of using it to solve a portfolio optimization problem:
>>
>> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf
>>
>>
>>
>> On Thu, Mar 8, 2012 at 12:43 AM, Sofian Hadiwijaya<reztinpeace at gmail.com>wrote:
>>
>>> how about quantmod library..
>>>
>>> On Wed, Mar 7, 2012 at 10:30 PM, Michael<comtech.usa at gmail.com>  wrote:
>>>
>>>> Hi all, Good morning, good afternoon and good evening!
>>>>
>>>> Could anybody please kindly point me to resources in R which shows about
>>>> how to use Genetic algorithm to evolve trading strategies?
>>>>
>>>> I did a lot search on Google these days and certainly it's a
>>> well-covered
>>>> and popular topic, but I don't see anywhere in R...
>>>>
>>>> Thanks a lot!
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


-- 
Foo!


From patrick at burns-stat.com  Thu Mar  8 19:51:57 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 08 Mar 2012 18:51:57 +0000
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
Message-ID: <4F58FFCD.2070606@burns-stat.com>

Comments inline.

On 08/03/2012 18:16, Michael wrote:
> Thanks folks!
>
> After digging further on the Internet, I have the following questions:
>
> Q1: I read the following article:
>
> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf
>
> It seems that there are a bunch of parameters in this optimizer and the
> results are sensitive to these parameters.
>
> So there is another layer of optimization with respect to these optimizer
> parameters.
>
> Is the "tweaking" of these optimizer parameters data-mining, which will
> lead to data-snooping bias?

I wouldn't think so, but there might be
a way to manage it.

>
> Q2: Due to the random nature of the optimizer, each time you run the
> backtest, you will have different performance.
>
> What do you do in that case?

That may be a good thing, if you are
willing to use it.

In what I've done on backtesting:

http://www.portfolioprobe.com/2010/11/05/backtesting-almost-wordless/

I show how to assess whether the strategy
is better than luck by using random trades.

The standard thing to assume (as I do in
that piece) is that the optimization is
noiseless.  But really the optimization
depends on a multitude of subtle influences.
Even if you always got the exact global
optimum, if a variance or expected return
were slightly different, you could get a
very different path.  The "optimal" path
is fuzzy in actuality.

>
> So for out-of-sample real-trading, we are trading a random strategy?

Yes.  But the inputs are random so even
non-stochastic optimizers give you a
random strategy in a sense.

>
> Q3: It's pretty easy to understand using Genetic Algorithms to serve as a
> replacement for regular optimizers;
>
> but using Genetic Algorithms to evolve trading strategies seem to be
> different. Anywhere we could find such an example in R?

Yes, that is different.

In https://stat.ethz.ch/pipermail/r-sig-finance/2010q4/007033.html
you can find Josh quoting me quoting Lao-Tzu
on why you are unlikely to find much useful
on that subject.

Pat

>
>
>
>
> On Thu, Mar 8, 2012 at 8:25 AM, Zachary Mayer<zach.mayer at gmail.com>  wrote:
>
>> There is the DEoptim<http://cran.r-project.org/web/packages/DEoptim/index.html>library in r, which is an excellent library for differential evolution.  If
>> you can define your trading strategy in terms of a bunch of parameters to
>> adjust and an objective function (i.e. turn it into an optimization
>> problem), DEoptim will help you find the minimum (or maximum).
>>
>> DEoptim works well on non-differentiable problems with many local minima.
>>   Here is an example of using it to solve a portfolio optimization problem:
>>
>> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf
>>
>>
>>
>> On Thu, Mar 8, 2012 at 12:43 AM, Sofian Hadiwijaya<reztinpeace at gmail.com>wrote:
>>
>>> how about quantmod library..
>>>
>>> On Wed, Mar 7, 2012 at 10:30 PM, Michael<comtech.usa at gmail.com>  wrote:
>>>
>>>> Hi all, Good morning, good afternoon and good evening!
>>>>
>>>> Could anybody please kindly point me to resources in R which shows about
>>>> how to use Genetic algorithm to evolve trading strategies?
>>>>
>>>> I did a lot search on Google these days and certainly it's a
>>> well-covered
>>>> and popular topic, but I don't see anywhere in R...
>>>>
>>>> Thanks a lot!
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From daniel.cegielka at gmail.com  Thu Mar  8 20:14:41 2012
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Thu, 8 Mar 2012 20:14:41 +0100
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <4F58FFCD.2070606@burns-stat.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
Message-ID: <CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/02c61ff7/attachment.pl>

From patrick at burns-stat.com  Thu Mar  8 20:24:27 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 08 Mar 2012 19:24:27 +0000
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
Message-ID: <4F59076B.6050800@burns-stat.com>

Yes, serious chance of doing it poorly
without years of intense work.

On 08/03/2012 19:14, Daniel Cegie?ka wrote:
> Let me add my two cents. Old Max Dama blog (mirror):
>
> http://smartdatacollective.com/maxdama/22571/voodoo-spectrum-machine-learning-and-data-sets
>
>
> Optimization is good to examine the sensitivity of the model and the
> selection of appropriate parameters - this is useful. But playing with
> the evolutionary strategy, what you Michael ask, is very risky.
>
> regards,
> Daniel
>
>
>
> 2012/3/8 Patrick Burns <patrick at burns-stat.com
> <mailto:patrick at burns-stat.com>>
>
>     Comments inline.
>
>
>     On 08/03/2012 18:16, Michael wrote:
>
>         Thanks folks!
>
>         After digging further on the Internet, I have the following
>         questions:
>
>         Q1: I read the following article:
>
>         http://cran.r-project.org/web/__packages/DEoptim/vignettes/__DEoptimPortfolioOptimization.__pdf
>         <http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf>
>
>         It seems that there are a bunch of parameters in this optimizer
>         and the
>         results are sensitive to these parameters.
>
>         So there is another layer of optimization with respect to these
>         optimizer
>         parameters.
>
>         Is the "tweaking" of these optimizer parameters data-mining,
>         which will
>         lead to data-snooping bias?
>
>
>     I wouldn't think so, but there might be
>     a way to manage it.
>
>
>
>         Q2: Due to the random nature of the optimizer, each time you run the
>         backtest, you will have different performance.
>
>         What do you do in that case?
>
>
>     That may be a good thing, if you are
>     willing to use it.
>
>     In what I've done on backtesting:
>
>     http://www.portfolioprobe.com/__2010/11/05/backtesting-almost-__wordless/
>     <http://www.portfolioprobe.com/2010/11/05/backtesting-almost-wordless/>
>
>     I show how to assess whether the strategy
>     is better than luck by using random trades.
>
>     The standard thing to assume (as I do in
>     that piece) is that the optimization is
>     noiseless.  But really the optimization
>     depends on a multitude of subtle influences.
>     Even if you always got the exact global
>     optimum, if a variance or expected return
>     were slightly different, you could get a
>     very different path.  The "optimal" path
>     is fuzzy in actuality.
>
>
>
>         So for out-of-sample real-trading, we are trading a random strategy?
>
>
>     Yes.  But the inputs are random so even
>     non-stochastic optimizers give you a
>     random strategy in a sense.
>
>
>
>         Q3: It's pretty easy to understand using Genetic Algorithms to
>         serve as a
>         replacement for regular optimizers;
>
>         but using Genetic Algorithms to evolve trading strategies seem to be
>         different. Anywhere we could find such an example in R?
>
>
>     Yes, that is different.
>
>     In
>     https://stat.ethz.ch/__pipermail/r-sig-finance/__2010q4/007033.html
>     <https://stat.ethz.ch/pipermail/r-sig-finance/2010q4/007033.html>
>     you can find Josh quoting me quoting Lao-Tzu
>     on why you are unlikely to find much useful
>     on that subject.
>
>     Pat
>
>
>
>
>
>
>         On Thu, Mar 8, 2012 at 8:25 AM, Zachary
>         Mayer<zach.mayer at gmail.com <mailto:zach.mayer at gmail.com>>  wrote:
>
>             There is the
>             DEoptim<http://cran.r-project.__org/web/packages/DEoptim/__index.html
>             <http://cran.r-project.org/web/packages/DEoptim/index.html>>library
>             in r, which is an excellent library for differential
>             evolution.  If
>             you can define your trading strategy in terms of a bunch of
>             parameters to
>             adjust and an objective function (i.e. turn it into an
>             optimization
>             problem), DEoptim will help you find the minimum (or maximum).
>
>             DEoptim works well on non-differentiable problems with many
>             local minima.
>               Here is an example of using it to solve a portfolio
>             optimization problem:
>
>             http://cran.r-project.org/web/__packages/DEoptim/vignettes/__DEoptimPortfolioOptimization.__pdf
>             <http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf>
>
>
>
>             On Thu, Mar 8, 2012 at 12:43 AM, Sofian
>             Hadiwijaya<reztinpeace at gmail.__com
>             <mailto:reztinpeace at gmail.com>>wrote:
>
>                 how about quantmod library..
>
>                 On Wed, Mar 7, 2012 at 10:30 PM,
>                 Michael<comtech.usa at gmail.com
>                 <mailto:comtech.usa at gmail.com>>  wrote:
>
>                     Hi all, Good morning, good afternoon and good evening!
>
>                     Could anybody please kindly point me to resources in
>                     R which shows about
>                     how to use Genetic algorithm to evolve trading
>                     strategies?
>
>                     I did a lot search on Google these days and
>                     certainly it's a
>
>                 well-covered
>
>                     and popular topic, but I don't see anywhere in R...
>
>                     Thanks a lot!
>
>                             [[alternative HTML version deleted]]
>
>                     _________________________________________________
>                     R-SIG-Finance at r-project.org
>                     <mailto:R-SIG-Finance at r-project.org> mailing list
>                     https://stat.ethz.ch/mailman/__listinfo/r-sig-finance <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>                     -- Subscriber-posting only. If you want to post,
>                     subscribe first.
>                     -- Also note that this is not the r-help list where
>                     general R questions
>                     should go.
>
>
>                         [[alternative HTML version deleted]]
>
>                 _________________________________________________
>                 R-SIG-Finance at r-project.org
>                 <mailto:R-SIG-Finance at r-project.org> mailing list
>                 https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>                 <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>                 -- Subscriber-posting only. If you want to post,
>                 subscribe first.
>                 -- Also note that this is not the r-help list where
>                 general R questions
>                 should go.
>
>
>
>
>                 [[alternative HTML version deleted]]
>
>         _________________________________________________
>         R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>         mailing list
>         https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>         -- Subscriber-posting only. If you want to post, subscribe first.
>         -- Also note that this is not the r-help list where general R
>         questions should go.
>
>
>     --
>     Patrick Burns
>     patrick at burns-stat.com <mailto:patrick at burns-stat.com>
>     http://www.burns-stat.com
>     http://www.portfolioprobe.com/__blog
>     <http://www.portfolioprobe.com/blog>
>     twitter: @portfolioprobe
>
>
>     _________________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From gaurav_m_159 at yahoo.com  Thu Mar  8 21:04:14 2012
From: gaurav_m_159 at yahoo.com (Gaurav Malhotra)
Date: Thu, 8 Mar 2012 12:04:14 -0800
Subject: [R-SIG-Finance] testing momentum - Quantstrat
In-Reply-To: <CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
Message-ID: <1331237054.552.YahooMailNeo@web113616.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/6efe73a8/attachment.pl>

From ustaudinger at activequant.com  Thu Mar  8 21:52:09 2012
From: ustaudinger at activequant.com (Ulrich Staudinger)
Date: Thu, 8 Mar 2012 21:52:09 +0100
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <4F59076B.6050800@burns-stat.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
	<4F59076B.6050800@burns-stat.com>
Message-ID: <CAMrz3D2swvU6MB2S7kibX7vS=00+kM7WZUg6h061YPqOFh6o4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/22bd877c/attachment.pl>

From Darko.Roupell at cba.com.au  Thu Mar  8 23:23:10 2012
From: Darko.Roupell at cba.com.au (Roupell, Darko)
Date: Fri, 9 Mar 2012 09:23:10 +1100
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <4F59076B.6050800@burns-stat.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
	<4F59076B.6050800@burns-stat.com>
Message-ID: <7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>

To contribute to this discussion with a more concrete example of genetic algorithm usage for trading purpose I have disclosed simple code snippet how to implement it using DEoptim. GALGO is alternative to DEoptim in R.

Micheal, generally I do not provide complete examples so for this exception thank to Patrick Burns as he helped me in the past with PortfolioProbe Optimizer. Hope it helps.


******Disclaimer this is just example for learning purposes but no warranty is made as to accuracy and no liability is accepted if used for commercial purposes****

require(quantmod)
require(PerformanceAnalytics)
require(blotter)
require(DEoptim)
################ MACD TEST
z=read.csv(file="G:\\QERD\\GALGO\\first.csv",header=TRUE,sep=",",stringsAsFactors=FALSE, colClasses=c('character','numeric','numeric'))
z =as.xts(z, as.POSIXct(z$Date))
#force columns into numeric values
z$sum=as.numeric(z$INTC)+as.numeric(z$IEF)
z = z[,c("INTC", "IEF")]
# Let's think about returns instead of prices...
# Ra is the log return for a buy-and-hold strategy, Rb the 'benchmark.'
# We will extensively use these log-return series in the sequel.

z$Ra = Return.calculate(z$INTC)
z$Rb = Return.calculate(z$IEF)
# we will optimise over in sample data
insample=z['2008:']

#the fitness function must obtain the data
MACDFitness  <- function(params) {
    fast  <- params[1]
    slow  <- params[2]
    sig  <- params[3]
    if ((fast <= slow - 1) & (slow >= 4) & (fast >=4) & ((sig >= fast) & (sig <= slow))) { #certain conditions does not make sense
        params = paste("F: ",fast," slow: ",slow,sep="")
        x <- MACD(parent$INTC, nFast=fast, nSlow=slow, nSig=sig,maType="EMA")
        position <- sign(x[,1]-x[,2])
        s <- xts(position,order.by=index(parent))
        s$Ra <- parent$Ra
        s$Rb <- parent$Rb
        s$rts <- (s$Ra*(s$macd>0)) + (s$Rb*(s$macd<=0))
        Dt <- na.omit(s$rts-s$Rb)
        sharpe = (mean(Dt)*252)/(sd(Dt)*sqrt(252))
    } else {
        sharpe = -100
    }
    #have to return negative sharpe because DEoptim minimises the fitness function
    return(-sharpe)
}


lower = c(4,4,4)
upper = c(63,63,63)

set.seed(1234)
parent=z

#perform optimizaztion, set value to reach at -6 (i.e. sharpe ratio of 6 in this example) and maximum interations = 100
outDEoptim = DEoptim(MACDFitness,lower,upper, DEoptim.control(VTR=-6,itermax=100,))
summary(outDEoptim)

__________________________________________________
Commonwealth Bank
Darko Roupell
Associate Quantitative Analyst
Institutional Banking & Markets
Equities Research
Darling Park Tower 1
Level 23, 201 Sussex Street
Sydney, NSW 2000
P:  +61 2 9117 1254
F:  +61 2 9118 1000
M: +61 400 170 515
E: Darko.Roupell at cba.com.au
Our vision is to be Australia's finest financial services organisation through excelling in customer service.

Email Security
This email is sent solely for informational purposes. Hoax emails, commonly referred to as phishing, can appear to be from the Commonwealth Bank and ask you to update or confirm details such as client numbers, passwords, personal identification questions, contact details or account numbers. The Commonwealth Bank will never send you an email asking you to confirm, update or reveal your confidential banking information.
Important Information
Produced by Global Markets Research, a business unit of Commonwealth Bank of Australia ABN 48 123 123 124 - AFSL 234945 (Commonwealth Bank). This publication is based on information available at the time of publishing.  We believe that the information in this communication is correct and any opinions, conclusions or recommendations are reasonably held or made as at the time of its compilation, but no warranty is made as to accuracy, reliability or completeness.  To the extent permitted by law, neither Commonwealth Bank nor any of its subsidiaries accept liability to any person for loss or damage arising from the use of this communication. This communication does not purport to be a complete statement or summary.
The information provided has been prepared without considering your objectives, financial situation or needs, and before acting on the information, you should consider its appropriateness to your circumstances. No person should act on the basis of this report without considering and if necessary taking appropriate professional advice upon their own particular circumstances.
Commonwealth Bank of Australia, as a provider of investment, borrowing and other financial services undertakes financial transactions with many corporate entities in Australia. This may include any corporate issuer referred to in this communication. Commonwealth Bank and its subsidiaries have effected or may effect transactions for their own account in any investments or related investments referred to herein. In the case of certain securities Commonwealth Bank is or may be the only market maker.


-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Patrick Burns
Sent: Friday, 9 March 2012 6:24 AM
To: Daniel Cegie?ka
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Are there genetic algorithm for trading strategy evolution in R?

Yes, serious chance of doing it poorly
without years of intense work.

On 08/03/2012 19:14, Daniel Cegie?ka wrote:
> Let me add my two cents. Old Max Dama blog (mirror):
>
> http://smartdatacollective.com/maxdama/22571/voodoo-spectrum-machine-learning-and-data-sets
>
>
> Optimization is good to examine the sensitivity of the model and the
> selection of appropriate parameters - this is useful. But playing with
> the evolutionary strategy, what you Michael ask, is very risky.
>
> regards,
> Daniel
>
>
>
> 2012/3/8 Patrick Burns <patrick at burns-stat.com
> <mailto:patrick at burns-stat.com>>
>
>     Comments inline.
>
>
>     On 08/03/2012 18:16, Michael wrote:
>
>         Thanks folks!
>
>         After digging further on the Internet, I have the following
>         questions:
>
>         Q1: I read the following article:
>
>         http://cran.r-project.org/web/__packages/DEoptim/vignettes/__DEoptimPortfolioOptimization.__pdf
>         <http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf>
>
>         It seems that there are a bunch of parameters in this optimizer
>         and the
>         results are sensitive to these parameters.
>
>         So there is another layer of optimization with respect to these
>         optimizer
>         parameters.
>
>         Is the "tweaking" of these optimizer parameters data-mining,
>         which will
>         lead to data-snooping bias?
>
>
>     I wouldn't think so, but there might be
>     a way to manage it.
>
>
>
>         Q2: Due to the random nature of the optimizer, each time you run the
>         backtest, you will have different performance.
>
>         What do you do in that case?
>
>
>     That may be a good thing, if you are
>     willing to use it.
>
>     In what I've done on backtesting:
>
>     http://www.portfolioprobe.com/__2010/11/05/backtesting-almost-__wordless/
>     <http://www.portfolioprobe.com/2010/11/05/backtesting-almost-wordless/>
>
>     I show how to assess whether the strategy
>     is better than luck by using random trades.
>
>     The standard thing to assume (as I do in
>     that piece) is that the optimization is
>     noiseless.  But really the optimization
>     depends on a multitude of subtle influences.
>     Even if you always got the exact global
>     optimum, if a variance or expected return
>     were slightly different, you could get a
>     very different path.  The "optimal" path
>     is fuzzy in actuality.
>
>
>
>         So for out-of-sample real-trading, we are trading a random strategy?
>
>
>     Yes.  But the inputs are random so even
>     non-stochastic optimizers give you a
>     random strategy in a sense.
>
>
>
>         Q3: It's pretty easy to understand using Genetic Algorithms to
>         serve as a
>         replacement for regular optimizers;
>
>         but using Genetic Algorithms to evolve trading strategies seem to be
>         different. Anywhere we could find such an example in R?
>
>
>     Yes, that is different.
>
>     In
>     https://stat.ethz.ch/__pipermail/r-sig-finance/__2010q4/007033.html
>     <https://stat.ethz.ch/pipermail/r-sig-finance/2010q4/007033.html>
>     you can find Josh quoting me quoting Lao-Tzu
>     on why you are unlikely to find much useful
>     on that subject.
>
>     Pat
>
>
>
>
>
>
>         On Thu, Mar 8, 2012 at 8:25 AM, Zachary
>         Mayer<zach.mayer at gmail.com <mailto:zach.mayer at gmail.com>>  wrote:
>
>             There is the
>             DEoptim<http://cran.r-project.__org/web/packages/DEoptim/__index.html
>             <http://cran.r-project.org/web/packages/DEoptim/index.html>>library
>             in r, which is an excellent library for differential
>             evolution.  If
>             you can define your trading strategy in terms of a bunch of
>             parameters to
>             adjust and an objective function (i.e. turn it into an
>             optimization
>             problem), DEoptim will help you find the minimum (or maximum).
>
>             DEoptim works well on non-differentiable problems with many
>             local minima.
>               Here is an example of using it to solve a portfolio
>             optimization problem:
>
>             http://cran.r-project.org/web/__packages/DEoptim/vignettes/__DEoptimPortfolioOptimization.__pdf
>             <http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf>
>
>
>
>             On Thu, Mar 8, 2012 at 12:43 AM, Sofian
>             Hadiwijaya<reztinpeace at gmail.__com
>             <mailto:reztinpeace at gmail.com>>wrote:
>
>                 how about quantmod library..
>
>                 On Wed, Mar 7, 2012 at 10:30 PM,
>                 Michael<comtech.usa at gmail.com
>                 <mailto:comtech.usa at gmail.com>>  wrote:
>
>                     Hi all, Good morning, good afternoon and good evening!
>
>                     Could anybody please kindly point me to resources in
>                     R which shows about
>                     how to use Genetic algorithm to evolve trading
>                     strategies?
>
>                     I did a lot search on Google these days and
>                     certainly it's a
>
>                 well-covered
>
>                     and popular topic, but I don't see anywhere in R...
>
>                     Thanks a lot!
>
>                             [[alternative HTML version deleted]]
>
>                     _________________________________________________
>                     R-SIG-Finance at r-project.org
>                     <mailto:R-SIG-Finance at r-project.org> mailing list
>                     https://stat.ethz.ch/mailman/__listinfo/r-sig-finance <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>                     -- Subscriber-posting only. If you want to post,
>                     subscribe first.
>                     -- Also note that this is not the r-help list where
>                     general R questions
>                     should go.
>
>
>                         [[alternative HTML version deleted]]
>
>                 _________________________________________________
>                 R-SIG-Finance at r-project.org
>                 <mailto:R-SIG-Finance at r-project.org> mailing list
>                 https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>                 <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>                 -- Subscriber-posting only. If you want to post,
>                 subscribe first.
>                 -- Also note that this is not the r-help list where
>                 general R questions
>                 should go.
>
>
>
>
>                 [[alternative HTML version deleted]]
>
>         _________________________________________________
>         R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>         mailing list
>         https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>         -- Subscriber-posting only. If you want to post, subscribe first.
>         -- Also note that this is not the r-help list where general R
>         questions should go.
>
>
>     --
>     Patrick Burns
>     patrick at burns-stat.com <mailto:patrick at burns-stat.com>
>     http://www.burns-stat.com
>     http://www.portfolioprobe.com/__blog
>     <http://www.portfolioprobe.com/blog>
>     twitter: @portfolioprobe
>
>
>     _________________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/__listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>

--
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

************** IMPORTANT MESSAGE *****************************       
This e-mail message is intended only for the addressee(s) and contains information which may be
confidential. 
If you are not the intended recipient please advise the sender by return email, do not use or
disclose the contents, and delete the message and any attachments from your system. Unless
specifically indicated, this email does not constitute formal advice or commitment by the sender
or the Commonwealth Bank of Australia (ABN 48 123 123 124) or its subsidiaries. 
We can be contacted through our web site: commbank.com.au. 
If you no longer wish to receive commercial electronic messages from us, please reply to this
e-mail by typing Unsubscribe in the subject line. 
**************************************************************



From comtech.usa at gmail.com  Fri Mar  9 04:59:53 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 8 Mar 2012 21:59:53 -0600
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
	<4F59076B.6050800@burns-stat.com>
	<7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>
Message-ID: <CAPNjSFZooXOGpiq1bN1X+HctKKVJpm+X6roNdeXDD7560u=4bg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/438254c0/attachment.pl>

From comtech.usa at gmail.com  Fri Mar  9 05:13:20 2012
From: comtech.usa at gmail.com (Michael)
Date: Thu, 8 Mar 2012 22:13:20 -0600
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPNjSFZooXOGpiq1bN1X+HctKKVJpm+X6roNdeXDD7560u=4bg@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
	<4F59076B.6050800@burns-stat.com>
	<7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>
	<CAPNjSFZooXOGpiq1bN1X+HctKKVJpm+X6roNdeXDD7560u=4bg@mail.gmail.com>
Message-ID: <CAPNjSFZreN5BHLU7d4h8jVPH8AvbHe+UfspyVGmyUoNBfww8Qg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120308/8ae5c7da/attachment.pl>

From arsenio.star at gmail.com  Fri Mar  9 05:43:19 2012
From: arsenio.star at gmail.com (Arsenio)
Date: Thu, 8 Mar 2012 20:43:19 -0800
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <CABDUZc9xR7qanzzzdfVRzUaq9FOTziqrf74Lys3sJ=kLgj7vtA@mail.gmail.com>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
	<1746887843.20120306160353@gmail.com>
	<CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
	<CABDUZc9xR7qanzzzdfVRzUaq9FOTziqrf74Lys3sJ=kLgj7vtA@mail.gmail.com>
Message-ID: <1229570413.20120308204319@gmail.com>

Jeffrey,

Thanks a lot!
I tried this code worked for the single grouping factor variable, now testing it with two which means apparently they have to cover the whole dataset, maybe NA in one of the variable not allowed by the ?split ?

Warning message:
In split.default(seq_len(nrow(x)), f, drop = drop, ...) :
  data length is not a multiple of split variable

I was looking for something simpler that would also help to understand the code for peers working in SAS, so base R would be a bit too complicated. 

Thanks for the Delt function that's quite a shortcut!

Arsenio



Wednesday, March 7, 2012, 8:14:31 AM, you wrote:

> Built into R is ?split or ?aggregate and ?lapply which should serve you well.

> Using base R is often the fastest way to skin the cat, if not the prettiest ;-)


>> library(quantmod)   # for Delt
>> cbind(z,do.call(rbind,lapply(split(z,z$ticker), function(x) Delt(x$prc))))

>  ticker    date_f  date   prc iticker Delt.1.arithmetic
> 1       A 20-Jun-03 15876 19.06     IXT                NA
> 2       A 23-Jun-03 15879 18.89     IXT      -0.008919203
> 3       A 24-Jun-03 15880 18.75     IXT      -0.007411329
> 4       A 25-Jun-03 15881 18.92     IXT       0.009066667
> 5       A 26-Jun-03 15882 19.35     IXT       0.022727273
> 6       A 27-Jun-03 15883 19.55     IXT       0.010335917
> 7      AA 20-Jun-03 15876 26.24     IXB                NA
> 8      AA 23-Jun-03 15879 25.07     IXB      -0.044588415
> 9      AA 24-Jun-03 15880 24.96     IXB      -0.004387714
> 10     AA 25-Jun-03 15881 24.51     IXB      -0.018028846
> 11     AA 26-Jun-03 15882 25.24     IXB       0.029783762
> 12     AA 27-Jun-03 15883 25.09     IXB      -0.005942948
> 13     AA 30-Jun-03 15886 25.50     IXB       0.016341172

> See ?split for details on multiple identifiers ( just a list, but your
> example didn't include it so I won't either)

> The do.call(rbind/cbind stuff is just to get the original data.frame
> back - there are more verbose ways to do the same thing.

> Jeff


> On Tue, Mar 6, 2012 at 7:38 PM, Matthew Clegg
> <matthewcleggphd at gmail.com> wrote:
>> Here is another approach that might work for you.

>> apply_by_groups <- function (T, cols, F, ...) {
>>  # On input, T is a dataframe, and cols is a list of column names.
>>  # Groups the dataframe T into groups according to the specified
>>  # column names, e.g., all rows in a given group will have identical
>>  # values in the specified columns.  Within each group, applies the
>>  # function F to the dataframe representing that group.  Returns the
>>  # list of results.

>>  NT <- T[do.call("order", lapply(cols, function(c) { T[,c]})),]
>>  change <- function(k) { !all(NT[k-1,cols] == NT[k, cols]) }
>>  starts <- which(c(TRUE, sapply(2:nrow(NT), change)))
>>  ends <- c(starts[2:length(starts)]-1, nrow(NT))
>>  lapply(1:length(starts), function(k) {
>> F(NT[starts[k]:ends[k],,drop=FALSE], ...) })
>> }
>> ret <- function(X) { c(NA, X[2:length(X)]/X[1:(length(X)-1)]-1)}

>>> do.call("rbind", apply_by_groups(z, "ticker", function(df) { df$ret <-
>> ret(df$prc); df} ))
>>   ticker    date_f  date   prc iticker          ret
>> 1       A 20-Jun-03 15876 19.06     IXT           NA
>> 2       A 23-Jun-03 15879 18.89     IXT -0.008919203
>> 3       A 24-Jun-03 15880 18.75     IXT -0.007411329
>> 4       A 25-Jun-03 15881 18.92     IXT  0.009066667
>> 5       A 26-Jun-03 15882 19.35     IXT  0.022727273
>> 6       A 27-Jun-03 15883 19.55     IXT  0.010335917
>> 7      AA 20-Jun-03 15876 26.24     IXB           NA
>> 8      AA 23-Jun-03 15879 25.07     IXB -0.044588415
>> 9      AA 24-Jun-03 15880 24.96     IXB -0.004387714
>> 10     AA 25-Jun-03 15881 24.51     IXB -0.018028846
>> 11     AA 26-Jun-03 15882 25.24     IXB  0.029783762
>> 12     AA 27-Jun-03 15883 25.09     IXB -0.005942948
>> 13     AA 30-Jun-03 15886 25.50     IXB  0.016341172

>> In the call to apply_by_groups, you can replace "ticker" with a list of
>> names, e.g., c("ticker","fund","manager"), etc.

>> Matthew Clegg

>> On Tue, Mar 6, 2012 at 7:03 PM, Arsenio <arsenio.star at gmail.com> wrote:

>>> Robert,

>>> Thanks for the reply. I tried plm approach but apparently it only accepts
>>> one individual id and one time id, because this fails

>>> > zz=pdata.frame(z, c("Stock","Fund","Date"))
>>> Error in match(x, table, nomatch = 0L) :
>>>  'match' requires vector arguments

>>> Any approach that accepts several individual observation identifiers? I
>>> will take a look at the econometrics view on CRAN

>>> Btw, sorry if the post came out mangled due to HTML, didn't check.

>>> Thanks,

>>> Arsenio

>>> Tuesday, March 6, 2012, 5:24:35 AM, you wrote:


>>> Use diff and lag from plm:

>>> Lines="ticker date_f  date prc iticker
>>> A 20-Jun-03  15876 19.06 IXT
>>> A 23-Jun-03  15879 18.89 IXT
>>> A 24-Jun-03  15880 18.75 IXT
>>> A 25-Jun-03  15881 18.92 IXT
>>> A 26-Jun-03  15882 19.35 IXT
>>> A 27-Jun-03  15883 19.55 IXT
>>> AA 20-Jun-03 15876 26.24 IXB
>>> AA 23-Jun-03 15879 25.07 IXB
>>> AA 24-Jun-03 15880 24.96 IXB
>>> AA 25-Jun-03 15881 24.51 IXB
>>> AA 26-Jun-03 15882 25.24 IXB
>>> AA 27-Jun-03 15883 25.09 IXB
>>> AA 30-Jun-03 15886 25.5 IXB
>>> "
>>> z <- read.table(textConnection(Lines), header = TRUE)
>>> library(plm)
>>> zz=pdata.frame(z, c("ticker","date"))
>>> pr=zz$prc; str(pr)
>>> zz$return=diff(pr)/lag(pr)
>>> zz

>>> Good luck!

>>> Robert

>>> From: Arsenio
>>> Sent: Tuesday, March 06, 2012 2:47 AM
>>> To: r-sig-finance at r-project.org
>>> Subject: [R-SIG-Finance] Return calculation for panel data structure

>>> Dear all,

>>> I have a very simple question and i haven't been able to code it out. It's
>>> a simple return calculation of a form:
>>> R(t)=(P(t)-P(t-1))/P(t-1) or the same as ratio of prices minus one.
>>> However it's in the panel data, where stocks belong to say a fund or some
>>> other grouping variable.


>>> ticker
>>> date_f

>>> date
>>> prc
>>> iticker
>>> A
>>> 20-Jun-03

>>> 15876
>>> 19.06
>>> IXT
>>> A
>>> 23-Jun-03

>>> 15879
>>> 18.89
>>> IXT
>>> A
>>> 24-Jun-03

>>> 15880
>>> 18.75
>>> IXT
>>> A
>>> 25-Jun-03

>>> 15881
>>> 18.92
>>> IXT
>>> A
>>> 26-Jun-03

>>> 15882
>>> 19.35
>>> IXT
>>> A
>>> 27-Jun-03

>>> 15883
>>> 19.55
>>> IXT
>>> AA
>>> 20-Jun-03

>>> 15876
>>> 26.24
>>> IXB
>>> AA
>>> 23-Jun-03

>>> 15879
>>> 25.07
>>> IXB
>>> AA
>>> 24-Jun-03

>>> 15880
>>> 24.96
>>> IXB
>>> AA
>>> 25-Jun-03

>>> 15881
>>> 24.51
>>> IXB
>>> AA
>>> 26-Jun-03

>>> 15882
>>> 25.24
>>> IXB
>>> AA
>>> 27-Jun-03

>>> 15883
>>> 25.09
>>> IXB
>>> AA
>>> 30-Jun-03

>>> 15886
>>> 25.5
>>> IXB



>>> In  SAS, I would do it this way:

>>> data work.1; /* This Calcs the excluded index return for INDEX constructed
>>> with PRICES (PR)!!!! */
>>>       set work.1;
>>>       by ticker iticker date_f ; /*sorting by stock, fund and date */

>>>       lag_prc=lag(prc); /* creating the lagged price variable

>>>       if first.iticker then /* if the it's a first date for the grouped
>>> unit then.. */
>>>               lag_prc= . ; /* setting the first lagged value to missing if
>>> the first date for the grouped unit */
>>>       return = (prc - lag_prc)/ lag_prc;
>>>       drop lag_prc;
>>> run;

>>> The end result would be the same dataset with just one more column for
>>> returns for each stock, fund, date combination with the first return for
>>> the date set to missing.
>>> I tried Return.calculate type of funcs from performance analytics and
>>> other solutions using plyr or loops, but they are all too bulky.

>>> Any ideas how to accomplish this? Would appreciate any hints,

>>> Arsenio

>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.




>>> --
>>> Best regards,
>>>  Arsenio                            mailto:arsenio.star at gmail.com

>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.




>> --
>> Matthew Clegg
>> matthewcleggphd at gmail.com

>>        [[alternative HTML version deleted]]

>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.






-- 
Best regards,
 Arsenio                            mailto:arsenio.star at gmail.com


From arsenio.star at gmail.com  Fri Mar  9 05:46:45 2012
From: arsenio.star at gmail.com (Arsenio)
Date: Thu, 8 Mar 2012 20:46:45 -0800
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
	<1746887843.20120306160353@gmail.com>
	<CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
Message-ID: <1195042837.20120308204645@gmail.com>

Matthew, 

Thanks for the code! I have been trying to analyze this, seems to work ok. It's a bit hard to understand this for me, still a newbie at R.

Thanks,

Arsenio

Tuesday, March 6, 2012, 5:38:47 PM, you wrote:

> Here is another approach that might work for you.

> apply_by_groups <- function (T, cols, F, ...) {
>   # On input, T is a dataframe, and cols is a list of column names.
>   # Groups the dataframe T into groups according to the specified
>   # column names, e.g., all rows in a given group will have identical
>   # values in the specified columns.  Within each group, applies the
>   # function F to the dataframe representing that group.  Returns the
>   # list of results.
>   
>   NT <- T[do.call("order", lapply(cols, function(c) { T[,c]})),]
>   change <- function(k) { !all(NT[k-1,cols] == NT[k, cols]) }
>   starts <- which(c(TRUE, sapply(2:nrow(NT), change)))
>   ends <- c(starts[2:length(starts)]-1, nrow(NT))
>   lapply(1:length(starts), function(k) {
> F(NT[starts[k]:ends[k],,drop=FALSE], ...) })
> }
> ret <- function(X) { c(NA, X[2:length(X)]/X[1:(length(X)-1)]-1)}

>> do.call("rbind", apply_by_groups(z, "ticker", function(df) { df$ret <- ret(df$prc); df} ))
>    ticker    date_f  date   prc iticker          ret
> 1       A 20-Jun-03 15876 19.06     IXT           NA
> 2       A 23-Jun-03 15879 18.89     IXT -0.008919203
> 3       A 24-Jun-03 15880 18.75     IXT -0.007411329
> 4       A 25-Jun-03 15881 18.92     IXT  0.009066667
> 5       A 26-Jun-03 15882 19.35     IXT  0.022727273
> 6       A 27-Jun-03 15883 19.55     IXT  0.010335917
> 7      AA 20-Jun-03 15876 26.24     IXB           NA
> 8      AA 23-Jun-03 15879 25.07     IXB -0.044588415
> 9      AA 24-Jun-03 15880 24.96     IXB -0.004387714
> 10     AA 25-Jun-03 15881 24.51     IXB -0.018028846
> 11     AA 26-Jun-03 15882 25.24     IXB  0.029783762
> 12     AA 27-Jun-03 15883 25.09     IXB -0.005942948
> 13     AA 30-Jun-03 15886 25.50     IXB  0.016341172

> In the call to apply_by_groups, you can replace "ticker" with a
> list of names, e.g., c("ticker","fund","manager"), etc.

> Matthew Clegg

> On Tue, Mar 6, 2012 at 7:03 PM, Arsenio <arsenio.star at gmail.com> wrote:
> Robert,

> Thanks for the reply. I tried plm approach but apparently it only
> accepts one individual id and one time id, because this fails

>> zz=pdata.frame(z, c("Stock","Fund","Date"))
> Error in match(x, table, nomatch = 0L) :
>  'match' requires vector arguments

> Any approach that accepts several individual observation
> identifiers? I will take a look at the econometrics view on CRAN

> Btw, sorry if the post came out mangled due to HTML, didn't check.

> Thanks,

> Arsenio

> Tuesday, March 6, 2012, 5:24:35 AM, you wrote:


> Use diff and lag from plm:

> Lines="ticker date_f  date prc iticker
> A 20-Jun-03  15876 19.06 IXT
> A 23-Jun-03  15879 18.89 IXT
> A 24-Jun-03  15880 18.75 IXT
> A 25-Jun-03  15881 18.92 IXT
> A 26-Jun-03  15882 19.35 IXT
> A 27-Jun-03  15883 19.55 IXT
> AA 20-Jun-03 15876 26.24 IXB
> AA 23-Jun-03 15879 25.07 IXB
> AA 24-Jun-03 15880 24.96 IXB
> AA 25-Jun-03 15881 24.51 IXB
> AA 26-Jun-03 15882 25.24 IXB
> AA 27-Jun-03 15883 25.09 IXB
> AA 30-Jun-03 15886 25.5 IXB
> "
> z <- read.table(textConnection(Lines), header = TRUE)
> library(plm)
> zz=pdata.frame(z, c("ticker","date"))
> pr=zz$prc; str(pr)
> zz$return=diff(pr)/lag(pr)
> zz

> Good luck!

> Robert

> From: Arsenio
> Sent: Tuesday, March 06, 2012 2:47 AM
> To: r-sig-finance at r-project.org
> Subject: [R-SIG-Finance] Return calculation for panel data structure

> Dear all,

> I have a very simple question and i haven't been able to code it
> out. It's a simple return calculation of a form:
> R(t)=(P(t)-P(t-1))/P(t-1) or the same as ratio of prices minus one.
> However it's in the panel data, where stocks belong to say a fund or some other grouping variable.


> ticker
> date_f

> date
> prc
> iticker
> A
> 20-Jun-03

> 15876
> 19.06
> IXT
> A
> 23-Jun-03

> 15879
> 18.89
> IXT
> A
> 24-Jun-03

> 15880
> 18.75
> IXT
> A
> 25-Jun-03

> 15881
> 18.92
> IXT
> A
> 26-Jun-03

> 15882
> 19.35
> IXT
> A
> 27-Jun-03

> 15883
> 19.55
> IXT
> AA
> 20-Jun-03

> 15876
> 26.24
> IXB
> AA
> 23-Jun-03

> 15879
> 25.07
> IXB
> AA
> 24-Jun-03

> 15880
> 24.96
> IXB
> AA
> 25-Jun-03

> 15881
> 24.51
> IXB
> AA
> 26-Jun-03

> 15882
> 25.24
> IXB
> AA
> 27-Jun-03

> 15883
> 25.09
> IXB
> AA
> 30-Jun-03

> 15886
> 25.5
> IXB



> In  SAS, I would do it this way:

> data work.1; /* This Calcs the excluded index return for INDEX
> constructed with PRICES (PR)!!!! */
>       set work.1;
>       by ticker iticker date_f ; /*sorting by stock, fund and date */

>       lag_prc=lag(prc); /* creating the lagged price variable

>       if first.iticker then /* if the it's a first date for the grouped unit then.. */
>               lag_prc= . ; /* setting the first lagged value to
> missing if the first date for the grouped unit */
>       return = (prc - lag_prc)/ lag_prc;
>       drop lag_prc;
> run;

> The end result would be the same dataset with just one more column
> for returns for each stock, fund, date combination with the first
> return for the date set to missing.
> I tried Return.calculate type of funcs from performance analytics
> and other solutions using plyr or loops, but they are all too bulky.

> Any ideas how to accomplish this? Would appreciate any hints,

> Arsenio

> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.




> --
> Best regards,
>  Arsenio                            mailto:arsenio.star at gmail.com

> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.






-- 
Best regards,
 Arsenio                            mailto:arsenio.star at gmail.com


From enricoschumann at yahoo.de  Fri Mar  9 07:33:54 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Fri, 9 Mar 2012 07:33:54 +0100
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
Message-ID: <4F59A452.4070405@yahoo.de>



Am 08.03.2012 19:16, schrieb Michael:
> Thanks folks!
>
> After digging further on the Internet, I have the following
> questions:
>
> Q1: I read the following article:
>
> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf
>
>  It seems that there are a bunch of parameters in this optimizer and
> the results are sensitive to these parameters.
>
> So there is another layer of optimization with respect to these
> optimizer parameters.
>
> Is the "tweaking" of these optimizer parameters data-mining, which
> will lead to data-snooping bias?

No. You need to distinguish between your optimisation model on the one 
hand, and the numerical technique you use to solve the model on the 
other. And Differential Evolution (DE) is a numerical technique. If your 
model overfits, it is because of the model, not the optimisation 
technique. Suppose you wanted to estimate a linear regression, with the 
mean squared residual as the criterion of fit. Now you can compute a 
solution via QR; or if you use DE *properly*. it will give you exactly 
the same fit (up to numerical precision). Whether the model overfits, 
depends on how you set up the model, how you select the data in the 
model -- it has nothing to do with the numerical technique.

>
> Q2: Due to the random nature of the optimizer, each time you run the
> backtest, you will have different performance.
>
> What do you do in that case?

There is only one way to find out: run experiments. Put an outer loop 
around your backtest in which repeat your analysis; then you can see how 
the stochastic nature of the optimisation affects your results. In my 
view, it's not a problem: see for instance this paper

http://ssrn.com/abstract=1420058

And experiments are also the only reliable way to find out if your 
optimisation technique works properly. All described in detail in this 
book (of which I happen to be a co-author)

@BOOK{Gilli2011b,
   title = {Numerical Methods and Optimization in Finance},
   publisher = {Academic Press},
   year = {2011},
   author = {Gilli, Manfred and Maringer, Dietmar and Schumann, Enrico}
}


>
> So for out-of-sample real-trading, we are trading a random strategy?

No, again: model vs optimisation. Eventually, you have to accept some 
set of parameters for your optimisation and use these to trade.

>
> Q3: It's pretty easy to understand using Genetic Algorithms to serve
> as a replacement for regular optimizers;
>
> but using Genetic Algorithms to evolve trading strategies seem to be
> different. Anywhere we could find such an example in R?
>

What you probably mean is Genetic Programming, not Genetic Algorithms.



Regards,
Enrico

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net


>
>
>
> On Thu, Mar 8, 2012 at 8:25 AM, Zachary Mayer<zach.mayer at gmail.com>
> wrote:
>
>> There is the
>> DEoptim<http://cran.r-project.org/web/packages/DEoptim/index.html>library
>> in r, which is an excellent library for differential evolution.
>> If you can define your trading strategy in terms of a bunch of
>> parameters to adjust and an objective function (i.e. turn it into
>> an optimization problem), DEoptim will help you find the minimum
>> (or maximum).
>>
>> DEoptim works well on non-differentiable problems with many local
>> minima. Here is an example of using it to solve a portfolio
>> optimization problem:
>>
>> http://cran.r-project.org/web/packages/DEoptim/vignettes/DEoptimPortfolioOptimization.pdf
>>
>>
>>
>>
>>
On Thu, Mar 8, 2012 at 12:43 AM, Sofian 
Hadiwijaya<reztinpeace at gmail.com>wrote:
>>
>>> how about quantmod library..
>>>
>>> On Wed, Mar 7, 2012 at 10:30 PM, Michael<comtech.usa at gmail.com>
>>> wrote:
>>>
>>>> Hi all, Good morning, good afternoon and good evening!
>>>>
>>>> Could anybody please kindly point me to resources in R which
>>>> shows about how to use Genetic algorithm to evolve trading
>>>> strategies?
>>>>
>>>> I did a lot search on Google these days and certainly it's a
>>> well-covered
>>>> and popular topic, but I don't see anywhere in R...
>>>>
>>>> Thanks a lot!
>>>>
>


From matthewcleggphd at gmail.com  Fri Mar  9 14:07:06 2012
From: matthewcleggphd at gmail.com (Matthew Clegg)
Date: Fri, 9 Mar 2012 08:07:06 -0500
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <1195042837.20120308204645@gmail.com>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
	<1746887843.20120306160353@gmail.com>
	<CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
	<1195042837.20120308204645@gmail.com>
Message-ID: <CABLRk0Em6OM82yUm2RBhu1ArEYBpdGcqTPd-RH09-Vc9ei5H-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120309/43456f59/attachment.pl>

From sebastian.steins at gmail.com  Fri Mar  9 15:38:02 2012
From: sebastian.steins at gmail.com (Sebastian Steins)
Date: Fri, 9 Mar 2012 15:38:02 +0100
Subject: [R-SIG-Finance] Anyone can help with backtesting?
Message-ID: <CALT4G4z_YFg18Jxo8v7kUB7zz++jZ_5CF+1uW_OrEmX=qmAYRA@mail.gmail.com>

Hi,

I am currently trying to think about some investment strategies which
I want to backtest in R. So I found this toolbox as a great tool for
doing so: http://systematicinvestor.wordpress.com/2011/11/25/introduction-to-backtesting-library-in-the-systematic-investor-toolbox/

However, since I am not that familiar with R and the way you create
the strategies in code, I am a bit confused on how to implement my
idea.

The idea is the following:

There are two basis modules of the portfolio, which should be weighted
about 40:60. To keep things simple at first, think of those modules as
of two strategies, the first one is the rotational trading strategy
(ranked by low volatility)[A], the second one is basically the same
strategy, but ranked by high performance[B].
After one year there should be done something specifically. At the
first day in any new year:
- if the overall profit of module A and B is greater than 0, positions
should be sold until the initial 4:6 ratio is reached again. The free
capital should then be invested in an fixed income ETF.
- if the overall profit of module A and B is less than 0, nothing
should be done.
- If there is any profit in the fixed income ETF, at the first day in
any year positions in the ETF should be closed, the free capital
should then be invested again in modules A, B according to their 4:6
weights.

Can you give me any hints on how to implement such a thing, with the
toolbox mentioned above or in any other way? At the moment I do not
even know how to start.


Thank you for your kind support!


Sebastian


From j_cuisinier at hotmail.com  Fri Mar  9 17:13:47 2012
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Fri, 9 Mar 2012 17:13:47 +0100
Subject: [R-SIG-Finance] Anyone can help with backtesting?
In-Reply-To: <CALT4G4z_YFg18Jxo8v7kUB7zz++jZ_5CF+1uW_OrEmX=qmAYRA@mail.gmail.com>
References: <CALT4G4z_YFg18Jxo8v7kUB7zz++jZ_5CF+1uW_OrEmX=qmAYRA@mail.gmail.com>
Message-ID: <COL102-W13A06388A8C424A294F38A8F540@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120309/cda25032/attachment.pl>

From jeffrey.ryan at lemnica.com  Fri Mar  9 17:16:39 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 9 Mar 2012 10:16:39 -0600
Subject: [R-SIG-Finance] Return calculation for panel data structure
In-Reply-To: <1229570413.20120308204319@gmail.com>
References: <2510733673.20120305214726@gmail.com>
	<8FAD6852C08548C9A7CA5EC978F3BCE2@DellPC>
	<1746887843.20120306160353@gmail.com>
	<CABLRk0EgidUcgobP98y8PWLUV4YBezBYYkoVZ8R_fXxHUAitaQ@mail.gmail.com>
	<CABDUZc9xR7qanzzzdfVRzUaq9FOTziqrf74Lys3sJ=kLgj7vtA@mail.gmail.com>
	<1229570413.20120308204319@gmail.com>
Message-ID: <CABDUZc81gyVBOEdr8d48K-js0BUgW2szH9CUgcO6OYSz9VsESw@mail.gmail.com>

It should work, but you didn't provide the data that it is breaking on, so...

Hijacking the iticker column, we can make that our second identifier
to group with:

z <- rbind(z,transform(z,iticker=paste(iticker,2,sep="")))

#... some z to see what this is doing
#
#11     AA 26-Jun-03 15882 25.24     IXB
#12     AA 27-Jun-03 15883 25.09     IXB
#13     AA 30-Jun-03 15886 25.50     IXB
#14      A 20-Jun-03 15876 19.06    IXT2
#15      A 23-Jun-03 15879 18.89    IXT2
#16      A 24-Jun-03 15880 18.75    IXT2
#17      A 25-Jun-03 15881 18.92    IXT2
#...

And now to get return calculations by ticker, iticker do this:

> cbind(z,do.call(rbind,lapply(split(z,list(z$ticker,z$iticker)), function(x) Delt(x$prc))))

   ticker    date_f  date   prc iticker Delt.1.arithmetic
1       A 20-Jun-03 15876 19.06     IXT                NA
2       A 23-Jun-03 15879 18.89     IXT      -0.044588415
3       A 24-Jun-03 15880 18.75     IXT      -0.004387714
4       A 25-Jun-03 15881 18.92     IXT      -0.018028846
5       A 26-Jun-03 15882 19.35     IXT       0.029783762
6       A 27-Jun-03 15883 19.55     IXT      -0.005942948
7      AA 20-Jun-03 15876 26.24     IXB       0.016341172
8      AA 23-Jun-03 15879 25.07     IXB                NA
9      AA 24-Jun-03 15880 24.96     IXB      -0.008919203
10     AA 25-Jun-03 15881 24.51     IXB      -0.007411329
11     AA 26-Jun-03 15882 25.24     IXB       0.009066667
12     AA 27-Jun-03 15883 25.09     IXB       0.022727273
13     AA 30-Jun-03 15886 25.50     IXB       0.010335917
14      A 20-Jun-03 15876 19.06    IXT2                NA
15      A 23-Jun-03 15879 18.89    IXT2      -0.008919203
16      A 24-Jun-03 15880 18.75    IXT2      -0.007411329
17      A 25-Jun-03 15881 18.92    IXT2       0.009066667
18      A 26-Jun-03 15882 19.35    IXT2       0.022727273
19      A 27-Jun-03 15883 19.55    IXT2       0.010335917
20     AA 20-Jun-03 15876 26.24    IXB2                NA
21     AA 23-Jun-03 15879 25.07    IXB2      -0.044588415
22     AA 24-Jun-03 15880 24.96    IXB2      -0.004387714
23     AA 25-Jun-03 15881 24.51    IXB2      -0.018028846
24     AA 26-Jun-03 15882 25.24    IXB2       0.029783762
25     AA 27-Jun-03 15883 25.09    IXB2      -0.005942948
26     AA 30-Jun-03 15886 25.50    IXB2       0.016341172

If you have a missing value in one of your identifiers (a factor
here), you will get an error, but na.omit() called on 'z' will remove
it before processing. If you don't have the value I don't see how you
could properly group it anyway though.

As far as 'base R being too complicated for SAS users' ;-) ... I still
think you are much better off sticking as close to the core language
as you can - as that gives you the most understanding and flexibility.
 You could also functionalize the scary parts:

make_it_happen <- function(z) {
   require("quantmod")
   cbind(z,do.call(rbind,lapply(split(z,list(z$ticker,z$iticker)),
function(x) Delt(x$prc))))
}
make_it_happen(z)


Joking aside, the code is actually not bad if you take it apart as
Matthew did with his.

1) split(z, list(z$ticker, z$iticker))
returns a list of data.frames that are grouped by your identifiers
(factors in R-speak)

2) lapply uses each element in the list and applies the function(x) ... to it.

3) do.call(rbind takes the list returned by lapply (columns of
returns) and row binds them

4) cbind just attached the new column from (3) to the original 'z'

With that, we've diverged pretty hard from "finance" - so further
questions should probably be sent to R-help.

HTH
Jeff

On Thu, Mar 8, 2012 at 10:43 PM, Arsenio <arsenio.star at gmail.com> wrote:
> Jeffrey,
>
> Thanks a lot!
> I tried this code worked for the single grouping factor variable, now testing it with two which means apparently they have to cover the whole dataset, maybe NA in one of the variable not allowed by the ?split ?
>
> Warning message:
> In split.default(seq_len(nrow(x)), f, drop = drop, ...) :
> ?data length is not a multiple of split variable
>
> I was looking for something simpler that would also help to understand the code for peers working in SAS, so base R would be a bit too complicated.
>
> Thanks for the Delt function that's quite a shortcut!
>
> Arsenio
>
>
>
> Wednesday, March 7, 2012, 8:14:31 AM, you wrote:
>
>> Built into R is ?split or ?aggregate and ?lapply which should serve you well.
>
>> Using base R is often the fastest way to skin the cat, if not the prettiest ;-)
>
>
>>> library(quantmod) ? # for Delt
>>> cbind(z,do.call(rbind,lapply(split(z,z$ticker), function(x) Delt(x$prc))))
>
>> ?ticker ? ?date_f ?date ? prc iticker Delt.1.arithmetic
>> 1 ? ? ? A 20-Jun-03 15876 19.06 ? ? IXT ? ? ? ? ? ? ? ?NA
>> 2 ? ? ? A 23-Jun-03 15879 18.89 ? ? IXT ? ? ?-0.008919203
>> 3 ? ? ? A 24-Jun-03 15880 18.75 ? ? IXT ? ? ?-0.007411329
>> 4 ? ? ? A 25-Jun-03 15881 18.92 ? ? IXT ? ? ? 0.009066667
>> 5 ? ? ? A 26-Jun-03 15882 19.35 ? ? IXT ? ? ? 0.022727273
>> 6 ? ? ? A 27-Jun-03 15883 19.55 ? ? IXT ? ? ? 0.010335917
>> 7 ? ? ?AA 20-Jun-03 15876 26.24 ? ? IXB ? ? ? ? ? ? ? ?NA
>> 8 ? ? ?AA 23-Jun-03 15879 25.07 ? ? IXB ? ? ?-0.044588415
>> 9 ? ? ?AA 24-Jun-03 15880 24.96 ? ? IXB ? ? ?-0.004387714
>> 10 ? ? AA 25-Jun-03 15881 24.51 ? ? IXB ? ? ?-0.018028846
>> 11 ? ? AA 26-Jun-03 15882 25.24 ? ? IXB ? ? ? 0.029783762
>> 12 ? ? AA 27-Jun-03 15883 25.09 ? ? IXB ? ? ?-0.005942948
>> 13 ? ? AA 30-Jun-03 15886 25.50 ? ? IXB ? ? ? 0.016341172
>
>> See ?split for details on multiple identifiers ( just a list, but your
>> example didn't include it so I won't either)
>
>> The do.call(rbind/cbind stuff is just to get the original data.frame
>> back - there are more verbose ways to do the same thing.
>
>> Jeff
>
>
>> On Tue, Mar 6, 2012 at 7:38 PM, Matthew Clegg
>> <matthewcleggphd at gmail.com> wrote:
>>> Here is another approach that might work for you.
>
>>> apply_by_groups <- function (T, cols, F, ...) {
>>> ?# On input, T is a dataframe, and cols is a list of column names.
>>> ?# Groups the dataframe T into groups according to the specified
>>> ?# column names, e.g., all rows in a given group will have identical
>>> ?# values in the specified columns. ?Within each group, applies the
>>> ?# function F to the dataframe representing that group. ?Returns the
>>> ?# list of results.
>
>>> ?NT <- T[do.call("order", lapply(cols, function(c) { T[,c]})),]
>>> ?change <- function(k) { !all(NT[k-1,cols] == NT[k, cols]) }
>>> ?starts <- which(c(TRUE, sapply(2:nrow(NT), change)))
>>> ?ends <- c(starts[2:length(starts)]-1, nrow(NT))
>>> ?lapply(1:length(starts), function(k) {
>>> F(NT[starts[k]:ends[k],,drop=FALSE], ...) })
>>> }
>>> ret <- function(X) { c(NA, X[2:length(X)]/X[1:(length(X)-1)]-1)}
>
>>>> do.call("rbind", apply_by_groups(z, "ticker", function(df) { df$ret <-
>>> ret(df$prc); df} ))
>>> ? ticker ? ?date_f ?date ? prc iticker ? ? ? ? ?ret
>>> 1 ? ? ? A 20-Jun-03 15876 19.06 ? ? IXT ? ? ? ? ? NA
>>> 2 ? ? ? A 23-Jun-03 15879 18.89 ? ? IXT -0.008919203
>>> 3 ? ? ? A 24-Jun-03 15880 18.75 ? ? IXT -0.007411329
>>> 4 ? ? ? A 25-Jun-03 15881 18.92 ? ? IXT ?0.009066667
>>> 5 ? ? ? A 26-Jun-03 15882 19.35 ? ? IXT ?0.022727273
>>> 6 ? ? ? A 27-Jun-03 15883 19.55 ? ? IXT ?0.010335917
>>> 7 ? ? ?AA 20-Jun-03 15876 26.24 ? ? IXB ? ? ? ? ? NA
>>> 8 ? ? ?AA 23-Jun-03 15879 25.07 ? ? IXB -0.044588415
>>> 9 ? ? ?AA 24-Jun-03 15880 24.96 ? ? IXB -0.004387714
>>> 10 ? ? AA 25-Jun-03 15881 24.51 ? ? IXB -0.018028846
>>> 11 ? ? AA 26-Jun-03 15882 25.24 ? ? IXB ?0.029783762
>>> 12 ? ? AA 27-Jun-03 15883 25.09 ? ? IXB -0.005942948
>>> 13 ? ? AA 30-Jun-03 15886 25.50 ? ? IXB ?0.016341172
>
>>> In the call to apply_by_groups, you can replace "ticker" with a list of
>>> names, e.g., c("ticker","fund","manager"), etc.
>
>>> Matthew Clegg
>
>>> On Tue, Mar 6, 2012 at 7:03 PM, Arsenio <arsenio.star at gmail.com> wrote:
>
>>>> Robert,
>
>>>> Thanks for the reply. I tried plm approach but apparently it only accepts
>>>> one individual id and one time id, because this fails
>
>>>> > zz=pdata.frame(z, c("Stock","Fund","Date"))
>>>> Error in match(x, table, nomatch = 0L) :
>>>> ?'match' requires vector arguments
>
>>>> Any approach that accepts several individual observation identifiers? I
>>>> will take a look at the econometrics view on CRAN
>
>>>> Btw, sorry if the post came out mangled due to HTML, didn't check.
>
>>>> Thanks,
>
>>>> Arsenio
>
>>>> Tuesday, March 6, 2012, 5:24:35 AM, you wrote:
>
>
>>>> Use diff and lag from plm:
>
>>>> Lines="ticker date_f ?date prc iticker
>>>> A 20-Jun-03 ?15876 19.06 IXT
>>>> A 23-Jun-03 ?15879 18.89 IXT
>>>> A 24-Jun-03 ?15880 18.75 IXT
>>>> A 25-Jun-03 ?15881 18.92 IXT
>>>> A 26-Jun-03 ?15882 19.35 IXT
>>>> A 27-Jun-03 ?15883 19.55 IXT
>>>> AA 20-Jun-03 15876 26.24 IXB
>>>> AA 23-Jun-03 15879 25.07 IXB
>>>> AA 24-Jun-03 15880 24.96 IXB
>>>> AA 25-Jun-03 15881 24.51 IXB
>>>> AA 26-Jun-03 15882 25.24 IXB
>>>> AA 27-Jun-03 15883 25.09 IXB
>>>> AA 30-Jun-03 15886 25.5 IXB
>>>> "
>>>> z <- read.table(textConnection(Lines), header = TRUE)
>>>> library(plm)
>>>> zz=pdata.frame(z, c("ticker","date"))
>>>> pr=zz$prc; str(pr)
>>>> zz$return=diff(pr)/lag(pr)
>>>> zz
>
>>>> Good luck!
>
>>>> Robert
>
>>>> From: Arsenio
>>>> Sent: Tuesday, March 06, 2012 2:47 AM
>>>> To: r-sig-finance at r-project.org
>>>> Subject: [R-SIG-Finance] Return calculation for panel data structure
>
>>>> Dear all,
>
>>>> I have a very simple question and i haven't been able to code it out. It's
>>>> a simple return calculation of a form:
>>>> R(t)=(P(t)-P(t-1))/P(t-1) or the same as ratio of prices minus one.
>>>> However it's in the panel data, where stocks belong to say a fund or some
>>>> other grouping variable.
>
>
>>>> ticker
>>>> date_f
>
>>>> date
>>>> prc
>>>> iticker
>>>> A
>>>> 20-Jun-03
>
>>>> 15876
>>>> 19.06
>>>> IXT
>>>> A
>>>> 23-Jun-03
>
>>>> 15879
>>>> 18.89
>>>> IXT
>>>> A
>>>> 24-Jun-03
>
>>>> 15880
>>>> 18.75
>>>> IXT
>>>> A
>>>> 25-Jun-03
>
>>>> 15881
>>>> 18.92
>>>> IXT
>>>> A
>>>> 26-Jun-03
>
>>>> 15882
>>>> 19.35
>>>> IXT
>>>> A
>>>> 27-Jun-03
>
>>>> 15883
>>>> 19.55
>>>> IXT
>>>> AA
>>>> 20-Jun-03
>
>>>> 15876
>>>> 26.24
>>>> IXB
>>>> AA
>>>> 23-Jun-03
>
>>>> 15879
>>>> 25.07
>>>> IXB
>>>> AA
>>>> 24-Jun-03
>
>>>> 15880
>>>> 24.96
>>>> IXB
>>>> AA
>>>> 25-Jun-03
>
>>>> 15881
>>>> 24.51
>>>> IXB
>>>> AA
>>>> 26-Jun-03
>
>>>> 15882
>>>> 25.24
>>>> IXB
>>>> AA
>>>> 27-Jun-03
>
>>>> 15883
>>>> 25.09
>>>> IXB
>>>> AA
>>>> 30-Jun-03
>
>>>> 15886
>>>> 25.5
>>>> IXB
>
>
>
>>>> In ?SAS, I would do it this way:
>
>>>> data work.1; /* This Calcs the excluded index return for INDEX constructed
>>>> with PRICES (PR)!!!! */
>>>> ? ? ? set work.1;
>>>> ? ? ? by ticker iticker date_f ; /*sorting by stock, fund and date */
>
>>>> ? ? ? lag_prc=lag(prc); /* creating the lagged price variable
>
>>>> ? ? ? if first.iticker then /* if the it's a first date for the grouped
>>>> unit then.. */
>>>> ? ? ? ? ? ? ? lag_prc= . ; /* setting the first lagged value to missing if
>>>> the first date for the grouped unit */
>>>> ? ? ? return = (prc - lag_prc)/ lag_prc;
>>>> ? ? ? drop lag_prc;
>>>> run;
>
>>>> The end result would be the same dataset with just one more column for
>>>> returns for each stock, fund, date combination with the first return for
>>>> the date set to missing.
>>>> I tried Return.calculate type of funcs from performance analytics and
>>>> other solutions using plyr or loops, but they are all too bulky.
>
>>>> Any ideas how to accomplish this? Would appreciate any hints,
>
>>>> Arsenio
>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>
>
>
>
>>>> --
>>>> Best regards,
>>>> ?Arsenio ? ? ? ? ? ? ? ? ? ? ? ? ? ?mailto:arsenio.star at gmail.com
>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>
>
>
>
>>> --
>>> Matthew Clegg
>>> matthewcleggphd at gmail.com
>
>>> ? ? ? ?[[alternative HTML version deleted]]
>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
>
>
> --
> Best regards,
> ?Arsenio ? ? ? ? ? ? ? ? ? ? ? ? ? ?mailto:arsenio.star at gmail.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From sebastian.steins at gmail.com  Fri Mar  9 17:21:03 2012
From: sebastian.steins at gmail.com (Sebastian Steins)
Date: Fri, 9 Mar 2012 17:21:03 +0100
Subject: [R-SIG-Finance] Anyone can help with backtesting?
In-Reply-To: <COL102-W13A06388A8C424A294F38A8F540@phx.gbl>
References: <CALT4G4z_YFg18Jxo8v7kUB7zz++jZ_5CF+1uW_OrEmX=qmAYRA@mail.gmail.com>
	<COL102-W13A06388A8C424A294F38A8F540@phx.gbl>
Message-ID: <CALT4G4zT4+1+sWdndwW+m5dFKcyQBs1UGYuYOvGtH56Gb0FsxQ@mail.gmail.com>

Anyway, what would be the way to implement such a strategy in quantstrat?

On Fri, Mar 9, 2012 at 5:13 PM, julien cuisinier
<j_cuisinier at hotmail.com> wrote:
> I do not know this package (so it could be brilliant) but I would go for
> quantstrat instead, seems more used / followed and hence less bug prone I
> guess
>
>
>
>> Date: Fri, 9 Mar 2012 15:38:02 +0100
>> From: sebastian.steins at gmail.com
>> To: r-sig-finance at r-project.org
>> Subject: [R-SIG-Finance] Anyone can help with backtesting?
>
>>
>> Hi,
>>
>> I am currently trying to think about some investment strategies which
>> I want to backtest in R. So I found this toolbox as a great tool for
>> doing so:
>> http://systematicinvestor.wordpress.com/2011/11/25/introduction-to-backtesting-library-in-the-systematic-investor-toolbox/
>>
>> However, since I am not that familiar with R and the way you create
>> the strategies in code, I am a bit confused on how to implement my
>> idea.
>>
>> The idea is the following:
>>
>> There are two basis modules of the portfolio, which should be weighted
>> about 40:60. To keep things simple at first, think of those modules as
>> of two strategies, the first one is the rotational trading strategy
>> (ranked by low volatility)[A], the second one is basically the same
>> strategy, but ranked by high performance[B].
>> After one year there should be done something specifically. At the
>> first day in any new year:
>> - if the overall profit of module A and B is greater than 0, positions
>> should be sold until the initial 4:6 ratio is reached again. The free
>> capital should then be invested in an fixed income ETF.
>> - if the overall profit of module A and B is less than 0, nothing
>> should be done.
>> - If there is any profit in the fixed income ETF, at the first day in
>> any year positions in the ETF should be closed, the free capital
>> should then be invested again in modules A, B according to their 4:6
>> weights.
>>
>> Can you give me any hints on how to implement such a thing, with the
>> toolbox mentioned above or in any other way? At the moment I do not
>> even know how to start.
>>
>>
>> Thank you for your kind support!
>>
>>
>> Sebastian
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.


From jeffrey.ryan at lemnica.com  Fri Mar  9 17:25:47 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Fri, 9 Mar 2012 10:25:47 -0600
Subject: [R-SIG-Finance] Anyone can help with backtesting?
In-Reply-To: <CALT4G4zT4+1+sWdndwW+m5dFKcyQBs1UGYuYOvGtH56Gb0FsxQ@mail.gmail.com>
References: <CALT4G4z_YFg18Jxo8v7kUB7zz++jZ_5CF+1uW_OrEmX=qmAYRA@mail.gmail.com>
	<COL102-W13A06388A8C424A294F38A8F540@phx.gbl>
	<CALT4G4zT4+1+sWdndwW+m5dFKcyQBs1UGYuYOvGtH56Gb0FsxQ@mail.gmail.com>
Message-ID: <CABDUZc-72HXg6=9Ve6ueACu0=BFTwBAzscLV8=PBgZk6QdWrWg@mail.gmail.com>

For quantstrat there is _copious_ documentation in the demos and on this list.

You'll also be advised to get familiar with R if you intend on using
R.  Myriad of sources for this as well, including some good books out
there.  No books cover quantstrat at present, though Data Mining with
R by Torgo has a large chapter using quantmod/xts and custom code
which is a decent place to see how things work without the niceties of
quanstrat as a strategy abstraction.

R Cookbook by Teetor is also a nice intro to R.

Jeff

On Fri, Mar 9, 2012 at 10:21 AM, Sebastian Steins
<sebastian.steins at gmail.com> wrote:
> Anyway, what would be the way to implement such a strategy in quantstrat?
>
> On Fri, Mar 9, 2012 at 5:13 PM, julien cuisinier
> <j_cuisinier at hotmail.com> wrote:
>> I do not know this package (so it could be brilliant) but I would go for
>> quantstrat instead, seems more used / followed and hence less bug prone I
>> guess
>>
>>
>>
>>> Date: Fri, 9 Mar 2012 15:38:02 +0100
>>> From: sebastian.steins at gmail.com
>>> To: r-sig-finance at r-project.org
>>> Subject: [R-SIG-Finance] Anyone can help with backtesting?
>>
>>>
>>> Hi,
>>>
>>> I am currently trying to think about some investment strategies which
>>> I want to backtest in R. So I found this toolbox as a great tool for
>>> doing so:
>>> http://systematicinvestor.wordpress.com/2011/11/25/introduction-to-backtesting-library-in-the-systematic-investor-toolbox/
>>>
>>> However, since I am not that familiar with R and the way you create
>>> the strategies in code, I am a bit confused on how to implement my
>>> idea.
>>>
>>> The idea is the following:
>>>
>>> There are two basis modules of the portfolio, which should be weighted
>>> about 40:60. To keep things simple at first, think of those modules as
>>> of two strategies, the first one is the rotational trading strategy
>>> (ranked by low volatility)[A], the second one is basically the same
>>> strategy, but ranked by high performance[B].
>>> After one year there should be done something specifically. At the
>>> first day in any new year:
>>> - if the overall profit of module A and B is greater than 0, positions
>>> should be sold until the initial 4:6 ratio is reached again. The free
>>> capital should then be invested in an fixed income ETF.
>>> - if the overall profit of module A and B is less than 0, nothing
>>> should be done.
>>> - If there is any profit in the fixed income ETF, at the first day in
>>> any year positions in the ETF should be closed, the free capital
>>> should then be invested again in modules A, B according to their 4:6
>>> weights.
>>>
>>> Can you give me any hints on how to implement such a thing, with the
>>> toolbox mentioned above or in any other way? At the moment I do not
>>> even know how to start.
>>>
>>>
>>> Thank you for your kind support!
>>>
>>>
>>> Sebastian
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From gaurav_m_159 at yahoo.com  Sat Mar 10 04:49:25 2012
From: gaurav_m_159 at yahoo.com (Gaurav Malhotra)
Date: Fri, 9 Mar 2012 19:49:25 -0800
Subject: [R-SIG-Finance] ranking xts objects
Message-ID: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120309/f96180a3/attachment.pl>

From jeffrey.ryan at lemnica.com  Sat Mar 10 09:04:53 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Sat, 10 Mar 2012 02:04:53 -0600
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
Message-ID: <CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>

I don't see exactly why you are doing this (been a long day), but I
think you want something like after reading your question (ignoring
your example):

t(apply(data,1,rank))              # t() just makes it look more like
the original xts

           GE.Close XOM.Close GOOG.Close XLU.Close
2005-01-31        2         3          4         1
2005-02-28        2         3          4         1
2005-03-31        2         3          4         1
2005-04-30        2         3          4         1
2005-05-31        2         3          4         1
2005-06-30        2         3          4         1
2005-07-31        2         3          4         1
2005-08-31        2         3          4         1
2005-09-30        2         3          4         1
2005-10-31        2         3          4         1
2005-11-30        2         3          4         1
2005-12-31        2         3          4         1
2006-01-31        2         3          4         1
2006-02-28        2         3          4         1
2006-03-31        2         3          4         1
2006-04-30        2         3          4         1
2006-05-31        2         3          4         1
2006-06-30        2         3          4         1
2006-07-31        1         3          4         2
2006-08-31        1         3          4         2
2006-09-30        2         3          4         1
2006-10-31        1         3          4         2
2006-11-30        1         3          4         2
2006-12-31        2         3          4         1
2007-01-31        1         3          4         2
2007-02-28        1         3          4         2
2007-03-31        1         3          4         2
2007-04-30        1         3          4         2
2007-05-31        1         3          4         2
2007-06-30        1         3          4         2
2007-07-31        2         3          4         1
2007-08-31        2         3          4         1
2007-09-30        2         3          4         1
2007-10-31        1         3          4         2
2007-11-30        1         3          4         2
2007-12-31        1         3          4         2
2008-01-31        1         3          4         2
2008-02-29        1         3          4         2
2008-03-31        1         3          4         2
2008-04-30        1         3          4         2
2008-05-31        1         3          4         2
2008-06-30        1         3          4         2
2008-07-31        1         3          4         2
2008-08-31        1         3          4         2
2008-09-30        1         3          4         2
2008-10-31        1         3          4         2
2008-11-30        1         3          4         2
2008-12-31        1         3          4         2
2009-01-31        1         3          4         2
2009-02-28        1         3          4         2
2009-03-31        1         3          4         2
2009-04-30        1         3          4         2
2009-05-31        1         3          4         2
2009-06-30        1         3          4         2
2009-07-31        1         3          4         2
2009-08-31        1         3          4         2
2009-09-30        1         3          4         2
2009-10-31        1         3          4         2
2009-11-30        1         3          4         2
2009-12-31        1         3          4         2
2010-01-31        1         3          4         2
2010-02-28        1         3          4         2
2010-03-31        1         3          4         2
2010-04-30        1         3          4         2
2010-05-31        1         3          4         2
2010-06-30        1         3          4         2
2010-07-31        1         3          4         2
2010-08-31        1         3          4         2
2010-09-30        1         3          4         2
2010-10-31        1         3          4         2
2010-11-30        1         3          4         2
2010-12-31        1         3          4         2
2011-01-31        1         3          4         2
2011-02-28        1         3          4         2
2011-03-31        1         3          4         2
2011-04-30        1         3          4         2
2011-05-31        1         3          4         2
2011-06-30        1         3          4         2
2011-07-31        1         3          4         2
2011-08-31        1         3          4         2
2011-09-30        1         3          4         2
2011-10-31        1         3          4         2
2011-11-30        1         3          4         2
2011-12-31        1         3          4         2
2012-01-31        1         3          4         2
2012-02-29        1         3          4         2
2012-03-31        1         3          4         2
>

Hopefully I am close, and that this helps in some way,
Jeff

On Fri, Mar 9, 2012 at 9:49 PM, Gaurav Malhotra <gaurav_m_159 at yahoo.com> wrote:
> Hi,
>
> I've been trying to rank stocks by month/time period. The code I have below is ranking each stock over its range, instead of going across and ranking row by row
>
>
>
> symbols= c("GE","XOM","GOOG","XLU")
> getSymbols(symbols, src='yahoo', index.class=c("POSIXt","POSIXct"), from='2005-01-01')
>
> for(symbolinsymbols) {
> ? ? x<-get(symbol)
> ? ? x<-to.monthly(x,indexAt='lastof',drop.time=TRUE)
> ? ? indexFormat(x)<-'%Y-%m-%d'
> ? ? colnames(x)<-gsub("x",symbol,colnames(x))
> ? ? assign(symbol,x)
> }
>
> data<-cbind(Cl(GE),Cl(XOM),Cl(GOOG),Cl(XLU))
>
> NewVar<-cut(x,quantile(x,(0:10)/10),include.lowest=TRUE)
>
>
>
> How do I modify this so that I get the ranks for each time stamp?
>
> Thanks!
>
> Gaurav M
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From gaurav_m_159 at yahoo.com  Sat Mar 10 20:40:08 2012
From: gaurav_m_159 at yahoo.com (Gaurav Malhotra)
Date: Sat, 10 Mar 2012 11:40:08 -0800
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
	<CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
Message-ID: <1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120310/ceeb86fd/attachment.pl>

From brian at braverock.com  Sat Mar 10 23:03:19 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 10 Mar 2012 17:03:19 -0500
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
	<CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
	<1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>
Message-ID: <c7402d6d-1c91-437c-98ff-64ca9e8279a5@email.android.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120310/0654677e/attachment.pl>

From gaurav_m_159 at yahoo.com  Sat Mar 10 23:35:46 2012
From: gaurav_m_159 at yahoo.com (Gaurav Malhotra)
Date: Sat, 10 Mar 2012 14:35:46 -0800
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <c7402d6d-1c91-437c-98ff-64ca9e8279a5@email.android.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
	<CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
	<1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>
	<c7402d6d-1c91-437c-98ff-64ca9e8279a5@email.android.com>
Message-ID: <1331418946.40911.YahooMailNeo@web113610.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120310/8b21ca13/attachment.pl>

From brian at braverock.com  Sat Mar 10 23:53:14 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 10 Mar 2012 17:53:14 -0500
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <1331418946.40911.YahooMailNeo@web113610.mail.gq1.yahoo.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
	<CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
	<1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>
	<c7402d6d-1c91-437c-98ff-64ca9e8279a5@email.android.com>
	<1331418946.40911.YahooMailNeo@web113610.mail.gq1.yahoo.com>
Message-ID: <78375587-b4df-4a5f-8bfb-514724bddaf7@email.android.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120310/dce5d04e/attachment.pl>

From gaurav_m_159 at yahoo.com  Mon Mar 12 21:17:15 2012
From: gaurav_m_159 at yahoo.com (Gaurav Malhotra)
Date: Mon, 12 Mar 2012 13:17:15 -0700
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <c7402d6d-1c91-437c-98ff-64ca9e8279a5@email.android.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
	<CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
	<1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>
	<c7402d6d-1c91-437c-98ff-64ca9e8279a5@email.android.com>
Message-ID: <1331583435.63463.YahooMailNeo@web113616.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120312/20d40e9f/attachment.pl>

From brian at braverock.com  Mon Mar 12 22:22:50 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 12 Mar 2012 16:22:50 -0500
Subject: [R-SIG-Finance] ranking xts objects
In-Reply-To: <1331583435.63463.YahooMailNeo@web113616.mail.gq1.yahoo.com>
References: <1331351365.45217.YahooMailNeo@web113620.mail.gq1.yahoo.com>
	<CABDUZc9KR-2OHHLMV-BoQ0z=Qiv9DE2P-6iSu2evH6iCzw2WJA@mail.gmail.com>
	<1331408408.26668.YahooMailNeo@web113612.mail.gq1.yahoo.com>
	<1331583435.63463.YahooMailNeo@web113616.mail.gq1.yahoo.com>
Message-ID: <1331587370.28362.310.camel@brian-rcg>

On Mon, 2012-03-12 at 13:17 -0700, Gaurav Malhotra wrote:
> Brian and Jeff ,
> 
> Thanks a lot! I did manage to get a whole lot closer to what I wish to achieve. Right now I'm mulling over two things... one is how can you have the weights reflect a "holding" period.. I'm thinking an if else such that if -1, set to 0 in 3 periods, if +1, set to zero in 3 periods, else zero - might do the trick.
> 
> The second thing is related to the first. In Return.rebalancing/Return.portofolio, if the input object is a (past) 3 month return xts, how does one interpret the results? Does it mean that on a 3 month basis, the function gives me my returns? If this is the case, then this would negate the need for the holding period stuff described above I assume.
> 
> However, the results of the function based on the 3 month returns seemed to be ungodly, and I'm still unsure as to what they represent. Should I only be using one-month returns as the inputs here?

You had previously stipulated that you wanted to rank and rebalance
every three months (or something like that).

The rankings at each of your rebalancing periods choose your weights,
top 10% rank, long, bottom 10% rank, short.  I already told you
approximately how to do this with an ifelse statement

Holding period is determined simply by when you no longer have that
weight.  You will change when the rank changes, and not before.

Return.rebalancing takes an xts object of rebalancing dates.  On those
dates, the portfolio is rebalanced to the specified weights.  After
that, the weights float naturally based on their own returns.  Use
whatever you want to create the new weights at the rebalancing periods,
but there's no reason that the object you apply it to couldn't be daily
returns.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From mamushbukana at gmail.com  Tue Mar 13 13:30:07 2012
From: mamushbukana at gmail.com (mamush bukana)
Date: Tue, 13 Mar 2012 12:30:07 +0000
Subject: [R-SIG-Finance] rmgarch arguments
Message-ID: <CAFxDEqJ+fBCQ4dTGFYD=KSVnqogATYOGBCN_MAT5X6ejp9KHsA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/fa748b2e/attachment.pl>

From alexios at 4dscape.com  Tue Mar 13 14:28:41 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Tue, 13 Mar 2012 13:28:41 +0000
Subject: [R-SIG-Finance] rmgarch arguments
In-Reply-To: <CAFxDEqJ+fBCQ4dTGFYD=KSVnqogATYOGBCN_MAT5X6ejp9KHsA@mail.gmail.com>
References: <CAFxDEqJ+fBCQ4dTGFYD=KSVnqogATYOGBCN_MAT5X6ejp9KHsA@mail.gmail.com>
Message-ID: <4F5F4B89.4090704@4dscape.com>

Mamush,

The dccOrder is simply the autoregressive order of the DCC model (I 
though it was self explanatory). If you are unsure about DCC models,
the help (?dccspec) contains a list of references to the relevant 
literature which you might like to consult.

Regards,
Alexios


On 13/03/2012 12:30, mamush bukana wrote:
> Dear all,
> As a beginner to R, specially to rmgarch package, I have been struggling to
> understand what the arguments in "dccspec", "dccfit", "dccforecast" and
>   "dccsim" functions are for. Thanks to Alexios and the "help()" in R, I am
> getting used to some of them.
> But still I can't understand what the "dccOrder" argument in the "dccspec"
> function is for? May one explain this for me please?
>
> My objective is to estimate and simulate a VAR(2) model allowing for GARCH
> effect in its innovations:
> X_t =A1*X_{t-1} + A2*X_{t-2} + error.
>
>
>
>
> Thanks
> Mamush
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>


From senne.vanhandenhove at telenet.be  Tue Mar 13 14:44:48 2012
From: senne.vanhandenhove at telenet.be (Senne Van Handenhove)
Date: Tue, 13 Mar 2012 14:44:48 +0100
Subject: [R-SIG-Finance] Abnormal returns in R
Message-ID: <006601cd011f$75aa6e50$60ff4af0$@telenet.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/31e6900c/attachment.pl>

From senne.vanhandenhove at telenet.be  Tue Mar 13 14:46:49 2012
From: senne.vanhandenhove at telenet.be (Senne Van Handenhove)
Date: Tue, 13 Mar 2012 14:46:49 +0100
Subject: [R-SIG-Finance] Abnormal returns in R
Message-ID: <011301cd011f$bd659ee0$3830dca0$@telenet.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/5960fa7e/attachment.pl>

From brian at braverock.com  Tue Mar 13 14:56:25 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 13 Mar 2012 08:56:25 -0500
Subject: [R-SIG-Finance] Abnormal returns in R
In-Reply-To: <006601cd011f$75aa6e50$60ff4af0$@telenet.be>
References: <006601cd011f$75aa6e50$60ff4af0$@telenet.be>
Message-ID: <1331646985.28362.319.camel@brian-rcg>

On Tue, 2012-03-13 at 14:44 +0100, Senne Van Handenhove wrote:
> Now I need to make a market model in R so i can generate abnormal
> returns from these stocks. As market index I would like to use the
> GSPC. I also need to consider abnormal returns calculated over a
> sixty-trading-day window.
> 
> Can this be done in R? 

Yes.

> Is it difficult to write this code?
> 
No.

install.packages('PerformanceAnalytics')
require(PerformanceAnalytics)
?Return.excess
?rollapply

Cheers,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From felice.bruno at live.it  Tue Mar 13 21:18:42 2012
From: felice.bruno at live.it (liciobruno)
Date: Tue, 13 Mar 2012 13:18:42 -0700 (PDT)
Subject: [R-SIG-Finance] Problems with values in blotter portfolio and end
	equity
Message-ID: <1331669922174-4470225.post@n4.nabble.com>

Hi

I have found a mismatch with values in blotter.

I try to explain.

I have a xts object containing the prices (Open, Hi, Low, Close) of a stock.

Using blotter portfolio and account, I made a simple trading system using
moving averages as signals.
I made my experiments adding only few transactions to portfolio, using the
closing prices.

After the first transaction, the day after, I made a control about the end
equity, and I noted that it has a different value respect the numerical
difference between the close prices of the current day and the previous day.

Following is the code (I deleted the not inherent parts)

...
ptf_EMA='ptfEMA'
acc_EMA='accEMA'
initPortf(ptf_EMA, cross, initDate=start) 
initAcct(acc_EMA, portfolios=ptf_EMA, initDate=start, initEq=initEq) 
verbose=TRUE

for (i in (longPer + 1) : nrow(Prices)){
  
	currentDate <- time(Prices)[i]
	closePrice <- as.numeric(Cl(Prices[i]))
	
  if (first.cross == F) {
    if (EMA_short[i] > EMA_long[i]) {
      if (EMA_short[i-1] > EMA_long[i-1]) {
        sig.tot[i] <- 0
      } else if (EMA_short[i-1] < EMA_long[i-1]) {
        sig.tot[i] <- 1
        first.cross <- T
        
	addTxn(Portfolio=ptf_EMA, Symbol=cross,  TxnDate=currentDate,
TxnPrice=closePrice, TxnQty = unitSize , TxnFees=0, verbose=T)
      }
    } else if (EMA_short[i] < EMA_long[i]) {
      if (EMA_short[i-1] < EMA_long[i-1]) {
        sig.tot[i] <- 0
      } else if (EMA_short[i-1] > EMA_long[i-1]) {
        sig.tot[i] <- -1
        first.cross <- T
        
        addTxn(Portfolio=ptf_EMA, Symbol=cross,  TxnDate=currentDate,
TxnPrice=closePrice, TxnQty = -unitSize , TxnFees=0, verbose=T)
      }
    }
  } else if(first.cross == T) {
    if (EMA_short[i] > EMA_long[i]) {
	  if (EMA_short[i-1] > EMA_long[i-1]) {
	    sig.tot[i] <- 1
	  } else if (EMA_short[i-1] < EMA_long[i-1]) {
	    sig.tot[i] <- 1
      Posn = getPosQty(ptf_EMA, Symbol=cross, Date=currentDate)
		  
	    addTxn(Portfolio=ptf_EMA, Symbol=cross,  TxnDate=currentDate,
TxnPrice=closePrice, TxnQty = -Posn , TxnFees=0, verbose=T)
	   
	    addTxn(Portfolio=ptf_EMA, Symbol=cross,  TxnDate=currentDate,
TxnPrice=closePrice, TxnQty = unitSize , TxnFees=0, verbose=T)
  	  }
    } else if (EMA_short[i] < EMA_long[i]) {
	  if (EMA_short[i-1] < EMA_long[i-1]) {
		  sig.tot[i] <- -1
	  } else if (EMA_short[i-1] > EMA_long[i-1]) {
  		sig.tot[i] <- -1
      Posn = getPosQty(ptf_EMA, Symbol=cross, Date=currentDate)
  		cat('\n')
  		# Aggiungere transazione chiusura
      addTxn(Portfolio=ptf_EMA, Symbol=cross,  TxnDate=currentDate,
TxnPrice=closePrice, TxnQty = -Posn , TxnFees=0, verbose=T)
  		# Aggiungere transazione apertura
  		addTxn(Portfolio=ptf_EMA, Symbol=cross,  TxnDate=currentDate,
TxnPrice=closePrice, TxnQty = -unitSize , TxnFees=0, verbose=T)
	  }
    }
  }
  
  updatePortf(ptf_EMA, Dates = currentDate)
  updateAcct(acc_EMA, Dates = currentDate)
  updateEndEq(acc_EMA, Dates = currentDate)
	
}

...


I'm new in R, so please, excuse me if my code is not so good.

Thank you for your attention.

--
View this message in context: http://r.789695.n4.nabble.com/Problems-with-values-in-blotter-portfolio-and-end-equity-tp4470225p4470225.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From comtech.usa at gmail.com  Tue Mar 13 21:20:21 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 13 Mar 2012 15:20:21 -0500
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
	<4F59076B.6050800@burns-stat.com>
	<7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>
Message-ID: <CAPNjSFaZQZzqegtcqjEpCGUJPpyY9M31ZnHWt+qZvqtsBFkoNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/dd94e583/attachment.pl>

From anna.dunietz at gmail.com  Tue Mar 13 21:25:47 2012
From: anna.dunietz at gmail.com (Anna Dunietz)
Date: Tue, 13 Mar 2012 21:25:47 +0100
Subject: [R-SIG-Finance] Black Scholes 3d plot
Message-ID: <1264D42D-9A92-4F60-A54F-A63F145ED47E@gmail.com>

Hello all!

I would like to create a 3d plot, with the option price explained by  
the underlying price and time. Unfortunately, I can't quite get it to  
work.  I would very much appreciate your help!

Thanks,
Anna

# Black-Scholes Option Graph
library(lattice)


blackscholes <- function(s, k, r=.1, t=5, sigma=.9,call=TRUE) {
    #calculate call/put option
    d1 <- (log(s/k)+(r+sigma^2/2)*t)/(sigma*sqrt(t))
    d2 <- d1 - sigma * sqrt(t)
    ifelse(call==TRUE,s*pnorm(d1) - k*exp(-r*t)*pnorm(d2),k*exp(-r*t)  
* pnorm(-d2) - s*pnorm(-d1))
    }

plotbs <- function(price){
    #create
    s<-seq(0,price,len=price/2)
    k<-s

    t<-0:5
    sigma<-seq(0,0.9,by=.1)

    #expand information
    OptionPrice<-matrix(nrow=length(s),ncol=length(k))
    for(i in 1:length(s)) OptionPrice[i,]<-mapply(blackscholes,s[i],k)
    grid <- expand.grid(list(Time=t, UnderlyingPrice=s))

    #plot
    wireframe(OptionPrice~Time*UnderlyingPrice,data=grid,main="3D  
Option",
              drape=T,col.regions=heat.colors(100),scales =  
list(arrows=FALSE),)
    }


From comtech.usa at gmail.com  Tue Mar 13 22:52:29 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 13 Mar 2012 16:52:29 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
	coefficient?
Message-ID: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/21eb5230/attachment.pl>

From ustaudinger at gmail.com  Tue Mar 13 23:59:04 2012
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Tue, 13 Mar 2012 23:59:04 +0100
Subject: [R-SIG-Finance] Are there genetic algorithm for trading
 strategy evolution in R?
In-Reply-To: <CAPNjSFaZQZzqegtcqjEpCGUJPpyY9M31ZnHWt+qZvqtsBFkoNA@mail.gmail.com>
References: <CAPNjSFZhyRyWUrN84QXVC_B+0bLyjjqBQfbH2rJcyPQU+o8XHA@mail.gmail.com>
	<CABBqO6kTB-hrn+K7yRiF9j3gGdiC3kN_8FL3bSHvWQtjcm=t1A@mail.gmail.com>
	<CAEr64e-7R67HAaGX9ZfJnKiEq0xRjKROG0S28zoC7f4EGTn5OQ@mail.gmail.com>
	<CAPNjSFYfH6LG0rAUF5Beq7_LzTfxwzBwvLBLYfiy4xOZZ4-u9w@mail.gmail.com>
	<4F58FFCD.2070606@burns-stat.com>
	<CAPLrYEQHUxbFNSczM_TzFJb9H1HPP9Z5NFrDY3g_UzKbafULJw@mail.gmail.com>
	<4F59076B.6050800@burns-stat.com>
	<7BFB9D627A159649BC6C30B6406E3A4814A4576C31@VAUNSW141.au.cbainet.com>
	<CAPNjSFaZQZzqegtcqjEpCGUJPpyY9M31ZnHWt+qZvqtsBFkoNA@mail.gmail.com>
Message-ID: <CAMrz3D2izpmNTDWdr_YTGWo+pVf-gX984ZyQaEjW=_k_qYVCkw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/ec213e39/attachment.pl>

From nands31 at gmail.com  Wed Mar 14 00:11:47 2012
From: nands31 at gmail.com (Subhrangshu Nandi)
Date: Tue, 13 Mar 2012 18:11:47 -0500
Subject: [R-SIG-Finance] quantmod/addTA/.GlobalEnv question
In-Reply-To: <CANz8_-4w+Lyrrov+a8farpBn7mrtzhyZmV2kPtSUPWW6_O10KA@mail.gmail.com>
References: <CANz8_-4w+Lyrrov+a8farpBn7mrtzhyZmV2kPtSUPWW6_O10KA@mail.gmail.com>
Message-ID: <CANz8_-72cxHzQbsd1WCU0oQ9gdh5Rx36au-iGTfaOL=s8Svj_Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/26216d5a/attachment.pl>

From brian at braverock.com  Wed Mar 14 01:19:01 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 13 Mar 2012 19:19:01 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
 coefficient?
In-Reply-To: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
References: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
Message-ID: <1331684341.28956.7.camel@brian-desktop>

On Tue, 2012-03-13 at 16:52 -0500, Michael wrote:
> In Grinold's book, the key formula involve "information coefficient" and
> "breadth"...
> 
> How do we measure these in R?
> 
> Any package does these?

http://lmgtfy.com/?q=information+ratio+r-project+#


From comtech.usa at gmail.com  Wed Mar 14 02:54:20 2012
From: comtech.usa at gmail.com (Michael)
Date: Tue, 13 Mar 2012 20:54:20 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
	coefficient?
In-Reply-To: <1331684341.28956.7.camel@brian-desktop>
References: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
	<1331684341.28956.7.camel@brian-desktop>
Message-ID: <CAPNjSFbR7nxabqY3hrPyXhWZA6aFc-7ki-YcJs1BFG1DXJjdqQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120313/2e3392c7/attachment.pl>

From brian at braverock.com  Wed Mar 14 03:13:19 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 13 Mar 2012 21:13:19 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
 coefficient?
In-Reply-To: <CAPNjSFbR7nxabqY3hrPyXhWZA6aFc-7ki-YcJs1BFG1DXJjdqQ@mail.gmail.com>
References: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
	<1331684341.28956.7.camel@brian-desktop>
	<CAPNjSFbR7nxabqY3hrPyXhWZA6aFc-7ki-YcJs1BFG1DXJjdqQ@mail.gmail.com>
Message-ID: <1331691199.28956.24.camel@brian-desktop>

On Tue, 2012-03-13 at 20:54 -0500, Michael wrote:
> Thanks Brian.
>  
> I have read for example the following documents:
>  
> http://cran.r-project.org/web/packages/PerformanceAnalytics/vignettes/PerformanceAnalyticsPresentation-UseR-2007.pdf
>  
> However, I am looking for the "information coefficient" not
> "information ratio/sharpe ratio", etc. 

If you read carefully, as you clearly did not, Information Coefficient
(IC) is a function of the Information Ratio(IR).  So, you cannot be
looking for one without the other.

In my copy of Grinold and Kahn (second edition), Chapter 5 is about the
'Information Ratio' as implemented in PortfolioAnalytics.
 
Breadth is so trivial that I'm not even going to discuss it, as should
be obvious if you understand what you are reading.

The formula for Information Criteria[1] is

IR = IC + sqrt(BR)

I suspect that (even) you can figure out the algebraic substitution to
put IC on its own on one side of the equation with Information Ratio on
the other.

Ref:
Grinold and Kahn, Active Portfolio Management. Second Edition. p. 148

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From hifin at live.com  Wed Mar 14 10:23:40 2012
From: hifin at live.com (hifin)
Date: Wed, 14 Mar 2012 02:23:40 -0700 (PDT)
Subject: [R-SIG-Finance] Does Quantstrat use C/Fortran to do the computation?
Message-ID: <1331717020021-4471351.post@n4.nabble.com>

I was wondering if any quantstrat's backtesting functionality is fulfilled by
underlying C/Fortran programs. I asked this because speed is crucial when
doing intra-day/high-frequency simulation and optimization.

Thanks for your inputs.



--
View this message in context: http://r.789695.n4.nabble.com/Does-Quantstrat-use-C-Fortran-to-do-the-computation-tp4471351p4471351.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From advaitgodbole at gmail.com  Wed Mar 14 10:45:24 2012
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Wed, 14 Mar 2012 15:15:24 +0530
Subject: [R-SIG-Finance] hourly time series
Message-ID: <CAFdqCxsYJsWet9iGwycAkA=Dx16BAqZ1Po-D0gQoQaPrbSv_Ng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/4f112fdc/attachment.pl>

From daniel.cegielka at gmail.com  Wed Mar 14 11:05:34 2012
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Wed, 14 Mar 2012 11:05:34 +0100
Subject: [R-SIG-Finance] Does Quantstrat use C/Fortran to do the
	computation?
In-Reply-To: <1331717020021-4471351.post@n4.nabble.com>
References: <1331717020021-4471351.post@n4.nabble.com>
Message-ID: <CAPLrYETxkvaZQsCHriN9yBRJRJk_jkLyY5eJJpuTX2Q5UJf9gA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/7d32b6ad/attachment.pl>

From brian at braverock.com  Wed Mar 14 11:12:52 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 14 Mar 2012 05:12:52 -0500
Subject: [R-SIG-Finance] Does Quantstrat use C/Fortran to do the
 computation?
In-Reply-To: <1331717020021-4471351.post@n4.nabble.com>
References: <1331717020021-4471351.post@n4.nabble.com>
Message-ID: <1331719972.28956.32.camel@brian-desktop>

On Wed, 2012-03-14 at 02:23 -0700, hifin wrote:
> I was wondering if any quantstrat's backtesting functionality is fulfilled by
> underlying C/Fortran programs. I asked this because speed is crucial when
> doing intra-day/high-frequency simulation and optimization.
> 
> Thanks for your inputs.

The answer to your question is both yes and no.

The 'yes' part is that quantstrat relies extensively on xts and other R
internals that are (largely) coded in C, and uses vectorization wherever
possible.

quantstrat is also usable on intraday and tick data, with some care.  I
can typically achieve speeds of around 1 minute per cpu-core per
instrument per day on tick data with a path-dependent rule set.  

You can write non-path-dependent backtests in quantstrat, but I don't
think non-path-dependent rule evaluation is particularly realistic.

The 'no' part, which I have written about extensively on this list and
elsewhere (including in the quantstrat documentation), is that the main
rule processing loop, the path dependent part, is written in pure R.
This could change in the future, but won't change soon, for reasons
detailed elsewhere.

Also, both the code and the documentation are available to you, as are
the archives of this list.  Please peruse them so that you can ask a
more specific question in the future.

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From glenn at aligncapital.com  Wed Mar 14 11:32:03 2012
From: glenn at aligncapital.com (Glenn Dunster)
Date: Wed, 14 Mar 2012 18:32:03 +0800
Subject: [R-SIG-Finance] Historical FX Data via IBrokers API
Message-ID: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/82cff42a/attachment.pl>

From enricoschumann at yahoo.de  Wed Mar 14 12:20:06 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Wed, 14 Mar 2012 12:20:06 +0100
Subject: [R-SIG-Finance] Historical FX Data via IBrokers API
In-Reply-To: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
References: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
Message-ID: <4F607EE6.9020901@yahoo.de>


Hi Glenn,

this works for me:

require("IBrokers")
contr <- twsCurrency(symbol = "GBP", currency = "JPY")
tws <- twsConnect(sample(1e6,1))
results <- reqHistoricalData(tws,
                              Contract = contr,
                              endDateTime = "20120301 09:00:00",
                              barSize = "5 mins",
                              duration = "5 D",
                              useRTH = 0,
                              whatToShow = "MIDPOINT")

twsDisconnect(tws)
head(results, 5)

## should be something like
                     GBP.JPY.Open GBP.JPY.High GBP.JPY.Low GBP.JPY.Close
2012-02-23 23:15:00     125.9100     125.9100     125.840      125.8825
2012-02-23 23:20:00     125.8825     125.8825     125.815      125.8150
2012-02-23 23:25:00     125.8150     125.8550     125.815      125.8350
2012-02-23 23:30:00     125.8350     125.8800     125.825      125.8350
2012-02-23 23:35:00     125.8350     125.8925     125.825      125.8575

###[...]


Regards,
Enrico


-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


Am 14.03.2012 11:32, schrieb Glenn Dunster:
> Greetings,
>
> Is anybody here using the IB API and R to download historical FX data?  I
> couldn't find any references to success or failure using RSeek or Googling.
>
> The response my attempts elicit suggest that the data isn't available,
> though I can fetch the same without problem using ActiveX/Excel. As I'm a R
> neophyte, I'd like to check firstly if my code is incorrect in my various
> attempts. Note that I've had no problem retrieving quotes and market data
> for the same currency:
>
> [1] "GBPJPY"
>> GBPJPY<- getContract("GBPJPY")
>> get_quote("GBPJPY")
> 2 -1 2104 Market data farm connection is OK:usfuture
> 2 -1 2104 Market data farm connection is OK:hkfarm
> 2 -1 2104 Market data farm connection is OK:cashfarm
> 2 -1 2104 Market data farm connection is OK:usfarm
> 2 -1 2106 HMDS data farm connection is OK:ushmds2a
>          BidSize BidPrice AskPrice AskSize
> GBP.JPY   2e+06  131.275   131.31 1.5e+07
>
>   >  reqMktData(tws,twsCurrency("GBP"))
> <20120314 18:03:20.843750>  id=1 symbol=GBP bidPrice: 1.57055  bidSize:
> 14310000
> <20120314 18:03:20.843750>  id=1 symbol=GBP askPrice: 1.57065  askSize:
> 1000000
> <20120314 18:03:20.843750>  id=1 symbol=GBP bidSize: 14310000
> <20120314 18:03:20.843750>  id=1 symbol=GBP askSize: 1000000
> <20120314 18:03:20.843750>  id=1 symbol=GBP highPrice: 1.57460
>
>> reqHistoricalData(tws, Contract=contract)
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfuture
> TWS Message: 2 -1 2104 Market data farm connection is OK:hkfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> waiting for TWS reply on GBP ....failed.
> NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106,  :
>    Historical Market Data Service error message:No data of type EODChart is
> available for the exchange 'IDEAL' and the security type 'Forex' and '1 m'
> and '1 day'
>
>> reqHistoricalData(tws,Contract=contract,endDateTime='20120302 17:00:00
> GMT', barSize='1 day', duration='2 W', useRTH="0",
> whatToShow='MIDPOINT',file="")
> waiting for TWS reply on GBP .....failed.
> NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106,  :
>    Historical Market Data Service error message:No data of type EODChart is
> available for the exchange 'IDEAL' and the security type 'Forex' and '2 W'
> and '1 day'
>
>   >  reqHistoricalData(tws,twsCurrency("GBP"))
> waiting for TWS reply on GBP ....failed.
> NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106,  :
>    Historical Market Data Service error message:No historical market data
> for GBP/CASH at IDEALPRO Last 1d
>
> Appreciate corrections or advice, thank you
>
> Glenn


From michael.weylandt at gmail.com  Wed Mar 14 14:11:00 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Wed, 14 Mar 2012 09:11:00 -0400
Subject: [R-SIG-Finance] hourly time series
In-Reply-To: <CAFdqCxsYJsWet9iGwycAkA=Dx16BAqZ1Po-D0gQoQaPrbSv_Ng@mail.gmail.com>
References: <CAFdqCxsYJsWet9iGwycAkA=Dx16BAqZ1Po-D0gQoQaPrbSv_Ng@mail.gmail.com>
Message-ID: <CAAmySGOWN45D3k=Km4u9MWDNU_baGVnsHvH967qni5zRxb_d1w@mail.gmail.com>

I think you are interpreting your frequency argument incorrectly and
thus R is giving you an error message because you are asking for
seasonal trends but giving only one observation per "season" -- it's
rather subtle: as the help page says,

frequency -- the number of observations per unit of time.

Note that this works,

wind_ts <- ts(cumsum(rnorm(8760)), start = 1, frequency = 24) # E.g.,
the relevant time scale is "daily" and you have 24 obs per day
(hourly)
decompose(wind_ts)

This would be for a phenomenon that reoccurs daily: I'm not sure if a
single monsoon season (I think there's only one a year but I don't
really know Indian climatology so well) will give you sufficient power
for a statistically significant result, but you can cross that bridge
when you get to it.

Hope this helps,

Michael

PS -- The ts class is generally considered a necessary evil around
here because of things like that ;-)

On Wed, Mar 14, 2012 at 5:45 AM, Advait Godbole <advaitgodbole at gmail.com> wrote:
> Dear all,
>
> I am new to this list and I first posted this query on the r-sig-geo forum,
> apologies for the cross-post. My question is not related to finance,
> however I am sure many users here will have experience with time series
> analysis and would be able to provide insight.
>
> I have one year's worth of hourly data, starting from 1st April 2010 and
> ending on 31st March 2011. I would like to perform time series analysis on
> it. New to time series analysis and not having used "ts" before, I am
> having trouble setting it up to correctly represent the data. I have R
> reading in the time series via:
> *wind_ts <- ts(wind.MH,start=1,frequency=1)*
>
> where "wind.MH" is a 8760x1 matrix object. I then tried to decompose the
> time series with the following error:
> *wind_ts_components <- decompose(wind_ts)*
> *Error in decompose(wind_ts) : time series has no or less than 2 periods*
>
> The dataset is the hourly wind generation for Maharashtra, India and has
> some seasonality associated with the Indian monsoon. Ultimately, this is
> what I would like to identify. I imagine that correctly setting the "start"
> and "frequency" parameters is necessary to be able to parse the dataset
> ?into months and seasons. Someone suggested I use the "timetools" package
> instead but I havent had the chance to do so.
>
> I would greatly appreciate help on how to handle this and any leads on time
> series analysis for hourly data in general.
>
> Regards,
>
> --
> advait godbole
> analyst, prayas energy group
> pune, india
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From harrisonmark1 at gmail.com  Wed Mar 14 14:58:35 2012
From: harrisonmark1 at gmail.com (Mark Harrison)
Date: Wed, 14 Mar 2012 08:58:35 -0500
Subject: [R-SIG-Finance] Historical FX Data via IBrokers API
In-Reply-To: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
References: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
Message-ID: <CAHFhaq8Sv0NQypznQOVSJLEFqS7Z90izowxuYoUEBV375EDiWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/7d4c2775/attachment.pl>

From comtech.usa at gmail.com  Wed Mar 14 15:01:24 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 14 Mar 2012 09:01:24 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
	coefficient?
In-Reply-To: <1331691199.28956.24.camel@brian-desktop>
References: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
	<1331684341.28956.7.camel@brian-desktop>
	<CAPNjSFbR7nxabqY3hrPyXhWZA6aFc-7ki-YcJs1BFG1DXJjdqQ@mail.gmail.com>
	<1331691199.28956.24.camel@brian-desktop>
Message-ID: <CAPNjSFYMtoc4FRSU8+POFnU8G+boKX75ci-pc-hZJ0m6QOg6kg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/fbfc35b4/attachment.pl>

From brian at braverock.com  Wed Mar 14 15:18:21 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 14 Mar 2012 09:18:21 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
 coefficient?
In-Reply-To: <CAPNjSFYMtoc4FRSU8+POFnU8G+boKX75ci-pc-hZJ0m6QOg6kg@mail.gmail.com>
References: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
	<1331684341.28956.7.camel@brian-desktop>
	<CAPNjSFbR7nxabqY3hrPyXhWZA6aFc-7ki-YcJs1BFG1DXJjdqQ@mail.gmail.com>
	<1331691199.28956.24.camel@brian-desktop>
	<CAPNjSFYMtoc4FRSU8+POFnU8G+boKX75ci-pc-hZJ0m6QOg6kg@mail.gmail.com>
Message-ID: <1331734701.28362.373.camel@brian-rcg>

On Wed, 2012-03-14 at 09:01 -0500, Michael wrote:
> is an approximation...  

*Everything* that is not directly measured in an approximation.

>  So it's better measure IC and BR directly from raw trades data.   

Grinold isn't about measuring *trades*, it is about measuring skill in
*returns*.

> You said BR is trivial, could you please show me how to measure
> "independent bets" in practice? 
> 
Breadth isn't about 'independent bets'. To quote[1], 'the value added by
the manager will be proportional to the information ratio squared'.
Breadth is 'the number of independent forecasts of exceptional returns
we make in a year'.  If you know the strategy or the manager or the
portfolio, all you do is *count* independent forecasts.

While the rest of chapter 6 in Grinold discusses other methods of
estimating Information Coefficient, these suggest using a degree of
forecasting power and process measurement that you have completely
failed to demonstrate.  Stick with the first approximation.

If that wasn't enough, I draw your attention to the end of the chapter
for another reason why the 'approximation' is probably superior to a
more nuanced mode in your case: "realized information ratios for optimal
portfolios based on {perfect} forecasts are statistically
indistinguishable from the forecasts of the fundamental law"[1 p.161].

Ref:
Grinold and Kahn, Active Portfolio Management. Second Edition. 
Chapter 6, pp. 147 ff.
        
-- 
Brian


From gsee000 at gmail.com  Wed Mar 14 15:20:32 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 14 Mar 2012 09:20:32 -0500
Subject: [R-SIG-Finance] Historical FX Data via IBrokers API
In-Reply-To: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
References: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
Message-ID: <CA+xi=qag=jbcwJU-5Rz7CC-Exh8SivO9BheOjzDiZYgKRhG+8g@mail.gmail.com>

You have given us code that uses an object called "contract," but you
have not shown us what "contract" is.

If I define contract like this (using the twsInstrument package as you have)

contract <- getContract("GBPJPY")

then your code works for me.

1> contract <- getContract("GBPJPY")
Connected with clientId 100.
Request complete: GBP CASH JPY.
Disconnected.
> tws <- ibgConnect()  ## or twsConnect() or ConnectIB()
> reqHistoricalData(tws,Contract=contract,endDateTime='20120302 17:00:00 GMT',
+     barSize='1 day', duration='2 W', useRTH="0",
whatToShow='MIDPOINT',file="")
waiting for TWS reply on GBP ....... done.
1329717600,126.5975,126.840,125.785,126.225,-1,-1.000,0,-1
1329804000,126.2375,126.660,125.6575,125.820,-1,-1.000,0,-1
1329890400,125.780,126.6275,125.605,125.800,-1,-1.000,0,-1
1329976800,125.775,126.210,125.475,125.955,-1,-1.000,0,-1
1330063200,125.910,128.980,125.815,128.885,-1,-1.000,0,-1
1330322400,129.4025,129.785,126.9625,127.5425,-1,-1.000,0,-1
1330408800,127.5275,128.245,126.6925,127.935,-1,-1.000,0,-1
1330495200,127.925,129.6225,127.825,129.1475,-1,-1.000,0,-1
1330581600,129.2475,129.6025,128.7575,129.4375,-1,-1.000,0,-1
1330668000,129.395,130.110,129.1525,129.530,-1,-1.000,0,-1
NULL

Garrett

On Wed, Mar 14, 2012 at 5:32 AM, Glenn Dunster <glenn at aligncapital.com> wrote:
> Greetings,
>
> Is anybody here using the IB API and R to download historical FX data? ?I
> couldn't find any references to success or failure using RSeek or Googling.
>
> The response my attempts elicit suggest that the data isn't available,
> though I can fetch the same without problem using ActiveX/Excel. As I'm a R
> neophyte, I'd like to check firstly if my code is incorrect in my various
> attempts. Note that I've had no problem retrieving quotes and market data
> for the same currency:
>
> [1] "GBPJPY"
>> GBPJPY <- getContract("GBPJPY")
>> get_quote("GBPJPY")
> 2 -1 2104 Market data farm connection is OK:usfuture
> 2 -1 2104 Market data farm connection is OK:hkfarm
> 2 -1 2104 Market data farm connection is OK:cashfarm
> 2 -1 2104 Market data farm connection is OK:usfarm
> 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> ? ? ? ?BidSize BidPrice AskPrice AskSize
> GBP.JPY ? 2e+06 ?131.275 ? 131.31 1.5e+07
>
> ?> reqMktData(tws,twsCurrency("GBP"))
> <20120314 18:03:20.843750> id=1 symbol=GBP bidPrice: 1.57055 ?bidSize:
> 14310000
> <20120314 18:03:20.843750> id=1 symbol=GBP askPrice: 1.57065 ?askSize:
> 1000000
> <20120314 18:03:20.843750> id=1 symbol=GBP bidSize: 14310000
> <20120314 18:03:20.843750> id=1 symbol=GBP askSize: 1000000
> <20120314 18:03:20.843750> id=1 symbol=GBP highPrice: 1.57460
>
>> reqHistoricalData(tws, Contract=contract)
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfuture
> TWS Message: 2 -1 2104 Market data farm connection is OK:hkfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> waiting for TWS reply on GBP ....failed.
> NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106, ?:
> ?Historical Market Data Service error message:No data of type EODChart is
> available for the exchange 'IDEAL' and the security type 'Forex' and '1 m'
> and '1 day'
>
>> reqHistoricalData(tws,Contract=contract,endDateTime='20120302 17:00:00
> GMT', barSize='1 day', duration='2 W', useRTH="0",
> whatToShow='MIDPOINT',file="")
> waiting for TWS reply on GBP .....failed.
> NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106, ?:
> ?Historical Market Data Service error message:No data of type EODChart is
> available for the exchange 'IDEAL' and the security type 'Forex' and '2 W'
> and '1 day'
>
> ?> reqHistoricalData(tws,twsCurrency("GBP"))
> waiting for TWS reply on GBP ....failed.
> NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106, ?:
> ?Historical Market Data Service error message:No historical market data
> for GBP/CASH at IDEALPRO Last 1d
>
> Appreciate corrections or advice, thank you
>
> Glenn
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Wed Mar 14 15:35:15 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 14 Mar 2012 09:35:15 -0500
Subject: [R-SIG-Finance] Technical Pattern Trading (Should Head Should,
	etc.) in R?
Message-ID: <CAPNjSFZy5CDqxELEJvjdHNuE511n+4vO_wJsob+NJp5a0CKYHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/c3cf97f7/attachment.pl>

From comtech.usa at gmail.com  Wed Mar 14 15:47:16 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 14 Mar 2012 09:47:16 -0500
Subject: [R-SIG-Finance] Is there R code for measuring information
	coefficient?
In-Reply-To: <1331734701.28362.373.camel@brian-rcg>
References: <CAPNjSFZ5cUa-pDdenfFNA7HMk1ngRdFQ-P-jYuTWALYDrBnPEQ@mail.gmail.com>
	<1331684341.28956.7.camel@brian-desktop>
	<CAPNjSFbR7nxabqY3hrPyXhWZA6aFc-7ki-YcJs1BFG1DXJjdqQ@mail.gmail.com>
	<1331691199.28956.24.camel@brian-desktop>
	<CAPNjSFYMtoc4FRSU8+POFnU8G+boKX75ci-pc-hZJ0m6QOg6kg@mail.gmail.com>
	<1331734701.28362.373.camel@brian-rcg>
Message-ID: <CAPNjSFbK8fTXugm9M4vMmMx8v5i2c9op4Ge6ZLZDdr3sobBBLQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/421fab77/attachment.pl>

From glenn at aligncapital.com  Wed Mar 14 15:57:18 2012
From: glenn at aligncapital.com (Glenn Dunster)
Date: Wed, 14 Mar 2012 22:57:18 +0800
Subject: [R-SIG-Finance] Historical FX Data via IBrokers API
In-Reply-To: <CAAQ0RTLdz4jkRUEuWXXjEWY6twXBBCnv86Dggz6Ys0gNiVSh_g@mail.gmail.com>
References: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
	<CAHFhaq8Sv0NQypznQOVSJLEFqS7Z90izowxuYoUEBV375EDiWQ@mail.gmail.com>
	<CAAQ0RTLdz4jkRUEuWXXjEWY6twXBBCnv86Dggz6Ys0gNiVSh_g@mail.gmail.com>
Message-ID: <CAAQ0RTKH3wQyrAJaoWu9Hqn4Lhv2+VV2bCDmru4+p3Dq8u3wnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/f4c3aa08/attachment.pl>

From gsee000 at gmail.com  Wed Mar 14 16:08:55 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 14 Mar 2012 10:08:55 -0500
Subject: [R-SIG-Finance] Technical Pattern Trading (Should Head Should,
 etc.) in R?
In-Reply-To: <CAPNjSFZy5CDqxELEJvjdHNuE511n+4vO_wJsob+NJp5a0CKYHw@mail.gmail.com>
References: <CAPNjSFZy5CDqxELEJvjdHNuE511n+4vO_wJsob+NJp5a0CKYHw@mail.gmail.com>
Message-ID: <CA+xi=qZWdjQc7B8JZqQfm3NgEmjG-xEFZazTKzVqSpVWKi27=g@mail.gmail.com>

Most people call that Technical Analysis.  In fact, the title of the
article that you linked to begins with "Foundations of Technical
Analysis".

Please search for "technical analysis" on rseek.org.  Or in an R terminal type
> RSiteSearch("technical analysis")

I'm growing tired of trying to teach you how to search, Michael.

-Garrett

On Wed, Mar 14, 2012 at 9:35 AM, Michael <comtech.usa at gmail.com> wrote:
> Technical Pattern Trading (Should Head Should, etc.) in R?
>
> Hi all,
>
>
> I am trying to explore the technical pattern based trading strategies using
> R.
>
> One paper is of course Andrew Lo's:
>
> http://web.mit.edu/alo/www/Papers/1705-1765.pdf
>
> Some googling showed some online blogs mentioning technical pattern
> detection but without too much convincing Sharpe Ratios...
>
> Anybody could share sweet or bitter experience about doing these stuff in R?
>
> Any pointers to good packages?
>
> Thanks a lot!
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Wed Mar 14 16:17:15 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 14 Mar 2012 10:17:15 -0500
Subject: [R-SIG-Finance] Technical Pattern Trading (Should Head Should,
 etc.) in R?
In-Reply-To: <CA+xi=qZWdjQc7B8JZqQfm3NgEmjG-xEFZazTKzVqSpVWKi27=g@mail.gmail.com>
References: <CAPNjSFZy5CDqxELEJvjdHNuE511n+4vO_wJsob+NJp5a0CKYHw@mail.gmail.com>
	<CA+xi=qZWdjQc7B8JZqQfm3NgEmjG-xEFZazTKzVqSpVWKi27=g@mail.gmail.com>
Message-ID: <CAPNjSFYzDgebdwMqPSY3qnmioqxNNLkxMvkGmz+rxHRRh08_BQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/0d644e48/attachment.pl>

From gsee000 at gmail.com  Wed Mar 14 16:17:32 2012
From: gsee000 at gmail.com (G See)
Date: Wed, 14 Mar 2012 10:17:32 -0500
Subject: [R-SIG-Finance] Historical FX Data via IBrokers API
In-Reply-To: <CAAQ0RTKH3wQyrAJaoWu9Hqn4Lhv2+VV2bCDmru4+p3Dq8u3wnw@mail.gmail.com>
References: <CAAQ0RTKzf+cdyPRK3fznDNSST8wsmdppeotsZongvSt1G8hBgA@mail.gmail.com>
	<CAHFhaq8Sv0NQypznQOVSJLEFqS7Z90izowxuYoUEBV375EDiWQ@mail.gmail.com>
	<CAAQ0RTLdz4jkRUEuWXXjEWY6twXBBCnv86Dggz6Ys0gNiVSh_g@mail.gmail.com>
	<CAAQ0RTKH3wQyrAJaoWu9Hqn4Lhv2+VV2bCDmru4+p3Dq8u3wnw@mail.gmail.com>
Message-ID: <CA+xi=qZ0x_v_WfGEkDtopxqmDJ6RS-whmaBSDaat6Jufc6Jpxg@mail.gmail.com>

On Wed, Mar 14, 2012 at 9:57 AM, Glenn Dunster <glenn at aligncapital.com> wrote:
> Garrett, apologies, I've just read your post after replying to Mark. As
> mentioned, I miscopied my full example, but it appears I still made an
> error, and/or mixed twsInstrument with alternative approaches to create my
> own problem.
>
> Now, it's much clearer
>
> thanks & regards,
> Glenn
>
> P.S. and apologies to the board for forgetting to "reply all"
>
> On 14 March 2012 22:36, Glenn Dunster <glenn at aligncapital.com> wrote:
>
>> Mark, thank you for the additional dimension. Coincidentally I had begun
>> my code with twsInstrument, but accidentally sliced it off from my example
>> posted to R-SIG. ?I had written it:
>>
>> > twsInstrument(twsCASH(symbol='GBP',currency='JPY'))
>> ?Connected with clientId 100.
>> Request complete: GBP CASH JPY.
>> Disconnected.
>> [1] "GBPJPY"
>>
>> I hadn't found the twsInstrument vignette the easiest read, so I'm pleased
>> to have your alternative input format,and the ensuing example.
>>

I agree that the twsInstrument vignette is extremely difficult to read
because no one has written a vignette for twsInstrument! ;-)  If
anyone would like to write and contribute one I'd be happy to include
it.

Garrett


From comtech.usa at gmail.com  Wed Mar 14 16:18:42 2012
From: comtech.usa at gmail.com (Michael)
Date: Wed, 14 Mar 2012 10:18:42 -0500
Subject: [R-SIG-Finance] Technical Pattern Trading (Should Head Should,
 etc.) in R?
In-Reply-To: <CAPNjSFYzDgebdwMqPSY3qnmioqxNNLkxMvkGmz+rxHRRh08_BQ@mail.gmail.com>
References: <CAPNjSFZy5CDqxELEJvjdHNuE511n+4vO_wJsob+NJp5a0CKYHw@mail.gmail.com>
	<CA+xi=qZWdjQc7B8JZqQfm3NgEmjG-xEFZazTKzVqSpVWKi27=g@mail.gmail.com>
	<CAPNjSFYzDgebdwMqPSY3qnmioqxNNLkxMvkGmz+rxHRRh08_BQ@mail.gmail.com>
Message-ID: <CAPNjSFZdUbkf9PudSDpfK8HTcAjdV0wpHGrq56W1P9K9ooxqzw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/5fe2b316/attachment.pl>

From mamushbukana at gmail.com  Wed Mar 14 17:04:37 2012
From: mamushbukana at gmail.com (mamush bukana)
Date: Wed, 14 Mar 2012 16:04:37 +0000
Subject: [R-SIG-Finance] how to test significance of VAR coefficients in DCC
	GARCH Fit
Message-ID: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120314/cf6746e9/attachment.pl>

From arun.kumar.saha at gmail.com  Wed Mar 14 17:20:59 2012
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Wed, 14 Mar 2012 09:20:59 -0700 (PDT)
Subject: [R-SIG-Finance] how to test significance of VAR coefficients in
	DCC GARCH Fit
In-Reply-To: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>
References: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>
Message-ID: <1331742059131-4472328.post@n4.nabble.com>

The estimates of the VAR parameters and the Garch parameters are
asymptotically independent. Therefore you first fit the VAR parameters are
then fit the Garch model on the residuals (if there any Arch Effect at all).
Therefore, you can get all asymptotic parameter estimates result from
appropriate VAR fitting tool (there are lot of available with R.)

HTH

Thanks and regards,

_____________________________________________________

Arun Kumar Saha, FRM
QUANTITATIVE RISK AND HEDGE CONSULTING SPECIALIST
Visit me at: http://in.linkedin.com/in/ArunFRM
_____________________________________________________

--
View this message in context: http://r.789695.n4.nabble.com/how-to-test-significance-of-VAR-coefficients-in-DCC-GARCH-Fit-tp4472274p4472328.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From alexios at 4dscape.com  Wed Mar 14 17:34:43 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Wed, 14 Mar 2012 16:34:43 +0000
Subject: [R-SIG-Finance] how to test significance of VAR coefficients in
 DCC GARCH Fit
In-Reply-To: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>
References: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>
Message-ID: <4F60C8A3.6060100@4dscape.com>

Currently the DCCfit object (returned from running dccfit) does not 
return all the information on the VAR (coefficients can be extracted by 
looking at the model slot and 'varcoef' list i.e. fit at model$varcoef).

A better approach is to first estimate the VAR model using the function
'varxfit' in the package which returns the standard errors and all 
relevant information, and then passing this returned object to the 
dccfit routine (example follows).

#################
library(rmgarch)
data(dji30ret)
Data = dji30ret[, 1:3, drop = FALSE]

vfit = varxfit(X=Data, p=1, exogen = NULL, robust = FALSE,
gamma = 0.25, delta = 0.01, nc = 10, ns = 500, postpad = "constant")

uspec = ugarchspec(mean.model = list(armaOrder = c(0,0), include.mean = 
FALSE), variance.model = list(garchOrder = c(1,1), model = "sGARCH"),
distribution.model = "norm")

spec = dccspec(uspec = multispec( replicate(3, uspec) ), VAR = TRUE,
lag = 1, dccOrder = c(1,1), asymmetric = FALSE, distribution = "mvnorm")

fit = dccfit(spec, data = Data, fit.control = list(eval.se=TRUE), 
VAR.fit = vfit)
#################

The package also includes for convenience the 'varxfilter', 
'varxforecast' and 'varxsim' functions which are used by the 
multivariate garch routines internally.

As mentioned in the documentation, a comprehensive list of examples are 
included in the 'inst/rmgarch.tests' folder of the package.

Regards,

Alexios


On 14/03/2012 16:04, mamush bukana wrote:
> Dear all,
> I fit a  DCC-GARCH model using "dccfit" function in "rmgarch" package. The
> "show()" method there gives summary of the GARCH and DCC parameters only,
> but not of the VAR ones. May you suggest me how to get the summary
> (including significance test) of the VAR parameters please?
>
> Many thanks as usual
>
> Mamush
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>


From junluke at gmail.com  Thu Mar 15 06:12:13 2012
From: junluke at gmail.com (jun wang)
Date: Thu, 15 Mar 2012 00:12:13 -0500
Subject: [R-SIG-Finance] how to test significance of VAR coefficients in
 DCC GARCH Fit
In-Reply-To: <4F60C8A3.6060100@4dscape.com>
References: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>
	<4F60C8A3.6060100@4dscape.com>
Message-ID: <CAPD4hGAjCJZjGG0OSZGePY_qnC5pQXexF4t7Gv2ApD4HTx-A7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120315/47295a0e/attachment.pl>

From alexios at 4dscape.com  Thu Mar 15 09:40:41 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Thu, 15 Mar 2012 08:40:41 +0000
Subject: [R-SIG-Finance] how to test significance of VAR coefficients in
 DCC GARCH Fit
In-Reply-To: <CAPD4hGAjCJZjGG0OSZGePY_qnC5pQXexF4t7Gv2ApD4HTx-A7w@mail.gmail.com>
References: <CAFxDEqLuQu2+ZL_4xQU7jN4KsAKc4m3Fu8qCDRfnL9KESyXTCA@mail.gmail.com>
	<4F60C8A3.6060100@4dscape.com>
	<CAPD4hGAjCJZjGG0OSZGePY_qnC5pQXexF4t7Gv2ApD4HTx-A7w@mail.gmail.com>
Message-ID: <4F61AB09.30601@4dscape.com>

Its on R-Forge (http://r-forge.r-project.org/R/?group_id=339).

I've triggered a rebuild of the package (its been offline since the 
R-Forge master upgrade) so you'll have to wait until the check/build 
cycle completes (24-48 hours).

Regards,
Alexios

On 15/03/2012 05:12, jun wang wrote:
> Anyone knows where to down the rmgarch package? I looked over the CRAN,
> it was not there. Many thanks!!!


From krishna at primps.com.sg  Thu Mar 15 11:09:57 2012
From: krishna at primps.com.sg (SNV Krishna)
Date: Thu, 15 Mar 2012 18:09:57 +0800
Subject: [R-SIG-Finance] different results with fExoticOptions
Message-ID: <00ad01cd0293$c67ad840$537088c0$@com.sg>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120315/2fc377e5/attachment.pl>

From arun.kumar.saha at gmail.com  Thu Mar 15 12:14:05 2012
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Thu, 15 Mar 2012 04:14:05 -0700 (PDT)
Subject: [R-SIG-Finance] different results with fExoticOptions
In-Reply-To: <00ad01cd0293$c67ad840$537088c0$@com.sg>
References: <00ad01cd0293$c67ad840$537088c0$@com.sg>
Message-ID: <1331810045892-4474571.post@n4.nabble.com>

Here, it is how you should use these formulas:

"The other calculators gave a value of 51.61"

> LevyAsianApproxOption('c', S = 1120, SA = 1120, X = 1140, Time = 1, time = 
+ 1,r = .05, b = (0.05-.01), sigma = .2) 

Title:
 Levy Asian Approximated Option 

Call:
 LevyAsianApproxOption(TypeFlag = "c", S = 1120, SA = 1120, X = 1140, 
     Time = 1, time = 1, r = 0.05, b = (0.05 - 0.01), sigma = 0.2)

Parameters:
          Value:
 TypeFlag c     
 S        1120  
 SA       1120  
 X        1140  
 Time     1     
 time     1     
 r        0.05  
 b        0.04  
 sigma    0.2   

Option Price:
 51.61407 

Description:
 Thu Mar 15 16:42:38 2012 


HTH,

Thanks and regards,

_____________________________________________________

Arun Kumar Saha, FRM
QUANTITATIVE RISK AND HEDGE CONSULTING SPECIALIST
Visit me at: http://in.linkedin.com/in/ArunFRM
_____________________________________________________


--
View this message in context: http://r.789695.n4.nabble.com/different-results-with-fExoticOptions-tp4474445p4474571.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From terry.griffin at comcast.net  Thu Mar 15 23:26:30 2012
From: terry.griffin at comcast.net (Terry Griffin)
Date: Thu, 15 Mar 2012 22:26:30 +0000 (UTC)
Subject: [R-SIG-Finance] Portfolio cardinality constraints using solve.QP
Message-ID: <903163601.89490.1331850390774.JavaMail.root@sz0091a.emeryville.ca.mail.comcast.net>


Dear List, 

There has been some interest in imposing cardinality constraints in a portfolio optimization such that optimal portfolios are constrained to a minimum and maximum number of assets; recent literature has suggested genetic algorithms. One blogger suggested how this can be accomplished with R: http://systematicinvestor.wordpress.com/2011/10/20/minimum-investment-and-number-of-assets-portfolio-cardinality-constraints/ 

However, I am not sure how this can be accomplished in portfolio.optim function from tseries (and thus solve.QP from quadprog). 

The usage for portfolio.optim does not appear to have the capability of cardinality constraints? 


portfolio.optim(x, pm = mean(x), riskless = FALSE, shorts = FALSE, rf = 0.0, reslow = NULL, reshigh = NULL, covmat = cov(x), ...) 


? so I examined the usage of solve.QP and have considered whether it would be possible to modify Amat and/or bvec to accommodate the cardinally constraint? 

solve.QP(Dmat, dvec, Amat, bvec, meq=0, factorized=FALSE)

Any suggestions on how to perform this with solve.QP or other alternative is appreciated. 

Thank you, 


Terry 


Terry Griffin, Ph.D.
terry.griffin at comcast.net 


From investorcurious at gmail.com  Fri Mar 16 01:44:03 2012
From: investorcurious at gmail.com (none)
Date: Thu, 15 Mar 2012 19:44:03 -0500
Subject: [R-SIG-Finance] =?windows-1252?q?quadprog_error=3F?=
Message-ID: <4F628CD3.9080506@gmail.com>

I want to report a following error with quadprog. The solve.QP function 
finds a solution to the problem below that violates the last equality 
constraint. I tried to solve the same problem using ipop from kernlab 
package and get the solution in which all equality constraints are 
enforced. I also tried an old version of quadprog, Version: 1.4-11, 
Date: 2007-07-12 and my problem is solved correctly.

I have tried to contact Berwin A. Turlach <Berwin.Turlach at gmail.com> 
(maintainer for quadprog package) with no success.


##############################################################
load(file='quadprog.Rdata')		

	# solve QP using quadprog	
	require(quadprog)
	sol = solve.QP(Dmat, dvec, Amat, bvec, meq)
		x = sol$solution
		check = x %*% Amat - bvec	
		# for some reason last equlity constraint is violated
		round(check[1:meq], 4) 


	# solve QP using kernlab
	require(kernlab)	
	n = nrow(Amat)
	sv = ipop(c = matrix(dvec), H = Dmat, A = t(Amat[,1:meq]),
			b = bvec[1:meq], l = rep(-1000, n), 
			u = rep(1000, n), r = rep(0,meq))
				
		x = primal(sv)
		check = x %*% Amat - bvec	
		# all constraints are ok
		round(check[1:meq], 4) 




-------------- next part --------------
A non-text attachment was scrubbed...
Name: quadprog.Rdata
Type: application/octet-stream
Size: 3568 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120315/e2dbe77b/attachment.obj>

From krishna at primps.com.sg  Fri Mar 16 03:52:04 2012
From: krishna at primps.com.sg (SNV Krishna)
Date: Fri, 16 Mar 2012 10:52:04 +0800
Subject: [R-SIG-Finance] different results with fExoticOptions
In-Reply-To: <1331810045892-4474571.post@n4.nabble.com>
References: <00ad01cd0293$c67ad840$537088c0$@com.sg>
	<1331810045892-4474571.post@n4.nabble.com>
Message-ID: <009901cd031f$c4cde5f0$4e69b1d0$@com.sg>

Hi Arun,

Thanks for this and the answer matches. But this led to another question;
which is the right way to input the value for b. I saw on the help file and
example given there suggests that the entry as b = 0.01 and not b =
(0.5-01).

====
Example
## Levy Asian Approximation:   
   LevyAsianApproxOption(TypeFlag = "c", S = 100, SA = 100, X = 105, 
     Time = 0.75, time = 0.50, r = 0.10, b = 0.05, sigma = 0.15)
===============

Can any one or the author suggest the right way. 

Thanks and best regards,

S.N.V. Krishna


-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Arun.stat
Sent: Thursday, March 15, 2012 7:14 PM
To: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] different results with fExoticOptions

Here, it is how you should use these formulas:

"The other calculators gave a value of 51.61"

> LevyAsianApproxOption('c', S = 1120, SA = 1120, X = 1140, Time = 1, 
> time =
+ 1,r = .05, b = (0.05-.01), sigma = .2)

Title:
 Levy Asian Approximated Option 

Call:
 LevyAsianApproxOption(TypeFlag = "c", S = 1120, SA = 1120, X = 1140, 
     Time = 1, time = 1, r = 0.05, b = (0.05 - 0.01), sigma = 0.2)

Parameters:
          Value:
 TypeFlag c     
 S        1120  
 SA       1120  
 X        1140  
 Time     1     
 time     1     
 r        0.05  
 b        0.04  
 sigma    0.2   

Option Price:
 51.61407 

Description:
 Thu Mar 15 16:42:38 2012 


HTH,

Thanks and regards,

_____________________________________________________

Arun Kumar Saha, FRM
QUANTITATIVE RISK AND HEDGE CONSULTING SPECIALIST Visit me at:
http://in.linkedin.com/in/ArunFRM
_____________________________________________________


--
View this message in context:
http://r.789695.n4.nabble.com/different-results-with-fExoticOptions-tp447444
5p4474571.html
Sent from the Rmetrics mailing list archive at Nabble.com.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From arun.kumar.saha at gmail.com  Fri Mar 16 07:19:45 2012
From: arun.kumar.saha at gmail.com (Arun Kumar Saha)
Date: Fri, 16 Mar 2012 11:49:45 +0530
Subject: [R-SIG-Finance] different results with fExoticOptions
In-Reply-To: <009901cd031f$c4cde5f0$4e69b1d0$@com.sg>
References: <00ad01cd0293$c67ad840$537088c0$@com.sg>
	<1331810045892-4474571.post@n4.nabble.com>
	<009901cd031f$c4cde5f0$4e69b1d0$@com.sg>
Message-ID: <CAPVuaOe9CNNGLmsVK3_KC9j6V7z8j=Qq+G1DgSwvJBndhL19Eg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120316/47777339/attachment.pl>

From alexios at 4dscape.com  Fri Mar 16 08:19:26 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Fri, 16 Mar 2012 07:19:26 +0000
Subject: [R-SIG-Finance] Portfolio cardinality constraints using solve.QP
In-Reply-To: <903163601.89490.1331850390774.JavaMail.root@sz0091a.emeryville.ca.mail.comcast.net>
References: <903163601.89490.1331850390774.JavaMail.root@sz0091a.emeryville.ca.mail.comcast.net>
Message-ID: <4F62E97E.3080600@4dscape.com>

Cardinality constraints require binary variables (mixed integer solver) 
and you cannot achieve this with the standard quadprog package. The 
blogger whose url reference you cite makes use of a branch and bound 
(BNB) algorithm to achieve this which is available from his git repository.
For a more general review of the BNB with QP method for cardinality 
constrained portfolios see:
http://www.mit.edu/~dbertsim/papers/Optimization/Algorithm%20For%20Cardinality-Constrained%20Quadratic%20Optimization.pdf

Regards,
Alexios


On 15/03/2012 22:26, Terry Griffin wrote:
>
> Dear List,
>
> There has been some interest in imposing cardinality constraints in a portfolio optimization such that optimal portfolios are constrained to a minimum and maximum number of assets; recent literature has suggested genetic algorithms. One blogger suggested how this can be accomplished with R: http://systematicinvestor.wordpress.com/2011/10/20/minimum-investment-and-number-of-assets-portfolio-cardinality-constraints/
>
> However, I am not sure how this can be accomplished in portfolio.optim function from tseries (and thus solve.QP from quadprog).
>
> The usage for portfolio.optim does not appear to have the capability of cardinality constraints?
>
>
> portfolio.optim(x, pm = mean(x), riskless = FALSE, shorts = FALSE, rf = 0.0, reslow = NULL, reshigh = NULL, covmat = cov(x), ...)
>
>
> ? so I examined the usage of solve.QP and have considered whether it would be possible to modify Amat and/or bvec to accommodate the cardinally constraint?
>
> solve.QP(Dmat, dvec, Amat, bvec, meq=0, factorized=FALSE)
>
> Any suggestions on how to perform this with solve.QP or other alternative is appreciated.
>
> Thank you,
>
>
> Terry
>
>
> Terry Griffin, Ph.D.
> terry.griffin at comcast.net
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From krishna at primps.com.sg  Fri Mar 16 08:46:17 2012
From: krishna at primps.com.sg (SNV Krishna)
Date: Fri, 16 Mar 2012 15:46:17 +0800
Subject: [R-SIG-Finance] different results with fExoticOptions
In-Reply-To: <CAPVuaOe9CNNGLmsVK3_KC9j6V7z8j=Qq+G1DgSwvJBndhL19Eg@mail.gmail.com>
References: <00ad01cd0293$c67ad840$537088c0$@com.sg>
	<1331810045892-4474571.post@n4.nabble.com>
	<009901cd031f$c4cde5f0$4e69b1d0$@com.sg>
	<CAPVuaOe9CNNGLmsVK3_KC9j6V7z8j=Qq+G1DgSwvJBndhL19Eg@mail.gmail.com>
Message-ID: <00c101cd0348$debb5500$9c31ff00$@com.sg>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120316/770dc6e3/attachment.pl>

From arun.kumar.saha at gmail.com  Fri Mar 16 08:56:40 2012
From: arun.kumar.saha at gmail.com (Arun Kumar Saha)
Date: Fri, 16 Mar 2012 13:26:40 +0530
Subject: [R-SIG-Finance] different results with fExoticOptions
In-Reply-To: <00c101cd0348$debb5500$9c31ff00$@com.sg>
References: <00ad01cd0293$c67ad840$537088c0$@com.sg>
	<1331810045892-4474571.post@n4.nabble.com>
	<009901cd031f$c4cde5f0$4e69b1d0$@com.sg>
	<CAPVuaOe9CNNGLmsVK3_KC9j6V7z8j=Qq+G1DgSwvJBndhL19Eg@mail.gmail.com>
	<00c101cd0348$debb5500$9c31ff00$@com.sg>
Message-ID: <CAPVuaOc8wnBqREKsh4Oq7ADdxfRUoOo1X7OVTFTd8AkjaoxrWw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120316/84ce9856/attachment.pl>

From enricoschumann at yahoo.de  Fri Mar 16 11:53:59 2012
From: enricoschumann at yahoo.de (Enrico Schumann)
Date: Fri, 16 Mar 2012 11:53:59 +0100
Subject: [R-SIG-Finance] quadprog error?
In-Reply-To: <4F628CD3.9080506@gmail.com>
References: <4F628CD3.9080506@gmail.com>
Message-ID: <4F631BC7.9050903@yahoo.de>


Hi <?>,

I did *not* check your code, but:

(1) when did you contact the package maintainer? Please keep in mind 
that maintaining a package is volunteer work; so you may want to grant 
the maintainer a few days to consider your message.

(2) Unless this is a very finance-specific problem, you may then want to 
post such a question on r-help (as the posting guide suggests).

(3) A pointer: IIRC, the algorithm in solve.QP requires a 
positive-definite matrix; but yours seems rank-deficient (or very badly 
conditioned).

Regards,
Enrico



Am 16.03.2012 01:44, schrieb none:
> I want to report a following error with quadprog. The solve.QP function
> finds a solution to the problem below that violates the last equality
> constraint. I tried to solve the same problem using ipop from kernlab
> package and get the solution in which all equality constraints are
> enforced. I also tried an old version of quadprog, Version: 1.4-11,
> Date: 2007-07-12 and my problem is solved correctly.
>
> I have tried to contact Berwin A. Turlach <Berwin.Turlach at gmail.com>
> (maintainer for quadprog package) with no success.
>
>
> ##############################################################
> load(file='quadprog.Rdata')
>
> # solve QP using quadprog
> require(quadprog)
> sol = solve.QP(Dmat, dvec, Amat, bvec, meq)
> x = sol$solution
> check = x %*% Amat - bvec
> # for some reason last equlity constraint is violated
> round(check[1:meq], 4)
>
> # solve QP using kernlab
> require(kernlab)
> n = nrow(Amat)
> sv = ipop(c = matrix(dvec), H = Dmat, A = t(Amat[,1:meq]),
> b = bvec[1:meq], l = rep(-1000, n), u = rep(1000, n), r = rep(0,meq))
>
> x = primal(sv)
> check = x %*% Amat - bvec
> # all constraints are ok
> round(check[1:meq], 4)
>
>
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Enrico Schumann
Lucerne, Switzerland
http://nmof.net/


From investorcurious at gmail.com  Fri Mar 16 17:12:20 2012
From: investorcurious at gmail.com (none)
Date: Fri, 16 Mar 2012 11:12:20 -0500
Subject: [R-SIG-Finance] quadprog error?
In-Reply-To: <4F631BC7.9050903@yahoo.de>
References: <4F628CD3.9080506@gmail.com> <4F631BC7.9050903@yahoo.de>
Message-ID: <4F636664.5000902@gmail.com>

Enrico, thank you very much for a prompt reply.

I have contacted Berwin A. Turlach a week ago. I will follow your 
suggestion and will post this question to the r-help.

Regarding (3), my only concern is that this problem worked in the older 
version of quadprog, so I was surprised to stumble on this error.



Enrico Schumann wrote:
>
> Hi <?>,
>
> I did *not* check your code, but:
>
> (1) when did you contact the package maintainer? Please keep in mind 
> that maintaining a package is volunteer work; so you may want to grant 
> the maintainer a few days to consider your message.
>
> (2) Unless this is a very finance-specific problem, you may then want 
> to post such a question on r-help (as the posting guide suggests).
>
> (3) A pointer: IIRC, the algorithm in solve.QP requires a 
> positive-definite matrix; but yours seems rank-deficient (or very 
> badly conditioned).
>
> Regards,
> Enrico
>
>
>
> Am 16.03.2012 01:44, schrieb none:
>> I want to report a following error with quadprog. The solve.QP function
>> finds a solution to the problem below that violates the last equality
>> constraint. I tried to solve the same problem using ipop from kernlab
>> package and get the solution in which all equality constraints are
>> enforced. I also tried an old version of quadprog, Version: 1.4-11,
>> Date: 2007-07-12 and my problem is solved correctly.
>>
>> I have tried to contact Berwin A. Turlach <Berwin.Turlach at gmail.com>
>> (maintainer for quadprog package) with no success.
>>
>>
>> ##############################################################
>> load(file='quadprog.Rdata')
>>
>> # solve QP using quadprog
>> require(quadprog)
>> sol = solve.QP(Dmat, dvec, Amat, bvec, meq)
>> x = sol$solution
>> check = x %*% Amat - bvec
>> # for some reason last equlity constraint is violated
>> round(check[1:meq], 4)
>>
>> # solve QP using kernlab
>> require(kernlab)
>> n = nrow(Amat)
>> sv = ipop(c = matrix(dvec), H = Dmat, A = t(Amat[,1:meq]),
>> b = bvec[1:meq], l = rep(-1000, n), u = rep(1000, n), r = rep(0,meq))
>>
>> x = primal(sv)
>> check = x %*% Amat - bvec
>> # all constraints are ok
>> round(check[1:meq], 4)
>>
>>
>>
>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R 
>> questions should go.
>


From chris.montano at gmail.com  Fri Mar 16 21:15:41 2012
From: chris.montano at gmail.com (=?ISO-8859-1?Q?Chris_Monta=F1o?=)
Date: Fri, 16 Mar 2012 13:15:41 -0700
Subject: [R-SIG-Finance] Price Data Sources
Message-ID: <CAJP4ha+HvWzsFw8CMBhU5h_FzpPNi0i9MN=6d7aTseKGVOCong@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120316/16750f6d/attachment.pl>

From p.desmazis at gmail.com  Fri Mar 16 21:34:46 2012
From: p.desmazis at gmail.com (Pierre-Alexandre)
Date: Fri, 16 Mar 2012 20:34:46 +0000
Subject: [R-SIG-Finance] Compiling R code / java trading framework
Message-ID: <8748DD25-5CD5-42C0-A298-5881506B6BFD@gmail.com>

Hi everyone,

R is a very nice tool to elaborate complex trading strategies and pretty quickly. 

Nevertheless as the portfolio of strategies grows it becomes more and more time consuming to calculate the positions to execute.

Also I found it difficult to create a robust trading framework based on R. For example in many language it is much more easy to handle large number of files and classes (UML modelling, MVC, convention over configuration, repository....).

My question is in two parts. 

1- How would you structure your code so it stays manageable when you have a very large number of function and tools. In this field R is ok for short code but when it comes to manage trading platform it is very quickly a mess. so you have any good example of trading frameworks in R (or R combined with other languages)

2- to increase speed I saw that it should be possible to compile the code written in R since R 2.13. Do you confirm? Would you recommend that and do you have any tutorial or example on how to do that ?

In the end I was thinking about back testing in R and then recoding the strategies in another more structured and fast Langage like java for execution. 

But I think it is time consuming and it is a very bad idea  to recode your backtest in the end because it is going to create many discrepancies and errors.

Let me know what you think

Thank you


From gaurav_m_159 at yahoo.com  Sat Mar 17 08:56:58 2012
From: gaurav_m_159 at yahoo.com (Gaurav Malhotra)
Date: Sat, 17 Mar 2012 00:56:58 -0700 (PDT)
Subject: [R-SIG-Finance] Price Data Sources
In-Reply-To: <CAJP4ha+HvWzsFw8CMBhU5h_FzpPNi0i9MN=6d7aTseKGVOCong@mail.gmail.com>
References: <CAJP4ha+HvWzsFw8CMBhU5h_FzpPNi0i9MN=6d7aTseKGVOCong@mail.gmail.com>
Message-ID: <1331971018.65410.YahooMailNeo@web113610.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120317/0a7e755e/attachment.pl>

From ustaudinger at gmail.com  Sat Mar 17 10:23:30 2012
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Sat, 17 Mar 2012 10:23:30 +0100
Subject: [R-SIG-Finance] Compiling R code / java trading framework
In-Reply-To: <8748DD25-5CD5-42C0-A298-5881506B6BFD@gmail.com>
References: <8748DD25-5CD5-42C0-A298-5881506B6BFD@gmail.com>
Message-ID: <-3420833375899457623@unknownmsgid>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120317/51f7034c/attachment.pl>

From josh.m.ulrich at gmail.com  Sat Mar 17 17:31:14 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 17 Mar 2012 11:31:14 -0500
Subject: [R-SIG-Finance] Compiling R code / java trading framework
In-Reply-To: <8748DD25-5CD5-42C0-A298-5881506B6BFD@gmail.com>
References: <8748DD25-5CD5-42C0-A298-5881506B6BFD@gmail.com>
Message-ID: <CAPPM_gS8i6Qze0ztKe_MpOedLvu8RHTh2f=iH4XgGNNX6QozmQ@mail.gmail.com>

On Fri, Mar 16, 2012 at 3:34 PM, Pierre-Alexandre <p.desmazis at gmail.com> wrote:
> Hi everyone,
>
> R is a very nice tool to elaborate complex trading strategies and pretty quickly.
>
> Nevertheless as the portfolio of strategies grows it becomes more and more time consuming to calculate the positions to execute.
>
This is true of any language.

> Also I found it difficult to create a robust trading framework based on R. For example in many language it is much more easy to handle large number of files and classes (UML modelling, MVC, convention over configuration, repository....).
>
> My question is in two parts.
>
> 1- How would you structure your code so it stays manageable when you have a very large number of function and tools. In this field R is ok for short code but when it comes to manage trading platform it is very quickly a mess. so you have any good example of trading frameworks in R (or R combined with other languages)
>
Create a package.  See quantstrat:
http://r-forge.r-project.org/projects/blotter/

> 2- to increase speed I saw that it should be possible to compile the code written in R since R 2.13. Do you confirm? Would you recommend that and do you have any tutorial or example on how to do that ?
>
Yes, via the compiler package.  A tutorial isn't necessary.  Just read
the ?compile help file.

> In the end I was thinking about back testing in R and then recoding the strategies in another more structured and fast Langage like java for execution.
>
> But I think it is time consuming and it is a very bad idea ?to recode your backtest in the end because it is going to create many discrepancies and errors.
>
> Let me know what you think
>
You could write the more time consuming parts in C/C++ using R's C API
and/or Rcpp.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com


From gmonaie at gmail.com  Mon Mar 19 13:44:35 2012
From: gmonaie at gmail.com (G.abe Lin)
Date: Mon, 19 Mar 2012 08:44:35 -0400
Subject: [R-SIG-Finance] RBloomberg rounding price increments to 4 decimals
Message-ID: <CAJFvkccnDxgJ6AnQhppWqha3ZbT650+XJVtKDuv19-kCH0tn5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120319/e3d22f7e/attachment.pl>

From brian at braverock.com  Mon Mar 19 13:57:27 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 19 Mar 2012 07:57:27 -0500
Subject: [R-SIG-Finance] RBloomberg rounding price increments to 4
 decimals
In-Reply-To: <CAJFvkccnDxgJ6AnQhppWqha3ZbT650+XJVtKDuv19-kCH0tn5w@mail.gmail.com>
References: <CAJFvkccnDxgJ6AnQhppWqha3ZbT650+XJVtKDuv19-kCH0tn5w@mail.gmail.com>
Message-ID: <1332161847.28362.419.camel@brian-rcg>

The first thing to check is your options on R in general.

options(digits=10)

or even 

options(digits=12)

and see if that shows you the data you expect.

I'm not currently using RBloomberg, so I can't check this part of your
problem. 

Regards,

    - Brian



On Mon, 2012-03-19 at 08:44 -0400, G.abe Lin wrote:
> Hi guys,
> 
> I'm using RBloomberg to download OHLC data on futures into my
> environment.  I am porting my trading strategy from a custom framework
> to blotter and quantstrat.
> 
> I immediately noticed that the P&L did not reconcile, and that is
> apparently because of rounding to 4 decimal places on prices
> downloaded using RBloomberg.
> 
> The instruments I am looking at trade in 1/32nds and 1/64ths (+), and
> the 1/64ths are not 4 decimals long -- my prices are essentially
> getting truncated.
> 
> Has anyone dealt with this issue successfully before?  I am looking
> for a way to preserve the integrity of the price downloaded using
> RBloomberg.
> 
> All the code needed to reproduce this is below, thanks.
> 
> > sessionInfo()R version 2.14.1 (2011-12-22)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
> 
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252    LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C                           LC_TIME=English_United
> States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
>  [1] quantstrat_0.6.1             blotter_0.8.4
> stringr_0.6                  timeDate_2131.00
>  [5] PerformanceAnalytics_1.0.3.2 RODBC_1.3-4
> RBloomberg_0.4-150           rJava_0.9-3
>  [9] FinancialInstrument_0.11.3   quantmod_0.3-17
> TTR_0.21-0                   xts_0.8-4
> [13] zoo_1.7-7                    Defaults_1.1-1
> 
> loaded via a namespace (and not attached):
> [1] grid_2.14.1    lattice_0.20-0 plyr_1.7.1     tools_2.14.1
> 
> 
> require(RBloomberg)
> 
> > start_date[1] "20110922"> end_date[1] "20120319"> myInst$identifiers$BB[1] "USM2 Comdty"
> 
> > FLDS <- c("PX_OPEN","PX_HIGH","PX_LOW","PX_LAST")> > rs = bdh(conn,myInst$identifiers$BB,FLDS, start_date = start_date , end_date = end_date)
> 
> 
> rs
> ....
> 
> 2012-03-15 2012-03-15 136.7812 137.0000 135.5625 136.5312
> 2012-03-16 2012-03-16 136.4688 136.6250 135.4688 136.4375
> 2012-03-19 2012-03-19 136.4375 137.0000 136.1250 136.8438
> 
> 
> 
> 
> Don't quit. Suffer now and live the rest of your life as a champion.
> 
>                                                 - Muhammad Ali
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From john.laing at gmail.com  Mon Mar 19 14:13:46 2012
From: john.laing at gmail.com (John Laing)
Date: Mon, 19 Mar 2012 09:13:46 -0400
Subject: [R-SIG-Finance] RBloomberg rounding price increments to 4
	decimals
In-Reply-To: <1332161847.28362.419.camel@brian-rcg>
References: <CAJFvkccnDxgJ6AnQhppWqha3ZbT650+XJVtKDuv19-kCH0tn5w@mail.gmail.com>
	<1332161847.28362.419.camel@brian-rcg>
Message-ID: <CAA3Wa=uZN3SO1BicOZpbG+S_qSgmO5vEhSaX87-K26as-K7YQQ@mail.gmail.com>

I think it is just the display that is truncating digits. The actual
data stored should contain more precision.

> require(RBloomberg)
> conn <- blpConnect()
> rs <- bdh(conn, "USM2 Comdty", "PX_LAST", start_date = "20110922", end_date = "20120319")
> rs["2012-03-12", "PX_LAST"]
[1] 140.5312
> rs["2012-03-12", "PX_LAST"] == 140.5312
[1] FALSE
> rs["2012-03-12", "PX_LAST"] == 140.53125
[1] TRUE
>

John


On Mon, Mar 19, 2012 at 8:57 AM, Brian G. Peterson <brian at braverock.com> wrote:
> The first thing to check is your options on R in general.
>
> options(digits=10)
>
> or even
>
> options(digits=12)
>
> and see if that shows you the data you expect.
>
> I'm not currently using RBloomberg, so I can't check this part of your
> problem.
>
> Regards,
>
> ? ?- Brian
>
>
>
> On Mon, 2012-03-19 at 08:44 -0400, G.abe Lin wrote:
>> Hi guys,
>>
>> I'm using RBloomberg to download OHLC data on futures into my
>> environment. ?I am porting my trading strategy from a custom framework
>> to blotter and quantstrat.
>>
>> I immediately noticed that the P&L did not reconcile, and that is
>> apparently because of rounding to 4 decimal places on prices
>> downloaded using RBloomberg.
>>
>> The instruments I am looking at trade in 1/32nds and 1/64ths (+), and
>> the 1/64ths are not 4 decimals long -- my prices are essentially
>> getting truncated.
>>
>> Has anyone dealt with this issue successfully before? ?I am looking
>> for a way to preserve the integrity of the price downloaded using
>> RBloomberg.
>>
>> All the code needed to reproduce this is below, thanks.
>>
>> > sessionInfo()R version 2.14.1 (2011-12-22)
>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252 ?LC_CTYPE=English_United
>> States.1252 ? ?LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C ? ? ? ? ? ? ? ? ? ? ? ? ? LC_TIME=English_United
>> States.1252
>>
>> attached base packages:
>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>
>> other attached packages:
>> ?[1] quantstrat_0.6.1 ? ? ? ? ? ? blotter_0.8.4
>> stringr_0.6 ? ? ? ? ? ? ? ? ?timeDate_2131.00
>> ?[5] PerformanceAnalytics_1.0.3.2 RODBC_1.3-4
>> RBloomberg_0.4-150 ? ? ? ? ? rJava_0.9-3
>> ?[9] FinancialInstrument_0.11.3 ? quantmod_0.3-17
>> TTR_0.21-0 ? ? ? ? ? ? ? ? ? xts_0.8-4
>> [13] zoo_1.7-7 ? ? ? ? ? ? ? ? ? ?Defaults_1.1-1
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.14.1 ? ?lattice_0.20-0 plyr_1.7.1 ? ? tools_2.14.1
>>
>>
>> require(RBloomberg)
>>
>> > start_date[1] "20110922"> end_date[1] "20120319"> myInst$identifiers$BB[1] "USM2 Comdty"
>>
>> > FLDS <- c("PX_OPEN","PX_HIGH","PX_LOW","PX_LAST")> > rs = bdh(conn,myInst$identifiers$BB,FLDS, start_date = start_date , end_date = end_date)
>>
>>
>> rs
>> ....
>>
>> 2012-03-15 2012-03-15 136.7812 137.0000 135.5625 136.5312
>> 2012-03-16 2012-03-16 136.4688 136.6250 135.4688 136.4375
>> 2012-03-19 2012-03-19 136.4375 137.0000 136.1250 136.8438
>>
>>
>>
>>
>> Don't quit. Suffer now and live the rest of your life as a champion.
>>
>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? - Muhammad Ali
>>
>> ? ? ? [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From gmonaie at gmail.com  Mon Mar 19 14:13:46 2012
From: gmonaie at gmail.com (G.abe Lin)
Date: Mon, 19 Mar 2012 09:13:46 -0400
Subject: [R-SIG-Finance] RBloomberg rounding price increments to 4
	decimals
In-Reply-To: <1332161847.28362.419.camel@brian-rcg>
References: <CAJFvkccnDxgJ6AnQhppWqha3ZbT650+XJVtKDuv19-kCH0tn5w@mail.gmail.com>
	<1332161847.28362.419.camel@brian-rcg>
Message-ID: <CAJFvkcfsXJKrG9oNyFC62O-nTBJ+10WNh42U92gfRWb1gz6W2A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120319/67667d15/attachment.pl>

From comtech.usa at gmail.com  Mon Mar 19 15:31:05 2012
From: comtech.usa at gmail.com (Michael)
Date: Mon, 19 Mar 2012 09:31:05 -0500
Subject: [R-SIG-Finance] significant lags in causality test?
Message-ID: <CAPNjSFbSJyyx0EUaaH-TBoSGLco_Vjpp3asXJOSpzbz5-b5Ojg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120319/8bba012a/attachment.pl>

From edd at debian.org  Tue Mar 20 03:03:32 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 19 Mar 2012 21:03:32 -0500
Subject: [R-SIG-Finance] R/Finance 2012 Registration Open,
	(Draft) Agenda Posted
Message-ID: <20327.58740.398600.251335@max.nulle.part>


The registration for R/Finance 2012 -- which will take place May 11 and 12
in Chicago -- is NOW OPEN!
 
Building on the success of the three previous conferences in 2009, 2010,
and 2011, we expect more than 250 attendees from around the world.  R
users from industry, academia, and government will join 40+ presenters
covering all areas of finance with R.

This year's conference will start earlier in the day on Friday, to
accommodate the tremendous line up of speakers for 2012, as well as to
provide more time between talks for networking.

We are very excited about the four keynotes by Paul Gilbert, Blair
Hull, Rob McCulloch, and Simon Urbanek.  The main agenda includes
nineteen full presentations and eighteen shorter "lightning talks".
We are also excited to offer six optional pre-conference seminars on
Friday morning.

Once again, we are hosting the R/Finance conference dinner on Friday
evening, where you can continue conversations while dining and
drinking atop a West Loop restaurant overlooking the Chicago skyline.

More details of the agenda are available at:

   http://www.RinFinance.com/agenda/

Registration information is available at 

   http://www.RinFinance.com/register/

and can also be directly accessed by going to

   http://www.regonline.com/RFinance2012


On behalf of the committee and sponsors, we look forward to seeing you
in Chicago!

   Gib Bassett, Peter Carl, Dirk Eddelbuettel, Brian Peterson,
   Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich


Our 2012 Sponsors:

   International Center for Futures and Derivatives at UIC

   Revolution Analytics
   Sybase
   MS-Computational Finance at University of Washington

   Google
   lemnica
   OpenGamma
   OneTick
   RStudio
   Tick Data



-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From xianli.analytics at gmail.com  Tue Mar 20 03:47:07 2012
From: xianli.analytics at gmail.com (Xian Li)
Date: Mon, 19 Mar 2012 22:47:07 -0400
Subject: [R-SIG-Finance] getQuote problem with multiple symbols
Message-ID: <73D33311-C281-430B-96C5-B16A400B51CC@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120319/61012cc5/attachment.pl>

From gsee000 at gmail.com  Tue Mar 20 04:21:45 2012
From: gsee000 at gmail.com (G See)
Date: Mon, 19 Mar 2012 22:21:45 -0500
Subject: [R-SIG-Finance] getQuote problem with multiple symbols
In-Reply-To: <73D33311-C281-430B-96C5-B16A400B51CC@gmail.com>
References: <73D33311-C281-430B-96C5-B16A400B51CC@gmail.com>
Message-ID: <CA+xi=qZO7z5DfxRxxKxpcwmC109iVkiUNQpMeHn=UQ8uWNOrrw@mail.gmail.com>

Hi Xian,

I have more of an observation than a solution.  "Float Shares" is what
is causing trouble; it returns more than 1 column of data.

Certainly not an ideal solution, but if you exclude "Float Shares"
from the call, it will work.

Also, the reason your first call failed is because there are 3 extra
NA columns for
> getQuote("AA", what=yahooQF("Float Shares"))
            Trade Time Float Shares NA  NA NA
AA 2012-03-19 04:00:00            1 65 286  0

But only 2 extra NA columns for the rest. For example,
> getQuote("AACC", what=yahooQF("Float Shares"))
              Trade Time Float Shares  NA NA
AACC 2012-03-19 04:00:00           14 847  0


HTH,
Garrett

On Mon, Mar 19, 2012 at 9:47 PM, Xian Li <xianli.analytics at gmail.com> wrote:
> Hi,
>
> I found getQuote returns different results while querying the same set of tickers but of different orders. Here's an example:
>
>> getQuote("AACC;AAC;AAME;AAN;AAON;AAPL;AAP;AA",what=yahooQF(c("Market Capitalization","EBITDA","P/E Ratio","Shares Owned","Short Ratio","Book Value", "Earnings/Share","Float Shares")))
> Error in `row.names<-.data.frame`(`*tmp*`, value = value) :
> ?invalid 'row.names' length
>> getQuote("AA;AACC;AAC;AAME;AAN;AAON;AAPL;AAP",what=yahooQF(c("Market Capitalization","EBITDA","P/E Ratio","Shares Owned","Short Ratio","Book Value", "Earnings/Share","Float Shares")))
> ? ? ? ? ? ? ?Trade Time Market Capitalization ?EBITDA P/E Ratio Shares Owned
> AA ? 2012-03-19 04:00:00 ? ? ? ? ? ? ? 11.301B ?3.268B ? ? 19.16 ? ? ? ? ? ?-
> AACC 2012-03-19 04:00:00 ? ? ? ? ? ? ? ?138.1M ? 37.1M ? ? 12.31 ? ? ? ? ? ?-
> AAC ?2012-03-13 12:26:00 ? ? ? ? ? ? ? ? 84.8M ? ? ? 0 ? ? ? N/A ? ? ? ? ? ?-
> AAME 2012-03-19 03:57:00 ? ? ? ? ? ? ? ? 63.8M ? ?7.4M ? ? 19.80 ? ? ? ? ? ?-
> AAN ?2012-03-19 04:01:00 ? ? ? ? ? ? ? ?1.980B ?274.8M ? ? 18.32 ? ? ? ? ? ?-
> AAON 2012-03-19 04:00:00 ? ? ? ? ? ? ? ?510.3M ? 40.0M ? ? 26.43 ? ? ? ? ? ?-
> AAPL 2012-03-19 04:00:00 ? ? ? ? ? ? ? ?560.4B 45.452B ? ? 16.66 ? ? ? ? ? ?-
> AAP ?2012-03-19 04:02:00 ? ? ? ? ? ? ? ?6.454B ?841.7M ? ? 17.23 ? ? ? ? ? ?-
> ? ? Short Ratio Book Value Earnings/Share Float Shares ?NA ?NA NA
> AA ? ? ? ? ? 3.1 ? ? 12.955 ? ? ? ? ?0.550 ? ? ? ? ? ?1 ?65 286 ?0
> AACC ? ? ? ?15.0 ? ? ?4.497 ? ? ? ? ?0.390 ? ? ? ? ? 14 847 ? 0 NA
> AAC ? ? ? ? 10.3 ? ? ?0.658 ? ? ? ? -0.043 ? ? ? ? ? ?4 771 ? 0 NA
> AAME ? ? ? ? 0.3 ? ? ?4.277 ? ? ? ? ?0.150 ? ? ? ? ? ?6 956 ? 0 NA
> AAN ? ? ? ? ?4.2 ? ? 12.910 ? ? ? ? ?1.430 ? ? ? ? ? 68 ?60 ? 0 NA
> AAON ? ? ? ?34.4 ? ? ?5.081 ? ? ? ? ?0.767 ? ? ? ? ? 18 590 ? 0 NA
> AAPL ? ? ? ? 0.5 ? ? 96.602 ? ? ? ? 35.138 ? ? ? ? ?931 791 ? 0 NA
> AAP ? ? ? ? ?1.6 ? ? 11.677 ? ? ? ? ?5.110 ? ? ? ? ? 72 323 ? 0 NA
>
> Besides, in the example above, why there're 3 columns named "NA" after the "Float Shares" which was the last attribute in my query?
>
> Can anyone help? Thanks!
>
> best regards,
> Xian
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From gsee000 at gmail.com  Tue Mar 20 04:27:31 2012
From: gsee000 at gmail.com (G See)
Date: Mon, 19 Mar 2012 22:27:31 -0500
Subject: [R-SIG-Finance] getQuote problem with multiple symbols
In-Reply-To: <CA+xi=qZO7z5DfxRxxKxpcwmC109iVkiUNQpMeHn=UQ8uWNOrrw@mail.gmail.com>
References: <73D33311-C281-430B-96C5-B16A400B51CC@gmail.com>
	<CA+xi=qZO7z5DfxRxxKxpcwmC109iVkiUNQpMeHn=UQ8uWNOrrw@mail.gmail.com>
Message-ID: <CA+xi=qaZ+tTPENPJdj4txS8H6FrF1sWxN_6a3yU3+Gq6M-Ri+g@mail.gmail.com>

On Mon, Mar 19, 2012 at 10:21 PM, G See <gsee000 at gmail.com> wrote:
>> getQuote("AA", what=yahooQF("Float Shares"))
> ? ? ? ? ? ?Trade Time Float Shares NA ?NA NA
> AA 2012-03-19 04:00:00 ? ? ? ? ? ?1 65 286 ?0

This is probably a single value of 1,065,286,000 that got spread
across some cells.


From xianli.analytics at gmail.com  Tue Mar 20 04:37:49 2012
From: xianli.analytics at gmail.com (Xian Li)
Date: Mon, 19 Mar 2012 23:37:49 -0400
Subject: [R-SIG-Finance] getQuote problem with multiple symbols
In-Reply-To: <CA+xi=qaZ+tTPENPJdj4txS8H6FrF1sWxN_6a3yU3+Gq6M-Ri+g@mail.gmail.com>
References: <73D33311-C281-430B-96C5-B16A400B51CC@gmail.com>
	<CA+xi=qZO7z5DfxRxxKxpcwmC109iVkiUNQpMeHn=UQ8uWNOrrw@mail.gmail.com>
	<CA+xi=qaZ+tTPENPJdj4txS8H6FrF1sWxN_6a3yU3+Gq6M-Ri+g@mail.gmail.com>
Message-ID: <3BB69075-DB98-4B61-80E0-96AB8C70ACDF@gmail.com>

Hi Garrett,

Thanks for your help! I verified from AA's page on Yahoo, and it's exactly 1.65 B . 

Xian
On Mar 19, 2012, at 11:27 PM, G See wrote:

> On Mon, Mar 19, 2012 at 10:21 PM, G See <gsee000 at gmail.com> wrote:
>>> getQuote("AA", what=yahooQF("Float Shares"))
>>            Trade Time Float Shares NA  NA NA
>> AA 2012-03-19 04:00:00            1 65 286  0
> 
> This is probably a single value of 1,065,286,000 that got spread
> across some cells.


From gmonaie at gmail.com  Tue Mar 20 20:05:56 2012
From: gmonaie at gmail.com (G.abe Lin)
Date: Tue, 20 Mar 2012 15:05:56 -0400
Subject: [R-SIG-Finance] data manipulation to for quantmod function
In-Reply-To: <CA+xi=qZz0pD-jfPtvf=+z76g2gLKXacvhRpsFgPioKPMSwJ4RA@mail.gmail.com>
References: <59C37CB7-0672-4468-B878-5E5FEB2E786E@gmail.com>
	<COL102-W29DDCC668A75080AE91EC48F9E0@phx.gbl>
	<CAJ_D83-rbPgtTOQRSfaMF8WJwWTngAjhJG5g9yNOXV0VPvtQhQ@mail.gmail.com>
	<COL102-W3338BC316847A20CDE34F48F9E0@phx.gbl>
	<CA+xi=qZz0pD-jfPtvf=+z76g2gLKXacvhRpsFgPioKPMSwJ4RA@mail.gmail.com>
Message-ID: <CAJFvkcc26feKzu7OZSda3jjvUFeyHpwdRnBV8GV6yvsu=Xq3ew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120320/eddf794c/attachment.pl>

From noreply+2603258452 at badoo.com  Wed Mar 21 06:35:22 2012
From: noreply+2603258452 at badoo.com (Badoo)
Date: Wed, 21 Mar 2012 05:35:22 +0000
Subject: [R-SIG-Finance] Chepe te ha dejado un mensaje...
Message-ID: <201203210535.q2L5ZQVk020328@hypatia.math.ethz.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120321/ccbe6170/attachment.pl>

From noreply+4190545477 at badoo.com  Wed Mar 21 06:35:21 2012
From: noreply+4190545477 at badoo.com (Badoo)
Date: Wed, 21 Mar 2012 05:35:21 +0000
Subject: [R-SIG-Finance] Chepe te ha dejado un mensaje...
Message-ID: <bb742a81-a2ea-429a-a881-b5c22f61b84d@edge20.ethz.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120321/e8367303/attachment.pl>

From wuwei_10003 at yahoo.com  Thu Mar 22 07:36:04 2012
From: wuwei_10003 at yahoo.com (Wei Wu)
Date: Wed, 21 Mar 2012 23:36:04 -0700 (PDT)
Subject: [R-SIG-Finance] How does one handle missing dates in
	quantmod/quantstrat time series?
Message-ID: <1332398164.5501.YahooMailNeo@web125806.mail.ne1.yahoo.com>

Sometimes the missing data could be data error/problem. But let's say the missing dates(data) were real. Then I would think we will need to filling in some data points with the same o/h/l/c as the previous close and zero volume. Any other alternatives?


What is the best and efficient way to handle this? Any exiting code/package that can handle this already?

Thanks.


From advaitgodbole at gmail.com  Thu Mar 22 09:13:29 2012
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Thu, 22 Mar 2012 13:43:29 +0530
Subject: [R-SIG-Finance] hourly time series
In-Reply-To: <CAAmySGOWN45D3k=Km4u9MWDNU_baGVnsHvH967qni5zRxb_d1w@mail.gmail.com>
References: <CAFdqCxsYJsWet9iGwycAkA=Dx16BAqZ1Po-D0gQoQaPrbSv_Ng@mail.gmail.com>
	<CAAmySGOWN45D3k=Km4u9MWDNU_baGVnsHvH967qni5zRxb_d1w@mail.gmail.com>
Message-ID: <CAFdqCxuem9UQ2oj1gOLzX+OohYFoKg79WL4K99EjhmZthSChQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120322/e90e36e4/attachment.pl>

From brian at braverock.com  Thu Mar 22 10:24:00 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 22 Mar 2012 04:24:00 -0500
Subject: [R-SIG-Finance] How does one handle missing dates in
 quantmod/quantstrat time series?
In-Reply-To: <1332398164.5501.YahooMailNeo@web125806.mail.ne1.yahoo.com>
References: <1332398164.5501.YahooMailNeo@web125806.mail.ne1.yahoo.com>
Message-ID: <1332408240.1378.14.camel@brian-desktop>

On Wed, 2012-03-21 at 23:36 -0700, Wei Wu wrote:
> Sometimes the missing data could be data error/problem. But let's say the missing dates(data) were real. Then I would think we will need to filling in some data points with the same o/h/l/c as the previous close and zero volume. Any other alternatives?

Handling missing data is a topic that will be very specific to your data
source (if you buy your data, you can work with the provider to fill in
missing periods), to your project (are you comparing data from related
firms for some analysis, building a strategy, or something else...), and
to the analytical technique you hope to apply (filling data will distort
your calculations).

With Bid and Ask data, it is more or less safe to na.locf, as the
prevailing market is still a real market.  If however markets are
closed, your market connectivity was down, etc, then you cannot trade,
so having no data at all is more appropriate.  Copying OHLC data forward
is almost always likely to be a bad idea.

> What is the best and efficient way to handle this? Any exiting code/package that can handle this already?

zoo (which xts shares a bunch of code with) already has interpolation
methods, na.locf, etc.

Please search the list archives before posting follow-up questions, as
there have been many many posts to this list over the years about
missing, filling, or interpolating data.

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Thu Mar 22 14:42:35 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 22 Mar 2012 08:42:35 -0500
Subject: [R-SIG-Finance] R participating in Google Summer of Code - call for
 students (and projects)
Message-ID: <1332423755.2761.21.camel@brian-rcg>

Once again, R has been accepted as a mentoring organization for the Google Summer of Code (2012).
We invite students interested in this program to learn more about it. A good starting
point is the R GSoC wiki[1]. Google information on the program is available via melange[2].

Students participating in the program receive US$5,000 for successful completion of a GSoC project, a great resume item, and an opportunity to work with R package authors.
 
There are three finance-related projects currently on the project ideas list:

Performance Attribution[3]	
Add portfolio performance and attribution functionality from Bacon to PerformanceAnalytics package 

Advanced Risk and Portfolio Management[4]
Port Matlab code published by Attilio Meucci for risk and portfolio management to R.

Extend RTAQ[5]	
Extend the RTAQ package with additional data interoperability and volatility measures.
(FYI: there is already a highly qualified student associated with this project idea)

There are additional non-finance R project ideas also listed on Ref [1].

Interested students should start working on applications now.  
The student application process opens on 26 March, and successful students in prior years have often posted draft applications to melange for comment as soon after the opening of the application process as possible.

The list of finance project ideas above is also by no means exhaustive.  Interested students or mentors are encouraged to discuss other project ideas on the gosoc-r google group[6].

Those interested in either student or mentor participation should join our Google list
gsoc-r at googlegroups.com as this is how we are communicating. Please provide a 1 sentence
intro to yourself as we have had attempts by spammers to join the group.

Note that GSOC is about CODING. It is not intended to fund research, but many activities
with R require code to advance our work, so the program can be very helpful to improving R.

For information, the admins this year are Toby Dylan Hocking and John Nash, with backups
Brian Peterson and Virgilio Gomez.

Happy coding,

 - Brian

Ref:
[1] R GSoC Wiki 
http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2012

[2] Google GSoC melange
http://www.google-melange.com/gsoc/homepage/google/gsoc2012

[3] Performance Attribution
http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2012:performanceanalytics

[4] Advanced Risk and Portfolio Management
http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2012:meucci

[5] Extend RTAQ
http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2012:rtaq

[6] gsoc-r Google group
http://groups.google.com/group/gsoc-r?pli=1


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From michael.weylandt at gmail.com  Thu Mar 22 15:00:05 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 22 Mar 2012 10:00:05 -0400
Subject: [R-SIG-Finance] hourly time series
In-Reply-To: <CAFdqCxuem9UQ2oj1gOLzX+OohYFoKg79WL4K99EjhmZthSChQQ@mail.gmail.com>
References: <CAFdqCxsYJsWet9iGwycAkA=Dx16BAqZ1Po-D0gQoQaPrbSv_Ng@mail.gmail.com>
	<CAAmySGOWN45D3k=Km4u9MWDNU_baGVnsHvH967qni5zRxb_d1w@mail.gmail.com>
	<CAFdqCxuem9UQ2oj1gOLzX+OohYFoKg79WL4K99EjhmZthSChQQ@mail.gmail.com>
Message-ID: <CAAmySGNcMRzrEM_wRukj9Ox9LBhzX_j=YnQwGprUuPzE2eSPMA@mail.gmail.com>

Well, simply, your problem is that the thing are providing is not
cut()-able in that no specific cut() method is provided. If you want
to cut on the start date, you can simply use cut(test$Start) or, for
the end date, cut(test$End). Though there may be better extractor
functions available....for the other stuff, you might be able to get
some help from the lubridate package.

And this won't work for ts objects because they don't store their
timestamps the same what at all.

Michael

On Thu, Mar 22, 2012 at 4:13 AM, Advait Godbole <advaitgodbole at gmail.com> wrote:
> thanks Michael, that worked.
>
> I now want to perform monthly and weekly decomposition. In a one-on-one
> conversation with fellow member Vlad, I was suggested to do the following.
> I'm posting it here for the forum and for other pointers.
>
> # define hourly data with monthly frequency
> wind.ts.monthbase <- ts(wind.MH, start=1, frequency=8760/12) ? ?#wind.MH is
> 8760 x 1 vector
> wind.ts.monthbase.decompose <- decompose(wind.ts.monthbase)
>
> # define hourly data with weekly frequency
> wind.ts.weekbase <- ts(wind.MH,start=1, frequency=8760/52.14286)
> #52.14286=8760/168
> wind.ts.weekbase.decompose <- decompose(wind.ts.weekbase)
>
> Vlad also suggested I could try using the "timetools" package to better
> preserve the time properties. Following on his lead, I was able to create a
> test time series:
>
> #use of timetools package
> # create an hourly time series starting on 1st April 2010, ending on 31st
> March 2011
> test <- RegularTimeIntervalDataFrame('2010-04-01','2011-03-31
> 23:00','hour',timezone="GMT",data=data.frame(test=1:8760))
>
> If anyone is familiar with this package, I would like to know how to
> extract
> 1. a particular month/group of months
> 2. the first day/first week etc of each month
> 3. all mondays, all tuesdays etc of the year
>
> I tried doing the above using the "cut" function with the following errors:
>> wind.ttools.weekly.data <- cut(test, breaks="week", start.on.monday=TRUE)
> Error in cut.default(test, breaks = "week", start.on.monday = TRUE) :
> ? 'x' must be numeric
>> wind.ttools.weekly.data <- cut(as.numeric(test), breaks="week",
>> start.on.monday=TRUE)
> Error in as.numeric(test) :
> ? cannot coerce type 'S4' to vector of type 'double'
>
> I havent yet been able to identify the cause of this issue.
>
> It will also be good to know if the same extraction can be performed on the
> "ts" object. Thanks in advance for your responses.
>
> Regards,
> Advait
>
> On Wed, Mar 14, 2012 at 6:41 PM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>>
>> I think you are interpreting your frequency argument incorrectly and
>> thus R is giving you an error message because you are asking for
>> seasonal trends but giving only one observation per "season" -- it's
>> rather subtle: as the help page says,
>>
>> frequency -- the number of observations per unit of time.
>>
>> Note that this works,
>>
>> wind_ts <- ts(cumsum(rnorm(8760)), start = 1, frequency = 24) # E.g.,
>> the relevant time scale is "daily" and you have 24 obs per day
>> (hourly)
>> decompose(wind_ts)
>>
>> This would be for a phenomenon that reoccurs daily: I'm not sure if a
>> single monsoon season (I think there's only one a year but I don't
>> really know Indian climatology so well) will give you sufficient power
>> for a statistically significant result, but you can cross that bridge
>> when you get to it.
>>
>> Hope this helps,
>>
>> Michael
>>
>> PS -- The ts class is generally considered a necessary evil around
>> here because of things like that ;-)
>>
>> On Wed, Mar 14, 2012 at 5:45 AM, Advait Godbole <advaitgodbole at gmail.com>
>> wrote:
>> > Dear all,
>> >
>> > I am new to this list and I first posted this query on the r-sig-geo
>> > forum,
>> > apologies for the cross-post. My question is not related to finance,
>> > however I am sure many users here will have experience with time series
>> > analysis and would be able to provide insight.
>> >
>> > I have one year's worth of hourly data, starting from 1st April 2010 and
>> > ending on 31st March 2011. I would like to perform time series analysis
>> > on
>> > it. New to time series analysis and not having used "ts" before, I am
>> > having trouble setting it up to correctly represent the data. I have R
>> > reading in the time series via:
>> > *wind_ts <- ts(wind.MH,start=1,frequency=1)*
>> >
>> > where "wind.MH" is a 8760x1 matrix object. I then tried to decompose the
>> > time series with the following error:
>> > *wind_ts_components <- decompose(wind_ts)*
>> > *Error in decompose(wind_ts) : time series has no or less than 2
>> > periods*
>> >
>> > The dataset is the hourly wind generation for Maharashtra, India and has
>> > some seasonality associated with the Indian monsoon. Ultimately, this is
>> > what I would like to identify. I imagine that correctly setting the
>> > "start"
>> > and "frequency" parameters is necessary to be able to parse the dataset
>> > ?into months and seasons. Someone suggested I use the "timetools"
>> > package
>> > instead but I havent had the chance to do so.
>> >
>> > I would greatly appreciate help on how to handle this and any leads on
>> > time
>> > series analysis for hourly data in general.
>> >
>> > Regards,
>> >
>> > --
>> > advait godbole
>> > analyst, prayas energy group
>> > pune, india
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>
>
>
>
> --
> advait godbole


From ezivot at u.washington.edu  Thu Mar 22 17:59:52 2012
From: ezivot at u.washington.edu (Eric Zivot)
Date: Thu, 22 Mar 2012 09:59:52 -0700 (PDT)
Subject: [R-SIG-Finance] CSDA Special Issue on STATISTICAL ALGORITHMS AND
 SOFTWARE IN R (fwd)
Message-ID: <alpine.LRH.2.01.1203220959520.19792@hymn13.u.washington.edu>

CSDA is a good outlet for some of the finance related development in R.
ez

---------- Forwarded message ----------
Date: Thu, 22 Mar 2012 14:14:36 +0200
From: Cristian Gatu <cristian.gatu at UNINE.CH>
To: ECONOMETRIC-RESEARCH at JISCMAIL.AC.UK
Subject: CSDA Special Issue on STATISTICAL ALGORITHMS AND SOFTWARE IN R

COMPUTATIONAL STATISTICS & DATA ANALYSIS
CALL FOR PAPERS
Special Issue on STATISTICAL ALGORITHMS AND SOFTWARE IN R
http://www.elsevier.com/locate/csda

http://www.compstat2012.org/SpecialIssues/SASR.pdf

The R system for statistical computing and graphics can be considered
the most important statistical software package, being increasingly
used as a programing environment. R's capabilities for contributed
extension packages make it easy to deploy new R code to the
community. This special issue is devoted to statistical algorithms and
software in R. Methodological contributions combined with sound R
implementations are strongly encouraged. The paper as well as the R
software will be reviewed. R code should be clearly documented and
typically be prepared in form of an extension package available
through one of the standard repositories (such as CRAN or
Bioconductor).  Replication scripts for all examples from the paper
need to be provided, demonstrating the usefulness of the R code and
the methodology/algorithm.

All topics related to computational statistics are of interest.  The
papers should have a methodological component and should provide a
solid R implementation in order to be considered for
publication. Authors who are uncertain about the suitability of their
papers should contact the special issue editors. All submissions must
contain original unpublished work not being considered for publication
elsewhere.

Submissions will be refereed according to standard procedures for
Computational Statistics & Data Analysis. Information about the
journal can be found at http://www.elsevier.com/locate/csda.

The deadline for submissions is 30th June 2012.  However, papers can
be submitted at any time; and, when they have been received, they will
enter the editorial system immediately.

Papers for the special issue should be submitted using the Elsevier
Electronic Submission tool EES: http://ees.elsevier.com/csda. In the
EES please choose the special issue on "Statistical Algorithms
and Software in R" and the Co-Editor responsible for the special
issues.

The special issue editors:

Peter Filzmoser, Vienna University of Technology, Austria.
E-mail: P.Filzmoser at tuwien.ac.at

Cristian Gatu, "Alexandru I. Cuza" University of Iasi, Romania.
E-mail: cgatu at info.uaic.ro

Achim Zeileis, Universitat Innsbruck, Austria.
Achim.Zeileis at R-project.org


From gommoskipper at gmail.com  Fri Mar 23 11:07:44 2012
From: gommoskipper at gmail.com (Paolo Giusti)
Date: Fri, 23 Mar 2012 11:07:44 +0100
Subject: [R-SIG-Finance] Vectorized local min/max finding
Message-ID: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>

I am trying to find a vectorized solution (if there is one) to a simple problem.

I have a vector of values representing the close prices of a security
and another vector of their moving average.
I construct a simple "distance" object of their difference:

diff <- close - ma

Now I would like to calculate some simple statistics like:

1. The number of times the diff crosses the '0' line
2. The duration between each cross (number of samples)
3. The min and max values of diff between each cross.

This is easy to do using "for loops" but really slow. Given this is a
really basic problem I'm hoping that there a faster solution.

Thank you
Paolo


From patrick at burns-stat.com  Fri Mar 23 11:23:58 2012
From: patrick at burns-stat.com (Patrick Burns)
Date: Fri, 23 Mar 2012 10:23:58 +0000
Subject: [R-SIG-Finance] Vectorized local min/max finding
In-Reply-To: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>
References: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>
Message-ID: <4F6C4F3E.9030608@burns-stat.com>

1) The 'rle' function is likely to help you.
Try:

rle(diff > 0)

2) You are likely to hear about this question
not being finance specific so other venues
would be more appropriate.

Pat


On 23/03/2012 10:07, Paolo Giusti wrote:
> I am trying to find a vectorized solution (if there is one) to a simple problem.
>
> I have a vector of values representing the close prices of a security
> and another vector of their moving average.
> I construct a simple "distance" object of their difference:
>
> diff<- close - ma
>
> Now I would like to calculate some simple statistics like:
>
> 1. The number of times the diff crosses the '0' line
> 2. The duration between each cross (number of samples)
> 3. The min and max values of diff between each cross.
>
> This is easy to do using "for loops" but really slow. Given this is a
> really basic problem I'm hoping that there a faster solution.
>
> Thank you
> Paolo
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From matthewcleggphd at gmail.com  Fri Mar 23 13:13:42 2012
From: matthewcleggphd at gmail.com (Matthew Clegg)
Date: Fri, 23 Mar 2012 08:13:42 -0400
Subject: [R-SIG-Finance] Vectorized local min/max finding
In-Reply-To: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>
References: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>
Message-ID: <CABLRk0FbKYv331-smXT=AGhbngqabDMPzdyjh9rMUwzcgu71yw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120323/e79ba3bb/attachment.pl>

From josh.m.ulrich at gmail.com  Fri Mar 23 13:27:10 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 23 Mar 2012 07:27:10 -0500
Subject: [R-SIG-Finance] Vectorized local min/max finding
In-Reply-To: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>
References: <CAEOUBb7BCnujjnOu2S-sJiPSDkC+dmesTzTDz2ap3B7faFzd8w@mail.gmail.com>
Message-ID: <CAPPM_gRLR0Cg1MVMSNMHkyLy34DcZGT=APEYQCELiz6_DMozBg@mail.gmail.com>

Here is how I would solve the problem using xts:

library(quantmod)
getSymbols("SPY")
SPY$ma <- SMA(Cl(SPY),50)
SPY$diff <- (Cl(SPY)-SPY$ma)
SPY$diff[1:50] <- 0
SPY$group <- cumsum(c(0,diff(SPY$diff>0,na.pad=FALSE)) != 0)
SPY$grpLen <- ave(SPY$diff, SPY$group, FUN=length)
SPY$grpMin <- ave(SPY$diff, SPY$group, FUN=min)
SPY$grpMax <- ave(SPY$diff, SPY$group, FUN=max)

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com



On Fri, Mar 23, 2012 at 5:07 AM, Paolo Giusti <gommoskipper at gmail.com> wrote:
> I am trying to find a vectorized solution (if there is one) to a simple problem.
>
> I have a vector of values representing the close prices of a security
> and another vector of their moving average.
> I construct a simple "distance" object of their difference:
>
> diff <- close - ma
>
> Now I would like to calculate some simple statistics like:
>
> 1. The number of times the diff crosses the '0' line
> 2. The duration between each cross (number of samples)
> 3. The min and max values of diff between each cross.
>
> This is easy to do using "for loops" but really slow. Given this is a
> really basic problem I'm hoping that there a faster solution.
>
> Thank you
> Paolo
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From golam.sakline at gmail.com  Sat Mar 24 14:01:08 2012
From: golam.sakline at gmail.com (Golam Sakline)
Date: Sat, 24 Mar 2012 13:01:08 +0000
Subject: [R-SIG-Finance] xts to timeSeries conversion
Message-ID: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>

How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.

Thanks

Riskmaverick 

Sent from my iPhone

From michael.weylandt at gmail.com  Sat Mar 24 14:13:05 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sat, 24 Mar 2012 09:13:05 -0400
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
Message-ID: <CAAmySGMmbrN+P5o3BgA_s1fy4GZ88Ck6=N6SuB6CoFkX1LYuzw@mail.gmail.com>

I'm not sure I understand. PerformanceAnalytics is part of the
"xts-family" (as opposed to the Rmetrics family) of finance packages.
Your problem may be that it requires returns, but consider this
(somewhat opaque) one liner.

charts.PerformanceSummary(ROC(Cl(to.weekly(Ad(getSymbols("IBM",auto.assign
= F))))))

which works just fine (using 3 packages explicitly and two major dependencies!)

Michael

On Sat, Mar 24, 2012 at 9:01 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.
>
> Thanks
>
> Riskmaverick
>
> Sent from my iPhone
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From brian at braverock.com  Sat Mar 24 14:13:19 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 24 Mar 2012 08:13:19 -0500
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
Message-ID: <1332594799.10078.4.camel@brian-desktop>

On Sat, 2012-03-24 at 13:01 +0000, Golam Sakline wrote:
> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.

PerformanceAnalytics uses xts internally for everything.  It also
accepts timeSeries-classed objects, but they will be converted to xts
internally.

You didn't follow the posting guide and provide a reproducible example,
so I can't tell what your problem really is, but the following works for
me:

require(quantmod)
require(PerformanceAnalytics)
getSymbols('IBM')
IBM$Returns<-Return.calculate(Cl(IBM))
charts.PerformanceSummary(IBM$Returns)



-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From gsee000 at gmail.com  Sat Mar 24 14:34:01 2012
From: gsee000 at gmail.com (G See)
Date: Sat, 24 Mar 2012 08:34:01 -0500
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <1332594799.10078.4.camel@brian-desktop>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
	<1332594799.10078.4.camel@brian-desktop>
Message-ID: <CA+xi=qbNquW=iWsUkmaCy6188M7p09OV52vdSd-U2PbCPoBvgQ@mail.gmail.com>

You may also be interested in
library(qmao)
?makeReturnFrame

which takes the name of one or more xts objects, extracts a column
(that you can specify with the "prefer" argument; if not specified, it
will default to "Adjusted" on yahoo data) from each of them and cbinds
those columns together.  Then it calculates returns so that you're
left with an object that charts.PerformanceSummary can use.

It's much more useful when you want to chart several Symbols at once.
It makes it easy to get data, merge, calculate returns, and chart all
in one line.  (RF is an alias for makeReturnFrame, and I'll use RF in
the examples because it is more compact)

library(qmao)
library(PerformanceAnalytics)
charts.PerformanceSummary(RF(getSymbols("IBM")))

The above will give a warning unless you have defined an instrument named "IBM"
You can either silence the warning
RF(getSymbols("IBM")), silent=TRUE)

or define the stock, which you could either do separately, or in the same line:
charts.PerformanceSummary(RF(getSymbols(stock("IBM", currency("USD")))))

or, to really see the convenience of RF, get more than one stock:
charts.PerformanceSummary(RF(getSymbols(stock(c("SPY", "DIA", "QQQ"),
currency("USD")))))

HTH,
Garrett

On Sat, Mar 24, 2012 at 8:13 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On Sat, 2012-03-24 at 13:01 +0000, Golam Sakline wrote:
>> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.
>
> PerformanceAnalytics uses xts internally for everything. ?It also
> accepts timeSeries-classed objects, but they will be converted to xts
> internally.
>
> You didn't follow the posting guide and provide a reproducible example,
> so I can't tell what your problem really is, but the following works for
> me:
>
> require(quantmod)
> require(PerformanceAnalytics)
> getSymbols('IBM')
> IBM$Returns<-Return.calculate(Cl(IBM))
> charts.PerformanceSummary(IBM$Returns)
>
>
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From student.northwestern at gmail.com  Sat Mar 24 14:38:10 2012
From: student.northwestern at gmail.com (Jim Green)
Date: Sat, 24 Mar 2012 09:38:10 -0400
Subject: [R-SIG-Finance] quantstrat package
Message-ID: <CACAe89x-Hnt+Ak88iFGV8tS0oUzREJsF5sji_kv9uue6+E9RRg@mail.gmail.com>

Good Morning!

Could anyone do a favor and attach a latest copyof quantstrat
http://r-forge.r-project.org/R/?group_id=316, it failed build and
can't be downloaded from the link.

Thanks,
Jim.


From josh.m.ulrich at gmail.com  Sat Mar 24 14:45:48 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 24 Mar 2012 08:45:48 -0500
Subject: [R-SIG-Finance] quantstrat package
In-Reply-To: <CACAe89x-Hnt+Ak88iFGV8tS0oUzREJsF5sji_kv9uue6+E9RRg@mail.gmail.com>
References: <CACAe89x-Hnt+Ak88iFGV8tS0oUzREJsF5sji_kv9uue6+E9RRg@mail.gmail.com>
Message-ID: <CAPPM_gQO0Tg+FrBuVnA6yPFaLJx=Cjrns0NMX7J0vkaGNn_=2g@mail.gmail.com>

Jim,

Just checkout the source yourself:
svn checkout svn://svn.r-forge.r-project.org/svnroot/blotter/

from:
http://r-forge.r-project.org/scm/?group_id=316

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com



On Sat, Mar 24, 2012 at 8:38 AM, Jim Green
<student.northwestern at gmail.com> wrote:
> Good Morning!
>
> Could anyone do a favor and attach a latest copyof quantstrat
> http://r-forge.r-project.org/R/?group_id=316, it failed build and
> can't be downloaded from the link.
>
> Thanks,
> Jim.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From student.northwestern at gmail.com  Sat Mar 24 14:48:55 2012
From: student.northwestern at gmail.com (Jim Green)
Date: Sat, 24 Mar 2012 09:48:55 -0400
Subject: [R-SIG-Finance] quantstrat package
In-Reply-To: <CAPPM_gQO0Tg+FrBuVnA6yPFaLJx=Cjrns0NMX7J0vkaGNn_=2g@mail.gmail.com>
References: <CACAe89x-Hnt+Ak88iFGV8tS0oUzREJsF5sji_kv9uue6+E9RRg@mail.gmail.com>
	<CAPPM_gQO0Tg+FrBuVnA6yPFaLJx=Cjrns0NMX7J0vkaGNn_=2g@mail.gmail.com>
Message-ID: <CACAe89w1t67C+w4Dd8+sdi8gweuA5_L_fXXtg4=tnoOCwAc9PA@mail.gmail.com>

On 24 March 2012 09:45, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> Jim,
>
> Just checkout the source yourself:
> svn checkout svn://svn.r-forge.r-project.org/svnroot/blotter/
>
> from:
> http://r-forge.r-project.org/scm/?group_id=316
>
> Best,
> --

Thank you!

Jim.

> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
>
>
>
> On Sat, Mar 24, 2012 at 8:38 AM, Jim Green
> <student.northwestern at gmail.com> wrote:
>> Good Morning!
>>
>> Could anyone do a favor and attach a latest copyof quantstrat
>> http://r-forge.r-project.org/R/?group_id=316, it failed build and
>> can't be downloaded from the link.
>>
>> Thanks,
>> Jim.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.


From golam.sakline at gmail.com  Sat Mar 24 14:58:07 2012
From: golam.sakline at gmail.com (Golam Sakline)
Date: Sat, 24 Mar 2012 13:58:07 +0000
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <CAAmySGMmbrN+P5o3BgA_s1fy4GZ88Ck6=N6SuB6CoFkX1LYuzw@mail.gmail.com>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
	<CAAmySGMmbrN+P5o3BgA_s1fy4GZ88Ck6=N6SuB6CoFkX1LYuzw@mail.gmail.com>
Message-ID: <313AA0EE-D328-4DAF-BB7F-3EA0D8A50F64@gmail.com>

Hi Michael,

Thank you for you reply, but in general are you aware of any ways to convert xts date to timeSeries date using intermediate data.frame conversion in between.

Thank you in advance.

Golam

Sent from my iPhone

On 24 Mar 2012, at 13:13, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:

> I'm not sure I understand. PerformanceAnalytics is part of the
> "xts-family" (as opposed to the Rmetrics family) of finance packages.
> Your problem may be that it requires returns, but consider this
> (somewhat opaque) one liner.
> 
> charts.PerformanceSummary(ROC(Cl(to.weekly(Ad(getSymbols("IBM",auto.assign
> = F))))))
> 
> which works just fine (using 3 packages explicitly and two major dependencies!)
> 
> Michael
> 
> On Sat, Mar 24, 2012 at 9:01 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
>> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.
>> 
>> Thanks
>> 
>> Riskmaverick
>> 
>> Sent from my iPhone
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.


From michael.weylandt at gmail.com  Sat Mar 24 14:59:51 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Sat, 24 Mar 2012 09:59:51 -0400
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <313AA0EE-D328-4DAF-BB7F-3EA0D8A50F64@gmail.com>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
	<CAAmySGMmbrN+P5o3BgA_s1fy4GZ88Ck6=N6SuB6CoFkX1LYuzw@mail.gmail.com>
	<313AA0EE-D328-4DAF-BB7F-3EA0D8A50F64@gmail.com>
Message-ID: <CAAmySGOiFi7CRCUs3gVDKE8FJo32tKYJHU+qeZ3g2R=UsVbLWw@mail.gmail.com>

Is as.timeSeries not sufficient? (It will dispatch to as.timeSeries.xts)

Michael

On Sat, Mar 24, 2012 at 9:58 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
> Hi Michael,
>
> Thank you for you reply, but in general are you aware of any ways to convert xts date to timeSeries date using intermediate data.frame conversion in between.
>
> Thank you in advance.
>
> Golam
>
> Sent from my iPhone
>
> On 24 Mar 2012, at 13:13, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:
>
>> I'm not sure I understand. PerformanceAnalytics is part of the
>> "xts-family" (as opposed to the Rmetrics family) of finance packages.
>> Your problem may be that it requires returns, but consider this
>> (somewhat opaque) one liner.
>>
>> charts.PerformanceSummary(ROC(Cl(to.weekly(Ad(getSymbols("IBM",auto.assign
>> = F))))))
>>
>> which works just fine (using 3 packages explicitly and two major dependencies!)
>>
>> Michael
>>
>> On Sat, Mar 24, 2012 at 9:01 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
>>> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.
>>>
>>> Thanks
>>>
>>> Riskmaverick
>>>
>>> Sent from my iPhone
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.


From jeffrey.ryan at lemnica.com  Sat Mar 24 15:08:21 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Sat, 24 Mar 2012 09:08:21 -0500
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <313AA0EE-D328-4DAF-BB7F-3EA0D8A50F64@gmail.com>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
	<CAAmySGMmbrN+P5o3BgA_s1fy4GZ88Ck6=N6SuB6CoFkX1LYuzw@mail.gmail.com>
	<313AA0EE-D328-4DAF-BB7F-3EA0D8A50F64@gmail.com>
Message-ID: <CABDUZc-iBX5BUN4JQiCu1L-uqap9UpwteGLqev4KdRM40Qy3bQ@mail.gmail.com>

as.XXXXXX is the R way to coerce objects, and xts follows this (as do
most of the time series classes)

One of the original design goals of xts was to remove the issues
surrounding all of the different time series classes that may be in R.
 R developers can convert to xts internally via try.xts and return
original object classes with "reclass".  PeformanceAnalytics does this
quite well, which makes it easy for users to pass in any time series
object - regardless of class.

At the user level, as.xts or as.XXXXX is all that is needed if you are
forced to convert, but as Brian points out - this isn't needed in PA
or other packages that use the xts methodology for internally
consistent conversions.

In short, it should (does) just work.  If it isn't, your data is
likely different than what you are telling us, but we'd need example
code as requested in the posting guides to be more helpful.

Best,
Jeff

On Sat, Mar 24, 2012 at 8:58 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
> Hi Michael,
>
> Thank you for you reply, but in general are you aware of any ways to convert xts date to timeSeries date using intermediate data.frame conversion in between.
>
> Thank you in advance.
>
> Golam
>
> Sent from my iPhone
>
> On 24 Mar 2012, at 13:13, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:
>
>> I'm not sure I understand. PerformanceAnalytics is part of the
>> "xts-family" (as opposed to the Rmetrics family) of finance packages.
>> Your problem may be that it requires returns, but consider this
>> (somewhat opaque) one liner.
>>
>> charts.PerformanceSummary(ROC(Cl(to.weekly(Ad(getSymbols("IBM",auto.assign
>> = F))))))
>>
>> which works just fine (using 3 packages explicitly and two major dependencies!)
>>
>> Michael
>>
>> On Sat, Mar 24, 2012 at 9:01 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
>>> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.
>>>
>>> Thanks
>>>
>>> Riskmaverick
>>>
>>> Sent from my iPhone
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From golam.sakline at gmail.com  Sat Mar 24 15:58:28 2012
From: golam.sakline at gmail.com (Golam Sakline)
Date: Sat, 24 Mar 2012 14:58:28 +0000
Subject: [R-SIG-Finance] xts to timeSeries conversion
In-Reply-To: <CABDUZc-iBX5BUN4JQiCu1L-uqap9UpwteGLqev4KdRM40Qy3bQ@mail.gmail.com>
References: <CAC0C9EC-76CF-423F-97C5-D4636085ABDA@gmail.com>
	<CAAmySGMmbrN+P5o3BgA_s1fy4GZ88Ck6=N6SuB6CoFkX1LYuzw@mail.gmail.com>
	<313AA0EE-D328-4DAF-BB7F-3EA0D8A50F64@gmail.com>
	<CABDUZc-iBX5BUN4JQiCu1L-uqap9UpwteGLqev4KdRM40Qy3bQ@mail.gmail.com>
Message-ID: <7C6FDE92-E0F7-4D2B-AED7-8A20047C8F66@gmail.com>

Thank you all for your comments. I am actually trying to produce beta hedged spread charts between two cointegrated ticker. I have the tickers that are cointegrated and their half life. I am trying to fetch the data through getSymbols then apply the hedge ratio and then chart the spread in chartSeries. Apologies for not providing the code as away from my PC at the moment

Kind regards

Riskmaverick 

Sent from my iPhone

On 24 Mar 2012, at 14:08, Jeffrey Ryan <jeffrey.ryan at lemnica.com> wrote:

> as.XXXXXX is the R way to coerce objects, and xts follows this (as do
> most of the time series classes)
> 
> One of the original design goals of xts was to remove the issues
> surrounding all of the different time series classes that may be in R.
> R developers can convert to xts internally via try.xts and return
> original object classes with "reclass".  PeformanceAnalytics does this
> quite well, which makes it easy for users to pass in any time series
> object - regardless of class.
> 
> At the user level, as.xts or as.XXXXX is all that is needed if you are
> forced to convert, but as Brian points out - this isn't needed in PA
> or other packages that use the xts methodology for internally
> consistent conversions.
> 
> In short, it should (does) just work.  If it isn't, your data is
> likely different than what you are telling us, but we'd need example
> code as requested in the posting guides to be more helpful.
> 
> Best,
> Jeff
> 
> On Sat, Mar 24, 2012 at 8:58 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
>> Hi Michael,
>> 
>> Thank you for you reply, but in general are you aware of any ways to convert xts date to timeSeries date using intermediate data.frame conversion in between.
>> 
>> Thank you in advance.
>> 
>> Golam
>> 
>> Sent from my iPhone
>> 
>> On 24 Mar 2012, at 13:13, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:
>> 
>>> I'm not sure I understand. PerformanceAnalytics is part of the
>>> "xts-family" (as opposed to the Rmetrics family) of finance packages.
>>> Your problem may be that it requires returns, but consider this
>>> (somewhat opaque) one liner.
>>> 
>>> charts.PerformanceSummary(ROC(Cl(to.weekly(Ad(getSymbols("IBM",auto.assign
>>> = F))))))
>>> 
>>> which works just fine (using 3 packages explicitly and two major dependencies!)
>>> 
>>> Michael
>>> 
>>> On Sat, Mar 24, 2012 at 9:01 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
>>>> How is it possible to get getSymbol object like IBM stock converted to timeSeries object so that it can be plotted in charts.PerformanceSummary() of PerformanceAnalytics in few lines of code. The problem I am having is with the Date column. Please help.
>>>> 
>>>> Thanks
>>>> 
>>>> Riskmaverick
>>>> 
>>>> Sent from my iPhone
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions should go.
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
> 
> 
> 
> -- 
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
> 
> www.lemnica.com
> www.esotericR.com
> 
> R/Finance 2012: Applied Finance with R
> www.RinFinance.com
> 
> See you in Chicago!!!!


From golam.sakline at gmail.com  Mon Mar 26 14:59:16 2012
From: golam.sakline at gmail.com (Golam Sakline)
Date: Mon, 26 Mar 2012 13:59:16 +0100
Subject: [R-SIG-Finance] Numeric to timeSeries help
Message-ID: <7CFB7207-5B3E-430D-A77F-E9D5CBBE240C@gmail.com>

Hi,

Can someone quickly help me with few lines of code or point me to a site that shows how to merge a numeric class object column with time column of getSymbol object and plot it in quantmod chartSeries.
Much appreciated.

Thanks in advance

Riskmaverick

Sent from my iPhone

From brian at braverock.com  Mon Mar 26 15:12:58 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 26 Mar 2012 08:12:58 -0500
Subject: [R-SIG-Finance] Numeric to timeSeries help
In-Reply-To: <7CFB7207-5B3E-430D-A77F-E9D5CBBE240C@gmail.com>
References: <7CFB7207-5B3E-430D-A77F-E9D5CBBE240C@gmail.com>
Message-ID: <1332767578.27217.49.camel@brian-rcg>

On Mon, 2012-03-26 at 13:59 +0100, Golam Sakline wrote:
> Hi,
> 
> Can someone quickly help me with few lines of code or point me to a site that shows how to merge a numeric class object column with time column of getSymbol object and plot it in quantmod chartSeries.
> Much appreciated.

A little more specificity might have helped...

getSymbols("IBM")
IBM$Random<-rnorm(nrow(IBM))
chart_Series(IBM)
add_Vo()
add_TA(IBM$Random)

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From josh.m.ulrich at gmail.com  Mon Mar 26 15:20:27 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 26 Mar 2012 08:20:27 -0500
Subject: [R-SIG-Finance] Numeric to timeSeries help
In-Reply-To: <7CFB7207-5B3E-430D-A77F-E9D5CBBE240C@gmail.com>
References: <7CFB7207-5B3E-430D-A77F-E9D5CBBE240C@gmail.com>
Message-ID: <CAPPM_gSyscXV=vnmAEsvV1xfKkGbuTW1ewQzgBxAnpa45Y11aA@mail.gmail.com>

On Mon, Mar 26, 2012 at 7:59 AM, Golam Sakline <golam.sakline at gmail.com> wrote:
> Hi,
>
> Can someone quickly help me with few lines of code or point me to a site that shows how to merge a numeric class object column with time column of getSymbol object and plot it in quantmod chartSeries.

There's no such thing as a "getSymbol" object.  By default getSymbols
returns an xts object.  xts objects do not have a "time column"; they
have an index attribute that stores the date/time.

What did you try?  This works:
x <- xts(1:10, Sys.Date()+1:10)
x <- merge(x,10:1)

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com


From jeff.a.ryan at gmail.com  Mon Mar 26 16:24:43 2012
From: jeff.a.ryan at gmail.com (Jeffrey Ryan)
Date: Mon, 26 Mar 2012 09:24:43 -0500
Subject: [R-SIG-Finance] Numeric to timeSeries help
In-Reply-To: <7CFB7207-5B3E-430D-A77F-E9D5CBBE240C@gmail.com>
Message-ID: <CB95E5F9.36770%jeff.a.ryan@gmail.com>

?merge.xts is what you need.

It will behave like you'd expect in R - requiring a vector of length ==
nrow of your object, or will be recycled as needed. e.g. cbind(x, NA) will
recycle NA accordingly

HTH
Jeff

On 3/26/12 7:59 AM, "Golam Sakline" <golam.sakline at gmail.com> wrote:

>Hi,
>
>Can someone quickly help me with few lines of code or point me to a site
>that shows how to merge a numeric class object column with time column of
>getSymbol object and plot it in quantmod chartSeries.
>Much appreciated.
>
>Thanks in advance
>
>Riskmaverick
>
>Sent from my iPhone
>_______________________________________________
>R-SIG-Finance at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>-- Subscriber-posting only. If you want to post, subscribe first.
>-- Also note that this is not the r-help list where general R questions
>should go.


From varcovar at live.com  Tue Mar 27 16:31:19 2012
From: varcovar at live.com (varcovar)
Date: Tue, 27 Mar 2012 07:31:19 -0700 (PDT)
Subject: [R-SIG-Finance] Indexing package: update existant database
Message-ID: <1332858679037-4508992.post@n4.nabble.com>

Hello, 

I am not able to update data that I created with the indexing package. Below
is the code I used to create the index. It works well when I try to retrieve
data, but then I have no idea how to update the index. 

library(indexing)
library(quantmod)

# Get data and create index
getSymbols("AAPL", from = "2010-01-01", to = "2012-03-20")
Date <- as.numeric(format(index(AAPL), "%Y%m%d"))
Close <- as.numeric(Cl(AAPL))
create_index(Date)
create_index(Close)

# Get data update
getSymbols("AAPL", from = "2012-03-20", to = Sys.Date())
Date <- as.numeric(format(index(AAPL), "%Y%m%d"))
Close <- as.numeric(Cl(AAPL))

# Load index
db <- load_index("Date", double())
load_index("Close", double())
# Test
db[Date > 20120310, data.frame(Date, Close)]

# Try to get a subset of data and update the file on disk
temp <- db[Date > 20120310, data.frame(Date, Close)]
Date <- c(temp$Date, Date)
Close <- c(temp$Close, Close)

# Not working: 
create_index(Date)
# Error in create_index(Date) : 
#     data already exists. Remove disk structure or use 'load_index'

Any idea? Many thanks! 

Markus Douglas, Jr.


--
View this message in context: http://r.789695.n4.nabble.com/Indexing-package-update-existant-database-tp4508992p4508992.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From student.northwestern at gmail.com  Wed Mar 28 03:20:39 2012
From: student.northwestern at gmail.com (Jim Green)
Date: Tue, 27 Mar 2012 21:20:39 -0400
Subject: [R-SIG-Finance] how to save the quantstrat performance chart
Message-ID: <CACAe89w-2Se6x=iNwU3PpJLYehyx6-gyeMm5KX_6R-pMPz3dQA@mail.gmail.com>

Good Evening!

in maCross.R in the demo folder of quantstrat,
chart.Posn(Portfolio='macross',Symbol=stock.str) is called to generate
the performance chart. internally it calls chart_Series in quantmod.

the chart it produced is very nice, the only thing that bothers me is
the font of the label is too small and looks like there is no easy way
to zoom in an out interactively.

Could anyone advise how to save that chart to some image format on the
hard drive so I can zoom in and out without much loss of definition? I
tried quantmod documentation and came across saveChart command but
still don't know how to integrate to maCross.R for example.

Thanks!
Jim.


From brian at braverock.com  Wed Mar 28 03:34:43 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 27 Mar 2012 20:34:43 -0500
Subject: [R-SIG-Finance] how to save the quantstrat performance chart
In-Reply-To: <CACAe89w-2Se6x=iNwU3PpJLYehyx6-gyeMm5KX_6R-pMPz3dQA@mail.gmail.com>
References: <CACAe89w-2Se6x=iNwU3PpJLYehyx6-gyeMm5KX_6R-pMPz3dQA@mail.gmail.com>
Message-ID: <1332898483.10078.23.camel@brian-desktop>

On Tue, 2012-03-27 at 21:20 -0400, Jim Green wrote:
> Good Evening!
> 
> in maCross.R in the demo folder of quantstrat,
> chart.Posn(Portfolio='macross',Symbol=stock.str) is called to generate
> the performance chart. internally it calls chart_Series in quantmod.
> 
> the chart it produced is very nice, the only thing that bothers me is
> the font of the label is too small and looks like there is no easy way
> to zoom in an out interactively.
> 
> Could anyone advise how to save that chart to some image format on the
> hard drive so I can zoom in and out without much loss of definition? I
> tried quantmod documentation and came across saveChart command but
> still don't know how to integrate to maCross.R for example.

After it has already been created, see 

?dev.copy2pdf

otherwise, see 

?pdf

I tend to not spend too much time messing about with font sizes and
such, preferring rather to see the information and move on, but patches
are always welcome.

Regards,

 - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From student.northwestern at gmail.com  Wed Mar 28 03:57:06 2012
From: student.northwestern at gmail.com (Jim Green)
Date: Tue, 27 Mar 2012 21:57:06 -0400
Subject: [R-SIG-Finance] how to save the quantstrat performance chart
In-Reply-To: <1332898483.10078.23.camel@brian-desktop>
References: <CACAe89w-2Se6x=iNwU3PpJLYehyx6-gyeMm5KX_6R-pMPz3dQA@mail.gmail.com>
	<1332898483.10078.23.camel@brian-desktop>
Message-ID: <CACAe89yQnkuRguDqqm4eXF1SzXHpByamV5NcKzLz36TvqhDEWw@mail.gmail.com>

On 27 March 2012 21:34, Brian G. Peterson <brian at braverock.com> wrote:
> On Tue, 2012-03-27 at 21:20 -0400, Jim Green wrote:
>> Good Evening!
>>
>> in maCross.R in the demo folder of quantstrat,
>> chart.Posn(Portfolio='macross',Symbol=stock.str) is called to generate
>> the performance chart. internally it calls chart_Series in quantmod.
>>
>> the chart it produced is very nice, the only thing that bothers me is
>> the font of the label is too small and looks like there is no easy way
>> to zoom in an out interactively.
>>
>> Could anyone advise how to save that chart to some image format on the
>> hard drive so I can zoom in and out without much loss of definition? I
>> tried quantmod documentation and came across saveChart command but
>> still don't know how to integrate to maCross.R for example.
>
> After it has already been created, see
>
> ?dev.copy2pdf

it worked beautifully. Thanks Brian!

Jim.

>
> otherwise, see
>
> ?pdf
>
> I tend to not spend too much time messing about with font sizes and
> such, preferring rather to see the information and move on, but patches
> are always welcome.
>
> Regards,
>
> ?- Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>


From numidiancavalry at yahoo.com  Thu Mar 29 12:03:25 2012
From: numidiancavalry at yahoo.com (John Hardy)
Date: Thu, 29 Mar 2012 03:03:25 -0700 (PDT)
Subject: [R-SIG-Finance] Links to trading models in R
Message-ID: <1333015405.11455.YahooMailNeo@web39304.mail.mud.yahoo.com>

Hi, Everyone
?
I am getting going with R - mostly only for programming trading systems with RBloomberg data. I have figured out how to download daily and intraday data and then transform this into xts objects for applying all the usual TTR functions.
?
Most of what I have learned, I have learned through other people's examples of what they are doing, but it seems there are very few out there that are posting coding examples of their systems. Does anyone have a URL for someone that has posted a lot of coding samples of their trading models. I don't care about profitability - I have my own ideas?- just want to see how better programmers are dealing with the various challenges of modeling trading systems in R.
?
In particular, I'm looking for clever ways to dealing with being long x (for now 1 or 2) units and dealing with the various entries and exits for each unit and having multiple criteria for when to enter and exit a trade.
?
Thanks
John


From michael.weylandt at gmail.com  Thu Mar 29 15:58:54 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Thu, 29 Mar 2012 09:58:54 -0400
Subject: [R-SIG-Finance] Links to trading models in R
In-Reply-To: <1333015405.11455.YahooMailNeo@web39304.mail.mud.yahoo.com>
References: <1333015405.11455.YahooMailNeo@web39304.mail.mud.yahoo.com>
Message-ID: <CAAmySGPK3aL_f8igSrPdRcaPCn98KaaYXiCgB0tYPczjpBeLSw@mail.gmail.com>

You might google around for anything involving the term quantstrat.

Michael

On Thu, Mar 29, 2012 at 6:03 AM, John Hardy <numidiancavalry at yahoo.com> wrote:
> Hi, Everyone
>
> I am getting going with R - mostly only for programming trading systems with RBloomberg data. I have figured out how to download daily and intraday data and then transform this into xts objects for applying all the usual TTR functions.
>
> Most of what I have learned, I have learned through other people's examples of what they are doing, but it seems there are very few out there that are posting coding examples of their systems. Does anyone have a URL for someone that has posted a lot of coding samples of their trading models. I don't care about profitability - I have my own ideas?- just want to see how better programmers are dealing with the various challenges of modeling trading systems in R.
>
> In particular, I'm looking for clever ways to dealing with being long x (for now 1 or 2) units and dealing with the various entries and exits for each unit and having multiple criteria for when to enter and exit a trade.
>
> Thanks
> John
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From josh.m.ulrich at gmail.com  Thu Mar 29 16:00:56 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 29 Mar 2012 09:00:56 -0500
Subject: [R-SIG-Finance] Links to trading models in R
In-Reply-To: <CAAmySGPK3aL_f8igSrPdRcaPCn98KaaYXiCgB0tYPczjpBeLSw@mail.gmail.com>
References: <1333015405.11455.YahooMailNeo@web39304.mail.mud.yahoo.com>
	<CAAmySGPK3aL_f8igSrPdRcaPCn98KaaYXiCgB0tYPczjpBeLSw@mail.gmail.com>
Message-ID: <CAPPM_gROR7VZyi+BrLo=A1=nhY-1s1jSBpV14FSw8oXv0Tu51g@mail.gmail.com>

On Thu, Mar 29, 2012 at 8:58 AM, R. Michael Weylandt
<michael.weylandt at gmail.com> wrote:
> You might google around for anything involving the term quantstrat.
>
And/or look at the demos in the package.

> Michael
>
> On Thu, Mar 29, 2012 at 6:03 AM, John Hardy <numidiancavalry at yahoo.com> wrote:
>> Hi, Everyone
>>
>> I am getting going with R - mostly only for programming trading systems with RBloomberg data. I have figured out how to download daily and intraday data and then transform this into xts objects for applying all the usual TTR functions.
>>
>> Most of what I have learned, I have learned through other people's examples of what they are doing, but it seems there are very few out there that are posting coding examples of their systems. Does anyone have a URL for someone that has posted a lot of coding samples of their trading models. I don't care about profitability - I have my own ideas?- just want to see how better programmers are dealing with the various challenges of modeling trading systems in R.
>>
>> In particular, I'm looking for clever ways to dealing with being long x (for now 1 or 2) units and dealing with the various entries and exits for each unit and having multiple criteria for when to enter and exit a trade.
>>
>> Thanks
>> John
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From markleeds2 at gmail.com  Thu Mar 29 16:11:09 2012
From: markleeds2 at gmail.com (Mark Leeds)
Date: Thu, 29 Mar 2012 10:11:09 -0400
Subject: [R-SIG-Finance] Links to trading models in R
In-Reply-To: <CAAmySGPK3aL_f8igSrPdRcaPCn98KaaYXiCgB0tYPczjpBeLSw@mail.gmail.com>
References: <1333015405.11455.YahooMailNeo@web39304.mail.mud.yahoo.com>
	<CAAmySGPK3aL_f8igSrPdRcaPCn98KaaYXiCgB0tYPczjpBeLSw@mail.gmail.com>
Message-ID: <CAHz+bWbw2Drgzpo44eSPDUs9EEs5Z8Tpg2LYmbAQo-xtj1NP=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120329/e3fa36a2/attachment.pl>

From mamushbukana at gmail.com  Fri Mar 30 13:21:15 2012
From: mamushbukana at gmail.com (mamush bukana)
Date: Fri, 30 Mar 2012 12:21:15 +0100
Subject: [R-SIG-Finance] impulse response function in rmgarch package?
Message-ID: <CAFxDEqL-m4jbxV3cdbfv8F7ucoqQUWO6p5MAS2_uppzE53hyDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120330/5b14a406/attachment.pl>

From alexios at 4dscape.com  Fri Mar 30 16:05:48 2012
From: alexios at 4dscape.com (alexios ghalanos)
Date: Fri, 30 Mar 2012 15:05:48 +0100
Subject: [R-SIG-Finance] impulse response function in rmgarch package?
In-Reply-To: <CAFxDEqL-m4jbxV3cdbfv8F7ucoqQUWO6p5MAS2_uppzE53hyDg@mail.gmail.com>
References: <CAFxDEqL-m4jbxV3cdbfv8F7ucoqQUWO6p5MAS2_uppzE53hyDg@mail.gmail.com>
Message-ID: <4F75BDBC.8090606@4dscape.com>

I assume you are referring to the VAR methods in the package for which 
Impulse Response functions have not been implemented. Look in the 'vars' 
package for those.
I am surprised that you can't get the documentation since it is 
installed together with the package (try ?rmgarch).

Regards,
Alexios

On 30/03/2012 12:21, mamush bukana wrote:
> Dear members,
>
> Is there a function to estimate and plot Impulse Response Function in
> rmgarch package please? I can't get the package documentation; and that is
> why I am asking this silly question.
>
> Thanks
>
> Mamush
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From comtech.usa at gmail.com  Fri Mar 30 17:53:38 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 30 Mar 2012 10:53:38 -0500
Subject: [R-SIG-Finance] How to automatically extract test result from
	Johansen test?
Message-ID: <CAPNjSFYBm+fQv-g7G7ftcXnvy9Px9hmSUd=tc+VXLfFEdabKTg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120330/8e36d37a/attachment.pl>

From brian at braverock.com  Fri Mar 30 18:00:39 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 30 Mar 2012 11:00:39 -0500
Subject: [R-SIG-Finance] How to automatically extract test result from
 Johansen test?
In-Reply-To: <CAPNjSFYBm+fQv-g7G7ftcXnvy9Px9hmSUd=tc+VXLfFEdabKTg@mail.gmail.com>
References: <CAPNjSFYBm+fQv-g7G7ftcXnvy9Px9hmSUd=tc+VXLfFEdabKTg@mail.gmail.com>
Message-ID: <1333123239.27217.193.camel@brian-rcg>

On Fri, 2012-03-30 at 10:53 -0500, Michael wrote:
> How to automatically extract test result from Johansen test?
> 
> Hi all,
> 
> I am using the "ca.jo" function to do the Johansen test.
> 
> It's outputting a lot of results.
> 
> If I am running this on a large number of assets, is there a way to
> automatically extract and condense the test outputs to just "pass/fail" and
> "residuals"?
> 
> Thanks a lot!

Like all R objects, it is a list internally. Extract what you need in
the same loop that's doing the test.

Please at least try before posting.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From michael.weylandt at gmail.com  Fri Mar 30 18:08:25 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 30 Mar 2012 12:08:25 -0400
Subject: [R-SIG-Finance] How to automatically extract test result from
 Johansen test?
In-Reply-To: <1333123239.27217.193.camel@brian-rcg>
References: <CAPNjSFYBm+fQv-g7G7ftcXnvy9Px9hmSUd=tc+VXLfFEdabKTg@mail.gmail.com>
	<1333123239.27217.193.camel@brian-rcg>
Message-ID: <CAAmySGP1Uctcu=282O8QbKx6hYv=VAay6DoC4U6xbthPmn09zA@mail.gmail.com>

Actually, it looks like ca.jo objects are S4 so it's a little bit
harder: take a look at ?`ca.jo-class` (note the backticks) to see the
26 slots available. I'm not sure if the ones you want have dedicated
extractor methods but you can get them with ?slot directly. There's
not an absolute pass/fail (like most other statistical tests) so you
have to pick your desired significance threshold, but that's not hard.
As Brian said though, it makes most sense to do this inside your loop
construction.

Hope this helps,

Michael Weylandt

On Fri, Mar 30, 2012 at 12:00 PM, Brian G. Peterson <brian at braverock.com> wrote:
> On Fri, 2012-03-30 at 10:53 -0500, Michael wrote:
>> How to automatically extract test result from Johansen test?
>>
>> Hi all,
>>
>> I am using the "ca.jo" function to do the Johansen test.
>>
>> It's outputting a lot of results.
>>
>> If I am running this on a large number of assets, is there a way to
>> automatically extract and condense the test outputs to just "pass/fail" and
>> "residuals"?
>>
>> Thanks a lot!
>
> Like all R objects, it is a list internally. Extract what you need in
> the same loop that's doing the test.
>
> Please at least try before posting.
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From comtech.usa at gmail.com  Fri Mar 30 22:43:03 2012
From: comtech.usa at gmail.com (Michael)
Date: Fri, 30 Mar 2012 15:43:03 -0500
Subject: [R-SIG-Finance] How to automatically extract test result from
 Johansen test?
In-Reply-To: <CAAmySGP1Uctcu=282O8QbKx6hYv=VAay6DoC4U6xbthPmn09zA@mail.gmail.com>
References: <CAPNjSFYBm+fQv-g7G7ftcXnvy9Px9hmSUd=tc+VXLfFEdabKTg@mail.gmail.com>
	<1333123239.27217.193.camel@brian-rcg>
	<CAAmySGP1Uctcu=282O8QbKx6hYv=VAay6DoC4U6xbthPmn09zA@mail.gmail.com>
Message-ID: <CAPNjSFYbAFyo+ED=xo17bEzmdirDFygH=eYDa8X7iKnMNRz7Uw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20120330/d845e3e8/attachment.pl>

From michael.weylandt at gmail.com  Sat Mar 31 03:27:59 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Fri, 30 Mar 2012 21:27:59 -0400
Subject: [R-SIG-Finance] How to automatically extract test result from
 Johansen test?
In-Reply-To: <CAPNjSFYbAFyo+ED=xo17bEzmdirDFygH=eYDa8X7iKnMNRz7Uw@mail.gmail.com>
References: <CAPNjSFYBm+fQv-g7G7ftcXnvy9Px9hmSUd=tc+VXLfFEdabKTg@mail.gmail.com>
	<1333123239.27217.193.camel@brian-rcg>
	<CAAmySGP1Uctcu=282O8QbKx6hYv=VAay6DoC4U6xbthPmn09zA@mail.gmail.com>
	<CAPNjSFYbAFyo+ED=xo17bEzmdirDFygH=eYDa8X7iKnMNRz7Uw@mail.gmail.com>
Message-ID: <CAAmySGPO20kUP+Y7sPQWctaPAm368oj+HBvkoQBLO8r9k9c2uA@mail.gmail.com>

Your example is actually from the urca package which is a dependency
of vars -- both are by Dr. Pfaff and I'd highly recommend his book on
all this jazz: Analysis of Integrated and Cointegrated Time Series
with R

DISCLAIMER: I am not a scholar [nor even a particularly well read
student] of unit root analysis so the following is complete bunk at p
< 0.02.

Like I said: just like (almost?) every other statistical test, it
depends on your desired significance level. Fix that and then then you
simply compare the test statistics for different cointegration orders
to see if any of them are statistically significant at that level.
However, this has to be done correctly and here's why my memory gets
fuzzy:

Something like:

sjd.vecm at teststat > sjd.vecm at cval[, "10pct"]

being higher than the critical value is "good" for this test.

In my quick study of Johansen, I thought one had to start from r=0 and
test sequentially up to r<=3 to do these things "properly" [i.e., if
you can't eliminate the null hypothesis of no cointegrating vector,
you shouldn't move on to testing the null hypothesis of one
cointegrating vector] but that doesn't seem to be suggested by the
summary tables ... one idea that comes to mind (and I'm really just
guessing here) is that r is the opposite of what I think it is -- so
one starts at r <=3 which is the more general hypothesis and
progresses to the stricter r = 0.

Whatever the correct procedure is, it seems that one needs to be
careful of unpenalized model selection here, but that might be already
taken care of in Johansen's method: I simply don't know. If you get
Pfaff's book I'm sure this is explained: I don't have a copy handy and
it's far too cold and rainy to walk to the library right now.

Sorry I can't be of more help,

Michael Weylandt

On Fri, Mar 30, 2012 at 4:43 PM, Michael <comtech.usa at gmail.com> wrote:
> Thank you for your help!
>
> I am following the example in the "vars" package in R, shown below:
>
> data(denmark)
> sjd <- denmark[, c("LRM", "LRY", "IBO", "IDE")]
> sjd.vecm <- ca.jo(sjd, ecdet = "const", type="eigen", K=2, spec="longrun",
> season=4)
> summary(sjd.vecm)
>
> I got the following stats:
>
>> sjd.vecm at teststat
> [1]? 2.352233? 6.342730 10.361950 30.087451
>> sjd.vecm at cval
> ???????? 10pct? 5pct? 1pct
> r <= 3 |? 7.52? 9.24 12.97
> r <= 2 | 13.75 15.67 20.20
> r <= 1 | 19.77 22.00 26.81
> r = 0? | 25.56 28.14 33.24
>
>
> How shall I draw a conclusion of "pass/fail" automatically and
> programmatically?
>
> Could you please show me using the above example?
>
> Thank you!
>
>
> On Fri, Mar 30, 2012 at 11:08 AM, R. Michael Weylandt
> <michael.weylandt at gmail.com> wrote:
>>
>> Actually, it looks like ca.jo objects are S4 so it's a little bit
>> harder: take a look at ?`ca.jo-class` (note the backticks) to see the
>> 26 slots available. I'm not sure if the ones you want have dedicated
>> extractor methods but you can get them with ?slot directly. There's
>> not an absolute pass/fail (like most other statistical tests) so you
>> have to pick your desired significance threshold, but that's not hard.
>> As Brian said though, it makes most sense to do this inside your loop
>> construction.
>>
>> Hope this helps,
>>
>> Michael Weylandt
>>
>> On Fri, Mar 30, 2012 at 12:00 PM, Brian G. Peterson <brian at braverock.com>
>> wrote:
>> > On Fri, 2012-03-30 at 10:53 -0500, Michael wrote:
>> >> How to automatically extract test result from Johansen test?
>> >>
>> >> Hi all,
>> >>
>> >> I am using the "ca.jo" function to do the Johansen test.
>> >>
>> >> It's outputting a lot of results.
>> >>
>> >> If I am running this on a large number of assets, is there a way to
>> >> automatically extract and condense the test outputs to just "pass/fail"
>> >> and
>> >> "residuals"?
>> >>
>> >> Thanks a lot!
>> >
>> > Like all R objects, it is a list internally. Extract what you need in
>> > the same loop that's doing the test.
>> >
>> > Please at least try before posting.
>> >
>> > --
>> > Brian G. Peterson
>> > http://braverock.com/brian/
>> > Ph: 773-459-4973
>> > IM: bgpbraverock
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>
>


